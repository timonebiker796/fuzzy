/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.exploratoryView_bundle_jsonpfunction=window.exploratoryView_bundle_jsonpfunction||[]).push([[5],{170:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return j}));var i=a(0),n=a(2),s=a.n(n),o=a(7),l=a(57),r=a(8),c=a(14),p=a.n(c);a(40);a(76),a(77);const u=({analytics:e,queryName:t})=>({reportEvent:a=>{if(a){const{requests:i}=a;if(i&&e){const a=i.getRequests();if(a.length>0){const i=a.reduce(((e,t)=>{var a,i;const n=Number(null===(a=t.stats)||void 0===a||null===(i=a.queryTime.value.split("ms"))||void 0===i?void 0:i[0]);return n>e?n:e}),0);i&&function(e,t){e.reportEvent("performance_metric",t)}(e,{eventName:"exploratory_view_query_time",duration:i,meta:t&&{queryName:t}||void 0})}}}}});var d=a(90),b=a(18),g=a(63),y=a(11);const m=({callback:e})=>({id:"expViewOpenInLens",getDisplayName:e=>i.i18n.translate("xpack.exploratoryView.expView.openInLens",{defaultMessage:"Open in Lens"}),getIconType:e=>"visArea",type:"link",isCompatible:async e=>!0,async execute(t){e()}}),v=({href:e,callback:t})=>({id:"expViewExplore",getDisplayName:e=>i.i18n.translate("xpack.exploratoryView.expView.explore",{defaultMessage:"Explore"}),getIconType:e=>"visArea",type:"link",isCompatible:async e=>!0,getHref:async t=>e,async execute(e){t()},order:50}),x=({callback:e})=>({id:"expViewSave",getDisplayName:e=>i.i18n.translate("xpack.exploratoryView.expView.save",{defaultMessage:"Save visualization"}),getIconType:e=>"save",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},order:49}),h=({callback:e})=>({id:"expViewAddToCase",getDisplayName:e=>i.i18n.translate("xpack.exploratoryView.expView.addToCase",{defaultMessage:"Add to case"}),getIconType:e=>"link",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},order:48});var f=a(109),w=a(71),T=a(84),E=a(107),V=a(32),O=a(73),S=a(88);const C=({attributes:e,dataViewState:t,reportType:a,reportConfigMap:i={},lensFormulaHelper:s})=>{var o;const l=Object(r.useKibanaSpace)(),c=Object(r.useTheme)();return Object(n.useMemo)((()=>{try{var n;const o=Object(T.b)(e,a,c,t,{...i,...E.b},null===(n=l.space)||void 0===n?void 0:n.id);if(a===V.ReportTypes.SINGLE_METRIC){const e=new O.a(o,a,s);return null==e?void 0:e.getJSON("lnsLegacyMetric")}if(a===V.ReportTypes.HEATMAP){const e=new S.a(o,a,s);return null==e?void 0:e.getJSON("lnsHeatmap")}{const e=new w.a(o,a,s);return null==e?void 0:e.getJSON()}}catch(e){console.error(e)}}),[e,t,s,i,a,null===(o=l.space)||void 0===o?void 0:o.id,c])};function j(e){var t;const{appendTitle:a,attributes:c=[],axisTitlesVisibility:p,gridlinesVisibilitySettings:w,customHeight:T,customTimeRange:E,legendIsVisible:V,legendPosition:O,lens:S,onBrushEnd:j,caseOwner:I=r.observabilityFeatureId,reportType:A,showCalculationMethod:M=!1,title:L,withActions:N=!0,hideTicks:_,align:R,noLabel:H,fontSize:z=27,lineHeight:$=32,searchSessionId:q,onLoad:P,analytics:B}=e,D=null==S?void 0:S.EmbeddableComponent,F=null==S?void 0:S.SaveModalComponent,[J,K]=Object(n.useState)(!1),[W,G]=Object(n.useState)(!1),Q=null===(t=Object.entries(c)[0])||void 0===t?void 0:t[1],[U,X]=Object(n.useState)(null==Q?void 0:Q.operationType),Y=C(e),Z=null!=E?E:null==Q?void 0:Q.time,{reportEvent:ee}=u({analytics:B,queryName:Q?`${Q.dataType}_${Q.name}`:"string"==typeof L?L:"Exp View embeddable query"}),te=function({withActions:e,attributes:t,reportType:a,setIsSaveOpen:i,setAddToCaseOpen:s,timeRange:o,lensAttributes:l}){const r=Object(b.useKibana)().services,{lens:c}=r,[p,u]=Object(n.useState)(["explore","save","addToCase"]);Object(n.useEffect)((()=>{!1===e&&u([]),Array.isArray(e)&&u(e)}),[e]);const{http:d,application:f}=Object(b.useKibana)().services,w=Object(y.b)({reportType:a,allSeries:t},null==d?void 0:d.basePath.get()),T=Object(g.d)({reportType:a,allSeries:t}),E=Object(n.useCallback)((()=>{l&&c.navigateToPrefilledEditor({id:"",timeRange:o,attributes:l},{openInNewTab:!0})}),[c,l,o]),V=Object(n.useCallback)((()=>{null==f||f.navigateToApp("exploratory-view",{path:T})}),[f,T]),O=Object(n.useCallback)((()=>{i(!0)}),[i]),S=Object(n.useCallback)((()=>{s(!0)}),[s]);return p.map((e=>"save"===e?x({callback:O}):"addToCase"===e?h({callback:S}):"openInLens"===e?m({callback:E}):v({href:w,callback:V})))}({withActions:N,attributes:c,reportType:A,setIsSaveOpen:K,setAddToCaseOpen:G,lensAttributes:Y,timeRange:Z});return Y?(void 0!==p&&(Y.state.visualization.axisTitlesVisibilitySettings=p),void 0!==w&&(Y.state.visualization.gridlinesVisibilitySettings=w),void 0!==V&&(Y.state.visualization.legend.isVisible=V),void 0!==O&&(Y.state.visualization.legend.position=O),_&&(Y.state.visualization.tickLabelsVisibilitySettings={x:!1,yRight:!1,yLeft:!1}),Y?D?s.a.createElement(k,{$customHeight:T,align:R,noLabel:H,fontSize:z,lineHeight:$},(L||M||a)&&s.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},L&&s.a.createElement(o.EuiFlexItem,{"data-test-subj":"exploratoryView-title"},s.a.createElement(o.EuiTitle,{size:"xs"},s.a.createElement("h3",null,L))),M&&s.a.createElement(o.EuiFlexItem,{grow:!1,style:{minWidth:150}},s.a.createElement(d.a,{operationType:U,onChange:e=>{X(e)}})),a&&a),s.a.createElement(D,{id:"exploratoryView","data-test-subj":"exploratoryView",style:{height:"100%"},timeRange:Z,attributes:{...Y,title:"",description:""},onBrushEnd:j,withDefaultActions:Boolean(N),extraActions:te,viewMode:l.ViewMode.VIEW,searchSessionId:q,onLoad:(e,t)=>{ee(t),null==P||P(e)}}),J&&Y&&s.a.createElement(F,{initialInput:Y,onClose:()=>K(!1),onSave:()=>{}}),s.a.createElement(f.a,{lensAttributes:Y,timeRange:null!=E?E:null==Q?void 0:Q.time,autoOpen:W,setAutoOpen:G,owner:I})):s.a.createElement(o.EuiText,null,i.i18n.translate("xpack.exploratoryView.embeddable.noLensComponentTextLabel",{defaultMessage:"No lens component"})):null):null}const k=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-15na2sm-0"})(["height:",";position:relative;&&&{> :nth-child(2){height:",";}.expExpressionRenderer__expression{padding:0 !important;}.legacyMtrVis{> :first-child{justify-content:",";}justify-content:flex-end;.legacyMtrVis__container{padding:0;> :nth-child(2){","}}.legacyMtrVis__value{line-height:","px !important;font-size:","px !important;}> :first-child{transform:none !important;}}.euiLoadingChart{position:absolute;top:50%;right:50%;transform:translate(50%,-50%);}}"],(e=>e.$customHeight?`${e.$customHeight};`:"100%;"),(e=>e.$customHeight?`${e.$customHeight};`:"calc(100% - 32px);"),(e=>"left"===e.align?"flex-start;":"right"===e.align?"flex-end;":"center;"),(({noLabel:e})=>e&&" display: none;\n        "),(({lineHeight:e})=>e),(({fontSize:e})=>e))},76:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(2);const n=Object(i.createContext)(void 0)},77:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));const i={startPageChange:"start::pageChange",endPageReady:"end::pageReady"}}}]);