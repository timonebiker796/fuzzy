/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.slo_bundle_jsonpfunction=window.slo_bundle_jsonpfunction||[]).push([[21],{135:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var l=a(1),n=a(6),i=a(0),o=a.n(i),r=a(74),s=a(155),u=a(152),c=a(104),d=a(126);function v({slo:e,setSelectedSlo:t}){const{application:{navigateToUrl:a},http:{basePath:v},uiSettings:m}=Object(r.a)().services,b=()=>{t(null)},[g,p]=Object(i.useState)(d.c),{tabs:E}=Object(s.a)({slo:e,isAutoRefreshing:!1,selectedTabId:g,setSelectedTabId:p});return e?o.a.createElement(n.EuiFlyout,{onClose:b},o.a.createElement(n.EuiFlyoutHeader,null,o.a.createElement(n.EuiTitle,null,o.a.createElement("h2",null,l.i18n.translate("xpack.slo.sloOverviewDetails.h2.detailsLabel",{defaultMessage:"{sloName}",values:{sloName:e.name}})))),o.a.createElement(n.EuiFlyoutBody,null,o.a.createElement(u.a,{slo:e,isLoading:!1}),o.a.createElement(n.EuiTabs,null,E.map(((e,t)=>o.a.createElement(n.EuiTab,{key:t,onClick:"onClick"in e?e.onClick:void 0,isSelected:e.id===g,append:"append"in e?e.append:null},e.label)))),o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(d.d,{slo:e,isAutoRefreshing:!1,selectedTabId:g})),o.a.createElement(n.EuiFlyoutFooter,null,o.a.createElement(n.EuiFlexGroup,{justifyContent:"spaceBetween"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiButton,{"data-test-subj":"o11ySloOverviewDetailsCloseButton",onClick:b},l.i18n.translate("xpack.slo.sloOverviewDetails.button.closeLabel",{defaultMessage:"Close"}))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiButton,{fill:!0,onClick:()=>{const{sloDetailsUrl:t}=Object(c.a)(e,m,v);a(t)},"data-test-subj":"o11ySloOverviewDetailsDetailsButton"},l.i18n.translate("xpack.slo.sloOverviewDetails.button.detailsLabel",{defaultMessage:"Details"})))))):null}},366:function(e,t,a){"use strict";a.r(t),a.d(t,"getOverviewPanelTitle",(function(){return R})),a.d(t,"getOverviewEmbeddableFactory",(function(){return _}));var l=a(32),n=a.n(l),i=a(1),o=a(0),r=a.n(o),s=a(6),u=a(139),c=a(10),d=a(13),v=a(75),m=a(40),b=a(29),g=a(74),p=a(135),E=a(85),y=a(107),f=a(106),h=a(114),w=a(170),S=a(104),I=a(169),j=a(105);function O({sloId:e}){var t;const{http:{basePath:a},uiSettings:l}=Object(g.a)().services,[n,o]=r.a.useState(null),u=`slo.id:"${e}"`,{data:c,isLoading:d}=Object(E.a)({kqlQuery:u}),{data:O}=Object(h.a)({sloIdsAndInstanceIds:[[e,v.a]]}),{data:x}=Object(f.a)({sloIds:[e]}),{data:B=[]}=Object(j.a)({sloList:null!==(t=null==c?void 0:c.results)&&void 0!==t?t:[]}),{colors:C}=Object(I.d)(),T=[[]];return null==c||c.results.forEach((e=>{var t,n,i;const o=Object(I.c)(e),u=C[null!==(t=e.summary.status)&&void 0!==t?t:"NO_DATA"],{sliValue:c,sloTarget:d}=Object(S.a)(e,l,a),g=null!==(n=null===(i=B.find((t=>{var a;return t.sloId===e.id&&t.instanceId===(null!==(a=e.instanceId)&&void 0!==a?a:v.a)})))||void 0===i?void 0:i.data)&&void 0!==n?n:[];T[T.length-1].length>=4&&T.push([]);const p=null==x?void 0:x[null==e?void 0:e.id],E=O.get(e),f=Boolean(e.groupBy&&e.groupBy!==v.a),h=(({slo:e,historicalSummary:t,subTitle:a,cardColor:l,sliValue:n,sloTarget:i})=>{const o=Object(y.a)(t,"sli_value");return{title:e.name,subtitle:a,value:n,trendShape:m.MetricTrendShape.Area,trend:null==o?void 0:o.map((e=>({x:e.key,y:e.value}))),extra:r.a.createElement(b.FormattedMessage,{id:"xpack.slo.sloGridItem.targetFlexItemLabel",defaultMessage:"Target {target}",values:{target:i}}),icon:()=>r.a.createElement(s.EuiIcon,{type:"visGauge",size:"l"}),color:l}})({slo:e,subTitle:o,cardColor:u,sliValue:c,sloTarget:d,historicalSummary:g});h.body=r.a.createElement(w.a,{slo:e,rules:p,activeAlerts:E,handleCreateRule:()=>{},hasGroupBy:f}),T[T.length-1].push(h)})),d?r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiLoadingSpinner,{size:"xl"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-shared-item":"",style:{width:"100%"}},r.a.createElement(m.Chart,null,r.a.createElement(m.Settings,{baseTheme:m.DARK_THEME,onElementClick:([e])=>{if(Object(m.isMetricElementEvent)(e)){const{columnIndex:t,rowIndex:a}=e,l=null==c?void 0:c.results[4*a+t];o(null!=l?l:null)}},locale:i.i18n.getLocale()}),r.a.createElement(m.Metric,{id:"slo-id-instances",data:T}))),r.a.createElement(p.a,{slo:n,setSelectedSlo:o}))}var x=a(48),B=a(100);function C({sloId:e,sloInstanceId:t,remoteName:a,reloadSubject:l}){var n,u;const[c,d]=Object(o.useState)(void 0);Object(o.useEffect)((()=>(null==l||l.subscribe((()=>{d(Date.now())})),()=>{null==l||l.unsubscribe()})),[l]);const{isLoading:m,data:b,refetch:g,isRefetching:E}=Object(B.a)({sloId:e,remoteName:a,instanceId:t}),{data:S}=Object(f.a)({sloIds:e?[e]:[]}),{data:O}=Object(h.a)({sloIdsAndInstanceIds:b?[[b.id,null!==(n=b.instanceId)&&void 0!==n?n:v.a]]:[]}),{data:x=[]}=Object(j.a)({sloList:b?[b]:[]}),[C,F]=Object(o.useState)(null);Object(o.useEffect)((()=>{g()}),[c,g]);const M=!m&&void 0===b;if(E||m||!b)return r.a.createElement(T,null,r.a.createElement(k,null,r.a.createElement(s.EuiLoadingChart,null)));if(M)return r.a.createElement(T,null,r.a.createElement(k,null,i.i18n.translate("xpack.slo.sloEmbeddable.overview.sloNotFoundText",{defaultMessage:"The SLO has been deleted. You can safely delete the widget from the dashboard."})));const G=null==S?void 0:S[null==b?void 0:b.id],A=O.get(b),D=Boolean(b.groupBy&&b.groupBy!==v.a),N=null===(u=x.find((e=>{var t;return e.sloId===b.id&&e.instanceId===(null!==(t=b.instanceId)&&void 0!==t?t:v.a)})))||void 0===u?void 0:u.data,L=Object(y.a)(N,"sli_value");return r.a.createElement("div",{"data-test-subj":"sloSingleOverviewPanel","data-shared-item":"",style:{width:"100%"}},r.a.createElement(I.a,{slo:b,historicalSliData:null!=L?L:[],onClick:()=>{F(b)},badges:r.a.createElement(w.a,{slo:b,rules:G,activeAlerts:A,hasGroupBy:D})}),r.a.createElement(p.a,{slo:C,setSelectedSlo:F}))}const T=x.euiStyled.div`
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  width: 100%;
  height: 100%;
`,k=x.euiStyled.div`
  flex: 0 0 auto;
  align-self: center;
  text-align: center;
`;var F=a(210);function M({view:e,groupBy:t="status",groups:a=[],kqlQuery:l="",filters:n=[],reloadSubject:i}){const[s,u]=Object(o.useState)(void 0),c=(({groups:e,groupBy:t,kqlQuery:a})=>{let l="";e.length>0&&(l+="(",e.map(((a,n)=>{const i=n<e.length-1;l+=`${t}:"${a}"`,i&&(l+=" or ")})),l+=")");let n="";return a&&l?n=`${l} and ${a}`:l?n=l:a&&(n=a),n})({groups:a,groupBy:t,kqlQuery:l});return Object(o.useEffect)((()=>(null==i||i.subscribe((()=>{u(Date.now())})),()=>{null==i||i.unsubscribe()})),[i]),r.a.createElement(F.a,{view:e,groupBy:t,groupsFilter:a,kqlQuery:c,filters:n,lastRefreshTime:s})}var G=a(245),A=a(56),D=a(17),N=a(7),L=a(19);const P=new N.QueryClient;function V({deps:e,children:t}){const{observabilityRuleTypeRegistry:a}=e.observability,{navigation:l}=e.observabilityShared;return r.a.createElement(G.a,{history:Object(A.createBrowserHistory)()},r.a.createElement(x.EuiThemeProvider,{darkMode:!0},r.a.createElement(D.KibanaContextProvider,{services:e},r.a.createElement(L.a.Provider,{value:{observabilityRuleTypeRegistry:a,ObservabilityPageTemplate:l.PageTemplate}},r.a.createElement(N.QueryClientProvider,{client:P},t)))))}const R=()=>i.i18n.translate("xpack.slo.sloEmbeddable.displayName",{defaultMessage:"SLO Overview"}),_=e=>({type:d.b,deserializeState:e=>e.rawState,buildEmbeddable:async(t,l,n,d)=>{const[v,m]=await e(),b={...v,...m},{titlesApi:g,titleComparators:p,serializeTitles:E}=Object(u.d)(t),y=new c.BehaviorSubject(R()),f=new c.BehaviorSubject(t.sloId),h=new c.BehaviorSubject(t.sloInstanceId),w=new c.BehaviorSubject(t.showAllGroupByInstances),S=new c.BehaviorSubject(t.overviewMode),I=new c.BehaviorSubject(t.groupFilters),j=new c.BehaviorSubject(t.remoteName),x=new c.Subject,B=l({...g,defaultPanelTitle:y,getTypeDisplayName:()=>i.i18n.translate("xpack.slo.editSloOverviewEmbeddableTitle.typeDisplayName",{defaultMessage:"criteria"}),isEditingEnabled:()=>"groups"===B.getSloGroupOverviewConfig().overviewMode,onEdit:async()=>{!async function(){try{const{openSloConfiguration:e}=await a.e(5).then(a.bind(null,368)),t=await e(v,m,B.getSloGroupOverviewConfig());B.updateSloGroupOverviewConfig(t)}catch(e){return Promise.reject()}}()},serializeState:()=>({rawState:{...E(),sloId:f.getValue(),sloInstanceId:h.getValue(),showAllGroupByInstances:w.getValue(),overviewMode:S.getValue(),groupFilters:I.getValue(),remoteName:j.getValue()}}),getSloGroupOverviewConfig:()=>({groupFilters:I.getValue(),overviewMode:S.getValue()}),updateSloGroupOverviewConfig:e=>{I.next(e.groupFilters)}},{sloId:[f,e=>f.next(e)],sloInstanceId:[h,e=>h.next(e)],groupFilters:[I,e=>I.next(e)],showAllGroupByInstances:[w,e=>w.next(e)],remoteName:[j,e=>j.next(e)],overviewMode:[S,e=>S.next(e)],...p}),T=Object(u.c)(B).pipe().subscribe((e=>{x.next(e.isReload)}));return{api:B,Component:()=>{const[e,t,a,l,n,i]=Object(u.e)(f,h,w,S,I,j);return Object(o.useEffect)((()=>()=>{T.unsubscribe()}),[]),r.a.createElement(V,{deps:b},a?r.a.createElement(O,{sloId:e}):(()=>{if("groups"===l){var o,u,c;const e=null!==(o=null==n?void 0:n.groupBy)&&void 0!==o?o:"status",t=null!==(u=null==n?void 0:n.kqlQuery)&&void 0!==u?u:"",a=null!==(c=null==n?void 0:n.groups)&&void 0!==c?c:[];return r.a.createElement(Q,null,r.a.createElement(s.EuiFlexGroup,{"data-test-subj":"sloGroupOverviewPanel","data-shared-item":""},r.a.createElement(q,null,r.a.createElement(M,{view:"cardView",groupBy:e,groups:a,kqlQuery:t,filters:null==n?void 0:n.filters,reloadSubject:x}))))}return r.a.createElement(C,{sloId:e,sloInstanceId:t,reloadSubject:x,showAllGroupByInstances:a,remoteName:i})})())}}}}),Q=n.a.div.withConfig({displayName:"Wrapper",componentId:"sc-4lg5g6-0"})(["width:100%;padding:5px 15px;overflow:scroll;.euiAccordion__buttonContent{min-width:100px;}"]);var q=n()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-4lg5g6-1"})(["margin-top:20px;"])},76:function(e,t,a){e.exports=a(24)(4)},86:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var l=a(0),n=a(19);function i(){const e=Object(l.useContext)(n.a);if(!e)throw new Error("Plugin context value is missing!");return e}}}]);