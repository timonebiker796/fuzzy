/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.reporting_bundle_jsonpfunction=window.reporting_bundle_jsonpfunction||[]).push([[1],{43:function(e,t,n){"use strict";var i,s=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function a(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function r(e,t){for(var n={},i=[],s=0;s<e.length;s++){var r=e[s],l=t.base?r[0]+t.base:r[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var p=a(u),d={css:r[1],media:r[2],sourceMap:r[3]};-1!==p?(o[p].references++,o[p].updater(d)):o.push({identifier:u,updater:f(d,t),references:1}),i.push(u)}return i}function l(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var a=s(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function p(e,t,n,i){var s=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=u(t,s);else{var o=document.createTextNode(s),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function d(e,t,n){var i=n.css,s=n.media,o=n.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var g=null,h=0;function f(e,t){var n,i,s;if(t.singleton){var o=h++;n=g||(g=l(t)),i=p.bind(null,n,o,!1),s=p.bind(null,n,o,!0)}else n=l(t),i=d.bind(null,n,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var s=a(n[i]);o[s].references--}for(var l=r(e,t),c=0;c<n.length;c++){var u=a(n[c]);0===o[u].references&&(o[u].updater(),o.splice(u,1))}n=l}}}},44:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,i,s,o=e[1]||"",a=e[3];if(!a)return o;if(t&&"function"==typeof btoa){var r=(n=a,i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(s," */")),l=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[o].concat(l).concat([r]).join("\n")}return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(i)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(s[a]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);i&&s[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3);t.default=function(){var e=i.useRef(!1),t=i.useCallback((function(){return e.current}),[]);return i.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},46:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(47);case"v8light":return n(49)}},47:function(e,t,n){var i=n(43),s=n(48);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},48:function(e,t,n){(t=n(44)(!1)).push([e.i,".kbnReporting__reportListing__typeIcon{padding-left:8px}",""]),e.exports=t},49:function(e,t,n){var i=n(43),s=n(50);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},50:function(e,t,n){(t=n(44)(!1)).push([e.i,".kbnReporting__reportListing__typeIcon{padding-left:8px}",""]),e.exports=t},51:function(e,t,n){var i,s=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function s(e,t){if(!i[e]){i[e]={};for(var n=0;n<e.length;n++)i[e][e.charAt(n)]=n}return i[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(n){return s(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),i=0,s=t.length;i<s;i++){var a=t.charCodeAt(i);n[2*i]=a>>>8,n[2*i+1]=a%256}return n},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var n=new Array(t.length/2),i=0,s=n.length;i<s;i++)n[i]=256*t[2*i]+t[2*i+1];var a=[];return n.forEach((function(t){a.push(e(t))})),o.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return s(n,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var i,s,o,a={},r={},l="",c="",u="",p=2,d=3,g=2,h=[],f=0,b=0;for(o=0;o<e.length;o+=1)if(l=e.charAt(o),Object.prototype.hasOwnProperty.call(a,l)||(a[l]=d++,r[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(a,c))u=c;else{if(Object.prototype.hasOwnProperty.call(r,u)){if(u.charCodeAt(0)<256){for(i=0;i<g;i++)f<<=1,b==t-1?(b=0,h.push(n(f)),f=0):b++;for(s=u.charCodeAt(0),i=0;i<8;i++)f=f<<1|1&s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s>>=1}else{for(s=1,i=0;i<g;i++)f=f<<1|s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s=0;for(s=u.charCodeAt(0),i=0;i<16;i++)f=f<<1|1&s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s>>=1}0==--p&&(p=Math.pow(2,g),g++),delete r[u]}else for(s=a[u],i=0;i<g;i++)f=f<<1|1&s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s>>=1;0==--p&&(p=Math.pow(2,g),g++),a[c]=d++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(r,u)){if(u.charCodeAt(0)<256){for(i=0;i<g;i++)f<<=1,b==t-1?(b=0,h.push(n(f)),f=0):b++;for(s=u.charCodeAt(0),i=0;i<8;i++)f=f<<1|1&s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s>>=1}else{for(s=1,i=0;i<g;i++)f=f<<1|s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s=0;for(s=u.charCodeAt(0),i=0;i<16;i++)f=f<<1|1&s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s>>=1}0==--p&&(p=Math.pow(2,g),g++),delete r[u]}else for(s=a[u],i=0;i<g;i++)f=f<<1|1&s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s>>=1;0==--p&&(p=Math.pow(2,g),g++)}for(s=2,i=0;i<g;i++)f=f<<1|1&s,b==t-1?(b=0,h.push(n(f)),f=0):b++,s>>=1;for(;;){if(f<<=1,b==t-1){h.push(n(f));break}b++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,i){var s,o,a,r,l,c,u,p=[],d=4,g=4,h=3,f="",b=[],m={val:i(0),position:n,index:1};for(s=0;s<3;s+=1)p[s]=s;for(a=0,l=Math.pow(2,2),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;switch(a){case 0:for(a=0,l=Math.pow(2,8),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;u=e(a);break;case 1:for(a=0,l=Math.pow(2,16),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;u=e(a);break;case 2:return""}for(p[3]=u,o=u,b.push(u);;){if(m.index>t)return"";for(a=0,l=Math.pow(2,h),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;switch(u=a){case 0:for(a=0,l=Math.pow(2,8),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;p[g++]=e(a),u=g-1,d--;break;case 1:for(a=0,l=Math.pow(2,16),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;p[g++]=e(a),u=g-1,d--;break;case 2:return b.join("")}if(0==d&&(d=Math.pow(2,h),h++),p[u])f=p[u];else{if(u!==g)return null;f=o+o.charAt(0)}b.push(f),p[g++]=o+f.charAt(0),o=f,0==--d&&(d=Math.pow(2,h),h++)}}};return o}();void 0===(i=function(){return s}.call(t,n,t,e))||(e.exports=i)},57:function(e,t,n){"use strict";n.r(t),n.d(t,"mountManagementSection",(function(){return ie}));var i=n(3),s=n.n(i),o=n(16),a=n(25),r=n(29),l=n(12),c=n(10),u=n.n(c),p=(n(46),n(7)),d=n(4),g=n(0);const h=Object(i.createContext)(void 0),f=({children:e})=>{const{isLoading:t,data:n,resendRequest:i}=Object(l.f)();return Object(g.jsx)(h.Provider,{value:{isLoading:t,status:null==n?void 0:n.status,recheckStatus:i}},e)},b=()=>{const e=Object(i.useContext)(h);if(!e)throw new Error('"useIlmPolicyStatus" can only be used inside of "IlmPolicyStatusContext"');return e};var m=n(2),j=n(5),x=n(45),v=n.n(x);const y={title:m.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrationNeededTitle",{defaultMessage:"Apply new lifecycle policy for reports"}),description:Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.ilmPolicyCallout.migrationNeededDescription",defaultMessage:"To ensure your reports are managed consistently, all reporting indices should use the {ilmPolicyName} policy.",values:{ilmPolicyName:Object(g.jsx)(p.EuiCode,null,j.a)}}),buttonLabel:m.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesButtonLabel",{defaultMessage:"Apply {ilmPolicyName} policy",values:{ilmPolicyName:j.a}}),migrateErrorTitle:m.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesErrorTitle",{defaultMessage:"Could not migrate reporting indices"}),migrateSuccessTitle:m.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesSuccessTitle",{defaultMessage:"Reporting policy active for all reporting indices"})},O=({toasts:e,onMigrationDone:t})=>{const[n,s]=Object(i.useState)(!1),o=v()(),{apiClient:a}=Object(l.g)();return Object(g.jsx)(p.EuiCallOut,{"data-test-subj":"migrateReportingIndicesPolicyCallOut",title:y.title},Object(g.jsx)("p",null,y.description),Object(g.jsx)(p.EuiButton,{"data-test-subj":"migrateReportingIndicesButton",isLoading:n,onClick:async()=>{try{s(!0),await a.migrateReportingIndicesIlmPolicy(),t(),e.addSuccess({title:y.migrateSuccessTitle})}catch(t){var n;e.addError(t,{title:y.migrateErrorTitle,toastMessage:null===(n=t.body)||void 0===n?void 0:n.message})}finally{o()&&s(!1)}}},y.buttonLabel))},k=({toasts:e})=>{const{isLoading:t,recheckStatus:n,status:i}=b();return t||!i||"ok"===i?null:Object(g.jsx)(s.a.Fragment,null,Object(g.jsx)(p.EuiSpacer,{size:"m"}),Object(g.jsx)(p.EuiFlexItem,null,Object(g.jsx)(O,{toasts:e,onMigrationDone:n})))},w={buttonLabel:m.i18n.translate("xpack.reporting.listing.reports.ilmPolicyLinkText",{defaultMessage:"Edit reporting ILM policy"})},M=({locator:e,navigateToUrl:t})=>Object(g.jsx)(p.EuiButtonEmpty,{"data-test-subj":"ilmPolicyLink",size:"xs",onClick:()=>{const n=e.getRedirectUrl({page:"policy_edit",policyName:j.a});t(n)}},w.buttonLabel);class report_delete_button_ReportDeleteButton extends i.PureComponent{constructor(e){super(e),this.state={isDeleting:!1,showConfirm:!1}}hideConfirm(){this.setState({showConfirm:!1})}showConfirm(){this.setState({showConfirm:!0})}performDelete(){this.setState({isDeleting:!0}),this.props.performDelete().then((()=>{this.setState({isDeleting:!1})})).catch((e=>{console.error(e),this.setState({isDeleting:!1})}))}renderConfirm(){const{jobsToDelete:e}=this.props,t=e.length>1?m.i18n.translate("xpack.reporting.listing.table.deleteNumConfirmTitle",{defaultMessage:"Delete the {num} selected reports?",values:{num:e.length}}):m.i18n.translate("xpack.reporting.listing.table.deleteConfirmTitle",{defaultMessage:'Delete the "{name}" report?',values:{name:e[0].title}}),n=m.i18n.translate("xpack.reporting.listing.table.deleteConfirmMessage",{defaultMessage:"You can't recover deleted reports."}),i=m.i18n.translate("xpack.reporting.listing.table.deleteConfirmButton",{defaultMessage:"Delete"}),s=m.i18n.translate("xpack.reporting.listing.table.deleteCancelButton",{defaultMessage:"Cancel"});return Object(g.jsx)(p.EuiConfirmModal,{title:t,onCancel:()=>this.hideConfirm(),onConfirm:()=>this.performDelete(),confirmButtonText:i,confirmButtonDisabled:this.state.isDeleting,cancelButtonText:s,defaultFocusedButton:"confirm",buttonColor:"danger","data-test-subj":"deleteReportConfirm"},n)}render(){const{jobsToDelete:e}=this.props;return 0===e.length?null:Object(g.jsx)(i.Fragment,null,Object(g.jsx)(p.EuiButton,{onClick:()=>this.showConfirm(),iconType:"trash",color:"danger","data-test-subj":"deleteReportButton",disabled:this.state.showConfirm},m.i18n.translate("xpack.reporting.listing.table.deleteReportButton",{defaultMessage:"Delete {num, plural, one {report} other {reports} }",values:{num:e.length}})),this.state.showConfirm?this.renderConfirm():null)}}var C=function(e){return e.chromeStatus="chromeStatus",e.screenshotStatus="screenshotStatus",e}(C||{});const T={[C.chromeStatus]:"incomplete",isFlyoutVisible:!1,help:[],logs:"",isBusy:!1,success:!0},I=({apiClient:e,clientConfig:t})=>{const[n,s]=Object(i.useState)(T),o=e=>s({...n,...e}),{isBusy:a,chromeStatus:r,isFlyoutVisible:l}=n,c=t.export_types.pdf.enabled||t.export_types.png.enabled,u=()=>o({...T,isFlyoutVisible:!1});let h;if(l){let t;n.success&&"complete"===r?t=Object(g.jsx)(p.EuiCallOut,{id:"xpack.reporting.listing.diagnosticSuccessMessage",color:"success",title:m.i18n.translate("xpack.reporting.listing.diagnosticSuccessMessage",{defaultMessage:"Everything looks good for reporting to function."})}):n.success||"complete"!==r||(t=Object(g.jsx)(p.EuiCallOut,{id:"xpack.reporting.listing.diagnosticFailureTitle",iconType:"warning",color:"danger",title:m.i18n.translate("xpack.reporting.listing.diagnosticFailureTitle",{defaultMessage:"Something isn't working properly."})})),h=Object(g.jsx)(p.EuiFlyout,{onClose:u,"aria-labelledby":"reportingHelperTitle",size:"m"},Object(g.jsx)(p.EuiFlyoutHeader,{hasBorder:!0},Object(g.jsx)(p.EuiTitle,{size:"m"},Object(g.jsx)("h2",null,Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.diagnosticTitle",defaultMessage:"Screenshotting Diagnostics"}))),Object(g.jsx)(p.EuiSpacer,{size:"s"}),Object(g.jsx)(p.EuiText,{color:"subdued"},Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.diagnosticDescription",defaultMessage:"Run diagnostics to automatically troubleshoot common reporting problems."}))),Object(g.jsx)(p.EuiFlyoutBody,{banner:t},Object(g.jsx)(p.EuiTitle,{size:"s"},Object(g.jsx)("h2",null,Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserTitle",defaultMessage:"Check browser"}))),Object(g.jsx)(p.EuiSpacer,{size:"s"}),Object(g.jsx)(p.EuiText,{color:"subdued"},Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserMessage",defaultMessage:"Reporting uses a headless browser to generate PDF and PNGs. Validate that the browser can launch successfully."})),Object(g.jsx)(p.EuiSpacer,null),Object(g.jsx)(p.EuiButton,{disabled:a||"complete"===r,onClick:(f=()=>e.verifyBrowser(),b=C.chromeStatus,()=>{o({isBusy:!0,[b]:"incomplete"}),f().then((e=>{o({isBusy:!1,help:e.help,logs:e.logs,success:e.success,[b]:e.success?"complete":"danger"})})).catch((e=>{o({isBusy:!1,help:[m.i18n.translate("xpack.reporting.listing.diagnosticApiCallFailure",{defaultMessage:"There was a problem running the diagnostic: {error}",values:{error:e}})],logs:`${e.message}`,success:!1,[b]:"danger"})}))}),isLoading:a&&"incomplete"===r,iconType:"complete"===r?"check":void 0},Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserButton",defaultMessage:"Check browser"}))))}var f,b;return Object(g.jsx)("div",null,c&&Object(g.jsx)("div",null,h,Object(g.jsx)(p.EuiButtonEmpty,{"data-test-subj":"screenshotDiagnosticLink",size:"xs",flush:"left",onClick:()=>o({isFlyoutVisible:!0})},Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.diagnosticButton",defaultMessage:"Run screenshot diagnostics"}))))};var S=n(24);const E=e=>{switch(e){case"search":return"discoverApp";case"dashboard":return"dashboardApp";case"visualization":return"visualizeApp";case"canvas workpad":return"canvasApp";case"lens":return"lensApp";default:return"apps"}},_={completed:m.i18n.translate("xpack.reporting.statusIndicator.completedLabel",{defaultMessage:"Done"}),completedWithWarnings:m.i18n.translate("xpack.reporting.statusIndicator.completedWithWarningsLabel",{defaultMessage:"Done, warnings detected"}),pending:m.i18n.translate("xpack.reporting.statusIndicator.pendingLabel",{defaultMessage:"Pending"}),processing:({attempt:e,of:t})=>void 0!==t?m.i18n.translate("xpack.reporting.statusIndicator.processingMaxAttemptsLabel",{defaultMessage:"Processing, attempt {attempt} of {of}",values:{attempt:e,of:t}}):m.i18n.translate("xpack.reporting.statusIndicator.processingLabel",{defaultMessage:"Processing, attempt {attempt}",values:{attempt:e}}),failed:m.i18n.translate("xpack.reporting.statusIndicator.failedLabel",{defaultMessage:"Failed"}),unknown:m.i18n.translate("xpack.reporting.statusIndicator.unknownLabel",{defaultMessage:"Unknown"}),lastStatusUpdate:({date:e})=>m.i18n.translate("xpack.reporting.statusIndicator.lastStatusUpdateLabel",{defaultMessage:"Updated at {date}",values:{date:e}})},F=({job:e})=>{const t=Object(i.useMemo)((()=>(e=>Boolean(e.getWarnings())||[j.d.WARNINGS,j.d.FAILED].some((t=>e.status===t)))(e)),[e]);let n,s;switch(e.status){case S.c.COMPLETED:if(t){n=Object(g.jsx)(p.EuiIcon,{type:"warning",color:"warning"}),s=_.completedWithWarnings;break}n=Object(g.jsx)(p.EuiIcon,{type:"checkInCircleFilled",color:"success"}),s=_.completed;break;case S.c.WARNINGS:n=Object(g.jsx)(p.EuiIcon,{type:"warning",color:"warning"}),s=_.completedWithWarnings;break;case S.c.PENDING:n=Object(g.jsx)(p.EuiLoadingSpinner,null),s=_.pending;break;case S.c.PROCESSING:n=Object(g.jsx)(p.EuiLoadingSpinner,null),s=_.processing({attempt:e.attempts,of:e.max_attempts});break;case S.c.FAILED:n=Object(g.jsx)(p.EuiIcon,{type:"error",color:"danger"}),s=_.failed;break;default:n=Object(g.jsx)(p.EuiIcon,{type:"cross",color:"subdued"}),s=_.unknown}return Object(g.jsx)(p.EuiToolTip,{content:_.lastStatusUpdate({date:e.getPrettyStatusTimestamp()})},Object(g.jsx)(p.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1,"aria-label":s},Object(g.jsx)(p.EuiFlexItem,{grow:!1},n),Object(g.jsx)(p.EuiFlexItem,{grow:!1},s)))};var P=n(51),L=n(9);const R=e=>{const{csvConfig:t,job:n,searchSourceStart:s,locators:o}=e,{title:a,pagingStrategy:r}=n,l=n.payload.searchSource,c=Object(i.useCallback)((async()=>{const e=await s.create(l),n=e.getField("index");if(!n)throw new Error("The search must have a reference to an index pattern!");const i=n.getIndexPattern(),c=Object(P.compressToEncodedURIComponent)("scroll"===r?((e,t,n,i)=>{const s=Object(L.g)(n,i),o=`POST /${t}/_search?scroll=${i.scroll.duration}&ignore_unavailable=true`,a=JSON.stringify(s.requestBody,null,"  "),r=m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.introText.scroll",{description:"Script used in the Console app",defaultMessage:'\n# Report title: {jobTitle}\n# These are the queries used when exporting data for\n# the CSV report.\n#\n# For reference about the Elasticsearch Scroll API, see\n# https://www.elastic.co/guide/en/elasticsearch/reference/current/paginate-search-results.html#scroll-search-results\n\n# The first query opens a scroll context and receive back\n# the ID reference. The "scroll" value is taken from the\n# "xpack.reporting.csv.scroll.duration" setting.\n#\n# The response will include an "_scroll_id" value, which is\n# needed for the second query.\n{scanRequest}\n{scanBody}',values:{jobTitle:e,scanRequest:o,scanBody:a}}),l=JSON.stringify({scroll:i.scroll.duration,scroll_id:"[ID returned from latest request]"},null,"  "),c=m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.queryText.scroll",{description:"Script used in the Console app",defaultMessage:'\n# The second query executes a search using the scroll ID.\n# The "scroll" value comes from the\n# "xpack.reporting.csv.scroll.duration" setting in\n# kibana.yml.\n#\n# The reponse will include new a scroll ID, which might\n# not be the same as the ID returned from the first query.\n# When paging through the data, always use the scroll ID\n# from the latest search response.\n{pagingRequest}\n{pagingBody}',values:{pagingRequest:"POST /_search/scroll",pagingBody:l}}),u=m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.pagingText.scroll",{description:"Script used in the Console app",defaultMessage:"\n# The first request retrieved the first page of search\n# results. If you want to retrieve more hits, keep calling\n# the search API with the scroll ID."}),p=`DELETE /_search/scroll\n${JSON.stringify({scroll_id:"[ID returned from latest request]"},null,"  ")}`;return`${r}\n${c}\n${u}\n${m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.closingText.scroll",{description:"Script used in the Console app",defaultMessage:"\n# Finally, release the resources held in Elasticsearch\n# memory by clearing the scroll context.\n{clearScrollRequest}",values:{clearScrollRequest:p}})}`.trim()})(a,i,e,t):((e,t,n,i)=>{const s=m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.examplePitId",{defaultMessage:"[ID returned from first request]",description:"This gets used in place of an ID string that is sent in a request body."}),o=Object(L.g)(n,i,s),a=`POST /${t}/_pit?keep_alive=${i.scroll.duration}&ignore_unavailable=true`,r=`DELETE /_pit\n${JSON.stringify({id:"[ID returned from latest request]"},null,"  ")}`,l=m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.introText.pit",{description:"Script used in the Console app",defaultMessage:'\n# Report title: {jobTitle}\n# These are the queries used when exporting data for\n# the CSV report.\n#\n# For reference about the Elasticsearch Point-In-Time\n# API, see\n# https://www.elastic.co/guide/en/elasticsearch/reference/current/point-in-time-api.html\n\n# The first query opens a Point-In-Time (PIT) context\n# and receive back the ID reference. The "keep_alive"\n# value is taken from the\n# "xpack.reporting.csv.scroll.duration" setting.\n#\n# The response will include an "id" value, which is\n# needed for the second query.\n{pitRequest}',values:{jobTitle:e,pitRequest:a}}),{requestBody:c}=o,u=JSON.stringify(c,null,"  ");return`${l}\n${m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.queryText.pit",{description:"Script used in the Console app",defaultMessage:'\n# The second query executes a search using the PIT ID.\n# The "keep_alive" and "size" values come from the\n# "xpack.reporting.csv.scroll.duration" and\n# "xpack.reporting.csv.scroll.size" settings in\n# kibana.yml.\n#\n# The reponse will include new a PIT ID, which might not\n# be the same as the ID returned from the first query.\n# When paging through the data, always use the PIT ID from\n# the latest search response. See\n# https://www.elastic.co/guide/en/elasticsearch/reference/current/paginate-search-results.html\n{queryRequest}\n{queryAsString}',values:{queryRequest:"POST /_search",queryAsString:u}})}\n${m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.pagingText.pit",{description:"Script used in the Console app",defaultMessage:"\n# The first request retrieved the first page of search\n# results. If you want to retrieve more hits, use the\n# latest PIT ID with search_after."})}\n${m.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.closingText.pit",{description:"Script used in the Console app",defaultMessage:"\n# Finally, release the resources held in Elasticsearch\n# memory by closing the PIT.\n{closePitRequest}",values:{closePitRequest:r}})}`.trim()})(a,i,e,t)),u=o.get("CONSOLE_APP_LOCATOR");null==u||u.navigate({loadFrom:`data:text/plain,${c}`})}),[s,l,a,r,t,o]);return Object(g.jsx)(p.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutOpenInConsoleButton",key:"download",icon:"wrench",onClick:c},m.i18n.translate("xpack.reporting.reportInfoFlyout.openInConsole",{defaultMessage:"Inspect query in Console",description:"An option in a menu of actions."}))},A=e=>{const{config:t,job:n}=e,{services:i}=Object(a.useKibana)(),{application:s,data:o,share:r}=i,{capabilities:l}=s,{locators:c}=r.url;return"search"===n.objectType&&l.dev_tools.show?Object(g.jsx)(R,{searchSourceStart:o.search.searchSource,locators:c,job:n,csvConfig:t.csv}):null};var D=n(15),B=n.n(D),q=n(17),z=n(13),N=n(14);L.e,L.f,z.c,z.d,N.c,N.d,L.a,L.c,z.a,z.b,N.a,N.b;const U=[z.a,N.a,z.b,N.b];L.b;var J=n(28);const $=m.i18n.translate("xpack.reporting.listing.infoPanel.notApplicableLabel",{defaultMessage:"N/A"}),K=m.i18n.translate("xpack.reporting.listing.infoPanel.unknownLabel",{defaultMessage:"unknown"}),W=({info:e})=>{var t,n,i,o,a,r,c,u,d,h,f,b,j,x,v,y,O,k,w,M,C,T,I,S;const{services:{uiSettings:E,docLinks:_}}=Object(l.h)(),F="Browser"===E.get("dateFormat:tz")?B.a.tz.guess():E.get("dateFormat:tz"),P=(L=E.get("dateFormat"),R=F,e=>{const t=B.a.tz(e,R);return t.isValid()?t.format(L):$});var L,R;const A=e=>m.i18n.translate("xpack.reporting.listing.infoPanel.msToSeconds",{defaultMessage:"{seconds} seconds",values:{seconds:(e/1e3).toFixed(3)}}),D=null!=e.started_at,z=null!=e.completed_at,N=null!==(t=null===(n=e.metrics)||void 0===n||null===(i=n.pdf)||void 0===i?void 0:i.cpuInPercentage)&&void 0!==t?t:null===(o=e.metrics)||void 0===o||null===(a=o.png)||void 0===a?void 0:a.cpuInPercentage,W=null!==(r=null===(c=e.metrics)||void 0===c||null===(u=c.pdf)||void 0===u?void 0:u.memoryInMegabytes)&&void 0!==r?r:null===(d=e.metrics)||void 0===d||null===(h=d.png)||void 0===h?void 0:h.memoryInMegabytes,H=null!=(null===(f=e.metrics)||void 0===f||null===(b=f.csv)||void 0===b?void 0:b.rows),G=null!=e.pagingStrategy,V=U.includes(e.jobtype),Q=null!=(null===(j=e.metrics)||void 0===j||null===(x=j.pdf)||void 0===x?void 0:x.pages),Y=[{title:m.i18n.translate("xpack.reporting.listing.infoPanel.statusInfo",{defaultMessage:"Status"}),description:e.prettyStatus},Boolean(e.version)&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.kibanaVersion",{defaultMessage:"Kibana version"}),description:e.version},Boolean(e.spaceId)&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.space",{defaultMessage:"Kibana space"}),description:e.spaceId},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.attemptsInfo",{defaultMessage:"Attempts"}),description:e.max_attempts?m.i18n.translate("xpack.reporting.listing.infoPanel.attempts",{defaultMessage:"{attempts} of {maxAttempts}",values:{attempts:e.attempts,maxAttempts:e.max_attempts}}):e.attempts},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.contentTypeInfo",{defaultMessage:"Content type"}),description:e.content_type||$},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.sizeInfo",{defaultMessage:"Size in bytes"}),description:(null===(v=e.size)||void 0===v?void 0:v.toString())||$},H&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.csvRows",{defaultMessage:"CSV rows"}),description:(null===(y=e.metrics)||void 0===y||null===(O=y.csv)||void 0===O||null===(k=O.rows)||void 0===k?void 0:k.toString())||$},G&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.csvSearchStrategy",{defaultMessage:"Search strategy"}),description:e.pagingStrategy||$},V&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.dimensionsInfoHeight",{defaultMessage:"Height in pixels"}),description:null!=(null===(w=e.layout)||void 0===w||null===(M=w.dimensions)||void 0===M?void 0:M.height)?Math.ceil(e.layout.dimensions.height):K},V&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.dimensionsInfoWidth",{defaultMessage:"Width in pixels"}),description:null!=(null===(C=e.layout)||void 0===C||null===(T=C.dimensions)||void 0===T?void 0:T.width)?Math.ceil(e.layout.dimensions.width):K},Q&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.pdfPagesInfo",{defaultMessage:"Pages count"}),description:null===(I=e.metrics)||void 0===I||null===(S=I.pdf)||void 0===S?void 0:S.pages},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.jobId",{defaultMessage:"Report job ID"}),description:e.id},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.processedByInfo",{defaultMessage:"Processed by"}),description:e.kibana_name&&e.kibana_id?`${e.kibana_name} (${e.kibana_id})`:$},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.timeoutInfo",{defaultMessage:"Timeout"}),description:e.prettyTimeout},null!=N&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.cpuInfo",{defaultMessage:"CPU usage"}),description:`${N}%`},null!=W&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.memoryInfo",{defaultMessage:"RAM usage"}),description:`${W}MB`}].filter(Boolean),X=[{title:m.i18n.translate("xpack.reporting.listing.infoPanel.tzInfo",{defaultMessage:"Time zone"}),description:e.browserTimezone||$},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.createdAtInfo",{defaultMessage:"Created at"}),description:e.created_at?P(e.created_at):$},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.startedAtInfo",{defaultMessage:"Started at"}),description:e.started_at?P(e.started_at):$},{title:m.i18n.translate("xpack.reporting.listing.infoPanel.completedAtInfo",{defaultMessage:"Completed at"}),description:e.completed_at?P(e.completed_at):$},D&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.queueTime",{defaultMessage:"Queue time"}),description:e.queue_time_ms?A(e.queue_time_ms):$},z&&{title:m.i18n.translate("xpack.reporting.listing.infoPanel.executionTime",{defaultMessage:"Execution time"}),description:e.execution_time_ms?A(e.execution_time_ms):$}].filter(Boolean),Z=e.getWarnings(),ee=e.error_code===q.a.code?J.a.cloud.insufficientMemoryError(_.links.reporting.cloudMinimumRequirements):e.getError();return Object(g.jsx)(s.a.Fragment,null,Boolean(ee)&&Object(g.jsx)(s.a.Fragment,null,Object(g.jsx)(p.EuiCallOut,{title:m.i18n.translate("xpack.reporting.listing.infoPanel.callout.failedReportTitle",{defaultMessage:"No report generated"}),color:"danger"},ee),Object(g.jsx)(p.EuiSpacer,null)),Boolean(Z)&&Object(g.jsx)(s.a.Fragment,null,Boolean(ee)&&Object(g.jsx)(p.EuiSpacer,{size:"s"}),Object(g.jsx)(p.EuiCallOut,{title:m.i18n.translate("xpack.reporting.listing.infoPanel.callout.warningsTitle",{defaultMessage:"Report contains warnings"}),color:"warning"},Z)),Object(g.jsx)(p.EuiTitle,{size:"s"},Object(g.jsx)("h3",null,m.i18n.translate("xpack.reporting.listing.infoPanel.outputSectionTitle",{defaultMessage:"Output"}))),Object(g.jsx)(p.EuiSpacer,{size:"s"}),Object(g.jsx)(p.EuiDescriptionList,{listItems:Y,type:"column",align:"center",compressed:!0}),Object(g.jsx)(p.EuiSpacer,null),Object(g.jsx)(p.EuiTitle,{size:"s"},Object(g.jsx)("h3",null,m.i18n.translate("xpack.reporting.listing.infoPanel.timestampSectionTitle",{defaultMessage:"Timestamps"}))),Object(g.jsx)(p.EuiSpacer,{size:"s"}),Object(g.jsx)(p.EuiDescriptionList,{listItems:X,type:"column",align:"center",compressed:!0}))},H=({config:e,onClose:t,job:n})=>{var s;const o=v()(),{apiClient:a}=Object(l.g)(),[r,c]=Object(i.useState)(!0),[u,d]=Object(i.useState)(),[h,f]=Object(i.useState)(!1),[b,j]=Object(i.useState)();Object(i.useEffect)((()=>{!async function(){if(r)try{const e=await a.getInfo(n.id);o()&&j(e)}catch(e){o()&&d(e)}finally{o()&&c(!1)}}()}),[r,a,n.id,o]);const x=Object(g.jsx)(p.EuiButton,{"data-test-subj":"reportInfoFlyoutActionsButton",iconType:"arrowUp",onClick:()=>f((e=>!e))},m.i18n.translate("xpack.reporting.reportInfoFlyout.actionsButtonLabel",{defaultMessage:"Actions"})),y=[Object(g.jsx)(p.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutDownloadButton",key:"download",icon:"download",disabled:!n.isDownloadReady,onClick:()=>{a.downloadReport(n.id)}},m.i18n.translate("xpack.reporting.reportInfoFlyout.downloadButtonLabel",{defaultMessage:"Download"})),Object(g.jsx)(A,{job:n,config:e}),Object(g.jsx)(p.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutOpenInKibanaButton",disabled:!n.canLinkToKibanaApp,key:"openInKibanaApp",icon:"popout",onClick:()=>{window.open(a.getKibanaAppHref(n),"_blank"),window.focus()}},m.i18n.translate("xpack.reporting.reportInfoFlyout.openInKibanaAppButtonLabel",{defaultMessage:"Open in Kibana"}))].filter(Boolean);return Object(g.jsx)(p.EuiPortal,null,Object(g.jsx)(p.EuiFlyout,{ownFocus:!0,onClose:t,size:"s","aria-labelledby":"flyoutTitle","data-test-subj":"reportInfoFlyout"},Object(g.jsx)(p.EuiFlyoutHeader,{hasBorder:!0},Object(g.jsx)(p.EuiTitle,{size:"m"},Object(g.jsx)("h2",{id:"flyoutTitle"},u?m.i18n.translate("xpack.reporting.listing.table.reportInfoUnableToFetch",{defaultMessage:"Unable to fetch report info."}):null!==(s=null==b?void 0:b.title)&&void 0!==s?s:m.i18n.translate("xpack.reporting.listing.table.untitledReport",{defaultMessage:"Untitled report"})))),Object(g.jsx)(p.EuiFlyoutBody,null,r?Object(g.jsx)(p.EuiLoadingSpinner,null):u?void 0:b?Object(g.jsx)(W,{info:b}):void 0),!r&&Object(g.jsx)(p.EuiFlyoutFooter,null,Object(g.jsx)(p.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},Object(g.jsx)(p.EuiFlexItem,{grow:!1},Object(g.jsx)(p.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:t},m.i18n.translate("xpack.reporting.listing.flyout.closeButtonLabel",{defaultMessage:"Close"}))),Object(g.jsx)(p.EuiFlexItem,{grow:!1},Object(g.jsx)(p.EuiPopover,{id:"reportInfoFlyoutActionsPopover",button:x,isOpen:h,closePopover:()=>f(!1),panelPaddingSize:"none"},Object(g.jsx)(p.EuiContextMenuPanel,{items:y})))))))};var G=n(1),V=n.n(G),Q=n(27),Y=n.n(Q);class poller_Poller{constructor(e){V()(this,"functionToPoll",void 0),V()(this,"successFunction",void 0),V()(this,"errorFunction",void 0),V()(this,"_isRunning",void 0),V()(this,"_timeoutId",void 0),V()(this,"pollFrequencyInMillis",void 0),V()(this,"trailing",void 0),V()(this,"continuePollingOnError",void 0),V()(this,"pollFrequencyErrorMultiplier",void 0),this.functionToPoll=e.functionToPoll,this.successFunction=e.successFunction||Y.a.noop,this.errorFunction=e.errorFunction||Y.a.noop,this.pollFrequencyInMillis=e.pollFrequencyInMillis,this.trailing=e.trailing||!1,this.continuePollingOnError=e.continuePollingOnError||!1,this.pollFrequencyErrorMultiplier=e.pollFrequencyErrorMultiplier||1,this._timeoutId=null,this._isRunning=!1}getPollFrequency(){return this.pollFrequencyInMillis}_poll(){return this.functionToPoll().then(this.successFunction).then((()=>{this._isRunning&&(this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis))})).catch((e=>{this.errorFunction(e),this._isRunning&&(this.continuePollingOnError?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis*this.pollFrequencyErrorMultiplier):this.stop())}))}start(){this._isRunning||(this._isRunning=!0,this.trailing?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis):this._poll())}stop(){this._isRunning&&(this._isRunning=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=null)}isRunning(){return this._isRunning}}class report_listing_table_ReportListingTable extends i.Component{constructor(e){super(e),V()(this,"isInitialJobsFetch",void 0),V()(this,"licenseSubscription",void 0),V()(this,"mounted",void 0),V()(this,"poller",void 0),V()(this,"licenseHandler",(e=>{const{enableLinks:t,showLinks:n,message:i}=Object(l.d)(e.check("reporting","basic"));this.setState({enableLinks:t,showLinks:n,badLicenseMessage:i})})),V()(this,"onSelectionChange",(e=>{this.setState((t=>({...t,selectedJobs:e})))})),V()(this,"removeJob",(e=>{const{jobs:t}=this.state,n=t.filter((t=>t.id!==e.id));this.setState((e=>({...e,jobs:n})))})),V()(this,"renderDeleteButton",(()=>{const{selectedJobs:e}=this.state;if(0!==e.length)return Object(g.jsx)(report_delete_button_ReportDeleteButton,u()({jobsToDelete:e,performDelete:async()=>{for(const t of e)try{await this.props.apiClient.deleteReport(t.id),this.removeJob(t),this.props.toasts.addSuccess(m.i18n.translate("xpack.reporting.listing.table.deleteConfim",{defaultMessage:"The {reportTitle} report was deleted",values:{reportTitle:t.title}}))}catch(e){throw this.props.toasts.addDanger(m.i18n.translate("xpack.reporting.listing.table.deleteFailedErrorMessage",{defaultMessage:"The report was not deleted: {error}",values:{error:e}})),e}}},this.props))})),V()(this,"onTableChange",(({page:e})=>{const{index:t}=e;this.setState((()=>({page:t})),this.fetchJobs)})),V()(this,"fetchJobs",(async()=>{let e,t;this.isInitialJobsFetch&&this.setState((()=>({isLoading:!0})));try{e=await this.props.apiClient.list(this.state.page),t=await this.props.apiClient.total(),this.isInitialJobsFetch=!1}catch(e){return this.licenseAllowsToShowThisPage()?("Failed to fetch"===e.message&&this.props.toasts.addDanger(e.message||m.i18n.translate("xpack.reporting.listing.table.requestFailedErrorMessage",{defaultMessage:"Request failed"})),void(this.mounted&&this.setState((()=>({isLoading:!1,jobs:[],total:0}))))):(this.props.toasts.addDanger(this.state.badLicenseMessage),void this.props.redirect("management"))}this.mounted&&this.setState((()=>({isLoading:!1,total:t,jobs:e})))})),V()(this,"licenseAllowsToShowThisPage",(()=>this.state.showLinks&&this.state.enableLinks)),V()(this,"tableColumnWidths",{type:"5%",title:"30%",status:"20%",createdAt:"25%",content:"10%",actions:"10%"}),this.state={page:0,total:0,jobs:[],selectedJobs:[],isLoading:!1,showLinks:!1,enableLinks:!1,badLicenseMessage:"",selectedJob:void 0},this.isInitialJobsFetch=!0}componentWillUnmount(){var e;this.mounted=!1,null===(e=this.poller)||void 0===e||e.stop(),this.licenseSubscription&&this.licenseSubscription.unsubscribe()}componentDidMount(){this.mounted=!0;const{config:e,license$:t}=this.props,n=Object(j.l)(e.poll.jobsRefresh.interval);this.poller=new poller_Poller({functionToPoll:()=>this.fetchJobs(),pollFrequencyInMillis:n,trailing:!1,continuePollingOnError:!0,pollFrequencyErrorMultiplier:e.poll.jobsRefresh.intervalErrorMultiplier}),this.poller.start(),this.licenseSubscription=t.subscribe(this.licenseHandler)}render(){const{tableColumnWidths:e}=this,t=[{field:"type",width:e.type,name:m.i18n.translate("xpack.reporting.listing.tableColumns.typeTitle",{defaultMessage:"Type"}),render:(e,t)=>Object(g.jsx)("div",{className:"kbnReporting__reportListing__typeIcon"},Object(g.jsx)(p.EuiIconTip,{type:E(t.objectType),size:"s","data-test-subj":"reportJobType",content:t.objectType})),mobileOptions:{show:!0,render:e=>Object(g.jsx)("div",{"data-test-subj":"reportJobType"},e.objectType)}},{field:"title",name:m.i18n.translate("xpack.reporting.listing.tableColumns.reportTitle",{defaultMessage:"Title"}),width:e.title,render:(e,t)=>Object(g.jsx)("div",{"data-test-subj":"reportingListItemObjectTitle"},Object(g.jsx)(p.EuiLink,{"data-test-subj":`viewReportingLink-${t.id}`,onClick:()=>this.setState({selectedJob:t})},e||m.i18n.translate("xpack.reporting.listing.table.noTitleLabel",{defaultMessage:"Untitled"}))),mobileOptions:{header:!1,width:"100%"}},{field:"status",width:e.status,name:m.i18n.translate("xpack.reporting.listing.tableColumns.statusTitle",{defaultMessage:"Status"}),render:(e,t)=>Object(g.jsx)(p.EuiFlexGroup,{gutterSize:"none",responsive:!1,alignItems:"center","data-test-subj":"reportJobStatus"},Object(g.jsx)(F,{job:t})),mobileOptions:{show:!1}},{field:"created_at",width:e.createdAt,name:m.i18n.translate("xpack.reporting.listing.tableColumns.createdAtTitle",{defaultMessage:"Created at"}),render:(e,t)=>Object(g.jsx)("div",{"data-test-subj":"reportJobCreatedAt"},t.getCreatedAtDate()),mobileOptions:{show:!1}},{field:"content",width:e.content,name:m.i18n.translate("xpack.reporting.listing.tableColumns.content",{defaultMessage:"Content"}),render:(e,t)=>(e=>{switch(e){case z.a:case z.b:return"PDF";case L.a:case L.b:return"CSV";case N.a:case N.b:return"PNG";default:return e}})(t.jobtype),mobileOptions:{show:!1}},{name:m.i18n.translate("xpack.reporting.listing.tableColumns.actionsTitle",{defaultMessage:"Actions"}),width:e.actions,actions:[{isPrimary:!0,"data-test-subj":"reportDownloadLink",type:"icon",icon:"download",name:m.i18n.translate("xpack.reporting.listing.table.downloadReportButtonLabel",{defaultMessage:"Download report"}),description:m.i18n.translate("xpack.reporting.listing.table.downloadReportDescription",{defaultMessage:"Download this report in a new tab."}),onClick:e=>this.props.apiClient.downloadReport(e.id),enabled:e=>e.isDownloadReady},{name:m.i18n.translate("xpack.reporting.listing.table.viewReportingInfoActionButtonLabel",{defaultMessage:"View report info"}),description:m.i18n.translate("xpack.reporting.listing.table.viewReportingInfoActionButtonDescription",{defaultMessage:"View additional information about this report."}),type:"icon",icon:"iInCircle",onClick:e=>this.setState({selectedJob:e})},{name:m.i18n.translate("xpack.reporting.listing.table.openInKibanaAppLabel",{defaultMessage:"Open in Kibana"}),"data-test-subj":"reportOpenInKibanaApp",description:m.i18n.translate("xpack.reporting.listing.table.openInKibanaAppDescription",{defaultMessage:"Open the Kibana app where this report was generated."}),available:e=>e.canLinkToKibanaApp,type:"icon",icon:"popout",onClick:e=>{const t=this.props.apiClient.getKibanaAppHref(e);window.open(t,"_blank"),window.focus()}}]}],n={pageIndex:this.state.page,pageSize:10,totalItemCount:this.state.total,showPerPageOptions:!1},s={itemId:"id",onSelectionChange:this.onSelectionChange};return Object(g.jsx)(i.Fragment,null,this.state.selectedJobs.length>0&&Object(g.jsx)("div",null,Object(g.jsx)(p.EuiFlexGroup,{alignItems:"center",justifyContent:"flexStart",gutterSize:"m"},Object(g.jsx)(p.EuiFlexItem,{grow:!1},this.renderDeleteButton())),Object(g.jsx)(p.EuiSpacer,{size:"l"})),Object(g.jsx)(p.EuiBasicTable,{tableCaption:m.i18n.translate("xpack.reporting.listing.table.captionDescription",{defaultMessage:"Reports generated in Kibana applications"}),itemId:"id",items:this.state.jobs,loading:this.state.isLoading,columns:t,noItemsMessage:this.state.isLoading?m.i18n.translate("xpack.reporting.listing.table.loadingReportsDescription",{defaultMessage:"Loading reports"}):m.i18n.translate("xpack.reporting.listing.table.noCreatedReportsDescription",{defaultMessage:"No reports have been created"}),pagination:n,selection:s,onChange:this.onTableChange,"data-test-subj":j.i,rowProps:()=>({"data-test-subj":j.j})}),!!this.state.selectedJob&&Object(g.jsx)(H,{config:this.props.config,onClose:()=>this.setState({selectedJob:void 0}),job:this.state.selectedJob}))}}const X=e=>{var t,n;const{apiClient:i,capabilities:o,config:a,navigateToUrl:r,toasts:l,urlService:c,...h}=e,f=c.locators.get("ILM_LOCATOR_ID"),m=b(),j="policy-not-found"!==(null==m?void 0:m.status),x=Boolean(f&&j);return Object(g.jsx)(s.a.Fragment,null,Object(g.jsx)(p.EuiPageHeader,{"data-test-subj":"reportingPageHeader",bottomBorder:!0,pageTitle:Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.reports.titleStateful",defaultMessage:"Reports"}),description:Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.reports.subtitleStateful",defaultMessage:"Get reports generated in Kibana applications."})}),Object(g.jsx)(k,{toasts:l}),Object(g.jsx)(p.EuiSpacer,{size:"l"}),Object(g.jsx)(report_listing_table_ReportListingTable,u()({},h,{apiClient:i,capabilities:o,config:a,toasts:l,navigateToUrl:r,urlService:c})),Object(g.jsx)(p.EuiSpacer,{size:"s"}),Object(g.jsx)(p.EuiFlexGroup,{justifyContent:"flexEnd"},(null==o||null===(t=o.management)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.index_lifecycle_management)&&Object(g.jsx)(p.EuiFlexItem,{grow:!1},null!=m&&m.isLoading?Object(g.jsx)(p.EuiLoadingSpinner,null):x&&Object(g.jsx)(M,{navigateToUrl:r,locator:f})),Object(g.jsx)(p.EuiFlexItem,{grow:!1},Object(g.jsx)(I,{clientConfig:a,apiClient:i}))))},Z=e=>{const{apiClient:t,capabilities:n,config:i,navigateToUrl:o,toasts:a,urlService:r,...l}=e;return Object(g.jsx)(s.a.Fragment,null,Object(g.jsx)(p.EuiPageHeader,{"data-test-subj":"reportingPageHeader",bottomBorder:!0,pageTitle:Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.reportstitle",defaultMessage:"Reports"}),description:Object(g.jsx)(d.FormattedMessage,{id:"xpack.reporting.listing.reports.subtitle",defaultMessage:"Get reports generated in Kibana applications."})}),Object(g.jsx)(p.EuiSpacer,{size:"l"}),Object(g.jsx)(report_listing_table_ReportListingTable,u()({},l,{apiClient:t,capabilities:n,config:i,toasts:a,navigateToUrl:o,urlService:r})))},ee=e=>{const{apiClient:t}=Object(l.g)(),{services:{application:{capabilities:n}}}=Object(l.h)();return e.config.statefulSettings.enabled?Object(g.jsx)(X,u()({},e,{apiClient:t,capabilities:n})):Object(g.jsx)(Z,u()({},e,{apiClient:t,capabilities:n}))},te=Object(i.createContext)(void 0),ne=({children:e,...t})=>t.config.statefulSettings.enabled?Object(g.jsx)(f,null,e):Object(g.jsx)(te.Provider,{value:void 0},e);async function ie(e,t,n,i,s,c,u){const p={http:e.http,application:e.application,uiSettings:e.uiSettings,docLinks:e.docLinks,data:n,share:i};return Object(o.render)(Object(g.jsx)(r.a,e,Object(g.jsx)(a.KibanaContextProvider,{services:p},Object(g.jsx)(l.a,{apiClient:c,http:e.http},Object(g.jsx)(ne,{config:s},Object(g.jsx)(ee,{apiClient:c,toasts:e.notifications.toasts,license$:t,config:s,redirect:e.application.navigateToApp,navigateToUrl:e.application.navigateToUrl,urlService:i.url}))))),u.element),()=>{Object(o.unmountComponentAtNode)(u.element)}}}}]);