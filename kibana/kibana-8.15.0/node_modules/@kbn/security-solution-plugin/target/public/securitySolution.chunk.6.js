/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[6],{1215:function(t,e,s){"use strict";s.d(e,"b",(function(){return n})),s.d(e,"d",(function(){return a})),s.d(e,"g",(function(){return i})),s.d(e,"f",(function(){return r})),s.d(e,"i",(function(){return o})),s.d(e,"k",(function(){return c})),s.d(e,"c",(function(){return l})),s.d(e,"h",(function(){return u})),s.d(e,"j",(function(){return d})),s.d(e,"a",(function(){return p})),s.d(e,"e",(function(){return f}));const n="attackDiscovery",a="elasticAssistantDefault",i="lastConversationId",r="knowledgeBase",o="streaming",c="traceOptions",l="conversationTable",u="quickPromptTable",d="systemPromptTable",p="anonymizationTable",f={latestAlerts:20}},1340:function(t,e,s){"use strict";s.d(e,"c",(function(){return i})),s.d(e,"e",(function(){return r})),s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return c})),s.d(e,"d",(function(){return l})),s.d(e,"f",(function(){return u}));var n=s(7),a=s(1450);const i=t=>{const{response:e,isStream:s,isError:n}=t,a=(new Date).toISOString();return t?{role:"assistant",...s?{reader:e}:{content:e},timestamp:a,isError:n,traceData:t.traceData}:{role:"assistant",content:"Error: Response from LLM API is empty or undefined.",timestamp:a,isError:!0}},r=(t,e)=>{var s;return[...null!==(s=null==e?void 0:e.data)&&void 0!==s?s:[],...Object.values(t)].reduce(((t,e)=>(Object(n.isEmpty)(e.id)?Object(n.some)(Object.values(t),["title",e.title])||(t[e.title]=e):t[e.id]=e,t)),{})},o=(t,e)=>e?{...t,messages:t.messages}:0===t.messages.length||t.messages[t.messages.length-1].content!==a.b[0].content?{...t,messages:[...t.messages,...a.b]}:t,c=t=>{const e=null==t?void 0:t.filter((t=>!t.isMissingSecrets));if(null!=e&&e.length)return e[0]},l=({alertsIndexPattern:t,size:e})=>({...t?{alertsIndexPattern:t}:void 0,...e?{size:e}:void 0}),u=t=>new Promise((e=>setTimeout(e,t)))},1376:function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return i}));var n=s(4);const a=n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.welcomeConversationTitle",{defaultMessage:"Welcome"}),i=n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.defaultConversationTitle",{defaultMessage:"Default"});n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),n.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantName",{defaultMessage:"Assistant"})},1446:function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"f",(function(){return i})),s.d(e,"a",(function(){return r})),s.d(e,"e",(function(){return o})),s.d(e,"d",(function(){return c})),s.d(e,"h",(function(){return l})),s.d(e,"g",(function(){return u})),s.d(e,"c",(function(){return d}));var n=s(4);n.i18n.translate("xpack.elasticAssistant.assistant.clearChat",{defaultMessage:"Clear chat"});const a=n.i18n.translate("xpack.elasticAssistant.assistant.defaultAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),i=n.i18n.translate("xpack.elasticAssistant.assistant.submitMessage",{defaultMessage:"Submit message"}),r=n.i18n.translate("xpack.elasticAssistant.assistant.apiErrorTitle",{defaultMessage:"An error occurred sending your message."}),o=(n.i18n.translate("xpack.elasticAssistant.documentationLinks.ariaLabel",{defaultMessage:"Click to open Elastic Assistant documentation in a new tab"}),n.i18n.translate("xpack.elasticAssistant.documentationLinks.documentation",{defaultMessage:"documentation"}),n.i18n.translate("xpack.elasticAssistant.assistant.emptyScreen.title",{defaultMessage:"How I can help you?"})),c=n.i18n.translate("xpack.elasticAssistant.assistant.emptyScreen.description",{defaultMessage:'Ask me anything from "Summarize this alert" to "Help me build a query" using the following system prompt:'}),l=n.i18n.translate("xpack.elasticAssistant.assistant.welcomeScreen.title",{defaultMessage:"Welcome to Security AI Assistant!"}),u=n.i18n.translate("xpack.elasticAssistant.assistant.welcomeScreen.description",{defaultMessage:"First things first, we'll need to set up a Generative AI Connector to get this chat experience going!"}),d=n.i18n.translate("xpack.elasticAssistant.assistant.disclaimer",{defaultMessage:"Responses from Al systems may not always be entirely accurate, although they can seem convincing. For more information on the assistant feature and its usage, please reference the documentation."})},1450:function(t,e,s){"use strict";s.d(e,"a",(function(){return a})),s.d(e,"b",(function(){return i}));var n=s(1678);const a={id:"",title:s(1376).b,category:"assistant",messages:[],replacements:{},excludeFromLastConversationStorage:!0},i=[{role:"assistant",content:n.a,timestamp:"",presentation:{delay:2e3,stream:!0}}]},1539:function(t,e,s){"use strict";s.d(e,"b",(function(){return c})),s.d(e,"a",(function(){return l}));var n=s(47),a=s(2081),i=s(2080),r=s(4),o=s(241);const c=t=>{var e;const{assistantAvailability:{isAssistantEnabled:s},http:r}=Object(o.b)(),c={page:1,per_page:1e3,filter:`consumer:${null!==(e=null==t?void 0:t.consumer)&&void 0!==e?e:"*"}`},l=[a.i,c.page,c.per_page,c.filter,i.a.public.v1];return Object(n.useQuery)(l,(async()=>r.fetch(a.i,{method:"GET",version:i.a.public.v1,query:c,signal:null==t?void 0:t.signal})),{initialData:{data:[],page:1,perPage:5,total:0},placeholderData:{data:[],page:1,perPage:5,total:0},keepPreviousData:!0,enabled:s})},l=async({http:t,signal:e,toasts:s})=>{try{return await t.fetch(a.i,{method:"GET",version:i.a.public.v1,signal:e})}catch(t){throw s.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:r.i18n.translate("xpack.elasticAssistant.prompts.getPromptsError",{defaultMessage:"Error fetching prompts"})}),t}}},1540:function(t,e,s){"use strict";s.d(e,"a",(function(){return a})),s.d(e,"b",(function(){return i}));var n=s(4);n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.youAreAHelpfulExpertAssistant",{defaultMessage:"You are a helpful, expert assistant who answers questions about Elastic Security."}),n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.ifYouDontKnowTheAnswer",{defaultMessage:"Do not answer questions unrelated to Elastic Security."}),n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroPersonality",{defaultMessage:"Provide the most detailed and relevant answer possible, as if you were relaying this information back to a cyber security expert."});const a=n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.defaultSystemPromptName",{defaultMessage:"Default system prompt"}),i=(n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.defaultSystemPromptLabel",{defaultMessage:"Default"}),n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroSystemPromptName",{defaultMessage:"Enhanced system prompt"}),n.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroSystemPromptLabel",{defaultMessage:"Enhanced"}),t=>`CONTEXT:\n"""\n${t}\n"""`)},1677:function(t,e,s){"use strict";s.d(e,"a",(function(){return a})),s.d(e,"b",(function(){return i}));var n=s(50);const a=()=>Object(n.v4)(),i=({prevPromptContexts:t,promptContext:e})=>({...t,[e.id]:{...e}})},1678:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));const n=s(4).i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.enterprisePrompt",{defaultMessage:"Elastic AI Assistant is available to Enterprise users only. Please upgrade your license to use this feature."})},1867:function(t,e,s){"use strict";s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return c}));var n=s(47),a=s(2081),i=s(2080);const r={page:1,perPage:100},o=[a.e,r.page,r.perPage,i.a.public.v1],c=({http:t,onFetch:e,signal:s,refetchOnWindowFocus:c=!0,isAssistantEnabled:l})=>Object(n.useQuery)(o,(async()=>t.fetch(a.e,{method:"GET",version:i.a.public.v1,query:r,signal:s})),{select:t=>e(t),keepPreviousData:!0,initialData:{page:1,perPage:100,total:0,data:[]},refetchOnWindowFocus:c,enabled:l})},2080:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));const n={public:{v1:"2023-10-31"},internal:{v1:"1"}}},2081:function(t,e,s){"use strict";s.d(e,"f",(function(){return n})),s.d(e,"c",(function(){return r})),s.d(e,"d",(function(){return o})),s.d(e,"e",(function(){return c})),s.d(e,"h",(function(){return u})),s.d(e,"i",(function(){return d})),s.d(e,"a",(function(){return f})),s.d(e,"b",(function(){return g})),s.d(e,"g",(function(){return m}));const n="1",a="/api/security_ai_assistant",i="/internal/elastic_assistant",r=`${a}/current_user/conversations`,o=`${`${i}/current_user/conversations`}/_bulk_action`,c=`${r}/_find`,l=`${a}/prompts`,u=`${l}/_bulk_action`,d=`${l}/_find`,p=`${a}/anonymization_fields`,f=`${p}/_bulk_action`,g=`${p}/_find`,m=`${i}/knowledge_base/{resource?}`},2082:function(t,e,s){"use strict";s.d(e,"c",(function(){return r})),s.d(e,"d",(function(){return o})),s.d(e,"a",(function(){return c})),s.d(e,"b",(function(){return l})),s.d(e,"e",(function(){return u}));var n=s(4),a=s(2081),i=s(2080);const r=async({http:t,id:e,signal:s,toasts:r})=>{try{return await t.fetch(`${a.c}/${e}`,{method:"GET",version:i.a.public.v1,signal:s})}catch(t){throw null==r||r.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:n.i18n.translate("xpack.elasticAssistant.conversations.getConversationError",{defaultMessage:"Error fetching conversation by id {id}",values:{id:e}})}),t}},o=async({http:t,signal:e,toasts:s})=>{try{return await t.fetch(a.e,{method:"GET",version:i.a.public.v1,signal:e})}catch(t){throw null==s||s.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:n.i18n.translate("xpack.elasticAssistant.conversations.getUserConversationsError",{defaultMessage:"Error fetching conversations"})}),t}},c=async({http:t,conversation:e,signal:s,toasts:r})=>{try{return await t.post(a.c,{body:JSON.stringify(e),version:i.a.public.v1,signal:s})}catch(t){throw null==r||r.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:n.i18n.translate("xpack.elasticAssistant.conversations.createConversationError",{defaultMessage:"Error creating conversation with title {title}",values:{title:e.title}})}),t}},l=async({http:t,id:e,signal:s,toasts:r})=>{try{return await t.fetch(`${a.c}/${e}`,{method:"DELETE",version:i.a.public.v1,signal:s})}catch(t){throw null==r||r.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:n.i18n.translate("xpack.elasticAssistant.conversations.deleteConversationError",{defaultMessage:"Error deleting conversation by id {id}",values:{id:e}})}),t}},u=async({http:t,toasts:e,title:s,conversationId:r,messages:o,apiConfig:c,replacements:l,excludeFromLastConversationStorage:u,signal:d})=>{try{return await t.fetch(`${a.c}/${r}`,{method:"PUT",body:JSON.stringify({id:r,title:s,messages:o,replacements:l,apiConfig:c,excludeFromLastConversationStorage:u}),headers:{"Content-Type":"application/json"},version:i.a.public.v1,signal:d})}catch(t){throw null==e||e.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:n.i18n.translate("xpack.elasticAssistant.conversations.updateConversationError",{defaultMessage:"Error updating conversation by id {conversationId}",values:{conversationId:r}})}),t}}},241:function(t,e,s){"use strict";s.d(e,"a",(function(){return y})),s.d(e,"b",(function(){return h}));var n=s(44),a=s(2),i=s.n(a),r=s(414);const o=Object.freeze({assistantKnowledgeBaseByDefault:!1,assistantModelEvaluation:!1,assistantBedrockChat:!0});var c=s(1677),l=s(1446),u=s(1215),d=s(47),p=s(4),f=s(2080);const g=["elastic-assistant","capabilities"];var m=s(1376),v=s(43);const b=i.a.createContext(void 0),y=({actionTypeRegistry:t,alertsIndexPattern:e,assistantAvailability:s,assistantTelemetry:i,augmentMessageCodeBlocks:y,docLinks:h,basePath:A,basePromptContexts:C=[],children:k,getComments:x,http:E,baseConversations:S,navigateToApp:w,nameSpace:P=u.d,title:M=l.b,toasts:O,currentAppId:j})=>{const T={apmUrl:`${E.basePath.serverBasePath}/app/apm`,langSmithProject:"",langSmithApiKey:""},[L=T,I]=Object(r.useSessionStorage)(`${P}.${u.k}`,T),[D,$]=Object(r.useLocalStorage)(`${P}.${u.g}`),[_,Q]=Object(r.useLocalStorage)(`${P}.${u.f}`,u.e),[B,q]=Object(r.useLocalStorage)(`${P}.${u.i}`,!0),[F,K]=Object(a.useState)({}),z=Object(a.useCallback)((t=>{K((e=>null!=t&&null==e[t.id]?Object(c.b)({prevPromptContexts:e,promptContext:t}):e))}),[]),G=Object(a.useCallback)((t=>K((e=>null==e[t]?e:Object(n.omit)(t,e)))),[]),[R,N]=Object(a.useState)((()=>{})),[U,W]=Object(a.useState)(null),Y=Object(a.useCallback)((t=>{var e;return null!==(e=null!=t?t:D)&&void 0!==e?e:m.b}),[D]),{data:H}=(({http:t,toasts:e})=>Object(d.useQuery)({queryKey:g,queryFn:async({signal:e})=>(async({http:t,signal:e})=>{try{const s="/internal/elastic_assistant/capabilities";return await t.get(s,{signal:e,version:f.a.internal.v1})}catch(t){return t}})({http:t,signal:e}),retry:!1,keepPreviousData:!0,onError:t=>{"AbortError"!==t.name&&(null==e||e.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:p.i18n.translate("xpack.elasticAssistant.capabilities.statusError",{defaultMessage:"Error fetching capabilities"})}))}}))({http:E,toasts:O}),J=Object(a.useMemo)((()=>({actionTypeRegistry:t,alertsIndexPattern:e,assistantAvailability:s,assistantFeatures:null!=H?H:o,assistantTelemetry:i,augmentMessageCodeBlocks:y,basePath:A,basePromptContexts:C,docLinks:h,getComments:x,http:E,knowledgeBase:{...u.e,..._},promptContexts:F,navigateToApp:w,nameSpace:P,registerPromptContext:z,selectedSettingsTab:U,assistantStreamingEnabled:null==B||B,setAssistantStreamingEnabled:q,setKnowledgeBase:Q,setSelectedSettingsTab:W,setShowAssistantOverlay:N,setTraceOptions:I,showAssistantOverlay:R,title:M,toasts:O,traceOptions:L,unRegisterPromptContext:G,getLastConversationId:Y,setLastConversationId:$,baseConversations:S,currentAppId:j})),[t,e,s,H,i,y,A,C,h,x,E,_,F,w,P,z,U,B,q,Q,I,R,M,O,L,G,Y,$,S,j]);return Object(v.jsx)(b.Provider,{value:J},k)},h=()=>{const t=i.a.useContext(b);if(null==t)throw new Error("useAssistantContext must be used within a AssistantProvider");return t}},577:function(t,e,s){"use strict";s.d(e,"i",(function(){return a})),s.d(e,"j",(function(){return i})),s.d(e,"m",(function(){return r})),s.d(e,"g",(function(){return o})),s.d(e,"f",(function(){return c})),s.d(e,"a",(function(){return l})),s.d(e,"h",(function(){return u})),s.d(e,"e",(function(){return d})),s.d(e,"b",(function(){return p})),s.d(e,"d",(function(){return f})),s.d(e,"c",(function(){return g})),s.d(e,"k",(function(){return m})),s.d(e,"l",(function(){return v}));var n=s(4);const a=n.i18n.translate("xpack.elasticAssistant.connectors.useLoadActionTypes.errorMessage",{defaultMessage:"An error occurred loading the Kibana Actions. "}),i=n.i18n.translate("xpack.elasticAssistant.connectors.useLoadConnectors.errorMessage",{defaultMessage:"An error occurred loading the Kibana Connectors. "}),r=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.preconfiguredTitle",{defaultMessage:"Preconfigured"}),o=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.ariaLabel",{defaultMessage:"Connector Selector"}),c=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.newConnectorOptions",{defaultMessage:"Add new Connector..."}),l=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.addConnectorButtonLabel",{defaultMessage:"Add connector"}),u=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorPlaceholder",{defaultMessage:"Select a Connector"}),d=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.title",{defaultMessage:"Add Generative AI Connector"}),p=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.description",{defaultMessage:"Configure a connector to continue the conversation"}),f=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesTitle",{defaultMessage:"Generative AI Connector Required"}),g=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesDescription",{defaultMessage:"Please contact your administrator to enable a Generative AI Connector."}),m=(n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userYouTitle",{defaultMessage:"You"}),n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userAssistantTitle",{defaultMessage:"Assistant"}),n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.timestampAtTitle",{defaultMessage:"at"}),n.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.skipTitle",{defaultMessage:"Click to skip..."}),n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutTitle",{defaultMessage:"The current conversation is missing a connector configuration"})),v=n.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.conversationSettingsLink",{defaultMessage:"Conversation Settings"});n.i18n.translate("xpack.elasticAssistant.assistant.connectors.createConnectorButton",{defaultMessage:"Connector"}),n.i18n.translate("xpack.elasticAssistant.assistant.connectors.refreshConnectorsButton",{defaultMessage:"Refresh"})},578:function(t,e,s){"use strict";s.d(e,"c",(function(){return i})),s.d(e,"a",(function(){return r})),s.d(e,"b",(function(){return c}));var n=s(577),a=function(t){return t.OpenAi="OpenAI",t.AzureAi="Azure OpenAI",t}(a||{});const i=t=>{if(null==t||!t.isPreconfigured){const e=null==t?void 0:t.config,{apiProvider:s,apiUrl:n,defaultModel:i}=null!=e?e:{};return{apiProvider:s,apiUrl:n,defaultModel:s===a.AzureAi?o(null!=n?n:""):i}}},r=t=>{var e;return null!==(e=t.actionTypeTitle)&&void 0!==e?e:t.id},o=t=>{var e;return null!==(e=new URLSearchParams(new URL(t).search).get("api-version"))&&void 0!==e?e:void 0},c=(t,e)=>{var s,a;if(!t)return null;const o=null!==(s=null===(a=i(t))||void 0===a?void 0:a.apiProvider)&&void 0!==s?s:r(e.get(t.actionTypeId));return t.isPreconfigured?n.m:o}},755:function(t,e,s){"use strict";s.d(e,"a",(function(){return c}));var n=s(47),a=s(86),i=s(577);const r=["elastic-assistant, load-connectors"],o={bedrock:".bedrock",openai:".gen-ai",gemini:".gemini"},c=({http:t,toasts:e})=>Object(n.useQuery)(r,(async()=>(await Object(a.loadAllActions)({http:t})).reduce(((t,e)=>{var s,n;return[...t,...!e.isMissingSecrets&&[o.bedrock,o.openai,o.gemini].includes(e.actionTypeId)?[{...e,apiProvider:e.isPreconfigured||e.isSystemAction||null==e||null===(s=e.config)||void 0===s||!s.apiProvider||null==e||null===(n=e.config)||void 0===n?void 0:n.apiProvider}]:[]]}),[])),{retry:!1,keepPreviousData:!0,onError:t=>{"AbortError"!==t.name&&(null==e||e.addError(t.body&&t.body.message?new Error(t.body.message):t,{title:i.j}))}})},756:function(t,e,s){"use strict";s.d(e,"a",(function(){return i})),s.d(e,"c",(function(){return r})),s.d(e,"d",(function(){return o})),s.d(e,"e",(function(){return c})),s.d(e,"b",(function(){return l}));var n=s(578),a=s(1540);const i=t=>{const e=[...t.matchAll(/```(\w+)?\s([\s\S]*?)```/g)],s={eql:["Event Query Language","EQL sequence query","EQL"],esql:["Elasticsearch Query Language","ESQL","ES|QL","SQL"],kql:["Kibana Query Language","KQL Query","KQL"],dsl:["Elasticsearch QueryDSL","Elasticsearch Query DSL","Elasticsearch DSL","Query DSL","DSL"]};return e.map((e=>{let n=e[1]||"no-type";if("no-type"===n||"json"===n){const a=e.index||0,i=t.slice(0,a);for(const[t,e]of Object.entries(s))if(e.some((t=>i.toLowerCase().includes(t.toLowerCase())))){n=t;break}}const a=e[2].trim(),i=e.index||0;return{type:n,content:a,start:i,end:i+e[0].length}}))},r=t=>{var e;const s=t.find((t=>t.name===a.a));return null!==(e=t.find((t=>t.isNewConversationDefault)))&&void 0!==e?e:s},o=({allSystemPrompts:t,conversation:e})=>t.find((t=>{var s;return t.id===(null==e||null===(s=e.apiConfig)||void 0===s?void 0:s.defaultSystemPromptId)})),c=({allSystemPrompts:t})=>t.find((t=>t.name===a.a)),l=({allSystemPrompts:t,conversation:e,connectors:s,defaultConnector:a})=>{var i,r,c,l,u;const d=null!==(i=null==s?void 0:s.find((t=>{var s;return t.id===(null===(s=e.apiConfig)||void 0===s?void 0:s.connectorId)})))&&void 0!==i?i:a,{apiProvider:p,defaultModel:f}=null!==(r=Object(n.c)(d))&&void 0!==r?r:{},g=o({allSystemPrompts:t,conversation:e});return d?{apiConfig:{connectorId:d.id,actionTypeId:d.actionTypeId,provider:null!==(c=d.apiProvider)&&void 0!==c?c:p,defaultSystemPromptId:null==g?void 0:g.id,model:null!==(l=null==e||null===(u=e.apiConfig)||void 0===u?void 0:u.model)&&void 0!==l?l:f}}:{apiConfig:{defaultSystemPromptId:null==g?void 0:g.id}}}},812:function(t,e,s){"use strict";s.d(e,"a",(function(){return d}));var n=s(2),a=s(241),i=s(1376),r=s(756),o=s(2082),c=s(1450),l=s(1539);const u={id:"",messages:[],replacements:{},category:"assistant",title:i.a},d=()=>{const{http:t,toasts:e}=Object(a.b)(),{data:{data:s}}=Object(l.b)(),d=Object(n.useCallback)((async(s,n)=>Object(o.c)({http:t,id:s,toasts:n?void 0:e})),[t,e]),p=Object(n.useCallback)((async s=>{let n=[];const a=await Object(o.c)({http:t,id:s,toasts:e});return null!=a&&(n=a.messages.slice(0,a.messages.length-1),await Object(o.e)({http:t,conversationId:s,messages:n,toasts:e})),n}),[t,e]),f=Object(n.useCallback)((async n=>{if(n.apiConfig){var a;const i=null===(a=Object(r.d)({allSystemPrompts:s,conversation:n}))||void 0===a?void 0:a.id;return Object(o.e)({http:t,toasts:e,conversationId:n.id,apiConfig:{...n.apiConfig,defaultSystemPromptId:i},messages:[],replacements:{}})}}),[s,t,e]),g=Object(n.useCallback)((({cTitle:t,messages:e})=>t===i.b?c.a:{...u,id:"",title:t,messages:null!=e?e:[]}),[]),m=Object(n.useCallback)((async s=>Object(o.a)({http:t,conversation:s,toasts:e})),[t,e]);return{clearConversation:f,getDefaultConversation:g,deleteConversation:Object(n.useCallback)((async s=>{await Object(o.b)({http:t,id:s,toasts:e})}),[t,e]),removeLastMessage:p,setApiConfig:Object(n.useCallback)((async({conversation:s,apiConfig:n})=>{var a;return""===s.id?Object(o.a)({http:t,conversation:{apiConfig:n,category:"assistant",title:s.title,replacements:s.replacements,excludeFromLastConversationStorage:s.excludeFromLastConversationStorage,isDefault:s.isDefault,id:"",messages:null!==(a=s.messages)&&void 0!==a?a:[]},toasts:e}):Object(o.e)({http:t,conversationId:s.id,apiConfig:n,toasts:e})}),[t,e]),updateConversationTitle:Object(n.useCallback)((({conversationId:e,updatedTitle:s})=>Object(o.e)({http:t,conversationId:e,title:s})),[t]),createConversation:m,getConversation:d}}}}]);