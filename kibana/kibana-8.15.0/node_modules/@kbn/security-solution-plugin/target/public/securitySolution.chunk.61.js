/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[61],{167:function(t,e,n){"use strict";n.d(e,"D",(function(){return o})),n.d(e,"E",(function(){return a})),n.d(e,"F",(function(){return c})),n.d(e,"w",(function(){return u})),n.d(e,"s",(function(){return d})),n.d(e,"r",(function(){return l})),n.d(e,"v",(function(){return p})),n.d(e,"h",(function(){return f})),n.d(e,"x",(function(){return _})),n.d(e,"z",(function(){return E})),n.d(e,"g",(function(){return m})),n.d(e,"t",(function(){return g})),n.d(e,"B",(function(){return k})),n.d(e,"q",(function(){return h})),n.d(e,"u",(function(){return y})),n.d(e,"A",(function(){return O})),n.d(e,"p",(function(){return S})),n.d(e,"o",(function(){return T})),n.d(e,"C",(function(){return A})),n.d(e,"y",(function(){return b})),n.d(e,"e",(function(){return N})),n.d(e,"c",(function(){return v})),n.d(e,"b",(function(){return w})),n.d(e,"a",(function(){return R})),n.d(e,"d",(function(){return $})),n.d(e,"f",(function(){return I})),n.d(e,"j",(function(){return L})),n.d(e,"i",(function(){return x})),n.d(e,"k",(function(){return C})),n.d(e,"l",(function(){return j})),n.d(e,"n",(function(){return F})),n.d(e,"m",(function(){return M}));var i=n(67),r=n(203);const o="logs-endpoint.events.*",a="metrics-endpoint.metadata_current_*",c="endpoint.metadata_current-default",u=".metrics-endpoint.metadata_united_default",s=(Object(i.getFileMetadataIndexName)("endpoint"),Object(i.getFileDataIndexName)("endpoint"),"/api/endpoint"),d=`${s}/metadata`,l=`${d}/{id}`,p=`${s}/metadata/transforms`,f=`${s}/policy_response`,_=`${s}/protection_updates_note/{package_policy_id}`,E=`${s}/suggestions/{suggestion_type}`,m=`${s}/action`,g=`${m}/isolate`,k=`${m}/unisolate`,h=`${m}/running_procs`,y=`${m}/kill_process`,O=`${m}/suspend_process`,S=`${m}/get_file`,T=`${m}/execute`,A=`${m}/upload`,b=`${m}/scan`,N=`${s}/action_status`,v=`${m}/{action_id}`,w=`${m}/{action_id}/file/{file_id}`,R=`${m}/{action_id}/file/{file_id}/download`,$=`${m}/state`,I=`/internal${s}/agent_status`,L=r.b.ENROLLED_AT,x="desc",C={ES_CONNECTION_ERROR:-272,OUTPUT_SERVER_ERROR:-273},j="endpointFields",F="endpointSearchStrategy",M="endpointPackagePoliciesStatsStrategy"},203:function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"e",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"g",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return s}));let i=function(t){return t.windows="windows",t.mac="mac",t.linux="linux",t}({}),r=function(t){return t.is="is",t.matches="matches",t}({}),o=function(t){return t.UNHEALTHY="unhealthy",t.HEALTHY="healthy",t.OFFLINE="offline",t.UPDATING="updating",t.INACTIVE="inactive",t.UNENROLLED="unenrolled",t}({}),a=function(t){return t.detect="detect",t.prevent="prevent",t.off="off",t}({}),c=function(t){return t.enabled="enabled",t.disabled="disabled",t.sync="sync_with_malware_prevent",t}({}),u=function(t){return t.success="success",t.failure="failure",t.warning="warning",t.unsupported="unsupported",t}({}),s=function(t){return t.ENROLLED_AT="enrolled_at",t.HOSTNAME="metadata.host.hostname",t.HOST_STATUS="host_status",t.POLICY_NAME="metadata.Endpoint.policy.applied.name",t.POLICY_STATUS="metadata.Endpoint.policy.applied.status",t.HOST_OS_NAME="metadata.host.os.name",t.HOST_IP="metadata.host.ip",t.AGENT_VERSION="metadata.agent.version",t.LAST_SEEN="last_checkin",t}({})},2130:function(t,e,n){"use strict";n.r(e),n.d(e,"EndpointGenericErrorsList",(function(){return h}));var i=n(2),r=n.n(i),o=n(19),a=n(118),c=n(0),u=n.n(c),s=n(4),d=n(167);const l=Object.freeze(new Map([["es_connection",s.i18n.translate("xpack.securitySolution.endpoint.details.packageActions.es_connection.title",{defaultMessage:"Elasticsearch connection failure"})],["policy_failure",s.i18n.translate("xpack.securitySolution.endpoint.details.packageActions.policy_failure.title",{defaultMessage:"Policy response failure"})]])),p=Object.freeze(new Map([["es_connection",s.i18n.translate("xpack.securitySolution.endpoint.details.packageActions.es_connection.description",{defaultMessage:"The endpoint's connection to Elasticsearch is either down or misconfigured. Make sure it is configured correctly."})],["policy_failure",s.i18n.translate("xpack.securitySolution.endpoint.details.packageActions.policy_failure.description",{defaultMessage:"The Endpoint did not apply the Policy correctly. Expand the Policy response above for more details."})]])),f=Object.freeze(new Map([["es_connection",s.i18n.translate("xpack.securitySolution.endpoint.details.packageActions.link.text.es_connection",{defaultMessage:" Read more."})]]));class package_action_formatter_PackageActionFormatter{constructor(t,e){var n,i,r,o,a;u()(this,"key",void 0),u()(this,"title",void 0),u()(this,"description",void 0),u()(this,"linkText",void 0),this.docLinks=e,this.key=this.getKeyFromErrorCode(null===(n=t.payload)||void 0===n||null===(i=n.error)||void 0===i?void 0:i.code,t.status),this.title=null!==(r=l.get(this.key))&&void 0!==r?r:this.key,this.description=p.get(this.key)||(null===(o=t.payload)||void 0===o||null===(a=o.error)||void 0===a?void 0:a.message),this.linkText=f.get(this.key)}get linkUrl(){return this.docLinks[this.key]}getKeyFromErrorCode(t,e){if(t===d.k.ES_CONNECTION_ERROR||t===d.k.OUTPUT_SERVER_ERROR)return"es_connection";if("FAILED"===e||"DEGRADED"===e)return"policy_failure";throw new Error(`Invalid error code ${t}`)}}var _=n(41),E=n.n(_);const m=E()(o.EuiCallOut).withConfig({displayName:"StyledEuiCallout",componentId:"sc-huktdy-0"})(["padding:",";"],(({theme:t})=>t.eui.euiSizeS)),g=E()(o.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-huktdy-1"})(["white-space:break-spaces;text-align:left;line-height:inherit;"]),k=Object(i.memo)((({actionFormatter:t})=>r.a.createElement(m,{title:t.title,color:"danger",iconType:"warning","data-test-subj":"packageItemErrorCallOut"},r.a.createElement(g,{size:"s","data-test-subj":"packageItemErrorCallOutMessage"},t.description,t.linkText&&t.linkUrl&&r.a.createElement(o.EuiLink,{target:"_blank",href:t.linkUrl,"data-test-subj":"packageItemErrorCallOutLink"},t.linkText)))));k.displayName="PackageActionItemError";const h=Object(i.memo)((({packageErrors:t})=>{const{docLinks:e}=Object(a.j)().services,n=Object(i.useMemo)((()=>{const n=[];return t.forEach((t=>{"FAILED"!==t.status&&"DEGRADED"!==t.status||n.push(new package_action_formatter_PackageActionFormatter(t,e.links.securitySolution.packageActionTroubleshooting))})),n}),[t,e.links.securitySolution.packageActionTroubleshooting]);return r.a.createElement(r.a.Fragment,null,n.map((t=>r.a.createElement(r.a.Fragment,{key:t.key},r.a.createElement(k,{actionFormatter:t}),r.a.createElement(o.EuiSpacer,{size:"m"})))))}));h.displayName="EndpointGenericErrorsList"}}]);