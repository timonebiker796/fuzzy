/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[9],{1320:function(e,t,a){"use strict";a.d(t,"a",(function(){return bt}));var n=a(2),o=a.n(n),r=a(19),s=a(41),l=a.n(s),i=a(118);const u="commandInputHistory";var c=a(1427),m=a(0),d=a.n(m);class parsed_command_input_ParsedCommand{constructor(e){d()(this,"name",void 0),d()(this,"args",void 0),d()(this,"hasArgs",void 0),this.input=e;const t=(e=>{const t=e.trim(),a={name:g(t),args:{}};if(!t)return a;const n=t.indexOf(" "),o=-1===n?[]:t.substring(n).trim().split(/--/);for(const e of o){const t=e.trim();if(t){const e=/[ =]/.exec(t),n=(e?t.substring(0,e.index).trim():t).trim();if(n)if(a.args[n]||(a.args[n]=[]),n!==t&&e){let o=t.substring(e.index+1).trim().replace(/\\-\\-/g,"--");'"'===o.charAt(0)&&(o=o.substring(1)),'"'===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),a.args[n].push(o)}else a.args[n].push(!0)}}return a})(e);this.name=t.name,this.args=t.args,this.hasArgs=Object.keys(this.args).length>0}hasArg(e){return e in this.args}}const p=e=>new parsed_command_input_ParsedCommand(e),g=e=>{const t=e.trimStart();if(!t)return"";const a=e.indexOf(" ");return-1===a?t:t.substring(0,a)},h=e=>{let t="",a="";const n=[];if(e.args)for(const[o,r]of Object.entries(e.args))r.required?(t.length&&(t+=" "),t+=`--${o}`):r.exclusiveOr?n.push(`--${o}`):(a.length&&(a+=" "),a+=`--${o}`);const o=({required:e,exclusive:t,optional:a})=>`${e||""}${t?` ${t}`:""} ${a&&a.length>0?`[${a}]`:""}`.trim();return n.length>0?n.map((e=>o({required:t,exclusive:e,optional:a}))):t||a?[o({required:t,optional:a})]:[]};var b=a(4),f=a(50);const E=b.i18n.translate("xpack.securitySolution.handleInputAreaState.inputPlaceholderText",{defaultMessage:"Submit response action"}),y=(e,t)=>{if(t&&t.argsWithValueSelectors)for(const n of Object.keys(t.argsWithValueSelectors))if(e.hasArg(n)){var a;const o=null!==(a=t.argState[n])&&void 0!==a?a:[];e.args[n]=o.map((e=>e.value))}},C=(e,{type:t,payload:a})=>{var n;switch(t){case"updateInputPopoverState":if(e.input.showPopover!==a.show)return{...e,input:{...e.input,showPopover:a.show}};break;case"updateInputHistoryState":return{...e,input:{...e.input,history:[{id:Object(f.v4)(),input:a.command,display:null!==(n=a.display)&&void 0!==n?n:a.command},...e.input.history.slice(0,99)]}};case"clearInputHistoryState":return{...e,input:{...e.input,history:[]}};case"updateInputTextEnteredState":const{leftOfCursorText:t,rightOfCursorText:l="",argState:i}="function"==typeof a?a(e.input):a;if(e.input.leftOfCursorText!==t||e.input.rightOfCursorText!==l){var o;const a=p(t+l);let n=e.input.enteredCommand;if(n&&i&&(null===(o=n)||void 0===o?void 0:o.argState)!==i&&(n={...n,argState:i}),a.name&&(!n||a.name!==n.commandDefinition.name)||!a.name&&n){n=void 0;const t=e.commands.find((e=>e.name===a.name));if(t){let e;for(const[a,n]of Object.entries(null!==(r=t.args)&&void 0!==r?r:{})){var r;n.SelectorComponent&&(e||(e={}),e[a]=n)}n={argState:{},commandDefinition:t,argsWithValueSelectors:e}}}return y(a,n),{...e,input:{...e.input,leftOfCursorText:t,rightOfCursorText:l,parsedInput:a,enteredCommand:n}}}break;case"updateInputPlaceholderState":if(e.input.placeholder!==a.placeholder)return{...e,input:{...e.input,placeholder:a.placeholder||E}};break;case"setInputState":if(e.input.visibleState!==a.value)return{...e,input:{...e.input,visibleState:a.value}};break;case"updateInputCommandArgState":if(e.input.enteredCommand){var s;const{name:t,instance:n,state:o}=a,r=[...null!==(s=e.input.enteredCommand.argState[t])&&void 0!==s?s:[]];r[n]=o;const l={...e.input.enteredCommand,argState:{...e.input.enteredCommand.argState,[t]:r}},i=p(e.input.leftOfCursorText+e.input.rightOfCursorText);return y(i,l),{...e,input:{...e.input,parsedInput:i,enteredCommand:l}}}}return e};var v=a(42),O=a(900);const S=Object.freeze({mustHaveValue:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveValue",{defaultMessage:"Argument --{argName} must have a value",values:{argName:e}}),mustBeNumber:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeNumber",{defaultMessage:"Argument --${argName} value must be a number",values:{argName:e}}),mustBeGreaterThanZero:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeGreaterThanZero",{defaultMessage:"Argument --{argName} value must be greater than zero",values:{argName:e}}),NO_ARGUMENTS_SUPPORTED:b.i18n.translate("xpack.securitySolution.console.commandValidation.noArgumentsSupported",{defaultMessage:"Command does not support any arguments"}),missingRequiredArg:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.missingRequiredArg",{defaultMessage:"Missing required argument: --{argName}",values:{argName:e}}),unsupportedArg:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.unsupportedArg",{defaultMessage:"Unsupported argument: --{argName}",values:{argName:e}}),noMultiplesAllowed:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.argSupportedOnlyOnce",{defaultMessage:"Argument can only be used once: --{argName}",values:{argName:e}}),argValueValidatorError:(e,t)=>b.i18n.translate("xpack.securitySolution.console.commandValidation.invalidArgValue",{defaultMessage:"Invalid argument value: --{argName}. {error}",values:{argName:e,error:t}}),missingArguments:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveArgs",{defaultMessage:"Missing required arguments: {missingArgs}",values:{missingArgs:e}}),MUST_HAVE_AT_LEAST_ONE_ARG:b.i18n.translate("xpack.securitySolution.console.commandValidation.oneArgIsRequired",{defaultMessage:"At least one argument must be used"}),onlyOneFromExclusiveOr:e=>o.a.createElement(O.a,null,o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.exclusiveOr",defaultMessage:"This command supports only one of the following arguments: {argNames}",values:{argNames:o.a.createElement(O.a,{bold:!0,inline:!0},e)}})),unknownArgument:(e,t,a)=>o.a.createElement(O.a,null,o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.unknownArgument",defaultMessage:"The following {command} {countOfInvalidArgs, plural, =1 {argument is} other {arguments are}} not supported by this command: {unknownArgs}",values:{countOfInvalidArgs:e,command:o.a.createElement(O.a,{bold:!0,inline:!0},t),unknownArgs:o.a.createElement(O.a,{bold:!0,inline:!0},a)}}))});var x=a(126);const j=(e="")=>{const t=le().state.dataTestSubj;return t?t+(e?`-${e}`:""):""},k=b.i18n.translate("xpack.securitySolution.console.unsupportedMessageCallout.title",{defaultMessage:"Unsupported"}),w=Object(n.memo)((({children:e,header:t=k,"data-test-subj":a})=>o.a.createElement("div",{"data-test-subj":a},o.a.createElement(r.EuiText,{size:"s"},o.a.createElement(r.EuiTextColor,{color:"danger"},t)),o.a.createElement(r.EuiSpacer,{size:"s"}),e)));w.displayName="UnsupportedMessageCallout";const I={className:"euiTruncateText"},M=Object(n.memo)((({commandDef:e})=>{const t=Object(n.useMemo)((()=>h(e).map(((t,a)=>o.a.createElement(o.a.Fragment,{key:`helpUsage-${a}`},a>0&&o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(O.a,null,`${e.name} ${t}`))))),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.inputUsage",{defaultMessage:"Usage"})),description:t&&t.length>0?t:e.name}],descriptionProps:I,titleProps:I}),o.a.createElement(r.EuiSpacer,{size:"s"}),e.exampleUsage&&o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.exampleUsage",{defaultMessage:"Example"})),description:o.a.createElement(O.a,null,e.exampleUsage)}],descriptionProps:I,titleProps:I}))}));M.displayName="CommandInputUsage";const T=Object(n.memo)((({commandDef:e,errorMessage:t})=>{const a=Object(x.a)(j()),s=Object(n.useMemo)((()=>{var t;return Object.keys(null!==(t=e.args)&&void 0!==t?t:[]).length>0}),[e.args]),l=Object(n.useMemo)((()=>s&&e.args?Object.entries(e.args).reduce(((e,t)=>{const a={title:`--${t[0]}`,description:t[1].about};return t[1].required?e.required.push(a):t[1].exclusiveOr?e.exclusiveOr.push(a):e.optional.push(a),e}),{required:[],exclusiveOr:[],optional:[]}):{required:[],exclusiveOr:[],optional:[]}),[e.args,s]),i=(t,n)=>{const s=n.map((e=>o.a.createElement("div",null,o.a.createElement(O.a,{bold:!0,inline:!0},e.title),o.a.createElement(O.a,{inline:!0}," - ",e.description))));return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"s"}),e.args&&o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,t),description:s}],descriptionProps:I,titleProps:I,"data-test-subj":a("commandUsage-options")}))},u=Object(n.useCallback)((()=>t?o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"danger"},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":a("validationError")},o.a.createElement("div",{"data-test-subj":a("badArgument-message")},t),o.a.createElement(r.EuiSpacer,{size:"s"})):null),[t,a]);return o.a.createElement(r.EuiPanel,{paddingSize:"none",color:"transparent","data-test-subj":a("commandUsage")},u(),o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:o.a.createElement(O.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.about",{defaultMessage:"About"})),description:o.a.createElement(O.a,null,e.about)}],descriptionProps:I,titleProps:I,"data-test-subj":a("commandUsage-options")}),o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(M,{commandDef:e}),l.required&&l.required.length>0&&i(b.i18n.translate("xpack.securitySolution.console.commandUsage.requiredLabel",{defaultMessage:"Required parameters"}),l.required),l.exclusiveOr&&l.exclusiveOr.length>0&&i(b.i18n.translate("xpack.securitySolution.console.commandUsage.exclusiveOr",{defaultMessage:"Include only one parameter"}),l.exclusiveOr),l.optional&&l.optional.length>0&&i(b.i18n.translate("xpack.securitySolution.console.commandUsage.optional",{defaultMessage:"Optional parameters"}),l.optional))}));T.displayName="CommandUsage";const N=Object(n.memo)((({title:e,children:t})=>{const a=Object(x.a)(j());return o.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent",paddingSize:"none","data-test-subj":a("helpOutput")},t)}));N.displayName="HelpOutput";const F=Object(n.memo)((e=>{const t=e.command.commandDefinition.HelpComponent;return Object(n.useEffect)((()=>{t||e.setStatus("success")}),[t,e]),t?o.a.createElement(t,e):o.a.createElement(N,{command:e.command,title:b.i18n.translate("xpack.securitySolution.console.buildInCommand.helpArgument.helpTitle",{defaultMessage:"{cmdName} command",values:{cmdName:e.command.args.name}})},o.a.createElement(T,{commandDef:e.command.commandDefinition,errorMessage:e.store.errorMessage}))}));F.displayName="HelpCommandArgument";const A=Object(n.memo)((({command:e,setStatus:t})=>{const a=Object(x.a)(j()),s=Object(n.useMemo)((()=>o.a.createElement(O.a,null,o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage",defaultMessage:"The text you entered {userInput} is unsupported! Click {helpIcon} {boldHelp} or type {helpCmd} for assistance.",values:{userInput:o.a.createElement(O.a,{bold:!0,inline:!0},e.input),helpIcon:o.a.createElement(r.EuiIcon,{type:"help"}),helpCmd:o.a.createElement(O.a,{bold:!0,inline:!0},"help"),boldHelp:o.a.createElement("strong",null,o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage.help",defaultMessage:"Help"}))}}))),[e.input]);return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"danger"},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.title",defaultMessage:"Unsupported text/command"})),"data-test-subj":a("unknownCommandError")},s)}));A.displayName="UnknownCommand";const P=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const s=Object(x.a)(j());return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"danger"},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.title",defaultMessage:"Unsupported argument"})),"data-test-subj":s("badArgument")},o.a.createElement("div",{"data-test-subj":s("badArgument-message")},a.errorMessage),!e.commandDefinition.helpHidden&&o.a.createElement("div",{"data-test-subj":s("badArgument-commandUsage")},o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(M,{commandDef:e.commandDefinition}),o.a.createElement(O.a,null,o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:o.a.createElement(O.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}}))))}));P.displayName="BadArgument";const z=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const s=Object(x.a)(j());return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(O.a,{textColor:"error"},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":s("validationError")},o.a.createElement("div",{"data-test-subj":s("validationError-message")},a.errorMessage),!e.commandDefinition.helpHidden&&o.a.createElement("div",{"data-test-subj":s("validationError-commandUsage")},o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(M,{commandDef:e.commandDefinition}),o.a.createElement(O.a,null,o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.validationError.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:o.a.createElement(O.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}}))))}));z.displayName="ValidationError";const H=e=>`--${e}`,B=(e,t)=>{const a=C(e,{type:"updateInputHistoryState",payload:{command:t.command.input,display:t.command.inputDisplay}});return a.commandHistory=[...e.commandHistory,t],a},L={name:"unknown-command",about:"unknown command",RenderComponent:()=>null},R=(e={})=>({status:"pending",store:e}),D=(e,t)=>({...e,commandDefinition:{...e.commandDefinition,RenderComponent:t}}),V=(e,t=R(),a=!0)=>({id:Object(f.v4)(),isValid:a,enteredAt:(new Date).toISOString(),command:e,state:t}),$=()=>le().dispatch,G=Object(n.memo)((({status:e,setStatus:t})=>{const a=$();return Object(n.useEffect)((()=>{"pending"===e&&a({type:"clear"}),t("success")}),[e,t,a]),null}));G.displayName="ClearCommand";var U=a(7);const _=e=>{if(!e.mustHaveArgs||!e.args)return e.name;let t=!1;const a=Object.entries(e.args).reduce(((e,[a,n])=>n.required?(e[a]=n,e):n.exclusiveOr&&!t?(t=!0,e[a]=n,e):e),{});return`${e.name} --${Object.keys(a).join(" --")}`},W=b.i18n.translate("xpack.securitySolution.console.commandList.otherCommandsGroup.label",{defaultMessage:"Other commands"}),q=e=>e.replace(/[^A-Za-z0-9]/g,""),K=l()(r.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-10x4uz4-0"})(["margin-top:",";.euiTableHeaderCell{.euiTableCellContent__text{color:",";font-size:",";padding-bottom:",";padding-left:",";}}"],(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiTextColor),(({theme:{eui:e}})=>e.euiFontSize),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeS)),X=l()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallOut",componentId:"sc-10x4uz4-1"})(["margin:",";padding:",";border-radius:",";"],(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS)),Z=l()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-10x4uz4-2"})(["padding-left:",";"],(({theme:{eui:e}})=>e.euiSizeS)),Y=l()(r.EuiFlexGrid).withConfig({displayName:"StyledEuiFlexGrid",componentId:"sc-10x4uz4-3"})(["@media only screen and (min-width:","){max-width:75%;}@media only screen and (min-width:","){max-width:50%;}"],(e=>e.theme.eui.euiBreakpoints.l),(e=>e.theme.eui.euiBreakpoints.xl)),J=l()(r.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-10x4uz4-4"})(["font-size:10px !important;span{color:"," !important;}"],(({theme:{eui:e}})=>e.euiShadowColor)),Q=Object(n.memo)((({commands:e,display:t="default"})=>{const a=Object(x.a)(j("commandList")),s=$(),{docLinks:l}=Object(i.j)().services,u=Object(n.useMemo)((()=>{var e;return o.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:o.a.createElement(J,null,o.a.createElement(O.a,{inline:!0,bold:!0},null===(e=ne.find((e=>"--help"===e.name)))||void 0===e?void 0:e.name)),description:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandList.footerText",defaultMessage:"For more help with the individual commands use the --help argument. Ex: processes --help"}))}]})}),[]),c=Object(n.useCallback)((e=>()=>{s({type:"updateInputTextEnteredState",payload:()=>({leftOfCursorText:e,rightOfCursorText:""})}),s({type:"addFocusToKeyCapture"})}),[s]),m=Object(n.useMemo)((()=>{const t=new Map,a=e.filter((e=>!0!==e.helpHidden));for(const e of a){const{helpGroupLabel:a=W,helpGroupPosition:n=1/0}=e,o=t.get(a);o?(o.list.push(e),o.position===1/0&&void 0!==n&&n!==o.position&&(o.position=n)):t.set(e.helpGroupLabel,{label:a,position:n,list:[e]})}return Object(U.sortBy)(Array.from(t.values()),"position").map((e=>{const t=e.list.map((e=>void 0===e.helpCommandPosition?{...e,helpCommandPosition:1/0}:e));return Object(U.sortBy)(t,"helpCommandPosition")}))}),[e]),d=Object(n.useCallback)((e=>e[0].helpGroupLabel===ae.supporting.label?[...ne,...e].map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:W]:t}})):e.map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:W]:t}}))),[]),p=Object(n.useCallback)((e=>{var t,n;const s=null!==(t=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==t?t:W,l=q(s);return[{field:s,name:o.a.createElement("div",{"data-test-subj":a("group")},s),render:e=>{const t=_(e);return o.a.createElement(Z,{alignItems:"center","data-test-subj":a(`${l}-${e.name}`)},o.a.createElement(r.EuiFlexItem,{grow:1},o.a.createElement(r.EuiDescriptionList,{"data-test-subj":a("command"),listItems:[{title:o.a.createElement(r.EuiBadge,{"data-test-subj":a("commandName")},t),description:o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about))}]})),e.helpGroupLabel!==ae.supporting.label&&!0!==e.helpHidden&&e.RenderComponent&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiToolTip,{content:!0===e.helpDisabled?b.i18n.translate("xpack.securitySolution.console.commandList.disabledButtonTooltip",{defaultMessage:"Unsupported command"}):b.i18n.translate("xpack.securitySolution.console.commandList.addButtonTooltip",{defaultMessage:"Add to text bar"})},o.a.createElement(r.EuiButtonIcon,{iconType:"plusInCircle","aria-label":`updateTextInputCommand-${e.name}`,onClick:c(`${t} `),isDisabled:!0===e.helpDisabled,"data-test-subj":a(`${l}-${e.name}-addToInput`)}))))}}]}),[a,c]),g=Object(n.useCallback)((e=>e.filter((e=>"help"!==e.name&&"clear"!==e.name))),[]);if("table"===t){const e=[o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.multipleResponses",defaultMessage:"You can enter consecutive response actions — no need to wait for previous actions to complete."}),o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.leavingResponder",defaultMessage:"Leaving the response console does not terminate any actions that have been submitted."}),o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.visitSupportSections",defaultMessage:"{learnMore} about response actions and using the console.",values:{learnMore:o.a.createElement(r.EuiLink,{href:l.links.securitySolution.responseActions,target:"_blank","data-test-subj":a("helpfulHintDocLink")},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.readMoreLink",defaultMessage:"Learn more"}))}})],t=o.a.createElement(X,{title:o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.title",defaultMessage:"Helpful tips:"}),"data-test-subj":a("helpfulTips")},o.a.createElement("ul",null,e.map(((e,t)=>o.a.createElement("li",{key:t},o.a.createElement(r.EuiText,{size:"s"},e))))));return o.a.createElement("div",{"data-test-subj":a()},m.map(((e,t)=>{var n;return o.a.createElement(K,{"data-test-subj":a(q(null!==(n=e[0].helpGroupLabel)&&void 0!==n?n:W)),key:`styledEuiBasicTable-${t}`,items:d(e),columns:p(e)})})),t)}return o.a.createElement("div",{"data-test-subj":a()},o.a.createElement(r.EuiSpacer,{size:"s"}),m.map((e=>{const t=e[0].helpGroupLabel,n=g(e);return 0===n.length?null:o.a.createElement(Y,{columns:3,responsive:!1,gutterSize:"l",key:t,direction:"column"},n.map((e=>{const t=_(e);return o.a.createElement(r.EuiFlexItem,{key:e.name},o.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:o.a.createElement(r.EuiToolTip,{content:t},o.a.createElement(J,null,o.a.createElement(O.a,{inline:!0,bold:!0},t))),description:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about)}],"data-test-subj":a("command")}))})))})),o.a.createElement(r.EuiSpacer,{size:"xl"}),u)}));Q.displayName="CommandList";const ee=()=>le().state.commands,te=Object(n.memo)((e=>{const t=ee(),a=le().state.HelpComponent;return Object(n.useEffect)((()=>{a||e.setStatus("success")}),[a,e]),a?o.a.createElement(a,e):o.a.createElement(N,{command:e.command,title:b.i18n.translate("xpack.securitySolution.console.builtInCommands.help.helpTitle",{defaultMessage:"Available commands"})},o.a.createElement(Q,{commands:t}))}));te.displayName="HelpCommand";const ae=Object.freeze({supporting:{label:b.i18n.translate("xpack.securitySolution.console.builtInCommands.groups.supporting",{defaultMessage:"Supporting commands & parameters"})}}),ne=Object.freeze([{name:"--comment",about:b.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.comment",{defaultMessage:"Add comment to any action Ex: isolate --comment your comment"})},{name:"--help",about:b.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.help",{defaultMessage:"Command assistance Ex: isolate --help"})}]),oe=(e,t)=>{var a,n,r,s;let l=e;switch(t.type){case"scrollDown":e.scrollToBottom();break;case"addFocusToKeyCapture":null===(a=e.keyCapture)||void 0===a||null===(n=a.current)||void 0===n||n.focus();break;case"removeFocusFromKeyCapture":null===(r=e.keyCapture)||void 0===r||null===(s=r.current)||void 0===s||s.blur();break;case"updateFooterContent":e.footerContent!==t.payload.value&&(l={...e,footerContent:t.payload.value});break;case"executeCommand":l=((e,t)=>{const{parsedInput:a,enteredCommand:n,input:r}=t.payload;if(""===a.name)return e;const s=null==n?void 0:n.commandDefinition;if(!s)return B(e,V({input:a.input,inputDisplay:r,args:a,commandDefinition:{...L,RenderComponent:A}},void 0,!1));const l={input:a.input,inputDisplay:r,args:a,commandDefinition:s},i=(u=s.args)?Object.entries(u).filter((([e,t])=>t.required)).map((([e])=>e)):[];var u;const c=(e=>e?Object.entries(e).reduce(((e,[t,a])=>(a.exclusiveOr&&e.push(t),e)),[]):[])(s.args),m=S.onlyOneFromExclusiveOr(c.map(H).join(", "));if(a.hasArgs){if(a.hasArg("help")){if(Object.keys(a.args).length>1||a.args.help.length>1||!0!==a.args.help[0])return B(e,V(D(l,P),void 0,!1));if(null!=s&&s.validate){const t=s.validate(l);if(!0!==t)return B(e,V(D(l,F),R({errorMessage:t}),!1))}return B(e,V(D(l,F),void 0,!1))}if(!s.args||0===Object.keys(s.args).length)return B(e,V(D(l,P),R({errorMessage:S.NO_ARGUMENTS_SUPPORTED}),!1));const t=((e,t)=>{const a=[];return Object.keys(e).forEach((e=>{"help"===e||t&&t[e]||a.push(e)})),a})(a.args,s.args);if(t.length)return B(e,V(D(l,P),R({errorMessage:S.unknownArgument(t.length,a.name,t.map(H).join(", "))}),!1));for(const t of i)if(!a.args[t])return B(e,V(D(l,P),R({errorMessage:o.a.createElement(O.a,null,S.missingRequiredArg(t))}),!1));if(c.filter((e=>a.args[e])).length>1)return B(e,V(D(l,P),R({errorMessage:m}),!1));for(const t of Object.keys(a.args)){var d;const n=null===(d=s.args)||void 0===d?void 0:d[t],r=a.args[t];if(!n)return B(e,V(D(l,P),R({errorMessage:o.a.createElement(O.a,null,S.unsupportedArg(t))}),!1));if(!n.allowMultiples&&Array.isArray(r)&&r.length>1)return B(e,V(D(l,P),R({errorMessage:o.a.createElement(O.a,null,S.noMultiplesAllowed(t))}),!1));if(void 0!==n.mustHaveValue&&!1!==n.mustHaveValue){let a="";if(0===r.length?a=S.mustHaveValue(t):r.some(((e,o)=>{switch(n.mustHaveValue){case!0:case"non-empty-string":("boolean"==typeof e||"non-empty-string"===n.mustHaveValue&&0===e.trim().length)&&(a=S.mustHaveValue(t));break;case"truthy":e||(a=S.mustHaveValue(t));break;case"number":case"number-greater-than-zero":if("boolean"==typeof e)a=S.mustHaveValue(t);else{const s=Number(e);Number.isSafeInteger(s)?"number-greater-than-zero"===n.mustHaveValue&&s<=0&&(a=S.mustBeGreaterThanZero(t)):a=S.mustBeNumber(t),a||(r[o]=s)}}return!!a})),a)return B(e,V(D(l,P),R({errorMessage:o.a.createElement(O.a,null,a)}),!1))}if(n.validate){const a=n.validate(r);if(!0!==a)return B(e,V(D(l,P),R({errorMessage:o.a.createElement(O.a,null,S.argValueValidatorError(t,a))}),!1))}}}else{if(i.length>0)return B(e,V(D(l,P),R({errorMessage:o.a.createElement(O.a,null,S.missingArguments(i.map((e=>H(e))).join(", ")))}),!1));if(c.length>0)return B(e,V(D(l,P),R({errorMessage:m}),!1));if(s.mustHaveArgs)return B(e,V(D(l,P),R({errorMessage:o.a.createElement(O.a,null,S.MUST_HAVE_AT_LEAST_ONE_ARG)}),!1))}if(s.validate){const t=s.validate(l);if(!0!==t)return B(e,V(D(l,z),R({errorMessage:t}),!1))}return B(e,V(l))})(e,t);break;case"updateCommandStatusState":case"updateCommandStoreState":l=((e,{type:t,payload:{id:a,value:n}})=>{let o=!1;const r=e.commandHistory.map((e=>{if(o||e.id!==a)return e;o=!0;const r={...e,state:{...e.state}};switch(t){case"updateCommandStoreState":r.state.store=n(r.state.store);break;case"updateCommandStatusState":if(r.state.status===n)return o=!1,e;r.state.status=n}return r}));return o?{...e,commandHistory:r}:e})(e,t);break;case"showSidePanel":l=((e,t)=>"showSidePanel"===t.type&&e.sidePanel.show!==t.payload.show?{...e,sidePanel:{...e.sidePanel,show:t.payload.show}}:e)(e,t);break;case"updateInputPopoverState":case"updateInputHistoryState":case"clearInputHistoryState":case"updateInputTextEnteredState":case"updateInputPlaceholderState":case"setInputState":case"updateInputCommandArgState":l=C(e,t);break;case"clear":l={...e,commandHistory:[]}}return l},re=Object(n.createContext)(null),se=Object(n.memo)((({commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:s,storagePrefix:l,managedKey:m,children:d})=>{const[g,h]=Object(c.d)(m),f=(e=>{const{storage:t}=Object(i.j)().services;return Object(n.useMemo)((()=>{if(e){var a;const n=null!==(a=t.get(`${e}.${u}`))&&void 0!==a?a:{version:2,data:[]};return 2!==n.version&&(e=>{const{data:t,version:a}=e;for(const e of t)a<2&&(e.display=e.input);e.version=2})(n),n.data}return[]}),[t,e])})(l),y=(e=>{const{storage:t}=Object(i.j)().services;return Object(n.useCallback)((a=>{if(e){const n={version:2,data:a};t.set(`${e}.${u}`,n)}}),[t,e])})(l),C=Object(n.useCallback)((e=>{const t=(({commands:e,...t},a)=>{const n=[{name:"help",about:b.i18n.translate("xpack.securitySolution.console.builtInCommands.helpAbout",{defaultMessage:"List all available commands"}),RenderComponent:te,helpGroupLabel:ae.supporting.label,helpCommandPosition:1},{name:"clear",about:b.i18n.translate("xpack.securitySolution.console.builtInCommands.clearAbout",{defaultMessage:"Clear console screen"}),RenderComponent:G,helpGroupLabel:ae.supporting.label,helpCommandPosition:0}].concat(e),o=null!=a?a:{commands:n,...t,commandHistory:[],sidePanel:{show:null},footerContent:"",input:{leftOfCursorText:"",rightOfCursorText:"",parsedInput:p(""),enteredCommand:void 0,placeholder:E,showPopover:void 0,history:[],visibleState:void 0}};return a&&Object.assign(o,{commands:n,...t}),o})(e,g?g():void 0);return t.input.history=f,t}),[g,f]),[v,O]=Object(n.useReducer)(oe,{commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:s,storagePrefix:l},C);return Object(n.useEffect)((()=>{h&&h(v)}),[v,h]),Object(n.useEffect)((()=>{l&&v.input.history&&y(v.input.history)}),[y,v.input.history,l]),o.a.createElement(re.Provider,{value:{state:v,dispatch:O}},d)}));se.displayName="ConsoleStateProvider";const le=()=>{const e=Object(n.useContext)(re);if(!e)throw new Error("ConsoleStateContext not defined");return e},ie=()=>le().state.input.visibleState,ue=Object(n.memo)((()=>{const e=le().state.footerContent,t=Object(x.a)(j()),a=ie(),s=Object(n.useMemo)((()=>"error"===a?"danger":"subdued"),[a]);return o.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",color:"transparent","data-test-subj":t("footer")},o.a.createElement(r.EuiText,{size:"xs",color:s,className:"font-style-italic"},e||o.a.createElement(o.a.Fragment,null," ")))}));ue.displayName="ConsoleFooter";const ce=()=>le().state.sidePanel,me=(b.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonTitle",{defaultMessage:"Help"}),b.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonLabel",{defaultMessage:"Show help"})),de=l()(r.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-lvlnbi-0"})(["margin-left:auto;height:inherit;"]),pe=Object(n.memo)((({TitleComponent:e})=>{const t=$(),a=ce().show,s=Object(x.a)(j("header")),l="help"===a,i=Object(n.useCallback)((()=>{t({type:"showSidePanel",payload:{show:l?null:"help"}})}),[t,l]);return o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"spaceBetween",responsive:!1},o.a.createElement(ge,{grow:1,className:"eui-textTruncate noThemeOverrides","data-test-subj":s("titleComponentContainer")},e?o.a.createElement(e,null):""),!l&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(de,{style:{marginLeft:"auto"},onClick:i,iconType:"help",title:me,"aria-label":me,isSelected:l,"data-test-subj":s("helpButton")},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.layoutHeader.helpButtonTitle",defaultMessage:"Help"}))))}));pe.displayName="ConsoleHeader";var ge=l()(r.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-lvlnbi-1"})({maxWidth:"95%"}),he=a(119),be=a.n(he),fe=a(52),Ee=a.n(fe);const ye=()=>{const{leftOfCursorText:e,rightOfCursorText:t,parsedInput:a,enteredCommand:o}=le().state.input;return Object(n.useMemo)((()=>({leftOfCursorText:e,rightOfCursorText:t,parsedInput:a,enteredCommand:o,fullTextEntered:e+t})),[o,e,a,t])},Ce=l.a.div.withConfig({displayName:"InputDisplayContainer",componentId:"sc-cduvts-0"})(["overflow:hidden !important;.inputDisplay{& > *{flex-direction:row;align-items:center;}}.cursor{display:inline-block;width:1px;height:","em;background-color:",";}"],(({theme:{eui:e}})=>e.euiLineHeight),(({theme:e})=>e.eui.euiTextSubduedColor)),ve=Object(n.memo)((({leftOfCursor:e,rightOfCursor:t})=>{const a=Object(x.a)(j()),s=$(),{leftOfCursorText:l,fullTextEntered:i}=ye(),u=Object(n.useRef)(null),c=Object(n.useRef)(null),m=Object(n.useRef)(null),d=l.length,p=Object(n.useCallback)((e=>{const t=e.target;if(i.length&&t.classList&&t.classList.contains("chr")){const a=Array.from(e.currentTarget.querySelectorAll("span.chr")).indexOf(t),n=i.substring(0,a+1),o=i.substring(a+1);s({type:"updateInputTextEnteredState",payload:{leftOfCursorText:n,rightOfCursorText:o}})}}),[s,i]);return Object(n.useEffect)((()=>{if(c.current){const e=e=>{if(c.current){const t=e[0];if(t&&t.rootBounds){const e=c.current.scrollLeft,a=t.rootBounds.right,n=t.rootBounds.left,o=t.boundingClientRect.right;if(o>a-20){const a=e+(o-t.rootBounds.width)+20;c.current.scrollLeft=a}else if(o<n+20){const t=o-20<0?0:e-20;c.current.scrollLeft=t}}}};return u.current=new IntersectionObserver(e,{root:c.current,rootMargin:"0px -10px",threshold:0}),()=>{var e;null===(e=u.current)||void 0===e||e.disconnect(),u.current=null}}}),[]),Object(n.useEffect)((()=>{if(u.current&&m.current){const e=u.current,t=m.current;return e.observe(t),()=>{e.unobserve(t)}}}),[d]),o.a.createElement(Ce,{ref:c},o.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none",className:"inputDisplay",onClick:p},o.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":a("cmdInput-leftOfCursor"),className:"noMinWidth"},e),o.a.createElement(r.EuiFlexItem,{grow:!1,className:"noMinWidth"},o.a.createElement("span",{className:"cursor essentialAnimation",ref:m})),o.a.createElement(r.EuiFlexItem,{className:"noMinWidth","data-test-subj":a("cmdInput-rightOfCursor")},t)))}));ve.displayName="InputDisplay";const Oe=()=>le().state.input.showPopover,Se=l.a.span.withConfig({displayName:"ArgumentSelectorWrapperContainer",componentId:"sc-jnz75k-0"})(["border:",";border-radius:",";overflow:hidden;user-select:none;.flexGroup{align-items:stretch;}.selectorContainer{padding:0 ",";max-width:25vw;display:flex;align-items:center;height:100%;}.argNameContainer{background-color:",";}.argName{padding-left:",";height:100%;display:flex;align-items:center;white-space:nowrap;}"],(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormInputGroupLabelBackground),(({theme:{eui:e}})=>e.euiSizeXS)),xe=Object(n.memo)((({argName:e,argIndex:t,argDefinition:{SelectorComponent:a}})=>{const s=$(),{valueText:l,value:i,store:u}=((e,t)=>{const a=le().state.input.enteredCommand;return Object(n.useMemo)((()=>{var n;const o=null==a||null===(n=a.argState[e])||void 0===n?void 0:n.at(t);return null!=o?o:{value:void 0,valueText:""}}),[e,a,t])})(e,t),c=Object(n.useCallback)((a=>{s({type:"updateInputCommandArgState",payload:{name:e,instance:t,state:a}})}),[t,e,s]);return o.a.createElement(Se,{className:"eui-displayInlineBlock"},o.a.createElement(r.EuiFlexGroup,{className:"flexGroup",responsive:!1,alignItems:"center",gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1,className:"argNameContainer"},o.a.createElement("div",{className:"argName"},o.a.createElement("span",null,`--${e}=`))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("div",{className:"selectorContainer noThemeOverrides eui-textTruncate"},o.a.createElement(a,{value:i,valueText:null!=l?l:"",argName:e,argIndex:t,store:u,onChange:c})))))}));xe.displayName="ArgumentSelectorWrapper";const je=[""," ","="],ke=(e={})=>({value:"",renderValue:null,isArgSelector:!1,argName:"",argIndex:0,argState:void 0,...e}),we=e=>e.split("").map((e=>ke({value:e,renderValue:e}))),Ie=(e,t,a)=>{var n;return o.a.createElement("span",{className:"chr",key:`${e}.${a}.${null!==(n=t.value)&&void 0!==n?n:"$"}`},t.renderValue)},Me=(e,t)=>{let a=t.value;var n,o;return e&&t.isArgSelector&&(a+=`="${null!==(n=null===(o=t.argState)||void 0===o?void 0:o.valueText)&&void 0!==n?n:""}"`),a};class entered_input_EnteredInput{constructor(e,t,a,n){if(d()(this,"leftOfCursorContent",void 0),d()(this,"rightOfCursorContent",void 0),d()(this,"canHaveArgValueSelectors",void 0),d()(this,"argState",void 0),this.leftOfCursorContent=we(e),this.rightOfCursorContent=we(t),this.canHaveArgValueSelectors=Boolean(null==n?void 0:n.argsWithValueSelectors),a.hasArgs&&n&&n.argsWithValueSelectors){this.argState=n.argState;const s=[{input:e,items:this.leftOfCursorContent,side:"left"},{input:t,items:this.rightOfCursorContent,side:"right"}];for(const[e,l]of Object.entries(n.argsWithValueSelectors))if(a.hasArg(e)){let a=0;for(const{input:i,items:u,side:c}of s){const s=`--${e}`;let m=i.indexOf(s);for(;m>-1;){const d=s.length,p=m+d,g=i.charAt(p),h="left"===c&&""===g&&je.includes(t.charAt(0));if(je.includes(g)&&(h||"left"===c&&""!==g||"right"===c)){var r;const t=Array.from({length:d},ke),i=null===(r=n.argState[e])||void 0===r?void 0:r.at(a);t[0]=ke({value:s,renderValue:o.a.createElement(xe,{argName:e,argIndex:a,argDefinition:l}),isArgSelector:!0,argName:e,argIndex:a++,argState:i}),u.splice(m,d,...t)}m=i.indexOf(s,p)}}}this.leftOfCursorContent=this.leftOfCursorContent.filter((({value:e})=>e.length>0)),this.rightOfCursorContent=this.rightOfCursorContent.filter((({value:e})=>e.length>0))}}replaceSelection(e,t){const a=this.getFullText(),n=t?ke({value:t}):void 0;let o=a.indexOf(e);const r=[...this.leftOfCursorContent,...this.rightOfCursorContent];this.canHaveArgValueSelectors&&r.forEach(((e,t)=>{e.isArgSelector&&t<o&&(o-=e.value.length-1)}));const s=r.splice(o,e.length);n&&(r.splice(o,0,n),o++),this.leftOfCursorContent=r.splice(0,o),this.rightOfCursorContent=r,this.removeArgState(s)}removeArgState(e){if(this.argState){let a=!1;const n={...this.argState};for(const{argName:o,argIndex:r,isArgSelector:s}of e){var t;s&&null!==(t=n[o])&&void 0!==t&&t.at(r)&&(n[o]=n[o].filter(((e,t)=>t!==r)),a=!0)}a&&(this.argState=n)}}getLeftOfCursorText(e=!1){return this.leftOfCursorContent.map(Me.bind(null,e)).join("")}getRightOfCursorText(e=!1){return this.rightOfCursorContent.map(Me.bind(null,e)).join("")}getFullText(e=!1){return this.getLeftOfCursorText(e)+this.getRightOfCursorText(e)}getLeftOfCursorRenderingContent(){return o.a.createElement(o.a.Fragment,null,this.leftOfCursorContent.map(Ie.bind(null,"left")))}getRightOfCursorRenderingContent(){return o.a.createElement(o.a.Fragment,null,this.rightOfCursorContent.map(Ie.bind(null,"right")))}getArgState(){return this.argState}moveCursorTo(e){switch(e){case"end":this.leftOfCursorContent.push(...this.rightOfCursorContent.splice(0));break;case"home":this.rightOfCursorContent.unshift(...this.leftOfCursorContent.splice(0));break;case"left":if(this.leftOfCursorContent.length){const e=this.leftOfCursorContent.pop();e&&this.rightOfCursorContent.unshift(e)}break;case"right":if(this.rightOfCursorContent.length){const e=this.rightOfCursorContent.shift();e&&this.leftOfCursorContent.push(e)}}}addValue(e,t=""){t.length&&e.length?this.replaceSelection(t,e):e&&this.leftOfCursorContent.push(ke({value:e}))}deleteChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.rightOfCursorContent.shift();null!=e&&e.isArgSelector&&this.removeArgState([e])}}backspaceChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.leftOfCursorContent.pop();null!=e&&e.isArgSelector&&this.removeArgState([e])}}clear(){this.leftOfCursorContent=[],this.rightOfCursorContent=[],this.argState=void 0}}const Te=b.i18n.translate("xpack.securitySolution.inputCapture.ariaPlaceHolder",{defaultMessage:"Enter a command"}),Ne=()=>{const e=getSelection();e&&e.removeAllRanges()},Fe=l.a.div.withConfig({displayName:"InputCaptureContainer",componentId:"sc-19dx6ae-0"})([".focus-container{outline:none !important;}.textSelectionBoundaryHelper{opacity:0;position:absolute;top:-100vh;left:-100vw;}.invisible-input{&,&:focus{border:none;outline:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;animation:none !important;width:1ch !important;position:absolute;opacity:0;top:-100vh;left:-100vw;}"]),Ae=Object(n.memo)((({onCapture:e,focusRef:t,onChangeFocus:a,children:r})=>{const s=Object(x.a)(j()),l=Object(n.useRef)(null),i=Object(n.useRef)(null),u=Object(n.useRef)(null),c=Object(n.useCallback)((()=>{if(l.current){var e,t,a;const n=document.getSelection(),o=(null!==(e=null==n?void 0:n.toString())&&void 0!==e?e:"").replace(/[\r\n]/g,""),r=!(!l.current||!n)&&(null===(t=l.current)||void 0===t?void 0:t.contains(n.focusNode))&&(null===(a=l.current)||void 0===a?void 0:a.contains(n.anchorNode));return n&&0!==o.length&&r?o:""}return""}),[]),m=Object(n.useCallback)((t=>{if(t.metaKey||t.ctrlKey){if("a"===t.key){t.preventDefault();const e=window.getSelection();if(e&&i.current){const t=document.createRange();t.selectNodeContents(i.current),t.toString().length>0&&(e.removeAllRanges(),e.addRange(t))}}return}const a=/^[\w\d]{2}/.test(t.key)?"":t.key,n=c(),o=Object(U.pick)(t,["key","altKey","ctrlKey","keyCode","metaKey","repeat","shiftKey"]);e({value:a,selection:n,eventDetails:o}),n&&Ne()}),[c,e]),d=Object(n.useCallback)((t=>{t.preventDefault(),t.stopPropagation();const a=t.clipboardData.getData("text").replace(/[\r\n]/g,""),n=c();e({value:a,selection:n,eventDetails:{altKey:!1,ctrlKey:!1,key:"Meta",keyCode:91,metaKey:!0,repeat:!1,shiftKey:!1}}),n&&Ne()}),[c,e]),p=Object(n.useCallback)((()=>{a&&a(!0)}),[a]),g=Object(n.useCallback)((()=>{a&&a(!1)}),[a]),h=Object(n.useMemo)((()=>({focus:(e=!1)=>{var t,a,n;!e&&(null!==(t=null===(a=window.getSelection())||void 0===a?void 0:a.toString())&&void 0!==t?t:"").length>0||document.activeElement===u.current||null===(n=u.current)||void 0===n||n.focus()},blur:()=>{var e;u.current&&document.activeElement===u.current&&(null===(e=u.current)||void 0===e||e.blur())}})),[]);return t&&(t.current=h),o.a.createElement(Fe,{"data-test-subj":s("inputCapture"),onKeyDown:m,onPaste:d},o.a.createElement("div",{role:"textbox","aria-placeholder":Te,tabIndex:0,ref:l,className:"focus-container","data-test-subj":s("keyCapture-input"),onBlur:g,onFocus:p},o.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),o.a.createElement("div",{ref:i,className:"text-container"},r),o.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),o.a.createElement("input",{ref:u,type:"text",value:"",tabIndex:-1,onPaste:d,onChange:()=>{},spellCheck:"false",className:"invisible-input"})))}));Ae.displayName="InputCapture";const Pe=b.i18n.translate("xpack.securitySolution.useInputHints.noArguments",{defaultMessage:"Hit enter to execute"}),ze=b.i18n.translate("xpack.securitySolution.useInputHints.viewInputHistory",{defaultMessage:"Press the up arrow key to access previously entered commands"}),He=l()(r.EuiText).withConfig({displayName:"InputPlaceholderContainer",componentId:"sc-6afwlc-0"})(["position:absolute;pointer-events:none;padding-left:0.5em;width:96%;color:",";user-select:none;"],(({theme:{eui:e}})=>e.euiFormControlPlaceholderText)),Be=Object(n.memo)((()=>{const{fullTextEntered:e}=ye(),t=le().state.input.placeholder,a=Object(x.a)(j());return e.length>0?null:o.a.createElement(He,{size:"s",className:"eui-textTruncate","data-test-subj":a("inputPlaceholder")},o.a.createElement("div",{className:"eui-textTruncate"},t))}));Be.displayName="InputPlaceholder";const Le=l()(r.EuiCode).withConfig({displayName:"StyledEuiCode",componentId:"sc-qp7srp-0"})(["padding-left:0;"]),Re=Object(n.memo)((({input:e,isValid:t=!0})=>{const a=Object(x.a)(j()),s=Object(n.useMemo)((()=>t?e:o.a.createElement(r.EuiTextColor,null,e)),[e,t]);return o.a.createElement(Le,{transparentBackground:!0,"data-test-subj":a("userCommandText")},s)}));Re.displayName="UserCommandInput";const De=Object(n.memo)((()=>{const[e,t]=Object(n.useState)(!1),a=$(),s=Object(x.a)(j()),l=Object(n.useCallback)((()=>{t(!0)}),[]),i=Object(n.useCallback)((()=>{t(!1)}),[]),u=Object(n.useCallback)((()=>{a({type:"clearInputHistoryState"}),t(!1)}),[a]);return o.a.createElement(o.a.Fragment,null,e&&o.a.createElement(r.EuiConfirmModal,{title:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmTitle",{defaultMessage:"Clear input history"}),cancelButtonText:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmSubmitButton",{defaultMessage:"Clear"}),buttonColor:"danger",onCancel:i,onConfirm:u},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.confirmMessage",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})),o.a.createElement(r.EuiFlexGroup,{responsive:!1,justifyContent:"flexEnd",gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonEmpty,{size:"xs",tabIndex:-1,onClick:l,disabled:e,"data-test-subj":s("clearInputHistoryButton")},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.clearHistoryButtonLabel",defaultMessage:"Clear input history"})))))}));De.displayName="CommandInputClearHistory";const Ve=b.i18n.translate("xpack.securitySolution.commandInputHistory.noHistoryEmptyMessage",{defaultMessage:"No commands have been entered"}),$e=b.i18n.translate("xpack.securitySolution.commandInputHistory.filterPlaceholder",{defaultMessage:"Filter previously entered actions"}),Ge=b.i18n.translate("xpack.securitySolution.commandInputHistory.noFilteredMatchesFoundMessage",{defaultMessage:"No entries found matching the filter entered"}),Ue=Object(n.memo)((()=>{const e=$(),t=le().state.input.history,[a]=Object(n.useState)(ye()),s=Object(n.useRef)(!1),l=Object(x.a)(j()),i=Object(n.useMemo)((()=>t.map(((e,t)=>({label:e.display,key:e.id,data:e})))),[t]),u=Object(n.useMemo)((()=>({showIcons:!1,bordered:!0})),[]),c=Object(n.useMemo)((()=>({placeholder:$e,compressed:!0,fullWidth:!0})),[]),m=Object(n.useCallback)(((e,a)=>o.a.createElement(o.a.Fragment,null,e,o.a.createElement(r.EuiSpacer,{size:"s"}),t.length>0?a:o.a.createElement("div",{tabIndex:-1}))),[t.length]),d=Object(n.useCallback)((t=>{s.current=!0;const a=t.find((e=>"on"===e.checked));e({type:"updateInputPopoverState",payload:{show:void 0}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}),a&&e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a.data.input,rightOfCursorText:""}}),e({type:"addFocusToKeyCapture"})}),[e]),p=Object(n.useCallback)((t=>{t&&e({type:"updateInputPlaceholderState",payload:{placeholder:t.data.input}})}),[e]),g=Object(n.useCallback)((e=>o.a.createElement(Re,{input:e.label})),[]);return Object(n.useEffect)((()=>(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}),()=>{s.current||(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a.leftOfCursorText,rightOfCursorText:a.rightOfCursorText}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}))})),[e,s,a]),o.a.createElement("div",null,t.length>0&&o.a.createElement(De,null),o.a.createElement(r.EuiSelectable,{options:i,onChange:d,onActiveOptionChange:p,renderOption:g,listProps:u,singleSelection:!0,searchable:!0,searchProps:c,emptyMessage:Ve,noMatchesMessage:Ge,"data-test-subj":l("inputHistorySelector"),"data-console-input-history":!0},m))}));Ue.displayName="CommandInputHistory";const _e=Object(n.memo)((({children:e,width:t="92vw"})=>{const a=Object(x.a)(j()),s=Oe(),l=void 0!==s,i=$(),u=Object(n.useMemo)((()=>({width:t,borderBottomLeftRadius:0,borderBottomRightRadius:0})),[t]),c=Object(n.useMemo)((()=>({clickOutsideDisables:!0})),[]),m=Object(n.useCallback)((()=>{i({type:"updateInputPopoverState",payload:{show:void 0}}),i({type:"addFocusToKeyCapture"})}),[i]);return Object(n.useEffect)((()=>{s||i({type:"addFocusToKeyCapture"})}),[i,s]),o.a.createElement(r.EuiPopover,{button:e,closePopover:m,isOpen:l,panelStyle:u,anchorPosition:"upLeft",hasArrow:!1,display:"block",attachToAnchor:!0,focusTrapProps:c,ownFocus:!1,"data-test-subj":a("inputPopover")},s&&o.a.createElement(r.EuiFocusTrap,{clickOutsideDisables:!0},"input-history"===s&&o.a.createElement(Ue,null)))}));_e.displayName="InputAreaPopover";const We=l.a.div.withConfig({displayName:"CommandInputContainer",componentId:"sc-ujnhrt-0"})(["background-color:",";border-radius:",";padding:",";outline:",";&:focus-within{border-bottom:",";border-bottom-color:",";}&.error{border-bottom-color:",";}.textEntered{white-space:break-spaces;}.prompt{padding-right:1ch;}&.withPopover{border-top-left-radius:0;border-top-right-radius:0;}&.hasFocus{.cursor{background-color:",";animation:cursor-blink-animation 1s steps(5,start) infinite;-webkit-animation:cursor-blink-animation 1s steps(5,start) infinite;@keyframes cursor-blink-animation{to{visibility:hidden;}}@-webkit-keyframes cursor-blink-animation{to{visibility:hidden;}}}}"],(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderRadius),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderThick),(({theme:{eui:e}})=>e.euiColorPrimary),(({theme:{eui:e}})=>e.euiColorDanger),(({theme:{eui:e}})=>e.euiTextColor)),qe=Object(n.memo)((({prompt:e="",focusRef:t,...a})=>{(()=>{const e=$(),t=Boolean(Oe()),a=(()=>{const e=le().state.input.parsedInput;return-1!==e.input.trimStart().indexOf(" ")?e.name:""})(),o=ee(),{leftOfCursorText:r}=ye(),s=Object(n.useMemo)((()=>{if(a)return o.find((e=>e.name===a))}),[a,o]);Object(n.useEffect)((()=>{if(a&&!t)if(s&&!0!==s.helpHidden){var n,o;const t=null!==(n=null==s?void 0:s.exampleInstruction)&&void 0!==n?n:"",a=null!==(o=null==s?void 0:s.exampleUsage)&&void 0!==o?o:"";let r=null!=t?t:"";if(a&&(r+=t?` ${b.i18n.translate("xpack.securitySolution.useInputHints.exampleInstructions",{defaultMessage:"Ex: [ {exampleUsage} ]",values:{exampleUsage:a}})}`:a),!r||!a){const e=h(s);e.length>0?r+=`${s.name} ${e}`:r+=Pe}e({type:"updateFooterContent",payload:{value:r}}),e({type:"setInputState",payload:{value:void 0}})}else e({type:"updateFooterContent",payload:{value:(l=a,b.i18n.translate("xpack.securitySolution.useInputHints.unknownCommand",{defaultMessage:"Unknown command {commandName}",values:{commandName:l}}))}}),e({type:"setInputState",payload:{value:"error"}});else e({type:"updateFooterContent",payload:{value:r||t?"":ze}}),e({type:"setInputState",payload:{value:void 0}});var l}),[a,s,e,t,r])})();const s=Object(x.a)(j()),l=$(),{rightOfCursorText:i,leftOfCursorText:u,fullTextEntered:c,enteredCommand:m,parsedInput:d}=ye(),p=ie(),g=!!Oe(),[f,E]=Object(n.useState)(!1),[y,C]=Object(n.useState)(void 0),[v,O]=Object(n.useState)("94vw"),S=Object(n.useRef)(null),k=t||S,w=Object(n.useMemo)((()=>Ee()({cmdInput:!0,hasFocus:f,error:"error"===p,withPopover:g})),[f,g,p]),I=Object(n.useMemo)((()=>0===c.trim().length),[c]),M=Object(n.useMemo)((()=>new entered_input_EnteredInput(u,i,d,m)),[m,u,d,i]),T=Object(n.useCallback)((({width:e})=>{e>0&&O(`${e}px`)}),[]),N=Object(n.useCallback)((()=>{C({input:M.getFullText(!0),enteredCommand:m,parsedInput:d})}),[m,d,M]),F=Object(n.useCallback)((e=>{E(e)}),[]),A=Object(n.useCallback)((e=>{k.current&&k.current.focus(),g&&l({type:"updateInputPopoverState",payload:{show:void 0}})}),[l,g,k]),P=Object(n.useCallback)((({value:e,selection:t,eventDetails:a})=>{const n=a.keyCode;if(38===n)return l({type:"removeFocusFromKeyCapture"}),void l({type:"updateInputPopoverState",payload:{show:"input-history"}});l({type:"updateInputTextEnteredState",payload:({leftOfCursorText:a,rightOfCursorText:o,enteredCommand:r,parsedInput:s})=>{const l=new entered_input_EnteredInput(a,o,s,r);switch(l.addValue(null!=e?e:"",t),n){case 8:l.backspaceChar(t);break;case 46:l.deleteChar(t);break;case 13:C({input:l.getFullText(!0),enteredCommand:r,parsedInput:s}),l.clear();break;case 37:l.moveCursorTo("left");break;case 39:l.moveCursorTo("right");break;case 36:l.moveCursorTo("home");break;case 35:l.moveCursorTo("end")}return{leftOfCursorText:l.getLeftOfCursorText(),rightOfCursorText:l.getRightOfCursorText(),argState:l.getArgState()}}})}),[l]);return Object(n.useEffect)((()=>{y&&(l({type:"executeCommand",payload:y}),C(void 0),l({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}))}),[y,l]),o.a.createElement(_e,{width:v},o.a.createElement(r.EuiResizeObserver,{onResize:T},(n=>o.a.createElement(We,be()({},a,{className:w,onClick:A,ref:n,"data-test-subj":s("cmdInput-container")}),o.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none"},e&&o.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":s("cmdInput-prompt")},o.a.createElement("span",{className:"eui-displayInlineBlock prompt"},e)),o.a.createElement(r.EuiFlexItem,{className:"textEntered"},o.a.createElement(Ae,{onCapture:P,onChangeFocus:F,focusRef:t},o.a.createElement(ve,{leftOfCursor:M.getLeftOfCursorRenderingContent(),rightOfCursor:M.getRightOfCursorRenderingContent()})),o.a.createElement(Be,null)),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonIcon,{"data-test-subj":s("inputTextSubmitButton"),"aria-label":"submit-command",iconType:"playFilled",color:"primary",isDisabled:I,onClick:N})))))))}));qe.displayName="CommandInput";var Ke=a(54),Xe=a.n(Ke);const Ze=Object(n.memo)((({size:e="s",color:t,children:a,"data-test-subj":n,className:s})=>{const{euiTheme:l}=Object(r.useEuiTheme)();return o.a.createElement(r.EuiText,{size:e,"data-test-subj":n,className:`font-family-code ${null!=s?s:""}`},o.a.createElement(r.EuiTextColor,{color:null!=t?t:l.colors.text},a))}));Ze.displayName="ConsoleText";const Ye=Object(n.memo)((()=>{const e=Object(x.a)(j());return o.a.createElement(Ze,{"data-test-subj":e("longRunningCommandHint")},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.longRunningCommandHintMessage",defaultMessage:"Hint: We are still working on this task. You may leave the console or place another command while this command is processing."}))}));Ye.displayName="LongRunningCommandHint";const Je=b.i18n.translate("xpack.securitySolution.commandExecutionResult.successTitle",{defaultMessage:"Action completed."}),Qe=b.i18n.translate("xpack.securitySolution.commandExecutionSubmitResult.successTitle",{defaultMessage:"Action successfully submitted."}),et=b.i18n.translate("xpack.securitySolution.commandExecutionResult.failureTitle",{defaultMessage:"Action failed."}),tt=b.i18n.translate("xpack.securitySolution.commandExecutionResult.pending",{defaultMessage:"Action pending."}),at=Object(n.memo)((({showAs:e="success",title:t,showTitle:a=!0,"data-test-subj":s,className:l,children:i,agentType:u})=>{const c=j(),m=Object(x.a)(null!=s?s:c),d=Object(n.useMemo)((()=>Ee()({"eui-displayInlineBlock":"pending"===e,"font-family-code":!0,[l||"_"]:Boolean(l)})),[l,e]),p=Object(n.useMemo)((()=>t||("success"===e?"crowdstrike"===u?Qe:Je:et)),[u,e,t]);return o.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",borderRadius:"none",color:"transparent",className:d,"data-test-subj":s||m("commandExecutionResult")},"pending"===e?o.a.createElement(Ze,null,null!=i?i:tt):o.a.createElement(o.a.Fragment,null,a&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ze,{color:"success"===e?"success":"danger"},p),o.a.createElement(r.EuiSpacer,{size:"s"})),i))}));at.displayName="CommandExecutionResult";const nt=l.a.div.withConfig({displayName:"CommandOutputContainer",componentId:"sc-1wmcd6l-0"})(["position:relative;.busy-indicator{margin-left:0.5em;}"]),ot=Object(n.memo)((({item:{command:e,state:t,id:a,enteredAt:s,isValid:l}})=>{const i=$(),u=e.commandDefinition.RenderComponent,[c,m]=Object(n.useState)(!1),d=Object(n.useMemo)((()=>"pending"===t.status),[t.status]),p=Object(n.useCallback)((e=>{i({type:"updateCommandStatusState",payload:{id:a,value:e}})}),[i,a]),g=Object(n.useCallback)((e=>{i({type:"updateCommandStoreState",payload:{id:a,value:e}})}),[i,a]);return Object(n.useEffect)((()=>{let e;if(d&&!c){const t=Xe()().diff(Xe()(s),"seconds");if(t>=15)return void m(!0);e=setTimeout((()=>{m(!0)}),1e3*(15-t))}return()=>{e&&clearTimeout(e)}}),[s,c,d]),o.a.createElement(nt,null,o.a.createElement("div",null,o.a.createElement(Re,{input:e.inputDisplay,isValid:l})),o.a.createElement("div",{className:"noThemeOverrides"},o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(u,{command:e,store:t.store,status:t.status,setStore:g,setStatus:p,ResultComponent:at}),d&&o.a.createElement(r.EuiLoadingChart,{className:"busy-indicator",mono:!0}),d&&c&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(Ye,null))))}));ot.displayName="CommandExecutionOutput";const rt=a(59).css`
  ${({theme:{eui:e}})=>e.euiSizeL}
`,st=l()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemHistoryItem",componentId:"sc-1249lql-0"})(["border-bottom:"," dashed ",";margin-bottom:",";padding-bottom:",";"],(({theme:{eui:e}})=>e.euiBorderWidthThin),(({theme:{eui:e}})=>e.euiBorderColor),rt,rt),lt=Object(n.memo)((({children:e})=>{const t=Object(x.a)(j());return o.a.createElement(st,{grow:!0,"data-test-subj":t("historyItem")},e)}));lt.displayName="HistoryItem";const it=Object(n.memo)((e=>{const t=le().state.commandHistory,a=$(),s=Object(x.a)(j()),l=Object(n.useMemo)((()=>t.map((e=>o.a.createElement(lt,{key:e.id},o.a.createElement(ot,{item:e}))))),[t]);return Object(n.useEffect)((()=>{a({type:"scrollDown"})}),[a,t.length]),o.a.createElement(r.EuiFlexGroup,be()({"data-test-subj":s("historyOutput")},e,{wrap:!0,direction:"column",alignItems:"stretch",responsive:!1,gutterSize:"none"}),l)}));it.displayName="HistoryOutput";const ut=l()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemNoPadding",componentId:"sc-ojfnk7-0"})(["padding:0 !important;"]),ct=Object(n.memo)((({headerContent:e,children:t})=>{const a=Object(x.a)(j("sidePanel"));return o.a.createElement(r.EuiFlexGroup,{direction:"column",responsive:!1,className:"eui-fullHeight",gutterSize:"none","data-test-subj":a()},e&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container","data-test-subj":a("header")},e),o.a.createElement(r.EuiHorizontalRule,{margin:"none"})),o.a.createElement(ut,{className:"eui-scrollBar eui-yScroll layout-container"},o.a.createElement("div",{"data-test-subj":a("body")},t)))}));ct.displayName="SidePanelContentLayout";const mt=l()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-u9ickv-0"})(["padding-top:",";padding-right:",";"],(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall)),dt=Object(n.memo)((()=>{const e=$(),t=ee(),a=Object(x.a)(j("sidePanel")),s=ce().show,l=Object(n.useCallback)((()=>{e({type:"showSidePanel",payload:{show:null}})}),[e]),i=Object(n.useMemo)((()=>"help"===s?o.a.createElement(o.a.Fragment,null,o.a.createElement(mt,null,o.a.createElement(r.EuiFlexItem,null,o.a.createElement(r.EuiTitle,{size:"s","data-test-subj":a("headerTitle")},o.a.createElement("h3",null,o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpTitle",defaultMessage:"Help"})))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonIcon,{"aria-label":"closeSidePanelIcon",iconType:"cross",color:"text",onClick:l,"data-test-subj":a("headerCloseButton")}))),o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(r.EuiText,{size:"s"},o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpDescription",defaultMessage:"Use the add ({icon}) button to populate a response action to the text bar. Add additional parameters or comments as necessary.",values:{icon:o.a.createElement(r.EuiIcon,{type:"plusInCircle"})}}))):null),[s,a,l]),u=Object(n.useMemo)((()=>"help"===s?o.a.createElement("div",{"data-test-subj":a("helpContent")},o.a.createElement(Q,{commands:t,display:"table"})):null),[t,a,s]);return s?o.a.createElement(ct,{headerContent:i},u):null}));dt.displayName="RightPanelContentManager";const pt=l()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemWhite",componentId:"sc-hd3kv7-0"})(["background-color:"," !important;border-radius:",";box-shadow:0 "," "," ",";"],(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>`0 ${e.euiSizeXS} ${e.euiSizeXS} 0`),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>Object(r.transparentize)(e.euiShadowColor,.04))),gt=Object(n.memo)((e=>Boolean(ce().show)?o.a.createElement(pt,{grow:!1,className:"layout-rightPanel"},o.a.createElement(dt,null)):null));gt.displayName="SidePanelFlexItem";const ht=l.a.div.withConfig({displayName:"ConsoleWindow",componentId:"sc-d15gh7-0"})(["height:100%;background-color:",";border:",";border-radius:",";.layout{height:100%;width:100%;min-height:300px;min-width:300px;overflow:hidden;&-hideOverflow{overflow:hidden;}&-bottomBorder{border-bottom:"," solid ",";}&-container{padding:",";}&-header{background-color:",";border-bottom:1px solid ",";border-top-left-radius:",";border-top-right-radius:",";padding:"," "," "," ",";}&-commandInput{padding-top:",";padding-bottom:",";}&-footer{padding-top:0;padding-bottom:",";}&-rightPanel{width:35%;background-color:",";border-left:",";}&-historyOutput{overflow:auto;}&-historyViewport{height:100%;overflow-x:hidden;white-space:pre-wrap;}.euiFlexItem:not(.noMinWidth):not(.noThemeOverrides .euiFlexItem){min-width:0;}}.font-family-code{font-family:",";}.font-style-italic{font-style:italic;}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingMedium),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiColorLightShade),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiCodeFontFamily)),bt=Object(n.memo)((({prompt:e,commands:t,HelpComponent:a,TitleComponent:s,storagePrefix:l,managedKey:i,...u})=>{const m=Object(n.useRef)(null),d=Object(n.useRef)(null),p=Object(x.a)(u["data-test-subj"]),g=Object(c.c)(i),h=Object(n.useCallback)((()=>{setTimeout((()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)}),1)}),[]),b=Object(n.useCallback)((()=>{d.current&&d.current.focus()}),[]);return Object(n.useEffect)((()=>{g&&!g.isOpen||setTimeout(b,2)}),[b,g]),o.a.createElement(se,{commands:t,scrollToBottom:h,keyCapture:d,managedKey:i,HelpComponent:a,dataTestSubj:u["data-test-subj"],storagePrefix:l},o.a.createElement(ht,u,o.a.createElement(r.EuiFlexGroup,{className:"layout",gutterSize:"none",responsive:!1},o.a.createElement(r.EuiFlexItem,null,o.a.createElement(r.EuiFlexGroup,{direction:"column",className:"layout",gutterSize:"none",responsive:!1,"data-test-subj":p("mainPanel")},o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-header"},o.a.createElement(pe,{TitleComponent:s})),o.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexItem,{className:"eui-fullHeight layout-hideOverflow"},o.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-historyOutput"},o.a.createElement("div",{className:"layout-container layout-historyViewport eui-scrollBar eui-yScroll",ref:m},o.a.createElement(it,null))),o.a.createElement(r.EuiFlexItem,{onClick:b,grow:!1,className:"layout-container layout-commandInput","data-test-subj":p("mainPanel-inputArea")},o.a.createElement(qe,{prompt:e,focusRef:d})),o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container layout-footer"},o.a.createElement(ue,null)))))))),o.a.createElement(gt,null))))}));bt.displayName="Console"},1427:function(e,t,a){"use strict";a.d(t,"a",(function(){return B})),a.d(t,"b",(function(){return L})),a.d(t,"c",(function(){return R})),a.d(t,"d",(function(){return D}));var n=a(119),o=a.n(n),r=a(2),s=a.n(r),l=a(4),i=a(19),u=a(42),c=a(41),m=a.n(c),d=a(52),p=a.n(d),g=a(126);const h=m()(i.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-n74boe-0"})(["&.full-height,.full-height{height:100%;}.is-not-scrollable{overflow:hidden;}.is-scrollable{overflow:auto;}"]),b=Object(r.memo)((({pageTitle:e,pageDescription:t,pageBody:a,actions:n,headerHasBottomBorder:o,restrictWidth:l,paddingSize:u="l",scrollableBody:c=!1,headerBackComponent:m,children:d,"data-test-subj":b})=>{const f=!(e||t||n||m),E=Object(g.a)(b),y=Object(r.useMemo)((()=>Array.isArray(n)?n:n?[n]:void 0),[n]),C=Object(r.useMemo)((()=>({gutterSize:"s"})),[]),v=Object(r.useMemo)((()=>p()({"is-scrollable":c,"is-not-scrollable":!c,"full-height":!0})),[c]),O=Object(r.useMemo)((()=>f?null:s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart",wrap:!1,responsive:!1},m&&s.a.createElement(i.EuiFlexItem,{grow:!1},m),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiTitle,{size:"l"},s.a.createElement("span",{"data-test-subj":E("titleHolder")},e))))),[E,m,f,e]);return s.a.createElement(h,{hasShadow:!1,paddingSize:u,"data-test-subj":b,className:"full-height",color:"transparent"},s.a.createElement(i.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none",className:"full-height","data-test-subj":E("root")},!f&&s.a.createElement(i.EuiFlexItem,{grow:!1,"data-test-subj":E("headerContainer")},s.a.createElement(i.EuiPageHeader,{pageTitle:O,description:t,bottomBorder:o,rightSideItems:y,rightSideGroupProps:C,restrictWidth:l,alignItems:"bottom","data-test-subj":E("header")}),s.a.createElement(i.EuiSpacer,{size:"l"})),s.a.createElement(i.EuiFlexItem,{grow:!1},a),s.a.createElement(i.EuiFlexItem,{grow:!0,className:v,"data-test-subj":E("consoleBody")},s.a.createElement("div",{role:"main",className:"full-height"},d))))}));b.displayName="PageLayout";var f=a(48),E=a(1213),y=a(206),C=a(196);const v=m.a.div.withConfig({displayName:"OverlayRootContainer",componentId:"sc-vostrz-0"})(["border:none;display:block;position:fixed;overflow:hidden;top:var(--euiFixedHeadersOffset,0);bottom:0;right:0;height:calc(100% - var(--euiFixedHeadersOffset,0));width:100%;z-index:",";background-color:",";&.scrolling{overflow:auto;}&.hidden{display:none;}&.padding-xs{padding:",";}&.padding-s{padding:",";}&.padding-m{padding:",";}&.padding-l{padding:",";}&.padding-xl{padding:",";}&.fullScreen{top:0;height:100%;}.fullHeight{height:100%;}"],(({theme:{eui:e}})=>e.euiZFlyout+3),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeM),(({theme:{eui:e}})=>e.euiSizeL),(({theme:{eui:e}})=>e.euiSizeXL)),O="securitySolution-pageOverlay",S=`${O}-isVisible`,x=`${O}-lock`,j=`${O}-fullScreen`,k=`${O}-overSecuritySolutionPageWrapper`,w=Object(c.createGlobalStyle)(["body.","{overflow:hidden;}body.","{","}"],x,j,C.e),I=()=>{document.body.classList.remove(S)},M=()=>{document.body.classList.remove(x)},T=()=>{document.body.classList.remove(j)},N=()=>{document.body.classList.remove(k)},F=Object(r.memo)((({children:e,onHide:t,isHidden:a=!1,enableScrolling:n=!0,hideOnUrlPathnameChange:o=!0,lockDocumentBody:l=!0,appendAsBodyLastNode:u=!0,paddingSize:c,zIndex:m,"data-test-subj":d})=>{const{pathname:g}=Object(f.useLocation)(),h=Object(E.a)(),b=Object(y.b)(),[C,F]=Object(r.useState)(null),A=Object(r.useRef)(),P=Object(r.useCallback)((e=>{A.current=e}),[]),z=Object(r.useMemo)((()=>{const e={};return m&&(e.zIndex=m),e}),[m]),H=Object(r.useMemo)((()=>p()({[O]:!0,scrolling:n,hidden:a,fullScreen:b,"eui-scrollBar":n,"padding-xs":"xs"===c,"padding-s":"s"===c,"padding-m":"m"===c,"padding-l":"l"===c,"padding-xl":"xl"===c})),[n,a,c,b]);return Object(r.useEffect)((()=>{h()&&F((e=>a?null:e||(u&&A.current&&document.body.appendChild(A.current),g)))}),[u,a,h,g]),Object(r.useEffect)((()=>{h()&&o&&!a&&C&&C!==g&&t()}),[o,a,h,t,C,g]),Object(r.useEffect)((()=>{if(h()){const e=Boolean(document.querySelector(".securitySolutionWrapper"));a?(I(),M(),T(),N()):(document.body.classList.add(S),l&&document.body.classList.add(x),b&&document.body.classList.add(j),e&&document.body.classList.add(k))}return()=>{M(),I(),T(),N()}}),[a,h,l,b]),s.a.createElement(i.EuiPortal,{portalRef:P},s.a.createElement(v,{"data-test-subj":d,className:H,style:z},s.a.createElement(i.EuiFocusTrap,{"data-test-subj":"trap-focus",className:"fullHeight"},e)),s.a.createElement(w,null))}));F.displayName="PageOverlay";const A=l.i18n.translate("xpack.securitySolution.consolePageOverlay.backButtonLabel",{defaultMessage:"Back"}),P=Object(r.memo)((({console:e,onHide:t,isHidden:a,body:n,actions:o,pageTitle:l="",showCloseButton:c=!1})=>{const m=Object(g.a)("consolePageOverlay"),d=Object(r.useCallback)((e=>{e.preventDefault(),t()}),[t]),p=Object(r.useMemo)((()=>a?{}:{pageTitle:l,pageBody:n,headerHasBottomBorder:!1,"data-test-subj":m("layout"),headerBackComponent:s.a.createElement(i.EuiButtonEmpty,{flush:"left",size:"s",iconType:"arrowLeft",onClick:d,"data-test-subj":m("header-back-link")},A),actions:c?[s.a.createElement(i.EuiButton,{fill:!0,onClick:d,minWidth:"auto","data-test-subj":m("doneButton")},s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.consolePageOverlay.doneButtonLabel",defaultMessage:"Done"})),...null!=o?o:[]]:[...null!=o?o:[]]}),[o,n,m,d,a,l,c]);return s.a.createElement(F,{isHidden:a,"data-test-subj":"consolePageOverlay",onHide:t,paddingSize:"l",enableScrolling:!1},s.a.createElement(b,p,e))}));P.displayName="ConsolePageOverlay";var z=a(1320);const H=s.a.createContext(void 0),B=Object(r.memo)((({storage:e={},children:t})=>{const[a,n]=Object(r.useState)(e),[l]=Object(r.useState)(new Map),i=Object(r.useRef)();i.current=a;const u=Object(r.useCallback)((e=>{var t;if(null===(t=i.current)||void 0===t||!t[e])throw new Error(`Console with id ${e} not found`)}),[]),c=Object(r.useCallback)((e=>{u(e),n((t=>{const a={...t};return Object.entries(a).forEach((([e,t])=>{t.isOpen&&(a[e]={...t,isOpen:!1})})),a[e]={...a[e],isOpen:!0},a}))}),[u]),m=Object(r.useCallback)((e=>{u(e),n((t=>({...t,[e]:{...t[e],isOpen:!1}})))}),[u]),d=Object(r.useCallback)((e=>{u(e),n((t=>{const a={...t};return delete a[e],a}))}),[u]),p=Object(r.useCallback)((e=>{var t;if(null!==(t=i.current)&&void 0!==t&&t[e])return i.current[e].client}),[]),g=Object(r.useCallback)((()=>Object.values(a).map((e=>e.client))),[a]),h=Object(r.useCallback)((e=>{var t;return!(null===(t=i.current)||void 0===t||!t[e])&&i.current[e].isOpen}),[]),b=Object(r.useCallback)((({id:e,meta:t,consoleProps:r,...l})=>{if(a[e])throw new Error(`Console with id ${e} already registered`);const i=Symbol(e),u=c.bind(null,e),p=m.bind(null,e),g=d.bind(null,e),b=h.bind(null,e),f={PageBodyComponent:void 0,PageTitleComponent:void 0,ActionComponents:void 0,...l,client:{id:e,meta:t,show:()=>{setTimeout(u,0)},hide:()=>{setTimeout(p,0)},terminate:()=>{setTimeout(g,0)},isVisible:()=>b()},consoleProps:r,console:s.a.createElement(z.a,o()({},r,{managedKey:i,key:e})),isOpen:!1,key:i};return n((t=>({...t,[e]:f}))),f.client}),[a,m,h,c,d]),f=Object(r.useMemo)((()=>({register:b,show:c,hide:m,terminate:d,getOne:p,getList:g})),[g,p,m,b,c,d]),E=Object(r.useMemo)((()=>({client:f,internal:{getManagedConsole:e=>Object.values(a).find((t=>t.key===e)),getManagedConsoleState:e=>l.get(e),storeManagedConsoleState(e,t){l.set(e,t)}}})),[f,l,a]),y=Object(r.useMemo)((()=>Object.values(a).find((e=>e.isOpen))),[a]),C=Object(r.useMemo)((()=>{var e;return null!==(e=null==y?void 0:y.client.meta)&&void 0!==e?e:{}}),[null==y?void 0:y.client.meta]),v=Object(r.useCallback)((()=>{y&&f.hide(y.client.id)}),[f,y]);return s.a.createElement(H.Provider,{value:E},t,y&&s.a.createElement(P,{onHide:v,console:s.a.createElement(z.a,o()({},y.consoleProps,{managedKey:y.key,key:y.client.id})),isHidden:!y,pageTitle:y.PageTitleComponent&&s.a.createElement(y.PageTitleComponent,{meta:C}),body:y.PageBodyComponent&&s.a.createElement(y.PageBodyComponent,{meta:C}),actions:y.ActionComponents&&y.ActionComponents.map((e=>s.a.createElement(e,{meta:C}))),showCloseButton:y.showCloseButton}))}));B.displayName="ConsoleManager";const L=()=>{const e=Object(r.useContext)(H);if(!e)throw new Error("ConsoleManagerContext not found");return e.client},R=e=>{const t=Object(r.useContext)(H);if(e&&t)return t.internal.getManagedConsole(e)},D=e=>{const t=Object(r.useContext)(H);return Object(r.useMemo)((()=>e&&t?[()=>t.internal.getManagedConsoleState(e),a=>{t.internal.getManagedConsole(e)&&t.internal.storeManagedConsoleState(e,a)}]:[void 0,void 0]),[t,e])}},899:function(e,t,a){"use strict";var n=a(1427);a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b}))},900:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),o=a.n(n),r=a(19),s=a(41);const l=a.n(s)()(r.EuiText).withConfig({displayName:"CodeBlock",componentId:"sc-s548fn-0"})(["font-family:",";"],(e=>e.theme.eui.euiCodeFontFamily)),i=Object(n.memo)((({children:e,inline:t=!1,textColor:a="default",bold:n=!1})=>o.a.createElement(l,{size:"relative",color:a,className:t?"eui-displayInline":""},n?o.a.createElement("strong",null,e):e)));i.displayName="ConsoleCodeBlock"}}]);