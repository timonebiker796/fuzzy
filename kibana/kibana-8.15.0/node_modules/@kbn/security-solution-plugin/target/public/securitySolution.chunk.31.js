/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[31,4,15,16,17,28],Array(122).concat([function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(45),r=n(14);const i=Object(r.b)(),o=e=>{const t=s();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${i.join(", ")}`);return t[e]},s=()=>Object(a.useSelector)((({app:{enableExperimental:e}})=>e))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(44),i=n(128),o=n(91),s=n(118);const l=()=>{const e=Object(s.n)(),t=Object(a.useRef)(e.addError.bind(e)).current,n=Object(a.useRef)(e.addSuccess.bind(e)).current,r=Object(a.useRef)(e.addWarning.bind(e)).current,i=Object(a.useRef)(e.remove.bind(e)).current,o=Object(a.useCallback)(((e,n)=>{const a=c(e);return t(a,n)}),[t]);return Object(a.useMemo)((()=>({api:e,addError:o,addSuccess:n,addWarning:r,remove:i})),[o,n,r,i,e])},c=e=>null!=e&&Object(o.isEsError)(e)?u(e):Object(i.r)(e)?d(e):e instanceof Error?p(e):m(e),u=e=>{var t,n,a,r,i,o,s;const l=null!=e.err?e.err:e,c=null!=(null===(t=e.err)||void 0===t?void 0:t.statusCode)?`(${e.err.statusCode})`:null!=e.statusCode?`(${e.statusCode})`:"",u=f(l),d=new Error(`${null!==(n=null===(a=e.attributes)||void 0===a||null===(r=a.error)||void 0===r?void 0:r.reason)&&void 0!==n?n:e.message} ${c}`);return d.name=null!==(i=null===(o=e.attributes)||void 0===o||null===(s=o.error)||void 0===s?void 0:s.reason)&&void 0!==i?i:e.message,null!=u&&(d.stack=u),d},d=e=>{const t=Object(i.s)(e)?`(${e.body.statusCode})`:Object(i.u)(e)?`(${e.body.status_code})`:"",n=f(e),a=new Error(`${""!==String(e.body.message).trim()?e.body.message:e.message} ${t}`);return a.name=null!=e.name?e.name:"",null!=n&&(a.stack=n),a},p=e=>{const t=f(e),n=new Error(e.message);return n.name=e.name,null!=t&&(n.stack=t),n},m=e=>{const t=f(e),n=Object(r.isString)(e)?e:e instanceof Object&&null!=t?t:String(e),a=new Error(n);return a.name=n,null!=t&&(a.stack=t),a},f=e=>{try{return JSON.stringify(e,((e,t)=>{const n=g(t);return b(n)?void 0:n}),2)}catch(e){return}},g=e=>e instanceof Error?{...e,name:e.name,message:e.message,stack:e.stack}:e,b=e=>{if(!(e instanceof Object))return!1;try{return"{}"===JSON.stringify(e)}catch(e){return!1}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(45),r=n(188),i=n.n(r);const o=e=>Object(a.useSelector)(e,a.shallowEqual),s=e=>Object(a.useSelector)(e,i.a)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=e=>Object(a.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return g}));var a=n(44),r=n(2),i=n.n(r),o=n(41),s=n.n(o);const l=n(4).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),c=s.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorDarkShade));c.displayName="EmptyWrapper";const u=()=>"—",d=()=>`(${l})`,p=()=>i.a.createElement(c,null,u()),m=()=>i.a.createElement(c,null,d()),f=e=>null==e?p():Object(a.isString)(e)&&""===e?m():i.a.createElement(i.a.Fragment,null,e),g=e=>null==e?p():""===e?m():i.a.createElement(i.a.Fragment,null,e)},function(e,t,n){"use strict";n.r(t),n.d(t,"parseRoute",(function(){return y})),n.d(t,"manageOldSiemRoutes",(function(){return h})),n.d(t,"getInspectResponse",(function(){return v})),n.d(t,"isDetectionsPath",(function(){return E})),n.d(t,"isDashboardViewPath",(function(){return x})),n.d(t,"isTourPath",(function(){return j})),n.d(t,"isThreatIntelligencePath",(function(){return O})),n.d(t,"getSubPluginRoutesByCapabilities",(function(){return S})),n.d(t,"isSubPluginAvailable",(function(){return w})),n.d(t,"getFieldKey",(function(){return T})),n.d(t,"getField",(function(){return C})),n.d(t,"isTimelineScope",(function(){return M})),n.d(t,"isInTableScope",(function(){return _})),n.d(t,"isAlertsPageScope",(function(){return D})),n.d(t,"getScopedActions",(function(){return N})),n.d(t,"getScopedSelectors",(function(){return A})),n.d(t,"isActiveTimeline",(function(){return F})),n.d(t,"getSourcererScopeId",(function(){return P}));var a=n(748),r=n(44),i=n(2),o=n.n(i),s=n(48),l=n(1630),c=n(1799),u=n(7),d=n(5),p=n(528),m=n(156),f=n(129),g=n(149),b=n(127);const y=e=>{if(!Object(r.isEmpty)(e.hash)){var t;const n=e.hash.split("?"),a=n.length>=1?`?${n[1]}`:"",r=n.length>0?n[0].split("/"):[];return{pageName:r.length>=1?r[1]:"",path:`/${null!==(t=r.slice(2).join("/"))&&void 0!==t?t:""}${a}`,search:a}}const n=e.search,a=e.pathname.split("/");return{pageName:a[3],path:`${a.length>4?`/${a.slice(4).join("/")}`:""}${n}`,search:n}},h=async e=>{const{application:t}=e,{pageName:n,path:a}=y(window.location);switch(n){case m.a.overview:t.navigateToApp(d.m,{deepLinkId:m.a.overview,replace:!0,path:a});break;case"ml-hosts":t.navigateToApp(d.m,{deepLinkId:m.a.hosts,replace:!0,path:`/ml-hosts${a}`});break;case m.a.hosts:t.navigateToApp(d.m,{deepLinkId:m.a.hosts,replace:!0,path:a});break;case"ml-network":t.navigateToApp(d.m,{deepLinkId:m.a.network,replace:!0,path:`/ml-network${a}`});break;case m.a.network:t.navigateToApp(d.m,{deepLinkId:m.a.network,replace:!0,path:a});break;case m.a.timelines:t.navigateToApp(d.m,{deepLinkId:m.a.timelines,replace:!0,path:a});break;case m.a.case:case"case":t.navigateToApp(d.m,{deepLinkId:m.a.case,replace:!0,path:a});break;case m.a.detections:case m.a.alerts:t.navigateToApp(d.m,{deepLinkId:m.a.alerts,replace:!0,path:a});break;case m.a.rules:t.navigateToApp(d.m,{deepLinkId:m.a.rules,replace:!0,path:a});break;case m.a.exceptions:t.navigateToApp(d.m,{deepLinkId:m.a.exceptions,replace:!0,path:a});break;default:t.navigateToApp(d.m,{deepLinkId:m.a.landing,replace:!0,path:a})}},v=(e,t)=>({dsl:Object(u.isObject)(null==e?void 0:e.inspect)&&null!=e&&e.inspect.dsl?e.inspect.dsl:(null==t?void 0:t.dsl)||[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}),E=e=>!!Object(s.matchPath)(e,{path:`(${d.d}|${d.Cc}|${d.Db})`,strict:!1}),x=e=>null!=Object(s.matchPath)(e,{path:`${d.B}/:detailName`,exact:!1,strict:!1}),j=e=>(e=>!!Object(s.matchPath)(e,{path:`${d.d}`,strict:!1}))(e)||(e=>!!Object(s.matchPath)(e,{path:`${d.x}/:detailName`,strict:!1}))(e),O=e=>!!Object(s.matchPath)(e,{path:`(${d.Pc})`,strict:!1}),S=(e,t)=>Object.entries(e).reduce(((e,[n,a])=>{if(w(n,t.application.capabilities))e.push(...a.routes);else{const r=e=>e.siem.privileges;e.push(...a.routes.map((e=>({path:e.path,component:()=>{const e=t.upselling.getPageUpselling(n);return e?o.a.createElement(e,null):o.a.createElement(p.b,{pageName:n,docLinkSelector:r})}}))))}return e}),[]),w=(e,t)=>"cases"===e?!0===t[d.w].read_cases:!0===t[d.Lc].show,k={[a.y]:"signal.rule.id",[a.r]:"signal.rule.name",[`${a.t}.filters`]:"signal.rule.filters",[`${a.t}.language`]:"signal.rule.language",[`${a.t}.query`]:"signal.rule.query"},I={"signal.rule.id":a.y,"signal.rule.name":a.r,"signal.rule.filters":`${a.t}.filters`,"signal.rule.language":`${a.t}.language`,"signal.rule.query":`${a.t}.query`},T=(e,t)=>{var n,a;const i=(null!==(n=I[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),o=(null!==(a=k[t])&&void 0!==a?a:t).replace("kibana.alert","signal");return Object(r.has)(i,e)?i:o},C=(e,t)=>{var n,a,i;const o=(null!==(n=I[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),s=(null!==(a=k[t])&&void 0!==a?a:t).replace("kibana.alert","signal"),l=o.split(".");if(l.includes("parameters")&&"parameters"!==l[l.length-1]){const t=l.slice(0,l.length-1).join("."),n=Object(r.get)(t,e);return Object(r.get)(l[l.length-1],n)}return null!==(i=Object(r.get)(o,e))&&void 0!==i?i:Object(r.get)(s,e)},M=e=>Object.values(g.f).includes(e),_=e=>Object.values(l.b).includes(e),D=e=>[l.b.alertsOnAlertsPage,l.b.alertsOnRuleDetailsPage,l.b.alertsOnCasePage].includes(e),N=e=>M(e)?f.a:_(e)?c.a:void 0,A=e=>M(e)?f.a:_(e)?c.a:void 0,F=e=>e===g.f.active,P=e=>M(e)?b.SourcererScopeName.timeline:D(e)?b.SourcererScopeName.detections:b.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),r=n(45),i=n(166),o=n(127),s=n(531),l=n(294),c=n(252),u=n(308),d=n(1276),p=n(895);const m=(e=o.SourcererScopeName.default)=>{const t=Object(r.useSelector)(i.d.kibanaDataViews),n=Object(r.useSelector)(i.d.signalIndexName),m=Object(r.useSelector)(i.d.defaultDataView),f=Object(r.useSelector)((t=>i.d.sourcererScopeSelectedDataViewId(t,e))),g=Object(a.useMemo)((()=>t.find((e=>e.id===f))),[t,f]),b=Object(r.useSelector)((t=>i.d.sourcererScopeIsLoading(t,e))),y=Object(r.useSelector)((t=>i.d.sourcererScopeSelectedPatterns(t,e))),h=Object(r.useSelector)((t=>i.d.sourcererScopeMissingPatterns(t,e))),v=Object(a.useMemo)((()=>Object(u.b)(y)),[y]),[E,x]=Object(a.useState)([]),[j,O]=Object(c.b)(E),S=Object(a.useMemo)((()=>{var e,t,n,a,r,i,o;return{...O,dataView:O.dataView,runtimeMappings:null!==(e=null===(t=O.dataView)||void 0===t?void 0:t.runtimeFieldMap)&&void 0!==e?e:{},title:null!==(n=null===(a=O.dataView)||void 0===a?void 0:a.title)&&void 0!==n?n:"",id:null!==(r=null===(i=O.dataView)||void 0===i?void 0:i.id)&&void 0!==r?r:null,loading:j,patternList:O.indexes,indexFields:O.indexPatterns.fields,fields:null===(o=O.dataView)||void 0===o?void 0:o.fields}}),[O,j]);Object(a.useEffect)((()=>{null==g||h.length>0?x(v):x([])}),[h,g,v]);const w=Object(a.useMemo)((()=>{const e=null==g||h.length>0?S:g;return{...e,dataView:{...e.dataView,title:v.join(","),name:v.join(",")}}}),[S,h.length,g,v]),k=Object(a.useMemo)((()=>!(!b&&!w.loading)||Object(s.a)({scopeId:e,signalIndexName:n,patternList:w.patternList,isDefaultDataViewSelected:w.id===m.id})),[m.id,b,e,n,w.id,w.loading,w.patternList]),I=Object(a.useCallback)((()=>{const{browserFields:e}=Object(l.a)(w.patternList.join(","),w.fields);return e}),[w.fields,w.patternList]);return((e,t)=>{const n=Object(r.useSelector)(p.a),i=Object(a.useMemo)((()=>({...n,browserFields:t.browserFields,sourcererDataView:t.sourcererDataView})),[n,t.browserFields,t.sourcererDataView]);return Object(d.a)()?i:t})(0,Object(a.useMemo)((()=>({browserFields:I(),dataViewId:w.id,indexPattern:{fields:w.indexFields,title:v.join(","),getName:()=>v.join(",")},indicesExist:k,loading:b||w.loading,runtimeMappings:w.runtimeMappings,patternList:w.title.split(","),selectedPatterns:v,...E.length>0?{activePatterns:w.patternList}:{},sourcererDataView:w.dataView})),[I,w,v,k,b,E.length]))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(363),c=n(222),u=n(130),d=n(179),p=n(416);const m=({field:e,tooltipContent:t})=>null!=t?t:e,f=i.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:r,value:o})=>(e=>null===e)(n)?i.a.createElement(i.a.Fragment,null,e||o):i.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:r,content:m({tooltipContent:n,field:t})},i.a.createElement(i.a.Fragment,null,e||o))));f.displayName="Content";const g=i.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:o="",isAggregatable:s=!1,value:u,name:m,children:g,scopeId:b,tooltipContent:y,tooltipPosition:h,queryValue:v,truncate:E})=>{const x=Object(r.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(c.h)(t),name:m||(null!==(e=null==u?void 0:u.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:v||(null!=u?u:""),operator:d.d}}}),[a,t,m,v,u]),j=Object(r.useCallback)(((e,t,n)=>n.isDragging?i.a.createElement(l.a,null,i.a.createElement(p.a,{dataProvider:e})):i.a.createElement(f,{field:a,tooltipContent:y,tooltipPosition:h,value:u},g)),[g,a,y,h,u]);return null==u?null:i.a.createElement(l.b,{dataProvider:x,fieldType:o,isAggregatable:s,hideTopN:e,isDraggable:n,render:j,scopeId:b,truncate:E})}));g.displayName="DefaultDraggable";const b=s()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);b.displayName="Badge";const y=({contextId:e,eventId:t,field:n,value:a,iconType:r,isDraggable:o,isAggregatable:s,fieldType:l,name:c,color:d="hollow",children:p,scopeId:m,tooltipContent:f,queryValue:y})=>null!=a?i.a.createElement(g,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:o,isAggregatable:s,fieldType:l,field:n,name:c,value:a,scopeId:m,tooltipContent:f,queryValue:y},i.a.createElement(b,{iconType:r,color:d,title:""},p||(""!==a?a:Object(u.c)()))):null;y.displayName="DraggableBadgeComponent";const h=i.a.memo(y);h.displayName="DraggableBadge"},function(e,t,n){"use strict";n.d(t,"H",(function(){return o})),n.d(t,"I",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"kb",(function(){return c})),n.d(t,"eb",(function(){return u})),n.d(t,"fb",(function(){return d})),n.d(t,"jb",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"gb",(function(){return y})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return E})),n.d(t,"C",(function(){return x})),n.d(t,"E",(function(){return j})),n.d(t,"F",(function(){return O})),n.d(t,"D",(function(){return S})),n.d(t,"bb",(function(){return k})),n.d(t,"ab",(function(){return I})),n.d(t,"Z",(function(){return T})),n.d(t,"X",(function(){return M})),n.d(t,"W",(function(){return _})),n.d(t,"G",(function(){return D})),n.d(t,"V",(function(){return N})),n.d(t,"U",(function(){return A})),n.d(t,"S",(function(){return F})),n.d(t,"T",(function(){return P})),n.d(t,"O",(function(){return L})),n.d(t,"M",(function(){return q})),n.d(t,"L",(function(){return z})),n.d(t,"K",(function(){return B})),n.d(t,"N",(function(){return $})),n.d(t,"J",(function(){return V})),n.d(t,"Q",(function(){return U})),n.d(t,"P",(function(){return G})),n.d(t,"B",(function(){return H})),n.d(t,"z",(function(){return W})),n.d(t,"y",(function(){return Q})),n.d(t,"w",(function(){return Y})),n.d(t,"x",(function(){return K})),n.d(t,"A",(function(){return Z})),n.d(t,"v",(function(){return X})),n.d(t,"s",(function(){return J})),n.d(t,"r",(function(){return ee})),n.d(t,"t",(function(){return te})),n.d(t,"q",(function(){return ne})),n.d(t,"u",(function(){return ae})),n.d(t,"R",(function(){return re})),n.d(t,"p",(function(){return ie})),n.d(t,"o",(function(){return oe})),n.d(t,"n",(function(){return se})),n.d(t,"m",(function(){return le})),n.d(t,"l",(function(){return ce})),n.d(t,"k",(function(){return ue})),n.d(t,"j",(function(){return de})),n.d(t,"Y",(function(){return pe})),n.d(t,"lb",(function(){return me})),n.d(t,"f",(function(){return fe})),n.d(t,"e",(function(){return ge})),n.d(t,"ib",(function(){return be})),n.d(t,"hb",(function(){return ye})),n.d(t,"db",(function(){return ve})),n.d(t,"cb",(function(){return Ee}));var a=n(211),r=n(279);const i=`${a.a}Header`,o=`${a.a}AlertTitle`,s=`${a.a}EventTitle`,l=`${i}AlertSumaryPanel`,c=`${i}StatusTitle`,u=`${i}RiskScoreTitle`,d=`${i}RiskScoreValue`,p=`${i}ShareButton`,m=`${i}AssigneesHeader`,f=`${i}AssigneesTitle`,g=`${i}AssigneesAddButton`,b=`${a.a}AboutSection`,y=(r.c,r.a,`${a.a}RuleSummaryButton`),h=`${a.a}AlertDescription`,v=`${h}Title`,E=`${h}Details`,x=`${a.a}EventCategoryDescription`,j=`${a.a}EventKindDescription`,O=`${j}Text`,S=`${j}Categories`,w=`${a.a}Reason`,k=`${w}Title`,I=`${w}Details`,T=`${w}PreviewButton`,C=`${a.a}MitreAttack`,M=`${C}Title`,_=`${C}Details`,D=`${a.a}EventRenderer`,N=`${a.a}InvestigationSection`,A=(r.c,r.a,`${a.a}InvestigationGuide`),F=`${A}Button`,P=`${A}Loading`,R=`${a.a}HighlightedFields`,L=`${R}Title`,q=`${R}Details`,z=`${R}Cell`,B=`${R}BasicCell`,$=`${R}LinkedCell`,V=`${R}AgentStatusCell`,U=`${a.a}Insights`,G=(r.c,r.a,`${a.a}InsightsEntities`),H=`${G}UserOverview`,W=`${H}Loading`,Q=`${H}Link`,Y=`${H}Domain`,K=`${H}LastSeen`,Z=`${H}RiskLevel`,X=`${G}HostOverview`,J=`${X}Loading`,ee=`${X}Link`,te=`${X}OsFamily`,ne=`${X}LastSeen`,ae=`${X}RiskLevel`,re=`${a.a}InsightsThreatIntelligence`,ie=`${a.a}Correlations`,oe=`${ie}SuppressedAlerts`,se=`${oe}TechnicalPreview`,le=`${ie}RelatedCases`,ce=`${ie}RelatedAlertsBySession`,ue=`${ie}RelatedAlertsBySameSourceEvent`,de=`${ie}RelatedAlertsByAncestry`,pe=`${a.a}InsightsPrevalence`,me=`${a.a}Visualizations`,fe=(r.c,r.a,`${a.a}AnalyzerPreview`),ge=`${fe}Loading`,be=`${a.a}SessionPreview`,ye=`${be}RuleDetailsLink`,he=`${a.a}Response`,ve=`${he}Section`,Ee=(r.c,r.a,`${he}Button`)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(739);const i=()=>Object(a.useContext)(r.a)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));const a=(e,t)=>"string"==typeof e?e:Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?e[0]:null!=t?t:null,r=e=>"string"==typeof e?[e]:Array.isArray(e)&&e.length>0?e:[]},,function(e,t,n){"use strict";n.d(t,"g",(function(){return x.d})),n.d(t,"f",(function(){return x.c})),n.d(t,"o",(function(){return k})),n.d(t,"m",(function(){return C})),n.d(t,"d",(function(){return _})),n.d(t,"h",(function(){return F})),n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return L})),n.d(t,"i",(function(){return q})),n.d(t,"e",(function(){return z})),n.d(t,"b",(function(){return B})),n.d(t,"j",(function(){return H})),n.d(t,"n",(function(){return W})),n.d(t,"l",(function(){return Q})),n.d(t,"k",(function(){return Y}));var a=n(19),r=n(2),i=n.n(r),o=n(44),s=n(305),l=n(170),c=n(256),u=n(5),d=n(433),p=n(194),m=n(409),f=n(118),g=n(356),b=n(4),y=n(378);const h=e=>b.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var v=n(156),E=n(560),x=n(312),j=n(119),O=n.n(j),S=n(454),w=n(529);const k=()=>{const e=Object(S.e)(),t=Object(w.a)();return Object(r.useCallback)((({deepLinkId:n,path:a,onClick:r})=>{const i=t(n);return e({id:n,path:a,urlState:i,onClick:r})}),[e,t])},I=e=>(e=>i.a.memo((function({deepLinkId:t,...n}){const a=Object(w.a)()(t);return i.a.createElement(e,O()({id:t,urlState:a},n))})))(Object(S.g)(e)),T=({children:e,Component:t,userName:n,isButton:a,onClick:o,title:s,userTab:l})=>{const c=encodeURIComponent(n),{formatUrl:d,search:m}=Object(p.l)(v.a.users),{application:{navigateToApp:g},telemetry:b}=Object(f.j)().services,y=Object(r.useCallback)((e=>{e.preventDefault(),g(u.m,{deepLinkId:v.a.users,path:l?Object(E.a)(c,l,m):Object(E.c)(c,m)})}),[c,g,m,l]),h=Object(r.useMemo)((()=>d(l?Object(E.a)(c,l):Object(E.c)(c))),[d,c,l]),j=Object(r.useCallback)((e=>{b.reportEntityDetailsClicked({entity:"user"}),(null!=o?o:y)(e)}),[y,o,b]);return a?i.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-user-details",href:h,onClick:j,title:null!=s?s:n},e||n):i.a.createElement(x.c,{"data-test-subj":"users-link-anchor",onClick:j,href:h},e||n)},C=i.a.memo(T),M=({children:e,Component:t,hostName:n,isButton:a,onClick:o,title:s,hostTab:l})=>{const{formatUrl:c,search:d}=Object(p.l)(v.a.hosts),{application:{navigateToApp:m},telemetry:g}=Object(f.j)().services,b=encodeURIComponent(n),y=Object(r.useCallback)((e=>{e.preventDefault(),m(u.m,{deepLinkId:v.a.hosts,path:l?Object(p.i)(b,l,d):Object(p.d)(b,d)})}),[b,m,d,l]),h=Object(r.useMemo)((()=>c(l?Object(p.i)(b,l):Object(p.d)(b))),[c,b,l]),E=Object(r.useCallback)((e=>{g.reportEntityDetailsClicked({entity:"host"}),(null!=o?o:y)(e)}),[y,o,g]);return a?i.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-host-details",href:h,iconType:"expand",onClick:E,title:null!=s?s:n},e):i.a.createElement(x.c,{onClick:E,href:h,"data-test-subj":"host-details-button"},e||n)},_=i.a.memo(M),D=["http://","https://"],N=i.a.memo((({url:e,children:t,idx:n,overflowIndexStart:r=5,allItemsLimit:s=5})=>{const l=r-1,c=s-1,u=Math.max(0,Math.min(l,c)),d=D.some((t=>0===e.indexOf(t)));return e&&d&&!Object(g.c)(e)&&t?i.a.createElement(a.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(o.isNil)(n)&&n<u&&i.a.createElement(x.a,{"data-test-subj":"externalLinkComma"}))):null}));N.displayName="ExternalLink";const A=({Component:e,children:t,ip:n,flowTarget:a=m.a.source,isButton:s,onClick:l,title:c})=>{const u=k(),f=Object(r.useCallback)(((n,r)=>{const{onClick:o,href:m}=u({deepLinkId:v.a.network,path:Object(p.f)(encodeURIComponent(Object(d.c)(n)),a)}),f=null!=l?l:e=>o(e);return s?i.a.createElement(x.b,{Component:e,key:`${n}-${r}`,dataTestSubj:"data-grid-network-details",onClick:f,href:m,title:null!=c?c:n},t):i.a.createElement(x.c,{key:`${n}-${r}`,onClick:f,href:m,"data-test-subj":"network-details"},t||n)}),[t,e,a,u,l,s,c]);return Object(o.isArray)(n)?i.a.createElement(i.a.Fragment,null,n.map(f)):f(n,0)},F=i.a.memo(A),P=({index:e,children:t,detailName:n,title:a})=>{const{formatUrl:o,search:d}=Object(p.l)(v.a.case),{navigateToApp:m}=Object(f.j)().services.application,{activeStep:g,isTourShown:b}=Object(c.b)(),y=Object(r.useMemo)((()=>g===l.a.viewCase&&b(l.b.alertsCases)&&0===e),[g,e,b]),E=Object(r.useCallback)((async e=>(e&&e.preventDefault(),m(u.m,{deepLinkId:v.a.case,path:Object(p.a)({id:n,search:d})}))),[n,m,d]);return Object(r.useEffect)((()=>{var e;y&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[y]),i.a.createElement(s.a,{onClick:E,isTourAnchor:y,step:l.a.viewCase,tourId:l.b.alertsCases},i.a.createElement(x.c,{onClick:E,href:o(Object(p.a)({id:n})),"data-test-subj":"case-details-link","aria-label":h(null!=a?a:n)},t||n))},R=i.a.memo(P);R.displayName="CaseDetailsLink",i.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(p.l)(v.a.case),{navigateToApp:a}=Object(f.j)().services.application,o=Object(r.useCallback)((async e=>(e.preventDefault(),a(u.m,{deepLinkId:v.a.case,path:Object(p.b)(n)}))),[a,n]);return i.a.createElement(x.c,{onClick:o,href:t(Object(p.b)())},e)})).displayName="CreateCaseLink";const L=i.a.memo((({children:e,link:t})=>{const n=Object(r.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return i.a.createElement(N,{url:n},e||t)}));L.displayName="GoogleLink";const q=i.a.memo((({Component:e,title:t,children:n,portOrServiceName:o})=>{var s;const l=Object(r.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(o))}`),[o]);return e?i.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(s=null!=t?t:n)&&void 0!==s?s:o):i.a.createElement(x.e,null,i.a.createElement(a.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||o))}));q.displayName="PortOrServiceNameLink";const z=i.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(r.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return i.a.createElement(a.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));z.displayName="Ja3FingerprintLink";const B=i.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(r.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return i.a.createElement(a.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));B.displayName="CertificateFingerprintLink";var $=function(e){return e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com",e}($||{});function V(e){return e===$["virustotal.com"]||e===$["talosIntelligence.com"]}const U={[$["virustotal.com"]]:y.m,[$["talosIntelligence.com"]]:y.l},G=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:s,direction:l="row"})=>{const[c]=Object(f.o)(u.Pb),d=Object(r.useMemo)((()=>null==c?void 0:c.slice(0,t).filter((({url_template:e,name:t})=>!Object(o.isNil)(e)&&!Object(o.isNil)(t)&&!Object(g.c)(e))).map((({name:e,url_template:t})=>({name:V(e)?U[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(s))})))),[c,s,U,t]),p=Object(r.useCallback)((n=>{var a;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&i.a.createElement(N,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},i.a.createElement(i.a.Fragment,null,null!==(a=n.name)&&void 0!==a?a:s))}),[t,s,e]);return(null==d?void 0:d.length)>0?i.a.createElement("section",null,i.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:l,alignItems:"center","data-test-subj":"reputationLinkGroup"},i.a.createElement(a.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:a},r)=>i.a.createElement(N,{allItemsLimit:d.length,idx:r,overflowIndexStart:e,url:a,"data-test-subj":"externalLinkComponent",key:`reputationLink-${r}`},i.a.createElement(i.a.Fragment,null,n?s:null!=t?t:s))))),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(x.f,{rowItems:d,render:p,moreMaxHeight:"200px",overflowIndexStart:e})))):null};G.displayName="ReputationLinkComponent";const H=i.a.memo(G),W=i.a.memo((({children:e,domain:t})=>{const n=Object(r.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return i.a.createElement(N,{url:n},e||t)}));W.displayName="WhoIsLink";const Q=I(x.d),Y=I(x.c)},function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l}));const a="document-details-right",r="document-details-left",i="document-details-preview",o="document-details-isolate-host",s="document-details-alert-reason",l="document-details-rule-overview"},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return m}));var a=n(19),r=n(44),i=n(41),o=n.n(i);const s="details",l=o.a.div.attrs((()=>({className:s}))).withConfig({displayName:"Details",componentId:"sc-1ucey7j-0"})(["margin:5px 0 5px 10px;& .euiBadge{margin:2px 0 2px 0;}& .euiFlexGroup{justify-content:center;}"]);l.displayName="Details";const c=o()(a.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1ucey7j-1"})(["margin-left:3px;"]);function u(e){return Object(r.isNumber)(e)?!isFinite(e):Object(r.isEmpty)(e)}c.displayName="TokensFlexItem";const d=({eventCategory:e,eventDataset:t})=>"file"===(null==e?void 0:e.toLowerCase())||"file"===(null==t?void 0:t.toLowerCase())||"endpoint.events.file"===(null==t?void 0:t.toLowerCase()),p=e=>["process_stopped","termination_event"].includes(`${e}`.toLowerCase()),m=e=>["created","creation","deleted","deletion","file_create_event","file_delete_event","files-encrypted","load","modification","overwrite","rename"].includes(`${e}`.toLowerCase())},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(73),r=n.n(a),i=n(2),o=n.n(i),s=n(42),l=n(118),c=n(130),u=n(754),d=n(1270);const p=o.a.memo((({value:e,dateFormat:t=Object(l.h)()})=>o.a.createElement(o.a.Fragment,null,r.a.tz(e,Object(l.m)()).format(t))));p.displayName="PreferenceFormattedDate";const m=({value:e})=>{if(null==e)return Object(c.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(c.f)(e);const n=t.toDate();return o.a.createElement(p,{value:n})};m.displayName="PreferenceFormattedDateFromPrimitive";const f=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,g=o.a.memo((({value:e})=>{const[t]=Object(l.o)("dateFormat:scaled"),n=Array.isArray(t)?t.find(f):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return o.a.createElement(p,{dateFormat:a,value:e})}));g.displayName="PreferenceFormattedP1DTDate";const b=o.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a,tooltipProps:r})=>{if(null==e)return Object(c.f)(e);const i=Object(d.a)(e);return i.isValid()?o.a.createElement(u.a,{date:i.toDate(),fieldName:t,className:n,tooltipProps:r},o.a.createElement(p,{value:i.toDate(),dateFormat:a})):Object(c.f)(e)}));b.displayName="FormattedDate";const y=o.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:i=1})=>{if(null==e)return Object(c.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(c.f)(e);const m=l.toDate(),f=r()(m).add(i,"hours").isBefore(new Date);return o.a.createElement(u.a,{date:m,fieldName:n,className:a},f?o.a.createElement(p,{"data-test-subj":"preference-time",value:m,dateFormat:t}):o.a.createElement(s.FormattedRelative,{"data-test-subj":"relative-time",value:m}))}));y.displayName="FormattedRelativePreferenceDate"},function(e,t,n){"use strict";e.exports=n(722)},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"L",(function(){return i})),n.d(t,"x",(function(){return s})),n.d(t,"I",(function(){return l})),n.d(t,"D",(function(){return c})),n.d(t,"A",(function(){return u})),n.d(t,"H",(function(){return d})),n.d(t,"B",(function(){return p})),n.d(t,"F",(function(){return m})),n.d(t,"y",(function(){return f})),n.d(t,"z",(function(){return g})),n.d(t,"C",(function(){return b})),n.d(t,"G",(function(){return y})),n.d(t,"E",(function(){return h})),n.d(t,"n",(function(){return v})),n.d(t,"Q",(function(){return E})),n.d(t,"P",(function(){return x})),n.d(t,"O",(function(){return j})),n.d(t,"q",(function(){return O})),n.d(t,"p",(function(){return S})),n.d(t,"o",(function(){return w})),n.d(t,"N",(function(){return k})),n.d(t,"l",(function(){return I})),n.d(t,"f",(function(){return T})),n.d(t,"h",(function(){return C})),n.d(t,"g",(function(){return M})),n.d(t,"j",(function(){return _})),n.d(t,"i",(function(){return D})),n.d(t,"k",(function(){return N})),n.d(t,"M",(function(){return A})),n.d(t,"J",(function(){return P})),n.d(t,"K",(function(){return R})),n.d(t,"s",(function(){return L})),n.d(t,"r",(function(){return q})),n.d(t,"u",(function(){return z})),n.d(t,"t",(function(){return B})),n.d(t,"b",(function(){return $})),n.d(t,"c",(function(){return V})),n.d(t,"a",(function(){return U})),n.d(t,"v",(function(){return G})),n.d(t,"m",(function(){return H})),n.d(t,"e",(function(){return W})),n.d(t,"w",(function(){return Q}));var a=n(211);const r=`${a.a}AnalyzerGraph`,i=`${a.a}SessionView`,o=`${a.a}PrevalenceDetails`,s=`${o}DatePicker`,l=`${o}Upsell`,c=`${o}Table`,u=`${c}FieldCell`,d=`${c}ValueCell`,p=`${c}HostCell`,m=`${c}UserCell`,f=`${c}AlertCountCell`,g=`${c}DocCountCell`,b=`${c}HostPrevalenceCell`,y=`${c}UserPrevalenceCell`,h=`${c}UpsellCell`,v=`${a.a}EntitiesDetails`,E=`${a.a}UsersDetails`,x=`${E}RelatedHostsTable`,j=`${E}RelatedHostsLink`,O=`${a.a}HostsDetails`,S=`${O}RelatedUsersTable`,w=`${O}RelatedUsersLink`,k=`${a.a}ThreatIntelligenceDetailsLoading`,I=`${a.a}CorrelationsDetails`,T=`${I}AlertsByAncestrySection`,C=`${I}AlertsBySourceSection`,M=`${I}AlertsBySessionSection`,_=`${I}CasesSection`,D=`${_}Table`,N=`${I}SuppressedAlertsSection`,A=`${I}SuppressedAlertsSectionTechnicalPreview`,F=`${a.a}Response`,P=`${F}Details`,R=`${F}NoData`,L=`${a.a}InvestigationGuide`,q=`${L}Loading`,z=`${a.a}NotesLoading`,B=`${a.a}NotesComment`,$=`${a.a}AddNotesLoading`,V=`${a.a}AddNotesMarkdown`,U=`${a.a}AddNotesButton`,G=`${a.a}NoteAvatar`,H=`${a.a}DeleteNotesButton`,W=`${a.a}AttachToTimelineCheckbox`,Q=`${a.a}OpenTimelineButton`},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=n(34).__importDefault(n(993));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},,function(e,t,n){"use strict";var a=n(5);n.d(t,"a",(function(){return a.Oc}))},function(e,t,n){"use strict";var a=n(51);n.d(t,"l",(function(){return a.getUseField})),n.d(t,"k",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"g",(function(){return a.UseField})),n.d(t,"h",(function(){return a.UseMultiFields})),n.d(t,"f",(function(){return a.UseArray})),n.d(t,"m",(function(){return a.useForm})),n.d(t,"n",(function(){return a.useFormContext})),n.d(t,"o",(function(){return a.useFormData})),n.d(t,"i",(function(){return a.VALIDATION_TYPES}));var r=n(62);n.d(t,"b",(function(){return r.Field})),n.d(t,"e",(function(){return r.SelectField})),n.d(t,"d",(function(){return r.HiddenField}));var i=n(77);n.d(t,"j",(function(){return i.fieldValidators}))},,function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"y",(function(){return m})),n.d(t,"p",(function(){return f})),n.d(t,"v",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"k",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return E})),n.d(t,"e",(function(){return x})),n.d(t,"q",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"n",(function(){return S})),n.d(t,"i",(function(){return w})),n.d(t,"l",(function(){return k})),n.d(t,"a",(function(){return I})),n.d(t,"o",(function(){return T})),n.d(t,"c",(function(){return C})),n.d(t,"m",(function(){return M})),n.d(t,"x",(function(){return _})),n.d(t,"w",(function(){return D})),n.d(t,"r",(function(){return N})),n.d(t,"s",(function(){return A})),n.d(t,"t",(function(){return F})),n.d(t,"u",(function(){return P}));var a=n(23),r=n(69),i=n(67),o=n(811),s=n(232),l=n(5),c=n(440),u=n(501),d=n(118);n(178);const p=async({rule:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),m=async({rule:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({rule:e,signal:t})=>d.b.get().http.fetch(l.pb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:a})=>{const r=Object(o.a)(e),i={page:n.page,per_page:n.perPage,sort_field:t.field,sort_order:t.order,...""!==r?{filter:r}:{}};return d.b.get().http.fetch(l.rb,{method:"GET",version:"2023-10-31",query:i,signal:a})},y=async({id:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),h=async({ids:e,signal:t})=>{var n;return null===(n=(await d.b.get().http.fetch(a.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===n?void 0:n.reduce(((e,{id:t,...n})=>{var a,r;return e[t]={muteAll:null!==(a=n.mute_all)&&void 0!==a&&a,activeSnoozes:null!==(r=n.active_snoozes)&&void 0!==r?r:[],isSnoozedUntil:n.is_snoozed_until?new Date(n.is_snoozed_until):void 0,snoozeSchedule:n.snooze_schedule},e}),{})},v=e=>d.b.get().http.fetch(`${r.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),E=async({filter:e,signal:t})=>d.b.get().http.fetch(s.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),x=e=>d.b.get().http.fetch(`${r.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function j({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===s.b.edit?e.editPayload:void 0,duplicate:e.type===s.b.duplicate?e.duplicatePayload:void 0,run:e.type===s.b.run?e.runPayload:void 0};return d.b.get().http.fetch(l.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(n),query:{dry_run:t}})}async function O(e){const t={action:s.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(l.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const S=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,overwriteActionConnectors:a=!1,signal:r})=>{const i=new FormData;return i.append("file",e),d.b.get().http.fetch(`${l.qb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n,overwrite_action_connectors:a},body:i,signal:r})},w=async({signal:e})=>d.b.get().http.fetch(s.g,{method:"GET",version:"1",signal:e}),k=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(u.a,{method:"GET",version:"1",query:n,signal:t})},I=async({ruleId:e,items:t,signal:n})=>d.b.get().http.fetch(`${l.qb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:n}),T=({packageName:e,packageVersion:t,prerelease:n=!1,force:a=!0})=>d.b.get().http.post(i.epmRouteService.getInstallPath(e,t),{query:{prerelease:n},version:"2023-10-31",body:JSON.stringify({force:a})}),C=({packages:e,prerelease:t=!1})=>d.b.get().http.post(i.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),M=async({signal:e})=>d.b.get().http.fetch(c.a,{method:"GET",version:"1",signal:e}),_=async({signal:e})=>d.b.get().http.fetch(c.f,{method:"POST",version:"1",signal:e}),D=async({signal:e})=>d.b.get().http.fetch(c.e,{method:"POST",version:"1",signal:e}),N=async()=>d.b.get().http.fetch(c.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),A=async e=>d.b.get().http.fetch(c.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),F=async()=>d.b.get().http.fetch(c.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),P=async e=>d.b.get().http.fetch(c.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(44),r=n(2),i=n(45),o=n(138),s=n(124),l=n(148),c=n(200);const u=()=>{const e=Object(i.useDispatch)(),{from:t,to:n}=Object(s.a)((e=>Object(a.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[u,d]=Object(r.useState)(!0),p=Object(r.useRef)([]),m=Object(r.useCallback)((({id:t,inspect:n,loading:a,refetch:r,searchSessionId:i})=>{p.current=[...p.current,t],e(c.c.setQuery({inputId:o.a.global,id:t,inspect:n,loading:a,refetch:r,searchSessionId:i}))}),[e]),f=Object(r.useCallback)((({id:t})=>e(c.c.deleteOneQuery({inputId:o.a.global,id:t}))),[e]);return Object(r.useEffect)((()=>{d(!1)}),[]),Object(r.useEffect)((()=>()=>{p.current.length>0&&p.current.forEach((e=>f({id:e})))}),[f]),Object(r.useMemo)((()=>({isInitializing:u,from:t,to:n,setQuery:m,deleteQuery:f})),[f,t,u,m,n])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"p",(function(){return b})),n.d(t,"y",(function(){return y})),n.d(t,"A",(function(){return h})),n.d(t,"B",(function(){return v})),n.d(t,"C",(function(){return E})),n.d(t,"D",(function(){return x})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return w})),n.d(t,"E",(function(){return k})),n.d(t,"F",(function(){return I})),n.d(t,"G",(function(){return T})),n.d(t,"I",(function(){return C})),n.d(t,"J",(function(){return M})),n.d(t,"K",(function(){return _})),n.d(t,"L",(function(){return D})),n.d(t,"X",(function(){return N})),n.d(t,"Y",(function(){return A})),n.d(t,"Z",(function(){return F})),n.d(t,"ab",(function(){return P})),n.d(t,"z",(function(){return R})),n.d(t,"bb",(function(){return L})),n.d(t,"cb",(function(){return q})),n.d(t,"M",(function(){return z})),n.d(t,"N",(function(){return B})),n.d(t,"P",(function(){return $})),n.d(t,"S",(function(){return V})),n.d(t,"T",(function(){return U})),n.d(t,"Q",(function(){return G})),n.d(t,"R",(function(){return H})),n.d(t,"W",(function(){return W})),n.d(t,"V",(function(){return Q})),n.d(t,"s",(function(){return Y})),n.d(t,"r",(function(){return K})),n.d(t,"w",(function(){return Z})),n.d(t,"O",(function(){return X})),n.d(t,"x",(function(){return J})),n.d(t,"H",(function(){return ee})),n.d(t,"U",(function(){return te})),n.d(t,"t",(function(){return ne})),n.d(t,"v",(function(){return ae})),n.d(t,"u",(function(){return re}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),i=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),w=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),I=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),T=(a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timeline…"}),a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"})),C=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),M=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),P=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),L=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),q=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),z=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),B=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),$=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),V=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),G=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),Q=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),Z=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),ee=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),te=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ne=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ae=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Import…"}),re=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},function(e,t,n){const a=n(347),{MAX_LENGTH:r,MAX_SAFE_INTEGER:i}=n(348),{safeRe:o,t:s}=n(311),l=n(431),{compareIdentifiers:c}=n(558);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>r)throw new TypeError(`version is longer than ${r} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],r=e.prerelease[t];if(a("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return c(n,r)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],r=e.build[t];if(a("build compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return c(n,r)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===n&&(a=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"p",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"l",(function(){return E}));var a=n(7),r=n(20);const i=e=>{if(null!=e){const t=e.trim().split(/[ \t\r\n]+/);return"sequence"===t[0]&&"where"!==t[1]}return!1},o=e=>"eql"===e,s=e=>"threshold"===e,l=e=>"query"===e||"saved_query"===e,c=e=>"threat_match"===e,u=e=>"machine_learning"===e,d=e=>"new_terms"===e,p=e=>"esql"===e,m=e=>Array.isArray(e)?e:Object(a.isEmpty)(e)?[]:[e],f=e=>{var t;return null!==(t=null==e?void 0:e.trim().startsWith("sequence"))&&void 0!==t&&t},g=e=>Array.isArray(e)?e:[e],b=e=>r.e.includes(e),y=e=>b(e),h=e=>!s(e)&&b(e),v=e=>!s(e)&&b(e),E=e=>b(e)&&r.f.includes(e)},,function(e,t,n){"use strict";n.d(t,"D",(function(){return i})),n.d(t,"E",(function(){return o})),n.d(t,"F",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"s",(function(){return u})),n.d(t,"r",(function(){return d})),n.d(t,"v",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"x",(function(){return f})),n.d(t,"z",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"t",(function(){return y})),n.d(t,"B",(function(){return h})),n.d(t,"q",(function(){return v})),n.d(t,"u",(function(){return E})),n.d(t,"A",(function(){return x})),n.d(t,"p",(function(){return j})),n.d(t,"o",(function(){return O})),n.d(t,"C",(function(){return S})),n.d(t,"y",(function(){return w})),n.d(t,"e",(function(){return k})),n.d(t,"c",(function(){return I})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return C})),n.d(t,"d",(function(){return M})),n.d(t,"f",(function(){return _})),n.d(t,"j",(function(){return D})),n.d(t,"i",(function(){return N})),n.d(t,"k",(function(){return A})),n.d(t,"l",(function(){return F})),n.d(t,"n",(function(){return P})),n.d(t,"m",(function(){return R}));var a=n(67),r=n(203);const i="logs-endpoint.events.*",o="metrics-endpoint.metadata_current_*",s="endpoint.metadata_current-default",l=".metrics-endpoint.metadata_united_default",c=(Object(a.getFileMetadataIndexName)("endpoint"),Object(a.getFileDataIndexName)("endpoint"),"/api/endpoint"),u=`${c}/metadata`,d=`${u}/{id}`,p=`${c}/metadata/transforms`,m=`${c}/policy_response`,f=`${c}/protection_updates_note/{package_policy_id}`,g=`${c}/suggestions/{suggestion_type}`,b=`${c}/action`,y=`${b}/isolate`,h=`${b}/unisolate`,v=`${b}/running_procs`,E=`${b}/kill_process`,x=`${b}/suspend_process`,j=`${b}/get_file`,O=`${b}/execute`,S=`${b}/upload`,w=`${b}/scan`,k=`${c}/action_status`,I=`${b}/{action_id}`,T=`${b}/{action_id}/file/{file_id}`,C=`${b}/{action_id}/file/{file_id}/download`,M=`${b}/state`,_=`/internal${c}/agent_status`,D=r.b.ENROLLED_AT,N="desc",A={ES_CONNECTION_ERROR:-272,OUTPUT_SERVER_ERROR:-273},F="endpointFields",P="endpointSearchStrategy",R="endpointPackagePoliciesStatsStrategy"},function(e,t,n){"use strict";n.d(t,"z",(function(){return r})),n.d(t,"w",(function(){return i})),n.d(t,"x",(function(){return o})),n.d(t,"y",(function(){return s})),n.d(t,"v",(function(){return c})),n.d(t,"u",(function(){return u})),n.d(t,"s",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"t",(function(){return m})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"n",(function(){return E})),n.d(t,"o",(function(){return x})),n.d(t,"m",(function(){return j})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"i",(function(){return k})),n.d(t,"j",(function(){return I})),n.d(t,"h",(function(){return T})),n.d(t,"c",(function(){return C})),n.d(t,"d",(function(){return M})),n.d(t,"b",(function(){return _}));var a=n(82);const r="/api/lists",i=`${r}/index`,o=`${r}/items`,s=`${r}/privileges`,l="/internal/lists",c=`${l}/_find_lists_by_size`,u=`${l}/_create_filter`,d="/api/exception_lists",p="/api/exception_lists/items",m=`/internal${d}/_create`,f="exception-list-agnostic",g="exception-list",b="/api/endpoint_list",y="endpoint_list",h=Object(a.deepFreeze)({trustedApps:{id:"endpoint_trusted_apps",name:"Endpoint Security Trusted Apps List",description:"Endpoint Security Trusted Apps List"},eventFilters:{id:"endpoint_event_filters",name:"Endpoint Security Event Filters List",description:"Endpoint Security Event Filters List"},hostIsolationExceptions:{id:"endpoint_host_isolation_exceptions",name:"Endpoint Security Host isolation exceptions List",description:"Endpoint Security Host isolation exceptions List"},blocklists:{id:"endpoint_blocklists",name:"Endpoint Security Blocklists List",description:"Endpoint Security Blocklists List"}}),v=Object.freeze(Object.values(h).map((({id:e})=>e))),E=h.trustedApps.id,x=h.trustedApps.name,j=h.trustedApps.description,O=h.eventFilters.id,S=h.eventFilters.name,w=h.eventFilters.description,k=h.hostIsolationExceptions.id,I=h.hostIsolationExceptions.name,T=h.hostIsolationExceptions.description,C=h.blocklists.id,M=h.blocklists.name,_=h.blocklists.description},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p}));var a=n(4);let r=function(e){return e.rules="rules",e.alertsCases="alertsCases",e}({}),i=function(e){return e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase",e}({});const o={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},s=(e,t)=>`tourStepAnchor-${t}-${e}`,l={[r.alertsCases]:[i.pointToAlertName,i.expandEvent]},c={[r.alertsCases]:[i.pointToAlertName,i.expandEvent,i.reviewAlertDetailsFlyout,i.addAlertToCase,i.viewCase]},u=[{...o,step:i.pointToAlertName,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:s(i.pointToAlertName,r.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...o,step:i.expandEvent,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:s(i.expandEvent,r.alertsCases)},{...o,step:i.reviewAlertDetailsFlyout,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${s(i.reviewAlertDetailsFlyout,r.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:s(i.reviewAlertDetailsFlyout,r.alertsCases)},{...o,step:i.addAlertToCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:s(i.addAlertToCase,r.alertsCases)},{...o,step:i.createCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:s(i.createCase,r.alertsCases),offset:20,repositionOnScroll:!1},{...o,step:i.submitCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:s(i.submitCase,r.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...o,step:i.viewCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:s(i.viewCase,r.alertsCases)}],d={title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},p={[r.rules]:[],[r.alertsCases]:u}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},,function(e,t,n){"use strict";n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return f}));var a=n(119),r=n.n(a),i=n(360),o=n(2),s=n.n(o),l=n(236);n.d(t,"d",(function(){return l.e})),n.d(t,"b",(function(){return l.d}));var c=n(127),u=n(814),d=n(904),p=n(475);n.d(t,"a",(function(){return p.b}));const m=i.c,f=({sourcererScopeId:e=c.SourcererScopeName.default,data:t,metadata:n,children:a,...l})=>{const p=Object(u.a)(e),m=Object(d.a)(e),f=JSON.stringify(t),g=Object(o.useMemo)((()=>(Array.isArray(t)?t:[t]).map((({field:e,value:t})=>({field:p(e),value:t}))).filter((e=>!!e.field))),[f,p]),b=Object(o.useMemo)((()=>({...n,dataViewId:m})),[m,n]);return g.length>0?s.a.createElement(i.a,r()({data:g,metadata:b},l),a):s.a.createElement(s.a.Fragment,null,a)}},function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return m}));const a=["failed","pending","successful"],r=["automated","manual"],i=["endpoint","sentinel_one","crowdstrike"],o=["isolate","unisolate","kill-process","suspend-process","running-processes","get-file","execute","upload","scan"],s=["isolate"],l=(Object.freeze({isolate:"writeHostIsolation",release:"writeHostIsolationRelease","kill-process":"writeProcessOperations","suspend-process":"writeProcessOperations",processes:"writeProcessOperations","get-file":"writeFileOperations",execute:"writeExecuteOperations",upload:"writeFileOperations",scan:"writeScanOperations"}),Object.freeze({isolate:"isolate",unisolate:"release",execute:"execute","get-file":"get-file","running-processes":"processes","kill-process":"kill-process","suspend-process":"suspend-process",upload:"upload",scan:"scan"})),c=Object.freeze({isolate:"isolate",release:"unisolate",execute:"execute","get-file":"get-file",processes:"running-processes","kill-process":"kill-process","suspend-process":"suspend-process",upload:"upload",scan:"scan"}),u=Object.freeze({isolate:"isolation",release:"isolation",execute:"execute","get-file":"get_file",processes:"running_processes","kill-process":"kill_process","suspend-process":"suspend_process",upload:"upload_file",scan:"scan"}),d=Object.freeze({isolate:"canIsolateHost",release:"canUnIsolateHost",execute:"canWriteExecuteOperations","get-file":"canWriteFileOperations",upload:"canWriteFileOperations",processes:"canGetRunningProcesses","kill-process":"canKillProcess","suspend-process":"canSuspendProcess",scan:"canWriteScanOperations"}),p=Object.freeze({endpoint:"elastic",sentinel_one:"Elastic@123",crowdstrike:"tbd.."}),m=Object.freeze({endpoint:"agent.id",sentinel_one:"observer.serial_number",crowdstrike:"device.id"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return Qe})),n.d(t,"c",(function(){return Ye})),n.d(t,"f",(function(){return Ke})),n.d(t,"d",(function(){return Ze})),n.d(t,"e",(function(){return Xe}));var a=n(120),r=n(199),i=n(464),o=n(466),s=n(463),l=n(467),c=n(468),u=n(469),d=n(470);const p=a.z.object({name:r.K,description:r.B,risk_score:r.r,severity:r.Y}),m=a.z.object({rule_name_override:r.L.optional(),timestamp_override:r.db.optional(),timestamp_override_fallback_disabled:r.eb.optional(),timeline_id:r.bb.optional(),timeline_title:r.cb.optional(),outcome:r.V.optional(),alias_target_id:r.U.optional(),alias_purpose:r.T.optional(),license:r.I.optional(),note:r.j.optional(),building_block_type:r.f.optional(),output_index:r.d.optional(),namespace:r.e.optional(),meta:r.J.optional(),investigation_fields:r.i.optional(),throttle:r.z.optional()}),f=a.z.object({version:r.S.optional(),tags:r.R.optional(),enabled:r.k.optional(),risk_score_mapping:r.s.optional(),severity_mapping:r.Z.optional(),interval:r.F.optional(),from:r.G.optional(),to:r.H.optional(),actions:a.z.array(r.t).optional(),exceptions_list:a.z.array(r.C).optional(),author:r.A.optional(),false_positives:r.D.optional(),references:r.O.optional(),max_signals:r.n.optional(),threat:r.ab.optional(),setup:r.X.optional(),related_integrations:r.o.optional(),required_fields:a.z.array(r.q).optional()}),g=p.merge(m).merge(f),b=p.partial().merge(m).merge(f),y=p.merge(m).merge(f.required()),h=a.z.object({id:r.M,rule_id:r.P,immutable:r.l,rule_source:r.Q.optional(),updated_at:a.z.string().datetime(),updated_by:a.z.string(),created_at:a.z.string().datetime(),created_by:a.z.string(),revision:a.z.number().int().min(0),required_fields:r.p,execution_summary:i.a.optional()}),v=g.merge(a.z.object({rule_id:r.P.optional()})),E=g.merge(a.z.object({id:r.M.optional(),rule_id:r.P.optional()})),x=b.merge(a.z.object({id:r.M.optional(),rule_id:r.P.optional()})),j=y.merge(h),O=a.z.literal("eql"),S=a.z.object({type:a.z.literal("eql"),query:r.N,language:O}),w=a.z.object({index:r.h.optional(),data_view_id:r.g.optional(),filters:r.E.optional(),event_category_override:o.a.optional(),tiebreaker_field:o.b.optional(),timestamp_field:o.c.optional(),alert_suppression:r.a.optional()}),k=S.merge(w),I=S.merge(w),T=S.partial().merge(w),C=j.merge(I),M=v.merge(k),_=E.merge(k),D=x.merge(T),N=a.z.object({type:a.z.literal("query")}),A=a.z.object({index:r.h.optional(),data_view_id:r.g.optional(),filters:r.E.optional(),saved_id:r.W.optional(),response_actions:a.z.array(s.a).optional(),alert_suppression:r.a.optional()}),F=a.z.object({query:r.N.optional(),language:r.m.optional()}),P=N.merge(A).merge(F),R=N.partial().merge(A).merge(F),L=N.merge(A).merge(F.required()),q=j.merge(L),z=v.merge(P),B=E.merge(P),$=x.merge(R),V=a.z.object({type:a.z.literal("saved_query"),saved_id:r.W}),U=a.z.object({index:r.h.optional(),data_view_id:r.g.optional(),filters:r.E.optional(),response_actions:a.z.array(s.a).optional(),alert_suppression:r.a.optional(),query:r.N.optional()}),G=a.z.object({language:r.m.optional()}),H=V.merge(U).merge(G),W=V.partial().merge(U).merge(G),Q=V.merge(U).merge(G.required()),Y=j.merge(Q),K=v.merge(H),Z=E.merge(H),X=x.merge(W),J=a.z.object({type:a.z.literal("threshold"),query:r.N,threshold:l.a}),ee=a.z.object({index:r.h.optional(),data_view_id:r.g.optional(),filters:r.E.optional(),saved_id:r.W.optional(),alert_suppression:l.b.optional()}),te=a.z.object({language:r.m.optional()}),ne=J.merge(ee).merge(te),ae=J.partial().merge(ee).merge(te),re=J.merge(ee).merge(te.required()),ie=j.merge(re),oe=v.merge(ne),se=E.merge(ne),le=x.merge(ae),ce=a.z.object({type:a.z.literal("threat_match"),query:r.N,threat_query:c.g,threat_mapping:c.f,threat_index:c.d}),ue=a.z.object({index:r.h.optional(),data_view_id:r.g.optional(),filters:r.E.optional(),saved_id:r.W.optional(),threat_filters:c.c.optional(),threat_indicator_path:c.e.optional(),threat_language:r.m.optional(),concurrent_searches:c.a.optional(),items_per_search:c.b.optional(),alert_suppression:r.a.optional()}),de=a.z.object({language:r.m.optional()}),pe=ce.merge(ue).merge(de),me=ce.partial().merge(ue).merge(de),fe=ce.merge(ue).merge(de.required()),ge=j.merge(fe),be=v.merge(pe),ye=E.merge(pe),he=x.merge(me),ve=a.z.object({type:a.z.literal("machine_learning"),anomaly_threshold:u.a,machine_learning_job_id:u.b}),Ee=a.z.object({alert_suppression:r.a.optional()}),xe=ve.partial().merge(Ee),je=ve.merge(Ee),Oe=ve.merge(Ee),Se=j.merge(je),we=v.merge(Oe),ke=E.merge(Oe),Ie=x.merge(xe),Te=a.z.object({type:a.z.literal("new_terms"),query:r.N,new_terms_fields:d.b,history_window_start:d.a}),Ce=a.z.object({index:r.h.optional(),data_view_id:r.g.optional(),filters:r.E.optional(),alert_suppression:r.a.optional()}),Me=a.z.object({language:r.m.optional()}),_e=Te.partial().merge(Ce).merge(Me),De=Te.merge(Ce).merge(Me.required()),Ne=Te.merge(Ce).merge(Me),Ae=j.merge(De),Fe=v.merge(Ne),Pe=E.merge(Ne),Re=x.merge(_e),Le=a.z.literal("esql"),qe=a.z.object({type:a.z.literal("esql"),language:Le,query:r.N}),ze=a.z.object({alert_suppression:r.a.optional()}),Be=ze.merge(qe.partial()),$e=ze.merge(qe),Ve=ze.merge(qe),Ue=j.merge($e),Ge=v.merge(Ve),He=E.merge(Ve),We=x.merge(Be.partial()),Qe=a.z.discriminatedUnion("type",[k,P,H,ne,pe,Oe,Ne,Ve]),Ye=(a.z.union([T,R,W,ae,me,xe,_e,Be]),a.z.discriminatedUnion("type",[I,L,Q,re,fe,je,De,$e]),a.z.discriminatedUnion("type",[M,z,K,oe,be,we,Fe,Ge])),Ke=a.z.discriminatedUnion("type",[_,B,Z,se,ye,ke,Pe,He]),Ze=a.z.union([D,$,X,le,he,Ie,Re,We]),Xe=a.z.discriminatedUnion("type",[C,q,Y,ie,ge,Se,Ae,Ue])},,function(e,t,n){"use strict";n.d(t,"xc",(function(){return r})),n.d(t,"dc",(function(){return i})),n.d(t,"fc",(function(){return o})),n.d(t,"zd",(function(){return s})),n.d(t,"yd",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"wc",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"Tb",(function(){return p})),n.d(t,"yc",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"t",(function(){return g})),n.d(t,"r",(function(){return b})),n.d(t,"u",(function(){return y})),n.d(t,"x",(function(){return h})),n.d(t,"s",(function(){return v})),n.d(t,"n",(function(){return E})),n.d(t,"v",(function(){return x})),n.d(t,"A",(function(){return j})),n.d(t,"g",(function(){return O})),n.d(t,"o",(function(){return S})),n.d(t,"j",(function(){return w})),n.d(t,"q",(function(){return k})),n.d(t,"w",(function(){return I})),n.d(t,"h",(function(){return T})),n.d(t,"p",(function(){return C})),n.d(t,"k",(function(){return M})),n.d(t,"i",(function(){return _})),n.d(t,"z",(function(){return D})),n.d(t,"y",(function(){return N})),n.d(t,"ib",(function(){return A})),n.d(t,"gb",(function(){return F})),n.d(t,"hb",(function(){return P})),n.d(t,"kb",(function(){return R})),n.d(t,"mb",(function(){return L})),n.d(t,"E",(function(){return q})),n.d(t,"m",(function(){return z})),n.d(t,"C",(function(){return B})),n.d(t,"l",(function(){return $})),n.d(t,"D",(function(){return V})),n.d(t,"jb",(function(){return U})),n.d(t,"lb",(function(){return G})),n.d(t,"pb",(function(){return H})),n.d(t,"ob",(function(){return W})),n.d(t,"nb",(function(){return Q})),n.d(t,"eb",(function(){return Y})),n.d(t,"T",(function(){return K})),n.d(t,"F",(function(){return Z})),n.d(t,"V",(function(){return X})),n.d(t,"G",(function(){return J})),n.d(t,"I",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"H",(function(){return ne})),n.d(t,"U",(function(){return ae})),n.d(t,"W",(function(){return re})),n.d(t,"X",(function(){return ie})),n.d(t,"P",(function(){return oe})),n.d(t,"bb",(function(){return se})),n.d(t,"Q",(function(){return le})),n.d(t,"fb",(function(){return ce})),n.d(t,"S",(function(){return ue})),n.d(t,"R",(function(){return de})),n.d(t,"cb",(function(){return pe})),n.d(t,"db",(function(){return me})),n.d(t,"N",(function(){return fe})),n.d(t,"M",(function(){return ge})),n.d(t,"L",(function(){return be})),n.d(t,"K",(function(){return ye})),n.d(t,"O",(function(){return he})),n.d(t,"Z",(function(){return ve})),n.d(t,"Y",(function(){return Ee})),n.d(t,"ab",(function(){return xe})),n.d(t,"Yb",(function(){return je})),n.d(t,"od",(function(){return Oe})),n.d(t,"nd",(function(){return Se})),n.d(t,"td",(function(){return we})),n.d(t,"rd",(function(){return ke})),n.d(t,"rb",(function(){return Ie})),n.d(t,"qd",(function(){return Te})),n.d(t,"Ub",(function(){return Ce})),n.d(t,"jc",(function(){return Me})),n.d(t,"kc",(function(){return _e})),n.d(t,"Sb",(function(){return De})),n.d(t,"Zb",(function(){return Ne})),n.d(t,"Pb",(function(){return Ae})),n.d(t,"lc",(function(){return Fe})),n.d(t,"mc",(function(){return Pe})),n.d(t,"Eb",(function(){return Re})),n.d(t,"Db",(function(){return Le})),n.d(t,"Fb",(function(){return qe})),n.d(t,"yb",(function(){return ze})),n.d(t,"Ab",(function(){return Be})),n.d(t,"zb",(function(){return $e})),n.d(t,"Hb",(function(){return Ve})),n.d(t,"xb",(function(){return Ue})),n.d(t,"sb",(function(){return Ge})),n.d(t,"Gb",(function(){return He})),n.d(t,"vb",(function(){return We})),n.d(t,"wb",(function(){return Qe})),n.d(t,"Bb",(function(){return Ye})),n.d(t,"Cb",(function(){return Ke})),n.d(t,"tb",(function(){return Ze})),n.d(t,"ub",(function(){return Xe})),n.d(t,"Wb",(function(){return Je})),n.d(t,"Rb",(function(){return et})),n.d(t,"Jb",(function(){return tt})),n.d(t,"Vb",(function(){return nt})),n.d(t,"wd",(function(){return at})),n.d(t,"pd",(function(){return rt})),n.d(t,"ed",(function(){return it})),n.d(t,"tc",(function(){return ot})),n.d(t,"gd",(function(){return st})),n.d(t,"nc",(function(){return lt})),n.d(t,"sc",(function(){return ct})),n.d(t,"oc",(function(){return ut})),n.d(t,"pc",(function(){return dt})),n.d(t,"qc",(function(){return pt})),n.d(t,"rc",(function(){return mt})),n.d(t,"Kb",(function(){return ft})),n.d(t,"b",(function(){return gt})),n.d(t,"md",(function(){return bt})),n.d(t,"fd",(function(){return yt})),n.d(t,"Lb",(function(){return ht})),n.d(t,"a",(function(){return vt})),n.d(t,"ld",(function(){return Et})),n.d(t,"c",(function(){return xt})),n.d(t,"uc",(function(){return jt})),n.d(t,"Ib",(function(){return Ot})),n.d(t,"Mb",(function(){return St})),n.d(t,"ec",(function(){return wt})),n.d(t,"sd",(function(){return kt})),n.d(t,"gc",(function(){return It})),n.d(t,"vc",(function(){return Tt})),n.d(t,"vd",(function(){return Ct})),n.d(t,"bc",(function(){return Mt})),n.d(t,"cc",(function(){return _t})),n.d(t,"B",(function(){return Dt})),n.d(t,"ud",(function(){return Nt})),n.d(t,"Ob",(function(){return At})),n.d(t,"Nb",(function(){return Ft})),n.d(t,"zc",(function(){return Pt})),n.d(t,"qb",(function(){return Rt})),n.d(t,"Yc",(function(){return Lt})),n.d(t,"Zc",(function(){return qt})),n.d(t,"Xc",(function(){return zt})),n.d(t,"Vc",(function(){return Bt})),n.d(t,"Wc",(function(){return $t})),n.d(t,"Kc",(function(){return Vt})),n.d(t,"Lc",(function(){return Ut})),n.d(t,"Ic",(function(){return Gt})),n.d(t,"Jc",(function(){return Ht})),n.d(t,"Cc",(function(){return Wt})),n.d(t,"Dc",(function(){return Qt})),n.d(t,"Ac",(function(){return Yt})),n.d(t,"Bc",(function(){return Kt})),n.d(t,"Tc",(function(){return Zt})),n.d(t,"Uc",(function(){return Xt})),n.d(t,"Rc",(function(){return Jt})),n.d(t,"Sc",(function(){return en})),n.d(t,"Gc",(function(){return tn})),n.d(t,"Hc",(function(){return nn})),n.d(t,"Ec",(function(){return an})),n.d(t,"Fc",(function(){return rn})),n.d(t,"cd",(function(){return on})),n.d(t,"ad",(function(){return sn})),n.d(t,"dd",(function(){return ln})),n.d(t,"bd",(function(){return cn})),n.d(t,"Oc",(function(){return un})),n.d(t,"Qc",(function(){return dn})),n.d(t,"Pc",(function(){return pn})),n.d(t,"Mc",(function(){return mn})),n.d(t,"Nc",(function(){return fn})),n.d(t,"kd",(function(){return gn})),n.d(t,"hd",(function(){return bn})),n.d(t,"Xb",(function(){return yn})),n.d(t,"Qb",(function(){return hn})),n.d(t,"id",(function(){return vn})),n.d(t,"hc",(function(){return En})),n.d(t,"ic",(function(){return xn})),n.d(t,"xd",(function(){return jn})),n.d(t,"ac",(function(){return On})),n.d(t,"jd",(function(){return Sn}));var a=n(4);const r=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),i=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Manage value lists"}),s=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRunTitle",{defaultMessage:"Manual run"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.investigationFieldsTitle",{defaultMessage:"Custom highlighted fields"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),_=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),F=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),R=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),L=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be scheduled"}),q=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),B=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),V=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),U=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),G=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkManualRuleRunConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Schedule {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorMessage",{defaultMessage:"This action can only be applied"}),W=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorTitle",{values:{rulesCount:e},defaultMessage:"Manual rule run cannot be scheduled for more than {rulesCount, plural, =1 {# rule} other {# rules}}"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorCloseButton",{defaultMessage:"Close"}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),le=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),ue=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),de=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),pe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.investigationFieldsRequiredErrorMessage",{defaultMessage:"A minimum of one custom highlighted field is required."}),ge=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsOverwriteCheckboxLabel",{defaultMessage:"Overwrite the custom highlighted fields for the selected rules"}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxLabel",{defaultMessage:"Add custom highlighted fields for selected rules"}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter fields that you want to add.  You can choose from any of the fields included in the default Elastic Security indices."}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxLabel",{defaultMessage:"Delete custom highlighted fields for selected rules"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter the fields that you want to remove from the selected rules. After you remove these fields, they will no longer appear in the Highlighted fields section of the alerts generated by selected rules."}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),Se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CK™ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),we=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ke=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),Ie=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),Te=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),_e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunDescription",{defaultMessage:"Manual run"}),Pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunTooltip",{defaultMessage:"Manual run available only for enabled rules"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.integrationsTitle",{defaultMessage:"Integrations"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),Ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Je=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),it=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),st=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),ct=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),ut=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),dt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),ft=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),ht=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),Et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),Ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),St=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),wt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),kt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),It=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),Tt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),Ct=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),Mt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),_t=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),Dt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),Nt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),At=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),Ft=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),Pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),Rt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),Lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),qt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),zt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),Bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),$t=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),Vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),Ut=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),Ht=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Wt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),Qt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),Kt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),Zt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),Xt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),en=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),tn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),nn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),an=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),rn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),on=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastTitle",{defaultMessage:"Rules scheduled"}),sn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastTitle",{defaultMessage:"Error scheduling manual rule run"}),ln=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully scheduled manual rule run for {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),cn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastDescription",{values:{failedRulesCount:e},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to schedule manual rule run."}),un=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),dn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),pn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),mn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),fn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),gn=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),bn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),yn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),hn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),vn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),En=a.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),xn=e=>a.i18n.translate("xpack.securitySolution.addRules.installRuleButton.ariaLabel",{defaultMessage:'Install "{ruleName}"',values:{ruleName:e}}),jn=a.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),On=a.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),Sn=a.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return f}));var a=n(19),r=n(2),i=n.n(r),o=n(138),s=n(514),l=n(474),c=n(447),u=n(650);const d="inspectButtonComponent",p=({children:e,show:t=!0})=>i.a.createElement(s.a,{show:t,targetClassNames:[d]},e),m=({compact:e=!1,inputId:t=o.a.global,inspectIndex:n=0,isDisabled:r,multiple:s=!1,onCloseInspect:p,queryId:m="",showInspectButton:f=!0,title:g=""})=>{const{additionalRequests:b,additionalResponses:y,handleClick:h,handleCloseModal:v,isButtonDisabled:E,isShowingModal:x,loading:j,request:O,response:S}=Object(c.a)({inputId:t,inspectIndex:n,isDisabled:r,multiple:s,onCloseInspect:p,queryId:m});return i.a.createElement(i.a.Fragment,null,t===o.a.timeline&&!e&&f&&i.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":u.d,"data-test-subj":"inspect-empty-button",isDisabled:E,isLoading:j,onClick:h},u.d),(t===o.a.global||e)&&f&&i.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":u.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:E,title:u.d,onClick:h}),x&&null!==O&&null!==S&&i.a.createElement(l.a,{additionalRequests:b,additionalResponses:y,closeModal:v,"data-test-subj":"inspect-modal",inputId:t,request:O,response:S,title:g}))};m.displayName="InspectButtonComponent";const f=i.a.memo(m)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return I})),n.d(t,"b",(function(){return q})),n.d(t,"g",(function(){return z}));var a=n(979),r=n(44),i=n(50),o=n(413),s=n.n(o),l=n(45),c=n(2),u=n(513),d=n(121),p=n(146),m=n(556),f=n(158),g=n(243),b=n(179),y=n(705),h=n(396),v=n(292),E=n(274),x=n(129);const j="open-timeline",O=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,S=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),w=({title:e})=>null==e||0===e.trim().length,k=(e,t)=>"__typename"===e?void 0:t,I=e=>JSON.parse(JSON.stringify(e),k),T=e=>{try{return JSON.parse(e)}catch{return e}},C=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:T(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:T(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:T(e.meta.value)}:{}},...null!=e.exists?{exists:T(e.exists)}:{},...null!=e.match_all?{exists:T(e.match_all)}:{},...null!=e.missing?{exists:T(e.missing)}:{},...null!=e.query?{query:T(e.query)}:{},...null!=e.range?{range:T(e.range)}:{},...null!=e.script?{exists:T(e.script)}:{}}),M=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(r.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},_=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},D=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},N=(e,t,n)=>n===d.m.default&&e.timelineType===d.m.template?e.templateTimelineId:t&&e.timelineType===d.m.template?Object(i.v4)():e.templateTimelineId,A=({and:e,...t})=>t.type===d.a.template?s()(t,{type:d.a.default,enabled:t.queryMatch.operator!==b.d,queryMatch:{value:t.queryMatch.operator===b.d?"":t.queryMatch.value}}):t,F=(e,t,n)=>e&&t&&n===d.m.default?t.map((e=>{var t,n;return{...A(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(A))&&void 0!==t?t:[]}})):t,P=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",R=(e,t,n)=>n&&e.timelineType!==n?d.l.draft:t?d.l.active:e.status,L=(e,t,n,r)=>{const i=e.timelineType===d.m.template,o=r?g.b:E.a,s={...e,columns:null!=e.columns?e.columns.map((e=>((e,t)=>{var n;return Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:g.a,id:null!=e.id?e.id:"unknown",initialWidth:null===(n=t.find((t=>e.id===t.id)))||void 0===n?void 0:n.initialWidth})})(e,o))):o,defaultColumns:o,dateRange:e.status===d.l.immutable&&e.timelineType===d.m.template?{start:h.a.toISOString(),end:h.b.toISOString()}:e.dateRange,dataProviders:F(t,e.dataProviders,n),excludedRowRendererIds:i?[]:Object.keys(d.e),eventIdToNoteIds:M(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(C):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:D(t,e.pinnedEventIds),pinnedEventsSaveObject:_(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:R(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:P(e,t,n),templateTimelineId:N(e,t,n),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(s).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...f.b,id:""})},q=(e,t=!1,n,a)=>{const{notes:r,...i}=e;return{notes:r,timeline:L(i,t,n,a)}},z=()=>{const{resetDiscoverAppState:e}=Object(u.a)(),t=Object(m.a)(),n=Object(l.useDispatch)(),a=Object(c.useCallback)((e=>n(x.a.updateIsLoading(e))),[n]);return({activeTimelineTab:n=p.d.query,duplicate:i=!1,graphEventId:o="",timelineId:s,timelineType:l,onError:c,onOpenTimeline:u,openTimeline:m=!0,savedSearchId:b,unifiedComponentsInTimelineDisabled:x=!1})=>{if(a({id:p.c.active,isLoading:!0}),null!=s)return Promise.resolve(Object(v.j)(s)).then((a=>{const s=Object(r.getOr)(null,"data",a);if(!s)return;const c=I(s.timeline),{timeline:d,notes:f}=q(c,i,l,x);if(null!=u)u(d);else if(t){const{from:a,to:l}=Object(y.a)({from:Object(r.getOr)(null,"dateRange.start",d),to:Object(r.getOr)(null,"dateRange.end",d)});return t({duplicate:i,from:a,id:p.c.active,notes:f,resolveTimelineConfig:{outcome:s.outcome,alias_target_id:s.alias_target_id,alias_purpose:s.alias_purpose},timeline:{...d,activeTab:n,graphEventId:o,show:m,dateRange:{start:a,end:l},savedSearchId:d.savedSearchId},to:l,preventSettingQuery:!0}),e(d.savedSearchId)}})).catch((e=>{null!=c&&c(e,s)})).finally((()=>{a({id:p.c.active,isLoading:!1})}));t({id:p.c.active,duplicate:!1,notes:[],from:h.a.toISOString(),to:h.b.toISOString(),timeline:{...f.b,columns:x?g.b:E.a,id:p.c.active,activeTab:n,show:m,initialized:!0,savedSearchId:null!=b?b:null,excludedRowRendererIds:x||l===d.m.template?[]:f.b.excludedRowRendererIds}}),e(),a({id:p.c.active,isLoading:!1})}}},function(e,t,n){"use strict";var a,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function o(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},a=[],r=0;r<e.length;r++){var s=e[r],l=t.base?s[0]+t.base:s[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var d=o(u),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:u,updater:g(p,t),references:1}),a.push(u)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=n.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=r(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,n,a){var r=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var i=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function p(e,t,n){var a=n.css,r=n.media,i=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,f=0;function g(e,t){var n,a,r;if(t.singleton){var i=f++;n=m||(m=l(t)),a=d.bind(null,n,i,!1),r=d.bind(null,n,i,!0)}else n=l(t),a=p.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var r=o(n[a]);i[r].references--}for(var l=s(e,t),c=0;c<n.length;c++){var u=o(n[c]);0===i[u].references&&(i[u].updater(),i.splice(u,1))}n=l}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,a,r,i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var s=(n=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(r," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([s]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&r[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(2),r=n(118);const i={managed:!0},o=()=>{const{services:{apm:e}}=Object(r.j)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:i)),[e])}},s=e=>`Timeline search ${e}`},,function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return y}));var a=n(2),r=n(44),i=n(45),o=n(271),s=n.n(o),l=n(58),c=n(213),u=n(124),d=n(1361),p=n(246),m=n(21);const f=(e,t,n)=>{const r=Object(i.useDispatch)(),o=Object(c.g)(e);Object(a.useEffect)((()=>{const a=n&&""!==n?n:e,i=o();return r(d.a.registerUrlParam({key:a,initialValue:i})),t(i),()=>{r(d.a.deregisterUrlParam({key:a}))}}),[])},g=e=>{const t=Object(i.useDispatch)();return Object(a.useCallback)((n=>{t(d.a.updateUrlParam({key:e,value:n}))}),[t,e])},b=()=>{const e=Object(u.b)(d.c.selectGlobalUrlParam);return Object(a.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((n=>{const a=e[n];if(a&&("object"!=typeof a||!Object(r.isEmpty)(a)))try{t[n]=Object(l.encode)(a)}catch{}})),Object(c.b)(Object(r.pickBy)((e=>!Object(r.isEmpty)(e)),t))):""}),[e])},y=()=>{const[{pageName:e}]=Object(p.a)(),t=Object(u.b)(d.c.selectGlobalUrlParam),n=s()(t),i=Object(c.h)();Object(a.useEffect)((()=>{var a;const o=null!==(a=Object(m.b)(e))&&void 0!==a?a:{skipUrlState:!0},s={...t};o.skipUrlState&&Object.keys(s).forEach((e=>{s[e]=null})),Object(r.difference)(Object.keys(null!=n?n:{}),Object.keys(t)).forEach((e=>{s[e]=null})),Object.keys(s).length>0&&i(s)}),[n,t,e,i])}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.alert="alert",e.asset="asset",e.enrichment="enrichment",e.event="event",e.metric="metric",e.state="state",e.pipeline_error="pipeline_error",e.signal="signal",e}({})},,function(e,t,n){"use strict";n.d(t,"c",(function(){return l.a})),n.d(t,"h",(function(){return l.d})),n.d(t,"d",(function(){return c.a})),n.d(t,"i",(function(){return c.b})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p.b})),n.d(t,"f",(function(){return p.a})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return h}));var a=n(44),r=n(2),i=n(454),o=n(529),s=n(364),l=n(258),c=n(276),u=(n(5),n(207));const d=(e,t)=>`/${e}${Object(u.a)(t)}`;var p=n(375);const m=(e,t)=>`/${e}${Object(u.a)(t)}`,f=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,g=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(u.a)(null!=t?t:void 0)}`,b=e=>`/create${Object(u.a)(null!=e?e:void 0)}`,y=e=>{const{getAppUrl:t}=Object(s.a)(),n=Object(o.b)(e);return{formatUrl:Object(r.useCallback)(((r,{absolute:i=!1,skipSearch:o=!1}={})=>{const s=function(e,t,n){const[r,i]=e.split("?");return`${r}${n?Object(a.isEmpty)(i)?"":`?${i}`:Object(a.isEmpty)(i)?t:`?${i}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}(r,n,o);return t({deepLinkId:e,path:s,absolute:i})}),[t,e,n]),search:n}},h=()=>{const e=Object(i.f)(),t=Object(o.a)();return Object(r.useCallback)((({deepLinkId:n,path:a="",absolute:r=!1,skipSearch:i=!1})=>{const o=i?"":t(n);return e({id:n,path:a,urlState:o,absolute:r})}),[e,t])}},,function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return f}));var a=n(19),r=n(41),i=n.n(r);const o=i.a.div.withConfig({displayName:"SecuritySolutionAppWrapper",componentId:"sc-2kezi3-0"})(["display:flex;flex-direction:column;flex:1 1 auto;width:100%;"]);o.displayName="SecuritySolutionAppWrapper";const s=()=>Object(r.css)([".euiOverlayMask[data-relative-to-header='below']{top:0 !important;}.euiFlyout{top:0 !important;height:100% !important;}"]),l=Object(r.createGlobalStyle)([".euiDataGridRowCell__popover{max-width:815px !important;max-height:none !important;overflow:hidden;.expandable-top-value-button{&.euiButtonEmpty:focus{background-color:transparent;}}&.euiPopover__panel[data-popover-open]{padding:8px 0;min-width:65px;}.euiPopoverFooter{border:0;margin-top:0;.euiFlexGroup{flex-direction:column;}}.euiText + .euiPopoverFooter{border-top:1px solid ",";margin-top:",";}}.euiPanel-loading-hide-border{border:none;}body.euiBody-hasOverlayMask{.euiDataGridRowCell__popover[data-popover-open],.withHoverActions__popover[data-popover-open]{visibility:hidden !important;}}.euiScreenReaderOnly{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeS)),c=i()(a.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-2kezi3-1"})(["",""],(({theme:e})=>`\n    word-break: break-word;\n    dt {\n      font-size: ${e.eui.euiFontSizeXS} !important;\n    }\n    dd {\n      width: fit-content;\n    }\n    dd > div {\n      width: fit-content;\n    }\n  `));c.displayName="DescriptionListStyled";const u=i()(a.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-2kezi3-2"})(["margin-left:5px;"]);u.displayName="CountBadge";const d=i.a.span.withConfig({displayName:"Spacer",componentId:"sc-2kezi3-3"})(["margin-left:5px;"]);d.displayName="Spacer";const p=i()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-2kezi3-4"})(["vertical-align:top;"]);p.displayName="Badge";const m=i()(a.EuiIcon).withConfig({displayName:"MoreRowItems",componentId:"sc-2kezi3-5"})(["margin-left:5px;"]);m.displayName="MoreRowItems";const f=i()(a.EuiFlexGroup).withConfig({displayName:"OverviewWrapper",componentId:"sc-2kezi3-6"})(["position:relative;.euiButtonIcon{position:absolute;right:",";top:6px;z-index:2;}"],(e=>e.theme.eui.euiSizeM));f.displayName="OverviewWrapper"},function(e,t,n){"use strict";n.d(t,"C",(function(){return r})),n.d(t,"q",(function(){return i})),n.d(t,"v",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"o",(function(){return l})),n.d(t,"p",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"B",(function(){return p})),n.d(t,"r",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"y",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"E",(function(){return y})),n.d(t,"w",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"x",(function(){return E})),n.d(t,"z",(function(){return x})),n.d(t,"t",(function(){return j})),n.d(t,"s",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return w})),n.d(t,"F",(function(){return k})),n.d(t,"g",(function(){return I})),n.d(t,"A",(function(){return T})),n.d(t,"D",(function(){return C})),n.d(t,"e",(function(){return M})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return D})),n.d(t,"i",(function(){return N})),n.d(t,"h",(function(){return A})),n.d(t,"j",(function(){return F}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),i=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),p=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),m=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),y=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),h=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),v=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),E=a.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),x=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),j=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),O=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),w=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),I=Object.freeze({tried:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),T=a.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),C=a.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),M=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),_=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),D=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),N=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),A=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),F=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return _}));var a=n(189),r=n(45),i=n(2),o=n(138),s=n(118),l=n(148),c=n(183),u=n(44),d=n(122),p=n(705),m=n(346);var f=n(271),g=n.n(f),b=n(213),y=n(246);var h=n(58),v=n(149),E=n(184),x=n(169),j=n(129),O=n(124),S=n(48);const w=({search:e,urlKey:t})=>Object(b.d)(Object(b.e)(e),t);var k=n(1799),I=n(1630),T=n(1490),C=n(5);const M=()=>{Object(a.c)(),(()=>{const e=Object(r.useDispatch)(),{filterManager:t,savedQueries:n}=Object(s.j)().services.data.query,u=Object(i.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),d=Object(r.useSelector)(u),p=Object(i.useCallback)((t=>{null!=t&&e(c.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),m=Object(i.useCallback)((n=>{null!=n?(t.setFilters(n),e(c.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(c.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(i.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],r=n.attributes.query;t.setFilters(a),e(c.b.setSearchBarFilter({id:o.a.global,filters:a})),e(c.b.setFilterQuery({id:o.a.global,...r})),e(c.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(a.b)(_.appQuery,p),Object(a.b)(_.filters,m),Object(a.b)(_.savedQuery,f)})(),(()=>{const e=Object(r.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),n=Object(i.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(u.get)("global.linkTo",e)},r=Object(u.get)("global.timerange.kind",e),i={linkTo:Object(u.get)("timeline.linkTo",e)},s=Object(u.get)("timeline.timerange.kind",e),l={linkTo:Object(u.get)("socTrends.linkTo",e)},d=Object(u.get)("socTrends.timerange.kind",e);if(n&&(Object(u.isEmpty)(l.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.socTrends])):t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(a.linkTo)?(t(c.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(c.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(i.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.timeline])):t(c.b.addLinkTo([o.a.global,o.a.timeline])),s){if("absolute"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(r){if("absolute"===r){const n=Object(p.a)(Object(u.get)("global.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===r){const n=Object(p.a)(Object(u.get)("global.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&d){if("absolute"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(a.b)(_.timerange,n)})(),(()=>{const[{pageName:e}]=Object(y.a)(),t=Object(r.useDispatch)(),n=g()(e),a=Object(i.useMemo)((()=>l.d.inputsSelector()),[]),s=Object(r.useSelector)(a),{timerange:u}=s.global,{timerange:d}=s.timeline;Object(i.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(b.f)(e))(e,n)&&("relative"===d.kind&&t(c.b.setRelativeRangeDatePicker({...d,from:Object(m.c)(d.fromStr),to:Object(m.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===u.kind&&t(c.b.setRelativeRangeDatePicker({...u,from:Object(m.c)(u.fromStr),to:Object(m.c)(u.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,u])})(),(()=>{const e=Object(d.a)("unifiedComponentsInTimelineDisabled"),t=Object(d.a)("timelineEsqlTabDisabled"),n=Object(E.g)(),o=Object(r.useSelector)((e=>Object(x.selectTimelineById)(e,v.f.active))),s=Object(i.useCallback)((a=>{null!=a&&n({activeTimelineTab:a.activeTab===v.g.esql&&t?v.g.query:a.activeTab,duplicate:!1,graphEventId:a.graphEventId,timelineId:a.id,openTimeline:a.isOpen,savedSearchId:a.savedSearchId,unifiedComponentsInTimelineDisabled:e})}),[t,n,e]);Object(i.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(_.timeline);if(!e)return;const t=Object(h.safeDecode)(e);(function(e,t){return e&&t&&(e.id!==t.id||e.savedSearchId!==t.savedSearchId||e.graphEventId!==t.graphEventId)})(o,t)||s(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[s,o]),Object(a.b)(_.timeline,s)})(),(()=>{const e=Object(a.d)(_.timeline),t=Object(i.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:r,show:o,savedObjectId:s,savedSearchId:l}=Object(O.b)((e=>{var n;return null!==(n=t(e,v.f.active))&&void 0!==n?n:{}}));Object(i.useEffect)((()=>{const t={...s?{id:s}:{},isOpen:o,activeTab:n,graphEventId:null!=r?r:"",savedSearchId:l||void 0};e(t)}),[n,r,s,o,e,l])})(),(()=>{var e;const t=Object(i.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),n=Object(O.b)((e=>t(e,v.f.active))),{search:a}=Object(S.useLocation)(),r=g()(a),o=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",s=Object(d.a)("unifiedComponentsInTimelineDisabled"),[l,c]=Object(i.useMemo)((()=>{const e=w({urlKey:_.timeline,search:null!=r?r:""}),t=w({urlKey:_.timeline,search:a});return null!=e&&null!=t?[Object(h.safeDecode)(e),Object(h.safeDecode)(t)]:[null,null]}),[r,a]),u=null==l?void 0:l.id,{id:p,activeTab:m,graphEventId:f}=c||{},b=Object(E.g)();Object(i.useEffect)((()=>{p&&p!==u&&p!==o&&b({activeTimelineTab:null!=m?m:v.g.query,duplicate:!1,graphEventId:f,timelineId:p,openTimeline:!0,unifiedComponentsInTimelineDisabled:s})}),[o,u,p,m,f,b,s])})(),(()=>{const{search:e}=Object(S.useLocation)(),t=Object(d.a)("expandableFlyoutDisabled"),[n,o]=Object(i.useState)(null),[s,l]=Object(i.useState)(!1),c=Object(r.useDispatch)(),u=k.b.getTableByIdSelector(),p=Object(O.b)((e=>{var t;return null!==(t=u(e,I.b.alertsOnAlertsPage))&&void 0!==t?t:T.d})),m=Object(i.useCallback)((e=>{t&&null!=e&&e.panelView&&o(e)}),[t]),f=Object(i.useCallback)((()=>{if(!t)return;const{initialized:e,isLoading:a,totalCount:r,additionalFilters:i}=p,o=e&&!a&&r>0;n&&(i&&i.showBuildingBlockAlerts||c(k.a.updateShowBuildingBlockAlertsFilter({id:I.b.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),o&&(l(!0),c(k.a.toggleDetailPanel({id:I.b.alertsOnAlertsPage,...n}))))}),[p,c,t,n]);Object(i.useEffect)((()=>{t&&!s&&f()}),[s,t,f]);const g=w({urlKey:_.eventFlyout,search:e});let b="",y="";t&&(g?(b=_.eventFlyout,y=_.flyout):b=_.flyout),Object(a.b)(b,m,y)})(),(()=>{const e=Object(d.a)("expandableFlyoutDisabled"),t=Object(a.d)(_.flyout),{pathname:n}=Object(S.useLocation)(),o=Object(r.useDispatch)(),s=k.b.getTableByIdSelector(),{expandedDetail:l}=Object(O.b)((e=>{var t;return null!==(t=s(e,I.b.alertsOnAlertsPage))&&void 0!==t?t:T.d}));Object(i.useEffect)((()=>{var a;if(!e)return;const r=n===C.d;r&&null!=l&&null!=l&&l.query?t(l.query.panelView?l.query:null):!r&&null!=l&&null!==(a=l.query)&&void 0!==a&&a.panelView&&(o(k.a.toggleDetailPanel({id:I.b.alertsOnAlertsPage})),t(null))}),[o,l,e,n,t])})()},_={appQuery:"query",eventFlyout:"eventFlyout",flyout:"flyout",timelineFlyout:"timelineFlyout",filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},,function(e,t,n){"use strict";var a=n(260);n.d(t,"a",(function(){return a.a}));var r=n(337);n.d(t,"b",(function(){return r.a}));var i=n(183);n.d(t,"c",(function(){return i.b}));var o=n(166);n.d(t,"d",(function(){return o.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(956);const i=()=>Object(a.useContext)(r.a)},,function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c}));let a=function(e){return e.windows="windows",e.mac="mac",e.linux="linux",e}({}),r=function(e){return e.is="is",e.matches="matches",e}({}),i=function(e){return e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled",e}({}),o=function(e){return e.detect="detect",e.prevent="prevent",e.off="off",e}({}),s=function(e){return e.enabled="enabled",e.disabled="disabled",e.sync="sync_with_malware_prevent",e}({}),l=function(e){return e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported",e}({}),c=function(e){return e.ENROLLED_AT="enrolled_at",e.HOSTNAME="metadata.host.hostname",e.HOST_STATUS="host_status",e.POLICY_NAME="metadata.Endpoint.policy.applied.name",e.POLICY_STATUS="metadata.Endpoint.policy.applied.status",e.HOST_OS_NAME="metadata.host.os.name",e.HOST_IP="metadata.host.ip",e.AGENT_VERSION="metadata.agent.version",e.LAST_SEEN="last_checkin",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"x",(function(){return O})),n.d(t,"y",(function(){return S})),n.d(t,"m",(function(){return w})),n.d(t,"k",(function(){return k})),n.d(t,"n",(function(){return I})),n.d(t,"l",(function(){return T})),n.d(t,"d",(function(){return C})),n.d(t,"e",(function(){return M})),n.d(t,"i",(function(){return _})),n.d(t,"q",(function(){return D})),n.d(t,"r",(function(){return N})),n.d(t,"h",(function(){return A})),n.d(t,"p",(function(){return xe})),n.d(t,"t",(function(){return je})),n.d(t,"f",(function(){return Oe})),n.d(t,"j",(function(){return Se})),n.d(t,"v",(function(){return we})),n.d(t,"w",(function(){return ke})),n.d(t,"b",(function(){return Ie})),n.d(t,"s",(function(){return Te})),n.d(t,"o",(function(){return Le})),n.d(t,"g",(function(){return qe})),n.d(t,"u",(function(){return ze})),n.d(t,"c",(function(){return Be}));var a=n(455),r=n(269),i=n(1619),o=n(799),s=n(1328),l=n(46);const c=l.number,u=(l.union([c,l[void 0]]),l.number),d=(l.union([u,l[void 0]]),l.string),p=l.exact(l.type({id:d,keepAlive:l.union([l.string,l[void 0]])})),m=(l.union([p,l[void 0]]),l.number),f=(l.union([m,l[void 0]]),l.intersection([l.exact(l.type({data:l.array(o.a),page:c,per_page:u,total:m})),l.exact(l.partial({pit:d}))])),g=l.intersection([l.exact(l.type({data:l.array(s.a),page:c,per_page:u,total:m})),l.exact(l.partial({pit:d}))]);l.union([o.a,l.exact(l.type({}))]);var b=n(168),y=n(426),h=n(344);const v=async e=>Object(y.pipe)(await e(),Object(h.fold)((e=>Promise.reject(e)),(e=>Promise.resolve(e)))),E=e=>e instanceof Error?e:new Error(String(e)),x="2023-10-31",j=async({http:e,listItem:t,signal:n})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(b.p,{body:JSON.stringify(t),method:"POST",signal:n,version:x}))({http:e,listItem:t,signal:n})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(s.a,e)))),Object(r.flow)(v))(),O=async({http:e,list:t,signal:n})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,list:t,signal:n})=>e.fetch(b.s,{body:JSON.stringify(t),method:"PUT",signal:n,version:x}))({http:e,list:t,signal:n})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(o.a,e)))),Object(r.flow)(v))(),S=async({http:e,listItem:t,signal:n})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(b.p,{body:JSON.stringify(t),method:"PUT",signal:n,version:x}))({http:e,listItem:t,signal:n})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(s.a,e)))),Object(r.flow)(v))(),w=async({filters:e,http:t,namespaceTypes:n,pagination:o,signal:s,sort:l})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,filters:t,namespaceTypes:n,pagination:a,signal:r,sort:i})=>{const o={filter:t||void 0,namespace_type:n,page:a.page?`${a.page}`:"1",per_page:a.perPage?`${a.perPage}`:"20",sort_field:null!=i&&i.field?null==i?void 0:i.field:"exception-list.created_at",sort_order:null!=i&&i.order?null==i?void 0:i.order:"desc"};return e.fetch(`${b.s}/_find`,{method:"GET",query:o,signal:r,version:x})})({filters:e,http:t,namespaceTypes:n,pagination:o,signal:s,sort:l})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(f,e)))),Object(r.flow)(v))(),k=async({http:e,id:t,namespaceType:n,signal:s})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.s,{method:"GET",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:s})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(o.a,e)))),Object(r.flow)(v))(),I=async({filter:e,http:t,listIds:n,namespaceTypes:o,pagination:s,search:l,signal:c})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listIds:t,namespaceTypes:n,filter:a,pagination:r,search:i,signal:o})=>{const s={list_id:t.join(","),namespace_type:n.join(","),page:r.page?`${r.page}`:"1",per_page:r.perPage?`${r.perPage}`:"20",search:i,sort_field:"exception-list.created_at",sort_order:"desc",filter:a};return e.fetch(`${b.p}/_find`,{method:"GET",query:s,signal:o,version:x})})({filter:e,http:t,listIds:n,namespaceTypes:o,pagination:s,search:l,signal:c})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(g,e)))),Object(r.flow)(v))(),T=async({http:e,id:t,namespaceType:n,signal:o})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.p,{method:"GET",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:o})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(s.a,e)))),Object(r.flow)(v))(),C=async({http:e,id:t,namespaceType:n,signal:s})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.s,{method:"DELETE",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:s})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(o.a,e)))),Object(r.flow)(v))(),M=async({http:e,id:t,namespaceType:n,signal:o})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.p,{method:"DELETE",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:o})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(s.a,e)))),Object(r.flow)(v))(),_=async({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:r,signal:i})=>e.fetch(`${b.s}/_export`,{method:"POST",query:{id:t,list_id:a,namespace_type:r,include_expired_exceptions:n},signal:i,version:x}),D=async({alias:e,chunkSize:t,exceptionListIds:n,excludeExceptions:a,http:r,signal:i})=>r.fetch(b.u,{method:"POST",version:"1",body:JSON.stringify({exception_list_ids:n,type:"exception_list_ids",alias:e,exclude_exceptions:a,chunk_size:t}),signal:i}),N=async({exceptions:e,alias:t,excludeExceptions:n,http:a,chunkSize:r,signal:i})=>a.fetch(b.u,{method:"POST",version:"1",body:JSON.stringify({exceptions:e,type:"exception_items",alias:t,exclude_exceptions:n,chunk_size:r}),signal:i}),A=async({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:r})=>e.fetch(`${b.s}/_duplicate`,{method:"POST",query:{list_id:n,namespace_type:a,include_expired_exceptions:t},signal:r,version:x}),F=new l.Type("StringToPositiveNumber",l.number.is,((e,t)=>h.either.chain(l.string.validate(e,t),(n=>{const a=+n;return 0===n.trim().length||isNaN(a)||a<=0?l.failure(e,t):l.success(a)}))),String),P=l.string,R=(l.union([P,l[void 0]]),l.string),L=(l.union([R,l[void 0]]),l.string),q=(l.union([L,l[void 0]]),l.keyof({asc:null,desc:null})),z=(l.union([q,l[void 0]]),l.exact(l.partial({cursor:P,filter:R,page:F,per_page:F,sort_field:L,sort_order:q})));var B=n(2070),$=n(345);const V=l.string,U=l.union([V,l[void 0]]);var G=n(275);const H=l.string,W=l.union([H,l[void 0]]);var Q=n(397),Y=n(1531);Y.a;const K=l.union([Y.a,l[void 0]]);var Z=n(398),X=n(399),J=n(214),ee=n(800),te=n(400),ne=n(457),ae=n(458),re=n(401),ie=n(402);const oe=l.exact(l.type({_version:$.b,"@timestamp":K,created_at:Q.a,created_by:Z.a,description:X.a,deserializer:U,id:J.a,immutable:ee.a,meta:G.b,name:te.a,serializer:W,tie_breaker_id:ne.a,type:ae.a,updated_at:re.a,updated_by:ie.a,version:B.a})),se=(l.array(oe),l.exact(l.type({cursor:P,data:l.array(oe),page:c,per_page:u,total:m})));l.exact(l.type({largeLists:l.array(oe),smallLists:l.array(oe)}));var le=n(255);const ce=l.union([l.literal("true"),l.literal("false")]),ue=l.union([l.literal("true"),l.literal("false"),l.literal("wait_for")]),de=l.exact(l.partial({deserializer:V,list_id:le.a,serializer:H,type:ae.a,refresh:ue})),pe=l.object,me=l.exact(l.type({file:pe})),fe=new l.Type("DefaultStringBooleanFalse",l.boolean.is,((e,t)=>null==e?l.success(!1):"string"==typeof e&&"true"===e.toLowerCase()?l.success(!0):"string"==typeof e&&"false"===e.toLowerCase()?l.success(!1):l.boolean.validate(e,t)),l.identity),ge=l.intersection([l.exact(l.type({id:J.a})),l.exact(l.partial({deleteReferences:fe,ignoreReferences:fe}))]),be=l.exact(l.type({list_id:le.a})),ye=l.exact(l.type({list_index:l.boolean,list_item_index:l.boolean})),he=l.exact(l.type({acknowledged:l.boolean})),ve=l.exact(l.type({id:J.a})),Ee="2023-10-31",xe=async({cursor:e,http:t,pageIndex:n,pageSize:o,signal:s,sortField:l,sortOrder:c})=>Object(y.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=o?o.toString():void 0,sort_field:null!=l?l.toString():void 0,sort_order:c},(e=>Object(a.fromEither)(Object(i.b)(z,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({http:e,cursor:t,page:n,per_page:a,signal:r,sort_field:i,sort_order:o})=>e.fetch(`${b.z}/_find`,{method:"GET",query:{cursor:t,page:n,per_page:a,sort_field:i,sort_order:o},signal:r,version:Ee}))({http:t,signal:s,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(se,e)))),Object(r.flow)(v)),je=async({file:e,http:t,listId:n,type:r,signal:o,refresh:s})=>Object(y.pipe)({list_id:n,type:r,refresh:s},(e=>Object(a.fromEither)(Object(i.b)(de,e))),Object(a.chain)((t=>Object(y.pipe)(Object(a.fromEither)(Object(i.b)(me,{file:e})),Object(a.map)((e=>({...e,...t})))))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({file:e,http:t,list_id:n,type:a,signal:r,refresh:i})=>{const o=new FormData;return o.append("file",e),t.fetch(`${b.x}/_import`,{body:o,headers:{"Content-Type":void 0},method:"POST",query:{list_id:n,type:a,refresh:i},signal:r,version:Ee})})({http:t,signal:o,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(oe,e)))),v),Oe=async({deleteReferences:e,http:t,id:n,ignoreReferences:o,signal:s})=>Object(y.pipe)({deleteReferences:e,id:n,ignoreReferences:o},(e=>Object(a.fromEither)(Object(i.b)(ge,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({deleteReferences:e=!1,http:t,id:n,ignoreReferences:a=!1,signal:r})=>t.fetch(b.z,{method:"DELETE",query:{deleteReferences:e,id:n,ignoreReferences:a},signal:r,version:Ee}))({http:t,signal:s,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(oe,e)))),Object(r.flow)(v)),Se=async({http:e,listId:t,signal:n})=>Object(y.pipe)({list_id:t},(e=>Object(a.fromEither)(Object(i.b)(be,e))),Object(a.chain)((t=>Object(a.tryCatch)((()=>(async({http:e,list_id:t,signal:n})=>e.fetch(`${b.x}/_export`,{method:"POST",query:{list_id:t},signal:n,version:Ee}))({http:e,signal:n,...t})),E))),Object(r.flow)(v)),we=async({http:e,signal:t})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(b.w,{method:"GET",signal:t,version:Ee}))({http:e,signal:t})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(ye,e)))),Object(r.flow)(v))(),ke=async({http:e,signal:t})=>e.fetch(b.y,{method:"GET",signal:t,version:Ee}),Ie=async({http:e,signal:t})=>Object(r.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(b.w,{method:"POST",signal:t,version:Ee}))({http:e,signal:t})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(he,e)))),Object(r.flow)(v))(),Te=async({http:e,signal:t,id:n})=>Object(y.pipe)({id:n},(e=>Object(a.fromEither)(Object(i.b)(ve,e))),Object(a.chain)((n=>Object(a.tryCatch)((()=>(async({http:e,signal:t,id:n})=>e.fetch(`${b.z}`,{method:"GET",query:{id:n},signal:t,version:Ee}))({http:e,signal:t,...n})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(oe,e)))),Object(r.flow)(v)),Ce=l.intersection([l.exact(l.type({list_id:le.a})),l.exact(l.partial({cursor:P,filter:R,page:F,per_page:F,sort_field:L,sort_order:q}))]),Me=l.string,_e=l.union([Me,l[void 0]]),De=l.exact(l.type({_version:$.b,"@timestamp":K,created_at:Q.a,created_by:Z.a,deserializer:U,id:J.a,list_id:le.a,meta:G.b,serializer:W,tie_breaker_id:ne.a,type:ae.a,updated_at:re.a,updated_by:ie.a,value:Me})),Ne=(l.array(De),l.exact(l.type({cursor:P,data:l.array(De),page:c,per_page:u,total:m}))),Ae=l.intersection([l.exact(l.type({value:_e})),l.exact(l.partial({id:J.a,list_id:le.a,refresh:ce}))]),Fe=l.intersection([l.exact(l.type({id:J.a})),l.exact(l.partial({_version:$.a,meta:G.a,value:Me,refresh:ce}))]),Pe=l.intersection([l.exact(l.type({list_id:le.a,value:Me})),l.exact(l.partial({id:J.a,meta:G.a,refresh:ue}))]),Re="2023-10-31",Le=async({cursor:e,http:t,pageIndex:n,pageSize:o,signal:s,sortField:l,sortOrder:c,filter:u,listId:d})=>Object(y.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=o?o.toString():void 0,sort_field:null!=l?l.toString():void 0,filter:null!=u?u.toString():void 0,sort_order:c,list_id:d},(e=>Object(a.fromEither)(Object(i.b)(Ce,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({http:e,cursor:t,page:n,list_id:a,per_page:r,signal:i,sort_field:o,sort_order:s,filter:l})=>e.fetch(`${b.x}/_find`,{method:"GET",query:{cursor:t,page:n,per_page:r,sort_field:o,sort_order:s,list_id:a,filter:l},signal:i,version:Re}))({http:t,signal:s,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(Ne,e)))),Object(r.flow)(v)),qe=async({http:e,id:t,signal:n,refresh:o})=>Object(y.pipe)({id:t,refresh:o},(e=>Object(a.fromEither)(Object(i.b)(Ae,e))),Object(a.chain)((t=>Object(a.tryCatch)((()=>(async({http:e,id:t,signal:n,refresh:a})=>e.fetch(b.x,{method:"DELETE",query:{id:t,refresh:a},signal:n,version:Re}))({http:e,signal:n,...t,value:void 0,list_id:void 0})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(De,e)))),Object(r.flow)(v)),ze=async({http:e,id:t,signal:n,value:o,refresh:s,_version:l})=>Object(y.pipe)({id:t,value:o,_version:l,refresh:s},(e=>Object(a.fromEither)(Object(i.b)(Fe,e))),Object(a.chain)((t=>Object(a.tryCatch)((()=>(async({http:e,id:t,signal:n,value:a,_version:r})=>e.fetch(b.x,{method:"PATCH",body:JSON.stringify({id:t,value:a,_version:r}),signal:n,version:Re}))({http:e,signal:n,...t})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(De,e)))),Object(r.flow)(v)),Be=async({http:e,signal:t,value:n,refresh:o,listId:s})=>Object(y.pipe)({list_id:s,value:n,refresh:o},(e=>Object(a.fromEither)(Object(i.b)(Pe,e))),Object(a.chain)((n=>Object(a.tryCatch)((()=>(async({http:e,signal:t,value:n,list_id:a,refresh:r})=>e.fetch(b.x,{method:"POST",body:JSON.stringify({value:n,list_id:a,refresh:r}),signal:t,version:Re}))({http:e,signal:t,...n})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(i.b)(De,e)))),Object(r.flow)(v))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(2),r=n(45),i=n(138),o=n(5),s=n(124),l=n(148),c=n(200);const u=()=>{var e;const t=Object(r.useDispatch)(),n=null!==(e=Object(s.b)(l.d.globalFullScreenSelector))&&void 0!==e&&e,u=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add(o.Gc,"euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove(o.Gc,"euiDataGrid__restrictBody"),t(c.c.setFullScreen({id:i.a.global,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({globalFullScreen:n,setGlobalFullScreen:u})),[n,u])},d=()=>{var e;const t=Object(r.useDispatch)(),n=null!==(e=Object(s.b)(l.d.timelineFullScreenSelector))&&void 0!==e&&e,o=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add("euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove("euiDataGrid__restrictBody"),t(c.c.setFullScreen({id:i.a.timeline,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({timelineFullScreen:n,setTimelineFullScreen:o})),[n,o])},p=()=>{const{globalFullScreen:e}=u(),{timelineFullScreen:t}=d(),n=(()=>{const[e,t]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const e=document.body,n=new MutationObserver((n=>{for(const a of n)"class"===a.attributeName&&t(e.classList.contains("euiDataGrid__restrictBody"))}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[]),e})();return e||t||n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(44);const r=e=>Object(a.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(2),r=n(8),i=n.n(r),o=n(452);const s=e=>{const t=Object(o.b)(),n=i()(t.sections$,t.getSectionsValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},l=e=>{const t=Object(o.b)(),n=i()(t.messages$,t.getMessagesValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},c=e=>{const t=Object(o.b)(),n=Object(a.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=n?n:null}},,function(e,t,n){"use strict";n.d(t,"f",(function(){return Pe})),n.d(t,"b",(function(){return Re})),n.d(t,"c",(function(){return Le})),n.d(t,"e",(function(){return qe})),n.d(t,"d",(function(){return ze})),n.d(t,"a",(function(){return Be}));var a=n(2),r=n.n(a),i=n(1216),o=n(122),s=n(145),l=n(118),c=n(41),u=n.n(c),d=n(19),p=(n(43),n(537)),m=n(142),f=n(192),g=n(125);const b=Object(a.memo)((({selectedTabId:e,setSelectedTabId:t,tabs:n})=>{const{getFieldsData:a}=Object(g.b)(),i=Object(m.a)(a("event.kind"))===f.a.signal,o=n.map(((n,a)=>r.a.createElement(d.EuiTab,{onClick:()=>{return e=n.id,t(e);var e},isSelected:n.id===e,key:a,"data-test-subj":n["data-test-subj"]},n.name)));return r.a.createElement(y,{$_css:Object(d.useEuiBackgroundColor)("subdued")},r.a.createElement(d.EuiTabs,{size:"l",expand:i},o))}));b.displayName="PanelHeader";var y=u()(p.a).withConfig({displayName:"_StyledFlyoutHeader",componentId:"sc-1qgelk0-0"})(["background-color:",";padding-bottom:0 !important;border-block-end:none !important;"],(e=>e.$_css)),h=n(418);const v=({selectedTabId:e,tabs:t})=>{const n=Object(a.useMemo)((()=>{var n;return null===(n=t.find((t=>t.id===e)))||void 0===n?void 0:n.content}),[e,t]);return r.a.createElement(E,{$_css:Object(d.useEuiBackgroundColor)("subdued")},n)};v.displayName="PanelContent";var E=u()(h.a).withConfig({displayName:"_StyledFlyoutBody",componentId:"sc-1pfozwl-0"})(["background-color:",";"],(e=>e.$_css)),x=n(42),j=n(45),O=n(4),S=n(384),w=n(285),k=n(149),I=n(129),T=n(153),C=n(123),M=n(289),_=n(300);const D=O.i18n.translate("xpack.securitySolution.notes.markdownAriaLabel",{defaultMessage:"Note"}),N=O.i18n.translate("xpack.securitySolution.notes.addNoteBtnLabel",{defaultMessage:"Add note"}),A=O.i18n.translate("xpack.securitySolution.notes.createNoteErrorLabel",{defaultMessage:"Error create note"}),F=O.i18n.translate("xpack.securitySolution.notes.attachToTimelineCheckboxLabel",{defaultMessage:"Attach to active timeline"}),P=O.i18n.translate("xpack.securitySolution.notes.attachToTimelineInfoLabel",{defaultMessage:"The active timeline must be saved before a note can be associated with it"}),R=Object(a.memo)((({eventId:e})=>{const{telemetry:t}=Object(l.j)().services,n=Object(j.useDispatch)(),{addError:i}=Object(C.a)(),[o,s]=Object(a.useState)(""),[c,u]=Object(a.useState)(!1),p=Object(j.useSelector)((e=>I.b.selectTimelineById(e,k.f.active))),m=Object(S.a)()===w.a.timeline,[f,g]=Object(a.useState)(!0),b=Object(a.useCallback)((e=>g(e.target.checked)),[]),y=Object(j.useSelector)((e=>Object(M.j)(e))),h=Object(j.useSelector)((e=>Object(M.i)(e))),v=Object(a.useCallback)((()=>{n(Object(M.b)({note:{timelineId:f&&(null==p?void 0:p.savedObjectId)||"",eventId:e,note:o}})),t.reportAddNoteFromExpandableFlyoutClicked({isRelatedToATimeline:f&&null!==(null==p?void 0:p.savedObjectId)}),s("")}),[null==p?void 0:p.savedObjectId,f,n,o,e,t]);Object(a.useEffect)((()=>{y===M.a.Failed&&h&&i(null,{title:A})}),[i,h,y]);const E=Object(a.useMemo)((()=>0===o.trim().length||c),[o,c]),x=Object(a.useMemo)((()=>m&&null!=p.savedObjectId),[null==p?void 0:p.savedObjectId,m]),O=Object(a.useMemo)((()=>!m||m&&null==(null==p?void 0:p.savedObjectId)),[null==p?void 0:p.savedObjectId,m]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiCommentList,null,r.a.createElement(d.EuiComment,{username:""},r.a.createElement(_.a,{dataTestSubj:T.c,value:o,onChange:s,ariaLabel:D,setIsMarkdownInvalid:u}))),r.a.createElement(d.EuiSpacer,null),r.a.createElement(d.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",responsive:!1},r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiCheckbox,{"data-test-subj":T.e,id:"xpack.securitySolution.notes.attachToTimelineCheckboxId",label:r.a.createElement(r.a.Fragment,null,F,r.a.createElement(d.EuiToolTip,{position:"top",content:P},r.a.createElement(L,{type:"iInCircle"}))),disabled:O,checked:x&&f,onChange:e=>b(e)}))),r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(d.EuiButton,{onClick:v,isLoading:y===M.a.Loading,disabled:E,"data-test-subj":T.a},N))))}));R.displayName="AddNote";var L=u()(d.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-sgqe0x-0"})(["margin-left:4px;"]),q=n(184),z=n(140);const B=O.i18n.translate("xpack.securitySolution.notes.addedANoteLabel",{defaultMessage:"added a note"}),$=O.i18n.translate("xpack.securitySolution.notes.fetchNotesErrorLabel",{defaultMessage:"Error fetching notes"}),V=O.i18n.translate("xpack.securitySolution.notes.noNotesLabel",{defaultMessage:"No notes have been created for this document"}),U=O.i18n.translate("xpack.securitySolution.notes.deleteNoteLabel",{defaultMessage:"Delete note"}),G=O.i18n.translate("xpack.securitySolution.notes.deleteNoteErrorLabel",{defaultMessage:"Error deleting note"}),H=Object(a.memo)((({eventId:e})=>{const t=Object(j.useDispatch)(),{addError:n}=Object(C.a)(),{kibanaSecuritySolutionsPrivileges:i}=Object(z.a)(),s=i.crud,l=Object(o.a)("unifiedComponentsInTimelineDisabled"),c=Object(j.useSelector)((e=>Object(M.n)(e))),u=Object(j.useSelector)((e=>Object(M.m)(e))),p=Object(j.useSelector)((t=>Object(M.w)(t,{documentId:e,sort:{field:"created",direction:"desc"}}))),m=Object(j.useSelector)((e=>Object(M.j)(e))),f=Object(j.useSelector)((e=>Object(M.l)(e))),g=Object(j.useSelector)((e=>Object(M.k)(e))),[b,y]=Object(a.useState)(""),h=Object(a.useCallback)((e=>{y(e),t(Object(M.c)({ids:[e]}))}),[t]),v=Object(q.g)(),E=Object(a.useCallback)((({timelineId:e})=>v({duplicate:!1,onOpenTimeline:void 0,timelineId:e,timelineType:void 0,unifiedComponentsInTimelineDisabled:l})),[v,l]);return Object(a.useEffect)((()=>{c===M.a.Failed&&u&&n(null,{title:$})}),[n,u,c]),Object(a.useEffect)((()=>{f===M.a.Failed&&g&&n(null,{title:G})}),[n,g,f]),c===M.a.Loading?r.a.createElement(d.EuiLoadingElastic,{"data-test-subj":T.u,size:"xxl"}):c===M.a.Succeeded&&0===p.length?r.a.createElement("p",null,V):r.a.createElement(d.EuiCommentList,null,p.map(((e,t)=>r.a.createElement(d.EuiComment,{"data-test-subj":`${T.t}-${t}`,key:e.noteId,username:e.createdBy,timestamp:r.a.createElement(r.a.Fragment,null,e.created&&r.a.createElement(x.FormattedRelative,{value:new Date(e.created)})),event:B,actions:r.a.createElement(r.a.Fragment,null,e.timelineId&&e.timelineId.length>0&&r.a.createElement(d.EuiButtonIcon,{"data-test-subj":`${T.w}-${t}`,title:"Open timeline","aria-label":"Open timeline",color:"text",iconType:"timeline",onClick:()=>E(e)}),s&&r.a.createElement(d.EuiButtonIcon,{"data-test-subj":`${T.m}-${t}`,title:U,"aria-label":U,color:"text",iconType:"trash",onClick:()=>h(e.noteId),disabled:b!==e.noteId&&f===M.a.Loading,isLoading:b===e.noteId&&f===M.a.Loading})),timelineAvatar:r.a.createElement(d.EuiAvatar,{"data-test-subj":`${T.v}-${t}`,size:"l",name:e.updatedBy||"?"})},r.a.createElement(_.b,null,e.note||"")))),m===M.a.Loading&&r.a.createElement(d.EuiLoadingElastic,{size:"xxl","data-test-subj":T.b}))}));H.displayName="NotesList";const W=Object(a.memo)((()=>{const e=Object(j.useDispatch)(),{eventId:t}=Object(g.b)(),{kibanaSecuritySolutionsPrivileges:n}=Object(z.a)(),i=n.crud;return Object(a.useEffect)((()=>{e(Object(M.e)({documentIds:[t]}))}),[e,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{eventId:t}),i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiSpacer,null),r.a.createElement(R,{eventId:t})))}));W.displayName="NotesDetails";var Q=n(254);const Y=Object(a.memo)((()=>r.a.createElement(d.EuiPanel,{"data-test-subj":Q.i,hasShadow:!1},r.a.createElement(W,null))));Y.displayName="NotesTab";var K=n(1397),Z=n(669),X=n(277),J=n(131);const ee="analyze_graph",te=()=>{const{eventId:e}=Object(g.b)(),t="flyout",{from:n,to:i,shouldUpdate:o,selectedPatterns:s}=Object(X.a)(Object(J.isActiveTimeline)(t)),l=Object(a.useMemo)((()=>({from:n,to:i})),[n,i]);return r.a.createElement("div",{"data-test-subj":T.d},r.a.createElement(Z.a,{databaseDocumentID:e,resolverComponentInstanceID:t,indices:s,shouldUpdate:o,filters:l}))};te.displayName="AnalyzeGraph";var ne=n(234);const ae="session-view",re=()=>{const{sessionView:e}=Object(l.j)().services,{getFieldsData:t,indexName:n}=Object(g.b)(),a=Object(m.a)(t(ne.b)),i=Object(m.a)(t(ne.c))||"",o=Object(m.a)(t(ne.d))||"",s=a||n;return r.a.createElement("div",{"data-test-subj":T.L},e.getSessionView({index:s,sessionEntityId:i,sessionStartTime:o,isFullScreen:!0}))};re.displayName="SessionView";var ie=n(219),oe=n(187);const se=[{id:ae,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.sessionViewButtonLabel",defaultMessage:"Session View"}),"data-test-subj":Q.m},{id:ee,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.analyzerGraphButtonLabel",defaultMessage:"Analyzer Graph"}),"data-test-subj":Q.l}];Object(a.memo)((()=>{var e,t,n,o,l;const{eventId:c,indexName:u,scopeId:p}=Object(g.b)(),{openLeftPanel:m}=Object(i.a)(),f=Object(K.a)(),[b,y]=Object(a.useState)(null!==(e=null===(t=f.left)||void 0===t||null===(n=t.path)||void 0===n?void 0:n.subTab)&&void 0!==e?e:ae),{startTransaction:h}=Object(oe.b)(),v=Object(a.useCallback)((e=>{y(e),e===ee&&h({name:ie.a.OPEN_ANALYZER}),m({id:s.c,path:{tab:Pe,subTab:e},params:{id:c,indexName:u,scopeId:p}})}),[h,c,u,p,m]);return Object(a.useEffect)((()=>{var e,t,n,a;null!==(e=f.left)&&void 0!==e&&null!==(t=e.path)&&void 0!==t&&t.subTab&&y(null===(n=f.left)||void 0===n||null===(a=n.path)||void 0===a?void 0:a.subTab)}),[null===(o=f.left)||void 0===o||null===(l=o.path)||void 0===l?void 0:l.subTab]),r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiButtonGroup,{color:"primary",name:"coarsness",legend:O.i18n.translate("xpack.securitySolution.flyout.left.visualize.buttonGroupLegendLabel",{defaultMessage:"Visualize options"}),options:se,idSelected:b,onChange:e=>v(e),buttonSize:"compressed",isFullWidth:!0,"data-test-subj":Q.k}),r.a.createElement(d.EuiSpacer,{size:"m"}),b===ae&&r.a.createElement(re,null),b===ee&&r.a.createElement(te,null))})).displayName="VisualizeTab";var le=n(605),ce=n(394),ue=n(339);const de=()=>{const{dataFormattedForFieldBrowser:e,isPreview:t}=Object(g.b)(),{loading:n,error:a,basicAlertData:i,ruleNote:o}=Object(le.a)({dataFormattedForFieldBrowser:e});return r.a.createElement("div",{"data-test-subj":T.s},t?r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."}):n?r.a.createElement(ue.a,{"data-test-subj":T.r}):!a&&i.ruleId&&o?r.a.createElement(ce.b,{basicData:i,ruleNote:o,showTitle:!1,showFullView:!0}):r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataDescription",defaultMessage:"There's no investigation guide for this rule. {documentation} to add one.",values:{documentation:r.a.createElement(d.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-management.html#edit-rules-settings",target:"_blank"},r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataLinkText",defaultMessage:"Edit the rule's settings"}))}}))};de.displayName="InvestigationGuide";const pe=Object(a.memo)((()=>r.a.createElement(d.EuiPanel,{"data-test-subj":Q.h,hasShadow:!1},r.a.createElement(de,null))));pe.displayName="InvestigationTab";var me=n(320),fe=n(633),ge=n(606),be=n(623);const ye=[{id:me.a,label:r.a.createElement("div",{"data-test-subj":Q.c},r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entitiesButtonLabel",defaultMessage:"Entities"})),"data-test-subj":Q.d},{id:fe.a,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.threatIntelligenceButtonLabel",defaultMessage:"Threat intelligence"}),"data-test-subj":Q.g},{id:ge.a,label:r.a.createElement("div",{"data-test-subj":Q.e},r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalenceButtonLabel",defaultMessage:"Prevalence"})),"data-test-subj":Q.f},{id:be.a,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlationsButtonLabel",defaultMessage:"Correlations"}),"data-test-subj":Q.b}],he=Object(a.memo)((()=>{var e,t,n;const{telemetry:o}=Object(l.j)().services,{eventId:c,indexName:u,scopeId:p,getFieldsData:b}=Object(g.b)(),y=Object(m.a)(b("event.kind"))===f.a.signal,{openLeftPanel:h}=Object(i.a)(),v=null!==(e=null===(t=Object(K.a)().left)||void 0===t||null===(n=t.path)||void 0===n?void 0:n.subTab)&&void 0!==e?e:me.a,E=Object(a.useMemo)((()=>y?ye:ye.filter((e=>e.id!==fe.a))),[y]),x=Object(a.useCallback)((e=>{h({id:s.c,path:{tab:Re,subTab:e},params:{id:c,indexName:u,scopeId:p}}),o.reportDetailsFlyoutTabClicked({location:p,panel:"left",tabId:e})}),[c,u,p,h,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiButtonGroup,{color:"primary",legend:O.i18n.translate("xpack.securitySolution.flyout.left.insights.buttonGroupLegendLabel",{defaultMessage:"Insights options"}),options:E,idSelected:v,onChange:x,buttonSize:"compressed",isFullWidth:!0,"data-test-subj":Q.a,style:y?void 0:{maxWidth:450}}),r.a.createElement(d.EuiSpacer,{size:"m"}),v===me.a&&r.a.createElement(me.b,null),v===fe.a&&r.a.createElement(fe.b,null),v===ge.a&&r.a.createElement(ge.b,null),v===be.a&&r.a.createElement(be.b,null))}));he.displayName="InsightsTab";var ve=n(211);ve.a;const Ee=`${ve.a}InsightsTab`,xe=`${ve.a}InvestigationTab`,je=`${ve.a}ResponseTab`,Oe=`${ve.a}NotesTab`;var Se=n(729),we=n(740);const ke=u.a.div.withConfig({displayName:"ExtendedFlyoutWrapper",componentId:"sc-qxbnld-0"})(["figure{background-color:white"]),Ie=()=>{const{searchHit:e,dataAsNestedObject:t,isPreview:n}=Object(g.b)(),a=Object(o.a)("endpointResponseActionsEnabled"),i=Object(we.a)({rawEventData:e,ecsData:t}),s=Object(Se.a)({rawEventData:e,ecsData:t});return r.a.createElement("div",{"data-test-subj":T.J},n?r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.previewMessage",defaultMessage:"Response is not available in alert preview."}):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiTitle,{size:"xxxs"},r.a.createElement("h5",null,r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.responseTitle",defaultMessage:"Responses"}))),r.a.createElement(d.EuiSpacer,{size:"s"}),r.a.createElement(ke,null,a?null==i?void 0:i.content:null==s?void 0:s.content)))};Ie.displayName="ResponseDetails";const Te=Object(a.memo)((()=>r.a.createElement(d.EuiPanel,{"data-test-subj":Q.j,hasShadow:!1},r.a.createElement(Ie,null))));Te.displayName="ResponseTab",x.FormattedMessage;const Ce={id:"insights","data-test-subj":Ee,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.tabLabel",defaultMessage:"Insights"}),content:r.a.createElement(he,null)},Me={id:"investigation","data-test-subj":xe,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigations.tabLabel",defaultMessage:"Investigation"}),content:r.a.createElement(pe,null)},_e={id:"response","data-test-subj":je,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.tabLabel",defaultMessage:"Response"}),content:r.a.createElement(Te,null)},De={id:"notes","data-test-subj":Oe,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.notes.tabLabel",defaultMessage:"Notes"}),content:r.a.createElement(Y,null)};var Ne=n(631),Ae=n(436);const Fe=Object(a.memo)((()=>{const{getFieldsData:e,isPreview:t}=Object(g.b)(),n=Object(m.a)(e("event.kind"))===f.a.signal,i=Object(S.a)()===w.a.timeline,o=n&&!t&&!i,s=Object(a.useMemo)((()=>Object(Ae.a)()),[]);return o?r.a.createElement(Ne.a,{tourStepContent:s,totalSteps:5}):null}));Fe.displayName="LeftPanelTour";const Pe="visualize",Re="insights",Le="investigation",qe="response",ze="notes",Be=Object(a.memo)((({path:e})=>{const{telemetry:t}=Object(l.j)().services,{openLeftPanel:n}=Object(i.a)(),{eventId:c,indexName:u,scopeId:d,getFieldsData:p,isPreview:y}=Object(g.b)(),h=Object(m.a)(p("event.kind")),E=Object(o.a)("securitySolutionNotesEnabled"),x=Object(a.useMemo)((()=>{const e=h===f.a.signal?[Ce,Me,_e]:[Ce];return E&&!y&&e.push(De),e}),[h,y,E]),j=Object(a.useMemo)((()=>{var t;const n=x[0].id;return e&&null!==(t=x.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:n}),[e,x]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Fe,null),r.a.createElement(b,{selectedTabId:j,setSelectedTabId:e=>{n({id:s.c,path:{tab:e},params:{id:c,indexName:u,scopeId:d}}),t.reportDetailsFlyoutTabClicked({location:d,panel:"left",tabId:e})},tabs:x}),r.a.createElement(v,{selectedTabId:j,tabs:x}))}));Be.displayName="LeftPanel"},,,function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"a",(function(){return b}));var a=n(58),r=n(429),i=n(12),o=n(48),s=n(2),l=n(156);const c=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesAdd||e===l.a.rulesCreate||e===l.a.exceptions,u=e=>e.substring(1),d=(e,t)=>{const n=Object(r.parse)(e,{sort:!1})[t];return Array.isArray(n)?n[0]:n},p=(e,t)=>{const n=d(u(null!=t?t:window.location.search),e);return Object(a.safeDecode)(null!=n?n:"")},m=e=>Object(s.useCallback)((()=>p(e)),[e]),f=e=>Object(r.stringify)(i.url.encodeQuery(e),{sort:!1,encode:!1}),g=()=>{const e=Object(o.useHistory)();return Object(s.useCallback)((t=>{const n=window.location.search,i=Object(r.parse)(n,{sort:!1});Object.keys(t).forEach((e=>{const n=t[e];if(null!=n&&""!==n)try{i[e]=Object(a.encode)(n)}catch{console.error("Unable to encode url param value")}else delete i[e]}));const o=f(i);u(n)!==o&&e.replace({search:o})}),[e])},b=()=>{window.history.pushState({},"",window.location.href)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=n(1371).a;a.union([r,a[void 0]])},,,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(5);const r={ENABLE:`${a.m} singleRuleActions enable`,DISABLE:`${a.m} singleRuleActions disable`,DUPLICATE:`${a.m} singleRuleActions duplicate`,EXPORT:`${a.m} singleRuleActions export`,DELETE:`${a.m} singleRuleActions delete`,MANUAL_RULE_RUN:`${a.m} singleRuleActions manual rule run`,PREVIEW:`${a.m} singleRuleActions preview`,SAVE:`${a.m} singleRuleActions save`},i={ENABLE:`${a.m} bulkRuleActions enable`,DISABLE:`${a.m} bulkRuleActions disable`,DUPLICATE:`${a.m} bulkRuleActions duplicate`,EXPORT:`${a.m} bulkRuleActions export`,MANUAL_RULE_RUN:`${a.m} bulkRuleActions manual rule run`,DELETE:`${a.m} bulkRuleActions delete`,EDIT:`${a.m} bulkRuleActions edit`},o={REFRESH:`${a.m} rulesTable refresh`,FILTER:`${a.m} rulesTable filter`,LOAD_PREBUILT:`${a.m} rulesTable loadPrebuilt`},s={SAVE:`${a.m} timeline save`,DUPLICATE:`${a.m} timeline duplicate`,DELETE:`${a.m} timeline delete`,BULK_DELETE:`${a.m} timeline bulkDelete`},l={OPEN_ANALYZER:`${a.m} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.m} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.m} alerts investigateInTimeline`},c={FIELD_SAVED:`${a.m} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.m} fieldBrowser fieldDeleted`}},,function(e,t,n){"use strict";n.d(t,"B",(function(){return r})),n.d(t,"y",(function(){return i})),n.d(t,"A",(function(){return o})),n.d(t,"z",(function(){return s})),n.d(t,"x",(function(){return l})),n.d(t,"w",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"t",(function(){return m})),n.d(t,"Y",(function(){return f})),n.d(t,"ab",(function(){return g})),n.d(t,"W",(function(){return b})),n.d(t,"X",(function(){return y})),n.d(t,"Z",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"O",(function(){return E})),n.d(t,"E",(function(){return x})),n.d(t,"F",(function(){return j})),n.d(t,"s",(function(){return O})),n.d(t,"k",(function(){return S})),n.d(t,"o",(function(){return w})),n.d(t,"hb",(function(){return k.U})),n.d(t,"m",(function(){return k.p})),n.d(t,"C",(function(){return k.u})),n.d(t,"r",(function(){return k.s})),n.d(t,"v",(function(){return k.t})),n.d(t,"n",(function(){return k.r})),n.d(t,"ob",(function(){return k.db})),n.d(t,"eb",(function(){return k.R})),n.d(t,"nb",(function(){return k.cb})),n.d(t,"cb",(function(){return k.P})),n.d(t,"db",(function(){return k.Q})),n.d(t,"qb",(function(){return k.fb})),n.d(t,"D",(function(){return k.v})),n.d(t,"fb",(function(){return k.S})),n.d(t,"kb",(function(){return k.Y})),n.d(t,"mb",(function(){return k.ab})),n.d(t,"lb",(function(){return k.Z})),n.d(t,"S",(function(){return k.I})),n.d(t,"R",(function(){return k.G})),n.d(t,"U",(function(){return k.K})),n.d(t,"T",(function(){return k.J})),n.d(t,"Q",(function(){return k.F})),n.d(t,"P",(function(){return k.E})),n.d(t,"bb",(function(){return k.O})),n.d(t,"a",(function(){return k.c})),n.d(t,"V",(function(){return k.L})),n.d(t,"gb",(function(){return k.T})),n.d(t,"b",(function(){return k.d})),n.d(t,"i",(function(){return k.m})),n.d(t,"l",(function(){return k.o})),n.d(t,"h",(function(){return k.l})),n.d(t,"f",(function(){return k.j})),n.d(t,"g",(function(){return k.k})),n.d(t,"d",(function(){return k.h})),n.d(t,"e",(function(){return k.i})),n.d(t,"c",(function(){return k.e})),n.d(t,"pb",(function(){return k.eb})),n.d(t,"jb",(function(){return k.X})),n.d(t,"ib",(function(){return k.V})),n.d(t,"G",(function(){return k.w})),n.d(t,"M",(function(){return k.C})),n.d(t,"K",(function(){return k.A})),n.d(t,"J",(function(){return k.z})),n.d(t,"L",(function(){return k.B})),n.d(t,"N",(function(){return k.D})),n.d(t,"H",(function(){return k.x})),n.d(t,"I",(function(){return k.y}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_title",{defaultMessage:"Create exceptions to this list"}),i=e=>a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_body",{values:{listName:e},defaultMessage:"There is no exception in your [{listName}]. Create rule exceptions to this list."}),o=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button_endpoint",{defaultMessage:"Create endpoint exception"}),s=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button",{defaultMessage:"Create rule exception"}),l=a.i18n.translate("xpack.securitySolution.exception.list.search_bar_button_enpoint",{defaultMessage:"Add endpoint exception to list"}),c=a.i18n.translate("xpack.securitySolution.exception.list.search_bar_button",{defaultMessage:"Add rule exception to list"}),u=(a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"})),d=a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),p=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),m=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessText",{values:{itemName:e},defaultMessage:'"{itemName}" deleted successfully.'}),f=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_cancel",{defaultMessage:"Cancel"}),g=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_save",{defaultMessage:"Save"}),b=a.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_header",{defaultMessage:"Link rules"}),y=a.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_overflow_button_title",{defaultMessage:"Link rules"}),h=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_description",{defaultMessage:"Link or unlink rules to this exception list."}),v=a.i18n.translate("xpack.securitySolution.exceptionsTable.deleteExceptionList",{defaultMessage:"Delete exception list"}),E=a.i18n.translate("xpack.securitySolution.exceptionsTable.exportExceptionList",{defaultMessage:"Export exception list"}),x=a.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesError",{defaultMessage:"Manage rules error"}),j=a.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesErrorDescription",{defaultMessage:"An error occurred linking or unlinking rules"}),O=a.i18n.translate("xpack.securitySolution.exceptionsTable.exportListDescription",{defaultMessage:"An error occurred exporting a list"}),S=a.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateExceptionList",{defaultMessage:"Duplicate exception list"}),w=a.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateListDescription",{defaultMessage:"An error occurred duplicating a list"});n(597);var k=n(777)},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"m",(function(){return m}));var a=n(44),r=n(128),i=n(1630),o=n(266),s=n(131),l=n(200),c=n(706);n.d(t,"e",(function(){return r.f})),n.d(t,"g",(function(){return r.h})),n.d(t,"f",(function(){return r.g})),n.d(t,"k",(function(){return r.l})),n.d(t,"j",(function(){return r.k})),n.d(t,"o",(function(){return r.q})),n.d(t,"n",(function(){return r.p})),n.d(t,"l",(function(){return r.m})),n.d(t,"h",(function(){return r.i})),n.d(t,"p",(function(){return r.v})),n.d(t,"q",(function(){return r.w})),n.d(t,"i",(function(){return r.j})),n.d(t,"a",(function(){return r.b})),n.d(t,"b",(function(){return r.d}));const u=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:a,timelineId:i,noProviderFound:o=l.b.noProviderFound,onAddedToTimeline:s})=>{const u=Object(r.o)(a),d=t[u];d?Object(c.b)({dataProviders:e,destination:a.destination,dispatch:n,onAddedToTimeline:s,providerToAdd:d,timelineId:i}):n(o({id:u}))},d={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},p=({browserFields:e,dispatch:t,result:n,scopeId:l,defaultsHeader:c})=>{var u;const p=Object(r.n)(n),m=(e=>Object(a.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[p],f=l!==i.b.alertsOnAlertsPage&&l!==i.b.alertsOnRuleDetailsPage||null===(u=c.find((e=>e.id===p)))||void 0===u?{}:u,g=Object(s.getScopedActions)(l);var b;null!=m&&g?t(g.upsertColumn({column:{columnHeaderType:"not-filtered",id:p,linkField:null!==(b=d[p])&&void 0!==b?b:void 0,type:m.type,aggregatable:m.aggregatable,initialWidth:o.a,...f},id:l,index:null!=n.destination?n.destination.index:0})):g&&t(g.upsertColumn({column:{columnHeaderType:"not-filtered",id:p,initialWidth:o.a},id:l,index:null!=n.destination?n.destination.index:0}))},m=e=>e.slice(e.lastIndexOf(".")+1)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(52),c=n.n(l),u=n(181),d=n(901),p=n(902);const m=s.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(o.css)(["height:","px;"],e)),(({border:e})=>e&&Object(o.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));m.displayName="Header";const f=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",g=({alignHeader:e,border:t,children:n,outerDirection:o="column",growLeftSplit:s=!0,headerFilters:l,height:g,hideSubtitle:b=!1,id:y,inspectMultiple:h=!1,inspectTitle:v,isInspectDisabled:E,showInspectButton:x=!0,split:j,stackHeader:O,subtitle:S,title:w,titleSize:k="l",toggleQuery:I,toggleStatus:T=!0,tooltip:C,tooltipTitle:M})=>{const _=Object(r.useCallback)((()=>{I&&I(!T)}),[I,T]),D=c()({"toggle-expand":T,siemHeaderSection:!0});return i.a.createElement(m,{"data-test-subj":"header-section",border:t,height:g,className:D,$hideSubtitle:b},i.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:o,gutterSize:"xs",responsive:!1},i.a.createElement(a.EuiFlexItem,{grow:s},i.a.createElement(a.EuiFlexGroup,{alignItems:f({alignHeader:e,stackHeader:O}),"data-test-subj":"headerSectionInnerFlexGroup",direction:O?"column":"row",gutterSize:"s"},i.a.createElement(a.EuiFlexItem,{grow:s,className:T?"":"no-margin"},i.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},i.a.createElement(a.EuiFlexItem,null,i.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},I&&i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":p.a(T),color:"text",display:"empty",iconType:T?"arrowDown":"arrowRight",onClick:_,size:"s",title:p.a(T)})),i.a.createElement(a.EuiFlexItem,null,i.a.createElement(a.EuiTitle,{size:k},i.a.createElement("h2",{"data-test-subj":"header-section-title"},i.a.createElement("span",{className:"eui-textBreakNormal"},w),C&&i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiIconTip,{color:"subdued",title:M,content:C,size:"l",type:"iInCircle"}))))))),y&&T&&i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(u.b,{isDisabled:E,queryId:y,multiple:h,showInspectButton:x,title:null!=v?v:w})),l&&T&&i.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),n&&T&&i.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!j},n))),!b&&T&&i.a.createElement(a.EuiFlexItem,null,i.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:S}))))},b=i.a.memo(g)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return p}));const a=100,r=1e4,i=[10,25,50,a,250,500],o={auto:-1,single:0,default:3},s="1.6em",l=370,c=212,u="kibana-json",d={border:"horizontal",fontSize:"s",cellPadding:"l",rowHover:"highlight",header:"underline",stripes:!0},p={showColumnSelector:{allowHide:!1,allowReorder:!0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),r=n.n(a),i=n(19),o=n(41),s=n.n(o),l=n(49),c=n(589),u=n(1259);const d=s.a.div.withConfig({displayName:"RiskBadge",componentId:"sc-169ah31-0"})(["",""],(({theme:e,$severity:t,$hideBackgroundColor:n})=>Object(o.css)(["width:fit-content;padding-right:",";padding-left:",";",";"],e.eui.euiSizeS,e.eui.euiSizeXS,("Critical"===t||"High"===t)&&!n&&Object(o.css)(["background-color:",";border-radius:999px;"],Object(i.transparentize)(e.eui.euiColorDanger,.2))))),p=s.a.div.withConfig({displayName:"TooltipContainer",componentId:"sc-169ah31-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),m=r.a.memo((({severity:e,hideBackgroundColor:t=!1,toolTipContent:n,"data-test-subj":a})=>null!=n?r.a.createElement(u.a,{hoverContent:r.a.createElement(p,null,n)},r.a.createElement(f,{severity:e,hideBackgroundColor:t,"data-test-subj":a})):r.a.createElement(f,{severity:e,hideBackgroundColor:t,"data-test-subj":a})));m.displayName="RiskScoreLevel";const f=r.a.memo((({severity:e,hideBackgroundColor:t=!1,"data-test-subj":n})=>r.a.createElement(d,{color:l.euiLightVars.euiColorDanger,$severity:e,$hideBackgroundColor:t,"data-test-subj":null!=n?n:"risk-score"},r.a.createElement(i.EuiTextColor,{color:"default"},r.a.createElement(i.EuiHealth,{className:"eui-alignMiddle",color:c.d[e]},e)))));f.displayName="RiskScoreBadge"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(19),r=n(4),i=n(42),o=n(2),s=n.n(o);const l=({count:e})=>{const[t,n,l]=Object(o.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),a={compactThousands:r.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:r.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:r.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:r.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},i=new Map([[1,""],[1e3,a.compactThousands],[1e6,a.compactMillions],[1e9,a.compactBillions],[1e12,a.compactTrillions]]),o=r.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),s=null!==(t=i.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),s,e/n%1>Number.EPSILON?o:""]}(e||0)),[e]);return null==e?null:0===e?s.a.createElement(s.a.Fragment,null,0):s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:s.a.createElement(a.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},c=s.a.memo(l)},,function(e,t,n){"use strict";n.d(t,"W",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"A",(function(){return c})),n.d(t,"B",(function(){return u})),n.d(t,"H",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"n",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"u",(function(){return v})),n.d(t,"v",(function(){return E})),n.d(t,"E",(function(){return x})),n.d(t,"k",(function(){return j})),n.d(t,"G",(function(){return O})),n.d(t,"F",(function(){return S})),n.d(t,"m",(function(){return w})),n.d(t,"l",(function(){return k})),n.d(t,"j",(function(){return I})),n.d(t,"p",(function(){return T})),n.d(t,"J",(function(){return C})),n.d(t,"o",(function(){return M})),n.d(t,"I",(function(){return _})),n.d(t,"z",(function(){return D})),n.d(t,"h",(function(){return N})),n.d(t,"w",(function(){return A})),n.d(t,"d",(function(){return F})),n.d(t,"a",(function(){return P})),n.d(t,"y",(function(){return R})),n.d(t,"x",(function(){return L})),n.d(t,"K",(function(){return q})),n.d(t,"L",(function(){return z})),n.d(t,"M",(function(){return B})),n.d(t,"D",(function(){return $})),n.d(t,"C",(function(){return V})),n.d(t,"N",(function(){return U})),n.d(t,"R",(function(){return G})),n.d(t,"P",(function(){return H})),n.d(t,"T",(function(){return W})),n.d(t,"Q",(function(){return Q})),n.d(t,"U",(function(){return Y})),n.d(t,"O",(function(){return K})),n.d(t,"S",(function(){return Z})),n.d(t,"V",(function(){return X}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.system.withResultDescription",{defaultMessage:"with result"}),i=a.i18n.translate("xpack.securitySolution.system.acceptedAConnectionViaDescription",{defaultMessage:"accepted a connection via"}),o=a.i18n.translate("xpack.securitySolution.system.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),s=a.i18n.translate("xpack.securitySolution.system.disconnectedViaDescription",{defaultMessage:"disconnected via"}),l=a.i18n.translate("xpack.securitySolution.system.loggedOutDescription",{defaultMessage:"logged out via"}),c=(a.i18n.translate("xpack.securitySolution.system.usingDescription",{defaultMessage:"using"}),a.i18n.translate("xpack.securitySolution.system.processStartedDescription",{defaultMessage:"started process"})),u=a.i18n.translate("xpack.securitySolution.system.processStoppedDescription",{defaultMessage:"stopped process"}),d=a.i18n.translate("xpack.securitySolution.system.terminatedProcessDescription",{defaultMessage:"terminated process"}),p=a.i18n.translate("xpack.securitySolution.system.createdFileDescription",{defaultMessage:"created a file"}),m=a.i18n.translate("xpack.securitySolution.system.deletedFileDescription",{defaultMessage:"deleted a file"}),f=a.i18n.translate("xpack.securitySolution.rowRenderer.executedProcessDescription",{defaultMessage:"executed process"}),g=a.i18n.translate("xpack.securitySolution.rowRenderer.forkedProcessDescription",{defaultMessage:"forked process"}),b=a.i18n.translate("xpack.securitySolution.rowRenderer.loadedLibraryDescription",{defaultMessage:"loaded library"}),y=a.i18n.translate("xpack.securitySolution.rowRenderer.madeAHttpRequestViaDescription",{defaultMessage:"made a http request via"}),h=a.i18n.translate("xpack.securitySolution.rowRenderer.modifiedFileDescription",{defaultMessage:"modified a file"}),v=a.i18n.translate("xpack.securitySolution.rowRenderer.modifiedRegistryKeyDescription",{defaultMessage:"modified registry key"}),E=a.i18n.translate("xpack.securitySolution.rowRenderer.overwroteFileDescription",{defaultMessage:"overwrote a file"}),x=a.i18n.translate("xpack.securitySolution.rowRenderer.renamedFileDescription",{defaultMessage:"renamed a file"}),j=a.i18n.translate("xpack.securitySolution.system.existingProcessDescription",{defaultMessage:"is running process"}),O=a.i18n.translate("xpack.securitySolution.system.socketOpenedDescription",{defaultMessage:"opened a socket with"}),S=a.i18n.translate("xpack.securitySolution.system.socketClosedDescription",{defaultMessage:"closed a socket with"}),w=a.i18n.translate("xpack.securitySolution.system.existingUserDescription",{defaultMessage:"is an existing user"}),k=a.i18n.translate("xpack.securitySolution.system.existingSocketDescription",{defaultMessage:"is using an existing socket from"}),I=a.i18n.translate("xpack.securitySolution.system.existingPackageDescription",{defaultMessage:"is using an existing package"}),T=a.i18n.translate("xpack.securitySolution.system.invalidDescription",{defaultMessage:"attempted invalid usage of"}),C=a.i18n.translate("xpack.securitySolution.system.userChangedDescription",{defaultMessage:"user has changed"}),M=a.i18n.translate("xpack.securitySolution.system.hostDescription",{defaultMessage:"host information"}),_=a.i18n.translate("xpack.securitySolution.system.userAddedDescription",{defaultMessage:"user was added"}),D=a.i18n.translate("xpack.securitySolution.system.processErrorDescription",{defaultMessage:"encountered a process error with"}),N=a.i18n.translate("xpack.securitySolution.system.errorDescription",{defaultMessage:"encountered an error with"}),A=a.i18n.translate("xpack.securitySolution.system.packageInstalledDescription",{defaultMessage:"installed package"}),F=a.i18n.translate("xpack.securitySolution.system.packageSystemStartedDescription",{defaultMessage:"system started"}),P=a.i18n.translate("xpack.securitySolution.system.acceptedDescription",{defaultMessage:"accepted the user via"}),R=a.i18n.translate("xpack.securitySolution.system.packageUpdatedDescription",{defaultMessage:"updated package"}),L=a.i18n.translate("xpack.securitySolution.system.packageRemovedDescription",{defaultMessage:"removed package"}),q=a.i18n.translate("xpack.securitySolution.system.userRemovedDescription",{defaultMessage:"was removed"}),z=a.i18n.translate("xpack.securitySolution.system.viaDescription",{defaultMessage:"via"}),B=a.i18n.translate("xpack.securitySolution.system.viaParentProcessDescription",{defaultMessage:"via parent process"}),$=a.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasPreventedFromeEcryptingFilesDescription",{defaultMessage:"ransomware was prevented from encrypting files"}),V=a.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasDetectedEcryptingFilesDescription",{defaultMessage:"ransomware was detected encrypting files"}),U=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedCreatingAMaliciousFileDescription",{defaultMessage:"was detected creating a malicious file"}),G=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromCreatingAMaliciousFileDescription",{defaultMessage:"was prevented from creating a malicious file"}),H=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedModifyingAMaliciousFileDescription",{defaultMessage:"was detected modifying a malicious file"}),W=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromModifyingAMaliciousFileDescription",{defaultMessage:"was prevented from modifying a malicious file"}),Q=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedRenamingAMaliciousFileDescription",{defaultMessage:"was detected renaming a malicious file"}),Y=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromRenamingAMaliciousFileDescription",{defaultMessage:"was prevented from renaming a malicious file"}),K=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedExecutingAMaliciousProcessDescription",{defaultMessage:"was detected executing a malicious process"}),Z=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromExecutingAMaliciousProcessDescription",{defaultMessage:"was prevented from executing a malicious process"}),X=a.i18n.translate("xpack.securitySolution.system.withExitCodeDescription",{defaultMessage:"with exit code"})},function(e,t,n){"use strict";n.d(t,"h",(function(){return Ee})),n.d(t,"b",(function(){return xe})),n.d(t,"f",(function(){return je})),n.d(t,"c",(function(){return Oe})),n.d(t,"d",(function(){return Se})),n.d(t,"g",(function(){return we})),n.d(t,"j",(function(){return ke})),n.d(t,"i",(function(){return Ie})),n.d(t,"a",(function(){return Te})),n.d(t,"e",(function(){return Ce})),n.d(t,"k",(function(){return It}));var a=n(44),r=n(2),i=n.n(r),o=n(121),s=n(19),l=n(150),c=n(278),u=n(134),d=n(317),p=n(836);const m=i.a.memo((({contextId:e,eventId:t,hostName:n,hostNameSeparator:a="@",isDraggable:r,userDomain:o,userDomainField:s="user.domain",userName:c,userNameField:d="user.name",workingDirectory:m})=>null!=c||null!=o||null!=n||null!=m?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:d,isDraggable:r,value:c,iconType:"user",fieldType:"keyword",isAggregatable:!0})),null!=o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{"data-test-subj":"user-host-working-dir-domain-separator-text",grow:!1,component:"span"},"\\"),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:s,isDraggable:r,value:o,fieldType:"keyword",isAggregatable:!0}))),null!=n&&null!=c&&i.a.createElement(l.c,{grow:!1,component:"span"},a),i.a.createElement(p.a,{contextId:e,eventId:t,hostName:n,isDraggable:r,workingDirectory:m})):null));m.displayName="UserHostWorkingDir";var f=n(4);const g=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.askedForDescription",{defaultMessage:"asked for"}),b=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.responseCodeDescription",{defaultMessage:"response code:"}),y=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.viaDescription",{defaultMessage:"via"}),h=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.whichResolvedToDescription",{defaultMessage:", which resolved to"}),v=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.withQuestionTypeDescription",{defaultMessage:"with question type"}),E=i.a.memo((({contextId:e,dnsQuestionName:t,dnsQuestionType:n,dnsResolvedIp:a,dnsResponseCode:r,eventCode:o,hostName:c,id:p,isDraggable:f,processExecutable:E,processName:x,processPid:j,userDomain:O,userName:S,winlogEventId:w})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:p,hostName:c,isDraggable:f,userDomain:O,userName:S,workingDirectory:void 0}),!Object(l.e)(t)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"asked-for",grow:!1},g),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.name",isDraggable:f,value:t,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"with-question-type",grow:!1},v),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.type",isDraggable:f,value:n,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"which-resolved-to",grow:!1},h),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.resolved_ip",isDraggable:f,value:a,isAggregatable:!0,fieldType:"ip"}))),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"response-code",grow:!1},b),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.response_code",isDraggable:f,value:r,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),i.a.createElement(l.c,{component:"span",grow:!1},y),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:p,isDraggable:f,processPid:j,processName:x,processExecutable:E})),(!Object(l.e)(o)||!Object(l.e)(w))&&i.a.createElement(i.a.Fragment,null,Object(l.e)(o)?i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,iconType:"logoWindows",field:"winlog.event_id",isDraggable:f,value:w,isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"event.code",isDraggable:f,value:o,isAggregatable:!0,fieldType:"number"})))))));E.displayName="DnsRequestEventDetailsLine";const x=i.a.memo((({data:e,contextId:t,isDraggable:n,timelineId:r})=>{const o=Object(a.get)("dns.question.name[0]",e),u=Object(a.get)("dns.question.type[0]",e),d=Object(a.get)("dns.resolved_ip[0]",e),p=Object(a.get)("dns.response_code[0]",e),m=Object(a.get)("event.code[0]",e),f=Object(a.get)("host.name[0]",e),g=e._id,b=Object(a.get)("process.executable[0]",e),y=Object(a.get)("process.name[0]",e),h=Object(a.get)("process.pid[0]",e),v=Object(a.get)("user.domain[0]",e),x=Object(a.get)("user.name[0]",e),j=Object(a.get)("winlog.event_id[0]",e);return i.a.createElement(l.b,null,i.a.createElement(E,{contextId:t,dnsQuestionName:o,dnsQuestionType:u,dnsResolvedIp:d,dnsResponseCode:p,eventCode:m,hostName:f,id:g,isDraggable:n,processExecutable:b,processName:y,processPid:h,userDomain:v,userName:x,winlogEventId:j}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:e,isDraggable:n,timelineId:r}))}));x.displayName="DnsRequestEventDetails";const j=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.aLoginWasAttemptedUsingExplicitCredentialsDescription",{defaultMessage:"A login was attempted using explicit credentials"}),O=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.asRequestedBySubjectDescription",{defaultMessage:"as requested by subject"}),S=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogInDescription",{defaultMessage:"failed to log in"}),w=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogOffDescription",{defaultMessage:"failed to log off"}),k=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.loggedOffDescription",{defaultMessage:"logged off"}),I=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeBatchDescription",{defaultMessage:"Batch"}),T=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeCachedInteractiveDescription",{defaultMessage:"Cached Interactive"}),C=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeInteractiveDescription",{defaultMessage:"Interactive"}),M=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkDescription",{defaultMessage:"Network"}),_=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkCleartextDescription",{defaultMessage:"Network Cleartext"}),D=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNewCredentialsDescription",{defaultMessage:"New Credentials"}),N=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeRemoteInteractiveDescription",{defaultMessage:"Remote Interactive"}),A=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeServiceDescription",{defaultMessage:"Service"}),F=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeUnlockDescription",{defaultMessage:"Unlock"}),P=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.subjectLogonIdDescription",{defaultMessage:"subject logon ID"}),R=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.successfullyLoggedInDescription",{defaultMessage:"successfully logged in"}),L=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.targetLogonIdDescription",{defaultMessage:"target logon ID"}),q=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.toDescription",{defaultMessage:"to"}),z=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.usingLogonTypeDescription",{defaultMessage:"using logon type"}),B=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.viaDescription",{defaultMessage:"via"}),$=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.withSpecialPrivilegesDescription",{defaultMessage:"With special privileges,"}),V=e=>{if(Object(l.e)(e))return"";switch(e){case 2:return C;case 3:return M;case 4:return I;case 5:return A;case 7:return F;case 8:return _;case 9:return D;case 10:return N;case 11:return T;default:return`${e}`}},U=e=>"explicit_user_logon"===e||"user_logoff"===e,G=i.a.memo((({contextId:e,endgameLogonType:t,endgameSubjectDomainName:n,endgameSubjectLogonId:a,endgameSubjectUserName:r,endgameTargetDomainName:o,endgameTargetLogonId:c,endgameTargetUserName:p,eventAction:f,eventCode:g,eventOutcome:b,hostName:y,id:h,isDraggable:v,processExecutable:E,processName:x,processPid:I,userDomain:T,userName:C,winlogEventId:M})=>{const _=U(f)?o:T,D=(({eventAction:e,eventOutcome:t})=>{switch(e){case"explicit_user_logon":return"";case"log_off":case"user_logoff":return"failure"===(null==t?void 0:t.toLowerCase())?w:k;default:return"failure"===(null==t?void 0:t.toLowerCase())?S:R}})({eventAction:f,eventOutcome:b}),N=(e=>"explicit_user_logon"===e?q:"@")(f),A=U(f)?p:C,F=(e=>U(e)?"endgame.target_domain_name":"user.domain")(f),G=(e=>U(e)?"endgame.target_user_name":"user.name")(f);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},"admin_logon"===f&&i.a.createElement(l.c,{component:"span","data-test-subj":"with-special-privileges",grow:!1},$),"explicit_user_logon"===f&&i.a.createElement(l.c,{component:"span","data-test-subj":"a-login-was-attempted",grow:!1},j),i.a.createElement(m,{contextId:e,eventId:h,hostName:y,hostNameSeparator:N,isDraggable:v,userDomain:_,userDomainField:F,userName:A,userNameField:G,workingDirectory:void 0}),i.a.createElement(l.c,{component:"span","data-test-subj":"event-details",grow:!1},D),!Object(l.e)(t)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},z),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.logon_type",isDraggable:v,queryValue:String(t),value:`${t} - ${V(t)}`,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(c)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},L),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.target_logon_id",isDraggable:v,value:c,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),i.a.createElement(l.c,{component:"span",grow:!1},B),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:h,isDraggable:v,processPid:I,processName:x,processExecutable:E})),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"as-requested-by-subject",grow:!1},O),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_user_name",isDraggable:v,iconType:"user",value:r,isAggregatable:!0,fieldType:"keyword"}))),null!=n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"subject-domain-name-domain-separator-text",grow:!1},"\\"),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_domain_name",isDraggable:v,value:n,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"subject-login-id",grow:!1},P),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_logon_id",isDraggable:v,value:a,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),(!Object(l.e)(g)||!Object(l.e)(M))&&i.a.createElement(i.a.Fragment,null,Object(l.e)(g)?i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,iconType:"logoWindows",field:"winlog.event_id",value:M,isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"event.code",value:g,isAggregatable:!0,fieldType:"keyword"})))))}));G.displayName="EndgameSecurityEventDetailsLine";const H=i.a.memo((({data:e,contextId:t,isDraggable:n,timelineId:r})=>{const o=Object(a.get)("endgame.logon_type[0]",e),u=Object(a.get)("endgame.subject_domain_name[0]",e),d=Object(a.get)("endgame.subject_logon_id[0]",e),p=Object(a.get)("endgame.subject_user_name[0]",e),m=Object(a.get)("endgame.target_logon_id[0]",e),f=Object(a.get)("endgame.target_domain_name[0]",e),g=Object(a.get)("endgame.target_user_name[0]",e),b=Object(a.get)("event.action[0]",e),y=Object(a.get)("event.code[0]",e),h=Object(a.get)("event.outcome[0]",e),v=Object(a.get)("host.name[0]",e),E=e._id,x=Object(a.get)("process.executable[0]",e),j=Object(a.get)("process.name[0]",e),O=Object(a.get)("process.pid[0]",e),S=Object(a.get)("user.domain[0]",e),w=Object(a.get)("user.name[0]",e),k=Object(a.get)("winlog.event_id[0]",e);return i.a.createElement(l.b,null,i.a.createElement(G,{contextId:t,endgameLogonType:o,endgameSubjectDomainName:u,endgameSubjectLogonId:d,endgameSubjectUserName:p,endgameTargetDomainName:f,endgameTargetLogonId:m,endgameTargetUserName:g,eventAction:b,eventCode:y,eventOutcome:h,hostName:v,id:E,isDraggable:n,processExecutable:x,processName:j,processPid:O,userDomain:S,userName:w,winlogEventId:k}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:e,timelineId:r}))}));H.displayName="EndgameSecurityEventDetails";const W=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.viaDescription",{defaultMessage:"via"}),Q=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.withNewValueDescription",{defaultMessage:"with new value"}),Y=({contextId:e,hostName:t,id:n,isDraggable:a,processName:o,processPid:c,registryKey:p,registryPath:f,text:g,userDomain:b,userName:y})=>{const h=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"registry.key"),i.a.createElement("div",null,p))),[p]),v=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"registry.path"),i.a.createElement("div",null,f))),[f]);return Object(l.e)(p)?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:n,hostName:t,isDraggable:a,userDomain:b,userName:y,workingDirectory:void 0}),!Object(l.e)(p)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"text",grow:!1},g),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:n,field:"registry.key",isDraggable:a,tooltipContent:h,value:p,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(f)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"with-new-value",grow:!1},Q),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:n,field:"registry.path",isDraggable:a,tooltipContent:v,value:f,isAggregatable:!0,fieldType:"keyword"}))),i.a.createElement(l.c,{component:"span",grow:!1},W),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:n,isDraggable:a,processPid:c,processName:o,processExecutable:void 0}))))},K=i.a.memo(Y),Z=({contextId:e,data:t,isDraggable:n,text:r})=>{const o=Object(a.get)("host.name[0]",t),s=t._id,c=Object(a.get)("process.name[0]",t),u=Object(a.get)("process.pid[0]",t),d=Object(a.get)("registry.key[0]",t),p=Object(a.get)("registry.path[0]",t),m=Object(a.get)("user.domain[0]",t),f=Object(a.get)("user.name[0]",t);return Object(l.e)(d)?null:i.a.createElement(l.b,null,i.a.createElement(K,{contextId:e,hostName:o,id:s,isDraggable:n,processName:c,processPid:u,registryKey:d,registryPath:p,text:r,userDomain:m,userName:f}))};Z.displayName="RegistryEventDetailsComponent";const X=i.a.memo(Z);var J=n(315),ee=n(485),te=n(230);const ne=i.a.memo((({contextId:e,eventId:t,isDraggable:n,packageName:a,packageSummary:r,packageVersion:o})=>null!=a||null!=r||null!=o?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:n,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:n,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.summary",isDraggable:n,value:r,isAggregatable:!0,fieldType:"keyword"}))):null));ne.displayName="Package";const ae=i.a.memo((({contextId:e,eventId:t,isDraggable:n,sshSignature:a,sshMethod:r})=>i.a.createElement(i.a.Fragment,null,null!=a&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:n,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),null!=r&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:n,value:r,iconType:"document",isAggregatable:!0,fieldType:"keyword"})))));ae.displayName="AuthSsh";var re=n(196);const ie=i.a.memo((({contextId:e,hostName:t,id:n,isDraggable:a,message:r,outcome:o,packageName:c,packageSummary:p,packageVersion:f,processPid:g,processName:b,processExecutable:y,sshSignature:h,sshMethod:v,text:E,userDomain:x,userName:j,workingDirectory:O})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:n,hostName:t,isDraggable:a,userDomain:x,userName:j,workingDirectory:O}),i.a.createElement(l.c,{grow:!1,component:"span"},E),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(d.a,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:n,isDraggable:a,processPid:g,processName:b,processExecutable:y})),null!=o&&i.a.createElement(l.c,{grow:!1,component:"span"},te.W),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"event.outcome",isDraggable:a,queryValue:o,value:o,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(ae,{contextId:e,eventId:n,isDraggable:a,sshSignature:h,sshMethod:v}),i.a.createElement(ne,{contextId:e,eventId:n,isDraggable:a,packageName:c,packageSummary:p,packageVersion:f})),null!=r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(re.b,{iconType:"editorComment",color:"hollow",title:""},i.a.createElement(ee.a,{value:r}))))))));ie.displayName="SystemGenericLine";const oe=i.a.memo((({contextId:e,data:t,isDraggable:n,text:r,timelineId:o})=>{const u=t._id,d=null!=t.message?t.message[0]:null,p=Object(a.get)("host.name[0]",t),m=Object(a.get)("user.domain[0]",t),f=Object(a.get)("user.name[0]",t),g=Object(a.get)("event.outcome[0]",t),b=Object(a.get)("system.audit.package.name[0]",t),y=Object(a.get)("system.audit.package.summary[0]",t),h=Object(a.get)("system.audit.package.version[0]",t),v=Object(a.get)("process.pid[0]",t),E=Object(a.get)("process.name[0]",t),x=Object(a.get)("process.executable[0]",t),j=Object(a.get)("system.auth.ssh.signature[0]",t),O=Object(a.get)("system.auth.ssh.method[0]",t),S=Object(a.get)("process.working_directory[0]",t);return i.a.createElement(l.b,null,i.a.createElement(ie,{contextId:e,hostName:p,id:u,isDraggable:n,message:d,outcome:g,packageName:b,packageSummary:y,packageVersion:h,processExecutable:x,processPid:v,processName:E,sshMethod:O,sshSignature:j,text:r,userDomain:m,userName:f,workingDirectory:S}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:t,isDraggable:n,timelineId:o}))}));oe.displayName="SystemGenericDetails";var se=n(593);const le=i.a.memo((({contextId:e,endgameExitCode:t,eventId:n,isDraggable:a,processExitCode:r,text:o})=>Object(l.e)(r)&&Object(l.e)(t)?null:i.a.createElement(i.a.Fragment,null,!Object(l.e)(o)&&i.a.createElement(l.c,{"data-test-subj":"exit-code-draggable-text",grow:!1,component:"span"},o),!Object(l.e)(r)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"process.exit_code",isDraggable:a,value:`${r}`,fieldType:"number",isAggregatable:!0})),!Object(l.e)(t)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.exit_code",isDraggable:a,value:t,fieldType:"number",isAggregatable:!0})))));le.displayName="ExitCodeDraggable";var ce=n(434);const ue=i.a.memo((({contextId:e,endgameFileName:t,endgameFilePath:n,eventId:a,fileExtOriginalPath:r,fileName:o,filePath:s,isDraggable:c})=>{if(Object(l.e)(o)&&Object(l.e)(t)&&Object(l.e)(s)&&Object(l.e)(n))return null;const d=!Object(l.e)(s)||!Object(l.e)(n);return i.a.createElement(i.a.Fragment,null,Object(l.e)(o)?Object(l.e)(t)?null:i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.file_name",isDraggable:c,value:t,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"file.name",isDraggable:c,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),d&&i.a.createElement(l.c,{"data-test-subj":"in",grow:!1,component:"span"},ce.e),Object(l.e)(s)?Object(l.e)(n)?null:i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.file_path",isDraggable:c,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"file.path",isDraggable:c,value:s,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},ce.d),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"file.Ext.original.path",isDraggable:c,value:r,iconType:"document",isAggregatable:!0,fieldType:"keyword"}))))}));ue.displayName="FileDraggable";var de=n(41),pe=n.n(de);const me=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-ezi1kd-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),fe=i.a.memo((({contextId:e,eventId:t,fileHashSha256:n,isDraggable:a})=>Object(l.e)(n)?null:i.a.createElement(me,{alignItems:"center",direction:"column",gutterSize:"none"},i.a.createElement(l.c,{grow:!1,component:"div"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"file.hash.sha256",isDraggable:a,iconType:"number",value:n,isAggregatable:!0,fieldType:"keyword"})))));fe.displayName="FileHash";const ge=i.a.memo((({contextId:e,endgameParentProcessName:t,eventId:n,isDraggable:a,processParentName:r,processParentPid:o,processPpid:s,text:c})=>Object(l.e)(r)&&Object(l.e)(t)?null:i.a.createElement(i.a.Fragment,null,!Object(l.e)(c)&&i.a.createElement(l.c,{"data-test-subj":"parent-process-draggable-text",grow:!1,component:"span"},c),!Object(l.e)(r)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"process.parent.name",isDraggable:a,value:r,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(t)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.parent_process_name",isDraggable:a,value:t,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(o)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"process.parent.pid",isDraggable:a,queryValue:String(o),value:`(${String(o)})`,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(s)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"process.ppid",isDraggable:a,queryValue:String(s),value:`(${String(s)})`,fieldType:"keyword",isAggregatable:!0})))));ge.displayName="ParentProcessDraggable";const be=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-joyfnh-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ye=i.a.memo((({contextId:e,eventId:t,isDraggable:n,processHashSha256:a})=>Object(l.e)(a)?null:i.a.createElement(be,{alignItems:"center",direction:"column",gutterSize:"none"},i.a.createElement(l.c,{grow:!1,component:"div"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"process.hash.sha256",iconType:"number",isDraggable:n,value:a,fieldType:"keyword",isAggregatable:!0})))));ye.displayName="ProcessHash";const he=i.a.memo((({args:e,contextId:t,endgameExitCode:n,endgameFileName:a,endgameFilePath:r,endgameParentProcessName:o,endgamePid:c,endgameProcessName:p,eventAction:f,fileExtOriginalPath:g,fileHashSha256:b,fileName:y,filePath:h,hostName:v,id:E,isDraggable:x,message:j,outcome:O,packageName:S,processParentName:w,processParentPid:k,processExitCode:I,packageSummary:T,packageVersion:C,processExecutable:M,processHashSha256:_,processName:D,processPid:N,processPpid:A,processTitle:F,showMessage:P,skipRedundantFileDetails:R=!1,skipRedundantProcessDetails:L=!1,sshSignature:q,sshMethod:z,text:B,userDomain:$,userName:V,workingDirectory:U})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{eventId:E,contextId:t,isDraggable:x,userDomain:$,userName:V,workingDirectory:U,hostName:v}),i.a.createElement(l.c,{grow:!1,component:"span"},B),!R&&i.a.createElement(ue,{contextId:t,endgameFileName:a,endgameFilePath:r,eventId:E,fileExtOriginalPath:g,fileName:y,filePath:h,isDraggable:x}),Object(l.g)(f)&&i.a.createElement(l.c,{"data-test-subj":"via",grow:!1,component:"span"},te.L),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(d.b,{contextId:t,endgamePid:c,endgameProcessName:p,eventId:E,isDraggable:x,processPid:N,processName:D,processExecutable:M})),i.a.createElement(se.a,{args:e,contextId:t,eventId:E,processTitle:F,isDraggable:x}),i.a.createElement(le,{contextId:t,endgameExitCode:n,eventId:E,isDraggable:x,processExitCode:I,text:te.V}),!Object(l.f)(f)&&i.a.createElement(ge,{contextId:t,endgameParentProcessName:o,eventId:E,isDraggable:x,processParentName:w,processParentPid:k,processPpid:A,text:te.M}),null!=O&&i.a.createElement(l.c,{grow:!1,component:"span"},te.W),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:t,eventId:E,field:"event.outcome",isDraggable:x,queryValue:O,value:O,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(ae,{contextId:t,eventId:E,isDraggable:x,sshSignature:q,sshMethod:z}),i.a.createElement(ne,{contextId:t,eventId:E,isDraggable:x,packageName:S,packageSummary:T,packageVersion:C})),!R&&i.a.createElement(fe,{contextId:t,eventId:E,fileHashSha256:b,isDraggable:x}),!L&&i.a.createElement(ye,{contextId:t,eventId:E,isDraggable:x,processHashSha256:_}),null!=j&&P&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(re.b,{iconType:"editorComment",color:"hollow",title:""},i.a.createElement(ee.a,{value:j}))))))));he.displayName="SystemGenericFileLine";const ve=i.a.memo((({contextId:e,data:t,isDraggable:n,showMessage:r=!0,skipRedundantFileDetails:o=!1,skipRedundantProcessDetails:u=!1,text:d,timelineId:p})=>{const m=t._id,f=null!=t.message?t.message[0]:null,g=Object(a.get)("host.name[0]",t),b=Object(a.get)("endgame.exit_code[0]",t),y=Object(a.get)("endgame.file_name[0]",t),h=Object(a.get)("endgame.file_path[0]",t),v=Object(a.get)("endgame.parent_process_name[0]",t),E=Object(a.get)("endgame.pid[0]",t),x=Object(a.get)("endgame.process_name[0]",t),j=Object(a.get)("event.action[0]",t),O=Object(a.get)("file.Ext.original.path[0]",t),S=Object(a.get)("file.hash.sha256[0]",t),w=Object(a.get)("file.name[0]",t),k=Object(a.get)("file.path[0]",t),I=Object(a.get)("user.domain[0]",t),T=Object(a.get)("user.name[0]",t),C=Object(a.get)("event.outcome[0]",t),M=Object(a.get)("system.audit.package.name[0]",t),_=Object(a.get)("system.audit.package.summary[0]",t),D=Object(a.get)("system.audit.package.version[0]",t),N=Object(a.get)("process.exit_code[0]",t),A=Object(a.get)("process.parent.name[0]",t),F=Object(a.get)("process.parent.pid[0]",t),P=Object(a.get)("process.hash.sha256[0]",t),R=Object(a.get)("process.pid[0]",t),L=Object(a.get)("process.ppid[0]",t),q=Object(a.get)("process.name[0]",t),z=Object(a.get)("system.auth.ssh.signature[0]",t),B=Object(a.get)("system.auth.ssh.method[0]",t),$=Object(a.get)("process.executable[0]",t),V=Object(a.get)("process.title[0]",t),U=Object(a.get)("process.working_directory[0]",t),G=Object(a.get)("process.args",t);return i.a.createElement(l.b,null,i.a.createElement(he,{id:m,contextId:e,text:d,hostName:g,endgameExitCode:b,endgameFileName:y,endgameFilePath:h,endgameParentProcessName:v,endgamePid:E,endgameProcessName:x,eventAction:j,fileExtOriginalPath:O,fileHashSha256:S,fileName:w,filePath:k,userDomain:I,userName:T,message:f,processExitCode:N,processParentName:A,processParentPid:F,processTitle:V,workingDirectory:U,args:G,packageName:M,packageSummary:_,packageVersion:D,processHashSha256:P,processName:q,processPid:R,processPpid:L,processExecutable:$,showMessage:r,skipRedundantFileDetails:o,skipRedundantProcessDetails:u,sshSignature:z,sshMethod:B,outcome:C,isDraggable:n}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:t,isDraggable:n,timelineId:p}))}));ve.displayName="SystemGenericFileDetails";const Ee=({actionName:e,text:t})=>({id:o.e.system,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),r=Object(a.get)("event.action[0]",t);return null!=n&&"system"===n.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(oe,{contextId:`${e}-${r}`,data:n,isDraggable:a,text:t,timelineId:r}))}),xe=({actionName:e,text:t})=>({id:o.e.system_file,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),r=Object(a.get)("event.category[0]",t),i=Object(a.get)("event.dataset[0]",t);return("process"===(null==r?void 0:r.toLowerCase())||"endpoint.events.process"===(null==i?void 0:i.toLowerCase()))&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{data:n,contextId:`endgame-process-${e}-${r}`,isDraggable:a,showMessage:!1,text:t,timelineId:r}))}),je=({actionName:e,text:t})=>({id:o.e.system_fim,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),r=Object(a.get)("event.category[0]",t),i=Object(a.get)("event.dataset[0]",t);return Object(l.d)({eventCategory:r,eventDataset:i})&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{data:n,contextId:`fim-${e}-${r}`,isDraggable:a,showMessage:!1,text:t,timelineId:r}))}),Oe=({eventAction:e,eventCategory:t,eventType:n,skipRedundantFileDetails:r=!1,skipRedundantProcessDetails:s=!1,text:l})=>({id:o.e.alerts,isInstance:r=>{var i,o,s;const l=Object(a.get)("event.action",r),c=Object(a.get)("event.category",r),u=Object(a.get)("event.dataset[0]",r),d=Object(a.get)("event.type",r),p=null!==(i=null==l?void 0:l.includes(e))&&void 0!==i&&i,m=null!==(o=null==c?void 0:c.includes(t))&&void 0!==o&&o,f=null!==(s=null==d?void 0:d.includes(n))&&void 0!==s&&s;return"endpoint.alerts"===(null==u?void 0:u.toLowerCase())&&f&&m&&p},renderRow:({data:a,isDraggable:o,scopeId:c})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`endpoint-alerts-row-renderer-${e}-${t}-${n}-${c}`,data:a,isDraggable:o,showMessage:!1,skipRedundantFileDetails:r,skipRedundantProcessDetails:s,text:l,timelineId:c}))}),Se=({actionName:e,text:t})=>({id:o.e.library,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),r=Object(a.get)("event.dataset[0]",t);return"endpoint.events.library"===(null==r?void 0:r.toLowerCase())&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`library-row-renderer-${e}-${r}`,data:n,isDraggable:a,showMessage:!1,text:t,timelineId:r}))}),we=({actionName:e,text:t})=>({id:o.e.system_file,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),r=Object(a.get)("event.action[0]",t);return null!=n&&"system"===n.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`${e}-${r}`,data:n,isDraggable:a,text:t,timelineId:r}))}),ke=({actionName:e,text:t})=>({id:o.e.system_socket,isInstance:t=>{const n=Object(a.get)("event.action[0]",t);return null!=n&&n.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`socket-${e}-${r}`,data:n,isDraggable:a,text:t,timelineId:r}))}),Ie=({actionName:e})=>({id:o.e.system_security_event,isInstance:t=>{const n=Object(a.get)("event.category[0]",t),r=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.dataset[0]",t);return("authentication"===(null==n?void 0:n.toLowerCase())||"endpoint.events.security"===(null==i?void 0:i.toLowerCase()))&&(null==r?void 0:r.toLowerCase())===e},renderRow:({data:t,isDraggable:n,scopeId:a})=>i.a.createElement(J.a,null,i.a.createElement(H,{contextId:`authentication-${e}-${a}`,data:t,isDraggable:n,timelineId:a}))}),Te=()=>({id:o.e.system_dns,isInstance:e=>{const t=Object(a.get)("dns.question.type[0]",e),n=Object(a.get)("dns.question.name[0]",e);return!Object(l.e)(t)&&!Object(l.e)(n)},renderRow:({data:e,isDraggable:t,scopeId:n})=>i.a.createElement(J.a,null,i.a.createElement(x,{contextId:`dns-request-${n}`,data:e,isDraggable:t,timelineId:n}))}),Ce=({actionName:e,text:t})=>({id:o.e.registry,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),r=Object(a.get)("event.dataset[0]",t);return"endpoint.events.registry"===(null==r?void 0:r.toLowerCase())&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:e,isDraggable:n,scopeId:a})=>i.a.createElement(J.a,null,i.a.createElement(X,{contextId:`registry-event-${a}`,data:e,isDraggable:n,text:t}))}),Me=Ee({actionName:"user_login",text:te.c}),_e=we({actionName:"process_started",text:te.A}),De=xe({actionName:"creation_event",text:te.A}),Ne=xe({actionName:"start",text:te.A}),Ae=Ce({actionName:"modification",text:te.u}),Fe=we({actionName:"process_stopped",text:te.B}),Pe=xe({actionName:"termination_event",text:te.H}),Re=xe({actionName:"end",text:te.H}),Le=je({actionName:"file_create_event",text:te.e}),qe=je({actionName:"creation",text:te.e}),ze=je({actionName:"created",text:te.e}),Be=je({actionName:"file_delete_event",text:te.f}),$e=je({actionName:"deletion",text:te.f}),Ve=je({actionName:"modification",text:te.t}),Ue=je({actionName:"overwrite",text:te.v}),Ge=je({actionName:"rename",text:te.E}),He=je({actionName:"deleted",text:te.f}),We=we({actionName:"existing_process",text:te.k}),Qe=[{eventAction:"creation",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.R},{eventAction:"creation",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.N},{eventAction:"files-encrypted",eventCategory:"file",eventType:"denied",skipRedundantFileDetails:!0,text:te.D},{eventAction:"files-encrypted",eventCategory:"file",eventType:"allowed",skipRedundantFileDetails:!0,text:te.C},{eventAction:"modification",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.T},{eventAction:"modification",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.P},{eventAction:"rename",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.U},{eventAction:"rename",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.Q},{eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:te.S},{eventAction:"execution",eventCategory:"process",eventType:"allowed",skipRedundantFileDetails:!0,text:te.O}].map((e=>Oe(e))),Ye=Se({actionName:"load",text:te.q}),Ke=ke({actionName:"socket_opened",text:te.G}),Ze=ke({actionName:"socket_closed",text:te.F}),Xe=ke({actionName:"ipv4_connection_accept_event",text:te.b}),Je=ke({actionName:"connection_accepted",text:te.b}),et=ke({actionName:"http_request",text:te.s}),tt=xe({actionName:"exec",text:te.i}),nt=xe({actionName:"fork",text:te.n}),at=ke({actionName:"ipv6_connection_accept_event",text:te.b}),rt=ke({actionName:"ipv4_disconnect_received_event",text:te.g}),it=ke({actionName:"disconnect_received",text:te.g}),ot=ke({actionName:"ipv6_disconnect_received_event",text:te.g}),st=Ie({actionName:"admin_logon"}),lt=Ie({actionName:"explicit_user_logon"}),ct=Ie({actionName:"user_logoff"}),ut=Ie({actionName:"user_logon"}),dt=Ie({actionName:"log_on"}),pt=Te(),mt=Ee({actionName:"existing_user",text:te.m}),ft=we({actionName:"existing_socket",text:te.l}),gt=Ee({actionName:"existing_package",text:te.j}),bt=we({actionName:"invalid",text:te.p}),yt=Ee({actionName:"user_changed",text:te.J}),ht=Ee({actionName:"host",text:te.o}),vt=Ee({actionName:"user_added",text:te.I}),Et=Ee({actionName:"user_logout",text:te.r}),xt=Ie({actionName:"log_off"}),jt=we({actionName:"process_error",text:te.z}),Ot=Ee({actionName:"error:",text:te.h}),St=Ee({actionName:"error",text:te.h}),wt=Ee({actionName:"package_installed",text:te.w}),kt=Ee({actionName:"boot",text:te.d}),It=[pt,st,lt,Le,qe,Be,$e,Ue,Ge,...Qe,Ye,Ve,Ae,Xe,Je,et,tt,nt,at,rt,it,ot,De,Ne,Pe,Re,ct,ut,dt,ze,He,Ee({actionName:"accepted",text:te.a}),kt,St,Ot,gt,We,ft,mt,ht,bt,Me,Et,xt,wt,Ee({actionName:"package_updated",text:te.y}),Ee({actionName:"package_removed",text:te.x}),jt,_e,Fe,Ze,Ke,vt,yt,Ee({actionName:"user_removed",text:te.K})]},function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return z})),n.d(t,"d",(function(){return $})),n.d(t,"e",(function(){return X})),n.d(t,"g",(function(){return ne.b})),n.d(t,"f",(function(){return ne.a}));var a=n(120);const r=a.enum(["true","false"]).or(a.boolean()).transform((e=>"boolean"==typeof e?e:"true"===e));var i=n(176),o=n(199);const s=a.z.literal("RULE_NOT_MODIFIED"),l=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:s}),c=a.z.object({id:a.z.string(),name:a.z.string().optional()}),u=a.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN","MANUAL_RULE_RUN_FEATURE","MANUAL_RULE_RUN_DISABLED_RULE"]),d=(u.enum,a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:u.optional(),rules:a.z.array(c)})),p=a.z.object({updated:a.z.array(i.e),created:a.z.array(i.e),deleted:a.z.array(i.e),skipped:a.z.array(l)}),m=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),f=a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),rules_count:a.z.number().int().optional(),attributes:a.z.object({results:p,summary:m,errors:a.z.array(d).optional()})}),g=a.z.string(),b=a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()}),y=b.merge(a.z.object({action:a.z.literal("delete")})),h=b.merge(a.z.object({action:a.z.literal("disable")})),v=b.merge(a.z.object({action:a.z.literal("enable")})),E=b.merge(a.z.object({action:a.z.literal("export")})),x=b.merge(a.z.object({action:a.z.literal("duplicate"),duplicate:a.z.object({include_exceptions:a.z.boolean(),include_expired_exceptions:a.z.boolean()}).optional()})),j=b.merge(a.z.object({action:a.z.literal("run"),run:a.z.object({start_date:a.z.string(),end_date:a.z.string().optional()})})),O=a.z.enum(["rule","1h","1d","7d"]),S=(O.enum,a.z.enum(["enable","disable","export","delete","duplicate","edit","run"]).enum),w=a.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule","add_investigation_fields","delete_investigation_fields","set_investigation_fields"]).enum,k=a.z.object({group:o.w,id:o.x,params:o.y,frequency:o.v.optional(),alerts_filter:o.u.optional()}).strict(),I=a.z.object({type:a.z.enum(["add_rule_actions","set_rule_actions"]),value:a.z.object({throttle:O.optional(),actions:a.z.array(k)})}),T=a.z.object({type:a.z.literal("set_schedule"),value:a.z.object({interval:a.z.string().regex(/^[1-9]\d*[smh]$/),lookback:a.z.string().regex(/^[1-9]\d*[smh]$/)})}),C=a.z.object({type:a.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:o.h,overwrite_data_views:a.z.boolean().optional()}),M=a.z.object({type:a.z.enum(["add_tags","delete_tags","set_tags"]),value:o.R}),_=a.z.object({type:a.z.enum(["add_investigation_fields","delete_investigation_fields","set_investigation_fields"]),value:o.i}),D=a.z.object({type:a.z.literal("set_timeline"),value:a.z.object({timeline_id:o.bb,timeline_title:o.cb})}),N=a.z.union([M,C,_,D,I,T]),A=b.merge(a.z.object({action:a.z.literal("edit"),edit:a.z.array(N).min(1)}));a.z.object({dry_run:r.optional()}),a.z.union([y,h,v,E,x,j,A]),a.z.union([f,g]);var F=n(374);a.z.array(a.z.union([i.e,F.a])),a.z.array(i.c),a.z.array(a.z.object({id:o.M.optional(),rule_id:o.P.optional()})),a.z.array(i.d),a.z.array(i.f);var P=n(46),R=n(2074),L=n(1371),q=n(2072);let z=function(e){return e.Enabled="enabled",e.Disabled="disabled",e}({});const B=Object(R.a)("CoverageOverviewRuleActivity",z);let $=function(e){return e.Prebuilt="prebuilt",e.Custom="custom",e}({});const V=Object(R.a)("CoverageOverviewRuleSource",$),U=P.partial({search_term:L.a,activity:Object(q.a)(B),source:Object(q.a)(V)}),G=(P.exact(P.partial({filter:U})),P.type({name:P.string,activity:B})),H=(P.exact(P.type({coverage:P.record(P.string,Object(q.a)(P.string)),unmapped_rule_ids:P.array(P.string),rules_data:P.record(P.string,G)})),i.c,i.e,a.z.object({id:o.M.optional(),rule_id:o.P.optional()}),i.e,i.d,i.e,a.z.object({id:o.M.optional(),rule_id:o.P.optional()}),i.e,i.f,i.e,{exported_exception_list_count:P.number,exported_exception_list_item_count:P.number,missing_exception_list_item_count:P.number,missing_exception_list_items:P.array(P.exact(P.type({item_id:L.a}))),missing_exception_lists:P.array(P.exact(P.type({list_id:L.a}))),missing_exception_lists_count:P.number}),W=(P.exact(P.type(H)),{exported_count:P.number,exported_rules_count:P.number,missing_rules:P.array(P.exact(P.type({rule_id:L.a}))),missing_rules_count:P.number}),Q=P.intersection([P.exact(P.type({id:L.a,type:L.a})),P.exact(P.partial({reason:P.string}))]),Y={exported_action_connector_count:P.number,missing_action_connection_count:P.number,missing_action_connections:P.array(P.exact(P.type({id:L.a,type:L.a}))),excluded_action_connection_count:P.number,excluded_action_connections:P.array(Q)};P.intersection([P.exact(P.type(W)),P.exact(P.partial(H)),P.exact(P.partial(Y))]),a.z.object({exclude_export_details:r.optional().default(!1),file_name:a.z.string().optional().default("export.ndjson")}),a.z.object({objects:a.z.array(a.z.object({rule_id:o.P}))}).nullable();var K=n(1449),Z=n(330);const X=a.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);X.enum,a.z.object({fields:Object(K.a)(a.z.string()).optional(),filter:a.z.string().optional(),sort_field:X.optional(),sort_order:Z.a.optional(),page:a.z.coerce.number().int().min(1).optional().default(1),per_page:a.z.coerce.number().int().min(0).optional().default(20)}),a.z.object({page:a.z.number().int(),perPage:a.z.number().int(),total:a.z.number().int(),data:a.z.array(i.e)});var J=n(2075);P.exact(P.type({rules_summary:P.type({custom_count:J.a,prebuilt_installed_count:J.a}),aggregated_fields:P.type({tags:P.array(P.string)})}));var ee=n(472);a.z.object({overwrite:r.optional().default(!1),overwrite_exceptions:r.optional().default(!1),overwrite_action_connectors:r.optional().default(!1),as_new_list:r.optional().default(!1)}),a.z.object({exceptions_success:a.z.boolean(),exceptions_success_count:a.z.number().int().min(0),exceptions_errors:a.z.array(F.a),rules_count:a.z.number().int().min(0),success:a.z.boolean(),success_count:a.z.number().int().min(0),errors:a.z.array(F.a),action_connectors_errors:a.z.array(F.a),action_connectors_warnings:a.z.array(ee.a),action_connectors_success:a.z.boolean(),action_connectors_success_count:a.z.number().int().min(0)}).strict();var te=n(290);te.b.and(te.g).and(te.d.partial().extend({rule_id:te.e,immutable:a.literal(!1).default(!1),required_fields:a.array(te.c).optional()})),o.R;var ne=n(473)},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var a=n(0),r=n.n(a);let i=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),o=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){r()(this,"name",void 0),r()(this,"sortable",void 0),r()(this,"filterable",void 0),r()(this,"esTypes",void 0),this.name=e.name||o.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}const s=new kbn_field_type_KbnFieldType({name:o.UNKNOWN}),l=[new kbn_field_type_KbnFieldType({name:o.STRING,sortable:!0,filterable:!0,esTypes:[i.STRING,i.TEXT,i.MATCH_ONLY_TEXT,i.KEYWORD,i.VERSION,i._TYPE,i._ID]}),new kbn_field_type_KbnFieldType({name:o.NUMBER,sortable:!0,filterable:!0,esTypes:[i.FLOAT,i.HALF_FLOAT,i.SCALED_FLOAT,i.DOUBLE,i.INTEGER,i.LONG,i.UNSIGNED_LONG,i.SHORT,i.BYTE,i.TOKEN_COUNT,i.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:o.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[i.FLOAT_RANGE,i.DOUBLE_RANGE,i.INTEGER_RANGE,i.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:o.DATE,sortable:!0,filterable:!0,esTypes:[i.DATE,i.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:o.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[i.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:o.IP,sortable:!0,filterable:!0,esTypes:[i.IP]}),new kbn_field_type_KbnFieldType({name:o.IP_RANGE,sortable:!0,filterable:!0,esTypes:[i.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:o.BOOLEAN,sortable:!0,filterable:!0,esTypes:[i.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:o.OBJECT,esTypes:[i.OBJECT]}),new kbn_field_type_KbnFieldType({name:o.NESTED,esTypes:[i.NESTED]}),new kbn_field_type_KbnFieldType({name:o.GEO_POINT,esTypes:[i.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:o.GEO_SHAPE,esTypes:[i.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:o.ATTACHMENT,esTypes:[i.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:o.MURMUR3,esTypes:[i.MURMUR3]}),new kbn_field_type_KbnFieldType({name:o._SOURCE,esTypes:[i._SOURCE]}),new kbn_field_type_KbnFieldType({name:o.HISTOGRAM,filterable:!0,esTypes:[i.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:o.CONFLICT}),s],c=e=>{const t=l.find((t=>t.esTypes.includes(e)));return t&&t.name?t.name:o.UNKNOWN};function u(e){switch(e){case i._INDEX:return o.STRING;case"_version":return o.NUMBER;case"datetime":return o.DATE;default:return c(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s}));const a="kibana.alert.ancestors.id",r="kibana.alert.rule.indices",i="process.entry_leader.entity_id",o="process.entry_leader.start",s="kibana.alert.ancestors.index"},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(119),r=n.n(a),i=n(52),o=n.n(i),s=n(2),l=n.n(s),c=n(41),u=n.n(c),d=n(206),p=n(196);const m=u.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1kulm59-0"})(["&.securitySolutionWrapper--fullHeight{height:100%;display:flex;flex-direction:column;flex:1 1 auto;}&.securitySolutionWrapper--noPadding{padding:0;display:flex;flex-direction:column;flex:1 1 auto;}"]);m.displayName="Wrapper";const f=({children:e,className:t,style:n,noPadding:a,noTimeline:i,...c})=>{const{globalFullScreen:u,setGlobalFullScreen:f}=Object(d.a)();Object(s.useEffect)((()=>{f(!1)}),[f]);const g=o()(t,{securitySolutionWrapper:!0,"securitySolutionWrapper--noPadding":a,"securitySolutionWrapper--withTimeline":!i,"securitySolutionWrapper--fullHeight":u});return l.a.createElement(m,r()({className:g,style:n},c),e,l.a.createElement(p.a,null))},g=l.a.memo(f)},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(475);let r=function(e){return e.DEFAULT="security-default-cellActions",e.DETAILS_FLYOUT="security-detailsFlyout-cellActions",e.ALERTS_COUNT="security-alertsCount-cellActions",e}({}),i=function(e){return e.HISTOGRAM_TRIGGER="security-discoverInTimeline-histogramTrigger",e}({}),o=function(e){return e.VIS_FILTER_ACTION="security-discoverInTimeline-visFilterAction",e}({}),s=function(e){return e.FILTER="security-cellAction-type-filter",e.COPY="security-cellAction-type-copyToClipboard",e.ADD_TO_TIMELINE="security-cellAction-type-addToTimeline",e.INVESTIGATE_IN_NEW_TIMELINE="security-cellAction-type-investigateInNewTimeline",e.SHOW_TOP_N="security-cellAction-type-showTopN",e.TOGGLE_COLUMN="security-cellAction-type-toggleColumn",e}({});const l={FILTER:a.c,COPY:a.a}},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"o",(function(){return v}));var a=n(4),r=n(264);n.d(t,"p",(function(){return r.d}));const i=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.feedNamePreposition",{defaultMessage:"from"}),o=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTitle",{defaultMessage:"Threat match detected"}),s=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTitle",{defaultMessage:"Enriched with threat intelligence"}),l=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTooltipContent",{defaultMessage:"Shows available threat indicator matches."}),c=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTooltipContent",{defaultMessage:"Shows additional threat intelligence for the alert. The past 30 days were queried by default."}),u=(a.i18n.translate("xpack.securitySolution.alertDetails.noInvestigationEnrichmentsDescription",{defaultMessage:"This alert does not have supplemental threat intelligence data."}),a.i18n.translate("xpack.securitySolution.alertDetails.noEnrichmentsFoundDescription",{defaultMessage:"This alert does not have threat intelligence."})),d=a.i18n.translate("xpack.securitySolution.alertDetails.investigationTimeQueryTitle",{defaultMessage:"Enrichment with Threat Intelligence"}),p=a.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryStartDate",{defaultMessage:"Start date"}),m=a.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryEndDate",{defaultMessage:"End date"}),f=a.i18n.translate("xpack.securitySolution.alertDetails.refresh",{defaultMessage:"Refresh"}),g=a.i18n.translate("xpack.securitySolution.alertDetails.overview.enrichedDataTitle",{defaultMessage:"Enriched data"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentObjectValuesNotRendered",{defaultMessage:"This field contains nested object values, which are not rendered here. See the full document for all fields/values"}),y=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskLevel",{defaultMessage:"Current {riskEntity} risk level",values:{riskEntity:Object(r.e)(e,!0)}}),h=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.originalHostRiskLevel",{defaultMessage:"Original {riskEntity} risk level",values:{riskEntity:Object(r.e)(e,!0)}}),v=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskDataTitle",{defaultMessage:"{riskEntity} Risk Data",values:{riskEntity:Object(r.e)(e)}})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(894);const i=()=>Object(a.useContext)(r.a)},function(e,t,n){"use strict";var a=n(463);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));let a=function(e){return e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions",e}({}),r=function(e){return e.IndexPatterns="indexPatterns",e.DataView="dataView",e}({}),i=function(e){return e.PerRuleExecution="per-rule-execution",e.PerTimePeriod="per-time-period",e}({})},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1),t=a.useCallback((function(){return e.current}),[]);return a.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var a=n(44),r=n(395),i=n.n(r),o=n(2),s=n(118),l=n(512),c=n(294),u=n(123);const d=e=>Object(a.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),p=i()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(a.pick)(["name","searchable","type","aggregatable","esTypes","subType","conflictDescriptions"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),m={},f={fields:[],title:""},g=(e,t=!1,n="indexFields")=>{const{data:r}=Object(s.j)().services,i=Object(o.useRef)(new AbortController),d=Object(o.useRef)([]),[g,b]=Object(o.useState)({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),{addError:y}=Object(u.a)(),h=Object(o.useCallback)((t=>{(async()=>{try{b({...g,loading:!0}),i.current=new AbortController;const e=await r.dataViews.create({title:t.join(","),allowNoIndex:!0}),n=e.toSpec(),{browserFields:a}=Object(c.a)(t,n.fields);d.current=e.getIndexPattern().split(","),b({loading:!1,dataView:n,browserFields:a,indexes:e.getIndexPattern().split(","),indexExists:e.getIndexPattern().split(",").length>0,indexPatterns:p(e.getIndexPattern(),e.fields)})}catch(t){b({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),y(null==t?void 0:t.message,{title:l.a})}})()}),[y,r.dataViews,e,g]);return Object(o.useEffect)((()=>(Object(a.isEmpty)(e)||Object(a.isEqual)(d.current,e)||h(e),()=>{i.current.abort()})),[e,d]),[g.loading,g]}},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"t",(function(){return g})),n.d(t,"s",(function(){return b})),n.d(t,"r",(function(){return y})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"c",(function(){return x})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return O})),n.d(t,"f",(function(){return S})),n.d(t,"v",(function(){return w})),n.d(t,"w",(function(){return k}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights",{defaultMessage:"Insights"}),i=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry",{defaultMessage:"Related alerts by process ancestry"}),o=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} by process ancestry",values:{count:e}}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_error",{defaultMessage:"Failed to fetch alerts."}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.processAncestryFilter",{defaultMessage:"Process Ancestry Alert IDs"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_empty",{defaultMessage:"There are no related alerts by process ancestry."}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_error",{defaultMessage:"Failed to load related alerts by session"}),p=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_empty",{defaultMessage:"There are no related alerts by session"}),m=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by session",values:{count:e}}),f=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),g=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_error",{defaultMessage:"Failed to load related alerts by source event"}),b=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_empty",{defaultMessage:"There are no related alerts by source event"}),y=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights_related_alerts_by_source_event_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by source event",values:{count:e}}),h=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_loading",{defaultMessage:"Loading related cases"}),v=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_error",{defaultMessage:"Failed to load related cases"}),E=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_count",{defaultMessage:"{count} {count, plural, =1 {case} other {cases}} related to this alert",values:{count:e}}),x=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.relatedCasesFailure",{defaultMessage:'Unable to load related cases: "{error}"',values:{error:e}}),j=a.i18n.translate("xpack.securitySolution.alertDetails.overview.simpleAlertTable.error",{defaultMessage:"Failed to load the alerts."}),O=a.i18n.translate("xpack.securitySolution.alertDetails.overview.limitedAlerts",{defaultMessage:"Showing only the latest 10 alerts. View the rest of alerts in timeline."}),S=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.alertUpsellTitle",{defaultMessage:"Get more insights with a platinum subscription"}),w=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCount",{defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),k=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCountTechnicalPreview",{defaultMessage:"Technical Preview"})},function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"i",(function(){return h}));var a=n(211);const r=`${a.a}VisualizeTab`,i=`${r}ButtonGroup`,o=`${r}SessionViewButton`,s=`${r}GraphAnalyzerButton`,l=`${a.a}InsightsTab`,c=`${l}ButtonGroup`,u=`${l}EntitiesButton`,d=`${l}Entities`,p=`${l}ThreatIntelligenceButton`,m=`${l}Prevalence`,f=`${l}PrevalenceButton`,g=`${l}CorrelationsButton`,b=`${a.a}InvestigationsTabContent`,y=`${a.a}ResponseTabContent`,h=`${a.a}NotesTabContent`},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=n(1371).a;a.union([r,a[void 0]])},function(e,t,n){"use strict";var a=n(295);n.d(t,"b",(function(){return a.b})),n.d(t,"a",(function(){return a.a}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(207);const r=e=>`${Object(a.a)(e)}`,i=e=>`${Object(a.a)(e)}`,o=(e,t)=>`/id/${e}${Object(a.a)(t)}`,s=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,l=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"a",(function(){return f}));var a=n(50),r=n(245);const i=r.b.length,o=e=>{var t;return(null!==(t=e.tags)&&void 0!==t?t:[]).includes(r.e)},s=e=>!o(e),l=e=>{var t;const n=[],a=null!==(t=e.tags)&&void 0!==t?t:[];for(const e of a)e!==r.e&&e.startsWith(r.b)&&n.push(e.substring(i));return n},c=e=>e.startsWith(r.b)||e===r.e,u=e=>e.isGlobal?[r.e]:e.selected.map((e=>`${r.b}${e.id}`)),d=(e,t)=>e.find((e=>e===r.e))?{isGlobal:!0,selected:[]}:{isGlobal:!1,selected:e.reduce(((e,n)=>{const a=n.split(":")[1],r=t.find((e=>e.id===a));return void 0!==r&&e.push(r),e}),[])},p=e=>{var t;return(null!==(t=e.tags)&&void 0!==t?t:[]).includes(r.d)},m=e=>e===r.d,f=e=>({comments:[],description:"",entries:[],item_id:void 0,list_id:e,meta:{temporaryUuid:Object(a.v4)()},name:"",namespace_type:"agnostic",tags:[r.e],type:"simple",os_types:["windows"]})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(7);const r=(e,t=!1)=>{if(Array.isArray(e))return e;const n={};return Object.entries(e).forEach((([e,r])=>{const i=t&&Array.isArray(r)&&1===r.length;Object(a.merge)(n,Object(a.setWith)({},e,i?r[0]:r,Object))})),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(45),c=n(148),u=n(138),d=n(183),p=n(13),m=n(200),f=n(127),g=n(146),b=n(121),y=n(331),h=n(172);const v=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:v,keepDataView:E,iconType:x,...j})=>{const O=Object(l.useDispatch)(),S=Object(l.useSelector)(c.e.signalIndexName),w=Object(l.useSelector)(c.e.defaultDataView),k=n&&n.find((e=>"template"===e.type)),I=Object(y.a)({timelineId:g.c.active,timelineType:k?b.m.template:b.m.default}),T=Object(i.useCallback)((async()=>{(n||a)&&(v?await I({timeRange:v}):await I(),n&&O(Object(p.updateProviders)({id:g.c.active,providers:n})),a&&O(Object(p.setFilters)({id:g.c.active,filters:a})),E||O(m.d.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:[S||""]})),O(d.b.removeLinkTo([u.a.timeline,u.a.global])))}),[n,I,O,w.id,S,a,v,E]);return e?o.a.createElement(s.EuiButtonEmpty,{"aria-label":h.i,onClick:T,flush:"right",size:"xs",iconType:x},t):o.a.createElement(s.EuiButton,r()({"aria-label":h.i,onClick:T},j),t)};v.displayName="InvestigateInTimelineButton"},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(4),r=n(137);const i=a.i18n.translate("xpack.securitySolution.riskScore.overview.hostTitle",{defaultMessage:"Host"}),o=a.i18n.translate("xpack.securitySolution.riskScore.overview.hosts",{defaultMessage:"Hosts"}),s=a.i18n.translate("xpack.securitySolution.riskScore.overview.userTitle",{defaultMessage:"User"}),l=a.i18n.translate("xpack.securitySolution.riskScore.overview.users",{defaultMessage:"Users"}),c=a.i18n.translate("xpack.securitySolution.riskScore.overview.entityTitle",{defaultMessage:"Entity"}),u=a.i18n.translate("xpack.securitySolution.riskScore.overview.entities",{defaultMessage:"Entities"}),d=e=>a.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoreTitle",{defaultMessage:"{riskEntity} Risk Score",values:{riskEntity:f(e)}}),p=a.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoringTitle",{defaultMessage:"Entity Risk Scoring"}),m=e=>a.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskLevelTitle",{defaultMessage:"{riskEntity} risk level",values:{riskEntity:f(e)}}),f=(e,t=!1,n=!1)=>{const a=g(e,n);return t?a.toLowerCase():a},g=(e,t)=>{switch(e){case r.t.host:return t?o:i;case r.t.user:return t?l:s;default:return t?u:c}},b=a.i18n.translate("xpack.securitySolution.riskScore.overview.alerts",{defaultMessage:"Alerts"})},,,function(e,t,n){"use strict";n.d(t,"l",(function(){return r})),n.d(t,"k",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"a",(function(){return E}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),i=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),g=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),b=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),y=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),h=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),v=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),E=a.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef();return a.useEffect((function(){t.current=e})),t.current}},function(e,t,n){"use strict";n.d(t,"j",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(44),r=n(121),i=n(432);const o=(e,t)=>"__typename"!==e&&null!=t?t:void 0,s=e=>!Object(a.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===r.m.template?i.b(e):n?i.d(e):t?i.c(e):i.g(e),c=({eventId:e,pinnedEventIds:t})=>!0===t[e],u=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:r})=>{e&&(r?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),p=e=>{var t,n;return!Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n?void 0:n.building_block_type)},m=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,r;const t=(null!==(n=null===(r=e.eql)||void 0===r?void 0:r.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},f=e=>{var t,n,r,i;return Object(a.isEmpty)(null==e||null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(r=n.rule)||void 0===r?void 0:r.uuid)?Object(a.isEmpty)(null==e||null===(i=e.eql)||void 0===i?void 0:i.parentId)?"raw":"eql":"signal"},g="note-content"},function(e,t,n){"use strict";n.d(t,"i",(function(){return d.h})),n.d(t,"g",(function(){return p.a})),n.d(t,"h",(function(){return m.g})),n.d(t,"a",(function(){return f.b})),n.d(t,"b",(function(){return f.c})),n.d(t,"c",(function(){return f.d})),n.d(t,"d",(function(){return f.f})),n.d(t,"e",(function(){return g.f})),n.d(t,"f",(function(){return g.g}));var a=n(120),r=n(268);const i=a.z.array(r.a).min(1),o=r.a,s=a.z.array(o),l=a.z.enum(["open","closed","acknowledged","in-progress"]),c=(l.enum,a.z.object({add:a.z.array(r.a),remove:a.z.array(r.a)})),u=(a.z.object({assignees:c,ids:i}),a.z.object({tags_to_add:s,tags_to_remove:s}));a.z.object({ids:i,tags:u}),a.z.object({}).catchall(a.z.unknown()),n(624),a.z.object({acknowledged:a.z.boolean()}),a.z.object({acknowledged:a.z.boolean()}),a.z.object({name:a.z.string(),index_mapping_outdated:a.z.boolean().nullable()}),n(247);var d=n(290),p=(n(374),n(471),n(425),n(330)),m=(n(472),n(440)),f=(n(501),n(232)),g=n(341);d.f.and(d.g).and(a.object({invocationCount:a.number(),timeframeEnd:a.string()}));const b=a.z.union([a.z.string(),a.z.object({}).catchall(a.z.unknown())]),y=a.z.union([b,a.z.array(b)]),h=(a.z.object({query:a.z.object({}).catchall(a.z.unknown()).optional(),aggs:a.z.object({}).catchall(a.z.unknown()).optional(),size:a.z.number().int().min(0).optional(),track_total_hits:a.z.boolean().optional(),_source:a.z.union([a.z.boolean(),a.z.string(),a.z.array(a.z.string())]).optional(),fields:a.z.array(a.z.string()).optional(),runtime_mappings:a.z.object({}).catchall(a.z.unknown()).optional(),sort:y.optional()}),a.z.object({}).catchall(a.z.unknown()),a.z.object({signal_ids:a.z.array(r.a).min(1),status:l})),v=a.z.object({query:a.z.object({}).catchall(a.z.unknown()),status:l,conflicts:a.z.enum(["abort","proceed"]).optional().default("abort")}),E=(a.z.union([h,v]),a.z.object({}).catchall(a.z.unknown()),a.z.object({requests_per_second:a.z.number().int().min(1).optional(),size:a.z.number().int().min(1).optional(),slices:a.z.number().int().min(1).optional()})),x=a.z.object({index:a.z.string(),migration_id:a.z.string(),migration_index:a.z.string()}),j=a.z.object({index:a.z.string(),error:a.z.object({message:a.z.string(),status_code:a.z.string()})}),O=a.z.object({index:a.z.string()}),S=(a.z.object({index:a.z.array(r.a).min(1)}).merge(E),a.z.object({indices:a.z.array(a.z.union([x,j,O]))}),a.z.object({id:a.z.string(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()})),w=(a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(S),a.z.object({id:a.z.string(),completed:a.z.boolean(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()}));a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(w);var k=n(2073);const I=a.z.object({version:a.z.number().int(),count:a.z.number().int()}),T=a.z.object({id:r.a,status:a.z.enum(["success","failure","pending"]),version:a.z.number().int(),updated:a.z.string().datetime()}),C=a.z.object({index:r.a,version:a.z.number().int(),signal_versions:a.z.array(I),migrations:a.z.array(T),is_outdated:a.z.boolean()});a.z.object({from:a.z.string().superRefine(k.a)}),a.z.object({indices:a.z.array(C)})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(46);const r=a.object,i=a.union([r,a[void 0]]);a.union([i,a.null])},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n(5);var a=n(207);const r=(e,t)=>`/${e}${Object(a.a)(t)}`,i=(e,t)=>`/name/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(44),r=n(2),i=n.n(r),o=n(433),s=n(629),l=n(520),c=n(590),u=n(406),d=n(630),p=n(859),m=n(592),f=n(382),g=n(591),b=n(569),y=n(486);const h=i.a.memo((({data:e,timelineId:t,isDraggable:n})=>i.a.createElement(p.a,{contextId:`netflow-renderer-${t}-${e._id}`,destinationBytes:Object(o.a)(Object(a.get)(b.a,e)),destinationGeoContinentName:Object(o.a)(Object(a.get)(g.b,e)),destinationGeoCountryName:Object(o.a)(Object(a.get)(g.d,e)),destinationGeoCountryIsoCode:Object(o.a)(Object(a.get)(g.c,e)),destinationGeoRegionName:Object(o.a)(Object(a.get)(g.e,e)),destinationGeoCityName:Object(o.a)(Object(a.get)(g.a,e)),destinationIp:Object(o.a)(Object(a.get)(u.a,e)),destinationPackets:Object(o.a)(Object(a.get)(b.b,e)),destinationPort:Object(o.a)(Object(a.get)(f.a,e)),eventDuration:Object(o.a)(Object(a.get)(l.b,e)),eventId:Object(a.get)(c.a,e),eventEnd:Object(o.a)(Object(a.get)(m.b,e)),eventStart:Object(o.a)(Object(a.get)(m.c,e)),isDraggable:n,networkBytes:Object(o.a)(Object(a.get)(y.a,e)),networkCommunityId:Object(o.a)(Object(a.get)(y.b,e)),networkDirection:Object(o.a)(Object(a.get)(y.c,e)),networkPackets:Object(o.a)(Object(a.get)(y.d,e)),networkProtocol:Object(o.a)(Object(a.get)(y.e,e)),sourceBytes:Object(o.a)(Object(a.get)(b.c,e)),sourceGeoContinentName:Object(o.a)(Object(a.get)(g.h,e)),sourceGeoCountryName:Object(o.a)(Object(a.get)(g.j,e)),sourceGeoCountryIsoCode:Object(o.a)(Object(a.get)(g.i,e)),sourceGeoRegionName:Object(o.a)(Object(a.get)(g.k,e)),sourceGeoCityName:Object(o.a)(Object(a.get)(g.g,e)),sourceIp:Object(o.a)(Object(a.get)(u.d,e)),sourcePackets:Object(o.a)(Object(a.get)(b.d,e)),sourcePort:Object(o.a)(Object(a.get)(f.c,e)),tlsClientCertificateFingerprintSha1:Object(o.a)(Object(a.get)(s.b,e)),tlsFingerprintsJa3Hash:Object(o.a)(Object(a.get)(d.a,e)),tlsServerCertificateFingerprintSha1:Object(o.a)(Object(a.get)(s.c,e)),transport:Object(o.a)(Object(a.get)(y.f,e)),userName:void 0})));h.displayName="NetflowRenderer"},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(19),r=n(2),i=n.n(r),o=n(118),s=n(484);const l="closed",c="open",u=(e,t)=>{const{storage:n,title:a}=t;if(n&&a){const t=n.get(s.a.OVERVIEW_TAB_EXPANDED_SECTIONS);n.set(s.a.OVERVIEW_TAB_EXPANDED_SECTIONS,{...t,[a]:e!==c})}return e===l?c:l},d="Header",p="Content",m=({expanded:e,title:t,children:n,gutterSize:s="none",localStorageKey:m,"data-test-subj":f})=>{const g=Object(a.useGeneratedHtmlId)({prefix:"accordion"}),{renderContent:b,state:y,toggle:h}=(e=>{const{storage:t}=Object(o.j)().services,n=e?c:l,[a,i]=Object(r.useReducer)(u,n);return{renderContent:a===c,state:a,toggle:e=>{i({storage:t,title:e})}}})(e),v=f+d,E=f+p,x=i.a.createElement(a.EuiTitle,{size:"xs","data-test-subj":v},i.a.createElement("h4",null,t));return i.a.createElement(a.EuiAccordion,{forceState:y,onToggle:()=>h(m),id:g,buttonContent:x},i.a.createElement(a.EuiSpacer,{size:"m"}),i.a.createElement(a.EuiFlexGroup,{gutterSize:s,direction:"column","data-test-subj":E},b&&n))};m.displayName="ExpandableSection"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=function(e){return(e+1)%1e6};t.default=function(){return a.useReducer(r,0)[1]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var a=n(120);const r=a.z.enum(["going to run","running","partial failure","failed","succeeded"]),i=r.enum,o=a.z.number().int()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p}));var a=n(5);const r="histogram-actions-trigger",i={[a.Oc.hosts]:"host",[a.Oc.users]:"user"},o=(e,t)=>{const n=i[e];return n&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${n}.name`,params:{query:t}},query:{match_phrase:{[`${n}.name`]:t}}}]:[]},s=e=>{const t=i[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],c=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],u=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var n,a,r,i,o,s;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(r=a.indexFilter)||void 0===r?void 0:r.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(i=null==t||null===(o=t.response)||void 0===o||null===(s=o.json)||void 0===s?void 0:s.rawResponse)&&void 0!==i?i:{},null,2)]}}),{requests:[],responses:[]}),p=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},function(e,t,n){const a=n(164);e.exports=(e,t,n=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!n)return null;throw e}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.securitySolution="SecuritySolution",e.timeline="Timeline",e}({})},,,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return a.P})),n.d(t,"c",(function(){return a.q})),n.d(t,"a",(function(){return a.c})),n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.b})),n.d(t,"f",(function(){return r.g})),n.d(t,"g",(function(){return r.h})),n.d(t,"h",(function(){return i}));var a=n(199),r=n(176);function i(e){var t;return"external"===(null===(t=e.rule_source)||void 0===t?void 0:t.type)&&e.rule_source.is_customized}n(466),n(469),n(470),n(468),n(467)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(2),r=n(45),i=n(395),o=n.n(i),s=n(83),l=n(118),c=n(166),u=n(127),d=n(511),p=n(512),m=n(123);const f=o()(((e,t)=>{if(null==t)return{browserFields:{}};{const e={};for(const[n,a]of Object.entries(t)){const t=Object(s.getCategory)(n);null==e[t]&&(e[t]={fields:{}});const r=e[t].fields;r&&(r[n]=a)}return{browserFields:e}}}),((e,t)=>{var n,a;return e[0]===t[0]&&(null===(n=e[1])||void 0===n?void 0:n.length)===(null===(a=t[1])||void 0===a?void 0:a.length)})),g=()=>{const{data:e}=Object(l.j)().services,t=Object(a.useRef)({}),n=Object(a.useRef)({}),i=Object(r.useDispatch)(),{addError:o}=Object(m.a)(),s=Object(a.useCallback)((({id:e,loading:t})=>{i(c.a.setDataViewLoading({id:e,loading:t}))}),[i]);return{indexFieldsSearch:Object(a.useCallback)((({dataViewId:a,scopeId:r=u.SourcererScopeName.default,needToBeInit:l=!1,cleanCache:m=!1,skipScopeUpdate:f=!1})=>(n.current[a]&&n.current[a].unsubscribe(),t.current[a]&&t.current[a].abort(),(async()=>{try{t.current={...t.current,[a]:new AbortController},s({id:a,loading:!0});const n=await Object(d.a)(a,e.dataViews,m);l&&r&&!f&&i(c.a.setSelectedDataView({id:r,selectedDataViewId:a,selectedPatterns:n.patternList})),i(c.a.setDataView({...n,loading:!1}))}catch(e){o(null==e?void 0:e.message,{title:p.a})}})())),[s,e.dataViews,i,o])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(2),r=n.n(a),i=n(8),o=n.n(i),s=n(3),l=n(48),c=n(794),u=n(131),d=n(118),p=n(170);const m={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{},hidden:!1,setAllTourStepsHidden:()=>{}},f=Object(a.createContext)(m),g=({children:e})=>{var t,n,i,l;const{guidedOnboarding:u}=Object(d.j)().services,[m,g]=Object(a.useState)(!1),b=Object(a.useCallback)((e=>{g(e)}),[]),y=o()(null!==(t=null==u||null===(n=u.guidedOnboardingApi)||void 0===n?void 0:n.isGuideStepActive$(c.a,p.b.rules).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==t?t:Object(s.of)(!1),!1),h=o()(null!==(i=null==u||null===(l=u.guidedOnboardingApi)||void 0===l?void 0:l.isGuideStepActive$(c.a,p.b.alertsCases).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==i?i:Object(s.of)(!1),!1),v=Object(a.useMemo)((()=>({[p.b.rules]:{active:y,hidden:!1},[p.b.alertsCases]:{active:h,hidden:!1}})),[y,h]),E=Object(a.useCallback)((e=>v[e].active),[v]),[x,j]=Object(a.useState)(1),O=Object(a.useCallback)((e=>{j((t=>(t>=p.g[e].length?0:t)+1))}),[]),S=Object(a.useCallback)(((e,t)=>{t<=p.g[e].length&&j(t)}),[]),[w,k]=Object(a.useState)(null);Object(a.useEffect)((()=>{if(!w||null==u||!u.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==u||null===(t=u.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(c.a,w)),e||(k(null),j(1))})(),()=>{e=!0}}),[w,u]);const I=Object(a.useCallback)((e=>{k(e)}),[]),T=Object(a.useMemo)((()=>({hidden:m,setAllTourStepsHidden:b,activeStep:x,endTourStep:I,incrementStep:O,isTourShown:E,setStep:S})),[x,I,m,O,E,b,S]);return r.a.createElement(f.Provider,{value:T},e)},b=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),n=Object(a.useMemo)((()=>Object(u.isTourPath)(t)?g:f.Provider),[t]);return r.a.createElement(n,{value:m},e)},y=()=>{const e=Object(a.useContext)(f);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n.n(a),i=n(44),o=n(49),s=n(1378);const{euiColorVis0:l,euiColorVis5:c,euiColorVis7:u,euiColorVis9:d}=o.euiLightVars,p={low:l,medium:c,high:u,critical:d},m=({value:e,"data-test-subj":t="severity"})=>{var n;const a=Object(i.upperFirst)(e),o=null!==(n=p[e])&&void 0!==n?n:"subdued";return r.a.createElement(s.a,{healthColor:o,tooltipContent:a,dataTestSubj:t},a)},f=r.a.memo(m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(44),r=n(19),i=n(2),o=n.n(i),s=n(134),l=n(41),c=n.n(l),u=n(149);const d="destination.ip",p="destination.port",m="event.category",f="file.name",g="host.name",b="kibana.alert.rule.name",y="kibana.alert.severity",h="process.parent.name",v="process.name",E="source.ip",x="source.port",j="user.name",O=[d,p,f,v,h,E,x],S=c()(r.EuiFlexGroup).withConfig({displayName:"AlertFieldFlexGroup",componentId:"sc-1itxfus-0"})(["flex-grow:0;gap:","px;"],(({$scopeId:e})=>e===u.f.active?0:3)),w=({contextId:e,eventId:t,field:n,fieldType:a="keyword",isAggregatable:i=!0,isDraggable:l,showSeparator:c,scopeId:u,value:d})=>o.a.createElement(S,{alignItems:"center","data-test-subj":"alertFieldBadge",$scopeId:u,gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(s.c,{contextId:`${e}-alert-field`,eventId:t,field:n,fieldType:a,isAggregatable:i,isDraggable:l,scopeId:u,value:d})),c&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"separator"},", ")));w.displayName="AlertFieldBadgeComponent";const k=o.a.memo(w),I=({contextId:e,"data-test-subj":t="alertField",eventId:n,field:a,fieldType:i="keyword",isAggregatable:s=!0,isDraggable:l,prefix:c,suffix:u,scopeId:d,values:p})=>null!=p?o.a.createElement(S,{alignItems:"center","data-test-subj":t,$scopeId:d,gutterSize:"none"},null!=c&&o.a.createElement(r.EuiFlexItem,{"data-test-subj":"prefix",grow:!1},c),p.map(((t,c)=>o.a.createElement(r.EuiFlexItem,{key:`${t}-${c}`,grow:!1},o.a.createElement(k,{contextId:`${e}-alert-field`,eventId:n,field:a,fieldType:i,isAggregatable:s,isDraggable:l,showSeparator:c<p.length-1,scopeId:d,value:t})))),null!=u&&o.a.createElement(r.EuiFlexItem,{"data-test-subj":"suffix",grow:!1},u)):null;I.displayName="AlertFieldComponent";const T=o.a.memo(I);var C=n(121),M=n(150),_=n(315),D=n(4);const N=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.alertLabel",{defaultMessage:"alert"}),A=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.byLabel",{defaultMessage:"by"}),F=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.createdLabel",{defaultMessage:"created"}),P=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.destinationLabel",{defaultMessage:"destination"}),R=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.eventLabel",{defaultMessage:"event"}),L=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.fileLabel",{defaultMessage:"file"}),q=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.onLabel",{defaultMessage:"on"}),z=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.parentProcessLabel",{defaultMessage:"parent process"}),B=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.processLabel",{defaultMessage:"process"}),$=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.sourceLabel",{defaultMessage:"source"}),V=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.withLabel",{defaultMessage:"with"}),U={id:C.e.alert,isInstance:e=>{return null!==(n=null==(t=Object(a.get)("event.kind",e))?void 0:t.some((e=>null!=e.toLocaleLowerCase&&"signal"===e.toLowerCase())))&&void 0!==n&&n;var t,n},renderRow:({contextId:e="alert-renderer",data:t,isDraggable:n,scopeId:i})=>{const s=Object(a.get)("_id",t),l=Object(a.get)(d,t),c=Object(a.get)(p,t),u=Object(a.get)(m,t),S=Object(a.get)(f,t),w=Object(a.get)(g,t),k=Object(a.get)(b,t),I=Object(a.get)(y,t),C=Object(a.get)(v,t),D=Object(a.get)(h,t),U=Object(a.get)(E,t),G=Object(a.get)(x,t),H=Object(a.get)(j,t);return o.a.createElement(_.a,null,o.a.createElement(M.b,{"data-test-subj":"alertRenderer"},o.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"center",wrap:!0},o.a.createElement(T,{contextId:e,"data-test-subj":m,eventId:s,field:m,isDraggable:n,scopeId:i,values:u}),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"event"},` ${R} `)),(({data:e,fieldNames:t})=>t.some((t=>Object(a.has)(t,e))))({data:t,fieldNames:O})&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"with"},` ${V} `)),o.a.createElement(T,{contextId:e,"data-test-subj":v,eventId:s,field:v,isDraggable:n,prefix:` ${B} `,suffix:", ",scopeId:i,values:C}),o.a.createElement(T,{contextId:e,"data-test-subj":h,eventId:s,field:h,isDraggable:n,prefix:` ${z} `,suffix:", ",scopeId:i,values:D}),o.a.createElement(T,{contextId:e,"data-test-subj":f,eventId:s,field:f,isDraggable:n,prefix:` ${L} `,suffix:", ",scopeId:i,values:S}),o.a.createElement(T,{contextId:e,"data-test-subj":E,eventId:s,field:E,isDraggable:n,prefix:` ${$} `,scopeId:i,values:U}),o.a.createElement(T,{contextId:e,"data-test-subj":x,eventId:s,field:x,isDraggable:n,prefix:":",suffix:", ",scopeId:i,values:G}),o.a.createElement(T,{contextId:e,"data-test-subj":d,eventId:s,field:d,isDraggable:n,prefix:` ${P} `,scopeId:i,values:l}),o.a.createElement(T,{contextId:e,"data-test-subj":p,eventId:s,field:p,isDraggable:n,prefix:":",suffix:", ",scopeId:i,values:c}),o.a.createElement(T,{contextId:e,"data-test-subj":j,eventId:s,field:j,isDraggable:n,prefix:` ${A} `,scopeId:i,values:H}),o.a.createElement(T,{contextId:e,"data-test-subj":g,eventId:s,field:g,isDraggable:n,prefix:` ${q} `,scopeId:i,values:w}),o.a.createElement(T,{contextId:e,"data-test-subj":y,eventId:s,field:y,isDraggable:n,prefix:` ${F} `,suffix:` ${N} `,scopeId:i,values:I}),o.a.createElement(T,{contextId:e,"data-test-subj":b,eventId:s,field:b,isDraggable:n,suffix:".",scopeId:i,values:k}))))}},G=({data:e,rowRenderers:t})=>{var n;const a=null!==(n=t.find((t=>t.isInstance(e))))&&void 0!==n?n:null;return U.isInstance(e)?null!=a?(({a:e,b:t,id:n})=>({id:n,isInstance:n=>e.isInstance(n)||t.isInstance(n),renderRow:({contextId:n,data:a,isDraggable:r,scopeId:i})=>o.a.createElement(o.a.Fragment,null,e.isInstance(a)&&e.renderRow({contextId:n,data:a,isDraggable:r,scopeId:i}),t.isInstance(a)&&t.renderRow({contextId:n,data:a,isDraggable:r,scopeId:i}))}))({a:U,b:a,id:a.id}):U:a}},function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return j.a}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(44),l=n(19),c=n(476),u=n.n(c),d=n(42),p=n(696);const m=({disableLinks:e,href:t,target:n,children:a,...r})=>o.a.createElement(l.EuiToolTip,{content:t},o.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),f=Object(i.memo)(m);var g=n(118),b=n(16),y=n(4);const h=y.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),v=y.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),E=({children:e,disableLinks:t,textSize:n="m"})=>{const a=Object(i.useMemo)((()=>e=>o.a.createElement(f,r()({},e,{disableLinks:t}))),[t]),c=Object(s.cloneDeep)(p.c);c[1][1].components.a=a;const m=Object(b.b)().isAtLeast("platinum"),{application:y}=Object(g.j)().services,E=Object(i.useMemo)((()=>{if(!1===m){const t=String(e);return p.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,m]),x=Object(i.useMemo)((()=>u()().use(p.a).use(c)),[c]),j=Object(i.useMemo)((()=>{try{return x.processSync(e),null}catch(e){return String(e.message)}}),[e,x]);return o.a.createElement(o.a.Fragment,null,E&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiCallOut,{title:h,color:"primary",iconType:"lock"},o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:o.a.createElement(l.EuiLink,{href:y.getUrlForApp("management",{path:"stack/license_management/home"})},o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),o.a.createElement(l.EuiSpacer,{size:"s"})),null!==j&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiCallOut,{title:v,color:"danger",iconType:"error"},j),o.a.createElement(l.EuiSpacer,{size:"s"})),o.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:p.a,processingPluginList:c,textSize:n},e))};E.displayName="MarkdownRendererComponent";const x=Object(i.memo)(E);var j=n(481);n(581)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const r={},i=n.n(a).a.createContext(r)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g}));var a=n(128),r=n(44),i=n(2),o=n(229),s=n(1349),l=n(520),c=n(706),u=n(382),d=n(195),p=n(149);const m=(e,t,n,r=p.e,i=!1)=>({and:[],enabled:!0,id:Object(a.i)(t),name:e,excluded:i,kqlQuery:"",queryMatch:{field:e,value:n,operator:r,displayValue:Object(c.d)(n)}}),f=(e,t,n,a=p.e,r=!1)=>{const{and:i,...o}=m(e,t,n,a,r);return o},g=({contextId:e,eventId:t,field:n,fieldFormat:a,fieldFromBrowserField:c,fieldType:p,isObjectArray:f,linkValue:g,values:b})=>Object(i.useMemo)((()=>{if(null==b)return null;const i=Array.isArray(b)?b:[b];let y=[];return i.length>1&&(y=[{meta:{},query:{bool:{must:i.map((e=>({term:{[n]:e}})))}}}]),i.reduce(((i,y,h)=>{let v="",E=Object(r.isString)(y)?y:`${b}`;const x=`${e}-${t}-${n}-${h}-${y}`;if(null==c)return i.values.push(E),i;if(f||p===o.f||[o.i].includes(n))return i.values.push(E),i;if(p===o.h){if(v=`formatted-ip-data-provider-${e}-${n}-${y}-${t}`,Object(r.isString)(y)&&!Object(r.isEmpty)(y)){let e=y;try{e=JSON.parse(y)}catch(e){}return Object(r.isArray)(e)&&(E=e.join(","),e.forEach((e=>i.dataProviders.push(m(n,v,e))))),i.dataProviders.push(m(n,v,e)),i.values.push(E),i}}else u.b.some((e=>n===e))?v=`port-default-draggable-${x}`:n===l.b?v=`duration-default-draggable-${x}`:n===o.g?v=`event-details-value-default-draggable-${x}`:a===s.a?v=`bytes-default-draggable-${x}`:n===o.n?v=`event-details-value-default-draggable-${x}-${g}`:n===o.c?v=`event-details-value-default-draggable-${x}-${y}`:n===o.o?v=`alert-details-value-default-draggable-${x}`:n===o.a?(v=`event-details-value-default-draggable-${x}`,E="string"==typeof y?y:""):v=[o.m,o.l,o.e,d.j].includes(n)?`event-details-value-default-draggable-${x}-${y}`:`event-details-value-default-draggable-${x}`;return i.values.push(E),i.dataProviders.push(m(n,v,y)),i}),{values:[],dataProviders:[],filters:y})}),[e,t,n,a,c,p,f,g,b])},function(e,t,n){"use strict";n.d(t,"h",(function(){return E})),n.d(t,"g",(function(){return j})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return k})),n.d(t,"c",(function(){return C})),n.d(t,"i",(function(){return D})),n.d(t,"d",(function(){return z})),n.d(t,"e",(function(){return B})),n.d(t,"a",(function(){return $}));var a=n(63),r=n.n(a),i=n(54),o=n.n(i),s=n(395),l=n.n(s),c=(n(48),n(41)),u=n.n(c),d=n(19),p=n(168),m=n(1560),f=n(165),g=n(227),b=n(731),y=n(248),h=n(1228),v=n(20);const E=({rule:e,detailsView:t=!1})=>{const n=O(e);return{aboutRuleData:I(e,t),modifiedAboutRuleDetailsData:_(e),defineRuleData:n,scheduleRuleData:w(e),ruleActionsData:x(e)}},x=e=>{const{enabled:t,meta:n,actions:a=[],response_actions:r}=e;return{actions:null==a?void 0:a.map((e=>Object(b.d)(e))),responseActions:null==r?void 0:r.map(b.e),kibanaSiemAppUrl:"string"==typeof(null==n?void 0:n.kibana_siem_app_url)?n.kibana_siem_app_url:void 0,enabled:t}},j=e=>{if("machine_learning"===e.type)return"string"==typeof e.machine_learning_job_id?[e.machine_learning_job_id]:e.machine_learning_job_id},O=e=>{var t,n,a,r,i,o,s,l,c,u,d;return{ruleType:e.type,anomalyThreshold:"anomaly_threshold"in e?e.anomaly_threshold:50,machineLearningJobId:j(e)||[],index:"index"in e&&e.index||[],dataViewId:"data_view_id"in e?e.data_view_id:void 0,threatIndex:"threat_index"in e&&e.threat_index||[],threatQueryBar:{query:{query:"threat_query"in e&&e.threat_query||"",language:"threat_language"in e&&e.threat_language||""},filters:"threat_filters"in e&&e.threat_filters||[],saved_id:null},threatMapping:"threat_mapping"in e&&e.threat_mapping||[],queryBar:{query:{query:"query"in e&&e.query||"",language:"language"in e&&e.language||""},filters:"filters"in e&&e.filters||[],saved_id:"saved_id"in e&&e.saved_id||null},relatedIntegrations:null!==(t=e.related_integrations)&&void 0!==t?t:[],requiredFields:null!==(n=e.required_fields)&&void 0!==n?n:[],timeline:{id:null!==(a=e.timeline_id)&&void 0!==a?a:null,title:null!==(r=e.timeline_title)&&void 0!==r?r:null},threshold:{field:Object(f.p)("threshold"in e?null===(i=e.threshold)||void 0===i?void 0:i.field:void 0),value:`${"threshold"in e&&(null===(o=e.threshold)||void 0===o?void 0:o.value)||100}`,..."threshold"in e&&null!==(s=e.threshold)&&void 0!==s&&null!==(l=s.cardinality)&&void 0!==l&&l.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:"timestamp_field"in e?e.timestamp_field:void 0,eventCategoryField:"event_category_override"in e?e.event_category_override:void 0,tiebreakerField:"tiebreaker_field"in e?e.tiebreaker_field:void 0},dataSourceType:"data_view_id"in e&&e.data_view_id?y.a.DataView:y.a.IndexPatterns,newTermsFields:"new_terms_fields"in e&&e.new_terms_fields||[],historyWindowSize:"history_window_start"in e&&e.history_window_start?S(e.history_window_start):"7d",shouldLoadQueryDynamically:Boolean("saved_query"===e.type&&e.saved_id),groupByFields:"alert_suppression"in e&&e.alert_suppression&&"group_by"in e.alert_suppression&&e.alert_suppression.group_by||[],groupByRadioSelection:"alert_suppression"in e&&null!==(c=e.alert_suppression)&&void 0!==c&&c.duration?y.b.PerTimePeriod:y.b.PerRuleExecution,groupByDuration:"alert_suppression"in e&&(null===(u=e.alert_suppression)||void 0===u?void 0:u.duration)||{value:5,unit:"m"},suppressionMissingFields:"alert_suppression"in e&&e.alert_suppression&&"missing_fields_strategy"in e.alert_suppression&&e.alert_suppression.missing_fields_strategy||v.a,enableThresholdSuppression:Boolean("alert_suppression"in e&&(null===(d=e.alert_suppression)||void 0===d?void 0:d.duration))}},S=e=>e.startsWith("now-")?e.substring(4):e,w=e=>{const{interval:t,from:n}=e;return{interval:t,from:k(n,t)}},k=(e,t)=>{var n,a;const i=null!==(n=r.a.parse(e))&&void 0!==n?n:o()(),s=null!==(a=r.a.parse(`now-${t}`))&&void 0!==a?a:o()(),l=o.a.duration(s.diff(i)),c=Math.floor(l.asSeconds());return 0===c?"0s":c%3600==0?c/3600+"h":c%60==0?c/60+"m":`${c}s`},I=(e,t)=>{var n,a;const{name:r,description:i,note:o,setup:s}=M(e,t),{author:l,building_block_type:c,exceptions_list:u,license:d,risk_score_mapping:f,rule_name_override:g,severity_mapping:b,timestamp_override:y,timestamp_override_fallback_disabled:h,references:v,severity:E,false_positives:x,risk_score:j,investigation_fields:O,tags:S,threat:w,max_signals:k}=e,I="threat_indicator_path"in e?e.threat_indicator_path:void 0;return{author:l,isAssociatedToEndpointList:null!==(n=null==u?void 0:u.some((({id:e})=>e===p.k)))&&void 0!==n&&n,isBuildingBlock:void 0!==c,license:null!=d?d:"",ruleNameOverride:null!=g?g:"",timestampOverride:null!=y?y:"",timestampOverrideFallbackDisabled:h,name:r,description:i,note:o,references:v,severity:{value:E,mapping:C(b),isMappingChecked:b.length>0},tags:S,riskScore:{value:j,mapping:Object(m.a)(f),isMappingChecked:f.length>0},falsePositives:x,investigationFields:null!==(a=null==O?void 0:O.field_names)&&void 0!==a?a:[],threat:w,threatIndicatorPath:I,maxSignals:k,setup:s}},T={low:0,medium:1,high:2,critical:3},C=e=>{const t=h.b.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>T[e.severity]-T[t.severity]))},M=(e,t)=>{const{name:n,description:a,note:r,setup:i}=e;return t?{name:"",description:"",note:"",setup:""}:{name:n,description:a,setup:i,note:null!=r?r:""}},_=e=>{var t,n;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(n=e.setup)&&void 0!==n?n:""}},D=(e,t,n,a)=>!1===e||!1===t||!1===n||a,N=["id","name","description","false_positives","investigation_fields","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"],A=["index","filters","language","query","saved_id","response_actions"],F=["filters","language","query","response_actions"],P=["anomaly_threshold","machine_learning_job_id"],R=["threshold",...A],L=e=>{switch(e){case"machine_learning":return P;case"threshold":return R;case"esql":return F;case"new_terms":case"threat_match":case"query":case"saved_query":case"eql":return A}Object(g.a)(e)},q=e=>({state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...e.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}),z=l()((e=>{if(!e)return{state:[],params:[]};const t=(e=>[...N,...L(e)].sort())(e);return q(t)})),B=()=>q((()=>{const e=[...N,...A,...P,...R].sort();return Array.from(new Set(e))})()),$=u()(d.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-15hicli-0"})(["max-width:1000px;overflow:hidden;"])},function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return R}));var a=n(626),r=n(2),i=n.n(r),o=n(363),s=n(222),l=n(130),c=n(179),u=n(416),d=n(1394);const p={isInstance:(e,t)=>((e,t)=>-1===t.findIndex((t=>t.field===e)))(e,t),renderColumn:({columnName:e,eventId:t,field:n,isDraggable:a=!0,scopeId:r,truncate:p})=>a?i.a.createElement(o.b,{dataProvider:{enabled:!0,id:Object(s.h)(`empty-column-renderer-draggable-wrapper-${r}-${e}-${t}-${n.id}`),name:`${e}: ${Object(d.a)(null)}`,queryMatch:{field:n.id,value:Object(d.a)(null),displayValue:Object(l.e)(),operator:c.b},excluded:!0,kqlQuery:"",and:[]},isDraggable:a,key:`empty-column-renderer-draggable-wrapper-${r}-${e}-${t}-${n.id}`,render:(e,t,n)=>n.isDragging?i.a.createElement(o.a,null,i.a.createElement(u.a,{dataProvider:e})):i.a.createElement("span",null,Object(l.e)()),truncate:p,scopeId:r}):i.a.createElement("span",null,Object(l.e)())};var m=n(837),f=n(44),g=n(422);const b={isInstance:(e,t)=>((e,t)=>-1!==t.findIndex((t=>t.field===e)))(e,t),renderColumn:({asPlainText:e,columnName:t,eventId:n,field:a,isDraggable:r=!0,scopeId:o,truncate:s,values:c,linkValues:u})=>{return Array.isArray(c)&&0!==c.length?r?c.map(((l,c)=>{var d,p,m;return i.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:n,fieldFormat:null!==(d=a.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=a.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=a.type)&&void 0!==m?m:"",isDraggable:r,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${n}-${a.id}-${l}-${c}`,linkValue:Object(f.head)(u),truncate:s,value:l})})):i.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:n,fieldFormat:null!==(d=a.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=a.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=a.type)&&void 0!==m?m:"",isDraggable:r,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${n}-${a.id}`,linkValue:Object(f.head)(u),truncate:s,value:y(c)}):Object(l.d)();var d,p,m}};function y(e){return Array.isArray(e)?e.length>0?e.join(", "):e[0]:e}var h=n(863);const v={isInstance:()=>!0,renderColumn:()=>Object(l.d)()};var E=n(865),x=n(231),j=n(861),O=n(19),S=n(1630),w=n(229),k=n(299);const I={isInstance:Object(f.isEqual)(w.k),renderColumn:({columnName:e,ecsData:t,eventId:n,field:a,isDetails:r,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d})=>r&&d&&t&&l?d.map(((r,o)=>i.a.createElement(T,{ecsData:t,key:`reason-column-renderer-value-${c}-${e}-${n}-${a.id}-${r}-${o}`,rowRenderers:l,scopeId:c,value:r}))):b.renderColumn({columnName:e,eventId:n,field:a,isDetails:r,isDraggable:o,linkValues:s,scopeId:c,truncate:u,values:d})},T=({ecsData:e,rowRenderers:t,scopeId:n,value:a})=>{const o=Object(r.useMemo)((()=>Object(k.a)({data:e,rowRenderers:t})),[e,t]),s=Object(r.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:n})),[o,e,n]),l=Object(r.useMemo)((()=>n===S.b.rulePreview),[n]);return i.a.createElement(i.a.Fragment,null,o&&s&&!l?i.a.createElement(O.EuiPanel,{color:"subdued",className:"eui-xScroll","data-test-subj":"reason-cell-renderer"},i.a.createElement(O.EuiText,{size:"xs"},i.a.createElement("div",{className:"eui-displayInlineBlock"},s))):a)};var C=n(41);const M=n.n(C)()(O.EuiFlexItem).withConfig({displayName:"EventRenderedFlexItem",componentId:"sc-1jiiiew-0"})(["div:first-child{padding-left:0px;div{margin:0px;}}"]),_={isInstance:Object(f.isEqual)(w.d),renderColumn:({ecsData:e,columnName:t,eventId:n,field:a,isDetails:r,linkValues:o,rowRenderers:s=[],scopeId:l,truncate:c,values:u})=>e&&s?i.a.createElement(D,{ecsData:e,key:`reason-column-renderer-value-${l}-${t}-${n}-${a.id}`,rowRenderers:s,scopeId:l,values:u}):b.renderColumn({columnName:t,eventId:n,field:a,isDetails:r,isDraggable:!1,linkValues:o,scopeId:l,truncate:c,values:u})},D=({ecsData:e,rowRenderers:t,scopeId:n,values:a})=>{const o=Object(r.useMemo)((()=>Object(k.a)({data:e,rowRenderers:t})),[e,t]),s=Object(r.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:n})),[o,e,n]);return i.a.createElement(O.EuiFlexGroup,{gutterSize:"none",direction:"column",className:"eui-fullWidth"},o&&s?i.a.createElement(M,{className:"eui-xScroll"},i.a.createElement("div",{className:"eui-displayInlineBlock",style:{width:"fit-content"}},s)):a&&i.a.createElement(O.EuiFlexItem,{"data-test-subj":"plain-text-reason"},a))};var N=n(966),A=n(1226);const F={isInstance:(e,t,n)=>A.a.includes(e)&&!!n,renderColumn:({columnName:e,ecsData:t,eventId:n,field:a,isDetails:r,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d,context:p})=>{var m;if(null!=p&&p.isLoading)return i.a.createElement(O.EuiLoadingSpinner,{size:"s"});const f=null!==(m=null==d?void 0:d.map((e=>{var t;return null==p||null===(t=p.profiles)||void 0===t?void 0:t.find((t=>e===t.uid))})))&&void 0!==m?m:[];return i.a.createElement(N.a,{userProfiles:f,maxVisibleAvatars:4})}},P=[j.a,...a.a,...x.k,h.a,E.a,m.a],R=[I,_,F,b,p,v]},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(42),c=n(41),u=n.n(c),d=n(124),p=n(149),m=n(158),f=n(129),g=n(295),b=n(170),y=n(48),h=n(118),v=n(198),E=n(213);const x=(e,t)=>(t===b.a.createCase||t===b.a.submitCase)&&e===b.b.alertsCases,j=u()(s.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>x(t,e)?"9000 !important":"1000 !important")),O=o.a.memo((({children:e,onClick:t,step:n,tourId:a})=>{const{activeStep:c,incrementStep:u,isTourShown:y}=Object(g.b)(),h=Object(i.useMemo)((()=>b.g[a].find((e=>e.step===n))),[n,a]),v=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),E=Object(d.b)((e=>{var t;return(null!==(t=v(e,p.f.active))&&void 0!==t?t:m.b).show})),O=Object(i.useCallback)((()=>t?t():u(a)),[u,t,a]),S=Object(i.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),w=x(a,n);if(null==h||(n!==c||!y(a))&&!w||E)return e||null;const{anchor:k,content:I,imageConfig:T,dataTestSubj:C,hideNextButton:M=!1,..._}=h,D=M?o.a.createElement(o.a.Fragment,null):o.a.createElement(s.EuiButtonEmpty,{onClick:O,onKeyDown:S,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),N={..._,content:o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,I)),T&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiImage,{alt:T.altText,src:T.src,size:"fullWidth"}))),footerAction:D,isStepOpen:!0,onFinish:()=>null,stepsTotal:b.g[a].length,panelProps:{"data-test-subj":C}};return null!=k?o.a.createElement(o.a.Fragment,null,o.a.createElement(j,r()({tourId:a},N,{anchor:k})),o.a.createElement(o.a.Fragment,null,e)):null!=e?o.a.createElement(j,r()({tourId:a},N),e):null}));O.displayName="SecurityTourStep";const S=o.a.memo((({children:e,isTourAnchor:t=!0,...n})=>t?o.a.createElement(w,n,e):o.a.createElement(o.a.Fragment,null,e)));S.displayName="GuidedOnboardingTourStep";const w=o.a.memo((({children:e,...t})=>{const{hidden:n}=Object(g.b)(),a=(({tourId:e,step:t})=>{const{useIsAddToCaseOpen:n}=Object(h.j)().services.cases.hooks,a=n(),{search:r}=Object(y.useLocation)(),o=Object(i.useMemo)((()=>Object(E.c)(v.a.flyout,r)),[r]),s=null==o?void 0:o.left,l=Object(i.useMemo)((()=>{var e;return s&&(null===(e=b.e[b.b.alertsCases])||void 0===e?void 0:e.includes(t))}),[s,t]),c=Object(i.useMemo)((()=>{var n;return a&&(null===(n=b.d[e])||void 0===n?void 0:n.includes(t))}),[a,e,t]);return l||c})({tourId:t.tourId,step:t.step});return n||a?o.a.createElement(o.a.Fragment,null,e):o.a.createElement(O,t,e)}));w.displayName="SecurityTourStepAnchor"},,,,,,function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=n(348),o=n(347),s=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.t={};let d=0;const p="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",i],[p,r]],f=(e,t,n)=>{const a=(e=>{for(const[t,n]of m)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),r=d++;o(e,r,t),u[e]=r,c[r]=t,s[r]=new RegExp(t,n?"g":void 0),l[r]=new RegExp(a,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),f("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${c[u.NUMERICIDENTIFIER]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NUMERICIDENTIFIERLOOSE]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${p}+`),f("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`),f("FULL",`^${c[u.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`),f("LOOSE",`^${c[u.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?)?)?`),f("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),f("COERCE",`${c[u.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",c[u.COERCEPLAIN]+`(?:${c[u.PRERELEASE]})?`+`(?:${c[u.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",c[u.COERCE],!0),f("COERCERTLFULL",c[u.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})\\s+-\\s+(${c[u.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[u.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return b}));var a=n(2),r=n.n(a),i=n(19),o=n(41),s=n.n(o),l=n(42),c=n(130);const u=({children:e,...t})=>r.a.createElement(i.EuiButton,t,e),d=({children:e,...t})=>r.a.createElement(i.EuiLink,t,e),p=s()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);p.displayName="Comma";const m=({children:e,Component:t,dataTestSubj:n,href:a,onClick:i,title:o,iconType:s="expand"})=>t?r.a.createElement(t,{"data-test-subj":n,href:a,iconType:s,onClick:i,title:o},null!=o?o:e):r.a.createElement(u,{"data-test-subj":n,href:a,onClick:i},null!=o?o:e),f=r.a.memo(m),g=s.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),b=r.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:o})=>{const[s,c]=Object(a.useState)(!1),u=Object(a.useCallback)((()=>c((e=>!e))),[]),d=Object(a.useMemo)((()=>r.a.createElement(r.a.Fragment,null," ,",r.a.createElement(i.EuiButtonEmpty,{size:"xs",onClick:u},`+${o.length-t} `,r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[u,t,o.length]);return r.a.createElement(i.EuiFlexItem,{grow:!1},o.length>t&&r.a.createElement(i.EuiPopover,{id:"popover",button:d,isOpen:s,closePopover:u,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},r.a.createElement(y,{render:n,rowItems:o,moreMaxHeight:e,overflowIndexStart:t})))}));b.displayName="ReputationLinksOverflow";const y=r.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:o})=>{const s=Object(a.useMemo)((()=>o.slice(t).map(((e,t)=>{var a;return r.a.createElement(i.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(c.a)(e))}))),[t,n,o]);return r.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},r.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},s))}));y.displayName="MoreReputationLinksContainer"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n.n(a),i=n(180);const o=r.a.memo((({children:e})=>r.a.createElement(i.w,{className:"siemEventsTable__trSupplement--summary"},e)));o.displayName="RowRendererContainer"},function(e,t,n){"use strict";n.d(t,"Vb",(function(){return r})),n.d(t,"oc",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"eb",(function(){return s})),n.d(t,"Yb",(function(){return l})),n.d(t,"db",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"pc",(function(){return d})),n.d(t,"gb",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"T",(function(){return f})),n.d(t,"kc",(function(){return g})),n.d(t,"Db",(function(){return b})),n.d(t,"y",(function(){return y})),n.d(t,"A",(function(){return h})),n.d(t,"z",(function(){return v})),n.d(t,"ob",(function(){return E})),n.d(t,"gc",(function(){return x})),n.d(t,"V",(function(){return j})),n.d(t,"Bb",(function(){return O})),n.d(t,"Ob",(function(){return S})),n.d(t,"S",(function(){return w})),n.d(t,"Q",(function(){return k})),n.d(t,"dc",(function(){return I})),n.d(t,"ic",(function(){return T})),n.d(t,"Z",(function(){return C})),n.d(t,"N",(function(){return M})),n.d(t,"mb",(function(){return _})),n.d(t,"t",(function(){return D})),n.d(t,"Hb",(function(){return N})),n.d(t,"Ub",(function(){return A})),n.d(t,"lb",(function(){return F})),n.d(t,"D",(function(){return P})),n.d(t,"M",(function(){return R})),n.d(t,"ub",(function(){return L})),n.d(t,"L",(function(){return q})),n.d(t,"h",(function(){return z})),n.d(t,"Rb",(function(){return B})),n.d(t,"g",(function(){return $})),n.d(t,"u",(function(){return V})),n.d(t,"nb",(function(){return U})),n.d(t,"H",(function(){return G})),n.d(t,"rb",(function(){return H})),n.d(t,"hc",(function(){return W})),n.d(t,"f",(function(){return Q})),n.d(t,"U",(function(){return Y})),n.d(t,"hb",(function(){return K})),n.d(t,"jc",(function(){return Z})),n.d(t,"ib",(function(){return X})),n.d(t,"o",(function(){return J})),n.d(t,"Eb",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"ec",(function(){return ne})),n.d(t,"nc",(function(){return ae})),n.d(t,"lc",(function(){return re})),n.d(t,"B",(function(){return ie})),n.d(t,"P",(function(){return oe})),n.d(t,"v",(function(){return se})),n.d(t,"Jb",(function(){return le})),n.d(t,"Cb",(function(){return ce})),n.d(t,"X",(function(){return ue})),n.d(t,"Y",(function(){return de})),n.d(t,"ac",(function(){return pe})),n.d(t,"d",(function(){return me})),n.d(t,"a",(function(){return fe})),n.d(t,"Lb",(function(){return ge})),n.d(t,"Mb",(function(){return be})),n.d(t,"Wb",(function(){return ye})),n.d(t,"p",(function(){return he})),n.d(t,"Ib",(function(){return ve})),n.d(t,"Pb",(function(){return Ee})),n.d(t,"Qb",(function(){return xe})),n.d(t,"Zb",(function(){return je})),n.d(t,"ab",(function(){return Oe})),n.d(t,"bb",(function(){return Se})),n.d(t,"w",(function(){return we})),n.d(t,"Kb",(function(){return ke})),n.d(t,"q",(function(){return Ie})),n.d(t,"C",(function(){return Te})),n.d(t,"xb",(function(){return Ce})),n.d(t,"jb",(function(){return Me})),n.d(t,"yb",(function(){return _e})),n.d(t,"Fb",(function(){return De})),n.d(t,"E",(function(){return Ne})),n.d(t,"tb",(function(){return Ae})),n.d(t,"J",(function(){return Fe})),n.d(t,"qb",(function(){return Pe})),n.d(t,"K",(function(){return Re})),n.d(t,"j",(function(){return Le})),n.d(t,"zb",(function(){return qe})),n.d(t,"Nb",(function(){return ze})),n.d(t,"mc",(function(){return Be})),n.d(t,"bc",(function(){return $e})),n.d(t,"cc",(function(){return Ve})),n.d(t,"s",(function(){return Ue})),n.d(t,"O",(function(){return Ge})),n.d(t,"Xb",(function(){return He})),n.d(t,"Tb",(function(){return We})),n.d(t,"fc",(function(){return Qe})),n.d(t,"Sb",(function(){return Ye})),n.d(t,"c",(function(){return Ke})),n.d(t,"r",(function(){return Ze})),n.d(t,"G",(function(){return Xe})),n.d(t,"Gb",(function(){return Je})),n.d(t,"fb",(function(){return et})),n.d(t,"sb",(function(){return tt})),n.d(t,"F",(function(){return nt})),n.d(t,"pb",(function(){return at})),n.d(t,"Ab",(function(){return rt})),n.d(t,"I",(function(){return it})),n.d(t,"b",(function(){return ot})),n.d(t,"x",(function(){return st})),n.d(t,"kb",(function(){return lt})),n.d(t,"W",(function(){return ct})),n.d(t,"cb",(function(){return ut})),n.d(t,"R",(function(){return dt})),n.d(t,"k",(function(){return pt})),n.d(t,"vb",(function(){return mt})),n.d(t,"wb",(function(){return ft})),n.d(t,"l",(function(){return gt}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.auditd.sessionDescription",{defaultMessage:"Session"}),i=a.i18n.translate("xpack.securitySolution.auditd.wasAuthorizedToUseDescription",{defaultMessage:"was authorized to use"}),o=a.i18n.translate("xpack.securitySolution.auditd.acquiredCredentialsDescription",{defaultMessage:"acquired credentials to"}),s=a.i18n.translate("xpack.securitySolution.auditd.endedFromDescription",{defaultMessage:"ended from"}),l=a.i18n.translate("xpack.securitySolution.auditd.startedAtDescription",{defaultMessage:"started"}),c=a.i18n.translate("xpack.securitySolution.auditd.disposedCredentialsDescription",{defaultMessage:"disposed credentials to"}),u=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),d=a.i18n.translate("xpack.securitySolution.auditd.withResultDescription",{defaultMessage:"with result"}),p=a.i18n.translate("xpack.securitySolution.auditd.executedDescription",{defaultMessage:"executed"}),m=a.i18n.translate("xpack.securitySolution.auditd.asDescription",{defaultMessage:"as"}),f=a.i18n.translate("xpack.securitySolution.auditd.connectedUsingDescription",{defaultMessage:"connected using"}),g=a.i18n.translate("xpack.securitySolution.auditd.usingDescription",{defaultMessage:"using"}),b=a.i18n.translate("xpack.securitySolution.auditd.OpenedFileDescription",{defaultMessage:"opened file"}),y=a.i18n.translate("xpack.securitySolution.auditd.ChangedFileAttributesOfDescription",{defaultMessage:"changed file attributes of"}),h=a.i18n.translate("xpack.securitySolution.auditd.changedFilePermissionOfDescription",{defaultMessage:"changed file permissions of"}),v=a.i18n.translate("xpack.securitySolution.auditd.changeidleOwernshipOfDescription",{defaultMessage:"changed file ownership of"}),E=a.i18n.translate("xpack.securitySolution.auditd.loaedKernelModuleOfDescription",{defaultMessage:"loaded kernel module of"}),x=a.i18n.translate("xpack.securitySolution.auditd.unloadedKernelModuleOfDescription",{defaultMessage:"unloaded kernel module of"}),j=a.i18n.translate("xpack.securitySolution.auditd.createdDirectoryDescription",{defaultMessage:"created directory"}),O=a.i18n.translate("xpack.securitySolution.auditd.mountedDescription",{defaultMessage:"mounted"}),S=a.i18n.translate("xpack.securitySolution.auditd.renamedDescription",{defaultMessage:"renamed"}),w=a.i18n.translate("xpack.securitySolution.auditd.chedckedMetaDataOfDescription",{defaultMessage:"checked metadata of"}),k=a.i18n.translate("xpack.securitySolution.auditd.checkedFileSystemMetadataOfDescription",{defaultMessage:"checked filesystem metadata of"}),I=a.i18n.translate("xpack.securitySolution.auditd.symLinkedDescription",{defaultMessage:"symbolically linked"}),T=a.i18n.translate("xpack.securitySolution.auditd.unmountedDescription",{defaultMessage:"unmounted"}),C=a.i18n.translate("xpack.securitySolution.auditd.deletedDescription",{defaultMessage:"deleted"}),M=a.i18n.translate("xpack.securitySolution.auditd.changedTimeStampOfDescription",{defaultMessage:"changed time stamp of"}),_=a.i18n.translate("xpack.securitySolution.auditd.ListeningForConnectionsUsingDescription",{defaultMessage:"listening for connections using"}),D=a.i18n.translate("xpack.securitySolution.auditd.boundSocketFromDescription",{defaultMessage:"bound socket from"}),N=a.i18n.translate("xpack.securitySolution.auditd.receivedFromDescription",{defaultMessage:"received from"}),A=a.i18n.translate("xpack.securitySolution.auditd.sentToDescription",{defaultMessage:"sent to"}),F=a.i18n.translate("xpack.securitySolution.auditd.killedProcessIdDescription",{defaultMessage:"killed process id of"}),P=a.i18n.translate("xpack.securitySolution.auditd.changedIdentityUsingDescription",{defaultMessage:"changed identity using"}),R=a.i18n.translate("xpack.securitySolution.auditd.changedSystemTimeWithDescription",{defaultMessage:"changed system time with"}),L=a.i18n.translate("xpack.securitySolution.auditd.madeDeviceWithDescription",{defaultMessage:"made device with"}),q=a.i18n.translate("xpack.securitySolution.auditd.changedSystemNameDescription",{defaultMessage:"changed system name"}),z=a.i18n.translate("xpack.securitySolution.auditd.allocatedMemoryForDescription",{defaultMessage:"allocated memory for"}),B=a.i18n.translate("xpack.securitySolution.auditd.scheduledPolicyOFDescription",{defaultMessage:"scheduled policy of"}),$=a.i18n.translate("xpack.securitySolution.auditd.addedUserAccountDescription",{defaultMessage:"added user account"}),V=a.i18n.translate("xpack.securitySolution.auditd.causedMacPolicyErrorDescription",{defaultMessage:"caused mac policy error"}),U=a.i18n.translate("xpack.securitySolution.auditd.loadedFirewallRuleDescription",{defaultMessage:"loaded firewall rule"}),G=a.i18n.translate("xpack.securitySolution.auditd.promiscuousModeDescription",{defaultMessage:"changed promiscuous mode on the device using"}),H=a.i18n.translate("xpack.securitySolution.auditd.lockedAccountDescription",{defaultMessage:"locked account"}),W=a.i18n.translate("xpack.securitySolution.auditd.unlockedAccountDescription",{defaultMessage:"unlocked account"}),Q=a.i18n.translate("xpack.securitySolution.auditd.adddedGroupAccountUsingDescription",{defaultMessage:"added group account using"}),Y=a.i18n.translate("xpack.securitySolution.auditd.crashedProgramDescription",{defaultMessage:"crashed program"}),K=a.i18n.translate("xpack.securitySolution.auditd.executionOfForbiddenProgramDescription",{defaultMessage:"execution of forbidden program"}),Z=a.i18n.translate("xpack.securitySolution.auditd.suspiciousProgramDescription",{defaultMessage:"used suspicious program"}),X=a.i18n.translate("xpack.securitySolution.auditd.failedLoginTooManyTimesDescription",{defaultMessage:"failed login due to logging in too many times"}),J=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusalPlaceDescription",{defaultMessage:"attempted login from unusual place"}),ee=a.i18n.translate("xpack.securitySolution.auditd.openedTooManySessionsDescription",{defaultMessage:"opened too many sessions"}),te=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusualHourDescription",{defaultMessage:"attempted login from unusual hour"}),ne=a.i18n.translate("xpack.securitySolution.auditd.testedFileSystemIntegrityDescription",{defaultMessage:"tested file system integrity"}),ae=a.i18n.translate("xpack.securitySolution.auditd.violatedSeLinuxPolicyDescription",{defaultMessage:"violated selinux policy"}),re=a.i18n.translate("xpack.securitySolution.auditd.violatedAppArmorPolicyFromDescription",{defaultMessage:"violated app armor policy from"}),ie=a.i18n.translate("xpack.securitySolution.auditd.changedGroupDescription",{defaultMessage:"changed group"}),oe=a.i18n.translate("xpack.securitySolution.auditd.changedUserIdDescription",{defaultMessage:"changed user id"}),se=a.i18n.translate("xpack.securitySolution.auditd.changedAuditConfigurationDescription",{defaultMessage:"changed audit configuration"}),le=a.i18n.translate("xpack.securitySolution.auditd.refreshedCredentialsForDescription",{defaultMessage:"refreshed credentials for"}),ce=a.i18n.translate("xpack.securitySolution.auditd.negotiatedCryptoKeyDescription",{defaultMessage:"negotiated crypto key"}),ue=a.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedInDescription",{defaultMessage:"crypto officer logged in"}),de=a.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedOutDescription",{defaultMessage:"crypto officer logged out"}),pe=a.i18n.translate("xpack.securitySolution.auditd.startedCryptoSessionDescription",{defaultMessage:"started crypto session"}),me=a.i18n.translate("xpack.securitySolution.auditd.accessResultDescription",{defaultMessage:"access result"}),fe=a.i18n.translate("xpack.securitySolution.auditd.abortedAuditStartupDescription",{defaultMessage:"aborted audit startup"}),ge=a.i18n.translate("xpack.securitySolution.auditd.remoteAuditConnectedDescription",{defaultMessage:"remote audit connected"}),be=a.i18n.translate("xpack.securitySolution.auditd.remoteAuditDisconnectedDescription",{defaultMessage:"remote audit disconnected"}),ye=a.i18n.translate("xpack.securitySolution.auditd.shutDownAuditDescription",{defaultMessage:"shutdown audit"}),he=a.i18n.translate("xpack.securitySolution.auditd.auditErrorDescription",{defaultMessage:"audit error"}),ve=a.i18n.translate("xpack.securitySolution.auditd.reconfiguredAuditDescription",{defaultMessage:"reconfigured audit"}),Ee=a.i18n.translate("xpack.securitySolution.auditd.resumedAuditLoggingDescription",{defaultMessage:"resumed audit logging"}),xe=a.i18n.translate("xpack.securitySolution.auditd.rotatedAuditLogsDescription",{defaultMessage:"rotated-audit-logs"}),je=a.i18n.translate("xpack.securitySolution.auditd.startedAuditDescription",{defaultMessage:"started audit"}),Oe=a.i18n.translate("xpack.securitySolution.auditd.deletedGroupAccountUsingDescription",{defaultMessage:"deleted group account using"}),Se=a.i18n.translate("xpack.securitySolution.auditd.deletedUserAccountUsingDescription",{defaultMessage:"deleted user account using"}),we=a.i18n.translate("xpack.securitySolution.auditd.changedAuditFeatureDescription",{defaultMessage:"changed audit feature"}),ke=a.i18n.translate("xpack.securitySolution.auditd.relabeledFileSystemDescription",{defaultMessage:"relabeled filesystem"}),Ie=a.i18n.translate("xpack.securitySolution.auditd.authenticatedToGroupDescription",{defaultMessage:"authenticated to group"}),Te=a.i18n.translate("xpack.securitySolution.auditd.changedGroupPasswordDescription",{defaultMessage:"changed group password"}),Ce=a.i18n.translate("xpack.securitySolution.auditd.modifiedGroupAccountDescription",{defaultMessage:"modified group account"}),Me=a.i18n.translate("xpack.securitySolution.auditd.initializedAuditSubsystemDescription",{defaultMessage:"initialized audit subsystem"}),_e=a.i18n.translate("xpack.securitySolution.auditd.modifiedLevelOfDescription",{defaultMessage:"modified level of"}),De=a.i18n.translate("xpack.securitySolution.auditd.overrodeLabelOfDescription",{defaultMessage:"overrode label of"}),Ne=a.i18n.translate("xpack.securitySolution.auditd.changedLoginIdToDescription",{defaultMessage:"changed login id to"}),Ae=a.i18n.translate("xpack.securitySolution.auditd.macPermissionDescription",{defaultMessage:"mac permission"}),Fe=a.i18n.translate("xpack.securitySolution.auditd.changedSeLinuxBooleanDescription",{defaultMessage:"changed selinux boolean"}),Pe=a.i18n.translate("xpack.securitySolution.auditd.loadedSeLinuxPolicyDescription",{defaultMessage:"loaded selinux policy"}),Re=a.i18n.translate("xpack.securitySolution.auditd.changedSelinuxEnforcementDescription",{defaultMessage:"changed selinux enforcement"}),Le=a.i18n.translate("xpack.securitySolution.auditd.assignedUserRoleToDescription",{defaultMessage:"assigned user role to"}),qe=a.i18n.translate("xpack.securitySolution.auditd.modifiedRoleDescription",{defaultMessage:"modified role"}),ze=a.i18n.translate("xpack.securitySolution.auditd.removedUserRoleFromDescription",{defaultMessage:"removed user role from"}),Be=a.i18n.translate("xpack.securitySolution.auditd.violatedSeccompPolicyWithDescription",{defaultMessage:"violated seccomp policy with"}),$e=a.i18n.translate("xpack.securitySolution.auditd.startedServiceDescription",{defaultMessage:"started service"}),Ve=a.i18n.translate("xpack.securitySolution.auditd.stoppedServiceDescription",{defaultMessage:"stopped service"}),Ue=a.i18n.translate("xpack.securitySolution.auditd.bootedSystemDescription",{defaultMessage:"booted system"}),Ge=a.i18n.translate("xpack.securitySolution.auditd.changedToRunLevelWithDescription",{defaultMessage:"changed to run level with"}),He=a.i18n.translate("xpack.securitySolution.auditd.shutdownSystemDescription",{defaultMessage:"shutdown system"}),We=a.i18n.translate("xpack.securitySolution.auditd.sentTestDescription",{defaultMessage:"sent test"}),Qe=a.i18n.translate("xpack.securitySolution.auditd.unknownDescription",{defaultMessage:"unknown"}),Ye=a.i18n.translate("xpack.securitySolution.auditd.sentMessageDescription",{defaultMessage:"sent message"}),Ke=a.i18n.translate("xpack.securitySolution.auditd.accessPermissionDescription",{defaultMessage:"access permission"}),Ze=a.i18n.translate("xpack.securitySolution.auditd.authenticatedUsingDescription",{defaultMessage:"authenticated using"}),Xe=a.i18n.translate("xpack.securitySolution.auditd.changedPasswordWithDescription",{defaultMessage:"changed password with"}),Je=a.i18n.translate("xpack.securitySolution.auditd.ranCommandDescription",{defaultMessage:"ran command"}),et=a.i18n.translate("xpack.securitySolution.auditd.errorFromDescription",{defaultMessage:"error from"}),tt=a.i18n.translate("xpack.securitySolution.auditd.loggedOutDescription",{defaultMessage:"logged out"}),nt=a.i18n.translate("xpack.securitySolution.auditd.changedMacConfigurationDescription",{defaultMessage:"changed mac configuration"}),at=a.i18n.translate("xpack.securitySolution.auditd.loadedMacPolicyDescription",{defaultMessage:"loaded mac policy"}),rt=a.i18n.translate("xpack.securitySolution.auditd.modifiedUserAccountDescription",{defaultMessage:"modified user account"}),it=a.i18n.translate("xpack.securitySolution.auditd.changedRoleUsingDescription",{defaultMessage:"changed role using"}),ot=a.i18n.translate("xpack.securitySolution.auditd.accessErrorDescription",{defaultMessage:"access error"}),st=a.i18n.translate("xpack.securitySolution.auditd.changedConfigurationWIthDescription",{defaultMessage:"changed configuration with"}),lt=a.i18n.translate("xpack.securitySolution.auditd.issuedVmControlDescription",{defaultMessage:"issued vm control"}),ct=a.i18n.translate("xpack.securitySolution.auditd.createdVmImageDescription",{defaultMessage:"created vm image"}),ut=a.i18n.translate("xpack.securitySolution.auditd.deletedVmImageDescription",{defaultMessage:"deleted vm image"}),dt=a.i18n.translate("xpack.securitySolution.auditd.checkedIntegrityOfDescription",{defaultMessage:"checked integrity of"}),pt=a.i18n.translate("xpack.securitySolution.auditd.assignedVmIdDescription",{defaultMessage:"assigned vm id"}),mt=a.i18n.translate("xpack.securitySolution.auditd.migratedVmFromDescription",{defaultMessage:"migrated vm from"}),ft=a.i18n.translate("xpack.securitySolution.auditd.migratedVmToDescription",{defaultMessage:"migrated vm to"}),gt=a.i18n.translate("xpack.securitySolution.auditd.assignedVMResourceDescription",{defaultMessage:"assigned vm resource"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(19),r=n(2),i=n.n(r),o=n(134),s=n(150),l=n(434);const c=i.a.memo((({contextId:e,endgamePid:t,endgameProcessName:n,eventId:r,processExecutable:l,processName:c,processPid:u,isDraggable:d})=>Object(s.e)(c)&&Object(s.e)(l)&&Object(s.e)(n)&&Object(s.e)(u)&&Object(s.e)(t)?null:i.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(s.e)(c)?Object(s.e)(l)?Object(s.e)(n)?null:i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"endgame.process_name",value:n,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.executable",value:l,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.name",value:c,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})),Object(s.e)(u)?Object(s.e)(t)?null:i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"endgame.pid",queryValue:String(t),value:`(${String(t)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.pid",queryValue:String(u),value:`(${String(u)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})))));c.displayName="ProcessDraggable";const u=i.a.memo((({contextId:e,endgamePid:t,endgameProcessName:n,eventId:a,processExecutable:r,processName:o,processPid:s,isDraggable:u})=>null==t&&null==n&&null==r&&null==o&&null==s?i.a.createElement(i.a.Fragment,null,l.g):i.a.createElement(c,{contextId:e,endgamePid:t,endgameProcessName:n,eventId:a,processExecutable:r,processName:o,processPid:s,isDraggable:u})));u.displayName="ProcessDraggableWithNonExistentProcess"},function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return A}));var a=n(41),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=(n(152),n(44)),c=n(4),u=n(1216),d=n(122),p=n(313),m=n(125),f=n(367),g=n(137),b=n(130),y=n(196),h=n(334),v=n(226),E=n(132),x=n(161),j=n(570),O=n(142),S=n(366),w=n(735),k=n(320),I=n(135),T=n(145),C=n(210),M=n(357),_=n(288),D=n(118);const N={title:c.i18n.translate("xpack.securitySolution.flyout.right.host.hostPreviewTitle",{defaultMessage:"Preview host details"}),backgroundColor:"warning",textColor:"warning"},A=({hostName:e})=>{const{eventId:t,indexName:n,scopeId:a}=Object(m.b)(),{openLeftPanel:r,openPreviewPanel:A}=Object(u.a)(),{telemetry:P}=Object(D.j)().services,R=!Object(d.a)("entityAlertPreviewDisabled"),L=Object(i.useCallback)((()=>{r({id:T.c,path:{tab:C.b,subTab:k.a},params:{id:t,indexName:n,scopeId:a}})}),[t,r,n,a]),q=Object(i.useCallback)((()=>{A({id:_.e,params:{hostName:e,scopeId:a,banner:N}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[A,e,a,P]),{from:z,to:B}=Object(x.a)(),{selectedPatterns:$}=Object(E.a)(),V=Object(i.useMemo)((()=>({from:z,to:B})),[z,B]),U=Object(i.useMemo)((()=>e?Object(g.z)([e]):void 0),[e]),{data:G,isAuthorized:H,loading:W}=Object(p.a)({filterQuery:U,riskEntity:g.t.host,skip:null==e,timerange:V}),[Q,{hostDetails:Y}]=Object(j.b)({hostName:e,indexNames:$,startDate:z,endDate:B}),K=Object(i.useMemo)((()=>Object(O.a)(Object(l.getOr)([],"host.os.family",Y))),[Y]),Z=Object(i.useMemo)((()=>[{title:w.c,description:K?o.a.createElement(S.a,{field:"host.os.family",value:K},K):Object(b.d)()}]),[K]),X=Object(i.useMemo)((()=>[{title:w.k,description:o.a.createElement(f.a,{indexPatterns:$,field:"host.name",value:e,type:f.b.LAST_SEEN})}]),[e,$]),{euiTheme:J}=Object(s.useEuiTheme)(),ee=Object(s.useEuiFontSize)("xs").fontSize,[te]=Object(i.useMemo)((()=>{const e=G&&G.length>0?G[0]:void 0;return[{title:o.a.createElement(s.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},w.f),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(M.a,null))),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(v.a,{severity:e.host.risk.calculated_level}):Object(b.d)())}]}),[G]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":I.v},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{gutterSize:"m",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:"storage"})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(F,{"data-test-subj":I.r,onClick:R?q:L,$_css:ee,$_css2:J.font.weight.bold},e)))),W||Q?o.a.createElement(s.EuiSkeletonText,{"data-test-subj":I.s,contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.hostLoadingAriaLabel",{defaultMessage:"host overview"})}):o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(h.a,{dataTestSubj:I.t,descriptionList:Z})),o.a.createElement(s.EuiFlexItem,null,H?o.a.createElement(y.d,{"data-test-subj":I.u,listItems:[te]}):o.a.createElement(h.a,{dataTestSubj:I.q,descriptionList:X})))))};A.displayName="HostEntityOverview";var F=r()(s.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-cud8pg-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2))},function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return A}));var a=n(41),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=(n(152),n(44)),c=n(4),u=n(1216),d=n(122),p=n(145),m=n(210),f=n(320),g=n(125),b=n(142),y=n(366),h=n(367),v=n(137),E=n(130),x=n(196),j=n(334),O=n(226),S=n(132),w=n(161),k=n(313),I=n(118),T=n(736),C=n(135),M=n(548),_=n(357),D=n(287);const N={title:c.i18n.translate("xpack.securitySolution.flyout.right.user.userPreviewTitle",{defaultMessage:"Preview user details"}),backgroundColor:"warning",textColor:"warning"},A=({userName:e})=>{const{eventId:t,indexName:n,scopeId:a}=Object(g.b)(),{openLeftPanel:r,openPreviewPanel:A}=Object(u.a)(),{telemetry:P}=Object(I.j)().services,R=!Object(d.a)("entityAlertPreviewDisabled"),L=Object(i.useCallback)((()=>{r({id:p.c,path:{tab:m.b,subTab:f.a},params:{id:t,indexName:n,scopeId:a}})}),[t,r,n,a]),q=Object(i.useCallback)((()=>{A({id:D.d,params:{userName:e,scopeId:a,banner:N}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[A,e,a,P]),{from:z,to:B}=Object(w.a)(),{selectedPatterns:$}=Object(S.a)(),V=Object(i.useMemo)((()=>({from:z,to:B})),[z,B]),U=Object(i.useMemo)((()=>e?Object(v.A)([e]):void 0),[e]),[G,{userDetails:H}]=Object(M.b)({endDate:B,userName:e,indexNames:$,startDate:z}),{data:W,isAuthorized:Q,loading:Y}=Object(k.a)({filterQuery:U,riskEntity:v.t.user,timerange:V}),K=Object(i.useMemo)((()=>Object(b.a)(Object(l.getOr)([],"user.domain",H))),[H]),Z=Object(i.useMemo)((()=>[{title:T.h,description:K?o.a.createElement(y.a,{field:"user.domain",value:K},K):Object(E.d)()}]),[K]),X=Object(i.useMemo)((()=>[{title:T.f,description:o.a.createElement(h.a,{indexPatterns:$,field:"user.name",value:e,type:h.b.LAST_SEEN})}]),[e,$]),{euiTheme:J}=Object(s.useEuiTheme)(),ee=Object(s.useEuiFontSize)("xs").fontSize,[te]=Object(i.useMemo)((()=>{const e=W&&W.length>0?W[0]:void 0;return[{title:o.a.createElement(s.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},T.j),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(_.a,null))),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(O.a,{severity:e.user.risk.calculated_level}):Object(E.d)())}]}),[W]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":C.B},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{gutterSize:"m",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:"user"})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(F,{"data-test-subj":C.y,onClick:R?q:L,$_css:ee,$_css2:J.font.weight.bold},e)))),o.a.createElement(s.EuiFlexItem,null,G||Y?o.a.createElement(s.EuiSkeletonText,{contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.userLoadingAriaLabel",{defaultMessage:"user overview"}),"data-test-subj":C.z}):o.a.createElement(s.EuiFlexGroup,{responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(j.a,{dataTestSubj:C.w,descriptionList:Z})),o.a.createElement(s.EuiFlexItem,null,Q?o.a.createElement(x.d,{"data-test-subj":C.A,listItems:[te]}):o.a.createElement(j.a,{dataTestSubj:C.x,descriptionList:X})))))};var F=r()(s.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-f1yfvo-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2))},function(e,t,n){"use strict";n.d(t,"a",(function(){return re})),n.d(t,"b",(function(){return ie}));var a=n(2),r=n.n(a),i=n(19),o=n(42),s=n(125),l=n(142),c=n(45),u=n(50),d=n(4),p=n(1216),m=n(122),f=n(202),g=n(785),b=n(450),y=n(181),h=n(144),v=n(137),E=n(226),x=n(351),j=n(131),O=n(175),S=n(236),w=n(173);const k=({field:e,value:t,isObjectArray:n,children:i})=>{const{dataFormattedForFieldBrowser:o,scopeId:l,isPreview:c}=Object(s.b)(),{isAlert:u}=Object(O.b)(o),d=u?w.d.DETAILS_FLYOUT:w.d.DEFAULT,p=Object(a.useMemo)((()=>({field:e,value:t})),[e,t]),m=Object(a.useMemo)((()=>({scopeId:l,isObjectArray:n})),[l,n]),f=Object(a.useMemo)((()=>c?[S.d.FILTER,S.d.TOGGLE_COLUMN]:[]),[c]);return r.a.createElement(w.c,{data:p,mode:w.a.HOVER_RIGHT,triggerId:d,visibleCellActions:6,sourcererScopeId:Object(j.getSourcererScopeId)(l),metadata:m,disabledActionTypes:f},i)};k.displayName="CellActions";var I=n(138),T=n(161),C=n(132),M=n(419),_=n(249),D=n(561),N=n(209),A=n(548),F=n(699),P=n(306);const R=d.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedHostsDescription",{defaultMessage:"Failed to run search on related hosts"});var L=n(359),q=n(201),z=n(130),B=n(153),$=n(118),V=n(264),U=n(350),G=n(288),H=n(318),W=n(287),Q=n(319);const Y=Object(N.a)(g.b),K=Object(N.a)(y.c),Z=({userName:e,timestamp:t,scopeId:n})=>{const{to:s,from:l,deleteQuery:g,setQuery:j,isInitializing:O}=Object(T.a)(),{selectedPatterns:S}=Object(C.a)(),w=Object(c.useDispatch)(),{telemetry:N}=Object($.j)().services,Z=Object(a.useMemo)((()=>`entities-users-details-${Object(u.v4)()}`),[]),X=Object(a.useMemo)((()=>`entities-users-related-hosts-${Object(u.v4)()}`),[]),J=Object(U.a)("entity-analytics"),ee=Object(q.a)().isPlatinumOrTrialLicense&&J,{openPreviewPanel:te}=Object(p.a)(),ne=!Object(m.a)("entityAlertPreviewDisabled"),ae=Object(a.useCallback)(((e,t)=>{const n=Object(M.a)(e,t);w(Object(_.setAbsoluteRangeDatePicker)({id:I.a.global,from:n.from,to:n.to}))}),[w]),re=Object(a.useCallback)((()=>{te({id:W.d,params:{userName:e,scopeId:n,banner:Q.a}}),N.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[te,e,n,N]),ie=Object(a.useCallback)((e=>{te({id:G.e,params:{hostName:e,scopeId:n,banner:H.a}}),N.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[te,n,N]),[oe,{inspect:se,userDetails:le,refetch:ce}]=Object(A.b)({id:Z,startDate:l,endDate:s,userName:e,indexNames:S,skip:0===S.length}),{loading:ue,inspect:de,relatedHosts:pe,totalCount:me,refetch:fe}=(({userName:e,indexNames:t,from:n,skip:r=!1})=>{const{loading:i,result:o,search:s,refetch:l,inspect:c}=Object(P.a)({factoryQueryType:F.a.relatedHosts,initialResult:{totalCount:0,relatedHosts:[]},errorMessage:R,abort:r}),{installed:u,isLoading:d}=Object(L.b)(),p=Object(a.useMemo)((()=>({inspect:c,totalCount:o.totalCount,relatedHosts:o.relatedHosts,refetch:l,loading:i})),[c,l,o.totalCount,o.relatedHosts,i]),m=Object(a.useMemo)((()=>({defaultIndex:t,factoryQueryType:F.a.relatedHosts,userName:e,from:n,isNewRiskScoreModuleInstalled:u})),[t,n,e,u]);return Object(a.useEffect)((()=>{r||d||s(m)}),[m,s,r,d]),p})({userName:e,indexNames:S,from:t,skip:0===S.length}),ge=Object(a.useMemo)((()=>[{field:"host",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNameColumnLabel",defaultMessage:"Name"}),render:e=>r.a.createElement(i.EuiText,{grow:!1,size:"xs"},r.a.createElement(k,{field:"host.name",value:e},ne?r.a.createElement(i.EuiLink,{"data-test-subj":B.O,onClick:()=>ie(e)},e):r.a.createElement(r.a.Fragment,null,e)))},{field:"ip",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>r.a.createElement(x.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?r.a.createElement(h.h,{ip:e}):Object(z.d)(),scopeId:n})},...ee?[{field:"risk",name:Object(V.b)(v.t.host),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?r.a.createElement(E.a,{severity:e}):Object(z.d)()}]:[]]),[ee,n,ie,ne]),be=Object(a.useMemo)((()=>r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiIcon,{type:"storage"})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxxs"},r.a.createElement(i.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsCountLabel",defaultMessage:"Related hosts: {count}",values:{count:me}})))))),[me]),ye=Object(a.useMemo)((()=>ne?{callback:re,tooltip:d.i18n.translate("xpack.securitySolution.flyout.left.insights.entities.user.userPreviewTitle",{defaultMessage:"Preview user"})}:void 0),[ne,re]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiTitle,{size:"xs"},r.a.createElement("h3",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsTitle",defaultMessage:"User"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(f.a,{header:{title:e,iconType:"user",headerContent:be,link:ye},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":B.Q},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsInfoTitle",defaultMessage:"User information"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(b.a,{criteriaFields:Object(D.a)(le),startDate:l,endDate:s,skip:O},(({isLoadingAnomaliesData:t,anomaliesData:n,jobNameById:a})=>r.a.createElement(Y,{id:Z,isInDetailsSidePanel:!1,data:le,anomaliesData:n,isLoadingAnomaliesData:t,loading:oe,startDate:l,endDate:s,narrowDateRange:ae,setQuery:j,refetch:ce,inspect:se,userName:e,indexPatterns:S,jobNameById:a}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiPanel,{hasBorder:!0},r.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTitle",defaultMessage:"Related hosts"})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiToolTip,{content:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTooltip",defaultMessage:"After this event, {userName} logged into these hosts. Check if this activity is normal.",values:{userName:e}})},r.a.createElement(i.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(K,{id:X,inspect:de,loading:ue,setQuery:j,deleteQuery:g,refetch:fe},r.a.createElement(i.EuiInMemoryTable,{columns:ge,items:pe,loading:ue,"data-test-subj":B.P,pagination:{pageSize:4,showPerPageOptions:!1},message:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNoDataDescription",defaultMessage:"No hosts identified"})}),r.a.createElement(y.b,{queryId:X,title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsInspectButtonTitle",defaultMessage:"Related hosts"}),inspectIndex:0})))))};var X=n(792),J=n(570);const ee=d.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedUsersDescription",{defaultMessage:"Failed to run search on related users"}),te=Object(N.a)(X.b),ne=Object(N.a)(y.c),ae=({hostName:e,timestamp:t,scopeId:n})=>{const{to:s,from:l,deleteQuery:g,setQuery:j,isInitializing:O}=Object(T.a)(),{selectedPatterns:S}=Object(C.a)(),w=Object(c.useDispatch)(),{telemetry:N}=Object($.j)().services,A=Object(a.useMemo)((()=>`entities-hosts-details-${Object(u.v4)()}`),[]),R=Object(a.useMemo)((()=>`entities-hosts-related-users-${Object(u.v4)()}`),[]),Y=Object(U.a)("entity-analytics"),K=Object(q.a)().isPlatinumOrTrialLicense&&Y,{openPreviewPanel:Z}=Object(p.a)(),X=!Object(m.a)("entityAlertPreviewDisabled"),ae=Object(a.useCallback)(((e,t)=>{const n=Object(M.a)(e,t);w(Object(_.setAbsoluteRangeDatePicker)({id:I.a.global,from:n.from,to:n.to}))}),[w]),re=Object(a.useCallback)((()=>{Z({id:G.e,params:{hostName:e,scopeId:n,banner:H.a}}),N.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[Z,e,n,N]),ie=Object(a.useCallback)((e=>{Z({id:W.d,params:{userName:e,scopeId:n,banner:Q.a}}),N.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[Z,n,N]),[oe,{inspect:se,hostDetails:le,refetch:ce}]=Object(J.b)({id:A,startDate:l,endDate:s,hostName:e,indexNames:S,skip:0===S.length}),{loading:ue,inspect:de,relatedUsers:pe,totalCount:me,refetch:fe}=(({hostName:e,indexNames:t,from:n,skip:r=!1})=>{const{installed:i,isLoading:o}=Object(L.b)(),{loading:s,result:l,search:c,refetch:u,inspect:d}=Object(P.a)({factoryQueryType:F.a.relatedUsers,initialResult:{totalCount:0,relatedUsers:[]},errorMessage:ee,abort:r}),p=Object(a.useMemo)((()=>({inspect:d,totalCount:l.totalCount,relatedUsers:l.relatedUsers,refetch:u,loading:s})),[d,u,l.totalCount,l.relatedUsers,s]),m=Object(a.useMemo)((()=>({defaultIndex:t,factoryQueryType:F.a.relatedUsers,hostName:e,from:n,isNewRiskScoreModuleInstalled:i})),[t,n,e,i]);return Object(a.useEffect)((()=>{r||o||c(m)}),[m,o,c,r]),p})({hostName:e,indexNames:S,from:t,skip:0===S.length}),ge=Object(a.useMemo)((()=>[{field:"user",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNameColumnLabel",defaultMessage:"Name"}),render:e=>r.a.createElement(i.EuiText,{grow:!1,size:"xs"},r.a.createElement(k,{field:"user.name",value:e},X?r.a.createElement(i.EuiLink,{"data-test-subj":B.o,onClick:()=>ie(e)},e):r.a.createElement(r.a.Fragment,null,e)))},{field:"ip",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>r.a.createElement(x.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?r.a.createElement(h.h,{ip:e}):Object(z.d)(),scopeId:n})},...K?[{field:"risk",name:Object(V.b)(v.t.user),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?r.a.createElement(E.a,{severity:e}):Object(z.d)()}]:[]]),[K,n,X,ie]),be=Object(a.useMemo)((()=>r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiIcon,{type:"user"})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxxs"},r.a.createElement(i.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersCountLabel",defaultMessage:"Related users: {count}",values:{count:me}})))))),[me]),ye=Object(a.useMemo)((()=>X?{callback:re,tooltip:d.i18n.translate("xpack.securitySolution.flyout.left.insights.entities.host.hostPreviewTitle",{defaultMessage:"Preview host"})}:void 0),[X,re]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiTitle,{size:"xs"},r.a.createElement("h3",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsTitle",defaultMessage:"Host"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(f.a,{header:{title:e,iconType:"storage",headerContent:be,link:ye},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":B.q},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsInfoTitle",defaultMessage:"Host information"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(b.a,{criteriaFields:Object(D.a)(le),startDate:l,endDate:s,skip:O},(({isLoadingAnomaliesData:t,anomaliesData:n,jobNameById:a})=>r.a.createElement(te,{id:A,hostName:e,data:le,indexNames:S,jobNameById:a,anomaliesData:n,isLoadingAnomaliesData:t,isInDetailsSidePanel:!1,loading:oe,startDate:l,endDate:s,narrowDateRange:ae,setQuery:j,refetch:ce,inspect:se,deleteQuery:g}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiPanel,{hasBorder:!0},r.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTitle",defaultMessage:"Related users"})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiToolTip,{content:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTooltip",defaultMessage:"After this event, these users logged into {hostName}. Check if this activity is normal.",values:{hostName:e}})},r.a.createElement(i.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(ne,{id:R,inspect:de,loading:ue,setQuery:j,deleteQuery:g,refetch:fe},r.a.createElement(i.EuiInMemoryTable,{columns:ge,items:pe,loading:ue,"data-test-subj":B.p,pagination:{pageSize:4,showPerPageOptions:!1},message:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNoDataDescription",defaultMessage:"No users identified"})}),r.a.createElement(y.b,{queryId:R,title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersInspectButtonTitle",defaultMessage:"Related users"}),inspectIndex:0})))))};ae.displayName="HostDetails";const re="entity",ie=()=>{const{getFieldsData:e,scopeId:t}=Object(s.b)(),n=Object(l.a)(e("host.name")),a=Object(l.a)(e("user.name")),c=Object(l.a)(e("@timestamp")),u=c&&(n||a),d=a&&c,p=n&&c;return r.a.createElement(r.a.Fragment,null,u?r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m","data-test-subj":B.n},d&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(Z,{userName:a,timestamp:c,scopeId:t})),p&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(ae,{hostName:n,timestamp:c,scopeId:t}))):r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."}))};ie.displayName="EntitiesDetails"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,n){"use strict";e.exports=n(710)},function(e,t,n){"use strict";e.exports=n(711)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(371);t.default=function(e,t){var n=r.useFirstMountState();a.useEffect((function(){if(!n)return e()}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){void 0===e&&(e={});var t=a.useState(e),n=t[0],r=t[1];return[n,a.useCallback((function(e){r((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[r])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect(e,[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(373));t.default=function(e){var t=r.useRef(0),n=r.useState(e),a=n[0],o=n[1],s=r.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){o(e)}))}),[]);return i.default((function(){cancelAnimationFrame(t.current)})),[a,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(120).z.enum(["asc","desc"]);a.enum},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),r=n(45),i=n(138),o=n(243),s=n(129),l=n(206),c=n(146),u=n(121),d=n(124),p=n(183),m=n(166),f=n(127),g=n(260),b=n(513),y=n(122),h=n(274),v=n(158);const E=({timelineId:e,timelineType:t,onClick:n})=>{var E;const x=Object(r.useDispatch)(),j=Object(y.a)("unifiedComponentsInTimelineDisabled"),{id:O,patternList:S}=null!==(E=Object(r.useSelector)(m.d.defaultDataView))&&void 0!==E?E:{id:"",patternList:[]},{timelineFullScreen:w,setTimelineFullScreen:k}=Object(l.c)(),I=Object(d.a)(p.d.globalTimeRangeSelector),{resetDiscoverAppState:T}=Object(b.a)(),C=Object(a.useCallback)((({id:e,show:n,timeRange:a})=>{const r=null!=a?a:I;e===c.c.active&&w&&k(!1),x(m.a.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:O,selectedPatterns:S})),x(s.a.createTimeline({columns:j?o.b:h.a,dataViewId:O,id:e,indexNames:S,show:n,timelineType:t,updated:void 0,excludedRowRendererIds:j||t===u.m.template?[]:v.b.excludedRowRendererIds})),x(p.b.addLinkTo([i.a.global,i.a.timeline])),x(g.a.addNotes({notes:[]})),a&&x(p.b.removeLinkTo([i.a.timeline,i.a.global])),"absolute"===(null==r?void 0:r.kind)?x(p.b.setAbsoluteRangeDatePicker({...r,id:i.a.timeline})):"relative"===(null==r?void 0:r.kind)&&x(p.b.setRelativeRangeDatePicker({...r,id:i.a.timeline}))}),[x,I,O,S,k,w,t,j]);return Object(a.useCallback)((async a=>{await T(),C({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n()}),[C,e,t,n,T])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),r=n(44),i=n(4),o=n(921),s=n(519),l=n(503),c=n(174),u=n(10);const d=i.i18n.translate("xpack.securitySolution.useAlertResponseActionsSupport.notAnAlert",{defaultMessage:"Response actions are only supported for Alerts (not events)"}),p=(e=[])=>{const t=Object(a.useMemo)((()=>Object(r.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e)),[e]),n=Object(a.useMemo)((()=>{var t,n,a,i;if((null!==(t=null===(n=Object(r.find)({field:"agent.type"},e))||void 0===n?void 0:n.values)&&void 0!==t?t:[]).includes("endpoint"))return"endpoint";const o=null!==(a=null===(i=Object(r.find)({field:"event.module"},e))||void 0===i?void 0:i.values)&&void 0!==a?a:[];return o.includes("sentinel_one")?"sentinel_one":o.includes("crowdstrike")?"crowdstrike":void 0}),[e]),p=Object(a.useMemo)((()=>!!n&&Object(l.a)(n)),[n]),m=Object(a.useMemo)((()=>n?"endpoint"===n?Object(s.a)({category:"agent",field:"agent.id"},e):"sentinel_one"===n?Object(s.a)({category:"observer",field:c.b.sentinel_one},e):"crowdstrike"===n?Object(s.a)({category:"device",field:c.b.crowdstrike},e):"":""),[n,e]),f=Object(a.useMemo)((()=>Boolean(p&&t&&m&&n)),[m,n,t,p]),g=Object(a.useMemo)((()=>n?c.b[n]:""),[n]),b=Object(a.useMemo)((()=>c.e.reduce(((e,t)=>(e[t]=!1,n&&p&&(e[t]=Object(l.a)(n,t,"manual")),e)),{})),[n,p]),y=Object(a.useMemo)((()=>Object(s.a)({category:"host",field:"host.name"},e)),[e]),h=Object(a.useMemo)((()=>Object(o.a)(null!=e?e:[])),[e]),v=Object(a.useMemo)((()=>{if(!f){if(!t)return d;if(!n)return;if(!m)return e=Object(u.n)(n),a=g,i.i18n.translate("xpack.securitySolution.useAlertResponseActionsSupport.missingAgentIdField",{defaultMessage:"Alert event data missing {agentTypeName} agent identifier field ({missingField})",values:{missingField:a,agentTypeName:e}})}var e,a}),[m,g,n,f,t]);return Object(a.useMemo)((()=>({isSupported:f,unsupportedReason:v,isAlert:t,details:{agentType:n||"endpoint",agentId:m,hostName:y,platform:h,agentIdField:g,agentSupport:b}})),[m,g,n,f,y,t,h,b,v])}},function(e,t,n){"use strict";n.d(t,"u",(function(){return o})),n.d(t,"t",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"x",(function(){return c})),n.d(t,"y",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"r",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return E})),n.d(t,"A",(function(){return x})),n.d(t,"z",(function(){return j})),n.d(t,"i",(function(){return O})),n.d(t,"h",(function(){return S})),n.d(t,"g",(function(){return w})),n.d(t,"d",(function(){return k})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return T})),n.d(t,"w",(function(){return C})),n.d(t,"v",(function(){return M})),n.d(t,"c",(function(){return _})),n.d(t,"s",(function(){return D}));var a=n(4),r=n(1630);const i=(e,t)=>{switch(e){case r.a.alert:return a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityAlerts",{values:{count:t},defaultMessage:"{count, plural, =1 {alert} other {alerts}}"});case r.a.event:return a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityEvents",{values:{count:t},defaultMessage:"{count, plural, =1 {event} other {events}}"});case r.a.session:return a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entitySessions",{values:{count:t},defaultMessage:"{count, plural, =1 {session} other {sessions}}"})}},o=(e,t,n)=>a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectAllEntitiesTitle",{values:{entityPlural:i(e,n),totalFormatted:t,total:n},defaultMessage:"Select {total, plural, =1 {} other {all}} {totalFormatted} {entityPlural}"}),s=(e,t,n)=>a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectedEntitiesTitle",{values:{entityPlural:i(e,n),totalFormatted:t},defaultMessage:"Selected {totalFormatted} {entityPlural}"}),l=a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.clearSelectionTitle",{defaultMessage:"Clear selection"}),c=e=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailed",{values:{conflicts:e},defaultMessage:"Failed to update { conflicts } {conflicts, plural, =1 {alert} other {alerts}}."}),u=(e,t)=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedDetailed",{values:{updated:e,conflicts:t},defaultMessage:"{ updated } {updated, plural, =1 {alert was} other {alerts were}} updated successfully, but { conflicts } failed to update\n         because { conflicts, plural, =1 {it was} other {they were}} already being modified."}),d=e=>a.i18n.translate("xpack.securitySolution.bulkActions.closedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully closed {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),p=e=>a.i18n.translate("xpack.securitySolution.bulkActions.openedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully opened {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),m=e=>a.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully marked {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}} as acknowledged."}),f=a.i18n.translate("xpack.securitySolution.bulkActions.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),g=a.i18n.translate("xpack.securitySolution.bulkActions.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),b=a.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),y=a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedSingleAlert",{defaultMessage:"Failed to update alert because it was already being modified."}),h=a.i18n.translate("xpack.securitySolution.bulkActions.openSelectedTitle",{defaultMessage:"Mark as open"}),v=a.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedSelectedTitle",{defaultMessage:"Mark as acknowledged"}),E=a.i18n.translate("xpack.securitySolution.bulkActions.closeSelectedTitle",{defaultMessage:"Mark as closed"}),x=e=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated tags for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),j=a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsFailedToastMessage",{defaultMessage:"Failed to update alert tags."}),O=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchPlaceholderMessage",{defaultMessage:"Search tags"}),S=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchNoTagsFoundMessage",{defaultMessage:"No tags match current search"}),w=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuEmptyMessage",{defaultMessage:"No alert tag options exist, add tag options in Kibana Advanced Settings."}),k=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsApplyButtonMessage",{defaultMessage:"Apply tags"}),I=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTitle",{defaultMessage:"Apply alert tags"}),T=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTooltip",{defaultMessage:"Change alert tag options in Kibana Advanced Settings."}),C=e=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated assignees for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),M=a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesFailedToastMessage",{defaultMessage:"Failed to update alert assignees."}),_=a.i18n.translate("xpack.securitySolution.bulkActions.alertAssigneesContextMenuItemTitle",{defaultMessage:"Assign alert"}),D=a.i18n.translate("xpack.securitySolution.bulkActions.removeAlertAssignessContextMenuTitle",{defaultMessage:"Unassign alert"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(19),r=n(2),i=n.n(r),o=n(196);const s=({dataTestSubj:e,descriptionList:t})=>i.a.createElement(a.EuiFlexItem,{grow:!0},i.a.createElement(o.d,{"data-test-subj":e,listItems:t}))},,function(e,t,n){"use strict";n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return w})),n.d(t,"d",(function(){return T})),n.d(t,"b",(function(){return M})),n.d(t,"c",(function(){return _})),n.d(t,"e",(function(){return D})),n.d(t,"a",(function(){return N}));var a=n(7);const r={"@timestamp":{type:"date",array:!1,required:!0},"agent.build.original":{type:"keyword",array:!1,required:!1},"agent.ephemeral_id":{type:"keyword",array:!1,required:!1},"agent.id":{type:"keyword",array:!1,required:!1},"agent.name":{type:"keyword",array:!1,required:!1},"agent.type":{type:"keyword",array:!1,required:!1},"agent.version":{type:"keyword",array:!1,required:!1},"client.address":{type:"keyword",array:!1,required:!1},"client.as.number":{type:"long",array:!1,required:!1},"client.as.organization.name":{type:"keyword",array:!1,required:!1},"client.bytes":{type:"long",array:!1,required:!1},"client.domain":{type:"keyword",array:!1,required:!1},"client.geo.city_name":{type:"keyword",array:!1,required:!1},"client.geo.continent_code":{type:"keyword",array:!1,required:!1},"client.geo.continent_name":{type:"keyword",array:!1,required:!1},"client.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.country_name":{type:"keyword",array:!1,required:!1},"client.geo.location":{type:"geo_point",array:!1,required:!1},"client.geo.name":{type:"keyword",array:!1,required:!1},"client.geo.postal_code":{type:"keyword",array:!1,required:!1},"client.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.region_name":{type:"keyword",array:!1,required:!1},"client.geo.timezone":{type:"keyword",array:!1,required:!1},"client.ip":{type:"ip",array:!1,required:!1},"client.mac":{type:"keyword",array:!1,required:!1},"client.nat.ip":{type:"ip",array:!1,required:!1},"client.nat.port":{type:"long",array:!1,required:!1},"client.packets":{type:"long",array:!1,required:!1},"client.port":{type:"long",array:!1,required:!1},"client.registered_domain":{type:"keyword",array:!1,required:!1},"client.subdomain":{type:"keyword",array:!1,required:!1},"client.top_level_domain":{type:"keyword",array:!1,required:!1},"client.user.domain":{type:"keyword",array:!1,required:!1},"client.user.email":{type:"keyword",array:!1,required:!1},"client.user.full_name":{type:"keyword",array:!1,required:!1},"client.user.group.domain":{type:"keyword",array:!1,required:!1},"client.user.group.id":{type:"keyword",array:!1,required:!1},"client.user.group.name":{type:"keyword",array:!1,required:!1},"client.user.hash":{type:"keyword",array:!1,required:!1},"client.user.id":{type:"keyword",array:!1,required:!1},"client.user.name":{type:"keyword",array:!1,required:!1},"client.user.roles":{type:"keyword",array:!0,required:!1},"cloud.account.id":{type:"keyword",array:!1,required:!1},"cloud.account.name":{type:"keyword",array:!1,required:!1},"cloud.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.instance.id":{type:"keyword",array:!1,required:!1},"cloud.instance.name":{type:"keyword",array:!1,required:!1},"cloud.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.account.id":{type:"keyword",array:!1,required:!1},"cloud.origin.account.name":{type:"keyword",array:!1,required:!1},"cloud.origin.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.id":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.name":{type:"keyword",array:!1,required:!1},"cloud.origin.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.project.id":{type:"keyword",array:!1,required:!1},"cloud.origin.project.name":{type:"keyword",array:!1,required:!1},"cloud.origin.provider":{type:"keyword",array:!1,required:!1},"cloud.origin.region":{type:"keyword",array:!1,required:!1},"cloud.origin.service.name":{type:"keyword",array:!1,required:!1},"cloud.project.id":{type:"keyword",array:!1,required:!1},"cloud.project.name":{type:"keyword",array:!1,required:!1},"cloud.provider":{type:"keyword",array:!1,required:!1},"cloud.region":{type:"keyword",array:!1,required:!1},"cloud.service.name":{type:"keyword",array:!1,required:!1},"cloud.target.account.id":{type:"keyword",array:!1,required:!1},"cloud.target.account.name":{type:"keyword",array:!1,required:!1},"cloud.target.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.target.instance.id":{type:"keyword",array:!1,required:!1},"cloud.target.instance.name":{type:"keyword",array:!1,required:!1},"cloud.target.machine.type":{type:"keyword",array:!1,required:!1},"cloud.target.project.id":{type:"keyword",array:!1,required:!1},"cloud.target.project.name":{type:"keyword",array:!1,required:!1},"cloud.target.provider":{type:"keyword",array:!1,required:!1},"cloud.target.region":{type:"keyword",array:!1,required:!1},"cloud.target.service.name":{type:"keyword",array:!1,required:!1},"container.id":{type:"keyword",array:!1,required:!1},"container.image.name":{type:"keyword",array:!1,required:!1},"container.image.tag":{type:"keyword",array:!0,required:!1},"container.labels":{type:"object",array:!1,required:!1},"container.name":{type:"keyword",array:!1,required:!1},"container.runtime":{type:"keyword",array:!1,required:!1},"destination.address":{type:"keyword",array:!1,required:!1},"destination.as.number":{type:"long",array:!1,required:!1},"destination.as.organization.name":{type:"keyword",array:!1,required:!1},"destination.bytes":{type:"long",array:!1,required:!1},"destination.domain":{type:"keyword",array:!1,required:!1},"destination.geo.city_name":{type:"keyword",array:!1,required:!1},"destination.geo.continent_code":{type:"keyword",array:!1,required:!1},"destination.geo.continent_name":{type:"keyword",array:!1,required:!1},"destination.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.country_name":{type:"keyword",array:!1,required:!1},"destination.geo.location":{type:"geo_point",array:!1,required:!1},"destination.geo.name":{type:"keyword",array:!1,required:!1},"destination.geo.postal_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_name":{type:"keyword",array:!1,required:!1},"destination.geo.timezone":{type:"keyword",array:!1,required:!1},"destination.ip":{type:"ip",array:!1,required:!1},"destination.mac":{type:"keyword",array:!1,required:!1},"destination.nat.ip":{type:"ip",array:!1,required:!1},"destination.nat.port":{type:"long",array:!1,required:!1},"destination.packets":{type:"long",array:!1,required:!1},"destination.port":{type:"long",array:!1,required:!1},"destination.registered_domain":{type:"keyword",array:!1,required:!1},"destination.subdomain":{type:"keyword",array:!1,required:!1},"destination.top_level_domain":{type:"keyword",array:!1,required:!1},"destination.user.domain":{type:"keyword",array:!1,required:!1},"destination.user.email":{type:"keyword",array:!1,required:!1},"destination.user.full_name":{type:"keyword",array:!1,required:!1},"destination.user.group.domain":{type:"keyword",array:!1,required:!1},"destination.user.group.id":{type:"keyword",array:!1,required:!1},"destination.user.group.name":{type:"keyword",array:!1,required:!1},"destination.user.hash":{type:"keyword",array:!1,required:!1},"destination.user.id":{type:"keyword",array:!1,required:!1},"destination.user.name":{type:"keyword",array:!1,required:!1},"destination.user.roles":{type:"keyword",array:!0,required:!1},"dll.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"dll.code_signature.exists":{type:"boolean",array:!1,required:!1},"dll.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.status":{type:"keyword",array:!1,required:!1},"dll.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"dll.code_signature.team_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.timestamp":{type:"date",array:!1,required:!1},"dll.code_signature.trusted":{type:"boolean",array:!1,required:!1},"dll.code_signature.valid":{type:"boolean",array:!1,required:!1},"dll.hash.md5":{type:"keyword",array:!1,required:!1},"dll.hash.sha1":{type:"keyword",array:!1,required:!1},"dll.hash.sha256":{type:"keyword",array:!1,required:!1},"dll.hash.sha512":{type:"keyword",array:!1,required:!1},"dll.hash.ssdeep":{type:"keyword",array:!1,required:!1},"dll.name":{type:"keyword",array:!1,required:!1},"dll.path":{type:"keyword",array:!1,required:!1},"dll.pe.architecture":{type:"keyword",array:!1,required:!1},"dll.pe.company":{type:"keyword",array:!1,required:!1},"dll.pe.description":{type:"keyword",array:!1,required:!1},"dll.pe.file_version":{type:"keyword",array:!1,required:!1},"dll.pe.imphash":{type:"keyword",array:!1,required:!1},"dll.pe.original_file_name":{type:"keyword",array:!1,required:!1},"dll.pe.product":{type:"keyword",array:!1,required:!1},"dns.answers":{type:"object",array:!0,required:!1},"dns.answers.class":{type:"keyword",array:!1,required:!1},"dns.answers.data":{type:"keyword",array:!1,required:!1},"dns.answers.name":{type:"keyword",array:!1,required:!1},"dns.answers.ttl":{type:"long",array:!1,required:!1},"dns.answers.type":{type:"keyword",array:!1,required:!1},"dns.header_flags":{type:"keyword",array:!0,required:!1},"dns.id":{type:"keyword",array:!1,required:!1},"dns.op_code":{type:"keyword",array:!1,required:!1},"dns.question.class":{type:"keyword",array:!1,required:!1},"dns.question.name":{type:"keyword",array:!1,required:!1},"dns.question.registered_domain":{type:"keyword",array:!1,required:!1},"dns.question.subdomain":{type:"keyword",array:!1,required:!1},"dns.question.top_level_domain":{type:"keyword",array:!1,required:!1},"dns.question.type":{type:"keyword",array:!1,required:!1},"dns.resolved_ip":{type:"ip",array:!0,required:!1},"dns.response_code":{type:"keyword",array:!1,required:!1},"dns.type":{type:"keyword",array:!1,required:!1},"ecs.version":{type:"keyword",array:!1,required:!0},"error.code":{type:"keyword",array:!1,required:!1},"error.id":{type:"keyword",array:!1,required:!1},"error.message":{type:"match_only_text",array:!1,required:!1},"error.stack_trace":{type:"wildcard",array:!1,required:!1},"error.type":{type:"keyword",array:!1,required:!1},"event.action":{type:"keyword",array:!1,required:!1},"event.agent_id_status":{type:"keyword",array:!1,required:!1},"event.category":{type:"keyword",array:!0,required:!1},"event.code":{type:"keyword",array:!1,required:!1},"event.created":{type:"date",array:!1,required:!1},"event.dataset":{type:"keyword",array:!1,required:!1},"event.duration":{type:"long",array:!1,required:!1},"event.end":{type:"date",array:!1,required:!1},"event.hash":{type:"keyword",array:!1,required:!1},"event.id":{type:"keyword",array:!1,required:!1},"event.ingested":{type:"date",array:!1,required:!1},"event.kind":{type:"keyword",array:!1,required:!1},"event.module":{type:"keyword",array:!1,required:!1},"event.original":{type:"keyword",array:!1,required:!1},"event.outcome":{type:"keyword",array:!1,required:!1},"event.provider":{type:"keyword",array:!1,required:!1},"event.reason":{type:"keyword",array:!1,required:!1},"event.reference":{type:"keyword",array:!1,required:!1},"event.risk_score":{type:"float",array:!1,required:!1},"event.risk_score_norm":{type:"float",array:!1,required:!1},"event.sequence":{type:"long",array:!1,required:!1},"event.severity":{type:"long",array:!1,required:!1},"event.start":{type:"date",array:!1,required:!1},"event.timezone":{type:"keyword",array:!1,required:!1},"event.type":{type:"keyword",array:!0,required:!1},"event.url":{type:"keyword",array:!1,required:!1},"faas.coldstart":{type:"boolean",array:!1,required:!1},"faas.execution":{type:"keyword",array:!1,required:!1},"faas.trigger":{type:"nested",array:!1,required:!1},"faas.trigger.request_id":{type:"keyword",array:!1,required:!1},"faas.trigger.type":{type:"keyword",array:!1,required:!1},"file.accessed":{type:"date",array:!1,required:!1},"file.attributes":{type:"keyword",array:!0,required:!1},"file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"file.code_signature.exists":{type:"boolean",array:!1,required:!1},"file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"file.code_signature.status":{type:"keyword",array:!1,required:!1},"file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"file.code_signature.timestamp":{type:"date",array:!1,required:!1},"file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"file.code_signature.valid":{type:"boolean",array:!1,required:!1},"file.created":{type:"date",array:!1,required:!1},"file.ctime":{type:"date",array:!1,required:!1},"file.device":{type:"keyword",array:!1,required:!1},"file.directory":{type:"keyword",array:!1,required:!1},"file.drive_letter":{type:"keyword",array:!1,required:!1},"file.elf.architecture":{type:"keyword",array:!1,required:!1},"file.elf.byte_order":{type:"keyword",array:!1,required:!1},"file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"file.elf.creation_date":{type:"date",array:!1,required:!1},"file.elf.exports":{type:"flattened",array:!0,required:!1},"file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"file.elf.header.class":{type:"keyword",array:!1,required:!1},"file.elf.header.data":{type:"keyword",array:!1,required:!1},"file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"file.elf.header.type":{type:"keyword",array:!1,required:!1},"file.elf.header.version":{type:"keyword",array:!1,required:!1},"file.elf.imports":{type:"flattened",array:!0,required:!1},"file.elf.sections":{type:"nested",array:!0,required:!1},"file.elf.sections.chi2":{type:"long",array:!1,required:!1},"file.elf.sections.entropy":{type:"long",array:!1,required:!1},"file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"file.elf.sections.name":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"file.elf.sections.type":{type:"keyword",array:!1,required:!1},"file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"file.elf.segments":{type:"nested",array:!0,required:!1},"file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"file.elf.segments.type":{type:"keyword",array:!1,required:!1},"file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"file.elf.telfhash":{type:"keyword",array:!1,required:!1},"file.extension":{type:"keyword",array:!1,required:!1},"file.fork_name":{type:"keyword",array:!1,required:!1},"file.gid":{type:"keyword",array:!1,required:!1},"file.group":{type:"keyword",array:!1,required:!1},"file.hash.md5":{type:"keyword",array:!1,required:!1},"file.hash.sha1":{type:"keyword",array:!1,required:!1},"file.hash.sha256":{type:"keyword",array:!1,required:!1},"file.hash.sha512":{type:"keyword",array:!1,required:!1},"file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"file.inode":{type:"keyword",array:!1,required:!1},"file.mime_type":{type:"keyword",array:!1,required:!1},"file.mode":{type:"keyword",array:!1,required:!1},"file.mtime":{type:"date",array:!1,required:!1},"file.name":{type:"keyword",array:!1,required:!1},"file.owner":{type:"keyword",array:!1,required:!1},"file.path":{type:"keyword",array:!1,required:!1},"file.pe.architecture":{type:"keyword",array:!1,required:!1},"file.pe.company":{type:"keyword",array:!1,required:!1},"file.pe.description":{type:"keyword",array:!1,required:!1},"file.pe.file_version":{type:"keyword",array:!1,required:!1},"file.pe.imphash":{type:"keyword",array:!1,required:!1},"file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"file.pe.product":{type:"keyword",array:!1,required:!1},"file.size":{type:"long",array:!1,required:!1},"file.target_path":{type:"keyword",array:!1,required:!1},"file.type":{type:"keyword",array:!1,required:!1},"file.uid":{type:"keyword",array:!1,required:!1},"file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.not_after":{type:"date",array:!1,required:!1},"file.x509.not_before":{type:"date",array:!1,required:!1},"file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"file.x509.public_key_size":{type:"long",array:!1,required:!1},"file.x509.serial_number":{type:"keyword",array:!1,required:!1},"file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"file.x509.subject.country":{type:"keyword",array:!0,required:!1},"file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.version_number":{type:"keyword",array:!1,required:!1},"group.domain":{type:"keyword",array:!1,required:!1},"group.id":{type:"keyword",array:!1,required:!1},"group.name":{type:"keyword",array:!1,required:!1},"host.architecture":{type:"keyword",array:!1,required:!1},"host.boot.id":{type:"keyword",array:!1,required:!1},"host.cpu.usage":{type:"scaled_float",array:!1,required:!1,scaling_factor:1e3},"host.disk.read.bytes":{type:"long",array:!1,required:!1},"host.disk.write.bytes":{type:"long",array:!1,required:!1},"host.domain":{type:"keyword",array:!1,required:!1},"host.geo.city_name":{type:"keyword",array:!1,required:!1},"host.geo.continent_code":{type:"keyword",array:!1,required:!1},"host.geo.continent_name":{type:"keyword",array:!1,required:!1},"host.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.country_name":{type:"keyword",array:!1,required:!1},"host.geo.location":{type:"geo_point",array:!1,required:!1},"host.geo.name":{type:"keyword",array:!1,required:!1},"host.geo.postal_code":{type:"keyword",array:!1,required:!1},"host.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.region_name":{type:"keyword",array:!1,required:!1},"host.geo.timezone":{type:"keyword",array:!1,required:!1},"host.hostname":{type:"keyword",array:!1,required:!1},"host.id":{type:"keyword",array:!1,required:!1},"host.ip":{type:"ip",array:!0,required:!1},"host.mac":{type:"keyword",array:!0,required:!1},"host.name":{type:"keyword",array:!1,required:!1},"host.network.egress.bytes":{type:"long",array:!1,required:!1},"host.network.egress.packets":{type:"long",array:!1,required:!1},"host.network.ingress.bytes":{type:"long",array:!1,required:!1},"host.network.ingress.packets":{type:"long",array:!1,required:!1},"host.os.family":{type:"keyword",array:!1,required:!1},"host.os.full":{type:"keyword",array:!1,required:!1},"host.os.kernel":{type:"keyword",array:!1,required:!1},"host.os.name":{type:"keyword",array:!1,required:!1},"host.os.platform":{type:"keyword",array:!1,required:!1},"host.os.type":{type:"keyword",array:!1,required:!1},"host.os.version":{type:"keyword",array:!1,required:!1},"host.pid_ns_ino":{type:"keyword",array:!1,required:!1},"host.risk.calculated_level":{type:"keyword",array:!1,required:!1},"host.risk.calculated_score":{type:"float",array:!1,required:!1},"host.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"host.risk.static_level":{type:"keyword",array:!1,required:!1},"host.risk.static_score":{type:"float",array:!1,required:!1},"host.risk.static_score_norm":{type:"float",array:!1,required:!1},"host.type":{type:"keyword",array:!1,required:!1},"host.uptime":{type:"long",array:!1,required:!1},"http.request.body.bytes":{type:"long",array:!1,required:!1},"http.request.body.content":{type:"wildcard",array:!1,required:!1},"http.request.bytes":{type:"long",array:!1,required:!1},"http.request.id":{type:"keyword",array:!1,required:!1},"http.request.method":{type:"keyword",array:!1,required:!1},"http.request.mime_type":{type:"keyword",array:!1,required:!1},"http.request.referrer":{type:"keyword",array:!1,required:!1},"http.response.body.bytes":{type:"long",array:!1,required:!1},"http.response.body.content":{type:"wildcard",array:!1,required:!1},"http.response.bytes":{type:"long",array:!1,required:!1},"http.response.mime_type":{type:"keyword",array:!1,required:!1},"http.response.status_code":{type:"long",array:!1,required:!1},"http.version":{type:"keyword",array:!1,required:!1},labels:{type:"object",array:!1,required:!1},"log.file.path":{type:"keyword",array:!1,required:!1},"log.level":{type:"keyword",array:!1,required:!1},"log.logger":{type:"keyword",array:!1,required:!1},"log.origin.file.line":{type:"long",array:!1,required:!1},"log.origin.file.name":{type:"keyword",array:!1,required:!1},"log.origin.function":{type:"keyword",array:!1,required:!1},"log.syslog":{type:"object",array:!1,required:!1},"log.syslog.facility.code":{type:"long",array:!1,required:!1},"log.syslog.facility.name":{type:"keyword",array:!1,required:!1},"log.syslog.priority":{type:"long",array:!1,required:!1},"log.syslog.severity.code":{type:"long",array:!1,required:!1},"log.syslog.severity.name":{type:"keyword",array:!1,required:!1},message:{type:"match_only_text",array:!1,required:!1},"network.application":{type:"keyword",array:!1,required:!1},"network.bytes":{type:"long",array:!1,required:!1},"network.community_id":{type:"keyword",array:!1,required:!1},"network.direction":{type:"keyword",array:!1,required:!1},"network.forwarded_ip":{type:"ip",array:!1,required:!1},"network.iana_number":{type:"keyword",array:!1,required:!1},"network.inner":{type:"object",array:!1,required:!1},"network.inner.vlan.id":{type:"keyword",array:!1,required:!1},"network.inner.vlan.name":{type:"keyword",array:!1,required:!1},"network.name":{type:"keyword",array:!1,required:!1},"network.packets":{type:"long",array:!1,required:!1},"network.protocol":{type:"keyword",array:!1,required:!1},"network.transport":{type:"keyword",array:!1,required:!1},"network.type":{type:"keyword",array:!1,required:!1},"network.vlan.id":{type:"keyword",array:!1,required:!1},"network.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress":{type:"object",array:!1,required:!1},"observer.egress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.egress.interface.id":{type:"keyword",array:!1,required:!1},"observer.egress.interface.name":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress.zone":{type:"keyword",array:!1,required:!1},"observer.geo.city_name":{type:"keyword",array:!1,required:!1},"observer.geo.continent_code":{type:"keyword",array:!1,required:!1},"observer.geo.continent_name":{type:"keyword",array:!1,required:!1},"observer.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.country_name":{type:"keyword",array:!1,required:!1},"observer.geo.location":{type:"geo_point",array:!1,required:!1},"observer.geo.name":{type:"keyword",array:!1,required:!1},"observer.geo.postal_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_name":{type:"keyword",array:!1,required:!1},"observer.geo.timezone":{type:"keyword",array:!1,required:!1},"observer.hostname":{type:"keyword",array:!1,required:!1},"observer.ingress":{type:"object",array:!1,required:!1},"observer.ingress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.id":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.name":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.ingress.zone":{type:"keyword",array:!1,required:!1},"observer.ip":{type:"ip",array:!0,required:!1},"observer.mac":{type:"keyword",array:!0,required:!1},"observer.name":{type:"keyword",array:!1,required:!1},"observer.os.family":{type:"keyword",array:!1,required:!1},"observer.os.full":{type:"keyword",array:!1,required:!1},"observer.os.kernel":{type:"keyword",array:!1,required:!1},"observer.os.name":{type:"keyword",array:!1,required:!1},"observer.os.platform":{type:"keyword",array:!1,required:!1},"observer.os.type":{type:"keyword",array:!1,required:!1},"observer.os.version":{type:"keyword",array:!1,required:!1},"observer.product":{type:"keyword",array:!1,required:!1},"observer.serial_number":{type:"keyword",array:!1,required:!1},"observer.type":{type:"keyword",array:!1,required:!1},"observer.vendor":{type:"keyword",array:!1,required:!1},"observer.version":{type:"keyword",array:!1,required:!1},"orchestrator.api_version":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.id":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.name":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.url":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.version":{type:"keyword",array:!1,required:!1},"orchestrator.namespace":{type:"keyword",array:!1,required:!1},"orchestrator.organization":{type:"keyword",array:!1,required:!1},"orchestrator.resource.id":{type:"keyword",array:!1,required:!1},"orchestrator.resource.ip":{type:"ip",array:!0,required:!1},"orchestrator.resource.name":{type:"keyword",array:!1,required:!1},"orchestrator.resource.parent.type":{type:"keyword",array:!1,required:!1},"orchestrator.resource.type":{type:"keyword",array:!1,required:!1},"orchestrator.type":{type:"keyword",array:!1,required:!1},"organization.id":{type:"keyword",array:!1,required:!1},"organization.name":{type:"keyword",array:!1,required:!1},"package.architecture":{type:"keyword",array:!1,required:!1},"package.build_version":{type:"keyword",array:!1,required:!1},"package.checksum":{type:"keyword",array:!1,required:!1},"package.description":{type:"keyword",array:!1,required:!1},"package.install_scope":{type:"keyword",array:!1,required:!1},"package.installed":{type:"date",array:!1,required:!1},"package.license":{type:"keyword",array:!1,required:!1},"package.name":{type:"keyword",array:!1,required:!1},"package.path":{type:"keyword",array:!1,required:!1},"package.reference":{type:"keyword",array:!1,required:!1},"package.size":{type:"long",array:!1,required:!1},"package.type":{type:"keyword",array:!1,required:!1},"package.version":{type:"keyword",array:!1,required:!1},"process.args":{type:"keyword",array:!0,required:!1},"process.args_count":{type:"long",array:!1,required:!1},"process.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.code_signature.status":{type:"keyword",array:!1,required:!1},"process.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.command_line":{type:"wildcard",array:!1,required:!1},"process.elf.architecture":{type:"keyword",array:!1,required:!1},"process.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.elf.creation_date":{type:"date",array:!1,required:!1},"process.elf.exports":{type:"flattened",array:!0,required:!1},"process.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.elf.header.class":{type:"keyword",array:!1,required:!1},"process.elf.header.data":{type:"keyword",array:!1,required:!1},"process.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.elf.header.type":{type:"keyword",array:!1,required:!1},"process.elf.header.version":{type:"keyword",array:!1,required:!1},"process.elf.imports":{type:"flattened",array:!0,required:!1},"process.elf.sections":{type:"nested",array:!0,required:!1},"process.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.elf.segments":{type:"nested",array:!0,required:!1},"process.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.end":{type:"date",array:!1,required:!1},"process.entity_id":{type:"keyword",array:!1,required:!1},"process.entry_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.executable":{type:"keyword",array:!1,required:!1},"process.exit_code":{type:"long",array:!1,required:!1},"process.hash.md5":{type:"keyword",array:!1,required:!1},"process.hash.sha1":{type:"keyword",array:!1,required:!1},"process.hash.sha256":{type:"keyword",array:!1,required:!1},"process.hash.sha512":{type:"keyword",array:!1,required:!1},"process.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.name":{type:"keyword",array:!1,required:!1},"process.parent.args":{type:"keyword",array:!0,required:!1},"process.parent.args_count":{type:"long",array:!1,required:!1},"process.parent.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.status":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.parent.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.parent.command_line":{type:"wildcard",array:!1,required:!1},"process.parent.elf.architecture":{type:"keyword",array:!1,required:!1},"process.parent.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.parent.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.parent.elf.creation_date":{type:"date",array:!1,required:!1},"process.parent.elf.exports":{type:"flattened",array:!0,required:!1},"process.parent.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.class":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.data":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.parent.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.version":{type:"keyword",array:!1,required:!1},"process.parent.elf.imports":{type:"flattened",array:!0,required:!1},"process.parent.elf.sections":{type:"nested",array:!0,required:!1},"process.parent.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.parent.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.parent.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.parent.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.parent.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.parent.elf.segments":{type:"nested",array:!0,required:!1},"process.parent.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.parent.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.parent.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.parent.end":{type:"date",array:!1,required:!1},"process.parent.entity_id":{type:"keyword",array:!1,required:!1},"process.parent.executable":{type:"keyword",array:!1,required:!1},"process.parent.exit_code":{type:"long",array:!1,required:!1},"process.parent.hash.md5":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha1":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha256":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha512":{type:"keyword",array:!1,required:!1},"process.parent.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.parent.name":{type:"keyword",array:!1,required:!1},"process.parent.pe.architecture":{type:"keyword",array:!1,required:!1},"process.parent.pe.company":{type:"keyword",array:!1,required:!1},"process.parent.pe.description":{type:"keyword",array:!1,required:!1},"process.parent.pe.file_version":{type:"keyword",array:!1,required:!1},"process.parent.pe.imphash":{type:"keyword",array:!1,required:!1},"process.parent.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.parent.pe.product":{type:"keyword",array:!1,required:!1},"process.parent.pgid":{type:"long",array:!1,required:!1},"process.parent.pid":{type:"long",array:!1,required:!1},"process.parent.start":{type:"date",array:!1,required:!1},"process.parent.thread.id":{type:"long",array:!1,required:!1},"process.parent.thread.name":{type:"keyword",array:!1,required:!1},"process.parent.title":{type:"keyword",array:!1,required:!1},"process.parent.uptime":{type:"long",array:!1,required:!1},"process.parent.working_directory":{type:"keyword",array:!1,required:!1},"process.pe.architecture":{type:"keyword",array:!1,required:!1},"process.pe.company":{type:"keyword",array:!1,required:!1},"process.pe.description":{type:"keyword",array:!1,required:!1},"process.pe.file_version":{type:"keyword",array:!1,required:!1},"process.pe.imphash":{type:"keyword",array:!1,required:!1},"process.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.pe.product":{type:"keyword",array:!1,required:!1},"process.pgid":{type:"long",array:!1,required:!1},"process.pid":{type:"long",array:!1,required:!1},"process.session_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.start":{type:"date",array:!1,required:!1},"process.thread.id":{type:"long",array:!1,required:!1},"process.thread.name":{type:"keyword",array:!1,required:!1},"process.title":{type:"keyword",array:!1,required:!1},"process.uptime":{type:"long",array:!1,required:!1},"process.working_directory":{type:"keyword",array:!1,required:!1},"registry.data.bytes":{type:"keyword",array:!1,required:!1},"registry.data.strings":{type:"wildcard",array:!0,required:!1},"registry.data.type":{type:"keyword",array:!1,required:!1},"registry.hive":{type:"keyword",array:!1,required:!1},"registry.key":{type:"keyword",array:!1,required:!1},"registry.path":{type:"keyword",array:!1,required:!1},"registry.value":{type:"keyword",array:!1,required:!1},"related.hash":{type:"keyword",array:!0,required:!1},"related.hosts":{type:"keyword",array:!0,required:!1},"related.ip":{type:"ip",array:!0,required:!1},"related.user":{type:"keyword",array:!0,required:!1},"rule.author":{type:"keyword",array:!0,required:!1},"rule.category":{type:"keyword",array:!1,required:!1},"rule.description":{type:"keyword",array:!1,required:!1},"rule.id":{type:"keyword",array:!1,required:!1},"rule.license":{type:"keyword",array:!1,required:!1},"rule.name":{type:"keyword",array:!1,required:!1},"rule.reference":{type:"keyword",array:!1,required:!1},"rule.ruleset":{type:"keyword",array:!1,required:!1},"rule.uuid":{type:"keyword",array:!1,required:!1},"rule.version":{type:"keyword",array:!1,required:!1},"server.address":{type:"keyword",array:!1,required:!1},"server.as.number":{type:"long",array:!1,required:!1},"server.as.organization.name":{type:"keyword",array:!1,required:!1},"server.bytes":{type:"long",array:!1,required:!1},"server.domain":{type:"keyword",array:!1,required:!1},"server.geo.city_name":{type:"keyword",array:!1,required:!1},"server.geo.continent_code":{type:"keyword",array:!1,required:!1},"server.geo.continent_name":{type:"keyword",array:!1,required:!1},"server.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.country_name":{type:"keyword",array:!1,required:!1},"server.geo.location":{type:"geo_point",array:!1,required:!1},"server.geo.name":{type:"keyword",array:!1,required:!1},"server.geo.postal_code":{type:"keyword",array:!1,required:!1},"server.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.region_name":{type:"keyword",array:!1,required:!1},"server.geo.timezone":{type:"keyword",array:!1,required:!1},"server.ip":{type:"ip",array:!1,required:!1},"server.mac":{type:"keyword",array:!1,required:!1},"server.nat.ip":{type:"ip",array:!1,required:!1},"server.nat.port":{type:"long",array:!1,required:!1},"server.packets":{type:"long",array:!1,required:!1},"server.port":{type:"long",array:!1,required:!1},"server.registered_domain":{type:"keyword",array:!1,required:!1},"server.subdomain":{type:"keyword",array:!1,required:!1},"server.top_level_domain":{type:"keyword",array:!1,required:!1},"server.user.domain":{type:"keyword",array:!1,required:!1},"server.user.email":{type:"keyword",array:!1,required:!1},"server.user.full_name":{type:"keyword",array:!1,required:!1},"server.user.group.domain":{type:"keyword",array:!1,required:!1},"server.user.group.id":{type:"keyword",array:!1,required:!1},"server.user.group.name":{type:"keyword",array:!1,required:!1},"server.user.hash":{type:"keyword",array:!1,required:!1},"server.user.id":{type:"keyword",array:!1,required:!1},"server.user.name":{type:"keyword",array:!1,required:!1},"server.user.roles":{type:"keyword",array:!0,required:!1},"service.address":{type:"keyword",array:!1,required:!1},"service.environment":{type:"keyword",array:!1,required:!1},"service.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.id":{type:"keyword",array:!1,required:!1},"service.name":{type:"keyword",array:!1,required:!1},"service.node.name":{type:"keyword",array:!1,required:!1},"service.origin.address":{type:"keyword",array:!1,required:!1},"service.origin.environment":{type:"keyword",array:!1,required:!1},"service.origin.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.origin.id":{type:"keyword",array:!1,required:!1},"service.origin.name":{type:"keyword",array:!1,required:!1},"service.origin.node.name":{type:"keyword",array:!1,required:!1},"service.origin.state":{type:"keyword",array:!1,required:!1},"service.origin.type":{type:"keyword",array:!1,required:!1},"service.origin.version":{type:"keyword",array:!1,required:!1},"service.state":{type:"keyword",array:!1,required:!1},"service.target.address":{type:"keyword",array:!1,required:!1},"service.target.environment":{type:"keyword",array:!1,required:!1},"service.target.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.target.id":{type:"keyword",array:!1,required:!1},"service.target.name":{type:"keyword",array:!1,required:!1},"service.target.node.name":{type:"keyword",array:!1,required:!1},"service.target.state":{type:"keyword",array:!1,required:!1},"service.target.type":{type:"keyword",array:!1,required:!1},"service.target.version":{type:"keyword",array:!1,required:!1},"service.type":{type:"keyword",array:!1,required:!1},"service.version":{type:"keyword",array:!1,required:!1},"source.address":{type:"keyword",array:!1,required:!1},"source.as.number":{type:"long",array:!1,required:!1},"source.as.organization.name":{type:"keyword",array:!1,required:!1},"source.bytes":{type:"long",array:!1,required:!1},"source.domain":{type:"keyword",array:!1,required:!1},"source.geo.city_name":{type:"keyword",array:!1,required:!1},"source.geo.continent_code":{type:"keyword",array:!1,required:!1},"source.geo.continent_name":{type:"keyword",array:!1,required:!1},"source.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.country_name":{type:"keyword",array:!1,required:!1},"source.geo.location":{type:"geo_point",array:!1,required:!1},"source.geo.name":{type:"keyword",array:!1,required:!1},"source.geo.postal_code":{type:"keyword",array:!1,required:!1},"source.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.region_name":{type:"keyword",array:!1,required:!1},"source.geo.timezone":{type:"keyword",array:!1,required:!1},"source.ip":{type:"ip",array:!1,required:!1},"source.mac":{type:"keyword",array:!1,required:!1},"source.nat.ip":{type:"ip",array:!1,required:!1},"source.nat.port":{type:"long",array:!1,required:!1},"source.packets":{type:"long",array:!1,required:!1},"source.port":{type:"long",array:!1,required:!1},"source.registered_domain":{type:"keyword",array:!1,required:!1},"source.subdomain":{type:"keyword",array:!1,required:!1},"source.top_level_domain":{type:"keyword",array:!1,required:!1},"source.user.domain":{type:"keyword",array:!1,required:!1},"source.user.email":{type:"keyword",array:!1,required:!1},"source.user.full_name":{type:"keyword",array:!1,required:!1},"source.user.group.domain":{type:"keyword",array:!1,required:!1},"source.user.group.id":{type:"keyword",array:!1,required:!1},"source.user.group.name":{type:"keyword",array:!1,required:!1},"source.user.hash":{type:"keyword",array:!1,required:!1},"source.user.id":{type:"keyword",array:!1,required:!1},"source.user.name":{type:"keyword",array:!1,required:!1},"source.user.roles":{type:"keyword",array:!0,required:!1},"span.id":{type:"keyword",array:!1,required:!1},tags:{type:"keyword",array:!0,required:!1},"threat.enrichments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator":{type:"object",array:!1,required:!1},"threat.enrichments.indicator.as.number":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.created":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.enrichments.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.ip":{type:"ip",array:!1,required:!1},"threat.enrichments.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.enrichments.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.sightings":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.atomic":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.field":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.id":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.index":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.type":{type:"keyword",array:!1,required:!1},"threat.framework":{type:"keyword",array:!1,required:!1},"threat.group.alias":{type:"keyword",array:!0,required:!1},"threat.group.id":{type:"keyword",array:!1,required:!1},"threat.group.name":{type:"keyword",array:!1,required:!1},"threat.group.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.as.number":{type:"long",array:!1,required:!1},"threat.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.indicator.description":{type:"keyword",array:!1,required:!1},"threat.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.indicator.file.created":{type:"date",array:!1,required:!1},"threat.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.indicator.file.size":{type:"long",array:!1,required:!1},"threat.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.indicator.ip":{type:"ip",array:!1,required:!1},"threat.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.indicator.port":{type:"long",array:!1,required:!1},"threat.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.indicator.sightings":{type:"long",array:!1,required:!1},"threat.indicator.type":{type:"keyword",array:!1,required:!1},"threat.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.port":{type:"long",array:!1,required:!1},"threat.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.software.alias":{type:"keyword",array:!0,required:!1},"threat.software.id":{type:"keyword",array:!1,required:!1},"threat.software.name":{type:"keyword",array:!1,required:!1},"threat.software.platforms":{type:"keyword",array:!0,required:!1},"threat.software.reference":{type:"keyword",array:!1,required:!1},"threat.software.type":{type:"keyword",array:!1,required:!1},"threat.tactic.id":{type:"keyword",array:!0,required:!1},"threat.tactic.name":{type:"keyword",array:!0,required:!1},"threat.tactic.reference":{type:"keyword",array:!0,required:!1},"threat.technique.id":{type:"keyword",array:!0,required:!1},"threat.technique.name":{type:"keyword",array:!0,required:!1},"threat.technique.reference":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.id":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.name":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.reference":{type:"keyword",array:!0,required:!1},"tls.cipher":{type:"keyword",array:!1,required:!1},"tls.client.certificate":{type:"keyword",array:!1,required:!1},"tls.client.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.client.hash.md5":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.client.issuer":{type:"keyword",array:!1,required:!1},"tls.client.ja3":{type:"keyword",array:!1,required:!1},"tls.client.not_after":{type:"date",array:!1,required:!1},"tls.client.not_before":{type:"date",array:!1,required:!1},"tls.client.server_name":{type:"keyword",array:!1,required:!1},"tls.client.subject":{type:"keyword",array:!1,required:!1},"tls.client.supported_ciphers":{type:"keyword",array:!0,required:!1},"tls.client.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.not_after":{type:"date",array:!1,required:!1},"tls.client.x509.not_before":{type:"date",array:!1,required:!1},"tls.client.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.client.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.client.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.client.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.curve":{type:"keyword",array:!1,required:!1},"tls.established":{type:"boolean",array:!1,required:!1},"tls.next_protocol":{type:"keyword",array:!1,required:!1},"tls.resumed":{type:"boolean",array:!1,required:!1},"tls.server.certificate":{type:"keyword",array:!1,required:!1},"tls.server.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.server.hash.md5":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.server.issuer":{type:"keyword",array:!1,required:!1},"tls.server.ja3s":{type:"keyword",array:!1,required:!1},"tls.server.not_after":{type:"date",array:!1,required:!1},"tls.server.not_before":{type:"date",array:!1,required:!1},"tls.server.subject":{type:"keyword",array:!1,required:!1},"tls.server.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.not_after":{type:"date",array:!1,required:!1},"tls.server.x509.not_before":{type:"date",array:!1,required:!1},"tls.server.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.server.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.server.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.server.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.version":{type:"keyword",array:!1,required:!1},"tls.version_protocol":{type:"keyword",array:!1,required:!1},"trace.id":{type:"keyword",array:!1,required:!1},"transaction.id":{type:"keyword",array:!1,required:!1},"url.domain":{type:"keyword",array:!1,required:!1},"url.extension":{type:"keyword",array:!1,required:!1},"url.fragment":{type:"keyword",array:!1,required:!1},"url.full":{type:"wildcard",array:!1,required:!1},"url.original":{type:"wildcard",array:!1,required:!1},"url.password":{type:"keyword",array:!1,required:!1},"url.path":{type:"wildcard",array:!1,required:!1},"url.port":{type:"long",array:!1,required:!1},"url.query":{type:"keyword",array:!1,required:!1},"url.registered_domain":{type:"keyword",array:!1,required:!1},"url.scheme":{type:"keyword",array:!1,required:!1},"url.subdomain":{type:"keyword",array:!1,required:!1},"url.top_level_domain":{type:"keyword",array:!1,required:!1},"url.username":{type:"keyword",array:!1,required:!1},"user.changes.domain":{type:"keyword",array:!1,required:!1},"user.changes.email":{type:"keyword",array:!1,required:!1},"user.changes.full_name":{type:"keyword",array:!1,required:!1},"user.changes.group.domain":{type:"keyword",array:!1,required:!1},"user.changes.group.id":{type:"keyword",array:!1,required:!1},"user.changes.group.name":{type:"keyword",array:!1,required:!1},"user.changes.hash":{type:"keyword",array:!1,required:!1},"user.changes.id":{type:"keyword",array:!1,required:!1},"user.changes.name":{type:"keyword",array:!1,required:!1},"user.changes.roles":{type:"keyword",array:!0,required:!1},"user.domain":{type:"keyword",array:!1,required:!1},"user.effective.domain":{type:"keyword",array:!1,required:!1},"user.effective.email":{type:"keyword",array:!1,required:!1},"user.effective.full_name":{type:"keyword",array:!1,required:!1},"user.effective.group.domain":{type:"keyword",array:!1,required:!1},"user.effective.group.id":{type:"keyword",array:!1,required:!1},"user.effective.group.name":{type:"keyword",array:!1,required:!1},"user.effective.hash":{type:"keyword",array:!1,required:!1},"user.effective.id":{type:"keyword",array:!1,required:!1},"user.effective.name":{type:"keyword",array:!1,required:!1},"user.effective.roles":{type:"keyword",array:!0,required:!1},"user.email":{type:"keyword",array:!1,required:!1},"user.full_name":{type:"keyword",array:!1,required:!1},"user.group.domain":{type:"keyword",array:!1,required:!1},"user.group.id":{type:"keyword",array:!1,required:!1},"user.group.name":{type:"keyword",array:!1,required:!1},"user.hash":{type:"keyword",array:!1,required:!1},"user.id":{type:"keyword",array:!1,required:!1},"user.name":{type:"keyword",array:!1,required:!1},"user.risk.calculated_level":{type:"keyword",array:!1,required:!1},"user.risk.calculated_score":{type:"float",array:!1,required:!1},"user.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"user.risk.static_level":{type:"keyword",array:!1,required:!1},"user.risk.static_score":{type:"float",array:!1,required:!1},"user.risk.static_score_norm":{type:"float",array:!1,required:!1},"user.roles":{type:"keyword",array:!0,required:!1},"user.target.domain":{type:"keyword",array:!1,required:!1},"user.target.email":{type:"keyword",array:!1,required:!1},"user.target.full_name":{type:"keyword",array:!1,required:!1},"user.target.group.domain":{type:"keyword",array:!1,required:!1},"user.target.group.id":{type:"keyword",array:!1,required:!1},"user.target.group.name":{type:"keyword",array:!1,required:!1},"user.target.hash":{type:"keyword",array:!1,required:!1},"user.target.id":{type:"keyword",array:!1,required:!1},"user.target.name":{type:"keyword",array:!1,required:!1},"user.target.roles":{type:"keyword",array:!0,required:!1},"user_agent.device.name":{type:"keyword",array:!1,required:!1},"user_agent.name":{type:"keyword",array:!1,required:!1},"user_agent.original":{type:"keyword",array:!1,required:!1},"user_agent.os.family":{type:"keyword",array:!1,required:!1},"user_agent.os.full":{type:"keyword",array:!1,required:!1},"user_agent.os.kernel":{type:"keyword",array:!1,required:!1},"user_agent.os.name":{type:"keyword",array:!1,required:!1},"user_agent.os.platform":{type:"keyword",array:!1,required:!1},"user_agent.os.type":{type:"keyword",array:!1,required:!1},"user_agent.os.version":{type:"keyword",array:!1,required:!1},"user_agent.version":{type:"keyword",array:!1,required:!1},"vulnerability.category":{type:"keyword",array:!0,required:!1},"vulnerability.classification":{type:"keyword",array:!1,required:!1},"vulnerability.description":{type:"keyword",array:!1,required:!1},"vulnerability.enumeration":{type:"keyword",array:!1,required:!1},"vulnerability.id":{type:"keyword",array:!1,required:!1},"vulnerability.reference":{type:"keyword",array:!1,required:!1},"vulnerability.report_id":{type:"keyword",array:!1,required:!1},"vulnerability.scanner.vendor":{type:"keyword",array:!1,required:!1},"vulnerability.score.base":{type:"float",array:!1,required:!1},"vulnerability.score.environmental":{type:"float",array:!1,required:!1},"vulnerability.score.temporal":{type:"float",array:!1,required:!1},"vulnerability.score.version":{type:"keyword",array:!1,required:!1},"vulnerability.severity":{type:"keyword",array:!1,required:!1}};var i=n(1341);const o={[i.c]:{type:"scaled_float",scaling_factor:100,required:!1},[i.d]:{type:"scaled_float",scaling_factor:100,required:!1},[i.b]:{type:"object",array:!1,required:!1},[i.e]:{type:"scaled_float",scaling_factor:100,required:!1,array:!0},[i.f]:{type:"object",array:!0,required:!1},[i.g]:{type:"keyword",array:!0,required:!1},[i.h]:{type:"keyword",array:!0,required:!1}};var s=n(748),l=n(813);const c={[s.a]:{type:"keyword",array:!1,required:!1},[s.b]:{type:"keyword",array:!0,required:!1},[s.d]:{type:"long",array:!1,required:!1},[s.e]:{type:"date",array:!1,required:!1},[s.f]:{type:"boolean",array:!1,required:!1},[s.g]:{type:"boolean",array:!0,required:!1},[s.j]:{type:"keyword",array:!0,required:!1},[s.c]:{type:"long",array:!1,required:!1},[s.h]:{type:"keyword",array:!1,required:!0},[s.i]:{type:"date",required:!1,array:!1},[s.l]:{type:"keyword",array:!1,required:!1},[s.m]:{type:"keyword",array:!1,required:!1,multi_fields:[{flat_name:`${s.m}.text`,name:"text",type:"match_only_text"}]},[s.n]:{type:"keyword",array:!1,required:!0},[s.o]:{type:"keyword",array:!1,required:!0},[s.p]:{type:"date",array:!1,required:!1},[s.q]:{type:"keyword",array:!1,required:!1},[s.r]:{type:"keyword",array:!1,required:!0},[s.t]:{array:!1,type:"flattened",ignore_above:4096,required:!1},[s.u]:{type:"keyword",array:!1,required:!0},[s.v]:{type:"long",array:!1,required:!0},[s.w]:{type:"keyword",array:!0,required:!1},[s.x]:{type:"keyword",array:!1,required:!0},[s.y]:{type:"keyword",array:!1,required:!0},[s.z]:{type:"boolean",array:!1,required:!1},[s.A]:{type:"date",array:!1,required:!1},[s.B]:{type:"keyword",array:!1,required:!0},[s.C]:{type:"date_range",format:"epoch_millis||strict_date_optional_time",array:!1,required:!1},[s.D]:{type:"keyword",array:!1,index:!1,required:!1,ignore_above:2048},[s.E]:{type:"keyword",array:!1,required:!0},[s.G]:{type:"keyword",array:!1,required:!1},[s.H]:{type:"keyword",array:!0,required:!1},[s.F]:{type:"keyword",array:!0,required:!1},[l.E]:{type:"keyword",array:!1,required:!1},[l.F]:{type:"keyword",array:!1,required:!1},[s.J]:{type:"keyword",array:!0,required:!0},[l.G]:{type:"keyword",array:!0,required:!1},[s.K]:{type:"date",required:!0,array:!1},[s.L]:{type:"version",array:!1,required:!1}},u={[l.a]:{type:"float",array:!1,required:!1},[l.b]:{type:"keyword",array:!1,required:!1},[l.c]:{type:"date",array:!1,required:!1},[l.d]:{type:"keyword",array:!1,required:!1},[l.e]:{type:"keyword",array:!1,required:!1},[l.f]:{type:"keyword",array:!1,required:!1},[l.g]:{type:"keyword",array:!1,required:!1},[l.h]:{type:"keyword",array:!1,required:!1},[l.i]:{type:"keyword",array:!1,required:!1},[l.j]:{type:"keyword",array:!1,required:!1},[l.k]:{type:"keyword",array:!0,required:!1},[l.l]:{type:"keyword",array:!1,required:!1},[l.m]:{type:"keyword",array:!1,required:!1},[l.n]:{type:"keyword",array:!1,required:!1},[l.o]:{type:"keyword",array:!1,required:!1},[l.p]:{type:"date",array:!1,required:!1},[l.q]:{type:"keyword",array:!1,required:!1},[l.r]:{type:"keyword",array:!1,required:!1},[l.s]:{type:"keyword",array:!1,required:!1},[l.t]:{type:"long",array:!1,required:!1},[l.u]:{type:"date",array:!1,required:!1},[l.v]:{type:"keyword",array:!0,required:!1},[l.w]:{type:"date",array:!1,required:!1},[l.y]:{type:"keyword",array:!0,required:!1},[l.z]:{type:"keyword",array:!1,required:!1},[l.A]:{type:"keyword",array:!1,required:!1},[l.C]:{type:"keyword",array:!1,required:!1},[l.B]:{type:"date",array:!1,required:!1},[l.D]:{type:"keyword",array:!1,required:!1}};function d(e,...t){const n=Object.keys(e).filter((e=>t.some((t=>{if(t===e)return!0;const n=e.split("."),a=t.split(".");return a.indexOf("*")===a.length-1&&n.every(((e,t)=>{const n=a.length-1<t?"*":a[t];return e===n||"*"===n}))}))));return Object(a.pick)(e,n)}const p={...d(c,"*"),...d(u,"*")};var m=n(44),f=n(5);const g=e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,t.toString()];case"object":try{return[...e,JSON.stringify(t)]}catch{return[...e,"Invalid Object"]}case"string":return[...e,t];default:return[...e,`${t}`]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[`${e}`];try{return[JSON.stringify(e)]}catch{return["Invalid Object"]}},b=["@timestamp","labels","message","tags"],y=e=>{const t=e.length>0?e[0]:null;if(null!=t&&!Object(m.isEmpty)(t.coordinates))try{return g({lon:t.coordinates[0],lat:t.coordinates[1]})}catch{return g(e)}return g(e)},h=(e,t,n)=>Object.keys(e).reduce(((a,i)=>{const s=e[i],l=null!=n?n:(e=>{const t=e.split(".")[0];return!Object(m.isEmpty)(t)&&b.includes(t)?"base":t})(i);if((e=>e.includes("geo.location")||e.includes("geoip.location"))(i))return[...a,{category:l,field:i,values:y(s),originalValue:y(s),isObjectArray:!0}];const c=(e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,{str:t.toString()}];case"object":try{return[...e,{str:JSON.stringify(t),isObjectArray:!0}]}catch{return[...e,{str:"Invalid Object"}]}case"string":return[...e,{str:t}];default:return[...e,{str:`${t}`}]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[{str:`${e}`}];try{return[{str:JSON.stringify(e),isObjectArray:!0}]}catch{return[{str:"Invalid Object"}]}})(s),u=c.map((({str:e})=>e)),d=c.some((e=>e.isObjectArray)),g=t?`${t}.${i}`:i;if(!d||void 0===Object.keys({...r,...p,...o}).find((e=>e===i)))return[...a,{category:l,field:g,values:u,originalValue:u,isObjectArray:d}];const v=((e,t)=>(null==t?void 0:t.includes(f.yb))||e===f.yb)(i,t)?[{category:l,field:g,values:u,originalValue:u,isObjectArray:d}]:[],E=Array.isArray(s)?s.reduce(((e,t)=>[...e,h(t,g,l)]),[]).flat():h(s,t,l),x=[...a,...E,...v].reduce(((e,t)=>({...e,...null!=e[t.field]?{[t.field]:{...t,originalValue:e[t.field].originalValue.includes(t.originalValue[0])?e[t.field].originalValue:[...e[t.field].originalValue,...t.originalValue],values:e[t.field].values.includes(t.values[0])?e[t.field].values:[...e[t.field].values,...t.values]}}:{[t.field]:t}})),{});return Object.values(x)}),[]);var v=n(195),E=n(797);const x=e=>e?e[0]:void 0;var j=n(244);const O=e=>e===v.c.InvestigationTime,S=e=>{const t=e.find((({field:e,originalValue:t})=>e===f.yb&&t));if(!t)return[];const{originalValue:n}=t;return(Array.isArray(n)?n:[n]).reduce(((e,t)=>{try{const n=h(JSON.parse(t));e.push(n)}catch(e){}return e}),[])},w=e=>e.reduce(((e,t)=>(e[t.field]=t.originalValue,e)),{}),k=(e,t)=>x(e[t]),I=(e,t)=>k(e,t)||k(e,`threatintel.${t}`)||k(e,`threat.${t}`),T=e=>({id:k(e,v.m),field:k(e,v.l),value:k(e,v.k),type:k(e,v.n),feedName:I(e,v.e)}),C=e=>{const{id:t,field:n}=T(e);return`${t}${n}`},M=e=>{if(e.length<2)return e;const t=Object(a.groupBy)(e,C);return Object.values(t).map((e=>{var t;return null!==(t=e.find((e=>!O(k(e,v.n)))))&&void 0!==t?t:e[0]}))},_=e=>e.reduce(((e,t)=>{if(Object(E.b)(t.field)){const n=x(t.originalValue);if(n)return{...e,[t.field]:n}}return e}),{}),D=e=>{const t=I(e,v.f),n=Date.parse(null!=t?t:"no date");return Number.isInteger(n)?n:new Date(-1).valueOf()},N=e=>Object.keys(e).sort().map((t=>{const n=t.startsWith(f.P)?t.replace(`${f.P}`,"indicator"):t;let r=x(e[t]);return Object(a.isObject)(r)&&(r=j.k),{title:n,description:{fieldName:t,value:r}}}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),r=n(444),i=n(2),o=n.n(i),s=n(41),l=n.n(s);const c=l.a.aside.withConfig({displayName:"Aside",componentId:"sc-tazcmx-0"})(["padding:",";",""],(({theme:e})=>e.eui.euiSizeM),(({overlay:e,overlayBackground:t,theme:n})=>e&&Object(s.css)(["background:",";bottom:0;left:0;position:absolute;right:0;top:0;z-index:",";"],t?Object(r.rgba)(t,.9):Object(r.rgba)(n.eui.euiColorEmptyShade,.9),n.eui.euiZLevel1)));c.displayName="Aside";const u=l()(a.EuiFlexGroup).attrs((()=>({alignItems:"center",direction:"column",gutterSize:"s",justifyContent:"center"}))).withConfig({displayName:"FlexGroup",componentId:"sc-tazcmx-1"})(["",""],(({overlay:e})=>e&&Object(s.css)(["height:100%;"])));u.displayName="FlexGroup";const d=o.a.memo((({children:e,overlay:t,overlayBackground:n,size:r})=>o.a.createElement(c,{overlay:t,overlayBackground:n},o.a.createElement(u,{overlay:{overlay:t}},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:r})),e&&o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiText,{color:"subdued",size:"s"},o.a.createElement("p",null,e)))))));d.displayName="Loader"},function(e,t,n){"use strict";n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return k})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return I})),n.d(t,"f",(function(){return h.a})),n.d(t,"g",(function(){return h.b})),n.d(t,"h",(function(){return E})),n.d(t,"a",(function(){return T}));var a=n(46),r=n(1531);let i=function(e){return e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range",e}({}),o=function(e){return e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month",e}({});const s=a.union([a.exact(a.type({type:a.literal(i.last_hour),granularity:a.literal(o.minute)})),a.exact(a.type({type:a.literal(i.last_day),granularity:a.union([a.literal(o.minute),a.literal(o.hour)])})),a.exact(a.type({type:a.literal(i.last_week),granularity:a.union([a.literal(o.hour),a.literal(o.day)])})),a.exact(a.type({type:a.literal(i.last_month),granularity:a.union([a.literal(o.day),a.literal(o.week)])})),a.exact(a.type({type:a.literal(i.last_year),granularity:a.union([a.literal(o.week),a.literal(o.month)])})),a.exact(a.type({type:a.literal(i.custom_range),granularity:a.union([a.literal(o.minute),a.literal(o.hour),a.literal(o.day),a.literal(o.week),a.literal(o.month)]),from:r.a,to:r.a}))]);a.exact(a.partial({interval:s,debug:a.boolean}));var l=n(1371);a.exact(a.intersection([a.type({rule_id:l.a}),a.partial({interval:s,debug:a.boolean})])),a.exact(a.partial({interval:s,debug:a.boolean})),a.exact(a.type({}));var c=n(120),u=n(1449);const d=c.z.enum(["trace","debug","info","warn","error"]),p=d.enum,m=c.z.enum(["message","status-change","execution-metrics"]),f=m.enum,g=c.z.object({timestamp:c.z.string().datetime(),sequence:c.z.number().int(),level:d,type:m,execution_id:c.z.string().min(1),message:c.z.string()});var b=n(330),y=n(471);c.z.object({search_term:c.z.string().optional(),event_types:Object(u.a)(m).optional().default([]),log_levels:Object(u.a)(d).optional().default([]),date_start:c.z.string().datetime().optional(),date_end:c.z.string().datetime().optional(),sort_order:b.a.optional().default("desc"),page:c.z.coerce.number().int().optional().default(1),per_page:c.z.coerce.number().int().optional().default(20)}),c.z.object({ruleId:c.z.string().min(1)}),c.z.object({events:c.z.array(g),pagination:y.a});var h=n(281);const v=c.z.enum(["backfill","standard"]),E=v.enum,x=c.z.object({execution_uuid:c.z.string(),timestamp:c.z.string().datetime(),duration_ms:c.z.number().int(),status:c.z.string(),message:c.z.string(),num_active_alerts:c.z.number().int(),num_new_alerts:c.z.number().int(),num_recovered_alerts:c.z.number().int(),num_triggered_actions:c.z.number().int(),num_succeeded_actions:c.z.number().int(),num_errored_actions:c.z.number().int(),total_search_duration_ms:c.z.number().int(),es_search_duration_ms:c.z.number().int(),schedule_delay_ms:c.z.number().int(),timed_out:c.z.boolean(),indexing_duration_ms:c.z.number().int(),search_duration_ms:c.z.number().int(),gap_duration_s:c.z.number().int(),security_status:c.z.string(),security_message:c.z.string(),backfill:c.z.object({from:c.z.string().datetime(),to:c.z.string().datetime()}).optional()}),j=c.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);j.enum,c.z.object({start:c.z.string().datetime(),end:c.z.string().datetime(),query_text:c.z.string().optional().default(""),status_filters:Object(u.a)(h.a).optional().default([]),run_type_filters:Object(u.a)(v).optional().default([]),sort_field:j.optional().default("timestamp"),sort_order:b.a.optional().default("desc"),page:c.z.coerce.number().int().optional().default(1),per_page:c.z.coerce.number().int().optional().default(20)}),c.z.object({ruleId:c.z.string().min(1)}),c.z.object({events:c.z.array(x).optional(),total:c.z.number().int().optional()});var O=n(5);O.Lb,O.Lb,O.Lb;const S=`${O.Lb}/health/_setup`,w=(O.Lb,e=>`${O.Lb}/rules/${e}/execution/events`),k=(O.Lb,e=>`${O.Lb}/rules/${e}/execution/results`);n(465);let I=function(e){return e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off",e}({});n(227),n(464);const T=d.options},,function(e,t,n){"use strict";n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"m",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return j})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return S})),n.d(t,"n",(function(){return w})),n.d(t,"l",(function(){return k})),n.d(t,"b",(function(){return D})),n.d(t,"f",(function(){return N})),n.d(t,"g",(function(){return A})),n.d(t,"h",(function(){return F})),n.d(t,"k",(function(){return P}));var a=n(2),r=n.n(a),i=n(19),o=n(7),s=n(54),l=n.n(s),c=(n(1281),n(506)),u=n(403),d=n(1555),p=n(818),m=n(549),f=n(353),g=n(873),b=n(572);const y=["kibana.alert.rule","signal.rule","rule"],h=e=>e.map((e=>({username:e.created_by,timestamp:l()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:f.b,timelineAvatar:r.a.createElement(i.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:r.a.createElement(i.EuiText,{size:"s"},e.comment),actions:r.a.createElement(g.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:f.a})}))),v=e=>{const{created_at:t,created_by:n,list_id:a,tie_breaker_id:r,updated_at:i,updated_by:o,...s}=e;return{...s}},E=e=>e.map((e=>{if(void 0!==e.entries){const t=e.entries.map((e=>{const t=Object(o.omit)(e,"id");return{...t,field:t.field.startsWith("event.")?t.field.replace(/^event./,`${b.f}.`):t.field}}));return{...e,entries:t,comments:[]}}return{...e,comments:[]}})),x=(e,t)=>e.map((e=>({...e,comments:t}))),j=(e,t)=>{const n=void 0!==t?t.toISOString():void 0;return e.map((e=>({...e,expire_time:n})))},O=e=>({query:{match:{_id:{query:e||""}}}}),S=(e,t)=>e.map((e=>({...e,os_types:t}))),w=e=>{const t=["windows","macos"];if(null!=e){var n,a,r,i,o,s;const l="endpoint"===(null==e||null===(n=e.agent)||void 0===n?void 0:n.type)?null===(a=e.host)||void 0===a||null===(r=a.os)||void 0===r||null===(i=r.name)||void 0===i?void 0:i.toLowerCase():null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family;if(null!=l)return c.a.is(l)?[l]:t}return t},k=e=>e.map((e=>{const t=e.entries.map((e=>{if(e.field.includes(".hash")){if("match"===e.type)return{...e,value:e.value.toLowerCase()};if("match_any"===e.type)return{...e,value:e.value.map((e=>e.toLowerCase()))}}return e}));return{...e,entries:t}})),I=e=>{if(Array.isArray(e)&&e.length>0)return e.map((e=>{var t,n,a;return{subjectName:null!==(t=null==e?void 0:e.subject_name)&&void 0!==t?t:"",trusted:null!==(n=null==e||null===(a=e.trusted)||void 0===a?void 0:a.toString())&&void 0!==n?n:""}}));{var t,n;const a=Array.isArray(e)?void 0:e;return[{subjectName:null!==(t=null==a?void 0:a.subject_name)&&void 0!==t?t:"",trusted:null!==(n=null==a?void 0:a.trusted)&&void 0!==n?n:""}]}};function T(e){const t=[];for(const n of e)void 0!==n.entries?(n.entries=n.entries.filter((e=>void 0!==e.value&&e.value.length>0)),t.push(n)):void 0!==n.value&&n.value.length>0&&t.push(n);return t}const C=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:r})=>{var i,o,s,l,c,u;const{process:p}=r,m=T([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(i=null===(o=r.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==i?i:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==p?void 0:p.executable)&&void 0!==s?s:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(l=null==p?void 0:p.name)&&void 0!==l?l:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!==(c=null==p||null===(u=p.hash)||void 0===u?void 0:u.sha256)&&void 0!==c?c:""}]);return{...Object(d.e)({listId:e,namespaceType:a,name:t}),entries:Object(d.a)(m)}},M=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:r})=>{var i,o,s,l,c,u,p,m,f;const{process:g}=r,b=T([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(i=null===(o=r.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==i?i:""},{field:"Memory_protection.self_injection",operator:"included",type:"match",value:null!==(s=String(null===(l=r.Memory_protection)||void 0===l?void 0:l.self_injection))&&void 0!==s?s:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(c=null==g?void 0:g.executable)&&void 0!==c?c:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(u=null==g?void 0:g.name)&&void 0!==u?u:""},{field:"process.Ext.token.integrity_level_name",operator:"included",type:"match",value:null!==(p=null==g||null===(m=g.Ext)||void 0===m||null===(f=m.token)||void 0===f?void 0:f.integrity_level_name)&&void 0!==p?p:""}]);return{...Object(d.e)({listId:e,namespaceType:a,name:t}),entries:Object(d.a)(b)}},_=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:r})=>{var i,o,s,l,c,u,p,m,f,g,b,y,h,v,E,x,j,O,S,w,k,I,C,M,_,D,N,A,F,P,R,L,q,z,B,$,V,U,G;const{process:H}=r,W=T([{field:"rule.id",operator:"included",type:"match",value:null!==(i=null===(o=r.rule)||void 0===o?void 0:o.id)&&void 0!==i?i:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==H?void 0:H.executable)&&void 0!==s?s:""},{field:"process.command_line",operator:"included",type:"match",value:null!==(l=null==H?void 0:H.command_line)&&void 0!==l?l:""},{field:"process.parent.executable",operator:"included",type:"match",value:null!==(c=null==H||null===(u=H.parent)||void 0===u?void 0:u.executable)&&void 0!==c?c:""},{field:"process.code_signature.subject_name",operator:"included",type:"match",value:null!==(p=null==H||null===(m=H.code_signature)||void 0===m?void 0:m.subject_name)&&void 0!==p?p:""},{field:"file.path",operator:"included",type:"match",value:null!==(f=null===(g=r.file)||void 0===g?void 0:g.path)&&void 0!==f?f:""},{field:"file.name",operator:"included",type:"match",value:null!==(b=null===(y=r.file)||void 0===y?void 0:y.name)&&void 0!==b?b:""},{field:"source.ip",operator:"included",type:"match",value:null!==(h=null===(v=r.source)||void 0===v?void 0:v.ip)&&void 0!==h?h:""},{field:"destination.ip",operator:"included",type:"match",value:null!==(E=null===(x=r.destination)||void 0===x?void 0:x.ip)&&void 0!==E?E:""},{field:"registry.path",operator:"included",type:"match",value:null!==(j=null===(O=r.registry)||void 0===O?void 0:O.path)&&void 0!==j?j:""},{field:"registry.value",operator:"included",type:"match",value:null!==(S=null===(w=r.registry)||void 0===w?void 0:w.value)&&void 0!==S?S:""},{field:"registry.data.strings",operator:"included",type:"match",value:null!==(k=null===(I=r.registry)||void 0===I||null===(C=I.data)||void 0===C?void 0:C.strings)&&void 0!==k?k:""},{field:"dll.path",operator:"included",type:"match",value:null!==(M=null===(_=r.dll)||void 0===_?void 0:_.path)&&void 0!==M?M:""},{field:"dll.code_signature.subject_name",operator:"included",type:"match",value:null!==(D=null===(N=r.dll)||void 0===N||null===(A=N.code_signature)||void 0===A?void 0:A.subject_name)&&void 0!==D?D:""},{field:"dll.pe.original_file_name",operator:"included",type:"match",value:null!==(F=null===(P=r.dll)||void 0===P||null===(R=P.pe)||void 0===R?void 0:R.original_file_name)&&void 0!==F?F:""},{field:"dns.question.name",operator:"included",type:"match",value:null!==(L=null===(q=r.dns)||void 0===q||null===(z=q.question)||void 0===z?void 0:z.name)&&void 0!==L?L:""},{field:"dns.question.type",operator:"included",type:"match",value:null!==(B=null===($=r.dns)||void 0===$||null===(V=$.question)||void 0===V?void 0:V.type)&&void 0!==B?B:""},{field:"user.id",operator:"included",type:"match",value:null!==(U=null===(G=r.user)||void 0===G?void 0:G.id)&&void 0!==U?U:""}]);return{...Object(d.e)({listId:e,namespaceType:a,name:t}),entries:Object(d.a)(W)}},D=(e,t,n)=>{var a,r;const i=null!==(a=n["event.code"])&&void 0!==a?a:null===(r=n.event)||void 0===r?void 0:r.code;switch(i){case"behavior":return[_({listId:e,name:t,eventCode:i,alertEcsData:n})];case"memory_signature":return[C({listId:e,name:t,eventCode:i,alertEcsData:n})];case"shellcode_thread":return[M({listId:e,name:t,eventCode:i,alertEcsData:n})];case"ransomware":return(e=>{const{process:t}=e,n=t&&t.Ext&&t.Ext.code_signature;return I(n)})(n).map((a=>(({listId:e,name:t,codeSignature:n,eventCode:a,listNamespace:r="agnostic",alertEcsData:i})=>{var o,s,l,c;const{process:u,Ransomware:p}=i,m=null!==(o=null==u||null===(s=u.hash)||void 0===s?void 0:s.sha256)&&void 0!==o?o:"",f=null!==(l=null==u?void 0:u.executable)&&void 0!==l?l:"",g=null!==(c=null==p?void 0:p.feature)&&void 0!==c?c:"";return{...Object(d.e)({listId:e,namespaceType:r,name:t}),entries:Object(d.a)([{field:"process.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=n?n.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=n?n.trusted:""}]},{field:"process.executable",operator:"included",type:"match",value:null!=f?f:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!=m?m:""},{field:"Ransomware.feature",operator:"included",type:"match",value:null!=g?g:""},{field:"event.code",operator:"included",type:"match",value:null!=a?a:""}])}})({listId:e,name:t,eventCode:i,codeSignature:a,alertEcsData:n})));default:return(e=>{const{file:t}=e,n=t&&t.Ext&&t.Ext.code_signature;return I(n)})(n).map((a=>(({listId:e,name:t,codeSignature:n,eventCode:a,listNamespace:r="agnostic",alertEcsData:i})=>{var o,s,l,c;const{file:u,host:p}=i,m=null!==(o=null==u?void 0:u.path)&&void 0!==o?o:"",f=null!==(s=null==u||null===(l=u.hash)||void 0===l?void 0:l.sha256)&&void 0!==s?s:"",g="Linux"===(null==p||null===(c=p.os)||void 0===c?void 0:c.name),b=[{field:g?"file.path":"file.path.caseless",operator:"included",type:"match",value:null!=m?m:""},{field:"file.hash.sha256",operator:"included",type:"match",value:null!=f?f:""},{field:"event.code",operator:"included",type:"match",value:null!=a?a:""}];return{...Object(d.e)({listId:e,namespaceType:r,name:t}),entries:g?Object(d.a)(b):Object(d.a)([{field:"file.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=n?n.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=n?n.trusted:""}]},...b])}})({listId:e,name:t,eventCode:null!=i?i:"",codeSignature:a,alertEcsData:n})))}},N=(e,t)=>e.map((e=>({...e,name:t}))),A=e=>e.map((e=>({...Object(p.a)(e),list_id:void 0,namespace_type:"single"}))),F=(e,t)=>t.flatMap((t=>e.map((e=>({...Object(p.a)(e),list_id:t.list_id,namespace_type:t.namespace_type}))))),P=({alertData:e,exceptionItemName:t,ruleCustomHighlightedFields:n})=>{const a=R(e,n);if(!a.length)return null;const r=(({highlightedFields:e,alertData:t})=>Object.values(e).reduce(((e,n)=>{var a;const r=n.id,i=null!==(a=Object(o.get)(t,r))&&void 0!==a?a:Object(o.get)(t,`kibana.alert.${r}`);if(null!=i){const t=Array.isArray(i)?u.b.MATCH_ANY:u.b.MATCH,n=Array.isArray(i)?i.map(String):i.toString();e.push({field:r,operator:u.a.INCLUDED,type:t,value:n})}return e}),[]))({highlightedFields:a,alertData:e});return r.length?(({name:e,exceptionEntries:t})=>({...Object(d.e)({listId:void 0,namespaceType:"single",name:e}),entries:Object(d.a)(t)}))({name:t,exceptionEntries:r}):null},R=(e,t)=>{const n=Object(o.get)(e,"event.category"),a=Object(o.get)(e,"event.code"),r=Object(o.get)(e,"kibana.alert.rule.type"),i={primaryEventCategory:Array.isArray(n)?n[0]:n,allEventCategories:[n]};return((e,t,n)=>e.filter((({id:e})=>"agent.id"===e?L(n):!t.some((t=>e.startsWith(t))))))(Object(m.b)({eventCategories:i,eventCode:a,eventRuleType:r,highlightedFieldsOverride:t}),y,e)},L=e=>{if(!Object(o.get)(e,"kibana.alert.rule.uuid"))return!1;const t=Object(o.get)(e,"agent.type");return"endpoint"===(Array.isArray(t)?t[0]:t)}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(46);const r=a.string,i=a.union([r,a[void 0]])},function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return S}));var a=n(63),r=n.n(a),i=n(19),o=n(44),s=n(2),l=n.n(s),c=n(45),u=n(188),d=n.n(u),p=n(1332),m=n(5),f=n(129),g=n(118),b=n(200),y=n(138),h=n(460);const v={fill:!1},E=e=>{e.forEach((e=>e.refetch&&e.refetch()))},x=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:r,kqlQuery:c,policy:u,queries:d,setDuration:p,showUpdateButton:f=!0,start:b,startAutoReload:y,stopAutoReload:h,timelineId:x,toStr:O,updateReduxTime:S,disabled:w,width:k="restricted",compressed:I=!1})=>{const[T,C]=Object(s.useState)([]),M=Object(s.useCallback)((({start:e,end:n})=>{const r=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:i}=S({end:n,id:a,isInvalid:!1,isQuickSelection:r,kql:c,start:e,timelineId:x,hasRangeChanged:!1}),o=j(e),s=r?j(n,{roundUp:!0}):j(n);!d||i||r&&(b!==o||t!==s)||E(d)}),[t,a,c,d,b,x,S]),_=Object(s.useCallback)((({isPaused:t,refreshInterval:r})=>{const i=null!=n&&n.includes("now")||null!=O&&O.includes("now");e!==r&&p({id:a,duration:r}),t&&"interval"===u?h({id:a}):t||"manual"!==u||y({id:a}),d&&!t&&(!i||i&&"now"!==O)&&E(d)}),[n,O,e,u,p,a,h,y,d]),D=Object(s.useCallback)((({start:e,end:t,isInvalid:n})=>{const r=e.includes("now")||t.includes("now");if(!n){S({end:t,id:a,isInvalid:n,isQuickSelection:r,kql:c,start:e,timelineId:x,hasRangeChanged:!0});const i=[{start:e,end:t},...Object(o.take)(9,T.filter((n=>!(n.start===e&&n.end===t))))];C(i)}}),[S,a,c,x,T]),N=null!=O?O:new Date(t).toISOString(),A=null!=n?n:new Date(b).toISOString(),[F]=Object(g.o)(m.db),[P]=Object(g.o)(m.K),R=Object(o.isEmpty)(F)?[]:F.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(i.EuiSuperDatePicker,{commonlyUsedRanges:R,end:N,isLoading:r,isPaused:"manual"===u,onRefresh:M,onRefreshChange:_,onTimeChange:D,recentlyUsedRanges:T,refreshInterval:e,showUpdateButton:f,start:A,isDisabled:w,width:k,compressed:I,updateButtonProps:v,dateFormat:P})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),j=(e,t)=>{const n=r.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},O=e=>({end:t,id:n,isQuickSelection:a,kql:r,start:i,timelineId:o,hasRangeChanged:s})=>{const l=j(i);let c=j(t,{roundUp:!0});var u;return a?e(t===i?b.c.setAbsoluteRangeDatePicker({id:n,fromStr:i,toStr:t,from:l,to:c}):b.c.setRelativeRangeDatePicker({id:n,fromStr:i,toStr:t,from:l,to:c})):(c=j(t),e(b.c.setAbsoluteRangeDatePicker({id:n,from:j(i),to:j(t)}))),null!=o&&s&&e(f.a.updateRange({id:o,start:l,end:c})),r&&r.refetch?{kqlHaveBeenUpdated:null!==(u=r.refetch(e))&&void 0!==u&&u}:{kqlHaveBeenUpdated:!1}};x.displayName="SuperDatePickerComponent";const S=Object(c.connect)((()=>{const e=Object(h.a)(),t=Object(h.b)(),n=Object(h.c)(),a=Object(h.d)(),r=Object(h.e)(),i=Object(h.f)(),s=Object(h.g)(),l=Object(h.h)(),c=Object(h.i)(),u=Object(h.j)();return(d,{id:m})=>{const f=Object(o.getOr)({},`inputs.${m}`,d);return{duration:e(f),end:t(f),fromStr:n(f),kind:r(f),policy:s(f),start:c(f),toStr:u(f),isLoading:!1,...Object(p.c)(f)&&(m===y.a.timeline||m===y.a.global)&&{isLoading:a(f),kqlQuery:i(f),queries:l(d,m)}}}}),(e=>({startAutoReload:({id:t})=>e(b.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(b.c.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(b.c.setDuration({id:t,duration:n})),updateReduxTime:O(e)})))(x)},function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(892))},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n(5),i=n(161),o=n(381),s=n(380),l=n(124),c=n(148);const u="countOfAlertsWithSameFieldAndValue",d=({field:e,value:t,isActiveTimelines:n,signalIndexName:r,includeAlertIds:d=!1,ignoreTimerange:m=!1})=>{const f=Object(l.a)((e=>c.d.timelineTimeRangeSelector(e))),g=Object(i.a)();let b,y;!1===m&&({to:b,from:y}=n?f:g);const[h]=Object(a.useState)((()=>p(e,t,y,b,d))),{loading:v,data:E,setQuery:x}=Object(o.a)({query:h,indexName:r,queryName:s.a.PREVALENCE});let j;if(Object(a.useEffect)((()=>{x(p(e,t,y,b,d))}),[x,e,t,y,b,d]),E){var O,S;const e=null===(O=E.aggregations)||void 0===O||null===(S=O[u])||void 0===S?void 0:S.buckets;e&&e.length>0&&(j=e[0].doc_count)}const w=!v&&void 0===j;return Object(a.useMemo)((()=>({loading:v,count:j,error:w,alertIds:null==E?void 0:E.hits.hits.map((({_id:e})=>e))})),[j,E,w,v])},p=(e,t,n,a,i)=>{const o=i?{size:r.V}:{size:0},s=i?{sort:{"@timestamp":"desc"}}:{},l=Array.isArray(t)&&1===t.length?t[0]:t;let c;return c={bool:{must:{match:{[e]:l}}}},void 0!==n&&void 0!==a&&(c={...c,bool:{...c.bool,filter:[{range:{"@timestamp":{gte:n,lte:a}}}]}}),Array.isArray(t)&&t.length>1&&(c={bool:{must:t.map((t=>({term:{[e]:t}})))}},void 0!==n&&void 0!==a&&c.bool.must.push({range:{"@timestamp":{gte:n,lte:a}}})),{...o,...s,_source:!1,aggs:{[u]:{terms:{field:e,size:r.V}}},query:c,runtime_mappings:{}}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"c",(function(){return m}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),i=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o=(a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"})),s=(a.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),a.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),a.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),a.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),a.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"})),l=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),c=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),u=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),d=a.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"}),p=a.i18n.translate("xpack.securitySolution.ruleExceptions.addException.ruleException",{defaultMessage:"rule exception"}),m=a.i18n.translate("xpack.securitySolution.ruleExceptions.addException.endpointException",{defaultMessage:"endpoint exception"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return x}));var a=n(2),r=n.n(a),i=n(44),o=n(1334),s=n(19),l=n(778),c=n(1257),u=n(982),d=n(343),p=n(950),m=n(595);const f=e=>t=>""!==e.trim()?Object(d.d)(t,[{comment:e}]):t,g=e=>t=>""!==e.trim()?Object(d.f)(t,e):t,b=e=>t=>Object(d.e)(t,e),y=(e,t)=>n=>e===o.a.ENDPOINT?Object(d.l)(Object(d.c)(n,t)):n,h=({itemName:e,commentToAdd:t,addToRules:n,addToSharedLists:a,sharedLists:r,selectedOs:s,listType:l,expireTime:c,items:u})=>{const p=Object(i.pipe)(f(t),b(c),g(e),y(l,s),((e,t)=>n=>t&&e!==o.a.ENDPOINT?Object(d.g)(n):n)(l,n),((e,t,n)=>a=>t&&e!==o.a.ENDPOINT?Object(d.h)(a,n):a)(l,a,r))(u);return p},v=({itemName:e,commentToAdd:t,selectedOs:n,listType:a,expireTime:r,items:o})=>Object(i.pipe)(f(t),b(r),g(e),y(a,n))(o),E=()=>[{field:"name",name:m.c,sortable:!0,"data-test-subj":"exceptionListNameCell"},{field:"referenced_rules",name:"Number of rules linked to",sortable:!1,"data-test-subj":"exceptionListRulesLinkedToIdCell",render:e=>r.a.createElement(l.a,{emptyButton:!0,useCustomActions:!0,actions:Object(c.a)({dataTestSubj:"addToSharedListsLinkedRulesMenu",linkedRules:e,securityLinkAnchorComponent:p.f}),panelPaddingSize:"none",disableActions:!1,text:e.length.toString(),dataTestSubj:"addToSharedListsLinkedRulesMenuAction"})},{name:m.a,"data-test-subj":"exceptionListRulesActionCell",render:e=>r.a.createElement(p.e,{dataTestSubj:"exceptionListActionCell-link",linkTitle:m.e,listId:e.list_id,external:!0})}],x=()=>[{field:"name",align:"left",name:m.c,sortable:!0,"data-test-subj":"ruleNameCell",truncateText:!1},{field:"tags",align:"left",name:m.d,"data-test-subj":"ruleNameCell",render:e=>0===e.length?null:r.a.createElement(u.a,{items:e,popoverTitle:m.d,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>r.a.createElement(s.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)})},{name:m.a,"data-test-subj":"ruleAction-view",render:e=>r.a.createElement(p.f,{external:!0,referenceId:e.id,referenceName:m.f})}]},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return K}));var a=n(49);const r=parseInt(a.euiThemeVars.euiSizeXL,10)-parseInt(a.euiThemeVars.euiSizeXS,10),i=e=>"signal"===e,o=e=>(e>0?e*r:r)+2*parseInt(a.euiThemeVars.euiDataGridCellPaddingM,10);var s=n(2),l=n.n(s),c=n(45),u=n(19),d=n(41),p=n.n(d),m=n(1403),f=n(1630),g=n(289),b=n(169),y=n(272),h=n(131),v=n(541),E=n(129),x=n(149),j=n(934),O=n(121),S=n(140),w=n(594),k=n(838);const I=({ariaLabel:e,timelineType:t,toggleShowNotes:n,eventId:a,notesCount:r})=>{const{kibanaSecuritySolutionsPrivileges:i}=Object(S.a)(),o=Object(s.useMemo)((()=>r>0?w.g({notesCount:r}):w.f),[r]);return l.a.createElement(k.a,null,l.a.createElement(j.b,{ariaLabel:e,"data-test-subj":"add-note",isDisabled:!1===i.crud,timelineType:t,toggleShowNotes:n,toolTip:t===O.m.template?w.h:o,eventId:a,notesCount:r}))};I.displayName="AddEventNoteActionComponent";const T=l.a.memo(I);var C=n(180),M=n(839);const _=({ariaLabel:e,isAlert:t,noteIds:n,onPinClicked:a,eventIsPinned:i,timelineType:o})=>{const{kibanaSecuritySolutionsPrivileges:c}=Object(S.a)(),d=Object(s.useMemo)((()=>Object(y.g)({isPinned:i,isAlert:t,eventHasNotes:Object(y.b)(n),timelineType:o})),[i,t,n,o]);return l.a.createElement("div",{key:"timeline-action-pin-tool-tip"},l.a.createElement(C.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"timeline-action-pin-tool-tip",content:d},l.a.createElement(M.a,{ariaLabel:e,allowUnpinning:!Object(y.b)(n),"data-test-subj":"pin-event",isDisabled:!1===c.crud,isAlert:t,onClick:a,pinned:i,timelineType:o}))))};_.displayName="PinEventActionComponent";const D=l.a.memo(_);var N=n(124),A=n(158),F=n(187),P=n(16),R=n(206),L=n(219),q=n(13),z=n(969),B=n(730),$=n(256),V=n(170),U=n(758),G=n(305),H=n(122);const W=p.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-3eeodk-0"})(["align-items:center;display:flex;"]),Q=[],Y=({ariaRowindex:e,columnValues:t,disableExpandAction:n=!1,ecsData:a,eventId:o,eventIdToNoteIds:d,isEventPinned:p=!1,isEventViewer:j=!1,onEventDetailsPanelOpened:O,onRuleChange:S,showNotes:k,timelineId:I,refetch:M,toggleShowNotes:_,disablePinAction:Y=!0})=>{const K=Object(c.useDispatch)(),{timelineType:Z}=Object(N.b)((e=>Object(h.isTimelineScope)(I)?Object(b.selectTimelineById)(e,I):A.b)),{startTransaction:X}=Object(F.b)(),J=Object(P.b)().isEnterprise(),ee=Object(s.useCallback)((e=>K(E.a.pinEvent({id:I,eventId:e}))),[K,I]),te=Object(s.useCallback)((e=>K(E.a.unPinEvent({id:I,eventId:e}))),[K,I]),ne=Object(s.useCallback)((()=>Object(y.f)({allowUnpinning:!d||!Object(y.b)(d[o]),eventId:o,onPinEvent:ee,onUnPinEvent:te,isEventPinned:p})),[d,o,p,ee,te]),ae=Object(y.e)(a),re=Object(s.useMemo)((()=>{var e,t,n,r;return"signal"!==ae&&!(null!==(e=a.event)&&void 0!==e&&null!==(t=e.kind)&&void 0!==t&&t.includes("event")&&null!==(n=a.agent)&&void 0!==n&&null!==(r=n.type)&&void 0!==r&&r.includes("endpoint"))}),[a,ae]),ie=!Object(v.a)(a),{setGlobalFullScreen:oe}=Object(R.a)(),{setTimelineFullScreen:se}=Object(R.c)(),le=Object(s.useCallback)((()=>{X({name:L.a.OPEN_ANALYZER});const e=Object(h.getScopedActions)(I),t=document.querySelector(".euiDataGrid--fullScreen");e&&K(e.updateGraphEventId({id:I,graphEventId:a._id})),I===x.f.active?(t&&se(!0),K(Object(q.setActiveTabTimeline)({id:I,activeTab:m.a.graph}))):t&&oe(!0)}),[X,I,K,a._id,se,oe]),ce=Object(s.useMemo)((()=>{var e,t,n,r,i,o,s,l,c,u;const{process:d,_id:p,_index:m,timestamp:f,kibana:g}=a,b=null==d||null===(e=d.entry_leader)||void 0===e||null===(t=e.entity_id)||void 0===t?void 0:t[0],y=null==d||null===(n=d.entry_leader)||void 0===n||null===(r=n.start)||void 0===r?void 0:r[0],h=(null==g||null===(i=g.alert)||void 0===i||null===(o=i.ancestors)||void 0===o||null===(s=o.index)||void 0===s?void 0:s[0])||m;if(void 0===h||void 0===b||void 0===y)return null;const v=null==d||null===(l=d.entity_id)||void 0===l?void 0:l[0],E="signal"===ae||"eql"===ae?p:void 0;return{index:h,sessionEntityId:b,sessionStartTime:y,jumpToEntityId:v,jumpToCursor:E&&(null===(c=a.kibana)||void 0===c||null===(u=c.alert.original_time)||void 0===u?void 0:u[0])||f,investigatedAlertId:E}}),[a,ae]),ue=Object(s.useCallback)((()=>{const e=document.querySelector(".euiDataGrid--fullScreen");X({name:L.a.OPEN_SESSION_VIEW});const t=Object(h.getScopedActions)(I);I===x.f.active?(e&&se(!0),null!==ce&&K(Object(q.setActiveTabTimeline)({id:I,activeTab:m.a.session}))):e&&oe(!0),null!==ce&&t&&K(t.updateSessionViewConfig({id:I,sessionViewConfig:ce}))}),[X,I,ce,se,K,oe]),{activeStep:de,isTourShown:pe,incrementStep:me}=Object($.b)(),fe=Object(s.useMemo)((()=>pe(V.b.alertsCases)&&"signal"===ae&&Object(U.c)(I)&&1===e),[pe,e,ae,I]),ge=Object(s.useCallback)((()=>{fe&&de===V.a.expandEvent&&pe(V.b.alertsCases)&&me(V.b.alertsCases),O()}),[de,me,fe,pe,O]),be=Object(H.a)("securitySolutionNotesEnabled"),ye=Object(H.a)("expandableFlyoutDisabled"),he=Object(c.useSelector)((e=>Object(g.q)(e,o))),ve=Object(s.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d[o])&&void 0!==e?e:Q}),[d,o]),Ee=Object(s.useMemo)((()=>be&&!ye?he.length:ve.length),[he,ve,be,ye]),xe=Object(s.useMemo)((()=>be&&!ye?he.map((e=>e.noteId)):ve),[he,ve,be,ye]);return l.a.createElement(W,{"data-test-subj":"actions-container"},l.a.createElement(l.a.Fragment,null,!n&&l.a.createElement(G.a,{isTourAnchor:fe,onClick:ge,step:V.a.expandEvent,tourId:V.b.alertsCases},l.a.createElement("div",{key:"expand-event"},l.a.createElement(C.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:w.m},l.a.createElement(u.EuiButtonIcon,{"aria-label":w.n({ariaRowindex:e,columnValues:t}),"data-test-subj":"expand-event",iconType:"expand",onClick:ge,size:"s"}))))),l.a.createElement(l.a.Fragment,null,I!==x.f.active&&l.a.createElement(B.a,{ariaLabel:w.k({ariaRowindex:e,columnValues:t}),key:"investigate-in-timeline",ecsRowData:a})),!j&&k&&l.a.createElement(T,{ariaLabel:w.c({ariaRowindex:e,columnValues:t}),key:"add-event-note",timelineType:Z,notesCount:Ee,eventId:o,toggleShowNotes:_}),!j&&!Y&&l.a.createElement(D,{ariaLabel:w.j({ariaRowindex:e,columnValues:t,isEventPinned:p}),isAlert:i(ae),key:"pin-event",onPinClicked:ne,noteIds:xe,eventIsPinned:p,timelineType:Z}),l.a.createElement(z.b,{ariaLabel:w.e({ariaRowindex:e,columnValues:t}),ariaRowindex:e,columnValues:t,key:"alert-context-menu",ecsRowData:a,scopeId:I,disabled:re,onRuleChange:S,refetch:M}),!1===ie?l.a.createElement("div",null,l.a.createElement(C.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"view-in-analyzer-tool-tip",content:w.a},l.a.createElement(u.EuiButtonIcon,{"aria-label":w.b({ariaRowindex:e,columnValues:t}),"data-test-subj":"view-in-analyzer",iconType:"analyzeEvent",onClick:le,size:"s"})))):null,null===ce||!J&&I!==f.b.kubernetesPageSessions?null:l.a.createElement("div",null,l.a.createElement(C.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:w.i},l.a.createElement(u.EuiButtonIcon,{"aria-label":w.n({ariaRowindex:e,columnValues:t}),"data-test-subj":"session-view-button",iconType:"sessionViewer",onClick:ue,size:"s"}))))))};Y.displayName="ActionsComponent";const K=l.a.memo(Y);n(698)},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(44);const r=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},i=["http:","https:"],o=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(i.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function s(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));var a=n(19),r=n(2),i=n.n(r);const o=n(4).i18n.translate("xpack.securitySolution.overview.informationAriaLabel",{defaultMessage:"Information"});var s=n(666);const l=({toolTipContent:e,toolTipTitle:t,width:n=270,anchorPosition:s="leftCenter"})=>{const[l,c]=Object(r.useState)(!1),u=Object(r.useCallback)((()=>{c(!l)}),[l,c]),d=Object(r.useCallback)((()=>{c(!1)}),[c]);return i.a.createElement(a.EuiPopover,{isOpen:l,closePopover:d,anchorPosition:s,button:i.a.createElement(a.EuiButtonIcon,{color:"text",size:"xs",iconSize:"m",iconType:"iInCircle","aria-label":o,onClick:u})},t&&i.a.createElement(a.EuiPopoverTitle,null,t),i.a.createElement(a.EuiText,{size:"s",style:{width:`${n}px`}},e))},c=({anchorPosition:e})=>i.a.createElement(l,{anchorPosition:e,toolTipContent:i.a.createElement(s.a,null)})},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return q})),n.d(t,"c",(function(){return B})),n(553);var a=n(44),r=n(2),i=n.n(r),o=n(43);const s=Object(r.createContext)(null),l=({children:e,getTriggerCompatibleActions:t})=>{const n=Object(r.useMemo)((()=>({getActions:e=>t(e.trigger.id,e).then((e=>Object(a.orderBy)(["order","id"],["asc","asc"],e)))})),[t]);return Object(o.jsx)(s.Provider,{value:n},e)},c=()=>{const e=Object(r.useContext)(s);if(!e)throw new Error("No CellActionsContext found. Please wrap the application with CellActionsProvider");return e};var u=n(19),d=n(119),p=n.n(d);const m=({action:e,actionContext:t,showTooltip:n,onClick:a})=>{const i=Object(r.useMemo)((()=>({iconType:e.getIconType(t),onClick:()=>{e.execute(t),a&&a()},"data-test-subj":`actionItem-${e.id}`,"aria-label":e.getDisplayName(t)})),[e,t,a]);return i.iconType?n?Object(o.jsx)(u.EuiToolTip,{content:e.getDisplayNameTooltip?e.getDisplayNameTooltip(t):""},Object(o.jsx)(u.EuiButtonIcon,p()({},i,{iconSize:"s"}))):Object(o.jsx)(u.EuiButtonIcon,p()({},i,{iconSize:"s"})):null},f=(e,t)=>t<=1?{extraActions:e,visibleActions:[]}:e.length<=t?{extraActions:[],visibleActions:e}:{visibleActions:e.slice(0,t-1),extraActions:e.slice(t-1,e.length)};var g=n(49),b=n(4);const y=e=>b.i18n.translate("cellActions.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:e},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."}),h=b.i18n.translate("cellActions.extraActionsAriaLabel",{defaultMessage:"Extra actions"}),v=b.i18n.translate("cellActions.showMoreActionsLabel",{defaultMessage:"More actions"}),E=b.i18n.translate("cellActions.actionsAriaLabel",{defaultMessage:"Actions"}),x=Object(o.css)("color:",g.euiThemeVars.euiColorPrimaryText,";",""),j=({anchorPosition:e,actions:t,actionContext:n,isOpen:a,closePopOver:r,button:i})=>Object(o.jsx)(u.EuiPopover,{button:i,isOpen:a,closePopover:r,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!0,repositionOnScroll:!0,ownFocus:!0,"data-test-subj":"extraActionsPopOver","aria-label":h},Object(o.jsx)(S,{actions:t,actionContext:n,closePopOver:r})),O=({anchorPosition:e,anchorRef:t,actionContext:n,isOpen:a,closePopOver:r,actions:i})=>t.current?Object(o.jsx)(u.EuiWrappingPopover,{"aria-label":h,button:t.current,isOpen:a,closePopover:r,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!1,repositionOnScroll:!0,ownFocus:!0,attachToAnchor:!1,"data-test-subj":"extraActionsPopOverWithAnchor"},Object(o.jsx)(S,{actions:i,actionContext:n,closePopOver:r})):null,S=({actionContext:e,actions:t,closePopOver:n})=>{const a=Object(r.useMemo)((()=>t.map((t=>Object(o.jsx)(u.EuiContextMenuItem,{css:x,key:t.id,icon:t.getIconType(e),"aria-label":t.getDisplayName(e),"data-test-subj":`actionItem-${t.id}`,onClick:()=>{n(),t.execute(e)}},t.getDisplayName(e))))),[e,t,n]);return Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)(u.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,y(e.data.map((({field:e})=>e.name)).join(", ")))),Object(o.jsx)(u.EuiContextMenuPanel,{size:"s",items:a}))},w=({onClick:e,showTooltip:t})=>t?Object(o.jsx)(u.EuiToolTip,{content:v},Object(o.jsx)(u.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":v,iconType:"boxesHorizontal",onClick:e})):Object(o.jsx)(u.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":v,iconType:"boxesHorizontal",onClick:e});var k=n(445),I=n.n(k),T=n(427),C=n.n(T);const M=e=>{if(e)throw e},_=(e,t)=>Object(r.useMemo)((()=>D(e,t)),[e,t]),D=(e,t=[])=>e?e.filter((({type:e})=>!(null!=t&&t.includes(e)))):void 0,N=({actionContext:e,anchorPosition:t,showActionTooltips:n,visibleCellActions:a,disabledActionTypes:i})=>{const{value:s}=((e,t={})=>{const{getActions:n}=c(),{error:a,value:r,loading:i}=I()((()=>n(e)),[]),o=_(r,t.disabledActionTypes);return M(a),{value:o,loading:i}})(e,{disabledActionTypes:i}),{extraActions:l,visibleActions:d}=((e,t)=>Object(r.useMemo)((()=>f(null!=e?e:[],t)),[e,t]))(null!=s?s:[],a),[p,g]=Object(r.useState)(!1),b=Object(r.useCallback)((()=>g((e=>!e))),[]),y=Object(r.useCallback)((()=>g(!1)),[]),h=Object(r.useMemo)((()=>Object(o.jsx)(w,{onClick:b,showTooltip:n})),[b,n]);return Object(o.jsx)(u.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"none","data-test-subj":"inlineActions",className:"inlineActions "+(p?"inlineActions-popoverOpen":"")},d.map((t=>Object(o.jsx)(u.EuiFlexItem,{grow:!1,key:`action-item-${t.id}`},Object(o.jsx)(m,{action:t,actionContext:e,showTooltip:n})))),l.length>0?Object(o.jsx)(u.EuiFlexItem,{grow:!1},Object(o.jsx)(j,{actions:l,actionContext:e,anchorPosition:t,button:h,closePopOver:y,isOpen:p})):null)};var A=n(7);const F={minWidth:"24px"},P=Object(o.css)("padding:0 ",g.euiThemeVars.euiSizeS,";",""),R=({anchorPosition:e,children:t,visibleCellActions:n,actionContext:a,showActionTooltips:s,disabledActionTypes:l})=>{const d=Object(r.useRef)(null),[p,b]=Object(r.useState)(!1),[h,v]=Object(r.useState)(!1),[{value:x},j]=((e={})=>{const{getActions:t}=c(),[{error:n,value:a,loading:r},i]=C()(t,[]),o=_(a,e.disabledActionTypes);return M(n),[{value:o,loading:r},i]})({disabledActionTypes:l}),{visibleActions:S,extraActions:k}=Object(r.useMemo)((()=>f(null!=x?x:[],n)),[x,n]),I=Object(r.useMemo)((()=>Object(A.debounce)((()=>{document.body.classList.contains("is-dragging")||v(!0)}),100)),[]);Object(r.useEffect)((()=>()=>{I.cancel()}),[I]);const T=Object(r.useCallback)((()=>{I.cancel(),v(!1)}),[I]),D=Object(r.useCallback)((()=>b(!1)),[b]),N=Object(r.useCallback)((()=>{b(!0),T()}),[T,b]),R=Object(r.useCallback)((async()=>{p||(void 0===x&&j(a),I())}),[p,x,I,j,a]),L=Object(r.useMemo)((()=>Object(o.jsx)("div",{ref:d,onMouseEnter:R,onClick:D},t)),[R,D,t]),q=Object(r.useMemo)((()=>"rightCenter"===e?{marginTop:g.euiThemeVars.euiSizeS}:{}),[e]);return Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)("div",{onMouseLeave:T},Object(o.jsx)(u.EuiPopover,{panelStyle:{...F,...q},anchorPosition:e,button:L,closePopover:T,hasArrow:!1,isOpen:h,panelPaddingSize:"none",repositionOnScroll:!0,ownFocus:!1,panelProps:{"data-test-subj":"hoverActionsPopover"},"aria-label":E},h&&Object(o.jsx)("div",{css:P},Object(o.jsx)(u.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,y(a.data.map((({field:e})=>e.name)).join(", ")))),S.map((e=>Object(o.jsx)(m,{key:e.id,action:e,actionContext:a,showTooltip:s,onClick:T}))),k.length>0&&Object(o.jsx)(w,{onClick:N,showTooltip:s})))),Object(o.jsx)(O,{anchorPosition:e,actions:k,anchorRef:d,actionContext:a,closePopOver:D,isOpen:p}))};var L=n(411);const q=({data:e,triggerId:t,children:n,mode:i,showActionTooltips:s=!0,visibleCellActions:l=3,disabledActionTypes:c=[],metadata:d,className:p})=>{const m=Object(r.useRef)(null),f=Object(r.useMemo)((()=>Object(a.isArray)(e)?e:[e]),[e]),g=Object(r.useMemo)((()=>({data:f,trigger:{id:t},nodeRef:m,metadata:d})),[f,t,d]),b=Object(r.useMemo)((()=>i===L.b.HOVER_DOWN?"downCenter":"rightCenter"),[i]),y=`cellActions-renderContent-${f.map((({field:e})=>e.name)).join("-")}`;return i===L.b.HOVER_DOWN||i===L.b.HOVER_RIGHT?Object(o.jsx)("div",{className:p,ref:m,"data-test-subj":y},Object(o.jsx)(R,{anchorPosition:b,actionContext:g,showActionTooltips:s,visibleCellActions:l,disabledActionTypes:c},n)):Object(o.jsx)(u.EuiFlexGroup,{responsive:!1,alignItems:"center",ref:m,gutterSize:"none",justifyContent:"flexStart",className:p,"data-test-subj":y},Object(o.jsx)(u.EuiFlexItem,{grow:!1},n),Object(o.jsx)(u.EuiFlexItem,{grow:!1},Object(o.jsx)(N,{anchorPosition:b,actionContext:g,showActionTooltips:s,visibleCellActions:l,disabledActionTypes:c})))},z=[],B=({fields:e,getCellValue:t,triggerId:n,metadata:a,dataGridRef:i,disabledActionTypes:o=[]})=>{const[s,l]=Object(r.useState)(z),u=Object(r.useMemo)((()=>{if(n&&null!=e&&e.length)return e.map((e=>({data:[{field:e}],trigger:{id:n},metadata:a})))}),[e,n,a]),{loading:d,value:p}=((e,t={})=>{const{getActions:n}=c(),{error:a,...r}=I()((()=>{var a;return Promise.all(null!==(a=null==e?void 0:e.map((e=>n(e).then((e=>{var n;return null!==(n=D(e,t.disabledActionTypes))&&void 0!==n?n:[]})))))&&void 0!==a?a:[])}),[e]);return M(a),r})(u,{disabledActionTypes:o});return Object(r.useEffect)((()=>{!d&&n&&null!=p&&p.length&&null!=e&&e.length&&p.length===e.length&&l(p.map(((r,o)=>r.map((r=>$({action:r,field:e[o],getCellValue:t,metadata:a,triggerId:n,dataGridRef:i}))))))}),[p,e,t,d,a,n,i]),s},$=({action:e,field:t,getCellValue:n,metadata:a,triggerId:i,dataGridRef:s})=>function({Component:l,rowIndex:c,isExpanded:u}){var d;const p=Object(r.useRef)(null),m=Object(r.useRef)(null),f=Object(r.useMemo)((()=>{const{name:e}=t,r=n(e,c);return{data:[{field:t,value:r}],trigger:{id:i},nodeRef:p,metadata:a}}),[c]),g=Object(r.useCallback)((async()=>{f.nodeRef.current=await V({dataGrid:s.current,isExpanded:u,buttonRef:m}),e.execute(f)}),[f,u]);return Object(o.jsx)(l,{buttonRef:m,"aria-label":e.getDisplayName(f),title:e.getDisplayName(f),"data-test-subj":`dataGridColumnCellAction-${e.id}`,iconType:null!==(d=e.getIconType(f))&&void 0!==d?d:"",onClick:g},e.getDisplayName(f))},V=({dataGrid:e,isExpanded:t,buttonRef:n})=>new Promise((a=>{const r=t?document.querySelector('div[role="gridcell"].euiDataGridRowCell--open'):U(n.current);null==e||e.closeCellPopover(),setTimeout((()=>{var e;a(null!==(e=null==r?void 0:r.firstElementChild)&&void 0!==e?e:null)}))})),U=e=>null==e?null:"DIV"===e.nodeName&&"gridcell"===e.getAttribute("role")?e:U(e.parentElement)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return x}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i);const s=o.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(i.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(i.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));s.displayName="Bar";const l=o.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(i.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(i.css)(["flex:1;"]))));l.displayName="BarSection";const c=o.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(i.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(i.css)(["flex:1;"]))));c.displayName="BarGroup";const u=o.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(i.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));u.displayName="BarText";const d=o.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(i.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const p=o.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(i.css)(["flex:1;"])));p.displayName="BarSpacer";const m=r.a.memo((({border:e,children:t})=>r.a.createElement(s,{border:e},t)));m.displayName="UtilityBar";var f=n(19),g=n(907);const b=o()(f.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(i.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),y=r.a.memo((({children:e,color:t,iconSide:n,iconSize:i,iconType:o,popoverContent:s,disabled:l,ownFocus:c,dataTestSubj:u,popoverPanelPaddingSize:d,onClick:p})=>{const[m,b]=Object(a.useState)(!1),y=Object(a.useCallback)((()=>b(!1)),[b]),h=Object(a.useCallback)((()=>{null==p||p(),b(!m)}),[m,p]);return r.a.createElement(f.EuiPopover,{ownFocus:c,panelPaddingSize:d,button:r.a.createElement(g.a,{dataTestSubj:u,color:t,iconSide:n,iconSize:i,iconType:o,disabled:l,onClick:h},e),closePopover:y,isOpen:m,repositionOnScroll:!0},null==s?void 0:s(y))}));y.displayName="Popover";const h=r.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:i,iconSide:o,iconSize:s,iconType:l,ownFocus:c,onClick:u,popoverContent:p,popoverPanelPaddingSize:m,inProgress:f})=>f?r.a.createElement(d,null,r.a.createElement(b,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):r.a.createElement(d,{"data-test-subj":n},p?r.a.createElement(y,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:o,iconSize:s,iconType:l,ownFocus:c,popoverPanelPaddingSize:m,popoverContent:p,onClick:u},e):r.a.createElement(g.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:i,iconSide:o,iconSize:s,iconType:l,onClick:u},e))));h.displayName="UtilityBarAction";const v=r.a.memo((({grow:e,children:t})=>r.a.createElement(c,{grow:e},t)));v.displayName="UtilityBarGroup";const E=r.a.memo((({grow:e,children:t,dataTestSubj:n})=>r.a.createElement(l,{grow:e,"data-test-subj":n},t)));E.displayName="UtilityBarSection",r.a.memo((({dataTestSubj:e})=>r.a.createElement(p,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const x=r.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1,className:a})=>r.a.createElement(u,{"data-test-subj":t,shouldWrap:n,className:a},e)));x.displayName="UtilityBarText"},function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return _}));var a=n(119),r=n.n(a),i=n(19),o=n(128),s=n(2),l=n.n(s),c=n(75),u=n(45),d=n(41),p=n.n(d),m=n(1630),f=n(337),g=n(171),b=n(424),y=n(149),h=n(173),v=n(131),E=n(857),x=n(915);const j=l.a.memo((({dataProvider:e,scopeId:t=y.f.active,children:n,hideTopN:a=!1})=>{const{timelineId:r}=Object(s.useContext)(E.b),{tableId:i}=Object(s.useContext)(x.b),o=Object(s.useMemo)((()=>{var e;return Object(v.getSourcererScopeId)(null!==(e=null!=t?t:r)&&void 0!==e?e:i)}),[t,i,r]),c=Object(s.useMemo)((()=>{const{value:t,field:n}=e.queryMatch;return{value:t||[],field:n}}),[e.queryMatch]),u=Object(s.useMemo)((()=>a?[h.b.SHOW_TOP_N]:[]),[a]);return l.a.createElement(h.c,{mode:h.a.HOVER_DOWN,visibleCellActions:6,showActionTooltips:!0,triggerId:h.d.DEFAULT,data:c,disabledActionTypes:u,sourcererScopeId:o,metadata:{scopeId:t}},n)}));j.displayName="CellActionsWrapper";var O=n(222),S=n(657),w=n(720);const k=p.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);k.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const I=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));I.displayName="Wrapper";const T=p.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),C=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,M=l.a.memo((({dataProvider:e,render:t,scopeId:n,truncate:a,hideTopN:d})=>{const[p,m]=Object(s.useState)(!1),y=e.id.includes(`-${g.a}-`),h=Object(u.useDispatch)(),v=Object(s.useCallback)((()=>{y||(h(f.a.registerProvider({provider:e})),m(!0))}),[y,h,e]),E=Object(s.useCallback)((()=>p&&h(f.a.unRegisterProvider({id:e.id}))),[p,h,e.id]);Object(s.useEffect)((()=>()=>{E()}),[E]);const x=Object(s.useCallback)(((n,a)=>l.a.createElement(D,{registerProvider:v},l.a.createElement("div",r()({},n.draggableProps,n.dragHandleProps,{style:C(n.draggableProps.style,a),ref:n.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(T,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,a))))),[e,v,t]),k=Object(s.useCallback)(((n,o)=>l.a.createElement(S.a,r()({},n.draggableProps,n.dragHandleProps,{ref:e=>{n.innerRef(e)},"data-test-subj":"providerContainer",isDragging:o.isDragging,registerProvider:v,tabIndex:-1}),l.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),a&&!o.isDragging?l.a.createElement(b.b,{"data-test-subj":"draggable-truncatable-content"},t(e,n,o)):l.a.createElement(T,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,o)),!o.isDragging&&l.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,w.b)))),[e,v,t,a]),M=Object(s.useCallback)((t=>l.a.createElement("div",r()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:o.a,"data-test-subj":"draggableWrapperKeyboardHandler",role:"button",tabIndex:0},l.a.createElement(c.Draggable,{draggableId:Object(O.k)(e.id),index:0,key:Object(O.k)(e.id),isDragDisabled:y},k)),t.placeholder)),[k,e.id,y]),_=Object(s.useMemo)((()=>l.a.createElement(I,{"data-test-subj":"draggableWrapperDiv",disabled:y},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(c.Droppable,{isDropDisabled:!0,droppableId:Object(O.l)(e.id),renderClone:x},M)))),[M,x,e.id,y]);return y?l.a.createElement(l.a.Fragment,null,_):l.a.createElement(j,{dataProvider:e,scopeId:n,hideTopN:d},_)}));M.displayName="DraggableOnWrapper";const _=l.a.memo((({dataProvider:e,isDraggable:t=!1,render:n,scopeId:a,truncate:r,hideTopN:i})=>{const o=Object(s.useMemo)((()=>l.a.createElement("div",{tabIndex:-1,"data-provider-id":Object(O.k)(e.id)},r?l.a.createElement(b.b,{"data-test-subj":"render-truncatable-content"},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):l.a.createElement(T,{"data-test-subj":`render-content-${e.queryMatch.field}`},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,n,r]);return t?l.a.createElement(M,{dataProvider:e,render:n,scopeId:a,truncate:r}):(c=a,[m.b.rulePreview,g.a].includes(null!=c?c:"")?l.a.createElement(l.a.Fragment,null,o):l.a.createElement(j,{dataProvider:e,scopeId:a,hideTopN:i},o));var c}));_.displayName="DraggableWrapper";const D=l.a.memo((({children:e,registerProvider:t})=>(Object(s.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));D.displayName="ConditionalPortal"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var a=n(19),r=n(2),i=n.n(r),o=n(42),s=n(121),l=n(149),c=n(651);const u={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:c.o,content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:i.a.createElement(a.EuiCode,null,c.i),openButton:i.a.createElement(a.EuiCode,null,c.k)}})),anchor:u.ACTION_MENU},{title:c.a,content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:u.ADD_TO_FAVORITES},{timelineTab:l.g.query,title:c.b,content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:i.a.createElement(a.EuiCode,null," ",c.e)}})),anchor:u.DATA_VIEW},{timelineType:s.m.default,timelineTab:l.g.query,title:c.d,content:i.a.createElement(a.EuiText,null,c.c),anchor:u.DATA_PROVIDER},{title:c.m,content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:i.a.createElement(a.EuiCode,null,c.l),editButton:i.a.createElement(a.EuiCode,null,c.f)}})),anchor:u.SAVE_TIMELINE}],p={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:c.n}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(2),r=n.n(a),i=n(19),o=n(1363),s=n(130),l=n(151),c=n(137);let u=function(e){return e.FIRST_SEEN="first-seen",e.LAST_SEEN="last-seen",e}({});const d=r.a.memo((({indexPatterns:e,field:t,type:n,value:d})=>{const[p,{firstSeen:m,lastSeen:f,errorMessage:g}]=Object(o.a)({field:t,value:d,order:n===u.FIRST_SEEN?c.b.asc:c.b.desc,defaultIndex:e}),b=Object(a.useMemo)((()=>n===u.FIRST_SEEN?m:f),[m,f,n]);return null!=g?r.a.createElement(i.EuiToolTip,{position:"top",content:g,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":`firstLastSeenError-${n}`,id:`firstLastSeenError-${t}-${n}`},r.a.createElement(i.EuiIcon,{"aria-describedby":`firstLastSeenError-${t}-${n}`,type:"warning"})):r.a.createElement(r.a.Fragment,null,p&&r.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"m"}),p||null==b||"Invalid Date"!==new Date(b).toString()?!p&&null!==b&&r.a.createElement(i.EuiText,{"data-test-subj":"first-last-seen-value",size:"s"},r.a.createElement(l.b,{value:`${b}`})):b,!p&&null===b&&Object(s.d)())}));d.displayName="FirstLastSeen"},,,function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return b}));var a=n(65),r=n(5),i=(n(167),n(118)),o=n(428);n(412);const s=async({query:e,signal:t})=>i.b.get().http.fetch(r.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(e),signal:t}),l=async({query:e,status:t,signal:n})=>i.b.get().http.fetch(r.sb,{version:"2023-10-31",method:"POST",body:JSON.stringify({conflicts:"proceed",status:t,query:e}),signal:n}),c=async({signalIds:e,status:t,signal:n})=>i.b.get().http.fetch(r.sb,{version:"2023-10-31",method:"POST",body:JSON.stringify({status:t,signal_ids:e}),signal:n}),u=async({signal:e})=>i.b.get().http.fetch(r.lb,{version:"2023-10-31",method:"GET",signal:e}),d=async({signal:e})=>i.b.get().http.fetch(r.hb,{version:"1",method:"GET",signal:e}),p=async({signal:e})=>i.b.get().http.fetch(r.mb,{version:"2023-10-31",method:"GET",signal:e}),m=async({signal:e})=>i.b.get().http.fetch(r.lb,{version:"2023-10-31",method:"POST",signal:e}),f=async({endpointId:e,comment:t="",caseIds:n,agentType:a})=>Object(o.a)({endpoint_ids:[e],comment:t,case_ids:n,agent_type:a}),g=async({endpointId:e,comment:t="",caseIds:n,agentType:a})=>Object(o.b)({endpoint_ids:[e],comment:t,case_ids:n,agent_type:a}),b=async({alertId:e,owner:t})=>i.b.get().http.fetch(Object(a.getCasesFromAlertsUrl)(e),{method:"get",query:{...t.length>0?{owner:t}:{}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var a=n(2);t.useFirstMountState=function(){var e=a.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveHookState=void 0,t.resolveHookState=function(e,t){return"function"==typeof e?e(t):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(328));t.default=function(e){var t=r.useRef(e);t.current=e,i.default((function(){return function(){return t.current()}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120),r=n(199);const i=a.z.object({id:a.z.string().optional(),rule_id:r.P.optional(),list_id:a.z.string().min(1).optional(),item_id:a.z.string().min(1).optional(),error:a.z.object({status_code:a.z.number().int().min(400),message:a.z.string()})}).strict()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(409),r=n(580),i=n(207);const o=e=>`${Object(i.a)(e)}`,s=(e,t,n,o=r.a.events)=>`/ip/${e}/${t||a.a.source}/${o}${Object(i.a)(n)}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(44);const r=e=>Object(a.isString)(e)?e:JSON.stringify(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(2),r=n(45),i=n(4),o=n(1341),s=n(748),l=n(1334),c=n(1491),u=n(122),d=n(213),p=n(118),m=n(146),f=n(121),g=n(129),b=n(817),y=n(556),h=n(331),v=n(172),E=n(131),x=n(123),j=n(187),O=n(219),S=n(274),w=n(243);const k=({ecsRowData:e,onInvestigateInTimelineAlertClick:t})=>{const{addError:n}=Object(x.a)(),{data:{search:k}}=Object(p.j)().services,I=Object(r.useDispatch)(),{startTransaction:T}=Object(j.b)(),{services:C}=Object(p.j)(),{getExceptionFilterFromIds:M}=Object(c.a)(C.http),_=Object(a.useCallback)((async e=>{const t=(e=>{var t;let n=null!==(t=Object(E.getField)(e,o.i))&&void 0!==t?t:[],a=[];try{if(Array.isArray(n)&&0===n.length){var r;const t=null!==(r=Object(E.getField)(e,s.t))&&void 0!==r?r:{};if(t.length>0){var i;const e=JSON.parse(t[0]);n=null!==(i=null==e?void 0:e.exceptions_list)&&void 0!==i?i:[]}}else if(n&&n.list_id)return n.list_id.map(((e,t)=>{const a=n.type[t];return{exception_list_id:e,namespace_type:n.namespace_type[t],type:a}})).filter((e=>e.type===l.a.DETECTION))}catch(e){}return a=n.reduce(((e,t)=>{try{const n="string"==typeof t?JSON.parse(t):t;if(n.type===l.a.DETECTION){const t={exception_list_id:n.list_id,namespace_type:n.namespace_type};e.push(t)}}catch{}return e}),[]),a})(e);let a;return t.length>0&&await M({exceptionListIds:t,excludeExceptions:!0,chunkSize:20,alias:"Exceptions",onSuccess:e=>{a=e},onError:e=>{n(e,{title:i.i18n.translate("xpack.securitySolution.detectionEngine.alerts.fetchExceptionFilterFailure",{defaultMessage:"Error fetching exception filter."})})}}),a}),[n,M]),D=Object(a.useCallback)((e=>I(g.a.updateIsLoading(e))),[I]),N=Object(h.a)({timelineId:m.c.active,timelineType:f.m.default}),A=Object(u.a)("unifiedComponentsInTimelineDisabled"),F=Object(y.a)(),P=Object(a.useCallback)((async({from:e,timeline:t,to:n,ruleNote:a})=>{var r;await N(),D({id:m.c.active,isLoading:!1}),F({duplicate:!0,from:e,id:m.c.active,notes:[],timeline:{...t,columns:A?w.b:S.a,indexNames:null!==(r=t.indexNames)&&void 0!==r?r:[],show:!0,excludedRowRendererIds:A||t.timelineType===f.m.template?[]:t.excludedRowRendererIds},to:n,ruleNote:a})}),[F,D,N,A]),R=Object(a.useCallback)((async()=>{Object(d.a)(),T({name:O.a.INVESTIGATE_IN_TIMELINE}),t&&t(),null!=e&&await Object(b.b)({createTimeline:P,ecsData:e,searchStrategyClient:k,updateTimelineIsLoading:D,getExceptionFilter:_})}),[T,P,e,t,k,D,_]);return{investigateInTimelineActionItems:Object(a.useMemo)((()=>[{key:"investigate-in-timeline-action-item","data-test-subj":"investigate-in-timeline-action-item",disabled:null==e,onClick:R,name:v.i}]),[e,R]),investigateInTimelineAlertClick:R}}},function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"g",(function(){return h}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),y=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),h=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(47),r=n(2),i=n(5),o=n(159),s=n(322);const l=["GET",i.rb],c=(e,t)=>Object(a.useQuery)([...l,e],(async({signal:t})=>{const n=await Object(o.j)({signal:t,...e});return{rules:n.data,total:n.total}}),{...s.a,staleTime:0,...t}),u=()=>{const e=Object(a.useQueryClient)();return Object(r.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])},d=()=>{const e=Object(a.useQueryClient)();return Object(r.useCallback)((t=>{e.setQueriesData(l,(e=>e?{rules:p(e.rules,t),total:e.total}:void 0))}),[e])};function p(e,t){const n=new Map(t.map((e=>[e.id,e])));return e.some((e=>n.has(e.id)))?e.map((e=>{var t;return null!==(t=n.get(e.id))&&void 0!==t?t:e})):e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(285),r=n(198);const i=()=>{const e=new URLSearchParams(window.location.search),t=e.has(r.a.flyout),n="()"!==e.get(r.a.flyout)&&"(preview:!())"!==e.get(r.a.flyout),i=t&&n,o=e.has(r.a.timelineFlyout),s="()"!==e.get(r.a.timelineFlyout)&&"(preview:!())"!==e.get(r.a.timelineFlyout),l=o&&s;return i&&l?a.a.timeline:i?a.a.securitySolution:l?a.a.timeline:null}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(66),i=n.n(r),o=n(953),s=n(43);const l=(e,t)=>n=>(i.a.render(Object(s.jsx)(o.a,t,e),n),()=>i.a.unmountComponentAtNode(n));n(0),n(4),a.Component},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return x}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(197),c=n(300),u=n(4);const d=u.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),p=u.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),m=s()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),f=s.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),g=s.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),b=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(r.useState)(null),[o,s]=(e=>{const[t,n]=Object(r.useState)(null),a=Object(r.useRef)(null);return Object(r.useEffect)((()=>{var e,t,r,i,o,s,l,c,u;null!=(null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==a||null===(r=a.current)||void 0===r?void 0:r.scrollHeight)&&void 0!==t?t:0)>(null!==(i=null==a||null===(o=a.current)||void 0===o?void 0:o.clientHeight)&&void 0!==i?i:0)&&n(!0),(null!==(s=null===(l=a.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==s?s:0)<=(null!==(c=null==a||null===(u=a.current)||void 0===u?void 0:u.clientHeight)&&void 0!==c?c:0)&&n(!1))}),[a,e]),[t,a]})(e),l=Object(r.useCallback)((()=>{a((e=>!e))}),[]);return n?i.a.createElement(i.a.Fragment,null,i.a.createElement(f,{"data-test-subj":"expanded-line-clamp"},i.a.createElement("p",null,e)),o&&i.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},p)):i.a.createElement(i.a.Fragment,null,null==o||!0===o?i.a.createElement(g,{"data-test-subj":"styled-line-clamp",ref:s,lineClampHeight:t},e):e,o&&i.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},d))},y=i.a.memo(b),h=s.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),v=Object(r.createContext)({}),E=({basicData:e,ruleNote:t,showFullView:n=!1,showTitle:r=!0})=>i.a.createElement(v.Provider,{value:e},r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiSpacer,{size:"l"}),i.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},i.a.createElement("h5",null,l.q)),i.a.createElement(a.EuiSpacer,{size:"s"})),i.a.createElement(h,null,n?i.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},i.a.createElement(c.b,null,t)):i.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},i.a.createElement(y,{lineClampHeight:4.5},i.a.createElement(c.b,null,t))))),x=i.a.memo(E)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=a.string;a.union([r,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=a.string;a.union([r,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(46);const r=a.keyof({excluded:null,included:null});let i=function(e){return e.INCLUDED="included",e.EXCLUDED="excluded",e}({});a.keyof({nested:null,match:null,match_any:null,wildcard:null,exists:null,list:null});let o=function(e){return e.NESTED="nested",e.MATCH="match",e.MATCH_ANY="match_any",e.WILDCARD="wildcard",e.EXISTS="exists",e.LIST="list",e}({})},function(e,t,n){"use strict";n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return r})),n.d(t,"NetworkDetailsTableType",(function(){return i}));let a=function(e){return e.page="page",e.details="details",e}({}),r=function(e){return e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies",e}({}),i=function(e){return e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));const a=400,r=null},,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const a="cellAction-filter",r="cellAction-copy";let i=function(e){return e.HOVER_DOWN="hover-down",e.HOVER_RIGHT="hover-right",e.INLINE="inline",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>Object.keys(t).reduce(((e,n)=>e.replace(new RegExp(`\\{${n}\\}`,"g"),String(t[n]))),e)},function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===r}(e)}(e)},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function c(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=i;var r=Array.isArray(t);return r===Array.isArray(e)?r?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&s(e).forEach((function(t){a[t]=i(e[t],n)})),s(t).forEach((function(r){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,r)||(l(e,r)&&n.isMergeableObject(t[r])?a[r]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"==typeof n?n:c}(r,n)(e[r],t[r],n):a[r]=i(t[r],n))})),a}(e,t,n):i(t,n)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};var u=c;e.exports=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(985);Object.defineProperty(t,"createMemo",{enumerable:!0,get:function(){return a.default}});var r=n(986);Object.defineProperty(t,"createReducerContext",{enumerable:!0,get:function(){return r.default}});var i=n(987);Object.defineProperty(t,"createReducer",{enumerable:!0,get:function(){return i.default}});var o=n(988);Object.defineProperty(t,"createStateContext",{enumerable:!0,get:function(){return o.default}});var s=n(445);Object.defineProperty(t,"useAsync",{enumerable:!0,get:function(){return s.default}});var l=n(427);Object.defineProperty(t,"useAsyncFn",{enumerable:!0,get:function(){return l.default}});var c=n(989);Object.defineProperty(t,"useAsyncRetry",{enumerable:!0,get:function(){return c.default}});var u=n(990);Object.defineProperty(t,"useAudio",{enumerable:!0,get:function(){return u.default}});var d=n(992);Object.defineProperty(t,"useBattery",{enumerable:!0,get:function(){return d.default}});var p=n(994);Object.defineProperty(t,"useBeforeUnload",{enumerable:!0,get:function(){return p.default}});var m=n(995);Object.defineProperty(t,"useBoolean",{enumerable:!0,get:function(){return m.default}});var f=n(996);Object.defineProperty(t,"useClickAway",{enumerable:!0,get:function(){return f.default}});var g=n(997);Object.defineProperty(t,"useCookie",{enumerable:!0,get:function(){return g.default}});var b=n(999);Object.defineProperty(t,"useCopyToClipboard",{enumerable:!0,get:function(){return b.default}});var y=n(637);Object.defineProperty(t,"useCounter",{enumerable:!0,get:function(){return y.default}});var h=n(1001);Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return h.default}});var v=n(461);Object.defineProperty(t,"useCustomCompareEffect",{enumerable:!0,get:function(){return v.default}});var E=n(808);Object.defineProperty(t,"useDebounce",{enumerable:!0,get:function(){return E.default}});var x=n(809);Object.defineProperty(t,"useDeepCompareEffect",{enumerable:!0,get:function(){return x.default}});var j=n(1007);Object.defineProperty(t,"useDefault",{enumerable:!0,get:function(){return j.default}});var O=n(1008);Object.defineProperty(t,"useDrop",{enumerable:!0,get:function(){return O.default}});var S=n(1009);Object.defineProperty(t,"useDropArea",{enumerable:!0,get:function(){return S.default}});var w=n(328);Object.defineProperty(t,"useEffectOnce",{enumerable:!0,get:function(){return w.default}});var k=n(1010);Object.defineProperty(t,"useEnsuredForwardedRef",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"ensuredForwardRef",{enumerable:!0,get:function(){return k.ensuredForwardRef}});var I=n(557);Object.defineProperty(t,"useEvent",{enumerable:!0,get:function(){return I.default}});var T=n(1011);Object.defineProperty(t,"useError",{enumerable:!0,get:function(){return T.default}});var C=n(1012);Object.defineProperty(t,"useFavicon",{enumerable:!0,get:function(){return C.default}});var M=n(1013);Object.defineProperty(t,"useFullscreen",{enumerable:!0,get:function(){return M.default}});var _=n(1015);Object.defineProperty(t,"useGeolocation",{enumerable:!0,get:function(){return _.default}});var D=n(638);Object.defineProperty(t,"useGetSet",{enumerable:!0,get:function(){return D.default}});var N=n(1016);Object.defineProperty(t,"useGetSetState",{enumerable:!0,get:function(){return N.default}});var A=n(1017);Object.defineProperty(t,"useHarmonicIntervalFn",{enumerable:!0,get:function(){return A.default}});var F=n(1019);Object.defineProperty(t,"useHover",{enumerable:!0,get:function(){return F.default}});var P=n(639);Object.defineProperty(t,"useHoverDirty",{enumerable:!0,get:function(){return P.default}});var R=n(1020);Object.defineProperty(t,"useIdle",{enumerable:!0,get:function(){return R.default}});var L=n(1022);Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return L.default}});var q=n(1023);Object.defineProperty(t,"useInterval",{enumerable:!0,get:function(){return q.default}});var z=n(37);Object.defineProperty(t,"useIsomorphicLayoutEffect",{enumerable:!0,get:function(){return z.default}});var B=n(640);Object.defineProperty(t,"useKey",{enumerable:!0,get:function(){return B.default}});var $=n(1024);Object.defineProperty(t,"createBreakpoint",{enumerable:!0,get:function(){return $.default}});var V=n(641);Object.defineProperty(t,"useKeyPress",{enumerable:!0,get:function(){return V.default}});var U=n(1025);Object.defineProperty(t,"useKeyPressEvent",{enumerable:!0,get:function(){return U.default}});var G=n(642);Object.defineProperty(t,"useLatest",{enumerable:!0,get:function(){return G.default}});var H=n(643);Object.defineProperty(t,"useLifecycles",{enumerable:!0,get:function(){return H.default}});var W=n(644);Object.defineProperty(t,"useList",{enumerable:!0,get:function(){return W.default}});var Q=n(645);Object.defineProperty(t,"useLocalStorage",{enumerable:!0,get:function(){return Q.default}});var Y=n(1026);Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return Y.default}});var K=n(1027);Object.defineProperty(t,"useLockBodyScroll",{enumerable:!0,get:function(){return K.default}});var Z=n(1028);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return Z.default}});var X=n(1029);Object.defineProperty(t,"useLongPress",{enumerable:!0,get:function(){return X.default}});var J=n(898);Object.defineProperty(t,"useMap",{enumerable:!0,get:function(){return J.default}});var ee=n(1030);Object.defineProperty(t,"useMedia",{enumerable:!0,get:function(){return ee.default}});var te=n(1031);Object.defineProperty(t,"useMediaDevices",{enumerable:!0,get:function(){return te.default}});var ne=n(1032);Object.defineProperty(t,"useMediatedState",{enumerable:!0,get:function(){return ne.useMediatedState}});var ae=n(1033);Object.defineProperty(t,"useMethods",{enumerable:!0,get:function(){return ae.default}});var re=n(1034);Object.defineProperty(t,"useMotion",{enumerable:!0,get:function(){return re.default}});var ie=n(646);Object.defineProperty(t,"useMount",{enumerable:!0,get:function(){return ie.default}});var oe=n(251);Object.defineProperty(t,"useMountedState",{enumerable:!0,get:function(){return oe.default}});var se=n(647);Object.defineProperty(t,"useMouse",{enumerable:!0,get:function(){return se.default}});var le=n(1035);Object.defineProperty(t,"useMouseHovered",{enumerable:!0,get:function(){return le.default}});var ce=n(1036);Object.defineProperty(t,"useMouseWheel",{enumerable:!0,get:function(){return ce.default}});var ue=n(1037);Object.defineProperty(t,"useNetwork",{enumerable:!0,get:function(){return ue.default}});var de=n(1038);Object.defineProperty(t,"useNumber",{enumerable:!0,get:function(){return de.default}});var pe=n(8);Object.defineProperty(t,"useObservable",{enumerable:!0,get:function(){return pe.default}});var me=n(1039);Object.defineProperty(t,"useOrientation",{enumerable:!0,get:function(){return me.default}});var fe=n(1040);Object.defineProperty(t,"usePageLeave",{enumerable:!0,get:function(){return fe.default}});var ge=n(1041);Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return ge.default}});var be=n(271);Object.defineProperty(t,"usePrevious",{enumerable:!0,get:function(){return be.default}});var ye=n(1042);Object.defineProperty(t,"usePreviousDistinct",{enumerable:!0,get:function(){return ye.default}});var he=n(1043);Object.defineProperty(t,"usePromise",{enumerable:!0,get:function(){return he.default}});var ve=n(1044);Object.defineProperty(t,"useQueue",{enumerable:!0,get:function(){return ve.default}});var Ee=n(648);Object.defineProperty(t,"useRaf",{enumerable:!0,get:function(){return Ee.default}});var xe=n(1045);Object.defineProperty(t,"useRafLoop",{enumerable:!0,get:function(){return xe.default}});var je=n(329);Object.defineProperty(t,"useRafState",{enumerable:!0,get:function(){return je.default}});var Oe=n(1046);Object.defineProperty(t,"useSearchParam",{enumerable:!0,get:function(){return Oe.default}});var Se=n(1047);Object.defineProperty(t,"useScratch",{enumerable:!0,get:function(){return Se.default}});var we=n(1053);Object.defineProperty(t,"useScroll",{enumerable:!0,get:function(){return we.default}});var ke=n(1054);Object.defineProperty(t,"useScrolling",{enumerable:!0,get:function(){return ke.default}});var Ie=n(810);Object.defineProperty(t,"useSessionStorage",{enumerable:!0,get:function(){return Ie.default}});var Te=n(327);Object.defineProperty(t,"useSetState",{enumerable:!0,get:function(){return Te.default}});var Ce=n(751);Object.defineProperty(t,"useShallowCompareEffect",{enumerable:!0,get:function(){return Ce.default}});var Me=n(1056);Object.defineProperty(t,"useSize",{enumerable:!0,get:function(){return Me.default}});var _e=n(1057);Object.defineProperty(t,"useSlider",{enumerable:!0,get:function(){return _e.default}});var De=n(1058);Object.defineProperty(t,"useSpeech",{enumerable:!0,get:function(){return De.default}});var Ne=n(1059);Object.defineProperty(t,"useStartTyping",{enumerable:!0,get:function(){return Ne.default}});var Ae=n(1060);Object.defineProperty(t,"useStateWithHistory",{enumerable:!0,get:function(){return Ae.useStateWithHistory}});var Fe=n(1061);Object.defineProperty(t,"useStateList",{enumerable:!0,get:function(){return Fe.default}});var Pe=n(1062);Object.defineProperty(t,"useThrottle",{enumerable:!0,get:function(){return Pe.default}});var Re=n(1063);Object.defineProperty(t,"useThrottleFn",{enumerable:!0,get:function(){return Re.default}});var Le=n(1064);Object.defineProperty(t,"useTimeout",{enumerable:!0,get:function(){return Le.default}});var qe=n(462);Object.defineProperty(t,"useTimeoutFn",{enumerable:!0,get:function(){return qe.default}});var ze=n(1065);Object.defineProperty(t,"useTitle",{enumerable:!0,get:function(){return ze.default}});var Be=n(636);Object.defineProperty(t,"useToggle",{enumerable:!0,get:function(){return Be.default}});var $e=n(1066);Object.defineProperty(t,"useTween",{enumerable:!0,get:function(){return $e.default}});var Ve=n(373);Object.defineProperty(t,"useUnmount",{enumerable:!0,get:function(){return Ve.default}});var Ue=n(1067);Object.defineProperty(t,"useUnmountPromise",{enumerable:!0,get:function(){return Ue.default}});var Ge=n(280);Object.defineProperty(t,"useUpdate",{enumerable:!0,get:function(){return Ge.default}});var He=n(326);Object.defineProperty(t,"useUpdateEffect",{enumerable:!0,get:function(){return He.default}});var We=n(1068);Object.defineProperty(t,"useUpsert",{enumerable:!0,get:function(){return We.default}});var Qe=n(1069);Object.defineProperty(t,"useVibrate",{enumerable:!0,get:function(){return Qe.default}});var Ye=n(1070);Object.defineProperty(t,"useVideo",{enumerable:!0,get:function(){return Ye.default}});var Ke=n(1071);Object.defineProperty(t,"useStateValidator",{enumerable:!0,get:function(){return Ke.default}});var Ze=n(1072);Object.defineProperty(t,"useScrollbarWidth",{enumerable:!0,get:function(){return Ze.useScrollbarWidth}});var Xe=n(1074);Object.defineProperty(t,"useMultiStateValidator",{enumerable:!0,get:function(){return Xe.useMultiStateValidator}});var Je=n(1075);Object.defineProperty(t,"useWindowScroll",{enumerable:!0,get:function(){return Je.default}});var et=n(1076);Object.defineProperty(t,"useWindowSize",{enumerable:!0,get:function(){return et.default}});var tt=n(1077);Object.defineProperty(t,"useMeasure",{enumerable:!0,get:function(){return tt.default}});var nt=n(1078);Object.defineProperty(t,"useRendersCount",{enumerable:!0,get:function(){return nt.useRendersCount}});var at=n(371);Object.defineProperty(t,"useFirstMountState",{enumerable:!0,get:function(){return at.useFirstMountState}});var rt=n(1079);Object.defineProperty(t,"useSet",{enumerable:!0,get:function(){return rt.default}});var it=n(1080);Object.defineProperty(t,"createGlobalState",{enumerable:!0,get:function(){return it.createGlobalState}});var ot=n(1081);Object.defineProperty(t,"useHash",{enumerable:!0,get:function(){return ot.useHash}})},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(5);const r=`${a.qb}/prepackaged`,i=`${a.Lb}/prebuilt_rules`,o=`${r}/_status`,s=`${i}/status`,l=`${i}/upgrade/_review`,c=`${i}/upgrade/_perform`,u=`${i}/installation/_review`,d=`${i}/installation/_perform`},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(44),r=n(2),i=n.n(r),o=n(179),s=n(961);const l=i.a.memo((({dataProvider:e})=>{var t;const[n,l]=Object(r.useState)(!1);return i.a.createElement(s.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:l,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||o.d,type:e.type||o.a.default})}));l.displayName="Provider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(282),i=n(124),o=n(148);const s=({visualizationId:e})=>{const t=Object(a.useMemo)((()=>o.d.globalQueryByIdSelector()),[]),{inspect:n,loading:s,searchSessionId:l}=Object(i.a)((n=>t(n,e)));return Object(a.useMemo)((()=>({requests:n?Object(r.g)(null==n?void 0:n.dsl):null,responses:n?Object(r.g)(null==n?void 0:n.response):null,loading:s,searchSessionId:l})),[n,s,l])}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(19);const u=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?o.a.createElement(c.EuiToolTip,{display:"block",content:e},o.a.createElement(u,r()({"data-test-subj":n},a),t)):o.a.createElement(u,r()({"data-test-subj":n},a),t)}u.displayName="EllipsisText"},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(251));t.default=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var o=r.useRef(0),s=i.default(),l=r.useState(n),c=l[0],u=l[1],d=r.useCallback((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=++o.current;return u((function(e){return a.__assign(a.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return s()&&r===o.current&&u({value:e,loading:!1}),e}),(function(e){return s()&&r===o.current&&u({error:e,loading:!1}),e}))}),t);return[c,d]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(118),r=n(167);const i=async e=>a.b.get().http.post(r.t,{body:JSON.stringify(e),version:"2023-10-31"}),o=async e=>a.b.get().http.post(r.B,{body:JSON.stringify(e),version:"2023-10-31"})},function(e,t,n){"use strict";const a=n(805),r=n(806),i=n(807);function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function l(e,t){return t.decode?r(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function m(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=n):a[e]=n};case"bracket":return(e,n,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],n):a[e]=[n]:a[e]=n};case"comma":case"separator":return(t,n,a)=>{const r="string"==typeof n&&n.split("").indexOf(e.arrayFormatSeparator)>-1?n.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===n?n:l(n,e);a[t]=r};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const r of e.split("&")){let[e,o]=i(t.decode?r.replace(/\+/g," "):r,"=");o=void 0===o?null:["comma","separator"].includes(t.arrayFormat)?o:l(o,t),n(l(e,t),o,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=p(n[e],t);else a[e]=p(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=c(n):e[t]=n,e}),Object.create(null))}t.extract=d,t.parse=m,t.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,a)=>{const r=n.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[s(t,e),"[",r,"]"].join("")]:[...n,[s(t,e),"[",s(r,e),"]=",s(a,e)].join("")]};case"bracket":return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[s(t,e),"[]"].join("")]:[...n,[s(t,e),"[]=",s(a,e)].join("")];case"comma":case"separator":return t=>(n,a)=>null==a||0===a.length?n:0===n.length?[[s(t,e),"=",s(a,e)].join("")]:[[n,s(a,e)].join(e.arrayFormatSeparator)];default:return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,s(t,e)]:[...n,[s(t,e),"=",s(a,e)].join("")]}}(t),r={};for(const t of Object.keys(e))n(t)||(r[t]=e[t]);const i=Object.keys(r);return!1!==t.sort&&i.sort(t.sort),i.map((n=>{const r=e[n];return void 0===r?"":null===r?s(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):s(n,t)+"="+s(r,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,a]=i(e,"#");return Object.assign({url:n.split("?")[0]||"",query:m(d(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:l(a,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const a=u(e.url).split("?")[0]||"",r=t.extract(e.url),i=t.parse(r,{sort:!1}),o=Object.assign(i,e.query);let l=t.stringify(o,n);l&&(l=`?${l}`);let c=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(c=`#${s(e.fragmentIdentifier,n)}`),`${a}${l}${c}`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),i=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),o=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),s=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),c=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),u=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t){const n=Object.freeze({loose:!0}),a=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:a},function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var a=n(4);const r=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),i=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),o=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),s=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),l=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),c=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),u=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(44);const r=e=>e.replace(/:/g,"-"),i=e=>e.replace(/-/g,":"),o=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e)},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(19),r=n(2),i=n.n(r),o=n(42),s=n(4),l=n(1103),c=n(488),u=n(135),d=n(254);const p={OVERVIEW_TAB:c.c,RULE_PREVIEW:u.gb,NAVIGATION_BUTTON:l.f,ENTITIES:d.c,PREVALENCE:d.e},m={currentTourStep:1,isTourActive:!0},f=()=>[{title:s.i18n.translate("xpack.securitySolution.flyout.tour.overview.title",{defaultMessage:"More ways to understand your alerts"}),content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.overview.description",defaultMessage:"Explore new insights in the {entities} and {prevalence} sections.",values:{entities:i.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.overview.entities.text",{defaultMessage:"Entities"})),prevalence:i.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.overview.prevalence.text",{defaultMessage:"Prevalence"}))}})),stepNumber:1,anchor:p.OVERVIEW_TAB,anchorPosition:"downCenter"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.preview.title",{defaultMessage:"A quick way to access rule details"}),content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.rulePreview.description",defaultMessage:"Click {rulePreview} to learn more about the rule that generated the alert.",values:{rulePreview:i.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.rulePreview.text",{defaultMessage:"Show rule summary"}))}})),stepNumber:2,anchor:p.RULE_PREVIEW,anchorPosition:"rightUp"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.expandDetails.title",{defaultMessage:"An expanded view of important alert details"}),content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.expandDetails.description",defaultMessage:"Click the linked text to open and close the flyout's left panel. The left panel is a detailed view of sections in the right panel."})),stepNumber:3,anchor:p.NAVIGATION_BUTTON,anchorPosition:"downCenter"}],g=()=>[{title:s.i18n.translate("xpack.securitySolution.flyout.tour.entities.title",{defaultMessage:"New host and user insights are available"}),content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.entities.description",defaultMessage:"Check out the expanded {entities} view to learn more about hosts and users that are related to the alert.",values:{entities:i.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.entities.text",{defaultMessage:"Entities"}))}})),stepNumber:4,anchor:p.ENTITIES,anchorPosition:"rightUp"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.prevalence.title",{defaultMessage:"New host and user insights are available"}),content:i.a.createElement(a.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.prevalence.description",defaultMessage:"Check out the expanded {prevalence} view to learn how the alert is related to other alerts, events, and entities.",values:{prevalence:i.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.prevalence.text",{defaultMessage:"Prevalence"}))}})),stepNumber:5,anchor:p.PREVALENCE,anchorPosition:"rightUp"}]},,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return f.d})),n.d(t,"a",(function(){return f.a})),n.d(t,"f",(function(){return f.f})),n.d(t,"c",(function(){return f.c})),n.d(t,"e",(function(){return f.e})),n.d(t,"b",(function(){return f.b})),n.d(t,"g",(function(){return Z}));var a=n(120);a.z.object({rules_custom_installed:a.z.number().int().min(0),rules_installed:a.z.number().int().min(0),rules_not_installed:a.z.number().int().min(0),rules_not_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_not_installed:a.z.number().int().min(0),timelines_not_updated:a.z.number().int().min(0)}).strict(),a.z.object({rules_installed:a.z.number().int().min(0),rules_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_updated:a.z.number().int().min(0)}).strict();var r=n(46);const i=r.exact(r.type({rule_id:r.string,version:r.number})),o=r.exact(r.type({mode:r.literal("SPECIFIC_RULES"),rules:r.array(i)})),s=r.exact(r.type({mode:r.literal("ALL_RULES")}));r.union([s,o]);var l=n(2074);let c=function(e){return e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET",e}({});const u=Object(l.a)("PickVersionValues",c),d=r.exact(r.intersection([r.type({rule_id:r.string,revision:r.number,version:r.number}),r.partial({pick_version:u})])),p=r.exact(r.intersection([r.type({mode:r.literal("SPECIFIC_RULES"),rules:r.array(d)}),r.partial({pick_version:u})])),m=r.exact(r.intersection([r.type({mode:r.literal("ALL_RULES")}),r.partial({pick_version:u})]));r.union([m,p]);var f=n(415),g=n(439);const b=e=>r.intersection([r.exact(r.type(e.required)),r.exact(r.type(Object(g.N)(e.optional)))]);var y=n(2076),h=n(425);let v=function(e){return e.index_patterns="index_patterns",e.data_view="data_view",e}({});const E=r.exact(r.type({type:r.literal(v.index_patterns),index_patterns:g.g})),x=r.exact(r.type({type:r.literal(v.data_view),data_view_id:g.c})),j=r.union([E,x]);let O=function(e){return e.inline_query="inline_query",e.saved_query="saved_query",e}({});const S=r.exact(r.type({type:r.literal(O.inline_query),query:g.w,language:g.i,filters:g.q})),w=r.exact(r.type({type:r.literal(O.saved_query),saved_query_id:h.b})),k=r.union([S,w]),I=r.exact(r.type({query:g.w,language:r.literal("eql"),filters:g.q})),T=r.exact(r.type({query:g.w,language:r.literal("esql")})),C=r.exact(r.type({interval:Object(y.a)({allowedUnits:["s","m","h"]}),lookback:Object(y.a)({allowedUnits:["s","m","h"]})})),M=r.exact(r.type({field_name:g.u})),_=r.exact(r.type({field_name:g.L,fallback_disabled:g.M})),D=r.exact(r.type({timeline_id:g.I,timeline_title:g.J})),N=r.exact(r.type({type:g.b}));var A=n(1781),F=n(2079),P=n(1780),R=n(2077),L=n(2131),q=n(1782),z=n(2137),B=n(2138);const $=b({required:{rule_id:g.y,version:g.A,meta:g.s,name:g.t,tags:g.z,description:g.o,severity:A.a,severity_mapping:F.a,risk_score:P.a,risk_score_mapping:R.a,references:g.x,false_positives:g.p,threat:g.F,note:g.h,setup:g.E,related_integrations:g.l,required_fields:g.m,author:g.n,license:g.r,rule_schedule:C,actions:L.a,throttle:q.a,exceptions_list:g.e,max_signals:g.j},optional:{rule_name_override:M,timestamp_override:_,timeline_template:D,building_block:N}}),V=b({required:{type:r.literal("query"),kql_query:k},optional:{data_source:j,alert_suppression:g.a}}),U=b({required:{type:r.literal("saved_query"),kql_query:k},optional:{data_source:j,alert_suppression:g.a}}),G=b({required:{type:r.literal("eql"),eql_query:I},optional:{data_source:j,event_category_override:g.d,timestamp_field:g.K,tiebreaker_field:g.H}}),H=b({required:{type:r.literal("esql"),esql_query:T},optional:{}}),W=b({required:{type:r.literal("threat_match"),kql_query:k,threat_query:S,threat_index:z.e,threat_mapping:z.g},optional:{data_source:j,threat_indicator_path:z.f,concurrent_searches:z.a,items_per_search:z.b}}),Q=b({required:{type:r.literal("threshold"),kql_query:k,threshold:g.G},optional:{data_source:j}}),Y=b({required:{type:r.literal("machine_learning"),machine_learning_job_id:B.a,anomaly_threshold:h.a},optional:{}}),K=b({required:{type:r.literal("new_terms"),kql_query:S,new_terms_fields:g.k,history_window_start:g.f},optional:{data_source:j}});r.intersection([$,r.union([V,U,G,H,W,Q,Y,K])]),n(7),Symbol("MissingVersion");let Z=function(e){return e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C",e}({})},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return w}));var a=n(1532),r=n(2083),i=n(3),o=n(55),s=n(797);const l=Object(a.a)((e=>(({data:e,defaultIndex:t,eventFields:n,filterQuery:a,timerange:r,signal:i})=>e.search.search({defaultIndex:t,eventFields:n,factoryQueryType:s.a.eventEnrichment,filterQuery:a,timerange:r},{strategy:"securitySolutionSearchStrategy",abortSignal:i}))(e).pipe(Object(i.filter)((e=>!Object(o.isRunningResponse)(e)))))),c=()=>Object(r.a)(l);var u=n(2),d=n(45),p=n(7),m=n(271),f=n.n(m),g=n(138),b=n(195),y=n(123),h=n(118),v=n(200);const E=n(4).i18n.translate("xpack.securitySolution.investigationEnrichment.requestError",{defaultMessage:"An error occurred while requesting threat intelligence"});var x=n(5);const j="investigation_time_enrichment",O=()=>{},S={enrichments:[]},w=e=>{const{addError:t}=Object(y.a)(),{data:n,uiSettings:a}=Object(h.j)().services,r=a.get(x.bb),i=Object(d.useDispatch)(),[o,s]=Object(u.useState)({from:b.a,to:b.b}),{error:l,loading:m,result:w,start:k}=c(),I=Object(u.useCallback)((()=>{i(v.c.deleteOneQuery({inputId:g.a.global,id:j}))}),[i]);Object(u.useEffect)((()=>(!m&&w&&i(v.c.setQuery({inputId:g.a.global,id:j,inspect:{dsl:w.inspect.dsl,response:[JSON.stringify(w.rawResponse,null,2)]},loading:m,refetch:O})),I)),[I,i,m,w]),Object(u.useEffect)((()=>{l&&t(l,{title:E})}),[t,l]);const T=f()(e),C=f()(o);return Object(u.useEffect)((()=>{Object(p.isEmpty)(e)||Object(p.isEqual)(e,T)&&Object(p.isEqual)(o,C)||k({data:n,timerange:{...o,interval:""},defaultIndex:r,eventFields:e,filterQuery:""})}),[k,n,e,T,o,C,r]),{result:Object(p.isEmpty)(e)?S:w,range:o,setRange:s,loading:m}}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(427));t.default=function(e,t){void 0===t&&(t=[]);var n=i.default(e,t,{loading:!0}),a=n[0],o=n[1];return r.useEffect((function(){o()}),[o]),a}},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a,r=n(2),i=n(66),o=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s="html",l="svg",c=function(e,t){var n,a,r,i={};if(e===s)r=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');r=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var o=0,c=Object.entries(t.attributes);o<c.length;o++){var u=c[o],d=u[0],p=u[1];r.setAttribute(d,p)}var m={element:r,elementType:e,setPortalProps:function(e){i=e},getInitialPortalProps:function(){return i},mount:function(t,r){if(r!==a){if(m.unmount(),t!==n&&!function(e,t){if(t===s)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,r),n=t,a=r}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,m.element),n=void 0,a=void 0)}};return m},u=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return o(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return i.createPortal(r.Children.map(n,(function(t){return r.isValidElement(t)?r.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(r.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=r.createRef(),n.passPropsThroughPortal(),n}return o(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return r.createElement("div",{ref:this.placeholderNode})},t}(r.PureComponent),p=c.bind(null,s);c.bind(null,l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n(45),i=n(138),o=n(124),s=n(148),l=n(200);const c=({inputId:e=i.a.global,inspectIndex:t=0,isDisabled:n,multiple:c=!1,onClick:u,onCloseInspect:d,queryId:p})=>{const m=Object(r.useDispatch)(),f=Object(a.useMemo)((()=>s.d.globalQueryByIdSelector()),[]),g=Object(a.useMemo)((()=>s.d.timelineQueryByIdSelector()),[]),{loading:b,inspect:y,selectedInspectIndex:h,isInspected:v,searchSessionId:E}=Object(o.a)((t=>e===i.a.global?f(t,p):g(t,p))),x=Object(a.useCallback)((()=>{u&&u(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!0,selectedInspectIndex:t,searchSessionId:E}))}),[u,m,p,e,t,E]),j=Object(a.useCallback)((()=>{null!=d&&d(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!1,selectedInspectIndex:t,searchSessionId:E}))}),[d,m,p,e,t,E]),O=Object(a.useMemo)((()=>null!=y&&y.dsl.length>0?c?y.dsl[0]:y.dsl[t]:null),[t,c,y]),S=Object(a.useMemo)((()=>c?null==y?void 0:y.dsl.slice(1):null),[c,y]),w=Object(a.useMemo)((()=>null!=y&&y.response.length>0?c?y.response[0]:y.response[t]:null),[t,c,y]),k=Object(a.useMemo)((()=>c?null==y?void 0:y.response.slice(1):null),[c,y]),I=Object(a.useMemo)((()=>!b&&h===t&&v),[t,v,b,h]);return{additionalRequests:S,additionalResponses:k,handleClick:x,handleCloseModal:j,isButtonDisabled:Object(a.useMemo)((()=>b||n||null==O||null==w||null==p),[n,b,p,O,w]),isShowingModal:I,loading:b,request:O,response:w}}},function(e,t,n){"use strict";e.exports=n(1084)},,,function(e,t,n){"use strict";var a=n(259);n.d(t,"f",(function(){return a.f})),n.d(t,"e",(function(){return a.e})),n.d(t,"d",(function(){return a.d})),n.d(t,"c",(function(){return a.c})),n.d(t,"b",(function(){return a.b}));var r=n(245);n.d(t,"a",(function(){return r.b}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(2),r=n.n(a);const i=r.a.createContext(null),o=Object(a.memo)((({upsellingService:e,children:t})=>r.a.createElement(i.Provider,{value:e},t)));o.displayName="UpsellingProvider";const s=()=>{const e=Object(a.useContext)(i);if(!e)throw new Error("UpsellingProviderContext not found");return e}},,,function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.apSW=t.bind=t.bindW=t.bindTo=t.bracket=t.taskify=t.taskEitherSeq=t.taskEither=t.Alt=t.Bifunctor=t.ApplicativeSeq=t.ApplicativePar=t.Functor=t.getFilterable=t.getTaskValidation=t.getAltTaskValidation=t.getApplicativeTaskValidation=t.getApplyMonoid=t.getApplySemigroup=t.getSemigroup=t.URI=t.throwError=t.fromTask=t.fromIO=t.of=t.alt=t.flatten=t.chainFirst=t.chainFirstW=t.chain=t.chainW=t.apSecond=t.apFirst=t.ap=t.apW=t.mapLeft=t.bimap=t.map=t.chainIOEitherK=t.chainIOEitherKW=t.chainEitherK=t.chainEitherKW=t.fromIOEitherK=t.fromEitherK=t.tryCatchK=t.filterOrElse=t.swap=t.orElse=t.getOrElse=t.getOrElseW=t.fold=t.tryCatch=t.fromPredicate=t.fromOption=t.fromEither=t.fromIOEither=t.leftIO=t.rightIO=t.leftTask=t.rightTask=t.right=t.left=void 0;var o=i(n(344)),s=n(1277),l=n(269),c=i(n(1280));function u(e,t){return function(){return e().then(o.right,(function(e){return o.left(t(e))}))}}function d(e){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.fromEither(e.apply(void 0,n))}}function p(e){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.fromIOEither(e.apply(void 0,n))}}t.left=l.flow(o.left,c.of),t.right=l.flow(o.right,c.of),t.rightTask=c.map(o.right),t.leftTask=c.map(o.left),t.rightIO=l.flow(c.fromIO,t.rightTask),t.leftIO=l.flow(c.fromIO,t.leftTask),t.fromIOEither=c.fromIO,t.fromEither=o.fold(t.left,(function(e){return t.right(e)})),t.fromOption=function(e){return function(n){return"None"===n._tag?t.left(e()):t.right(n.value)}},t.fromPredicate=function(e,n){return function(a){return e(a)?t.right(a):t.left(n(a))}},t.tryCatch=u,t.fold=l.flow(o.fold,c.chain),t.getOrElseW=function(e){return function(t){return l.pipe(t,c.chain(o.fold(e,c.of)))}},t.getOrElse=t.getOrElseW,t.orElse=function(e){return c.chain(o.fold(e,t.right))},t.swap=c.map(o.swap),t.filterOrElse=function(e,n){return t.chain((function(a){return e(a)?t.right(a):t.left(n(a))}))},t.tryCatchK=function(e,t){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return u((function(){return e.apply(void 0,n)}),t)}},t.fromEitherK=d,t.fromIOEitherK=p,t.chainEitherKW=function(e){return t.chainW(d(e))},t.chainEitherK=t.chainEitherKW,t.chainIOEitherKW=function(e){return t.chainW(p(e))},t.chainIOEitherK=t.chainIOEitherKW;var m=function(e,n){return l.pipe(e,t.map(n))},f=function(e,n,a){return l.pipe(e,t.bimap(n,a))},g=function(e,n){return l.pipe(e,t.mapLeft(n))},b=function(e,n){return l.pipe(e,t.ap(n))},y=function(e,n){return l.pipe(e,t.chain((function(e){return l.pipe(n,t.map(e))})))},h=function(e,n){return l.pipe(e,t.chain(n))},v=function(e,n){return l.pipe(e,t.alt(n))};function E(e){return c.getSemigroup(o.getApplySemigroup(e))}function x(e,n){var a=o.getApplicativeValidation(n);return{URI:t.URI,_E:void 0,map:m,ap:function(t,n){return l.pipe(t,(r=n,function(t){return e.ap(e.map(t,(function(e){return function(t){return a.ap(e,t)}})),r)}));var r},of:t.of}}function j(e){return{URI:t.URI,_E:void 0,map:m,alt:function(t,n){return l.pipe(t,c.chain((function(t){return o.isRight(t)?c.of(t):l.pipe(n(),c.map((function(n){return o.isLeft(n)?o.left(e.concat(t.left,n.left)):n})))})))}}}t.map=function(e){return c.map(o.map(e))},t.bimap=l.flow(o.bimap,c.map),t.mapLeft=function(e){return c.map(o.mapLeft(e))},t.apW=function(e){return l.flow(c.map((function(e){return function(t){return o.apW(t)(e)}})),c.ap(e))},t.ap=t.apW,t.apFirst=function(e){return l.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return l.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.chainW=function(e){return function(n){return l.pipe(n,c.chain(o.fold(t.left,e)))}},t.chain=t.chainW,t.chainFirstW=function(e){return t.chainW((function(n){return l.pipe(e(n),t.map((function(){return n})))}))},t.chainFirst=t.chainFirstW,t.flatten=t.chain(l.identity),t.alt=function(e){return c.chain(o.fold(e,t.right))},t.of=t.right,t.fromIO=t.rightIO,t.fromTask=t.rightTask,t.throwError=t.left,t.URI="TaskEither",t.getSemigroup=function(e){return c.getSemigroup(o.getSemigroup(e))},t.getApplySemigroup=E,t.getApplyMonoid=function(e){return{concat:E(e).concat,empty:t.right(e.empty)}},t.getApplicativeTaskValidation=x,t.getAltTaskValidation=j,t.getTaskValidation=function(e){var n=x(c.ApplicativePar,e),a=j(e);return{URI:t.URI,_E:void 0,map:m,ap:n.ap,of:t.of,chain:h,bimap:f,mapLeft:g,alt:a.alt,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError}},t.getFilterable=function(e){var n=o.getWitherable(e),a=s.getFilterableComposition(c.Monad,n);return{URI:t.URI,_E:void 0,map:m,compact:a.compact,separate:a.separate,filter:a.filter,filterMap:a.filterMap,partition:a.partition,partitionMap:a.partitionMap}},t.Functor={URI:t.URI,map:m},t.ApplicativePar={URI:t.URI,map:m,ap:b,of:t.of},t.ApplicativeSeq={URI:t.URI,map:m,ap:y,of:t.of},t.Bifunctor={URI:t.URI,bimap:f,mapLeft:g},t.Alt={URI:t.URI,map:m,alt:v},t.taskEither={URI:t.URI,bimap:f,mapLeft:g,map:m,of:t.of,ap:b,chain:h,alt:v,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError},t.taskEitherSeq={URI:t.URI,bimap:f,mapLeft:g,map:m,of:t.of,ap:y,chain:h,alt:v,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError},t.taskify=function(e){return function(){var t=Array.prototype.slice.call(arguments);return function(){return new Promise((function(n){e.apply(null,t.concat((function(e,t){return n(null!=e?o.left(e):o.right(t))})))}))}}},t.bracket=function(e,n,a){return l.pipe(e,t.chain((function(e){return l.pipe(l.pipe(n(e),c.map(o.right)),t.chain((function(n){return l.pipe(a(e,n),t.chain((function(){return o.isLeft(n)?t.left(n.left):t.of(n.right)})))})))})))},t.bindTo=function(e){return t.map(l.bindTo_(e))},t.bindW=function(e,n){return t.chainW((function(a){return l.pipe(n(a),t.map((function(t){return l.bind_(a,e,t)})))}))},t.bind=t.bindW,t.apSW=function(e,n){return l.flow(t.map((function(t){return function(n){return l.bind_(t,e,n)}})),t.apW(n))},t.apS=t.apSW},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(891).a},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=a.keyof({binary:null,boolean:null,byte:null,date:null,date_nanos:null,date_range:null,double:null,double_range:null,float:null,float_range:null,geo_point:null,geo_shape:null,half_float:null,integer:null,integer_range:null,ip:null,ip_range:null,keyword:null,long:null,long_range:null,shape:null,short:null,text:null});a.union([r,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),r=n(4),i=n(45),o=n(166),s=n(132),l=n(127),c=n(294),u=n(123),d=n(118),p=n(864);const m=()=>{const{indicesExist:e,dataViewId:t}=Object(s.a)(l.SourcererScopeName.detections),{indexFieldsSearch:n}=Object(c.b)(),m=Object(i.useDispatch)(),{addError:f}=Object(u.a)(),g=Object(a.useRef)(new AbortController),{data:{dataViews:b}}=Object(d.j)().services,y=Object(i.useSelector)(o.d.signalIndexName),h=Object(i.useSelector)(o.d.defaultDataView),v=Object(a.useMemo)((()=>!h.title.includes(`${y}`)),[h.title,y]),E=Object(a.useMemo)((()=>!e&&!v),[e,v]),x=Object(a.useCallback)((()=>{null!==y&&(g.current.abort(),(async()=>{g.current=new AbortController;try{const e=await Object(p.a)({body:{patternList:h.title.split(",")},signal:g.current.signal,dataViewId:t,dataViewService:b});null!==y&&null!=e&&e.defaultDataView.patternList.includes(y)&&(n({dataViewId:e.defaultDataView.id}),m(o.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||f(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[f,t,b,h.title,m,n,y]);return{...E?{pollForSignalIndex:x}:{},signalIndexNeedsInit:v}}},function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return v}));var a=n(7),r=n(57),i=n(138);const o=e=>e.policy,s=e=>e.timerange,l=e=>e.queries,c=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===i.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},u=()=>Object(r.createSelector)(o,(e=>e.kind)),d=()=>Object(r.createSelector)(o,(e=>e.duration)),p=()=>Object(r.createSelector)(s,(e=>e.kind)),m=()=>Object(r.createSelector)(s,(e=>e.from)),f=()=>Object(r.createSelector)(s,(e=>e.to)),g=()=>Object(r.createSelector)(s,(e=>e.fromStr)),b=()=>Object(r.createSelector)(s,(e=>e.toStr)),y=()=>Object(r.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),h=()=>Object(r.createSelector)(c,(e=>e.filter((e=>"kql"!==e.id)))),v=()=>Object(r.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){var r=a.useRef(void 0);r.current&&n(t,r.current)||(r.current=t),a.useEffect(e,r.current)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),r=a.useRef(),i=a.useRef(e),o=a.useCallback((function(){return n.current}),[]),s=a.useCallback((function(){n.current=!1,r.current&&clearTimeout(r.current),r.current=setTimeout((function(){n.current=!0,i.current()}),t)}),[t]),l=a.useCallback((function(){n.current=null,r.current&&clearTimeout(r.current)}),[]);return a.useEffect((function(){i.current=e}),[e]),a.useEffect((function(){return s(),l}),[t]),[o,l,s]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return b}));var a=n(120);const r=a.z.enum([".osquery",".endpoint"]),i=r.enum,o=a.z.object({}).catchall(a.z.object({field:a.z.string().optional(),value:a.z.union([a.z.string(),a.z.array(a.z.string())]).optional()})),s=a.z.object({id:a.z.string(),query:a.z.string(),ecs_mapping:o.optional(),version:a.z.string().optional(),platform:a.z.string().optional(),removed:a.z.boolean().optional(),snapshot:a.z.boolean().optional()}),l=a.z.object({query:a.z.string().optional(),ecs_mapping:o.optional(),queries:a.z.array(s).optional(),pack_id:a.z.string().optional(),saved_query_id:a.z.string().optional(),timeout:a.z.number().optional()}),c=a.z.object({query:a.z.string().optional(),ecsMapping:o.optional(),queries:a.z.array(s).optional(),packId:a.z.string().optional(),savedQueryId:a.z.string().optional(),timeout:a.z.number().optional()}),u=a.z.object({action_type_id:a.z.literal(".osquery"),params:l}),d=a.z.object({actionTypeId:a.z.literal(".osquery"),params:c}),p=a.z.object({command:a.z.literal("isolate"),comment:a.z.string().optional()}),m=a.z.object({command:a.z.enum(["kill-process","suspend-process"]),comment:a.z.string().optional(),config:a.z.object({field:a.z.string(),overwrite:a.z.boolean().optional().default(!0)})}),f=a.z.object({action_type_id:a.z.literal(".endpoint"),params:a.z.union([p,m])}),g=a.z.object({actionTypeId:a.z.literal(".endpoint"),params:a.z.union([p,m])}),b=a.z.union([u,f]);a.z.union([d,g])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(120),r=n(281),i=n(465);const o=a.z.object({last_execution:a.z.object({date:a.z.string().datetime(),status:r.a,status_order:r.c,message:a.z.string(),metrics:i.a})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(120);const r=a.z.object({total_search_duration_ms:a.z.number().int().min(0).optional(),total_indexing_duration_ms:a.z.number().int().min(0).optional(),total_enrichment_duration_ms:a.z.number().int().min(0).optional(),execution_gap_duration_s:a.z.number().int().min(0).optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(120);const r=a.z.string(),i=a.z.string(),o=a.z.string()},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(120),r=n(199);const i=a.z.array(a.z.object({field:a.z.string(),value:a.z.number().int().min(0)})),o=a.z.number().int().min(1),s=a.z.union([a.z.string(),a.z.array(a.z.string())]),l=a.z.array(a.z.string()),c=a.z.object({field:s,value:o,cardinality:i.optional()}),u=(a.z.object({field:l,value:o,cardinality:i.optional()}),a.z.object({field:l,value:o,cardinality:i}),a.z.object({duration:r.b}))},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(120),r=n(268);const i=a.z.string(),o=a.z.array(a.z.object({entries:a.z.array(a.z.object({field:r.a,type:a.z.literal("mapping"),value:r.a}))})).min(1),s=a.z.array(a.z.string()),l=a.z.array(a.z.unknown()),c=a.z.string(),u=a.z.number().int().min(1),d=a.z.number().int().min(1)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(120);const r=a.z.number().int().min(0),i=a.z.union([a.z.string(),a.z.array(a.z.string()).min(1)])},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(120),r=n(268);const i=a.z.array(a.z.string()).min(1).max(3),o=r.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(120);const r=a.z.number().int().min(1),i=a.z.number().int().min(0),o=a.z.object({page:r,per_page:i,total:a.z.number().int().min(0)})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(120);const r=a.z.object({type:a.z.string(),message:a.z.string(),actionPath:a.z.string(),buttonLabel:a.z.string().optional()})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var a=n(5);const r=`${a.Lb}/rules/_rule_management_filters`,i=`${a.Lb}/rules/_coverage_overview`},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(19),r=n(60),i=n.n(r),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(48),d=n(5),p=n(650),m=n(575),f=n(132),g=n(127);const b=c()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));height:41vh;.euiModal__flex{width:60vw;}[role='tabpanel']{height:calc(41vh - 208px) !important;}"]);b.displayName="MyEuiModal";const y=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},h=(e=[])=>1===e.length&&e[0]===d.hc?s.a.createElement("i",null,p.f):e.length>0?e.filter((e=>e!==d.hc)).join(", "):p.k,v=({adHocDataViews:e,additionalRequests:t,additionalResponses:n,closeModal:r,inputId:l,request:c,response:d,title:v})=>{const{pathname:E}=Object(u.useLocation)(),{selectedPatterns:x}=Object(f.a)("timeline"===l?g.SourcererScopeName.timeline:Object(m.a)(E)),j=Object(o.useMemo)((()=>[c,...null!=t?t:[]]),[c,t]),O=Object(o.useMemo)((()=>[d,...null!=n?n:[]]),[d,n]),S=Object(o.useMemo)((()=>y(j)),[j]),w=Object(o.useMemo)((()=>y(O)),[O]),k=Object(o.useMemo)((()=>{var e,t;return(null!==(e=null===(t=S[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>x.includes(e.trim())))}),[S,x]),I=Object(o.useMemo)((()=>{var t,n,r,o;return[{title:s.a.createElement("span",{"data-test-subj":"index-pattern-title"},p.b," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.c,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"index-pattern-description"},s.a.createElement("p",null,h(null!=e&&e.length>0?e:null!==(t=null===(n=S[0])||void 0===n?void 0:n.index)&&void 0!==t?t:[])),!k&&s.a.createElement("p",null,s.a.createElement("small",null,s.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},p.e))))},{title:s.a.createElement("span",{"data-test-subj":"query-time-title"},p.g," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.h,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(r=w[0])||void 0===r?void 0:r.took)?"0ms":null!==(o=w[0])&&void 0!==o&&o.took?`${i()(w[0].took).format("0,0")}ms`:p.k)},{title:s.a.createElement("span",{"data-test-subj":"request-timestamp-title"},p.i," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.j,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}]}),[e,S,w,k]),T=Object(o.useMemo)((()=>[{id:"statistics",name:"Statistics","data-test-subj":"modal-inspect-statistics-tab",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiSpacer,null),s.a.createElement(a.EuiDescriptionList,{listItems:I,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request","data-test-subj":"modal-inspect-request-tab",content:S.length>0?S.map(((e,t)=>s.a.createElement(o.Fragment,{key:t},s.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-request-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return p.k}})(e.body))))):s.a.createElement(a.EuiCodeBlock,null,p.k)},{id:"response",name:"Response","data-test-subj":"modal-inspect-response-tab",content:w.length>0?O.map(((e,t)=>s.a.createElement(o.Fragment,{key:t},s.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-response-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},e)))):s.a.createElement(a.EuiCodeBlock,null,p.k)}]),[S,w,O,I]);return s.a.createElement(b,{onClose:r,"data-test-subj":"modal-inspect-euiModal"},s.a.createElement(a.EuiModalHeader,null,s.a.createElement(a.EuiModalHeaderTitle,null,p.d," ",v)),s.a.createElement(a.EuiModalBody,null,s.a.createElement(a.EuiTabbedContent,{tabs:T,initialSelectedTab:T[0],autoFocus:"selected"})),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButton,{onClick:r,fill:!0,"data-test-subj":"modal-inspect-close"},p.a)))}},function(e,t,n){"use strict";var a=n(411);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"c",(function(){return a.c}))},function(e,t,n){e.exports=n(35)(1029)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n(2))&&"object"==typeof a&&"default"in a?a:{default:a},i=e=>"checkbox"===e.type,o=e=>e instanceof Date,s=e=>null==e;const l=e=>"object"==typeof e;var c=e=>!s(e)&&!Array.isArray(e)&&l(e)&&!o(e),u=e=>c(e)&&e.target?i(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),p="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function m(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(p&&(e instanceof Blob||e instanceof FileList)||!n&&!c(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return c(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=m(e[n]));else t=e}return t}var f=e=>Array.isArray(e)?e.filter(Boolean):[],g=e=>void 0===e,b=(e,t,n)=>{if(!t||!c(e))return n;const a=f(t.split(/[,[\].]+?/)).reduce(((e,t)=>s(e)?e:e[t]),e);return g(a)||a===e?g(e[t])?n:e[t]:a};const y="blur",h="onChange",v="onSubmit",E="all",x="pattern",j="required",O=r.default.createContext(null),S=()=>r.default.useContext(O);var w=(e,t,n,a=!0)=>{const r={defaultValues:t._defaultValues};for(const i in e)Object.defineProperty(r,i,{get:()=>{const r=i;return t._proxyFormState[r]!==E&&(t._proxyFormState[r]=!a||E),n&&(n[r]=!0),e[r]}});return r},k=e=>c(e)&&!Object.keys(e).length,I=(e,t,n,a)=>{n(e);const{name:r,...i}=e;return k(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find((e=>t[e]===(!a||E)))},T=e=>Array.isArray(e)?e:[e],C=(e,t,n)=>n&&t?e===t:!e||!t||e===t||T(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function M(e){const t=r.default.useRef(e);t.current=e,r.default.useEffect((()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function _(e){const t=S(),{control:n=t.control,disabled:a,name:i,exact:o}=e||{},[s,l]=r.default.useState(n._formState),c=r.default.useRef(!0),u=r.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=r.default.useRef(i);return d.current=i,M({disabled:a,next:e=>c.current&&C(d.current,e.name,o)&&I(e,u.current,n._updateFormState)&&l({...n._formState,...e}),subject:n._subjects.state}),r.default.useEffect((()=>(c.current=!0,u.current.isValid&&n._updateValid(!0),()=>{c.current=!1})),[n]),w(s,n,u.current,!1)}var D=e=>"string"==typeof e,N=(e,t,n,a,r)=>D(e)?(a&&t.watch.add(e),b(n,e,r)):Array.isArray(e)?e.map((e=>(a&&t.watch.add(e),b(n,e)))):(a&&(t.watchAll=!0),n);function A(e){const t=S(),{control:n=t.control,name:a,defaultValue:i,disabled:o,exact:s}=e||{},l=r.default.useRef(a);l.current=a,M({disabled:o,subject:n._subjects.values,next:e=>{C(l.current,e.name,s)&&u(m(N(l.current,n._names,e.values||n._formValues,!1,i)))}});const[c,u]=r.default.useState(n._getWatch(a,i));return r.default.useEffect((()=>n._removeUnmounted())),c}var F=e=>/^\w*$/.test(e),P=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function R(e,t,n){let a=-1;const r=F(t)?[t]:P(t),i=r.length,o=i-1;for(;++a<i;){const t=r[a];let i=n;if(a!==o){const n=e[t];i=c(n)||Array.isArray(n)?n:isNaN(+r[a+1])?{}:[]}e[t]=i,e=e[t]}return e}function L(e){const t=S(),{name:n,control:a=t.control,shouldUnregister:i}=e,o=d(a._names.array,n),s=A({control:a,name:n,defaultValue:b(a._formValues,n,b(a._defaultValues,n,e.defaultValue)),exact:!0}),l=_({control:a,name:n}),c=r.default.useRef(a.register(n,{...e.rules,value:s}));return c.current=a.register(n,e.rules),r.default.useEffect((()=>{const e=a._options.shouldUnregister||i,t=(e,t)=>{const n=b(a._fields,e);n&&(n._f.mount=t)};if(t(n,!0),e){const e=m(b(a._options.defaultValues,n));R(a._defaultValues,n,e),g(b(a._formValues,n))&&R(a._formValues,n,e)}return()=>{(o?e&&!a._state.action:e)?a.unregister(n):t(n,!1)}}),[n,a,o,i]),{field:{name:n,value:s,onChange:r.default.useCallback((e=>c.current.onChange({target:{value:u(e),name:n},type:"change"})),[n]),onBlur:r.default.useCallback((()=>c.current.onBlur({target:{value:b(a._formValues,n),name:n},type:y})),[n,a]),ref:e=>{const t=b(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!b(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!b(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!b(l.touchedFields,n)},error:{enumerable:!0,get:()=>b(l.errors,n)}})}}const q="post";var z=(e,t,n,a,r)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:r||!0}}:{};const B=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=b(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else c(a)&&B(a,t)}}};var $=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},V=(e,t,n={})=>n.shouldFocus||g(n.shouldFocus)?n.focusName||`${e}.${g(n.focusIndex)?t:n.focusIndex}.`:"",U=e=>({isOnSubmit:!e||e===v,isOnBlur:"onBlur"===e,isOnChange:e===h,isOnAll:e===E,isOnTouch:"onTouched"===e}),G=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),H=(e,t,n)=>{const a=f(b(e,n));return R(a,"root",t[n]),R(e,n,a),e},W=e=>"boolean"==typeof e,Q=e=>"file"===e.type,Y=e=>"function"==typeof e,K=e=>{if(!p)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Z=e=>D(e),X=e=>"radio"===e.type,J=e=>e instanceof RegExp;const ee={value:!1,isValid:!1},te={value:!0,isValid:!0};var ne=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!g(e[0].attributes.value)?g(e[0].value)||""===e[0].value?te:{value:e[0].value,isValid:!0}:te:ee}return ee};const ae={isValid:!1,value:null};var re=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),ae):ae;function ie(e,t,n="validate"){if(Z(e)||Array.isArray(e)&&e.every(Z)||W(e)&&!e)return{type:n,message:Z(e)?e:"",ref:t}}var oe=e=>c(e)&&!J(e)?e:{value:e,message:""},se=async(e,t,n,a,r)=>{const{ref:o,refs:l,required:u,maxLength:d,minLength:p,min:m,max:f,pattern:y,validate:h,name:v,valueAsNumber:E,mount:O,disabled:S}=e._f,w=b(t,v);if(!O||S)return{};const I=l?l[0]:o,T=e=>{a&&I.reportValidity&&(I.setCustomValidity(W(e)?"":e||""),I.reportValidity())},C={},M=X(o),_=i(o),N=M||_,A=(E||Q(o))&&g(o.value)&&g(w)||K(o)&&""===o.value||""===w||Array.isArray(w)&&!w.length,F=z.bind(null,v,n,C),P=(e,t,n,a="maxLength",r="minLength")=>{const i=e?t:n;C[v]={type:e?a:r,message:i,ref:o,...F(e?a:r,i)}};if(r?!Array.isArray(w)||!w.length:u&&(!N&&(A||s(w))||W(w)&&!w||_&&!ne(l).isValid||M&&!re(l).isValid)){const{value:e,message:t}=Z(u)?{value:!!u,message:u}:oe(u);if(e&&(C[v]={type:j,message:t,ref:I,...F(j,t)},!n))return T(t),C}if(!(A||s(m)&&s(f))){let e,t;const a=oe(f),r=oe(m);if(s(w)||isNaN(w)){const n=o.valueAsDate||new Date(w),i=e=>new Date((new Date).toDateString()+" "+e),s="time"==o.type,l="week"==o.type;D(a.value)&&w&&(e=s?i(w)>i(a.value):l?w>a.value:n>new Date(a.value)),D(r.value)&&w&&(t=s?i(w)<i(r.value):l?w<r.value:n<new Date(r.value))}else{const n=o.valueAsNumber||(w?+w:w);s(a.value)||(e=n>a.value),s(r.value)||(t=n<r.value)}if((e||t)&&(P(!!e,a.message,r.message,"max","min"),!n))return T(C[v].message),C}if((d||p)&&!A&&(D(w)||r&&Array.isArray(w))){const e=oe(d),t=oe(p),a=!s(e.value)&&w.length>+e.value,r=!s(t.value)&&w.length<+t.value;if((a||r)&&(P(a,e.message,t.message),!n))return T(C[v].message),C}if(y&&!A&&D(w)){const{value:e,message:t}=oe(y);if(J(e)&&!w.match(e)&&(C[v]={type:x,message:t,ref:o,...F(x,t)},!n))return T(t),C}if(h)if(Y(h)){const e=ie(await h(w,t),I);if(e&&(C[v]={...e,...F("validate",e.message)},!n))return T(e.message),C}else if(c(h)){let e={};for(const a in h){if(!k(e)&&!n)break;const r=ie(await h[a](w,t),I,a);r&&(e={...r,...F(a,r.message)},T(r.message),n&&(C[v]=e))}if(!k(e)&&(C[v]={ref:I,...e},!n))return C}return T(!0),C};function le(e,t){return[...e,...T(t)]}var ce=e=>Array.isArray(e)?e.map((()=>{})):void 0;function ue(e,t,n){return[...e.slice(0,t),...T(n),...e.slice(t)]}var de=(e,t,n)=>Array.isArray(e)?(g(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function pe(e,t){return[...T(t),...T(e)]}var me=(e,t)=>g(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return f(a).length?a:[]}(e,T(t).sort(((e,t)=>e-t))),fe=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function ge(e,t){const n=Array.isArray(t)?t:F(t)?[t]:P(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=g(e)?a++:e[t[a++]];return e}(e,n),r=n.length-1,i=n[r];return a&&delete a[i],0!==r&&(c(a)&&k(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!g(e[t]))return!1;return!0}(a))&&ge(e,n.slice(0,-1)),e}var be=(e,t,n)=>(e[t]=n,e);function ye(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var he=e=>s(e)||!l(e);function ve(e,t){if(he(e)||he(t))return e===t;if(o(e)&&o(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const r of n){const n=e[r];if(!a.includes(r))return!1;if("ref"!==r){const e=t[r];if(o(n)&&o(e)||c(n)&&c(e)||Array.isArray(n)&&Array.isArray(e)?!ve(n,e):n!==e)return!1}}return!0}var Ee=e=>"select-multiple"===e.type,xe=e=>K(e)&&e.isConnected,je=e=>{for(const t in e)if(Y(e[t]))return!0;return!1};function Oe(e,t={}){const n=Array.isArray(e);if(c(e)||n)for(const n in e)Array.isArray(e[n])||c(e[n])&&!je(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Oe(e[n],t[n])):s(e[n])||(t[n]=!0);return t}function Se(e,t,n){const a=Array.isArray(e);if(c(e)||a)for(const a in e)Array.isArray(e[a])||c(e[a])&&!je(e[a])?g(t)||he(n[a])?n[a]=Array.isArray(e[a])?Oe(e[a],[]):{...Oe(e[a])}:Se(e[a],s(t)?{}:t[a],n[a]):n[a]=!ve(e[a],t[a]);return n}var we=(e,t)=>Se(e,t,Oe(t)),ke=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>g(e)?e:t?""===e?NaN:e?+e:e:n&&D(e)?new Date(e):a?a(e):e;function Ie(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return Q(t)?t.files:X(t)?re(e.refs).value:Ee(t)?[...t.selectedOptions].map((({value:e})=>e)):i(t)?ne(e.refs).value:ke(g(t.value)?e.ref.value:t.value,e)}var Te=e=>g(e)?e:J(e)?e.source:c(e)?J(e.value)?e.value.source:e.value:e;function Ce(e,t,n){const a=b(e,n);if(a||F(n))return{error:a,name:n};const r=n.split(".");for(;r.length;){const a=r.join("."),i=b(t,a),o=b(e,a);if(i&&!Array.isArray(i)&&n!==a)return{name:n};if(o&&o.type)return{name:a,error:o};r.pop()}return{name:n}}const Me={mode:v,reValidateMode:h,shouldFocusError:!0};function _e(e={},t){let n,a={...Me,...e},r={submitCount:0,isDirty:!1,isLoading:Y(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},l={},h=(c(a.defaultValues)||c(a.values))&&m(a.defaultValues||a.values)||{},v=a.shouldUnregister?{}:m(h),x={action:!1,mount:!1,watch:!1},j={mount:new Set,unMount:new Set,array:new Set,watch:new Set},O=0;const S={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},w={values:ye(),array:ye(),state:ye()},I=e.resetOptions&&e.resetOptions.keepDirtyValues,C=U(a.mode),M=U(a.reValidateMode),_=a.criteriaMode===E,A=async e=>{if(S.isValid||e){const e=a.resolver?k((await z()).errors):await $(l,!0);e!==r.isValid&&w.state.next({isValid:e})}},F=e=>S.isValidating&&w.state.next({isValidating:e}),P=(e,t,n,a)=>{const r=b(l,e);if(r){const i=b(v,e,g(n)?b(h,e):n);g(i)||a&&a.defaultChecked||t?R(v,e,t?i:Ie(r._f)):J(e,i),x.mount&&A()}},L=(e,t,n,a,i)=>{let o=!1,s=!1;const l={name:e};if(!n||a){S.isDirty&&(s=r.isDirty,r.isDirty=l.isDirty=V(),o=s!==l.isDirty);const n=ve(b(h,e),t);s=b(r.dirtyFields,e),n?ge(r.dirtyFields,e):R(r.dirtyFields,e,!0),l.dirtyFields=r.dirtyFields,o=o||S.dirtyFields&&s!==!n}if(n){const t=b(r.touchedFields,e);t||(R(r.touchedFields,e,n),l.touchedFields=r.touchedFields,o=o||S.touchedFields&&t!==n)}return o&&i&&w.state.next(l),o?l:{}},q=(t,a,i,o)=>{const s=b(r.errors,t),l=S.isValid&&W(a)&&r.isValid!==a;var c;if(e.delayError&&i?(c=()=>((e,t)=>{R(r.errors,e,t),w.state.next({errors:r.errors})})(t,i),n=e=>{clearTimeout(O),O=setTimeout(c,e)},n(e.delayError)):(clearTimeout(O),n=null,i?R(r.errors,t,i):ge(r.errors,t)),(i?!ve(s,i):s)||!k(o)||l){const e={...o,...l&&W(a)?{isValid:a}:{},errors:r.errors,name:t};r={...r,...e},w.state.next(e)}F(!1)},z=async e=>a.resolver(v,a.context,((e,t,n,a)=>{const r={};for(const n of e){const e=b(t,n);e&&R(r,n,e._f)}return{criteriaMode:n,names:[...e],fields:r,shouldUseNativeValidation:a}})(e||j.mount,l,a.criteriaMode,a.shouldUseNativeValidation)),$=async(e,t,n={valid:!0})=>{for(const i in e){const o=e[i];if(o){const{_f:e,...i}=o;if(e){const i=j.array.has(e.name),s=await se(o,v,_,a.shouldUseNativeValidation&&!t,i);if(s[e.name]&&(n.valid=!1,t))break;!t&&(b(s,e.name)?i?H(r.errors,s,e.name):R(r.errors,e.name,s[e.name]):ge(r.errors,e.name))}i&&await $(i,t,n)}}return n.valid},V=(e,t)=>(e&&t&&R(v,e,t),!ve(re(),h)),Z=(e,t,n)=>N(e,j,{...x.mount?v:g(t)?h:D(e)?{[e]:t}:t},n,t),J=(e,t,n={})=>{const a=b(l,e);let r=t;if(a){const n=a._f;n&&(!n.disabled&&R(v,e,ke(t,n)),r=K(n.ref)&&s(t)?"":t,Ee(n.ref)?[...n.ref.options].forEach((e=>e.selected=r.includes(e.value))):n.refs?i(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(r)?!!r.find((t=>t===e.value)):r===e.value))):n.refs[0]&&(n.refs[0].checked=!!r):n.refs.forEach((e=>e.checked=e.value===r)):Q(n.ref)?n.ref.value="":(n.ref.value=r,n.ref.type||w.values.next({name:e,values:{...v}})))}(n.shouldDirty||n.shouldTouch)&&L(e,r,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ae(e)},ee=(e,t,n)=>{for(const a in t){const r=t[a],i=`${e}.${a}`,s=b(l,i);!j.array.has(e)&&he(r)&&(!s||s._f)||o(r)?J(i,r,n):ee(i,r,n)}},te=(e,n,a={})=>{const i=b(l,e),o=j.array.has(e),c=m(n);R(v,e,c),o?(w.array.next({name:e,values:{...v}}),(S.isDirty||S.dirtyFields)&&a.shouldDirty&&w.state.next({name:e,dirtyFields:we(h,v),isDirty:V(e,c)})):!i||i._f||s(c)?J(e,c,a):ee(e,c,a),G(e,j)&&w.state.next({...r}),w.values.next({name:e,values:{...v}}),!x.mount&&t()},ne=async e=>{const t=e.target;let i=t.name,o=!0;const s=b(l,i);if(s){let d,p;const m=t.type?Ie(s._f):u(e),f=e.type===y||"focusout"===e.type,g=!((c=s._f).mount&&(c.required||c.min||c.max||c.maxLength||c.minLength||c.pattern||c.validate)||a.resolver||b(r.errors,i)||s._f.deps)||((e,t,n,a,r)=>!r.isOnAll&&(!n&&r.isOnTouch?!(t||e):(n?a.isOnBlur:r.isOnBlur)?!e:!(n?a.isOnChange:r.isOnChange)||e))(f,b(r.touchedFields,i),r.isSubmitted,M,C),h=G(i,j,f);R(v,i,m),f?(s._f.onBlur&&s._f.onBlur(e),n&&n(0)):s._f.onChange&&s._f.onChange(e);const E=L(i,m,f,!1),x=!k(E)||h;if(!f&&w.values.next({name:i,type:e.type,values:{...v}}),g)return S.isValid&&A(),x&&w.state.next({name:i,...h?{}:E});if(!f&&h&&w.state.next({...r}),F(!0),a.resolver){const{errors:e}=await z([i]),t=Ce(r.errors,l,i),n=Ce(e,l,t.name||i);d=n.error,i=n.name,p=k(e)}else d=(await se(s,v,_,a.shouldUseNativeValidation))[i],o=isNaN(m)||m===b(v,i,m),o&&(d?p=!1:S.isValid&&(p=await $(l,!0)));o&&(s._f.deps&&ae(s._f.deps),q(i,p,d,E))}var c},ae=async(e,t={})=>{let n,i;const o=T(e);if(F(!0),a.resolver){const t=await(async e=>{const{errors:t}=await z();if(e)for(const n of e){const e=b(t,n);e?R(r.errors,n,e):ge(r.errors,n)}else r.errors=t;return t})(g(e)?e:o);n=k(t),i=e?!o.some((e=>b(t,e))):n}else e?(i=(await Promise.all(o.map((async e=>{const t=b(l,e);return await $(t&&t._f?{[e]:t}:t)})))).every(Boolean),(i||r.isValid)&&A()):i=n=await $(l);return w.state.next({...!D(e)||S.isValid&&n!==r.isValid?{}:{name:e},...a.resolver||!e?{isValid:n}:{},errors:r.errors,isValidating:!1}),t.shouldFocus&&!i&&B(l,(e=>e&&b(r.errors,e)),e?o:j.mount),i},re=e=>{const t={...h,...x.mount?v:{}};return g(e)?t:D(e)?b(t,e):e.map((e=>b(t,e)))},ie=(e,t)=>({invalid:!!b((t||r).errors,e),isDirty:!!b((t||r).dirtyFields,e),isTouched:!!b((t||r).touchedFields,e),error:b((t||r).errors,e)}),oe=(e,t,n)=>{const a=(b(l,e,{_f:{}})._f||{}).ref;R(r.errors,e,{...t,ref:a}),w.state.next({name:e,errors:r.errors,isValid:!1}),n&&n.shouldFocus&&a&&a.focus&&a.focus()},le=(e,t={})=>{for(const n of e?T(e):j.mount)j.mount.delete(n),j.array.delete(n),t.keepValue||(ge(l,n),ge(v,n)),!t.keepError&&ge(r.errors,n),!t.keepDirty&&ge(r.dirtyFields,n),!t.keepTouched&&ge(r.touchedFields,n),!a.shouldUnregister&&!t.keepDefaultValue&&ge(h,n);w.values.next({values:{...v}}),w.state.next({...r,...t.keepDirty?{isDirty:V()}:{}}),!t.keepIsValid&&A()},ce=(e,t={})=>{let n=b(l,e);const r=W(t.disabled);return R(l,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),j.mount.add(e),n?r&&R(v,e,t.disabled?void 0:b(v,e,Ie(n._f))):P(e,!0,t.value),{...r?{disabled:t.disabled}:{},...a.progressive?{required:!!t.required,min:Te(t.min),max:Te(t.max),minLength:Te(t.minLength),maxLength:Te(t.maxLength),pattern:Te(t.pattern)}:{},name:e,onChange:ne,onBlur:ne,ref:r=>{if(r){ce(e,t),n=b(l,e);const a=g(r.value)&&r.querySelectorAll&&r.querySelectorAll("input,select,textarea")[0]||r,o=(e=>X(e)||i(e))(a),s=n._f.refs||[];if(o?s.find((e=>e===a)):a===n._f.ref)return;R(l,e,{_f:{...n._f,...o?{refs:[...s.filter(xe),a,...Array.isArray(b(h,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),P(e,!1,void 0,a)}else n=b(l,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(j.array,e)||!x.action)&&j.unMount.add(e)}}},ue=()=>a.shouldFocusError&&B(l,(e=>e&&b(r.errors,e)),j.mount),de=(e,t)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let i=m(v);if(w.state.next({isSubmitting:!0}),a.resolver){const{errors:e,values:t}=await z();r.errors=e,i=t}else await $(l);ge(r.errors,"root"),k(r.errors)?(w.state.next({errors:{}}),await e(i,n)):(t&&await t({...r.errors},n),ue(),setTimeout(ue)),w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:k(r.errors),submitCount:r.submitCount+1,errors:r.errors})},pe=(n,a={})=>{const i=n||h,o=m(i),s=n&&!k(n)?o:h;if(a.keepDefaultValues||(h=i),!a.keepValues){if(a.keepDirtyValues||I)for(const e of j.mount)b(r.dirtyFields,e)?R(s,e,b(v,e)):te(e,b(s,e));else{if(p&&g(n))for(const e of j.mount){const t=b(l,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(K(e)){const t=e.closest("form");if(t){t.reset();break}}}}l={}}v=e.shouldUnregister?a.keepDefaultValues?m(h):{}:m(s),w.array.next({values:{...s}}),w.values.next({values:{...s}})}j={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!x.mount&&t(),x.mount=!S.isValid||!!a.keepIsValid,x.watch=!!e.shouldUnregister,w.state.next({submitCount:a.keepSubmitCount?r.submitCount:0,isDirty:a.keepDirty?r.isDirty:!(!a.keepDefaultValues||ve(n,h)),isSubmitted:!!a.keepIsSubmitted&&r.isSubmitted,dirtyFields:a.keepDirtyValues?r.dirtyFields:a.keepDefaultValues&&n?we(h,n):{},touchedFields:a.keepTouched?r.touchedFields:{},errors:a.keepErrors?r.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},me=(e,t)=>pe(Y(e)?e(v):e,t);return{control:{register:ce,unregister:le,getFieldState:ie,handleSubmit:de,setError:oe,_executeSchema:z,_getWatch:Z,_getDirty:V,_updateValid:A,_removeUnmounted:()=>{for(const e of j.unMount){const t=b(l,e);t&&(t._f.refs?t._f.refs.every((e=>!xe(e))):!xe(t._f.ref))&&le(e)}j.unMount=new Set},_updateFieldArray:(e,t=[],n,a,i=!0,o=!0)=>{if(a&&n){if(x.action=!0,o&&Array.isArray(b(l,e))){const t=n(b(l,e),a.argA,a.argB);i&&R(l,e,t)}if(o&&Array.isArray(b(r.errors,e))){const t=n(b(r.errors,e),a.argA,a.argB);i&&R(r.errors,e,t),((e,t)=>{!f(b(e,t)).length&&ge(e,t)})(r.errors,e)}if(S.touchedFields&&o&&Array.isArray(b(r.touchedFields,e))){const t=n(b(r.touchedFields,e),a.argA,a.argB);i&&R(r.touchedFields,e,t)}S.dirtyFields&&(r.dirtyFields=we(h,v)),w.state.next({name:e,isDirty:V(e,t),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else R(v,e,t)},_getFieldArray:t=>f(b(x.mount?v:h,t,e.shouldUnregister?b(h,t,[]):[])),_reset:pe,_resetDefaultValues:()=>Y(a.defaultValues)&&a.defaultValues().then((e=>{me(e,a.resetOptions),w.state.next({isLoading:!1})})),_updateFormState:e=>{r={...r,...e}},_subjects:w,_proxyFormState:S,get _fields(){return l},get _formValues(){return v},get _state(){return x},set _state(e){x=e},get _defaultValues(){return h},get _names(){return j},set _names(e){j=e},get _formState(){return r},set _formState(e){r=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:ae,register:ce,handleSubmit:de,watch:(e,t)=>Y(e)?w.values.subscribe({next:n=>e(Z(void 0,t),n)}):Z(e,t,!0),setValue:te,getValues:re,reset:me,resetField:(e,t={})=>{b(l,e)&&(g(t.defaultValue)?te(e,b(h,e)):(te(e,t.defaultValue),R(h,e,t.defaultValue)),t.keepTouched||ge(r.touchedFields,e),t.keepDirty||(ge(r.dirtyFields,e),r.isDirty=t.defaultValue?V(e,b(h,e)):V()),t.keepError||(ge(r.errors,e),S.isValid&&A()),w.state.next({...r}))},clearErrors:e=>{e&&T(e).forEach((e=>ge(r.errors,e))),w.state.next({errors:e?r.errors:{}})},unregister:le,setError:oe,setFocus:(e,t={})=>{const n=b(l,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:ie}}t.Controller=e=>e.render(L(e)),t.Form=function(e){const t=S(),[n,a]=r.default.useState(!1),{control:i=t.control,onSubmit:o,children:s,action:l,method:c=q,headers:u,encType:d,onError:p,render:m,onSuccess:f,validateStatus:g,...y}=e,h=async t=>{let n=!1,a="";await i.handleSubmit((async e=>{const r=new FormData;let s="";try{s=JSON.stringify(e)}catch(e){}for(const t of i._names.mount)r.append(t,b(e,t));if(o&&o({data:e,event:t,method:c,formData:r,formDataJson:s}),l)try{const e=[u&&u["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(l,{method:c,headers:{...u,...d?{"Content-Type":d}:{}},body:e?s:r});t&&(g?!g(t.status):t.status<200||t.status>=300)?(n=!0,p&&p({response:t}),a=String(t.status)):f&&f({response:t})}catch(e){n=!0,p&&p({error:e})}}))(t),n&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:a}))};return r.default.useEffect((()=>{a(!0)}),[]),m?r.default.createElement(r.default.Fragment,null,m({submit:h})):r.default.createElement("form",{noValidate:n,action:l,method:c,encType:d,onSubmit:h,...y},s)},t.FormProvider=e=>{const{children:t,...n}=e;return r.default.createElement(O.Provider,{value:n},t)},t.appendErrors=z,t.get=b,t.set=R,t.useController=L,t.useFieldArray=function(e){const t=S(),{control:n=t.control,name:a,keyName:i="id",shouldUnregister:o}=e,[s,l]=r.default.useState(n._getFieldArray(a)),c=r.default.useRef(n._getFieldArray(a).map($)),u=r.default.useRef(s),d=r.default.useRef(a),p=r.default.useRef(!1);d.current=a,u.current=s,n._names.array.add(a),e.rules&&n.register(a,e.rules),M({next:({values:e,name:t})=>{if(t===d.current||!t){const t=b(e,d.current);Array.isArray(t)&&(l(t),c.current=t.map($))}},subject:n._subjects.array});const f=r.default.useCallback((e=>{p.current=!0,n._updateFieldArray(a,e)}),[n,a]);return r.default.useEffect((()=>{if(n._state.action=!1,G(a,n._names)&&n._subjects.state.next({...n._formState}),p.current&&(!U(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=b(e.errors,a),r=b(n._formState.errors,a);(r?!t&&r.type||t&&(r.type!==t.type||r.message!==t.message):t&&t.type)&&(t?R(n._formState.errors,a,t):ge(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=b(n._fields,a);e&&e._f&&se(e,n._formValues,n._options.criteriaMode===E,n._options.shouldUseNativeValidation,!0).then((e=>!k(e)&&n._subjects.state.next({errors:H(n._formState.errors,e,a)})))}n._subjects.values.next({name:a,values:{...n._formValues}}),n._names.focus&&B(n._fields,(e=>!!e&&e.startsWith(n._names.focus||""))),n._names.focus="",n._updateValid()}),[s,a,n]),r.default.useEffect((()=>(!b(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||o)&&n.unregister(a)})),[a,n,i,o]),{swap:r.default.useCallback(((e,t)=>{const r=n._getFieldArray(a);fe(r,e,t),fe(c.current,e,t),f(r),l(r),n._updateFieldArray(a,r,fe,{argA:e,argB:t},!1)}),[f,a,n]),move:r.default.useCallback(((e,t)=>{const r=n._getFieldArray(a);de(r,e,t),de(c.current,e,t),f(r),l(r),n._updateFieldArray(a,r,de,{argA:e,argB:t},!1)}),[f,a,n]),prepend:r.default.useCallback(((e,t)=>{const r=T(m(e)),i=pe(n._getFieldArray(a),r);n._names.focus=V(a,0,t),c.current=pe(c.current,r.map($)),f(i),l(i),n._updateFieldArray(a,i,pe,{argA:ce(e)})}),[f,a,n]),append:r.default.useCallback(((e,t)=>{const r=T(m(e)),i=le(n._getFieldArray(a),r);n._names.focus=V(a,i.length-1,t),c.current=le(c.current,r.map($)),f(i),l(i),n._updateFieldArray(a,i,le,{argA:ce(e)})}),[f,a,n]),remove:r.default.useCallback((e=>{const t=me(n._getFieldArray(a),e);c.current=me(c.current,e),f(t),l(t),n._updateFieldArray(a,t,me,{argA:e})}),[f,a,n]),insert:r.default.useCallback(((e,t,r)=>{const i=T(m(t)),o=ue(n._getFieldArray(a),e,i);n._names.focus=V(a,e,r),c.current=ue(c.current,e,i.map($)),f(o),l(o),n._updateFieldArray(a,o,ue,{argA:e,argB:ce(t)})}),[f,a,n]),update:r.default.useCallback(((e,t)=>{const r=m(t),i=be(n._getFieldArray(a),e,r);c.current=[...i].map(((t,n)=>t&&n!==e?c.current[n]:$())),f(i),l([...i]),n._updateFieldArray(a,i,be,{argA:e,argB:r},!0,!1)}),[f,a,n]),replace:r.default.useCallback((e=>{const t=T(m(e));c.current=t.map($),f([...t]),l([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[f,a,n]),fields:r.default.useMemo((()=>s.map(((e,t)=>({...e,[i]:c.current[t]||$()})))),[s,i])}},t.useForm=function(e={}){const t=r.default.useRef(),[n,a]=r.default.useState({isDirty:!1,isValidating:!1,isLoading:Y(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:Y(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={..._e(e,(()=>a((e=>({...e}))))),formState:n});const i=t.current.control;return i._options=e,M({subject:i._subjects.state,next:e=>{I(e,i._proxyFormState,i._updateFormState,!0)&&a({...i._formState})}}),r.default.useEffect((()=>{e.values&&!ve(e.values,i._defaultValues)?i._reset(e.values,i._options.resetOptions):i._resetDefaultValues()}),[e.values,i]),r.default.useEffect((()=>{i._state.mount||(i._updateValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()})),t.current.formState=w(n,i),t.current},t.useFormContext=S,t.useFormState=_,t.useWatch=A},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let r="!{osquery",i={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const r=t[e];if("{"===r)a++,n+=r;else if("}"===r){if(a--,-1===a)break;n+=r}else n+=r}r+=n;try{i=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return r+="}",e(r)({type:"osquery",configuration:i})},n.splice(n.indexOf("text"),0,"osquery")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(370);const r=({status:e,query:t,signalIds:n,signal:r})=>{if(n&&n.length>0)return Object(a.i)({status:e,signalIds:n,signal:r}).then((({updated:e})=>({updated:null!=e?e:0,version_conflicts:0})));if(t)return Object(a.j)({status:e,query:t,signal:r}).then((({updated:e,version_conflicts:t})=>({updated:null!=e?e:0,version_conflicts:t})));throw new Error("Either query or signalIds must be provided")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const a=["_source"];function r(e=[],t){return e&&e.length>0&&(1!==e.length||e[0]!==t.timeFieldName)?e:a}function i(e,t){return Object.fromEntries(Object.entries(e).filter((([e])=>e.startsWith(`${t}.`))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(19),o=n(696),s=n(208);const l=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:l,dataTestSubj:c,height:u,autoFocusDisabled:d,setIsMarkdownInvalid:p,includePlugins:m=!0},f)=>{const[g,b]=Object(a.useState)([]),y=Object(a.useCallback)(((e,{messages:t})=>{b(e?[e]:t),p(!!e)}),[p]),h=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t;d||null===(e=h.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const v=Object(s.b)("investigation_guide"),E=Object(s.b)("investigation_guide_interactions"),x=Object(a.useMemo)((()=>m?Object(o.d)({insightsUpsellingMessage:v,interactionsUpsellingMessage:E}):void 0),[m,v,E]);return Object(a.useImperativeHandle)(f,(()=>{var e,t;if(!h.current)return null;const n=null===(e=h.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...h.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),r.a.createElement(i.EuiMarkdownEditor,{ref:h,"aria-label":n,editorId:l,onChange:e,value:t,uiPlugins:x,parsingPluginList:o.a,processingPluginList:o.c,onParse:y,errors:g,"data-test-subj":c,height:u})}));l.displayName="MarkdownEditorComponent";const c=Object(a.memo)(l)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.userProfiles.fetchCurrentUserProfile.failure",{defaultMessage:"Failed to find current user"}),i=a.i18n.translate("xpack.securitySolution.userProfiles.fetchUserProfiles.failure",{defaultMessage:"Failed to find users"}),o=a.i18n.translate("xpack.securitySolution.userProfiles.unknownUser.displayName",{defaultMessage:"Unknown"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={OVERVIEW_TAB_EXPANDED_SECTIONS:"securitySolution.documentDetailsFlyout.overviewSectionExpanded.v8.14",RIGHT_PANEL_SELECTED_TABS:"securitySolution.documentDetailsFlyout.rightPanel.selectedTabs.v8.14"}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l}));const a="network.bytes",r="network.community_id",i="network.direction",o="network.packets",s="network.protocol",l="network.transport"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n.n(a),i=n(19),o=n(126);const s=Object(a.memo)((({title:e,body:t,confirmButton:n,cancelButton:a,onCancel:s,onSuccess:l,"data-test-subj":c})=>{const u=Object(o.a)(c);return r.a.createElement(i.EuiModal,{onClose:s,"data-test-subj":c},r.a.createElement(i.EuiModalHeader,{"data-test-subj":u("header")},r.a.createElement(i.EuiModalHeaderTitle,null,e)),r.a.createElement(i.EuiModalBody,{"data-test-subj":u("body")},r.a.createElement(i.EuiText,null,r.a.createElement("p",null,t))),r.a.createElement(i.EuiModalFooter,null,r.a.createElement(i.EuiButtonEmpty,{onClick:s,"data-test-subj":u("cancelButton")},a),r.a.createElement(i.EuiButton,{fill:!0,onClick:l,"data-test-subj":u("submitButton")},n)))}));s.displayName="ArtifactConfirmModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(211);const r=`${a.a}Body`,i=`${a.a}OverviewTab`,o=`${a.a}OverviewTabLabel`,s=`${a.a}TableTab`,l=`${a.a}JsonTab`},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Re}));var a=n(19),r=n(2),i=n.n(r),o=n(45),s=n(4);const l=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),u=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),p=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),m=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),f=s.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),g=s.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),b=s.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),y=s.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),h=s.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),v=s.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),E=s.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),x=s.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),j=s.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),O=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),S=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),w=s.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),k=s.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),I=s.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),T=s.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),C=s.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),M=s.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),_=s.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),D=s.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),N=s.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),A=s.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),F=s.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),P=s.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),R=s.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),L=s.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),q=s.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),z=s.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),B=s.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var $=n(166),V=n(127),U=n(531),G=n(41),H=n.n(G),W=n(49);const Q=H()(a.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1bcjjxf-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),Y=H()(a.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1bcjjxf-1"})(["max-width:none;"]),K=H()(a.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1bcjjxf-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),Z=H()(a.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1bcjjxf-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),X=H.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1bcjjxf-4"})(["width:600px;"]),J=H()(a.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1bcjjxf-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],W.euiThemeVars.euiSizeXS),ee=H.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1bcjjxf-6"})(["",""],(({theme:e})=>Object(G.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),te=(e,t)=>e.filter((e=>e!==t));var ne=n(308),ae=n(118),re=n(511);const ie=(e,t)=>Object(ne.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var oe=n(42);const se=H()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-yfgyo3-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),le=i.a.memo((({isShowing:e,onDismissModal:t,onContinue:n,onUpdate:r,missingPatterns:o})=>e?i.a.createElement(se,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},i.a.createElement(a.EuiModalHeader,null,i.a.createElement(a.EuiModalHeaderTitle,null,y)),i.a.createElement(a.EuiModalBody,null,i.a.createElement(a.EuiText,{size:"s"},i.a.createElement(a.EuiTextColor,{color:"subdued"},i.a.createElement("p",null,i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:i.a.createElement(ee,null,o.join(", "))}}),b))),i.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(Z,{"aria-label":h,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:n,title:h},h)),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:r,size:"s"},v))))):null));le.displayName="UpdateDefaultDataViewModal";var ce=n(149),ue=n(121),de=n(129),pe=n(124),me=n(158);const fe=({activePatterns:e,deadPatterns:t,selectedPatterns:n,timelineType:o})=>{const s=Object(r.useMemo)((()=>t.length>0?i.a.createElement(a.EuiToolTip,{content:i.a.createElement(ge,{activePatterns:e,selectedPatterns:n,timelineType:o})},i.a.createElement(a.EuiIcon,{type:"questionInCircle",title:F})):null),[e,t.length,n,o]);return o===ue.m.template?i.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:s,callout:i.a.createElement(ee,null,e.join(", "))}})):i.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:s,callout:i.a.createElement(ee,null,e.join(", "))}}))},ge=({activePatterns:e,selectedPatterns:t,timelineType:n})=>{const a=Object(r.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return n===ue.m.template?i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}}):i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}})},be=({timelineType:e,selectedPatterns:t})=>{const n=Object(r.useMemo)((()=>i.a.createElement(ee,null,t.join(", "))),[t]);return e===ue.m.template?i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:n}}):i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:n}})},ye=({onReset:e,timelineType:t})=>t===ue.m.template?i.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:i.a.createElement(a.EuiLink,{onClick:e},f)}})):i.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:i.a.createElement(a.EuiLink,{onClick:e},f)}})),he=({onReset:e,timelineType:t})=>t===ue.m.template?i.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:i.a.createElement(a.EuiLink,{onClick:e},f)}})):i.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:i.a.createElement(a.EuiLink,{onClick:e},f)}})),ve={deprecated:{title:{[ue.m.default]:c,[ue.m.template]:u},update:D},missingPatterns:{title:{[ue.m.default]:d,[ue.m.template]:p},update:v}},Ee=i.a.memo((({activePatterns:e,indicesExist:t,isModified:n,onDismiss:o,onReset:s,onUpdate:l,selectedPatterns:c,missingPatterns:u})=>{const d=Object(r.useMemo)((()=>i.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:l,size:"s",disabled:!t},ve[n].update)),[t,n,l]),p=Object(r.useMemo)((()=>t?d:i.a.createElement(a.EuiToolTip,{position:"top",content:P,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),m=e&&e.length>0?c.filter((t=>!e.includes(t))):[],f=Object(r.useMemo)((()=>de.b.getTimelineByIdSelector()),[]),g=Object(pe.a)((e=>{var t;return(null!==(t=f(e,ce.f.active))&&void 0!==t?t:me.b).timelineType}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:ve[n].title[g]}),i.a.createElement(a.EuiSpacer,{size:"s"}),i.a.createElement(a.EuiText,{size:"s"},i.a.createElement(a.EuiTextColor,{color:"subdued"},i.a.createElement("p",null,e&&e.length>0?i.a.createElement(fe,{timelineType:g,activePatterns:e,deadPatterns:m,selectedPatterns:c}):i.a.createElement(be,{timelineType:g,selectedPatterns:c}),"deprecated"===n&&i.a.createElement(ye,{timelineType:g,onReset:s}),"missingPatterns"===n&&i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:i.a.createElement(ee,null,u.join(", "))}})),i.a.createElement(he,{timelineType:g,onReset:s}))))),i.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(Z,{"aria-label":A,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:o,title:A},A)),i.a.createElement(a.EuiFlexItem,{grow:!1},p)))}));Ee.displayName="TemporarySourcererComp";const xe=i.a.memo((({activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onContinueWithoutUpdate:r,onDismiss:o,onReset:s,onUpdateStepOne:l,onUpdateStepTwo:c,selectedPatterns:u,isShowingUpdateModal:d,onDismissModal:p})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Ee,{activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onDismiss:o,onReset:s,onUpdate:l,selectedPatterns:u}),i.a.createElement(le,{isShowing:d,missingPatterns:a,onDismissModal:p,onContinue:r,onUpdate:c}))));xe.displayName="TemporarySourcerer";var je=n(132),Oe=n(393),Se=n(5);const we=H()(a.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-12c6aaf-0"})(["float:right;"]),ke=i.a.memo((()=>{const e=Object(r.useCallback)((()=>{document.location.reload()}),[]);return i.a.createElement(we,{onClick:e,"data-test-subj":"page-refresh"},z)}));ke.displayName="RefreshButton";var Ie=n(123);const Te=({activePatterns:e,disabled:t,isModified:n,isOnlyDetectionAlerts:o,isPopoverOpen:s,isTimelineSourcerer:l,loading:c,onClick:u,selectedPatterns:d,signalIndexName:p})=>{const m=Object(r.useMemo)((()=>{switch(n){case"modified":return i.a.createElement(J,{"data-test-subj":"sourcerer-modified-badge"},E);case"alerts":return i.a.createElement(J,{"data-test-subj":"sourcerer-alerts-badge"},x);case"deprecated":return i.a.createElement(J,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},j);case"missingPatterns":return i.a.createElement(J,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},j);default:return null}}),[n]),f=Object(r.useMemo)((()=>l?a.EuiButton:K),[l]),b=Object(r.useMemo)((()=>i.a.createElement(f,{"aria-label":g,"data-test-subj":l?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:u,title:g},g,!t&&m)),[t,m,l,c,u,f]),y=Object(r.useMemo)((()=>t?_:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:n,signalIndexName:a})=>t||e&&!a?null:(e?[a]:n).join(", "))({isOnlyDetectionAlerts:o,isPopoverOpen:s,selectedPatterns:null!=e?e:d,signalIndexName:p})),[e,t,o,s,d,p]);return y?i.a.createElement(a.EuiToolTip,{position:"top",content:y,"data-test-subj":"sourcerer-tooltip"},b):b},Ce=Object(r.memo)(Te),Me=i.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?i.a.createElement(a.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Me.displayName="SourcererCallout";const _e=i.a.memo((({onChange:e,checked:t,isShow:n})=>n?i.a.createElement(Y,null,i.a.createElement(a.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:L,onChange:e})):null));_e.displayName="AlertsCheckbox";const De=i.a.memo((({disableSave:e,isShow:t,onReset:n,onSave:r})=>t?i.a.createElement(Y,null,i.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(Z,{"aria-label":N,"data-test-subj":"sourcerer-reset",flush:"left",onClick:n,title:N},N)),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiButton,{onClick:r,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},k)))):null));De.displayName="SaveButtons";var Ne=n(459),Ae=n(189),Fe=n(198);const Pe=i.a.memo((({showSourcerer:e,activePatterns:t,isTriggerDisabled:n,isModified:r,isOnlyDetectionAlerts:o,isPopoverOpen:s,loading:l,setPopoverIsOpenCb:c,selectedPatterns:u,signalIndexName:d,handleClosePopOver:p,isTimelineSourcerer:m,selectedDataViewId:f,sourcererMissingPatterns:g,onUpdateDetectionAlertsChecked:b,setMissingPatterns:y,setDataViewId:h,scopeId:v,children:E})=>e?v===V.SourcererScopeName.analyzer?i.a.createElement(i.a.Fragment,null,E):i.a.createElement(a.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:i.a.createElement(Ce,{activePatterns:t,disabled:n,isModified:r,isOnlyDetectionAlerts:o,isPopoverOpen:s,isTimelineSourcerer:m,loading:l,onClick:c,selectedPatterns:u,signalIndexName:d}),closePopover:p,"data-test-subj":m?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:s,ownFocus:!0,repositionOnScroll:!0},i.a.createElement(i.a.Fragment,null,E)):null));Pe.displayName="SourcererPopover";const Re=i.a.memo((({scope:e})=>{const t=Object(o.useDispatch)(),n=e===V.SourcererScopeName.detections,s=e===V.SourcererScopeName.timeline,c=e===V.SourcererScopeName.default,u=Object(Ae.d)(Fe.a.sourcerer),d=Object(o.useSelector)($.d.signalIndexName),p=Object(o.useSelector)($.d.defaultDataView),g=Object(o.useSelector)($.d.kibanaDataViews),b=Object(o.useSelector)((t=>$.d.sourcererScopeSelectedDataViewId(t,e))),y=Object(o.useSelector)((t=>$.d.sourcererScopeSelectedPatterns(t,e))),h=Object(o.useSelector)((t=>$.d.sourcererScopeMissingPatterns(t,e))),{pollForSignalIndex:v}=Object(Ne.a)();Object(r.useEffect)((()=>{null!=v&&(s||n)&&v()}),[n,s,v]);const{activePatterns:j,indicesExist:k,loading:_}=Object(je.a)(e),[D,N]=Object(r.useState)(j&&j.length>0?h.filter((e=>j.includes(e))):[]);Object(r.useEffect)((()=>{j&&j.length>0&&N(h.filter((e=>j.includes(e))))}),[j,h]);const[A,F]=Object(r.useState)(s&&y.join()===d),P=Object(r.useCallback)((()=>{F(s&&y.join()===d)}),[s,y,d]);Object(r.useEffect)((()=>{P()}),[y]);const L=n||s&&A,[z,G]=Object(r.useState)(!1),[H,W]=Object(r.useState)(b),{allOptions:Z,dataViewSelectOptions:ee,loadingIndexPatterns:se,isModified:le,handleOutsideClick:ce,onChangeCombo:ue,renderOption:de,selectedOptions:pe,setIndexPatternsByDataView:me}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:n,kibanaDataViews:s,missingPatterns:l,scopeId:c,selectedDataViewId:u,selectedPatterns:d,signalIndexName:p})=>{const m=Object(o.useDispatch)(),{data:{dataViews:f}}=Object(ae.j)().services,g=Object(r.useRef)(!0),[b,y]=Object(r.useState)(!1),h=Object(r.useMemo)((()=>p?ie([p]):[]),[p]),v=Object(r.useMemo)((()=>ie(d)),[d]),[j,w]=Object(r.useState)(n?h:v),[k,I]=Object(r.useState)(null==e?"deprecated":l.length>0?"missingPatterns":""),{allPatterns:T,selectablePatterns:C}=Object(r.useMemo)((()=>{if(n&&p)return{allPatterns:[p],selectablePatterns:[p]};const t=s.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const a=[...new Set(t.title.split(","))];return c===$.b.SourcererScopeName.default?{allPatterns:te(a,p),selectablePatterns:te(t.patternList,p)}:{allPatterns:a,selectablePatterns:t.patternList}}),[e,n,s,c,p]),M=Object(r.useMemo)((()=>ie(T,C)),[T,C]),_=Object(r.useCallback)(((e,n=!1)=>c===V.SourcererScopeName.detections||n?h:ie(Object(U.b)(s.find((t=>t.id===e)),c,p,e===t))),[h,s,c,p,t]),D=Object(r.useMemo)((()=>null!=e?_(e):[]),[e,_]),N=Object(r.useCallback)(((e,t)=>{if(null==t)return I("deprecated");if(l.length>0)return I("missingPatterns");if(n)return I("alerts");const a=D.length!==e.length||!D.every((t=>e.find((e=>t.value===e))));return I(a?"modified":"")}),[D,n,l.length]);Object(r.useEffect)((()=>{w(c===V.SourcererScopeName.detections?h:v)}),[d,c,v,h]),Object(r.useEffect)((()=>{N(d.map((e=>e)),u)}),[n,u,l,c,d]);const A=Object(r.useCallback)((e=>{w(e)}),[]),F=Object(r.useCallback)((({value:e})=>i.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),P=Object(r.useCallback)((async(e,t)=>{if(s.some((t=>t.id===e&&0===t.indexFields.length))){try{y(!0),w([]);const t=await Object(re.a)(e,f);g.current&&(m($.a.setDataView(t)),w(n?h:ie(t.patternList)))}catch(e){}y(!1)}else w(_(e,t))}),[h,m,_,n,s,f]),R=Object(r.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:n,isOnlyDetectionAlerts:r,kibanaDataViews:o})=>r?[{inputDisplay:i.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},i.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",S,i.a.createElement(J,{"data-test-subj":"security-alerts-option-badge"},x)),value:t}]:o.map((({title:r,id:o})=>({inputDisplay:o===t?i.a.createElement("span",{"data-test-subj":"security-option-super"},i.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",O,n&&o===e&&i.a.createElement(J,{"data-test-subj":"security-modified-option-badge"},E)):i.a.createElement("span",{"data-test-subj":"dataView-option-super"},i.a.createElement(a.EuiIcon,{type:"logoKibana",size:"s"})," ",r,n&&o===e&&i.a.createElement(J,{"data-test-subj":"security-modified-option-badge"},E)),value:o}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===k,isOnlyDetectionAlerts:n,kibanaDataViews:s}):[]),[e,t,k,n,s]);return Object(r.useEffect)((()=>(g.current=!0,()=>{g.current=!1})),[]),{allOptions:M,dataViewSelectOptions:R,loadingIndexPatterns:b,handleOutsideClick:Object(r.useCallback)((()=>{w(v)}),[v]),isModified:k,onChangeCombo:A,renderOption:F,selectedOptions:j,setIndexPatternsByDataView:P}})({dataViewId:H,defaultDataViewId:p.id,isOnlyDetectionAlerts:L,kibanaDataViews:g,missingPatterns:D,scopeId:e,selectedDataViewId:b,selectedPatterns:y,signalIndexName:d}),fe=Object(r.useCallback)((e=>{F(e.target.checked),W(p.id),me(p.id,e.target.checked)}),[p.id,me]),[ge,be]=Object(r.useState)(!1),[ye,he]=Object(r.useState)(!1),ve=Object(r.useCallback)((()=>{G((e=>!e)),be(!1)}),[]),Ee=Object(r.useCallback)(((n,a,r)=>{t($.a.setSelectedDataView({id:e,selectedDataViewId:n,selectedPatterns:a,shouldValidateSelectedPatterns:r})),c&&u({[V.SourcererScopeName.default]:{id:n,selectedPatterns:a}})}),[t,e,c,u]),we=Object(r.useCallback)((e=>{W(e),me(e)}),[me]),Te=Object(r.useCallback)((()=>{W(p.id),me(p.id),F(!1),N([])}),[p.id,me]),Ce=Object(r.useCallback)((()=>{const e=pe.map((e=>e.label));null!=H&&Ee(H,e),G(!1)}),[Ee,H,pe]),Re=Object(r.useCallback)((()=>{ce(),W(b),N(h),P(),G(!1),be(!1)}),[ce,P,b,h]),Le=Object(r.useCallback)((()=>{he(!1);const e=y.filter((e=>p.patternList.includes(e)));Ee(p.id,e),G(!1)}),[p.id,p.patternList,Ee,y]),qe=Object(r.useCallback)((()=>{0===D.length?Le():he(!0)}),[D,Le]),[ze,Be]=Object(r.useState)(!1),$e=(e=>{const{uiSettings:t,...n}=Object(ae.j)().services,{addSuccess:o,addError:s}=Object(Ie.a)();return Object(r.useCallback)((async r=>{const[l,c]=await(async()=>{try{const e=[...t.get(Se.O),...r];return[await t.set(Se.O,Object(ne.a)(e)),null]}catch(e){return[!1,e]}})();return l?(o({color:"success",title:Object(Oe.a)(q,n),text:Object(Oe.a)(i.a.createElement(ke,null),n),iconType:void 0,toastLifeTimeMs:6e5}),!0):(s(null!==c?c:new Error(B),{title:B,toastMessage:i.a.createElement(i.a.Fragment,null,i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:i.a.createElement(a.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},f)}}))}),!1)}),[s,o,e,t,n])})(Object(r.useCallback)((()=>{G(!0),Te()}),[Te])),Ve=Object(r.useCallback)((async()=>{const e=await $e(D);he(!1),G(!1),e&&(Ee(p.id,null!=j?j:y,!1),Be(!0))}),[j,p.id,D,Ee,y,$e]);Object(r.useEffect)((()=>{W(b)}),[b]);const Ue=Object(r.useCallback)((()=>{be((e=>!e))}),[]),Ge=Object(r.useMemo)((()=>k||[V.SourcererScopeName.analyzer,V.SourcererScopeName.timeline].includes(e)),[k,e]);return i.a.createElement(Pe,{showSourcerer:Ge,activePatterns:j,isTriggerDisabled:ze,isModified:le,isOnlyDetectionAlerts:L,isPopoverOpen:z,isTimelineSourcerer:s,loading:_,handleOutsideClick:ce,setPopoverIsOpenCb:ve,selectedPatterns:y,signalIndexName:d,handleClosePopOver:Re,selectedDataViewId:b,sourcererMissingPatterns:h,onUpdateDetectionAlertsChecked:P,setMissingPatterns:N,setDataViewId:W,scopeId:e},i.a.createElement(X,null,i.a.createElement(a.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},i.a.createElement(i.a.Fragment,null,w)),i.a.createElement(Me,{isOnlyDetectionAlerts:L,title:s?m:l}),i.a.createElement(a.EuiSpacer,{size:"s"}),null===H&&"deprecated"===le||"missingPatterns"===le?i.a.createElement(xe,{activePatterns:j,indicesExist:k,isModified:le,isShowingUpdateModal:ye,missingPatterns:D,onContinueWithoutUpdate:Le,onDismiss:ve,onDismissModal:()=>he(!1),onReset:Te,onUpdateStepOne:"deprecated"===le?qe:Ve,onUpdateStepTwo:Ve,selectedPatterns:y}):i.a.createElement(a.EuiForm,{component:"form"},i.a.createElement(i.a.Fragment,null,i.a.createElement(_e,{isShow:s,checked:A,onChange:fe}),H&&i.a.createElement(Y,{label:I},i.a.createElement(a.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:se,disabled:L,fullWidth:!0,onChange:we,options:ee,placeholder:I,valueOfSelected:H})),i.a.createElement(a.EuiSpacer,{size:"m"}),i.a.createElement(K,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:ge?"arrowDown":"arrowRight",onClick:Ue},T),ge&&i.a.createElement(a.EuiSpacer,{size:"m"}),i.a.createElement(Q,{isDisabled:se,$expandAdvancedOptions:ge,helpText:L?void 0:M,label:C},i.a.createElement(a.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:L||se,onChange:ue,options:Z,placeholder:R,renderOption:de,selectedOptions:pe})),i.a.createElement(De,{disableSave:0===pe.length,isShow:!n,onReset:Te,onSave:Ce})),i.a.createElement(a.EuiSpacer,{size:"s"}))))}));Re.displayName="Sourcerer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(46),r=n(1447),i=n(2069);a.exact(a.type({id:i.a})),a.exact(a.type({items:a.array(r.a)})),a.exact(a.type({name:a.string,description:a.string}));var o=n(891);const s=a.array(o.b),l=new a.Type("DefaultNamespaceArray",s.is,((e,t)=>{if(null==e)return a.success(["single"]);if("string"==typeof e){const n=e.trim().split(",").map((e=>e.trim()));return s.validate(n,t)}return a.failure(e,t)}),String);var c=n(2071),u=n(799),d=n(255);const p=new a.Type("NonEmptyStringArray",a.array(a.string).is,((e,t)=>{if("string"==typeof e&&""!==e.trim()){const n=e.trim().split(",").map((e=>e.trim()));return n.some((e=>""===e))?a.failure(e,t):a.success(n)}return a.failure(e,t)}),String);var m=n(439);a.intersection([a.exact(a.type({namespace_types:l})),a.exact(a.partial({ids:p,list_ids:p}))]);const f=a.exact(a.type({name:m.t,id:m.v,rule_id:m.y,exception_lists:c.a})),g=a.intersection([u.a,a.exact(a.type({referenced_rules:a.array(f)}))]),b=a.record(d.a,g);a.exact(a.type({references:a.array(b)}));var y=n(5);const h=`${y.Lb}/rules`,v=(y.qb,`${h}/exceptions/_find_references`)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return O}));var a=n(19),r=n(2),i=n.n(r),o=n(44),s=n(128),l=n(191),c=n(180),u=n(119),d=n.n(u);const p=({rowIndex:e,colIndex:t,data:n,header:a,eventId:o,linkValues:s,renderCellValue:l,tabType:c,timelineId:u})=>{const[p,m]=Object(r.useState)({});return i.a.createElement("div",d()({"data-test-subj":"statefulCell"},p),l({columnId:a.id,eventId:o,data:n,header:a,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:s,rowIndex:e,colIndex:t,setCellProps:m,scopeId:u,key:null!=c?`${u}-${c}`:u}))};p.displayName="StatefulCellComponent";const m=i.a.memo(p);var f=n(4);const g=({column:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),b=e=>f.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),y=({notesCount:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),h=e=>{var t;const{altKey:n,ctrlKey:a,key:r,metaKey:i,shiftKey:o,target:l,type:u}=e,d=l;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(r)&&null!==(t=d.className)&&void 0!==t&&t.includes(c.b)){const t=d.querySelector(`.${s.a}`),l=new KeyboardEvent(u,{altKey:n,bubbles:!0,cancelable:!0,ctrlKey:a,key:r,metaKey:i,shiftKey:o});" "===r&&e.preventDefault(),null==t||t.dispatchEvent(l)}},v=({action:e,width:t,actionsColumnWidth:n,ariaRowindex:r,columnId:o,columnValues:s,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:v,eventId:E,loadingEventIds:x,notesCount:j,onEventDetailsPanelOpened:O,onRowSelected:S,refetch:w,rowIndex:k,hasRowRenderers:I,onRuleChange:T,selectedEventIds:C,showCheckboxes:M,showNotes:_,tabType:D,timelineId:N,toggleShowNotes:A,setEventsLoading:F,setEventsDeleted:P})=>{const R=t||n;return i.a.createElement(c.m,{width:R,"data-test-subj":"event-actions-container",tabIndex:0},i.a.createElement(c.k,{$ariaColumnIndex:m+l.b,key:null!=D?`${E}_${D}`:`${E}`,onKeyDown:h,role:"button",tabIndex:0,width:t},i.a.createElement(c.l,{"data-test-subj":"cell-container"},i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},i.a.createElement("p",null,g({row:r,column:m+2}))),e&&i.a.createElement(e,{ariaRowindex:r,width:t,checked:Object.keys(C).includes(E),columnId:o,columnValues:s,eventId:E,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:v,loadingEventIds:x,onEventDetailsPanelOpened:O,onRowSelected:S,refetch:w,rowIndex:k,onRuleChange:T,showCheckboxes:M,showNotes:_,timelineId:N,toggleShowNotes:A,setEventsLoading:F,setEventsDeleted:P}))),I?i.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},i.a.createElement("p",null,b(r))):null,j?i.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},i.a.createElement("p",null,y({row:r,notesCount:j}))):null))},E=({_id:e,ariaRowindex:t,index:n,header:r,data:s,ecsData:u,hasRowRenderers:d,notesCount:p,renderCellValue:f,tabType:v,timelineId:E})=>{var x;const j=n+l.b;return i.a.createElement(c.k,{$ariaColumnIndex:j,key:null!=v?`${r.id}_${v}`:`${r.id}`,onKeyDown:h,role:"button",tabIndex:0,width:r.initialWidth},i.a.createElement(c.l,{"data-test-subj":"cell-container"},i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},i.a.createElement("p",null,g({row:t,column:j}))),i.a.createElement(m,{rowIndex:t-1,colIndex:j-1,data:s,header:r,eventId:e,linkValues:Object(o.getOr)([],null!==(x=r.linkField)&&void 0!==x?x:"",u),renderCellValue:f,tabType:v,timelineId:E}))),d?i.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},i.a.createElement("p",null,b(t))):null,p?i.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},i.a.createElement("p",null,y({row:t,notesCount:p}))):null)},x=i.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:n,columnValues:a,data:o,ecsData:s,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,id:p,loadingEventIds:m,notesCount:f,onEventDetailsPanelOpened:g,onRowSelected:b,refetch:y,hasRowRenderers:h,onRuleChange:x,renderCellValue:j,selectedEventIds:O,showCheckboxes:S,showNotes:w,tabType:k,timelineId:I,toggleShowNotes:T,trailingControlColumns:C,leadingControlColumns:M,setEventsLoading:_,setEventsDeleted:D})=>{const N=Object(r.useMemo)((()=>C?C.map((e=>e.rowCellRender)):[]),[C]),A=Object(r.useMemo)((()=>M.length+n.length),[M,n]),F=Object(r.useMemo)((()=>N.map(((n,r)=>n&&i.a.createElement(v,{action:n,width:C[r].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(O).includes(p),columnId:C[r].id||"",columnValues:a,onRowSelected:b,"data-test-subj":"actions",eventId:p,data:o,key:r,index:A+r,rowIndex:e,ecsData:s,loadingEventIds:m,onEventDetailsPanelOpened:g,showCheckboxes:S,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,notesCount:f,refetch:y,hasRowRenderers:h,onRuleChange:x,selectedEventIds:O,showNotes:w,tabType:k,timelineId:I,toggleShowNotes:T,setEventsLoading:_,setEventsDeleted:D})))),[C,p,o,s,b,u,d,t,e,a,l,h,A,m,f,g,x,y,O,S,w,k,I,T,N,_,D]),P=Object(r.useMemo)((()=>n.map(((t,n)=>i.a.createElement(E,{_id:p,index:n,header:t,key:null!=k?`${t.id}_${k}`:`${t.id}`,ariaRowindex:e,data:o,ecsData:s,hasRowRenderers:h,notesCount:f,renderCellValue:j,tabType:k,timelineId:I})))),[p,e,n,o,s,h,f,j,k,I]);return i.a.createElement(c.n,{"data-test-subj":"data-driven-columns"},P,F)}));x.displayName="DataDrivenColumns";const j=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const n=e.find((e=>e.field===t));return null!=n&&null!=n.value?n.value:void 0},O=({data:e,fieldName:t})=>Object(r.useMemo)((()=>j({data:e,fieldName:t})),[e,t])},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var a=n(46);const r=a.keyof({linux:null,macos:null,windows:null}),i=(e=>{const t=a.array(e);return new a.Type("DefaultArray",t.is,((e,n)=>null==e?a.success([]):t.validate(e,n)),a.identity)})(r),o=a.union([i,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=new a.Type("DefaultStringArray",a.array(a.string).is,((e,t)=>null==e?a.success([]):a.array(a.string).validate(e,t)),a.identity);a.union([r,a[void 0]])},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(308),r=n(294);const i=async(e,t,n=!1)=>{var i,o;const s=await t.get(e,!0,n),l=s.toSpec(),c=Object(a.a)(s.getIndexPattern().split(",")),u=await t.getExistingIndices(c);return{loading:!1,id:null!==(i=l.id)&&void 0!==i?i:"",title:s.getIndexPattern(),indexFields:s.fields,fields:l.fields,patternList:u,dataView:l,browserFields:Object(r.a)(null!==(o=l.id)&&void 0!==o?o:"",l.fields).browserFields,runtimeMappings:l.runtimeFieldMap}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.indexFieldsSearch.errorSearchDescription",{defaultMessage:"An error has occurred creating the ad-hoc data view"}),i=a.i18n.translate("xpack.securitySolution.dataView.fetchFields.warning",{defaultMessage:"Failed to fetch detailed fields information"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(897);const i=()=>{const e=Object(a.useContext)(r.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(44);const l=o.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(i.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;&:focus-visible{pointer-events:auto;opacity:1;}}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(s.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),c=r.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?r.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):r.a.createElement(r.a.Fragment,null,n)));c.displayName="HoverVisibilityContainer"},function(e,t,n){"use strict";e.exports=n(709)},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"r",(function(){return y})),n.d(t,"u",(function(){return h})),n.d(t,"t",(function(){return v})),n.d(t,"v",(function(){return E})),n.d(t,"x",(function(){return x})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"w",(function(){return S})),n.d(t,"s",(function(){return w})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return I}));var a=n(4);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const r=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),i=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),o=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),s=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),c=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),u=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),y=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),h=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),v=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),E=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),x=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),j=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),O=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),S=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),w=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),k=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),I=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n.n(a),i=n(42),o=n(137);const s=({riskScoreEntity:e,title:t})=>r.a.createElement(r.a.Fragment,null,null!=t?t:e===o.t.user?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.usersRiskDashboard.title",defaultMessage:"User Risk Scores"}):r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.hostsRiskDashboard.title",defaultMessage:"Host Risk Scores"})),l=r.a.memo(s);l.displayName="RiskScoreHeaderTitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return p}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.timeline.categoryTooltip",{defaultMessage:"Category"}),i=a.i18n.translate("xpack.securitySolution.timeline.descriptionTooltip",{defaultMessage:"Description"}),o=a.i18n.translate("xpack.securitySolution.timeline.fieldTooltip",{defaultMessage:"Field"}),s=a.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),l=a.i18n.translate("xpack.securitySolution.timeline.hideColumnLabel",{defaultMessage:"Hide column"}),c=a.i18n.translate("xpack.securitySolution.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),u=a.i18n.translate("xpack.securitySolution.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),d=a.i18n.translate("xpack.securitySolution.timeline.typeTooltip",{defaultMessage:"Type"}),p=a.i18n.translate("xpack.securitySolution.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return y}));var a=n(2),r=n.n(a),i=n(19),o=n(41),s=n.n(o),l=n(118),c=n(235),u=n(573),d=n(4);const p=d.i18n.translate("xpack.securitySolution.noPermissionsTitle",{defaultMessage:"Privileges required"}),m=d.i18n.translate("xpack.securitySolution.noPrivilegesDefaultMessage",{defaultMessage:"To view this page, you must update privileges. For more information, contact your Kibana administrator."}),f=d.i18n.translate("xpack.securitySolution.goToDocumentationButton",{defaultMessage:"View documentation"}),g=s()(i.EuiFlexItem).withConfig({displayName:"SizedEuiFlexItem",componentId:"sc-156zz3c-0"})(["min-height:460px;font-size:1.1rem;"]),b=r.a.memo((({pageName:e,docLinkSelector:t})=>r.a.createElement(c.a,null,r.a.createElement(i.EuiFlexGroup,null,r.a.createElement(g,null,r.a.createElement(i.EuiPageTemplate.EmptyPrompt,null,r.a.createElement(y,{pageName:e,docLinkSelector:t})))))));b.displayName="NoPrivilegePage";const y=r.a.memo((({pageName:e,docLinkSelector:t})=>{const{docLinks:n}=Object(l.j)().services,i=Object(a.useMemo)((()=>({feature:{icon:"documents",label:f,url:t(n.links),target:"_blank"}})),[t,n.links]),o=e?(e=>d.i18n.translate("xpack.securitySolution.noPrivilegesPerPageMessage",{values:{pageName:e},defaultMessage:"To view {pageName}, you must update privileges. For more information, contact your Kibana administrator."}))(e):m;return r.a.createElement(u.a,{actions:i,message:o,"data-test-subj":"noPrivilegesPage",title:p})}));y.displayName="NoPrivileges"},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(2),r=n(189),i=n(21);const o=e=>{const t=s();return Object(a.useMemo)((()=>t(e)),[t,e])},s=()=>{const e=Object(r.a)();return Object(a.useCallback)((t=>((e,t)=>Object(i.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(47),r=n(118),i=n(277);function o({documentId:e,isActiveTimeline:t,indices:n}){const o=Object(r.i)(),{selectedPatterns:s}=Object(i.a)(t),l=[...new Set(s.concat(n))],{loading:c,id:u,schema:d,agentId:p}=function({documentId:e,indices:t}){const n=Object(r.i)(),i=Object(a.useQuery)(["getAlertPrevalenceSchema",e],(()=>n.get("/api/endpoint/resolver/entity",{query:{_id:e,indices:t}})));if(i.isLoading)return{loading:!0,error:!1,id:null,schema:null,agentId:null};if(i.data&&i.data.length>0){const{data:[{schema:e,id:t,agentId:n}]}=i;return{loading:!1,error:!1,id:t,schema:e,agentId:n}}return{loading:!1,error:!0,id:null,schema:null,agentId:null}}({documentId:e,indices:l}),m=Object(a.useQuery)(["getAlertPrevalenceFromProcessTree",u],(()=>o.post("/api/endpoint/resolver/tree",{body:JSON.stringify({schema:d,ancestors:200,descendants:500,indexPatterns:l,nodes:[u],includeHits:!0,agentId:p})})),{enabled:null!==d&&null!==u});return m.isLoading||c?{loading:!0,error:!1,alertIds:void 0,statsNodes:void 0}:m.data?{loading:!1,error:!1,alertIds:m.data.alertIds,statsNodes:m.data.statsNodes}:{loading:!1,error:!0,alertIds:void 0,statsNodes:void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(350);const r=e=>Object(a.a)(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(44),i=n(122);const o=e=>{const t=Object(i.a)("sentinelOneDataInAnalyzerEnabled"),n=Object(i.a)("crowdstrikeDataInAnalyzerEnabled"),o=Object(i.a)("jamfDataInAnalyzerEnabled");return Object(a.useMemo)((()=>{const a=[...t?["sentinel_one_cloud_funnel","sentinel_one"]:[],...n?["crowdstrike"]:[],...o?["jamf_protect"]:[]],i=Object(r.get)(["agent","type",0],e),s=Object(r.get)(["process","entity_id"],e),l=Object(r.get)(["process","entity_id",0],e),c=Object(r.get)(["event","module",0],e),u=Object(r.get)(["event","dataset"],e),d=Array.isArray(u)&&u.some((e=>e.includes("windows.sysmon"))),p="endpoint"===i,m="winlogbeat"===i&&"sysmon"===c,f="filebeat"===i&&a.includes(c),g=p||m||d||f,b=null!=s&&1===s.length&&""!==l;return g&&b}),[n,e,t,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(41),c=n.n(l),u=n(482),d=n(126);const p=c()(s.EuiContextMenuItem).withConfig({displayName:"StyledEuiContextMenuItem",componentId:"sc-t3r55d-0"})([".additional-info{display:none;max-width:50%;}&:hover{.additional-info{display:block !important;}}"]),m=c()("div").withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-t3r55d-1"})(["max-width:50%;padding-right:",";"],(e=>e.theme.eui.euiSizeS)),f=c()(s.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-t3r55d-2"})(["padding:",";line-height:",";"],(e=>e.theme.eui.euiSizeM),(e=>e.theme.eui.euiFontSizeM)),g=Object(i.memo)((({navigateAppId:e,navigateOptions:t,onClick:n,textTruncate:a,hoverInfo:l,children:c,isNavigationDisabled:g=!1,...b})=>{const y=Object(u.a)(null!=e?e:"",{...t,onClick:n}),h=Object(d.a)(b["data-test-subj"]),v=Object(i.useMemo)((()=>{const e="additional-info "+("object"!=typeof l?"eui-textTruncate":"");return l?o.a.createElement(m,{className:e},l):null}),[l]),E=a?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",r()({className:"eui-textTruncate","data-test-subj":h("truncateWrapper")},"string"==typeof c?{title:c}:{}),c),v):o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiFlexItem,null,c),v);return g?o.a.createElement(f,{size:"s",className:"eui-textTruncate","data-test-subj":b["data-test-subj"]},E):o.a.createElement(p,r()({},b,{onClick:e?y:n}),o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},E))}));g.displayName="EuiContextMenuItemNavByRouter"},function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(47),r=n(3),i=n(167),o=n(118),s=n(182),l=n(544),c=n(935);function u({onError:e,page:t,perPage:n}={page:1,perPage:s.c}){const r=Object(o.i)();return Object(a.useQuery)(["endpointSpecificPolicies",t,n],(()=>Object(c.a)(r,{query:{page:t,perPage:n,withAgentCount:!0}})),e?{onError:e}:void 0)}function d(e){const{data:t}=Object(o.j)().services;return Object(a.useQuery)(["endpointPackagePoliciesStatsStrategy"],(async()=>Object(r.firstValueFrom)(t.search.search({},{strategy:i.m}))),{select:e=>e.rawResponse,enabled:e})}function p({customQueryOptions:e}){const t=Object(o.i)();return Object(a.useQuery)(["endpointPackageVersion",e],(()=>Object(l.c)(t)),e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(67);const r="/api/fleet",i=`${r}/package_policies`,o=`${r}/agent_status`,s=(e,t,n)=>e.get(`${i}/${t}`,{...n,version:a.API_VERSIONS.public.v1}),l=(e,t,n)=>e.post(`${i}/_bulk_get`,{...n,version:a.API_VERSIONS.public.v1,body:JSON.stringify({ids:t,ignoreMissing:!0})}),c=(e,t,n,r={})=>e.put(`${i}/${t}`,{...r,version:a.API_VERSIONS.public.v1,body:JSON.stringify(n)}),u=(e,t,n={})=>e.get(o,{...n,version:a.API_VERSIONS.public.v1,query:{policyId:t}}),d=async e=>{const t=a.epmRouteService.getInfoPath("endpoint"),n=(await e.get(t,{version:a.API_VERSIONS.public.v1})).item;if(!n)throw new Error("Endpoint package was not found.");return n}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return ye}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(44),l=n(19),c=n(168),u=n(1334),d=n(1555),p=n(1561),m=n(4);const f=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.cancel",{defaultMessage:"Cancel"}),g=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.createRuleExceptionLabel",{defaultMessage:"Add rule exception"}),b=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.addEndpointException",{defaultMessage:"Add Endpoint Exception"}),y=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.title",{defaultMessage:"An error occured submitting exception"}),h=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.dismissButton",{defaultMessage:"Dismiss"}),v=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.message",{defaultMessage:"View toast for error details."}),E=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.success",{defaultMessage:"Rule exception added to shared exception list"}),x=m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception added"});var j=n(632),O=n(343),S=n(353);const w={initialItems:[],exceptionItems:[],exceptionItemMeta:{name:""},newComment:"",commentErrorExists:!1,itemConditionValidationErrorExists:!1,closeSingleAlert:!1,bulkCloseAlerts:!1,disableBulkClose:!1,bulkCloseIndex:void 0,selectedOs:void 0,exceptionListsToAddTo:[],addExceptionToRadioSelection:"add_to_rule",selectedRulesToAddTo:[],listType:u.a.RULE_DEFAULT,errorSubmitting:null,expireTime:void 0,expireErrorExists:!1,wildcardWarningExists:!1};var k=n(878),I=n(879),T=n(840),C=n(871);const M=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addExceptionToRuleOrList.addToListsLabel",{defaultMessage:"Add to rule or lists"});var _=n(42),D=n(868);const N=({possibleRules:e,isSingleRule:t,isBulkAction:n,selectedRadioOption:i,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(a.useMemo)((()=>n&&null!=e?{id:"add_to_rules",label:r.a.createElement(l.EuiText,{"data-test-subj":"addToRulesRadioOption"},r.a.createElement(_.FormattedMessage,{defaultMessage:"Add to [{numRules}] selected rules: {ruleNames}",id:"xpack.securitySolution.exceptions.common.addToRulesOptionLabel",values:{numRules:e.length,ruleNames:r.a.createElement("span",{style:{fontWeight:"bold"}},e.map((({name:e})=>e)).join(","))}})),checked:"add_to_rules"===i,"data-test-subj":"addToRulesOptionsRadio",onChange:()=>{s("add_to_rules"),o(e)}}:t&&null!=e?{id:"add_to_rule",label:r.a.createElement(l.EuiText,{"data-test-subj":"addToRuleRadioOption"},r.a.createElement(_.FormattedMessage,{defaultMessage:"Add to this rule: {ruleName}",id:"xpack.securitySolution.exceptions.common.addToRuleOptionLabel",values:{ruleName:r.a.createElement("span",{style:{fontWeight:"bold"}},e[0].name)}})),checked:"add_to_rule"===i,"data-test-subj":"addToRuleOptionsRadio",onChange:()=>{s("add_to_rule"),o(e)}}:{id:"select_rules_to_add_to",label:r.a.createElement(l.EuiText,{"data-test-subj":"selectRulesToAddToRadioOption"},r.a.createElement(_.FormattedMessage,{defaultMessage:"Add to rules",id:"xpack.securitySolution.exceptions.common.selectRulesOptionLabel"})),checked:"select_rules_to_add_to"===i,"data-test-subj":"selectRulesToAddToOptionRadio",onChange:()=>s("select_rules_to_add_to")}),[n,e,t,i,s,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiRadio,c),"select_rules_to_add_to"===i&&r.a.createElement(D.a,{onRuleSelectionChange:o,initiallySelectedRules:[]}))},A=r.a.memo(N);A.displayName="ExceptionsAddToRulesOptions";const F=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsOptionLabel",{defaultMessage:"Add to shared exception lists"}),P=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.gotToSharedExceptions",{defaultMessage:"Manage shared exception lists"}),R=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltip",{defaultMessage:"Shared exception list is a group of exceptions. Select this option if you’d like to add this exception to shared exception lists."}),L=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipAriaLabel",{defaultMessage:"Learn more about shared exception lists"}),q=e=>m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipTitle",{values:{rulesCount:e},defaultMessage:"Shared exception list is a group of exceptions shared across rules. {rulesCount, plural, =1 {This rule currently has no shared} other {These rules currently have no commonly shared}} exception lists attached. To create one, visit the Shared Exception Lists page."});var z=n(627);const B=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.addToListsDescription",{defaultMessage:"After you create the exception, it is added to the exception lists you select."}),$=(m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.viewListDetailActionLabel",{defaultMessage:"View list detail"}),m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.referencesFetchError",{defaultMessage:"Unable to load shared exception lists"}));var V=n(595);const U=e=>m.i18n.translate("xpack.securitySolution.rule_exceptions.addToListTable.linkListSwitch.ariaLabel",{values:{name:e},defaultMessage:'Link "{name}"'}),G=Object(a.memo)((({list:e,linkedList:t,onListLinkChange:n,dataTestSubj:i})=>{const o=Object(a.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(a.useCallback)((({target:{checked:a}})=>{const r=a?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof n&&n(r)}),[t,n,e]);return r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiSwitch,{"data-test-subj":i,onChange:s,checked:o,label:U(e.name),showLabel:!1}))}));G.displayName="LinkListSwitch";var H=n(354);const W=({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n})=>{const{error:i,isLoading:o,pagination:s,lists:c,listTableColumnsWithLinkSwitch:d,onTableChange:p,addToSelectedListDescription:m}=(({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n})=>{const[i,o]=Object(a.useState)([]),[s,l]=Object(a.useState)(!1),c=Object(a.useMemo)((()=>e?[]:t),[e,t]),[d,p]=Object(a.useState)([]),[m,f]=Object(a.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[g,b]=Object(a.useState)(void 0),y=Object(a.useCallback)((async()=>{try{return l(!0),Object(z.c)(c.length?c:[{namespace_type:"single"}])}catch(e){b($)}}),[c]),h=Object(a.useCallback)((async()=>{const e=await y();if(!e)return l(!1);const t=[];for(const n of Object.values(e))n.type===u.a.DETECTION&&t.push(n);o(t),l(!1)}),[y]);Object(a.useEffect)((()=>{h()}),[c,y,h]),Object(a.useEffect)((()=>{n(d.map((({referenced_rules:e,namespace_type:t,os_types:n,tags:a,...r})=>({...r,namespace_type:null!=t?t:"single",os_types:null!=n?n:[],tags:null!=a?a:[]}))))}),[d,n]);const v=Object(a.useMemo)((()=>[{field:"link",name:V.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>r.a.createElement(G,{dataTestSubj:"addToSharedListSwitch",list:t,linkedList:d,onListLinkChange:p})},...Object(H.d)()]),[d]),E=Object(a.useCallback)((({page:{index:e}})=>f({...m,pageIndex:e})),[m]);return{error:g,isLoading:s,pagination:m,lists:i,listTableColumnsWithLinkSwitch:v,addToSelectedListDescription:B,onTableChange:E}})({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n});return r.a.createElement(l.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiText,{size:"s"},m),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{sorting:!0,tableLayout:"auto",tableCaption:"Table of exception lists","data-test-subj":"addExceptionToSharedListsTable",error:i,items:c,loading:o,message:o?r.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,columns:d,pagination:s,onTableChange:p})))},Q=r.a.memo(W);Q.displayName="ExceptionsAddToListsTable";var Y=n(118);const K=({rulesCount:e,selectedRadioOption:t,sharedLists:n,onListsSelectionChange:i,onRadioChange:o})=>{const{navigateToApp:s}=Object(Y.j)().services.application,[c,u]=Object(a.useState)(!1);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiRadio,{id:"add_to_lists",label:r.a.createElement(l.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",responsive:!1,"data-test-subj":"addToListsRadioOptionLabel"},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiText,null,F)),r.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":"addToListsOption"},r.a.createElement(l.EuiPopover,{button:r.a.createElement(l.EuiButtonIcon,{iconType:"iInCircle",onClick:()=>u(!c),"aria-label":L}),isOpen:c,closePopover:()=>u(!1),anchorPosition:"upCenter"},r.a.createElement("div",{style:{width:"300px"}},r.a.createElement(l.EuiText,{size:"s"},0===n.length?q(e):R)),r.a.createElement(l.EuiPopoverFooter,null,r.a.createElement(l.EuiButtonEmpty,{size:"s",iconType:"popout",iconSide:"right",onClick:()=>s("security",{openInNewTab:!0,path:"/exceptions"})},P))))),checked:"add_to_lists"===t,disabled:0===n.length&&e>0,onChange:()=>o("add_to_lists"),"data-test-subj":"addToListsRadioOption"}),"add_to_lists"===t&&(n.length>0||0===e)&&r.a.createElement(Q,{showAllSharedLists:0===e,sharedExceptionLists:n,onListSelectionChange:i,"data-test-subj":"exceptionsAddToListTable"}))},Z=r.a.memo(K);Z.displayName="ExceptionsAddToListsOptions";const X=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-oec11w-0"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),J=({rules:e,isBulkAction:t,selectedRadioOption:n,onListSelectionChange:i,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(a.useMemo)((()=>null!=e&&1===e.length),[e]),d=Object(a.useMemo)((()=>{var t,n,a;if(null==e)return[];if(1===e.length)return null!==(t=null===(n=e[0].exceptions_list)||void 0===n?void 0:n.filter((e=>e.type===u.a.DETECTION)))&&void 0!==t?t:[];const r=null!==(a=null==e?void 0:e.map((e=>null!=e.exceptions_list?e.exceptions_list:[])))&&void 0!==a?a:[];r.sort(((e,t)=>e.length-t.length));const i=r.shift();return null!=i&&i.length?i.filter((e=>r.every((t=>t.some((({id:t})=>e.id===t)))))).filter((e=>e.type===u.a.DETECTION)):[]}),[e]),p=Object(a.useMemo)((()=>null!=e?e.length:0),[e]);return r.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemAddToRuleOrListSection"},r.a.createElement(X,{size:"xs"},r.a.createElement("h3",null,M)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(A,{possibleRules:e,isSingleRule:c,isBulkAction:t,selectedRadioOption:n,onRuleSelectionChange:o,onRadioChange:s}),r.a.createElement(Z,{rulesCount:p,selectedRadioOption:n,sharedLists:d,onListsSelectionChange:i,onRadioChange:s}))},ee=r.a.memo(J);ee.displayName="ExceptionsAddToRulesOrLists";var te=n(1447),ne=n(1328),ae=n(1556),re=n(123),ie=n(841),oe=n(159);var se=n(872);const le=["query","machine_learning","saved_query","threat_match"];var ce=n(588),ue=n(880),de=n(237),pe=n(487);const me=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-v0j9bz-0"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),fe=o()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-v0j9bz-1"})(["",""],(()=>Object(i.css)(["&.builder-section{overflow-y:scroll;}"]))),ge=o()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-v0j9bz-2"})(["",""],(({theme:e})=>Object(i.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),be=o()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-v0j9bz-3"})(["",""],(({theme:e})=>Object(i.css)(["padding:",";"],e.eui.euiSizeS))),ye=Object(a.memo)((function({rules:e,isBulkAction:t,isEndpointItem:n,alertData:i,showAlertCloseOptions:o,isAlertDataLoading:M,alertStatus:_,sharedListToAddTo:D,onCancel:N,onConfirm:A}){const{euiTheme:F}=Object(l.useEuiTheme)(),[P,R]=Object(a.useState)(!1),{isLoading:L,indexPatterns:q,getExtendedFields:z}=Object(T.a)(e),[B,$]=(()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(re.a)(),[r,i]=(()=>{const[e,t]=Object(a.useState)(!1),n=Object(a.useRef)(null);return Object(a.useEffect)((()=>{const e=new AbortController;return n.current=async(n,a)=>{try{t(!0);const r=await Promise.all(a.map((async t=>Object(oe.a)({items:n,ruleId:t.id,signal:e.signal}))));return t(!1),r.flatMap((e=>e))}catch(e){throw t(!1),e}},()=>{t(!1),e.abort()}}),[]),[e,n.current]})(),[o,s]=Object(ie.a)(),[l,c]=Object(a.useState)(!1),d=Object(a.useRef)(null),p=Object(a.useCallback)((e=>e.every((e=>te.a.is(e)))),[]),f=Object(a.useCallback)((e=>e.every((e=>ne.a.is(e)||ae.a.is(e)))),[]);return Object(a.useEffect)((()=>{const n=new AbortController;return d.current=async({itemsToAdd:n,listType:a,selectedRulesToAddTo:r,addToRules:o,addToSharedLists:l,sharedLists:d})=>{try{let t=[];if(c(!0),o&&null!=i&&a!==u.a.ENDPOINT&&p(n)){t=await i(n,r);const a=r.map((({name:e})=>e)).join(", ");e({title:x,text:(b=a,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessText",{values:{ruleName:b},defaultMessage:"Exception has been added to rules - {ruleName}."}))})}else if((a===u.a.ENDPOINT||l)&&null!=s&&f(n)){t=await s(n);const a=d.map((({name:e})=>e));e({title:E,text:(g=a.join(","),m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.closeAlerts.successDetails",{values:{listNames:g},defaultMessage:"Rule exception has been added to shared lists: {listNames}."}))})}return c(!1),t}catch(e){throw c(!1),t(e,{title:y}),e}var g,b},()=>{n.abort()}}),[e,t,n,i,s,p,f]),[l||o||r,d.current]})(),[V,U]=Object(se.a)(),G=Object(ce.b)(),W=Object(a.useMemo)((()=>null==e||1!==e.length||le.includes(e[0].type)),[e]),Q=Object(a.useMemo)((()=>t?"add_to_rules":1===(null==e?void 0:e.length)||void 0!==M?"add_to_rule":"select_rules_to_add_to"),[M,t,e]),Y=Object(a.useMemo)((()=>n?u.a.ENDPOINT:D?u.a.DETECTION:u.a.RULE_DEFAULT),[n,D]),[{exceptionItemMeta:{name:K},listType:Z,selectedOs:X,initialItems:J,exceptionItems:ye,disableBulkClose:he,bulkCloseAlerts:ve,closeSingleAlert:Ee,bulkCloseIndex:xe,addExceptionToRadioSelection:je,selectedRulesToAddTo:Oe,exceptionListsToAddTo:Se,newComment:we,commentErrorExists:ke,itemConditionValidationErrorExists:Ie,errorSubmitting:Te,expireTime:Ce,expireErrorExists:Me,wildcardWarningExists:_e},De]=Object(a.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:n}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[n[0]]:n[1]}}}case"setInitialExceptionItems":{const{items:n}=t;return{...e,initialItems:n}}case"setExceptionItems":{const{items:n}=t;return{...e,exceptionItems:n}}case"setConditionValidationErrorExists":{const{errorExists:n}=t;return{...e,itemConditionValidationErrorExists:n}}case"setWildcardWithWrongOperator":{const{warningExists:n}=t;return{...e,wildcardWarningExists:n}}case"setComment":{const{comment:n}=t;return{...e,newComment:n}}case"setCommentError":{const{errorExists:n}=t;return{...e,commentErrorExists:n}}case"setCloseSingleAlert":{const{close:n}=t;return{...e,closeSingleAlert:n}}case"setBulkCloseAlerts":{const{bulkClose:n}=t;return{...e,bulkCloseAlerts:n}}case"setBulkCloseIndex":{const{bulkCloseIndex:n}=t;return{...e,bulkCloseIndex:n}}case"setSelectedOsOptions":{const{selectedOs:n}=t;return{...e,selectedOs:n}}case"setAddExceptionToLists":{const{listsToAddTo:n}=t;return{...e,exceptionListsToAddTo:n}}case"setListOrRuleRadioOption":{const{option:n}=t;return{...e,addExceptionToRadioSelection:n,listType:"add_to_lists"===n?u.a.DETECTION:u.a.RULE_DEFAULT,selectedRulesToAddTo:"add_to_lists"===n?[]:e.selectedRulesToAddTo}}case"setSelectedRulesToAddTo":{const{rules:n}=t;return{...e,selectedRulesToAddTo:n}}case"setListType":{const{listType:n}=t;return{...e,listType:n}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:n}=t;return{...e,disableBulkClose:n}}case"setErrorSubmitting":{const{err:n}=t;return{...e,errorSubmitting:n}}case"setExpireTime":{const{expireTime:n}=t;return{...e,expireTime:n}}case"setExpireError":{const{errorExists:n}=t;return{...e,expireErrorExists:n}}default:return e}}),{...w,addExceptionToRadioSelection:Q,listType:Y,selectedRulesToAddTo:null!=e?e:[]}),Ne=Object(a.useMemo)((()=>null!=i),[i]),Ae=Object(a.useCallback)((e=>{De({type:"setInitialExceptionItems",items:e})}),[De]),Fe=Object(a.useCallback)((e=>{De({type:"setWildcardWithWrongOperator",warningExists:Object(d.g)(e)}),De({type:"setExceptionItems",items:e})}),[De]),Pe=Object(a.useCallback)((e=>{De({type:"setListOrRuleRadioOption",option:e})}),[De]),Re=Object(a.useCallback)((e=>{De({type:"setSelectedRulesToAddTo",rules:e})}),[De]),Le=Object(a.useCallback)((e=>{De({type:"setAddExceptionToLists",listsToAddTo:e})}),[De]),qe=Object(a.useCallback)((e=>{De({type:"setExceptionItemMeta",value:e})}),[De]),ze=Object(a.useCallback)((e=>{De({type:"setConditionValidationErrorExists",errorExists:e})}),[De]),Be=Object(a.useCallback)((e=>{De({type:"setSelectedOsOptions",selectedOs:e})}),[De]),$e=Object(a.useCallback)((e=>{De({type:"setComment",comment:e})}),[De]),Ve=Object(a.useCallback)((e=>{De({type:"setCommentError",errorExists:e})}),[De]),Ue=Object(a.useCallback)((e=>{De({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[De]),Ge=Object(a.useCallback)((e=>{De({type:"setCloseSingleAlert",close:e})}),[De]),He=Object(a.useCallback)((e=>{De({type:"setBulkCloseAlerts",bulkClose:e})}),[De]),We=Object(a.useCallback)((e=>{De({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[De]),Qe=Object(a.useCallback)((e=>{De({type:"setErrorSubmitting",err:e})}),[De]),Ye=Object(a.useCallback)((e=>{De({type:"setExpireTime",expireTime:e})}),[De]),Ke=Object(a.useCallback)((e=>{De({type:"setExpireError",errorExists:e})}),[De]);Object(a.useEffect)((()=>{if(i)switch(Z){case u.a.ENDPOINT:return Ae(Object(O.b)(c.k,K,i));case u.a.RULE_DEFAULT:{var t,n,a;const o=Object(O.k)({alertData:i,exceptionItemName:K,ruleCustomHighlightedFields:null!==(t=null==e||null===(n=e[0])||void 0===n||null===(a=n.investigation_fields)||void 0===a?void 0:a.field_names)&&void 0!==t?t:[]});if(o)return $e((r=i._id,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionFromAlertComment",{values:{alertId:r},defaultMessage:"Exception conditions are pre-filled with relevant data from an alert with the alert id (_id): {alertId}."}))),Ae([o])}}var r}),[Z,K,i,e,Ae,$e]);const Ze=Object(a.useMemo)((()=>Ne?Object(O.n)(i):X?[...X]:[]),[Ne,i,X]),Xe=Object(a.useCallback)((async()=>{if(null!=$)try{const t=["add_to_rule","add_to_rules","select_rules_to_add_to"].includes(je),n=!(null==D||!D.length)||"add_to_lists"===je&&!Object(s.isEmpty)(Se),a=null!=D&&D.length?D:Se,r=Object(H.b)({itemName:K,commentToAdd:we,addToRules:t,addToSharedLists:n,sharedLists:a,listType:Z,selectedOs:Ze,expireTime:Ce,items:ye}),o=await $({itemsToAdd:r,selectedRulesToAddTo:Oe,listType:Z,addToRules:t&&!Object(s.isEmpty)(Oe),addToSharedLists:n,sharedLists:a}),l=Ee&&i?i._id:void 0,c=t?Oe.map((({rule_id:e})=>e)):(null!=e?e:[]).map((({rule_id:e})=>e));null==U||Object(s.isEmpty)(c)||!ve&&!Ee||await U(c,o,l,xe),G(),A(!0,Ee,ve)}catch(e){Qe(e)}}),[D,$,je,K,we,Se,Z,Ze,ye,Oe,Ee,i,e,U,ve,A,xe,Qe,G,Ce]),Je=Object(a.useCallback)((()=>{if(!_e)return Xe();R(!0)}),[_e,Xe]),et=Object(a.useMemo)((()=>B||V||null!=Te||""===K.trim()||ye.every((e=>0===e.entries.length))||Ie||ke||Me||"add_to_lists"===je&&Object(s.isEmpty)(Se)||"select_rules_to_add_to"===je&&Object(s.isEmpty)(Oe)&&Z===u.a.RULE_DEFAULT),[B,V,Te,K,ye,Ie,je,Se,Me,Oe,Z,ke]),tt=Object(a.useCallback)((()=>{Qe(null)}),[Qe]),nt=Object(a.useCallback)((()=>{N(!1)}),[N]),at=Object(a.useMemo)((()=>Z===u.a.ENDPOINT?b:g),[Z]),rt=Object(l.useGeneratedHtmlId)({prefix:"exceptionFlyoutTitle"}),it=Object(a.useMemo)((()=>{const{title:e,body:t,confirmButton:n,cancelButton:a}=Object(de.a)(Z===u.a.ENDPOINT?S.c:S.j);return r.a.createElement(pe.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:Xe,onCancel:()=>R(!1),"data-test-subj":"artifactConfirmModal"})}),[Z,Xe]);return r.a.createElement(l.EuiFlyout,{size:"l",onClose:nt,"data-test-subj":"addExceptionFlyout","aria-labelledby":rt,maskProps:{style:`z-index: ${F.levels.flyout+3}`}},r.a.createElement(ge,null,r.a.createElement(l.EuiTitle,null,r.a.createElement("h2",{id:rt,"data-test-subj":"exceptionFlyoutTitle"},at)),r.a.createElement(l.EuiSpacer,{size:"m"})),r.a.createElement(fe,{className:"builder-section"},L&&r.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingAddExceptionFlyout",lines:4}),null!=Te&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiCallOut,{"data-test-subj":"addExceptionErrorCallOut",title:y,color:"danger",iconType:"warning"},r.a.createElement(l.EuiText,null,v),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionErrorDismissButton",color:"danger",onClick:tt},h)),r.a.createElement(l.EuiSpacer,{size:"s"})),r.a.createElement(k.a,{exceptionItemName:K,onChange:qe}),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(I.a,{exceptionItemName:K,allowLargeValueLists:W,exceptionListItems:J,exceptionListType:Z,indexPatterns:q,rules:e,selectedOs:X,showOsTypeOptions:Z===u.a.ENDPOINT&&!Ne,isEdit:!1,onOsChange:Be,onExceptionItemAdd:Fe,onSetErrorExists:ze,getExtendedFields:z}),_e&&r.a.createElement(p.a,null),Z!==u.a.ENDPOINT&&!(null!=D&&D.length)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(ee,{rules:e,isBulkAction:t,selectedRadioOption:je,onListSelectionChange:Le,onRuleSelectionChange:Re,onRadioChange:Pe})),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(j.a,{accordionTitle:r.a.createElement(me,{size:"xs"},r.a.createElement("h3",null,(ot=we?1:0,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.commentsTitle",{values:{comments:ot},defaultMessage:"Add comments ({comments})"})))),initialIsOpen:!!we,newCommentValue:we,newCommentOnChange:$e,setCommentError:Ve}),Z!==u.a.ENDPOINT&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(ue.a,{expireTime:Ce,setExpireTime:Ye,setExpireError:Ke})),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(C.a,{exceptionListType:Z,shouldCloseSingleAlert:Ee,shouldBulkCloseAlert:ve,disableBulkClose:he,exceptionListItems:ye,alertData:i,alertStatus:_,isAlertDataLoading:null!=M&&M,onDisableBulkClose:We,onUpdateBulkCloseIndex:Ue,onBulkCloseCheckboxChange:He,onSingleAlertCloseCheckboxChange:Ge}))),r.a.createElement(l.EuiFlyoutFooter,null,r.a.createElement(be,{justifyContent:"spaceBetween"},r.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:nt},f),r.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionConfirmButton",onClick:Je,isDisabled:et,fill:!0},at))),P&&it);var ot}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return Oe}));var a=n(19),r=n(2),i=n.n(r),o=n(1107),s=n(122),l=n(152),c=n(47),u=n(204),d=n(1532),p=n(1307);const m=Object(d.a)(u.o),f="FIND_LIST_ITEMS",g=()=>{const e=Object(c.useQueryClient)();return Object(r.useCallback)((()=>{e.invalidateQueries([f],{refetchType:"active"})}),[e])},b=Object(d.a)(u.s);var y=n(49),h=n(151),v=n(118),E=n(1308);const x=Object(d.a)(u.c),j=["POST","LIST_ITEM_CREATE"];var O=n(123),S=n(242),w=n(4);const k=w.i18n.translate("xpack.securitySolution.listItems.addListItem",{defaultMessage:"Create list item"}),I=w.i18n.translate("xpack.securitySolution.listItems.successfullyAddedItem",{defaultMessage:"Successfully added list item"}),T=w.i18n.translate("xpack.securitySolution.listItems.valueRequired",{defaultMessage:"Value is required"}),C=w.i18n.translate("xpack.securitySolution.listItems.valueLabel",{defaultMessage:"Enter a new value for the list"}),M=w.i18n.translate("xpack.securitySolution.listItems.addListItemButton",{defaultMessage:"Add list item"}),_=w.i18n.translate("xpack.securitySolution.listItems.addingListItemButton",{defaultMessage:"Adding..."}),D=w.i18n.translate("xpack.securitySolution.listItems.successfullyDeletedItem",{defaultMessage:"Successfully deleted list item"}),N=w.i18n.translate("xpack.securitySolution.listItems.editTextInlineLabel",{defaultMessage:"Edit text inline"}),A=w.i18n.translate("xpack.securitySolution.listItems.successfullyUpdatedListItem",{defaultMessage:"Successfully updated list item"}),F=w.i18n.translate("xpack.securitySolution.listItems.columnValue",{defaultMessage:"Value"}),P=w.i18n.translate("xpack.securitySolution.listItems.columnUpdatedAt",{defaultMessage:"Updated at"}),R=w.i18n.translate("xpack.securitySolution.listItems.columnUpdatedBy",{defaultMessage:"Updated by"}),L=w.i18n.translate("xpack.securitySolution.listItems.columnActions",{defaultMessage:"Action"}),q=w.i18n.translate("xpack.securitySolution.listItems.failedToFetchListItem",{defaultMessage:"Failed to load list items. You can change the search query or contact your administrator"}),z=w.i18n.translate("xpack.securitySolution.listItems.deleteListItem",{defaultMessage:"Delete"}),B=w.i18n.translate("xpack.securitySolution.listItems.deleteListItemDescription",{defaultMessage:"Delete list item"}),$=w.i18n.translate("xpack.securitySolution.listItems.successfullyUploadListItems",{defaultMessage:"Successfully uploaded list items"}),V=w.i18n.translate("xpack.securitySolution.listItems.failedToUploadListItem",{defaultMessage:"Failed to upload list items"}),U=w.i18n.translate("xpack.securitySolution.listItems.failedToUploadListItemTitle",{defaultMessage:"Error"}),G=w.i18n.translate("xpack.securitySolution.listItems.uploadTooltip",{defaultMessage:"All items from the file will be added to the value list."}),H=w.i18n.translate("xpack.securitySolution.listItems.uploadFilePickerInitialPromptText",{defaultMessage:"Select or drag and drop a file"}),W=w.i18n.translate("xpack.securitySolution.listItems.uploadListItem",{defaultMessage:"Upload"}),Q=w.i18n.translate("xpack.securitySolution.listItems.infoType",{defaultMessage:"Type:"}),Y=w.i18n.translate("xpack.securitySolution.listItems.infoUpdatedAt",{defaultMessage:"Updated at:"}),K=w.i18n.translate("xpack.securitySolution.listItems.infoUpdatedBy",{defaultMessage:"Updated by:"}),Z=w.i18n.translate("xpack.securitySolution.listItems.infoTotalItems",{defaultMessage:"Total items:"}),X=w.i18n.translate("xpack.securitySolution.listItems.notFoundItems",{defaultMessage:"0 list items match your search criteria."});var J=n(17);const ee=({listId:e})=>{const[t,n]=Object(r.useState)(!1),{addSuccess:o,addError:s}=Object(O.a)(),l=Object(S.c)().services.http,u=(e=>{const t=g();return Object(c.useMutation)((({listId:e,value:t,http:n})=>x({listId:e,value:t,http:n,refresh:"true"})),{...e,mutationKey:j,onSettled:(...n)=>{t(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onSuccess:()=>{o(I)},onError:e=>{var t,n;s(e,{title:e.message,toastMessage:null!==(t=null==e||null===(n=e.body)||void 0===n?void 0:n.message)&&void 0!==t?t:e.message})}}),d=Object(E.useFormik)({initialValues:{value:""},validate:e=>{if(""===e.value.trim())return{value:T}},onSubmit:async t=>{Object(J.h)(J.a.COUNT,J.c.CREATE_VALUE_LIST_ITEM),await u.mutateAsync({listId:e,value:t.value,http:l}),n(!1),d.resetForm()}});return i.a.createElement(a.EuiPopover,{initialFocus:"#value-list-item-value",button:i.a.createElement(a.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"value-list-item-add-button-show-popover",onClick:()=>n(!0)},k),isOpen:t,closePopover:()=>n(!1)},i.a.createElement("div",{style:{width:500}},i.a.createElement(a.EuiForm,{onSubmit:d.handleSubmit,component:"form"},i.a.createElement(a.EuiFlexGroup,null,i.a.createElement(a.EuiFlexItem,null,i.a.createElement(a.EuiFormRow,{label:C,id:"value-list-item-value",isInvalid:!!d.errors.value,error:[d.errors.value]},i.a.createElement(a.EuiFieldText,{autoComplete:"off",onChange:d.handleChange,value:d.values.value,name:"value",icon:"listAdd","data-test-subj":"value-list-item-add-input",isInvalid:!!d.errors.value}))),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiFormRow,{hasEmptyLabelSpace:!0},i.a.createElement(a.EuiButton,{"data-test-subj":"value-list-item-add-button-submit",isLoading:u.isLoading,type:"submit"},u.isLoading?_:M)))))))};var te=n(1557);const ne=["text/csv","text/plain"],ae={toastLifeTimeMs:5e3},re=l.css`
  min-width: 300px;
`,ie=({listId:e,type:t})=>{const[n,o]=Object(r.useState)(null),{http:s}=Object(v.j)().services,l=Object(r.useRef)(new AbortController),{start:c,...u}=Object(te.a)(),d=g(),{addSuccess:p,addError:m}=Object(O.a)(),f=Object(r.useCallback)((e=>{var t;o(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),b=Object(r.useCallback)((()=>{!u.loading&&n&&(l.current=new AbortController,Object(J.h)(J.a.COUNT,J.c.ADDITIONAL_UPLOAD_VALUE_LIST_ITEM),c({file:n,listId:e,http:s,signal:l.current.signal,type:t,refresh:"true"}))}),[u.loading,n,c,s,t,e]),y=!n||ne.some((e=>n.type===e));Object(r.useEffect)((()=>{!u.loading&&u.result?p($,ae):!u.loading&&u.error&&m(V,{title:U,...ae}),d()}),[u.error,u.loading,u.result,p,m,d]);const h=null==n||!y||u.loading;return i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiToolTip,{position:"bottom",content:G},i.a.createElement(a.EuiFilePicker,{className:re,accept:ne.join(),id:"value-list-item-upload",initialPromptText:H,onChange:f,display:"default",isLoading:u.loading,isInvalid:!y,"data-test-subj":"value-list-items-file-picker"})),i.a.createElement(a.EuiButton,{onClick:b,disabled:h,"data-test-subj":"value-list-items-upload"},W))},oe=Object(d.a)(u.u),se=["PATCH","LIST_ITEM_MUTATION"],le={toastLifeTimeMs:5e3},ce=({listItem:e})=>{const[t,n]=Object(r.useState)(e.value),{addSuccess:o,addError:s}=Object(O.a)(),l=Object(S.c)().services.http,u=(e=>{const t=g();return Object(c.useMutation)((({id:e,value:t,_version:n,http:a})=>oe({id:e,value:t,http:a,refresh:"true",_version:n})),{...e,mutationKey:se,onSettled:(...n)=>{t(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onSuccess:()=>{o(A,le)},onError:e=>{var t,n;s(e,{title:e.message,toastMessage:null!==(t=null==e||null===(n=e.body)||void 0===n?void 0:n.message)&&void 0!==t?t:e.message})}}),d=Object(r.useCallback)((e=>{n(e.target.value)}),[]),p=Object(r.useCallback)((()=>{n(e.value)}),[e]),m=Object(r.useCallback)((async t=>(Object(J.h)(J.a.COUNT,J.c.EDIT_VALUE_LIST_ITEM),await u.mutateAsync({id:e.id,value:t,_version:e._version,http:l}),!0)),[e._version,e.id,u,l]);return i.a.createElement(a.EuiInlineEditText,{"data-test-subj":`value-list-item-update-${e.value}`,size:"s",inputAriaLabel:N,value:t,onChange:d,onSave:m,onCancel:p,isLoading:u.isLoading})},ue=Object(d.a)(u.g),de=["POST"," DELETE_LIST_ITEM_MUTATION"],pe={toastLifeTimeMs:5e3},me=({id:e,value:t})=>{const{addSuccess:n,addError:o}=Object(O.a)(),s=Object(v.j)().services.http,l=(e=>{const t=g();return Object(c.useMutation)((({id:e,http:t})=>ue({id:e,http:t,refresh:"true"})),{...e,mutationKey:de,onSettled:(...n)=>{t(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onSuccess:()=>{n(D,pe)},onError:e=>{var t,n;o(e,{title:e.message,toastMessage:null!==(t=null==e||null===(n=e.body)||void 0===n?void 0:n.message)&&void 0!==t?t:e.message})}}),u=Object(r.useCallback)((()=>{Object(J.h)(J.a.COUNT,J.c.DELETE_VALUE_LIST_ITEM),l.mutate({id:e,http:s})}),[l,e,s]);return i.a.createElement(a.EuiButtonIcon,{color:"danger",onClick:u,iconType:"trash",isLoading:l.isLoading,"data-test-subj":`delete-list-item-${t}`})};let fe=function(e){return e.value="value",e.updatedAt="updated_at",e.updatedBy="updated_by",e}({});const ge=({canWriteIndex:e,items:t,pagination:n,sorting:r,loading:o,onChange:s,isError:l,list:c})=>{const u=[{field:fe.value,name:F,render:(t,n)=>e?i.a.createElement(ce,{listItem:n,key:t}):t,sortable:"text"!==c.type},{field:fe.updatedAt,name:P,render:e=>i.a.createElement(h.a,{value:e,fieldName:fe.updatedAt}),width:"25%",sortable:!0},{field:fe.updatedBy,name:R,width:"15%"}];return e&&u.push({name:L,actions:[{name:z,description:B,isPrimary:!0,render:e=>i.a.createElement(me,{id:e.id,value:e.value})}],width:"10%"}),i.a.createElement(a.EuiBasicTable,{"data-test-subj":"value-list-items-modal-table",items:t,columns:u,pagination:n,sorting:r,error:l?q:void 0,loading:o,onChange:s,noItemsMessage:X})},be=l.css`
  margin-right: ${y.euiThemeVars.euiSizeS};
`,ye=l.css`
  margin-right: ${y.euiThemeVars.euiSizeXS};
`,he=({label:e,value:t})=>i.a.createElement(a.EuiText,{size:"xs",className:be},i.a.createElement("b",{className:ye},e," ")," ",t),ve=l.css`
  overflow: hidden;
  padding: ${y.euiThemeVars.euiSize};
`,Ee=l.css`
  min-height: 90vh;
  margin-top: 5vh;
  max-width: 1400px;
  min-width: 700px;
`,xe=l.css`
  overflow: scroll;
`,je=({listId:e,onCloseModal:t,canWriteIndex:n})=>{var o,s,l,u;const[d,g]=Object(r.useState)(""),y=Object(v.j)().services.http,[E,x]=Object(r.useState)(0),[j,O]=Object(r.useState)(10),[S,k]=Object(r.useState)("updated_at"),[I,T]=Object(r.useState)("desc"),{data:C,isLoading:M,isError:_}=(({pageIndex:e,pageSize:t,sortField:n,sortOrder:a,listId:r,filter:i,http:o})=>{const[s,l]=Object(p.a)({pageIndex:e,pageSize:t});return Object(c.useQuery)([f,e,t,n,a,r,i],(async({signal:l})=>await m({http:o,signal:l,pageIndex:e,pageSize:t,sortField:n,sortOrder:a,listId:r,cursor:s,filter:i})),{keepPreviousData:!0,refetchOnWindowFocus:!1,retry:!1,onSuccess:e=>{null!=e&&e.cursor&&l(null==e?void 0:e.cursor)}})})({listId:e,pageIndex:E+1,pageSize:j,sortField:S,sortOrder:I,filter:d,http:y}),{data:D,isLoading:N}=(({http:e,id:t})=>Object(c.useQuery)(["GET_LIST_BY_ID",t],(async({signal:n})=>await b({http:e,signal:n,id:t})),{refetchOnWindowFocus:!1}))({http:y,id:e}),A={sort:{field:S,direction:I},enableAllColumns:!1},F={pageIndex:E,pageSize:j,totalItemCount:null!==(o=null==C?void 0:C.total)&&void 0!==o?o:0,pageSizeOptions:[5,10,25]},P=Object(r.useCallback)((e=>{g(e.queryText)}),[]),R=!N&&!!D;return i.a.createElement(a.EuiModal,{maxWidth:!1,className:Ee,onClose:t},i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiModalHeader,null,R&&i.a.createElement(a.EuiFlexGroup,{justifyContent:"spaceBetween",wrap:!0},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiModalHeaderTitle,{"data-test-subj":"value-list-items-modal-title"},D.id),i.a.createElement(a.EuiSpacer,{size:"s"}),D.description&&i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiText,{size:"s"},D.description),i.a.createElement(a.EuiSpacer,{size:"xs"})),i.a.createElement(a.EuiFlexGroup,{"data-test-subj":"value-list-items-modal-info",justifyContent:"flexStart"},i.a.createElement(he,{label:Q,value:D.type}),i.a.createElement(he,{label:Y,value:i.a.createElement(h.a,{value:D.updated_at,fieldName:"updated_at"})}),i.a.createElement(he,{label:K,value:D.updated_by}),C&&i.a.createElement(he,{label:Z,value:null!==(s=null==C?void 0:C.total)&&void 0!==s?s:"-"}))),i.a.createElement(a.EuiFlexItem,{grow:!0},n&&i.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart",justifyContent:"flexEnd"},i.a.createElement(ee,{listId:e}),i.a.createElement(ie,{listId:e,type:D.type}))))),i.a.createElement(a.EuiFlexGroup,{className:ve,direction:"column"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiSearchBar,{onChange:P,"data-test-subj":"value-list-items-modal-search-bar",box:{"data-test-subj":"value-list-items-modal-search-bar-input",placeholder:(L=null!==(l=null==D?void 0:D.type)&&void 0!==l?l:"",w.i18n.translate("xpack.securitySolution.listItems.searchBar",{defaultMessage:"Filter your data using KQL syntax, for example: {listType}:*",values:{listType:L}}))}})),i.a.createElement(a.EuiFlexItem,{grow:!0,className:xe},R?i.a.createElement(ge,{items:null!==(u=null==C?void 0:C.data)&&void 0!==u?u:[],pagination:F,sorting:A,loading:M,onChange:({page:e,sort:t})=>{e&&(x(e.index),O(e.size)),t&&(k(t.field),T(t.direction))},isError:_,canWriteIndex:n,list:D}):i.a.createElement(a.EuiLoadingSpinner,{size:"xxl"})))));var L},Oe=({listId:e,children:t,shouldShowContentIfModalNotAvailable:n})=>{const[l,c]=Object(r.useState)(!1),{canWriteIndex:u,canReadIndex:d,loading:p}=Object(o.a)(),m=Object(s.a)("valueListItemsModalEnabled"),f=Object(r.useCallback)((()=>c(!1)),[]),g=Object(r.useCallback)((()=>{Object(J.h)(J.a.CLICK,J.c.OPEN_VALUE_LIST_MODAL),c(!0)}),[]);return p?null:d&&m?i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiLink,{"data-test-subj":`show-value-list-modal-${e}`,onClick:g},t),l&&i.a.createElement(je,{canWriteIndex:null!=u&&u,onCloseModal:f,listId:e})):n?i.a.createElement(i.a.Fragment,null,t):null}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return T}));var a=n(2),r=n(44),i=n(813),o=n(748);let s=function(e){return e.MALICIOUS_FILE="malicious_file",e.RANSOMWARE="ransomware",e.MEMORY_SIGNATURE="memory_signature",e.SHELLCODE_THREAD="shellcode_thread",e.BEHAVIOR="behavior",e}({}),l=function(e){return e.PROCESS="process",e.FILE="file",e.NETWORK="network",e.REGISTRY="registry",e.MALWARE="malware",e}({});var c=n(174),u=n(503),d=n(332),p=n(197),m=n(172),f=n(572),g=n(229),b=n(284);const y=`${f.j}.terms.field`,h=`${f.j}.terms.value`,v=`${f.j}.cardinality.field`,E=`${f.j}.cardinality.value`,x=`${f.j}.count`,j=[{id:"host.name"},{id:"agent.id",overrideField:g.a,label:p.b},{id:c.b.sentinel_one,overrideField:g.a,label:p.b},{id:c.b.crowdstrike,overrideField:g.a,label:p.b},{id:"user.name"},{id:"rule.name"},{id:"cloud.provider"},{id:"cloud.region"},{id:"cloud.provider"},{id:"cloud.region"},{id:"orchestrator.cluster.id"},{id:"orchestrator.cluster.name"},{id:"container.image.name"},{id:"container.image.tag"},{id:"orchestrator.namespace"},{id:"orchestrator.resource.parent.type"},{id:"orchestrator.resource.type"},{id:"process.executable"},{id:"file.path"},{id:i.o,label:p.z}];function O({primaryEventCategory:e,allEventCategories:t}){switch(e){case l.PROCESS:return[{id:"process.name"},{id:"process.parent.name"},{id:"process.args"}];case l.FILE:return[{id:"file.name"},{id:"file.hash.sha256"},{id:"file.directory"},{id:"process.name"}];case l.NETWORK:return[{id:"destination.address"},{id:"destination.port"},{id:"source.address"},{id:"source.port"},{id:"dns.question.name"},{id:"process.name"}];case l.REGISTRY:return[{id:"registry.key"},{id:"registry.value"},{id:"process.name"}];case l.MALWARE:return O({primaryEventCategory:l.FILE,allEventCategories:t});default:let e=[];return null!=t&&t.includes(l.FILE)&&(e=e.concat(O({primaryEventCategory:l.FILE}))),null!=t&&t.includes(l.PROCESS)&&(e=e.concat(O({primaryEventCategory:l.PROCESS}))),e}}function S(e,t){switch(e){case s.BEHAVIOR:return[{id:"rule.description",label:m.u},...O({...t,primaryEventCategory:void 0})];case s.SHELLCODE_THREAD:return[{id:"Target.process.executable"},{id:"Memory_protection.unique_key_v1"}];case s.RANSOMWARE:return[{id:"Ransomware.feature"},{id:"process.hash.sha256"},...O({...t,primaryEventCategory:void 0})];case s.MEMORY_SIGNATURE:return O({...t,primaryEventCategory:void 0});case s.MALICIOUS_FILE:return[{id:"file.Ext.quarantine_path",overrideField:g.j,label:p.x}];default:return[]}}function w(e){switch(e){case"threshold":return[{id:x,label:m.y},{id:y,overrideField:h,label:m.z},{id:v,label:m.x}];case"machine_learning":return[{id:`${o.t}.machine_learning_job_id`,legacyId:"signal.rule.machine_learning_job_id"},{id:`${o.t}.anomaly_threshold`,legacyId:"signal.rule.anomaly_threshold"}];case"threat_match":return[{id:`${o.t}.threat_index`,legacyId:"signal.rule.threat_index"},{id:`${o.t}.threat_query`,legacyId:"signal.rule.threat_query"}];case"new_terms":return[{id:f.e,label:m.q},{id:f.d,label:m.p}];default:return[]}}function k({eventCategories:e,eventCode:t,eventRuleType:n,highlightedFieldsOverride:a}){const i=[...(o=a,o.map((e=>({id:e})))),...j,...O(e),...S(t,e),...w(n)];var o;return Object(r.uniqBy)("id",i)}function I(e){const t=Object(r.find)({category:"event",field:"event.category"},e);let n,a;return Array.isArray(null==t?void 0:t.originalValue)?(n=null==t?void 0:t.originalValue[0],a=null==t?void 0:t.originalValue):(n=null==t?void 0:t.originalValue,n&&(a=[n])),{primaryEventCategory:n,allEventCategories:a}}const T=({data:e,browserFields:t,scopeId:n,eventId:o,isDraggable:s=!1,isReadOnly:l=!1,investigationFields:c})=>{const p=Object(d.a)(e);return Object(a.useMemo)((()=>{var a,d;const f=I(e),g=Object(r.find)({category:"event",field:"event.code"},e),x=Array.isArray(null==g?void 0:g.originalValue)?null==g||null===(a=g.originalValue)||void 0===a?void 0:a[0]:null==g?void 0:g.originalValue,O=Object(r.find)({category:"kibana",field:i.o},e),S=k({eventCategories:f,eventCode:x,eventRuleType:Array.isArray(null==O?void 0:O.originalValue)?null==O||null===(d=O.originalValue)||void 0===d?void 0:d[0]:null==O?void 0:O.originalValue,highlightedFieldsOverride:null!=c?c:[]});return null!=e?S.reduce(((a,i)=>{var c;const d=e.find((e=>e.field===i.id||i.legacyId&&e.field===i.legacyId));if(!d||Object(r.isEmpty)(d.values))return a;d.field===i.legacyId&&(i.id=i.legacyId);const f=null!=i.linkField&&e.find((e=>e.field===i.linkField)),g={...Object(b.b)({item:d,linkValueField:f||void 0,contextId:n,scopeId:n,browserFields:t,eventId:o,field:i}),isDraggable:s,isReadOnly:l};if(Object(u.b)(i.id)&&p.isSupported&&p.details.agentIdField!==i.id)return a;if(i.id===y){const t=function({values:e},t,n){const a=t.find((e=>e.field===h)),r=a&&a.values;if(Array.isArray(e)&&e.length>0&&Array.isArray(r)&&e.length===r.length)return e.map(((e,t)=>({title:e,description:{...n,values:[r[t]]}}))).filter((e=>!j.map((e=>e.id)).includes(e.title)))}(d,e,g);return t?[...a,...t]:a}if(i.id===v){const t=function({values:e},t,n){const a=t.find((e=>e.field===E)),r=a&&a.values;if(Array.isArray(e)&&1===e.length&&Array.isArray(r)&&e.length===r.length)return{title:m.x,description:{...n,values:[`count(${e[0]}) >= ${r[0]}`]}}}(d,e,g);return t?[...a,t]:a}return[...a,{title:null!==(c=i.label)&&void 0!==c?c:i.id,description:g}]}),[]):[]}),[e,c,n,t,o,s,l,p.details.agentIdField,p.isSupported])}},,,,function(e,t,n){},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),r=n(45),i=n(44),o=n(121),s=n(634),l=n(138),c=n(166),u=n(127),d=n(887),p=n(249),m=n(13),f=n(396);const g=()=>{const e=Object(r.useDispatch)();return Object(a.useCallback)((({duplicate:t,id:n,forceNotes:a=!1,from:r,notes:g,resolveTimelineConfig:b,timeline:y,to:h,ruleNote:v,ruleAuthor:E,preventSettingQuery:x})=>{let j=y;var O;if(t&&(j={...y,updated:void 0,changed:void 0,version:null}),Object(i.isEmpty)(j.indexNames)||e(c.a.setSelectedDataView({id:u.SourcererScopeName.timeline,selectedDataViewId:j.dataViewId,selectedPatterns:j.indexNames})),j.status===o.l.immutable&&j.timelineType===o.m.template?e(Object(p.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:f.a.toISOString(),to:f.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:r,to:h})),e(Object(m.addTimeline)({id:n,timeline:j,resolveTimelineConfig:b,savedTimeline:t})),x||null==j.kqlQuery||null==j.kqlQuery.filterQuery||null==j.kqlQuery.filterQuery.kuery||""===j.kqlQuery.filterQuery.kuery.expression||e(Object(m.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(O=j.kqlQuery.filterQuery.kuery.kind)&&void 0!==O?O:"kuery",expression:j.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:j.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=v&&!Object(i.isEmpty)(v)){const t=Object(s.a)({newNote:v,user:E||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(m.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=g?g.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154).isClient?window:null,i=function(e){return!!e.addEventListener},o=function(e){return!!e.on};t.default=function(e,t,n,s){void 0===n&&(n=r),a.useEffect((function(){if(t&&n)return i(n)?n.addEventListener(e,t,s):o(n)&&n.on(e,t,s),function(){i(n)?n.removeEventListener(e,t,s):o(n)&&n.off(e,t,s)}}),[e,t,n,JSON.stringify(s)])}},function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),r=n.test(t);return a&&r&&(e=+e,t=+t),e===t?0:a&&!r?-1:r&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(207);const r=(e,t)=>`/name/${e}${Object(a.a)(t)}`,i=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,o=(e,t)=>`/${e}${Object(a.a)(t)}`},,,function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"m",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return b}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),i=a.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Let’s set up your detection engine"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),d=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),b=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:e},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."})},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var a=n(19),r=n(2),i=n.n(r),o=n(4);const s=o.i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),l=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:n,showShortcut:r})=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&i.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},i.a.createElement("p",null,e)),r&&i.a.createElement(a.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},i.a.createElement("span",null,s)," ",i.a.createElement(a.EuiBadge,{color:"hollow"},n))),c=i.a.memo(l);c.displayName="TooltipWithKeyboardShortcut";const u=({interval:e})=>{const t=Object(r.useMemo)((()=>{if(e){const n=parseInt(e.slice(0,-1),10),a=e.charAt(e.length-1);if(Number.isFinite(n))switch(a){case"s":return t=n,o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.seconds",{defaultMessage:"{value} {value, plural, one { second } other { seconds }}",values:{value:t}});case"m":return(e=>o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.minutes",{defaultMessage:"{value} {value, plural, one { minute } other { minutes }}",values:{value:e}}))(n);case"h":return(e=>o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.hours",{defaultMessage:"{value} {value, plural, one { hour } other { hours }}",values:{value:e}}))(n)}}var t}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{"data-test-subj":"interval-abbr-value","aria-hidden":Boolean(t)},e),t&&i.a.createElement(a.EuiScreenReaderOnly,null,i.a.createElement("p",null,t)))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(45),l=n(41),c=n.n(l),u=n(760),d=n(124),p=n(183),m=n(761),f=n(138),g=n(118),b=n(148),y=n(200),h=n(42),v=n(80),E=n(19),x=n(249),j=n(658),O=n(625),S=n(474),w=n(127),k=n(916),I=n(282),T=n(417),C=n(447);const M=["ACTION_CUSTOMIZE_PANEL"],_=c.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),D=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraActions:n,extraOptions:a,getLensAttributes:r,height:l,id:c,inputsModelId:u=f.a.global,inspectTitle:d,lensAttributes:p,onLoad:m,scopeId:b=w.SourcererScopeName.default,enableLegendActions:y=!0,stackByField:D,timerange:A,width:F,withActions:P=O.a,disableOnClickFilter:R=!1,casesAttachmentMetadata:L})=>{var q,z,B;const $=Object(i.useMemo)((()=>({height:null!=l?l:"100%",minWidth:"100px",width:null!=F?F:"100%"})),[l,F]),{lens:V,data:{actions:{createFiltersFromValueClickAction:U}}}=Object(g.j)().services,G=Object(s.useDispatch)(),{searchSessionId:H}=Object(T.a)({visualizationId:c}),W=Object(j.a)({applyGlobalQueriesAndFilters:e,applyPageAndTabsFilters:t,extraOptions:a,getLensAttributes:r,lensAttributes:p,scopeId:b,stackByField:D,title:""}),Q=null==W||null===(q=W.state)||void 0===q||null===(z=q.visualization)||void 0===z?void 0:z.preferredSeriesType,Y="lnsLegacyMetric"!==(null==W?void 0:W.visualizationType)&&"lnsPie"!==(null==W?void 0:W.visualizationType),K=V.EmbeddableComponent,Z=Object(i.useMemo)((()=>y?void 0:{settings:{legendAction:"ignore",onBrushEnd:"ignore"}}),[y]),{setInspectData:X}=(J=m,{setInspectData:Object(i.useCallback)(((e,t)=>{var n;if(!t)return;const a=Object(I.f)(null==t||null===(n=t.requests)||void 0===n?void 0:n.getRequests());null==J||J({requests:a.requests,responses:a.responses,isLoading:e})}),[J])});var J;const{responses:ee,loading:te}=Object(T.a)({visualizationId:c}),{additionalRequests:ne,additionalResponses:ae,handleClick:re,handleCloseModal:ie,isButtonDisabled:oe,isShowingModal:se,request:le,response:ce}=Object(C.a)({inputId:u,isDisabled:te,multiple:null!=ee&&ee.length>1,queryId:c}),ue=Object(i.useMemo)((()=>({handleInspectClick:re,isInspectButtonDisabled:oe})),[re,oe]),de=Object(O.d)({attributes:W,extraActions:n,inspectActionProps:ue,timeRange:A,withActions:P,lensMetadata:L}),pe=Object(i.useCallback)((({range:e})=>{const[t,n]=e;G(Object(x.setAbsoluteRangeDatePicker)({id:u,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[G,u]),me=Object(i.useCallback)((e=>{if(!R)return async e=>{if(!N(e)||"area"!==Q)return void e.preventDefault();const[{query:t}]=await U({data:e.data,negate:e.negate}),n=null==t?void 0:t.range["@timestamp"];null!=n&&n.gte&&null!=n&&n.lt&&pe({range:[n.gte,n.lt]})};e.preventDefault()}),[U,pe,Q,R]),fe=Object(i.useMemo)((()=>{var e,t;return null!=(null==W||null===(e=W.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==W||null===(t=W.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==W||null===(B=W.state)||void 0===B?void 0:B.adHocDataViews]);return H?!W||null!=ee&&0===ee.length?o.a.createElement(E.EuiFlexGroup,null,o.a.createElement(E.EuiFlexItem,{grow:1},o.a.createElement(E.EuiEmptyPrompt,{body:o.a.createElement(E.EuiText,{size:"xs"},o.a.createElement(h.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),o.a.createElement(E.EuiFlexItem,{grow:!1},o.a.createElement(k.a,{extraActions:n,getLensAttributes:r,inputId:u,isInspectButtonDisabled:!0,lensAttributes:W,queryId:c,stackByField:D,timerange:A,title:d,withActions:P,casesAttachmentMetadata:L}))):o.a.createElement(o.a.Fragment,null,W&&H&&o.a.createElement(_,{$height:l,width:F,$addHoverActionsPadding:Y},o.a.createElement(K,{attributes:W,disabledActions:M,extraActions:de,id:c,onBrushEnd:pe,onFilter:me,onLoad:X,overrides:Z,searchSessionId:H,showInspector:!1,style:$,syncCursor:!1,syncTooltips:!1,timeRange:A,viewMode:v.ViewMode.VIEW,withDefaultActions:!1})),se&&null!=le&&null!=ce&&o.a.createElement(S.a,{adHocDataViews:fe,additionalRequests:ne,additionalResponses:ae,closeModal:ie,"data-test-subj":"inspect-modal",inputId:u,request:le,response:ce,title:d})):null},N=e=>Array.isArray(e.data)&&"column"in e.data[0],A=o.a.memo(D);var F=n(132);const P=e=>{var t,n;const a=Object(s.useDispatch)(),{inputId:c=f.a.global,id:h,isDonut:v,label:E,donutTextWrapperClassName:x,onLoad:j,...O}=e,{session:S,refetchByRestartingSession:w,refetchByDeletingSession:k}=(({inputId:e,queryId:t})=>{const n=Object(s.useDispatch)(),{data:a}=Object(g.j)().services,r=Object(i.useRef)(a.search.session),o=Object(i.useMemo)((()=>b.d.globalQueryByIdSelector()),[]),l=Object(i.useMemo)((()=>b.d.timelineQueryByIdSelector()),[]),{selectedInspectIndex:c}=Object(d.a)((n=>e===f.a.global?o(n,t):l(n,t))),u=Object(i.useCallback)((()=>{const e=r.current.start();n(y.c.setInspectionParameter({id:t,selectedInspectIndex:c,isInspected:!1,inputId:f.a.global,searchSessionId:e}))}),[n,t,c]),p=Object(i.useCallback)((()=>{n(y.c.deleteOneQuery({inputId:f.a.global,id:t}))}),[n,t]);return{session:r,refetchByRestartingSession:u,refetchByDeletingSession:p}})({inputId:c,queryId:h}),{indicesExist:I}=Object(F.a)(O.scopeId),C=Object(i.useRef)(O.timerange),M=Object(i.useMemo)((()=>p.d.globalQueryByIdSelector()),[]),{searchSessionId:_}=Object(d.a)((e=>M(e,h))),{responses:D}=Object(T.a)({visualizationId:h}),N=null!=D&&0!==(null===(t=D[0])||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.total),P=N?Object(l.css)(["top:40%;right:12%;"]):Object(l.css)(["top:66%;right:12%;"]),R=Object(i.useCallback)((({requests:e,responses:t,isLoading:n})=>{a(p.b.setQuery({inputId:c,id:h,searchSessionId:S.current.start(),refetch:w,loading:n,inspect:{dsl:e,response:t}})),"function"==typeof j&&j({requests:e,responses:t,isLoading:n})}),[a,c,h,S,w,j]);return Object(i.useEffect)((()=>{var e,t;(!I&&(null===(e=C.current)||void 0===e?void 0:e.from)!==O.timerange.from||(null===(t=C.current)||void 0===t?void 0:t.to)!==O.timerange.to)&&(C.current=O.timerange,a(p.b.deleteOneQuery({inputId:c,id:h})))}),[a,h,I,c,O.timerange]),Object(i.useEffect)((()=>{_||setTimeout((()=>{a(p.b.setQuery({inputId:c,id:h,searchSessionId:S.current.start(),refetch:N?w:k,loading:!1,inspect:null}))}),200)}),[a,c,h,S,N,w,_,k]),Object(i.useEffect)((()=>()=>{a(p.b.deleteOneQuery({inputId:c,id:h}))}),[a,h,c]),(O.getLensAttributes||O.lensAttributes)&&O.timerange?v?o.a.createElement(m.b,{isChartEmbeddablesEnabled:!0,dataExists:N,label:E,title:D?o.a.createElement(u.a,{count:null===(L=D[0])||void 0===L||null===(q=L.hits)||void 0===q?void 0:q.total}):null,donutTextWrapperClassName:x,donutTextWrapperStyles:P},o.a.createElement(A,r()({},O,{id:h,onLoad:R}))):o.a.createElement(A,r()({},O,{id:h,onLoad:R})):null;var L,q},R=o.a.memo(P)},function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"e",(function(){return I}));var a=n(19),r=n(60),i=n.n(r),o=n(2),s=n.n(o),l=n(41),c=n.n(l);const u=c.a.span.withConfig({displayName:"ArrowBody",componentId:"sc-11kjqat-0"})(["background-color:",";height:",";width:25px;"],(e=>e.theme.eui.euiColorLightShade),(({height:e})=>`${e}px`));u.displayName="ArrowBody";const d=s.a.memo((({direction:e})=>s.a.createElement(a.EuiIcon,{color:"subdued","data-test-subj":"arrow-icon",size:"s",type:e})));d.displayName="ArrowHead";var p=n(1296);const m=Object(p.scaleLinear)().domain([0,100]).range([1,4]).clamp(!0),f=e=>Array.isArray(e)&&1===e.length;var g=n(134),b=n(665),y=n(832);const h="source.bytes",v="source.packets",E="destination.bytes",x="destination.packets",j=c.a.span.withConfig({displayName:"Percent",componentId:"sc-19xyyc3-0"})(["margin-right:5px;"]);j.displayName="Percent";const O=c()(a.EuiFlexGroup).withConfig({displayName:"SourceDestinationArrowsContainer",componentId:"sc-19xyyc3-1"})(["margin:0 2px;.euiToolTipAnchor{white-space:nowrap;}"]);O.displayName="SourceDestinationArrowsContainer";const S=c()(a.EuiText).withConfig({displayName:"Data",componentId:"sc-19xyyc3-2"})(["margin:0 5px;"]);S.displayName="Data";const w=s.a.memo((({contextId:e,eventId:t,isDraggable:n,sourceBytes:r,sourceBytesPercent:o,sourcePackets:l})=>{const c=null!=o?m(o):1;return s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==r||isNaN(Number(r))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:h,id:`source-arrow-default-draggable-${e}-${t}-${h}-${r}`,isDraggable:n,value:r},s.a.createElement(S,{size:"xs"},null!=o?s.a.createElement(j,null,`(${i()(o).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(b.a,{value:r}))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==l||isNaN(Number(l))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:v,id:`source-arrow-default-draggable-${e}-${t}-${v}-${l}`,isDraggable:n,value:l},s.a.createElement(S,{size:"xs"},s.a.createElement("span",null,`${l} ${y.a}`)))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowRight"})))}));w.displayName="SourceArrow";const k=s.a.memo((({contextId:e,destinationBytes:t,destinationBytesPercent:n,destinationPackets:r,eventId:o,isDraggable:l})=>{const c=null!=n?m(n):1;return s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowLeft"})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==t||isNaN(Number(t))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:E,id:`destination-arrow-default-draggable-${e}-${o}-${E}-${t}`,isDraggable:l,value:t},s.a.createElement(S,{size:"xs"},null!=n?s.a.createElement(j,null,`(${i()(n).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(b.a,{value:t}))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==r||isNaN(Number(r))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:x,id:`destination-arrow-default-draggable-${e}-${o}-${x}-${r}`,isDraggable:l,value:r},s.a.createElement(S,{size:"xs"},s.a.createElement("span",null,`${i()(r).format("0,0")} ${y.a}`)))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})))}));k.displayName="DestinationArrow";const I=s.a.memo((({contextId:e,destinationBytes:t,destinationPackets:n,eventId:r,isDraggable:i,sourceBytes:o,sourcePackets:l})=>{const c=null!=o&&f(o)?o[0]:void 0,u=null!=l&&f(l)?l[0]:void 0,d=null!=t&&f(t)?t[0]:void 0,p=null!=n&&f(n)?n[0]:void 0,m=null!=c&&null!=d?(({numerator:e,denominator:t})=>{if(!(Math.abs(t)<Number.EPSILON)&&Number.isFinite(e)&&Number.isFinite(t))return e/t*100})({numerator:Number(c),denominator:Number(c)+Number(d)}):void 0,g=null!=m?100-m:void 0;return s.a.createElement(O,{alignItems:"center",justifyContent:"center",direction:"column",gutterSize:"none"},null!=c?s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(w,{contextId:e,eventId:r,isDraggable:i,sourceBytes:c,sourcePackets:u,sourceBytesPercent:m})):null,null!=d?s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(k,{contextId:e,destinationBytes:d,destinationPackets:p,destinationBytesPercent:g,eventId:r,isDraggable:i})):null)}));I.displayName="SourceDestinationArrows"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(19),l=n(47),c=n(118),u=n(42);const d=({handleClick:e})=>r.a.createElement(s.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},r.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),p=r.a.memo(d);var m=n(716);const f=o.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),g=({agentId:e,defaultValues:t,onClose:n,ecsData:i})=>{const{euiTheme:o}=Object(s.useEuiTheme)(),u=Object(a.useMemo)((()=>({style:`z-index: ${o.levels.flyout+3}`})),[o.levels.flyout]),{services:{osquery:d}}=Object(c.j)(),g=Object(l.useQueryClient)(),b=Object(a.useCallback)((()=>{var e;g.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,g]),y=Object(s.useGeneratedHtmlId)({prefix:"osqueryFlyoutTitle"});return null!=d&&d.OsqueryAction?r.a.createElement(s.EuiFlyout,{size:"m",onClose:n,"aria-labelledby":y,maskProps:u},r.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},r.a.createElement(s.EuiTitle,null,r.a.createElement("h2",{id:y},m.a))),r.a.createElement(s.EuiFlyoutBody,null,r.a.createElement(f,{"data-test-subj":"flyout-body-osquery"},r.a.createElement(d.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:i,onSuccess:b}))),r.a.createElement(s.EuiFlyoutFooter,null,r.a.createElement(p,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},b=r.a.memo(g)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),r=n.n(a),i=n(19),o=n(2),s=n.n(o),l=n(41);const c=n.n(l)()(i.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-tln1ed-0"})(["align-self:center;max-width:60em;"]);c.displayName="EmptyPrompt";const u=s.a.memo((({actions:e,message:t,title:n,...a})=>{const l=Object.keys(e),u=Object(o.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:n,url:a,descriptionTitle:r,description:o,onClick:c,fill:u=!0},d)=>null!=r||null!=o?s.a.createElement(i.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},s.a.createElement(i.EuiCard,{title:null!=r&&r,description:null!=o&&o,footer:s.a.createElement(i.EuiButton,{href:a,onClick:c,iconType:e,target:n,fill:u,"data-test-subj":`empty-page-${l[d]}-action`},t)})):s.a.createElement(i.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},s.a.createElement(i.EuiButton,{href:a,onClick:c,iconType:e,target:n,"data-test-subj":`empty-page-${l[d]}-action`},t))))),[e,l]);return s.a.createElement(c,r()({iconType:"logoSecurity",title:s.a.createElement(i.EuiText,null,s.a.createElement("h2",null,n)),body:t&&s.a.createElement("p",null,t),actions:s.a.createElement(i.EuiFlexGroup,{justifyContent:"center"},u)},a))}));u.displayName="EmptyPageComponent";const d=s.a.memo(u);d.displayName="EmptyPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=a.keyof({simple:null});a.union([r,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(48),r=n(5),i=n(127);const o=[r.d,r.C,`${r.Cc}/id/:id`,r.Ib,r.bd,r.ac,r.ic],s=[r.d,`${r.Cc}/id/:id`,`${r.x}/:detailName`],l=e=>null==Object(a.matchPath)(e,{path:s,strict:!1})?i.SourcererScopeName.default:i.SourcererScopeName.detections,c=e=>null!=Object(a.matchPath)(e,{path:o,strict:!1})},function(e,t,n){"use strict";var a=n(1e3),r={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,i,o,s,l,c,u=!1;t||(t={}),n=t.debug||!1;try{if(o=a(),s=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=e,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),void 0===a.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=r[t.format]||r.default;window.clipboardData.setData(i,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(c),s.selectNodeContents(c),l.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(a){n&&console.error("unable to copy using execCommand: ",a),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(a){n&&console.error("unable to copy using clipboardData: ",a),n&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(s):l.removeAllRanges()),c&&document.body.removeChild(c),o()}return u}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(11),i=n(118);const o=()=>{const e=Object(i.j)(),{http:t}=e.services,[n,o]=Object(a.useState)(Object(r.createSavedQueryService)(t));return Object(a.useEffect)((()=>{o(Object(r.createSavedQueryService)(t))}),[t]),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n(404).NetworkType.details;let a=function(e){return e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(19),l=n(157),c=n(481);const u=o()(s.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=r.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:i,bottomRightContent:o,includePlugins:d},p)=>{const{isInvalid:m,errorMessage:f}=Object(l.k)(t),[g,b]=Object(a.useState)(!1);return r.a.createElement(s.EuiFormRow,{"data-test-subj":n,describedByIds:i?[i]:void 0,error:f,fullWidth:!0,helpText:t.helpText,isInvalid:m||g,label:t.label,labelAppend:t.labelAppend},r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{ref:p,ariaLabel:i,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`,setIsMarkdownInvalid:b,includePlugins:d}),o&&r.a.createElement(u,{justifyContent:"flexEnd"},r.a.createElement(s.EuiFlexItem,{grow:!1},o))))})));d.displayName="MarkdownEditorForm"},function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return f}));var a=n(68);let r=function(e){return e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout",e.urlChanged="urlChanged",e}({});const i=Object(a.createAction)(r.openFlyout),o=Object(a.createAction)(r.openRightPanel),s=Object(a.createAction)(r.openLeftPanel),l=Object(a.createAction)(r.openPreviewPanel),c=Object(a.createAction)(r.closeFlyout),u=Object(a.createAction)(r.closeRightPanel),d=Object(a.createAction)(r.closeLeftPanel),p=Object(a.createAction)(r.closePreviewPanel),m=Object(a.createAction)(r.previousPreviewPanel),f=Object(a.createAction)(r.urlChanged)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n(19),r=n(2),i=n.n(r),o=n(559);const s="exit-full-screen",l=({fullScreen:e,setFullScreen:t})=>{const n=Object(r.useCallback)((()=>{t(!1)}),[t]),l=Object(r.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:l}),i.a.createElement(a.EuiButton,{className:s,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:n},o.a)):null};l.displayName="ExitFullScreenComponent";const c=i.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events",e}({})},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="_id"},function(e,t,n){"use strict";n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"f",(function(){return S}));var a=n(19),r=n(44),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(134),u=n(1106);const d="source.geo.continent_name",p="source.geo.country_name",m="source.geo.country_iso_code",f="source.geo.region_name",g="source.geo.city_name",b="destination.geo.continent_name",y="destination.geo.country_name",h="destination.geo.country_iso_code",v="destination.geo.region_name",E="destination.geo.city_name",x=[{prop:"GeoContinentName",fieldName:"geo.continent_name"},{prop:"GeoCountryName",fieldName:"geo.country_name"},{prop:"GeoCountryIsoCode",fieldName:"geo.country_iso_code"},{prop:"GeoRegionName",fieldName:"geo.region_name"},{prop:"GeoCityName",fieldName:"geo.city_name"}],j=l()(a.EuiFlexItem).withConfig({displayName:"GeoFlexItem",componentId:"sc-19jrcd0-0"})(["margin-right:5px;"]);j.displayName="GeoFlexItem";const O=o.a.memo((({contextId:e,eventId:t,fieldName:n,isDraggable:i,values:s})=>null!=s?o.a.createElement(o.a.Fragment,null,Object(r.uniq)(s).map((r=>o.a.createElement(j,{grow:!1,key:`${e}-${t}-${n}-${r}`},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n===m||n===h?o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(u.a,{countryCode:r})):null,o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(c.b,{"data-test-subj":n,field:n,id:`geo-field-values-default-draggable-${e}-${t}-${n}-${r}`,isDraggable:i,tooltipContent:n,value:r}))))))):null));O.displayName="GeoFieldValues";const S=o.a.memo((e=>{const{contextId:t,eventId:n,isDraggable:i,type:s}=e,l=(e=>x.map((({prop:t,fieldName:n})=>({prop:`${e}${t}`,fieldName:`${e}.${n}`}))))(s);return o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(r.uniq)(l).map((a=>o.a.createElement(O,{contextId:t,eventId:n,fieldName:a.fieldName,isDraggable:i,key:a.fieldName,values:Object(r.get)(a.prop,e)}))))}));S.displayName="GeoFields"},function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(19),r=n(44),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(134),u=n(520),d=n(151),p=n(1430);const m="event.start",f="event.end",g=l()(a.EuiIcon).withConfig({displayName:"TimeIcon",componentId:"sc-181wv62-0"})(["margin-right:3px;position:relative;top:-1px;"]);g.displayName="TimeIcon";const b=o.a.memo((({contextId:e,eventDuration:t,eventId:n,eventEnd:i,eventStart:s,isDraggable:l})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"duration-and-start-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=t?Object(r.uniq)(t).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:u.b,id:`duration-event-start-end-default-draggable-${e}-${n}-${u.b}-${t}`,isDraggable:l,name:name,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(p.a,{maybeDurationNanoseconds:t,tooltipTitle:u.b})))))):null,null!=s?Object(r.uniq)(s).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:m,id:`duration-event-start-end-default-draggable-${e}-${n}-${m}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:m,value:t})))))):null,null!=i?Object(r.uniq)(i).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:f,id:`duration-event-start-end-default-draggable-${e}-${n}-${f}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:f,value:t})))))):null)));b.displayName="DurationEventStartEnd"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n.n(a),i=n(134),o=n(150);const s=({args:e,contextId:t,eventId:n,processTitle:a,isDraggable:s})=>Object(o.e)(e)&&Object(o.e)(a)?null:r.a.createElement(r.a.Fragment,null,null!=e&&e.map(((e,a)=>r.a.createElement(o.c,{key:`${t}-args-${a}-${e}`,grow:!1,component:"span"},r.a.createElement(i.c,{contextId:`${t}-args-${a}-${e}`,eventId:n,field:"process.args",isDraggable:s,value:e,fieldType:"keyword",isAggregatable:!0})))),!Object(o.e)(a)&&r.a.createElement(o.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:t,eventId:n,field:"process.title",isDraggable:s,value:a,fieldType:"keyword",isAggregatable:!0})));s.displayName="ArgsComponent";const l=r.a.memo(s);l.displayName="Args"},function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"l",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"e",(function(){return y}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.timeline.body.openSessionViewLabel",{defaultMessage:"Open Session View"}),i=a.i18n.translate("xpack.securitySolution.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.notes.addNoteTooltip",{defaultMessage:"Add Note"}),s=({notesCount:e})=>a.i18n.translate("xpack.securitySolution.timeline.body.notes.addNote.multipleNotesAvailableTooltip",{values:{notesCount:e},defaultMessage:"{notesCount} {notesCount, plural, one {Note} other {Notes}  } available. Click to view {notesCount, plural, one {it} other {them}} & add more."}),l=a.i18n.translate("xpack.securitySolution.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),c=a.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),u=a.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsAriaLabel",{defaultMessage:"View details"}),d=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),p=a.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),m=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Analyze the alert or event in row {ariaRowindex}, with columns {columnValues}"}),f=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.sendAlertToTimelineForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Send the alert in row {ariaRowindex} to timeline, with columns {columnValues}"}),g=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.addNotesForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Add notes for the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),b=({ariaRowindex:e,columnValues:t,isEventPinned:n})=>a.i18n.translate("xpack.securitySolution.hoverActions.pinEventForRowAriaLabel",{defaultMessage:"{isEventPinned, select, true {Unpin} other {Pin} } the event in row {ariaRowindex} to timeline, with columns {columnValues}",values:{ariaRowindex:e,columnValues:t,isEventPinned:n}}),y=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.moreActionsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Select more actions for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewListDetailActionLabel",{defaultMessage:"View list detail"}),i=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewRuleDetailActionLabel",{defaultMessage:"View rule detail"}),o=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.link_column",{defaultMessage:"Link"}),s=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.name_column",{defaultMessage:"Name"}),l=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.action_column",{defaultMessage:"Action"}),c=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.tags_column",{defaultMessage:"Tags"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(1532),r=n(1533),i=n(5);const o=Object(a.a)((async({name:e,description:t,http:n,signal:a})=>await n.post(i.Mc,{version:"2023-10-31",body:JSON.stringify({name:e,description:t}),headers:{"Content-Type":"application/json"},method:"POST",signal:a}))),s=()=>Object(r.a)(o)},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.edit.label",{defaultMessage:"Edit rule exception"}),i=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.edit.label",{defaultMessage:"Edit endpoint exception"}),o=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.delete.label",{defaultMessage:"Delete rule exception"}),s=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.delete.label",{defaultMessage:"Delete endpoint exception"}),l=a.i18n.translate("xpack.securitySolution.exceptions.list.utility.title",{defaultMessage:"rule exceptions"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),r=n(1334),i=n(1314),o=n(19),s=n(144),l=n(5),c=n(599),u=n(221),d=n(884),p=n(780);const m=({exceptionsList:e,handleExport:t,handleDelete:n,handleDuplicate:m,handleManageRules:f})=>{const[g,b]=Object(a.useState)(i.a.LOADING),[y,h]=Object(a.useState)(),[v,E]=Object(a.useState)(!1),[x,j]=Object(a.useState)(!1),[O,S]=Object(a.useState)(null),{name:w,list_id:k,rules:I,type:T,created_by:C,created_at:M,description:_}=e,D=Object(a.useCallback)((()=>{b("")}),[b]),N=e=>{h(e),j(!0)},{lastUpdated:A,exceptionViewerStatus:F,exceptions:P,pagination:R,ruleReferences:L,fetchItems:q,onDeleteException:z,onPaginationChange:B}=Object(c.a)({list:e,deleteToastTitle:u.u,deleteToastBody:e=>u.t(e),errorToastBody:u.p,errorToastTitle:u.q,onEditListExceptionItem:N,onFinishFetchingExceptions:D});Object(a.useEffect)((()=>{q(null,i.a.LOADING)}),[q]);const[$,V]=Object(a.useState)(!1),U=Object(o.useGeneratedHtmlId)({prefix:"openAccordion"}),G=Object(d.a)(e),H=Object(a.useMemo)((()=>g===i.a.EMPTY?u.B:""),[g]),W=Object(a.useMemo)((()=>g===i.a.EMPTY?u.y(e.name):""),[e.name,g]),Q=Object(a.useMemo)((()=>e.type===r.a.ENDPOINT?u.A:u.z),[e.type]),Y=Object(a.useMemo)((()=>[{key:"Export",icon:"exportAction",label:u.O,onClick:n=>{T===r.a.ENDPOINT?t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:!0})():S(p.a.EXPORT)}},{key:"Duplicate",icon:"copy",label:u.k,disabled:G,onClick:e=>{S(p.a.DUPLICATE)}},{key:"Delete",icon:"trash",disabled:G,label:u.j,onClick:t=>{n({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"LinkRules",icon:"gear",disabled:G,label:u.X,onClick:e=>{f()}}]),[G,T,t,e.id,e.list_id,e.name,e.namespace_type,n,f]),K=Object(a.useCallback)((()=>{E(!0)}),[E]),Z=Object(a.useCallback)((e=>{E(!1),j(!1),e&&q()}),[q,E,j]),X=Object(a.useCallback)((()=>{S(p.a.EXPORT)}),[S]),J=Object(a.useCallback)((n=>{O===p.a.EXPORT&&t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:n})(),O===p.a.DUPLICATE&&m({listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:n})()}),[O,t,e.id,e.list_id,e.name,e.namespace_type,m]),{onClick:ee}=Object(s.o)()({deepLinkId:l.Oc.exceptions,path:`/details/${e.list_id}`});return{listId:k,listName:w,listDescription:_,createdAt:new Date(M).toDateString(),createdBy:C,listRulesCount:I.length.toString(),exceptionItemsCount:R.totalItemCount.toString(),listType:T,menuActionItems:Y,showAddExceptionFlyout:v,toggleAccordion:$,openAccordionId:U,viewerStatus:g,exceptionToEdit:y,showEditExceptionFlyout:x,lastUpdated:A,exceptions:P,ruleReferences:L,pagination:R,exceptionViewerStatus:F,onEditExceptionItem:N,onDeleteException:z,onPaginationChange:B,setToggleAccordion:V,onAddExceptionClick:K,handleConfirmExceptionFlyout:Z,handleCancelExceptionItemFlyout:()=>{E(!1),j(!1)},goToExceptionDetail:ee,emptyViewerTitle:H,emptyViewerBody:W,emptyViewerButtonText:Q,showIncludeExpiredExceptionsModal:O,onExportListClick:X,handleCancelExpiredExceptionsModal:()=>{S(null)},handleConfirmExpiredExceptionsModal:J}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(1314),i=n(118),o=n(627);const s=({list:e,deleteToastTitle:t,deleteToastBody:n,errorToastTitle:s,errorToastBody:l,onEditListExceptionItem:c,onFinishFetchingExceptions:u})=>{const{services:d}=Object(i.j)(),{http:p}=d,m=Object(i.n)(),[f,g]=Object(a.useState)([]),[b,y]=Object(a.useState)({}),[h,v]=Object(a.useState)({pageIndex:0,pageSize:0,totalItemCount:0}),[E,x]=Object(a.useState)(null),[j,O]=Object(a.useState)(""),S=Object(a.useCallback)(((e,t,n)=>{null==m||m.addError(e,{title:t||s,toastMessage:n||l}),O(r.a.ERROR)}),[l,s,m]),w=Object(a.useCallback)((async()=>{try{const t=await Object(o.c)([e]);y(t)}catch(e){S(e)}}),[S,e,y]),k=Object(a.useCallback)(((e,t,n)=>{v(e),x(Date.now()),setTimeout((()=>{if(n===r.a.EMPTY_SEARCH)return O(t?"":n);O(t?"":r.a.EMPTY)}),200)}),[]),I=Object(a.useCallback)((async(t,n)=>{try{O(r.a.LOADING);const{data:a,pagination:i}=await Object(o.b)({http:p,...Object(o.g)(null,e,t)});g(a),w(),k(i,a.length,n),"function"==typeof u&&u()}catch(e){S(e)}}),[p,e,w,k,u,S]),T=Object(a.useCallback)((async({id:e,name:a,namespaceType:i})=>{try{O(r.a.LOADING),await Object(o.a)({id:e,http:p,namespaceType:i}),null==m||m.addSuccess({title:t,text:"function"==typeof n?n(a):""}),I()}catch(e){S(e)}}),[p,m,t,n,I,S]),C=Object(a.useCallback)((async e=>{I(e)}),[I]);return{exceptions:f,lastUpdated:E,pagination:h,exceptionViewerStatus:j,ruleReferences:b,fetchItems:I,onDeleteException:T,onEditExceptionItem:e=>{"function"==typeof c&&c(e)},onPaginationChange:C}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(168),r=n(1532),i=n(1533);const o=Object(r.a)((async({file:e,http:t,signal:n,overwrite:r,overwriteExceptions:i,asNewList:o})=>{const s=new FormData;return s.append("file",e),await t.post(`${a.s}/_import`,{version:"2023-10-31",body:s,query:{overwrite:r,overwrite_exceptions:i,as_new_list:o},headers:{"Content-Type":void 0},method:"POST",signal:n})})),s=()=>Object(i.a)(o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(1334),i=n(1314),o=n(221),s=n(795);const l=(e,t)=>{const[n,l]=Object(a.useState)(!1),[c,u]=Object(a.useState)(!1),[d,p]=Object(a.useState)(),[m,f]=Object(a.useState)(i.a.LOADING),g=Object(a.useCallback)((()=>{f("")}),[f]),b=e=>{p(e),u(!0)},{exceptionViewerStatus:y,exceptions:h,lastUpdated:v,pagination:E,ruleReferences:x,fetchItems:j,onDeleteException:O,onPaginationChange:S}=Object(s.b)({list:e,deleteToastTitle:o.u,deleteToastBody:e=>o.t(e),errorToastBody:o.p,errorToastTitle:o.q,onEditListExceptionItem:b,onFinishFetchingExceptions:g});Object(a.useEffect)((()=>{j(null,i.a.LOADING)}),[j,t]);const w=Object(a.useMemo)((()=>m===i.a.EMPTY?o.B:""),[m]),k=Object(a.useMemo)((()=>m===i.a.EMPTY?o.y(e.name):""),[e.name,m]),I=Object(a.useMemo)((()=>e.type===r.a.ENDPOINT?o.A:o.z),[e.type]),T=Object(a.useCallback)((async e=>{f(i.a.SEARCHING),j(e,i.a.EMPTY_SEARCH)}),[j,f]),C=Object(a.useCallback)((()=>{l(!0),j()}),[j,l]),M=Object(a.useCallback)((e=>{l(!1),u(!1),e&&j()}),[j,l,u]);return{exceptionViewerStatus:y,listName:e.name,exceptions:h,listType:e.type,lastUpdated:v,pagination:E,viewerStatus:m,emptyViewerTitle:w,emptyViewerBody:k,emptyViewerButtonText:I,ruleReferences:x,showAddExceptionFlyout:n,showEditExceptionFlyout:c,exceptionToEdit:d,onSearch:T,onAddExceptionClick:C,onDeleteException:O,onEditExceptionItem:b,onPaginationChange:S,handleCancelExceptionItemFlyout:()=>{l(!1),u(!1)},handleConfirmExceptionFlyout:M}}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(175),r=n(379);const i=({dataFormattedForFieldBrowser:e})=>{const t=Object(a.b)(e),{loading:n,error:i,rule:o}=Object(r.a)(t.ruleId);return{loading:n,error:i,basicAlertData:t,ruleNote:null==o?void 0:o.note}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return M}));var a=n(851),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(42),c=n(1216),u=n(122),d=n(228),p=n(16),m=n(263),f=n(628),g=n(153),b=n(125),y=n(302),h=n(130),v=n(149),E=n(118),x=n(229),j=n(288),O=n(318),S=n(287),w=n(319);const k="prevalence",I="now-30d",T=()=>{const{euiTheme:e}=Object(s.useEuiTheme)();return o.a.createElement("div",{"data-test-subj":g.E,style:{height:"16px",width:"100%",background:e.colors.lightShade}})},C=[{field:"field",name:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.fieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":g.A,render:e=>o.a.createElement(s.EuiText,{size:"xs"},e),width:"20%"},{name:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.valueColumnLabel",defaultMessage:"Value"}),"data-test-subj":g.H,render:e=>o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.values.map((t=>e.isPreviewEnabled&&e.field===x.g?o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiLink,{"data-test-subj":g.B,onClick:()=>e.openHostPreview(t)},o.a.createElement(s.EuiText,{size:"xs"},t))):e.isPreviewEnabled&&e.field===x.p?o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiLink,{"data-test-subj":g.F,onClick:()=>e.openUserPreview(t)},o.a.createElement(s.EuiText,{size:"xs"},t))):o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiText,{size:"xs"},t))))),width:"20%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnTooltip",defaultMessage:"Total number of alerts with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnLabel",defaultMessage:"Alert"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":g.y,render:e=>{const t=e.values.map((t=>Object(y.a)(e.field,`timeline-indicator-${e.field}-${t}`,t)));return e.alertCount>0?o.a.createElement(m.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to}},o.a.createElement(d.a,{count:e.alertCount})):Object(h.d)()},width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnTooltip",defaultMessage:"Total number of event documents with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnLabel",defaultMessage:"Document"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":g.z,render:e=>{const t=e.values.map((t=>({...Object(y.a)(e.field,`timeline-indicator-${e.field}-${t}`,t),and:[Object(y.b)("event.kind","timeline-indicator-event.kind-not-signal","signal",v.e,!0)]})));return e.docCount>0?o.a.createElement(m.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to},keepDataView:!0},o.a.createElement(d.a,{count:e.docCount})):Object(h.d)()},width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnTooltip",defaultMessage:"Percentage of unique hosts with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnLabel",defaultMessage:"Host"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":g.C,render:e=>o.a.createElement(o.a.Fragment,null,e.isPlatinumPlus?o.a.createElement(s.EuiText,{size:"xs"},`${Math.round(100*e.hostPrevalence)}%`):o.a.createElement(T,null)),width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnTooltip",defaultMessage:"Percentage of unique users with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnLabel",defaultMessage:"User"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":g.G,render:e=>o.a.createElement(o.a.Fragment,null,e.isPlatinumPlus?o.a.createElement(s.EuiText,{size:"xs"},`${Math.round(100*e.userPrevalence)}%`):o.a.createElement(T,null)),width:"10%"}],M=()=>{const{dataFormattedForFieldBrowser:e,investigationFields:t,scopeId:n}=Object(b.b)(),{openPreviewPanel:a}=Object(c.a)(),{telemetry:d}=Object(E.j)().services,m=Object(p.b)().isPlatinumPlus(),y=!Object(u.a)("entityAlertPreviewDisabled"),[h,v]=Object(i.useState)(I),[x,k]=Object(i.useState)("now"),[T,M]=Object(i.useState)((r.a.parse(I)||new Date).toISOString()),[_,D]=Object(i.useState)((r.a.parse("now")||new Date).toISOString()),{loading:N,error:A,data:F}=Object(f.a)({dataFormattedForFieldBrowser:e,investigationFields:t,interval:{from:h,to:x}}),P=Object(i.useCallback)((e=>{a({id:j.e,params:{hostName:e,scopeId:n,banner:O.a}}),d.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[a,n,d]),R=Object(i.useCallback)((e=>{a({id:S.d,params:{userName:e,scopeId:n,banner:w.a}}),d.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[a,n,d]),L=Object(i.useMemo)((()=>F.map((e=>({...e,from:T,to:_,isPlatinumPlus:m,isPreviewEnabled:y,openHostPreview:P,openUserPreview:R})))),[F,T,_,m,y,P,R]),q=o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiCallOut,{"data-test-subj":g.I},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellDescription",defaultMessage:"Host and user prevalence are only available with a {subscription}.",values:{subscription:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellLinkText",defaultMessage:"Platinum or higher subscription"}))}})),o.a.createElement(s.EuiSpacer,{size:"s"}));return o.a.createElement(o.a.Fragment,null,!A&&!m&&q,o.a.createElement(s.EuiPanel,null,o.a.createElement(s.EuiSuperDatePicker,{start:h,end:x,onTimeChange:({start:e,end:t,isInvalid:n})=>{if(n)return;v(e),k(t);const a=r.a.parse(e);a&&a.isValid()&&M(a.toISOString());const i=r.a.parse(t);i&&i.isValid()&&D(i.toISOString())},"data-test-subj":g.x,width:"full"}),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiInMemoryTable,{items:A?[]:L,columns:C,loading:N,"data-test-subj":g.D,message:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})})))};M.displayName="PrevalenceDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(44),r=n(813),i=n(332),o=n(503),s=n(549);const l=({dataFormattedForFieldBrowser:e,investigationFields:t})=>{var n,l;const c=Object(i.a)(e),u=Object(s.a)(e),d=Object(a.find)({category:"event",field:"event.code"},e),p=Array.isArray(null==d?void 0:d.originalValue)?null==d||null===(n=d.originalValue)||void 0===n?void 0:n[0]:null==d?void 0:d.originalValue,m=Object(a.find)({category:"kibana",field:r.o},e),f=Array.isArray(null==m?void 0:m.originalValue)?null==m||null===(l=m.originalValue)||void 0===l?void 0:l[0]:null==m?void 0:m.originalValue;return Object(s.b)({eventCategories:u,eventCode:p,eventRuleType:f,highlightedFieldsOverride:null!=t?t:[]}).reduce(((t,n)=>{var r,i;const s=e.find((e=>e.field===n.id||n.legacyId&&e.field===n.legacyId));if(!s)return t;const l=s.values;return!l||Object(a.isEmpty)(l)?t:(s.field===n.legacyId&&(n.id=n.legacyId),Object(o.b)(n.id)&&c.details.agentIdField!==n.id?t:{...t,[n.id]:{...n.overrideField&&{overrideField:{field:n.overrideField,values:null!==(r=null===(i=Object(a.find)({field:n.overrideField},e))||void 0===i?void 0:i.values)&&void 0!==r?r:[]}},values:l}})}),{})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));const a=(e,t,n)=>Object.keys(e).map((a=>{var r,i;const o=null===(r=e[a].overrideField)||void 0===r?void 0:r.field,s=null===(i=e[a].overrideField)||void 0===i?void 0:i.values,l=o||a;return{field:l,description:{field:l,...o?{originalField:a}:{},values:null!=s&&s.length?s:e[a].values,scopeId:t,isPreview:n}}})),r=e=>Object.keys(e).reduce(((t,n)=>{const a=e[n].values;return{...t,[n]:{terms:{[n]:a}}}}),[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(352),i=n(131),o=n(234);const s=({entityId:e,scopeId:t})=>{const{loading:n,error:s,count:l,alertIds:c}=Object(r.a)({field:o.c,value:e,isActiveTimelines:Object(i.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0});return Object(a.useMemo)((()=>({loading:n,error:s,data:c||[],dataCount:l||0})),[c,l,s,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(234),i=n(352),o=n(131);const s=({originalEventId:e,scopeId:t})=>{const{loading:n,error:s,count:l,alertIds:c}=Object(i.a)({field:r.a,value:e,isActiveTimelines:Object(o.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0});return Object(a.useMemo)((()=>({loading:n,error:s,data:c||[],dataCount:l||0})),[c,l,s,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(47),r=n(2),i=n(118),o=n(5);const s=({eventId:e})=>{const{services:{cases:t}}=Object(i.j)(),{data:n,isLoading:s,isError:l}=Object(a.useQuery)(["useFetchRelatedCases",e],(()=>t.api.getRelatedCases(e,{owner:o.j})),{keepPreviousData:!0});return Object(r.useMemo)((()=>({loading:s,error:l,data:n||[],dataCount:(null==n?void 0:n.length)||0})),[n,l,s])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(36),r=n(242),i=n(142);const o=({getFieldsData:e})=>{const{cases:t}=Object(r.c)().services,n="signal"===Object(i.a)(e("event.kind")),o=t.helpers.canUseCases([a.APP_ID]);return n&&o.read}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(541),r=n(16),i=n(234),o=n(142);const s=({getFieldsData:e,dataAsNestedObject:t,eventId:n,isPreview:s})=>{var l;const c=Object(a.a)(t),u=null!==(l=Object(o.a)(e(i.a)))&&void 0!==l?l:"",d=s?u:n,p=Object(r.b)().isPlatinumPlus();return{show:c&&p,documentId:d}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(813);const r=({getFieldsData:e})=>{const t=e(a.t),n=t?parseInt(t[0],10):0;return{show:Boolean(t),alertSuppressionCount:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(234),r=n(142);const i=({eventId:e,getFieldsData:t})=>{var n;return{show:!0,originalEventId:null!==(n=Object(r.a)(t(a.a)))&&void 0!==n?n:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(234),r=n(142);const i=({getFieldsData:e})=>{const t=Object(r.a)(e(a.c));return{show:null!=t,...t&&{entityId:t}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(539),i=n(131);const o=({documentId:e,indices:t,scopeId:n})=>{const o=Object(i.isActiveTimeline)(n),{loading:s,error:l,alertIds:c}=Object(r.a)({isActiveTimeline:o,documentId:e,indices:t});return Object(a.useMemo)((()=>({loading:s,error:l,data:c,dataCount:(null==c?void 0:c.length)||0})),[c,l,s])}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return _t}));var a=n(2),r=n.n(a),i=n(45),o=n(19),s=n(42),l=n(48),c=n(888),u=n(147),d=n(41),p=n.n(d),m=n(410);function f(e,t,n){return t+(e>1?n*(e-1):0)}var g=n(49);function b(){return Object(a.useMemo)((()=>({copyableFieldBackground:g.euiThemeVars.euiColorLightShade,descriptionText:g.euiThemeVars.euiTextColor,full:g.euiThemeVars.euiColorFullShade,graphControls:g.euiThemeVars.euiColorDarkestShade,graphControlsBackground:g.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:g.euiThemeVars.euiColorLightShade,processBackingFill:`${g.euiThemeVars.euiColorPrimary}${g.darkMode?"1F":"0F"}`,resolverBackground:g.euiThemeVars.euiColorEmptyShade,resolverEdge:g.darkMode?g.euiThemeVars.euiColorLightShade:g.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:g.euiThemeVars.euiColorLightestShade,resolverEdgeText:g.darkMode?g.euiThemeVars.euiColorFullShade:g.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${g.euiThemeVars.euiColorDanger}${g.darkMode?"1F":"0F"}`,pillStroke:g.euiThemeVars.euiColorLightShade,linkColor:g.euiThemeVars.euiLinkColor})),[])}const y=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${f(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),h=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),v=r.a.memo((({className:e,edgeLineMetadata:t,startPosition:n,endPosition:a,projectionMatrix:i})=>{const o=Object(m.c)(n,i),l=Object(m.c)(a,i),[c]=i,u=b(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(o,l),g=f(c,10,7.5),v={left:`${o[0]}px`,top:`${o[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(o,l)}rad)`};let E=50;return c<1&&(E+=1/c*(10*(1-c))),r.a.createElement(y,{className:e,style:v,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&r.a.createElement(h,{backgroundColor:u.resolverEdge,leftPct:E,scaledTypeSize:g,textColor:u.resolverEdgeText},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var E=n(4);const x={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},j=Object(a.createContext)(x);var O=n(509),S=n(122);const w=["fit-content(10em)","auto"],k=p()(o.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-160k3ht-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),I=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-160k3ht-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),T=p()(o.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-160k3ht-2"})(["text-transform:uppercase;"]),C=p()(o.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-160k3ht-3"})(["lineheight:'2.2em';"]),M=p()(o.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-160k3ht-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),_=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-160k3ht-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor));var D=n(500),N=n(127);const A=E.i18n.translate("xpack.securitySolution.resolver.graphControls.sourcererButtonTitle",{defaultMessage:"Data View Selection"}),F=Object(a.memo)((({id:e,closePopover:t,setActivePopover:n,isOpen:i})=>{const s=Object(a.useCallback)((()=>n("sourcererSelection")),[n]),l=b();return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:sourcerer-button",size:"m",title:A,"aria-label":A,onClick:s,iconType:"indexSettings",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:i,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(D.a,{scope:N.SourcererScopeName.analyzer}))}));F.displayName="SourcererButton";var P=n(346),R=n(310);const L=[],q=E.i18n.translate("xpack.securitySolution.resolver.graphControls.datePickerButtonTitle",{defaultMessage:"Date Range Selection"}),z=E.i18n.translate("xpack.securitySolution.resolver.graphControls.datePicker",{defaultMessage:"date range selection"}),B=Object(a.memo)((({id:e,closePopover:t,setActivePopover:n,isOpen:s})=>{const l=Object(i.useDispatch)(),c=Object(a.useCallback)((()=>n("datePicker")),[n]),d=b(),p=Object(i.useSelector)((t=>u.e(t.analyzer[e]))),m=Object(a.useCallback)((({start:t,end:n,isInvalid:a})=>{if(!a){const a=t.includes("now")||n.includes("now"),r=Object(P.c)(t);let i=Object(P.c)(n,{roundUp:!0});a&&(i=t===n?Object(P.c)("now"):Object(P.c)(n)),l(Object(R.userOverrodeDateRange)({id:e,timeRange:{from:r,to:i}}))}}),[l,e]);return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:date-picker-button",size:"m",title:q,"aria-label":q,onClick:c,iconType:"calendar",$backgroundColor:d.graphControlsBackground,$iconColor:d.graphControls,$borderColor:d.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},z),r.a.createElement(o.EuiSuperDatePicker,{onTimeChange:m,start:null==p?void 0:p.from,end:null==p?void 0:p.to,showUpdateButton:!1,recentlyUsedRanges:L,width:"auto"}))}));B.displayName="DateSelectionButton";const $=Object(a.memo)(p()(o.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),V=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),U=p()(o.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),G=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),H=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),W=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),Q=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],H,W),Y=p()(o.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),K=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function Z({id:e}){return Object(a.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function X(e,t,n){const r=Z({id:e}),i=b(),o=Object(a.useMemo)((()=>({runningProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.runningProcessCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.loadingCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},errorCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.errorCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${r.runningTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.terminatedProcessCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${r.terminatedTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger}})),[r,i]);return"terminated"===t?n?o.terminatedTriggerCube:o[J.processTerminated]:"running"===t?n?o[J.processCausedAlert]:o[J.processRan]:"error"===t?o[J.processError]:o[J.processLoading]}const J={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},ee=Object(a.memo)((function({id:e,className:t,size:n="2.15em",state:a,isOrigin:i,"data-test-subj":o}){const{cubeSymbol:s,strokeColor:l}=X(e,a,!1),{processCubeActiveBacking:c}=Z({id:e});return r.a.createElement(te,{className:t,width:n,height:n,viewBox:"0 0 34 34","data-test-subj":o,isOrigin:i,style:{verticalAlign:"middle"}},r.a.createElement("desc",null,E.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process} other {Unknown Process State}}",values:{state:a}})),i&&r.a.createElement("use",{xlinkHref:`#${c}`,fill:"transparent",x:0,y:-1,stroke:l,strokeDashoffset:0,width:"100%",height:"100%"}),r.a.createElement("use",{role:"presentation",xlinkHref:s,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),te=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),ne=r.a.memo((function({children:e}){return r.a.createElement(r.a.Fragment,null,r.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,r.a.createElement("wbr",null)]}),[])]}return e})))})),ae=({id:e,closePopover:t,setActivePopover:n,isOpen:i})=>{const s=Object(a.useCallback)((()=>n("nodeLegend")),[n]),l=b(),c=E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:c,"aria-label":c,onClick:s,iconType:"node",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:i,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),r.a.createElement("div",{style:{maxWidth:"212px"}},r.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:w,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))},re=({id:e,closePopover:t,setActivePopover:n,isOpen:s})=>{var l,c,d;const p=b(),m=Object(i.useSelector)((t=>u.H(t.analyzer[e]))),f=Object(a.useCallback)((()=>n("schemaInfo")),[n]),g=E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),y=E.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:f,iconType:"iInCircle",$backgroundColor:p.graphControlsBackground,$iconColor:p.graphControls,$borderColor:p.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),r.a.createElement(o.EuiIconTip,{content:E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),r.a.createElement("div",{style:{maxWidth:"268px"}},r.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:w,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),r.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ne,null,null!==(l=null==m?void 0:m.dataSource)&&void 0!==l?l:y)),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),r.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ne,null,null!==(c=null==m?void 0:m.schema.id)&&void 0!==c?c:y)),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),r.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ne,null,null!==(d=null==m?void 0:m.schema.parent)&&void 0!==d?d:y))))))},ie=r.a.memo((({id:e,className:t})=>{const n=Object(i.useDispatch)(),s=Object(i.useSelector)((t=>u.I(t.analyzer[e]))),{timestamp:l}=Object(a.useContext)(j),c=Object(S.a)("analyzerDatePickersAndSourcererDisabled"),[d,p]=Object(a.useState)(null),m=b(),f=Object(a.useCallback)((e=>{p(e===d?null:e)}),[p,d]),g=Object(a.useCallback)((()=>p(null)),[]),y=Object(a.useCallback)((t=>{const a=parseFloat(t.target.value);!1===isNaN(a)&&n(Object(O.userSetZoomLevel)({id:e,zoomLevel:a}))}),[n,e]),h=Object(a.useCallback)((()=>{n(Object(O.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[n,e]),v=Object(a.useCallback)((()=>{n(Object(O.userClickedZoomOut)({id:e}))}),[n,e]),x=Object(a.useCallback)((()=>{n(Object(O.userClickedZoomIn)({id:e}))}),[n,e]),[w,T,C,M]=Object(a.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{n(Object(O.userNudgedCamera)({id:e,direction:t,time:l()}))}))),[n,l,e]);return r.a.createElement(_,{className:t,$iconColor:m.graphControls,"data-test-subj":"resolver:graph-controls"},r.a.createElement(I,null,r.a.createElement(re,{id:e,closePopover:g,isOpen:"schemaInfo"===d,setActivePopover:f}),r.a.createElement(ae,{id:e,closePopover:g,isOpen:"nodeLegend"===d,setActivePopover:f}),c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{id:e,closePopover:g,isOpen:"sourcererSelection"===d,setActivePopover:f}),r.a.createElement(B,{id:e,closePopover:g,isOpen:"datePicker"===d,setActivePopover:f}))),r.a.createElement(I,null,r.a.createElement(o.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("div",{className:"panning-controls-top"},r.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:w},r.a.createElement(o.EuiIcon,{type:"arrowUp"}))),r.a.createElement("div",{className:"panning-controls-middle"},r.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:M},r.a.createElement(o.EuiIcon,{type:"arrowLeft"})),r.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:h},r.a.createElement(o.EuiIcon,{type:"bullseye"})),r.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:T},r.a.createElement(o.EuiIcon,{type:"arrowRight"}))),r.a.createElement("div",{className:"panning-controls-bottom"},r.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:C},r.a.createElement(o.EuiIcon,{type:"arrowDown"})))),r.a.createElement(o.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:x},r.a.createElement(o.EuiIcon,{type:"plusInCircle"})),r.a.createElement(k,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:s,onChange:y}),r.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:v},r.a.createElement(o.EuiIcon,{type:"minusInCircle"})))))}));function oe(e,t){return function(e,t){const n=Object(l.useHistory)(),r=Object(a.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),n.push(e)))}),[n,t,e]);return{href:n.createHref(e),onClick:r}}({search:Object(i.useSelector)((n=>u.F(n.analyzer[e])(t)))})}ie.displayName="GraphControls";var se=n(228),le=n(217);const ce=r.a.memo((({id:e,className:t,nodeID:n,nodeStats:i})=>{const o=Object(a.useMemo)((()=>void 0===i?[]:Object.entries(i.byCategory).map((([e,t])=>({prefix:r.a.createElement(se.a,{count:t||0}),category:e})))),[i]);return void 0===o?null:r.a.createElement("ul",{className:`${t} options`,"aria-describedby":n},o.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>r.a.createElement(ue,{id:e,pill:t,nodeID:n,key:t.category}))))})),ue=({id:e,pill:t,nodeID:n})=>{const o=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:n,eventCategory:t.category}}),{pillStroke:s,resolverBackground:l}=b(),c=Object(a.useMemo)((()=>({border:`1.5px solid ${s}`,backgroundColor:l})),[s,l]),u=Object(i.useDispatch)(),{timestamp:d}=Object(a.useContext)(j),p=Object(a.useCallback)((t=>{o.onClick(t),u(Object(le.userSelectedResolverNode)({id:e,nodeID:n,time:d()}))}),[d,o,u,n,e]);return r.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:c,key:t.category},r.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:p},t.prefix," ",t.category))},de=p()(ce).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),pe=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),me=p()(o.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),fe=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ge=p()(o.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var be=n(309),ye=n(212),he=n(291);const ve=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),Ee=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),xe=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),je=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),Oe=r.a.memo((({id:e,className:t,position:n,node:l,nodeID:c,projectionMatrix:d,timeAtRender:p})=>{const g=`resolver:${e}`,y=Z({id:e}),{timestamp:h}=Object(a.useContext)(j),[v,x]=Object(m.c)(n,d),[O]=d,S=Object(i.useSelector)((t=>u.b(t.analyzer[e]))),w=Object(i.useSelector)((t=>u.J(t.analyzer[e]))),k=Object(i.useSelector)((t=>u.A(t.analyzer[e]))),I=Object(i.useSelector)((t=>u.z(t.analyzer[e])(c))),T=Object(a.useCallback)((e=>Object(o.htmlIdGenerator)(g)(`${e}:node`)),[g]),C=Object(i.useSelector)((t=>u.d(t.analyzer[e])(c))),M=Object(i.useSelector)((t=>u.c(t.analyzer[e])(p)(c))),_=O>.8,D=O>=.55,N=(_?3.5:D?1:21)*O+5,A=360*(_?-.147413:-.147413-.08*(O-.5))*O,F=120*(_?-.53684:.2*-O*(1-O)/O-.53684)*O,P=Object(a.useMemo)((()=>({left:`${v+A}px`,top:`${x+F}px`,width:360*O+"px",height:120*O+"px"})),[v,O,A,F,x]),L=f(O,18.75,12.5),q=r.a.createRef(),z=b(),B=Object(i.useSelector)((t=>u.x(t.analyzer[e])(c))),$="loading"===B,{backingFill:V,cubeSymbol:U,descriptionText:G,isLabelFilled:H,labelButtonFill:W,strokeColor:Q}=X(e,B,!1),Y=Object(a.useMemo)((()=>Object(o.htmlIdGenerator)("resolver")(`${c}:label`)),[c]),K=c===S,J=c===w,ee=c===k,te=Object(i.useDispatch)(),ne=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:c}}),ae=Object(a.useCallback)((()=>{te(Object(le.userFocusedOnResolverNode)({id:e,nodeID:c,time:h()}))}),[te,c,h,e]),re=Object(a.useCallback)((t=>{var n;null!==(n=q.current)&&void 0!==n&&n.beginElement&&q.current.beginElement(),"error"===B?te(Object(R.userReloadedResolverNode)({id:e,nodeID:c})):(te(Object(le.userSelectedResolverNode)({id:e,nodeID:c,time:h()})),ne.onClick(t))}),[q,te,c,ne,B,h,e]),ie=Object(i.useSelector)((t=>u.K(t.analyzer[e])(l))),se=be.c(l),ce=Object(i.useSelector)((t=>he.a(u.w(t.analyzer[e])(String(l.id))))),ue=Object(a.useMemo)((()=>void 0!==ce?ye.l(ce):se),[ce,se]),pe=Object(a.useMemo)((()=>null===M?void 0:T(M)),[M,T]),me=Object(a.useMemo)((()=>T(c)),[T,c]);return r.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":c,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===C?void 0:C,"aria-flowto":pe,"aria-labelledby":Y,"aria-haspopup":"true","aria-current":K?"true":void 0,"aria-selected":J?"true":void 0,style:P,id:me,tabIndex:-1},r.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{ae(),re(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},r.a.createElement(je,{isNodeLoading:$},r.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:V,x:-15.35,y:-15.35,stroke:Q,width:22.5,height:22.5,className:"backing"}),ee&&r.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:Q,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),r.a.createElement("use",{role:"presentation",xlinkHref:U,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},r.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:q})))),r.a.createElement(ve,{color:z.full,fontSize:L,topPct:N},r.a.createElement(Ee,{backgroundColor:z.resolverBackground,color:z.descriptionText,isDisplaying:D,"data-test-subj":"resolver:node:description"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event · {descriptionText}} other {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:G}})),r.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:re,onFocus:ae,tabIndex:-1,style:{backgroundColor:z.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},r.a.createElement(o.EuiButton,{iconSide:$?"right":"left",isLoading:$,color:W,fill:H,iconType:"error"===B?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*O,32)}px`,maxWidth:(_?400:210*O)+"px"},tabIndex:-1,title:ue,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":c},r.a.createElement(xe,{isShowingIcon:"loading"===B||"error"===B,className:"eui-textTruncate","data-test-subj":"euiButton__text"},E.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:B,nodeName:ue}})))),r.a.createElement(o.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:z.resolverBackground,display:_?"flex":"none",margin:"2px 0 0 0",padding:0}},r.a.createElement(o.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==ie&&ie>0&&r.a.createElement(de,{id:e,buttonFill:z.resolverBackground,nodeStats:I,nodeID:c})))))})),Se=p()(Oe).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var we=n(56);function ke({id:e}){const t=e;return Object(a.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const Ie=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),Te=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),Ce=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),Me=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),_e=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),De=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Ne=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Ae=Object(a.memo)((({id:e,isDarkMode:t})=>{const n=ke({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:n.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#6D6D6D"}),r.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),r.a.createElement("linearGradient",{id:n.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),r.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),r.a.createElement("linearGradient",{id:n.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:n.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),r.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),r.a.createElement("linearGradient",{id:n.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:n.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),r.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),r.a.createElement("linearGradient",{id:n.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#DD0A73"}),r.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Fe=Object(a.memo)((({id:e,isDarkMode:t})=>{const n=Z({id:e}),a=ke({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("symbol",{id:n.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},r.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),r.a.createElement("symbol",{id:n.loadingCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Ie),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),r.a.createElement("symbol",{id:n.errorCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Te),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.errorCube})`}),r.a.createElement("g",{opacity:"0.6"},r.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.errorCube})`}),r.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:n.runningProcessCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Ce),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningProcessCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{id:n.runningTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Me),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningTriggerCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{viewBox:"0 0 88 100",id:n.terminatedProcessCube},r.a.createElement("title",null,_e),r.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),r.a.createElement("g",{opacity:"0.7"},r.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.terminatedProcessCube})`}),r.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:n.terminatedTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,De),t&&r.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("g",{opacity:"0.6"},!t&&r.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${a.terminatedTriggerCube})`}),r.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{viewBox:"0 -3 88 106",id:n.processCubeActiveBacking},r.a.createElement("title",null,Ne),r.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),Pe=Object(a.memo)((({id:e})=>{const t=Object(we.useDarkMode)();return r.a.createElement(Re,null,r.a.createElement("defs",null,r.a.createElement(Ae,{id:e,isDarkMode:t}),r.a.createElement(Fe,{id:e,isDarkMode:t})))})),Re=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Le=n(119),qe=n.n(Le);const ze=Object(a.memo)((function({breadcrumbs:e}){const t=Object(a.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:n,resolverEdgeText:i}=b();return r.a.createElement(r.a.Fragment,null,r.a.createElement(U,{background:n,text:i,breadcrumbs:t,truncate:!1}))})),Be=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function $e({id:e}){const t=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),n=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),i=oe(e,{panelView:"nodes"}),s=Object(a.useMemo)((()=>[{text:n,...i}]),[i,n]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ze,{breadcrumbs:s}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},r.a.createElement(Be,null,r.a.createElement(o.EuiLoadingSpinner,{size:"m"})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function Ve({event:e}){var t,n,a,i,o,l,c,u,d,p,m,f,g,b,y,h,v,E,x;return Object(ye.i)(e)?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(ye.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(n=e.kibana)&&void 0!==n&&null!==(a=n.alert)&&void 0!==a&&null!==(i=a.rule)&&void 0!==i&&i.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(f=e.kibana)||void 0===f||null===(g=f.alert)||void 0===g||null===(b=g.rule)||void 0===b?void 0:b.name)}}):null!==(o=e.file)&&void 0!==o&&o.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(y=e.file)||void 0===y?void 0:y.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(h=e.registry)||void 0===h?void 0:h.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(v=e.registry)||void 0===v?void 0:v.key)}}):null!==(u=e.dns)&&void 0!==u&&null!==(d=u.question)&&void 0!==d&&d.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(E=e.dns)||void 0===E||null===(x=E.question)||void 0===x?void 0:x.name)}}):r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(ye.b)(e)}})}var Ue=n(73),Ge=n.n(Ue);const He=E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),We=new Intl.DateTimeFormat(E.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Qe(e){const t=Object(we.useUiSetting)("dateFormat"),n=Object(we.useUiSetting)("dateFormat:tz"),a="Browser"===n?Ge.a.tz.guess():n;if(!e)return;const r=new Date(e);return r&&Number.isFinite(r.getTime())?t?Ge.a.tz(r,a).format(t):We.format(r):He}var Ye=n(262);const Ke=Object(a.memo)((function({id:e,nodeID:t,eventCategory:n}){const a=Object(i.useSelector)((n=>u.i(n.analyzer[e])(t))),l=Object(i.useSelector)((t=>u.r(t.analyzer[e]))),c=Object(i.useSelector)((t=>u.j(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):r.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},c||!a?r.a.createElement(o.EuiCallOut,{title:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Je,{id:e,nodeName:a.name,eventCategory:n,nodeID:t}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(Xe,{id:e,eventCategory:n,nodeID:t}))))})),Ze=Object(a.memo)((function({id:e,event:t,nodeID:n,eventCategory:a}){const i=Object(Ye.a)(t),l=ye.g(i),c=ye.e(i),u=ye.p(i),d=Qe(l)||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),p=oe(e,{panelView:"eventDetail",panelParameters:{nodeID:n,eventCategory:a,eventID:c,eventTimestamp:String(l),winlogRecordID:String(u)}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiText,null,r.a.createElement(Y,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:ye.d(i).join(", "),eventType:ye.h(i).join(", ")},defaultMessage:"{category} {eventType}"})),r.a.createElement(K,{dateTime:d},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:d},defaultMessage:"@ {date}"}))),r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiButtonEmpty,qe()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},p),r.a.createElement(Ve,{event:i})))})),Xe=Object(a.memo)((function({id:e,eventCategory:t,nodeID:n}){const l=Object(i.useSelector)((t=>u.y(t.analyzer[e]))),c=Object(i.useDispatch)(),d=Object(a.useCallback)((()=>{c(Object(R.userRequestedAdditionalRelatedEvents)({id:e}))}),[c,e]),p=Object(i.useSelector)((t=>u.q(t.analyzer[e]))),m=Object(i.useSelector)((t=>u.t(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l.map(((i,s)=>r.a.createElement(a.Fragment,{key:s},r.a.createElement(Ze,{id:e,nodeID:n,eventCategory:t,event:i}),s===l.length-1?null:r.a.createElement(o.EuiHorizontalRule,{margin:"m"})))),m&&r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{color:"primary",size:"s",fill:!0,onClick:d,isLoading:p,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Je=Object(a.memo)((function({id:e,nodeName:t,eventCategory:n,nodeID:a}){const o=Object(i.useSelector)((t=>u.M(t.analyzer[e])(a))),l=Object(i.useSelector)((t=>u.D(t.analyzer[e])(a,n))),c=oe(e,{panelView:"nodes"}),d=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),p=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}});return r.a.createElement(ze,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...c},{text:t,...d},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:o},defaultMessage:"{totalCount} Events"}),...p},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:l,category:n},defaultMessage:"{count} {category}"})}]})}));function et({id:e,nodeID:t}){const n=Object(i.useSelector)((n=>he.a(u.w(n.analyzer[e])(t)))),a=Object(i.useSelector)((n=>u.z(n.analyzer[e])(t)));return void 0===n||void 0===a?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):r.a.createElement(me,{hasBorder:!0},r.a.createElement(nt,{id:e,nodeName:ye.l(n),nodeID:t,totalEventCount:a.total}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(tt,{id:e,nodeID:t,relatedStats:a}))}const tt=Object(a.memo)((function({id:e,nodeID:t,relatedStats:n}){const i=Object(a.useMemo)((()=>Object.entries(n.byCategory).map((([e,t])=>({eventType:e,count:t})))),[n.byCategory]),s=Object(a.useMemo)((()=>[{field:"count",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"25%",sortable:!0,render:e=>r.a.createElement(o.EuiToolTip,{position:"top",content:e},r.a.createElement(se.a,{count:e}))},{field:"eventType",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"75%",sortable:!0,render:n=>r.a.createElement(at,{id:e,nodeID:t,eventType:n},n)}]),[t,e]);return r.a.createElement(o.EuiInMemoryTable,{items:i,columns:s,sorting:!0})})),nt=Object(a.memo)((function({id:e,nodeID:t,nodeName:n,totalEventCount:a}){return r.a.createElement(ze,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...oe(e,{panelView:"nodes"})},{text:n,...oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:a},defaultMessage:"{totalCount} Events"}),...oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),at=Object(a.memo)((({id:e,nodeID:t,eventType:n,children:a})=>{const i=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:n}});return r.a.createElement(o.EuiButtonEmpty,qe()({"data-test-subj":"resolver:panel:node-events:event-type-link"},i),a)}));var rt=n(173),it=n(131),ot=n(889);const st=Object(a.memo)((function({id:e,translatedErrorMessage:t}){const n=oe(e,{panelView:"nodes"}),i=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...n},{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[n]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ze,{breadcrumbs:i}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiButtonEmpty,n,E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),lt=p()(ee).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),ct=E.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),ut=Object(a.memo)((function({id:e,nodeID:t}){const n=Object(i.useSelector)((n=>he.a(u.w(n.analyzer[e])(t))));return"loading"===Object(i.useSelector)((n=>u.x(n.analyzer[e])(t)))?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):n?r.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},r.a.createElement(dt,{id:e,nodeID:t,processEvent:n})):r.a.createElement(me,{hasBorder:!0},r.a.createElement(st,{id:e,translatedErrorMessage:ct}))})),dt=Object(a.memo)((function({id:e,processEvent:t,nodeID:n}){const l=ye.l(t),c=Object(i.useSelector)((t=>u.x(t.analyzer[e])(n))),d=Object(i.useSelector)((t=>u.E(t.analyzer[e])(n))),p=ye.g(t),m=Qe(p),f=Object(a.useMemo)((()=>{const e={title:"@timestamp",description:m,value:p},n={title:"process.executable",description:Object(ot.d)(t)},a={title:"process.pid",description:Object(ot.c)(t)},r={title:"user.name",description:ye.o(t)};return[e,n,a,{title:"process.entity_id",description:ye.c(t)},r,{title:"user.domain",description:ye.n(t)},{title:"process.parent.pid",description:ye.k(t)},{title:"process.hash.md5",description:ye.j(t)},{title:"process.args",description:ye.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:String(e.description)})))}),[m,p,t]),g=oe(e,{panelView:"nodes"}),b=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...g},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:l},defaultMessage:"Details for: {processName}"})}]),[l,g]),{descriptionText:y}=X(e,c,!1),h=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}}),v=Object(a.useMemo)((()=>Object(o.htmlIdGenerator)("resolverTable")()),[]),x=[{field:"title","data-test-subj":"resolver:node-detail:entry-title",name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0,render:e=>r.a.createElement(ne,null,e)},{name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.valueTitle",defaultMessage:"Value"}),"data-test-subj":"resolver:node-detail:entry-description",render(t){var n;return r.a.createElement(rt.c,{data:{field:t.title,value:null!==(n=t.value)&&void 0!==n?n:t.description},triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,visibleCellActions:5,sourcererScopeId:Object(it.getSourcererScopeId)(e),metadata:{scopeId:e}},t.description)}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(ze,{breadcrumbs:b}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiTitle,{size:"xs"},r.a.createElement(V,{"aria-describedby":v},r.a.createElement(lt,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:c}),r.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},r.a.createElement(ne,null,l)))),r.a.createElement(o.EuiText,null,r.a.createElement(o.EuiTextColor,{color:"subdued"},r.a.createElement("span",{id:v},y))),r.a.createElement(o.EuiSpacer,{size:"s"}),r.a.createElement(o.EuiLink,qe()({},h,{"data-test-subj":"resolver:node-detail:node-events-link"}),r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:d},defaultMessage:"{relatedEventTotal} Events"})),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiInMemoryTable,{"data-test-subj":"resolver:node-detail",items:f,columns:x,sorting:!0}))})),pt=r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),mt=r.a.memo((function({numberOfEntries:e}){return r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),ft=r.a.memo((function({numberDisplayed:e}){return r.a.createElement(ge,{size:"s",title:r.a.createElement(mt,{numberOfEntries:e})},r.a.createElement("p",null,pt))})),gt=Object(a.memo)((({id:e})=>{const t=Object(a.useMemo)((()=>[{field:"name",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,n)=>r.a.createElement(bt,{id:e,name:t,nodeID:n.nodeID})},{field:"timestamp",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:t=>r.a.createElement(yt,{eventDate:t,id:e})}]),[e]),n=Object(i.useSelector)(Object(a.useCallback)((t=>{const{processNodePositions:n}=u.u(t.analyzer[e]),a=[];for(const e of n.keys()){const t=be.c(e),n=be.b(e);void 0!==n&&a.push({name:t,timestamp:be.a(e),nodeID:n})}return a}),[e])),s=n.length,l=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),c=Object(i.useSelector)((t=>u.m(t.analyzer[e]))),d=Object(i.useSelector)((t=>u.l(t.analyzer[e]))),p=Object(i.useSelector)((t=>u.n(t.analyzer[e]))),m=!0===c||!0===d||!0===p,f=Object(a.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return r.a.createElement(me,{hasBorder:!0},r.a.createElement(ze,{breadcrumbs:l}),m&&r.a.createElement(ft,{numberDisplayed:s}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiInMemoryTable,{rowProps:f,"data-test-subj":"resolver:node-list",items:n,columns:t,sorting:!0}))}));gt.displayName="NodeList";const bt=Object(a.memo)((({id:e,name:t,nodeID:n})=>{const s=Object(i.useSelector)((t=>u.A(t.analyzer[e])===n)),l=Object(i.useSelector)((t=>u.x(t.analyzer[e])(n))),{descriptionText:c}=b(),d=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),p=Object(i.useDispatch)(),{timestamp:m}=Object(a.useContext)(j),f=Object(a.useCallback)((t=>{d.onClick(t),p(Object(le.userSelectedResolverNode)({id:e,nodeID:n,time:m()}))}),[m,d,p,n,e]);return r.a.createElement(o.EuiButtonEmpty,{onClick:f,href:d.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":n},void 0===t?r.a.createElement(o.EuiBadge,{color:"warning"},E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):r.a.createElement(G,null,r.a.createElement(ee,{id:e,state:l,isOrigin:s,"data-test-subj":"resolver:node-list:node-link:icon"}),r.a.createElement(Q,null,s&&r.a.createElement(H,{color:c,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},E.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),r.a.createElement(W,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}));bt.displayName="NodeDetailLink";const yt=Object(a.memo)((({eventDate:e,id:t})=>{const n=Qe(e);return n?r.a.createElement(rt.c,{data:{field:"@timestamp",value:e},triggerId:rt.d.DEFAULT,visibleCellActions:5,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(it.getSourcererScopeId)(t),metadata:{scopeId:t}},n):r.a.createElement("span",null,"—")}));function ht(e){const t=[{path:[],value:e}],n=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:a,value:r}=e;Array.isArray(r)?t.push(...r.map((e=>({path:[...a],value:e})))):"object"==typeof r&&null!==r?t.push(...Object.keys(r).map((e=>({path:[...a,e],value:r[e]})))):null!=r&&n.push([a,r])}return n}yt.displayName="NodeDetailTimestamp";const vt=E.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),Et=Object(a.memo)((function({id:e,nodeID:t,eventCategory:n}){const a=Object(i.useSelector)((t=>u.p(t.analyzer[e]))),o=Object(i.useSelector)((t=>u.s(t.analyzer[e]))),s=Object(i.useSelector)((n=>he.a(u.w(n.analyzer[e])(t)))),l=Object(i.useSelector)((n=>u.x(n.analyzer[e])(t))),c=a||o||"loading"===l,d=Object(i.useSelector)((t=>u.f(t.analyzer[e])));return c?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):d?r.a.createElement(xt,{id:e,nodeID:t,event:d,processEvent:s,eventType:n}):r.a.createElement(me,{hasBorder:!0},r.a.createElement(st,{id:e,translatedErrorMessage:vt}))})),xt=Object(a.memo)((function({id:e,nodeID:t,event:n,eventType:a,processEvent:i}){const l=Qe(ye.m(n))||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),c=i?ye.l(i):null;return r.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},r.a.createElement(Ot,{id:e,nodeID:t,nodeName:c,event:n,breadcrumbEventCategory:a}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiText,{size:"s"},r.a.createElement(Y,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:a,eventType:String(ye.h(n))},defaultMessage:"{category} {eventType}"})),r.a.createElement(K,{dateTime:l},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:l},defaultMessage:"@ {date}"}))),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(St,null,r.a.createElement(ne,null,r.a.createElement(Ve,{event:n}))),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(jt,{event:n,id:e}))}));function jt({event:e,id:t}){const n=Object(a.useMemo)((()=>{const t=[],n=Object(Ye.a)(e);for(const[e,a]of Object.entries(n)){if("agent"===e||"ecs"===e||"@timestamp"===e||!a)continue;const n=ht(a).map((([t,n])=>({title:[e,...t].join("."),description:String(n)})));t.push(...n)}return t}),[e]),i=[{field:"title","data-test-subj":"resolver:panel:event-detail:event-field-title",name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0},{name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.valueTitle",defaultMessage:"Value"}),render:e=>r.a.createElement(rt.c,{data:{field:e.title,value:e.description},visibleCellActions:5,triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(it.getSourcererScopeId)(t),metadata:{scopeId:t}},e.description)}];return r.a.createElement(o.EuiInMemoryTable,{items:n,columns:i,search:{box:{incremental:!0,schema:!0}},pagination:!0,sorting:!0})}function Ot({id:e,nodeID:t,nodeName:n,event:o,breadcrumbEventCategory:l}){const c=Object(i.useSelector)((n=>u.D(n.analyzer[e])(t,l))),d=Object(i.useSelector)((n=>u.E(n.analyzer[e])(t))),p=oe(e,{panelView:"nodes"}),m=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),f=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),g=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:l}}),b=Object(a.useMemo)((()=>{const e=[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...p},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:d},defaultMessage:"{totalCount} Events"}),...f},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:c,category:l},defaultMessage:"{count} {category}"}),...g},{text:r.a.createElement(Ve,{event:o})}];return n&&e.splice(1,0,{text:n,...m}),e}),[l,c,o,m,f,n,d,p,g]);return r.a.createElement(ze,{breadcrumbs:b})}const St=Object(a.memo)(p()(o.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),wt=Object(a.memo)((function({id:e}){const t=Object(i.useSelector)((t=>u.B(t.analyzer[e])));return"nodeDetail"===t.panelView?r.a.createElement(ut,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?r.a.createElement(et,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?r.a.createElement(Ke,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?r.a.createElement(Et,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):r.a.createElement(gt,{id:e})}));var kt=n(959);const It=p()(o.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),Tt=p()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),Ct=()=>r.a.createElement(Tt,{"data-test-subj":"resolver:no-process-events",direction:"column"},r.a.createElement(o.EuiTitle,null,r.a.createElement("h4",null,E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(It,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var Mt=n(123);const _t=r.a.memo(r.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m},f){!function(e){const t=Object(a.useRef)();t.current=Object(l.useLocation)().search;const n=Object(i.useDispatch)(),r=Object(l.useHistory)(),o=Object(c.a)(e);Object(a.useEffect)((()=>{const e=o;return()=>{const n=new URLSearchParams(t.current);n.delete(e);const a={search:n.toString()};r.replace(a)}}),[o,r,n,e])}(n),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:n,filters:r,shouldUpdate:o}){const s=Object(i.useDispatch)(),c=Object(l.useLocation)().search;Object(a.useLayoutEffect)((()=>{s(Object(le.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:c,indices:n,shouldUpdate:o,filters:r}))}),[s,e,t,c,n,o,r])}({databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m}),function({id:e}){const{addSuccess:t}=Object(Mt.a)(),{from:n,to:r}=Object(i.useSelector)((t=>{const n=u.g(t.analyzer[e]);return{from:null!=n&&n.from?n.from:void 0,to:null!=n&&n.to?n.to:void 0}})),o=Qe(n),s=Qe(r),l=Object(a.useMemo)((()=>E.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:o,to:s}})),[o,s]);Object(a.useEffect)((()=>{(n||r)&&t(l)}),[t,l,n,r])}({id:n}),function({id:e}){const t=Object(i.useDispatch)(),n=e,r=Object(l.useLocation)().search,o=Object(a.useContext)(j),s=Object(i.useSelector)((t=>u.J(t.analyzer[e]))),c=Object(i.useSelector)((t=>u.i(t.analyzer[e]))),d=Object(kt.a)({locationSearch:r,resolverComponentInstanceID:n});let p;"nodes"!==d.panelView&&(p=d.panelParameters.nodeID),Object(a.useEffect)((()=>{p&&c(p)&&p!==s&&t(Object(le.userSelectedResolverNode)({id:e,nodeID:p,time:o.timestamp()}))}),[d.panelView,p,t,c,s,o,e])}({id:n});const{timestamp:g}=Object(a.useContext)(j),y=g(),{processNodePositions:h,connectingEdgeLineSegments:x}=Object(i.useSelector)((e=>u.Q(e.analyzer[n])(y))),{projectionMatrix:S,ref:w,onMouseDown:k}=function({id:e}){const t=Object(i.useDispatch)(),n=Object(a.useContext)(j),[r,o]=Object(a.useState)(null),s=Object(i.useSelector)(Object(a.useCallback)((t=>u.C(t.analyzer[e])),[e])),l=Object(a.useRef)(),[c,d]=Object(a.useState)(s(n.timestamp())),p=Object(i.useSelector)((t=>u.P(t.analyzer[e]))),m=Object(i.useSelector)((t=>u.o(t.analyzer[e]))),[f,g]=function(){const{getBoundingClientRect:e}=Object(a.useContext)(j),[t,n]=Object(a.useState)(null),{ResizeObserver:r,requestAnimationFrame:i}=Object(a.useContext)(j),[o,s]=Object(a.useState)(null),l=Object(a.useCallback)((e=>{s(e)}),[]);return Object(a.useEffect)((()=>{null!==o&&n(e(o))}),[o,e]),Object(a.useEffect)((()=>{let t=window.scrollX,a=window.scrollY;const r=()=>{i((()=>{const r=window.scrollX,i=window.scrollY;null===o||t===r&&a===i||n(e(o)),t=r,a=i}))};return window.addEventListener("scroll",r,{passive:!0}),()=>{window.removeEventListener("scroll",r)}}),[o,i,e]),Object(a.useEffect)((()=>{if(null!==o){const t=new r((t=>{null!==o&&o===t[0].target&&n(e(o))}));return t.observe(o),()=>{t.disconnect()}}}),[r,o,e]),[t,l]}(),b=Object(a.useCallback)((e=>null===f?null:[e.clientX-f.x,e.clientY-f.y]),[f]),y=Object(a.useCallback)((a=>{const r=b(a);null!==r&&t(Object(O.userStartedPanning)({id:e,screenCoordinates:r,time:n.timestamp()}))}),[t,b,n,e]),h=Object(a.useCallback)((a=>{const r=b(a);r&&t(Object(O.userMovedPointer)({id:e,screenCoordinates:r,time:n.timestamp()}))}),[t,b,n,e]),v=Object(a.useCallback)((()=>{p&&t(Object(O.userStoppedPanning)({id:e,time:n.timestamp()}))}),[t,n,p,e]),E=Object(a.useCallback)((a=>{null!==f&&a.ctrlKey&&0!==a.deltaY&&0===a.deltaMode&&(a.preventDefault(),t(Object(O.userZoomed)({id:e,zoomChange:a.deltaY/-f.height,time:n.timestamp()})))}),[f,t,n,e]),x=Object(a.useCallback)((e=>{o(e),g(e)}),[g]);return Object(a.useEffect)((()=>(window.addEventListener("mouseup",v,{passive:!0}),()=>{window.removeEventListener("mouseup",v)})),[v]),Object(a.useEffect)((()=>(window.addEventListener("mousemove",h,{passive:!0}),()=>{window.removeEventListener("mousemove",h)})),[h]),Object(a.useEffect)((()=>{if(null!==r)return r.addEventListener("wheel",E),()=>{r.removeEventListener("wheel",E)}}),[r,E]),Object(a.useLayoutEffect)((()=>{l.current=s}),[s]),Object(a.useLayoutEffect)((()=>{d(s(n.timestamp()))}),[s,n]),Object(a.useLayoutEffect)((()=>{const e=n.timestamp();if(m(e)){let e=null;const t=()=>{const a=n.timestamp();void 0!==l.current&&d(l.current(a)),e=m(a)?n.requestAnimationFrame(t):null};return e=n.requestAnimationFrame(t),()=>{null!==e&&n.cancelAnimationFrame(e)}}}),[m,n]),Object(a.useEffect)((()=>{null!==f&&t(Object(O.userSetRasterSize)({id:e,dimensions:[f.width,f.height]}))}),[t,f,e]),{ref:x,onMouseDown:y,projectionMatrix:c}}({id:n}),I=Object(a.useCallback)((e=>{w(e),"function"==typeof f?f(e):null!==f&&(f.current=e)}),[w,f]),T=Object(i.useSelector)((e=>u.s(e.analyzer[n]))),C=Object(i.useSelector)((e=>u.k(e.analyzer[n]))),M=Object(i.useSelector)((e=>u.b(e.analyzer[n]))),_=Object(i.useSelector)((e=>u.G(e.analyzer[n]))),D=b();return r.a.createElement(pe,{className:e,backgroundColor:D.resolverBackground},T?r.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},r.a.createElement(o.EuiLoadingSpinner,{size:"xl"})):C?r.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},r.a.createElement("div",null," ",r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):_?r.a.createElement(r.a.Fragment,null,r.a.createElement(fe,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:k,ref:I,role:"tree",tabIndex:0,"aria-activedescendant":M||void 0},x.map((({points:[e,t],metadata:n})=>r.a.createElement(v,{edgeLineMetadata:n,key:n.reactKey,startPosition:e,endPosition:t,projectionMatrix:S}))),[...h].map((([e,t])=>{const a=be.b(e);if(void 0===a)throw new Error("Tried to render a node without an ID");return r.a.createElement(Se,{id:n,key:a,nodeID:a,position:t,projectionMatrix:S,node:e,timeAtRender:y})}))),r.a.createElement(wt,{id:n})):r.a.createElement(Ct,null),r.a.createElement(ie,{id:n}),r.a.createElement(Pe,{id:n}))})))},function(e,t,n){"use strict";n.d(t,"b",(function(){return ce})),n.d(t,"a",(function(){return de}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(75),l=n(45),c=n(13),u=n(363),d=n(444),p=n(41),m=n.n(p);const f=m.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-1xzawmf-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS));f.displayName="Field";const g=o.a.memo((({fieldId:e,fieldWidth:t})=>o.a.createElement(f,{"data-test-subj":"field",width:t},e)));g.displayName="DraggableFieldBadge";var b=n(222),y=n(180),h=n(19),v=n(1306),E=n(128),x=n(1260),j=n(266),O=n(146),S=n(137),w=n(191),k=n(44),I=n(53),T=n(124),C=n(129),M=n(522);const _=o.a.memo((({columnId:e,onColumnRemoved:t})=>{const n=Object(i.useCallback)((n=>{n.preventDefault(),n.stopPropagation(),t(e)}),[e,t]);return o.a.createElement(h.EuiButtonIcon,{"aria-label":M.f,color:"text","data-test-subj":"remove-column",iconType:"cross",onClick:n})}));_.displayName="CloseButton";const D=o.a.memo((({header:e,onColumnRemoved:t,sort:n,isLoading:a})=>o.a.createElement(o.a.Fragment,null,n.some((t=>t.columnId===e.id))&&a?o.a.createElement(y.d,{className:"siemEventsHeading__extra--loading"},o.a.createElement(y.h,{"data-test-subj":"timeline-loading-spinner"})):o.a.createElement(y.d,{className:"siemEventsHeading__extra--close"},o.a.createElement(_,{columnId:e.id,onColumnRemoved:t})))));D.displayName="Actions";const N=m()(h.EuiFieldText).withConfig({displayName:"FieldText",componentId:"sc-14rl5n4-0"})(["min-width:",";"],(e=>e.minwidth));N.displayName="FieldText";const A=o.a.memo((({columnId:e,minWidth:t,filter:n="",onFilterChange:a=k.noop,placeholder:r="Filter"})=>o.a.createElement(N,{"data-test-subj":"textFilter",minwidth:`${t}px`,placeholder:r,value:n,onChange:t=>{a({columnId:e,filter:t.target.value})}})));A.displayName="TextFilter";const F=o.a.memo((({header:e,onFilterChange:t=k.noop})=>{var n;return"text-filter"===e.columnHeaderType?o.a.createElement(A,{columnId:e.id,minWidth:null!==(n=e.initialWidth)&&void 0!==n?n:j.a,onFilterChange:t,placeholder:e.placeholder}):null}));F.displayName="Filter";const P=({header:e,sort:t})=>t.reduce(((t,n)=>e.id===n.columnId?n.sortDirection:t),"none"),R=({header:e,sort:t})=>t.findIndex((t=>t.columnId===e.id));var L=n(424),q=n(432);const z=o.a.memo((({sortNumber:e})=>e>=0?o.a.createElement(h.EuiNotificationBadge,{color:"subdued","data-test-subj":"sortNumber"},e+1):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortEmptyNumber",type:"empty"})));z.displayName="SortNumber";var B=function(e){return e.SORT_UP="sortUp",e.SORT_DOWN="sortDown",e}(B||{});const $=o.a.memo((({sortDirection:e,sortNumber:t})=>{const n=(e=>{switch(e){case S.b.asc:return B.SORT_UP;case S.b.desc:return B.SORT_DOWN;case"none":return;default:throw new Error("Unhandled sort direction")}})(e);return null!=n?o.a.createElement(h.EuiToolTip,{content:n===B.SORT_UP?q.e:q.f,"data-test-subj":"sort-indicator-tooltip"},o.a.createElement(o.a.Fragment,null,o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:n}),o.a.createElement(z,{sortNumber:t}))):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:"empty"})}));$.displayName="SortIndicator";var V=n(284);const U=m()(h.EuiIcon).withConfig({displayName:"IconType",componentId:"sc-1mjgpab-0"})(["margin-right:3px;position:relative;top:-2px;"]);U.displayName="IconType";const G=m.a.span.withConfig({displayName:"P",componentId:"sc-1mjgpab-1"})(["margin-bottom:5px;"]);G.displayName="P";const H=m.a.span.withConfig({displayName:"ToolTipTableMetadata",componentId:"sc-1mjgpab-2"})(["margin-right:5px;display:block;font-weight:bold;"]);H.displayName="ToolTipTableMetadata";const W=m.a.span.withConfig({displayName:"ToolTipTableValue",componentId:"sc-1mjgpab-3"})(["word-wrap:break-word;"]);W.displayName="ToolTipTableValue";const Q=o.a.memo((({header:e})=>{var t;return o.a.createElement(o.a.Fragment,null,!Object(k.isEmpty)(e.category)&&o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"category"},M.a,":"),o.a.createElement(W,{"data-test-subj":"category-value"},e.category)),o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"field"},M.c,":"),o.a.createElement(W,{"data-test-subj":"field-value"},e.id)),o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"type"},M.i,":"),o.a.createElement(W,null,o.a.createElement(U,{"data-test-subj":"type-icon",type:Object(V.d)(e.type)}),null===(t=e.esTypes)||void 0===t?void 0:t.map((e=>o.a.createElement(h.EuiBadge,{"data-test-subj":`type-value-${e}`,key:e},e))))),!Object(k.isEmpty)(e.description)&&o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"description"},M.b,":"),o.a.createElement(W,{"data-test-subj":"description-value"},e.description)))}));Q.displayName="HeaderToolTipContent";const Y=({children:e,header:t,isLoading:n,isResizing:a,onClick:r,showSortingCapability:i,sort:s})=>{var l,c;return o.a.createElement(y.c,{"data-test-subj":`header-${t.id}`,isLoading:n},t.aggregatable&&i?o.a.createElement(y.f,{"data-test-subj":"header-sort-button",onClick:a||n?k.noop:r},o.a.createElement(L.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Q,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(l=t.displayAsText)&&void 0!==l?l:t.id))),o.a.createElement($,{"data-test-subj":"header-sort-indicator",sortDirection:P({header:t,sort:s}),sortNumber:R({header:t,sort:s})})):o.a.createElement(y.g,null,o.a.createElement(L.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Q,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(c=t.displayAsText)&&void 0!==c?c:t.id)))),e)},K=o.a.memo(Y);var Z=n(57),X=n(169);const J=({header:e,onFilterChange:t=k.noop,sort:n,timelineId:a})=>{const r=Object(l.useDispatch)(),s=Object(i.useMemo)((()=>Object(Z.createSelector)(X.selectTimeline,(e=>(null==e?void 0:e.activeTab)===O.d.eql))),[]),c=Object(T.b)((e=>s(e,a))),u=Object(i.useCallback)((()=>{var t,i;const o=e.id,s=null!==(t=e.type)&&void 0!==t?t:"",l=null!==(i=e.esTypes)&&void 0!==i?i:[],c=(({clickedHeader:e,currentSort:t})=>t.reduce(((t,n)=>e.id===n.columnId?(e=>{switch(e.sortDirection){case S.b.desc:return S.b.asc;case S.b.asc:default:return S.b.desc}})(n):t),S.b.desc))({clickedHeader:e,currentSort:n}),u=n.findIndex((e=>e.columnId===o));let d=[];d=-1===u?[...n,{columnId:o,columnType:s,esTypes:l,sortDirection:c}]:[...n.slice(0,u),{columnId:o,columnType:s,esTypes:l,sortDirection:c},...n.slice(u+1)],r(C.a.updateSort({id:a,sort:d}))}),[r,e,n,a]),d=Object(i.useCallback)((e=>r(C.a.removeColumn({id:a,columnId:e}))),[r,a]),p=Object(i.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),{isLoading:m}=Object(T.a)((e=>p(e,a)||{isLoading:!1})),f=!c&&!Object(I.isDataViewFieldSubtypeNested)(e);return o.a.createElement(o.a.Fragment,null,o.a.createElement(K,{header:e,isLoading:m,isResizing:!1,onClick:u,showSortingCapability:f,sort:n},o.a.createElement(D,{header:e,isLoading:m,onColumnRemoved:d,sort:n})),o.a.createElement(F,{header:e,onFilterChange:t}))},ee=o.a.memo(J),te=m()(h.EuiContextMenu).withConfig({displayName:"ContextMenu",componentId:"sc-wn02ez-0"})(["width:115px;& .euiContextMenuItem{font-size:12px;padding:4px 8px;width:115px;}"]),ne=m.a.div.withConfig({displayName:"PopoverContainer",componentId:"sc-wn02ez-1"})(["& .euiPopover{padding-right:8px;width:","px;}"],(({$width:e})=>e)),ae={right:!0},re=({draggableIndex:e,header:t,timelineId:n,isDragging:a,onFilterChange:c,sort:u,tabType:d})=>{const p=Object(i.useRef)(null),[m,f]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()}),[]),k=Object(l.useDispatch)(),I=Object(i.useMemo)((()=>{var e;return{width:null!==(e=t.initialWidth)&&void 0!==e?e:j.a,height:"auto"}}),[t.initialWidth]),T=Object(i.useMemo)((()=>({position:a?"absolute":"relative"})),[a]),_=Object(i.useMemo)((()=>({right:o.a.createElement(y.e,null)})),[]),D=Object(i.useCallback)(((e,a,r,i)=>{k(C.a.applyDeltaToColumnWidth({columnId:t.id,delta:i.width,id:n}))}),[k,t.id,n]),N=Object(i.useMemo)((()=>Object(b.j)({contextId:`timeline-column-headers-${d}-${n}`,fieldId:t.id})),[d,n,t.id]),A=Object(i.useCallback)((e=>{var a,r;const i=t.id,o=null!==(a=t.type)&&void 0!==a?a:"",s=null!==(r=t.esTypes)&&void 0!==r?r:[],l=u.findIndex((e=>e.columnId===i)),c=-1===l?[...u,{columnId:i,columnType:o,esTypes:s,sortDirection:e}]:[...u.slice(0,l),{columnId:i,columnType:o,esTypes:s,sortDirection:e},...u.slice(l+1)];k(C.a.updateSort({id:n,sort:c}))}),[k,t,u,n]),F=Object(i.useCallback)((()=>{f(!1),g()}),[g]),P=Object(i.useMemo)((()=>[{id:0,items:[{icon:o.a.createElement(h.EuiIcon,{type:"eyeClosed",size:"s"}),name:M.e,onClick:()=>{k(C.a.removeColumn({id:n,columnId:t.id})),F()}},...d!==O.d.eql?[{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortUp",size:"s"}),name:M.g,onClick:()=>{A(S.b.asc),F()}},{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortDown",size:"s"}),name:M.h,onClick:()=>{A(S.b.desc),F()}}]:[]]}]),[k,F,t.aggregatable,t.id,A,d,n]),R=Object(i.useMemo)((()=>o.a.createElement(ee,{timelineId:n,header:t,onFilterChange:c,sort:u})),[t,c,u,n]),L=Object(i.useCallback)((e=>{var n;return o.a.createElement(y.o,r()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(y.p,null,o.a.createElement(ne,{$width:null!==(n=t.initialWidth)&&void 0!==n?n:j.a},o.a.createElement(h.EuiPopover,{anchorPosition:"downLeft",button:R,closePopover:F,isOpen:m,ownFocus:!0,panelPaddingSize:"none"},o.a.createElement(te,{initialPanelId:0,panels:P})))))}),[F,R,t.initialWidth,m,P]),q=Object(i.useCallback)((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),[]),z=Object(i.useCallback)((()=>{f(!0)}),[]),{onBlur:B,onKeyDown:$}=Object(x.a)({closePopover:F,draggableId:N,fieldName:t.id,keyboardHandlerRef:p,openPopover:z}),V=Object(i.useCallback)((e=>{m||$(e)}),[m,$]);return o.a.createElement(v.Resizable,{enable:ae,size:I,style:T,handleComponent:_,onResizeStop:D},o.a.createElement("div",{"aria-colindex":null!=e?e+w.b:void 0,className:E.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:q,onBlur:B,onKeyDown:V,ref:p,role:"columnheader",tabIndex:0},o.a.createElement(s.Draggable,{"data-test-subj":"draggable",disableInteractiveElementBlocking:!0,draggableId:N,index:e,key:t.id},L)))},ie=o.a.memo(re);var oe=n(127),se=n(1201);const le=o.a.memo((({children:e,onMount:t,onUnmount:n})=>(Object(i.useEffect)((()=>(t(),()=>n())),[t,n]),o.a.createElement(o.a.Fragment,null,e))));le.displayName="DraggableContainer";const ce=({globalFullScreen:e,isActiveTimelines:t,timelineFullScreen:n})=>t&&n||!1===t&&e,ue=({actionsColumnWidth:e,browserFields:t,columnHeaders:n,isEventViewer:a=!1,isSelectAllChecked:d,onSelectAll:p,show:m,showEventsSelect:f,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,leadingControlColumns:j,trailingControlColumns:O})=>{const S=Object(l.useDispatch)(),[w,k]=Object(i.useState)(null),I=Object(i.useRef)(null);Object(i.useEffect)((()=>()=>{I.current&&I.current.closeEditor()}),[]),Object(i.useEffect)((()=>{!m&&I.current&&I.current.closeEditor()}),[m]);const T=Object(i.useCallback)(((e,t,a)=>{const i=a.source.index,s=n[i];return o.a.createElement(y.o,r()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(le,{onMount:()=>k(i),onUnmount:()=>k(null)},o.a.createElement(u.a,null,o.a.createElement(g,{fieldId:s.id,fieldWidth:s.initialWidth}))))}),[n,k]),C=Object(i.useMemo)((()=>n.map(((e,t)=>o.a.createElement(ie,{key:e.id,draggableIndex:t,timelineId:x,header:e,isDragging:w===t,sort:v,tabType:E})))),[n,x,w,v,E]),M=Object(i.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,o.a.createElement(y.r,r()({"data-test-subj":"headers-group",ref:e.innerRef,isDragging:t.isDraggingOver},e.droppableProps),C))),[C]),_=Object(i.useMemo)((()=>j?j.map((e=>e.headerCellRender)):[]),[j]),D=Object(i.useMemo)((()=>O?O.map((e=>e.headerCellRender)):[]),[O]),N=Object(se.a)({sourcererScope:oe.SourcererScopeName.timeline,editorActionsRef:I,upsertColumn:(e,t)=>S(Object(c.upsertColumn)({column:e,id:x,index:t})),removeColumn:e=>S(Object(c.removeColumn)({columnId:e,id:x}))}),A=Object(i.useMemo)((()=>_.map(((r,i)=>{const s=j[i]&&j[i].width||e;return o.a.createElement(y.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:a,key:i},r&&o.a.createElement(r,{width:s,browserFields:t,columnHeaders:n,isEventViewer:a,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:f,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:N}))}))),[_,j,e,t,n,N,a,d,p,f,h,v,E,x]),F=Object(i.useMemo)((()=>D.map(((r,i)=>{const s=O[i]&&O[i].width||e;return o.a.createElement(y.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:a,key:i},r&&o.a.createElement(r,{width:s,browserFields:t,columnHeaders:n,isEventViewer:a,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:f,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:N}))}))),[D,O,e,t,n,N,a,d,p,f,h,v,E,x]);return o.a.createElement(y.s,{"data-test-subj":"column-headers"},o.a.createElement(y.v,null,A,o.a.createElement(s.Droppable,{direction:"horizontal",droppableId:`${b.f}-${E}.${x}`,isDropDisabled:!1,type:b.a,renderClone:T},M),F))},de=o.a.memo(ue)},function(e,t,n){"use strict";n.d(t,"a",(function(){return te})),n.d(t,"b",(function(){return ne}));var a=n(2),r=n.n(a),i=n(19),o=n(42),s=n(153),l=n(1781),c=n(344),u=n(748),d=n(4),p=n(122);const m=({tooltip:e,anchorPosition:t="top",children:n})=>r.a.createElement(i.EuiToolTip,{content:e,position:t},n);var f=n(298),g=n(47),b=n(7),y=n(118),h=n(11);const v=[5,10,20],E={pageIndex:0,pageSize:v[0]},x=(e,t)=>t,j={sort:{field:"@timestamp",direction:"desc"},enableAllColumns:!0},O=(e,t)=>({...e,sort:t}),S=e=>{const{setPagination:t,pagination:n,pageSizeOptions:r}=(()=>{const[e,t]=Object(a.useReducer)(x,E);return Object(a.useMemo)((()=>({pageSizeOptions:[...v],pagination:e,setPagination:t})),[e])})(),{sorting:i,sortConfig:o,setSorting:s}=(()=>{const[e,t]=Object(a.useReducer)(O,j),n=Object(a.useMemo)((()=>[{[e.sort.field]:e.sort.direction}]),[e.sort.direction,e.sort.field]);return{sorting:e,setSorting:t,sortConfig:n}})(),{data:l,totalItemCount:c,loading:u,error:d}=(({alertIds:e,from:t,size:n,sort:r})=>{const{services:{data:i}}=Object(y.j)(),o=Object(a.useMemo)((()=>{return e=i.search,async({signal:t,alertIds:n,from:a,size:r,sort:i})=>new Promise(((o,s)=>{const l=e.search({params:{body:{query:{ids:{values:n}},from:a,size:r,sort:i,fields:["*"],_source:!1}}},{abortSignal:t}).subscribe({next:e=>{Object(h.isRunningResponse)(e)||(l.unsubscribe(),o(e.rawResponse))},error:e=>{l.unsubscribe(),s(new Error("Error while loading alerts"))}})}));var e}),[i.search]),{data:s,isLoading:l,isError:c}=Object(g.useQuery)(["useFetchAlerts",e,t,n,r],(async({signal:a})=>o({signal:a,alertIds:e,from:t,size:n,sort:r})),{keepPreviousData:!0});return Object(a.useMemo)((()=>{var e,t;const n=null==s||null===(e=s.hits)||void 0===e?void 0:e.total;return{loading:l,error:c,data:(null==s||null===(t=s.hits)||void 0===t?void 0:t.hits)||[],totalItemCount:Object(b.isNumber)(n)?n:0}}),[s,c,l])})({alertIds:e,from:n.pageIndex*n.pageSize,size:n.pageSize,sort:o});return{paginationConfig:Object(a.useMemo)((()=>({...n,pageSizeOptions:r,totalItemCount:c})),[r,n,c]),setPagination:t,setSorting:s,loading:u,data:l,sorting:i,error:d}};var w=n(202),k=n(263),I=n(172),T=n(302),C=n(1295);const M=({title:e,loading:t,alertIds:n,scopeId:s,eventId:d,noItemsMessage:g,"data-test-subj":b})=>{const{setPagination:y,setSorting:h,data:v,loading:E,paginationConfig:x,sorting:j,error:O}=S(n||[]),T=!Object(p.a)("entityAlertPreviewDisabled"),M=Object(a.useCallback)((({page:e,sort:t})=>{if(e){const{index:t,size:n}=e;y({pageIndex:t,pageSize:n})}t&&h(t)}),[y,h]),N=Object(a.useMemo)((()=>v.map((e=>{var t;return{fields:null!==(t=e.fields)&&void 0!==t?t:{},id:e._id,index:e._index}})).map((e=>{const t=Object.keys(e.fields).reduce(((t,n)=>{var a,r,i;return t[n]=(null===(a=e.fields)||void 0===a||null===(r=a[n])||void 0===r?void 0:r[0])||(null===(i=e.fields)||void 0===i?void 0:i[n]),t}),{});return t.id=e.id,t.index=e.index,t}))),[v]),A=Boolean(n&&n.length&&n.length>=5),F=Object(a.useMemo)((()=>A?null:D(s,d,n)),[n,A,s,d]),P=Object(a.useMemo)((()=>A?_(n):null),[n,A]),R=Object(a.useMemo)((()=>[...T?[{render:e=>r.a.createElement(C.a,{id:e.id,indexName:e.index,"data-test-subj":`${b}AlertPreviewButton`,scopeId:s}),width:"5%"}]:[],{field:"@timestamp",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.timestampColumnLabel",defaultMessage:"Timestamp"}),truncateText:!0,dataType:"date",render:e=>{const t=Object(i.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS");return r.a.createElement(m,{tooltip:t},r.a.createElement("span",null,t))}},{field:u.r,name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ruleColumnLabel",defaultMessage:"Rule"}),truncateText:!0,render:e=>r.a.createElement(m,{tooltip:e},r.a.createElement("span",null,e))},{field:u.m,name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.reasonColumnLabel",defaultMessage:"Reason"}),truncateText:!0,render:e=>r.a.createElement(m,{tooltip:e,anchorPosition:"left"},r.a.createElement("span",null,e))},{field:"kibana.alert.severity",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.severityColumnLabel",defaultMessage:"Severity"}),truncateText:!0,render:e=>{const t=l.a.decode(e),n=Object(c.isRight)(t)?r.a.createElement(f.a,{value:t.right}):r.a.createElement("p",null,e);return r.a.createElement(m,{tooltip:e},n)}}]),[T,s,b]);return r.a.createElement(w.a,{header:{title:e,iconType:"warning",headerContent:n&&n.length&&n.length>0?r.a.createElement("div",{"data-test-subj":`${b}InvestigateInTimeline`},r.a.createElement(k.a,{dataProviders:F,filters:P,asEmptyButton:!0,iconType:"timeline"},I.i)):null},content:{error:O},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":b},r.a.createElement(i.EuiBasicTable,{"data-test-subj":`${b}Table`,loading:t||E,items:N,columns:R,pagination:x,sorting:j,onChange:M,noItemsMessage:g}))},_=e=>e&&e.length?[{meta:{alias:d.i18n.translate("xpack.securitySolution.flyout.left.insights.correlations.tableFilterLabel",{defaultMessage:"Correlations Details Table Alert IDs."}),type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null,D=(e,t,n)=>n&&n.length?n.reduce(((n,a,r)=>{const i=`${e}-${t}-event.id-${r}-${a}`;return n.push(Object(T.a)("_id",i,a)),n}),[]):null;var N=n(609);const A=({entityId:e,scopeId:t,eventId:n})=>{const{loading:a,error:i,data:l,dataCount:c}=Object(N.a)({entityId:e,scopeId:t});return i?null:r.a.createElement(M,{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by session",values:{count:c}}),loading:a,alertIds:l,scopeId:t,eventId:n,noItemsMessage:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsNoDataDescription",defaultMessage:"No alerts related by session."}),"data-test-subj":s.g})};A.displayName="RelatedAlertsBySession";var F=n(610);const P=({originalEventId:e,scopeId:t,eventId:n})=>{const{loading:a,data:i,dataCount:l}=Object(F.a)({originalEventId:e,scopeId:t});return r.a.createElement(M,{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by source event",values:{count:l}}),loading:a,alertIds:i,scopeId:t,eventId:n,noItemsMessage:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsNoDataDescription",defaultMessage:"No related source events."}),"data-test-subj":s.h})};P.displayName="RelatedAlertsBySameSourceEvent";var R=n(144),L=n(611);const q=({eventId:e})=>{const{loading:t,error:n,data:l,dataCount:c}=Object(L.a)({eventId:e}),u=Object(a.useMemo)((()=>(e=>[{field:"title",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.nameColumnLabel",defaultMessage:"Name"}),render:(t,n)=>{const a=e.findIndex((e=>e.id===n.id));return r.a.createElement(m,{tooltip:n.title},r.a.createElement(R.a,{detailName:n.id,title:n.title,index:a},n.title))}},{field:"status",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.statusColumnLabel",defaultMessage:"Status"}),truncateText:!0,width:"25%"}])(l)),[l]);return n?null:r.a.createElement(w.a,{header:{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesTitle",defaultMessage:"{count} related {count, plural, one {case} other {cases}}",values:{count:c}}),iconType:"warning"},content:{error:n},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":s.j},r.a.createElement(i.EuiInMemoryTable,{loading:t,items:l,columns:u,pagination:!0,message:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesNoDataDescription",defaultMessage:"No related cases."}),"data-test-subj":s.i}))};q.displayName="RelatedCases";var z=n(612),B=n(613),$=n(614),V=n(125),U=n(615),G=n(616),H=n(617);const W=({documentId:e,indices:t,scopeId:n})=>{const{loading:a,error:i,data:l,dataCount:c}=Object(H.a)({documentId:e,indices:t,scopeId:n});return i?null:r.a.createElement(M,{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by ancestry",values:{count:c}}),loading:a,alertIds:l,scopeId:n,eventId:e,noItemsMessage:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsNoDataDescription",defaultMessage:"No alerts related by ancestry."}),"data-test-subj":s.f})};W.displayName="RelatedAlertsByAncestry";var Q=n(813),Y=n(253),K=n(730),Z=n(165);const X=({dataAsNestedObject:e,alertSuppressionCount:t,isPreview:n})=>{var a;const l=null===(a=Object(b.get)(e,Q.o))||void 0===a?void 0:a[0],c=r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.suppressedAlertsTitle",defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:t}})),Object(Z.l)(l)?null:r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiBetaBadge,{label:Y.w,style:{verticalAlign:"middle"},size:"s","data-test-subj":s.M}))),u=t>0&&!n&&r.a.createElement("div",{"data-test-subj":`${s.k}InvestigateInTimeline`},r.a.createElement(K.a,{ecsRowData:e,buttonType:"emptyButton"}));return r.a.createElement(w.a,{header:{title:c,iconType:"layers",headerContent:u},"data-test-subj":s.k})};X.displayName="SuppressedAlerts";var J=n(277),ee=n(131);const te="correlations",ne=()=>{const{dataAsNestedObject:e,eventId:t,getFieldsData:n,scopeId:a,isPreview:l}=Object(V.b)(),{selectedPatterns:c}=Object(J.a)(Object(ee.isActiveTimeline)(a)),{show:u,documentId:d}=Object(B.a)({getFieldsData:n,dataAsNestedObject:e,eventId:t,isPreview:l}),{show:p,originalEventId:m}=Object(U.a)({eventId:t,getFieldsData:n}),{show:f,entityId:g}=Object(G.a)({getFieldsData:n}),b=Object(z.a)({getFieldsData:n}),{show:y,alertSuppressionCount:h}=Object($.a)({getFieldsData:n}),v=u||p||f||b||y;return r.a.createElement(i.EuiPanel,{paddingSize:"none","data-test-subj":s.l,color:"transparent"},v?r.a.createElement(i.EuiFlexGroup,{gutterSize:"l",direction:"column"},y&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(X,{alertSuppressionCount:h,dataAsNestedObject:e,isPreview:l})),b&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(q,{eventId:t})),p&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(P,{originalEventId:m,scopeId:a,eventId:t})),f&&g&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(A,{entityId:g,scopeId:a,eventId:t})),u&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(W,{indices:c,scopeId:a,documentId:d}))):r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};ne.displayName="CorrelationsDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(5);const r=`${a.Lb}/fleet/integrations/all`,i=`${a.Lb}/fleet/integrations/installed`},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return v}));var a=n(2),r=n.n(a),i=n(78),o=n(242),s=n(65),l=n(36),c=n(118),u=n(267),d=n(393),p=n(66),m=n(194);let f=function(e){return e.addToExistingCase="addToExistingCase",e.addToNewCase="addToNewCase",e.inspect="inspect",e.openInLens="openInLens",e.saveToLibrary="saveToLibrary",e}({});const g=[f.inspect,f.addToNewCase,f.addToExistingCase,f.saveToLibrary,f.openInLens],b=[f.inspect],y={id:"VISUALIZATION_CONTEXT_MENU_TRIGGER"},h={[f.inspect]:{id:f.inspect,getDisplayName:()=>u.k,getIconType:()=>"inspect",type:"actionButton",order:4},[f.addToNewCase]:{id:f.addToNewCase,getDisplayName:()=>u.d,getIconType:()=>"casesApp",type:"actionButton",order:3},[f.addToExistingCase]:{id:f.addToExistingCase,getDisplayName:()=>u.c,getIconType:()=>"casesApp",type:"actionButton",order:2},[f.saveToLibrary]:{id:f.saveToLibrary,getDisplayName:()=>u.a,getIconType:()=>"save",type:"actionButton",order:1},[f.openInLens]:{id:f.openInLens,getDisplayName:()=>u.m,getIconType:()=>"visArea",type:"actionButton",order:0}},v=({attributes:e,lensMetadata:t,extraActions:n,inspectActionProps:b,timeRange:y,withActions:v=g})=>{const{services:E}=Object(o.c)(),{lens:{navigateToPrefilledEditor:x,canUseEditor:j}}=E,O=Object(a.useCallback)((()=>{y&&e&&x({id:"",timeRange:y,attributes:e},{openInNewTab:!0})}),[e,x,y]),{disabled:S,onAddToExistingCaseClicked:w}=(({onAddToCaseClicked:e,lensAttributes:t,timeRange:n,lensMetadata:r})=>{const{cases:i}=Object(c.j)().services,o=i.helpers.canUseCases([l.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:n,metadata:r},persistableStateAttachmentTypeId:s.LENS_ATTACHMENT_TYPE,type:s.AttachmentType.persistableState}]),[t,r,n]),{open:p}=i.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:u.b}});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),p({getAttachments:()=>d})}),[d,e,p]),disabled:null==t||null==n||!o.create||!o.read}})({lensAttributes:e,timeRange:y,lensMetadata:t}),{onAddToNewCaseClicked:k,disabled:I}=(({onClick:e,timeRange:t,lensAttributes:n,lensMetadata:r})=>{const{cases:i}=Object(c.j)().services,o=i.helpers.canUseCases([l.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:n,timeRange:t,metadata:r},persistableStateAttachmentTypeId:s.LENS_ATTACHMENT_TYPE,type:s.AttachmentType.persistableState}]),[n,r,t]),{open:p}=i.hooks.useCasesAddToNewCaseFlyout({toastContent:u.b});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),p({attachments:d})}),[d,p,e]),disabled:null==n||null==t||!o.create||!o.read}})({timeRange:y,lensAttributes:e,lensMetadata:t}),{openSaveVisualizationFlyout:T,disableVisualizations:C}=(({attributes:e})=>{const t=Object(c.j)().services,{SaveModalComponent:n,canUseEditor:i}=t.lens,o=Object(m.m)(),{redirectTo:s,getEditOrCreateDashboardPath:u}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(c.k)(),n=Object(a.useMemo)((()=>`${e({deepLinkId:l.SecurityPageName.dashboards})}`),[e]),r=Object(a.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),i=Object(a.useCallback)((t=>`${e({deepLinkId:l.SecurityPageName.dashboards,path:r(t)})}`),[r,e]);return{redirectTo:Object(a.useCallback)((e=>{"listing"===e.destination&&t({url:n}),"dashboard"===e.destination&&t({url:i(e.id)})}),[n,i,t]),getEditOrCreateDashboardPath:r,getEditOrCreateDashboardUrl:i,dashboardListingUrl:n}})({getSecuritySolutionUrl:o});return{openSaveVisualizationFlyout:Object(a.useCallback)((()=>{const a=document.createElement("div");Object(d.a)(r.a.createElement(n,{initialInput:e,onSave:()=>Object(p.unmountComponentAtNode)(a),onClose:()=>Object(p.unmountComponentAtNode)(a),originatingApp:l.APP_UI_ID,getOriginatingPath:e=>`${l.SecurityPageName.dashboards}/${u(e)}`,redirectTo:s}),t)(a)}),[n,e,u,s,t]),disableVisualizations:Object(a.useMemo)((()=>!i()||null==e),[e,i])}})({attributes:e});return Object(a.useMemo)((()=>[Object(i.createAction)({...h[f.inspect],execute:async()=>{b.handleInspectClick()},disabled:b.isInspectButtonDisabled,isCompatible:async()=>v.includes(f.inspect)}),Object(i.createAction)({...h[f.addToNewCase],execute:async()=>{k()},disabled:I,isCompatible:async()=>v.includes(f.addToNewCase)}),Object(i.createAction)({...h[f.addToExistingCase],execute:async()=>{w()},disabled:S,isCompatible:async()=>v.includes(f.addToExistingCase),order:2}),Object(i.createAction)({...h[f.saveToLibrary],execute:async()=>{T()},disabled:C,isCompatible:async()=>v.includes(f.saveToLibrary),order:1}),Object(i.createAction)({...h[f.openInLens],execute:async()=>{O()},isCompatible:async()=>j()&&v.includes(f.openInLens),order:0}),...null!=n?n:[]].map(((e,t,n)=>({...e,order:Math.max(n.length-(1+t),0)})))),[j,C,n,b,S,I,w,k,O,T,v])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return _e}));var a=n(44),r=n(2),i=n.n(r),o=n(121),s=n(315),l=n(19),c=n(134),u=n(316),d=n(278),p=n(150),m=n(317),f=n(593),g=n(836);const b=e=>null==e||"unset"===e.toLowerCase(),y=i.a.memo((({contextId:e,eventId:t,primary:n,secondary:a,isDraggable:r})=>b(n)&&b(a)?null:!b(n)&&b(a)?i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:r,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):b(n)&&!b(a)||n===a?i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:r,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):i.a.createElement(l.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:r,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(p.c,{grow:!1,component:"span"},u.i),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:r,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))));y.displayName="PrimarySecondary";const h=i.a.memo((({contextId:e,eventId:t,userName:n,primary:a,secondary:r,isDraggable:o})=>b(n)&&b(a)&&b(r)?null:b(n)||b(a)||b(r)||n!==a||n!==r?!b(n)&&b(a)&&b(r)?i.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):i.a.createElement(y,{contextId:e,eventId:t,isDraggable:o,primary:a,secondary:r}):i.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})));h.displayName="PrimarySecondaryUserInfo";const v=i.a.memo((({eventId:e,contextId:t,hostName:n,userName:a,primary:r,secondary:o,workingDirectory:s,session:l,isDraggable:d})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(p.c,{grow:!1,component:"span"},u.Vb),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.session",value:l,iconType:"number",isDraggable:d,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(h,{contextId:t,eventId:e,userName:a,primary:r,secondary:o,isDraggable:d})),null!=n&&i.a.createElement(p.c,{grow:!1,component:"span"},"@"),i.a.createElement(g.a,{contextId:t,eventId:e,workingDirectory:s,hostName:n,isDraggable:d}))));v.displayName="SessionUserHostWorkingDir";const E=i.a.memo((({id:e,contextId:t,hostName:n,userName:a,primary:r,processName:o,processPid:s,processExecutable:d,processTitle:g,secondary:b,workingDirectory:y,args:h,result:E,session:x,text:j,isDraggable:O})=>i.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(v,{eventId:e,contextId:t,hostName:n,userName:a,primary:r,secondary:b,workingDirectory:y,session:x,isDraggable:O}),null!=d&&i.a.createElement(p.c,{grow:!1,component:"span"},j),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,processPid:s,processName:o,processExecutable:d,isDraggable:O})),i.a.createElement(f.a,{eventId:e,args:h,contextId:t,isDraggable:O,processTitle:g}),null!=E&&i.a.createElement(p.c,{grow:!1,component:"span"},u.pc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:O,queryValue:E,value:E,isAggregatable:!0,fieldType:"keyword"})))));E.displayName="AuditdGenericLine";const x=i.a.memo((({data:e,contextId:t,isDraggable:n,text:r,timelineId:o})=>{const s=e._id,c=Object(a.get)("auditd.session[0]",e),u=Object(a.get)("host.name[0]",e),m=Object(a.get)("user.name[0]",e),f=Object(a.get)("auditd.result[0]",e),g=Object(a.get)("process.pid[0]",e),b=Object(a.get)("process.name[0]",e),y=Object(a.get)("process.executable[0]",e),h=Object(a.get)("process.title[0]",e),v=Object(a.get)("process.working_directory[0]",e),x=Object(a.get)("auditd.summary.actor.primary[0]",e),j=Object(a.get)("auditd.summary.actor.secondary[0]",e),O=Object(a.get)("process.args",e);return null!=e.process?i.a.createElement(p.b,null,i.a.createElement(E,{id:s,contextId:t,text:r,hostName:u,userName:m,processName:b,processPid:g,processExecutable:y,processTitle:h,workingDirectory:v,args:O,session:c,primary:x,result:f,secondary:j,isDraggable:n}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:n,timelineId:o})):null}));x.displayName="AuditdGenericDetails";const j=i.a.memo((({id:e,contextId:t,hostName:n,userName:a,result:r,primary:o,secondary:s,filePath:d,processName:g,processPid:b,processExecutable:y,processTitle:h,workingDirectory:E,args:x,session:j,text:O,fileIcon:S,isDraggable:w})=>i.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(v,{eventId:e,contextId:t,hostName:n,userName:a,primary:o,secondary:s,workingDirectory:E,session:j,isDraggable:w}),(null!=d||null!=y)&&i.a.createElement(p.c,{grow:!1,component:"span"},O),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"file.path",isDraggable:w,value:d,iconType:S})),null!=y&&i.a.createElement(p.c,{grow:!1,component:"span"},u.kc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,isDraggable:w,processPid:b,processName:g,processExecutable:y})),i.a.createElement(f.a,{eventId:e,args:x,contextId:t,isDraggable:w,processTitle:h}),null!=r&&i.a.createElement(p.c,{grow:!1,component:"span"},u.pc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:w,queryValue:r,value:r})))));j.displayName="AuditdGenericFileLine";const O=i.a.memo((({data:e,contextId:t,text:n,fileIcon:r="document",timelineId:o,isDraggable:s})=>{const c=e._id,u=Object(a.get)("auditd.session[0]",e),m=Object(a.get)("host.name[0]",e),f=Object(a.get)("user.name[0]",e),g=Object(a.get)("auditd.result[0]",e),b=Object(a.get)("process.pid[0]",e),y=Object(a.get)("process.name[0]",e),h=Object(a.get)("process.executable[0]",e),v=Object(a.get)("process.title[0]",e),E=Object(a.get)("process.working_directory[0]",e),x=Object(a.get)("file.path[0]",e),O=Object(a.get)("auditd.summary.actor.primary[0]",e),S=Object(a.get)("auditd.summary.actor.secondary[0]",e),w=Object(a.get)("process.args",e);return null!=e.process?i.a.createElement(p.b,null,i.a.createElement(j,{id:c,contextId:t,text:n,hostName:m,userName:f,filePath:x,processName:y,processPid:b,processExecutable:h,processTitle:v,workingDirectory:E,args:w,session:u,primary:O,secondary:S,fileIcon:r,result:g,isDraggable:s}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:s,timelineId:o})):null}));O.displayName="AuditdGenericFileDetails";const S=({actionName:e,text:t})=>({id:o.e.auditd,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),r=Object(a.get)("event.action[0]",t);return null!=n&&"auditd"===n.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:r})=>i.a.createElement(s.a,null,i.a.createElement(x,{data:n,isDraggable:a,contextId:`${e}-${r}`,text:t,timelineId:r}))}),w=({actionName:e,text:t,fileIcon:n="document"})=>({id:o.e.auditd_file,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),r=Object(a.get)("event.action[0]",t);return null!=n&&"auditd"===n.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:a,isDraggable:r,scopeId:o})=>i.a.createElement(s.a,null,i.a.createElement(O,{contextId:`${e}-${o}`,data:a,fileIcon:n,isDraggable:r,text:t,timelineId:o}))}),k=S({actionName:"was-authorized",text:u.oc}),I=S({actionName:"started-session",text:u.Yb}),T=S({actionName:"logged-in",text:u.m}),C=S({actionName:"login",text:u.m}),M=S({actionName:"executed",text:u.gb}),_=S({actionName:"ended-session",text:u.eb}),D=S({actionName:"acquired-credentials",text:u.e}),N=S({actionName:"disposed-credentials",text:u.db}),A=S({actionName:"connected-to",text:u.T}),F=w({actionName:"opened-file",text:u.Db}),P=S({actionName:"changed-file-attributes-of",text:u.y}),R=w({actionName:"changed-file-permissions-of",text:u.A}),L=w({actionName:"changed-file-ownership-of",text:u.z}),q=S({actionName:"loaded-kernel-module",text:u.ob}),z=S({actionName:"unloaded-kernel-module",text:u.gc}),B=w({actionName:"created-directory",text:u.V,fileIcon:"folderOpen"}),$=w({actionName:"mounted",text:u.Bb}),V=w({actionName:"renamed",text:u.Ob}),U=w({actionName:"checked-metadata-of",text:u.S}),G=w({actionName:"checked-filesystem-metadata-of",text:u.Q}),H=w({actionName:"symlinked",text:u.dc}),W=w({actionName:"unmounted",text:u.ic}),Q=w({actionName:"deleted",text:u.Z}),Y=w({actionName:"changed-timestamp-of",text:u.N}),K=S({actionName:"listen-for-connections",text:u.mb}),Z=S({actionName:"bound-socket",text:u.t}),X=S({actionName:"received-from",text:u.Hb}),J=S({actionName:"sent-to",text:u.Ub}),ee=S({actionName:"killed-pid",text:u.lb}),te=S({actionName:"changed-identity-of",text:u.D}),ne=S({actionName:"changed-system-time",text:u.M}),ae=S({actionName:"make-device",text:u.ub}),re=S({actionName:"changed-system-name",text:u.L}),ie=S({actionName:"allocated-memory",text:u.h}),oe=S({actionName:"adjusted-scheduling-policy-of",text:u.Rb}),se=S({actionName:"added-user-account",text:u.g}),le=S({actionName:"caused-mac-policy-error",text:u.u}),ce=S({actionName:"loaded-firewall-rule-to",text:u.nb}),ue=S({actionName:"changed-promiscuous-mode-on-device",text:u.H}),de=S({actionName:"locked-account",text:u.rb}),pe=S({actionName:"unlocked-account",text:u.hc}),me=S({actionName:"added-group-account-to",text:u.f}),fe=S({actionName:"crashed-program",text:u.U}),ge=S({actionName:"attempted-execution-of-forbidden-program",text:u.hb}),be=S({actionName:"used-suspcious-link",text:u.jc}),ye=S({actionName:"used-suspicious-link",text:u.jc}),he=S({actionName:"failed-log-in-too-many-times-to",text:u.ib}),ve=S({actionName:"failed-login-too-many-times-to",text:u.ib}),Ee=S({actionName:"attempted-log-in-from-unusual-place-to",text:u.o}),xe=S({actionName:"attempted-login-from-unusual-place-to",text:u.o}),je=S({actionName:"opened-too-many-sessions-to",text:u.Eb}),Oe=S({actionName:"attempted-log-in-during-unusual-hour-to",text:u.n}),Se=S({actionName:"attempted-login-during-unusual-hour-to",text:u.n}),we=S({actionName:"tested-file-system-integrity-of",text:u.ec}),ke=S({actionName:"violated-selinux-policy",text:u.nc}),Ie=S({actionName:"violated-apparmor-policy",text:u.lc}),Te=S({actionName:"changed-group",text:u.B}),Ce=S({actionName:"changed-user-id",text:u.P}),Me=S({actionName:"changed-auditd-configuration",text:u.v}),_e=[M,T,C,k,D,_,N,I,A,F,P,R,L,q,z,B,$,V,U,G,H,W,Q,Y,K,Z,X,J,ee,te,ne,ae,re,ie,oe,se,me,ge,le,ue,fe,ce,de,be,ye,pe,he,ve,xe,je,Ee,Oe,Se,we,ke,Ie,Te,Ce,S({actionName:"changed-audit-configuration",text:u.v}),S({actionName:"refreshed-credentials",text:u.Jb}),S({actionName:"negotiated-crypto-key",text:u.Cb}),S({actionName:"crypto-officer-logged-in",text:u.X}),S({actionName:"crypto-officer-login",text:u.X}),S({actionName:"crypto-officer-logged-out",text:u.Y}),S({actionName:"crypto-officer-logout",text:u.Y}),S({actionName:"started-crypto-session",text:u.ac}),S({actionName:"access-result",text:u.d}),S({actionName:"aborted-auditd-startup",text:u.a}),S({actionName:"aborted-audit-startup",text:u.a}),S({actionName:"remote-audit-connected",text:u.Lb}),S({actionName:"remote-audit-disconnected",text:u.Mb}),S({actionName:"shutdown-audit",text:u.Wb}),S({actionName:"audit-error",text:u.p}),S({actionName:"reconfigured-auditd",text:u.Ib}),S({actionName:"reconfigured-audit",text:u.Ib}),S({actionName:"resumed-audit-logging",text:u.Pb}),S({actionName:"rotated-audit-logs",text:u.Qb}),S({actionName:"started-audit",text:u.Zb}),S({actionName:"deleted-group-account-from",text:u.ab}),S({actionName:"deleted-user-account",text:u.bb}),S({actionName:"changed-audit-feature",text:u.w}),S({actionName:"relabeled-filesystem",text:u.Kb}),S({actionName:"authenticated-to-group",text:u.q}),S({actionName:"changed-group-password",text:u.C}),S({actionName:"modified-group-account",text:u.xb}),S({actionName:"initialized-audit-subsystem",text:u.jb}),S({actionName:"modified-level-of",text:u.yb}),S({actionName:"overrode-label-of",text:u.Fb}),S({actionName:"changed-login-id-to",text:u.E}),S({actionName:"mac-permission",text:u.tb}),S({actionName:"changed-selinux-boolean",text:u.J}),S({actionName:"loaded-selinux-policy",text:u.qb}),S({actionName:"changed-selinux-enforcement",text:u.K}),S({actionName:"assigned-user-role-to",text:u.j}),S({actionName:"modified-role",text:u.zb}),S({actionName:"removed-use-role-from",text:u.Nb}),S({actionName:"removed-user-role-from",text:u.Nb}),Me,S({actionName:"violated-seccomp-policy",text:u.mc}),S({actionName:"started-service",text:u.bc}),S({actionName:"stopped-service",text:u.cc}),S({actionName:"booted-system",text:u.s}),S({actionName:"changed-to-runlevel",text:u.O}),S({actionName:"shutdown-system",text:u.Xb}),S({actionName:"sent-test",text:u.Tb}),S({actionName:"unknown",text:u.fc}),S({actionName:"sent-message",text:u.Sb}),S({actionName:"access-permission",text:u.c}),S({actionName:"authenticated",text:u.r}),S({actionName:"changed-password",text:u.G}),S({actionName:"ran-command",text:u.Gb}),S({actionName:"error",text:u.fb}),S({actionName:"logged-out",text:u.sb}),S({actionName:"logout",text:u.sb}),S({actionName:"changed-mac-configuration",text:u.F}),S({actionName:"loaded-mac-policy",text:u.pb}),S({actionName:"modified-user-account",text:u.Ab}),S({actionName:"changed-role-to",text:u.I}),S({actionName:"access-error",text:u.b}),S({actionName:"changed-configuration",text:u.x}),S({actionName:"issued-vm-control",text:u.kb}),S({actionName:"created-vm-image",text:u.W}),S({actionName:"deleted-vm-image",text:u.cb}),S({actionName:"checked-integrity-of",text:u.R}),S({actionName:"assigned-vm-id",text:u.k}),S({actionName:"migrated-vm-from",text:u.vb}),S({actionName:"migrated-vm-to",text:u.wb}),S({actionName:"assigned-vm-resource",text:u.l})]},function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return y}));var a=n(204),r=n(818),i=n(159);const o=(e,t,n)=>{const{pagination:a,search:r,filters:i}=n||{};let o=[],s=[];return Array.isArray(e)&&e.length?(o=e.map((e=>e.list_id)),s=e.map((e=>e.namespace_type))):t&&(o=[t.list_id],s=[t.namespace_type]),{listIds:o,namespaceTypes:s,pagination:a,search:r,filters:i}},s=async({namespaceTypes:e,listIds:t,http:n,pagination:i,search:o})=>{try{const s=new AbortController,{pageIndex:l,pageSize:c,totalItemCount:u}=i||{},{page:d,per_page:p,total:m,data:f}=await Object(a.n)({filter:void 0,http:n,listIds:null!=t?t:[],namespaceTypes:null!=e?e:[],search:o,pagination:{perPage:c,page:(l||0)+1,total:u},signal:s.signal});return{data:f.map((e=>Object(r.b)(e))),pagination:{pageIndex:d-1,pageSize:p,totalItemCount:m}}}catch(e){throw new Error(e)}},l=async e=>{try{const t=new AbortController,{references:n}=await Object(i.l)({lists:e.map((e=>({id:e.id,listId:e.list_id,namespaceType:e.namespace_type}))),signal:t.signal});return n.reduce(((e,t)=>({...e,...t})),{})}catch(e){throw new Error(e)}},c=async({id:e,namespaceType:t,http:n})=>{try{const r=new AbortController;await Object(a.e)({http:n,id:e,namespaceType:t,signal:r.signal})}catch(e){throw new Error(e)}};var u=n(1622),d=n(82),p=n(245);const m=async({id:e,http:t})=>{try{const n=new AbortController,r=Object(u.a)({filters:{list_id:e},namespaceTypes:["single","agnostic"],hideLists:p.a}),i=["single","agnostic"].join(),{data:o}=await Object(a.m)({filters:r,http:t,signal:n.signal,namespaceTypes:i,pagination:{}});return n.abort(),o&&o.length?o[0]:null}catch(e){throw new Error(e)}},f=async e=>{try{const t=new AbortController,{data:n}=await Object(i.j)({signal:t.signal,pagination:{page:1,perPage:1e4}});return t.abort(),n.reduce(((t,n,a)=>{var r;return(null===(r=n.exceptions_list)||void 0===r?void 0:r.find((t=>t.list_id===e)))&&t.push(n),t}),[])}catch(e){throw new Error(e)}},g=async({list:e,http:t})=>{try{const n=new AbortController;await Object(a.x)({http:t,list:e,signal:n.signal}),n.abort()}catch(e){throw new Error(e)}},b=async({rules:e,listId:t})=>{try{if(!e.length)return;const n=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var a;const r=(null!==(a=e.exceptions_list)&&void 0!==a?a:[]).filter((({list_id:e})=>e!==t));await Object(i.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:r},signal:n.signal})}))}catch(e){throw new Error(e)}},y=async({rules:e,listId:t,id:n,listType:a,listNamespaceType:r})=>{try{if(!e.length)return;const o=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var s;const l={list_id:t,id:n,type:a,namespace_type:r},c=[...null!==(s=e.exceptions_list)&&void 0!==s?s:[],l];await Object(i.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:c},signal:o.signal})}))}catch(e){throw new Error(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(2),r=n(607),i=n(608),o=n(53),s=n(47),l=n(118),c=n(277),u=n(131),d=n(127);const p="fieldNames",m="eventKind",f="hostName",g="userName",b="hosts",y="users",h=(e,t,n,a)=>{const r=Object(o.buildEsQuery)(void 0,[],[{query:{bool:{filter:[{range:{"@timestamp":{gte:t,lte:n}}}]}},meta:{}}]);return v(r,e,a)},v=(e,t,n)=>({params:{index:n,body:{query:e,aggs:{[p]:{filters:{filters:t},aggs:{[f]:{cardinality:{field:"host.name"}},[g]:{cardinality:{field:"user.name"}},[m]:{terms:{field:"event.kind",size:10}}}},[b]:{cardinality:{field:"host.name"}},[y]:{cardinality:{field:"user.name"}}},size:0}}});var E=n(192);const x=({interval:e,dataFormattedForFieldBrowser:t,investigationFields:n})=>{const o=Object(r.a)({dataFormattedForFieldBrowser:t,investigationFields:n}),v=Object(a.useMemo)((()=>Object(i.a)(o)),[o]),{data:x,loading:j,error:O}=(({highlightedFieldsFilters:e,interval:{from:t,to:n}})=>{const{services:{data:{search:a}}}=Object(l.j)(),{selectedPatterns:r}=Object(c.a)(Object(u.isActiveTimeline)(d.SourcererScopeName.default)),i=h(e,t,n,r),{data:o,isLoading:p,isError:m}=Object(s.useQuery)(["useFetchFieldValuePairWithAggregation",e,t,n],(()=>(async(e,t)=>{let n;return new Promise(((a,r)=>{e.search(t).subscribe({next:e=>{n=e.rawResponse},complete:()=>{a(n)},error:e=>{r(e)}})}))})(a,i)));return{loading:p,error:m,data:o}})({highlightedFieldsFilters:v,interval:e}),S=[];if(x&&x.aggregations){const e=x.aggregations[b].value,t=x.aggregations[y].value;Object.keys(x.aggregations[p].buckets).forEach((n=>{var a;const r=o[n].values,i=(null===(a=x.aggregations[p].buckets[n][m].buckets.find((e=>e.key===E.a.signal)))||void 0===a?void 0:a.doc_count)||0;let s=0;x.aggregations[p].buckets[n][m].buckets.reduce(((e,t)=>(t.key!==E.a.signal&&(s+=t.doc_count),e)),s);const l=x.aggregations[p].buckets[n][f].value,c=x.aggregations[p].buckets[n][g].value,u=e?l/e:0,d=t?c/t:0;S.push({field:n,values:r,alertCount:i,docCount:s,hostPrevalence:u,userPrevalence:d})}))}return{loading:j,error:O,data:S}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(134),c=n(144),u=n(4);const d=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.clientCertLabel",{defaultMessage:"client cert"}),p=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.serverCertLabel",{defaultMessage:"server cert"}),m="tls.client_certificate.fingerprint.sha1",f="tls.server_certificate.fingerprint.sha1",g=s.a.span.withConfig({displayName:"FingerprintLabel",componentId:"sc-1isap0l-0"})(["margin-right:5px;"]);g.displayName="FingerprintLabel";const b=i.a.memo((({eventId:e,certificateType:t,contextId:n,fieldName:r,isDraggable:o,value:s})=>i.a.createElement(l.c,{contextId:n,"data-test-subj":`${t}-certificate-fingerprint`,eventId:e,field:r,iconType:"snowflake",isDraggable:o,tooltipContent:i.a.createElement(a.EuiText,{size:"xs"},i.a.createElement("span",null,r)),value:s,isAggregatable:!0,fieldType:"keyword"},i.a.createElement(g,null,"client"===t?d:p),i.a.createElement(c.b,{certificateFingerprint:s||""}))));b.displayName="CertificateFingerprint"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(134),l=n(144);const c=n(4).i18n.translate("xpack.securitySolution.ja3.fingerprint.ja3.fingerprintLabel",{defaultMessage:"ja3"}),u="tls.fingerprints.ja3.hash",d=o.a.span.withConfig({displayName:"Ja3FingerprintLabel",componentId:"sc-94sjip-0"})(["margin-right:5px;"]);d.displayName="Ja3FingerprintLabel";const p=r.a.memo((({contextId:e,eventId:t,fieldName:n,isDraggable:a,value:i})=>r.a.createElement(s.c,{contextId:e,"data-test-subj":"ja3-hash",eventId:t,field:n,iconType:"snowflake",isDraggable:a,value:i,isAggregatable:!0,fieldType:"keyword"},r.a.createElement(d,null,c),r.a.createElement(l.e,{"data-test-subj":"ja3-hash-link",ja3Fingerprint:i||""}))));p.displayName="Ja3Fingerprint"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),r=n.n(a),i=n(19),o=n(4),s=n(436),l=n(5),c=n(118);const u=`${n(211).a}Tour`,d=o.i18n.translate("xpack.securitySolution.flyout.tour.subtitle",{defaultMessage:"A redesigned alert experience"}),p=({tourStepContent:e,totalSteps:t,goToOverviewTab:n,goToLeftPanel:p})=>{const{services:{storage:m}}=Object(c.j)(),[f,g]=Object(a.useState)((()=>{const e=m.get(l.cc.FLYOUT);return null!=e?e:s.c}));Object(a.useEffect)((()=>{m.set(l.cc.FLYOUT,f),f.isTourActive&&1===f.currentTourStep&&n&&n()}),[m,f,n]);const b=Object(a.useCallback)((()=>{g((e=>(3===e.currentTourStep&&p&&p(),{...e,currentTourStep:e.currentTourStep+1})))}),[p]),y=Object(a.useCallback)((()=>{g((e=>({...e,isTourActive:!1})))}),[]),h=Object(a.useCallback)((e=>e===t?r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:y},o.i18n.translate("xpack.securitySolution.flyout.tour.finish.text",{defaultMessage:"Finish"})):[r.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:y},o.i18n.translate("xpack.securitySolution.flyout.tour.exit.text",{defaultMessage:"Exit"})),r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:b},o.i18n.translate("xpack.securitySolution.flyout.tour.Next.text",{defaultMessage:"Next"}))]),[y,b,t]);return f.isTourActive?r.a.createElement(r.a.Fragment,null,e.map((e=>{const n=e.stepNumber;if(f.currentTourStep!==n)return null;const a={"data-test-subj":`${u}-${n}`};return r.a.createElement(i.EuiTourStep,{panelProps:a,key:n,step:n,isStepOpen:f.isTourActive,maxWidth:500,stepsTotal:t,onFinish:y,title:e.title,content:e.content,anchor:`[data-test-subj=${e.anchor}]`,anchorPosition:e.anchorPosition,footerAction:h(n),subtitle:d})}))):null};p.displayName="FlyoutTour"},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(19),l=n(5),c=n(4);const u=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.unknownAvatarName",{defaultMessage:"Uknown"}),d=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.addCommentPlaceholder",{defaultMessage:"Add a new comment..."});var p=n(118),m=n(343);const f="exceptionCommentAccordionButton",g=o()(s.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-ggp4j5-0"})(["",""],(({theme:e})=>Object(i.css)(["margin-right:",";"],e.eui.euiSizeS))),b=o()(s.EuiAccordion).withConfig({displayName:"CommentAccordion",componentId:"sc-ggp4j5-1"})(["",""],(({theme:e})=>Object(i.css)([".","{color:",";padding:"," 0;}"],f,e.eui.euiColorPrimary,e.eui.euiSizeM))),y=Object(a.memo)((function({exceptionItemComments:e,newCommentValue:t,accordionTitle:n,initialIsOpen:i=!1,newCommentOnChange:o,setCommentError:y}){const[h,v]=Object(a.useState)(!1),[E,x]=Object(a.useState)(!1),j=Object(p.f)(),O=null==j?void 0:j.fullName,S=null==j?void 0:j.username,w=null==j?void 0:j.email,k=Object(a.useMemo)((()=>O&&O.length>0?O:w&&w.length>0?w:S&&S.length>0?S:u),[O,w,S]);Object(a.useEffect)((()=>{y(h)}),[h,y]);const I=Object(a.useCallback)((e=>{o(e.target.value),v(e.target.value.length>l.Vb)}),[o]),T=Object(a.useCallback)((e=>{x(e)}),[]),C=Object(a.useMemo)((()=>{return e&&e.length>0?r.a.createElement(s.EuiText,{size:"s","data-test-subj":"ExceptionItemCommentsAccordionButton"},E?(e=>c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.hideCommentsLabel",{values:{comments:e},defaultMessage:"Hide ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))(e.length):(t=e.length,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.showCommentsLabel",{values:{comments:t},defaultMessage:"Show ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))):null;var t}),[e,E]),M=Object(a.useMemo)((()=>e&&e.length>0?Object(m.j)(e):[]),[e]);return r.a.createElement("div",null,r.a.createElement(b,{initialIsOpen:i&&!!t,id:"add-exception-comments-accordion",buttonClassName:f,buttonContent:null!=n?n:C,"data-test-subj":"exceptionItemCommentsAccordion",onToggle:e=>T(e)},r.a.createElement(s.EuiCommentList,{comments:M}),r.a.createElement(s.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(g,{name:k,size:"l","data-test-subj":"exceptionItemCommentAvatar"})),r.a.createElement(s.EuiFlexItem,{grow:1},r.a.createElement(s.EuiFormRow,{fullWidth:!0,error:(_=l.Vb,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.maxLengthError",{values:{length:_},defaultMessage:"The length of the comment is too long. The maximum length is {length} characters."})),isInvalid:h},r.a.createElement(s.EuiTextArea,{placeholder:d,"aria-label":"Comment Input",value:t,onChange:I,fullWidth:!0,"data-test-subj":"newExceptionItemCommentTextArea"}))))));var _}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j}));var a=n(2),r=n.n(a),i=n(19),o=n(847),s=n.n(o),l=n(728),c=n(741),u=n(175),d=n(336),p=n(5),m=n(127),f=n(441),g=n(1209),b=n(132),y=n(246),h=n(125),v=n(153),E=n(339);const x="threatIntelligence",j=()=>{const{enrichments:e,eventFields:t,isEnrichmentsLoading:n,isEventDataLoading:o,isLoading:x,range:j,setRange:O}=(()=>{const{indexName:e,eventId:t}=Object(h.b)(),[{pageName:n}]=Object(y.a)(),r=n===p.Oc.detections?m.SourcererScopeName.detections:m.SourcererScopeName.default,i=Object(b.a)(r),[o,s]=Object(g.a)({indexName:e,eventId:t,runtimeMappings:i.runtimeMappings,skip:!t}),{isAlert:l}=Object(u.b)(s),c=Object(a.useMemo)((()=>s||[]),[s]),v=Object(a.useMemo)((()=>Object(d.c)(c||[])),[c]),{result:E,loading:x,setRange:j,range:O}=Object(f.c)(v),S=Object(a.useMemo)((()=>l?Object(d.g)(c).map((e=>Object(d.h)(e))):[]),[c,l]);return{enrichments:Object(a.useMemo)((()=>x||null==E||!E.enrichments?S:Object(d.b)([...S,...E.enrichments])),[x,E,S]),eventFields:v,isEnrichmentsLoading:x,isEventDataLoading:o,isLoading:x||o,range:O,setRange:j}})();return o?r.a.createElement(E.a,{"data-test-subj":v.N}):r.a.createElement(c.a,{before:null,loading:x,enrichments:e,showInvestigationTimeEnrichments:!s()(t)},r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{setRange:O,loading:n,range:j}),r.a.createElement(i.EuiSpacer,{size:"m"})))};j.displayName="ThreatIntelligenceDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(19),r=n(54),i=n.n(r),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(50),d=n(430),p=n(196);d.f;const m=c.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);m.displayName="TitleText",s.a.memo((({noteIds:e})=>s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiTitle,{size:"s"},s.a.createElement(m,null,d.e))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(p.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e,user:t})=>({created:i.a.utc().toDate(),id:Object(u.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),g=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a,user:r})=>{const i=f({newNote:t,user:r});a(i),e(i.id),n("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importStar(n(2)),i=n(2),o=a.__importDefault(n(327)),s=a.__importDefault(n(991));t.default=function(e){return function(t){var n,l;l=r.isValidElement(t)?(n=t).props:t;var c=o.default({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1}),u=c[0],d=c[1],p=i.useRef(null),m=function(e,t){return function(n){try{t&&t(n)}finally{e&&e(n)}}},f=function(){return d({paused:!1})},g=function(){return d({paused:!0})},b=function(){var e=p.current;e&&d({muted:e.muted,volume:e.volume})},y=function(){var e=p.current;if(e){var t=e.duration,n=e.buffered;d({duration:t,buffered:s.default(n)})}},h=function(){var e=p.current;e&&d({time:e.currentTime})},v=function(){var e=p.current;e&&d({buffered:s.default(e.buffered)})};n=n?r.cloneElement(n,a.__assign(a.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,g),onVolumeChange:m(l.onVolumeChange,b),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,h),onProgress:m(l.onProgress,v)})):r.createElement(e,a.__assign(a.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,g),onVolumeChange:m(l.onVolumeChange,b),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,h),onProgress:m(l.onProgress,v)}));var E=!1,x={play:function(){var e=p.current;if(e&&!E){var t=e.play();if("object"==typeof t){E=!0;var n=function(){E=!1};t.then(n,n)}return t}},pause:function(){var e=p.current;if(e&&!E)return e.pause()},seek:function(e){var t=p.current;t&&void 0!==u.duration&&(e=Math.min(u.duration,Math.max(0,e)),t.currentTime=e)},volume:function(e){var t=p.current;t&&(e=Math.min(1,Math.max(0,e)),t.volume=e,d({volume:e}))},mute:function(){var e=p.current;e&&(e.muted=!0)},unmute:function(){var e=p.current;e&&(e.muted=!1)}};return i.useEffect((function(){var e=p.current;e&&(d({volume:e.volume,muted:e.muted,paused:e.paused}),l.autoPlay&&e.paused&&x.play())}),[l.src]),[n,u,x,p]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=function(e,t){return"boolean"==typeof t?t:!e};t.default=function(e){return a.useReducer(r,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(638)),o=n(372);t.default=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=null),void 0===n&&(n=null);var a=o.resolveHookState(e);"number"!=typeof a&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof n?a=Math.max(a,n):null!==n&&console.error("min has to be a number, got "+typeof n),"number"==typeof t?a=Math.min(a,t):null!==t&&console.error("max has to be a number, got "+typeof t);var s=i.default(a),l=s[0],c=s[1];return[l(),r.useMemo((function(){var e=function(e){var a=l(),r=o.resolveHookState(e,a);a!==r&&("number"==typeof n&&(r=Math.max(r,n)),"number"==typeof t&&(r=Math.min(r,t)),a!==r&&c(r))};return{get:l,set:e,inc:function(t){void 0===t&&(t=1);var n=o.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e+n}))},dec:function(t){void 0===t&&(t=1);var n=o.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e-n}))},reset:function(t){void 0===t&&(t=a);var n=o.resolveHookState(t,l());"number"!=typeof n&&console.error("value has to be a number or function returning a number, got "+typeof n),a=n,e(n)}}}),[a,n,t])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(280)),o=n(372);t.default=function(e){var t=r.useRef(o.resolveHookState(e)),n=i.default();return r.useMemo((function(){return[function(){return t.current},function(e){t.current=o.resolveHookState(e,t.current),n()}]}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useState(!1),r=n[0],i=n[1];return a.useEffect((function(){var n=function(){return i(!0)},a=function(){return i(!1)};t&&e&&e.current&&(e.current.addEventListener("mouseover",n),e.current.addEventListener("mouseout",a));var r=e.current;return function(){t&&r&&(r.removeEventListener("mouseover",n),r.removeEventListener("mouseout",a))}}),[t,e]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(557)),o=function(){};t.default=function(e,t,n,a){void 0===t&&(t=o),void 0===n&&(n={}),void 0===a&&(a=[e]);var s=n.event,l=void 0===s?"keydown":s,c=n.target,u=n.options,d=r.useMemo((function(){var n,a="function"==typeof(n=e)?n:"string"==typeof n?function(e){return e.key===n}:n?function(){return!0}:function(){return!1};return function(e){if(a(e))return t(e)}}),a);i.default(l,d,c,u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(640));t.default=function(e){var t=r.useState([!1,null]),n=t[0],a=t[1];return i.default(e,(function(e){return a([!0,e])}),{event:"keydown"},[n]),i.default(e,(function(e){return a([!1,e])}),{event:"keyup"},[n]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef(e);return t.current=e,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){a.useEffect((function(){return e&&e(),function(){t&&t()}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(280)),o=n(372);t.default=function(e){void 0===e&&(e=[]);var t=r.useRef(o.resolveHookState(e)),n=i.default(),a=r.useMemo((function(){var r={set:function(e){t.current=o.resolveHookState(e,t.current),n()},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length&&a.set((function(t){return t.concat(e)}))},updateAt:function(e,t){a.set((function(n){var a=n.slice();return a[e]=t,a}))},insertAt:function(e,t){a.set((function(n){var a=n.slice();return e>a.length?a[e]=t:a.splice(e,0,t),a}))},update:function(e,t){a.set((function(n){return n.map((function(n){return e(n,t)?t:n}))}))},updateFirst:function(e,n){var r=t.current.findIndex((function(t){return e(t,n)}));r>=0&&a.updateAt(r,n)},upsert:function(e,n){var r=t.current.findIndex((function(t){return e(t,n)}));r>=0?a.updateAt(r,n):a.push(n)},sort:function(e){a.set((function(t){return t.slice().sort(e)}))},filter:function(e,t){a.set((function(n){return n.slice().filter(e,t)}))},removeAt:function(e){a.set((function(t){var n=t.slice();return n.splice(e,1),n}))},clear:function(){a.set([])},reset:function(){a.set(o.resolveHookState(e).slice())}};return r.remove=r.removeAt,r}),[]);return[t.current,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i=function(){};t.default=function(e,t,n){if(!r.isClient)return[t,i,i];if(!e)throw new Error("useLocalStorage key may not be falsy");var o=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,s=a.useState((function(){try{var a=n?n.raw?String:n.serializer:JSON.stringify,r=localStorage.getItem(e);return null!==r?o(r):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),l=s[0],c=s[1],u=a.useCallback((function(t){try{var a="function"==typeof t?t(l):t;if(void 0===a)return;var r;r=n?n.raw?"string"==typeof a?a:JSON.stringify(a):n.serializer?n.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,r),c(o(r))}catch(e){}}),[e,c]),d=a.useCallback((function(){try{localStorage.removeItem(e),c(void 0)}catch(e){}}),[e,c]);return[l,u,d]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(328));t.default=function(e){a.default((function(){e()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(329));t.default=function(e){var t=i.default({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=t[0],a=t[1];return r.useEffect((function(){var t=function(t){if(e&&e.current){var n=e.current.getBoundingClientRect(),r=n.left,i=n.top,o=n.width,s=n.height,l=r+window.pageXOffset,c=i+window.pageYOffset,u=t.pageX-l,d=t.pageY-c;a({docX:t.pageX,docY:t.pageY,posX:l,posY:c,elX:u,elY:d,elH:s,elW:o})}};return document.addEventListener("mousemove",t),function(){document.removeEventListener("mousemove",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(37));t.default=function(e,t){void 0===e&&(e=1e12),void 0===t&&(t=0);var n=r.useState(0),a=n[0],o=n[1];return i.default((function(){var n,a,r,i=function(){var t=Math.min(1,(Date.now()-r)/e);o(t),s()},s=function(){n=requestAnimationFrame(i)},l=setTimeout((function(){a=setTimeout((function(){cancelAnimationFrame(n),o(1)}),e),r=Date.now(),s()}),t);return function(){clearTimeout(a),clearTimeout(l),cancelAnimationFrame(n)}}),[e,t]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=parseInt(r.version.substr(0,r.version.indexOf(".")))>15;t.default=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var s=e.render,l=e.children,c=void 0===l?s:l,u=e.component,d=e.comp,p=void 0===d?u:d;return"function"==typeof c?c.apply(void 0,a.__spreadArrays([t],n)):p?r.createElement(p,t):c instanceof Array?i?c:r.createElement.apply(void 0,a.__spreadArrays(["div",null],c)):c&&c instanceof Object?"string"==typeof c.type?c:r.cloneElement(c,Object.assign({},c.props,t)):c||null}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return f}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),i=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),c=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),u=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),f=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,n){"use strict";n.d(t,"n",(function(){return r})),n.d(t,"o",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return h}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),i=a.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),o=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),s=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),l=a.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),c=a.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),u=a.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),p=a.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),m=a.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),f=a.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),g=a.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),b=a.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),y=a.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),h=a.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},function(e,t,n){"use strict";e.exports=n(1085)},function(e,t,n){"use strict";e.exports=n(1086)},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1094);case"v8light":return n(1096)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(701);function r(e){return{type:Object(a.a)(e),scripted:e.scripted}}},function(e,t,n){const a=n(283);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(191);const l=o.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(i.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),s.d,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),s.d,s.d,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(i.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const c=r.a.memo(l);c.displayName="ProviderContainer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),r=n(5),i=n(584),o=n(132),s=n(124),l=n(148),c=n(127),u=n(246),d=n(282);const p=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraOptions:n,getLensAttributes:p,lensAttributes:m,scopeId:f=c.SourcererScopeName.default,stackByField:g,title:b})=>{var y,h;const{selectedPatterns:v,dataViewId:E,indicesExist:x}=Object(o.a)(f),j=Object(a.useMemo)((()=>l.d.globalQuerySelector()),[]),O=Object(a.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),S=Object(s.a)(j),w=Object(s.a)(O),[{detailName:k,pageName:I,tabName:T}]=Object(u.a)(),C=Object(a.useMemo)((()=>T===i.a.events?I===r.Oc.network?d.h:Object(d.b)(I):[]),[I,T]),M=Object(a.useMemo)((()=>[r.Oc.hosts,r.Oc.users].indexOf(I)>=0&&null!=k?Object(d.c)(I,k):r.Oc.network===I?Object(d.e)(k):[]),[k,I]),_=Object(a.useMemo)((()=>null!=m?m:p&&g&&p(g,n)),[n,p,m,g]),D=Object.values(null!==(y=null==_||null===(h=_.state)||void 0===h?void 0:h.adHocDataViews)&&void 0!==y?y:{}).length>0,N=Object(a.useMemo)((()=>{var n;if(null==m&&(null==p||null==g||0===(null==g?void 0:g.length)))return null;const a=D?[]:Object(d.d)(v);return{..._,...null!=b?{title:b}:{},state:{..._.state,...e?{query:S}:{},filters:[..._.state.filters,...t?M:[],...t?C:[],...a,...e?w:[]]},references:null==_||null===(n=_.references)||void 0===n?void 0:n.map((e=>({...e,id:E})))}}),[e,t,_,E,w,p,D,m,M,S,v,g,C,b]);return D||!D&&x?N:null}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(47),r=n(118),i=n(123),o=n(483);const s=({uids:e})=>{const{security:t}=Object(r.j)().services,{addError:n}=Object(i.a)();return Object(a.useQuery)(["useBulkGetUserProfiles",...e],(async()=>(async({security:e,uids:t})=>0===t.size?[]:e.userProfiles.bulkGet({uids:t,dataPath:"avatar"}))({security:t,uids:e})),{retry:!1,staleTime:1/0,onError:e=>{n(e,{title:o.c})}})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return c}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),i=a.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),o=a.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),s=a.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),l=a.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),c=a.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"})},function(e,t,n){"use strict";n.d(t,"m",(function(){return r})),n.d(t,"q",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"k",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"u",(function(){return c})),n.d(t,"s",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"r",(function(){return f})),n.d(t,"z",(function(){return g})),n.d(t,"v",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"l",(function(){return h})),n.d(t,"y",(function(){return v})),n.d(t,"x",(function(){return E})),n.d(t,"f",(function(){return x})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return O})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return k})),n.d(t,"e",(function(){return I})),n.d(t,"d",(function(){return T})),n.d(t,"n",(function(){return C}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryLabel",{defaultMessage:"Custom query"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlQueryLabel",{defaultMessage:"EQL query"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryFiltersLabel",{defaultMessage:"Saved query filters"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryLabel",{defaultMessage:"Saved query"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.newTermsRuleTypeDescription",{defaultMessage:"New Terms"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlRuleTypeDescription",{defaultMessage:"ES|QL"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionPerRuleExecution",{defaultMessage:"One rule execution"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionSuppressOnMissingFieldsDescription",{defaultMessage:"Suppress and group alerts for events with missing fields"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionDoNotSuppressOnMissingFieldsDescription",{defaultMessage:"Do not suppress alerts for events with missing fields"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockLabel",{defaultMessage:"Building block"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(19),r=n(42),i=n(2),o=n.n(i),s=n(118);const l=({title:e})=>{const{docLinks:t}=Object(s.j)().services,n=t.links.securitySolution.entityAnalytics;return o.a.createElement(a.EuiLink,{target:"_blank",rel:"noopener nofollow noreferrer",href:n.entityRiskScoring},e||o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.learnMore",defaultMessage:"Learn more about entity risk scoring"}))},c=o.a.memo(l);c.displayName="EntityAnalyticsLearnMoreLink"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(45),i=n(1225),o=n(131),s=n(293);const l=({alertStatus:e,closePopover:t,eventId:n,scopeId:l,refetch:c})=>{const u=Object(r.useDispatch)(),{hasIndexWrite:d}=Object(s.a)(),p=Object(a.useCallback)((()=>{t(),c&&c()}),[t,c]),m=Object(o.getScopedActions)(l),f=Object(a.useCallback)((({eventIds:e,isLoading:t})=>{m&&u(m.setEventsLoading({id:l,eventIds:e,isLoading:t}))}),[u,l,m]),g=Object(a.useCallback)((({eventIds:e,isDeleted:t})=>{m&&u(m.setEventsDeleted({id:l,eventIds:e,isDeleted:t}))}),[u,l,m]),b=Object(a.useMemo)((()=>[n]),[n]),y=Object(a.useMemo)((()=>({eventIds:b,currentStatus:e,setEventsLoading:f,setEventsDeleted:g,onUpdateSuccess:p,onUpdateFailure:p})),[e,b,f,p,g]),h=Object(i.a)(y);return Object(a.useMemo)((()=>({actionItems:d?h:[]})),[h,d])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p}));var a=n(2),r=n(1334),i=n(44),o=n(540),s=n(563),l=n(733),c=n(1200);let u=function(e){return e.alerts="alerts",e.exceptions="rule_exceptions",e.endpointExceptions="endpoint_exceptions",e.executionResults="execution_results",e.executionEvents="execution_events",e}({});const d={[u.alerts]:s.a,[u.exceptions]:l.e,[u.endpointExceptions]:l.d,[u.executionResults]:l.g,[u.executionEvents]:l.f},p=({rule:e,ruleId:t,isExistingRule:n,hasIndexRead:s})=>{const l=Object(a.useMemo)((()=>({[u.alerts]:{id:u.alerts,name:d[u.alerts],disabled:!1,href:`/rules/id/${t}/${u.alerts}`},[u.exceptions]:{id:u.exceptions,name:d[u.exceptions],disabled:null==e,href:`/rules/id/${t}/${u.exceptions}`},[u.endpointExceptions]:{id:u.endpointExceptions,name:d[u.endpointExceptions],disabled:null==e,href:`/rules/id/${t}/${u.endpointExceptions}`},[u.executionResults]:{id:u.executionResults,name:d[u.executionResults],disabled:!n,href:`/rules/id/${t}/${u.executionResults}`},[u.executionEvents]:{id:u.executionEvents,name:d[u.executionEvents],disabled:!n,href:`/rules/id/${t}/${u.executionEvents}`}})),[n,e,t]),[p,m]=Object(a.useState)(l),f=Object(c.f)(),g=Object(o.a)("showEndpointExceptions");return Object(a.useEffect)((()=>{const t=[];var n;(s||t.push(u.alerts),f.extendedLogging.isEnabled||t.push(u.executionEvents),g||t.push(u.endpointExceptions),null!=e)&&((null!==(n=e.exceptions_list)&&void 0!==n?n:[]).some((e=>e.type===r.a.ENDPOINT))||t.push(u.endpointExceptions));const a=Object(i.omit)(t,l);m(a)}),[g,s,e,l,f]),p}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n.n(a),i=n(45),o=n(621),s=n(217);const l=r.a.memo((e=>{const t=Object(i.useSelector)((t=>t.analyzer[e.resolverComponentInstanceID])),n=Object(i.useDispatch)();return t||n(Object(s.createResolver)({id:e.resolverComponentInstanceID})),Object(a.useEffect)((()=>{e.shouldUpdate&&n(Object(s.createResolver)({id:e.resolverComponentInstanceID}))}),[n,e.shouldUpdate,e.resolverComponentInstanceID]),r.a.createElement(o.a,e)}))},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Te})),n.d(t,"b",(function(){return _e})),n.d(t,"c",(function(){return Re})),n.d(t,"e",(function(){return xe})),n.d(t,"d",(function(){return Pe})),n.d(t,"f",(function(){return Le.a}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(41),c=n.n(l),u=n(4);const d=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdated",{defaultMessage:"Last updated"}),p=u.i18n.translate("xpack.securitySolution.artifactCard.created",{defaultMessage:"Created"}),m=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdatedBy",{defaultMessage:"Updated by"}),f=u.i18n.translate("xpack.securitySolution.artifactCard.createdBy",{defaultMessage:"Created by"}),g=u.i18n.translate("xpack.securitySolution.artifactCard.globalEffectScope",{defaultMessage:"Applied globally"}),b=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope",{defaultMessage:"Applied to {count} {count, plural, one {policy} other {policies}}",values:{count:e}}),y=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope.title",{defaultMessage:"Applied to the following {count, plural, one {policy} other {policies}}",values:{count:e}}),h=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator",{defaultMessage:"IS"}),v=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),E=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),x=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),j=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.nestedOperator",{defaultMessage:"has"}),O=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator",{defaultMessage:"is one of"}),S=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),w=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.existsOperator",{defaultMessage:"exists"}),k=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.listOperator",{defaultMessage:"included in"}),I=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.os",{defaultMessage:"OS"}),T=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.and",{defaultMessage:"AND"}),C=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.windows",{defaultMessage:"Windows"}),M=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.linux",{defaultMessage:"Linux"}),_=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.macos",{defaultMessage:"Mac"}),D=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.expand",{defaultMessage:"Expand"}),N=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.collpase",{defaultMessage:"Collapse"}),A=u.i18n.translate("xpack.securitySolution.artifactMinifiedCard.descriptionLabel",{defaultMessage:"Description"});var F=n(151),P=n(52),R=n.n(P),L=n(130);const q=Object(i.memo)((({bold:e,truncate:t,size:n="s",withTooltip:a=!1,"data-test-subj":r,children:l})=>{const c=Object(i.useMemo)((()=>R()({"eui-textTruncate":t,"eui-textBreakWord":!0})),[t]),u=Object(i.useMemo)((()=>e?o.a.createElement("strong",null,l):l),[e,l]);return o.a.createElement(s.EuiText,{className:c,size:n,"data-test-subj":r},a&&"string"==typeof l&&l.length>0&&l!==Object(L.e)()?o.a.createElement(s.EuiToolTip,{anchorClassName:c,content:l,position:"top"},o.a.createElement(o.a.Fragment,null,u)):u)}));q.displayName="TextValueDisplay";var z=n(126);const B=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1dvdnzg-0"})(["padding-top:2px;"]),$=Object(i.memo)((({date:e,type:t,"data-test-subj":n})=>{const a=Object(z.a)(n);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"m","data-test-subj":n},o.a.createElement(B,{grow:!1},o.a.createElement(s.EuiIcon,{type:"calendar"})),o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiFlexGroup,{responsive:!1,direction:"column",alignItems:"flexStart",gutterSize:"xs"},o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":a("label")},o.a.createElement(q,null,"update"===t?d:p)),o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":a("value")},o.a.createElement(q,{bold:!0},o.a.createElement(F.b,{value:e,dateFormat:"M/D/YYYY"}))))))}));$.displayName="DateField";var V=n(50),U=n(542);const G=Object(i.memo)((({items:e,button:t,panelPaddingSize:n,anchorPosition:a,maxWidth:l="32ch",maxHeight:c="255px",fixedWidth:u=!1,title:d,loading:p=!1,hoverInfo:m,isNavigationDisabled:f=!1,...g})=>{const b=Object(z.a)(g["data-test-subj"]),[y,h]=Object(i.useState)(!1),v=Object(i.useCallback)((()=>h(!1)),[h]),E=Object(i.useCallback)((()=>h(!y)),[y]),x=Object(i.useMemo)((()=>({"data-test-subj":b("popoverPanel")})),[b]),j=Object(i.useMemo)((()=>e.map(((e,t)=>{var n,a;return p?o.a.createElement(s.EuiSkeletonText,{lines:1,key:Object(V.v4)(),"data-test-subj":null!==(a=e["data-test-subj"])&&void 0!==a?a:b(`item-loading-${t}`)}):o.a.createElement(U.a,r()({},e,{isNavigationDisabled:f,key:Object(V.v4)(),"data-test-subj":null!==(n=e["data-test-subj"])&&void 0!==n?n:b(`item-${t}`),textTruncate:Boolean(l)||e.textTruncate,hoverInfo:m,onClick:t=>{if(v(),e.onClick)return e.onClick(t)}}))}))),[e,p,f,b,l,m,v]),O=Object(i.useMemo)((()=>{const e={className:"eui-yScroll",style:{}};return l&&!u&&(e.style.maxWidth=l),c&&(e.style.maxHeight=c),u&&(e.style.width=null!=l?l:"32ch"),e}),[l,u,c]);return o.a.createElement(s.EuiPopover,r()({},g,{anchorPosition:a,panelPaddingSize:n,panelProps:x,button:o.a.createElement("div",{className:"eui-displayInlineBlock","data-test-subj":b("triggerButtonWrapper"),onClick:E},t),isOpen:y,closePopover:v}),d?o.a.createElement(s.EuiPopoverTitle,{paddingSize:"m"},d):null,o.a.createElement(s.EuiContextMenuPanel,r()({},O,{items:j})))}));G.displayName="ContextMenuWithRouterSupport";const H=Object(i.memo)((({items:e,"data-test-subj":t,icon:n="boxesHorizontal"})=>{const a=Object(z.a)(t),[l,c]=Object(i.useState)(!1),d=Object(i.useCallback)((()=>c(!1)),[c]),p=Object(i.useCallback)((()=>c(!l)),[l]),m=Object(i.useMemo)((()=>({"data-test-subj":a("popoverPanel")})),[a]),f=Object(i.useMemo)((()=>e.map((e=>o.a.createElement(U.a,r()({},e,{key:Object(V.v4)(),onClick:t=>{if(d(),e.onClick)return e.onClick(t)}}))))),[d,e]);return o.a.createElement(s.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:m,"data-test-subj":t,button:o.a.createElement(s.EuiButtonIcon,{"data-test-subj":a("button"),iconType:n,onClick:p,"aria-label":u.i18n.translate("xpack.securitySolution.actionsContextMenu.label",{defaultMessage:"Open"})}),isOpen:l,closePopover:d},o.a.createElement(s.EuiContextMenuPanel,{items:f,"data-test-subj":a("contextMenuPanel")}))}));H.displayName="ActionsContextMenu";const W=Object(i.memo)((({actions:e,"data-test-subj":t})=>e&&e.length>0?o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(H,{items:e,icon:"boxesHorizontal","data-test-subj":t})):null));W.displayName="CardActionsFlexItem";const Q=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemSmallBottomMargin",componentId:"sc-1orjmip-0"})(["margin-bottom:4px !important;"]),Y=Object(i.memo)((({name:e,createdDate:t,updatedDate:n,actions:a,"data-test-subj":r})=>{const i=Object(z.a)(r);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart","data-test-subj":r},o.a.createElement(Q,{grow:!0},o.a.createElement(s.EuiFlexGroup,{alignItems:"flexStart"},o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiTitle,{size:"s"},o.a.createElement("h3",{"data-test-subj":i("title")},e))),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xl"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement($,{date:n,type:"update","data-test-subj":i("updated")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement($,{date:t,type:"create","data-test-subj":i("created")})))))),o.a.createElement(W,{actions:a,"data-test-subj":i("actions")}))}));Y.displayName="CardHeader";const K=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oz5dfu-0"})(["margin:6px;"]),Z=Object(i.memo)((({createdBy:e,updatedBy:t,"data-test-subj":n})=>{const a=Object(z.a)(n);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"l",responsive:!1,"data-test-subj":n},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:f,value:e,"data-test-subj":a("createdBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:m,value:t,"data-test-subj":a("updatedBy")})))}));Z.displayName="TouchedByUsers";const X=Object(i.memo)((({label:e,value:t,"data-test-subj":n})=>{const a=Object(z.a)(n);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!1,responsive:!1,"data-test-subj":n},o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiBadge,{"data-test-subj":a("label")},e)),o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center",wrap:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiAvatar,{name:t,size:"s","data-test-subj":a("avatar")})),o.a.createElement(s.EuiFlexItem,{grow:!1,className:"eui-textTruncate","data-test-subj":a("value")},o.a.createElement(q,null,t)))))}));X.displayName="UserName";var J=n(42),ee=n(140);const te=c()("div").withConfig({displayName:"StyledWithContextMenuShiftedWrapper",componentId:"sc-d4sgp-0"})(["margin-left:-10px;"]),ne=c()(s.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-d4sgp-1"})(["height:10px !important;"]),ae=Object(i.memo)((({policies:e,loadingPoliciesList:t=!1,"data-test-subj":n})=>{const a=Object(z.a)(n),{canReadPolicyManagement:r}=Object(ee.a)().endpointPrivileges,[l,c]=Object(i.useMemo)((()=>e?["partial",b(e.length)]:["globe",g]),[e]),u=o.a.createElement(s.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"s","data-test-subj":n},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:l,size:"s"})),o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":a("value")},o.a.createElement(q,{size:"xs"},c)));return e&&e.length?o.a.createElement(te,null,o.a.createElement(re,{policies:e,loadingPoliciesList:t,canReadPolicies:r,"data-test-subj":a("popupMenu")},u)):u}));ae.displayName="EffectScope";const re=Object(i.memo)((({policies:e,loadingPoliciesList:t=!1,canReadPolicies:n,children:a,"data-test-subj":r})=>{const l=Object(z.a)(r),c=Object(i.useMemo)((()=>n?o.a.createElement(ne,{flush:"right",size:"s",iconSide:"right",iconType:"popout"},o.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.contextMenuItemByRouter.viewDetails",defaultMessage:"View details"})):void 0),[n]);return o.a.createElement(G,{maxHeight:"235px",fixedWidth:!0,panelPaddingSize:"none",items:e,anchorPosition:e.length>1?"rightCenter":"rightUp","data-test-subj":r,loading:t,hoverInfo:c,button:o.a.createElement(s.EuiButtonEmpty,{size:"xs","data-test-subj":l("button")},a),title:y(e.length),isNavigationDisabled:!n})}));re.displayName="WithContextMenu";const ie=Object(i.memo)((({createdBy:e,updatedBy:t,policies:n,loadingPoliciesList:a=!1,"data-test-subj":r})=>{const i=Object(z.a)(r);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",responsive:!0,"data-test-subj":r},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(Z,{createdBy:e,updatedBy:t,"data-test-subj":i("touchedBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(ae,{policies:n,loadingPoliciesList:a,"data-test-subj":i("effectScope")})))}));ie.displayName="CardSubHeader";var oe=n(403);const se=Object.freeze({linux:M,mac:_,macos:_,windows:C}),le=Object.freeze({[oe.b.NESTED]:j,[oe.b.MATCH_ANY]:O,[oe.b.MATCH]:h,[oe.b.WILDCARD]:E,[oe.b.EXISTS]:w,[oe.b.LIST]:k}),ce=Object.freeze({[oe.b.MATCH_ANY]:S,[oe.b.MATCH]:v,[oe.b.WILDCARD]:x}),ue=c()(s.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-1oxtqy5-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),de=c()(s.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-1oxtqy5-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),pe=c()("span").withConfig({displayName:"StyledCondition",componentId:"sc-1oxtqy5-2"})(["margin-right:6px;"]),me=Object(i.memo)((({os:e,entries:t,"data-test-subj":n})=>{const a=Object(z.a)(n),r=Object(i.useMemo)((()=>e.map((e=>{var t;return null!==(t=se[e])&&void 0!==t?t:e})).join(", ")),[e]),l=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>o.a.createElement(s.EuiBadge,{color:"hollow"},e))):t,c=(e,t)=>{var n,a;return"nested"===e?"":"included"===t?null!==(n=le[e])&&void 0!==n?n:e:null!==(a=ce[e])&&void 0!==a?a:e},u=Object(i.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((({field:e,type:t,value:n,operator:r})=>o.a.createElement(ue,{"data-test-subj":a("nestedCondition"),key:e+t+n,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiToken,{iconType:"tokenNested",size:"s"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:"",value:e,color:"subdued"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:c(t,r),value:l(t,n)})))))}),[a]);return o.a.createElement("div",{"data-test-subj":n},o.a.createElement("div",{"data-test-subj":a("os")},o.a.createElement("strong",null,o.a.createElement(s.EuiExpression,{description:"",value:I}),o.a.createElement(s.EuiExpression,{description:h,value:r}))),t.map((({field:e,type:t,value:n,operator:r,entries:i=[]})=>o.a.createElement("div",{"data-test-subj":a("condition"),key:e+t+n},o.a.createElement("div",{className:"eui-xScroll"},o.a.createElement(s.EuiExpression,{description:o.a.createElement(pe,null,T),value:e,color:"subdued"}),o.a.createElement(s.EuiExpression,{description:c(t,r),value:l(t,n)})),u(t,i)))))}));me.displayName="CriteriaConditions";const fe=e=>"effectScope"in e;var ge=n(245);const be=e=>(e=>{const t=e.filter((e=>e.startsWith(ge.b)));return t.some((e=>e===`${ge.b}all`))?{type:"global"}:{type:"policy",policies:t.map((e=>e.substr(ge.b.length)))}})(e.tags),ye=e=>Object(i.useMemo)((()=>(e=>{var t;const n=e,{name:a,created_by:r,created_at:i,updated_at:o,updated_by:s,description:l="",entries:c}=n;return{name:a,created_by:r,created_at:i,updated_at:o,updated_by:s,description:l,comments:fe(n)?[]:n.comments,entries:c,os:fe(n)?[n.os]:null!==(t=n.os_types)&&void 0!==t?t:[],effectScope:fe(n)?n.effectScope:be(n)}})(e)),[e]),he=c()(s.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-1qnczpg-0"})(["&.artifactEntryCard + &.artifactEntryCard{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),ve=Object(i.memo)((({className:e,...t})=>o.a.createElement(he,r()({},t,{hasBorder:!0,paddingSize:"none",className:`artifactEntryCard ${null!=e?e:""}`}))));ve.displayName="CardContainerPanel";const Ee=c()(s.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1aw8s5s-0"})(["padding:32px;&.top-section{padding-bottom:24px;}&.bottom-section{padding-top:24px;}&.artifact-entry-collapsible-card{padding:24px !important;}"]),xe=Object(i.memo)((e=>o.a.createElement(Ee,r()({},e,{hasBorder:!1,hasShadow:!1,paddingSize:"l"}))));xe.displayName="CardSectionPanel";var je=n(44),Oe=n(353);const Se=c()(s.EuiAvatar).withConfig({displayName:"CustomEuiAvatar",componentId:"sc-3lb0zi-0"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightShade)),we=Object(i.memo)((({comments:e,"data-test-subj":t})=>{const n=Object(z.a)(t),[a,r]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{r(!a)}),[r,a]),c=Object(i.useMemo)((()=>(e=>e.map((e=>({username:e.created_by,timestamp:o.a.createElement(F.b,{value:e.created_at,dateFormat:"MMM D, YYYY"}),event:Oe.b,timelineAvatar:o.a.createElement(Se,{size:"s",name:e.created_by}),children:o.a.createElement(s.EuiText,{size:"s"},e.comment)}))))(e)),[e]),d=Object(i.useMemo)((()=>a?((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.hide",{defaultMessage:"Hide comments ({count})",values:{count:e}}))(e.length):((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.show",{defaultMessage:"Show comments ({count})",values:{count:e}}))(e.length)),[e.length,a]);return Object(je.isEmpty)(e)?null:o.a.createElement("div",{"data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiButtonEmpty,{onClick:l,flush:"left",size:"xs","data-test-subj":n("label")},d),o.a.createElement(s.EuiAccordion,{id:"1",arrowDisplay:"none",forceState:a?"open":"closed"},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiCommentList,{comments:c,"data-test-subj":n("list")})))}));we.displayName="CardComments";const ke=(e,t)=>Object(i.useMemo)((()=>"policy"===e.effectScope.type?null==e?void 0:e.effectScope.policies.map((e=>t&&t[e]?t[e]:{children:e})):void 0),[e.effectScope,t]),Ie=Object(i.memo)((({truncate:e,children:t,"data-test-subj":n,withTooltip:a})=>o.a.createElement(q,{size:"m",truncate:e,"data-test-subj":n,withTooltip:a},t||Object(L.e)())));Ie.displayName="ArtifactDescription";const Te=Object(i.memo)((({item:e,policies:t,loadingPoliciesList:n=!1,actions:a,hideDescription:i=!1,hideComments:l=!1,Decorator:c,"data-test-subj":u,...d})=>{const p=ye(e),m=Object(z.a)(u),f=ke(p,t);return o.a.createElement(ve,r()({},d,{"data-test-subj":u}),o.a.createElement(xe,{className:"top-section"},o.a.createElement(Y,{name:p.name,createdDate:p.created_at,updatedDate:p.updated_at,actions:a,"data-test-subj":m("header")}),o.a.createElement(ie,{createdBy:p.created_by,updatedBy:p.updated_by,policies:f,loadingPoliciesList:n,"data-test-subj":m("subHeader")}),!i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(Ie,{"data-test-subj":m("description")},p.description)),l?null:o.a.createElement(o.a.Fragment,null,i&&o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(we,{comments:p.comments,"data-test-subj":m("comments")}))),o.a.createElement(s.EuiHorizontalRule,{margin:"none"}),o.a.createElement(xe,{className:"bottom-section"},c&&o.a.createElement(c,{item:e,"data-test-subj":m("decorator")}),o.a.createElement(me,{os:p.os,entries:p.entries,"data-test-subj":m("criteriaConditions")})))}));Te.displayName="ArtifactEntryCard";const Ce=c()(s.EuiSplitPanel.Outer).withConfig({displayName:"CardContainerPanel",componentId:"sc-lh5b0s-0"})(["&.artifactEntryCardMinified + &.artifactEntryCardMinified{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),Me=c()(s.EuiSplitPanel.Inner).withConfig({displayName:"CustomSplitInnerPanel",componentId:"sc-lh5b0s-1"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),_e=Object(i.memo)((({item:e,isSelected:t=!1,onToggleSelectedArtifact:n,"data-test-subj":a,Decorator:l,...c})=>{var u;const d=ye(e),p=Object(z.a)(a),[m,f]=Object(i.useState)("closed"),g=Object(i.useCallback)((()=>{f((e=>"closed"===e?"open":"closed"))}),[]),b=Object(i.useCallback)((()=>"open"===m?"Hide details":"Show details"),[m]),y=Object(i.useMemo)((()=>o.a.createElement(Me,null,o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiCheckbox,{id:d.name,"data-test-subj":`${d.name}_checkbox`,checked:t,onChange:()=>n(!t)})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":p("title")},d.name)))))),[d.name,p,t,n]);return o.a.createElement(Ce,r()({},c,{"data-test-subj":a,className:`${null!==(u=c.className)&&void 0!==u?u:""}  artifactEntryCardMinified`,id:d.name,hasShadow:!1,hasBorder:!0}),y,o.a.createElement(s.EuiSplitPanel.Inner,{paddingSize:"s"},o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":p("descriptionTitle")},A)),o.a.createElement(Ie,{"data-test-subj":p("description")},d.description)),o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiButtonEmpty,{"data-test-subj":p("collapse"),color:"primary",size:"s",flush:"left",iconType:"open"===m?"arrowUp":"arrowDown",iconSide:"right",iconSize:"m",onClick:g,style:{fontWeight:400}},b()),o.a.createElement(s.EuiAccordion,{id:"showDetails",arrowDisplay:"none",forceState:m},l&&o.a.createElement(l,{item:e,"data-test-subj":p("decorator")}),o.a.createElement(me,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")})))))}));_e.displayName="ArtifactEntryCardMinified";const De=Object(i.memo)((({expanded:e,onClick:t,"data-test-subj":n})=>o.a.createElement(s.EuiButtonIcon,{iconType:e?"arrowUp":"arrowDown",onClick:t,"data-test-subj":n,"aria-label":e?N:D})));De.displayName="CardExpandButton";const Ne=Object(i.memo)((({artifact:e,onExpandCollapse:t,policies:n,actions:a,expanded:r=!1,"data-test-subj":s})=>{const l=Object(z.a)(s),c=ke(e,n),u=Object(i.useCallback)((()=>{t()}),[t]);return o.a.createElement(Pe,{"data-test-subj":s,expanded:r,expandToggle:o.a.createElement(De,{expanded:r,onClick:u,"data-test-subj":l("expandCollapse")}),name:o.a.createElement(q,{bold:!0,truncate:!r,withTooltip:!r},e.name),description:o.a.createElement(Ie,{truncate:!r,withTooltip:!r},e.description),effectScope:o.a.createElement(ae,{policies:c,"data-test-subj":l("effectScope")}),actionMenu:o.a.createElement(W,{actions:a,"data-test-subj":l("actions")})})}));Ne.displayName="CardCompressedHeader";const Ae=c.a.div.withConfig({displayName:"ButtonIconPlaceHolder",componentId:"sc-j6qhqr-0"})(["display:inline-block;width:",";height:",";"],(({theme:e})=>e.eui.euiSizeL),(({theme:e})=>e.eui.euiSizeL)),Fe=c()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-j6qhqr-1"})(["&.flushTop,.flushTop{padding-top:0;margin-top:0;}"]),Pe=Object(i.memo)((({expanded:e,name:t,expandToggle:n,effectScope:a,actionMenu:r,description:l,"data-test-subj":c,flushTop:u})=>{const d=Object(z.a)(c),p=(e=>Object(i.useMemo)((()=>R()({"eui-textTruncate":!e})),[e]))(e),m=u?" flushTop":"";return o.a.createElement(Fe,{responsive:!1,alignItems:"center","data-test-subj":c,className:m},o.a.createElement(s.EuiFlexItem,{grow:!1,className:m,"data-test-subj":d("expandCollapseHolder")},n),o.a.createElement(s.EuiFlexItem,{className:p+m},o.a.createElement(s.EuiFlexGroup,{alignItems:"center",className:m},o.a.createElement(s.EuiFlexItem,{grow:2,className:p+m,"data-test-subj":d("titleHolder")},t),o.a.createElement(s.EuiFlexItem,{grow:3,className:p+m,"data-test-subj":d("descriptionHolder")},l),o.a.createElement(s.EuiFlexItem,{grow:1,"data-test-subj":d("effectScopeHolder"),className:m},a))),!0===r?o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":d("cardActionsPlaceholder"),className:m},o.a.createElement(Ae,null)):r)}));Pe.displayName="CardCompressedHeaderLayout";const Re=Object(i.memo)((({item:e,onExpandCollapse:t,policies:n,actions:a,expanded:i=!1,"data-test-subj":l,Decorator:c,...u})=>{const d=ye(e),p=Object(z.a)(l);return o.a.createElement(ve,r()({},u,{"data-test-subj":l}),o.a.createElement(xe,{className:"artifact-entry-collapsible-card"},o.a.createElement(Ne,{artifact:d,actions:a,policies:n,expanded:i,onExpandCollapse:t,"data-test-subj":p("header")})),i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(xe,null,c&&o.a.createElement(c,{item:e,"data-test-subj":p("decorator")}),o.a.createElement(me,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")}))))}));Re.displayName="ArtifactEntryCollapsibleCard";var Le=n(782)},function(e,t,n){"use strict";n.d(t,"b",(function(){return Ot})),n.d(t,"a",(function(){return Mt}));var a=n(119),r=n.n(a),i=n(19),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(7),d=n(175),p=n(379),m=n(740),f=n(122),g=n(829),b=n(305),y=n(758),h=n(170),v=n(1393),E=n(272);const x=c.a.div.withConfig({displayName:"EuiCodeEditorContainer",componentId:"sc-a6c5kq-0"})([".euiCodeEditorWrapper{position:absolute;}"]),j=s.a.memo((({rawEventData:e})=>{const t=Object(o.useMemo)((()=>JSON.stringify(e,E.j,2)),[e]);return s.a.createElement(x,null,s.a.createElement(i.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",isCopyable:!0,"data-test-subj":"jsonView"},t))}));j.displayName="JsonView";var O=n(244),S=n(42),w=n(226),k=n(137),I=n(130),T=n(666),C=n(521);const M=({risk:e,riskEntity:t,originalRisk:n})=>{var a,r,o,l,c,u,d,p;const m=t===k.t.host?null==e||null===(a=e.result)||void 0===a||null===(r=a[0])||void 0===r||null===(o=r.host)||void 0===o||null===(l=o.risk)||void 0===l?void 0:l.calculated_level:null==e||null===(c=e.result)||void 0===c||null===(u=c[0])||void 0===u||null===(d=u.user)||void 0===d||null===(p=d.risk)||void 0===p?void 0:p.calculated_level;return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:s.a.createElement(C.a,{title:O.o(t),riskScoreEntity:t}),toolTipTitle:s.a.createElement(C.a,{title:O.o(t),riskScoreEntity:t}),toolTipContent:s.a.createElement(S.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.riskDataTooltipContent",defaultMessage:"Risk level is displayed only when available for a {riskEntity}. Ensure {riskScoreDocumentationLink} is enabled within your environment.",values:{riskEntity:t,riskScoreDocumentationLink:s.a.createElement(T.a,{title:O.p})}})}),e.loading&&s.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading"}),!e.loading&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Y,{field:O.a(t),value:m?s.a.createElement(w.a,{severity:m,hideBackgroundColor:!0}):Object(I.e)()}),n&&m!==n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Y,{field:O.m(t),value:s.a.createElement(w.a,{severity:n,hideBackgroundColor:!0})})))))},_=s.a.memo(M);var D=n(44),N=n(173),A=n(336),F=n(422),P=n(131);const R=c.a.span.withConfig({displayName:"EnrichmentFieldFeedName",componentId:"sc-1cy82j8-0"})(["white-space:nowrap;font-style:italic;"]),L=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1cy82j8-1"})([".inlineActions{opacity:0;}.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}"]),q=({data:e,eventId:t,index:n,feedName:a,scopeId:r,value:l,isDraggable:c,isReadOnly:u})=>{const d=Object(o.useMemo)((()=>({scopeId:r})),[r]);if(!e||!l)return null;const p=`alert-details-value-formatted-field-value-${r}-${t}-${e.field}-${l}-${n}-${a}`;return s.a.createElement(L,{key:p,direction:"row",gutterSize:"xs",alignItems:"center"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("div",null,s.a.createElement(F.a,{contextId:r,eventId:p,fieldFormat:e.format,fieldName:e.field,fieldType:e.type,isDraggable:c,isObjectArray:e.isObjectArray,value:l,truncate:!1}),a&&s.a.createElement(R,null," ",O.e," ",a))),s.a.createElement(i.EuiFlexItem,null,l&&!u&&s.a.createElement(N.c,{data:{field:e.field,value:l},triggerId:N.d.DETAILS_FLYOUT,mode:N.a.INLINE,sourcererScopeId:Object(P.getSourcererScopeId)(r),metadata:d,visibleCellActions:3})))},z=({browserFields:e,data:t,enrichments:n,scopeId:a,eventId:r,isDraggable:o,isReadOnly:l})=>{const c=n.map(((n,a)=>{var r,i,o,s;const{field:l,type:c,feedName:u,value:d}=Object(A.d)(n),p=t.find((e=>e.field===l)),m=null!==(r=null==p?void 0:p.category)&&void 0!==r?r:"",f=Object(D.get)([m,"fields",null!=l?l:""],e);return{fieldsData:{field:null!=l?l:"",format:null!==(i=null==f?void 0:f.format)&&void 0!==i?i:"",type:null!==(o=null==f?void 0:f.type)&&void 0!==o?o:"",isObjectArray:null!==(s=null==p?void 0:p.isObjectArray)&&void 0!==s&&s},type:c,feedName:u,index:a,field:l,browserField:f,value:d}})),[d,p]=Object(u.partition)(c,(({type:e})=>Object(A.f)(e)));return s.a.createElement(s.a.Fragment,null,p.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:O.f,toolTipContent:O.g}),p.map((({fieldsData:e,index:t,field:n,feedName:i,browserField:c,value:u})=>s.a.createElement(Y,{key:n,field:n,value:s.a.createElement(q,{eventId:r,index:t,feedName:i,scopeId:a,value:u,data:e,isDraggable:o,isReadOnly:l})}))))),d.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:O.h,toolTipContent:O.j}),d.map((({fieldsData:e,index:t,field:n,feedName:i,browserField:c,value:u})=>s.a.createElement(Y,{key:n,field:n,value:s.a.createElement(q,{eventId:r,index:t,feedName:i,scopeId:a,value:u,data:e,isDraggable:o,isReadOnly:l})}))))))},B=s.a.memo(z);var $=n(350),V=n(357);const U=c()(i.EuiTitle).withConfig({displayName:"UppercaseEuiTitle",componentId:"sc-1az7ye2-0"})(["text-transform:uppercase;"]),G=({children:e})=>s.a.createElement(U,{size:"xxxs"},s.a.createElement("h5",null,e)),H=c()(i.EuiTitle).withConfig({displayName:"StyledEnrichmentFieldTitle",componentId:"sc-1az7ye2-1"})(["width:220px;"]),W=({title:e})=>s.a.createElement(H,{size:"xxxs"},s.a.createElement("h6",null,e)),Q=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1az7ye2-2"})(["font-size:",";margin-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeS)),Y=({field:e,value:t})=>s.a.createElement(Q,{direction:"row",gutterSize:"none",responsive:!0,alignItems:"center","data-test-subj":"EnrichedDataRow"},s.a.createElement(i.EuiFlexItem,{style:{flexShrink:0},grow:!1},s.a.createElement(W,{title:e})),s.a.createElement(i.EuiFlexItem,{className:"eui-textBreakWord"},t)),K=({title:e,toolTipContent:t,toolTipTitle:n})=>s.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(G,null,e)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(V.b,{toolTipContent:t,toolTipTitle:null!=n?n:e}))),Z=({browserFields:e,data:t,enrichments:n,eventId:a,scopeId:r,hostRisk:o,userRisk:l,isDraggable:c,isReadOnly:u})=>{var d,p,m,f;const g=null==t||null===(d=t.find((e=>"host.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===d||null===(p=d.values)||void 0===p?void 0:p[0],b=null==t||null===(m=t.find((e=>"user.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===m||null===(f=m.values)||void 0===f?void 0:f[0],y=Object($.a)("entity-analytics");return y||0!==n.length?s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,O.b)),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{flexGrow:0}},y&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:k.t.host,risk:o,originalRisk:g})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:k.t.user,risk:l,originalRisk:b}))),s.a.createElement(B,{browserFields:e,data:t,enrichments:n,scopeId:r,eventId:a,isDraggable:c,isReadOnly:u}))):null},X=s.a.memo(Z);var J=n(741),ee=n(197),te=n(549);const ne=c()(i.EuiInMemoryTable).withConfig({displayName:"SummaryTable",componentId:"sc-12oammb-0"})([".inlineActions{opacity:0;}.flyoutTableHoverActions{.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}}"]);var ae=n(1348),re=n(284),ie=n(149);const oe={flexGrow:0},se=({data:e,eventId:t,fieldFromBrowserField:n,isDraggable:a,linkValue:r,scopeId:i,values:o,isReadOnly:l})=>{const c=Object(re.e)(e.field);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ae.a,{contextId:i,data:e,eventId:t,fieldFromBrowserField:n,linkValue:r,isDraggable:a,style:oe,values:o}),i!==ie.f.active&&!l&&c&&s.a.createElement(N.c,{data:{field:e.field,value:o},triggerId:N.d.DETAILS_FLYOUT,mode:N.a.INLINE,visibleCellActions:3,sourcererScopeId:Object(P.getSourcererScopeId)(i),metadata:{scopeId:i}}))};se.displayName="SummaryValueCell";var le=n(263),ce=n(302),ue=n(352);const de=({data:e,eventId:t,fieldFromBrowserField:n,linkValue:a,scopeId:r,values:o})=>{const{loading:l,count:c}=Object(ue.a)({field:e.field,isActiveTimelines:r===ie.f.active,value:o,signalIndexName:null}),u=Object(ce.c)({contextId:r,eventId:t,field:e.field,fieldFormat:e.format,fieldFromBrowserField:n,fieldType:e.type,isObjectArray:e.isObjectArray,linkValue:a,values:o});return l?s.a.createElement(i.EuiLoadingSpinner,null):"number"==typeof c&&null!=u&&u.dataProviders&&null!=u&&u.dataProviders.length?s.a.createElement(le.a,{asEmptyButton:!0,dataProviders:u.dataProviders,filters:u.filters},s.a.createElement("span",{"data-test-subj":"alert-prevalence"},c)):Object(I.d)()};de.displayName="PrevalenceCell";const pe=[{field:"title",truncateText:!1,name:ee.o,textOnly:!0},{field:"description",truncateText:!1,render:se,name:ee.p}],me=[...pe,{field:"description",truncateText:!0,render:e=>s.a.createElement(de,e),name:s.a.createElement(s.a.Fragment,null,ee.m," ",s.a.createElement(i.EuiIconTip,{type:"iInCircle",color:"subdued",title:ee.m,content:s.a.createElement("span",null,ee.n)})),align:"right",width:"130px"}],fe={className:"flyoutTableHoverActions"},ge=({goToTable:e,rows:t,title:n,isReadOnly:a})=>{const r=a?pe:me;return s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,null,s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,n))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiLink,{onClick:e,"data-test-subj":"summary-view-go-to-table-link"},s.a.createElement(i.EuiText,{size:"xs"},ee.F)))),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(ne,{"data-test-subj":"summary-view",items:t,columns:r,rowProps:fe,compressed:!0}))},be=s.a.memo(ge),ye=({browserFields:e,data:t,eventId:n,isDraggable:a,scopeId:r,title:i,goToTable:o,isReadOnly:l,investigationFields:c})=>{const u=Object(te.c)({browserFields:e,data:t,eventId:n,isDraggable:a,scopeId:r,isReadOnly:l,investigationFields:c});return s.a.createElement(be,{goToTable:o,isReadOnly:l,rows:u,title:i})},he=s.a.memo(ye);var ve=n(441),Ee=n(728),xe=n(394),je=n(59),Oe=n(172),Se=n(229);const we=je.euiStyled.div`
  margin-left: ${({theme:e})=>e.eui.euiSizeS};
`,ke=Object(je.euiStyled)(i.EuiPanel)`
  &&& {
    background-color: ${({theme:e})=>e.eui.euiColorLightestShade};
    padding: ${({theme:e})=>e.eui.euiSizeS};
    height: 78px;
  }

  &:hover {
    .inlineActions {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
  }

  .inlineActions {
    opacity: 0;
    width: 0;
    transform: translate(6px);
    transition: transform 50ms ease-in-out;

    &.inlineActions-popoverOpen {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
   }
`,Ie=({title:e,children:t})=>s.a.createElement(ke,{borderRadius:"none",hasShadow:!1,hasBorder:!1,paddingSize:"s"},s.a.createElement(i.EuiText,{size:"s"},e),s.a.createElement(i.EuiSpacer,{size:"s"}),t);Ie.displayName="OverviewCard";const Te=je.euiStyled.div`
  /* Clamp text content to 2 lines */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
`;Te.displayName="ClampedContent";const Ce=({title:e,children:t,contextId:n,dataTestSubj:a,enrichedFieldInfo:r})=>s.a.createElement(Ie,{title:e},s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(Te,{"data-test-subj":a},t),s.a.createElement(we,null,s.a.createElement(N.c,{data:{field:r.data.field,value:null==r?void 0:r.values},triggerId:N.d.DETAILS_FLYOUT,mode:N.a.INLINE,sourcererScopeId:Object(P.getSourcererScopeId)(n),metadata:{scopeId:n},visibleCellActions:3}))));Ce.displayName="OverviewCardWithActions";var Me=n(831),_e=n(298),De=n(984);const Ne=Object(je.euiStyled)(i.EuiFlexGroup)`
  flex-grow: 0;
`,Ae=s.a.memo((({browserFields:e,contextId:t,data:n,eventId:a,handleOnEventClosed:r,scopeId:l,isReadOnly:c})=>{const u=Object(o.useMemo)((()=>{const r=Object(D.find)({field:Se.o,category:"kibana"},n);return r&&Object(re.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,n,a,l]),d=Object(o.useMemo)((()=>{const r=Object(D.find)({field:"kibana.alert.severity",category:"kibana"},n);return r&&Object(re.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,n,a,l]),p=Object(o.useMemo)((()=>{const r=Object(D.find)({field:"kibana.alert.risk_score",category:"kibana"},n);return r&&Object(re.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,n,a,l]),m=Object(o.useMemo)((()=>{const r=Object(D.find)({field:Se.n,category:"kibana"},n),i=Object(D.find)({field:"kibana.alert.rule.uuid",category:"kibana"},n);return r&&Object(re.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:r,linkValueField:i})}),[e,t,n,a,l]),f=Fe(u)&&!c?s.a.createElement(i.EuiFlexItem,{key:"status"},s.a.createElement(Ce,{title:Oe.P,enrichedFieldInfo:u,contextId:t},s.a.createElement(Me.a,{eventId:a,contextId:t,enrichedFieldInfo:u,scopeId:l,handleOnEventClosed:r}))):null,g=Fe(d)?s.a.createElement(i.EuiFlexItem,{key:"severity"},c?s.a.createElement(Ie,{title:Oe.w},s.a.createElement(_e.a,{value:d.values[0]})):s.a.createElement(Ce,{title:Oe.w,enrichedFieldInfo:d,contextId:t},s.a.createElement(_e.a,{value:d.values[0]}))):null,b=Fe(p)?s.a.createElement(i.EuiFlexItem,{key:"riskScore"},c?s.a.createElement(Ie,{title:Oe.s},p.values[0]):s.a.createElement(Ce,{title:Oe.s,enrichedFieldInfo:p,contextId:t,dataTestSubj:"riskScore"},p.values[0])):null,y=Fe(m)&&!c?s.a.createElement(i.EuiFlexItem,{key:"ruleName"},s.a.createElement(Ce,{title:Oe.t,enrichedFieldInfo:m,contextId:t},s.a.createElement(F.a,{contextId:t,eventId:a,value:m.values[0],fieldName:m.data.field,linkValue:m.linkValue,fieldType:m.data.type,fieldFormat:m.data.format,isDraggable:!1,truncate:!1}))):null,{width:h,ref:v}=Object(De.a)(),E=0===h||h&&h>=675,x=[f,g,b,y].filter(Pe),j=E?s.a.createElement(Ne,{gutterSize:"s"},x):s.a.createElement(s.a.Fragment,null,Object(D.chunk)(2,x).map(((e,t,{length:n})=>{const a=t<n-1;return s.a.createElement(o.Fragment,{key:t},s.a.createElement(Ne,{gutterSize:"s"},e),a&&s.a.createElement(i.EuiSpacer,{size:"s"}))})));return s.a.createElement("div",{ref:v},j)}));function Fe(e){return!!e&&Array.isArray(e.values)}function Pe(e){return null!==e}Ae.displayName="Overview";var Re=n(813),Le=n(36),qe=n(253);function ze(e){return Boolean(e&&e.values&&e.values.length)}var Be=n(16),$e=n(539);const Ve=Object(je.euiStyled)(i.EuiAccordion)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
`,Ue=s.a.memo((({prefix:e,state:t,text:n,renderContent:a,onToggle:r=D.noop,extraAction:o,forceState:l})=>{const c=Object(i.useGeneratedHtmlId)({prefix:e});switch(t){case"loading":return s.a.createElement(Ve,{id:c,buttonContent:n,onToggle:r,isLoading:!0});case"error":return s.a.createElement(Ve,{id:c,buttonContent:s.a.createElement("span",null,s.a.createElement(i.EuiIcon,{type:"warning",color:"danger",style:{marginRight:"6px"}}),n),onToggle:r,extraAction:o});case"success":return s.a.createElement(Ve,{"tour-step":`${e}-accordion`,"data-test-subj":`${e}-accordion`,id:c,buttonContent:n,onToggle:r,paddingSize:"l",extraAction:o,forceState:l},a());default:return null}}));Ue.displayName="InsightAccordion";var Ge=n(151),He=n(381),We=n(380);const Qe=["*"],Ye=(e,t)=>({fields:t,_source:!1,query:{ids:{values:e}}}),Ke=["@timestamp","kibana.alert.rule.name","kibana.alert.severity"],Ze=[{field:"kibana.alert.rule.name",name:"Rule"},{field:"@timestamp",name:"@timestamp",render:e=>s.a.createElement(Ge.c,{value:new Date(e)})},{field:"kibana.alert.severity",name:"Severity",render:e=>s.a.createElement(_e.a,{value:e})}],Xe=s.a.memo((({alertIds:e})=>{const t=Object(o.useMemo)((()=>e.slice(0,10)),[e]),{loading:n,error:a,data:r}=(({alertIds:e,fields:t=Qe})=>{const[n]=Object(o.useState)((()=>Ye(e,t))),{loading:a,data:r,setQuery:i}=Object(He.a)({query:n,queryName:We.a.BY_ID});return Object(o.useEffect)((()=>{i(Ye(e,t))}),[i,e,t]),{loading:a,error:!a&&void 0===r,data:null==r?void 0:r.hits.hits}})({alertIds:t,fields:Ke}),l=Object(o.useMemo)((()=>{if(r)return r.map((e=>e.fields))}),[r]);if(n)return s.a.createElement(i.EuiSkeletonText,{lines:2});if(a)return s.a.createElement(s.a.Fragment,null,qe.p);if(l){const t=e.length>10;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("div",null,s.a.createElement("em",null,qe.q),s.a.createElement(i.EuiSpacer,null)),s.a.createElement(i.EuiBasicTable,{compressed:!0,items:l,columns:Ze}))}return null}));Xe.displayName="SimpleAlertTable";const Je=s.a.memo((({originalDocumentId:e,index:t,eventId:n,scopeId:a})=>{const[r,i]=Object(o.useState)(!1),[l,c]=Object(o.useState)({}),u=Object(o.useCallback)((e=>i(e)),[]),d=Object(o.useCallback)((()=>r?l.alertIds?s.a.createElement(tt,{eventId:n,scopeId:a,alertIds:l.alertIds}):s.a.createElement(et,{index:t,originalDocumentId:e,eventId:n,isActiveTimelines:Object(P.isActiveTimeline)(null!=a?a:""),onCacheLoad:c}):null),[r,l.alertIds,t,e,n,a]);return s.a.createElement(Ue,{prefix:"RelatedAlertsByProcessAncestry",state:"success",text:l.alertIds?Object(qe.h)(l.alertIds.length):qe.g,renderContent:d,onToggle:u})}));Je.displayName="RelatedAlertsByProcessAncestry";const et=({originalDocumentId:e,index:t,isActiveTimelines:n,onCacheLoad:a,eventId:r})=>{const{values:l}=t,{values:c}=e,u=Array.isArray(c)?c[0]:"",{loading:d,error:p,alertIds:m}=Object($e.a)({isActiveTimeline:n,documentId:u,indices:null!=l?l:[]});return Object(o.useEffect)((()=>{m&&0!==m.length&&a({alertIds:m})}),[m,a]),d?s.a.createElement(i.EuiLoadingSpinner,null):p?s.a.createElement(s.a.Fragment,null,qe.j):m&&0!==m.length?null:s.a.createElement(s.a.Fragment,null,qe.i)};et.displayName="FetchAndNotifyCachedAlertsByProcessAncestry";const tt=({alertIds:e,eventId:t,scopeId:n})=>{const a=e&&e.length&&e.length>=5,r=Object(o.useMemo)((()=>e&&e.length?a?null:e.reduce(((e,a,r)=>{const i=`${n}-${t}-event.id-${r}-${a}`;return e.push(Object(ce.a)("_id",i,a)),e}),[]):null),[e,a,n,t]),l=Object(o.useMemo)((()=>a?[{meta:{alias:qe.k,type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null),[e,a]);return r||l?s.a.createElement(s.a.Fragment,null,s.a.createElement(Xe,{alertIds:e}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:r,filters:l,"data-test-subj":"investigate-ancestry-in-timeline"},Oe.i)):null};tt.displayName="ActualRelatedAlertsByProcessAncestry";var nt=n(256),at=n(118),rt=n(144),it=n(5);const ot=s.a.memo((({eventId:e})=>{const{services:{cases:t}}=Object(at.j)(),n=Object(at.n)(),[a,r]=Object(o.useState)(void 0),[i,l]=Object(o.useState)(!1),{activeStep:c,isTourShown:u}=Object(nt.b)(),d=Object(o.useMemo)((()=>c===h.a.viewCase&&u(h.b.alertsCases)),[c,u]),p=Object(o.useCallback)((()=>function(e=[]){const t=e.length;return s.a.createElement("span",null,s.a.createElement(S.FormattedMessage,{defaultMessage:"This alert was found in {caseCount}",id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content",values:{caseCount:s.a.createElement("strong",null,s.a.createElement(S.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content_count",defaultMessage:"{caseCount} {caseCount, plural, =0 {cases.} =1 {case:} other {cases:}}",values:{caseCount:t}}))}}),e.map((({id:t,title:n},a)=>t&&n?s.a.createElement("span",{key:t}," ",s.a.createElement(rt.a,{detailName:t,title:n,index:a},n),e[a+1]?",":""):s.a.createElement(s.a.Fragment,null))))}(a)),[a]),[m,f]=Object(o.useState)(!1);Object(o.useEffect)((()=>{if(!m)return;let a=!1;return(async()=>{let i=[];try{var o;e&&(i=null!==(o=await t.api.getRelatedCases(e,{owner:it.j}))&&void 0!==o?o:[])}catch(e){a||l(!0),n.addWarning(Object(qe.c)(e))}a||(r(i),f(!1))})(),()=>{a=!0}}),[t.api,e,m,n]),Object(o.useEffect)((()=>{f(!0)}),[e]);let g="loading";return i?g="error":a&&(g="success"),s.a.createElement(Ue,{prefix:"RelatedCases",state:g,text:st(g,null==a?void 0:a.length),renderContent:p,forceState:d?"open":void 0})}));function st(e,t=0){switch(e){case"loading":return qe.d;case"error":return qe.b;case"success":return Object(qe.a)(t);default:return""}}ot.displayName="RelatedCases";const lt=s.a.memo((({browserFields:e,data:t,eventId:n,scopeId:a})=>{const{field:r,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:r,value:l,isActiveTimelines:Object(P.isActiveTimeline)(a),signalIndexName:null,includeAlertIds:!0}),{fieldFromBrowserField:p}=Object(re.b)({browserFields:e,contextId:a,eventId:n,field:{id:t.field},scopeId:a,item:t}),m=Object(ce.c)({field:r,values:l,contextId:a,eventId:n,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),f=0===u;let g="loading";c?g="error":d&&(g="success");const b=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?f&&"loading"!==g?qe.s:s.a.createElement(s.a.Fragment,null,s.a.createElement(Xe,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},Oe.i)):null),[d,null==m?void 0:m.dataProviders,f,g]);return s.a.createElement(Ue,{prefix:"RelatedAlertsBySourceEvent",state:g,text:ct(g,u),renderContent:b})}));function ct(e,t){switch(e){case"loading":return qe.u;case"error":return qe.t;case"success":return Object(qe.r)(t);default:return""}}lt.displayName="RelatedAlertsBySourceEvent";const ut=s.a.memo((({browserFields:e,data:t,eventId:n,scopeId:a})=>{const{field:r,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:r,value:l,isActiveTimelines:Object(P.isActiveTimeline)(a),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0}),{fieldFromBrowserField:p}=Object(re.b)({browserFields:e,contextId:a,eventId:n,field:{id:t.field},scopeId:a,item:t}),m=Object(ce.c)({field:r,values:l,contextId:a,eventId:n,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),f=0===u;let g="loading";c?g="error":(d||f)&&(g="success");const b=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?f&&"loading"!==g?qe.m:s.a.createElement(s.a.Fragment,null,s.a.createElement(Xe,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},Oe.i)):null),[d,null==m?void 0:m.dataProviders,f,g]);return s.a.createElement(Ue,{prefix:"RelatedAlertsBySession",state:g,text:dt(g,u),renderContent:b})}));function dt(e,t){switch(e){case"loading":return qe.o;case"error":return qe.n;case"success":return Object(qe.l)(t);default:return""}}ut.displayName="RelatedAlertsBySession";const pt=je.euiStyled.div`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 12px;
  border-radius: 6px;
`,mt=Object(je.euiStyled)(i.EuiIcon)`
  margin-right: 10px;
`,ft=s.a.memo((()=>{const{application:e}=Object(at.j)().services;return s.a.createElement(pt,null,s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(mt,{size:"m",type:"lock"})),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiLink,{color:"subdued",target:"_blank",href:e.getUrlForApp("management",{path:"stack/license_management/home"})},qe.f)))))}));ft.displayName="RelatedAlertsUpsell";const gt=Object(je.euiStyled)(i.EuiFlexItem)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
  display: inline-flex;
`,bt=s.a.memo((({browserFields:e,eventId:t,data:n,isReadOnly:a,scopeId:r})=>{const{cases:o}=Object(at.j)().services,l=Object(Be.b)().isPlatinumPlus(),c=Object(D.find)({category:"kibana",field:"kibana.alert.ancestors.id"},n),u=Object(D.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},n),d=Object(D.find)({category:"agent",field:"agent.type"},n),p=Object(D.find)({category:"event",field:"event.module"},n),m=ze(Object(D.find)({category:"process",field:"process.entity_id"},n))&&function(e,t){return ze(e)&&("endpoint"===e.values[0]||"winlogbeat"===e.values[0]&&ze(t)&&"sysmon"===t.values[0])}(d,p),f=Object(D.find)({category:"process",field:"process.entry_leader.entity_id"},n),g=ze(f),b=Object(D.find)({category:"kibana",field:"kibana.alert.original_event.id"},n),y=ze(b),h=Object(D.find)({category:"kibana",field:Re.t},n),v=ze(h),E=o.helpers.canUseCases([Le.APP_ID]).read,x=m&&c&&u;return a||!(E||m||y||g)?null:s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,qe.e))),v&&s.a.createElement(gt,null,s.a.createElement("div",null,s.a.createElement(i.EuiIcon,{type:"layers",style:{marginLeft:"4px",marginRight:"8px"}}),qe.v(parseInt(h.values[0],10)),s.a.createElement(i.EuiBetaBadge,{label:qe.w,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}))),E&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(ot,{eventId:t})),b&&b.values&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(lt,{browserFields:e,data:b,eventId:t,scopeId:r})),f&&f.values&&s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-session"},s.a.createElement(ut,{browserFields:e,data:f,eventId:t,scopeId:r})),x&&(l?s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-ancestry"},s.a.createElement(Je,{originalDocumentId:c,index:u,eventId:t,scopeId:r})):s.a.createElement(i.EuiFlexItem,null,s.a.createElement(ft,null)))))}));bt.displayName="Insights";var yt=n(313);const ht={cursorStart:0,querySize:1};var vt=n(299),Et=n(150),xt=n(304),jt=n(729);let Ot=function(e){return e.tableView="table-view",e.jsonView="json-view",e.summaryView="summary-view",e.threatIntelView="threat-intel-view",e.osqueryView="osquery-results-view",e.responseActionsView="response-actions-results-view",e}({});const St=c()(i.EuiTabbedContent).withConfig({displayName:"StyledEuiTabbedContent",componentId:"sc-xa1bmm-0"})(["display:flex;flex:1;flex-direction:column;overflow:hidden;> [role='tabpanel']{display:flex;flex:1;flex-direction:column;overflow:hidden;overflow-y:auto;::-webkit-scrollbar{-webkit-appearance:none;width:7px;}::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,0.5);-webkit-box-shadow:0 0 1px rgba(255,255,255,0.5);}}"]),wt=c.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-xa1bmm-1"})(["height:100%;position:relative;"]),kt=c.a.div.withConfig({displayName:"RendererContainer",componentId:"sc-xa1bmm-2"})(["overflow-x:auto;padding-right:",";& ."," .euiFlexGroup{justify-content:flex-start;}"],(e=>e.theme.eui.euiSizeXS),Et.a),It=c()(i.EuiFlexGroup).withConfig({displayName:"ThreatTacticContainer",componentId:"sc-xa1bmm-3"})(["flex-grow:0;flex-wrap:nowrap;& .euiFlexGroup{flex-wrap:nowrap;}"]),Tt=c.a.div.withConfig({displayName:"ThreatTacticDescription",componentId:"sc-xa1bmm-4"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeL)),Ct=({browserFields:e,data:t,detailsEcsData:n,id:a,isAlert:l,isDraggable:c,rawEventData:E,scopeId:x,timelineTabType:O,handleOnEventClosed:S,isReadOnly:w})=>{var I;const[T,C]=Object(o.useState)(Ot.summaryView),M=Object(o.useCallback)((e=>C(e.id)),[]),_=Object(o.useCallback)((()=>C(Ot.tableView)),[]),D=Object(o.useMemo)((()=>Object(A.c)(t)),[t]),N=Object(d.b)(t),{rule:F}=Object(p.a)(N.ruleId),P=Object(o.useMemo)((()=>l?Object(A.g)(t).map((e=>Object(A.h)(e))):[]),[t,l]),{result:R,loading:L,setRange:q,range:z}=Object(ve.c)(D),B=Object(o.useMemo)((()=>Object(g.a)(E)),[E]),$=Object(o.useMemo)((()=>L||null==R||!R.enrichments?P:Object(A.b)([...P,...R.enrichments])),[L,R,P]),V=$.length,{hostRisk:U,userRisk:G,isAuthorized:H}=(e=>{const{hostName:t,userName:n}=Object(d.b)(e),a=Object(o.useMemo)((()=>t?Object(k.z)([t]):void 0),[t]),{data:r,loading:i,isAuthorized:s,isModuleEnabled:l}=Object(yt.a)({filterQuery:a,pagination:ht,riskEntity:k.t.host,skip:!a}),c=Object(o.useMemo)((()=>({loading:i,isModuleEnabled:l,result:r})),[r,i,l]),u=Object(o.useMemo)((()=>n?Object(k.A)([n]):void 0),[n]),{data:p,loading:m,isAuthorized:f,isModuleEnabled:g}=Object(yt.a)({filterQuery:u,pagination:ht,riskEntity:k.t.user,skip:!u});return{userRisk:Object(o.useMemo)((()=>({loading:m,isModuleEnabled:g,result:p})),[m,g,p]),hostRisk:c,isAuthorized:s&&f}})(t),W=Object(o.useMemo)((()=>null!=n?Object(vt.a)({data:n,rowRenderers:xt.b}):null),[n]),Q=Object(o.useMemo)((()=>Object(y.c)(x)),[x]),Y=Object(o.useMemo)((()=>V>0||H&&(U||G)),[V,U,H,G]),K=Object(f.a)("endpointResponseActionsEnabled"),Z=Object(o.useMemo)((()=>{var r,o;return l?{id:Ot.summaryView,name:ee.v,"data-test-subj":"overviewTab",content:s.a.createElement(b.a,{isTourAnchor:Q,step:h.a.reviewAlertDetailsFlyout,tourId:h.b.alertsCases},s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(Ae,{browserFields:e,contextId:x,data:t,eventId:a,scopeId:x,handleOnEventClosed:S,isReadOnly:w}),s.a.createElement(i.EuiSpacer,{size:"l"}),B&&B[0]&&s.a.createElement(It,{alignItems:"flexStart",direction:"column",wrap:!1,gutterSize:"none"},s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiTitle,{size:"xxs"},s.a.createElement("h5",null,B[0].title)),s.a.createElement(Tt,null,B[0].description))),s.a.createElement(i.EuiSpacer,{size:"l"}),null!=W&&null!=n&&s.a.createElement("div",null,s.a.createElement(i.EuiTitle,{size:"xs"},s.a.createElement("h5",null,ee.c)),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(kt,{"data-test-subj":"renderer"},W.renderRow({contextId:"event-details",data:n,isDraggable:null!=c&&c,scopeId:x}))),s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(he,{data:t,eventId:a,browserFields:e,isDraggable:c,scopeId:x,title:ee.l,isReadOnly:w,goToTable:_,investigationFields:null!==(r=null==F||null===(o=F.investigation_fields)||void 0===o?void 0:o.field_names)&&void 0!==r?r:[]}),s.a.createElement(i.EuiSpacer,{size:"xl"}),s.a.createElement(bt,{browserFields:e,eventId:a,data:t,scopeId:x,isReadOnly:w}),Y&&s.a.createElement(X,{isDraggable:c,hostRisk:U,userRisk:G,browserFields:e,data:t,eventId:a,scopeId:x,enrichments:$,isReadOnly:w}),L&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSkeletonText,{lines:2})),N.ruleId&&(null==F?void 0:F.note)&&s.a.createElement(xe.b,{basicData:N,ruleNote:F.note})))}:void 0}),[l,Q,e,x,t,a,S,w,B,W,n,c,_,null==F||null===(I=F.investigation_fields)||void 0===I?void 0:I.field_names,null==F?void 0:F.note,Y,U,G,$,L,N]),te=Object(o.useMemo)((()=>l&&!w?{id:Ot.threatIntelView,"data-test-subj":"threatIntelTab",name:ee.C,append:s.a.createElement(s.a.Fragment,null,L?s.a.createElement(i.EuiLoadingSpinner,null):s.a.createElement(i.EuiNotificationBadge,{"data-test-subj":"enrichment-count-notification"},V)),content:s.a.createElement(J.a,{before:s.a.createElement(i.EuiSpacer,{size:"m"}),loading:L,enrichments:$,showInvestigationTimeEnrichments:!Object(u.isEmpty)(D)},s.a.createElement(s.a.Fragment,null,s.a.createElement(Ee.a,{setRange:q,loading:L,range:z}),s.a.createElement(i.EuiSpacer,{size:"m"})))}:void 0),[$,q,z,V,l,D,L,w]),ne=Object(o.useMemo)((()=>({id:Ot.tableView,"data-test-subj":"tableTab",name:ee.B,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"l"}),s.a.createElement(v.a,{browserFields:e,data:t,eventId:a,isDraggable:c,scopeId:x,timelineTabType:O,isReadOnly:w}))})),[e,t,a,c,x,O,w]),ae=Object(o.useMemo)((()=>({id:Ot.jsonView,"data-test-subj":"jsonViewTab",name:ee.r,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(wt,{"data-test-subj":"jsonViewWrapper"},s.a.createElement(j,{rawEventData:E})))})),[E]),re=Object(m.a)({rawEventData:E,...null!==n?{ecsData:n}:{}}),ie=Object(jt.a)({rawEventData:E,...null!==n?{ecsData:n}:{}}),oe=Object(o.useMemo)((()=>K?[re]:[ie]),[K,ie,re]),se=Object(o.useMemo)((()=>[Z,te,ne,ae,...oe].filter((e=>!!e))),[Z,te,ne,ae,oe]),le=Object(o.useMemo)((()=>{var e;return null!==(e=se.find((e=>e.id===T)))&&void 0!==e?e:se[0]}),[se,T]),ce=Object(o.useMemo)((()=>Q?{"tour-step":Object(h.c)(3,h.b.alertsCases)}:{}),[Q]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(St,r()({},ce,{"data-test-subj":"eventDetails",tabs:se,selectedTab:le,onTabClick:M,key:"event-summary-tabs"})))};Ct.displayName="EventDetailsComponent";const Mt=s.a.memo(Ct)},function(e,t,n){"use strict";n.d(t,"a",(function(){return _e})),n.d(t,"c",(function(){return De})),n.d(t,"b",(function(){return Ne})),n.d(t,"d",(function(){return Ae}));var a=n(19),r=n(954),i=n(477),o=n(2),s=n.n(o),l=n(7),c=n(42),u=n(4),d=n(119),p=n.n(d);const m=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:r},fieldState:{error:l}}=Object(i.useController)({name:"label",defaultValue:""}),c=Object(o.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return s.a.createElement(a.EuiFormRow,{label:u.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==l?void 0:l.message,isInvalid:c,fullWidth:!0},s.a.createElement(a.EuiFieldText,p()({isInvalid:c,onChange:t,value:n,name:r,fullWidth:!0,"data-test-subj":"input"},e)))},f=s.a.memo(m),g=u.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),b=()=>s.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:s.a.createElement("h2",null,g),titleSize:"xs",body:s.a.createElement("p",null,s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:s.a.createElement(a.EuiCode,null,"osquery")}}))});var y=n(118);const h=({node:e,onSave:t,onCancel:n})=>{var r,d,p;const m=null!=e,{osquery:g,application:{capabilities:{osquery:h}}}=Object(y.j)().services,v=Object(i.useForm)({defaultValues:{label:null==e||null===(r=e.configuration)||void 0===r?void 0:r.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(p=e.configuration)||void 0===p?void 0:p.ecs_mapping}}),E=Object(o.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(l.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t]),x=Object(o.useMemo)((()=>!(h.runSavedQueries&&h.readSavedQueries||h.writeLiveQueries)),[h.readSavedQueries,h.runSavedQueries,h.writeLiveQueries]),j=Object(o.useMemo)((()=>{if(null!=g&&g.LiveQueryField){const{LiveQueryField:e}=g;return s.a.createElement(i.FormProvider,v,s.a.createElement(f,null),s.a.createElement(a.EuiSpacer,{size:"m"}),s.a.createElement(e,{formMethods:v}))}return null}),[v,g]);return x?s.a.createElement(b,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiModalHeader,null,s.a.createElement(a.EuiModalHeaderTitle,null,s.a.createElement("h1",null,m?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),s.a.createElement(a.EuiModalBody,null,s.a.createElement(s.a.Fragment,null,j)),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButtonEmpty,{onClick:n},u.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),s.a.createElement(a.EuiButton,{onClick:v.handleSubmit(E),fill:!0},m?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},v=s.a.memo(h);var E=n(478),x=n(41),j=n.n(x),O=n(208),S=n(394),w=n(262),k=n(1087),I=n.n(k),T=n(571);const C=j()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var M=n(54),_=n.n(M),D=n(60),N=n.n(D),A=(n(43),n(53)),F=n(123),P=n(55),R=n(1484),L=n(146),q=n(250),z=n(717),B=n(132),$=n(127);const V=["*"],U={};var G=n(121),H=n(179);const W=e=>e===A.FILTERS.EXISTS?H.b:e===A.FILTERS.PHRASES?H.c:H.d,Q={$state:{store:A.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},Y={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:G.a.default,queryMatch:{field:"",value:"",operator:H.b}},K=e=>{const t={...Q,meta:{...Q.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===A.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===A.FILTERS.PHRASES){var n;let a=JSON.parse(String(e.value));return"number"===e.valueType?a=a.map(Number):"boolean"===e.valueType&&(a=a.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(n=a)||void 0===n?void 0:n.map((t=>({match_phrase:{[e.field]:t}})))}}}}var a;if(e.queryType===A.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(a=e.value)&&void 0!==a?a:""}}};if(e.queryType===A.FILTERS.RANGE){let n,a;try{const t=JSON.parse(String(e.value));n=t.gte,a=t.lt}catch{n="",a=""}const r={gte:n,lt:a};return{...t,meta:{...t.meta,params:r},query:{range:{[e.field]:r}}}}return t},Z=({providers:e,alertData:t})=>{const n=Object(o.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(o.useMemo)((()=>n?[]:((e,t)=>e.map((e=>e.reduce(((e,n,a)=>{const{field:r,value:i,excluded:o,queryType:s}=n,{result:c,matchedBrackets:u}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const n=/\{{([^}]+)\}}/g,a=e.match(new RegExp(n));let r=e;a&&t&&Object(l.each)(a,(e=>{const n=e.replace(/{{|}}/g,"").trim();if(r.includes(e)){const a=t.find((({field:e})=>e===n));if(a&&a.values){const{values:[t]}=a;r=r.replace(e,t)}}}));const i=new RegExp(n).test(r);return{result:r,skipped:i,matchedBrackets:a}})(i,t),d=!t&&u;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(r+i),name:r,excluded:o,kqlQuery:"",type:d?G.a.template:G.a.default,queryMatch:{field:r,value:c,operator:W(s)}};{const t={enabled:!0,id:JSON.stringify(r+i),name:r,excluded:o,kqlQuery:"",type:d?G.a.template:G.a.default,queryMatch:{field:r,value:c,operator:W(s)}};e.and.push(t)}return e}),Y))))(e,t)),[t,e,n]),filters:Object(o.useMemo)((()=>n?((e,t)=>{const n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.length>1){const e=a.map((e=>K(e))),t={$state:{store:A.FilterStateStore.APP_STATE},meta:{type:A.FILTERS.COMBINED,relation:A.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};n.push(t)}else{const e=a[0],t=K(e);n.push(t)}}return n})(e):[]),[n,e,t])}};var X=n(263),J=n(396),ee=n(5);const te=e=>{var t,n,a,r,i,o;const s=null!==(t=null===(n=e.meta)||void 0===n?void 0:n.key)&&void 0!==t?t:"",l={field:s,excluded:null!==(a=null===(r=e.meta)||void 0===r?void 0:r.negate)&&void 0!==a&&a,queryType:null!==(i=null===(o=e.meta)||void 0===o?void 0:o.type)&&void 0!==i?i:A.FILTERS.PHRASE};if(Object(A.isRangeFilter)(e)){var c;const{gte:t,lt:n}=e.query.range[s],a=JSON.stringify({gte:t,lt:n});return{...l,value:a,queryType:null!==(c=e.meta.type)&&void 0!==c?c:A.FILTERS.RANGE}}if(Object(A.isPhrasesFilter)(e)){var u,d,p,m;const t=typeof(null===(u=e.meta)||void 0===u?void 0:u.params[0]);return{...l,value:JSON.stringify(null!==(d=null===(p=e.meta)||void 0===p?void 0:p.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(m=e.meta.type)&&void 0!==m?m:A.FILTERS.PHRASES}}var f;if(Object(A.isExistsFilter)(e))return{...l,value:"",queryType:null!==(f=e.meta.type)&&void 0!==f?f:A.FILTERS.EXISTS};if(Object(A.isPhraseFilter)(e)){var g,b,y,h,v,E;const t=typeof(null===(g=e.meta)||void 0===g||null===(b=g.params)||void 0===b?void 0:b.query);return{...l,value:null!==(y=null===(h=e.meta)||void 0===h||null===(v=h.params)||void 0===v?void 0:v.query)&&void 0!==y?y:"",valueType:t,queryType:null!==(E=e.meta.type)&&void 0!==E?E:A.FILTERS.PHRASE}}return{...l,value:"",queryType:A.FILTERS.PHRASE}},ne=e=>e.map((e=>te(e))),ae=e=>!1===e.some(A.isCombinedFilter)?[ne(e)]:e.reduce(((e,t)=>{if(Object(A.isCombinedFilter)(t)){const n=t.meta.params;if(t.meta.relation===A.BooleanRelation.OR){const t=n.map((e=>{const t=ae([e]);return Object(l.flatten)(t)}));return[...e,...t]}{const t=ae(n);return[...e,...t]}}return[...e,[te(t)]]}),[]);var re=n(16),ie=n(63),oe=n.n(ie),se=n(656),le=n.n(se),ce=n(233);function ue(e,t,n){var a;if(void 0===t||"undefined"===n)return!1;switch(e.type){case"date":const n="string"==typeof t?oe.a.parse(t):null;return Boolean("string"==typeof t&&n&&n.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new P.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(a=e.esTypes)&&void 0!==a&&a.includes(ce.a.VERSION)?Boolean(le()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const de=u.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),pe=u.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),me=u.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),fe=u.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),ge=u.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),be=u.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),ye=u.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),he=u.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),ve=u.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),Ee=u.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),xe=u.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),je=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"});var Oe=n(766);const Se="!{investigate",we=({label:e,description:t,providers:n,relativeFrom:r,relativeTo:i})=>{const{addError:l}=Object(F.a)();let c=[];try{void 0!==n&&(c=JSON.parse(n))}catch(e){l(e,{title:je})}const{data:u,timestamp:d}=Object(o.useContext)(S.a),{dataProviders:p,filters:m}=Z({providers:c,alertData:u}),f=Object(o.useMemo)((()=>{if(r&&i){const e=d?_()(d):_()();return{kind:"absolute",from:Object(J.e)(r,J.a,!1,_.a,e.toDate()).toISOString(),to:Object(J.e)(i,J.b,!0,_.a,e.toDate()).toISOString()}}return null}),[r,i,d]),{totalCount:g,isQueryLoading:b,oldestTimestamp:h,hasError:v}=(({dataProviders:e,filters:t,relativeTimerange:n})=>{const{uiSettings:a}=Object(y.j)().services,r=Object(o.useMemo)((()=>Object(P.getEsQueryConfig)(a)),[a]),{browserFields:i,selectedPatterns:s,indexPattern:l,dataViewId:c}=Object(B.a)($.SourcererScopeName.timeline),[u,d]=Object(o.useState)(!1),p=Object(o.useMemo)((()=>{try{if(!1===u)return Object(q.d)({config:r,dataProviders:e,indexPattern:l,browserFields:i,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[i,e,r,u,l,t]),[m,{events:f,totalCount:g}]=Object(z.a)({dataViewId:c,fields:V,filterQuery:null==p?void 0:p.filterQuery,id:L.c.active,indexNames:s,language:"kuery",limit:1,runtimeMappings:U,startDate:null==n?void 0:n.from,endDate:null==n?void 0:n.to,fetchNotes:!1}),b=Object(o.useMemo)((()=>[R.a.loading,R.a.loadingMore].includes(m)),[m]),[h]=f,v=h&&h.data&&h.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:b,totalCount:g,oldestTimestamp:v&&v.value&&v.value[0],hasError:u}})({dataProviders:p,filters:m,relativeTimerange:f}),E=Object(o.useMemo)((()=>{if(f)return f;if(null!=h)return{kind:"absolute",from:h,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(J.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[h,f]);return b?s.a.createElement(a.EuiLoadingSpinner,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(X.a,{asEmptyButton:!1,isDisabled:v,dataProviders:p,filters:m,timeRange:E,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},s.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${N()(g).format("0,0.[000]a")})`),s.a.createElement("div",null,t))},ke=({node:e,onSave:t,onCancel:n})=>{const r=null!=e,{indexPattern:u}=Object(B.a)($.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:d}},uiSettings:m}=Object(y.j)().services,f=Object(Oe.a)({sourcererScope:$.SourcererScopeName.default}),[g,b]=Object(o.useState)([[]]),h=Object(o.useMemo)((()=>[{value:"0",text:""},...m.get(ee.db).map((({display:e},t)=>({value:String(t),text:e})))]),[m]),v=Object(i.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),E=Object(i.useController)({name:"label",control:v.control}),x=Object(i.useController)({name:"description",control:v.control}),j=Object(i.useController)({name:"relativeTimerange",control:v.control}),O=Object(o.useCallback)((e=>{const t=h.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),n=m.get(ee.db);return{relativeFrom:n[e].from,relativeTo:n[e].to}}return{}}),[h,m]),S=Object(o.useCallback)((()=>{t(`${Se}${JSON.stringify(Object(l.pickBy)({label:E.field.value,description:x.field.value,providers:g,...O(j.field.value)},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t,g,E.field.value,x.field.value,j.field.value,O]),w=Object(o.useCallback)((e=>{b(ae(e))}),[]),k=Object(o.useCallback)((e=>{j.field.onChange(e.target.value)}),[j.field]),I=Object(o.useMemo)((()=>{var e;const t=null!==(e=E.field.value)&&void 0!==e?e:"",n=g.flat();return""===t.trim()||0===n.length||n.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return ue(t,e.value,e.valueType);case"phrases":const n="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(n)||!n.length)&&n.every((n=>ue(t,n,e.valueType)));case"range":const a=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof a&&(!a.gte||ue(t,a.gte,e.valueType))&&(!a.lt||ue(t,a.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==f?void 0:f.getFieldByName(e.field))))}),[E.field.value,g,f]),T=Object(o.useMemo)((()=>{const e=u&&u.getName?u.getName():"*";return[{$state:{store:A.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[u]),C=Object(re.b)().isAtLeast("platinum");return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ce,null,s.a.createElement(a.EuiModalHeaderTitle,null,s.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(a.EuiFlexItem,null,r?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===C&&s.a.createElement(a.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),s.a.createElement(a.EuiModalBody,null,s.a.createElement(i.FormProvider,v,s.a.createElement(a.EuiForm,{fullWidth:!0},s.a.createElement(a.EuiFormRow,{label:be,fullWidth:!0},s.a.createElement(s.a.Fragment,null)),s.a.createElement(a.EuiFormRow,{label:de,helpText:me,isInvalid:void 0!==E.field.value&&0===E.field.value.trim().length,fullWidth:!0},s.a.createElement(a.EuiFieldText,p()({},v.register("label"),{ref:null,name:"label",onChange:E.field.onChange}))),s.a.createElement(a.EuiFormRow,{label:fe,helpText:ge,fullWidth:!0},s.a.createElement(a.EuiFieldText,p()({},v.register("description"),{ref:null,name:"description",onChange:x.field.onChange}))),s.a.createElement(a.EuiFormRow,{label:ye,helpText:he,fullWidth:!0},f?s.a.createElement(d,{filters:T,onChange:w,dataView:f,maxDepth:1}):s.a.createElement(s.a.Fragment,null)),s.a.createElement(a.EuiFormRow,{label:ve,helpText:Ee,fullWidth:!0},s.a.createElement(a.EuiSelect,p()({},v.register("relativeTimerange"),{ref:null,onChange:k,options:h})))))),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButtonEmpty,{onClick:n},xe),s.a.createElement(a.EuiButton,{onClick:v.handleSubmit(S),fill:!0,disabled:I},r?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Ie=s.a.memo(ke),Te=`${Se}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var Ce=j()(a.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Me=Object(a.getDefaultEuiMarkdownUiPlugins)(),_e=Object(a.getDefaultEuiMarkdownParsingPlugins)(),De=Object(a.getDefaultEuiMarkdownProcessingPlugins)(),Ne=[Se],Ae=({insightsUpsellingMessage:e,interactionsUpsellingMessage:t})=>{const n=Me.map((e=>e.name)),i=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:pe,iconType:"timelineWithArrow",isDisabled:!!e},helpText:s.a.createElement("div",null,s.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},Te),s.a.createElement(a.EuiSpacer,{size:"s"})),editor:Ie}))({insightsUpsellingMessage:e}),o=r.b({interactionsUpsellingMessage:t}),l=(({interactionsUpsellingMessage:e})=>({name:"osquery",button:{label:null!=e?e:"Osquery",iconType:"logoOsquery",isDisabled:!!e},helpText:s.a.createElement("div",null,s.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),s.a.createElement(a.EuiSpacer,{size:"s"})),editor:v}))({interactionsUpsellingMessage:t});if(!1===n.includes(i.name))Me.push(o),Me.push(l),Me.push(i);else{const e=Me.findIndex((e=>e.name===i.name));Me[e]=i}return Me};_e.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){if(!1===t.startsWith(Se))return!1;const a=t[13];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let r={};if("{"===a){let n="",a=0;for(let e=13;e<t.length;e++){const r=t[e];if("{"===r)a++,n+=r;else if("}"===r){if(a--,-1===a)break;n+=r}else n+=r}try{return r=JSON.parse(n),e(t)({type:"insight",...r,providers:JSON.stringify(r.providers)})}catch(t){const n=e.now();this.file.fail((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:n.line,column:n.column+13})}}return!1};a.locator=(e,t)=>e.indexOf(Se,t),t.insight=a,n.splice(n.indexOf("text"),0,"insight")})),_e.push(r.a),_e.push(E.a),De[1][1].components.insight=({label:e,description:t,providers:n,relativeFrom:r,relativeTo:i})=>{const o=Object(O.b)("investigation_guide");return o?s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiToolTip,{content:o},s.a.createElement(a.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`)),s.a.createElement("div",null,t)):s.a.createElement(we,{label:e,description:t,providers:n,relativeFrom:r,relativeTo:i})},De[1][1].components.timeline=r.c,De[1][1].components.osquery=({configuration:e})=>{var t;const[n,r]=Object(o.useState)(!1),{agentId:i,alertId:c,data:d}=Object(o.useContext)(S.a),p=Object(o.useCallback)((()=>r(!0)),[r]),m=Object(o.useCallback)((()=>r(!1)),[r]),f=Object(O.b)("investigation_guide_interactions"),g=Object(o.useMemo)((()=>{const e=Object(l.reduce)(d,((e,t)=>{var n;return{...e,[t.field]:null==t||null===(n=t.values)||void 0===n?void 0:n[0]}}),{});return Object(w.a)(e)}),[d]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiToolTip,{content:f},s.a.createElement(C,{iconType:I.a,onClick:p,disabled:!!f},null!==(t=e.label)&&void 0!==t?t:u.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"}))),n&&s.a.createElement(T.a,{defaultValues:{...c?{alertIds:[c]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:i,onClose:m,ecsData:g}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return R.a})),n.d(t,"e",(function(){return R.e})),n.d(t,"d",(function(){return R.d})),n.d(t,"c",(function(){return R.c})),n.d(t,"f",(function(){return R.h})),n.d(t,"g",(function(){return R.l})),n.d(t,"j",(function(){return R.r})),n.d(t,"n",(function(){return R.v})),n.d(t,"m",(function(){return R.u})),n.d(t,"l",(function(){return R.t})),n.d(t,"k",(function(){return R.s})),n.d(t,"h",(function(){return R.o})),n.d(t,"i",(function(){return R.p})),n.d(t,"r",(function(){return R.A})),n.d(t,"s",(function(){return R.B})),n.d(t,"v",(function(){return R.E})),n.d(t,"p",(function(){return R.y})),n.d(t,"t",(function(){return R.C})),n.d(t,"o",(function(){return R.x})),n.d(t,"u",(function(){return R.D})),n.d(t,"q",(function(){return R.z}));var a=n(2),r=n.n(a),i=n(19),o=n(45),s=n(151),l=n(41),c=n.n(l);const u=c.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-170nqoz-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));u.displayName="SearchRowContainer";const d=c()(i.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-170nqoz-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));d.displayName="SearchRowFlexGroup";const p=r.a.memo((()=>{const e=Object(o.useDispatch)(),t=Object(a.useMemo)((()=>({placeholder:"Search note contents",incremental:!1,"data-test-subj":"notes-search-bar"})),[]),n=Object(a.useCallback)((({queryText:t})=>{e(Object(R.y)(t.trim()))}),[e]);return r.a.createElement(u,null,r.a.createElement(d,{gutterSize:"s"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiSearchBar,{box:t,onChange:n,defaultQuery:""}))))}));p.displayName="SearchRow";var m=n(362),f=n(4);const g=f.i18n.translate("xpack.securitySolution.notes.management.batchActionsTitle",{defaultMessage:"Bulk actions"}),b=f.i18n.translate("xpack.securitySolution.notes.management.createdColumnTitle",{defaultMessage:"Created"}),y=f.i18n.translate("xpack.securitySolution.notes.management.createdByColumnTitle",{defaultMessage:"Created by"}),h=f.i18n.translate("xpack.securitySolution.notes.management.eventIdColumnTitle",{defaultMessage:"View Document"}),v=f.i18n.translate("xpack.securitySolution.notes.management.timelineColumnTitle",{defaultMessage:"Timeline"}),E=f.i18n.translate("xpack.securitySolution.notes.management.noteContentColumnTitle",{defaultMessage:"Note content"}),x=f.i18n.translate("xpack.securitySolution.notes.management.deleteAction",{defaultMessage:"Delete"}),j=f.i18n.translate("xpack.securitySolution.notes.management.deleteDescription",{defaultMessage:"Delete this note"}),O=f.i18n.translate("xpack.securitySolution.notes.management.tableError",{defaultMessage:"Unable to load notes"}),S=f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesModalTitle",{defaultMessage:"Delete notes?"}),w=f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesCancel",{defaultMessage:"Cancel"}),k=f.i18n.translate("xpack.securitySolution.notes.management.deleteSelected",{defaultMessage:"Delete selected notes"}),I=f.i18n.translate("xpack.securitySolution.notes.management.refresh",{defaultMessage:"Refresh"}),T=f.i18n.translate("xpack.securitySolution.notes.management.openTimeline",{defaultMessage:"Open timeline"}),C=f.i18n.translate("xpack.securitySolution.notes.management.viewEventInTimeline",{defaultMessage:"View event in timeline"}),M=r.a.memo((()=>{const e=Object(o.useDispatch)(),t=Object(o.useSelector)(R.r),n=Object(o.useSelector)(R.v),s=Object(o.useSelector)(R.u),l=Object(a.useMemo)((()=>{const{perPage:e,page:n,total:a}=t,r=e*(n-1)+1,i=Math.min(e*n,a);return 0===e?"All":`${r}-${i} of ${a}`}),[t]),c=Object(a.useCallback)((()=>{e(Object(R.z)())}),[e]),u=Object(o.useSelector)(R.t),d=Object(a.useCallback)((()=>r.a.createElement(i.EuiContextMenuItem,{"data-test-subj":"notes-management-delete-notes",onClick:c,disabled:0===s.length,icon:"trash",key:"DeleteItemKey"},k)),[c,s.length]),p=Object(a.useCallback)((()=>{e(Object(R.d)({page:t.page,perPage:t.perPage,sortField:n.field,sortOrder:n.direction,filter:"",search:u}))}),[e,t.page,t.perPage,n.field,n.direction,u]);return r.a.createElement(m.a,{border:!0},r.a.createElement(m.d,null,r.a.createElement(m.c,null,r.a.createElement(m.e,{"data-test-subj":"notes-management-pagination-count"},`Showing: ${l}`)),r.a.createElement(m.c,null,r.a.createElement(m.e,{"data-test-subj":"notes-management-selected-count"},s.length>0?`${s.length} selected`:""),r.a.createElement(m.b,{dataTestSubj:"notes-management-utility-bar-actions",iconSide:"right",iconType:"arrowDown",popoverContent:d},r.a.createElement("span",{"data-test-subj":"notes-management-utility-bar-action-button"},g)),r.a.createElement(m.b,{dataTestSubj:"notes-management-utility-bar-refresh-button",iconSide:"right",iconType:"refresh",onClick:p},I))))}));M.displayName="NotesUtilityBar";const _=r.a.memo((()=>{const e=Object(o.useDispatch)(),t=Object(o.useSelector)(R.s),n=Object(o.useSelector)(R.l)===R.a.Loading,s=Object(a.useCallback)((()=>{e(Object(R.x)())}),[e]),l=Object(a.useCallback)((()=>{e(Object(R.c)({ids:t,refetch:!0}))}),[e,t]);return r.a.createElement(i.EuiConfirmModal,{"aria-labelledby":"delete-notes-modal",title:S,onCancel:s,onConfirm:l,isLoading:n,cancelButtonText:w,confirmButtonText:x,buttonColor:"danger",defaultFocusedButton:"confirm"},(c=t.length,f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesConfirm",{values:{selectedNotes:c},defaultMessage:"Are you sure you want to delete {selectedNotes} {selectedNotes, plural, one {note} other {notes}}?"})));var c}));_.displayName="DeleteConfirmModal";var D=n(377);const N=Object(a.memo)((({eventId:e})=>{const t={event:{id:[e]},_id:e},{investigateInTimelineAlertClick:n}=Object(D.a)({ecsRowData:t});return r.a.createElement(i.EuiLink,{onClick:n,"data-test-subj":"open-event-in-timeline"},C)}));N.displayName="OpenEventInTimeline";const A=e=>[{field:"created",name:b,sortable:!0,render:e=>r.a.createElement(s.b,{value:e})},{field:"createdBy",name:y},{field:"eventId",name:h,sortable:!0,render:e=>r.a.createElement(N,{eventId:e})},{field:"timelineId",name:v,render:t=>t?r.a.createElement(i.EuiLink,{onClick:()=>e({timelineId:t,duplicate:!1})},T):null},{field:"note",name:E}],F=[10,25,50,100],P=({onOpenTimeline:e})=>{const t=Object(o.useDispatch)(),n=Object(o.useSelector)(R.h),s=Object(o.useSelector)(R.r),l=Object(o.useSelector)(R.v),c=Object(o.useSelector)(R.t),u=Object(o.useSelector)(R.s).length>0,d=Object(o.useSelector)(R.p),m=d===R.a.Loading,f=d===R.a.Failed,g=Object(o.useSelector)(R.o),b=Object(a.useCallback)((()=>{t(Object(R.d)({page:s.page,perPage:s.perPage,sortField:l.field,sortOrder:l.direction,filter:"",search:c}))}),[t,s.page,s.perPage,l.field,l.direction,c]);Object(a.useEffect)((()=>{b()}),[b]);const y=Object(a.useCallback)((({page:e,sort:n})=>{e&&(t(Object(R.A)(e.index+1)),t(Object(R.B)(e.size))),n&&t(Object(R.E)({field:n.field,direction:n.direction}))}),[t]),h=Object(a.useCallback)((e=>{t(Object(R.D)(e))}),[t]),v=Object(a.useCallback)((e=>{const n=e.map((e=>e.noteId));t(Object(R.C)(n))}),[t]),E=Object(a.useCallback)((e=>e.noteId),[]),S=Object(a.useMemo)((()=>{const t=[{name:x,description:j,color:"primary",icon:"trash",type:"icon",onClick:e=>h(e.noteId)}];return[...A(e),{name:"actions",actions:t}]}),[h,e]),w=Object(a.useMemo)((()=>({pageIndex:s.page-1,pageSize:s.perPage,totalItemCount:s.total,pageSizeOptions:F})),[s]),k=Object(a.useMemo)((()=>({onSelectionChange:v,selectable:()=>!0})),[v]),I=Object(a.useMemo)((()=>({sort:l})),[l]);return f?r.a.createElement(i.EuiEmptyPrompt,{iconType:"error",color:"danger",title:r.a.createElement("h2",null,O),body:r.a.createElement("p",null,g)}):r.a.createElement(r.a.Fragment,null,r.a.createElement(p,null),r.a.createElement(M,null),r.a.createElement(i.EuiBasicTable,{items:n,pagination:w,columns:S,onChange:y,selection:k,sorting:I,itemId:E,loading:m}),u&&r.a.createElement(_,null))};P.displayName="NoteManagementPage";var R=n(289)},function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var a=n(2),r=n.n(a),i=n(19),o=n(45),s=n(41),l=n.n(s),c=n(149),u=n(622),d=n(131),p=n(664),m=n(129),f=n(206),g=n(118),b=n(355),y=n(180),h=n(949),v=n(559),E=n(44),x=n(839),j=n(4);const O=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.pinSelected",{defaultMessage:"Pin selected"}),S=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectAll",{defaultMessage:"All"}),w=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectNone",{defaultMessage:"None"}),k=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectPinned",{defaultMessage:"Pinned"}),I=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectUnpinned",{defaultMessage:"Unpinned"}),T=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.unpinSelected",{defaultMessage:"Unpin selected"}),C=l.a.div.withConfig({displayName:"InputDisplay",componentId:"sc-oi2e53-0"})(["width:5px;"]);C.displayName="InputDisplay";const M=l.a.div.withConfig({displayName:"PinIconContainer",componentId:"sc-oi2e53-1"})(["margin-right:5px;"]);M.displayName="PinIconContainer";const _=l.a.div.withConfig({displayName:"PinActionItem",componentId:"sc-oi2e53-2"})(["display:flex;flex-direction:row;"]);_.displayName="PinActionItem";const D=r.a.memo((({text:e})=>r.a.createElement(i.EuiText,{size:"s",color:"subdued"},e)));D.displayName="DropdownDisplay";const N=Object(s.createGlobalStyle)([".eventsSelectItem{width:100% !important;.euiContextMenu__icon{display:none !important;}}.eventsSelectDropdown{width:","px;}"],60),A=l.a.div.withConfig({displayName:"CheckboxContainer",componentId:"sc-1giocnz-0"})(["position:relative;"]);A.displayName="CheckboxContainer";const F=l.a.div.withConfig({displayName:"PositionedCheckbox",componentId:"sc-1giocnz-1"})(["left:7px;position:absolute;top:-28px;"]);F.displayName="PositionedCheckbox";const P=r.a.memo((({checkState:e,timelineId:t})=>r.a.createElement("div",{"data-test-subj":"events-select"},r.a.createElement(i.EuiSuperSelect,{className:"eventsSelectDropdown","data-test-subj":"events-select-dropdown",itemClassName:"eventsSelectItem",onChange:E.noop,options:[{inputDisplay:r.a.createElement(C,null),disabled:!0,dropdownDisplay:r.a.createElement(D,{text:S}),value:"select-all"},{inputDisplay:r.a.createElement(C,null),disabled:!0,dropdownDisplay:r.a.createElement(D,{text:w}),value:"select-none"},{inputDisplay:r.a.createElement(C,null),disabled:!0,dropdownDisplay:r.a.createElement(D,{text:k}),value:"select-pinned"},{inputDisplay:r.a.createElement(C,null),disabled:!0,dropdownDisplay:r.a.createElement(D,{text:I}),value:"select-unpinned"},{inputDisplay:r.a.createElement(C,null),disabled:!0,dropdownDisplay:r.a.createElement(_,null,r.a.createElement(M,null,r.a.createElement(x.a,{allowUnpinning:!0,isAlert:!1,pinned:!0})),r.a.createElement(D,{text:O})),value:"pin-selected"},{inputDisplay:r.a.createElement(C,null),disabled:!0,dropdownDisplay:r.a.createElement(_,null,r.a.createElement(M,null,r.a.createElement(x.a,{allowUnpinning:!0,isAlert:!1,pinned:!1})),r.a.createElement(D,{text:T})),value:"unpin-selected"}]}),r.a.createElement(A,{"data-test-subj":"timeline-events-select-checkbox-container"},r.a.createElement(F,{"data-test-subj":"timeline-events-select-positioned-checkbox"},r.a.createElement(i.EuiCheckbox,{checked:"checked"===e,"data-test-subj":"events-select-checkbox",disabled:!0,id:`timeline-${t}-events-select`,indeterminate:"indeterminate"===e,onChange:E.noop}))),r.a.createElement(N,null))));P.displayName="EventsSelect";var R=n(594),L=n(122),q=n(124),z=n(169);const B=l.a.div.withConfig({displayName:"SortingColumnsContainer",componentId:"sc-1ls1217-0"})(["button{color:",";}.euiPopover .euiButtonEmpty{padding:0;.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>e.eui.euiColorPrimary)),$=l.a.div.withConfig({displayName:"FieldBrowserContainer",componentId:"sc-1ls1217-1"})([".euiToolTipAnchor{.euiButtonContent{padding:",";}button{color:",";}.euiButtonContent__icon{width:16px;height:16px;}.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>`0 ${e.eui.euiSizeXS}`),(({theme:e})=>e.eui.euiColorPrimary)),V=l.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1ls1217-2"})(["align-items:center;display:flex;"]),U={},G=[],H=Object(a.memo)((({width:e,browserFields:t,columnHeaders:n,isEventViewer:s=!1,isSelectAllChecked:l,onSelectAll:E,showEventsSelect:x,showSelectAllCheckbox:j,showFullScreenToggle:O=!0,sort:S,tabType:w,timelineId:k,fieldBrowserOptions:I})=>{const{triggersActionsUi:T}=Object(g.j)().services,{globalFullScreen:C,setGlobalFullScreen:M}=Object(f.a)(),{timelineFullScreen:_,setTimelineFullScreen:D}=Object(f.c)(),N=Object(o.useDispatch)(),A=Object(L.a)("unifiedComponentsInTimelineDisabled"),{defaultColumns:F}=Object(q.a)((e=>Object(z.selectTimelineById)(e,k))),H=Object(a.useCallback)((()=>{k===c.f.active?D(!_):M(!C)}),[k,D,_,M,C]),W=Object(a.useMemo)((()=>Object(u.b)({globalFullScreen:C,isActiveTimelines:Object(d.isActiveTimeline)(k),timelineFullScreen:_})),[C,_,k]),Q=Object(a.useCallback)((e=>{E({isSelected:e.currentTarget.checked})}),[E]),Y=Object(a.useCallback)((e=>N(m.a.updateSort({id:k,sort:e.map((({id:e,direction:t})=>{var a,r;const i=n.find((t=>t.id===e)),o=null!==(a=null==i?void 0:i.type)&&void 0!==a?a:"",s=null!==(r=null==i?void 0:i.esTypes)&&void 0!==r?r:[];return{columnId:e,columnType:o,esTypes:s,sortDirection:t}}))}))),[n,N,k]),K=Object(a.useMemo)((()=>{var e;return{onSort:Y,columns:null!==(e=null==S?void 0:S.map((({columnId:e,sortDirection:t})=>({id:e,direction:t}))))&&void 0!==e?e:[]}}),[Y,S]),Z=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.reduce(((e,t)=>{var n;return{...e,[t.id]:null!==(n=t.displayAsText)&&void 0!==n?n:t.id}}),{}))&&void 0!==e?e:{}}),[n]),X=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.map((({aggregatable:e,displayAsText:t,id:n,type:a})=>({id:n,isSortable:e,displayAsText:t,schema:a}))))&&void 0!==e?e:[]}),[n]),J=Object(a.useCallback)((()=>{N(m.a.updateColumns({id:k,columns:F}))}),[F,N,k]),ee=Object(a.useCallback)((e=>{n.some((({id:t})=>t===e))?N(m.a.removeColumn({columnId:e,id:k})):N(m.a.upsertColumn({column:Object(p.a)(e,F),id:k,index:1}))}),[n,N,k,F]),te=Object(i.useDataGridColumnSorting)({columns:X,sorting:K,schema:U,schemaDetectors:G,displayValues:Z});return r.a.createElement(V,{"data-test-subj":"header-actions-container"},j&&r.a.createElement(y.o,{role:"checkbox"},r.a.createElement(y.p,{textAlign:"center",width:b.b},r.a.createElement(i.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:l,onChange:Q}))),I&&r.a.createElement(y.o,{role:"button"},r.a.createElement($,null,T.getFieldBrowser({browserFields:t,columnIds:n.map((({id:e})=>e)),onResetColumns:J,onToggleColumn:ee,options:I}))),A&&r.a.createElement(y.o,{role:"button"},r.a.createElement(h.a,{timelineId:k})),O&&r.a.createElement(y.o,{role:"button"},r.a.createElement(y.p,{textAlign:"center",width:b.b},r.a.createElement(i.EuiToolTip,{content:W?v.a:R.d},r.a.createElement(i.EuiButtonIcon,{"aria-label":Object(u.b)({globalFullScreen:C,isActiveTimelines:Object(d.isActiveTimeline)(k),timelineFullScreen:_})?v.a:R.d,display:W?"fill":"empty",color:"primary","data-test-subj":Object(d.isActiveTimeline)(k)?"full-screen-active":"full-screen",iconType:"fullScreen",onClick:H})))),w!==c.g.eql&&A&&r.a.createElement(y.o,{role:"button","data-test-subj":"timeline-sorting-fields"},r.a.createElement(y.p,{textAlign:"center",width:b.b},r.a.createElement(i.EuiToolTip,{content:R.l},r.a.createElement(B,null,te)))),x&&r.a.createElement(y.o,{role:"button"},r.a.createElement(y.p,{textAlign:"center",width:b.b},r.a.createElement(P,{checkState:"unchecked",timelineId:k}))))}));H.displayName="HeaderActionsComponent";const W=r.a.memo(H)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return E}));var a=n(2),r=n.n(a),i=n(4);const o=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewHostSummary",{defaultMessage:"View host summary"}),s=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewUserSummary",{defaultMessage:"View user summary"}),l=i.i18n.translate("xpack.securitySolution.expandedValue.links.expandIpDetails",{defaultMessage:"Expand ip details"}),c=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleDetails",{defaultMessage:"View rule details"}),u=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewPortDetails",{defaultMessage:"View port details"}),d=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleReference",{defaultMessage:"View rule reference"}),p=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewEventReference",{defaultMessage:"View event reference"}),m=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewIndicatorReference",{defaultMessage:"View indicator reference"});var f=n(229),g=n(195),b=n(406),y=n(382);n(118);const h=[{columnId:f.g,label:o},{columnId:"source.ip",fieldType:b.b,label:l},{columnId:"destination.ip",fieldType:b.b,label:l},{columnId:"signal.rule.name",label:c,linkField:"signal.rule.id"},...y.b.map((e=>({columnId:e,label:u}))),{columnId:f.m,label:d},{columnId:f.l,label:d},{columnId:f.e,label:p},{columnId:g.j,label:m},{columnId:f.p,label:s}],v=(e,t,n)=>h.find((a=>a.columnId===e||!(!a.fieldType||t!==a.fieldType||void 0===n&&void 0===a.linkField))),E=()=>r.a.createElement(r.a.Fragment,null)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(765);function r(e,t){var n;const r=t?t(e):function(e){var t;return e.timeSeriesMetric||(null!==(t=e.type)&&void 0!==t?t:"string")}(e),i=(null===(n=e.esTypes)||void 0===n?void 0:n[0])||null;return i&&["_id","_index","_ignored"].includes(i)&&"string"===r?"keyword":"unknown"===r&&i&&Object(a.c)(i)||"string"===r&&i?i:r}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return E}));var a=n(72),r=n(19),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(118);const u="100%",d=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:u};\n  `));d.displayName="WrappedByAutoSizer";const p=o.a.memo(d),m={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},f=()=>({baseTheme:Object(c.g)()?a.LEGACY_DARK_THEME:a.LEGACY_LIGHT_THEME,theme:m}),g={rotation:0,rendering:"canvas",showLegend:!1,legendValues:[],debug:!1,legendPosition:a.Position.Bottom},b=(e,t)=>{const n=e||t;return n?`${n}px`:u},y=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},h=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),v=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),E=(l()(r.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),l()(r.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"]))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,r=function(e,t,n){var r=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[r]&&(e.registered[r]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){r(e,t,n);var i=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",s=t;do{var l=e.insert(t===s?"."+i:"",s,e.sheet,!0);a||void 0===l||(o+=l),s=s.next}while(void 0!==s);if(!a&&0!==o.length)return o}},t.registerStyles=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(712),r=n(714),i=n(515);function o(e){return e&&e.__esModule?e:{default:e}}var s=o(a),l=o(r),c=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},m=o(i).default((function(e){return d(e)?e:e.replace(c,"-$&").toLowerCase()})),f=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,n){return b={name:t,styles:n,next:b},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function g(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return b={name:n.name,styles:n.styles,next:b},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)b={name:a.name,styles:a.styles,next:b},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var r=0;r<n.length;r++)a+=g(e,t,n[r])+";";else for(var i in n){var o=n[i];if("object"!=typeof o)null!=t&&void 0!==t[o]?a+=i+"{"+t[o]+"}":p(o)&&(a+=m(i)+":"+f(i,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=g(e,t,o);switch(i){case"animation":case"animationName":a+=m(i)+":"+s+";";break;default:a+=i+"{"+s+"}"}}else for(var l=0;l<o.length;l++)p(o[l])&&(a+=m(i)+":"+f(i,o[l])+";")}return a}(e,t,n);case"function":if(void 0!==e){var r=b,i=n(e);return b=r,g(e,t,i)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var b,y=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,r="";b=void 0;var i=e[0];null==i||void 0===i.raw?(a=!1,r+=g(n,t,i)):r+=i[0];for(var o=1;o<e.length;o++)r+=g(n,t,e[o]),a&&(r+=i[o]);y.lastIndex=0;for(var l,c="";null!==(l=y.exec(r));)c+="-"+l[1];return{name:s.default(r)+c,styles:r,next:b}}},function(e,t,n){"use strict";e.exports=n(713)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,r=e.length;r>=4;++a,r-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(r){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(715)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return I}));var a=n(188),r=n.n(a),i=n(44),o=n(2),s=n(45),l=n(3),c=n(55),u=n(1484),d=n(118),p=n(376),m=n(129),f=n(978),g=n(131),b=n(137),y=n(146),h=n(246),v=n(980),E=n(763),x=n(5),j=n(764);const O="timelineEventsQuery",S=[{field:"@timestamp",direction:b.b.asc,type:"date",esTypes:["date"]}],w=e=>({...Object(i.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(i.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(i.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(i.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),k=({dataViewId:e,endDate:t,eqlOptions:n,id:a=O,indexNames:j,fields:k,filterQuery:I,runtimeMappings:T,startDate:C,language:M="kuery",limit:_,sort:D=S,skip:N=!1,timerangeKind:A})=>{const[{pageName:F}]=Object(h.a)(),P=Object(s.useDispatch)(),{data:R}=Object(d.j)().services,L=Object(o.useRef)(i.noop),q=Object(o.useRef)(new AbortController),z=Object(o.useRef)(new l.Subscription),[B,$]=Object(o.useState)(u.a.loaded),[V,U]=Object(o.useState)(a===y.c.active?v.a.getActivePage():0),[G,H]=Object(o.useState)(null),W=Object(o.useRef)(null),{startTracking:Q}=Object(E.a)(),Y=Object(o.useCallback)((()=>{null!=a&&f.a.some((e=>e===a))&&(P(m.a.clearEventsLoading({id:a})),P(m.a.clearEventsDeleted({id:a})))}),[P,a]),K=Object(o.useCallback)((e=>{Y(),a===y.c.active&&v.a.setActivePage(e),U(e)}),[Y,a]),Z=Object(o.useCallback)((()=>{null!=L.current&&L.current(),K(0)}),[K]),[X,J]=Object(o.useState)({id:a,inspect:{dsl:[],response:[]},refetch:Z,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0}),ee=Object(o.useCallback)((async(t,n)=>{if(null==t||""===F||N)return;const r=async()=>{W.current=t,q.current=new AbortController,$(0===V?u.a.loading:u.a.loadingMore);const{endTracking:r}=Q({name:`${x.m} timeline events search`});z.current=R.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:q.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(c.isRunningResponse)(e)||(r("success"),$(u.a.loaded),J((r=>{const i={...r,events:(o=e.edges,o.map((e=>e.node))),inspect:Object(g.getInspectResponse)(e,r.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var o;return a===y.c.active&&(v.a.setPageName(F),"eql"===t.language?(v.a.setEqlRequest(t),v.a.setEqlResponse(i)):(v.a.setRequest(t),v.a.setResponse(i))),n&&n(i),i})),z.current.unsubscribe())},error:e=>{r(q.current.signal.aborted?"aborted":"error"),$(u.a.loaded),R.search.showError(e),z.current.unsubscribe()}})};if(a===y.c.active&&""!==v.a.getPageName()&&F!==v.a.getPageName()){if(v.a.setPageName(F),q.current.abort(),$(u.a.loaded),"eql"===t.language?(W.current=v.a.getEqlRequest(),L.current=r.bind(null,v.a.getEqlRequest())):(W.current=v.a.getRequest(),L.current=r.bind(null,v.a.getRequest())),J((e=>{const n="eql"===t.language?v.a.getEqlResponse():v.a.getResponse();return null!=n?{...n,refetch:Z,loadPage:K}:e})),"eql"!==t.language&&null!=v.a.getResponse())return;if("eql"===t.language&&null!=v.a.getEqlResponse())return}z.current.unsubscribe(),q.current.abort(),await r(),L.current=r}),[F,N,a,V,Q,R.search,e,Z,K]);Object(o.useEffect)((()=>{0!==j.length&&H((e=>{var i,o,s,l,c,u,d;const m=e,f={defaultIndex:null!==(i=null==e?void 0:e.defaultIndex)&&void 0!==i?i:[],filterQuery:null!==(o=null==e?void 0:e.filterQuery)&&void 0!==o?o:"",querySize:null!==(s=null==e||null===(l=e.pagination)||void 0===l?void 0:l.querySize)&&void 0!==s?s:0,sort:null!==(c=null==e?void 0:e.sort)&&void 0!==c?c:S,timerange:null!==(u=null==e?void 0:e.timerange)&&void 0!==u?u:{},runtimeMappings:null!==(d=null==e?void 0:e.runtimeMappings)&&void 0!==d?d:{},...w(m)},g=C&&t?{timerange:{interval:"12h",from:C,to:t}}:{},h={defaultIndex:j,filterQuery:Object(p.a)(I),querySize:_,sort:D,runtimeMappings:T,...g,...w(n)},E=r()(f,h)?V:0;let x=k;const O=k.filter((t=>{var n;return!(null!=e&&null!==(n=e.fieldRequested)&&void 0!==n&&n.includes(t))}));var N,A;x=O.length>0?[...null!==(N=null==e?void 0:e.fieldRequested)&&void 0!==N?N:[],...O]:null!==(A=null==e?void 0:e.fieldRequested)&&void 0!==A?A:[];const F={defaultIndex:j,factoryQueryType:b.w.all,fieldRequested:x,fields:x,filterQuery:Object(p.a)(I),pagination:{activePage:E,querySize:_},language:M,runtimeMappings:T,sort:D,...g,...n||{}};return V!==E&&(U(E),a===y.c.active&&v.a.setActivePage(E)),r()(e,F)?e:F}))}),[P,j,V,t,n,I,a,M,_,C,D,k,T]);const te=Object(o.useCallback)((async e=>{a===y.c.active&&"absolute"!==A&&r()(W.current,G)||await ee(G,e)}),[a,G,ee,A]);return Object(o.useEffect)((()=>{Object(i.isEmpty)(I)&&J({id:a,inspect:{dsl:[],response:[]},refetch:Z,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0})}),[I,a,Z,K]),[B,X,te]},I=({dataViewId:e,endDate:t,eqlOptions:n,id:a=O,indexNames:r,fields:i,filterQuery:s,runtimeMappings:l,startDate:c,language:u="kuery",limit:d,sort:p=S,skip:m=!1,timerangeKind:f,fetchNotes:g=!0})=>{const[b,y,h]=k({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:r,fields:i,filterQuery:s,runtimeMappings:l,startDate:c,language:u,limit:d,sort:p,skip:m,timerangeKind:f}),{onLoad:v}=Object(j.a)(),E=Object(o.useCallback)((e=>{g&&v(e.events)}),[g,v]);return Object(o.useEffect)((()=>{h&&h(E)}),[h,E]),[b,y]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f}));var a=n(44),r=n(53),i=n(121),o=n(179);const s=["host.name","host.hostname","host.domain","host.id","host.ip","client.ip","destination.ip","server.ip","source.ip","network.community_id","user.name","process.name"],l=(e,t,n=console)=>{var a,r;const i=null!==(a=null===(r=t.find((t=>t.field===e)))||void 0===r?void 0:r.values)&&void 0!==a?a:null;return null==i?[]:"string"==typeof i?[i]:Array.isArray(i)&&i.every((e=>"string"==typeof e))?i:(n.trace("Data type that is not a string or string array detected:",i,"when trying to access field:",e,"from data object of:",t),[])},c=(e,t=[])=>{let n=t;return"is"===e.function&&s.includes(e.arguments[0].value)&&(n=[...n,{field:e.arguments[0].value,valueToChange:e.arguments[1].value}]),e.arguments.reduce(((e,t)=>"is"===t.function&&s.includes(t.arguments[0].value)?[...e,{field:t.arguments[0].value,valueToChange:t.arguments[1].value}]:t.arguments?c(t,e):e),n)},u=(e,t,n=i.m.default)=>n===i.m.default?""!==e.trim()?c(Object(r.fromKueryExpression)(e)).reduce(((e,n)=>{const a=l(n.field,t);return a.length?e.replace(n.valueToChange,a[0]):e}),e):"":e.trim(),d=(e,t)=>e.map((e=>{if("phrase"===e.meta.type&&null!=e.meta.key&&s.includes(e.meta.key)){const n=l(e.meta.key,t);n.length&&(e.meta.params={query:n[0]},e.query={match_phrase:{[e.meta.key]:n[0]}})}return e})),p=(e,t,n=i.m.default)=>{if(n!==i.m.template){if(s.includes(e.queryMatch.field)){const n=l(e.queryMatch.field,t);n.length&&(e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0)}return e.type=o.a.default,e}if(n===i.m.template){var a;if(e.type===o.a.template&&":"===e.queryMatch.operator){const n=l(e.queryMatch.field,t);return n.length||(e.enabled=!1),e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0,e.type=o.a.default,e}return e.type=null!==(a=e.type)&&void 0!==a?a:o.a.default,e}return e},m=(e,t,n=i.m.default)=>e.map((e=>{const r=p(e,t,n);return null==r.and||Object(a.isEmpty)(r.and)||(r.and=r.and.map((e=>p(e,t,n)))),r})),f=(e,t)=>[{range:{"@timestamp":{gte:e,lte:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lte:t,format:"strict_date_optional_time"}},$state:{store:r.FilterStateStore.APP_STATE}}]},function(e,t,n){"use strict";var a=Array.isArray,r=Object.keys,i=Object.prototype.hasOwnProperty,o="undefined"!=typeof Element;function s(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,l,c,u=a(e),d=a(t);if(u&&d){if((l=e.length)!=t.length)return!1;for(n=l;0!=n--;)if(!s(e[n],t[n]))return!1;return!0}if(u!=d)return!1;var p=e instanceof Date,m=t instanceof Date;if(p!=m)return!1;if(p&&m)return e.getTime()==t.getTime();var f=e instanceof RegExp,g=t instanceof RegExp;if(f!=g)return!1;if(f&&g)return e.toString()==t.toString();var b=r(e);if((l=b.length)!==r(t).length)return!1;for(n=l;0!=n--;)if(!i.call(t,b[n]))return!1;if(o&&e instanceof Element&&t instanceof Element)return e===t;for(n=l;0!=n--;)if(!("_owner"===(c=b[n])&&e.$$typeof||s(e[c],t[c])))return!1;return!0}return e!=e&&t!=t}e.exports=function(e,t){try{return s(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),i=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(723);n(71),n(324),n(323);var r=a.default({key:"css"}),i=r.flush,o=r.hydrate,s=r.cx,l=r.merge,c=r.getRegisteredStyles,u=r.injectGlobal,d=r.keyframes,p=r.css,m=r.sheet,f=r.cache;t.cache=f,t.css=p,t.cx=s,t.flush=i,t.getRegisteredStyles=c,t.hydrate=o,t.injectGlobal=u,t.keyframes=d,t.merge=l,t.sheet=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(71),r=n(324),i=n(323);function o(e){return e&&e.__esModule?e:{default:e}}var s=o(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function c(e,t,n){var a=[],r=i.getRegisteredStyles(e,a,n);return a.length<2?n:r+t(a)}var u=function e(t){for(var n="",a=0;a<t.length;a++){var r=t[a];if(null!=r){var i=void 0;switch(typeof r){case"boolean":break;case"object":if(Array.isArray(r))i=e(r);else for(var o in i="",r)r[o]&&o&&(i&&(i+=" "),i+=o);break;default:i=r}i&&(n&&(n+=" "),n+=i)}}return n};t.default=function(e){var t=s.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var o=r.serializeStyles(n,t.registered,void 0);return i.insertStyles(t,o,!1),t.key+"-"+o.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return c(t.registered,n,u(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var i=r.serializeStyles(n,t.registered);l(t,i)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var i=r.serializeStyles(n,t.registered),o="animation-"+i.name;return l(t,{name:i.name,styles:"@keyframes "+o+"{"+i.styles+"}"}),o},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:i.getRegisteredStyles.bind(null,t.registered),merge:c.bind(null,t.registered,n)}}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(54),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(244),c=n(195);const u=({range:e,setRange:t,loading:n})=>{const[a,u]=Object(i.useState)(e.from===c.a?r()().subtract(30,"d"):r()(e.from)),[d,p]=Object(i.useState)(e.to===c.b?r()():r()(e.to)),m=Object(i.useCallback)((()=>{a&&d&&a.isBefore(d)&&t({from:a.toISOString(),to:d.toISOString()})}),[d,t,a]),f=Object(i.useMemo)((()=>null==a?void 0:a.isBefore(d)),[a,d]);return o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiDatePickerRange,{"data-test-subj":"enrichment-query-range-picker",startDateControl:o.a.createElement(s.EuiDatePicker,{className:"start-picker",selected:a,onChange:u,startDate:a,endDate:d,isInvalid:!f,"aria-label":l.d,showTimeSelect:!0}),endDateControl:o.a.createElement(s.EuiDatePicker,{className:"end-picker",selected:d,onChange:p,startDate:a,endDate:d,isInvalid:!f,"aria-label":l.c,showTimeSelect:!0})})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButton,{iconType:"refresh",onClick:m,isLoading:n,"data-test-subj":"enrichment-button",isDisabled:!f},l.n)))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(262),c=n(122),u=n(118),d=n(695),p=n(197),m=n(247);const f=s.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-woclj6-0"})(["height:100%;position:relative;"]),g=({rawEventData:e,ecsData:t})=>{var n,r,o,s,g,b,y,h,v;const{services:{osquery:E}}=Object(u.j)(),x=Object(c.a)("responseActionsEnabled"),j=Object(c.a)("endpointResponseActionsEnabled"),O=e?Object(l.a)(e.fields):void 0,S=null==O||null===(n=O.kibana)||void 0===n||null===(r=n.alert)||void 0===r||null===(o=r.rule)||void 0===o||null===(s=o.parameters)||void 0===s?void 0:s[0].response_actions,w=!e||!x||j||!t||!(null!=S&&S.length),k=null!==(g=null==e?void 0:e._id)&&void 0!==g?g:"",{OsqueryResults:I,fetchAllLiveQueries:T}=E,{data:C}=T({kuery:`alert_ids: ( ${k} )`,alertId:k,skip:w});if(w)return;const M=S.filter((e=>e.action_type_id===m.b[".osquery"]));if(null==M||!M.length)return;const _=(null==C?void 0:C.data.items)||[],D=null==O||null===(b=O.kibana)||void 0===b||null===(y=b.alert)||void 0===y||null===(h=y.rule)||void 0===h||null===(v=h.name)||void 0===v?void 0:v[0],N=i.a.createElement(f,{"data-test-subj":"osqueryViewWrapper"},i.a.createElement(I,{ruleName:D,actionItems:_,ecsData:t}),i.a.createElement(a.EuiSpacer,{size:"s"}));return{id:d.b.osqueryView,"data-test-subj":"osqueryViewTab",name:p.u,append:i.a.createElement(a.EuiNotificationBadge,{"data-test-subj":"osquery-actions-notification"},_.length),content:N}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(838),o=n(172),s=n(377);const l=({ariaLabel:e=o.j,ecsRowData:t,buttonType:n,onInvestigateInTimelineAlertClick:a})=>{const{investigateInTimelineAlertClick:l}=Object(s.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:a});return r.a.createElement(i.a,{ariaLabel:e,content:o.i,dataTestSubj:"send-alert-to-timeline",iconType:"timeline",onClick:l,isDisabled:!1,buttonType:n})},c=r.a.memo(l)},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return l}));var a=n(247);const r=({group:e,id:t,action_type_id:n,params:a,uuid:r,frequency:i,alerts_filter:o})=>({group:e,id:t,params:a,actionTypeId:n,...o&&{alertsFilter:o},...r&&{uuid:r},...i&&{frequency:i}}),i=({group:e,id:t,actionTypeId:n,params:a,uuid:r,frequency:i,alertsFilter:o})=>({group:e,id:t,params:a,action_type_id:n,...o&&{alerts_filter:o},...r&&{uuid:r},...i&&{frequency:i}}),o=({group:e,id:t,params:n,frequency:a,alertsFilter:r})=>({group:e,id:t,params:n,...r&&{alerts_filter:r},...a&&{frequency:a}}),s=({action_type_id:e,params:t})=>{if(e===a.b[".osquery"]){const{saved_query_id:n,ecs_mapping:a,pack_id:r,...i}=t;return{params:{...i,savedQueryId:n,ecsMapping:a,packId:r},actionTypeId:e}}return{params:t,actionTypeId:e}},l=({actionTypeId:e,params:t})=>{if(e===a.b[".osquery"]){const{savedQueryId:n,ecsMapping:a,packId:r,...i}=t;return{params:{...i,saved_query_id:n,ecs_mapping:a,pack_id:r},action_type_id:e}}return{params:t,action_type_id:e}}},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return g}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),s=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addCustomHighlightedFieldDescription",{defaultMessage:"Add a custom highlighted field"}),a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"})),l=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.setupHelpText",{defaultMessage:"Add rule setup guide..."})},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(4);a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"}),a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"});const r=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"}),i=(a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExceptionsTab",{defaultMessage:"Rule exceptions"})),o=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.endpointExceptionsTab",{defaultMessage:"Endpoint exceptions"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionResultsTab",{defaultMessage:"Execution results"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionEventsTab",{defaultMessage:"Execution events"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deleteRuleConfirmationBody",{defaultMessage:'This action will delete the rule. Click "Delete" to continue.'})},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(42),l=n(19),c=n(41),u=n.n(c),d=n(482);const p=u()(l.EuiButtonEmpty).withConfig({displayName:"EuiButtonEmptyStyled",componentId:"sc-1h0vyjj-0"})(["margin-bottom:",";.euiIcon{width:",";height:",";}.text{font-size:",";margin-inline-start:",";}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),m=Object(i.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:n,...a})=>{const i=Object(d.a)(...n);return o.a.createElement(p,r()({"data-test-subj":"backToOrigin"},a,{flush:"left",size:"xs",iconType:"arrowLeft",href:t,onClick:i,textProps:{className:"text"}}),e||o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));m.displayName="BackToExternalAppButton"},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"q",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"l",(function(){return E})),n.d(t,"h",(function(){return x}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"}),i=a.i18n.translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"}),o=a.i18n.translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"}),s=a.i18n.translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),l=a.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),c=a.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskLevel",{defaultMessage:"Host risk level"}),u=a.i18n.translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),d=a.i18n.translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"}),p=a.i18n.translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"}),m=a.i18n.translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"}),f=a.i18n.translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"}),g=a.i18n.translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"}),b=a.i18n.translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"}),y=a.i18n.translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"}),h=a.i18n.translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"}),v=a.i18n.translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"}),E=a.i18n.translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"}),x=a.i18n.translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"})},function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"j",(function(){return f}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.user.details.overview.userIdTitle",{defaultMessage:"User ID"}),i=a.i18n.translate("xpack.securitySolution.user.details.overview.userDomainTitle",{defaultMessage:"Domain"}),o=a.i18n.translate("xpack.securitySolution.user.details.overview.familyTitle",{defaultMessage:"Family"}),s=a.i18n.translate("xpack.securitySolution.user.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),l=a.i18n.translate("xpack.securitySolution.user.details.overview.osTitle",{defaultMessage:"Operating system"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),u=a.i18n.translate("xpack.securitySolution.user.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),d=a.i18n.translate("xpack.securitySolution.user.details.overview.inspectTitle",{defaultMessage:"User overview"}),p=a.i18n.translate("xpack.securitySolution.user.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),m=a.i18n.translate("xpack.securitySolution.user.details.overview.userRiskScoreTitle",{defaultMessage:"User risk score"}),f=a.i18n.translate("xpack.securitySolution.user.details.overview.userRiskLevel",{defaultMessage:"User risk level"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j}));var a=n(2),r=n.n(a),i=n(5),o=n(204),s=n(1532),l=n(1533);const c=Object(s.a)(o.w);var u=n(123),d=n(118),p=n(4);const m=p.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),f=p.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.detectionEnginePrivileges.errorFetching",{defaultMessage:"Failed to retrieve detection engine privileges"});var g=n(370);var b=n(7),y=n(1213),h=n(16),v=n(743),E=n(1214);const x=Object(a.createContext)({listPrivileges:{loading:!1,error:void 0,result:void 0},detectionEnginePrivileges:{loading:!1,error:void 0,result:void 0},endpointPrivileges:{loading:!0,...Object(v.b)()},kibanaSecuritySolutionsPrivileges:{crud:!1,read:!1}}),j=({kibanaCapabilities:e,children:t})=>{const n=!0===e[i.Lc].crud,o=!0===e[i.Lc].show,[p,j]=Object(a.useState)({crud:n,read:o}),O=((e=!0)=>{const t=Object(d.i)(),{lists:n}=Object(d.j)().services,{start:r,...i}=Object(l.a)(c),{addError:o}=Object(u.a)(),s=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>{const{loading:a,result:o,error:l}=i;!e||!n||a||o||l||(s.current.abort(),s.current=new AbortController,r({http:t,signal:s.current.signal}))}),[t,n,r,i,e]),Object(a.useEffect)((()=>()=>{s.current.abort()}),[]),Object(a.useEffect)((()=>{const e=i.error;null!=e&&o(e,{title:m})}),[o,i.error]),{loading:i.loading,error:i.error,result:i.result}})(o),S=((e=!0)=>{const{start:t,...n}=Object(l.a)(Object(s.a)(g.h)),{addError:r}=Object(u.a)(),i=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>{const{loading:a,result:r,error:o}=n;!e||a||r||o||(i.current.abort(),i.current=new AbortController,t({signal:i.current.signal}))}),[t,n,e]),Object(a.useEffect)((()=>()=>{i.current.abort()}),[]),Object(a.useEffect)((()=>{const e=n.error;null!=e&&r(e,{title:f})}),[r,n.error]),n})(o),w=(()=>{var e,t;const n=Object(y.a)(),r=Object(d.f)(),i=Object(d.j)().services.fleet,o=null===(e=Object(E.b)())||void 0===e?void 0:e.fleet,s=null!==(t=null==i?void 0:i.authz)&&void 0!==t?t:null==o?void 0:o.authz,l=Object(h.b)(),[c,u]=Object(a.useState)(!1),[p,m]=Object(a.useState)([]),f=Object(a.useMemo)((()=>{const e=!c||!r;return Object.freeze({loading:e,...e||!s||Object(b.isEmpty)(r)?Object(v.b)():Object(v.a)(l,s,p)})}),[c,r,s,l,p]);return Object(a.useEffect)((()=>{(async()=>{r&&n()&&(m(null==r?void 0:r.roles),u(!0))})()}),[n,r]),f})();return Object(a.useEffect)((()=>{j((e=>e.read!==o||e.crud!==n?{read:o,crud:n}:e))}),[n,o]),r.a.createElement(x.Provider,{value:{listPrivileges:O,detectionEnginePrivileges:S,endpointPrivileges:w,kibanaSecuritySolutionsPrivileges:p}},t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(19),l=n(42),c=n(153),u=n(140),d=n(47),p=n(3),m=n(7),f=n(167),g=n(262);let b=function(e){return e.asc="asc",e.desc="desc",e}({}),y=function(e){return e.actions="responseActions",e.results="responseActionsResults",e}({});var h=n(118);var v=n(1100),E=n(197),x=n(771);const j=({type:e})=>{const t=Object(a.useMemo)((()=>{if("endpoint"===e)return{icon:"logoSecurity",name:"Elastic Defend"}}),[e]);return r.a.createElement(s.EuiEmptyPrompt,{iconType:t.icon,title:r.a.createElement("h2",null,x.b),titleSize:"xs",body:r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.responseActions.results.missingPrivileges",defaultMessage:"To access these results, ask your administrator for {integration} Kibana privileges.",values:{integration:r.a.createElement(s.EuiCode,null,t.name)}})})},O=({action:e,ruleName:t})=>{const{agent:n}=e,{action_id:i,expiration:o}=e.EndpointActions,{endpointPrivileges:{canAccessEndpointActionsLogManagement:c}}=Object(u.a)(),[m,g]=Object(a.useState)(!0),{data:E}=((e,{enabled:t,action:n,isLive:a=!1})=>{const{data:r}=Object(h.j)().services,{expiration:i,actionId:o,agent:s}=e;return Object(d.useQuery)({queryKey:["allResponsesResults",{actionId:o}],queryFn:async()=>{var e,t,n;const a=await Object(p.lastValueFrom)(r.search.search({actionId:o,expiration:i,sort:{order:b.desc,field:"@timestamp"},agents:(Array.isArray(s.id)?s.id:[s.id]).length,factoryQueryType:y.results},{strategy:f.n}));return{action_id:o,completedAt:null===(e=a.edges[0])||void 0===e||null===(t=e.fields)||void 0===t||null===(n=t["EndpointActions.completed_at"])||void 0===n?void 0:n[0],isExpired:a.isExpired,wasSuccessful:a.wasSuccessful,isCompleted:a.isCompleted,status:a.status}},select:e=>((e,t)=>{var n;const{rule:a}=e,{parameters:r,alert_id:i,comment:o,command:s,hosts:l}=e.EndpointActions.data;return{id:e.EndpointActions.action_id,agents:Array.isArray(e.agent.id)?e.agent.id:[e.agent.id],agentType:"endpoint",parameters:r,...null!=i&&i.length?{alertIds:i}:{},...a?{ruleId:a.id,ruleName:a.name}:{},createdBy:(null===(n=e.rule)||void 0===n?void 0:n.name)||"unknown",comment:o,command:s,hosts:l,startedAt:e["@timestamp"],completedAt:null==t?void 0:t.completedAt,isCompleted:!(null==t||!t.isCompleted),isExpired:!(null==t||!t.isExpired),wasSuccessful:"successful"===t.status,status:t.status,agentState:{},errors:e.error?[e.error.message]:void 0}})(n,e),keepPreviousData:!0,enabled:t,refetchInterval:!!a&&5e3})})({actionId:i,expiration:o,agent:n},{enabled:c,action:e,isLive:m});Object(a.useEffect)((()=>{g((()=>{var e;return!E||!(null!==(e=E.errors)&&void 0!==e&&e.length)&&"pending"===E.status}))}),[E]);const x=E?S(E):"",O=Object(a.useMemo)((()=>null!=E&&E.hosts?Object.values(E.hosts)[0].name:""),[null==E?void 0:E.hosts]);return r.a.createElement(s.EuiComment,{username:t,timestamp:r.a.createElement(l.FormattedRelative,{value:e["@timestamp"]}),event:x,"data-test-subj":"endpoint-results-comment"},c?E?r.a.createElement(v.a,{action:E,fromAlertWorkaround:!0,"data-test-subj":`response-results-${O}`}):r.a.createElement(s.EuiLoadingSpinner,null):r.a.createElement(j,{type:"endpoint"}))},S=e=>{var t;return null!==(t=e.errors)&&void 0!==t&&t.length?E.g.failed(e.command):"pending"===e.status?E.g.pending(e.command):"successful"===e.status?E.g.executed(e.command):E.g.tried(e.command)},w=r.a.memo((({actions:e,ruleName:t,ecsData:n})=>{const{services:{osquery:i}}=Object(h.j)(),{OsqueryResult:o}=i,l=Object(a.useCallback)((e=>{if(k(e)){const a=e.action_id,i=e["@timestamp"];return r.a.createElement(o,{key:a,actionId:a,startDate:i,ruleName:t,ecsData:n})}return I(e)?r.a.createElement(O,{action:e,ruleName:t,key:e.EndpointActions.action_id}):null}),[o,n,t]);return r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),l(e),r.a.createElement(s.EuiSpacer,{size:"s"})))))}));w.displayName="ResponseActionsResults";const k=e=>!(!e||!("input_type"in e)||"osquery"!==(null==e?void 0:e.input_type)),I=e=>{var t;return!(!e||!("EndpointActions"in e)||"endpoint"!==(null==e||null===(t=e.EndpointActions)||void 0===t?void 0:t.input_type))};var T=n(695),C=n(122);const M=o.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-1y7ogme-0"})(["height:100%;position:relative;"]),_=o.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-1y7ogme-1"})(["display:inline-block;line-height:1.7em;"]),D=()=>r.a.createElement(_,{"data-test-subj":c.K},r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataDescription",defaultMessage:"There are no response actions defined for this event. To add some, edit the rule's settings and set up {link}.",values:{link:r.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-create.html#rule-response-action",target:"_blank"},r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataLinkText",defaultMessage:"response actions"}))}})),N=({rawEventData:e,ecsData:t})=>{var n,i,o,l,c;const u=Object(a.useMemo)((()=>({id:T.b.responseActionsView,"data-test-subj":"responseActionsViewTab",name:E.y})),[]),v=Object(C.a)("endpointResponseActionsEnabled"),x=e?Object(g.a)(e.fields):void 0,j=null==x||null===(n=x.kibana)||void 0===n||null===(i=n.alert)||void 0===i||null===(o=i.rule)||void 0===o||null===(l=o.parameters)||void 0===l?void 0:l[0].response_actions,O=!e||!v,S=null!==(c=null==e?void 0:e._id)&&void 0!==c?c:"",[k,I]=Object(a.useState)(!1),{data:_,isFetched:N}=((e,{enabled:t,isLive:n})=>{const{data:a}=Object(h.j)().services,{alertIds:r}=e;return Object(d.useQuery)({queryKey:["actions",{alertId:r[0]}],queryFn:async()=>{const e=await Object(p.lastValueFrom)(a.search.search({alertIds:r,sort:{order:b.desc,field:"@timestamp"},factoryQueryType:y.actions},{strategy:f.n})),t=Object(m.map)(Object(m.filter)(e.edges,"fields"),(e=>Object(g.a)(e.fields,!0)));return{...e,items:Object(m.compact)(t)}},enabled:t,refetchInterval:!!n&&5e3,keepPreviousData:!0})})({alertIds:[S]},{enabled:!O,isLive:k});if(Object(a.useEffect)((()=>{I((()=>{var e;return!(null==j||!j.length||null!=_&&null!==(e=_.items)&&void 0!==e&&e.length)}))}),[_,null==j?void 0:j.length]),O)return{...u,content:r.a.createElement(D,null)};{var A,F,P,R,L;const e=null==x||null===(A=x.kibana)||void 0===A||null===(F=A.alert)||void 0===F||null===(P=F.rule)||void 0===P||null===(R=P.name)||void 0===R?void 0:R[0],n=null!==(L=null==_?void 0:_.items)&&void 0!==L?L:[];return{...u,append:r.a.createElement(s.EuiNotificationBadge,{"data-test-subj":"response-actions-notification"},n.length),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(M,{"data-test-subj":"responseActionsViewWrapper"},N&&n.length?r.a.createElement(w,{actions:n,ruleName:e,ecsData:t}):r.a.createElement(D,null)))}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var a=n(19),r=n(2),i=n.n(r),o=n(7),s=n(195),l=n(244),c=n(336);const u=e=>Object(c.f)(e)?l.j:l.g,d=({type:e})=>i.a.createElement(a.EuiToolTip,{content:u(e)},i.a.createElement(a.EuiIcon,{type:"iInCircle",size:"m"}));var p=n(41),m=n.n(p);const f=m.a.div.withConfig({displayName:"OverflowParent",componentId:"sc-sjnml3-0"})(["display:inline-grid;"]),g=m.a.div.withConfig({displayName:"OverflowContainer",componentId:"sc-sjnml3-1"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold;"]),b=({field:e="",feedName:t="",value:n=""})=>{const r=`${e} ${n}${t?` ${l.e} ${t}`:""}`;return i.a.createElement(a.EuiToolTip,{content:n},i.a.createElement(f,{"data-test-subj":"enrichment-button-content"},i.a.createElement(g,null,r)))},y=m.a.h5.withConfig({displayName:"StyledH5",componentId:"sc-1i38kio-0"})(["line-height:1.7rem;"]),h=e=>i.a.createElement(a.EuiTitle,{size:"xxxs"},i.a.createElement(y,null,e));h.displayName="ThreatSummaryTitle";var v=n(181),E=n(441);const x=m()(a.EuiInMemoryTable).withConfig({displayName:"ThreatSummaryTable",componentId:"sc-1pwinz3-0"})([".euiTableHeaderCell,.euiTableRowCell{border:none;}.euiTableHeaderCell .euiTableCellContent{padding:0;}"]),j=m()(a.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-mlcc85-0"})([".euiAccordion__triggerWrapper{background:",";border-radius:",";height:",";margin-bottom:",";padding-left:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXL),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),O=[{field:"title",truncateText:!1,render:h,width:"220px",name:""},{field:"description",truncateText:!1,render:({fieldName:e,value:t})=>{const n=e.match(s.p)?i.a.createElement(a.EuiLink,{href:t,target:"_blank"},t):i.a.createElement("span",null,t);return i.a.createElement(a.EuiToolTip,{"data-test-subj":"message-tool-tip",content:i.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement("span",null,e)))},n)},name:""}],S=({enrichment:e,index:t})=>{const{id:n="threat-details-item",field:r,feedName:o,type:s,value:u}=Object(c.d)(e),d=`${n}${r}`;return i.a.createElement(j,{id:d,key:d,initialIsOpen:!0,arrowDisplay:"right",buttonContent:i.a.createElement(b,{field:r,feedName:o,value:u}),extraAction:Object(c.f)(s)&&i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(v.b,{queryId:E.a,title:l.i}))},i.a.createElement(x,{columns:O,compressed:!0,"data-test-subj":`threat-details-view-${t}`,items:Object(c.a)(e)}))},w=({enrichments:e})=>i.a.createElement(i.a.Fragment,null,e.sort(((e,t)=>Object(c.e)(t)-Object(c.e)(e))).map(((t,n)=>i.a.createElement(i.a.Fragment,{key:`${t.id}`},i.a.createElement(S,{enrichment:t,index:n}),n<e.length-1&&i.a.createElement(a.EuiSpacer,{size:"m"})))));var k=n(42);const I=m.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-oksmx3-0"})(["display:inline-block;line-height:1.7em;"]),T=({type:e})=>e?i.a.createElement(I,{"data-test-subj":"no-enrichments-found"},e===s.c.IndicatorMatchRule?l.l:i.a.createElement(k.FormattedMessage,{id:"xpack.securitySolution.enrichment.noInvestigationEnrichment",defaultMessage:"Additional threat intelligence wasn't found within the selected time frame. Try a different time frame, or {link} to collect threat intelligence for threat detection and matching.",values:{link:i.a.createElement(a.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/es-threat-intel-integrations.html",target:"_blank"},i.a.createElement(k.FormattedMessage,{id:"xpack.securitySolution.enrichment.investigationEnrichmentDocumentationLink",defaultMessage:"enable threat intelligence integrations"}))}})):null,C=({type:e})=>e?i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"baseline"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiTitle,{size:"xxxs"},i.a.createElement("h3",null,e===s.c.IndicatorMatchRule?l.f:l.h))),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(d,{type:e}))),i.a.createElement(a.EuiSpacer,{size:"s"})):null,M=({enrichments:e,type:t,loading:n,dataTestSubj:r,children:o})=>i.a.createElement("div",{"data-test-subj":r},i.a.createElement(C,{type:t}),o,Array.isArray(e)?i.a.createElement(w,{enrichments:e}):i.a.createElement(i.a.Fragment,null,i.a.createElement(T,{type:t}),n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiSpacer,{size:"m"}),i.a.createElement(a.EuiSkeletonText,{"data-test-subj":"loading-enrichments",lines:4})))),_=({enrichments:e,before:t=null,showInvestigationTimeEnrichments:n,loading:r,children:l})=>{const{[s.c.IndicatorMatchRule]:c,[s.c.InvestigationTime]:u,undefined:d}=Object(o.groupBy)(e,"matched.type");return i.a.createElement(i.a.Fragment,null,t,i.a.createElement(M,{dataTestSubj:"threat-match-detected",enrichments:c,type:s.c.IndicatorMatchRule}),n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiHorizontalRule,null),i.a.createElement(M,{dataTestSubj:"enriched-with-threat-intel",enrichments:u,type:s.c.InvestigationTime,loading:r},l)),d&&i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiHorizontalRule,null),c&&i.a.createElement(a.EuiSpacer,{size:"l"}),i.a.createElement(M,{enrichments:d,dataTestSubj:"matches-with-no-type"})))},D=i.a.memo(_)},function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"a",(function(){return B}));var a=n(44),r=n(19),i=n(42),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(45),d=n(1216),p=n(122),m=n(118),f=n(145),g=n(130),b=n(300),y=n(129),h=n(272),v=n(4);const E=v.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),x=v.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),j=v.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),O=v.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),S=v.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),w=v.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),k=v.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var I=n(146),T=n(124),C=n(127),M=n(132),_=n(47),D=n(123),N=n(260),A=n(909);const F=c.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));F.displayName="NotePreviewsContainer";const P=({eventId:e,timelineId:t})=>{const n=Object(u.useDispatch)(),{selectedPatterns:a}=Object(M.a)(C.SourcererScopeName.timeline),{telemetry:i}=Object(m.j)().services,{openFlyout:l}=Object(d.a)(),c=Object(p.a)("expandableFlyoutDisabled"),g=Object(o.useCallback)((()=>{const r=a.join(",");c?n(y.a.toggleDetailPanel({panelView:"eventDetail",tabType:I.d.notes,id:t,params:{eventId:e,indexName:r}})):(l({right:{id:f.e,params:{id:e,indexName:r,scopeId:t}}}),i.reportDetailsFlyoutOpened({location:t,panel:"right"}))}),[n,e,c,l,a,i,t]);return s.a.createElement(r.EuiButtonIcon,{"data-test-subj":"notes-toggle-event-details",title:E,"aria-label":E,color:"text",iconType:"arrowRight",onClick:g})},R=s.a.memo(P),L=s.a.memo((({closeModal:e,confirmModal:t})=>s.a.createElement(r.EuiConfirmModal,{title:k,onCancel:e,onConfirm:t,cancelButtonText:w,confirmButtonText:S,buttonColor:"danger",defaultFocusedButton:"confirm"})));L.displayName="DeleteNoteConfirm";const q=s.a.memo((({noteId:e,eventId:t,confirmingNoteId:n,timelineId:a,eventIdToNoteIds:i,savedObjectId:l})=>{const c=Object(u.useDispatch)(),[d,p]=Object(o.useState)(!1),{mutate:f,isLoading:g}=function(e,t,n,a){const{services:{http:r}}=Object(m.j)(),i=Object(u.useDispatch)(),{addError:o}=Object(D.a)();return Object(_.useMutation)({mutationFn:e=>r.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{const r=null==n?void 0:n[null!=t?t:""];a&&i(N.a.deleteNote({id:a})),e&&t&&i(y.a.deleteNoteFromEvent({id:I.c.active,noteId:e,eventId:t})),t&&r&&1===r.length&&i(y.a.unPinEvent({eventId:t,id:I.c.active}))},onError:e=>{var t;o(e,{title:(t=e,v.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:"string"==typeof t?t:null==t?void 0:t.message}}))})}})}(e,t,i,l),b=Object(o.useCallback)((()=>{p(!0),c(y.a.setConfirmingNoteId({confirmingNoteId:e,id:null!=a?a:I.c.active}))}),[e,c,a]),h=Object(o.useCallback)((()=>{p(!1),c(y.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:I.c.active}))}),[c,a]),E=Object(o.useCallback)((()=>{f(l),p(!1),c(y.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:I.c.active}))}),[f,l,c,a]),x=Object(o.useMemo)((()=>g||null==l),[g,l]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiButtonIcon,{title:S,"aria-label":S,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:b,disabled:x}),n===e&&d?s.a.createElement(L,{closeModal:h,confirmModal:E}):null)}));q.displayName="DeleteNoteButton";const z=s.a.memo((({eventId:e,timelineId:t,noteId:n,confirmingNoteId:a,eventIdToNoteIds:r,savedObjectId:i,showToggleEventDetailsAction:o=!0})=>e&&t?s.a.createElement(s.a.Fragment,null,o?s.a.createElement(R,{eventId:e,timelineId:t}):null,s.a.createElement(q,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:i,timelineId:t,eventIdToNoteIds:r})):s.a.createElement(q,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:i,timelineId:t,eventIdToNoteIds:r})));z.displayName="NoteActions";const B=s.a.memo((({notes:e,timelineId:t,showTimelineDescription:n,showToggleEventDetailsAction:l=!0})=>{const c=Object(o.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),u=Object(o.useMemo)((()=>Object(A.a)()),[]),d=Object(T.a)((e=>c(e,null!=t?t:I.c.active))),p=Object(T.a)((e=>u(e,null!=t?t:I.c.active))),m=null==p?void 0:p.eventIdToNoteIds,f=Object(o.useMemo)((()=>n&&t&&null!=d&&d.description?[{username:Object(g.a)(d.updatedBy),event:j,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:d.updated?s.a.createElement(i.FormattedRelative,{"data-test-subj":"updated",value:new Date(d.updated)}):Object(g.e)(),children:s.a.createElement(r.EuiText,{size:"s"},d.description),timelineAvatar:s.a.createElement(r.EuiAvatar,{"data-test-subj":"avatar",name:null!=d.updatedBy?d.updatedBy:"?",size:"l"}),actions:null}]:[]),[d,t,n]),v=Object(o.useMemo)((()=>Object(a.uniqBy)("savedObjectId",e).map((e=>{var n,a,o;const c=null!=m?Object.entries(m).reduce(((t,[n,a])=>{var r;return a.includes(null!==(r=e.noteId)&&void 0!==r?r:"")?n:t}),null):null!==(n=e.eventId)&&void 0!==n?n:null;return{"data-test-subj":`note-preview-${e.savedObjectId}`,username:Object(g.a)(e.updatedBy),event:x,timestamp:e.updated?s.a.createElement(i.FormattedRelative,{"data-test-subj":"updated",value:new Date(e.updated)}):Object(g.e)(),children:s.a.createElement("div",{className:h.a,tabIndex:0},s.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},s.a.createElement("p",null,`${null!==(a=e.updatedBy)&&void 0!==a?a:O} ${x}`)),s.a.createElement(b.b,null,null!==(o=e.note)&&void 0!==o?o:"")),actions:s.a.createElement(z,{eventId:c,timelineId:t,noteId:e.noteId,savedObjectId:e.savedObjectId,confirmingNoteId:null==d?void 0:d.confirmingNoteId,eventIdToNoteIds:m,showToggleEventDetailsAction:l}),timelineAvatar:s.a.createElement(r.EuiAvatar,{"data-test-subj":"avatar",name:null!=e.updatedBy?e.updatedBy:"?",size:"l"})}}))),[m,e,t,null==d?void 0:d.confirmingNoteId,l]),E=Object(o.useMemo)((()=>[...f,...v]),[f,v]);return s.a.createElement(r.EuiCommentList,{"data-test-subj":"note-comment-list",comments:E})}));B.displayName="NotePreviews"},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var a=n(7),r=n(174);const i=(e,t,n=[],i)=>{var o,s,l,c;const u=function(e,t){return function(n,{action:a}={}){var r,i,o,s,l;if(t){const e=null!=a?a:t.getApiActionName(n);if(!t.isActionRegistered(e))return!1}return"showEndpointExceptions"===n||"crudEndpointExceptions"===n?null!==(s=null===(l=e.endpointExceptionsPrivileges)||void 0===l?void 0:l.actions[n])&&void 0!==s&&s:null!==(r=null===(i=e.packagePrivileges)||void 0===i||null===(o=i.endpoint)||void 0===o?void 0:o.actions[n].executePackageAction)&&void 0!==r&&r}}(t,i),d=e.isPlatinumPlus(),p=e.isEnterprise(),m=n.includes("superuser"),f=u("writeSecuritySolution",{action:"ui:crud"}),g=u("readSecuritySolution",{action:"ui:show"}),b=u("writeEndpointList"),y=u("readEndpointList"),h=u("writePolicyManagement"),v=u("readPolicyManagement"),E=u("writeActionsLogManagement"),x=u("readActionsLogManagement"),j=u("writeHostIsolation"),O=u("writeHostIsolationRelease"),S=u("writeProcessOperations"),w=u("writeTrustedApplications"),k=u("readTrustedApplications"),I=u("writeHostIsolationExceptions"),T=u("readHostIsolationExceptions"),C=u("accessHostIsolationExceptions"),M=u("deleteHostIsolationExceptions"),_=u("writeBlocklist"),D=u("readBlocklist"),N=u("writeEventFilters"),A=u("readEventFilters"),F=u("writeFileOperations"),P=u("writeExecuteOperations"),R=u("writeScanOperations"),L=u("showEndpointExceptions"),q=u("crudEndpointExceptions"),z={canWriteSecuritySolution:f,canReadSecuritySolution:g,canAccessFleet:null!==(o=null==t?void 0:t.fleet.all)&&void 0!==o&&o,canReadFleetAgentPolicies:null!==(s=null==t?void 0:t.fleet.readAgentPolicies)&&void 0!==s&&s,canWriteFleetAgents:null!==(l=null==t?void 0:t.fleet.allAgents)&&void 0!==l&&l,canReadFleetAgents:null!==(c=null==t?void 0:t.fleet.readAgents)&&void 0!==c&&c,canAccessEndpointManagement:m,canCreateArtifactsByPolicy:d,canWriteEndpointList:b,canReadEndpointList:y,canWritePolicyManagement:h,canReadPolicyManagement:v,canWriteActionsLogManagement:E,canReadActionsLogManagement:x&&p,canAccessEndpointActionsLogManagement:x&&d,canIsolateHost:j&&d,canUnIsolateHost:O,canKillProcess:S&&p,canSuspendProcess:S&&p,canGetRunningProcesses:S&&p,canAccessResponseConsole:!1,canWriteExecuteOperations:P&&p,canWriteFileOperations:F&&p,canWriteScanOperations:R&&p,canWriteTrustedApplications:w,canReadTrustedApplications:k,canWriteHostIsolationExceptions:I&&d,canAccessHostIsolationExceptions:C&&d,canReadHostIsolationExceptions:T,canDeleteHostIsolationExceptions:M,canWriteBlocklist:_,canReadBlocklist:D,canWriteEventFilters:N,canReadEventFilters:A,canReadEndpointExceptions:L,canWriteEndpointExceptions:q};return z.canAccessResponseConsole=p&&Object.values(Object(a.omit)(r.j,"release")).some((e=>z[e])),z},o=()=>({canWriteSecuritySolution:!1,canReadSecuritySolution:!1,canAccessFleet:!1,canReadFleetAgentPolicies:!1,canReadFleetAgents:!1,canWriteFleetAgents:!1,canAccessEndpointActionsLogManagement:!1,canAccessEndpointManagement:!1,canCreateArtifactsByPolicy:!1,canWriteEndpointList:!1,canReadEndpointList:!1,canWritePolicyManagement:!1,canReadPolicyManagement:!1,canWriteActionsLogManagement:!1,canReadActionsLogManagement:!1,canIsolateHost:!1,canUnIsolateHost:!1,canKillProcess:!1,canSuspendProcess:!1,canGetRunningProcesses:!1,canAccessResponseConsole:!1,canWriteFileOperations:!1,canWriteExecuteOperations:!1,canWriteScanOperations:!1,canWriteTrustedApplications:!1,canReadTrustedApplications:!1,canWriteHostIsolationExceptions:!1,canAccessHostIsolationExceptions:!1,canReadHostIsolationExceptions:!1,canDeleteHostIsolationExceptions:!1,canWriteBlocklist:!1,canReadBlocklist:!1,canWriteEventFilters:!1,canReadEventFilters:!1,canReadEndpointExceptions:!1,canWriteEndpointExceptions:!1})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(504),l=n(304);var c=n(700);const u=o.a.div.withConfig({displayName:"StyledContent",componentId:"sc-18lfxbd-0"})(["padding:",";width:100%;margin:0 auto;"],(({$isDetails:e})=>e?"0 8px":void 0)),d=({data:e,ecsData:t,eventId:n,header:i,isDetails:o,isDraggable:d,isTimeline:p,linkValues:m,rowRenderers:f,scopeId:g,truncate:b,asPlainText:y,context:h})=>{const v=Object(a.useMemo)((()=>void 0!==Object(c.b)(i.id,i.type,i.linkField)&&!p),[i.id,i.linkField,i.type,p]),E=Object(s.c)({data:e,fieldName:i.id}),x=o?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return r.a.createElement(u,{className:x,$isDetails:o},((e,t,n,a)=>{const r=t.find((t=>t.isInstance(e,n,a)));return null!=r?r:(()=>{throw new Error("Unhandled Column Renderer")})()})(i.id,l.a,e,h).renderColumn({asPlainText:null!=y?y:v,columnName:i.id,ecsData:t,eventId:n,field:i,isDetails:o,isDraggable:d,linkValues:m,rowRenderers:f,scopeId:g,truncate:b,values:E,context:h}))}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),r=n(1371),i=n(458),o=n(403);const s=a.exact(a.type({field:r.a,list:a.exact(a.type({id:r.a,type:i.a})),operator:o.c,type:a.keyof({list:null})}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(1055),i=a.__importDefault(n(461)),o=function(e,t){return e.every((function(e,n){return r.equal(e,t[n])}))};t.default=function(e,t){i.default(e,t,o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),r=n(796),i=n(750);const o=new a.Type("NonEmptyEntriesArray",r.a.is,((e,t)=>Array.isArray(e)&&0===e.length?a.failure(e,t):Array.isArray(e)&&e.some((e=>i.a.is(e)))&&e.some((e=>!i.a.is(e)))?a.failure(e,t,"Cannot have entry of type list and other"):r.a.validate(e,t)),a.identity)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),r=n.n(a),i=n(19),o=n(42),s=n(54),l=n.n(s),c=n(2),u=n.n(c);const d=u.a.memo((({children:e,date:t,fieldName:n,className:a="",tooltipProps:s})=>u.a.createElement(i.EuiToolTip,r()({"data-test-subj":"localized-date-tool-tip",anchorClassName:a},s,{content:u.a.createElement(i.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?u.a.createElement(i.EuiFlexItem,{grow:!1},u.a.createElement("span",{"data-test-subj":"field-name"},n)):null,u.a.createElement(i.EuiFlexItem,{grow:!1},u.a.createElement(o.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:l.a.utc(t).toDate()})),u.a.createElement(i.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},l.a.utc(t).local().format("llll")),u.a.createElement(i.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},l()(t).format()))}),u.a.createElement(u.a.Fragment,null,e))));d.displayName="LocalizedDateTooltip"},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),i=(a.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>a.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),o=a.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"});a.i18n.translate("xpack.securitySolution.eventsViewer.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(228);const c=s.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),u=({count:e,onClick:t})=>{const n=Object(r.useCallback)((()=>t&&t()),[t]);return e?t?i.a.createElement(a.EuiLink,{onClick:n},i.a.createElement("b",null,i.a.createElement(l.a,{count:e}))):i.a.createElement("b",null,i.a.createElement(l.a,{count:e})):i.a.createElement(c,null)};u.displayName="ChartLabelComponent";const d=i.a.memo(u)},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v}));var a=n(19),r=n(2),i=n.n(r),o=n(72),s=n(7),l=n(41),c=n.n(l),u=n(4),d=n(708),p=n(882),m=n(770);const f={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},g=c()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),b=c()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),y=({children:e,dataExists:t,donutTextWrapperClassName:n,donutTextWrapperStyles:o,isChartEmbeddablesEnabled:s,label:l,title:c})=>{const{euiTheme:u}=Object(a.useEuiTheme)(),d=Object(r.useMemo)((()=>({color:u.colors.darkShade})),[u.colors.darkShade]),p=s?void 0:"eui-textTruncate";return i.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},i.a.createElement(b,{grow:s},i.a.createElement(g,{$dataExists:t,$donutTextWrapperStyles:o,$isChartEmbeddablesEnabled:s,alignItems:"center",className:n,direction:"column",gutterSize:"none",justifyContent:"center"},i.a.createElement(a.EuiFlexItem,null,c),l&&i.a.createElement(a.EuiFlexItem,{className:p},i.a.createElement(a.EuiToolTip,{content:l},i.a.createElement(a.EuiText,{className:p,size:"s",style:t?void 0:d},l)))),e))},h=i.a.memo(y),v=({data:e,fillColor:t,height:n=90,label:l,legendItems:c,onPartitionClick:g,title:b,totalCount:y})=>{const{baseTheme:v,theme:E}=Object(d.h)(),x=Object(r.useCallback)((e=>{if(g){var t;const n=e.flat(2),a=n.length>0&&"groupByRollup"in n[0]&&null!=(null===(t=n[0])||void 0===t?void 0:t.groupByRollup)?`${n[0].groupByRollup}`:"";Object(s.isEmpty)(a.trim())||g(a.toLowerCase())}}),[g]);return i.a.createElement(h,{dataExists:null!=e&&e.length>0,label:l,title:b,isChartEmbeddablesEnabled:!1},i.a.createElement(i.a.Fragment,null,null==e||null==y||0===y?i.a.createElement(m.a,{size:n}):i.a.createElement(o.Chart,{size:n},i.a.createElement(o.Settings,{theme:[f,E],baseTheme:v,onElementClick:x,locale:u.i18n.getLocale()}),i.a.createElement(o.Partition,{id:"donut-chart",data:e,layout:o.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(o.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),c&&(null==c?void 0:c.length)>0&&i.a.createElement(a.EuiFlexItem,null,i.a.createElement(p.a,{legendItems:c,height:n}))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(119),r=n(2),i=n(652),o=n(43),s=n(323),l=n(324),c=n(653);function u(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var p=d(r),m=u(i).default,f=function(e){return"theme"!==e},g=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?m:f},b=function(e,t,n){var a;if(t){var r=t.shouldForwardProp;a=e.__emotion_forwardProp&&r?function(t){return e.__emotion_forwardProp(t)&&r(t)}:r}return"function"!=typeof a&&n&&(a=e.__emotion_forwardProp),a},y="undefined"!=typeof document,h=function(e){var t=e.cache,n=e.serialized,a=e.isStringTag;s.registerStyles(t,n,a);var r=c.useInsertionEffectAlwaysWithSyncFallback((function(){return s.insertStyles(t,n,a)}));if(!y&&void 0!==r){for(var i,o=n.name,l=n.next;void 0!==l;)o+=" "+l.name,l=l.next;return p.createElement("style",((i={})["data-emotion"]=t.key+" "+o,i.dangerouslySetInnerHTML={__html:r},i.nonce=t.sheet.nonce,i))}return null};t.default=function e(t,n){var r,i,c=t.__emotion_real===t,u=c&&t.__emotion_base||t;void 0!==n&&(r=n.label,i=n.target);var d=b(t,n,c),m=d||g(u),f=!m("as");return function(){var y=arguments,v=c&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==r&&v.push("label:"+r+";"),null==y[0]||void 0===y[0].raw)v.push.apply(v,y);else{v.push(y[0][0]);for(var E=y.length,x=1;x<E;x++)v.push(y[x],y[0][x])}var j=o.withEmotionCache((function(e,t,n){var a=f&&e.as||u,r="",c=[],b=e;if(null==e.theme){for(var y in b={},e)b[y]=e[y];b.theme=p.useContext(o.ThemeContext)}"string"==typeof e.className?r=s.getRegisteredStyles(t.registered,c,e.className):null!=e.className&&(r=e.className+" ");var E=l.serializeStyles(v.concat(c),t.registered,b);r+=t.key+"-"+E.name,void 0!==i&&(r+=" "+i);var x=f&&void 0===d?g(a):m,j={};for(var O in e)f&&"as"===O||x(O)&&(j[O]=e[O]);return j.className=r,j.ref=n,p.createElement(p.Fragment,null,p.createElement(h,{cache:t,serialized:E,isStringTag:"string"==typeof a}),p.createElement(a,j))}));return j.displayName=void 0!==r?r:"Styled("+("string"==typeof u?u:u.displayName||u.name||"Component")+")",j.defaultProps=t.defaultProps,j.__emotion_real=j,j.__emotion_base=u,j.__emotion_styles=v,j.__emotion_forwardProp=d,Object.defineProperty(j,"toString",{value:function(){return"."+i}}),j.withComponent=function(t,r){return e(t,a({},n,r,{shouldForwardProp:b(j,r,!0)})).apply(void 0,v)},j}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(187);const i=()=>{const{startTransaction:e}=Object(r.b)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),r=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==r||r.end()}}}),[e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(45),i=n(122),o=n(697);const s=()=>{const e=Object(r.useDispatch)(),t=Object(i.a)("securitySolutionNotesEnabled");return{onLoad:Object(a.useCallback)((n=>{if(!t||0===n.length)return;const a=n.map((e=>e._id)).filter((e=>null!=e));e(Object(o.e)({documentIds:a}))}),[e,t])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i}));let a=function(e){return e.DOCUMENT="document",e.BINARY="binary",e.BOOLEAN="boolean",e.CONFLICT="conflict",e.COUNTER="counter",e.DATE="date",e.DATE_RANGE="date_range",e.DENSE_VECTOR="dense_vector",e.GAUGE="gauge",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.HISTOGRAM="histogram",e.IP="ip",e.IP_RANGE="ip_range",e.FLATTENED="flattened",e.KEYWORD="keyword",e.MURMUR3="murmur3",e.NUMBER="number",e.NESTED="nested",e.RANK_FEATURE="rank_feature",e.RANK_FEATURES="rank_features",e.POINT="point",e.SHAPE="shape",e.SPARSE_VECTOR="sparse_vector",e.SEMANTIC_TEXT="semantic_text",e.STRING="string",e.TEXT="text",e.VERSION="version",e}({});const r=Object.values(a),i=e=>!!e&&r.includes(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(79),i=n(132),o=n(118);const s=({sourcererScope:e})=>{const{services:{fieldFormats:t}}=Object(o.j)(),{sourcererDataView:n}=Object(i.a)(e);return Object(a.useMemo)((()=>n?new r.DataView({spec:n,fieldFormats:t}):void 0),[n,t])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(2),r=n.n(a),i=n(446);const o=Object(i.c)(),s=Object(i.c)(),l=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},c=r.a.memo((()=>{const{portalNode:e}=l();return r.a.createElement(i.b,{node:e})}));c.displayName="TimelineEventsCountBadge";const u=()=>{const[e]=Object(a.useState)(s);return{portalNode:e}},d=r.a.memo((()=>{const{portalNode:e}=u();return r.a.createElement(i.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const a=new MutationObserver((()=>{const a=!!document.getElementById(e);a&&!t&&n(!0),!a&&t&&n(!1)}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[t,e]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),i=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),o=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(19);const l="#FAFBFD",c=o.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${l};\n    text-align: center;\n    line-height: ${e}px;`)),u=o.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(s.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?r.a.createElement(c,{size:e,"data-test-subj":"empty-donut"},r.a.createElement(u,{size:e-t,"data-test-subj":"empty-donut-small"})):null,p=r.a.memo(d)},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.osquery.action.shortEmptyTitle",{defaultMessage:"Osquery is not available"}),i=a.i18n.translate("xpack.securitySolution.osquery.action.permissionDenied",{defaultMessage:"Permission denied"}),o=a.i18n.translate("xpack.securitySolution.osquery.action.unavailable",{defaultMessage:"The Osquery Manager integration is not added to the agent policy. To run queries on the host, add the Osquery Manager integration to the agent policy in Fleet."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(233),l=n(1451);function c({type:e,label:t=e,"data-test-subj":n,...a}){return o.a.createElement(l.a,r()({},function(e){switch(e){case s.a._ID:case s.a._INDEX:return{type:"keyword"};case s.a.OBJECT:return{type:e,iconType:"tokenObject"};case s.a.DATE_NANOS:return{type:"date"};case s.a.FLOAT:case s.a.HALF_FLOAT:case s.a.SCALED_FLOAT:case s.a.DOUBLE:case s.a.INTEGER:case s.a.LONG:case s.a.SHORT:case s.a.UNSIGNED_LONG:case s.a.AGGREGATE_METRIC_DOUBLE:case s.a.FLOAT_RANGE:case s.a.DOUBLE_RANGE:case s.a.INTEGER_RANGE:case s.a.LONG_RANGE:case s.a.BYTE:case s.a.TOKEN_COUNT:return{type:"number"};default:return{type:e}}}(e),{label:t,"data-test-subj":n},a))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(1294),c=n.n(l);const u=s()(a.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroupStyles",componentId:"sc-rh40g1-0"})([".euiFlexItem{margin-bottom:0px;}"]),d=s()(a.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-rh40g1-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),p=s()(a.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-rh40g1-2"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),m=({threat:e,"data-test-subj":t="threat"})=>{const[o,s]=Object(r.useState)([]),[l,m]=Object(r.useState)([]),[f,g]=Object(r.useState)([]);return Object(r.useEffect)((()=>{!async function(){const e=await n.e(24).then(n.bind(null,1481));g(e.subtechniques),s(e.techniques),m(e.tactics)}()}),[]),i.a.createElement(u,{direction:"column","data-test-subj":t},e.map(((e,t)=>{const n=l.find((t=>t.id===e.tactic.id));return i.a.createElement(a.EuiFlexItem,{key:`${e.tactic.name}-${t}`},i.a.createElement(a.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=n?n.label:`${e.tactic.name} (${e.tactic.id})`),i.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var n;const r=o.find((t=>t.id===e.id));return i.a.createElement(a.EuiFlexItem,{key:null!==(n=null==r?void 0:r.id)&&void 0!==n?n:t},i.a.createElement(p,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=r?r.label:`${e.name} (${e.id})`),i.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var n;const a=f.find((t=>t.id===e.id));return i.a.createElement(d,{key:null!==(n=null==a?void 0:a.id)&&void 0!==n?n:t},i.a.createElement(p,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=a?a.label:`${e.name} (${e.id})`))}))))}))))})))}},,,,function(e,t,n){"use strict";n.d(t,"U",(function(){return r})),n.d(t,"n",(function(){return i})),n.d(t,"M",(function(){return o})),n.d(t,"p",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"bb",(function(){return u})),n.d(t,"N",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"db",(function(){return y})),n.d(t,"R",(function(){return h})),n.d(t,"cb",(function(){return v})),n.d(t,"P",(function(){return E})),n.d(t,"Q",(function(){return x})),n.d(t,"fb",(function(){return j})),n.d(t,"v",(function(){return O})),n.d(t,"S",(function(){return S})),n.d(t,"Y",(function(){return w})),n.d(t,"ab",(function(){return k})),n.d(t,"Z",(function(){return I})),n.d(t,"H",(function(){return T})),n.d(t,"I",(function(){return C})),n.d(t,"G",(function(){return M})),n.d(t,"K",(function(){return _})),n.d(t,"J",(function(){return D})),n.d(t,"F",(function(){return N})),n.d(t,"E",(function(){return A})),n.d(t,"O",(function(){return F})),n.d(t,"c",(function(){return P})),n.d(t,"L",(function(){return R})),n.d(t,"T",(function(){return L})),n.d(t,"d",(function(){return q})),n.d(t,"m",(function(){return z})),n.d(t,"o",(function(){return B})),n.d(t,"g",(function(){return $})),n.d(t,"f",(function(){return V})),n.d(t,"l",(function(){return U})),n.d(t,"j",(function(){return G})),n.d(t,"k",(function(){return H})),n.d(t,"h",(function(){return W})),n.d(t,"i",(function(){return Q})),n.d(t,"e",(function(){return Y})),n.d(t,"eb",(function(){return K})),n.d(t,"X",(function(){return Z})),n.d(t,"V",(function(){return X})),n.d(t,"W",(function(){return J})),n.d(t,"w",(function(){return ee})),n.d(t,"C",(function(){return te})),n.d(t,"A",(function(){return ne})),n.d(t,"z",(function(){return ae})),n.d(t,"B",(function(){return re})),n.d(t,"D",(function(){return ie})),n.d(t,"x",(function(){return oe})),n.d(t,"y",(function(){return se}));var a=n(4);a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"});const r=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.showingExceptionLists",{values:{totalLists:e},defaultMessage:"Showing {totalLists} {totalLists, plural, =1 {list} other {lists}}"}),i=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"})),o=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Shared Exception Lists"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableSubtitle",{defaultMessage:"To view rule specific exceptions navigate to that rule's details page."}),u=e=>a.i18n.translate("xpack.securitySolution.exceptions.allExceptionsRowPerPage",{defaultMessage:"Rows per page: {rowSize}",values:{rowSize:e}}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),p=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.export_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" exported successfully'}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),f=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.duplicate_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" duplicated successfully'}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.duplicateError",{defaultMessage:"Exception list duplication error"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),y=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),h=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),v=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDefaultDescription",{defaultMessage:"Are you sure you wish to DELETE exception list with the name {listName}?",values:{listName:e}}),E=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),x=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),j=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:e}}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.searchPlaceholder",{defaultMessage:"Search by name or list_id:id"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.refresh",{defaultMessage:"Refresh"}),w=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsImportButton",{defaultMessage:"Import list"}),k=a.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccessTitle",{defaultMessage:"Exception list imported"}),I=a.i18n.translate("xpack.securitySolution.lists.exceptionListUploadError",{defaultMessage:"There was an error uploading the exception list."}),T=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.importExceptionList",{defaultMessage:"Import exception list"}),C=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutHeader",{defaultMessage:"Import shared exception list"}),M=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutBody",{defaultMessage:"Select shared exception lists to import"}),_=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListWarning",{defaultMessage:"We found a pre-existing list with that id"}),D=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListOverwrite",{defaultMessage:"Overwrite the existing list"}),N=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListAsNewList",{defaultMessage:"Create new list"}),A=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionEndpointListWarning",{defaultMessage:"Multiple exception lists for Endpoint Security are not allowed."}),F=a.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"}),P=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsCloseImportFlyout",{defaultMessage:"Close"}),R=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsFilePickerPrompt",{defaultMessage:"Select or drag and drop multiple files"}),L=a.i18n.translate("xpack.securitySolution.exceptionsTable.rulesCountLabel",{defaultMessage:"Rules"}),q=a.i18n.translate("xpack.securitySolution.exceptionsTable.createdBy",{defaultMessage:"Created By"}),z=a.i18n.translate("xpack.securitySolution.exceptionsTable.createdAt",{defaultMessage:"Date created"}),B=a.i18n.translate("xpack.securitySolution.exceptionsTable.exceptionsCountLabel",{defaultMessage:"Exceptions"}),$=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createSharedListButton",{defaultMessage:"Create shared list"}),V=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createItemButton",{defaultMessage:"Create exception item"}),U=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListTitle",{defaultMessage:"Create shared exception list"}),G=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameField",{defaultMessage:"Shared exception list name"}),H=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameFieldPlaceholder",{defaultMessage:"New exception list"}),W=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescription",{defaultMessage:"Description (optional)"}),Q=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescriptionPlaceholder",{defaultMessage:"New exception list description"}),Y=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutCreateButton",{defaultMessage:"Create shared exception list"}),K=e=>a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessDescription",{defaultMessage:"List with name {listName} was created!",values:{listName:e}}),Z=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessTitle",{defaultMessage:"Created list"}),X=a.i18n.translate("xpack.securitySolution.exceptions.sortBy",{defaultMessage:"Sort by:"}),J=a.i18n.translate("xpack.securitySolution.exceptions.sortByCreateAt",{defaultMessage:"Created At"}),ee=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalCancelButton",{defaultMessage:"Cancel"}),te=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalExportTitle",{defaultMessage:"Export exception list?"}),ne=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalDuplicateTitle",{defaultMessage:"Duplicate exception list?"}),ae=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeDuplicateDescription",{defaultMessage:"You’re duplicating an exception list. Switch the toggle off to exclude expired exceptions."}),re=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeExportDescription",{defaultMessage:"You’re exporting an exception list. Switch the toggle off to exclude expired exceptions."}),ie=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeSwitchLabel",{defaultMessage:"Include expired exceptions"}),oe=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmDuplicateButton",{defaultMessage:"Duplicate"}),se=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmExportButton",{defaultMessage:"Export"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(19),o=n(43);const s={name:"qeawqx",styles:"max-height:300px;height:100%;overflow-x:hidden;overflow-y:auto"},l=({text:e,dataTestSubj:t,actions:n,disableActions:r,emptyButton:l,useCustomActions:c,iconType:u,iconSide:d="left",anchorPosition:p="downCenter",panelPaddingSize:m="s"})=>{const[f,g]=Object(a.useState)(!1),b=()=>g((e=>!e)),y=()=>g(!1),h=Object(a.useMemo)((()=>c||null===n?n:n.map((e=>Object(o.jsx)(i.EuiContextMenuItem,{"data-test-subj":`${t||""}ActionItem${e.key}`,key:e.key,icon:e.icon,disabled:e.disabled,layoutAlign:"center",onClick:t=>{y(),"function"==typeof e.onClick&&e.onClick(t)}},e.label)))),[n,t,c]);return Object(o.jsx)(i.EuiFlexGroup,{responsive:!0},Object(o.jsx)(i.EuiPopover,{button:l?Object(o.jsx)(i.EuiButtonEmpty,{isDisabled:r,onClick:b,iconType:u||void 0,iconSide:d,"data-test-subj":`${t||""}EmptyButton`,"aria-label":"Header menu Button Empty"},e):Object(o.jsx)(i.EuiButtonIcon,{isDisabled:r,onClick:b,iconType:u||"boxesHorizontal","data-test-subj":`${t||""}ButtonIcon`,"aria-label":"Header menu Button Icon"},e),onClick:e=>e.stopPropagation(),panelPaddingSize:m,isOpen:f,closePopover:y,anchorPosition:p,"data-test-subj":`${t||""}Items`},h?Object(o.jsx)(i.EuiContextMenuPanel,{css:s,className:"eui-scrollBar","data-test-subj":`${t||""}MenuPanel`,size:"s",items:h}):null))};l.displayName="HeaderMenuComponent";const c=r.a.memo(l);c.displayName="HeaderMenu"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(159);const i=({exceptionLists:e})=>{const[t,n]=Object(a.useState)(!0),[i,o]=Object(a.useState)([]),[s,l]=Object(a.useState)({}),c=Object(a.useCallback)((t=>{const n=e.reduce(((e,{id:t,...n})=>(e[t]={...n,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const n=t.exceptions_list;return null!=n&&n.length>0&&n.forEach((n=>{const a=e[n.id];null!=a&&(e[n.id]={...a,rules:[...a.rules,t]})})),e}),n)}),[e]);return Object(a.useEffect)((()=>{let t=!0;const a=new AbortController;return(async()=>{if(0===e.length&&t)return n(!1),o([]),void l({});try{n(!0);const{data:e}=await Object(r.j)({pagination:{page:1,perPage:1e4},signal:a.signal}),i=c(e),s=Object.keys(i).map((e=>i[e]));o(s),l(i),t&&n(!1)}catch(e){t&&n(!1)}})(),()=>{t=!1,a.abort()}}),[e.length,c]),[t,i,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(2),r=n.n(a),i=n(19),o=n(221);const s={DUPLICATE:"duplicate",EXPORT:"export"},l=Object(a.memo)((({handleCloseModal:e,onModalConfirm:t,action:n})=>{const[l,c]=Object(a.useState)(!0),u=Object(a.useCallback)((()=>{c(!l)}),[c,l]),d=Object(a.useCallback)((()=>{t(l),e()}),[l,e,t]);return r.a.createElement(i.EuiConfirmModal,{title:n===s.EXPORT?o.M:o.K,onCancel:e,onConfirm:d,cancelButtonText:o.G,confirmButtonText:n===s.EXPORT?o.I:o.H,defaultFocusedButton:"confirm","data-test-subj":"includeExpiredExceptionsConfirmationModal"},r.a.createElement(i.EuiText,null,n===s.EXPORT?o.L:o.J),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiSwitch,{label:o.N,checked:l,onChange:u,"data-test-subj":"includeExpiredExceptionsConfirmationModalSwitch"}))}));l.displayName="IncludeExpiredExceptionsModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(123),r=n(383),i=n(449);const o=(e,t)=>{const{addError:n}=Object(a.a)();return Object(r.a)(e,{onError:e=>n(e,{title:i.b}),...t})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(118),i=n(265);const o=(e=[])=>{const{getAppUrl:t}=Object(r.c)();return Object(a.useMemo)((()=>e.reduce(((e,n)=>{var a;const r=n.id,o=Object(i.j)(r);return e[r]={href:t({path:o}),children:null!==(a=n.name)&&void 0!==a?a:r,target:"_blank"},e}),{})),[t,e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(48),r=n(2),i=n(7),o=n(297);const s=()=>{const e=Object(a.useLocation)(),t=Object(a.useHistory)(),{toUrlParams:n,urlParams:s}=Object(o.a)();return Object(r.useCallback)(((a,r=!1)=>{t.push({...e,search:n(r?a:Object(i.pickBy)({...s,...a},(e=>void 0!==e)))})}),[s,t,e,n])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return N}));var a=n(19),r=n(49),i=n(44),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(161),d=n(875),p=n(209),m=n(313),f=n(137),g=n(118),b=n(130),y=n(351),h=n(367),v=n(181),E=n(340),x=n(144),j=n(314),O=n(201),S=n(862),w=n(196),k=n(736),I=n(334),T=n(226),C=n(521),M=n(357);const _=c()(a.EuiFlexGroup).withConfig({displayName:"UserRiskOverviewWrapper",componentId:"sc-1f042fn-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),D="riskInputsTabQuery",N=s.a.memo((({anomaliesData:e,contextID:t,scopeId:n,data:l,id:c,isDraggable:N=!1,isInDetailsSidePanel:A=!1,isLoadingAnomaliesData:F,loading:P,narrowDateRange:R,startDate:L,endDate:q,userName:z,indexPatterns:B,jobNameById:$})=>{const V=Object(O.a)(),U=Object(j.a)(V),G=Object(g.g)(),H=Object(o.useMemo)((()=>z?Object(f.A)([z]):void 0),[z]),{deleteQuery:W,setQuery:Q}=Object(u.a)(),{data:Y,isAuthorized:K,inspect:Z,loading:X,refetch:J}=Object(m.a)({filterQuery:H,skip:null==z,riskEntity:f.t.user,onlyLatest:!1,pagination:d.a});Object(p.b)({deleteQuery:W,inspect:Z,loading:X,queryId:D,refetch:J,setQuery:Q});const ee=Object(o.useCallback)(((e,a)=>s.a.createElement(y.a,{rowItems:Object(i.getOr)([],e,a),attrName:e,idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:N,scopeId:n})),[t,N,n]),[te,ne]=Object(o.useMemo)((()=>{const e=Y&&Y.length>0?Y[0]:void 0;return[{title:s.a.createElement(C.a,{title:k.k,riskScoreEntity:f.t.user}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.user.risk.calculated_score_norm):Object(b.d)())},{title:s.a.createElement(a.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(C.a,{title:k.j,riskScoreEntity:f.t.user})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(M.a,{anchorPosition:"upCenter"}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(T.a,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(b.d)())}]}),[Y]),ae=Object(o.useMemo)((()=>[{title:k.i,description:l&&l.user?ee("user.id",l):Object(b.d)()},{title:k.h,description:l&&l.user?ee("user.domain",l):Object(b.d)()}]),[l,ee]),re=Object(o.useMemo)((()=>U?[...ae,{title:k.g,description:s.a.createElement(S.a,{anomalies:e,startDate:L,endDate:q,isLoading:F,narrowDateRange:R,jobNameById:$})}]:ae),[e,ae,q,F,R,L,U,$]),ie=Object(o.useMemo)((()=>[re,[{title:k.a,description:s.a.createElement(h.a,{indexPatterns:B,field:"user.name",value:z,type:h.b.FIRST_SEEN})},{title:k.f,description:s.a.createElement(h.a,{indexPatterns:B,field:"user.name",value:z,type:h.b.LAST_SEEN})}],[{title:k.d,description:ee("host.os.name",l)},{title:k.b,description:ee("host.os.family",l)},{title:k.c,description:s.a.createElement(y.a,{rowItems:Object(i.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`user-overview-${t}`:"user-overview",scopeId:n,isDraggable:N,render:e=>null!=e?s.a.createElement(x.h,{ip:e}):Object(b.d)()})}]]),[l,B,ee,t,n,N,z,re]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.c,null,s.a.createElement(w.g,{direction:A?"column":"row","data-test-subj":"user-overview"},!A&&s.a.createElement(v.b,{queryId:c,title:k.e,inspectIndex:0}),ie.map(((e,t)=>s.a.createElement(I.a,{descriptionList:e,key:t}))),P&&s.a.createElement(E.a,{overlay:!0,overlayBackground:G?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))),K&&s.a.createElement(_,{gutterSize:A?"m":"none",direction:A?"column":"row","data-test-subj":"user-risk-overview",$width:A?"100%":"66.6%"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(w.d,{listItems:[te]})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(w.d,{listItems:[ne]}))))}));N.displayName="UserOverview"},function(e,t,n){e.exports=n(35)(1196)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return pe}));var a=n(44),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(19),c=n(46),u=n(1371),d=n(214);const p=c.intersection([c.exact(c.type({comment:u.a})),c.exact(c.partial({id:d.a}))]),m=c.array(p),f=(c.union([m,c[void 0]]),new c.Type("DefaultUpdateComments",m.is,((e,t)=>null==e?c.success([]):m.validate(e,t)),c.identity));var g=n(574),b=n(752),y=n(506),h=n(507),v=n(399),E=n(400),x=n(345),j=n(275),O=n(456),S=n(1284);const w=c.intersection([c.exact(c.type({description:v.a,entries:b.a,name:E.a,type:g.a})),c.exact(c.partial({_version:x.a,comments:f,expire_time:S.a,id:d.a,item_id:c.union([c.string,c[void 0]]),meta:j.a,namespace_type:O.a,os_types:y.c,tags:h.a}))]);var k=n(1334),I=n(1555),T=n(1561),C=n(54),M=n.n(C),_=n(165),D=n(878),N=n(4);const A=N.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.title",{defaultMessage:"Linked to shared list"}),F=N.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.error",{defaultMessage:"Unable to fetch exception list."});var P=n(354);const R=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1rq9jba-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),L=({isLoadingReferences:e,errorFetchingReferences:t,listAndReferences:n})=>{const[a,o]=Object(r.useState)(i.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemListsTableLoading"})),[s,c]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{t?c(F):e||o(void 0)}),[t,e]),i.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemLinkedToListSection"},i.a.createElement(R,{size:"xs"},i.a.createElement("h3",null,A)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{tableCaption:"Table of exception lists",itemId:"id",message:a,loading:e,items:n,error:s,columns:Object(P.d)(),sorting:!0,"data-test-subj":"exceptionItemSharedList"}))},q=i.a.memo(L);q.displayName="ExceptionsLinkedToLists";const z=N.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToRule.title",{defaultMessage:"Linked to rule"}),B=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-6bqv6k-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),$=({rule:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B,{size:"xs","data-test-subj":"exceptionItemLinkedToRuleSection"},i.a.createElement("h3",null,z)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{tableCaption:"Rules table",itemId:"id",items:[e],columns:Object(P.c)(),sorting:!0,"data-test-subj":"addExceptionToRulesTable"})),V=i.a.memo($);V.displayName="ExceptionsLinkedToRule";var U=n(871),G=n(879),H=n(840),W=n(872),Q=n(1230),Y=n(632);const K=N.i18n.translate("xpack.securitySolution.ruleExceptions.editException.cancel",{defaultMessage:"Cancel"}),Z=N.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editExceptionTitle",{defaultMessage:"Edit rule exception"}),X=N.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit endpoint exception"}),J=N.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception updated"}),ee=N.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastErrorTitle",{defaultMessage:"Error updating exception"});var te=n(123),ne=n(841),ae=n(353),re=n(880),ie=n(237),oe=n(487);const se=s()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-1j5dcqi-0"})(["",""],(({theme:e})=>Object(o.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),le=s()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-1j5dcqi-1"})(["",""],(()=>Object(o.css)(["&.builder-section{overflow-y:scroll;}"]))),ce=s()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-1j5dcqi-2"})(["",""],(({theme:e})=>Object(o.css)(["padding:",";"],e.eui.euiSizeS))),ue=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1j5dcqi-3"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),de=({list:e,itemToEdit:t,rule:n,showAlertCloseOptions:o,openedFromListDetailPage:s,onCancel:c,onConfirm:u})=>{var d;const p=Object(r.useMemo)((()=>t.os_types),[t]),m=Object(r.useMemo)((()=>null!=n?[n]:null),[n]),f=Object(r.useMemo)((()=>e.type),[e]),{isLoading:g,indexPatterns:b,getExtendedFields:y}=Object(H.a)(m),[h,v]=(()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(te.a)(),[a,i]=Object(ne.a)(),[o,s]=Object(r.useState)(!1),l=Object(r.useRef)(null);return Object(r.useEffect)((()=>{let n=!0;const a=new AbortController;return l.current=async({itemsToUpdate:a})=>{var r,o;if(null!=i)try{s(!0),await i(a),e({title:J,text:(r=a.map((({name:e})=>e)).join(", "),o=a.length,N.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessText",{values:{exceptionItemName:r,numItems:o},defaultMessage:"{numItems, plural, =1 {Exception} other {Exceptions}} - {exceptionItemName} - {numItems, plural, =1 {has} other {have}} been updated."}))}),n&&s(!1)}catch(e){if(n)throw s(!1),t(e,{title:ee}),new Error(e)}},()=>{n=!1,a.abort()}}),[e,t,n,i]),[o||a,l.current]})(),[E,x]=Object(W.a)(),[{exceptionItems:j,exceptionItemMeta:{name:O},newComment:S,commentErrorExists:C,bulkCloseAlerts:A,disableBulkClose:F,bulkCloseIndex:R,entryErrorExists:L,expireTime:z,expireErrorExists:B,wildcardWarningExists:$},de]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:n}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[n[0]]:n[1]}}}case"setComment":{const{comment:n}=t;return{...e,newComment:n}}case"setCommentError":{const{errorExists:n}=t;return{...e,commentErrorExists:n}}case"setBulkCloseAlerts":{const{bulkClose:n}=t;return{...e,bulkCloseAlerts:n}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:n}=t;return{...e,disableBulkClose:n}}case"setBulkCloseIndex":{const{bulkCloseIndex:n}=t;return{...e,bulkCloseIndex:n}}case"setExceptionItems":{const{items:n}=t;return{...e,exceptionItems:n}}case"setConditionValidationErrorExists":{const{errorExists:n}=t;return{...e,entryErrorExists:n}}case"setExpireTime":{const{expireTime:n}=t;return{...e,expireTime:n}}case"setExpireError":{const{errorExists:n}=t;return{...e,expireErrorExists:n}}case"setWildcardWithWrongOperator":{const{warningExists:n}=t;return{...e,wildcardWarningExists:n}}default:return e}}),{exceptionItems:[t],exceptionItemMeta:{name:t.name},newComment:"",commentErrorExists:!1,bulkCloseAlerts:!1,disableBulkClose:!0,bulkCloseIndex:void 0,entryErrorExists:!1,expireTime:void 0!==t.expire_time?M()(t.expire_time):void 0,expireErrorExists:!1,wildcardWarningExists:!1}),pe=Object(r.useMemo)((()=>null==n||!Object(_.b)(n.type)&&!Object(_.n)(n.type)&&!Object(_.f)(n.type)),[n]),[me,fe]=Object(r.useState)($),[ge,be,ye,he]=Object(Q.a)();Object(r.useEffect)((()=>{null!=he&&he([{id:e.id,listId:e.list_id,namespaceType:e.namespace_type}])}),[e,he]);const ve=Object(r.useCallback)((e=>{de({type:"setWildcardWithWrongOperator",warningExists:Object(I.g)(e)}),de({type:"setExceptionItems",items:e})}),[de]),Ee=Object(r.useCallback)((e=>{de({type:"setExceptionItemMeta",value:e})}),[de]),xe=Object(r.useCallback)((e=>{de({type:"setComment",comment:e})}),[de]),je=Object(r.useCallback)((e=>{de({type:"setCommentError",errorExists:e})}),[de]),Oe=Object(r.useCallback)((e=>{de({type:"setBulkCloseAlerts",bulkClose:e})}),[de]),Se=Object(r.useCallback)((e=>{de({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[de]),we=Object(r.useCallback)((e=>{de({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[de]),ke=Object(r.useCallback)((e=>{de({type:"setConditionValidationErrorExists",errorExists:e})}),[de]),Ie=Object(r.useCallback)((e=>{de({type:"setExpireTime",expireTime:e})}),[de]),Te=Object(r.useCallback)((e=>{de({type:"setExpireError",errorExists:e})}),[de]),Ce=Object(r.useCallback)((()=>{c(!1)}),[c]),Me=Object(r.useCallback)((e=>e.every((e=>w.is(e)))),[]),_e=Object(r.useCallback)((async()=>{if(null!=v)try{const r=Object(P.a)({itemName:O,commentToAdd:S,listType:f,selectedOs:t.os_types,expireTime:z,items:j});if(Me(r)){await v({itemsToUpdate:r});const t=null!=n?[n.rule_id]:[],i=null!=ye?ye[e.list_id].referenced_rules.map((({rule_id:e})=>e)):[],o=f===k.a.RULE_DEFAULT?t:i;null!=x&&!Object(a.isEmpty)(o)&&A&&await x(o,r,void 0,R),u(!0)}}catch(e){c(!1)}}),[v,O,S,f,t.os_types,j,Me,n,ye,e.list_id,x,A,u,R,c,z]),De=Object(r.useCallback)((()=>{if(!$)return _e();fe(!0)}),[$,_e]),Ne=Object(r.useMemo)((()=>f===k.a.ENDPOINT?X:Z),[f]),Ae=Object(r.useMemo)((()=>h||E||j.every((e=>0===e.entries.length))||g||L||B||C),[g,L,j,h,E,B,C]),Fe=Object(l.useGeneratedHtmlId)({prefix:"exceptionFlyoutTitle"}),Pe=Object(r.useMemo)((()=>{const{title:e,body:t,confirmButton:n,cancelButton:a}=Object(ie.a)(f===k.a.ENDPOINT?ae.c:ae.j);return i.a.createElement(oe.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:_e,onCancel:()=>fe(!1),"data-test-subj":"artifactConfirmModal"})}),[f,_e]);return i.a.createElement(l.EuiFlyout,{size:"l",onClose:Ce,"data-test-subj":"editExceptionFlyout","aria-labelledby":Fe},i.a.createElement(se,null,i.a.createElement(l.EuiTitle,null,i.a.createElement("h2",{id:Fe,"data-test-subj":"exceptionFlyoutTitle"},Ne)),i.a.createElement(l.EuiSpacer,{size:"m"})),i.a.createElement(le,{className:"builder-section"},g&&i.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingEditExceptionFlyout",lines:4}),i.a.createElement(D.a,{exceptionItemName:O,onChange:Ee}),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(G.a,{exceptionItemName:O,allowLargeValueLists:pe,exceptionListItems:[t],exceptionListType:f,indexPatterns:b,rules:m,selectedOs:p,showOsTypeOptions:f===k.a.ENDPOINT,isEdit:!0,onExceptionItemAdd:ve,onSetErrorExists:ke,getExtendedFields:y}),$&&i.a.createElement(T.a,null),!s&&f===k.a.DETECTION&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(q,{isLoadingReferences:ge,errorFetchingReferences:be,listAndReferences:null!=ye?[ye[e.list_id]]:[]})),!s&&f===k.a.RULE_DEFAULT&&null!=n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(V,{rule:n})),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(Y.a,{accordionTitle:i.a.createElement(ue,{size:"xs"},i.a.createElement("h3",null,(Re=null!==(d=t.comments.length)&&void 0!==d?d:0,N.i18n.translate("xpack.securitySolution.ruleExceptions.editExceptionFlyout.commentsTitle",{values:{comments:Re},defaultMessage:"Add comments ({comments})"})))),exceptionItemComments:t.comments,newCommentValue:S,newCommentOnChange:xe,setCommentError:je}),f!==k.a.ENDPOINT&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(re.a,{expireTime:z,setExpireTime:Ie,setExpireError:Te})),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(U.a,{exceptionListType:f,shouldBulkCloseAlert:A,disableBulkClose:F,exceptionListItems:j,onDisableBulkClose:Se,onUpdateBulkCloseIndex:we,onBulkCloseCheckboxChange:Oe}))),i.a.createElement(l.EuiFlyoutFooter,null,i.a.createElement(ce,{justifyContent:"spaceBetween"},i.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionEditButton",onClick:Ce},K),i.a.createElement(l.EuiButton,{"data-test-subj":"editExceptionConfirmButton",onClick:De,isDisabled:Ae,fill:!0},Ne))),me&&Pe);var Re},pe=i.a.memo(de);pe.displayName="EditExceptionFlyout"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n.n(a),i=n(19),o=n(165);const s=n(4).i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.TechnicalPreviewLabel",{defaultMessage:"Technical Preview"}),l=({label:e})=>r.a.createElement(r.a.Fragment,null,e,r.a.createElement(i.EuiBetaBadge,{label:s,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}));var c=n(208);const u=({label:e,ruleType:t})=>{const n=Object(c.b)("alert_suppression_rule_details");return r.a.createElement(r.a.Fragment,null,t&&Object(o.l)(t)?e:r.a.createElement(l,{label:e}),n&&r.a.createElement(i.EuiToolTip,{position:"top",content:n},r.a.createElement(i.EuiIcon,{type:"warning",size:"l",color:"#BD271E",style:{marginLeft:"8px"},"data-test-subj":"alertSuppressionInsufficientLicensingIcon"})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return B})),n.d(t,"b",(function(){return $}));var a=n(19),r=n(49),i=n(44),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(161),d=n(209),p=n(875),m=n(313),f=n(137),g=n(118),b=n(130),y=n(937),h=n(351),v=n(367),E=n(181),x=n(340),j=n(144),O=n(314),S=n(201),w=n(862),k=n(196),I=n(735),T=n(505),C=n(334),M=n(4);const _=M.i18n.translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Endpoint integration policy"}),D=M.i18n.translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Policy Status"}),N=M.i18n.translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Endpoint version"}),A=M.i18n.translate("xpack.securitySolution.host.details.endpoint.fleetAgentStatus",{defaultMessage:"Agent status"});var F=n(1322);const P=s.a.memo((({contextID:e,data:t,scopeId:n})=>{const r=Object(o.useCallback)(((t,a,r)=>s.a.createElement(h.a,{rowItems:[Object(i.getOr)("",t,a)],attrName:r,idPrefix:e?`endpoint-overview-${e}`:"endpoint-overview",scopeId:n})),[e,n]),l=Object(o.useMemo)((()=>{var e,n,i;const o=null==t||null===(e=t.hostInfo)||void 0===e?void 0:e.metadata.Endpoint.policy.applied;return[[{title:_,description:null!==(n=null==o?void 0:o.name)&&void 0!==n?n:Object(b.d)()}],[{title:D,description:null!=o&&o.status?s.a.createElement(a.EuiHealth,{"aria-label":null==o?void 0:o.status,color:(null==o?void 0:o.status)===F.a.failure?"danger":null==o?void 0:o.status},null==o?void 0:o.status):Object(b.d)()}],[{title:N,description:null!=t&&null!==(i=t.hostInfo)&&void 0!==i&&i.metadata.agent.version?r("hostInfo.metadata.agent.version",t,"agent.version"):Object(b.d)()}],[{title:A,description:null!=t&&t.hostInfo?s.a.createElement(T.a,{agentId:t.hostInfo.metadata.agent.id,agentType:"endpoint"}):Object(b.d)()}]]}),[t,r]);return s.a.createElement(s.a.Fragment,null,l.map(((e,t)=>s.a.createElement(C.a,{dataTestSubj:"endpoint-overview",descriptionList:e,key:t}))))}));P.displayName="EndpointOverview";var R=n(226),L=n(521),q=n(357);const z=c()(a.EuiFlexGroup).withConfig({displayName:"HostRiskOverviewWrapper",componentId:"sc-p9r0sg-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),B="riskInputsTabQuery",$=s.a.memo((({anomaliesData:e,contextID:t,scopeId:n,data:l,endDate:c,id:T,isDraggable:M=!1,isInDetailsSidePanel:_=!1,isLoadingAnomaliesData:D,indexNames:N,loading:A,narrowDateRange:F,startDate:$,hostName:V,jobNameById:U})=>{const G=Object(S.a)(),H=Object(O.a)(G),W=Object(g.g)(),Q=Object(o.useMemo)((()=>V?Object(f.z)([V]):void 0),[V]),{deleteQuery:Y,setQuery:K}=Object(u.a)(),{data:Z,isAuthorized:X,inspect:J,loading:ee,refetch:te}=Object(m.a)({filterQuery:Q,riskEntity:f.t.host,skip:null==V,onlyLatest:!1,pagination:p.a});Object(d.b)({deleteQuery:Y,inspect:J,loading:ee,queryId:B,refetch:te,setQuery:K});const ne=Object(o.useCallback)(((e,a)=>s.a.createElement(h.a,{rowItems:Object(i.getOr)([],e,a),attrName:e,idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:M,scopeId:n})),[t,M,n]),[ae,re]=Object(o.useMemo)((()=>{const e=Z&&Z.length>0?Z[0]:void 0;return[{title:s.a.createElement(L.a,{title:I.g,riskScoreEntity:f.t.host}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.host.risk.calculated_score_norm):Object(b.d)())},{title:s.a.createElement(a.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(L.a,{title:I.f,riskScoreEntity:f.t.host})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(q.a,{anchorPosition:"upCenter"}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(R.a,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(b.d)())}]}),[Z]),ie=Object(o.useMemo)((()=>[{title:I.e,description:l&&l.host?Object(y.c)({host:l.host,isDraggable:M,noLink:!0}):Object(b.d)()},{title:I.d,description:s.a.createElement(v.a,{indexPatterns:N,field:"host.name",value:V,type:v.b.FIRST_SEEN})},{title:I.k,description:s.a.createElement(v.a,{indexPatterns:N,field:"host.name",value:V,type:v.b.LAST_SEEN})}]),[l,N,V,M]),oe=Object(o.useMemo)((()=>H?[...ie,{title:I.n,description:s.a.createElement(w.a,{anomalies:e,startDate:$,endDate:c,isLoading:D,narrowDateRange:F,jobNameById:U})}]:ie),[e,ie,c,D,F,$,H,U]),se=Object(o.useMemo)((()=>[oe,[{title:I.j,description:s.a.createElement(h.a,{rowItems:Object(i.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`host-overview-${t}`:"host-overview",scopeId:n,isDraggable:M,render:e=>null!=e?s.a.createElement(j.h,{ip:e}):Object(b.d)()})},{title:I.m,description:ne("host.mac",l)},{title:I.p,description:ne("host.os.platform",l)}],[{title:I.o,description:ne("host.os.name",l)},{title:I.c,description:ne("host.os.family",l)},{title:I.r,description:ne("host.os.version",l)},{title:I.a,description:ne("host.architecture",l)}],[{title:I.b,description:ne("cloud.provider",l)},{title:I.q,description:ne("cloud.region",l)},{title:I.i,description:ne("cloud.instance.id",l)},{title:I.l,description:ne("cloud.machine.type",l)}]]),[t,n,l,oe,ne,M]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(E.c,null,s.a.createElement(k.g,{direction:_?"column":"row","data-test-subj":"host-overview"},!_&&s.a.createElement(E.b,{queryId:T,title:I.h,inspectIndex:0}),se.map(((e,t)=>s.a.createElement(C.a,{descriptionList:e,key:t}))),A&&s.a.createElement(x.a,{overlay:!0,overlayBackground:W?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))),X&&s.a.createElement(z,{gutterSize:_?"m":"none",direction:_?"column":"row","data-test-subj":"host-risk-overview",$width:_?"100%":"50%"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[ae]})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[re]}))),l&&null!=l.endpoint?s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiHorizontalRule,null),s.a.createElement(k.g,{direction:_?"column":"row"},s.a.createElement(P,{contextID:t,data:l.endpoint,scopeId:n}),A&&s.a.createElement(x.a,{overlay:!0,overlayBackground:W?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))):null)}));$.displayName="HostOverview"},function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return j}));var a=n(2),r=n.n(a),i=n(4),o=n(19),s=n(1213),l=n(297),c=n(845),u=n(126),d=n(783),p=n(587),m=n(118),f=n(259),g=n(843),b=n(140),y=n(451),h=n(361),v=n(487);const E=Object.freeze({flyoutEditTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditTitle",{defaultMessage:"Add artifact"}),flyoutCreateTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateTitle",{defaultMessage:"Create artifact"}),flyoutCancelButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),flyoutCreateSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add"}),flyoutEditSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitButtonLabel",{defaultMessage:"Save"}),flyoutDowngradedLicenseTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.expiredLicenseTitle",{defaultMessage:"Expired License"}),flyoutDowngradedLicenseInfo:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseInfo",{defaultMessage:"Your Kibana license has been downgraded. Future policy configurations will now be globally assigned to all policies."}),flyoutDowngradedLicenseDocsInfo:e=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseDocsInfo",{defaultMessage:"For more information, see our documentation."}),flyoutEditItemLoadFailure:e=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditItemLoadFailure",{defaultMessage:"Failed to retrieve item for edit. Reason: {errorMessage}",values:{errorMessage:e}}),flyoutCreateSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.some_page.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}})}),x=(e,t)=>({isValid:!1,item:null!=t?t:Object(f.a)(e)}),j=Object(a.memo)((({apiClient:e,item:t,policies:n,policiesIsLoading:i,FormComponent:f,onSuccess:j,onClose:O,submitHandler:S,labels:w={},"data-test-subj":k,size:I="m"})=>{var T,C;const{docLinks:{links:{securitySolution:M}}}=Object(m.j)().services,_=Object(u.a)(k),D=Object(m.n)(),N=Object(c.a)(),A=Object(d.a)(),{urlParams:F}=Object(l.a)(),P=Object(s.a)(),R=Object(a.useMemo)((()=>({...E,...w})),[w]),[L,q]=Object(a.useState)(!1),[z,B]=Object(a.useState)(void 0),[$,V]=Object(a.useState)(!1),U="edit"===F.show,G=U?"edit":"create",{isLoading:H,mutateAsync:W,error:Q}=Object(g.a)(e,G),Y=Object(a.useMemo)((()=>S?L:H),[L,H,S]),K=Object(a.useMemo)((()=>S?z:Q),[z,Q,S]),{isRefetching:Z,error:X,refetch:J}=Object(h.d)(e,null!==(T=F.itemId)&&void 0!==T?T:"",void 0,{enabled:!1}),[ee,te]=Object(a.useState)(x.bind(null,e.listId,t)),ne=((e,t)=>{const n=Object(b.a)().endpointPrivileges;return Object(a.useMemo)((()=>"edit"===t&&!n.canCreateArtifactsByPolicy&&Object(y.e)(e)),[n.canCreateArtifactsByPolicy,e,t])})({tags:null!==(C=ee.item.tags)&&void 0!==C?C:[]},G),ae=Object(a.useMemo)((()=>!!t||!!ee.item.item_id),[ee.item.item_id,t]),re=Object(a.useMemo)((()=>U&&!ae),[ae,U]),ie=Object(a.useCallback)((()=>{Y||(A({...F,itemId:void 0,show:void 0},!0),O())}),[Y,O,A,F]),oe=Object(a.useCallback)((({item:e,isValid:t,confirmModalLabels:n})=>{P()&&te({item:e,isValid:t,confirmModalLabels:n})}),[P]),se=Object(a.useCallback)((e=>{D.addSuccess(U?R.flyoutEditSubmitSuccess(e):R.flyoutCreateSubmitSuccess(e)),P()&&(A({...F,itemId:void 0,show:void 0},!0),j())}),[U,P,R,j,A,D,F]),le=Object(a.useCallback)((()=>{S?(q(!0),S(ee.item,G).then(se).catch((e=>{P()&&B(e)})).finally((()=>{P()&&q(!1)}))):ee.confirmModalLabels?V(!0):W(ee.item).then(se)}),[G,ee.item,ee.confirmModalLabels,se,P,W,S]),ce=Object(a.useCallback)((()=>W(ee.item).then(se)),[W,ee.item,se]),ue=Object(a.useMemo)((()=>{if(ee.confirmModalLabels){const{title:e,body:t,confirmButton:n,cancelButton:a}=ee.confirmModalLabels;return r.a.createElement(v.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:ce,onCancel:()=>V(!1),"data-test-subj":"artifactConfirmModal"})}}),[ee,ce]);Object(a.useEffect)((()=>{!U||ae||X||!re||Z||J().then((({data:t})=>{t&&P()&&te(x(e.listId,t))}))}),[e.listId,X,J,U,re,Z,ae,P]),Object(a.useEffect)((()=>{var e;U&&X&&(D.addWarning(R.flyoutEditItemLoadFailure((null==X||null===(e=X.body)||void 0===e?void 0:e.message)||X.message)),A({itemId:void 0,show:void 0}))}),[X,U,R,A,D,F.itemId]);const de=Object(o.useGeneratedHtmlId)({prefix:"artifactFlyoutTitle"});return!N||X?null:r.a.createElement(o.EuiFlyout,{size:I,onClose:ie,"data-test-subj":k,"aria-labelledby":de},r.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(o.EuiTitle,{size:"m"},r.a.createElement("h2",{id:de},U?R.flyoutEditTitle:R.flyoutCreateTitle))),!re&&ne&&r.a.createElement(o.EuiCallOut,{title:R.flyoutDowngradedLicenseTitle,color:"warning",iconType:"help","data-test-subj":_("expiredLicenseCallout")},R.flyoutDowngradedLicenseInfo," ",R.flyoutDowngradedLicenseDocsInfo(M)),r.a.createElement(o.EuiFlyoutBody,null,re&&r.a.createElement(p.a,{"data-test-subj":_("loader")}),!re&&r.a.createElement(f,{onChange:oe,disabled:Y,item:ee.item,error:null!=K?K:void 0,mode:G,policies:n,policiesIsLoading:i})),!re&&r.a.createElement(o.EuiFlyoutFooter,null,r.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":_("cancelButton"),onClick:ie,disabled:Y},R.flyoutCancelButtonLabel)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{"data-test-subj":_("submitButton"),fill:!0,disabled:!ee.isValid||Y,onClick:le,isLoading:Y},U?R.flyoutEditSubmitButtonLabel:R.flyoutCreateSubmitButtonLabel)))),$&&ue)}));j.displayName="ArtifactFlyout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4);a.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),a.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),a.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const r="siem"},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return y})),n(779),n(596),n(598),n(600);var a=n(599),r=(n(601),n(2)),i=n(1314),o=n(1491),s=n(7),l=n(245),c=n(270),u=n(5),d=n(118),p=n(627),m=n(884),f=n(221),g=n(588);const b={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},y=e=>{const t=Object(d.n)(),{services:n}=Object(d.j)(),{http:a,notifications:y}=n,{navigateToApp:h}=n.application,{exportExceptionList:v,deleteExceptionList:E,duplicateExceptionList:x}=Object(o.a)(a),[{loading:j,canUserCRUD:O,canUserREAD:S}]=Object(c.b)(),[w,k]=Object(r.useState)(),[I,T]=Object(r.useState)(!1),[C,M]=Object(r.useState)(),[_,D]=Object(r.useState)(!1),[N,A]=Object(r.useState)([]),[F,P]=Object(r.useState)([]),[R,L]=Object(r.useState)(!0),[q,z]=Object(r.useState)(""),[B,$]=Object(r.useState)(),[V,U]=Object(r.useState)(!1),[G,H]=Object(r.useState)(b),[W,Q]=Object(r.useState)(!0),[Y,K]=Object(r.useState)(!1),Z=Object(g.b)(),X=Object(r.useMemo)((()=>({pageId:u.Oc.exceptions,path:"",onNavigate:()=>{h(u.m,{deepLinkId:u.Oc.exceptions,path:""})}})),[h]),J=Object(r.useCallback)(((e,n,a,r)=>{null==t||t.addError(e,{title:null!=a?a:"",toastMessage:null!=r?r:""}),z(null!=n?n:"")}),[t]),ee=Object(r.useCallback)((async e=>{const t=await Object(p.e)(e.list_id);A(t)}),[]),te=Object(r.useCallback)((async()=>{try{if(l.a.includes(e))return D(!0);k(!0);const t=await Object(p.d)({id:e,http:a});if(!t||!Object(m.b)(t))return k(!1),D(!0);if(M(t),await ee(t),k(!1),D(!1),Object(m.a)(t))return L(!1)}catch(e){J(e,i.a.ERROR,f.q,f.p)}}),[e,a,ee,J]);Object(r.useEffect)((()=>{te()}),[te]);const[ne,ae]=Object(r.useState)(!1),re=Object(r.useCallback)((async t=>{try{var n;C&&await Object(p.i)({http:a,list:{id:C.id,list_id:e,type:C.type,name:t.name,description:null!==(n=t.description)&&void 0!==n?n:"",namespace_type:C.namespace_type}})}catch(e){J(e)}}),[e,J,a,C]),ie=Object(r.useCallback)((async e=>{try{if(!C)return;await v({id:C.id,listId:C.list_id,includeExpiredExceptions:e,namespaceType:C.namespace_type,onError:e=>J(e),onSuccess:e=>{$(e),null==t||t.addSuccess(f.C(C.name))}})}catch(e){J(e,void 0,f.r,f.s)}}),[C,v,J,t]),oe=Object(r.useCallback)((async e=>{try{if(!C)return;await x({listId:C.list_id,includeExpiredExceptions:e,namespaceType:C.namespace_type,onError:e=>J(e),onSuccess:e=>{null==t||t.addSuccess(f.v(C.name)),h(u.m,{deepLinkId:u.Oc.exceptions,path:`/details/${e.list_id}`})}})}catch(e){J(e,void 0,f.n,f.o)}}),[C,x,J,t,h]),se=Object(r.useCallback)((()=>{$(void 0)}),[]),le=Object(r.useCallback)((e=>()=>{y.toasts.addSuccess({title:f.ob(null!=e?e:G.listId)})}),[y.toasts,G.listId]),ce=Object(r.useCallback)((e=>{J(e)}),[J]),ue=Object(r.useCallback)((async()=>{try{if(!C)return;await E({id:C.id,namespaceType:C.namespace_type,onError:ce,onSuccess:le})}catch(e){J(e)}finally{H(b),U(!1),h(u.m,{deepLinkId:u.Oc.exceptions,path:""})}}),[C,E,ce,le,J,h]),de=Object(r.useCallback)((()=>{try{if(!C)return;H({contentText:N.length?f.qb(N.length):f.nb(C.name),rulesReferences:N.map((({name:e})=>e)),isLoading:!0,listId:C.list_id,listNamespaceType:C.namespace_type}),U(!0)}catch(e){J(e)}}),[J,N,C]),pe=Object(r.useCallback)((()=>{U(!1),H({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),me=Object(r.useCallback)((async()=>{try{await Object(p.h)({rules:N,listId:e}),ue()}catch(e){J(e)}}),[e,N,J,ue]),fe=Object(r.useCallback)((()=>{A(F),P(F),ae(!1),T(!1),Q(!0)}),[F]),ge=Object(r.useCallback)((()=>{ae(!0)}),[]),be=Object(r.useCallback)((()=>F.filter((e=>!N.includes(e)))),[N,F]),ye=Object(r.useCallback)((()=>N.filter((e=>!F.includes(e)))),[N,F]),he=Object(r.useCallback)((e=>{P(e),Q(!1)}),[]),ve=Object(r.useCallback)((async()=>{try{if(!C)return ae(!1);T(!0);const t=be(),n=ye();if(!t.length&&!n.length||Object(s.isEqual)(t,n))return fe();Promise.all([Object(p.h)({rules:n,listId:e}),Object(p.f)({rules:t,listId:e,id:C.id,listType:C.type,listNamespaceType:C.namespace_type})]).then((()=>{K(!0),fe()})).then((()=>K(!1))).then((()=>Z())).catch((e=>{J(e,void 0,f.E,f.F),T(!1)})).finally((()=>{te()}))}catch(e){J(e)}}),[C,be,ye,fe,e,Z,J,te]),Ee=Object(r.useCallback)((()=>{ae(!1)}),[]);return{isLoading:w||j,invalidListId:_,isReadOnly:!(O||!S),list:C,listName:null==C?void 0:C.name,listDescription:null==C?void 0:C.description,listId:e,canUserEditList:R,linkedRules:N,exportedList:B,handleOnDownload:se,viewerStatus:q,showManageRulesFlyout:ne,headerBackOptions:X,referenceModalState:G,showReferenceErrorModal:V,showManageButtonLoader:I,refreshExceptions:Y,disableManageButton:W,handleDelete:de,onDuplicateList:oe,onEditListDetails:re,onExportList:ie,onDeleteList:ue,onManageRules:ge,onSaveManageRules:ve,onCancelManageRules:Ee,onRuleSelectionChange:he,handleCloseReferenceErrorModal:pe,handleReferenceDelete:me}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(46),r=n(802),i=n(750),o=n(801),s=n(876),l=n(1371),c=n(403);const u=a.exact(a.type({field:l.a,operator:c.c,type:a.keyof({wildcard:null}),value:l.a}));var d=n(1282);const p=a.union([o.a,s.a,i.a,r.a,u]),m=a.array(a.union([o.a,s.a,i.a,r.a,d.a,u]));a.union([m,a[void 0]])},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.bind=t.bindTo=t.getRefinement=t.exists=t.elem=t.option=t.MonadThrow=t.Witherable=t.Traversable=t.Filterable=t.Compactable=t.Extend=t.Alternative=t.Alt=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getMonoid=t.getLastMonoid=t.getFirstMonoid=t.getApplyMonoid=t.getApplySemigroup=t.getOrd=t.getEq=t.getShow=t.URI=t.wilt=t.wither=t.sequence=t.traverse=t.partitionMap=t.partition=t.filterMap=t.filter=t.separate=t.compact=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.throwError=t.zero=t.alt=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.mapNullable=t.getOrElse=t.getOrElseW=t.toUndefined=t.toNullable=t.fold=t.fromEither=t.getRight=t.getLeft=t.tryCatch=t.fromPredicate=t.fromNullable=t.some=t.none=t.isNone=t.isSome=void 0;var a=n(269);function r(e){return null==e?t.none:t.some(e)}function i(e){return"Right"===e._tag?t.none:t.some(e.left)}function o(e){return"Left"===e._tag?t.none:t.some(e.right)}t.isSome=function(e){return"Some"===e._tag},t.isNone=function(e){return"None"===e._tag},t.none={_tag:"None"},t.some=function(e){return{_tag:"Some",value:e}},t.fromNullable=r,t.fromPredicate=function(e){return function(n){return e(n)?t.some(n):t.none}},t.tryCatch=function(e){try{return t.some(e())}catch(e){return t.none}},t.getLeft=i,t.getRight=o,t.fromEither=function(e){return"Left"===e._tag?t.none:t.some(e.right)},t.fold=function(e,n){return function(a){return t.isNone(a)?e():n(a.value)}},t.toNullable=function(e){return t.isNone(e)?null:e.value},t.toUndefined=function(e){return t.isNone(e)?void 0:e.value},t.getOrElseW=function(e){return function(n){return t.isNone(n)?e():n.value}},t.getOrElse=t.getOrElseW,t.mapNullable=function(e){return function(n){return t.isNone(n)?t.none:r(e(n.value))}};var s=function(e,n){return a.pipe(e,t.map(n))},l=function(e,n){return a.pipe(e,t.ap(n))},c=function(e,n){return a.pipe(e,t.chain(n))},u=function(e,n,r){return a.pipe(e,t.reduce(n,r))},d=function(e){var n=t.foldMap(e);return function(e,t){return a.pipe(e,n(t))}},p=function(e,n,r){return a.pipe(e,t.reduceRight(n,r))},m=function(e){var n=t.traverse(e);return function(e,t){return a.pipe(e,n(t))}},f=function(e,n){return a.pipe(e,t.alt(n))},g=function(e,n){return a.pipe(e,t.filter(n))},b=function(e,n){return a.pipe(e,t.filterMap(n))},y=function(e,n){return a.pipe(e,t.extend(n))},h=function(e,n){return a.pipe(e,t.partition(n))},v=function(e,n){return a.pipe(e,t.partitionMap(n))},E=function(e){var n=t.wither(e);return function(e,t){return a.pipe(e,n(t))}},x=function(e){var n=t.wilt(e);return function(e,t){return a.pipe(e,n(t))}};t.map=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n.value))}},t.ap=function(e){return function(n){return t.isNone(n)||t.isNone(e)?t.none:t.some(n.value(e.value))}},t.apFirst=function(e){return a.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return a.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=t.some,t.chain=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.chainFirst=function(e){return t.chain((function(n){return a.pipe(e(n),t.map((function(){return n})))}))},t.flatten=t.chain(a.identity),t.alt=function(e){return function(n){return t.isNone(n)?e():n}},t.zero=function(){return t.none},t.throwError=function(){return t.none},t.extend=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n))}},t.duplicate=t.extend(a.identity),t.reduce=function(e,n){return function(a){return t.isNone(a)?e:n(e,a.value)}},t.foldMap=function(e){return function(n){return function(a){return t.isNone(a)?e.empty:n(a.value)}}},t.reduceRight=function(e,n){return function(a){return t.isNone(a)?e:n(a.value,e)}},t.compact=t.flatten;var j={left:t.none,right:t.none};function O(e){return{equals:function(n,a){return n===a||(t.isNone(n)?t.isNone(a):!t.isNone(a)&&e.equals(n.value,a.value))}}}function S(e){return{concat:function(n,a){return t.isSome(n)&&t.isSome(a)?t.some(e.concat(n.value,a.value)):t.none}}}t.separate=function(e){var n=a.pipe(e,t.map((function(e){return{left:i(e),right:o(e)}})));return t.isNone(n)?j:n.value},t.filter=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)?n:t.none}},t.filterMap=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.partition=function(e){return function(n){return{left:a.pipe(n,t.filter((function(t){return!e(t)}))),right:a.pipe(n,t.filter(e))}}},t.partitionMap=function(e){return function(n){return t.separate(a.pipe(n,t.map(e)))}},t.traverse=function(e){return function(n){return function(a){return t.isNone(a)?e.of(t.none):e.map(n(a.value),t.some)}}},t.sequence=function(e){return function(n){return t.isNone(n)?e.of(t.none):e.map(n.value,t.some)}},t.wither=function(e){return function(n){return function(a){return t.isNone(a)?e.of(t.none):n(a.value)}}},t.wilt=function(e){return function(n){return function(r){var s=a.pipe(r,t.map((function(t){return e.map(n(t),(function(e){return{left:i(e),right:o(e)}}))})));return t.isNone(s)?e.of({left:t.none,right:t.none}):s.value}}},t.URI="Option",t.getShow=function(e){return{show:function(n){return t.isNone(n)?"none":"some("+e.show(n.value)+")"}}},t.getEq=O,t.getOrd=function(e){return{equals:O(e).equals,compare:function(n,a){return n===a?0:t.isSome(n)?t.isSome(a)?e.compare(n.value,a.value):1:-1}}},t.getApplySemigroup=S,t.getApplyMonoid=function(e){return{concat:S(e).concat,empty:t.some(e.empty)}},t.getFirstMonoid=function(){return{concat:function(e,n){return t.isNone(e)?n:e},empty:t.none}},t.getLastMonoid=function(){return{concat:function(e,n){return t.isNone(n)?e:n},empty:t.none}},t.getMonoid=function(e){return{concat:function(n,a){return t.isNone(n)?a:t.isNone(a)?n:t.some(e.concat(n.value,a.value))},empty:t.none}},t.Functor={URI:t.URI,map:s},t.Applicative={URI:t.URI,map:s,ap:l,of:t.of},t.Monad={URI:t.URI,map:s,ap:l,of:t.of,chain:c},t.Foldable={URI:t.URI,reduce:u,foldMap:d,reduceRight:p},t.Alt={URI:t.URI,map:s,alt:f},t.Alternative={URI:t.URI,map:s,ap:l,of:t.of,alt:f,zero:t.zero},t.Extend={URI:t.URI,map:s,extend:y},t.Compactable={URI:t.URI,compact:t.compact,separate:t.separate},t.Filterable={URI:t.URI,map:s,compact:t.compact,separate:t.separate,filter:g,filterMap:b,partition:h,partitionMap:v},t.Traversable={URI:t.URI,map:s,reduce:u,foldMap:d,reduceRight:p,traverse:m,sequence:t.sequence},t.Witherable={URI:t.URI,map:s,reduce:u,foldMap:d,reduceRight:p,traverse:m,sequence:t.sequence,compact:t.compact,separate:t.separate,filter:g,filterMap:b,partition:h,partitionMap:v,wither:E,wilt:x},t.MonadThrow={URI:t.URI,map:s,ap:l,of:t.of,chain:c,throwError:t.throwError},t.option={URI:t.URI,map:s,of:t.of,ap:l,chain:c,reduce:u,foldMap:d,reduceRight:p,traverse:m,sequence:t.sequence,zero:t.zero,alt:f,extend:y,compact:t.compact,separate:t.separate,filter:g,filterMap:b,partition:h,partitionMap:v,wither:E,wilt:x,throwError:t.throwError},t.elem=function(e){return function(n,a){return!t.isNone(a)&&e.equals(n,a.value)}},t.exists=function(e){return function(n){return!t.isNone(n)&&e(n.value)}},t.getRefinement=function(e){return function(n){return t.isSome(e(n))}},t.bindTo=function(e){return t.map(a.bindTo_(e))},t.bind=function(e,n){return t.chain((function(r){return a.pipe(n(r),t.map((function(t){return a.bind_(r,e,t)})))}))},t.apS=function(e,n){return a.flow(t.map((function(t){return function(n){return a.bind_(t,e,n)}})),t.ap(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(46),r=n(2070),i=n(345),o=n(456),s=n(275),l=n(400),c=n(397),u=n(398),d=n(214),p=n(457),m=n(800),f=n(401),g=n(402),b=n(255),y=n(399),h=n(506),v=n(1334),E=n(507);const x=a.exact(a.type({_version:i.b,created_at:c.a,created_by:u.a,description:y.a,id:d.a,immutable:m.a,list_id:b.a,meta:s.b,name:l.a,namespace_type:o.a,os_types:h.b,tags:E.a,tie_breaker_id:p.a,type:v.b,updated_at:f.a,updated_by:g.a,version:r.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=a.boolean;a.union([r,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),r=n(1371),i=n(403);const o=a.exact(a.type({field:r.a,operator:i.c,type:a.keyof({match:null}),value:r.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),r=n(1371),i=n(403);const o=a.exact(a.type({field:r.a,operator:i.c,type:a.keyof({exists:null})}))},,,function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,n){"use strict";var a="%[a-f0-9]{2}",r=new RegExp("("+a+")|([^%]+?)","gi"),i=new RegExp("("+a+")+","gi");function o(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],o(n),o(a))}function s(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(r)||[],n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=i.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var a=s(n[0]);a!==n[0]&&(t[n[0]]=a)}n=i.exec(e)}t["%C2"]="�";for(var r=Object.keys(t),o=0;o<r.length;o++){var l=r[o];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(462));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=i.default(e,t),o=a[0],s=a[1],l=a[2];return r.useEffect(l,n),[o,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(154),i=a.__importDefault(n(461));t.default=function(e,t){i.default(e,t,r.isDeepEqual)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154);t.default=function(e,t,n){if(!r.isClient)return[t,function(){}];var i=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,n?String(t):JSON.stringify(t)),t):n?a:JSON.parse(a||"null")}catch(e){return t}})),o=i[0],s=i[1];return a.useEffect((function(){try{var t=n?String(o):JSON.stringify(o);sessionStorage.setItem(e,t)}catch(e){}})),[o,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(273),r=n(1275),i=n(26);const o=`${i.c}: true`,s=`${i.c}: false`,l=`${i.a}: true`,c=`${i.a}: false`;function u({filter:e,showCustomRules:t,showElasticRules:n,enabled:u,tags:p,excludeRuleTypes:m=[],ruleExecutionStatus:f}){const g=[];var b;return null!=e&&e.length&&g.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(r.b)(e)}`)).join(" OR ")}(e)})`),t&&n||(n?g.push(o):t&&g.push(s)),void 0!==u&&g.push(u?l:c),null!=p&&p.length&&g.push(function(e){return`${i.g}:(${e.map(r.b).join(" AND ")})`}(p)),m.length&&g.push("NOT "+(b=m,`${i.d}: (${b.map(r.b).join(" OR ")})`)),f===a.f.succeeded?g.push(`${i.b}: "succeeded"`):f===a.f["partial failure"]?g.push(`${i.b}: "warning"`):f===a.f.failed&&g.push(`${i.b}: "failed"`),g.join(" AND ")}const d=[i.e,i.f.INDEX,i.f.TACTIC_ID,i.f.TACTIC_NAME,i.f.TECHNIQUE_ID,i.f.TECHNIQUE_NAME,i.f.SUBTECHNIQUE_ID,i.f.SUBTECHNIQUE_NAME]},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return E})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return j})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return S})),n.d(t,"r",(function(){return w})),n.d(t,"s",(function(){return k})),n.d(t,"t",(function(){return N})),n.d(t,"u",(function(){return D})),n.d(t,"v",(function(){return C})),n.d(t,"w",(function(){return _})),n.d(t,"x",(function(){return T})),n.d(t,"y",(function(){return M})),n.d(t,"z",(function(){return A})),n.d(t,"A",(function(){return F})),n.d(t,"C",(function(){return P})),n.d(t,"B",(function(){return R})),n.d(t,"D",(function(){return r})),n.d(t,"E",(function(){return i})),n.d(t,"F",(function(){return o})),n.d(t,"G",(function(){return s}));var a=n(748);const r="ecs.version",i="event.action",o="event.kind",s="tags",l=`${a.k}.risk_score`,c=`${a.s}.author`,u=`${a.s}.created_at`,d=`${a.s}.created_by`,p=`${a.s}.description`,m=`${a.s}.enabled`,f=`${a.s}.from`,g=`${a.s}.interval`,b=`${a.s}.license`,y=`${a.s}.note`,h=`${a.s}.references`,v=`${a.s}.rule_id`,E=`${a.s}.rule_name_override`,x=`${a.s}.to`,j=`${a.s}.type`,O=`${a.s}.updated_at`,S=`${a.s}.updated_by`,w=`${a.s}.version`,k=`${a.k}.severity`,I=`${a.k}.suppression`,T=`${I}.terms`,C=`${T}.field`,M=`${T}.value`,_=`${I}.start`,D=`${I}.end`,N=`${I}.docs_count`,A=`${a.k}.system_status`,F=`${a.k}.workflow_reason`,P=`${a.k}.workflow_user`,R=`${a.k}.workflow_status_updated_at`},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(45),i=n(166);const o=e=>{const t=Object(r.useSelector)(i.d.kibanaDataViews),n=Object(r.useSelector)((t=>i.d.sourcererScopeSelectedDataViewId(t,e))),o=Object(a.useMemo)((()=>t.find((e=>e.id===n))),[t,n]);return Object(a.useCallback)((e=>{const t=null==o?void 0:o.fields;return t&&t[e]}),[null==o?void 0:o.fields])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(19),r=n(2),i=n.n(r),o=n(163),s=n(951);const l=i.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:r})=>i.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},i.a.createElement(s.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:r,title:null!=t?t:o.G}))));l.displayName="OpenTimelineModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"c",(function(){return $})),n.d(t,"b",(function(){return V}));var a=n(44),r=n(54),i=n.n(r),o=n(63),s=n.n(o),l=n(53),c=n(4),u=n(813),d=n(748),p=n(3),m=n(572),f=n(165),g=n(146),b=n(121),y=n(1246),h=n(158),v=n(184),E=n(250),x=n(131),j=n(718),O=n(292),S=n(118),w=n(5),k=n(1253),I=n(396);n(479);const T=({ecs:e})=>{if(Array.isArray(e)){const t=e.reduce(((e,t)=>{const n=t.timestamp?new Date(t.timestamp):new Date;return e.includes(n.valueOf())?e:[...e,n.valueOf()]}),[]);return{from:new Date(Math.min(...t)).toISOString(),to:new Date(Math.max(...t)).toISOString()}}const t=e,n=Object(x.getField)(t,u.g),a=i.a.duration(i()().diff(s.a.parse(null!=n?n[0]:"now-1d"))),r=Object(x.getField)(t,d.K),o=Array.isArray(r)?r[0]:r,l=i()(null!=o?o:new Date).toISOString();return{to:l,from:i()(l).subtract(a).toISOString()}},C=e=>{const t=Object(x.getField)(e,u.o);return Array.isArray(t)?t[0]:t},M=e=>Object(f.f)(C(e)),_=e=>Object(f.d)(C(e)),D=e=>Object(f.b)(C(e)),N=e=>Object(f.n)(C(e)),A=e=>Object(f.e)(C(e)),F=e=>null!=Object(x.getField)(e,u.t),P=(e,t,n="Alert Ids")=>1===t.length?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:e,params:{query:t[0]}},query:{match_phrase:{_id:t[0]}},$state:{store:l.FilterStateStore.APP_STATE}}]:[{query:{bool:{filter:{ids:{values:t}}}},meta:{alias:n,negate:!1,disabled:!1,type:"phrases",key:e,value:t.join(),params:t},$state:{store:l.FilterStateStore.APP_STATE}}],R=(e,t)=>{const n=1===t.length;return[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-alert-id-${t.join(",")}`,name:t.join(","),enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:n?t[0]:t,operator:n?":":"includes"}}]},L=(e,t,n)=>({filters:"KqlFilter"===t?P("_id",e,n):[],dataProviders:"dataProvider"===t?R("_id",e):[]}),q=async(e,t,n,a,r)=>{try{var o,l,p,f,b,y,v,E,j,O,T,C,M,_,D,N,A,F,P,R,L,q;const c=await S.b.get().http.fetch(w.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),I=(null!==(o=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==o?o:[])[0],z=Object(x.getField)(I,d.t),B=Object(x.getField)(I,u.d),$=(null!==(l=null!==(p=z.filters)&&void 0!==p?p:null===(f=I.signal)||void 0===f||null===(b=f.rule)||void 0===b?void 0:b.filters)&&void 0!==l?l:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),V=null!==(y=null!==(v=z.language)&&void 0!==v?v:null===(E=I.signal)||void 0===E||null===(j=E.rule)||void 0===j?void 0:j.language)&&void 0!==y?y:"kuery",U=null!==(O=null!==(T=z.query)&&void 0!==T?T:null===(C=I.signal)||void 0===C||null===(M=C.rule)||void 0===M?void 0:M.query)&&void 0!==O?O:"",G=null!==(_=null!==(D=Object(x.getField)(I,m.h))&&void 0!==D?D:null===(N=I.signal)||void 0===N||null===(A=N.rule)||void 0===A?void 0:A.index)&&void 0!==_?_:[],{thresholdFrom:H,thresholdTo:W,dataProviders:Q}=(e=>(Array.isArray(e)?e:[e]).reduce(((e,t)=>{var n,a,r,o;const l=null!==(n=Object(x.getField)(t,`${d.t}.threshold`))&&void 0!==n?n:null===(a=t.signal)||void 0===a||null===(r=a.rule)||void 0===r?void 0:r.threshold,c=Object(x.getField)(t,m.j),p=Object(x.getField)(t,m.g),f=Array.isArray(p)?p[0]:p,b=i()(f),y=((e,t)=>{const n=Object(x.getField)(e,u.g),a=Array.isArray(n)?n[0]:n,r=s.a.parse(a),o=i()(),l=i.a.duration(o.diff(r));return t.clone().subtract(l)})(t,b),h=Array.isArray(l.field)?l.field:[l.field];return{thresholdFrom:null!==(o=c.from)&&void 0!==o?o:y.toISOString(),thresholdTo:b.toISOString(),dataProviders:[...e.dataProviders,...h.reduce(((e,t,n)=>{const a=c.terms.filter((e=>e.field===t))[0].value,r=Array.isArray(a)?a[0]:a;if(!r)return e;const i=t.replace(".","-"),o={id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-${i}-${r}`,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:r,operator:":"}};return 0===n?[...e,{...o,and:[]}]:(e[0].and.push(o),e)}),[])]}}),{dataProviders:[],thresholdFrom:"",thresholdTo:""}))(I),Y=await r(e),K=(null!==(F=a.filters)&&void 0!==F?F:$).concat(Y?[Y]:[]);return t({from:H,notes:null,timeline:{...h.b,excludedRowRendererIds:[],columns:null!==(P=a.columns)&&void 0!==P?P:h.b.columns,description:`_id: ${I._id}`,filters:K,dataProviders:null!==(R=a.dataProviders)&&void 0!==R?R:Q,id:g.c.active,indexNames:G,dateRange:{start:H,end:W},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:V,expression:null!==(L=a.query)&&void 0!==L?L:U},serializedQuery:null!==(q=a.query)&&void 0!==q?q:U}}},to:W,ruleNote:n,ruleAuthor:B})}catch(n){const{toasts:a}=S.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailureTitle",{defaultMessage:"Failed to create threshold alert timeline"})});const r=I.a.toISOString(),i=I.b.toISOString();return t({from:r,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:r,end:i},eventType:"all"},to:i})}},z=async(e,t,n,a,r)=>{try{var o,s,l,u,p,f,b,y,v,E,j,O,T,C,M,_,D,N,A,F,P,R;const c=await S.b.get().http.fetch(w.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),I=(null!==(o=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==o?o:[])[0],L=Object(x.getField)(I,d.t),q=(null!==(s=null!==(l=L.filters)&&void 0!==l?l:null===(u=I.signal)||void 0===u||null===(p=u.rule)||void 0===p?void 0:p.filters)&&void 0!==s?s:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),z=null!==(f=null!==(b=L.language)&&void 0!==b?b:null===(y=I.signal)||void 0===y||null===(v=y.rule)||void 0===v?void 0:v.language)&&void 0!==f?f:"kuery",B=null!==(E=null!==(j=L.query)&&void 0!==j?j:null===(O=I.signal)||void 0===O||null===(T=O.rule)||void 0===T?void 0:T.query)&&void 0!==E?E:"",$=null!==(C=null!==(M=Object(x.getField)(I,m.h))&&void 0!==M?M:null===(_=I.signal)||void 0===_||null===(D=_.rule)||void 0===D?void 0:D.index)&&void 0!==C?C:[],{from:V,to:U,dataProviders:G}=(e=>{var t;const n=Array.isArray(e)?e[0]:e,a=Object(x.getField)(n,m.g),r=(null!==(t=Object(x.getField)(n,`${d.t}.new_terms_fields`))&&void 0!==t?t:[]).map(((e,t)=>{const a=e.replace(".","-"),r=Object(x.getField)(n,m.d)[t];return{id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-${a}-${r}`,name:e,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:r,operator:":"},and:[]}})),o=r.length?[{...r[0],and:r.slice(1)}]:[];return{from:a,to:i()().toISOString(),dataProviders:o}})(I),H=await r(e),W=(null!==(N=a.filters)&&void 0!==N?N:q).concat(H?[H]:[]);return t({from:V,notes:null,timeline:{...h.b,columns:null!==(A=a.columns)&&void 0!==A?A:h.b.columns,excludedRowRendererIds:[],description:`_id: ${I._id}`,filters:W,dataProviders:null!==(F=a.dataProviders)&&void 0!==F?F:G,id:g.c.active,indexNames:$,dateRange:{start:V,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:z,expression:null!==(P=a.query)&&void 0!==P?P:B},serializedQuery:null!==(R=a.query)&&void 0!==R?R:B}}},to:U,ruleNote:n})}catch(n){const{toasts:a}=S.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailureTitle",{defaultMessage:"Failed to create new terms alert timeline"})});const r=I.a.toISOString(),i=I.b.toISOString();return t({from:r,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:r,end:i},eventType:"all"},to:i})}},B=async(e,t,n,a,r)=>{try{var i,o,s,l,p,f,b,y,v,E,j,O,T,C,M,_,D,N,A,F,P,R;const c=await S.b.get().http.fetch(w.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),I=(null!==(i=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==i?i:[])[0],L=Object(x.getField)(I,d.t),q=(null!==(o=null!==(s=L.filters)&&void 0!==s?s:null===(l=I.signal)||void 0===l||null===(p=l.rule)||void 0===p?void 0:p.filters)&&void 0!==o?o:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),z=null!==(f=null!==(b=L.language)&&void 0!==b?b:null===(y=I.signal)||void 0===y||null===(v=y.rule)||void 0===v?void 0:v.language)&&void 0!==f?f:"kuery",B=null!==(E=null!==(j=L.query)&&void 0!==j?j:null===(O=I.signal)||void 0===O||null===(T=O.rule)||void 0===T?void 0:T.query)&&void 0!==E?E:"",$=null!==(C=null!==(M=Object(x.getField)(I,m.h))&&void 0!==M?M:null===(_=I.signal)||void 0===_||null===(D=_.rule)||void 0===D?void 0:D.index)&&void 0!==C?C:[],{from:V,to:U,dataProviders:G}=(e=>{const t=Array.isArray(e)?e[0]:e,n=Object(x.getField)(t,u.w),a=Object(x.getField)(t,u.u),r=Object(x.getField)(t,u.x).map((e=>{const t=e.field.replace(".","-"),n=`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-${t}-${e.value}`;return null==e.value?{id:n,name:t,enabled:!0,excluded:!0,kqlQuery:"",queryMatch:{field:e.field,value:"",operator:":*"}}:{id:n,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e.field,value:e.value,operator:":"}}}));return{from:n,to:a,dataProviders:[{...r[0],and:r.slice(1)}]}})(I),H=await r(e),W=(null!==(N=a.filters)&&void 0!==N?N:q).concat(H?[H]:[]);return t({from:V,notes:null,timeline:{...h.b,excludedRowRendererIds:[],columns:null!==(A=a.columns)&&void 0!==A?A:h.b.columns,description:`_id: ${I._id}`,filters:W,dataProviders:null!==(F=a.dataProviders)&&void 0!==F?F:G,id:g.c.active,indexNames:$,dateRange:{start:V,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:z,expression:null!==(P=a.query)&&void 0!==P?P:B},serializedQuery:null!==(R=a.query)&&void 0!==R?R:B}}},to:U,ruleNote:n})}catch(n){const{toasts:a}=S.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailureTitle",{defaultMessage:"Failed to create suppressed alert timeline"})});const r=I.a.toISOString(),i=I.b.toISOString();return t({from:r,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:r,end:i},eventType:"all"},to:i})}},$=async(e,t,n="dataProvider",a)=>{const r=Array.isArray(t)?t.map((e=>e._id)):[],{to:i,from:o}=T({ecs:t}),{dataProviders:s,filters:l}=L(r,n,a||`${t.length} event IDs`);await e({from:o,notes:null,timeline:{...h.b,excludedRowRendererIds:[],dataProviders:s,id:g.c.active,indexNames:[],dateRange:{start:o,end:i},eventType:"all",filters:l,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:i})},V=async({createTimeline:e,ecsData:t,updateTimelineIsLoading:n,searchStrategyClient:r,getExceptionFilter:i})=>{const o=Array.isArray(t)?t[0]:t,s=Object(x.getField)(o,u.j),l=Object(x.getField)(o,u.d),c=Array.isArray(s)&&s.length>0?s[0]:"",d=Object(x.getField)(o,m.i),f=Object(a.isEmpty)(d)?"":Array.isArray(d)?d[0]:d,{to:S,from:w}=T({ecs:t});if(Object(a.isEmpty)(f)){if(N(o))return q(o,e,c,{},i);if(M(o))return z(o,e,c,{},i);if(!F(o)||D(o)||_(o)||A(o)){let{dataProviders:n,filters:r}=L([o._id],"dataProvider");if((e=>{const t=Object(x.getField)(e,u.o),n=Object(x.getField)(e,m.a);return("eql"===t||Array.isArray(t)&&"eql"===t[0])&&(null==n?void 0:n.length)>0})(o)){const e=((e,t)=>{if(!Object(a.isEmpty)(e)&&Array.isArray(t)&&t.length>1)return{dataProviders:[],filters:P(m.a,t.reduce(((e,t)=>{const n=Object(x.getField)(t,m.a),a=Array.isArray(n)?n[0]:n;return e.includes(a)?e:[...e,a]}),[]))};if(!Array.isArray(t)||1===t.length){const e=Array.isArray(t)?t[0]:t,n=Object(x.getField)(e,m.a),a=Object(x.getFieldKey)(e,m.a),r=Array.isArray(n)?n[0]:n;return{dataProviders:[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-alert-id-${r}`,name:e._id,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:a,value:r,operator:":"}}],filters:[]}}return{filters:[],dataProviders:[]}})([o._id],t);n=e.dataProviders,r=e.filters}return e({from:w,notes:null,timeline:{...h.b,excludedRowRendererIds:[],dataProviders:n,id:g.c.active,indexNames:[],dateRange:{start:w,end:S},eventType:"all",filters:r,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:S,ruleNote:c,ruleAuthor:l})}return B(o,e,c,{},i)}try{var k,I;n({id:g.c.active,isLoading:!0});const[t,s]=await Promise.all([Object(O.e)(f),Object(p.lastValueFrom)(r.search({defaultIndex:[],indexName:null!==(k=o._index)&&void 0!==k?k:"",eventId:o._id,factoryQueryType:y.c.details},{strategy:"timelineSearchStrategy"}))]),u=Object(a.getOr)({},"data.getOneTimeline",t),d=null!==(I=s.data)&&void 0!==I?I:[];if(!Object(a.isEmpty)(u)){var C,R,$,V,U,G,H;const t=Object(v.f)(u),{timeline:n,notes:a}=Object(v.b)(t,!0,null!==(C=t.timelineType)&&void 0!==C?C:b.m.default),r=Object(j.d)(null!==(R=null===($=n.kqlQuery)||void 0===$||null===(V=$.filterQuery)||void 0===V||null===(U=V.kuery)||void 0===U?void 0:U.expression)&&void 0!==R?R:"",d,n.timelineType),s=Object(j.c)(null!==(G=n.filters)&&void 0!==G?G:[],d),p=Object(j.b)(null!==(H=n.dataProviders)&&void 0!==H?H:[],d,n.timelineType);return N(o)?q(o,e,c,{filters:s,query:r,dataProviders:p,columns:n.columns},i):M(o)?z(o,e,c,{filters:s,query:r,dataProviders:p,columns:n.columns},i):!F(o)||D(o)||_(o)||A(o)?e({from:w,timeline:{...n,excludedRowRendererIds:[],title:"",timelineType:b.m.default,templateTimelineId:null,status:b.l.draft,dataProviders:p,eventType:"all",filters:s,dateRange:{start:w,end:S},kqlQuery:{filterQuery:{kuery:{kind:null!==(W=null===(Q=n.kqlQuery)||void 0===Q||null===(Y=Q.filterQuery)||void 0===Y||null===(K=Y.kuery)||void 0===K?void 0:K.kind)&&void 0!==W?W:"kuery",expression:r},serializedQuery:Object(E.f)(r)}},noteIds:null!==(Z=null==a?void 0:a.map((e=>e.noteId)))&&void 0!==Z?Z:[],show:!0},to:S,ruleNote:c,ruleAuthor:l,notes:null!=a?a:null}):B(o,e,c,{filters:s,query:r,dataProviders:p,columns:n.columns},i);var W,Q,Y,K,Z}}catch{return n({id:g.c.active,isLoading:!1}),e({from:w,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:w,end:S},eventType:"all"},to:S})}}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var a=n(269),r=n(1342);const i=e=>Object(a.flow)(u,c)(e),o=e=>Object(a.flow)(c)(e),s=e=>Object(a.flow)(l)(e),l=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(r.a)({...e,entries:e.entries.map((e=>Object(r.a)(e)))}):Object(r.a)(e)));return{...e,entries:t}},c=e=>{const{entries:t}=e,n=t.map((e=>"nested"===e.type?Object(r.b)({...e,entries:e.entries.map((e=>Object(r.b)(e)))}):Object(r.b)(e)));return{...e,entries:n}},u=e=>{const{comments:t}=e;if(!t||!t.length)return e;const n=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(2),r=n(43);const i=Object(a.createContext)(void 0),o=Object(a.memo)((({urlKey:e,children:t})=>{const n=Object(a.useMemo)((()=>({urlKey:e})),[e]);return Object(r.jsx)(i.Provider,{value:n},t)}));o.displayName="ExpandableFlyoutContextProvider";const s=()=>{const e=Object(a.useContext)(i);if(void 0===e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e}},,,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}));var a=n(4);const r=e=>a.i18n.translate("xpack.securitySolution.assignees.totalUsersAssigned",{defaultMessage:"{total, plural, one {# filter} other {# filters}} selected",values:{total:e}}),i=a.i18n.translate("xpack.securitySolution.assignees.applyButtonTitle",{defaultMessage:"Apply"}),o=a.i18n.translate("xpack.securitySolution.assignees.selectableSearchPlaceholder",{defaultMessage:"Search users"}),s=a.i18n.translate("xpack.securitySolution.assignees.clearFilters",{defaultMessage:"Clear filters"}),l=a.i18n.translate("xpack.securitySolution.assignees.noAssigneesLabel",{defaultMessage:"No assignees"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(7),r=n(405);const i=e=>{var t,n,a,r,i,o,s;return null!==(t=null!==(n=null===(a=e.user)||void 0===a||null===(r=a.full_name)||void 0===r?void 0:r.toLowerCase())&&void 0!==n?n:null===(i=e.user)||void 0===i||null===(o=i.email)||void 0===o?void 0:o.toLowerCase())&&void 0!==t?t:null===(s=e.user)||void 0===s?void 0:s.username.toLowerCase()},o=(e,t)=>((e,t)=>{if(!t)return;if(!e)return t;if(!t.find((t=>t.uid===e.uid)))return t;const n=t.filter((t=>t.uid!==e.uid));return[e,...n]})(e,(e=>{if(e)return Object(a.sortBy)(e,i)})(t)),s=e=>e.filter((e=>e!==r.b))},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));const a="securitySolutionAssignees",r=`${a}Selectable`,i=`${a}ApplyPanel`,o=`${a}ApplyButton`},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return c}));var a=n(19);const r=97,i=2;function o(e,t){if(t&&t.color)return t.color;const n=l(e).codePointAt(0)||r;return a.VISUALIZATION_COLORS[n%a.VISUALIZATION_COLORS.length]}function s(e,t){if(t&&t.initials)return t.initials;const n=l(e).split(" "),a=Math.min(i,n.length);return n.splice(a,n.length),n.map((e=>e.substring(0,1))).join("")}function l(e){return e.full_name||e.email||e.username}function c(e){const t=l(e);return e.email&&e.email!==t?`${t} (${e.email})`:t}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1222);const r=e=>{var t;const n=null!=e&&e.fields?null==e?void 0:e.fields["kibana.alert.rule.parameters"]:null,r=n?null===(t=n[0])||void 0===t?void 0:t.threat:null;return r&&r.length>0?Object(a.o)({label:r[0].framework,threat:r}):null}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),r=n(2),i=n.n(r),o=n(667),s=n(172),l=n(422),c=n(148),u=n(124);const d=i.a.memo((({eventId:e,contextId:t,enrichedFieldInfo:n,scopeId:d,handleOnEventClosed:p})=>{const[m,f]=Object(r.useState)(!1),g=Object(r.useCallback)((()=>f(!m)),[m]),b=Object(r.useCallback)((()=>f(!1)),[]),y=Object(r.useCallback)((()=>{b(),p()}),[b,p]),h=Object(r.useMemo)((()=>c.d.globalQuery()),[]),v=Object(u.a)(h),E=Object(r.useCallback)((()=>{v.forEach((e=>e.refetch&&e.refetch()))}),[v]),{actionItems:x}=Object(o.a)({closePopover:y,eventId:e,scopeId:d,alertStatus:n.values[0],refetch:E}),j=Object(r.useMemo)((()=>[{id:0,items:x}]),[x]),O=Object(r.useMemo)((()=>x.length>0),[x]),S=Object(r.useMemo)((()=>i.a.createElement(l.a,{contextId:t,eventId:e,value:n.values[0],fieldName:n.data.field,linkValue:n.linkValue,fieldType:n.data.type,fieldFormat:n.data.format,isDraggable:!1,truncate:!1,isButton:O,onClick:O?g:void 0,onClickAriaLabel:s.D})),[t,e,n,g,O]);return O?i.a.createElement(a.EuiPopover,{button:S,isOpen:m,closePopover:b,panelPaddingSize:"none","data-test-subj":"alertStatus"},i.a.createElement(a.EuiPopoverTitle,{paddingSize:"m"},s.C),i.a.createElement(a.EuiContextMenu,{panels:j,initialPanelId:0,"data-test-subj":"event-details-alertStatusPopover"})):S}));d.displayName="StatusPopoverButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.source.destination.packetsLabel",{defaultMessage:"pkts"})},function(e,t,n){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function n(e){let n=e,a=e;function r(e,t,n,r){for(null==n&&(n=0),null==r&&(r=e.length);n<r;){const i=n+r>>>1;a(e[i],t)<0?n=i+1:r=i}return n}return 1===e.length&&(n=(t,n)=>e(t)-n,a=function(e){return(n,a)=>t(e(n),a)}(e)),{left:r,center:function(e,t,a,i){null==a&&(a=0),null==i&&(i=e.length);const o=r(e,t,a,i-1);return o>a&&n(e[o-1],t)>-n(e[o],t)?o-1:o},right:function(e,t,n,r){for(null==n&&(n=0),null==r&&(r=e.length);n<r;){const i=n+r>>>1;a(e[i],t)>0?r=i:n=i+1}return n}}}function a(e){return null===e?NaN:+e}const r=n(t),i=r.right,o=r.left,s=n(a).center;function l(e,t){let n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++n;else{let a=-1;for(let r of e)null!=(r=t(r,++a,e))&&(r=+r)>=r&&++n}return n}function c(e){return 0|e.length}function u(e){return!(e>0)}function d(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function p(e,t){let n,a=0,r=0,i=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-r,r+=n/++a,i+=n*(t-r));else{let o=-1;for(let s of e)null!=(s=t(s,++o,e))&&(s=+s)>=s&&(n=s-r,r+=n/++a,i+=n*(s-r))}if(a>1)return i/(a-1)}function m(e,t){const n=p(e,t);return n?Math.sqrt(n):n}function f(e,t){let n,a;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=a=t):(n>t&&(n=t),a<t&&(a=t)));else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(void 0===n?i>=i&&(n=a=i):(n>i&&(n=i),a<i&&(a=i)))}return[n,a]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let a=0;a<this._n&&a<32;a++){const r=t[a],i=e+r,o=Math.abs(e)<Math.abs(r)?e-(i-r):r-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,a,r=this._n,i=0;if(r>0){for(i=e[--r];r>0&&(t=i,n=e[--r],i=t+n,a=n-(i-t),!a););r>0&&(a<0&&e[r-1]<0||a>0&&e[r-1]>0)&&(n=2*a,t=i+n,n==t-i&&(i=t))}return i}}class InternMap extends Map{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(g(this,e))}has(e){return super.has(g(this,e))}set(e,t){return super.set(b(this,e),t)}delete(e){return super.delete(y(this,e))}}class InternSet extends Set{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(g(this,e))}add(e){return super.add(b(this,e))}delete(e){return super.delete(y(this,e))}}function g({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function b({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function y({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(n),e.delete(a)),n}function h(e){return null!==e&&"object"==typeof e?e.valueOf():e}function v(e){return e}function E(e,...t){return O(e,v,v,t)}function x(e,t,...n){return O(e,v,t,n)}function j(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function O(e,t,n,a){return function e(r,i){if(i>=a.length)return n(r);const o=new InternMap,s=a[i++];let l=-1;for(const e of r){const t=s(e,++l,r),n=o.get(t);n?n.push(e):o.set(t,[e])}for(const[t,n]of o)o.set(t,e(n,i));return t(o)}(e,0)}function S(e,t){return Array.from(t,(t=>e[t]))}function w(e,...n){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[a=t]=n;if(1===a.length||n.length>1){const r=Uint32Array.from(e,((e,t)=>t));return n.length>1?(n=n.map((t=>e.map(t))),r.sort(((e,a)=>{for(const r of n){const n=t(r[e],r[a]);if(n)return n}}))):(a=e.map(a),r.sort(((e,n)=>t(a[e],a[n])))),S(e,r)}return e.sort(a)}var k=Array.prototype.slice;function I(e){return function(){return e}}var T=Math.sqrt(50),C=Math.sqrt(10),M=Math.sqrt(2);function _(e,t,n){var a,r,i,o,s=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((a=t<e)&&(r=e,e=t,t=r),0===(o=D(e,t,n))||!isFinite(o))return[];if(o>0){let n=Math.round(e/o),a=Math.round(t/o);for(n*o<e&&++n,a*o>t&&--a,i=new Array(r=a-n+1);++s<r;)i[s]=(n+s)*o}else{o=-o;let n=Math.round(e*o),a=Math.round(t*o);for(n/o<e&&++n,a/o>t&&--a,i=new Array(r=a-n+1);++s<r;)i[s]=(n+s)/o}return a&&i.reverse(),i}function D(e,t,n){var a=(t-e)/Math.max(0,n),r=Math.floor(Math.log(a)/Math.LN10),i=a/Math.pow(10,r);return r>=0?(i>=T?10:i>=C?5:i>=M?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(i>=T?10:i>=C?5:i>=M?2:1)}function N(e,t,n){let a;for(;;){const r=D(e,t,n);if(r===a||0===r||!isFinite(r))return[e,t];r>0?(e=Math.floor(e/r)*r,t=Math.ceil(t/r)*r):r<0&&(e=Math.ceil(e*r)/r,t=Math.floor(t*r)/r),a=r}}function A(e){return Math.ceil(Math.log(l(e))/Math.LN2)+1}function F(){var e=v,t=f,n=A;function a(a){Array.isArray(a)||(a=Array.from(a));var r,o,s=a.length,l=new Array(s);for(r=0;r<s;++r)l[r]=e(a[r],r,a);var c=t(l),u=c[0],d=c[1],p=n(l,u,d);if(!Array.isArray(p)){const e=d,n=+p;if(t===f&&([u,d]=N(u,d,n)),(p=_(u,d,n))[p.length-1]>=d)if(e>=d&&t===f){const e=D(u,d,n);isFinite(e)&&(e>0?d=(Math.floor(d/e)+1)*e:e<0&&(d=(Math.ceil(d*-e)+1)/-e))}else p.pop()}for(var m=p.length;p[0]<=u;)p.shift(),--m;for(;p[m-1]>d;)p.pop(),--m;var g,b=new Array(m+1);for(r=0;r<=m;++r)(g=b[r]=[]).x0=r>0?p[r-1]:u,g.x1=r<m?p[r]:d;for(r=0;r<s;++r)u<=(o=l[r])&&o<=d&&b[i(p,o,0,m)].push(a[r]);return b}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:I(t),a):e},a.domain=function(e){return arguments.length?(t="function"==typeof e?e:I([e[0],e[1]]),a):t},a.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?I(k.call(e)):I(e),a):n},a}function P(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let r of e)null!=(r=t(r,++a,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function R(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let r of e)null!=(r=t(r,++a,e))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function L(e,n,a=0,r=e.length-1,i=t){for(;r>a;){if(r-a>600){const t=r-a+1,o=n-a+1,s=Math.log(t),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(t-l)/t)*(o-t/2<0?-1:1);L(e,n,Math.max(a,Math.floor(n-o*l/t+c)),Math.min(r,Math.floor(n+(t-o)*l/t+c)),i)}const t=e[n];let o=a,s=r;for(q(e,a,n),i(e[r],t)>0&&q(e,a,r);o<s;){for(q(e,o,s),++o,--s;i(e[o],t)<0;)++o;for(;i(e[s],t)>0;)--s}0===i(e[a],t)?q(e,a,s):(++s,q(e,s,r)),s<=n&&(a=s+1),n<=s&&(r=s-1)}return e}function q(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function z(e,t,n){if(a=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let a of e)null!=(a=t(a,++n,e))&&(a=+a)>=a&&(yield a)}}(e,n))).length){if((t=+t)<=0||a<2)return R(e);if(t>=1)return P(e);var a,r=(a-1)*t,i=Math.floor(r),o=P(L(e,i).subarray(0,i+1));return o+(R(e.subarray(i+1))-o)*(r-i)}}function B(e,t){let n,a=-1,r=-1;if(void 0===t)for(const t of e)++r,null!=t&&(n<t||void 0===n&&t>=t)&&(n=t,a=r);else for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i,a=r);return a}function $(e,t){let n,a=-1,r=-1;if(void 0===t)for(const t of e)++r,null!=t&&(n>t||void 0===n&&t>=t)&&(n=t,a=r);else for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i,a=r);return a}function V(e,t){return[e,t]}function U(e,n=t){if(1===n.length)return $(e,n);let a,r=-1,i=-1;for(const t of e)++i,(r<0?0===n(t,t):n(t,a)<0)&&(a=t,r=i);return r}var G=H(Math.random);function H(e){return function(t,n=0,a=t.length){let r=a-(n=+n);for(;r;){const a=e()*r--|0,i=t[r+n];t[r+n]=t[a+n],t[a+n]=i}return t}}function W(e){if(!(r=e.length))return[];for(var t=-1,n=R(e,Q),a=new Array(n);++t<n;)for(var r,i=-1,o=a[t]=new Array(r);++i<r;)o[i]=e[i][t];return a}function Q(e){return e.length}function Y(e){return e instanceof Set?e:new Set(e)}function K(e,t){const n=e[Symbol.iterator](),a=new Set;for(const e of t){if(a.has(e))continue;let t,r;for(;({value:t,done:r}=n.next());){if(r)return!1;if(a.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=F,e.bisect=i,e.bisectCenter=s,e.bisectLeft=o,e.bisectRight=i,e.bisector=n,e.count=l,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),n=(e=e.map(d)).map(c),a=e.length-1,r=new Array(a+1).fill(0),i=[];if(a<0||n.some(u))return i;for(;;){i.push(r.map(((t,n)=>e[n][t])));let o=a;for(;++r[o]===n[o];){if(0===o)return t?i.map(t):i;r[o--]=0}}},e.cumsum=function(e,t){var n=0,a=0;return Float64Array.from(e,void 0===t?e=>n+=+e||0:r=>n+=+t(r,a++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.difference=function(e,...t){e=new Set(e);for(const n of t)for(const t of n)e.delete(t);return e},e.disjoint=function(e,t){const n=t[Symbol.iterator](),a=new Set;for(const t of e){if(a.has(t))return!1;let e,r;for(;({value:e,done:r}=n.next())&&!r;){if(Object.is(t,e))return!1;a.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const a of e)if(!t(a,++n,e))return!1;return!0},e.extent=f,e.fcumsum=function(e,t){const n=new Adder;let a=-1;return Float64Array.from(e,void 0===t?e=>n.add(+e||0):r=>n.add(+t(r,++a,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const n=[];let a=-1;for(const r of e)t(r,++a,e)&&n.push(r);return n},e.fsum=function(e,t){const n=new Adder;if(void 0===t)for(let t of e)(t=+t)&&n.add(t);else{let a=-1;for(let r of e)(r=+t(r,++a,e))&&n.add(r)}return+n},e.greatest=function(e,n=t){let a,r=!1;if(1===n.length){let i;for(const o of e){const e=n(o);(r?t(e,i)>0:0===t(e,e))&&(a=o,i=e,r=!0)}}else for(const t of e)(r?n(t,a)>0:0===n(t,t))&&(a=t,r=!0);return a},e.greatestIndex=function(e,n=t){if(1===n.length)return B(e,n);let a,r=-1,i=-1;for(const t of e)++i,(r<0?0===n(t,t):n(t,a)>0)&&(a=t,r=i);return r},e.group=E,e.groupSort=function(e,n,a){return(1===n.length?w(x(e,n,a),(([e,n],[a,r])=>t(n,r)||t(e,a))):w(E(e,a),(([e,a],[r,i])=>n(a,i)||t(e,r)))).map((([e])=>e))},e.groups=function(e,...t){return O(e,Array.from,v,t)},e.histogram=F,e.index=function(e,...t){return O(e,v,j,t)},e.indexes=function(e,...t){return O(e,Array.from,j,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(Y);e:for(const n of e)for(const a of t)if(!a.has(n)){e.delete(n);continue e}return e},e.least=function(e,n=t){let a,r=!1;if(1===n.length){let i;for(const o of e){const e=n(o);(r?t(e,i)<0:0===t(e,e))&&(a=o,i=e,r=!0)}}else for(const t of e)(r?n(t,a)<0:0===n(t,t))&&(a=t,r=!0);return a},e.leastIndex=U,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((n,a)=>t(n,a,e)))},e.max=P,e.maxIndex=B,e.mean=function(e,t){let n=0,a=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,a+=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(i=+i)>=i&&(++n,a+=i)}if(n)return a/n},e.median=function(e,t){return z(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=R,e.minIndex=$,e.nice=N,e.pairs=function(e,t=V){const n=[];let a,r=!1;for(const i of e)r&&n.push(t(a,i)),a=i,r=!0;return n},e.permute=S,e.quantile=z,e.quantileSorted=function(e,t,n=a){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(i-o)}},e.quickselect=L,e.range=function(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var a=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(r);++a<r;)i[a]=e+a*n;return i},e.reduce=function(e,t,n){if("function"!=typeof t)throw new TypeError("reducer is not a function");const a=e[Symbol.iterator]();let r,i,o=-1;if(arguments.length<3){if(({done:r,value:n}=a.next()),r)return;++o}for(;({done:r,value:i}=a.next()),!r;)n=t(n,i,++o,e);return n},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=x,e.rollups=function(e,t,...n){return O(e,Array.from,t,n)},e.scan=function(e,t){const n=U(e,t);return n<0?void 0:n},e.shuffle=G,e.shuffler=H,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const a of e)if(t(a,++n,e))return!0;return!1},e.sort=w,e.subset=function(e,t){return K(t,e)},e.sum=function(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let a=-1;for(let r of e)(r=+t(r,++a,e))&&(n+=r)}return n},e.superset=K,e.thresholdFreedmanDiaconis=function(e,t,n){return Math.ceil((n-t)/(2*(z(e,.75)-z(e,.25))*Math.pow(l(e),-1/3)))},e.thresholdScott=function(e,t,n){return Math.ceil((n-t)/(3.5*m(e)*Math.pow(l(e),-1/3)))},e.thresholdSturges=A,e.tickIncrement=D,e.tickStep=function(e,t,n){var a=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),i=a/r;return i>=T?r*=10:i>=C?r*=5:i>=M&&(r*=2),t<e?-r:r},e.ticks=_,e.transpose=W,e.union=function(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t},e.variance=p,e.zip=function(){return W(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e,t){"use strict";var n=new Date,a=new Date;function r(e,t,i,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},s.round=function(e){var t=s(e),n=s.ceil(e);return e-t<n-e?t:n},s.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},s.range=function(n,a,r){var i,o=[];if(n=s.ceil(n),r=null==r?1:Math.floor(r),!(n<a&&r>0))return o;do{o.push(i=new Date(+n)),t(n,r),e(n)}while(i<n&&n<a);return o},s.filter=function(n){return r((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,a){if(e>=e)if(a<0)for(;++a<=0;)for(;t(e,-1),!n(e););else for(;--a>=0;)for(;t(e,1),!n(e););}))},i&&(s.count=function(t,r){return n.setTime(+t),a.setTime(+r),e(n),e(a),Math.floor(i(n,a))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var i=r((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):i:null};var o=i.range;const s=1e3,l=6e4,c=36e5,u=864e5,d=6048e5,p=2592e6,m=31536e6;var f=r((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCSeconds()})),g=f.range,b=r((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getMinutes()})),y=b.range,h=r((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s-e.getMinutes()*l)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getHours()})),v=h.range,E=r((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/u),(e=>e.getDate()-1)),x=E.range;function j(e){return r((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/d}))}var O=j(0),S=j(1),w=j(2),k=j(3),I=j(4),T=j(5),C=j(6),M=O.range,_=S.range,D=w.range,N=k.range,A=I.range,F=T.range,P=C.range,R=r((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),L=R.range,q=r((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));q.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var z=q.range,B=r((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCMinutes()})),$=B.range,V=r((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCHours()})),U=V.range,G=r((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1})),H=G.range;function W(e){return r((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/d}))}var Q=W(0),Y=W(1),K=W(2),Z=W(3),X=W(4),J=W(5),ee=W(6),te=Q.range,ne=Y.range,ae=K.range,re=Z.range,ie=X.range,oe=J.range,se=ee.range,le=r((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ce=le.range,ue=r((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));ue.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var de=ue.range;function pe(e,n,a,r,o,g){const b=[[f,1,s],[f,5,5e3],[f,15,15e3],[f,30,3e4],[g,1,l],[g,5,3e5],[g,15,9e5],[g,30,18e5],[o,1,c],[o,3,108e5],[o,6,216e5],[o,12,432e5],[r,1,u],[r,2,1728e5],[a,1,d],[n,1,p],[n,3,7776e6],[e,1,m]];function y(n,a,r){const o=Math.abs(a-n)/r,s=t.bisector((([,,e])=>e)).right(b,o);if(s===b.length)return e.every(t.tickStep(n/m,a/m,r));if(0===s)return i.every(Math.max(t.tickStep(n,a,r),1));const[l,c]=b[o/b[s-1][2]<b[s][2]/o?s-1:s];return l.every(c)}return[function(e,t,n){const a=t<e;a&&([e,t]=[t,e]);const r=n&&"function"==typeof n.range?n:y(e,t,n),i=r?r.range(e,+t+1):[];return a?i.reverse():i},y]}const[me,fe]=pe(ue,le,Q,G,V,B),[ge,be]=pe(q,R,O,E,h,b);e.timeDay=E,e.timeDays=x,e.timeFriday=T,e.timeFridays=F,e.timeHour=h,e.timeHours=v,e.timeInterval=r,e.timeMillisecond=i,e.timeMilliseconds=o,e.timeMinute=b,e.timeMinutes=y,e.timeMonday=S,e.timeMondays=_,e.timeMonth=R,e.timeMonths=L,e.timeSaturday=C,e.timeSaturdays=P,e.timeSecond=f,e.timeSeconds=g,e.timeSunday=O,e.timeSundays=M,e.timeThursday=I,e.timeThursdays=A,e.timeTickInterval=be,e.timeTicks=ge,e.timeTuesday=w,e.timeTuesdays=D,e.timeWednesday=k,e.timeWednesdays=N,e.timeWeek=O,e.timeWeeks=M,e.timeYear=q,e.timeYears=z,e.utcDay=G,e.utcDays=H,e.utcFriday=J,e.utcFridays=oe,e.utcHour=V,e.utcHours=U,e.utcMillisecond=i,e.utcMilliseconds=o,e.utcMinute=B,e.utcMinutes=$,e.utcMonday=Y,e.utcMondays=ne,e.utcMonth=le,e.utcMonths=ce,e.utcSaturday=ee,e.utcSaturdays=se,e.utcSecond=f,e.utcSeconds=g,e.utcSunday=Q,e.utcSundays=te,e.utcThursday=X,e.utcThursdays=ie,e.utcTickInterval=fe,e.utcTicks=me,e.utcTuesday=K,e.utcTuesdays=ae,e.utcWednesday=Z,e.utcWednesdays=re,e.utcWeek=Q,e.utcWeeks=te,e.utcYear=ue,e.utcYears=de,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(833))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var a=n(19),r=n(44),i=n(2),o=n.n(i),s=n(134);const l="process.name",c="user.name",u=o.a.memo((({contextId:e,eventId:t,isDraggable:n,processName:i,userName:u})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"user-process",direction:"column",justifyContent:"center",gutterSize:"none"},null!=u?Object(r.uniq)(u).map((r=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:r},o.a.createElement(s.c,{contextId:e,"data-test-subj":"user-name",eventId:t,field:c,isDraggable:n,value:r,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))):null,null!=i?Object(r.uniq)(i).map((r=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:r},o.a.createElement(s.c,{contextId:e,eventId:t,field:l,isDraggable:n,value:r,iconType:"console",isAggregatable:!0,fieldType:"keyword"})))):null)));u.displayName="UserProcess"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n.n(a),i=n(134),o=n(434),s=n(150);const l=r.a.memo((({contextId:e,eventId:t,hostName:n,workingDirectory:a,isDraggable:l})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:e,eventId:t,field:"host.name",value:n,isDraggable:l,fieldType:"keyword",isAggregatable:!0})),null!=a&&r.a.createElement(s.c,{grow:!1,component:"span"},o.e),r.a.createElement(s.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:e,eventId:t,field:"process.working_directory",value:a,iconType:"folderOpen",isDraggable:l,fieldType:"keyword",isAggregatable:!0})))));l.displayName="HostWorkingDir"},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(44),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(121),c=n(433),u=n(629),d=n(520),p=n(590),m=n(406),f=n(630),g=n(859),b=n(592),y=n(835),h=n(382),v=n(486),E=n(591),x=n(569),j=n(315);const O=s.a.div.withConfig({displayName:"Details",componentId:"sc-1voakd9-0"})(["margin:5px 0;"]);O.displayName="Details";const S={id:l.e.netflow,isInstance:e=>"network_traffic"===`${Object(a.get)("event.category",e)}`.toLowerCase()||(e=>{const t=`${e}`.toLowerCase();return"network_flow"===t||"netflow_flow"===t})(Object(a.get)("event.action",e)),renderRow:({data:e,isDraggable:t,scopeId:n})=>i.a.createElement(j.a,null,i.a.createElement(O,null,i.a.createElement(g.a,{contextId:`netflow-row-renderer-render-row-${n}-${e._id}`,destinationBytes:Object(c.a)(Object(a.get)(x.a,e)),destinationGeoContinentName:Object(c.a)(Object(a.get)(E.b,e)),destinationGeoCountryName:Object(c.a)(Object(a.get)(E.d,e)),destinationGeoCountryIsoCode:Object(c.a)(Object(a.get)(E.c,e)),destinationGeoRegionName:Object(c.a)(Object(a.get)(E.e,e)),destinationGeoCityName:Object(c.a)(Object(a.get)(E.a,e)),destinationIp:Object(c.a)(Object(a.get)(m.a,e)),destinationPackets:Object(c.a)(Object(a.get)(x.b,e)),destinationPort:Object(c.a)(Object(a.get)(h.a,e)),eventDuration:Object(c.a)(Object(a.get)(d.b,e)),eventId:Object(a.get)(p.a,e),eventEnd:Object(c.a)(Object(a.get)(b.b,e)),eventStart:Object(c.a)(Object(a.get)(b.c,e)),isDraggable:t,networkBytes:Object(c.a)(Object(a.get)(v.a,e)),networkCommunityId:Object(c.a)(Object(a.get)(v.b,e)),networkDirection:Object(c.a)(Object(a.get)(v.c,e)),networkPackets:Object(c.a)(Object(a.get)(v.d,e)),networkProtocol:Object(c.a)(Object(a.get)(v.e,e)),processName:Object(c.a)(Object(a.get)(y.a,e)),sourceBytes:Object(c.a)(Object(a.get)(x.c,e)),sourceGeoContinentName:Object(c.a)(Object(a.get)(E.h,e)),sourceGeoCountryName:Object(c.a)(Object(a.get)(E.j,e)),sourceGeoCountryIsoCode:Object(c.a)(Object(a.get)(E.i,e)),sourceGeoRegionName:Object(c.a)(Object(a.get)(E.k,e)),sourceGeoCityName:Object(c.a)(Object(a.get)(E.g,e)),sourceIp:Object(c.a)(Object(a.get)(m.d,e)),sourcePackets:Object(c.a)(Object(a.get)(x.d,e)),sourcePort:Object(c.a)(Object(a.get)(h.c,e)),tlsClientCertificateFingerprintSha1:Object(c.a)(Object(a.get)(u.b,e)),tlsFingerprintsJa3Hash:Object(c.a)(Object(a.get)(f.a,e)),tlsServerCertificateFingerprintSha1:Object(c.a)(Object(a.get)(u.c,e)),transport:Object(c.a)(Object(a.get)(v.f,e)),userName:Object(c.a)(Object(a.get)(y.b,e))})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(19),o=n(180),s=n(355);const l=({width:e=s.b,dataTestSubj:t,content:n,ariaLabel:a,iconType:l="",isDisabled:c=!1,onClick:u,children:d,buttonType:p="icon"})=>r.a.createElement(r.a.Fragment,null,"icon"===p&&r.a.createElement("div",null,r.a.createElement(o.l,{textAlign:"center",width:e},null!=d?d:r.a.createElement(i.EuiToolTip,{"data-test-subj":`${t}-tool-tip`,content:n},r.a.createElement(i.EuiButtonIcon,{"aria-label":a,"data-test-subj":`${t}-button`,iconType:l,isDisabled:c,onClick:u,size:"s"})))),"text"===p&&r.a.createElement(i.EuiContextMenuItem,{"aria-label":a,"data-test-subj":`${t}-button-menu-item`,disabled:c,onClick:u,color:"text",size:"s"},r.a.createElement(i.EuiText,{"data-test-subj":`${t}-button`,size:"m"},n)),"emptyButton"===p&&r.a.createElement(i.EuiButtonEmpty,{onClick:u,iconType:"timeline",flush:"right",size:"xs","data-test-subj":t},n));l.displayName="ActionIconItemComponent";const c=r.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(19),r=n(44),i=n(2),o=n.n(i),s=n(121),l=n(432);const c=e=>e?"pinFilled":"pin",u=o.a.memo((({ariaLabel:e,allowUnpinning:t,isAlert:n,isDisabled:i,onClick:u=r.noop,pinned:d,timelineType:p})=>{const m=p===s.m.template,f=(({isAlert:e,isTemplate:t,isPinned:n})=>t?l.b(e):n?l.c(e):l.g(e))({isAlert:n,isTemplate:m,isPinned:d}),g=null==e||m?f:e;return o.a.createElement(a.EuiButtonIcon,{"aria-label":g,"data-test-subj":"pin",iconType:c(d),onClick:u,isDisabled:i||m||!t,size:"s"})}));u.displayName="Pin"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n(1558),i=n(123),o=n(118),s=n(252),l=n(512),c=n(1207),u=n(303);const d=e=>{const{data:t,spaces:n}=Object(o.j)().services,{addWarning:d}=Object(i.a)(),[p,m]=Object(a.useState)(!1),[f,g]=Object(a.useState)(""),b=Object(a.useMemo)((()=>null!=e&&1===e.length),[e]),y=Object(a.useMemo)((()=>null!=e&&b&&"machine_learning"===e[0].type),[b,e]);Object(a.useEffect)((()=>{(async()=>{if(n){const e=await n.getActiveSpace();g(e.id)}})()}),[n]);const h=Object(a.useMemo)((()=>null!=e&&b?"data_view_id"in e[0]&&e[0].data_view_id||null:`security-solution-${f}`),[b,e,f]),v=Object(a.useMemo)((()=>null!=e&&b&&"esql"===e[0].type?Object(r.a)(null==e?void 0:e[0].query):!h&&null!=e&&b&&"index"in e[0]&&null!=e[0].index?e[0].index:[]),[h,b,e]),E=Object(a.useMemo)((()=>{var t;return y&&b&&null!=e&&null!==(t=Object(u.g)(e[0]))&&void 0!==t?t:[]}),[y,b,e]),{mlJobLoading:x,ruleIndices:j}=Object(c.a)(E),O=Object(a.useMemo)((()=>y&&j.length>0?j:null!=h?[]:v),[y,h,v,j]),[S,{indexPatterns:w,dataView:k}]=Object(s.b)(O,!1,"indexFields"),[I,T]=Object(a.useState)(null),[C,M]=Object(a.useState)(null);Object(a.useEffect)((()=>{(async()=>{if(""!==f&&h){m(!0);const e=await t.dataViews.get(h);m(!1),T(e),M(e.toSpec())}})()}),[h,t.dataViews,T,f]);const _=Object(a.useCallback)((async e=>{let n=[];const a=null!=C?C:k;if(!a)return n;try{n=await t.dataViews.getFieldsForIndexPattern(a,{pattern:"",includeUnmapped:!0,fields:e})}catch(e){d(e,{title:l.b})}return n}),[d,t.dataViews,C,k]);return{isLoading:S||x||p,indexPatterns:Object(a.useMemo)((()=>h&&null!=I?I:w),[h,I,w]),getExtendedFields:_}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(1491),i=n(343),o=n(118);const s=()=>{const{services:{http:e}}=Object(o.j)(),[t,n]=Object(a.useState)(!1),s=Object(a.useRef)(null),{addExceptionListItem:l,updateExceptionListItem:c}=Object(r.a)(e);return Object(a.useEffect)((()=>{const e=new AbortController;return s.current=async e=>{try{n(!0);const t=await Promise.all(e.map((e=>{if("id"in e&&null!=e.id){const t=Object(i.i)(e);return c({listItem:t})}return l({listItem:e})})));return n(!1),t}catch(e){throw n(!1),e}},()=>{n(!1),e.abort()}}),[c,e,l]),[t,s.current]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"o",(function(){return E})),n.d(t,"n",(function(){return x})),n.d(t,"m",(function(){return j})),n.d(t,"u",(function(){return O})),n.d(t,"k",(function(){return S})),n.d(t,"v",(function(){return w}));var a=n(4);const r=a.i18n.translate("exceptionList-components.empty.viewer.state.empty.title",{defaultMessage:"Add exceptions to this list"}),i=a.i18n.translate("exceptionList-components.empty.viewer.state.empty.body",{defaultMessage:"There is no exception in your list. Create your first exception."}),o=a.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.search.title",{defaultMessage:"No results match your search criteria"}),s=a.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.body",{defaultMessage:"Try modifying your search"}),l=e=>a.i18n.translate("exceptionList-components.empty.viewer.state.empty.viewer_button",{values:{exceptionType:e},defaultMessage:"Create {exceptionType} exception"}),c=a.i18n.translate("exceptionList-components.empty.viewer.state.error_title",{defaultMessage:"Unable to load exception items"}),u=a.i18n.translate("exceptionList-components.empty.viewer.state.error_body",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),d=a.i18n.translate("exceptionList-components.exception_list_header_export_action",{defaultMessage:"Export exception list"}),p=a.i18n.translate("exceptionList-components.exception_list_header_delete_action",{defaultMessage:"Delete exception list"}),m=a.i18n.translate("exceptionList-components.exception_list_header_duplicate_action",{defaultMessage:"Duplicate exception list"}),f=a.i18n.translate("exceptionList-components.exception_list_header_link_rules_button",{defaultMessage:"Link rules"}),g=e=>a.i18n.translate("exceptionList-components.exception_list_header_linked_rules",{values:{noOfRules:e},defaultMessage:"Linked to {noOfRules} rules"}),b=a.i18n.translate("exceptionList-components.exception_list_header_breadcrumb",{defaultMessage:"Shared Exception Lists"}),y=a.i18n.translate("exceptionList-components.exception_list_header_list_id",{defaultMessage:"List ID"}),h=a.i18n.translate("exceptionList-components.exception_list_header_name",{defaultMessage:"Add a name"}),v=a.i18n.translate("exceptionList-components.exception_list_header_description",{defaultMessage:"Add a description"}),E=e=>a.i18n.translate("exceptionList-components.exception_list_header_edit_modal_name",{defaultMessage:"Edit {listName}",values:{listName:e}}),x=a.i18n.translate("exceptionList-components.exception_list_header_edit_modal_save_button",{defaultMessage:"Save"}),j=a.i18n.translate("exceptionList-components.exception_list_header_edit_modal_cancel_button",{defaultMessage:"Cancel"}),O=a.i18n.translate("exceptionList-components.exception_list_header_Name_textbox",{defaultMessage:"Name"}),S=a.i18n.translate("exceptionList-components.exception_list_header_description_textbox",{defaultMessage:"Description (optional)"}),w=a.i18n.translate("exceptionList-components.exception_list_header_description_textboxexceptionList-components.exception_list_header_name_required_eror",{defaultMessage:"List name cannot be empty"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(361);const r=(e,t)=>{const n=Object(a.h)(e),r=Object(a.b)(e);return"create"===t?r:n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n.n(a),i=n(19),o=n(126);const s=Object(a.memo)((({title:e,subtitle:t,actions:n,children:s,restrictWidth:l=!1,hasBottomBorder:c=!0,hideHeader:u=!1,headerBackComponent:d,...p})=>{const m=Object(a.useMemo)((()=>r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},r.a.createElement(i.EuiFlexItem,{grow:!1},d&&r.a.createElement(r.a.Fragment,null,d)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"l"},r.a.createElement("span",{"data-test-subj":"header-page-title"},e))))),[d,e]),f=Object(a.useMemo)((()=>t?r.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},t):void 0),[t]),g=Object(o.a)(p["data-test-subj"]);return r.a.createElement("div",p,!u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiPageHeader,{pageTitle:m,description:f,bottomBorder:c,rightSideItems:n?[n]:void 0,restrictWidth:l,"data-test-subj":g("header")}),r.a.createElement(i.EuiSpacer,{size:"l"})),r.a.createElement(i.EuiPageSection,{paddingSize:"none",color:"transparent",restrictWidth:l},s))}));s.displayName="AdministrationListPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(297);const i=["create","edit"],o=(e=!0,t=!0)=>{var n;const o=null!==(n=Object(r.a)().urlParams.show)&&void 0!==n?n:"";return Object(a.useMemo)((()=>!!i.includes(o)&&("create"===o&&t||"edit"===o&&e)),[t,e,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(42),c=n(126),u=n(245);const d=Object(i.memo)((({indicateExtraEntry:e=!1,"data-test-subj":t,...n})=>{const a=Object(c.a)(t);return o.a.createElement(s.EuiToolTip,r()({},n,{content:o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltip",defaultMessage:"Filtering the descendants of a process means that events from the matched process are ingested, but events from its descendant processes are omitted."})),e&&o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltipExtraEntry",defaultMessage:"Note: the following additional condition is applied:"})),o.a.createElement("p",null,o.a.createElement("code",null,u.g))),o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltipVersionInfo",defaultMessage:"Process descendant filtering works only with Agents v8.15 and newer."}))),"data-test-subj":a("tooltipText")}),o.a.createElement(s.EuiIcon,{type:"iInCircle","data-test-subj":a("tooltipIcon")}))}));d.displayName="ProcessDescendantsTooltip"},function(e,t,n){var a=n(1274),r=n(1272),i=n(1273),o=n(749),s=n(786),l=n(848),c=n(849),u=n(850),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(o(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||i(e)))return!e.length;var t=r(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!a(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},function(e,t,n){e.exports=n(35)(1192)},function(e,t,n){e.exports=n(35)(1195)},function(e,t,n){e.exports=n(35)(1610)},function(e,t,n){e.exports=n(35)(173)},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return ht})),n.d(t,"a",(function(){return jt}));var a=n(44),r=n(19),i=n(2),o=n.n(i),s=n(45),l=n(41),c=n.n(l),u=n(64),d=n(122),p=n(140),m=n(129),f=n(158),g=n(243),b=n(127),y=n(55),h=n(59),v=n(365),E=n(331),x=n(121),j=n(4);const O=j.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineBtn",{defaultMessage:"New"}),S=j.i18n.translate("xpack.securitySolution.timeline.modal.newTimeline",{defaultMessage:"New Timeline"}),w=j.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineTemplate",{defaultMessage:"New Timeline template"}),k=j.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtn",{defaultMessage:"Open"}),I=j.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),T=j.i18n.translate("xpack.securitySolution.timeline.modal.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),C=j.i18n.translate("xpack.securitySolution.timeline.modal.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),M=j.i18n.translate("xpack.securitySolution.timeline.modal.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"}),_=j.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),D=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"}),N=j.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),A=j.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),F=j.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),P=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),R=j.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),L=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),q=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),z=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),B=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),$=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"}),V=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"}),U=o.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),a=Object(i.useCallback)((()=>n((e=>!e))),[]),s=Object(E.a)({timelineId:e,timelineType:x.m.default,onClick:a}),l=Object(E.a)({timelineId:e,timelineType:x.m.template,onClick:a}),c=Object(i.useMemo)((()=>o.a.createElement(r.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right","data-test-subj":"timeline-modal-new-timeline-dropdown-button",onClick:a},O)),[a]),u=Object(i.useCallback)((async()=>{await s()}),[s]),d=Object(i.useCallback)((async()=>{await l()}),[l]),p=Object(i.useMemo)((()=>[o.a.createElement(r.EuiContextMenuItem,{key:"new-timeline",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline",onClick:u},S),o.a.createElement(r.EuiContextMenuItem,{key:"new-timeline-template",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline-template",onClick:d},w)]),[u,d]);return o.a.createElement(r.EuiPopover,{button:c,isOpen:t,closePopover:a,panelPaddingSize:"none"},o.a.createElement(r.EuiContextMenuPanel,{items:p}))}));U.displayName="NewTimelineButton";var G=n(815);const H=["createFrom"],W=o.a.memo((()=>{const[e,t]=Object(i.useState)(!1),n=Object(i.useCallback)((()=>t((e=>!e))),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiButtonEmpty,{"data-test-subj":"timeline-modal-open-timeline-button",onClick:n,"aria-label":I},k),e?o.a.createElement(G.a,{onClose:n,hideActions:H}):null)}));W.displayName="OpenTimelineButton";var Q=n(36),Y=n(169),K=n(213),Z=n(118),X=n(132),J=n(250);const ee=e=>j.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} other {template}}",values:{isTimeline:e}});var te=n(912),ne=n(913),ae=n(181),re=n(138),ie=n(510),oe=n(5),se=n(13),le=n(146),ce=n(194),ue=n(156);const de=o.a.memo((({timelineId:e})=>{const t=Object(s.useDispatch)(),{graphEventId:n,savedObjectId:a,status:l,title:c,timelineType:u}=Object(s.useSelector)((t=>Object(Y.selectTimelineById)(t,e))),{cases:d,application:{navigateToApp:p}}=Object(Z.j)().services,m=d.helpers.canUseCases([oe.j]),[f,g]=Object(i.useState)(!1),[b,y]=Object(i.useState)(!1),h=Object(i.useCallback)((()=>g((e=>!e))),[]),v=Object(i.useCallback)((()=>y(!1)),[y]),E=Object(i.useCallback)((async r=>{v(),await p(oe.m,{deepLinkId:ue.a.case,path:null!=r?Object(ce.a)({id:r.id}):Object(ce.b)()}),t(Object(se.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:c}))}),[v,t,n,p,a,e,c]),j=Object(i.useCallback)((()=>{h(),p(oe.m,{deepLinkId:ue.a.case,path:Object(ce.b)()}).then((()=>{t(Object(se.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:c.length>0?c:ie.d})),t(Object(se.showTimeline)({id:le.c.active,show:!1}))}))}),[t,n,p,a,e,c,h]),O=Object(i.useCallback)((()=>{h(),y(!0)}),[h,y]),S=Object(i.useMemo)((()=>o.a.createElement(r.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",disabled:l===x.l.draft||u!==x.m.default,"data-test-subj":"timeline-modal-attach-to-case-dropdown-button",onClick:h},T)),[h,l,u]),w=Object(i.useMemo)((()=>[o.a.createElement(r.EuiContextMenuItem,{key:"new-case","data-test-subj":"timeline-modal-attach-timeline-to-new-case",onClick:j},C),o.a.createElement(r.EuiContextMenuItem,{key:"existing-case","data-test-subj":"timeline-modal-attach-timeline-to-existing-case",onClick:O},M)]),[O,j]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiPopover,{button:S,isOpen:f,closePopover:h,panelPaddingSize:"none"},o.a.createElement(r.EuiContextMenuPanel,{items:w})),b&&d.ui.getAllCasesSelectorModal({onRowClick:E,onClose:v,owner:[oe.j],permissions:m}))}));de.displayName="AttachToCaseButton";var pe=n(271),me=n.n(pe),fe=n(157),ge=n(187),be=n(219);const ye={title:{type:fe.a.TEXT,validations:[{validator:fe.j.emptyField("")}]},description:{type:fe.a.TEXTAREA,validations:[]}},he=Object(fe.l)({component:fe.b}),ve=`${z} (${B})`,Ee=o.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:n,showWarning:a})=>{const{startTransaction:l}=Object(ge.b)(),c=Object(s.useDispatch)(),{isSaving:u,description:d,status:p,title:f,timelineType:g}=Object(s.useSelector)((e=>Object(Y.selectTimelineById)(e,n))),[b,y]=Object(i.useState)(!1),h=Object(i.useCallback)((e=>y(e.target.checked)),[]),v=p===x.l.draft,O=me()(u),S=Object(E.a)({timelineId:le.c.active,timelineType:x.m.default}),w=Object(i.useCallback)(((e,t)=>(t&&(c(m.a.updateTitleAndDescription({id:n,...e})),c(m.a.saveTimeline({id:n,saveAsNew:b}))),Promise.resolve())),[c,n,b]),k=Object(i.useMemo)((()=>({title:f,description:d})),[f,d]),{form:I}=Object(fe.m)({id:"timelineTitleAndDescriptionForm",schema:ye,onSubmit:w,options:{stripEmptyFields:!1},defaultValue:k}),{isSubmitted:T,isSubmitting:C,submit:M}=I,_=Object(i.useCallback)((()=>{l({name:be.f.SAVE}),M()}),[M,l]),B=Object(i.useCallback)((async()=>{a&&await S(),e()}),[e,S,a]),U=Object(i.useMemo)((()=>p===x.l.draft&&a?g===x.m.template?R:P:L),[a,p,g]),G=Object(i.useMemo)((()=>p===x.l.draft?g===x.m.template?N:D:g===x.m.template?F:D),[p,g]),H=Object(i.useMemo)((()=>p===x.l.draft&&a?g===x.m.template?N:D:A),[a,p,g]),W=Object(i.useMemo)((()=>(e=>j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===x.m.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(g)),[g]),Q=Object(i.useMemo)((()=>({"aria-label":q,autoFocus:"title"===t,"data-test-subj":"save-timeline-modal-title-input",disabled:u,spellCheck:!0,placeholder:g===x.m.template?ie.c:ie.d})),[t,u,g]),K=Object(i.useMemo)((()=>({"aria-label":z,"data-test-subj":"save-timeline-modal-description-input",disabled:u,placeholder:ie.a})),[u]);return Object(i.useEffect)((()=>{T&&!u&&O&&e()}),[T,u,O,e]),o.a.createElement(r.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},u&&o.a.createElement(r.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),o.a.createElement(r.EuiModalHeader,{"data-test-subj":"save-timeline-modal-header"},G),o.a.createElement(r.EuiModalBody,null,a&&o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(r.EuiCallOut,{title:W,color:"danger",iconType:"warning","data-test-subj":"save-timeline-modal-callout"}),o.a.createElement(r.EuiSpacer,{size:"m"})),o.a.createElement(fe.c,{form:I},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(he,{path:"title",fullWidth:!0,label:$,euiFieldProps:Q}),o.a.createElement(r.EuiSpacer,null)),o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(he,{label:ve,path:"description",fullWidth:!0,euiFieldProps:K}),o.a.createElement(r.EuiSpacer,null)),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiFlexGroup,{direction:"row",alignItems:"center"},v?null:o.a.createElement(r.EuiSwitch,{label:V,checked:b,onChange:h,"data-test-subj":"save-timeline-modal-save-as-new-switch"}),o.a.createElement(r.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},o.a.createElement(r.EuiFlexItem,{grow:!1,component:"span"},o.a.createElement(r.EuiButton,{size:"s",fill:!1,onClick:B,isDisabled:u,"data-test-subj":"save-timeline-modal-close-button"},U)),o.a.createElement(r.EuiFlexItem,{grow:!1,component:"span"},o.a.createElement(r.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:u||C,fill:!0,onClick:_,"data-test-subj":"save-timeline-modal-save-button"},H))))))))}));Ee.displayName="SaveTimelineModal";const xe=o.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),a=Object(i.useCallback)((()=>n((e=>!e))),[]),{kibanaSecuritySolutionsPrivileges:{crud:l}}=Object(p.a)(),{status:c,isSaving:u}=Object(s.useSelector)((t=>Object(Y.selectTimelineById)(t,e))),d=l&&c!==x.l.immutable,m=c===x.l.draft,f=d?null:_;return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiToolTip,{content:f,position:"bottom","data-test-subj":"timeline-modal-save-timeline-tooltip"},o.a.createElement(r.EuiButton,{id:v.a.SAVE_TIMELINE,fill:!0,size:"s",iconType:"save",isLoading:u,disabled:!d,"data-test-subj":"timeline-modal-save-timeline",onClick:a},A)),t&&d?o.a.createElement(Ee,{initialFocusOn:m?"title":"save",timelineId:e,showWarning:!1,closeSaveTimeline:a}):null)}));xe.displayName="SaveTimelineButton";const je=c.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1lpfyda-0"})(["width:0;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),Oe=Object(h.euiStyled)(r.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({theme:e})=>e.eui.euiBorderRadius};
`,Se=o.a.memo((({timelineId:e,openToggleRef:t})=>{const n=Object(s.useDispatch)(),{browserFields:a,indexPattern:l}=Object(X.a)(b.SourcererScopeName.timeline),{cases:c,uiSettings:u}=Object(Z.j)().services,d=Object(i.useMemo)((()=>Object(y.getEsQueryConfig)(u)),[u]),p=c.helpers.canUseCases([Q.APP_ID]),f=Object(s.useSelector)((t=>Object(Y.selectTitleByTimelineById)(t,e))),g=Object(s.useSelector)((t=>Object(Y.selectDataInTimeline)(t,e))),h=Object(s.useSelector)((t=>Object(Y.selectKqlQuery)(t,e))),{activeTab:E,dataProviders:x,timelineType:j,filters:O,kqlMode:S}=Object(s.useSelector)((t=>Object(Y.selectTimelineById)(t,e))),w=Object(i.useMemo)((()=>Object(J.d)({config:d,dataProviders:x,indexPattern:l,browserFields:a,filters:O||[],kqlQuery:h,kqlMode:S})),[a,x,d,O,l,S,h]),k=!g||void 0===(null==w?void 0:w.filterQuery),I=Object(i.useCallback)((()=>{null!=t.current&&t.current.focus(),Object(K.a)(),n(m.a.showTimeline({id:e,show:!1}))}),[n,e,t]);return o.a.createElement(Oe,{grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-modal-header-panel"},o.a.createElement(we,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(te.a,{timelineId:e,isPartOfGuidedTour:!0})),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(ke,{grow:!1,"data-test-subj":"timeline-modal-header-title"},o.a.createElement("h3",null,f))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(ne.a,{timelineId:e})))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiFlexGroup,{id:v.a.ACTION_MENU,justifyContent:"flexEnd",alignItems:"center",gutterSize:"xs",responsive:!1,"data-test-subj":"timeline-modal-header-actions"},o.a.createElement(r.EuiFlexItem,null,o.a.createElement(U,{timelineId:e})),o.a.createElement(r.EuiFlexItem,null,o.a.createElement(W,null)),o.a.createElement(r.EuiFlexItem,null,o.a.createElement(ae.b,{queryId:`${e}-${E}`,inputId:re.a.timeline,isDisabled:k})),p.create&&p.read?o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiFlexItem,null,o.a.createElement(je,null)),o.a.createElement(r.EuiFlexItem,null,o.a.createElement(de,{timelineId:e}))):null,o.a.createElement(r.EuiFlexItem,null,o.a.createElement(xe,{timelineId:e})),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiToolTip,{content:ee("default"===j)},o.a.createElement(r.EuiButtonIcon,{"aria-label":ee("default"===j),iconType:"cross","data-test-subj":"timeline-modal-header-close-button",onClick:I})))))))}));Se.displayName="TimelineModalHeader";var we=c()(r.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1lpfyda-1"})(["",""],{"overflow-x":"auto"}),ke=c()(r.EuiText).withConfig({displayName:"_StyledEuiText",componentId:"sc-1lpfyda-2"})(["",""],{"white-space":"nowrap"}),Ie=n(124),Te=n(191),Ce=n(443),Me=n(119),_e=n.n(Me),De=n(972),Ne=n(767),Ae=n(914);const Fe=j.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),Pe=j.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),Re=j.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),Le=j.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),qe=j.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),ze=(j.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),j.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"})),Be=j.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var $e=n(16);const Ve=c.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1fs16o3-0"})(["flex:1;"]),Ue=(e,t=o.a.createElement(r.EuiSkeletonText,{lines:10}))=>{var n;const a=o.a.forwardRef(((n,a)=>o.a.createElement(i.Suspense,{fallback:t},o.a.createElement(e,_e()({},n,{ref:a})))));return a.displayName=`${null!==(n=e.displayName)&&void 0!==n?n:"Tab"}WithSuspense`,a},Ge=Ue(Object(i.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(36)]).then(n.bind(null,2115))))),He=Ue(Object(i.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(37)]).then(n.bind(null,2123))))),We=Ue(Object(i.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(49)]).then(n.bind(null,2092))))),Qe=Ue(Object(i.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(66)]).then(n.bind(null,2139))))),Ye=Ue(Object(i.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(38)]).then(n.bind(null,2093))))),Ke=Ue(Object(i.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(67)]).then(n.bind(null,2094))))),Ze=Ue(Object(i.lazy)((()=>n.e(64).then(n.bind(null,2119))))),Xe=Object(i.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:r,showTimeline:s})=>{const{isTimelineEsqlEnabledByFeatureFlag:l,isEsqlAdvancedSettingEnabled:c}=Object(De.a)(),u=Object(Ie.b)((e=>Object(Y.selectTimelineESQLSavedSearchId)(e,a))),d=Object(i.useMemo)((()=>!!l&&(c||null!=u)),[c,l,u]),p=Object(i.useCallback)((e=>{switch(e){case le.d.graph:return o.a.createElement(We,{timelineId:a});case le.d.notes:return o.a.createElement(Qe,{timelineId:a});case le.d.session:return o.a.createElement(Ke,{timelineId:a});default:return null}}),[a]),m=Object(i.useMemo)((()=>[le.d.graph,le.d.notes,le.d.session].includes(e)),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ve,{$isVisible:le.d.query===e,"data-test-subj":`timeline-tab-content-${le.d.query}`},o.a.createElement(Ge,{renderCellValue:t,rowRenderers:n,timelineId:a})),s&&d&&e===le.d.esql&&o.a.createElement(Ve,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${le.d.esql}`},o.a.createElement(Ze,{timelineId:a})),o.a.createElement(Ve,{$isVisible:le.d.pinned===e,"data-test-subj":`timeline-tab-content-${le.d.pinned}`},o.a.createElement(Ye,{renderCellValue:t,rowRenderers:n,timelineId:a})),r===x.m.default&&o.a.createElement(Ve,{$isVisible:le.d.eql===e,"data-test-subj":`timeline-tab-content-${le.d.eql}`},o.a.createElement(He,{renderCellValue:t,rowRenderers:n,timelineId:a})),o.a.createElement(Ve,{$isVisible:m,isOverflowYScroll:e===le.d.session,"data-test-subj":`timeline-tab-content-${le.d.graph}-${le.d.notes}`},m&&p(e)))}));Xe.displayName="ActiveTimelineTab";const Je=c()(r.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1fs16o3-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),et=c()(r.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1fs16o3-2"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),tt=c()(r.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1fs16o3-3"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),nt=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:l,timelineType:c,graphEventId:u,sessionViewConfig:d,timelineDescription:p})=>{const f=Object(s.useDispatch)(),g=Object(i.useMemo)((()=>Object(Ae.a)()),[]),b=Object(i.useMemo)((()=>Object(Ae.g)()),[]),y=Object(i.useMemo)((()=>Object(Ae.e)()),[]),h=Object(i.useMemo)((()=>Object(Ae.d)()),[]),v=Object(i.useMemo)((()=>Object(Ae.c)()),[]),E=Object(i.useMemo)((()=>Object(Ae.b)()),[]),{isEsqlAdvancedSettingEnabled:j,isTimelineEsqlEnabledByFeatureFlag:O}=Object(De.a)(),S=Object(Ie.b)((e=>Object(Y.selectTimelineESQLSavedSearchId)(e,n))),w=Object(Ie.b)((e=>g(e,n))),k=Object(Ie.b)((e=>b(e,n))),I=Object(i.useMemo)((()=>!!O&&(j||null!=S)),[j,O,S]),T=Object(Ie.b)((e=>y(e,n))),C=Object(Ie.a)((e=>v(e,n))),M=Object(Ie.a)((e=>E(e,n))),_=Object(Ie.a)((e=>h(e))),D=Object($e.b)().isEnterprise(),N=Object(i.useMemo)((()=>{const e=Object.values(M).reduce(((e,t)=>[...e,...t]),[]);return[...C,...e]}),[C,M]),A=Object(i.useMemo)((()=>_.filter((e=>N.includes(e.id))).length+(Object(a.isEmpty)(p)?0:1)),[_,N,p]),F=Object(i.useCallback)((e=>{f(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[f,n]),P=Object(i.useCallback)((()=>{F(le.d.query)}),[F]),R=Object(i.useCallback)((()=>{F(le.d.eql)}),[F]),L=Object(i.useCallback)((()=>{F(le.d.graph)}),[F]),q=Object(i.useCallback)((()=>{F(le.d.notes)}),[F]),z=Object(i.useCallback)((()=>{F(le.d.pinned)}),[F]),B=Object(i.useCallback)((()=>{F(le.d.session)}),[F]),$=Object(i.useCallback)((()=>{f(Object(se.initializeTimelineSettings)({id:n})),F(le.d.esql)}),[F,f,n]);return Object(i.useEffect)((()=>{u||w!==le.d.graph||P()}),[w,u,P]),o.a.createElement(o.a.Fragment,null,!l&&o.a.createElement(tt,{className:"eui-scrollBar"},o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.query}`,onClick:P,isSelected:w===le.d.query,disabled:!1,key:le.d.query},o.a.createElement("span",null,Fe),k&&o.a.createElement(Ne.b,null)),I&&o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.esql}`,onClick:$,isSelected:w===le.d.esql,disabled:!1,key:le.d.esql},o.a.createElement("span",null,ze)),c===x.m.default&&o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.eql}`,onClick:R,isSelected:w===le.d.eql,disabled:!1,key:le.d.eql},o.a.createElement("span",null,Pe),k&&o.a.createElement(Ne.a,null)),o.a.createElement(r.EuiTab,{"data-test-subj":`timelineTabs-${le.d.graph}`,onClick:L,isSelected:w===le.d.graph,disabled:!u,key:le.d.graph},Re),D&&o.a.createElement(r.EuiTab,{"data-test-subj":`timelineTabs-${le.d.session}`,onClick:B,isSelected:w===le.d.session,disabled:null===d,key:le.d.session},Be),o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.notes}`,onClick:q,isSelected:w===le.d.notes,disabled:c===x.m.template,key:le.d.notes},o.a.createElement("span",null,Le),k&&A>0&&c===x.m.default&&o.a.createElement("div",null,o.a.createElement(Je,null,A))),o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.pinned}`,onClick:z,disabled:c===x.m.template,isSelected:w===le.d.pinned,key:le.d.pinned},o.a.createElement("span",null,qe),k&&T>0&&c===x.m.default&&o.a.createElement("div",null,o.a.createElement(Je,null,T)))),o.a.createElement(Xe,{activeTimelineTab:w,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:c,timelineDescription:p,showTimeline:k}))},at=Object(i.memo)(nt);var rt=n(180),it=n(206),ot=n(583),st=n(48),lt=n(58),ct=n(198),ut=n(148),dt=n(768),pt=n(651);const mt=e=>{var t;const{activeTab:n,switchToTab:a,timelineType:s}=e,{services:{storage:l}}=Object(Z.j)(),c=Object(i.useMemo)((()=>v.b.filter((e=>!e.timelineType||e.timelineType===s))),[s]),[u,d]=Object(i.useState)((()=>{const e=l.get(oe.cc.TIMELINE);return null!=e?e:v.c})),p=Object(i.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),m=Object(i.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(i.useEffect)((()=>{l.set(oe.cc.TIMELINE,u)}),[u,l]);const f=Object(i.useCallback)((e=>e===c.length?o.a.createElement(r.EuiButton,{color:"success",size:"s",onClick:p},pt.h):[o.a.createElement(r.EuiButtonEmpty,{size:"s",color:"text",onClick:p},pt.g),o.a.createElement(r.EuiButton,{color:"success",size:"s",onClick:m},pt.j)]),[p,m,c.length]),g=null===(t=c[u.currentTourStep-1])||void 0===t?void 0:t.anchor,b=Object(dt.a)(g),y=c[u.currentTourStep-1];return null!=y&&y.timelineTab&&y.timelineTab!==n&&a(y.timelineTab),u.isTourActive&&b?o.a.createElement(o.a.Fragment,null,c.map(((e,t)=>{const n=t+1;if(u.currentTourStep!==n)return null;const a={"data-test-subj":`timeline-tour-step-${t+1}`};return o.a.createElement(r.EuiTourStep,{panelProps:a,key:t,step:n,isStepOpen:u.isTourActive&&u.currentTourStep===t+1,minWidth:u.tourPopoverWidth,stepsTotal:c.length,onFinish:p,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:v.c.tourSubtitle,footerAction:f(n)})}))):null},ft=o.a.memo(mt);var gt=n(274);const bt=c.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),yt=c.a.div.withConfig({displayName:"TimelineBody",componentId:"sc-4r2lej-1"})(["height:100%;display:flex;flex-direction:column;"]),ht=Object(i.createContext)({timelineId:null}),vt=({timelineId:e})=>{const t=Object(i.useMemo)((()=>m.b.getTimelineByIdSelector()),[]);return Object(Ie.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:f.b).isSaving}))?o.a.createElement(r.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Et=o.a.memo(vt),xt=({renderCellValue:e,rowRenderers:t,timelineId:n,openToggleRef:l})=>{const c=Object(s.useDispatch)(),y=Object(d.a)("unifiedComponentsInTimelineDisabled"),h=Object(i.useRef)(null),v=Object(i.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),E=Object(s.useSelector)((e=>ut.e.sourcererScopeSelectedPatterns(e,b.SourcererScopeName.timeline))),j=Object(s.useSelector)((e=>ut.e.sourcererScopeSelectedDataViewId(e,b.SourcererScopeName.timeline))),{dataViewId:O,indexNames:S,graphEventId:w,savedObjectId:k,timelineType:I,description:T,sessionViewConfig:C,initialized:M,show:_,isLoading:D,activeTab:N}=Object(Ie.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=v(e,n))&&void 0!==t?t:f.b)})),{kibanaSecuritySolutionsPrivileges:{crud:A}}=Object(p.a)(),{timelineFullScreen:F}=Object(it.c)();Object(i.useEffect)((()=>{k||M||c(m.a.createTimeline({id:n,columns:y?g.b:gt.a,dataViewId:j,indexNames:E,show:!1,excludedRowRendererIds:y?[]:f.b.excludedRowRendererIds}))}),[]);const P=Object(i.useCallback)((()=>{!k||null==j||null===O&&0===S.length||O===j&&S.sort().join()===E.sort().join()||c(m.a.updateDataView({dataViewId:j,id:n,indexNames:E}))}),[c,k,j,O,E,S,n]);Object(i.useEffect)((()=>{P()}),[j,E]);const R=Object(i.useCallback)((()=>{var e;const t=null===(e=h.current)||void 0===e?void 0:e.querySelector(ot.a);var n,a;null!=t?t.focus():null===(n=h.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[h]),L=Object(i.useCallback)((()=>{var e,t;null===(e=h.current)||void 0===e||null===(t=e.querySelector(`.${Te.c}`))||void 0===t||t.focus()}),[h]),q=Object(i.useCallback)((e=>{Object(u.isTab)(e)&&Object(Te.k)({containerElement:h.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:R,onSkipFocusAfterEventsTable:L})}),[h,R,L]),z=Object(i.useMemo)((()=>({timelineId:n})),[n]),B=(()=>{const{search:e,pathname:t}=Object(st.useLocation)(),{spaces:n}=Object(Z.j)().services,a=Object(i.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:s,savedObjectId:l,show:c,graphEventId:u,activeTab:d}=Object(Ie.a)((e=>{var t;return null!==(t=a(e,le.c.active))&&void 0!==t?t:f.b})),p=Object(i.useCallback)((()=>{var a,i,p;const m=new URLSearchParams(e),f=null!==(a=m.get(ct.a.timeline))&&void 0!==a?a:void 0,g={id:null!=l?l:"",isOpen:!!c,activeTab:d,graphEventId:u},b=null!==(i=Object(lt.safeDecode)(null!=f?f:""))&&void 0!==i?i:g,y=null==b?void 0:b.id;if(!n||"conflict"!==(null==s?void 0:s.outcome)||null==(null==s?void 0:s.alias_target_id)||null==y)return null;const h=null!==(p=null==s?void 0:s.alias_target_id)&&void 0!==p?p:"",v={...b,id:h},E=Object(lt.encode)(v);m.set(ct.a.timeline,E);const x=`${t}?${m.toString()}${window.location.hash}`;return o.a.createElement(o.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:ct.a.timeline,currentObjectId:y,otherObjectId:h,otherObjectPath:x}),o.a.createElement(r.EuiSpacer,null))}),[d,u,t,null==s?void 0:s.alias_target_id,null==s?void 0:s.outcome,l,e,c,n]);return Object(i.useMemo)((()=>p()),[p])})(),$=_&&!D&&A,V=Object(i.useCallback)((e=>{c(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[n,c]);return o.a.createElement(ht.Provider,{value:z},o.a.createElement(rt.B,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:q,ref:h},o.a.createElement(Et,{timelineId:n}),o.a.createElement(yt,{"data-test-subj":"timeline-body"},I===x.m.template&&o.a.createElement(bt,{className:"timeline-template-badge"},Ce.f),B,o.a.createElement(rt.y,{$isVisible:!F,"data-test-subj":"timeline-hide-show-container"},o.a.createElement(Se,{timelineId:n,openToggleRef:l})),o.a.createElement(at,{graphEventId:w,sessionViewConfig:C,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:I,timelineDescription:T,timelineFullScreen:F}))),$?o.a.createElement(ft,{activeTab:N,switchToTab:V,timelineType:I}):null)};xt.displayName="StatefulTimelineComponent";const jt=o.a.memo(xt)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var a=n(19),r=n(2),i=n.n(r),o=n(44),s=n(629),l=n(630);const c=i.a.memo((({contextId:e,eventId:t,isDraggable:n,tlsClientCertificateFingerprintSha1:r,tlsFingerprintsJa3Hash:c,tlsServerCertificateFingerprintSha1:u})=>i.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"fingerprints-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=c?Object(o.uniq)(c).map((r=>i.a.createElement(a.EuiFlexItem,{grow:!1,key:r},i.a.createElement(l.b,{eventId:t,fieldName:l.a,contextId:e,isDraggable:n,value:r})))):null,null!=r?Object(o.uniq)(r).map((r=>i.a.createElement(a.EuiFlexItem,{grow:!1,key:r},i.a.createElement(s.a,{eventId:t,certificateType:"client",contextId:e,fieldName:s.b,isDraggable:n,value:r})))):null,null!=u?Object(o.uniq)(u).map((r=>i.a.createElement(a.EuiFlexItem,{grow:!1,key:r},i.a.createElement(s.a,{eventId:t,certificateType:"server",contextId:e,fieldName:s.c,isDraggable:n,value:r})))):null)));c.displayName="Fingerprints";var u=n(41),d=n.n(u),p=n(137),m=n(134),f=n(486);const g="questionInCircle",b=e=>{if(null==e)return g;switch(`${e}`.toLowerCase()){case p.l.outbound:case p.l.outgoing:return"arrowUp";case p.l.inbound:case p.l.incoming:case p.l.listening:return"arrowDown";case p.l.external:return"globe";case p.l.internal:return"bullseye";case p.l.unknown:default:return g}},y=i.a.memo((({contextId:e,eventId:t,direction:n,isDraggable:a})=>i.a.createElement(m.c,{contextId:e,eventId:t,field:f.c,iconType:b(n),isDraggable:a,value:n,isAggregatable:!0,fieldType:"keyword"})));y.displayName="DirectionBadge";var h=n(832),v=n(665);const E=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-10udnrm-0"})(["margin-right:3px;"]);E.displayName="EuiFlexItemMarginRight";const x=d()(a.EuiText).withConfig({displayName:"Stats",componentId:"sc-10udnrm-1"})(["margin:0 5px;"]);x.displayName="Stats";const j=i.a.memo((({bytes:e,communityId:t,contextId:n,direction:r,eventId:s,isDraggable:l,packets:c,protocol:u,transport:d})=>i.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none"},null!=r?Object(o.uniq)(r).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(y,{contextId:n,direction:e,eventId:s,isDraggable:l})))):null,null!=u?Object(o.uniq)(u).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.c,{contextId:n,eventId:s,field:f.e,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=e?Object(o.uniq)(e).map((e=>isNaN(Number(e))?null:i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.b,{field:f.a,id:`network-default-draggable-${n}-${s}-${f.a}-${e}`,isDraggable:l,value:e},i.a.createElement(x,{size:"xs"},i.a.createElement("span",null,i.a.createElement(v.a,{value:e}))))))):null,null!=c?Object(o.uniq)(c).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.b,{field:f.d,id:`network-default-draggable-${n}-${s}-${f.d}-${e}`,isDraggable:l,value:e},i.a.createElement(x,{size:"xs"},i.a.createElement("span",null,`${e} ${h.a}`)))))):null,null!=d?Object(o.uniq)(d).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.c,{contextId:n,"data-test-subj":"network-transport",eventId:s,field:f.f,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=t?Object(o.uniq)(t).map((e=>i.a.createElement(a.EuiFlexItem,{grow:!1,key:e},i.a.createElement(m.c,{contextId:n,eventId:s,field:f.b,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null)));j.displayName="Network";var O=n(569),S=n(188),w=n.n(S),k=n(406),I=n(1102),T=n(382),C=n(434),M=n(591);const _=d.a.span.withConfig({displayName:"IpPortSeparator",componentId:"sc-12b0nt-0"})(["margin:0 3px;"]);_.displayName="IpPortSeparator";const D=i.a.memo((({contextId:e,eventId:t,isDraggable:n,port:r,portFieldName:o})=>null!=r?i.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(_,{"data-test-subj":"ip-port-separator"},":")),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:t,fieldName:o,isDraggable:n,value:r}))):null));D.displayName="PortWithSeparator";const N=i.a.memo((({contextId:e,eventId:t,ip:n,ipFieldName:r,isDraggable:o,port:s,portFieldName:l})=>i.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(k.c,{contextId:e,"data-test-subj":"ip",eventId:t,fieldName:r,isDraggable:o,value:n})),i.a.createElement(a.EuiFlexItem,null,i.a.createElement(D,{contextId:e,eventId:t,isDraggable:o,port:s,portFieldName:l})))));N.displayName="IpWithPort";const A=d.a.div.withConfig({displayName:"Label",componentId:"sc-1ym4dlz-0"})(["font-weight:bold;margin-top:2px;"]),F=({destinationIp:e,sourceIp:t,type:n})=>"source"===n&&null!=t&&t.some((e=>!Object(o.isEmpty)(e)))||"destination"===n&&null!=e&&e.some((e=>!Object(o.isEmpty)(e))),P=({destinationPort:e,sourcePort:t,type:n})=>("source"===n&&null!=t?t:"destination"===n&&null!=e?e:[]).filter((e=>null!=e)).map((e=>`${e}`)).filter((e=>!Object(o.isEmpty)(e))),R=i.a.memo((({contextId:e,destinationIp:t,destinationPort:n,eventId:r,isDraggable:s,sourceIp:l,sourcePort:c,type:u})=>{const d="source"===u?l:t,p="source"===u?k.d:k.a,m="source"===u?c:n,f="source"===u?T.c:T.a;if(null==d)return null;const g=null!=m&&d.length===m.length?d.map(((e,t)=>({ip:e,port:null!=m[t]?`${m[t]}`:null}))):d.map((e=>({ip:e,port:null})));return i.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},Object(o.uniqWith)(w.a,g).map((t=>null!=t.ip&&i.a.createElement(a.EuiFlexItem,{grow:!1,key:t.ip},i.a.createElement(N,{contextId:e,"data-test-subj":`${u}-ip-and-port`,eventId:r,ip:t.ip,ipFieldName:p,isDraggable:s,port:t.port,portFieldName:f})))))}));R.displayName="IpAdressesWithPorts";const L=i.a.memo((({contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:n,destinationGeoCountryIsoCode:r,destinationGeoRegionName:o,destinationGeoCityName:s,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:f,sourceGeoRegionName:g,sourceGeoCityName:b,sourceIp:y,sourcePort:h,type:v})=>{const E="source"===v?C.i:C.c;return F({destinationIp:l,sourceIp:y,type:v})||(({destinationPort:e,sourcePort:t,type:n})=>P({destinationPort:e,sourcePort:t,type:n}).length>0)({destinationPort:c,sourcePort:h,type:v})?i.a.createElement(a.EuiBadge,{"data-test-subj":`${v}-ip-badge`,color:"hollow",title:""},i.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":`${v}-ip-group`,direction:"column",gutterSize:"xs"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(A,null,E)),i.a.createElement(a.EuiFlexItem,{grow:!1},F({destinationIp:l,sourceIp:y,type:v})?i.a.createElement(R,{contextId:e,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceIp:y,sourcePort:h,type:v}):i.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},P({destinationPort:c,sourcePort:h,type:v}).map(((t,n)=>i.a.createElement(a.EuiFlexItem,{key:`port-${t}-${n}`,grow:!1},i.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:u,fieldName:`${v}.port`,isDraggable:d,value:t})))))),i.a.createElement(a.EuiFlexItem,null,i.a.createElement(M.f,{contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:n,destinationGeoCountryIsoCode:r,destinationGeoRegionName:o,destinationGeoCityName:s,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:f,sourceGeoRegionName:g,sourceGeoCityName:b,type:v})))):null}));L.displayName="SourceDestinationIp";const q=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:f,sourceGeoContinentName:g,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourcePackets:E,sourceIp:x,sourcePort:j})=>i.a.createElement(a.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(L,{contextId:e,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:j,type:"source"})),i.a.createElement(O.e,{contextId:e,destinationBytes:t,destinationPackets:u,eventId:p,isDraggable:m,sourceBytes:f,sourcePackets:E}),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(L,{contextId:e,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:j,type:"destination"})))));q.displayName="SourceDestinationWithArrows";const z=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginTop",componentId:"sc-ru6rd-0"})(["margin-top:3px;"]);z.displayName="EuiFlexItemMarginTop";const B=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,networkBytes:f,networkCommunityId:g,networkDirection:b,networkPackets:y,networkProtocol:h,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:O,sourceGeoRegionName:S,sourceGeoCityName:w,sourceIp:k,sourcePackets:I,sourcePort:T,transport:C})=>i.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"column",justifyContent:"center",gutterSize:"none"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(j,{bytes:f,packets:y,communityId:g,contextId:e,direction:b,eventId:p,isDraggable:m,protocol:h,transport:C})),i.a.createElement(z,{grow:!1},i.a.createElement(q,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:O,sourceGeoRegionName:S,sourceGeoCityName:w,sourceIp:k,sourcePackets:I,sourcePort:T})))));B.displayName="SourceDestination";var $=n(592),V=n(835);const U=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-ub9rva-0"})(["margin-right:10px;"]);U.displayName="EuiFlexItemMarginRight";const G=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventDuration:p,eventId:m,eventEnd:f,eventStart:g,isDraggable:b,networkBytes:y,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,processName:j,sourceBytes:O,sourceGeoContinentName:S,sourceGeoCountryName:w,sourceGeoCountryIsoCode:k,sourceGeoRegionName:I,sourceGeoCityName:T,sourceIp:C,sourcePackets:M,sourcePort:_,transport:D,userName:N})=>i.a.createElement(a.EuiFlexGroup,{"data-test-subj":"netflow-columns",gutterSize:"none",justifyContent:"center",wrap:!0},i.a.createElement(U,{grow:!1},i.a.createElement(V.c,{contextId:e,eventId:m,isDraggable:b,processName:j,userName:N})),i.a.createElement(U,{grow:!1},i.a.createElement($.a,{contextId:e,eventDuration:p,eventId:m,eventEnd:f,eventStart:g,isDraggable:b})),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(B,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:m,isDraggable:b,networkBytes:y,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,sourceBytes:O,sourceGeoContinentName:S,sourceGeoCountryName:w,sourceGeoCountryIsoCode:k,sourceGeoRegionName:I,sourceGeoCityName:T,sourceIp:C,sourcePackets:M,sourcePort:_,transport:D})))));G.displayName="NetflowColumns";const H=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:f,eventEnd:g,eventStart:b,isDraggable:y,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:j,processName:O,sourceBytes:S,sourceGeoContinentName:w,sourceGeoCountryName:k,sourceGeoCountryIsoCode:I,sourceGeoRegionName:T,sourceGeoCityName:C,sourcePackets:M,sourceIp:_,sourcePort:D,tlsClientCertificateFingerprintSha1:N,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:F,transport:P,userName:R})=>i.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"netflow-rows",direction:"column",justifyContent:"center",wrap:!0,gutterSize:"none"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(G,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:f,eventEnd:g,eventStart:b,isDraggable:y,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:j,processName:O,sourceBytes:S,sourceGeoContinentName:w,sourceGeoCountryName:k,sourceGeoCountryIsoCode:I,sourceGeoRegionName:T,sourceGeoCityName:C,sourceIp:_,sourcePackets:M,sourcePort:D,transport:P,userName:R})),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(c,{contextId:e,eventId:f,isDraggable:y,tlsClientCertificateFingerprintSha1:N,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:F})))));H.displayName="Netflow"},function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return w}));var a=n(2),r=n(4),i=n(19),o=n(1093),s=n(301);const l=new WeakMap;var c=n(52),u=n.n(c),d=n(480),p=n(43);function m({useTopLevelObjectColumns:e,row:t,columnId:n,dataView:s,shouldShowFieldHandler:c,maxEntries:m,isPlainRecord:f,fieldFormats:g,dataTestSubj:b="discoverCellDescriptionList",className:y}){const h=e?function(e,t,n,a){var r;const i=Object(d.b)(e.fields,t),o=null!==(r=e.highlight)&&void 0!==r?r:{},s=[],l=[];return Object.entries(i).forEach((([t,r])=>{var i;const c=n.getFieldByName(t),u=n.fields.getByName?null===(i=n.fields.getByName(t))||void 0===i?void 0:i.displayName:void 0,d=c?n.getFormatterForField(c):{convert:(e,...t)=>String(e)},p=r.map((t=>d.convert(t,"html",{field:c,hit:e}))).join(", "),m=o[t]?s:l;u?a(u)&&m.push([u,p,t]):m.push([t,p,t])})),[...s,...l]}(t.raw,n,s,c).slice(0,m):function(e,t,n,a,i){var s;const c=l.get(e.raw);if(c&&c.maxEntries===a)return c.formattedHit;const u=null!==(s=e.raw.highlight)&&void 0!==s?s:{},d=e.flattened,p=[],m=[];Object.entries(d).forEach((([a,r])=>{const s=t.fields.getByName(a),l=null==s?void 0:s.displayName,c=u[a]?p:m,d=Object(o.a)(r,e.raw,i,t,s);l?n(a)&&c.push([l,d,a]):c.push([a,d,a])}));const f=[...p,...m],g=f.length<=a?f:[...f.slice(0,a),[r.i18n.translate("discover.formatHit.moreFields",{defaultMessage:"and {count} more {count, plural, one {field} other {fields}}",values:{count:f.length-a}}),"",null]];return l.set(e.raw,{formattedHit:g,maxEntries:a}),g}(t,s,c,m,g);return Object(p.jsx)(i.EuiDescriptionList,{type:"inline",compressed:!0,className:u()("unifiedDataTable__descriptionList","unifiedDataTable__cellValue",y),"data-test-subj":b},h.map((([e,n,r])=>{var o;return f&&r&&null===(null!==(o=t.flattened[r])&&void 0!==o?o:null)?null:Object(p.jsx)(a.Fragment,{key:e},Object(p.jsx)(i.EuiDescriptionListTitle,{className:"unifiedDataTable__descriptionListTitle"},e),Object(p.jsx)(i.EuiDescriptionListDescription,{className:"unifiedDataTable__descriptionListDescription",dangerouslySetInnerHTML:{__html:n}}))})))}n(654);var f=n(93),g=n(94);const b=r.i18n.translate("unifiedDataTable.json.codeEditorAriaLabel",{defaultMessage:"Read only JSON view of an elasticsearch document"}),y=r.i18n.translate("unifiedDataTable.json.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),h=({jsonValue:e,width:t,height:n,hasLineNumbers:a,onEditorDidMount:r,hideCopyButton:o})=>{if(""===e)return null;const s=Object(p.jsx)(g.CodeEditor,{languageId:f.XJsonLang.ID,width:t,height:n,value:e||"",editorDidMount:r,"aria-label":b,options:{automaticLayout:!0,fontSize:12,lineNumbers:a?"on":"off",minimap:{enabled:!1},overviewRulerBorder:!1,readOnly:!0,scrollbar:{alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent"}});return o?s:Object(p.jsx)(i.EuiFlexGroup,{className:"unifiedDataTableJsonEditor",direction:"column",gutterSize:"s"},Object(p.jsx)(i.EuiFlexItem,null,Object(p.jsx)(i.EuiSpacer,{size:"s"}),Object(p.jsx)("div",{className:"eui-textRight"},Object(p.jsx)(i.EuiCopy,{textToCopy:e},(e=>Object(p.jsx)(i.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},y))))),Object(p.jsx)(i.EuiFlexItem,null,s))};function v({json:e,width:t,height:n,hasLineNumbers:a}){const r=JSON.stringify(e,null,2);return Object(p.jsx)(h,{jsonValue:r,width:t,height:n,hasLineNumbers:a,onEditorDidMount:()=>{},hideCopyButton:!0})}var E=n(225);function x(e,t,n){return n?Object(d.b)(t.raw.fields,e):t.raw}var j=({closeButton:e,columnId:t,row:n,useTopLevelObjectColumns:a,dataTestSubj:r="dataTableExpandCellActionJsonPopover"})=>Object(p.jsx)(i.EuiFlexGroup,{gutterSize:"none",direction:"column",justifyContent:"flexEnd",className:"unifiedDataTable__cellPopover","data-test-subj":r},Object(p.jsx)(i.EuiFlexItem,{grow:!1},Object(p.jsx)(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",responsive:!1},Object(p.jsx)(i.EuiFlexItem,{grow:!1},e))),Object(p.jsx)(i.EuiFlexItem,null,Object(p.jsx)(v,{json:x(t,n,a),width:E.f,height:200})));const O=({children:e})=>Object(p.jsx)("span",{className:"unifiedDataTable__cellPopoverValue eui-textBreakWord"},e),S="unifiedDataTable__cellValue",w=({dataView:e,rows:t,useNewFieldsApi:n,shouldShowFieldHandler:l,closePopover:c,fieldFormats:u,maxEntries:d,externalCustomRenderers:f,isPlainRecord:g})=>function({rowIndex:b,columnId:y,isDetails:h,setCellProps:v,colIndex:E,isExpandable:x,isExpanded:w}){const k=t?t[b]:void 0,I=e.fields.getByName(y),T=Object(a.useContext)(s.a);if(Object(a.useEffect)((()=>{null!=k&&k.isAnchor?v({className:"unifiedDataTable__cell--highlight"}):T.expanded&&k&&T.expanded.id===k.id?v({className:"unifiedDataTable__cell--expanded"}):v({style:void 0})}),[T,k,v]),void 0===k)return Object(p.jsx)("span",{className:S},"-");if(f&&f[y])return Object(p.jsx)("span",{className:S},f[y]({rowIndex:b,columnId:y,isDetails:h,setCellProps:v,isExpandable:x,isExpanded:w,colIndex:E,row:k,dataView:e,fieldFormats:u,closePopover:c}));const C=Boolean(n&&!I&&(null==k?void 0:k.raw.fields)&&!k.raw.fields[y]);return h?function({row:e,field:t,columnId:n,dataView:a,useTopLevelObjectColumns:s,fieldFormats:l,closePopover:c}){const u=Object(p.jsx)(i.EuiButtonIcon,{"aria-label":r.i18n.translate("unifiedDataTable.grid.closePopover",{defaultMessage:"Close popover"}),"data-test-subj":"docTableClosePopover",iconSize:"s",iconType:"cross",size:"xs",onClick:c});return s||"_source"===(null==t?void 0:t.type)?Object(p.jsx)(j,{row:e,columnId:n,useTopLevelObjectColumns:s,closeButton:u}):Object(p.jsx)(i.EuiFlexGroup,{gutterSize:"none",direction:"row",responsive:!1,"data-test-subj":"dataTableExpandCellActionPopover"},Object(p.jsx)(i.EuiFlexItem,null,Object(p.jsx)(O,null,Object(p.jsx)("span",{dangerouslySetInnerHTML:{__html:Object(o.a)(e.flattened[n],e.raw,l,a,t)}}))),Object(p.jsx)(i.EuiFlexItem,{grow:!1},u))}({row:k,field:I,columnId:y,dataView:e,useTopLevelObjectColumns:C,fieldFormats:u,closePopover:c}):"_source"===(null==I?void 0:I.type)||C?Object(p.jsx)(m,{useTopLevelObjectColumns:C,row:k,dataView:e,columnId:y,fieldFormats:u,shouldShowFieldHandler:l,maxEntries:d,isPlainRecord:g}):Object(p.jsx)("span",{className:S,dangerouslySetInnerHTML:{__html:Object(o.a)(k.flattened[y],k.raw,u,e,I)}})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n(121),r=n(7),i=n(41),o=n.n(i),s=n(5),l=n(195);const c=o.a.div.withConfig({displayName:"HorizontalSpacer",componentId:"sc-1o769t7-0"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeXS));var u=n(19),d=n(2),p=n.n(d),m=n(590),f=n(315),g=n(44),b=n(42),y=n(134);const h=({contextId:e,eventId:t,isDraggable:n,sourceField:a,sourceValue:r})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-details-source-field",eventId:t,field:l.g,isDraggable:n,value:a,isAggregatable:!0,fieldType:"keyword"})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,p.a.createElement(b.FormattedMessage,{defaultMessage:"matched",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.matchedVerb"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-details-source-value",eventId:t,field:a,isDraggable:n,value:r,isAggregatable:!0,fieldType:"keyword"})));var v=n(422);const E=({contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:r,isDraggable:i})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"threat-match-indicator-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},r&&p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-type",eventId:t,field:l.h,isDraggable:i,value:r,isAggregatable:!0,fieldType:"keyword"})),n&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1,component:"span"},p.a.createElement(c,null,p.a.createElement(b.FormattedMessage,{defaultMessage:"provided by",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.providerPreposition"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-feedName",eventId:t,field:l.e,isDraggable:i,value:n,isAggregatable:!0,fieldType:"keyword"}))),a&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,":")),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(v.a,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-reference",eventId:t,fieldName:l.j,isDraggable:i,value:a,isAggregatable:!0,fieldType:"keyword"})))),x=({contextId:e,data:t,eventId:n,isDraggable:a})=>{const r={contextId:e,eventId:n,indicatorReference:Object(g.getOr)([],l.p,t)[0],feedName:Object(g.getOr)([],l.e,t)[0],indicatorType:Object(g.getOr)([],l.n,t)[0],isDraggable:a,sourceField:Object(g.get)(l.l,t)[0],sourceValue:Object(g.get)(l.k,t)[0]};return p.a.createElement(j,r)},j=({contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:r,isDraggable:i,sourceField:o,sourceValue:s})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-row",gutterSize:"s",justifyContent:"center"},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(h,{contextId:e,eventId:t,isDraggable:i,sourceField:o,sourceValue:s})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(E,{contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:r,isDraggable:i})));var O=n(434);const S=o.a.div.withConfig({displayName:"SpacedContainer",componentId:"sc-e4rhpb-0"})(["margin:"," 0;"],(({theme:e})=>e.eui.euiSizeS)),w=({data:e,isDraggable:t,scopeId:n})=>{const a=Object(r.get)(e,s.yb),i=Object(r.get)(e,m.a),o=Object(d.useCallback)(((e="max")=>{const r="max"===e?a.slice(0,2):a;return p.a.createElement(f.a,{"data-test-subj":"threat-match-row-renderer"},p.a.createElement(S,null,r.map(((e,r)=>{const o=`threat-match-row-${n}-${i}-${r}`;return p.a.createElement(d.Fragment,{key:o},p.a.createElement(x,{contextId:o,data:e,eventId:i,isDraggable:t}),r<a.length-1&&p.a.createElement(u.EuiHorizontalRule,{margin:"s"}))}))))}),[a,i,t,n]),l=Object(d.useCallback)((()=>o("all")),[o]);return p.a.createElement(u.EuiFlexGroup,{direction:"column",justifyContent:"center",alignItems:"center",gutterSize:"none"},p.a.createElement(u.EuiFlexItem,null,o()),a.length>2&&p.a.createElement(u.EuiFlexItem,null,p.a.createElement(k,{title:Object(O.h)(a.length),renderChildren:l})))},k=({title:e,renderChildren:t})=>{const[n,a]=Object(d.useState)(!1),r=()=>a(!1);let i;return n&&(i=p.a.createElement(u.EuiModal,{onClose:r},p.a.createElement(u.EuiModalHeader,{"data-test-subj":"threat-match-row-modal"},p.a.createElement(u.EuiModalHeaderTitle,null,O.b)),p.a.createElement(u.EuiModalBody,null,t()),p.a.createElement(u.EuiModalFooter,null,p.a.createElement(u.EuiButton,{onClick:r,fill:!0},O.a)))),p.a.createElement("div",null,p.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"threat-match-row-show-all",iconType:"popout",color:"primary",onClick:()=>a(!0)},e),i)},I={id:a.e.threat_match,isInstance:e=>(e=>{const t=Object(r.get)(e,s.yb);return null==t?[]:Array.isArray(t)?t:[t]})(e).some((e=>l.i.some((t=>!Object(r.isEmpty)(Object(r.get)(e,t)))))),renderRow:({data:e,isDraggable:t,scopeId:n})=>p.a.createElement(w,{data:e,isDraggable:t,scopeId:n})}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var a=n(44),r=n(2),i=n.n(r),o=n(121),s=n(315),l=n(19),c=n(41),u=n.n(c),d=n(278),p=n(363),m=n(222),f=n(144),g=n(416),b=n(150);const y=["IPv4","IPv6"];var h=n(134),v=n(179);const E="suricata.eve.alert.signature",x="suricata.eve.alert.signature_id",j=u()(l.EuiFlexItem).withConfig({displayName:"SignatureFlexItem",componentId:"sc-1paeiel-0"})(["min-width:77px;"]);j.displayName="SignatureFlexItem";const O=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1paeiel-1"})(["vertical-align:top;"]);O.displayName="Badge";const S=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1paeiel-2"})(["margin-left:6px;"]);S.displayName="LinkFlexItem";const w=i.a.memo((({tokens:e})=>i.a.createElement(i.a.Fragment,null,e.map((e=>i.a.createElement(b.c,{key:e,grow:!1},i.a.createElement(l.EuiBadge,{iconType:"tag",color:"hollow",title:""},e)))))));w.displayName="Tokens";const k=i.a.memo((({id:e,isDraggable:t,signatureId:n})=>{const a=Object(r.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`suricata-draggable-signature-id-${e}-sig-${n}`),name:String(n),excluded:!1,kqlQuery:"",queryMatch:{field:x,value:n,operator:v.d}})),[e,n]),o=Object(r.useCallback)(((e,t,a)=>a.isDragging?i.a.createElement(p.a,null,i.a.createElement(g.a,{dataProvider:e})):i.a.createElement(l.EuiToolTip,{"data-test-subj":"signature-id-tooltip",content:x},i.a.createElement(O,{iconType:"number",color:"hollow",title:""},n))),[n]);return i.a.createElement(j,{grow:!1},i.a.createElement(p.b,{dataProvider:a,isDraggable:t,render:o,isAggregatable:!0,fieldType:"keyword"}))}));k.displayName="DraggableSignatureId";const I=i.a.memo((({contextId:e,id:t,isDraggable:n,signature:a,signatureId:r})=>{const o=(e=>e.trim().split(" ").reduce(((e,t,n)=>e.length===n&&t===t.toUpperCase()&&""!==t||y.includes(t)?[...e,t]:e),[]))(a);return i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(k,{id:`draggable-signature-id-${e}-${t}`,isDraggable:n,signatureId:r}),i.a.createElement(w,{tokens:o}),i.a.createElement(S,{grow:!1},i.a.createElement(h.b,{"data-test-subj":"draggable-signature-link",field:E,id:`suricata-signature-default-draggable-${e}-${t}-${E}`,isDraggable:n,value:a,tooltipPosition:"bottom"},i.a.createElement("div",null,i.a.createElement(f.c,{link:a},a.split(" ").splice(o.length).join(" "))))))}));I.displayName="SuricataSignature";const T=u()(l.EuiFlexItem).withConfig({displayName:"LinkEuiFlexItem",componentId:"sc-i69i1c-0"})(["display:inline;"]);T.displayName="LinkEuiFlexItem";const C=i.a.memo((({signatureId:e})=>{const[t,o]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{let t=!0;return async function(){if(null!=e)try{const r=await(async e=>{const t=(await n.e(25).then(n.t.bind(null,2097,7))).db,r=(i=t,o=e,Object.prototype.hasOwnProperty.call(i,o)?t[e]:null);var i,o;return null!=r?Object(a.uniq)(r):[]})(e);t&&null!=r&&o(r)}catch(e){o(void 0)}else t&&o(void 0)}(),()=>{t=!1}}),[e]),i.a.createElement(l.EuiFlexGroup,{"data-test-subj":"suricataRefs",gutterSize:"none",justifyContent:"center",wrap:!0},t&&t.map((e=>i.a.createElement(T,{key:e,grow:!1},i.a.createElement(l.EuiLink,{href:e,color:"subdued",target:"_blank"},e)))))}));C.displayName="SuricataRefs";const M=u.a.div.withConfig({displayName:"Details",componentId:"sc-1y9aljy-0"})(["margin:5px 0;"]);M.displayName="Details";const _=i.a.memo((({data:e,isDraggable:t,timelineId:n})=>{const r=Object(a.get)("suricata.eve.alert.signature[0]",e),o=Object(a.get)("suricata.eve.alert.signature_id[0]",e);return null!=o&&null!=r?i.a.createElement(M,null,i.a.createElement(I,{contextId:`suricata-signature-${n}-${e._id}`,id:e._id,isDraggable:t,signature:r,signatureId:o}),i.a.createElement(C,{signatureId:o}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:t,timelineId:n})):null}));_.displayName="SuricataDetails";const D={id:o.e.suricata,isInstance:e=>{const t=Object(a.get)("event.module[0]",e);return null!=t&&"suricata"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:n})=>i.a.createElement(s.a,null,i.a.createElement(_,{data:e,isDraggable:t,timelineId:n}))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var a=n(44),r=n(2),i=n.n(r),o=n(121),s=n(315),l=n(19),c=n(41),u=n.n(c),d=n(278),p=n(363),m=n(222),f=n(144),g=n(416),b=n(179),y=n(4);const h=y.i18n.translate("xpack.securitySolution.zeek.s0Description",{defaultMessage:"Connection attempt seen, no reply"}),v=y.i18n.translate("xpack.securitySolution.zeek.s1Description",{defaultMessage:"Connection established, not terminated"}),E=y.i18n.translate("xpack.securitySolution.zeek.s2Description",{defaultMessage:"Connection established and close attempt by originator seen (but no reply from responder)"}),x=y.i18n.translate("xpack.securitySolution.zeek.s3Description",{defaultMessage:"Connection established and close attempt by responder seen (but no reply from originator)"}),j=y.i18n.translate("xpack.securitySolution.zeek.sfDescription",{defaultMessage:"Normal SYN/FIN completion"}),O=y.i18n.translate("xpack.securitySolution.zeek.rejDescription",{defaultMessage:"Connection attempt rejected"}),S=y.i18n.translate("xpack.securitySolution.zeek.rstoODescription",{defaultMessage:"Connection established, originator aborted (sent a RST)"}),w=y.i18n.translate("xpack.securitySolution.zeek.rstrDescription",{defaultMessage:"Established, responder aborted"}),k=y.i18n.translate("xpack.securitySolution.zeek.rstosoDescription",{defaultMessage:"Originator sent a SYN followed by a RST, no SYN-ACK from the responder"}),I=y.i18n.translate("xpack.securitySolution.zeek.rstrhDescription",{defaultMessage:"Responder sent a SYN ACK followed by a RST, no SYN from the (purported) originator"}),T=y.i18n.translate("xpack.securitySolution.zeek.shDescription",{defaultMessage:"Originator sent a SYN followed by a FIN, no SYN ACK from the responder"}),C=y.i18n.translate("xpack.securitySolution.zeek.shrDescription",{defaultMessage:"Responder sent a SYN ACK followed by a FIN, no SYN from the originator"}),M=y.i18n.translate("xpack.securitySolution.zeek.othDescription",{defaultMessage:"No SYN seen, just midstream traffic"}),_=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1b5gq3p-0"})(["vertical-align:top;"]);_.displayName="Badge";const D=u()(l.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1b5gq3p-1"})(["margin-left:3px;"]);D.displayName="TokensFlexItem";const N=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1b5gq3p-2"})(["margin-left:6px;"]);N.displayName="LinkFlexItem";const A=e=>e,F=e=>{const t=e.split(".");return t.length>=2&&null!=t[1]?""!==t[1]?t[1]:t[0]:e},P=e=>`Dropped:${e}`,R=e=>`md5: ${e.substr(0,7)}...`,L=e=>`sha1: ${e.substr(0,7)}...`,q=i.a.memo((({id:e,field:t,isDraggable:n,value:a,stringRenderer:o=A})=>{const s=Object(r.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`draggable-zeek-element-draggable-wrapper-${e}-${t}-${a}`),name:String(a),excluded:!1,kqlQuery:"",queryMatch:{field:t,value:String(a),operator:b.d}})),[t,e,a]),c=Object(r.useCallback)(((e,n,r)=>r.isDragging?i.a.createElement(p.a,null,i.a.createElement(g.a,{dataProvider:e})):i.a.createElement(l.EuiToolTip,{"data-test-subj":"badge-tooltip",content:t},i.a.createElement(_,{iconType:"tag",color:"hollow",title:""},o(String(a))))),[t,o,a]);return null!=a?i.a.createElement(D,{grow:!1},i.a.createElement(p.b,{dataProvider:s,isDraggable:n,render:c,isAggregatable:!0,fieldType:"keyword"})):null}));q.displayName="DraggableZeekElement";const z=i.a.memo((({value:e,link:t})=>null!=e?null!=t?i.a.createElement(N,{grow:!1},i.a.createElement("div",null,i.a.createElement(f.c,{link:t},e))):i.a.createElement(N,{grow:!1},i.a.createElement("div",null,i.a.createElement(f.c,{link:e}))):null));z.displayName="Link";const B=i.a.memo((({value:e})=>null!=e?i.a.createElement(N,{grow:!1},i.a.createElement("div",null,i.a.createElement(f.j,{domain:e,overflowIndexStart:1,showDomain:!0,"data-test-subj":"reputationLinkSha"}))):null));B.displayName="TotalVirusLinkSha";const $={S0:h,S1:v,S2:E,S3:x,SF:j,REJ:O,RSTO:S,RSTR:w,RSTOS0:k,RSTRH:I,SH:T,SHR:C,OTH:M},V=i.a.memo((({data:e,isDraggable:t,timelineId:n})=>{const r=`zeek-signature-draggable-zeek-element-${n}-${e._id}`,o=Object(a.get)("zeek.session_id[0]",e),s=Object(a.get)("event.dataset[0]",e),c=Object(a.get)("zeek.ssl.version[0]",e),u=Object(a.get)("zeek.ssl.cipher[0]",e),d=Object(a.get)("zeek.connection.state[0]",e),p=Object(a.get)("zeek.connection.history[0]",e),m=Object(a.get)("zeek.notice.note[0]",e),f=Object(a.get)("zeek.notice.msg[0]",e),g=(e=>null!=e?String(e):null)(Object(a.get)("zeek.notice.dropped[0]",e)),b=Object(a.get)("zeek.dns.query[0]",e),y=Object(a.get)("zeek.dns.qclass_name[0]",e),h=Object(a.get)("http.request.method[0]",e),v=Object(a.get)("http.response.status_code[0]",e),E=Object(a.get)("url.original[0]",e),x=Object(a.get)("zeek.files.sha1[0]",e),j=Object(a.get)("zeek.files.md5[0]",e),O=(e=>{if(null!=e){const t=$[e];return null!=t?`${e} ${t}`:e}return null})(d),S=(e=>null!=e&&null!=$[e]?$[e]:null)(d);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(q,{id:r,field:"zeek.session_id",isDraggable:t,value:o}),i.a.createElement(q,{id:r,field:"event.dataset",isDraggable:t,value:s,stringRenderer:F}),i.a.createElement(q,{id:r,field:"zeek.files.sha1",isDraggable:t,value:x,stringRenderer:L}),i.a.createElement(q,{id:r,field:"zeek.files.md5",isDraggable:t,value:j,stringRenderer:R}),i.a.createElement(q,{id:r,field:"zeek.notice.dropped",isDraggable:t,value:g,stringRenderer:P}),i.a.createElement(q,{id:r,field:"zeek.ssl.version",isDraggable:t,value:c}),i.a.createElement(q,{id:r,field:"zeek.ssl.cipher",isDraggable:t,value:u}),i.a.createElement(q,{id:r,field:"zeek.connection.state",isDraggable:t,value:d}),i.a.createElement(q,{id:r,field:"http.request.method",isDraggable:t,value:h}),i.a.createElement(q,{id:r,field:"zeek.connection.history",isDraggable:t,value:p}),i.a.createElement(q,{id:r,field:"zeek.notice.note",isDraggable:t,value:m}),i.a.createElement(q,{id:r,field:"zeek.dns.query",isDraggable:t,value:b}),i.a.createElement(q,{id:r,field:"zeek.dns.qclass_name",isDraggable:t,value:y}),i.a.createElement(q,{id:r,field:"http.response.status_code",isDraggable:t,value:v})),i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(z,{link:O,value:S}),i.a.createElement(z,{value:u}),i.a.createElement(z,{value:b}),i.a.createElement(z,{value:f}),i.a.createElement(z,{value:E}),i.a.createElement(B,{value:x})))}));V.displayName="ZeekSignature";const U=u.a.div.withConfig({displayName:"Details",componentId:"sc-1ixpiaf-0"})(["margin:5px 0;"]);U.displayName="Details";const G=i.a.memo((({data:e,isDraggable:t,timelineId:n})=>null!=e.zeek?i.a.createElement(U,null,i.a.createElement(V,{data:e,isDraggable:t,timelineId:n}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:t,timelineId:n})):null));G.displayName="ZeekDetails";const H={id:o.e.zeek,isInstance:e=>{const t=Object(a.get)("event.module[0]",e);return null!=t&&"zeek"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:n})=>i.a.createElement(s.a,null,i.a.createElement(G,{data:e,isDraggable:t,timelineId:n}))}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n.n(a),i=n(19),o=n(7),s=n(4);const l=s.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.addToSelectedRulesDescription",{defaultMessage:"After you create the exception, it is added to the rules you link. "});var c=n(595),u=n(354);const d=Object(a.memo)((({rule:e,linkedRules:t,onRuleLinkChange:n})=>{const o=Object(a.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(a.useCallback)((({target:{checked:a}})=>{const r=a?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof n&&n(r)}),[t,n,e]);return r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSwitch,{onChange:s,label:"",checked:o}))}));d.displayName="LinkRuleSwitch";var p=n(781);const m=({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{isLoading:n,searchOptions:m,pagination:f,sortedRulesByLinkedRulesOnTop:g,rulesTableColumnsWithLinkSwitch:b,onTableChange:y,addToSelectedRulesDescription:h}=(({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{data:{rules:n}={rules:[],total:0},isFetched:i}=Object(p.a)({filterOptions:{filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:void 0,pagination:{page:1,perPage:1e4}}),[m,f]=Object(a.useState)({pageIndex:0,initialPageSize:25,showPerPageOptions:!1}),[g,b]=Object(a.useState)(e||[]);Object(a.useEffect)((()=>{t(g)}),[g,t]);const y=Object(a.useMemo)((()=>Object(o.sortBy)(n,[t=>null==e?void 0:e.find((e=>e.id===t.id))])),[e,n]),h=Object(a.useMemo)((()=>{const e=y.reduce(((e,t)=>{const{tags:n}=t;return n.forEach((t=>e.add(t))),e}),new Set);return Array.from(e).map((e=>({value:e,name:e,field:"tags"})))}),[y]),v=Object(a.useMemo)((()=>({box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",operator:"exact",name:s.i18n.translate("xpack.securitySolution.exceptions.addToRulesTable.tagsFilterLabel",{defaultMessage:"Tags"}),multiSelect:"or",options:h}]})),[h]),E=Object(a.useMemo)((()=>[{field:"link",name:c.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>r.a.createElement(d,{rule:t,linkedRules:g,onRuleLinkChange:b})},...Object(u.c)()]),[g]),x=Object(a.useCallback)((({page:{index:e}})=>f({...m,pageIndex:e})),[m]);return{isLoading:!i,pagination:m,searchOptions:v,sortedRulesByLinkedRulesOnTop:y,rulesTableColumnsWithLinkSwitch:E,addToSelectedRulesDescription:l,onTableChange:x}})({initiallySelectedRules:e,onRuleSelectionChange:t});return r.a.createElement(i.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"s"},h),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiInMemoryTable,{tableLayout:"auto",search:m,"data-test-subj":"addExceptionToRulesTable",tableCaption:"Rules table",items:g,loading:n,columns:b,message:n?r.a.createElement(i.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPromptsLoading"}):void 0,pagination:f,onTableChange:y})))},f=r.a.memo(m);f.displayName="ExceptionsAddToRulesTable"},,function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return h}));var a=n(2),r=n(45),i=n(68),o=n(57),s=n(719),l=n.n(s),c=n(582);const u={byId:{},needsSync:!1},d=Object(i.createReducer)(u,(e=>{e.addCase(c.f,((e,{payload:{preview:t,left:n,right:a,id:r}})=>{r in e.byId?(e.byId[r].right=a,e.byId[r].left=n,e.byId[r].preview=t?[t]:void 0):e.byId[r]={left:n,right:a,preview:t?[t]:void 0},e.needsSync=!0})),e.addCase(c.e,((e,{payload:{left:t,id:n}})=>{n in e.byId?e.byId[n].left=t:e.byId[n]={left:t,right:void 0,preview:void 0},e.needsSync=!0})),e.addCase(c.h,((e,{payload:{right:t,id:n}})=>{n in e.byId?e.byId[n].right=t:e.byId[n]={right:t,left:void 0,preview:void 0},e.needsSync=!0})),e.addCase(c.g,((e,{payload:{preview:t,id:n}})=>{if(n in e.byId)if(e.byId[n].preview){var a,r;l()(t,null===(a=e.byId[n].preview)||void 0===a?void 0:a.at(-1))||null===(r=e.byId[n].preview)||void 0===r||r.push(t)}else e.byId[n].preview=t?[t]:void 0;else e.byId[n]={right:void 0,left:void 0,preview:t?[t]:void 0};e.needsSync=!0})),e.addCase(c.i,((e,{payload:{id:t}})=>{var n;t in e.byId&&(null===(n=e.byId[t].preview)||void 0===n||n.pop()),e.needsSync=!1})),e.addCase(c.b,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0,e.byId[t].left=void 0,e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(c.a,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].left=void 0),e.needsSync=!0})),e.addCase(c.d,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0),e.needsSync=!0})),e.addCase(c.c,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(c.j,((e,{payload:{preview:t,left:n,right:a,id:r}})=>{r in e.byId?(e.byId[r].right=a,e.byId[r].left=n,e.byId[r].preview=t?[t]:void 0):e.byId[r]={right:a,left:n,preview:t?[t]:void 0},e.needsSync=!1}))})),p=Object(i.configureStore)({reducer:d,devTools:!1,enhancers:[]}),m=Object(a.createContext)({store:p,storeState:u}),f=Object(r.createDispatchHook)(m),g=Object(r.createSelectorHook)(m),b=e=>e,y=e=>Object(o.createSelector)(b,(t=>t.byId[e]||{})),h=()=>Object(o.createSelector)(b,(e=>e.needsSync))},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(19),l=n(532),c=n(252),u=n(403),d=n(1555),p=n(4);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.sectionTitle",{defaultMessage:"Alerts actions"}),f=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.singleAlertCloseLabel",{defaultMessage:"Close this alert"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),b=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by selected rule/s"}),y=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),h=o.a.section.withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-1ggwgok-0"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),v=o()(s.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1ggwgok-1"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),E=({isAlertDataLoading:e,exceptionListItems:t,exceptionListType:n,shouldCloseSingleAlert:i,shouldBulkCloseAlert:o,disableBulkClose:p,alertData:E,alertStatus:x,onDisableBulkClose:j,onUpdateBulkCloseIndex:O,onBulkCloseCheckboxChange:S,onSingleAlertCloseCheckboxChange:w})=>{const{loading:k,signalIndexName:I}=Object(l.a)(),T=Object(a.useMemo)((()=>null!==I?[I]:[]),[I]),[C,{indexPatterns:M}]=Object(c.b)(T),_=Object(a.useCallback)((e=>{S(e.currentTarget.checked)}),[S]),D=Object(a.useCallback)((e=>{null!=w&&w(e.currentTarget.checked)}),[w]);return Object(a.useEffect)((()=>{O(o&&null!=T?T:void 0)}),[T,O,o]),Object(a.useEffect)((()=>{!0===p&&S(!1)}),[p,S]),Object(a.useEffect)((()=>{!1===C&&!1===k&&j((e=>{for(const{entries:t}of e)for(const e of null!=t?t:[])if(Object(d.f)(e)===u.b.LIST)return!0;return!1})(t)||((e,t)=>{const n=e=>t.fields.some((({name:t})=>t===e.field));if(0===e.length)return!1;for(const{entries:t}of e)for(const e of null!=t?t:[])if("nested"===e.type){for(const t of e.entries)if(!1===n(t))return!0}else if(!1===n(e))return!0;return!1})(t,M)||t.every((e=>0===e.entries.length)))}),[j,t,C,k,M]),r.a.createElement(h,null,r.a.createElement(v,{size:"xs"},r.a.createElement("h3",null,m)),r.a.createElement(s.EuiSpacer,{size:"s"}),null!=E&&"closed"!==x&&r.a.createElement(s.EuiFormRow,{fullWidth:!0},r.a.createElement(s.EuiCheckbox,{"data-test-subj":"closeAlertOnAddExceptionCheckbox",id:"close-alert-on-add-add-exception-checkbox",label:f,checked:i,onChange:D,disabled:k||C||e})),r.a.createElement(s.EuiFormRow,{fullWidth:!0},r.a.createElement(s.EuiCheckbox,{"data-test-subj":"bulkCloseAlertOnAddExceptionCheckbox",id:"bulk-close-alert-on-add-add-exception-checkbox",label:p?g:b,checked:o,onChange:_,disabled:p||k||C||e})),"endpoint"===n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(s.EuiText,{"data-test-subj":"addExceptionEndpointText",color:"subdued",size:"s"},y)))},x=r.a.memo(E);x.displayName="ExceptionItemsFlyoutAlertsActions"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n(585),i=n(204),o=n(53),s=n(118);var l=n(343),c=n(10),u=n(4);const d=u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.error",{defaultMessage:"Failed to close alerts"});var p=n(123),m=n(479);const f=()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(p.a)(),[f,g]=Object(a.useState)(!1),b=Object(a.useRef)(null);return Object(a.useEffect)((()=>{let a=!0;const p=new AbortController;return b.current=async(f,b,y,h)=>{try{var v,E,x,j,O,S,w,k;let t,d;if(g(!0),null!=y&&(t=await Object(m.a)({signalIds:[y],status:"closed",signal:p.signal})),null!=h){const e=Object(r.c)(["open","acknowledged","in-progress"]),t=await(async(e,t,n,a,r,l=!0)=>{const c={fields:[],title:a.join()},{filter:u}=await Object(i.r)({http:s.b.get().http,exceptions:r,excludeExceptions:l,chunkSize:10}),d={query:e,language:t},p=((e,t)=>null!=t?[...e,t]:[...e])(n,u);return Object(o.buildEsQuery)(c,d,p,{allowLeadingWildcards:!0,queryStringOptions:{analyze_wildcard:!0},ignoreFilterIfFieldNotInIndex:!1,dateFormatTZ:"Zulu"})})("","kuery",[...f.flatMap((e=>Object(r.d)(e))),...e],h,Object(l.m)(b),!1);d=await Object(m.a)({query:t,status:"closed",signal:p.signal})}const T=(null!==(v=null===(E=t)||void 0===E?void 0:E.updated)&&void 0!==v?v:0)+(null!==(x=null===(j=d)||void 0===j?void 0:j.updated)&&void 0!==x?x:0),C=null!==(O=null===(S=t)||void 0===S?void 0:S.version_conflicts)&&void 0!==O?O:0+(null!==(w=null===(k=d)||void 0===k?void 0:k.version_conflicts)&&void 0!==w?w:0);a&&(g(!1),e((I=T,u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.success",{values:{numAlerts:I},defaultMessage:"Successfully updated {numAlerts} {numAlerts, plural, =1 {alert} other {alerts}}"}))),C>0&&n({title:c.k(C),text:c.l(T,C)}))}catch(e){a&&(g(!1),t(e,{title:d}))}var I},()=>{a=!1,p.abort()}}),[e,t,n]),[f,b.current]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(19),r=n(2),i=n.n(r),o=n(566),s=n(720),l=n(52),c=n.n(l),u=n(576),d=n.n(u),p=n(4);p.i18n.translate("xpack.securitySolution.clipboard.copy",{defaultMessage:"Copy"});const m=p.i18n.translate("xpack.securitySolution.clipboard.copied",{defaultMessage:"Copied"}),f=p.i18n.translate("xpack.securitySolution.clipboard.to.the.clipboard",{defaultMessage:"to the clipboard"}),g=p.i18n.translate("xpack.securitySolution.clipboard.copy.to.the.clipboard",{defaultMessage:"Copy to the clipboard"});var b=n(123);const y=({children:e,content:t,isHoverAction:n,onCopy:r,titleSummary:o,toastLifeTimeMs:s})=>{const{addSuccess:l}=Object(b.a)(),u=c()("copy-to-clipboard",{securitySolution__hoverActionButton:n});return i.a.createElement(a.EuiButtonIcon,{"aria-label":g,className:u,"data-test-subj":"clipboard",iconType:"copyClipboard",onClick:e=>{e.preventDefault(),e.stopPropagation();const n=d()(`${t}`,{debug:!0});null!=r&&r({content:t,isSuccess:n}),n&&l(`${m} ${o} ${f}`,{toastLifeTimeMs:s})}},e)},h=i.a.memo((({isHoverAction:e,keyboardShortcut:t="",text:n,titleSummary:r})=>i.a.createElement(a.EuiToolTip,{content:i.a.createElement(o.b,{additionalScreenReaderOnlyContext:n,content:s.a,shortcut:t,showShortcut:""!==t})},i.a.createElement(y,{content:n,isHoverAction:e,titleSummary:r,toastLifeTimeMs:800}))));h.displayName="WithCopyToClipboard"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),r=n(1371);const i=new a.Type("NonEmptyOrNullableStringArray",a.array(a.string).is,((e,t)=>{const n=Array.isArray(e)&&e.some((e=>""===e)),r=Array.isArray(e)&&e.some((e=>"string"!=typeof e));return Array.isArray(e)&&(n||r||0===e.length)?a.failure(e,t):a.array(a.string).validate(e,t)}),a.identity);var o=n(403);const s=a.exact(a.type({field:r.a,operator:o.c,type:a.keyof({match_any:null}),value:i}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n.n(a),i=n(19),o=n(4);const s=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.nameLabel",{defaultMessage:"Exception name"}),l=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.namePlaceholder",{defaultMessage:"Name your exception"}),c=({exceptionItemName:e,onChange:t})=>{const n=Object(a.useCallback)((e=>{t(["name",e.target.value])}),[t]);return r.a.createElement(i.EuiFormRow,{label:s,"data-test-subj":"exceptionFlyoutName"},r.a.createElement(i.EuiFieldText,{placeholder:l,value:e,onChange:n,"data-test-subj":"exceptionFlyoutNameInput"}))},u=r.a.memo(c);u.displayName="ExceptionsFlyoutMeta"},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(2),r=n.n(a),i=n(19),o=n(87),s=n(1334),l=n(41),c=n.n(l),u=n(168),d=n(165),p=n(118),m=n(4);const f=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.conditionsTitle",{defaultMessage:"Conditions"}),g=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),b=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningAdd",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception created will apply to all events in the sequence."}),y=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningEdit",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."}),h=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.operatingSystemPlaceHolder",{defaultMessage:"Select an operating system"});var v=n(353),E=n(547);const x=[{label:v.h,value:["windows"]},{label:v.g,value:["macos"]},{label:v.f,value:["linux"]},{label:v.i,value:["windows","macos"]}],j=c()(i.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-x9h592-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),O=({exceptionItemName:e,allowLargeValueLists:t,exceptionListItems:n,indexPatterns:l,rules:c,exceptionListType:m,showOsTypeOptions:O,selectedOs:S,isEdit:w,onOsChange:k,onExceptionItemAdd:I,onSetErrorExists:T,getExtendedFields:C})=>{const{http:M,unifiedSearch:_}=Object(p.j)().services,D=Object(a.useMemo)((()=>m===s.a.ENDPOINT),[m]),N=Object(a.useMemo)((()=>null!=c&&c.some((e=>"eql"===e.type&&Object(d.a)(e.query)))),[c]),A=Object(a.useMemo)((()=>{if(D)return"endpoint_list";const e=D?u.k:void 0;return w?n[0].list_id:e}),[D,w,n]),F=Object(a.useMemo)((()=>{const e=D?"agnostic":void 0;return w?n[0].namespace_type:e}),[n,w,D]),P=Object(a.useCallback)((({exceptionItems:e,errorExists:t})=>{I(e),T(t)}),[T,I]),R=Object(a.useCallback)((e=>{const t=e[0].value;null!=k&&k(t||void 0)}),[k]),L=Object(a.useMemo)((()=>({asPlainText:!0})),[]),q=Object(a.useMemo)((()=>x.filter((e=>S===e.value))),[S]),z=Object(a.useMemo)((()=>O&&void 0===S),[O,S]),B=Object(a.useMemo)((()=>w?y:b),[w]),$=Object(a.useMemo)((()=>{var e;return null!==(e=w?n[0].os_types:S)&&void 0!==e?e:[]}),[n,w,S]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{size:"xs"},r.a.createElement("h3",null,f)),N&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiCallOut,{"data-test-subj":"eqlSequenceCallout",title:B}),r.a.createElement(i.EuiSpacer,null)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiText,{size:"s"},g),r.a.createElement(i.EuiSpacer,{size:"s"}),O&&!w&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiFormRow,{label:v.e},r.a.createElement(i.EuiComboBox,{placeholder:h,singleSelection:L,options:x,selectedOptions:q,onChange:R,isClearable:!1,"data-test-subj":"osSelectionDropdown"})),r.a.createElement(i.EuiSpacer,{size:"l"})),O&&w&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"xs","data-test-subj":"exceptionItemSelectedOs"},r.a.createElement("dl",null,r.a.createElement("dt",null,v.e),r.a.createElement("dd",null,(e=>e.reduce(((e,t)=>`${(e=>"linux"===e?v.f:"macos"===e?v.g:v.h)(t)}, ${e}`),"").slice(0,-2))($)))),r.a.createElement(i.EuiSpacer,null)),Object(o.getExceptionBuilderComponentLazy)({allowLargeValueLists:t,httpService:M,autocompleteService:_.autocomplete,exceptionListItems:n,listType:m,osTypes:$,listId:A,listNamespaceType:F,exceptionItemName:e,indexPatterns:l,isOrDisabled:z,isAndDisabled:z,isNestedDisabled:z,dataTestSubj:"alertExceptionBuilder",idAria:"alertExceptionBuilder",onChange:P,isDisabled:z,allowCustomFieldOptions:!D,getExtendedFields:C,showValueListModal:E.a}))},S=r.a.memo(O);S.displayName="ExceptionsConditions"},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(19),r=n(54),i=n.n(r),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(4);const d=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.expireTimeLabel",{defaultMessage:"Exception will expire at"}),p=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTime",{defaultMessage:"Exception Expiration"}),m=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTimeError",{defaultMessage:"Selected date and time must be in the future."}),f=c()(a.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1t4zrw1-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),g=({expireTime:e,setExpireTime:t,setExpireError:n})=>{const[r,l]=Object(o.useState)(e),[c,u]=Object(o.useState)(!1),[g,b]=Object(o.useState)([]),y=Object(o.useCallback)((e=>{l(null!=e?e:void 0),t(null!=e?e:void 0),null!=e&&e.isBefore()?(u(!0),b([m]),n(!0)):(u(!1),b([]),n(!1))}),[l,t,n]);return s.a.createElement("div",null,s.a.createElement(f,{size:"xs"},s.a.createElement("h3",null,p)),s.a.createElement(a.EuiSpacer,{size:"s"}),s.a.createElement(a.EuiFormRow,{error:g,isInvalid:c,label:d},s.a.createElement(a.EuiDatePicker,{showTimeSelect:!0,selected:r,isInvalid:c,onChange:y,onClear:()=>y(null),minDate:i()()})))},b=s.a.memo(g);b.displayName="ExceptionsExpireTime"},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(41),r=n.n(a),i=n(2),o=n.n(i),s=n(7),l=n(19),c=n(4),u=n(42),d=(n(43),n(1555)),p=n(1470),m=n(1561),f=n(1870),g=n(87),b=n(122),y=n(361),h=n(245),v=n(259),E=n(167),x=n(126),j=n(252),O=n(340),S=n(16),w=n(118),k=n(451),I=n(1232),T=n(237),C=n(603),M=n(967),_=n(632),D=n(602),N=n(547),A=n(846);const F=[f.c.MAC,f.c.WINDOWS,f.c.LINUX].map((e=>({value:e,inputDisplay:T.c[e]}))),P=Object.freeze({policySelection:v.i,processDescendantsFiltering:v.h}),R=e=>e.entries.map((e=>(delete e.id,e))),L=Object(i.memo)((({allowSelectOs:e=!0,item:t,policies:n,policiesIsLoading:a,onChange:r,mode:L})=>{const z=Object(x.a)("eventFilters-form"),{http:B}=Object(w.j)().services,$=Object(i.useCallback)((({field:e,query:t})=>new D.a(B).getSuggestions({field:e.name,query:t})),[B]),V=(U=$,Object(i.useMemo)((()=>({getQuerySuggestions:()=>{},hasQuerySuggestions:e=>!1,getValueSuggestions:U})),[U]));var U;const[G,H]=Object(i.useState)(!1),[W,Q]=Object(i.useState)(!t.name),[Y,K]=Object(i.useState)(""),[Z,X]=Object(i.useState)(!1),[J,ee]=Object(i.useState)(!1),[te,ne]=Object(i.useState)([]),ae=Object(S.b)().isPlatinumPlus(),re=Object(i.useMemo)((()=>Object(k.f)(t)),[t]),[ie,oe]=Object(i.useState)(!Object(k.f)(t)),[se,le]=Object(i.useState)(!1),[ce,ue]=Object(i.useState)(Object(d.g)([t])),de=Object(i.useMemo)((()=>[E.D]),[]),[pe,{indexPatterns:me}]=Object(j.b)(de,void 0,E.l),{getTagsUpdatedBy:fe}=Object(y.e)(t,P),ge=Object(l.useEuiTheme)(),be=Object(b.a)("filterProcessDescendantsForEventFiltersEnabled"),ye=Object(i.useMemo)((()=>Object(v.g)(t)),[t]),[he,ve]=Object(i.useState)(!!t.entries.length||!1),Ee=Object(i.useMemo)((()=>null==t?void 0:t.comments),[]),xe=Object(i.useMemo)((()=>ae||"edit"===L&&(!re||ie&&re&&G)),[L,re,G,ae,ie]),je=Object(i.useMemo)((()=>!W&&!Z&&!!t.entries.length&&t.entries.some((e=>""!==e.value||e.value.length))),[Z,W,t.entries]),Oe=Object(i.useCallback)((e=>{const n=e?{...t,...e}:t;R(n),r({item:n,isValid:je&&he,confirmModalLabels:ce?Object(T.a)(c.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.confirmModal.name",{defaultMessage:"event filter"})):void 0})}),[he,t,je,r,ce]);Object(i.useEffect)((()=>{!G&&t.tags&&oe(!Object(k.f)({tags:t.tags}))}),[t.tags,G]),Object(i.useEffect)((()=>{if(G)return;const e=t.tags?Object(k.d)({tags:t.tags}):[];if(!e.length)return;const a=n.filter((t=>e.includes(t.id)));ne(a)}),[G,t,n]);const Se=Object(i.useMemo)((()=>{const e=t;return e.entries=t.entries.length?t.entries:[{field:"",operator:"included",type:"match",value:""}],R(e),ve(!!t.entries.length),e}),[t]),we=Object(i.useCallback)((e=>{if(!t)return;const n=e.target.value.trim();Q(!n),Oe({name:n}),G||H(!0)}),[t,G,Oe]),ke=Object(i.useMemo)((()=>{var e;return o.a.createElement(l.EuiFormRow,{label:I.e,fullWidth:!0,isInvalid:W&&J,error:I.d},o.a.createElement(l.EuiFieldText,{"aria-label":I.e,id:"eventFiltersFormInputName",defaultValue:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"","data-test-subj":z("name-input"),fullWidth:!0,maxLength:256,required:J,onChange:we,onBlur:()=>!J&&ee(!0)}))}),[z,W,we,J,null==t?void 0:t.name]),Ie=Object(i.useCallback)((e=>{t&&(G||H(!0),Oe({description:e.target.value.toString().trim()}))}),[t,G,Oe]),Te=Object(i.useMemo)((()=>{var e;return o.a.createElement(l.EuiFormRow,{label:I.b,fullWidth:!0},o.a.createElement(l.EuiTextArea,{id:"eventFiltersFormInputDescription",defaultValue:null!==(e=null==t?void 0:t.description)&&void 0!==e?e:"",onChange:Ie,fullWidth:!0,"data-test-subj":z("description-input"),"aria-label":I.b,maxLength:256}))}),[null==t?void 0:t.description,z,Ie]),Ce=Object(i.useMemo)((()=>{var e;return null!=t&&null!==(e=t.os_types)&&void 0!==e&&e.length?t.os_types[0]:f.c.WINDOWS}),[null==t?void 0:t.os_types]),Me=Object(i.useCallback)((e=>{t&&(Oe({os_types:[e],entries:t.entries}),G||H(!0))}),[t,G,Oe]),_e=Object(i.useMemo)((()=>o.a.createElement(l.EuiFormRow,{label:I.f,fullWidth:!0},o.a.createElement(l.EuiSuperSelect,{name:"os",options:F,fullWidth:!0,valueOfSelected:Ce,onChange:Me}))),[Me,Ce]),De=Object(i.useCallback)((e=>{t&&(K(e),Oe({comments:[{comment:e}]}),G||H(!0))}),[t,G,Oe]),Ne=Object(i.useMemo)((()=>o.a.createElement(_.a,{exceptionItemComments:Ee,newCommentValue:Y,newCommentOnChange:De,setCommentError:X})),[Ee,De,Y]),Ae=Object(i.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionTitle",defaultMessage:"Comments"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionDescription",defaultMessage:"Add a comment to your event filter."}))),o.a.createElement(l.EuiSpacer,{size:"m"}),Ne)),[Ne]),Fe=Object(i.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.detailsSectionTitle",defaultMessage:"Details"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,I.a)),o.a.createElement(l.EuiSpacer,{size:"m"}),ke,Te)),[ke,Te]),Pe=Object(i.useCallback)((e=>{const t="descendants"===e?[h.d]:[],n=fe("processDescendantsFiltering",t);Oe({tags:n}),G||H(!0)}),[fe,G,Oe]),Re=Object(i.useMemo)((()=>[{id:"events",label:o.a.createElement(l.EuiText,{size:"s"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.eventsButton",defaultMessage:"Events"})),iconType:ye?"empty":"checkInCircleFilled","data-test-subj":z("filterEventsButton")},{id:"descendants",label:o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},o.a.createElement(l.EuiText,{size:"s"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.processDescendantsButton",defaultMessage:"Process Descendants"})),o.a.createElement(A.a,{"data-test-subj":z("filterProcessDescendantsTooltip")})),iconType:ye?"checkInCircleFilled":"empty","data-test-subj":z("filterProcessDescendantsButton")}]),[z,ye]),Le=Object(i.useMemo)((()=>be?o.a.createElement(o.a.Fragment,null,o.a.createElement(q,{legend:"Events or Process descendants selector",color:"primary",onChange:Pe,options:Re,idSelected:ye?"descendants":"events",$_css:ge.euiTheme.size.l}),o.a.createElement(l.EuiSpacer,{size:"m"}),ye&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"s","data-test-subj":z("filterProcessDescendants-additionalConditionDescription")},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.additionalConditionDescription",defaultMessage:"Additional condition added:"})),o.a.createElement("code",null,h.g),o.a.createElement(l.EuiSpacer,{size:"m"}))):null),[be,Pe,ge.euiTheme.size.l,Re,ye,z]),qe=Object(i.useCallback)((e=>{var n,a,r,i,o,l,c,u,p;if(!G&&void 0===e.exceptionItems[0]||Object(s.isEqual)(null===(n=e.exceptionItems[0])||void 0===n?void 0:n.entries,null==t?void 0:t.entries)){var m;const t=(null===(m=e.exceptionItems[0])||void 0===m?void 0:m.entries.map((e=>e.field)))||[""];return be&&ye&&t.push(h.f.field),le((p=t.reduce(((e,t)=>(t in e?e[t]++:e[t]=1,e)),{}),Object.values(p).some((e=>e>1)))),void(G||H(!0))}le(!1),ue(Object(d.g)(e.exceptionItems));const g=void 0!==e.exceptionItems[0]?{...e.exceptionItems[0],name:null!==(a=null==t?void 0:t.name)&&void 0!==a?a:"",description:null!==(r=null==t?void 0:t.description)&&void 0!==r?r:"",comments:null!==(i=null==t?void 0:t.comments)&&void 0!==i?i:[],os_types:null!==(o=null==t?void 0:t.os_types)&&void 0!==o?o:[f.c.WINDOWS],tags:null!==(l=null==t?void 0:t.tags)&&void 0!==l?l:[],meta:t.meta}:t,b=void 0!==e.exceptionItems[0]&&!(e.errorExists&&(null===(c=e.exceptionItems[0])||void 0===c||null===(u=c.entries)||void 0===u||!u.length));ve(b),Oe(g),G||H(!0)}),[t,G,be,ye,Oe]),ze=Object(i.useMemo)((()=>Object(g.getExceptionBuilderComponentLazy)({allowLargeValueLists:!1,httpService:B,autocompleteService:V,exceptionListItems:[Se],listType:C.c,listId:C.a,listNamespaceType:"agnostic",ruleName:I.g,indexPatterns:me,isOrDisabled:!0,isOrHidden:!0,isAndDisabled:!1,isNestedDisabled:!1,dataTestSubj:"alert-exception-builder",idAria:"alert-exception-builder",onChange:qe,operatorsList:p.c,osTypes:t.os_types,showValueListModal:N.a})),[V,qe,B,me,t,Se]),Be=Object(i.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionTitle",defaultMessage:"Conditions"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,e?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withOs",defaultMessage:"Select an operating system and add conditions."}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withoutOs",defaultMessage:"Add conditions."}))),o.a.createElement(l.EuiSpacer,{size:"m"}),e?o.a.createElement(o.a.Fragment,null,_e,o.a.createElement(l.EuiSpacer,null)):null,Le,ze)),[e,ze,_e,Le]),$e=Object(i.useCallback)((e=>{const t=Object(k.b)(e);e.isGlobal||ne(e.selected);const n=fe("policySelection",t);Oe({tags:n}),G||H(!0)}),[Oe,fe,G]),Ve=Object(i.useMemo)((()=>o.a.createElement(M.a,{selected:te,options:n,isGlobal:re,isLoading:a,isPlatinumPlus:ae,onChange:$e,"data-test-subj":z("effectedPolicies")})),[te,n,re,a,ae,$e,z]);return Object(i.useEffect)((()=>{Oe()}),[Oe]),pe||!t?o.a.createElement(O.a,{size:"xl"}):o.a.createElement(l.EuiForm,{component:"div"},Fe,o.a.createElement(l.EuiHorizontalRule,null),Be,ce&&o.a.createElement(m.a,null),se&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{color:"subdued",size:"xs","data-test-subj":"duplicate-fields-warning-message"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.warningMessage.duplicateFields",defaultMessage:"Using multiples of the same field values can degrade Endpoint performance and/or create ineffective rules"}))),xe&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiHorizontalRule,null),Ve),o.a.createElement(l.EuiHorizontalRule,null),Ae)}));L.displayName="EventFiltersForm";var q=r()(l.EuiButtonGroup).withConfig({displayName:"_StyledEuiButtonGroup",componentId:"sc-1xvgrer-0"})([".euiButtonGroupButton{padding-right:",";}"],(e=>e.$_css))},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(19),r=n(444),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(60),u=n.n(c),d=n(5),p=n(134),m=n(118),f=n(769),g=n(356);const b=l()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),y=o.a.memo((({value:e})=>Object(g.a)(e)?o.a.createElement(o.a.Fragment,null,e):o.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},f.c)));y.displayName="ValueWrapper";const h=({legendItem:e})=>{const[t]=Object(m.o)(d.W),{color:n,count:r,dataProviderId:i,field:s,scopeId:l,value:c}=e;return o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),o.a.createElement(a.EuiFlexItem,{grow:!0},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(p.b,{"data-test-subj":`legend-item-${i}`,field:s,hideTopN:!0,id:i,isDraggable:!1,scopeId:l,value:c},null==e.render?o.a.createElement(y,{value:c}):e.render({field:s,value:c}))),null!=r&&o.a.createElement(b,{"data-test-subj":"legendItemCount",grow:!1},u()(r).format(t))))))};h.displayName="DraggableLegendItemComponent";const v=o.a.memo(h),E=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(r.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),x=({className:e,height:t=0,legendItems:n,minWidth:r=165})=>0===n.length?null:o.a.createElement(E,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:r},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>o.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},o.a.createElement(v,{legendItem:e}),o.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));x.displayName="DraggableLegendComponent";const j=o.a.memo(x)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(799);const r=["endpoint_list"],i=e=>!!r.find((t=>t===e.list_id)),o=e=>a.a.is(e)},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(44),r=n(2);const i={pageName:n(156).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},o=Object(r.createContext)([i,()=>a.noop])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(68);const r=Object(a.createSelector)([e=>e.dataViewPicker],(e=>({loading:"loading"===e.state,dataViewId:e.dataView.id||"",patternList:e.patternList,indicesExist:!0,browserFields:{},activePatterns:e.patternList,runtimeMappings:{},selectedPatterns:e.patternList,indexPattern:{fields:[],title:e.dataView.title||""},sourcererDataView:{}})))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=Object(a.createContext)(null)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2);t.default=function(e){void 0===e&&(e={});var t=r.useState(e),n=t[0],i=t[1],o=r.useMemo((function(){return{set:function(e,t){i((function(n){var r;return a.__assign(a.__assign({},n),((r={})[e]=t,r))}))},setAll:function(e){i(e)},remove:function(e){i((function(t){var n=t,r=e;return n[r],a.__rest(n,["symbol"==typeof r?r:r+""])}))},reset:function(){return i(e)}}}),[i]),s=a.__assign({get:r.useCallback((function(e){return n[e]}),[n])},o);return[n,s]}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n.n(a),i=n(41);const o=n.n(i).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(i.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));o.displayName="Wrapper";const s=r.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?r.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):r.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));s.displayName="SubtitleItem";const l=r.a.memo((({items:e})=>r.a.createElement(o,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>r.a.createElement(s,{key:t},e))):r.a.createElement(s,null,e))));l.displayName="Subtitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4);const r=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(45),r=n(1269);const i=e=>{const t=Object(a.useSelector)((t=>Object(r.sourcererScopeSelectedDataViewId)(t,e)));return null!=t?t:void 0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return v}));var a=n(44),r=n(2),i=n(45),o=n(4),s=n(122),l=n(250),c=n(123),u=n(132),d=n(166),p=n(184),m=n(213),f=n(191),g=n(906),b=n(127);const y="createRuleFromTimeline",h="createRuleFromEql",v=e=>{const t=Object(i.useDispatch)(),{addError:n}=Object(c.a)(),{browserFields:v,dataViewId:E,selectedPatterns:x}=Object(u.a)(b.SourcererScopeName.timeline),j=Object(s.a)("unifiedComponentsInTimelineDisabled"),O=Object(r.useRef)(!1),[S,w]=Object(r.useState)(null),[k,I]=Object(r.useState)(!1),T=Object(r.useCallback)((e=>{I(!0),w(e),e.dataViewId===E||Object(a.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[E,t]),[C]=Object(r.useState)({dataViewId:E,selectedPatterns:x}),M=Object(r.useMemo)((()=>null==S||Object(a.isEmpty)(v)||null!==S.dataViewId&&null!==E&&E!==S.dataViewId?null:v),[v,E,S]),_=Object(m.g)(y),D=Object(r.useMemo)(_,[_]),N=Object(m.g)(h),A=Object(r.useMemo)(N,[N]),F=Object(r.useCallback)((()=>{if(null!=S&&null!=M){try{const t=()=>{var e,t,n,a,r,i,o;return{dataProviders:null!=S.dataProviders&&S.dataProviders.length>0?Object(l.f)(Object(f.f)(S.dataProviders,M),{fields:[],title:x.join(",")}):"",query:{query:null!==(e=null===(t=S.kqlQuery.filterQuery)||void 0===t||null===(n=t.kuery)||void 0===n?void 0:n.expression)&&void 0!==e?e:"",language:null!==(a=null===(r=S.kqlQuery.filterQuery)||void 0===r||null===(i=r.kuery)||void 0===i?void 0:i.kind)&&void 0!==a?a:"kuery"},filters:null!==(o=S.filters)&&void 0!==o?o:[],eqlOptions:{}}},n=()=>{var e;return{dataProviders:"",query:{query:null!==(e=S.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:S.eqlOptions}}},a=O.current?n():t();I(!1),e({index:x,queryBar:{filters:""!==a.dataProviders?[...a.filters,Object(g.b)(a.dataProviders)]:a.filters,query:a.query,saved_id:null},...a.eqlOptions})}catch(e){I(!1),n(e,{toastMessage:o.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:S.id}}),title:o.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}O.current=!1,C.dataViewId!==E&&t(d.a.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:C.dataViewId,selectedPatterns:C.selectedPatterns}))}}),[n,E,t,C.dataViewId,C.selectedPatterns,M,x,S,e]);Object(r.useEffect)((()=>{null!=M&&F()}),[F,M]);const P=Object(p.g)(),R=Object(r.useCallback)((e=>{null!=S&&e===S.id||P({timelineId:e,onOpenTimeline:T,unifiedComponentsInTimelineDisabled:j})}),[T,P,S,j]),[L,q]=Object(r.useState)(!1);return Object(r.useEffect)((()=>{if(!L){let e=null;null!=D?e=D:null!=A&&(e=A,O.current=!0),null!=e&&(q(!0),R(e),I(!0))}}),[R,D,A,L]),{loading:k,onOpenTimeline:T}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return E}));var a=n(44),r=n(2),i=n.n(r),o=n(45),s=n(53),l=n(448),c=n.n(l),u=n(138),d=n(132),p=n(127),m=n(250),f=n(579),g=n(971),b=n(191),y=n(129);const h=c.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,v=Object(r.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:s,fromStr:l,kqlMode:c,isRefreshPaused:v,savedQueryId:x,setSavedQueryId:j,refreshInterval:O,timelineId:S,to:w,toStr:k,updateReduxTime:I})=>{const T=Object(o.useDispatch)(),[C,M]=Object(r.useState)(null!=l?l:new Date(s).toISOString()),[_,D]=Object(r.useState)(null!=k?k:new Date(w).toISOString()),{browserFields:N,indexPattern:A}=Object(d.a)(p.SourcererScopeName.timeline),[F,P]=Object(r.useState)(void 0),[R,L]=Object(r.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),q=Object(r.useMemo)((()=>Object(b.i)(t)),[t]),[z,B]=Object(r.useState)(Object(m.f)(Object(b.f)(e,N),A)),$=Object(f.a)(),V=Object(r.useCallback)(((e,t)=>T(y.a.applyKqlFilterQuery({id:S,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(m.f)(e,A)}}))),[T,A,S]);Object(r.useEffect)((()=>{L({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(r.useEffect)((()=>{B(Object(m.f)(Object(b.f)(e,N),A))}),[e,N,A]),Object(r.useEffect)((()=>{null!=l&&null!=k?(M(l),D(k)):null!=s&&null!=w&&(M(new Date(s).toISOString()),D(new Date(w).toISOString()))}),[s,l,w,k]),Object(r.useEffect)((()=>{let e=!0;return async function(){if(null!=x&&null!=$)try{const n=await $.getSavedQuery(x);e&&null!=n&&P({...n,attributes:{...n.attributes,filters:Object(b.i)(t)}})}catch(e){P(void 0)}else e&&P(void 0)}(),()=>{e=!1}}),[x]);const U=Object(r.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&V(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");I({id:u.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:S,hasRangeChanged:!0})}}),[a,S]),G=Object(r.useCallback)((e=>{if(null!=e){if(e.id!==x&&j(e.id),null!=$&&""!==z){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===b.e)):-1;$.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),E(z),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,E(z)]:[]})}}else j(null)}),[z,x,$]);return i.a.createElement(h,{className:"search_bar_container"},i.a.createElement(g.a,{dateRangeFrom:C,dateRangeTo:_,hideSavedQuery:"search"===c,indexPattern:A,isRefreshPaused:v,filterQuery:R,filterManager:n,filters:q,onSubmitQuery:U,refreshInterval:O,savedQuery:F,onSavedQuery:G,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),E=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:b.e,controlledBy:b.e,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:s.FilterStateStore.APP_STATE}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(19),r=n(2),i=n.n(r),o=n(41);const s=n.n(o)()((({iconSide:e,children:t,...n})=>i.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(o.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(o.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(o.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));s.displayName="Link";const l=i.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:o,disabled:l,href:c,iconSide:u="left",iconSize:d="s",iconType:p,onClick:m})=>{const f=Object(r.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?f(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),g=Object(r.useMemo)((()=>e||f(t)),[e,t,f]);return i.a.createElement(s,{className:"siemLinkIcon",color:n,"data-test-subj":o,disabled:l,href:c,iconSide:u,onClick:m,"aria-label":g},i.a.createElement(a.EuiIcon,{size:d,type:p}),i.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(19),r=n(44),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(121),u=n(747),d=n(184),p=n(163),m=n(130),f=n(443),g=n(137);const b=l()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),y=l()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),h=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:s,timelineType:l,placeholder:h})=>{const[v,E]=Object(i.useState)(50),[x,j]=Object(i.useState)(0),[O,S]=Object(i.useState)(""),[w,k]=Object(i.useState)(!1),{fetchAllTimeline:I,timelines:T,loading:C,totalCount:M}=Object(u.b)(),_=Object(i.useRef)(null),D=Object(i.useRef)(null),N=Object(i.useMemo)((()=>Object(r.debounce)(500,S)),[]),A=Object(i.useCallback)((e=>{N(e)}),[N]),F=Object(i.useCallback)((()=>{k(!w)}),[w]),P=Object(i.useCallback)(((e,t,n)=>{if(e<t&&_.current&&D.current){const e=_.current.clientHeight,t=D.current.clientHeight;n>10&&t-n<1.2*e&&t>x&&(j(t),E(v+50))}}),[x,v]),R=Object(i.useCallback)(((e,t)=>{const n=Object(d.e)({...e,title:e.timelineTitle})?p.Z:e.timelineTitle,i=null!=e.description&&e.description.trim().length>0?e.description:null;return o.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),o.a.createElement(b,{grow:!0},o.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},o.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},o.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},o.a.createElement(a.EuiHighlight,{search:t},n))),o.a.createElement(a.EuiFlexItem,null,o.a.createElement(a.EuiToolTip,{content:i,anchorClassName:"eui-textTruncate eui-alignMiddle"},o.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},o.a.createElement("small",null,null!=i?i:Object(m.d)())))))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(r.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),L=Object(i.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&s(Object(r.isEmpty)(t[0].timelineTitle)?p.Z:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,s]),q=Object(i.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]),z=Object(i.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=h?h:f.e(l),onSearch:A,incremental:!1,append:o.a.createElement(y,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:w,onClick:F},p.D)})),[F,A,w,l,h]),B=Object(i.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>P((null!=T?T:[]).filter((t=>!e||""!==t.title)).length,M,t),outerRef:_,innerRef:D}})),[P,e,M,T]);return Object(i.useEffect)((()=>{I({pageInfo:{pageIndex:1,pageSize:v},search:O,sort:{sortField:c.g.updated,sortOrder:g.b.desc},onlyUserFavorite:w,status:null,timelineType:l})}),[I,w,v,O,l]),o.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:C&&null==T,listProps:B,renderOption:R,onChange:L,searchable:!0,searchProps:z,singleSelection:!0,options:($=t({timelines:null!=T?T:[],onlyFavorites:w,searchTimelineValue:O,timelineType:l}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},q);var $},v=Object(i.memo)(h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(57),r=n(129);const i=()=>Object(a.createSelector)(r.b.selectTimeline,(e=>{var t,n;return{createdBy:e.createdBy,expandedDetail:null!==(t=e.expandedDetail)&&void 0!==t?t:{},eventIdToNoteIds:null!==(n=null==e?void 0:e.eventIdToNoteIds)&&void 0!==n?n:{},noteIds:e.noteIds,status:e.status}}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="memory"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(19),o=n(121),s=n(163),l=n(292);const c=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[c,u]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===o.m.template),[e]),p=Object(a.useMemo)((()=>d?c:null),[c,d]),m=Object(a.useMemo)((()=>null==p?null:p===o.h.elastic?o.l.immutable:o.l.active),[p]),f=Object(a.useMemo)((()=>[{id:o.h.elastic,name:s.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:o.h.custom,name:s.r,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),g=Object(a.useCallback)((e=>{u(c===e?null:e)}),[u,c]),b=Object(a.useMemo)((()=>d?f.map((e=>r.a.createElement(i.EuiFilterButton,{hasActiveFilters:e.id===p,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:g.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[p,f,d,g]),y=Object(a.useCallback)((async()=>{p!==o.h.custom&&await Object(l.g)()}),[p]);return{timelineStatus:m,templateTimelineType:p,templateTimelineFilter:b,installPrepackagedTimelines:y}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n.n(a),i=n(45),o=n(19),s=n(4),l=n(169),c=n(129),u=n(121),d=n(365);const p=s.i18n.translate("xpack.securitySolution.timeline.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),m=s.i18n.translate("xpack.securitySolution.timeline.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),f=r.a.memo((({timelineId:e,isPartOfGuidedTour:t=!1})=>{const n=Object(i.useDispatch)(),{isFavorite:s,status:f}=Object(i.useSelector)((t=>Object(l.selectTimelineById)(t,e))),g=f!==u.l.active,b=s?m:p,y=Object(a.useCallback)((()=>n(c.a.updateIsFavorite({id:e,isFavorite:!s}))),[n,e,s]);return r.a.createElement(o.EuiButtonIcon,{id:t?d.a.ADD_TO_FAVORITES:void 0,iconType:s?"starFilled":"starEmpty",isSelected:s,disabled:g,"aria-label":b,title:b,"data-test-subj":`timeline-favorite-${s?"filled":"empty"}-star`,onClick:y},b)}));f.displayName="AddToFavoritesButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n.n(a),i=n(19),o=n(44),s=n(4),l=n(129),c=n(158),u=n(124),d=n(121);const p=s.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedLabel",{defaultMessage:"Unsaved"}),m=s.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedChangesLabel",{defaultMessage:"Unsaved changes"}),f=r.a.memo((({timelineId:e})=>{const t=Object(a.useMemo)((()=>l.b.getTimelineByIdSelector()),[]),{changed:n=!1,status:s,updated:f}=Object(u.a)((n=>{var a;return Object(o.pick)(["changed","status","updated"],null!==(a=t(n,e))&&void 0!==a?a:c.b)}));let g;return s!==d.l.draft&&f?n&&(g=r.a.createElement(i.EuiBadge,{color:"warning"},m)):g=r.a.createElement(i.EuiBadge,{color:"warning"},p),g?r.a.createElement(i.EuiText,{size:"xs","data-test-subj":"timeline-save-status"},g):null}));f.displayName="TimelineSaveStatus"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(57),r=n(146),i=n(1268),o=n(169);const s=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:r.d.query})),l=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),c=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),u=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),p=()=>Object(a.createSelector)(i.selectNotesById,(e=>Object.values(e))),m=()=>Object(a.createSelector)(o.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return p}));var a=n(2),r=n.n(a),i=n(19),o=n(42),s=n(56);const l={tall:490,short:250},c=Object(a.createContext)({tableId:null}),u=({height:e="tall"})=>r.a.createElement(i.EuiPanel,{color:"subdued"},r.a.createElement(i.EuiFlexGroup,{style:{height:l[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},p=()=>{const{http:e}=Object(s.useKibana)().services;return r.a.createElement(i.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},r.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiPanel,{hasBorder:!0,style:d},r.a.createElement(i.EuiFlexGroup,null,r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiText,{size:"s"},r.a.createElement(i.EuiTitle,null,r.a.createElement("h3",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(19),r=n(78),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(414),u=n(138),d=n(474),p=n(447),m=n(658),f=n(267),g=n(282),b=n(625),y=n(127);const h=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),v=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:n,extraOptions:s,getLensAttributes:l,inputId:v=u.a.global,inspectIndex:E=0,isInspectButtonDisabled:x,isMultipleQuery:j,lensAttributes:O,onCloseInspect:S,queryId:w,timerange:k,title:I,scopeId:T=y.SourcererScopeName.default,stackByField:C,withActions:M=b.a,casesAttachmentMetadata:_})=>{const[D,N]=Object(i.useState)(!1),[A,F]=Object(i.useState)(!1),P=Object(i.useCallback)((()=>{N(!D)}),[D]),R=()=>{N(!1)},L=Object(m.a)({applyGlobalQueriesAndFilters:e,extraOptions:s,getLensAttributes:l,lensAttributes:O,scopeId:T,stackByField:C,title:""}),q=`stat-${w}`,z=Object(i.useCallback)((()=>{R(),F(!0)}),[]),B=Object(i.useCallback)((()=>{F(!1),S&&S()}),[S]),{additionalRequests:$,additionalResponses:V,handleClick:U,handleCloseModal:G,isButtonDisabled:H,request:W,response:Q}=Object(p.a)({inputId:v,inspectIndex:E,isDisabled:x,multiple:j,onCloseInspect:B,onClick:z,queryId:w}),Y=Object(i.useMemo)((()=>({handleInspectClick:U,isInspectButtonDisabled:H})),[H,U]),K=Object(b.d)({attributes:L,extraActions:n,inspectActionProps:Y,timeRange:k,withActions:M,lensMetadata:_}),Z=Object(c.useAsync)((()=>Object(r.buildContextMenuForActions)({actions:K.map((e=>({action:e,context:{},trigger:b.c})))})),[K]),X=Object(i.useMemo)((()=>o.a.createElement(a.EuiButtonIcon,{"aria-label":f.l,className:g.a,"data-test-subj":q,iconType:"boxesHorizontal",onClick:P})),[q,P]);return o.a.createElement(h,{className:t},Z.value&&Z.value.length>0&&o.a.createElement(a.EuiPopover,{button:X,isOpen:D,closePopover:R,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},o.a.createElement(a.EuiContextMenu,{"data-test-subj":"viz-actions-panel",size:"s",panels:Z.value})),A&&null!==W&&null!==Q&&o.a.createElement(d.a,{additionalRequests:$,additionalResponses:V,closeModal:G,inputId:v,request:W,response:Q,title:I}))};v.displayName="VisualizationActionsComponent";const E=o.a.memo(v)},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n.n(a),i=n(19),o=n(824),s=n(825),l=n(826),c=n(1248);const u=Object(a.memo)((({searchInputId:e,assignedUserIds:t,onApply:n})=>{const[u,d]=Object(a.useState)(t),p=Object(a.useMemo)((()=>{const e=Object(s.b)(u);return{add:e.filter((e=>!t.includes(e))),remove:t.filter((t=>!e.includes(t)))}}),[t,u]),m=Object(a.useMemo)((()=>p.add.length||p.remove.length),[p]),f=Object(a.useCallback)((e=>{d(e)}),[]),g=Object(a.useCallback)((async()=>{n(p)}),[p,n]);return r.a.createElement("div",{"data-test-subj":l.b},r.a.createElement(c.a,{searchInputId:e,assignedUserIds:t,onSelectionChange:f}),r.a.createElement(i.EuiButton,{"data-test-subj":l.a,fullWidth:!0,size:"s",onClick:g,isDisabled:!m},o.a))}));u.displayName="AssigneesPanel"},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(1334),i=n(540),o=n(270),s=n(172);const l=({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const{exceptionActionItems:n}=(({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const[{canUserCRUD:n,hasIndexWrite:i}]=Object(o.b)(),l=Object(a.useCallback)((()=>{t()}),[t]),c=Object(a.useCallback)((()=>{t(r.a.ENDPOINT)}),[t]),u=!n||!i||!e,d=!n||!i;return{exceptionActionItems:Object(a.useMemo)((()=>d?[]:[{key:"add-endpoint-exception-menu-item","data-test-subj":"add-endpoint-exception-menu-item",disabled:u,onClick:c,name:s.d},{key:"add-exception-menu-item","data-test-subj":"add-exception-menu-item",disabled:d,onClick:l,name:s.g}]),[u,d,l,c])}})({isEndpointAlert:e,onAddExceptionTypeClick:t});return Object(i.a)("crudEndpointExceptions")?{exceptionActionItems:n}:{exceptionActionItems:n.map((e=>({...e,disabled:e.name===s.d})))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(172);const i=({onAddEventFilterClick:e,disabled:t=!1,tooltipMessage:n})=>({eventFilterActionItems:Object(a.useMemo)((()=>[{key:"add-event-filter-menu-item","data-test-subj":"add-event-filter-menu-item",onClick:e,disabled:t,toolTipContent:n,name:r.e}]),[e,t,n])})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(716);const r=({handleClick:e})=>({key:"osquery-action-item","data-test-subj":"osquery-action-item",onClick:e,size:"s",name:a.a})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(748),i=n(1245),o=n(293);const s=({closePopover:e,ecsRowData:t,refetch:n})=>{var s;const{hasIndexWrite:l}=Object(o.a)(),c=t._id,u=Object(a.useMemo)((()=>{var e,n,a,i;return[{_id:c,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:r.H,value:null!==(n=null==t||null===(a=t.kibana)||void 0===a?void 0:a.alert.workflow_tags)&&void 0!==n?n:[]}],ecs:{_id:c,_index:null!==(i=t._index)&&void 0!==i?i:""}}]}),[c,t._index,null==t||null===(s=t.kibana)||void 0===s?void 0:s.alert.workflow_tags]),{alertTagsItems:d,alertTagsPanels:p}=Object(i.a)({refetch:n}),m=Object(a.useMemo)((()=>d.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key})))),[d]);return{alertTagsItems:l?m:[],alertTagsPanels:Object(a.useMemo)((()=>p.map((t=>{const n=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:u});return{title:t.title,content:n,id:t.id}}))),[u,p,e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(7),r=n(2),i=n(748),o=n(405),s=n(1252),l=n(293);const c=({closePopover:e,ecsRowData:t,refetch:n})=>{var c;const{hasIndexWrite:u}=Object(l.a)(),d=t._id,p=Object(r.useMemo)((()=>{var e,n,a,r;return[{_id:d,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:i.F,value:null!==(n=null==t||null===(a=t.kibana)||void 0===a?void 0:a.alert.workflow_assignee_ids)&&void 0!==n?n:[]}],ecs:{_id:d,_index:null!==(r=t._index)&&void 0!==r?r:""}}]}),[d,t._index,null==t||null===(c=t.kibana)||void 0===c?void 0:c.alert.workflow_assignee_ids]),m=Object(r.useCallback)((()=>{e(),n&&n()}),[e,n]),{alertAssigneesItems:f,alertAssigneesPanels:g}=Object(s.a)({onAssigneesUpdate:m}),b=Object(r.useMemo)((()=>f.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key,onClick:()=>{var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,p,!1,a.noop,a.noop,a.noop)}})))),[p,f]);return{alertAssigneesItems:u?b:[],alertAssigneesPanels:Object(r.useMemo)((()=>g.map((t=>{const n=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:p,refresh:m});return{title:t.title,content:n,id:t.id,width:o.a}}))),[p,g,e,m])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(256);const i=({refetch:e,onRuleChange:t,isActiveTimelines:n})=>{const{setAllTourStepsHidden:i}=Object(r.b)(),[o,s]=Object(a.useState)(!1),[l,c]=Object(a.useState)(null);return{exceptionFlyoutType:l,openAddExceptionFlyout:o,onAddExceptionTypeClick:Object(a.useCallback)((e=>{c(null!=e?e:null),i(!0),s(!0)}),[i]),onAddExceptionCancel:Object(a.useCallback)((()=>{c(null),i(!1),s(!1)}),[i]),onAddExceptionConfirm:Object(a.useCallback)(((a,r,o)=>{e&&(!1===n||o)&&e(),null!=t&&a&&t(),i(!1),s(!1)}),[e,n,t,i])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var a=n(19),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(121),c=n(510);const u=s.a.span.withConfig({displayName:"NotificationDot",componentId:"sc-v4xtfs-0"})(["position:absolute;display:block;width:6px;height:6px;border-radius:50%;background-color:",";top:17%;left:52%;"],(({theme:e})=>e.eui.euiColorDanger)),d="notes-button",p=s()(a.EuiFlexGroup).withConfig({displayName:"NotesButtonContainer",componentId:"sc-v4xtfs-1"})(["position:relative;"]),m=i.a.memo((({ariaLabel:e=c.b,isDisabled:t,toggleShowNotes:n,timelineType:o,eventId:s,notesCount:m})=>{const f=o===l.m.template,g=Object(r.useCallback)((()=>{null!=s?null==n||n(s):null==n||n()}),[n,s]);return i.a.createElement(p,null,i.a.createElement(a.EuiFlexItem,{grow:!1},m>0?i.a.createElement(u,{className:"timeline-notes-notification-dot","data-test-subj":"timeline-notes-notification-dot"}):null,i.a.createElement(a.EuiButtonIcon,{"aria-label":e,className:d,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:g,size:"s",isDisabled:f})))}));m.displayName="SmallNotesButton";const f=i.a.memo((({ariaLabel:e,isDisabled:t,timelineType:n,toggleShowNotes:r,toolTip:o,eventId:s,notesCount:l})=>i.a.createElement(a.EuiToolTip,{content:o,"data-test-subj":"timeline-notes-tool-tip"},i.a.createElement(m,{ariaLabel:e,isDisabled:t,toggleShowNotes:r,timelineType:n,eventId:s,notesCount:null!=l?l:0}))));f.displayName="NotesButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(67),r=n(544);const i=(e,t={})=>{var n;return e.get(r.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${a.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`},version:a.API_VERSIONS.public.v1})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=()=>{const[e,t]=Object(a.useState)(!1),n=Object(a.useCallback)((()=>{t(!0)}),[]);return{closeAddEventFilterModal:Object(a.useCallback)((()=>{t(!1)}),[]),isAddEventFilterModalOpen:e,onAddEventFilterClick:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return y}));var a=n(19),r=n(44),i=n(2),o=n.n(i),s=n(134),l=n(130),c=n(144),u=n(378);const d="ip-overview",p=(e,t,n,c)=>e.length>0&&e.every((e=>Object(r.getOr)(null,e,t)))?o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},e.map(((e,l)=>{const u=Object(r.getOr)("",e,t);return o.a.createElement(i.Fragment,{key:`${d}-${e}`},l?", ":"",o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`location-renderer-default-draggable-${d}-${n?`${n}-`:""}${e}`,isDraggable:null!=c&&c,field:e,value:u,isAggregatable:!0,fieldType:"keyword"})))}))):Object(l.d)(),m=(e,t,n,r)=>e&&e.organization&&e.organization.name&&e.number?o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`autonomous-system-renderer-default-draggable-${d}-${n?`${n}-`:""}${t}.as.organization.name`,isDraggable:null!=r&&r,field:`${t}.as.organization.name`,value:e.organization.name})),o.a.createElement(a.EuiFlexItem,{grow:!1},"/"),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`autonomous-system-renderer-default-draggable-${d}-${n?`${n}-`:""}${t}.as.number`,isDraggable:!1,field:`${t}.as.number`,value:`${e.number}`,isAggregatable:!0,fieldType:"number"}))):Object(l.d)(),f=({contextID:e,host:t,isDraggable:n=!1,ipFilter:a,noLink:r})=>t.id&&t.ip&&(null==a||t.ip.includes(a))?o.a.createElement(o.a.Fragment,null,t.name&&null!=t.name[0]?o.a.createElement(s.b,{id:`host-id-renderer-default-draggable-${d}-${e?`${e}-`:""}host-id`,isDraggable:n,field:"host.id",value:t.id[0],isAggregatable:!0,fieldType:"keyword"},r?o.a.createElement(o.a.Fragment,null,t.id):o.a.createElement(c.d,{hostName:t.name[0]},t.id)):o.a.createElement(o.a.Fragment,null,t.id)):Object(l.d)(),g=(e,t,n,a)=>e&&e.name&&e.name[0]&&e.ip&&(null==t||e.ip.includes(t))?o.a.createElement(s.b,{id:`host-name-renderer-default-draggable-${d}-${n?`${n}-`:""}host-name`,isDraggable:null!=a&&a,field:"host.name",value:e.name[0],isAggregatable:!0,fieldType:"keyword"},o.a.createElement(c.d,{hostName:e.name[0]},e.name?e.name:Object(l.d)())):Object(l.d)(),b=e=>o.a.createElement(c.n,{domain:e},u.n),y=e=>o.a.createElement(c.j,{domain:e,direction:"column"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n.n(a),i=n(355),o=n(759);const s=e=>[{headerCellRender:()=>r.a.createElement(r.a.Fragment,null,o.a),id:"default-timeline-control-column",rowCellRender:i.a,width:Object(i.c)(e)}]},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return jt}));var a=n(19),r=n(2),i=n.n(r),o=n(45),s=n(41),l=n.n(s),c=n(121),u=n(124),d=n(13),p=n(129),m=n(158),f=n(44);const g={process:{hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTY5MjAtMTMyNDg5OTk2OTAuNDgzMzA3NzAw"],executable:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],name:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],pid:[6920],args:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1518)"],name:["Windows"],version:["1809 (10.0.17763.1518)"],platform:["windows"],family:["windows"],kernel:["1809 (10.0.17763.1518)"]},mac:["aa:bb:cc:dd:ee:ff"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"],name:["win2019-endpoint-1"]},file:{mtime:["2020-11-04T21:40:51.494Z"],path:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],owner:["sean"],hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},name:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],extension:["exe"],size:[1604112]},event:{category:["malware","intrusion_detection","process"],outcome:["success"],severity:[73],code:["malicious_file"],action:["execution"],id:["LsuMZVr+sdhvehVM++++Gp2Y"],kind:["alert"],created:["2020-11-04T21:41:30.533Z"],module:["endpoint"],type:["info","start","denied"],dataset:["endpoint.alerts"]},agent:{type:["endpoint"]},timestamp:"2020-11-04T21:41:30.533Z",message:["Malware Prevention Alert"],_id:"0dA2lXUBn9bLIbfPkY7d"};var b=n(231),y=n(230),h=n(171);const v=()=>{const e=Object(b.c)({eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:y.S});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:g,isDraggable:!1,scopeId:h.a}))},E=i.a.memo(v),x=[{_id:"1",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"event.kind",value:["signal"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3],kind:["signal"]},source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"3",data:[{field:"@timestamp",value:["2018-11-07T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["nginx"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["evan.davis"]}],ecs:{_id:"3",timestamp:"2018-11-07T19:03:25.937Z",host:{name:["nginx"],ip:["192.168.0.1"]},event:{id:["3"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[1]},source:{ip:["192.168.0.3"],port:[443]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["3"],name:["evan.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"4",data:[{field:"@timestamp",value:["2018-11-08T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Attempted Administrator Privilege Gain"]},{field:"host.name",value:["suricata"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jenny.jones"]}],ecs:{_id:"4",timestamp:"2018-11-08T19:03:25.937Z",host:{name:["suricata"],ip:["192.168.0.1"]},event:{id:["4"],category:["Attempted Administrator Privilege Gain"],type:["Alert"],module:["suricata"],severity:[1]},source:{ip:["192.168.0.3"],port:[53]},destination:{ip:["192.168.0.3"],port:[6343]},suricata:{eve:{flow_id:[4],proto:[""],alert:{signature:["ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174)"],signature_id:[4]}}},user:{id:["4"],name:["jenny.jones"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"5",data:[{field:"@timestamp",value:["2018-11-09T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["becky.davis"]}],ecs:{_id:"5",timestamp:"2018-11-09T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["5"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.3"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["5"],name:["becky.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"6",data:[{field:"@timestamp",value:["2018-11-10T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["braden.davis"]},{field:"source.ip",value:["192.168.0.6"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"6",timestamp:"2018-11-10T19:03:25.937Z",host:{name:["braden.davis"],ip:["192.168.0.1"]},event:{id:["6"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.6"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"8",data:[{field:"@timestamp",value:["2018-11-12T19:03:25.937Z"]},{field:"event.severity",value:["2"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"8",timestamp:"2018-11-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["8"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[2]},suricata:{eve:{flow_id:[8],proto:[""],alert:{signature:["ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie"],signature_id:[8]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["8"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"7",data:[{field:"@timestamp",value:["2018-11-11T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.7"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"7",timestamp:"2018-11-11T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["7"],category:["Access"],type:["HTTP Request"],module:["apache"],severity:[3]},source:{ip:["192.168.0.7"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["7"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"9",data:[{field:"@timestamp",value:["2018-11-13T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.9"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"9",timestamp:"2018-11-13T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["9"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.9"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["9"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"10",data:[{field:"@timestamp",value:["2018-11-14T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.10"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"10",timestamp:"2018-11-14T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["10"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.10"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["10"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"11",data:[{field:"@timestamp",value:["2018-11-15T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.11"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"11",timestamp:"2018-11-15T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["11"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.11"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["11"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"12",data:[{field:"@timestamp",value:["2018-11-16T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.12"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"12",timestamp:"2018-11-16T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["12"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.12"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["12"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"2",data:[{field:"@timestamp",value:["2018-11-06T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Authentication"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.2"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["joe.bob"]}],ecs:{_id:"2",timestamp:"2018-11-06T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["2"],category:["Authentication"],type:["Authentication Success"],module:["authlog"],severity:[3]},source:{ip:["192.168.0.2"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["joe.bob"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"13",data:[{field:"@timestamp",value:["2018-13-12T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"13",timestamp:"2018-12-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["13"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[1]},suricata:{eve:{flow_id:[13],proto:[""],alert:{signature:["ET WEB_SERVER Possible Attempt in HTTP Cookie"],signature_id:[13]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"14",data:[{field:"@timestamp",value:["2019-03-07T05:06:51.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.26.101"]},{field:"destination.ip",value:["192.168.238.205"]}],ecs:{_id:"14",timestamp:"2019-03-07T05:06:51.000Z",event:{module:["zeek"],dataset:["zeek.connection"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["185.176.26.101"],port:[44059]},destination:{ip:["207.154.238.205"],port:[11568]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["tcp"]},zeek:{session_id:["C8DRTq362Fios6hw16"],connection:{local_resp:[!1],local_orig:[!1],missed_bytes:[0],state:["REJ"],history:["Sr"]}}}},{_id:"15",data:[{field:"@timestamp",value:["2019-03-07T00:51:28.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.67.3"]}],ecs:{_id:"15",timestamp:"2019-03-07T00:51:28.000Z",event:{module:["zeek"],dataset:["zeek.dns"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[57475]},destination:{ip:["67.207.67.3"],port:[53]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["udp"]},zeek:{session_id:["CyIrMA1L1JtLqdIuol"],dns:{AA:[!1],RD:[!1],trans_id:[65252],RA:[!1],TC:[!1]}}}},{_id:"16",data:[{field:"@timestamp",value:["2019-03-05T07:00:20.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.164.26"]}],ecs:{_id:"16",timestamp:"2019-03-05T07:00:20.000Z",event:{module:["zeek"],dataset:["zeek.http"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[36220]},destination:{ip:["192.241.164.26"],port:[80]},geo:{region_name:["New York"],country_iso_code:["US"]},http:{version:["1.1"],request:{body:{bytes:[0]}},response:{status_code:[302],body:{bytes:[154]}}},zeek:{session_id:["CZLkpC22NquQJOpkwe"],http:{resp_mime_types:["text/html"],trans_depth:["3"],status_msg:["Moved Temporarily"],resp_fuids:["FzeujEPP7GTHmYPsc"],tags:[]}}}},{_id:"17",data:[{field:"@timestamp",value:["2019-02-28T22:36:28.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.77.171"]}],ecs:{_id:"17",timestamp:"2019-02-28T22:36:28.000Z",event:{module:["zeek"],dataset:["zeek.notice"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["8.42.77.171"]},zeek:{notice:{suppress_for:[3600],msg:["8.42.77.171 scanned at least 15 unique ports of host 207.154.238.205 in 0m0s"],note:["Scan::Port_Scan"],sub:["remote"],dst:["207.154.238.205"],dropped:[!1],peer_descr:["bro"]}}}},{_id:"18",data:[{field:"@timestamp",value:["2019-02-22T21:12:13.000Z"]},{field:"host.name",value:["zeek-sensor-amsterdam"]},{field:"source.ip",value:["192.168.66.184"]},{field:"destination.ip",value:["192.168.95.15"]}],ecs:{_id:"18",timestamp:"2019-02-22T21:12:13.000Z",event:{module:["zeek"],dataset:["zeek.ssl"]},host:{id:["2ce8b1e7d69e4a1d9c6bcddc473da9d9"],name:["zeek-sensor-amsterdam"]},source:{ip:["188.166.66.184"],port:[34514]},destination:{ip:["91.189.95.15"],port:[443]},geo:{region_name:["England"],country_iso_code:["GB"]},zeek:{session_id:["CmTxzt2OVXZLkGDaRe"],ssl:{cipher:["TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"],established:[!1],resumed:[!1],version:["TLSv12"]}}}},{_id:"19",data:[{field:"@timestamp",value:["2019-03-03T04:26:38.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]}],ecs:{_id:"19",timestamp:"2019-03-03T04:26:38.000Z",event:{module:["zeek"],dataset:["zeek.files"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},zeek:{session_id:["Cu0n232QMyvNtzb75j"],files:{session_ids:["Cu0n232QMyvNtzb75j"],timedout:[!1],local_orig:[!1],tx_host:["5.101.111.50"],source:["HTTP"],is_orig:[!1],overflow_bytes:[0],sha1:["fa5195a5dfacc9d1c68d43600f0e0262cad14dde"],duration:[0],depth:[0],analyzers:["MD5","SHA1"],mime_type:["text/plain"],rx_host:["206.189.35.240"],total_bytes:[88722],fuid:["FePz1uVEVCZ3I0FQi"],seen_bytes:[1198],missing_bytes:[0],md5:["f7653f1951693021daa9e6be61226e32"]}}}},{_id:"20",data:[{field:"@timestamp",value:["2019-03-13T05:42:11.815Z"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-sanfran"]},{field:"process.args",value:["gpgconf","--list-dirs","agent-socket"]}],ecs:{_id:"20",timestamp:"2019-03-13T05:42:11.815Z",event:{action:["executed"],module:["auditd"],category:["audit-rule"]},host:{id:["f896741c3b3b44bdb8e351a4ab6d2d7c"],name:["zeek-sanfran"],ip:["134.209.63.134","10.46.0.5","fe80::a0d9:16ff:fecf:e70b"]},user:{name:["alice"]},process:{pid:[5402],name:["gpgconf"],ppid:[5401],args:["gpgconf","--list-dirs","agent-socket"],executable:["/usr/bin/gpgconf"],title:["gpgconf --list-dirs agent-socket"],working_directory:["/"]}}},{_id:"21",data:[{field:"@timestamp",value:["2019-03-14T22:30:25.527Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"source.ip",value:["192.168.77.171"]},{field:"user.name",value:["root"]}],ecs:{_id:"21",timestamp:"2019-03-14T22:30:25.527Z",event:{action:["logged-in"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["14"],data:{terminal:["/dev/pts/0"],op:["login"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["/dev/pts/0"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["8.42.77.171"]},user:{name:["root"]},process:{pid:[17471],executable:["/usr/sbin/sshd"]}}},{_id:"22",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"22",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["disposed-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:setcred"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"23",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"23",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["ended-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:session_close"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"24",data:[{field:"@timestamp",value:["2019-03-18T23:17:01.645Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"24",timestamp:"2019-03-18T23:17:01.645Z",event:{action:["acquired-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["unset"],data:{acct:["root"],terminal:["cron"],op:["PAM:setcred"]},summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[9592],executable:["/usr/sbin/cron"]}}},{_id:"25",data:[{field:"@timestamp",value:["2019-03-19T01:17:01.336Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["siem-kibana"]},{field:"user.name",value:["root"]}],ecs:{_id:"25",timestamp:"2019-03-19T01:17:01.336Z",event:{action:["started-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["2908"],data:{acct:["root"],terminal:["cron"],op:["PAM:session_open"]},summary:{actor:{primary:["root"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["aa7ca589f1b8220002f2fc61c64cfbf1"],name:["siem-kibana"]},user:{name:["root"]},process:{pid:[725],executable:["/usr/sbin/cron"]}}},{_id:"26",data:[{field:"@timestamp",value:["2019-03-13T03:34:08.890Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["alice"]}],ecs:{_id:"26",timestamp:"2019-03-13T03:34:08.890Z",event:{action:["was-authorized"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["338"],data:{terminal:["/dev/pts/0"]},summary:{actor:{primary:["root"],secondary:["alice"]},object:{primary:["/dev/pts/0"],type:["user-session"]},how:["/sbin/pam_tally2"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["alice"]},process:{pid:[21170],executable:["/sbin/pam_tally2"]}}},{_id:"27",data:[{field:"@timestamp",value:["2019-03-22T19:13:11.026Z"]},{field:"event.action",value:["connected-to"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"destination.ip",value:["192.168.216.34"]},{field:"user.name",value:["alice"]}],ecs:{_id:"27",timestamp:"2019-03-22T19:13:11.026Z",event:{action:["connected-to"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["246"],summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["192.168.216.34"],secondary:["80"],type:["socket"]},how:["/usr/bin/wget"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},destination:{ip:["192.168.216.34"],port:[80]},user:{name:["alice"]},process:{pid:[1490],name:["wget"],ppid:[1476],executable:["/usr/bin/wget"],title:["wget www.example.com"]}}},{_id:"28",data:[{field:"@timestamp",value:["2019-03-26T22:12:18.609Z"]},{field:"event.action",value:["opened-file"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"28",timestamp:"2019-03-26T22:12:18.609Z",event:{action:["opened-file"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["242"],summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["/proc/15990/attr/current"],type:["file"]},how:["/lib/systemd/systemd-journald"]}},file:{path:["/proc/15990/attr/current"],device:["00:00"],inode:["27672309"],uid:["0"],owner:["root"],gid:["0"],group:["root"],mode:["0666"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[27244],name:["systemd-journal"],ppid:[1],executable:["/lib/systemd/systemd-journald"],title:["/lib/systemd/systemd-journald"],working_directory:["/"]}}},{_id:"29",data:[{field:"@timestamp",value:["2019-04-08T21:18:57.000Z"]},{field:"event.action",value:["user_login"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Braden"]}],ecs:{_id:"29",event:{action:["user_login"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Braden"]},process:{pid:[6278]}}},{_id:"30",data:[{field:"@timestamp",value:["2019-04-08T22:27:14.814Z"]},{field:"event.action",value:["process_started"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Evan"]}],ecs:{_id:"30",event:{action:["process_started"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Evan"]},process:{pid:[6278]}}},{_id:"31",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"message",value:["I am a log file message"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3]},message:["I am a log file message"],source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"32",data:[],ecs:{_id:"BuBP4W0BOpWiDweSoYSg",timestamp:"2019-10-18T23:59:15.091Z",threat:{enrichments:[{indicator:{provider:["indicator_provider"],reference:["https://example.com"]},matched:{atomic:["192.168.1.1"],field:["source.ip"],type:["ip"]},feed:{name:["feed_name"]}}]}}}];var j=n(626),O=n(316);const S=()=>{const e=Object(j.b)({actionName:"connected-to",text:O.T});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:x[26].ecs,isDraggable:!1,scopeId:h.a}))},w=i.a.memo(S),k=()=>{const e=Object(j.c)({actionName:"opened-file",text:`${O.Db} ${O.kc}`});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:x[27].ecs,isDraggable:!1,scopeId:h.a}))},I=i.a.memo(k),T={file:{path:["C:\\Windows\\System32\\bcrypt.dll"],hash:{md5:["00439016776de367bad087d739a03797"],sha1:["2c4ba5c1482987d50a182bad915f52cd6611ee63"],sha256:["e70f5d8f87aab14e3160227d38387889befbe37fa4f8f5adc59eff52804b35fd"]},name:["bcrypt.dll"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["library"],kind:["event"],created:["2021-02-05T21:27:23.921Z"],module:["endpoint"],action:["load"],type:["start"],id:["LzzWB9jjGmCwGMvk++++Da5H"],dataset:["endpoint.events.library"]},process:{name:["sshd.exe"],pid:[9644],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTk2NDQtMTMyNTcwMzQwNDEuNzgyMTczODAw"],executable:["C:\\Program Files\\OpenSSH-Win64\\sshd.exe"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint DLL load event"],timestamp:"2021-02-05T21:27:23.921Z",_id:"IAUYdHcBGrBB52F2zo8Q"},C=()=>{const e=Object(b.d)({actionName:"load",text:y.q});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:T,isDraggable:!1,scopeId:h.a}))},M=i.a.memo(C);var _=n(1368),D=n(837);const N=()=>i.a.createElement(i.a.Fragment,null,D.a.renderRow({data:{destination:{bytes:[40],geo:{city_name:["New York"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["New York"]},ip:["10.1.2.3"],packets:[1],port:[80]},event:{action:["network_flow"],category:["network_traffic"],duration:[_.a],end:["2018-11-12T19:03:25.936Z"],start:["2018-11-12T19:03:25.836Z"]},_id:"abcd",network:{bytes:[100],community_id:["we.live.in.a"],direction:["outgoing"],packets:[3],protocol:["http"],transport:["tcp"]},process:{name:["rat"]},source:{bytes:[60],geo:{city_name:["Atlanta"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["Georgia"]},ip:["192.168.1.2"],packets:[2],port:[9987]},timestamp:"2018-11-12T19:03:25.936Z",tls:{client_certificate:{fingerprint:{sha1:["tls.client_certificate.fingerprint.sha1-value"]}},fingerprints:{ja3:{hash:["tls.fingerprints.ja3.hash-value"]}},server_certificate:{fingerprint:{sha1:["tls.server_certificate.fingerprint.sha1-value"]}}},user:{name:["first.last"]}},isDraggable:!1,scopeId:h.a})),A=i.a.memo(N),F={host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["registry"],kind:["event"],created:["2021-02-04T13:44:31.559Z"],module:["endpoint"],action:["modification"],type:["change"],id:["LzzWB9jjGmCwGMvk++++CbOn"],dataset:["endpoint.events.registry"]},process:{name:["GoogleUpdate.exe"],pid:[7408],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTc0MDgtMTMyNTY5MTk4NDguODY4NTI0ODAw"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},registry:{hive:["HKLM"],key:["SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState"],path:["HKLM\\SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState\\StateValue"],value:["StateValue"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint registry event"],timestamp:"2021-02-04T13:44:31.559Z",_id:"4cxLbXcBGrBB52F2uOfF"},P=()=>{const e=Object(b.e)({actionName:"modification",text:y.u});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:F,isDraggable:!1,scopeId:h.a}))},R=i.a.memo(P);var L=n(863);const q=()=>i.a.createElement(i.a.Fragment,null,L.a.renderRow({data:x[2].ecs,isDraggable:!1,scopeId:h.a})),z=i.a.memo(q),B={_id:"2MjPcG0BOpWiDweSoutC",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["termination_event"],category:["process"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["bd4401441a21bf1abce6404f4231db4d"],sha1:["797255e72d5ed5c058d4785950eba7abaa057653"],sha256:["87976f3430cc99bc939e0694247c0759961a49832b87218f4313d6fc0bc3a776"]},pid:[442384],ppid:[8],name:["RuntimeBroker.exe"],executable:["C:\\Windows\\System32\\RuntimeBroker.exe"]},endgame:{pid:[442384],process_name:["RuntimeBroker.exe"],exit_code:[0]}},$=()=>{const e=Object(b.h)({actionName:"termination_event",text:y.H});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:B,isDraggable:!1,scopeId:h.a}))},V=i.a.memo($),U={_id:"S8jPcG0BOpWiDweSou3g",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["request_event"],category:["network"],kind:["event"]},message:["DNS query is completed for the name %1, type %2, query options %3 with status %4 Results %5 "],timestamp:"1569555712000",dns:{question:{name:["update.googleapis.com"],type:["A"]},resolved_ip:["10.100.197.67"]},network:{protocol:["dns"]},process:{pid:[443192],name:["GoogleUpdate.exe"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},winlog:{event_id:[3008]},endgame:{process_name:["GoogleUpdate.exe"],pid:[443192]}},G=()=>{const e=Object(b.a)();return i.a.createElement(i.a.Fragment,null,e.renderRow({data:U,isDraggable:!1,scopeId:h.a}))},H=i.a.memo(G),W={_id:"BcjPcG0BOpWiDweSou3g",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["creation_event"],category:["process"],type:["process_start"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["62d06d7235b37895b68de56687895743"],sha1:["12563599116157778a22600d2a163d8112aed845"],sha256:["d4c97ed46046893141652e2ec0056a698f6445109949d7fcabbce331146889ee"]},pid:[441684],ppid:[8],name:["Microsoft.Photos.exe"],executable:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe"],args:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe","-ServerName:App.AppXzst44mncqdg84v7sv6p7yznqwssy6f7f.mca"]},endgame:{process_name:["Microsoft.Photos.exe"],pid:[441684],parent_process_name:["svchost.exe"]}},Q=()=>{const e=Object(b.b)({actionName:"creation_event",text:y.A});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:W,isDraggable:!1,scopeId:h.a}))},Y=i.a.memo(Q),K={_id:"98jPcG0BOpWiDweSouzg",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["file_create_event"],category:["file"],kind:["event"]},timestamp:"1569555712000",endgame:{process_name:["chrome.exe"],pid:[11620],file_path:["C:\\Users\\Arun\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\63d78c21-e593-4484-b7a9-db33cd522ddc.tmp"]}},Z={_id:"OMjPcG0BOpWiDweSeuW9",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["file_delete_event"],category:["file"],kind:["event"]},timestamp:"1569555704000",endgame:{pid:[1084],file_name:["tmp000002f6"],file_path:["C:\\Windows\\TEMP\\tmp00000404\\tmp000002f6"],process_name:["AmSvc.exe"]}},X=()=>{const e=Object(b.g)({actionName:"file_delete_event",text:y.f});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:Z,isDraggable:!1,scopeId:h.a}))},J=i.a.memo(X),ee=()=>{const e=Object(b.f)({actionName:"file_create_event",text:y.e});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:K,isDraggable:!1,scopeId:h.a}))},te=i.a.memo(ee),ne={_id:"QsjPcG0BOpWiDweSeuRE",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["user_logon"],category:["authentication"],type:["authentication_success"],kind:["event"]},message:["An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tWIN-Q3DOP1UKA81$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3e7\r\n\r\nLogon Type:\t\t\t5\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3e7\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x1b0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."],timestamp:"1569555704000",process:{pid:[432],name:["C:\\Windows\\System32\\services.exe"],executable:["C:\\Windows\\System32\\services.exe"]},winlog:{event_id:[4624]},endgame:{target_logon_id:["0x3e7"],pid:[432],process_name:["C:\\Windows\\System32\\services.exe"],logon_type:[5],subject_user_name:["WIN-Q3DOP1UKA81$"],subject_logon_id:["0x3e7"],target_user_name:["SYSTEM"],target_domain_name:["NT AUTHORITY"]}},ae=()=>{const e=Object(b.i)({actionName:"user_logon"});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:ne,isDraggable:!1,scopeId:h.a}))},re=i.a.memo(ae),ie={_id:"LsjPcG0BOpWiDweSCNfu",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.43.255.177"],name:["HD-gqf-0af7b4fe"]},event:{module:["endgame"],dataset:["esensor"],action:["ipv4_connection_accept_event"],category:["network"],kind:["event"]},timestamp:"1569555676000",network:{community_id:["1:network-community_id"],transport:["tcp"]},process:{pid:[1084],name:["AmSvc.exe"],executable:["C:\\Program Files\\Cybereason ActiveProbe\\AmSvc.exe"]},source:{ip:["127.0.0.1"],port:[49306]},destination:{port:[49305],ip:["127.0.0.1"]},endgame:{pid:[1084]}},oe=()=>{const e=Object(b.j)({actionName:"ipv4_connection_accept_event",text:y.b});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:ie,isDraggable:!1,scopeId:h.a}))},se=i.a.memo(oe);var le=n(861);const ce=()=>i.a.createElement(i.a.Fragment,null,le.a.renderRow({data:x[31].ecs,isDraggable:!1,scopeId:h.a})),ue=i.a.memo(ce);var de=n(865);const pe=()=>i.a.createElement(i.a.Fragment,null,de.a.renderRow({data:x[13].ecs,isDraggable:!1,scopeId:h.a})),me=i.a.memo(pe);var fe=n(4);const ge=fe.i18n.translate("xpack.securitySolution.eventRenderers.alertName",{defaultMessage:"Alert"}),be=fe.i18n.translate("xpack.securitySolution.eventRenderers.alertsName",{defaultMessage:"Alerts"}),ye=fe.i18n.translate("xpack.securitySolution.eventRenderers.alertsDescription",{defaultMessage:"Alerts are displayed when malware or ransomware is prevented and detected"}),he=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdName",{defaultMessage:"Auditd"}),ve=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdDescriptionPart1",{defaultMessage:"audit events convey security-relevant logs from the Linux Audit Framework."}),Ee=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileName",{defaultMessage:"Auditd File"}),xe=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),je=fe.i18n.translate("xpack.securitySolution.eventRenderers.authenticationName",{defaultMessage:"Authentication"}),Oe=fe.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart1",{defaultMessage:"Authentication events show users (and system accounts) successfully or unsuccessfully logging into hosts."}),Se=fe.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart2",{defaultMessage:"Some authentication events may include additional details when users authenticate on behalf of other users."}),we=fe.i18n.translate("xpack.securitySolution.eventRenderers.dnsName",{defaultMessage:"Domain Name System (DNS)"}),ke=fe.i18n.translate("xpack.securitySolution.eventRenderers.dnsDescriptionPart1",{defaultMessage:"Domain Name System (DNS) events show users (and system accounts) making requests via specific processes to translate from host names to IP addresses."}),Ie=fe.i18n.translate("xpack.securitySolution.eventRenderers.fileName",{defaultMessage:"File"}),Te=fe.i18n.translate("xpack.securitySolution.eventRenderers.fileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),Ce=fe.i18n.translate("xpack.securitySolution.eventRenderers.fimName",{defaultMessage:"File Integrity Module (FIM)"}),Me=fe.i18n.translate("xpack.securitySolution.eventRenderers.fimDescriptionPart1",{defaultMessage:"File Integrity Module (FIM) events show users (and system accounts) performing CRUD operations on files via specific processes."}),_e=fe.i18n.translate("xpack.securitySolution.eventRenderers.flowName",{defaultMessage:"Flow"}),De=fe.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart1",{defaultMessage:"The Flow renderer visualizes the flow of data between a source and destination. It's applicable to many types of events."}),Ne=fe.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart2",{defaultMessage:"The hosts, ports, protocol, direction, duration, amount transferred, process, geographic location, and other details are visualized when available."}),Ae=fe.i18n.translate("xpack.securitySolution.eventRenderers.libraryName",{defaultMessage:"Library"}),Fe=fe.i18n.translate("xpack.securitySolution.eventRenderers.libraryDescription",{defaultMessage:"Library events display a Dynamically Linked Library (DLL) being loaded by a process"}),Pe=fe.i18n.translate("xpack.securitySolution.eventRenderers.processName",{defaultMessage:"Process"}),Re=fe.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart1",{defaultMessage:"Process events show users (and system accounts) starting and stopping processes."}),Le=fe.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart2",{defaultMessage:"Details including the command line arguments, parent process, and if applicable, file hashes are displayed when available."}),qe=fe.i18n.translate("xpack.securitySolution.eventRenderers.registryName",{defaultMessage:"Registry"}),ze=fe.i18n.translate("xpack.securitySolution.eventRenderers.registryDescription",{defaultMessage:"Registry events show updates to the Windows Registry"}),Be=fe.i18n.translate("xpack.securitySolution.eventRenderers.socketName",{defaultMessage:"Socket (Network)"}),$e=fe.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart1",{defaultMessage:"Socket (Network) events show processes listening, accepting, and closing connections."}),Ve=fe.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart2",{defaultMessage:"Details including the protocol, ports, and a community ID for correlating all network events related to a single flow are displayed when available."}),Ue=fe.i18n.translate("xpack.securitySolution.eventRenderers.suricataName",{defaultMessage:"Suricata"}),Ge=fe.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart1",{defaultMessage:"Summarizes"}),He=fe.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart2",{defaultMessage:"intrusion detection (IDS), inline intrusion prevention (IPS), and network security monitoring (NSM) events"}),We=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemName",{defaultMessage:"System"}),Qe=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart1",{defaultMessage:"The Auditbeat"}),Ye=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart2",{defaultMessage:"module collects various security related information about a system."}),Ke=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart3",{defaultMessage:"All datasets send both periodic state information (e.g. all currently running processes) and real-time changes (e.g. when a new process starts or stops)."}),Ze=fe.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchName",{defaultMessage:"Threat Indicator Match"}),Xe=fe.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchDescription",{defaultMessage:"Summarizes events that matched threat indicators"}),Je=fe.i18n.translate("xpack.securitySolution.eventRenderers.zeekName",{defaultMessage:"Zeek (formerly Bro)"}),et=fe.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart1",{defaultMessage:"Summarizes events from the"}),tt=fe.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart2",{defaultMessage:"Network Security Monitoring (NSM) tool"}),nt={[c.e.alert]:ge,[c.e.alerts]:be,[c.e.auditd]:he,[c.e.auditd_file]:Ee,[c.e.library]:Ae,[c.e.system_security_event]:je,[c.e.system_dns]:we,[c.e.netflow]:_e,[c.e.system]:We,[c.e.system_endgame_process]:Pe,[c.e.registry]:qe,[c.e.system_fim]:Ce,[c.e.system_file]:Ie,[c.e.system_socket]:Be,[c.e.suricata]:"Suricata",[c.e.threat_match]:Ze,[c.e.zeek]:Je,[c.e.plain]:""},at=({children:e,url:t})=>i.a.createElement(a.EuiLink,{href:t,target:"_blank",rel:"noopener nofollow noreferrer","data-test-subj":"externalLink"},e),rt=[{id:c.e.alerts,name:nt[c.e.alerts],description:ye,example:E,searchableDescription:ye},{id:c.e.auditd,name:nt[c.e.auditd],description:i.a.createElement("span",null,i.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},he)," ",ve),example:w,searchableDescription:`${he} ${ve}`},{id:c.e.auditd_file,name:nt[c.e.auditd_file],description:i.a.createElement("span",null,i.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},he)," ",xe),example:I,searchableDescription:`${Ee} ${xe}`},{id:c.e.library,name:nt[c.e.library],description:Fe,example:M,searchableDescription:Fe},{id:c.e.system_security_event,name:nt[c.e.system_security_event],description:i.a.createElement("div",null,i.a.createElement("p",null,Oe),i.a.createElement("br",null),i.a.createElement("p",null,Se)),example:re,searchableDescription:`${Oe} ${Se}`},{id:c.e.system_dns,name:nt[c.e.system_dns],description:ke,example:H,searchableDescription:ke},{id:c.e.netflow,name:nt[c.e.netflow],description:i.a.createElement("div",null,i.a.createElement("p",null,De),i.a.createElement("br",null),i.a.createElement("p",null,Ne)),example:A,searchableDescription:`${De} ${Ne}`},{id:c.e.system,name:nt[c.e.system],description:i.a.createElement("div",null,i.a.createElement("p",null,Qe," ",i.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-system.html"},We)," ",Ye),i.a.createElement("br",null),i.a.createElement("p",null,Ke)),example:V,searchableDescription:`${Qe} ${We} ${Ye} ${Ke}`},{id:c.e.system_endgame_process,name:nt[c.e.system_endgame_process],description:i.a.createElement("div",null,i.a.createElement("p",null,Re),i.a.createElement("br",null),i.a.createElement("p",null,Le)),example:Y,searchableDescription:`${Re} ${Le}`},{id:c.e.registry,name:nt[c.e.registry],description:ze,example:R,searchableDescription:ze},{id:c.e.system_fim,name:nt[c.e.system_fim],description:Me,example:te,searchableDescription:Me},{id:c.e.system_file,name:nt[c.e.system_file],description:Te,example:J,searchableDescription:Te},{id:c.e.system_socket,name:nt[c.e.system_socket],description:i.a.createElement("div",null,i.a.createElement("p",null,$e),i.a.createElement("br",null),i.a.createElement("p",null,Ve)),example:se,searchableDescription:`${$e} ${Ve}`},{id:c.e.suricata,name:nt[c.e.suricata],description:i.a.createElement("p",null,Ge," ",i.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-suricata.html"},Ue)," ",He),example:z,searchableDescription:`${Ge} ${Ue} ${He}`},{id:c.e.threat_match,name:nt[c.e.threat_match],description:Xe,example:ue,searchableDescription:`${Ze} ${Xe}`},{id:c.e.zeek,name:nt[c.e.zeek],description:i.a.createElement("p",null,et," ",i.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-zeek.html"},Je)," ",tt),example:me,searchableDescription:`${et} ${Je} ${tt}`}],it=l()(a.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-ietqpj-0"})([".euiTable{tr:has(.isNotSelected){background-color:",";}tr > *:last-child{display:none;}.euiTableHeaderCellCheckbox > .euiTableCellContent{display:none;}}"],(e=>e.theme.eui.euiColorLightestShade)),ot=l()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-ietqpj-1"})(["overflow:auto;> div{padding:0;> div{margin:0;}}"]),st=e=>{if(e)return i.a.createElement(ot,{grow:1},i.a.createElement(e,null))},lt={box:{incremental:!0,schema:!0}},ct=()=>i.a.createElement(i.a.Fragment,null),ut={sort:{field:"name",direction:"asc"}},dt=l.a.button.withConfig({displayName:"StyledNameButton",componentId:"sc-ietqpj-2"})(["text-align:left;"]),pt=({excludedRowRendererIds:e=[],setExcludedRowRendererIds:t})=>{const n=Object(r.useCallback)((n=>()=>{const a=Object(f.xor)([n.id],e);t(a)}),[e,t]),o=Object(r.useCallback)(((e,t)=>i.a.createElement(dt,{className:"kbn-resetFocusState",onClick:n(t)},e)),[n]),s=Object(r.useCallback)(((t,r)=>i.a.createElement(a.EuiCheckbox,{id:r.id,onChange:n(r),className:e.includes(r.id)?"isNotSelected":"isSelected",checked:!e.includes(r.id)})),[e,n]),l=Object(r.useMemo)((()=>[{field:"id",name:"",sortable:!1,width:"32px",render:s,"data-test-subj":"renderer-checkbox"},{field:"name",name:"Name",sortable:!0,width:"10%",render:o,"data-test-subj":"renderer-name"},{field:"description",name:"Description",width:"25%",render:e=>e,"data-test-subj":"renderer-description"},{field:"example",name:"Example",width:"65%",render:st,"data-test-subj":"renderer-example"},{field:"searchableDescription",name:"Searchable Description",sortable:!1,width:"0px",render:ct,"data-test-subj":"renderer-searchable-description"}]),[s,o]);return i.a.createElement(it,{items:rt,itemId:"id",columns:l,search:lt,sorting:ut})};pt.displayName="RowRenderersBrowserComponent";const mt=i.a.memo(pt);mt.displayName="RowRenderersBrowser";const ft=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.eventRenderersTitle",{defaultMessage:"Event renderers"}),gt=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersTitle",{defaultMessage:"Customize event renderers"}),bt=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersDescription",{defaultMessage:"Event renderers automatically convey the most relevant details in an event to reveal its story"}),yt=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.enableAllRenderersButtonLabel",{defaultMessage:"Enable all"}),ht=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.disableAllRenderersButtonLabel",{defaultMessage:"Disable all"}),vt=l()(a.EuiModal).withConfig({displayName:"StyledEuiModal",componentId:"sc-m3n5c2-0"})([""," max-width:95vw;min-height:90vh;> .euiModal__flex{max-height:90vh;}"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`)),Et=l()(a.EuiModalBody).withConfig({displayName:"StyledEuiModalBody",componentId:"sc-m3n5c2-1"})([".euiModalBody__overflow{display:flex;align-items:stretch;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;> div:first-child{flex:0;}.euiBasicTable{flex:1;overflow:auto;}}}"]),xt=({timelineId:e})=>{const t=Object(o.useDispatch)(),n=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),s=Object(u.a)((t=>{var a;return(null!==(a=n(t,e))&&void 0!==a?a:m.b).excludedRowRendererIds})),[l,f]=Object(r.useState)(!1),g=Object(r.useCallback)((n=>t(Object(d.setExcludedRowRendererIds)({id:e,excludedRowRendererIds:n}))),[t,e]),b=Object(r.useCallback)((()=>f(!l)),[l]),y=Object(r.useCallback)((()=>f(!1)),[]),h=Object(r.useCallback)((()=>{g(Object.values(c.e))}),[g]),v=Object(r.useCallback)((()=>{g([])}),[g]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiToolTip,{content:gt},i.a.createElement(a.EuiButtonIcon,{"aria-label":gt,"data-test-subj":"show-row-renderers-gear",iconType:"gear",onClick:b},ft)),l&&i.a.createElement(vt,{onClose:y,"data-test-subj":"row-renderers-modal"},i.a.createElement(a.EuiModalHeader,null,i.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",direction:"row",gutterSize:"none"},i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiModalHeaderTitle,null,gt),i.a.createElement(a.EuiText,{size:"s"},bt)),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiFlexGroup,null,i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiButtonEmpty,{size:"s","data-test-subj":"disable-all",onClick:h},ht)),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiButton,{fill:!0,size:"s","data-test-subj":"enable-all",onClick:v},yt)))))),i.a.createElement(Et,null,i.a.createElement(mt,{excludedRowRendererIds:s,setExcludedRowRendererIds:g}))))},jt=i.a.memo(xt)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return st})),n.d(t,"d",(function(){return ut})),n.d(t,"f",(function(){return Be})),n.d(t,"e",(function(){return pt})),n.d(t,"g",(function(){return Je})),n.d(t,"h",(function(){return vt})),n.d(t,"j",(function(){return at})),n.d(t,"c",(function(){return Et})),n.d(t,"i",(function(){return St}));var a=n(2),r=n.n(a),i=n(19),o=n(4),s=n(56),l=n(5),c=n(596),u=n(221);const d=Object(a.memo)((({handleRefresh:e,http:t,handleCloseFlyout:n,addSuccess:d,addError:p})=>{const{navigateToApp:m}=Object(s.useKibana)().services.application,{start:f,...g}=Object(c.a)(),b=Object(a.useRef)(new AbortController);let y=function(e){return e.name="name",e.description="description",e}({});const[h,v]=Object(a.useState)({name:"",description:""}),E=({target:e},t)=>{const{value:n}=e;v({...h,[t]:n})};Object(a.useEffect)((()=>{null!=g.result&&m(l.m,{deepLinkId:l.Oc.exceptions,path:`/details/${g.result.list_id}`})}),[g,m]);const x=Object(a.useCallback)((()=>{var e;g.loading||""===h.name||(b.current=new AbortController,f({http:t,signal:b.current.signal,name:h.name,description:null!==(e=h.description)&&void 0!==e?e:""}))}),[g.loading,h.name,h.description,f,t]),j=Object(a.useCallback)((t=>{d({text:Object(u.pb)(h.name),title:u.jb}),e(),n()}),[d,n,e,h]),O=Object(a.useCallback)((e=>{var t;e.message.includes("AbortError")||null!=e&&null!==(t=e.body)&&void 0!==t&&t.message.includes("AbortError")||p(e,{title:o.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListErrorTitle",{defaultMessage:"creation error"})})}),[p]);Object(a.useEffect)((()=>{g.loading||(null!=g&&g.result?j(g.result):null!=g&&g.error&&O(null==g?void 0:g.error))}),[null==g?void 0:g.error,g.loading,g.result,O,j]);const S=Object(i.useGeneratedHtmlId)({prefix:"createSharedExceptionListFlyout"});return r.a.createElement(i.EuiFlyout,{ownFocus:!0,size:"s",onClose:n,"data-test-subj":"createSharedExceptionListFlyout","aria-labelledby":S},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{id:S,"data-test-subj":"createSharedExceptionListTitle"},u.h))),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(i.EuiText,null,u.f),r.a.createElement(i.EuiFieldText,{placeholder:u.g,value:h.name,onChange:e=>E(e,y.name),"aria-label":"Shared exception list name","data-test-subj":"createSharedExceptionListNameInput"}),r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiText,null,u.d),r.a.createElement(i.EuiTextArea,{placeholder:u.e,value:h.description,onChange:e=>E(e,y.description),"aria-label":"Shared exception list description","data-test-subj":"createSharedExceptionListDescriptionInput"})),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{iconType:"cross",onClick:n,flush:"left"},u.a)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"exception-lists-form-create-shared",onClick:x,disabled:""===h.name},u.c)))))}));d.displayName="CreateSharedListFlyout";var p=n(152),m=n(1334),f=n(778),g=n(41),b=n.n(g),y=n(49),h=n(788),v=n(546);const E=b()(i.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-19zoulh-0"})(["border-right:1px solid #d3dae6;padding:"," "," "," 0;"],y.euiThemeVars.euiSizeXS,y.euiThemeVars.euiSizeS,y.euiThemeVars.euiSizeXS),x=b()(i.EuiText).withConfig({displayName:"TextContainer",componentId:"sc-19zoulh-1"})(["width:max-content;"]),j=Object(a.memo)((({title:e,badgeString:t})=>r.a.createElement(i.EuiFlexGroup,{alignItems:"center"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(x,{grow:!0,size:"xs"},`${e}:`)),r.a.createElement(E,null,r.a.createElement(i.EuiBadge,null,t)))));j.displayName="TitleBadge";var O=n(43),S=n(1562);const w=Object(a.memo)((({item:e,actions:t,disableActions:n=!1,dataTestSubj:a})=>Object(O.jsx)(i.EuiFlexGroup,{responsive:!0,"data-test-subj":a,justifyContent:"spaceBetween"},Object(O.jsx)(i.EuiFlexItem,{grow:9},Object(O.jsx)(i.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${a}Title`},Object(O.jsx)("h3",null,e.name))),Object(O.jsx)(i.EuiFlexItem,{grow:!1},Object(O.jsx)(f.a,{iconType:"boxesHorizontal",disableActions:n,actions:t,"aria-label":"Exception item actions menu",dataTestSubj:a,anchorPosition:"downCenter"})))));w.displayName="ExceptionItemCardHeader";const k=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.editItemButton",{values:{listType:e},defaultMessage:"Edit {listType} exception"}),I=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.deleteItemButton",{values:{listType:e},defaultMessage:"Delete {listType} exception"}),T=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.createdLabel",{defaultMessage:"Created"}),C=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.updatedLabel",{defaultMessage:"Updated"}),M=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiresLabel",{defaultMessage:"Expires at"}),_=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiredLabel",{defaultMessage:"Expired at"}),D=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.metaDetailsBy",{defaultMessage:"by"}),N=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),A=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator",{defaultMessage:"IS"}),F=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),P=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),R=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),L=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.nestedOperator",{defaultMessage:"has"}),q=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator",{defaultMessage:"is one of"}),z=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),B=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator",{defaultMessage:"exists"}),$=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator.not",{defaultMessage:"does not exist"}),V=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator",{defaultMessage:"included in"}),U=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator.not",{defaultMessage:"is not included in"}),G=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.and",{defaultMessage:"AND"}),H=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.os",{defaultMessage:"OS"}),W=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.windows",{defaultMessage:"Windows"}),Q=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.linux",{defaultMessage:"Linux"}),Y=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.macos",{defaultMessage:"Mac"}),K=Object(O.css)("font-family:",y.euiThemeVars.euiFontFamily,";",""),Z=Object(a.memo)((({label:e,lastUpdate:t,lastUpdateValue:n,dataTestSubj:a})=>Object(O.jsx)(i.EuiFlexGroup,{"data-test-subj":`${a||""}metaInfoDetails`,alignItems:"center",gutterSize:"s",wrap:!0,responsive:!0},Object(O.jsx)(i.EuiFlexItem,{grow:!1},Object(O.jsx)(i.EuiText,{size:"xs",css:K},e)),Object(O.jsx)(i.EuiFlexItem,{grow:!1,"data-test-subj":`${a||""}lastUpdate`},Object(O.jsx)(i.EuiBadge,{color:"default",css:K},t)),null!=n&&Object(O.jsx)(r.a.Fragment,null,Object(O.jsx)(i.EuiFlexItem,{grow:!1},Object(O.jsx)(i.EuiText,{size:"xs",css:K},D)),Object(O.jsx)(i.EuiFlexItem,{grow:!1,"data-test-subj":`${a||""}lastUpdateValue`},Object(O.jsx)(i.EuiFlexGroup,{responsive:!0,gutterSize:"xs",alignItems:"center"},Object(O.jsx)(i.EuiFlexItem,{grow:!1},Object(O.jsx)(i.EuiBadge,{color:"hollow",css:K},n))))))));Z.displayName="MetaInfoDetails";var X=n(1257);const J=Object(O.css)("border-right:1px solid #d3dae6;padding:",y.euiThemeVars.euiSizeS," ",y.euiThemeVars.euiSizeM," ",y.euiThemeVars.euiSizeS," 0;",""),ee=Object(a.memo)((({item:e,rules:t,dataTestSubj:n,securityLinkAnchorComponent:s,formattedDateComponent:l})=>{const c=l,u=Object(a.useMemo)((()=>Object(X.a)({dataTestSubj:n,linkedRules:t,securityLinkAnchorComponent:s})),[n,t,s]),d=Object(a.useMemo)((()=>!!e.expire_time&&new Date(e.expire_time)<=new Date),[e]);return Object(O.jsx)(i.EuiFlexGroup,{alignItems:"center",responsive:!0,gutterSize:"s","data-test-subj":n},null!==c&&Object(O.jsx)(r.a.Fragment,null,Object(O.jsx)(i.EuiFlexItem,{css:J,grow:!1},Object(O.jsx)(Z,{label:T,lastUpdate:Object(O.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentCreatedBy",fieldName:"created_at",value:e.created_at}),lastUpdateValue:e.created_by,dataTestSubj:`${n||""}CreatedBy`})),Object(O.jsx)(i.EuiFlexItem,{css:J,grow:!1},Object(O.jsx)(Z,{label:C,lastUpdate:Object(O.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentUpdatedBy",fieldName:"updated_at",value:e.updated_at}),lastUpdateValue:e.updated_by,dataTestSubj:`${n||""}UpdatedBy`})),null!=e.expire_time&&Object(O.jsx)(r.a.Fragment,null,Object(O.jsx)(i.EuiFlexItem,{css:J,grow:!1},Object(O.jsx)(Z,{label:d?_:M,lastUpdate:Object(O.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentExpireTime",fieldName:"expire_time",value:e.expire_time}),dataTestSubj:`${n||""}ExpireTime`})))),Object(O.jsx)(i.EuiFlexItem,null,Object(O.jsx)(f.a,{emptyButton:!0,useCustomActions:!0,iconType:"list",actions:u,disableActions:!1,text:(p=t.length,o.i18n.translate("exceptionList-components.exceptions.card.exceptionItem.affectedRules",{values:{numRules:p},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"})),dataTestSubj:n})));var p}));ee.displayName="ExceptionItemCardMetaInfo";const te=Object(O.css)("margin-left:",y.euiThemeVars.euiSizeXL,";margin-bottom:",y.euiThemeVars.euiSizeXS,";padding-top:",y.euiThemeVars.euiSizeXS,";",""),ne=Object(p.cx)("eui-xScroll","\n  border: 1px;\n  border-color: #d3dae6;\n  border-style: solid;\n"),ae=Object(O.css)("display:flex;align-items:center;margin-left:",y.euiThemeVars.euiSizeS,";",""),re={name:"s5xdrg",styles:"display:flex;align-items:center"};var ie=n(1471),oe=n(1231);const se=Object(p.css)("display:inline;margin-left:",y.euiThemeVars.euiSizeXS,";",""),le=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:n})=>{const{showSpaceWarningIcon:a,warningText:r}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(ie.a):Object(ie.a)(e)),warningText:t||oe.k.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:n});return a&&e?Object(O.jsx)("div",{className:se},Object(O.jsx)(i.EuiToolTip,{position:"top",content:r},Object(O.jsx)(i.EuiIcon,{"data-test-subj":"valueWithSpaceWarningTooltip",type:t,color:"warning"}))):null};var ce=n(403);const ue=Object.freeze({linux:Q,mac:Y,macos:Y,windows:W}),de=Object.freeze({[ce.b.NESTED]:L,[ce.b.MATCH_ANY]:q,[ce.b.MATCH]:A,[ce.b.WILDCARD]:P,[ce.b.EXISTS]:B,[ce.b.LIST]:V}),pe=Object.freeze({[ce.b.MATCH_ANY]:z,[ce.b.MATCH]:F,[ce.b.WILDCARD]:R,[ce.b.EXISTS]:$,[ce.b.LIST]:U}),me=Object(p.css)({name:"1089mxj",styles:"white-space:pre-wrap"}),fe=({children:e})=>Object(O.jsx)("span",{className:me},e),ge=(e,t,n)=>{var a;const r=n;return"match_any"===e&&Array.isArray(t)?t.map(((e,t)=>Object(O.jsx)(i.EuiBadge,{key:t,"data-test-subj":`matchAnyBadge${t}`,color:"hollow"},Object(O.jsx)(fe,null,e)))):"list"===e&&t?Object(O.jsx)(r,{shouldShowContentIfModalNotAvailable:!0,listId:t.toString()},t):null!==(a=Object(O.jsx)(fe,null,t))&&void 0!==a?a:""},be=(e,t)=>{var n,a;return"nested"===e?"":"included"===t?null!==(n=de[e])&&void 0!==n?n:e:null!==(a=pe[e])&&void 0!==a?a:e},ye=(e,t,n,a)=>Object(O.jsx)(r.a.Fragment,null,Object(O.jsx)(i.EuiExpression,{description:be(e,t),value:ge(e,n,a),"data-test-subj":"entryValueExpression"}),Object(O.jsx)(le,{value:n})),he=Object(a.memo)((({entry:e,index:t,isNestedEntry:n=!1,dataTestSubj:a,showValueListModal:o})=>{const{field:s,type:l}=e,c=(e=>"list"===e.type?e.list.id:"value"in e?e.value:"")(e),u="operator"in e?e.operator:"",d=`${s}${l}${c}${t}`;return Object(O.jsx)("div",{"data-test-subj":`${a||""}${d}EntryContent`,key:d},Object(O.jsx)("div",{css:re},n?Object(O.jsx)(i.EuiFlexGroup,{responsive:!0,css:te,direction:"row",alignItems:"center",gutterSize:"m","data-test-subj":`${a||""}NestedEntry`},Object(O.jsx)(i.EuiToken,{"data-test-subj":"nstedEntryIcon",iconType:"tokenNested",size:"s"}),Object(O.jsx)("div",{css:ae},Object(O.jsx)(i.EuiExpression,{description:"",value:s,color:"subdued"}),ye(l,u,c,o))):Object(O.jsx)(r.a.Fragment,null,Object(O.jsx)(i.EuiExpression,{description:0===t?"":G,value:s,color:0===t?"primary":"subdued","data-test-subj":`${a||""}SingleEntry`}),ye(l,u,c,o))))}));he.displayName="EntryContent";const ve=Object(a.memo)((({os:e,dataTestSubj:t})=>{const n=Object(a.useMemo)((()=>e.map((e=>{var t;return null!==(t=ue[e])&&void 0!==t?t:e})).join(", ")),[e]);return n?Object(O.jsx)("div",{"data-test-subj":`${t||""}Os`},Object(O.jsx)("strong",null,Object(O.jsx)(i.EuiExpression,{"data-test-subj":"osLabel",description:"",value:H}),Object(O.jsx)(i.EuiExpression,{"data-test-subj":"osValue",description:A,value:n}))):null}));ve.displayName="OsCondition";const Ee=Object(a.memo)((({os:e,entries:t,dataTestSubj:n,showValueListModal:a})=>Object(O.jsx)(i.EuiPanel,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":n,className:ne},null!=e&&e.length?Object(O.jsx)(ve,{os:e,dataTestSubj:n}):null,t.map(((e,t)=>{const r="entries"in e?e.entries:[];return Object(O.jsx)("div",{key:`ExceptionItemCardConditionsContainer${t}`},Object(O.jsx)(he,{key:`entry${t}`,entry:e,index:t,dataTestSubj:n,showValueListModal:a}),null!=r&&r.length?r.map(((e,r)=>Object(O.jsx)(he,{key:`nestedEntry${t}${r}`,entry:e,index:r,isNestedEntry:!0,dataTestSubj:n,showValueListModal:a}))):null)})))));Ee.displayName="ExceptionItemCardConditions";const xe=Object(O.css)("color:",y.euiThemeVars.euiColorPrimary,";",""),je=Object(a.memo)((({comments:e,dataTestSubj:t})=>e.length?Object(O.jsx)(i.EuiFlexItem,{"data-test-subj":t},Object(O.jsx)(i.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:Object(O.jsx)(i.EuiText,{size:"s",css:xe,"data-test-subj":`${t||""}TextButton`},N(e.length)),arrowDisplay:"none","data-test-subj":"exceptionItemCardComments"},Object(O.jsx)(i.EuiPanel,{"data-test-subj":"accordionContentPanel",hasBorder:!0,hasShadow:!0,paddingSize:"m"},Object(O.jsx)(i.EuiCommentList,{"data-test-subj":"accordionCommentList",comments:e})))):null));je.displayName="ExceptionItemCardComments";const Oe=({disableActions:e=!1,exceptionItem:t,listType:n,ruleReferences:r,dataTestSubj:o,editActionLabel:s,deleteActionLabel:l,securityLinkAnchorComponent:c,formattedDateComponent:u,getFormattedComments:d,onDeleteException:p,onEditException:m,showValueListModal:f})=>{const{actions:g,formattedComments:b}=(({listType:e,editActionLabel:t,deleteActionLabel:n,exceptionItem:r,getFormattedComments:i,onEditException:o,onDeleteException:s})=>{const l=Object(a.useCallback)((()=>{s({id:r.id,name:r.name,namespaceType:r.namespace_type})}),[s,r.id,r.name,r.namespace_type]),c=Object(a.useCallback)((()=>{o(r)}),[o,r]),u=Object(a.useMemo)((()=>i(r.comments)),[r.comments,i]);return{actions:Object(a.useMemo)((()=>[{key:"edit",icon:"controlsHorizontal",label:t||k(e),onClick:c},{key:"delete",icon:"trash",label:n||I(e),onClick:l}]),[t,e,n,l,c]),formattedComments:u}})({listType:n,editActionLabel:s,deleteActionLabel:l,exceptionItem:t,getFormattedComments:d,onEditException:m,onDeleteException:p});return Object(O.jsx)(i.EuiPanel,{key:`${t.id}exceptionItemPanel`,paddingSize:"l","data-test-subj":o||"",hasBorder:!0,hasShadow:!1},Object(O.jsx)(i.EuiFlexGroup,{responsive:!0,gutterSize:"m",direction:"column"},Object(O.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardHeaderContainer"},Object(O.jsx)(w,{item:t,actions:g,disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),Object(O.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardMeta"},Object(O.jsx)(ee,{item:t,rules:r,dataTestSubj:"exceptionItemCardMetaInfo",securityLinkAnchorComponent:c,formattedDateComponent:u})),Object(O.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardCondition"},Object(O.jsx)(Ee,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions",showValueListModal:f})),b.length>0&&Object(O.jsx)(je,{dataTestSubj:"exceptionsItemCommentAccordion",comments:b})))};Oe.displayName="ExceptionItemCardComponent";const Se=r.a.memo(Oe);Se.displayName="ExceptionItemCard";const we=({dataTestSubj:e,ariaLabel:t,pagination:n,onPaginationChange:r})=>{const{pageIndex:o,pageCount:s,pageSize:l,pageSizeOptions:c,handleItemsPerPageChange:u,handlePageIndexChange:d}=(({pagination:e,onPaginationChange:t})=>{const{pageIndex:n,totalItemCount:r,pageSize:i,pageSizeOptions:o}=e,s=Object(a.useMemo)((()=>isFinite(r/i)?Math.ceil(r/i):0),[i,r]),l=Object(a.useCallback)((e=>{t({pagination:{pageIndex:n,pageSize:e,totalItemCount:r}})}),[n,r,t]),c=Object(a.useCallback)((e=>{t({pagination:{pageIndex:e,pageSize:i,totalItemCount:r}})}),[i,r,t]);return{pageCount:s,pageIndex:n,pageSize:i,pageSizeOptions:o,handleItemsPerPageChange:l,handlePageIndexChange:c}})({pagination:n,onPaginationChange:r});return Object(O.jsx)(i.EuiTablePagination,{"data-test-subj":e,"aria-label":t,pageCount:s,activePage:o,itemsPerPage:l,onChangePage:d,onChangeItemsPerPage:u,itemsPerPageOptions:c})};we.displayName="PaginationComponent";const ke=r.a.memo(we);ke.displayName="Pagination";const Ie=Object(O.css)("margin:",y.euiThemeVars.euiSize," 0;&div:first-child{margin:",y.euiThemeVars.euiSizeXS," 0 ",y.euiThemeVars.euiSize,";}",""),Te=({lastUpdated:e,viewerStatus:t,isReadOnly:n,exceptions:a,listType:o,ruleReferences:s,emptyViewerTitle:l,emptyViewerBody:c,emptyViewerButtonText:u,pagination:d,dataTestSubj:p,editActionLabel:m,deleteActionLabel:f,securityLinkAnchorComponent:g,exceptionsUtilityComponent:b,formattedDateComponent:y,getFormattedComments:h,onPaginationChange:v,onDeleteException:E,onEditExceptionItem:x,onCreateExceptionListItem:j,showValueListModal:w})=>{const k=b;if(!a.length||t)return Object(O.jsx)(S.a,{isReadOnly:n,title:l,viewerStatus:t,buttonText:u,body:c,onEmptyButtonStateClick:j});const I=w;return Object(O.jsx)(r.a.Fragment,null,Object(O.jsx)(k,{pagination:d,lastUpdated:e}),Object(O.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"none",className:"eui-yScrollWithShadows"},Object(O.jsx)(i.EuiFlexItem,{grow:!1},Object(O.jsx)(i.EuiFlexGroup,{css:Ie,"data-test-subj":`${p||""}exceptionsContainer`,direction:"column",gutterSize:"s"},a.map((e=>Object(O.jsx)(i.EuiFlexItem,{"data-test-subj":`${p||""}exceptionItemContainer`,grow:!1,key:e.id},Object(O.jsx)(Se,{key:`${e.id}exceptionItemCardKey`,dataTestSubj:`${p||""}exceptionItemCard`,disableActions:n,exceptionItem:e,listType:o,ruleReferences:Object.keys(s).length&&s[e.list_id]?s[e.list_id].referenced_rules:[],editActionLabel:m,deleteActionLabel:f,onDeleteException:E,onEditException:x,securityLinkAnchorComponent:g,formattedDateComponent:y,getFormattedComments:h,showValueListModal:I}))))))),Object(O.jsx)(ke,{dataTestSubj:`${p||""}pagination`,pagination:d,onPaginationChange:v}))};Te.displayName="ExceptionItemsComponent";const Ce=r.a.memo(Te);Ce.displayName="ExceptionsItems";var Me=n(151),_e=n(54),De=n.n(_e);const Ne=o.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),Ae=(o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"}));o.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),o.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),o.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),o.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"});var Fe=n(873);const Pe=e=>e.map((e=>({username:e.created_by,timestamp:De()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:Ne,timelineAvatar:r.a.createElement(i.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:r.a.createElement(i.EuiText,{size:"s"},e.comment),actions:r.a.createElement(Fe.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:Ae})})));var Re=n(144),Le=n(668),qe=n(258);const ze=({referenceName:e,referenceId:t,external:n,dataTestSubj:a})=>r.a.createElement(Re.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=a?a:""}`,deepLinkId:l.Oc.rules,path:Object(qe.c)(t,Le.b.alerts),target:n?"_blank":void 0},e);ze.displayName="LinkToRuleDetailsComponent";const Be=r.a.memo(ze);Be.displayName="LinkToRuleDetails";var $e=n(42),Ve=n(362);const Ue=b.a.span.withConfig({displayName:"StyledText",componentId:"sc-1q48q07-0"})(["font-weight:bold;color:",";"],(({theme:e})=>e.eui.euiColorDarkestShade)),Ge=b()(i.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-1q48q07-1"})(["height:50px;"]),He=b.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-1q48q07-2"})(["display:inline-block !important;vertical-align:middle !important;line-height:1;"]),We=({dataTestSubj:e,pagination:t,lastUpdated:n,exceptionsTitle:a})=>{const{pageSize:o,totalItemCount:s}=t;return r.a.createElement(Ge,{alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(Ve.a,null,r.a.createElement(Ve.d,null,r.a.createElement(Ve.c,null,r.a.createElement(Ve.e,{dataTestSubj:`${e}ShowingText`},r.a.createElement($e.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:r.a.createElement(Ue,null,`1-${Math.min(o,s)}`),partTwo:r.a.createElement(Ue,null,`${s}`)}})),a&&r.a.createElement(Ue,{"data-test-subj":`${e}exceptionsTitle`},a))))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiText,{size:"s","data-test-subj":`${e}LastUpdated`},r.a.createElement($e.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:r.a.createElement(He,null,r.a.createElement(Me.b,{value:n,tooltipAnchorClassName:"eui-textTruncate"}))}}))))};We.displayName="ExceptionsUtilityComponent";const Qe=r.a.memo(We);Qe.displayName="ExceptionsUtility";var Ye=n(597),Ke=n(540),Ze=n(547);const Xe=({isReadOnly:e,exceptions:t,listType:n,lastUpdated:i,pagination:o,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,viewerStatus:u,ruleReferences:d,hideUtility:p=!1,onDeleteException:f,onEditExceptionItem:g,onPaginationChange:b,onCreateExceptionListItem:y})=>{const h=Object(Ke.a)("crudEndpointExceptions"),v=Object(a.useMemo)((()=>n===m.a.ENDPOINT?Ye.c:Ye.d),[n]),E=Object(a.useMemo)((()=>n===m.a.ENDPOINT?Ye.a:Ye.b),[n]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce,{viewerStatus:u,listType:n,ruleReferences:d,isReadOnly:e||!h,exceptions:t,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,pagination:o,lastUpdated:i,editActionLabel:v,deleteActionLabel:E,onPaginationChange:b,onEditExceptionItem:g,onDeleteException:f,getFormattedComments:Pe,securityLinkAnchorComponent:Be,formattedDateComponent:Me.a,onCreateExceptionListItem:y,exceptionsUtilityComponent:()=>p?null:r.a.createElement(Qe,{exceptionsTitle:Ye.e,pagination:o,lastUpdated:i}),showValueListModal:Ze.a}))};Xe.displayName="ListExceptionItemsComponent";const Je=r.a.memo(Xe);Je.displayName="ListExceptionItems";var et=n(795),tt=n(598),nt=n(868);const at=Object(a.memo)((({linkedRules:e,showButtonLoader:t,saveIsDisabled:n=!0,onSave:a,onCancel:o,onRuleSelectionChange:s})=>{const l=Object(i.useGeneratedHtmlId)({prefix:"complicatedFlyoutTitle"});return r.a.createElement(i.EuiFlyout,{hideCloseButton:!0,ownFocus:!0,onClose:o,"aria-labelledby":l},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{id:l},u.W)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiText,{size:"s",color:"subdued"},u.Z)),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(nt.a,{initiallySelectedRules:e,onRuleSelectionChange:s})),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{onClick:o,flush:"left"},u.Y)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"manageListRulesSaveButton",isLoading:t,disabled:n,onClick:a,fill:!0},u.ab)))))}));at.displayName="ManageRules";var rt=n(780);const it=b()(i.EuiPanel).withConfig({displayName:"ExceptionPanel",componentId:"sc-11ogn3z-0"})(["margin:-"," "," 0 ",";"],y.euiThemeVars.euiSizeS,y.euiThemeVars.euiSizeM,y.euiThemeVars.euiSizeM),ot=b()(i.EuiFlexGroup).withConfig({displayName:"ListHeaderContainer",componentId:"sc-11ogn3z-1"})(["padding:",";text-align:initial;"],y.euiThemeVars.euiSizeS),st=Object(a.memo)((({exceptionsList:e,handleDelete:t,handleExport:n,handleDuplicate:o,readOnly:s})=>{const{linkedRules:l,showManageRulesFlyout:c,showManageButtonLoader:d,disableManageButton:g,onManageRules:b,onSaveManageRules:y,onCancelManageRules:E,onRuleSelectionChange:x}=Object(et.a)(e.list_id),{euiTheme:O}=Object(i.useEuiTheme)(),S=Object(i.useEuiShadow)(),w=Object(a.useMemo)((()=>p.css`
        .euiAccordion__buttonContent {
          flex: 1 1 auto;
          cursor: pointer;
        }
        .euiAccordion__triggerWrapper {
          z-index: 100;
          position: relative;
          border-radius: ${O.border.radius.medium};
          padding: ${O.size.base};
          ${S}
        }
      `),[O.border.radius.medium,O.size.base,S]),{listId:k,listName:I,listType:T,createdAt:C,createdBy:M,exceptions:_,pagination:D,ruleReferences:N,toggleAccordion:A,openAccordionId:F,menuActionItems:P,listDescription:R,exceptionItemsCount:L,onEditExceptionItem:q,onDeleteException:z,onPaginationChange:B,setToggleAccordion:$,exceptionViewerStatus:V,showAddExceptionFlyout:U,showEditExceptionFlyout:G,exceptionToEdit:H,onAddExceptionClick:W,handleConfirmExceptionFlyout:Q,handleCancelExceptionItemFlyout:Y,goToExceptionDetail:K,emptyViewerTitle:Z,emptyViewerBody:X,emptyViewerButtonText:J,handleCancelExpiredExceptionsModal:ee,handleConfirmExpiredExceptionsModal:te,showIncludeExpiredExceptionsModal:ne}=Object(tt.a)({exceptionsList:e,handleExport:n,handleDelete:t,handleDuplicate:o,handleManageRules:b});return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiAccordion,{className:w,id:F,buttonElement:"div",onToggle:()=>$(!A),buttonContent:r.a.createElement(ot,{gutterSize:"m",alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiFlexGroup,{direction:"column",key:k,alignItems:"flexStart",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiText,{size:"m"},r.a.createElement(i.EuiLink,{"data-test-subj":"exception-list-name",onClick:K},I))),r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiText,{size:"xs"},r.a.createElement(i.EuiTextColor,{color:"subdued"},R))))),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",wrap:!0,responsive:!0},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(j,{title:u.i,badgeString:C})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(j,{title:u.b,badgeString:M})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(j,{title:u.l,badgeString:L})),r.a.createElement(i.EuiFlexItem,{"data-test-subj":"exceptionListCardLinkedRulesBadge",grow:!1},r.a.createElement(j,{title:u.gb,badgeString:l.length.toString()})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(f.a,{disableActions:s,dataTestSubj:"sharedListOverflowCard",actions:P}))),"data-test-subj":`exceptionsManagementListCard-${k}`},r.a.createElement(it,{hasBorder:!0},r.a.createElement(Je,{isReadOnly:s,exceptions:_,listType:e.type,pagination:D,hideUtility:!0,viewerStatus:V,ruleReferences:N,onDeleteException:z,onEditExceptionItem:q,onPaginationChange:B,onCreateExceptionListItem:W,lastUpdated:null,emptyViewerTitle:Z,emptyViewerBody:X,emptyViewerButtonText:J}))),U?r.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:T===m.a.ENDPOINT,sharedListToAddTo:[e],onCancel:Y,onConfirm:Q,"data-test-subj":"addExceptionItemFlyoutInSharedLists",showAlertCloseOptions:!1}):null,G&&H?r.a.createElement(h.a,{list:e,itemToEdit:H,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:Y,onConfirm:Q,"data-test-subj":"editExceptionItemFlyoutInSharedLists"}):null,c?r.a.createElement(at,{linkedRules:l,showButtonLoader:d,saveIsDisabled:g,onSave:y,onCancel:E,onRuleSelectionChange:x}):null,ne?r.a.createElement(rt.b,{handleCloseModal:ee,onModalConfirm:te,action:ne}):null)}));st.displayName="ExceptionsListCard";var lt=n(168),ct=n(600);const ut=r.a.memo((({handleRefresh:e,http:t,addSuccess:n,addError:o,setDisplayImportListFlyout:s})=>{var l;const c=Object(a.useRef)(null),d=Object(i.useGeneratedHtmlId)({prefix:"filePicker"}),[p,m]=Object(a.useState)(null),[f,g]=Object(a.useState)(!1),[b,y]=Object(a.useState)(!1),[h,v]=Object(a.useState)(!1),[E,x]=Object(a.useState)(!1),j=Object(a.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),m(null),v(!1),x(!1),y(!1),g(!1)}),[]),{start:O,...S}=Object(ct.a)(),w=Object(a.useRef)(new AbortController),k=Object(a.useCallback)((()=>{!S.loading&&p&&(w.current=new AbortController,Array.from(p).forEach((e=>O({file:e,http:t,signal:w.current.signal,overwrite:f,overwriteExceptions:f,asNewList:b}))))}),[b,p,t,O,S.loading,f]),I=Object(a.useCallback)((t=>{j(),n({title:u.mb}),e()}),[j,n,e]),T=Object(a.useCallback)((e=>{e.forEach((e=>{e.error.message.includes("AbortError")||o(e.error.message,{title:u.lb})}))}),[o]);Object(a.useEffect)((()=>{var e;if(!S.loading)if(null!=S&&null!==(e=S.result)&&void 0!==e&&e.success)I(null==S?void 0:S.result);else{var t,n;const e=[];var a,r;null!=S&&null!==(t=S.error)&&void 0!==t&&t.body&&e.push({error:{...null==S||null===(a=S.error)||void 0===a?void 0:a.body}}),null!=S&&null!==(n=S.result)&&void 0!==n&&n.errors&&(null==S||null===(r=S.result)||void 0===r||r.errors.forEach((t=>{t.error.message.includes("already exists")&&(v(!0),t.error.message.includes(`Found that list_id: "${lt.k}" already exists`)&&x(!0)),e.push(t)}))),T(e)}}),[T,I,null==S?void 0:S.error,S.loading,null==S?void 0:S.result,null==S||null===(l=S.result)||void 0===l?void 0:l.errors]);const C=Object(a.useCallback)((e=>{m(null!=e?e:null)}),[]),M=Object(i.useGeneratedHtmlId)({prefix:"importExceptionListFlyoutTitle"});return r.a.createElement(i.EuiFlyout,{ownFocus:!0,size:"s",onClose:()=>s(!1),"aria-labelledby":M},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{id:M},u.S))),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(i.EuiText,null,u.R),r.a.createElement(i.EuiFilePicker,{id:d,multiple:!0,ref:c,initialPromptText:u.V,onChange:C,display:"large","aria-label":"Use aria labels when no actual label is in use"}),h&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiTextColor,{color:"danger"},u.U),r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiCheckbox,{id:"basicCheckboxId",label:u.T,checked:f,"data-test-subj":"importExceptionListOverwriteExistingCheckbox",onChange:e=>{g(!f),y(!1)}}),r.a.createElement(i.EuiToolTip,{position:"bottom",content:E?u.P:""},r.a.createElement(i.EuiCheckbox,{id:"createNewListCheckbox",label:u.Q,"data-test-subj":"importExceptionListCreateNewCheckbox",checked:b,disabled:E,onChange:e=>{y(!b),g(!1)}})))),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"exceptionListsImportFormCloseBTN",iconType:"cross",onClick:()=>s(!1),flush:"left"},u.a)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"exception-lists-form-import-action",onClick:k,disabled:null==p||S.loading},u.kb)))))})),dt=({linkTitle:e,listId:t,external:n,dataTestSubj:a})=>r.a.createElement(Re.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=a?a:""}`,deepLinkId:l.Oc.exceptions,path:`/details/${t}`,target:n?"_blank":void 0},e);dt.displayName="LinkToListDetailsComponent";const pt=r.a.memo(dt);pt.displayName="LinkToListDetails";var mt=n(1314);const ft={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},gt=({addExceptionButtonText:e,placeholdertext:t,canAddException:n,listType:r,isSearching:o,dataTestSubj:s,filters:l=[],isButtonFilled:c=!0,buttonIconType:u,onSearch:d,onAddExceptionClick:p})=>{const m=Object(a.useCallback)((({queryText:e})=>{d({search:e})}),[d]),f=Object(a.useCallback)((()=>{p(r)}),[p,r]);return Object(O.jsx)(i.EuiFlexGroup,{alignItems:"center"},Object(O.jsx)(i.EuiFlexItem,{grow:!0},Object(O.jsx)(i.EuiSearchBar,{box:{placeholder:t,incremental:!1,schema:ft,"data-test-subj":`${s||""}searchBar`},filters:l,onChange:m})),!n&&Object(O.jsx)(i.EuiFlexItem,{grow:!1},Object(O.jsx)(i.EuiButton,{"data-test-subj":`${s||""}Button`,onClick:f,isDisabled:o,fill:c,iconType:u},e)))};gt.displayName="SearchBarComponent";const bt=r.a.memo(gt);bt.displayName="SearchBar";var yt=n(601);const ht=({list:e,isReadOnly:t,refreshExceptions:n})=>{const{listName:a,exceptions:o,listType:s,lastUpdated:l,pagination:c,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:f,viewerStatus:g,ruleReferences:b,showAddExceptionFlyout:y,showEditExceptionFlyout:E,exceptionToEdit:x,exceptionViewerStatus:j,onSearch:O,onAddExceptionClick:w,onDeleteException:k,onEditExceptionItem:I,onPaginationChange:T,handleCancelExceptionItemFlyout:C,handleConfirmExceptionFlyout:M}=Object(yt.a)(e,n);return r.a.createElement(r.a.Fragment,null,y?r.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:s===m.a.ENDPOINT,sharedListToAddTo:[e],onCancel:C,onConfirm:M,"data-test-subj":"addExceptionItemFlyoutInList",showAlertCloseOptions:!1}):g===mt.a.EMPTY||g===mt.a.LOADING?r.a.createElement(S.a,{isReadOnly:t,viewerStatus:g,onEmptyButtonStateClick:w,title:u.B,body:u.y(a),buttonText:u.z}):r.a.createElement(i.EuiPanel,{hasBorder:!1,hasShadow:!1},r.a.createElement(r.a.Fragment,null,E&&x&&r.a.createElement(h.a,{list:e,itemToEdit:x,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:C,onConfirm:M,"data-test-subj":"editExceptionItemFlyoutInList"}),r.a.createElement(bt,{addExceptionButtonText:s===m.a.ENDPOINT?u.x:u.w,listType:s,onSearch:O,onAddExceptionClick:w,isSearching:g===mt.a.SEARCHING,isButtonFilled:!1,buttonIconType:"plusInCircle"}),r.a.createElement(Je,{viewerStatus:j,listType:s,ruleReferences:b,isReadOnly:t,exceptions:o,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:f,pagination:c,lastUpdated:l,onPaginationChange:T,onEditExceptionItem:I,onDeleteException:k,onCreateExceptionListItem:w}))))};ht.displayName="ListWithSearchComponent";const vt=r.a.memo(ht);vt.displayName="ListWithSearch";const Et=({onRefresh:e,totalExceptionLists:t,setSort:n,sort:a,sortFields:o})=>{var s;const l=null==o?void 0:o.find((e=>e.field===(null==a?void 0:a.field)));return r.a.createElement(Ve.a,{border:!0},r.a.createElement(Ve.d,null,r.a.createElement(Ve.c,null,r.a.createElement(Ve.e,{dataTestSubj:"showingExceptionLists"},u.hb(t))),r.a.createElement(Ve.c,null,r.a.createElement(Ve.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:e},u.fb))),r.a.createElement(Ve.d,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(Ve.c,null,a&&r.a.createElement(Ve.b,{dataTestSubj:"sortExceptions",iconSide:"right",iconType:"asc"===a.order?"sortUp":"sortDown",popoverPanelPaddingSize:"s",popoverContent:()=>r.a.createElement(i.EuiContextMenuPanel,{size:"s",items:null==o?void 0:o.map((e=>{const t=(null==l?void 0:l.field)===e.field;let o=e.defaultOrder;return t&&(o="asc"===a.order?"desc":"asc"),r.a.createElement(i.EuiContextMenuItem,{key:e.field,onClick:()=>null==n?void 0:n({field:e.field,order:o})},r.a.createElement(xt,null,e.label," ",(null==l?void 0:l.field)===e.field&&r.a.createElement(jt,{type:"asc"===a.order?"sortUp":"sortDown"})))}))})},r.a.createElement(xt,null,u.ib," ",null==o||null===(s=o.find((e=>e.field===a.field)))||void 0===s?void 0:s.label))))))},xt=b()("div").withConfig({displayName:"SortMenuItem",componentId:"sc-1h5b7pp-0"})(["display:flex;align-items:center;"]),jt=b()(i.EuiIcon).withConfig({displayName:"SortIcon",componentId:"sc-1h5b7pp-1"})(["margin-left:8px;"]);Et.displayName="ExceptionsTableUtilityBar";const Ot={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},St=r.a.memo((({onSearch:e})=>r.a.createElement(i.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":u.m,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:u.D,incremental:!1,schema:Ot}})));St.displayName="ListsSearchBar"},function(e,t,n){"use strict";n.d(t,"c",(function(){return he})),n.d(t,"b",(function(){return ve})),n.d(t,"a",(function(){return xe}));var a=n(2),r=n.n(a),i=n(45),o=n(58),s=n(122),l=n(905),c=n(118),u=n(5),d=n(124),p=n(146),m=n(129),f=n(13),g=n(747),b=n(243),y=n(42),h=n(41),v=n.n(h),E=n(121),x=n(957),j=n(362),O=n(292),S=n(140),w=n(19),k=n(163),I=n(48),T=n(123),C=n(816);const M=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:r}=Object(I.useParams)(),{addSuccess:i}=Object(T.a)(),o=Object(a.useCallback)((t=>{null!=e&&e(),i({title:r===E.m.template?k.T(t):k.S(t),"data-test-subj":"addObjectToContainerSuccess"})}),[i,e,r]),s=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(O.c)({ids:n});e instanceof Blob?(Object(C.a)(e,`${k.n}.ndjson`),o(n.length)):s()}})()}),[n,t]),null};M.displayName="ExportTimeline";const _=r.a.memo(M);var D=n(44);const N=r.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:i}=Object(I.useParams)(),o=i===E.m.template?k.j:k.k,s=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(D.isEmpty)(t)?k.Z:t;return r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return r.a.createElement(w.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:k.b,confirmButtonText:k.h,defaultFocusedButton:w.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:s()},r.a.createElement("div",{"data-test-subj":"warning"},o))}));N.displayName="DeleteTimelineModal";const A=Object(h.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),F=r.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:i,onComplete:o,savedSearchIds:s})=>{const{addSuccess:l}=Object(T.a)(),{tabName:c}=Object(I.useParams)(),u=Object(a.useCallback)((()=>{null!=o&&o()}),[o]),d=Object(a.useCallback)((()=>{n.length>0&&null!=s&&s.length>0?(e(n,s),l({title:c===E.m.template?k.R(n.length):k.Q(n.length)})):n.length>0&&(e(n),l({title:c===E.m.template?k.R(n.length):k.Q(n.length)})),null!=o&&o()}),[e,n,o,l,c,s]);return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(A,{"data-test-subj":"remove-popover"}),t?r.a.createElement(w.EuiModal,{maxWidth:600,onClose:u},r.a.createElement(N,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:i,closeModal:u})):null)}));F.displayName="DeleteTimelineModalOverlay";const P=({deleteTimelines:e,ids:t,savedSearchIds:n,isEnableDownloader:a,isDeleteTimelineModalOpen:i,onComplete:o,title:s})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:o}),null!=e&&r.a.createElement(F,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:i,onComplete:o,savedObjectIds:t,savedSearchIds:n,title:s})),R=r.a.memo(P),L=()=>{const[e,t]=Object(a.useState)(null),[n,r]=Object(a.useState)(!1),[i,o]=Object(a.useState)(!1),s=Object(a.useCallback)((()=>{r(!1),t(null)}),[e]),l=Object(a.useCallback)((e=>{r(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((e=>{o(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((()=>{o(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{r(!1),o(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:s,onOpenDeleteTimelineModal:l,isEnableDownloader:i,enableExportTimelineDownloader:c,disableExportTimelineDownloader:u}},q=v.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));q.displayName="SearchRowContainer";const z=v()(w.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));z.displayName="SearchRowFlexGroup";const B=r.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:i,children:o,timelineType:s})=>{const l=Object(a.useMemo)((()=>({placeholder:s===E.m.default?k.K:k.L,incremental:!1,"data-test-subj":"search-bar"})),[s]);return r.a.createElement(q,null,r.a.createElement(z,{gutterSize:"s"},r.a.createElement(w.EuiFlexItem,null,r.a.createElement(w.EuiSearchBar,{box:l,onChange:n})),r.a.createElement(w.EuiFlexItem,{grow:!1},r.a.createElement(w.EuiFilterGroup,{fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(w.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:i,numFilters:null!=e?e:void 0},k.D),!!o&&o)))))}));B.displayName="SearchRow",n(43);const $=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:r,onCreateRule:i,onCreateRuleFromEql:o,hasCrudAccess:s})=>[{width:s?"80px":"150px",actions:[{name:k.g,icon:"timeline",onClick:({savedObjectId:e})=>{r({duplicate:!0,timelineType:E.m.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===E.m.template&&e.includes("createFrom")},{name:k.f,icon:"visText",onClick:({savedObjectId:e})=>{r({duplicate:!0,timelineType:E.m.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==E.m.template&&e.includes("createFrom")},{name:k.E,icon:"copy",onClick:({savedObjectId:e})=>{r({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==E.m.template&&e.includes("duplicate")},{name:k.F,icon:"copy",onClick:({savedObjectId:e})=>{r({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===E.m.template&&e.includes("duplicate")},{name:k.o,icon:"exportAction",type:"icon",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==E.l.immutable,description:k.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:k.i,icon:"trash",type:"icon",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==E.l.immutable,description:k.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:k.d,icon:"indexEdit",type:"icon",onClick:e=>{null!=i&&e.savedObjectId&&i(e.savedObjectId)},enabled:e=>null!=i&&null!=e.savedObjectId&&e.status!==E.l.immutable,description:k.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=i&&null!=t&&t.hasQuery},{name:k.e,icon:"indexEdit",type:"icon",onClick:e=>{null!=o&&e.savedObjectId&&o(e.savedObjectId)},enabled:e=>null!=o&&null!=e.savedObjectId&&e.status!==E.l.immutable,description:k.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=o&&null!=t&&t.hasEql}]}],V="45px";var U=n(184),G=n(742),H=n(130),W=n(151),Q=n(149);const Y=v.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),K=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{dataType:"auto",isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?r.a.createElement(w.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(D.omit)(a,e)):n({...e,[a]:r.a.createElement(G.a,{notes:t,timelineId:Q.f.active})}),"aria-label":e[a]?k.c:k.m,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:V},{dataType:"string",field:"title",name:a===E.m.default?k.X:k.Y,render:(e,n)=>null!=n.savedObjectId?r.a.createElement(w.EuiLink,{"data-test-subj":`timeline-title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(U.e)(n)?k.Z:r.a.createElement(Y,null,e)):r.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(U.e)(n)?k.Z:e),sortable:!1},{dataType:"string",field:"description",name:k.l,render:e=>r.a.createElement(Y,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(H.d)()),sortable:!1},{dataType:"date",field:"updated",name:k.y,render:(e,t)=>r.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?r.a.createElement(W.b,{value:e}):Object(H.d)()),sortable:!0}],Z=e=>e?[{dataType:"string",field:"updatedBy",name:k.B,render:e=>r.a.createElement("div",{"data-test-subj":"username"},Object(H.a)(e)),sortable:!1}]:[],X=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:r.a.createElement(w.EuiToolTip,{content:k.C},r.a.createElement(w.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>r.a.createElement("span",{"data-test-subj":"notes-count"},Object(U.c)(t)),sortable:!1,width:V},pinnedEvent:{align:"center",field:"pinnedEventIds",name:r.a.createElement(w.EuiToolTip,{content:k.I},r.a.createElement(w.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>r.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(U.d)(t)}`),sortable:!1,width:V},favorite:{align:"center",field:"favorite",name:r.a.createElement(w.EuiToolTip,{content:k.p},r.a.createElement(w.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return r.a.createElement(w.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:V}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===E.m.template?n:a},J=r.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:i,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:s,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:u,onOpenTimeline:d,onSelectionChange:p,onTableChange:m,onToggleShowNotes:f,pageIndex:g,pageSize:b,searchResults:y,showExtendedColumns:h,sortField:v,sortDirection:x,tableRef:j,timelineType:O,totalSearchResultsCount:w})=>{const I=Object(a.useMemo)((()=>({showPerPageOptions:h,pageIndex:g,pageSize:b,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:w})),[n,g,b,h,w]),T=Object(a.useMemo)((()=>({sort:{field:v,direction:x}})),[v,x]),C=Object(a.useMemo)((()=>({selectable:e=>null!=e.savedObjectId&&e.status!==E.l.immutable,selectableMessage:e=>e?"":k.A,onSelectionChange:p})),[p]),{kibanaSecuritySolutionsPrivileges:M}=Object(S.a)(),_=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onCreateRule:r,onCreateRuleFromEql:i,onOpenDeleteTimelineModal:o,onOpenTimeline:s,onToggleShowNotes:l,showExtendedColumns:c,timelineType:u,hasCrudAccess:d})=>[...K({itemIdToExpandedNotesRowMap:a,onOpenTimeline:s,onToggleShowNotes:l,timelineType:u}),...Z(c),...X({timelineType:u}),...e.length?$({onCreateRule:r,onCreateRuleFromEql:i,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:o,onOpenTimeline:s,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:s,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:u,onOpenTimeline:d,onSelectionChange:p,onToggleShowNotes:f,showExtendedColumns:h,timelineType:O,hasCrudAccess:M.crud})),[e,t,o,s,l,c,u,d,p,f,h,O,M]),D=i||null==y?k.z:O===E.m.template?k.cb:k.bb;return r.a.createElement(ee,{columns:_,"data-test-subj":"timelines-table",itemId:"savedObjectId",itemIdToExpandedRowMap:o,items:null!=y?y:[],loading:i,noItemsMessage:D,onChange:m,pagination:I,selection:e.includes("selectable")?C:void 0,sorting:T,ref:j})}));J.displayName="TimelinesTable";var ee=v()(w.EuiBasicTable).withConfig({displayName:"_StyledEuiBasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]),te=n(697);const ne=v.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ae=r.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:i,itemIdToExpandedNotesRowMap:o,importDataModalToggle:s,onCreateRule:l,onCreateRuleFromEql:c,onDeleteSelected:u,onlyFavorites:d,onOpenTimeline:p,onQueryChange:m,onSelectionChange:f,onTableChange:g,onToggleOnlyFavorites:b,onToggleShowNotes:h,pageIndex:v,pageSize:I,query:T,refetch:C,searchResults:M,selectedItems:_,sortDirection:D,setImportDataModalToggle:N,sortField:A,tabName:F,timelineType:P=E.m.default,timelineStatus:q,timelineFilter:z,templateTimelineFilter:$,totalSearchResultsCount:V})=>{var G;const{actionItem:H,enableExportTimelineDownloader:W,isEnableDownloader:Q,isDeleteTimelineModalOpen:Y,onOpenDeleteTimelineModal:K,onCompleteEditTimelineAction:Z}=L(),X=Object(a.useRef)(null),{kibanaSecuritySolutionsPrivileges:ee}=Object(S.a)(),{getBatchItemsPopoverContent:ae}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:i=E.m.default})=>{const{enableExportTimelineDownloader:o,disableExportTimelineDownloader:s,isEnableDownloader:l,isDeleteTimelineModalOpen:c,onOpenDeleteTimelineModal:u,onCloseDeleteTimelineModal:d}=L(),p=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),s(),d()}),[s,d,n]),{timelineIds:m,searchIds:f}=Object(a.useMemo)((()=>null!=t?ve(he(t)):{timelineIds:[],searchIds:void 0}),[t]),g=Object(a.useCallback)((()=>o()),[o]),b=Object(a.useCallback)((()=>u()),[u]),y=Object(a.useCallback)((n=>{var a,o,s,u;const d=null==t||0===t.length,y=[];return t&&y.push(r.a.createElement(w.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:g},k.o)),e&&y.push(r.a.createElement(w.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:b},k.i)),r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{deleteTimelines:e,ids:m,savedSearchIds:f,isEnableDownloader:l,isDeleteTimelineModalOpen:c,onComplete:p.bind(null,n),title:1!==(null==t?void 0:t.length)?i===E.m.template?k.M(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):k.N(null!==(o=null==t?void 0:t.length)&&void 0!==o?o:0):null!==(s=null===(u=t[0])||void 0===u?void 0:u.title)&&void 0!==s?s:""}),r.a.createElement(w.EuiContextMenuPanel,{items:y}))}),[t,e,m,f,l,c,p,i,g,b]);return{onCompleteBatchActions:p,getBatchItemsPopoverContent:y}})({deleteTimelines:ee.crud?e:void 0,selectedItems:_,tableRef:X,timelineType:P}),re=Object(a.useMemo)((()=>r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:V,with:r.a.createElement(ne,{"data-test-subj":"selectable-query-text"},T.trim().length?`${k.ab} "${T.trim()}"`:"")}})),[V,T]),ie=Object(a.useMemo)((()=>r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:V,with:r.a.createElement(ne,{"data-test-subj":"selectable-query-text"},T.trim().length?`${k.ab} "${T.trim()}"`:"")}})),[V,T]),oe=Object(a.useMemo)((()=>null!=H&&null!=H.savedObjectId?[H.savedObjectId]:[]),[H]),se=Object(a.useMemo)((()=>null!=H&&null!=H.savedSearchId?[H.savedSearchId]:void 0),[H]),le=Object(a.useCallback)((()=>{null!=C&&C()}),[C]),ce=Object(a.useCallback)((()=>{null!=N&&N(!1)}),[N]),ue=Object(a.useCallback)((()=>{null!=N&&N(!1),null!=C&&C()}),[N,C]),de=Object(a.useMemo)((()=>{if(ee.crud){const t=["createFrom","duplicate",...null!=l?["createRule"]:[],...null!=c?["createRuleFromEql"]:[]];return q!==E.l.immutable&&(t.push("export"),t.push("selectable")),null!=u&&null!=e&&q!==E.l.immutable&&t.push("delete"),t}return q!==E.l.immutable?["export","selectable"]:[]}),[l,c,q,u,e,ee]),pe=Object(a.useMemo)((()=>r.a.createElement(r.a.Fragment,null,$)),[$]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{deleteTimelines:e,ids:oe,savedSearchIds:se,isDeleteTimelineModalOpen:Y,isEnableDownloader:Q,onComplete:Z,title:null!==(G=null==H?void 0:H.title)&&void 0!==G?G:k.Z}),r.a.createElement(x.a,{checkBoxLabel:k.H,closeModal:ce,description:k.O,errorMessage:k.t,failedDetailed:k.u,importComplete:ue,importData:O.f,successMessage:k.U,showCheckBox:!1,showModal:null!=s&&s,submitBtnText:k.w,subtitle:k.x,title:k.v}),r.a.createElement("div",{"data-test-subj":"timelines-page-container",className:U.a},!!z&&z,"notes"!==F?r.a.createElement(r.a.Fragment,null,r.a.createElement(B,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:d,onQueryChange:m,onToggleOnlyFavorites:b,query:T,timelineType:P},pe),r.a.createElement(j.a,{border:!0},r.a.createElement(j.d,null,r.a.createElement(j.c,null,r.a.createElement(j.e,{"data-test-subj":"query-message"},r.a.createElement(r.a.Fragment,null,k.P," ",P===E.m.template?re:ie))),r.a.createElement(j.c,null,q!==E.l.immutable&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.e,{"data-test-subj":"selected-count"},P===E.m.template?k.M(_.length):k.N(_.length)),r.a.createElement(j.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:ae,"data-test-subj":"utility-bar-action"},r.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},k.a))),r.a.createElement(j.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:le},k.J)))),r.a.createElement(J,{actionTimelineToShow:de,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:i,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:W,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:K,onOpenTimeline:p,onSelectionChange:f,onTableChange:g,onToggleShowNotes:h,pageIndex:v,pageSize:I,searchResults:M,showExtendedColumns:!0,sortDirection:D,sortField:A,timelineType:P,totalSearchResultsCount:V,tableRef:X})):r.a.createElement(te.a,{onOpenTimeline:p})))}));ae.displayName="OpenTimeline";var re=n(224);const ie=r.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>r.a.createElement(re.a,{title:a,split:!0,height:40},r.a.createElement(w.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&r.a.createElement(w.EuiFlexItem,{grow:!1},r.a.createElement(w.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},k.q)),e&&r.a.createElement(w.EuiFlexItem,null,e)))));ie.displayName="TitleRow";const oe=v.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);oe.displayName="HeaderContainer";const se=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:i=[],isLoading:o,itemIdToExpandedNotesRowMap:s,onAddTimelinesToFavorites:l,onDeleteSelected:c,onlyFavorites:u,onOpenTimeline:d,onQueryChange:p,onSelectionChange:m,onTableChange:f,onToggleOnlyFavorites:g,onToggleShowNotes:b,pageIndex:y,pageSize:h,searchResults:v,selectedItems:E,sortDirection:x,sortField:j,timelineFilter:O,timelineType:S,templateTimelineFilter:k,title:I,totalSearchResultsCount:T})=>{const C=Object(a.useRef)(null),M=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=c&&null!=e&&t.push("delete"),t.filter((e=>!i.includes(e)))}),[c,e,i]),_=Object(a.useMemo)((()=>r.a.createElement(a.Fragment,{key:"search-row-content"},!!k&&k)),[k]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.EuiModalHeader,null,r.a.createElement(oe,null,r.a.createElement(ie,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:E.length,title:I}))),r.a.createElement(w.EuiModalBody,null,r.a.createElement(r.a.Fragment,null,!!O&&r.a.createElement(r.a.Fragment,null,O,r.a.createElement(w.EuiSpacer,{size:"m"})),r.a.createElement(B,{"data-test-subj":"search-row",onlyFavorites:u,onQueryChange:p,onToggleOnlyFavorites:g,query:"",timelineType:S},_),r.a.createElement(J,{actionTimelineToShow:M,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:o,itemIdToExpandedNotesRowMap:s,onOpenTimeline:d,onSelectionChange:m,onTableChange:f,onToggleShowNotes:b,pageIndex:y,pageSize:h,searchResults:v,showExtendedColumns:!1,sortDirection:x,sortField:j,timelineType:S,totalSearchResultsCount:T,tableRef:C}))))}));se.displayName="OpenTimelineModalBody";var le=n(156),ce=n(194);let ue=function(e){return e.tab="tab",e.filter="filter",e}({});var de=n(911),pe=n(127),me=n(132),fe=n(187),ge=n(219),be=n(274),ye=n(158);const he=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),ve=e=>e.reduce(((e,{timelineId:t,searchId:n})=>{let a=e;return null!=n&&(a={...a,searchIds:[...a.searchIds,n]}),null!=t&&(a={...a,timelineIds:[...a.timelineIds,t]}),a}),{timelineIds:[],searchIds:[]}),Ee=r.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:y=!1,importDataModalToggle:h,onOpenTimeline:v,setImportDataModalToggle:x,tabName:j,title:S})=>{const T=Object(i.useDispatch)(),{startTransaction:C}=Object(fe.b)(),[M,_]=Object(a.useState)({}),[N,A]=Object(a.useState)(!1),[F,P]=Object(a.useState)(0),[R,L]=Object(a.useState)(t),[q,z]=Object(a.useState)(""),[B,$]=Object(a.useState)([]),[V,G]=Object(a.useState)("desc"),[H,W]=Object(a.useState)("updated"),Q=Object(a.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),Y=Object(d.b)((e=>{var t,n;return null!==(t=null===(n=Q(e,p.c.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:K,selectedPatterns:Z}=Object(me.a)(pe.SourcererScopeName.timeline),X=Object(s.a)("unifiedComponentsInTimelineDisabled"),{customTemplateTimelineCount:J,defaultTimelineCount:ee,elasticTemplateTimelineCount:te,favoriteCount:ne,fetchAllTimeline:re,timelines:ie,loading:oe,totalCount:Ee,templateTimelineCount:xe}=Object(g.b)(),{timelineType:je,timelineTabs:Oe,timelineFilters:Se}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:i}=Object(ce.l)(le.a.timelines),{navigateToUrl:o}=Object(c.j)().services.application,{tabName:l}=Object(I.useParams)(),[u,d]=Object(a.useState)(l===E.m.default||l===E.m.template?l:E.m.default),p=Object(s.a)("securitySolutionNotesEnabled"),m=Object(a.useMemo)((()=>n(Object(ce.j)(E.m.default,i))),[n,i]),f=Object(a.useMemo)((()=>n(Object(ce.j)(E.m.template,i))),[n,i]),g=Object(a.useMemo)((()=>n(Object(ce.j)("notes",i))),[n,i]),b=Object(a.useCallback)((e=>{e.preventDefault(),o(m)}),[o,m]),y=Object(a.useCallback)((e=>{e.preventDefault(),o(f)}),[o,f]),h=Object(a.useCallback)((e=>{e.preventDefault(),o(g)}),[o,g]),v=Object(a.useCallback)((e=>[{id:E.m.default,name:k.W,href:m,disabled:!1,onClick:e===ue.tab?b:D.noop},{id:E.m.template,name:k.V,href:f,disabled:!1,onClick:e===ue.tab?y:D.noop}]),[m,f,b,y]),x=Object(a.useCallback)(((e,t)=>{d((t=>(t!==e&&d(e),t)))}),[d]),j=Object(a.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(w.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},v(ue.tab).map((e=>r.a.createElement(w.EuiTab,{"data-test-subj":`timeline-${ue.tab}-${e.id}`,isSelected:e.id===l,disabled:e.disabled,key:`timeline-${ue.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),x(e.id,ue.tab)}},e.name))),p&&r.a.createElement(w.EuiTab,{"data-test-subj":"timeline-notes",isSelected:"notes"===l,key:"timeline-notes",href:g,onClick:h},"Notes")),r.a.createElement(w.EuiSpacer,{size:"m"}))),[l]),O=Object(a.useMemo)((()=>r.a.createElement(w.EuiTabs,null,v(ue.filter).map((e=>r.a.createElement(w.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ue.filter}-${e.id}`,isSelected:e.id===u,key:`timeline-${ue.filter}-${e.id}`,onClick:t=>{e.onClick(t),x(e.id,ue.filter)}},e.name))))),[u,v,x]);return{timelineType:u,timelineTabs:j,timelineFilters:O}})({defaultTimelineCount:ee,templateTimelineCount:xe}),{timelineStatus:we,templateTimelineFilter:ke,installPrepackagedTimelines:Ie}=Object(de.a)({timelineType:je,customTemplateTimelineCount:J,elasticTemplateTimelineCount:te}),Te=Object(a.useCallback)((()=>{re({pageInfo:{pageIndex:F+1,pageSize:R},search:q,sort:{sortField:H,sortOrder:V},onlyUserFavorite:N,timelineType:je,status:we})}),[re,F,R,q,H,V,je,we,N]),Ce=Object(a.useCallback)((e=>{z(e.queryText.trim())}),[]),Me=Object(a.useCallback)((async(e,t)=>{C({name:e.length>1?ge.f.BULK_DELETE:ge.f.DELETE}),e.includes(Y)&&T(Object(f.createTimeline)({id:p.c.active,columns:X?b.b:be.a,dataViewId:K,indexNames:Z,show:!1,excludedRowRendererIds:X?[]:ye.b.excludedRowRendererIds})),await Object(O.b)(e,t),Te()}),[C,Y,Te,T,K,Z,X]),_e=Object(a.useCallback)((async(e,t)=>{await Me(e,t)}),[Me]),De=Object(a.useCallback)((async()=>{const e=he(B),{timelineIds:t,searchIds:n}=ve(e);await Me(t,n),ze()}),[B,Me]),Ne=Object(a.useCallback)((e=>{$(e)}),[]),Ae=Object(a.useCallback)((({page:e,sort:t})=>{if(null!=e){const{index:t,size:n}=e;P(t),L(n)}if(null!=t){const{field:e,direction:n}=t;G(n),W(e)}}),[]),Fe=Object(a.useCallback)((()=>{A(!N)}),[N]),Pe=Object(a.useCallback)((e=>{_(e)}),[]),{navigateTo:Re}=Object(c.l)(),Le=Object(a.useCallback)((e=>Re({deepLinkId:u.Oc.rulesCreate,path:`?${l.b}=${Object(o.encode)(e)}`})),[Re]),qe=Object(a.useCallback)((e=>Re({deepLinkId:u.Oc.rulesCreate,path:`?${l.a}=${Object(o.encode)(e)}`})),[Re]),ze=Object(a.useCallback)((()=>{$([])}),[]),Be=Object(U.g)(),$e=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&C({name:ge.f.DUPLICATE}),y&&null!=e&&e(),Be({duplicate:t,onOpenTimeline:v,timelineId:n,timelineType:a,unifiedComponentsInTimelineDisabled:X})}),[Be]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${U.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await Ie(),Te()})()}),[Te,Ie]),y?r.a.createElement(se,{"data-test-subj":"open-timeline-modal",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,hideActions:n,isLoading:oe,itemIdToExpandedNotesRowMap:M,onAddTimelinesToFavorites:void 0,onlyFavorites:N,onOpenTimeline:$e,onQueryChange:Ce,onSelectionChange:Ne,onTableChange:Ae,onToggleOnlyFavorites:Fe,onToggleShowNotes:Pe,pageIndex:F,pageSize:R,query:q,searchResults:ie,selectedItems:B,sortDirection:V,sortField:H,templateTimelineFilter:ke,timelineType:je,timelineStatus:we,timelineFilter:Se,title:S,totalSearchResultsCount:Ee}):r.a.createElement(ae,{"data-test-subj":"open-timeline",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,isLoading:oe,itemIdToExpandedNotesRowMap:M,importDataModalToggle:h,onAddTimelinesToFavorites:void 0,onCreateRule:Le,onCreateRuleFromEql:qe,onDeleteSelected:De,onlyFavorites:N,onOpenTimeline:$e,onQueryChange:Ce,onSelectionChange:Ne,onTableChange:Ae,onToggleOnlyFavorites:Fe,onToggleShowNotes:Pe,pageIndex:F,pageSize:R,query:q,refetch:Te,searchResults:ie,setImportDataModalToggle:x,selectedItems:B,sortDirection:V,sortField:H,tabName:j,templateTimelineFilter:ke,timelineType:je,timelineStatus:we,timelineFilter:Oe,title:S,totalSearchResultsCount:Ee})})),xe=r.a.memo(Ee)},function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(2),r=n.n(a),i=n(19),o=n(48),s=n(1213),l=n(844),c=n(1261),u=n(694),d=n(4),p=n(793),m=n(119),f=n.n(m);const g=Object(a.memo)((e=>{const t=Object(a.useRef)(null),n=r.a.createElement(i.EuiButton,f()({buttonRef:t},e));return Object(a.useEffect)((()=>{t.current&&t.current.focus()}),[]),n}));g.displayName="AutoFocusButton";var b=n(126),y=n(451),h=n(118),v=n(361);const E=Object.freeze({deleteActionFailure:(e,t)=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionFailure",{defaultMessage:'Unable to remove "{itemName}". Reason: {errorMessage}',values:{itemName:e,errorMessage:t}}),deleteActionSuccess:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionSuccess",{defaultMessage:'"{itemName}" has been removed',values:{itemName:e}})}),x=Object.freeze({deleteModalTitle:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalTitle",{defaultMessage:"Delete {itemName}",values:{itemName:e}}),deleteModalImpactTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactTitle",{defaultMessage:"Warning"}),deleteModalImpactInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfo",{defaultMessage:"Deleting this entry will remove it from {count} associated {count, plural, one {policy} other {policies}}.",values:{count:Object(y.f)(e)?d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfoAll",{defaultMessage:"all"}):Object(y.d)(e).length}}),deleteModalConfirmInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalConfirmInfo",{defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalSubmitButtonTitle",{defaultMessage:"Delete"}),deleteModalCancelButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalCancelButtonTitle",{defaultMessage:"Cancel"})}),j=Object(a.memo)((({apiClient:e,item:t,onCancel:n,onSuccess:o,"data-test-subj":s,labels:l})=>{const c=Object(b.a)(s),{deleteArtifactItem:u,isLoading:d}=((e,t,n)=>{const r=Object(h.n)(),i=Object(v.c)(e,{onError:e=>{var a;r.addDanger(n.deleteActionFailure(t.name,(null===(a=e.body)||void 0===a?void 0:a.message)||e.message))},onSuccess:e=>{r.addSuccess(n.deleteActionSuccess(e.name))}});return Object(a.useMemo)((()=>({...i,deleteArtifactItem:i.mutateAsync})),[i])})(e,t,l),p=Object(a.useCallback)((()=>{u(t).then((()=>o()))}),[u,t,o]),m=Object(a.useCallback)((()=>{d||n()}),[d,n]);return r.a.createElement(i.EuiModal,{onClose:m,"data-test-subj":s},r.a.createElement(i.EuiModalHeader,{"data-test-subj":c("header")},r.a.createElement(i.EuiModalHeaderTitle,null,l.deleteModalTitle(t.name))),r.a.createElement(i.EuiModalBody,{"data-test-subj":c("body")},r.a.createElement(i.EuiText,null,r.a.createElement(i.EuiCallOut,{"data-test-subj":c("impactCallout"),title:l.deleteModalImpactTitle,color:"danger",iconType:"warning"},r.a.createElement("p",{"data-test-subj":c("impactCalloutInfo")},l.deleteModalImpactInfo(t))),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement("p",null,l.deleteModalConfirmInfo))),r.a.createElement(i.EuiModalFooter,null,r.a.createElement(i.EuiButtonEmpty,{onClick:m,isDisabled:d,"data-test-subj":c("cancelButton")},l.deleteModalCancelButtonTitle),r.a.createElement(g,{fill:!0,color:"danger",onClick:p,isLoading:d,isDisabled:d,"data-test-subj":c("submitButton")},l.deleteModalSubmitButtonTitle)))}));j.displayName="ArtifactDeleteModal";const O=Object.freeze({pageTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.pageTitle",{defaultMessage:"Artifact"}),pageAboutInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.aboutInfo",{defaultMessage:"A list of artifacts for endpoint"}),pageAddButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.addButtonTitle",{defaultMessage:"Add artifact"}),emptyStateTitleNoEntries:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitleNoEntries",{defaultMessage:"There are no entries to display."}),emptyStateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitle",{defaultMessage:"Add your first artifact"}),emptyStateInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateInfo",{defaultMessage:"Add an artifact"}),emptyStatePrimaryButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStatePrimaryButtonLabel",{defaultMessage:"Add"}),searchPlaceholderInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"}),getShowingCountLabel:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.showingTotal",{defaultMessage:"Showing {total, plural, one {# artifact} other {# artifacts}}",values:{total:e}}),cardActionEditLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionEditLabel",{defaultMessage:"Edit artifact"}),cardActionDeleteLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),...p.a,...x,...E});var S=n(587),w=n(1204),k=n(543),I=n(237),T=n(41),C=n.n(T),M=n(517);const _=C()(i.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1flznkw-0"})(["",""],(()=>Object(T.css)(["max-width:100%;"]))),D=Object(a.memo)((({onAdd:e,isAddDisabled:t=!1,backComponent:n,"data-test-subj":a,titleLabel:o,titleNoEntriesLabel:s,aboutInfo:l,primaryButtonLabel:c,secondaryAboutInfo:u,canCreateItems:d=!0})=>{const p=Object(b.a)(a);return r.a.createElement(M.a,null,d?r.a.createElement(_,{"data-test-subj":a,iconType:"plusInCircle",title:r.a.createElement("h2",{"data-test-subj":p("title")},o),body:r.a.createElement("div",{"data-test-subj":p("aboutInfo")},l,u?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),u):void 0),actions:[r.a.createElement(i.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":p("addButton")},c),...n?[n]:[]]}):r.a.createElement(_,{"data-test-subj":a,iconType:"iInCircle",title:r.a.createElement("h2",{"data-test-subj":p("title-no-entries")},s)}))}));D.displayName="NoDataEmptyState";var N=n(845),A=n(783),F=n(47),P=n(182),R=n(297),L=n(1352),q=n(518);var z=n(245),B=n(42),$=n(482);const V=Object(a.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:n,...a})=>{const o=Object($.a)(...n);return r.a.createElement(i.EuiButtonEmpty,f()({},a,{"data-test-subj":"backToOrigin",size:"s",href:t,onClick:o,textProps:{className:"text"}}),e||r.a.createElement(B.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));V.displayName="BackToExternalAppSecondaryButton";var U=n(734);const G=Object(a.memo)((({apiClient:e,ArtifactFormComponent:t,searchableFields:n=z.c,labels:d={},secondaryPageInfo:m,onFormSubmit:f,flyoutSize:g,"data-test-subj":y,allowCardEditAction:E=!0,allowCardCreateAction:x=!0,allowCardDeleteAction:T=!0,CardDecorator:C})=>{var M,_;const{state:B}=Object(o.useLocation)(),$=Object(b.a)(y),G=Object(h.n)(),H=Object(s.a)(),W=Object(N.a)(E,x),Q=Object(A.a)(),{urlParams:{filter:Y,includedPolicies:K}}=Object(R.a)(),{isPageInitializing:Z,isFetching:X,data:J,uiPagination:ee,doesDataExist:te,error:ne,refetch:ae}=((e,t)=>{const n=Object(s.a)(),{urlParams:{filter:r,includedPolicies:i}}=Object(R.a)(),{pagination:{page:o,pageSize:l}}=Object(q.b)(),c=((e,t,n)=>Object(a.useMemo)((()=>Object(L.a)({kuery:Object(L.b)(e,t),policies:n?n.split(","):[]})),[t,e,n]))(r,t,i),{data:u,isFetching:d,refetch:p}=Object(F.useQuery)(["does-data-exists",e],(async()=>e.hasData()),{enabled:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),[m,f]=Object(a.useState)({totalItemCount:0,pageSize:l,pageSizeOptions:[...P.f],pageIndex:o-1}),[g,b]=Object(a.useState)(!0),y=Object(v.f)(e,{page:o,perPage:l,filter:r,policies:i?i.split(","):[]},t),{data:h,isFetching:E,error:x,isSuccess:j}=y;return Object(a.useEffect)((()=>{n()&&g&&!d&&b(!1)}),[d,n,g]),Object(a.useEffect)((()=>{n()&&h&&!E&&j&&f((e=>({...e,pageIndex:h.page-1,pageSize:h.per_page,totalItemCount:h.total})))}),[E,n,j,h]),Object(a.useEffect)((()=>{!n()||E||d||x||"1"!==String(o)||c||!(h&&0===h.total&&u||h&&h.total>0&&!u)||p()}),[p,u,r,i,d,E,n,c,h,x,o]),Object(a.useMemo)((()=>({isPageInitializing:g,doesDataExist:null!=u&&u,uiPagination:m,...y})),[u,g,y,m])})(e,n);Object(a.useEffect)((()=>{var e;!X&&ne&&G.addDanger((null==ne||null===(e=ne.body)||void 0===e?void 0:e.message)||ne.message)}),[ne,G,X]);const re=Object(a.useMemo)((()=>{var e;return null!==(e=null==J?void 0:J.data)&&void 0!==e?e:[]}),[null==J?void 0:J.data]),[ie,oe]=Object(a.useState)(void 0),[se,le]=Object(a.useState)(void 0),ce=Object(a.useMemo)((()=>({...O,...d})),[d]),ue=(({items:e,onAction:t,cardActionDeleteLabel:n,cardActionEditLabel:r,dataTestSubj:i,allowCardDeleteAction:o=!0,allowCardEditAction:s=!0})=>{const l=Object(b.a)(i),c=Object(h.n)(),{data:d}=Object(k.c)({onError:e=>{c.addDanger(Object(I.d)(e))}}),p=Object(u.f)(null==d?void 0:d.items),m=Object(a.useMemo)((()=>{const a={};for(const c of e){const e=[];s&&e.push({icon:"controlsHorizontal",onClick:()=>{t({type:"edit",item:c})},"data-test-subj":l("cardEditAction"),children:r}),o&&e.push({icon:"trash",onClick:()=>{t({type:"delete",item:c})},"data-test-subj":l("cardDeleteAction"),children:n}),a[c.id]={item:c,policies:p,"data-test-subj":i,actions:e.length>0?e:void 0,hideDescription:!c.description,hideComments:!c.comments.length}}return a}),[e,s,o,p,i,l,r,t,n]);return Object(a.useCallback)((e=>m[e.id]),[m])})({items:re,onAction:Object(a.useCallback)((({type:e,item:t})=>{switch(e){case"edit":le(t),Q({show:"edit",itemId:t.item_id});break;case"delete":oe(t)}}),[Q]),cardActionDeleteLabel:ce.cardActionDeleteLabel,cardActionEditLabel:ce.cardActionEditLabel,dataTestSubj:$("card"),allowCardDeleteAction:T,allowCardEditAction:E}),de=Object(k.c)({perPage:1e3,onError:e=>{G.addWarning(Object(I.d)(e))}}),pe=function(e){const[t,n]=Object(a.useState)();return Object(a.useEffect)((()=>{e&&e.onBackButtonNavigateTo&&n(e)}),[e]),t}(B),me=Object(a.useMemo)((()=>{if(pe&&pe.onBackButtonNavigateTo)return r.a.createElement(V,pe)}),[pe]),fe=Object(a.useMemo)((()=>{if(pe&&pe.onBackButtonNavigateTo)return r.a.createElement(U.a,pe)}),[pe]),ge=Object(a.useCallback)((()=>{Q({show:"create"})}),[Q]),be=Object(a.useCallback)((({pageIndex:e,pageSize:t})=>{Q({page:e+1,pageSize:t}),window.scrollTo({top:0,left:0,behavior:"smooth"})}),[Q]),ye=Object(a.useCallback)(((e,t,n)=>{const a=e!==(null!=Y?Y:"")||t!==(null!=K?K:"");Q({filter:""===e.trim()?void 0:e,includedPolicies:""===t.trim()?void 0:t}),n&&!a&&ae()}),[Y,K,ae,Q]),he=Object(a.useCallback)((()=>{H()&&(oe(void 0),ae())}),[H,ae]),ve=Object(a.useCallback)((()=>{oe(void 0)}),[]),Ee=Object(a.useCallback)((()=>{le(void 0),ae()}),[ae]),xe=Object(a.useCallback)((()=>{le(void 0)}),[]),je=Object(a.useMemo)((()=>{const e=ce.pageAboutInfo?r.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},ce.pageAboutInfo):void 0,t=m?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),m):void 0;return r.a.createElement(r.a.Fragment,null,e,t)}),[ce.pageAboutInfo,m]);return Z?r.a.createElement(S.a,{"data-test-subj":$("pageLoader")}):r.a.createElement(l.a,{headerBackComponent:fe,hideHeader:!te,title:ce.pageTitle,subtitle:je,actions:x&&r.a.createElement(i.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:W,onClick:ge,"data-test-subj":$("pageAddButton")},ce.pageAddButtonTitle),"data-test-subj":$("container")},W&&r.a.createElement(p.b,{apiClient:e,item:se,onSuccess:Ee,onClose:xe,FormComponent:t,labels:ce,size:g,submitHandler:f,policies:(null===(M=de.data)||void 0===M?void 0:M.items)||[],policiesIsLoading:de.isLoading,"data-test-subj":$("flyout")}),ie&&r.a.createElement(j,{apiClient:e,item:ie,labels:ce,"data-test-subj":$("deleteModal"),onSuccess:he,onCancel:ve}),te?r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{defaultValue:Y,onSearch:ye,placeholder:ce.searchPlaceholderInfo,hasPolicyFilter:!0,policyList:null===(_=de.data)||void 0===_?void 0:_.items,defaultIncludedPolicies:K}),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiText,{color:"subdued",size:"xs","data-test-subj":$("showCount")},ce.getShowingCountLabel(ee.totalItemCount)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{items:re,ItemComponent:u.a,itemComponentProps:ue,onChange:be,error:ne,loading:X,pagination:ee,contentClassName:"card-container","data-test-subj":$("list"),CardDecorator:C})):r.a.createElement(D,{onAdd:ge,titleNoEntriesLabel:ce.emptyStateTitleNoEntries,titleLabel:ce.emptyStateTitle,aboutInfo:ce.emptyStateInfo,primaryButtonLabel:ce.emptyStatePrimaryButtonLabel,backComponent:me,"data-test-subj":$("emptyState"),secondaryAboutInfo:m,canCreateItems:x}))}));G.displayName="ArtifactListPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(119),r=n.n(a),i=n(2),o=n(90),s=n(981),l=n(8),c=n.n(l),u=n(71),d=n.n(u),p=n(19);const m="eui-global",f="eui-utilities",g={darkMode:!1};var b=n(43);const y=[p.euiStylisPrefixer],h=d()({key:"css",stylisPlugins:y,container:document.querySelector('meta[name="emotion"]')}),v=d()({key:m,stylisPlugins:y,container:document.querySelector(`meta[name="${m}"]`)}),E=d()({key:f,stylisPlugins:y,container:document.querySelector(`meta[name="${f}"]`)});h.compat=!0,v.compat=!0,E.compat=!0;const x={default:h,global:v,utility:E},j=({theme:{theme$:e},globalStyles:t,colorMode:n,modify:a,children:r})=>{const o=c()(e,g),s=Object(i.useMemo)((()=>(e=>e.darkMode?p.COLOR_MODES_STANDARD.dark:p.COLOR_MODES_STANDARD.light)(o)),[o]),l=n||s,u=!1!==t&&void 0;return Object(b.jsx)(p.EuiProvider,{cache:x,modify:a,colorMode:l,globalStyles:u,utilityClasses:u},r)},O=({children:e,i18n:t,...n})=>Object(o.useIsNestedEuiProvider)()?(Object(s.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(b.jsx)(t.Context,null,e)):Object(b.jsx)(j,n,Object(b.jsx)(t.Context,null,e));var S=n(84);const w=({children:e,...t})=>Object(b.jsx)(O,r()({globalStyles:!1},t),Object(b.jsx)(S.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(b.jsx)(S.KibanaErrorBoundary,null,e)))},function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return C}));var a=n(2),r=n.n(a),i=n(19),o=n(121),s=n(908),l=n(194);const c="timeline";var u=n(4);const d=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),p=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),m=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),f=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),g=e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),b=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var y=n(156);const h=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(l.l)(y.a.timelines),c=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),u=Object(a.useCallback)(((e,a,r)=>{const i=n(Object(l.k)(null!=a?a:"",r),{absolute:!0,skipSearch:!0});t(`[${e}](${i})`,{block:!1})}),[n,t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiModalHeader,null),r.a.createElement(i.EuiModalBody,null,r.a.createElement(s.a,{hideUntitled:!0,getSelectableOptions:c,onTimelineChange:u,onClosePopover:e,timelineType:o.m.default})))},v=Object(a.memo)(h),E=({interactionsUpsellingMessage:e})=>({name:c,button:{label:null!=e?e:d,iconType:"timeline",isDisabled:!!e},helpText:r.a.createElement(i.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return r.a.createElement(v,{onClosePopover:n,onInsert:t})}});var x=n(58),j=n(429);const O=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function r(e,n){if(t[a]!==e)throw new Error(f);a++;let r="",i=0;for(;a<t.length;a++){const o=t[a];if(o===n&&0===i)return a++,r;o===n?i--:o===e&&i++,r+=o}return""}const i=r("[","]"),o=r("(",")"),s=e.now();if(!i)return this.file.info(p,{line:s.line,column:s.column}),!1;try{var l;const t=o.split("?"),n=Object(j.parse)(t[1]),a=Object(x.safeDecode)(null!==(l=n.timeline)&&void 0!==l?l:""),{id:r="",graphEventId:u=""}=null!=a?a:{id:null,graphEventId:""};return r?e(`[${i}](${o})`)({type:c,id:r,title:i,graphEventId:u}):(this.file.info(m,{line:s.line,column:s.column+o.indexOf("id")}),!1)}catch{this.file.info((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(o),{line:s.line,column:s.column})}return!1},r=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};r.locator=(e,t)=>e.indexOf("[",t),t.timeline=r,n.splice(n.indexOf("url"),0,c)};var S=n(208),w=n(184),k=n(122),I=n(123);const T=({id:e,title:t,graphEventId:n})=>{const{addError:o}=Object(I.a)(),s=Object(S.b)("investigation_guide_interactions"),l=(()=>{const e=Object(w.g)(),t=Object(k.a)("unifiedComponentsInTimelineDisabled");return Object(a.useCallback)(((n,a,r)=>{e({graphEventId:r,timelineId:n,onError:a,unifiedComponentsInTimelineDisabled:t})}),[e,t])})(),c=Object(a.useCallback)(((e,t)=>{o(e,{title:b,toastMessage:g(t)})}),[o]),d=Object(a.useCallback)((()=>l(null!=e?e:"",c,n)),[e,n,l,c]);return r.a.createElement(i.EuiToolTip,{content:null!=s?s:(p=null!=e?e:"",u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:p}}))},r.a.createElement(i.EuiLink,{onClick:d,disabled:!!s,"data-test-subj":`markdown-timeline-link-${e}`},t));var p},C=Object(a.memo)(T)},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(44),r=n(19),i=n(2),o=n.n(i),s=n(41),l=n.n(s),c=n(179),u=n(121),d=n(252),p=n(4);const m=p.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),f=p.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),g=p.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),b=p.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),y=p.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),h=p.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),v=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),E=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),x=p.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),j=p.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),O=p.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),S=p.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),w=p.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),k=p.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),I=e=>p.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),T=[{label:y},{label:v},{label:h},{label:E},{label:f},{label:m}],C=[],M=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):C).map((e=>({label:e})))};var n})):C,_=({browserFields:e,selectedField:t,selectedOperator:n,type:r})=>{const i=t.length>0?t[0].label:"",o=n.length>0?n[0].label:"",s=e&&null!=Object(d.a)(e)[i],l=-1!==Object(a.findIndex)((e=>e.label===o),T),c=r===u.a.template&&(o===h||o===E);return s&&l&&!c},D=e=>{switch(e.length>0?e[0].label:""){case y:case v:return c.d;case h:case E:return c.c;case f:case m:return c.b;default:return c.d}},N=e=>{switch(e.length>0?e[0].label:""){case v:case E:case m:return!0;default:return!1}},A=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var F=n(191);const P=({value:e,onChangeCallback:t})=>{const[n,a]=Object(i.useState)(R(e));Object(i.useEffect)((()=>{t(L(n))}),[n,t]);const s=Object(i.useCallback)(((e,t=n)=>{const r=e.trim().toLowerCase();r&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===r))&&a([...n,{label:e}])}),[n]),l=Object(i.useCallback)((e=>{a(e)}),[]);return o.a.createElement(r.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:x,onCreateOption:s,onChange:l})},R=e=>Object(F.j)(e)?e.map((e=>({label:String(e)}))):[],L=e=>e.map((e=>e.label)),q=({value:e,onChangeCallback:t})=>{const[n,a]=Object(i.useState)(z(e));Object(i.useEffect)((()=>{t(A(n))}),[n,t]);const s=Object(i.useCallback)((e=>{a(e.target.value)}),[]);return o.a.createElement(r.EuiFieldText,{className:"edit-data-provider-value",onChange:s,placeholder:S,value:A(n)})},z=e=>{var t;return Object(F.j)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},B="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const $=o.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:s,onDataProviderEdited:l,operator:u,providerId:d,timelineId:p,value:x,type:S=c.a.default})=>{const[C,A]=Object(i.useState)([{label:n}]),[F,R]=Object(i.useState)(((e,t)=>":"===t?e?[{label:v}]:[{label:y}]:"includes"===t?e?[{label:E}]:[{label:h}]:e?[{label:m}]:[{label:f}])(s,u)),[L,z]=Object(i.useState)(x),$=Object(i.useMemo)((()=>F.length>0&&(F[0].label===h||F[0].label===E)),[F]),V=Object(i.useMemo)((()=>S!==c.a.template&&F.length>0&&F[0].label!==f&&F[0].label!==m&&!$),[$,S,F]),U=Object(i.useMemo)((()=>$&&Array.isArray(L)&&!L.length),[$,L]),G=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(B);e.length>0&&e[0].focus()}},H=Object(i.useCallback)((e=>{A(e),S===c.a.template&&z(`{${e[0].label}}`),G()}),[S]),W=Object(i.useCallback)((e=>{R(e),G()}),[]),Q=Object(i.useCallback)((e=>{z(e)}),[]),Y=Object(i.useCallback)((()=>{l({andProviderId:e,excluded:N(F),field:C.length>0?C[0].label:"",id:p,operator:D(F),providerId:d,value:L,type:S})}),[l,e,F,C,p,d,L,S]);return Object(i.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),o.a.createElement(r.EuiPanel,{paddingSize:"s"},o.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(r.EuiFormRow,{label:g},o.a.createElement(r.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:H,options:M(t),placeholder:b,selectedOptions:C,singleSelection:{asPlainText:!0},fullWidth:!0}))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiSpacer,{size:"m"})),o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(r.EuiFormRow,{label:j},o.a.createElement(r.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:W,options:T,placeholder:k,selectedOptions:F,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiSpacer,{size:"m"})),o.a.createElement(r.EuiFlexItem,{grow:!1},V&&o.a.createElement(r.EuiFormRow,{label:w},o.a.createElement(q,{onChangeCallback:Q,value:x})),$&&S!==c.a.template&&o.a.createElement(r.EuiFormRow,{label:w},o.a.createElement(P,{onChangeCallback:Q,value:x}))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiSpacer,{size:"m"})),o.a.createElement(r.EuiFlexItem,{grow:!1},S===c.a.template&&$&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:I(F[0].label)}),o.a.createElement(r.EuiSpacer,{size:"m"})),o.a.createElement(r.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButton,{className:B,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!_({type:S,browserFields:t,selectedField:C,selectedOperator:F})||U,onClick:Y,size:"m"},O))))))}));$.displayName="StatefulEditDataProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(2),r=n.n(a),i=n(92);const o={capabilities:Object(i.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var s=n(123),l=n(118),c=n(1532),u=n(1533);const d=Object(c.a)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),p=n(4).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),m={...o,capabilitiesFetched:!1},f=r.a.createContext(m);f.displayName="MlCapabilitiesContext";const g=r.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(m),i=Object(l.i)(),{addError:o}=Object(s.a)(),{start:c,result:g,error:b}=Object(u.a)(d);return Object(a.useEffect)((()=>{c({http:i})}),[i,c]),Object(a.useEffect)((()=>{g&&n({...g,capabilitiesFetched:!0})}),[g]),Object(a.useEffect)((()=>{b&&o(b,{title:p})}),[o,b]),r.a.createElement(f.Provider,{value:t},e)}));g.displayName="MlCapabilitiesProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),r=n.n(a),i=n(19),o=n(123),s=n(4);const l=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),c=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),u=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),p=e=>s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),m=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),f=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),g=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),r=new Error(a.join(". "));return r.stack=void 0,r.name="Network errors",r.raw_network_error=t,r};var b=n(242);const y=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:n}=Object(b.c)().services;if(!t||!e.length)return null;const{actionPath:a,message:o,buttonLabel:l}=e[0];return r.a.createElement(i.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:r.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(c=t,s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:c},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},r.a.createElement(i.EuiText,{size:"xs"},o)),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},r.a.createElement(i.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:n.basePath.prepend(a)},l||m)))));var c};y.displayName="ActionConnectorWarningsComponent";const h=r.a.memo(y);h.displayName="ActionConnectorWarnings";const v=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:m,failedDetailed:b,importComplete:y,importData:v,showCheckBox:E=!0,showExceptionsCheckBox:x=!1,showActionConnectorsCheckBox:j=!1,showModal:O,submitBtnText:S,subtitle:w,successMessage:k,title:I})=>{const[T,C]=Object(a.useState)(null),[M,_]=Object(a.useState)(!1),[D,N]=Object(a.useState)(!1),[A,F]=Object(a.useState)(!1),[P,R]=Object(a.useState)(!1),{addError:L,addSuccess:q}=Object(o.a)(),[z,B]=Object(a.useState)([]),$=Object(a.useMemo)((()=>Object(i.htmlIdGenerator)()()),[]),[V,U]=Object(a.useState)(0),G=Object(a.useCallback)((()=>{t(),N(!1),F(!1),R(!1),B([])}),[t,N,F]),H=Object(a.useCallback)((e=>{_(!1),C(null),y(),e&&(y(),G())}),[G,y]),W=Object(a.useCallback)((async()=>{if(null!=T){_(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...n}=await v({fileToImport:T[0],overwrite:D,overwriteExceptions:A,overwriteActionConnectors:P,signal:e.signal}),a=n.action_connectors_success_count;B(t),U(a),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:n,successMessage:a,errorMessage:r,errorMessageDetailed:i,addError:o,addSuccess:l})=>{if(e.success)return e.success_count>0&&l(a(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&l((u=e.exceptions_success_count,s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:u},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(n&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&l((c=e.action_connectors_success_count,s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:c},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var c,u;if(e.errors.length>0){if(n&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:n}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:n,error:a}=e;t=t&&t!==n?`${t},${n}`:n;const{status_code:r,message:i}=a||{};let o;return o=403===r?f:i,{...e,error:{...a,message:o}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return o(g(i,e,t),{title:p(n||t.length)})}o(g(i,e,e.errors),{title:r(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&o(g(i,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:n,exceptionsIncluded:x,actionConnectorsIncluded:j,successMessage:k,errorMessage:m,errorMessageDetailed:b,addError:L,addSuccess:q}),H(!(null!=t&&t.length))}catch(e){G(),L(e,{title:m(1)})}}}),[T,v,D,A,P,x,k,m,b,L,q,j,H,G]),Q=Object(a.useCallback)((()=>{G()}),[G]),Y=Object(a.useCallback)((()=>{N((e=>!e))}),[]),K=Object(a.useCallback)((()=>{F((e=>!e))}),[]),Z=Object(a.useCallback)((()=>{R((e=>!e))}),[]),X=Object(a.useCallback)((e=>{C(e&&e.length>0?e:null)}),[]);return r.a.createElement(r.a.Fragment,null,O&&r.a.createElement(i.EuiModal,{onClose:Q,maxWidth:"750px"},r.a.createElement(i.EuiModalHeader,null,r.a.createElement(i.EuiModalHeaderTitle,null,I)),r.a.createElement(i.EuiModalBody,null,r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("h4",{id:$},n)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:w,onChange:X,display:"large",fullWidth:!0,isLoading:M,"aria-labelledby":$}),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(h,{actionConnectorsWarnings:z,importedActionConnectorsCount:V}),r.a.createElement(i.EuiSpacer,{size:"s"}),E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:D,onChange:Y}),x&&r.a.createElement(i.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:c,checked:A,onChange:K}),j&&r.a.createElement(i.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:u,checked:P,onChange:Z}))),r.a.createElement(i.EuiModalFooter,null,r.a.createElement(i.EuiButtonEmpty,{onClick:Q},l),r.a.createElement(i.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:W,disabled:null==T||M,fill:!0},S))))};v.displayName="ImportDataModalComponent";const E=r.a.memo(v);E.displayName="ImportDataModal"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(44),r=n(2),i=n.n(r),o=n(45),s=n(121),l=n(124),c=n(129),u=n(19),d=n(52),p=n.n(d),m=n(41),f=n.n(m),g=n(130),b=n(657),y=n(179),h=n(516);const v=f()(u.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===s.m.template?"140px":"none"));v.displayName="ProviderBadgeStyled";const E=f.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),x=f()(E).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),j=f()(E).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),O=({type:e,toggleType:t})=>e!==y.a.template?i.a.createElement(j,{onClick:t},h.d):i.a.createElement(x,null,h.w),S=i.a.memo(O),w={tabIndex:-1},k=i.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:o,operator:l,providerId:c,togglePopover:u,toggleType:d,displayValue:m,val:f,type:E,timelineType:x})=>{const j=Object(r.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),O=Object(r.useMemo)((()=>p()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":o})),[n,o]),k=Object(r.useMemo)((()=>Object(a.isString)(f)&&""===f?Object(g.b)():f),[f]),I=Object(r.useMemo)((()=>o?i.a.createElement("span",null,h.q," "):null),[o]),T=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,I,l!==y.b?i.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?m:k}"`):i.a.createElement("span",{className:"field-value"},t," ",h.j))),[m,t,k,l,I]),C=Object(r.useMemo)((()=>h.v({field:t,value:`${k}`})),[t,k]);return i.a.createElement(b.a,{id:`${c}-${t}-${f}`},i.a.createElement(i.a.Fragment,null,i.a.createElement(v,{className:O,color:"hollow",title:"",iconOnClick:j,iconOnClickAriaLabel:h.t,iconType:"cross",iconSide:"right",onClick:u,onClickAriaLabel:C,closeButtonProps:w,"data-test-subj":"providerBadge",$timelineType:x},T),x===s.m.template&&l!==y.c&&i.a.createElement(S,{toggleType:d,type:E})))}));k.displayName="ProviderBadge";var I=n(0),T=n.n(I),C=n(955);const M="edit-data-provider",_="exclude-data-provider",D="enable-data-provider",N="filter-for-field-present-data-provider",A="delete-data-provider",F=f()(u.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);F.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends i.a.PureComponent{constructor(...e){super(...e),T()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:r,providerId:i,value:o,type:s})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:r,providerId:i,value:o,type:s}),this.props.closePopover()})),T()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:r,type:i}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:y.b,providerId:a,value:r,type:i}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:r,field:o,isEnabled:l,isExcluded:c,isLoading:d,isOpen:p,operator:m,providerId:f,timelineId:g,timelineType:b,toggleEnabledProvider:v,toggleExcludedProvider:E,toggleTypeProvider:x,value:j,type:O}=this.props,S=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:r,isExcluded:o,isLoading:l,operator:c,onDataProviderEdited:u,onFilterForFieldPresent:d,providerId:p,timelineId:m,timelineType:f,toggleEnabled:g,toggleExcluded:b,toggleType:v,type:E,value:x})=>[{id:0,items:[{className:M,disabled:l,icon:"pencil",name:h.g,panel:1},{className:_,disabled:l,icon:o?"plusInCircle":"minusInCircle",name:o?h.p:h.i,onClick:b},{className:D,disabled:l,icon:r?"eyeClosed":"eye",name:r?h.x:h.u,onClick:g},{className:N,disabled:l,icon:"logstashFilter",name:h.k,onClick:d},f===s.m.template?{className:"convert-to-field-data-provider",disabled:l||c===y.c,icon:"visText",name:E===y.a.template?h.c:h.d,onClick:v}:{name:null},{className:A,disabled:l,icon:"trash",name:h.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=m&&null!=u?i.a.createElement(C.a,{andProviderId:e,browserFields:t,field:a,isExcluded:o,onDataProviderEdited:u,operator:c,providerId:p,timelineId:m,value:x,type:E}):null,id:1,title:h.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:r,field:o,isEnabled:l,isExcluded:c,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:m,providerId:f,timelineId:g,timelineType:b,toggleEnabled:v,toggleExcluded:E,toggleType:x,value:j,type:O});return i.a.createElement(F,{id:`popoverFor_${f}-${o}-${j}`,isOpen:p,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},i.a.createElement("div",{style:{userSelect:"none"}},i.a.createElement(u.EuiContextMenu,{initialPanelId:0,panels:S,"data-test-subj":"providerActions"})))}}var P=n(337),R=n(158);const L=i.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isPopoverOpen:f,onDataProviderEdited:g,operator:b,providerId:h,register:v,setIsPopoverOpen:E,timelineId:x,toggleEnabledProvider:j,toggleExcludedProvider:O,toggleTypeProvider:S,displayValue:w,val:I,type:T=y.a.default,wrapperRef:C})=>{const M=Object(r.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),_=Object(l.b)((e=>{var t,n;return x&&null!==(t=null===(n=M(e,x))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:s.m.default})),{isLoading:D}=Object(l.a)((e=>{var t;return null!==(t=M(e,null!=x?x:""))&&void 0!==t?t:R.b})),N=Object(r.useCallback)((()=>{E(!f)}),[f,E]),A=Object(r.useCallback)((()=>{var e;E(!1),null==C||null===(e=C.current)||void 0===e||e.focus()}),[C,E]),F=Object(r.useCallback)((()=>{j(),A()}),[A,j]),L=Object(r.useCallback)((()=>{O(),A()}),[O,A]),q=Object(r.useCallback)((()=>{S(),A()}),[S,A]),[z,B]=Object(r.useState)(!1),$=Object(o.useDispatch)();Object(r.useEffect)((()=>{null!=v&&($(P.a.registerProvider({provider:{...v,and:[]}})),B(!0))}),[z,$,v,B]);const V=Object(r.useCallback)((()=>{z&&null!=v&&$(P.a.unRegisterProvider({id:v.id}))}),[z,$,v]);Object(r.useEffect)((()=>()=>{V()}),[V]);const U=Object(r.useMemo)((()=>i.a.createElement(k,{deleteProvider:D?a.noop:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,providerId:h,togglePopover:N,toggleType:q,displayValue:null!=w?w:String(I),val:I,operator:b,type:T,timelineType:_})),[n,w,u,p,m,D,d,q,b,h,_,N,T,I]);return i.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:A,deleteProvider:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isLoading:D,isOpen:f,onDataProviderEdited:g,operator:b,providerId:h,timelineId:x,timelineType:_,toggleEnabledProvider:F,toggleExcludedProvider:L,toggleTypeProvider:q,value:I,type:T})}));L.displayName="ProviderItemBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(42),l=n(19),c=n(3),u=n(843),d=n(487),p=n(881),m=n(50),f=n(603);const g=e=>{var t,n,a,r,i,o,s;return null!=e&&null!==(t=e.agent)&&void 0!==t&&null!==(n=t.type)&&void 0!==n&&n.includes("endpoint")?((null==e||null===(a=e.host)||void 0===a||null===(r=a.os)||void 0===r?void 0:r.name)||["windows"]).map((e=>e.toLowerCase())):null!==(i=null==e||null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family)&&void 0!==i?i:["windows"]},b=e=>{var t,n;return{comments:[],description:"",entries:e&&e.event&&e.process?[{field:"event.category",operator:"included",type:"match",value:(null!==(t=e.event.category)&&void 0!==t?t:[])[0]},{field:"process.executable",operator:"included",type:"match",value:(null!==(n=e.process.executable)&&void 0!==n?n:[])[0]}]:[{field:"",operator:"included",type:"match",value:""}],item_id:void 0,list_id:f.a,meta:{temporaryUuid:Object(m.v4)()},name:"",namespace_type:"agnostic",tags:["policy:all"],type:"simple",os_types:g(e)}};var y=n(118),h=n(543),v=n(237),E=n(602),x=n(4);const j=Object(i.memo)((({onCancel:e,data:t,...n})=>{var a,m;const f=Object(y.n)(),g=Object(y.i)(),{isLoading:j,mutateAsync:O}=Object(u.a)(E.a.getInstance(g),"create"),[S,w]=Object(i.useState)(),[k,I]=Object(i.useState)(!1),{data:{search:T}}=Object(y.j)().services,C=Object(h.c)({perPage:1e3,onError:e=>{f.addWarning(Object(v.d)(e))}}),[M,_]=Object(i.useState)(b(t)),[D,N]=Object(i.useState)(),[A,F]=Object(i.useState)(!1),P=Object(i.useMemo)((()=>C.isLoading||C.isRefetching),[C]);Object(i.useEffect)((()=>(t&&(async()=>{var e;if(!t||!t._index)return;const n=await Object(c.lastValueFrom)(T.search({params:{index:t._index,body:{query:{match:{_id:t._id}}}}}));w({...t,host:{...t.host,os:{...(null==t||null===(e=t.host)||void 0===e?void 0:e.os)||{},name:[n.rawResponse.hits.hits[0]._source.host.os.name]}}})})(),()=>{_(b())})),[]);const R=Object(i.useCallback)((()=>{P||j||e()}),[j,P,e]),L=Object(i.useCallback)((()=>O(M,{onSuccess:t=>{var n;f.addSuccess((n=t,x.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.creationSuccessToastTitle",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:null==n?void 0:n.name}}))),e()},onError:e=>{f.addError(e,{title:'There was an error creating the new event filter: "{error}"',message:{error:e.message}})}})),[M,e,O,f]),q=Object(i.useCallback)((()=>{if(!D)return L();F(!0)}),[D,L]),z=Object(i.useMemo)((()=>o.a.createElement(l.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:!k||j||!!t&&!S||P,onClick:q,isLoading:P},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.update.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.create",defaultMessage:"Add event filter"}))),[t,S,q,k,j,P]),B=Object(i.useCallback)((e=>{e&&(I(e.isValid),_(e.item),N(e.confirmModalLabels))}),[]),$=Object(l.useGeneratedHtmlId)({prefix:"eventFiltersCreateFlyoutTitle"}),V=Object(i.useMemo)((()=>{if(D){const{title:e,body:t,confirmButton:n,cancelButton:a}=D;return o.a.createElement(d.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:L,onCancel:()=>F(!1),"data-test-subj":"artifactConfirmModal"})}}),[D,L]);return o.a.createElement(l.EuiFlyout,r()({size:"l",onClose:R,"data-test-subj":"eventFiltersCreateFlyout","aria-labelledby":$},n),o.a.createElement(l.EuiFlyoutHeader,{hasBorder:!0},o.a.createElement(l.EuiTitle,{size:"m"},o.a.createElement("h2",{id:$},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.title.create.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create",defaultMessage:"Add event filter"}))),t?o.a.createElement(l.EuiTextColor,{color:"subdued"},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create.withData",defaultMessage:"Endpoint security"})):null),o.a.createElement(l.EuiFlyoutBody,null,o.a.createElement(p.a,{allowSelectOs:!t,error:void 0,disabled:!1,item:M,mode:"create",onChange:B,policies:null!==(a=null==C||null===(m=C.data)||void 0===m?void 0:m.items)&&void 0!==a?a:[],policiesIsLoading:P})),o.a.createElement(l.EuiFlyoutFooter,null,o.a.createElement(l.EuiFlexGroup,{justifyContent:"spaceBetween"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiButtonEmpty,{isDisabled:j,"data-test-subj":"cancelExceptionAddButton",onClick:R},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.cancel",defaultMessage:"Cancel"}))),o.a.createElement(l.EuiFlexItem,{grow:!1},z))),A&&V)}));j.displayName="EventFiltersFlyout"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(56),r=n(2),i=n(123),o=n(333),s=n(5),l=n(118);const c=()=>{const{http:e}=Object(a.useKibana)().services,{addSuccess:t,addError:n}=Object(i.a)(),c=Object(r.useRef)(null),u=Object(r.useCallback)(((e=0)=>t(o.w(e))),[t]),d=Object(r.useCallback)((e=>{n(e.message,{title:o.v})}),[n]);return Object(r.useEffect)((()=>{let e=!1;const t=new AbortController;return c.current=async(n,a,r,i)=>{try{i(!0);const o=await(async({assignees:e,ids:t,signal:n})=>l.b.get().http.fetch(s.ib,{method:"POST",version:"2023-10-31",body:JSON.stringify({assignees:e,ids:t}),signal:n}))({assignees:n,ids:a,signal:t.signal});e||(r(),i(!1),u(o.updated))}catch(t){e||(i(!1),d(t))}},()=>{e=!0,t.abort()}}),[e,d,u]),c.current}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n.n(a),i=n(19),o=n(1293),s=n(483);const l="securitySolutionUsers",c=`${l}AvatarsPanel`,u=`${l}AvatarsCountBadge`,d=Object(a.memo)((({userProfiles:e,maxVisibleAvatars:t})=>t&&e.length>t?r.a.createElement(i.EuiToolTip,{position:"top",content:e.map((e=>{var t;return r.a.createElement("div",null,e?null!==(t=e.user.email)&&void 0!==t?t:e.user.username:s.b)})),repositionOnScroll:!0},r.a.createElement(i.EuiNotificationBadge,{"data-test-subj":u,color:"subdued"},e.length)):r.a.createElement(i.EuiFlexGroup,{"data-test-subj":c,alignItems:"center",direction:"row",gutterSize:"xs"},e.map(((e,t)=>{var n,a;return r.a.createElement(i.EuiFlexItem,{key:t,grow:!1},r.a.createElement(o.a,{"data-test-subj":(a=null!==(n=null==e?void 0:e.user.username)&&void 0!==n?n:`Unknown-${t}`,`${l}Avatar-${a}`),user:null==e?void 0:e.user,avatar:null==e?void 0:e.data.avatar,size:"s"}))})))));d.displayName="UsersAvatarsPanel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(4),c=n(42),u=n(41),d=n.n(u),p=n(140),m=n(536),f=n(265),g=n(126),b=n(364),y=n(340);const h=()=>{},v={bordered:!0,showIcons:!1},E={className:"effected-policies-search"},x=d.a.div.withConfig({displayName:"StyledEuiSelectable",componentId:"sc-rb0j09-0"})([".effected-policies-search{border-bottom-left-radius:0;border-bottom-right-radius:0;}.euiSelectableList{border-top-left-radius:0;border-top-right-radius:0;border-top-width:0;}"]),j=d()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemButtonGroup",componentId:"sc-rb0j09-1"})(["@media only screen and (max-width:","){align-items:center;}"],(e=>e.theme.eui.euiBreakpoints.m)),O=d()(s.EuiButtonGroup).withConfig({displayName:"StyledButtonGroup",componentId:"sc-rb0j09-2"})(["display:flex;justify-content:right;.euiButtonGroupButton{padding-right:",";}"],(e=>e.theme.eui.euiSizeL)),S=d.a.div.withConfig({displayName:"EffectivePolicyFormContainer",componentId:"sc-rb0j09-3"})([".policy-name .euiSelectableListItem__text{text-decoration:none !important;color:"," !important;}"],(e=>e.theme.eui.euiTextColor)),w=Object(i.memo)((({isGlobal:e,isPlatinumPlus:t,description:n,isLoading:a=!1,onChange:u,listProps:d,options:w,selected:k=[],disabled:I=!1,"data-test-subj":T,...C})=>{const{getAppUrl:M}=Object(b.a)(),{canReadPolicyManagement:_}=Object(p.a)().endpointPrivileges,D=Object(g.a)(T),N=Object(i.useMemo)((()=>[{id:"globalPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.global",{defaultMessage:"Global"}),iconType:e?"checkInCircleFilled":"empty","data-test-subj":D("global")},{id:"perPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.perPolicy",{defaultMessage:"Per Policy"}),iconType:e?"empty":"checkInCircleFilled","data-test-subj":D("perPolicy")}]),[D,e]),A=Object(i.useMemo)((()=>{const n=new Set(k.map((e=>e.id)));return w.map((a=>({label:a.name,className:"policy-name",prepend:o.a.createElement(s.EuiCheckbox,{id:Object(s.htmlIdGenerator)()(),onChange:h,checked:n.has(a.id),disabled:e||!t||I,"data-test-subj":`policy-${a.id}-checkbox`}),append:_?o.a.createElement(m.a,{href:M({path:Object(f.j)(a.id)}),appPath:Object(f.j)(a.id),target:"_blank","data-test-subj":D("policyLink")},o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.viewPolicyLinkLabel",defaultMessage:"View policy"})):null,policy:a,checked:n.has(a.id)?"on":void 0,disabled:e||!t||I,"data-test-subj":`policy-${a.id}`}))).sort((({label:e},{label:t})=>e.localeCompare(t)))}),[_,I,M,D,e,t,w,k]),F=Object(i.useCallback)((t=>{u({isGlobal:e,selected:t.filter((e=>e.checked)).map((e=>e.policy))})}),[e,u]),P=Object(i.useCallback)((e=>{u({isGlobal:"globalPolicy"===e,selected:k})}),[u,k]),R=Object(i.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]);return o.a.createElement(S,null,o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.assignmentSectionTitle",defaultMessage:"Assignment"}))),o.a.createElement(s.EuiSpacer,{size:"xs"}),o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:2},o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,n||l.i18n.translate("xpack.securitySolution.effectedPolicySelect.assignmentSectionDescription",{defaultMessage:"Assign globally across all policies, or assign it to specific policies."})))),o.a.createElement(j,{grow:1},o.a.createElement(s.EuiFormRow,{fullWidth:!0,isDisabled:I},o.a.createElement(O,{legend:"Global Policy Toggle",options:N,idSelected:e?"globalPolicy":"perPolicy",onChange:P,color:"primary","data-test-subj":D("byPolicyGlobalButtonGroup"),isDisabled:I})))),o.a.createElement(s.EuiSpacer,null),!e&&(a?o.a.createElement(y.a,{size:"l","data-test-subj":D("policiesLoader")}):o.a.createElement(s.EuiFormRow,{fullWidth:!0},o.a.createElement(x,null,o.a.createElement(s.EuiSelectable,r()({},C,{options:A,listProps:d||v,onChange:F,searchProps:E,searchable:!0,"data-test-subj":D("policiesSelectable")}),R)))))}));w.displayName="EffectedPolicySelect"},,function(e,t,n){"use strict";n.d(t,"b",(function(){return R})),n.d(t,"a",(function(){return L}));var a=n(2),r=n.n(a),i=n(19),o=n(7),s=n(45),l=n(1334),c=n(44),u=n(1630),d=n(379),p=n(355),m=n(131),f=n(930),g=n(118),b=n(571),y=n(343),h=n(140),v=n(180),E=n(546),x=n(172),j=n(148),O=n(381),S=n(380),w=n(532),k=n(962),I=n(667),T=n(933),C=n(928),M=n(936),_=n(432),D=n(929),N=n(973),A=n(931),F=n(932);const P=({ariaLabel:e=x.K,ariaRowindex:t,columnValues:n,disabled:l,ecsRowData:d,onRuleChange:y,scopeId:E,refetch:O})=>{var S,w,P,R,q,z,B,$,V,U,G,H,W,Q,Y,K,Z,X,J;const[ee,te]=Object(a.useState)(!1),[ne,ae]=Object(a.useState)(!1),re=Object(a.useCallback)((()=>{te(!1)}),[]),ie=Object(a.useMemo)((()=>j.d.globalQuery()),[]),oe=Object(a.useMemo)((()=>j.d.timelineQueryByIdSelector()),[]),se=Object(s.useSelector)((e=>ie(e))),le=Object(s.useSelector)((e=>oe(e,E))),ce=null!=d&&null!==(ue=d.kibana)&&void 0!==ue&&ue.alert?null==d?void 0:d._id:null;var ue;const de=Object(c.get)(0,null==d||null===(S=d.kibana)||void 0===S||null===(w=S.alert)||void 0===w||null===(P=w.rule)||void 0===P?void 0:P.uuid),pe=Object(c.get)(0,null==d||null===(R=d.kibana)||void 0===R||null===(q=R.alert)||void 0===q||null===(z=q.rule)||void 0===z?void 0:z.rule_id),me=Object(c.get)(0,null==d||null===(B=d.kibana)||void 0===B||null===($=B.alert)||void 0===$||null===(V=$.rule)||void 0===V?void 0:V.name),fe=[u.b.alertsOnAlertsPage,u.b.alertsOnRuleDetailsPage].includes(E),{addToCaseActionItems:ge}=Object(N.a)({ecsData:d,onMenuItemClick:re,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:""),ariaLabel:Object(_.a)({ariaRowindex:t,columnValues:n}),isInDetections:fe,refetch:O}),{loading:be,canWriteEventFilters:ye}=Object(h.a)().endpointPrivileges,he=Object(a.useMemo)((()=>!be&&ye),[ye,be]),ve=Object(c.get)(0,null==d||null===(U=d.kibana)||void 0===U||null===(G=U.alert)||void 0===G?void 0:G.workflow_status),Ee=Object(a.useMemo)((()=>{var e;return-1!==Object(o.indexOf)(null===(e=d.event)||void 0===e?void 0:e.kind,"event")}),[d]),xe=Object(a.useMemo)((()=>{var e,t;return null===(e=d.agent)||void 0===e||null===(t=e.type)||void 0===t?void 0:t.includes("endpoint")}),[d]),je=Object(a.useMemo)((()=>Ee&&xe),[Ee,xe]),Oe=Object(a.useMemo)((()=>{const e=Object(c.getOr)([],"kibana.alert.original_event.module",d),t=Object(c.getOr)([],"kibana.alert.original_event.kind",d);return e.includes("endpoint")&&t.includes("alert")}),[d]),Se=Object(a.useMemo)((()=>E===u.b.hostsPageEvents||E===u.b.usersPageEvents),[E]),we=Object(a.useCallback)((()=>{te(!ee)}),[ee]),ke=Object(a.useCallback)((()=>{te(!1)}),[]),Ie=Object(a.useMemo)((()=>r.a.createElement(i.EuiToolTip,{position:"top",content:x.K},r.a.createElement(i.EuiButtonIcon,{"aria-label":e,"data-test-subj":"timeline-context-menu-button",size:"s",iconType:"boxesHorizontal","data-popover-open":ee,onClick:we,isDisabled:l}))),[l,we,e,ee]),Te=Object(a.useCallback)((()=>{const e=e=>{e.forEach((e=>e.refetch&&e.refetch()))};Object(m.isActiveTimeline)(null!=E?E:"")?e([le]):e(se),O&&O()}),[E,se,le,O]),Ce=null!==(H=null===(W=d["kibana.alert.rule.parameters"])||void 0===W?void 0:W.index)&&void 0!==H?H:null==d||null===(Q=d.signal)||void 0===Q||null===(Y=Q.rule)||void 0===Y?void 0:Y.index,Me=null!==(K=null===(Z=d["kibana.alert.rule.parameters"])||void 0===Z?void 0:Z.data_view_id)&&void 0!==K?K:null==d||null===(X=d.signal)||void 0===X||null===(J=X.rule)||void 0===J?void 0:J.data_view_id,{exceptionFlyoutType:_e,openAddExceptionFlyout:De,onAddExceptionCancel:Ne,onAddExceptionConfirm:Ae,onAddExceptionTypeClick:Fe}=Object(T.a)({refetch:Te,onRuleChange:y,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:"")}),{closeAddEventFilterModal:Pe,isAddEventFilterModalOpen:Re,onAddEventFilterClick:Le}=Object(M.a)(),{actionItems:qe}=Object(I.a)({alertStatus:ve,eventId:null==d?void 0:d._id,scopeId:E,refetch:Te,closePopover:ke}),ze=Object(a.useCallback)((e=>{Fe(e),ke()}),[ke,Fe]),Be=Object(a.useCallback)((()=>{Le(),ke()}),[ke,Le]),{exceptionActionItems:$e}=Object(C.a)({isEndpointAlert:Oe,onAddExceptionTypeClick:ze}),{eventFilterActionItems:Ve}=Object(D.a)({onAddEventFilterClick:Be,disabled:!je||!Se,tooltipMessage:Se?void 0:x.f}),Ue=Object(a.useMemo)((()=>{var e;return Object(c.get)(0,null==d||null===(e=d.agent)||void 0===e?void 0:e.id)}),[d]),Ge=Object(a.useCallback)((()=>{ae((e=>!e)),te(!1)}),[]),{osqueryActionItems:He}=(({handleClick:e})=>{const t=Object(a.useMemo)((()=>Object(f.a)({handleClick:e})),[e]),n=Object(g.j)().services.application.capabilities.osquery;return{osqueryActionItems:null!=n&&n.writeLiveQueries||null!=n&&n.runSavedQueries?[t]:[]}})({handleClick:Ge}),{alertTagsItems:We,alertTagsPanels:Qe}=Object(A.a)({closePopover:ke,ecsRowData:d,refetch:Te}),{alertAssigneesItems:Ye,alertAssigneesPanels:Ke}=Object(F.a)({closePopover:ke,ecsRowData:d,refetch:Te}),Ze=Object(a.useMemo)((()=>!Ee&&de?[...ge,...qe,...We,...Ye,...$e,...Ue?He:[]]:[...ge,...he?Ve:[],...Ue?He:[]]),[Ee,de,ge,qe,$e,Ue,He,Ve,he,We,Ye]),Xe=Object(a.useMemo)((()=>[{id:0,items:Ze},...Qe,...Ke]),[Qe,Ke,Ze]),Je=Object(a.useMemo)((()=>r.a.createElement(b.a,{agentId:Ue,defaultValues:ce?{alertIds:[ce]}:void 0,onClose:Ge,ecsData:d})),[Ue,ce,d,Ge]);return r.a.createElement(r.a.Fragment,null,Ze.length>0&&r.a.createElement("div",{key:"actions-context-menu"},r.a.createElement(v.l,{textAlign:"center",width:p.b},r.a.createElement(i.EuiPopover,{id:"singlePanel",button:Ie,isOpen:ee,closePopover:ke,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},r.a.createElement(i.EuiContextMenu,{size:"s",initialPanelId:0,panels:Xe,"data-test-subj":"actions-context-menu"})))),De&&de&&pe&&null!=me&&null!=(null==d?void 0:d._id)&&r.a.createElement(L,{ruleId:de,ruleRuleId:pe,ruleIndices:Ce,ruleDataViewId:Me,ruleName:me,exceptionListType:_e,eventId:null==d?void 0:d._id,onCancel:Ne,onConfirm:Ae,alertStatus:ve}),Re&&null!=d&&r.a.createElement(k.a,{data:d,onCancel:Pe}),ne&&Ue&&null!=d&&Je)},R=r.a.memo(P),L=({ruleId:e,ruleRuleId:t,ruleIndices:n,ruleDataViewId:i,ruleName:o,exceptionListType:s,eventId:c,onCancel:u,onConfirm:p,alertStatus:m})=>{var f;const{loading:g,signalIndexName:b}=Object(w.a)(),{rule:h,loading:v}=Object(d.a)(e),{loading:x,data:j}=Object(O.a)({query:Object(y.a)(c),indexName:b,queryName:S.a.ADD_EXCEPTION_FLYOUT}),k=Object(a.useMemo)((()=>{if(!1===x){const e=null==j?void 0:j.hits.hits[0];if(!e)return;const{_id:t,_index:n,_source:a}=e;return{...a,_id:t,_index:n}}}),[null==j?void 0:j.hits.hits,x]),I=Object(a.useMemo)((()=>{var e,t,a;return null!=k&&null!=(null===(e=k["kibana.alert.rule.parameters"])||void 0===e?void 0:e.index)?Array.isArray(k["kibana.alert.rule.parameters"].index)?k["kibana.alert.rule.parameters"].index:[k["kibana.alert.rule.parameters"].index]:null!=k&&null!=(null==k||null===(t=k.signal)||void 0===t||null===(a=t.rule)||void 0===a?void 0:a.index)?Array.isArray(k.signal.rule.index)?k.signal.rule.index:[k.signal.rule.index]:n}),[k,n]),T=Object(a.useMemo)((()=>{var e;return null!=k&&null!=(null===(e=k["kibana.alert.rule.parameters"])||void 0===e?void 0:e.data_view_id)?k["kibana.alert.rule.parameters"].data_view_id:i}),[k,i]),C=Object(a.useMemo)((()=>h?[h]:null),[h]),M=null==k||null===(f=k["kibana.alert.rule.parameters"])||void 0===f?void 0:f.type,_=x&&g||null==k||!("esql"===M||"machine_learning"===M)&&null==I&&null==T;return _||v?null:r.a.createElement(E.a,{rules:C,isEndpointItem:s===l.a.ENDPOINT,alertData:k,isAlertDataLoading:_||v,alertStatus:m,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:u,onConfirm:p})}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(7),r=n(2),i=n.n(r),o=n(188),s=n.n(o),l=n(11),c=n(70),u=n(12),d=n(118);const p=e=>"esql"in e?{query:e.esql,language:"esql"}:e,m=e=>null!=e&&"object"==typeof e&&Object.hasOwn(e,"getName"),f=Object(r.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:o,isLoading:f=!1,isRefreshPaused:g,filterQuery:b,filterManager:y,filters:h,onChangedQuery:v,onSubmitQuery:E,refreshInterval:x,savedQuery:j,onSavedQuery:O,dataTestSubj:S,displayStyle:w,isDisabled:k})=>{const{data:I}=Object(d.j)().services,[T,C]=Object(r.useState)(),M=Object(r.useCallback)((e=>{if(null!=e.query&&!s()(e.query,b)){const t=p(e.query);E(t)}}),[b,E]),_=Object(r.useCallback)((e=>{if(v&&null!=e.query&&!s()(e.query,b)){const t=p(e.query);v(t)}}),[b,v]),D=Object(r.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;E(t,a),y.setFilters(n||[]),O(e)}),[y,E,O]),N=Object(r.useCallback)((()=>{null!=j&&(E({query:"",language:j.attributes.query.language}),y.setFilters([]),O(void 0))}),[y,E,O,j]),A=Object(r.useCallback)((e=>{y.setFilters(e)}),[y]),F="esql"===(null==b?void 0:b.language),P=Object(r.useMemo)((()=>F&&"string"==typeof b.query?{esql:b.query}:b),[b,F]);Object(r.useEffect)((()=>{let e;return m(o)?C(o):F||(async()=>{e=await I.dataViews.create({id:o.title,title:o.title}),C(e)})(),()=>{var t,n;null!==(t=e)&&void 0!==t&&t.id&&I.dataViews.clearInstanceCache(null===(n=e)||void 0===n?void 0:n.id)}}),[I.dataViews,o,F]);const R=Object(r.useMemo)((()=>{if(m(o)||F)return h;const e=Object(a.cloneDeep)(h);return e.forEach((e=>e.meta.index=o.title)),e}),[h,o,F]),L=Object(r.useMemo)((()=>new l.TimeHistory(new u.Storage(localStorage))),[]),q=Object(r.useMemo)((()=>null!=T?[T]:[]),[T]);return i.a.createElement(c.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:R,indexPatterns:q,isLoading:f,isRefreshPaused:g,query:P,onClearSavedQuery:N,onFiltersUpdated:A,onQueryChange:_,onQuerySubmit:M,onSaved:O,onSavedQueryUpdated:D,refreshInterval:x,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:L,dataTestSubj:S,savedQuery:j,displayStyle:w,isDisabled:k})}));f.displayName="QueryBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(118),i=n(122);const o=()=>{const{uiSettings:e}=Object(r.j)().services,t=null==e?void 0:e.get("enableESQL"),n=Object(i.a)("timelineEsqlTabDisabled"),o=!Object(i.a)("esqlRulesDisabled")&&t;return Object(a.useMemo)((()=>({isEsqlAdvancedSettingEnabled:t,isEsqlRuleTypeEnabled:o,isTimelineEsqlEnabledByFeatureFlag:!n})),[t,n,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n.n(a),i=n(65),o=n(36),s=n(170),l=n(305);const c=()=>document.querySelector('[tour-step="create-case-submit"]'),u=()=>{const[e,t]=Object(a.useState)(s.a.createCase),n=Object(a.useCallback)((()=>{var e;null===(e=c())||void 0===e||e.scrollIntoView()}),[]),i=Object(a.useCallback)((()=>{t(s.a.submitCase),n(),setTimeout((()=>{var e;null===(e=c())||void 0===e||e.focus()}),500)}),[n]);return r.a.createElement(r.a.Fragment,null,e===s.a.createCase&&r.a.createElement(l.a,{onClick:i,step:s.a.createCase,tourId:s.b.alertsCases}),e===s.a.submitCase&&r.a.createElement(l.a,{step:s.a.submitCase,tourId:s.b.alertsCases}))};var d=n(256),p=n(118),m=n(172);const f=({onMenuItemClick:e,ariaLabel:t,ecsData:n,nonEcsData:l,onSuccess:c,isActiveTimelines:f,isInDetections:g,refetch:b})=>{const{cases:y}=Object(p.j)().services,h=y.helpers.canUseCases([o.APP_ID]),v=Object(a.useMemo)((()=>{var e,t;return null==n||null===(e=n.event)||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.includes("signal")}),[n]),E=Object(a.useMemo)((()=>{var e,t;return null!=n&&n._id?[{alertId:null!==(e=null==n?void 0:n._id)&&void 0!==e?e:"",index:null!==(t=null==n?void 0:n._index)&&void 0!==t?t:"",type:i.AttachmentType.alert,rule:y.helpers.getRuleIdFromEvent({ecs:n,data:null!=l?l:[]})}]:[]}),[y.helpers,n,l]),{activeStep:x,incrementStep:j,setStep:O,isTourShown:S}=Object(d.b)(),w=Object(a.useCallback)((()=>{c&&c(),b&&b()}),[c,b]),k=Object(a.useCallback)((async()=>{S(s.b.alertsCases)&&O(s.b.alertsCases,s.a.viewCase)}),[O,S]),I=Object(a.useMemo)((()=>!S(s.b.alertsCases)||x!==s.a.addAlertToCase&&x!==s.a.createCase&&x!==s.a.submitCase?{}:{initialValue:s.f}),[x,S]),T=Object(a.useMemo)((()=>({onClose:e,onSuccess:w,afterCaseCreated:k,...I})),[e,w,k,I]),C=y.hooks.useCasesAddToNewCaseFlyout(T),M=Object(a.useMemo)((()=>({onClose:e,onSuccess:w})),[e,w]),_=y.hooks.useCasesAddToExistingCaseModal(M),D=Object(a.useCallback)((()=>{e(),C.open({attachments:E,...S(s.b.alertsCases)?{headerContent:r.a.createElement(u,null)}:{}}),S(s.b.alertsCases)&&x===s.a.addAlertToCase&&j(s.b.alertsCases)}),[e,C,E,S,x,j]),N=Object(a.useCallback)((()=>{e(),_.open({getAttachments:()=>E})}),[E,e,_]);return{addToCaseActionItems:Object(a.useMemo)((()=>(f||g)&&h.create&&h.read&&v?[{"aria-label":t,"data-test-subj":"add-to-existing-case-action",key:"add-to-existing-case-action",onClick:N,size:"s",name:m.k},{"aria-label":t,"data-test-subj":"add-to-new-case-action",key:"add-to-new-case-action",onClick:D,size:"s",name:m.l}]:[]),[t,N,D,h.create,h.read,g,f,v]),handleAddToNewCaseClick:D,handleAddToExistingCaseClick:N}}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var a=void 0;t.setEuiDevProviderWarning=function(e){return a=e},t.getEuiDevProviderWarning=function(){return a},t.emitEuiProviderWarning=function(e){if("function"==typeof a)return a(e);switch(a){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return a.useMemo((function(){return e.apply(void 0,t)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.createContext(void 0);return[function(){var e=a.useContext(n);if(null==e)throw new Error("useReducerContext must be used inside a ReducerProvider.");return e},function(r){var i=r.children,o=r.initialState;return function(e,t){return a.createElement(n.Provider,e,t)}({value:a.useReducer(e,void 0!==o?o:t)},i)},n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(326));t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=(n=e,function(e,t){return n.reduceRight((function(t,n){return n(e)(t)}),t)});return function(e,t,n){void 0===n&&(n=function(e){return e});var o=r.useRef(n(t)),s=r.useState(o.current)[1],l=r.useCallback((function(t){return o.current=e(o.current,t),s(o.current),t}),[e]),c=r.useRef(a({getState:function(){return o.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.current.apply(c,e)}},l));return i.default((function(){c.current=a({getState:function(){return o.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.current.apply(c,e)}},l)}),[l]),[o.current,c.current]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.createContext(void 0);return[function(){var e=a.useContext(t);if(null==e)throw new Error("useStateContext must be used inside a StateProvider.");return e},function(n){var r=n.children,i=n.initialValue;return function(e,n){return a.createElement(t.Provider,e,n)}({value:a.useState(void 0!==i?i:e)},r)},t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(445));t.default=function(e,t){void 0===t&&(t=[]);var n=r.useState(0),o=n[0],s=n[1],l=i.default(e,a.__spreadArrays(t,[o])),c=l.loading,u=r.useCallback((function(){c||s((function(e){return e+1}))}),a.__spreadArrays(t,[c]));return a.__assign(a.__assign({},l),{retry:u})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(635)).default("audio");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i="object"==typeof navigator?navigator:void 0,o=i&&"function"==typeof i.getBattery;t.default=o?function(){var e=a.useState({isSupported:!0,fetched:!1}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,a=null,o=function(){if(e&&a){var i={isSupported:!0,fetched:!0,level:a.level,charging:a.charging,dischargingTime:a.dischargingTime,chargingTime:a.chargingTime};!r.isDeepEqual(t,i)&&n(i)}};return i.getBattery().then((function(t){e&&(a=t,r.on(a,"chargingchange",o),r.on(a,"chargingtimechange",o),r.on(a,"dischargingtimechange",o),r.on(a,"levelchange",o),o())})),function(){e=!1,a&&(r.off(a,"chargingchange",o),r.off(a,"chargingtimechange",o),r.off(a,"dischargingtimechange",o),r.off(a,"levelchange",o))}}),[]),t}:function(){return{isSupported:!1}}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,r,i;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(r=a;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=a;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,i[r]))return!1;for(r=a;0!=r--;){var o=i[r];if(!("_owner"===o&&t.$$typeof||e(t[o],n[o])))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===e&&(e=!0);var n=a.useCallback((function(n){if("function"!=typeof e||e())return n.preventDefault(),t&&(n.returnValue=t),t}),[e,t]);a.useEffect((function(){if(e)return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}),[e,n])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(636));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i=["mousedown","touchstart"];t.default=function(e,t,n){void 0===n&&(n=i);var o=a.useRef(t);a.useEffect((function(){o.current=t}),[t]),a.useEffect((function(){for(var t=function(t){var n=e.current;n&&!n.contains(t.target)&&o.current(t)},a=0,i=n;a<i.length;a++){var s=i[a];r.on(document,s,t)}return function(){for(var e=0,a=n;e<a.length;e++){var i=a[e];r.off(document,i,t)}}}),[n,e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(998));t.default=function(e){var t=r.useState((function(){return i.default.get(e)||null})),n=t[0],a=t[1];return[n,r.useCallback((function(t,n){i.default.set(e,t,n),a(t)}),[e]),r.useCallback((function(){i.default.remove(e),a(null)}),[e])]}},function(e,t,n){var a,r,i;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(a){function r(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},r.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var o=JSON.stringify(n);/^[\{\[]/.test(o)&&(n=o)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var l in i)i[l]&&(s+="; "+l,!0!==i[l]&&(s+="="+i[l].split(";")[0]));return document.cookie=t+"="+n+s}}function o(e,n){if("undefined"!=typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],o=0;o<i.length;o++){var s=i[o].split("="),l=s.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(s[0]);if(l=(a.read||a)(l,c)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(r[c]=l,e===c)break}catch(e){}}return e?r[e]:r}}return r.set=i,r.get=function(e){return o(e,!1)},r.getJSON=function(e){return o(e,!0)},r.remove=function(t,n){i(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))},void 0===(r="function"==typeof(a=i)?a.call(t,n,t,e):a)||(e.exports=r),e.exports=i()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importDefault(n(576)),i=n(2),o=a.__importDefault(n(251)),s=a.__importDefault(n(327));t.default=function(){var e=o.default(),t=s.default({value:void 0,error:void 0,noUserInteraction:!0}),n=t[0],a=t[1];return[n,i.useCallback((function(t){var n,i;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var o=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void a({value:t,error:o,noUserInteraction:!0})}if(""===t)return o=new Error("Cannot copy empty string to clipboard."),void a({value:t,error:o,noUserInteraction:!0});i=t.toString(),n=r.default(i),a({value:i,error:void 0,noUserInteraction:n})}catch(o){a({value:i,error:o,noUserInteraction:n})}}),[])]}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(1002),i=n(1003),o=n(1004),s=n(1006),l=n(2),c=a.__importDefault(n(37)),u=r.create();i.addon(u),o.addon(u);var d=0;t.default=function(e){var t=l.useMemo((function(){return"react-use-css-"+(d++).toString(36)}),[]),n=l.useMemo((function(){return new u.VSheet}),[]);return c.default((function(){var a={};return s.cssToTree(a,e,"."+t,""),n.diff(a),function(){n.diff({})}})),t}},function(e,t,n){"use strict";var a=/[A-Z]/g;t.create=function(e){var t=(e=e||{}).assign||Object.assign,n=t({raw:"",pfx:"_",client:"object"==typeof window,assign:t,stringify:JSON.stringify,kebab:function(e){return e.replace(a,"-$&").toLowerCase()},decl:function(e,t){return(e=n.kebab(e))+":"+t+";"},hash:function(e){return function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return"_"+(t>>>0).toString(36)}(n.stringify(e))},selector:function(e,t){return e+(":"===t[0]?"":" ")+t},putRaw:function(e){n.raw+=e}},e);return n.client&&(n.sh||document.head.appendChild(n.sh=document.createElement("style")),n.putRaw=function(e){var t=n.sh.sheet;try{t.insertRule(e,t.cssRules.length)}catch(e){}}),n.put=function(e,t,a){var r,i,o="",s=[];for(r in t)(i=t[r])instanceof Object&&!(i instanceof Array)?s.push(r):o+=n.decl(r,i,e,a);o&&(o=e+"{"+o+"}",n.putRaw(a?a+"{"+o+"}":o));for(var l=0;l<s.length;l++)"@"===(r=s[l])[0]&&"@font-face"!==r?n.putAt(e,t[r],r):n.put(n.selector(e,r),t[r],a)},n.putAt=n.put,n}},function(e,t,n){"use strict";t.addon=function(e){e.client&&(document.head.appendChild(e.msh=document.createElement("style")),e.createRule=function(t,n){var a=t+"{}";n&&(a=n+"{"+a+"}");var r=n?e.msh.sheet:e.sh.sheet,i=r.insertRule(a,r.cssRules.length),o=(r.cssRules||r.rules)[i];if(o.index=i,n){var s=(o.cssRules||o.rules)[0];o.style=s.style,o.styleMap=s.styleMap}return o})}},function(e,t,n){"use strict";var a=n(1005).removeRule;t.addon=function(e){if(e.client){var t=e.kebab;n.prototype.diff=function(e){var n,a=this.decl,r=this.rule.style;for(n in a)void 0===e[n]&&r.removeProperty(n);for(n in e)e[n]!==a[n]&&r.setProperty(t(n),e[n]);this.decl=e},n.prototype.del=function(){a(this.rule)},r.prototype.diff=function(e){var t=this.tree;for(var a in t)if(void 0===e[a]){var r=t[a];for(var i in r)r[i].del()}for(var a in e)if(void 0===t[a])for(var i in e[a])(l=new n(i,a)).diff(e[a][i]),e[a][i]=l;else{var o=t[a],s=e[a];for(var i in o)s[i]||o[i].del();for(var i in s){var l;(l=o[i])?(l.diff(s[i]),s[i]=l):((l=new n(i,a)).diff(s[i]),s[i]=l)}}this.tree=e},e.VRule=n,e.VSheet=r}function n(t,n){this.rule=e.createRule(t,n),this.decl={}}function r(){this.tree={}}}},function(e,t){t.removeRule=function(e){var t=e.index,n=e.parentStyleSheet,a=n.cssRules||n.rules;for(t=Math.max(t,a.length-1);t>=0;){if(a[t]===e){n.deleteRule(t);break}t--}}},function(e,t){t.cssToTree=function e(t,n,a,r){var i,o,s={},l=!1;for(i in n)"object"!=typeof(o=n[i])&&(l=!0,s[i]=o);for(i in l&&(t[r]||(t[r]={}),t[r][a]=s),n)if("object"==typeof(o=n[i]))if("@"===i[0])e(t,o,a,i);else{var c=i.indexOf("&")>-1,u=a.split(",");if(c)for(var d=0;d<u.length;d++)u[d]=i.replace(/&/g,u[d]);else for(d=0;d<u.length;d++)u[d]=u[d]+" "+i;e(t,o,u.join(","),r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(t),r=n[0],i=n[1];return null==r?[e,i]:[r,i]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=function(){};t.default=function(e,t){void 0===e&&(e={}),void 0===t&&(t=[]);var n=e.onFiles,o=e.onText,s=e.onUri,l=r.useState(!1),c=l[0],u=l[1],d=r.useCallback(u,[]),p=r.useMemo((function(){return function(e){return function(t,n){var a=t.getData("text/uri-list");if(a)(e.onUri||i)(a,n);else if(t.files&&t.files.length)(e.onFiles||i)(Array.from(t.files),n);else if(n.clipboardData){var r=n.clipboardData.getData("text");(e.onText||i)(r,n)}}}(e)}),[n,o,s]);return r.useEffect((function(){var e=function(e){e.preventDefault(),d(!0)},t=function(e){e.preventDefault(),d(!0)},n=function(){d(!1)},a=function(){d(!1)},r=function(e){e.preventDefault(),d(!1),p(e.dataTransfer,e)},i=function(e){p(e.clipboardData,e)};return document.addEventListener("dragover",e),document.addEventListener("dragenter",t),document.addEventListener("dragleave",n),document.addEventListener("dragexit",a),document.addEventListener("drop",r),o&&document.addEventListener("paste",i),function(){document.removeEventListener("dragover",e),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",n),document.removeEventListener("dragexit",a),document.removeEventListener("drop",r),document.removeEventListener("paste",i)}}),a.__spreadArrays([p],t)),{over:c}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(251)),o=function(){};t.default=function(e){void 0===e&&(e={});var t=e.onFiles,n=e.onText,a=e.onUri,s=i.default(),l=r.useState(!1),c=l[0],u=l[1],d=r.useMemo((function(){return function(e,t){return function(n,a){var r=n.getData("text/uri-list");r?(e.onUri||o)(r,a):n.files&&n.files.length?(e.onFiles||o)(Array.from(n.files),a):n.items&&n.items.length&&n.items[0].getAsString((function(n){t&&(e.onText||o)(n,a)}))}}(e,s())}),[t,n,a]),p=r.useMemo((function(){return function(e,t){return{onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault(),t(!0)},onDragLeave:function(){t(!1)},onDrop:function(n){n.preventDefault(),n.persist(),t(!1),e(n.dataTransfer,n)},onPaste:function(t){t.persist(),e(t.clipboardData,t)}}}(d,u)}),[d,u]);return[p,{over:c}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredForwardRef=void 0;var a=n(2);function r(e){var t=a.useRef(e&&e.current);return a.useEffect((function(){e&&(e.current=t.current)}),[e]),t}t.default=r,t.ensuredForwardRef=function(e){return a.forwardRef((function(t,n){var a=r(n);return e(t,a)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(null),t=e[0],n=e[1];return a.useEffect((function(){if(t)throw t}),[t]),a.useCallback((function(e){n(e)}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect((function(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(1014)),o=a.__importDefault(n(37)),s=function(){};t.default=function(e,t,n){void 0===n&&(n={});var a=n.video,l=n.onClose,c=void 0===l?s:l,u=r.useState(t),d=u[0],p=u[1];return o.default((function(){if(t&&e.current){var n=function(){a.current.removeEventListener("webkitendfullscreen",n),c()},r=function(){if(i.default.isEnabled){var e=i.default.isFullscreen;p(e),e||c()}};if(i.default.isEnabled){try{i.default.request(e.current),p(!0)}catch(e){c(e),p(!1)}i.default.on("change",r)}else a&&a.current&&a.current.webkitEnterFullscreen?(a.current.webkitEnterFullscreen(),a.current.addEventListener("webkitendfullscreen",n),p(!0)):(c(),p(!1));return function(){if(p(!1),i.default.isEnabled)try{i.default.off("change",r),i.default.exit()}catch(e){}else a&&a.current&&a.current.webkitExitFullscreen&&(a.current.removeEventListener("webkitendfullscreen",n),a.current.webkitExitFullscreen())}}}),[t,a,e]),d}},function(e,t,n){
/*!
* screenfull
* v5.0.0 - 2019-09-09
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,a=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,r=n.length,i={};a<r;a++)if((e=n[a])&&e[1]in t){for(a=0;a<e.length;a++)i[n[0][a]]=e[a];return i}return!1}(),r={change:a.fullscreenchange,error:a.fullscreenerror},i={request:function(e){return new Promise(function(n,r){var i=function(){this.off("change",i),n()}.bind(this);this.on("change",i),e=e||t.documentElement,Promise.resolve(e[a.requestFullscreen]()).catch(r)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var r=function(){this.off("change",r),e()}.bind(this);this.on("change",r),Promise.resolve(t[a.exitFullscreen]()).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var a=r[e];a&&t.addEventListener(a,n,!1)},off:function(e,n){var a=r[e];a&&t.removeEventListener(a,n,!1)},raw:a};a?(Object.defineProperties(i,{isFullscreen:{get:function(){return Boolean(t[a.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[a.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[a.fullscreenEnabled])}}}),n?e.exports=i:window.screenfull=i):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2);t.default=function(e){var t,n=r.useState({loading:!0,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),i=n[0],o=n[1],s=!0,l=function(e){s&&o({loading:!1,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})},c=function(e){return s&&o((function(t){return a.__assign(a.__assign({},t),{loading:!1,error:e})}))};return r.useEffect((function(){return navigator.geolocation.getCurrentPosition(l,c,e),t=navigator.geolocation.watchPosition(l,c,e),function(){s=!1,navigator.geolocation.clearWatch(t)}}),[]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(280));t.default=function(e){void 0===e&&(e={});var t=i.default(),n=r.useRef(a.__assign({},e));return[r.useCallback((function(){return n.current}),[]),r.useCallback((function(e){e&&(Object.assign(n.current,e),t())}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(1018);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=r.setHarmonicInterval((function(){return n.current()}),t);return function(){return r.clearHarmonicInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,r={};t.clearHarmonicInterval=function(e){var t=e.bucket,n=e.id;delete t.listeners[n];var a=!1;for(var i in t.listeners){a=!0;break}a||(clearInterval(t.timer),delete r[t.ms])},t.setHarmonicInterval=function(e,t){var n,i=a++;if(r[t])r[t].listeners[i]=e;else{var o=setInterval((function(){for(var e,n=r[t].listeners,a=!1,i=0,o=Object.values(n);i<o.length;i++){var s=o[i];try{s()}catch(t){a=!0,e=t}}if(a)throw e}),t);r[t]={ms:t,timer:o,listeners:(n={},n[i]=e,n)}}return{bucket:r[t],id:i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importStar(n(2)),r=a.useState,i=function(){};t.default=function(e){var t,n,o=r(!1),s=o[0],l=o[1];return"function"==typeof e&&(e=e(s)),[a.cloneElement(e,{onMouseEnter:(n=e.props.onMouseEnter,function(e){(n||i)(e),l(!0)}),onMouseLeave:(t=e.props.onMouseLeave,function(e){(t||i)(e),l(!1)})}),s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(1021),i=n(154),o=["mousemove","mousedown","resize","keydown","touchstart","wheel"];t.default=function(e,t,n){void 0===e&&(e=6e4),void 0===t&&(t=!1),void 0===n&&(n=o);var s=a.useState(t),l=s[0],c=s[1];return a.useEffect((function(){for(var t,a=!0,o=l,s=function(e){a&&(o=e,c(e))},u=r.throttle(50,(function(){o&&s(!1),clearTimeout(t),t=setTimeout((function(){return s(!0)}),e)})),d=function(){document.hidden||u()},p=0;p<n.length;p++)i.on(window,n[p],u);return i.on(document,"visibilitychange",d),t=setTimeout((function(){return s(!0)}),e),function(){a=!1;for(var e=0;e<n.length;e++)i.off(window,n[e],u);i.off(document,"visibilitychange",d)}}),[e,n]),l}},function(e,t,n){"use strict";function a(e,t,n,a){var r,i=!1,o=0;function s(){r&&clearTimeout(r)}function l(){var l=this,c=Date.now()-o,u=arguments;function d(){o=Date.now(),n.apply(l,u)}i||(a&&!r&&d(),s(),void 0===a&&c>e?d():!0!==t&&(r=setTimeout(a?function(){r=void 0}:d,void 0===a?e-c:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){s(),i=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=a,t.debounce=function(e,t,n){return void 0===n?a(e,t,!1):a(e,n,!1!==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(null),r=n[0],i=n[1];return a.useEffect((function(){if(e.current&&"function"==typeof IntersectionObserver){var n=new IntersectionObserver((function(e){i(e[0])}),t);return n.observe(e.current),function(){i(null),n.disconnect()}}return function(){}}),[e.current,t.threshold,t.root,t.rootMargin]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return void 0===e&&(e={laptopL:1440,laptop:1024,tablet:768}),function(){var t=a.useState(0),n=t[0],r=t[1];a.useEffect((function(){var e=function(){r(window.innerWidth)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var i=a.useMemo((function(){return Object.entries(e).sort((function(e,t){return e[1]>=t[1]?1:-1}))}),[e]),o=i.reduce((function(e,t){var a=t[0],r=t[1];return n>=r?a:e}),i[0][0]);return o}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importDefault(n(641)),i=a.__importDefault(n(326));t.default=function(e,t,n,a){void 0===a&&(a=r.default);var o=a(e),s=o[0],l=o[1];i.default((function(){!s&&n?n(l):s&&t&&t(l)}),[s])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i=function(e){var t=window.history,n=t[e];t[e]=function(t){var a=n.apply(this,arguments),r=new Event(e.toLowerCase());return r.state=t,window.dispatchEvent(r),a}};r.isClient&&(i("pushState"),i("replaceState"));var o=function(e){var t=window.history,n=t.state,a=t.length,r=window.location;return{trigger:e,state:n,length:a,hash:r.hash,host:r.host,hostname:r.hostname,href:r.href,origin:r.origin,pathname:r.pathname,port:r.port,protocol:r.protocol,search:r.search}},s="function"==typeof Event;t.default=r.isClient&&s?function(){var e=a.useState(o("load")),t=e[0],n=e[1];return a.useEffect((function(){var e=function(){return n(o("popstate"))},t=function(){return n(o("pushstate"))},a=function(){return n(o("replacestate"))};return r.on(window,"popstate",e),r.on(window,"pushstate",t),r.on(window,"replacestate",a),function(){r.off(window,"popstate",e),r.off(window,"pushstate",t),r.off(window,"replacestate",a)}}),[]),t}:function(){return{trigger:"load",length:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestBody=void 0;var a=n(2);function r(e){if(!e)return null;if("BODY"===e.tagName)return e;if("IFRAME"===e.tagName){var t=e.contentDocument;return t?t.body:null}return e.offsetParent?r(e.offsetParent):null}function i(e){var t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)}t.getClosestBody=r;var o="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),s=new Map,l="object"==typeof document?document:void 0,c=!1;t.default=l?function(e,t){void 0===e&&(e=!0);var n=a.useRef(l.body);t=t||n;var u=function(e){var t=s.get(e);t&&(1===t.counter?(s.delete(e),o?(e.ontouchmove=null,c&&(document.removeEventListener("touchmove",i),c=!1)):e.style.overflow=t.initialOverflow):s.set(e,{counter:t.counter-1,initialOverflow:t.initialOverflow}))};a.useEffect((function(){var n=r(t.current);n&&(e?function(e){var t=s.get(e);t?s.set(e,{counter:t.counter+1,initialOverflow:t.initialOverflow}):(s.set(e,{counter:1,initialOverflow:e.style.overflow}),o?c||(document.addEventListener("touchmove",i,{passive:!1}),c=!0):e.style.overflow="hidden")}(n):u(n))}),[e,t.current]),a.useEffect((function(){var e=r(t.current);if(e)return function(){u(e)}}),[])}:function(e,t){void 0===e&&(e=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importDefault(n(328)),i=a.__importDefault(n(326));t.default=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];r.default((function(){return console.log.apply(console,a.__spreadArrays([e+" mounted"],t)),function(){return console.log(e+" unmounted")}})),i.default((function(){console.log.apply(console,a.__spreadArrays([e+" updated"],t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};t.default=function(e,t){var n=void 0===t?{}:t,i=n.isPreventDefault,o=void 0===i||i,s=n.delay,l=void 0===s?300:s,c=a.useRef(),u=a.useRef(),d=a.useCallback((function(t){o&&t.target&&(t.target.addEventListener("touchend",r,{passive:!1}),u.current=t.target),c.current=setTimeout((function(){return e(t)}),l)}),[e,l,o]),p=a.useCallback((function(){c.current&&clearTimeout(c.current),o&&u.current&&u.current.removeEventListener("touchend",r)}),[o]);return{onMouseDown:function(e){return d(e)},onTouchStart:function(e){return d(e)},onMouseUp:p,onMouseLeave:p,onTouchEnd:p}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154);t.default=function(e,t){void 0===t&&(t=!1);var n=a.useState(r.isClient?function(){return window.matchMedia(e).matches}:t),i=n[0],o=n[1];return a.useEffect((function(){var t=!0,n=window.matchMedia(e),a=function(){t&&o(!!n.matches)};return n.addListener(a),o(n.matches),function(){t=!1,n.removeListener(a)}}),[e]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i=function(){};t.default="object"==typeof navigator&&navigator.mediaDevices?function(){var e=a.useState({}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,t=function(){navigator.mediaDevices.enumerateDevices().then((function(t){e&&n({devices:t.map((function(e){return{deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label}}))})})).catch(i)};return r.on(navigator.mediaDevices,"devicechange",t),t(),function(){e=!1,r.off(navigator.mediaDevices,"devicechange",t)}}),[]),t}:function(){return{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMediatedState=void 0;var a=n(2);t.useMediatedState=function(e,t){var n=a.useRef(e),r=a.useState(t),i=r[0],o=r[1];return[i,a.useCallback((function(e){2===n.current.length?n.current(e,o):o(n.current(e))}),[i])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useMemo((function(){return function(t,n){var a;return(a=e(t))[n.type].apply(a,n.payload)}}),[e]),r=a.useReducer(n,t),i=r[0],o=r[1],s=a.useMemo((function(){return Object.keys(e(t)).reduce((function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o({type:t,payload:e})},e}),{})}),[e,t]);return[i,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i={acceleration:{x:null,y:null,z:null},accelerationIncludingGravity:{x:null,y:null,z:null},rotationRate:{alpha:null,beta:null,gamma:null},interval:16};t.default=function(e){void 0===e&&(e=i);var t=a.useState(e),n=t[0],o=t[1];return a.useEffect((function(){var e=function(e){var t=e.acceleration,n=e.accelerationIncludingGravity,a=e.rotationRate,r=e.interval;o({acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:n.x,y:n.y,z:n.z},rotationRate:{alpha:a.alpha,beta:a.beta,gamma:a.gamma},interval:r})};return r.on(window,"devicemotion",e),function(){r.off(window,"devicemotion",e)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importDefault(n(639)),i=a.__importDefault(n(647)),o={current:null};t.default=function(e,t){void 0===t&&(t={});var n=!!t.whenHovered,a=!!t.bound,s=r.default(e,n),l=i.default(n&&!s?o:e);return a&&(l.elX=Math.max(0,Math.min(l.elX,l.elW)),l.elY=Math.max(0,Math.min(l.elY,l.elH))),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(0),t=e[0],n=e[1];return a.useEffect((function(){var e=function(e){n(e.deltaY+t)};return window.addEventListener("wheel",e,!1),function(){return window.removeEventListener("wheel",e)}})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=n(154),o=function(){if("object"!=typeof navigator)return null;var e=navigator;return e.connection||e.mozConnection||e.webkitConnection},s=function(){var e=o();return e?{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,type:e.type,rtt:e.rtt}:{}};t.default=function(e){void 0===e&&(e={});var t=r.useState(e),n=t[0],l=t[1];return r.useEffect((function(){var e=n,t=function(t){e=a.__assign(a.__assign({},e),t),l(e)},r=o(),c=function(){t({online:!0,since:new Date})},u=function(){t({online:!1,since:new Date})},d=function(){t(s())};return i.on(window,"online",c),i.on(window,"offline",u),r&&(i.on(r,"change",d),t(a.__assign(a.__assign(a.__assign({},n),{online:navigator.onLine,since:void 0}),s()))),function(){i.off(window,"online",c),i.off(window,"offline",u),r&&i.off(r,"change",d)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(637));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i={angle:0,type:"landscape-primary"};t.default=function(e){void 0===e&&(e=i);var t=window.screen,n=a.useState(e),o=n[0],s=n[1];return a.useEffect((function(){var n=!0,a=function(){if(n){var a=t.orientation;if(a){var r=a.angle,i=a.type;s({angle:r,type:i})}else window.orientation?s({angle:"number"==typeof window.orientation?window.orientation:0,type:""}):s(e)}};return r.on(window,"orientationchange",a),a(),function(){n=!1,r.off(window,"orientationchange",a)}}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=[]),a.useEffect((function(){if(e){var t=function(t){var n=(t=t||window.event).relatedTarget||t.toElement;n&&"HTML"!==n.nodeName||e()};return document.addEventListener("mouseout",t),function(){document.removeEventListener("mouseout",t)}}}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(154),i=function(){};t.default=function(e){var t=!0,n=null,o=a.useState(""),s=o[0],l=o[1],c=function(){t&&n&&l(n.state)};return a.useEffect((function(){return navigator.permissions.query(e).then((function(e){n=e,c(),r.on(n,"change",c)})).catch(i),function(){t=!1,n&&r.off(n,"change",c)}}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(371),i=function(e,t){return e===t};t.default=function(e,t){void 0===t&&(t=i);var n=a.useRef(),o=a.useRef(e);return r.useFirstMountState()||t(o.current,e)||(n.current=o.current,o.current=e),n.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(251));t.default=function(){var e=i.default();return r.useCallback((function(t){return new Promise((function(n,a){t.then((function(t){e()&&n(t)}),(function(t){e()&&a(t)}))}))}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2);t.default=function(e){void 0===e&&(e=[]);var t=r.useState(e),n=t[0],i=t[1];return{add:function(e){i((function(t){return a.__spreadArrays(t,[e])}))},remove:function(){var e;return i((function(t){var n=t[0],a=t.slice(1);return e=n,a})),e},get first(){return n[0]},get last(){return n[n.length-1]},get size(){return n.length}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useRef(null),r=a.useRef(!1),i=a.useRef(e);i.current=e;var o=a.useCallback((function(e){r.current&&(i.current(e),n.current=requestAnimationFrame(o))}),[]),s=a.useMemo((function(){return[function(){r.current&&(r.current=!1,n.current&&cancelAnimationFrame(n.current))},function(){r.current||(r.current=!0,n.current=requestAnimationFrame(o))},function(){return r.current}]}),[]);return a.useEffect((function(){return t&&s[1](),s[0]}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=function(e,t){return new URLSearchParams(e).get(t)};t.default="object"==typeof window?function(e){var t=window.location,n=a.useState((function(){return r(t.search,e)})),i=n[0],o=n[1];return a.useEffect((function(){var n=function(){o(r(t.search,e))};return window.addEventListener("popstate",n),window.addEventListener("pushstate",n),window.addEventListener("replacestate",n),function(){window.removeEventListener("popstate",n),window.removeEventListener("pushstate",n),window.removeEventListener("replacestate",n)}}),[]),i}:function(){return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScratchSensor=void 0;var a=n(34),r=n(2),i=n(1048),o=a.__importDefault(n(642)),s=function(){},l=function(e){void 0===e&&(e={});var t=e.disabled,n=o.default(e),i=r.useState({isScratching:!1}),l=i[0],c=i[1],u=r.useRef(l),d=r.useRef(!1),p=r.useRef(null),m=r.useState(null),f=m[0],g=m[1];return r.useEffect((function(){if(!t&&f){var e,r,i=function(e,t){cancelAnimationFrame(p.current),p.current=requestAnimationFrame((function(){var r=f.getBoundingClientRect(),i=r.left,o=r.top,l=i+window.scrollX,d=o+window.scrollY,p=e-l,m=t-d;c((function(e){var t=a.__assign(a.__assign({},e),{dx:p-(e.x||0),dy:m-(e.y||0),end:Date.now(),isScratching:!0});return u.current=t,(n.current.onScratch||s)(t),t}))}))},o=function(e){i(e.pageX,e.pageY)},l=function(e){i(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},m=function(){d.current&&(d.current=!1,u.current=a.__assign(a.__assign({},u.current),{isScratching:!1}),(n.current.onScratchEnd||s)(u.current),c({isScratching:!1}),window.removeEventListener("mousemove",o),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",r))};e=m,r=m;var g=function(t,a){if(d.current){var i=f.getBoundingClientRect(),p=i.left,m=i.top,g=p+window.scrollX,b=m+window.scrollY,y=t-g,h=a-b,v=Date.now(),E={isScratching:!0,start:v,end:v,docX:t,docY:a,x:y,y:h,dx:0,dy:0,elH:f.offsetHeight,elW:f.offsetWidth,elX:g,elY:b};u.current=E,(n.current.onScratchStart||s)(E),c(E),window.addEventListener("mousemove",o),window.addEventListener("touchmove",l),window.addEventListener("mouseup",e),window.addEventListener("touchend",r)}},b=function(e){d.current=!0,g(e.pageX,e.pageY)},y=function(e){d.current=!0,g(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return f.addEventListener("mousedown",b),f.addEventListener("touchstart",y),function(){f.removeEventListener("mousedown",b),f.removeEventListener("touchstart",y),window.removeEventListener("mousemove",o),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",r),p.current&&cancelAnimationFrame(p.current),p.current=null,d.current=!1,u.current={isScratching:!1},c(u.current)}}}),[f,t,n]),[g,l]};t.ScratchSensor=function(e){e.children;var t=a.__rest(e,["children"]),n=l(t),o=n[0],s=n[1],c=i.render(e,s);return r.cloneElement(c,a.__assign(a.__assign({},c.props),{ref:function(e){c.props.ref&&("object"==typeof c.props.ref&&(c.props.ref.current=e),"function"==typeof c.props.ref&&c.props.ref(e)),o(e)}}))},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hookToRenderProp=t.createEnhancer=t.render=void 0;var a=n(34),r=a.__importDefault(n(649));t.render=r.default;var i=a.__importDefault(n(1049));t.createEnhancer=i.default;var o=a.__importDefault(n(1052));t.hookToRenderProp=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divWrapper=void 0;var a=n(34),r=a.__importStar(n(2)),i=a.__importDefault(n(1050)),o=r.createElement,s=function(e,t,n,r){var i;return o(e,t?a.__assign(((i={})[t]=r,i),n):a.__assign(a.__assign({},r),n))};t.divWrapper=function(e,t,n,a){return o("div",null,s(e,t,n,a))},t.default=function(e,t,n){void 0===n&&(n=s);var a=function(r,s,l){void 0===s&&(s=t),void 0===l&&(l=null);var c="string"==typeof r;if(c)return function(e){return a(e,r||t,s)};var u=function(t){return o(e,l,(function(e){return n(r,s,t,e)}))};return c?i.default(u):u};return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(1051));t.default=function(e){return e.prototype?e:a.default(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importStar(n(2));t.default=function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(n,t),n.prototype.render=function(){return e(this.props,this.context)},n}(r.Component);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(649)),r=function(e){return[e]};t.default=function(e,t){return void 0===t&&(t=r),function(n){return a.default(n,e.apply(void 0,t(n)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(329));t.default=function(e){var t=i.default({x:0,y:0}),n=t[0],a=t[1];return r.useEffect((function(){var t=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&e.current.addEventListener("scroll",t,{capture:!1,passive:!0}),function(){e.current&&e.current.removeEventListener("scroll",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useState(!1),n=t[0],r=t[1];return a.useEffect((function(){if(e.current){var t,n=function(){r(!0),clearTimeout(t),t=setTimeout((function(){r(!1)}),150)};return e.current.addEventListener("scroll",n,!1),function(){e.current&&e.current.removeEventListener("scroll",n,!1)}}return function(){}}),[e]),n}},function(e,t){var n=Object.keys;t.equal=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var a=n(e),r=a.length,i=0;i<r;i++)if(!(a[i]in t))return!1;for(i=0;i<r;i++)if(e[a[i]]!==t[a[i]])return!1;return r===n(t).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importStar(n(2)),i=n(154),o=r.useState,s=r.useEffect,l=r.useRef;t.default=function(e,t){var n=void 0===t?{}:t,c=n.width,u=void 0===c?1/0:c,d=n.height,p=void 0===d?1/0:d;if(!i.isClient)return["function"==typeof e?e({width:u,height:p}):e,{width:u,height:p}];var m=o({width:u,height:p}),f=m[0],g=m[1];"function"==typeof e&&(e=e(f));var b=e.props.style||{},y=l(null),h=null,v=function(){var e=y.current,t=e?{width:e.offsetWidth,height:e.offsetHeight}:{width:u,height:p};g(t)},E=function(e){e.addEventListener("resize",v),setTimeout(v,35)};return s((function(){var e=y.current;if(e){if(e.contentWindow)h=e.contentWindow,E(h);else{var t=function(){e.removeEventListener("load",t),h=e.contentWindow,E(h)};e.addEventListener("load",t)}return function(){h&&h.removeEventListener&&h.removeEventListener("resize",v)}}}),[]),b.position="relative",[r.cloneElement.apply(r,a.__spreadArrays([e,{style:b}],a.__spreadArrays([r.createElement("iframe",{ref:y,style:{background:"transparent",border:"none",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:-1}})],r.Children.toArray(e.props.children)))),f]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=n(154),o=a.__importDefault(n(251)),s=a.__importDefault(n(327)),l=function(){};t.default=function(e,t){void 0===t&&(t={});var n=o.default(),a=r.useRef(!1),c=r.useRef(0),u=r.useRef(0),d=s.default({isSliding:!1,value:0}),p=d[0],m=d[1];return c.current=p.value,r.useEffect((function(){if(i.isClient){var r=void 0===t.styles||t.styles,o=void 0!==t.reverse&&t.reverse;e.current&&r&&(e.current.style.userSelect="none");var s=function(){!a.current&&n()&&((t.onScrubStart||l)(),a.current=!0,m({isSliding:!0}),y())},d=function(){a.current&&n()&&((t.onScrubStop||l)(c.current),a.current=!1,m({isSliding:!1}),h())},p=function(e){s(),f(e)},f=t.vertical?function(e){return v(e.clientY)}:function(e){return v(e.clientX)},g=function(e){s(),b(e)},b=t.vertical?function(e){return v(e.changedTouches[0].clientY)}:function(e){return v(e.changedTouches[0].clientX)},y=function(){i.on(document,"mousemove",f),i.on(document,"mouseup",d),i.on(document,"touchmove",b),i.on(document,"touchend",d)},h=function(){i.off(document,"mousemove",f),i.off(document,"mouseup",d),i.off(document,"touchmove",b),i.off(document,"touchend",d)},v=function(a){cancelAnimationFrame(u.current),u.current=requestAnimationFrame((function(){if(n()&&e.current){var r=e.current.getBoundingClientRect(),i=t.vertical?r.top:r.left,s=t.vertical?r.height:r.width;if(!s)return;var c=(a-i)/s;c>1?c=1:c<0&&(c=0),o&&(c=1-c),m({value:c}),(t.onScrub||l)(c)}}))};return i.on(e.current,"mousedown",p),i.on(e.current,"touchstart",g),function(){i.off(e.current,"mousedown",p),i.off(e.current,"touchstart",g)}}}),[e,t.vertical]),p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(646)),o=a.__importDefault(n(327)),s="object"==typeof window&&"object"==typeof window.speechSynthesis?window.speechSynthesis.getVoices():[];t.default=function(e,t){void 0===t&&(t={});var n=o.default({isPlaying:!1,lang:t.lang||"default",voice:t.voice||s[0],rate:t.rate||1,pitch:t.pitch||1,volume:t.volume||1}),a=n[0],l=n[1],c=r.useRef(null);return i.default((function(){var n=new SpeechSynthesisUtterance(e);t.lang&&(n.lang=t.lang),t.voice&&(n.voice=t.voice),n.rate=t.rate||1,n.pitch=t.pitch||1,n.volume=t.volume||1,n.onstart=function(){return l({isPlaying:!0})},n.onresume=function(){return l({isPlaying:!0})},n.onend=function(){return l({isPlaying:!1})},n.onpause=function(){return l({isPlaying:!1})},c.current=n,window.speechSynthesis.speak(c.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(37));t.default=function(e){a.default((function(){var t=function(t){var n,a,r,i,o;!function(){var e=document.activeElement,t=document.body;if(!e)return!1;if(e===t)return!1;switch(e.tagName){case"INPUT":case"TEXTAREA":return!0}return e.hasAttribute("contenteditable")}()&&(a=(n=t).keyCode,r=n.metaKey,i=n.ctrlKey,o=n.altKey,!(r||i||o)&&(a>=48&&a<=57||a>=65&&a<=90))&&e(t)};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithHistory=void 0;var a=n(2),r=n(371),i=n(372);t.useStateWithHistory=function(e,t,n){if(void 0===t&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var o=r.useFirstMountState(),s=a.useState(e),l=s[0],c=s[1],u=a.useRef(null!=n?n:[]),d=a.useRef(0);return o&&(u.current.length?(u.current[u.current.length-1]!==e&&u.current.push(e),u.current.length>t&&(u.current=u.current.slice(u.current.length-t))):u.current.push(e),d.current=u.current.length&&u.current.length-1),[l,a.useCallback((function(e){c((function(n){return(e=i.resolveHookState(e))!==n&&(d.current<u.current.length-1&&(u.current=u.current.slice(0,d.current+1)),d.current=u.current.push(e)-1,u.current.length>t&&(u.current=u.current.slice(u.current.length-t))),e}))}),[l,t]),a.useMemo((function(){return{history:u.current,position:d.current,capacity:t,back:function(e){void 0===e&&(e=1),d.current&&c((function(){return d.current-=Math.min(e,d.current),u.current[d.current]}))},forward:function(e){void 0===e&&(e=1),d.current!==u.current.length-1&&c((function(){return d.current=Math.min(d.current+e,u.current.length-1),u.current[d.current]}))},go:function(e){e!==d.current&&c((function(){return d.current=e<0?Math.max(u.current.length+e,0):Math.min(u.current.length-1,e),u.current[d.current]}))}}}),[l])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(251)),o=a.__importDefault(n(280)),s=a.__importDefault(n(326));t.default=function(e){void 0===e&&(e=[]);var t=i.default(),n=o.default(),l=r.useRef(0);s.default((function(){e.length<=l.current&&(l.current=e.length-1,n())}),[e.length]);var c=r.useMemo((function(){return{next:function(){return c.setStateAt(l.current+1)},prev:function(){return c.setStateAt(l.current-1)},setStateAt:function(a){t()&&e.length&&a!==l.current&&(l.current=a>=0?a%e.length:e.length+a%e.length,n())},setState:function(a){if(t()){var r=e.length?e.indexOf(a):-1;if(-1===r)throw new Error("State '"+a+"' is not a valid state (does not exist in state list)");l.current=r,n()}}}}),[e]);return a.__assign({state:e[l.current],currentIndex:l.current},c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(373));t.default=function(e,t){void 0===t&&(t=200);var n=r.useState(e),a=n[0],o=n[1],s=r.useRef(),l=r.useRef(null),c=r.useRef(0);return r.useEffect((function(){if(s.current)l.current=e,c.current=!0;else{o(e);var n=function(){c.current?(c.current=!1,o(l.current),s.current=setTimeout(n,t)):s.current=void 0};s.current=setTimeout(n,t)}}),[e]),i.default((function(){s.current&&clearTimeout(s.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(373));t.default=function(e,t,n){void 0===t&&(t=200);var a=r.useState(null),o=a[0],s=a[1],l=r.useRef(),c=r.useRef();return r.useEffect((function(){if(l.current)c.current=n;else{s(e.apply(void 0,n));var a=function(){c.current?(s(e.apply(void 0,c.current)),c.current=void 0,l.current=setTimeout(a,t)):l.current=void 0};l.current=setTimeout(a,t)}}),n),i.default((function(){l.current&&clearTimeout(l.current)})),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importDefault(n(462)),i=a.__importDefault(n(280));t.default=function(e){void 0===e&&(e=0);var t=i.default();return r.default(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r={restoreOnUnmount:!1};t.default="undefined"!=typeof document?function(e,t){void 0===t&&(t=r);var n=a.useRef(document.title);document.title=e,a.useEffect((function(){return t&&t.restoreOnUnmount?function(){document.title=n.current}:void 0}),[])}:function(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(1333),i=a.__importDefault(n(648));t.default=function(e,t,n){return void 0===e&&(e="inCirc"),void 0===t&&(t=200),void 0===n&&(n=0),(0,r.easing[e])(i.default(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1);return a.useEffect((function(){return function(){e.current=!0}})),a.useMemo((function(){return function(t,n){return new Promise((function(a,r){t.then((function(t){e.current||a(t)}),(function(t){e.current?n?n(t):console.error("useUnmountPromise",t):r(t)}))}))}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=a.__importDefault(n(644));t.default=function(e,t){void 0===t&&(t=[]);var n=r.default(t),i=n[0],o=n[1];return[i,a.__assign(a.__assign({},o),{upsert:function(t){o.upsert(e,t)}})]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r="object"==typeof navigator&&"vibrate"in navigator;t.default=r?function(e,t,n){void 0===e&&(e=!0),void 0===t&&(t=[1e3,1e3]),void 0===n&&(n=!0),a.useEffect((function(){var a;if(e&&(navigator.vibrate(t),n)){var r=t instanceof Array?t.reduce((function(e,t){return e+t})):t;a=setInterval((function(){navigator.vibrate(t)}),r)}return function(){e&&(navigator.vibrate(0),n&&clearInterval(a))}}),[e])}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(635)).default("video");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){void 0===n&&(n=[void 0]);var r=a.useRef(t),i=a.useRef(e);r.current=t,i.current=e;var o=a.useState(n),s=o[0],l=o[1],c=a.useCallback((function(){r.current.length>=2?r.current(i.current,l):l(r.current(i.current))}),[l]);return a.useEffect((function(){c()}),[e]),[s,c]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useScrollbarWidth=void 0;var a=n(1073),r=n(2);t.useScrollbarWidth=function(){var e=r.useState(a.scrollbarWidth()),t=e[0],n=e[1];return r.useEffect((function(){if(void 0===t){var e=requestAnimationFrame((function(){n(a.scrollbarWidth())}));return function(){return cancelAnimationFrame(e)}}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if("undefined"==typeof document)return 0;if(document.body&&(!document.readyState||"loading"!==document.readyState)){if(!0!==e&&"number"==typeof a.__cache)return a.__cache;var t=document.createElement("div"),n=t.style;n.display="block",n.position="absolute",n.width="100px",n.height="100px",n.left="-999px",n.top="-999px",n.overflow="scroll",document.body.insertBefore(t,null);var r=t.clientWidth;if(0!==r)return a.__cache=100-r,document.body.removeChild(t),a.__cache;document.body.removeChild(t)}};t.scrollbarWidth=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMultiStateValidator=void 0;var a=n(2);t.useMultiStateValidator=function(e,t,n){if(void 0===n&&(n=[void 0]),"object"!=typeof e)throw new Error("states expected to be an object or array, got "+typeof e);var r=a.useRef(t),i=a.useRef(e);r.current=t,i.current=e;var o=a.useState(n),s=o[0],l=o[1],c=a.useCallback((function(){r.current.length>=2?r.current(i.current,l):l(r.current(i.current))}),[l]);return a.useEffect((function(){c()}),Object.values(e)),[s,c]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=n(154),o=a.__importDefault(n(329));t.default=function(){var e=o.default({x:i.isClient?window.pageXOffset:0,y:i.isClient?window.pageYOffset:0}),t=e[0],n=e[1];return r.useEffect((function(){var e=function(){n({x:window.pageXOffset,y:window.pageYOffset})};return window.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){window.removeEventListener("scroll",e)}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(329)),o=n(154);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var n=i.default({width:o.isClient?window.innerWidth:e,height:o.isClient?window.innerHeight:t}),a=n[0],s=n[1];return r.useEffect((function(){if(o.isClient){var e=function(){s({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2),i=a.__importDefault(n(37)),o=n(154),s={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};t.default=o.isClient&&window.ResizeObserver?function(){var e=r.useState(null),t=e[0],n=e[1],a=r.useState(s),o=a[0],l=a[1],c=r.useMemo((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,a=t.y,r=t.width,i=t.height,o=t.top,s=t.left,c=t.bottom,u=t.right;l({x:n,y:a,width:r,height:i,top:o,left:s,bottom:c,right:u})}}))}),[]);return i.default((function(){if(t)return c.observe(t),function(){c.disconnect()}}),[t]),[n,o]}:function(){return[function(){},s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRendersCount=void 0;var a=n(2);t.useRendersCount=function(){return++a.useRef(0).current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),r=n(2);t.default=function(e){void 0===e&&(e=new Set);var t=r.useState(e),n=t[0],i=t[1],o=r.useMemo((function(){return{add:function(e){return i((function(t){return new Set(a.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return i((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return i((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(a.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return i(e)}}}),[i]),s=a.__assign({has:r.useCallback((function(e){return n.has(e)}),[n])},o);return[n,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGlobalState=void 0;var a=n(34),r=n(2),i=a.__importDefault(n(328)),o=a.__importDefault(n(37));function s(e){var t={state:e,setState:function(e){t.state=e,t.setters.forEach((function(e){return e(t.state)}))},setters:[]};return function(){var e=r.useState(t.state),n=e[0],a=e[1];return i.default((function(){return function(){t.setters=t.setters.filter((function(e){return e!==a}))}})),o.default((function(){t.setters.includes(a)||t.setters.push(a)})),[n,t.setState]}}t.createGlobalState=s,t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHash=void 0;var a=n(34),r=n(2),i=a.__importDefault(n(643));t.useHash=function(){var e=r.useState((function(){return window.location.hash})),t=e[0],n=e[1],a=r.useCallback((function(){n(window.location.hash)}),[]);i.default((function(){window.addEventListener("hashchange",a)}),(function(){window.removeEventListener("hashchange",a)}));var o=r.useCallback((function(e){e!==t&&(window.location.hash=e)}),[t]);return[t,o]}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(762);n(119),n(2),n(652),n(43),n(323),n(324),n(653);var r=a.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){r[e]=r(e)})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(515);function r(e){return e&&e.__esModule?e:{default:e}}var i=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,o=r(a).default((function(e){return i.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=o},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i="undefined"!=typeof document,o=!!r.useInsertionEffect&&r.useInsertionEffect,s=i&&o||function(e){return e()},l=o||r.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=s,t.useInsertionEffectWithLayoutFallback=l},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1089);case"v8light":return n(1091)}},function(e,t,n){var a=n(185),r=n(1090);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);a(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#2e2d25}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #343741}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#343741}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,n){var a=n(185),r=n(1092);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);a(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#fff9e8}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #d3dae6}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#e9edf3}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(233);function r(e,t,n,r,i,o,s){const l=null!=o?o:"html",c={hit:t,field:i,...s};return r&&i?r.getFormatterForField(i).convert(e,l,c):n.getDefaultInstance(a.b.STRING).convert(e,l,c)}},function(e,t,n){var a=n(185),r=n(1095);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);a(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,n){var a=n(185),r=n(1097);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);a(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={BULK_QUERY_STATUS_UPDATE:"Data table bulkQueryStatusUpdate",BULK_STATUS_UPDATE:"Data table bulkStatusUpdate",STATUS_UPDATE:"Data table statusUpdate"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(2),r=n.n(a),i=n(44),o=n(19),s=n(1301),l=n.n(s),c=n(1304),u=n(41);const d=n.n(u).a.span.withConfig({displayName:"FlagWrapper",componentId:"sc-pwsog3-0"})(["position:relative;top:1px;"]),p=e=>e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCharCode(55356,56741+e.charCodeAt(0)))):null,m=Object(a.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{Object(a.useEffect)((()=>{t&&Object(i.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c)}),[]);const n=p(e);return null!==n?t?r.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},r.a.createElement(d,{"data-test-subj":"country-flag"},n)):r.a.createElement(d,{"data-test-subj":"country-flag"},n):null}));m.displayName="CountryFlag";const f=Object(a.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{const[n,s]=Object(a.useState)(!1);Object(a.useEffect)((()=>{Object(i.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c),s(!0)}),[]);const u=p(e);return null!==u&&n?t?r.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},r.a.createElement(d,{"data-test-subj":"country-flag"},u)):r.a.createElement(r.a.Fragment,null,r.a.createElement(d,{"data-test-subj":"country-flag"},u),` ${l.a.getName(e,"en")}`):null}));f.displayName="CountryFlagAndName"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(140);const i=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&n.manage},o=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&n.read},s=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&(n.create||n.create_doc||n.index||n.write)},l=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:n}=Object(r.a)();return Object(a.useEffect)((()=>{if(null!=n.result){const{is_authenticated:e,lists:{index:a},listItems:{index:r}}=n.result;t({isAuthenticated:e,canReadIndex:o(a)&&o(r),canManageIndex:i(a)&&i(r),canWriteIndex:s(a)&&s(r)})}}),[n.result]),Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[n.error]),{loading:n.loading,...e}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var a=n(2),r=n.n(a),i=n(45),o=n(294),s=n(118),l=n(148),c=n(243),u=n(266),d=n(19),p=n(41),m=n.n(p),f=n(4);const g=f.i18n.translate("xpack.securitySolution.fieldBrowser.createFieldButton",{defaultMessage:"Create field"}),b=m()(d.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-1abg8tf-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),y=f.i18n.translate("xpack.securitySolution.fieldBrowser.fieldName",{defaultMessage:"Name"}),h=f.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionLabel",{defaultMessage:"Description"}),v=f.i18n.translate("xpack.securitySolution.fieldBrowser.categoryLabel",{defaultMessage:"Category"}),E=f.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeLabel",{defaultMessage:"Runtime"}),x=f.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeTitle",{defaultMessage:"Runtime Field"}),j=f.i18n.translate("xpack.securitySolution.fieldBrowser.actionsLabel",{defaultMessage:"Actions"}),O=f.i18n.translate("xpack.securitySolution.fieldBrowser.editButton",{defaultMessage:"Edit"}),S=f.i18n.translate("xpack.securitySolution.fieldBrowser.removeButton",{defaultMessage:"Remove"}),w=f.i18n.translate("xpack.securitySolution.fieldBrowser.editButtonDescription",{defaultMessage:"Edit runtime field"}),k=f.i18n.translate("xpack.securitySolution.fieldBrowser.removeButtonDescription",{defaultMessage:"Delete runtime field"});var I=n(284),T=n(130),C=n(424);const M=m()(d.EuiIcon).withConfig({displayName:"TypeIcon",componentId:"sc-1coc1q1-0"})(["margin:0 4px;position:relative;top:-1px;"]);M.displayName="TypeIcon";const _=m.a.span.withConfig({displayName:"Description",componentId:"sc-1coc1q1-1"})(["user-select:text;width:",";"],(({width:e})=>e));_.displayName="Description";const D=r.a.memo((({fieldId:e,highlight:t=""})=>r.a.createElement(d.EuiText,{size:"xs"},r.a.createElement(d.EuiHighlight,{"data-test-subj":`field-${e}-name`,search:t},e))));D.displayName="FieldName";var N=n(187),A=n(219);const F=({sourcererScope:e,editorActionsRef:t,removeColumn:n,upsertColumn:p})=>{const[m,F]=Object(a.useState)(null),{startTransaction:P}=Object(N.b)(),{indexFieldsSearch:R}=Object(o.b)(),{dataViewFieldEditor:L,data:{dataViews:q}}=Object(s.j)().services,z=Object(i.useSelector)((t=>l.e.sourcererScopeMissingPatterns(t,e))),B=Object(i.useSelector)((t=>l.e.sourcererScopeSelectedDataViewId(t,e)));Object(a.useEffect)((()=>{let e=!1;return null==B||z.length||(async t=>{const n=await q.get(t);e||F(n)})(B),()=>{e=!0}}),[B,z,q]);const $=Object(a.useCallback)((async e=>{if(m&&B){const a=await L.openEditor({ctx:{dataView:m},fieldName:e,onSave:async a=>{P({name:A.c.FIELD_SAVED}),await R({dataViewId:B,cleanCache:!0});for(const t of a)e&&e!==t.name&&n(e),p({columnHeaderType:c.a,id:t.name,initialWidth:u.a},0);t&&(t.current=null)}});t&&(t.current={closeEditor:()=>{t.current=null,a()}})}}),[m,B,L,t,R,n,p,P]),V=Object(a.useCallback)((e=>{m&&B&&L.openDeleteModal({ctx:{dataView:m},fieldName:e,onDelete:async()=>{P({name:A.c.FIELD_DELETED}),await R({dataViewId:B}),n(e)}})}),[m,B,L,R,n,P]),U=Object(a.useMemo)((()=>null==L?void 0:L.userPermissions.editIndexPattern()),[null==L?void 0:L.userPermissions]),G=(({isAllowed:e,loading:t,openFieldEditor:n})=>{const i=Object(a.useCallback)((({onHide:e})=>r.a.createElement(b,{iconType:t?"none":"plusInCircle","aria-label":g,"data-test-subj":"create-field",onClick:()=>{n(),e()},isLoading:t},g)),[t,n]);return e?i:void 0})({isAllowed:U&&!!B,loading:!m,openFieldEditor:$}),H=(({hasFieldEditPermission:e,openFieldEditor:t,openDeleteFieldModal:n})=>Object(a.useCallback)((({highlight:a,onHide:i})=>{const o=e?[{name:O,description:w,type:"icon",icon:"pencil",isPrimary:!0,onClick:({name:e})=>{t(e),i()},available:({isRuntime:e})=>e,"data-test-subj":"actionEditRuntimeField"},{name:S,description:k,type:"icon",icon:"trash",color:"danger",isPrimary:!0,onClick:({name:e})=>{n(e),i()},available:({isRuntime:e})=>e,"data-test-subj":"actionDeleteRuntimeField"}]:[];return[{field:"name",name:y,render:(e,{type:t})=>r.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(d.EuiToolTip,{content:t},r.a.createElement(M,{"data-test-subj":`field-${e}-icon`,type:Object(I.d)(null!=t?t:null)}))),r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(D,{fieldId:e,highlight:a}))),sortable:!0,width:"225px"},{field:"description",name:h,render:(e,{name:t})=>{return r.a.createElement(d.EuiToolTip,{content:e},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"descriptionForScreenReaderOnly"},r.a.createElement("p",null,(n=t,f.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionForScreenReaderOnly",{values:{field:n},defaultMessage:"Description for field {field}:"})))),r.a.createElement(C.a,null,r.a.createElement(_,{width:o.length>0?"335px":"400px","data-test-subj":`field-${t}-description`},`${null!=e?e:Object(T.e)()}`))));var n},sortable:!0,width:o.length>0?"335px":"400px"},{field:"isRuntime",name:E,render:e=>e?r.a.createElement(d.EuiHealth,{color:"success",title:x}):null,sortable:!0,width:"80px"},{field:"category",name:v,render:(e,{name:t})=>r.a.createElement(d.EuiBadge,{"data-test-subj":`field-${t}-category`},e),sortable:!0,width:"115px"},...o.length>0?[{name:j,actions:o,width:"80px"}]:[]]}),[e,t,n]))({hasFieldEditPermission:U,openFieldEditor:$,openDeleteFieldModal:V});return Object(a.useMemo)((()=>({createFieldButton:G,getFieldTableColumns:H})),[G,H])}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),r=n.n(a),i=n(19),o=n(4),s=n(41),l=n.n(s),c=n(42),u=n(122);const d=o.i18n.translate("xpack.securitySolution.management.policiesSelector.globalEntries",{defaultMessage:"Global entries"}),p=o.i18n.translate("xpack.securitySolution.management.policiesSelector.unassignedEntries",{defaultMessage:"Unassigned entries"}),m=Object(a.memo)((({policies:e,onChangeSelection:t,defaultExcludedPolicies:n,defaultIncludedPolicies:o})=>{const{euiTheme:s}=Object(i.useEuiTheme)(),[l,m]=Object(a.useState)(!1),[g,b]=Object(a.useState)(""),[y,h]=Object(a.useState)([]),v=Object(u.a)("excludePoliciesInFilterEnabled");Object(a.useEffect)((()=>{const t=o?o.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},a=n?n.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},r=e=>t[e]?"on":a[e]?"off":void 0;h([...e.map((e=>({name:e.name,id:e.id,checked:r(e.id)}))),{name:d,id:"global",checked:r("global")},{name:p,id:"unassigned",checked:r("unassigned")}])}),[e]);const E=Object(a.useCallback)((()=>{m((e=>!e))}),[]),x=Object(a.useCallback)((()=>{m(!1)}),[]),j=Object(a.useCallback)((e=>{const t=e.target.value||"";b(t)}),[]),O=Object(a.useCallback)((e=>{if(!y[e])return;const n=[...y];switch(n[e].checked){case"on":n[e].checked=v?"off":void 0;break;case"off":n[e].checked=void 0;break;default:n[e].checked="on"}h(n),t(n)}),[y,t,v]),S=Object(a.useMemo)((()=>y.map(((e,t)=>e.name.toLowerCase().includes(g.toLowerCase())?r.a.createElement(i.EuiFilterSelectItem,{checked:e.checked,key:t,onClick:()=>O(t),"data-test-subj":`policiesSelector-popover-items-${e.id}`},e.name):null))),[y,g,O]),w=Object(a.useMemo)((()=>r.a.createElement(i.EuiFilterButton,{iconType:"arrowDown","data-test-subj":"policiesSelectorButton",onClick:E,isSelected:l,numFilters:y.length,hasActiveFilters:!!y.find((e=>"on"===e.checked)),numActiveFilters:y.filter((e=>"on"===e.checked)).length},r.a.createElement(i.EuiText,null,r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.management.policiesSelector.label",defaultMessage:"Policies"})))),[l,y,E]);return r.a.createElement(i.EuiFlexGroup,{"data-test-subj":"policiesSelector",direction:"row",alignItems:"center",gutterSize:"l"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFilterGroup,null,r.a.createElement(i.EuiPopover,{button:w,isOpen:l,closePopover:x,panelPaddingSize:"none"},r.a.createElement(i.EuiPopoverTitle,{paddingSize:"s"},r.a.createElement(i.EuiFieldSearch,{"data-test-subj":"policiesSelectorSearch",compressed:!0,onChange:j,value:g})),r.a.createElement(f,{"data-test-subj":"policiesSelector-popover",className:"eui-yScroll",$_css:30*s.base},S)))))}));m.displayName="PoliciesSelector";var f=l()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-gji8ln-0"})((e=>({maxHeight:e.$_css}))),g=n(140);const b=Object(a.memo)((({defaultValue:e="",onSearch:t,placeholder:n,hasPolicyFilter:s,policyList:l,defaultIncludedPolicies:c,hideRefreshButton:u=!1})=>{const{canCreateArtifactsByPolicy:d}=Object(g.a)().endpointPrivileges,[p,f]=Object(a.useState)(e),[b,y]=Object(a.useState)(c||""),h=Object(a.useCallback)((e=>{const n=e.filter((e=>"on"===e.checked)).map((e=>e.id)).join(",");y(n),t(p,n,!1)}),[t,p]),v=Object(a.useCallback)((e=>f(e.target.value)),[f]),E=Object(a.useCallback)((()=>t(p,b,!0)),[t,p,b]),x=Object(a.useCallback)((e=>{t(e,b,!1)}),[t,b]);return r.a.createElement(i.EuiFlexGroup,{"data-test-subj":"searchExceptions",direction:"row",alignItems:"center",gutterSize:"m"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFieldSearch,{defaultValue:e,placeholder:n,onChange:v,onSearch:x,isClearable:!0,fullWidth:!0,"data-test-subj":"searchField"})),d&&s&&l?r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(m,{policies:l,defaultIncludedPolicies:c,onChangeSelection:h})):null,u?null:r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{iconType:"refresh",onClick:E,"data-test-subj":"searchButton"},o.i18n.translate("xpack.securitySolution.management.search.button",{defaultMessage:"Refresh"}))))}));b.displayName="SearchExceptions"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),r=n(1558),i=n(527),o=n(1532),s=n(1533),l=n(314),c=n(707),u=n(123),d=n(118),p=n(201),m=n(896);const f=Object(o.a)((async({http:e,jobIds:t,signal:n})=>e.fetch("/internal/ml/jobs/jobs",{method:"POST",version:"1",body:JSON.stringify({jobIds:t}),asSystemRequest:!0,signal:n}))),g=(e,t,n)=>{const o=Object(a.useMemo)((()=>null!=e?e:[]),[e]),{loading:g,jobs:b}=Object(i.a)(),y=Object(a.useMemo)((()=>b.filter((({id:e})=>o.includes(e)))),[b,o]),h=Object(a.useMemo)((()=>y.filter((({isInstalled:e})=>e)).map((e=>e.id))),[y]),{loading:v,jobs:E}=(e=>{const[t,n]=Object(a.useState)([]),{addError:r}=Object(u.a)(),i=Object(p.a)(),o=Object(d.i)(),{error:g,loading:b,result:y,start:h}=Object(s.a)(f),v=Object(l.a)(i),E=Object(c.a)(i);return Object(a.useEffect)((()=>{v&&E&&e.length>0&&h({http:o,jobIds:e})}),[o,v,E,h,e]),Object(a.useEffect)((()=>{y&&n(y)}),[y]),Object(a.useEffect)((()=>{g&&r(g,{title:m.a})}),[r,g]),{isLicensed:E,isMlUser:v,jobs:t,loading:b}})(h),x=Object(a.useMemo)((()=>{const e=E.map((e=>`.ml-anomalies-${e.results_index_name}`));return[...new Set(e)]}),[E]);return{mlJobLoading:g||v,ruleIndices:Object(a.useMemo)((()=>x.length>0?x:n?Object(r.a)(n):null!=t?t:[]),[t,n,x])}}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=()=>{const e=Object(a.useRef)(!1),t=Object(a.useCallback)((()=>e.current),[]),n=Object(a.useCallback)((()=>{e.current=!1}),[]);return Object(a.useEffect)((()=>(e.current=!0,n)),[n]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(2);const r=n.n(a).a.createContext(void 0),i=()=>Object(a.useContext)(r)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n(48),i=n(910),o=n(819),s=n(582),l=n(870);const c=()=>{const e=Object(l.e)(),t=Object(r.useHistory)(),{urlKey:n}=Object(o.b)(),c=n||i.a,u=Object(a.useCallback)((({right:t,left:n,preview:a})=>e(Object(s.f)({right:t,left:n,preview:a,id:c}))),[e,c]),d=Object(a.useCallback)((t=>e(Object(s.h)({right:t,id:c}))),[e,c]),p=Object(a.useCallback)((t=>e(Object(s.e)({left:t,id:c}))),[e,c]),m=Object(a.useCallback)((t=>e(Object(s.g)({preview:t,id:c}))),[e,c]),f=Object(a.useCallback)((()=>e(Object(s.d)({id:c}))),[e,c]),g=Object(a.useCallback)((()=>e(Object(s.a)({id:c}))),[e,c]),b=Object(a.useCallback)((()=>e(Object(s.c)({id:c}))),[e,c]),y=Object(a.useCallback)((()=>{c===i.a?e(Object(s.i)({id:c})):t.goBack()}),[e,c,t]),h=Object(a.useCallback)((()=>e(Object(s.b)({id:c}))),[e,c]);return Object(a.useMemo)((()=>({openFlyout:u,openRightPanel:d,openLeftPanel:p,openPreviewPanel:m,closeRightPanel:f,closeLeftPanel:g,closePreviewPanel:b,closeFlyout:h,previousPreviewPanel:y})),[u,d,p,m,f,g,b,h,y])}},,,,,,function(e,t,n){"use strict";n.d(t,"t",(function(){return C})),n.d(t,"h",(function(){return M})),n.d(t,"d",(function(){return _})),n.d(t,"o",(function(){return D})),n.d(t,"r",(function(){return N})),n.d(t,"e",(function(){return A})),n.d(t,"n",(function(){return F})),n.d(t,"m",(function(){return L})),n.d(t,"j",(function(){return q})),n.d(t,"s",(function(){return B})),n.d(t,"g",(function(){return $})),n.d(t,"k",(function(){return V})),n.d(t,"q",(function(){return U})),n.d(t,"p",(function(){return G})),n.d(t,"i",(function(){return W})),n.d(t,"a",(function(){return Q})),n.d(t,"c",(function(){return Y})),n.d(t,"b",(function(){return K})),n.d(t,"l",(function(){return Z})),n.d(t,"f",(function(){return X}));var a=n(41),r=n.n(a),i=n(19),o=n(813),s=n(44),l=n(2),c=n.n(l),u=n(70),d=n(566),p=n(290),m=n(662),f=n(227),g=n(1223),b=n(1224),y=n(663),h=n(298),v=n(248),E=n(130),x=n(772),j=n(773),O=n(791);const S=r()(i.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-1fdewst-0"})(["height:105px;overflow-y:hidden;"]),w=r()(i.EuiFlexItem).withConfig({displayName:"SetupDescriptionContainer",componentId:"sc-1fdewst-1"})(["height:105px;overflow-y:hidden;"]),k=e=>!Object(s.isEmpty)(e.join("")),I=r()(i.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-1fdewst-2"})([".euiBadge__text{white-space:pre-wrap !important;}"]),T=r.a.div.withConfig({displayName:"Query",componentId:"sc-1fdewst-3"})(["white-space:pre-wrap;"]),C=e=>{switch(e){case"eql":return y.g;case"saved_query":return y.t;case"esql":return y.k;default:return y.q}},M=({field:e,filters:t,filterManager:n,query:a,savedId:r,savedQueryName:o,indexPatterns:l,queryLabel:d})=>{let p=[];const m=!Object(s.isEmpty)(r)&&!Object(s.isEmpty)(o);return m&&(p=[...p,{title:c.a.createElement(c.a.Fragment,null,y.u," "),description:c.a.createElement(c.a.Fragment,null,o," ")}]),Object(s.isEmpty)(t)||(n.setFilters(t),p=[...p,{title:c.a.createElement(c.a.Fragment,null,m?y.s:y.m," "),description:c.a.createElement(i.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},n.getFilters().map(((t,n)=>c.a.createElement(J,{grow:!1,key:`${e}-filter-${n}`},c.a.createElement(I,{color:"hollow"},null!=l?c.a.createElement(u.FilterBadgeGroup,{filters:[t],dataViews:[l]}):c.a.createElement(i.EuiLoadingSpinner,{size:"m"}))))))}]),Object(s.isEmpty)(a)||(p=[...p,{title:c.a.createElement(c.a.Fragment,null,m?y.t:null!=d?d:y.q),description:c.a.createElement(T,null,a)}]),p},_=e=>{let t=[];return Object(s.isEmpty)(e.eventCategoryField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,y.f),description:c.a.createElement(c.a.Fragment,null,e.eventCategoryField)}]),Object(s.isEmpty)(e.tiebreakerField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,y.h),description:c.a.createElement(c.a.Fragment,null,e.tiebreakerField)}]),Object(s.isEmpty)(e.timestampField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,y.i),description:c.a.createElement(c.a.Fragment,null,e.timestampField)}]),t},D=({threat:e,label:t})=>e.length>0?[{title:t,description:c.a.createElement(j.a,{threat:e})}]:[],N=(e,t,n)=>k(n)?[{title:e,description:c.a.createElement(i.EuiText,{size:"s"},c.a.createElement("ul",null,n.map((e=>Object(s.isEmpty)(e)?null:c.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[],A=(e,t)=>{if(Object(s.isEmpty)(t))return[];const n=c.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(s.isEmpty)(t)?null:c.a.createElement(i.EuiFlexItem,{grow:!1,key:`${e}-${t}`},c.a.createElement(I,{"data-test-subj":"customHighlightedFieldsStringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:e,description:n}]},F=(e,t,n)=>k(n)?[{title:e,description:c.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},n.map((e=>Object(s.isEmpty)(e)?null:c.a.createElement(i.EuiFlexItem,{grow:!1,key:`${t}-${e}`},c.a.createElement(I,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[],P=r()(i.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-1fdewst-4"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),R=r()(i.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-1fdewst-5"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),L=e=>[{title:g.a,description:c.a.createElement(h.a,{value:e.value})},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?g.d:"",description:c.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},c.a.createElement(P,null,c.a.createElement(i.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},c.a.createElement(c.a.Fragment,null,`${e.field}:`))),c.a.createElement(R,null,c.a.createElement(i.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(E.a)(e.value))),c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(i.EuiIcon,{type:"sortRight"})),c.a.createElement(i.EuiFlexItem,null,c.a.createElement(h.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]],q=e=>[{title:b.b,description:e.value},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?b.e:"",description:c.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},c.a.createElement(P,null,c.a.createElement(i.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},c.a.createElement(c.a.Fragment,null,e.field))),c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(i.EuiIcon,{type:"sortRight"})),c.a.createElement(i.EuiFlexItem,null,o.a))}))):[]],z=r()(i.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-1fdewst-6"})(["word-break:break-word;"]),B=(e,t)=>k(t)?[{title:e,description:c.a.createElement(i.EuiText,{size:"s"},c.a.createElement("ul",null,t.filter((e=>!Object(s.isEmpty)(e))).map(((e,t)=>c.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},c.a.createElement(z,{href:e,external:!0,target:"_blank"},e))))))}]:[],$=(e,t)=>""!==t.trim()?[{title:e,description:c.a.createElement(S,null,c.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],V=(e,t)=>{switch(t){case"machine_learning":return[{title:e,description:y.o}];case"query":case"saved_query":return[{title:e,description:y.r}];case"threshold":return[{title:e,description:y.z}];case"eql":return[{title:e,description:y.j}];case"threat_match":return[{title:e,description:y.v}];case"new_terms":return[{title:e,description:y.p}];case"esql":return[{title:e,description:y.l}];default:return Object(f.a)(t)}},U=(e,t)=>[{title:e,description:c.a.createElement(c.a.Fragment,null,Object(s.isEmpty)(t.field[0])?`${y.y} >= ${t.value}`:`${y.x} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}],G=(e,t)=>[{title:e,description:t.reduce(((e,t,n,{length:a})=>{const r=t.entries.reduce(((e,t,n,{length:a})=>1===a?`${t.field} ${m.d} ${t.value}`:0===n?`(${t.field} ${m.d} ${t.value})`:`${e} ${m.a} (${t.field} ${m.d} ${t.value})`),"");return 1===a?`${r}`:0===n?`(${r})`:`${e} ${m.e} (${r})`}),"")}],H=r()(i.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-1fdewst-7"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),W=(e,t)=>Object(s.isEmpty)(t)?[]:[{title:e,description:c.a.createElement(i.EuiFlexGrid,{gutterSize:"s"},t.map(((e,n)=>c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(x.a,{"data-test-subj":"field-type-icon",type:e.type})),c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(H,{grow:!1,size:"s"},` ${e.name}${n+1!==t.length?", ":""}`)))))))}],Q=(e=y.n,t,n)=>{if(Object(s.isEmpty)(t))return[];const a=c.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(s.isEmpty)(t)?null:c.a.createElement(i.EuiFlexItem,{grow:!1,key:`${e}-${t}`},c.a.createElement(I,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:c.a.createElement(O.a,{label:e,ruleType:n}),description:a}]},Y=(e,t,n,a)=>{const r=n===v.b.PerTimePeriod?`${t.value}${t.unit}`:y.b;return[{title:c.a.createElement(O.a,{label:e,ruleType:a}),description:r}]},K=(e,t,n)=>{if(Object(s.isEmpty)(t))return[];const a=t===p.a.suppress?y.c:y.a;return[{title:c.a.createElement(O.a,{label:e,ruleType:n}),description:a}]},Z=(e,t)=>""!==t.trim()?[{title:e,description:c.a.createElement(w,null,c.a.createElement("div",{"data-test-subj":"setupDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],X=(e,t)=>[{title:e,description:c.a.createElement(d.a,{interval:t})}];var J=r()(i.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1fdewst-8"})({width:"100%"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),i=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),o=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),s=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),l=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),c=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),u=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),d=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),i=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),o=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),s=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),l=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),c=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),u=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),d=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n(149),i=n(333),o=n(479),s=n(123),l=n(187),c=n(1105);const u=({eventIds:e,currentStatus:t,query:n,setEventsLoading:u,showAlertStatusActions:d=!0,setEventsDeleted:p,onUpdateSuccess:m,onUpdateFailure:f,customBulkActions:g})=>{const{addSuccess:b,addError:y,addWarning:h}=Object(s.a)(),{startTransaction:v}=Object(l.b)(),E=Object(a.useCallback)(((e,t,n)=>{if(t>0)h({title:i.x(t),text:i.y(e,t)});else{let t;switch(n){case"closed":t=i.p(e);break;case"open":t=i.r(e);break;case"acknowledged":t=i.b(e)}b({title:t})}m&&m(e,t,n)}),[b,h,m]),x=Object(a.useCallback)(((e,t)=>{let n;switch(e){case"closed":n=i.o;break;case"open":n=i.q;break;case"acknowledged":n=i.a}y(t.message,{title:n}),f&&f(e,t)}),[y,f]),j=Object(a.useCallback)((async t=>{n?v({name:c.a.BULK_QUERY_STATUS_UPDATE}):e.length>1?v({name:c.a.BULK_STATUS_UPDATE}):v({name:c.a.STATUS_UPDATE});try{var a,r;u({eventIds:e,isLoading:!0});const s=await Object(o.a)({status:t,query:n&&JSON.parse(n),signalIds:e});if(p({eventIds:e,isDeleted:!0}),s.version_conflicts&&1===e.length)throw new Error(i.l);E(null!==(a=s.updated)&&void 0!==a?a:0,null!==(r=s.version_conflicts)&&void 0!==r?r:0,t)}catch(e){x(t,e)}finally{u({eventIds:e,isLoading:!1})}}),[u,e,n,p,E,x,v]);return Object(a.useMemo)((()=>{const a=[];d&&(t!==r.d&&a.push({key:"open","data-test-subj":"open-alert-status",onClick:()=>j(r.d),name:i.m}),t!==r.b&&a.push({key:"acknowledge","data-test-subj":"acknowledged-alert-status",onClick:()=>j(r.b),name:i.j}),t!==r.c&&a.push({key:"close","data-test-subj":"close-alert-status",onClick:()=>j(r.c),name:i.k}));const o=g?g.reduce(((t,a)=>{const r=!(!n||!a.disableOnQuery);return t.push({key:a.key,disabled:r,"data-test-subj":a["data-test-subj"],toolTipContent:r?a.disabledLabel:null,onClick:()=>a.onClick(e),name:a.label}),t}),[]):[];return[...a,...o]}),[t,g,e,j,n,d])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(2),r=n(661);const i=["kibana.alert.workflow_assignee_ids","kibana.alert.workflow_user"],o=({alerts:e,columns:t})=>{const n=Object(a.useMemo)((()=>{const n=new Set;return e.forEach((e=>{i.forEach((a=>{if(null!=t.find((e=>e.id===a))){const t=e[a];null==t||t.forEach((e=>n.add(e)))}}))})),n}),[e,t]),o=Object(r.a)({uids:n});return Object(a.useMemo)((()=>({profiles:o.data,isLoading:o.isLoading})),[o.data,o.isLoading])}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var a=n(2),r=n.n(a),i=n(41),o=n.n(i),s=n(19),l=n(732),c=n(1229);const u=o()(s.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1sj6853-0"})(["line-height:inherit;"]),d=[{value:"low",inputDisplay:r.a.createElement(u,{color:c.c},l.j)},{value:"medium",inputDisplay:r.a.createElement(u,{color:c.d},l.k)},{value:"high",inputDisplay:r.a.createElement(u,{color:c.b},l.i)},{value:"critical",inputDisplay:r.a.createElement(u,{color:c.a},l.g)}],p={low:c.g,medium:c.h,high:c.f,critical:c.e}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d}));var a=n(49);const r=a.euiLightVars.euiColorVis0,i=a.euiLightVars.euiColorVis5,o=a.euiLightVars.euiColorVis7,s=a.euiLightVars.euiColorVis9,l=21,c=47,u=73,d=99},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(159),i=n(118),o=n(353);const s=()=>{const e=Object(i.n)(),[t,n]=Object(a.useState)(!0),[s,l]=Object(a.useState)(!1),[c,u]=Object(a.useState)(null),d=Object(a.useRef)(null);return Object(a.useEffect)((()=>{let t=!0;const a=new AbortController;return d.current=async i=>{try{n(!0);const{references:e}=await Object(r.l)({lists:i,signal:a.signal}),o=e.reduce(((e,t)=>{const[[n,a]]=Object.entries(t);return e[n]=a,e}),{});t&&(n(!1),l(!1),u(o))}catch(a){t&&(l(!0),n(!1),e.addError(a,{title:o.d}))}},()=>{t=!1,a.abort()}}),[e]),[t,s,c,d.current]}},function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(4);const r=a.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),i=a.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),o=a.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),s=a.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),l=a.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),c=a.i18n.translate("autocomplete.invalidBinaryType",{defaultMessage:"Binary fields are currently unsupported"}),u=a.i18n.translate("autocomplete.fieldSpaceWarning",{defaultMessage:"Warning: Spaces at the start or end of this value aren't being displayed."}),d=(a.i18n.translate("autocomplete.listsTooltipWarning",{defaultMessage:"Lists that aren't able to be processed by this rule type will be disabled."}),a.i18n.translate("autocomplete.seeDocumentation",{defaultMessage:"See Documentation"}),a.i18n.translate("autocomplete.conflictIndicesWarning.title",{defaultMessage:"Mapping Conflict"})),p=a.i18n.translate("autocomplete.conflictIndicesWarning.description",{defaultMessage:"This field is defined as different types across the following indices or is unmapped. This can cause unexpected query results."}),m=(e,t)=>a.i18n.translate("autocomplete.conflictIndicesWarning.index.description",{defaultMessage:"{name} ({count} indices)",values:{count:t,name:e}});a.i18n.translate("autocomplete.showValueListModal",{defaultMessage:"Show value list"}),t.k={LOADING:r,SELECT_FIELD_FIRST:i,FIELD_REQUIRED_ERR:o,NUMBER_ERR:s,DATE_ERR:l,FIELD_SPACE_WARNING:u,BINARY_TYPE_NOT_SUPPORTED:c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return E})),n.d(t,"c",(function(){return j}));var a=n(2),r=n.n(a),i=n(4),o=n(42),s=n(19),l=n(140),c=n(118),u=n(952),d=n(602),p=n(881),m=n(603),f=n(1233);const g=i.i18n.translate("xpack.securitySolution.eventFilters.aboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),b=i.i18n.translate("xpack.securitySolution.eventFilter.form.name.label",{defaultMessage:"Name"}),y=i.i18n.translate("xpack.securitySolution.eventFilter.form.description.placeholder",{defaultMessage:"Description"}),h=i.i18n.translate("xpack.securitySolution.eventFilter.form.name.error",{defaultMessage:"The name can't be empty"}),v=i.i18n.translate("xpack.securitySolution.eventFilter.form.os.label",{defaultMessage:"Select operating system"}),E=i.i18n.translate("xpack.securitySolution.eventFilter.form.rule.name",{defaultMessage:"Endpoint Event Filtering"}),x={pageTitle:i.i18n.translate("xpack.securitySolution.eventFilters.pageTitle",{defaultMessage:"Event Filters"}),pageAboutInfo:i.i18n.translate("xpack.securitySolution.eventFilters.pageAboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),pageAddButtonTitle:i.i18n.translate("xpack.securitySolution.eventFilters.pageAddButtonTitle",{defaultMessage:"Add event filter"}),getShowingCountLabel:e=>i.i18n.translate("xpack.securitySolution.eventFilters.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {event filter} other {event filters}}",values:{total:e}}),cardActionEditLabel:i.i18n.translate("xpack.securitySolution.eventFilters.cardActionEditLabel",{defaultMessage:"Edit event filter"}),cardActionDeleteLabel:i.i18n.translate("xpack.securitySolution.eventFilters.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),flyoutCreateTitle:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateTitle",{defaultMessage:"Add event filter"}),flyoutEditTitle:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditTitle",{defaultMessage:"Edit event filter"}),flyoutCreateSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add event filter"}),flyoutCreateSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),r.a.createElement(s.EuiLink,{target:"_blank",href:`${e.eventFilters}`},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsLink",defaultMessage:"Event filters documentation"}))),deleteActionSuccess:e=>i.i18n.translate("xpack.securitySolution.eventFilters.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from event filters list.',values:{itemName:e}}),emptyStateTitleNoEntries:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitleNoEntries",{defaultMessage:"There are no event filters to display."}),emptyStateTitle:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitle",{defaultMessage:"Add your first event filter"}),emptyStateInfo:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateInfo",{defaultMessage:"Add an event filter to exclude high volume or unwanted events from being written to Elasticsearch."}),emptyStatePrimaryButtonLabel:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStatePrimaryButtonLabel",{defaultMessage:"Add event filter"}),searchPlaceholderInfo:i.i18n.translate("xpack.securitySolution.eventFilters.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"})},j=Object(a.memo)((()=>{const{canWriteEventFilters:e}=Object(l.a)().endpointPrivileges,t=Object(c.i)(),n=d.a.getInstance(t);return r.a.createElement(u.a,{apiClient:n,ArtifactFormComponent:p.a,labels:x,"data-test-subj":"EventFiltersListPage",searchableFields:m.d,flyoutSize:"l",allowCardCreateAction:e,allowCardEditAction:e,allowCardDeleteAction:e,CardDecorator:f.a})}));j.displayName="EventFiltersList"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(42),c=n(126),u=n(122),d=n(259),p=n(846);const m=Object(i.memo)((({item:e,"data-test-subj":t,...n})=>{const a=Object(c.a)(t);return Object(u.a)("filterProcessDescendantsForEventFiltersEnabled")&&Object(d.g)(e)?o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiText,r()({},n,{"data-test-subj":a("processDescendantIndication")}),o.a.createElement("code",null,o.a.createElement("strong",null,o.a.createElement(l.FormattedMessage,{defaultMessage:"Filtering descendants of process",id:"xpack.securitySolution.eventFilters.filteringProcessDescendants"})," ",o.a.createElement(p.a,{indicateExtraEntry:!0,"data-test-subj":a("processDescendantIndicationTooltip")})))),o.a.createElement(s.EuiSpacer,{size:"m"})):o.a.createElement(o.a.Fragment,null)}));m.displayName="EventFiltersProcessDescendantIndicator"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i}));let a=function(e){return e.updateActiveGroups="UPDATE_ACTIVE_GROUPS",e.updateGroupOptions="UPDATE_GROUP_OPTIONS",e}({});const r={},i={activeGroups:["none"],options:[]}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(19),r=n(2),i=n.n(r),o=n(293),s=n(748),l=n(5),c=n(118),u=n(333),d=n(7);const p=(e,t)=>e.checked?t.checked&&e.checked<=t.checked?1:-1:t.checked?1:0,m=(e,t)=>{const n=Object(d.intersection)(...e),a=Object(d.union)(...e);return Object(d.union)(a,t).map((e=>{let t={checked:void 0,"data-test-subj":"unselected-alert-tag"};return n.includes(e)?t={checked:"on","data-test-subj":"selected-alert-tag"}:a.includes(e)&&(t={checked:"mixed","data-test-subj":"mixed-alert-tag"}),{label:e,...t}})).sort(p)},f={selectableAlertTags:[],tagsToAdd:new Set,tagsToRemove:new Set},g=({alertItems:e,refresh:t,refetchQuery:n,setIsLoading:o,clearSelection:d,closePopoverMenu:p,onSubmit:g})=>{const[b]=Object(c.o)(l.E),y=Object(r.useMemo)((()=>e.map((e=>{var t,n;return null!==(t=null===(n=e.data.find((e=>e.field===s.H)))||void 0===n?void 0:n.value)&&void 0!==t?t:[]}))),[e]),[{selectableAlertTags:h,tagsToAdd:v,tagsToRemove:E},x]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"addAlertTag":{const{value:n}=t;return e.tagsToAdd.add(n),e.tagsToRemove.delete(n),e}case"removeAlertTag":{const{value:n}=t;return e.tagsToRemove.add(n),e.tagsToAdd.delete(n),e}case"setSelectableAlertTags":{const{value:n}=t;return{...e,selectableAlertTags:n}}default:return e}}),f),j=Object(r.useCallback)((e=>{x({type:"addAlertTag",value:e})}),[x]),O=Object(r.useCallback)((e=>{x({type:"removeAlertTag",value:e})}),[x]),S=Object(r.useCallback)((e=>{x({type:"setSelectableAlertTags",value:e})}),[x]),w=Object(r.useCallback)((async()=>{if(0===v.size&&0===E.size)return void p();const a=Array.from(v),r=Array.from(E),i=e.map((e=>e._id)),s={tags_to_add:a,tags_to_remove:r};null!=g&&(p(),await g(s,i,(()=>{n&&n(),t&&t(),d&&d()}),o))}),[p,v,E,e,n,t,d,o,g]),k=Object(r.useCallback)(((e,t,n)=>{"on"===n.checked?j(n.label):n.checked||O(n.label),S(e)}),[j,O,S]);return Object(r.useEffect)((()=>{x({type:"setSelectableAlertTags",value:m(y,b)})}),[y,b]),i.a.createElement(i.a.Fragment,null,i.a.createElement(a.EuiSelectable,{searchable:!0,searchProps:{placeholder:u.i},"aria-label":u.i,options:h,onChange:k,emptyMessage:u.g,noMatchesMessage:u.h,"data-test-subj":"alert-tags-selectable-menu"},((e,t)=>i.a.createElement("div",null,i.a.createElement(a.EuiPopoverTitle,null,t),e))),i.a.createElement(a.EuiButton,{"data-test-subj":"alert-tags-update-button",fullWidth:!0,size:"s",onClick:w},u.d))},b=Object(r.memo)(g);var y=n(56),h=n(123);const v=({refetch:e})=>{const{hasIndexWrite:t}=Object(o.a)(),n=(()=>{const{http:e}=Object(y.useKibana)().services,{addSuccess:t,addError:n}=Object(h.a)(),a=Object(r.useRef)(null),i=Object(r.useCallback)(((e=0)=>t(u.A(e))),[t]),o=Object(r.useCallback)((e=>{n(e.message,{title:u.z})}),[n]);return Object(r.useEffect)((()=>{let e=!1;const t=new AbortController;return a.current=async(n,a,r,s)=>{try{s(!0);const o=await(async({tags:e,ids:t,signal:n})=>c.b.get().http.fetch(l.kb,{method:"POST",version:"2023-10-31",body:JSON.stringify({tags:e,ids:t}),signal:n}))({tags:n,ids:a,signal:t.signal});e||(r(),s(!1),i(o.updated))}catch(t){e||(s(!1),o(t))}},()=>{e=!0,t.abort()}}),[e,o,i]),a.current})(),s=Object(r.useCallback)((async(e,t,a,r)=>{n&&await n(e,t,a,r)}),[n]),d=Object(r.useMemo)((()=>t?[{key:"manage-alert-tags","data-test-subj":"alert-tags-context-menu-item",name:u.e,panel:1,label:u.e,disableOnQuery:!0}]:[]),[t]),p=Object(r.useMemo)((()=>i.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(a.EuiFlexItem,{grow:!1},u.e),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiIconTip,{content:u.f,position:"right"})))),[]),m=Object(r.useCallback)((({alertItems:t,refresh:n,setIsBulkActionsLoading:a,clearSelection:r,closePopoverMenu:o})=>i.a.createElement(b,{alertItems:t,refresh:n,refetchQuery:e,setIsLoading:a,clearSelection:r,closePopoverMenu:o,onSubmit:s})),[s,e]),f=Object(r.useMemo)((()=>t?[{id:1,title:p,"data-test-subj":"alert-tags-context-menu-panel",renderContent:m}]:[]),[p,t,m]);return Object(r.useMemo)((()=>({alertTagsItems:d,alertTagsPanels:f})),[d,f])}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n(44),r=n(2),i=n.n(r),o=n(19),s=n(4),l=n(42),c=n(827),u=n(1293),d=n(43);const p="null",m=({selectedOptions:e,defaultOptions:t,options:n,onChange:a,onSearchChange:m,isLoading:b=!1,singleSelection:y=!1,limit:h,height:v,loadingMessage:E,noMatchesMessage:x,emptyMessage:j,errorMessage:O,searchPlaceholder:S,searchInputId:w,selectedStatusMessage:k,limitReachedMessage:I,nullOptionLabel:T,nullOptionProps:C,defaultOptionsLabel:M,clearButtonLabel:_,...D})=>{const[N,A]=Object(r.useState)([]),[F,P]=Object(r.useState)(""),R=e?e.length:0,L=!!h&&R>=h,q=()=>{n||A((n=>{const a=[...n],r=e?e.filter((e=>!a.find((t=>g(t,e))))).map((e=>f(e,T,C))):[],i=t?t.filter((e=>!a.find((t=>g(t,e)))&&!r.find((t=>g(t,e))))).map((e=>f(e,T,C))):[];if(i.length){const e=(e=>{let t=e.findIndex((e=>e.isGroupLabel));return-1===t&&(t=e.push({label:null!=M?M:s.i18n.translate("userProfileComponents.userProfilesSelectable.defaultOptionsLabel",{defaultMessage:"Suggested"}),isGroupLabel:!0})-1),t})(a);a.splice(e,0,...r),a.push(...i)}else a.push(...r);return a}))};return Object(r.useEffect)((()=>{n?A(n.map((e=>f(e,T,C)))):(A([]),q())}),[n]),Object(r.useEffect)(q,[t,e]),Object(r.useEffect)((()=>{A((t=>t.map((t=>{if(e){var n;const a=void 0===e.find((e=>g(t,e)))?void 0:"on",r=!a&&L;return{...t,checked:a,disabled:r,prepend:t.data?Object(d.jsx)(u.a,{user:t.data.user,avatar:null===(n=t.data.data)||void 0===n?void 0:n.avatar,size:"s",isDisabled:r}):void 0}}return{...t,checked:void 0,disabled:void 0}}))))}),[n,t,e]),Object(d.jsx)(o.EuiSelectable,{"data-test-subj":D["data-test-subj"],options:N,onChange:t=>{if(!a)return;const n=t.filter((t=>!(t.isGroupLabel||"on"!==t.checked||e&&void 0!==e.find((e=>g(t,e)))))).map((e=>e.key===p?null:e.data));e&&!y&&e.forEach((e=>{const a=t.find((t=>g(t,e)));void 0!==a&&"on"!==a.checked||(a&&a.key===p?n.unshift(e):n.push(e))})),a(n)},style:{maxHeight:v},singleSelection:y,searchable:!0,searchProps:{placeholder:null!=S?S:s.i18n.translate("userProfileComponents.userProfilesSelectable.searchPlaceholder",{defaultMessage:"Search"}),value:F,onChange:e=>{P(e),null==m||m(e)},isLoading:b,isClearable:!b,id:w},isPreFiltered:!0,listProps:{onFocusBadge:!1,rowHeight:48},loadingMessage:E,noMatchesMessage:x,emptyMessage:j,errorMessage:O,renderOption:(e,t)=>{if(e.user){const n=Object(c.e)(e.user);return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)("div",{className:"eui-textTruncate"},Object(d.jsx)(o.EuiHighlight,{search:t},n)),e.user.email&&e.user.email!==n?Object(d.jsx)(o.EuiText,{size:"xs",color:e.disabled?"disabled":"subdued",className:"eui-textTruncate"},t?Object(d.jsx)(o.EuiHighlight,{search:t},e.user.email):e.user.email):void 0)}return Object(d.jsx)(o.EuiHighlight,{search:t},e.label)}},((e,t)=>Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.EuiPanel,{hasShadow:!1,paddingSize:"s"},t,y?void 0:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(o.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"s",responsive:!1},Object(d.jsx)(o.EuiFlexItem,{grow:!1},Object(d.jsx)(o.EuiText,{size:"xs",color:"subdued"},k?k(R):Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.selectedStatusMessage",defaultMessage:"{count, plural, one {# user selected} other {# users selected}}",values:{count:R}}))),Object(d.jsx)(o.EuiFlexItem,{grow:!1},R?Object(d.jsx)(o.EuiButtonEmpty,{size:"xs",flush:"right",onClick:()=>null==a?void 0:a([]),style:{height:"1rem"}},null!=_?_:Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.clearButtonLabel",defaultMessage:"Remove all users"})):void 0)))),h&&R>=h?Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.EuiHorizontalRule,{margin:"none"}),Object(d.jsx)(o.EuiCallOut,{title:I?I(h):Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.limitReachedMessage",defaultMessage:"You've selected the maximum of {count, plural, one {# user} other {# users}}",values:{count:h}}),color:"warning",size:"s"})):void 0,Object(d.jsx)(o.EuiHorizontalRule,{margin:"none"}),e)))};function f(e,t,n){return e?{key:e.uid,label:Object(c.d)(e.user),data:e,"data-test-subj":`userProfileSelectableOption-${e.user.username}`}:{key:p,label:null!=t?t:s.i18n.translate("userProfileComponents.userProfilesSelectable.nullOptionLabel",{defaultMessage:"No users"}),"data-test-subj":"userProfileSelectableOption-null",...n}}function g(e,t){return e.key===(t?t.uid:p)}var b=n(7),y=n(47),h=n(483),v=n(118),E=n(123),x=n(824),j=n(405),O=n(5);var S=n(661),w=n(825),k=n(826);const I=Object(r.memo)((({searchInputId:e,assignedUserIds:t,showUnassignedOption:n,onSelectionChange:o})=>{const{data:s}=(()=>{const{security:e}=Object(v.j)().services,{addError:t}=Object(E.a)();return Object(y.useQuery)(["useGetCurrentUserProfile"],(async()=>(async({security:e})=>e.userProfiles.getCurrent({dataPath:"avatar"}))({security:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:h.a})}})})(),l=Object(r.useMemo)((()=>new Set(Object(w.b)(t))),[t]),{isLoading:c,data:u}=Object(S.a)({uids:l}),[d,p]=Object(r.useState)(""),{isLoading:f,data:g}=(({searchTerm:e})=>{const{addError:t}=Object(E.a)();return Object(y.useQuery)(["useSuggestUsers",e],(async()=>(async({searchTerm:e})=>(async({searchTerm:e})=>v.b.get().http.fetch(O.jb,{method:"GET",version:"1",query:{searchTerm:e}}))({searchTerm:e}))({searchTerm:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:h.c})}})})({searchTerm:d}),I=Object(r.useMemo)((()=>{var e;const t=null!==(e=Object(w.a)(s,g))&&void 0!==e?e:[];return n&&Object(b.isEmpty)(d)?[j.b,...t]:t}),[s,d,n,g]),[T,C]=Object(r.useState)([]);Object(r.useEffect)((()=>{if(c||!u)return;const e=void 0!==t.find((e=>e===j.b))?[j.b,...u]:u;C(e)}),[t,u,c]);const M=Object(r.useCallback)((e=>{Object(a.isEqual)(e,T)||(C(e),null==o||o(e.map((e=>{var t;return null!==(t=null==e?void 0:e.uid)&&void 0!==t?t:j.b}))))}),[o,T]),_=Object(r.useCallback)((e=>x.e(e)),[]),D=c||f;return i.a.createElement("div",{"data-test-subj":k.c},i.a.createElement(m,{searchInputId:e,onSearchChange:e=>{p(e)},onChange:M,selectedStatusMessage:_,options:I,selectedOptions:T,isLoading:D,height:"full",singleSelection:!1,searchPlaceholder:x.d,clearButtonLabel:x.b,nullOptionLabel:x.c}))}));I.displayName="AssigneesSelectable"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(7),r=n(2),i=n.n(r),o=n(19),s=n(748),l=n(16),c=n(293),u=n(405),d=n(923);const p=({alertItems:e,refresh:t,setIsLoading:n,clearSelection:o,closePopoverMenu:l,onSubmit:c})=>{const u=Object(r.useMemo)((()=>e.map((e=>e._id))),[e]),p=Object(r.useMemo)((()=>Object(a.intersection)(...e.map((e=>{var t,n;return null!==(t=null===(n=e.data.find((e=>e.field===s.F)))||void 0===n?void 0:n.value)&&void 0!==t?t:[]})))),[e]),m=Object(r.useCallback)((()=>{t&&t(),o&&o()}),[o,t]),f=Object(r.useCallback)((async e=>{l(),c&&(l(),await c(e,u,m,n))}),[u,l,c,m,n]);return i.a.createElement("div",{"data-test-subj":"alert-assignees-selectable-menu"},i.a.createElement(d.a,{assignedUserIds:p,onApply:f}))},m=Object(r.memo)(p);var f=n(333),g=n(964);const b=({onAssigneesUpdate:e})=>{const t=Object(l.b)().isPlatinumPlus(),{hasIndexWrite:n}=Object(c.a)(),d=Object(g.a)(),p=Object(r.useCallback)((async(e,t,n,a)=>{d&&await d(e,t,n,a)}),[d]),b=Object(r.useCallback)((()=>{null==e||e()}),[e]),y=Object(r.useCallback)((async(e,t,n)=>{const r=e.map((e=>e._id)),i=Object(a.union)(...e.map((e=>{var t,n;return null!==(t=null===(n=e.data.find((e=>e.field===s.F)))||void 0===n?void 0:n.value)&&void 0!==t?t:[]})));if(!i.length)return;const o={add:[],remove:i};d&&await d(o,r,b,n)}),[b,d]),h=Object(r.useMemo)((()=>n&&t?[{key:"manage-alert-assignees","data-test-subj":"alert-assignees-context-menu-item",name:f.c,panel:2,label:f.c,disableOnQuery:!0},{key:"remove-all-alert-assignees","data-test-subj":"remove-alert-assignees-menu-item",name:f.s,label:f.s,disableOnQuery:!0,onClick:y}]:[]),[n,t,y]),v=Object(r.useMemo)((()=>i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(o.EuiFlexItem,{grow:!1},f.c))),[]),E=Object(r.useCallback)((({alertItems:e,refresh:t,setIsBulkActionsLoading:n,clearSelection:a,closePopoverMenu:r})=>i.a.createElement(m,{alertItems:e,refresh:()=>{b(),null==t||t()},setIsLoading:n,clearSelection:a,closePopoverMenu:r,onSubmit:p})),[p,b]),x=Object(r.useMemo)((()=>n&&t?[{id:2,title:v,"data-test-subj":"alert-assignees-context-menu-panel",renderContent:E,width:u.a}]:[]),[v,n,t,E]);return Object(r.useMemo)((()=>({alertAssigneesItems:h,alertAssigneesPanels:x})),[h,x])}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),r=n(1371);const i=a.exact(a.type({comment:r.a})),o=a.array(i),s=(a.union([o,a[void 0]]),new a.Type("DefaultCreateComments",a.array(i).is,(e=>null==e?a.success([]):a.array(i).decode(e)),a.identity))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n(2);var a=n(19),r=n(43),i=n(49);const o=Object(r.css)("border-bottom:1px solid ",i.euiThemeVars.euiColorLightShade,";",""),s=Object(r.css)("color:",i.euiThemeVars.euiColorPrimary,";flex-basis:content;",""),l=({dataTestSubj:e,linkedRules:t,securityLinkAnchorComponent:n,leftIcon:i=""})=>{if(!t.length||null===n)return null;const l=n;return t.map((n=>Object(r.jsx)(a.EuiContextMenuItem,{css:t.length>1?o:"","data-test-subj":`${e||""}ActionItem${n.id}`,key:n.id},Object(r.jsx)(a.EuiFlexGroup,{gutterSize:"s",css:s},i?Object(r.jsx)(a.EuiFlexItem,{"data-test-subj":`${e||""}LeftIcon`,grow:!1},Object(r.jsx)(a.EuiIcon,{type:i})):null,Object(r.jsx)(a.EuiFlexItem,{css:s},Object(r.jsx)(l,{external:!0,referenceName:n.name,referenceId:n.id}))))))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(19),r=n(128),i=n(2),o=n.n(i);const s=o.a.memo((({hoverContent:e,anchorPosition:t="downCenter",children:n})=>{const[s,l]=Object(i.useState)(null!=e),[c,u]=Object(i.useState)(!1),[,d]=Object(i.useState)(void 0),p=Object(i.useRef)(null),m=Object(i.useCallback)((()=>{d((e=>{clearTimeout(e)})),u(!1)}),[]),f=Object(i.useCallback)((()=>{d(Number(setTimeout((()=>{document.body.classList.contains(r.c)||u(!0)}),100)))}),[d,u]),g=Object(i.useCallback)((()=>{m()}),[m]),b=Object(i.useCallback)((e=>{s&&"Escape"===e.key&&g()}),[s,g]);return Object(i.useEffect)((()=>{l(null!=e&&c)}),[e,c]),Object(i.useEffect)((()=>{var e;s&&(null==p||null===(e=p.current)||void 0===e||e.positionPopoverFluid())}),[e,s]),o.a.createElement("div",{onMouseLeave:g},o.a.createElement(a.EuiPopover,{ref:p,anchorPosition:t,button:o.a.createElement("div",{"data-test-subj":"HoverPopoverButton",onMouseEnter:f},n),closePopover:m,hasArrow:!1,isOpen:s,ownFocus:!1,panelPaddingSize:"none",panelStyle:{minInlineSize:"fit-content"},panelClassName:"HoverPopover__popover",repositionOnScroll:!0},s?o.a.createElement("div",{onKeyDown:b},e):null))}));s.displayName="HoverPopover"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(118),i=n(128),o=n(64);const s=({closePopover:e,draggableId:t,fieldName:n,keyboardHandlerRef:s,openPopover:l})=>{const{timelines:c}=Object(r.j)().services,u=c.getUseAddToTimeline(),{beginDrag:d,cancelDrag:p,dragToLocation:m,endDrag:f,hasDraggableLock:g}=u({draggableId:t,fieldName:n}),[b,y]=Object(a.useState)(null),h=Object(a.useCallback)((()=>{y((e=>e?(p(e),null):null))}),[p]),v=Object(a.useCallback)((n=>{const a=document.querySelector(`[data-rbd-drag-handle-draggable-id="${t}"]`);var r;a&&((g()||!g()&&" "===n.key)&&(n.preventDefault(),n.stopPropagation()),(({beginDrag:e,cancelDragActions:t,closePopover:n,draggableElement:a,dragActions:r,dragToLocation:s,endDrag:l,keyboardEvent:c,openPopover:u,setDragActions:d})=>{let p=null;switch(c.key){case" ":r?(l(r),d(null)):(null!=n&&n(),d(e()));break;case"Escape":t();break;case"Tab":(e=>{const t=e.querySelectorAll("a, button");t.forEach((e=>{e.setAttribute("tabindex","-1")})),setTimeout((()=>{t.forEach((e=>{e.setAttribute("tabindex","0")}))}),0)})(a);break;case"ArrowUp":p=a.getBoundingClientRect(),s({dragActions:r,position:{x:p.x,y:p.y-i.e}});break;case"ArrowDown":p=a.getBoundingClientRect(),s({dragActions:r,position:{x:p.x,y:p.y+i.e}});break;case"ArrowLeft":p=a.getBoundingClientRect(),s({dragActions:r,position:{x:p.x-i.e,y:p.y}});break;case"ArrowRight":p=a.getBoundingClientRect(),s({dragActions:r,position:{x:p.x+i.e,y:p.y}});break;case"Enter":Object(o.stopPropagationAndPreventDefault)(c),r||null==u||u()}})({beginDrag:d,cancelDragActions:h,closePopover:e,dragActions:b,draggableElement:a,dragToLocation:m,endDrag:f,keyboardEvent:n,openPopover:l,setDragActions:y}),null===(r=s.current)||void 0===r||r.focus())}),[d,h,e,b,t,m,f,g,s,l,y]);return Object(a.useMemo)((()=>({onBlur:h,onKeyDown:v})),[h,v])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(119),r=n.n(a),i=n(2),o=n.n(i),s=n(19),l=n(41),c=n.n(l),u=n(42),d=n(50),p=n(126),m=n(182);const f=c.a.div.withConfig({displayName:"RootContainer",componentId:"sc-ptw6hp-0"})(["position:relative;padding-top:",";.body{min-height:",";&-content{position:relative;}}"],(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXXL)),g=Object(i.memo)((({"data-test-subj":e})=>o.a.createElement(s.EuiEmptyPrompt,{"data-test-subj":e,title:o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.endpoint.paginatedContent.noItemsFoundTitle",defaultMessage:"No items found"})})));g.displayName="DefaultNoItemsFound";const b=Object(i.memo)((({message:e,"data-test-subj":t})=>o.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiIcon,{type:"minusInCircle",color:"danger"})," ",e,o.a.createElement(s.EuiSpacer,{size:"m"}))));b.displayName="ErrorMessage";const y=Object(i.memo)((({items:e,ItemComponent:t,itemComponentProps:n,itemId:a,onChange:l,pagination:c,loading:u,noItemsMessage:y,error:h,contentClassName:v,"data-test-subj":E,"aria-label":x,className:j,CardDecorator:O,children:S})=>{const[w]=Object(i.useState)(new WeakMap),k=Object(p.a)(E),I=Object(i.useMemo)((()=>Math.ceil(((null==c?void 0:c.totalItemCount)||1)/((null==c?void 0:c.pageSize)||1))),[null==c?void 0:c.pageSize,null==c?void 0:c.totalItemCount]);Object(i.useEffect)((()=>{!u&&I>0&&I<((null==c?void 0:c.pageIndex)||0)+1&&l({pageIndex:I-1,pageSize:(null==c?void 0:c.pageSize)||0})}),[I,l,c,u]);const T=Object(i.useCallback)((e=>{if(null!=c&&c.pageIndex){var t,n;const a=Math.floor((null!==(t=null==c?void 0:c.pageIndex)&&void 0!==t?t:m.b)*(null!==(n=null==c?void 0:c.pageSize)&&void 0!==n?n:m.c)/e);l({pageSize:e,pageIndex:isNaN(a)?m.b:a})}else l({pageSize:e,pageIndex:m.b})}),[l,c]),C=Object(i.useCallback)((e=>{l({pageIndex:e,pageSize:(null==c?void 0:c.pageSize)||m.c})}),[l,null==c?void 0:c.pageSize]),M=Object(i.useMemo)((()=>{if(h)return h instanceof Error?o.a.createElement(b,{message:h.message,"data-test-subj":k("error")}):"string"==typeof h?o.a.createElement(b,{message:h,"data-test-subj":k("error")}):h;const i=t;return e.length?e.map((e=>{let t;return a?t=e[a]:w.has(e)?t=w.get(e):(t=Object(d.v4)(),w.set(e,t)),o.a.createElement(i,r()({},n(e),{key:t,Decorator:O}))})):u?void 0:y||o.a.createElement(g,{"data-test-subj":k("noResults")})}),[h,t,e,u,y,k,a,n,O,w]);return o.a.createElement(f,{"data-test-subj":E,"aria-label":x,className:j},u&&o.a.createElement(s.EuiProgress,{size:"xs",color:"primary",position:"absolute","data-test-subj":k("loader")}),o.a.createElement("div",{className:"body","data-test-subj":k("body")},o.a.createElement("div",{className:`body-content ${v}`},S||M)),c&&(S||e.length>0)&&o.a.createElement("div",{"data-test-subj":k("footer")},o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(s.EuiTablePagination,{activePage:c.pageIndex,itemsPerPage:c.pageSize,itemsPerPageOptions:c.pageSizeOptions,pageCount:I,showPerPageOptions:c.showPerPageOptions,onChangeItemsPerPage:T,onChangePage:C})))}));y.displayName="PaginatedContent"},,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterableComposition=void 0;var a=n(1278),r=n(798);t.getFilterableComposition=function(e,t){var n=a.getCompactableComposition(e,t),i={map:n.map,compact:n.compact,separate:n.separate,partitionMap:function(e,t){return{left:i.filterMap(e,(function(e){return r.getLeft(t(e))})),right:i.filterMap(e,(function(e){return r.getRight(t(e))}))}},partition:function(e,t){return{left:i.filter(e,(function(e){return!t(e)})),right:i.filter(e,t)}},filterMap:function(n,a){return e.map(n,(function(e){return t.filterMap(e,a)}))},filter:function(n,a){return e.map(n,(function(e){return t.filter(e,a)}))}};return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompactableComposition=void 0;var a=n(1279),r=n(798);t.getCompactableComposition=function(e,t){var n=a.getFunctorComposition(e,t),i={map:n.map,compact:function(n){return e.map(n,t.compact)},separate:function(e){return{left:i.compact(n.map(e,r.getLeft)),right:i.compact(n.map(e,r.getRight))}}};return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctorComposition=void 0,t.getFunctorComposition=function(e,t){return{map:function(n,a){return e.map(n,(function(e){return t.map(e,a)}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.bind=t.bindTo=t.never=t.taskSeq=t.task=t.Monad=t.ApplicativeSeq=t.ApplicativePar=t.Functor=t.getRaceMonoid=t.getMonoid=t.getSemigroup=t.URI=t.fromTask=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.chainIOK=t.fromIOK=t.delay=t.fromIO=void 0;var a=n(269);function r(e){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.fromIO(e.apply(void 0,n))}}t.fromIO=function(e){return function(){return Promise.resolve(e())}},t.delay=function(e){return function(t){return function(){return new Promise((function(n){setTimeout((function(){t().then(n)}),e)}))}}},t.fromIOK=r,t.chainIOK=function(e){return t.chain(r(e))};var i=function(e,n){return a.pipe(e,t.map(n))},o=function(e,n){return a.pipe(e,t.ap(n))},s=function(e,n){return a.pipe(e,t.chain((function(e){return a.pipe(n,t.map(e))})))},l=function(e,n){return a.pipe(e,t.chain(n))};function c(e){return{concat:function(t,n){return function(){return t().then((function(t){return n().then((function(n){return e.concat(t,n)}))}))}}}}t.map=function(e){return function(t){return function(){return t().then(e)}}},t.ap=function(e){return function(t){return function(){return Promise.all([t(),e()]).then((function(e){return(0,e[0])(e[1])}))}}},t.apFirst=function(e){return a.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return a.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=function(e){return function(){return Promise.resolve(e)}},t.chain=function(e){return function(t){return function(){return t().then((function(t){return e(t)()}))}}},t.chainFirst=function(e){return t.chain((function(n){return a.pipe(e(n),t.map((function(){return n})))}))},t.flatten=t.chain(a.identity),t.fromTask=a.identity,t.URI="Task",t.getSemigroup=c,t.getMonoid=function(e){return{concat:c(e).concat,empty:t.of(e.empty)}},t.getRaceMonoid=function(){return{concat:function(e,t){return function(){return Promise.race([e(),t()])}},empty:t.never}},t.Functor={URI:t.URI,map:i},t.ApplicativePar={URI:t.URI,map:i,ap:o,of:t.of},t.ApplicativeSeq={URI:t.URI,map:i,ap:s,of:t.of},t.Monad={URI:t.URI,map:i,of:t.of,ap:o,chain:l},t.task={URI:t.URI,map:i,of:t.of,ap:o,chain:l,fromIO:t.fromIO,fromTask:t.fromTask},t.taskSeq={URI:t.URI,map:i,of:t.of,ap:s,chain:l,fromIO:t.fromIO,fromTask:t.fromTask},t.never=function(){return new Promise((function(e){}))},t.bindTo=function(e){return t.map(a.bindTo_(e))},t.bind=function(e,n){return t.chain((function(r){return a.pipe(n(r),t.map((function(t){return a.bind_(r,e,t)})))}))},t.apS=function(e,n){return a.flow(t.map((function(t){return function(n){return a.bind_(t,e,n)}})),t.ap(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(46),r=n(1371),i=n(397),o=n(398),s=n(214),l=n(401),c=n(402);const u=a.intersection([a.exact(a.type({comment:r.a,created_at:i.a,created_by:o.a,id:s.a})),a.exact(a.partial({updated_at:l.a,updated_by:c.a}))]),d=a.array(u);a.union([d,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),r=n(1371),i=n(1283);const o=a.exact(a.type({entries:i.b,field:r.a,type:a.keyof({nested:null})}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n(46),r=n(801),i=n(876),o=n(802);const s=a.union([r.a,i.a,o.a]),l=a.array(s),c=new a.Type("NonEmptyNestedEntriesArray",l.is,((e,t)=>Array.isArray(e)&&0===e.length?a.failure(e,t):l.validate(e,t)),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const r=n(1531).a,i=a.union([r,a[void 0]])},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(119),r=n.n(a),i=n(19),o=(n(2),n(827)),s=n(43);const l=({user:e,avatar:t,...n})=>{const{euiTheme:a}=Object(i.useEuiTheme)();if(!e)return Object(s.jsx)(i.EuiAvatar,r()({name:"",color:a.colors.lightestShade,initials:"?"},n));const l=Object(o.d)(e);return null!=t&&t.imageUrl?Object(s.jsx)(i.EuiAvatar,r()({name:l,imageUrl:t.imageUrl,color:"plain"},n)):Object(s.jsx)(i.EuiAvatar,r()({name:l,initials:Object(o.c)(e,t),initialsLength:o.a,color:Object(o.b)(e,t)},n))}},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},,function(e,t,n){!function(e,t,n,a,r,i){"use strict";function o(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function s(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const l=Symbol("implicit");function c(){var e=new Map,t=[],n=[],a=l;function r(r){var i=r+"",o=e.get(i);if(!o){if(a!==l)return a;e.set(i,o=t.push(r))}return n[(o-1)%n.length]}return r.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of n){const n=a+"";e.has(n)||e.set(n,t.push(a))}return r},r.range=function(e){return arguments.length?(n=Array.from(e),r):n.slice()},r.unknown=function(e){return arguments.length?(a=e,r):a},r.copy=function(){return c(t,n).unknown(a)},o.apply(r,arguments),r}function u(){var e,n,a=c().unknown(void 0),r=a.domain,i=a.range,s=0,l=1,d=!1,p=0,m=0,f=.5;function g(){var a=r().length,o=l<s,c=o?l:s,u=o?s:l;e=(u-c)/Math.max(1,a-p+2*m),d&&(e=Math.floor(e)),c+=(u-c-e*(a-p))*f,n=e*(1-p),d&&(c=Math.round(c),n=Math.round(n));var g=t.range(a).map((function(t){return c+e*t}));return i(o?g.reverse():g)}return delete a.unknown,a.domain=function(e){return arguments.length?(r(e),g()):r()},a.range=function(e){return arguments.length?([s,l]=e,s=+s,l=+l,g()):[s,l]},a.rangeRound=function(e){return[s,l]=e,s=+s,l=+l,d=!0,g()},a.bandwidth=function(){return n},a.step=function(){return e},a.round=function(e){return arguments.length?(d=!!e,g()):d},a.padding=function(e){return arguments.length?(p=Math.min(1,m=+e),g()):p},a.paddingInner=function(e){return arguments.length?(p=Math.min(1,e),g()):p},a.paddingOuter=function(e){return arguments.length?(m=+e,g()):m},a.align=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),g()):f},a.copy=function(){return u(r(),[s,l]).round(d).paddingInner(p).paddingOuter(m).align(f)},o.apply(g(),arguments)}function d(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return d(t())},e}function p(e){return+e}var m=[0,1];function f(e){return e}function g(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function b(e,t,n){var a=e[0],r=e[1],i=t[0],o=t[1];return r<a?(a=g(r,a),i=n(o,i)):(a=g(a,r),i=n(i,o)),function(e){return i(a(e))}}function y(e,n,a){var r=Math.min(e.length,n.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++s<r;)i[s]=g(e[s],e[s+1]),o[s]=a(n[s],n[s+1]);return function(n){var a=t.bisect(e,n,1,r)-1;return o[a](i[a](n))}}function h(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function v(){var e,t,a,r,i,o,s=m,l=m,c=n.interpolate,u=f;function d(){var e,t,n,a=Math.min(s.length,l.length);return u!==f&&(e=s[0],t=s[a-1],e>t&&(n=e,e=t,t=n),u=function(n){return Math.max(e,Math.min(t,n))}),r=a>2?y:b,i=o=null,g}function g(t){return null==t||isNaN(t=+t)?a:(i||(i=r(s.map(e),l,c)))(e(u(t)))}return g.invert=function(a){return u(t((o||(o=r(l,s.map(e),n.interpolateNumber)))(a)))},g.domain=function(e){return arguments.length?(s=Array.from(e,p),d()):s.slice()},g.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},g.rangeRound=function(e){return l=Array.from(e),c=n.interpolateRound,d()},g.clamp=function(e){return arguments.length?(u=!!e||f,d()):u!==f},g.interpolate=function(e){return arguments.length?(c=e,d()):c},g.unknown=function(e){return arguments.length?(a=e,g):a},function(n,a){return e=n,t=a,d()}}function E(){return v()(f,f)}function x(e,n,r,i){var o,s=t.tickStep(e,n,r);switch((i=a.formatSpecifier(null==i?",f":i)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(n));return null!=i.precision||isNaN(o=a.precisionPrefix(s,l))||(i.precision=o),a.formatPrefix(i,l);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=a.precisionRound(s,Math.max(Math.abs(e),Math.abs(n))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=a.precisionFixed(s))||(i.precision=o-2*("%"===i.type))}return a.format(i)}function j(e){var n=e.domain;return e.ticks=function(e){var a=n();return t.ticks(a[0],a[a.length-1],null==e?10:e)},e.tickFormat=function(e,t){var a=n();return x(a[0],a[a.length-1],null==e?10:e,t)},e.nice=function(a){null==a&&(a=10);var r,i,o=n(),s=0,l=o.length-1,c=o[s],u=o[l],d=10;for(u<c&&(i=c,c=u,u=i,i=s,s=l,l=i);d-- >0;){if((i=t.tickIncrement(c,u,a))===r)return o[s]=c,o[l]=u,n(o);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function O(e,t){var n,a=0,r=(e=e.slice()).length-1,i=e[a],o=e[r];return o<i&&(n=a,a=r,r=n,n=i,i=o,o=n),e[a]=t.floor(i),e[r]=t.ceil(o),e}function S(e){return Math.log(e)}function w(e){return Math.exp(e)}function k(e){return-Math.log(-e)}function I(e){return-Math.exp(-e)}function T(e){return isFinite(e)?+("1e"+e):e<0?0:e}function C(e){return function(t){return-e(-t)}}function M(e){var n,r,i=e(S,w),o=i.domain,s=10;function l(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(s),r=function(e){return 10===e?T:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(s),o()[0]<0?(n=C(n),r=C(r),e(k,I)):e(S,w),i}return i.base=function(e){return arguments.length?(s=+e,l()):s},i.domain=function(e){return arguments.length?(o(e),l()):o()},i.ticks=function(e){var a,i=o(),l=i[0],c=i[i.length-1];(a=c<l)&&(m=l,l=c,c=m);var u,d,p,m=n(l),f=n(c),g=null==e?10:+e,b=[];if(!(s%1)&&f-m<g){if(m=Math.floor(m),f=Math.ceil(f),l>0){for(;m<=f;++m)for(d=1,u=r(m);d<s;++d)if(!((p=u*d)<l)){if(p>c)break;b.push(p)}}else for(;m<=f;++m)for(d=s-1,u=r(m);d>=1;--d)if(!((p=u*d)<l)){if(p>c)break;b.push(p)}2*b.length<g&&(b=t.ticks(l,c,g))}else b=t.ticks(m,f,Math.min(f-m,g)).map(r);return a?b.reverse():b},i.tickFormat=function(e,t){if(null==t&&(t=10===s?".0e":","),"function"!=typeof t&&(t=a.format(t)),e===1/0)return t;null==e&&(e=10);var o=Math.max(1,s*e/i.ticks().length);return function(e){var a=e/r(Math.round(n(e)));return a*s<s-.5&&(a*=s),a<=o?t(e):""}},i.nice=function(){return o(O(o(),{floor:function(e){return r(Math.floor(n(e)))},ceil:function(e){return r(Math.ceil(n(e)))}}))},i}function _(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function D(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function N(e){var t=1,n=e(_(t),D(t));return n.constant=function(n){return arguments.length?e(_(t=+n),D(t)):t},j(n)}function A(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function F(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function P(e){return e<0?-e*e:e*e}function R(e){var t=e(f,f),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(f,f):.5===n?e(F,P):e(A(n),A(1/n)):n},j(t)}function L(){var e=R(v());return e.copy=function(){return h(e,L()).exponent(e.exponent())},o.apply(e,arguments),e}function q(e){return Math.sign(e)*e*e}function z(e){return new Date(e)}function B(e){return e instanceof Date?+e:+new Date(+e)}function $(e,t,n,a,r,i,o,s,l,c){var u=E(),d=u.invert,p=u.domain,m=c(".%L"),f=c(":%S"),g=c("%I:%M"),b=c("%I %p"),y=c("%a %d"),v=c("%b %d"),x=c("%B"),j=c("%Y");function S(e){return(l(e)<e?m:s(e)<e?f:o(e)<e?g:i(e)<e?b:a(e)<e?r(e)<e?y:v:n(e)<e?x:j)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?p(Array.from(e,B)):p().map(z)},u.ticks=function(t){var n=p();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?S:c(t)},u.nice=function(e){var n=p();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?p(O(n,e)):u},u.copy=function(){return h(u,$(e,t,n,a,r,i,o,s,l,c))},u}function V(){var e,t,a,r,i,o=0,s=1,l=f,c=!1;function u(t){return null==t||isNaN(t=+t)?i:l(0===a?.5:(t=(r(t)-e)*a,c?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var n,a;return arguments.length?([n,a]=t,l=e(n,a),u):[l(0),l(1)]}}return u.domain=function(n){return arguments.length?([o,s]=n,e=r(o=+o),t=r(s=+s),a=e===t?0:1/(t-e),u):[o,s]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(l=e,u):l},u.range=d(n.interpolate),u.rangeRound=d(n.interpolateRound),u.unknown=function(e){return arguments.length?(i=e,u):i},function(n){return r=n,e=n(o),t=n(s),a=e===t?0:1/(t-e),u}}function U(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function G(){var e=R(V());return e.copy=function(){return U(e,G()).exponent(e.exponent())},s.apply(e,arguments)}function H(){var e,t,a,r,i,o,s,l=0,c=.5,u=1,d=1,p=f,m=!1;function g(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-t)*(d*e<d*t?r:i),p(m?Math.max(0,Math.min(1,e)):e))}function b(e){return function(t){var a,r,i;return arguments.length?([a,r,i]=t,p=n.piecewise(e,[a,r,i]),g):[p(0),p(.5),p(1)]}}return g.domain=function(n){return arguments.length?([l,c,u]=n,e=o(l=+l),t=o(c=+c),a=o(u=+u),r=e===t?0:.5/(t-e),i=t===a?0:.5/(a-t),d=t<e?-1:1,g):[l,c,u]},g.clamp=function(e){return arguments.length?(m=!!e,g):m},g.interpolator=function(e){return arguments.length?(p=e,g):p},g.range=b(n.interpolate),g.rangeRound=b(n.interpolateRound),g.unknown=function(e){return arguments.length?(s=e,g):s},function(n){return o=n,e=n(l),t=n(c),a=n(u),r=e===t?0:.5/(t-e),i=t===a?0:.5/(a-t),d=t<e?-1:1,g}}function W(){var e=R(H());return e.copy=function(){return U(e,W()).exponent(e.exponent())},s.apply(e,arguments)}e.scaleBand=u,e.scaleDiverging=function e(){var t=j(H()(f));return t.copy=function(){return U(t,e())},s.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=M(H()).domain([.1,1,10]);return t.copy=function(){return U(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleDivergingPow=W,e.scaleDivergingSqrt=function(){return W.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=N(H());return t.copy=function(){return U(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleIdentity=function e(t){var n;function a(e){return null==e||isNaN(e=+e)?n:e}return a.invert=a,a.domain=a.range=function(e){return arguments.length?(t=Array.from(e,p),a):t.slice()},a.unknown=function(e){return arguments.length?(n=e,a):n},a.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,p):[0,1],j(a)},e.scaleImplicit=l,e.scaleLinear=function e(){var t=E();return t.copy=function(){return h(t,e())},o.apply(t,arguments),j(t)},e.scaleLog=function e(){var t=M(v()).domain([1,10]);return t.copy=function(){return h(t,e()).base(t.base())},o.apply(t,arguments),t},e.scaleOrdinal=c,e.scalePoint=function(){return d(u.apply(null,arguments).paddingInner(1))},e.scalePow=L,e.scaleQuantile=function e(){var n,a=[],r=[],i=[];function s(){var e=0,n=Math.max(1,r.length);for(i=new Array(n-1);++e<n;)i[e-1]=t.quantileSorted(a,e/n);return l}function l(e){return null==e||isNaN(e=+e)?n:r[t.bisect(i,e)]}return l.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:a[0],t<i.length?i[t]:a[a.length-1]]},l.domain=function(e){if(!arguments.length)return a.slice();a=[];for(let t of e)null==t||isNaN(t=+t)||a.push(t);return a.sort(t.ascending),s()},l.range=function(e){return arguments.length?(r=Array.from(e),s()):r.slice()},l.unknown=function(e){return arguments.length?(n=e,l):n},l.quantiles=function(){return i.slice()},l.copy=function(){return e().domain(a).range(r).unknown(n)},o.apply(l,arguments)},e.scaleQuantize=function e(){var n,a=0,r=1,i=1,s=[.5],l=[0,1];function c(e){return null!=e&&e<=e?l[t.bisect(s,e,0,i)]:n}function u(){var e=-1;for(s=new Array(i);++e<i;)s[e]=((e+1)*r-(e-i)*a)/(i+1);return c}return c.domain=function(e){return arguments.length?([a,r]=e,a=+a,r=+r,u()):[a,r]},c.range=function(e){return arguments.length?(i=(l=Array.from(e)).length-1,u()):l.slice()},c.invertExtent=function(e){var t=l.indexOf(e);return t<0?[NaN,NaN]:t<1?[a,s[0]]:t>=i?[s[i-1],r]:[s[t-1],s[t]]},c.unknown=function(e){return arguments.length?(n=e,c):c},c.thresholds=function(){return s.slice()},c.copy=function(){return e().domain([a,r]).range(l).unknown(n)},o.apply(j(c),arguments)},e.scaleRadial=function e(){var t,n=E(),a=[0,1],r=!1;function i(e){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(n(e));return isNaN(a)?t:r?Math.round(a):a}return i.invert=function(e){return n.invert(q(e))},i.domain=function(e){return arguments.length?(n.domain(e),i):n.domain()},i.range=function(e){return arguments.length?(n.range((a=Array.from(e,p)).map(q)),i):a.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(r=!!e,i):r},i.clamp=function(e){return arguments.length?(n.clamp(e),i):n.clamp()},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e(n.domain(),a).round(r).clamp(n.clamp()).unknown(t)},o.apply(i,arguments),j(i)},e.scaleSequential=function e(){var t=j(V()(f));return t.copy=function(){return U(t,e())},s.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=M(V()).domain([1,10]);return t.copy=function(){return U(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleSequentialPow=G,e.scaleSequentialQuantile=function e(){var n=[],a=f;function r(e){if(null!=e&&!isNaN(e=+e))return a((t.bisect(n,e,1)-1)/(n.length-1))}return r.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(t.ascending),r},r.interpolator=function(e){return arguments.length?(a=e,r):a},r.range=function(){return n.map(((e,t)=>a(t/(n.length-1))))},r.quantiles=function(e){return Array.from({length:e+1},((a,r)=>t.quantile(n,r/e)))},r.copy=function(){return e(a).domain(n)},s.apply(r,arguments)},e.scaleSequentialSqrt=function(){return G.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=N(V());return t.copy=function(){return U(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleSqrt=function(){return L.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=N(v());return t.copy=function(){return h(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleThreshold=function e(){var n,a=[.5],r=[0,1],i=1;function s(e){return null!=e&&e<=e?r[t.bisect(a,e,0,i)]:n}return s.domain=function(e){return arguments.length?(a=Array.from(e),i=Math.min(a.length,r.length-1),s):a.slice()},s.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(a.length,r.length-1),s):r.slice()},s.invertExtent=function(e){var t=r.indexOf(e);return[a[t-1],a[t]]},s.unknown=function(e){return arguments.length?(n=e,s):n},s.copy=function(){return e().domain(a).range(r).unknown(n)},o.apply(s,arguments)},e.scaleTime=function(){return o.apply($(r.timeTicks,r.timeTickInterval,r.timeYear,r.timeMonth,r.timeWeek,r.timeDay,r.timeHour,r.timeMinute,r.timeSecond,i.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return o.apply($(r.utcTicks,r.utcTickInterval,r.utcYear,r.utcMonth,r.utcWeek,r.utcDay,r.utcHour,r.utcMinute,r.utcSecond,i.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(833),n(1297),n(1299),n(834),n(1300))},function(e,t,n){!function(e,t){"use strict";function n(e,t,n,a,r){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*a+o*r)/6}function a(e){var t=e.length-1;return function(a){var r=a<=0?a=0:a>=1?(a=1,t-1):Math.floor(a*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,l=r<t-1?e[r+2]:2*o-i;return n((a-r/t)*t,s,i,o,l)}}function r(e){var t=e.length;return function(a){var r=Math.floor(((a%=1)<0?++a:a)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],l=e[(r+2)%t];return n((a-r/t)*t,i,o,s,l)}}var i=e=>()=>e;function o(e,t){return function(n){return e+n*t}}function s(e,t){var n=t-e;return n?o(e,n>180||n<-180?n-360*Math.round(n/360):n):i(isNaN(e)?t:e)}function l(e){return 1==(e=+e)?c:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):i(isNaN(t)?n:t)}}function c(e,t){var n=t-e;return n?o(e,n):i(isNaN(e)?t:e)}var u=function e(n){var a=l(n);function r(e,n){var r=a((e=t.rgb(e)).r,(n=t.rgb(n)).r),i=a(e.g,n.g),o=a(e.b,n.b),s=c(e.opacity,n.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function d(e){return function(n){var a,r,i=n.length,o=new Array(i),s=new Array(i),l=new Array(i);for(a=0;a<i;++a)r=t.rgb(n[a]),o[a]=r.r||0,s[a]=r.g||0,l[a]=r.b||0;return o=e(o),s=e(s),l=e(l),r.opacity=1,function(e){return r.r=o(e),r.g=s(e),r.b=l(e),r+""}}}var p=d(a),m=d(r);function f(e,t){t||(t=[]);var n,a=e?Math.min(t.length,e.length):0,r=t.slice();return function(i){for(n=0;n<a;++n)r[n]=e[n]*(1-i)+t[n]*i;return r}}function g(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b(e,t){var n,a=t?t.length:0,r=e?Math.min(a,e.length):0,i=new Array(r),o=new Array(a);for(n=0;n<r;++n)i[n]=O(e[n],t[n]);for(;n<a;++n)o[n]=t[n];return function(e){for(n=0;n<r;++n)o[n]=i[n](e);return o}}function y(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function h(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function v(e,t){var n,a={},r={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?a[n]=O(e[n],t[n]):r[n]=t[n];return function(e){for(n in a)r[n]=a[n](e);return r}}var E=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(E.source,"g");function j(e,t){var n,a,r,i=E.lastIndex=x.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=E.exec(e))&&(a=x.exec(t));)(r=a.index)>i&&(r=t.slice(i,r),s[o]?s[o]+=r:s[++o]=r),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:h(n,a)})),i=x.lastIndex;return i<t.length&&(r=t.slice(i),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,a=0;a<t;++a)s[(n=l[a]).i]=n.x(e);return s.join("")})}function O(e,n){var a,r=typeof n;return null==n||"boolean"===r?i(n):("number"===r?h:"string"===r?(a=t.color(n))?(n=a,u):j:n instanceof t.color?u:n instanceof Date?y:g(n)?f:Array.isArray(n)?b:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?v:h)(e,n)}var S,w=180/Math.PI,k={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function I(e,t,n,a,r,i){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*a)&&(n-=e*l,a-=t*l),(s=Math.sqrt(n*n+a*a))&&(n/=s,a/=s,l/=s),e*a<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*w,skewX:Math.atan(l)*w,scaleX:o,scaleY:s}}function T(e,t,n,a){function r(e){return e.length?e.pop()+" ":""}return function(i,o){var s=[],l=[];return i=e(i),o=e(o),function(e,a,r,i,o,s){if(e!==r||a!==i){var l=o.push("translate(",null,t,null,n);s.push({i:l-4,x:h(e,r)},{i:l-2,x:h(a,i)})}else(r||i)&&o.push("translate("+r+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,s,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(r(n)+"rotate(",null,a)-2,x:h(e,t)})):t&&n.push(r(n)+"rotate("+t+a)}(i.rotate,o.rotate,s,l),function(e,t,n,i){e!==t?i.push({i:n.push(r(n)+"skewX(",null,a)-2,x:h(e,t)}):t&&n.push(r(n)+"skewX("+t+a)}(i.skewX,o.skewX,s,l),function(e,t,n,a,i,o){if(e!==n||t!==a){var s=i.push(r(i)+"scale(",null,",",null,")");o.push({i:s-4,x:h(e,n)},{i:s-2,x:h(t,a)})}else 1===n&&1===a||i.push(r(i)+"scale("+n+","+a+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,s,l),i=o=null,function(e){for(var t,n=-1,a=l.length;++n<a;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var C=T((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?k:I(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),M=T((function(e){return null==e?k:(S||(S=document.createElementNS("http://www.w3.org/2000/svg","g")),S.setAttribute("transform",e),(e=S.transform.baseVal.consolidate())?I((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):k)}),", ",")",")");function _(e){return((e=Math.exp(e))+1/e)/2}var D=function e(t,n,a){function r(e,r){var i,o,s=e[0],l=e[1],c=e[2],u=r[0],d=r[1],p=r[2],m=u-s,f=d-l,g=m*m+f*f;if(g<1e-12)o=Math.log(p/c)/t,i=function(e){return[s+e*m,l+e*f,c*Math.exp(t*e*o)]};else{var b=Math.sqrt(g),y=(p*p-c*c+a*g)/(2*c*n*b),h=(p*p-c*c-a*g)/(2*p*n*b),v=Math.log(Math.sqrt(y*y+1)-y),E=Math.log(Math.sqrt(h*h+1)-h);o=(E-v)/t,i=function(e){var a,r=e*o,i=_(v),u=c/(n*b)*(i*(a=t*r+v,((a=Math.exp(2*a))-1)/(a+1))-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+u*m,l+u*f,c*i/_(t*r+v)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return r.rho=function(t){var n=Math.max(.001,+t),a=n*n;return e(n,a,a*a)},r}(Math.SQRT2,2,4);function N(e){return function(n,a){var r=e((n=t.hsl(n)).h,(a=t.hsl(a)).h),i=c(n.s,a.s),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=r(e),n.s=i(e),n.l=o(e),n.opacity=s(e),n+""}}}var A=N(s),F=N(c);function P(e){return function(n,a){var r=e((n=t.hcl(n)).h,(a=t.hcl(a)).h),i=c(n.c,a.c),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=r(e),n.c=i(e),n.l=o(e),n.opacity=s(e),n+""}}}var R=P(s),L=P(c);function q(e){return function n(a){function r(n,r){var i=e((n=t.cubehelix(n)).h,(r=t.cubehelix(r)).h),o=c(n.s,r.s),s=c(n.l,r.l),l=c(n.opacity,r.opacity);return function(e){return n.h=i(e),n.s=o(e),n.l=s(Math.pow(e,a)),n.opacity=l(e),n+""}}return a=+a,r.gamma=n,r}(1)}var z=q(s),B=q(c);e.interpolate=O,e.interpolateArray=function(e,t){return(g(t)?f:b)(e,t)},e.interpolateBasis=a,e.interpolateBasisClosed=r,e.interpolateCubehelix=z,e.interpolateCubehelixLong=B,e.interpolateDate=y,e.interpolateDiscrete=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},e.interpolateHcl=R,e.interpolateHclLong=L,e.interpolateHsl=A,e.interpolateHslLong=F,e.interpolateHue=function(e,t){var n=s(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,n){var a=c((e=t.lab(e)).l,(n=t.lab(n)).l),r=c(e.a,n.a),i=c(e.b,n.b),o=c(e.opacity,n.opacity);return function(t){return e.l=a(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}},e.interpolateNumber=h,e.interpolateNumberArray=f,e.interpolateObject=v,e.interpolateRgb=u,e.interpolateRgbBasis=p,e.interpolateRgbBasisClosed=m,e.interpolateRound=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}},e.interpolateString=j,e.interpolateTransformCss=C,e.interpolateTransformSvg=M,e.interpolateZoom=D,e.piecewise=function(e,t){void 0===t&&(t=e,e=O);for(var n=0,a=t.length-1,r=t[0],i=new Array(a<0?0:a);n<a;)i[n]=e(r,r=t[++n]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return i[t](e-t)}},e.quantize=function(e,t){for(var n=new Array(t),a=0;a<t;++a)n[a]=e(a/(t-1));return n},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1298))},function(e,t,n){!function(e){"use strict";function t(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function n(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function a(){}var r=.7,i=1/r,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),p=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),f=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),g=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),b={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function h(){return this.rgb().formatRgb()}function v(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?E(t):3===n?new S(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new S(t[1],t[2],t[3],1):(t=d.exec(e))?new S(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?x(t[1],t[2],t[3],t[4]):(t=m.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=f.exec(e))?T(t[1],t[2]/100,t[3]/100,1):(t=g.exec(e))?T(t[1],t[2]/100,t[3]/100,t[4]):b.hasOwnProperty(e)?E(b[e]):"transparent"===e?new S(NaN,NaN,NaN,0):null}function E(e){return new S(e>>16&255,e>>8&255,255&e,1)}function x(e,t,n,a){return a<=0&&(e=t=n=NaN),new S(e,t,n,a)}function j(e){return e instanceof a||(e=v(e)),e?new S((e=e.rgb()).r,e.g,e.b,e.opacity):new S}function O(e,t,n,a){return 1===arguments.length?j(e):new S(e,t,n,null==a?1:a)}function S(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function w(){return"#"+I(this.r)+I(this.g)+I(this.b)}function k(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function I(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function T(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _(e,t,n,a)}function C(e){if(e instanceof _)return new _(e.h,e.s,e.l,e.opacity);if(e instanceof a||(e=v(e)),!e)return new _;if(e instanceof _)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,l=o-i,c=(o+i)/2;return l?(s=t===o?(n-r)/l+6*(n<r):n===o?(r-t)/l+2:(t-n)/l+4,l/=c<.5?o+i:2-o-i,s*=60):l=c>0&&c<1?0:s,new _(s,l,c,e.opacity)}function M(e,t,n,a){return 1===arguments.length?C(e):new _(e,t,n,null==a?1:a)}function _(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function D(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t(a,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHsl:function(){return C(this).formatHsl()},formatRgb:h,toString:h}),t(S,O,n(a,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new S(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new S(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w,formatHex:w,formatRgb:k,toString:k})),t(_,M,n(a,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new _(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new _(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,r=2*n-a;return new S(D(e>=240?e-240:e+120,r,a),D(e,r,a),D(e<120?e+240:e-120,r,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const N=Math.PI/180,A=180/Math.PI,F=.96422,P=1,R=.82521,L=4/29,q=6/29,z=3*q*q,B=q*q*q;function $(e){if(e instanceof U)return new U(e.l,e.a,e.b,e.opacity);if(e instanceof Z)return X(e);e instanceof S||(e=j(e));var t,n,a=Q(e.r),r=Q(e.g),i=Q(e.b),o=G((.2225045*a+.7168786*r+.0606169*i)/P);return a===r&&r===i?t=n=o:(t=G((.4360747*a+.3850649*r+.1430804*i)/F),n=G((.0139322*a+.0971045*r+.7141733*i)/R)),new U(116*o-16,500*(t-o),200*(o-n),e.opacity)}function V(e,t,n,a){return 1===arguments.length?$(e):new U(e,t,n,null==a?1:a)}function U(e,t,n,a){this.l=+e,this.a=+t,this.b=+n,this.opacity=+a}function G(e){return e>B?Math.pow(e,1/3):e/z+L}function H(e){return e>q?e*e*e:z*(e-L)}function W(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Q(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Y(e){if(e instanceof Z)return new Z(e.h,e.c,e.l,e.opacity);if(e instanceof U||(e=$(e)),0===e.a&&0===e.b)return new Z(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*A;return new Z(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function K(e,t,n,a){return 1===arguments.length?Y(e):new Z(e,t,n,null==a?1:a)}function Z(e,t,n,a){this.h=+e,this.c=+t,this.l=+n,this.opacity=+a}function X(e){if(isNaN(e.h))return new U(e.l,0,0,e.opacity);var t=e.h*N;return new U(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(U,V,n(a,{brighter:function(e){return new U(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new U(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new S(W(3.1338561*(t=F*H(t))-1.6168667*(e=P*H(e))-.4906146*(n=R*H(n))),W(-.9787684*t+1.9161415*e+.033454*n),W(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),t(Z,K,n(a,{brighter:function(e){return new Z(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Z(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return X(this).rgb()}}));var J=-.14861,ee=1.78277,te=-.29227,ne=-.90649,ae=1.97294,re=ae*ne,ie=ae*ee,oe=ee*te-ne*J;function se(e,t,n,a){return 1===arguments.length?function(e){if(e instanceof le)return new le(e.h,e.s,e.l,e.opacity);e instanceof S||(e=j(e));var t=e.r/255,n=e.g/255,a=e.b/255,r=(oe*a+re*t-ie*n)/(oe+re-ie),i=a-r,o=(ae*(n-r)-te*i)/ne,s=Math.sqrt(o*o+i*i)/(ae*r*(1-r)),l=s?Math.atan2(o,i)*A-120:NaN;return new le(l<0?l+360:l,s,r,e.opacity)}(e):new le(e,t,n,null==a?1:a)}function le(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}t(le,se,n(a,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new le(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new le(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*N,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),a=Math.cos(e),r=Math.sin(e);return new S(255*(t+n*(J*a+ee*r)),255*(t+n*(te*a+ne*r)),255*(t+n*(ae*a)),this.opacity)}})),e.color=v,e.cubehelix=se,e.gray=function(e,t){return new U(e,0,0,null==t?1:t)},e.hcl=K,e.hsl=M,e.lab=V,e.lch=function(e,t,n,a){return 1===arguments.length?Y(e):new Z(n,t,e,null==a?1:a)},e.rgb=O,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e){"use strict";function t(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function n(e){return(e=t(Math.abs(e)))?e[1]:NaN}var a,r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i(e){if(!(t=r.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function s(e,n){var a=t(e,n);if(!a)return e+"";var r=a[0],i=a[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}i.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>s(100*e,t),r:s,s:function(e,n){var r=t(e,n);if(!r)return e+"";var i=r[0],o=r[1],s=o-(a=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=i.length;return s===l?i:s>l?i+new Array(s-l+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,n+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c(e){return e}var u,d=Array.prototype.map,p=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,r,o=void 0===e.grouping||void 0===e.thousands?c:(t=d.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var a=e.length,i=[],o=0,s=t[0],l=0;a>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),i.push(e.substring(a-=s,a+s)),!((l+=s+1)>n));)s=t[o=(o+1)%t.length];return i.reverse().join(r)}),s=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",m=void 0===e.decimal?".":e.decimal+"",f=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(d.call(e.numerals,String)),g=void 0===e.percent?"%":e.percent+"",b=void 0===e.minus?"−":e.minus+"",y=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=i(e)).fill,n=e.align,r=e.sign,c=e.symbol,d=e.zero,h=e.width,v=e.comma,E=e.precision,x=e.trim,j=e.type;"n"===j?(v=!0,j="g"):l[j]||(void 0===E&&(E=12),x=!0,j="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var O="$"===c?s:"#"===c&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",S="$"===c?u:/[%p]/.test(j)?g:"",w=l[j],k=/[defgprs%]/.test(j);function I(e){var i,s,l,c=O,u=S;if("c"===j)u=w(e)+u,e="";else{var g=(e=+e)<0||1/e<0;if(e=isNaN(e)?y:w(Math.abs(e),E),x&&(e=function(e){e:for(var t,n=e.length,a=1,r=-1;a<n;++a)switch(e[a]){case".":r=t=a;break;case"0":0===r&&(r=a),t=a;break;default:if(!+e[a])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),g&&0==+e&&"+"!==r&&(g=!1),c=(g?"("===r?r:b:"-"===r||"("===r?"":r)+c,u=("s"===j?p[8+a/3]:"")+u+(g&&"("===r?")":""),k)for(i=-1,s=e.length;++i<s;)if(48>(l=e.charCodeAt(i))||l>57){u=(46===l?m+e.slice(i+1):e.slice(i))+u,e=e.slice(0,i);break}}v&&!d&&(e=o(e,1/0));var I=c.length+e.length+u.length,T=I<h?new Array(h-I+1).join(t):"";switch(v&&d&&(e=o(T+e,T.length?h-u.length:1/0),T=""),n){case"<":e=c+e+u+T;break;case"=":e=c+T+e+u;break;case"^":e=T.slice(0,I=T.length>>1)+c+e+u+T.slice(I);break;default:e=T+c+e+u}return f(e)}return E=void 0===E?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E)),I.toString=function(){return e+""},I}return{format:h,formatPrefix:function(e,t){var a=h(((e=i(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(n(t)/3))),o=Math.pow(10,-r),s=p[8+r/3];return function(e){return a(o*e)+s}}}}function f(t){return u=m(t),e.format=u.format,e.formatPrefix=u.formatPrefix,u}f({thousands:",",grouping:[3],currency:["$",""]}),e.FormatSpecifier=o,e.formatDefaultLocale=f,e.formatLocale=m,e.formatSpecifier=i,e.precisionFixed=function(e){return Math.max(0,-n(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(n(t)/3)))-n(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,n(t)-n(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e,t){"use strict";function n(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function r(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function i(e){var i=e.dateTime,o=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,p=e.months,H=e.shortMonths,pe=m(c),Se=f(c),we=m(u),ke=f(u),Ie=m(d),Te=f(d),Ce=m(p),Me=f(p),_e=m(H),De=f(H),Ne={a:function(e){return d[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return H[e.getMonth()]},B:function(e){return p[e.getMonth()]},c:null,d:F,e:F,f:z,g:Z,G:J,H:P,I:R,j:L,L:q,m:B,M:$,p:function(e){return c[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:je,s:Oe,S:V,u:U,U:G,V:W,w:Q,W:Y,x:null,X:null,y:K,Y:X,Z:ee,"%":xe},Ae={a:function(e){return d[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return H[e.getUTCMonth()]},B:function(e){return p[e.getUTCMonth()]},c:null,d:te,e:te,f:oe,g:ye,G:ve,H:ne,I:ae,j:re,L:ie,m:se,M:le,p:function(e){return c[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:je,s:Oe,S:ce,u:ue,U:de,V:me,w:fe,W:ge,x:null,X:null,y:be,Y:he,Z:Ee,"%":xe},Fe={a:function(e,t,n){var a=Ie.exec(t.slice(n));return a?(e.w=Te.get(a[0].toLowerCase()),n+a[0].length):-1},A:function(e,t,n){var a=we.exec(t.slice(n));return a?(e.w=ke.get(a[0].toLowerCase()),n+a[0].length):-1},b:function(e,t,n){var a=_e.exec(t.slice(n));return a?(e.m=De.get(a[0].toLowerCase()),n+a[0].length):-1},B:function(e,t,n){var a=Ce.exec(t.slice(n));return a?(e.m=Me.get(a[0].toLowerCase()),n+a[0].length):-1},c:function(e,t,n){return Le(e,i,t,n)},d:w,e:w,f:_,g:x,G:E,H:I,I:I,j:k,L:M,m:S,M:T,p:function(e,t,n){var a=pe.exec(t.slice(n));return a?(e.p=Se.get(a[0].toLowerCase()),n+a[0].length):-1},q:O,Q:N,s:A,S:C,u:b,U:y,V:h,w:g,W:v,x:function(e,t,n){return Le(e,o,t,n)},X:function(e,t,n){return Le(e,l,t,n)},y:x,Y:E,Z:j,"%":D};function Pe(e,t){return function(n){var a,r,i,o=[],l=-1,c=0,u=e.length;for(n instanceof Date||(n=new Date(+n));++l<u;)37===e.charCodeAt(l)&&(o.push(e.slice(c,l)),null!=(r=s[a=e.charAt(++l)])?a=e.charAt(++l):r="e"===a?" ":"0",(i=t[a])&&(a=i(n,r)),o.push(a),c=l+1);return o.push(e.slice(c,l)),o.join("")}}function Re(e,i){return function(o){var s,l,c=r(1900,void 0,1);if(Le(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(i&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(s=a(r(c.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(c.V-1)),c.y=s.getUTCFullYear(),c.m=s.getUTCMonth(),c.d=s.getUTCDate()+(c.w+6)%7):(l=(s=n(r(c.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(c.V-1)),c.y=s.getFullYear(),c.m=s.getMonth(),c.d=s.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?a(r(c.y,0,1)).getUTCDay():n(r(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,a(c)):n(c)}}function Le(e,t,n,a){for(var r,i,o=0,l=t.length,c=n.length;o<l;){if(a>=c)return-1;if(37===(r=t.charCodeAt(o++))){if(r=t.charAt(o++),!(i=Fe[r in s?t.charAt(o++):r])||(a=i(e,n,a))<0)return-1}else if(r!=n.charCodeAt(a++))return-1}return a}return Ne.x=Pe(o,Ne),Ne.X=Pe(l,Ne),Ne.c=Pe(i,Ne),Ae.x=Pe(o,Ae),Ae.X=Pe(l,Ae),Ae.c=Pe(i,Ae),{format:function(e){var t=Pe(e+="",Ne);return t.toString=function(){return e},t},parse:function(e){var t=Re(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Pe(e+="",Ae);return t.toString=function(){return e},t},utcParse:function(e){var t=Re(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,n){var a=e<0?"-":"",r=(a?-e:e)+"",i=r.length;return a+(i<n?new Array(n-i+1).join(t)+r:r)}function p(e){return e.replace(u,"\\$&")}function m(e){return new RegExp("^(?:"+e.map(p).join("|")+")","i")}function f(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function g(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function b(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function y(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function h(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function v(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function E(e,t,n){var a=l.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function x(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function j(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function O(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.q=3*a[0]-3,n+a[0].length):-1}function S(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function w(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function k(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function I(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function T(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function C(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function M(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function _(e,t,n){var a=l.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function D(e,t,n){var a=c.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function N(e,t,n){var a=l.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function A(e,t,n){var a=l.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function F(e,t){return d(e.getDate(),t,2)}function P(e,t){return d(e.getHours(),t,2)}function R(e,t){return d(e.getHours()%12||12,t,2)}function L(e,n){return d(1+t.timeDay.count(t.timeYear(e),e),n,3)}function q(e,t){return d(e.getMilliseconds(),t,3)}function z(e,t){return q(e,t)+"000"}function B(e,t){return d(e.getMonth()+1,t,2)}function $(e,t){return d(e.getMinutes(),t,2)}function V(e,t){return d(e.getSeconds(),t,2)}function U(e){var t=e.getDay();return 0===t?7:t}function G(e,n){return d(t.timeSunday.count(t.timeYear(e)-1,e),n,2)}function H(e){var n=e.getDay();return n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e)}function W(e,n){return e=H(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),n,2)}function Q(e){return e.getDay()}function Y(e,n){return d(t.timeMonday.count(t.timeYear(e)-1,e),n,2)}function K(e,t){return d(e.getFullYear()%100,t,2)}function Z(e,t){return d((e=H(e)).getFullYear()%100,t,2)}function X(e,t){return d(e.getFullYear()%1e4,t,4)}function J(e,n){var a=e.getDay();return d((e=a>=4||0===a?t.timeThursday(e):t.timeThursday.ceil(e)).getFullYear()%1e4,n,4)}function ee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function te(e,t){return d(e.getUTCDate(),t,2)}function ne(e,t){return d(e.getUTCHours(),t,2)}function ae(e,t){return d(e.getUTCHours()%12||12,t,2)}function re(e,n){return d(1+t.utcDay.count(t.utcYear(e),e),n,3)}function ie(e,t){return d(e.getUTCMilliseconds(),t,3)}function oe(e,t){return ie(e,t)+"000"}function se(e,t){return d(e.getUTCMonth()+1,t,2)}function le(e,t){return d(e.getUTCMinutes(),t,2)}function ce(e,t){return d(e.getUTCSeconds(),t,2)}function ue(e){var t=e.getUTCDay();return 0===t?7:t}function de(e,n){return d(t.utcSunday.count(t.utcYear(e)-1,e),n,2)}function pe(e){var n=e.getUTCDay();return n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e)}function me(e,n){return e=pe(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),n,2)}function fe(e){return e.getUTCDay()}function ge(e,n){return d(t.utcMonday.count(t.utcYear(e)-1,e),n,2)}function be(e,t){return d(e.getUTCFullYear()%100,t,2)}function ye(e,t){return d((e=pe(e)).getUTCFullYear()%100,t,2)}function he(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function ve(e,n){var a=e.getUTCDay();return d((e=a>=4||0===a?t.utcThursday(e):t.utcThursday.ceil(e)).getUTCFullYear()%1e4,n,4)}function Ee(){return"+0000"}function xe(){return"%"}function je(e){return+e}function Oe(e){return Math.floor(+e/1e3)}function Se(t){return o=i(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}Se({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var we="%Y-%m-%dT%H:%M:%S.%LZ";var ke=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(we);var Ie=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(we);e.isoFormat=ke,e.isoParse=Ie,e.timeFormatDefaultLocale=Se,e.timeFormatLocale=i,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(834))},function(e,t,n){"use strict";var a=n(1302),r=n(1303).remove,i={},o={},s={},l={},c={};function u(e){return String("000"+(e||"")).slice(-3)}function d(e){return s[e]}function p(e){return o[e]}function m(e){var t=u(e);return p(l[t])}function f(e){var t=u(e);return l[t]}function g(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return f(e);if(2===e.length)return e.toUpperCase();if(3===e.length)return d(e.toUpperCase())}if("number"==typeof e)return f(e)}a.forEach((function(e){var t=e;o[t[0]]=t[1],s[t[1]]=t[0],l[t[2]]=t[0],c[t[0]]=t[2]})),t.registerLocale=function(e){if(!e.locale)throw new TypeError("Missing localeData.locale");if(!e.countries)throw new TypeError("Missing localeData.countries");i[e.locale]=e.countries},t.alpha3ToAlpha2=d,t.alpha2ToAlpha3=p,t.alpha3ToNumeric=function(e){return c[d(e)]},t.alpha2ToNumeric=function(e){return c[e]},t.numericToAlpha3=m,t.numericToAlpha2=f,t.toAlpha3=function(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return m(e);if(2===e.length)return p(e.toUpperCase());if(3===e.length)return e.toUpperCase()}if("number"==typeof e)return m(e)},t.toAlpha2=g,t.getName=function(e,t){try{return i[t.toLowerCase()][g(e)]}catch(e){return}},t.getNames=function(e){var t=i[e.toLowerCase()];return void 0===t?{}:t},t.getAlpha2Code=function(e,t){try{var n,a=i[t.toLowerCase()];for(n in a)if(a.hasOwnProperty(n)&&a[n].toLowerCase()===e.toLowerCase())return n;return}catch(e){return}},t.getSimpleAlpha2Code=function(e,t){try{var n,a=i[t.toLowerCase()];for(n in a)if(a.hasOwnProperty(n)&&r(a[n].toLowerCase())===r(e.toLowerCase()))return n;return}catch(e){return}},t.getAlpha2Codes=function(){return o},t.getAlpha3Code=function(e,t){var n=this.getAlpha2Code(e,t);return n?this.toAlpha3(n):void 0},t.getSimpleAlpha3Code=function(e,t){var n=this.getSimpleAlpha2Code(e,t);return n?this.toAlpha3(n):void 0},t.getAlpha3Codes=function(){return s},t.getNumericCodes=function(){return l},t.langs=function(){return Object.keys(i)},t.isValid=function(e){if(!e)return!1;var t=e.toString().toUpperCase();return s.hasOwnProperty(t)||o.hasOwnProperty(t)||l.hasOwnProperty(t)}},function(e){e.exports=JSON.parse('[["AF","AFG","004","ISO 3166-2:AF"],["AX","ALA","248","ISO 3166-2:AX"],["AL","ALB","008","ISO 3166-2:AL"],["DZ","DZA","012","ISO 3166-2:DZ"],["AS","ASM","016","ISO 3166-2:AS"],["AD","AND","020","ISO 3166-2:AD"],["AO","AGO","024","ISO 3166-2:AO"],["AI","AIA","660","ISO 3166-2:AI"],["AQ","ATA","010","ISO 3166-2:AQ"],["AG","ATG","028","ISO 3166-2:AG"],["AR","ARG","032","ISO 3166-2:AR"],["AM","ARM","051","ISO 3166-2:AM"],["AW","ABW","533","ISO 3166-2:AW"],["AU","AUS","036","ISO 3166-2:AU"],["AT","AUT","040","ISO 3166-2:AT"],["AZ","AZE","031","ISO 3166-2:AZ"],["BS","BHS","044","ISO 3166-2:BS"],["BH","BHR","048","ISO 3166-2:BH"],["BD","BGD","050","ISO 3166-2:BD"],["BB","BRB","052","ISO 3166-2:BB"],["BY","BLR","112","ISO 3166-2:BY"],["BE","BEL","056","ISO 3166-2:BE"],["BZ","BLZ","084","ISO 3166-2:BZ"],["BJ","BEN","204","ISO 3166-2:BJ"],["BM","BMU","060","ISO 3166-2:BM"],["BT","BTN","064","ISO 3166-2:BT"],["BO","BOL","068","ISO 3166-2:BO"],["BQ","BES","535","ISO 3166-2:BQ"],["BA","BIH","070","ISO 3166-2:BA"],["BW","BWA","072","ISO 3166-2:BW"],["BV","BVT","074","ISO 3166-2:BV"],["BR","BRA","076","ISO 3166-2:BR"],["IO","IOT","086","ISO 3166-2:IO"],["BN","BRN","096","ISO 3166-2:BN"],["BG","BGR","100","ISO 3166-2:BG"],["BF","BFA","854","ISO 3166-2:BF"],["BI","BDI","108","ISO 3166-2:BI"],["KH","KHM","116","ISO 3166-2:KH"],["CM","CMR","120","ISO 3166-2:CM"],["CA","CAN","124","ISO 3166-2:CA"],["CV","CPV","132","ISO 3166-2:CV"],["KY","CYM","136","ISO 3166-2:KY"],["CF","CAF","140","ISO 3166-2:CF"],["TD","TCD","148","ISO 3166-2:TD"],["CL","CHL","152","ISO 3166-2:CL"],["CN","CHN","156","ISO 3166-2:CN"],["CX","CXR","162","ISO 3166-2:CX"],["CC","CCK","166","ISO 3166-2:CC"],["CO","COL","170","ISO 3166-2:CO"],["KM","COM","174","ISO 3166-2:KM"],["CG","COG","178","ISO 3166-2:CG"],["CD","COD","180","ISO 3166-2:CD"],["CK","COK","184","ISO 3166-2:CK"],["CR","CRI","188","ISO 3166-2:CR"],["CI","CIV","384","ISO 3166-2:CI"],["HR","HRV","191","ISO 3166-2:HR"],["CU","CUB","192","ISO 3166-2:CU"],["CW","CUW","531","ISO 3166-2:CW"],["CY","CYP","196","ISO 3166-2:CY"],["CZ","CZE","203","ISO 3166-2:CZ"],["DK","DNK","208","ISO 3166-2:DK"],["DJ","DJI","262","ISO 3166-2:DJ"],["DM","DMA","212","ISO 3166-2:DM"],["DO","DOM","214","ISO 3166-2:DO"],["EC","ECU","218","ISO 3166-2:EC"],["EG","EGY","818","ISO 3166-2:EG"],["SV","SLV","222","ISO 3166-2:SV"],["GQ","GNQ","226","ISO 3166-2:GQ"],["ER","ERI","232","ISO 3166-2:ER"],["EE","EST","233","ISO 3166-2:EE"],["ET","ETH","231","ISO 3166-2:ET"],["FK","FLK","238","ISO 3166-2:FK"],["FO","FRO","234","ISO 3166-2:FO"],["FJ","FJI","242","ISO 3166-2:FJ"],["FI","FIN","246","ISO 3166-2:FI"],["FR","FRA","250","ISO 3166-2:FR"],["GF","GUF","254","ISO 3166-2:GF"],["PF","PYF","258","ISO 3166-2:PF"],["TF","ATF","260","ISO 3166-2:TF"],["GA","GAB","266","ISO 3166-2:GA"],["GM","GMB","270","ISO 3166-2:GM"],["GE","GEO","268","ISO 3166-2:GE"],["DE","DEU","276","ISO 3166-2:DE"],["GH","GHA","288","ISO 3166-2:GH"],["GI","GIB","292","ISO 3166-2:GI"],["GR","GRC","300","ISO 3166-2:GR"],["GL","GRL","304","ISO 3166-2:GL"],["GD","GRD","308","ISO 3166-2:GD"],["GP","GLP","312","ISO 3166-2:GP"],["GU","GUM","316","ISO 3166-2:GU"],["GT","GTM","320","ISO 3166-2:GT"],["GG","GGY","831","ISO 3166-2:GG"],["GN","GIN","324","ISO 3166-2:GN"],["GW","GNB","624","ISO 3166-2:GW"],["GY","GUY","328","ISO 3166-2:GY"],["HT","HTI","332","ISO 3166-2:HT"],["HM","HMD","334","ISO 3166-2:HM"],["VA","VAT","336","ISO 3166-2:VA"],["HN","HND","340","ISO 3166-2:HN"],["HK","HKG","344","ISO 3166-2:HK"],["HU","HUN","348","ISO 3166-2:HU"],["IS","ISL","352","ISO 3166-2:IS"],["IN","IND","356","ISO 3166-2:IN"],["ID","IDN","360","ISO 3166-2:ID"],["IR","IRN","364","ISO 3166-2:IR"],["IQ","IRQ","368","ISO 3166-2:IQ"],["IE","IRL","372","ISO 3166-2:IE"],["IM","IMN","833","ISO 3166-2:IM"],["IL","ISR","376","ISO 3166-2:IL"],["IT","ITA","380","ISO 3166-2:IT"],["JM","JAM","388","ISO 3166-2:JM"],["JP","JPN","392","ISO 3166-2:JP"],["JE","JEY","832","ISO 3166-2:JE"],["JO","JOR","400","ISO 3166-2:JO"],["KZ","KAZ","398","ISO 3166-2:KZ"],["KE","KEN","404","ISO 3166-2:KE"],["KI","KIR","296","ISO 3166-2:KI"],["KP","PRK","408","ISO 3166-2:KP"],["KR","KOR","410","ISO 3166-2:KR"],["KW","KWT","414","ISO 3166-2:KW"],["KG","KGZ","417","ISO 3166-2:KG"],["LA","LAO","418","ISO 3166-2:LA"],["LV","LVA","428","ISO 3166-2:LV"],["LB","LBN","422","ISO 3166-2:LB"],["LS","LSO","426","ISO 3166-2:LS"],["LR","LBR","430","ISO 3166-2:LR"],["LY","LBY","434","ISO 3166-2:LY"],["LI","LIE","438","ISO 3166-2:LI"],["LT","LTU","440","ISO 3166-2:LT"],["LU","LUX","442","ISO 3166-2:LU"],["MO","MAC","446","ISO 3166-2:MO"],["MK","MKD","807","ISO 3166-2:MK"],["MG","MDG","450","ISO 3166-2:MG"],["MW","MWI","454","ISO 3166-2:MW"],["MY","MYS","458","ISO 3166-2:MY"],["MV","MDV","462","ISO 3166-2:MV"],["ML","MLI","466","ISO 3166-2:ML"],["MT","MLT","470","ISO 3166-2:MT"],["MH","MHL","584","ISO 3166-2:MH"],["MQ","MTQ","474","ISO 3166-2:MQ"],["MR","MRT","478","ISO 3166-2:MR"],["MU","MUS","480","ISO 3166-2:MU"],["YT","MYT","175","ISO 3166-2:YT"],["MX","MEX","484","ISO 3166-2:MX"],["FM","FSM","583","ISO 3166-2:FM"],["MD","MDA","498","ISO 3166-2:MD"],["MC","MCO","492","ISO 3166-2:MC"],["MN","MNG","496","ISO 3166-2:MN"],["ME","MNE","499","ISO 3166-2:ME"],["MS","MSR","500","ISO 3166-2:MS"],["MA","MAR","504","ISO 3166-2:MA"],["MZ","MOZ","508","ISO 3166-2:MZ"],["MM","MMR","104","ISO 3166-2:MM"],["NA","NAM","516","ISO 3166-2:NA"],["NR","NRU","520","ISO 3166-2:NR"],["NP","NPL","524","ISO 3166-2:NP"],["NL","NLD","528","ISO 3166-2:NL"],["NC","NCL","540","ISO 3166-2:NC"],["NZ","NZL","554","ISO 3166-2:NZ"],["NI","NIC","558","ISO 3166-2:NI"],["NE","NER","562","ISO 3166-2:NE"],["NG","NGA","566","ISO 3166-2:NG"],["NU","NIU","570","ISO 3166-2:NU"],["NF","NFK","574","ISO 3166-2:NF"],["MP","MNP","580","ISO 3166-2:MP"],["NO","NOR","578","ISO 3166-2:NO"],["OM","OMN","512","ISO 3166-2:OM"],["PK","PAK","586","ISO 3166-2:PK"],["PW","PLW","585","ISO 3166-2:PW"],["PS","PSE","275","ISO 3166-2:PS"],["PA","PAN","591","ISO 3166-2:PA"],["PG","PNG","598","ISO 3166-2:PG"],["PY","PRY","600","ISO 3166-2:PY"],["PE","PER","604","ISO 3166-2:PE"],["PH","PHL","608","ISO 3166-2:PH"],["PN","PCN","612","ISO 3166-2:PN"],["PL","POL","616","ISO 3166-2:PL"],["PT","PRT","620","ISO 3166-2:PT"],["PR","PRI","630","ISO 3166-2:PR"],["QA","QAT","634","ISO 3166-2:QA"],["RE","REU","638","ISO 3166-2:RE"],["RO","ROU","642","ISO 3166-2:RO"],["RU","RUS","643","ISO 3166-2:RU"],["RW","RWA","646","ISO 3166-2:RW"],["BL","BLM","652","ISO 3166-2:BL"],["SH","SHN","654","ISO 3166-2:SH"],["KN","KNA","659","ISO 3166-2:KN"],["LC","LCA","662","ISO 3166-2:LC"],["MF","MAF","663","ISO 3166-2:MF"],["PM","SPM","666","ISO 3166-2:PM"],["VC","VCT","670","ISO 3166-2:VC"],["WS","WSM","882","ISO 3166-2:WS"],["SM","SMR","674","ISO 3166-2:SM"],["ST","STP","678","ISO 3166-2:ST"],["SA","SAU","682","ISO 3166-2:SA"],["SN","SEN","686","ISO 3166-2:SN"],["RS","SRB","688","ISO 3166-2:RS"],["SC","SYC","690","ISO 3166-2:SC"],["SL","SLE","694","ISO 3166-2:SL"],["SG","SGP","702","ISO 3166-2:SG"],["SX","SXM","534","ISO 3166-2:SX"],["SK","SVK","703","ISO 3166-2:SK"],["SI","SVN","705","ISO 3166-2:SI"],["SB","SLB","090","ISO 3166-2:SB"],["SO","SOM","706","ISO 3166-2:SO"],["ZA","ZAF","710","ISO 3166-2:ZA"],["GS","SGS","239","ISO 3166-2:GS"],["SS","SSD","728","ISO 3166-2:SS"],["ES","ESP","724","ISO 3166-2:ES"],["LK","LKA","144","ISO 3166-2:LK"],["SD","SDN","729","ISO 3166-2:SD"],["SR","SUR","740","ISO 3166-2:SR"],["SJ","SJM","744","ISO 3166-2:SJ"],["SZ","SWZ","748","ISO 3166-2:SZ"],["SE","SWE","752","ISO 3166-2:SE"],["CH","CHE","756","ISO 3166-2:CH"],["SY","SYR","760","ISO 3166-2:SY"],["TW","TWN","158","ISO 3166-2:TW"],["TJ","TJK","762","ISO 3166-2:TJ"],["TZ","TZA","834","ISO 3166-2:TZ"],["TH","THA","764","ISO 3166-2:TH"],["TL","TLS","626","ISO 3166-2:TL"],["TG","TGO","768","ISO 3166-2:TG"],["TK","TKL","772","ISO 3166-2:TK"],["TO","TON","776","ISO 3166-2:TO"],["TT","TTO","780","ISO 3166-2:TT"],["TN","TUN","788","ISO 3166-2:TN"],["TR","TUR","792","ISO 3166-2:TR"],["TM","TKM","795","ISO 3166-2:TM"],["TC","TCA","796","ISO 3166-2:TC"],["TV","TUV","798","ISO 3166-2:TV"],["UG","UGA","800","ISO 3166-2:UG"],["UA","UKR","804","ISO 3166-2:UA"],["AE","ARE","784","ISO 3166-2:AE"],["GB","GBR","826","ISO 3166-2:GB"],["US","USA","840","ISO 3166-2:US"],["UM","UMI","581","ISO 3166-2:UM"],["UY","URY","858","ISO 3166-2:UY"],["UZ","UZB","860","ISO 3166-2:UZ"],["VU","VUT","548","ISO 3166-2:VU"],["VE","VEN","862","ISO 3166-2:VE"],["VN","VNM","704","ISO 3166-2:VN"],["VG","VGB","092","ISO 3166-2:VG"],["VI","VIR","850","ISO 3166-2:VI"],["WF","WLF","876","ISO 3166-2:WF"],["EH","ESH","732","ISO 3166-2:EH"],["YE","YEM","887","ISO 3166-2:YE"],["ZM","ZMB","894","ISO 3166-2:ZM"],["ZW","ZWE","716","ISO 3166-2:ZW"],["XK","XKX","","ISO 3166-2:XK"]]')},function(e,t){t.remove=function(e){return e.replace(/[^\u0000-\u007e]/g,(function(e){return a[e]||e}))};for(var n=[{base:" ",chars:" "},{base:"0",chars:"߀"},{base:"A",chars:"ⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",chars:"Ꜳ"},{base:"AE",chars:"ÆǼǢ"},{base:"AO",chars:"Ꜵ"},{base:"AU",chars:"Ꜷ"},{base:"AV",chars:"ꜸꜺ"},{base:"AY",chars:"Ꜽ"},{base:"B",chars:"ⒷＢḂḄḆɃƁ"},{base:"C",chars:"ⒸＣꜾḈĆCĈĊČÇƇȻ"},{base:"D",chars:"ⒹＤḊĎḌḐḒḎĐƊƉᴅꝹ"},{base:"Dh",chars:"Ð"},{base:"DZ",chars:"ǱǄ"},{base:"Dz",chars:"ǲǅ"},{base:"E",chars:"ɛⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎᴇ"},{base:"F",chars:"ꝼⒻＦḞƑꝻ"},{base:"G",chars:"ⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾɢ"},{base:"H",chars:"ⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",chars:"ⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",chars:"ⒿＪĴɈȷ"},{base:"K",chars:"ⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",chars:"ⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",chars:"Ǉ"},{base:"Lj",chars:"ǈ"},{base:"M",chars:"ⓂＭḾṀṂⱮƜϻ"},{base:"N",chars:"ꞤȠⓃＮǸŃÑṄŇṆŅṊṈƝꞐᴎ"},{base:"NJ",chars:"Ǌ"},{base:"Nj",chars:"ǋ"},{base:"O",chars:"ⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OE",chars:"Œ"},{base:"OI",chars:"Ƣ"},{base:"OO",chars:"Ꝏ"},{base:"OU",chars:"Ȣ"},{base:"P",chars:"ⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",chars:"ⓆＱꝖꝘɊ"},{base:"R",chars:"ⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",chars:"ⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",chars:"ⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"Th",chars:"Þ"},{base:"TZ",chars:"Ꜩ"},{base:"U",chars:"ⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",chars:"ⓋＶṼṾƲꝞɅ"},{base:"VY",chars:"Ꝡ"},{base:"W",chars:"ⓌＷẀẂŴẆẄẈⱲ"},{base:"X",chars:"ⓍＸẊẌ"},{base:"Y",chars:"ⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",chars:"ⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",chars:"ⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑ"},{base:"aa",chars:"ꜳ"},{base:"ae",chars:"æǽǣ"},{base:"ao",chars:"ꜵ"},{base:"au",chars:"ꜷ"},{base:"av",chars:"ꜹꜻ"},{base:"ay",chars:"ꜽ"},{base:"b",chars:"ⓑｂḃḅḇƀƃɓƂ"},{base:"c",chars:"ｃⓒćĉċčçḉƈȼꜿↄ"},{base:"d",chars:"ⓓｄḋďḍḑḓḏđƌɖɗƋᏧԁꞪ"},{base:"dh",chars:"ð"},{base:"dz",chars:"ǳǆ"},{base:"e",chars:"ⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇǝ"},{base:"f",chars:"ⓕｆḟƒ"},{base:"ff",chars:"ﬀ"},{base:"fi",chars:"ﬁ"},{base:"fl",chars:"ﬂ"},{base:"ffi",chars:"ﬃ"},{base:"ffl",chars:"ﬄ"},{base:"g",chars:"ⓖｇǵĝḡğġǧģǥɠꞡꝿᵹ"},{base:"h",chars:"ⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",chars:"ƕ"},{base:"i",chars:"ⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",chars:"ⓙｊĵǰɉ"},{base:"k",chars:"ⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",chars:"ⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇɭ"},{base:"lj",chars:"ǉ"},{base:"m",chars:"ⓜｍḿṁṃɱɯ"},{base:"n",chars:"ⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥлԉ"},{base:"nj",chars:"ǌ"},{base:"o",chars:"ⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿꝋꝍɵɔᴑ"},{base:"oe",chars:"œ"},{base:"oi",chars:"ƣ"},{base:"oo",chars:"ꝏ"},{base:"ou",chars:"ȣ"},{base:"p",chars:"ⓟｐṕṗƥᵽꝑꝓꝕρ"},{base:"q",chars:"ⓠｑɋꝗꝙ"},{base:"r",chars:"ⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",chars:"ⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛʂ"},{base:"ss",chars:"ß"},{base:"t",chars:"ⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"th",chars:"þ"},{base:"tz",chars:"ꜩ"},{base:"u",chars:"ⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",chars:"ⓥｖṽṿʋꝟʌ"},{base:"vy",chars:"ꝡ"},{base:"w",chars:"ⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",chars:"ⓧｘẋẍ"},{base:"y",chars:"ⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",chars:"ⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],a={},r=0;r<n.length;r+=1)for(var i=n[r].chars,o=0;o<i.length;o+=1)a[i[o]]=n[r].base;t.replacementList=n,t.diacriticsMap=a},function(e){e.exports=JSON.parse('{"locale":"en","countries":{"AF":"Afghanistan","AL":"Albania","DZ":"Algeria","AS":"American Samoa","AD":"Andorra","AO":"Angola","AI":"Anguilla","AQ":"Antarctica","AG":"Antigua and Barbuda","AR":"Argentina","AM":"Armenia","AW":"Aruba","AU":"Australia","AT":"Austria","AZ":"Azerbaijan","BS":"Bahamas","BH":"Bahrain","BD":"Bangladesh","BB":"Barbados","BY":"Belarus","BE":"Belgium","BZ":"Belize","BJ":"Benin","BM":"Bermuda","BT":"Bhutan","BO":"Bolivia","BA":"Bosnia and Herzegovina","BW":"Botswana","BV":"Bouvet Island","BR":"Brazil","IO":"British Indian Ocean Territory","BN":"Brunei Darussalam","BG":"Bulgaria","BF":"Burkina Faso","BI":"Burundi","KH":"Cambodia","CM":"Cameroon","CA":"Canada","CV":"Cape Verde","KY":"Cayman Islands","CF":"Central African Republic","TD":"Chad","CL":"Chile","CN":"China","CX":"Christmas Island","CC":"Cocos (Keeling) Islands","CO":"Colombia","KM":"Comoros","CG":"Congo","CD":"Congo, the Democratic Republic of the","CK":"Cook Islands","CR":"Costa Rica","CI":"Cote D\'Ivoire","HR":"Croatia","CU":"Cuba","CY":"Cyprus","CZ":"Czech Republic","DK":"Denmark","DJ":"Djibouti","DM":"Dominica","DO":"Dominican Republic","EC":"Ecuador","EG":"Egypt","SV":"El Salvador","GQ":"Equatorial Guinea","ER":"Eritrea","EE":"Estonia","ET":"Ethiopia","FK":"Falkland Islands (Malvinas)","FO":"Faroe Islands","FJ":"Fiji","FI":"Finland","FR":"France","GF":"French Guiana","PF":"French Polynesia","TF":"French Southern Territories","GA":"Gabon","GM":"Gambia","GE":"Georgia","DE":"Germany","GH":"Ghana","GI":"Gibraltar","GR":"Greece","GL":"Greenland","GD":"Grenada","GP":"Guadeloupe","GU":"Guam","GT":"Guatemala","GN":"Guinea","GW":"Guinea-Bissau","GY":"Guyana","HT":"Haiti","HM":"Heard Island and Mcdonald Islands","VA":"Holy See (Vatican City State)","HN":"Honduras","HK":"Hong Kong","HU":"Hungary","IS":"Iceland","IN":"India","ID":"Indonesia","IR":"Iran, Islamic Republic of","IQ":"Iraq","IE":"Ireland","IL":"Israel","IT":"Italy","JM":"Jamaica","JP":"Japan","JO":"Jordan","KZ":"Kazakhstan","KE":"Kenya","KI":"Kiribati","KP":"North Korea","KR":"South Korea","KW":"Kuwait","KG":"Kyrgyzstan","LA":"Lao People\'s Democratic Republic","LV":"Latvia","LB":"Lebanon","LS":"Lesotho","LR":"Liberia","LY":"Libya","LI":"Liechtenstein","LT":"Lithuania","LU":"Luxembourg","MO":"Macao","MG":"Madagascar","MW":"Malawi","MY":"Malaysia","MV":"Maldives","ML":"Mali","MT":"Malta","MH":"Marshall Islands","MQ":"Martinique","MR":"Mauritania","MU":"Mauritius","YT":"Mayotte","MX":"Mexico","FM":"Micronesia, Federated States of","MD":"Moldova, Republic of","MC":"Monaco","MN":"Mongolia","MS":"Montserrat","MA":"Morocco","MZ":"Mozambique","MM":"Myanmar","NA":"Namibia","NR":"Nauru","NP":"Nepal","NL":"Netherlands","NC":"New Caledonia","NZ":"New Zealand","NI":"Nicaragua","NE":"Niger","NG":"Nigeria","NU":"Niue","NF":"Norfolk Island","MK":"North Macedonia, Republic of","MP":"Northern Mariana Islands","NO":"Norway","OM":"Oman","PK":"Pakistan","PW":"Palau","PS":"Palestinian Territory, Occupied","PA":"Panama","PG":"Papua New Guinea","PY":"Paraguay","PE":"Peru","PH":"Philippines","PN":"Pitcairn","PL":"Poland","PT":"Portugal","PR":"Puerto Rico","QA":"Qatar","RE":"Reunion","RO":"Romania","RU":"Russian Federation","RW":"Rwanda","SH":"Saint Helena","KN":"Saint Kitts and Nevis","LC":"Saint Lucia","PM":"Saint Pierre and Miquelon","VC":"Saint Vincent and the Grenadines","WS":"Samoa","SM":"San Marino","ST":"Sao Tome and Principe","SA":"Saudi Arabia","SN":"Senegal","SC":"Seychelles","SL":"Sierra Leone","SG":"Singapore","SK":"Slovakia","SI":"Slovenia","SB":"Solomon Islands","SO":"Somalia","ZA":"South Africa","GS":"South Georgia and the South Sandwich Islands","ES":"Spain","LK":"Sri Lanka","SD":"Sudan","SR":"Suriname","SJ":"Svalbard and Jan Mayen","SZ":"Swaziland","SE":"Sweden","CH":"Switzerland","SY":"Syrian Arab Republic","TW":"Taiwan","TJ":"Tajikistan","TZ":"Tanzania, United Republic of","TH":"Thailand","TL":"Timor-Leste","TG":"Togo","TK":"Tokelau","TO":"Tonga","TT":"Trinidad and Tobago","TN":"Tunisia","TR":"Turkey","TM":"Turkmenistan","TC":"Turks and Caicos Islands","TV":"Tuvalu","UG":"Uganda","UA":"Ukraine","AE":"United Arab Emirates","GB":"United Kingdom","US":"United States of America","UM":"United States Minor Outlying Islands","UY":"Uruguay","UZ":"Uzbekistan","VU":"Vanuatu","VE":"Venezuela","VN":"Viet Nam","VG":"Virgin Islands, British","VI":"Virgin Islands, U.S.","WF":"Wallis and Futuna","EH":"Western Sahara","YE":"Yemen","ZM":"Zambia","ZW":"Zimbabwe","AX":"Åland Islands","BQ":"Bonaire, Sint Eustatius and Saba","CW":"Curaçao","GG":"Guernsey","IM":"Isle of Man","JE":"Jersey","ME":"Montenegro","BL":"Saint Barthélemy","MF":"Saint Martin (French part)","RS":"Serbia","SX":"Sint Maarten (Dutch part)","SS":"South Sudan","XK":"Kosovo"}}')},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"}),i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showOnlyThreatIndicatorAlerts",{defaultMessage:"Show only threat indicator alerts"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n(66),i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)},l={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},c={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},u={width:"20px",height:"20px",position:"absolute"},d={top:s(s({},l),{top:"-5px"}),right:s(s({},c),{left:void 0,right:"-5px"}),bottom:s(s({},l),{top:void 0,bottom:"-5px"}),left:s(s({},c),{left:"-5px"}),topRight:s(s({},u),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:s(s({},u),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:s(s({},u),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:s(s({},u),{left:"-10px",top:"-10px",cursor:"nw-resize"})},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return o(t,e),t.prototype.render=function(){return a.createElement("div",{className:this.props.className||"",style:s(s({position:"absolute",userSelect:"none"},d[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(a.PureComponent),m={width:"auto",height:"auto"},f=function(e,t,n){return Math.max(Math.min(e,n),t)},g=function(e,t){return Math.round(e/t)*t},b=function(e,t){return new RegExp(e,"i").test(t)},y=function(e){return Boolean(e.touches&&e.touches.length)},h=function(e,t,n){void 0===n&&(n=0);var a=t.reduce((function(n,a,r){return Math.abs(a-e)<Math.abs(t[n]-e)?r:n}),0),r=Math.abs(t[a]-e);return 0===n||r<n?t[a]:e},v=function(e){return"auto"===(e=e.toString())||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},E=function(e,t,n,a){if(e&&"string"==typeof e){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%"))return t*(Number(e.replace("%",""))/100);if(e.endsWith("vw"))return n*(Number(e.replace("vw",""))/100);if(e.endsWith("vh"))return a*(Number(e.replace("vh",""))/100)}return e},x=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],j="__resizable_base__",O=function(e){function t(t){var n=e.call(this,t)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableRight=0,n.resizableTop=0,n.resizableBottom=0,n.targetLeft=0,n.targetTop=0,n.appendBase=function(){if(!n.resizable||!n.window)return null;var e=n.parentNode;if(!e)return null;var t=n.window.document.createElement("div");return t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0 0 100%",t.classList?t.classList.add(j):t.className+=j,e.appendChild(t),t},n.removeBase=function(e){var t=n.parentNode;t&&t.removeChild(e)},n.ref=function(e){e&&(n.resizable=e)},n.state={isResizing:!1,width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return o(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||m},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,a=this.resizable.offsetHeight,r=this.resizable.style.position;"relative"!==r&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:a,this.resizable.style.position=r}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&e.propsSize[t].toString().endsWith("%")){if(e.state[t].toString().endsWith("%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return v(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?v(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?v(t.height):n("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,n=this.parentNode.style.flexWrap;"wrap"!==n&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var a={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=n),this.removeBase(e),a},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){var n,a,r=this.props.boundsByDirection,i=this.state.direction,o=r&&b("left",i),s=r&&b("top",i);if("parent"===this.props.bounds){var l=this.parentNode;l&&(n=o?this.resizableRight-this.parentLeft:l.offsetWidth+(this.parentLeft-this.resizableLeft),a=s?this.resizableBottom-this.parentTop:l.offsetHeight+(this.parentTop-this.resizableTop))}else"window"===this.props.bounds?this.window&&(n=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,a=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(n=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),a=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return n&&Number.isFinite(n)&&(e=e&&e<n?e:n),a&&Number.isFinite(a)&&(t=t&&t<a?t:a),{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,a=this.props.resizeRatio||1,r=this.state,i=r.direction,o=r.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=o.width,p=o.height,m=c||0,f=u||0;return b("right",i)&&(d=o.width+(e-o.x)*a/n,l&&(p=(d-f)/this.ratio+m)),b("left",i)&&(d=o.width-(e-o.x)*a/n,l&&(p=(d-f)/this.ratio+m)),b("bottom",i)&&(p=o.height+(t-o.y)*a/n,l&&(d=(p-m)*this.ratio+f)),b("top",i)&&(p=o.height-(t-o.y)*a/n,l&&(d=(p-m)*this.ratio+f)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,a){var r=this.props,i=r.lockAspectRatio,o=r.lockAspectRatioExtraHeight,s=r.lockAspectRatioExtraWidth,l=void 0===a.width?10:a.width,c=void 0===n.width||n.width<0?e:n.width,u=void 0===a.height?10:a.height,d=void 0===n.height||n.height<0?t:n.height,p=o||0,m=s||0;if(i){var g=(u-p)*this.ratio+m,b=(d-p)*this.ratio+m,y=(l-m)/this.ratio+p,h=(c-m)/this.ratio+p,v=Math.max(l,g),E=Math.min(c,b),x=Math.max(u,y),j=Math.min(d,h);e=f(e,v,E),t=f(t,x,j)}else e=f(e,l,c),t=f(t,u,d);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var a=this.resizable.getBoundingClientRect(),r=a.left,i=a.top,o=a.right,s=a.bottom;this.resizableLeft=r,this.resizableRight=o,this.resizableTop=i,this.resizableBottom=s}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var n,a=0,r=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)?(a=e.nativeEvent.clientX,r=e.nativeEvent.clientY):e.nativeEvent&&y(e.nativeEvent)&&(a=e.nativeEvent.touches[0].clientX,r=e.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var i=this.window.getComputedStyle(this.resizable);if("auto"!==i.flexBasis){var o=this.parentNode;if(o){var l=this.window.getComputedStyle(o).flexDirection;this.flexDir=l.startsWith("row")?"row":"column",n=i.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var c={original:{x:a,y:r,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:n};this.setState(c)}},t.prototype.onMouseMove=function(e){var t=this;if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&y(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var n=this.props,a=n.maxWidth,i=n.maxHeight,o=n.minWidth,s=n.minHeight,l=y(e)?e.touches[0].clientX:e.clientX,c=y(e)?e.touches[0].clientY:e.clientY,u=this.state,d=u.direction,p=u.original,m=u.width,f=u.height,b=this.getParentSize(),v=function(e,t,n,a,r,i,o){return a=E(a,e.width,t,n),r=E(r,e.height,t,n),i=E(i,e.width,t,n),o=E(o,e.height,t,n),{maxWidth:void 0===a?void 0:Number(a),maxHeight:void 0===r?void 0:Number(r),minWidth:void 0===i?void 0:Number(i),minHeight:void 0===o?void 0:Number(o)}}(b,this.window.innerWidth,this.window.innerHeight,a,i,o,s);a=v.maxWidth,i=v.maxHeight,o=v.minWidth,s=v.minHeight;var x=this.calculateNewSizeFromDirection(l,c),j=x.newHeight,O=x.newWidth,S=this.calculateNewMaxFromBoundary(a,i);this.props.snap&&this.props.snap.x&&(O=h(O,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(j=h(j,this.props.snap.y,this.props.snapGap));var w=this.calculateNewSizeFromAspectRatio(O,j,{width:S.maxWidth,height:S.maxHeight},{width:o,height:s});if(O=w.newWidth,j=w.newHeight,this.props.grid){var k=g(O,this.props.grid[0]),I=g(j,this.props.grid[1]),T=this.props.snapGap||0;O=0===T||Math.abs(k-O)<=T?k:O,j=0===T||Math.abs(I-j)<=T?I:j}var C={width:O-p.width,height:j-p.height};m&&"string"==typeof m&&(m.endsWith("%")?O=O/b.width*100+"%":m.endsWith("vw")?O=O/this.window.innerWidth*100+"vw":m.endsWith("vh")&&(O=O/this.window.innerHeight*100+"vh")),f&&"string"==typeof f&&(f.endsWith("%")?j=j/b.height*100+"%":f.endsWith("vw")?j=j/this.window.innerWidth*100+"vw":f.endsWith("vh")&&(j=j/this.window.innerHeight*100+"vh"));var M={width:this.createSizeForCssProperty(O,"width"),height:this.createSizeForCssProperty(j,"height")};"row"===this.flexDir?M.flexBasis=M.width:"column"===this.flexDir&&(M.flexBasis=M.height),r.flushSync((function(){t.setState(M)})),this.props.onResize&&this.props.onResize(e,d,this.resizable,C)}},t.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,a=t.direction,r=t.original;if(n&&this.resizable){var i={width:this.size.width-r.width,height:this.size.height-r.height};this.props.onResizeStop&&this.props.onResizeStop(e,a,this.resizable,i),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,n=t.enable,r=t.handleStyles,i=t.handleClasses,o=t.handleWrapperStyle,s=t.handleWrapperClass,l=t.handleComponent;if(!n)return null;var c=Object.keys(n).map((function(t){return!1!==n[t]?a.createElement(p,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:r&&r[t],className:i&&i[t]},l&&l[t]?l[t]:null):null}));return a.createElement("div",{className:s,style:o},c)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,n){return-1!==x.indexOf(n)||(t[n]=e.props[n]),t}),{}),n=s(s(s({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var r=this.props.as||"div";return a.createElement(r,s({ref:this.ref,style:n,className:this.props.className},t),this.state.isResizing&&a.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(a.PureComponent);t.Resizable=O},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const r=e=>JSON.stringify(e),i=({pageIndex:e,pageSize:t})=>{const[n,i]=Object(a.useState)({}),o=Object(a.useCallback)((a=>{i({...n,[r({pageIndex:e+1,pageSize:t})]:a})}),[e,t]);let s;for(let a=e;a>=0&&(s=n[r({pageIndex:a,pageSize:t})],!s);a--);return[s,o]}},function(e,t,n){"use strict";e.exports=n(1309)},function(e,t,n){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(1310)),i=a(n(1373)),o=a(n(1311)),s=n(2),l=a(n(719)),c=a(n(1312)),u=a(n(1372)),d=a(n(1375)),p=a(n(1313));function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function f(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function g(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t.indexOf(n=i[a])>=0||(r[n]=e[n]);return r}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var y=s.createContext(void 0);y.displayName="FormikContext";var h=y.Provider,v=y.Consumer;function E(){var e=s.useContext(y);return e||c(!1),e}var x=function(e){return Array.isArray(e)&&0===e.length},j=function(e){return"function"==typeof e},O=function(e){return null!==e&&"object"==typeof e},S=function(e){return String(Math.floor(Number(e)))===e},w=function(e){return"[object String]"===Object.prototype.toString.call(e)},k=function(e){return 0===s.Children.count(e)},I=function(e){return O(e)&&j(e.then)};function T(e,t,n,a){void 0===a&&(a=0);for(var r=d(t);e&&a<r.length;)e=e[r[a++]];return a===r.length||e?void 0===e?n:e:n}function C(e,t,n){for(var a=u(e),r=a,i=0,o=d(t);i<o.length-1;i++){var s=o[i],l=T(e,o.slice(0,i+1));if(l&&(O(l)||Array.isArray(l)))r=r[s]=u(l);else{var c=o[i+1];r=r[s]=S(c)&&Number(c)>=0?[]:{}}}return(0===i?e:r)[o[i]]===n?e:(void 0===n?delete r[o[i]]:r[o[i]]=n,0===i&&void 0===n&&delete a[o[i]],a)}function M(e,t,n,a){void 0===n&&(n=new WeakMap),void 0===a&&(a={});for(var r=0,i=Object.keys(e);r<i.length;r++){var o=i[r],s=e[o];O(s)?n.get(s)||(n.set(s,!0),a[o]=Array.isArray(s)?[]:{},M(s,t,n,a[o])):a[o]=t}return a}var _={},D={};function N(e){var t=e.validateOnChange,n=void 0===t||t,a=e.validateOnBlur,i=void 0===a||a,c=e.validateOnMount,u=void 0!==c&&c,d=e.isInitialValid,p=e.enableReinitialize,f=void 0!==p&&p,b=e.onSubmit,y=g(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),h=m({validateOnChange:n,validateOnBlur:i,validateOnMount:u,onSubmit:b},y),v=s.useRef(h.initialValues),E=s.useRef(h.initialErrors||_),x=s.useRef(h.initialTouched||D),S=s.useRef(h.initialStatus),k=s.useRef(!1),N=s.useRef({});s.useEffect((function(){return k.current=!0,function(){k.current=!1}}),[]);var A=s.useState(0)[1],R=s.useRef({values:o(h.initialValues),errors:o(h.initialErrors)||_,touched:o(h.initialTouched)||D,status:o(h.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),q=R.current,B=s.useCallback((function(e){var t=R.current;R.current=function(e,t){switch(t.type){case"SET_VALUES":return m({},e,{values:t.payload});case"SET_TOUCHED":return m({},e,{touched:t.payload});case"SET_ERRORS":return l(e.errors,t.payload)?e:m({},e,{errors:t.payload});case"SET_STATUS":return m({},e,{status:t.payload});case"SET_ISSUBMITTING":return m({},e,{isSubmitting:t.payload});case"SET_ISVALIDATING":return m({},e,{isValidating:t.payload});case"SET_FIELD_VALUE":return m({},e,{values:C(e.values,t.payload.field,t.payload.value)});case"SET_FIELD_TOUCHED":return m({},e,{touched:C(e.touched,t.payload.field,t.payload.value)});case"SET_FIELD_ERROR":return m({},e,{errors:C(e.errors,t.payload.field,t.payload.value)});case"RESET_FORM":return m({},e,t.payload);case"SET_FORMIK_STATE":return t.payload(e);case"SUBMIT_ATTEMPT":return m({},e,{touched:M(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":case"SUBMIT_SUCCESS":return m({},e,{isSubmitting:!1});default:return e}}(t,e),t!==R.current&&A((function(e){return e+1}))}),[]),$=s.useCallback((function(e,t){return new Promise((function(n,a){var r=h.validate(e,t);null==r?n(_):I(r)?r.then((function(e){n(e||_)}),(function(e){a(e)})):n(r)}))}),[h.validate]),V=s.useCallback((function(e,t){var n=h.validationSchema,a=j(n)?n(t):n,r=t&&a.validateAt?a.validateAt(t,e):P(e,a);return new Promise((function(e,t){r.then((function(){e(_)}),(function(n){"ValidationError"===n.name?e(F(n)):t(n)}))}))}),[h.validationSchema]),U=s.useCallback((function(e,t){return new Promise((function(n){return n(N.current[e].validate(t))}))}),[]),G=s.useCallback((function(e){var t=Object.keys(N.current).filter((function(e){return j(N.current[e].validate)})),n=t.length>0?t.map((function(t){return U(t,T(e,t))})):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(n).then((function(e){return e.reduce((function(e,n,a){return"DO_NOT_DELETE_YOU_WILL_BE_FIRED"===n||n&&(e=C(e,t[a],n)),e}),{})}))}),[U]),H=s.useCallback((function(e){return Promise.all([G(e),h.validationSchema?V(e):{},h.validate?$(e):{}]).then((function(e){return r.all([e[0],e[1],e[2]],{arrayMerge:L})}))}),[h.validate,h.validationSchema,G,$,V]),W=z((function(e){return void 0===e&&(e=q.values),B({type:"SET_ISVALIDATING",payload:!0}),H(e).then((function(e){return k.current&&(B({type:"SET_ISVALIDATING",payload:!1}),B({type:"SET_ERRORS",payload:e})),e}))}));s.useEffect((function(){u&&!0===k.current&&l(v.current,h.initialValues)&&W(v.current)}),[u,W]);var Q=s.useCallback((function(e){var t=e&&e.values?e.values:v.current,n=e&&e.errors?e.errors:E.current?E.current:h.initialErrors||{},a=e&&e.touched?e.touched:x.current?x.current:h.initialTouched||{},r=e&&e.status?e.status:S.current?S.current:h.initialStatus;v.current=t,E.current=n,x.current=a,S.current=r;var i=function(){B({type:"RESET_FORM",payload:{isSubmitting:!!e&&!!e.isSubmitting,errors:n,touched:a,status:r,values:t,isValidating:!!e&&!!e.isValidating,submitCount:e&&e.submitCount&&"number"==typeof e.submitCount?e.submitCount:0}})};if(h.onReset){var o=h.onReset(q.values,me);I(o)?o.then(i):i()}else i()}),[h.initialErrors,h.initialStatus,h.initialTouched,h.onReset]);s.useEffect((function(){!0!==k.current||l(v.current,h.initialValues)||f&&(v.current=h.initialValues,Q(),u&&W(v.current))}),[f,h.initialValues,Q,u,W]),s.useEffect((function(){f&&!0===k.current&&!l(E.current,h.initialErrors)&&(E.current=h.initialErrors||_,B({type:"SET_ERRORS",payload:h.initialErrors||_}))}),[f,h.initialErrors]),s.useEffect((function(){f&&!0===k.current&&!l(x.current,h.initialTouched)&&(x.current=h.initialTouched||D,B({type:"SET_TOUCHED",payload:h.initialTouched||D}))}),[f,h.initialTouched]),s.useEffect((function(){f&&!0===k.current&&!l(S.current,h.initialStatus)&&(S.current=h.initialStatus,B({type:"SET_STATUS",payload:h.initialStatus}))}),[f,h.initialStatus,h.initialTouched]);var Y=z((function(e){if(N.current[e]&&j(N.current[e].validate)){var t=T(q.values,e),n=N.current[e].validate(t);return I(n)?(B({type:"SET_ISVALIDATING",payload:!0}),n.then((function(e){return e})).then((function(t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:t}}),B({type:"SET_ISVALIDATING",payload:!1})}))):(B({type:"SET_FIELD_ERROR",payload:{field:e,value:n}}),Promise.resolve(n))}return h.validationSchema?(B({type:"SET_ISVALIDATING",payload:!0}),V(q.values,e).then((function(e){return e})).then((function(t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:T(t,e)}}),B({type:"SET_ISVALIDATING",payload:!1})}))):Promise.resolve()})),K=s.useCallback((function(e,t){N.current[e]={validate:t.validate}}),[]),Z=s.useCallback((function(e){delete N.current[e]}),[]),X=z((function(e,t){return B({type:"SET_TOUCHED",payload:e}),(void 0===t?i:t)?W(q.values):Promise.resolve()})),J=s.useCallback((function(e){B({type:"SET_ERRORS",payload:e})}),[]),ee=z((function(e,t){var a=j(e)?e(q.values):e;return B({type:"SET_VALUES",payload:a}),(void 0===t?n:t)?W(a):Promise.resolve()})),te=s.useCallback((function(e,t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:t}})}),[]),ne=z((function(e,t,a){return B({type:"SET_FIELD_VALUE",payload:{field:e,value:t}}),(void 0===a?n:a)?W(C(q.values,e,t)):Promise.resolve()})),ae=s.useCallback((function(e,t){var n,a=t,r=e;if(!w(e)){e.persist&&e.persist();var i=e.target?e.target:e.currentTarget,o=i.type,s=i.value,l=i.checked,c=i.options,u=i.multiple;a=t||i.name||i.id,r=/number|range/.test(o)?(n=parseFloat(s),isNaN(n)?"":n):/checkbox/.test(o)?function(e,t,n){if("boolean"==typeof e)return Boolean(t);var a=[],r=!1,i=-1;if(Array.isArray(e))a=e,r=(i=e.indexOf(n))>=0;else if(!n||"true"==n||"false"==n)return Boolean(t);return t&&n&&!r?a.concat(n):r?a.slice(0,i).concat(a.slice(i+1)):a}(T(q.values,a),l,s):c&&u?function(e){return Array.from(e).filter((function(e){return e.selected})).map((function(e){return e.value}))}(c):s}a&&ne(a,r)}),[ne,q.values]),re=z((function(e){if(w(e))return function(t){return ae(t,e)};ae(e)})),ie=z((function(e,t,n){return void 0===t&&(t=!0),B({type:"SET_FIELD_TOUCHED",payload:{field:e,value:t}}),(void 0===n?i:n)?W(q.values):Promise.resolve()})),oe=s.useCallback((function(e,t){e.persist&&e.persist();var n=e.target;ie(t||n.name||n.id,!0)}),[ie]),se=z((function(e){if(w(e))return function(t){return oe(t,e)};oe(e)})),le=s.useCallback((function(e){j(e)?B({type:"SET_FORMIK_STATE",payload:e}):B({type:"SET_FORMIK_STATE",payload:function(){return e}})}),[]),ce=s.useCallback((function(e){B({type:"SET_STATUS",payload:e})}),[]),ue=s.useCallback((function(e){B({type:"SET_ISSUBMITTING",payload:e})}),[]),de=z((function(){return B({type:"SUBMIT_ATTEMPT"}),W().then((function(e){var t=e instanceof Error;if(!t&&0===Object.keys(e).length){var n;try{if(void 0===(n=fe()))return}catch(e){throw e}return Promise.resolve(n).then((function(e){return k.current&&B({type:"SUBMIT_SUCCESS"}),e})).catch((function(e){if(k.current)throw B({type:"SUBMIT_FAILURE"}),e}))}if(k.current&&(B({type:"SUBMIT_FAILURE"}),t))throw e}))})),pe=z((function(e){e&&e.preventDefault&&j(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&j(e.stopPropagation)&&e.stopPropagation(),de().catch((function(e){console.warn("Warning: An unhandled error was caught from submitForm()",e)}))})),me={resetForm:Q,validateForm:W,validateField:Y,setErrors:J,setFieldError:te,setFieldTouched:ie,setFieldValue:ne,setStatus:ce,setSubmitting:ue,setTouched:X,setValues:ee,setFormikState:le,submitForm:de},fe=z((function(){return b(q.values,me)})),ge=z((function(e){e&&e.preventDefault&&j(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&j(e.stopPropagation)&&e.stopPropagation(),Q()})),be=s.useCallback((function(e){return{value:T(q.values,e),error:T(q.errors,e),touched:!!T(q.touched,e),initialValue:T(v.current,e),initialTouched:!!T(x.current,e),initialError:T(E.current,e)}}),[q.errors,q.touched,q.values]),ye=s.useCallback((function(e){return{setValue:function(t,n){return ne(e,t,n)},setTouched:function(t,n){return ie(e,t,n)},setError:function(t){return te(e,t)}}}),[ne,ie,te]),he=s.useCallback((function(e){var t=O(e),n=t?e.name:e,a=T(q.values,n),r={name:n,value:a,onChange:re,onBlur:se};if(t){var i=e.type,o=e.value,s=e.as,l=e.multiple;"checkbox"===i?void 0===o?r.checked=!!a:(r.checked=!(!Array.isArray(a)||!~a.indexOf(o)),r.value=o):"radio"===i?(r.checked=a===o,r.value=o):"select"===s&&l&&(r.value=r.value||[],r.multiple=!0)}return r}),[se,re,q.values]),ve=s.useMemo((function(){return!l(v.current,q.values)}),[v.current,q.values]),Ee=s.useMemo((function(){return void 0!==d?ve?q.errors&&0===Object.keys(q.errors).length:!1!==d&&j(d)?d(h):d:q.errors&&0===Object.keys(q.errors).length}),[d,ve,q.errors,h]);return m({},q,{initialValues:v.current,initialErrors:E.current,initialTouched:x.current,initialStatus:S.current,handleBlur:se,handleChange:re,handleReset:ge,handleSubmit:pe,resetForm:Q,setErrors:J,setFormikState:le,setFieldTouched:ie,setFieldValue:ne,setFieldError:te,setStatus:ce,setSubmitting:ue,setTouched:X,setValues:ee,submitForm:de,validateForm:W,validateField:Y,isValid:Ee,dirty:ve,unregisterField:Z,registerField:K,getFieldProps:he,getFieldMeta:be,getFieldHelpers:ye,validateOnBlur:i,validateOnChange:n,validateOnMount:u})}function A(e){var t=N(e),n=e.component,a=e.children,r=e.render;return s.useImperativeHandle(e.innerRef,(function(){return t})),s.createElement(h,{value:t},n?s.createElement(n,t):r?r(t):a?j(a)?a(t):k(a)?null:s.Children.only(a):null)}function F(e){var t={};if(e.inner){if(0===e.inner.length)return C(t,e.path,e.message);var n=e.inner,a=Array.isArray(n),r=0;for(n=a?n:n[Symbol.iterator]();;){var i;if(a){if(r>=n.length)break;i=n[r++]}else{if((r=n.next()).done)break;i=r.value}var o=i;T(t,o.path)||(t=C(t,o.path,o.message))}}return t}function P(e,t,n,a){void 0===n&&(n=!1);var r=R(e);return t[n?"validateSync":"validate"](r,{abortEarly:!1,context:a||r})}function R(e){var t=Array.isArray(e)?[]:{};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=String(n);t[a]=!0===Array.isArray(e[a])?e[a].map((function(e){return!0===Array.isArray(e)||i(e)?R(e):""!==e?e:void 0})):i(e[a])?R(e[a]):""!==e[a]?e[a]:void 0}return t}function L(e,t,n){var a=e.slice();return t.forEach((function(t,i){if(void 0===a[i]){var o=!1!==n.clone&&n.isMergeableObject(t);a[i]=o?r(Array.isArray(t)?[]:{},t,n):t}else n.isMergeableObject(t)?a[i]=r(e[i],t,n):-1===e.indexOf(t)&&a.push(t)})),a}var q="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?s.useLayoutEffect:s.useEffect;function z(e){var t=s.useRef(e);return q((function(){t.current=e})),s.useCallback((function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.current.apply(void 0,n)}),[])}var B=s.forwardRef((function(e,t){var n=e.action,a=g(e,["action"]),r=null!=n?n:"#",i=E();return s.createElement("form",m({onSubmit:i.handleSubmit,ref:t,onReset:i.handleReset,action:r},a))}));function $(e){var t=function(t){return s.createElement(v,null,(function(n){return n||c(!1),s.createElement(e,m({},t,{formik:n}))}))},n=e.displayName||e.name||e.constructor&&e.constructor.name||"Component";return t.WrappedComponent=e,t.displayName="FormikConnect("+n+")",p(t,e)}B.displayName="Form";var V=function(e,t,n){var a=W(e),r=a[t];return a.splice(t,1),a.splice(n,0,r),a},U=function(e,t,n){var a=W(e),r=a[t];return a[t]=a[n],a[n]=r,a},G=function(e,t,n){var a=W(e);return a.splice(t,0,n),a},H=function(e,t,n){var a=W(e);return a[t]=n,a},W=function(e){if(e){if(Array.isArray(e))return[].concat(e);var t=Object.keys(e).map((function(e){return parseInt(e)})).reduce((function(e,t){return t>e?t:e}),0);return Array.from(m({},e,{length:t+1}))}return[]},Q=function(e,t){var n="function"==typeof e?e:t;return function(e){if(Array.isArray(e)||O(e)){var t=W(e);return n(t)}return e}},Y=function(e){function t(t){var n;return(n=e.call(this,t)||this).updateArrayField=function(e,t,a){var r=n.props,i=r.name;(0,r.formik.setFormikState)((function(n){var r=Q(a,e),o=Q(t,e),s=C(n.values,i,e(T(n.values,i))),l=a?r(T(n.errors,i)):void 0,c=t?o(T(n.touched,i)):void 0;return x(l)&&(l=void 0),x(c)&&(c=void 0),m({},n,{values:s,errors:a?C(n.errors,i,l):n.errors,touched:t?C(n.touched,i,c):n.touched})}))},n.push=function(e){return n.updateArrayField((function(t){return[].concat(W(t),[o(e)])}),!1,!1)},n.handlePush=function(e){return function(){return n.push(e)}},n.swap=function(e,t){return n.updateArrayField((function(n){return U(n,e,t)}),!0,!0)},n.handleSwap=function(e,t){return function(){return n.swap(e,t)}},n.move=function(e,t){return n.updateArrayField((function(n){return V(n,e,t)}),!0,!0)},n.handleMove=function(e,t){return function(){return n.move(e,t)}},n.insert=function(e,t){return n.updateArrayField((function(n){return G(n,e,t)}),(function(t){return G(t,e,null)}),(function(t){return G(t,e,null)}))},n.handleInsert=function(e,t){return function(){return n.insert(e,t)}},n.replace=function(e,t){return n.updateArrayField((function(n){return H(n,e,t)}),!1,!1)},n.handleReplace=function(e,t){return function(){return n.replace(e,t)}},n.unshift=function(e){var t=-1;return n.updateArrayField((function(n){var a=n?[e].concat(n):[e];return t=a.length,a}),(function(e){return e?[null].concat(e):[null]}),(function(e){return e?[null].concat(e):[null]})),t},n.handleUnshift=function(e){return function(){return n.unshift(e)}},n.handleRemove=function(e){return function(){return n.remove(e)}},n.handlePop=function(){return function(){return n.pop()}},n.remove=n.remove.bind(b(n)),n.pop=n.pop.bind(b(n)),n}f(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.props.validateOnChange&&this.props.formik.validateOnChange&&!l(T(e.formik.values,e.name),T(this.props.formik.values,this.props.name))&&this.props.formik.validateForm(this.props.formik.values)},n.remove=function(e){var t;return this.updateArrayField((function(n){var a=n?W(n):[];return t||(t=a[e]),j(a.splice)&&a.splice(e,1),j(a.every)&&a.every((function(e){return void 0===e}))?[]:a}),!0,!0),t},n.pop=function(){var e;return this.updateArrayField((function(t){var n=t.slice();return e||(e=n&&n.pop&&n.pop()),n}),!0,!0),e},n.render=function(){var e=this.props,t=e.component,n=e.render,a=e.children,r=e.name,i=m({},{push:this.push,pop:this.pop,swap:this.swap,move:this.move,insert:this.insert,replace:this.replace,unshift:this.unshift,remove:this.remove,handlePush:this.handlePush,handlePop:this.handlePop,handleSwap:this.handleSwap,handleMove:this.handleMove,handleInsert:this.handleInsert,handleReplace:this.handleReplace,handleUnshift:this.handleUnshift,handleRemove:this.handleRemove},{form:g(e.formik,["validate","validationSchema"]),name:r});return t?s.createElement(t,i):n?n(i):a?"function"==typeof a?a(i):k(a)?null:s.Children.only(a):null},t}(s.Component);Y.defaultProps={validateOnChange:!0};var K=$(Y),Z=$(function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return T(this.props.formik.errors,this.props.name)!==T(e.formik.errors,this.props.name)||T(this.props.formik.touched,this.props.name)!==T(e.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(e).length},n.render=function(){var e=this.props,t=e.component,n=e.formik,a=e.render,r=e.children,i=e.name,o=g(e,["component","formik","render","children","name"]),l=T(n.touched,i),c=T(n.errors,i);return l&&c?a?j(a)?a(c):null:r?j(r)?r(c):null:t?s.createElement(t,o,c):c:null},t}(s.Component)),X=$(function(e){function t(t){var n;n=e.call(this,t)||this;var a=t.render,r=t.children,i=t.component,o=t.as;return a&&c(!1),i&&a&&c(!1),o&&r&&j(r)&&c(!1),i&&r&&j(r)&&c(!1),a&&r&&!k(r)&&c(!1),n}f(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return this.props.shouldUpdate?this.props.shouldUpdate(e,this.props):e.name!==this.props.name||T(e.formik.values,this.props.name)!==T(this.props.formik.values,this.props.name)||T(e.formik.errors,this.props.name)!==T(this.props.formik.errors,this.props.name)||T(e.formik.touched,this.props.name)!==T(this.props.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(e).length||e.formik.isSubmitting!==this.props.formik.isSubmitting},n.componentDidMount=function(){this.props.formik.registerField(this.props.name,{validate:this.props.validate})},n.componentDidUpdate=function(e){this.props.name!==e.name&&(this.props.formik.unregisterField(e.name),this.props.formik.registerField(this.props.name,{validate:this.props.validate})),this.props.validate!==e.validate&&this.props.formik.registerField(this.props.name,{validate:this.props.validate})},n.componentWillUnmount=function(){this.props.formik.unregisterField(this.props.name)},n.render=function(){var e=this.props,t=e.name,n=e.render,a=e.as,r=e.children,i=e.component,o=e.formik,l=g(e,["validate","name","render","as","children","component","shouldUpdate","formik"]),c=g(o,["validate","validationSchema"]),u=o.getFieldProps(m({name:t},l)),d={field:u,meta:{value:T(o.values,t),error:T(o.errors,t),touched:!!T(o.touched,t),initialValue:T(o.initialValues,t),initialTouched:!!T(o.initialTouched,t),initialError:T(o.initialErrors,t)},form:c};if(n)return n(d);if(j(r))return r(d);if(i){if("string"==typeof i){var p=l.innerRef,f=g(l,["innerRef"]);return s.createElement(i,m({ref:p},u,f),r)}return s.createElement(i,m({field:u,form:o},l),r)}var b=a||"input";if("string"==typeof b){var y=l.innerRef,h=g(l,["innerRef"]);return s.createElement(b,m({ref:y},u,h),r)}return s.createElement(b,m({},u,l),r)},t}(s.Component));t.ErrorMessage=Z,t.FastField=X,t.Field=function(e){var t=e.validate,n=e.name,a=e.render,r=e.children,i=e.as,o=e.component,l=e.className,c=g(e,["validate","name","render","children","as","component","className"]),u=g(E(),["validate","validationSchema"]),d=u.registerField,p=u.unregisterField;s.useEffect((function(){return d(n,{validate:t}),function(){p(n)}}),[d,p,n,t]);var f=u.getFieldProps(m({name:n},c)),b=u.getFieldMeta(n),y={field:f,form:u};if(a)return a(m({},y,{meta:b}));if(j(r))return r(m({},y,{meta:b}));if(o){if("string"==typeof o){var h=c.innerRef,v=g(c,["innerRef"]);return s.createElement(o,m({ref:h},f,v,{className:l}),r)}return s.createElement(o,m({field:f,form:u},c,{className:l}),r)}var x=i||"input";if("string"==typeof x){var O=c.innerRef,S=g(c,["innerRef"]);return s.createElement(x,m({ref:O},f,S,{className:l}),r)}return s.createElement(x,m({},f,c,{className:l}),r)},t.FieldArray=K,t.Form=B,t.Formik=A,t.FormikConsumer=v,t.FormikContext=y,t.FormikProvider=h,t.connect=$,t.getActiveElement=function(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}},t.getIn=T,t.insert=G,t.isEmptyArray=x,t.isEmptyChildren=k,t.isFunction=j,t.isInputEvent=function(e){return e&&O(e)&&O(e.target)},t.isInteger=S,t.isNaN=function(e){return e!=e},t.isObject=O,t.isPromise=I,t.isString=w,t.move=V,t.prepareDataForValidation=R,t.replace=H,t.setIn=C,t.setNestedObjectValues=M,t.swap=U,t.useField=function(e){var t=E(),n=t.getFieldProps,a=t.getFieldMeta,r=t.getFieldHelpers,i=t.registerField,o=t.unregisterField,l=O(e)?e:{name:e},u=l.name,d=l.validate;s.useEffect((function(){return u&&i(u,{validate:d}),function(){u&&o(u)}}),[i,o,u,d]),u||c(!1);var p=s.useMemo((function(){return r(u)}),[r,u]);return[n(l),a(u),p]},t.useFormik=N,t.useFormikContext=E,t.validateYupSchema=P,t.withFormik=function(e){var t=e.mapPropsToValues,n=void 0===t?function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&"function"!=typeof e[n]&&(t[n]=e[n]);return t}:t,a=g(e,["mapPropsToValues"]);return function(e){var t=e.displayName||e.name||e.constructor&&e.constructor.name||"Component",r=function(t){function r(){for(var n,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).validate=function(e){return a.validate(e,n.props)},n.validationSchema=function(){return j(a.validationSchema)?a.validationSchema(n.props):a.validationSchema},n.handleSubmit=function(e,t){return a.handleSubmit(e,m({},t,{props:n.props}))},n.renderFormComponent=function(t){return s.createElement(e,m({},n.props,t))},n}return f(r,t),r.prototype.render=function(){var e=g(this.props,["children"]);return s.createElement(A,m({},e,a,{validate:a.validate&&this.validate,validationSchema:a.validationSchema&&this.validationSchema,initialValues:n(this.props),initialStatus:a.mapPropsToStatus&&a.mapPropsToStatus(this.props),initialErrors:a.mapPropsToErrors&&a.mapPropsToErrors(this.props),initialTouched:a.mapPropsToTouched&&a.mapPropsToTouched(this.props),onSubmit:this.handleSubmit,children:this.renderFormComponent}))},r}(s.Component);return r.displayName="WithFormik("+t+")",p(r,e)}},t.yupToFormErrors=F},function(e,t,n){e.exports=function(){"use strict";var e=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var n=Object.prototype.toString.call(e);return"[object RegExp]"===n||"[object Date]"===n||function(e){return e.$$typeof===t}(e)}(e)};var t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?r((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function a(e,t,a){return e.concat(t).map((function(e){return n(e,a)}))}function r(t,i,o){(o=o||{}).arrayMerge=o.arrayMerge||a,o.isMergeableObject=o.isMergeableObject||e;var s=Array.isArray(i);return s===Array.isArray(t)?s?o.arrayMerge(t,i,o):function(e,t,a){var i={};return a.isMergeableObject(e)&&Object.keys(e).forEach((function(t){i[t]=n(e[t],a)})),Object.keys(t).forEach((function(o){a.isMergeableObject(t[o])&&e[o]?i[o]=r(e[o],t[o],a):i[o]=n(t[o],a)})),i}(t,i,o):n(i,o)}return r.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return r(e,n,t)}),{})},r}()},function(e,t,n){var a=n(1338);e.exports=function(e){return a(e,5)}},function(e,t,n){"use strict";e.exports=function(e,t){}},function(e,t,n){e.exports=n(35)(231)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.ERROR="error",e.EMPTY="empty",e.EMPTY_SEARCH="empty_search",e.LOADING="loading",e.SEARCHING="searching",e.DELETING="deleting",e}({})},function(e,t,n){e.exports=n.p+"94cccf20036d014924e63d4d595e88e1.svg"},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(168);const r=a.q,i=a.r,o=({namespaceType:e})=>e.map((e=>(({namespaceType:e})=>"agnostic"===e?i:r)({namespaceType:e})))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(46),r=n(456),i=n(275),o=n(400),s=n(397),l=n(398),c=n(214),u=n(457),d=n(401),p=n(402),m=n(255),f=n(399),g=n(506),b=n(507),y=n(345),h=n(1281),v=n(796);const E=n(1371).a;a.union([E,a[void 0]]);var x=n(574),j=n(1284);const O=a.exact(a.type({_version:y.b,comments:h.b,created_at:s.a,created_by:l.a,description:f.a,entries:v.a,expire_time:j.a,id:c.a,item_id:E,list_id:m.a,meta:i.b,name:o.a,namespace_type:r.a,os_types:g.b,tags:b.a,tie_breaker_id:u.a,type:x.a,updated_at:d.a,updated_by:p.a}))},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(5);const r=e=>e.groups.some((e=>a.Zb.includes(e)))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return m}));var a=n(748),r=n(813);a.s;const i=`${a.k}.building_block_type`,o=`${a.k}.evaluation.threshold`,s=`${a.k}.evaluation.value`,l=`${a.k}.context`,c=`${a.k}.evaluation.values`,u=`${a.k}.group`,d=`${u}.field`,p=`${u}.value`,m=`${a.s}.exceptions_list`;a.s,a.I,a.k,a.s,r.D,r.F,r.E,r.G,a.K,a.a,a.d,a.e,a.f,a.j,a.h,a.o,a.u,a.m,r.a,a.b,r.b,r.c,r.d,r.e,r.f,a.q,r.g,r.h,r.i,a.r,r.j,a.t,r.k,r.l,r.m,a.w,r.n,r.o,a.x,r.p,r.q,r.r,a.A,a.C,r.s,a.B,r.z,a.E,a.F,r.A,a.G,a.H,r.C,a.y,a.n,r.x,r.v,r.y,r.w,r.u,r.t,a.J,a.L},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(50);const r=e=>null!=e.id?e:{...e,id:Object(a.v4)()},i=e=>{const t=e;if(null!=t.id){const{id:e,...n}=t;return n}return e}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"j",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return m}));var a=n(4);const r=e=>a.i18n.translate("grouping.total.unit",{values:{totalCount:e,groupCount:e.toLocaleString()},defaultMessage:"{groupCount} {totalCount, plural, =1 {group} other {groups}}"}),i=a.i18n.translate("grouping.additionalActions.takeAction",{defaultMessage:"Take actions"}),o=a.i18n.translate("grouping.alerts.label",{defaultMessage:"Group alerts by"}),s=a.i18n.translate("grouping.customGroupByPanelTitle",{defaultMessage:"Group By Custom Field"}),l=e=>a.i18n.translate("grouping.groupByPanelTitle",{values:{groupingLevelsCount:e},defaultMessage:"Select up to {groupingLevelsCount} groupings"}),c=a.i18n.translate("grouping.groupBySingleField",{defaultMessage:"Select grouping"}),u=a.i18n.translate("grouping.noneGroupByOptionName",{defaultMessage:"None"}),d=a.i18n.translate("grouping.customGroupByOptionName",{defaultMessage:"Custom field"}),p=e=>a.i18n.translate("grouping.eventsTab.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),m=(e,t)=>a.i18n.translate("grouping.nullGroup.title",{values:{selectedGroup:e,unit:t},defaultMessage:"The selected group by field, {selectedGroup}, is missing a value for this group of {unit}."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return w}));var a=n(119),r=n.n(a),i=n(19),o=n(2),s=n.n(o),l=n(44),c=n(1799),u=n(1490),d=n(16),p=n(124),m=n(304),f=n(305),g=n(758),b=n(170),y=n(229),h=n(132),v=n(744),E=n(1517),x=n(5),j=n(252),O=n(893);const S=Object(o.memo)((function(e){var t;const{columnId:n,rowIndex:a,scopeId:r,tableId:S,header:w,data:k,ecsData:I,linkValues:T,rowRenderers:C,isDetails:M,isExpandable:_,isDraggable:D=!1,isExpanded:N,colIndex:A,eventId:F,setCellProps:P,truncate:R,context:L}=e,q=Object(o.useMemo)((()=>n===y.n&&Object(g.c)(S)&&0===a&&!e.isDetails),[n,e.isDetails,a,S]),{browserFields:z}=Object(h.a)(r),B=Object(o.useMemo)((()=>Object(j.a)(z)),[z]),$=Object(o.useMemo)((()=>c.b.getTableByIdSelector()),[]),V=Object(d.b)(),U=null!==(t=Object(p.a)((e=>{var t;return(null!==(t=$(e,S))&&void 0!==t?t:u.d).viewMode})))&&void 0!==t?t:u.d.viewMode,G=Object(o.useMemo)((()=>Object(O.c)(V)),[V]),H=Object(o.useMemo)((()=>U===x.cd.gridView?G:O.b),[G,U]),W=Object(o.useMemo)((()=>k.map((e=>{if(["_id","_index"].includes(e.field)){var t;const n=null!==(t=e.value)&&void 0!==t?t:"";return{field:e.field,value:Array.isArray(n)?n:[n]}}return e}))),[k]),Q=Object(o.useMemo)((()=>{var e,t,n,a,r;const i=null==I||null===(e=I.kibana)||void 0===e||null===(t=e.alert.suppression)||void 0===t||null===(n=t.docs_count)||void 0===n?void 0:n[0],o=null===(a=Object(l.find)({field:"kibana.alert.suppression.docs_count"},k))||void 0===a||null===(r=a.value)||void 0===r?void 0:r[0];return i?parseInt(i,10):o}),[I,k]),Y=Object(o.useMemo)((()=>{var e;const t=null!=w?w:{id:n,...B[n]},r=H.find((e=>e.id===n)),i=Object(l.getOr)([],null!==(e=null==r?void 0:r.linkField)&&void 0!==e?e:"",I);return s.a.createElement(f.a,{isTourAnchor:q,step:b.a.pointToAlertName,tourId:b.b.alertsCases},s.a.createElement(v.a,{browserFields:z,columnId:n,data:W,ecsData:I,eventId:F,header:t,isDetails:M,isDraggable:D,isExpandable:_,isExpanded:N,linkValues:null!=T?T:i,rowIndex:a,colIndex:A,rowRenderers:null!=C?C:m.b,setCellProps:P,scopeId:S,truncate:R,asPlainText:!1,context:L}))}),[w,n,B,H,I,q,z,W,F,M,D,_,N,T,a,A,C,P,S,R,L]);return n===y.n&&Q?s.a.createElement(i.EuiFlexGroup,{gutterSize:"xs"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiToolTip,{position:"top",content:Object(E.c)(Q)},s.a.createElement(i.EuiIcon,{type:"layers"}))),s.a.createElement(i.EuiFlexItem,{grow:!1},Y)):s.a.createElement(s.a.Fragment,null,Y)})),w=({scopeId:e,tableId:t})=>n=>s.a.createElement(S,r()({},n,{scopeId:e,tableId:t}))},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(47),r=(n(2),n(118));const i=["POST","/api/ml/jobs/jobs_summary"],o=(e,t)=>Object(a.useQuery)([i,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>r.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.query="query",e.graph="graph",e.notes="notes",e.pinned="pinned",e.eql="eql",e.session="session",e}({})},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(19),r=n(59),i=n(43),o=n(49);const s=Object(i.css)("font-size:",o.euiThemeVars.euiFontSizeXS,";font-weight:",o.euiThemeVars.euiFontWeightSemiBold,";border-right:",o.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;",""),l=Object(i.css)("font-size:",o.euiThemeVars.euiFontSizeXS,";font-weight:",o.euiThemeVars.euiFontWeightSemiBold,";border-right:",o.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;.smallDot{width:3px!important;display:inline-block;}.euiBadge__text{text-align:center;width:100%;}",""),c=Object(i.css)(".groupingAccordionForm .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:",o.euiThemeVars.euiBorderThin,";border-right:",o.euiThemeVars.euiBorderThin,";border-bottom:",o.euiThemeVars.euiBorderThin,";border-radius:0 0 6px 6px;}.groupingAccordionForm .euiAccordion__triggerWrapper{border-bottom:",o.euiThemeVars.euiBorderThin,";border-left:",o.euiThemeVars.euiBorderThin,";border-right:",o.euiThemeVars.euiBorderThin,";border-radius:6px;min-height:78px;padding-left:16px;padding-right:16px;}.groupingAccordionForm{border-top:",o.euiThemeVars.euiBorderThin,";border-bottom:none;border-radius:6px;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),u=Object(i.css)(".groupingAccordionFormLevel .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:none;border-right:none;border-bottom:",o.euiThemeVars.euiBorderThin,";border-radius:0;}.groupingAccordionFormLevel .euiAccordion__triggerWrapper{border-bottom:",o.euiThemeVars.euiBorderThin,";border-left:none;border-right:none;min-height:78px;padding-left:16px;padding-right:16px;border-radius:0;}.groupingAccordionFormLevel{border-top:none;border-bottom:none;border-radius:0;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),d=Object(r.euiStyled)(a.EuiContextMenu)`
  width: 250px;
  & .euiContextMenuItem__text {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .euiContextMenuItem {
    border-bottom: ${o.euiThemeVars.euiBorderThin};
  }
  .euiContextMenuItem:last-child {
    border: none;
  }
`,p=Object(r.euiStyled)(a.EuiButtonEmpty)`
  font-weight: 'normal';

  .euiButtonEmpty__text {
    max-width: 300px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=function(e){return e.GROUP_TOGGLED="alerts_table_toggled_",e.GROUPED_ALERTS="alerts_table_group_by_",e}(a||{});const r={groupToggled:({isOpen:e,groupingId:t,groupNumber:n})=>`${a.GROUP_TOGGLED}${e?"on":"off"}_${t}_group-${n}`,groupChanged:({groupingId:e,selected:t})=>`${a.GROUPED_ALERTS}${e}_${t}`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(19),r=n(41),i=n.n(r);const o="siemEventsTable",s=i.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-1a6qah7-0"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),l=i()(a.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroupTable",componentId:"sc-1a6qah7-1"})(["overflow:hidden;margin:0;display:",";"],(({$visible:e})=>e?"flex":"none")),c=i()(a.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1a6qah7-2"})(["overflow:auto;"]),u=(i()(a.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1a6qah7-3"})(["overflow:hidden;margin:0;min-height:490px;display:",";"],(({$visible:e=!0})=>e?"flex":"none")),i()(a.EuiFlexGroup).withConfig({displayName:"UpdatedFlexGroup",componentId:"sc-1a6qah7-4"})([""," ",";display:inline-flex;z-index:",";",""],(({$hasRightOffset:e,theme:t,position:n})=>"relative"===n?`margin-right: ${t.eui.euiSizeXS}; margin-left: `:e&&"absolute"===n?`margin-right: ${t.eui.euiSizeXL};`:`margin-right: ${t.eui.euiSizeXS};`),(({position:e})=>"absolute"===e?"position: absolute":"display: flex; justify-content:center; align-items:center"),(({theme:e})=>e.eui.euiZLevel1-3),(({$hasRightOffset:e,theme:t,position:n})=>"relative"===n?"right: 0;":e&&"absolute"===n?`right: ${t.eui.euiSizeXL};`:`right: ${t.eui.euiSizeL};`))),d=i()(a.EuiFlexItem).withConfig({displayName:"UpdatedFlexItem",componentId:"sc-1a6qah7-5"})(["",""],(({$show:e})=>e?"":"visibility: hidden;")),p=i.a.div.attrs((({className:e=""})=>({className:`securitySolutionTimeline__container ${e}`}))).withConfig({displayName:"EventsContainerLoading",componentId:"sc-1a6qah7-6"})(["position:relative;width:100%;overflow:hidden;flex:1;display:flex;flex-direction:column;"]),m=i()(a.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1a6qah7-7"})(["display:flex;flex-direction:column;position:relative;width:100%;",""],(({$isFullScreen:e})=>e&&"\n    border: 0;\n    box-shadow: none;\n    padding-top: 0;\n    padding-bottom: 0;\n"))},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(19),r=n(2),i=n.n(r),o=n(0),s=n.n(o),l=n(4),c=n(43);const u={selectedOptions:[]};class custom_field_panel_CustomFieldPanel extends i.a.PureComponent{constructor(...e){super(...e),s()(this,"state",u),s()(this,"handleSubmit",(()=>{this.props.onSubmit(this.state.selectedOptions[0].label)})),s()(this,"handleFieldSelection",(e=>{this.setState({selectedOptions:e})}))}render(){const{fields:e,currentOptions:t}=this.props,n=e.filter((e=>e.aggregatable&&"string"===e.type&&!(t&&t.some((t=>t.field===e.name))))).map((e=>({label:e.name}))),r=!this.state.selectedOptions.length;return Object(c.jsx)("div",{"data-test-subj":"custom-field-panel",style:{padding:16}},Object(c.jsx)(a.EuiForm,null,Object(c.jsx)(a.EuiFormRow,{label:l.i18n.translate("grouping.groupSelector.customGroupByFieldLabel",{defaultMessage:"Field"}),helpText:l.i18n.translate("grouping.groupSelector.customGroupByHelpText",{defaultMessage:"This is the field used for the terms aggregation"}),display:"rowCompressed",fullWidth:!0},Object(c.jsx)(a.EuiComboBox,{"data-test-subj":"groupByCustomField",placeholder:l.i18n.translate("grouping.groupSelector.customGroupByDropdownPlacehoder",{defaultMessage:"Select one"}),singleSelection:{asPlainText:!0},selectedOptions:this.state.selectedOptions,options:n,onChange:this.handleFieldSelection,fullWidth:!0,isClearable:!1})),Object(c.jsx)(a.EuiButton,{"data-test-subj":"groupByCustomFieldAddButton",disabled:r,type:"submit",size:"s",fill:!0,onClick:this.handleSubmit},l.i18n.translate("grouping.selector.grouping.label.add",{defaultMessage:"Add"}))))}}s()(custom_field_panel_CustomFieldPanel,"displayName","CustomFieldPanel");var d=n(1353),p=n(1404);const m=({"data-test-subj":e,fields:t,groupsSelected:n=["none"],onGroupChange:i,options:o,title:s=d.d,maxGroupingLevels:l=1})=>{const[u,m]=Object(r.useState)(!1),f=Object(r.useCallback)((e=>!!n.find((t=>t===e))),[n]),g=Object(r.useMemo)((()=>{const e=e=>1!==l&&!(n.length!==l||e&&f(e));return[{id:"firstPanel",title:1===l?d.i:d.h(l),items:[{"data-test-subj":"panel-none",name:d.f,icon:f("none")?"check":"empty",onClick:()=>i("none")},...o.map((t=>({"data-test-subj":`panel-${t.key}`,disabled:e(t.key),name:t.label,onClick:()=>i(t.key),icon:f(t.key)?"check":"empty"}))),{"data-test-subj":"panel-custom",name:d.a,icon:"empty",disabled:e(),panel:"customPanel",hasPanel:!0}]},{id:"customPanel",title:d.e,width:685,content:Object(c.jsx)(custom_field_panel_CustomFieldPanel,{currentOptions:o.map((e=>({text:e.label,field:e.key}))),onSubmit:e=>{i(e),m(!1)},fields:t})}]}),[t,n.length,f,l,i,o]),b=Object(r.useMemo)((()=>o.filter((e=>f(e.key)))),[f,o]),y=Object(r.useCallback)((()=>m((e=>!e))),[]),h=Object(r.useCallback)((()=>m(!1)),[]),v=Object(r.useMemo)((()=>{const e=f("none")?d.f:n.reduce(((e,t)=>{const n=b.find((e=>e.key===t));return null==n?e:e?[e,n.label].join(", "):n.label}),"");return Object(c.jsx)(p.b,{"data-test-subj":"group-selector-dropdown",flush:"both",iconSide:"right",iconSize:"s",iconType:"arrowDown",onClick:y,title:e,size:"xs"},`${s}: ${e}`)}),[n,f,y,b,s]);return Object(c.jsx)(a.EuiPopover,{"data-test-subj":null!=e?e:"groupByPopover",button:v,closePopover:h,isOpen:u,panelPaddingSize:"none"},Object(c.jsx)(p.a,{"data-test-subj":"groupByContextMenu",initialPanelId:"firstPanel",panels:g}))},f=i.a.memo(m)},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(46),r=n(1448),i=n(399),o=n(752),s=n(400),l=n(574),c=n(1256),u=n(275),d=n(891),p=n(506),m=n(507),f=n(1284);const g=a.intersection([a.exact(a.type({description:i.a,entries:o.a,name:s.a,type:l.a})),a.exact(a.partial({comments:c.a,item_id:r.a,list_id:a[void 0],meta:u.a,namespace_type:d.b,os_types:p.c,tags:m.a,expire_time:f.a}))])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),r=n(50),i=n(1371);const o=new a.Type("DefaultUuid",a.string.is,((e,t)=>null==e?a.success(Object(r.v4)()):i.a.validate(e,t)),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(120);function r(e){return a.preprocess((e=>"string"==typeof e?""===e?[]:e.split(","):e),a.array(e))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n.n(a),i=n(43);const o=()=>Object(i.jsx)(a.Fragment,null),s=r.a.lazy((()=>n.e(56).then(n.bind(null,1413)))),l=function(e){return Object(i.jsx)(r.a.Suspense,{fallback:Object(i.jsx)(o,null)},Object(i.jsx)(s,e))}},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e&&e.trim().length!==e.length},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(1799),r=n(1490),i=n(2),o=n(45),s=n(124);const{updateShowBuildingBlockAlertsFilter:l,updateShowThreatIndicatorAlertsFilter:c}=a.a,u=e=>{const t=Object(o.useDispatch)(),n=Object(i.useMemo)((()=>a.b.getTableByIdSelector()),[]),{showOnlyThreatIndicatorAlerts:u,showBuildingBlockAlerts:d}=Object(s.b)((t=>{var a,i;return null!==(a=(null!==(i=n(t,e))&&void 0!==i?i:r.d).additionalFilters)&&void 0!==a?a:r.d.additionalFilters}));return{showBuildingBlockAlerts:d,setShowBuildingBlockAlerts:Object(i.useCallback)((n=>{t(l({id:e,showBuildingBlockAlerts:n}))}),[t,e]),showOnlyThreatIndicatorAlerts:u,setShowOnlyThreatIndicatorAlerts:Object(i.useCallback)((n=>{t(c({id:e,showOnlyThreatIndicatorAlerts:n}))}),[t,e])}}},,function(e,t,n){"use strict";var a=n(893);n.d(t,"b",(function(){return a.c}));var r=n(1354);n.d(t,"a",(function(){return r.a}))},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Se})),n.d(t,"b",(function(){return Te}));var a=n(2),r=n.n(a),i=n(52),o=n.n(i),s=n(42),l=n(3),c=n(8),u=n.n(c),d=(n(1088),n(19)),p=n(360),m=n(53);var f=n(480),g=n(55),b=n(1093);const y=(e,t)=>t?JSON.stringify(e):JSON.stringify(e,null,2),h=Object(g.createEscapeValue)({separator:",",quoteValues:!0,escapeFormulaValues:!0}),v=e=>h(e);var E=n(7),x=n(225),j=n(860),O=n(4),S=n(79),w=n(301),k=n(43);const I=({children:e})=>Object(k.jsx)("span",{className:"unifiedDataTable__rowControl"},e),T=O.i18n.translate("unifiedDataTable.copyEscapedValueWithFormulasToClipboardWarningText",{defaultMessage:"Values may contain formulas that are escaped."}),C=O.i18n.translate("unifiedDataTable.copyFailedErrorText",{defaultMessage:"Unable to copy to clipboard in this browser"}),M=({rowIndex:e,columnId:t,toastNotifications:n,valueToStringConverter:a})=>{const r=a(e,t),i=r.formattedString;if(!Object(d.copyToClipboard)(i))return n.addWarning({title:C}),null;const o=O.i18n.translate("unifiedDataTable.copyValueToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return r.withFormula?n.addWarning({title:o,text:T}):n.addInfo({title:o}),i},_=async({columnId:e,columnDisplayName:t,toastNotifications:n,valueToStringConverter:a,rowsCount:r})=>{const i=(e=>({formattedString:v(e),withFormula:Object(g.cellHasFormulas)(e)}))(t);let o=i.withFormula;const s=[...Array(r)].map(((t,n)=>{const r=a(n,e,{compatibleWithCSV:!0});return o=o||r.withFormula,r.formattedString})),l=`${i.formattedString}\n${s.join("\n")}`;let c;try{var u,p;await(null===(u=window.navigator)||void 0===u||null===(p=u.clipboard)||void 0===p?void 0:p.writeText(l)),c=!0}catch(e){c=Object(d.copyToClipboard)(l)}if(!c)return n.addWarning({title:C}),null;const m=O.i18n.translate("unifiedDataTable.copyColumnValuesToClipboard.toastTitle",{defaultMessage:'Values of "{column}" column copied to clipboard',values:{column:t}});return o?n.addWarning({title:m,text:T}):n.addInfo({title:m}),l},D=({columnDisplayName:e,toastNotifications:t})=>{if(!Object(d.copyToClipboard)(e))return t.addWarning({title:C}),null;const n=O.i18n.translate("unifiedDataTable.copyColumnNameToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return t.addInfo({title:n}),e};function N(e,t,n,a,r){const i=e.rows[t].flattened[n];r&&e.onFilter&&e.onFilter(r,i,a)}const A=({Component:e,rowIndex:t,columnId:n},r)=>{const i=Object(a.useContext)(w.a),o=O.i18n.translate("unifiedDataTable.grid.filterForAria",{defaultMessage:"Filter for this {value}",values:{value:n}});return Object(k.jsx)(e,{onClick:()=>{N(i,t,n,"+",r)},iconType:"plusInCircle","aria-label":o,title:o,"data-test-subj":"filterForButton"},O.i18n.translate("unifiedDataTable.grid.filterFor",{defaultMessage:"Filter for"}))},F=({Component:e,rowIndex:t,columnId:n},r)=>{const i=Object(a.useContext)(w.a),o=O.i18n.translate("unifiedDataTable.grid.filterOutAria",{defaultMessage:"Filter out this {value}",values:{value:n}});return Object(k.jsx)(e,{onClick:()=>{N(i,t,n,"-",r)},iconType:"minusInCircle","aria-label":o,title:o,"data-test-subj":"filterOutButton"},O.i18n.translate("unifiedDataTable.grid.filterOut",{defaultMessage:"Filter out"}))};var P=n(233);function R(e){switch(e){case P.b.IP:case P.b.GEO_SHAPE:case P.b.NUMBER:return"numeric";case P.b.BOOLEAN:return"boolean";case P.b.STRING:return"string";case P.b.DATE:return"datetime";default:return x.i}}function L({isPlainRecord:e,isFilterActive:t,rows:n,selectedDocs:r,setIsFilterActive:i,setSelectedDocs:o}){const[l,c]=Object(a.useState)(!1),u=Object(a.useCallback)((()=>[t?Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowAllDocuments",key:"showAllDocuments",icon:"eye",onClick:()=>{c(!1),i(!1)}},e?Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showAllResults",defaultMessage:"Show all results"}):Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showAllDocuments",defaultMessage:"Show all documents"})):Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowSelectedDocuments",key:"showSelectedDocuments",icon:"eye",onClick:()=>{c(!1),i(!0)}},e?Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showSelectedResultsOnly",defaultMessage:"Show selected results only"}):Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showSelectedDocumentsOnly",defaultMessage:"Show selected documents only"})),Object(k.jsx)(d.EuiCopy,{key:"copyJsonWrapper","data-test-subj":"dscGridCopySelectedDocumentsJSON",textToCopy:n?JSON.stringify(n.filter((e=>r.includes(e.id))).map((e=>e.raw))):""},(t=>Object(k.jsx)(d.EuiContextMenuItem,{key:"copyJSON",icon:"copyClipboard",onClick:t},e?Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.copyResultsToClipboardJSON",defaultMessage:"Copy results to clipboard (JSON)"}):Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.copyToClipboardJSON",defaultMessage:"Copy documents to clipboard (JSON)"})))),Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridClearSelectedDocuments",key:"clearSelection",icon:"cross",onClick:()=>{c(!1),o([]),i(!1)}},Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.clearSelection",defaultMessage:"Clear selection"}))]),[t,e,n,r,i,o]),p=Object(a.useCallback)((()=>c((e=>!e))),[]);return Object(k.jsx)(d.EuiPopover,{closePopover:()=>c(!1),isOpen:l,panelPaddingSize:"none",button:Object(k.jsx)(d.EuiDataGridToolbarControl,{iconType:"documents",onClick:p,"data-selected-documents":r.length,"data-test-subj":"unifiedDataTableSelectionBtn",isSelected:t,badgeContent:r.length},e?Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.selectedResultsButtonLabel",defaultMessage:"Selected",description:"Selected results"}):Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.selectedRowsButtonLabel",defaultMessage:"Selected",description:"Selected documents"}))},l&&Object(k.jsx)(d.EuiContextMenuPanel,{items:u(),"data-test-subj":"unifiedDataTableSelectionMenu"}))}const q=({selectedDocs:e,setIsCompareActive:t})=>Object(k.jsx)(d.EuiDataGridToolbarControl,{iconType:"diff",badgeContent:e.length,"data-test-subj":"unifiedDataTableCompareSelectedDocuments",onClick:()=>{t(!0)}},Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.compareSelectedRowsButtonLabel",defaultMessage:"Compare"}));function z({label:e,onCopy:t,dataTestSubj:n}){return{size:"xs",label:e,iconType:"copyClipboard",iconProps:{size:"m"},onClick:t,"data-test-subj":n}}function B({columnDisplayName:e,toastNotifications:t}){return z({label:Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnNameToClipBoardButton",defaultMessage:"Copy name"}),onCopy:()=>D({columnDisplayName:e,toastNotifications:t}),dataTestSubj:"gridCopyColumnNameToClipBoardButton"})}function $({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:r}){return z({label:Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnValuesToClipBoardButton",defaultMessage:"Copy column"}),onCopy:()=>_({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:r}),dataTestSubj:"gridCopyColumnValuesToClipBoardButton"})}var V=n(119),U=n.n(V),G=n(701),H=n(1451),W=n(655),Q=n(44),Y=n(49),K=({headerRowHeight:e,children:t})=>{const n=Object(k.css)("overflow-wrap:anywhere;white-space:normal;word-break:break-all;line-height:",Y.euiThemeVars.euiSize,";text-align:left;.euiDataGridHeaderCell--numeric &{float:right;}","");return e?Object(k.jsx)(d.EuiTextBlockTruncate,{lines:e,css:n},t):Object(k.jsx)("div",{css:n},t)};const Z=({columnDisplayName:e,showColumnTokens:t,columnName:n,columnsMeta:a,dataView:r,headerRowHeight:i})=>Object(k.jsx)(K,{headerRowHeight:i},t&&Object(k.jsx)(X,{columnName:n,columnsMeta:a,dataView:r}),Object(k.jsx)(J,{columnDisplayName:e})),X=e=>{const{columnName:t,columnsMeta:n,dataView:r}=e,i=Object(a.useMemo)((()=>function({dataView:e,columnName:t,columnsMeta:n}){if(!t||"_source"===t)return null;if(n){const e=(a=n[t])&&a.type?Object(G.a)({name:"",type:a.type,esTypes:a.esType?[a.esType]:[]}):null;return e&&"unknown"!==e?Object(k.jsx)(H.a,{type:e,css:ee}):null}var a;const r=e.getFieldByName(t);return r?Object(k.jsx)(H.a,U()({},Object(W.a)(r),{css:ee})):function(e,t){const n=new RegExp(Object(Q.escapeRegExp)(e)+"(\\.|$)");return!t.fields.getByName(e)&&!!t.fields.getAll().find((e=>{var t;const a=Object(m.getDataViewFieldSubtypeNested)(e);return!!a&&n.test(null!==(t=null==a?void 0:a.nested.path)&&void 0!==t?t:"")}))}(t,e)?Object(k.jsx)(H.a,{type:"nested",css:ee}):null}({columnName:t,columnsMeta:n,dataView:r})),[t,n,r]);return i?Object(k.jsx)("span",{css:Object(k.css)({paddingRight:Y.euiThemeVars.euiSizeXS},"","")},i):null},J=({columnDisplayName:e})=>Object(k.jsx)("span",{"data-test-subj":"unifiedDataTableColumnTitle"},e),ee={verticalAlign:"bottom"};var te={name:"1flj9lk",styles:"text-align:left"};const ne=({dataView:e,dataViewField:t,headerRowHeight:n=1,columnLabel:a})=>{var r;const i=a||(null!==(r=null==t?void 0:t.customLabel)&&void 0!==r?r:e.timeFieldName),o=O.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltipAriaLabel",{defaultMessage:"{timeFieldName} - this field represents the time that events occurred.",values:{timeFieldName:i}}),s=O.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltip",{defaultMessage:"This field represents the time that events occurred."});return Object(k.jsx)("div",{"aria-label":o,css:te},Object(k.jsx)(K,{headerRowHeight:n},i," ",Object(k.jsx)(d.EuiIconTip,{type:"clock",content:s})))},ae=r.a.memo(Z),re=r.a.memo(ne),ie="openDetails",oe="select",se={id:ie,width:26,headerCellRender:()=>Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("span",null,O.i18n.translate("unifiedDataTable.controlColumnHeader",{defaultMessage:"Control column"}))),rowCellRender:({rowIndex:e,setCellProps:t})=>{const n=Object(a.useRef)(null),[r,i]=Object(a.useState)(!1),{expanded:o,setExpanded:s,rows:l,isDarkMode:c,componentsTourSteps:u}=Object(a.useContext)(w.a),p=l[e],m=u?u.expandButton:void 0;Object(a.useEffect)((()=>{p.isAnchor?t({className:"unifiedDataTable__cell--highlight"}):o&&p&&o.id===p.id?t({className:"unifiedDataTable__cell--expanded"}):t({style:void 0})}),[o,p,t,c]);const f=p===o,g=O.i18n.translate("unifiedDataTable.grid.viewDoc",{defaultMessage:"Toggle dialog with details"}),b=p.isAnchor?"docTableExpandToggleColumnAnchor":"docTableExpandToggleColumn";return Object(a.useEffect)((()=>{!f&&r&&(i(!1),setTimeout((()=>{var e;null===(e=n.current)||void 0===e||e.hideToolTip()}),100))}),[f,i,r]),s?Object(k.jsx)(I,null,Object(k.jsx)(d.EuiToolTip,{content:g,delay:"long",ref:n},Object(k.jsx)(d.EuiButtonIcon,{id:0===e?m:void 0,size:"xs",iconSize:"s","aria-label":g,"data-test-subj":b,onClick:()=>{var e;const t=f?void 0:p;null===(e=n.current)||void 0===e||e.hideToolTip(),i(Boolean(t)),null==s||s(t)},color:f?"primary":"text",iconType:f?"minimize":"expand",isSelected:f}))):null}},le={id:oe,width:24,rowCellRender:({rowIndex:e,setCellProps:t})=>{const{euiTheme:n}=Object(d.useEuiTheme)(),{selectedDocs:r,expanded:i,rows:o,isDarkMode:s,setSelectedDocs:l}=Object(a.useContext)(w.a),c=Object(a.useMemo)((()=>o[e]),[o,e]),u=Object(a.useMemo)((()=>r.includes(c.id)),[r,c.id]),p=O.i18n.translate("unifiedDataTable.grid.selectDoc",{defaultMessage:"Select document ''{rowNumber}''",values:{rowNumber:e+1}});return Object(a.useEffect)((()=>{i&&c&&i.id===c.id?t({className:"unifiedDataTable__cell--selected"}):t({style:void 0})}),[i,c,t,s]),Object(k.jsx)(d.EuiFlexGroup,{responsive:!1,direction:"column",justifyContent:"center",className:"unifiedDataTable__rowControl",css:Object(k.css)("padding-block:",n.size.xs,";padding-left:",n.size.xs,";","")},Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(d.EuiCheckbox,{id:c.id,"aria-label":p,checked:u,"data-test-subj":`dscGridSelectDoc-${c.id}`,onChange:()=>{if(u){const e=r.filter((e=>e!==c.id));l(e)}else l([...r,c.id])}})))},headerCellRender:()=>Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("span",null,O.i18n.translate("unifiedDataTable.selectColumnHeader",{defaultMessage:"Select column"})))};function ce({columns:e,columnsCellActions:t,rowsCount:n,settings:a,dataView:r,defaultColumns:i,isSortEnabled:o,isPlainRecord:l,services:c,hasEditDataViewPermission:u,valueToStringConverter:d,onFilter:p,editField:m,visibleCellActions:f,columnsMeta:g,showColumnTokens:b,headerRowHeightLines:y,customGridColumnsConfiguration:h}){const v=e=>{var t,n,r;return null!==(t=null==a||null===(n=a.columns)||void 0===n||null===(r=n[e])||void 0===r?void 0:r.width)&&void 0!==t?t:0},E=(e=>{if(e!==x.d.auto)return e===x.d.single?1:e})(y),j=e.length;return e.map(((e,y)=>{var w,I;return function({numberOfColumns:e,columnName:t,columnWidth:n=0,dataView:a,defaultColumns:r,isSortEnabled:i,isPlainRecord:o,toastNotifications:l,hasEditDataViewPermission:c,valueToStringConverter:u,rowsCount:d,onFilter:p,editField:m,columnCellActions:f,visibleCellActions:g,columnsMeta:b,showColumnTokens:y,headerRowHeight:h,customGridColumnsConfiguration:v,columnDisplay:E}){var j,w,I,T,C;const _=o?new S.DataViewField({name:t,type:null!==(j=null==b||null===(w=b[t])||void 0===w?void 0:w.type)&&void 0!==j?j:"unknown",esTypes:null!=b&&null!==(I=b[t])&&void 0!==I&&I.esType?[b[t].esType]:void 0,searchable:!0,aggregatable:!1}):a.getFieldByName(t),D=m&&_&&(({hasEditDataViewPermission:e,dataView:t,field:n,editField:a})=>{if("_source"===n.name)return null;const{canEdit:r}=((e,t)=>{var n;const a=Boolean(null===(n=e.getFieldByName(t.name))||void 0===n?void 0:n.runtimeField);return{canEdit:!("unknown"===t.type||"unknown_selected"===t.type)||a,canDelete:a}})(t,n),i=e()||!t.isPersisted();return r&&i?{size:"xs",label:Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.grid.editFieldButton",defaultMessage:"Edit data view field"}),iconType:"pencil",iconProps:{size:"m"},onClick:()=>{a(n.name)},"data-test-subj":"gridEditFieldButton"}:null})({hasEditDataViewPermission:c,dataView:a,field:_,editField:m}),N=((e,t,n)=>n||("_source"===e?O.i18n.translate("unifiedDataTable.grid.documentHeader",{defaultMessage:"Document"}):t||e))(t,null==_?void 0:_.displayName,E);let P;P=null!=f&&f.length?f:_?function(e,t,n,a){return[...a&&e.filterable?[({Component:t,rowIndex:n,columnId:a})=>A({Component:t,rowIndex:n,columnId:a},e),({Component:t,rowIndex:n,columnId:a})=>F({Component:t,rowIndex:n,columnId:a},e)]:[],({Component:e,rowIndex:a,columnId:r})=>function({Component:e,rowIndex:t,columnId:n},a,r){const i=O.i18n.translate("unifiedDataTable.grid.copyClipboardButtonTitle",{defaultMessage:"Copy value of {column}",values:{column:n}});return Object(k.jsx)(e,{onClick:()=>{M({rowIndex:t,columnId:n,valueToStringConverter:r,toastNotifications:a})},iconType:"copyClipboard","aria-label":i,title:i,"data-test-subj":"copyClipboardButton"},O.i18n.translate("unifiedDataTable.grid.copyCellValueButton",{defaultMessage:"Copy value"}))}({Component:e,rowIndex:a,columnId:r},t,n)]}(_,l,u,p):[];const L={id:t,schema:R(null!==(T=null==b||null===(C=b[t])||void 0===C?void 0:C.type)&&void 0!==T?T:null==_?void 0:_.type),isSortable:i&&(o&&"_source"!==t||!0===(null==_?void 0:_.sortable)),display:y||1!==h?Object(k.jsx)(ae,{dataView:a,columnName:t,columnDisplayName:N,columnsMeta:b,showColumnTokens:y,headerRowHeight:h}):void 0,displayAsText:N,actions:{showHide:!r&&t!==a.timeFieldName&&{label:O.i18n.translate("unifiedDataTable.removeColumnLabel",{defaultMessage:"Remove column"}),iconType:"cross"},showMoveLeft:!r,showMoveRight:!r,additional:[..."__source"===t?[]:[B({columnDisplayName:N,toastNotifications:l})],$({columnId:t,columnDisplayName:N,toastNotifications:l,rowsCount:d,valueToStringConverter:u}),...D?[D]:[]]},cellActions:P,visibleCellActions:g};return L.id===a.timeFieldName&&(L.display=Object(k.jsx)(re,{dataView:a,dataViewField:_,headerRowHeight:h,columnLabel:E}),e>1&&(L.initialWidth=x.h)),n>0&&(L.initialWidth=Number(n)),v&&v[L.id]?v[L.id]({column:L,headerRowHeight:h}):L}({numberOfColumns:j,columnName:e,columnCellActions:null==t?void 0:t[y],columnWidth:v(e),dataView:r,defaultColumns:i,isSortEnabled:o,isPlainRecord:l,toastNotifications:c.toastNotifications,hasEditDataViewPermission:u,valueToStringConverter:d,rowsCount:n,onFilter:p,editField:m,visibleCellActions:f,columnsMeta:g,showColumnTokens:b,headerRowHeight:E,customGridColumnsConfiguration:h,columnDisplay:null==a||null===(w=a.columns)||void 0===w||null===(I=w[e])||void 0===I?void 0:I.display})}))}const ue=e=>{const{isLoadingMore:t,rowCount:n,sampleSize:r,pageIndex:i,pageCount:o,totalHits:l=0,onFetchMoreRecords:c,data:u}=e,p=u.query.timefilter.timefilter,[m,f]=Object(a.useState)(p.getRefreshInterval());Object(a.useEffect)((()=>{const e=p.getRefreshIntervalUpdate$().subscribe((()=>{f(p.getRefreshInterval())}));return()=>e.unsubscribe()}),[p,f]);const g=Boolean(m&&!1===m.pause&&m.value>0),{euiTheme:b}=Object(d.useEuiTheme)();return i===o-1&&n<l?c&&"boolean"==typeof t?n<=x.c-r?Object(k.jsx)(de,U()({hasButton:!0},e),Object(k.jsx)(d.EuiToolTip,{content:g?O.i18n.translate("unifiedDataTable.gridSampleSize.fetchMoreLinkDisabledTooltip",{defaultMessage:"To load more the refresh interval needs to be disabled first"}):void 0},Object(k.jsx)(d.EuiButtonEmpty,{disabled:g,isLoading:t,flush:"both","data-test-subj":"dscGridSampleSizeFetchMoreLink",onClick:c,css:Object(k.css)("margin-left:",b.size.xs,";","")},Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.fetchMoreLinkLabel",defaultMessage:"Load more"})))):Object(k.jsx)(de,U()({hasButton:!1},e)):n<l?Object(k.jsx)(de,U()({hasButton:!1},e)):null:null},de=({hasButton:e,rowCount:t,children:n,fieldFormats:a})=>{const{euiTheme:r}=Object(d.useEuiTheme)(),i=a.getDefaultInstance(P.b.NUMBER,[P.a.INTEGER]).convert(t);return Object(k.jsx)("p",{"data-test-subj":"unifiedDataTableFooter",css:Object(k.css)("display:flex;flex-direction:row;align-items:center;justify-content:center;flex-shrink:0;background-color:",r.colors.lightestShade,";padding:",e?`0 ${r.size.base}`:`${r.size.s} ${r.size.base}`,";margin-top:",r.size.xs,";text-align:center;","")},Object(k.jsx)("span",null,e?Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.lastPageDescription",defaultMessage:"Search results are limited to {rowCount} documents.",values:{rowCount:i}}):Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.limitDescription",defaultMessage:"Search results are limited to {sampleSize} documents. Add more search terms to narrow your search.",values:{sampleSize:i}})),n)};let pe=function(e){return e.auto="auto",e.single="single",e.custom="custom",e}({});const me=Object(d.htmlIdGenerator)()();function fe({label:e,rowHeight:t,rowHeightLines:n,compressed:a,onChangeRowHeight:i,onChangeRowHeightLines:o,maxRowHeight:s,"data-test-subj":l}){const c=[{id:`${me}${pe.single}`,label:O.i18n.translate("unifiedDataTable.rowHeight.single",{defaultMessage:"Single"}),"data-test-subj":`${l}_rowHeight_${pe.single}`},{id:`${me}${pe.auto}`,label:O.i18n.translate("unifiedDataTable.rowHeight.auto",{defaultMessage:"Auto fit"}),"data-test-subj":`${l}_rowHeight_${pe.auto}`},{id:`${me}${pe.custom}`,label:O.i18n.translate("unifiedDataTable.rowHeight.custom",{defaultMessage:"Custom"}),"data-test-subj":`${l}_rowHeight_${pe.custom}`}];return Object(k.jsx)(r.a.Fragment,null,Object(k.jsx)(d.EuiFormRow,{label:e,display:"columnCompressed","data-test-subj":l},Object(k.jsx)(r.a.Fragment,null,Object(k.jsx)(d.EuiButtonGroup,{isFullWidth:!0,legend:e,buttonSize:"compressed",options:c,idSelected:`${me}${null!=t?t:pe.single}`,onChange:e=>{const t=e.replace(me,"");i(t)},"data-test-subj":`${l}_rowHeightButtonGroup`}),t===pe.custom?Object(k.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,showInput:!0,min:1,max:null!=s?s:20,step:1,value:null!=n?n:2,onChange:e=>{const t=Number(e.currentTarget.value);o(t)},"data-test-subj":`${l}_lineCountNumber`,css:Object(k.css)({marginTop:a?Y.euiThemeVars.euiSizeXS:Y.euiThemeVars.euiSizeM},"","")}):null)))}const ge=()=>{},be=({rowHeight:e,rowHeightLines:t,onChangeRowHeight:n,onChangeRowHeightLines:i,headerRowHeight:o,headerRowHeightLines:s,onChangeHeaderRowHeight:l,onChangeHeaderRowHeightLines:c,maxAllowedSampleSize:u=1e3,sampleSize:p,onChangeSampleSize:m})=>{const[f,g]=Object(a.useState)(p),b=Math.max(Math.min(10,p),1),y=Object(a.useMemo)((()=>Object(E.debounce)(null!=m?m:ge,300,{leading:!1,trailing:!0})),[m]),h=Object(a.useCallback)((e=>{var t;if(!e.target.value)return void g("");const n=null!==(t=parseInt(e.target.value,10))&&void 0!==t?t:10;n>=1&&(g(n),n<=u&&y(n))}),[u,g,y]),v=O.i18n.translate("unifiedDataTable.sampleSizeSettings.sampleSizeLabel",{defaultMessage:"Sample size"});Object(a.useEffect)((()=>{g(p)}),[p,g]);const x=[];return l&&c&&x.push(Object(k.jsx)(fe,{rowHeight:o,rowHeightLines:s,label:O.i18n.translate("unifiedDataTable.headerRowHeightLabel",{defaultMessage:"Header row height"}),onChangeRowHeight:l,onChangeRowHeightLines:c,"data-test-subj":"unifiedDataTableHeaderRowHeightSettings",maxRowHeight:5})),n&&i&&x.push(Object(k.jsx)(fe,{rowHeight:e,rowHeightLines:t,label:O.i18n.translate("unifiedDataTable.rowHeightLabel",{defaultMessage:"Cell row height"}),onChangeRowHeight:n,onChangeRowHeightLines:i,"data-test-subj":"unifiedDataTableRowHeightSettings"})),m&&x.push(Object(k.jsx)(d.EuiFormRow,{label:v,display:"columnCompressed"},Object(k.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,min:b,max:u,step:10===b?10:1,showInput:!0,value:f,onChange:h,"data-test-subj":"unifiedDataTableSampleSizeInput"}))),Object(k.jsx)(r.a.Fragment,null,x.map(((e,t)=>Object(k.jsx)(r.a.Fragment,{key:`setting-${t}`},t>0&&Object(k.jsx)(d.EuiHorizontalRule,{margin:"s"}),e))))},ye=e=>"number"==typeof e&&!Number.isNaN(e)&&Math.floor(e)===e&&e>=-1&&e<=20,he=(e,t)=>`${e}:${t}`,ve=(e,t,n,a,r)=>{n.set(he(a,r),{previousRowHeight:e,previousConfigRowHeight:t})},Ee=({storage:e,consumer:t,key:n,configRowHeight:r,rowHeightState:i,onUpdateRowHeight:o})=>{const s=Object(a.useMemo)((()=>{const a=((e,t,n)=>{const a=e.get(he(t,n));return"object"==typeof a&&null!==a&&ye(a.previousRowHeight)&&ye(a.previousConfigRowHeight)?a:null})(e,t,n);let o;var s;return o=ye(i)?i:null!==(s=a)&&r===s.previousConfigRowHeight?a.previousRowHeight:r,o}),[r,t,n,i,e]),l=Object(a.useMemo)((()=>{switch(s){case x.d.auto:return pe.auto;case x.d.single:return pe.single;default:return pe.custom}}),[s]),c=Object(a.useCallback)((a=>{let i;switch(a){case pe.auto:i=x.d.auto;break;case pe.single:i=x.d.single;break;default:i=r}ve(i,r,e,t,n),null==o||o(i)}),[r,t,n,o,e]),u=Object(a.useCallback)((a=>{ve(a,r,e,t,n),null==o||o(a)}),[r,t,n,o,e]);return{rowHeight:l,rowHeightLines:s,onChangeRowHeight:o?c:void 0,onChangeRowHeightLines:o?u:void 0}};var xe=n(1494);const je=Object(xe.a)(Object(a.lazy)((()=>n.e(48).then(n.bind(null,2116))))),Oe="unifiedDataTable__fullScreen";let Se=function(e){return e.loading="loading",e.loadingMore="loadingMore",e.loaded="loaded",e}({});const we={darkMode:!1},ke=r.a.memo(d.EuiDataGrid),Ie=["openDetails","select"],Te=({ariaLabelledBy:e,columns:t,columnsMeta:n,showColumnTokens:i,configHeaderRowHeight:c,headerRowHeightState:h,onUpdateHeaderRowHeight:O,controlColumnIds:S=Ie,dataView:I,loadingState:T,onFilter:C,onResize:M,onSetColumns:_,onSort:D,rows:N,searchDescription:A,searchTitle:F,settings:P,showTimeCol:R,showFullScreenButton:z=!0,sort:B,useNewFieldsApi:$,isSortEnabled:V=!0,isPaginationEnabled:U=!0,cellActionsTriggerId:G,className:H,rowHeightState:W,onUpdateRowHeight:Q,maxAllowedSampleSize:Y,sampleSizeState:K,onUpdateSampleSize:Z,isPlainRecord:X=!1,rowsPerPageState:J,onUpdateRowsPerPage:ee,onFieldEdited:te,services:ne,renderCustomGridBody:ae,renderCustomToolbar:re,trailingControlColumns:de,totalHits:pe,onFetchMoreRecords:me,renderDocumentView:fe,setExpandedDoc:ge,expandedDoc:ye,configRowHeight:he,showMultiFields:ve=!0,maxDocFieldsDisplayed:xe=50,externalControlColumns:Te,externalAdditionalControls:Ce,rowsPerPageOptions:Me,visibleCellActions:_e,externalCustomRenderers:De,additionalFieldGroups:Ne,consumer:Ae="discover",componentsTourSteps:Fe,gridStyleOverride:Pe,rowLineHeightOverride:Re,cellActionsMetadata:Le,customGridColumnsConfiguration:qe,customControlColumnsConfiguration:ze,enableComparisonMode:Be,cellContext:$e,renderCellPopover:Ve})=>{var Ue,Ge,He,We;const{fieldFormats:Qe,toastNotifications:Ye,dataViewFieldEditor:Ke,uiSettings:Ze,storage:Xe,data:Je}=ne,{darkMode:et}=u()(null!==(Ue=null===(Ge=ne.theme)||void 0===Ge?void 0:Ge.theme$)&&void 0!==Ue?Ue:Object(l.of)(we),we),tt=Object(a.useRef)(null),[nt,at]=Object(a.useState)([]),[rt,it]=Object(a.useState)(!1),[ot,st]=Object(a.useState)(!1),lt=Object(f.a)(t,I),ct=lt.includes("_source"),ut=Object(a.useMemo)((()=>{var e;return new Map(null!==(e=null==N?void 0:N.map((e=>[e.id,e])))&&void 0!==e?e:[])}),[N]),dt=Object(a.useCallback)((e=>ut.get(e)),[ut]),pt=Object(a.useMemo)((()=>{if(!nt.length||null==N||!N.length)return[];const e=nt.filter((e=>!!dt(e)));return 0===e.length&&rt&&it(!1),e}),[nt,null==N?void 0:N.length,rt,dt]),mt=Object(a.useMemo)((()=>{if(!N)return[];if(!rt||0===pt.length)return N;const e=N.filter((e=>pt.includes(e.id)));return e.length?e:N}),[N,pt,rt]),ft=Object(a.useCallback)(((e,t,n)=>(({rowIndex:e,rows:t,columnId:n,dataView:a,fieldFormats:r,options:i})=>{var o,s;if(!t[e])return{formattedString:"",withFormula:!1};const l=t[e].flattened,c=null==l?void 0:l[n],u=a.fields.getByName(n),d=Array.isArray(c)?c:[c],p=null!==(o=null==i?void 0:i.compatibleWithCSV)&&void 0!==o&&o,m=null!==(s=null==i?void 0:i.compatibleWithCSV)&&void 0!==s&&s;if("_source"===(null==u?void 0:u.type))return{formattedString:y(l,p),withFormula:!1};let f=!1;return{formattedString:d.map((n=>{const i=Object(b.a)(n,t[e].raw,r,a,u,"text",{skipFormattingInStringifiedJSON:p});return"string"==typeof i?(f=f||Object(g.cellHasFormulas)(i),m?v(i):i):y(i,p)||""})).join(", "),withFormula:f}})({rowIndex:e,rows:mt,dataView:I,columnId:t,fieldFormats:Qe,options:n})),[mt,I,Qe]),gt=Object(a.useMemo)((()=>({expanded:ye,setExpanded:ge,rows:mt,onFilter:C,dataView:I,isDarkMode:et,selectedDocs:pt,setSelectedDocs:e=>{at(e),rt&&0===e.length&&it(!1)},valueToStringConverter:ft,componentsTourSteps:Fe,isPlainRecord:X})),[Fe,et,I,X,mt,ye,rt,C,ge,pt,ft]),bt="number"==typeof J&&J>0?J:x.a,[yt,ht]=Object(a.useState)({pageIndex:0,pageSize:bt}),vt=Object(a.useMemo)((()=>mt?mt.length:0),[mt]),Et=Object(a.useMemo)((()=>Math.ceil(vt/yt.pageSize)),[vt,yt]),xt=Object(a.useMemo)((()=>{return U?{onChangeItemsPerPage:e=>{null==ee||ee(e)},onChangePage:e=>ht((t=>({...t,pageIndex:e}))),pageIndex:yt.pageIndex>Et-1?0:yt.pageIndex,pageSize:yt.pageSize,pageSizeOptions:null!=Me?Me:(e=yt.pageSize,Object(E.sortBy)(Object(E.uniq)("number"==typeof e&&e>0?[...x.e,e]:x.e)))}:void 0;var e}),[U,yt.pageIndex,yt.pageSize,Et,Me,ee]);Object(a.useEffect)((()=>{ht((e=>e.pageSize===bt?e:{...e,pageSize:bt}))}),[bt,ht]);const jt=Object(a.useMemo)((()=>((e,t,n)=>{if(n)return()=>!0;const a=new Map;return e.forEach((e=>{a.set(e,((e,t)=>{var n;const a=t.fields.getByName(e);if(!a)return{show:!0};const r=Object(m.getDataViewFieldSubtypeMulti)(a.spec);return{show:!Boolean(null==r?void 0:r.multi),parentName:null==r||null===(n=r.multi)||void 0===n?void 0:n.parent}})(e,t))})),e=>{const t=a.get(e);return!t||t.show||!!t.parentName&&!a.has(t.parentName)}})(I.fields.getAll().map((e=>e.name)),I,ve)),[I,ve]),Ot=Object(a.useMemo)((()=>Object(j.b)({dataView:I,rows:mt,useNewFieldsApi:$,shouldShowFieldHandler:jt,closePopover:()=>{var e;return null===(e=tt.current)||void 0===e?void 0:e.closeCellPopover()},fieldFormats:Qe,maxEntries:xe,externalCustomRenderers:De,isPlainRecord:X})),[I,mt,$,jt,xe,Qe,De,X]),St=Object(a.useMemo)((()=>null!=Ve?Ve:(()=>{const e=Object(a.memo)((function(e){const{setCellPopoverProps:t,DefaultCellPopover:n}=e;return Object(a.useEffect)((()=>{t({panelClassName:"unifiedDataTable__cellPopover"})}),[t]),Object(k.jsx)(n,e)}));return t=>Object(k.jsx)(e,t)})()),[Ve]),wt=Object(a.useMemo)((()=>Object(d.htmlIdGenerator)()()),[]),kt=Object(a.useRef)();Object(a.useEffect)((()=>()=>{null!=kt&&kt.current&&(null==kt||kt.current())}),[]);const It=Object(a.useMemo)((()=>te?async e=>{var t;kt.current=te&&await(null==ne||null===(t=ne.dataViewFieldEditor)||void 0===t?void 0:t.openEditor({ctx:{dataView:I},fieldName:e,onSave:async()=>{await te()}}))}:void 0),[I,te,null==ne?void 0:ne.dataViewFieldEditor]),Tt=I.timeFieldName,Ct=Object(a.useCallback)((e=>function(e,t,n,a,r){return!(!a||!t)&&(!r||!!n&&t in n&&e.includes("_source"))}(e,Tt,n,R,X)),[Tt,X,R,n]),Mt=Object(a.useMemo)((()=>function(e,t,n){const a=t.timeFieldName;return n&&a&&!e.find((e=>e===a))?[a,...e]:e}(lt,I,Ct(lt))),[I,lt,Ct]),_t=Object(a.useCallback)(((e,t)=>mt[t%mt.length].flattened[e]),[mt]),Dt=Object(a.useMemo)((()=>G&&!X?Mt.map((e=>{var t,n;return null!==(t=null===(n=I.getFieldByName(e))||void 0===n?void 0:n.toSpec())&&void 0!==t?t:{name:"",type:"",aggregatable:!1,searchable:!1}})):void 0),[G,X,Mt,I]),Nt=Object(a.useMemo)((()=>({dataViewId:I.id,...null!=Le?Le:{}})),[I,Le]),At=Object(p.c)({fields:Dt,getCellValue:_t,triggerId:G,dataGridRef:tt,metadata:Nt}),{rowHeight:Ft,rowHeightLines:Pt,onChangeRowHeight:Rt,onChangeRowHeightLines:Lt}=Ee({storage:Xe,consumer:Ae,key:"dataGridHeaderRowHeight",configRowHeight:null!=c?c:1,rowHeightState:h,onUpdateRowHeight:O}),{rowHeight:qt,rowHeightLines:zt,onChangeRowHeight:Bt,onChangeRowHeightLines:$t}=Ee({storage:Xe,consumer:Ae,key:"dataGridRowHeight",configRowHeight:null!=he?he:x.d.default,rowHeightState:W,onUpdateRowHeight:Q}),Vt=Object(a.useMemo)((()=>ce({columns:Mt,columnsCellActions:At,rowsCount:mt.length,settings:P,dataView:I,defaultColumns:ct,isSortEnabled:V,isPlainRecord:X,services:{uiSettings:Ze,toastNotifications:Ye},hasEditDataViewPermission:()=>{var e;return Boolean(null==Ke||null===(e=Ke.userPermissions)||void 0===e?void 0:e.editIndexPattern())},valueToStringConverter:ft,onFilter:C,editField:It,visibleCellActions:_e,columnsMeta:n,showColumnTokens:i,headerRowHeightLines:Pt,customGridColumnsConfiguration:qe})),[n,At,qe,I,Ke,ct,mt.length,It,Pt,X,V,C,P,i,Ye,Ze,ft,_e,Mt]),Ut=Object(a.useMemo)((()=>[{type:x.i,detector:()=>0,sortTextAsc:"",sortTextDesc:"",icon:"",color:""}]),[]),Gt=Object(a.useMemo)((()=>({visibleColumns:Mt,setVisibleColumns:e=>{const t=!Ct(e);_(e,t)}})),[Mt,_,Ct]),Ht=Object(a.useMemo)((()=>B.map((([e,t])=>({id:e,direction:t}))).filter((({id:e})=>Mt.includes(e)))),[B,Mt]),Wt=Object(a.useCallback)((e=>{V&&D&&D(e.map((({id:e,direction:t})=>[e,t])))}),[D,V]),Qt=Object(a.useMemo)((()=>{if(V){if(X&&!t.length)return;return{columns:Ht,onSort:Wt}}return{columns:Ht,onSort:()=>{}}}),[V,Ht,X,t.length,Wt]),Yt=Boolean(ge&&!!fe),Kt=Object(a.useMemo)((()=>{const e=function(e){return e?[se,le]:[le]}(Yt).filter((({id:e})=>S.includes(e)));return Te?[...e,...Te]:e}),[Yt,S,Te]),Zt=null==ze?void 0:ze({controlColumns:{[oe]:le,[ie]:se}}),Xt=null!==(He=null==Zt?void 0:Zt.leadingControlColumns)&&void 0!==He?He:Kt,Jt=null!==(We=null==Zt?void 0:Zt.trailingControlColumns)&&void 0!==We?We:de,en=Object(a.useMemo)((()=>Ce||pt.length?Object(k.jsx)(r.a.Fragment,null,Boolean(pt.length)&&Object(k.jsx)(d.EuiFlexGroup,{gutterSize:"s",responsive:!1},Be&&pt.length>1&&Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(q,{selectedDocs:pt,setIsCompareActive:st})),Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(L,{isPlainRecord:X,isFilterActive:rt,rows:N,selectedDocs:pt,setSelectedDocs:at,setIsFilterActive:it}))),Ce):null),[Ce,pt,X,rt,Be,N]),tn=Object(a.useMemo)((()=>re?e=>re({toolbarProps:e,gridProps:{additionalControls:en}}):void 0),[re,en]),nn=Object(a.useMemo)((()=>{const e={};return Q&&(e.allowDensity=!1),(Q||O||Z)&&(e.allowRowHeight=!1,e.allowResetButton=!1,e.additionalDisplaySettings=Object(k.jsx)(be,{rowHeight:qt,rowHeightLines:zt,onChangeRowHeight:Bt,onChangeRowHeightLines:$t,headerRowHeight:Ft,headerRowHeightLines:Pt,onChangeHeaderRowHeight:Rt,onChangeHeaderRowHeightLines:Lt,maxAllowedSampleSize:Y,sampleSize:K,onChangeSampleSize:Z})),Object.keys(e).length?e:void 0}),[Ft,Pt,Y,Rt,Lt,Bt,$t,O,Q,Z,qt,zt,K]),an=Object(a.useMemo)((()=>X&&t.length?{level:"sorting"}:void 0),[t.length,X]),rn=Object(a.useMemo)((()=>ct?{...x.j,showColumnSelector:!1,showSortSelector:V,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:z}:{...x.j,showSortSelector:V,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:z}),[ct,V,en,nn,z]),on=(({rowHeightLines:e,rowLineHeight:t=x.g})=>Object(a.useMemo)((()=>{var n;return{defaultHeight:(n=e)===x.d.auto?"auto":n!==x.d.single?{lineCount:n}:void 0,lineHeight:t}}),[e,t]))({rowHeightLines:zt,rowLineHeight:Re}),{dataGridId:sn,dataGridWrapper:ln,setDataGridWrapper:cn}=(()=>{const e=Object(d.useGeneratedHtmlId)({prefix:"unifiedDataTable"}),[t,n]=Object(a.useState)(null),[r,i]=Object(a.useState)(null),o=Object(a.useCallback)(((t,n)=>{const a=document.getElementById(e);a&&(i(a),n.disconnect())}),[e]),s=Object(a.useCallback)((()=>{r&&(e=>{e.classList.contains("euiDataGrid--fullScreen")?document.body.classList.add(Oe):document.body.classList.remove(Oe)})(r)}),[r]);return Object(d.useMutationObserver)(t,o,{childList:!0,subtree:!0}),Object(d.useMutationObserver)(r,s,{attributes:!0,attributeFilter:["class"]}),{dataGridId:e,dataGridWrapper:t,setDataGridWrapper:n}})(),un=T!==Se.loading;return vt||T!==Se.loading?vt?Object(k.jsx)(w.a.Provider,{value:gt},Object(k.jsx)("span",{className:"unifiedDataTable__inner"},Object(k.jsx)("div",{ref:cn,key:ot?"comparisonTable":"docTable","data-test-subj":"discoverDocTable","data-render-complete":un,"data-shared-item":"","data-title":F,"data-description":A,"data-document-number":mt.length,className:o()(H,"unifiedDataTable__table")},ot?Object(k.jsx)(je,{id:sn,wrapper:ln,consumer:Ae,ariaDescribedBy:wt,ariaLabelledBy:e,dataView:I,isPlainRecord:X,selectedFieldNames:Mt,additionalFieldGroups:Ne,selectedDocs:nt,schemaDetectors:Ut,forceShowAllFields:ct,showFullScreenButton:z,fieldFormats:Qe,getDocById:dt,setSelectedDocs:at,setIsCompareActive:st}):Object(k.jsx)(ke,{id:sn,"aria-describedby":wt,"aria-labelledby":e,columns:Vt,columnVisibility:Gt,"data-test-subj":"docTable",leadingControlColumns:Xt,onColumnResize:M,pagination:xt,renderCellValue:Ot,ref:tt,rowCount:vt,schemaDetectors:Ut,sorting:Qt,toolbarVisibility:rn,rowHeightsOptions:on,inMemory:an,gridStyle:null!=Pe?Pe:x.b,renderCustomGridBody:ae,renderCustomToolbar:tn,trailingControlColumns:Jt,cellContext:$e,renderCellPopover:St})),T!==Se.loading&&!pt.length&&U&&!ot&&Object(k.jsx)(ue,{isLoadingMore:T===Se.loadingMore,rowCount:vt,sampleSize:K,pageCount:Et,pageIndex:null==xt?void 0:xt.pageIndex,totalHits:pe,onFetchMoreRecords:me,data:Je,fieldFormats:Qe}),F&&Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("p",{id:String(wt)},A?Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescriptionGrid",defaultMessage:"Table generated by search {searchTitle} ({searchDescription})",values:{searchTitle:F,searchDescription:A}}):Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescription",defaultMessage:"Table generated by search {searchTitle}",values:{searchTitle:F}}))),Yt&&ye&&fe(ye,mt,lt,n))):Object(k.jsx)("div",{className:"euiDataGrid__noResults","data-render-complete":un,"data-shared-item":"","data-title":F,"data-description":A,"data-document-number":0},Object(k.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(k.jsx)(d.EuiIcon,{type:"discoverApp",size:"m",color:"subdued"}),Object(k.jsx)(d.EuiSpacer,{size:"s"}),Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.noResultsFound",defaultMessage:"No results found"}))):Object(k.jsx)("div",{className:"euiDataGrid__loading","data-test-subj":"unifiedDataTableLoading"},Object(k.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(k.jsx)(d.EuiLoadingSpinner,null),Object(k.jsx)(d.EuiSpacer,{size:"s"}),Object(k.jsx)(s.FormattedMessage,{id:"unifiedDataTable.loadingResults",defaultMessage:"Loading results"})))}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n(204),i=n(818);const o=e=>Object(a.useMemo)((()=>({async addExceptionListItem({listItem:t}){const n=new AbortController,a=Object(i.c)(t);return r.a({http:e,listItem:a,signal:n.signal})},async deleteExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:i}){const o=new AbortController;try{await r.e({http:e,id:t,namespaceType:n,signal:o.signal}),a()}catch(e){i(e)}},async deleteExceptionList({id:t,namespaceType:n,onSuccess:a,onError:i}){const o=new AbortController;try{await r.d({http:e,id:t,namespaceType:n,signal:o.signal}),a()}catch(e){i(e)}},async duplicateExceptionList({includeExpiredExceptions:t,listId:n,namespaceType:a,onError:i,onSuccess:o}){const s=new AbortController;try{o(await r.h({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:s.signal}))}catch(e){i(e)}},async exportExceptionList({id:t,includeExpiredExceptions:n,listId:a,namespaceType:i,onError:o,onSuccess:s}){const l=new AbortController;try{s(await r.i({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:i,signal:l.signal}))}catch(e){o(e)}},async getExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:o}){const s=new AbortController;try{a(Object(i.b)(await r.l({http:e,id:t,namespaceType:n,signal:s.signal})))}catch(e){o(e)}},async getExceptionList({id:t,namespaceType:n,onSuccess:a,onError:i}){const o=new AbortController;try{a(await r.k({http:e,id:t,namespaceType:n,signal:o.signal}))}catch(e){i(e)}},async getExceptionListsItems({lists:t,filter:n,pagination:a,showDetectionsListsOnly:o,showEndpointListsOnly:s,onSuccess:l,onError:c}){const u=new AbortController,{ids:d,namespaces:p}=(({lists:e,showDetection:t,showEndpoint:n})=>e.filter((e=>t?"detection"===e.type:!n||"endpoint"===e.type)).reduce(((e,{listId:t,namespaceType:n})=>({ids:[...e.ids,t],namespaces:[...e.namespaces,n]})),{ids:[],namespaces:[]}))({lists:t,showDetection:o,showEndpoint:s});try{if(d.length>0&&p.length>0){const{data:t,page:o,per_page:s,total:c}=await r.n({filter:n,http:e,listIds:d,namespaceTypes:p,pagination:a,signal:u.signal});l({exceptions:t.map((e=>Object(i.b)(e))),pagination:{page:o,perPage:s,total:c}})}else l({exceptions:[],pagination:{page:0,perPage:null!=a.perPage?a.perPage:0,total:0}})}catch(e){c(e)}},async getExceptionFilterFromIds({exceptionListIds:t,chunkSize:n,alias:a,excludeExceptions:i,onSuccess:o,onError:s}){const l=new AbortController;try{const{filter:s}=await r.q({http:e,exceptionListIds:t,signal:l.signal,chunkSize:n,alias:a,excludeExceptions:i});o(s)}catch(e){s(e)}},async getExceptionFilterFromExceptions({exceptions:t,chunkSize:n,alias:a,excludeExceptions:i,onSuccess:o,onError:s}){const l=new AbortController;try{const{filter:s}=await r.r({http:e,exceptions:t,signal:l.signal,chunkSize:n,alias:a,excludeExceptions:i});o(s)}catch(e){s(e)}},async updateExceptionListItem({listItem:t}){const n=new AbortController,a=Object(i.d)(t);return r.y({http:e,listItem:a,signal:n.signal})}})),[e])},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(119),r=n.n(a),i=n(84),o=n(2),s=n.n(o),l=n(19),c=n(43),u={name:"1azakc",styles:"text-align:center"};const d=()=>{const e=u;return Object(c.jsx)("div",{css:e},Object(c.jsx)(l.EuiLoadingSpinner,null))},p=(e,t=Object(c.jsx)(d,null))=>s.a.forwardRef(((n,a)=>Object(c.jsx)(i.KibanaErrorBoundaryProvider,{analytics:n.analytics},Object(c.jsx)(i.KibanaErrorBoundary,null,Object(c.jsx)(o.Suspense,{fallback:t},Object(c.jsx)(e,r()({},n,{ref:a})))))))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const r=new a.Type("IsoDateString",a.string.is,((e,t)=>{if("string"!=typeof e)return a.failure(e,t);try{return new Date(e).toISOString()===e?a.success(e):a.failure(e,t)}catch(n){return a.failure(e,t)}}),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>t=>{const n=null!=t.signal?t.signal:(new AbortController).signal;return e({...t,signal:n})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(1213);const i=e=>{const t=Object(r.a)(),[n,i]=Object(a.useState)(!1),[o,s]=Object(a.useState)(),[l,c]=Object(a.useState)();return{error:o,loading:n,result:l,start:Object(a.useCallback)(((...n)=>{i(!0),c(void 0),s(void 0),e(...n).then((e=>t()&&c(e))).catch((e=>t()&&s(e))).finally((()=>t()&&i(!1)))}),[e,t])}}},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"g",(function(){return f}));var a=n(50),r=n(1342),i=n(1870),o=(n(1619),n(1282),n(1283),n(796),n(1328),n(1556),n(1447),n(403));n(750),n(53),n(233),n(1470);const s=e=>e.map((e=>"nested"===e.type?Object(r.a)({...e,entries:e.entries.map((e=>Object(r.a)(e)))}):Object(r.a)(e))),l=({listId:e,namespaceType:t,name:n})=>({comments:[],description:"Exception list item",entries:s([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:e,meta:{temporaryUuid:Object(a.v4)()},name:n,namespace_type:t,tags:[],type:"simple"}),c=e=>{switch(e.type){case"match":return o.b.MATCH;case"match_any":return o.b.MATCH_ANY;case"wildcard":return o.b.WILDCARD;case"list":return o.b.LIST;default:return o.b.EXISTS}},u=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time > "${t}" OR NOT ${e}.attributes.expire_time: *`)).join(",")},d=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time <= "${t}"`)).join(",")},p=e=>{let t=e.match(/.ds-(.*?)-[0-9]{4}\.[0-9]{2}\.[0-9]{2}-[0-9]{6}/);return t&&2===t.length?t[1]:(t=e.match(/.siem-(.*?)-[0-9]{6}/),t&&2===t.length?`.siem-${t[1]}`:e)},m=e=>{if(!e.conflictDescriptions)return null;const t=[];for(const[n,a]of Object.entries(e.conflictDescriptions)){const e=[],r={};a.forEach((e=>{const t=p(e);r[t]||(r[t]=0),r[t]++}));for(const[t,n]of Object.entries(r))e.push({name:t,count:n});e.sort(((e,t)=>t.count-e.count)),t.push({type:n,totalIndexCount:a.length,groupedIndices:e})}return t},f=e=>e.flatMap((e=>e.entries)).some((e=>{if("list"!==e.type&&"value"in e)return Object(i.f)({operator:e.type,value:e.value})}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(46),r=n(1448),i=n(1256),o=n(506),s=n(399),l=n(255),c=n(400),u=n(574),d=n(275),p=n(456),m=n(507),f=n(752),g=n(1284);const b=a.intersection([a.exact(a.type({description:s.a,entries:f.a,list_id:l.a,name:c.a,type:u.a})),a.exact(a.partial({comments:i.a,expire_time:g.a,item_id:r.a,meta:d.a,namespace_type:p.a,os_types:o.c,tags:m.a}))])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(204),r=n(1532),i=n(1533);const o=Object(r.a)(a.t),s=()=>Object(i.a)(o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(1559);const r=e=>{try{const t=Object(a.a)(e);return i(t)}catch(e){return[]}},i=e=>e?e.split(",").map((e=>e.trim())):[]},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(89);function r(e){var t;const{ast:n}=Object(a.getAstAndSyntaxErrors)(e),r=n.find((({name:e})=>["from","metrics"].includes(e))),i=(null!==(t=null==r?void 0:r.args)&&void 0!==t?t:[]).filter((e=>"index"===e.sourceType));return null==i?void 0:i.map((e=>e.text)).join(",")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n(2);var a=n(42),r=n(4),i=n(19),o=n(43);const s=()=>Object(o.jsx)(i.EuiCallOut,{title:r.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.title",{defaultMessage:"Please review your entries"}),iconType:"warning",color:"warning",size:"s","data-test-subj":"wildcardWithWrongOperatorCallout"},Object(o.jsx)("p",null,Object(o.jsx)(a.FormattedMessage,{id:"exceptionList-components.wildcardWithWrongOperatorCallout.body",defaultMessage:'Using a "*" or a "?" in the value with the "is" operator can make the entry ineffective. {operator} to "{matches}" to ensure wildcards run properly.',values:{operator:Object(o.jsx)("strong",null,r.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.changeTheOperator",{defaultMessage:"Change the operator"})),matches:Object(o.jsx)("strong",null,r.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.matches",{defaultMessage:"matches"}))}})))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n.n(a),i=n(43),o=n(19),s=n(49),l=n(1314),c=n(842),u=n(1315),d=n.n(u);const p=Object(i.css)("margin:",s.euiThemeVars.euiSizeL," 0;padding:",s.euiThemeVars.euiSizeL," 0;",""),m=({title:e,body:t,buttonText:n,listType:r,isReadOnly:s,viewerStatus:u,onEmptyButtonStateClick:m})=>{const{euiTheme:f}=Object(o.useEuiTheme)(),g=Object(a.useMemo)((()=>{switch(u){case l.a.ERROR:return{color:"danger",iconType:"error",title:Object(i.jsx)("h2",{"data-test-subj":"errorTitle"},e||c.g),body:Object(i.jsx)("p",{"data-test-subj":"errorBody"},t||c.f),"data-test-subj":"errorViewerState"};case l.a.EMPTY:return{color:"subdued",iconType:"plusInCircle",iconColor:f.colors.darkestShade,title:Object(i.jsx)("h2",{"data-test-subj":"emptyTitle"},e||c.d),body:Object(i.jsx)("p",{"data-test-subj":"emptyBody"},t||c.a),"data-test-subj":"emptyViewerState",actions:[Object(i.jsx)(o.EuiButton,{"data-test-subj":"emptyStateButton",onClick:m,iconType:"plusInCircle",color:"primary",isDisabled:s,fill:!0},n||c.e(r||"rule"))]};case l.a.EMPTY_SEARCH:return{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:Object(i.jsx)(o.EuiImage,{size:"fullWidth",alt:"",src:d.a}),title:Object(i.jsx)("h3",{"data-test-subj":"emptySearchTitle"},e||c.c),body:Object(i.jsx)("p",{"data-test-subj":"emptySearchBody"},t||c.b),"data-test-subj":"emptySearchViewerState"}}}),[u,f.colors.darkestShade,e,t,m,s,n,r]);return Object(i.jsx)(o.EuiSkeletonText,{lines:4,"data-test-subj":"loadingViewerState",isLoading:u===l.a.LOADING||u===l.a.SEARCHING},Object(i.jsx)(o.EuiPanel,{css:p,color:"empty_search"===u?"subdued":"transparent"},Object(i.jsx)(o.EuiEmptyPrompt,g)))},f=r.a.memo(m);f.displayName="EmptyViewerState"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(57);const r=({groups:e},t)=>e[t],i=()=>Object(a.createSelector)(r,(e=>e))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(25),r=n(2),i=n(1897),o=n(1898),s=n(1235),l=n(1431),c=n(2055),u=n(1405),d=n(43);const p=({defaultGroupingOptions:e,groupingId:t,fields:n,onGroupChange:a,maxGroupingLevels:i})=>{const o=Object(r.useCallback)((e=>{a([e])}),[a]);return Object(r.useMemo)((()=>Object(d.jsx)(l.a,{groupingId:t,groupsSelected:["none"],"data-test-subj":"alerts-table-group-selector",onGroupChange:o,fields:n,maxGroupingLevels:i,options:e})),[t,n,i,e,o])},m=({defaultGroupingOptions:e,dispatch:t,fields:n,groupingId:p,groupingState:m,maxGroupingLevels:f=1,onGroupChange:g,onOptionsChange:b,tracker:y,title:h})=>{var v;const{activeGroups:E,options:x}=null!==(v=Object(i.a)({groups:m},p))&&void 0!==v?v:s.c,j=Object(r.useCallback)((e=>{t(o.a.updateActiveGroups({id:p,activeGroups:e}))}),[t,p]),O=Object(r.useCallback)((e=>{t(o.a.updateGroupOptions({id:p,newOptionList:e})),null==b||b(e)}),[t,p,b]),S=Object(r.useCallback)((e=>{let t=[],n=!0;if(1===f)t=[e];else if(E.find((t=>t===e))){n=!1;const a=E.filter((t=>t!==e));t=0===a.length?["none"]:a}else t=Object(c.a)([e])?[e]:[...E.filter((e=>"none"!==e)),e];j(t),n&&(null==y||y(a.METRIC_TYPE.CLICK,u.a.groupChanged({groupingId:p,selected:e}))),null==g||g({tableId:p,groupByField:e,groupByFields:t})}),[p,f,g,E,j,y]);return Object(r.useEffect)((()=>{if(0===x.length&&e.length>0)return O(e.find((e=>E.find((t=>t===e.key))))?e:[...e,...Object(c.a)(E)?[]:E.map((e=>({key:e,label:e})))]);if(Object(c.a)(E))return;const t=x.map((e=>e.key)),n=[...x];E.forEach((e=>{t.includes(e)||n.push({label:e,key:e})})),n.length!==x.length&&O(n)}),[e,x,E,O]),Object(r.useMemo)((()=>Object(d.jsx)(l.a,{groupingId:p,groupsSelected:E,"data-test-subj":"alerts-table-group-selector",onGroupChange:S,fields:n,maxGroupingLevels:f,options:x,title:h})),[p,n,f,S,E,x,h])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(2),r=n.n(a),i=n(45),o=n(1216),s=n(1630),l=n(1799),c=n(210),u=n(246),d=n(118),p=n(129),m=n(5),f=n(145),g=n(504),b=n(149),y=n(122),h=n(256),v=n(170);const E=({columnHeaders:e,controlColumn:t,data:n,disabled:E,index:x,isEventViewer:j,loadingEventIds:O,onRowSelected:S,onRuleChange:w,pageRowIndex:k,rowIndex:I,selectedEventIds:T,showCheckboxes:C,tabType:M,tableId:_,setEventsLoading:D,setEventsDeleted:N,width:A,refetch:F})=>{const{data:P,ecs:R,_id:L,_index:q}=null!=n?n:{},{telemetry:z}=Object(d.j)().services,{openFlyout:B}=Object(o.a)(),$=Object(i.useDispatch)(),[{pageName:V}]=Object(u.a)(),{activeStep:U,isTourShown:G}=Object(h.b)(),H=(U===v.a.expandEvent||U===v.a.reviewAlertDetailsFlyout)&&G(v.b.alertsCases),W=Object(a.useMemo)((()=>P&&e.map((e=>{var t;return null!==(t=Object(g.b)({data:P,fieldName:e.id}))&&void 0!==t?t:[]})).join(" ")),[e,P]),Q=Object(y.a)("expandableFlyoutDisabled"),Y=Object(y.a)("securitySolutionNotesEnabled"),K=V===m.Oc.attackDiscovery||!Q,Z=Object(a.useCallback)((()=>{const e={panelView:"eventDetail",params:{eventId:null!=L?L:"",indexName:null!=q?q:""}};K?(B({right:{id:f.e,path:H?{tab:"overview"}:void 0,params:{id:L,indexName:q,scopeId:_}}}),z.reportDetailsFlyoutOpened({location:_,panel:"right"})):_===s.b.alertsOnCasePage?$(p.a.toggleDetailPanel({...e,id:b.f.casePage})):$(l.a.toggleDetailPanel({...e,tabType:M,id:_}))}),[L,q,K,_,B,H,z,$,M]),X=Object(a.useCallback)((()=>{B({right:{id:f.e,params:{id:L,indexName:q,scopeId:_}},left:{id:f.c,path:{tab:c.d},params:{id:L,indexName:q,scopeId:_}}}),z.reportOpenNoteInExpandableFlyoutClicked({location:_}),z.reportDetailsFlyoutOpened({location:_,panel:"left"})}),[L,q,B,_,z]),J=t.rowCellRender;return P&&R&&L?r.a.createElement(r.a.Fragment,null,J&&r.a.createElement(J,{ariaRowindex:k+1,checked:Object.keys(T).includes(L),columnId:t.id||"",columnValues:W||"",data:P,"data-test-subj":"actions",disabled:E,ecsData:R,eventId:L,index:x,isEventViewer:j,loadingEventIds:O,onEventDetailsPanelOpened:Z,onRowSelected:S,onRuleChange:w,rowIndex:I,showCheckboxes:C,tabType:M,timelineId:_,toggleShowNotes:!Q&&Y?X:void 0,width:A,setEventsLoading:D,setEventsDeleted:N,refetch:F,showNotes:!(Q||!Y)})):r.a.createElement("span",{"data-test-subj":"noData"})},x=r.a.memo(E)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(344),r=n(426),i=(n(455),n(46)),o=n(44);const s=(e,t)=>{if(null===t&&null===e)return[];if(null!=t){if("object"!=typeof e||null==e)return[];{const n=Object.keys(t);return Object.keys(e).flatMap((a=>{const r=n.some((e=>e===a))?[]:[a],i=Object(o.get)(a,e),l=Object(o.get)(a,t);return Object(o.isObject)(i)?[...r,...s(i,l)]:Array.isArray(i)?[...r,...i.flatMap(((e,t)=>s(e,Object(o.get)(t,l))))]:r}))}}try{return[JSON.stringify(e)]}catch(e){return["circular reference"]}},l=e=>{const t=e.map((e=>{if(null!=e.message)return e.message;{const t=e.context.filter((e=>null!=e.key&&!Number.isInteger(+e.key)&&""!==e.key.trim())).map((e=>e.key)).join(","),n=e.context.find((e=>null!=e.type&&null!=e.type.name&&e.type.name.length>0)),a=""!==t?t:null!=n?n.type.name:"";return`Invalid value "${Object(o.isObject)(e.value)?JSON.stringify(e.value):e.value}" supplied to "${a}"`}}));return[...new Set(t)]},c=(e,t)=>{const n=(i=e,o=t.decode(e),Object(r.pipe)(o,Object(a.fold)((e=>Object(a.left)(e)),(e=>{const t=s(i,e);if(0!==t.length){const e=[{value:t,context:[],message:`invalid keys "${t.join(",")}"`}];return Object(a.left)(e)}return Object(a.right)(e)}))));var i,o;return Object(a.isLeft)(n)?[null,l(n.left).join(",")]:[n.right,null]},u=(e,t)=>Object(r.pipe)(t,(t=>e.validate(t,i.getDefaultContext(e.asDecoder()))),Object(a.mapLeft)((e=>new Error(l(e).join(",")))))},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(1630),r=n(2),i=n.n(r),o=n(41),s=n.n(o),l=n(181),c=n(1406),u=n(19),d=n(12),p=n(4),m=n(5);const f=new d.Storage(localStorage),g=s.a.div.withConfig({displayName:"ContainerEuiSelectable",componentId:"sc-134jgj0-0"})(["width:300px;.euiSelectableListItem__text{white-space:pre-wrap !important;line-height:normal;}"]),b=p.i18n.translate("xpack.securitySolution.selector.summaryView.gridView.label",{defaultMessage:"Grid view"}),y=p.i18n.translate("xpack.securitySolution.selector.summaryView.eventRendererView.label",{defaultMessage:"Event rendered view"}),h=({viewSelected:e,onViewChange:t})=>{const[n,a]=Object(r.useState)(!1),o=Object(r.useCallback)((()=>a((e=>!e))),[]),s=Object(r.useCallback)((()=>a(!1)),[]),l=Object(r.useCallback)((e=>{var n,r;const i=e.filter((e=>"on"===e.checked));var o,s;f.set(m.f,null!==(n=null===(r=i[0])||void 0===r?void 0:r.key)&&void 0!==n?n:"gridView"),i.length>0&&t(null!==(o=null===(s=i[0])||void 0===s?void 0:s.key)&&void 0!==o?o:"gridView"),a(!1)}),[t]),c=Object(r.useMemo)((()=>i.a.createElement(u.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",iconSize:"s",onClick:o,size:"xs",flush:"both",style:{fontWeight:"normal"}},"gridView"===e?b:y)),[o,e]),d=Object(r.useMemo)((()=>[{label:b,"data-test-subj":"gridView",key:"gridView",checked:"gridView"===e?"on":void 0,meta:[{text:p.i18n.translate("xpack.securitySolution.selector.summaryView.options.default.description",{defaultMessage:"View as tabular data with the ability to group and sort by specific fields"})}]},{label:y,"data-test-subj":"eventRenderedView",key:"eventRenderedView",checked:"eventRenderedView"===e?"on":void 0,meta:[{text:p.i18n.translate("xpack.securitySolution.selector.summaryView.options.summaryView.description",{defaultMessage:"View a rendering of the event flow for each alert"})}]}]),[e]),h=Object(r.useCallback)((e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(u.EuiTitle,{size:"xxs"},i.a.createElement("h6",null,e.label)),i.a.createElement(u.EuiTextColor,{color:"subdued"},i.a.createElement("small",null,e.meta[0].text)))),[]),v=Object(r.useMemo)((()=>({rowHeight:80,showIcons:!0})),[]);return i.a.createElement(u.EuiPopover,{panelPaddingSize:"none",button:c,isOpen:n,closePopover:s},i.a.createElement(g,null,i.a.createElement(u.EuiSelectable,{options:d,onChange:l,renderOption:h,searchable:!1,height:160,listProps:v,singleSelection:!0},(e=>e))))},v=i.a.memo(h),E=s.a.span.withConfig({displayName:"TitleText",componentId:"sc-fudkl1-0"})(["margin-right:12px;"]),x=({tableView:e,loading:t,tableId:n,title:o,onViewChange:s,additionalFilters:u,hasRightOffset:d,showInspect:p=!0,position:m="absolute",additionalMenuOptions:f=[]})=>{const g="gridView"===e?"baseline":"center",b=Object(r.useMemo)((()=>i.a.createElement(E,{"data-test-subj":"title"},o)),[o]),y=Object(r.useMemo)((()=>f.length?f.map(((e,n)=>i.a.createElement(c.h,{grow:!1,$show:!t,key:n},e))):null),[f,t]);return i.a.createElement(c.g,{alignItems:g,"data-test-subj":"events-viewer-updated",gutterSize:"m",component:"span",justifyContent:"flexEnd",direction:"row",$hasRightOffset:d,position:m},p?i.a.createElement(c.h,{grow:!1,$show:!t},i.a.createElement(l.b,{title:b,queryId:n})):null,i.a.createElement(c.h,{grow:!1,$show:!t},u),[a.b.alertsOnRuleDetailsPage,a.b.alertsOnAlertsPage].includes(n)&&i.a.createElement(c.h,{grow:!1,$show:!t,"data-test-subj":"summary-view-selector"},i.a.createElement(v,{viewSelected:e,onViewChange:s})),y)}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(7),r=n(44),i=n(1325);const o=({filters:e,namespaceTypes:t,hideLists:n})=>{const o=Object(i.a)({namespaceType:t}),s=((e,t)=>Object.keys(e).map((n=>{const i=Object(r.get)(n,e);return Object(a.isArray)(i)||null!=i&&""!==i.trim()?`(${t.map((e=>{const t="name"===n?"name.text":"types"===n?"type":n;return Object(a.isArray)(i)?i.map((n=>`${e}.attributes.${t}:${n}`)).join(" OR "):`${e}.attributes.${t}:${i}`})).join(" OR ")})`:null})).filter((e=>null!=e)).join(" AND "))(e,o);return[s,...n.map((e=>`(${o.map((t=>`not ${t}.attributes.list_id: ${e}*`)).join(" AND ")})`))].filter((e=>""!==e.trim())).join(" AND ")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>(e=>e.groups.groupById)(e)[t]},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1235);const r={updateActiveGroups:({activeGroups:e,id:t})=>({payload:{activeGroups:e,id:t},type:a.a.updateActiveGroups}),updateGroupOptions:({newOptionList:e,id:t})=>({payload:{newOptionList:e,id:t},type:a.a.updateGroupOptions})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>!!e.find((e=>"none"===e))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"registerAlertsTableConfiguration",(function(){return Oe}));var a=n(1630),r=n(2),i=n.n(r),o=n(1201);const s=e=>({onToggleColumn:t})=>{const n=Object(r.useCallback)((e=>{t(e.id)}),[t]),a=Object(r.useMemo)((()=>({sourcererScope:e,removeColumn:t,upsertColumn:n})),[n,t]),i=Object(o.a)(a);return Object(r.useMemo)((()=>({createFieldButton:i.createFieldButton})),[i.createFieldButton])};var l=n(1799),c=n(1490),u=n(173),d=n(236),p=n(5),m=n(127),f=n(124),g=n(814),b=n(904);const y=e=>({columns:t,data:n,dataGridRef:i,pageSize:o,pageIndex:s})=>{var y;const h=Object(g.a)(m.SourcererScopeName.detections),v=Object(b.a)(m.SourcererScopeName.detections),E=Object(r.useMemo)((()=>n.map((e=>e.map((e=>{let t=e;if(["_id","_index"].includes(e.field)){var n;const a=null!==(n=e.value)&&void 0!==n?n:"";t={field:e.field,value:Array.isArray(a)?a:[a]}}return t}))))),[n]),x=Object(r.useMemo)((()=>l.b.getTableByIdSelector()),[]),j=null!==(y=Object(f.b)((t=>{var n;return(null!==(n=x(t,e))&&void 0!==n?n:c.d).viewMode})))&&void 0!==y?y:c.d.viewMode,O=Object(r.useMemo)((()=>({scopeId:e,dataViewId:v})),[v]),S=Object(r.useMemo)((()=>{if(j!==p.cd.eventRenderedView)return t.map((e=>{var t;return null!==(t=h(e.id))&&void 0!==t?t:{name:"",type:"",aggregatable:!1,searchable:!1}}))}),[h,t,j]),w=Object(r.useCallback)(((e,t)=>{var n,a,r;return null!==(n=null===(a=E[t-o*s])||void 0===a||null===(r=a.find((t=>t.field===e)))||void 0===r?void 0:r.value)&&void 0!==n?n:[]}),[E,s,o]),k=e===a.b.alertsOnCasePage?[d.d.FILTER]:void 0,I=Object(u.e)({triggerId:d.e.DEFAULT,fields:S,getCellValue:w,metadata:O,dataGridRef:i,disabledActionTypes:k}),T=Object(r.useCallback)(((e,t)=>0===I.length?[]:I[t]),[I]);return Object(r.useMemo)((()=>({getCellActions:T,visibleCellActions:3})),[T])};var h=n(7),v=n(1252),E=n(1245),x=n(161),j=n(1464),O=n(53),S=n(1105),w=n(479),k=n(123),I=n(187),T=n(149),C=n(4);C.i18n.translate("xpack.securitySolution.toolbar.bulkActions.clearSelectionTitle",{defaultMessage:"Clear selection"});const M=e=>C.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailed",{values:{conflicts:e},defaultMessage:"Failed to update { conflicts } {conflicts, plural, =1 {alert} other {alerts}}."}),_=(e,t)=>C.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedDetailed",{values:{updated:e,conflicts:t},defaultMessage:"{ updated } {updated, plural, =1 {alert was} other {alerts were}} updated successfully, but { conflicts } failed to update\n         because { conflicts, plural, =1 {it was} other {they were}} already being modified."}),D=C.i18n.translate("xpack.securitySolution.bulkActions.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),N=C.i18n.translate("xpack.securitySolution.bulkActions.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),A=C.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),F=C.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedSingleAlert",{defaultMessage:"Failed to update alert because it was already being modified."}),P=C.i18n.translate("xpack.securitySolution.bulkActions.openSelectedTitle",{defaultMessage:"Mark as open"}),R=C.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedSelectedTitle",{defaultMessage:"Mark as acknowledged"}),L=C.i18n.translate("xpack.securitySolution.bulkActions.closeSelectedTitle",{defaultMessage:"Mark as closed"});var q=n(718),z=n(293);var B=n(148);const $=e=>(t,n)=>{const{from:a,to:i}=Object(x.a)(),o=Object(r.useMemo)((()=>function(e){return t=e,[{bool:{must:[{match_all:{}}]}},{bool:{filter:[],must:[{match_all:{}}],must_not:[]}},{bool:{filter:[],must:[{match_all:{}}]}},{bool:{must:[{match_all:{}}],must_not:[]}},{match_all:{}}].some((e=>Object(h.isEqual)(e,t)))?[]:[{meta:{negate:!1,disabled:!1,type:"custom",value:JSON.stringify(e)},query:e}];var t}(t)),[t]),s=Object(r.useMemo)((()=>({onAssigneesUpdate:n})),[n]),{alertAssigneesItems:l,alertAssigneesPanels:c}=Object(v.a)(s),u=Object(r.useMemo)((()=>({localFilters:o,from:a,to:i,scopeId:m.SourcererScopeName.detections,tableId:e})),[o,a,i]),d=Object(r.useMemo)((()=>B.d.globalQuery()),[]),p=Object(f.a)(d),g=Object(r.useCallback)((()=>{n(),p.forEach((e=>e.refetch&&e.refetch()))}),[p,n]),b=Object(r.useMemo)((()=>({scopeId:m.SourcererScopeName.detections,filters:o,from:a,to:i,tableId:e,refetch:g})),[a,i,o,g]),y=Object(r.useMemo)((()=>({refetch:n})),[n]),$=Object(j.a)(u),V=(({scopeId:e,filters:t,from:n,to:a,refetch:i})=>{const{hasIndexWrite:o}=Object(z.a)(),{startTransaction:s}=Object(I.b)(),{addSuccess:l,addError:c,addWarning:u}=Object(k.a)(),d=Object(r.useCallback)(((e,t,n)=>{if(t>0)u({title:M(t),text:_(e,t)});else{let t;switch(n){case"closed":a=e,t=C.i18n.translate("xpack.securitySolution.bulkActions.closedAlertSuccessToastMessage",{values:{totalAlerts:a},defaultMessage:"Successfully closed {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."});break;case"open":t=(e=>C.i18n.translate("xpack.securitySolution.bulkActions.openedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully opened {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}))(e);break;case"acknowledged":t=(e=>C.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully marked {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}} as acknowledged."}))(e)}l({title:t})}var a}),[l,u]),p=Object(r.useCallback)(((e,t)=>{let n;switch(e){case"closed":n=D;break;case"open":n=N;break;case"acknowledged":n=A}c(t.message,{title:n})}),[c]),m=Object(r.useCallback)((e=>async(r,o,l,c,u)=>{try{var m,f;let p,g=r.map((e=>e._id));if(o){const e=Object(q.a)(n,a);p=Object(O.buildEsQuery)(void 0,[],[...e,...t],void 0),g=void 0,s({name:S.a.BULK_QUERY_STATUS_UPDATE})}else r.length>1?s({name:S.a.BULK_STATUS_UPDATE}):s({name:S.a.STATUS_UPDATE});l(!0);const b=await Object(w.a)({status:e,query:p,signalIds:g});if(l(!1),i&&i(),u(),c(),b.version_conflicts&&1===r.length)throw new Error(F);d(null!==(m=b.updated)&&void 0!==m?m:0,null!==(f=b.version_conflicts)&&void 0!==f?f:0,e)}catch(t){p(e,t)}}),[p,d,s,t,n,a,i]),f=Object(r.useCallback)((e=>({label:e===T.d?P:e===T.c?L:R,key:`${e}-alert-status`,"data-test-subj":`${e}-alert-status`,disableOnQuery:!1,onClick:m(e)})),[m]);return Object(r.useMemo)((()=>o?[T.d,T.c,T.b].map((e=>f(e))):[]),[f,o])})(b),{alertTagsItems:U,alertTagsPanels:G}=Object(E.a)(y),H=Object(r.useMemo)((()=>[...V,$,...U,...l]),[V,U,$,l]);return Object(r.useMemo)((()=>[{id:0,items:H},...G,...c]),[G,H,c])};var V=n(45),U=n(122),G=n(774),H=n(1465),W=n(938),Q=n(16),Y=n(585),K=n(1567);const Z=e=>()=>{const t=Object(Q.b)(),n=t.isEnterprise();let o=e===a.b.alertsOnCasePage?4:n?6:5;const s=Object(U.a)("expandableFlyoutDisabled"),l=Object(U.a)("securitySolutionNotesEnabled");!s&&l||o--;const c=Object(r.useContext)(G.a),u=Object(r.useMemo)((()=>Object(W.a)(o)[0]),[o]),{dataTable:{columns:d,showCheckboxes:p,selectedEventIds:m,loadingEventIds:f}=Object(Y.g)(t)}=Object(V.useSelector)((t=>Object(H.a)(t,e)));return{renderCustomActionsRow:Object(r.useCallback)((({rowIndex:t,cveProps:n,setIsActionLoading:a,refresh:r,clearSelection:o,ecsAlert:s,nonEcsData:l})=>{const g={_id:s._id,_index:s._index,ecs:s,data:l};return i.a.createElement(K.a,{columnId:`actions-${t}`,columnHeaders:d,controlColumn:u,data:g,disabled:!1,index:t,isDetails:n.isDetails,isExpanded:n.isExpanded,isEventViewer:!1,isExpandable:n.isExpandable,loadingEventIds:f,onRowSelected:()=>{},rowIndex:n.rowIndex,colIndex:n.colIndex,pageRowIndex:t,selectedEventIds:m,setCellProps:n.setCellProps,showCheckboxes:p,onRuleChange:null==c?void 0:c.onRuleChange,tabType:"query",tableId:e,width:0,setEventsLoading:({isLoading:e})=>{e?a&&a(e):o()},setEventsDeleted:()=>{},refetch:r})}),[d,f,p,u,m,c]),width:u.width}};var X=n(1566),J=n(1405),ee=n(1564),te=n(132),ne=n(1505),ae=n(118),re=n(17),ie=n(1474),oe=n(1620),se=n(19),le=n(41),ce=n.n(le),ue=n(362),de=n(1305);const pe=ce()(se.EuiFlexGroup).withConfig({displayName:"UtilityBarFlexGroup",componentId:"sc-180vpo0-0"})(["min-width:175px;"]),me=ce()(se.EuiFlexItem).withConfig({displayName:"AdditionalFiltersItem",componentId:"sc-180vpo0-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),fe=ce()(me).withConfig({displayName:"BuildingBlockContainer",componentId:"sc-180vpo0-2"})(["background:",";"],(({theme:e})=>e.eui.euiColorHighlight)),ge=ce.a.span.withConfig({displayName:"CenterText",componentId:"sc-180vpo0-3"})(["text-align:center;"]),be=({areEventsLoading:e,onShowBuildingBlockAlertsChanged:t,showBuildingBlockAlerts:n,onShowOnlyThreatIndicatorAlertsChanged:a,showOnlyThreatIndicatorAlerts:o})=>{const s=Object(r.useCallback)((e=>i.a.createElement(pe,{direction:"column",gutterSize:"none"},i.a.createElement(fe,null,i.a.createElement(se.EuiCheckbox,{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:n=>{e(),t(n.target.checked)},checked:n,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:de.b})),i.a.createElement(me,null,i.a.createElement(se.EuiCheckbox,{id:"showOnlyThreatIndicatorAlertsCheckbox","aria-label":"showOnlyThreatIndicatorAlerts",onChange:t=>{e(),a(t.target.checked)},checked:o,color:"text","data-test-subj":"showOnlyThreatIndicatorAlertsCheckbox",label:de.c})))),[t,a,n,o]),l=(n?1:0)+(o?1:0);return i.a.createElement(ue.b,{dataTestSubj:"additionalFilters",disabled:e,iconType:"arrowDown",iconSide:"right",ownFocus:!0,popoverContent:s},i.a.createElement(ge,null,de.a,l>0&&i.a.createElement(i.a.Fragment,null," ",i.a.createElement(se.EuiNotificationBadge,{"data-test-subj":"additionalFiltersCountBadge",color:"subdued"},`${l}`))))},{changeViewMode:ye}=l.a,he=e=>()=>{var t;const n=Object(V.useDispatch)(),{services:{telemetry:a}}=Object(ae.j)(),{indexPattern:o}=Object(te.a)(m.SourcererScopeName.detections),s=Object(r.useMemo)((()=>Object(ee.a)()),[]),{options:u}=null!==(t=Object(f.a)((t=>s(t,e))))&&void 0!==t?t:{options:[]},d=Object(r.useCallback)((t=>{null===re.h||void 0===re.h||Object(re.h)(re.a.CLICK,J.a.groupChanged({groupingId:e,selected:t})),a.reportAlertsGroupingChanged({groupByField:t,tableId:e})}),[a]),p=Object(r.useCallback)((t=>{t.forEach((e=>d(e))),n(Object(ne.a)({activeGroups:t,tableId:e}))}),[n,d]),g=Object(X.b)({groupingId:e,onGroupChange:p,fields:o.fields,defaultGroupingOptions:u,maxGroupingLevels:3}),b=Object(r.useMemo)((()=>l.b.getTableByIdSelector()),[]),y=Object(f.b)((t=>{var n,a;return null!==(n=(null!==(a=b(t,e))&&void 0!==a?a:c.d).viewMode)&&void 0!==n?n:c.d.viewMode})),h=Object(r.useCallback)((t=>{n(ye({id:e,viewMode:t}))}),[n]),{showBuildingBlockAlerts:v,setShowBuildingBlockAlerts:E,showOnlyThreatIndicatorAlerts:x,setShowOnlyThreatIndicatorAlerts:j}=Object(ie.a)(e),O=Object(r.useMemo)((()=>i.a.createElement(be,{areEventsLoading:!1,onShowBuildingBlockAlertsChanged:E,showBuildingBlockAlerts:v,onShowOnlyThreatIndicatorAlertsChanged:j,showOnlyThreatIndicatorAlerts:x})),[v,E,x,j]),S=Object(r.useMemo)((()=>i.a.createElement(oe.a,{position:"relative",tableView:y,loading:!1,tableId:e,title:"Some Title",onViewChange:h,hasRightOffset:!1,additionalFilters:O,showInspect:!1,additionalMenuOptions:null!=g?[g]:[]})),[y,h,O,g]);return Object(r.useMemo)((()=>({right:S})),[S])};var ve=n(1366),Ee=n(1476),xe=n(1354),je=n(1226);const Oe=(e,t)=>{var n,r;const i=Object(ve.c)(t,[a.b.alertsOnAlertsPage]),o=null!==(n=null==i||null===(r=i[a.b.alertsOnAlertsPage])||void 0===r?void 0:r.columns)&&void 0!==n?n:[],l=o.length?o:Object(Ee.b)(),c=Object(xe.b)({scopeId:m.SourcererScopeName.detections,tableId:a.b.alertsOnAlertsPage}),u=Object(xe.b)({scopeId:m.SourcererScopeName.detections,tableId:a.b.alertsOnCasePage}),d=[{"@timestamp":{order:"desc"}}];Se(e,{id:p.e.ALERTS_PAGE,cases:{featureId:p.w,owner:[p.j],syncAlerts:!0},columns:l,getRenderCellValue:c,useActionsColumn:Z(a.b.alertsOnAlertsPage),useBulkActions:$(a.b.alertsOnAlertsPage),useCellActions:y(a.b.alertsOnAlertsPage),usePersistentControls:he(a.b.alertsOnAlertsPage),sort:d,useFieldBrowserOptions:s(m.SourcererScopeName.detections),showInspectButton:!0,useFetchPageContext:je.b}),Se(e,{id:p.e.RULE_DETAILS,cases:{featureId:p.w,owner:[p.j],syncAlerts:!0},columns:l,getRenderCellValue:c,useActionsColumn:Z(a.b.alertsOnRuleDetailsPage),useBulkActions:$(a.b.alertsOnRuleDetailsPage),useCellActions:y(a.b.alertsOnRuleDetailsPage),usePersistentControls:he(a.b.alertsOnRuleDetailsPage),sort:d,useFieldBrowserOptions:s(m.SourcererScopeName.detections),showInspectButton:!0,useFetchPageContext:je.b}),Se(e,{id:p.e.CASE,cases:{featureId:p.w,owner:[p.j],syncAlerts:!0},columns:l,getRenderCellValue:u,useActionsColumn:Z(a.b.alertsOnCasePage),useBulkActions:$(a.b.alertsOnCasePage),useCellActions:y(a.b.alertsOnCasePage),sort:d,showInspectButton:!0,useFetchPageContext:je.b}),Se(e,{id:p.e.RISK_INPUTS,cases:{featureId:p.w,owner:[p.j],syncAlerts:!0},columns:l,getRenderCellValue:c,useActionsColumn:Z(a.b.alertsRiskInputs),useBulkActions:$(a.b.alertsRiskInputs),useCellActions:y(a.b.alertsRiskInputs),usePersistentControls:he(a.b.alertsRiskInputs),sort:d,showInspectButton:!0,useFetchPageContext:je.b})},Se=(e,t)=>{e.has(t.id)||e.register(t)}}])]);