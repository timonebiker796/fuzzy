/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[38],{1099:function(e,t,a){"use strict";var n=a(342);a.d(t,"a",(function(){return n.b})),a.d(t,"b",(function(){return n.g})),a.d(t,"c",(function(){return n.h})),a(502),a(536),a(554)},1108:function(e,t,a){const n=a(283);e.exports=(e,t)=>{const a=n(e.trim().replace(/^[=v]+/,""),t);return a?a.version:null}},1109:function(e,t,a){const n=a(164);e.exports=(e,t,a,r,i)=>{"string"==typeof a&&(i=r,r=a,a=void 0);try{return new n(e instanceof n?e.version:e,a).inc(t,r,i).version}catch(e){return null}}},1110:function(e,t,a){const n=a(283);e.exports=(e,t)=>{const a=n(e,null,!0),r=n(t,null,!0),i=a.compare(r);if(0===i)return null;const o=i>0,s=o?a:r,l=o?r:a,c=!!s.prerelease.length;if(l.prerelease.length&&!c)return l.patch||l.minor?s.patch?"patch":s.minor?"minor":"major":"major";const u=c?"pre":"";return a.major!==r.major?u+"major":a.minor!==r.minor?u+"minor":a.patch!==r.patch?u+"patch":"prerelease"}},1111:function(e,t,a){const n=a(164);e.exports=(e,t)=>new n(e,t).major},1112:function(e,t,a){const n=a(164);e.exports=(e,t)=>new n(e,t).minor},1113:function(e,t,a){const n=a(164);e.exports=(e,t)=>new n(e,t).patch},1114:function(e,t,a){const n=a(283);e.exports=(e,t)=>{const a=n(e,t);return a&&a.prerelease.length?a.prerelease:null}},1115:function(e,t,a){const n=a(190);e.exports=(e,t,a)=>n(t,e,a)},1116:function(e,t,a){const n=a(190);e.exports=(e,t)=>n(e,t,!0)},1117:function(e,t,a){const n=a(490);e.exports=(e,t)=>e.sort(((e,a)=>n(e,a,t)))},1118:function(e,t,a){const n=a(490);e.exports=(e,t)=>e.sort(((e,a)=>n(a,e,t)))},1119:function(e,t){e.exports=class LRUCache{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},1120:function(e,t,a){const n=a(193);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},1121:function(e,t,a){const n=a(164),r=a(193);e.exports=(e,t,a)=>{let i=null,o=null,s=null;try{s=new r(t,a)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(i&&-1!==o.compare(e)||(i=e,o=new n(i,a)))})),i}},1122:function(e,t,a){const n=a(164),r=a(193);e.exports=(e,t,a)=>{let i=null,o=null,s=null;try{s=new r(t,a)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(i&&1!==o.compare(e)||(i=e,o=new n(i,a)))})),i}},1123:function(e,t,a){const n=a(164),r=a(193),i=a(385);e.exports=(e,t)=>{e=new r(e,t);let a=new n("0.0.0");if(e.test(a))return a;if(a=new n("0.0.0-0"),e.test(a))return a;a=null;for(let t=0;t<e.set.length;++t){const r=e.set[t];let o=null;r.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!i(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!o||a&&!i(a,o)||(a=o)}return a&&e.test(a)?a:null}},1124:function(e,t,a){const n=a(193);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},1125:function(e,t,a){const n=a(493);e.exports=(e,t,a)=>n(e,t,">",a)},1126:function(e,t,a){const n=a(493);e.exports=(e,t,a)=>n(e,t,"<",a)},1127:function(e,t,a){const n=a(193);e.exports=(e,t,a)=>(e=new n(e,a),t=new n(t,a),e.intersects(t,a))},1128:function(e,t,a){const n=a(387),r=a(190);e.exports=(e,t,a)=>{const i=[];let o=null,s=null;const l=e.sort(((e,t)=>r(e,t,a)));for(const e of l)n(e,t,a)?(s=e,o||(o=e)):(s&&i.push([o,s]),s=null,o=null);o&&i.push([o,null]);const c=[];for(const[e,t]of i)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},1129:function(e,t,a){const n=a(193),r=a(386),{ANY:i}=r,o=a(387),s=a(190),l=[new r(">=0.0.0-0")],c=[new r(">=0.0.0")],u=(e,t,a)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=a.includePrerelease?l:c}if(1===t.length&&t[0].semver===i){if(a.includePrerelease)return!0;t=c}const n=new Set;let r,u,m,b,g,f,h;for(const t of e)">"===t.operator||">="===t.operator?r=d(r,t,a):"<"===t.operator||"<="===t.operator?u=p(u,t,a):n.add(t.semver);if(n.size>1)return null;if(r&&u){if(m=s(r.semver,u.semver,a),m>0)return null;if(0===m&&(">="!==r.operator||"<="!==u.operator))return null}for(const e of n){if(r&&!o(e,String(r),a))return null;if(u&&!o(e,String(u),a))return null;for(const n of t)if(!o(e,String(n),a))return!1;return!0}let v=!(!u||a.includePrerelease||!u.semver.prerelease.length)&&u.semver,y=!(!r||a.includePrerelease||!r.semver.prerelease.length)&&r.semver;v&&1===v.prerelease.length&&"<"===u.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(h=h||">"===e.operator||">="===e.operator,f=f||"<"===e.operator||"<="===e.operator,r)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(b=d(r,e,a),b===e&&b!==r)return!1}else if(">="===r.operator&&!o(r.semver,String(e),a))return!1;if(u)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(g=p(u,e,a),g===e&&g!==u)return!1}else if("<="===u.operator&&!o(u.semver,String(e),a))return!1;if(!e.operator&&(u||r)&&0!==m)return!1}return!(r&&f&&!u&&0!==m||u&&h&&!r&&0!==m||y||v)},d=(e,t,a)=>{if(!e)return t;const n=s(e.semver,t.semver,a);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,a)=>{if(!e)return t;const n=s(e.semver,t.semver,a);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,a={})=>{if(e===t)return!0;e=new n(e,a),t=new n(t,a);let r=!1;e:for(const n of e.set){for(const e of t.set){const t=u(n,e,a);if(r=r||null!==t,t)continue e}if(r)return!1}return!0}},1130:function(e,t,a){e.exports=a(35)(3843)},1131:function(e,t,a){"use strict";e.exports=function(e){var t=this;this.Parser=function(a){return n(a,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}};var n=a(1132)},1132:function(e,t,a){"use strict";e.exports=a(1133)},1133:function(e,t,a){"use strict";e.exports=function(e,t,a){return"string"!=typeof t&&(a=t,t=void 0),function(e){var t=e||{},a=function(e,t){for(var a=-1;++a<t.length;)m(e,t[a]);return e}({canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:f(M),autolinkProtocol:j,autolinkEmail:j,atxHeading:f(I),blockQuote:f((function(){return{type:"blockquote",children:[]}})),characterEscape:j,characterReference:j,codeFenced:f(k),codeFencedFenceInfo:h,codeFencedFenceMeta:h,codeIndented:f(k,h),codeText:f((function(){return{type:"inlineCode",value:""}}),h),codeTextData:j,data:j,codeFlowValue:j,definition:f((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:h,definitionLabelString:h,definitionTitleString:h,emphasis:f((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:f(T),hardBreakTrailing:f(T),htmlFlow:f(C,h),htmlFlowData:j,htmlText:f(C,h),htmlTextData:j,image:f((function(){return{type:"image",title:null,url:"",alt:null}})),label:h,link:f(M),listItem:f((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){b("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),u("expectingFirstListItemValue"))},listOrdered:f(F,(function(){u("expectingFirstListItemValue",!0)})),listUnordered:f(F),paragraph:f((function(){return{type:"paragraph",children:[]}})),reference:function(){u("referenceType","collapsed")},referenceString:h,resourceDestinationString:h,resourceTitleString:h,setextHeading:f(I),strong:f((function(){return{type:"strong",children:[]}})),thematicBreak:f((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:y(),atxHeadingSequence:function(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)},autolink:y(),autolinkEmail:function(e){w.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){w.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:y(),characterEscapeValue:w,characterReferenceMarkerHexadecimal:O,characterReferenceMarkerNumeric:O,characterReferenceValue:function(e){var t,a,n=this.sliceSerialize(e),r=b("characterReferenceType");r?(t=s(n,"characterReferenceMarkerNumeric"===r?10:16),u("characterReferenceType")):t=d(n),(a=this.stack.pop()).value+=t,a.position.end=g(e.end)},codeFenced:y((function(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),u("flowCodeInside")})),codeFencedFence:function(){b("flowCodeInside")||(this.buffer(),u("flowCodeInside",!0))},codeFencedFenceInfo:function(){var e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){var e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:w,codeIndented:y((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeText:y((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:w,data:w,definition:y(),definitionDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=o(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:y(),hardBreakEscape:y(S),hardBreakTrailing:y(S),htmlFlow:y((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:w,htmlText:y((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:w,image:y((function(){var e=this.stack[this.stack.length-1];b("inReference")?(e.type+="Reference",e.referenceType=b("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),label:function(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,u("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t},labelText:function(e){this.stack[this.stack.length-2].identifier=o(this.sliceSerialize(e)).toLowerCase()},lineEnding:function(e){var t=this.stack[this.stack.length-1];if(b("atHardBreak"))return t.children[t.children.length-1].position.end=g(e.end),void u("atHardBreak");!b("setextHeadingSlurpLineEnding")&&a.canContainEols.indexOf(t.type)>-1&&(j.call(this,e),w.call(this,e))},link:y((function(){var e=this.stack[this.stack.length-1];b("inReference")?(e.type+="Reference",e.referenceType=b("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),listItem:y(),listOrdered:y(),listUnordered:y(),paragraph:y(),referenceString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=o(this.sliceSerialize(e)).toLowerCase(),u("referenceType","full")},resourceDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){u("inReference")},setextHeading:y((function(){u("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2},setextHeadingText:function(){u("setextHeadingSlurpLineEnding",!0)},strong:y(),thematicBreak:y()}},t.mdastExtensions||[]),l={};return function(e){for(var t,n=[{type:"root",children:[]}],o=[],s=[],l=-1,d={stack:n,tokenStack:o,config:a,enter:v,exit:E,buffer:h,resume:x,setData:u,getData:b};++l<e.length;)"listOrdered"!==e[l][1].type&&"listUnordered"!==e[l][1].type||("enter"===e[l][0]?s.push(l):l=c(e,s.pop(l),l));for(l=-1;++l<e.length;)t=a[e[l][0]],i.call(t,e[l][1].type)&&t[e[l][1].type].call(r({sliceSerialize:e[l][2].sliceSerialize},d),e[l][1]);if(o.length)throw new Error("Cannot close document, a token (`"+o[o.length-1].type+"`, "+p({start:o[o.length-1].start,end:o[o.length-1].end})+") is still open");return n[0].position={start:g(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:g(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},n[0]};function c(e,t,a){for(var n,r,i,o,s,l,c,u=t-1,d=-1,p=!1;++u<=a;)if("listUnordered"===(s=e[u])[1].type||"listOrdered"===s[1].type||"blockQuote"===s[1].type?("enter"===s[0]?d++:d--,c=void 0):"lineEndingBlank"===s[1].type?"enter"===s[0]&&(!n||c||d||l||(l=u),c=void 0):"linePrefix"===s[1].type||"listItemValue"===s[1].type||"listItemMarker"===s[1].type||"listItemPrefix"===s[1].type||"listItemPrefixWhitespace"===s[1].type||(c=void 0),!d&&"enter"===s[0]&&"listItemPrefix"===s[1].type||-1===d&&"exit"===s[0]&&("listUnordered"===s[1].type||"listOrdered"===s[1].type)){if(n){for(r=u,i=void 0;r--;)if("lineEnding"===(o=e[r])[1].type||"lineEndingBlank"===o[1].type){if("exit"===o[0])continue;i&&(e[i][1].type="lineEndingBlank",p=!0),o[1].type="lineEnding",i=r}else if("linePrefix"!==o[1].type&&"blockQuotePrefix"!==o[1].type&&"blockQuotePrefixWhitespace"!==o[1].type&&"blockQuoteMarker"!==o[1].type&&"listItemIndent"!==o[1].type)break;l&&(!i||l<i)&&(n._spread=!0),n.end=g(i?e[i][1].start:s[1].end),e.splice(i||u,0,["exit",n,s[2]]),u++,a++}"listItemPrefix"===s[1].type&&(n={type:"listItem",_spread:!1,start:g(s[1].start)},e.splice(u,0,["enter",n,s[2]]),u++,a++,l=void 0,c=!0)}return e[t][1]._spread=p,a}function u(e,t){l[e]=t}function b(e){return l[e]}function g(e){return{line:e.line,column:e.column,offset:e.offset}}function f(e,t){return function(a){v.call(this,e(a),a),t&&t.call(this,a)}}function h(){this.stack.push({type:"fragment",children:[]})}function v(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:g(t.start)},e}function y(e){return function(t){e&&e.call(this,t),E.call(this,t)}}function E(e){var t=this.stack.pop(),a=this.tokenStack.pop();if(!a)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): it’s not open");if(a.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): a different token (`"+a.type+"`, "+p({start:a.start,end:a.end})+") is open");return t.position.end=g(e.end),t}function x(){return n(this.stack.pop())}function j(e){var t=this.stack[this.stack.length-1].children,a=t[t.length-1];a&&"text"===a.type||((a={type:"text",value:""}).position={start:g(e.start)},this.stack[this.stack.length-1].children.push(a)),this.stack.push(a)}function w(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=g(e.end)}function S(){u("atHardBreak",!0)}function O(e){u("characterReferenceType",e.type)}function k(){return{type:"code",lang:null,meta:null,value:""}}function I(){return{type:"heading",depth:void 0,children:[]}}function T(){return{type:"break"}}function C(){return{type:"html",value:""}}function M(){return{type:"link",title:null,url:"",children:[]}}function F(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(a)(u(l(a).document().write(c()(e,t,!0))))};var n=a(1134),r=a(335),i=a(676),o=a(494),s=a(1135),l=a(1136),c=a(1175),u=a(1176),d=a(681),p=a(1177);function m(e,t){var a,n;for(a in t)n=i.call(e,a)?e[a]:e[a]={},"canContainEols"===a?e[a]=[].concat(n,t[a]):Object.assign(n,t[a])}},1134:function(e,t,a){"use strict";function n(e){return e&&(e.value||e.alt||e.title||"children"in e&&r(e.children)||"length"in e&&r(e))||""}function r(e){for(var t=[],a=-1;++a<e.length;)t[a]=n(e[a]);return t.join("")}e.exports=n},1135:function(e,t,a){"use strict";var n=a(388);e.exports=function(e,t){var a=parseInt(e,t);return a<9||11===a||a>13&&a<32||a>126&&a<160||a>55295&&a<57344||a>64975&&a<65008||!(65535&~a)||65534==(65535&a)||a>1114111?"�":n(a)}},1136:function(e,t,a){"use strict";var n=a(1137),r=a(1138),i=a(1139),o=a(679),s=a(1142),l=a(1143),c=a(495),u=a(1146);e.exports=function(e){var t={defined:[],constructs:s([u].concat(c((e||{}).extensions))),content:a(n),document:a(r),flow:a(i),string:a(o.string),text:a(o.text)};return t;function a(e){return function(a){return l(t,e,a)}}}},1137:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(155),r=a(160);t.tokenize=function(e){var t,a=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null!==t)return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r(e,a,"linePrefix");e.consume(t)}),(function(t){return e.enter("paragraph"),i(t)}));return a;function i(a){var n=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=n),t=n,o(a)}function o(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):n(t)?(e.consume(t),e.exit("chunkText"),i):(e.consume(t),o)}}},1138:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(155),r=a(160),i=a(389),o={tokenize:function(e,t,a){return r(e,e.attempt(this.parser.constructs.document,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},s={tokenize:function(e,t,a){return r(e,e.lazy(this.parser.constructs.flow,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};t.tokenize=function(e){var t,a,r,l=this,c=[],u=0,d={tokenize:function(e,n){var r=0;return t={},u;function u(n){return r<c.length?(l.containerState=c[r][1],e.attempt(c[r][0].continuation,d,p)(n)):a.currentConstruct&&a.currentConstruct.concrete?(t.flowContinue=!0,g(n)):(l.interrupt=a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(o,b,g)(n))}function d(e){return r++,l.containerState._closeFlow?b(e):u(e)}function p(t){return a.currentConstruct&&a.currentConstruct.lazy?(l.containerState={},e.attempt(o,b,e.attempt(s,b,e.check(i,b,m)))(t)):b(t)}function m(e){return r=c.length,t.lazy=!0,t.flowContinue=!0,g(e)}function b(e){return t.flowEnd=!0,g(e)}function g(e){return t.continued=r,l.interrupt=l.containerState=void 0,n(e)}},partial:!0};return p;function p(t){return u<c.length?(l.containerState=c[u][1],e.attempt(c[u][0].continuation,m,b)(t)):b(t)}function m(e){return u++,p(e)}function b(n){return t&&t.flowContinue?f(n):(l.interrupt=a&&a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(o,g,f)(n))}function g(e){return c.push([l.currentConstruct,l.containerState]),l.containerState=void 0,b(e)}function f(t){return null===t?(E(0,!0),void e.consume(t)):(a=a||l.parser.flow(l.now()),e.enter("chunkFlow",{contentType:"flow",previous:r,_tokenizer:a}),h(t))}function h(t){return null===t?(y(e.exit("chunkFlow")),f(t)):n(t)?(e.consume(t),y(e.exit("chunkFlow")),e.check(d,v)):(e.consume(t),h)}function v(e){return E(t.continued,t&&t.flowEnd),u=0,p(e)}function y(e){r&&(r.next=e),r=e,a.lazy=t&&t.lazy,a.defineSkip(e.start),a.write(l.sliceStream(e))}function E(t,n){var i=c.length;for(a&&n&&(a.write([null]),r=a=void 0);i-- >t;)l.containerState=c[i][1],c[i][0].exit.call(l,e);c.length=t}}},1139:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1140),r=a(160),i=a(389);t.tokenize=function(e){var t=this,a=e.attempt(i,(function(n){if(null!==n)return e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),t.currentConstruct=void 0,a;e.consume(n)}),e.attempt(this.parser.constructs.flowInitial,o,r(e,e.attempt(this.parser.constructs.flow,o,e.attempt(n,o)),"linePrefix")));return a;function o(n){if(null!==n)return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),t.currentConstruct=void 0,a;e.consume(n)}}},1140:function(e,t,a){"use strict";var n=a(155),r=a(390),i=a(678),o=a(160),s={tokenize:function(e,t){var a;return function(t){return e.enter("content"),a=e.enter("chunkContent",{contentType:"content"}),r(t)};function r(t){return null===t?i(t):n(t)?e.check(l,o,i)(t):(e.consume(t),r)}function i(a){return e.exit("chunkContent"),e.exit("content"),t(a)}function o(t){return e.consume(t),e.exit("chunkContent"),a=a.next=e.enter("chunkContent",{contentType:"content",previous:a}),r}},resolve:function(e){return i(e),e},interruptible:!0,lazy:!0},l={tokenize:function(e,t,a){var i=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o(e,s,"linePrefix")};function s(o){return null===o||n(o)?a(o):i.parser.constructs.disable.null.indexOf("codeIndented")>-1||r(i.events,"linePrefix")<4?e.interrupt(i.parser.constructs.flow,a,t)(o):t(o)}},partial:!0};e.exports=s},1141:function(e,t,a){"use strict";var n=[].splice;e.exports=n},1142:function(e,t,a){"use strict";var n=a(676),r=a(238),i=a(495);function o(e,t){var a,r,o,l;for(a in t)for(l in r=n.call(e,a)?e[a]:e[a]={},o=t[a])r[l]=s(i(o[l]),n.call(r,l)?r[l]:[])}function s(e,t){for(var a=-1,n=[];++a<e.length;)("after"===e[a].add?t:n).push(e[a]);return r(t,0,0,n),t}e.exports=function(e){for(var t={},a=-1;++a<e.length;)o(t,e[a]);return t}},1143:function(e,t,a){"use strict";var n=a(335),r=a(155),i=a(496),o=a(238),s=a(495),l=a(497),c=a(1144),u=a(286),d=a(1145);e.exports=function(e,t,a){var p=a?u(a):{line:1,column:1,offset:0},m={},b=[],g=[],f=[],h={consume:function(e){r(e)?(p.line++,p.column=1,p.offset+=-3===e?2:1,k()):-1!==e&&(p.column++,p.offset++),p._bufferIndex<0?p._index++:(p._bufferIndex++,p._bufferIndex===g[p._index].length&&(p._bufferIndex=-1,p._index++)),v.previous=e},enter:function(e,t){var a=t||{};return a.type=e,a.start=x(),v.events.push(["enter",a,v]),f.push(a),a},exit:function(e){var t=f.pop();return t.end=x(),v.events.push(["exit",t,v]),t},attempt:S((function(e,t){O(e,t.from)})),check:S(w),interrupt:S(w,{interrupt:!0}),lazy:S(w,{lazy:!0})},v={previous:null,events:[],parser:e,sliceStream:E,sliceSerialize:function(e){return c(E(e))},now:x,defineSkip:function(e){m[e.line]=e.column,k()},write:function(e){return g=i(g,e),function(){for(var e,t;p._index<g.length;)if("string"==typeof(t=g[p._index]))for(e=p._index,p._bufferIndex<0&&(p._bufferIndex=0);p._index===e&&p._bufferIndex<t.length;)j(t.charCodeAt(p._bufferIndex));else j(t)}(),null!==g[g.length-1]?[]:(O(t,0),v.events=l(b,v.events,v),v.events)}},y=t.tokenize.call(v,h);return t.resolveAll&&b.push(t),p._index=0,p._bufferIndex=-1,v;function E(e){return d(g,e)}function x(){return u(p)}function j(e){y=y(e)}function w(e,t){t.restore()}function S(e,t){return function(a,r,i){var o,l,c,u;return a.tokenize||"length"in a?d(s(a)):function(e){return e in a||null in a?d(a.null?s(a[e]).concat(s(a.null)):a[e])(e):i(e)};function d(e){return o=e,m(e[l=0])}function m(e){return function(a){var r,i,o,s,l;return r=x(),i=v.previous,o=v.currentConstruct,s=v.events.length,l=Array.from(f),u={restore:function(){p=r,v.previous=i,v.currentConstruct=o,v.events.length=s,f=l,k()},from:s},c=e,e.partial||(v.currentConstruct=e),e.name&&v.parser.constructs.disable.null.indexOf(e.name)>-1?g():e.tokenize.call(t?n({},v,t):v,h,b,g)(a)}}function b(t){return e(c,u),r}function g(e){return u.restore(),++l<o.length?m(o[l]):i}}}function O(e,t){e.resolveAll&&b.indexOf(e)<0&&b.push(e),e.resolve&&o(v.events,t,v.events.length-t,e.resolve(v.events.slice(t),v)),e.resolveTo&&(v.events=e.resolveTo(v.events,v))}function k(){p.line in m&&p.column<2&&(p.column=m[p.line],p.offset+=m[p.line]-1)}}},1144:function(e,t,a){"use strict";var n=a(388);e.exports=function(e){for(var t,a,r,i=-1,o=[];++i<e.length;){if("string"==typeof(t=e[i]))a=t;else if(-5===t)a="\r";else if(-4===t)a="\n";else if(-3===t)a="\r\n";else if(-2===t)a="\t";else if(-1===t){if(r)continue;a=" "}else a=n(t);r=-2===t,o.push(a)}return o.join("")}},1145:function(e,t,a){"use strict";e.exports=function(e,t){var a,n=t.start._index,r=t.start._bufferIndex,i=t.end._index,o=t.end._bufferIndex;return n===i?a=[e[n].slice(r,o)]:(a=e.slice(n,i),r>-1&&(a[0]=a[0].slice(r)),o>0&&a.push(e[i].slice(0,o))),a}},1146:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(679),r=a(1147),i=a(1153),o=a(1155),s=a(1156),l=a(1158),c=a(1160),u=a(1161),d=a(1162),p=a(1163),m=a(1164),b=a(1165),g=a(1166),f=a(1169),h=a(499),v=a(1170),y=a(1171),E=a(1172),x=a(1173),j=a(1174),w=a(687),S={42:x,43:x,45:x,48:x,49:x,50:x,51:x,52:x,53:x,54:x,55:x,56:x,57:x,62:o},O={91:p},k={"-2":u,"-1":u,32:u},I={35:b,42:w,45:[j,w],60:g,61:j,95:w,96:c,126:c},T={38:l,92:s},C={"-5":E,"-4":E,"-3":E,33:v,38:l,42:r,60:[i,f],91:y,92:[m,s],93:h,95:r,96:d},M={null:[r,n.resolver]};t.contentInitial=O,t.disable={null:[]},t.document=S,t.flow=I,t.flowInitial=k,t.insideSpan=M,t.string=T,t.text=C},1147:function(e,t,a){"use strict";var n=a(496),r=a(238),i=a(1148),o=a(1152),s=a(497),l=a(286),c={name:"attention",tokenize:function(e,t){var a,n=i(this.previous);return function(t){return e.enter("attentionSequence"),a=t,r(t)};function r(o){var s,l,c,u;return o===a?(e.consume(o),r):(s=e.exit("attentionSequence"),c=!(l=i(o))||2===l&&n,u=!n||2===n&&l,s._open=42===a?c:c&&(n||!u),s._close=42===a?u:u&&(l||!c),t(o))}},resolveAll:function(e,t){for(var a,i,c,u,d,p,m,b,g=-1;++g<e.length;)if("enter"===e[g][0]&&"attentionSequence"===e[g][1].type&&e[g][1]._close)for(a=g;a--;)if("exit"===e[a][0]&&"attentionSequence"===e[a][1].type&&e[a][1]._open&&t.sliceSerialize(e[a][1]).charCodeAt(0)===t.sliceSerialize(e[g][1]).charCodeAt(0)){if((e[a][1]._close||e[g][1]._open)&&(e[g][1].end.offset-e[g][1].start.offset)%3&&!((e[a][1].end.offset-e[a][1].start.offset+e[g][1].end.offset-e[g][1].start.offset)%3))continue;u={type:(p=e[a][1].end.offset-e[a][1].start.offset>1&&e[g][1].end.offset-e[g][1].start.offset>1?2:1)>1?"strongSequence":"emphasisSequence",start:o(l(e[a][1].end),-p),end:l(e[a][1].end)},d={type:p>1?"strongSequence":"emphasisSequence",start:l(e[g][1].start),end:o(l(e[g][1].start),p)},c={type:p>1?"strongText":"emphasisText",start:l(e[a][1].end),end:l(e[g][1].start)},i={type:p>1?"strong":"emphasis",start:l(u.start),end:l(d.end)},e[a][1].end=l(u.start),e[g][1].start=l(d.end),m=[],e[a][1].end.offset-e[a][1].start.offset&&(m=n(m,[["enter",e[a][1],t],["exit",e[a][1],t]])),m=n(m,[["enter",i,t],["enter",u,t],["exit",u,t],["enter",c,t]]),m=n(m,s(t.parser.constructs.insideSpan.null,e.slice(a+1,g),t)),m=n(m,[["exit",c,t],["enter",d,t],["exit",d,t],["exit",i,t]]),e[g][1].end.offset-e[g][1].start.offset?(b=2,m=n(m,[["enter",e[g][1],t],["exit",e[g][1],t]])):b=0,r(e,a-1,g-a+3,m),g=a+m.length-b-2;break}for(g=-1;++g<e.length;)"attentionSequence"===e[g][1].type&&(e[g][1].type="data");return e}};e.exports=c},1148:function(e,t,a){"use strict";var n=a(239),r=a(1149),i=a(1151);e.exports=function(e){return null===e||n(e)||i(e)?1:r(e)?2:void 0}},1149:function(e,t,a){"use strict";var n=a(1150),r=a(240)(n);e.exports=r},1150:function(e,t,a){"use strict";e.exports=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/},1151:function(e,t,a){"use strict";var n=a(240)(/\s/);e.exports=n},1152:function(e,t,a){"use strict";e.exports=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e}},1153:function(e,t,a){"use strict";var n=a(498),r=a(391),i=a(1154),o=a(680),s={name:"autolink",tokenize:function(e,t,a){var s=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l};function l(t){return n(t)?(e.consume(t),c):i(t)?p(t):a(t)}function c(e){return 43===e||45===e||46===e||r(e)?u(e):p(e)}function u(t){return 58===t?(e.consume(t),d):(43===t||45===t||46===t||r(t))&&s++<32?(e.consume(t),u):p(t)}function d(t){return 62===t?(e.exit("autolinkProtocol"),f(t)):32===t||60===t||o(t)?a(t):(e.consume(t),d)}function p(t){return 64===t?(e.consume(t),s=0,m):i(t)?(e.consume(t),p):a(t)}function m(e){return r(e)?b(e):a(e)}function b(t){return 46===t?(e.consume(t),s=0,m):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",f(t)):g(t)}function g(t){return(45===t||r(t))&&s++<63?(e.consume(t),45===t?g:b):a(t)}function f(a){return e.enter("autolinkMarker"),e.consume(a),e.exit("autolinkMarker"),e.exit("autolink"),t}}};e.exports=s},1154:function(e,t,a){"use strict";var n=a(240)(/[#-'*+\--9=?A-Z^-~]/);e.exports=n},1155:function(e,t,a){"use strict";var n=a(220),r=a(160),i={name:"blockQuote",tokenize:function(e,t,a){var r=this;return function(t){return 62===t?(r.containerState.open||(e.enter("blockQuote",{_container:!0}),r.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),i):a(t)};function i(a){return n(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}},continuation:{tokenize:function(e,t,a){return r(e,e.attempt(i,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};e.exports=i},1156:function(e,t,a){"use strict";var n=a(1157),r={name:"characterEscape",tokenize:function(e,t,a){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),r};function r(r){return n(r)?(e.enter("characterEscapeValue"),e.consume(r),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):a(r)}}};e.exports=r},1157:function(e,t,a){"use strict";var n=a(240)(/[!-/:-@[-`{-~]/);e.exports=n},1158:function(e,t,a){"use strict";var n=a(681),r=a(391),i=a(682),o=a(1159);function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=s(n),c={name:"characterReference",tokenize:function(e,t,a){var n,s,c=this,u=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),d};function d(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),n=31,s=r,m(t))}function p(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),n=6,s=o,m):(e.enter("characterReferenceValue"),n=7,s=i,m(t))}function m(i){var o;return 59===i&&u?(o=e.exit("characterReferenceValue"),s!==r||l.default(c.sliceSerialize(o))?(e.enter("characterReferenceMarker"),e.consume(i),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):a(i)):s(i)&&u++<n?(e.consume(i),m):a(i)}}};e.exports=c},1159:function(e,t,a){"use strict";var n=a(240)(/[\dA-Fa-f]/);e.exports=n},1160:function(e,t,a){"use strict";var n=a(155),r=a(239),i=a(390),o=a(160),s={name:"codeFenced",tokenize:function(e,t,a){var s,l=this,c={tokenize:function(e,t,a){var r=0;return o(e,(function(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),i(t)}),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function i(t){return t===s?(e.consume(t),r++,i):r<d?a(t):(e.exit("codeFencedFenceSequence"),o(e,l,"whitespace")(t))}function l(r){return null===r||n(r)?(e.exit("codeFencedFence"),t(r)):a(r)}},partial:!0},u=i(this.events,"linePrefix"),d=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),s=t,p(t)};function p(t){return t===s?(e.consume(t),d++,p):(e.exit("codeFencedFenceSequence"),d<3?a(t):o(e,m,"whitespace")(t))}function m(t){return null===t||n(t)?h(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(t))}function b(t){return null===t||r(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),o(e,g,"whitespace")(t)):96===t&&t===s?a(t):(e.consume(t),b)}function g(t){return null===t||n(t)?h(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),f(t))}function f(t){return null===t||n(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(t)):96===t&&t===s?a(t):(e.consume(t),f)}function h(a){return e.exit("codeFencedFence"),l.interrupt?t(a):v(a)}function v(t){return null===t?E(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(c,E,u?o(e,v,"linePrefix",u+1):v)):(e.enter("codeFlowValue"),y(t))}function y(t){return null===t||n(t)?(e.exit("codeFlowValue"),v(t)):(e.consume(t),y)}function E(a){return e.exit("codeFenced"),t(a)}},concrete:!0};e.exports=s},1161:function(e,t,a){"use strict";var n=a(155),r=a(238),i=a(390),o=a(160),s={name:"codeIndented",tokenize:function(e,t,a){return e.attempt(l,r,a);function r(a){return null===a?t(a):n(a)?e.attempt(l,r,t)(a):(e.enter("codeFlowValue"),i(a))}function i(t){return null===t||n(t)?(e.exit("codeFlowValue"),r(t)):(e.consume(t),i)}},resolve:function(e,t){var a={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return r(e,0,0,[["enter",a,t]]),r(e,e.length,0,[["exit",a,t]]),e}},l={tokenize:function(e,t,a){var r=this;return o(e,(function s(l){return n(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o(e,s,"linePrefix",5)):i(r.events,"linePrefix")<4?a(l):t(l)}),"linePrefix",5)},partial:!0};e.exports=s},1162:function(e,t,a){"use strict";var n=a(155),r={name:"codeText",tokenize:function(e,t,a){var r,i,o=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),o++,s):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?a(t):96===t?(i=e.enter("codeTextSequence"),r=0,u(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||n(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),c)}function u(a){return 96===a?(e.consume(a),r++,u):r===o?(e.exit("codeTextSequence"),e.exit("codeText"),t(a)):(i.type="codeTextData",c(a))}},resolve:function(e){var t,a,n=e.length-4,r=3;if(!("lineEnding"!==e[r][1].type&&"space"!==e[r][1].type||"lineEnding"!==e[n][1].type&&"space"!==e[n][1].type))for(t=r;++t<n;)if("codeTextData"===e[t][1].type){e[n][1].type=e[r][1].type="codeTextPadding",r+=2,n-=2;break}for(t=r-1,n++;++t<=n;)void 0===a?t!==n&&"lineEnding"!==e[t][1].type&&(a=t):t!==n&&"lineEnding"!==e[t][1].type||(e[a][1].type="codeTextData",t!==a+2&&(e[a][1].end=e[t-1][1].end,e.splice(a+2,t-a-2),n-=t-a-2,t=a+2),a=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};e.exports=r},1163:function(e,t,a){"use strict";var n=a(155),r=a(239),i=a(494),o=a(683),s=a(684),l=a(160),c=a(685),u=a(686),d={name:"definition",tokenize:function(e,t,a){var r,u=this;return function(t){return e.enter("definition"),s.call(u,e,d,a,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function d(t){return r=i(u.sliceSerialize(u.events[u.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),c(e,o(e,e.attempt(p,l(e,m,"whitespace"),l(e,m,"whitespace")),a,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):a(t)}function m(i){return null===i||n(i)?(e.exit("definition"),u.parser.defined.indexOf(r)<0&&u.parser.defined.push(r),t(i)):a(i)}}},p={tokenize:function(e,t,a){return function(t){return r(t)?c(e,i)(t):a(t)};function i(t){return 34===t||39===t||40===t?u(e,l(e,o,"whitespace"),a,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):a(t)}function o(e){return null===e||n(e)?t(e):a(e)}},partial:!0};e.exports=d},1164:function(e,t,a){"use strict";var n=a(155),r={name:"hardBreakEscape",tokenize:function(e,t,a){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),r};function r(r){return n(r)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(r)):a(r)}}};e.exports=r},1165:function(e,t,a){"use strict";var n=a(155),r=a(239),i=a(220),o=a(238),s=a(160),l={name:"headingAtx",tokenize:function(e,t,a){var o=this,l=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),c(t)};function c(n){return 35===n&&l++<6?(e.consume(n),c):null===n||r(n)?(e.exit("atxHeadingSequence"),o.interrupt?t(n):u(n)):a(n)}function u(a){return 35===a?(e.enter("atxHeadingSequence"),d(a)):null===a||n(a)?(e.exit("atxHeading"),t(a)):i(a)?s(e,u,"whitespace")(a):(e.enter("atxHeadingText"),p(a))}function d(t){return 35===t?(e.consume(t),d):(e.exit("atxHeadingSequence"),u(t))}function p(t){return null===t||35===t||r(t)?(e.exit("atxHeadingText"),u(t)):(e.consume(t),p)}},resolve:function(e,t){var a,n,r=e.length-2,i=3;return"whitespace"===e[i][1].type&&(i+=2),r-2>i&&"whitespace"===e[r][1].type&&(r-=2),"atxHeadingSequence"===e[r][1].type&&(i===r-1||r-4>i&&"whitespace"===e[r-2][1].type)&&(r-=i+1===r?2:4),r>i&&(a={type:"atxHeadingText",start:e[i][1].start,end:e[r][1].end},n={type:"chunkText",start:e[i][1].start,end:e[r][1].end,contentType:"text"},o(e,i,r-i+1,[["enter",a,t],["enter",n,t],["exit",n,t],["exit",a,t]])),e}};e.exports=l},1166:function(e,t,a){"use strict";var n=a(498),r=a(391),i=a(155),o=a(239),s=a(220),l=a(388),c=a(1167),u=a(1168),d=a(389),p={name:"htmlFlow",tokenize:function(e,t,a){var d,p,b,g,f,h=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),v};function v(r){return 33===r?(e.consume(r),y):47===r?(e.consume(r),j):63===r?(e.consume(r),d=3,h.interrupt?t:$):n(r)?(e.consume(r),b=l(r),p=!0,w):a(r)}function y(r){return 45===r?(e.consume(r),d=2,E):91===r?(e.consume(r),d=5,b="CDATA[",g=0,x):n(r)?(e.consume(r),d=4,h.interrupt?t:$):a(r)}function E(n){return 45===n?(e.consume(n),h.interrupt?t:$):a(n)}function x(n){return n===b.charCodeAt(g++)?(e.consume(n),g===b.length?h.interrupt?t:N:x):a(n)}function j(t){return n(t)?(e.consume(t),b=l(t),w):a(t)}function w(n){return null===n||47===n||62===n||o(n)?47!==n&&p&&u.indexOf(b.toLowerCase())>-1?(d=1,h.interrupt?t(n):N(n)):c.indexOf(b.toLowerCase())>-1?(d=6,47===n?(e.consume(n),S):h.interrupt?t(n):N(n)):(d=7,h.interrupt?a(n):p?k(n):O(n)):45===n||r(n)?(e.consume(n),b+=l(n),w):a(n)}function S(n){return 62===n?(e.consume(n),h.interrupt?t:N):a(n)}function O(t){return s(t)?(e.consume(t),O):P(t)}function k(t){return 47===t?(e.consume(t),P):58===t||95===t||n(t)?(e.consume(t),I):s(t)?(e.consume(t),k):P(t)}function I(t){return 45===t||46===t||58===t||95===t||r(t)?(e.consume(t),I):T(t)}function T(t){return 61===t?(e.consume(t),C):s(t)?(e.consume(t),T):k(t)}function C(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),f=t,M):s(t)?(e.consume(t),C):(f=void 0,F(t))}function M(t){return t===f?(e.consume(t),D):null===t||i(t)?a(t):(e.consume(t),M)}function F(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||o(t)?T(t):(e.consume(t),F)}function D(e){return 47===e||62===e||s(e)?k(e):a(e)}function P(t){return 62===t?(e.consume(t),L):a(t)}function L(t){return s(t)?(e.consume(t),L):null===t||i(t)?N(t):a(t)}function N(t){return 45===t&&2===d?(e.consume(t),A):60===t&&1===d?(e.consume(t),z):62===t&&4===d?(e.consume(t),q):63===t&&3===d?(e.consume(t),$):93===t&&5===d?(e.consume(t),V):!i(t)||6!==d&&7!==d?null===t||i(t)?R(t):(e.consume(t),N):e.check(m,q,R)(t)}function R(t){return e.exit("htmlFlowData"),_(t)}function _(t){return null===t?G(t):i(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),_):(e.enter("htmlFlowData"),N(t))}function A(t){return 45===t?(e.consume(t),$):N(t)}function z(t){return 47===t?(e.consume(t),b="",B):N(t)}function B(t){return 62===t&&u.indexOf(b.toLowerCase())>-1?(e.consume(t),q):n(t)&&b.length<8?(e.consume(t),b+=l(t),B):N(t)}function V(t){return 93===t?(e.consume(t),$):N(t)}function $(t){return 62===t?(e.consume(t),q):N(t)}function q(t){return null===t||i(t)?(e.exit("htmlFlowData"),G(t)):(e.consume(t),q)}function G(a){return e.exit("htmlFlow"),t(a)}},resolveTo:function(e){for(var t=e.length;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},m={tokenize:function(e,t,a){return function(n){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),e.attempt(d,t,a)}},partial:!0};e.exports=p},1167:function(e,t,a){"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},1168:function(e,t,a){"use strict";e.exports=["pre","script","style","textarea"]},1169:function(e,t,a){"use strict";var n=a(498),r=a(391),i=a(155),o=a(239),s=a(220),l=a(160),c={name:"htmlText",tokenize:function(e,t,a){var c,u,d,p,m=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),b};function b(t){return 33===t?(e.consume(t),g):47===t?(e.consume(t),T):63===t?(e.consume(t),k):n(t)?(e.consume(t),F):a(t)}function g(t){return 45===t?(e.consume(t),f):91===t?(e.consume(t),u="CDATA[",d=0,x):n(t)?(e.consume(t),O):a(t)}function f(t){return 45===t?(e.consume(t),h):a(t)}function h(t){return null===t||62===t?a(t):45===t?(e.consume(t),v):y(t)}function v(e){return null===e||62===e?a(e):y(e)}function y(t){return null===t?a(t):45===t?(e.consume(t),E):i(t)?(p=y,z(t)):(e.consume(t),y)}function E(t){return 45===t?(e.consume(t),V):y(t)}function x(t){return t===u.charCodeAt(d++)?(e.consume(t),d===u.length?j:x):a(t)}function j(t){return null===t?a(t):93===t?(e.consume(t),w):i(t)?(p=j,z(t)):(e.consume(t),j)}function w(t){return 93===t?(e.consume(t),S):j(t)}function S(t){return 62===t?V(t):93===t?(e.consume(t),S):j(t)}function O(t){return null===t||62===t?V(t):i(t)?(p=O,z(t)):(e.consume(t),O)}function k(t){return null===t?a(t):63===t?(e.consume(t),I):i(t)?(p=k,z(t)):(e.consume(t),k)}function I(e){return 62===e?V(e):k(e)}function T(t){return n(t)?(e.consume(t),C):a(t)}function C(t){return 45===t||r(t)?(e.consume(t),C):M(t)}function M(t){return i(t)?(p=M,z(t)):s(t)?(e.consume(t),M):V(t)}function F(t){return 45===t||r(t)?(e.consume(t),F):47===t||62===t||o(t)?D(t):a(t)}function D(t){return 47===t?(e.consume(t),V):58===t||95===t||n(t)?(e.consume(t),P):i(t)?(p=D,z(t)):s(t)?(e.consume(t),D):V(t)}function P(t){return 45===t||46===t||58===t||95===t||r(t)?(e.consume(t),P):L(t)}function L(t){return 61===t?(e.consume(t),N):i(t)?(p=L,z(t)):s(t)?(e.consume(t),L):D(t)}function N(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),c=t,R):i(t)?(p=N,z(t)):s(t)?(e.consume(t),N):(e.consume(t),c=void 0,A)}function R(t){return t===c?(e.consume(t),_):null===t?a(t):i(t)?(p=R,z(t)):(e.consume(t),R)}function _(e){return 62===e||47===e||o(e)?D(e):a(e)}function A(t){return null===t||34===t||39===t||60===t||61===t||96===t?a(t):62===t||o(t)?D(t):(e.consume(t),A)}function z(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l(e,B,"linePrefix",m.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function B(t){return e.enter("htmlTextData"),p(t)}function V(n){return 62===n?(e.consume(n),e.exit("htmlTextData"),e.exit("htmlText"),t):a(n)}}};e.exports=c},1170:function(e,t,a){"use strict";var n={name:"labelStartImage",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),r};function r(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),i):a(t)}function i(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(499).resolveAll};e.exports=n},1171:function(e,t,a){"use strict";var n={name:"labelStartLink",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),r};function r(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(499).resolveAll};e.exports=n},1172:function(e,t,a){"use strict";var n=a(160),r={name:"lineEnding",tokenize:function(e,t){return function(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n(e,t,"linePrefix")}}};e.exports=r},1173:function(e,t,a){"use strict";var n=a(682),r=a(220),i=a(390),o=a(677),s=a(160),l=a(389),c=a(687),u={name:"list",tokenize:function(e,t,a){var s=this,u=i(s.events,"linePrefix"),p=0;return function(t){var r=s.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===r?!s.containerState.marker||t===s.containerState.marker:n(t)){if(s.containerState.type||(s.containerState.type=r,e.enter(r,{_container:!0})),"listUnordered"===r)return e.enter("listItemPrefix"),42===t||45===t?e.check(c,a,b)(t):b(t);if(!s.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(t)}return a(t)};function m(t){return n(t)&&++p<10?(e.consume(t),m):(!s.interrupt||p<2)&&(s.containerState.marker?t===s.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),b(t)):a(t)}function b(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),s.containerState.marker=s.containerState.marker||t,e.check(l,s.interrupt?a:g,e.attempt(d,h,f))}function g(e){return s.containerState.initialBlankLine=!0,u++,h(e)}function f(t){return r(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),h):a(t)}function h(a){return s.containerState.size=u+o(s.sliceStream(e.exit("listItemPrefix"))),t(a)}},continuation:{tokenize:function(e,t,a){var n=this;return n.containerState._closeFlow=void 0,e.check(l,(function(a){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,s(e,t,"listItemIndent",n.containerState.size+1)(a)}),(function(a){return n.containerState.furtherBlankLines||!r(a)?(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,i(a)):(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,e.attempt(p,t,i)(a))}));function i(r){return n.containerState._closeFlow=!0,n.interrupt=void 0,s(e,e.attempt(u,t,a),"linePrefix",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(r)}}},exit:function(e){e.exit(this.containerState.type)}},d={tokenize:function(e,t,a){var n=this;return s(e,(function(e){return r(e)||!i(n.events,"listItemPrefixWhitespace")?a(e):t(e)}),"listItemPrefixWhitespace",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},p={tokenize:function(e,t,a){var n=this;return s(e,(function(e){return i(n.events,"listItemIndent")===n.containerState.size?t(e):a(e)}),"listItemIndent",n.containerState.size+1)},partial:!0};e.exports=u},1174:function(e,t,a){"use strict";var n=a(155),r=a(286),i=a(160),o={name:"setextUnderline",tokenize:function(e,t,a){for(var r,o,s=this,l=s.events.length;l--;)if("lineEnding"!==s.events[l][1].type&&"linePrefix"!==s.events[l][1].type&&"content"!==s.events[l][1].type){o="paragraph"===s.events[l][1].type;break}return function(t){return s.lazy||!s.interrupt&&!o?a(t):(e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),r=t,c(t))};function c(t){return t===r?(e.consume(t),c):(e.exit("setextHeadingLineSequence"),i(e,u,"lineSuffix")(t))}function u(r){return null===r||n(r)?(e.exit("setextHeadingLine"),t(r)):a(r)}},resolveTo:function(e,t){for(var a,n,i,o,s=e.length;s--;)if("enter"===e[s][0]){if("content"===e[s][1].type){a=s;break}"paragraph"===e[s][1].type&&(n=s)}else"content"===e[s][1].type&&e.splice(s,1),i||"definition"!==e[s][1].type||(i=s);return o={type:"setextHeading",start:r(e[n][1].start),end:r(e[e.length-1][1].end)},e[n][1].type="setextHeadingText",i?(e.splice(n,0,["enter",o,t]),e.splice(i+1,0,["exit",e[a][1],t]),e[a][1].end=r(e[i][1].end)):e[a][1]=o,e.push(["exit",o,t]),e}};e.exports=o},1175:function(e,t,a){"use strict";var n=/[\0\t\n\r]/g;e.exports=function(){var e,t=!0,a=1,r="";return function(i,o,s){var l,c,u,d,p,m=[];for(i=r+i.toString(o),u=0,r="",t&&(65279===i.charCodeAt(0)&&u++,t=void 0);u<i.length;){if(n.lastIndex=u,d=(l=n.exec(i))?l.index:i.length,p=i.charCodeAt(d),!l){r=i.slice(u);break}if(10===p&&u===d&&e)m.push(-3),e=void 0;else if(e&&(m.push(-5),e=void 0),u<d&&(m.push(i.slice(u,d)),a+=d-u),0===p)m.push(65533),a++;else if(9===p)for(c=4*Math.ceil(a/4),m.push(-2);a++<c;)m.push(-1);else 10===p?(m.push(-4),a=1):(e=!0,a=1);u=d+1}return s&&(e&&m.push(-5),r&&m.push(r),m.push(null)),m}}},1176:function(e,t,a){"use strict";var n=a(678);e.exports=function(e){for(;!n(e););return e}},1177:function(e,t,a){e.exports=a(35)(3846)},1178:function(e,t,a){e.exports=a(35)(2138)},1179:function(e,t,a){e.exports=a(35)(8)},1180:function(e,t,a){e.exports=a(35)(1629)},1181:function(e,t,a){const n=a(1182);e.exports=function(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return e=>{n(e,"element",t)};function t(t,a,n){const r=t,i=n;let o;if(e.allowedElements?o=!e.allowedElements.includes(r.tagName):e.disallowedElements&&(o=e.disallowedElements.includes(r.tagName)),!o&&e.allowElement&&"number"==typeof a&&(o=!e.allowElement(r,a,i)),o&&"number"==typeof a)return e.unwrapDisallowed&&r.children?i.children.splice(a,1,...r.children):i.children.splice(a,1),a}}},1182:function(e,t,a){e.exports=a(35)(363)},1183:function(e,t){const a=["http","https","mailto","tel"];e.exports=function(e){const t=(e||"").trim(),n=t.charAt(0);if("#"===n||"/"===n)return t;const r=t.indexOf(":");if(-1===r)return t;let i=-1;for(;++i<a.length;){const e=a[i];if(r===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return i=t.indexOf("?"),-1!==i&&r>i?t:(i=t.indexOf("#"),-1!==i&&r>i?t:"javascript:void(0)")}},1184:function(e,t,a){"use strict";const n=a(2),r=a(1185),i=a(1186),o=a(1187),s=a(1188),l=a(1189),c=a(1190),u=a(1191);t.hastToReact=b,t.hastChildrenToReact=m;const d={}.hasOwnProperty,p=new Set(["table","thead","tbody","tfoot","tr"]);function m(e,t){const a=[];let n,r=-1;for(;++r<t.children.length;)n=t.children[r],"element"===n.type?a.push(b(e,n,r,t)):"text"===n.type?"element"===t.type&&p.has(t.tagName)&&"\n"===n.value||a.push(n.value):"raw"!==n.type||e.options.skipHtml||a.push(n.value);return a}function b(e,t,a,o){const s=e.options,l=e.schema,c=t.tagName,u={};let p,b=l;if("html"===l.space&&"svg"===c&&(b=i,e.schema=b),t.properties)for(p in t.properties)d.call(t.properties,p)&&f(u,p,t.properties[p],e);"ol"!==c&&"ul"!==c||e.listDepth++;const h=m(e,t);"ol"!==c&&"ul"!==c||e.listDepth--,e.schema=l;const v=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},y=s.components&&d.call(s.components,c)?s.components[c]:c,E="string"==typeof y||y===n.Fragment;if(!r.isValidElementType(y))throw new TypeError(`Component for name \`${c}\` not defined or is not renderable`);if(u.key=[c,v.start.line,v.start.column,a].join("-"),"a"===c&&s.linkTarget&&(u.target="function"==typeof s.linkTarget?s.linkTarget(u.href,t.children,u.title):s.linkTarget),"a"===c&&s.transformLinkUri&&(u.href=s.transformLinkUri(u.href,t.children,u.title)),E||"code"!==c||"element"!==o.type||"pre"===o.tagName||(u.inline=!0),E||"h1"!==c&&"h2"!==c&&"h3"!==c&&"h4"!==c&&"h5"!==c&&"h6"!==c||(u.level=parseInt(c.charAt(1),10)),"img"===c&&s.transformImageUri&&(u.src=s.transformImageUri(u.src,u.alt,u.title)),!E&&"li"===c&&"element"===o.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const a=e.children[t];if("element"===a.type&&"input"===a.tagName)return a}return null}(t);u.checked=e&&e.properties?Boolean(e.properties.checked):null,u.index=g(o,t),u.ordered="ol"===o.tagName}var x;return E||"ol"!==c&&"ul"!==c||(u.ordered="ol"===c,u.depth=e.listDepth),"td"!==c&&"th"!==c||(u.align&&(u.style||(u.style={}),u.style.textAlign=u.align,delete u.align),E||(u.isHeader="th"===c)),E||"tr"!==c||"element"!==o.type||(u.isHeader=Boolean("thead"===o.tagName)),s.sourcePos&&(u["data-sourcepos"]=[(x=v).start.line,":",x.start.column,"-",x.end.line,":",x.end.column].map((e=>String(e))).join("")),!E&&s.rawSourcePos&&(u.sourcePosition=t.position),!E&&s.includeElementIndex&&(u.index=g(o,t),u.siblingCount=g(o)),E||(u.node=t),h.length>0?n.createElement(y,u,h):n.createElement(y,u)}function g(e,t){let a=-1,n=0;for(;++a<e.children.length&&e.children[a]!==t;)"element"===e.children[a].type&&n++;return n}function f(e,t,a,n){const r=o(n.schema,t);let i=a;null!=i&&i==i&&(i&&"object"==typeof i&&"length"in i&&(i=(r.commaSeparated?c:l).stringify(i)),"style"===r.property&&"string"==typeof i&&(i=function(e){const t={};try{u(e,(function(e,a){const n="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[n.replace(/-([a-z])/g,h)]=a}))}catch(e){}return t}(i)),r.space&&r.property?e[d.call(s,r.property)?s[r.property]:r.property]=i:r.attribute&&(e[r.attribute]=i))}function h(e,t){return t.toUpperCase()}},1185:function(e,t,a){e.exports=a(35)(484)},1186:function(e,t,a){e.exports=a(35)(3909)},1187:function(e,t,a){e.exports=a(35)(1640)},1188:function(e,t,a){e.exports=a(35)(3911)},1189:function(e,t,a){e.exports=a(35)(1641)},1190:function(e,t,a){e.exports=a(35)(1642)},1191:function(e,t,a){e.exports=a(35)(3912)},1192:function(e,t,a){var n,r,i,o;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */o=function(e){var t=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(e){return"function"==typeof e}function r(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return null!=e&&"object"==typeof e&&t in e}var o=RegExp.prototype.test,s=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function b(e){this.string=e,this.tail=e,this.pos=0}function g(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function f(){this.cache={}}b.prototype.eos=function(){return""===this.tail},b.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},b.prototype.scanUntil=function(e){var t,a=this.tail.search(e);switch(a){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,a),this.tail=this.tail.substring(a)}return this.pos+=t.length,t},g.prototype.push=function(e){return new g(e,this)},g.prototype.lookup=function(e){var t,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var r,o,s=this,l=!1;s;){if(e.indexOf(".")>0)for(t=s.view,r=e.split("."),o=0;null!=t&&o<r.length;)o===r.length-1&&(l=i(t,r[o])),t=t[r[o++]];else t=s.view[e],l=i(s.view,e);if(l)break;s=s.parent}a[e]=t}return n(t)&&(t=t.call(this.view)),t},f.prototype.clearCache=function(){this.cache={}},f.prototype.parse=function(t,n){var i=this.cache,l=i[t];return null==l&&(l=i[t]=function(t,n){if(!t)return[];var i,l,g,f,h=[],v=[],y=[],E=!1,x=!1;function j(){if(E&&!x)for(;y.length;)delete v[y.pop()];else y=[];E=!1,x=!1}function w(e){if("string"==typeof e&&(e=e.split(u,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);i=new RegExp(r(e[0])+"\\s*"),l=new RegExp("\\s*"+r(e[1])),g=new RegExp("\\s*"+r("}"+e[1]))}w(n||e.tags);for(var S,O,k,I,T,C,M=new b(t);!M.eos();){if(S=M.pos,k=M.scanUntil(i))for(var F=0,D=k.length;F<D;++F)f=I=k.charAt(F),function(e,t){return o.call(e,t)}(s,f)?x=!0:y.push(v.length),v.push(["text",I,S,S+1]),S+=1,"\n"===I&&j();if(!M.scan(i))break;if(E=!0,O=M.scan(m)||"name",M.scan(c),"="===O?(k=M.scanUntil(d),M.scan(d),M.scanUntil(l)):"{"===O?(k=M.scanUntil(g),M.scan(p),M.scanUntil(l),O="&"):k=M.scanUntil(l),!M.scan(l))throw new Error("Unclosed tag at "+M.pos);if(T=[O,k,S,M.pos],v.push(T),"#"===O||"^"===O)h.push(T);else if("/"===O){if(!(C=h.pop()))throw new Error('Unopened section "'+k+'" at '+S);if(C[1]!==k)throw new Error('Unclosed section "'+C[1]+'" at '+S)}else"name"===O||"{"===O||"&"===O?x=!0:"="===O&&w(k)}if(C=h.pop())throw new Error('Unclosed section "'+C[1]+'" at '+M.pos);return function(e){for(var t,a=[],n=a,r=[],i=0,o=e.length;i<o;++i)switch((t=e[i])[0]){case"#":case"^":n.push(t),r.push(t),n=t[4]=[];break;case"/":r.pop()[5]=t[2],n=r.length>0?r[r.length-1][4]:a;break;default:n.push(t)}return a}(function(e){for(var t,a,n=[],r=0,i=e.length;r<i;++r)(t=e[r])&&("text"===t[0]&&a&&"text"===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}(v))}(t,n)),l},f.prototype.render=function(e,t,a){var n=this.parse(e),r=t instanceof g?t:new g(t);return this.renderTokens(n,r,a,e)},f.prototype.renderTokens=function(e,t,a,n){for(var r,i,o,s="",l=0,c=e.length;l<c;++l)o=void 0,"#"===(i=(r=e[l])[0])?o=this.renderSection(r,t,a,n):"^"===i?o=this.renderInverted(r,t,a,n):">"===i?o=this.renderPartial(r,t,a,n):"&"===i?o=this.unescapedValue(r,t):"name"===i?o=this.escapedValue(r,t):"text"===i&&(o=this.rawValue(r)),void 0!==o&&(s+=o);return s},f.prototype.renderSection=function(e,t,r,i){var o=this,s="",l=t.lookup(e[1]);if(l){if(a(l))for(var c=0,u=l.length;c<u;++c)s+=this.renderTokens(e[4],t.push(l[c]),r,i);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(e[4],t.push(l),r,i);else if(n(l)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,i.slice(e[3],e[5]),(function(e){return o.render(e,t,r)})))&&(s+=l)}else s+=this.renderTokens(e[4],t,r,i);return s}},f.prototype.renderInverted=function(e,t,n,r){var i=t.lookup(e[1]);if(!i||a(i)&&0===i.length)return this.renderTokens(e[4],t,n,r)},f.prototype.renderPartial=function(e,t,a){if(a){var r=n(a)?a(e[1]):a[e[1]];return null!=r?this.renderTokens(this.parse(r),t,a,r):void 0}},f.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},f.prototype.escapedValue=function(t,a){var n=a.lookup(t[1]);if(null!=n)return e.escape(n)},f.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var h=new f;return e.clearCache=function(){return h.clearCache()},e.parse=function(e,t){return h.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(a(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)');var r;return h.render(e,t,n)},e.to_html=function(t,a,r,i){var o=e.render(t,a,r);if(!n(i))return o;i(o)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=b,e.Context=g,e.Writer=f,e},t&&"string"!=typeof t.nodeName?o(t):(r=[t],void 0===(i="function"==typeof(n=o)?n.apply(t,r):n)||(e.exports=i))},1193:function(e,t,a){e.exports=a(35)(1963)},1194:function(e){e.exports=JSON.parse('[{"field":"process.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.parent.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.parent.pid","description":"Process id."},{"field":"process.entry_leader.parent.session_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.parent.session_leader.pid","description":"Process id."},{"field":"process.entry_leader.parent.session_leader.vpid","description":"Virtual process id."},{"field":"process.entry_leader.parent.vpid","description":"Virtual process id."},{"field":"process.entry_leader.pid","description":"Process id."},{"field":"process.entry_leader.vpid","description":"Virtual process id."},{"field":"process.group_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.group_leader.pid","description":"Process id."},{"field":"process.group_leader.vpid","description":"Virtual process id."},{"field":"process.parent.entity_id","description":"Unique identifier for the process."},{"field":"process.parent.group_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.parent.group_leader.pid","description":"Process id."},{"field":"process.parent.group_leader.vpid","description":"Virtual process id."},{"field":"process.parent.pid","description":"Process id."},{"field":"process.parent.vpid","description":"Virtual process id."},{"field":"process.pid","description":"Process id."},{"field":"process.session_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.session_leader.parent.entity_id","description":"Unique identifier for the process."},{"field":"process.session_leader.parent.pid","description":"Process id."},{"field":"process.session_leader.parent.session_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.session_leader.parent.session_leader.pid","description":"Process id."},{"field":"process.session_leader.parent.session_leader.vpid","description":"Virtual process id."},{"field":"process.session_leader.parent.vpid","description":"Virtual process id."},{"field":"process.session_leader.pid","description":"Process id."},{"field":"process.session_leader.vpid","description":"Virtual process id."},{"field":"process.vpid","description":"Virtual process id."}]')},1195:function(e,t,a){e.exports=a(35)(2134)},1198:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i}));const n="domDragDrop",r=32,i=16},1208:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(2),r=a.n(n),i=a(42);const o=a(4).i18n.translate("xpack.securitySolution.detectionEngine.ruleInfo.UnknownText",{defaultMessage:"Unknown"});var s=a(151);const l=({createdBy:e,createdAt:t,"data-test-subj":a})=>r.a.createElement("div",{"data-test-subj":a},r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!=e?e:o,date:r.a.createElement(s.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"createdAt"})}}));l.displayName="CreatedBy";const c=({updatedBy:e,updatedAt:t,"data-test-subj":a})=>r.a.createElement("div",{"data-test-subj":a},r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!=e?e:o,date:r.a.createElement(s.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"updatedAt"})}}));c.displayName="UpdatedBy"},1240:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),r=a(299);function i(e){const{data:t,rowRenderers:a}=e,i=Object(n.useMemo)((()=>Object(r.a)({data:t,rowRenderers:a})),[t,a]);return Object(n.useMemo)((()=>({canShowRowRenderer:null!=i,rowRenderer:i})),[i])}},1241:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a.n(n),i=a(118);const o=r.a.memo((({updatedAt:e})=>{const{timelines:t}=Object(i.j)().services;return e>0?r.a.createElement("span",{"data-test-subj":"last-updated-container"},t.getLastUpdated({updatedAt:e})):null}));o.displayName="LastUpdatedContainer"},1243:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a(127),i=a(132),o=a(122),s=a(243),l=a(585),c=a(274),u=a(1318);const d=e=>{const{browserFields:t}=Object(i.a)(r.SourcererScopeName.timeline),a=Object(o.a)("unifiedComponentsInTimelineDisabled"),d=Object(n.useMemo)((()=>a?s.b:c.a),[a]),p=Object(n.useMemo)((()=>null!=e?e:d),[e,d]),m=Object(u.d)(p,t,!1),b=Object(n.useMemo)((()=>[...m.map((e=>e.id)),...l.i]),[m]);return Object(n.useMemo)((()=>({defaultColumns:d,localColumns:p,augmentedColumnHeaders:m,timelineQueryFieldsFromColumns:b})),[m,d,b,p])}},1251:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(44),r=a(19),i=a(2),o=a.n(i),s=a(64);var l=a(4),c=a(1240);const u=({ariaRowindex:e,containerRef:t,event:a,lastFocusedAriaColindex:u,rowRenderers:d,timelineId:p})=>{const{focusOwnership:m,onFocus:b,onKeyDown:g,onOutsideClick:f}=(({ariaRowindex:e,colindexAttribute:t,containerRef:a,lastFocusedAriaColindex:n,onColumnFocused:r,rowindexAttribute:o})=>{const[l,c]=Object(i.useState)("not-owned"),u=Object(i.useCallback)((()=>{c((e=>"owned"!==e?"owned":e))}),[]),d=Object(i.useCallback)((()=>{c("not-owned")}),[]),p=Object(i.useCallback)((i=>{if(Object(s.isArrowDownOrArrowUp)(i)||Object(s.isEscape)(i)){i.preventDefault(),i.stopPropagation(),c("not-owned");const l=Object(s.isEscape)(i)?e:(({ariaRowindex:e,event:t})=>Object(s.isArrowUp)(t)?e:e+1)({ariaRowindex:e,event:i});setTimeout((()=>{r(Object(s.focusColumn)({ariaColindex:n,ariaRowindex:l,colindexAttribute:t,containerElement:a.current,rowindexAttribute:o}))}),0)}}),[e,t,a,n,r,o]);return Object(i.useMemo)((()=>({focusOwnership:l,onFocus:u,onOutsideClick:d,onKeyDown:p})),[l,u,p,d])})({ariaRowindex:e,colindexAttribute:s.ARIA_COLINDEX_ATTRIBUTE,containerRef:t,lastFocusedAriaColindex:u,onColumnFocused:n.noop,rowindexAttribute:s.ARIA_ROWINDEX_ATTRIBUTE}),{rowRenderer:h}=Object(c.a)({data:a.ecs,rowRenderers:d});return Object(i.useMemo)((()=>{return h&&o.a.createElement("div",{className:Object(s.getRowRendererClassName)(e),role:"dialog",onFocus:b},o.a.createElement(r.EuiOutsideClickDetector,{onOutsideClick:f},o.a.createElement(r.EuiFocusTrap,{clickOutsideDisables:!0,disabled:"owned"!==m},o.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"eventRendererScreenReaderOnly"},o.a.createElement("p",null,(t=e,l.i18n.translate("xpack.securitySolution.timeline.youAreInAnEventRendererScreenReaderOnly",{values:{row:t},defaultMessage:"You are in an event renderer for row: {row}. Press the up arrow key to exit and return to the current row, or the down arrow key to exit and advance to the next row."})))),o.a.createElement(r.EuiFlexGroup,{direction:"column",onKeyDown:g},o.a.createElement(r.EuiFlexItem,{grow:!0},h.renderRow({data:a.ecs,isDraggable:!0,scopeId:p}))))));var t}),[e,a.ecs,m,b,g,f,h,p])}},1318:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"d",(function(){return u}));var n=a(395),r=a.n(n),i=a(664);const o=(e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind,s=[],l=[],c=[],u=r()(i.b)},1319:function(e,t,a){"use strict";a.d(t,"a",(function(){return ar})),a.d(t,"c",(function(){return nr})),a.d(t,"b",(function(){return rr})),a.d(t,"d",(function(){return ir}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(1397),c=a(1216),u=a(43),d=a(7);const p="previewSection";var m=a(4);const b=m.i18n.translate("expandableFlyout.previewSection.backButton",{defaultMessage:"Back"}),g=m.i18n.translate("expandableFlyout.previewSection.closeButton",{defaultMessage:"Close"}),f=e=>Object(d.has)(e,"title")||Object(d.has)(e,"backgroundColor")||Object(d.has)(e,"textColor"),h=({component:e,leftPosition:t,banner:a})=>{const{euiTheme:n}=Object(s.useEuiTheme)(),{closePreviewPanel:r,previousPreviewPanel:i}=Object(c.a)(),o=t+4,l=Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonIcon,{iconType:"cross",onClick:()=>r(),"data-test-subj":"previewSectionCloseButton","aria-label":g})),d=Object(u.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",iconSide:"left",onClick:()=>i(),"data-test-subj":"previewSectionBackButton","aria-label":b},b)),l);return Object(u.jsx)("div",{css:Object(u.css)("position:absolute;top:8px;bottom:8px;right:4px;left:",o,"px;z-index:1000;","")},Object(u.jsx)(s.EuiSplitPanel.Outer,{css:Object(u.css)("margin:",n.size.xs,";box-shadow:0 0 16px 0px ",Object(s.transparentize)(n.colors.mediumShade,.5),";",""),"data-test-subj":p,className:"eui-fullHeight"},f(a)&&Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,color:a.backgroundColor,paddingSize:"xs","data-test-subj":`${p}BannerPanel`},Object(u.jsx)(s.EuiText,{textAlign:"center",color:a.textColor,size:"xs","data-test-subj":`${p}BannerText`},a.title)),Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,paddingSize:"s","data-test-subj":"previewSectionHeader"},d),e))};h.displayName="PreviewSection";const v=({component:e,width:t})=>{const a=Object(i.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!1,style:a,"data-test-subj":"rightSection"},e)};v.displayName="RightSection";const y=({component:e,width:t})=>{const a=Object(i.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!0,"data-test-subj":"leftSection",style:a},e)};y.displayName="LeftSection";const E={height:"100%"},x=({customStyles:e,registeredPanels:t,...a})=>{var n,o;const d=(()=>{const[e,t]=Object(i.useState)(0);return Object(i.useLayoutEffect)((()=>{function e(){t(window.innerWidth)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),e})(),{left:p,right:m,preview:b}=Object(l.a)(),{closeFlyout:g}=Object(c.a)(),x=Object(i.useMemo)((()=>t.find((e=>e.key===(null==p?void 0:p.id)))),[p,t]),j=Object(i.useMemo)((()=>t.find((e=>e.key===(null==m?void 0:m.id)))),[m,t]),w=b?b[b.length-1]:void 0,S=f(null==w||null===(n=w.params)||void 0===n?void 0:n.banner)?null==w||null===(o=w.params)||void 0===o?void 0:o.banner:void 0,O=Object(i.useMemo)((()=>t.find((e=>e.key===(null==w?void 0:w.id)))),[w,t]),k=null!=j&&null!=m,I=null!=x&&null!=p,T=null!=O&&null!=b,{rightSectionWidth:C,leftSectionWidth:M,flyoutWidth:F,previewSectionLeft:D}=(({windowWidth:e,showRight:t,showLeft:a,showPreview:n})=>{let r=0;if(t)if(e<992)r=Math.min(380,e);else{const t=(e-992)/928*370;r=Math.min(380+t,750)}let i=0;a&&(i=e<=1600?e-r-48:Math.min(80*(e-r)/100,1500));let o=0;return n&&(o=i),{rightSectionWidth:r,leftSectionWidth:i,flyoutWidth:t&&a?`${r+i}px`:`${r}px`,previewSectionLeft:o}})({windowWidth:d,showRight:k,showLeft:I,showPreview:T});return p||m||null!=b&&b.length?Object(u.jsx)(s.EuiFlyout,r()({},a,{size:F,ownFocus:!1,onClose:e=>{g(),a.onClose&&a.onClose(e)},css:e}),Object(u.jsx)(s.EuiFlexGroup,{direction:x?"row":"column",wrap:!1,gutterSize:"none",style:E,responsive:!1},I?Object(u.jsx)(y,{component:x.component({...p}),width:M}):null,k?Object(u.jsx)(v,{component:j.component({...m}),width:C}):null),T?Object(u.jsx)(h,{component:O.component({...w}),leftPosition:D,banner:S}):null):null};x.displayName="ExpandableFlyout";var j=a(145),w=a(175),S=a(342),O=a(776),k=a(1104),I=a(435),T=a(339);const C=Object(i.createContext)(void 0),M=Object(i.memo)((({id:e,indexName:t,scopeId:a,isolateAction:n,children:r})=>{const{dataFormattedForFieldBrowser:s,loading:l}=Object(k.a)({eventId:e,indexName:t}),c=Object(i.useMemo)((()=>e&&t&&a&&n&&s?{eventId:e,indexName:t,scopeId:a,dataFormattedForFieldBrowser:s,isolateAction:n}:void 0),[e,t,a,s,n]);return l?o.a.createElement(T.a,null):c?o.a.createElement(C.Provider,{value:c},r):o.a.createElement(I.a,null)}));M.displayName="IsolateHostPanelProvider";const F=()=>{const e=Object(i.useContext)(C);if(!e)throw new Error("IsolateHostPanelContext can only be used within IsolateHostPanelContext provider");return e};var D=a(418);const P=()=>{const{openRightPanel:e}=Object(c.a)(),{dataFormattedForFieldBrowser:t,eventId:a,scopeId:n,indexName:r,isolateAction:s}=F(),{isIsolateActionSuccessBannerVisible:l,handleIsolationActionSuccess:u}=Object(O.a)(),{alertId:d,hostName:p}=Object(w.b)(t),m=Object(i.useCallback)((()=>e({id:j.e,params:{id:a,indexName:r,scopeId:n}})),[a,r,n,e]);return o.a.createElement(D.a,null,l&&o.a.createElement(S.d,{hostName:p,alertId:d,isolateAction:s}),o.a.createElement(S.f,{details:t,cancelCallback:m,successCallback:u,isolateAction:s}))};var L=a(1203),N=a(332),R=a(10),_=a(211);const A=`${_.a}HeaderTitle`;var z=a(537),B=a(1099);const V=()=>{const{isolateAction:e,dataFormattedForFieldBrowser:t}=F(),{isSupported:a,details:{agentType:n}}=Object(N.a)(t),r=Object(i.useMemo)((()=>a&&("sentinel_one"===n||"crowdstrike"===n)),[n,a]),l=o.a.createElement(s.EuiFlexGroup,{responsive:!0,gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":"flyoutHostIsolationHeaderTitle"},"isolateHost"===e?B.b:B.c,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(L.a,{agentType:n,layout:"horizontal","data-test-subj":"flyoutHostIsolationHeaderIntegration"})),r&&o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiBetaBadge,{"data-test-subj":"flyoutHostIsolationHeaderBadge",label:R.g,tooltipContent:R.h})));return o.a.createElement(z.a,null,o.a.createElement(s.EuiTitle,{size:"s"},o.a.createElement("h4",{"data-test-subj":A},l)))},$=()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(V,null),o.a.createElement(P,null));var q=a(125),G=a(118),U=a(484),H=a(42),W=a(488),Q=a(1432);const K=({title:e,defaultValue:t})=>{const{storage:a}=Object(G.j)().services,n=a.get(U.a.OVERVIEW_TAB_EXPANDED_SECTIONS),r=e.toLowerCase();return n&&void 0!==n[r]?n[r]:t};var J=a(210),Y=a(135);const Z=()=>{const{openLeftPanel:e}=Object(c.a)(),{eventId:t,indexName:a,scopeId:n}=Object(q.b)(),r=Object(i.useCallback)((()=>{e({id:j.c,path:{tab:J.e},params:{id:t,indexName:a,scopeId:n}})}),[t,a,e,n]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiButton,{onClick:r,iconType:"documentation","data-test-subj":Y.cb,size:"s"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.responseButtonLabel",defaultMessage:"Response"})))};Z.displayName="ResponseButton";var X=a(279),ee=a(142),te=a(192);const ae="response",ne=Object(i.memo)((()=>{const{isPreview:e,getFieldsData:t,isPreviewMode:a}=Object(q.b)(),n=K({title:ae,defaultValue:!1}),r=Object(ee.a)(t("event.kind")),l=Object(i.useMemo)((()=>e?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.previewTitle",defaultMessage:"Response actions"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.response.previewAriaLabel",{defaultMessage:"Response actions"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.previewMessage",defaultMessage:"Response is not available in alert preview."})):a?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.openFlyoutTitle",defaultMessage:"Response actions"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.response.openFlyoutAriaLabel",{defaultMessage:"Response actions"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.openFlyoutMessage",defaultMessage:"Open alert details to access response actions."})):o.a.createElement(Z,null)),[e,a]);return r!==te.a.signal?null:o.a.createElement(X.b,{expanded:n,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.sectionTitle",defaultMessage:"Response"}),localStorageKey:ae,"data-test-subj":Y.db},l)}));ne.displayName="ResponseSection";var re=a(608),ie=a(379),oe=a(505),se=a(122),le=a(229),ce=a(320),ue=a(174),de=a(288),pe=a(318),me=a(287),be=a(319);const ge=({field:e,value:t})=>{const{scopeId:a,eventId:n,indexName:r}=Object(q.b)(),{openLeftPanel:l,openPreviewPanel:u}=Object(c.a)(),d=!Object(se.a)("entityAlertPreviewDisabled"),{telemetry:p}=Object(G.j)().services,m=Object(i.useCallback)((()=>{l({id:j.c,path:{tab:J.b,subTab:ce.a},params:{id:n,indexName:r,scopeId:a}})}),[n,r,l,a]),b=Object(i.useCallback)((()=>{u({id:de.e,params:{hostName:t,scopeId:a,banner:pe.a}}),p.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[u,t,a,p]),g=Object(i.useCallback)((()=>{u({id:me.d,params:{userName:t,scopeId:a,banner:be.a}}),p.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[u,t,a,p]),f=Object(i.useMemo)((()=>d&&e===le.g?b:d&&e===le.p?g:m),[d,e,b,g,m]);return o.a.createElement(s.EuiLink,{onClick:f,"data-test-subj":Y.N},t)},fe=({values:e,field:t,originalField:a})=>{const n=Object(i.useMemo)((()=>a===ue.b.sentinel_one),[a]),r=Object(i.useMemo)((()=>a===ue.b.crowdstrike),[a]),l=Object(i.useMemo)((()=>n?"sentinel_one":r?"crowdstrike":"endpoint"),[r,n]);return o.a.createElement(o.a.Fragment,null,null!=e&&e.map(((e,a)=>o.a.createElement(s.EuiFlexItem,{grow:!1,key:`${a}-${e}`,"data-test-subj":`${e}-${Y.L}`},t===le.g||t===le.p?o.a.createElement(ge,{field:t,value:e}):t===le.a?o.a.createElement(oe.a,{agentId:String(null!=e?e:""),agentType:l,"data-test-subj":Y.J}):o.a.createElement("span",{"data-test-subj":Y.K},e)))))};var he=a(366),ve=a(607);const ye=[{field:"field",name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableFieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":"fieldCell",width:"30%"},{field:"description",name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableValueColumnLabel",defaultMessage:"Value"}),"data-test-subj":"valueCell",width:"70%",render:e=>o.a.createElement(he.a,{field:e.field,value:e.values},o.a.createElement(fe,{values:e.values,field:e.field,originalField:e.originalField}))}],Ee=()=>{var e,t;const{dataFormattedForFieldBrowser:a,scopeId:n,isPreview:r}=Object(q.b)(),{ruleId:l}=Object(w.b)(a),{loading:c,rule:u}=Object(ie.a)(l),d=Object(ve.a)({dataFormattedForFieldBrowser:a,investigationFields:null!==(e=null==u||null===(t=u.investigation_fields)||void 0===t?void 0:t.field_names)&&void 0!==e?e:[]}),p=Object(i.useMemo)((()=>Object(re.b)(d,n,r)),[d,n,r]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.O},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.highlightedFieldsTitle",defaultMessage:"Highlighted fields"})))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.M},o.a.createElement(s.EuiPanel,{hasBorder:!0,hasShadow:!1},o.a.createElement(s.EuiInMemoryTable,{items:p,columns:ye,compressed:!0,loading:c,message:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.noDataDescription",defaultMessage:"There's no highlighted fields for this alert."})}))))};var xe=a(605);const je=()=>{const{openLeftPanel:e}=Object(c.a)(),{eventId:t,indexName:a,scopeId:n,dataFormattedForFieldBrowser:r,isPreview:l,isPreviewMode:u}=Object(q.b)(),{loading:d,error:p,basicAlertData:b,ruleNote:g}=Object(xe.a)({dataFormattedForFieldBrowser:r}),f=Object(i.useCallback)((()=>{e({id:j.c,path:{tab:J.c},params:{id:t,indexName:a,scopeId:n}})}),[t,a,e,n]),h=Object(i.useMemo)((()=>!p&&b&&b.ruleId&&g),[p,b,g]),v=Object(i.useMemo)((()=>l?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.previewTitle",defaultMessage:"Investigation guide"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.previewAriaLabel",{defaultMessage:"Investigation guide"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."})):d?o.a.createElement(s.EuiSkeletonText,{"data-test-subj":Y.T,contentAriaLabel:m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideLoadingAriaLabel",{defaultMessage:"investigation guide"})}):h&&u?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.openFlyoutTitle",defaultMessage:"Investigation guide available"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.openFlyoutAriaLabel",{defaultMessage:"Investigation guide available"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.openFlyoutMessage",defaultMessage:"Open alert details to access investigation guides."})):h?o.a.createElement(s.EuiButton,{onClick:f,iconType:"documentation",size:"s",fullWidth:!0,"data-test-subj":Y.S,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonAriaLabel",{defaultMessage:"Show investigation guide"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonLabel",defaultMessage:"Show investigation guide"})):o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataTitle",defaultMessage:"Investigation guide"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataAriaLabel",{defaultMessage:"Investigation guide"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataDescription",defaultMessage:"There's no investigation guide for this rule."}))),[d,l,u,f,h]);return o.a.createElement("div",{"data-test-subj":Y.U},v)};je.displayName="InvestigationGuideButton";const we="investigation",Se=Object(i.memo)((()=>{const{getFieldsData:e}=Object(q.b)(),t=Object(ee.a)(e("event.kind")),a=K({title:we,defaultValue:!0});return o.a.createElement(X.b,{expanded:a,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.sectionTitle",defaultMessage:"Investigation"}),localStorageKey:we,gutterSize:"none","data-test-subj":Y.V},t===te.a.signal&&o.a.createElement(o.a.Fragment,null,o.a.createElement(je,null),o.a.createElement(s.EuiSpacer,{size:"m"})),o.a.createElement(Ee,null))}));Se.displayName="InvestigationSection";var Oe=a(41),ke=a.n(Oe);const Ie={title:m.i18n.translate("xpack.securitySolution.flyout.right.about.description.rulePreviewTitle",{defaultMessage:"Preview rule details"}),backgroundColor:"warning",textColor:"warning"},Te=()=>{const{telemetry:e}=Object(G.j)().services,{dataFormattedForFieldBrowser:t,scopeId:a,eventId:n,indexName:r,isPreview:l}=Object(q.b)(),{isAlert:u,ruleDescription:p,ruleName:b,ruleId:g}=Object(w.b)(t),{openPreviewPanel:f}=Object(c.a)(),h=Object(i.useCallback)((()=>{f({id:j.f,params:{id:n,indexName:r,scopeId:a,banner:Ie,ruleId:g}}),e.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[n,f,r,a,g,e]),v=Object(i.useMemo)((()=>o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:h,iconSide:"right","data-test-subj":Y.gb,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonAriaLabel",{defaultMessage:"Show rule summary"}),disabled:Object(d.isEmpty)(b)||Object(d.isEmpty)(g)||l},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonLabel",defaultMessage:"Show rule summary"})))),[b,h,g,l]),y=(null==p?void 0:p.length)>0?p:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.noRuleDescription",defaultMessage:"There's no description for this rule."});return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.c},o.a.createElement(s.EuiTitle,{size:"xxs"},u?o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleTitle",defaultMessage:"Rule description"}))),v):o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.documentTitle",defaultMessage:"Document description"})))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.b},o.a.createElement(Ce,null,u?y:"-")))};Te.displayName="AlertDescription";var Ce=ke()("p").withConfig({displayName:"_StyledP",componentId:"sc-ewyemy-0"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;"]),Me=a(748);const Fe={title:m.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonPreviewTitle",{defaultMessage:"Preview alert reason"}),backgroundColor:"warning",textColor:"warning"},De=()=>{const{telemetry:e}=Object(G.j)().services,{eventId:t,indexName:a,scopeId:n,dataFormattedForFieldBrowser:r,getFieldsData:l}=Object(q.b)(),{isAlert:u}=Object(w.b)(r),d=Object(ee.a)(l(Me.m)),{openPreviewPanel:p}=Object(c.a)(),b=Object(i.useCallback)((()=>{p({id:j.a,params:{id:t,indexName:a,scopeId:n,banner:Fe}}),e.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[t,p,a,n,e]),g=Object(i.useMemo)((()=>o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:b,iconSide:"right","data-test-subj":Y.Z,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonButtonAriaLabel",{defaultMessage:"Show full reason"}),disabled:!d},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonButtonLabel",defaultMessage:"Show full reason"})))),[d,b]),f=d||o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.noReasonDescription",defaultMessage:"There's no source event information for this alert."});return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.bb},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,u?o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonTitle",defaultMessage:"Alert reason"}))),g):o.a.createElement("p",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.documentReasonTitle",defaultMessage:"Document reason"}))))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.ab},u?f:"-"))};De.displayName="Reason";var Pe=a(829);const Le=()=>{const{searchHit:e}=Object(q.b)(),t=Object(i.useMemo)((()=>Object(Pe.a)(e)),[e]);return t&&t[0]?o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.X},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,t[0].title))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.W},t[0].description)):null};Le.displayName="MitreAttack";var Ne=a(538);const Re=(e,t)=>{var a,n;if(!t||null==t)return!1;const r=null!==(a=null===(n=Ne.EcsFlat[e])||void 0===n?void 0:n.allowed_values)&&void 0!==a?a:[];return Boolean(null==r?void 0:r.find((e=>e.name===t)))},_e=(e,t)=>{var a,n,r,i;const o=null!==(a=null===(n=Ne.EcsFlat[e])||void 0===n?void 0:n.allowed_values)&&void 0!==a?a:[];return null!==(r=null==o||null===(i=o.find((e=>e.name===t)))||void 0===i?void 0:i.description)&&void 0!==r?r:m.i18n.translate("xpack.securitySolution.flyout.right.about.noEventKindDescriptionMessage",{defaultMessage:"This field doesn't have a description because it's not part of ECS."})},Ae={authentication:"user.name",configuration:"",database:"",driver:"",email:"",file:"file.name",host:"host.name",iam:"",intrusion_detection:"",malware:"",network:"",package:"",process:"process.name",registry:"",session:"",threat:"",vulnerability:"",web:""},ze=()=>{const{getFieldsData:e}=Object(q.b)(),t=Object(i.useMemo)((()=>Object(ee.b)(e("event.category"))),[e]);return o.a.createElement(o.a.Fragment,null,t.map((e=>o.a.createElement(s.EuiFlexItem,{"data-test-subj":`${Y.C}-${e}`,key:`event-category-${e}`},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,Object(d.startCase)(e))),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiText,{size:"s"},_e("event.category",e))))))};ze.displayName="EventCategoryDescription";const Be=({eventKind:e})=>{const{getFieldsData:t}=Object(q.b)(),a=Object(i.useMemo)((()=>Object(ee.b)(t("event.category"))),[t]);return o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.E},o.a.createElement(s.EuiTitle,{size:"xxs","data-test-subj":Y.F},o.a.createElement("h5",null,Object(d.startCase)(e))),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiText,{size:"s"},_e("event.kind",e)),a.length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{defaultMessage:"Event category",id:"xpack.securitySolution.flyout.right.eventCategoryText"}))),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"s","data-test-subj":Y.D},a.map(((e,t)=>o.a.createElement(s.EuiFlexItem,{grow:!1,key:`event-category-${e}`},o.a.createElement(s.EuiToolTip,{content:_e("event.category",e)},o.a.createElement(s.EuiText,{size:"s"},e,t!==a.length-1&&","))))))))};Be.displayName="EventKindDescription";var Ve=a(448),$e=a.n(Ve),qe=a(49),Ge=a(299),Ue=a(304);const He=$e.a.div`
  overflow-x: auto;
  padding-block: ${qe.euiThemeVars.euiSizeS};
`,We=$e.a.div``,Qe=()=>{const{dataAsNestedObject:e,scopeId:t}=Object(q.b)(),a=Object(i.useMemo)((()=>Object(Ge.a)({data:e,rowRenderers:Ue.b})),[e]),n=Object(i.useMemo)((()=>a?a.renderRow({contextId:"event-details",data:e,isDraggable:!1,scopeId:t}):null),[a,e,t]);return a?o.a.createElement(s.EuiFlexItem,{"data-test-subj":Y.G},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,"Event renderer")),o.a.createElement(He,null,o.a.createElement(We,{className:"eui-displayInlineBlock"},n))):null};Qe.displayName="EventRenderer";const Ke="about",Je=Object(i.memo)((()=>{const{getFieldsData:e}=Object(q.b)(),t=Object(ee.a)(e("event.kind")),a=t&&Re("event.kind",t),n=K({title:Ke,defaultValue:!0}),r=t===te.a.signal?o.a.createElement(o.a.Fragment,null,o.a.createElement(Te,null),o.a.createElement(De,null),o.a.createElement(Le,null)):o.a.createElement(o.a.Fragment,null,a&&("event"===t?o.a.createElement(ze,null):o.a.createElement(Be,{eventKind:t})),o.a.createElement(Qe,null));return o.a.createElement(X.b,{expanded:n,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.sectionTitle",defaultMessage:"About"}),localStorageKey:Ke,gutterSize:"s","data-test-subj":Y.a},r)}));Je.displayName="AboutSection";var Ye=a(813),Ze=a(202),Xe=a(616),et=a(609),tt=a(228);const at=({loading:e=!1,error:t=!1,icon:a,value:n,text:r,color:i,"data-test-subj":l})=>{const{euiTheme:c}=Object(s.useEuiTheme)(),u=`${l}Loading`;if(e)return o.a.createElement(s.EuiSkeletonText,{lines:1,size:"m",isLoading:e,contentAriaLabel:m.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryLoadingAriaLabel",{defaultMessage:"Loading insights for {value}",values:{value:n}}),"data-test-subj":u});if(t)return null;const d=`${l}Icon`,p=`${l}Value`,b=`${l}Color`;return o.a.createElement(s.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(nt,{"data-test-subj":d,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryButtonIconAriaLabel",{defaultMessage:"Insight summary row icon"}),color:"text",display:"empty",type:a,size:"m",$_css:c.size.s})),o.a.createElement(rt,{"data-test-subj":p},n&&o.a.createElement(tt.a,{count:n})," ",r),i&&o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":b},o.a.createElement(s.EuiHealth,{color:i})))};at.displayName="InsightsSummaryRow";var nt=ke()(s.EuiIcon)`
            margin: ${e=>e.$_css};
          `,rt=ke()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-uq3b7l-0"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;"]);const it=({entityId:e,scopeId:t})=>{const{loading:a,error:n,dataCount:r}=Object(et.a)({entityId:e,scopeId:t}),i=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sessionAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by session",values:{count:r}});return o.a.createElement(at,{loading:a,error:n,icon:"warning",value:r,text:i,"data-test-subj":Y.l,key:`correlation-row-${i}`})};it.displayName="RelatedAlertsBySession";var ot=a(615),st=a(610);const lt=({originalEventId:e,scopeId:t})=>{const{loading:a,dataCount:n}=Object(st.a)({originalEventId:e,scopeId:t}),r=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sourceAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by source event",values:{count:n}});return o.a.createElement(at,{loading:a,icon:"warning",value:n,text:r,"data-test-subj":Y.k,key:`correlation-row-${r}`})};lt.displayName="RelatedAlertsBySameSourceEvent";var ct=a(617);const ut=({documentId:e,indices:t,scopeId:a})=>{const{loading:n,error:r,dataCount:i}=Object(ct.a)({documentId:e,indices:t,scopeId:a}),s=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.ancestryAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by ancestry",values:{count:i}});return o.a.createElement(at,{loading:n,error:r,icon:"warning",value:i,text:s,"data-test-subj":Y.j,key:`correlation-row-${s}`})};ut.displayName="RelatedAlertsByAncestry";var dt=a(613),pt=a(165),mt=a(253);const bt=({alertSuppressionCount:e,ruleType:t})=>o.a.createElement(s.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(at,{loading:!1,error:!1,icon:"layers",value:e,text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.suppressedAlertsLabel",defaultMessage:"suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),"data-test-subj":Y.o,key:"correlation-row-suppressed-alerts"})),t&&Object(pt.l)(t)?null:o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiBetaBadge,{label:mt.w,size:"s",iconType:"beaker",tooltipContent:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.suppressedAlertTechnicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),tooltipPosition:"bottom","data-test-subj":Y.n})));bt.displayName="SuppressedAlerts";var gt=a(614),ft=a(611);const ht=({eventId:e})=>{const{loading:t,error:a,dataCount:n}=Object(ft.a)({eventId:e}),r=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.relatedCasesLabel",defaultMessage:"related {count, plural, one {case} other {cases}}",values:{count:n}});return o.a.createElement(at,{loading:t,error:a,icon:"warning",value:n,text:r,"data-test-subj":Y.m,key:`correlation-row-${r}`})};ht.displayName="RelatedCases";var vt=a(612),yt=a(623),Et=a(277),xt=a(131),jt=a(256),wt=a(170);const St=()=>{var e;const{dataAsNestedObject:t,eventId:a,indexName:n,getFieldsData:r,scopeId:l,isPreview:u,isPreviewMode:p}=Object(q.b)(),{openLeftPanel:m}=Object(c.a)(),{isTourShown:b,activeStep:g}=Object(jt.b)(),{selectedPatterns:f}=Object(Et.a)(Object(xt.isActiveTimeline)(l)),h=Object(i.useCallback)((()=>{m({id:j.c,path:{tab:J.b,subTab:yt.a},params:{id:a,indexName:n,scopeId:l}})}),[a,m,n,l]);Object(i.useEffect)((()=>{b(wt.b.alertsCases)&&g===wt.a.viewCase&&h()}),[g,h,b]);const{show:v,documentId:y}=Object(dt.a)({getFieldsData:r,dataAsNestedObject:t,eventId:a,isPreview:u}),{show:E,originalEventId:x}=Object(ot.a)({eventId:a,getFieldsData:r}),{show:w,entityId:S}=Object(Xe.a)({getFieldsData:r}),O=Object(vt.a)({getFieldsData:r}),{show:k,alertSuppressionCount:I}=Object(gt.a)({getFieldsData:r}),T=v||E||w||O||k,C=null===(e=Object(d.get)(t,Ye.o))||void 0===e?void 0:e[0],M=Object(i.useMemo)((()=>p?void 0:{callback:h,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTooltip",defaultMessage:"Show all correlations"})}),[p,h]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTitle",defaultMessage:"Correlations"}),link:M,iconType:p?void 0:"arrowStart"},"data-test-subj":Y.p},T?o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},k&&o.a.createElement(bt,{alertSuppressionCount:I,ruleType:C}),O&&o.a.createElement(ht,{eventId:a}),E&&o.a.createElement(lt,{originalEventId:x,scopeId:l}),w&&S&&o.a.createElement(it,{entityId:S,scopeId:l}),v&&o.a.createElement(ut,{documentId:y,indices:f,scopeId:l})):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};St.displayName="CorrelationsOverview";var Ot=a(628),kt=a(606);const It=()=>{const{eventId:e,indexName:t,dataFormattedForFieldBrowser:a,scopeId:n,investigationFields:r,isPreviewMode:l}=Object(q.b)(),{openLeftPanel:u}=Object(c.a)(),d=Object(i.useCallback)((()=>{u({id:j.c,path:{tab:J.b,subTab:kt.a},params:{id:e,indexName:t,scopeId:n}})}),[e,u,t,n]),{loading:p,error:m,data:b}=Object(Ot.a)({dataFormattedForFieldBrowser:a,investigationFields:r,interval:{from:"now-30d",to:"now"}}),g=Object(i.useMemo)((()=>b.filter((e=>isFinite(e.hostPrevalence)&&e.hostPrevalence>0&&e.hostPrevalence<.1))),[b]),f=Object(i.useMemo)((()=>l?void 0:{callback:d,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTooltip",defaultMessage:"Show all prevalence"})}),[d,l]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTitle",defaultMessage:"Prevalence"}),link:f,iconType:l?void 0:"arrowStart"},content:{loading:p,error:m},"data-test-subj":Y.Y},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},g.length>0?g.map((e=>o.a.createElement(at,{icon:"warning",text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.rowDescription",defaultMessage:"{field}, {value} is uncommon",values:{field:e.field,value:e.values.toString()}}),"data-test-subj":`${Y.Y}${e.field}`,key:`${Y.Y}${e.field}`}))):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})))};It.displayName="PrevalenceOverview";var Tt=a(336),Ct=a(441),Mt=a(195),Ft=a(633);const Dt=()=>{const{eventId:e,indexName:t,scopeId:a,dataFormattedForFieldBrowser:n,isPreviewMode:r}=Object(q.b)(),{openLeftPanel:l}=Object(c.a)(),u=Object(i.useCallback)((()=>{l({id:j.c,path:{tab:J.b,subTab:Ft.a},params:{id:e,indexName:t,scopeId:a}})}),[e,l,t,a]),{loading:p,threatMatchesCount:m,threatEnrichmentsCount:b}=(({dataFormattedForFieldBrowser:e})=>{const{isAlert:t}=Object(w.b)(e),a=Object(i.useMemo)((()=>Object(Tt.c)(e||[])),[e]),n=Object(i.useMemo)((()=>t?Object(Tt.g)(e||[]).map((e=>Object(Tt.h)(e))):[]),[e,t]),{result:r,loading:o}=Object(Ct.c)(a),s=Object(i.useMemo)((()=>o||null==r||!r.enrichments?n:Object(Tt.b)([...n,...r.enrichments])),[o,r,n]),{[Mt.c.IndicatorMatchRule]:l,[Mt.c.InvestigationTime]:c}=Object(d.groupBy)(s,"matched.type");return{loading:o,threatMatches:l,threatMatchesCount:(l||[]).length,threatEnrichments:c,threatEnrichmentsCount:(c||[]).length}})({dataFormattedForFieldBrowser:n}),g=Object(i.useMemo)((()=>r?void 0:{callback:u,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTooltip",defaultMessage:"Show all threat intelligence"})}),[r,u]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTitle",defaultMessage:"Threat intelligence"}),link:g,iconType:r?void 0:"arrowStart"},"data-test-subj":Y.R,content:{loading:p}},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none","data-test-subj":`${Y.R}Container`},o.a.createElement(at,{icon:"warning",value:m,text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatMatchDescription",defaultMessage:"threat {count, plural, one {match} other {matches}} detected",values:{count:m}}),"data-test-subj":Y.R}),o.a.createElement(at,{icon:"warning",value:b,text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatEnrichmentDescription",defaultMessage:"{count, plural, one {field} other {fields}} enriched with threat intelligence",values:{count:b}}),"data-test-subj":Y.R})))};Dt.displayName="ThreatIntelligenceOverview";const Pt=()=>{const{eventId:e,getFieldsData:t,indexName:a,scopeId:n,isPreviewMode:r}=Object(q.b)(),{openLeftPanel:l}=Object(c.a)(),u=Object(ee.a)(t("host.name")),d=Object(ee.a)(t("user.name")),p=Object(i.useCallback)((()=>{l({id:j.c,path:{tab:J.b,subTab:ce.a},params:{id:e,indexName:a,scopeId:n}})}),[e,l,a,n]),m=Object(i.useMemo)((()=>r?void 0:{callback:p,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTooltip",defaultMessage:"Show all entities"})}),[p,r]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTitle",defaultMessage:"Entities"}),link:m,iconType:r?void 0:"arrowStart"},"data-test-subj":Y.P},d||u?o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},d&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiFlexItem,null,o.a.createElement(be.b,{userName:d})),o.a.createElement(s.EuiSpacer,{size:"s"})),u&&o.a.createElement(s.EuiFlexItem,null,o.a.createElement(pe.b,{hostName:u}))):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."})))};Pt.displayName="EntitiesOverview";const Lt="insights",Nt=Object(i.memo)((()=>{const{getFieldsData:e}=Object(q.b)(),t=Object(ee.a)(e("event.kind")),{activeStep:a,isTourShown:n}=Object(jt.b)(),r=n(wt.b.alertsCases)&&a===wt.a.viewCase,i=K({title:Lt,defaultValue:!1})||r;return o.a.createElement(X.b,{expanded:i,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.sectionTitle",defaultMessage:"Insights"}),localStorageKey:Lt,"data-test-subj":Y.Q},o.a.createElement(Pt,null),t===te.a.signal&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(Dt,null)),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(St,null),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(It,null))}));Nt.displayName="InsightsSection";var Rt=a(45),_t=a(1403),At=a(187),zt=a(377),Bt=a(219),Vt=a(13),$t=a(541),qt=a(44);const Gt=(e,t,a,n,r)=>{const i=e.find((e=>e.id===t.parent));if(r===n&&i)return{id:"ancestor",label:"...",children:[a],isExpanded:!0};if(n<0||r<0||r>=n||!i)return a;const o={id:i.id,label:i.name,children:[a],isExpanded:!0};return Gt(e,i,o,n,r+1)},Ut=(e,t,a,n,r)=>{const i=e.filter((e=>e.parent===t.id));if(r===n&&i.length>0)return[{id:"descendant",label:"...",isExpanded:!1}];if(a<0||n<0||r<0||r>=n||!i||0===i.length)return;const o=[];return i.forEach(((t,i)=>{i<a&&o.push({id:t.id,label:t.name,children:Ut(e,t,a,n,r+1),isExpanded:!1}),i===a&&o.push({id:"more-child",label:"..."})})),o};var Ht=a(234),Wt=a(539);const Qt=()=>{var e,t;const[a,n]=Object(i.useState)({}),{dataFormattedForFieldBrowser:r,getFieldsData:l,scopeId:c,eventId:u,isPreview:d}=Object(q.b)(),p=null!==(e=Object(ee.a)(l(Ht.a)))&&void 0!==e?e:"",b=d?p:u,{selectedPatterns:g}=Object(Et.a)(Object(xt.isActiveTimeline)(c)),f=Object(qt.find)({category:"kibana",field:Ht.e},r),h=null!==(t=null==f?void 0:f.values)&&void 0!==t?t:g,{statsNodes:v,loading:y,error:E}=Object(Wt.a)({isActiveTimeline:Object(xt.isActiveTimeline)(c),documentId:b,indices:h});Object(i.useEffect)((()=>{v&&0!==v.length&&n({statsNodes:v})}),[v,n]);const x=Object(i.useMemo)((()=>{var e;return((e,t=3,a=3,n=3)=>{if(0===e.length)return[];const r=e[0],i={id:r.id,label:o.a.createElement("b",{},r.name),children:Ut(e,r,t,n,0),isExpanded:!0,icon:o.a.createElement(s.EuiToken,{iconType:"tokenConstant"})};return[Gt(e,r,i,a,0)]})(null!==(e=a.statsNodes)&&void 0!==e?e:[],3,3,3)}),[a.statsNodes]),j=x&&x.length>0&&!E;return y?o.a.createElement(s.EuiSkeletonText,{"data-test-subj":Y.e,contentAriaLabel:m.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.loadingAriaLabel",{defaultMessage:"analyzer preview"})}):j?o.a.createElement(s.EuiTreeView,{items:x,display:"compressed","aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.treeViewAriaLabel",{defaultMessage:"Analyzer preview"}),showExpansionArrows:!0,"data-test-subj":Y.f}):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.errorDescription",defaultMessage:"An error is preventing this alert from being analyzed."})};Qt.displayName="AnalyzerPreview";const Kt="timeline-1",Jt=()=>{const{dataAsNestedObject:e,isPreview:t}=Object(q.b)(),a=Object($t.a)(e),n=Object(Rt.useDispatch)(),{startTransaction:r}=Object(At.b)(),{investigateInTimelineAlertClick:l}=Object(zt.a)({ecsRowData:e}),c=Object(i.useCallback)((async()=>{await l(),r({name:Bt.a.OPEN_ANALYZER});const t=Object(xt.getScopedActions)(Kt);t&&e&&n(t.updateGraphEventId({id:Kt,graphEventId:e._id})),n(Object(Vt.setActiveTabTimeline)({id:Kt,activeTab:_t.a.graph}))}),[e,n,l,r]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTitle",defaultMessage:"Analyzer preview"}),iconType:"timeline",...a&&!t&&{link:{callback:c,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTooltip",defaultMessage:"Investigate in timeline"})}}},"data-test-subj":Y.f},a?o.a.createElement(Qt,null):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataDescription",defaultMessage:"You can only visualize events triggered by hosts configured with the Elastic Defend integration or any {sysmon} data from {winlogbeat}. Refer to {link} for more information.",values:{sysmon:o.a.createElement(s.EuiMark,null,"sysmon"),winlogbeat:o.a.createElement(s.EuiMark,null,"winlogbeat"),link:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/visual-event-analyzer.html",target:"_blank"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataLinkText",defaultMessage:"Visual event analyzer"}))}}))};Jt.displayName="AnalyzerPreviewContainer";var Yt=a(152),Zt=a(16),Xt=a(81),ea=a(58),ta=a(194),aa=a(198);const na=({ruleId:e})=>{const t=Object(ta.m)();if(!e)return null;const a=Object(ta.h)(e);let n=t({deepLinkId:Xt.a.rules,path:a});const r=new URLSearchParams(n).get(aa.a.timeline);if(r){const e=Object(ea.safeDecode)(r);if(e&&e.isOpen){const t=Object(ea.encode)({...e,isOpen:!1});n=n.replace(r,t)}}return n};var ra=a(151);const ia=e=>{const t=Object(ee.a)(e("process.entry_leader.user.name")),a=Object(ee.a)(e("process.entry_leader.user.id"));return t||(a?"0"===a?"root":`uid: ${a}`:"unknown")},oa=({text:e,children:t})=>o.a.createElement(o.a.Fragment,null,e&&o.a.createElement(o.a.Fragment,null," ",o.a.createElement("span",null,e)," "),t),sa=()=>{const{isPreview:e}=Object(q.b)(),{processName:t,userName:a,startAt:n,ruleName:r,ruleId:l,workdir:c,command:u}=(()=>{const{getFieldsData:e}=Object(q.b)();return Object(i.useMemo)((()=>({userName:ia(e),processName:Object(ee.a)(e("process.entry_leader.name")),startAt:Object(ee.a)(e("process.entry_leader.start")),ruleName:Object(ee.a)(e(Me.r)),ruleId:Object(ee.a)(e(Me.y)),workdir:Object(ee.a)(e("process.group_leader.working_directory")),command:Object(ee.a)(e("process.command_line"))})),[e])})(),{euiTheme:d}=Object(s.useEuiTheme)(),p=Object(i.useMemo)((()=>({fontWeight:d.font.weight.bold})),[d.font.weight.bold]),m=Object(i.useMemo)((()=>t&&o.a.createElement(oa,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.processDescription",defaultMessage:"started"})},o.a.createElement("span",{style:p},t))),[p,t]),b=Object(i.useMemo)((()=>n&&o.a.createElement(oa,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.timeDescription",defaultMessage:"at"})},o.a.createElement("span",null,o.a.createElement(ra.c,{value:new Date(n)})))),[n]),g=na({ruleId:e?null:l}),f=Object(i.useMemo)((()=>r&&l&&o.a.createElement(oa,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.ruleDescription",defaultMessage:"with rule"})},g?o.a.createElement(s.EuiLink,{href:g,target:"_blank","data-test-subj":Y.hb},r):o.a.createElement(oa,null,r))),[r,l,g]),h=Object(i.useMemo)((()=>u&&o.a.createElement(oa,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.commandDescription",defaultMessage:"by"})},o.a.createElement(s.EuiCode,null,c," ",u))),[u,c]);return o.a.createElement(la,{"data-test-subj":Y.ib},o.a.createElement(oa,null,o.a.createElement(s.EuiIcon,{type:"user"})," ",o.a.createElement("span",{style:p},a)),m,b,f,h)};var la=ke()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-16jqh3v-0"})(["line-height:1.5;"]);const ca="timeline-1",ua=()=>{const{dataAsNestedObject:e,getFieldsData:t,isPreview:a,dataFormattedForFieldBrowser:n}=Object(q.b)(),r=(({getFieldsData:e,dataFormattedForFieldBrowser:t})=>{const{indexName:a,alertId:n}=Object(w.b)(t),r=Object(ee.a)(e("kibana.alert.ancestors.index"))||a,i=Object(ee.a)(e("process.entry_leader.entity_id")),o=Object(ee.a)(e("process.entry_leader.start")),s=Object(ee.a)(e("process.entity_id")),l=Object(ee.a)(e("kibana.alert.original_time"))||Object(ee.a)(e("timestamp"));return r&&i&&o?{index:r,sessionEntityId:i,sessionStartTime:o,...s&&{jumpToEntityId:s},...l&&{jumpToCursor:l},...n&&{investigatedAlertId:n}}:null})({getFieldsData:t,dataFormattedForFieldBrowser:n}),l=Object(Zt.b)().isEnterprise(),c=r&&l,u=Object(Rt.useDispatch)(),{startTransaction:d}=Object(At.b)(),p=Object(xt.getScopedActions)(ca),{investigateInTimelineAlertClick:m}=Object(zt.a)({ecsRowData:e}),b=Object(i.useCallback)((async()=>{await m(),d({name:Bt.a.OPEN_SESSION_VIEW}),null!==r&&(u(Object(Vt.setActiveTabTimeline)({id:ca,activeTab:_t.a.session})),p&&u(p.updateSessionViewConfig({id:ca,sessionViewConfig:r})))}),[u,m,p,r,d]),{euiTheme:g}=Object(s.useEuiTheme)(),f=l?r?null:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataDescription",defaultMessage:"You can only view Linux session details if you’ve enabled the {setting} setting in your Elastic Defend integration policy. Refer to {link} for more information.",values:{setting:o.a.createElement(da,{$_css:g.font.weight.bold},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataSettingDescription",defaultMessage:"Include session data"})),link:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/session-view.html#enable-session-view",target:"_blank"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataLinkText",defaultMessage:"Enable Session View data"}))}}):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellDescription",defaultMessage:"This feature requires an {subscription}",values:{subscription:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellLinkText",defaultMessage:"Enterprise subscription"}))}});return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTitle",defaultMessage:"Session viewer preview"}),iconType:"timeline",...c&&!a&&{link:{callback:b,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTooltip",defaultMessage:"Investigate in timeline"})}}},"data-test-subj":Y.ib},c?o.a.createElement(sa,null):f)};var da=ke()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-4u5d2b-0"})(["font-weight:",";"],(e=>e.$_css));const pa="visualizations",ma=Object(i.memo)((()=>{const e=K({title:pa,defaultValue:!1});return o.a.createElement(X.b,{expanded:e,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sectionTitle",defaultMessage:"Visualizations"}),localStorageKey:pa,"data-test-subj":Y.lb},o.a.createElement(ua,null),o.a.createElement(s.EuiSpacer,null),o.a.createElement(Jt,null))}));ma.displayName="VisualizationsSection";const ba=Object(i.memo)((()=>o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"none","aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.overview.overviewContentAriaLabel",{defaultMessage:"Overview"})},o.a.createElement(Je,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(Se,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(ma,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(Nt,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(ne,null))));ba.displayName="OverviewTab";var ga=a(1402);const fa={id:"overview","data-test-subj":W.d,name:o.a.createElement("div",{"data-test-subj":W.c},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.overviewTabLabel",defaultMessage:"Overview"})),content:o.a.createElement(ba,null)},ha={id:"table","data-test-subj":W.e,name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.tableTabLabel",defaultMessage:"Table"}),content:o.a.createElement(ga.a,null)},va={id:"json","data-test-subj":W.b,name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.jsonTabLabel",defaultMessage:"JSON"}),content:o.a.createElement(Q.a,null)},ya=[fa,ha,va],Ea=[ha,va],xa=({flyoutIsExpandable:e,path:t})=>{const{storage:a}=Object(G.j)().services,n=Object(i.useMemo)((()=>e?ya:Ea),[e]),r=Object(i.useMemo)((()=>{if(t){const e=n.map((e=>e.id)).find((e=>e===t.tab));if(e)return e}const e=a.get(U.a.RIGHT_PANEL_SELECTED_TABS);return e&&n.map((e=>e.id)).includes(e)?e:n[0].id}),[t,a,n]);return{tabsDisplayed:n,selectedTabId:r}};var ja=a(1737),wa=a(1210),Sa=a(1866),Oa=a(533),ka=a(965),Ia=a(197),Ta=a(960);const Ca=()=>({promptContextId:void 0}),Ma=Object(i.memo)((()=>{const{dataFormattedForFieldBrowser:e,eventId:t,indexName:a}=Object(q.b)(),{isAlert:n,timestamp:r}=Object(w.b)(e),l=Object(wa.a)({_id:t,_index:a,timestamp:r}),c=n&&l,{showAssistant:u,promptContextId:d}=(({dataFormattedForFieldBrowser:e,isAlert:t})=>{const{hasAssistantPrivilege:a,isAssistantEnabled:n}=Object(Oa.a)(),r=a?Sa.a:Ca,o=Object(i.useCallback)((async()=>Object(ka.d)(null!=e?e:[])),[e]),{promptContextId:s}=r(t?"alert":"event",t?Ia.e:Ia.i,t?Object(Ia.d)(Ia.A):Object(Ia.h)(Ia.A),o,null,t?Ta.b[Ta.c].suggestedUserPrompt:Ta.b[Ta.e].suggestedUserPrompt,t?Ia.f:Ia.j,n);return{showAssistant:a&&null!==s,promptContextId:s||""}})({dataFormattedForFieldBrowser:e,isAlert:n});return o.a.createElement(s.EuiFlexGroup,{direction:"row",justifyContent:"flexEnd",alignItems:"center",gutterSize:"none",responsive:!1},u&&o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(ja.a,{conversationTitle:n?Ia.e:Ia.i,promptContextId:d,iconOnly:!0})),c&&o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiToolTip,{content:m.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonToolTip",{defaultMessage:"Share alert"})},o.a.createElement(s.EuiCopy,{textToCopy:l},(e=>o.a.createElement(s.EuiButtonIcon,{iconType:"share",color:"text","aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonAriaLabel",{defaultMessage:"Share alert"}),"data-test-subj":Y.jb,onClick:e,onKeyDown:e}))))))}));Ma.displayName="HeaderActions";var Fa=a(1350);const Da=Object(i.memo)((({flyoutIsExpandable:e})=>{const{telemetry:t}=Object(G.j)().services,{openLeftPanel:a}=Object(c.a)(),{eventId:n,indexName:r,scopeId:s}=Object(q.b)(),l=Object(i.useCallback)((()=>{a({id:j.c,params:{id:n,indexName:r,scopeId:s}}),t.reportDetailsFlyoutOpened({location:s,panel:"left"})}),[n,a,r,s,t]);return o.a.createElement(Fa.a,{flyoutIsExpandable:e,expandDetails:l,actions:o.a.createElement(Ma,null)})}));Da.displayName="PanelNavigation";const Pa=Object(i.memo)((({children:e,...t})=>o.a.createElement(La,r()({size:"l",expand:!0},t),e)));Pa.displayName="FlyoutHeaderTabs";var La=ke()(s.EuiTabs).withConfig({displayName:"_StyledEuiTabs",componentId:"sc-146ys67-0"})(["margin-bottom:-17px;"]),Na=a(130),Ra=a(831),_a=a(284);const Aa=()=>{const{closeFlyout:e}=Object(c.a)(),{eventId:t,browserFields:a,dataFormattedForFieldBrowser:n,scopeId:r,isPreview:l}=Object(q.b)(),u=Object(i.useMemo)((()=>{const e=Object(qt.find)({field:le.o,category:"kibana"},n);return e&&Object(_a.b)({eventId:t,contextId:r,scopeId:r,browserFields:a,item:e})}),[a,n,t,r]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"xs",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiTitle,{size:"xxs","data-test-subj":Y.kb},o.a.createElement("h3",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.statusTitle",defaultMessage:"Status"})))),o.a.createElement(s.EuiFlexItem,{grow:!1},u&&(d=u)&&Array.isArray(d.values)&&!l?o.a.createElement(he.a,{field:le.o,value:u.values[0]},o.a.createElement(Ra.a,{eventId:t,contextId:r,enrichedFieldInfo:u,scopeId:r,handleOnEventClosed:e})):Object(Na.d)()));var d};Aa.displayName="DocumentStatus";var za=a(298);const Ba=e=>"low"===e||"medium"===e||"high"===e||"critical"===e,Va=Object(i.memo)((()=>{const{getFieldsData:e}=Object(q.b)(),t=e(Ye.s);if(!t)return null;let a;if("string"==typeof t&&Ba(t))a=t;else{if(!(Array.isArray(t)&&t.length>0&&Ba(t[0])))return null;a=t[0]}return o.a.createElement(he.a,{field:Ye.s,value:a},o.a.createElement(za.a,{value:a}))}));Va.displayName="DocumentSeverity";const $a=Object(i.memo)((()=>{const{getFieldsData:e}=Object(q.b)(),t=e(Ye.a);if(!t)return null;let a;if("string"==typeof t)a=t;else{if(!(Array.isArray(t)&&t.length>0))return null;a=t[0]}return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"xs",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiTitle,{size:"xxs","data-test-subj":Y.eb},o.a.createElement("h3",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.riskScoreTitle",defaultMessage:"Risk score"})))),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":Y.fb},a)))}));$a.displayName="RiskScore";var qa=a(775),Ga=a(1101),Ua=a(926);const Ha=Object(i.memo)((()=>{const{dataFormattedForFieldBrowser:e,eventId:t,scopeId:a,isPreview:n,refetchFlyoutData:r,getFieldsData:l}=Object(q.b)(),{isAlert:c,ruleName:u,timestamp:d,ruleId:p}=Object(w.b)(e),{euiTheme:b}=Object(s.useEuiTheme)(),g=na({ruleId:n?null:p}),f=Object(i.useMemo)((()=>g?o.a.createElement(s.EuiLink,{href:g,target:"_blank",external:!1},o.a.createElement(Ua.a,{title:u,iconType:"warning",isLink:!0,"data-test-subj":Y.H})):o.a.createElement(Ua.a,{title:u,iconType:"warning","data-test-subj":Y.H})),[u,g]),{refetch:h}=Object(qa.a)({scopeId:a}),v=Object(i.useMemo)((()=>{var e;return null!==(e=l(Me.F))&&void 0!==e?e:[]}),[l]),y=Object(i.useCallback)((()=>{h(),r()}),[h,r]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Va,null),o.a.createElement(s.EuiSpacer,{size:"m"}),d&&o.a.createElement(ra.c,{value:new Date(d)}),o.a.createElement(s.EuiSpacer,{size:"xs"}),c&&u?f:o.a.createElement(Ua.a,{title:m.i18n.translate("xpack.securitySolution.flyout.right.header.headerTitle",{defaultMessage:"Document details"}),iconType:"warning","data-test-subj":Y.H}),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(Wa,{hasShadow:!1,hasBorder:!0,"data-test-subj":Y.d,$_css:b.size.m,$_css2:b.size.s},o.a.createElement(s.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1},o.a.createElement(Qa,{$_css3:b.border.thin},o.a.createElement(Aa,null)),o.a.createElement(Ka,{$_css4:b.border.thin},o.a.createElement($a,null)),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(Ga.a,{eventId:t,assignedUserIds:v,onAssigneesUpdated:y,isPreview:n})))))}));Ha.displayName="AlertHeaderTitle";var Wa=ke()(s.EuiPanel)`
          padding: ${e=>e.$_css} ${e=>e.$_css2};
        `,Qa=ke()(s.EuiFlexItem)`
              border-right: ${e=>e.$_css3};
            `,Ka=ke()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem2",componentId:"sc-529dfp-0"})(["border-right:",";"],(e=>e.$_css4));const Ja=Object(i.memo)((()=>{const{dataFormattedForFieldBrowser:e,getFieldsData:t}=Object(q.b)(),{timestamp:a}=Object(w.b)(e),n=Object(ee.a)(t("event.kind")),r=Object(ee.a)(t("event.category")),l=Object(i.useMemo)((()=>{const e=m.i18n.translate("xpack.securitySolution.flyout.right.title.eventTitle",{defaultMessage:"Event details"});if("event"===n&&r){var a;const n=Ae[r];return null!==(a=Object(ee.a)(t(n)))&&void 0!==a?a:e}return"alert"===n?m.i18n.translate("xpack.securitySolution.flyout.right.title.alertEventTitle",{defaultMessage:"External alert details"}):n?m.i18n.translate("xpack.securitySolution.flyout.right.title.otherEventTitle",{defaultMessage:"{eventKind} details",values:{eventKind:Object(d.startCase)(n)}}):e}),[n,t,r]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Va,null),o.a.createElement(s.EuiSpacer,{size:"m"}),a&&o.a.createElement(ra.c,{value:new Date(a)}),o.a.createElement(s.EuiSpacer,{size:"xs"}),o.a.createElement(Ua.a,{title:l,iconType:"analyzeEvent","data-test-subj":Y.I}))}));Ja.displayName="EventHeaderTitle";var Ya=a(305);const Za=Object(i.memo)((({selectedTabId:e,setSelectedTabId:t,tabs:a,...n})=>{const{dataFormattedForFieldBrowser:l}=Object(q.b)(),{isAlert:c}=Object(w.b)(l),u=e=>t(e),d=Object(i.useMemo)((()=>c?{"tour-step":Object(wt.c)(wt.a.reviewAlertDetailsFlyout,wt.b.alertsCases)}:{}),[c]),p=a.map(((t,a)=>c&&"overview"===t.id?o.a.createElement(Ya.a,{isTourAnchor:c,step:wt.a.reviewAlertDetailsFlyout,tourId:wt.b.alertsCases},o.a.createElement(s.EuiTab,r()({onClick:()=>u(t.id),isSelected:t.id===e,key:a,"data-test-subj":t["data-test-subj"]},d),t.name)):o.a.createElement(s.EuiTab,{onClick:()=>u(t.id),isSelected:t.id===e,key:a,"data-test-subj":t["data-test-subj"]},t.name)));return o.a.createElement(z.a,n,c?o.a.createElement(Ha,null):o.a.createElement(Ja,null),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(Pa,null,p))}));Za.displayName="PanelHeader";const Xa=({selectedTabId:e,tabs:t})=>{const a=Object(i.useMemo)((()=>{var a;return null===(a=t.find((t=>t.id===e)))||void 0===a?void 0:a.content}),[e,t]);return o.a.createElement(D.a,{"data-test-subj":W.a},a)};Xa.displayName="PanelContent";var en=a(384),tn=a(285),an=a(631),nn=a(436),rn=a(295);const on=Object(i.memo)((()=>{const{useIsAddToCaseOpen:e}=Object(G.j)().services.cases.hooks,t=e(),{isTourShown:a}=Object(rn.b)(),{openLeftPanel:n,openRightPanel:r}=Object(c.a)(),{eventId:s,indexName:l,scopeId:u,isPreview:d,getFieldsData:p}=Object(q.b)(),m=Object(ee.a)(p("event.kind"))===te.a.signal,b=Object(en.a)()===tn.a.timeline,g=m&&!d&&!b&&!a(wt.b.alertsCases)&&!t,f=Object(i.useCallback)((()=>{n({id:j.c,params:{id:s,indexName:l,scopeId:u}})}),[s,l,u,n]),h=Object(i.useCallback)((()=>{r({id:j.e,path:{tab:"overview"},params:{id:s,indexName:l,scopeId:u}})}),[s,l,u,r]),v=Object(i.useMemo)((()=>[...Object(nn.b)(),...Object(nn.a)()]),[]);return g?o.a.createElement(an.a,{tourStepContent:v,totalSteps:5,goToOverviewTab:h,goToLeftPanel:f}):null}));on.displayName="RightPanelTour";var sn=a(1247);const ln=ke()("div").withConfig({displayName:"ContainerDiv",componentId:"sc-vi2r7u-0"})([".side-panel-flyout-footer{padding:",";}"],qe.euiThemeVars.euiPanelPaddingModifiers.paddingMedium),cn=({isPreview:e})=>{const{closeFlyout:t,openRightPanel:a}=Object(c.a)(),{eventId:n,indexName:r,dataFormattedForFieldBrowser:s,dataAsNestedObject:l,refetchFlyoutData:u,scopeId:d}=Object(q.b)(),{isHostIsolationPanelOpen:p,showHostIsolationPanel:m}=Object(O.a)(),b=Object(i.useCallback)((e=>{m(e),a({id:j.b,params:{id:n,indexName:r,scopeId:d,isolateAction:e}})}),[n,r,a,d,m]);return e?null:o.a.createElement(ln,null,o.a.createElement(sn.b,{detailsData:s,detailsEcsData:l,handleOnEventClosed:t,isHostIsolationPanelOpen:p,isReadOnly:!1,loadingEventDetails:!1,onAddIsolationStatusClick:b,scopeId:d,refetchFlyoutData:u}))},un=({getFieldsData:e,dataAsNestedObject:t})=>{const a=Object(Ge.a)({data:t,rowRenderers:Ue.b}),n=Object(ee.a)(e("event.kind")),r=n&&Re("event.kind",n),o=Object(ee.b)(e("event.category")).some((e=>Re("event.category",e)));return Object(i.useMemo)((()=>n===te.a.signal||(n===te.a.event?o||null!=a:r||null!=a)),[n,o,r,a])},dn=Object(i.memo)((({path:e})=>{const{storage:t,telemetry:a}=Object(G.j)().services,{openRightPanel:n,closeFlyout:r}=Object(c.a)(),{eventId:s,indexName:l,scopeId:u,isPreview:d,dataAsNestedObject:p,getFieldsData:m}=Object(q.b)(),b=un({getFieldsData:m,dataAsNestedObject:p}),{tabsDisplayed:g,selectedTabId:f}=xa({flyoutIsExpandable:b,path:e});return Object(i.useEffect)((()=>{const e=()=>{d&&r()};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[d,r]),o.a.createElement(o.a.Fragment,null,b&&o.a.createElement(on,null),o.a.createElement(Da,{flyoutIsExpandable:b}),o.a.createElement(Za,{tabs:g,selectedTabId:f,setSelectedTabId:e=>{n({id:j.e,path:{tab:e},params:{id:s,indexName:l,scopeId:u}}),t.set(U.a.RIGHT_PANEL_SELECTED_TABS,e),a.reportDetailsFlyoutTabClicked({location:u,panel:"right",tabId:e})}}),o.a.createElement(Xa,{tabs:g,selectedTabId:f}),o.a.createElement(cn,{isPreview:d}))}));dn.displayName="RightPanel";var pn=a(927);const mn=`${_.a}PreviewFooter`,bn=`${mn}Link`,gn=()=>{const{eventId:e,indexName:t,scopeId:a}=Object(q.b)(),{openFlyout:n}=Object(c.a)(),{telemetry:r}=Object(G.j)().services,l=Object(i.useCallback)((()=>{n({right:{id:j.e,params:{id:e,indexName:t,scopeId:a}}}),r.reportDetailsFlyoutOpened({location:a,panel:"right"})}),[n,e,t,a,r]);return o.a.createElement(pn.a,{"data-test-subj":mn},o.a.createElement(s.EuiFlexGroup,{justifyContent:"center"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiLink,{onClick:l,target:"_blank","data-test-subj":bn},m.i18n.translate("xpack.securitySolution.flyout.preview.openFlyoutLabel",{defaultMessage:"Show full alert details"})))))};var fn=a(1395);const hn=Object(i.memo)((({path:e})=>{const{openPreviewPanel:t}=Object(c.a)(),{eventId:a,indexName:n,scopeId:r,getFieldsData:i,dataAsNestedObject:s}=Object(q.b)(),l=un({getFieldsData:i,dataAsNestedObject:s}),{tabsDisplayed:u,selectedTabId:d}=xa({flyoutIsExpandable:l,path:e});return o.a.createElement(o.a.Fragment,null,o.a.createElement(Za,{tabs:u,selectedTabId:d,setSelectedTabId:e=>{t({id:j.d,path:{tab:e},params:{id:a,indexName:n,scopeId:r,isPreviewMode:!0,banner:fn.a}})},style:{marginTop:"-15px"}}),o.a.createElement(Xa,{tabs:u,selectedTabId:d}),o.a.createElement(gn,null))}));hn.displayName="PreviewPanel";const vn=`${_.a}AlertReasonBody`,yn=Object(i.createContext)(void 0),En=Object(i.memo)((({id:e,indexName:t,scopeId:a,children:n})=>{const{dataAsNestedObject:r,loading:s}=Object(k.a)({eventId:e,indexName:t}),l=Object(i.useMemo)((()=>e&&t&&a&&r?{eventId:e,indexName:t,scopeId:a,dataAsNestedObject:r}:void 0),[e,t,a,r]);return s?o.a.createElement(T.a,null):l?o.a.createElement(yn.Provider,{value:l},n):o.a.createElement(I.a,null)}));En.displayName="AlertReasonPanelProvider";const xn=$e.a.div`
  overflow-x: auto;
  padding-block: ${qe.euiThemeVars.euiSizeS};
`,jn=$e.a.div``,wn=()=>{const{dataAsNestedObject:e,scopeId:t}=(()=>{const e=Object(i.useContext)(yn);if(!e)throw new Error("AlertReasonPanelContext can only be used within AlertReasonPanelContext provider");return e})(),a=Object(i.useMemo)((()=>Object(Ge.a)({data:e,rowRenderers:Ue.b})),[e]),n=Object(i.useMemo)((()=>a?a.renderRow({contextId:"event-details",data:e,isDraggable:!1,scopeId:t}):null),[a,e,t]);return a?o.a.createElement(s.EuiPanel,{hasShadow:!1,"data-test-subj":vn},o.a.createElement(s.EuiTitle,null,o.a.createElement("h6",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.alertReason.panelTitle",defaultMessage:"Alert reason"}))),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(xn,null,o.a.createElement(jn,{className:"eui-displayInlineBlock"},n))):o.a.createElement(s.EuiPanel,{hasShadow:!1,hasBorder:!1},o.a.createElement(I.a,null))};wn.displayName="AlertReason";const Sn=Object(i.memo)((()=>o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceBetween",direction:"column",gutterSize:"none",style:{height:"100%"}},o.a.createElement(s.EuiFlexItem,{style:{marginTop:"-15px"}},o.a.createElement(wn,null)))));Sn.displayName="AlertReasonPanel";const On=Object(i.createContext)(void 0),kn=Object(i.memo)((({ruleId:e,children:t})=>{const a=Object(i.useMemo)((()=>e?{ruleId:e}:void 0),[e]);return a?o.a.createElement(On.Provider,{value:a},t):o.a.createElement(I.a,null)}));kn.displayName="RuleOverviewPanelProvider";const In=()=>{const e=Object(i.useContext)(On);if(!e)throw new Error("RuleOverviewPanelContext can only be used within RuleOverviewPanelContext provider");return e};var Tn=a(303),Cn=a(733),Mn=a(1208);const Fn=`${_.a}RuleOverview`,Dn=`${Fn}RuleOverviewTitle`,Pn=`${Dn}Suppressed`,Ln=`${Fn}CreatedByText`,Nn=`${Fn}UpdatedByText`,Rn=`${Fn}Body`,_n=`${Fn}AboutSection`,An=(X.c,X.a,`${Fn}DefinitionSection`),zn=(X.c,X.a,`${Fn}ScheduleSection`),Bn=(X.c,X.a,`${Fn}ActionsSection`),Vn=(X.c,X.a,`${Fn}Loading`),$n=`${Fn}Footer`,qn=`${$n}LinkToRuleDetails`,Gn=({rule:e,isSuppressed:t})=>o.a.createElement("div",{"data-test-subj":Dn},o.a.createElement(s.EuiTitle,null,o.a.createElement("h6",null,e.name)),t&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiBadge,{"data-test-subj":Pn,title:""},Cn.a)),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiFlexGroup,{gutterSize:"xs",direction:"column"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":Ln},o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement(Mn.a,{createdBy:null==e?void 0:e.created_by,createdAt:null==e?void 0:e.created_at}))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":Nn},o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement(Mn.b,{updatedBy:null==e?void 0:e.updated_by,updatedAt:null==e?void 0:e.updated_at})))));Gn.displayName="RuleTitle";var Un=a(943),Hn=a(947),Wn=a(968),Qn=a(564);const Kn=Yt.css`
  dt {
    font-size: 90% !important;
  }
  text-overflow: ellipsis;
  .euiFlexGroup {
    flex-wrap: inherit;
  }

  .euiFlexItem {
    inline-size: inherit;
    flex-basis: inherit;
  }
`,Jn=Object(i.memo)((()=>{var e,t;const{ruleId:a}=In(),[n,r]=Object(i.useState)(null),{rule:l,loading:c,isExistingRule:u}=Object(ie.a)(null!=a?a:"");Object(i.useEffect)((()=>{null!=l&&r(l)}),[l]);const{ruleActionsData:d}=null!=n?Object(Tn.h)({rule:n,detailsView:!0}):{ruleActionsData:null},p=Boolean(null==d||null===(e=d.actions)||void 0===e?void 0:e.length),m=Boolean(null==d||null===(t=d.responseActions)||void 0===t?void 0:t.length),b=null!=d&&(p||m);return c?o.a.createElement(T.a,{"data-test-subj":Vn}):n?o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,"data-test-subj":Rn},o.a.createElement(Gn,{rule:n,isSuppressed:!u}),o.a.createElement(s.EuiHorizontalRule,{margin:"s"}),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.aboutLabel",defaultMessage:"About"}),expanded:!0,"data-test-subj":_n},o.a.createElement(s.EuiText,{size:"s"},n.description),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(Un.b,{rule:n,hideName:!0,hideDescription:!0,type:"row",rowGutterSize:"s",className:Kn})),o.a.createElement(s.EuiHorizontalRule,{margin:"l"}),o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.definitionLabel",defaultMessage:"Definition"}),expanded:!1,"data-test-subj":An},o.a.createElement(Wn.a,{rule:n,type:"row",rowGutterSize:"s",className:Kn})),o.a.createElement(s.EuiHorizontalRule,{margin:"l"}),o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.scheduleLabel",defaultMessage:"Schedule"}),expanded:!1,"data-test-subj":zn},o.a.createElement(Hn.a,{rule:n,type:"row",rowGutterSize:"s",className:Kn})),o.a.createElement(s.EuiHorizontalRule,{margin:"l"}),b&&o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.actionsLabel",defaultMessage:"Actions"}),expanded:!1,"data-test-subj":Bn},o.a.createElement(Qn.b,{addPadding:!1,defaultValues:d}))):o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1},o.a.createElement(I.a,null))}));Jn.displayName="RuleOverview";const Yn=Object(i.memo)((()=>{const{ruleId:e}=In(),t=na({ruleId:e});return t?o.a.createElement(pn.a,{"data-test-subj":$n},o.a.createElement(s.EuiFlexGroup,{justifyContent:"center"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiLink,{href:t,target:"_blank","data-test-subj":qn},m.i18n.translate("xpack.securitySolution.flyout.preview.rule.viewDetailsLabel",{defaultMessage:"Show full rule details"}))))):null}));Yn.displayName="RuleFooter";const Zn=Object(i.memo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(D.a,null,o.a.createElement("div",{style:{marginTop:"-15px"}},o.a.createElement(Jn,null))),o.a.createElement(Yn,null))));Zn.displayName="RuleOverviewPanel";var Xn=a(1423),er=a(1400);const tr=[{key:j.e,component:e=>o.a.createElement(q.a,e.params,o.a.createElement(dn,{path:e.path}))},{key:j.c,component:e=>o.a.createElement(q.a,e.params,o.a.createElement(J.a,{path:e.path}))},{key:j.d,component:e=>o.a.createElement(q.a,e.params,o.a.createElement(hn,{path:e.path}))},{key:j.a,component:e=>o.a.createElement(En,e.params,o.a.createElement(Sn,null))},{key:j.f,component:e=>o.a.createElement(kn,e.params,o.a.createElement(Zn,null))},{key:j.b,component:e=>o.a.createElement(M,e.params,o.a.createElement($,{path:e.path}))},{key:me.c,component:e=>o.a.createElement(me.b,e.params)},{key:Xn.b,component:e=>o.a.createElement(Xn.a,r()({},e.params,{path:e.path}))},{key:me.d,component:e=>o.a.createElement(me.b,r()({},e.params,{isPreviewMode:!0}))},{key:de.d,component:e=>o.a.createElement(de.c,e.params)},{key:er.b,component:e=>o.a.createElement(er.a,e.params)},{key:de.e,component:e=>o.a.createElement(de.c,r()({},e.params,{isPreviewMode:!0}))}],ar=`expandable-flyout-on-close-${tn.a.securitySolution}`,nr=`expandable-flyout-on-close-${tn.a.timeline}`,rr=Object(i.memo)((()=>{const e=Object(i.useCallback)((()=>window.dispatchEvent(new CustomEvent(ar,{detail:tn.a.securitySolution}))),[]);return o.a.createElement(x,{registeredPanels:tr,paddingSize:"none",onClose:e})}));rr.displayName="SecuritySolutionFlyout";const ir=Object(i.memo)((()=>{const{euiTheme:e}=Object(s.useEuiTheme)(),t=Object(i.useCallback)((()=>window.dispatchEvent(new CustomEvent(nr,{detail:tn.a.timeline}))),[]);return o.a.createElement(x,{registeredPanels:tr,paddingSize:"none",customStyles:{"z-index":e.levels.flyout+2},onClose:t})}));ir.displayName="TimelineFlyout"},1329:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(19),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(45),c=a(260),u=a(118),d=a(634),p=a(430),m=a(300);const b=s()(n.EuiFlexItem).withConfig({displayName:"NewNoteTabs",componentId:"sc-uq31qy-0"})(["width:100%;"]);b.displayName="NewNoteTabs";const g=i.a.memo((({note:e,noteInputHeight:t,updateNewNote:a,autoFocusDisabled:n=!1,setIsMarkdownInvalid:r})=>i.a.createElement(b,{"data-test-subj":"new-note-tabs"},i.a.createElement(m.a,{ariaLabel:p.d,onChange:a,value:e,dataTestSubj:"add-a-note",height:t,autoFocusDisabled:n,setIsMarkdownInvalid:r}))));g.displayName="NewNote";const f=s.a.div.withConfig({displayName:"AddNotesContainer",componentId:"sc-1065h8-0"})(["margin-bottom:5px;user-select:none;"]);f.displayName="AddNotesContainer";const h=s()(n.EuiFlexGroup).withConfig({displayName:"ButtonsContainer",componentId:"sc-1065h8-1"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeS));h.displayName="ButtonsContainer";const v=i.a.memo((({onCancelAddNote:e})=>i.a.createElement(n.EuiButtonEmpty,{"data-test-subj":"cancel",onClick:e},p.b)));v.displayName="CancelButton";const y=i.a.memo((({associateNote:e,newNote:t,onCancelAddNote:a,updateNewNote:o,autoFocusDisabled:s=!1})=>{const m=Object(l.useDispatch)(),b=Object(u.f)(),[y,E]=Object(r.useState)(!1),x=Object(r.useCallback)((e=>m(c.a.updateNote({note:e}))),[m]),j=Object(r.useCallback)((()=>{const a=null==b?void 0:b.username;a&&Object(d.b)({associateNote:e,newNote:t,updateNewNote:o,updateNote:x,user:a})}),[e,t,o,x,b]),w=Object(r.useCallback)((e=>{e.stopPropagation(),"Escape"===e.key&&null!=a&&a()}),[a]),S=Object(r.useMemo)((()=>0===t.trim().length||y),[t,y]);return i.a.createElement(f,{onKeyDown:w,role:"dialog"},i.a.createElement("div",{style:{width:"100%"}},i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},i.a.createElement("p",null,p.g)),i.a.createElement(g,{note:t,noteInputHeight:200,updateNewNote:o,autoFocusDisabled:s,setIsMarkdownInvalid:E}),i.a.createElement(h,{gutterSize:"none"},null!=a?i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(v,{onCancelAddNote:a})):null,i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButton,{"data-test-subj":"add-note",isDisabled:S,fill:!0,onClick:j},p.a)))))}));y.displayName="AddNote"},1347:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",SLO:"slo",SIEM:"siem",UPTIME:"uptime",ML:"ml",STACK_ALERTS:"stackAlerts",EXAMPLE:"AlertingExample",MONITORING:"monitoring"};Object.values(n).map((e=>e))},1359:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));let n=function(e){return e.failed="failed",e.succeeded="succeeded",e.unknown="unknown",e}({}),r=function(e){return e.SpecialFields="SpecialFields",e.SelectedFields="SelectedFields",e.PopularFields="PopularFields",e.AvailableFields="AvailableFields",e.EmptyFields="EmptyFields",e.MetaFields="MetaFields",e.UnmappedFields="UnmappedFields",e.SmartFields="SmartFields",e}({})},1414:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1415);case"v8light":return a(1417)}},1415:function(e,t,a){var n=a(185),r=a(1416);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},1416:function(e,t,a){(t=a(186)(!1)).push([e.i,'.domDroppable{border-radius:6px;transition:.15s ease-in-out;transition-property:background-color,border-color,opacity;z-index:1}.domDroppable:not(.domDroppable__overlayWrapper):before{border:1px dashed #0000;border-radius:6px;content:"";height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.domDraggable_ghost{left:0;margin:0!important;opacity:.9;outline:2px solid currentColor;outline-style:auto;pointer-events:none;position:absolute!important;top:0;transform:translate(8px,24px);width:100%;z-index:3}.domDroppable--active:not(.domDroppable__overlayWrapper){background-color:#54b3991a!important}.domDroppable--active:not(.domDroppable__overlayWrapper):before{border:1px dashed #0000;border-color:#54b399!important;border-radius:6px;content:"";height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.domDroppable--active>*{pointer-events:none}.domDroppable--hover:not(.domDroppable__overlayWrapper){background-color:#54b39940!important;z-index:3}.domDroppable--hover:not(.domDroppable__overlayWrapper):before{border-color:#54b399!important}.domDroppable--notAllowed{opacity:.5}.domDroppable--replacing{text-decoration:line-through}.domDroppable--incompatible:not(.domDroppable__overlayWrapper){background-color:#2e2d25!important}.domDroppable--incompatible:not(.domDroppable__overlayWrapper):before{border:1px dashed #d6bf57!important}.domDroppable--incompatible:not(.domDroppable__overlayWrapper).domDroppable--hover{background-color:#fbd01140!important}.domDroppable--incompatible:not(.domDroppable__overlayWrapper).domDroppable--hover:before{border-color:#d6bf57!important}.domDroppable__container{height:100%;position:relative;width:100%}.domDroppable__container.domDroppable__container-active{z-index:3}.domDroppable__container .domDroppable__container{position:static}.domDroppable--reorderable{height:calc(100% + 4px);position:absolute;top:0;width:100%}.domDroppable--translatable{pointer-events:none;transform:translateY(0);transition:transform .15s ease-in-out}.domDroppable--translatable .domDroppable--hover{z-index:3}.domDroppable__extraTargets{max-width:400px;opacity:0;position:absolute;right:calc(100% + 8px);top:0;transition:opacity .15s ease-in-out;visibility:hidden;width:100%;z-index:2}.domDroppable__extraTargets-visible{opacity:1;visibility:visible}.domDroppable__extraDropWrapper{background:#25262e;border-radius:4px;height:100%;position:relative;width:100%}.domDroppable__extraDropWrapper .domDroppable__extraTarget,.domDroppable__extraDropWrapper .domDroppable__extraTarget:before{border-radius:0}.domDroppable__extraDropWrapper:first-child .domDroppable__extraTarget,.domDroppable__extraDropWrapper:first-child .domDroppable__extraTarget:before{border-top-left-radius:4px;border-top-right-radius:4px}.domDroppable__extraDropWrapper:last-child .domDroppable__extraTarget,.domDroppable__extraDropWrapper:last-child .domDroppable__extraTarget:before{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.domDroppable__extraDropWrapper+.domDroppable__extraDropWrapper{margin-top:-1px}.domDroppable__extraTarget{color:#7dded8;height:32px;min-width:112px;padding:4px;position:relative}.domDroppable__extraTarget.domDroppable--incompatibleExtraTarget{color:#f3d371}.domDroppable__overlayWrapper{height:100%;position:relative}.domDroppable_overlay{height:100%;left:0;position:absolute;top:0;transition:.15s ease-in-out;transition-property:background-color,border-color,opacity;width:100%;z-index:3}.domDroppable--active .domDroppable_overlay{background-color:#54b3991a!important}.domDroppable--active .domDroppable_overlay:before{border:2px dashed #0000;border-color:#54b399!important;border-radius:6px;content:"";height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.domDroppable--hover .domDroppable_overlay{background-color:#54b39940!important}.domDroppable--hover .domDroppable_overlay:before{border-color:#54b399!important}.domDragDrop-isActiveGroup{background-color:#54b39940}.domDragDrop-isActiveGroup .domDraggable_active_keyboard--reorderable .domDraggable_dragover_keyboard--copy{opacity:1}',""]),e.exports=t},1417:function(e,t,a){var n=a(185),r=a(1418);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},1418:function(e,t,a){(t=a(186)(!1)).push([e.i,'.domDroppable{border-radius:6px;transition:.15s ease-in-out;transition-property:background-color,border-color,opacity;z-index:1}.domDroppable:not(.domDroppable__overlayWrapper):before{border:1px dashed #0000;border-radius:6px;content:"";height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.domDraggable_ghost{left:0;margin:0!important;opacity:.9;outline:2px solid currentColor;outline-style:auto;pointer-events:none;position:absolute!important;top:0;transform:translate(8px,24px);width:100%;z-index:3}.domDroppable--active:not(.domDroppable__overlayWrapper){background-color:#54b3991a!important}.domDroppable--active:not(.domDroppable__overlayWrapper):before{border:1px dashed #0000;border-color:#54b399!important;border-radius:6px;content:"";height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.domDroppable--active>*{pointer-events:none}.domDroppable--hover:not(.domDroppable__overlayWrapper){background-color:#54b39940!important;z-index:3}.domDroppable--hover:not(.domDroppable__overlayWrapper):before{border-color:#54b399!important}.domDroppable--notAllowed{opacity:.5}.domDroppable--replacing{text-decoration:line-through}.domDroppable--incompatible:not(.domDroppable__overlayWrapper){background-color:#fff9e8!important}.domDroppable--incompatible:not(.domDroppable__overlayWrapper):before{border:1px dashed #d6bf57!important}.domDroppable--incompatible:not(.domDroppable__overlayWrapper).domDroppable--hover{background-color:#fbd01140!important}.domDroppable--incompatible:not(.domDroppable__overlayWrapper).domDroppable--hover:before{border-color:#d6bf57!important}.domDroppable__container{height:100%;position:relative;width:100%}.domDroppable__container.domDroppable__container-active{z-index:3}.domDroppable__container .domDroppable__container{position:static}.domDroppable--reorderable{height:calc(100% + 4px);position:absolute;top:0;width:100%}.domDroppable--translatable{pointer-events:none;transform:translateY(0);transition:transform .15s ease-in-out}.domDroppable--translatable .domDroppable--hover{z-index:3}.domDroppable__extraTargets{max-width:400px;opacity:0;position:absolute;right:calc(100% + 8px);top:0;transition:opacity .15s ease-in-out;visibility:hidden;width:100%;z-index:2}.domDroppable__extraTargets-visible{opacity:1;visibility:visible}.domDroppable__extraDropWrapper{background:#f5f7fa;border-radius:4px;height:100%;position:relative;width:100%}.domDroppable__extraDropWrapper .domDroppable__extraTarget,.domDroppable__extraDropWrapper .domDroppable__extraTarget:before{border-radius:0}.domDroppable__extraDropWrapper:first-child .domDroppable__extraTarget,.domDroppable__extraDropWrapper:first-child .domDroppable__extraTarget:before{border-top-left-radius:4px;border-top-right-radius:4px}.domDroppable__extraDropWrapper:last-child .domDroppable__extraTarget,.domDroppable__extraDropWrapper:last-child .domDroppable__extraTarget:before{border-bottom-left-radius:4px;border-bottom-right-radius:4px}.domDroppable__extraDropWrapper+.domDroppable__extraDropWrapper{margin-top:-1px}.domDroppable__extraTarget{color:#007e77;height:32px;min-width:112px;padding:4px;position:relative}.domDroppable__extraTarget.domDroppable--incompatibleExtraTarget{color:#8a6a0a}.domDroppable__overlayWrapper{height:100%;position:relative}.domDroppable_overlay{height:100%;left:0;position:absolute;top:0;transition:.15s ease-in-out;transition-property:background-color,border-color,opacity;width:100%;z-index:3}.domDroppable--active .domDroppable_overlay{background-color:#54b3991a!important}.domDroppable--active .domDroppable_overlay:before{border:2px dashed #0000;border-color:#54b399!important;border-radius:6px;content:"";height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.domDroppable--hover .domDroppable_overlay{background-color:#54b39940!important}.domDroppable--hover .domDroppable_overlay:before{border-color:#54b399!important}.domDragDrop-isActiveGroup{background-color:#54b39940}.domDragDrop-isActiveGroup .domDraggable_active_keyboard--reorderable .domDraggable_dragover_keyboard--copy{opacity:1}',""]),e.exports=t},1419:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),r=a(45),i=a(124),o=a(148),s=a(129);const l=[];function c(e){return null!==e}const u=e=>{const[t,a]=Object(n.useState)(!1),[u,d]=Object(n.useState)(),p=Object(n.useCallback)((()=>{a(!1)}),[]),m=Object(n.useCallback)((()=>{a(!0)}),[]),{eventIdToNoteIds:b,refetch:g,timelineId:f,activeTab:h}=e,v=Object(n.useMemo)((()=>o.a.notesByIdsSelector()),[]),y=Object(i.a)(v);Object(n.useEffect)((()=>{h&&p()}),[h,p]);const E=Object(r.useDispatch)(),x=Object(n.useMemo)((()=>u&&(null==b?void 0:b[u])||l),[b,u]);return{associateNote:Object(n.useCallback)((e=>{u&&(E(s.a.addNoteToEvent({eventId:u,id:f,noteId:e})),g&&g())}),[E,u,g,f]),notes:Object(n.useMemo)((()=>x.map((e=>{const t=y[e];var a;return t?{savedObjectId:t.saveObjectId,note:t.note,noteId:t.id,updated:(null!==(a=t.lastEdit)&&void 0!==a?a:t.created).getTime(),updatedBy:t.user}:null})).filter(c)),[x,y]),isNotesFlyoutVisible:t,closeNotesFlyout:p,showNotesFlyout:m,eventId:u,setNotesEventId:d}}},142:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n=(e,t)=>"string"==typeof e?e:Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?e[0]:null!=t?t:null,r=e=>"string"==typeof e?[e]:Array.isArray(e)&&e.length>0?e:[]},1421:function(e,t,a){"use strict";a.d(t,"a",(function(){return mt}));var n=a(2),r=a.n(n),i=a(1744),o=a(41),s=a.n(o),l=a(19),c=a(49);const u=s()(l.EuiFlexGroup).attrs((({className:e=""})=>({className:`${e}`}))).withConfig({displayName:"StyledTableFlexGroup",componentId:"sc-eywmnv-0"})(["margin:0;width:100%;overflow:hidden;.dscPageBody__contents{overflow:hidden;height:100%;}"]),d=s()(l.EuiFlexItem).attrs((({className:e=""})=>({className:`${e}`}))).withConfig({displayName:"StyledUnifiedTableFlexItem",componentId:"sc-eywmnv-1"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),p=s()(l.EuiFlexItem).attrs((({className:e=""})=>({className:`${e}`}))).withConfig({displayName:"StyledSplitFlexItem",componentId:"sc-eywmnv-2"})(["border-right:",";"],c.euiThemeVars.euiBorderThin),m=s()(l.EuiProgress).withConfig({displayName:"StyledEuiProgress",componentId:"sc-eywmnv-3"})(["z-index:2;"]),b=s.a.div.attrs((({className:e=""})=>({className:`${e}`}))).withConfig({displayName:"StyledPageContentWrapper",componentId:"sc-eywmnv-4"})(["height:100%;overflow:hidden;position:relative;"]),g=s()(l.EuiPanel).attrs((({className:e=""})=>({className:`udtPageContent__wrapper ${e}`}))).withConfig({displayName:"StyledMainEuiPanel",componentId:"sc-eywmnv-5"})(["overflow:hidden;display:flex;flex-direction:column;height:100%;"]),f=s.a.div.attrs((({className:e=""})=>({className:`unifiedDataTable ${e}`,role:"rowgroup"}))).withConfig({displayName:"StyledTimelineUnifiedDataTable",componentId:"sc-eywmnv-6"})([".udtTimeline [data-gridcell-column-id|='select']{border-right:none;}.udtTimeline [data-gridcell-column-id|='openDetails'] .euiDataGridRowCell__contentByHeight{margin-top:3px;}.udtTimeline .euiDataGridHeaderCell.euiDataGridHeaderCell--controlColumn{padding:0;position:relative;}.udtTimeline .euiDataGridRowCell--controlColumn{overflow:visible;}.udtTimeline [data-gridcell-column-id|='select'] .euiDataGridRowCell__contentByHeight{margin-top:5px;}.udtTimeline .euiDataGridRow:hover .euiDataGridRowCell--lastColumn.euiDataGridRowCell--controlColumn{",";}.udtTimeline .euiDataGridRowCell--lastColumn.euiDataGridRowCell--controlColumn{",";}.udtTimeline .siemEventsTable__trSupplement--summary{border-radius:8px;}.udtTimeline .euiDataGridRow:has(.buildingBlockType),.udtTimeline .euiDataGridRow.buildingBlockType{background:repeating-linear-gradient( 127deg,rgba(245,167,0,0.2),rgba(245,167,0,0.2) 1px,rgba(245,167,0,0.05) 2px,rgba(245,167,0,0.05) 10px );}.udtTimeline .euiDataGridRow:has(.eqlSequence),.udtTimeline .euiDataGridRow.eqlSequence{.euiDataGridRowCell--firstColumn,.euiDataGridRowCell--controlColumn.euiDataGridRowCell--lastColumn,.udt--customRow{",";}background:repeating-linear-gradient( 127deg,rgba(0,107,180,0.2),rgba(0,107,180,0.2) 1px,rgba(0,107,180,0.05) 2px,rgba(0,107,180,0.05) 10px );}.udtTimeline .euiDataGridRow:has(.eqlNonSequence),.udtTimeline .euiDataGridRow.eqlNonSequence{.euiDataGridRowCell--firstColumn,.euiDataGridRowCell--controlColumn.euiDataGridRowCell--lastColumn,.udt--customRow{","}background:repeating-linear-gradient( 127deg,rgba(221,10,115,0.2),rgba(221,10,115,0.2) 1px,rgba(221,10,115,0.05) 2px,rgba(221,10,115,0.05) 10px );}.udtTimeline .euiDataGridRow:has(.nonRawEvent),.udtTimeline .euiDataGridRow.nonRawEvent{.euiDataGridRowCell--firstColumn,.euiDataGridRowCell--controlColumn.euiDataGridRowCell--lastColumn,.udt--customRow{","}}.udtTimeline .euiDataGridRow:has(.rawEvent),.udtTimeline .euiDataGridRow.rawEvent{.euiDataGridRowCell--firstColumn,.euiDataGridRowCell--controlColumn.euiDataGridRowCell--lastColumn,.udt--customRow{","}}.udtTimeline .rowCellWrapper{display:flex;width:fit-content;}.udtTimeline .rightPosition{position:absolute;right:5px;button{","}}.udtTimeline .euiDataGrid__rightControls{padding-right:30px;}.udtTimeline .euiDataGrid__leftControls{display:flex;align-items:baseline;}",""],(({theme:e})=>`background-color: ${e.eui.colorLightShade};`),(({theme:e})=>`background-color: ${e.eui.emptyShade};`),(({theme:e})=>`border-left: 4px solid ${e.eui.euiColorPrimary}`),(({theme:e})=>`border-left: 4px solid ${e.eui.euiColorAccent};`),(({theme:e})=>`border-left: 4px solid ${e.eui.euiColorWarning};`),(({theme:e})=>`border-left: 4px solid ${e.eui.euiColorLightShade};`),(({theme:e})=>`color: ${e.eui.euiColorDarkShade};`),"\n  .udtTimeline .euiDataGridRowCell--controlColumn:nth-child(3) .euiDataGridRowCell__content {\n    padding: 0;\n  }\n"),h=Object(o.createGlobalStyle)(["body:has(.timeline-portal-overlay-mask) .unifiedDataTable__cellPopover{z-index:1001 !important;}"]);var v=a(45),y=a(11),E=a(7);async function x(e,t,a,n){var r;if(!e.id||null==n||null===(r=n.indexPatterns)||void 0===r||!r.save)return;const i=e.fields.getByName(t);if(i&&(i.count++,e.isPersisted()))try{await a.updateSavedObject(e,0,!0)}catch{}}function j(e,t=!1){return e.length>1&&-1!==e.indexOf("_source")?e.filter((e=>"_source"!==e)):0!==e.length?e:t?[]:["_source"]}function w(e,t){return e?t?e.filter((e=>"_source"!==e)):e:[]}var S=a(119),O=a.n(S),k=a(52),I=a.n(k),T=a(751),C=a.n(T),M=a(1724),F=(a(1414),a(43));const D=()=>{},P=e=>{const[t,a]=Object(i.c)();if(e.isDisabled)return e.children;const{dropTypes:n,reorderableGroup:r}=e,o={...e,dndState:t,dndDispatch:a};return r&&r.length>1&&"reorder"===(null==n?void 0:n[0])?Object(F.jsx)(R,O()({},o,{reorderableGroup:r})):Object(F.jsx)(L,o)},L=Object(n.memo)((function(e){const{dataTestSubj:t,className:a,onDrop:r,value:i,children:o,dndState:s,dndDispatch:c,dropTypes:u,order:d,getAdditionalClassesOnEnter:p,getAdditionalClassesOnDroppable:m,getCustomDropTarget:b}=e,{dragging:g,hoveredDropTarget:f,dataTestSubjPrefix:h,keyboardMode:v}=s,[y,E]=Object(n.useState)(!1),x=Object(n.useRef)(null);C()((()=>{u&&null!=u&&u[0]&&r&&v&&c({type:"registerDropTargets",payload:u.reduce(((e,t,a)=>({...e,[[...d,a].join(",")]:{...i,onDrop:r,dropType:t}})),{})})}),[d,c,u,v]),Object(n.useEffect)((()=>{let e=!0;return f&&f.id!==i.id&&E(!1),setTimeout((()=>{!f&&e&&E(!1)}),1e3),()=>{e=!1}}),[f,E,i.id]);const j=Object(n.useCallback)((()=>{y||E(!0)}),[y]),w=Object(n.useCallback)(((e,t)=>{if(!u||u.length<=1)return t;const a=u.indexOf(t);if(a>0)return t;if(0===a){if(e.altKey&&u[1])return u[1];if(e.shiftKey&&u[2])return u[2];if(e.ctrlKey&&(u.length>3?u[3]:u[1]))return u.length>3?u[3]:u[1]}return t}),[u]),S=Object(n.useCallback)((()=>{c({type:"leaveDropTarget"})}),[c]),k=Object(n.useCallback)(((e,t)=>{if(e.preventDefault(),e.stopPropagation(),E(!1),r&&g){const a=w(e,t);r(g,a),setTimeout((()=>{c({type:"dropToTarget",payload:{dragging:g,dropTarget:{...i,dropType:a,onDrop:r}}})}))}c({type:"resetState"})}),[c,r,g,w,i]),T=(e,a)=>{const n=Boolean((null==f?void 0:f.id)===i.id&&e===(null==f?void 0:f.dropType));return{"data-test-subj":t||`${h}-domDroppable`,className:M(e,a),onDragEnter:j,onDragLeave:S,onDragOver:e?t=>{((e,t)=>{if(e.preventDefault(),!g||!r)return;const a=w(e,t);(null==f?void 0:f.id)===i.id&&(null==f?void 0:f.dropType)===a||c({type:"selectDropTarget",payload:{dropTarget:{...i,dropType:a,onDrop:r},dragging:g}})})(t,e)}:D,onDrop:e?t=>{k(t,e)}:D,ghost:n&&"reorder"!==e&&(null==g?void 0:g.ghost)&&g.ghost||void 0}},M=(e,t=o)=>{const n=Boolean((null==f?void 0:f.id)===i.id&&e===(null==f?void 0:f.dropType)),r=null==m?void 0:m(e),s=I()("domDroppable",{"domDroppable--active":g&&e,"domDroppable--hover":e&&n,"domDroppable--notAllowed":g&&(!u||!u.length)&&i.id!==g.id},r&&{[r]:g&&e});return I()(s,a,t.props.className)},P=T(u&&u[0]);return Object(F.jsx)("div",{"data-test-subj":`${h}Container`,className:I()("domDroppable__container",{"domDroppable__container-active":y||(null==f?void 0:f.id)===i.id}),onDragEnter:j,ref:x},Object(F.jsx)(N,O()({},P,{className:I()(P.className,(()=>{const e=null==p?void 0:p(null==f?void 0:f.dropType);return I()(e&&{[e]:(null==f?void 0:f.id)===i.id})})())}),o),u&&u.length>1&&Object(F.jsx)(l.EuiFlexGroup,{gutterSize:"none",direction:"column","data-test-subj":`${h}ExtraTargets`,className:I()("domDroppable__extraTargets",{"domDroppable__extraTargets-visible":y||(null==f?void 0:f.id)===i.id})},u.slice(1).map((e=>{const t=null==b?void 0:b(e);return t?Object(F.jsx)(l.EuiFlexItem,{key:e,className:"domDroppable__extraDropWrapper"},Object(F.jsx)(N,T(e,t),t)):null}))))})),N=({ghost:e,children:t,...a})=>Object(F.jsx)(r.a.Fragment,null,r.a.cloneElement(t,a),e?r.a.cloneElement(e.children,{className:I()(e.children.props.className,e.className,"domDraggable_ghost"),style:e.style}):null),R=Object(n.memo)((function(e){const{onDrop:t,value:a,dndState:i,dndDispatch:o,reorderableGroup:s,className:l}=e,{dragging:c,dataTestSubjPrefix:u,hoveredDropTarget:d}=i,p=s.findIndex((e=>e.id===a.id)),[{isReorderOn:m,reorderedItems:b,draggingHeight:g,direction:f},h]=Object(n.useContext)(M.a),v=Object(n.useRef)(null),y=m&&b.some((e=>e.id===a.id))&&b.length;return Object(n.useEffect)((()=>{var e;y&&null!==(e=v.current)&&void 0!==e&&e.clientHeight&&h({type:"registerReorderedItemHeight",payload:{id:a.id,height:v.current.clientHeight}})}),[y,h,a.id]),Object(F.jsx)(r.a.Fragment,null,Object(F.jsx)("div",{style:b.some((e=>e.id===a.id))?{transform:`translateY(${f}${g}px)`}:void 0,ref:v,"data-test-subj":`${u}-translatableDrop`,className:"domDroppable--translatable"},Object(F.jsx)(L,O()({},e,{className:I()(l,{domDroppable__overlayWrapper:c})}))),Object(F.jsx)("div",{"data-test-subj":`${u}-reorderableDropLayer`,className:I()({"domDroppable--reorderable":c}),onDrop:e=>{e.preventDefault(),e.stopPropagation(),t&&c&&(t(c,"reorder"),setTimeout((()=>{o({type:"dropToTarget",payload:{dragging:c,dropTarget:{...a,dropType:"reorder",onDrop:t}}})}))),o({type:"resetState"})},onDragOver:e=>{if(e.preventDefault(),(null==d?void 0:d.id)!==(null==a?void 0:a.id)&&t){const e=s.findIndex((e=>e.id===(null==c?void 0:c.id)));if(!c||-1===e)return;const n=p;e===n&&h({type:"reset"}),h({type:"setReorderedItems",payload:{draggingIndex:e,droppingIndex:n,items:s}}),o({type:"selectDropTarget",payload:{dropTarget:{...a,dropType:"reorder",onDrop:t},dragging:c}})}},onDragLeave:()=>{o({type:"leaveDropTarget"}),h({type:"reset"})}}))})),_=({isVisible:e,children:t,overlayProps:a,className:n,...r})=>Object(F.jsx)("div",O()({className:I()("domDroppable__overlayWrapper",n)},r||{}),t,e&&Object(F.jsx)("div",O()({className:"domDroppable_overlay","data-test-subj":"domDroppable_overlay"},a||{})));var A=a(1494);const z=r.a.lazy((()=>a.e(40).then(a.bind(null,2110)))),B=Object(A.a)(z,Object(F.jsx)(l.EuiDelayRender,{delay:300},Object(F.jsx)(l.EuiPanel,{color:"transparent",paddingSize:"s"},Object(F.jsx)(l.EuiLoadingSpinner,{size:"m"}))));var V=a(4);const $=V.i18n.translate("xpack.securitySolution.components.dataViewMandatory",{defaultMessage:"The DataView is required, but was not provided"}),q=V.i18n.translate("xpack.securitySolution.components.dataViewMandatoryDetailMessage",{defaultMessage:"The DataView is not selected properly. Please select the appropriate DataView and index patterns"}),G=()=>r.a.createElement(l.EuiEmptyPrompt,{"data-test-subj":"dataViewErrorComponent",iconType:"error",color:"danger",title:r.a.createElement("h2",null,$),body:r.a.createElement("p",null,q)});var U=a(766),H=a(127);const W=(e,t)=>a=>{const n=Object(U.a)({sourcererScope:H.SourcererScopeName.timeline});return n?r.a.createElement(e,O()({},a,{dataView:n})):null!=t?t:r.a.createElement(G,null)};var Q=a(855),K=a(118),J=a(243),Y=a(664);const Z=V.i18n.translate("xpack.securitySolution.timeline.dataTable.dropZoneTableLabel",{defaultMessage:"Drop zone to add field as a column to the table"}),X=V.i18n.translate("xpack.securitySolution.timeline.dataTable.fullScreenButton",{defaultMessage:"Enter fullscreen"}),ee=V.i18n.translate("xpack.securitySolution.timeline.dataTable.exitFullScreenButton",{defaultMessage:"Exit fullscreen (esc)"}),te=(V.i18n.translate("xpack.securitySolution.timeline.footer.events",{defaultMessage:"Events"}),V.i18n.translate("xpack.securitySolution.timeline.footer.of",{defaultMessage:"of"}),V.i18n.translate("xpack.securitySolution.timeline.footer.rows",{defaultMessage:"rows"}),V.i18n.translate("xpack.securitySolution.timeline.footer.loadingLabel",{defaultMessage:"Loading"}),V.i18n.translate("xpack.securitySolution.timeline.dataTable.footer.totalCountOfEvents",{defaultMessage:"events"}),V.i18n.translate("xpack.securitySolution.timeline.dataTable.footer.autoRefreshActiveDescription",{defaultMessage:"Auto-Refresh Active"}),V.i18n.translate("xpack.securitySolution.timeline.dataTable.footer.loadingEventsDataLabel",{defaultMessage:"Loading Events"}),V.i18n.translate("xpack.securitySolution.timeline.dataTable.timelineContextError",{defaultMessage:"Incorrect Usage of Unified Data Table Context. Must be used inside components or hooks called inside UnifiedDataTable "}));var ae=a(692);const ne=Object(A.a)(Object(n.lazy)((()=>a.e(69).then(a.bind(null,2128)))));var re=a(446),ie=a(645),oe=a.n(ie),se=a(8),le=a.n(se),ce=a(3);const ue=({container:e,sidebarPanel:t,mainPanel:a,unifiedFieldListSidebarContainerApi:i})=>{var o;const[s]=Object(n.useState)((()=>Object(re.c)({attributes:{class:"eui-fullHeight sidebarPanel"}}))),[c]=Object(n.useState)((()=>Object(re.c)({attributes:{class:"eui-fullHeight mainPanel"}}))),{euiTheme:u}=Object(l.useEuiTheme)(),d=13*u.base,p=19*u.base,m=30*u.base,[b,g]=oe()("timeline:sidebarWidth",p),f=Object(l.useIsWithinBreakpoints)(["xs","s"]),h=le()(null!==(o=null==i?void 0:i.sidebarVisibility.isCollapsed$)&&void 0!==o?o:Object(ce.of)(!0),!0),v=f||h?ae.b.Static:ae.b.Resizable,y=f?ae.a.Vertical:ae.a.Horizontal;return r.a.createElement(r.a.Fragment,null,r.a.createElement(re.a,{node:s},t),r.a.createElement(re.a,{node:c},a),r.a.createElement(ne,{className:"timelineUnifiedComponentsBody__contents",mode:v,direction:y,container:e,fixedPanelSize:null!=b?b:p,minFixedPanelSize:d,minFlexPanelSize:m,fixedPanel:r.a.createElement(re.b,{node:s}),flexPanel:r.a.createElement(re.b,{node:c}),resizeButtonClassName:"timelineSidebarResizeButton","data-test-subj":"timelineUnifiedComponentsLayout",onFixedPanelSizeChange:g}))},de=r.a.memo(ue);var pe=a(1484),me=a(1216),be=a(122),ge=a(384),fe=a(285),he=a(1319),ve=a(145),ye=a(169),Ee=a(121),xe=a(700),je=a(774),we=a(146),Se=a(132),Oe=a(980),ke=a(738),Ie=a(236),Te=a(744),Ce=a(131),Me=a(206),Fe=a(949),De=a(583),Pe=a(1241),Le=a(13);const Ne=V.i18n.translate("xpack.securitySolution.timeline.eventRenderersSwitch.title",{defaultMessage:"Event renderers"}),Re=V.i18n.translate("xpack.securitySolution.timeline.eventRenderersSwitch.warning",{defaultMessage:"Enabling event renderers might impact table performance."}),_e=s()(l.EuiFormRow).withConfig({displayName:"CustomFormRow",componentId:"sc-1gngj6-0"})([".euiFormRow__label{font-weight:400;}"]),Ae=r.a.memo((function(e){const t=Object(l.useGeneratedHtmlId)({prefix:"rowRendererSwitch"}),{timelineId:a}=e,i=Object(v.useDispatch)(),o=Object(v.useSelector)((e=>Object(ye.selectExcludedRowRendererIds)(e,a))),s=Object(n.useMemo)((()=>Object.values(Ee.e).some((e=>!o.includes(e)))),[o]),c=Object(n.useCallback)((()=>{i(Object(Le.setExcludedRowRendererIds)({id:a,excludedRowRendererIds:Object.values(Ee.e)}))}),[i,a]),u=Object(n.useCallback)((()=>{i(Object(Le.setExcludedRowRendererIds)({id:a,excludedRowRendererIds:[]}))}),[i,a]),d=Object(n.useCallback)((e=>{e.target.checked?u():c()}),[c,u]),p=Object(n.useMemo)((()=>r.a.createElement("span",{id:t},Ne)),[t]);return r.a.createElement(l.EuiToolTip,{position:"top",content:Re},r.a.createElement(_e,{display:"columnCompressedSwitch",label:p},r.a.createElement(l.EuiSwitch,{"data-test-subj":"row-renderer-switch",label:"",checked:s,onChange:d,compressed:!0})))})),ze=({timelineId:e,updatedAt:t})=>{const{timelineFullScreen:a,setTimelineFullScreen:i}=Object(Me.c)(),{globalFullScreen:o,setGlobalFullScreen:s}=Object(Me.a)(),c=Object(n.useRef)(null),u=()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.hideToolTip()},d=Object(n.useCallback)((()=>{u(),e===we.c.active?i(!a):s(!o)}),[e,i,a,s,o]),p=Object(n.useMemo)((()=>(({globalFullScreen:e,isActiveTimelines:t,timelineFullScreen:a})=>t&&a||!1===t&&e)({globalFullScreen:o,isActiveTimelines:Object(Ce.isActiveTimeline)(e),timelineFullScreen:a})),[o,a,e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ae,{timelineId:e}),r.a.createElement(Fe.a,{timelineId:e}),r.a.createElement(Pe.a,{updatedAt:t}),r.a.createElement("span",{className:"rightPosition"},r.a.createElement(l.EuiToolTip,{ref:c,content:p?ee:X},r.a.createElement(l.EuiButtonIcon,{"aria-label":p?ee:X,className:`${p?De.a:""}`,color:p?"text":"primary","data-test-subj":Object(Ce.isActiveTimeline)(e)?"full-screen-active":"full-screen",iconType:p?"fullScreenExit":"fullScreen",onClick:d,onMouseOut:u}))))},Be=r.a.memo(ze);var Ve=a(129),$e=a(1723),qe=a(225),Ge=a(272);const Ue=e=>{const t=Object(Ge.e)(e);return`${"raw"===t?"rawEvent":"eql"===t?Object(Ge.h)(e)?"eqlSequence":"eqlNonSequence":"nonRawEvent"} ${Object(Ge.i)(e)?"buildingBlockType":""}`.trim()};var He=a(180),We=a(1251),Qe=a(301);const Ke=Object(n.memo)((function({rowIndex:e,event:t,setCellProps:a,timelineId:i,enabledRowRenderers:o}){var s;const c=Object(n.useRef)(null),u=(()=>{const e=Object(n.useContext)(Qe.a);if(!e)throw new Error(te);return e})();return Object(n.useEffect)((()=>{var e;null==a||a({className:(null===(e=u.expanded)||void 0===e?void 0:e.id)===t._id?"unifiedDataTable__cell--expanded":"",style:{width:"100%",height:"auto"}})}),[null===(s=u.expanded)||void 0===s?void 0:s.id,a,e,t._id]),o&&0!==o.length?r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",alignItems:"center","data-test-subj":`timeline-row-renderer-${e}`},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(He.w,null,r.a.createElement(We.a,{ariaRowindex:e+2,containerRef:c,event:t,lastFocusedAriaColindex:e-1,rowRenderers:o,timelineId:i})))):null}));var Je=a(266),Ye=a(1240);const Ze=Object(n.memo)((function(e){const{Cell:t,visibleColumns:a,visibleRowData:i,rows:o,rowHeight:s,enabledRowRenderers:l,refetch:c}=e,u=Object(n.useMemo)((()=>(null!=o?o:[]).slice(i.startRow,i.endRow)),[o,i]);return r.a.createElement(r.a.Fragment,null,u.map(((e,n)=>r.a.createElement(tt,{rowData:e,rowIndex:n,key:n,visibleColumns:a,rowHeight:s,Cell:t,enabledRowRenderers:l,refetch:c}))))})),Xe=s.a.div.attrs((e=>{var t;return{className:`euiDataGridRow ${null!==(t=e.className)&&void 0!==t?t:""}`,role:"row"}})).withConfig({displayName:"CustomGridRow",componentId:"sc-rbp4gn-0"})(["width:fit-content;border-bottom:1px solid ",";. euiDataGridRowCell--controlColumn{height:",";min-height:","px;}.udt--customRow{border-radius:0;padding:",";max-width:",";width:85vw;}.euiCommentEvent__body{background-color:",";}&:has(.unifiedDataTable__cell--expanded){.euiDataGridRowCell--firstColumn,.euiDataGridRowCell--lastColumn,.euiDataGridRowCell--controlColumn,.udt--customRow{","}}}"],(e=>e.theme.eui.euiBorderThin),(e=>e.$cssRowHeight),34,(e=>e.theme.eui.euiDataGridCellPaddingM),(e=>e.theme.eui.euiPageDefaultMaxWidth),(e=>e.theme.eui.euiColorEmptyShade),(({theme:e})=>`background-color: ${e.eui.euiColorHighlight};`)),et=s.a.div.attrs((e=>{var t;return{className:`rowCellWrapper ${null!==(t=e.className)&&void 0!==t?t:""}`,role:"row"}})).withConfig({displayName:"CustomGridRowCellWrapper",componentId:"sc-rbp4gn-1"})(["height:",";.euiDataGridRowCell,.euiDataGridRowCell__content{min-height:","px;.unifiedDataTable__rowControl{margin-top:-4px;}}"],(e=>e.$cssRowHeight),34),tt=Object(n.memo)((function(e){const{rowIndex:t,rowData:a,enabledRowRenderers:i,visibleColumns:o,Cell:s,rowHeight:l=0}=e,{canShowRowRenderer:c}=Object(Ye.a)({data:a.ecs,rowRenderers:i}),u=(d=l-1)<0?"auto":34+16*d+"px";var d;const p=Object(n.useMemo)((()=>c?{borderBottom:"none"}:{}),[c]),m=Object(n.useMemo)((()=>Ue(a.ecs)),[a.ecs]);return r.a.createElement(Xe,{className:t%2!=0?"euiDataGridRow--striped":"",$cssRowHeight:u,key:t},r.a.createElement(et,{className:m,$cssRowHeight:u},o.map(((e,a)=>e.id!==Je.e?r.a.createElement(s,{style:p,colIndex:a,visibleRowIndex:t,key:`${t},${a}`}):null))),c?r.a.createElement(s,{colIndex:o.length-1,visibleRowIndex:t}):null)})),at=r.a.memo(pe.b),nt=W(Object(n.memo)((function({columns:e,columnIds:t,dataView:a,activeTab:i,timelineId:o,itemsPerPage:s,itemsPerPageOptions:l,rowRenderers:c,sort:u,events:d,isSortEnabled:p=!0,onFieldEdited:b,refetch:g,dataLoadingState:y,totalCount:E,onEventClosed:x,showExpandedDetails:j,expandedDetail:w,onChangePage:S,updatedAt:k,isTextBasedQuery:I=!1,onSetColumns:T,onSort:C,onFilter:M,leadingControlColumns:F}){const D=Object(v.useDispatch)(),[P]=Object(n.useState)({timelineID:o,enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0,tabType:i}),{services:{uiSettings:L,fieldFormats:N,storage:R,dataViewFieldEditor:_,notifications:{toasts:A},telemetry:z,theme:B,data:V}}=Object(K.j)(),[$,q]=Object(n.useState)(),[G,U]=Object(n.useState)(0),W=Object(n.useCallback)((e=>{q((e=>e?void 0:e))}),[]),Q=Object(be.a)("expandableFlyoutDisabled"),{closeFlyout:J,openFlyout:Y}=Object(me.a)();(({callback:e})=>{const t=Object(ge.a)()===fe.a.securitySolution?he.a:he.c,a=Object(n.useCallback)((t=>e(t.detail)),[e]);Object(n.useEffect)((()=>(window.addEventListener(t,a),()=>window.removeEventListener(t,a))),[a,t])})({callback:W});const{browserFields:Z,runtimeMappings:X}=Object(Se.a)(H.SourcererScopeName.timeline),ee=Object(n.useMemo)((()=>!!a&&!!a.timeFieldName),[a]),{rowHeight:te,sampleSize:ae,excludedRowRendererIds:ne}=Object(v.useSelector)((e=>Object(ye.selectTimelineById)(e,o))),{tableRows:re,tableStylesOverride:ie}=Object(n.useMemo)((()=>function(e){const{events:t,dataView:a}=e,n={};return{tableRows:t.map((({_id:e,_index:t,ecs:r,data:i},o)=>{const s=r,l={_id:e,_index:String(t),_source:s};return n[o]=Ue(r),{_id:e,id:e,data:i,ecs:r,raw:l,flattened:Object($e.a)(l,a,{includeIgnoredValues:!0})}})),tableStylesOverride:{...qe.b,rowClasses:n}}}({events:d,dataView:a})),[d,a]),oe=Object(n.useCallback)((e=>{var t;const a={panelView:"eventDetail",params:{eventId:e._id,indexName:null!==(t=e.ecs._index)&&void 0!==t?t:"",refetch:g}};var n;Q?D(Ve.a.toggleDetailPanel({...a,tabType:i,id:o})):(Y({right:{id:ve.e,params:{id:e._id,indexName:null!==(n=e.ecs._index)&&void 0!==n?n:"",scopeId:o}}}),z.reportDetailsFlyoutOpened({location:o,panel:"right"})),Oe.a.toggleExpandedDetail({...a})}),[g,Q,Y,o,z,D,i]),se=Object(n.useCallback)((()=>{var e;null!==(e=w[i])&&void 0!==e&&e.panelView&&o===we.c.active&&j&&Oe.a.toggleExpandedDetail({}),q(void 0),x({tabType:i,id:o})}),[w,i,o,j,x]),le=Object(n.useCallback)((e=>{if(e){const t=re.find((t=>t.id===e.id));q(t),t&&oe(t)}else Q||(J(),q(void 0)),se()}),[re,oe,se,J,Q]),ce=Object(n.useCallback)((({columnId:e,width:t})=>{D(Ve.a.updateColumnWidth({columnId:e,id:o,width:t}))}),[D,o]),ue=Object(n.useCallback)((e=>{ce({columnId:e.columnId,width:Math.round(e.width)})}),[ce]),de=Object(n.useCallback)((e=>{D(Ve.a.updateItemsPerPage({id:o,itemsPerPage:e}))}),[D,o]),Ce=Object(n.useMemo)((()=>(({dataTableRows:e,headers:t,scopeId:a})=>t.reduce(((t,n)=>(t[n.id]=function(t){return r.a.createElement(Te.a,O()({},t,{isDraggable:!1,isTimeline:!0,isDetails:!1,isExpanded:!1,isExpandable:!0,data:e[t.rowIndex].data,eventId:e[t.rowIndex]._id,scopeId:a,linkValues:void 0,header:n}))},t)),{}))({dataTableRows:re,scopeId:"timeline",headers:e})),[e,re]),Me=Object(n.useCallback)((()=>{S(G+1),U(G+1)}),[G,S]),Fe=Object(n.useMemo)((()=>r.a.createElement(Be,{timelineId:o,updatedAt:k})),[o,k]),De=Object(n.useMemo)((()=>({scopeId:o})),[o]),Pe=Object(n.useCallback)((e=>{e!==ae&&(D(Ve.a.updateSampleSize({id:o,sampleSize:e})),g())}),[D,ae,o,g]),Le=Object(n.useCallback)((e=>{e!==te&&D(Ve.a.updateRowHeight({id:o,rowHeight:e}))}),[D,te,o]),Ne=Object(n.useMemo)((()=>({theme:B,fieldFormats:N,storage:R,toastNotifications:A,uiSettings:L,dataViewFieldEditor:_,data:V})),[B,N,R,A,L,_,V]),Re=Object(n.useMemo)((()=>ne&&ne.length===Ee.d?[]:ne?c.filter((e=>!ne.includes(e.id))):c),[ne,c]),_e=Object(n.useMemo)((()=>[{id:Je.e,width:0,headerCellRender:()=>r.a.createElement(r.a.Fragment,null),headerCellProps:{className:"euiScreenReaderOnly"},footerCellProps:{style:{display:"none"}},rowCellRender:e=>{const{rowIndex:t,...a}=e;return r.a.createElement(Ke,O()({event:re[t],rowIndex:t,timelineId:o,enabledRowRenderers:Re},a))}}]),[Re,re,o]),Ae=Object(n.useCallback)((({Cell:e,visibleRowData:t,visibleColumns:a,setCustomGridBodyProps:n})=>r.a.createElement(Ze,{rows:re,Cell:e,visibleColumns:a,visibleRowData:t,setCustomGridBodyProps:n,enabledRowRenderers:Re,rowHeight:te,refetch:g})),[re,Re,te,g]),ze=Object(n.useMemo)((()=>({expandedEventId:null==$?void 0:$.id})),[$]),Ge=Object(n.useMemo)((()=>Re.length>0?Ae:void 0),[Re.length,Ae]),He=Object(n.useMemo)((()=>Re.length>0?_e:void 0),[Re.length,_e]);return r.a.createElement(je.a.Provider,{value:P},r.a.createElement(f,null,(y===pe.a.loading||y===pe.a.loadingMore)&&r.a.createElement(m,{"data-test-subj":"discoverDataGridUpdating",size:"xs",color:"accent"}),r.a.createElement(h,null),r.a.createElement(at,{ariaLabelledBy:"timelineDocumentsAriaLabel",className:"udtTimeline",columns:t,expandedDoc:$,gridStyleOverride:ie,dataView:a,showColumnTokens:!0,loadingState:y,onFilter:M,onResize:ue,onSetColumns:T,onSort:I?void 0:C,rows:re,sampleSizeState:ae||500,onUpdateSampleSize:Pe,setExpandedDoc:le,showTimeCol:ee,isSortEnabled:p,sort:u,rowHeightState:te,isPlainRecord:I,rowsPerPageState:s,onUpdateRowsPerPage:de,onUpdateRowHeight:Le,onFieldEdited:b,cellActionsTriggerId:Ie.e.DEFAULT,services:Ne,visibleCellActions:3,externalCustomRenderers:Ce,renderDocumentView:xe.a,rowsPerPageOptions:l,showFullScreenButton:!1,useNewFieldsApi:!0,maxDocFieldsDisplayed:50,consumer:"timeline",totalHits:E,onFetchMoreRecords:Me,configRowHeight:3,showMultiFields:!0,cellActionsMetadata:De,externalAdditionalControls:Fe,renderCustomGridBody:Ge,trailingControlColumns:He,externalControlColumns:F,cellContext:ze}),j&&Q&&r.a.createElement(ke.a,{browserFields:Z,handleOnPanelClosed:se,runtimeMappings:X,tabType:i,scopeId:o,isFlyoutView:!0})))})));var rt=a(1359);const it=()=>({originatingApp:"security_solution",localStorageKeyPrefix:"securitySolution",timeRangeUpdatesType:"timefilter",compressed:!0,showSidebarToggleButton:!0,disablePopularFields:!1,buttonAddFieldToWorkspaceProps:{"aria-label":V.i18n.translate("xpack.securitySolution.fieldChooser.timelineField.addFieldTooltip",{defaultMessage:"Add field as column"})},buttonRemoveFieldFromWorkspaceProps:{"aria-label":V.i18n.translate("xpack.securitySolution.timeline.fieldChooser.timelineField.removeFieldTooltip",{defaultMessage:"Remove field from table"})},onOverrideFieldGroupDetails:e=>{if(e===rt.b.AvailableFields)return{helpText:V.i18n.translate("xpack.securitySolution.timeline.fieldChooser.availableFieldsTooltip",{defaultMessage:"Fields available for display in the table."})}},dataTestSubj:{fieldListAddFieldButtonTestSubj:"dataView-add-field_btn",fieldListSidebarDataTestSubj:"timeline-sidebar",fieldListItemStatsDataTestSubj:"dscFieldStats",fieldListItemDndDataTestSubjPrefix:"dscFieldListPanelField",fieldListItemPopoverDataTestSubj:"timelineFieldListPanelPopover",fieldListItemPopoverHeaderDataTestSubjPrefix:"timelineFieldListPanel"}});var ot=a(274);const st=s.a.div.attrs((({className:e=""})=>({className:`${e}`}))).withConfig({displayName:"TimelineBodyContainer",componentId:"sc-b3c5cm-0"})(["width:100%;height:100%;"]),lt=r.a.memo(nt),ct={value:{id:"dscDropZoneTable",humanData:{label:Z}},order:[1,0,0,0],types:["field_add"]},ut=s()(l.EuiFlexGroup).withConfig({displayName:"SidebarPanelFlexGroup",componentId:"sc-b3c5cm-1"})(["height:100%;.unifiedFieldListSidebar{padding-bottom:",";padding-left:0px;border-top:1px solid ",";.unifiedFieldListSidebar__group{.euiFlexItem:last-child{}.unifiedFieldListSidebar__list{padding-left:0px;}.unifiedFieldListSidebar__addBtn{margin-right:",";}}}"],(e=>e.theme.eui.euiSizeS),(e=>e.theme.eui.euiColorLightShade),(e=>e.theme.eui.euiSizeS)),dt=["xs","s"],pt=r.a.memo(W((({columns:e,isSortEnabled:t,activeTab:a,timelineId:o,itemsPerPage:s,itemsPerPageOptions:c,rowRenderers:u,sort:d,events:m,refetch:f,dataLoadingState:h,totalCount:S,onEventClosed:O,showExpandedDetails:k,expandedDetail:I,onChangePage:T,updatedAt:C,isTextBasedQuery:M,dataView:F,trailingControlColumns:D,leadingControlColumns:L})=>{const N=Object(v.useDispatch)(),R=Object(n.useRef)(null),{services:{uiSettings:A,fieldFormats:z,dataViews:V,dataViewFieldEditor:$,application:{capabilities:q},uiActions:G,charts:U,docLinks:H,analytics:W,timelineDataService:Z}}=Object(K.j)(),{query:{filterManager:X}}=Z,ee=Object(n.useMemo)((()=>({fieldFormats:z,dataViews:V,dataViewFieldEditor:$,data:Z,uiActions:G,charts:U,core:{analytics:W,uiSettings:A,docLinks:H}})),[z,V,$,Z,G,U,A,H,W]),[te,ae]=Object(n.useState)(null),[,ne]=Object(n.useState)(null),re=Object(n.useMemo)((()=>e.map((e=>e.id))),[e]),ie=Object(n.useMemo)((()=>(null==d?void 0:d.map((e=>[e.columnId,e.sortDirection])))||[]),[d]),oe=Object(n.useCallback)((t=>{N(Ve.a.updateSort({id:o,sort:t.map((([t,a])=>{const n=e.find((e=>e.id===t)),r=n?n.type:"keyword";return{columnId:t,columnType:r,sortDirection:a,esTypes:"@timestamp"===t?["date"]:[]}}))}))}),[N,o,e]),se=Object(n.useCallback)((e=>{if(e.sort)oe(e.sort);else{const t=e.columns.map((e=>Object(Y.a)(e,ot.a)));N(Ve.a.updateColumns({id:o,columns:t}))}}),[N,oe,o]),{columns:le,onAddColumn:ce,onRemoveColumn:ue,onSetColumns:pe}=(({capabilities:e,dataView:t,dataViews:a,setAppState:r,useNewFieldsApi:i,columns:o,sort:s,defaultOrder:l="desc"})=>{const[c,u]=Object(n.useState)(w(o,i));Object(n.useEffect)((()=>{const e=w(o,i);Object(E.isEqual)(c,e)||u(e)}),[o,i,c]);const{onAddColumn:d,onRemoveColumn:p,onSetColumns:m,onMoveColumn:b}=Object(n.useMemo)((()=>function({capabilities:e,dataView:t,dataViews:a,useNewFieldsApi:n,setAppState:r,columns:i,sort:o,defaultOrder:s}){return{onAddColumn:function(l){x(t,l,a,e);const c=function(e,t,a){return e.includes(t)?e:j([...e,t],a)}(i||[],l,n),u="_score"!==l||null!=o&&o.length?o:[["_score",s]];r({columns:c,sort:u})},onRemoveColumn:function(s){x(t,s,a,e);const l=function(e,t,a){return e.includes(t)?j(e.filter((e=>e!==t)),a):e}(i||[],s,n),c=o&&o.length?o.filter((e=>e[0]!==s)):[];r({columns:l,sort:c})},onMoveColumn:function(e,t){const a=function(e,t,a){if(a<0||a>=e.length||!e.includes(t))return e;const n=[...e];return n.splice(n.indexOf(t),1),n.splice(a,0,t),n}(i||[],e,t);r({columns:a})},onSetColumns:function(e,a){const n=!a&&t.timeFieldName&&t.timeFieldName===e[0]?(e||[]).slice(1):e;r({columns:n})}}}({capabilities:e,dataView:t,dataViews:a,setAppState:r,useNewFieldsApi:i,columns:c,sort:s,defaultOrder:l})),[e,t,a,l,r,s,i,c]);return{columns:c,onAddColumn:d,onRemoveColumn:p,onMoveColumn:b,onSetColumns:m}})({capabilities:q,dataView:F,dataViews:V,setAppState:se,useNewFieldsApi:!0,columns:re,sort:ie}),me=Object(n.useCallback)((e=>{pe(e,!0)}),[pe]),be=Object(n.useCallback)(((e,t,a)=>{if(F&&X){const n="string"==typeof e?e:e.name;x(F,n,V,q);const r=Object(y.generateFilters)(X,e,t,a,F);return X.addFilters(r)}}),[X,F,V,q]),[{dragging:ge}]=Object(i.c)(),fe=null==ge?void 0:ge.id,he=Object(n.useCallback)((e=>{N(Ve.a.upsertColumn({column:Object(Y.a)(e,J.b),id:o,index:1}))}),[N,o]),ve=Object(n.useMemo)((()=>!(!fe||re.includes(fe))),[fe,re]),ye=Object(n.useCallback)((()=>{fe&&(ce(fe),he(fe))}),[fe,ce,he]),Ee=Object(n.useCallback)((e=>{ce(e.name),he(e.name)}),[ce,he]),xe=Object(n.useCallback)((t=>{e.some((({id:e})=>e===t.name))&&N(Ve.a.removeColumn({columnId:t.name,id:o})),ue(t.name)}),[e,N,ue,o]),je=Object(n.useCallback)((()=>{f()}),[f]),we=Object(n.useCallback)((async()=>{je()}),[je]);return r.a.createElement(st,{className:"timelineBodyContainer",ref:ae},r.a.createElement(de,{container:te,unifiedFieldListSidebarContainerApi:R.current,sidebarPanel:r.a.createElement(ut,{gutterSize:"none"},r.a.createElement(l.EuiFlexItem,{className:"sidebarContainer"},F?r.a.createElement(B,{ref:R,showFieldList:!0,variant:"responsive",getCreationOptions:it,services:ee,dataView:F,fullWidth:!0,allFields:F.fields,workspaceSelectedFieldNames:re,onAddFieldToWorkspace:Ee,onRemoveFieldFromWorkspace:xe,onAddFilter:be,onFieldEdited:we}):null),r.a.createElement(l.EuiHideFor,{sizes:dt},r.a.createElement(p,{grow:!1,className:"thinBorderSplit"}))),mainPanel:r.a.createElement(b,null,r.a.createElement(g,{role:"main",panelRef:ne,paddingSize:"none",borderRadius:"none",hasShadow:!1,hasBorder:!1,color:"transparent"},r.a.createElement(P,{dropTypes:ve?ct.types:void 0,value:ct.value,order:ct.order,onDrop:ye},r.a.createElement(_,{isVisible:ve},r.a.createElement(Q.a,null,r.a.createElement(lt,{columns:e,columnIds:le,rowRenderers:u,timelineId:o,isSortEnabled:t,itemsPerPage:s,itemsPerPageOptions:c,sort:ie,onSort:oe,onSetColumns:me,events:m,refetch:f,onFieldEdited:je,dataLoadingState:h,totalCount:S,onEventClosed:O,expandedDetail:I,showExpandedDetails:k,onChangePage:T,activeTab:a,updatedAt:C,isTextBasedQuery:M,onFilter:be,trailingControlColumns:D,leadingControlColumns:L}))))))}))}))),mt=e=>{const{header:t,isSortEnabled:a,pageInfo:o,columns:s,rowRenderers:l,timelineId:c,itemsPerPage:p,itemsPerPageOptions:m,sort:b,events:g,refetch:f,dataLoadingState:h,totalCount:v,onEventClosed:y,expandedDetail:E,showExpandedDetails:x,onChangePage:j,activeTab:w,updatedAt:S,trailingControlColumns:O,leadingControlColumns:k}=e,[I,T]=Object(n.useState)([]),C=Object(n.useMemo)((()=>I.flat()),[I]);Object(n.useEffect)((()=>{T((e=>{var t;if(0!==o.activePage&&null!==(t=e[o.activePage])&&void 0!==t&&t.length)return e;const a=0===o.activePage?[]:[...e];return a[o.activePage]=g,a}))}),[g,o.activePage]);const M=Object(n.useMemo)((()=>null!=s?s:ot.a),[s]);return r.a.createElement(u,{direction:"column",gutterSize:"s"},r.a.createElement(d,{grow:!1},t),r.a.createElement(d,{className:"unifiedTimelineBody","data-test-subj":"unifiedTimelineBody"},r.a.createElement(i.a,null,r.a.createElement(pt,{columns:M,rowRenderers:l,isSortEnabled:a,timelineId:c,itemsPerPage:p,itemsPerPageOptions:m,sort:b,events:C,refetch:f,dataLoadingState:h,totalCount:v,onEventClosed:y,expandedDetail:E,showExpandedDetails:x,onChangePage:j,activeTab:w,updatedAt:S,isTextBasedQuery:!1,trailingControlColumns:O,leadingControlColumns:k}))))}},1425:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));var n=a(44),r=a(2),i=a.n(r),o=a(45),s=a(64),l=a(355),c=a(266),u=a(121),d=a(129),p=a(664),m=a(272);const b=()=>i.a.createElement(i.a.Fragment,null);b.displayName="PlainRowRenderer";const g={id:u.e.plain,isInstance:e=>!0,renderRow:b};var f=a(180),h=a(622),v=a(7),y=a(19),E=a(1477),x=a(1216),j=a(122),w=a(145),S=a(124),O=a(118),k=a(146),I=a(191),T=a(855),C=a(504);const M=i.a.memo((({id:e,actionsColumnWidth:t,ariaRowindex:a,columnHeaders:n,data:o,ecsData:s,eventIdToNoteIds:l,isEventPinned:c=!1,isEventViewer:u=!1,loadingEventIds:d,notesCount:p,onEventDetailsPanelOpened:m,onRowSelected:b,refetch:g,hasRowRenderers:h,onRuleChange:v,renderCellValue:y,selectedEventIds:E,showCheckboxes:x,showNotes:j,tabType:w,timelineId:S,toggleShowNotes:O,leadingControlColumns:k,trailingControlColumns:I,setEventsLoading:T,setEventsDeleted:M})=>{const F=Object(r.useMemo)((()=>n.map((e=>{var t;return null!==(t=Object(C.b)({data:o,fieldName:e.id}))&&void 0!==t?t:[]})).join(" ")),[n,o]),D=Object(r.useMemo)((()=>k?k.map((e=>e.rowCellRender)):[]),[k]),P=Object(r.useMemo)((()=>D.map(((n,r)=>{const p=k[r].width?k[r].width:t;return i.a.createElement(f.m,{width:p,"data-test-subj":"event-actions-container",tabIndex:0,key:r},n&&i.a.createElement(n,{width:p,rowIndex:a,ariaRowindex:a,checked:Object.keys(E).includes(e),columnId:k[r].id||"",columnValues:F,onRowSelected:b,"data-test-subj":"actions",eventId:e,data:o,index:r,ecsData:s,loadingEventIds:d,onEventDetailsPanelOpened:m,showCheckboxes:x,eventIdToNoteIds:l,isEventPinned:c,isEventViewer:u,onRuleChange:v,refetch:g,showNotes:j,tabType:w,timelineId:S,toggleShowNotes:O,setEventsLoading:T,setEventsDeleted:M,disablePinAction:!1}))}))),[t,a,F,o,s,l,e,c,u,D,k,d,m,b,v,g,E,x,w,S,O,T,M,j]);return i.a.createElement(f.t,{"data-test-subj":"event-column-view"},P,i.a.createElement(C.a,{id:e,actionsColumnWidth:t,ariaRowindex:a,columnHeaders:n,data:o,ecsData:s,hasRowRenderers:h,notesCount:p,renderCellValue:y,tabType:w,timelineId:S,trailingControlColumns:I,leadingControlColumns:k,checked:Object.keys(E).includes(e),columnValues:F,onRowSelected:b,"data-test-subj":"actions",loadingEventIds:d,onEventDetailsPanelOpened:m,showCheckboxes:x,eventIdToNoteIds:l,isEventPinned:c,isEventViewer:u,refetch:g,onRuleChange:v,selectedEventIds:E,showNotes:j,toggleShowNotes:O,setEventsLoading:T,setEventsDeleted:M}))}));M.displayName="EventColumnView";var F=a(148),D=a(299),P=a(1251),L=a(934),N=a(158),R=a(774);const _=[],A=i.a.memo((({children:e})=>{const t=Object(T.b)();return i.a.createElement(f.x,{width:t},e)}));A.displayName="EventsTrSupplementContainerWrapper";const z=({actionsColumnWidth:e,containerRef:t,columnHeaders:a,event:n,eventIdToNoteIds:s,isEventViewer:l=!1,isEventPinned:c=!1,lastFocusedAriaColindex:u,loadingEventIds:p,onRowSelected:b,refetch:g,renderCellValue:h,rowRenderers:v,onRuleChange:T,ariaRowindex:z,selectedEventIds:B,showCheckboxes:V,tabType:$,timelineId:q,leadingControlColumns:G,trailingControlColumns:U,onToggleShowNotes:H})=>{var W,Q,K,J;const{telemetry:Y}=Object(O.j)().services,Z=Object(r.useRef)(null),X=Object(o.useDispatch)(),ee=Object(j.a)("expandableFlyoutDisabled"),{openFlyout:te}=Object(x.a)(),[ae]=Object(r.useState)({timelineID:q,enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0,tabType:$}),[,ne]=Object(r.useState)({}),re=Object(r.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),ie=Object(S.a)((e=>{var t,a;return null!==(t=(null!==(a=re(e,q))&&void 0!==a?a:N.b).expandedDetail)&&void 0!==t?t:{}})),oe=Object(C.c)({data:null==n?void 0:n.data,fieldName:"host.name"}),se=Object(r.useMemo)((()=>oe&&oe.length>0?oe[0]:null),[oe]),le=Object(C.c)({data:null==n?void 0:n.data,fieldName:"host.ip"}),ce=Object(C.c)({data:null==n?void 0:n.data,fieldName:"source.ip"}),ue=Object(C.c)({data:null==n?void 0:n.data,fieldName:"destination.ip"}),de=Object(r.useMemo)((()=>new Set([...null!=le?le:[],...null!=ce?ce:[],...null!=ue?ue:[]])),[ue,ce,le]),pe=ie[null!=$?$:k.d.query],me=n._id,be="eventDetail"===(null==pe?void 0:pe.panelView)&&(null==pe||null===(W=pe.params)||void 0===W?void 0:W.eventId)===me||"hostDetail"===(null==pe?void 0:pe.panelView)&&(null==pe||null===(Q=pe.params)||void 0===Q?void 0:Q.hostName)===se||"networkDetail"===(null==pe?void 0:pe.panelView)&&(null==pe||null===(K=pe.params)||void 0===K?void 0:K.ip)&&(null==de?void 0:de.has(null==pe||null===(J=pe.params)||void 0===J?void 0:J.ip))||!1,ge=Object(r.useMemo)((()=>F.a.notesByIdsSelector()),[]),fe=Object(S.a)(ge),he=s[me]||_,ve=Object(r.useMemo)((()=>F.a.getNotes(fe,he).map((e=>{var t;return{savedObjectId:e.saveObjectId,note:e.note,noteId:e.id,updated:(null!==(t=e.lastEdit)&&void 0!==t?t:e.created).getTime(),updatedBy:e.user}}))),[fe,he]),ye=Object(r.useMemo)((()=>null!=Object(D.a)({data:n.ecs,rowRenderers:v})),[n.ecs,v]),Ee=n._index,xe=Object(r.useCallback)((e=>{null==H||H(e),ne((e=>(e[me]&&setTimeout((()=>{var e;const t=null===(e=Z.current)||void 0===e?void 0:e.querySelector(`.${L.a}`);null==t||t.focus()}),0),{...e,[me]:!e[me]})))}),[H,me]),je=Object(r.useCallback)((()=>{const e={panelView:"eventDetail",params:{eventId:me,indexName:Ee,refetch:g}};ee?X(d.a.toggleDetailPanel({...e,tabType:$,id:q})):(te({right:{id:w.e,params:{id:me,indexName:Ee,scopeId:q}}}),Y.reportDetailsFlyoutOpened({location:q,panel:"right"}))}),[me,Ee,g,ee,te,q,Y,X,$]),we=Object(r.useCallback)((({eventIds:e,isLoading:t})=>{X(d.a.setEventsLoading({id:q,eventIds:e,isLoading:t}))}),[X,q]),Se=Object(r.useCallback)((({eventIds:e,isDeleted:t})=>{X(d.a.setEventsDeleted({id:q,eventIds:e,isDeleted:t}))}),[X,q]);return i.a.createElement(R.a.Provider,{value:ae},i.a.createElement(f.u,{$ariaRowindex:z,className:I.d,"data-test-subj":"event",eventType:Object(m.e)(n.ecs),isBuildingBlockType:Object(E.c)(n.ecs),isEvenEqlSequence:Object(m.h)(n.ecs),isExpanded:be,ref:Z,showLeftBorder:!l},i.a.createElement(M,{id:me,actionsColumnWidth:e,ariaRowindex:z,columnHeaders:a,data:n.data,ecsData:n.ecs,eventIdToNoteIds:s,hasRowRenderers:ye,isEventPinned:c,isEventViewer:l,loadingEventIds:p,notesCount:ve.length,onEventDetailsPanelOpened:je,onRowSelected:b,refetch:g,renderCellValue:h,onRuleChange:T,selectedEventIds:B,showCheckboxes:V,showNotes:!0,tabType:$,timelineId:q,toggleShowNotes:xe,leadingControlColumns:G,trailingControlColumns:U,setEventsLoading:we,setEventsDeleted:Se}),i.a.createElement(A,null,i.a.createElement(y.EuiFlexGroup,{gutterSize:"none",justifyContent:"center"},i.a.createElement(y.EuiFlexItem,{grow:!1},i.a.createElement(f.w,null,i.a.createElement(P.a,{ariaRowindex:z,containerRef:t,event:n,lastFocusedAriaColindex:u,rowRenderers:v,timelineId:q})))))))},B=i.a.memo(z),V=({actionsColumnWidth:e,columnHeaders:t,containerRef:a,data:n,eventIdToNoteIds:r,id:o,isEventViewer:s=!1,lastFocusedAriaColindex:l,loadingEventIds:c,onRowSelected:u,pinnedEventIds:d,refetch:p,onRuleChange:b,renderCellValue:g,rowRenderers:h,selectedEventIds:y,showCheckboxes:E,tabType:x,leadingControlColumns:j,trailingControlColumns:w,onToggleShowNotes:S})=>i.a.createElement(f.j,{"data-test-subj":"events"},n.map(((n,f)=>{var O,k;return i.a.createElement(B,{actionsColumnWidth:e,ariaRowindex:f+2,columnHeaders:t,containerRef:a,event:n,eventIdToNoteIds:r,isEventPinned:Object(m.c)({eventId:n._id,pinnedEventIds:d}),isEventViewer:s,key:`${o}_${x}_${n._id}_${n._index}_${Object(v.isEmpty)(null===(O=n.ecs.eql)||void 0===O?void 0:O.sequenceNumber)?"":null===(k=n.ecs.eql)||void 0===k?void 0:k.sequenceNumber}`,lastFocusedAriaColindex:l,loadingEventIds:c,onRowSelected:u,renderCellValue:g,refetch:p,rowRenderers:h,onRuleChange:b,selectedEventIds:y,showCheckboxes:E,tabType:x,timelineId:o,leadingControlColumns:j,trailingControlColumns:w,onToggleShowNotes:S})}))),$=i.a.memo(V);var q=a(16),G=a(169);const U=i.a.memo((({activePage:e,browserFields:t,data:a,id:b,isEventViewer:v=!1,onRuleChange:y,refetch:E,renderCellValue:x,rowRenderers:j,sort:w,tabType:S,totalPages:O,leadingControlColumns:k=[],trailingControlColumns:I=[],onToggleShowNotes:T})=>{const C=Object(o.useDispatch)(),M=Object(r.useRef)(null),{columns:F,eventIdToNoteIds:D,excludedRowRendererIds:P,isSelectAllChecked:L,loadingEventIds:N,pinnedEventIds:R,selectedEventIds:_,show:A,queryFields:z,selectAll:B}=Object(o.useSelector)((e=>Object(G.selectTimelineById)(e,b))),V=Object(r.useMemo)((()=>Object(p.b)(F,t)),[t,F]),U=Object(q.b)().isEnterprise()?6:5,H=Object(r.useCallback)((({eventIds:e,isSelected:t})=>{C(d.a.setSelected({id:b,eventIds:Object(m.d)(a,e,z),isSelected:t,isSelectAllChecked:t&&Object.keys(_).length+1===a.length}))}),[a,C,b,z,_]),W=Object(r.useCallback)((({isSelected:e})=>C(e?d.a.setSelected({id:b,eventIds:Object(m.d)(a,a.map((e=>e._id)),z),isSelected:e,isSelectAllChecked:e}):d.a.clearSelected({id:b}))),[a,C,b,z]);Object(r.useEffect)((()=>{B&&!L&&W({isSelected:!0})}),[L,W,B]);const Q=Object(r.useMemo)((()=>P&&P.length===u.d?[g]:P?j.filter((e=>!P.includes(e.id))):j),[P,j]),K=Object(r.useMemo)((()=>Object(l.c)(U)),[U]),J=Object(r.useMemo)((()=>V.reduce(((e,t)=>{var a;return e+(null!==(a=t.initialWidth)&&void 0!==a?a:c.a)}),0)),[V]),Y=Object(r.useMemo)((()=>k?k.reduce(((e,t)=>t.width?e+t.width:e+K),0):0),[K,k]),Z=Object(r.useMemo)((()=>I?I.reduce(((e,t)=>t.width?e+t.width:e+K),0):0),[K,I]),X=Object(r.useMemo)((()=>J+Y+Z),[J,Y,Z]),[ee]=Object(r.useState)(s.FIRST_ARIA_INDEX),te=Object(r.useMemo)((()=>V.length+I.length+k.length),[V,I,k]),ae=Object(r.useCallback)((e=>{Object(s.onKeyDownFocusHandler)({colindexAttribute:s.ARIA_COLINDEX_ATTRIBUTE,containerElement:M.current,event:e,maxAriaColindex:V.length+1,maxAriaRowindex:a.length+1,onColumnFocused:n.noop,rowindexAttribute:s.ARIA_ROWINDEX_ATTRIBUTE})}),[V.length,M,a.length]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.z,{"data-test-subj":"timeline-body",ref:M},i.a.createElement(f.i,{$activePage:e,$columnCount:te,"data-test-subj":`${S}-events-table`,columnWidths:X,onKeyDown:ae,$rowCount:a.length,$totalPages:O},i.a.createElement(h.a,{actionsColumnWidth:K,browserFields:t,columnHeaders:V,isEventViewer:v,isSelectAllChecked:L,onSelectAll:W,show:A,showEventsSelect:!1,showSelectAllCheckbox:!1,sort:w,tabType:S,timelineId:b,leadingControlColumns:k,trailingControlColumns:I}),i.a.createElement($,{containerRef:M,actionsColumnWidth:K,columnHeaders:V,data:a,eventIdToNoteIds:D,id:b,isEventViewer:v,lastFocusedAriaColindex:ee,loadingEventIds:N,onRowSelected:H,pinnedEventIds:R,refetch:E,renderCellValue:x,rowRenderers:Q,onRuleChange:y,selectedEventIds:_,showCheckboxes:!1,leadingControlColumns:k,trailingControlColumns:I,tabType:S,onToggleShowNotes:T}))),i.a.createElement(f.A,null))}));U.displayName="StatefulBody"},1433:function(e,t,a){"use strict";a.d(t,"b",(function(){return k})),a.d(t,"a",(function(){return P}));var n=a(19),r=a(42),i=a(2),o=a.n(i),s=a(41),l=a.n(s),c=a(45),u=a(191),d=a(4);d.i18n.translate("xpack.securitySolution.footer.events",{defaultMessage:"Events"});const p=d.i18n.translate("xpack.securitySolution.footer.of",{defaultMessage:"of"}),m=d.i18n.translate("xpack.securitySolution.footer.rows",{defaultMessage:"rows"}),b=d.i18n.translate("xpack.securitySolution.footer.loadingLabel",{defaultMessage:"Loading"}),g=d.i18n.translate("xpack.securitySolution.footer.totalCountOfEvents",{defaultMessage:"events"}),f=d.i18n.translate("xpack.securitySolution.footer.autoRefreshActiveDescription",{defaultMessage:"Auto-Refresh Active"}),h=d.i18n.translate("xpack.securitySolution.footer.loadingEventsDataLabel",{defaultMessage:"Loading Events"});var v=a(129),y=a(124),E=a(118),x=a(1241);const j=l()(n.EuiFlexGroup).attrs((({height:e})=>({style:{height:`${e}px`}}))).withConfig({displayName:"FooterContainer",componentId:"sc-4whhh0-0"})(["flex:0 0 auto;"]);j.displayName="FooterContainer";const w=l()(n.EuiFlexGroup).withConfig({displayName:"FooterFlexGroup",componentId:"sc-4whhh0-1"})(["height:35px;width:100%;"]);w.displayName="FooterFlexGroup";const S=l.a.div.withConfig({displayName:"LoadingPanelContainer",componentId:"sc-4whhh0-2"})(["padding-top:3px;"]);S.displayName="LoadingPanelContainer";const O=l.a.div.withConfig({displayName:"ServerSideEventCount",componentId:"sc-4whhh0-3"})(["margin:0 5px 0 5px;"]);O.displayName="ServerSideEventCount";const k=40,I=({closePopover:e,documentType:t,footerText:a,isOpen:r,items:s,itemsCount:l,onClick:c,serverSideEventCount:d})=>{const m=Object(i.useMemo)((()=>d>0?d:0),[d]);return o.a.createElement("h5",null,o.a.createElement(n.EuiPopover,{className:"footer-popover",id:"customizablePagination","data-test-subj":"timelineSizeRowPopover",button:o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiBadge,{"data-test-subj":"local-events-count",color:"hollow"},l,o.a.createElement(n.EuiButtonEmpty,{className:u.c,flush:"both",size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:c,"data-test-subj":"local-events-count-button"})),` ${p} `),isOpen:r,closePopover:e,panelPaddingSize:"none"},o.a.createElement(n.EuiContextMenuPanel,{items:s,"data-test-subj":"timelinePickSizeRow"})),o.a.createElement(n.EuiToolTip,{content:o.a.createElement(o.a.Fragment,null,m," ",a)},o.a.createElement(O,null,o.a.createElement(n.EuiBadge,{color:"hollow","data-test-subj":"server-side-event-count"},m)," ",t)))};I.displayName="EventsCountComponent";const T=o.a.memo(I);T.displayName="EventsCount";const C=l.a.div.withConfig({displayName:"TimelinePaginationContainer",componentId:"sc-4whhh0-4"})(["ul.euiPagination__list{li.euiPagination__item:last-child{",";}}"],(({hideLastPage:e})=>e?"display:none":"")),M=({activePage:e,isLoading:t,onPageClick:a,totalCount:r,totalPages:i})=>t?o.a.createElement(o.a.Fragment,null,`${b}...`):i?o.a.createElement(C,{hideLastPage:r>9999},o.a.createElement(n.EuiPagination,{"data-test-subj":"timeline-pagination",pageCount:i,activePage:e,onPageClick:a})):null;M.displayName="PagingControlComponent";const F=o.a.memo(M);F.displayName="PagingControl";const D=({activePage:e,updatedAt:t,height:a,id:s,isLive:l,isLoading:u,itemsCount:d,itemsPerPage:p,itemsPerPageOptions:b,onChangePage:O,totalCount:k})=>{const I=Object(c.useDispatch)(),{timelines:C}=Object(E.j)().services,[M,D]=Object(i.useState)(!1),[P,L]=Object(i.useState)(!1),N=Object(i.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),{documentType:R=g,loadingText:_=h,footerText:A=g}=Object(y.a)((e=>N(e,s))),z=Object(i.useCallback)((e=>{L(!0),O(e)}),[O]),B=Object(i.useCallback)((()=>D(!M)),[M,D]),V=Object(i.useCallback)((()=>D(!1)),[D]),$=Object(i.useCallback)((e=>I(v.a.updateItemsPerPage({id:s,itemsPerPage:e}))),[I,s]),q=Object(i.useMemo)((()=>b&&b.map((e=>o.a.createElement(n.EuiContextMenuItem,{key:e,icon:p===e?"check":"empty","data-test-subj":`items-per-page-option-${e}`,onClick:()=>{V(),$(e)}},`${e} ${m}`)))),[V,p,b,$]),G=Object(i.useMemo)((()=>Math.ceil(k/p)),[p,k]);return Object(i.useEffect)((()=>{P&&!u&&L(!1)}),[u,P]),u&&!P?o.a.createElement(S,null,C.getLoadingPanel({dataTestSubj:"LoadingPanelTimeline",height:"35px",showBorder:!1,text:_,width:"100%"})):o.a.createElement(j,{"data-test-subj":"timeline-footer",direction:"column",gutterSize:"none",height:a,justifyContent:"spaceAround"},o.a.createElement(w,{alignItems:"center","data-test-subj":"footer-flex-group",direction:"row",gutterSize:"none",justifyContent:"spaceBetween"},o.a.createElement(n.EuiFlexItem,{"data-test-subj":"event-count-container",grow:!1},o.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"events-count",direction:"row",gutterSize:"none"},o.a.createElement(T,{closePopover:V,documentType:R,footerText:A,isOpen:M,items:q,itemsCount:d,onClick:B,serverSideEventCount:k}))),o.a.createElement(n.EuiFlexItem,{"data-test-subj":"last-updated-container",grow:!1},o.a.createElement(x.a,{updatedAt:t})),o.a.createElement(n.EuiFlexItem,{grow:!1},l?o.a.createElement(n.EuiText,{size:"s","data-test-subj":"is-live-on-message"},o.a.createElement("b",null,f," ",o.a.createElement(n.EuiIconTip,{color:"text",content:o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.footer.autoRefreshActiveTooltip",defaultMessage:"While auto-refresh is enabled, timeline will show you the latest {numberOfItems} events that match your query.",values:{numberOfItems:d}}),type:"iInCircle"}))):o.a.createElement(F,{totalCount:k,totalPages:G,activePage:e,onPageClick:z,isLoading:u}))))};D.displayName="FooterComponent";const P=o.a.memo(D);P.displayName="Footer"},1434:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(16),l=a(127),c=a(132),u=a(122),d=a(938),p=a(698),m=a(272),b=a(355);const g=()=>{},f=Object(i.memo)((function(e){const{rowIndex:t,pinnedEventIds:a}=e,n=Object(i.useMemo)((()=>Object(m.c)({eventId:e.eventId,pinnedEventIds:a})),[e.eventId,a]);return o.a.createElement(b.a,{action:e.action,columnId:e.columnId,columnValues:"columnValues",data:e.data,ecsData:e.ecsData,eventId:e.eventId,eventIdToNoteIds:e.eventIdToNoteIds,index:t,isEventPinned:n,isEventViewer:!1,refetch:e.refetch,rowIndex:t,setEventsDeleted:g,setEventsLoading:g,onEventDetailsPanelOpened:g,onRowSelected:g,onRuleChange:g,showCheckboxes:!1,showNotes:!0,timelineId:e.timelineId,ariaRowindex:t,checked:!1,loadingEventIds:e.loadingEventIds,toggleShowNotes:e.toggleShowNotes,disableExpandAction:!0,disablePinAction:!1})}));var h=a(1243);const v=[],y=()=>{},E=({isSelected:e})=>{},x=({columns:e,sort:t,timelineId:a,activeTab:n,refetch:m,events:b,pinnedEventIds:g,eventIdToNoteIds:x,onToggleShowNotes:j})=>{const{browserFields:w}=Object(c.a)(l.SourcererScopeName.timeline),S=Object(u.a)("unifiedComponentsInTimelineDisabled"),O=Object(s.b)().isEnterprise()?6:5,{localColumns:k}=Object(h.a)(e),I=O-1;return Object(i.useMemo)((()=>S?Object(d.a)(O).map((e=>({...e,headerCellRender:p.a}))):Object(d.a)(I).map((e=>({...e,headerCellRender:function(i){return o.a.createElement(p.a,r()({width:e.width,browserFields:w,columnHeaders:k,isEventViewer:!1,isSelectAllChecked:!1,onSelectAll:E,showEventsSelect:!1,showSelectAllCheckbox:!1,showFullScreenToggle:!1,sort:t,tabType:n},i,{timelineId:a}))},rowCellRender:e=>{var t,n;return"rowIndex"in e&&e.rowIndex>=b.length?o.a.createElement(o.a.Fragment,null):(e.setCellProps({className:e.expandedEventId===(null===(t=b[e.rowIndex])||void 0===t?void 0:t._id)?"unifiedDataTable__cell--expanded":""}),o.a.createElement(f,{rowIndex:e.rowIndex,columnId:e.columnId,timelineId:a,ariaRowindex:e.rowIndex,checked:!1,columnValues:"",data:b[e.rowIndex].data,ecsData:b[e.rowIndex].ecs,loadingEventIds:v,eventId:null===(n=b[e.rowIndex])||void 0===n?void 0:n._id,index:e.rowIndex,onEventDetailsPanelOpened:y,onRowSelected:y,refetch:m,showCheckboxes:!1,setEventsLoading:y,setEventsDeleted:y,pinnedEventIds:g,eventIdToNoteIds:x,toggleShowNotes:j}))}})))),[S,I,w,k,t,n,a,m,b,g,x,j,O])}},1435:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(2),r=a.n(n),i=a(19),o=a(41),s=a.n(o),l=a(64),c=a(1329),u=a(742),d=a(430);const p=s.a.div.withConfig({displayName:"AddNoteContainer",componentId:"sc-1cqe11a-0"})([""]);p.displayName="AddNoteContainer",s.a.div.withConfig({displayName:"NoteContainer",componentId:"sc-1cqe11a-1"})(["margin-top:5px;"]).displayName="NoteContainer";const m=s()(i.EuiPanel).withConfig({displayName:"NoteCardsCompContainer",componentId:"sc-1cqe11a-2"})(["border:none;background-color:transparent;box-shadow:none;&.euiPanel--plain{background-color:transparent;}"]);m.displayName="NoteCardsCompContainer";const b=s()(i.EuiFlexGroup).withConfig({displayName:"NotesContainer",componentId:"sc-1cqe11a-3"})(["margin-bottom:5px;"]);b.displayName="NotesContainer";const g=r.a.memo((({ariaRowindex:e,associateNote:t,className:a,notes:o,showAddNote:s,toggleShowAddNote:g,eventId:f,timelineId:h,onCancel:v,showToggleEventDetailsAction:y=!0})=>{const[E,x]=Object(n.useState)(""),j=Object(n.useCallback)((e=>{t(e),g&&(null!=f?g(f):g())}),[t,g,f]),w=Object(n.useCallback)((()=>{null==v||v(),g&&(null!=f?g(f):g())}),[f,g,v]);return r.a.createElement(m,{className:a,"data-test-subj":"note-cards",hasShadow:!1,paddingSize:"none"},o.length?r.a.createElement(u.b,{"data-test-subj":"note-previews-container"},r.a.createElement(b,{className:Object(l.getNotesContainerClassName)(e),"data-test-subj":"notes",direction:"column",gutterSize:"none"},r.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,d.h(e))),r.a.createElement(u.a,{timelineId:h,notes:o,showToggleEventDetailsAction:y}))):null,s?r.a.createElement(p,{"data-test-subj":"add-note-container"},r.a.createElement(c.a,{associateNote:j,newNote:E,onCancelAddNote:w,updateNewNote:x})):null)}));g.displayName="NoteCards";var f=a(510);const h=s()(i.EuiFlyoutResizable).withConfig({displayName:"NotesFlyoutContainer",componentId:"sc-nl8x75-0"})(["width:30%;z-index:"," !important;"],(e=>{var t;return(null!==(t=e.theme.eui.euiZFlyout.toFixed())&&void 0!==t?t:1e3)+2})),v=r.a.memo((function(e){const{eventId:t,toggleShowAddNote:a,show:n,onClose:o,associateNote:s,notes:l,timelineId:c,onCancel:u}=e,d=Object(i.useGeneratedHtmlId)({prefix:"notesFlyoutTitle"});return n&&t?r.a.createElement(i.EuiOutsideClickDetector,{onOutsideClick:o},r.a.createElement(h,{ownFocus:!1,className:"timeline-notes-flyout","data-test-subj":"timeline-notes-flyout",onClose:o,"aria-labelledby":d,minWidth:500,maxWidth:1400},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",null,f.b))),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(g,{ariaRowindex:0,associateNote:s,className:"notes-in-flyout","data-test-subj":"note-cards",notes:l,showAddNote:!0,toggleShowAddNote:a,eventId:t,timelineId:c,onCancel:u,showToggleEventDetailsAction:!1})))):null}))},1477:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return l}));var n=a(44);const r=(e,t,a,n)=>e.reduce(((e,r)=>({...e,...n&&t.includes(r._id)?{[r._id]:r.data.filter((e=>a.includes(e.field)))}:{}})),{}),i=e=>{var t,a;return!Object(n.isEmpty)(null===(t=e.kibana)||void 0===t||null===(a=t.alert)||void 0===a?void 0:a.building_block_type)},o=e=>{switch(e){case"asc":case"desc":return e;default:return"desc"}},s=({columns:e,columnHeaders:t})=>e.map((({id:e,direction:a})=>{var n,r;const i=t.find((t=>t.id===e)),o=null!==(n=null==i?void 0:i.type)&&void 0!==n?n:"",s=null!==(r=null==i?void 0:i.esTypes)&&void 0!==r?r:[];return{columnId:e,columnType:o,esTypes:s,sortDirection:a}})),l=(e,t,a)=>{i(e)?a({style:{backgroundColor:`${t.eui.euiColorHighlight}`}}):a({style:{backgroundColor:"inherit"}})}},1479:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s}));var n=a(4),r=a(233),i=a(3);async function o({esqlQuery:e,search:t,signal:a}){try{var o;const s=await async function({esqlQuery:e,search:t,signal:a}){try{var r;return null!==(r=(await Object(i.lastValueFrom)(t({params:{query:`${e} | limit 0`}},{abortSignal:a,strategy:"esql_async"}))).rawResponse.columns)&&void 0!==r?r:[]}catch(e){throw new Error(n.i18n.translate("esqlUtils.columnsErrorMsg",{defaultMessage:"Unable to load columns. {errorMessage}",values:{errorMessage:e.message}}))}}({esqlQuery:e,search:t,signal:a});return null!==(o=s.map((({name:e,type:t})=>({id:e,name:e,meta:{type:Object(r.d)(t),esType:t}}))))&&void 0!==o?o:[]}catch(e){throw new Error(n.i18n.translate("esqlUtils.columnsErrorMsg",{defaultMessage:"Unable to load columns. {errorMessage}",values:{errorMessage:e.message}}))}}async function s({esqlQuery:e,search:t,signal:a,filter:n,dropNullColumns:r}){const o=await Object(i.lastValueFrom)(t({params:{...n?{filter:n}:{},query:e,...r?{dropNullColumns:!0}:{}}},{abortSignal:a,strategy:"esql_async"}));return{response:o.rawResponse,params:o.requestParams}}},155:function(e,t,a){"use strict";e.exports=function(e){return e<-2}},160:function(e,t,a){"use strict";var n=a(220);e.exports=function(e,t,a,r){var i=r?r-1:1/0,o=0;return function(r){return n(r)?(e.enter(a),s(r)):t(r)};function s(r){return n(r)&&o++<i?(e.consume(r),s):(e.exit(a),t(r))}}},1723:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(7);const r=["_type","_source"];function i(e,t,a,r,o){for(const s in t){if(!t.hasOwnProperty(s))continue;const l=t[s],c=a+s,u=null==r?void 0:r.fields.getByName(c);if(!1===(null==o?void 0:o.shallow)){const t="nested"===(null==u?void 0:u.type);if(Array.isArray(l)&&!t){for(let t=0;t<l.length;t++){const a=l[t];Object(n.isPlainObject)(a)&&i(e,a,c+".",r,o)}continue}}else if(void 0!==e[c])continue;const d=u&&"conflict"!==u.type,p=!Object(n.isPlainObject)(l);d||p?e[c]?Array.isArray(e[c])?e[c].push(l):e[c]=[e[c],l]:e[c]=l:i(e,l,c+".",r,o)}}function o(e,t,a){const n={};if(i(n,e.fields||{},"",t,a),!1!==(null==a?void 0:a.source)&&e._source)i(n,e._source,"",t,a);else if(null!=a&&a.includeIgnoredValues&&e.ignored_field_values)for(const t in e.ignored_field_values){if(!e.ignored_field_values.hasOwnProperty(t))continue;const a=e.ignored_field_values[t];n[t]?Array.isArray(n[t])?n[t]=[...n[t],...a]:n[t]=[n[t],...a]:n[t]=a}if(null!=t&&t.metaFields)for(let a=0;a<(null==t?void 0:t.metaFields.length);a++){const i=null==t?void 0:t.metaFields[a];r.includes(i)||"_"!==i.charAt(0)||(n[i]=e[i])}return function(e,t){function a(e,a){var n,r;const i=null==t||null===(n=t.metaFields)||void 0===n?void 0:n.includes(String(e)),o=null==t||null===(r=t.metaFields)||void 0===r?void 0:r.includes(String(a));return i&&o?String(e).localeCompare(String(a)):i?1:o?-1:String(e).localeCompare(String(a))}return new Proxy(e,{ownKeys:e=>Reflect.ownKeys(e).sort(a)})}(n,t)}},1724:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a.n(n),i=(a(52),a(1198));a(43);const o={reorderedItems:[],direction:"-",draggingHeight:i.b,isReorderOn:!1},s=r.a.createContext([o,()=>()=>{}])},1744:function(e,t,a){"use strict";a.d(t,"c",(function(){return x})),a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return k}));var n=a(2),r=a.n(n),i=a(19),o=a(4),s=a(1198);const l={selectedTarget:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,canSwap:l,canDuplicate:c,canCombine:u,layerNumber:d})=>l||c?o.i18n.translate("domDragDrop.announce.selectedTarget.replaceMain",{defaultMessage:"You're dragging {label} from {groupLabel} at position {position} in layer {layerNumber} over {dropLabel} from {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Press space or enter to replace {dropLabel} with {label}.{duplicateCopy}{swapCopy}{combineCopy}",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,duplicateCopy:c?p:"",swapCopy:l?m:"",combineCopy:u?b:"",layerNumber:n,dropLayerNumber:d}}):o.i18n.translate("domDragDrop.announce.selectedTarget.replace",{defaultMessage:"Replace {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber} with {label}. Press space or enter to replace.",values:{label:e,dropLabel:r,dropGroupLabel:i,dropPosition:s,dropLayerNumber:d}}),dropped:({label:e},{label:t,groupLabel:a,position:n,layerNumber:r})=>o.i18n.translate("domDragDrop.announce.duplicated.replace",{defaultMessage:"Replaced {dropLabel} with {label} in {groupLabel} at position {position} in layer {dropLayerNumber}",values:{label:e,dropLabel:t,groupLabel:a,position:n,dropLayerNumber:r}})},c={selectedTarget:({label:e,groupLabel:t,layerNumber:a},{groupLabel:n,position:r})=>t!==n?o.i18n.translate("domDragDrop.announce.selectedTarget.duplicated",{defaultMessage:"Duplicate {label} to {dropGroupLabel} group at position {position} in layer {layerNumber}. Hold Alt or Option and press space or enter to duplicate",values:{label:e,dropGroupLabel:n,position:r,layerNumber:a}}):o.i18n.translate("domDragDrop.announce.selectedTarget.duplicatedInGroup",{defaultMessage:"Duplicate {label} to {dropGroupLabel} group at position {position} in layer {layerNumber}. Press space or enter to duplicate",values:{label:e,dropGroupLabel:n,position:r,layerNumber:a}}),dropped:({label:e},{groupLabel:t,position:a,layerNumber:n})=>o.i18n.translate("domDragDrop.announce.dropped.duplicated",{defaultMessage:"Duplicated {label} in {groupLabel} group at position {position} in layer {layerNumber}",values:{label:e,groupLabel:t,position:a,layerNumber:n}})},u={selectedTarget:({label:e,groupLabel:t,position:a},{position:n})=>a===n?o.i18n.translate("domDragDrop.announce.selectedTarget.reorderedBack",{defaultMessage:"{label} returned to its initial position {prevPosition}",values:{label:e,prevPosition:a}}):o.i18n.translate("domDragDrop.announce.selectedTarget.reordered",{defaultMessage:"Reorder {label} in {groupLabel} group from position {prevPosition} to position {position}. Press space or enter to reorder",values:{label:e,groupLabel:t,position:n,prevPosition:a}}),dropped:({label:e,groupLabel:t,position:a},{position:n})=>o.i18n.translate("domDragDrop.announce.dropped.reordered",{defaultMessage:"Reordered {label} in {groupLabel} group from position {prevPosition} to position {position}",values:{label:e,groupLabel:t,position:n,prevPosition:a}})},d={selectedTarget:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,canSwap:l,canDuplicate:c,canCombine:u,layerNumber:d})=>l||c||u?o.i18n.translate("domDragDrop.announce.selectedTarget.combineMain",{defaultMessage:"You're dragging {label} from {groupLabel} at position {position} in layer {layerNumber} over {dropLabel} from {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Press space or enter to combine {dropLabel} with {label}.{duplicateCopy}{swapCopy}{combineCopy}",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,duplicateCopy:c?p:"",swapCopy:l?m:"",combineCopy:u?b:"",layerNumber:n,dropLayerNumber:d}}):o.i18n.translate("domDragDrop.announce.selectedTarget.combine",{defaultMessage:"Combine {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber} with {label}. Press space or enter to combine.",values:{label:e,dropLabel:r,dropGroupLabel:i,dropPosition:s,dropLayerNumber:d}}),dropped:({label:e},{label:t,groupLabel:a,position:n,layerNumber:r})=>o.i18n.translate("domDragDrop.announce.duplicated.combine",{defaultMessage:"Combine {dropLabel} with {label} in {groupLabel} at position {position} in layer {dropLayerNumber}",values:{label:e,dropLabel:t,groupLabel:a,position:n,dropLayerNumber:r}})},p=o.i18n.translate("domDragDrop.announce.duplicate.short",{defaultMessage:" Hold alt or option to duplicate."}),m=o.i18n.translate("domDragDrop.announce.swap.short",{defaultMessage:" Hold shift to swap."}),b=o.i18n.translate("domDragDrop.announce.combine.short",{defaultMessage:" Hold control to combine"}),g={selectedTarget:{reorder:u.selectedTarget,duplicate_compatible:c.selectedTarget,field_replace:l.selectedTarget,field_combine:d.selectedTarget,replace_compatible:l.selectedTarget,replace_incompatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,nextLabel:l,canSwap:c,canDuplicate:u,canCombine:d,layerNumber:g})=>c||u||d?o.i18n.translate("domDragDrop.announce.selectedTarget.replaceIncompatibleMain",{defaultMessage:"You're dragging {label} from {groupLabel} at position {position} in layer {layerNumber} over {dropLabel} from {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Press space or enter to convert {label} to {nextLabel} and replace {dropLabel}.{duplicateCopy}{swapCopy}{combineCopy}",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,nextLabel:l,duplicateCopy:u?p:"",swapCopy:c?m:"",combineCopy:d?b:"",layerNumber:n,dropLayerNumber:g}}):o.i18n.translate("domDragDrop.announce.selectedTarget.replaceIncompatible",{defaultMessage:"Convert {label} to {nextLabel} and replace {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Press space or enter to replace",values:{label:e,dropLabel:r,dropGroupLabel:i,dropPosition:s,nextLabel:l,dropLayerNumber:g}}),move_incompatible:({label:e,groupLabel:t,position:a,layerNumber:n},{groupLabel:r,position:i,nextLabel:s,canSwap:l,canDuplicate:c,layerNumber:u})=>l||c?o.i18n.translate("domDragDrop.announce.selectedTarget.moveIncompatibleMain",{defaultMessage:"You're dragging {label} from {groupLabel} at position {position} in layer {layerNumber} over position {dropPosition} in {dropGroupLabel} group in layer {dropLayerNumber}. Press space or enter to convert {label} to {nextLabel} and move.{duplicateCopy}",values:{label:e,groupLabel:t,position:a,dropGroupLabel:r,dropPosition:i,nextLabel:s,duplicateCopy:c?p:"",layerNumber:n,dropLayerNumber:u}}):o.i18n.translate("domDragDrop.announce.selectedTarget.moveIncompatible",{defaultMessage:"Convert {label} to {nextLabel} and move to {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Press space or enter to move",values:{label:e,dropGroupLabel:r,dropPosition:i,nextLabel:s,dropLayerNumber:u}}),move_compatible:({label:e,groupLabel:t,position:a},{groupLabel:n,position:r,canSwap:i,canDuplicate:s,layerNumber:l})=>i||s?o.i18n.translate("domDragDrop.announce.selectedTarget.moveCompatibleMain",{defaultMessage:"You're dragging {label} from {groupLabel} at position {position} over position {dropPosition} in {dropGroupLabel} group in layer {dropLayerNumber}. Press space or enter to move.{duplicateCopy}",values:{label:e,groupLabel:t,position:a,dropGroupLabel:n,dropPosition:r,duplicateCopy:s?p:"",dropLayerNumber:l}}):o.i18n.translate("domDragDrop.announce.selectedTarget.moveCompatible",{defaultMessage:"Move {label} to {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Press space or enter to move",values:{label:e,dropGroupLabel:n,dropPosition:r,dropLayerNumber:l}}),duplicate_incompatible:({label:e},{groupLabel:t,position:a,nextLabel:n,layerNumber:r})=>o.i18n.translate("domDragDrop.announce.selectedTarget.duplicateIncompatible",{defaultMessage:"Convert copy of {label} to {nextLabel} and add to {groupLabel} group at position {position} in layer {dropLayerNumber}. Hold Alt or Option and press space or enter to duplicate",values:{label:e,groupLabel:t,position:a,nextLabel:n,dropLayerNumber:r}}),replace_duplicate_incompatible:({label:e},{label:t,groupLabel:a,position:n,nextLabel:r,layerNumber:i})=>o.i18n.translate("domDragDrop.announce.selectedTarget.replaceDuplicateIncompatible",{defaultMessage:"Convert copy of {label} to {nextLabel} and replace {dropLabel} in {groupLabel} group at position {position} in layer {dropLayerNumber}. Hold Alt or Option and press space or enter to duplicate and replace",values:{label:e,groupLabel:a,position:n,dropLabel:t,nextLabel:r,dropLayerNumber:i}}),replace_duplicate_compatible:({label:e},{label:t,groupLabel:a,position:n,layerNumber:r})=>o.i18n.translate("domDragDrop.announce.selectedTarget.replaceDuplicateCompatible",{defaultMessage:"Duplicate {label} and replace {dropLabel} in {groupLabel} at position {position} in layer {dropLayerNumber}. Hold Alt or Option and press space or enter to duplicate and replace",values:{label:e,dropLabel:t,groupLabel:a,position:n,dropLayerNumber:r}}),swap_compatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,layerNumber:l})=>o.i18n.translate("domDragDrop.announce.selectedTarget.swapCompatible",{defaultMessage:"Swap {label} in {groupLabel} group at position {position} in layer {layerNumber} with {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Hold Shift and press space or enter to swap",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,layerNumber:n,dropLayerNumber:l}}),swap_incompatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,nextLabel:l,layerNumber:c})=>o.i18n.translate("domDragDrop.announce.selectedTarget.swapIncompatible",{defaultMessage:"Convert {label} to {nextLabel} in {groupLabel} group at position {position} in layer {layerNumber} and swap with {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Hold Shift and press space or enter to swap",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,nextLabel:l,layerNumber:n,dropLayerNumber:c}}),combine_compatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,layerNumber:l})=>o.i18n.translate("domDragDrop.announce.selectedTarget.combineCompatible",{defaultMessage:"Combine {label} in {groupLabel} group at position {position} in layer {layerNumber} with {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Hold Control and press space or enter to combine",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,layerNumber:n,dropLayerNumber:l}}),combine_incompatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,nextLabel:l,layerNumber:c})=>o.i18n.translate("domDragDrop.announce.selectedTarget.combineIncompatible",{defaultMessage:"Convert {label} to {nextLabel} in {groupLabel} group at position {position} in layer {layerNumber} and combine with {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}. Hold Control and press space or enter to combine",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,nextLabel:l,dropLayerNumber:c,layerNumber:n}})},dropped:{reorder:u.dropped,duplicate_compatible:c.dropped,field_replace:l.dropped,field_combine:d.dropped,replace_compatible:l.dropped,replace_incompatible:({label:e},{label:t,groupLabel:a,position:n,nextLabel:r,layerNumber:i})=>o.i18n.translate("domDragDrop.announce.dropped.replaceIncompatible",{defaultMessage:"Converted {label} to {nextLabel} and replaced {dropLabel} in {groupLabel} group at position {position} in layer {dropLayerNumber}",values:{label:e,nextLabel:r,dropLabel:t,groupLabel:a,position:n,dropLayerNumber:i}}),move_incompatible:({label:e},{groupLabel:t,position:a,nextLabel:n,layerNumber:r})=>o.i18n.translate("domDragDrop.announce.dropped.moveIncompatible",{defaultMessage:"Converted {label} to {nextLabel} and moved to {groupLabel} group at position {position} in layer {dropLayerNumber}",values:{label:e,nextLabel:n,groupLabel:t,position:a,dropLayerNumber:r}}),move_compatible:({label:e},{groupLabel:t,position:a,layerNumber:n})=>o.i18n.translate("domDragDrop.announce.dropped.moveCompatible",{defaultMessage:"Moved {label} to {groupLabel} group at position {position} in layer {dropLayerNumber}",values:{label:e,groupLabel:t,position:a,dropLayerNumber:n}}),duplicate_incompatible:({label:e},{groupLabel:t,position:a,nextLabel:n,layerNumber:r})=>o.i18n.translate("domDragDrop.announce.dropped.duplicateIncompatible",{defaultMessage:"Converted copy of {label} to {nextLabel} and added to {groupLabel} group at position {position} in layer {dropLayerNumber}",values:{label:e,groupLabel:t,position:a,nextLabel:n,dropLayerNumber:r}}),replace_duplicate_incompatible:({label:e},{label:t,groupLabel:a,position:n,nextLabel:r,layerNumber:i})=>o.i18n.translate("domDragDrop.announce.dropped.replaceDuplicateIncompatible",{defaultMessage:"Converted copy of {label} to {nextLabel} and replaced {dropLabel} in {groupLabel} group at position {position} in layer {dropLayerNumber}",values:{label:e,dropLabel:t,groupLabel:a,position:n,nextLabel:r,dropLayerNumber:i}}),replace_duplicate_compatible:({label:e},{label:t,groupLabel:a,position:n,layerNumber:r})=>o.i18n.translate("domDragDrop.announce.duplicated.replaceDuplicateCompatible",{defaultMessage:"Replaced {dropLabel} with a copy of {label} in {groupLabel} at position {position} in layer {dropLayerNumber}",values:{label:e,dropLabel:t,groupLabel:a,position:n,dropLayerNumber:r}}),swap_compatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,layerNumber:l})=>o.i18n.translate("domDragDrop.announce.dropped.swapCompatible",{defaultMessage:"Moved {label} to {dropGroupLabel} at position {dropPosition} in layer {dropLayerNumber} and {dropLabel} to {groupLabel} group at position {position} in layer {layerNumber}",values:{label:e,groupLabel:t,position:a,dropLabel:r,dropGroupLabel:i,dropPosition:s,layerNumber:n,dropLayerNumber:l}}),swap_incompatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,nextLabel:l,layerNumber:c})=>o.i18n.translate("domDragDrop.announce.dropped.swapIncompatible",{defaultMessage:"Converted {label} to {nextLabel} in {groupLabel} group at position {position} in layer {layerNumber} and swapped with {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}",values:{label:e,groupLabel:t,position:a,dropGroupLabel:i,dropLabel:r,dropPosition:s,nextLabel:l,dropLayerNumber:c,layerNumber:n}}),combine_compatible:({label:e,groupLabel:t},{label:a,groupLabel:n,position:r,layerNumber:i})=>o.i18n.translate("domDragDrop.announce.dropped.combineCompatible",{defaultMessage:"Combined {label} in group {groupLabel} to {dropLabel} in group {dropGroupLabel} at position {dropPosition} in layer {dropLayerNumber}",values:{label:e,groupLabel:t,dropLabel:a,dropGroupLabel:n,dropPosition:r,dropLayerNumber:i}}),combine_incompatible:({label:e,groupLabel:t,position:a,layerNumber:n},{label:r,groupLabel:i,position:s,nextLabel:l,layerNumber:c})=>o.i18n.translate("domDragDrop.announce.dropped.combineIncompatible",{defaultMessage:"Converted {label} to {nextLabel} in {groupLabel} group at position {position} and combined with {dropLabel} in {dropGroupLabel} group at position {dropPosition} in layer {dropLayerNumber}",values:{label:e,groupLabel:t,position:a,dropGroupLabel:i,dropLabel:r,dropPosition:s,nextLabel:l,dropLayerNumber:c}})}},f={lifted:({label:e})=>o.i18n.translate("domDragDrop.announce.lifted",{defaultMessage:"Lifted {label}",values:{label:e}}),cancelled:({label:e,groupLabel:t,position:a})=>t&&a?o.i18n.translate("domDragDrop.announce.cancelledItem",{defaultMessage:"Movement cancelled. {label} returned to {groupLabel} group at position {position}",values:{label:e,groupLabel:t,position:a}}):o.i18n.translate("domDragDrop.announce.cancelled",{defaultMessage:"Movement cancelled. {label} returned to its initial position",values:{label:e}}),noTarget:()=>o.i18n.translate("domDragDrop.announce.selectedTarget.noSelected",{defaultMessage:"No target selected. Use arrow keys to select a target"}),dropped:({label:e},{groupLabel:t,position:a,label:n,layerNumber:r})=>t&&a?o.i18n.translate("domDragDrop.announce.droppedDefault",{defaultMessage:"Added {label} in {dropGroupLabel} group at position {position} in layer {dropLayerNumber}",values:{label:e,dropGroupLabel:t,position:a,dropLayerNumber:r}}):o.i18n.translate("domDragDrop.announce.droppedNoPosition",{defaultMessage:"Added {label} to {dropLabel}",values:{label:e,dropLabel:n}}),selectedTarget:({label:e},{label:t,groupLabel:a,position:n,layerNumber:r})=>a&&n?o.i18n.translate("domDragDrop.announce.selectedTarget.default",{defaultMessage:"Add {label} to {dropGroupLabel} group at position {position} in layer {dropLayerNumber}. Press space or enter to add",values:{label:e,dropGroupLabel:a,position:n,dropLayerNumber:r}}):o.i18n.translate("domDragDrop.announce.selectedTarget.defaultNoPosition",{defaultMessage:"Add {label} to {dropLabel}. Press space or enter to add",values:{dropLabel:t,label:e}})},h={...f,dropped:(e,t,a)=>{var n,r;return a&&(null===(n=g.dropped)||void 0===n||null===(r=n[a])||void 0===r?void 0:r.call(n,e,t))||f.dropped(e,t)},selectedTarget:(e,t,a)=>{var n,r;return a&&(null===(n=g.selectedTarget)||void 0===n||null===(r=n[a])||void 0===r?void 0:r.call(n,e,t))||f.selectedTarget(e,t)}};var v=a(43);const y={dragging:void 0,hoveredDropTarget:void 0,keyboardMode:!1,dropTargetsByOrder:{},dataTestSubjPrefix:s.a},E=r.a.createContext([y,()=>{}]);function x(){const e=r.a.useContext(E);if(void 0===e)throw new Error("useDragDropContext must be used within a <RootDragDropProvider/> or <ChildDragDropProvider/>");return e}const j=(e,t)=>{switch(t.type){case"resetState":case"endDragging":case"dropToTarget":return{...e,dropTargetsByOrder:void 0,dragging:void 0,keyboardMode:!1,hoveredDropTarget:void 0};case"registerDropTargets":return{...e,dropTargetsByOrder:{...e.dropTargetsByOrder,...t.payload}};case"leaveDropTarget":return{...e,hoveredDropTarget:void 0};case"selectDropTarget":return{...e,hoveredDropTarget:t.payload.dropTarget};case"startDragging":return{...e,...t.payload};default:return e}},w=(e,t,a)=>{const[i,o]=Object(n.useReducer)(e,t);return[i,r.a.useCallback((e=>{void 0!==a&&a.length>0&&a.forEach((t=>t(e))),o(e)}),[a])]},S=()=>{const[e,t]=r.a.useState("");return{a11yMessage:e,a11yMiddleware:r.a.useCallback((e=>{switch(e.type){case"startDragging":return void t(h.lifted(e.payload.dragging.humanData));case"selectDropTarget":return void t(h.selectedTarget(e.payload.dragging.humanData,e.payload.dropTarget.humanData,e.payload.dropTarget.dropType));case"leaveDropTarget":return void t(h.noTarget());case"dropToTarget":const{dragging:a,dropTarget:n}=e.payload;return void t(h.dropped(a.humanData,n.humanData,n.dropType));case"endDragging":return void t(h.cancelled(e.payload.dragging.humanData));default:return}}),[])}};function O({children:e,customMiddleware:t,initialState:a={}}){const{a11yMessage:n,a11yMiddleware:l}=S(),c=r.a.useMemo((()=>t?[t,l]:[l]),[t,l]),u=a.dataTestSubjPrefix||s.a,[d,p]=w(j,{...y,...a},c);return Object(v.jsx)(r.a.Fragment,null,Object(v.jsx)(I,{value:[d,p]},e),Object(v.jsx)(i.EuiScreenReaderOnly,null,Object(v.jsx)("div",null,Object(v.jsx)("p",{"aria-live":"assertive","aria-atomic":!0},n),Object(v.jsx)("p",{id:`${u}-keyboardInstructionsWithReorder`},o.i18n.translate("domDragDrop.keyboardInstructionsReorder",{defaultMessage:"Press space or enter to start dragging. When dragging, use the up/down arrow keys to reorder items in the group and left/right arrow keys to choose drop targets outside of the group. Press space or enter again to finish."})),Object(v.jsx)("p",{id:`${u}-keyboardInstructions`},o.i18n.translate("domDragDrop.keyboardInstructions",{defaultMessage:"Press space or enter to start dragging. When dragging, use the left/right arrow keys to move between drop targets. Press space or enter again to finish."})))))}function k(e,t,a,n=(()=>!0),r=!1){if(!e)return;const i=[...Object.entries(e).filter((([e,t])=>t&&e!==a[0]&&n(t))).reduce(((e,t)=>{const[,a]=t;return a?e.find((([,e])=>(null==e?void 0:e.id)===a.id))?e:[...e,t]:e}),[]),a].sort((([e],[t])=>{const a=e.split(",").map((e=>Number(e))),n=t.split(",").map((e=>Number(e))),r=a.findIndex(((e,t)=>a[t]!==n[t]));return a[r]-n[r]}));let o=i.findIndex((([,e])=>"object"==typeof e&&(null==e?void 0:e.id)===(null==t?void 0:t.id)));-1===o&&(o=i.findIndex((([e])=>e===a[0])));const s=(i.length+o-1)%i.length,l=(o+1)%i.length;return i[r?s:l][1]}function I({value:e,children:t}){return Object(v.jsx)(E.Provider,{value:e},t)}},190:function(e,t,a){const n=a(164);e.exports=(e,t,a)=>new n(e,a).compare(new n(t,a))},192:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));let n=function(e){return e.alert="alert",e.asset="asset",e.enrichment="enrichment",e.event="event",e.metric="metric",e.state="state",e.pipeline_error="pipeline_error",e.signal="signal",e}({})},193:function(e,t,a){class Range{constructor(e,t){if(t=r(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof i)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!g(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&f(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&m)|(this.options.loose&&b))+":"+e,a=n.get(t);if(a)return a;const r=this.options.loose,s=r?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(s,T(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),o("comparator trim",e),e=e.replace(l[c.TILDETRIM],d),o("tilde trim",e),e=e.replace(l[c.CARETTRIM],p),o("caret trim",e);let f=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>I(e,this.options)));r&&(f=f.filter((e=>(o("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE]))))),o("range list",f);const h=new Map,y=f.map((e=>new i(e,this.options)));for(const e of y){if(g(e))return[e];h.set(e.value,e)}h.size>1&&h.has("")&&h.delete("");const E=[...h.values()];return n.set(t,E),E}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((a=>h(a,t)&&e.set.some((e=>h(e,t)&&a.every((a=>e.every((e=>a.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new s(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(C(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const n=new(a(1119)),r=a(431),i=a(386),o=a(347),s=a(164),{safeRe:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=a(311),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:b}=a(348),g=e=>"<0.0.0-0"===e.value,f=e=>""===e.value,h=(e,t)=>{let a=!0;const n=e.slice();let r=n.pop();for(;a&&n.length;)a=n.every((e=>r.intersects(e,t))),r=n.pop();return a},v=(e,t)=>(o("comp",e,t),e=j(e,t),o("caret",e),e=E(e,t),o("tildes",e),e=S(e,t),o("xrange",e),e=k(e,t),o("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,E=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{const a=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(a,((t,a,n,r,i)=>{let s;return o("tilde",e,t,a,n,r,i),y(a)?s="":y(n)?s=`>=${a}.0.0 <${+a+1}.0.0-0`:y(r)?s=`>=${a}.${n}.0 <${a}.${+n+1}.0-0`:i?(o("replaceTilde pr",i),s=`>=${a}.${n}.${r}-${i} <${a}.${+n+1}.0-0`):s=`>=${a}.${n}.${r} <${a}.${+n+1}.0-0`,o("tilde return",s),s}))},j=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{o("caret",e,t);const a=t.loose?l[c.CARETLOOSE]:l[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(a,((t,a,r,i,s)=>{let l;return o("caret",e,t,a,r,i,s),y(a)?l="":y(r)?l=`>=${a}.0.0${n} <${+a+1}.0.0-0`:y(i)?l="0"===a?`>=${a}.${r}.0${n} <${a}.${+r+1}.0-0`:`>=${a}.${r}.0${n} <${+a+1}.0.0-0`:s?(o("replaceCaret pr",s),l="0"===a?"0"===r?`>=${a}.${r}.${i}-${s} <${a}.${r}.${+i+1}-0`:`>=${a}.${r}.${i}-${s} <${a}.${+r+1}.0-0`:`>=${a}.${r}.${i}-${s} <${+a+1}.0.0-0`):(o("no pr"),l="0"===a?"0"===r?`>=${a}.${r}.${i}${n} <${a}.${r}.${+i+1}-0`:`>=${a}.${r}.${i}${n} <${a}.${+r+1}.0-0`:`>=${a}.${r}.${i} <${+a+1}.0.0-0`),o("caret return",l),l}))},S=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map((e=>O(e,t))).join(" ")),O=(e,t)=>{e=e.trim();const a=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(a,((a,n,r,i,s,l)=>{o("xRange",e,a,n,r,i,s,l);const c=y(r),u=c||y(i),d=u||y(s),p=d;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",c?a=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(u&&(i=0),s=0,">"===n?(n=">=",u?(r=+r+1,i=0,s=0):(i=+i+1,s=0)):"<="===n&&(n="<",u?r=+r+1:i=+i+1),"<"===n&&(l="-0"),a=`${n+r}.${i}.${s}${l}`):u?a=`>=${r}.0.0${l} <${+r+1}.0.0-0`:d&&(a=`>=${r}.${i}.0${l} <${r}.${+i+1}.0-0`),o("xRange return",a),a}))},k=(e,t)=>(o("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),I=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),T=e=>(t,a,n,r,i,o,s,l,c,u,d,p)=>`${a=y(n)?"":y(r)?`>=${n}.0.0${e?"-0":""}`:y(i)?`>=${n}.${r}.0${e?"-0":""}`:o?`>=${a}`:`>=${a}${e?"-0":""}`} ${l=y(c)?"":y(u)?`<${+c+1}.0.0-0`:y(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),C=(e,t,a)=>{for(let a=0;a<e.length;a++)if(!e[a].test(t))return!1;if(t.prerelease.length&&!a.includePrerelease){for(let a=0;a<e.length;a++)if(o(e[a].semver),e[a].semver!==i.ANY&&e[a].semver.prerelease.length>0){const n=e[a].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},2093:function(e,t,a){"use strict";a.r(t),a.d(t,"PinnedTabContentComponent",(function(){return V})),a.d(t,"default",(function(){return $}));var n=a(44),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(45),c=a(188),u=a.n(c),d=a(1484),p=a(1216),m=a(145),b=a(118),g=a(129),f=a(717),h=a(243),v=a(1425),y=a(1433),E=a(585),x=a(855),j=a(127),w=a(158),S=a(122),O=a(132),k=a(206),I=a(191),T=a(146),C=a(738),M=a(583),F=a(1421),D=a(1242),P=a(1243),L=a(1434),N=a(210),R=a(1419),_=a(1435);const A=s.a.div.withConfig({displayName:"ExitFullScreenContainer",componentId:"sc-10asbc-0"})(["width:180px;"]),z=[],B=[{id:"row-details",columnHeaderType:"not-filtered",width:0,headerCellRender:()=>null,rowCellRender:()=>null}],V=({columns:e,timelineId:t,itemsPerPage:a,itemsPerPageOptions:o,pinnedEventIds:s,onEventClosed:l,renderCellValue:c,rowRenderers:u,showExpandedDetails:g,sort:w,expandedDetail:V,eventIdToNoteIds:$})=>{const{telemetry:q}=Object(b.j)().services,{browserFields:G,dataViewId:U,loading:H,runtimeMappings:W,selectedPatterns:Q}=Object(O.a)(j.SourcererScopeName.timeline),{setTimelineFullScreen:K,timelineFullScreen:J}=Object(k.c)(),Y=Object(S.a)("unifiedComponentsInTimelineDisabled"),Z=Object(r.useMemo)((()=>{if(Object(n.isEmpty)(s))return"";const e=Object.entries(s).reduce(((e,[t,a])=>a?{...e,bool:{...e.bool,should:[...e.bool.should,{match_phrase:{_id:t}}]}}:e),{bool:{should:[],minimum_should_match:1}});try{return JSON.stringify(e)}catch{return""}}),[s]),X=Object(r.useMemo)((()=>[...(Object(n.isEmpty)(e)?h.b:e).map((e=>e.id)),...E.i]),[e]),ee=Object(r.useMemo)((()=>w.map((({columnId:e,columnType:t,esTypes:a,sortDirection:n})=>({field:e,type:t,direction:n,esTypes:null!=a?a:[]})))),[w]),{augmentedColumnHeaders:te}=Object(P.a)(e),[ae,{events:ne,totalCount:re,pageInfo:ie,loadPage:oe,refreshedAt:se,refetch:le}]=Object(f.a)({endDate:"",id:`pinned-${t}`,indexNames:Q,dataViewId:U,fields:X,limit:a,filterQuery:Z,runtimeMappings:W,skip:""===Z,startDate:"",sort:ee,timerangeKind:void 0}),ce=Object(S.a)("expandableFlyoutDisabled"),{openFlyout:ue}=Object(p.a)(),de=Object(S.a)("securitySolutionNotesEnabled"),{associateNote:pe,notes:me,isNotesFlyoutVisible:be,closeNotesFlyout:ge,showNotesFlyout:fe,eventId:he,setNotesEventId:ve}=Object(R.a)({eventIdToNoteIds:$,refetch:le,timelineId:t,activeTab:T.d.pinned}),ye=Object(r.useCallback)((e=>{const a=Q.join(",");e&&!ce&&de?(ue({right:{id:m.e,params:{id:e,indexName:a,scopeId:t}},left:{id:m.c,path:{tab:N.d},params:{id:e,indexName:a,scopeId:t}}}),q.reportOpenNoteInExpandableFlyoutClicked({location:t}),q.reportDetailsFlyoutOpened({location:t,panel:"left"})):e&&(ve(e),fe())}),[ce,ue,de,Q,q,t,ve,fe]),Ee=Object(L.a)({columns:e,sort:w,timelineId:t,activeTab:T.d.pinned,refetch:le,events:ne,pinnedEventIds:s,eventIdToNoteIds:$,onToggleShowNotes:ye}),xe=Object(r.useMemo)((()=>[d.a.loading,d.a.loadingMore].includes(ae)),[ae]),je=Object(r.useCallback)((()=>{l({tabType:T.d.pinned,id:t})}),[t,l]),we=Object(r.useMemo)((()=>i.a.createElement(_.a,{associateNote:pe,eventId:he,show:be,notes:me,onClose:ge,onCancel:ge,timelineId:t})),[pe,ge,be,he,me,t]);return Y?i.a.createElement(i.a.Fragment,null,we,i.a.createElement(D.b,{"data-test-subj":`${T.d.pinned}-tab`},i.a.createElement(D.c,{grow:2},J&&null!=K&&i.a.createElement(A,null,i.a.createElement(M.b,{fullScreen:J,setFullScreen:K})),i.a.createElement(x.a,null,i.a.createElement(D.d,{"data-test-subj":`${T.d.pinned}-tab-flyout-body`,className:"timeline-flyout-body"},i.a.createElement(v.a,{activePage:ie.activePage,browserFields:G,data:ne,id:t,refetch:le,renderCellValue:c,rowRenderers:u,sort:w,tabType:T.d.pinned,totalPages:Object(I.g)({itemsCount:re,itemsPerPage:a}),leadingControlColumns:Ee,trailingControlColumns:z})),i.a.createElement(D.e,{"data-test-subj":`${T.d.pinned}-tab-flyout-footer`,className:"timeline-flyout-footer"},i.a.createElement(y.a,{activePage:ie.activePage,"data-test-subj":"timeline-footer",updatedAt:se,height:y.b,id:t,isLive:!1,isLoading:xe||H,itemsCount:ne.length,itemsPerPage:a,itemsPerPageOptions:o,onChangePage:oe,totalCount:re})))),g&&i.a.createElement(i.a.Fragment,null,i.a.createElement(D.h,null),i.a.createElement(D.c,{grow:1},i.a.createElement(C.a,{browserFields:G,handleOnPanelClosed:je,runtimeMappings:W,tabType:T.d.pinned,scopeId:t}))))):i.a.createElement(i.a.Fragment,null,we,i.a.createElement(F.a,{header:i.a.createElement(i.a.Fragment,null),columns:te,rowRenderers:u,timelineId:t,itemsPerPage:a,itemsPerPageOptions:o,sort:w,events:ne,refetch:le,dataLoadingState:ae,totalCount:ne.length,onEventClosed:l,expandedDetail:V,showExpandedDetails:g,onChangePage:oe,activeTab:T.d.pinned,updatedAt:se,isTextBasedQuery:!1,pageInfo:ie,leadingControlColumns:Ee,trailingControlColumns:B}))},$=Object(l.connect)((()=>{const e=g.b.getTimelineByIdSelector();return(t,{timelineId:a})=>{var n,r;const i=null!==(n=e(t,a))&&void 0!==n?n:w.b,{columns:o,expandedDetail:s,itemsPerPage:l,itemsPerPageOptions:c,pinnedEventIds:u,sort:d,eventIdToNoteIds:p}=i;return{columns:o,timelineId:a,itemsPerPage:l,itemsPerPageOptions:c,pinnedEventIds:u,showExpandedDetails:!!s[T.d.pinned]&&!(null===(r=s[T.d.pinned])||void 0===r||!r.panelView),sort:d,expandedDetail:s,eventIdToNoteIds:p}}}),((e,{timelineId:t})=>({onEventClosed:t=>{e(g.a.toggleDetailPanel(t))}})))(Object(r.memo)(V,((e,t)=>e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.showExpandedDetails===t.showExpandedDetails&&e.timelineId===t.timelineId&&u()(e.columns,t.columns)&&u()(e.eventIdToNoteIds,t.eventIdToNoteIds)&&u()(e.itemsPerPageOptions,t.itemsPerPageOptions)&&u()(e.pinnedEventIds,t.pinnedEventIds)&&u()(e.sort,t.sort))))},210:function(e,t,a){"use strict";a.d(t,"f",(function(){return Re})),a.d(t,"b",(function(){return _e})),a.d(t,"c",(function(){return Ae})),a.d(t,"e",(function(){return ze})),a.d(t,"d",(function(){return Be})),a.d(t,"a",(function(){return Ve}));var n=a(2),r=a.n(n),i=a(1216),o=a(122),s=a(145),l=a(118),c=a(41),u=a.n(c),d=a(19),p=(a(43),a(537)),m=a(142),b=a(192),g=a(125);const f=Object(n.memo)((({selectedTabId:e,setSelectedTabId:t,tabs:a})=>{const{getFieldsData:n}=Object(g.b)(),i=Object(m.a)(n("event.kind"))===b.a.signal,o=a.map(((a,n)=>r.a.createElement(d.EuiTab,{onClick:()=>{return e=a.id,t(e);var e},isSelected:a.id===e,key:n,"data-test-subj":a["data-test-subj"]},a.name)));return r.a.createElement(h,{$_css:Object(d.useEuiBackgroundColor)("subdued")},r.a.createElement(d.EuiTabs,{size:"l",expand:i},o))}));f.displayName="PanelHeader";var h=u()(p.a).withConfig({displayName:"_StyledFlyoutHeader",componentId:"sc-1qgelk0-0"})(["background-color:",";padding-bottom:0 !important;border-block-end:none !important;"],(e=>e.$_css)),v=a(418);const y=({selectedTabId:e,tabs:t})=>{const a=Object(n.useMemo)((()=>{var a;return null===(a=t.find((t=>t.id===e)))||void 0===a?void 0:a.content}),[e,t]);return r.a.createElement(E,{$_css:Object(d.useEuiBackgroundColor)("subdued")},a)};y.displayName="PanelContent";var E=u()(v.a).withConfig({displayName:"_StyledFlyoutBody",componentId:"sc-1pfozwl-0"})(["background-color:",";"],(e=>e.$_css)),x=a(42),j=a(45),w=a(4),S=a(384),O=a(285),k=a(149),I=a(129),T=a(153),C=a(123),M=a(289),F=a(300);const D=w.i18n.translate("xpack.securitySolution.notes.markdownAriaLabel",{defaultMessage:"Note"}),P=w.i18n.translate("xpack.securitySolution.notes.addNoteBtnLabel",{defaultMessage:"Add note"}),L=w.i18n.translate("xpack.securitySolution.notes.createNoteErrorLabel",{defaultMessage:"Error create note"}),N=w.i18n.translate("xpack.securitySolution.notes.attachToTimelineCheckboxLabel",{defaultMessage:"Attach to active timeline"}),R=w.i18n.translate("xpack.securitySolution.notes.attachToTimelineInfoLabel",{defaultMessage:"The active timeline must be saved before a note can be associated with it"}),_=Object(n.memo)((({eventId:e})=>{const{telemetry:t}=Object(l.j)().services,a=Object(j.useDispatch)(),{addError:i}=Object(C.a)(),[o,s]=Object(n.useState)(""),[c,u]=Object(n.useState)(!1),p=Object(j.useSelector)((e=>I.b.selectTimelineById(e,k.f.active))),m=Object(S.a)()===O.a.timeline,[b,g]=Object(n.useState)(!0),f=Object(n.useCallback)((e=>g(e.target.checked)),[]),h=Object(j.useSelector)((e=>Object(M.j)(e))),v=Object(j.useSelector)((e=>Object(M.i)(e))),y=Object(n.useCallback)((()=>{a(Object(M.b)({note:{timelineId:b&&(null==p?void 0:p.savedObjectId)||"",eventId:e,note:o}})),t.reportAddNoteFromExpandableFlyoutClicked({isRelatedToATimeline:b&&null!==(null==p?void 0:p.savedObjectId)}),s("")}),[null==p?void 0:p.savedObjectId,b,a,o,e,t]);Object(n.useEffect)((()=>{h===M.a.Failed&&v&&i(null,{title:L})}),[i,v,h]);const E=Object(n.useMemo)((()=>0===o.trim().length||c),[o,c]),x=Object(n.useMemo)((()=>m&&null!=p.savedObjectId),[null==p?void 0:p.savedObjectId,m]),w=Object(n.useMemo)((()=>!m||m&&null==(null==p?void 0:p.savedObjectId)),[null==p?void 0:p.savedObjectId,m]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiCommentList,null,r.a.createElement(d.EuiComment,{username:""},r.a.createElement(F.a,{dataTestSubj:T.c,value:o,onChange:s,ariaLabel:D,setIsMarkdownInvalid:u}))),r.a.createElement(d.EuiSpacer,null),r.a.createElement(d.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",responsive:!1},r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiCheckbox,{"data-test-subj":T.e,id:"xpack.securitySolution.notes.attachToTimelineCheckboxId",label:r.a.createElement(r.a.Fragment,null,N,r.a.createElement(d.EuiToolTip,{position:"top",content:R},r.a.createElement(A,{type:"iInCircle"}))),disabled:w,checked:x&&b,onChange:e=>f(e)}))),r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(d.EuiButton,{onClick:y,isLoading:h===M.a.Loading,disabled:E,"data-test-subj":T.a},P))))}));_.displayName="AddNote";var A=u()(d.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-sgqe0x-0"})(["margin-left:4px;"]),z=a(184),B=a(140);const V=w.i18n.translate("xpack.securitySolution.notes.addedANoteLabel",{defaultMessage:"added a note"}),$=w.i18n.translate("xpack.securitySolution.notes.fetchNotesErrorLabel",{defaultMessage:"Error fetching notes"}),q=w.i18n.translate("xpack.securitySolution.notes.noNotesLabel",{defaultMessage:"No notes have been created for this document"}),G=w.i18n.translate("xpack.securitySolution.notes.deleteNoteLabel",{defaultMessage:"Delete note"}),U=w.i18n.translate("xpack.securitySolution.notes.deleteNoteErrorLabel",{defaultMessage:"Error deleting note"}),H=Object(n.memo)((({eventId:e})=>{const t=Object(j.useDispatch)(),{addError:a}=Object(C.a)(),{kibanaSecuritySolutionsPrivileges:i}=Object(B.a)(),s=i.crud,l=Object(o.a)("unifiedComponentsInTimelineDisabled"),c=Object(j.useSelector)((e=>Object(M.n)(e))),u=Object(j.useSelector)((e=>Object(M.m)(e))),p=Object(j.useSelector)((t=>Object(M.w)(t,{documentId:e,sort:{field:"created",direction:"desc"}}))),m=Object(j.useSelector)((e=>Object(M.j)(e))),b=Object(j.useSelector)((e=>Object(M.l)(e))),g=Object(j.useSelector)((e=>Object(M.k)(e))),[f,h]=Object(n.useState)(""),v=Object(n.useCallback)((e=>{h(e),t(Object(M.c)({ids:[e]}))}),[t]),y=Object(z.g)(),E=Object(n.useCallback)((({timelineId:e})=>y({duplicate:!1,onOpenTimeline:void 0,timelineId:e,timelineType:void 0,unifiedComponentsInTimelineDisabled:l})),[y,l]);return Object(n.useEffect)((()=>{c===M.a.Failed&&u&&a(null,{title:$})}),[a,u,c]),Object(n.useEffect)((()=>{b===M.a.Failed&&g&&a(null,{title:U})}),[a,g,b]),c===M.a.Loading?r.a.createElement(d.EuiLoadingElastic,{"data-test-subj":T.u,size:"xxl"}):c===M.a.Succeeded&&0===p.length?r.a.createElement("p",null,q):r.a.createElement(d.EuiCommentList,null,p.map(((e,t)=>r.a.createElement(d.EuiComment,{"data-test-subj":`${T.t}-${t}`,key:e.noteId,username:e.createdBy,timestamp:r.a.createElement(r.a.Fragment,null,e.created&&r.a.createElement(x.FormattedRelative,{value:new Date(e.created)})),event:V,actions:r.a.createElement(r.a.Fragment,null,e.timelineId&&e.timelineId.length>0&&r.a.createElement(d.EuiButtonIcon,{"data-test-subj":`${T.w}-${t}`,title:"Open timeline","aria-label":"Open timeline",color:"text",iconType:"timeline",onClick:()=>E(e)}),s&&r.a.createElement(d.EuiButtonIcon,{"data-test-subj":`${T.m}-${t}`,title:G,"aria-label":G,color:"text",iconType:"trash",onClick:()=>v(e.noteId),disabled:f!==e.noteId&&b===M.a.Loading,isLoading:f===e.noteId&&b===M.a.Loading})),timelineAvatar:r.a.createElement(d.EuiAvatar,{"data-test-subj":`${T.v}-${t}`,size:"l",name:e.updatedBy||"?"})},r.a.createElement(F.b,null,e.note||"")))),m===M.a.Loading&&r.a.createElement(d.EuiLoadingElastic,{size:"xxl","data-test-subj":T.b}))}));H.displayName="NotesList";const W=Object(n.memo)((()=>{const e=Object(j.useDispatch)(),{eventId:t}=Object(g.b)(),{kibanaSecuritySolutionsPrivileges:a}=Object(B.a)(),i=a.crud;return Object(n.useEffect)((()=>{e(Object(M.e)({documentIds:[t]}))}),[e,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{eventId:t}),i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiSpacer,null),r.a.createElement(_,{eventId:t})))}));W.displayName="NotesDetails";var Q=a(254);const K=Object(n.memo)((()=>r.a.createElement(d.EuiPanel,{"data-test-subj":Q.i,hasShadow:!1},r.a.createElement(W,null))));K.displayName="NotesTab";var J=a(1397),Y=a(669),Z=a(277),X=a(131);const ee="analyze_graph",te=()=>{const{eventId:e}=Object(g.b)(),t="flyout",{from:a,to:i,shouldUpdate:o,selectedPatterns:s}=Object(Z.a)(Object(X.isActiveTimeline)(t)),l=Object(n.useMemo)((()=>({from:a,to:i})),[a,i]);return r.a.createElement("div",{"data-test-subj":T.d},r.a.createElement(Y.a,{databaseDocumentID:e,resolverComponentInstanceID:t,indices:s,shouldUpdate:o,filters:l}))};te.displayName="AnalyzeGraph";var ae=a(234);const ne="session-view",re=()=>{const{sessionView:e}=Object(l.j)().services,{getFieldsData:t,indexName:a}=Object(g.b)(),n=Object(m.a)(t(ae.b)),i=Object(m.a)(t(ae.c))||"",o=Object(m.a)(t(ae.d))||"",s=n||a;return r.a.createElement("div",{"data-test-subj":T.L},e.getSessionView({index:s,sessionEntityId:i,sessionStartTime:o,isFullScreen:!0}))};re.displayName="SessionView";var ie=a(219),oe=a(187);const se=[{id:ne,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.sessionViewButtonLabel",defaultMessage:"Session View"}),"data-test-subj":Q.m},{id:ee,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.analyzerGraphButtonLabel",defaultMessage:"Analyzer Graph"}),"data-test-subj":Q.l}];Object(n.memo)((()=>{var e,t,a,o,l;const{eventId:c,indexName:u,scopeId:p}=Object(g.b)(),{openLeftPanel:m}=Object(i.a)(),b=Object(J.a)(),[f,h]=Object(n.useState)(null!==(e=null===(t=b.left)||void 0===t||null===(a=t.path)||void 0===a?void 0:a.subTab)&&void 0!==e?e:ne),{startTransaction:v}=Object(oe.b)(),y=Object(n.useCallback)((e=>{h(e),e===ee&&v({name:ie.a.OPEN_ANALYZER}),m({id:s.c,path:{tab:Re,subTab:e},params:{id:c,indexName:u,scopeId:p}})}),[v,c,u,p,m]);return Object(n.useEffect)((()=>{var e,t,a,n;null!==(e=b.left)&&void 0!==e&&null!==(t=e.path)&&void 0!==t&&t.subTab&&h(null===(a=b.left)||void 0===a||null===(n=a.path)||void 0===n?void 0:n.subTab)}),[null===(o=b.left)||void 0===o||null===(l=o.path)||void 0===l?void 0:l.subTab]),r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiButtonGroup,{color:"primary",name:"coarsness",legend:w.i18n.translate("xpack.securitySolution.flyout.left.visualize.buttonGroupLegendLabel",{defaultMessage:"Visualize options"}),options:se,idSelected:f,onChange:e=>y(e),buttonSize:"compressed",isFullWidth:!0,"data-test-subj":Q.k}),r.a.createElement(d.EuiSpacer,{size:"m"}),f===ne&&r.a.createElement(re,null),f===ee&&r.a.createElement(te,null))})).displayName="VisualizeTab";var le=a(605),ce=a(394),ue=a(339);const de=()=>{const{dataFormattedForFieldBrowser:e,isPreview:t}=Object(g.b)(),{loading:a,error:n,basicAlertData:i,ruleNote:o}=Object(le.a)({dataFormattedForFieldBrowser:e});return r.a.createElement("div",{"data-test-subj":T.s},t?r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."}):a?r.a.createElement(ue.a,{"data-test-subj":T.r}):!n&&i.ruleId&&o?r.a.createElement(ce.b,{basicData:i,ruleNote:o,showTitle:!1,showFullView:!0}):r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataDescription",defaultMessage:"There's no investigation guide for this rule. {documentation} to add one.",values:{documentation:r.a.createElement(d.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-management.html#edit-rules-settings",target:"_blank"},r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataLinkText",defaultMessage:"Edit the rule's settings"}))}}))};de.displayName="InvestigationGuide";const pe=Object(n.memo)((()=>r.a.createElement(d.EuiPanel,{"data-test-subj":Q.h,hasShadow:!1},r.a.createElement(de,null))));pe.displayName="InvestigationTab";var me=a(320),be=a(633),ge=a(606),fe=a(623);const he=[{id:me.a,label:r.a.createElement("div",{"data-test-subj":Q.c},r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entitiesButtonLabel",defaultMessage:"Entities"})),"data-test-subj":Q.d},{id:be.a,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.threatIntelligenceButtonLabel",defaultMessage:"Threat intelligence"}),"data-test-subj":Q.g},{id:ge.a,label:r.a.createElement("div",{"data-test-subj":Q.e},r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalenceButtonLabel",defaultMessage:"Prevalence"})),"data-test-subj":Q.f},{id:fe.a,label:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlationsButtonLabel",defaultMessage:"Correlations"}),"data-test-subj":Q.b}],ve=Object(n.memo)((()=>{var e,t,a;const{telemetry:o}=Object(l.j)().services,{eventId:c,indexName:u,scopeId:p,getFieldsData:f}=Object(g.b)(),h=Object(m.a)(f("event.kind"))===b.a.signal,{openLeftPanel:v}=Object(i.a)(),y=null!==(e=null===(t=Object(J.a)().left)||void 0===t||null===(a=t.path)||void 0===a?void 0:a.subTab)&&void 0!==e?e:me.a,E=Object(n.useMemo)((()=>h?he:he.filter((e=>e.id!==be.a))),[h]),x=Object(n.useCallback)((e=>{v({id:s.c,path:{tab:_e,subTab:e},params:{id:c,indexName:u,scopeId:p}}),o.reportDetailsFlyoutTabClicked({location:p,panel:"left",tabId:e})}),[c,u,p,v,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiButtonGroup,{color:"primary",legend:w.i18n.translate("xpack.securitySolution.flyout.left.insights.buttonGroupLegendLabel",{defaultMessage:"Insights options"}),options:E,idSelected:y,onChange:x,buttonSize:"compressed",isFullWidth:!0,"data-test-subj":Q.a,style:h?void 0:{maxWidth:450}}),r.a.createElement(d.EuiSpacer,{size:"m"}),y===me.a&&r.a.createElement(me.b,null),y===be.a&&r.a.createElement(be.b,null),y===ge.a&&r.a.createElement(ge.b,null),y===fe.a&&r.a.createElement(fe.b,null))}));ve.displayName="InsightsTab";var ye=a(211);ye.a;const Ee=`${ye.a}InsightsTab`,xe=`${ye.a}InvestigationTab`,je=`${ye.a}ResponseTab`,we=`${ye.a}NotesTab`;var Se=a(729),Oe=a(740);const ke=u.a.div.withConfig({displayName:"ExtendedFlyoutWrapper",componentId:"sc-qxbnld-0"})(["figure{background-color:white"]),Ie=()=>{const{searchHit:e,dataAsNestedObject:t,isPreview:a}=Object(g.b)(),n=Object(o.a)("endpointResponseActionsEnabled"),i=Object(Oe.a)({rawEventData:e,ecsData:t}),s=Object(Se.a)({rawEventData:e,ecsData:t});return r.a.createElement("div",{"data-test-subj":T.J},a?r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.previewMessage",defaultMessage:"Response is not available in alert preview."}):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiTitle,{size:"xxxs"},r.a.createElement("h5",null,r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.responseTitle",defaultMessage:"Responses"}))),r.a.createElement(d.EuiSpacer,{size:"s"}),r.a.createElement(ke,null,n?null==i?void 0:i.content:null==s?void 0:s.content)))};Ie.displayName="ResponseDetails";const Te=Object(n.memo)((()=>r.a.createElement(d.EuiPanel,{"data-test-subj":Q.j,hasShadow:!1},r.a.createElement(Ie,null))));Te.displayName="ResponseTab",x.FormattedMessage;const Ce={id:"insights","data-test-subj":Ee,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.tabLabel",defaultMessage:"Insights"}),content:r.a.createElement(ve,null)},Me={id:"investigation","data-test-subj":xe,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigations.tabLabel",defaultMessage:"Investigation"}),content:r.a.createElement(pe,null)},Fe={id:"response","data-test-subj":je,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.tabLabel",defaultMessage:"Response"}),content:r.a.createElement(Te,null)},De={id:"notes","data-test-subj":we,name:r.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.notes.tabLabel",defaultMessage:"Notes"}),content:r.a.createElement(K,null)};var Pe=a(631),Le=a(436);const Ne=Object(n.memo)((()=>{const{getFieldsData:e,isPreview:t}=Object(g.b)(),a=Object(m.a)(e("event.kind"))===b.a.signal,i=Object(S.a)()===O.a.timeline,o=a&&!t&&!i,s=Object(n.useMemo)((()=>Object(Le.a)()),[]);return o?r.a.createElement(Pe.a,{tourStepContent:s,totalSteps:5}):null}));Ne.displayName="LeftPanelTour";const Re="visualize",_e="insights",Ae="investigation",ze="response",Be="notes",Ve=Object(n.memo)((({path:e})=>{const{telemetry:t}=Object(l.j)().services,{openLeftPanel:a}=Object(i.a)(),{eventId:c,indexName:u,scopeId:d,getFieldsData:p,isPreview:h}=Object(g.b)(),v=Object(m.a)(p("event.kind")),E=Object(o.a)("securitySolutionNotesEnabled"),x=Object(n.useMemo)((()=>{const e=v===b.a.signal?[Ce,Me,Fe]:[Ce];return E&&!h&&e.push(De),e}),[v,h,E]),j=Object(n.useMemo)((()=>{var t;const a=x[0].id;return e&&null!==(t=x.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:a}),[e,x]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ne,null),r.a.createElement(f,{selectedTabId:j,setSelectedTabId:e=>{a({id:s.c,path:{tab:e},params:{id:c,indexName:u,scopeId:d}}),t.reportDetailsFlyoutTabClicked({location:d,panel:"left",tabId:e})},tabs:x}),r.a.createElement(y,{selectedTabId:j,tabs:x}))}));Ve.displayName="LeftPanel"},220:function(e,t,a){"use strict";e.exports=function(e){return-2===e||-1===e||32===e}},223:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));const n=["started","opened"],r=["starting","stopping","opening","closing"],i=["deleted","failed"],o=(e,t)=>n.includes(e)&&n.includes(t),s=(e,t)=>r.includes(e)||r.includes(t),l=(e,t)=>i.includes(e)||i.includes(t),c=e=>"machine_learning"===e},234:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"b",(function(){return s}));const n="kibana.alert.ancestors.id",r="kibana.alert.rule.indices",i="process.entry_leader.entity_id",o="process.entry_leader.start",s="kibana.alert.ancestors.index"},238:function(e,t,a){"use strict";var n=a(1141);e.exports=function(e,t,a,r){var i,o=e.length,s=0;if(t=t<0?-t>o?0:o+t:t>o?o:t,a=a>0?a:0,r.length<1e4)(i=Array.from(r)).unshift(t,a),n.apply(e,i);else for(a&&n.apply(e,[t,a]);s<r.length;)(i=r.slice(s,s+1e4)).unshift(t,0),n.apply(e,i),s+=1e4,t+=1e4}},239:function(e,t,a){"use strict";e.exports=function(e){return e<0||32===e}},240:function(e,t,a){"use strict";var n=a(388);e.exports=function(e){return function(t){return e.test(n(t))}}},254:function(e,t,a){"use strict";a.d(t,"k",(function(){return i})),a.d(t,"m",(function(){return o})),a.d(t,"l",(function(){return s})),a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"f",(function(){return b})),a.d(t,"b",(function(){return g})),a.d(t,"h",(function(){return f})),a.d(t,"j",(function(){return h})),a.d(t,"i",(function(){return v}));var n=a(211);const r=`${n.a}VisualizeTab`,i=`${r}ButtonGroup`,o=`${r}SessionViewButton`,s=`${r}GraphAnalyzerButton`,l=`${n.a}InsightsTab`,c=`${l}ButtonGroup`,u=`${l}EntitiesButton`,d=`${l}Entities`,p=`${l}ThreatIntelligenceButton`,m=`${l}Prevalence`,b=`${l}PrevalenceButton`,g=`${l}CorrelationsButton`,f=`${n.a}InvestigationsTabContent`,h=`${n.a}ResponseTabContent`,v=`${n.a}NotesTabContent`},285:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));let n=function(e){return e.securitySolution="SecuritySolution",e.timeline="Timeline",e}({})},286:function(e,t,a){"use strict";var n=a(335);e.exports=function(e){return n({},e)}},318:function(e,t,a){"use strict";a.d(t,"a",(function(){return P})),a.d(t,"b",(function(){return L}));var n=a(41),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=(a(152),a(44)),c=a(4),u=a(1216),d=a(122),p=a(313),m=a(125),b=a(367),g=a(137),f=a(130),h=a(196),v=a(334),y=a(226),E=a(132),x=a(161),j=a(570),w=a(142),S=a(366),O=a(735),k=a(320),I=a(135),T=a(145),C=a(210),M=a(357),F=a(288),D=a(118);const P={title:c.i18n.translate("xpack.securitySolution.flyout.right.host.hostPreviewTitle",{defaultMessage:"Preview host details"}),backgroundColor:"warning",textColor:"warning"},L=({hostName:e})=>{const{eventId:t,indexName:a,scopeId:n}=Object(m.b)(),{openLeftPanel:r,openPreviewPanel:L}=Object(u.a)(),{telemetry:R}=Object(D.j)().services,_=!Object(d.a)("entityAlertPreviewDisabled"),A=Object(i.useCallback)((()=>{r({id:T.c,path:{tab:C.b,subTab:k.a},params:{id:t,indexName:a,scopeId:n}})}),[t,r,a,n]),z=Object(i.useCallback)((()=>{L({id:F.e,params:{hostName:e,scopeId:n,banner:P}}),R.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[L,e,n,R]),{from:B,to:V}=Object(x.a)(),{selectedPatterns:$}=Object(E.a)(),q=Object(i.useMemo)((()=>({from:B,to:V})),[B,V]),G=Object(i.useMemo)((()=>e?Object(g.z)([e]):void 0),[e]),{data:U,isAuthorized:H,loading:W}=Object(p.a)({filterQuery:G,riskEntity:g.t.host,skip:null==e,timerange:q}),[Q,{hostDetails:K}]=Object(j.b)({hostName:e,indexNames:$,startDate:B,endDate:V}),J=Object(i.useMemo)((()=>Object(w.a)(Object(l.getOr)([],"host.os.family",K))),[K]),Y=Object(i.useMemo)((()=>[{title:O.c,description:J?o.a.createElement(S.a,{field:"host.os.family",value:J},J):Object(f.d)()}]),[J]),Z=Object(i.useMemo)((()=>[{title:O.k,description:o.a.createElement(b.a,{indexPatterns:$,field:"host.name",value:e,type:b.b.LAST_SEEN})}]),[e,$]),{euiTheme:X}=Object(s.useEuiTheme)(),ee=Object(s.useEuiFontSize)("xs").fontSize,[te]=Object(i.useMemo)((()=>{const e=U&&U.length>0?U[0]:void 0;return[{title:o.a.createElement(s.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},O.f),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(M.a,null))),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(y.a,{severity:e.host.risk.calculated_level}):Object(f.d)())}]}),[U]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":I.v},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{gutterSize:"m",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:"storage"})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(N,{"data-test-subj":I.r,onClick:_?z:A,$_css:ee,$_css2:X.font.weight.bold},e)))),W||Q?o.a.createElement(s.EuiSkeletonText,{"data-test-subj":I.s,contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.hostLoadingAriaLabel",{defaultMessage:"host overview"})}):o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(v.a,{dataTestSubj:I.t,descriptionList:Y})),o.a.createElement(s.EuiFlexItem,null,H?o.a.createElement(h.d,{"data-test-subj":I.u,listItems:[te]}):o.a.createElement(v.a,{dataTestSubj:I.q,descriptionList:Z})))))};L.displayName="HostEntityOverview";var N=r()(s.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-cud8pg-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2))},319:function(e,t,a){"use strict";a.d(t,"a",(function(){return P})),a.d(t,"b",(function(){return L}));var n=a(41),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=(a(152),a(44)),c=a(4),u=a(1216),d=a(122),p=a(145),m=a(210),b=a(320),g=a(125),f=a(142),h=a(366),v=a(367),y=a(137),E=a(130),x=a(196),j=a(334),w=a(226),S=a(132),O=a(161),k=a(313),I=a(118),T=a(736),C=a(135),M=a(548),F=a(357),D=a(287);const P={title:c.i18n.translate("xpack.securitySolution.flyout.right.user.userPreviewTitle",{defaultMessage:"Preview user details"}),backgroundColor:"warning",textColor:"warning"},L=({userName:e})=>{const{eventId:t,indexName:a,scopeId:n}=Object(g.b)(),{openLeftPanel:r,openPreviewPanel:L}=Object(u.a)(),{telemetry:R}=Object(I.j)().services,_=!Object(d.a)("entityAlertPreviewDisabled"),A=Object(i.useCallback)((()=>{r({id:p.c,path:{tab:m.b,subTab:b.a},params:{id:t,indexName:a,scopeId:n}})}),[t,r,a,n]),z=Object(i.useCallback)((()=>{L({id:D.d,params:{userName:e,scopeId:n,banner:P}}),R.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[L,e,n,R]),{from:B,to:V}=Object(O.a)(),{selectedPatterns:$}=Object(S.a)(),q=Object(i.useMemo)((()=>({from:B,to:V})),[B,V]),G=Object(i.useMemo)((()=>e?Object(y.A)([e]):void 0),[e]),[U,{userDetails:H}]=Object(M.b)({endDate:V,userName:e,indexNames:$,startDate:B}),{data:W,isAuthorized:Q,loading:K}=Object(k.a)({filterQuery:G,riskEntity:y.t.user,timerange:q}),J=Object(i.useMemo)((()=>Object(f.a)(Object(l.getOr)([],"user.domain",H))),[H]),Y=Object(i.useMemo)((()=>[{title:T.h,description:J?o.a.createElement(h.a,{field:"user.domain",value:J},J):Object(E.d)()}]),[J]),Z=Object(i.useMemo)((()=>[{title:T.f,description:o.a.createElement(v.a,{indexPatterns:$,field:"user.name",value:e,type:v.b.LAST_SEEN})}]),[e,$]),{euiTheme:X}=Object(s.useEuiTheme)(),ee=Object(s.useEuiFontSize)("xs").fontSize,[te]=Object(i.useMemo)((()=>{const e=W&&W.length>0?W[0]:void 0;return[{title:o.a.createElement(s.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},T.j),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(F.a,null))),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(w.a,{severity:e.user.risk.calculated_level}):Object(E.d)())}]}),[W]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":C.B},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{gutterSize:"m",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:"user"})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(N,{"data-test-subj":C.y,onClick:_?z:A,$_css:ee,$_css2:X.font.weight.bold},e)))),o.a.createElement(s.EuiFlexItem,null,U||K?o.a.createElement(s.EuiSkeletonText,{contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.userLoadingAriaLabel",{defaultMessage:"user overview"}),"data-test-subj":C.z}):o.a.createElement(s.EuiFlexGroup,{responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(j.a,{dataTestSubj:C.w,descriptionList:Y})),o.a.createElement(s.EuiFlexItem,null,Q?o.a.createElement(x.d,{"data-test-subj":C.A,listItems:[te]}):o.a.createElement(j.a,{dataTestSubj:C.x,descriptionList:Z})))))};var N=r()(s.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-f1yfvo-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2))},320:function(e,t,a){"use strict";a.d(t,"a",(function(){return re})),a.d(t,"b",(function(){return ie}));var n=a(2),r=a.n(n),i=a(19),o=a(42),s=a(125),l=a(142),c=a(45),u=a(50),d=a(4),p=a(1216),m=a(122),b=a(202),g=a(785),f=a(450),h=a(181),v=a(144),y=a(137),E=a(226),x=a(351),j=a(131),w=a(175),S=a(236),O=a(173);const k=({field:e,value:t,isObjectArray:a,children:i})=>{const{dataFormattedForFieldBrowser:o,scopeId:l,isPreview:c}=Object(s.b)(),{isAlert:u}=Object(w.b)(o),d=u?O.d.DETAILS_FLYOUT:O.d.DEFAULT,p=Object(n.useMemo)((()=>({field:e,value:t})),[e,t]),m=Object(n.useMemo)((()=>({scopeId:l,isObjectArray:a})),[l,a]),b=Object(n.useMemo)((()=>c?[S.d.FILTER,S.d.TOGGLE_COLUMN]:[]),[c]);return r.a.createElement(O.c,{data:p,mode:O.a.HOVER_RIGHT,triggerId:d,visibleCellActions:6,sourcererScopeId:Object(j.getSourcererScopeId)(l),metadata:m,disabledActionTypes:b},i)};k.displayName="CellActions";var I=a(138),T=a(161),C=a(132),M=a(419),F=a(249),D=a(561),P=a(209),L=a(548),N=a(699),R=a(306);const _=d.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedHostsDescription",{defaultMessage:"Failed to run search on related hosts"});var A=a(359),z=a(201),B=a(130),V=a(153),$=a(118),q=a(264),G=a(350),U=a(288),H=a(318),W=a(287),Q=a(319);const K=Object(P.a)(g.b),J=Object(P.a)(h.c),Y=({userName:e,timestamp:t,scopeId:a})=>{const{to:s,from:l,deleteQuery:g,setQuery:j,isInitializing:w}=Object(T.a)(),{selectedPatterns:S}=Object(C.a)(),O=Object(c.useDispatch)(),{telemetry:P}=Object($.j)().services,Y=Object(n.useMemo)((()=>`entities-users-details-${Object(u.v4)()}`),[]),Z=Object(n.useMemo)((()=>`entities-users-related-hosts-${Object(u.v4)()}`),[]),X=Object(G.a)("entity-analytics"),ee=Object(z.a)().isPlatinumOrTrialLicense&&X,{openPreviewPanel:te}=Object(p.a)(),ae=!Object(m.a)("entityAlertPreviewDisabled"),ne=Object(n.useCallback)(((e,t)=>{const a=Object(M.a)(e,t);O(Object(F.setAbsoluteRangeDatePicker)({id:I.a.global,from:a.from,to:a.to}))}),[O]),re=Object(n.useCallback)((()=>{te({id:W.d,params:{userName:e,scopeId:a,banner:Q.a}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[te,e,a,P]),ie=Object(n.useCallback)((e=>{te({id:U.e,params:{hostName:e,scopeId:a,banner:H.a}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[te,a,P]),[oe,{inspect:se,userDetails:le,refetch:ce}]=Object(L.b)({id:Y,startDate:l,endDate:s,userName:e,indexNames:S,skip:0===S.length}),{loading:ue,inspect:de,relatedHosts:pe,totalCount:me,refetch:be}=(({userName:e,indexNames:t,from:a,skip:r=!1})=>{const{loading:i,result:o,search:s,refetch:l,inspect:c}=Object(R.a)({factoryQueryType:N.a.relatedHosts,initialResult:{totalCount:0,relatedHosts:[]},errorMessage:_,abort:r}),{installed:u,isLoading:d}=Object(A.b)(),p=Object(n.useMemo)((()=>({inspect:c,totalCount:o.totalCount,relatedHosts:o.relatedHosts,refetch:l,loading:i})),[c,l,o.totalCount,o.relatedHosts,i]),m=Object(n.useMemo)((()=>({defaultIndex:t,factoryQueryType:N.a.relatedHosts,userName:e,from:a,isNewRiskScoreModuleInstalled:u})),[t,a,e,u]);return Object(n.useEffect)((()=>{r||d||s(m)}),[m,s,r,d]),p})({userName:e,indexNames:S,from:t,skip:0===S.length}),ge=Object(n.useMemo)((()=>[{field:"host",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNameColumnLabel",defaultMessage:"Name"}),render:e=>r.a.createElement(i.EuiText,{grow:!1,size:"xs"},r.a.createElement(k,{field:"host.name",value:e},ae?r.a.createElement(i.EuiLink,{"data-test-subj":V.O,onClick:()=>ie(e)},e):r.a.createElement(r.a.Fragment,null,e)))},{field:"ip",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>r.a.createElement(x.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?r.a.createElement(v.h,{ip:e}):Object(B.d)(),scopeId:a})},...ee?[{field:"risk",name:Object(q.b)(y.t.host),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?r.a.createElement(E.a,{severity:e}):Object(B.d)()}]:[]]),[ee,a,ie,ae]),fe=Object(n.useMemo)((()=>r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiIcon,{type:"storage"})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxxs"},r.a.createElement(i.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsCountLabel",defaultMessage:"Related hosts: {count}",values:{count:me}})))))),[me]),he=Object(n.useMemo)((()=>ae?{callback:re,tooltip:d.i18n.translate("xpack.securitySolution.flyout.left.insights.entities.user.userPreviewTitle",{defaultMessage:"Preview user"})}:void 0),[ae,re]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiTitle,{size:"xs"},r.a.createElement("h3",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsTitle",defaultMessage:"User"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(b.a,{header:{title:e,iconType:"user",headerContent:fe,link:he},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":V.Q},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsInfoTitle",defaultMessage:"User information"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(f.a,{criteriaFields:Object(D.a)(le),startDate:l,endDate:s,skip:w},(({isLoadingAnomaliesData:t,anomaliesData:a,jobNameById:n})=>r.a.createElement(K,{id:Y,isInDetailsSidePanel:!1,data:le,anomaliesData:a,isLoadingAnomaliesData:t,loading:oe,startDate:l,endDate:s,narrowDateRange:ne,setQuery:j,refetch:ce,inspect:se,userName:e,indexPatterns:S,jobNameById:n}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiPanel,{hasBorder:!0},r.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTitle",defaultMessage:"Related hosts"})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiToolTip,{content:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTooltip",defaultMessage:"After this event, {userName} logged into these hosts. Check if this activity is normal.",values:{userName:e}})},r.a.createElement(i.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(J,{id:Z,inspect:de,loading:ue,setQuery:j,deleteQuery:g,refetch:be},r.a.createElement(i.EuiInMemoryTable,{columns:ge,items:pe,loading:ue,"data-test-subj":V.P,pagination:{pageSize:4,showPerPageOptions:!1},message:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNoDataDescription",defaultMessage:"No hosts identified"})}),r.a.createElement(h.b,{queryId:Z,title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsInspectButtonTitle",defaultMessage:"Related hosts"}),inspectIndex:0})))))};var Z=a(792),X=a(570);const ee=d.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedUsersDescription",{defaultMessage:"Failed to run search on related users"}),te=Object(P.a)(Z.b),ae=Object(P.a)(h.c),ne=({hostName:e,timestamp:t,scopeId:a})=>{const{to:s,from:l,deleteQuery:g,setQuery:j,isInitializing:w}=Object(T.a)(),{selectedPatterns:S}=Object(C.a)(),O=Object(c.useDispatch)(),{telemetry:P}=Object($.j)().services,L=Object(n.useMemo)((()=>`entities-hosts-details-${Object(u.v4)()}`),[]),_=Object(n.useMemo)((()=>`entities-hosts-related-users-${Object(u.v4)()}`),[]),K=Object(G.a)("entity-analytics"),J=Object(z.a)().isPlatinumOrTrialLicense&&K,{openPreviewPanel:Y}=Object(p.a)(),Z=!Object(m.a)("entityAlertPreviewDisabled"),ne=Object(n.useCallback)(((e,t)=>{const a=Object(M.a)(e,t);O(Object(F.setAbsoluteRangeDatePicker)({id:I.a.global,from:a.from,to:a.to}))}),[O]),re=Object(n.useCallback)((()=>{Y({id:U.e,params:{hostName:e,scopeId:a,banner:H.a}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[Y,e,a,P]),ie=Object(n.useCallback)((e=>{Y({id:W.d,params:{userName:e,scopeId:a,banner:Q.a}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[Y,a,P]),[oe,{inspect:se,hostDetails:le,refetch:ce}]=Object(X.b)({id:L,startDate:l,endDate:s,hostName:e,indexNames:S,skip:0===S.length}),{loading:ue,inspect:de,relatedUsers:pe,totalCount:me,refetch:be}=(({hostName:e,indexNames:t,from:a,skip:r=!1})=>{const{installed:i,isLoading:o}=Object(A.b)(),{loading:s,result:l,search:c,refetch:u,inspect:d}=Object(R.a)({factoryQueryType:N.a.relatedUsers,initialResult:{totalCount:0,relatedUsers:[]},errorMessage:ee,abort:r}),p=Object(n.useMemo)((()=>({inspect:d,totalCount:l.totalCount,relatedUsers:l.relatedUsers,refetch:u,loading:s})),[d,u,l.totalCount,l.relatedUsers,s]),m=Object(n.useMemo)((()=>({defaultIndex:t,factoryQueryType:N.a.relatedUsers,hostName:e,from:a,isNewRiskScoreModuleInstalled:i})),[t,a,e,i]);return Object(n.useEffect)((()=>{r||o||c(m)}),[m,o,c,r]),p})({hostName:e,indexNames:S,from:t,skip:0===S.length}),ge=Object(n.useMemo)((()=>[{field:"user",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNameColumnLabel",defaultMessage:"Name"}),render:e=>r.a.createElement(i.EuiText,{grow:!1,size:"xs"},r.a.createElement(k,{field:"user.name",value:e},Z?r.a.createElement(i.EuiLink,{"data-test-subj":V.o,onClick:()=>ie(e)},e):r.a.createElement(r.a.Fragment,null,e)))},{field:"ip",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>r.a.createElement(x.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?r.a.createElement(v.h,{ip:e}):Object(B.d)(),scopeId:a})},...J?[{field:"risk",name:Object(q.b)(y.t.user),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?r.a.createElement(E.a,{severity:e}):Object(B.d)()}]:[]]),[J,a,Z,ie]),fe=Object(n.useMemo)((()=>r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiIcon,{type:"user"})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxxs"},r.a.createElement(i.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersCountLabel",defaultMessage:"Related users: {count}",values:{count:me}})))))),[me]),he=Object(n.useMemo)((()=>Z?{callback:re,tooltip:d.i18n.translate("xpack.securitySolution.flyout.left.insights.entities.host.hostPreviewTitle",{defaultMessage:"Preview host"})}:void 0),[Z,re]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiTitle,{size:"xs"},r.a.createElement("h3",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsTitle",defaultMessage:"Host"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(b.a,{header:{title:e,iconType:"storage",headerContent:fe,link:he},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":V.q},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsInfoTitle",defaultMessage:"Host information"}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(f.a,{criteriaFields:Object(D.a)(le),startDate:l,endDate:s,skip:w},(({isLoadingAnomaliesData:t,anomaliesData:a,jobNameById:n})=>r.a.createElement(te,{id:L,hostName:e,data:le,indexNames:S,jobNameById:n,anomaliesData:a,isLoadingAnomaliesData:t,isInDetailsSidePanel:!1,loading:oe,startDate:l,endDate:s,narrowDateRange:ne,setQuery:j,refetch:ce,inspect:se,deleteQuery:g}))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiPanel,{hasBorder:!0},r.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"xxs"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTitle",defaultMessage:"Related users"})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiToolTip,{content:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTooltip",defaultMessage:"After this event, these users logged into {hostName}. Check if this activity is normal.",values:{hostName:e}})},r.a.createElement(i.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(ae,{id:_,inspect:de,loading:ue,setQuery:j,deleteQuery:g,refetch:be},r.a.createElement(i.EuiInMemoryTable,{columns:ge,items:pe,loading:ue,"data-test-subj":V.p,pagination:{pageSize:4,showPerPageOptions:!1},message:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNoDataDescription",defaultMessage:"No users identified"})}),r.a.createElement(h.b,{queryId:_,title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersInspectButtonTitle",defaultMessage:"Related users"}),inspectIndex:0})))))};ne.displayName="HostDetails";const re="entity",ie=()=>{const{getFieldsData:e,scopeId:t}=Object(s.b)(),a=Object(l.a)(e("host.name")),n=Object(l.a)(e("user.name")),c=Object(l.a)(e("@timestamp")),u=c&&(a||n),d=n&&c,p=a&&c;return r.a.createElement(r.a.Fragment,null,u?r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m","data-test-subj":V.n},d&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(Y,{userName:n,timestamp:c,scopeId:t})),p&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(ne,{hostName:a,timestamp:c,scopeId:t}))):r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."}))};ie.displayName="EntitiesDetails"},335:function(e,t,a){"use strict";var n=Object.assign;e.exports=n},368:function(e,t,a){"use strict";a.d(t,"z",(function(){return r})),a.d(t,"s",(function(){return i})),a.d(t,"X",(function(){return o})),a.d(t,"t",(function(){return s})),a.d(t,"l",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"H",(function(){return d})),a.d(t,"I",(function(){return p})),a.d(t,"x",(function(){return m})),a.d(t,"k",(function(){return b})),a.d(t,"c",(function(){return g})),a.d(t,"e",(function(){return f})),a.d(t,"d",(function(){return h})),a.d(t,"J",(function(){return v})),a.d(t,"K",(function(){return y})),a.d(t,"D",(function(){return E})),a.d(t,"E",(function(){return x})),a.d(t,"A",(function(){return j})),a.d(t,"m",(function(){return w})),a.d(t,"r",(function(){return S})),a.d(t,"u",(function(){return O})),a.d(t,"F",(function(){return k})),a.d(t,"P",(function(){return I})),a.d(t,"S",(function(){return T})),a.d(t,"W",(function(){return C})),a.d(t,"O",(function(){return M})),a.d(t,"p",(function(){return F})),a.d(t,"g",(function(){return D})),a.d(t,"i",(function(){return P})),a.d(t,"h",(function(){return L})),a.d(t,"G",(function(){return N})),a.d(t,"U",(function(){return R})),a.d(t,"v",(function(){return _})),a.d(t,"b",(function(){return A})),a.d(t,"B",(function(){return z})),a.d(t,"C",(function(){return B})),a.d(t,"V",(function(){return V})),a.d(t,"R",(function(){return $})),a.d(t,"T",(function(){return q})),a.d(t,"Q",(function(){return G})),a.d(t,"M",(function(){return U})),a.d(t,"N",(function(){return H})),a.d(t,"L",(function(){return W})),a.d(t,"y",(function(){return Q})),a.d(t,"o",(function(){return K})),a.d(t,"q",(function(){return J})),a.d(t,"n",(function(){return Y})),a.d(t,"w",(function(){return Z})),a.d(t,"f",(function(){return X}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.overviewTabLabel",{defaultMessage:"Overview"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationGuideTabLabel",{defaultMessage:"Investigation guide"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.updatesTabLabel",{defaultMessage:"Updates"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.jsonViewUpdatesTabLabel",{defaultMessage:"JSON view"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dismissButtonLabel",{defaultMessage:"Dismiss"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.aboutSectionLabel",{defaultMessage:"About"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.definitionSectionLabel",{defaultMessage:"Definition"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.scheduleSectionLabel",{defaultMessage:"Schedule"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.setupGuideSectionLabel",{defaultMessage:"Setup guide"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.nameFieldLabel",{defaultMessage:"Name"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.descriptionFieldLabel",{defaultMessage:"Description"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.authorFieldLabel",{defaultMessage:"Author"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldLabel",{defaultMessage:"Building block"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityFieldLabel",{defaultMessage:"Severity"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityMappingFieldLabel",{defaultMessage:"Severity override"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreFieldLabel",{defaultMessage:"Risk score"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreMappingFieldLabel",{defaultMessage:"Risk score override"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.referencesFieldLabel",{defaultMessage:"Reference URLs"}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.falsePositivesFieldLabel",{defaultMessage:"False positive examples"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationFieldsFieldLabel",{defaultMessage:"Custom highlighted fields"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.licenseFieldLabel",{defaultMessage:"License"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleNameOverrideFieldLabel",{defaultMessage:"Rule name override"}),I=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFieldLabel",{defaultMessage:"MITRE ATT&CK™"}),T=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndicatorPathFieldLabel",{defaultMessage:"Indicator prefix override"}),C=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timestampOverrideFieldLabel",{defaultMessage:"Timestamp override"}),M=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.tagsFieldLabel",{defaultMessage:"Tags"}),F=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.indexFieldLabel",{defaultMessage:"Index patterns"}),D=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIdFieldLabel",{defaultMessage:"Data view ID"}),P=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFieldLabel",{defaultMessage:"Data view index pattern"}),L=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFetchErrorMessage",{defaultMessage:"Could not load data view index pattern"}),N=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleTypeFieldLabel",{defaultMessage:"Rule type"}),R=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.thresholdFieldLabel",{defaultMessage:"Threshold"}),_=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.machineLearningJobIdFieldLabel",{defaultMessage:"Machine Learning job"}),A=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.anomalyThresholdFieldLabel",{defaultMessage:"Anomaly score threshold"}),z=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.relatedIntegrationsFieldLabel",{defaultMessage:"Related integrations"}),B=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.requiredFieldsFieldLabel",{defaultMessage:"Required fields"}),V=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timelineTitleFieldLabel",{defaultMessage:"Timeline template"}),$=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndexFieldLabel",{defaultMessage:"Indicator index patterns"}),q=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatMappingFieldLabel",{defaultMessage:"Indicator mapping"}),G=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFiltersFieldLabel",{defaultMessage:"Indicator filters"}),U=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsByFieldLabel",{defaultMessage:"Suppress alerts by"}),H=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsForFieldLabel",{defaultMessage:"Suppress alerts for"}),W=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressionFieldMissingFieldLabel",{defaultMessage:"If a suppression field is missing"}),Q=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.newTermsFieldsFieldLabel",{defaultMessage:"Fields"}),K=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.historyWindowSizeFieldLabel",{defaultMessage:"History Window Size"}),J=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.intervalFieldLabel",{defaultMessage:"Runs every"}),Y=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.fromFieldLabel",{defaultMessage:"Additional look-back time"}),Z=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.maxAlertsFieldLabel",{defaultMessage:"Max alerts per run"}),X=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.customizedPrebuiltRuleLabel",{defaultMessage:"Customized Elastic rule"})},384:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(285),r=a(198);const i=()=>{const e=new URLSearchParams(window.location.search),t=e.has(r.a.flyout),a="()"!==e.get(r.a.flyout)&&"(preview:!())"!==e.get(r.a.flyout),i=t&&a,o=e.has(r.a.timelineFlyout),s="()"!==e.get(r.a.timelineFlyout)&&"(preview:!())"!==e.get(r.a.timelineFlyout),l=o&&s;return i&&l?n.a.timeline:i?n.a.securitySolution:l?n.a.timeline:null}},385:function(e,t,a){const n=a(190);e.exports=(e,t,a)=>n(e,t,a)>0},386:function(e,t,a){const n=Symbol("SemVer ANY");class Comparator{static get ANY(){return n}constructor(e,t){if(t=r(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?i[o.COMPARATORLOOSE]:i[o.COMPARATOR],a=e.match(t);if(!a)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==a[1]?a[1]:"","="===this.operator&&(this.operator=""),a[2]?this.semver=new c(a[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return s(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(e.value,t).test(this.value):""===e.operator?""===e.value||new u(this.value,t).test(e.semver):!((t=r(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(s(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(s(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=Comparator;const r=a(431),{safeRe:i,t:o}=a(311),s=a(673),l=a(347),c=a(164),u=a(193)},387:function(e,t,a){const n=a(193);e.exports=(e,t,a)=>{try{t=new n(t,a)}catch(e){return!1}return t.test(e)}},388:function(e,t,a){"use strict";var n=String.fromCharCode;e.exports=n},389:function(e,t,a){"use strict";var n=a(155),r=a(160),i={tokenize:function(e,t,a){return r(e,(function(e){return null===e||n(e)?t(e):a(e)}),"linePrefix")},partial:!0};e.exports=i},390:function(e,t,a){"use strict";var n=a(677);e.exports=function(e,t){var a=e[e.length-1];return a&&a[1].type===t?n(a[2].sliceStream(a[1])):0}},391:function(e,t,a){"use strict";var n=a(240)(/[\dA-Za-z]/);e.exports=n},407:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(23),r=a(47),i=a(2),o=a(159),s=a(322);const l=["GET",n.INTERNAL_ALERTING_API_FIND_RULES_PATH],c=(e,t)=>Object(r.useQuery)([...l,...e],(({signal:t})=>Object(o.k)({ids:e,signal:t})),{...s.a,...t}),u=()=>{const e=Object(r.useQueryClient)();return Object(i.useCallback)((()=>e.invalidateQueries(l,{refetchType:"active"})),[e])}},408:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"g",(function(){return c}));const n=["50%","50%"],r=["30%","70%"],i=["version","name","description","author","building_block","severity","severity_mapping","risk_score","risk_score_mapping","references","false_positives","license","rule_name_override","threat","threat_indicator_path","timestamp_override","tags"],o=["data_source","type","kql_query","eql_query","event_category_override","timestamp_field","tiebreaker_field","esql_query","anomaly_threshold","machine_learning_job_id","related_integrations","required_fields","timeline_template","threshold","threat_index","threat_mapping","threat_query","threat_indicator_path","concurrent_searches","items_per_search","alert_suppression","new_terms_fields","history_window_start","max_signals"],s=["rule_schedule"],l=["setup","note"],c=[...i,...o,...s,...l]},420:function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(178),r=a(223),i=a(563);const o=e=>"boolean"==typeof e,s=(e,t)=>{var a;return null==e||!((null===(a=e.actions)||void 0===a?void 0:a.length)>0&&o(t))||t},l=e=>null==e||e,c=(e,t,a,o)=>null==e?void 0:Object(r.d)(e.type)&&!t?i.d:s(e,a)?l(o)?void 0:n.kc:n.jc},421:function(e,t,a){const n=a(190);e.exports=(e,t,a)=>n(e,t,a)>=0},423:function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return y})),a.d(t,"c",(function(){return E}));var n=a(7),r=a(2),i=a.n(r),o=a(407),s=a(5),l=a(670),c=a(198),u=a(118),d=a(213),p=a(781),m=a(523),b=a(939),g=a(618);function f(e,t){const a=t.safeParse(e);if(a.success)return a.data}const h=Object(r.createContext)(null),v=({children:e})=>{var t,a,n,l,v,y,E,j,w;const[S]=Object(u.o)(s.Z),{sessionStorage:O}=Object(u.j)().services,{filter:k,sorting:I,pagination:T}=function(){const e=Object(d.g)(c.a.rulesTable),{services:{sessionStorage:t}}=Object(u.j)(),a=e(),n=function(e){try{return e.get(m.c)}catch{return null}}(t);if(!a&&!n)return{};const[r,i,o]=function(e,t){var a,n,r,i,o,l,c,u;const d=f(e,g.b),p=f(t,g.b),m={searchTerm:null!==(a=null==d?void 0:d.searchTerm)&&void 0!==a?a:null==p?void 0:p.searchTerm,source:null!==(n=null==d?void 0:d.source)&&void 0!==n?n:null==p?void 0:p.source,tags:null!==(r=null==d?void 0:d.tags)&&void 0!==r?r:null==p?void 0:p.tags,enabled:null!==(i=null==d?void 0:d.enabled)&&void 0!==i?i:null==p?void 0:p.enabled,ruleExecutionStatus:null!==(o=null==d?void 0:d.ruleExecutionStatus)&&void 0!==o?o:null==p?void 0:p.ruleExecutionStatus},b=f(e,g.c),h=f(t,g.c),v={field:null!==(l=null==b?void 0:b.field)&&void 0!==l?l:null==h?void 0:h.field,order:null!==(c=null==b?void 0:b.order)&&void 0!==c?c:null==h?void 0:h.order},y=f(e,g.e),E=f(t,g.d),x={page:null==y?void 0:y.page,perPage:null!==(u=null==y?void 0:y.perPage)&&void 0!==u?u:null==E?void 0:E.perPage};return x.perPage&&(x.perPage<0||x.perPage>s.Dc)&&delete x.perPage,[m,v,x]}(a,n);return{filter:r,sorting:i,pagination:o}}(),[C,M]=Object(r.useState)({filter:null!==(t=null==k?void 0:k.searchTerm)&&void 0!==t?t:b.a.filter,tags:null!==(a=null==k?void 0:k.tags)&&void 0!==a?a:b.a.tags,showCustomRules:null!==(n=(null==k?void 0:k.source)===g.a.Custom)&&void 0!==n?n:b.a.showCustomRules,showElasticRules:null!==(l=(null==k?void 0:k.source)===g.a.Prebuilt)&&void 0!==l?l:b.a.showElasticRules,enabled:null==k?void 0:k.enabled,ruleExecutionStatus:null!==(v=null==k?void 0:k.ruleExecutionStatus)&&void 0!==v?v:b.a.ruleExecutionStatus}),[F,D]=Object(r.useState)({field:null!==(y=null==I?void 0:I.field)&&void 0!==y?y:b.d.field,order:null!==(E=null==I?void 0:I.order)&&void 0!==E?E:b.d.order}),[P,L]=Object(r.useState)(!1),[N,R]=Object(r.useState)(S.on),[_,A]=Object(r.useState)({ids:[],action:null}),[z,B]=Object(r.useState)(!1),[V,$]=Object(r.useState)(null!==(j=null==T?void 0:T.page)&&void 0!==j?j:b.b),[q,G]=Object(r.useState)(null!==(w=null==T?void 0:T.perPage)&&void 0!==w?w:b.c),[U,H]=Object(r.useState)([]),W=Object(r.useRef)(null),Q=_.ids.length>0,K=Object(r.useMemo)((()=>({page:V,perPage:q})),[V,q]),J=Object(r.useCallback)((e=>{M((t=>({...t,...e}))),$(1),H([]),L(!1)}),[]),Y=Object(r.useCallback)((()=>{H([]),L(!1)}),[]),Z=Object(d.h)(),X=Object(r.useCallback)((()=>{M({filter:b.a.filter,showElasticRules:b.a.showElasticRules,showCustomRules:b.a.showCustomRules,tags:b.a.tags,enabled:void 0,ruleExecutionStatus:b.a.ruleExecutionStatus}),D({field:b.d.field,order:b.d.order}),$(b.b),G(b.c),Z({[c.a.rulesTable]:null}),O.remove(m.c)}),[M,D,$,G,Z,O]);Object(r.useEffect)((()=>{var e;U.length>0?(R(!1),null==W.current&&(W.current=N)):(R(null!==(e=W.current)&&void 0!==e?e:N),W.current=null)}),[U,N]);const{data:{rules:ee,total:te}={rules:[],total:0},refetch:ae,dataUpdatedAt:ne,isFetched:re,isFetching:ie,isLoading:oe,isRefetching:se}=Object(p.a)({filterOptions:C,sortingOptions:F,pagination:K},{refetchOnWindowFocus:N&&!Q,refetchOnReconnect:N&&!Q,refetchInterval:N&&!Q&&S.value,keepPreviousData:!0}),{data:le,isLoading:ce,isFetching:ue,isError:de,refetch:pe}=Object(o.a)(ee.map((e=>e.id)),{enabled:ee.length>0}),me=Object(r.useCallback)((async()=>{const e=await ae();return await pe(),e}),[ae,pe]),be=Object(r.useMemo)((()=>({reFetchRules:me,setFilterOptions:J,setIsAllSelected:L,setIsRefreshOn:R,setLoadingRules:A,setPage:$,setPerPage:G,setSelectedRuleIds:H,setSortingOptions:D,clearRulesSelection:Y,setIsPreflightInProgress:B,clearFilters:X})),[me,J,L,R,A,$,G,H,D,Y,B,X]),ge=Object(r.useMemo)((()=>({state:{rules:ee,rulesSnoozeSettings:{data:null!=le?le:{},isLoading:ce,isFetching:ue,isError:de},pagination:{page:V,perPage:q,total:te},filterOptions:C,isPreflightInProgress:z,isActionInProgress:Q,isAllSelected:P,isFetched:re,isFetching:ie,isLoading:oe,isRefetching:se,isRefreshOn:N,lastUpdated:ne,loadingRuleIds:_.ids,loadingRulesAction:_.action,selectedRuleIds:U,sortingOptions:F,isDefault:x(C,F,{page:V,perPage:q,total:te})},actions:be})),[ee,le,ce,ue,de,V,q,te,C,z,Q,P,re,ie,oe,se,N,ne,_.ids,_.action,U,F,be]);return i.a.createElement(h.Provider,{value:ge},e)},y=()=>{const e=Object(r.useContext)(h);return Object(l.a)(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},E=()=>Object(r.useContext)(h);function x(e,t,a){return Object(n.isEqual)(e,b.a)&&Object(n.isEqual)(t,b.d)&&a.page===b.b&&a.perPage===b.c}},436:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return g}));var n=a(19),r=a(2),i=a.n(r),o=a(42),s=a(4),l=a(1103),c=a(488),u=a(135),d=a(254);const p={OVERVIEW_TAB:c.c,RULE_PREVIEW:u.gb,NAVIGATION_BUTTON:l.f,ENTITIES:d.c,PREVALENCE:d.e},m={currentTourStep:1,isTourActive:!0},b=()=>[{title:s.i18n.translate("xpack.securitySolution.flyout.tour.overview.title",{defaultMessage:"More ways to understand your alerts"}),content:i.a.createElement(n.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.overview.description",defaultMessage:"Explore new insights in the {entities} and {prevalence} sections.",values:{entities:i.a.createElement(n.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.overview.entities.text",{defaultMessage:"Entities"})),prevalence:i.a.createElement(n.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.overview.prevalence.text",{defaultMessage:"Prevalence"}))}})),stepNumber:1,anchor:p.OVERVIEW_TAB,anchorPosition:"downCenter"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.preview.title",{defaultMessage:"A quick way to access rule details"}),content:i.a.createElement(n.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.rulePreview.description",defaultMessage:"Click {rulePreview} to learn more about the rule that generated the alert.",values:{rulePreview:i.a.createElement(n.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.rulePreview.text",{defaultMessage:"Show rule summary"}))}})),stepNumber:2,anchor:p.RULE_PREVIEW,anchorPosition:"rightUp"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.expandDetails.title",{defaultMessage:"An expanded view of important alert details"}),content:i.a.createElement(n.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.expandDetails.description",defaultMessage:"Click the linked text to open and close the flyout's left panel. The left panel is a detailed view of sections in the right panel."})),stepNumber:3,anchor:p.NAVIGATION_BUTTON,anchorPosition:"downCenter"}],g=()=>[{title:s.i18n.translate("xpack.securitySolution.flyout.tour.entities.title",{defaultMessage:"New host and user insights are available"}),content:i.a.createElement(n.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.entities.description",defaultMessage:"Check out the expanded {entities} view to learn more about hosts and users that are related to the alert.",values:{entities:i.a.createElement(n.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.entities.text",{defaultMessage:"Entities"}))}})),stepNumber:4,anchor:p.ENTITIES,anchorPosition:"rightUp"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.prevalence.title",{defaultMessage:"New host and user insights are available"}),content:i.a.createElement(n.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.prevalence.description",defaultMessage:"Check out the expanded {prevalence} view to learn how the alert is related to other alerts, events, and entities.",values:{prevalence:i.a.createElement(n.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.prevalence.text",{defaultMessage:"Prevalence"}))}})),stepNumber:5,anchor:p.PREVALENCE,anchorPosition:"rightUp"}]},437:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(2),r=a(47),i=a(473),o=a(159),s=a(322);const l=["GET",i.b],c=e=>Object(r.useQuery)(l,(async({signal:e})=>await Object(o.i)({signal:e})),{...s.a,...e}),u=()=>{const e=Object(r.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},438:function(e,t,a){"use strict";a.d(t,"g",(function(){return f})),a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return y})),a.d(t,"f",(function(){return E})),a.d(t,"e",(function(){return j})),a.d(t,"d",(function(){return O})),a.d(t,"c",(function(){return k}));var n=a(44),r=a(54),i=a.n(r),o=a(413),s=a.n(o),l=a(1193),c=a.n(l),u=a(168),d=a(227),p=a(731),m=a(248),b=a(564),g=a(20);const f=e=>{const t={unit:"ms",value:0},a=e.match(/\d+/g),r=e.match(/[a-zA-Z]+/g);return Object(n.isEmpty)(a)||null==a||isNaN(Number(a[0]))||(t.value=Number(a[0])),!Object(n.isEmpty)(r)&&null!=r&&["s","m","h","d"].includes(r[0])&&(t.unit=r[0]),t},h=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:a,threshold:n,threatIndex:r,threatQueryBar:i,threatMapping:o,eqlOptions:s,newTermsFields:l,historyWindowSize:c,...u}=e;return u;case"threshold":const{anomalyThreshold:d,machineLearningJobId:p,threatIndex:m,threatQueryBar:b,threatMapping:g,eqlOptions:f,newTermsFields:h,historyWindowSize:v,...y}=e;return y;case"threat_match":const{anomalyThreshold:E,machineLearningJobId:x,threshold:j,eqlOptions:w,newTermsFields:S,historyWindowSize:O,...k}=e;return k;case"query":case"saved_query":const{anomalyThreshold:I,machineLearningJobId:T,threshold:C,threatIndex:M,threatQueryBar:F,threatMapping:D,eqlOptions:P,newTermsFields:L,historyWindowSize:N,...R}=e;return R;case"eql":const{anomalyThreshold:_,machineLearningJobId:A,threshold:z,threatIndex:B,threatQueryBar:V,threatMapping:$,newTermsFields:q,historyWindowSize:G,...U}=e;return U;case"new_terms":const{anomalyThreshold:H,machineLearningJobId:W,threshold:Q,threatIndex:K,threatQueryBar:J,threatMapping:Y,eqlOptions:Z,...X}=e;return X;case"esql":const{anomalyThreshold:ee,machineLearningJobId:te,threshold:ae,threatIndex:ne,threatQueryBar:re,threatMapping:ie,newTermsFields:oe,historyWindowSize:se,eqlOptions:le,index:ce,dataViewId:ue,...de}=e;return de}Object(d.a)(t)};function v(e){return e.filter((e=>"none"!==e.name))}const y=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:v(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?v(e.subtechnique):[]})))}})),E=e=>{const t={...e};return e.dataSourceType===m.a.DataView?c()(t,["index","dataSourceType"]):e.dataSourceType===m.a.IndexPatterns?c()(t,["dataViewId","dataSourceType"]):t},x=e=>{var t,a,r,i,o,s,l,c,u,d,p,b,f,v,y,x,j,w,S,O,k,I,T,C,M,F,D,P,L,N,R,_,A,z,B,V,$,q,G,U,H,W,Q,K,J,Y,Z,X,ee,te,ae,ne;const re=E(e),ie=h(re,re.ruleType),{ruleType:oe,timeline:se}=ie,le={type:oe,related_integrations:null===(t=e.relatedIntegrations)||void 0===t?void 0:t.filter((e=>!Object(n.isEmpty)(e.package))),...null!=se.id&&null!=se.title&&{timeline_id:se.id,timeline_title:se.title}},ce=ie.groupByFields.length>0?{alert_suppression:{group_by:ie.groupByFields,duration:ie.groupByRadioSelection===m.b.PerTimePeriod?ie.groupByDuration:void 0,missing_fields_strategy:ie.suppressionMissingFields||g.a}}:{},ue=(e=>e.filter((e=>""!==e.name&&""!==e.type)))(null!==(a=e.requiredFields)&&void 0!==a?a:[]);var de;return{...le,...(de=ie,Object(n.has)("anomalyThreshold",de)?{anomaly_threshold:ie.anomalyThreshold,machine_learning_job_id:ie.machineLearningJobId,...ce}:(e=>Object(n.has)("threshold",e))(ie)?{index:ie.index,filters:null===(r=ie.queryBar)||void 0===r?void 0:r.filters,language:null===(i=ie.queryBar)||void 0===i||null===(o=i.query)||void 0===o?void 0:o.language,query:null===(s=ie.queryBar)||void 0===s||null===(l=s.query)||void 0===l?void 0:l.query,saved_id:null!==(c=null===(u=ie.queryBar)||void 0===u?void 0:u.saved_id)&&void 0!==c?c:void 0,required_fields:ue,..."threshold"===oe&&{threshold:{field:null!==(d=null===(p=ie.threshold)||void 0===p?void 0:p.field)&&void 0!==d?d:[],value:null!==(b=parseInt(null===(f=ie.threshold)||void 0===f?void 0:f.value,10))&&void 0!==b?b:0,cardinality:Object(n.isEmpty)(null===(v=ie.threshold.cardinality)||void 0===v?void 0:v.field)||null==(null===(y=ie.threshold.cardinality)||void 0===y?void 0:y.value)?[]:[{field:ie.threshold.cardinality.field[0],value:parseInt(ie.threshold.cardinality.value,10)}]},...ie.enableThresholdSuppression&&{alert_suppression:{duration:ie.groupByDuration}}}}:(e=>Object(n.has)("threatIndex",e))(ie)?{index:ie.index,filters:null===(x=ie.queryBar)||void 0===x?void 0:x.filters,language:null===(j=ie.queryBar)||void 0===j||null===(w=j.query)||void 0===w?void 0:w.language,query:null===(S=ie.queryBar)||void 0===S||null===(O=S.query)||void 0===O?void 0:O.query,saved_id:null!==(k=null===(I=ie.queryBar)||void 0===I?void 0:I.saved_id)&&void 0!==k?k:void 0,required_fields:ue,threat_index:ie.threatIndex,threat_query:null===(T=ie.threatQueryBar)||void 0===T||null===(C=T.query)||void 0===C?void 0:C.query,threat_filters:null===(M=ie.threatQueryBar)||void 0===M?void 0:M.filters,threat_mapping:ie.threatMapping,threat_language:null===(F=ie.threatQueryBar)||void 0===F||null===(D=F.query)||void 0===D?void 0:D.language,...ce}:(e=>Object(n.has)("eqlOptions",e))(ie)?{index:ie.index,filters:null===(P=ie.queryBar)||void 0===P?void 0:P.filters,language:null===(L=ie.queryBar)||void 0===L||null===(N=L.query)||void 0===N?void 0:N.language,query:null===(R=ie.queryBar)||void 0===R||null===(_=R.query)||void 0===_?void 0:_.query,saved_id:null!==(A=null===(z=ie.queryBar)||void 0===z?void 0:z.saved_id)&&void 0!==A?A:void 0,required_fields:ue,timestamp_field:null===(B=ie.eqlOptions)||void 0===B?void 0:B.timestampField,event_category_override:null===(V=ie.eqlOptions)||void 0===V?void 0:V.eventCategoryField,tiebreaker_field:null===($=ie.eqlOptions)||void 0===$?void 0:$.tiebreakerField,...ce}:(e=>Object(n.has)("newTermsFields",e))(ie)?{index:ie.index,filters:null===(q=ie.queryBar)||void 0===q?void 0:q.filters,language:null===(G=ie.queryBar)||void 0===G||null===(U=G.query)||void 0===U?void 0:U.language,query:null===(H=ie.queryBar)||void 0===H||null===(W=H.query)||void 0===W?void 0:W.query,required_fields:ue,new_terms_fields:ie.newTermsFields,history_window_start:`now-${ie.historyWindowSize}`,...ce}:(e=>"esql"===Object(n.get)("queryBar.query.language",e))(ie)&&!("index"in ie)?{language:null===(Q=ie.queryBar)||void 0===Q||null===(K=Q.query)||void 0===K?void 0:K.language,query:null===(J=ie.queryBar)||void 0===J||null===(Y=J.query)||void 0===Y?void 0:Y.query,required_fields:ue,...ce}:{...ce,index:ie.index,filters:null===(Z=ie.queryBar)||void 0===Z?void 0:Z.filters,language:null===(X=ie.queryBar)||void 0===X||null===(ee=X.query)||void 0===ee?void 0:ee.language,query:null===(te=ie.queryBar)||void 0===te||null===(ae=te.query)||void 0===ae?void 0:ae.query,saved_id:void 0,required_fields:ue,type:"query",...["query","saved_query"].includes(oe)&&(null===(ne=ie.queryBar)||void 0===ne?void 0:ne.saved_id)&&ie.shouldLoadQueryDynamically&&{type:"saved_query",query:void 0,filters:void 0,saved_id:ie.queryBar.saved_id}}),..."dataViewId"in ie?{data_view_id:ie.dataViewId}:{}}},j=e=>{const{...t}=e;if(!Object(n.isEmpty)(t.interval)&&!Object(n.isEmpty)(t.from)){const{unit:e,value:a}=f(t.interval),{unit:n,value:r}=f(t.from),o=i.a.duration(a,e);o.add(r,n),t.from=`now-${o.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},w=(e,t)=>{const{author:a,falsePositives:r,investigationFields:i,references:o,riskScore:s,severity:l,threat:c,isAssociatedToEndpointList:d,isBuildingBlock:p,maxSignals:m,note:b,ruleNameOverride:g,threatIndicatorPath:f,timestampOverride:h,timestampOverrideFallbackDisabled:v,...E}=e,x=null!=t?t.filter((e=>"endpoint"!==e.type)):[],j=i.every((e=>Object(n.isEmpty)(e.trim())));return{author:a.filter((e=>!Object(n.isEmpty)(e))),...p?{building_block_type:"default"}:{},...d?{exceptions_list:[{id:u.k,list_id:u.k,namespace_type:"agnostic",type:"endpoint"},...x]}:null!=t?{exceptions_list:[...x]}:{},false_positives:r.filter((e=>!Object(n.isEmpty)(e))),references:o.filter((e=>!Object(n.isEmpty)(e))),investigation_fields:j?void 0:{field_names:i},risk_score:s.value,risk_score_mapping:s.isMappingChecked?s.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==g?g:void 0,severity:l.value,severity_mapping:l.isMappingChecked?l.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:y(c).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:f,timestamp_override:""!==h?h:void 0,timestamp_override_fallback_disabled:v,...Object(n.isEmpty)(b)?{}:{note:b},max_signals:Number.isSafeInteger(m)?m:void 0,...E}},S=e=>{const{actions:t=[],responseActions:a,enabled:n,kibanaSiemAppUrl:r}=e;return{actions:t.map((e=>Object(p.b)(e))),response_actions:null==a?void 0:a.map(p.c),enabled:n,meta:{kibana_siem_app_url:r}}},O=(e,t,a,n,r)=>s.a.all([x(e),w(t,r),j(a),S(n)]),k=({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:n})=>{const r={...t,name:"Preview Rule",description:"Preview Rule"};return{...O(e,r,a,b.c,n)}}},442:function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return h}));var n=a(47),r=a(2),i=a(489),o=a(273),s=a(159),l=a(7);const c=["TA0043","TA0042","TA0001","TA0002","TA0003","TA0004","TA0005","TA0006","TA0007","TA0008","TA0009","TA0011","TA0010","TA0040"];function u(e){const t={totalRulesCount:Object.keys(e).length,totalEnabledRulesCount:0};for(const a of Object.keys(e))e[a].activity===o.b.Enabled&&t.totalEnabledRulesCount++;return t}function d(e){const t={enabledRules:[],disabledRules:[],availableRules:[]};for(const a of e.unmapped_rule_ids)p(t,a,e.rules_data[a]);return t}function p(e,t,a){a&&(a.activity===o.b.Enabled?e.enabledRules.push({id:t,name:a.name}):a.activity===o.b.Disabled&&e.disabledRules.push({id:t,name:a.name}))}var m=a(322),b=a(123);const g=["POST",o.d],f=(e={},t)=>{const{addError:r}=Object(b.a)();return Object(n.useQuery)([...g,e],(async({signal:t})=>async function(e){const t=await a.e(24).then(a.bind(null,1481)),{tactics:n,techniques:r,subtechniques:i}=t,o=function(e,t,a){const n=new Map;for(const e of a){const t={id:e.id,name:e.name,reference:e.reference,enabledRules:[],disabledRules:[],availableRules:[]},a=n.get(e.techniqueId);a?a.push(t):n.set(e.techniqueId,[t])}const r=new Map;for(const e of t){var i;const t=null!==(i=n.get(e.id))&&void 0!==i?i:[];for(const a of e.tactics){const n={id:e.id,name:e.name,reference:e.reference,subtechniques:t,enabledRules:[],disabledRules:[],availableRules:[]},i=r.get(a);i?i.push(n):r.set(a,[n])}}const o=e.sort(((e,t)=>c.indexOf(e.id)-c.indexOf(t.id))),s=[];for(const e of o){var u;s.push({id:e.id,name:e.name,reference:e.reference,techniques:null!==(u=r.get(Object(l.kebabCase)(e.name)))&&void 0!==u?u:[],enabledRules:[],disabledRules:[],availableRules:[]})}return s}(n,r,i);for(const t of o){for(const a of null!==(s=e.coverage[t.id])&&void 0!==s?s:[]){var s;p(t,a,e.rules_data[a])}for(const a of t.techniques){for(const n of null!==(m=e.coverage[a.id])&&void 0!==m?m:[]){var m,b;null!==(b=e.coverage[t.id])&&void 0!==b&&b.includes(n)&&p(a,n,e.rules_data[n])}for(const n of a.subtechniques)for(const a of null!==(g=e.coverage[n.id])&&void 0!==g?g:[]){var g,f;null!==(f=e.coverage[t.id])&&void 0!==f&&f.includes(a)&&p(n,a,e.rules_data[a])}}}return{mitreTactics:o,unmappedRules:d(e),metrics:u(e.rules_data)}}(await Object(s.g)({signal:t,filter:e}))),{...m.a,...t,onError:e=>{r(e,{title:i.c})}})},h=()=>{const e=Object(n.useQueryClient)();return Object(r.useCallback)((()=>{e.invalidateQueries(g,{refetchType:"active"})}),[e])}},459:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),r=a(4),i=a(45),o=a(166),s=a(132),l=a(127),c=a(294),u=a(123),d=a(118),p=a(864);const m=()=>{const{indicesExist:e,dataViewId:t}=Object(s.a)(l.SourcererScopeName.detections),{indexFieldsSearch:a}=Object(c.b)(),m=Object(i.useDispatch)(),{addError:b}=Object(u.a)(),g=Object(n.useRef)(new AbortController),{data:{dataViews:f}}=Object(d.j)().services,h=Object(i.useSelector)(o.d.signalIndexName),v=Object(i.useSelector)(o.d.defaultDataView),y=Object(n.useMemo)((()=>!v.title.includes(`${h}`)),[v.title,h]),E=Object(n.useMemo)((()=>!e&&!y),[e,y]),x=Object(n.useCallback)((()=>{null!==h&&(g.current.abort(),(async()=>{g.current=new AbortController;try{const e=await Object(p.a)({body:{patternList:v.title.split(",")},signal:g.current.signal,dataViewId:t,dataViewService:f});null!==h&&null!=e&&e.defaultDataView.patternList.includes(h)&&(a({dataViewId:e.defaultDataView.id}),m(o.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||b(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[b,t,f,v.title,m,a,h]);return{...E?{pollForSignalIndex:x}:{},signalIndexNeedsInit:y}}},488:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(211);const r=`${n.a}Body`,i=`${n.a}OverviewTab`,o=`${n.a}OverviewTabLabel`,s=`${n.a}TableTab`,l=`${n.a}JsonTab`},489:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"x",(function(){return o})),a.d(t,"t",(function(){return s})),a.d(t,"v",(function(){return l})),a.d(t,"y",(function(){return c})),a.d(t,"w",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"s",(function(){return m})),a.d(t,"u",(function(){return b})),a.d(t,"o",(function(){return g})),a.d(t,"n",(function(){return f})),a.d(t,"m",(function(){return h})),a.d(t,"j",(function(){return v})),a.d(t,"h",(function(){return y})),a.d(t,"i",(function(){return E})),a.d(t,"f",(function(){return x})),a.d(t,"p",(function(){return j})),a.d(t,"q",(function(){return w})),a.d(t,"r",(function(){return S})),a.d(t,"l",(function(){return O})),a.d(t,"k",(function(){return k})),a.d(t,"g",(function(){return I})),a.d(t,"c",(function(){return T}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.pageTitle",{defaultMessage:"MITRE ATT&CK® coverage"}),i=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.collapseCellsButton",{defaultMessage:"Collapse cells"}),o=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.expandCellsButton",{defaultMessage:"Expand cells"}),s=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesMetadataLabel",{defaultMessage:"Disabled Rules:"}),l=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesMetadataLabel",{defaultMessage:"Enabled Rules:"}),c=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.subtechniques",{defaultMessage:"Sub-techniques"}),u=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enableAllDisabledButtonLabel",{defaultMessage:"Enable all disabled"}),d=(e,t)=>n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreTechniques",{values:{enabledTechniques:e,totalTechniques:t},defaultMessage:"{enabledTechniques}/{totalTechniques} techniques"}),p=(e,t)=>n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreSubtechniques",{values:{enabledSubtechniques:e,totalSubtechniques:t},defaultMessage:"Sub-techniques {enabledSubtechniques}/{totalSubtechniques}"}),m=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesListLabel",{defaultMessage:"Disabled rules"}),b=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesListLabel",{defaultMessage:"Enabled rules"}),g=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendTitle",{defaultMessage:"Legend"}),f=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendSubtitle",{defaultMessage:"(count will include all rules selected)"}),h=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendRulesLabel",{defaultMessage:"rules"}),v=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRuleActivity",{defaultMessage:"Enabled rules"}),y=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRuleActivity",{defaultMessage:"Disabled rules"}),E=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.elasticRuleSource",{defaultMessage:"Elastic rules"}),x=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.customRuleSource",{defaultMessage:"Custom rules"}),j=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleActivityFilterLabel",{defaultMessage:"Installed rule status"}),w=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleSourceFilterLabel",{defaultMessage:"Installed rule type"}),S=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.searchBarPlaceholder",{defaultMessage:'Search for the tactic, technique (e.g.,"defense evasion" or "TA0005") or rule name'}),O=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverTitle",{defaultMessage:"Select to view on framework"}),k=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverClearAll",{defaultMessage:"Clear all"}),I=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.dashboardInformation",{defaultMessage:"Your current coverage of MITRE ATT&CK® tactics and techniques, based on installed rules. Click a cell to view and enable a technique's rules. Rules must be mapped to the MITRE ATT&CK® framework to be displayed."}),T=n.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.fetchErrorTitle",{defaultMessage:"Failed to fetch coverage overview data"})},490:function(e,t,a){const n=a(164);e.exports=(e,t,a)=>{const r=new n(e,a),i=new n(t,a);return r.compare(i)||r.compareBuild(i)}},491:function(e,t,a){const n=a(190);e.exports=(e,t,a)=>n(e,t,a)<0},492:function(e,t,a){const n=a(190);e.exports=(e,t,a)=>n(e,t,a)<=0},493:function(e,t,a){const n=a(164),r=a(386),{ANY:i}=r,o=a(193),s=a(387),l=a(385),c=a(491),u=a(492),d=a(421);e.exports=(e,t,a,p)=>{let m,b,g,f,h;switch(e=new n(e,p),t=new o(t,p),a){case">":m=l,b=u,g=c,f=">",h=">=";break;case"<":m=c,b=d,g=l,f="<",h="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,p))return!1;for(let a=0;a<t.set.length;++a){const n=t.set[a];let o=null,s=null;if(n.forEach((e=>{e.semver===i&&(e=new r(">=0.0.0")),o=o||e,s=s||e,m(e.semver,o.semver,p)?o=e:g(e.semver,s.semver,p)&&(s=e)})),o.operator===f||o.operator===h)return!1;if((!s.operator||s.operator===f)&&b(e,s.semver))return!1;if(s.operator===h&&g(e,s.semver))return!1}return!0}},494:function(e,t,a){"use strict";e.exports=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}},495:function(e,t,a){"use strict";e.exports=function(e){return null==e?[]:"length"in e?e:[e]}},496:function(e,t,a){"use strict";var n=a(238);e.exports=function(e,t){return e.length?(n(e,e.length,0,t),e):t}},497:function(e,t,a){"use strict";e.exports=function(e,t,a){for(var n,r=[],i=-1;++i<e.length;)(n=e[i].resolveAll)&&r.indexOf(n)<0&&(t=n(t,a),r.push(n));return t}},498:function(e,t,a){"use strict";var n=a(240)(/[A-Za-z]/);e.exports=n},499:function(e,t,a){"use strict";var n=a(239),r=a(496),i=a(238),o=a(494),s=a(497),l=a(286),c=a(683),u=a(684),d=a(686),p=a(685),m={name:"labelEnd",tokenize:function(e,t,a){for(var n,r,i=this,s=i.events.length;s--;)if(("labelImage"===i.events[s][1].type||"labelLink"===i.events[s][1].type)&&!i.events[s][1]._balanced){n=i.events[s][1];break}return function(t){return n?n._inactive?c(t):(r=i.parser.defined.indexOf(o(i.sliceSerialize({start:n.end,end:i.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):a(t)};function l(a){return 40===a?e.attempt(b,t,r?t:c)(a):91===a?e.attempt(g,t,r?e.attempt(f,t,c):c)(a):r?t(a):c(a)}function c(e){return n._balanced=!0,a(e)}},resolveTo:function(e,t){for(var a,n,o,c,u,d,p,m=e.length,b=0;m--;)if(c=e[m][1],u){if("link"===c.type||"labelLink"===c.type&&c._inactive)break;"enter"===e[m][0]&&"labelLink"===c.type&&(c._inactive=!0)}else if(d){if("enter"===e[m][0]&&("labelImage"===c.type||"labelLink"===c.type)&&!c._balanced&&(u=m,"labelLink"!==c.type)){b=2;break}}else"labelEnd"===c.type&&(d=m);return a={type:"labelLink"===e[u][1].type?"link":"image",start:l(e[u][1].start),end:l(e[e.length-1][1].end)},n={type:"label",start:l(e[u][1].start),end:l(e[d][1].end)},o={type:"labelText",start:l(e[u+b+2][1].end),end:l(e[d-2][1].start)},p=r(p=[["enter",a,t],["enter",n,t]],e.slice(u+1,u+b+3)),p=r(p,[["enter",o,t]]),p=r(p,s(t.parser.constructs.insideSpan.null,e.slice(u+b+4,d-3),t)),p=r(p,[["exit",o,t],e[d-2],e[d-1],["exit",n,t]]),p=r(p,e.slice(d+1)),p=r(p,[["exit",a,t]]),i(e,u,e.length,p),e},resolveAll:function(e){for(var t,a=-1;++a<e.length;)(t=e[a][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(a+1,"labelImage"===t.type?4:2),t.type="data",a++);return e}},b={tokenize:function(e,t,a){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),p(e,r)};function r(t){return 41===t?s(t):c(e,i,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function i(t){return n(t)?p(e,o)(t):s(t)}function o(t){return 34===t||39===t||40===t?d(e,p(e,s),a,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):s(t)}function s(n){return 41===n?(e.enter("resourceMarker"),e.consume(n),e.exit("resourceMarker"),e.exit("resource"),t):a(n)}}},g={tokenize:function(e,t,a){var n=this;return function(t){return u.call(n,e,r,a,"reference","referenceMarker","referenceString")(t)};function r(e){return n.parser.defined.indexOf(o(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))<0?a(e):t(e)}}},f={tokenize:function(e,t,a){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),n};function n(n){return 93===n?(e.enter("referenceMarker"),e.consume(n),e.exit("referenceMarker"),e.exit("reference"),t):a(n)}}};e.exports=m},500:function(e,t,a){"use strict";a.d(t,"a",(function(){return _e}));var n=a(19),r=a(2),i=a.n(r),o=a(45),s=a(4);const l=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),u=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),p=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),m=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),b=s.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),g=s.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),f=s.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),h=s.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),v=s.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),y=s.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),E=s.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),x=s.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),j=s.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),w=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),S=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),O=s.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),k=s.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),I=s.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),T=s.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),C=s.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),M=s.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),F=s.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),D=s.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),P=s.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),L=s.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),N=s.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),R=s.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),_=s.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),A=s.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),z=s.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),B=s.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),V=s.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var $=a(166),q=a(127),G=a(531),U=a(41),H=a.n(U),W=a(49);const Q=H()(n.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1bcjjxf-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),K=H()(n.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1bcjjxf-1"})(["max-width:none;"]),J=H()(n.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1bcjjxf-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),Y=H()(n.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1bcjjxf-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),Z=H.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1bcjjxf-4"})(["width:600px;"]),X=H()(n.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1bcjjxf-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],W.euiThemeVars.euiSizeXS),ee=H.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1bcjjxf-6"})(["",""],(({theme:e})=>Object(U.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),te=(e,t)=>e.filter((e=>e!==t));var ae=a(308),ne=a(118),re=a(511);const ie=(e,t)=>Object(ae.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var oe=a(42);const se=H()(n.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-yfgyo3-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),le=i.a.memo((({isShowing:e,onDismissModal:t,onContinue:a,onUpdate:r,missingPatterns:o})=>e?i.a.createElement(se,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},i.a.createElement(n.EuiModalHeader,null,i.a.createElement(n.EuiModalHeaderTitle,null,h)),i.a.createElement(n.EuiModalBody,null,i.a.createElement(n.EuiText,{size:"s"},i.a.createElement(n.EuiTextColor,{color:"subdued"},i.a.createElement("p",null,i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:i.a.createElement(ee,null,o.join(", "))}}),f))),i.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(Y,{"aria-label":v,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:a,title:v},v)),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:r,size:"s"},y))))):null));le.displayName="UpdateDefaultDataViewModal";var ce=a(149),ue=a(121),de=a(129),pe=a(124),me=a(158);const be=({activePatterns:e,deadPatterns:t,selectedPatterns:a,timelineType:o})=>{const s=Object(r.useMemo)((()=>t.length>0?i.a.createElement(n.EuiToolTip,{content:i.a.createElement(ge,{activePatterns:e,selectedPatterns:a,timelineType:o})},i.a.createElement(n.EuiIcon,{type:"questionInCircle",title:N})):null),[e,t.length,a,o]);return o===ue.m.template?i.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:s,callout:i.a.createElement(ee,null,e.join(", "))}})):i.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:s,callout:i.a.createElement(ee,null,e.join(", "))}}))},ge=({activePatterns:e,selectedPatterns:t,timelineType:a})=>{const n=Object(r.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return a===ue.m.template?i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}}):i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}})},fe=({timelineType:e,selectedPatterns:t})=>{const a=Object(r.useMemo)((()=>i.a.createElement(ee,null,t.join(", "))),[t]);return e===ue.m.template?i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:a}}):i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:a}})},he=({onReset:e,timelineType:t})=>t===ue.m.template?i.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:i.a.createElement(n.EuiLink,{onClick:e},b)}})):i.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:i.a.createElement(n.EuiLink,{onClick:e},b)}})),ve=({onReset:e,timelineType:t})=>t===ue.m.template?i.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:i.a.createElement(n.EuiLink,{onClick:e},b)}})):i.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:i.a.createElement(n.EuiLink,{onClick:e},b)}})),ye={deprecated:{title:{[ue.m.default]:c,[ue.m.template]:u},update:D},missingPatterns:{title:{[ue.m.default]:d,[ue.m.template]:p},update:y}},Ee=i.a.memo((({activePatterns:e,indicesExist:t,isModified:a,onDismiss:o,onReset:s,onUpdate:l,selectedPatterns:c,missingPatterns:u})=>{const d=Object(r.useMemo)((()=>i.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:l,size:"s",disabled:!t},ye[a].update)),[t,a,l]),p=Object(r.useMemo)((()=>t?d:i.a.createElement(n.EuiToolTip,{position:"top",content:R,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),m=e&&e.length>0?c.filter((t=>!e.includes(t))):[],b=Object(r.useMemo)((()=>de.b.getTimelineByIdSelector()),[]),g=Object(pe.a)((e=>{var t;return(null!==(t=b(e,ce.f.active))&&void 0!==t?t:me.b).timelineType}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:ye[a].title[g]}),i.a.createElement(n.EuiSpacer,{size:"s"}),i.a.createElement(n.EuiText,{size:"s"},i.a.createElement(n.EuiTextColor,{color:"subdued"},i.a.createElement("p",null,e&&e.length>0?i.a.createElement(be,{timelineType:g,activePatterns:e,deadPatterns:m,selectedPatterns:c}):i.a.createElement(fe,{timelineType:g,selectedPatterns:c}),"deprecated"===a&&i.a.createElement(he,{timelineType:g,onReset:s}),"missingPatterns"===a&&i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:i.a.createElement(ee,null,u.join(", "))}})),i.a.createElement(ve,{timelineType:g,onReset:s}))))),i.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(Y,{"aria-label":L,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:o,title:L},L)),i.a.createElement(n.EuiFlexItem,{grow:!1},p)))}));Ee.displayName="TemporarySourcererComp";const xe=i.a.memo((({activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onContinueWithoutUpdate:r,onDismiss:o,onReset:s,onUpdateStepOne:l,onUpdateStepTwo:c,selectedPatterns:u,isShowingUpdateModal:d,onDismissModal:p})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Ee,{activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onDismiss:o,onReset:s,onUpdate:l,selectedPatterns:u}),i.a.createElement(le,{isShowing:d,missingPatterns:n,onDismissModal:p,onContinue:r,onUpdate:c}))));xe.displayName="TemporarySourcerer";var je=a(132),we=a(393),Se=a(5);const Oe=H()(n.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-12c6aaf-0"})(["float:right;"]),ke=i.a.memo((()=>{const e=Object(r.useCallback)((()=>{document.location.reload()}),[]);return i.a.createElement(Oe,{onClick:e,"data-test-subj":"page-refresh"},B)}));ke.displayName="RefreshButton";var Ie=a(123);const Te=({activePatterns:e,disabled:t,isModified:a,isOnlyDetectionAlerts:o,isPopoverOpen:s,isTimelineSourcerer:l,loading:c,onClick:u,selectedPatterns:d,signalIndexName:p})=>{const m=Object(r.useMemo)((()=>{switch(a){case"modified":return i.a.createElement(X,{"data-test-subj":"sourcerer-modified-badge"},E);case"alerts":return i.a.createElement(X,{"data-test-subj":"sourcerer-alerts-badge"},x);case"deprecated":return i.a.createElement(X,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},j);case"missingPatterns":return i.a.createElement(X,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},j);default:return null}}),[a]),b=Object(r.useMemo)((()=>l?n.EuiButton:J),[l]),f=Object(r.useMemo)((()=>i.a.createElement(b,{"aria-label":g,"data-test-subj":l?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:u,title:g},g,!t&&m)),[t,m,l,c,u,b]),h=Object(r.useMemo)((()=>t?F:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:a,signalIndexName:n})=>t||e&&!n?null:(e?[n]:a).join(", "))({isOnlyDetectionAlerts:o,isPopoverOpen:s,selectedPatterns:null!=e?e:d,signalIndexName:p})),[e,t,o,s,d,p]);return h?i.a.createElement(n.EuiToolTip,{position:"top",content:h,"data-test-subj":"sourcerer-tooltip"},f):f},Ce=Object(r.memo)(Te),Me=i.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?i.a.createElement(n.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Me.displayName="SourcererCallout";const Fe=i.a.memo((({onChange:e,checked:t,isShow:a})=>a?i.a.createElement(K,null,i.a.createElement(n.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:A,onChange:e})):null));Fe.displayName="AlertsCheckbox";const De=i.a.memo((({disableSave:e,isShow:t,onReset:a,onSave:r})=>t?i.a.createElement(K,null,i.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(Y,{"aria-label":P,"data-test-subj":"sourcerer-reset",flush:"left",onClick:a,title:P},P)),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButton,{onClick:r,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},k)))):null));De.displayName="SaveButtons";var Pe=a(459),Le=a(189),Ne=a(198);const Re=i.a.memo((({showSourcerer:e,activePatterns:t,isTriggerDisabled:a,isModified:r,isOnlyDetectionAlerts:o,isPopoverOpen:s,loading:l,setPopoverIsOpenCb:c,selectedPatterns:u,signalIndexName:d,handleClosePopOver:p,isTimelineSourcerer:m,selectedDataViewId:b,sourcererMissingPatterns:g,onUpdateDetectionAlertsChecked:f,setMissingPatterns:h,setDataViewId:v,scopeId:y,children:E})=>e?y===q.SourcererScopeName.analyzer?i.a.createElement(i.a.Fragment,null,E):i.a.createElement(n.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:i.a.createElement(Ce,{activePatterns:t,disabled:a,isModified:r,isOnlyDetectionAlerts:o,isPopoverOpen:s,isTimelineSourcerer:m,loading:l,onClick:c,selectedPatterns:u,signalIndexName:d}),closePopover:p,"data-test-subj":m?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:s,ownFocus:!0,repositionOnScroll:!0},i.a.createElement(i.a.Fragment,null,E)):null));Re.displayName="SourcererPopover";const _e=i.a.memo((({scope:e})=>{const t=Object(o.useDispatch)(),a=e===q.SourcererScopeName.detections,s=e===q.SourcererScopeName.timeline,c=e===q.SourcererScopeName.default,u=Object(Le.d)(Ne.a.sourcerer),d=Object(o.useSelector)($.d.signalIndexName),p=Object(o.useSelector)($.d.defaultDataView),g=Object(o.useSelector)($.d.kibanaDataViews),f=Object(o.useSelector)((t=>$.d.sourcererScopeSelectedDataViewId(t,e))),h=Object(o.useSelector)((t=>$.d.sourcererScopeSelectedPatterns(t,e))),v=Object(o.useSelector)((t=>$.d.sourcererScopeMissingPatterns(t,e))),{pollForSignalIndex:y}=Object(Pe.a)();Object(r.useEffect)((()=>{null!=y&&(s||a)&&y()}),[a,s,y]);const{activePatterns:j,indicesExist:k,loading:F}=Object(je.a)(e),[D,P]=Object(r.useState)(j&&j.length>0?v.filter((e=>j.includes(e))):[]);Object(r.useEffect)((()=>{j&&j.length>0&&P(v.filter((e=>j.includes(e))))}),[j,v]);const[L,N]=Object(r.useState)(s&&h.join()===d),R=Object(r.useCallback)((()=>{N(s&&h.join()===d)}),[s,h,d]);Object(r.useEffect)((()=>{R()}),[h]);const A=a||s&&L,[B,U]=Object(r.useState)(!1),[H,W]=Object(r.useState)(f),{allOptions:Y,dataViewSelectOptions:ee,loadingIndexPatterns:se,isModified:le,handleOutsideClick:ce,onChangeCombo:ue,renderOption:de,selectedOptions:pe,setIndexPatternsByDataView:me}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:a,kibanaDataViews:s,missingPatterns:l,scopeId:c,selectedDataViewId:u,selectedPatterns:d,signalIndexName:p})=>{const m=Object(o.useDispatch)(),{data:{dataViews:b}}=Object(ne.j)().services,g=Object(r.useRef)(!0),[f,h]=Object(r.useState)(!1),v=Object(r.useMemo)((()=>p?ie([p]):[]),[p]),y=Object(r.useMemo)((()=>ie(d)),[d]),[j,O]=Object(r.useState)(a?v:y),[k,I]=Object(r.useState)(null==e?"deprecated":l.length>0?"missingPatterns":""),{allPatterns:T,selectablePatterns:C}=Object(r.useMemo)((()=>{if(a&&p)return{allPatterns:[p],selectablePatterns:[p]};const t=s.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const n=[...new Set(t.title.split(","))];return c===$.b.SourcererScopeName.default?{allPatterns:te(n,p),selectablePatterns:te(t.patternList,p)}:{allPatterns:n,selectablePatterns:t.patternList}}),[e,a,s,c,p]),M=Object(r.useMemo)((()=>ie(T,C)),[T,C]),F=Object(r.useCallback)(((e,a=!1)=>c===q.SourcererScopeName.detections||a?v:ie(Object(G.b)(s.find((t=>t.id===e)),c,p,e===t))),[v,s,c,p,t]),D=Object(r.useMemo)((()=>null!=e?F(e):[]),[e,F]),P=Object(r.useCallback)(((e,t)=>{if(null==t)return I("deprecated");if(l.length>0)return I("missingPatterns");if(a)return I("alerts");const n=D.length!==e.length||!D.every((t=>e.find((e=>t.value===e))));return I(n?"modified":"")}),[D,a,l.length]);Object(r.useEffect)((()=>{O(c===q.SourcererScopeName.detections?v:y)}),[d,c,y,v]),Object(r.useEffect)((()=>{P(d.map((e=>e)),u)}),[a,u,l,c,d]);const L=Object(r.useCallback)((e=>{O(e)}),[]),N=Object(r.useCallback)((({value:e})=>i.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),R=Object(r.useCallback)((async(e,t)=>{if(s.some((t=>t.id===e&&0===t.indexFields.length))){try{h(!0),O([]);const t=await Object(re.a)(e,b);g.current&&(m($.a.setDataView(t)),O(a?v:ie(t.patternList)))}catch(e){}h(!1)}else O(F(e,t))}),[v,m,F,a,s,b]),_=Object(r.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:a,isOnlyDetectionAlerts:r,kibanaDataViews:o})=>r?[{inputDisplay:i.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},i.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",S,i.a.createElement(X,{"data-test-subj":"security-alerts-option-badge"},x)),value:t}]:o.map((({title:r,id:o})=>({inputDisplay:o===t?i.a.createElement("span",{"data-test-subj":"security-option-super"},i.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",w,a&&o===e&&i.a.createElement(X,{"data-test-subj":"security-modified-option-badge"},E)):i.a.createElement("span",{"data-test-subj":"dataView-option-super"},i.a.createElement(n.EuiIcon,{type:"logoKibana",size:"s"})," ",r,a&&o===e&&i.a.createElement(X,{"data-test-subj":"security-modified-option-badge"},E)),value:o}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===k,isOnlyDetectionAlerts:a,kibanaDataViews:s}):[]),[e,t,k,a,s]);return Object(r.useEffect)((()=>(g.current=!0,()=>{g.current=!1})),[]),{allOptions:M,dataViewSelectOptions:_,loadingIndexPatterns:f,handleOutsideClick:Object(r.useCallback)((()=>{O(y)}),[y]),isModified:k,onChangeCombo:L,renderOption:N,selectedOptions:j,setIndexPatternsByDataView:R}})({dataViewId:H,defaultDataViewId:p.id,isOnlyDetectionAlerts:A,kibanaDataViews:g,missingPatterns:D,scopeId:e,selectedDataViewId:f,selectedPatterns:h,signalIndexName:d}),be=Object(r.useCallback)((e=>{N(e.target.checked),W(p.id),me(p.id,e.target.checked)}),[p.id,me]),[ge,fe]=Object(r.useState)(!1),[he,ve]=Object(r.useState)(!1),ye=Object(r.useCallback)((()=>{U((e=>!e)),fe(!1)}),[]),Ee=Object(r.useCallback)(((a,n,r)=>{t($.a.setSelectedDataView({id:e,selectedDataViewId:a,selectedPatterns:n,shouldValidateSelectedPatterns:r})),c&&u({[q.SourcererScopeName.default]:{id:a,selectedPatterns:n}})}),[t,e,c,u]),Oe=Object(r.useCallback)((e=>{W(e),me(e)}),[me]),Te=Object(r.useCallback)((()=>{W(p.id),me(p.id),N(!1),P([])}),[p.id,me]),Ce=Object(r.useCallback)((()=>{const e=pe.map((e=>e.label));null!=H&&Ee(H,e),U(!1)}),[Ee,H,pe]),_e=Object(r.useCallback)((()=>{ce(),W(f),P(v),R(),U(!1),fe(!1)}),[ce,R,f,v]),Ae=Object(r.useCallback)((()=>{ve(!1);const e=h.filter((e=>p.patternList.includes(e)));Ee(p.id,e),U(!1)}),[p.id,p.patternList,Ee,h]),ze=Object(r.useCallback)((()=>{0===D.length?Ae():ve(!0)}),[D,Ae]),[Be,Ve]=Object(r.useState)(!1),$e=(e=>{const{uiSettings:t,...a}=Object(ne.j)().services,{addSuccess:o,addError:s}=Object(Ie.a)();return Object(r.useCallback)((async r=>{const[l,c]=await(async()=>{try{const e=[...t.get(Se.O),...r];return[await t.set(Se.O,Object(ae.a)(e)),null]}catch(e){return[!1,e]}})();return l?(o({color:"success",title:Object(we.a)(z,a),text:Object(we.a)(i.a.createElement(ke,null),a),iconType:void 0,toastLifeTimeMs:6e5}),!0):(s(null!==c?c:new Error(V),{title:V,toastMessage:i.a.createElement(i.a.Fragment,null,i.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:i.a.createElement(n.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},b)}}))}),!1)}),[s,o,e,t,a])})(Object(r.useCallback)((()=>{U(!0),Te()}),[Te])),qe=Object(r.useCallback)((async()=>{const e=await $e(D);ve(!1),U(!1),e&&(Ee(p.id,null!=j?j:h,!1),Ve(!0))}),[j,p.id,D,Ee,h,$e]);Object(r.useEffect)((()=>{W(f)}),[f]);const Ge=Object(r.useCallback)((()=>{fe((e=>!e))}),[]),Ue=Object(r.useMemo)((()=>k||[q.SourcererScopeName.analyzer,q.SourcererScopeName.timeline].includes(e)),[k,e]);return i.a.createElement(Re,{showSourcerer:Ue,activePatterns:j,isTriggerDisabled:Be,isModified:le,isOnlyDetectionAlerts:A,isPopoverOpen:B,isTimelineSourcerer:s,loading:F,handleOutsideClick:ce,setPopoverIsOpenCb:ye,selectedPatterns:h,signalIndexName:d,handleClosePopOver:_e,selectedDataViewId:f,sourcererMissingPatterns:v,onUpdateDetectionAlertsChecked:R,setMissingPatterns:P,setDataViewId:W,scopeId:e},i.a.createElement(Z,null,i.a.createElement(n.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},i.a.createElement(i.a.Fragment,null,O)),i.a.createElement(Me,{isOnlyDetectionAlerts:A,title:s?m:l}),i.a.createElement(n.EuiSpacer,{size:"s"}),null===H&&"deprecated"===le||"missingPatterns"===le?i.a.createElement(xe,{activePatterns:j,indicesExist:k,isModified:le,isShowingUpdateModal:he,missingPatterns:D,onContinueWithoutUpdate:Ae,onDismiss:ye,onDismissModal:()=>ve(!1),onReset:Te,onUpdateStepOne:"deprecated"===le?ze:qe,onUpdateStepTwo:qe,selectedPatterns:h}):i.a.createElement(n.EuiForm,{component:"form"},i.a.createElement(i.a.Fragment,null,i.a.createElement(Fe,{isShow:s,checked:L,onChange:be}),H&&i.a.createElement(K,{label:I},i.a.createElement(n.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:se,disabled:A,fullWidth:!0,onChange:Oe,options:ee,placeholder:I,valueOfSelected:H})),i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(J,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:ge?"arrowDown":"arrowRight",onClick:Ge},T),ge&&i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(Q,{isDisabled:se,$expandAdvancedOptions:ge,helpText:A?void 0:M,label:C},i.a.createElement(n.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:A||se,onChange:ue,options:Y,placeholder:_,renderOption:de,selectedOptions:pe})),i.a.createElement(De,{disableSave:0===pe.length,isShow:!a,onReset:Te,onSave:Ce})),i.a.createElement(n.EuiSpacer,{size:"s"}))))}));_e.displayName="Sourcerer"},504:function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return w}));var n=a(19),r=a(2),i=a.n(r),o=a(44),s=a(128),l=a(191),c=a(180),u=a(119),d=a.n(u);const p=({rowIndex:e,colIndex:t,data:a,header:n,eventId:o,linkValues:s,renderCellValue:l,tabType:c,timelineId:u})=>{const[p,m]=Object(r.useState)({});return i.a.createElement("div",d()({"data-test-subj":"statefulCell"},p),l({columnId:n.id,eventId:o,data:a,header:n,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:s,rowIndex:e,colIndex:t,setCellProps:m,scopeId:u,key:null!=c?`${u}-${c}`:u}))};p.displayName="StatefulCellComponent";const m=i.a.memo(p);var b=a(4);const g=({column:e,row:t})=>b.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),f=e=>b.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),h=({notesCount:e,row:t})=>b.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),v=e=>{var t;const{altKey:a,ctrlKey:n,key:r,metaKey:i,shiftKey:o,target:l,type:u}=e,d=l;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(r)&&null!==(t=d.className)&&void 0!==t&&t.includes(c.b)){const t=d.querySelector(`.${s.a}`),l=new KeyboardEvent(u,{altKey:a,bubbles:!0,cancelable:!0,ctrlKey:n,key:r,metaKey:i,shiftKey:o});" "===r&&e.preventDefault(),null==t||t.dispatchEvent(l)}},y=({action:e,width:t,actionsColumnWidth:a,ariaRowindex:r,columnId:o,columnValues:s,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:b,isEventViewer:y,eventId:E,loadingEventIds:x,notesCount:j,onEventDetailsPanelOpened:w,onRowSelected:S,refetch:O,rowIndex:k,hasRowRenderers:I,onRuleChange:T,selectedEventIds:C,showCheckboxes:M,showNotes:F,tabType:D,timelineId:P,toggleShowNotes:L,setEventsLoading:N,setEventsDeleted:R})=>{const _=t||a;return i.a.createElement(c.m,{width:_,"data-test-subj":"event-actions-container",tabIndex:0},i.a.createElement(c.k,{$ariaColumnIndex:m+l.b,key:null!=D?`${E}_${D}`:`${E}`,onKeyDown:v,role:"button",tabIndex:0,width:t},i.a.createElement(c.l,{"data-test-subj":"cell-container"},i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},i.a.createElement("p",null,g({row:r,column:m+2}))),e&&i.a.createElement(e,{ariaRowindex:r,width:t,checked:Object.keys(C).includes(E),columnId:o,columnValues:s,eventId:E,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:b,isEventViewer:y,loadingEventIds:x,onEventDetailsPanelOpened:w,onRowSelected:S,refetch:O,rowIndex:k,onRuleChange:T,showCheckboxes:M,showNotes:F,timelineId:P,toggleShowNotes:L,setEventsLoading:N,setEventsDeleted:R}))),I?i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},i.a.createElement("p",null,f(r))):null,j?i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},i.a.createElement("p",null,h({row:r,notesCount:j}))):null))},E=({_id:e,ariaRowindex:t,index:a,header:r,data:s,ecsData:u,hasRowRenderers:d,notesCount:p,renderCellValue:b,tabType:y,timelineId:E})=>{var x;const j=a+l.b;return i.a.createElement(c.k,{$ariaColumnIndex:j,key:null!=y?`${r.id}_${y}`:`${r.id}`,onKeyDown:v,role:"button",tabIndex:0,width:r.initialWidth},i.a.createElement(c.l,{"data-test-subj":"cell-container"},i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},i.a.createElement("p",null,g({row:t,column:j}))),i.a.createElement(m,{rowIndex:t-1,colIndex:j-1,data:s,header:r,eventId:e,linkValues:Object(o.getOr)([],null!==(x=r.linkField)&&void 0!==x?x:"",u),renderCellValue:b,tabType:y,timelineId:E}))),d?i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},i.a.createElement("p",null,f(t))):null,p?i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},i.a.createElement("p",null,h({row:t,notesCount:p}))):null)},x=i.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:a,columnValues:n,data:o,ecsData:s,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,id:p,loadingEventIds:m,notesCount:b,onEventDetailsPanelOpened:g,onRowSelected:f,refetch:h,hasRowRenderers:v,onRuleChange:x,renderCellValue:j,selectedEventIds:w,showCheckboxes:S,showNotes:O,tabType:k,timelineId:I,toggleShowNotes:T,trailingControlColumns:C,leadingControlColumns:M,setEventsLoading:F,setEventsDeleted:D})=>{const P=Object(r.useMemo)((()=>C?C.map((e=>e.rowCellRender)):[]),[C]),L=Object(r.useMemo)((()=>M.length+a.length),[M,a]),N=Object(r.useMemo)((()=>P.map(((a,r)=>a&&i.a.createElement(y,{action:a,width:C[r].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(w).includes(p),columnId:C[r].id||"",columnValues:n,onRowSelected:f,"data-test-subj":"actions",eventId:p,data:o,key:r,index:L+r,rowIndex:e,ecsData:s,loadingEventIds:m,onEventDetailsPanelOpened:g,showCheckboxes:S,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,notesCount:b,refetch:h,hasRowRenderers:v,onRuleChange:x,selectedEventIds:w,showNotes:O,tabType:k,timelineId:I,toggleShowNotes:T,setEventsLoading:F,setEventsDeleted:D})))),[C,p,o,s,f,u,d,t,e,n,l,v,L,m,b,g,x,h,w,S,O,k,I,T,P,F,D]),R=Object(r.useMemo)((()=>a.map(((t,a)=>i.a.createElement(E,{_id:p,index:a,header:t,key:null!=k?`${t.id}_${k}`:`${t.id}`,ariaRowindex:e,data:o,ecsData:s,hasRowRenderers:v,notesCount:b,renderCellValue:j,tabType:k,timelineId:I})))),[p,e,a,o,s,v,b,j,k,I]);return i.a.createElement(c.n,{"data-test-subj":"data-driven-columns"},R,N)}));x.displayName="DataDrivenColumns";const j=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const a=e.find((e=>e.field===t));return null!=a&&null!=a.value?a.value:void 0},w=({data:e,fieldName:t})=>Object(r.useMemo)((()=>j({data:e,fieldName:t})),[e,t])},523:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o}));var n=a(5);const r=20,i=[5,10,20,50,n.Dc],o="securitySolution.rulesTable"},524:function(e,t,a){"use strict";a.d(t,"f",(function(){return s})),a.d(t,"h",(function(){return l})),a.d(t,"l",(function(){return c})),a.d(t,"r",(function(){return u})),a.d(t,"q",(function(){return d})),a.d(t,"v",(function(){return p})),a.d(t,"p",(function(){return m})),a.d(t,"u",(function(){return b})),a.d(t,"g",(function(){return g})),a.d(t,"w",(function(){return f})),a.d(t,"D",(function(){return h})),a.d(t,"E",(function(){return v})),a.d(t,"z",(function(){return y})),a.d(t,"A",(function(){return E})),a.d(t,"y",(function(){return x})),a.d(t,"x",(function(){return j})),a.d(t,"b",(function(){return w})),a.d(t,"c",(function(){return S})),a.d(t,"a",(function(){return O})),a.d(t,"k",(function(){return k})),a.d(t,"d",(function(){return I})),a.d(t,"e",(function(){return T})),a.d(t,"B",(function(){return C})),a.d(t,"C",(function(){return M})),a.d(t,"i",(function(){return F})),a.d(t,"j",(function(){return D})),a.d(t,"s",(function(){return P})),a.d(t,"t",(function(){return L})),a.d(t,"o",(function(){return N})),a.d(t,"m",(function(){return R})),a.d(t,"n",(function(){return _}));var n=a(2),r=a.n(n),i=a(4),o=a(42);const s=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),l=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),c=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryFieldRequiredError",{defaultMessage:"An ES|QL query is required."}),u=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),d=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),p=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),m=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),b=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),g=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),f=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.SavedQueryFormRowLabel",{defaultMessage:"Saved query"}),h=e=>i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabel",{defaultMessage:'Load saved query "{savedQueryName}" dynamically on each rule execution',values:{savedQueryName:e}}),v=()=>i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabelWithoutName",{defaultMessage:"Load saved query dynamically on each rule execution"}),y=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),E=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),x=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),j=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.source",{defaultMessage:"Source"}),w=(i.i18n.translate("xpack.securitySolution.detections.dataSource.popover.title",{defaultMessage:"Select a data source"}),i.i18n.translate("xpack.securitySolution.detections.dataSource.popover.subTitle",{defaultMessage:"Data sources"}),i.i18n.translate("xpack.securitySolution.detections.dataSource.popover.content",{defaultMessage:"Rules can now query index patterns or data views."}),i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.rulePreviewTitle",{defaultMessage:"Rule Preview"}),i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})),S=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsSuppressLabel",{defaultMessage:"Suppress and group alerts for events with missing fields"}),O=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsDoNotSuppressLabel",{defaultMessage:"Do not suppress alerts for events with missing fields"}),k=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),I=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perRuleExecutionLabel",{defaultMessage:"Per rule execution"}),T=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perTimePeriodLabel",{defaultMessage:"Per time period"}),C=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.Su.perRuleExecutionWarning",{defaultMessage:"Per rule execution option is not available for Threshold rule type"}),M=e=>null!=e&&e.length?r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionForFieldsLabel",defaultMessage:"Suppress alerts by selected fields: {fieldsString} (Technical Preview)",values:{fieldsString:r.a.createElement("strong",null,e.join(", "))}}):i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionLabel",{defaultMessage:"Suppress alerts (Technical Preview)"}),F=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlSequenceSuppressionDisableText",{defaultMessage:"Suppression is not supported for EQL sequence queries."}),D=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlSequenceSuppressionValidationText",{defaultMessage:"{EQL_SEQUENCE_SUPPRESSION_DISABLE_TOOLTIP} Change the EQL query to a non-sequence query, or remove the suppression fields.",values:{EQL_SEQUENCE_SUPPRESSION_DISABLE_TOOLTIP:F}}),P=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningSuppressionDisabledLabel",{defaultMessage:"To enable alert suppression, start relevant Machine Learning jobs."}),L=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningSuppressionIncompleteLabel",{defaultMessage:"This list of fields might be incomplete as some Machine Learning jobs are not running. Start all relevant jobs for a complete list."}),N=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsTechPreviewLabelAppend",{defaultMessage:"Optional (Technical Preview)"}),R=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsGALabelAppend",{defaultMessage:"Optional"}),_=i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"})},526:function(e,t,a){"use strict";a.d(t,"d",(function(){return n.q})),a.d(t,"c",(function(){return n.n})),a.d(t,"g",(function(){return b})),a.d(t,"e",(function(){return f})),a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return x})),a.d(t,"f",(function(){return j.a}));var n=a(159),r=a(123),i=a(47),o=a(727),s=a(5),l=a(383),c=a(588),u=a(437),d=a(442);const p=["PUT",s.qb];var m=a(449);const b=()=>{const{addError:e}=Object(r.a)();return(e=>{const t=Object(l.b)(),a=Object(u.b)(),r=Object(d.b)(),s=Object(c.c)();return Object(i.useMutation)((e=>Object(n.y)({rule:Object(o.b)(e)})),{...e,mutationKey:p,onSettled:(...n)=>{var i;t(),a(),r();const[o]=n;o&&s(o),null==e||null===(i=e.onSettled)||void 0===i||i.call(e,...n)}})})({onError:t=>{e(t,{title:m.a})}})},g=["POST",s.qb],f=()=>{const{addError:e}=Object(r.a)();return(e=>{const t=Object(l.b)(),a=Object(u.b)(),r=Object(d.b)();return Object(i.useMutation)((e=>Object(n.d)({rule:Object(o.b)(e)})),{...e,mutationKey:g,onSettled:(...n)=>{t(),a(),r(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onError:t=>{e(t,{title:m.a})}})};var h=a(120),v=a(273),y=a(232);const E=h.object({page:h.number().int().min(0),perPage:h.number().int().min(0),total:h.number().int().min(0)}),x=h.object({field:y.e,order:v.g});var j=a(828)},545:function(e,t,a){"use strict";a.d(t,"m",(function(){return r})),a.d(t,"k",(function(){return i})),a.d(t,"l",(function(){return o})),a.d(t,"i",(function(){return s})),a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return b})),a.d(t,"f",(function(){return g})),a.d(t,"e",(function(){return f}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},554:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(48),o=a(45),s=a(149),l=a(129);const c=Object(n.memo)((({children:e})=>{const t=Object(i.useLocation)(),a=Object(o.useDispatch)();return Object(n.useEffect)((()=>{a(l.a.showTimeline({id:s.f.active,show:!1}))}),[a,t.pathname]),Object(n.useEffect)((()=>{a({type:"userChangedUrl",payload:t})})),r.a.createElement(r.a.Fragment,null,e)}));c.displayName="RouteCapture"},564:function(e,t,a){"use strict";a.d(t,"c",(function(){return Je})),a.d(t,"a",(function(){return et})),a.d(t,"b",(function(){return at}));var n=a(19),r=a(2),i=a.n(r),o=a(42),s=a(51),l=a(165),c=a(122),u=a(7),d=a(675),p=a.n(d),m=a(48),b=a(41),g=a.n(b);const f=i.a.memo((({onClick:e,queriesLength:t})=>{const[a,s]=Object(r.useState)(!1),l=Object(r.useCallback)((()=>{e(),s(!0)}),[e]);return a?null:i.a.createElement(h,{color:"primary",paddingSize:"xs"},i.a.createElement(v,{direction:"row",alignItems:"center"},i.a.createElement(n.EuiFlexItem,{grow:!0,"data-test-subj":"osquery-investigation-guide-text"},i.a.createElement(n.EuiText,{size:"s"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.investigationGuideSuggestion",defaultMessage:"You have {queriesLength, plural, one {a query} other {queries}} in the investigation guide. Add {queriesLength, plural, one {it as a response action} other {them as response actions}}?",values:{queriesLength:t}}))),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButtonEmpty,{size:"m",color:"primary",onClick:l,"data-test-subj":"osqueryAddInvestigationGuideQueries"},i.a.createElement(n.EuiText,{size:"s"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.addButton",defaultMessage:"Add"}))))))}));f.displayName="OsqueryInvestigationGuidePanel";var h=g()(n.EuiPanel)`${{marginBottom:"16px"}}`,v=g()(n.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-10xybv0-0"})(["",""],{padding:"0 24px"}),y=a(526),E=a(4),x=a(174),j=a(586),w=a(140),S=a(62);const O=({path:e,disabled:t,readDefaultValueOnForm:a})=>{const n=Object(r.useMemo)((()=>({defaultValue:!0,label:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.overwriteFieldLabel",defaultMessage:"Use the alert's {pid} value to identify the process to terminate.",values:{pid:i.a.createElement("strong",null,"process.pid")}})})),[]);return i.a.createElement(s.UseField,{component:S.ToggleField,euiFieldProps:{"data-test-subj":"config-overwrite-toggle"},path:e,readDefaultValueOnForm:a,config:n,isDisabled:t})},k=i.a.memo(O),I=a(1194).map((e=>({label:e.field,value:e}))),T=Object.freeze({asPlainText:!0}),C="Custom field name",M=E.i18n.translate("xpack.securitySolution.responseActions.endpoint.validations.fieldNameIsRequiredErrorMessage",{defaultMessage:"{field} selection is required when the process.pid toggle is disabled.",values:{field:C}}),F=({path:e,disabled:t,readDefaultValueOnForm:a,isRequired:l})=>{const[c]=Object(s.useFormData)(),d=Object(u.get)(c,e),p=Object(s.useFormContext)().getFields()[e];Object(r.useEffect)((()=>{p&&!l&&(null==p||p.clearErrors()),null==p||!p.isValidated||null!=p&&p.value||!l||null==p||p.setErrors([{message:M}])}),[p,l]);const m=Object(r.useMemo)((()=>(null==d?void 0:d.includes("entity_id"))?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.entityIdDescription",defaultMessage:"Entity_id is an Elastic Defend agent specific field, if the alert does not come from Elastic Defend agent we will not be able to send the action."}):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.fieldDescription",defaultMessage:"Choose a different alert field to identify the process to terminate."})),[d]),b=Object(r.useMemo)((()=>({label:C,helpText:m,validations:[{validator:({value:t})=>{if(l&&""===t)return{code:"ERR_FIELD_MISSING",path:e,message:M}}}]})),[l,e,m]),g=Object(r.useMemo)((()=>I.map((({label:e})=>({label:e,value:e})))),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.UseField,{path:e,readDefaultValueOnForm:a,config:b},(e=>{const{value:a,setValue:r}=e,{isInvalid:o,errorMessage:c}=Object(s.getFieldValidityAndErrorMessage)(e),u=!!g.find((e=>e.label===a));return i.a.createElement(n.EuiFormRow,{label:e.label,helpText:e.helpText,fullWidth:!0,error:c,isInvalid:o},i.a.createElement(n.EuiComboBox,{isInvalid:o,isDisabled:t||!l,singleSelection:T,noSuggestions:!1,options:g,fullWidth:!0,selectedOptions:a&&u?[{value:a,label:a}]:void 0,onChange:e=>{0===e.length?r(""):r(e[0].label)},"data-test-subj":"config-custom-field-name"}))})),i.a.createElement(n.EuiSpacer,{size:"s"}))},D=i.a.memo(F),P=({basePath:e,disabled:t,readDefaultValueOnForm:a})=>{const r=`${e}.command`,o=`${e}.config.overwrite`,[l]=Object(s.useFormData)({watch:[r,o]}),c=Object(u.get)(l,r),d=Object(u.get)(l,o);return"kill-process"===c||"suspend-process"===c?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,null),i.a.createElement(k,{path:`${e}.config.overwrite`,disabled:t,readDefaultValueOnForm:a}),i.a.createElement(n.EuiSpacer,null),i.a.createElement(D,{path:`${e}.config.field`,disabled:t,readDefaultValueOnForm:a,isRequired:!d}),i.a.createElement(n.EuiSpacer,null)):null},L=i.a.memo(P),N={label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLabel",{defaultMessage:"Comment (optional)"}),helpText:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commentDescription",defaultMessage:"Leave a note that explains or describes the action. Your comment is included in the response actions history."})},R=({basePath:e,disabled:t,readDefaultValueOnForm:a})=>i.a.createElement(s.UseField,{path:`${e}.comment`,readDefaultValueOnForm:a,config:N,isDisabled:t,component:S.TextField}),_=i.a.memo(R);var A=a(77),z=a(118);E.i18n.translate("xpack.securitySolution.endpoint.action.permissionDenied",{defaultMessage:"Permission denied"});const B=E.i18n.translate("xpack.securitySolution.endpoint.action.chooseFromTheList",{defaultMessage:"Choose action from the list"}),V=E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLearnMore",{defaultMessage:"Learn more"});var $=a(237);const q=({name:e,isDisabled:t})=>{const{title:a,description:r,tooltip:o}=G(e),s=i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiText,{size:"s"},i.a.createElement("b",null,a)),i.a.createElement(n.EuiSpacer,{size:"xs"}),i.a.createElement(n.EuiText,{size:"xs"},r));return t?i.a.createElement(n.EuiToolTip,{position:"top",content:o},s):s},G=e=>{switch(e){case"isolate":return{title:$.b.isolate.title,description:$.b.isolate.about,tooltip:$.b.isolate.privileges};case"kill-process":return{title:$.b.killProcess.title,description:$.b.killProcess.about,tooltip:$.b.killProcess.privileges};case"suspend-process":return{title:$.b.suspendProcess.title,description:$.b.suspendProcess.about,tooltip:$.b.suspendProcess.privileges};default:return{title:"",description:"",tooltip:""}}},U=i.a.memo(q),H=({basePath:e,disabled:t,readDefaultValueOnForm:a})=>{const{endpointPrivileges:l}=Object(w.a)(),[d]=Object(s.useFormData)(),{docLinks:{links:{securitySolution:{responseActions:p}}}}=Object(z.j)().services,m=Object(c.a)("automatedProcessActionsEnabled"),b=Object(r.useMemo)((()=>[...x.a,...m?["kill-process","suspend-process"]:[]]),[m]),g=Object(r.useMemo)((()=>b.map((e=>{const t=!Object(j.a)({commandName:x.f[e],privileges:l}),a=Object(u.map)(d.responseActions,"params.command").includes(e)||t;return{value:e,inputDisplay:e,dropdownDisplay:i.a.createElement(U,{name:e,isDisabled:t}),disabled:a,"data-test-subj":`command-type-${e}`}}))),[d.responseActions,b,l]);return i.a.createElement(s.UseField,{path:`${e}.command`,readDefaultValueOnForm:a,config:{label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commandLabel",{defaultMessage:"Response action"}),helpText:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commandDescription",defaultMessage:"Select an endpoint response action. The response action only runs on hosts with Elastic Defend installed. {docs}",values:{docs:i.a.createElement(n.EuiLink,{href:p,target:"_blank"},V)}}),validations:[{validator:A.fieldValidators.emptyField(E.i18n.translate("xpack.securitySolution.responseActions.endpoint.validations.commandIsRequiredErrorMessage",{defaultMessage:"Action is a required field."}))}]},component:S.SuperSelectField,isDisabled:t,componentProps:{euiFieldProps:{options:g,placeholder:B,"data-test-subj":"commandTypeField"}}})},W=i.a.memo(H),Q=({basePath:e,editDisabled:t})=>{const[a]=Object(s.useFormData)(),r=Object(u.get)(a,`${e}.command`);return t?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,{size:"s"}),i.a.createElement(n.EuiCallOut,{color:"warning",iconType:"warning",title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.privileges",defaultMessage:"Insufficient privileges"})},i.a.createElement(n.EuiText,{size:"xs"},$.b.isolate.privileges)),i.a.createElement(n.EuiSpacer,{size:"s"})):"isolate"===r?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,{size:"s"}),i.a.createElement(n.EuiCallOut,{color:"warning",iconType:"warning",title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionTitle",defaultMessage:"Proceed with caution"})},i.a.createElement(n.EuiText,{size:"xs"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionDescription",defaultMessage:"Only select this option if you’re certain that you want to automatically block communication with other hosts on your network until you release this host."}))),i.a.createElement(n.EuiSpacer,{size:"s"})):"kill-process"===r||"suspend-process"===r?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,{size:"s"}),i.a.createElement(n.EuiCallOut,{color:"warning",iconType:"warning",title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionTitle",defaultMessage:"Proceed with caution"})},i.a.createElement(n.EuiText,{size:"xs"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.processesCautionDescription",defaultMessage:"Only select this option if you’re certain that you want to automatically terminate the process running on a host."}))),i.a.createElement(n.EuiSpacer,{size:"s"})):i.a.createElement(i.a.Fragment,null)},K=i.a.memo(Q),J=i.a.memo((e=>{const t=`${e.item.path}.params`;return i.a.createElement(i.a.Fragment,null,i.a.createElement(W,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}),i.a.createElement(K,{basePath:t,editDisabled:e.editDisabled}),i.a.createElement(L,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}),i.a.createElement(_,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}))}));J.displayName="EndpointResponseAction";var Y=a(247),Z=a(1213);const X={...function(e){return e.advancedInsights="advanced_insights",e.investigationGuide="investigation_guide",e.investigationGuideInteractions="investigation_guide_interactions",e.endpointHostManagement="endpoint_host_management",e.endpointPolicyManagement="endpoint_policy_management",e.endpointPolicyProtections="endpoint_policy_protections",e.endpointArtifactManagement="endpoint_artifact_management",e.endpointResponseActions="endpoint_response_actions",e.threatIntelligence="threat-intelligence",e.osqueryAutomatedResponseActions="osquery_automated_response_actions",e.endpointProtectionUpdates="endpoint_protection_updates",e.endpointAgentTamperProtection="endpoint_agent_tamper_protection",e.endpointExceptions="endpointExceptions",e.externalRuleActions="external_rule_actions",e.cloudSecurityPosture="cloud_security_posture",e.integrationAssistant="integration_assistant",e}({}),...function(e){return e.casesConnectors="cases_connectors",e}({}),...function(e){return e.assistant="assistant",e}({})};Object.freeze(Object.values(X));var ee=a(208);const te=i.a.memo((({field:e})=>{const{clearErrors:t,value:a,setValue:n,path:o}=e,{osquery:l}=Object(z.j)().services,c=Object(s.useFormContext)(),d=Object(r.useMemo)((()=>null==l?void 0:l.OsqueryResponseActionTypeForm),[null==l?void 0:l.OsqueryResponseActionTypeForm]),p=Object(r.useCallback)((e=>{if(Object(u.isEmpty)(e))t();else{const t=Object(u.map)(e,(e=>({message:e.message})));c.setFieldErrors(o,t)}}),[t,c,o]);return i.a.createElement(d,{defaultValues:a,onError:p,onChange:n})}));te.displayName="ResponseActionFormField";var ae=a(157),ne=a(771);const re=()=>i.a.createElement(i.a.Fragment,null),ie=i.a.memo((e=>{const{osquery:t,application:a}=Object(z.j)().services,r=Object(Z.a)(),s=Object(ee.a)(X.osqueryAutomatedResponseActions);if(t){var l,c,u,d,p,m,b,g;const{disabled:f,permissionDenied:h}=t.fetchInstallationStatus(),v=!(null!=a&&null!==(l=a.capabilities)&&void 0!==l&&null!==(c=l.osquery)&&void 0!==c&&c.writeLiveQueries||null!=a&&null!==(u=a.capabilities)&&void 0!==u&&null!==(d=u.osquery)&&void 0!==d&&d.runSavedQueries&&(null!=a&&null!==(p=a.capabilities)&&void 0!==p&&null!==(m=p.osquery)&&void 0!==m&&m.readSavedQueries||null!=a&&null!==(b=a.capabilities)&&void 0!==b&&null!==(g=b.osquery)&&void 0!==g&&g.readPacks));if(s)return i.a.createElement(s,null);if(h||v)return i.a.createElement(i.a.Fragment,null,i.a.createElement(ae.g,{path:`${e.item.path}.params`,component:re}),i.a.createElement(n.EuiEmptyPrompt,{title:i.a.createElement("h2",null,ne.b),titleSize:"xs",iconType:"logoOsquery",body:i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.osquery.action.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:i.a.createElement(n.EuiCode,null,"osquery")}}))}));if(f)return i.a.createElement(i.a.Fragment,null,i.a.createElement(ae.g,{path:`${e.item.path}.params`,component:re}),i.a.createElement(n.EuiEmptyPrompt,{iconType:"logoOsquery",title:i.a.createElement("h2",null,ne.c),titleSize:"xs",body:i.a.createElement("p",null,ne.a)}));if(r())return i.a.createElement(ae.g,{path:`${e.item.path}.params`,component:te,readDefaultValueOnForm:!e.item.isNew})}return null}));ie.displayName="OsqueryResponseAction";const oe=e=>{switch(e){case Y.b[".osquery"]:return{logo:"logoOsquery",name:"Osquery"};case Y.b[".endpoint"]:return{logo:"logoSecurity",name:"Elastic Defend"};default:return{logo:"logoOsquery",name:"Osquery"}}},se=g()(n.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-16pdpi-0"})(["background:",";.euiAccordion__buttonContent{padding:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeM)),le=({item:e,onDeleteAction:t})=>{var a;const[o,s]=Object(r.useState)(!0),[l]=Object(ae.o)(),c=Object(u.get)(l,e.path),d=null!==(a=(e=>{var t;const a=Object(w.a)().endpointPrivileges;if(".endpoint"===(null==e?void 0:e.actionTypeId)&&null!=e&&null!==(t=e.params)&&void 0!==t&&t.command)return!Object(j.a)({commandName:x.f[e.params.command],privileges:a})})(c))&&void 0!==a&&a,p=Object(r.useMemo)((()=>(null==c?void 0:c.actionTypeId)===Y.b[".osquery"]?i.a.createElement(ie,{item:e}):(null==c?void 0:c.actionTypeId)===Y.b[".endpoint"]?i.a.createElement(J,{item:e,editDisabled:d}):null),[null==c?void 0:c.actionTypeId,d,e]),m=Object(r.useCallback)((()=>{t(e.id)}),[e,t]),b=Object(r.useMemo)((()=>{const{logo:e,name:t}=oe(null==c?void 0:c.actionTypeId);return i.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiIcon,{type:e,size:"m"})),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiText,null,t)))}),[null==c?void 0:c.actionTypeId]),g=Object(r.useMemo)((()=>i.a.createElement(n.EuiButtonIcon,{"data-test-subj":"remove-response-action",iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":E.i18n.translate("xpack.securitySolution.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),disabled:d,onClick:m})),[d,m]);return i.a.createElement(se,{initialIsOpen:!0,key:e.id,id:e.id.toString(),onToggle:s,paddingSize:"l","data-test-subj":"alertActionAccordion",buttonContent:b,extraAction:g},p)};le.displayName="ResponseActionTypeForm";const ce=i.a.memo(le);var ue=a(476),de=a.n(ue),pe=a(1195),me=a.n(pe),be=a(478);const ge=()=>i.a.createElement(i.a.Fragment,null),fe=i.a.memo((({items:e,removeItem:t})=>{const{detailName:a}=Object(m.useParams)(),{data:o}=Object(y.f)(a),s=Object(r.useMemo)((()=>null!=o&&o.note?(e=>{const t=de()().use([[me.a,{}],be.a]).parse(e);return Object(u.filter)(null==t?void 0:t.children,["type","osquery"])})(o.note):[]),[null==o?void 0:o.note]),l=Object(ae.n)(),[c]=Object(ae.o)(),d=Object(r.useCallback)((()=>{const e=((e,t=[])=>Object(u.reduce)(e,((e,{configuration:t})=>(e.responseActions.push({actionTypeId:Y.b[".osquery"],params:{savedQueryId:void 0,packId:void 0,queries:void 0,query:t.query,ecsMapping:t.ecs_mapping}}),e)),{responseActions:t}))(s,c.responseActions);l.updateFieldValues(e)}),[l,null==c?void 0:c.responseActions,s]);return i.a.createElement("div",{"data-test-subj":"response-actions-list"},e.map(((e,a)=>i.a.createElement("div",{key:e.id,"data-test-subj":`response-actions-list-item-${a}`},i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(ce,{item:e,onDeleteAction:t}),i.a.createElement(ae.g,{path:`${e.path}.actionTypeId`,component:ge})))),i.a.createElement(n.EuiSpacer,{size:"m"}),s.length?i.a.createElement(f,{onClick:d,queriesLength:s.length}):null)}));fe.displayName="ResponseActionsList";var he=a(16);const ve=E.i18n.translate("xpack.securitySolution.actionForm.platinumOnly",{defaultMessage:"This functionality is available only in Platinum and above."}),ye=({supportedResponseActionTypes:e,addActionType:t,updateActionTypeId:a})=>{const[s]=Object(ae.o)(),[l,c]=Object(r.useState)(s.responseActions&&s.responseActions.length>0),u=Object(he.b)().isPlatinumPlus(),d=Object(r.useCallback)((e=>{c(!1),t(),a(e.id)}),[t,a]),p=Object(r.useMemo)((()=>i.a.createElement(n.EuiFlexGroup,{direction:"row"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(n.EuiButton,{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>c(!1)},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.sections.actionForm.addResponseActionButtonLabel",defaultMessage:"Add response action"}))))),[]),m=Object(r.useMemo)((()=>(null==e?void 0:e.length)&&e.map((function(e,t){const a=i.a.createElement(n.EuiKeyPadMenuItem,{key:t,isDisabled:!u||e.disabled,"data-test-subj":`${e.name}-response-action-type-selection-option`,label:e.name,betaBadgeTooltipContent:"should be visible",onClick:()=>d(e)},i.a.createElement(n.EuiIcon,{size:"xl",type:e.iconClass}));return u?i.a.createElement(n.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},a):i.a.createElement(n.EuiToolTip,{position:"top",content:ve},i.a.createElement(n.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},a))}))),[d,u,e]);return null!=e&&e.length?i.a.createElement(i.a.Fragment,null,l?p:i.a.createElement(n.EuiFlexGroup,{direction:"row"},m)):i.a.createElement(i.a.Fragment,null)},Ee=i.a.memo((({items:e,removeItem:t,supportedResponseActionTypes:a,addItem:n})=>{const o=Object(r.useRef)(null),s=Object(r.useCallback)((e=>{o.current=e}),[]),l=Object(ae.n)(),c=Object(r.useMemo)((()=>i.a.createElement(ye,{supportedResponseActionTypes:a,addActionType:n,updateActionTypeId:s})),[n,s,a]);return Object(r.useEffect)((()=>{if(o.current){const t=`responseActions[${e.length-1}].actionTypeId`;l.setFieldValue(t,o.current),o.current=null}}),[l,e.length]),i.a.createElement("div",{"data-test-subj":"response-actions-wrapper"},i.a.createElement(fe,{items:e,removeItem:t}),c)}));Ee.displayName="ResponseActionsWrapper";var xe=a(688);const je=()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":"response-actions-header"},i.a.createElement(n.EuiTitle,{size:"s"},i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{defaultMessage:"Response Actions",id:"xpack.securitySolution.actionForm.responseActionSectionsDescription"})))),i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(o.FormattedMessage,{defaultMessage:"Response actions are run on each rule execution.",id:"xpack.securitySolution.actionForm.responseActionSectionsTitle"})),i.a.createElement(n.EuiSpacer,{size:"m"})),we=[{id:Y.b[".osquery"],name:"Osquery",iconClass:"logoOsquery"},{id:Y.b[".endpoint"],name:"Elastic Defend",iconClass:"logoSecurity"}],Se=({items:e,addItem:t,removeItem:a,form:o})=>{const s=(()=>{const[e,t]=Object(r.useState)(),a=Object(c.a)("endpointResponseActionsEnabled"),{canIsolateHost:n,canKillProcess:i,canSuspendProcess:o}=Object(w.a)().endpointPrivileges,s=Object(r.useMemo)((()=>({endpoint:a})),[a]),l=Object(r.useMemo)((()=>({endpoint:n||i||o})),[n,i,o]);return Object(r.useEffect)((()=>{const e=((e,t,a)=>e.reduce(((e,n)=>{const r=n.id===Y.b[".endpoint"];return!t.endpoint&&r?e:Y.a.options.includes(n.id)?[...e,{...n,disabled:r?!a.endpoint:void 0}]:e}),[]))(we,s,l);t(e)}),[a,s,l]),e})(),[l,d]=Object(r.useState)(null),m=o.getFields(),b=o.getErrors(),g=Object(r.useMemo)((()=>null!=s&&s.length?i.a.createElement(Ee,{items:e,removeItem:a,supportedResponseActionTypes:s,addItem:t}):null),[t,e,a,s]);return Object(r.useEffect)((()=>{d((()=>{const t=Object(u.reduce)(Object(u.map)(e,"path"),((e,t)=>(Object(u.map)(m,((a,n)=>{const r=`${t}.params`;if(n.includes(r)){var i,o;if(null!==(i=m[n])&&void 0!==i&&null!==(o=i.errors)&&void 0!==o&&o.length){const a=oe(m[`${t}.actionTypeId`].value).name;e.push({type:a,errors:Object(u.map)(m[n].errors,"message")})}return e}return e})),e)),[]);return Object(u.reduce)(t,((e,t)=>(e.push(`**${t.type}:**\n`),t.errors.forEach((t=>{e.push(`- ${t}\n`)})),e)),[]).join("\n")}))}),[m,b,e]),i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,{size:"xxl","data-test-subj":"response-actions-form"}),i.a.createElement(je,null),null!=l&&l.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(n.EuiCallOut,{"data-test-subj":"response-actions-error",title:xe.b,color:"danger",iconType:"warning"},i.a.createElement(p.a,null,l))),i.a.createElement(n.EuiSpacer,null)):null,g)};var Oe=a(787),ke=a(942),Ie=a(47),Te=a(69),Ce=a(123),Me=a(159);const Fe=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorsFetchError",{defaultMessage:"Failed to fetch connectors"}),De=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorTypesFetchError",{defaultMessage:"Failed to fetch connector types"}),Pe=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.actionsFetchErrorDescription",{defaultMessage:"Viewing actions is not available"}),Le=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'}),Ne=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.docsLinkText",{defaultMessage:"Learn more"});function Re(){const{docLinks:{links:{securitySolution:{manageDetectionRules:e}}}}=Object(z.j)().services,t=`${e}#edit-rules-settings`;return i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepRuleActions.snoozeDescription",defaultMessage:"Choose when to perform actions or snooze them. Notifications are not created for snoozed actions. {docs}.",values:{docs:i.a.createElement(n.EuiLink,{href:t,target:"_blank"},Ne)}})}const _e=i.a.createElement(Re,null),Ae=(E.i18n.translate("xpack.securitySolution.detectionEngine.actionsSectionLabel",{defaultMessage:"Actions"}),E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.notificationActions",{defaultMessage:"Notification actions"})),ze=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.responseActions",{defaultMessage:"Response actions"}),Be=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.forEachOption",{defaultMessage:"For each alert. Per rule run."}),Ve=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.summaryOption",{defaultMessage:"Summary of alerts. Per rule run."}),$e=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.periodically",{defaultMessage:"Periodically"});var qe=a(866);function Ge({ruleId:e}){return i.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiText,{size:"s"},_e)),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(qe.a,{ruleId:e,showTooltipInline:!0})))}var Ue=a(438);const He=({children:e})=>i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiText,{size:"xs",color:"subdued"},e)),We=({frequency:e})=>{if(!e)return null;if(!e.summary)return i.a.createElement(He,null,Be);if("onActiveAlert"===e.notifyWhen)return i.a.createElement(He,null,Ve);if(!e.throttle)return null;const{unit:t,value:a}=Object(Ue.g)(e.throttle),n={s:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEverySecondsLabel",defaultMessage:"Once {secondsCount, plural, one {a} other {in every}} {secondsCount, plural, one {second} other {# seconds}}",values:{secondsCount:a}}),m:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryMinutesLabel",defaultMessage:"Once {minutesCount, plural, one {a} other {in every}} {minutesCount, plural, one {minute} other {# minutes}}",values:{minutesCount:a}}),h:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryHoursLabel",defaultMessage:"Once {hoursCount, plural, one {an} other {in every}} {hoursCount, plural, one {hour} other {# hours}}",values:{hoursCount:a}}),d:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryDaysLabel",defaultMessage:"Once {daysCount, plural, one {a} other {in every}} {daysCount, plural, one {day} other {# days}}",values:{daysCount:a}})};return i.a.createElement(He,null,n[t]||$e)};function Qe({action:e,connectorTypes:t,connectors:a,actionTypeRegistry:r}){var o,s,l,c;const u=t.find((({id:t})=>t===e.actionTypeId)),d=null!==(o=null==u?void 0:u.name)&&void 0!==o?o:"",p=a.find((({id:t})=>t===e.id)),m=null!==(s=null==p?void 0:p.name)&&void 0!==s?s:"",b=null!==(l=null===(c=r.get(e.actionTypeId))||void 0===c?void 0:c.iconClass)&&void 0!==l?l:"apps";return i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiToolTip,{content:d,anchorClassName:"eui-textTruncate"},i.a.createElement(n.EuiIcon,{size:"m",type:b}))),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiText,{size:"s"},m),i.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",component:"span",responsive:!1},i.a.createElement(n.EuiSpacer,{size:"xs"}),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiIcon,{size:"s",type:"bell",color:"subdued"})),i.a.createElement(We,{frequency:e.frequency})))))}function Ke({action:e}){const{name:t,logo:a}=oe(e.actionTypeId);return i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},i.a.createElement(n.EuiIcon,{size:"m",type:a}))),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiText,{size:"s"},t))))}const Je={enabled:!0,actions:[],responseActions:[],kibanaSiemAppUrl:""},Ye=()=>i.a.createElement(i.a.Fragment,null),Ze=()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiTitle,{size:"s"},i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{defaultMessage:"Actions",id:"xpack.securitySolution.detectionEngine.rule.editRule.actionSectionsTitle"}))),i.a.createElement(n.EuiSpacer,{size:"l"})),Xe=({ruleId:e,isUpdateView:t=!1,actionMessageParams:a,summaryActionMessageParams:o,ruleType:u,form:d})=>{const{services:{application:p}}=Object(z.j)(),m=Object(c.a)("responseActionsEnabled"),b=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,null),i.a.createElement(ae.g,{path:"actions",component:ke.a,componentProps:{messageVariables:a,summaryMessageVariables:o}}))),[a,o]),g=Object(r.useMemo)((()=>Object(l.g)(u)?i.a.createElement(s.UseArray,{path:"responseActions",initialNumberOfItems:0},Se):null),[u]),f=Object(r.useMemo)((()=>p.capabilities.actions.show?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ze,null),e&&i.a.createElement(Ge,{ruleId:e}),b,m&&g,i.a.createElement(ae.g,{path:"kibanaSiemAppUrl",component:Ye}),i.a.createElement(ae.g,{path:"enabled",component:Ye})):i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiText,null,Le))),[e,p.capabilities.actions.show,b,g,m]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Oe.a,{addPadding:!t},i.a.createElement(ae.c,{form:d,"data-test-subj":"stepRuleActions"},i.a.createElement(n.EuiForm,null,f))))},et=Object(r.memo)(Xe),tt=({addPadding:e,defaultValues:t})=>{const{services:{triggersActionsUi:a}}=Object(z.j)(),r=a.actionTypeRegistry,{data:o}=(()=>{const{addError:e}=Object(Ce.a)();return Object(Ie.useQuery)(["GET",Te.BASE_ACTION_API_PATH,"connectors"],(({signal:e})=>Object(Me.f)(e)),{onError:t=>{e(t,{title:Fe,toastMessage:Pe})}})})(),{data:s}=(()=>{const{addError:e}=Object(Ce.a)();return Object(Ie.useQuery)(["GET",Te.BASE_ACTION_API_PATH,"connector_types","siem"],(({signal:e})=>Object(Me.e)(e)),{onError:t=>{e(t,{title:De,toastMessage:Pe})}})})(),l=t.actions,c=t.responseActions||[];if(!(l.length>0||c.length>0)||!o||!s)return null;const u=l.length>0&&c.length>0;return i.a.createElement(Oe.a,{addPadding:e},l.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiText,{size:"m"},Ae),i.a.createElement(n.EuiSpacer,{size:"s"})),l.map(((e,t)=>{const a=t===l.length-1;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Qe,{action:e,connectorTypes:s,connectors:o,actionTypeRegistry:r,key:e.id}),!a&&i.a.createElement(n.EuiSpacer,{size:"s"}))})),u&&i.a.createElement(n.EuiSpacer,{size:"l"}),c.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiText,{size:"m"},ze),i.a.createElement(n.EuiSpacer,{size:"s"})),c.map(((e,t)=>{const a=t===c.length-1;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ke,{action:e,key:`${e.actionTypeId}-${t}`}),!a&&i.a.createElement(n.EuiSpacer,{size:"s"}))})))},at=Object(r.memo)(tt)},605:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(175),r=a(379);const i=({dataFormattedForFieldBrowser:e})=>{const t=Object(n.b)(e),{loading:a,error:i,rule:o}=Object(r.a)(t.ruleId);return{loading:a,error:i,basicAlertData:t,ruleNote:null==o?void 0:o.note}}},606:function(e,t,a){"use strict";a.d(t,"a",(function(){return k})),a.d(t,"b",(function(){return M}));var n=a(851),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(42),c=a(1216),u=a(122),d=a(228),p=a(16),m=a(263),b=a(628),g=a(153),f=a(125),h=a(302),v=a(130),y=a(149),E=a(118),x=a(229),j=a(288),w=a(318),S=a(287),O=a(319);const k="prevalence",I="now-30d",T=()=>{const{euiTheme:e}=Object(s.useEuiTheme)();return o.a.createElement("div",{"data-test-subj":g.E,style:{height:"16px",width:"100%",background:e.colors.lightShade}})},C=[{field:"field",name:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.fieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":g.A,render:e=>o.a.createElement(s.EuiText,{size:"xs"},e),width:"20%"},{name:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.valueColumnLabel",defaultMessage:"Value"}),"data-test-subj":g.H,render:e=>o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.values.map((t=>e.isPreviewEnabled&&e.field===x.g?o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiLink,{"data-test-subj":g.B,onClick:()=>e.openHostPreview(t)},o.a.createElement(s.EuiText,{size:"xs"},t))):e.isPreviewEnabled&&e.field===x.p?o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiLink,{"data-test-subj":g.F,onClick:()=>e.openUserPreview(t)},o.a.createElement(s.EuiText,{size:"xs"},t))):o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiText,{size:"xs"},t))))),width:"20%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnTooltip",defaultMessage:"Total number of alerts with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnLabel",defaultMessage:"Alert"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":g.y,render:e=>{const t=e.values.map((t=>Object(h.a)(e.field,`timeline-indicator-${e.field}-${t}`,t)));return e.alertCount>0?o.a.createElement(m.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to}},o.a.createElement(d.a,{count:e.alertCount})):Object(v.d)()},width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnTooltip",defaultMessage:"Total number of event documents with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnLabel",defaultMessage:"Document"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":g.z,render:e=>{const t=e.values.map((t=>({...Object(h.a)(e.field,`timeline-indicator-${e.field}-${t}`,t),and:[Object(h.b)("event.kind","timeline-indicator-event.kind-not-signal","signal",y.e,!0)]})));return e.docCount>0?o.a.createElement(m.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to},keepDataView:!0},o.a.createElement(d.a,{count:e.docCount})):Object(v.d)()},width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnTooltip",defaultMessage:"Percentage of unique hosts with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnLabel",defaultMessage:"Host"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":g.C,render:e=>o.a.createElement(o.a.Fragment,null,e.isPlatinumPlus?o.a.createElement(s.EuiText,{size:"xs"},`${Math.round(100*e.hostPrevalence)}%`):o.a.createElement(T,null)),width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnTooltip",defaultMessage:"Percentage of unique users with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnLabel",defaultMessage:"User"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":g.G,render:e=>o.a.createElement(o.a.Fragment,null,e.isPlatinumPlus?o.a.createElement(s.EuiText,{size:"xs"},`${Math.round(100*e.userPrevalence)}%`):o.a.createElement(T,null)),width:"10%"}],M=()=>{const{dataFormattedForFieldBrowser:e,investigationFields:t,scopeId:a}=Object(f.b)(),{openPreviewPanel:n}=Object(c.a)(),{telemetry:d}=Object(E.j)().services,m=Object(p.b)().isPlatinumPlus(),h=!Object(u.a)("entityAlertPreviewDisabled"),[v,y]=Object(i.useState)(I),[x,k]=Object(i.useState)("now"),[T,M]=Object(i.useState)((r.a.parse(I)||new Date).toISOString()),[F,D]=Object(i.useState)((r.a.parse("now")||new Date).toISOString()),{loading:P,error:L,data:N}=Object(b.a)({dataFormattedForFieldBrowser:e,investigationFields:t,interval:{from:v,to:x}}),R=Object(i.useCallback)((e=>{n({id:j.e,params:{hostName:e,scopeId:a,banner:w.a}}),d.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[n,a,d]),_=Object(i.useCallback)((e=>{n({id:S.d,params:{userName:e,scopeId:a,banner:O.a}}),d.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[n,a,d]),A=Object(i.useMemo)((()=>N.map((e=>({...e,from:T,to:F,isPlatinumPlus:m,isPreviewEnabled:h,openHostPreview:R,openUserPreview:_})))),[N,T,F,m,h,R,_]),z=o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiCallOut,{"data-test-subj":g.I},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellDescription",defaultMessage:"Host and user prevalence are only available with a {subscription}.",values:{subscription:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellLinkText",defaultMessage:"Platinum or higher subscription"}))}})),o.a.createElement(s.EuiSpacer,{size:"s"}));return o.a.createElement(o.a.Fragment,null,!L&&!m&&z,o.a.createElement(s.EuiPanel,null,o.a.createElement(s.EuiSuperDatePicker,{start:v,end:x,onTimeChange:({start:e,end:t,isInvalid:a})=>{if(a)return;y(e),k(t);const n=r.a.parse(e);n&&n.isValid()&&M(n.toISOString());const i=r.a.parse(t);i&&i.isValid()&&D(i.toISOString())},"data-test-subj":g.x,width:"full"}),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiInMemoryTable,{items:L?[]:A,columns:C,loading:P,"data-test-subj":g.D,message:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})})))};M.displayName="PrevalenceDetails"},607:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(44),r=a(813),i=a(332),o=a(503),s=a(549);const l=({dataFormattedForFieldBrowser:e,investigationFields:t})=>{var a,l;const c=Object(i.a)(e),u=Object(s.a)(e),d=Object(n.find)({category:"event",field:"event.code"},e),p=Array.isArray(null==d?void 0:d.originalValue)?null==d||null===(a=d.originalValue)||void 0===a?void 0:a[0]:null==d?void 0:d.originalValue,m=Object(n.find)({category:"kibana",field:r.o},e),b=Array.isArray(null==m?void 0:m.originalValue)?null==m||null===(l=m.originalValue)||void 0===l?void 0:l[0]:null==m?void 0:m.originalValue;return Object(s.b)({eventCategories:u,eventCode:p,eventRuleType:b,highlightedFieldsOverride:null!=t?t:[]}).reduce(((t,a)=>{var r,i;const s=e.find((e=>e.field===a.id||a.legacyId&&e.field===a.legacyId));if(!s)return t;const l=s.values;return!l||Object(n.isEmpty)(l)?t:(s.field===a.legacyId&&(a.id=a.legacyId),Object(o.b)(a.id)&&c.details.agentIdField!==a.id?t:{...t,[a.id]:{...a.overrideField&&{overrideField:{field:a.overrideField,values:null!==(r=null===(i=Object(n.find)({field:a.overrideField},e))||void 0===i?void 0:i.values)&&void 0!==r?r:[]}},values:l}})}),{})}},608:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));const n=(e,t,a)=>Object.keys(e).map((n=>{var r,i;const o=null===(r=e[n].overrideField)||void 0===r?void 0:r.field,s=null===(i=e[n].overrideField)||void 0===i?void 0:i.values,l=o||n;return{field:l,description:{field:l,...o?{originalField:n}:{},values:null!=s&&s.length?s:e[n].values,scopeId:t,isPreview:a}}})),r=e=>Object.keys(e).reduce(((t,a)=>{const n=e[a].values;return{...t,[a]:{terms:{[a]:n}}}}),[])},609:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(352),i=a(131),o=a(234);const s=({entityId:e,scopeId:t})=>{const{loading:a,error:s,count:l,alertIds:c}=Object(r.a)({field:o.c,value:e,isActiveTimelines:Object(i.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0});return Object(n.useMemo)((()=>({loading:a,error:s,data:c||[],dataCount:l||0})),[c,l,s,a])}},610:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(234),i=a(352),o=a(131);const s=({originalEventId:e,scopeId:t})=>{const{loading:a,error:s,count:l,alertIds:c}=Object(i.a)({field:r.a,value:e,isActiveTimelines:Object(o.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0});return Object(n.useMemo)((()=>({loading:a,error:s,data:c||[],dataCount:l||0})),[c,l,s,a])}},611:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(47),r=a(2),i=a(118),o=a(5);const s=({eventId:e})=>{const{services:{cases:t}}=Object(i.j)(),{data:a,isLoading:s,isError:l}=Object(n.useQuery)(["useFetchRelatedCases",e],(()=>t.api.getRelatedCases(e,{owner:o.j})),{keepPreviousData:!0});return Object(r.useMemo)((()=>({loading:s,error:l,data:a||[],dataCount:(null==a?void 0:a.length)||0})),[a,l,s])}},612:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(36),r=a(242),i=a(142);const o=({getFieldsData:e})=>{const{cases:t}=Object(r.c)().services,a="signal"===Object(i.a)(e("event.kind")),o=t.helpers.canUseCases([n.APP_ID]);return a&&o.read}},613:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(541),r=a(16),i=a(234),o=a(142);const s=({getFieldsData:e,dataAsNestedObject:t,eventId:a,isPreview:s})=>{var l;const c=Object(n.a)(t),u=null!==(l=Object(o.a)(e(i.a)))&&void 0!==l?l:"",d=s?u:a,p=Object(r.b)().isPlatinumPlus();return{show:c&&p,documentId:d}}},614:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(813);const r=({getFieldsData:e})=>{const t=e(n.t),a=t?parseInt(t[0],10):0;return{show:Boolean(t),alertSuppressionCount:a}}},615:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(234),r=a(142);const i=({eventId:e,getFieldsData:t})=>{var a;return{show:!0,originalEventId:null!==(a=Object(r.a)(t(n.a)))&&void 0!==a?a:e}}},616:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(234),r=a(142);const i=({getFieldsData:e})=>{const t=Object(r.a)(e(n.c));return{show:null!=t,...t&&{entityId:t}}}},617:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(539),i=a(131);const o=({documentId:e,indices:t,scopeId:a})=>{const o=Object(i.isActiveTimeline)(a),{loading:s,error:l,alertIds:c}=Object(r.a)({isActiveTimeline:o,documentId:e,indices:t});return Object(n.useMemo)((()=>({loading:s,error:l,data:c,dataCount:(null==c?void 0:c.length)||0})),[c,l,s])}},618:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(120),r=a(273),i=a(526);let o=function(e){return e.Prebuilt="prebuilt",e.Custom="custom",e}({});const s=n.object({searchTerm:n.string(),source:n.nativeEnum(o),tags:n.array(n.string()),enabled:n.boolean(),ruleExecutionStatus:r.e}).partial(),l=i.b.pick({field:!0,order:!0}).partial(),c=i.a.pick({perPage:!0}).partial(),u=i.a.pick({page:!0,perPage:!0}).partial()},619:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return i})),a.d(t,"i",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.disabledTitle",{defaultMessage:"Disabled"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Enabled"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:e},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}),p=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}),m=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:e,requiredVersion:t},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"})},621:function(e,t,a){"use strict";a.d(t,"a",(function(){return Ft}));var n=a(2),r=a.n(n),i=a(45),o=a(19),s=a(42),l=a(48),c=a(888),u=a(147),d=a(41),p=a.n(d),m=a(410);function b(e,t,a){return t+(e>1?a*(e-1):0)}var g=a(49);function f(){return Object(n.useMemo)((()=>({copyableFieldBackground:g.euiThemeVars.euiColorLightShade,descriptionText:g.euiThemeVars.euiTextColor,full:g.euiThemeVars.euiColorFullShade,graphControls:g.euiThemeVars.euiColorDarkestShade,graphControlsBackground:g.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:g.euiThemeVars.euiColorLightShade,processBackingFill:`${g.euiThemeVars.euiColorPrimary}${g.darkMode?"1F":"0F"}`,resolverBackground:g.euiThemeVars.euiColorEmptyShade,resolverEdge:g.darkMode?g.euiThemeVars.euiColorLightShade:g.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:g.euiThemeVars.euiColorLightestShade,resolverEdgeText:g.darkMode?g.euiThemeVars.euiColorFullShade:g.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${g.euiThemeVars.euiColorDanger}${g.darkMode?"1F":"0F"}`,pillStroke:g.euiThemeVars.euiColorLightShade,linkColor:g.euiThemeVars.euiLinkColor})),[])}const h=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${b(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),v=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),y=r.a.memo((({className:e,edgeLineMetadata:t,startPosition:a,endPosition:n,projectionMatrix:i})=>{const o=Object(m.c)(a,i),l=Object(m.c)(n,i),[c]=i,u=f(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(o,l),g=b(c,10,7.5),y={left:`${o[0]}px`,top:`${o[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(o,l)}rad)`};let E=50;return c<1&&(E+=1/c*(10*(1-c))),r.a.createElement(h,{className:e,style:y,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&r.a.createElement(v,{backgroundColor:u.resolverEdge,leftPct:E,scaledTypeSize:g,textColor:u.resolverEdgeText},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var E=a(4);const x={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},j=Object(n.createContext)(x);var w=a(509),S=a(122);const O=["fit-content(10em)","auto"],k=p()(o.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-160k3ht-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),I=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-160k3ht-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),T=p()(o.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-160k3ht-2"})(["text-transform:uppercase;"]),C=p()(o.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-160k3ht-3"})(["lineheight:'2.2em';"]),M=p()(o.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-160k3ht-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),F=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-160k3ht-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor));var D=a(500),P=a(127);const L=E.i18n.translate("xpack.securitySolution.resolver.graphControls.sourcererButtonTitle",{defaultMessage:"Data View Selection"}),N=Object(n.memo)((({id:e,closePopover:t,setActivePopover:a,isOpen:i})=>{const s=Object(n.useCallback)((()=>a("sourcererSelection")),[a]),l=f();return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:sourcerer-button",size:"m",title:L,"aria-label":L,onClick:s,iconType:"indexSettings",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:i,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(D.a,{scope:P.SourcererScopeName.analyzer}))}));N.displayName="SourcererButton";var R=a(346),_=a(310);const A=[],z=E.i18n.translate("xpack.securitySolution.resolver.graphControls.datePickerButtonTitle",{defaultMessage:"Date Range Selection"}),B=E.i18n.translate("xpack.securitySolution.resolver.graphControls.datePicker",{defaultMessage:"date range selection"}),V=Object(n.memo)((({id:e,closePopover:t,setActivePopover:a,isOpen:s})=>{const l=Object(i.useDispatch)(),c=Object(n.useCallback)((()=>a("datePicker")),[a]),d=f(),p=Object(i.useSelector)((t=>u.e(t.analyzer[e]))),m=Object(n.useCallback)((({start:t,end:a,isInvalid:n})=>{if(!n){const n=t.includes("now")||a.includes("now"),r=Object(R.c)(t);let i=Object(R.c)(a,{roundUp:!0});n&&(i=t===a?Object(R.c)("now"):Object(R.c)(a)),l(Object(_.userOverrodeDateRange)({id:e,timeRange:{from:r,to:i}}))}}),[l,e]);return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:date-picker-button",size:"m",title:z,"aria-label":z,onClick:c,iconType:"calendar",$backgroundColor:d.graphControlsBackground,$iconColor:d.graphControls,$borderColor:d.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},B),r.a.createElement(o.EuiSuperDatePicker,{onTimeChange:m,start:null==p?void 0:p.from,end:null==p?void 0:p.to,showUpdateButton:!1,recentlyUsedRanges:A,width:"auto"}))}));V.displayName="DateSelectionButton";const $=Object(n.memo)(p()(o.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),q=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),G=p()(o.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),U=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),H=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),W=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),Q=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],H,W),K=p()(o.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),J=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function Y({id:e}){return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function Z(e,t,a){const r=Y({id:e}),i=f(),o=Object(n.useMemo)((()=>({runningProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.runningProcessCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.loadingCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},errorCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.errorCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${r.runningTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${r.terminatedProcessCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${r.terminatedTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger}})),[r,i]);return"terminated"===t?a?o.terminatedTriggerCube:o[X.processTerminated]:"running"===t?a?o[X.processCausedAlert]:o[X.processRan]:"error"===t?o[X.processError]:o[X.processLoading]}const X={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},ee=Object(n.memo)((function({id:e,className:t,size:a="2.15em",state:n,isOrigin:i,"data-test-subj":o}){const{cubeSymbol:s,strokeColor:l}=Z(e,n,!1),{processCubeActiveBacking:c}=Y({id:e});return r.a.createElement(te,{className:t,width:a,height:a,viewBox:"0 0 34 34","data-test-subj":o,isOrigin:i,style:{verticalAlign:"middle"}},r.a.createElement("desc",null,E.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process} other {Unknown Process State}}",values:{state:n}})),i&&r.a.createElement("use",{xlinkHref:`#${c}`,fill:"transparent",x:0,y:-1,stroke:l,strokeDashoffset:0,width:"100%",height:"100%"}),r.a.createElement("use",{role:"presentation",xlinkHref:s,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),te=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),ae=r.a.memo((function({children:e}){return r.a.createElement(r.a.Fragment,null,r.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,r.a.createElement("wbr",null)]}),[])]}return e})))})),ne=({id:e,closePopover:t,setActivePopover:a,isOpen:i})=>{const s=Object(n.useCallback)((()=>a("nodeLegend")),[a]),l=f(),c=E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:c,"aria-label":c,onClick:s,iconType:"node",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:i,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),r.a.createElement("div",{style:{maxWidth:"212px"}},r.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:O,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),r.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))},re=({id:e,closePopover:t,setActivePopover:a,isOpen:s})=>{var l,c,d;const p=f(),m=Object(i.useSelector)((t=>u.H(t.analyzer[e]))),b=Object(n.useCallback)((()=>a("schemaInfo")),[a]),g=E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),h=E.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return r.a.createElement(o.EuiPopover,{button:r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:b,iconType:"iInCircle",$backgroundColor:p.graphControlsBackground,$iconColor:p.graphControls,$borderColor:p.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),r.a.createElement(o.EuiIconTip,{content:E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),r.a.createElement("div",{style:{maxWidth:"268px"}},r.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:O,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),r.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(l=null==m?void 0:m.dataSource)&&void 0!==l?l:h)),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),r.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(c=null==m?void 0:m.schema.id)&&void 0!==c?c:h)),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),r.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(d=null==m?void 0:m.schema.parent)&&void 0!==d?d:h))))))},ie=r.a.memo((({id:e,className:t})=>{const a=Object(i.useDispatch)(),s=Object(i.useSelector)((t=>u.I(t.analyzer[e]))),{timestamp:l}=Object(n.useContext)(j),c=Object(S.a)("analyzerDatePickersAndSourcererDisabled"),[d,p]=Object(n.useState)(null),m=f(),b=Object(n.useCallback)((e=>{p(e===d?null:e)}),[p,d]),g=Object(n.useCallback)((()=>p(null)),[]),h=Object(n.useCallback)((t=>{const n=parseFloat(t.target.value);!1===isNaN(n)&&a(Object(w.userSetZoomLevel)({id:e,zoomLevel:n}))}),[a,e]),v=Object(n.useCallback)((()=>{a(Object(w.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[a,e]),y=Object(n.useCallback)((()=>{a(Object(w.userClickedZoomOut)({id:e}))}),[a,e]),x=Object(n.useCallback)((()=>{a(Object(w.userClickedZoomIn)({id:e}))}),[a,e]),[O,T,C,M]=Object(n.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{a(Object(w.userNudgedCamera)({id:e,direction:t,time:l()}))}))),[a,l,e]);return r.a.createElement(F,{className:t,$iconColor:m.graphControls,"data-test-subj":"resolver:graph-controls"},r.a.createElement(I,null,r.a.createElement(re,{id:e,closePopover:g,isOpen:"schemaInfo"===d,setActivePopover:b}),r.a.createElement(ne,{id:e,closePopover:g,isOpen:"nodeLegend"===d,setActivePopover:b}),c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{id:e,closePopover:g,isOpen:"sourcererSelection"===d,setActivePopover:b}),r.a.createElement(V,{id:e,closePopover:g,isOpen:"datePicker"===d,setActivePopover:b}))),r.a.createElement(I,null,r.a.createElement(o.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("div",{className:"panning-controls-top"},r.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:O},r.a.createElement(o.EuiIcon,{type:"arrowUp"}))),r.a.createElement("div",{className:"panning-controls-middle"},r.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:M},r.a.createElement(o.EuiIcon,{type:"arrowLeft"})),r.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:v},r.a.createElement(o.EuiIcon,{type:"bullseye"})),r.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:T},r.a.createElement(o.EuiIcon,{type:"arrowRight"}))),r.a.createElement("div",{className:"panning-controls-bottom"},r.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:C},r.a.createElement(o.EuiIcon,{type:"arrowDown"})))),r.a.createElement(o.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:x},r.a.createElement(o.EuiIcon,{type:"plusInCircle"})),r.a.createElement(k,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:s,onChange:h}),r.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:y},r.a.createElement(o.EuiIcon,{type:"minusInCircle"})))))}));function oe(e,t){return function(e,t){const a=Object(l.useHistory)(),r=Object(n.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.push(e)))}),[a,t,e]);return{href:a.createHref(e),onClick:r}}({search:Object(i.useSelector)((a=>u.F(a.analyzer[e])(t)))})}ie.displayName="GraphControls";var se=a(228),le=a(217);const ce=r.a.memo((({id:e,className:t,nodeID:a,nodeStats:i})=>{const o=Object(n.useMemo)((()=>void 0===i?[]:Object.entries(i.byCategory).map((([e,t])=>({prefix:r.a.createElement(se.a,{count:t||0}),category:e})))),[i]);return void 0===o?null:r.a.createElement("ul",{className:`${t} options`,"aria-describedby":a},o.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>r.a.createElement(ue,{id:e,pill:t,nodeID:a,key:t.category}))))})),ue=({id:e,pill:t,nodeID:a})=>{const o=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:a,eventCategory:t.category}}),{pillStroke:s,resolverBackground:l}=f(),c=Object(n.useMemo)((()=>({border:`1.5px solid ${s}`,backgroundColor:l})),[s,l]),u=Object(i.useDispatch)(),{timestamp:d}=Object(n.useContext)(j),p=Object(n.useCallback)((t=>{o.onClick(t),u(Object(le.userSelectedResolverNode)({id:e,nodeID:a,time:d()}))}),[d,o,u,a,e]);return r.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:c,key:t.category},r.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:p},t.prefix," ",t.category))},de=p()(ce).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),pe=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),me=p()(o.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),be=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ge=p()(o.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var fe=a(309),he=a(212),ve=a(291);const ye=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),Ee=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),xe=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),je=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),we=r.a.memo((({id:e,className:t,position:a,node:l,nodeID:c,projectionMatrix:d,timeAtRender:p})=>{const g=`resolver:${e}`,h=Y({id:e}),{timestamp:v}=Object(n.useContext)(j),[y,x]=Object(m.c)(a,d),[w]=d,S=Object(i.useSelector)((t=>u.b(t.analyzer[e]))),O=Object(i.useSelector)((t=>u.J(t.analyzer[e]))),k=Object(i.useSelector)((t=>u.A(t.analyzer[e]))),I=Object(i.useSelector)((t=>u.z(t.analyzer[e])(c))),T=Object(n.useCallback)((e=>Object(o.htmlIdGenerator)(g)(`${e}:node`)),[g]),C=Object(i.useSelector)((t=>u.d(t.analyzer[e])(c))),M=Object(i.useSelector)((t=>u.c(t.analyzer[e])(p)(c))),F=w>.8,D=w>=.55,P=(F?3.5:D?1:21)*w+5,L=360*(F?-.147413:-.147413-.08*(w-.5))*w,N=120*(F?-.53684:.2*-w*(1-w)/w-.53684)*w,R=Object(n.useMemo)((()=>({left:`${y+L}px`,top:`${x+N}px`,width:360*w+"px",height:120*w+"px"})),[y,w,L,N,x]),A=b(w,18.75,12.5),z=r.a.createRef(),B=f(),V=Object(i.useSelector)((t=>u.x(t.analyzer[e])(c))),$="loading"===V,{backingFill:q,cubeSymbol:G,descriptionText:U,isLabelFilled:H,labelButtonFill:W,strokeColor:Q}=Z(e,V,!1),K=Object(n.useMemo)((()=>Object(o.htmlIdGenerator)("resolver")(`${c}:label`)),[c]),J=c===S,X=c===O,ee=c===k,te=Object(i.useDispatch)(),ae=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:c}}),ne=Object(n.useCallback)((()=>{te(Object(le.userFocusedOnResolverNode)({id:e,nodeID:c,time:v()}))}),[te,c,v,e]),re=Object(n.useCallback)((t=>{var a;null!==(a=z.current)&&void 0!==a&&a.beginElement&&z.current.beginElement(),"error"===V?te(Object(_.userReloadedResolverNode)({id:e,nodeID:c})):(te(Object(le.userSelectedResolverNode)({id:e,nodeID:c,time:v()})),ae.onClick(t))}),[z,te,c,ae,V,v,e]),ie=Object(i.useSelector)((t=>u.K(t.analyzer[e])(l))),se=fe.c(l),ce=Object(i.useSelector)((t=>ve.a(u.w(t.analyzer[e])(String(l.id))))),ue=Object(n.useMemo)((()=>void 0!==ce?he.l(ce):se),[ce,se]),pe=Object(n.useMemo)((()=>null===M?void 0:T(M)),[M,T]),me=Object(n.useMemo)((()=>T(c)),[T,c]);return r.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":c,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===C?void 0:C,"aria-flowto":pe,"aria-labelledby":K,"aria-haspopup":"true","aria-current":J?"true":void 0,"aria-selected":X?"true":void 0,style:R,id:me,tabIndex:-1},r.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{ne(),re(e)},role:"img","aria-labelledby":K,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},r.a.createElement(je,{isNodeLoading:$},r.a.createElement("use",{xlinkHref:`#${h.processCubeActiveBacking}`,fill:q,x:-15.35,y:-15.35,stroke:Q,width:22.5,height:22.5,className:"backing"}),ee&&r.a.createElement("use",{xlinkHref:`#${h.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:Q,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),r.a.createElement("use",{role:"presentation",xlinkHref:G,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},r.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:z})))),r.a.createElement(ye,{color:B.full,fontSize:A,topPct:P},r.a.createElement(Ee,{backgroundColor:B.resolverBackground,color:B.descriptionText,isDisplaying:D,"data-test-subj":"resolver:node:description"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event · {descriptionText}} other {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:U}})),r.a.createElement("div",{className:"euiButton euiButton--small",id:K,onClick:re,onFocus:ne,tabIndex:-1,style:{backgroundColor:B.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},r.a.createElement(o.EuiButton,{iconSide:$?"right":"left",isLoading:$,color:W,fill:H,iconType:"error"===V?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*w,32)}px`,maxWidth:(F?400:210*w)+"px"},tabIndex:-1,title:ue,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":c},r.a.createElement(xe,{isShowingIcon:"loading"===V||"error"===V,className:"eui-textTruncate","data-test-subj":"euiButton__text"},E.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:V,nodeName:ue}})))),r.a.createElement(o.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:B.resolverBackground,display:F?"flex":"none",margin:"2px 0 0 0",padding:0}},r.a.createElement(o.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==ie&&ie>0&&r.a.createElement(de,{id:e,buttonFill:B.resolverBackground,nodeStats:I,nodeID:c})))))})),Se=p()(we).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var Oe=a(56);function ke({id:e}){const t=e;return Object(n.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const Ie=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),Te=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),Ce=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),Me=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),Fe=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),De=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Pe=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Le=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=ke({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#6D6D6D"}),r.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),r.a.createElement("linearGradient",{id:a.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),r.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),r.a.createElement("linearGradient",{id:a.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),r.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),r.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#DD0A73"}),r.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Ne=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=Y({id:e}),n=ke({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("symbol",{id:a.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},r.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),r.a.createElement("symbol",{id:a.loadingCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Ie),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),r.a.createElement("symbol",{id:a.errorCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Te),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.errorCube})`}),r.a.createElement("g",{opacity:"0.6"},r.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.errorCube})`}),r.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.runningProcessCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Ce),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningProcessCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{id:a.runningTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Me),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningTriggerCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{viewBox:"0 0 88 100",id:a.terminatedProcessCube},r.a.createElement("title",null,Fe),r.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),r.a.createElement("g",{opacity:"0.7"},r.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.terminatedProcessCube})`}),r.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.terminatedTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,De),t&&r.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("g",{opacity:"0.6"},!t&&r.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${n.terminatedTriggerCube})`}),r.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{viewBox:"0 -3 88 106",id:a.processCubeActiveBacking},r.a.createElement("title",null,Pe),r.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),Re=Object(n.memo)((({id:e})=>{const t=Object(Oe.useDarkMode)();return r.a.createElement(_e,null,r.a.createElement("defs",null,r.a.createElement(Le,{id:e,isDarkMode:t}),r.a.createElement(Ne,{id:e,isDarkMode:t})))})),_e=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Ae=a(119),ze=a.n(Ae);const Be=Object(n.memo)((function({breadcrumbs:e}){const t=Object(n.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:a,resolverEdgeText:i}=f();return r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{background:a,text:i,breadcrumbs:t,truncate:!1}))})),Ve=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function $e({id:e}){const t=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),a=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),i=oe(e,{panelView:"nodes"}),s=Object(n.useMemo)((()=>[{text:a,...i}]),[i,a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Be,{breadcrumbs:s}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},r.a.createElement(Ve,null,r.a.createElement(o.EuiLoadingSpinner,{size:"m"})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function qe({event:e}){var t,a,n,i,o,l,c,u,d,p,m,b,g,f,h,v,y,E,x;return Object(he.i)(e)?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(he.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(a=e.kibana)&&void 0!==a&&null!==(n=a.alert)&&void 0!==n&&null!==(i=n.rule)&&void 0!==i&&i.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(b=e.kibana)||void 0===b||null===(g=b.alert)||void 0===g||null===(f=g.rule)||void 0===f?void 0:f.name)}}):null!==(o=e.file)&&void 0!==o&&o.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(h=e.file)||void 0===h?void 0:h.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(v=e.registry)||void 0===v?void 0:v.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(y=e.registry)||void 0===y?void 0:y.key)}}):null!==(u=e.dns)&&void 0!==u&&null!==(d=u.question)&&void 0!==d&&d.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(E=e.dns)||void 0===E||null===(x=E.question)||void 0===x?void 0:x.name)}}):r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(he.b)(e)}})}var Ge=a(73),Ue=a.n(Ge);const He=E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),We=new Intl.DateTimeFormat(E.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Qe(e){const t=Object(Oe.useUiSetting)("dateFormat"),a=Object(Oe.useUiSetting)("dateFormat:tz"),n="Browser"===a?Ue.a.tz.guess():a;if(!e)return;const r=new Date(e);return r&&Number.isFinite(r.getTime())?t?Ue.a.tz(r,n).format(t):We.format(r):He}var Ke=a(262);const Je=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(i.useSelector)((a=>u.i(a.analyzer[e])(t))),l=Object(i.useSelector)((t=>u.r(t.analyzer[e]))),c=Object(i.useSelector)((t=>u.j(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):r.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},c||!n?r.a.createElement(o.EuiCallOut,{title:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe,{id:e,nodeName:n.name,eventCategory:a,nodeID:t}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(Ze,{id:e,eventCategory:a,nodeID:t}))))})),Ye=Object(n.memo)((function({id:e,event:t,nodeID:a,eventCategory:n}){const i=Object(Ke.a)(t),l=he.g(i),c=he.e(i),u=he.p(i),d=Qe(l)||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),p=oe(e,{panelView:"eventDetail",panelParameters:{nodeID:a,eventCategory:n,eventID:c,eventTimestamp:String(l),winlogRecordID:String(u)}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiText,null,r.a.createElement(K,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:he.d(i).join(", "),eventType:he.h(i).join(", ")},defaultMessage:"{category} {eventType}"})),r.a.createElement(J,{dateTime:d},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:d},defaultMessage:"@ {date}"}))),r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiButtonEmpty,ze()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},p),r.a.createElement(qe,{event:i})))})),Ze=Object(n.memo)((function({id:e,eventCategory:t,nodeID:a}){const l=Object(i.useSelector)((t=>u.y(t.analyzer[e]))),c=Object(i.useDispatch)(),d=Object(n.useCallback)((()=>{c(Object(_.userRequestedAdditionalRelatedEvents)({id:e}))}),[c,e]),p=Object(i.useSelector)((t=>u.q(t.analyzer[e]))),m=Object(i.useSelector)((t=>u.t(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l.map(((i,s)=>r.a.createElement(n.Fragment,{key:s},r.a.createElement(Ye,{id:e,nodeID:a,eventCategory:t,event:i}),s===l.length-1?null:r.a.createElement(o.EuiHorizontalRule,{margin:"m"})))),m&&r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{color:"primary",size:"s",fill:!0,onClick:d,isLoading:p,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Xe=Object(n.memo)((function({id:e,nodeName:t,eventCategory:a,nodeID:n}){const o=Object(i.useSelector)((t=>u.M(t.analyzer[e])(n))),l=Object(i.useSelector)((t=>u.D(t.analyzer[e])(n,a))),c=oe(e,{panelView:"nodes"}),d=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),p=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}});return r.a.createElement(Be,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...c},{text:t,...d},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:o},defaultMessage:"{totalCount} Events"}),...p},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:l,category:a},defaultMessage:"{count} {category}"})}]})}));function et({id:e,nodeID:t}){const a=Object(i.useSelector)((a=>ve.a(u.w(a.analyzer[e])(t)))),n=Object(i.useSelector)((a=>u.z(a.analyzer[e])(t)));return void 0===a||void 0===n?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):r.a.createElement(me,{hasBorder:!0},r.a.createElement(at,{id:e,nodeName:he.l(a),nodeID:t,totalEventCount:n.total}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(tt,{id:e,nodeID:t,relatedStats:n}))}const tt=Object(n.memo)((function({id:e,nodeID:t,relatedStats:a}){const i=Object(n.useMemo)((()=>Object.entries(a.byCategory).map((([e,t])=>({eventType:e,count:t})))),[a.byCategory]),s=Object(n.useMemo)((()=>[{field:"count",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"25%",sortable:!0,render:e=>r.a.createElement(o.EuiToolTip,{position:"top",content:e},r.a.createElement(se.a,{count:e}))},{field:"eventType",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"75%",sortable:!0,render:a=>r.a.createElement(nt,{id:e,nodeID:t,eventType:a},a)}]),[t,e]);return r.a.createElement(o.EuiInMemoryTable,{items:i,columns:s,sorting:!0})})),at=Object(n.memo)((function({id:e,nodeID:t,nodeName:a,totalEventCount:n}){return r.a.createElement(Be,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...oe(e,{panelView:"nodes"})},{text:a,...oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),nt=Object(n.memo)((({id:e,nodeID:t,eventType:a,children:n})=>{const i=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:a}});return r.a.createElement(o.EuiButtonEmpty,ze()({"data-test-subj":"resolver:panel:node-events:event-type-link"},i),n)}));var rt=a(173),it=a(131),ot=a(889);const st=Object(n.memo)((function({id:e,translatedErrorMessage:t}){const a=oe(e,{panelView:"nodes"}),i=Object(n.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...a},{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Be,{breadcrumbs:i}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiButtonEmpty,a,E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),lt=p()(ee).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),ct=E.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),ut=Object(n.memo)((function({id:e,nodeID:t}){const a=Object(i.useSelector)((a=>ve.a(u.w(a.analyzer[e])(t))));return"loading"===Object(i.useSelector)((a=>u.x(a.analyzer[e])(t)))?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):a?r.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},r.a.createElement(dt,{id:e,nodeID:t,processEvent:a})):r.a.createElement(me,{hasBorder:!0},r.a.createElement(st,{id:e,translatedErrorMessage:ct}))})),dt=Object(n.memo)((function({id:e,processEvent:t,nodeID:a}){const l=he.l(t),c=Object(i.useSelector)((t=>u.x(t.analyzer[e])(a))),d=Object(i.useSelector)((t=>u.E(t.analyzer[e])(a))),p=he.g(t),m=Qe(p),b=Object(n.useMemo)((()=>{const e={title:"@timestamp",description:m,value:p},a={title:"process.executable",description:Object(ot.d)(t)},n={title:"process.pid",description:Object(ot.c)(t)},r={title:"user.name",description:he.o(t)};return[e,a,n,{title:"process.entity_id",description:he.c(t)},r,{title:"user.domain",description:he.n(t)},{title:"process.parent.pid",description:he.k(t)},{title:"process.hash.md5",description:he.j(t)},{title:"process.args",description:he.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:String(e.description)})))}),[m,p,t]),g=oe(e,{panelView:"nodes"}),f=Object(n.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...g},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:l},defaultMessage:"Details for: {processName}"})}]),[l,g]),{descriptionText:h}=Z(e,c,!1),v=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}}),y=Object(n.useMemo)((()=>Object(o.htmlIdGenerator)("resolverTable")()),[]),x=[{field:"title","data-test-subj":"resolver:node-detail:entry-title",name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0,render:e=>r.a.createElement(ae,null,e)},{name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.valueTitle",defaultMessage:"Value"}),"data-test-subj":"resolver:node-detail:entry-description",render(t){var a;return r.a.createElement(rt.c,{data:{field:t.title,value:null!==(a=t.value)&&void 0!==a?a:t.description},triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,visibleCellActions:5,sourcererScopeId:Object(it.getSourcererScopeId)(e),metadata:{scopeId:e}},t.description)}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Be,{breadcrumbs:f}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiTitle,{size:"xs"},r.a.createElement(q,{"aria-describedby":y},r.a.createElement(lt,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:c}),r.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},r.a.createElement(ae,null,l)))),r.a.createElement(o.EuiText,null,r.a.createElement(o.EuiTextColor,{color:"subdued"},r.a.createElement("span",{id:y},h))),r.a.createElement(o.EuiSpacer,{size:"s"}),r.a.createElement(o.EuiLink,ze()({},v,{"data-test-subj":"resolver:node-detail:node-events-link"}),r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:d},defaultMessage:"{relatedEventTotal} Events"})),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiInMemoryTable,{"data-test-subj":"resolver:node-detail",items:b,columns:x,sorting:!0}))})),pt=r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),mt=r.a.memo((function({numberOfEntries:e}){return r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),bt=r.a.memo((function({numberDisplayed:e}){return r.a.createElement(ge,{size:"s",title:r.a.createElement(mt,{numberOfEntries:e})},r.a.createElement("p",null,pt))})),gt=Object(n.memo)((({id:e})=>{const t=Object(n.useMemo)((()=>[{field:"name",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,a)=>r.a.createElement(ft,{id:e,name:t,nodeID:a.nodeID})},{field:"timestamp",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:t=>r.a.createElement(ht,{eventDate:t,id:e})}]),[e]),a=Object(i.useSelector)(Object(n.useCallback)((t=>{const{processNodePositions:a}=u.u(t.analyzer[e]),n=[];for(const e of a.keys()){const t=fe.c(e),a=fe.b(e);void 0!==a&&n.push({name:t,timestamp:fe.a(e),nodeID:a})}return n}),[e])),s=a.length,l=Object(n.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),c=Object(i.useSelector)((t=>u.m(t.analyzer[e]))),d=Object(i.useSelector)((t=>u.l(t.analyzer[e]))),p=Object(i.useSelector)((t=>u.n(t.analyzer[e]))),m=!0===c||!0===d||!0===p,b=Object(n.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return r.a.createElement(me,{hasBorder:!0},r.a.createElement(Be,{breadcrumbs:l}),m&&r.a.createElement(bt,{numberDisplayed:s}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiInMemoryTable,{rowProps:b,"data-test-subj":"resolver:node-list",items:a,columns:t,sorting:!0}))}));gt.displayName="NodeList";const ft=Object(n.memo)((({id:e,name:t,nodeID:a})=>{const s=Object(i.useSelector)((t=>u.A(t.analyzer[e])===a)),l=Object(i.useSelector)((t=>u.x(t.analyzer[e])(a))),{descriptionText:c}=f(),d=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),p=Object(i.useDispatch)(),{timestamp:m}=Object(n.useContext)(j),b=Object(n.useCallback)((t=>{d.onClick(t),p(Object(le.userSelectedResolverNode)({id:e,nodeID:a,time:m()}))}),[m,d,p,a,e]);return r.a.createElement(o.EuiButtonEmpty,{onClick:b,href:d.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":a},void 0===t?r.a.createElement(o.EuiBadge,{color:"warning"},E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):r.a.createElement(U,null,r.a.createElement(ee,{id:e,state:l,isOrigin:s,"data-test-subj":"resolver:node-list:node-link:icon"}),r.a.createElement(Q,null,s&&r.a.createElement(H,{color:c,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},E.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),r.a.createElement(W,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}));ft.displayName="NodeDetailLink";const ht=Object(n.memo)((({eventDate:e,id:t})=>{const a=Qe(e);return a?r.a.createElement(rt.c,{data:{field:"@timestamp",value:e},triggerId:rt.d.DEFAULT,visibleCellActions:5,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(it.getSourcererScopeId)(t),metadata:{scopeId:t}},a):r.a.createElement("span",null,"—")}));function vt(e){const t=[{path:[],value:e}],a=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:n,value:r}=e;Array.isArray(r)?t.push(...r.map((e=>({path:[...n],value:e})))):"object"==typeof r&&null!==r?t.push(...Object.keys(r).map((e=>({path:[...n,e],value:r[e]})))):null!=r&&a.push([n,r])}return a}ht.displayName="NodeDetailTimestamp";const yt=E.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),Et=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(i.useSelector)((t=>u.p(t.analyzer[e]))),o=Object(i.useSelector)((t=>u.s(t.analyzer[e]))),s=Object(i.useSelector)((a=>ve.a(u.w(a.analyzer[e])(t)))),l=Object(i.useSelector)((a=>u.x(a.analyzer[e])(t))),c=n||o||"loading"===l,d=Object(i.useSelector)((t=>u.f(t.analyzer[e])));return c?r.a.createElement(me,{hasBorder:!0},r.a.createElement($e,{id:e})):d?r.a.createElement(xt,{id:e,nodeID:t,event:d,processEvent:s,eventType:a}):r.a.createElement(me,{hasBorder:!0},r.a.createElement(st,{id:e,translatedErrorMessage:yt}))})),xt=Object(n.memo)((function({id:e,nodeID:t,event:a,eventType:n,processEvent:i}){const l=Qe(he.m(a))||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),c=i?he.l(i):null;return r.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},r.a.createElement(wt,{id:e,nodeID:t,nodeName:c,event:a,breadcrumbEventCategory:n}),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(o.EuiText,{size:"s"},r.a.createElement(K,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:n,eventType:String(he.h(a))},defaultMessage:"{category} {eventType}"})),r.a.createElement(J,{dateTime:l},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:l},defaultMessage:"@ {date}"}))),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(St,null,r.a.createElement(ae,null,r.a.createElement(qe,{event:a}))),r.a.createElement(o.EuiSpacer,{size:"l"}),r.a.createElement(jt,{event:a,id:e}))}));function jt({event:e,id:t}){const a=Object(n.useMemo)((()=>{const t=[],a=Object(Ke.a)(e);for(const[e,n]of Object.entries(a)){if("agent"===e||"ecs"===e||"@timestamp"===e||!n)continue;const a=vt(n).map((([t,a])=>({title:[e,...t].join("."),description:String(a)})));t.push(...a)}return t}),[e]),i=[{field:"title","data-test-subj":"resolver:panel:event-detail:event-field-title",name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0},{name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.valueTitle",defaultMessage:"Value"}),render:e=>r.a.createElement(rt.c,{data:{field:e.title,value:e.description},visibleCellActions:5,triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(it.getSourcererScopeId)(t),metadata:{scopeId:t}},e.description)}];return r.a.createElement(o.EuiInMemoryTable,{items:a,columns:i,search:{box:{incremental:!0,schema:!0}},pagination:!0,sorting:!0})}function wt({id:e,nodeID:t,nodeName:a,event:o,breadcrumbEventCategory:l}){const c=Object(i.useSelector)((a=>u.D(a.analyzer[e])(t,l))),d=Object(i.useSelector)((a=>u.E(a.analyzer[e])(t))),p=oe(e,{panelView:"nodes"}),m=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),b=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),g=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:l}}),f=Object(n.useMemo)((()=>{const e=[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...p},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:d},defaultMessage:"{totalCount} Events"}),...b},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:c,category:l},defaultMessage:"{count} {category}"}),...g},{text:r.a.createElement(qe,{event:o})}];return a&&e.splice(1,0,{text:a,...m}),e}),[l,c,o,m,b,a,d,p,g]);return r.a.createElement(Be,{breadcrumbs:f})}const St=Object(n.memo)(p()(o.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),Ot=Object(n.memo)((function({id:e}){const t=Object(i.useSelector)((t=>u.B(t.analyzer[e])));return"nodeDetail"===t.panelView?r.a.createElement(ut,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?r.a.createElement(et,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?r.a.createElement(Je,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?r.a.createElement(Et,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):r.a.createElement(gt,{id:e})}));var kt=a(959);const It=p()(o.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),Tt=p()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),Ct=()=>r.a.createElement(Tt,{"data-test-subj":"resolver:no-process-events",direction:"column"},r.a.createElement(o.EuiTitle,null,r.a.createElement("h4",null,E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(It,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var Mt=a(123);const Ft=r.a.memo(r.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m},b){!function(e){const t=Object(n.useRef)();t.current=Object(l.useLocation)().search;const a=Object(i.useDispatch)(),r=Object(l.useHistory)(),o=Object(c.a)(e);Object(n.useEffect)((()=>{const e=o;return()=>{const a=new URLSearchParams(t.current);a.delete(e);const n={search:a.toString()};r.replace(n)}}),[o,r,a,e])}(a),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:a,filters:r,shouldUpdate:o}){const s=Object(i.useDispatch)(),c=Object(l.useLocation)().search;Object(n.useLayoutEffect)((()=>{s(Object(le.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:c,indices:a,shouldUpdate:o,filters:r}))}),[s,e,t,c,a,o,r])}({databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m}),function({id:e}){const{addSuccess:t}=Object(Mt.a)(),{from:a,to:r}=Object(i.useSelector)((t=>{const a=u.g(t.analyzer[e]);return{from:null!=a&&a.from?a.from:void 0,to:null!=a&&a.to?a.to:void 0}})),o=Qe(a),s=Qe(r),l=Object(n.useMemo)((()=>E.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:o,to:s}})),[o,s]);Object(n.useEffect)((()=>{(a||r)&&t(l)}),[t,l,a,r])}({id:a}),function({id:e}){const t=Object(i.useDispatch)(),a=e,r=Object(l.useLocation)().search,o=Object(n.useContext)(j),s=Object(i.useSelector)((t=>u.J(t.analyzer[e]))),c=Object(i.useSelector)((t=>u.i(t.analyzer[e]))),d=Object(kt.a)({locationSearch:r,resolverComponentInstanceID:a});let p;"nodes"!==d.panelView&&(p=d.panelParameters.nodeID),Object(n.useEffect)((()=>{p&&c(p)&&p!==s&&t(Object(le.userSelectedResolverNode)({id:e,nodeID:p,time:o.timestamp()}))}),[d.panelView,p,t,c,s,o,e])}({id:a});const{timestamp:g}=Object(n.useContext)(j),h=g(),{processNodePositions:v,connectingEdgeLineSegments:x}=Object(i.useSelector)((e=>u.Q(e.analyzer[a])(h))),{projectionMatrix:S,ref:O,onMouseDown:k}=function({id:e}){const t=Object(i.useDispatch)(),a=Object(n.useContext)(j),[r,o]=Object(n.useState)(null),s=Object(i.useSelector)(Object(n.useCallback)((t=>u.C(t.analyzer[e])),[e])),l=Object(n.useRef)(),[c,d]=Object(n.useState)(s(a.timestamp())),p=Object(i.useSelector)((t=>u.P(t.analyzer[e]))),m=Object(i.useSelector)((t=>u.o(t.analyzer[e]))),[b,g]=function(){const{getBoundingClientRect:e}=Object(n.useContext)(j),[t,a]=Object(n.useState)(null),{ResizeObserver:r,requestAnimationFrame:i}=Object(n.useContext)(j),[o,s]=Object(n.useState)(null),l=Object(n.useCallback)((e=>{s(e)}),[]);return Object(n.useEffect)((()=>{null!==o&&a(e(o))}),[o,e]),Object(n.useEffect)((()=>{let t=window.scrollX,n=window.scrollY;const r=()=>{i((()=>{const r=window.scrollX,i=window.scrollY;null===o||t===r&&n===i||a(e(o)),t=r,n=i}))};return window.addEventListener("scroll",r,{passive:!0}),()=>{window.removeEventListener("scroll",r)}}),[o,i,e]),Object(n.useEffect)((()=>{if(null!==o){const t=new r((t=>{null!==o&&o===t[0].target&&a(e(o))}));return t.observe(o),()=>{t.disconnect()}}}),[r,o,e]),[t,l]}(),f=Object(n.useCallback)((e=>null===b?null:[e.clientX-b.x,e.clientY-b.y]),[b]),h=Object(n.useCallback)((n=>{const r=f(n);null!==r&&t(Object(w.userStartedPanning)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),v=Object(n.useCallback)((n=>{const r=f(n);r&&t(Object(w.userMovedPointer)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),y=Object(n.useCallback)((()=>{p&&t(Object(w.userStoppedPanning)({id:e,time:a.timestamp()}))}),[t,a,p,e]),E=Object(n.useCallback)((n=>{null!==b&&n.ctrlKey&&0!==n.deltaY&&0===n.deltaMode&&(n.preventDefault(),t(Object(w.userZoomed)({id:e,zoomChange:n.deltaY/-b.height,time:a.timestamp()})))}),[b,t,a,e]),x=Object(n.useCallback)((e=>{o(e),g(e)}),[g]);return Object(n.useEffect)((()=>(window.addEventListener("mouseup",y,{passive:!0}),()=>{window.removeEventListener("mouseup",y)})),[y]),Object(n.useEffect)((()=>(window.addEventListener("mousemove",v,{passive:!0}),()=>{window.removeEventListener("mousemove",v)})),[v]),Object(n.useEffect)((()=>{if(null!==r)return r.addEventListener("wheel",E),()=>{r.removeEventListener("wheel",E)}}),[r,E]),Object(n.useLayoutEffect)((()=>{l.current=s}),[s]),Object(n.useLayoutEffect)((()=>{d(s(a.timestamp()))}),[s,a]),Object(n.useLayoutEffect)((()=>{const e=a.timestamp();if(m(e)){let e=null;const t=()=>{const n=a.timestamp();void 0!==l.current&&d(l.current(n)),e=m(n)?a.requestAnimationFrame(t):null};return e=a.requestAnimationFrame(t),()=>{null!==e&&a.cancelAnimationFrame(e)}}}),[m,a]),Object(n.useEffect)((()=>{null!==b&&t(Object(w.userSetRasterSize)({id:e,dimensions:[b.width,b.height]}))}),[t,b,e]),{ref:x,onMouseDown:h,projectionMatrix:c}}({id:a}),I=Object(n.useCallback)((e=>{O(e),"function"==typeof b?b(e):null!==b&&(b.current=e)}),[O,b]),T=Object(i.useSelector)((e=>u.s(e.analyzer[a]))),C=Object(i.useSelector)((e=>u.k(e.analyzer[a]))),M=Object(i.useSelector)((e=>u.b(e.analyzer[a]))),F=Object(i.useSelector)((e=>u.G(e.analyzer[a]))),D=f();return r.a.createElement(pe,{className:e,backgroundColor:D.resolverBackground},T?r.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},r.a.createElement(o.EuiLoadingSpinner,{size:"xl"})):C?r.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},r.a.createElement("div",null," ",r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):F?r.a.createElement(r.a.Fragment,null,r.a.createElement(be,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:k,ref:I,role:"tree",tabIndex:0,"aria-activedescendant":M||void 0},x.map((({points:[e,t],metadata:a})=>r.a.createElement(y,{edgeLineMetadata:a,key:a.reactKey,startPosition:e,endPosition:t,projectionMatrix:S}))),[...v].map((([e,t])=>{const n=fe.b(e);if(void 0===n)throw new Error("Tried to render a node without an ID");return r.a.createElement(Se,{id:a,key:n,nodeID:n,position:t,projectionMatrix:S,node:e,timeAtRender:h})}))),r.a.createElement(Ot,{id:a})):r.a.createElement(Ct,null),r.a.createElement(ie,{id:a}),r.a.createElement(Re,{id:a}))})))},623:function(e,t,a){"use strict";a.d(t,"a",(function(){return te})),a.d(t,"b",(function(){return ae}));var n=a(2),r=a.n(n),i=a(19),o=a(42),s=a(153),l=a(1781),c=a(344),u=a(748),d=a(4),p=a(122);const m=({tooltip:e,anchorPosition:t="top",children:a})=>r.a.createElement(i.EuiToolTip,{content:e,position:t},a);var b=a(298),g=a(47),f=a(7),h=a(118),v=a(11);const y=[5,10,20],E={pageIndex:0,pageSize:y[0]},x=(e,t)=>t,j={sort:{field:"@timestamp",direction:"desc"},enableAllColumns:!0},w=(e,t)=>({...e,sort:t}),S=e=>{const{setPagination:t,pagination:a,pageSizeOptions:r}=(()=>{const[e,t]=Object(n.useReducer)(x,E);return Object(n.useMemo)((()=>({pageSizeOptions:[...y],pagination:e,setPagination:t})),[e])})(),{sorting:i,sortConfig:o,setSorting:s}=(()=>{const[e,t]=Object(n.useReducer)(w,j),a=Object(n.useMemo)((()=>[{[e.sort.field]:e.sort.direction}]),[e.sort.direction,e.sort.field]);return{sorting:e,setSorting:t,sortConfig:a}})(),{data:l,totalItemCount:c,loading:u,error:d}=(({alertIds:e,from:t,size:a,sort:r})=>{const{services:{data:i}}=Object(h.j)(),o=Object(n.useMemo)((()=>{return e=i.search,async({signal:t,alertIds:a,from:n,size:r,sort:i})=>new Promise(((o,s)=>{const l=e.search({params:{body:{query:{ids:{values:a}},from:n,size:r,sort:i,fields:["*"],_source:!1}}},{abortSignal:t}).subscribe({next:e=>{Object(v.isRunningResponse)(e)||(l.unsubscribe(),o(e.rawResponse))},error:e=>{l.unsubscribe(),s(new Error("Error while loading alerts"))}})}));var e}),[i.search]),{data:s,isLoading:l,isError:c}=Object(g.useQuery)(["useFetchAlerts",e,t,a,r],(async({signal:n})=>o({signal:n,alertIds:e,from:t,size:a,sort:r})),{keepPreviousData:!0});return Object(n.useMemo)((()=>{var e,t;const a=null==s||null===(e=s.hits)||void 0===e?void 0:e.total;return{loading:l,error:c,data:(null==s||null===(t=s.hits)||void 0===t?void 0:t.hits)||[],totalItemCount:Object(f.isNumber)(a)?a:0}}),[s,c,l])})({alertIds:e,from:a.pageIndex*a.pageSize,size:a.pageSize,sort:o});return{paginationConfig:Object(n.useMemo)((()=>({...a,pageSizeOptions:r,totalItemCount:c})),[r,a,c]),setPagination:t,setSorting:s,loading:u,data:l,sorting:i,error:d}};var O=a(202),k=a(263),I=a(172),T=a(302),C=a(1295);const M=({title:e,loading:t,alertIds:a,scopeId:s,eventId:d,noItemsMessage:g,"data-test-subj":f})=>{const{setPagination:h,setSorting:v,data:y,loading:E,paginationConfig:x,sorting:j,error:w}=S(a||[]),T=!Object(p.a)("entityAlertPreviewDisabled"),M=Object(n.useCallback)((({page:e,sort:t})=>{if(e){const{index:t,size:a}=e;h({pageIndex:t,pageSize:a})}t&&v(t)}),[h,v]),P=Object(n.useMemo)((()=>y.map((e=>{var t;return{fields:null!==(t=e.fields)&&void 0!==t?t:{},id:e._id,index:e._index}})).map((e=>{const t=Object.keys(e.fields).reduce(((t,a)=>{var n,r,i;return t[a]=(null===(n=e.fields)||void 0===n||null===(r=n[a])||void 0===r?void 0:r[0])||(null===(i=e.fields)||void 0===i?void 0:i[a]),t}),{});return t.id=e.id,t.index=e.index,t}))),[y]),L=Boolean(a&&a.length&&a.length>=5),N=Object(n.useMemo)((()=>L?null:D(s,d,a)),[a,L,s,d]),R=Object(n.useMemo)((()=>L?F(a):null),[a,L]),_=Object(n.useMemo)((()=>[...T?[{render:e=>r.a.createElement(C.a,{id:e.id,indexName:e.index,"data-test-subj":`${f}AlertPreviewButton`,scopeId:s}),width:"5%"}]:[],{field:"@timestamp",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.timestampColumnLabel",defaultMessage:"Timestamp"}),truncateText:!0,dataType:"date",render:e=>{const t=Object(i.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS");return r.a.createElement(m,{tooltip:t},r.a.createElement("span",null,t))}},{field:u.r,name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ruleColumnLabel",defaultMessage:"Rule"}),truncateText:!0,render:e=>r.a.createElement(m,{tooltip:e},r.a.createElement("span",null,e))},{field:u.m,name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.reasonColumnLabel",defaultMessage:"Reason"}),truncateText:!0,render:e=>r.a.createElement(m,{tooltip:e,anchorPosition:"left"},r.a.createElement("span",null,e))},{field:"kibana.alert.severity",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.severityColumnLabel",defaultMessage:"Severity"}),truncateText:!0,render:e=>{const t=l.a.decode(e),a=Object(c.isRight)(t)?r.a.createElement(b.a,{value:t.right}):r.a.createElement("p",null,e);return r.a.createElement(m,{tooltip:e},a)}}]),[T,s,f]);return r.a.createElement(O.a,{header:{title:e,iconType:"warning",headerContent:a&&a.length&&a.length>0?r.a.createElement("div",{"data-test-subj":`${f}InvestigateInTimeline`},r.a.createElement(k.a,{dataProviders:N,filters:R,asEmptyButton:!0,iconType:"timeline"},I.i)):null},content:{error:w},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":f},r.a.createElement(i.EuiBasicTable,{"data-test-subj":`${f}Table`,loading:t||E,items:P,columns:_,pagination:x,sorting:j,onChange:M,noItemsMessage:g}))},F=e=>e&&e.length?[{meta:{alias:d.i18n.translate("xpack.securitySolution.flyout.left.insights.correlations.tableFilterLabel",{defaultMessage:"Correlations Details Table Alert IDs."}),type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null,D=(e,t,a)=>a&&a.length?a.reduce(((a,n,r)=>{const i=`${e}-${t}-event.id-${r}-${n}`;return a.push(Object(T.a)("_id",i,n)),a}),[]):null;var P=a(609);const L=({entityId:e,scopeId:t,eventId:a})=>{const{loading:n,error:i,data:l,dataCount:c}=Object(P.a)({entityId:e,scopeId:t});return i?null:r.a.createElement(M,{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by session",values:{count:c}}),loading:n,alertIds:l,scopeId:t,eventId:a,noItemsMessage:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsNoDataDescription",defaultMessage:"No alerts related by session."}),"data-test-subj":s.g})};L.displayName="RelatedAlertsBySession";var N=a(610);const R=({originalEventId:e,scopeId:t,eventId:a})=>{const{loading:n,data:i,dataCount:l}=Object(N.a)({originalEventId:e,scopeId:t});return r.a.createElement(M,{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by source event",values:{count:l}}),loading:n,alertIds:i,scopeId:t,eventId:a,noItemsMessage:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsNoDataDescription",defaultMessage:"No related source events."}),"data-test-subj":s.h})};R.displayName="RelatedAlertsBySameSourceEvent";var _=a(144),A=a(611);const z=({eventId:e})=>{const{loading:t,error:a,data:l,dataCount:c}=Object(A.a)({eventId:e}),u=Object(n.useMemo)((()=>(e=>[{field:"title",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.nameColumnLabel",defaultMessage:"Name"}),render:(t,a)=>{const n=e.findIndex((e=>e.id===a.id));return r.a.createElement(m,{tooltip:a.title},r.a.createElement(_.a,{detailName:a.id,title:a.title,index:n},a.title))}},{field:"status",name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.statusColumnLabel",defaultMessage:"Status"}),truncateText:!0,width:"25%"}])(l)),[l]);return a?null:r.a.createElement(O.a,{header:{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesTitle",defaultMessage:"{count} related {count, plural, one {case} other {cases}}",values:{count:c}}),iconType:"warning"},content:{error:a},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":s.j},r.a.createElement(i.EuiInMemoryTable,{loading:t,items:l,columns:u,pagination:!0,message:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesNoDataDescription",defaultMessage:"No related cases."}),"data-test-subj":s.i}))};z.displayName="RelatedCases";var B=a(612),V=a(613),$=a(614),q=a(125),G=a(615),U=a(616),H=a(617);const W=({documentId:e,indices:t,scopeId:a})=>{const{loading:n,error:i,data:l,dataCount:c}=Object(H.a)({documentId:e,indices:t,scopeId:a});return i?null:r.a.createElement(M,{title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by ancestry",values:{count:c}}),loading:n,alertIds:l,scopeId:a,eventId:e,noItemsMessage:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsNoDataDescription",defaultMessage:"No alerts related by ancestry."}),"data-test-subj":s.f})};W.displayName="RelatedAlertsByAncestry";var Q=a(813),K=a(253),J=a(730),Y=a(165);const Z=({dataAsNestedObject:e,alertSuppressionCount:t,isPreview:a})=>{var n;const l=null===(n=Object(f.get)(e,Q.o))||void 0===n?void 0:n[0],c=r.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.suppressedAlertsTitle",defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:t}})),Object(Y.l)(l)?null:r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiBetaBadge,{label:K.w,style:{verticalAlign:"middle"},size:"s","data-test-subj":s.M}))),u=t>0&&!a&&r.a.createElement("div",{"data-test-subj":`${s.k}InvestigateInTimeline`},r.a.createElement(J.a,{ecsRowData:e,buttonType:"emptyButton"}));return r.a.createElement(O.a,{header:{title:c,iconType:"layers",headerContent:u},"data-test-subj":s.k})};Z.displayName="SuppressedAlerts";var X=a(277),ee=a(131);const te="correlations",ae=()=>{const{dataAsNestedObject:e,eventId:t,getFieldsData:a,scopeId:n,isPreview:l}=Object(q.b)(),{selectedPatterns:c}=Object(X.a)(Object(ee.isActiveTimeline)(n)),{show:u,documentId:d}=Object(V.a)({getFieldsData:a,dataAsNestedObject:e,eventId:t,isPreview:l}),{show:p,originalEventId:m}=Object(G.a)({eventId:t,getFieldsData:a}),{show:b,entityId:g}=Object(U.a)({getFieldsData:a}),f=Object(B.a)({getFieldsData:a}),{show:h,alertSuppressionCount:v}=Object($.a)({getFieldsData:a}),y=u||p||b||f||h;return r.a.createElement(i.EuiPanel,{paddingSize:"none","data-test-subj":s.l,color:"transparent"},y?r.a.createElement(i.EuiFlexGroup,{gutterSize:"l",direction:"column"},h&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(Z,{alertSuppressionCount:v,dataAsNestedObject:e,isPreview:l})),f&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(z,{eventId:t})),p&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(R,{originalEventId:m,scopeId:n,eventId:t})),b&&g&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(L,{entityId:g,scopeId:n,eventId:t})),u&&r.a.createElement(i.EuiFlexItem,null,r.a.createElement(W,{indices:c,scopeId:n,documentId:d}))):r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};ae.displayName="CorrelationsDetails"},628:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(2),r=a(607),i=a(608),o=a(53),s=a(47),l=a(118),c=a(277),u=a(131),d=a(127);const p="fieldNames",m="eventKind",b="hostName",g="userName",f="hosts",h="users",v=(e,t,a,n)=>{const r=Object(o.buildEsQuery)(void 0,[],[{query:{bool:{filter:[{range:{"@timestamp":{gte:t,lte:a}}}]}},meta:{}}]);return y(r,e,n)},y=(e,t,a)=>({params:{index:a,body:{query:e,aggs:{[p]:{filters:{filters:t},aggs:{[b]:{cardinality:{field:"host.name"}},[g]:{cardinality:{field:"user.name"}},[m]:{terms:{field:"event.kind",size:10}}}},[f]:{cardinality:{field:"host.name"}},[h]:{cardinality:{field:"user.name"}}},size:0}}});var E=a(192);const x=({interval:e,dataFormattedForFieldBrowser:t,investigationFields:a})=>{const o=Object(r.a)({dataFormattedForFieldBrowser:t,investigationFields:a}),y=Object(n.useMemo)((()=>Object(i.a)(o)),[o]),{data:x,loading:j,error:w}=(({highlightedFieldsFilters:e,interval:{from:t,to:a}})=>{const{services:{data:{search:n}}}=Object(l.j)(),{selectedPatterns:r}=Object(c.a)(Object(u.isActiveTimeline)(d.SourcererScopeName.default)),i=v(e,t,a,r),{data:o,isLoading:p,isError:m}=Object(s.useQuery)(["useFetchFieldValuePairWithAggregation",e,t,a],(()=>(async(e,t)=>{let a;return new Promise(((n,r)=>{e.search(t).subscribe({next:e=>{a=e.rawResponse},complete:()=>{n(a)},error:e=>{r(e)}})}))})(n,i)));return{loading:p,error:m,data:o}})({highlightedFieldsFilters:y,interval:e}),S=[];if(x&&x.aggregations){const e=x.aggregations[f].value,t=x.aggregations[h].value;Object.keys(x.aggregations[p].buckets).forEach((a=>{var n;const r=o[a].values,i=(null===(n=x.aggregations[p].buckets[a][m].buckets.find((e=>e.key===E.a.signal)))||void 0===n?void 0:n.doc_count)||0;let s=0;x.aggregations[p].buckets[a][m].buckets.reduce(((e,t)=>(t.key!==E.a.signal&&(s+=t.doc_count),e)),s);const l=x.aggregations[p].buckets[a][b].value,c=x.aggregations[p].buckets[a][g].value,u=e?l/e:0,d=t?c/t:0;S.push({field:a,values:r,alertCount:i,docCount:s,hostPrevalence:u,userPrevalence:d})}))}return{loading:j,error:w,data:S}}},631:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),r=a.n(n),i=a(19),o=a(4),s=a(436),l=a(5),c=a(118);const u=`${a(211).a}Tour`,d=o.i18n.translate("xpack.securitySolution.flyout.tour.subtitle",{defaultMessage:"A redesigned alert experience"}),p=({tourStepContent:e,totalSteps:t,goToOverviewTab:a,goToLeftPanel:p})=>{const{services:{storage:m}}=Object(c.j)(),[b,g]=Object(n.useState)((()=>{const e=m.get(l.cc.FLYOUT);return null!=e?e:s.c}));Object(n.useEffect)((()=>{m.set(l.cc.FLYOUT,b),b.isTourActive&&1===b.currentTourStep&&a&&a()}),[m,b,a]);const f=Object(n.useCallback)((()=>{g((e=>(3===e.currentTourStep&&p&&p(),{...e,currentTourStep:e.currentTourStep+1})))}),[p]),h=Object(n.useCallback)((()=>{g((e=>({...e,isTourActive:!1})))}),[]),v=Object(n.useCallback)((e=>e===t?r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:h},o.i18n.translate("xpack.securitySolution.flyout.tour.finish.text",{defaultMessage:"Finish"})):[r.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:h},o.i18n.translate("xpack.securitySolution.flyout.tour.exit.text",{defaultMessage:"Exit"})),r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:f},o.i18n.translate("xpack.securitySolution.flyout.tour.Next.text",{defaultMessage:"Next"}))]),[h,f,t]);return b.isTourActive?r.a.createElement(r.a.Fragment,null,e.map((e=>{const a=e.stepNumber;if(b.currentTourStep!==a)return null;const n={"data-test-subj":`${u}-${a}`};return r.a.createElement(i.EuiTourStep,{panelProps:n,key:a,step:a,isStepOpen:b.isTourActive,maxWidth:500,stepsTotal:t,onFinish:h,title:e.title,content:e.content,anchor:`[data-test-subj=${e.anchor}]`,anchorPosition:e.anchorPosition,footerAction:v(a),subtitle:d})}))):null};p.displayName="FlyoutTour"},633:function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j}));var n=a(2),r=a.n(n),i=a(19),o=a(847),s=a.n(o),l=a(728),c=a(741),u=a(175),d=a(336),p=a(5),m=a(127),b=a(441),g=a(1209),f=a(132),h=a(246),v=a(125),y=a(153),E=a(339);const x="threatIntelligence",j=()=>{const{enrichments:e,eventFields:t,isEnrichmentsLoading:a,isEventDataLoading:o,isLoading:x,range:j,setRange:w}=(()=>{const{indexName:e,eventId:t}=Object(v.b)(),[{pageName:a}]=Object(h.a)(),r=a===p.Oc.detections?m.SourcererScopeName.detections:m.SourcererScopeName.default,i=Object(f.a)(r),[o,s]=Object(g.a)({indexName:e,eventId:t,runtimeMappings:i.runtimeMappings,skip:!t}),{isAlert:l}=Object(u.b)(s),c=Object(n.useMemo)((()=>s||[]),[s]),y=Object(n.useMemo)((()=>Object(d.c)(c||[])),[c]),{result:E,loading:x,setRange:j,range:w}=Object(b.c)(y),S=Object(n.useMemo)((()=>l?Object(d.g)(c).map((e=>Object(d.h)(e))):[]),[c,l]);return{enrichments:Object(n.useMemo)((()=>x||null==E||!E.enrichments?S:Object(d.b)([...S,...E.enrichments])),[x,E,S]),eventFields:y,isEnrichmentsLoading:x,isEventDataLoading:o,isLoading:x||o,range:w,setRange:j}})();return o?r.a.createElement(E.a,{"data-test-subj":y.N}):r.a.createElement(c.a,{before:null,loading:x,enrichments:e,showInvestigationTimeEnrichments:!s()(t)},r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{setRange:w,loading:a,range:j}),r.a.createElement(i.EuiSpacer,{size:"m"})))};j.displayName="ThreatIntelligenceDetails"},669:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(45),o=a(621),s=a(217);const l=r.a.memo((e=>{const t=Object(i.useSelector)((t=>t.analyzer[e.resolverComponentInstanceID])),a=Object(i.useDispatch)();return t||a(Object(s.createResolver)({id:e.resolverComponentInstanceID})),Object(n.useEffect)((()=>{e.shouldUpdate&&a(Object(s.createResolver)({id:e.resolverComponentInstanceID}))}),[a,e.shouldUpdate,e.resolverComponentInstanceID]),r.a.createElement(o.a,e)}))},670:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a.n(n);class InvariantError extends Error{constructor(...e){super(...e),r()(this,"name","InvariantError")}}function i(e,t){if(!e)throw new InvariantError(t)}},671:function(e,t,a){const n=a(190);e.exports=(e,t,a)=>0===n(e,t,a)},672:function(e,t,a){const n=a(190);e.exports=(e,t,a)=>0!==n(e,t,a)},673:function(e,t,a){const n=a(671),r=a(672),i=a(385),o=a(421),s=a(491),l=a(492);e.exports=(e,t,a,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e===a;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e!==a;case"":case"=":case"==":return n(e,a,c);case"!=":return r(e,a,c);case">":return i(e,a,c);case">=":return o(e,a,c);case"<":return s(e,a,c);case"<=":return l(e,a,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},675:function(e,t,a){"use strict";const n=a(2),r=a(1130),i=a(476),o=a(1131),s=a(1178),l=a(1179),c=a(1180),u=a(1181),d=a(1183),p=a(1184).hastChildrenToReact;e.exports=f;const m={}.hasOwnProperty,b="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",g={renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function f(e){for(const t in g)if(m.call(g,t)&&m.call(e,t)){const e=g[t];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${t}\` (see <${b}#${e.id}> for more info)`),delete g[t]}const t=i().use(o).use(e.remarkPlugins||e.plugins||[]).use(s,{allowDangerousHtml:!0}).use(e.rehypePlugins||[]).use(u,e);let a;"string"==typeof e.children?a=r(e.children):(void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`),a=r());const l=t.runSync(t.parse(a),a);if("root"!==l.type)throw new TypeError("Expected a `root` node");let d=n.createElement(n.Fragment,{},p({options:e,schema:c,listDepth:0},l));return e.className&&(d=n.createElement("div",{className:e.className},d)),d}f.defaultProps={transformLinkUri:d},f.propTypes={children:l.string,className:l.string,allowElement:l.func,allowedElements:l.arrayOf(l.string),disallowedElements:l.arrayOf(l.string),unwrapDisallowed:l.bool,remarkPlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),rehypePlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),sourcePos:l.bool,rawSourcePos:l.bool,skipHtml:l.bool,includeElementIndex:l.bool,transformLinkUri:l.oneOfType([l.func,l.bool]),linkTarget:l.oneOfType([l.func,l.string]),transformImageUri:l.func,components:l.object},f.uriTransformer=d},676:function(e,t,a){"use strict";var n={}.hasOwnProperty;e.exports=n},677:function(e,t,a){"use strict";e.exports=function(e){for(var t=-1,a=0;++t<e.length;)a+="string"==typeof e[t]?e[t].length:1;return a}},678:function(e,t,a){"use strict";var n=a(335),r=a(238),i=a(286);function o(e,t){for(var a,n,i,o,s,l,c=e[t][1],u=e[t][2],d=t-1,p=[],m=c._tokenizer||u.parser[c.contentType](c.start),b=m.events,g=[],f={};c;){for(;e[++d][1]!==c;);p.push(d),c._tokenizer||(a=u.sliceStream(c),c.next||a.push(null),n&&m.defineSkip(c.start),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=!0),m.write(a),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=void 0)),n=c,c=c.next}for(c=n,i=b.length;i--;)"enter"===b[i][0]?o=!0:o&&b[i][1].type===b[i-1][1].type&&b[i][1].start.line!==b[i][1].end.line&&(h(b.slice(i+1,s)),c._tokenizer=c.next=void 0,c=c.previous,s=i+1);for(m.events=c._tokenizer=c.next=void 0,h(b.slice(0,s)),i=-1,l=0;++i<g.length;)f[l+g[i][0]]=l+g[i][1],l+=g[i][1]-g[i][0]-1;return f;function h(t){var a=p.pop();g.unshift([a,a+t.length-1]),r(e,a,2,t)}}e.exports=function(e){for(var t,a,s,l,c,u,d,p={},m=-1;++m<e.length;){for(;m in p;)m=p[m];if(t=e[m],m&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[m-1][1].type&&((s=0)<(u=t[1]._tokenizer.events).length&&"lineEndingBlank"===u[s][1].type&&(s+=2),s<u.length&&"content"===u[s][1].type))for(;++s<u.length&&"content"!==u[s][1].type;)"chunkText"===u[s][1].type&&(u[s][1].isInFirstContentOfListItem=!0,s++);if("enter"===t[0])t[1].contentType&&(n(p,o(e,m)),m=p[m],d=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(s=m,a=void 0;s--&&("lineEnding"===(l=e[s])[1].type||"lineEndingBlank"===l[1].type);)"enter"===l[0]&&(a&&(e[a][1].type="lineEndingBlank"),l[1].type="lineEnding",a=s);a&&(t[1].end=i(e[a][1].start),(c=e.slice(a,m)).unshift(t),r(e,a,m-a+1,c))}}return!d}},679:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(335),r=a(286),i=l("text"),o=l("string"),s={resolveAll:c()};function l(e){return{tokenize:function(t){var a=this,n=this.parser.constructs[e],r=t.attempt(n,i,o);return i;function i(e){return l(e)?r(e):o(e)}function o(e){if(null!==e)return t.enter("data"),t.consume(e),s;t.consume(e)}function s(e){return l(e)?(t.exit("data"),r(e)):(t.consume(e),s)}function l(e){var t=n[e],r=-1;if(null===e)return!0;if(t)for(;++r<t.length;)if(!t[r].previous||t[r].previous.call(a,a.previous))return!0}},resolveAll:c("text"===e?u:void 0)}}function c(e){return function(t,a){for(var n,r=-1;++r<=t.length;)void 0===n?t[r]&&"data"===t[r][1].type&&(n=r,r++):t[r]&&"data"===t[r][1].type||(r!==n+2&&(t[n][1].end=t[r-1][1].end,t.splice(n+2,r-n-2),r=n+2),n=void 0);return e?e(t,a):t}}function u(e,t){for(var a,i,o,s,l,c,u,d,p=-1;++p<=e.length;)if((p===e.length||"lineEnding"===e[p][1].type)&&"data"===e[p-1][1].type){for(i=e[p-1][1],s=(a=t.sliceStream(i)).length,l=-1,c=0,u=void 0;s--;)if("string"==typeof(o=a[s])){for(l=o.length;32===o.charCodeAt(l-1);)c++,l--;if(l)break;l=-1}else if(-2===o)u=!0,c++;else if(-1!==o){s++;break}c&&(d={type:p===e.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{line:i.end.line,column:i.end.column-c,offset:i.end.offset-c,_index:i.start._index+s,_bufferIndex:s?l:i.start._bufferIndex+l},end:r(i.end)},i.end=r(d.start),i.start.offset===i.end.offset?n(i,d):(e.splice(p,0,["enter",d,t],["exit",d,t]),p+=2)),p++}return e}t.resolver=s,t.string=o,t.text=i},680:function(e,t,a){"use strict";e.exports=function(e){return e<32||127===e}},681:function(e,t,a){e.exports=a(35)(3560)},682:function(e,t,a){"use strict";var n=a(240)(/\d/);e.exports=n},683:function(e,t,a){"use strict";var n=a(680),r=a(239),i=a(155);e.exports=function(e,t,a,o,s,l,c,u,d){var p=d||1/0,m=0;return function(t){return 60===t?(e.enter(o),e.enter(s),e.enter(l),e.consume(t),e.exit(l),b):n(t)||41===t?a(t):(e.enter(o),e.enter(c),e.enter(u),e.enter("chunkString",{contentType:"string"}),h(t))};function b(a){return 62===a?(e.enter(l),e.consume(a),e.exit(l),e.exit(s),e.exit(o),t):(e.enter(u),e.enter("chunkString",{contentType:"string"}),g(a))}function g(t){return 62===t?(e.exit("chunkString"),e.exit(u),b(t)):null===t||60===t||i(t)?a(t):(e.consume(t),92===t?f:g)}function f(t){return 60===t||62===t||92===t?(e.consume(t),g):g(t)}function h(i){return 40===i?++m>p?a(i):(e.consume(i),h):41===i?m--?(e.consume(i),h):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(o),t(i)):null===i||r(i)?m?a(i):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(o),t(i)):n(i)?a(i):(e.consume(i),92===i?v:h)}function v(t){return 40===t||41===t||92===t?(e.consume(t),h):h(t)}}},684:function(e,t,a){"use strict";var n=a(155),r=a(220);e.exports=function(e,t,a,i,o,s){var l,c=this,u=0;return function(t){return e.enter(i),e.enter(o),e.consume(t),e.exit(o),e.enter(s),d};function d(r){return null===r||91===r||93===r&&!l||94===r&&!u&&"_hiddenFootnoteSupport"in c.parser.constructs||u>999?a(r):93===r?(e.exit(s),e.enter(o),e.consume(r),e.exit(o),e.exit(i),t):n(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(r))}function p(t){return null===t||91===t||93===t||n(t)||u++>999?(e.exit("chunkString"),d(t)):(e.consume(t),l=l||!r(t),92===t?m:p)}function m(t){return 91===t||92===t||93===t?(e.consume(t),u++,p):p(t)}}},685:function(e,t,a){"use strict";var n=a(155),r=a(220),i=a(160);e.exports=function(e,t){var a;return function o(s){return n(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),a=!0,o):r(s)?i(e,o,a?"linePrefix":"lineSuffix")(s):t(s)}}},686:function(e,t,a){"use strict";var n=a(155),r=a(160);e.exports=function(e,t,a,i,o,s){var l;return function(t){return e.enter(i),e.enter(o),e.consume(t),e.exit(o),l=40===t?41:t,c};function c(a){return a===l?(e.enter(o),e.consume(a),e.exit(o),e.exit(i),t):(e.enter(s),u(a))}function u(t){return t===l?(e.exit(s),c(l)):null===t?a(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===l||null===t||n(t)?(e.exit("chunkString"),u(t)):(e.consume(t),92===t?p:d)}function p(t){return t===l||92===t?(e.consume(t),d):d(t)}}},687:function(e,t,a){"use strict";var n=a(155),r=a(220),i=a(160),o={name:"thematicBreak",tokenize:function(e,t,a){var o,s=0;return function(t){return e.enter("thematicBreak"),o=t,l(t)};function l(u){return u===o?(e.enter("thematicBreakSequence"),c(u)):r(u)?i(e,l,"whitespace")(u):s<3||null!==u&&!n(u)?a(u):(e.exit("thematicBreak"),t(u))}function c(t){return t===o?(e.consume(t),s++,c):(e.exit("thematicBreakSequence"),l(t))}}};e.exports=o},688:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return l}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.display",{defaultMessage:"Per rule run"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.display",{defaultMessage:"Custom frequency"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.body.summary.message",{defaultMessage:"Rule {ruleName} generated {signalsCount} alerts",values:{ruleName:"{{context.rule.name}}",signalsCount:"{{state.signals_count}}"}}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.body.forEachAlert.message",{defaultMessage:"Rule {ruleName} generated alert {alertId}",values:{ruleName:"{{context.rule.name}}",alertId:"{{alert.id}}"}})},689:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(19);const l=o()(s.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1oris7-0"})([".euiBadge__text{white-space:pre-wrap !important;}"]),c=({badges:e,"data-test-subj":t})=>r.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0,"data-test-subj":t},e.map((e=>r.a.createElement(s.EuiFlexItem,{grow:!1,key:`badge-${e}`,"data-test-subj":`${t}Item`},r.a.createElement(l,{color:"hollow"},e)))))},690:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(19),l=a(85),c=a(118);const u=o()(s.EuiLink).withConfig({displayName:"StyledJobEuiLInk",componentId:"sc-4k6t5u-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),d=({jobId:e,jobName:t})=>{const{services:{http:a,ml:n}}=Object(c.j)(),i=Object(l.useMlHref)(n,a.basePath.get(),{page:l.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[e]}},[e]);return r.a.createElement(u,{"data-test-subj":"machineLearningJobLink",href:i,target:"_blank"},r.a.createElement("span",{"data-test-subj":"machineLearningJob"},null!=t?t:e))},p=Object(n.memo)(d)},692:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));let n=function(e){return e.Single="single",e.Static="static",e.Resizable="resizable",e}({}),r=function(e){return e.Horizontal="horizontal",e.Vertical="vertical",e}({})},700:function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return E}));var n=a(2),r=a.n(n),i=a(4);const o=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewHostSummary",{defaultMessage:"View host summary"}),s=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewUserSummary",{defaultMessage:"View user summary"}),l=i.i18n.translate("xpack.securitySolution.expandedValue.links.expandIpDetails",{defaultMessage:"Expand ip details"}),c=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleDetails",{defaultMessage:"View rule details"}),u=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewPortDetails",{defaultMessage:"View port details"}),d=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleReference",{defaultMessage:"View rule reference"}),p=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewEventReference",{defaultMessage:"View event reference"}),m=i.i18n.translate("xpack.securitySolution.expandedValue.links.viewIndicatorReference",{defaultMessage:"View indicator reference"});var b=a(229),g=a(195),f=a(406),h=a(382);a(118);const v=[{columnId:b.g,label:o},{columnId:"source.ip",fieldType:f.b,label:l},{columnId:"destination.ip",fieldType:f.b,label:l},{columnId:"signal.rule.name",label:c,linkField:"signal.rule.id"},...h.b.map((e=>({columnId:e,label:u}))),{columnId:b.m,label:d},{columnId:b.l,label:d},{columnId:b.e,label:p},{columnId:g.j,label:m},{columnId:b.p,label:s}],y=(e,t,a)=>v.find((n=>n.columnId===e||!(!n.fieldType||t!==n.fieldType||void 0===a&&void 0===n.linkField))),E=()=>r.a.createElement(r.a.Fragment,null)},737:function(e,t,a){"use strict";a.d(t,"g",(function(){return s})),a.d(t,"i",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return b})),a.d(t,"j",(function(){return g})),a.d(t,"b",(function(){return f}));var n=a(50),r=a(4),i=a(1342),o=a(2137);const s=(e,t,a)=>a.reduce(((a,r,i)=>{const o=((e,t,a,r,i=n.v4)=>{var o;const{fields:s}=e,{fields:l}=t,c=a.field,u=a.value,[d]=s.filter((({name:e})=>null!=c&&c===e)),[p]=l.filter((({name:e})=>null!=u&&u===e));return{id:null!==(o=a.id)&&void 0!==o?o:i(),field:d,type:"mapping",value:p,entryIndex:r}})(e,t,r,i);return[...a,o]}),[]),l=(e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}),c=(e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:a}},u=(e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:a}},d=()=>Object(i.a)({field:"",type:"mapping",value:""}),p=()=>Object(i.a)({entries:[Object(i.a)({field:"",type:"mapping",value:""})]}),m=e=>e.reduce(((e,t)=>{const a={...t,entries:t.entries};return o.c.is(a)?[...e,a]:e}),[]),b=e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))),g=e=>1===e.length&&1===e[0].entries.length&&""===e[0].entries[0].field&&""===e[0].entries[0].value,f={forbiddenField:(e,t)=>{let a;if(a="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),a)return{code:"ERR_FIELD_FORMAT",message:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}}}},744:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(504),l=a(304);var c=a(700);const u=o.a.div.withConfig({displayName:"StyledContent",componentId:"sc-18lfxbd-0"})(["padding:",";width:100%;margin:0 auto;"],(({$isDetails:e})=>e?"0 8px":void 0)),d=({data:e,ecsData:t,eventId:a,header:i,isDetails:o,isDraggable:d,isTimeline:p,linkValues:m,rowRenderers:b,scopeId:g,truncate:f,asPlainText:h,context:v})=>{const y=Object(n.useMemo)((()=>void 0!==Object(c.b)(i.id,i.type,i.linkField)&&!p),[i.id,i.linkField,i.type,p]),E=Object(s.c)({data:e,fieldName:i.id}),x=o?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return r.a.createElement(u,{className:x,$isDetails:o},((e,t,a,n)=>{const r=t.find((t=>t.isInstance(e,a,n)));return null!=r?r:(()=>{throw new Error("Unhandled Column Renderer")})()})(i.id,l.a,e,v).renderColumn({asPlainText:null!=h?h:y,columnName:i.id,ecsData:t,eventId:a,field:i,isDetails:o,isDraggable:d,linkValues:m,rowRenderers:b,scopeId:g,truncate:f,values:E,context:v}))}},745:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(44),r=a(2),i=a(123),o=a(118),s=a(17),l=a(1249),c=a(4);const u=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),d=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),p=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),m=()=>{const{telemetry:e}=Object(o.j)().services,{addError:t}=Object(i.a)(),[a,n]=Object(r.useState)(!1);return{enableDatafeed:Object(r.useCallback)((async(a,r)=>{if(n(!0),Object(s.h)(s.a.COUNT,a.isElasticJob?s.c.SIEM_JOB_ENABLED:s.c.CUSTOM_JOB_ENABLED),!a.isInstalled)try{await Object(l.c)({configTemplate:a.moduleId,indexPatternName:a.defaultIndexPattern,jobIdErrorFilter:[a.id],groups:a.groups}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,moduleId:a.moduleId,status:s.b.moduleInstalled})}catch(r){return n(!1),t(r,{title:p}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,moduleId:a.moduleId,status:s.b.installationError,errorMessage:`${p} - ${r.message}`}),{enabled:!1}}const i=new Date,o=i.setDate(i.getDate()-14),c=`datafeed-${a.id}`,d=Math.max(r,o);try{var m;const t=await Object(l.d)({datafeedIds:[c],start:d});if(null!==(m=t[c])&&void 0!==m&&m.error)throw new Error(t[c].error);return e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:s.b.started}),{enabled:!!t[c]&&t[c].started}}catch(n){Object(s.h)(s.a.COUNT,s.c.JOB_ENABLE_FAILURE),t(n,{title:u}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:s.b.startError,errorMessage:`${u} - ${n.message}`})}finally{n(!1)}return{enabled:!1}}),[t,e]),disableDatafeed:Object(r.useCallback)((async a=>{Object(s.h)(s.a.COUNT,a.isElasticJob?s.c.SIEM_JOB_DISABLED:s.c.CUSTOM_JOB_DISABLED),n(!0);const r=`datafeed-${a.id}`;try{const[t]=await Object(l.e)({datafeedIds:[r]});if(b(t))throw new Error(t.error);return e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:s.b.stopped}),{enabled:!t[r]||!t[r].stopped}}catch(n){Object(s.h)(s.a.COUNT,s.c.JOB_DISABLE_FAILURE),t(n,{title:d}),e.reportMLJobUpdate({jobId:a.id,isElasticJob:a.isElasticJob,status:s.b.stopError,errorMessage:`${d} - ${n.message}`})}finally{n(!1)}return{enabled:!0}}),[t,e]),isLoading:a}},b=e=>!Object(n.isEmpty)(e.error)},759:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),i=(n.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>n.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),o=n.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"});n.i18n.translate("xpack.securitySolution.eventsViewer.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"})},786:function(e,t,a){e.exports=a(35)(1196)},787:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a.n(n),i=a(41);const o=a.n(i).a.div.withConfig({displayName:"StyledDiv",componentId:"sc-ydtkdd-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));o.defaultProps={addPadding:!1};const s=r.a.memo(o);s.displayName="StepContentWrapper"},789:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return f}));var n=a(7),r=a(165),i=a(118),o=a(248),s=a(3),l=a(55);const c=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,u=e=>Object(n.has)(e,"error.type"),d=e=>e.error.root_cause.filter((e=>c(e.type))).map((e=>e.reason));var p=a(545);let m=function(e){return e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL",e}({});const b=(e,t)=>{let a,n=[];return(...r)=>(a&&clearTimeout(a),a=setTimeout((()=>{const t=e(...r);n.forEach((e=>e(t))),n=[]}),t),new Promise((e=>n.push(e))))},g=async(...e)=>{const[{value:t,formData:a}]=e,{query:b}=t,g=b.query,{dataViewId:f,index:h,ruleType:v,eqlOptions:y}=a;if(void 0===v&&!Object(n.isEmpty)(g)||Object(r.b)(v)&&!Object(n.isEmpty)(g))try{const{data:e}=i.b.get();let t=null==h?void 0:h.join(),r={};if(null!=f&&""!==f&&a.dataSourceType===o.a.DataView){const a=await e.dataViews.get(f);t=a.title,r=a.getRuntimeMappings()}const p=(new AbortController).signal,b=await(async({data:e,dataViewTitle:t,query:a,signal:r,runtimeMappings:i,options:o})=>{const{rawResponse:p}=await Object(s.firstValueFrom)(e.search.search({params:{index:t,body:{query:a,runtime_mappings:i,size:0},timestamp_field:null==o?void 0:o.timestampField,tiebreaker_field:(null==o?void 0:o.tiebreakerField)||void 0,event_category_field:null==o?void 0:o.eventCategoryField},options:{ignore:[400]}},{strategy:l.EQL_SEARCH_STRATEGY,abortSignal:r}));if((e=>u(e)&&c(Object(n.get)(e,"error.type")))(p))return{valid:!1,errors:d(p)};if(u(p))throw new Error(JSON.stringify(p));return{valid:!0,errors:[]}})({data:e,query:g,signal:p,dataViewTitle:t,runtimeMappings:r,options:y});if(!1===(null==b?void 0:b.valid))return{code:m.INVALID_EQL,message:"",messages:b.errors}}catch(e){return{code:m.FAILED_REQUEST,message:p.m,error:e}}},f=e=>{const t=e.errors.length>0,a=!e.isChangingValue&&!t;if(t){const[t]=e.errors,n=t.message;return t.code===m.INVALID_EQL?{isValid:a,message:n,messages:t.messages}:{isValid:a,message:n,error:t.error}}return{isValid:a,message:""}}},804:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(41),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(223);const c=r()(s.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-g8lc0e-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);c.displayName="StaticSwitch";const u=({job:e,isSecurityJobsLoading:t,onJobStateChange:a})=>{const[n,r]=Object(i.useState)(!1),u=Object(i.useCallback)((async t=>{r(!0),await a(e,e.latestTimestampMs||0,t.target.checked),r(!1)}),[e,r,a]);return o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceAround"},o.a.createElement(s.EuiFlexItem,{grow:!1},t||n||Object(l.b)(e.jobState,e.datafeedState)?o.a.createElement(s.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):o.a.createElement(c,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:u,showLabel:!1,label:""})))};u.displayName="JobSwitchComponent";const d=o.a.memo(u);d.displayName="JobSwitch"},847:function(e,t,a){var n=a(1274),r=a(1272),i=a(1273),o=a(749),s=a(786),l=a(848),c=a(849),u=a(850),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(o(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||i(e)))return!e.length;var t=r(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!n(e).length;for(var a in e)if(d.call(e,a))return!1;return!0}},848:function(e,t,a){e.exports=a(35)(1192)},849:function(e,t,a){e.exports=a(35)(1195)},850:function(e,t,a){e.exports=a(35)(1610)},851:function(e,t,a){e.exports=a(35)(173)},852:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(7),r=a(4),i=a(19),o=a(2),s=a.n(o),l=a(53),c=a(737),u=a(165),d=a(5),p=a(223),m=a(157),b=a(248),g=a(789),f=a(963),h=a(524),v=a(854);const y={index:{defaultValue:[],fieldsToValidateOnChange:["index","queryBar"],type:m.a.COMBO_BOX,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:s.a.createElement(i.EuiText,{size:"xs"},h.q),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(p.d)(t.ruleType)&&!Object(u.d)(t.ruleType)&&t.dataSourceType===b.a.IndexPatterns)return m.j.emptyField(r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},dataViewId:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewSelector",{defaultMessage:"Data view"}),fieldsToValidateOnChange:["dataViewId"],validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e,n=null!=a.dataViewId&&""!==a.dataViewId;if(!Object(p.d)(a.ruleType)&&!n&&a.dataSourceType===b.a.DataView)return{path:t,message:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.dataViewSelectorFieldRequired",{defaultMessage:"Please select an available Data View or Index Pattern."})}}}]},dataViewTitle:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewTitleSelector",{defaultMessage:"Data view index pattern"}),validations:[]},eqlOptions:{fieldsToValidateOnChange:["eqlOptions","queryBar"]},queryBar:{fieldsToValidateOnChange:["queryBar","groupByFields"],validations:[{validator:(...e)=>{const[{value:t,path:a,formData:r}]=e,{query:i,filters:o,saved_id:s}=t;if(!Object(p.d)(r.ruleType)&&Object(n.isEmpty)(i.query)&&Object(n.isEmpty)(o)&&!s)return{code:"ERR_FIELD_MISSING",path:a,message:Object(v.a)(r.ruleType)}}},{validator:(...e)=>{const[{value:t,path:a,formData:r}]=e,{query:i}=t;if(!Object(p.d)(r.ruleType)&&!Object(n.isEmpty)(i.query)&&"kuery"===i.language)try{Object(l.fromKueryExpression)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:h.r}}}},{validator:Object(g.a)(g.b,300)},{validator:Object(g.a)(f.a,300)}]},ruleType:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(p.d)(t.ruleType))return m.j.emptyField(r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{type:m.a.JSON,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"})},requiredFields:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:m.a.COMBO_BOX,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return m.j.maxLengthField({length:3,message:r.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:m.a.NUMBER,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return m.j.numberGreaterThanField({than:1,message:r.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.COMBO_BOX,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return Object(n.isEmpty)(t["threshold.cardinality.field"])&&!Object(n.isEmpty)(t["threshold.cardinality.value"])?m.j.emptyField(r.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.NUMBER,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return Object(n.isEmpty)(t["threshold.cardinality.field"])?void 0:m.j.numberGreaterThanField({than:1,message:r.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:m.a.COMBO_BOX,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:s.a.createElement(i.EuiText,{size:"xs"},h.z),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.m)(t.ruleType))return m.j.emptyField(r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:a}]=e;if(Object(u.m)(t.ruleType))return c.b.forbiddenField(a,"*")}}]},threatMapping:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e;if(Object(u.m)(a.ruleType))return Object(c.j)(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:h.A}:Object(c.a)(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:h.y}:void 0}}]},threatQueryBar:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:a,formData:r}]=e;if(!Object(u.m)(r.ruleType))return;const{query:i,filters:o}=t;return Object(n.isEmpty)(i.query)&&Object(n.isEmpty)(o)?{code:"ERR_FIELD_MISSING",path:a,message:h.f}:void 0}},{validator:(...e)=>{const[{value:t,path:a,formData:r}]=e;if(!Object(u.m)(r.ruleType))return;const{query:i}=t;if(!Object(n.isEmpty)(i.query)&&"kuery"===i.language)try{Object(l.fromKueryExpression)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:h.r}}}}]},newTermsFields:{type:m.a.COMBO_BOX,label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsLabel",{defaultMessage:"Fields"}),helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNewTermsFieldHelpText",{defaultMessage:"Select a field to check for new terms."}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.f)(t.ruleType))return m.j.emptyField(r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsMin",{defaultMessage:"A minimum of one field is required."}))(...e)}},{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.f)(t.ruleType))return m.j.maxLengthField({length:d.Yb,message:r.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.newTermsFieldsMax",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},historyWindowSize:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.historyWindowSizeLabel",{defaultMessage:"History Window Size"}),helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.historyWindowSizeHelpText",{defaultMessage:"New terms rules only alert if terms don't appear in historical data."})},groupByFields:{type:m.a.COMBO_BOX,helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByFieldHelpText",{defaultMessage:"Select field(s) to use for suppressing extra alerts"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.j)(t.ruleType))return m.j.maxLengthField({length:3,message:r.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.groupByFieldsMax",{defaultMessage:"Number of grouping fields must be at most 3"})})(...e)}},{validator:(...e)=>{var t,a,n;const[{formData:r,value:i}]=e,o=i.length;if(!(Object(u.b)(r.ruleType)&&o>0))return;const s=null!==(t=null===(a=r.queryBar)||void 0===a||null===(n=a.query)||void 0===n?void 0:n.query)&&void 0!==t?t:"";return Object(u.c)(s)?{message:h.j}:void 0}}]},groupByRadioSelection:{},groupByDuration:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByDurationValueLabel",{defaultMessage:"Suppress alerts for"}),helpText:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByDurationValueHelpText",{defaultMessage:"Suppress alerts for"}),value:{},unit:{}},suppressionMissingFields:{label:r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.suppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})},shouldLoadQueryDynamically:{type:m.a.CHECKBOX,defaultValue:!1},enableThresholdSuppression:{type:m.a.CHECKBOX,defaultValue:!1}}},853:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(1479);const r=({esqlQuery:e,search:t})=>({queryKey:[(null!=e?e:"").trim()],queryFn:async()=>{if(!e)return null;try{return await Object(n.a)({esqlQuery:e,search:t})}catch(e){return{error:e}}},staleTime:6e4})},854:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(524),r=a(165);const i=e=>{const t=new Set(["string","number","ip","boolean"]);return e.filter((e=>!0===e.aggregatable&&t.has(e.type)))},o=e=>Object(r.d)(e)?n.l:Object(r.b)(e)?n.h:n.f},855:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(984);const o=Object(n.createContext)(0),s=()=>Object(n.useContext)(o),l=r.a.memo((({children:e})=>{const{ref:t,width:a}=Object(i.a)();return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.Provider,{value:null!=a?a:0},e),r.a.createElement("div",{ref:t}))}));l.displayName="EventDetailsWidthProvider"},858:function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var n=a(2),r=a.n(n),i=a(201),o=a(983),s=a(314),l=a(527),c=a(745),u=a(804),d=a(41),p=a.n(d),m=a(19),b=a(4);const g=b.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlRunJobLabel",{defaultMessage:"Run job"}),f=b.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlStopJobLabel",{defaultMessage:"Stop job"}),h=(b.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),b.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlAdminPermissionsRequiredDescription",{defaultMessage:"ML Admin Permissions required to perform this action"}));var v=a(223),y=a(690),E=function(e){return e.info="info",e.warning="warning",e.error="error",e}(E||{});const x=({message:e})=>{if(!e)return null;let t="primary",a="warning";return e.level===E.info?a="iInCircle":e.level===E.warning?t="warning":e.level===E.error&&(t="danger"),r.a.createElement(m.EuiToolTip,{content:e.text},r.a.createElement(m.EuiIcon,{"data-test-subj":"mlJobAuditIcon",type:a,color:t}))},j=Object(n.memo)(x),w=b.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),S=b.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),O=({job:e})=>{const t=Object(v.c)(e.jobState,e.datafeedState),a=t?"success":"danger",n=t?w:S;return r.a.createElement(m.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:a},n)},k=Object(n.memo)(O),I=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-mrslp7-0"})(["overflow:hidden;"]),T=({job:e,switchComponent:t,...a})=>{var n;const i=Object(v.c)(e.jobState,e.datafeedState);return r.a.createElement(I,a,r.a.createElement("div",null,r.a.createElement(y.a,{jobId:e.id,jobName:null===(n=e.customSettings)||void 0===n?void 0:n.security_app_display_name}),r.a.createElement(j,{message:e.auditMessage})),r.a.createElement(m.EuiFlexGroup,{justifyContent:"flexStart"},r.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginRight:"0"}},r.a.createElement(k,{job:e})),r.a.createElement(m.EuiFlexItem,{grow:!1},t),r.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginLeft:"0"},"data-test-subj":"mlJobActionLabel"},i?f:g)))},C=Object(n.memo)(T),M=({job:e,loading:t,refreshJob:a})=>{const{enableDatafeed:i,disableDatafeed:o,isLoading:s}=Object(c.a)(),l=Object(n.useCallback)((async(t,n,r)=>{r?await i(e,n):await o(e),a(e)}),[i,o,e,a]),d=Object(n.useMemo)((()=>r.a.createElement(u.a,{job:e,isSecurityJobsLoading:t||s,onJobStateChange:l})),[l,s,e,t]);return r.a.createElement(C,{job:e,switchComponent:d})},F=Object(n.memo)(M),D=({jobIds:e})=>{const{loading:t,jobs:a,refetch:n,isMlAdmin:i}=Object(l.a)();if(!i)return null;const o=a.filter((t=>e.includes(t.id)));return r.a.createElement(r.a.Fragment,null,o.map((e=>r.a.createElement(F,{key:e.id,job:e,loading:t,refreshJob:n}))))},P=Object(n.memo)(D);var L=a(562),N=a(1337),R=a.n(N);const _=({job:e})=>{const t=Object(n.useMemo)((()=>r.a.createElement(m.EuiToolTip,{content:h},r.a.createElement(m.EuiSwitch,{disabled:!0,"data-test-subj":"mlUserJobSwitch",showLabel:!1,label:"",checked:Object(v.c)(e.jobState,e.datafeedState),onChange:R.a}))),[e]);return r.a.createElement(C,{job:e,switchComponent:t})},A=Object(n.memo)(_),z=({jobIds:e})=>{const{isMlUser:t,jobs:a}=Object(L.b)();if(!t)return null;const n=a.filter((t=>e.includes(t.id)));return r.a.createElement(r.a.Fragment,null,n.map((e=>r.a.createElement(A,{key:e.id,job:e}))))},B=Object(n.memo)(z),V=({jobIds:e})=>{const t=Object(i.a)(),a=Object(s.a)(t);return Object(o.a)(t)?r.a.createElement(P,{jobIds:e}):a?r.a.createElement(B,{jobIds:e}):null},$=Object(n.memo)(V)},866:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a.n(n),i=a(270),o=a(420),s=a(118),l=a(407),c=a(423);const u=a(4).i18n.translate("xpack.securitySolution.detectionEngine.rulesSnoozeBadge.error.unableToFetch",{defaultMessage:"Unable to fetch snooze settings"});function d({ruleId:e,showTooltipInline:t=!1}){const a=Object(s.j)().services.triggersActionsUi.getRulesListNotifyBadge,{snoozeSettings:n,error:d}=function(e){var t,a;const{state:{rulesSnoozeSettings:n}}=null!==(t=Object(c.c)())&&void 0!==t?t:{state:{}},{data:r,isFetching:i,isError:o}=Object(l.a)([e],{enabled:!(null!=n&&n.data[e]||null!=n&&n.isFetching)}),s=null!==(a=null==n?void 0:n.data[e])&&void 0!==a?a:null==r?void 0:r[e],d=(null==n?void 0:n.isFetching)||i;return{snoozeSettings:s,error:(null==n?void 0:n.isError)||o||!s&&!d?u:void 0}}(e),[{canUserCRUD:p}]=Object(i.b)(),m=Object(o.c)(p),b=Object(l.b)();return r.a.createElement(a,{ruleId:e,snoozeSettings:n,loading:!n&&!d,disabled:!m||d,showTooltipInline:t,onRuleChanged:b})}},867:function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return w}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(974),l=a(19),c=a(118);const u=({integration:e})=>{const t=Object(c.d)(),a=e.integrationTitle,n=`${t}/${e.targetUrl}`;return r.a.createElement(l.EuiLink,{href:n,target:"_blank","data-test-subj":"integrationLink"},a)},d=r.a.memo(u);d.displayName="IntegrationLink";var p=a(619);const m=o()(l.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-63ceph-0"})(["margin-left:5px;"]),b=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:a,isEnabled:n}=t,i=n?"success":a?"primary":void 0,o=a?n?p.d:p.e:p.j,s=n?p.c:a?p.b:p.i;return r.a.createElement(l.EuiToolTip,{content:o},r.a.createElement(m,{color:i,"data-test-subj":"statusBadge"},s))},g=r.a.memo(b);g.displayName="IntegrationStatusBadge";const f=o.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-8orjjk-0"})(["margin-left:5px;"]),h=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?r.a.createElement(f,null,r.a.createElement(l.EuiIconTip,{type:"warning",color:"warning",content:p.f(t.installedVersion,e.requiredVersion)})):null},v=r.a.memo(h);v.displayName="IntegrationVersionMismatchIcon";const y=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-hszsn0-0"})(["overflow:hidden;"]),E=({integration:e,dataTestSubj:t="integrationDescription"})=>r.a.createElement(y,{"data-test-subj":`${t}-${e.packageName}`},r.a.createElement(d,{integration:e})," ",r.a.createElement(g,{integration:e}),r.a.createElement(v,{integration:e})),x=r.a.memo(E),j=({relatedIntegrations:e,dataTestSubj:t="relatedIntegrationsDescription"})=>{const{integrations:a}=Object(s.a)(e);return r.a.createElement(r.a.Fragment,null,a.map(((e,a)=>r.a.createElement(x,{key:`${e.packageName}-${a}`,integration:e,dataTestSubj:t}))))},w=(e,t)=>null==t||0===t.length?[]:[{title:e,description:r.a.createElement(j,{relatedIntegrations:t})}]},874:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b}));var n=a(2),r=a(165),i=a(248),o=a(118),s=a(157),l=a(852),c=a(970),u=a(945),d=a(958),p=a(252);const m=({defineStepDefault:e,aboutStepDefault:t,scheduleStepDefault:a,actionsStepDefault:i})=>{const{triggersActionsUi:{actionTypeRegistry:p}}=Object(o.j)().services,{form:m}=Object(s.m)({defaultValue:e,options:{stripEmptyFields:!1},schema:l.a}),[b,g]=Object(n.useState)(e.eqlOptions),[f]=Object(s.o)({form:m}),h=Object(n.useMemo)((()=>"index"in f?{...f,eqlOptions:b}:e),[e,f,b]),v=Object(n.useMemo)((()=>Object(r.m)(h.ruleType)?c.b:c.a),[h.ruleType]),{form:y}=Object(s.m)({defaultValue:t,options:{stripEmptyFields:!1},schema:v}),[E]=Object(s.o)({form:y}),x="name"in E?E:t,{form:j}=Object(s.m)({defaultValue:a,options:{stripEmptyFields:!1},schema:u.a}),[w]=Object(s.o)({form:j}),S="interval"in w?w:a,O=Object(n.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Object(d.a)(e)}]},responseActions:{},enabled:{},kibanaSiemAppUrl:{}}))({actionTypeRegistry:p})),[p]),{form:k}=Object(s.m)({defaultValue:i,options:{stripEmptyFields:!1},schema:O}),[I]=Object(s.o)({form:k});return{defineStepForm:m,defineStepData:h,aboutStepForm:y,aboutStepData:x,scheduleStepForm:j,scheduleStepData:S,actionsStepForm:k,actionsStepData:"actions"in I?I:i,eqlOptionsSelected:b,setEqlOptionsSelected:g}},b=({dataSourceType:e,index:t,dataViewId:a})=>{const{data:r}=Object(o.j)().services,[s,{browserFields:l,indexPatterns:c}]=Object(p.b)(t),[u,d]=Object(n.useState)(c);return Object(n.useEffect)((()=>{e!==i.a.IndexPatterns||s||d(c),e===i.a.DataView&&(async()=>{if(null!=a){const e=await r.dataViews.get(a);d(e)}})()}),[e,s,r,a,c]),{indexPattern:u,isIndexPatternLoading:s,browserFields:l}}},938:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a.n(n),i=a(355),o=a(759);const s=e=>[{headerCellRender:()=>r.a.createElement(r.a.Fragment,null,o.a),id:"default-timeline-control-column",rowCellRender:i.a,width:Object(i.c)(e)}]},939:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o}));const n={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1,enabled:void 0,ruleExecutionStatus:void 0},r={field:"enabled",order:"desc"},i=1,o=20},940:function(e,t,a){const n=a(311),r=a(348),i=a(164),o=a(558),s=a(283),l=a(656),c=a(1108),u=a(1109),d=a(1110),p=a(1111),m=a(1112),b=a(1113),g=a(1114),f=a(190),h=a(1115),v=a(1116),y=a(490),E=a(1117),x=a(1118),j=a(385),w=a(491),S=a(671),O=a(672),k=a(421),I=a(492),T=a(673),C=a(941),M=a(386),F=a(193),D=a(387),P=a(1120),L=a(1121),N=a(1122),R=a(1123),_=a(1124),A=a(493),z=a(1125),B=a(1126),V=a(1127),$=a(1128),q=a(1129);e.exports={parse:s,valid:l,clean:c,inc:u,diff:d,major:p,minor:m,patch:b,prerelease:g,compare:f,rcompare:h,compareLoose:v,compareBuild:y,sort:E,rsort:x,gt:j,lt:w,eq:S,neq:O,gte:k,lte:I,cmp:T,coerce:C,Comparator:M,Range:F,satisfies:D,toComparators:P,maxSatisfying:L,minSatisfying:N,minVersion:R,validRange:_,outside:A,gtr:z,ltr:B,intersects:V,simplifyRange:$,subset:q,SemVer:i,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:r.SEMVER_SPEC_VERSION,RELEASE_TYPES:r.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},941:function(e,t,a){const n=a(164),r=a(283),{safeRe:i,t:o}=a(311);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let a=null;if((t=t||{}).rtl){const n=t.includePrerelease?i[o.COERCERTLFULL]:i[o.COERCERTL];let r;for(;(r=n.exec(e))&&(!a||a.index+a[0].length!==e.length);)a&&r.index+r[0].length===a.index+a[0].length||(a=r),n.lastIndex=r.index+r[1].length+r[2].length;n.lastIndex=-1}else a=e.match(t.includePrerelease?i[o.COERCEFULL]:i[o.COERCE]);if(null===a)return null;const s=a[2],l=a[3]||"0",c=a[4]||"0",u=t.includePrerelease&&a[5]?`-${a[5]}`:"",d=t.includePrerelease&&a[6]?`+${a[6]}`:"";return r(`${s}.${l}.${c}${u}${d}`,t)}},942:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(44),r=a(19),i=a(2),o=a.n(i),s=a(413),l=a.n(s),c=a(675),u=a.n(c),d=a(41),p=a.n(d),m=a(69),b=a(42),g=a(1347),f=a(5),h=a(157),v=a(118),y=a(688);const E=[{isSummaryOption:!0,isForEachAlertOption:!0,value:{value:"onActiveAlert",inputDisplay:y.d,"data-test-subj":"onActiveAlert",dropdownDisplay:o.a.createElement(r.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(b.FormattedMessage,{defaultMessage:"Per rule run",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.label"})))}},{isSummaryOption:!0,isForEachAlertOption:!1,value:{value:"onThrottleInterval",inputDisplay:y.a,"data-test-subj":"onThrottleInterval",dropdownDisplay:o.a.createElement(r.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(b.FormattedMessage,{defaultMessage:"Custom frequency",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.label"})))}}],x=p.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-12frxs0-0"})(["p{margin-bottom:0;}"]),j=p.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-12frxs0-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__children {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),w=({field:e,messageVariables:t,summaryMessageVariables:a})=>{const[s,c]=Object(i.useState)(null),d=Object(h.n)(),{isValid:p}=d,{triggersActionsUi:{getActionForm:b}}=Object(v.j)().services,[w,S]=Object(i.useState)(!1),O=Object(i.useMemo)((()=>Object(n.isEmpty)(e.value)?[]:e.value),[e.value]),k=Object(i.useMemo)((()=>O.reduce(((e,t,a)=>".case"===t.actionTypeId?[...e,`${a}`]:e),[])),[O]),I=Object(i.useCallback)(((t,a)=>{const r=[...O];Object(n.isEmpty)(r[a].params)&&S(!0),r[a]=l()(r[a],{id:t}),e.setValue(r)}),[e,O]),T=Object(i.useCallback)((t=>e.setValue(t)),[e]),C=Object(i.useCallback)(((t,a,n)=>{const r=()=>{e.setValue((e=>{const r=[...e];return r[n]={...r[n],params:{...r[n].params,[t]:a}},r}))};w?(setTimeout(r,0),S(!1)):r()}),[e,w]),M=Object(i.useCallback)(((t,a,r)=>{e.setValue((e=>{const i=[...e],{alertsFilter:o,...s}=i[r],l={...o};return a?l[t]=a:delete l[t],i[r]={...s,...Object(n.isEmpty)(l)?{}:{alertsFilter:l}},i}))}),[e]),F=Object(i.useCallback)(((t,a,n)=>{e.setValue((e=>{var r;const i=[...e];return i[n]={...i[n],frequency:{...null!==(r=i[n].frequency)&&void 0!==r?r:f.ec,[t]:a}},i}))}),[e]),D=void 0!==p,P=Object(i.useMemo)((()=>b({actions:O,messageVariables:t,summaryMessageVariables:a,defaultActionGroupId:"default",setActionIdByIndex:I,setActions:T,setActionParamsProperty:C,setActionFrequencyProperty:F,setActionAlertsFilterProperty:M,featureId:m.SecurityConnectorFeatureId,producerId:g.a.SIEM,defaultActionMessage:y.c,defaultSummaryMessage:y.e,hideActionHeader:!0,hasAlertsMappings:!0,notifyWhenSelectOptions:E,defaultRuleFrequency:f.ec,disableErrorMessages:!D})),[O,b,t,a,F,I,C,T,M,D]);return Object(i.useEffect)((()=>{if(!1===p){const t=e.errors.map((({message:e})=>e)).join("\n");return c(t)}return c(null)}),[e.errors,p]),o.a.createElement(j,{$caseIndexes:k},s?o.a.createElement(o.a.Fragment,null,o.a.createElement(x,null,o.a.createElement(r.EuiCallOut,{title:y.b,color:"danger",iconType:"warning"},o.a.createElement(u.a,null,s))),o.a.createElement(r.EuiSpacer,null)):null,P)}},943:function(e,t,a){"use strict";a.d(t,"a",(function(){return S})),a.d(t,"b",(function(){return B}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(41),l=a.n(s),c=a(44),u=a(19),d=a(813),p=a(1560),m=a(298),b=a(130),g=a(438),f=a(773),h=a(689),v=a(408),y=a(368);const E=l()(u.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-ssmf6u-0"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),x=l()(u.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-ssmf6u-1"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),j=l()(u.EuiLink).withConfig({displayName:"StyledEuiLink",componentId:"sc-ssmf6u-2"})(["word-break:break-word;"]),w=({name:e})=>o.a.createElement(u.EuiText,{size:"s"},e),S=({description:e})=>o.a.createElement(u.EuiText,{size:"s"},e),O=({author:e})=>o.a.createElement(h.a,{badges:e,"data-test-subj":"authorPropertyValue"}),k=()=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"buildingBlockPropertyValue"},y.d),I=({severityMappingItem:e})=>o.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(E,null,o.a.createElement(u.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField-${e.value}`},o.a.createElement("span",{"data-test-subj":"severityOverrideField"},`${e.field}:`))),o.a.createElement(x,null,o.a.createElement(u.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue-${e.value}`},o.a.createElement("span",{"data-test-subj":"severityOverrideValue"},Object(b.a)(e.value)))),o.a.createElement(u.EuiFlexItem,{grow:!1},o.a.createElement(u.EuiIcon,{type:"sortRight"})),o.a.createElement(u.EuiFlexItem,null,o.a.createElement(m.a,{"data-test-subj":"severityOverrideSeverity",value:e.severity}))),T=({riskScore:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"riskScorePropertyValue"},e),C=({riskScoreMappingItem:e})=>o.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(E,null,o.a.createElement(u.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField-${e.value}`},o.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyFieldName"},e.field))),o.a.createElement(u.EuiFlexItem,{grow:!1},o.a.createElement(u.EuiIcon,{type:"sortRight"})),o.a.createElement(u.EuiFlexItem,{"data-test-subj":"riskScoreOverridePropertyOverride"},d.a)),M=({references:e})=>o.a.createElement(u.EuiText,{size:"s"},o.a.createElement("ul",null,e.filter((e=>!Object(c.isEmpty)(e))).map(((e,t)=>o.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},o.a.createElement(j,{href:e,external:!0,target:"_blank"},e)))))),F=({falsePositives:e})=>o.a.createElement(u.EuiText,{size:"s"},o.a.createElement("ul",null,e.map((e=>o.a.createElement("li",{"data-test-subj":"falsePositivesPropertyValueItem",key:`falsePositives-${e}`},e))))),D=({investigationFields:e})=>o.a.createElement(h.a,{badges:e,"data-test-subj":"investigationFieldsPropertyValue"}),P=({license:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"licensePropertyValue"},e),L=({ruleNameOverride:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"ruleNameOverridePropertyValue"},e),N=({threat:e})=>o.a.createElement(f.a,{threat:Object(g.a)(e),"data-test-subj":"threatPropertyValue"}),R=({threatIndicatorPath:e})=>o.a.createElement(u.EuiText,{size:"s"},e),_=({timestampOverride:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"timestampOverridePropertyValue"},e),A=({maxSignals:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"maxSignalsPropertyValue"},e),z=({tags:e})=>o.a.createElement(h.a,{badges:e,"data-test-subj":"tagsPropertyValue"}),B=({rule:e,columnWidths:t=v.b,hideName:a,hideDescription:n,...i})=>{var s,l;const c=((e,t,a)=>{const n=[];return!t&&e.name&&n.push({title:y.x,description:o.a.createElement(w,{name:e.name})}),!a&&e.description&&n.push({title:y.k,description:o.a.createElement(S,{description:e.description})}),e.author&&e.author.length>0&&n.push({title:o.a.createElement("span",{"data-test-subj":"authorPropertyTitle"},y.c),description:o.a.createElement(O,{author:e.author})}),e.building_block_type&&n.push({title:o.a.createElement("span",{"data-test-subj":"buildingBlockPropertyTitle"},y.e),description:o.a.createElement(k,null)}),e.severity&&n.push({title:o.a.createElement("span",{"data-test-subj":"severityPropertyTitle"},y.J),description:o.a.createElement(m.a,{value:e.severity,"data-test-subj":"severityPropertyValue"})}),e.severity_mapping&&e.severity_mapping.length>0&&n.push(...e.severity_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?o.a.createElement("span",{"data-test-subj":"severityOverridePropertyTitle"},y.K):"",description:o.a.createElement(I,{severityMappingItem:e})})))),e.risk_score&&n.push({title:o.a.createElement("span",{"data-test-subj":"riskScorePropertyTitle"},y.D),description:o.a.createElement(T,{riskScore:e.risk_score})}),e.risk_score_mapping&&e.risk_score_mapping.length>0&&n.push(...e.risk_score_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?o.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyTitle"},y.E):"",description:o.a.createElement(C,{riskScoreMappingItem:Object(p.a)(e)})})))),e.references&&e.references.length>0&&n.push({title:o.a.createElement("span",{"data-test-subj":"referencesPropertyTitle"},y.A),description:o.a.createElement(M,{references:e.references})}),e.false_positives&&e.false_positives.length>0&&n.push({title:o.a.createElement("span",{"data-test-subj":"falsePositivesPropertyTitle"},y.m),description:o.a.createElement(F,{falsePositives:e.false_positives})}),e.investigation_fields&&e.investigation_fields.field_names.length>0&&n.push({title:o.a.createElement("span",{"data-test-subj":"investigationFieldsPropertyTitle"},y.r),description:o.a.createElement(D,{investigationFields:e.investigation_fields.field_names})}),e.license&&n.push({title:o.a.createElement("span",{"data-test-subj":"licensePropertyTitle"},y.u),description:o.a.createElement(P,{license:e.license})}),e.rule_name_override&&n.push({title:o.a.createElement("span",{"data-test-subj":"ruleNameOverridePropertyTitle"},y.F),description:o.a.createElement(L,{ruleNameOverride:e.rule_name_override})}),e.threat&&e.threat.length>0&&n.push({title:o.a.createElement("span",{"data-test-subj":"threatPropertyTitle"},y.P),description:o.a.createElement(N,{threat:e.threat})}),"threat_indicator_path"in e&&e.threat_indicator_path&&n.push({title:y.S,description:o.a.createElement(R,{threatIndicatorPath:e.threat_indicator_path})}),e.timestamp_override&&n.push({title:o.a.createElement("span",{"data-test-subj":"timestampOverridePropertyTitle"},y.W),description:o.a.createElement(_,{timestampOverride:e.timestamp_override})}),e.max_signals&&n.push({title:o.a.createElement("span",{"data-test-subj":"maxSignalsPropertyTitle"},y.w),description:o.a.createElement(A,{maxSignals:e.max_signals})}),e.tags&&e.tags.length>0&&n.push({title:o.a.createElement("span",{"data-test-subj":"tagsPropertyTitle"},y.O),description:o.a.createElement(z,{tags:e.tags})}),n})(e,a,n);return o.a.createElement("div",null,o.a.createElement(u.EuiSpacer,{size:"m"}),o.a.createElement(u.EuiDescriptionList,r()({type:null!==(s=i.type)&&void 0!==s?s:"column",rowGutterSize:null!==(l=i.rowGutterSize)&&void 0!==l?l:"m",listItems:c,columnWidths:t,"data-test-subj":"listItemColumnStepRuleDescription"},i)))}},944:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(47),i=a(579),o=a(123),s=a(178);const l=({savedQueryId:e,ruleType:t,onError:a})=>{var l;const c=Object(i.a)(),{addError:u}=Object(o.a)(),d=Object(r.useQuery)(["detectionEngine","rule","savedQuery",e],(async()=>e&&"saved_query"===t?c.getSavedQuery(e):null),{onError:null!=a?a:e=>{u(e,{title:s.kd})},retry:!1,refetchOnWindowFocus:!1}),p=Object(n.useMemo)((()=>{var e;return d.data?{saved_id:d.data.id,filters:null!==(e=d.data.attributes.filters)&&void 0!==e?e:[],query:d.data.attributes.query,title:d.data.attributes.title}:null}),[d.data]);return{isSavedQueryLoading:!!e&&d.isLoading,savedQueryBar:p,savedQuery:null!==(l=d.data)&&void 0!==l?l:void 0}}},945:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4);const r={interval:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}}},946:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),r=a(165);const i=e=>({isSuppressionEnabled:Object(n.useCallback)((()=>!!e&&Object(r.h)(e)),[e])()})},947:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(566),c=a(303),u=a(408),d=a(368);const p=({interval:e})=>o.a.createElement(s.EuiText,{size:"s","data-test-subj":"intervalPropertyValue"},o.a.createElement(l.a,{interval:e})),m=({from:e,interval:t})=>o.a.createElement(s.EuiText,{size:"s","data-test-subj":`fromPropertyValue-${e}`},o.a.createElement(l.a,{interval:Object(c.f)(e,t)})),b=({rule:e,columnWidths:t=u.b,...a})=>{var n,i;if(!e.interval||!e.from)return null;const l=[];return l.push({title:o.a.createElement("span",{"data-test-subj":"intervalPropertyTitle"},d.q),description:o.a.createElement(p,{interval:e.interval})},{title:o.a.createElement("span",{"data-test-subj":"fromPropertyTitle"},d.n),description:o.a.createElement(m,{from:e.from,interval:e.interval})}),o.a.createElement("div",{"data-test-subj":"listItemColumnStepRuleDescription"},o.a.createElement(s.EuiDescriptionList,r()({type:null!==(n=a.type)&&void 0!==n?n:"column",rowGutterSize:null!==(i=a.rowGutterSize)&&void 0!==i?i:"m",listItems:l,columnWidths:t},a)))}},958:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(83),r=a(1192),i=a.n(r),o=a(44),s=a(4);const l=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(o.startCase)(t):""},c=async(e,t)=>{const a=await(async(e,t)=>{var a;const n=await(null===(a=t.get(e.actionTypeId))||void 0===a?void 0:a.validateParams(e.params));if(n){const e=Object.values(n.errors);if(e.length){const t=e.filter((e=>Object(o.isString)(e)||Object(o.isArray)(e))),a=Object(o.uniq)(Object(o.flattenDeep)(t));if(a.length)return a}}return[]})(e,t),r=(e=>{const t=[];return Object.entries(e).forEach((([e,a])=>{if(Object(o.isString)(a))try{i.a.render(a,{})}catch(a){t.push((e=>s.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(o.startCase)(e)}}))(e))}})),t})(e.params),l=Object(n.validateActionFilterQuery)(e);return[...a,...r,...l?[l]:[]]},u=(e,t=100)=>a=>{let n=!1;const r=new Promise((r=>{setTimeout((()=>{n?r():r((e=>async(...t)=>{const[{value:a,path:n}]=t,r=[];for(const t of a){const a=await c(t,e);if(a.length){const e=l(t.actionTypeId),n=a.map((e=>`*   ${e}\n`));r.push(`\n**${e}:**\n${n.join("")}`)}}if(r.length)return{code:"ERR_FIELD_FORMAT",path:n,message:`${r.join("\n")}`}})(e)(a))}),t)}));return r.cancel=()=>{n=!0},r}},963:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b}));var n=a(7),r=a(118),i=a(165),o=a(4);const s=o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.unknownError",{defaultMessage:"Unknown error while validating ES|QL"}),l=o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.missingMetadataOperatorInQueryError",{defaultMessage:'Queries that don’t use the STATS...BY function (non-aggregating queries) must include the "metadata _id, _version, _index" operator after the source command. For example: FROM logs* metadata _id, _version, _index.'}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.missingIdFieldInQueryError",{defaultMessage:'Queries that don’t use the STATS...BY function (non-aggregating queries) must include the "metadata _id, _version, _index" operator after the source command. For example: FROM logs* metadata _id, _version, _index.  In addition, the metadata properties (_id, _version, and _index)  must be returned in the query response.'});var u=a(853);let d=function(e){return e.INVALID_ESQL="ERR_INVALID_ESQL",e.ERR_MISSING_ID_FIELD_FROM_RESULT="ERR_MISSING_ID_FIELD_FROM_RESULT",e}({});const p=e=>{return{code:d.INVALID_ESQL,message:null!=e&&e.message?(t=e.message,o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.errorMessage",{values:{message:t},defaultMessage:'Error validating ES|QL: "{message}"'})):s,error:e};var t},m=async(...e)=>{const[{value:t,formData:a,customData:o}]=e,{query:s}=t,m=s.query,{ruleType:g}=a;if(Object(i.d)(g)&&!Object(n.isEmpty)(m))try{var f;const e=null===(f=o.value)||void 0===f?void 0:f.queryClient,t=r.b.get(),{isEsqlQueryAggregating:a,isMissingMetadataOperator:n}=b(m);if(n)return{code:d.ERR_MISSING_ID_FIELD_FROM_RESULT,message:l};const i=await(null==e?void 0:e.fetchQuery(Object(u.a)({esqlQuery:m,search:t.data.search.search})));if(i&&"error"in i)return p(i.error);const s=(null!=i?i:[]).find((({id:e})=>"_id"===e));if(!a&&!s)return{code:d.ERR_MISSING_ID_FIELD_FROM_RESULT,message:c}}catch(e){return p(e)}},b=e=>{const t=/\|\s+stats\s/i.test(e);return{isEsqlQueryAggregating:t,isMissingMetadataOperator:!t&&(a=e,!/(?<!\|[\s\S.]*)\s*metadata[\s\S.]*_id[\s\S.]*/i.test(null==a||null===(n=a.split("|"))||void 0===n?void 0:n[0]))};var a,n}},968:function(e,t,a){"use strict";a.d(t,"a",(function(){return X}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(44),l=a(19),c=a(11),u=a(70),d=a(290),p=a(227),m=a(663),b=a(867),g=a(791),f=a(944),h=a(662),v=a(443),y=a(874),E=a(248),x=a(303),j=a(858),w=a(690),S=a(527),O=a(242),k=a(689),I=a(408),T=a(368),C=a(946),M=a(772),F=a(152);const D={flexGroup:F.css`
    max-width: 600px;
  `},P={content:F.css`
    white-space: pre-wrap;
  `},L=({savedQueryName:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"savedQueryNamePropertyValue"},e),N=({filters:e,dataViewId:t,index:a,"data-test-subj":n})=>{const r=Object(c.mapAndFlattenFilters)(e),{indexPattern:i}=Object(y.b)({dataSourceType:t?E.a.DataView:E.a.IndexPatterns,index:null!=a?a:[],dataViewId:t}),s=D;return o.a.createElement(l.EuiFlexGroup,{"data-test-subj":n,className:s.flexGroup,wrap:!0,responsive:!1,gutterSize:"xs"},o.a.createElement(u.FilterItems,{filters:r,indexPatterns:[i],readOnly:!0}))},R=({query:e,"data-test-subj":t="query"})=>{const a=P;return o.a.createElement("div",{"data-test-subj":t,className:a.content},e)},_=({index:e})=>o.a.createElement(k.a,{badges:e,"data-test-subj":"indexPropertyValue"}),A=({dataViewId:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"dataViewIdPropertyValue"},e),z=({dataViewId:e})=>{const{data:t}=Object(O.c)().services,[a,n]=o.a.useState(""),[r,i]=o.a.useState(!1);return o.a.useEffect((()=>{t.dataViews.get(e).then((e=>{n(e.getIndexPattern())})).catch((()=>{i(!0)}))}),[t,e]),r?o.a.createElement(l.EuiText,{size:"s"},T.h):a?o.a.createElement(l.EuiText,{size:"s","data-test-subj":"dataViewIndexPatternPropertyValue"},a):o.a.createElement(l.EuiLoadingSpinner,{size:"m"})},B=({threshold:e})=>o.a.createElement("div",{"data-test-subj":"thresholdPropertyValue"},Object(s.isEmpty)(e.field[0])?`${m.y} >= ${e.value}`:`${m.x} ${Array.isArray(e.field)?e.field.join(","):e.field} >= ${e.value}`),V=({anomalyThreshold:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"anomalyThresholdPropertyValue"},e),$=({jobIds:e,isInteractive:t})=>{const{jobs:a}=Object(S.a)();if(t)return o.a.createElement(j.a,{jobIds:e});const n=a.filter((t=>e.includes(t.id)));return o.a.createElement(o.a.Fragment,null,n.map((e=>{var t;return o.a.createElement(w.a,{key:e.id,jobId:e.id,jobName:null===(t=e.customSettings)||void 0===t?void 0:t.security_app_display_name})})))},q=({type:e})=>o.a.createElement(l.EuiText,{size:"s"},(e=>{switch(e){case"machine_learning":return m.o;case"query":case"saved_query":return m.r;case"threshold":return m.z;case"eql":return m.j;case"esql":return m.l;case"threat_match":return m.v;case"new_terms":return m.p;default:return Object(p.a)(e)}})(e)),G=({requiredFields:e})=>{const t=(()=>{const{euiTheme:e}=Object(l.useEuiTheme)(),{font:t}=e;return Object(i.useMemo)((()=>{var e;return{fieldNameText:F.css`
        font-family: ${null!==(e=t.familyCode)&&void 0!==e?e:t.family};
        display: inline;
      `}}),[t.familyCode,t.family])})();return o.a.createElement(l.EuiFlexGrid,{"data-test-subj":"requiredFieldsPropertyValue",gutterSize:"s"},e.map(((a,n)=>o.a.createElement(l.EuiFlexItem,{grow:!1,key:a.name},o.a.createElement(l.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(M.a,{type:a.type,"data-test-subj":"field-type-icon"})),o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiText,{"data-test-subj":"requiredFieldsPropertyValueItem",className:t.fieldNameText,grow:!1,size:"xs"},` ${a.name}${n+1!==e.length?", ":""}`)))))))},U=({timelineTitle:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"timelineTemplatePropertyValue"},e),H=({threatIndex:e})=>o.a.createElement(k.a,{badges:e,"data-test-subj":"threatIndexPropertyValue"}),W=({threatMapping:e})=>{const t=e.reduce(((e,t,a,{length:n})=>{const r=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${h.d} ${t.value}`:0===a?`(${t.field} ${h.d} ${t.value})`:`${e} ${h.a} (${t.field} ${h.d} ${t.value})`),"");return 1===n?`${r}`:0===a?`(${r})`:`${e} ${h.e} (${r})`}),"");return o.a.createElement(l.EuiText,{size:"s","data-test-subj":"threatMappingPropertyValue"},t)},Q=({fields:e})=>o.a.createElement(k.a,{badges:e,"data-test-subj":"alertSuppressionGroupByPropertyValue"}),K=({duration:e})=>{const t=e?`${e.value}${e.unit}`:m.b;return o.a.createElement(l.EuiText,{size:"s","data-test-subj":"alertSuppressionDurationPropertyValue"},t)},J=({missingFieldsStrategy:e})=>{const t=e===d.a.suppress?m.c:m.a;return o.a.createElement(l.EuiText,{size:"s","data-test-subj":"alertSuppressionMissingFieldsPropertyValue"},t)},Y=({newTermsFields:e})=>o.a.createElement(k.a,{badges:e,"data-test-subj":"newTermsFieldsPropertyValue"}),Z=({historyWindowStart:e})=>{const t=e?Object(x.b)(e):"7d";return o.a.createElement(l.EuiText,{size:"s","data-test-subj":`newTermsWindowSizePropertyValue-${e}`},t)},X=({rule:e,isInteractive:t=!1,columnWidths:a=I.b,dataTestSubj:n,...i})=>{var s,c;const{savedQuery:u}=Object(f.a)({savedQueryId:"saved_query"===e.type?e.saved_id:"",ruleType:e.type}),{isSuppressionEnabled:d}=Object(C.a)(e.type),p=((e,t,a,n)=>{var r;const i=[];return"index"in e&&e.index&&e.index.length>0&&i.push({title:o.a.createElement("span",{"data-test-subj":"indexPropertyTitle"},T.p),description:o.a.createElement(_,{index:e.index})}),"data_view_id"in e&&e.data_view_id&&i.push({title:o.a.createElement("span",{"data-test-subj":"dataViewIdPropertyTitle"},T.g),description:o.a.createElement(A,{dataViewId:e.data_view_id})},{title:o.a.createElement("span",{"data-test-subj":"dataViewIndexPatternPropertyTitle"},T.i),description:o.a.createElement(z,{dataViewId:e.data_view_id})}),a&&(i.push({title:o.a.createElement("span",{"data-test-subj":"savedQueryNamePropertyTitle"},m.u),description:o.a.createElement(L,{savedQueryName:a.attributes.title})}),a.attributes.filters&&i.push({title:o.a.createElement("span",{"data-test-subj":"savedQueryFiltersPropertyTitle"},m.s),description:o.a.createElement(N,{filters:a.attributes.filters,"data-test-subj":"savedQueryFiltersPropertyValue"})}),"string"==typeof a.attributes.query.query&&i.push({title:o.a.createElement("span",{"data-test-subj":"savedQueryContentPropertyTitle"},m.t),description:o.a.createElement(R,{query:a.attributes.query.query,"data-test-subj":"savedQueryContentPropertyValue"})})),"filters"in e&&null!==(r=e.filters)&&void 0!==r&&r.length&&i.push({title:o.a.createElement("span",{"data-test-subj":"filtersPropertyTitle"},m.m),description:o.a.createElement(N,{filters:e.filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"filtersPropertyValue"})}),"query"in e&&e.query&&("eql"===e.type?i.push({title:o.a.createElement("span",{"data-test-subj":"eqlQueryPropertyTitle"},m.g),description:o.a.createElement(R,{query:e.query,"data-test-subj":"eqlQueryPropertyValue"})}):"esql"===e.type?i.push({title:o.a.createElement("span",{"data-test-subj":"esqlQueryPropertyTitle"},m.k),description:o.a.createElement(R,{query:e.query,"data-test-subj":"esqlQueryPropertyValue"})}):i.push({title:o.a.createElement("span",{"data-test-subj":"customQueryPropertyTitle"},m.q),description:o.a.createElement(R,{query:e.query,"data-test-subj":"customQueryPropertyValue"})})),e.type&&i.push({title:T.G,description:o.a.createElement(q,{type:e.type})}),"anomaly_threshold"in e&&e.anomaly_threshold&&i.push({title:o.a.createElement("span",{"data-test-subj":"anomalyThresholdPropertyTitle"},T.b),description:o.a.createElement(V,{anomalyThreshold:e.anomaly_threshold})}),"machine_learning_job_id"in e&&i.push({title:o.a.createElement("span",{"data-test-subj":"mlJobPropertyTitle"},T.v),description:o.a.createElement($,{jobIds:e.machine_learning_job_id,isInteractive:t})}),e.related_integrations&&e.related_integrations.length>0&&i.push({title:o.a.createElement("span",{"data-test-subj":"relatedIntegrationsPropertyTitle"},T.B),description:o.a.createElement(b.b,{relatedIntegrations:e.related_integrations,dataTestSubj:"relatedIntegrationsPropertyValue"})}),e.required_fields&&e.required_fields.length>0&&i.push({title:o.a.createElement("span",{"data-test-subj":"requiredFieldsPropertyTitle"},T.C),description:o.a.createElement(G,{requiredFields:e.required_fields})}),i.push({title:o.a.createElement("span",{"data-test-subj":"timelineTemplatePropertyTitle"},T.V),description:o.a.createElement(U,{timelineTitle:e.timeline_title||v.b})}),"threshold"in e&&e.threshold&&i.push({title:o.a.createElement("span",{"data-test-subj":"thresholdPropertyTitle"},T.U),description:o.a.createElement(B,{threshold:e.threshold})}),"threat_index"in e&&e.threat_index&&i.push({title:o.a.createElement("span",{"data-test-subj":"threatIndexPropertyTitle"},T.R),description:o.a.createElement(H,{threatIndex:e.threat_index})}),"threat_mapping"in e&&e.threat_mapping&&i.push({title:o.a.createElement("span",{"data-test-subj":"threatMappingPropertyTitle"},T.T),description:o.a.createElement(W,{threatMapping:e.threat_mapping})}),"threat_filters"in e&&e.threat_filters&&e.threat_filters.length>0&&i.push({title:o.a.createElement("span",{"data-test-subj":"threatFiltersPropertyTitle"},T.Q),description:o.a.createElement(N,{filters:e.threat_filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"threatFiltersPropertyValue"})}),"threat_query"in e&&e.threat_query&&i.push({title:o.a.createElement("span",{"data-test-subj":"threatQueryPropertyTitle"},m.w),description:o.a.createElement(R,{query:e.threat_query,"data-test-subj":"threatQueryPropertyValue"})}),"new_terms_fields"in e&&e.new_terms_fields&&e.new_terms_fields.length>0&&i.push({title:o.a.createElement("span",{"data-test-subj":"newTermsFieldsPropertyTitle"},T.y),description:o.a.createElement(Y,{newTermsFields:e.new_terms_fields})}),"history_window_start"in e&&i.push({title:o.a.createElement("span",{"data-test-subj":"newTermsWindowSizePropertyTitle"},T.o),description:o.a.createElement(Z,{historyWindowStart:e.history_window_start})}),n&&"alert_suppression"in e&&e.alert_suppression&&("group_by"in e.alert_suppression&&i.push({title:o.a.createElement("span",{"data-test-subj":"alertSuppressionGroupByPropertyTitle"},o.a.createElement(g.a,{label:T.M,ruleType:e.type})),description:o.a.createElement(Q,{fields:e.alert_suppression.group_by})}),i.push({title:o.a.createElement("span",{"data-test-subj":"alertSuppressionDurationPropertyTitle"},o.a.createElement(g.a,{label:T.N,ruleType:e.type})),description:o.a.createElement(K,{duration:e.alert_suppression.duration})}),"missing_fields_strategy"in e.alert_suppression&&i.push({title:o.a.createElement("span",{"data-test-subj":"alertSuppressionMissingFieldPropertyTitle"},o.a.createElement(g.a,{label:T.L,ruleType:e.type})),description:o.a.createElement(J,{missingFieldsStrategy:e.alert_suppression.missing_fields_strategy})})),i})(e,t,u,d);return o.a.createElement("div",{"data-test-subj":n},o.a.createElement(l.EuiDescriptionList,r()({type:null!==(s=i.type)&&void 0!==s?s:"column",rowGutterSize:null!==(c=i.rowGutterSize)&&void 0!==c?c:"m",listItems:p,columnWidths:a,"data-test-subj":"listItemColumnStepRuleDescription"},i)))}},970:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g}));var n=a(4),r=a(157),i=a(19),o=a(2),s=a.n(o),l=a(178);const c=s.a.createElement(i.EuiText,{color:"subdued",size:"xs"},l.uc);var u=a(356),d=a(732);const{emptyField:p}=r.j,m={author:{type:r.a.COMBO_BOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:c,validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:r.i.ARRAY_ITEM,isBlocking:!1}]},name:{type:r.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:r.a.TEXTAREA,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:r.a.CHECKBOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:c},maxSignals:{type:r.a.NUMBER,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.fieldMaxAlertsLabel",{defaultMessage:"Max alerts per run"}),labelAppend:c},isAssociatedToEndpointList:{type:r.a.CHECKBOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:c},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:c,validations:[{validator:(...e)=>{const[{value:t,path:a}]=e;let n=!1;return t.forEach((e=>{Object(u.c)(e)&&(n=!0)})),n?{code:"ERR_FIELD_FORMAT",path:a,message:d.l}:void 0}}]},falsePositives:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:c},investigationFields:{type:r.a.COMBO_BOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldCustomHighlightedFieldsLabel",{defaultMessage:"Custom highlighted fields"}),labelAppend:c},license:{type:r.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:c},ruleNameOverride:{type:r.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:c},threat:{label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK™"}),labelAppend:c},threatIndicatorPath:{type:r.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:c},timestampOverride:{type:r.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:c},timestampOverrideFallbackDisabled:{type:r.a.CHECKBOX,defaultValue:!1,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideFallbackDisabledLabel",{defaultMessage:"Do not use @timestamp as a fallback timestamp field"}),labelAppend:c},tags:{type:r.a.COMBO_BOX,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:c,validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:r.i.ARRAY_ITEM,isBlocking:!1}]},note:{type:r.a.TEXTAREA,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:c},setup:{type:r.a.TEXTAREA,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.setupLabel",{defaultMessage:"Setup guide"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.setupHelpText",{defaultMessage:"Provide instructions on rule prerequisites such as required integrations, configuration steps, and anything else needed for the rule to work correctly."}),labelAppend:c}},b={type:r.a.TEXT,label:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:p(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:r.i.FIELD}]},g={...m,threatIndicatorPath:b}},974:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a(7),i=a(940),o=a.n(i);const s=(e,t)=>null==t?`${Object(r.capitalize)(e)}`:`${Object(r.capitalize)(e)} ${Object(r.capitalize)(t)}`,l=e=>{var t;return null!==(t=o.a.valid(o.a.coerce(e)))&&void 0!==t?t:""},c=(e,t,a)=>`app/integrations/detail/${a?`${e}-${a}`:e}/overview${t?`?integration=${t}`:""}`;var u=a(1323);const d=e=>{const{data:t}=Object(u.a)();return Object(n.useMemo)((()=>{const a=((e,t)=>((e,t)=>{const a=new Map((null!=t?t:[]).map((e=>{var t;return[`${e.package_name}${null!==(t=e.integration_name)&&void 0!==t?t:""}`,e]})));return e.map((e=>{var t;const n=`${e.package}${null!==(t=e.integration)&&void 0!==t?t:""}`,r=a.get(n);return r?{related:e,found:r,isLoaded:!0}:{related:e,isLoaded:!1}}))})(e,t).map((e=>(e=>{var t,a,n;const{related:r,found:i,isLoaded:u}=e,d=r.package,p=null!==(t=r.integration)&&void 0!==t?t:null,m=r.version;if(!u){const e=s(d,p),t=l(m);return{packageName:d,integrationName:p,integrationTitle:e,requiredVersion:m,targetVersion:t,targetUrl:c(d,p,t),installationStatus:{isKnown:!1}}}if(!i){const e=s(d,p),t=l(m);return{packageName:d,integrationName:p,integrationTitle:e,requiredVersion:m,targetVersion:t,targetUrl:c(d,p,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}const b=null!==(a=i.integration_title)&&void 0!==a?a:i.package_title,g=null!==(n=i.installed_package_version)&&void 0!==n?n:"",f=!g||o.a.satisfies(g,m,{includePrerelease:!0}),h=g&&f?g:l(m);return{packageName:d,integrationName:p,integrationTitle:b,requiredVersion:m,targetVersion:h,targetUrl:c(d,p,h),installationStatus:{isKnown:!0,isInstalled:i.is_installed,isEnabled:i.is_enabled,isVersionMismatch:!f,installedVersion:g}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:a,isLoaded:null!=t}}),[e,t])}}}]);