/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[30,15,16,17,28],Array(122).concat([function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(45),i=n(14);const r=Object(i.b)(),s=e=>{const t=o();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},o=()=>Object(a.useSelector)((({app:{enableExperimental:e}})=>e))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(45),i=n(188),r=n.n(i);const s=e=>Object(a.useSelector)(e,a.shallowEqual),o=e=>Object(a.useSelector)(e,r.a)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>Object(a.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return b}));var a=n(44),i=n(2),r=n.n(i),s=n(41),o=n.n(s);const l=n(4).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),u=o.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorDarkShade));u.displayName="EmptyWrapper";const c=()=>"—",d=()=>`(${l})`,m=()=>r.a.createElement(u,null,c()),p=()=>r.a.createElement(u,null,d()),f=e=>null==e?m():Object(a.isString)(e)&&""===e?p():r.a.createElement(r.a.Fragment,null,e),b=e=>null==e?m():""===e?p():r.a.createElement(r.a.Fragment,null,e)},function(e,t,n){"use strict";n.r(t),n.d(t,"parseRoute",(function(){return v})),n.d(t,"manageOldSiemRoutes",(function(){return y})),n.d(t,"getInspectResponse",(function(){return h})),n.d(t,"isDetectionsPath",(function(){return j})),n.d(t,"isDashboardViewPath",(function(){return O})),n.d(t,"isTourPath",(function(){return E})),n.d(t,"isThreatIntelligencePath",(function(){return x})),n.d(t,"getSubPluginRoutesByCapabilities",(function(){return S})),n.d(t,"isSubPluginAvailable",(function(){return w})),n.d(t,"getFieldKey",(function(){return T})),n.d(t,"getField",(function(){return M})),n.d(t,"isTimelineScope",(function(){return I})),n.d(t,"isInTableScope",(function(){return _})),n.d(t,"isAlertsPageScope",(function(){return A})),n.d(t,"getScopedActions",(function(){return P})),n.d(t,"getScopedSelectors",(function(){return D})),n.d(t,"isActiveTimeline",(function(){return F})),n.d(t,"getSourcererScopeId",(function(){return R}));var a=n(748),i=n(44),r=n(2),s=n.n(r),o=n(48),l=n(1630),u=n(1799),c=n(7),d=n(5),m=n(528),p=n(156),f=n(129),b=n(149),g=n(127);const v=e=>{if(!Object(i.isEmpty)(e.hash)){var t;const n=e.hash.split("?"),a=n.length>=1?`?${n[1]}`:"",i=n.length>0?n[0].split("/"):[];return{pageName:i.length>=1?i[1]:"",path:`/${null!==(t=i.slice(2).join("/"))&&void 0!==t?t:""}${a}`,search:a}}const n=e.search,a=e.pathname.split("/");return{pageName:a[3],path:`${a.length>4?`/${a.slice(4).join("/")}`:""}${n}`,search:n}},y=async e=>{const{application:t}=e,{pageName:n,path:a}=v(window.location);switch(n){case p.a.overview:t.navigateToApp(d.m,{deepLinkId:p.a.overview,replace:!0,path:a});break;case"ml-hosts":t.navigateToApp(d.m,{deepLinkId:p.a.hosts,replace:!0,path:`/ml-hosts${a}`});break;case p.a.hosts:t.navigateToApp(d.m,{deepLinkId:p.a.hosts,replace:!0,path:a});break;case"ml-network":t.navigateToApp(d.m,{deepLinkId:p.a.network,replace:!0,path:`/ml-network${a}`});break;case p.a.network:t.navigateToApp(d.m,{deepLinkId:p.a.network,replace:!0,path:a});break;case p.a.timelines:t.navigateToApp(d.m,{deepLinkId:p.a.timelines,replace:!0,path:a});break;case p.a.case:case"case":t.navigateToApp(d.m,{deepLinkId:p.a.case,replace:!0,path:a});break;case p.a.detections:case p.a.alerts:t.navigateToApp(d.m,{deepLinkId:p.a.alerts,replace:!0,path:a});break;case p.a.rules:t.navigateToApp(d.m,{deepLinkId:p.a.rules,replace:!0,path:a});break;case p.a.exceptions:t.navigateToApp(d.m,{deepLinkId:p.a.exceptions,replace:!0,path:a});break;default:t.navigateToApp(d.m,{deepLinkId:p.a.landing,replace:!0,path:a})}},h=(e,t)=>({dsl:Object(c.isObject)(null==e?void 0:e.inspect)&&null!=e&&e.inspect.dsl?e.inspect.dsl:(null==t?void 0:t.dsl)||[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}),j=e=>!!Object(o.matchPath)(e,{path:`(${d.d}|${d.Cc}|${d.Db})`,strict:!1}),O=e=>null!=Object(o.matchPath)(e,{path:`${d.B}/:detailName`,exact:!1,strict:!1}),E=e=>(e=>!!Object(o.matchPath)(e,{path:`${d.d}`,strict:!1}))(e)||(e=>!!Object(o.matchPath)(e,{path:`${d.x}/:detailName`,strict:!1}))(e),x=e=>!!Object(o.matchPath)(e,{path:`(${d.Pc})`,strict:!1}),S=(e,t)=>Object.entries(e).reduce(((e,[n,a])=>{if(w(n,t.application.capabilities))e.push(...a.routes);else{const i=e=>e.siem.privileges;e.push(...a.routes.map((e=>({path:e.path,component:()=>{const e=t.upselling.getPageUpselling(n);return e?s.a.createElement(e,null):s.a.createElement(m.b,{pageName:n,docLinkSelector:i})}}))))}return e}),[]),w=(e,t)=>"cases"===e?!0===t[d.w].read_cases:!0===t[d.Lc].show,k={[a.y]:"signal.rule.id",[a.r]:"signal.rule.name",[`${a.t}.filters`]:"signal.rule.filters",[`${a.t}.language`]:"signal.rule.language",[`${a.t}.query`]:"signal.rule.query"},C={"signal.rule.id":a.y,"signal.rule.name":a.r,"signal.rule.filters":`${a.t}.filters`,"signal.rule.language":`${a.t}.language`,"signal.rule.query":`${a.t}.query`},T=(e,t)=>{var n,a;const r=(null!==(n=C[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),s=(null!==(a=k[t])&&void 0!==a?a:t).replace("kibana.alert","signal");return Object(i.has)(r,e)?r:s},M=(e,t)=>{var n,a,r;const s=(null!==(n=C[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),o=(null!==(a=k[t])&&void 0!==a?a:t).replace("kibana.alert","signal"),l=s.split(".");if(l.includes("parameters")&&"parameters"!==l[l.length-1]){const t=l.slice(0,l.length-1).join("."),n=Object(i.get)(t,e);return Object(i.get)(l[l.length-1],n)}return null!==(r=Object(i.get)(s,e))&&void 0!==r?r:Object(i.get)(o,e)},I=e=>Object.values(b.f).includes(e),_=e=>Object.values(l.b).includes(e),A=e=>[l.b.alertsOnAlertsPage,l.b.alertsOnRuleDetailsPage,l.b.alertsOnCasePage].includes(e),P=e=>I(e)?f.a:_(e)?u.a:void 0,D=e=>I(e)?f.a:_(e)?u.a:void 0,F=e=>e===b.f.active,R=e=>I(e)?g.SourcererScopeName.timeline:A(e)?g.SourcererScopeName.detections:g.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n(45),r=n(166),s=n(127),o=n(531),l=n(294),u=n(252),c=n(308),d=n(1276),m=n(895);const p=(e=s.SourcererScopeName.default)=>{const t=Object(i.useSelector)(r.d.kibanaDataViews),n=Object(i.useSelector)(r.d.signalIndexName),p=Object(i.useSelector)(r.d.defaultDataView),f=Object(i.useSelector)((t=>r.d.sourcererScopeSelectedDataViewId(t,e))),b=Object(a.useMemo)((()=>t.find((e=>e.id===f))),[t,f]),g=Object(i.useSelector)((t=>r.d.sourcererScopeIsLoading(t,e))),v=Object(i.useSelector)((t=>r.d.sourcererScopeSelectedPatterns(t,e))),y=Object(i.useSelector)((t=>r.d.sourcererScopeMissingPatterns(t,e))),h=Object(a.useMemo)((()=>Object(c.b)(v)),[v]),[j,O]=Object(a.useState)([]),[E,x]=Object(u.b)(j),S=Object(a.useMemo)((()=>{var e,t,n,a,i,r,s;return{...x,dataView:x.dataView,runtimeMappings:null!==(e=null===(t=x.dataView)||void 0===t?void 0:t.runtimeFieldMap)&&void 0!==e?e:{},title:null!==(n=null===(a=x.dataView)||void 0===a?void 0:a.title)&&void 0!==n?n:"",id:null!==(i=null===(r=x.dataView)||void 0===r?void 0:r.id)&&void 0!==i?i:null,loading:E,patternList:x.indexes,indexFields:x.indexPatterns.fields,fields:null===(s=x.dataView)||void 0===s?void 0:s.fields}}),[x,E]);Object(a.useEffect)((()=>{null==b||y.length>0?O(h):O([])}),[y,b,h]);const w=Object(a.useMemo)((()=>{const e=null==b||y.length>0?S:b;return{...e,dataView:{...e.dataView,title:h.join(","),name:h.join(",")}}}),[S,y.length,b,h]),k=Object(a.useMemo)((()=>!(!g&&!w.loading)||Object(o.a)({scopeId:e,signalIndexName:n,patternList:w.patternList,isDefaultDataViewSelected:w.id===p.id})),[p.id,g,e,n,w.id,w.loading,w.patternList]),C=Object(a.useCallback)((()=>{const{browserFields:e}=Object(l.a)(w.patternList.join(","),w.fields);return e}),[w.fields,w.patternList]);return((e,t)=>{const n=Object(i.useSelector)(m.a),r=Object(a.useMemo)((()=>({...n,browserFields:t.browserFields,sourcererDataView:t.sourcererDataView})),[n,t.browserFields,t.sourcererDataView]);return Object(d.a)()?r:t})(0,Object(a.useMemo)((()=>({browserFields:C(),dataViewId:w.id,indexPattern:{fields:w.indexFields,title:h.join(","),getName:()=>h.join(",")},indicesExist:k,loading:g||w.loading,runtimeMappings:w.runtimeMappings,patternList:w.title.split(","),selectedPatterns:h,...j.length>0?{activePatterns:w.patternList}:{},sourcererDataView:w.dataView})),[C,w,h,k,g,j.length]))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y}));var a=n(19),i=n(2),r=n.n(i),s=n(41),o=n.n(s),l=n(363),u=n(222),c=n(130),d=n(179),m=n(416);const p=({field:e,tooltipContent:t})=>null!=t?t:e,f=r.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:i,value:s})=>(e=>null===e)(n)?r.a.createElement(r.a.Fragment,null,e||s):r.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:p({tooltipContent:n,field:t})},r.a.createElement(r.a.Fragment,null,e||s))));f.displayName="Content";const b=r.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:s="",isAggregatable:o=!1,value:c,name:p,children:b,scopeId:g,tooltipContent:v,tooltipPosition:y,queryValue:h,truncate:j})=>{const O=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(u.h)(t),name:p||(null!==(e=null==c?void 0:c.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:h||(null!=c?c:""),operator:d.d}}}),[a,t,p,h,c]),E=Object(i.useCallback)(((e,t,n)=>n.isDragging?r.a.createElement(l.a,null,r.a.createElement(m.a,{dataProvider:e})):r.a.createElement(f,{field:a,tooltipContent:v,tooltipPosition:y,value:c},b)),[b,a,v,y,c]);return null==c?null:r.a.createElement(l.b,{dataProvider:O,fieldType:s,isAggregatable:o,hideTopN:e,isDraggable:n,render:E,scopeId:g,truncate:j})}));b.displayName="DefaultDraggable";const g=o()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);g.displayName="Badge";const v=({contextId:e,eventId:t,field:n,value:a,iconType:i,isDraggable:s,isAggregatable:o,fieldType:l,name:u,color:d="hollow",children:m,scopeId:p,tooltipContent:f,queryValue:v})=>null!=a?r.a.createElement(b,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:s,isAggregatable:o,fieldType:l,field:n,name:u,value:a,scopeId:p,tooltipContent:f,queryValue:v},r.a.createElement(g,{iconType:i,color:d,title:""},m||(""!==a?a:Object(c.c)()))):null;v.displayName="DraggableBadgeComponent";const y=r.a.memo(v);y.displayName="DraggableBadge"},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(739);const r=()=>Object(a.useContext)(i.a)},,,,function(e,t,n){"use strict";n.d(t,"g",(function(){return O.d})),n.d(t,"f",(function(){return O.c})),n.d(t,"o",(function(){return k})),n.d(t,"m",(function(){return M})),n.d(t,"d",(function(){return _})),n.d(t,"h",(function(){return F})),n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return z})),n.d(t,"i",(function(){return L})),n.d(t,"e",(function(){return B})),n.d(t,"b",(function(){return q})),n.d(t,"j",(function(){return H})),n.d(t,"n",(function(){return Q})),n.d(t,"l",(function(){return W})),n.d(t,"k",(function(){return K}));var a=n(19),i=n(2),r=n.n(i),s=n(44),o=n(305),l=n(170),u=n(256),c=n(5),d=n(433),m=n(194),p=n(409),f=n(118),b=n(356),g=n(4),v=n(378);const y=e=>g.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var h=n(156),j=n(560),O=n(312),E=n(119),x=n.n(E),S=n(454),w=n(529);const k=()=>{const e=Object(S.e)(),t=Object(w.a)();return Object(i.useCallback)((({deepLinkId:n,path:a,onClick:i})=>{const r=t(n);return e({id:n,path:a,urlState:r,onClick:i})}),[e,t])},C=e=>(e=>r.a.memo((function({deepLinkId:t,...n}){const a=Object(w.a)()(t);return r.a.createElement(e,x()({id:t,urlState:a},n))})))(Object(S.g)(e)),T=({children:e,Component:t,userName:n,isButton:a,onClick:s,title:o,userTab:l})=>{const u=encodeURIComponent(n),{formatUrl:d,search:p}=Object(m.l)(h.a.users),{application:{navigateToApp:b},telemetry:g}=Object(f.j)().services,v=Object(i.useCallback)((e=>{e.preventDefault(),b(c.m,{deepLinkId:h.a.users,path:l?Object(j.a)(u,l,p):Object(j.c)(u,p)})}),[u,b,p,l]),y=Object(i.useMemo)((()=>d(l?Object(j.a)(u,l):Object(j.c)(u))),[d,u,l]),E=Object(i.useCallback)((e=>{g.reportEntityDetailsClicked({entity:"user"}),(null!=s?s:v)(e)}),[v,s,g]);return a?r.a.createElement(O.b,{Component:t,dataTestSubj:"data-grid-user-details",href:y,onClick:E,title:null!=o?o:n},e||n):r.a.createElement(O.c,{"data-test-subj":"users-link-anchor",onClick:E,href:y},e||n)},M=r.a.memo(T),I=({children:e,Component:t,hostName:n,isButton:a,onClick:s,title:o,hostTab:l})=>{const{formatUrl:u,search:d}=Object(m.l)(h.a.hosts),{application:{navigateToApp:p},telemetry:b}=Object(f.j)().services,g=encodeURIComponent(n),v=Object(i.useCallback)((e=>{e.preventDefault(),p(c.m,{deepLinkId:h.a.hosts,path:l?Object(m.i)(g,l,d):Object(m.d)(g,d)})}),[g,p,d,l]),y=Object(i.useMemo)((()=>u(l?Object(m.i)(g,l):Object(m.d)(g))),[u,g,l]),j=Object(i.useCallback)((e=>{b.reportEntityDetailsClicked({entity:"host"}),(null!=s?s:v)(e)}),[v,s,b]);return a?r.a.createElement(O.b,{Component:t,dataTestSubj:"data-grid-host-details",href:y,iconType:"expand",onClick:j,title:null!=o?o:n},e):r.a.createElement(O.c,{onClick:j,href:y,"data-test-subj":"host-details-button"},e||n)},_=r.a.memo(I),A=["http://","https://"],P=r.a.memo((({url:e,children:t,idx:n,overflowIndexStart:i=5,allItemsLimit:o=5})=>{const l=i-1,u=o-1,c=Math.max(0,Math.min(l,u)),d=A.some((t=>0===e.indexOf(t)));return e&&d&&!Object(b.c)(e)&&t?r.a.createElement(a.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(s.isNil)(n)&&n<c&&r.a.createElement(O.a,{"data-test-subj":"externalLinkComma"}))):null}));P.displayName="ExternalLink";const D=({Component:e,children:t,ip:n,flowTarget:a=p.a.source,isButton:o,onClick:l,title:u})=>{const c=k(),f=Object(i.useCallback)(((n,i)=>{const{onClick:s,href:p}=c({deepLinkId:h.a.network,path:Object(m.f)(encodeURIComponent(Object(d.c)(n)),a)}),f=null!=l?l:e=>s(e);return o?r.a.createElement(O.b,{Component:e,key:`${n}-${i}`,dataTestSubj:"data-grid-network-details",onClick:f,href:p,title:null!=u?u:n},t):r.a.createElement(O.c,{key:`${n}-${i}`,onClick:f,href:p,"data-test-subj":"network-details"},t||n)}),[t,e,a,c,l,o,u]);return Object(s.isArray)(n)?r.a.createElement(r.a.Fragment,null,n.map(f)):f(n,0)},F=r.a.memo(D),R=({index:e,children:t,detailName:n,title:a})=>{const{formatUrl:s,search:d}=Object(m.l)(h.a.case),{navigateToApp:p}=Object(f.j)().services.application,{activeStep:b,isTourShown:g}=Object(u.b)(),v=Object(i.useMemo)((()=>b===l.a.viewCase&&g(l.b.alertsCases)&&0===e),[b,e,g]),j=Object(i.useCallback)((async e=>(e&&e.preventDefault(),p(c.m,{deepLinkId:h.a.case,path:Object(m.a)({id:n,search:d})}))),[n,p,d]);return Object(i.useEffect)((()=>{var e;v&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[v]),r.a.createElement(o.a,{onClick:j,isTourAnchor:v,step:l.a.viewCase,tourId:l.b.alertsCases},r.a.createElement(O.c,{onClick:j,href:s(Object(m.a)({id:n})),"data-test-subj":"case-details-link","aria-label":y(null!=a?a:n)},t||n))},N=r.a.memo(R);N.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(m.l)(h.a.case),{navigateToApp:a}=Object(f.j)().services.application,s=Object(i.useCallback)((async e=>(e.preventDefault(),a(c.m,{deepLinkId:h.a.case,path:Object(m.b)(n)}))),[a,n]);return r.a.createElement(O.c,{onClick:s,href:t(Object(m.b)())},e)})).displayName="CreateCaseLink";const z=r.a.memo((({children:e,link:t})=>{const n=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(P,{url:n},e||t)}));z.displayName="GoogleLink";const L=r.a.memo((({Component:e,title:t,children:n,portOrServiceName:s})=>{var o;const l=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(s))}`),[s]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(o=null!=t?t:n)&&void 0!==o?o:s):r.a.createElement(O.e,null,r.a.createElement(a.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||s))}));L.displayName="PortOrServiceNameLink";const B=r.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));B.displayName="Ja3FingerprintLink";const q=r.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));q.displayName="CertificateFingerprintLink";var V=function(e){return e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com",e}(V||{});function $(e){return e===V["virustotal.com"]||e===V["talosIntelligence.com"]}const U={[V["virustotal.com"]]:v.m,[V["talosIntelligence.com"]]:v.l},G=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:o,direction:l="row"})=>{const[u]=Object(f.o)(c.Pb),d=Object(i.useMemo)((()=>null==u?void 0:u.slice(0,t).filter((({url_template:e,name:t})=>!Object(s.isNil)(e)&&!Object(s.isNil)(t)&&!Object(b.c)(e))).map((({name:e,url_template:t})=>({name:$(e)?U[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(o))})))),[u,o,U,t]),m=Object(i.useCallback)((n=>{var a;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&r.a.createElement(P,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(a=n.name)&&void 0!==a?a:o))}),[t,o,e]);return(null==d?void 0:d.length)>0?r.a.createElement("section",null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:l,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(a.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:a},i)=>r.a.createElement(P,{allItemsLimit:d.length,idx:i,overflowIndexStart:e,url:a,"data-test-subj":"externalLinkComponent",key:`reputationLink-${i}`},r.a.createElement(r.a.Fragment,null,n?o:null!=t?t:o))))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(O.f,{rowItems:d,render:m,moreMaxHeight:"200px",overflowIndexStart:e})))):null};G.displayName="ReputationLinkComponent";const H=r.a.memo(G),Q=r.a.memo((({children:e,domain:t})=>{const n=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(P,{url:n},e||t)}));Q.displayName="WhoIsLink";const W=C(O.d),K=C(O.c)},function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l}));const a="document-details-right",i="document-details-left",r="document-details-preview",s="document-details-isolate-host",o="document-details-alert-reason",l="document-details-rule-overview"},,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var a=n(73),i=n.n(a),r=n(2),s=n.n(r),o=n(42),l=n(118),u=n(130),c=n(754),d=n(1270);const m=s.a.memo((({value:e,dateFormat:t=Object(l.h)()})=>s.a.createElement(s.a.Fragment,null,i.a.tz(e,Object(l.m)()).format(t))));m.displayName="PreferenceFormattedDate";const p=({value:e})=>{if(null==e)return Object(u.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(u.f)(e);const n=t.toDate();return s.a.createElement(m,{value:n})};p.displayName="PreferenceFormattedDateFromPrimitive";const f=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,b=s.a.memo((({value:e})=>{const[t]=Object(l.o)("dateFormat:scaled"),n=Array.isArray(t)?t.find(f):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return s.a.createElement(m,{dateFormat:a,value:e})}));b.displayName="PreferenceFormattedP1DTDate";const g=s.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a,tooltipProps:i})=>{if(null==e)return Object(u.f)(e);const r=Object(d.a)(e);return r.isValid()?s.a.createElement(c.a,{date:r.toDate(),fieldName:t,className:n,tooltipProps:i},s.a.createElement(m,{value:r.toDate(),dateFormat:a})):Object(u.f)(e)}));g.displayName="FormattedDate";const v=s.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:r=1})=>{if(null==e)return Object(u.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(u.f)(e);const p=l.toDate(),f=i()(p).add(r,"hours").isBefore(new Date);return s.a.createElement(c.a,{date:p,fieldName:n,className:a},f?s.a.createElement(m,{"data-test-subj":"preference-time",value:p,dateFormat:t}):s.a.createElement(o.FormattedRelative,{"data-test-subj":"relative-time",value:p}))}));v.displayName="FormattedRelativePreferenceDate"},function(e,t,n){"use strict";e.exports=n(722)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=n(34).__importDefault(n(993));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},,function(e,t,n){"use strict";var a=n(5);n.d(t,"a",(function(){return a.Oc}))},function(e,t,n){"use strict";var a=n(51);n.d(t,"l",(function(){return a.getUseField})),n.d(t,"k",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"g",(function(){return a.UseField})),n.d(t,"h",(function(){return a.UseMultiFields})),n.d(t,"f",(function(){return a.UseArray})),n.d(t,"m",(function(){return a.useForm})),n.d(t,"n",(function(){return a.useFormContext})),n.d(t,"o",(function(){return a.useFormData})),n.d(t,"i",(function(){return a.VALIDATION_TYPES}));var i=n(62);n.d(t,"b",(function(){return i.Field})),n.d(t,"e",(function(){return i.SelectField})),n.d(t,"d",(function(){return i.HiddenField}));var r=n(77);n.d(t,"j",(function(){return r.fieldValidators}))},,function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"y",(function(){return p})),n.d(t,"p",(function(){return f})),n.d(t,"v",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"e",(function(){return O})),n.d(t,"q",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"n",(function(){return S})),n.d(t,"i",(function(){return w})),n.d(t,"l",(function(){return k})),n.d(t,"a",(function(){return C})),n.d(t,"o",(function(){return T})),n.d(t,"c",(function(){return M})),n.d(t,"m",(function(){return I})),n.d(t,"x",(function(){return _})),n.d(t,"w",(function(){return A})),n.d(t,"r",(function(){return P})),n.d(t,"s",(function(){return D})),n.d(t,"t",(function(){return F})),n.d(t,"u",(function(){return R}));var a=n(23),i=n(69),r=n(67),s=n(811),o=n(232),l=n(5),u=n(440),c=n(501),d=n(118);n(178);const m=async({rule:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),p=async({rule:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({rule:e,signal:t})=>d.b.get().http.fetch(l.pb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:a})=>{const i=Object(s.a)(e),r={page:n.page,per_page:n.perPage,sort_field:t.field,sort_order:t.order,...""!==i?{filter:i}:{}};return d.b.get().http.fetch(l.rb,{method:"GET",version:"2023-10-31",query:r,signal:a})},v=async({id:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),y=async({ids:e,signal:t})=>{var n;return null===(n=(await d.b.get().http.fetch(a.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===n?void 0:n.reduce(((e,{id:t,...n})=>{var a,i;return e[t]={muteAll:null!==(a=n.mute_all)&&void 0!==a&&a,activeSnoozes:null!==(i=n.active_snoozes)&&void 0!==i?i:[],isSnoozedUntil:n.is_snoozed_until?new Date(n.is_snoozed_until):void 0,snoozeSchedule:n.snooze_schedule},e}),{})},h=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),j=async({filter:e,signal:t})=>d.b.get().http.fetch(o.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),O=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function E({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===o.b.edit?e.editPayload:void 0,duplicate:e.type===o.b.duplicate?e.duplicatePayload:void 0,run:e.type===o.b.run?e.runPayload:void 0};return d.b.get().http.fetch(l.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(n),query:{dry_run:t}})}async function x(e){const t={action:o.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(l.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const S=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,overwriteActionConnectors:a=!1,signal:i})=>{const r=new FormData;return r.append("file",e),d.b.get().http.fetch(`${l.qb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n,overwrite_action_connectors:a},body:r,signal:i})},w=async({signal:e})=>d.b.get().http.fetch(o.g,{method:"GET",version:"1",signal:e}),k=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(c.a,{method:"GET",version:"1",query:n,signal:t})},C=async({ruleId:e,items:t,signal:n})=>d.b.get().http.fetch(`${l.qb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:n}),T=({packageName:e,packageVersion:t,prerelease:n=!1,force:a=!0})=>d.b.get().http.post(r.epmRouteService.getInstallPath(e,t),{query:{prerelease:n},version:"2023-10-31",body:JSON.stringify({force:a})}),M=({packages:e,prerelease:t=!1})=>d.b.get().http.post(r.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),I=async({signal:e})=>d.b.get().http.fetch(u.a,{method:"GET",version:"1",signal:e}),_=async({signal:e})=>d.b.get().http.fetch(u.f,{method:"POST",version:"1",signal:e}),A=async({signal:e})=>d.b.get().http.fetch(u.e,{method:"POST",version:"1",signal:e}),P=async()=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),D=async e=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),F=async()=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),R=async e=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(44),i=n(2),r=n(45),s=n(138),o=n(124),l=n(148),u=n(200);const c=()=>{const e=Object(r.useDispatch)(),{from:t,to:n}=Object(o.a)((e=>Object(a.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[c,d]=Object(i.useState)(!0),m=Object(i.useRef)([]),p=Object(i.useCallback)((({id:t,inspect:n,loading:a,refetch:i,searchSessionId:r})=>{m.current=[...m.current,t],e(u.c.setQuery({inputId:s.a.global,id:t,inspect:n,loading:a,refetch:i,searchSessionId:r}))}),[e]),f=Object(i.useCallback)((({id:t})=>e(u.c.deleteOneQuery({inputId:s.a.global,id:t}))),[e]);return Object(i.useEffect)((()=>{d(!1)}),[]),Object(i.useEffect)((()=>()=>{m.current.length>0&&m.current.forEach((e=>f({id:e})))}),[f]),Object(i.useMemo)((()=>({isInitializing:c,from:t,to:n,setQuery:p,deleteQuery:f})),[f,t,c,p,n])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"y",(function(){return v})),n.d(t,"A",(function(){return y})),n.d(t,"B",(function(){return h})),n.d(t,"C",(function(){return j})),n.d(t,"D",(function(){return O})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return x})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return w})),n.d(t,"E",(function(){return k})),n.d(t,"F",(function(){return C})),n.d(t,"G",(function(){return T})),n.d(t,"I",(function(){return M})),n.d(t,"J",(function(){return I})),n.d(t,"K",(function(){return _})),n.d(t,"L",(function(){return A})),n.d(t,"X",(function(){return P})),n.d(t,"Y",(function(){return D})),n.d(t,"Z",(function(){return F})),n.d(t,"ab",(function(){return R})),n.d(t,"z",(function(){return N})),n.d(t,"bb",(function(){return z})),n.d(t,"cb",(function(){return L})),n.d(t,"M",(function(){return B})),n.d(t,"N",(function(){return q})),n.d(t,"P",(function(){return V})),n.d(t,"S",(function(){return $})),n.d(t,"T",(function(){return U})),n.d(t,"Q",(function(){return G})),n.d(t,"R",(function(){return H})),n.d(t,"W",(function(){return Q})),n.d(t,"V",(function(){return W})),n.d(t,"s",(function(){return K})),n.d(t,"r",(function(){return J})),n.d(t,"w",(function(){return Y})),n.d(t,"O",(function(){return X})),n.d(t,"x",(function(){return Z})),n.d(t,"H",(function(){return ee})),n.d(t,"U",(function(){return te})),n.d(t,"t",(function(){return ne})),n.d(t,"v",(function(){return ae})),n.d(t,"u",(function(){return ie}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),r=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),w=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),C=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),T=(a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timeline…"}),a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"})),M=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),I=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),P=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),z=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),L=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),B=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),V=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),$=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),G=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),Q=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),Z=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),ee=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),te=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ne=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ae=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Import…"}),ie=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},function(e,t,n){const a=n(347),{MAX_LENGTH:i,MAX_SAFE_INTEGER:r}=n(348),{safeRe:s,t:o}=n(311),l=n(431),{compareIdentifiers:u}=n(558);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[o.LOOSE]:s[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(a("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===n&&(a=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"n",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"m",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"p",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"o",(function(){return b})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return j}));var a=n(7),i=n(20);const r=e=>{if(null!=e){const t=e.trim().split(/[ \t\r\n]+/);return"sequence"===t[0]&&"where"!==t[1]}return!1},s=e=>"eql"===e,o=e=>"threshold"===e,l=e=>"query"===e||"saved_query"===e,u=e=>"threat_match"===e,c=e=>"machine_learning"===e,d=e=>"new_terms"===e,m=e=>"esql"===e,p=e=>Array.isArray(e)?e:Object(a.isEmpty)(e)?[]:[e],f=e=>{var t;return null!==(t=null==e?void 0:e.trim().startsWith("sequence"))&&void 0!==t&&t},b=e=>Array.isArray(e)?e:[e],g=e=>i.e.includes(e),v=e=>g(e),y=e=>!o(e)&&g(e),h=e=>!o(e)&&g(e),j=e=>g(e)&&i.f.includes(e)},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return m}));var a=n(4);let i=function(e){return e.rules="rules",e.alertsCases="alertsCases",e}({}),r=function(e){return e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase",e}({});const s={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},o=(e,t)=>`tourStepAnchor-${t}-${e}`,l={[i.alertsCases]:[r.pointToAlertName,r.expandEvent]},u={[i.alertsCases]:[r.pointToAlertName,r.expandEvent,r.reviewAlertDetailsFlyout,r.addAlertToCase,r.viewCase]},c=[{...s,step:r.pointToAlertName,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:o(r.pointToAlertName,i.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...s,step:r.expandEvent,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:o(r.expandEvent,i.alertsCases)},{...s,step:r.reviewAlertDetailsFlyout,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${o(r.reviewAlertDetailsFlyout,i.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:o(r.reviewAlertDetailsFlyout,i.alertsCases)},{...s,step:r.addAlertToCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:o(r.addAlertToCase,i.alertsCases)},{...s,step:r.createCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:o(r.createCase,i.alertsCases),offset:20,repositionOnScroll:!1},{...s,step:r.submitCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:o(r.submitCase,i.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...s,step:r.viewCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:o(r.viewCase,i.alertsCases)}],d={title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},m={[i.rules]:[],[i.alertsCases]:c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},,function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return f}));var a=n(119),i=n.n(a),r=n(360),s=n(2),o=n.n(s),l=n(236);n.d(t,"d",(function(){return l.e})),n.d(t,"b",(function(){return l.d}));var u=n(127),c=n(814),d=n(904),m=n(475);n.d(t,"a",(function(){return m.b}));const p=r.c,f=({sourcererScopeId:e=u.SourcererScopeName.default,data:t,metadata:n,children:a,...l})=>{const m=Object(c.a)(e),p=Object(d.a)(e),f=JSON.stringify(t),b=Object(s.useMemo)((()=>(Array.isArray(t)?t:[t]).map((({field:e,value:t})=>({field:m(e),value:t}))).filter((e=>!!e.field))),[f,m]),g=Object(s.useMemo)((()=>({...n,dataViewId:p})),[p,n]);return b.length>0?o.a.createElement(r.a,i()({data:b,metadata:g},l),a):o.a.createElement(o.a.Fragment,null,a)}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return We})),n.d(t,"c",(function(){return Ke})),n.d(t,"f",(function(){return Je})),n.d(t,"d",(function(){return Ye})),n.d(t,"e",(function(){return Xe}));var a=n(120),i=n(199),r=n(464),s=n(466),o=n(463),l=n(467),u=n(468),c=n(469),d=n(470);const m=a.z.object({name:i.K,description:i.B,risk_score:i.r,severity:i.Y}),p=a.z.object({rule_name_override:i.L.optional(),timestamp_override:i.db.optional(),timestamp_override_fallback_disabled:i.eb.optional(),timeline_id:i.bb.optional(),timeline_title:i.cb.optional(),outcome:i.V.optional(),alias_target_id:i.U.optional(),alias_purpose:i.T.optional(),license:i.I.optional(),note:i.j.optional(),building_block_type:i.f.optional(),output_index:i.d.optional(),namespace:i.e.optional(),meta:i.J.optional(),investigation_fields:i.i.optional(),throttle:i.z.optional()}),f=a.z.object({version:i.S.optional(),tags:i.R.optional(),enabled:i.k.optional(),risk_score_mapping:i.s.optional(),severity_mapping:i.Z.optional(),interval:i.F.optional(),from:i.G.optional(),to:i.H.optional(),actions:a.z.array(i.t).optional(),exceptions_list:a.z.array(i.C).optional(),author:i.A.optional(),false_positives:i.D.optional(),references:i.O.optional(),max_signals:i.n.optional(),threat:i.ab.optional(),setup:i.X.optional(),related_integrations:i.o.optional(),required_fields:a.z.array(i.q).optional()}),b=m.merge(p).merge(f),g=m.partial().merge(p).merge(f),v=m.merge(p).merge(f.required()),y=a.z.object({id:i.M,rule_id:i.P,immutable:i.l,rule_source:i.Q.optional(),updated_at:a.z.string().datetime(),updated_by:a.z.string(),created_at:a.z.string().datetime(),created_by:a.z.string(),revision:a.z.number().int().min(0),required_fields:i.p,execution_summary:r.a.optional()}),h=b.merge(a.z.object({rule_id:i.P.optional()})),j=b.merge(a.z.object({id:i.M.optional(),rule_id:i.P.optional()})),O=g.merge(a.z.object({id:i.M.optional(),rule_id:i.P.optional()})),E=v.merge(y),x=a.z.literal("eql"),S=a.z.object({type:a.z.literal("eql"),query:i.N,language:x}),w=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),event_category_override:s.a.optional(),tiebreaker_field:s.b.optional(),timestamp_field:s.c.optional(),alert_suppression:i.a.optional()}),k=S.merge(w),C=S.merge(w),T=S.partial().merge(w),M=E.merge(C),I=h.merge(k),_=j.merge(k),A=O.merge(T),P=a.z.object({type:a.z.literal("query")}),D=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:i.a.optional()}),F=a.z.object({query:i.N.optional(),language:i.m.optional()}),R=P.merge(D).merge(F),N=P.partial().merge(D).merge(F),z=P.merge(D).merge(F.required()),L=E.merge(z),B=h.merge(R),q=j.merge(R),V=O.merge(N),$=a.z.object({type:a.z.literal("saved_query"),saved_id:i.W}),U=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:i.a.optional(),query:i.N.optional()}),G=a.z.object({language:i.m.optional()}),H=$.merge(U).merge(G),Q=$.partial().merge(U).merge(G),W=$.merge(U).merge(G.required()),K=E.merge(W),J=h.merge(H),Y=j.merge(H),X=O.merge(Q),Z=a.z.object({type:a.z.literal("threshold"),query:i.N,threshold:l.a}),ee=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),alert_suppression:l.b.optional()}),te=a.z.object({language:i.m.optional()}),ne=Z.merge(ee).merge(te),ae=Z.partial().merge(ee).merge(te),ie=Z.merge(ee).merge(te.required()),re=E.merge(ie),se=h.merge(ne),oe=j.merge(ne),le=O.merge(ae),ue=a.z.object({type:a.z.literal("threat_match"),query:i.N,threat_query:u.g,threat_mapping:u.f,threat_index:u.d}),ce=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),threat_filters:u.c.optional(),threat_indicator_path:u.e.optional(),threat_language:i.m.optional(),concurrent_searches:u.a.optional(),items_per_search:u.b.optional(),alert_suppression:i.a.optional()}),de=a.z.object({language:i.m.optional()}),me=ue.merge(ce).merge(de),pe=ue.partial().merge(ce).merge(de),fe=ue.merge(ce).merge(de.required()),be=E.merge(fe),ge=h.merge(me),ve=j.merge(me),ye=O.merge(pe),he=a.z.object({type:a.z.literal("machine_learning"),anomaly_threshold:c.a,machine_learning_job_id:c.b}),je=a.z.object({alert_suppression:i.a.optional()}),Oe=he.partial().merge(je),Ee=he.merge(je),xe=he.merge(je),Se=E.merge(Ee),we=h.merge(xe),ke=j.merge(xe),Ce=O.merge(Oe),Te=a.z.object({type:a.z.literal("new_terms"),query:i.N,new_terms_fields:d.b,history_window_start:d.a}),Me=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),alert_suppression:i.a.optional()}),Ie=a.z.object({language:i.m.optional()}),_e=Te.partial().merge(Me).merge(Ie),Ae=Te.merge(Me).merge(Ie.required()),Pe=Te.merge(Me).merge(Ie),De=E.merge(Ae),Fe=h.merge(Pe),Re=j.merge(Pe),Ne=O.merge(_e),ze=a.z.literal("esql"),Le=a.z.object({type:a.z.literal("esql"),language:ze,query:i.N}),Be=a.z.object({alert_suppression:i.a.optional()}),qe=Be.merge(Le.partial()),Ve=Be.merge(Le),$e=Be.merge(Le),Ue=E.merge(Ve),Ge=h.merge($e),He=j.merge($e),Qe=O.merge(qe.partial()),We=a.z.discriminatedUnion("type",[k,R,H,ne,me,xe,Pe,$e]),Ke=(a.z.union([T,N,Q,ae,pe,Oe,_e,qe]),a.z.discriminatedUnion("type",[C,z,W,ie,fe,Ee,Ae,Ve]),a.z.discriminatedUnion("type",[I,B,J,se,ge,we,Fe,Ge])),Je=a.z.discriminatedUnion("type",[_,q,Y,oe,ve,ke,Re,He]),Ye=a.z.union([A,V,X,le,ye,Ce,Ne,Qe]),Xe=a.z.discriminatedUnion("type",[M,L,K,re,be,Se,De,Ue])},,function(e,t,n){"use strict";n.d(t,"xc",(function(){return i})),n.d(t,"dc",(function(){return r})),n.d(t,"fc",(function(){return s})),n.d(t,"zd",(function(){return o})),n.d(t,"yd",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"wc",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"Tb",(function(){return m})),n.d(t,"yc",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"t",(function(){return b})),n.d(t,"r",(function(){return g})),n.d(t,"u",(function(){return v})),n.d(t,"x",(function(){return y})),n.d(t,"s",(function(){return h})),n.d(t,"n",(function(){return j})),n.d(t,"v",(function(){return O})),n.d(t,"A",(function(){return E})),n.d(t,"g",(function(){return x})),n.d(t,"o",(function(){return S})),n.d(t,"j",(function(){return w})),n.d(t,"q",(function(){return k})),n.d(t,"w",(function(){return C})),n.d(t,"h",(function(){return T})),n.d(t,"p",(function(){return M})),n.d(t,"k",(function(){return I})),n.d(t,"i",(function(){return _})),n.d(t,"z",(function(){return A})),n.d(t,"y",(function(){return P})),n.d(t,"ib",(function(){return D})),n.d(t,"gb",(function(){return F})),n.d(t,"hb",(function(){return R})),n.d(t,"kb",(function(){return N})),n.d(t,"mb",(function(){return z})),n.d(t,"E",(function(){return L})),n.d(t,"m",(function(){return B})),n.d(t,"C",(function(){return q})),n.d(t,"l",(function(){return V})),n.d(t,"D",(function(){return $})),n.d(t,"jb",(function(){return U})),n.d(t,"lb",(function(){return G})),n.d(t,"pb",(function(){return H})),n.d(t,"ob",(function(){return Q})),n.d(t,"nb",(function(){return W})),n.d(t,"eb",(function(){return K})),n.d(t,"T",(function(){return J})),n.d(t,"F",(function(){return Y})),n.d(t,"V",(function(){return X})),n.d(t,"G",(function(){return Z})),n.d(t,"I",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"H",(function(){return ne})),n.d(t,"U",(function(){return ae})),n.d(t,"W",(function(){return ie})),n.d(t,"X",(function(){return re})),n.d(t,"P",(function(){return se})),n.d(t,"bb",(function(){return oe})),n.d(t,"Q",(function(){return le})),n.d(t,"fb",(function(){return ue})),n.d(t,"S",(function(){return ce})),n.d(t,"R",(function(){return de})),n.d(t,"cb",(function(){return me})),n.d(t,"db",(function(){return pe})),n.d(t,"N",(function(){return fe})),n.d(t,"M",(function(){return be})),n.d(t,"L",(function(){return ge})),n.d(t,"K",(function(){return ve})),n.d(t,"O",(function(){return ye})),n.d(t,"Z",(function(){return he})),n.d(t,"Y",(function(){return je})),n.d(t,"ab",(function(){return Oe})),n.d(t,"Yb",(function(){return Ee})),n.d(t,"od",(function(){return xe})),n.d(t,"nd",(function(){return Se})),n.d(t,"td",(function(){return we})),n.d(t,"rd",(function(){return ke})),n.d(t,"rb",(function(){return Ce})),n.d(t,"qd",(function(){return Te})),n.d(t,"Ub",(function(){return Me})),n.d(t,"jc",(function(){return Ie})),n.d(t,"kc",(function(){return _e})),n.d(t,"Sb",(function(){return Ae})),n.d(t,"Zb",(function(){return Pe})),n.d(t,"Pb",(function(){return De})),n.d(t,"lc",(function(){return Fe})),n.d(t,"mc",(function(){return Re})),n.d(t,"Eb",(function(){return Ne})),n.d(t,"Db",(function(){return ze})),n.d(t,"Fb",(function(){return Le})),n.d(t,"yb",(function(){return Be})),n.d(t,"Ab",(function(){return qe})),n.d(t,"zb",(function(){return Ve})),n.d(t,"Hb",(function(){return $e})),n.d(t,"xb",(function(){return Ue})),n.d(t,"sb",(function(){return Ge})),n.d(t,"Gb",(function(){return He})),n.d(t,"vb",(function(){return Qe})),n.d(t,"wb",(function(){return We})),n.d(t,"Bb",(function(){return Ke})),n.d(t,"Cb",(function(){return Je})),n.d(t,"tb",(function(){return Ye})),n.d(t,"ub",(function(){return Xe})),n.d(t,"Wb",(function(){return Ze})),n.d(t,"Rb",(function(){return et})),n.d(t,"Jb",(function(){return tt})),n.d(t,"Vb",(function(){return nt})),n.d(t,"wd",(function(){return at})),n.d(t,"pd",(function(){return it})),n.d(t,"ed",(function(){return rt})),n.d(t,"tc",(function(){return st})),n.d(t,"gd",(function(){return ot})),n.d(t,"nc",(function(){return lt})),n.d(t,"sc",(function(){return ut})),n.d(t,"oc",(function(){return ct})),n.d(t,"pc",(function(){return dt})),n.d(t,"qc",(function(){return mt})),n.d(t,"rc",(function(){return pt})),n.d(t,"Kb",(function(){return ft})),n.d(t,"b",(function(){return bt})),n.d(t,"md",(function(){return gt})),n.d(t,"fd",(function(){return vt})),n.d(t,"Lb",(function(){return yt})),n.d(t,"a",(function(){return ht})),n.d(t,"ld",(function(){return jt})),n.d(t,"c",(function(){return Ot})),n.d(t,"uc",(function(){return Et})),n.d(t,"Ib",(function(){return xt})),n.d(t,"Mb",(function(){return St})),n.d(t,"ec",(function(){return wt})),n.d(t,"sd",(function(){return kt})),n.d(t,"gc",(function(){return Ct})),n.d(t,"vc",(function(){return Tt})),n.d(t,"vd",(function(){return Mt})),n.d(t,"bc",(function(){return It})),n.d(t,"cc",(function(){return _t})),n.d(t,"B",(function(){return At})),n.d(t,"ud",(function(){return Pt})),n.d(t,"Ob",(function(){return Dt})),n.d(t,"Nb",(function(){return Ft})),n.d(t,"zc",(function(){return Rt})),n.d(t,"qb",(function(){return Nt})),n.d(t,"Yc",(function(){return zt})),n.d(t,"Zc",(function(){return Lt})),n.d(t,"Xc",(function(){return Bt})),n.d(t,"Vc",(function(){return qt})),n.d(t,"Wc",(function(){return Vt})),n.d(t,"Kc",(function(){return $t})),n.d(t,"Lc",(function(){return Ut})),n.d(t,"Ic",(function(){return Gt})),n.d(t,"Jc",(function(){return Ht})),n.d(t,"Cc",(function(){return Qt})),n.d(t,"Dc",(function(){return Wt})),n.d(t,"Ac",(function(){return Kt})),n.d(t,"Bc",(function(){return Jt})),n.d(t,"Tc",(function(){return Yt})),n.d(t,"Uc",(function(){return Xt})),n.d(t,"Rc",(function(){return Zt})),n.d(t,"Sc",(function(){return en})),n.d(t,"Gc",(function(){return tn})),n.d(t,"Hc",(function(){return nn})),n.d(t,"Ec",(function(){return an})),n.d(t,"Fc",(function(){return rn})),n.d(t,"cd",(function(){return sn})),n.d(t,"ad",(function(){return on})),n.d(t,"dd",(function(){return ln})),n.d(t,"bd",(function(){return un})),n.d(t,"Oc",(function(){return cn})),n.d(t,"Qc",(function(){return dn})),n.d(t,"Pc",(function(){return mn})),n.d(t,"Mc",(function(){return pn})),n.d(t,"Nc",(function(){return fn})),n.d(t,"kd",(function(){return bn})),n.d(t,"hd",(function(){return gn})),n.d(t,"Xb",(function(){return vn})),n.d(t,"Qb",(function(){return yn})),n.d(t,"id",(function(){return hn})),n.d(t,"hc",(function(){return jn})),n.d(t,"ic",(function(){return On})),n.d(t,"xd",(function(){return En})),n.d(t,"ac",(function(){return xn})),n.d(t,"jd",(function(){return Sn}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),s=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Manage value lists"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRunTitle",{defaultMessage:"Manual run"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.investigationFieldsTitle",{defaultMessage:"Custom highlighted fields"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),_=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),F=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),R=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),N=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be scheduled"}),L=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),B=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),V=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),$=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),U=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),G=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkManualRuleRunConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Schedule {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorMessage",{defaultMessage:"This action can only be applied"}),Q=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorTitle",{values:{rulesCount:e},defaultMessage:"Manual rule run cannot be scheduled for more than {rulesCount, plural, =1 {# rule} other {# rules}}"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorCloseButton",{defaultMessage:"Close"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),le=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ue=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),de=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),pe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.investigationFieldsRequiredErrorMessage",{defaultMessage:"A minimum of one custom highlighted field is required."}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsOverwriteCheckboxLabel",{defaultMessage:"Overwrite the custom highlighted fields for the selected rules"}),ge=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxLabel",{defaultMessage:"Add custom highlighted fields for selected rules"}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter fields that you want to add.  You can choose from any of the fields included in the default Elastic Security indices."}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxLabel",{defaultMessage:"Delete custom highlighted fields for selected rules"}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter the fields that you want to remove from the selected rules. After you remove these fields, they will no longer appear in the Highlighted fields section of the alerts generated by selected rules."}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),Se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CK™ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),we=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ke=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),Te=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),Ie=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),_e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),Pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunDescription",{defaultMessage:"Manual run"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunTooltip",{defaultMessage:"Manual run available only for enabled rules"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.integrationsTitle",{defaultMessage:"Integrations"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Ze=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),it=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),st=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),ut=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),ct=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),dt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),ft=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),ht=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),Ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),Et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),St=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),wt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),kt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),Ct=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),Tt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),Mt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),It=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),_t=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),At=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),Pt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),Dt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),Ft=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),Rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),Nt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),zt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),Lt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),Bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),Vt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),$t=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),Ut=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),Ht=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),Wt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Kt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),Jt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),Yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),Xt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Zt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),en=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),tn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),nn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),an=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),rn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),sn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastTitle",{defaultMessage:"Rules scheduled"}),on=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastTitle",{defaultMessage:"Error scheduling manual rule run"}),ln=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully scheduled manual rule run for {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),un=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastDescription",{values:{failedRulesCount:e},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to schedule manual rule run."}),cn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),dn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),mn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),pn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),fn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),bn=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),gn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),vn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),yn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),hn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),jn=a.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),On=e=>a.i18n.translate("xpack.securitySolution.addRules.installRuleButton.ariaLabel",{defaultMessage:'Install "{ruleName}"',values:{ruleName:e}}),En=a.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),xn=a.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),Sn=a.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(19),i=n(2),r=n.n(i),s=n(138),o=n(514),l=n(474),u=n(447),c=n(650);const d="inspectButtonComponent",m=({children:e,show:t=!0})=>r.a.createElement(o.a,{show:t,targetClassNames:[d]},e),p=({compact:e=!1,inputId:t=s.a.global,inspectIndex:n=0,isDisabled:i,multiple:o=!1,onCloseInspect:m,queryId:p="",showInspectButton:f=!0,title:b=""})=>{const{additionalRequests:g,additionalResponses:v,handleClick:y,handleCloseModal:h,isButtonDisabled:j,isShowingModal:O,loading:E,request:x,response:S}=Object(u.a)({inputId:t,inspectIndex:n,isDisabled:i,multiple:o,onCloseInspect:m,queryId:p});return r.a.createElement(r.a.Fragment,null,t===s.a.timeline&&!e&&f&&r.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":c.d,"data-test-subj":"inspect-empty-button",isDisabled:j,isLoading:E,onClick:y},c.d),(t===s.a.global||e)&&f&&r.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":c.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:j,title:c.d,onClick:y}),O&&null!==x&&null!==S&&r.a.createElement(l.a,{additionalRequests:g,additionalResponses:v,closeModal:h,"data-test-subj":"inspect-modal",inputId:t,request:x,response:S,title:b}))};p.displayName="InspectButtonComponent";const f=r.a.memo(p)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return C})),n.d(t,"b",(function(){return L})),n.d(t,"g",(function(){return B}));var a=n(979),i=n(44),r=n(50),s=n(413),o=n.n(s),l=n(45),u=n(2),c=n(513),d=n(121),m=n(146),p=n(556),f=n(158),b=n(243),g=n(179),v=n(705),y=n(396),h=n(292),j=n(274),O=n(129);const E="open-timeline",x=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,S=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),w=({title:e})=>null==e||0===e.trim().length,k=(e,t)=>"__typename"===e?void 0:t,C=e=>JSON.parse(JSON.stringify(e),k),T=e=>{try{return JSON.parse(e)}catch{return e}},M=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:T(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:T(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:T(e.meta.value)}:{}},...null!=e.exists?{exists:T(e.exists)}:{},...null!=e.match_all?{exists:T(e.match_all)}:{},...null!=e.missing?{exists:T(e.missing)}:{},...null!=e.query?{query:T(e.query)}:{},...null!=e.range?{range:T(e.range)}:{},...null!=e.script?{exists:T(e.script)}:{}}),I=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},_=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},A=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},P=(e,t,n)=>n===d.m.default&&e.timelineType===d.m.template?e.templateTimelineId:t&&e.timelineType===d.m.template?Object(r.v4)():e.templateTimelineId,D=({and:e,...t})=>t.type===d.a.template?o()(t,{type:d.a.default,enabled:t.queryMatch.operator!==g.d,queryMatch:{value:t.queryMatch.operator===g.d?"":t.queryMatch.value}}):t,F=(e,t,n)=>e&&t&&n===d.m.default?t.map((e=>{var t,n;return{...D(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(D))&&void 0!==t?t:[]}})):t,R=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",N=(e,t,n)=>n&&e.timelineType!==n?d.l.draft:t?d.l.active:e.status,z=(e,t,n,i)=>{const r=e.timelineType===d.m.template,s=i?b.b:j.a,o={...e,columns:null!=e.columns?e.columns.map((e=>((e,t)=>{var n;return Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:b.a,id:null!=e.id?e.id:"unknown",initialWidth:null===(n=t.find((t=>e.id===t.id)))||void 0===n?void 0:n.initialWidth})})(e,s))):s,defaultColumns:s,dateRange:e.status===d.l.immutable&&e.timelineType===d.m.template?{start:y.a.toISOString(),end:y.b.toISOString()}:e.dateRange,dataProviders:F(t,e.dataProviders,n),excludedRowRendererIds:r?[]:Object.keys(d.e),eventIdToNoteIds:I(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(M):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:A(t,e.pinnedEventIds),pinnedEventsSaveObject:_(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:N(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:R(e,t,n),templateTimelineId:P(e,t,n),templateTimelineVersion:t&&r?1:e.templateTimelineVersion};return Object.entries(o).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...f.b,id:""})},L=(e,t=!1,n,a)=>{const{notes:i,...r}=e;return{notes:i,timeline:z(r,t,n,a)}},B=()=>{const{resetDiscoverAppState:e}=Object(c.a)(),t=Object(p.a)(),n=Object(l.useDispatch)(),a=Object(u.useCallback)((e=>n(O.a.updateIsLoading(e))),[n]);return({activeTimelineTab:n=m.d.query,duplicate:r=!1,graphEventId:s="",timelineId:o,timelineType:l,onError:u,onOpenTimeline:c,openTimeline:p=!0,savedSearchId:g,unifiedComponentsInTimelineDisabled:O=!1})=>{if(a({id:m.c.active,isLoading:!0}),null!=o)return Promise.resolve(Object(h.j)(o)).then((a=>{const o=Object(i.getOr)(null,"data",a);if(!o)return;const u=C(o.timeline),{timeline:d,notes:f}=L(u,r,l,O);if(null!=c)c(d);else if(t){const{from:a,to:l}=Object(v.a)({from:Object(i.getOr)(null,"dateRange.start",d),to:Object(i.getOr)(null,"dateRange.end",d)});return t({duplicate:r,from:a,id:m.c.active,notes:f,resolveTimelineConfig:{outcome:o.outcome,alias_target_id:o.alias_target_id,alias_purpose:o.alias_purpose},timeline:{...d,activeTab:n,graphEventId:s,show:p,dateRange:{start:a,end:l},savedSearchId:d.savedSearchId},to:l,preventSettingQuery:!0}),e(d.savedSearchId)}})).catch((e=>{null!=u&&u(e,o)})).finally((()=>{a({id:m.c.active,isLoading:!1})}));t({id:m.c.active,duplicate:!1,notes:[],from:y.a.toISOString(),to:y.b.toISOString(),timeline:{...f.b,columns:O?b.b:j.a,id:m.c.active,activeTab:n,show:p,initialized:!0,savedSearchId:null!=g?g:null,excludedRowRendererIds:O||l===d.m.template?[]:f.b.excludedRowRendererIds}}),e(),a({id:m.c.active,isLoading:!1})}}},function(e,t,n){"use strict";var a,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function s(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function o(e,t){for(var n={},a=[],i=0;i<e.length;i++){var o=e[i],l=t.base?o[0]+t.base:o[0],u=n[l]||0,c="".concat(l," ").concat(u);n[l]=u+1;var d=s(c),m={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(r[d].references++,r[d].updater(m)):r.push({identifier:c,updater:b(m,t),references:1}),a.push(c)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=n.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var s=i(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,n,a){var i=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var r=document.createTextNode(i),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function m(e,t,n){var a=n.css,i=n.media,r=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var p=null,f=0;function b(e,t){var n,a,i;if(t.singleton){var r=f++;n=p||(p=l(t)),a=d.bind(null,n,r,!1),i=d.bind(null,n,r,!0)}else n=l(t),a=m.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var i=s(n[a]);r[i].references--}for(var l=o(e,t),u=0;u<n.length;u++){var c=s(n[u]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}n=l}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,a,i,r=e[1]||"",s=e[3];if(!s)return r;if(t&&"function"==typeof btoa){var o=(n=s,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),l=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[r].concat(l).concat([o]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(i[s]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);a&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(118);const r={managed:!0},s=()=>{const{services:{apm:e}}=Object(i.j)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:r)),[e])}},o=e=>`Timeline search ${e}`},,function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return v}));var a=n(2),i=n(44),r=n(45),s=n(271),o=n.n(s),l=n(58),u=n(213),c=n(124),d=n(1361),m=n(246),p=n(21);const f=(e,t,n)=>{const i=Object(r.useDispatch)(),s=Object(u.g)(e);Object(a.useEffect)((()=>{const a=n&&""!==n?n:e,r=s();return i(d.a.registerUrlParam({key:a,initialValue:r})),t(r),()=>{i(d.a.deregisterUrlParam({key:a}))}}),[])},b=e=>{const t=Object(r.useDispatch)();return Object(a.useCallback)((n=>{t(d.a.updateUrlParam({key:e,value:n}))}),[t,e])},g=()=>{const e=Object(c.b)(d.c.selectGlobalUrlParam);return Object(a.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((n=>{const a=e[n];if(a&&("object"!=typeof a||!Object(i.isEmpty)(a)))try{t[n]=Object(l.encode)(a)}catch{}})),Object(u.b)(Object(i.pickBy)((e=>!Object(i.isEmpty)(e)),t))):""}),[e])},v=()=>{const[{pageName:e}]=Object(m.a)(),t=Object(c.b)(d.c.selectGlobalUrlParam),n=o()(t),r=Object(u.h)();Object(a.useEffect)((()=>{var a;const s=null!==(a=Object(p.b)(e))&&void 0!==a?a:{skipUrlState:!0},o={...t};s.skipUrlState&&Object.keys(o).forEach((e=>{o[e]=null})),Object(i.difference)(Object.keys(null!=n?n:{}),Object.keys(t)).forEach((e=>{o[e]=null})),Object.keys(o).length>0&&r(o)}),[n,t,e,r])}},,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return l.a})),n.d(t,"h",(function(){return l.d})),n.d(t,"d",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return m.b})),n.d(t,"f",(function(){return m.a})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return y}));var a=n(44),i=n(2),r=n(454),s=n(529),o=n(364),l=n(258),u=n(276),c=(n(5),n(207));const d=(e,t)=>`/${e}${Object(c.a)(t)}`;var m=n(375);const p=(e,t)=>`/${e}${Object(c.a)(t)}`,f=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,b=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(c.a)(null!=t?t:void 0)}`,g=e=>`/create${Object(c.a)(null!=e?e:void 0)}`,v=e=>{const{getAppUrl:t}=Object(o.a)(),n=Object(s.b)(e);return{formatUrl:Object(i.useCallback)(((i,{absolute:r=!1,skipSearch:s=!1}={})=>{const o=function(e,t,n){const[i,r]=e.split("?");return`${i}${n?Object(a.isEmpty)(r)?"":`?${r}`:Object(a.isEmpty)(r)?t:`?${r}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}(i,n,s);return t({deepLinkId:e,path:o,absolute:r})}),[t,e,n]),search:n}},y=()=>{const e=Object(r.f)(),t=Object(s.a)();return Object(i.useCallback)((({deepLinkId:n,path:a="",absolute:i=!1,skipSearch:r=!1})=>{const s=r?"":t(n);return e({id:n,path:a,urlState:s,absolute:i})}),[e,t])}},,function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return f}));var a=n(19),i=n(41),r=n.n(i);const s=r.a.div.withConfig({displayName:"SecuritySolutionAppWrapper",componentId:"sc-2kezi3-0"})(["display:flex;flex-direction:column;flex:1 1 auto;width:100%;"]);s.displayName="SecuritySolutionAppWrapper";const o=()=>Object(i.css)([".euiOverlayMask[data-relative-to-header='below']{top:0 !important;}.euiFlyout{top:0 !important;height:100% !important;}"]),l=Object(i.createGlobalStyle)([".euiDataGridRowCell__popover{max-width:815px !important;max-height:none !important;overflow:hidden;.expandable-top-value-button{&.euiButtonEmpty:focus{background-color:transparent;}}&.euiPopover__panel[data-popover-open]{padding:8px 0;min-width:65px;}.euiPopoverFooter{border:0;margin-top:0;.euiFlexGroup{flex-direction:column;}}.euiText + .euiPopoverFooter{border-top:1px solid ",";margin-top:",";}}.euiPanel-loading-hide-border{border:none;}body.euiBody-hasOverlayMask{.euiDataGridRowCell__popover[data-popover-open],.withHoverActions__popover[data-popover-open]{visibility:hidden !important;}}.euiScreenReaderOnly{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeS)),u=r()(a.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-2kezi3-1"})(["",""],(({theme:e})=>`\n    word-break: break-word;\n    dt {\n      font-size: ${e.eui.euiFontSizeXS} !important;\n    }\n    dd {\n      width: fit-content;\n    }\n    dd > div {\n      width: fit-content;\n    }\n  `));u.displayName="DescriptionListStyled";const c=r()(a.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-2kezi3-2"})(["margin-left:5px;"]);c.displayName="CountBadge";const d=r.a.span.withConfig({displayName:"Spacer",componentId:"sc-2kezi3-3"})(["margin-left:5px;"]);d.displayName="Spacer";const m=r()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-2kezi3-4"})(["vertical-align:top;"]);m.displayName="Badge";const p=r()(a.EuiIcon).withConfig({displayName:"MoreRowItems",componentId:"sc-2kezi3-5"})(["margin-left:5px;"]);p.displayName="MoreRowItems";const f=r()(a.EuiFlexGroup).withConfig({displayName:"OverviewWrapper",componentId:"sc-2kezi3-6"})(["position:relative;.euiButtonIcon{position:absolute;right:",";top:6px;z-index:2;}"],(e=>e.theme.eui.euiSizeM));f.displayName="OverviewWrapper"},function(e,t,n){"use strict";n.d(t,"C",(function(){return i})),n.d(t,"q",(function(){return r})),n.d(t,"v",(function(){return s})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return l})),n.d(t,"p",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"B",(function(){return m})),n.d(t,"r",(function(){return p})),n.d(t,"u",(function(){return f})),n.d(t,"y",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"E",(function(){return v})),n.d(t,"w",(function(){return y})),n.d(t,"b",(function(){return h})),n.d(t,"x",(function(){return j})),n.d(t,"z",(function(){return O})),n.d(t,"t",(function(){return E})),n.d(t,"s",(function(){return x})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return w})),n.d(t,"F",(function(){return k})),n.d(t,"g",(function(){return C})),n.d(t,"A",(function(){return T})),n.d(t,"D",(function(){return M})),n.d(t,"e",(function(){return I})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return A})),n.d(t,"i",(function(){return P})),n.d(t,"h",(function(){return D})),n.d(t,"j",(function(){return F}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),m=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),p=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),v=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),y=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),h=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),j=a.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),O=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),E=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),x=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),w=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),C=Object.freeze({tried:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),T=a.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),M=a.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),I=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),_=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),A=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),P=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),D=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),F=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return _}));var a=n(189),i=n(45),r=n(2),s=n(138),o=n(118),l=n(148),u=n(183),c=n(44),d=n(122),m=n(705),p=n(346);var f=n(271),b=n.n(f),g=n(213),v=n(246);var y=n(58),h=n(149),j=n(184),O=n(169),E=n(129),x=n(124),S=n(48);const w=({search:e,urlKey:t})=>Object(g.d)(Object(g.e)(e),t);var k=n(1799),C=n(1630),T=n(1490),M=n(5);const I=()=>{Object(a.c)(),(()=>{const e=Object(i.useDispatch)(),{filterManager:t,savedQueries:n}=Object(o.j)().services.data.query,c=Object(r.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),d=Object(i.useSelector)(c),m=Object(r.useCallback)((t=>{null!=t&&e(u.b.setFilterQuery({id:s.a.global,query:t.query,language:t.language}))}),[e]),p=Object(r.useCallback)((n=>{null!=n?(t.setFilters(n),e(u.b.setSearchBarFilter({id:s.a.global,filters:n}))):(t.setAppFilters(d),e(u.b.setSearchBarFilter({id:s.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(r.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],i=n.attributes.query;t.setFilters(a),e(u.b.setSearchBarFilter({id:s.a.global,filters:a})),e(u.b.setFilterQuery({id:s.a.global,...i})),e(u.b.setSavedQuery({id:s.a.global,savedQuery:n}))}))}),[e,t,n]);Object(a.b)(_.appQuery,m),Object(a.b)(_.filters,p),Object(a.b)(_.savedQuery,f)})(),(()=>{const e=Object(i.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),n=Object(r.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(c.get)("global.linkTo",e)},i=Object(c.get)("global.timerange.kind",e),r={linkTo:Object(c.get)("timeline.linkTo",e)},o=Object(c.get)("timeline.timerange.kind",e),l={linkTo:Object(c.get)("socTrends.linkTo",e)},d=Object(c.get)("socTrends.timerange.kind",e);if(n&&(Object(c.isEmpty)(l.linkTo)?t(u.b.removeLinkTo([s.a.global,s.a.socTrends])):t(u.b.addLinkTo([s.a.global,s.a.socTrends]))),Object(c.isEmpty)(a.linkTo)?(t(u.b.removeLinkTo([s.a.global,s.a.timeline])),n&&t(u.b.removeLinkTo([s.a.global,s.a.socTrends]))):(t(u.b.addLinkTo([s.a.global,s.a.timeline])),n&&t(u.b.addLinkTo([s.a.global,s.a.socTrends]))),Object(c.isEmpty)(r.linkTo)?t(u.b.removeLinkTo([s.a.global,s.a.timeline])):t(u.b.addLinkTo([s.a.global,s.a.timeline])),o){if("absolute"===o){const n=Object(m.a)(Object(c.get)("timeline.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...n,id:s.a.timeline}))}if("relative"===o){const n=Object(m.a)(Object(c.get)("timeline.timerange",e));n.from=Object(p.c)(n.fromStr),n.to=Object(p.c)(n.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...n,id:s.a.timeline}))}}if(i){if("absolute"===i){const n=Object(m.a)(Object(c.get)("global.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...n,id:s.a.global}))}if("relative"===i){const n=Object(m.a)(Object(c.get)("global.timerange",e));n.from=Object(p.c)(n.fromStr),n.to=Object(p.c)(n.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...n,id:s.a.global}))}}if(n&&d){if("absolute"===d){const n=Object(m.a)(Object(c.get)("socTrends.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...n,id:s.a.socTrends}))}if("relative"===d){const n=Object(m.a)(Object(c.get)("socTrends.timerange",e));n.from=Object(p.c)(n.fromStr),n.to=Object(p.c)(n.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...n,id:s.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(a.b)(_.timerange,n)})(),(()=>{const[{pageName:e}]=Object(v.a)(),t=Object(i.useDispatch)(),n=b()(e),a=Object(r.useMemo)((()=>l.d.inputsSelector()),[]),o=Object(i.useSelector)(a),{timerange:c}=o.global,{timerange:d}=o.timeline;Object(r.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(g.f)(e))(e,n)&&("relative"===d.kind&&t(u.b.setRelativeRangeDatePicker({...d,from:Object(p.c)(d.fromStr),to:Object(p.c)(d.toStr,{roundUp:!0}),id:s.a.timeline})),"relative"===c.kind&&t(u.b.setRelativeRangeDatePicker({...c,from:Object(p.c)(c.fromStr),to:Object(p.c)(c.toStr,{roundUp:!0}),id:s.a.global})))}),[e,n,t,d,c])})(),(()=>{const e=Object(d.a)("unifiedComponentsInTimelineDisabled"),t=Object(d.a)("timelineEsqlTabDisabled"),n=Object(j.g)(),s=Object(i.useSelector)((e=>Object(O.selectTimelineById)(e,h.f.active))),o=Object(r.useCallback)((a=>{null!=a&&n({activeTimelineTab:a.activeTab===h.g.esql&&t?h.g.query:a.activeTab,duplicate:!1,graphEventId:a.graphEventId,timelineId:a.id,openTimeline:a.isOpen,savedSearchId:a.savedSearchId,unifiedComponentsInTimelineDisabled:e})}),[t,n,e]);Object(r.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(_.timeline);if(!e)return;const t=Object(y.safeDecode)(e);(function(e,t){return e&&t&&(e.id!==t.id||e.savedSearchId!==t.savedSearchId||e.graphEventId!==t.graphEventId)})(s,t)||o(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[o,s]),Object(a.b)(_.timeline,o)})(),(()=>{const e=Object(a.d)(_.timeline),t=Object(r.useMemo)((()=>E.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:i,show:s,savedObjectId:o,savedSearchId:l}=Object(x.b)((e=>{var n;return null!==(n=t(e,h.f.active))&&void 0!==n?n:{}}));Object(r.useEffect)((()=>{const t={...o?{id:o}:{},isOpen:s,activeTab:n,graphEventId:null!=i?i:"",savedSearchId:l||void 0};e(t)}),[n,i,o,s,e,l])})(),(()=>{var e;const t=Object(r.useMemo)((()=>E.b.getTimelineByIdSelector()),[]),n=Object(x.b)((e=>t(e,h.f.active))),{search:a}=Object(S.useLocation)(),i=b()(a),s=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",o=Object(d.a)("unifiedComponentsInTimelineDisabled"),[l,u]=Object(r.useMemo)((()=>{const e=w({urlKey:_.timeline,search:null!=i?i:""}),t=w({urlKey:_.timeline,search:a});return null!=e&&null!=t?[Object(y.safeDecode)(e),Object(y.safeDecode)(t)]:[null,null]}),[i,a]),c=null==l?void 0:l.id,{id:m,activeTab:p,graphEventId:f}=u||{},g=Object(j.g)();Object(r.useEffect)((()=>{m&&m!==c&&m!==s&&g({activeTimelineTab:null!=p?p:h.g.query,duplicate:!1,graphEventId:f,timelineId:m,openTimeline:!0,unifiedComponentsInTimelineDisabled:o})}),[s,c,m,p,f,g,o])})(),(()=>{const{search:e}=Object(S.useLocation)(),t=Object(d.a)("expandableFlyoutDisabled"),[n,s]=Object(r.useState)(null),[o,l]=Object(r.useState)(!1),u=Object(i.useDispatch)(),c=k.b.getTableByIdSelector(),m=Object(x.b)((e=>{var t;return null!==(t=c(e,C.b.alertsOnAlertsPage))&&void 0!==t?t:T.d})),p=Object(r.useCallback)((e=>{t&&null!=e&&e.panelView&&s(e)}),[t]),f=Object(r.useCallback)((()=>{if(!t)return;const{initialized:e,isLoading:a,totalCount:i,additionalFilters:r}=m,s=e&&!a&&i>0;n&&(r&&r.showBuildingBlockAlerts||u(k.a.updateShowBuildingBlockAlertsFilter({id:C.b.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),s&&(l(!0),u(k.a.toggleDetailPanel({id:C.b.alertsOnAlertsPage,...n}))))}),[m,u,t,n]);Object(r.useEffect)((()=>{t&&!o&&f()}),[o,t,f]);const b=w({urlKey:_.eventFlyout,search:e});let g="",v="";t&&(b?(g=_.eventFlyout,v=_.flyout):g=_.flyout),Object(a.b)(g,p,v)})(),(()=>{const e=Object(d.a)("expandableFlyoutDisabled"),t=Object(a.d)(_.flyout),{pathname:n}=Object(S.useLocation)(),s=Object(i.useDispatch)(),o=k.b.getTableByIdSelector(),{expandedDetail:l}=Object(x.b)((e=>{var t;return null!==(t=o(e,C.b.alertsOnAlertsPage))&&void 0!==t?t:T.d}));Object(r.useEffect)((()=>{var a;if(!e)return;const i=n===M.d;i&&null!=l&&null!=l&&l.query?t(l.query.panelView?l.query:null):!i&&null!=l&&null!==(a=l.query)&&void 0!==a&&a.panelView&&(s(k.a.toggleDetailPanel({id:C.b.alertsOnAlertsPage})),t(null))}),[s,l,e,n,t])})()},_={appQuery:"query",eventFlyout:"eventFlyout",flyout:"flyout",timelineFlyout:"timelineFlyout",filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},,function(e,t,n){"use strict";var a=n(260);n.d(t,"a",(function(){return a.a}));var i=n(337);n.d(t,"b",(function(){return i.a}));var r=n(183);n.d(t,"c",(function(){return r.b}));var s=n(166);n.d(t,"d",(function(){return s.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(956);const r=()=>Object(a.useContext)(i.a)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(2),i=n(45),r=n(138),s=n(5),o=n(124),l=n(148),u=n(200);const c=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(o.b)(l.d.globalFullScreenSelector))&&void 0!==e&&e,c=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add(s.Gc,"euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove(s.Gc,"euiDataGrid__restrictBody"),t(u.c.setFullScreen({id:r.a.global,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({globalFullScreen:n,setGlobalFullScreen:c})),[n,c])},d=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(o.b)(l.d.timelineFullScreenSelector))&&void 0!==e&&e,s=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add("euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove("euiDataGrid__restrictBody"),t(u.c.setFullScreen({id:r.a.timeline,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({timelineFullScreen:n,setTimelineFullScreen:s})),[n,s])},m=()=>{const{globalFullScreen:e}=c(),{timelineFullScreen:t}=d(),n=(()=>{const[e,t]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const e=document.body,n=new MutationObserver((n=>{for(const a of n)"class"===a.attributeName&&t(e.classList.contains("euiDataGrid__restrictBody"))}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[]),e})();return e||t||n}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(2),i=n(8),r=n.n(i),s=n(452);const o=e=>{const t=Object(s.b)(),n=r()(t.sections$,t.getSectionsValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},l=e=>{const t=Object(s.b)(),n=r()(t.messages$,t.getMessagesValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},u=e=>{const t=Object(s.b)(),n=Object(a.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=n?n:null}},,,,,function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"a",(function(){return g}));var a=n(58),i=n(429),r=n(12),s=n(48),o=n(2),l=n(156);const u=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesAdd||e===l.a.rulesCreate||e===l.a.exceptions,c=e=>e.substring(1),d=(e,t)=>{const n=Object(i.parse)(e,{sort:!1})[t];return Array.isArray(n)?n[0]:n},m=(e,t)=>{const n=d(c(null!=t?t:window.location.search),e);return Object(a.safeDecode)(null!=n?n:"")},p=e=>Object(o.useCallback)((()=>m(e)),[e]),f=e=>Object(i.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),b=()=>{const e=Object(s.useHistory)();return Object(o.useCallback)((t=>{const n=window.location.search,r=Object(i.parse)(n,{sort:!1});Object.keys(t).forEach((e=>{const n=t[e];if(null!=n&&""!==n)try{r[e]=Object(a.encode)(n)}catch{console.error("Unable to encode url param value")}else delete r[e]}));const s=f(r);c(n)!==s&&e.replace({search:s})}),[e])},g=()=>{window.history.pushState({},"",window.location.href)}},,,,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(5);const i={ENABLE:`${a.m} singleRuleActions enable`,DISABLE:`${a.m} singleRuleActions disable`,DUPLICATE:`${a.m} singleRuleActions duplicate`,EXPORT:`${a.m} singleRuleActions export`,DELETE:`${a.m} singleRuleActions delete`,MANUAL_RULE_RUN:`${a.m} singleRuleActions manual rule run`,PREVIEW:`${a.m} singleRuleActions preview`,SAVE:`${a.m} singleRuleActions save`},r={ENABLE:`${a.m} bulkRuleActions enable`,DISABLE:`${a.m} bulkRuleActions disable`,DUPLICATE:`${a.m} bulkRuleActions duplicate`,EXPORT:`${a.m} bulkRuleActions export`,MANUAL_RULE_RUN:`${a.m} bulkRuleActions manual rule run`,DELETE:`${a.m} bulkRuleActions delete`,EDIT:`${a.m} bulkRuleActions edit`},s={REFRESH:`${a.m} rulesTable refresh`,FILTER:`${a.m} rulesTable filter`,LOAD_PREBUILT:`${a.m} rulesTable loadPrebuilt`},o={SAVE:`${a.m} timeline save`,DUPLICATE:`${a.m} timeline duplicate`,DELETE:`${a.m} timeline delete`,BULK_DELETE:`${a.m} timeline bulkDelete`},l={OPEN_ANALYZER:`${a.m} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.m} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.m} alerts investigateInTimeline`},u={FIELD_SAVED:`${a.m} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.m} fieldBrowser fieldDeleted`}},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return m})),n.d(t,"m",(function(){return p}));var a=n(44),i=n(128),r=n(1630),s=n(266),o=n(131),l=n(200),u=n(706);n.d(t,"e",(function(){return i.f})),n.d(t,"g",(function(){return i.h})),n.d(t,"f",(function(){return i.g})),n.d(t,"k",(function(){return i.l})),n.d(t,"j",(function(){return i.k})),n.d(t,"o",(function(){return i.q})),n.d(t,"n",(function(){return i.p})),n.d(t,"l",(function(){return i.m})),n.d(t,"h",(function(){return i.i})),n.d(t,"p",(function(){return i.v})),n.d(t,"q",(function(){return i.w})),n.d(t,"i",(function(){return i.j})),n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.d}));const c=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:a,timelineId:r,noProviderFound:s=l.b.noProviderFound,onAddedToTimeline:o})=>{const c=Object(i.o)(a),d=t[c];d?Object(u.b)({dataProviders:e,destination:a.destination,dispatch:n,onAddedToTimeline:o,providerToAdd:d,timelineId:r}):n(s({id:c}))},d={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},m=({browserFields:e,dispatch:t,result:n,scopeId:l,defaultsHeader:u})=>{var c;const m=Object(i.n)(n),p=(e=>Object(a.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[m],f=l!==r.b.alertsOnAlertsPage&&l!==r.b.alertsOnRuleDetailsPage||null===(c=u.find((e=>e.id===m)))||void 0===c?{}:c,b=Object(o.getScopedActions)(l);var g;null!=p&&b?t(b.upsertColumn({column:{columnHeaderType:"not-filtered",id:m,linkField:null!==(g=d[m])&&void 0!==g?g:void 0,type:p.type,aggregatable:p.aggregatable,initialWidth:s.a,...f},id:l,index:null!=n.destination?n.destination.index:0})):b&&t(b.upsertColumn({column:{columnHeaderType:"not-filtered",id:m,initialWidth:s.a},id:l,index:null!=n.destination?n.destination.index:0}))},p=e=>e.slice(e.lastIndexOf(".")+1)},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));const a=["started","opened"],i=["starting","stopping","opening","closing"],r=["deleted","failed"],s=(e,t)=>a.includes(e)&&a.includes(t),o=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>r.includes(e)||r.includes(t),u=e=>"machine_learning"===e},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(19),i=n(2),r=n.n(i),s=n(41),o=n.n(s),l=n(52),u=n.n(l),c=n(181),d=n(901),m=n(902);const p=o.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(s.css)(["height:","px;"],e)),(({border:e})=>e&&Object(s.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));p.displayName="Header";const f=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",b=({alignHeader:e,border:t,children:n,outerDirection:s="column",growLeftSplit:o=!0,headerFilters:l,height:b,hideSubtitle:g=!1,id:v,inspectMultiple:y=!1,inspectTitle:h,isInspectDisabled:j,showInspectButton:O=!0,split:E,stackHeader:x,subtitle:S,title:w,titleSize:k="l",toggleQuery:C,toggleStatus:T=!0,tooltip:M,tooltipTitle:I})=>{const _=Object(i.useCallback)((()=>{C&&C(!T)}),[C,T]),A=u()({"toggle-expand":T,siemHeaderSection:!0});return r.a.createElement(p,{"data-test-subj":"header-section",border:t,height:b,className:A,$hideSubtitle:g},r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:s,gutterSize:"xs",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:o},r.a.createElement(a.EuiFlexGroup,{alignItems:f({alignHeader:e,stackHeader:x}),"data-test-subj":"headerSectionInnerFlexGroup",direction:x?"column":"row",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:o,className:T?"":"no-margin"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},C&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":m.a(T),color:"text",display:"empty",iconType:T?"arrowDown":"arrowRight",onClick:_,size:"s",title:m.a(T)})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiTitle,{size:k},r.a.createElement("h2",{"data-test-subj":"header-section-title"},r.a.createElement("span",{className:"eui-textBreakNormal"},w),M&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiIconTip,{color:"subdued",title:I,content:M,size:"l",type:"iInCircle"}))))))),v&&T&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(c.b,{isDisabled:j,queryId:v,multiple:y,showInspectButton:O,title:null!=h?h:w})),l&&T&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),n&&T&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!E},n))),!g&&T&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:S}))))},g=r.a.memo(b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return m}));const a=100,i=1e4,r=[10,25,50,a,250,500],s={auto:-1,single:0,default:3},o="1.6em",l=370,u=212,c="kibana-json",d={border:"horizontal",fontSize:"s",cellPadding:"l",rowHover:"highlight",header:"underline",stripes:!0},m={showColumnSelector:{allowHide:!1,allowReorder:!0}}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(19),i=n(4),r=n(42),s=n(2),o=n.n(s);const l=({count:e})=>{const[t,n,l]=Object(s.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),a={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},r=new Map([[1,""],[1e3,a.compactThousands],[1e6,a.compactMillions],[1e9,a.compactBillions],[1e12,a.compactTrillions]]),s=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),o=null!==(t=r.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),o,e/n%1>Number.EPSILON?s:""]}(e||0)),[e]);return null==e?null:0===e?o.a.createElement(o.a.Fragment,null,0):o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:o.a.createElement(a.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},u=o.a.memo(l)},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return B})),n.d(t,"d",(function(){return V})),n.d(t,"e",(function(){return X})),n.d(t,"g",(function(){return ne.b})),n.d(t,"f",(function(){return ne.a}));var a=n(120);const i=a.enum(["true","false"]).or(a.boolean()).transform((e=>"boolean"==typeof e?e:"true"===e));var r=n(176),s=n(199);const o=a.z.literal("RULE_NOT_MODIFIED"),l=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:o}),u=a.z.object({id:a.z.string(),name:a.z.string().optional()}),c=a.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN","MANUAL_RULE_RUN_FEATURE","MANUAL_RULE_RUN_DISABLED_RULE"]),d=(c.enum,a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:c.optional(),rules:a.z.array(u)})),m=a.z.object({updated:a.z.array(r.e),created:a.z.array(r.e),deleted:a.z.array(r.e),skipped:a.z.array(l)}),p=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),f=a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),rules_count:a.z.number().int().optional(),attributes:a.z.object({results:m,summary:p,errors:a.z.array(d).optional()})}),b=a.z.string(),g=a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()}),v=g.merge(a.z.object({action:a.z.literal("delete")})),y=g.merge(a.z.object({action:a.z.literal("disable")})),h=g.merge(a.z.object({action:a.z.literal("enable")})),j=g.merge(a.z.object({action:a.z.literal("export")})),O=g.merge(a.z.object({action:a.z.literal("duplicate"),duplicate:a.z.object({include_exceptions:a.z.boolean(),include_expired_exceptions:a.z.boolean()}).optional()})),E=g.merge(a.z.object({action:a.z.literal("run"),run:a.z.object({start_date:a.z.string(),end_date:a.z.string().optional()})})),x=a.z.enum(["rule","1h","1d","7d"]),S=(x.enum,a.z.enum(["enable","disable","export","delete","duplicate","edit","run"]).enum),w=a.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule","add_investigation_fields","delete_investigation_fields","set_investigation_fields"]).enum,k=a.z.object({group:s.w,id:s.x,params:s.y,frequency:s.v.optional(),alerts_filter:s.u.optional()}).strict(),C=a.z.object({type:a.z.enum(["add_rule_actions","set_rule_actions"]),value:a.z.object({throttle:x.optional(),actions:a.z.array(k)})}),T=a.z.object({type:a.z.literal("set_schedule"),value:a.z.object({interval:a.z.string().regex(/^[1-9]\d*[smh]$/),lookback:a.z.string().regex(/^[1-9]\d*[smh]$/)})}),M=a.z.object({type:a.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:s.h,overwrite_data_views:a.z.boolean().optional()}),I=a.z.object({type:a.z.enum(["add_tags","delete_tags","set_tags"]),value:s.R}),_=a.z.object({type:a.z.enum(["add_investigation_fields","delete_investigation_fields","set_investigation_fields"]),value:s.i}),A=a.z.object({type:a.z.literal("set_timeline"),value:a.z.object({timeline_id:s.bb,timeline_title:s.cb})}),P=a.z.union([I,M,_,A,C,T]),D=g.merge(a.z.object({action:a.z.literal("edit"),edit:a.z.array(P).min(1)}));a.z.object({dry_run:i.optional()}),a.z.union([v,y,h,j,O,E,D]),a.z.union([f,b]);var F=n(374);a.z.array(a.z.union([r.e,F.a])),a.z.array(r.c),a.z.array(a.z.object({id:s.M.optional(),rule_id:s.P.optional()})),a.z.array(r.d),a.z.array(r.f);var R=n(46),N=n(2074),z=n(1371),L=n(2072);let B=function(e){return e.Enabled="enabled",e.Disabled="disabled",e}({});const q=Object(N.a)("CoverageOverviewRuleActivity",B);let V=function(e){return e.Prebuilt="prebuilt",e.Custom="custom",e}({});const $=Object(N.a)("CoverageOverviewRuleSource",V),U=R.partial({search_term:z.a,activity:Object(L.a)(q),source:Object(L.a)($)}),G=(R.exact(R.partial({filter:U})),R.type({name:R.string,activity:q})),H=(R.exact(R.type({coverage:R.record(R.string,Object(L.a)(R.string)),unmapped_rule_ids:R.array(R.string),rules_data:R.record(R.string,G)})),r.c,r.e,a.z.object({id:s.M.optional(),rule_id:s.P.optional()}),r.e,r.d,r.e,a.z.object({id:s.M.optional(),rule_id:s.P.optional()}),r.e,r.f,r.e,{exported_exception_list_count:R.number,exported_exception_list_item_count:R.number,missing_exception_list_item_count:R.number,missing_exception_list_items:R.array(R.exact(R.type({item_id:z.a}))),missing_exception_lists:R.array(R.exact(R.type({list_id:z.a}))),missing_exception_lists_count:R.number}),Q=(R.exact(R.type(H)),{exported_count:R.number,exported_rules_count:R.number,missing_rules:R.array(R.exact(R.type({rule_id:z.a}))),missing_rules_count:R.number}),W=R.intersection([R.exact(R.type({id:z.a,type:z.a})),R.exact(R.partial({reason:R.string}))]),K={exported_action_connector_count:R.number,missing_action_connection_count:R.number,missing_action_connections:R.array(R.exact(R.type({id:z.a,type:z.a}))),excluded_action_connection_count:R.number,excluded_action_connections:R.array(W)};R.intersection([R.exact(R.type(Q)),R.exact(R.partial(H)),R.exact(R.partial(K))]),a.z.object({exclude_export_details:i.optional().default(!1),file_name:a.z.string().optional().default("export.ndjson")}),a.z.object({objects:a.z.array(a.z.object({rule_id:s.P}))}).nullable();var J=n(1449),Y=n(330);const X=a.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);X.enum,a.z.object({fields:Object(J.a)(a.z.string()).optional(),filter:a.z.string().optional(),sort_field:X.optional(),sort_order:Y.a.optional(),page:a.z.coerce.number().int().min(1).optional().default(1),per_page:a.z.coerce.number().int().min(0).optional().default(20)}),a.z.object({page:a.z.number().int(),perPage:a.z.number().int(),total:a.z.number().int(),data:a.z.array(r.e)});var Z=n(2075);R.exact(R.type({rules_summary:R.type({custom_count:Z.a,prebuilt_installed_count:Z.a}),aggregated_fields:R.type({tags:R.array(R.string)})}));var ee=n(472);a.z.object({overwrite:i.optional().default(!1),overwrite_exceptions:i.optional().default(!1),overwrite_action_connectors:i.optional().default(!1),as_new_list:i.optional().default(!1)}),a.z.object({exceptions_success:a.z.boolean(),exceptions_success_count:a.z.number().int().min(0),exceptions_errors:a.z.array(F.a),rules_count:a.z.number().int().min(0),success:a.z.boolean(),success_count:a.z.number().int().min(0),errors:a.z.array(F.a),action_connectors_errors:a.z.array(F.a),action_connectors_warnings:a.z.array(ee.a),action_connectors_success:a.z.boolean(),action_connectors_success_count:a.z.number().int().min(0)}).strict();var te=n(290);te.b.and(te.g).and(te.d.partial().extend({rule_id:te.e,immutable:a.literal(!1).default(!1),required_fields:a.array(te.c).optional()})),s.R;var ne=n(473)},function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return r}));var a=n(0),i=n.n(a);let r=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),s=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){i()(this,"name",void 0),i()(this,"sortable",void 0),i()(this,"filterable",void 0),i()(this,"esTypes",void 0),this.name=e.name||s.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}const o=new kbn_field_type_KbnFieldType({name:s.UNKNOWN}),l=[new kbn_field_type_KbnFieldType({name:s.STRING,sortable:!0,filterable:!0,esTypes:[r.STRING,r.TEXT,r.MATCH_ONLY_TEXT,r.KEYWORD,r.VERSION,r._TYPE,r._ID]}),new kbn_field_type_KbnFieldType({name:s.NUMBER,sortable:!0,filterable:!0,esTypes:[r.FLOAT,r.HALF_FLOAT,r.SCALED_FLOAT,r.DOUBLE,r.INTEGER,r.LONG,r.UNSIGNED_LONG,r.SHORT,r.BYTE,r.TOKEN_COUNT,r.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:s.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[r.FLOAT_RANGE,r.DOUBLE_RANGE,r.INTEGER_RANGE,r.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:s.DATE,sortable:!0,filterable:!0,esTypes:[r.DATE,r.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:s.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[r.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:s.IP,sortable:!0,filterable:!0,esTypes:[r.IP]}),new kbn_field_type_KbnFieldType({name:s.IP_RANGE,sortable:!0,filterable:!0,esTypes:[r.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:s.BOOLEAN,sortable:!0,filterable:!0,esTypes:[r.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:s.OBJECT,esTypes:[r.OBJECT]}),new kbn_field_type_KbnFieldType({name:s.NESTED,esTypes:[r.NESTED]}),new kbn_field_type_KbnFieldType({name:s.GEO_POINT,esTypes:[r.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:s.GEO_SHAPE,esTypes:[r.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:s.ATTACHMENT,esTypes:[r.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:s.MURMUR3,esTypes:[r.MURMUR3]}),new kbn_field_type_KbnFieldType({name:s._SOURCE,esTypes:[r._SOURCE]}),new kbn_field_type_KbnFieldType({name:s.HISTOGRAM,filterable:!0,esTypes:[r.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:s.CONFLICT}),o],u=e=>{const t=l.find((t=>t.esTypes.includes(e)));return t&&t.name?t.name:s.UNKNOWN};function c(e){switch(e){case r._INDEX:return s.STRING;case"_version":return s.NUMBER;case"datetime":return s.DATE;default:return u(e)}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(119),i=n.n(a),r=n(52),s=n.n(r),o=n(2),l=n.n(o),u=n(41),c=n.n(u),d=n(206),m=n(196);const p=c.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1kulm59-0"})(["&.securitySolutionWrapper--fullHeight{height:100%;display:flex;flex-direction:column;flex:1 1 auto;}&.securitySolutionWrapper--noPadding{padding:0;display:flex;flex-direction:column;flex:1 1 auto;}"]);p.displayName="Wrapper";const f=({children:e,className:t,style:n,noPadding:a,noTimeline:r,...u})=>{const{globalFullScreen:c,setGlobalFullScreen:f}=Object(d.a)();Object(o.useEffect)((()=>{f(!1)}),[f]);const b=s()(t,{securitySolutionWrapper:!0,"securitySolutionWrapper--noPadding":a,"securitySolutionWrapper--withTimeline":!r,"securitySolutionWrapper--fullHeight":c});return l.a.createElement(p,i()({className:b,style:n},u),e,l.a.createElement(m.a,null))},b=l.a.memo(f)},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return l}));var a=n(475);let i=function(e){return e.DEFAULT="security-default-cellActions",e.DETAILS_FLYOUT="security-detailsFlyout-cellActions",e.ALERTS_COUNT="security-alertsCount-cellActions",e}({}),r=function(e){return e.HISTOGRAM_TRIGGER="security-discoverInTimeline-histogramTrigger",e}({}),s=function(e){return e.VIS_FILTER_ACTION="security-discoverInTimeline-visFilterAction",e}({}),o=function(e){return e.FILTER="security-cellAction-type-filter",e.COPY="security-cellAction-type-copyToClipboard",e.ADD_TO_TIMELINE="security-cellAction-type-addToTimeline",e.INVESTIGATE_IN_NEW_TIMELINE="security-cellAction-type-investigateInNewTimeline",e.SHOW_TOP_N="security-cellAction-type-showTopN",e.TOGGLE_COLUMN="security-cellAction-type-toggleColumn",e}({});const l={FILTER:a.c,COPY:a.a}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(894);const r=()=>Object(a.useContext)(i.a)},function(e,t,n){"use strict";var a=n(463);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}))},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1),t=a.useCallback((function(){return e.current}),[]);return a.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var a=n(44),i=n(395),r=n.n(i),s=n(2),o=n(118),l=n(512),u=n(294),c=n(123);const d=e=>Object(a.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),m=r()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(a.pick)(["name","searchable","type","aggregatable","esTypes","subType","conflictDescriptions"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),p={},f={fields:[],title:""},b=(e,t=!1,n="indexFields")=>{const{data:i}=Object(o.j)().services,r=Object(s.useRef)(new AbortController),d=Object(s.useRef)([]),[b,g]=Object(s.useState)({browserFields:p,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),{addError:v}=Object(c.a)(),y=Object(s.useCallback)((t=>{(async()=>{try{g({...b,loading:!0}),r.current=new AbortController;const e=await i.dataViews.create({title:t.join(","),allowNoIndex:!0}),n=e.toSpec(),{browserFields:a}=Object(u.a)(t,n.fields);d.current=e.getIndexPattern().split(","),g({loading:!1,dataView:n,browserFields:a,indexes:e.getIndexPattern().split(","),indexExists:e.getIndexPattern().split(",").length>0,indexPatterns:m(e.getIndexPattern(),e.fields)})}catch(t){g({browserFields:p,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),v(null==t?void 0:t.message,{title:l.a})}})()}),[v,i.dataViews,e,b]);return Object(s.useEffect)((()=>(Object(a.isEmpty)(e)||Object(a.isEqual)(d.current,e)||y(e),()=>{r.current.abort()})),[e,d]),[b.loading,b]}},,,,function(e,t,n){"use strict";var a=n(295);n.d(t,"b",(function(){return a.b})),n.d(t,"a",(function(){return a.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(118),r=n(246);const s=e=>{var t;const[{pageName:n}]=Object(r.a)(),{services:{storage:s}}=Object(i.j)(),o=((e,t)=>t&&e.length>0?`kibana.siem:${t}.query.toggle:${e}`:null)(n,e),[l,u]=Object(a.useState)(null==o||null===(t=s.get(o))||void 0===t||t);Object(a.useEffect)((()=>{var e;null!=o&&u(null===(e=s.get(o))||void 0===e||e)}),[s,o]);const c=Object(a.useCallback)((e=>{null!=o&&(s.set(o,e),u(e))}),[s,o]);return e?{toggleStatus:l,setToggleStatus:c}:{toggleStatus:!0,setToggleStatus:()=>{}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(207);const i=e=>`${Object(a.a)(e)}`,r=e=>`${Object(a.a)(e)}`,s=(e,t)=>`/id/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,l=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(7);const i=(e,t=!1)=>{if(Array.isArray(e))return e;const n={};return Object.entries(e).forEach((([e,i])=>{const r=t&&Array.isArray(i)&&1===i.length;Object(a.merge)(n,Object(a.setWith)({},e,r?i[0]:i,Object))})),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(119),i=n.n(a),r=n(2),s=n.n(r),o=n(19),l=n(45),u=n(148),c=n(138),d=n(183),m=n(13),p=n(200),f=n(127),b=n(146),g=n(121),v=n(331),y=n(172);const h=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:h,keepDataView:j,iconType:O,...E})=>{const x=Object(l.useDispatch)(),S=Object(l.useSelector)(u.e.signalIndexName),w=Object(l.useSelector)(u.e.defaultDataView),k=n&&n.find((e=>"template"===e.type)),C=Object(v.a)({timelineId:b.c.active,timelineType:k?g.m.template:g.m.default}),T=Object(r.useCallback)((async()=>{(n||a)&&(h?await C({timeRange:h}):await C(),n&&x(Object(m.updateProviders)({id:b.c.active,providers:n})),a&&x(Object(m.setFilters)({id:b.c.active,filters:a})),j||x(p.d.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:[S||""]})),x(d.b.removeLinkTo([c.a.timeline,c.a.global])))}),[n,C,x,w.id,S,a,h,j]);return e?s.a.createElement(o.EuiButtonEmpty,{"aria-label":y.i,onClick:T,flush:"right",size:"xs",iconType:O},t):s.a.createElement(o.EuiButton,i()({"aria-label":y.i,onClick:T},E),t)};h.displayName="InvestigateInTimelineButton"},,,,function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"m",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"n",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"o",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"q",(function(){return g})),n.d(t,"p",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return j}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),r=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),b=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),g=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),v=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),y=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),h=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),j=a.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef();return a.useEffect((function(){t.current=e})),t.current}},function(e,t,n){"use strict";n.d(t,"j",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(44),i=n(121),r=n(432);const s=(e,t)=>"__typename"!==e&&null!=t?t:void 0,o=e=>!Object(a.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===i.m.template?r.b(e):n?r.d(e):t?r.c(e):r.g(e),u=({eventId:e,pinnedEventIds:t})=>!0===t[e],c=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:i})=>{e&&(i?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),m=e=>{var t,n;return!Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n?void 0:n.building_block_type)},p=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,i;const t=(null!==(n=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},f=e=>{var t,n,i,r;return Object(a.isEmpty)(null==e||null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.uuid)?Object(a.isEmpty)(null==e||null===(r=e.eql)||void 0===r?void 0:r.parentId)?"raw":"eql":"signal"},b="note-content"},function(e,t,n){"use strict";n.d(t,"i",(function(){return d.h})),n.d(t,"g",(function(){return m.a})),n.d(t,"h",(function(){return p.g})),n.d(t,"a",(function(){return f.b})),n.d(t,"b",(function(){return f.c})),n.d(t,"c",(function(){return f.d})),n.d(t,"d",(function(){return f.f})),n.d(t,"e",(function(){return b.f})),n.d(t,"f",(function(){return b.g}));var a=n(120),i=n(268);const r=a.z.array(i.a).min(1),s=i.a,o=a.z.array(s),l=a.z.enum(["open","closed","acknowledged","in-progress"]),u=(l.enum,a.z.object({add:a.z.array(i.a),remove:a.z.array(i.a)})),c=(a.z.object({assignees:u,ids:r}),a.z.object({tags_to_add:o,tags_to_remove:o}));a.z.object({ids:r,tags:c}),a.z.object({}).catchall(a.z.unknown()),n(624),a.z.object({acknowledged:a.z.boolean()}),a.z.object({acknowledged:a.z.boolean()}),a.z.object({name:a.z.string(),index_mapping_outdated:a.z.boolean().nullable()}),n(247);var d=n(290),m=(n(374),n(471),n(425),n(330)),p=(n(472),n(440)),f=(n(501),n(232)),b=n(341);d.f.and(d.g).and(a.object({invocationCount:a.number(),timeframeEnd:a.string()}));const g=a.z.union([a.z.string(),a.z.object({}).catchall(a.z.unknown())]),v=a.z.union([g,a.z.array(g)]),y=(a.z.object({query:a.z.object({}).catchall(a.z.unknown()).optional(),aggs:a.z.object({}).catchall(a.z.unknown()).optional(),size:a.z.number().int().min(0).optional(),track_total_hits:a.z.boolean().optional(),_source:a.z.union([a.z.boolean(),a.z.string(),a.z.array(a.z.string())]).optional(),fields:a.z.array(a.z.string()).optional(),runtime_mappings:a.z.object({}).catchall(a.z.unknown()).optional(),sort:v.optional()}),a.z.object({}).catchall(a.z.unknown()),a.z.object({signal_ids:a.z.array(i.a).min(1),status:l})),h=a.z.object({query:a.z.object({}).catchall(a.z.unknown()),status:l,conflicts:a.z.enum(["abort","proceed"]).optional().default("abort")}),j=(a.z.union([y,h]),a.z.object({}).catchall(a.z.unknown()),a.z.object({requests_per_second:a.z.number().int().min(1).optional(),size:a.z.number().int().min(1).optional(),slices:a.z.number().int().min(1).optional()})),O=a.z.object({index:a.z.string(),migration_id:a.z.string(),migration_index:a.z.string()}),E=a.z.object({index:a.z.string(),error:a.z.object({message:a.z.string(),status_code:a.z.string()})}),x=a.z.object({index:a.z.string()}),S=(a.z.object({index:a.z.array(i.a).min(1)}).merge(j),a.z.object({indices:a.z.array(a.z.union([O,E,x]))}),a.z.object({id:a.z.string(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()})),w=(a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(S),a.z.object({id:a.z.string(),completed:a.z.boolean(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()}));a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(w);var k=n(2073);const C=a.z.object({version:a.z.number().int(),count:a.z.number().int()}),T=a.z.object({id:i.a,status:a.z.enum(["success","failure","pending"]),version:a.z.number().int(),updated:a.z.string().datetime()}),M=a.z.object({index:i.a,version:a.z.number().int(),signal_versions:a.z.array(C),migrations:a.z.array(T),is_outdated:a.z.boolean()});a.z.object({from:a.z.string().superRefine(k.a)}),a.z.object({indices:a.z.array(M)})},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n(5);var a=n(207);const i=(e,t)=>`/${e}${Object(a.a)(t)}`,r=(e,t)=>`/name/${e}${Object(a.a)(t)}`,s=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){return(e+1)%1e6};t.default=function(){return a.useReducer(i,0)[1]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var a=n(120);const i=a.z.enum(["going to run","running","partial failure","failed","succeeded"]),r=i.enum,s=a.z.number().int()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return m}));var a=n(5);const i="histogram-actions-trigger",r={[a.Oc.hosts]:"host",[a.Oc.users]:"user"},s=(e,t)=>{const n=r[e];return n&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${n}.name`,params:{query:t}},query:{match_phrase:{[`${n}.name`]:t}}}]:[]},o=e=>{const t=r[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],u=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],c=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var n,a,i,r,s,o;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(i=a.indexFilter)||void 0===i?void 0:i.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(r=null==t||null===(s=t.response)||void 0===s||null===(o=s.json)||void 0===o?void 0:o.rawResponse)&&void 0!==r?r:{},null,2)]}}),{requests:[],responses:[]}),m=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},function(e,t,n){const a=n(164);e.exports=(e,t,n=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!n)return null;throw e}}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return a.P})),n.d(t,"c",(function(){return a.q})),n.d(t,"a",(function(){return a.c})),n.d(t,"b",(function(){return i.a})),n.d(t,"d",(function(){return i.b})),n.d(t,"f",(function(){return i.g})),n.d(t,"g",(function(){return i.h})),n.d(t,"h",(function(){return r}));var a=n(199),i=n(176);function r(e){var t;return"external"===(null===(t=e.rule_source)||void 0===t?void 0:t.type)&&e.rule_source.is_customized}n(466),n(469),n(470),n(468),n(467)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(2),i=n(45),r=n(395),s=n.n(r),o=n(83),l=n(118),u=n(166),c=n(127),d=n(511),m=n(512),p=n(123);const f=s()(((e,t)=>{if(null==t)return{browserFields:{}};{const e={};for(const[n,a]of Object.entries(t)){const t=Object(o.getCategory)(n);null==e[t]&&(e[t]={fields:{}});const i=e[t].fields;i&&(i[n]=a)}return{browserFields:e}}}),((e,t)=>{var n,a;return e[0]===t[0]&&(null===(n=e[1])||void 0===n?void 0:n.length)===(null===(a=t[1])||void 0===a?void 0:a.length)})),b=()=>{const{data:e}=Object(l.j)().services,t=Object(a.useRef)({}),n=Object(a.useRef)({}),r=Object(i.useDispatch)(),{addError:s}=Object(p.a)(),o=Object(a.useCallback)((({id:e,loading:t})=>{r(u.a.setDataViewLoading({id:e,loading:t}))}),[r]);return{indexFieldsSearch:Object(a.useCallback)((({dataViewId:a,scopeId:i=c.SourcererScopeName.default,needToBeInit:l=!1,cleanCache:p=!1,skipScopeUpdate:f=!1})=>(n.current[a]&&n.current[a].unsubscribe(),t.current[a]&&t.current[a].abort(),(async()=>{try{t.current={...t.current,[a]:new AbortController},o({id:a,loading:!0});const n=await Object(d.a)(a,e.dataViews,p);l&&i&&!f&&r(u.a.setSelectedDataView({id:i,selectedDataViewId:a,selectedPatterns:n.patternList})),r(u.a.setDataView({...n,loading:!1}))}catch(e){s(null==e?void 0:e.message,{title:m.a})}})())),[o,e.dataViews,r,s])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var a=n(2),i=n.n(a),r=n(8),s=n.n(r),o=n(3),l=n(48),u=n(794),c=n(131),d=n(118),m=n(170);const p={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{},hidden:!1,setAllTourStepsHidden:()=>{}},f=Object(a.createContext)(p),b=({children:e})=>{var t,n,r,l;const{guidedOnboarding:c}=Object(d.j)().services,[p,b]=Object(a.useState)(!1),g=Object(a.useCallback)((e=>{b(e)}),[]),v=s()(null!==(t=null==c||null===(n=c.guidedOnboardingApi)||void 0===n?void 0:n.isGuideStepActive$(u.a,m.b.rules).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==t?t:Object(o.of)(!1),!1),y=s()(null!==(r=null==c||null===(l=c.guidedOnboardingApi)||void 0===l?void 0:l.isGuideStepActive$(u.a,m.b.alertsCases).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==r?r:Object(o.of)(!1),!1),h=Object(a.useMemo)((()=>({[m.b.rules]:{active:v,hidden:!1},[m.b.alertsCases]:{active:y,hidden:!1}})),[v,y]),j=Object(a.useCallback)((e=>h[e].active),[h]),[O,E]=Object(a.useState)(1),x=Object(a.useCallback)((e=>{E((t=>(t>=m.g[e].length?0:t)+1))}),[]),S=Object(a.useCallback)(((e,t)=>{t<=m.g[e].length&&E(t)}),[]),[w,k]=Object(a.useState)(null);Object(a.useEffect)((()=>{if(!w||null==c||!c.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==c||null===(t=c.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(u.a,w)),e||(k(null),E(1))})(),()=>{e=!0}}),[w,c]);const C=Object(a.useCallback)((e=>{k(e)}),[]),T=Object(a.useMemo)((()=>({hidden:p,setAllTourStepsHidden:g,activeStep:O,endTourStep:C,incrementStep:x,isTourShown:j,setStep:S})),[O,C,p,x,j,g,S]);return i.a.createElement(f.Provider,{value:T},e)},g=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),n=Object(a.useMemo)((()=>Object(c.isTourPath)(t)?b:f.Provider),[t]);return i.a.createElement(n,{value:p},e)},v=()=>{const e=Object(a.useContext)(f);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return E.a}));var a=n(119),i=n.n(a),r=n(2),s=n.n(r),o=n(44),l=n(19),u=n(476),c=n.n(u),d=n(42),m=n(696);const p=({disableLinks:e,href:t,target:n,children:a,...i})=>s.a.createElement(l.EuiToolTip,{content:t},s.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),f=Object(r.memo)(p);var b=n(118),g=n(16),v=n(4);const y=v.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),h=v.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),j=({children:e,disableLinks:t,textSize:n="m"})=>{const a=Object(r.useMemo)((()=>e=>s.a.createElement(f,i()({},e,{disableLinks:t}))),[t]),u=Object(o.cloneDeep)(m.c);u[1][1].components.a=a;const p=Object(g.b)().isAtLeast("platinum"),{application:v}=Object(b.j)().services,j=Object(r.useMemo)((()=>{if(!1===p){const t=String(e);return m.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,p]),O=Object(r.useMemo)((()=>c()().use(m.a).use(u)),[u]),E=Object(r.useMemo)((()=>{try{return O.processSync(e),null}catch(e){return String(e.message)}}),[e,O]);return s.a.createElement(s.a.Fragment,null,j&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:y,color:"primary",iconType:"lock"},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:s.a.createElement(l.EuiLink,{href:v.getUrlForApp("management",{path:"stack/license_management/home"})},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),s.a.createElement(l.EuiSpacer,{size:"s"})),null!==E&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:h,color:"danger",iconType:"error"},E),s.a.createElement(l.EuiSpacer,{size:"s"})),s.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:m.a,processingPluginList:u,textSize:n},e))};j.displayName="MarkdownRendererComponent";const O=Object(r.memo)(j);var E=n(481);n(581)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const i={},r=n.n(a).a.createContext(i)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(119),i=n.n(a),r=n(2),s=n.n(r),o=n(19),l=n(42),u=n(41),c=n.n(u),d=n(124),m=n(149),p=n(158),f=n(129),b=n(295),g=n(170),v=n(48),y=n(118),h=n(198),j=n(213);const O=(e,t)=>(t===g.a.createCase||t===g.a.submitCase)&&e===g.b.alertsCases,E=c()(o.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>O(t,e)?"9000 !important":"1000 !important")),x=s.a.memo((({children:e,onClick:t,step:n,tourId:a})=>{const{activeStep:u,incrementStep:c,isTourShown:v}=Object(b.b)(),y=Object(r.useMemo)((()=>g.g[a].find((e=>e.step===n))),[n,a]),h=Object(r.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),j=Object(d.b)((e=>{var t;return(null!==(t=h(e,m.f.active))&&void 0!==t?t:p.b).show})),x=Object(r.useCallback)((()=>t?t():c(a)),[c,t,a]),S=Object(r.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),w=O(a,n);if(null==y||(n!==u||!v(a))&&!w||j)return e||null;const{anchor:k,content:C,imageConfig:T,dataTestSubj:M,hideNextButton:I=!1,..._}=y,A=I?s.a.createElement(s.a.Fragment,null):s.a.createElement(o.EuiButtonEmpty,{onClick:x,onKeyDown:S,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),P={..._,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,C)),T&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiImage,{alt:T.altText,src:T.src,size:"fullWidth"}))),footerAction:A,isStepOpen:!0,onFinish:()=>null,stepsTotal:g.g[a].length,panelProps:{"data-test-subj":M}};return null!=k?s.a.createElement(s.a.Fragment,null,s.a.createElement(E,i()({tourId:a},P,{anchor:k})),s.a.createElement(s.a.Fragment,null,e)):null!=e?s.a.createElement(E,i()({tourId:a},P),e):null}));x.displayName="SecurityTourStep";const S=s.a.memo((({children:e,isTourAnchor:t=!0,...n})=>t?s.a.createElement(w,n,e):s.a.createElement(s.a.Fragment,null,e)));S.displayName="GuidedOnboardingTourStep";const w=s.a.memo((({children:e,...t})=>{const{hidden:n}=Object(b.b)(),a=(({tourId:e,step:t})=>{const{useIsAddToCaseOpen:n}=Object(y.j)().services.cases.hooks,a=n(),{search:i}=Object(v.useLocation)(),s=Object(r.useMemo)((()=>Object(j.c)(h.a.flyout,i)),[i]),o=null==s?void 0:s.left,l=Object(r.useMemo)((()=>{var e;return o&&(null===(e=g.e[g.b.alertsCases])||void 0===e?void 0:e.includes(t))}),[o,t]),u=Object(r.useMemo)((()=>{var n;return a&&(null===(n=g.d[e])||void 0===n?void 0:n.includes(t))}),[a,e,t]);return l||u})({tourId:t.tourId,step:t.step});return n||a?s.a.createElement(s.a.Fragment,null,e):s.a.createElement(x,t,e)}));w.displayName="SecurityTourStepAnchor"},,,,,,function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=n(348),s=n(347),o=(t=e.exports={}).re=[],l=t.safeRe=[],u=t.src=[],c=t.t={};let d=0;const m="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",r],[m,i]],f=(e,t,n)=>{const a=(e=>{for(const[t,n]of p)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;s(e,i,t),c[e]=i,u[i]=t,o[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(a,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),f("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${m}+`),f("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),f("FULL",`^${u[c.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),f("LOOSE",`^${u[c.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),f("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),f("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?`+`(?:${u[c.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",u[c.COERCE],!0),f("COERCERTLFULL",u[c.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return g}));var a=n(2),i=n.n(a),r=n(19),s=n(41),o=n.n(s),l=n(42),u=n(130);const c=({children:e,...t})=>i.a.createElement(r.EuiButton,t,e),d=({children:e,...t})=>i.a.createElement(r.EuiLink,t,e),m=o()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);m.displayName="Comma";const p=({children:e,Component:t,dataTestSubj:n,href:a,onClick:r,title:s,iconType:o="expand"})=>t?i.a.createElement(t,{"data-test-subj":n,href:a,iconType:o,onClick:r,title:s},null!=s?s:e):i.a.createElement(c,{"data-test-subj":n,href:a,onClick:r},null!=s?s:e),f=i.a.memo(p),b=o.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),g=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:s})=>{const[o,u]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>u((e=>!e))),[]),d=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null," ,",i.a.createElement(r.EuiButtonEmpty,{size:"xs",onClick:c},`+${s.length-t} `,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[c,t,s.length]);return i.a.createElement(r.EuiFlexItem,{grow:!1},s.length>t&&i.a.createElement(r.EuiPopover,{id:"popover",button:d,isOpen:o,closePopover:c,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},i.a.createElement(v,{render:n,rowItems:s,moreMaxHeight:e,overflowIndexStart:t})))}));g.displayName="ReputationLinksOverflow";const v=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:s})=>{const o=Object(a.useMemo)((()=>s.slice(t).map(((e,t)=>{var a;return i.a.createElement(r.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(u.a)(e))}))),[t,n,s]);return i.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},o))}));v.displayName="MoreReputationLinksContainer"},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,n){"use strict";e.exports=n(710)},function(e,t,n){"use strict";e.exports=n(711)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(371);t.default=function(e,t){var n=i.useFirstMountState();a.useEffect((function(){if(!n)return e()}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){void 0===e&&(e={});var t=a.useState(e),n=t[0],i=t[1];return[n,a.useCallback((function(e){i((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[i])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect(e,[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(373));t.default=function(e){var t=i.useRef(0),n=i.useState(e),a=n[0],s=n[1],o=i.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){s(e)}))}),[]);return r.default((function(){cancelAnimationFrame(t.current)})),[a,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(120).z.enum(["asc","desc"]);a.enum},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(2),i=n(45),r=n(138),s=n(243),o=n(129),l=n(206),u=n(146),c=n(121),d=n(124),m=n(183),p=n(166),f=n(127),b=n(260),g=n(513),v=n(122),y=n(274),h=n(158);const j=({timelineId:e,timelineType:t,onClick:n})=>{var j;const O=Object(i.useDispatch)(),E=Object(v.a)("unifiedComponentsInTimelineDisabled"),{id:x,patternList:S}=null!==(j=Object(i.useSelector)(p.d.defaultDataView))&&void 0!==j?j:{id:"",patternList:[]},{timelineFullScreen:w,setTimelineFullScreen:k}=Object(l.c)(),C=Object(d.a)(m.d.globalTimeRangeSelector),{resetDiscoverAppState:T}=Object(g.a)(),M=Object(a.useCallback)((({id:e,show:n,timeRange:a})=>{const i=null!=a?a:C;e===u.c.active&&w&&k(!1),O(p.a.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:x,selectedPatterns:S})),O(o.a.createTimeline({columns:E?s.b:y.a,dataViewId:x,id:e,indexNames:S,show:n,timelineType:t,updated:void 0,excludedRowRendererIds:E||t===c.m.template?[]:h.b.excludedRowRendererIds})),O(m.b.addLinkTo([r.a.global,r.a.timeline])),O(b.a.addNotes({notes:[]})),a&&O(m.b.removeLinkTo([r.a.timeline,r.a.global])),"absolute"===(null==i?void 0:i.kind)?O(m.b.setAbsoluteRangeDatePicker({...i,id:r.a.timeline})):"relative"===(null==i?void 0:i.kind)&&O(m.b.setRelativeRangeDatePicker({...i,id:r.a.timeline}))}),[O,C,x,S,k,w,t,E]);return Object(a.useCallback)((async a=>{await T(),M({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n()}),[M,e,t,n,T])}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return k})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return C})),n.d(t,"f",(function(){return y.a})),n.d(t,"g",(function(){return y.b})),n.d(t,"h",(function(){return j})),n.d(t,"a",(function(){return T}));var a=n(46),i=n(1531);let r=function(e){return e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range",e}({}),s=function(e){return e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month",e}({});const o=a.union([a.exact(a.type({type:a.literal(r.last_hour),granularity:a.literal(s.minute)})),a.exact(a.type({type:a.literal(r.last_day),granularity:a.union([a.literal(s.minute),a.literal(s.hour)])})),a.exact(a.type({type:a.literal(r.last_week),granularity:a.union([a.literal(s.hour),a.literal(s.day)])})),a.exact(a.type({type:a.literal(r.last_month),granularity:a.union([a.literal(s.day),a.literal(s.week)])})),a.exact(a.type({type:a.literal(r.last_year),granularity:a.union([a.literal(s.week),a.literal(s.month)])})),a.exact(a.type({type:a.literal(r.custom_range),granularity:a.union([a.literal(s.minute),a.literal(s.hour),a.literal(s.day),a.literal(s.week),a.literal(s.month)]),from:i.a,to:i.a}))]);a.exact(a.partial({interval:o,debug:a.boolean}));var l=n(1371);a.exact(a.intersection([a.type({rule_id:l.a}),a.partial({interval:o,debug:a.boolean})])),a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.type({}));var u=n(120),c=n(1449);const d=u.z.enum(["trace","debug","info","warn","error"]),m=d.enum,p=u.z.enum(["message","status-change","execution-metrics"]),f=p.enum,b=u.z.object({timestamp:u.z.string().datetime(),sequence:u.z.number().int(),level:d,type:p,execution_id:u.z.string().min(1),message:u.z.string()});var g=n(330),v=n(471);u.z.object({search_term:u.z.string().optional(),event_types:Object(c.a)(p).optional().default([]),log_levels:Object(c.a)(d).optional().default([]),date_start:u.z.string().datetime().optional(),date_end:u.z.string().datetime().optional(),sort_order:g.a.optional().default("desc"),page:u.z.coerce.number().int().optional().default(1),per_page:u.z.coerce.number().int().optional().default(20)}),u.z.object({ruleId:u.z.string().min(1)}),u.z.object({events:u.z.array(b),pagination:v.a});var y=n(281);const h=u.z.enum(["backfill","standard"]),j=h.enum,O=u.z.object({execution_uuid:u.z.string(),timestamp:u.z.string().datetime(),duration_ms:u.z.number().int(),status:u.z.string(),message:u.z.string(),num_active_alerts:u.z.number().int(),num_new_alerts:u.z.number().int(),num_recovered_alerts:u.z.number().int(),num_triggered_actions:u.z.number().int(),num_succeeded_actions:u.z.number().int(),num_errored_actions:u.z.number().int(),total_search_duration_ms:u.z.number().int(),es_search_duration_ms:u.z.number().int(),schedule_delay_ms:u.z.number().int(),timed_out:u.z.boolean(),indexing_duration_ms:u.z.number().int(),search_duration_ms:u.z.number().int(),gap_duration_s:u.z.number().int(),security_status:u.z.string(),security_message:u.z.string(),backfill:u.z.object({from:u.z.string().datetime(),to:u.z.string().datetime()}).optional()}),E=u.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);E.enum,u.z.object({start:u.z.string().datetime(),end:u.z.string().datetime(),query_text:u.z.string().optional().default(""),status_filters:Object(c.a)(y.a).optional().default([]),run_type_filters:Object(c.a)(h).optional().default([]),sort_field:E.optional().default("timestamp"),sort_order:g.a.optional().default("desc"),page:u.z.coerce.number().int().optional().default(1),per_page:u.z.coerce.number().int().optional().default(20)}),u.z.object({ruleId:u.z.string().min(1)}),u.z.object({events:u.z.array(O).optional(),total:u.z.number().int().optional()});var x=n(5);x.Lb,x.Lb,x.Lb;const S=`${x.Lb}/health/_setup`,w=(x.Lb,e=>`${x.Lb}/rules/${e}/execution/events`),k=(x.Lb,e=>`${x.Lb}/rules/${e}/execution/results`);n(465);let C=function(e){return e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off",e}({});n(227),n(464);const T=d.options},,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return S}));var a=n(63),i=n.n(a),r=n(19),s=n(44),o=n(2),l=n.n(o),u=n(45),c=n(188),d=n.n(c),m=n(1332),p=n(5),f=n(129),b=n(118),g=n(200),v=n(138),y=n(460);const h={fill:!1},j=e=>{e.forEach((e=>e.refetch&&e.refetch()))},O=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:i,kqlQuery:u,policy:c,queries:d,setDuration:m,showUpdateButton:f=!0,start:g,startAutoReload:v,stopAutoReload:y,timelineId:O,toStr:x,updateReduxTime:S,disabled:w,width:k="restricted",compressed:C=!1})=>{const[T,M]=Object(o.useState)([]),I=Object(o.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:r}=S({end:n,id:a,isInvalid:!1,isQuickSelection:i,kql:u,start:e,timelineId:O,hasRangeChanged:!1}),s=E(e),o=i?E(n,{roundUp:!0}):E(n);!d||r||i&&(g!==s||t!==o)||j(d)}),[t,a,u,d,g,O,S]),_=Object(o.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=n&&n.includes("now")||null!=x&&x.includes("now");e!==i&&m({id:a,duration:i}),t&&"interval"===c?y({id:a}):t||"manual"!==c||v({id:a}),d&&!t&&(!r||r&&"now"!==x)&&j(d)}),[n,x,e,c,m,a,y,v,d]),A=Object(o.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){S({end:t,id:a,isInvalid:n,isQuickSelection:i,kql:u,start:e,timelineId:O,hasRangeChanged:!0});const r=[{start:e,end:t},...Object(s.take)(9,T.filter((n=>!(n.start===e&&n.end===t))))];M(r)}}),[S,a,u,O,T]),P=null!=x?x:new Date(t).toISOString(),D=null!=n?n:new Date(g).toISOString(),[F]=Object(b.o)(p.db),[R]=Object(b.o)(p.K),N=Object(s.isEmpty)(F)?[]:F.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:N,end:P,isLoading:i,isPaused:"manual"===c,onRefresh:I,onRefreshChange:_,onTimeChange:A,recentlyUsedRanges:T,refreshInterval:e,showUpdateButton:f,start:D,isDisabled:w,width:k,compressed:C,updateButtonProps:h,dateFormat:R})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),E=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},x=e=>({end:t,id:n,isQuickSelection:a,kql:i,start:r,timelineId:s,hasRangeChanged:o})=>{const l=E(r);let u=E(t,{roundUp:!0});var c;return a?e(t===r?g.c.setAbsoluteRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:u}):g.c.setRelativeRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:u})):(u=E(t),e(g.c.setAbsoluteRangeDatePicker({id:n,from:E(r),to:E(t)}))),null!=s&&o&&e(f.a.updateRange({id:s,start:l,end:u})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(c=i.refetch(e))&&void 0!==c&&c}:{kqlHaveBeenUpdated:!1}};O.displayName="SuperDatePickerComponent";const S=Object(u.connect)((()=>{const e=Object(y.a)(),t=Object(y.b)(),n=Object(y.c)(),a=Object(y.d)(),i=Object(y.e)(),r=Object(y.f)(),o=Object(y.g)(),l=Object(y.h)(),u=Object(y.i)(),c=Object(y.j)();return(d,{id:p})=>{const f=Object(s.getOr)({},`inputs.${p}`,d);return{duration:e(f),end:t(f),fromStr:n(f),kind:i(f),policy:o(f),start:u(f),toStr:c(f),isLoading:!1,...Object(m.c)(f)&&(p===v.a.timeline||p===v.a.global)&&{isLoading:a(f),kqlQuery:r(f),queries:l(d,p)}}}}),(e=>({startAutoReload:({id:t})=>e(g.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(g.c.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(g.c.setDuration({id:t,duration:n})),updateReduxTime:x(e)})))(O)},function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(892))},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},function(e,t,n){"use strict";n.r(t),n.d(t,"HostsType",(function(){return a})),n.d(t,"HostsTableType",(function(){return i}));let a=function(e){return e.page="page",e.details="details",e}({}),i=function(e){return e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions",e}({})},,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(44);const i=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},r=["http:","https:"],s=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(r.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function o(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return L})),n.d(t,"c",(function(){return q})),n(553);var a=n(44),i=n(2),r=n.n(i),s=n(43);const o=Object(i.createContext)(null),l=({children:e,getTriggerCompatibleActions:t})=>{const n=Object(i.useMemo)((()=>({getActions:e=>t(e.trigger.id,e).then((e=>Object(a.orderBy)(["order","id"],["asc","asc"],e)))})),[t]);return Object(s.jsx)(o.Provider,{value:n},e)},u=()=>{const e=Object(i.useContext)(o);if(!e)throw new Error("No CellActionsContext found. Please wrap the application with CellActionsProvider");return e};var c=n(19),d=n(119),m=n.n(d);const p=({action:e,actionContext:t,showTooltip:n,onClick:a})=>{const r=Object(i.useMemo)((()=>({iconType:e.getIconType(t),onClick:()=>{e.execute(t),a&&a()},"data-test-subj":`actionItem-${e.id}`,"aria-label":e.getDisplayName(t)})),[e,t,a]);return r.iconType?n?Object(s.jsx)(c.EuiToolTip,{content:e.getDisplayNameTooltip?e.getDisplayNameTooltip(t):""},Object(s.jsx)(c.EuiButtonIcon,m()({},r,{iconSize:"s"}))):Object(s.jsx)(c.EuiButtonIcon,m()({},r,{iconSize:"s"})):null},f=(e,t)=>t<=1?{extraActions:e,visibleActions:[]}:e.length<=t?{extraActions:[],visibleActions:e}:{visibleActions:e.slice(0,t-1),extraActions:e.slice(t-1,e.length)};var b=n(49),g=n(4);const v=e=>g.i18n.translate("cellActions.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:e},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."}),y=g.i18n.translate("cellActions.extraActionsAriaLabel",{defaultMessage:"Extra actions"}),h=g.i18n.translate("cellActions.showMoreActionsLabel",{defaultMessage:"More actions"}),j=g.i18n.translate("cellActions.actionsAriaLabel",{defaultMessage:"Actions"}),O=Object(s.css)("color:",b.euiThemeVars.euiColorPrimaryText,";",""),E=({anchorPosition:e,actions:t,actionContext:n,isOpen:a,closePopOver:i,button:r})=>Object(s.jsx)(c.EuiPopover,{button:r,isOpen:a,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!0,repositionOnScroll:!0,ownFocus:!0,"data-test-subj":"extraActionsPopOver","aria-label":y},Object(s.jsx)(S,{actions:t,actionContext:n,closePopOver:i})),x=({anchorPosition:e,anchorRef:t,actionContext:n,isOpen:a,closePopOver:i,actions:r})=>t.current?Object(s.jsx)(c.EuiWrappingPopover,{"aria-label":y,button:t.current,isOpen:a,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!1,repositionOnScroll:!0,ownFocus:!0,attachToAnchor:!1,"data-test-subj":"extraActionsPopOverWithAnchor"},Object(s.jsx)(S,{actions:r,actionContext:n,closePopOver:i})):null,S=({actionContext:e,actions:t,closePopOver:n})=>{const a=Object(i.useMemo)((()=>t.map((t=>Object(s.jsx)(c.EuiContextMenuItem,{css:O,key:t.id,icon:t.getIconType(e),"aria-label":t.getDisplayName(e),"data-test-subj":`actionItem-${t.id}`,onClick:()=>{n(),t.execute(e)}},t.getDisplayName(e))))),[e,t,n]);return Object(s.jsx)(r.a.Fragment,null,Object(s.jsx)(c.EuiScreenReaderOnly,null,Object(s.jsx)("p",null,v(e.data.map((({field:e})=>e.name)).join(", ")))),Object(s.jsx)(c.EuiContextMenuPanel,{size:"s",items:a}))},w=({onClick:e,showTooltip:t})=>t?Object(s.jsx)(c.EuiToolTip,{content:h},Object(s.jsx)(c.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":h,iconType:"boxesHorizontal",onClick:e})):Object(s.jsx)(c.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":h,iconType:"boxesHorizontal",onClick:e});var k=n(445),C=n.n(k),T=n(427),M=n.n(T);const I=e=>{if(e)throw e},_=(e,t)=>Object(i.useMemo)((()=>A(e,t)),[e,t]),A=(e,t=[])=>e?e.filter((({type:e})=>!(null!=t&&t.includes(e)))):void 0,P=({actionContext:e,anchorPosition:t,showActionTooltips:n,visibleCellActions:a,disabledActionTypes:r})=>{const{value:o}=((e,t={})=>{const{getActions:n}=u(),{error:a,value:i,loading:r}=C()((()=>n(e)),[]),s=_(i,t.disabledActionTypes);return I(a),{value:s,loading:r}})(e,{disabledActionTypes:r}),{extraActions:l,visibleActions:d}=((e,t)=>Object(i.useMemo)((()=>f(null!=e?e:[],t)),[e,t]))(null!=o?o:[],a),[m,b]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>b((e=>!e))),[]),v=Object(i.useCallback)((()=>b(!1)),[]),y=Object(i.useMemo)((()=>Object(s.jsx)(w,{onClick:g,showTooltip:n})),[g,n]);return Object(s.jsx)(c.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"none","data-test-subj":"inlineActions",className:"inlineActions "+(m?"inlineActions-popoverOpen":"")},d.map((t=>Object(s.jsx)(c.EuiFlexItem,{grow:!1,key:`action-item-${t.id}`},Object(s.jsx)(p,{action:t,actionContext:e,showTooltip:n})))),l.length>0?Object(s.jsx)(c.EuiFlexItem,{grow:!1},Object(s.jsx)(E,{actions:l,actionContext:e,anchorPosition:t,button:y,closePopOver:v,isOpen:m})):null)};var D=n(7);const F={minWidth:"24px"},R=Object(s.css)("padding:0 ",b.euiThemeVars.euiSizeS,";",""),N=({anchorPosition:e,children:t,visibleCellActions:n,actionContext:a,showActionTooltips:o,disabledActionTypes:l})=>{const d=Object(i.useRef)(null),[m,g]=Object(i.useState)(!1),[y,h]=Object(i.useState)(!1),[{value:O},E]=((e={})=>{const{getActions:t}=u(),[{error:n,value:a,loading:i},r]=M()(t,[]),s=_(a,e.disabledActionTypes);return I(n),[{value:s,loading:i},r]})({disabledActionTypes:l}),{visibleActions:S,extraActions:k}=Object(i.useMemo)((()=>f(null!=O?O:[],n)),[O,n]),C=Object(i.useMemo)((()=>Object(D.debounce)((()=>{document.body.classList.contains("is-dragging")||h(!0)}),100)),[]);Object(i.useEffect)((()=>()=>{C.cancel()}),[C]);const T=Object(i.useCallback)((()=>{C.cancel(),h(!1)}),[C]),A=Object(i.useCallback)((()=>g(!1)),[g]),P=Object(i.useCallback)((()=>{g(!0),T()}),[T,g]),N=Object(i.useCallback)((async()=>{m||(void 0===O&&E(a),C())}),[m,O,C,E,a]),z=Object(i.useMemo)((()=>Object(s.jsx)("div",{ref:d,onMouseEnter:N,onClick:A},t)),[N,A,t]),L=Object(i.useMemo)((()=>"rightCenter"===e?{marginTop:b.euiThemeVars.euiSizeS}:{}),[e]);return Object(s.jsx)(r.a.Fragment,null,Object(s.jsx)("div",{onMouseLeave:T},Object(s.jsx)(c.EuiPopover,{panelStyle:{...F,...L},anchorPosition:e,button:z,closePopover:T,hasArrow:!1,isOpen:y,panelPaddingSize:"none",repositionOnScroll:!0,ownFocus:!1,panelProps:{"data-test-subj":"hoverActionsPopover"},"aria-label":j},y&&Object(s.jsx)("div",{css:R},Object(s.jsx)(c.EuiScreenReaderOnly,null,Object(s.jsx)("p",null,v(a.data.map((({field:e})=>e.name)).join(", ")))),S.map((e=>Object(s.jsx)(p,{key:e.id,action:e,actionContext:a,showTooltip:o,onClick:T}))),k.length>0&&Object(s.jsx)(w,{onClick:P,showTooltip:o})))),Object(s.jsx)(x,{anchorPosition:e,actions:k,anchorRef:d,actionContext:a,closePopOver:A,isOpen:m}))};var z=n(411);const L=({data:e,triggerId:t,children:n,mode:r,showActionTooltips:o=!0,visibleCellActions:l=3,disabledActionTypes:u=[],metadata:d,className:m})=>{const p=Object(i.useRef)(null),f=Object(i.useMemo)((()=>Object(a.isArray)(e)?e:[e]),[e]),b=Object(i.useMemo)((()=>({data:f,trigger:{id:t},nodeRef:p,metadata:d})),[f,t,d]),g=Object(i.useMemo)((()=>r===z.b.HOVER_DOWN?"downCenter":"rightCenter"),[r]),v=`cellActions-renderContent-${f.map((({field:e})=>e.name)).join("-")}`;return r===z.b.HOVER_DOWN||r===z.b.HOVER_RIGHT?Object(s.jsx)("div",{className:m,ref:p,"data-test-subj":v},Object(s.jsx)(N,{anchorPosition:g,actionContext:b,showActionTooltips:o,visibleCellActions:l,disabledActionTypes:u},n)):Object(s.jsx)(c.EuiFlexGroup,{responsive:!1,alignItems:"center",ref:p,gutterSize:"none",justifyContent:"flexStart",className:m,"data-test-subj":v},Object(s.jsx)(c.EuiFlexItem,{grow:!1},n),Object(s.jsx)(c.EuiFlexItem,{grow:!1},Object(s.jsx)(P,{anchorPosition:g,actionContext:b,showActionTooltips:o,visibleCellActions:l,disabledActionTypes:u})))},B=[],q=({fields:e,getCellValue:t,triggerId:n,metadata:a,dataGridRef:r,disabledActionTypes:s=[]})=>{const[o,l]=Object(i.useState)(B),c=Object(i.useMemo)((()=>{if(n&&null!=e&&e.length)return e.map((e=>({data:[{field:e}],trigger:{id:n},metadata:a})))}),[e,n,a]),{loading:d,value:m}=((e,t={})=>{const{getActions:n}=u(),{error:a,...i}=C()((()=>{var a;return Promise.all(null!==(a=null==e?void 0:e.map((e=>n(e).then((e=>{var n;return null!==(n=A(e,t.disabledActionTypes))&&void 0!==n?n:[]})))))&&void 0!==a?a:[])}),[e]);return I(a),i})(c,{disabledActionTypes:s});return Object(i.useEffect)((()=>{!d&&n&&null!=m&&m.length&&null!=e&&e.length&&m.length===e.length&&l(m.map(((i,s)=>i.map((i=>V({action:i,field:e[s],getCellValue:t,metadata:a,triggerId:n,dataGridRef:r}))))))}),[m,e,t,d,a,n,r]),o},V=({action:e,field:t,getCellValue:n,metadata:a,triggerId:r,dataGridRef:o})=>function({Component:l,rowIndex:u,isExpanded:c}){var d;const m=Object(i.useRef)(null),p=Object(i.useRef)(null),f=Object(i.useMemo)((()=>{const{name:e}=t,i=n(e,u);return{data:[{field:t,value:i}],trigger:{id:r},nodeRef:m,metadata:a}}),[u]),b=Object(i.useCallback)((async()=>{f.nodeRef.current=await $({dataGrid:o.current,isExpanded:c,buttonRef:p}),e.execute(f)}),[f,c]);return Object(s.jsx)(l,{buttonRef:p,"aria-label":e.getDisplayName(f),title:e.getDisplayName(f),"data-test-subj":`dataGridColumnCellAction-${e.id}`,iconType:null!==(d=e.getIconType(f))&&void 0!==d?d:"",onClick:b},e.getDisplayName(f))},$=({dataGrid:e,isExpanded:t,buttonRef:n})=>new Promise((a=>{const i=t?document.querySelector('div[role="gridcell"].euiDataGridRowCell--open'):U(n.current);null==e||e.closeCellPopover(),setTimeout((()=>{var e;a(null!==(e=null==i?void 0:i.firstElementChild)&&void 0!==e?e:null)}))})),U=e=>null==e?null:"DIV"===e.nodeName&&"gridcell"===e.getAttribute("role")?e:U(e.parentElement)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return O}));var a=n(2),i=n.n(a),r=n(41),s=n.n(r);const o=s.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(r.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(r.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));o.displayName="Bar";const l=s.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));l.displayName="BarSection";const u=s.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));u.displayName="BarGroup";const c=s.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(r.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));c.displayName="BarText";const d=s.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const m=s.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(r.css)(["flex:1;"])));m.displayName="BarSpacer";const p=i.a.memo((({border:e,children:t})=>i.a.createElement(o,{border:e},t)));p.displayName="UtilityBar";var f=n(19),b=n(907);const g=s()(f.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(r.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),v=i.a.memo((({children:e,color:t,iconSide:n,iconSize:r,iconType:s,popoverContent:o,disabled:l,ownFocus:u,dataTestSubj:c,popoverPanelPaddingSize:d,onClick:m})=>{const[p,g]=Object(a.useState)(!1),v=Object(a.useCallback)((()=>g(!1)),[g]),y=Object(a.useCallback)((()=>{null==m||m(),g(!p)}),[p,m]);return i.a.createElement(f.EuiPopover,{ownFocus:u,panelPaddingSize:d,button:i.a.createElement(b.a,{dataTestSubj:c,color:t,iconSide:n,iconSize:r,iconType:s,disabled:l,onClick:y},e),closePopover:v,isOpen:p,repositionOnScroll:!0},null==o?void 0:o(v))}));v.displayName="Popover";const y=i.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:r,iconSide:s,iconSize:o,iconType:l,ownFocus:u,onClick:c,popoverContent:m,popoverPanelPaddingSize:p,inProgress:f})=>f?i.a.createElement(d,null,i.a.createElement(g,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):i.a.createElement(d,{"data-test-subj":n},m?i.a.createElement(v,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:s,iconSize:o,iconType:l,ownFocus:u,popoverPanelPaddingSize:p,popoverContent:m,onClick:c},e):i.a.createElement(b.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:r,iconSide:s,iconSize:o,iconType:l,onClick:c},e))));y.displayName="UtilityBarAction";const h=i.a.memo((({grow:e,children:t})=>i.a.createElement(u,{grow:e},t)));h.displayName="UtilityBarGroup";const j=i.a.memo((({grow:e,children:t,dataTestSubj:n})=>i.a.createElement(l,{grow:e,"data-test-subj":n},t)));j.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(m,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const O=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1,className:a})=>i.a.createElement(c,{"data-test-subj":t,shouldWrap:n,className:a},e)));O.displayName="UtilityBarText"},function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return _}));var a=n(119),i=n.n(a),r=n(19),s=n(128),o=n(2),l=n.n(o),u=n(75),c=n(45),d=n(41),m=n.n(d),p=n(1630),f=n(337),b=n(171),g=n(424),v=n(149),y=n(173),h=n(131),j=n(857),O=n(915);const E=l.a.memo((({dataProvider:e,scopeId:t=v.f.active,children:n,hideTopN:a=!1})=>{const{timelineId:i}=Object(o.useContext)(j.b),{tableId:r}=Object(o.useContext)(O.b),s=Object(o.useMemo)((()=>{var e;return Object(h.getSourcererScopeId)(null!==(e=null!=t?t:i)&&void 0!==e?e:r)}),[t,r,i]),u=Object(o.useMemo)((()=>{const{value:t,field:n}=e.queryMatch;return{value:t||[],field:n}}),[e.queryMatch]),c=Object(o.useMemo)((()=>a?[y.b.SHOW_TOP_N]:[]),[a]);return l.a.createElement(y.c,{mode:y.a.HOVER_DOWN,visibleCellActions:6,showActionTooltips:!0,triggerId:y.d.DEFAULT,data:u,disabledActionTypes:c,sourcererScopeId:s,metadata:{scopeId:t}},n)}));E.displayName="CellActionsWrapper";var x=n(222),S=n(657),w=n(720);const k=m.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);k.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const C=m.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));C.displayName="Wrapper";const T=m.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),M=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,I=l.a.memo((({dataProvider:e,render:t,scopeId:n,truncate:a,hideTopN:d})=>{const[m,p]=Object(o.useState)(!1),v=e.id.includes(`-${b.a}-`),y=Object(c.useDispatch)(),h=Object(o.useCallback)((()=>{v||(y(f.a.registerProvider({provider:e})),p(!0))}),[v,y,e]),j=Object(o.useCallback)((()=>m&&y(f.a.unRegisterProvider({id:e.id}))),[m,y,e.id]);Object(o.useEffect)((()=>()=>{j()}),[j]);const O=Object(o.useCallback)(((n,a)=>l.a.createElement(A,{registerProvider:h},l.a.createElement("div",i()({},n.draggableProps,n.dragHandleProps,{style:M(n.draggableProps.style,a),ref:n.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(T,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,a))))),[e,h,t]),k=Object(o.useCallback)(((n,s)=>l.a.createElement(S.a,i()({},n.draggableProps,n.dragHandleProps,{ref:e=>{n.innerRef(e)},"data-test-subj":"providerContainer",isDragging:s.isDragging,registerProvider:h,tabIndex:-1}),l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),a&&!s.isDragging?l.a.createElement(g.b,{"data-test-subj":"draggable-truncatable-content"},t(e,n,s)):l.a.createElement(T,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,s)),!s.isDragging&&l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,w.b)))),[e,h,t,a]),I=Object(o.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:s.a,"data-test-subj":"draggableWrapperKeyboardHandler",role:"button",tabIndex:0},l.a.createElement(u.Draggable,{draggableId:Object(x.k)(e.id),index:0,key:Object(x.k)(e.id),isDragDisabled:v},k)),t.placeholder)),[k,e.id,v]),_=Object(o.useMemo)((()=>l.a.createElement(C,{"data-test-subj":"draggableWrapperDiv",disabled:v},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(u.Droppable,{isDropDisabled:!0,droppableId:Object(x.l)(e.id),renderClone:O},I)))),[I,O,e.id,v]);return v?l.a.createElement(l.a.Fragment,null,_):l.a.createElement(E,{dataProvider:e,scopeId:n,hideTopN:d},_)}));I.displayName="DraggableOnWrapper";const _=l.a.memo((({dataProvider:e,isDraggable:t=!1,render:n,scopeId:a,truncate:i,hideTopN:r})=>{const s=Object(o.useMemo)((()=>l.a.createElement("div",{tabIndex:-1,"data-provider-id":Object(x.k)(e.id)},i?l.a.createElement(g.b,{"data-test-subj":"render-truncatable-content"},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):l.a.createElement(T,{"data-test-subj":`render-content-${e.queryMatch.field}`},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,n,i]);return t?l.a.createElement(I,{dataProvider:e,render:n,scopeId:a,truncate:i}):(u=a,[p.b.rulePreview,b.a].includes(null!=u?u:"")?l.a.createElement(l.a.Fragment,null,s):l.a.createElement(E,{dataProvider:e,scopeId:a,hideTopN:r},s));var u}));_.displayName="DraggableWrapper";const A=l.a.memo((({children:e,registerProvider:t})=>(Object(o.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));A.displayName="ConditionalPortal"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(19),i=n(2),r=n.n(i),s=n(42),o=n(121),l=n(149),u=n(651);const c={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:u.o,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:r.a.createElement(a.EuiCode,null,u.i),openButton:r.a.createElement(a.EuiCode,null,u.k)}})),anchor:c.ACTION_MENU},{title:u.a,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:c.ADD_TO_FAVORITES},{timelineTab:l.g.query,title:u.b,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:r.a.createElement(a.EuiCode,null," ",u.e)}})),anchor:c.DATA_VIEW},{timelineType:o.m.default,timelineTab:l.g.query,title:u.d,content:r.a.createElement(a.EuiText,null,u.c),anchor:c.DATA_PROVIDER},{title:u.m,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:r.a.createElement(a.EuiCode,null,u.l),editButton:r.a.createElement(a.EuiCode,null,u.f)}})),anchor:c.SAVE_TIMELINE}],m={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:u.n}},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var a=n(2);t.useFirstMountState=function(){var e=a.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveHookState=void 0,t.resolveHookState=function(e,t){return"function"==typeof e?e(t):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(328));t.default=function(e){var t=i.useRef(e);t.current=e,r.default((function(){return function(){return t.current()}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(120),i=n(199);const r=a.z.object({id:a.z.string().optional(),rule_id:i.P.optional(),list_id:a.z.string().min(1).optional(),item_id:a.z.string().min(1).optional(),error:a.z.object({status_code:a.z.number().int().min(400),message:a.z.string()})}).strict()},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(409),i=n(580),r=n(207);const s=e=>`${Object(r.a)(e)}`,o=(e,t,n,s=i.a.events)=>`/ip/${e}/${t||a.a.source}/${s}${Object(r.a)(n)}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(44);const i=e=>Object(a.isString)(e)?e:JSON.stringify(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(2),i=n(45),r=n(4),s=n(1341),o=n(748),l=n(1334),u=n(1491),c=n(122),d=n(213),m=n(118),p=n(146),f=n(121),b=n(129),g=n(817),v=n(556),y=n(331),h=n(172),j=n(131),O=n(123),E=n(187),x=n(219),S=n(274),w=n(243);const k=({ecsRowData:e,onInvestigateInTimelineAlertClick:t})=>{const{addError:n}=Object(O.a)(),{data:{search:k}}=Object(m.j)().services,C=Object(i.useDispatch)(),{startTransaction:T}=Object(E.b)(),{services:M}=Object(m.j)(),{getExceptionFilterFromIds:I}=Object(u.a)(M.http),_=Object(a.useCallback)((async e=>{const t=(e=>{var t;let n=null!==(t=Object(j.getField)(e,s.i))&&void 0!==t?t:[],a=[];try{if(Array.isArray(n)&&0===n.length){var i;const t=null!==(i=Object(j.getField)(e,o.t))&&void 0!==i?i:{};if(t.length>0){var r;const e=JSON.parse(t[0]);n=null!==(r=null==e?void 0:e.exceptions_list)&&void 0!==r?r:[]}}else if(n&&n.list_id)return n.list_id.map(((e,t)=>{const a=n.type[t];return{exception_list_id:e,namespace_type:n.namespace_type[t],type:a}})).filter((e=>e.type===l.a.DETECTION))}catch(e){}return a=n.reduce(((e,t)=>{try{const n="string"==typeof t?JSON.parse(t):t;if(n.type===l.a.DETECTION){const t={exception_list_id:n.list_id,namespace_type:n.namespace_type};e.push(t)}}catch{}return e}),[]),a})(e);let a;return t.length>0&&await I({exceptionListIds:t,excludeExceptions:!0,chunkSize:20,alias:"Exceptions",onSuccess:e=>{a=e},onError:e=>{n(e,{title:r.i18n.translate("xpack.securitySolution.detectionEngine.alerts.fetchExceptionFilterFailure",{defaultMessage:"Error fetching exception filter."})})}}),a}),[n,I]),A=Object(a.useCallback)((e=>C(b.a.updateIsLoading(e))),[C]),P=Object(y.a)({timelineId:p.c.active,timelineType:f.m.default}),D=Object(c.a)("unifiedComponentsInTimelineDisabled"),F=Object(v.a)(),R=Object(a.useCallback)((async({from:e,timeline:t,to:n,ruleNote:a})=>{var i;await P(),A({id:p.c.active,isLoading:!1}),F({duplicate:!0,from:e,id:p.c.active,notes:[],timeline:{...t,columns:D?w.b:S.a,indexNames:null!==(i=t.indexNames)&&void 0!==i?i:[],show:!0,excludedRowRendererIds:D||t.timelineType===f.m.template?[]:t.excludedRowRendererIds},to:n,ruleNote:a})}),[F,A,P,D]),N=Object(a.useCallback)((async()=>{Object(d.a)(),T({name:x.a.INVESTIGATE_IN_TIMELINE}),t&&t(),null!=e&&await Object(g.b)({createTimeline:R,ecsData:e,searchStrategyClient:k,updateTimelineIsLoading:A,getExceptionFilter:_})}),[T,R,e,t,k,A,_]);return{investigateInTimelineActionItems:Object(a.useMemo)((()=>[{key:"investigate-in-timeline-action-item","data-test-subj":"investigate-in-timeline-action-item",disabled:null==e,onClick:N,name:h.i}]),[e,N]),investigateInTimelineAlertClick:N}}},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return v})),n.d(t,"g",(function(){return y}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),v=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),y=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(66),r=n.n(i),s=n(953),o=n(43);const l=(e,t)=>n=>(r.a.render(Object(o.jsx)(s.a,t,e),n),()=>r.a.unmountComponentAtNode(n));n(0),n(4),a.Component},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return O}));var a=n(19),i=n(2),r=n.n(i),s=n(41),o=n.n(s),l=n(197),u=n(300),c=n(4);const d=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),m=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),p=o()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),f=o.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),b=o.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),g=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(i.useState)(null),[s,o]=(e=>{const[t,n]=Object(i.useState)(null),a=Object(i.useRef)(null);return Object(i.useEffect)((()=>{var e,t,i,r,s,o,l,u,c;null!=(null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==a||null===(i=a.current)||void 0===i?void 0:i.scrollHeight)&&void 0!==t?t:0)>(null!==(r=null==a||null===(s=a.current)||void 0===s?void 0:s.clientHeight)&&void 0!==r?r:0)&&n(!0),(null!==(o=null===(l=a.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==o?o:0)<=(null!==(u=null==a||null===(c=a.current)||void 0===c?void 0:c.clientHeight)&&void 0!==u?u:0)&&n(!1))}),[a,e]),[t,a]})(e),l=Object(i.useCallback)((()=>{a((e=>!e))}),[]);return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{"data-test-subj":"expanded-line-clamp"},r.a.createElement("p",null,e)),s&&r.a.createElement(p,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},m)):r.a.createElement(r.a.Fragment,null,null==s||!0===s?r.a.createElement(b,{"data-test-subj":"styled-line-clamp",ref:o,lineClampHeight:t},e):e,s&&r.a.createElement(p,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},d))},v=r.a.memo(g),y=o.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),h=Object(i.createContext)({}),j=({basicData:e,ruleNote:t,showFullView:n=!1,showTitle:i=!0})=>r.a.createElement(h.Provider,{value:e},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},r.a.createElement("h5",null,l.q)),r.a.createElement(a.EuiSpacer,{size:"s"})),r.a.createElement(y,null,n?r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},r.a.createElement(u.b,null,t)):r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},r.a.createElement(v,{lineClampHeight:4.5},r.a.createElement(u.b,null,t))))),O=r.a.memo(j)},,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return i})),n.d(t,"NetworkDetailsTableType",(function(){return r}));let a=function(e){return e.page="page",e.details="details",e}({}),i=function(e){return e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies",e}({}),r=function(e){return e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies",e}({})},,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const a="cellAction-filter",i="cellAction-copy";let r=function(e){return e.HOVER_DOWN="hover-down",e.HOVER_RIGHT="hover-right",e.INLINE="inline",e}({})},,function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function s(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function u(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&o(e).forEach((function(t){a[t]=r(e[t],n)})),o(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&n.isMergeableObject(t[i])?a[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"==typeof n?n:u}(i,n)(e[i],t[i],n):a[i]=r(t[i],n))})),a}(e,t,n):r(t,n)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var c=u;e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(985);Object.defineProperty(t,"createMemo",{enumerable:!0,get:function(){return a.default}});var i=n(986);Object.defineProperty(t,"createReducerContext",{enumerable:!0,get:function(){return i.default}});var r=n(987);Object.defineProperty(t,"createReducer",{enumerable:!0,get:function(){return r.default}});var s=n(988);Object.defineProperty(t,"createStateContext",{enumerable:!0,get:function(){return s.default}});var o=n(445);Object.defineProperty(t,"useAsync",{enumerable:!0,get:function(){return o.default}});var l=n(427);Object.defineProperty(t,"useAsyncFn",{enumerable:!0,get:function(){return l.default}});var u=n(989);Object.defineProperty(t,"useAsyncRetry",{enumerable:!0,get:function(){return u.default}});var c=n(990);Object.defineProperty(t,"useAudio",{enumerable:!0,get:function(){return c.default}});var d=n(992);Object.defineProperty(t,"useBattery",{enumerable:!0,get:function(){return d.default}});var m=n(994);Object.defineProperty(t,"useBeforeUnload",{enumerable:!0,get:function(){return m.default}});var p=n(995);Object.defineProperty(t,"useBoolean",{enumerable:!0,get:function(){return p.default}});var f=n(996);Object.defineProperty(t,"useClickAway",{enumerable:!0,get:function(){return f.default}});var b=n(997);Object.defineProperty(t,"useCookie",{enumerable:!0,get:function(){return b.default}});var g=n(999);Object.defineProperty(t,"useCopyToClipboard",{enumerable:!0,get:function(){return g.default}});var v=n(637);Object.defineProperty(t,"useCounter",{enumerable:!0,get:function(){return v.default}});var y=n(1001);Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return y.default}});var h=n(461);Object.defineProperty(t,"useCustomCompareEffect",{enumerable:!0,get:function(){return h.default}});var j=n(808);Object.defineProperty(t,"useDebounce",{enumerable:!0,get:function(){return j.default}});var O=n(809);Object.defineProperty(t,"useDeepCompareEffect",{enumerable:!0,get:function(){return O.default}});var E=n(1007);Object.defineProperty(t,"useDefault",{enumerable:!0,get:function(){return E.default}});var x=n(1008);Object.defineProperty(t,"useDrop",{enumerable:!0,get:function(){return x.default}});var S=n(1009);Object.defineProperty(t,"useDropArea",{enumerable:!0,get:function(){return S.default}});var w=n(328);Object.defineProperty(t,"useEffectOnce",{enumerable:!0,get:function(){return w.default}});var k=n(1010);Object.defineProperty(t,"useEnsuredForwardedRef",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"ensuredForwardRef",{enumerable:!0,get:function(){return k.ensuredForwardRef}});var C=n(557);Object.defineProperty(t,"useEvent",{enumerable:!0,get:function(){return C.default}});var T=n(1011);Object.defineProperty(t,"useError",{enumerable:!0,get:function(){return T.default}});var M=n(1012);Object.defineProperty(t,"useFavicon",{enumerable:!0,get:function(){return M.default}});var I=n(1013);Object.defineProperty(t,"useFullscreen",{enumerable:!0,get:function(){return I.default}});var _=n(1015);Object.defineProperty(t,"useGeolocation",{enumerable:!0,get:function(){return _.default}});var A=n(638);Object.defineProperty(t,"useGetSet",{enumerable:!0,get:function(){return A.default}});var P=n(1016);Object.defineProperty(t,"useGetSetState",{enumerable:!0,get:function(){return P.default}});var D=n(1017);Object.defineProperty(t,"useHarmonicIntervalFn",{enumerable:!0,get:function(){return D.default}});var F=n(1019);Object.defineProperty(t,"useHover",{enumerable:!0,get:function(){return F.default}});var R=n(639);Object.defineProperty(t,"useHoverDirty",{enumerable:!0,get:function(){return R.default}});var N=n(1020);Object.defineProperty(t,"useIdle",{enumerable:!0,get:function(){return N.default}});var z=n(1022);Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return z.default}});var L=n(1023);Object.defineProperty(t,"useInterval",{enumerable:!0,get:function(){return L.default}});var B=n(37);Object.defineProperty(t,"useIsomorphicLayoutEffect",{enumerable:!0,get:function(){return B.default}});var q=n(640);Object.defineProperty(t,"useKey",{enumerable:!0,get:function(){return q.default}});var V=n(1024);Object.defineProperty(t,"createBreakpoint",{enumerable:!0,get:function(){return V.default}});var $=n(641);Object.defineProperty(t,"useKeyPress",{enumerable:!0,get:function(){return $.default}});var U=n(1025);Object.defineProperty(t,"useKeyPressEvent",{enumerable:!0,get:function(){return U.default}});var G=n(642);Object.defineProperty(t,"useLatest",{enumerable:!0,get:function(){return G.default}});var H=n(643);Object.defineProperty(t,"useLifecycles",{enumerable:!0,get:function(){return H.default}});var Q=n(644);Object.defineProperty(t,"useList",{enumerable:!0,get:function(){return Q.default}});var W=n(645);Object.defineProperty(t,"useLocalStorage",{enumerable:!0,get:function(){return W.default}});var K=n(1026);Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return K.default}});var J=n(1027);Object.defineProperty(t,"useLockBodyScroll",{enumerable:!0,get:function(){return J.default}});var Y=n(1028);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return Y.default}});var X=n(1029);Object.defineProperty(t,"useLongPress",{enumerable:!0,get:function(){return X.default}});var Z=n(898);Object.defineProperty(t,"useMap",{enumerable:!0,get:function(){return Z.default}});var ee=n(1030);Object.defineProperty(t,"useMedia",{enumerable:!0,get:function(){return ee.default}});var te=n(1031);Object.defineProperty(t,"useMediaDevices",{enumerable:!0,get:function(){return te.default}});var ne=n(1032);Object.defineProperty(t,"useMediatedState",{enumerable:!0,get:function(){return ne.useMediatedState}});var ae=n(1033);Object.defineProperty(t,"useMethods",{enumerable:!0,get:function(){return ae.default}});var ie=n(1034);Object.defineProperty(t,"useMotion",{enumerable:!0,get:function(){return ie.default}});var re=n(646);Object.defineProperty(t,"useMount",{enumerable:!0,get:function(){return re.default}});var se=n(251);Object.defineProperty(t,"useMountedState",{enumerable:!0,get:function(){return se.default}});var oe=n(647);Object.defineProperty(t,"useMouse",{enumerable:!0,get:function(){return oe.default}});var le=n(1035);Object.defineProperty(t,"useMouseHovered",{enumerable:!0,get:function(){return le.default}});var ue=n(1036);Object.defineProperty(t,"useMouseWheel",{enumerable:!0,get:function(){return ue.default}});var ce=n(1037);Object.defineProperty(t,"useNetwork",{enumerable:!0,get:function(){return ce.default}});var de=n(1038);Object.defineProperty(t,"useNumber",{enumerable:!0,get:function(){return de.default}});var me=n(8);Object.defineProperty(t,"useObservable",{enumerable:!0,get:function(){return me.default}});var pe=n(1039);Object.defineProperty(t,"useOrientation",{enumerable:!0,get:function(){return pe.default}});var fe=n(1040);Object.defineProperty(t,"usePageLeave",{enumerable:!0,get:function(){return fe.default}});var be=n(1041);Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return be.default}});var ge=n(271);Object.defineProperty(t,"usePrevious",{enumerable:!0,get:function(){return ge.default}});var ve=n(1042);Object.defineProperty(t,"usePreviousDistinct",{enumerable:!0,get:function(){return ve.default}});var ye=n(1043);Object.defineProperty(t,"usePromise",{enumerable:!0,get:function(){return ye.default}});var he=n(1044);Object.defineProperty(t,"useQueue",{enumerable:!0,get:function(){return he.default}});var je=n(648);Object.defineProperty(t,"useRaf",{enumerable:!0,get:function(){return je.default}});var Oe=n(1045);Object.defineProperty(t,"useRafLoop",{enumerable:!0,get:function(){return Oe.default}});var Ee=n(329);Object.defineProperty(t,"useRafState",{enumerable:!0,get:function(){return Ee.default}});var xe=n(1046);Object.defineProperty(t,"useSearchParam",{enumerable:!0,get:function(){return xe.default}});var Se=n(1047);Object.defineProperty(t,"useScratch",{enumerable:!0,get:function(){return Se.default}});var we=n(1053);Object.defineProperty(t,"useScroll",{enumerable:!0,get:function(){return we.default}});var ke=n(1054);Object.defineProperty(t,"useScrolling",{enumerable:!0,get:function(){return ke.default}});var Ce=n(810);Object.defineProperty(t,"useSessionStorage",{enumerable:!0,get:function(){return Ce.default}});var Te=n(327);Object.defineProperty(t,"useSetState",{enumerable:!0,get:function(){return Te.default}});var Me=n(751);Object.defineProperty(t,"useShallowCompareEffect",{enumerable:!0,get:function(){return Me.default}});var Ie=n(1056);Object.defineProperty(t,"useSize",{enumerable:!0,get:function(){return Ie.default}});var _e=n(1057);Object.defineProperty(t,"useSlider",{enumerable:!0,get:function(){return _e.default}});var Ae=n(1058);Object.defineProperty(t,"useSpeech",{enumerable:!0,get:function(){return Ae.default}});var Pe=n(1059);Object.defineProperty(t,"useStartTyping",{enumerable:!0,get:function(){return Pe.default}});var De=n(1060);Object.defineProperty(t,"useStateWithHistory",{enumerable:!0,get:function(){return De.useStateWithHistory}});var Fe=n(1061);Object.defineProperty(t,"useStateList",{enumerable:!0,get:function(){return Fe.default}});var Re=n(1062);Object.defineProperty(t,"useThrottle",{enumerable:!0,get:function(){return Re.default}});var Ne=n(1063);Object.defineProperty(t,"useThrottleFn",{enumerable:!0,get:function(){return Ne.default}});var ze=n(1064);Object.defineProperty(t,"useTimeout",{enumerable:!0,get:function(){return ze.default}});var Le=n(462);Object.defineProperty(t,"useTimeoutFn",{enumerable:!0,get:function(){return Le.default}});var Be=n(1065);Object.defineProperty(t,"useTitle",{enumerable:!0,get:function(){return Be.default}});var qe=n(636);Object.defineProperty(t,"useToggle",{enumerable:!0,get:function(){return qe.default}});var Ve=n(1066);Object.defineProperty(t,"useTween",{enumerable:!0,get:function(){return Ve.default}});var $e=n(373);Object.defineProperty(t,"useUnmount",{enumerable:!0,get:function(){return $e.default}});var Ue=n(1067);Object.defineProperty(t,"useUnmountPromise",{enumerable:!0,get:function(){return Ue.default}});var Ge=n(280);Object.defineProperty(t,"useUpdate",{enumerable:!0,get:function(){return Ge.default}});var He=n(326);Object.defineProperty(t,"useUpdateEffect",{enumerable:!0,get:function(){return He.default}});var Qe=n(1068);Object.defineProperty(t,"useUpsert",{enumerable:!0,get:function(){return Qe.default}});var We=n(1069);Object.defineProperty(t,"useVibrate",{enumerable:!0,get:function(){return We.default}});var Ke=n(1070);Object.defineProperty(t,"useVideo",{enumerable:!0,get:function(){return Ke.default}});var Je=n(1071);Object.defineProperty(t,"useStateValidator",{enumerable:!0,get:function(){return Je.default}});var Ye=n(1072);Object.defineProperty(t,"useScrollbarWidth",{enumerable:!0,get:function(){return Ye.useScrollbarWidth}});var Xe=n(1074);Object.defineProperty(t,"useMultiStateValidator",{enumerable:!0,get:function(){return Xe.useMultiStateValidator}});var Ze=n(1075);Object.defineProperty(t,"useWindowScroll",{enumerable:!0,get:function(){return Ze.default}});var et=n(1076);Object.defineProperty(t,"useWindowSize",{enumerable:!0,get:function(){return et.default}});var tt=n(1077);Object.defineProperty(t,"useMeasure",{enumerable:!0,get:function(){return tt.default}});var nt=n(1078);Object.defineProperty(t,"useRendersCount",{enumerable:!0,get:function(){return nt.useRendersCount}});var at=n(371);Object.defineProperty(t,"useFirstMountState",{enumerable:!0,get:function(){return at.useFirstMountState}});var it=n(1079);Object.defineProperty(t,"useSet",{enumerable:!0,get:function(){return it.default}});var rt=n(1080);Object.defineProperty(t,"createGlobalState",{enumerable:!0,get:function(){return rt.createGlobalState}});var st=n(1081);Object.defineProperty(t,"useHash",{enumerable:!0,get:function(){return st.useHash}})},function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(5);const i=`${a.qb}/prepackaged`,r=`${a.Lb}/prebuilt_rules`,s=`${i}/_status`,o=`${r}/status`,l=`${r}/upgrade/_review`,u=`${r}/upgrade/_perform`,c=`${r}/installation/_review`,d=`${r}/installation/_perform`},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(44),i=n(2),r=n.n(i),s=n(179),o=n(961);const l=r.a.memo((({dataProvider:e})=>{var t;const[n,l]=Object(i.useState)(!1);return r.a.createElement(o.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:l,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||s.d,type:e.type||s.a.default})}));l.displayName="Provider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(282),r=n(124),s=n(148);const o=({visualizationId:e})=>{const t=Object(a.useMemo)((()=>s.d.globalQueryByIdSelector()),[]),{inspect:n,loading:o,searchSessionId:l}=Object(r.a)((n=>t(n,e)));return Object(a.useMemo)((()=>({requests:n?Object(i.g)(null==n?void 0:n.dsl):null,responses:n?Object(i.g)(null==n?void 0:n.response):null,loading:o,searchSessionId:l})),[n,o,l])}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(119),i=n.n(a),r=n(2),s=n.n(r),o=n(41),l=n.n(o),u=n(19);const c=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?s.a.createElement(u.EuiToolTip,{display:"block",content:e},s.a.createElement(c,i()({"data-test-subj":n},a),t)):s.a.createElement(c,i()({"data-test-subj":n},a),t)}c.displayName="EllipsisText"},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251));t.default=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var s=i.useRef(0),o=r.default(),l=i.useState(n),u=l[0],c=l[1],d=i.useCallback((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=++s.current;return c((function(e){return a.__assign(a.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return o()&&i===s.current&&c({value:e,loading:!1}),e}),(function(e){return o()&&i===s.current&&c({error:e,loading:!1}),e}))}),t);return[u,d]}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"c",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),s=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),o=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),u=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),c=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t){const n=Object.freeze({loose:!0}),a=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:a},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),r=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),s=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),l=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),u=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),c=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(44);const i=e=>e.replace(/:/g,"-"),r=e=>e.replace(/-/g,":"),s=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e)},,,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return f.d})),n.d(t,"a",(function(){return f.a})),n.d(t,"f",(function(){return f.f})),n.d(t,"c",(function(){return f.c})),n.d(t,"e",(function(){return f.e})),n.d(t,"b",(function(){return f.b})),n.d(t,"g",(function(){return Y}));var a=n(120);a.z.object({rules_custom_installed:a.z.number().int().min(0),rules_installed:a.z.number().int().min(0),rules_not_installed:a.z.number().int().min(0),rules_not_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_not_installed:a.z.number().int().min(0),timelines_not_updated:a.z.number().int().min(0)}).strict(),a.z.object({rules_installed:a.z.number().int().min(0),rules_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_updated:a.z.number().int().min(0)}).strict();var i=n(46);const r=i.exact(i.type({rule_id:i.string,version:i.number})),s=i.exact(i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(r)})),o=i.exact(i.type({mode:i.literal("ALL_RULES")}));i.union([o,s]);var l=n(2074);let u=function(e){return e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET",e}({});const c=Object(l.a)("PickVersionValues",u),d=i.exact(i.intersection([i.type({rule_id:i.string,revision:i.number,version:i.number}),i.partial({pick_version:c})])),m=i.exact(i.intersection([i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(d)}),i.partial({pick_version:c})])),p=i.exact(i.intersection([i.type({mode:i.literal("ALL_RULES")}),i.partial({pick_version:c})]));i.union([p,m]);var f=n(415),b=n(439);const g=e=>i.intersection([i.exact(i.type(e.required)),i.exact(i.type(Object(b.N)(e.optional)))]);var v=n(2076),y=n(425);let h=function(e){return e.index_patterns="index_patterns",e.data_view="data_view",e}({});const j=i.exact(i.type({type:i.literal(h.index_patterns),index_patterns:b.g})),O=i.exact(i.type({type:i.literal(h.data_view),data_view_id:b.c})),E=i.union([j,O]);let x=function(e){return e.inline_query="inline_query",e.saved_query="saved_query",e}({});const S=i.exact(i.type({type:i.literal(x.inline_query),query:b.w,language:b.i,filters:b.q})),w=i.exact(i.type({type:i.literal(x.saved_query),saved_query_id:y.b})),k=i.union([S,w]),C=i.exact(i.type({query:b.w,language:i.literal("eql"),filters:b.q})),T=i.exact(i.type({query:b.w,language:i.literal("esql")})),M=i.exact(i.type({interval:Object(v.a)({allowedUnits:["s","m","h"]}),lookback:Object(v.a)({allowedUnits:["s","m","h"]})})),I=i.exact(i.type({field_name:b.u})),_=i.exact(i.type({field_name:b.L,fallback_disabled:b.M})),A=i.exact(i.type({timeline_id:b.I,timeline_title:b.J})),P=i.exact(i.type({type:b.b}));var D=n(1781),F=n(2079),R=n(1780),N=n(2077),z=n(2131),L=n(1782),B=n(2137),q=n(2138);const V=g({required:{rule_id:b.y,version:b.A,meta:b.s,name:b.t,tags:b.z,description:b.o,severity:D.a,severity_mapping:F.a,risk_score:R.a,risk_score_mapping:N.a,references:b.x,false_positives:b.p,threat:b.F,note:b.h,setup:b.E,related_integrations:b.l,required_fields:b.m,author:b.n,license:b.r,rule_schedule:M,actions:z.a,throttle:L.a,exceptions_list:b.e,max_signals:b.j},optional:{rule_name_override:I,timestamp_override:_,timeline_template:A,building_block:P}}),$=g({required:{type:i.literal("query"),kql_query:k},optional:{data_source:E,alert_suppression:b.a}}),U=g({required:{type:i.literal("saved_query"),kql_query:k},optional:{data_source:E,alert_suppression:b.a}}),G=g({required:{type:i.literal("eql"),eql_query:C},optional:{data_source:E,event_category_override:b.d,timestamp_field:b.K,tiebreaker_field:b.H}}),H=g({required:{type:i.literal("esql"),esql_query:T},optional:{}}),Q=g({required:{type:i.literal("threat_match"),kql_query:k,threat_query:S,threat_index:B.e,threat_mapping:B.g},optional:{data_source:E,threat_indicator_path:B.f,concurrent_searches:B.a,items_per_search:B.b}}),W=g({required:{type:i.literal("threshold"),kql_query:k,threshold:b.G},optional:{data_source:E}}),K=g({required:{type:i.literal("machine_learning"),machine_learning_job_id:q.a,anomaly_threshold:y.a},optional:{}}),J=g({required:{type:i.literal("new_terms"),kql_query:S,new_terms_fields:b.k,history_window_start:b.f},optional:{data_source:E}});i.intersection([V,i.union([$,U,G,H,Q,W,K,J])]),n(7),Symbol("MissingVersion");let Y=function(e){return e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C",e}({})},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(427));t.default=function(e,t){void 0===t&&(t=[]);var n=r.default(e,t,{loading:!0}),a=n[0],s=n[1];return i.useEffect((function(){s()}),[s]),a}},function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a,i=n(2),r=n(66),s=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o="html",l="svg",u=function(e,t){var n,a,i,r={};if(e===o)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var s=0,u=Object.entries(t.attributes);s<u.length;s++){var c=u[s],d=c[0],m=c[1];i.setAttribute(d,m)}var p={element:i,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,i){if(i!==a){if(p.unmount(),t!==n&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(p.element,i),n=t,a=i}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,p.element),n=void 0,a=void 0)}};return p},c=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return s(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return r.createPortal(i.Children.map(n,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(i.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=i.createRef(),n.passPropsThroughPortal(),n}return s(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),m=u.bind(null,o);u.bind(null,l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(45),r=n(138),s=n(124),o=n(148),l=n(200);const u=({inputId:e=r.a.global,inspectIndex:t=0,isDisabled:n,multiple:u=!1,onClick:c,onCloseInspect:d,queryId:m})=>{const p=Object(i.useDispatch)(),f=Object(a.useMemo)((()=>o.d.globalQueryByIdSelector()),[]),b=Object(a.useMemo)((()=>o.d.timelineQueryByIdSelector()),[]),{loading:g,inspect:v,selectedInspectIndex:y,isInspected:h,searchSessionId:j}=Object(s.a)((t=>e===r.a.global?f(t,m):b(t,m))),O=Object(a.useCallback)((()=>{c&&c(),p(l.c.setInspectionParameter({id:m,inputId:e,isInspected:!0,selectedInspectIndex:t,searchSessionId:j}))}),[c,p,m,e,t,j]),E=Object(a.useCallback)((()=>{null!=d&&d(),p(l.c.setInspectionParameter({id:m,inputId:e,isInspected:!1,selectedInspectIndex:t,searchSessionId:j}))}),[d,p,m,e,t,j]),x=Object(a.useMemo)((()=>null!=v&&v.dsl.length>0?u?v.dsl[0]:v.dsl[t]:null),[t,u,v]),S=Object(a.useMemo)((()=>u?null==v?void 0:v.dsl.slice(1):null),[u,v]),w=Object(a.useMemo)((()=>null!=v&&v.response.length>0?u?v.response[0]:v.response[t]:null),[t,u,v]),k=Object(a.useMemo)((()=>u?null==v?void 0:v.response.slice(1):null),[u,v]),C=Object(a.useMemo)((()=>!g&&y===t&&h),[t,h,g,y]);return{additionalRequests:S,additionalResponses:k,handleClick:O,handleCloseModal:E,isButtonDisabled:Object(a.useMemo)((()=>g||n||null==x||null==w||null==m),[n,g,m,x,w]),isShowingModal:C,loading:g,request:x,response:w}}},function(e,t,n){"use strict";e.exports=n(1084)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(2),i=n.n(a);const r=i.a.createContext(null),s=Object(a.memo)((({upsellingService:e,children:t})=>i.a.createElement(r.Provider,{value:e},t)));s.displayName="UpsellingProvider";const o=()=>{const e=Object(a.useContext)(r);if(!e)throw new Error("UpsellingProviderContext not found");return e}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n(4),r=n(45),s=n(166),o=n(132),l=n(127),u=n(294),c=n(123),d=n(118),m=n(864);const p=()=>{const{indicesExist:e,dataViewId:t}=Object(o.a)(l.SourcererScopeName.detections),{indexFieldsSearch:n}=Object(u.b)(),p=Object(r.useDispatch)(),{addError:f}=Object(c.a)(),b=Object(a.useRef)(new AbortController),{data:{dataViews:g}}=Object(d.j)().services,v=Object(r.useSelector)(s.d.signalIndexName),y=Object(r.useSelector)(s.d.defaultDataView),h=Object(a.useMemo)((()=>!y.title.includes(`${v}`)),[y.title,v]),j=Object(a.useMemo)((()=>!e&&!h),[e,h]),O=Object(a.useCallback)((()=>{null!==v&&(b.current.abort(),(async()=>{b.current=new AbortController;try{const e=await Object(m.a)({body:{patternList:y.title.split(",")},signal:b.current.signal,dataViewId:t,dataViewService:g});null!==v&&null!=e&&e.defaultDataView.patternList.includes(v)&&(n({dataViewId:e.defaultDataView.id}),p(s.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||f(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[f,t,g,y.title,p,n,v]);return{...j?{pollForSignalIndex:O}:{},signalIndexNeedsInit:h}}},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"f",(function(){return h}));var a=n(7),i=n(57),r=n(138);const s=e=>e.policy,o=e=>e.timerange,l=e=>e.queries,u=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===r.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},c=()=>Object(i.createSelector)(s,(e=>e.kind)),d=()=>Object(i.createSelector)(s,(e=>e.duration)),m=()=>Object(i.createSelector)(o,(e=>e.kind)),p=()=>Object(i.createSelector)(o,(e=>e.from)),f=()=>Object(i.createSelector)(o,(e=>e.to)),b=()=>Object(i.createSelector)(o,(e=>e.fromStr)),g=()=>Object(i.createSelector)(o,(e=>e.toStr)),v=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),y=()=>Object(i.createSelector)(u,(e=>e.filter((e=>"kql"!==e.id)))),h=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){var i=a.useRef(void 0);i.current&&n(t,i.current)||(i.current=t),a.useEffect(e,i.current)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),i=a.useRef(),r=a.useRef(e),s=a.useCallback((function(){return n.current}),[]),o=a.useCallback((function(){n.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){n.current=!0,r.current()}),t)}),[t]),l=a.useCallback((function(){n.current=null,i.current&&clearTimeout(i.current)}),[]);return a.useEffect((function(){r.current=e}),[e]),a.useEffect((function(){return o(),l}),[t]),[s,l,o]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return g}));var a=n(120);const i=a.z.enum([".osquery",".endpoint"]),r=i.enum,s=a.z.object({}).catchall(a.z.object({field:a.z.string().optional(),value:a.z.union([a.z.string(),a.z.array(a.z.string())]).optional()})),o=a.z.object({id:a.z.string(),query:a.z.string(),ecs_mapping:s.optional(),version:a.z.string().optional(),platform:a.z.string().optional(),removed:a.z.boolean().optional(),snapshot:a.z.boolean().optional()}),l=a.z.object({query:a.z.string().optional(),ecs_mapping:s.optional(),queries:a.z.array(o).optional(),pack_id:a.z.string().optional(),saved_query_id:a.z.string().optional(),timeout:a.z.number().optional()}),u=a.z.object({query:a.z.string().optional(),ecsMapping:s.optional(),queries:a.z.array(o).optional(),packId:a.z.string().optional(),savedQueryId:a.z.string().optional(),timeout:a.z.number().optional()}),c=a.z.object({action_type_id:a.z.literal(".osquery"),params:l}),d=a.z.object({actionTypeId:a.z.literal(".osquery"),params:u}),m=a.z.object({command:a.z.literal("isolate"),comment:a.z.string().optional()}),p=a.z.object({command:a.z.enum(["kill-process","suspend-process"]),comment:a.z.string().optional(),config:a.z.object({field:a.z.string(),overwrite:a.z.boolean().optional().default(!0)})}),f=a.z.object({action_type_id:a.z.literal(".endpoint"),params:a.z.union([m,p])}),b=a.z.object({actionTypeId:a.z.literal(".endpoint"),params:a.z.union([m,p])}),g=a.z.union([c,f]);a.z.union([d,b])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(120),i=n(281),r=n(465);const s=a.z.object({last_execution:a.z.object({date:a.z.string().datetime(),status:i.a,status_order:i.c,message:a.z.string(),metrics:r.a})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);const i=a.z.object({total_search_duration_ms:a.z.number().int().min(0).optional(),total_indexing_duration_ms:a.z.number().int().min(0).optional(),total_enrichment_duration_ms:a.z.number().int().min(0).optional(),execution_gap_duration_s:a.z.number().int().min(0).optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(120);const i=a.z.string(),r=a.z.string(),s=a.z.string()},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(120),i=n(199);const r=a.z.array(a.z.object({field:a.z.string(),value:a.z.number().int().min(0)})),s=a.z.number().int().min(1),o=a.z.union([a.z.string(),a.z.array(a.z.string())]),l=a.z.array(a.z.string()),u=a.z.object({field:o,value:s,cardinality:r.optional()}),c=(a.z.object({field:l,value:s,cardinality:r.optional()}),a.z.object({field:l,value:s,cardinality:r}),a.z.object({duration:i.b}))},function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(120),i=n(268);const r=a.z.string(),s=a.z.array(a.z.object({entries:a.z.array(a.z.object({field:i.a,type:a.z.literal("mapping"),value:i.a}))})).min(1),o=a.z.array(a.z.string()),l=a.z.array(a.z.unknown()),u=a.z.string(),c=a.z.number().int().min(1),d=a.z.number().int().min(1)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(120);const i=a.z.number().int().min(0),r=a.z.union([a.z.string(),a.z.array(a.z.string()).min(1)])},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(120),i=n(268);const r=a.z.array(a.z.string()).min(1).max(3),s=i.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(120);const i=a.z.number().int().min(1),r=a.z.number().int().min(0),s=a.z.object({page:i,per_page:r,total:a.z.number().int().min(0)})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);const i=a.z.object({type:a.z.string(),message:a.z.string(),actionPath:a.z.string(),buttonLabel:a.z.string().optional()})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(5);const i=`${a.Lb}/rules/_rule_management_filters`,r=`${a.Lb}/rules/_coverage_overview`},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(19),i=n(60),r=n.n(i),s=n(2),o=n.n(s),l=n(41),u=n.n(l),c=n(48),d=n(5),m=n(650),p=n(575),f=n(132),b=n(127);const g=u()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));height:41vh;.euiModal__flex{width:60vw;}[role='tabpanel']{height:calc(41vh - 208px) !important;}"]);g.displayName="MyEuiModal";const v=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},y=(e=[])=>1===e.length&&e[0]===d.hc?o.a.createElement("i",null,m.f):e.length>0?e.filter((e=>e!==d.hc)).join(", "):m.k,h=({adHocDataViews:e,additionalRequests:t,additionalResponses:n,closeModal:i,inputId:l,request:u,response:d,title:h})=>{const{pathname:j}=Object(c.useLocation)(),{selectedPatterns:O}=Object(f.a)("timeline"===l?b.SourcererScopeName.timeline:Object(p.a)(j)),E=Object(s.useMemo)((()=>[u,...null!=t?t:[]]),[u,t]),x=Object(s.useMemo)((()=>[d,...null!=n?n:[]]),[d,n]),S=Object(s.useMemo)((()=>v(E)),[E]),w=Object(s.useMemo)((()=>v(x)),[x]),k=Object(s.useMemo)((()=>{var e,t;return(null!==(e=null===(t=S[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>O.includes(e.trim())))}),[S,O]),C=Object(s.useMemo)((()=>{var t,n,i,s;return[{title:o.a.createElement("span",{"data-test-subj":"index-pattern-title"},m.b," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.c,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"index-pattern-description"},o.a.createElement("p",null,y(null!=e&&e.length>0?e:null!==(t=null===(n=S[0])||void 0===n?void 0:n.index)&&void 0!==t?t:[])),!k&&o.a.createElement("p",null,o.a.createElement("small",null,o.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},m.e))))},{title:o.a.createElement("span",{"data-test-subj":"query-time-title"},m.g," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.h,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(i=w[0])||void 0===i?void 0:i.took)?"0ms":null!==(s=w[0])&&void 0!==s&&s.took?`${r()(w[0].took).format("0,0")}ms`:m.k)},{title:o.a.createElement("span",{"data-test-subj":"request-timestamp-title"},m.i," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.j,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}]}),[e,S,w,k]),T=Object(s.useMemo)((()=>[{id:"statistics",name:"Statistics","data-test-subj":"modal-inspect-statistics-tab",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiDescriptionList,{listItems:C,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request","data-test-subj":"modal-inspect-request-tab",content:S.length>0?S.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-request-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return m.k}})(e.body))))):o.a.createElement(a.EuiCodeBlock,null,m.k)},{id:"response",name:"Response","data-test-subj":"modal-inspect-response-tab",content:w.length>0?x.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-response-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},e)))):o.a.createElement(a.EuiCodeBlock,null,m.k)}]),[S,w,x,C]);return o.a.createElement(g,{onClose:i,"data-test-subj":"modal-inspect-euiModal"},o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,m.d," ",h)),o.a.createElement(a.EuiModalBody,null,o.a.createElement(a.EuiTabbedContent,{tabs:T,initialSelectedTab:T[0],autoFocus:"selected"})),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButton,{onClick:i,fill:!0,"data-test-subj":"modal-inspect-close"},m.a)))}},function(e,t,n){"use strict";var a=n(411);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"c",(function(){return a.c}))},function(e,t,n){e.exports=n(35)(1029)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=(a=n(2))&&"object"==typeof a&&"default"in a?a:{default:a},r=e=>"checkbox"===e.type,s=e=>e instanceof Date,o=e=>null==e;const l=e=>"object"==typeof e;var u=e=>!o(e)&&!Array.isArray(e)&&l(e)&&!s(e),c=e=>u(e)&&e.target?r(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),m="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function p(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(m&&(e instanceof Blob||e instanceof FileList)||!n&&!u(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return u(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=p(e[n]));else t=e}return t}var f=e=>Array.isArray(e)?e.filter(Boolean):[],b=e=>void 0===e,g=(e,t,n)=>{if(!t||!u(e))return n;const a=f(t.split(/[,[\].]+?/)).reduce(((e,t)=>o(e)?e:e[t]),e);return b(a)||a===e?b(e[t])?n:e[t]:a};const v="blur",y="onChange",h="onSubmit",j="all",O="pattern",E="required",x=i.default.createContext(null),S=()=>i.default.useContext(x);var w=(e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==j&&(t._proxyFormState[i]=!a||j),n&&(n[i]=!0),e[i]}});return i},k=e=>u(e)&&!Object.keys(e).length,C=(e,t,n,a)=>{n(e);const{name:i,...r}=e;return k(r)||Object.keys(r).length>=Object.keys(t).length||Object.keys(r).find((e=>t[e]===(!a||j)))},T=e=>Array.isArray(e)?e:[e],M=(e,t,n)=>n&&t?e===t:!e||!t||e===t||T(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function I(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function _(e){const t=S(),{control:n=t.control,disabled:a,name:r,exact:s}=e||{},[o,l]=i.default.useState(n._formState),u=i.default.useRef(!0),c=i.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(r);return d.current=r,I({disabled:a,next:e=>u.current&&M(d.current,e.name,s)&&C(e,c.current,n._updateFormState)&&l({...n._formState,...e}),subject:n._subjects.state}),i.default.useEffect((()=>(u.current=!0,c.current.isValid&&n._updateValid(!0),()=>{u.current=!1})),[n]),w(o,n,c.current,!1)}var A=e=>"string"==typeof e,P=(e,t,n,a,i)=>A(e)?(a&&t.watch.add(e),g(n,e,i)):Array.isArray(e)?e.map((e=>(a&&t.watch.add(e),g(n,e)))):(a&&(t.watchAll=!0),n);function D(e){const t=S(),{control:n=t.control,name:a,defaultValue:r,disabled:s,exact:o}=e||{},l=i.default.useRef(a);l.current=a,I({disabled:s,subject:n._subjects.values,next:e=>{M(l.current,e.name,o)&&c(p(P(l.current,n._names,e.values||n._formValues,!1,r)))}});const[u,c]=i.default.useState(n._getWatch(a,r));return i.default.useEffect((()=>n._removeUnmounted())),u}var F=e=>/^\w*$/.test(e),R=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function N(e,t,n){let a=-1;const i=F(t)?[t]:R(t),r=i.length,s=r-1;for(;++a<r;){const t=i[a];let r=n;if(a!==s){const n=e[t];r=u(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}e[t]=r,e=e[t]}return e}function z(e){const t=S(),{name:n,control:a=t.control,shouldUnregister:r}=e,s=d(a._names.array,n),o=D({control:a,name:n,defaultValue:g(a._formValues,n,g(a._defaultValues,n,e.defaultValue)),exact:!0}),l=_({control:a,name:n}),u=i.default.useRef(a.register(n,{...e.rules,value:o}));return u.current=a.register(n,e.rules),i.default.useEffect((()=>{const e=a._options.shouldUnregister||r,t=(e,t)=>{const n=g(a._fields,e);n&&(n._f.mount=t)};if(t(n,!0),e){const e=p(g(a._options.defaultValues,n));N(a._defaultValues,n,e),b(g(a._formValues,n))&&N(a._formValues,n,e)}return()=>{(s?e&&!a._state.action:e)?a.unregister(n):t(n,!1)}}),[n,a,s,r]),{field:{name:n,value:o,onChange:i.default.useCallback((e=>u.current.onChange({target:{value:c(e),name:n},type:"change"})),[n]),onBlur:i.default.useCallback((()=>u.current.onBlur({target:{value:g(a._formValues,n),name:n},type:v})),[n,a]),ref:e=>{const t=g(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!g(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!g(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!g(l.touchedFields,n)},error:{enumerable:!0,get:()=>g(l.errors,n)}})}}const L="post";var B=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{};const q=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=g(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else u(a)&&q(a,t)}}};var V=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},$=(e,t,n={})=>n.shouldFocus||b(n.shouldFocus)?n.focusName||`${e}.${b(n.focusIndex)?t:n.focusIndex}.`:"",U=e=>({isOnSubmit:!e||e===h,isOnBlur:"onBlur"===e,isOnChange:e===y,isOnAll:e===j,isOnTouch:"onTouched"===e}),G=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),H=(e,t,n)=>{const a=f(g(e,n));return N(a,"root",t[n]),N(e,n,a),e},Q=e=>"boolean"==typeof e,W=e=>"file"===e.type,K=e=>"function"==typeof e,J=e=>{if(!m)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Y=e=>A(e),X=e=>"radio"===e.type,Z=e=>e instanceof RegExp;const ee={value:!1,isValid:!1},te={value:!0,isValid:!0};var ne=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!b(e[0].attributes.value)?b(e[0].value)||""===e[0].value?te:{value:e[0].value,isValid:!0}:te:ee}return ee};const ae={isValid:!1,value:null};var ie=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),ae):ae;function re(e,t,n="validate"){if(Y(e)||Array.isArray(e)&&e.every(Y)||Q(e)&&!e)return{type:n,message:Y(e)?e:"",ref:t}}var se=e=>u(e)&&!Z(e)?e:{value:e,message:""},oe=async(e,t,n,a,i)=>{const{ref:s,refs:l,required:c,maxLength:d,minLength:m,min:p,max:f,pattern:v,validate:y,name:h,valueAsNumber:j,mount:x,disabled:S}=e._f,w=g(t,h);if(!x||S)return{};const C=l?l[0]:s,T=e=>{a&&C.reportValidity&&(C.setCustomValidity(Q(e)?"":e||""),C.reportValidity())},M={},I=X(s),_=r(s),P=I||_,D=(j||W(s))&&b(s.value)&&b(w)||J(s)&&""===s.value||""===w||Array.isArray(w)&&!w.length,F=B.bind(null,h,n,M),R=(e,t,n,a="maxLength",i="minLength")=>{const r=e?t:n;M[h]={type:e?a:i,message:r,ref:s,...F(e?a:i,r)}};if(i?!Array.isArray(w)||!w.length:c&&(!P&&(D||o(w))||Q(w)&&!w||_&&!ne(l).isValid||I&&!ie(l).isValid)){const{value:e,message:t}=Y(c)?{value:!!c,message:c}:se(c);if(e&&(M[h]={type:E,message:t,ref:C,...F(E,t)},!n))return T(t),M}if(!(D||o(p)&&o(f))){let e,t;const a=se(f),i=se(p);if(o(w)||isNaN(w)){const n=s.valueAsDate||new Date(w),r=e=>new Date((new Date).toDateString()+" "+e),o="time"==s.type,l="week"==s.type;A(a.value)&&w&&(e=o?r(w)>r(a.value):l?w>a.value:n>new Date(a.value)),A(i.value)&&w&&(t=o?r(w)<r(i.value):l?w<i.value:n<new Date(i.value))}else{const n=s.valueAsNumber||(w?+w:w);o(a.value)||(e=n>a.value),o(i.value)||(t=n<i.value)}if((e||t)&&(R(!!e,a.message,i.message,"max","min"),!n))return T(M[h].message),M}if((d||m)&&!D&&(A(w)||i&&Array.isArray(w))){const e=se(d),t=se(m),a=!o(e.value)&&w.length>+e.value,i=!o(t.value)&&w.length<+t.value;if((a||i)&&(R(a,e.message,t.message),!n))return T(M[h].message),M}if(v&&!D&&A(w)){const{value:e,message:t}=se(v);if(Z(e)&&!w.match(e)&&(M[h]={type:O,message:t,ref:s,...F(O,t)},!n))return T(t),M}if(y)if(K(y)){const e=re(await y(w,t),C);if(e&&(M[h]={...e,...F("validate",e.message)},!n))return T(e.message),M}else if(u(y)){let e={};for(const a in y){if(!k(e)&&!n)break;const i=re(await y[a](w,t),C,a);i&&(e={...i,...F(a,i.message)},T(i.message),n&&(M[h]=e))}if(!k(e)&&(M[h]={ref:C,...e},!n))return M}return T(!0),M};function le(e,t){return[...e,...T(t)]}var ue=e=>Array.isArray(e)?e.map((()=>{})):void 0;function ce(e,t,n){return[...e.slice(0,t),...T(n),...e.slice(t)]}var de=(e,t,n)=>Array.isArray(e)?(b(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function me(e,t){return[...T(t),...T(e)]}var pe=(e,t)=>b(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return f(a).length?a:[]}(e,T(t).sort(((e,t)=>e-t))),fe=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function be(e,t){const n=Array.isArray(t)?t:F(t)?[t]:R(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=b(e)?a++:e[t[a++]];return e}(e,n),i=n.length-1,r=n[i];return a&&delete a[r],0!==i&&(u(a)&&k(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!b(e[t]))return!1;return!0}(a))&&be(e,n.slice(0,-1)),e}var ge=(e,t,n)=>(e[t]=n,e);function ve(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var ye=e=>o(e)||!l(e);function he(e,t){if(ye(e)||ye(t))return e===t;if(s(e)&&s(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(s(n)&&s(e)||u(n)&&u(e)||Array.isArray(n)&&Array.isArray(e)?!he(n,e):n!==e)return!1}}return!0}var je=e=>"select-multiple"===e.type,Oe=e=>J(e)&&e.isConnected,Ee=e=>{for(const t in e)if(K(e[t]))return!0;return!1};function xe(e,t={}){const n=Array.isArray(e);if(u(e)||n)for(const n in e)Array.isArray(e[n])||u(e[n])&&!Ee(e[n])?(t[n]=Array.isArray(e[n])?[]:{},xe(e[n],t[n])):o(e[n])||(t[n]=!0);return t}function Se(e,t,n){const a=Array.isArray(e);if(u(e)||a)for(const a in e)Array.isArray(e[a])||u(e[a])&&!Ee(e[a])?b(t)||ye(n[a])?n[a]=Array.isArray(e[a])?xe(e[a],[]):{...xe(e[a])}:Se(e[a],o(t)?{}:t[a],n[a]):n[a]=!he(e[a],t[a]);return n}var we=(e,t)=>Se(e,t,xe(t)),ke=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>b(e)?e:t?""===e?NaN:e?+e:e:n&&A(e)?new Date(e):a?a(e):e;function Ce(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return W(t)?t.files:X(t)?ie(e.refs).value:je(t)?[...t.selectedOptions].map((({value:e})=>e)):r(t)?ne(e.refs).value:ke(b(t.value)?e.ref.value:t.value,e)}var Te=e=>b(e)?e:Z(e)?e.source:u(e)?Z(e.value)?e.value.source:e.value:e;function Me(e,t,n){const a=g(e,n);if(a||F(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),r=g(t,a),s=g(e,a);if(r&&!Array.isArray(r)&&n!==a)return{name:n};if(s&&s.type)return{name:a,error:s};i.pop()}return{name:n}}const Ie={mode:h,reValidateMode:y,shouldFocusError:!0};function _e(e={},t){let n,a={...Ie,...e},i={submitCount:0,isDirty:!1,isLoading:K(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},l={},y=(u(a.defaultValues)||u(a.values))&&p(a.defaultValues||a.values)||{},h=a.shouldUnregister?{}:p(y),O={action:!1,mount:!1,watch:!1},E={mount:new Set,unMount:new Set,array:new Set,watch:new Set},x=0;const S={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},w={values:ve(),array:ve(),state:ve()},C=e.resetOptions&&e.resetOptions.keepDirtyValues,M=U(a.mode),I=U(a.reValidateMode),_=a.criteriaMode===j,D=async e=>{if(S.isValid||e){const e=a.resolver?k((await B()).errors):await V(l,!0);e!==i.isValid&&w.state.next({isValid:e})}},F=e=>S.isValidating&&w.state.next({isValidating:e}),R=(e,t,n,a)=>{const i=g(l,e);if(i){const r=g(h,e,b(n)?g(y,e):n);b(r)||a&&a.defaultChecked||t?N(h,e,t?r:Ce(i._f)):Z(e,r),O.mount&&D()}},z=(e,t,n,a,r)=>{let s=!1,o=!1;const l={name:e};if(!n||a){S.isDirty&&(o=i.isDirty,i.isDirty=l.isDirty=$(),s=o!==l.isDirty);const n=he(g(y,e),t);o=g(i.dirtyFields,e),n?be(i.dirtyFields,e):N(i.dirtyFields,e,!0),l.dirtyFields=i.dirtyFields,s=s||S.dirtyFields&&o!==!n}if(n){const t=g(i.touchedFields,e);t||(N(i.touchedFields,e,n),l.touchedFields=i.touchedFields,s=s||S.touchedFields&&t!==n)}return s&&r&&w.state.next(l),s?l:{}},L=(t,a,r,s)=>{const o=g(i.errors,t),l=S.isValid&&Q(a)&&i.isValid!==a;var u;if(e.delayError&&r?(u=()=>((e,t)=>{N(i.errors,e,t),w.state.next({errors:i.errors})})(t,r),n=e=>{clearTimeout(x),x=setTimeout(u,e)},n(e.delayError)):(clearTimeout(x),n=null,r?N(i.errors,t,r):be(i.errors,t)),(r?!he(o,r):o)||!k(s)||l){const e={...s,...l&&Q(a)?{isValid:a}:{},errors:i.errors,name:t};i={...i,...e},w.state.next(e)}F(!1)},B=async e=>a.resolver(h,a.context,((e,t,n,a)=>{const i={};for(const n of e){const e=g(t,n);e&&N(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||E.mount,l,a.criteriaMode,a.shouldUseNativeValidation)),V=async(e,t,n={valid:!0})=>{for(const r in e){const s=e[r];if(s){const{_f:e,...r}=s;if(e){const r=E.array.has(e.name),o=await oe(s,h,_,a.shouldUseNativeValidation&&!t,r);if(o[e.name]&&(n.valid=!1,t))break;!t&&(g(o,e.name)?r?H(i.errors,o,e.name):N(i.errors,e.name,o[e.name]):be(i.errors,e.name))}r&&await V(r,t,n)}}return n.valid},$=(e,t)=>(e&&t&&N(h,e,t),!he(ie(),y)),Y=(e,t,n)=>P(e,E,{...O.mount?h:b(t)?y:A(e)?{[e]:t}:t},n,t),Z=(e,t,n={})=>{const a=g(l,e);let i=t;if(a){const n=a._f;n&&(!n.disabled&&N(h,e,ke(t,n)),i=J(n.ref)&&o(t)?"":t,je(n.ref)?[...n.ref.options].forEach((e=>e.selected=i.includes(e.value))):n.refs?r(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):n.refs[0]&&(n.refs[0].checked=!!i):n.refs.forEach((e=>e.checked=e.value===i)):W(n.ref)?n.ref.value="":(n.ref.value=i,n.ref.type||w.values.next({name:e,values:{...h}})))}(n.shouldDirty||n.shouldTouch)&&z(e,i,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ae(e)},ee=(e,t,n)=>{for(const a in t){const i=t[a],r=`${e}.${a}`,o=g(l,r);!E.array.has(e)&&ye(i)&&(!o||o._f)||s(i)?Z(r,i,n):ee(r,i,n)}},te=(e,n,a={})=>{const r=g(l,e),s=E.array.has(e),u=p(n);N(h,e,u),s?(w.array.next({name:e,values:{...h}}),(S.isDirty||S.dirtyFields)&&a.shouldDirty&&w.state.next({name:e,dirtyFields:we(y,h),isDirty:$(e,u)})):!r||r._f||o(u)?Z(e,u,a):ee(e,u,a),G(e,E)&&w.state.next({...i}),w.values.next({name:e,values:{...h}}),!O.mount&&t()},ne=async e=>{const t=e.target;let r=t.name,s=!0;const o=g(l,r);if(o){let d,m;const p=t.type?Ce(o._f):c(e),f=e.type===v||"focusout"===e.type,b=!((u=o._f).mount&&(u.required||u.min||u.max||u.maxLength||u.minLength||u.pattern||u.validate)||a.resolver||g(i.errors,r)||o._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(f,g(i.touchedFields,r),i.isSubmitted,I,M),y=G(r,E,f);N(h,r,p),f?(o._f.onBlur&&o._f.onBlur(e),n&&n(0)):o._f.onChange&&o._f.onChange(e);const j=z(r,p,f,!1),O=!k(j)||y;if(!f&&w.values.next({name:r,type:e.type,values:{...h}}),b)return S.isValid&&D(),O&&w.state.next({name:r,...y?{}:j});if(!f&&y&&w.state.next({...i}),F(!0),a.resolver){const{errors:e}=await B([r]),t=Me(i.errors,l,r),n=Me(e,l,t.name||r);d=n.error,r=n.name,m=k(e)}else d=(await oe(o,h,_,a.shouldUseNativeValidation))[r],s=isNaN(p)||p===g(h,r,p),s&&(d?m=!1:S.isValid&&(m=await V(l,!0)));s&&(o._f.deps&&ae(o._f.deps),L(r,m,d,j))}var u},ae=async(e,t={})=>{let n,r;const s=T(e);if(F(!0),a.resolver){const t=await(async e=>{const{errors:t}=await B();if(e)for(const n of e){const e=g(t,n);e?N(i.errors,n,e):be(i.errors,n)}else i.errors=t;return t})(b(e)?e:s);n=k(t),r=e?!s.some((e=>g(t,e))):n}else e?(r=(await Promise.all(s.map((async e=>{const t=g(l,e);return await V(t&&t._f?{[e]:t}:t)})))).every(Boolean),(r||i.isValid)&&D()):r=n=await V(l);return w.state.next({...!A(e)||S.isValid&&n!==i.isValid?{}:{name:e},...a.resolver||!e?{isValid:n}:{},errors:i.errors,isValidating:!1}),t.shouldFocus&&!r&&q(l,(e=>e&&g(i.errors,e)),e?s:E.mount),r},ie=e=>{const t={...y,...O.mount?h:{}};return b(e)?t:A(e)?g(t,e):e.map((e=>g(t,e)))},re=(e,t)=>({invalid:!!g((t||i).errors,e),isDirty:!!g((t||i).dirtyFields,e),isTouched:!!g((t||i).touchedFields,e),error:g((t||i).errors,e)}),se=(e,t,n)=>{const a=(g(l,e,{_f:{}})._f||{}).ref;N(i.errors,e,{...t,ref:a}),w.state.next({name:e,errors:i.errors,isValid:!1}),n&&n.shouldFocus&&a&&a.focus&&a.focus()},le=(e,t={})=>{for(const n of e?T(e):E.mount)E.mount.delete(n),E.array.delete(n),t.keepValue||(be(l,n),be(h,n)),!t.keepError&&be(i.errors,n),!t.keepDirty&&be(i.dirtyFields,n),!t.keepTouched&&be(i.touchedFields,n),!a.shouldUnregister&&!t.keepDefaultValue&&be(y,n);w.values.next({values:{...h}}),w.state.next({...i,...t.keepDirty?{isDirty:$()}:{}}),!t.keepIsValid&&D()},ue=(e,t={})=>{let n=g(l,e);const i=Q(t.disabled);return N(l,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),E.mount.add(e),n?i&&N(h,e,t.disabled?void 0:g(h,e,Ce(n._f))):R(e,!0,t.value),{...i?{disabled:t.disabled}:{},...a.progressive?{required:!!t.required,min:Te(t.min),max:Te(t.max),minLength:Te(t.minLength),maxLength:Te(t.maxLength),pattern:Te(t.pattern)}:{},name:e,onChange:ne,onBlur:ne,ref:i=>{if(i){ue(e,t),n=g(l,e);const a=b(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,s=(e=>X(e)||r(e))(a),o=n._f.refs||[];if(s?o.find((e=>e===a)):a===n._f.ref)return;N(l,e,{_f:{...n._f,...s?{refs:[...o.filter(Oe),a,...Array.isArray(g(y,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),R(e,!1,void 0,a)}else n=g(l,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(E.array,e)||!O.action)&&E.unMount.add(e)}}},ce=()=>a.shouldFocusError&&q(l,(e=>e&&g(i.errors,e)),E.mount),de=(e,t)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let r=p(h);if(w.state.next({isSubmitting:!0}),a.resolver){const{errors:e,values:t}=await B();i.errors=e,r=t}else await V(l);be(i.errors,"root"),k(i.errors)?(w.state.next({errors:{}}),await e(r,n)):(t&&await t({...i.errors},n),ce(),setTimeout(ce)),w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:k(i.errors),submitCount:i.submitCount+1,errors:i.errors})},me=(n,a={})=>{const r=n||y,s=p(r),o=n&&!k(n)?s:y;if(a.keepDefaultValues||(y=r),!a.keepValues){if(a.keepDirtyValues||C)for(const e of E.mount)g(i.dirtyFields,e)?N(o,e,g(h,e)):te(e,g(o,e));else{if(m&&b(n))for(const e of E.mount){const t=g(l,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(J(e)){const t=e.closest("form");if(t){t.reset();break}}}}l={}}h=e.shouldUnregister?a.keepDefaultValues?p(y):{}:p(o),w.array.next({values:{...o}}),w.values.next({values:{...o}})}E={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!O.mount&&t(),O.mount=!S.isValid||!!a.keepIsValid,O.watch=!!e.shouldUnregister,w.state.next({submitCount:a.keepSubmitCount?i.submitCount:0,isDirty:a.keepDirty?i.isDirty:!(!a.keepDefaultValues||he(n,y)),isSubmitted:!!a.keepIsSubmitted&&i.isSubmitted,dirtyFields:a.keepDirtyValues?i.dirtyFields:a.keepDefaultValues&&n?we(y,n):{},touchedFields:a.keepTouched?i.touchedFields:{},errors:a.keepErrors?i.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},pe=(e,t)=>me(K(e)?e(h):e,t);return{control:{register:ue,unregister:le,getFieldState:re,handleSubmit:de,setError:se,_executeSchema:B,_getWatch:Y,_getDirty:$,_updateValid:D,_removeUnmounted:()=>{for(const e of E.unMount){const t=g(l,e);t&&(t._f.refs?t._f.refs.every((e=>!Oe(e))):!Oe(t._f.ref))&&le(e)}E.unMount=new Set},_updateFieldArray:(e,t=[],n,a,r=!0,s=!0)=>{if(a&&n){if(O.action=!0,s&&Array.isArray(g(l,e))){const t=n(g(l,e),a.argA,a.argB);r&&N(l,e,t)}if(s&&Array.isArray(g(i.errors,e))){const t=n(g(i.errors,e),a.argA,a.argB);r&&N(i.errors,e,t),((e,t)=>{!f(g(e,t)).length&&be(e,t)})(i.errors,e)}if(S.touchedFields&&s&&Array.isArray(g(i.touchedFields,e))){const t=n(g(i.touchedFields,e),a.argA,a.argB);r&&N(i.touchedFields,e,t)}S.dirtyFields&&(i.dirtyFields=we(y,h)),w.state.next({name:e,isDirty:$(e,t),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else N(h,e,t)},_getFieldArray:t=>f(g(O.mount?h:y,t,e.shouldUnregister?g(y,t,[]):[])),_reset:me,_resetDefaultValues:()=>K(a.defaultValues)&&a.defaultValues().then((e=>{pe(e,a.resetOptions),w.state.next({isLoading:!1})})),_updateFormState:e=>{i={...i,...e}},_subjects:w,_proxyFormState:S,get _fields(){return l},get _formValues(){return h},get _state(){return O},set _state(e){O=e},get _defaultValues(){return y},get _names(){return E},set _names(e){E=e},get _formState(){return i},set _formState(e){i=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:ae,register:ue,handleSubmit:de,watch:(e,t)=>K(e)?w.values.subscribe({next:n=>e(Y(void 0,t),n)}):Y(e,t,!0),setValue:te,getValues:ie,reset:pe,resetField:(e,t={})=>{g(l,e)&&(b(t.defaultValue)?te(e,g(y,e)):(te(e,t.defaultValue),N(y,e,t.defaultValue)),t.keepTouched||be(i.touchedFields,e),t.keepDirty||(be(i.dirtyFields,e),i.isDirty=t.defaultValue?$(e,g(y,e)):$()),t.keepError||(be(i.errors,e),S.isValid&&D()),w.state.next({...i}))},clearErrors:e=>{e&&T(e).forEach((e=>be(i.errors,e))),w.state.next({errors:e?i.errors:{}})},unregister:le,setError:se,setFocus:(e,t={})=>{const n=g(l,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:re}}t.Controller=e=>e.render(z(e)),t.Form=function(e){const t=S(),[n,a]=i.default.useState(!1),{control:r=t.control,onSubmit:s,children:o,action:l,method:u=L,headers:c,encType:d,onError:m,render:p,onSuccess:f,validateStatus:b,...v}=e,y=async t=>{let n=!1,a="";await r.handleSubmit((async e=>{const i=new FormData;let o="";try{o=JSON.stringify(e)}catch(e){}for(const t of r._names.mount)i.append(t,g(e,t));if(s&&s({data:e,event:t,method:u,formData:i,formDataJson:o}),l)try{const e=[c&&c["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(l,{method:u,headers:{...c,...d?{"Content-Type":d}:{}},body:e?o:i});t&&(b?!b(t.status):t.status<200||t.status>=300)?(n=!0,m&&m({response:t}),a=String(t.status)):f&&f({response:t})}catch(e){n=!0,m&&m({error:e})}}))(t),n&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:a}))};return i.default.useEffect((()=>{a(!0)}),[]),p?i.default.createElement(i.default.Fragment,null,p({submit:y})):i.default.createElement("form",{noValidate:n,action:l,method:u,encType:d,onSubmit:y,...v},o)},t.FormProvider=e=>{const{children:t,...n}=e;return i.default.createElement(x.Provider,{value:n},t)},t.appendErrors=B,t.get=g,t.set=N,t.useController=z,t.useFieldArray=function(e){const t=S(),{control:n=t.control,name:a,keyName:r="id",shouldUnregister:s}=e,[o,l]=i.default.useState(n._getFieldArray(a)),u=i.default.useRef(n._getFieldArray(a).map(V)),c=i.default.useRef(o),d=i.default.useRef(a),m=i.default.useRef(!1);d.current=a,c.current=o,n._names.array.add(a),e.rules&&n.register(a,e.rules),I({next:({values:e,name:t})=>{if(t===d.current||!t){const t=g(e,d.current);Array.isArray(t)&&(l(t),u.current=t.map(V))}},subject:n._subjects.array});const f=i.default.useCallback((e=>{m.current=!0,n._updateFieldArray(a,e)}),[n,a]);return i.default.useEffect((()=>{if(n._state.action=!1,G(a,n._names)&&n._subjects.state.next({...n._formState}),m.current&&(!U(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=g(e.errors,a),i=g(n._formState.errors,a);(i?!t&&i.type||t&&(i.type!==t.type||i.message!==t.message):t&&t.type)&&(t?N(n._formState.errors,a,t):be(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=g(n._fields,a);e&&e._f&&oe(e,n._formValues,n._options.criteriaMode===j,n._options.shouldUseNativeValidation,!0).then((e=>!k(e)&&n._subjects.state.next({errors:H(n._formState.errors,e,a)})))}n._subjects.values.next({name:a,values:{...n._formValues}}),n._names.focus&&q(n._fields,(e=>!!e&&e.startsWith(n._names.focus||""))),n._names.focus="",n._updateValid()}),[o,a,n]),i.default.useEffect((()=>(!g(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||s)&&n.unregister(a)})),[a,n,r,s]),{swap:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);fe(i,e,t),fe(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,fe,{argA:e,argB:t},!1)}),[f,a,n]),move:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);de(i,e,t),de(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,de,{argA:e,argB:t},!1)}),[f,a,n]),prepend:i.default.useCallback(((e,t)=>{const i=T(p(e)),r=me(n._getFieldArray(a),i);n._names.focus=$(a,0,t),u.current=me(u.current,i.map(V)),f(r),l(r),n._updateFieldArray(a,r,me,{argA:ue(e)})}),[f,a,n]),append:i.default.useCallback(((e,t)=>{const i=T(p(e)),r=le(n._getFieldArray(a),i);n._names.focus=$(a,r.length-1,t),u.current=le(u.current,i.map(V)),f(r),l(r),n._updateFieldArray(a,r,le,{argA:ue(e)})}),[f,a,n]),remove:i.default.useCallback((e=>{const t=pe(n._getFieldArray(a),e);u.current=pe(u.current,e),f(t),l(t),n._updateFieldArray(a,t,pe,{argA:e})}),[f,a,n]),insert:i.default.useCallback(((e,t,i)=>{const r=T(p(t)),s=ce(n._getFieldArray(a),e,r);n._names.focus=$(a,e,i),u.current=ce(u.current,e,r.map(V)),f(s),l(s),n._updateFieldArray(a,s,ce,{argA:e,argB:ue(t)})}),[f,a,n]),update:i.default.useCallback(((e,t)=>{const i=p(t),r=ge(n._getFieldArray(a),e,i);u.current=[...r].map(((t,n)=>t&&n!==e?u.current[n]:V())),f(r),l([...r]),n._updateFieldArray(a,r,ge,{argA:e,argB:i},!0,!1)}),[f,a,n]),replace:i.default.useCallback((e=>{const t=T(p(e));u.current=t.map(V),f([...t]),l([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[f,a,n]),fields:i.default.useMemo((()=>o.map(((e,t)=>({...e,[r]:u.current[t]||V()})))),[o,r])}},t.useForm=function(e={}){const t=i.default.useRef(),[n,a]=i.default.useState({isDirty:!1,isValidating:!1,isLoading:K(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:K(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={..._e(e,(()=>a((e=>({...e}))))),formState:n});const r=t.current.control;return r._options=e,I({subject:r._subjects.state,next:e=>{C(e,r._proxyFormState,r._updateFormState,!0)&&a({...r._formState})}}),i.default.useEffect((()=>{e.values&&!he(e.values,r._defaultValues)?r._reset(e.values,r._options.resetOptions):r._resetDefaultValues()}),[e.values,r]),i.default.useEffect((()=>{r._state.mount||(r._updateValid(),r._state.mount=!0),r._state.watch&&(r._state.watch=!1,r._subjects.state.next({...r._formState})),r._removeUnmounted()})),t.current.formState=w(n,r),t.current},t.useFormContext=S,t.useFormState=_,t.useWatch=D},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i="!{osquery",r={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}i+=n;try{r=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return i+="}",e(i)({type:"osquery",configuration:r})},n.splice(n.indexOf("text"),0,"osquery")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(370);const i=({status:e,query:t,signalIds:n,signal:i})=>{if(n&&n.length>0)return Object(a.i)({status:e,signalIds:n,signal:i}).then((({updated:e})=>({updated:null!=e?e:0,version_conflicts:0})));if(t)return Object(a.j)({status:e,query:t,signal:i}).then((({updated:e,version_conflicts:t})=>({updated:null!=e?e:0,version_conflicts:t})));throw new Error("Either query or signalIds must be provided")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const a=["_source"];function i(e=[],t){return e&&e.length>0&&(1!==e.length||e[0]!==t.timeFieldName)?e:a}function r(e,t){return Object.fromEntries(Object.entries(e).filter((([e])=>e.startsWith(`${t}.`))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(19),s=n(696),o=n(208);const l=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:l,dataTestSubj:u,height:c,autoFocusDisabled:d,setIsMarkdownInvalid:m,includePlugins:p=!0},f)=>{const[b,g]=Object(a.useState)([]),v=Object(a.useCallback)(((e,{messages:t})=>{g(e?[e]:t),m(!!e)}),[m]),y=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t;d||null===(e=y.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const h=Object(o.b)("investigation_guide"),j=Object(o.b)("investigation_guide_interactions"),O=Object(a.useMemo)((()=>p?Object(s.d)({insightsUpsellingMessage:h,interactionsUpsellingMessage:j}):void 0),[p,h,j]);return Object(a.useImperativeHandle)(f,(()=>{var e,t;if(!y.current)return null;const n=null===(e=y.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...y.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(r.EuiMarkdownEditor,{ref:y,"aria-label":n,editorId:l,onChange:e,value:t,uiPlugins:O,parsingPluginList:s.a,processingPluginList:s.c,onParse:v,errors:b,"data-test-subj":u,height:c})}));l.displayName="MarkdownEditorComponent";const u=Object(a.memo)(l)},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Ne}));var a=n(19),i=n(2),r=n.n(i),s=n(45),o=n(4);const l=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),u=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),c=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),m=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),p=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),f=o.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),b=o.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),g=o.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),v=o.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),y=o.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),h=o.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),j=o.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),O=o.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),E=o.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),x=o.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),S=o.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),w=o.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),k=o.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),C=o.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),T=o.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),M=o.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),I=o.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),_=o.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),A=o.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),P=o.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),D=o.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),F=o.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),R=o.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),N=o.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),z=o.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),L=o.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),B=o.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),q=o.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var V=n(166),$=n(127),U=n(531),G=n(41),H=n.n(G),Q=n(49);const W=H()(a.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1bcjjxf-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),K=H()(a.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1bcjjxf-1"})(["max-width:none;"]),J=H()(a.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1bcjjxf-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),Y=H()(a.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1bcjjxf-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),X=H.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1bcjjxf-4"})(["width:600px;"]),Z=H()(a.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1bcjjxf-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],Q.euiThemeVars.euiSizeXS),ee=H.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1bcjjxf-6"})(["",""],(({theme:e})=>Object(G.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),te=(e,t)=>e.filter((e=>e!==t));var ne=n(308),ae=n(118),ie=n(511);const re=(e,t)=>Object(ne.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var se=n(42);const oe=H()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-yfgyo3-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),le=r.a.memo((({isShowing:e,onDismissModal:t,onContinue:n,onUpdate:i,missingPatterns:s})=>e?r.a.createElement(oe,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},r.a.createElement(a.EuiModalHeader,null,r.a.createElement(a.EuiModalHeaderTitle,null,v)),r.a.createElement(a.EuiModalBody,null,r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(a.EuiTextColor,{color:"subdued"},r.a.createElement("p",null,r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:r.a.createElement(ee,null,s.join(", "))}}),g))),r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Y,{"aria-label":y,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:n,title:y},y)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:i,size:"s"},h))))):null));le.displayName="UpdateDefaultDataViewModal";var ue=n(149),ce=n(121),de=n(129),me=n(124),pe=n(158);const fe=({activePatterns:e,deadPatterns:t,selectedPatterns:n,timelineType:s})=>{const o=Object(i.useMemo)((()=>t.length>0?r.a.createElement(a.EuiToolTip,{content:r.a.createElement(be,{activePatterns:e,selectedPatterns:n,timelineType:s})},r.a.createElement(a.EuiIcon,{type:"questionInCircle",title:F})):null),[e,t.length,n,s]);return s===ce.m.template?r.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:o,callout:r.a.createElement(ee,null,e.join(", "))}})):r.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:o,callout:r.a.createElement(ee,null,e.join(", "))}}))},be=({activePatterns:e,selectedPatterns:t,timelineType:n})=>{const a=Object(i.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return n===ce.m.template?r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}}):r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}})},ge=({timelineType:e,selectedPatterns:t})=>{const n=Object(i.useMemo)((()=>r.a.createElement(ee,null,t.join(", "))),[t]);return e===ce.m.template?r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:n}}):r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:n}})},ve=({onReset:e,timelineType:t})=>t===ce.m.template?r.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})):r.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})),ye=({onReset:e,timelineType:t})=>t===ce.m.template?r.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})):r.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})),he={deprecated:{title:{[ce.m.default]:u,[ce.m.template]:c},update:A},missingPatterns:{title:{[ce.m.default]:d,[ce.m.template]:m},update:h}},je=r.a.memo((({activePatterns:e,indicesExist:t,isModified:n,onDismiss:s,onReset:o,onUpdate:l,selectedPatterns:u,missingPatterns:c})=>{const d=Object(i.useMemo)((()=>r.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:l,size:"s",disabled:!t},he[n].update)),[t,n,l]),m=Object(i.useMemo)((()=>t?d:r.a.createElement(a.EuiToolTip,{position:"top",content:R,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),p=e&&e.length>0?u.filter((t=>!e.includes(t))):[],f=Object(i.useMemo)((()=>de.b.getTimelineByIdSelector()),[]),b=Object(me.a)((e=>{var t;return(null!==(t=f(e,ue.f.active))&&void 0!==t?t:pe.b).timelineType}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:he[n].title[b]}),r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(a.EuiTextColor,{color:"subdued"},r.a.createElement("p",null,e&&e.length>0?r.a.createElement(fe,{timelineType:b,activePatterns:e,deadPatterns:p,selectedPatterns:u}):r.a.createElement(ge,{timelineType:b,selectedPatterns:u}),"deprecated"===n&&r.a.createElement(ve,{timelineType:b,onReset:o}),"missingPatterns"===n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:r.a.createElement(ee,null,c.join(", "))}})),r.a.createElement(ye,{timelineType:b,onReset:o}))))),r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Y,{"aria-label":D,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:s,title:D},D)),r.a.createElement(a.EuiFlexItem,{grow:!1},m)))}));je.displayName="TemporarySourcererComp";const Oe=r.a.memo((({activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onContinueWithoutUpdate:i,onDismiss:s,onReset:o,onUpdateStepOne:l,onUpdateStepTwo:u,selectedPatterns:c,isShowingUpdateModal:d,onDismissModal:m})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(je,{activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onDismiss:s,onReset:o,onUpdate:l,selectedPatterns:c}),r.a.createElement(le,{isShowing:d,missingPatterns:a,onDismissModal:m,onContinue:i,onUpdate:u}))));Oe.displayName="TemporarySourcerer";var Ee=n(132),xe=n(393),Se=n(5);const we=H()(a.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-12c6aaf-0"})(["float:right;"]),ke=r.a.memo((()=>{const e=Object(i.useCallback)((()=>{document.location.reload()}),[]);return r.a.createElement(we,{onClick:e,"data-test-subj":"page-refresh"},B)}));ke.displayName="RefreshButton";var Ce=n(123);const Te=({activePatterns:e,disabled:t,isModified:n,isOnlyDetectionAlerts:s,isPopoverOpen:o,isTimelineSourcerer:l,loading:u,onClick:c,selectedPatterns:d,signalIndexName:m})=>{const p=Object(i.useMemo)((()=>{switch(n){case"modified":return r.a.createElement(Z,{"data-test-subj":"sourcerer-modified-badge"},j);case"alerts":return r.a.createElement(Z,{"data-test-subj":"sourcerer-alerts-badge"},O);case"deprecated":return r.a.createElement(Z,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},E);case"missingPatterns":return r.a.createElement(Z,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},E);default:return null}}),[n]),f=Object(i.useMemo)((()=>l?a.EuiButton:J),[l]),g=Object(i.useMemo)((()=>r.a.createElement(f,{"aria-label":b,"data-test-subj":l?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:u,onClick:c,title:b},b,!t&&p)),[t,p,l,u,c,f]),v=Object(i.useMemo)((()=>t?_:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:n,signalIndexName:a})=>t||e&&!a?null:(e?[a]:n).join(", "))({isOnlyDetectionAlerts:s,isPopoverOpen:o,selectedPatterns:null!=e?e:d,signalIndexName:m})),[e,t,s,o,d,m]);return v?r.a.createElement(a.EuiToolTip,{position:"top",content:v,"data-test-subj":"sourcerer-tooltip"},g):g},Me=Object(i.memo)(Te),Ie=r.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?r.a.createElement(a.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Ie.displayName="SourcererCallout";const _e=r.a.memo((({onChange:e,checked:t,isShow:n})=>n?r.a.createElement(K,null,r.a.createElement(a.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:z,onChange:e})):null));_e.displayName="AlertsCheckbox";const Ae=r.a.memo((({disableSave:e,isShow:t,onReset:n,onSave:i})=>t?r.a.createElement(K,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Y,{"aria-label":P,"data-test-subj":"sourcerer-reset",flush:"left",onClick:n,title:P},P)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButton,{onClick:i,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},k)))):null));Ae.displayName="SaveButtons";var Pe=n(459),De=n(189),Fe=n(198);const Re=r.a.memo((({showSourcerer:e,activePatterns:t,isTriggerDisabled:n,isModified:i,isOnlyDetectionAlerts:s,isPopoverOpen:o,loading:l,setPopoverIsOpenCb:u,selectedPatterns:c,signalIndexName:d,handleClosePopOver:m,isTimelineSourcerer:p,selectedDataViewId:f,sourcererMissingPatterns:b,onUpdateDetectionAlertsChecked:g,setMissingPatterns:v,setDataViewId:y,scopeId:h,children:j})=>e?h===$.SourcererScopeName.analyzer?r.a.createElement(r.a.Fragment,null,j):r.a.createElement(a.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:r.a.createElement(Me,{activePatterns:t,disabled:n,isModified:i,isOnlyDetectionAlerts:s,isPopoverOpen:o,isTimelineSourcerer:p,loading:l,onClick:u,selectedPatterns:c,signalIndexName:d}),closePopover:m,"data-test-subj":p?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:o,ownFocus:!0,repositionOnScroll:!0},r.a.createElement(r.a.Fragment,null,j)):null));Re.displayName="SourcererPopover";const Ne=r.a.memo((({scope:e})=>{const t=Object(s.useDispatch)(),n=e===$.SourcererScopeName.detections,o=e===$.SourcererScopeName.timeline,u=e===$.SourcererScopeName.default,c=Object(De.d)(Fe.a.sourcerer),d=Object(s.useSelector)(V.d.signalIndexName),m=Object(s.useSelector)(V.d.defaultDataView),b=Object(s.useSelector)(V.d.kibanaDataViews),g=Object(s.useSelector)((t=>V.d.sourcererScopeSelectedDataViewId(t,e))),v=Object(s.useSelector)((t=>V.d.sourcererScopeSelectedPatterns(t,e))),y=Object(s.useSelector)((t=>V.d.sourcererScopeMissingPatterns(t,e))),{pollForSignalIndex:h}=Object(Pe.a)();Object(i.useEffect)((()=>{null!=h&&(o||n)&&h()}),[n,o,h]);const{activePatterns:E,indicesExist:k,loading:_}=Object(Ee.a)(e),[A,P]=Object(i.useState)(E&&E.length>0?y.filter((e=>E.includes(e))):[]);Object(i.useEffect)((()=>{E&&E.length>0&&P(y.filter((e=>E.includes(e))))}),[E,y]);const[D,F]=Object(i.useState)(o&&v.join()===d),R=Object(i.useCallback)((()=>{F(o&&v.join()===d)}),[o,v,d]);Object(i.useEffect)((()=>{R()}),[v]);const z=n||o&&D,[B,G]=Object(i.useState)(!1),[H,Q]=Object(i.useState)(g),{allOptions:Y,dataViewSelectOptions:ee,loadingIndexPatterns:oe,isModified:le,handleOutsideClick:ue,onChangeCombo:ce,renderOption:de,selectedOptions:me,setIndexPatternsByDataView:pe}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:n,kibanaDataViews:o,missingPatterns:l,scopeId:u,selectedDataViewId:c,selectedPatterns:d,signalIndexName:m})=>{const p=Object(s.useDispatch)(),{data:{dataViews:f}}=Object(ae.j)().services,b=Object(i.useRef)(!0),[g,v]=Object(i.useState)(!1),y=Object(i.useMemo)((()=>m?re([m]):[]),[m]),h=Object(i.useMemo)((()=>re(d)),[d]),[E,w]=Object(i.useState)(n?y:h),[k,C]=Object(i.useState)(null==e?"deprecated":l.length>0?"missingPatterns":""),{allPatterns:T,selectablePatterns:M}=Object(i.useMemo)((()=>{if(n&&m)return{allPatterns:[m],selectablePatterns:[m]};const t=o.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const a=[...new Set(t.title.split(","))];return u===V.b.SourcererScopeName.default?{allPatterns:te(a,m),selectablePatterns:te(t.patternList,m)}:{allPatterns:a,selectablePatterns:t.patternList}}),[e,n,o,u,m]),I=Object(i.useMemo)((()=>re(T,M)),[T,M]),_=Object(i.useCallback)(((e,n=!1)=>u===$.SourcererScopeName.detections||n?y:re(Object(U.b)(o.find((t=>t.id===e)),u,m,e===t))),[y,o,u,m,t]),A=Object(i.useMemo)((()=>null!=e?_(e):[]),[e,_]),P=Object(i.useCallback)(((e,t)=>{if(null==t)return C("deprecated");if(l.length>0)return C("missingPatterns");if(n)return C("alerts");const a=A.length!==e.length||!A.every((t=>e.find((e=>t.value===e))));return C(a?"modified":"")}),[A,n,l.length]);Object(i.useEffect)((()=>{w(u===$.SourcererScopeName.detections?y:h)}),[d,u,h,y]),Object(i.useEffect)((()=>{P(d.map((e=>e)),c)}),[n,c,l,u,d]);const D=Object(i.useCallback)((e=>{w(e)}),[]),F=Object(i.useCallback)((({value:e})=>r.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),R=Object(i.useCallback)((async(e,t)=>{if(o.some((t=>t.id===e&&0===t.indexFields.length))){try{v(!0),w([]);const t=await Object(ie.a)(e,f);b.current&&(p(V.a.setDataView(t)),w(n?y:re(t.patternList)))}catch(e){}v(!1)}else w(_(e,t))}),[y,p,_,n,o,f]),N=Object(i.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:n,isOnlyDetectionAlerts:i,kibanaDataViews:s})=>i?[{inputDisplay:r.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},r.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",S,r.a.createElement(Z,{"data-test-subj":"security-alerts-option-badge"},O)),value:t}]:s.map((({title:i,id:s})=>({inputDisplay:s===t?r.a.createElement("span",{"data-test-subj":"security-option-super"},r.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",x,n&&s===e&&r.a.createElement(Z,{"data-test-subj":"security-modified-option-badge"},j)):r.a.createElement("span",{"data-test-subj":"dataView-option-super"},r.a.createElement(a.EuiIcon,{type:"logoKibana",size:"s"})," ",i,n&&s===e&&r.a.createElement(Z,{"data-test-subj":"security-modified-option-badge"},j)),value:s}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===k,isOnlyDetectionAlerts:n,kibanaDataViews:o}):[]),[e,t,k,n,o]);return Object(i.useEffect)((()=>(b.current=!0,()=>{b.current=!1})),[]),{allOptions:I,dataViewSelectOptions:N,loadingIndexPatterns:g,handleOutsideClick:Object(i.useCallback)((()=>{w(h)}),[h]),isModified:k,onChangeCombo:D,renderOption:F,selectedOptions:E,setIndexPatternsByDataView:R}})({dataViewId:H,defaultDataViewId:m.id,isOnlyDetectionAlerts:z,kibanaDataViews:b,missingPatterns:A,scopeId:e,selectedDataViewId:g,selectedPatterns:v,signalIndexName:d}),fe=Object(i.useCallback)((e=>{F(e.target.checked),Q(m.id),pe(m.id,e.target.checked)}),[m.id,pe]),[be,ge]=Object(i.useState)(!1),[ve,ye]=Object(i.useState)(!1),he=Object(i.useCallback)((()=>{G((e=>!e)),ge(!1)}),[]),je=Object(i.useCallback)(((n,a,i)=>{t(V.a.setSelectedDataView({id:e,selectedDataViewId:n,selectedPatterns:a,shouldValidateSelectedPatterns:i})),u&&c({[$.SourcererScopeName.default]:{id:n,selectedPatterns:a}})}),[t,e,u,c]),we=Object(i.useCallback)((e=>{Q(e),pe(e)}),[pe]),Te=Object(i.useCallback)((()=>{Q(m.id),pe(m.id),F(!1),P([])}),[m.id,pe]),Me=Object(i.useCallback)((()=>{const e=me.map((e=>e.label));null!=H&&je(H,e),G(!1)}),[je,H,me]),Ne=Object(i.useCallback)((()=>{ue(),Q(g),P(y),R(),G(!1),ge(!1)}),[ue,R,g,y]),ze=Object(i.useCallback)((()=>{ye(!1);const e=v.filter((e=>m.patternList.includes(e)));je(m.id,e),G(!1)}),[m.id,m.patternList,je,v]),Le=Object(i.useCallback)((()=>{0===A.length?ze():ye(!0)}),[A,ze]),[Be,qe]=Object(i.useState)(!1),Ve=(e=>{const{uiSettings:t,...n}=Object(ae.j)().services,{addSuccess:s,addError:o}=Object(Ce.a)();return Object(i.useCallback)((async i=>{const[l,u]=await(async()=>{try{const e=[...t.get(Se.O),...i];return[await t.set(Se.O,Object(ne.a)(e)),null]}catch(e){return[!1,e]}})();return l?(s({color:"success",title:Object(xe.a)(L,n),text:Object(xe.a)(r.a.createElement(ke,null),n),iconType:void 0,toastLifeTimeMs:6e5}),!0):(o(null!==u?u:new Error(q),{title:q,toastMessage:r.a.createElement(r.a.Fragment,null,r.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},f)}}))}),!1)}),[o,s,e,t,n])})(Object(i.useCallback)((()=>{G(!0),Te()}),[Te])),$e=Object(i.useCallback)((async()=>{const e=await Ve(A);ye(!1),G(!1),e&&(je(m.id,null!=E?E:v,!1),qe(!0))}),[E,m.id,A,je,v,Ve]);Object(i.useEffect)((()=>{Q(g)}),[g]);const Ue=Object(i.useCallback)((()=>{ge((e=>!e))}),[]),Ge=Object(i.useMemo)((()=>k||[$.SourcererScopeName.analyzer,$.SourcererScopeName.timeline].includes(e)),[k,e]);return r.a.createElement(Re,{showSourcerer:Ge,activePatterns:E,isTriggerDisabled:Be,isModified:le,isOnlyDetectionAlerts:z,isPopoverOpen:B,isTimelineSourcerer:o,loading:_,handleOutsideClick:ue,setPopoverIsOpenCb:he,selectedPatterns:v,signalIndexName:d,handleClosePopOver:Ne,selectedDataViewId:g,sourcererMissingPatterns:y,onUpdateDetectionAlertsChecked:R,setMissingPatterns:P,setDataViewId:Q,scopeId:e},r.a.createElement(X,null,r.a.createElement(a.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},r.a.createElement(r.a.Fragment,null,w)),r.a.createElement(Ie,{isOnlyDetectionAlerts:z,title:o?p:l}),r.a.createElement(a.EuiSpacer,{size:"s"}),null===H&&"deprecated"===le||"missingPatterns"===le?r.a.createElement(Oe,{activePatterns:E,indicesExist:k,isModified:le,isShowingUpdateModal:ve,missingPatterns:A,onContinueWithoutUpdate:ze,onDismiss:he,onDismissModal:()=>ye(!1),onReset:Te,onUpdateStepOne:"deprecated"===le?Le:$e,onUpdateStepTwo:$e,selectedPatterns:v}):r.a.createElement(a.EuiForm,{component:"form"},r.a.createElement(r.a.Fragment,null,r.a.createElement(_e,{isShow:o,checked:D,onChange:fe}),H&&r.a.createElement(K,{label:C},r.a.createElement(a.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:oe,disabled:z,fullWidth:!0,onChange:we,options:ee,placeholder:C,valueOfSelected:H})),r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(J,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:be?"arrowDown":"arrowRight",onClick:Ue},T),be&&r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(W,{isDisabled:oe,$expandAdvancedOptions:be,helpText:z?void 0:I,label:M},r.a.createElement(a.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:z||oe,onChange:ce,options:Y,placeholder:N,renderOption:de,selectedOptions:me})),r.a.createElement(Ae,{disableSave:0===me.length,isShow:!n,onReset:Te,onSave:Me})),r.a.createElement(a.EuiSpacer,{size:"s"}))))}));Ne.displayName="Sourcerer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(46),i=n(1447),r=n(2069);a.exact(a.type({id:r.a})),a.exact(a.type({items:a.array(i.a)})),a.exact(a.type({name:a.string,description:a.string}));var s=n(891);const o=a.array(s.b),l=new a.Type("DefaultNamespaceArray",o.is,((e,t)=>{if(null==e)return a.success(["single"]);if("string"==typeof e){const n=e.trim().split(",").map((e=>e.trim()));return o.validate(n,t)}return a.failure(e,t)}),String);var u=n(2071),c=n(799),d=n(255);const m=new a.Type("NonEmptyStringArray",a.array(a.string).is,((e,t)=>{if("string"==typeof e&&""!==e.trim()){const n=e.trim().split(",").map((e=>e.trim()));return n.some((e=>""===e))?a.failure(e,t):a.success(n)}return a.failure(e,t)}),String);var p=n(439);a.intersection([a.exact(a.type({namespace_types:l})),a.exact(a.partial({ids:m,list_ids:m}))]);const f=a.exact(a.type({name:p.t,id:p.v,rule_id:p.y,exception_lists:u.a})),b=a.intersection([c.a,a.exact(a.type({referenced_rules:a.array(f)}))]),g=a.record(d.a,b);a.exact(a.type({references:a.array(g)}));var v=n(5);const y=`${v.Lb}/rules`,h=(v.qb,`${y}/exceptions/_find_references`)},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(308),i=n(294);const r=async(e,t,n=!1)=>{var r,s;const o=await t.get(e,!0,n),l=o.toSpec(),u=Object(a.a)(o.getIndexPattern().split(",")),c=await t.getExistingIndices(u);return{loading:!1,id:null!==(r=l.id)&&void 0!==r?r:"",title:o.getIndexPattern(),indexFields:o.fields,fields:l.fields,patternList:c,dataView:l,browserFields:Object(i.a)(null!==(s=l.id)&&void 0!==s?s:"",l.fields).browserFields,runtimeMappings:l.runtimeFieldMap}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.indexFieldsSearch.errorSearchDescription",{defaultMessage:"An error has occurred creating the ad-hoc data view"}),r=a.i18n.translate("xpack.securitySolution.dataView.fetchFields.warning",{defaultMessage:"Failed to fetch detailed fields information"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(897);const r=()=>{const e=Object(a.useContext)(i.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(41),s=n.n(r),o=n(44);const l=s.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(r.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;&:focus-visible{pointer-events:auto;opacity:1;}}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(o.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),u=i.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):i.a.createElement(i.a.Fragment,null,n)));u.displayName="HoverVisibilityContainer"},function(e,t,n){"use strict";e.exports=n(709)},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"u",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"v",(function(){return j})),n.d(t,"x",(function(){return O})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"w",(function(){return S})),n.d(t,"s",(function(){return w})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return C}));var a=n(4);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),r=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),s=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),o=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),u=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),c=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),v=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),y=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),h=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),j=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),O=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),E=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),x=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),S=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),w=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),k=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),C=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return v}));var a=n(2),i=n.n(a),r=n(19),s=n(41),o=n.n(s),l=n(118),u=n(235),c=n(573),d=n(4);const m=d.i18n.translate("xpack.securitySolution.noPermissionsTitle",{defaultMessage:"Privileges required"}),p=d.i18n.translate("xpack.securitySolution.noPrivilegesDefaultMessage",{defaultMessage:"To view this page, you must update privileges. For more information, contact your Kibana administrator."}),f=d.i18n.translate("xpack.securitySolution.goToDocumentationButton",{defaultMessage:"View documentation"}),b=o()(r.EuiFlexItem).withConfig({displayName:"SizedEuiFlexItem",componentId:"sc-156zz3c-0"})(["min-height:460px;font-size:1.1rem;"]),g=i.a.memo((({pageName:e,docLinkSelector:t})=>i.a.createElement(u.a,null,i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(b,null,i.a.createElement(r.EuiPageTemplate.EmptyPrompt,null,i.a.createElement(v,{pageName:e,docLinkSelector:t})))))));g.displayName="NoPrivilegePage";const v=i.a.memo((({pageName:e,docLinkSelector:t})=>{const{docLinks:n}=Object(l.j)().services,r=Object(a.useMemo)((()=>({feature:{icon:"documents",label:f,url:t(n.links),target:"_blank"}})),[t,n.links]),s=e?(e=>d.i18n.translate("xpack.securitySolution.noPrivilegesPerPageMessage",{values:{pageName:e},defaultMessage:"To view {pageName}, you must update privileges. For more information, contact your Kibana administrator."}))(e):p;return i.a.createElement(c.a,{actions:r,message:s,"data-test-subj":"noPrivilegesPage",title:m})}));v.displayName="NoPrivileges"},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(189),r=n(21);const s=e=>{const t=o();return Object(a.useMemo)((()=>t(e)),[t,e])},o=()=>{const e=Object(i.a)();return Object(a.useCallback)((t=>((e,t)=>Object(r.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(48),s=n(45),o=n(149),l=n(129);const u=Object(a.memo)((({children:e})=>{const t=Object(r.useLocation)(),n=Object(s.useDispatch)();return Object(a.useEffect)((()=>{n(l.a.showTimeline({id:o.f.active,show:!1}))}),[n,t.pathname]),Object(a.useEffect)((()=>{n({type:"userChangedUrl",payload:t})})),i.a.createElement(i.a.Fragment,null,e)}));u.displayName="RouteCapture"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(42),s=n(19),o=n(235);const l=i.a.memo((()=>i.a.createElement(o.a,null,i.a.createElement(s.EuiPageTemplate,null,i.a.createElement(s.EuiPageTemplate.EmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:i.a.createElement("p",null,i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));l.displayName="NotFoundPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),i=n(45),r=n(44),s=n(121),o=n(634),l=n(138),u=n(166),c=n(127),d=n(887),m=n(249),p=n(13),f=n(396);const b=()=>{const e=Object(i.useDispatch)();return Object(a.useCallback)((({duplicate:t,id:n,forceNotes:a=!1,from:i,notes:b,resolveTimelineConfig:g,timeline:v,to:y,ruleNote:h,ruleAuthor:j,preventSettingQuery:O})=>{let E=v;var x;if(t&&(E={...v,updated:void 0,changed:void 0,version:null}),Object(r.isEmpty)(E.indexNames)||e(u.a.setSelectedDataView({id:c.SourcererScopeName.timeline,selectedDataViewId:E.dataViewId,selectedPatterns:E.indexNames})),E.status===s.l.immutable&&E.timelineType===s.m.template?e(Object(m.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:f.a.toISOString(),to:f.b.toISOString()})):e(Object(m.setTimelineRangeDatePicker)({from:i,to:y})),e(Object(p.addTimeline)({id:n,timeline:E,resolveTimelineConfig:g,savedTimeline:t})),O||null==E.kqlQuery||null==E.kqlQuery.filterQuery||null==E.kqlQuery.filterQuery.kuery||""===E.kqlQuery.filterQuery.kuery.expression||e(Object(p.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(x=E.kqlQuery.filterQuery.kuery.kind)&&void 0!==x?x:"kuery",expression:E.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:E.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=h&&!Object(r.isEmpty)(h)){const t=Object(o.a)({newNote:h,user:j||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(p.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=b?b.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154).isClient?window:null,r=function(e){return!!e.addEventListener},s=function(e){return!!e.on};t.default=function(e,t,n,o){void 0===n&&(n=i),a.useEffect((function(){if(t&&n)return r(n)?n.addEventListener(e,t,o):s(n)&&n.on(e,t,o),function(){r(n)?n.removeEventListener(e,t,o):s(n)&&n.off(e,t,o)}}),[e,t,n,JSON.stringify(o)])}},function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),i=n.test(t);return a&&i&&(e=+e,t=+t),e===t?0:a&&!i?-1:i&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(207);const i=(e,t)=>`/name/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,s=(e,t)=>`/${e}${Object(a.a)(t)}`},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(119),i=n.n(a),r=n(2),s=n.n(r),o=n(45),l=n(41),u=n.n(l),c=n(760),d=n(124),m=n(183),p=n(761),f=n(138),b=n(118),g=n(148),v=n(200),y=n(42),h=n(80),j=n(19),O=n(249),E=n(658),x=n(625),S=n(474),w=n(127),k=n(916),C=n(282),T=n(417),M=n(447);const I=["ACTION_CUSTOMIZE_PANEL"],_=u.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),A=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraActions:n,extraOptions:a,getLensAttributes:i,height:l,id:u,inputsModelId:c=f.a.global,inspectTitle:d,lensAttributes:m,onLoad:p,scopeId:g=w.SourcererScopeName.default,enableLegendActions:v=!0,stackByField:A,timerange:D,width:F,withActions:R=x.a,disableOnClickFilter:N=!1,casesAttachmentMetadata:z})=>{var L,B,q;const V=Object(r.useMemo)((()=>({height:null!=l?l:"100%",minWidth:"100px",width:null!=F?F:"100%"})),[l,F]),{lens:$,data:{actions:{createFiltersFromValueClickAction:U}}}=Object(b.j)().services,G=Object(o.useDispatch)(),{searchSessionId:H}=Object(T.a)({visualizationId:u}),Q=Object(E.a)({applyGlobalQueriesAndFilters:e,applyPageAndTabsFilters:t,extraOptions:a,getLensAttributes:i,lensAttributes:m,scopeId:g,stackByField:A,title:""}),W=null==Q||null===(L=Q.state)||void 0===L||null===(B=L.visualization)||void 0===B?void 0:B.preferredSeriesType,K="lnsLegacyMetric"!==(null==Q?void 0:Q.visualizationType)&&"lnsPie"!==(null==Q?void 0:Q.visualizationType),J=$.EmbeddableComponent,Y=Object(r.useMemo)((()=>v?void 0:{settings:{legendAction:"ignore",onBrushEnd:"ignore"}}),[v]),{setInspectData:X}=(Z=p,{setInspectData:Object(r.useCallback)(((e,t)=>{var n;if(!t)return;const a=Object(C.f)(null==t||null===(n=t.requests)||void 0===n?void 0:n.getRequests());null==Z||Z({requests:a.requests,responses:a.responses,isLoading:e})}),[Z])});var Z;const{responses:ee,loading:te}=Object(T.a)({visualizationId:u}),{additionalRequests:ne,additionalResponses:ae,handleClick:ie,handleCloseModal:re,isButtonDisabled:se,isShowingModal:oe,request:le,response:ue}=Object(M.a)({inputId:c,isDisabled:te,multiple:null!=ee&&ee.length>1,queryId:u}),ce=Object(r.useMemo)((()=>({handleInspectClick:ie,isInspectButtonDisabled:se})),[ie,se]),de=Object(x.d)({attributes:Q,extraActions:n,inspectActionProps:ce,timeRange:D,withActions:R,lensMetadata:z}),me=Object(r.useCallback)((({range:e})=>{const[t,n]=e;G(Object(O.setAbsoluteRangeDatePicker)({id:c,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[G,c]),pe=Object(r.useCallback)((e=>{if(!N)return async e=>{if(!P(e)||"area"!==W)return void e.preventDefault();const[{query:t}]=await U({data:e.data,negate:e.negate}),n=null==t?void 0:t.range["@timestamp"];null!=n&&n.gte&&null!=n&&n.lt&&me({range:[n.gte,n.lt]})};e.preventDefault()}),[U,me,W,N]),fe=Object(r.useMemo)((()=>{var e,t;return null!=(null==Q||null===(e=Q.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==Q||null===(t=Q.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==Q||null===(q=Q.state)||void 0===q?void 0:q.adHocDataViews]);return H?!Q||null!=ee&&0===ee.length?s.a.createElement(j.EuiFlexGroup,null,s.a.createElement(j.EuiFlexItem,{grow:1},s.a.createElement(j.EuiEmptyPrompt,{body:s.a.createElement(j.EuiText,{size:"xs"},s.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),s.a.createElement(j.EuiFlexItem,{grow:!1},s.a.createElement(k.a,{extraActions:n,getLensAttributes:i,inputId:c,isInspectButtonDisabled:!0,lensAttributes:Q,queryId:u,stackByField:A,timerange:D,title:d,withActions:R,casesAttachmentMetadata:z}))):s.a.createElement(s.a.Fragment,null,Q&&H&&s.a.createElement(_,{$height:l,width:F,$addHoverActionsPadding:K},s.a.createElement(J,{attributes:Q,disabledActions:I,extraActions:de,id:u,onBrushEnd:me,onFilter:pe,onLoad:X,overrides:Y,searchSessionId:H,showInspector:!1,style:V,syncCursor:!1,syncTooltips:!1,timeRange:D,viewMode:h.ViewMode.VIEW,withDefaultActions:!1})),oe&&null!=le&&null!=ue&&s.a.createElement(S.a,{adHocDataViews:fe,additionalRequests:ne,additionalResponses:ae,closeModal:re,"data-test-subj":"inspect-modal",inputId:c,request:le,response:ue,title:d})):null},P=e=>Array.isArray(e.data)&&"column"in e.data[0],D=s.a.memo(A);var F=n(132);const R=e=>{var t,n;const a=Object(o.useDispatch)(),{inputId:u=f.a.global,id:y,isDonut:h,label:j,donutTextWrapperClassName:O,onLoad:E,...x}=e,{session:S,refetchByRestartingSession:w,refetchByDeletingSession:k}=(({inputId:e,queryId:t})=>{const n=Object(o.useDispatch)(),{data:a}=Object(b.j)().services,i=Object(r.useRef)(a.search.session),s=Object(r.useMemo)((()=>g.d.globalQueryByIdSelector()),[]),l=Object(r.useMemo)((()=>g.d.timelineQueryByIdSelector()),[]),{selectedInspectIndex:u}=Object(d.a)((n=>e===f.a.global?s(n,t):l(n,t))),c=Object(r.useCallback)((()=>{const e=i.current.start();n(v.c.setInspectionParameter({id:t,selectedInspectIndex:u,isInspected:!1,inputId:f.a.global,searchSessionId:e}))}),[n,t,u]),m=Object(r.useCallback)((()=>{n(v.c.deleteOneQuery({inputId:f.a.global,id:t}))}),[n,t]);return{session:i,refetchByRestartingSession:c,refetchByDeletingSession:m}})({inputId:u,queryId:y}),{indicesExist:C}=Object(F.a)(x.scopeId),M=Object(r.useRef)(x.timerange),I=Object(r.useMemo)((()=>m.d.globalQueryByIdSelector()),[]),{searchSessionId:_}=Object(d.a)((e=>I(e,y))),{responses:A}=Object(T.a)({visualizationId:y}),P=null!=A&&0!==(null===(t=A[0])||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.total),R=P?Object(l.css)(["top:40%;right:12%;"]):Object(l.css)(["top:66%;right:12%;"]),N=Object(r.useCallback)((({requests:e,responses:t,isLoading:n})=>{a(m.b.setQuery({inputId:u,id:y,searchSessionId:S.current.start(),refetch:w,loading:n,inspect:{dsl:e,response:t}})),"function"==typeof E&&E({requests:e,responses:t,isLoading:n})}),[a,u,y,S,w,E]);return Object(r.useEffect)((()=>{var e,t;(!C&&(null===(e=M.current)||void 0===e?void 0:e.from)!==x.timerange.from||(null===(t=M.current)||void 0===t?void 0:t.to)!==x.timerange.to)&&(M.current=x.timerange,a(m.b.deleteOneQuery({inputId:u,id:y})))}),[a,y,C,u,x.timerange]),Object(r.useEffect)((()=>{_||setTimeout((()=>{a(m.b.setQuery({inputId:u,id:y,searchSessionId:S.current.start(),refetch:P?w:k,loading:!1,inspect:null}))}),200)}),[a,u,y,S,P,w,_,k]),Object(r.useEffect)((()=>()=>{a(m.b.deleteOneQuery({inputId:u,id:y}))}),[a,y,u]),(x.getLensAttributes||x.lensAttributes)&&x.timerange?h?s.a.createElement(p.b,{isChartEmbeddablesEnabled:!0,dataExists:P,label:j,title:A?s.a.createElement(c.a,{count:null===(z=A[0])||void 0===z||null===(L=z.hits)||void 0===L?void 0:L.total}):null,donutTextWrapperClassName:O,donutTextWrapperStyles:R},s.a.createElement(D,i()({},x,{id:y,onLoad:N}))):s.a.createElement(D,i()({},x,{id:y,onLoad:N})):null;var z,L},N=s.a.memo(R)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),i=n.n(a),r=n(41),s=n.n(r),o=n(19),l=n(47),u=n(118),c=n(42);const d=({handleClick:e})=>i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),m=i.a.memo(d);var p=n(716);const f=s.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),b=({agentId:e,defaultValues:t,onClose:n,ecsData:r})=>{const{euiTheme:s}=Object(o.useEuiTheme)(),c=Object(a.useMemo)((()=>({style:`z-index: ${s.levels.flyout+3}`})),[s.levels.flyout]),{services:{osquery:d}}=Object(u.j)(),b=Object(l.useQueryClient)(),g=Object(a.useCallback)((()=>{var e;b.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,b]),v=Object(o.useGeneratedHtmlId)({prefix:"osqueryFlyoutTitle"});return null!=d&&d.OsqueryAction?i.a.createElement(o.EuiFlyout,{size:"m",onClose:n,"aria-labelledby":v,maskProps:c},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h2",{id:v},p.a))),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(f,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(d.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:r,onSuccess:g}))),i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(m,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},g=i.a.memo(b)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),i=n.n(a),r=n(19),s=n(2),o=n.n(s),l=n(41);const u=n.n(l)()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-tln1ed-0"})(["align-self:center;max-width:60em;"]);u.displayName="EmptyPrompt";const c=o.a.memo((({actions:e,message:t,title:n,...a})=>{const l=Object.keys(e),c=Object(s.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:n,url:a,descriptionTitle:i,description:s,onClick:u,fill:c=!0},d)=>null!=i||null!=s?o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},o.a.createElement(r.EuiCard,{title:null!=i&&i,description:null!=s&&s,footer:o.a.createElement(r.EuiButton,{href:a,onClick:u,iconType:e,target:n,fill:c,"data-test-subj":`empty-page-${l[d]}-action`},t)})):o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},o.a.createElement(r.EuiButton,{href:a,onClick:u,iconType:e,target:n,"data-test-subj":`empty-page-${l[d]}-action`},t))))),[e,l]);return o.a.createElement(u,i()({iconType:"logoSecurity",title:o.a.createElement(r.EuiText,null,o.a.createElement("h2",null,n)),body:t&&o.a.createElement("p",null,t),actions:o.a.createElement(r.EuiFlexGroup,{justifyContent:"center"},c)},a))}));c.displayName="EmptyPageComponent";const d=o.a.memo(c);d.displayName="EmptyPage"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(48),i=n(5),r=n(127);const s=[i.d,i.C,`${i.Cc}/id/:id`,i.Ib,i.bd,i.ac,i.ic],o=[i.d,`${i.Cc}/id/:id`,`${i.x}/:detailName`],l=e=>null==Object(a.matchPath)(e,{path:o,strict:!1})?r.SourcererScopeName.default:r.SourcererScopeName.detections,u=e=>null!=Object(a.matchPath)(e,{path:s,strict:!1})},function(e,t,n){"use strict";var a=n(1e3),i={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,r,s,o,l,u,c=!1;t||(t={}),n=t.debug||!1;try{if(s=a(),o=document.createRange(),l=document.getSelection(),(u=document.createElement("span")).textContent=e,u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),void 0===a.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=i[t.format]||i.default;window.clipboardData.setData(r,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(u),o.selectNodeContents(u),l.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");c=!0}catch(a){n&&console.error("unable to copy using execCommand: ",a),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),c=!0}catch(a){n&&console.error("unable to copy using clipboardData: ",a),n&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(o):l.removeAllRanges()),u&&document.body.removeChild(u),s()}return c}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(11),r=n(118);const s=()=>{const e=Object(r.j)(),{http:t}=e.services,[n,s]=Object(a.useState)(Object(i.createSavedQueryService)(t));return Object(a.useEffect)((()=>{s(Object(i.createSavedQueryService)(t))}),[t]),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n(404).NetworkType.details;let a=function(e){return e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(41),s=n.n(r),o=n(19),l=n(157),u=n(481);const c=s()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:r,bottomRightContent:s,includePlugins:d},m)=>{const{isInvalid:p,errorMessage:f}=Object(l.k)(t),[b,g]=Object(a.useState)(!1);return i.a.createElement(o.EuiFormRow,{"data-test-subj":n,describedByIds:r?[r]:void 0,error:f,fullWidth:!0,helpText:t.helpText,isInvalid:p||b,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{ref:m,ariaLabel:r,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`,setIsMarkdownInvalid:g,includePlugins:d}),s&&i.a.createElement(c,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},s))))})));d.displayName="MarkdownEditorForm"},function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f}));var a=n(68);let i=function(e){return e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout",e.urlChanged="urlChanged",e}({});const r=Object(a.createAction)(i.openFlyout),s=Object(a.createAction)(i.openRightPanel),o=Object(a.createAction)(i.openLeftPanel),l=Object(a.createAction)(i.openPreviewPanel),u=Object(a.createAction)(i.closeFlyout),c=Object(a.createAction)(i.closeRightPanel),d=Object(a.createAction)(i.closeLeftPanel),m=Object(a.createAction)(i.closePreviewPanel),p=Object(a.createAction)(i.previousPreviewPanel),f=Object(a.createAction)(i.urlChanged)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var a=n(19),i=n(2),r=n.n(i),s=n(559);const o="exit-full-screen",l=({fullScreen:e,setFullScreen:t})=>{const n=Object(i.useCallback)((()=>{t(!1)}),[t]),l=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:l}),r.a.createElement(a.EuiButton,{className:o,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:n},s.a)):null};l.displayName="ExitFullScreenComponent";const u=r.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events",e}({})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(5);const i=`${a.Lb}/fleet/integrations/all`,r=`${a.Lb}/fleet/integrations/installed`},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return h}));var a=n(2),i=n.n(a),r=n(78),s=n(242),o=n(65),l=n(36),u=n(118),c=n(267),d=n(393),m=n(66),p=n(194);let f=function(e){return e.addToExistingCase="addToExistingCase",e.addToNewCase="addToNewCase",e.inspect="inspect",e.openInLens="openInLens",e.saveToLibrary="saveToLibrary",e}({});const b=[f.inspect,f.addToNewCase,f.addToExistingCase,f.saveToLibrary,f.openInLens],g=[f.inspect],v={id:"VISUALIZATION_CONTEXT_MENU_TRIGGER"},y={[f.inspect]:{id:f.inspect,getDisplayName:()=>c.k,getIconType:()=>"inspect",type:"actionButton",order:4},[f.addToNewCase]:{id:f.addToNewCase,getDisplayName:()=>c.d,getIconType:()=>"casesApp",type:"actionButton",order:3},[f.addToExistingCase]:{id:f.addToExistingCase,getDisplayName:()=>c.c,getIconType:()=>"casesApp",type:"actionButton",order:2},[f.saveToLibrary]:{id:f.saveToLibrary,getDisplayName:()=>c.a,getIconType:()=>"save",type:"actionButton",order:1},[f.openInLens]:{id:f.openInLens,getDisplayName:()=>c.m,getIconType:()=>"visArea",type:"actionButton",order:0}},h=({attributes:e,lensMetadata:t,extraActions:n,inspectActionProps:g,timeRange:v,withActions:h=b})=>{const{services:j}=Object(s.c)(),{lens:{navigateToPrefilledEditor:O,canUseEditor:E}}=j,x=Object(a.useCallback)((()=>{v&&e&&O({id:"",timeRange:v,attributes:e},{openInNewTab:!0})}),[e,O,v]),{disabled:S,onAddToExistingCaseClicked:w}=(({onAddToCaseClicked:e,lensAttributes:t,timeRange:n,lensMetadata:i})=>{const{cases:r}=Object(u.j)().services,s=r.helpers.canUseCases([l.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:n,metadata:i},persistableStateAttachmentTypeId:o.LENS_ATTACHMENT_TYPE,type:o.AttachmentType.persistableState}]),[t,i,n]),{open:m}=r.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:c.b}});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),m({getAttachments:()=>d})}),[d,e,m]),disabled:null==t||null==n||!s.create||!s.read}})({lensAttributes:e,timeRange:v,lensMetadata:t}),{onAddToNewCaseClicked:k,disabled:C}=(({onClick:e,timeRange:t,lensAttributes:n,lensMetadata:i})=>{const{cases:r}=Object(u.j)().services,s=r.helpers.canUseCases([l.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:n,timeRange:t,metadata:i},persistableStateAttachmentTypeId:o.LENS_ATTACHMENT_TYPE,type:o.AttachmentType.persistableState}]),[n,i,t]),{open:m}=r.hooks.useCasesAddToNewCaseFlyout({toastContent:c.b});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),m({attachments:d})}),[d,m,e]),disabled:null==n||null==t||!s.create||!s.read}})({timeRange:v,lensAttributes:e,lensMetadata:t}),{openSaveVisualizationFlyout:T,disableVisualizations:M}=(({attributes:e})=>{const t=Object(u.j)().services,{SaveModalComponent:n,canUseEditor:r}=t.lens,s=Object(p.m)(),{redirectTo:o,getEditOrCreateDashboardPath:c}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(u.k)(),n=Object(a.useMemo)((()=>`${e({deepLinkId:l.SecurityPageName.dashboards})}`),[e]),i=Object(a.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),r=Object(a.useCallback)((t=>`${e({deepLinkId:l.SecurityPageName.dashboards,path:i(t)})}`),[i,e]);return{redirectTo:Object(a.useCallback)((e=>{"listing"===e.destination&&t({url:n}),"dashboard"===e.destination&&t({url:r(e.id)})}),[n,r,t]),getEditOrCreateDashboardPath:i,getEditOrCreateDashboardUrl:r,dashboardListingUrl:n}})({getSecuritySolutionUrl:s});return{openSaveVisualizationFlyout:Object(a.useCallback)((()=>{const a=document.createElement("div");Object(d.a)(i.a.createElement(n,{initialInput:e,onSave:()=>Object(m.unmountComponentAtNode)(a),onClose:()=>Object(m.unmountComponentAtNode)(a),originatingApp:l.APP_UI_ID,getOriginatingPath:e=>`${l.SecurityPageName.dashboards}/${c(e)}`,redirectTo:o}),t)(a)}),[n,e,c,o,t]),disableVisualizations:Object(a.useMemo)((()=>!r()||null==e),[e,r])}})({attributes:e});return Object(a.useMemo)((()=>[Object(r.createAction)({...y[f.inspect],execute:async()=>{g.handleInspectClick()},disabled:g.isInspectButtonDisabled,isCompatible:async()=>h.includes(f.inspect)}),Object(r.createAction)({...y[f.addToNewCase],execute:async()=>{k()},disabled:C,isCompatible:async()=>h.includes(f.addToNewCase)}),Object(r.createAction)({...y[f.addToExistingCase],execute:async()=>{w()},disabled:S,isCompatible:async()=>h.includes(f.addToExistingCase),order:2}),Object(r.createAction)({...y[f.saveToLibrary],execute:async()=>{T()},disabled:M,isCompatible:async()=>h.includes(f.saveToLibrary),order:1}),Object(r.createAction)({...y[f.openInLens],execute:async()=>{x()},isCompatible:async()=>E()&&h.includes(f.openInLens),order:0}),...null!=n?n:[]].map(((e,t,n)=>({...e,order:Math.max(n.length-(1+t),0)})))),[E,M,n,g,S,C,w,k,x,T,h])}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(19),i=n(54),r=n.n(i),s=n(2),o=n.n(s),l=n(41),u=n.n(l),c=n(50),d=n(430),m=n(196);d.f;const p=u.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);p.displayName="TitleText",o.a.memo((({noteIds:e})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiTitle,{size:"s"},o.a.createElement(p,null,d.e))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(m.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e,user:t})=>({created:r.a.utc().toDate(),id:Object(c.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),b=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a,user:i})=>{const r=f({newNote:t,user:i});a(r),e(r.id),n("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importStar(n(2)),r=n(2),s=a.__importDefault(n(327)),o=a.__importDefault(n(991));t.default=function(e){return function(t){var n,l;l=i.isValidElement(t)?(n=t).props:t;var u=s.default({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1}),c=u[0],d=u[1],m=r.useRef(null),p=function(e,t){return function(n){try{t&&t(n)}finally{e&&e(n)}}},f=function(){return d({paused:!1})},b=function(){return d({paused:!0})},g=function(){var e=m.current;e&&d({muted:e.muted,volume:e.volume})},v=function(){var e=m.current;if(e){var t=e.duration,n=e.buffered;d({duration:t,buffered:o.default(n)})}},y=function(){var e=m.current;e&&d({time:e.currentTime})},h=function(){var e=m.current;e&&d({buffered:o.default(e.buffered)})};n=n?i.cloneElement(n,a.__assign(a.__assign({controls:!1},l),{ref:m,onPlay:p(l.onPlay,f),onPause:p(l.onPause,b),onVolumeChange:p(l.onVolumeChange,g),onDurationChange:p(l.onDurationChange,v),onTimeUpdate:p(l.onTimeUpdate,y),onProgress:p(l.onProgress,h)})):i.createElement(e,a.__assign(a.__assign({controls:!1},l),{ref:m,onPlay:p(l.onPlay,f),onPause:p(l.onPause,b),onVolumeChange:p(l.onVolumeChange,g),onDurationChange:p(l.onDurationChange,v),onTimeUpdate:p(l.onTimeUpdate,y),onProgress:p(l.onProgress,h)}));var j=!1,O={play:function(){var e=m.current;if(e&&!j){var t=e.play();if("object"==typeof t){j=!0;var n=function(){j=!1};t.then(n,n)}return t}},pause:function(){var e=m.current;if(e&&!j)return e.pause()},seek:function(e){var t=m.current;t&&void 0!==c.duration&&(e=Math.min(c.duration,Math.max(0,e)),t.currentTime=e)},volume:function(e){var t=m.current;t&&(e=Math.min(1,Math.max(0,e)),t.volume=e,d({volume:e}))},mute:function(){var e=m.current;e&&(e.muted=!0)},unmute:function(){var e=m.current;e&&(e.muted=!1)}};return r.useEffect((function(){var e=m.current;e&&(d({volume:e.volume,muted:e.muted,paused:e.paused}),l.autoPlay&&e.paused&&O.play())}),[l.src]),[n,c,O,m]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return"boolean"==typeof t?t:!e};t.default=function(e){return a.useReducer(i,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(638)),s=n(372);t.default=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=null),void 0===n&&(n=null);var a=s.resolveHookState(e);"number"!=typeof a&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof n?a=Math.max(a,n):null!==n&&console.error("min has to be a number, got "+typeof n),"number"==typeof t?a=Math.min(a,t):null!==t&&console.error("max has to be a number, got "+typeof t);var o=r.default(a),l=o[0],u=o[1];return[l(),i.useMemo((function(){var e=function(e){var a=l(),i=s.resolveHookState(e,a);a!==i&&("number"==typeof n&&(i=Math.max(i,n)),"number"==typeof t&&(i=Math.min(i,t)),a!==i&&u(i))};return{get:l,set:e,inc:function(t){void 0===t&&(t=1);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e+n}))},dec:function(t){void 0===t&&(t=1);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e-n}))},reset:function(t){void 0===t&&(t=a);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("value has to be a number or function returning a number, got "+typeof n),a=n,e(n)}}}),[a,n,t])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(280)),s=n(372);t.default=function(e){var t=i.useRef(s.resolveHookState(e)),n=r.default();return i.useMemo((function(){return[function(){return t.current},function(e){t.current=s.resolveHookState(e,t.current),n()}]}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useState(!1),i=n[0],r=n[1];return a.useEffect((function(){var n=function(){return r(!0)},a=function(){return r(!1)};t&&e&&e.current&&(e.current.addEventListener("mouseover",n),e.current.addEventListener("mouseout",a));var i=e.current;return function(){t&&i&&(i.removeEventListener("mouseover",n),i.removeEventListener("mouseout",a))}}),[t,e]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(557)),s=function(){};t.default=function(e,t,n,a){void 0===t&&(t=s),void 0===n&&(n={}),void 0===a&&(a=[e]);var o=n.event,l=void 0===o?"keydown":o,u=n.target,c=n.options,d=i.useMemo((function(){var n,a="function"==typeof(n=e)?n:"string"==typeof n?function(e){return e.key===n}:n?function(){return!0}:function(){return!1};return function(e){if(a(e))return t(e)}}),a);r.default(l,d,u,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(640));t.default=function(e){var t=i.useState([!1,null]),n=t[0],a=t[1];return r.default(e,(function(e){return a([!0,e])}),{event:"keydown"},[n]),r.default(e,(function(e){return a([!1,e])}),{event:"keyup"},[n]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef(e);return t.current=e,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){a.useEffect((function(){return e&&e(),function(){t&&t()}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(280)),s=n(372);t.default=function(e){void 0===e&&(e=[]);var t=i.useRef(s.resolveHookState(e)),n=r.default(),a=i.useMemo((function(){var i={set:function(e){t.current=s.resolveHookState(e,t.current),n()},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length&&a.set((function(t){return t.concat(e)}))},updateAt:function(e,t){a.set((function(n){var a=n.slice();return a[e]=t,a}))},insertAt:function(e,t){a.set((function(n){var a=n.slice();return e>a.length?a[e]=t:a.splice(e,0,t),a}))},update:function(e,t){a.set((function(n){return n.map((function(n){return e(n,t)?t:n}))}))},updateFirst:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0&&a.updateAt(i,n)},upsert:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0?a.updateAt(i,n):a.push(n)},sort:function(e){a.set((function(t){return t.slice().sort(e)}))},filter:function(e,t){a.set((function(n){return n.slice().filter(e,t)}))},removeAt:function(e){a.set((function(t){var n=t.slice();return n.splice(e,1),n}))},clear:function(){a.set([])},reset:function(){a.set(s.resolveHookState(e).slice())}};return i.remove=i.removeAt,i}),[]);return[t.current,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(){};t.default=function(e,t,n){if(!i.isClient)return[t,r,r];if(!e)throw new Error("useLocalStorage key may not be falsy");var s=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,o=a.useState((function(){try{var a=n?n.raw?String:n.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?s(i):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),l=o[0],u=o[1],c=a.useCallback((function(t){try{var a="function"==typeof t?t(l):t;if(void 0===a)return;var i;i=n?n.raw?"string"==typeof a?a:JSON.stringify(a):n.serializer?n.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,i),u(s(i))}catch(e){}}),[e,u]),d=a.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[l,c,d]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(328));t.default=function(e){a.default((function(){e()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(329));t.default=function(e){var t=r.default({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(t){if(e&&e.current){var n=e.current.getBoundingClientRect(),i=n.left,r=n.top,s=n.width,o=n.height,l=i+window.pageXOffset,u=r+window.pageYOffset,c=t.pageX-l,d=t.pageY-u;a({docX:t.pageX,docY:t.pageY,posX:l,posY:u,elX:c,elY:d,elH:o,elW:s})}};return document.addEventListener("mousemove",t),function(){document.removeEventListener("mousemove",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(37));t.default=function(e,t){void 0===e&&(e=1e12),void 0===t&&(t=0);var n=i.useState(0),a=n[0],s=n[1];return r.default((function(){var n,a,i,r=function(){var t=Math.min(1,(Date.now()-i)/e);s(t),o()},o=function(){n=requestAnimationFrame(r)},l=setTimeout((function(){a=setTimeout((function(){cancelAnimationFrame(n),s(1)}),e),i=Date.now(),o()}),t);return function(){clearTimeout(a),clearTimeout(l),cancelAnimationFrame(n)}}),[e,t]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=parseInt(i.version.substr(0,i.version.indexOf(".")))>15;t.default=function(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var o=e.render,l=e.children,u=void 0===l?o:l,c=e.component,d=e.comp,m=void 0===d?c:d;return"function"==typeof u?u.apply(void 0,a.__spreadArrays([t],n)):m?i.createElement(m,t):u instanceof Array?r?u:i.createElement.apply(void 0,a.__spreadArrays(["div",null],u)):u&&u instanceof Object?"string"==typeof u.type?u:i.cloneElement(u,Object.assign({},u.props,t)):u||null}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"k",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return f}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),u=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),c=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),f=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"i",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return y}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),r=a.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),s=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),o=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),l=a.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),u=a.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),c=a.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),m=a.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),p=a.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),f=a.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),b=a.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),g=a.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),v=a.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),y=a.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},function(e,t,n){"use strict";e.exports=n(1085)},function(e,t,n){"use strict";e.exports=n(1086)},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1094);case"v8light":return n(1096)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(701);function i(e){return{type:Object(a.a)(e),scripted:e.scripted}}},function(e,t,n){const a=n(283);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(41),s=n.n(r),o=n(191);const l=s.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(r.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),o.d,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),o.d,o.d,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(r.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const u=i.a.memo(l);u.displayName="ProviderContainer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(5),r=n(584),s=n(132),o=n(124),l=n(148),u=n(127),c=n(246),d=n(282);const m=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraOptions:n,getLensAttributes:m,lensAttributes:p,scopeId:f=u.SourcererScopeName.default,stackByField:b,title:g})=>{var v,y;const{selectedPatterns:h,dataViewId:j,indicesExist:O}=Object(s.a)(f),E=Object(a.useMemo)((()=>l.d.globalQuerySelector()),[]),x=Object(a.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),S=Object(o.a)(E),w=Object(o.a)(x),[{detailName:k,pageName:C,tabName:T}]=Object(c.a)(),M=Object(a.useMemo)((()=>T===r.a.events?C===i.Oc.network?d.h:Object(d.b)(C):[]),[C,T]),I=Object(a.useMemo)((()=>[i.Oc.hosts,i.Oc.users].indexOf(C)>=0&&null!=k?Object(d.c)(C,k):i.Oc.network===C?Object(d.e)(k):[]),[k,C]),_=Object(a.useMemo)((()=>null!=p?p:m&&b&&m(b,n)),[n,m,p,b]),A=Object.values(null!==(v=null==_||null===(y=_.state)||void 0===y?void 0:y.adHocDataViews)&&void 0!==v?v:{}).length>0,P=Object(a.useMemo)((()=>{var n;if(null==p&&(null==m||null==b||0===(null==b?void 0:b.length)))return null;const a=A?[]:Object(d.d)(h);return{..._,...null!=g?{title:g}:{},state:{..._.state,...e?{query:S}:{},filters:[..._.state.filters,...t?I:[],...t?M:[],...a,...e?w:[]]},references:null==_||null===(n=_.references)||void 0===n?void 0:n.map((e=>({...e,id:j})))}}),[e,t,_,j,w,m,A,p,I,S,h,b,M,g]);return A||!A&&O?P:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(120),i=n(820);const r=a.z.literal("PROMPT_FIELD_NOT_MODIFIED"),s=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:r}),o=a.z.object({id:a.z.string(),name:a.z.string().optional()}),l=a.z.enum(["system","quick"]),u=l.enum,c=a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:a.z.string().optional(),prompts:a.z.array(o)}),d=a.z.object({id:i.a,timestamp:i.a.optional(),name:a.z.string(),promptType:l,content:a.z.string(),categories:a.z.array(a.z.string()).optional(),color:a.z.string().optional(),isNewConversationDefault:a.z.boolean().optional(),isDefault:a.z.boolean().optional(),consumer:a.z.string().optional(),updatedAt:a.z.string().optional(),updatedBy:a.z.string().optional(),createdAt:a.z.string().optional(),createdBy:a.z.string().optional(),users:a.z.array(i.b).optional(),namespace:a.z.string().optional()}),m=a.z.object({updated:a.z.array(d),created:a.z.array(d),deleted:a.z.array(a.z.string()),skipped:a.z.array(s)}),p=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),f=(a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),prompts_count:a.z.number().int().optional(),attributes:a.z.object({results:m,summary:p,errors:a.z.array(c).optional()})}),a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()})),b=a.z.object({name:a.z.string(),promptType:l,content:a.z.string(),color:a.z.string().optional(),categories:a.z.array(a.z.string()).optional(),isNewConversationDefault:a.z.boolean().optional(),isDefault:a.z.boolean().optional(),consumer:a.z.string().optional()}),g=a.z.object({id:a.z.string(),content:a.z.string().optional(),color:a.z.string().optional(),categories:a.z.array(a.z.string()).optional(),isNewConversationDefault:a.z.boolean().optional(),isDefault:a.z.boolean().optional(),consumer:a.z.string().optional()});a.z.object({delete:f.optional(),create:a.z.array(b).optional(),update:a.z.array(g).optional()})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return _e})),n.d(t,"c",(function(){return Ae})),n.d(t,"b",(function(){return Pe})),n.d(t,"d",(function(){return De}));var a=n(19),i=n(954),r=n(477),s=n(2),o=n.n(s),l=n(7),u=n(42),c=n(4),d=n(119),m=n.n(d);const p=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:i},fieldState:{error:l}}=Object(r.useController)({name:"label",defaultValue:""}),u=Object(s.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return o.a.createElement(a.EuiFormRow,{label:c.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==l?void 0:l.message,isInvalid:u,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({isInvalid:u,onChange:t,value:n,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},f=o.a.memo(p),b=c.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),g=()=>o.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,b),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(a.EuiCode,null,"osquery")}}))});var v=n(118);const y=({node:e,onSave:t,onCancel:n})=>{var i,d,m;const p=null!=e,{osquery:b,application:{capabilities:{osquery:y}}}=Object(v.j)().services,h=Object(r.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(m=e.configuration)||void 0===m?void 0:m.ecs_mapping}}),j=Object(s.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(l.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t]),O=Object(s.useMemo)((()=>!(y.runSavedQueries&&y.readSavedQueries||y.writeLiveQueries)),[y.readSavedQueries,y.runSavedQueries,y.writeLiveQueries]),E=Object(s.useMemo)((()=>{if(null!=b&&b.LiveQueryField){const{LiveQueryField:e}=b;return o.a.createElement(r.FormProvider,h,o.a.createElement(f,null),o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(e,{formMethods:h}))}return null}),[h,b]);return O?o.a.createElement(g,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement("h1",null,p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),o.a.createElement(a.EuiModalBody,null,o.a.createElement(o.a.Fragment,null,E)),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},c.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),o.a.createElement(a.EuiButton,{onClick:h.handleSubmit(j),fill:!0},p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},h=o.a.memo(y);var j=n(478),O=n(41),E=n.n(O),x=n(208),S=n(394),w=n(262),k=n(1087),C=n.n(k),T=n(571);const M=E()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var I=n(54),_=n.n(I),A=n(60),P=n.n(A),D=(n(43),n(53)),F=n(123),R=n(55),N=n(1484),z=n(146),L=n(250),B=n(717),q=n(132),V=n(127);const $=["*"],U={};var G=n(121),H=n(179);const Q=e=>e===D.FILTERS.EXISTS?H.b:e===D.FILTERS.PHRASES?H.c:H.d,W={$state:{store:D.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},K={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:G.a.default,queryMatch:{field:"",value:"",operator:H.b}},J=e=>{const t={...W,meta:{...W.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===D.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===D.FILTERS.PHRASES){var n;let a=JSON.parse(String(e.value));return"number"===e.valueType?a=a.map(Number):"boolean"===e.valueType&&(a=a.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(n=a)||void 0===n?void 0:n.map((t=>({match_phrase:{[e.field]:t}})))}}}}var a;if(e.queryType===D.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(a=e.value)&&void 0!==a?a:""}}};if(e.queryType===D.FILTERS.RANGE){let n,a;try{const t=JSON.parse(String(e.value));n=t.gte,a=t.lt}catch{n="",a=""}const i={gte:n,lt:a};return{...t,meta:{...t.meta,params:i},query:{range:{[e.field]:i}}}}return t},Y=({providers:e,alertData:t})=>{const n=Object(s.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(s.useMemo)((()=>n?[]:((e,t)=>e.map((e=>e.reduce(((e,n,a)=>{const{field:i,value:r,excluded:s,queryType:o}=n,{result:u,matchedBrackets:c}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const n=/\{{([^}]+)\}}/g,a=e.match(new RegExp(n));let i=e;a&&t&&Object(l.each)(a,(e=>{const n=e.replace(/{{|}}/g,"").trim();if(i.includes(e)){const a=t.find((({field:e})=>e===n));if(a&&a.values){const{values:[t]}=a;i=i.replace(e,t)}}}));const r=new RegExp(n).test(i);return{result:i,skipped:r,matchedBrackets:a}})(r,t),d=!t&&c;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?G.a.template:G.a.default,queryMatch:{field:i,value:u,operator:Q(o)}};{const t={enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?G.a.template:G.a.default,queryMatch:{field:i,value:u,operator:Q(o)}};e.and.push(t)}return e}),K))))(e,t)),[t,e,n]),filters:Object(s.useMemo)((()=>n?((e,t)=>{const n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.length>1){const e=a.map((e=>J(e))),t={$state:{store:D.FilterStateStore.APP_STATE},meta:{type:D.FILTERS.COMBINED,relation:D.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};n.push(t)}else{const e=a[0],t=J(e);n.push(t)}}return n})(e):[]),[n,e,t])}};var X=n(263),Z=n(396),ee=n(5);const te=e=>{var t,n,a,i,r,s;const o=null!==(t=null===(n=e.meta)||void 0===n?void 0:n.key)&&void 0!==t?t:"",l={field:o,excluded:null!==(a=null===(i=e.meta)||void 0===i?void 0:i.negate)&&void 0!==a&&a,queryType:null!==(r=null===(s=e.meta)||void 0===s?void 0:s.type)&&void 0!==r?r:D.FILTERS.PHRASE};if(Object(D.isRangeFilter)(e)){var u;const{gte:t,lt:n}=e.query.range[o],a=JSON.stringify({gte:t,lt:n});return{...l,value:a,queryType:null!==(u=e.meta.type)&&void 0!==u?u:D.FILTERS.RANGE}}if(Object(D.isPhrasesFilter)(e)){var c,d,m,p;const t=typeof(null===(c=e.meta)||void 0===c?void 0:c.params[0]);return{...l,value:JSON.stringify(null!==(d=null===(m=e.meta)||void 0===m?void 0:m.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(p=e.meta.type)&&void 0!==p?p:D.FILTERS.PHRASES}}var f;if(Object(D.isExistsFilter)(e))return{...l,value:"",queryType:null!==(f=e.meta.type)&&void 0!==f?f:D.FILTERS.EXISTS};if(Object(D.isPhraseFilter)(e)){var b,g,v,y,h,j;const t=typeof(null===(b=e.meta)||void 0===b||null===(g=b.params)||void 0===g?void 0:g.query);return{...l,value:null!==(v=null===(y=e.meta)||void 0===y||null===(h=y.params)||void 0===h?void 0:h.query)&&void 0!==v?v:"",valueType:t,queryType:null!==(j=e.meta.type)&&void 0!==j?j:D.FILTERS.PHRASE}}return{...l,value:"",queryType:D.FILTERS.PHRASE}},ne=e=>e.map((e=>te(e))),ae=e=>!1===e.some(D.isCombinedFilter)?[ne(e)]:e.reduce(((e,t)=>{if(Object(D.isCombinedFilter)(t)){const n=t.meta.params;if(t.meta.relation===D.BooleanRelation.OR){const t=n.map((e=>{const t=ae([e]);return Object(l.flatten)(t)}));return[...e,...t]}{const t=ae(n);return[...e,...t]}}return[...e,[te(t)]]}),[]);var ie=n(16),re=n(63),se=n.n(re),oe=n(656),le=n.n(oe),ue=n(233);function ce(e,t,n){var a;if(void 0===t||"undefined"===n)return!1;switch(e.type){case"date":const n="string"==typeof t?se.a.parse(t):null;return Boolean("string"==typeof t&&n&&n.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new R.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(a=e.esTypes)&&void 0!==a&&a.includes(ue.a.VERSION)?Boolean(le()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const de=c.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),me=c.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),pe=c.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),fe=c.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),be=c.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),ge=c.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),ve=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),ye=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),he=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),je=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),Oe=c.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),Ee=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"});var xe=n(766);const Se="!{investigate",we=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>{const{addError:l}=Object(F.a)();let u=[];try{void 0!==n&&(u=JSON.parse(n))}catch(e){l(e,{title:Ee})}const{data:c,timestamp:d}=Object(s.useContext)(S.a),{dataProviders:m,filters:p}=Y({providers:u,alertData:c}),f=Object(s.useMemo)((()=>{if(i&&r){const e=d?_()(d):_()();return{kind:"absolute",from:Object(Z.e)(i,Z.a,!1,_.a,e.toDate()).toISOString(),to:Object(Z.e)(r,Z.b,!0,_.a,e.toDate()).toISOString()}}return null}),[i,r,d]),{totalCount:b,isQueryLoading:g,oldestTimestamp:y,hasError:h}=(({dataProviders:e,filters:t,relativeTimerange:n})=>{const{uiSettings:a}=Object(v.j)().services,i=Object(s.useMemo)((()=>Object(R.getEsQueryConfig)(a)),[a]),{browserFields:r,selectedPatterns:o,indexPattern:l,dataViewId:u}=Object(q.a)(V.SourcererScopeName.timeline),[c,d]=Object(s.useState)(!1),m=Object(s.useMemo)((()=>{try{if(!1===c)return Object(L.d)({config:i,dataProviders:e,indexPattern:l,browserFields:r,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[r,e,i,c,l,t]),[p,{events:f,totalCount:b}]=Object(B.a)({dataViewId:u,fields:$,filterQuery:null==m?void 0:m.filterQuery,id:z.c.active,indexNames:o,language:"kuery",limit:1,runtimeMappings:U,startDate:null==n?void 0:n.from,endDate:null==n?void 0:n.to,fetchNotes:!1}),g=Object(s.useMemo)((()=>[N.a.loading,N.a.loadingMore].includes(p)),[p]),[y]=f,h=y&&y.data&&y.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:g,totalCount:b,oldestTimestamp:h&&h.value&&h.value[0],hasError:c}})({dataProviders:m,filters:p,relativeTimerange:f}),j=Object(s.useMemo)((()=>{if(f)return f;if(null!=y)return{kind:"absolute",from:y,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(Z.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[y,f]);return g?o.a.createElement(a.EuiLoadingSpinner,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(X.a,{asEmptyButton:!1,isDisabled:h,dataProviders:m,filters:p,timeRange:j,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},o.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${P()(b).format("0,0.[000]a")})`),o.a.createElement("div",null,t))},ke=({node:e,onSave:t,onCancel:n})=>{const i=null!=e,{indexPattern:c}=Object(q.a)(V.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:d}},uiSettings:p}=Object(v.j)().services,f=Object(xe.a)({sourcererScope:V.SourcererScopeName.default}),[b,g]=Object(s.useState)([[]]),y=Object(s.useMemo)((()=>[{value:"0",text:""},...p.get(ee.db).map((({display:e},t)=>({value:String(t),text:e})))]),[p]),h=Object(r.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),j=Object(r.useController)({name:"label",control:h.control}),O=Object(r.useController)({name:"description",control:h.control}),E=Object(r.useController)({name:"relativeTimerange",control:h.control}),x=Object(s.useCallback)((e=>{const t=y.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),n=p.get(ee.db);return{relativeFrom:n[e].from,relativeTo:n[e].to}}return{}}),[y,p]),S=Object(s.useCallback)((()=>{t(`${Se}${JSON.stringify(Object(l.pickBy)({label:j.field.value,description:O.field.value,providers:b,...x(E.field.value)},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t,b,j.field.value,O.field.value,E.field.value,x]),w=Object(s.useCallback)((e=>{g(ae(e))}),[]),k=Object(s.useCallback)((e=>{E.field.onChange(e.target.value)}),[E.field]),C=Object(s.useMemo)((()=>{var e;const t=null!==(e=j.field.value)&&void 0!==e?e:"",n=b.flat();return""===t.trim()||0===n.length||n.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return ce(t,e.value,e.valueType);case"phrases":const n="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(n)||!n.length)&&n.every((n=>ce(t,n,e.valueType)));case"range":const a=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof a&&(!a.gte||ce(t,a.gte,e.valueType))&&(!a.lt||ce(t,a.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==f?void 0:f.getFieldByName(e.field))))}),[j.field.value,b,f]),T=Object(s.useMemo)((()=>{const e=c&&c.getName?c.getName():"*";return[{$state:{store:D.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[c]),M=Object(ie.b)().isAtLeast("platinum");return o.a.createElement(o.a.Fragment,null,o.a.createElement(Me,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(a.EuiFlexItem,null,i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===M&&o.a.createElement(a.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),o.a.createElement(a.EuiModalBody,null,o.a.createElement(r.FormProvider,h,o.a.createElement(a.EuiForm,{fullWidth:!0},o.a.createElement(a.EuiFormRow,{label:ge,fullWidth:!0},o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:de,helpText:pe,isInvalid:void 0!==j.field.value&&0===j.field.value.trim().length,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},h.register("label"),{ref:null,name:"label",onChange:j.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:fe,helpText:be,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},h.register("description"),{ref:null,name:"description",onChange:O.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:ve,helpText:ye,fullWidth:!0},f?o.a.createElement(d,{filters:T,onChange:w,dataView:f,maxDepth:1}):o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:he,helpText:je,fullWidth:!0},o.a.createElement(a.EuiSelect,m()({},h.register("relativeTimerange"),{ref:null,onChange:k,options:y})))))),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},Oe),o.a.createElement(a.EuiButton,{onClick:h.handleSubmit(S),fill:!0,disabled:C},i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Ce=o.a.memo(ke),Te=`${Se}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var Me=E()(a.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Ie=Object(a.getDefaultEuiMarkdownUiPlugins)(),_e=Object(a.getDefaultEuiMarkdownParsingPlugins)(),Ae=Object(a.getDefaultEuiMarkdownProcessingPlugins)(),Pe=[Se],De=({insightsUpsellingMessage:e,interactionsUpsellingMessage:t})=>{const n=Ie.map((e=>e.name)),r=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:me,iconType:"timelineWithArrow",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},Te),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:Ce}))({insightsUpsellingMessage:e}),s=i.b({interactionsUpsellingMessage:t}),l=(({interactionsUpsellingMessage:e})=>({name:"osquery",button:{label:null!=e?e:"Osquery",iconType:"logoOsquery",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:h}))({interactionsUpsellingMessage:t});if(!1===n.includes(r.name))Ie.push(s),Ie.push(l),Ie.push(r);else{const e=Ie.findIndex((e=>e.name===r.name));Ie[e]=r}return Ie};_e.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){if(!1===t.startsWith(Se))return!1;const a=t[13];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i={};if("{"===a){let n="",a=0;for(let e=13;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}try{return i=JSON.parse(n),e(t)({type:"insight",...i,providers:JSON.stringify(i.providers)})}catch(t){const n=e.now();this.file.fail((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:n.line,column:n.column+13})}}return!1};a.locator=(e,t)=>e.indexOf(Se,t),t.insight=a,n.splice(n.indexOf("text"),0,"insight")})),_e.push(i.a),_e.push(j.a),Ae[1][1].components.insight=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>{const s=Object(x.b)("investigation_guide");return s?o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiToolTip,{content:s},o.a.createElement(a.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`)),o.a.createElement("div",null,t)):o.a.createElement(we,{label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})},Ae[1][1].components.timeline=i.c,Ae[1][1].components.osquery=({configuration:e})=>{var t;const[n,i]=Object(s.useState)(!1),{agentId:r,alertId:u,data:d}=Object(s.useContext)(S.a),m=Object(s.useCallback)((()=>i(!0)),[i]),p=Object(s.useCallback)((()=>i(!1)),[i]),f=Object(x.b)("investigation_guide_interactions"),b=Object(s.useMemo)((()=>{const e=Object(l.reduce)(d,((e,t)=>{var n;return{...e,[t.field]:null==t||null===(n=t.values)||void 0===n?void 0:n[0]}}),{});return Object(w.a)(e)}),[d]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiToolTip,{content:f},o.a.createElement(M,{iconType:C.a,onClick:m,disabled:!!f},null!==(t=e.label)&&void 0!==t?t:c.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"}))),n&&o.a.createElement(T.a,{defaultValues:{...u?{alertIds:[u]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:r,onClose:p,ecsData:b}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return R})),n.d(t,"b",(function(){return N.a})),n.d(t,"e",(function(){return N.e})),n.d(t,"d",(function(){return N.d})),n.d(t,"c",(function(){return N.c})),n.d(t,"f",(function(){return N.h})),n.d(t,"g",(function(){return N.l})),n.d(t,"j",(function(){return N.r})),n.d(t,"n",(function(){return N.v})),n.d(t,"m",(function(){return N.u})),n.d(t,"l",(function(){return N.t})),n.d(t,"k",(function(){return N.s})),n.d(t,"h",(function(){return N.o})),n.d(t,"i",(function(){return N.p})),n.d(t,"r",(function(){return N.A})),n.d(t,"s",(function(){return N.B})),n.d(t,"v",(function(){return N.E})),n.d(t,"p",(function(){return N.y})),n.d(t,"t",(function(){return N.C})),n.d(t,"o",(function(){return N.x})),n.d(t,"u",(function(){return N.D})),n.d(t,"q",(function(){return N.z}));var a=n(2),i=n.n(a),r=n(19),s=n(45),o=n(151),l=n(41),u=n.n(l);const c=u.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-170nqoz-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));c.displayName="SearchRowContainer";const d=u()(r.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-170nqoz-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));d.displayName="SearchRowFlexGroup";const m=i.a.memo((()=>{const e=Object(s.useDispatch)(),t=Object(a.useMemo)((()=>({placeholder:"Search note contents",incremental:!1,"data-test-subj":"notes-search-bar"})),[]),n=Object(a.useCallback)((({queryText:t})=>{e(Object(N.y)(t.trim()))}),[e]);return i.a.createElement(c,null,i.a.createElement(d,{gutterSize:"s"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiSearchBar,{box:t,onChange:n,defaultQuery:""}))))}));m.displayName="SearchRow";var p=n(362),f=n(4);const b=f.i18n.translate("xpack.securitySolution.notes.management.batchActionsTitle",{defaultMessage:"Bulk actions"}),g=f.i18n.translate("xpack.securitySolution.notes.management.createdColumnTitle",{defaultMessage:"Created"}),v=f.i18n.translate("xpack.securitySolution.notes.management.createdByColumnTitle",{defaultMessage:"Created by"}),y=f.i18n.translate("xpack.securitySolution.notes.management.eventIdColumnTitle",{defaultMessage:"View Document"}),h=f.i18n.translate("xpack.securitySolution.notes.management.timelineColumnTitle",{defaultMessage:"Timeline"}),j=f.i18n.translate("xpack.securitySolution.notes.management.noteContentColumnTitle",{defaultMessage:"Note content"}),O=f.i18n.translate("xpack.securitySolution.notes.management.deleteAction",{defaultMessage:"Delete"}),E=f.i18n.translate("xpack.securitySolution.notes.management.deleteDescription",{defaultMessage:"Delete this note"}),x=f.i18n.translate("xpack.securitySolution.notes.management.tableError",{defaultMessage:"Unable to load notes"}),S=f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesModalTitle",{defaultMessage:"Delete notes?"}),w=f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesCancel",{defaultMessage:"Cancel"}),k=f.i18n.translate("xpack.securitySolution.notes.management.deleteSelected",{defaultMessage:"Delete selected notes"}),C=f.i18n.translate("xpack.securitySolution.notes.management.refresh",{defaultMessage:"Refresh"}),T=f.i18n.translate("xpack.securitySolution.notes.management.openTimeline",{defaultMessage:"Open timeline"}),M=f.i18n.translate("xpack.securitySolution.notes.management.viewEventInTimeline",{defaultMessage:"View event in timeline"}),I=i.a.memo((()=>{const e=Object(s.useDispatch)(),t=Object(s.useSelector)(N.r),n=Object(s.useSelector)(N.v),o=Object(s.useSelector)(N.u),l=Object(a.useMemo)((()=>{const{perPage:e,page:n,total:a}=t,i=e*(n-1)+1,r=Math.min(e*n,a);return 0===e?"All":`${i}-${r} of ${a}`}),[t]),u=Object(a.useCallback)((()=>{e(Object(N.z)())}),[e]),c=Object(s.useSelector)(N.t),d=Object(a.useCallback)((()=>i.a.createElement(r.EuiContextMenuItem,{"data-test-subj":"notes-management-delete-notes",onClick:u,disabled:0===o.length,icon:"trash",key:"DeleteItemKey"},k)),[u,o.length]),m=Object(a.useCallback)((()=>{e(Object(N.d)({page:t.page,perPage:t.perPage,sortField:n.field,sortOrder:n.direction,filter:"",search:c}))}),[e,t.page,t.perPage,n.field,n.direction,c]);return i.a.createElement(p.a,{border:!0},i.a.createElement(p.d,null,i.a.createElement(p.c,null,i.a.createElement(p.e,{"data-test-subj":"notes-management-pagination-count"},`Showing: ${l}`)),i.a.createElement(p.c,null,i.a.createElement(p.e,{"data-test-subj":"notes-management-selected-count"},o.length>0?`${o.length} selected`:""),i.a.createElement(p.b,{dataTestSubj:"notes-management-utility-bar-actions",iconSide:"right",iconType:"arrowDown",popoverContent:d},i.a.createElement("span",{"data-test-subj":"notes-management-utility-bar-action-button"},b)),i.a.createElement(p.b,{dataTestSubj:"notes-management-utility-bar-refresh-button",iconSide:"right",iconType:"refresh",onClick:m},C))))}));I.displayName="NotesUtilityBar";const _=i.a.memo((()=>{const e=Object(s.useDispatch)(),t=Object(s.useSelector)(N.s),n=Object(s.useSelector)(N.l)===N.a.Loading,o=Object(a.useCallback)((()=>{e(Object(N.x)())}),[e]),l=Object(a.useCallback)((()=>{e(Object(N.c)({ids:t,refetch:!0}))}),[e,t]);return i.a.createElement(r.EuiConfirmModal,{"aria-labelledby":"delete-notes-modal",title:S,onCancel:o,onConfirm:l,isLoading:n,cancelButtonText:w,confirmButtonText:O,buttonColor:"danger",defaultFocusedButton:"confirm"},(u=t.length,f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesConfirm",{values:{selectedNotes:u},defaultMessage:"Are you sure you want to delete {selectedNotes} {selectedNotes, plural, one {note} other {notes}}?"})));var u}));_.displayName="DeleteConfirmModal";var A=n(377);const P=Object(a.memo)((({eventId:e})=>{const t={event:{id:[e]},_id:e},{investigateInTimelineAlertClick:n}=Object(A.a)({ecsRowData:t});return i.a.createElement(r.EuiLink,{onClick:n,"data-test-subj":"open-event-in-timeline"},M)}));P.displayName="OpenEventInTimeline";const D=e=>[{field:"created",name:g,sortable:!0,render:e=>i.a.createElement(o.b,{value:e})},{field:"createdBy",name:v},{field:"eventId",name:y,sortable:!0,render:e=>i.a.createElement(P,{eventId:e})},{field:"timelineId",name:h,render:t=>t?i.a.createElement(r.EuiLink,{onClick:()=>e({timelineId:t,duplicate:!1})},T):null},{field:"note",name:j}],F=[10,25,50,100],R=({onOpenTimeline:e})=>{const t=Object(s.useDispatch)(),n=Object(s.useSelector)(N.h),o=Object(s.useSelector)(N.r),l=Object(s.useSelector)(N.v),u=Object(s.useSelector)(N.t),c=Object(s.useSelector)(N.s).length>0,d=Object(s.useSelector)(N.p),p=d===N.a.Loading,f=d===N.a.Failed,b=Object(s.useSelector)(N.o),g=Object(a.useCallback)((()=>{t(Object(N.d)({page:o.page,perPage:o.perPage,sortField:l.field,sortOrder:l.direction,filter:"",search:u}))}),[t,o.page,o.perPage,l.field,l.direction,u]);Object(a.useEffect)((()=>{g()}),[g]);const v=Object(a.useCallback)((({page:e,sort:n})=>{e&&(t(Object(N.A)(e.index+1)),t(Object(N.B)(e.size))),n&&t(Object(N.E)({field:n.field,direction:n.direction}))}),[t]),y=Object(a.useCallback)((e=>{t(Object(N.D)(e))}),[t]),h=Object(a.useCallback)((e=>{const n=e.map((e=>e.noteId));t(Object(N.C)(n))}),[t]),j=Object(a.useCallback)((e=>e.noteId),[]),S=Object(a.useMemo)((()=>{const t=[{name:O,description:E,color:"primary",icon:"trash",type:"icon",onClick:e=>y(e.noteId)}];return[...D(e),{name:"actions",actions:t}]}),[y,e]),w=Object(a.useMemo)((()=>({pageIndex:o.page-1,pageSize:o.perPage,totalItemCount:o.total,pageSizeOptions:F})),[o]),k=Object(a.useMemo)((()=>({onSelectionChange:h,selectable:()=>!0})),[h]),C=Object(a.useMemo)((()=>({sort:l})),[l]);return f?i.a.createElement(r.EuiEmptyPrompt,{iconType:"error",color:"danger",title:i.a.createElement("h2",null,x),body:i.a.createElement("p",null,b)}):i.a.createElement(i.a.Fragment,null,i.a.createElement(m,null),i.a.createElement(I,null),i.a.createElement(r.EuiBasicTable,{items:n,pagination:w,columns:S,onChange:v,selection:k,sorting:C,itemId:j,loading:p}),c&&i.a.createElement(_,null))};R.displayName="NoteManagementPage";var N=n(289)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(765);function i(e,t){var n;const i=t?t(e):function(e){var t;return e.timeSeriesMetric||(null!==(t=e.type)&&void 0!==t?t:"string")}(e),r=(null===(n=e.esTypes)||void 0===n?void 0:n[0])||null;return r&&["_id","_index","_ignored"].includes(r)&&"string"===i?"keyword":"unknown"===i&&r&&Object(a.c)(r)||"string"===i&&r?r:i}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return v})),n.d(t,"e",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return j}));var a=n(72),i=n(19),r=n(2),s=n.n(r),o=n(41),l=n.n(o),u=n(118);const c="100%",d=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:c};\n  `));d.displayName="WrappedByAutoSizer";const m=s.a.memo(d),p={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},f=()=>({baseTheme:Object(u.g)()?a.LEGACY_DARK_THEME:a.LEGACY_LIGHT_THEME,theme:p}),b={rotation:0,rendering:"canvas",showLegend:!1,legendValues:[],debug:!1,legendPosition:a.Position.Bottom},g=(e,t)=>{const n=e||t;return n?`${n}px`:c},v=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},y=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),h=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),j=(l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"]))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,i=function(e,t,n){var i=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){i(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s="",o=t;do{var l=e.insert(t===o?"."+r:"",o,e.sheet,!0);a||void 0===l||(s+=l),o=o.next}while(void 0!==o);if(!a&&0!==s.length)return s}},t.registerStyles=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(712),i=n(714),r=n(515);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(a),l=s(i),u=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},m=function(e){return null!=e&&"boolean"!=typeof e},p=s(r).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),f=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,n){return g={name:t,styles:n,next:g},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function b(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return g={name:n.name,styles:n.styles,next:g},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)g={name:a.name,styles:a.styles,next:g},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var i=0;i<n.length;i++)a+=b(e,t,n[i])+";";else for(var r in n){var s=n[r];if("object"!=typeof s)null!=t&&void 0!==t[s]?a+=r+"{"+t[s]+"}":m(s)&&(a+=p(r)+":"+f(r,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var o=b(e,t,s);switch(r){case"animation":case"animationName":a+=p(r)+":"+o+";";break;default:a+=r+"{"+o+"}"}}else for(var l=0;l<s.length;l++)m(s[l])&&(a+=p(r)+":"+f(r,s[l])+";")}return a}(e,t,n);case"function":if(void 0!==e){var i=g,r=n(e);return g=i,b(e,t,r)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var g,v=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,i="";g=void 0;var r=e[0];null==r||void 0===r.raw?(a=!1,i+=b(n,t,r)):i+=r[0];for(var s=1;s<e.length;s++)i+=b(n,t,e[s]),a&&(i+=r[s]);v.lastIndex=0;for(var l,u="";null!==(l=v.exec(i));)u+="-"+l[1];return{name:o.default(i)+u,styles:i,next:g}}},function(e,t,n){"use strict";e.exports=n(713)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,i=e.length;i>=4;++a,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(715)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return C}));var a=n(188),i=n.n(a),r=n(44),s=n(2),o=n(45),l=n(3),u=n(55),c=n(1484),d=n(118),m=n(376),p=n(129),f=n(978),b=n(131),g=n(137),v=n(146),y=n(246),h=n(980),j=n(763),O=n(5),E=n(764);const x="timelineEventsQuery",S=[{field:"@timestamp",direction:g.b.asc,type:"date",esTypes:["date"]}],w=e=>({...Object(r.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(r.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(r.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(r.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),k=({dataViewId:e,endDate:t,eqlOptions:n,id:a=x,indexNames:E,fields:k,filterQuery:C,runtimeMappings:T,startDate:M,language:I="kuery",limit:_,sort:A=S,skip:P=!1,timerangeKind:D})=>{const[{pageName:F}]=Object(y.a)(),R=Object(o.useDispatch)(),{data:N}=Object(d.j)().services,z=Object(s.useRef)(r.noop),L=Object(s.useRef)(new AbortController),B=Object(s.useRef)(new l.Subscription),[q,V]=Object(s.useState)(c.a.loaded),[$,U]=Object(s.useState)(a===v.c.active?h.a.getActivePage():0),[G,H]=Object(s.useState)(null),Q=Object(s.useRef)(null),{startTracking:W}=Object(j.a)(),K=Object(s.useCallback)((()=>{null!=a&&f.a.some((e=>e===a))&&(R(p.a.clearEventsLoading({id:a})),R(p.a.clearEventsDeleted({id:a})))}),[R,a]),J=Object(s.useCallback)((e=>{K(),a===v.c.active&&h.a.setActivePage(e),U(e)}),[K,a]),Y=Object(s.useCallback)((()=>{null!=z.current&&z.current(),J(0)}),[J]),[X,Z]=Object(s.useState)({id:a,inspect:{dsl:[],response:[]},refetch:Y,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:J,refreshedAt:0}),ee=Object(s.useCallback)((async(t,n)=>{if(null==t||""===F||P)return;const i=async()=>{Q.current=t,L.current=new AbortController,V(0===$?c.a.loading:c.a.loadingMore);const{endTracking:i}=W({name:`${O.m} timeline events search`});B.current=N.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:L.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(u.isRunningResponse)(e)||(i("success"),V(c.a.loaded),Z((i=>{const r={...i,events:(s=e.edges,s.map((e=>e.node))),inspect:Object(b.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var s;return a===v.c.active&&(h.a.setPageName(F),"eql"===t.language?(h.a.setEqlRequest(t),h.a.setEqlResponse(r)):(h.a.setRequest(t),h.a.setResponse(r))),n&&n(r),r})),B.current.unsubscribe())},error:e=>{i(L.current.signal.aborted?"aborted":"error"),V(c.a.loaded),N.search.showError(e),B.current.unsubscribe()}})};if(a===v.c.active&&""!==h.a.getPageName()&&F!==h.a.getPageName()){if(h.a.setPageName(F),L.current.abort(),V(c.a.loaded),"eql"===t.language?(Q.current=h.a.getEqlRequest(),z.current=i.bind(null,h.a.getEqlRequest())):(Q.current=h.a.getRequest(),z.current=i.bind(null,h.a.getRequest())),Z((e=>{const n="eql"===t.language?h.a.getEqlResponse():h.a.getResponse();return null!=n?{...n,refetch:Y,loadPage:J}:e})),"eql"!==t.language&&null!=h.a.getResponse())return;if("eql"===t.language&&null!=h.a.getEqlResponse())return}B.current.unsubscribe(),L.current.abort(),await i(),z.current=i}),[F,P,a,$,W,N.search,e,Y,J]);Object(s.useEffect)((()=>{0!==E.length&&H((e=>{var r,s,o,l,u,c,d;const p=e,f={defaultIndex:null!==(r=null==e?void 0:e.defaultIndex)&&void 0!==r?r:[],filterQuery:null!==(s=null==e?void 0:e.filterQuery)&&void 0!==s?s:"",querySize:null!==(o=null==e||null===(l=e.pagination)||void 0===l?void 0:l.querySize)&&void 0!==o?o:0,sort:null!==(u=null==e?void 0:e.sort)&&void 0!==u?u:S,timerange:null!==(c=null==e?void 0:e.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(d=null==e?void 0:e.runtimeMappings)&&void 0!==d?d:{},...w(p)},b=M&&t?{timerange:{interval:"12h",from:M,to:t}}:{},y={defaultIndex:E,filterQuery:Object(m.a)(C),querySize:_,sort:A,runtimeMappings:T,...b,...w(n)},j=i()(f,y)?$:0;let O=k;const x=k.filter((t=>{var n;return!(null!=e&&null!==(n=e.fieldRequested)&&void 0!==n&&n.includes(t))}));var P,D;O=x.length>0?[...null!==(P=null==e?void 0:e.fieldRequested)&&void 0!==P?P:[],...x]:null!==(D=null==e?void 0:e.fieldRequested)&&void 0!==D?D:[];const F={defaultIndex:E,factoryQueryType:g.w.all,fieldRequested:O,fields:O,filterQuery:Object(m.a)(C),pagination:{activePage:j,querySize:_},language:I,runtimeMappings:T,sort:A,...b,...n||{}};return $!==j&&(U(j),a===v.c.active&&h.a.setActivePage(j)),i()(e,F)?e:F}))}),[R,E,$,t,n,C,a,I,_,M,A,k,T]);const te=Object(s.useCallback)((async e=>{a===v.c.active&&"absolute"!==D&&i()(Q.current,G)||await ee(G,e)}),[a,G,ee,D]);return Object(s.useEffect)((()=>{Object(r.isEmpty)(C)&&Z({id:a,inspect:{dsl:[],response:[]},refetch:Y,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:J,refreshedAt:0})}),[C,a,Y,J]),[q,X,te]},C=({dataViewId:e,endDate:t,eqlOptions:n,id:a=x,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:u,language:c="kuery",limit:d,sort:m=S,skip:p=!1,timerangeKind:f,fetchNotes:b=!0})=>{const[g,v,y]=k({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:u,language:c,limit:d,sort:m,skip:p,timerangeKind:f}),{onLoad:h}=Object(E.a)(),j=Object(s.useCallback)((e=>{b&&h(e.events)}),[b,h]);return Object(s.useEffect)((()=>{y&&y(j)}),[y,j]),[g,v]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));var a=n(44),i=n(53),r=n(121),s=n(179);const o=["host.name","host.hostname","host.domain","host.id","host.ip","client.ip","destination.ip","server.ip","source.ip","network.community_id","user.name","process.name"],l=(e,t,n=console)=>{var a,i;const r=null!==(a=null===(i=t.find((t=>t.field===e)))||void 0===i?void 0:i.values)&&void 0!==a?a:null;return null==r?[]:"string"==typeof r?[r]:Array.isArray(r)&&r.every((e=>"string"==typeof e))?r:(n.trace("Data type that is not a string or string array detected:",r,"when trying to access field:",e,"from data object of:",t),[])},u=(e,t=[])=>{let n=t;return"is"===e.function&&o.includes(e.arguments[0].value)&&(n=[...n,{field:e.arguments[0].value,valueToChange:e.arguments[1].value}]),e.arguments.reduce(((e,t)=>"is"===t.function&&o.includes(t.arguments[0].value)?[...e,{field:t.arguments[0].value,valueToChange:t.arguments[1].value}]:t.arguments?u(t,e):e),n)},c=(e,t,n=r.m.default)=>n===r.m.default?""!==e.trim()?u(Object(i.fromKueryExpression)(e)).reduce(((e,n)=>{const a=l(n.field,t);return a.length?e.replace(n.valueToChange,a[0]):e}),e):"":e.trim(),d=(e,t)=>e.map((e=>{if("phrase"===e.meta.type&&null!=e.meta.key&&o.includes(e.meta.key)){const n=l(e.meta.key,t);n.length&&(e.meta.params={query:n[0]},e.query={match_phrase:{[e.meta.key]:n[0]}})}return e})),m=(e,t,n=r.m.default)=>{if(n!==r.m.template){if(o.includes(e.queryMatch.field)){const n=l(e.queryMatch.field,t);n.length&&(e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0)}return e.type=s.a.default,e}if(n===r.m.template){var a;if(e.type===s.a.template&&":"===e.queryMatch.operator){const n=l(e.queryMatch.field,t);return n.length||(e.enabled=!1),e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0,e.type=s.a.default,e}return e.type=null!==(a=e.type)&&void 0!==a?a:s.a.default,e}return e},p=(e,t,n=r.m.default)=>e.map((e=>{const i=m(e,t,n);return null==i.and||Object(a.isEmpty)(i.and)||(i.and=i.and.map((e=>m(e,t,n)))),i})),f=(e,t)=>[{range:{"@timestamp":{gte:e,lte:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lte:t,format:"strict_date_optional_time"}},$state:{store:i.FilterStateStore.APP_STATE}}]},function(e,t,n){"use strict";var a=Array.isArray,i=Object.keys,r=Object.prototype.hasOwnProperty,s="undefined"!=typeof Element;function o(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,l,u,c=a(e),d=a(t);if(c&&d){if((l=e.length)!=t.length)return!1;for(n=l;0!=n--;)if(!o(e[n],t[n]))return!1;return!0}if(c!=d)return!1;var m=e instanceof Date,p=t instanceof Date;if(m!=p)return!1;if(m&&p)return e.getTime()==t.getTime();var f=e instanceof RegExp,b=t instanceof RegExp;if(f!=b)return!1;if(f&&b)return e.toString()==t.toString();var g=i(e);if((l=g.length)!==i(t).length)return!1;for(n=l;0!=n--;)if(!r.call(t,g[n]))return!1;if(s&&e instanceof Element&&t instanceof Element)return e===t;for(n=l;0!=n--;)if(!("_owner"===(u=g[n])&&e.$$typeof||o(e[u],t[u])))return!1;return!0}return e!=e&&t!=t}e.exports=function(e,t){try{return o(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),r=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},function(e,t,n){"use strict";e.exports=n(762)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(723);n(71),n(324),n(323);var i=a.default({key:"css"}),r=i.flush,s=i.hydrate,o=i.cx,l=i.merge,u=i.getRegisteredStyles,c=i.injectGlobal,d=i.keyframes,m=i.css,p=i.sheet,f=i.cache;t.cache=f,t.css=m,t.cx=o,t.flush=r,t.getRegisteredStyles=u,t.hydrate=s,t.injectGlobal=c,t.keyframes=d,t.merge=l,t.sheet=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(71),i=n(324),r=n(323);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,n){var a=[],i=r.getRegisteredStyles(e,a,n);return a.length<2?n:i+t(a)}var c=function e(t){for(var n="",a=0;a<t.length;a++){var i=t[a];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var s in r="",i)i[s]&&s&&(r&&(r+=" "),r+=s);break;default:r=i}r&&(n&&(n+=" "),n+=r)}}return n};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var s=i.serializeStyles(n,t.registered,void 0);return r.insertStyles(t,s,!1),t.key+"-"+s.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return u(t.registered,n,c(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered);l(t,r)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered),s="animation-"+r.name;return l(t,{name:r.name,styles:"@keyframes "+s+"{"+r.styles+"}"}),s},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,n)}}},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"a",(function(){return q}));var a=n(44),i=n(19),r=n(42),s=n(2),o=n.n(s),l=n(41),u=n.n(l),c=n(45),d=n(1216),m=n(122),p=n(118),f=n(145),b=n(130),g=n(300),v=n(129),y=n(272),h=n(4);const j=h.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),O=h.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),E=h.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),x=h.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),S=h.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),w=h.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),k=h.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var C=n(146),T=n(124),M=n(127),I=n(132),_=n(47),A=n(123),P=n(260),D=n(909);const F=u.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));F.displayName="NotePreviewsContainer";const R=({eventId:e,timelineId:t})=>{const n=Object(c.useDispatch)(),{selectedPatterns:a}=Object(I.a)(M.SourcererScopeName.timeline),{telemetry:r}=Object(p.j)().services,{openFlyout:l}=Object(d.a)(),u=Object(m.a)("expandableFlyoutDisabled"),b=Object(s.useCallback)((()=>{const i=a.join(",");u?n(v.a.toggleDetailPanel({panelView:"eventDetail",tabType:C.d.notes,id:t,params:{eventId:e,indexName:i}})):(l({right:{id:f.e,params:{id:e,indexName:i,scopeId:t}}}),r.reportDetailsFlyoutOpened({location:t,panel:"right"}))}),[n,e,u,l,a,r,t]);return o.a.createElement(i.EuiButtonIcon,{"data-test-subj":"notes-toggle-event-details",title:j,"aria-label":j,color:"text",iconType:"arrowRight",onClick:b})},N=o.a.memo(R),z=o.a.memo((({closeModal:e,confirmModal:t})=>o.a.createElement(i.EuiConfirmModal,{title:k,onCancel:e,onConfirm:t,cancelButtonText:w,confirmButtonText:S,buttonColor:"danger",defaultFocusedButton:"confirm"})));z.displayName="DeleteNoteConfirm";const L=o.a.memo((({noteId:e,eventId:t,confirmingNoteId:n,timelineId:a,eventIdToNoteIds:r,savedObjectId:l})=>{const u=Object(c.useDispatch)(),[d,m]=Object(s.useState)(!1),{mutate:f,isLoading:b}=function(e,t,n,a){const{services:{http:i}}=Object(p.j)(),r=Object(c.useDispatch)(),{addError:s}=Object(A.a)();return Object(_.useMutation)({mutationFn:e=>i.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{const i=null==n?void 0:n[null!=t?t:""];a&&r(P.a.deleteNote({id:a})),e&&t&&r(v.a.deleteNoteFromEvent({id:C.c.active,noteId:e,eventId:t})),t&&i&&1===i.length&&r(v.a.unPinEvent({eventId:t,id:C.c.active}))},onError:e=>{var t;s(e,{title:(t=e,h.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:"string"==typeof t?t:null==t?void 0:t.message}}))})}})}(e,t,r,l),g=Object(s.useCallback)((()=>{m(!0),u(v.a.setConfirmingNoteId({confirmingNoteId:e,id:null!=a?a:C.c.active}))}),[e,u,a]),y=Object(s.useCallback)((()=>{m(!1),u(v.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:C.c.active}))}),[u,a]),j=Object(s.useCallback)((()=>{f(l),m(!1),u(v.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:C.c.active}))}),[f,l,u,a]),O=Object(s.useMemo)((()=>b||null==l),[b,l]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiButtonIcon,{title:S,"aria-label":S,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:g,disabled:O}),n===e&&d?o.a.createElement(z,{closeModal:y,confirmModal:j}):null)}));L.displayName="DeleteNoteButton";const B=o.a.memo((({eventId:e,timelineId:t,noteId:n,confirmingNoteId:a,eventIdToNoteIds:i,savedObjectId:r,showToggleEventDetailsAction:s=!0})=>e&&t?o.a.createElement(o.a.Fragment,null,s?o.a.createElement(N,{eventId:e,timelineId:t}):null,o.a.createElement(L,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:r,timelineId:t,eventIdToNoteIds:i})):o.a.createElement(L,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:r,timelineId:t,eventIdToNoteIds:i})));B.displayName="NoteActions";const q=o.a.memo((({notes:e,timelineId:t,showTimelineDescription:n,showToggleEventDetailsAction:l=!0})=>{const u=Object(s.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),c=Object(s.useMemo)((()=>Object(D.a)()),[]),d=Object(T.a)((e=>u(e,null!=t?t:C.c.active))),m=Object(T.a)((e=>c(e,null!=t?t:C.c.active))),p=null==m?void 0:m.eventIdToNoteIds,f=Object(s.useMemo)((()=>n&&t&&null!=d&&d.description?[{username:Object(b.a)(d.updatedBy),event:E,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:d.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(d.updated)}):Object(b.e)(),children:o.a.createElement(i.EuiText,{size:"s"},d.description),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=d.updatedBy?d.updatedBy:"?",size:"l"}),actions:null}]:[]),[d,t,n]),h=Object(s.useMemo)((()=>Object(a.uniqBy)("savedObjectId",e).map((e=>{var n,a,s;const u=null!=p?Object.entries(p).reduce(((t,[n,a])=>{var i;return a.includes(null!==(i=e.noteId)&&void 0!==i?i:"")?n:t}),null):null!==(n=e.eventId)&&void 0!==n?n:null;return{"data-test-subj":`note-preview-${e.savedObjectId}`,username:Object(b.a)(e.updatedBy),event:O,timestamp:e.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(e.updated)}):Object(b.e)(),children:o.a.createElement("div",{className:y.a,tabIndex:0},o.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},o.a.createElement("p",null,`${null!==(a=e.updatedBy)&&void 0!==a?a:x} ${O}`)),o.a.createElement(g.b,null,null!==(s=e.note)&&void 0!==s?s:"")),actions:o.a.createElement(B,{eventId:u,timelineId:t,noteId:e.noteId,savedObjectId:e.savedObjectId,confirmingNoteId:null==d?void 0:d.confirmingNoteId,eventIdToNoteIds:p,showToggleEventDetailsAction:l}),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=e.updatedBy?e.updatedBy:"?",size:"l"})}}))),[p,e,t,null==d?void 0:d.confirmingNoteId,l]),j=Object(s.useMemo)((()=>[...f,...h]),[f,h]);return o.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:j})}));q.displayName="NotePreviews"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(44),i=n(2),r=n(123),s=n(118),o=n(17),l=n(1249),u=n(4);const c=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),d=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),m=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),p=()=>{const{telemetry:e}=Object(s.j)().services,{addError:t}=Object(r.a)(),[n,a]=Object(i.useState)(!1);return{enableDatafeed:Object(i.useCallback)((async(n,i)=>{if(a(!0),Object(o.h)(o.a.COUNT,n.isElasticJob?o.c.SIEM_JOB_ENABLED:o.c.CUSTOM_JOB_ENABLED),!n.isInstalled)try{await Object(l.c)({configTemplate:n.moduleId,indexPatternName:n.defaultIndexPattern,jobIdErrorFilter:[n.id],groups:n.groups}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:o.b.moduleInstalled})}catch(i){return a(!1),t(i,{title:m}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:o.b.installationError,errorMessage:`${m} - ${i.message}`}),{enabled:!1}}const r=new Date,s=r.setDate(r.getDate()-14),u=`datafeed-${n.id}`,d=Math.max(i,s);try{var p;const t=await Object(l.d)({datafeedIds:[u],start:d});if(null!==(p=t[u])&&void 0!==p&&p.error)throw new Error(t[u].error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.started}),{enabled:!!t[u]&&t[u].started}}catch(a){Object(o.h)(o.a.COUNT,o.c.JOB_ENABLE_FAILURE),t(a,{title:c}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.startError,errorMessage:`${c} - ${a.message}`})}finally{a(!1)}return{enabled:!1}}),[t,e]),disableDatafeed:Object(i.useCallback)((async n=>{Object(o.h)(o.a.COUNT,n.isElasticJob?o.c.SIEM_JOB_DISABLED:o.c.CUSTOM_JOB_DISABLED),a(!0);const i=`datafeed-${n.id}`;try{const[t]=await Object(l.e)({datafeedIds:[i]});if(f(t))throw new Error(t.error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.stopped}),{enabled:!t[i]||!t[i].stopped}}catch(a){Object(o.h)(o.a.COUNT,o.c.JOB_DISABLE_FAILURE),t(a,{title:d}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.stopError,errorMessage:`${d} - ${a.message}`})}finally{a(!1)}return{enabled:!0}}),[t,e]),isLoading:n}},f=e=>!Object(a.isEmpty)(e.error)},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(1055),r=a.__importDefault(n(461)),s=function(e,t){return e.every((function(e,n){return i.equal(e,t[n])}))};t.default=function(e,t){r.default(e,t,s)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),i=n(796),r=n(750);const s=new a.Type("NonEmptyEntriesArray",i.a.is,((e,t)=>Array.isArray(e)&&0===e.length?a.failure(e,t):Array.isArray(e)&&e.some((e=>r.a.is(e)))&&e.some((e=>!r.a.is(e)))?a.failure(e,t,"Cannot have entry of type list and other"):i.a.validate(e,t)),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(2),i=n(47),r=n(159),s=n(322);const o=["GET",n(440).a],l=e=>Object(i.useQuery)(o,(async({signal:e})=>(await Object(r.m)({signal:e})).stats),{...s.a,...e}),u=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(o,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),i=n.n(a),r=n(19),s=n(42),o=n(54),l=n.n(o),u=n(2),c=n.n(u);const d=c.a.memo((({children:e,date:t,fieldName:n,className:a="",tooltipProps:o})=>c.a.createElement(r.EuiToolTip,i()({"data-test-subj":"localized-date-tool-tip",anchorClassName:a},o,{content:c.a.createElement(r.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement("span",{"data-test-subj":"field-name"},n)):null,c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(s.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:l.a.utc(t).toDate()})),c.a.createElement(r.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},l.a.utc(t).local().format("llll")),c.a.createElement(r.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},l()(t).format()))}),c.a.createElement(c.a.Fragment,null,e))));d.displayName="LocalizedDateTooltip"},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),r=(a.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>a.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),s=a.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"});a.i18n.translate("xpack.securitySolution.eventsViewer.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),i=n(2),r=n.n(i),s=n(41),o=n.n(s),l=n(228);const u=o.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e,onClick:t})=>{const n=Object(i.useCallback)((()=>t&&t()),[t]);return e?t?r.a.createElement(a.EuiLink,{onClick:n},r.a.createElement("b",null,r.a.createElement(l.a,{count:e}))):r.a.createElement("b",null,r.a.createElement(l.a,{count:e})):r.a.createElement(u,null)};c.displayName="ChartLabelComponent";const d=r.a.memo(c)},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h}));var a=n(19),i=n(2),r=n.n(i),s=n(72),o=n(7),l=n(41),u=n.n(l),c=n(4),d=n(708),m=n(882),p=n(770);const f={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},b=u()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),g=u()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),v=({children:e,dataExists:t,donutTextWrapperClassName:n,donutTextWrapperStyles:s,isChartEmbeddablesEnabled:o,label:l,title:u})=>{const{euiTheme:c}=Object(a.useEuiTheme)(),d=Object(i.useMemo)((()=>({color:c.colors.darkShade})),[c.colors.darkShade]),m=o?void 0:"eui-textTruncate";return r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(g,{grow:o},r.a.createElement(b,{$dataExists:t,$donutTextWrapperStyles:s,$isChartEmbeddablesEnabled:o,alignItems:"center",className:n,direction:"column",gutterSize:"none",justifyContent:"center"},r.a.createElement(a.EuiFlexItem,null,u),l&&r.a.createElement(a.EuiFlexItem,{className:m},r.a.createElement(a.EuiToolTip,{content:l},r.a.createElement(a.EuiText,{className:m,size:"s",style:t?void 0:d},l)))),e))},y=r.a.memo(v),h=({data:e,fillColor:t,height:n=90,label:l,legendItems:u,onPartitionClick:b,title:g,totalCount:v})=>{const{baseTheme:h,theme:j}=Object(d.h)(),O=Object(i.useCallback)((e=>{if(b){var t;const n=e.flat(2),a=n.length>0&&"groupByRollup"in n[0]&&null!=(null===(t=n[0])||void 0===t?void 0:t.groupByRollup)?`${n[0].groupByRollup}`:"";Object(o.isEmpty)(a.trim())||b(a.toLowerCase())}}),[b]);return r.a.createElement(y,{dataExists:null!=e&&e.length>0,label:l,title:g,isChartEmbeddablesEnabled:!1},r.a.createElement(r.a.Fragment,null,null==e||null==v||0===v?r.a.createElement(p.a,{size:n}):r.a.createElement(s.Chart,{size:n},r.a.createElement(s.Settings,{theme:[f,j],baseTheme:h,onElementClick:O,locale:c.i18n.getLocale()}),r.a.createElement(s.Partition,{id:"donut-chart",data:e,layout:s.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(s.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),u&&(null==u?void 0:u.length)>0&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(m.a,{legendItems:u,height:n}))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(119),i=n(2),r=n(652),s=n(43),o=n(323),l=n(324),u=n(653);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var m=d(i),p=c(r).default,f=function(e){return"theme"!==e},b=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?p:f},g=function(e,t,n){var a;if(t){var i=t.shouldForwardProp;a=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof a&&n&&(a=e.__emotion_forwardProp),a},v="undefined"!=typeof document,y=function(e){var t=e.cache,n=e.serialized,a=e.isStringTag;o.registerStyles(t,n,a);var i=u.useInsertionEffectAlwaysWithSyncFallback((function(){return o.insertStyles(t,n,a)}));if(!v&&void 0!==i){for(var r,s=n.name,l=n.next;void 0!==l;)s+=" "+l.name,l=l.next;return m.createElement("style",((r={})["data-emotion"]=t.key+" "+s,r.dangerouslySetInnerHTML={__html:i},r.nonce=t.sheet.nonce,r))}return null};t.default=function e(t,n){var i,r,u=t.__emotion_real===t,c=u&&t.__emotion_base||t;void 0!==n&&(i=n.label,r=n.target);var d=g(t,n,u),p=d||b(c),f=!p("as");return function(){var v=arguments,h=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&h.push("label:"+i+";"),null==v[0]||void 0===v[0].raw)h.push.apply(h,v);else{h.push(v[0][0]);for(var j=v.length,O=1;O<j;O++)h.push(v[O],v[0][O])}var E=s.withEmotionCache((function(e,t,n){var a=f&&e.as||c,i="",u=[],g=e;if(null==e.theme){for(var v in g={},e)g[v]=e[v];g.theme=m.useContext(s.ThemeContext)}"string"==typeof e.className?i=o.getRegisteredStyles(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var j=l.serializeStyles(h.concat(u),t.registered,g);i+=t.key+"-"+j.name,void 0!==r&&(i+=" "+r);var O=f&&void 0===d?b(a):p,E={};for(var x in e)f&&"as"===x||O(x)&&(E[x]=e[x]);return E.className=i,E.ref=n,m.createElement(m.Fragment,null,m.createElement(y,{cache:t,serialized:j,isStringTag:"string"==typeof a}),m.createElement(a,E))}));return E.displayName=void 0!==i?i:"Styled("+("string"==typeof c?c:c.displayName||c.name||"Component")+")",E.defaultProps=t.defaultProps,E.__emotion_real=E,E.__emotion_base=c,E.__emotion_styles=h,E.__emotion_forwardProp=d,Object.defineProperty(E,"toString",{value:function(){return"."+r}}),E.withComponent=function(t,i){return e(t,a({},n,i,{shouldForwardProp:g(E,i,!0)})).apply(void 0,h)},E}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(187);const r=()=>{const{startTransaction:e}=Object(i.b)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),i=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==i||i.end()}}}),[e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(45),r=n(122),s=n(697);const o=()=>{const e=Object(i.useDispatch)(),t=Object(r.a)("securitySolutionNotesEnabled");return{onLoad:Object(a.useCallback)((n=>{if(!t||0===n.length)return;const a=n.map((e=>e._id)).filter((e=>null!=e));e(Object(s.e)({documentIds:a}))}),[e,t])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r}));let a=function(e){return e.DOCUMENT="document",e.BINARY="binary",e.BOOLEAN="boolean",e.CONFLICT="conflict",e.COUNTER="counter",e.DATE="date",e.DATE_RANGE="date_range",e.DENSE_VECTOR="dense_vector",e.GAUGE="gauge",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.HISTOGRAM="histogram",e.IP="ip",e.IP_RANGE="ip_range",e.FLATTENED="flattened",e.KEYWORD="keyword",e.MURMUR3="murmur3",e.NUMBER="number",e.NESTED="nested",e.RANK_FEATURE="rank_feature",e.RANK_FEATURES="rank_features",e.POINT="point",e.SHAPE="shape",e.SPARSE_VECTOR="sparse_vector",e.SEMANTIC_TEXT="semantic_text",e.STRING="string",e.TEXT="text",e.VERSION="version",e}({});const i=Object.values(a),r=e=>!!e&&i.includes(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(79),r=n(132),s=n(118);const o=({sourcererScope:e})=>{const{services:{fieldFormats:t}}=Object(s.j)(),{sourcererDataView:n}=Object(r.a)(e);return Object(a.useMemo)((()=>n?new i.DataView({spec:n,fieldFormats:t}):void 0),[n,t])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(446);const s=Object(r.c)(),o=Object(r.c)(),l=()=>{const[e]=Object(a.useState)(s);return{portalNode:e}},u=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(r.b,{node:e})}));u.displayName="TimelineEventsCountBadge";const c=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=c();return i.a.createElement(r.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const a=new MutationObserver((()=>{const a=!!document.getElementById(e);a&&!t&&n(!0),!a&&t&&n(!1)}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[t,e]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),r=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),s=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(41),s=n.n(r),o=n(19);const l="#FAFBFD",u=s.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${l};\n    text-align: center;\n    line-height: ${e}px;`)),c=s.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(o.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(u,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,m=i.a.memo(d)},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);a.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),a.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),a.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const i="siem"},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(41),i=n.n(a),r=n(2),s=n.n(r),o=n(19),l=n(223);const u=i()(o.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-g8lc0e-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);u.displayName="StaticSwitch";const c=({job:e,isSecurityJobsLoading:t,onJobStateChange:n})=>{const[a,i]=Object(r.useState)(!1),c=Object(r.useCallback)((async t=>{i(!0),await n(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,n]);return s.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceAround"},s.a.createElement(o.EuiFlexItem,{grow:!1},t||a||Object(l.b)(e.jobState,e.datafeedState)?s.a.createElement(o.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):s.a.createElement(u,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:c,showLabel:!1,label:""})))};c.displayName="JobSwitchComponent";const d=s.a.memo(c);d.displayName="JobSwitch"},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(462));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=r.default(e,t),s=a[0],o=a[1],l=a[2];return i.useEffect(l,n),[s,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(154),r=a.__importDefault(n(461));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154);t.default=function(e,t,n){if(!i.isClient)return[t,function(){}];var r=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,n?String(t):JSON.stringify(t)),t):n?a:JSON.parse(a||"null")}catch(e){return t}})),s=r[0],o=r[1];return a.useEffect((function(){try{var t=n?String(s):JSON.stringify(s);sessionStorage.setItem(e,t)}catch(e){}})),[s,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(273),i=n(1275),r=n(26);const s=`${r.c}: true`,o=`${r.c}: false`,l=`${r.a}: true`,u=`${r.a}: false`;function c({filter:e,showCustomRules:t,showElasticRules:n,enabled:c,tags:m,excludeRuleTypes:p=[],ruleExecutionStatus:f}){const b=[];var g;return null!=e&&e.length&&b.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(i.b)(e)}`)).join(" OR ")}(e)})`),t&&n||(n?b.push(s):t&&b.push(o)),void 0!==c&&b.push(c?l:u),null!=m&&m.length&&b.push(function(e){return`${r.g}:(${e.map(i.b).join(" AND ")})`}(m)),p.length&&b.push("NOT "+(g=p,`${r.d}: (${g.map(i.b).join(" OR ")})`)),f===a.f.succeeded?b.push(`${r.b}: "succeeded"`):f===a.f["partial failure"]?b.push(`${r.b}: "warning"`):f===a.f.failed&&b.push(`${r.b}: "failed"`),b.join(" AND ")}const d=[r.e,r.f.INDEX,r.f.TACTIC_ID,r.f.TACTIC_NAME,r.f.TECHNIQUE_ID,r.f.TECHNIQUE_NAME,r.f.SUBTECHNIQUE_ID,r.f.SUBTECHNIQUE_NAME]},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return j})),n.d(t,"n",(function(){return O})),n.d(t,"o",(function(){return E})),n.d(t,"p",(function(){return x})),n.d(t,"q",(function(){return S})),n.d(t,"r",(function(){return w})),n.d(t,"s",(function(){return k})),n.d(t,"t",(function(){return P})),n.d(t,"u",(function(){return A})),n.d(t,"v",(function(){return M})),n.d(t,"w",(function(){return _})),n.d(t,"x",(function(){return T})),n.d(t,"y",(function(){return I})),n.d(t,"z",(function(){return D})),n.d(t,"A",(function(){return F})),n.d(t,"C",(function(){return R})),n.d(t,"B",(function(){return N})),n.d(t,"D",(function(){return i})),n.d(t,"E",(function(){return r})),n.d(t,"F",(function(){return s})),n.d(t,"G",(function(){return o}));var a=n(748);const i="ecs.version",r="event.action",s="event.kind",o="tags",l=`${a.k}.risk_score`,u=`${a.s}.author`,c=`${a.s}.created_at`,d=`${a.s}.created_by`,m=`${a.s}.description`,p=`${a.s}.enabled`,f=`${a.s}.from`,b=`${a.s}.interval`,g=`${a.s}.license`,v=`${a.s}.note`,y=`${a.s}.references`,h=`${a.s}.rule_id`,j=`${a.s}.rule_name_override`,O=`${a.s}.to`,E=`${a.s}.type`,x=`${a.s}.updated_at`,S=`${a.s}.updated_by`,w=`${a.s}.version`,k=`${a.k}.severity`,C=`${a.k}.suppression`,T=`${C}.terms`,M=`${T}.field`,I=`${T}.value`,_=`${C}.start`,A=`${C}.end`,P=`${C}.docs_count`,D=`${a.k}.system_status`,F=`${a.k}.workflow_reason`,R=`${a.k}.workflow_user`,N=`${a.k}.workflow_status_updated_at`},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(45),r=n(166);const s=e=>{const t=Object(i.useSelector)(r.d.kibanaDataViews),n=Object(i.useSelector)((t=>r.d.sourcererScopeSelectedDataViewId(t,e))),s=Object(a.useMemo)((()=>t.find((e=>e.id===n))),[t,n]);return Object(a.useCallback)((e=>{const t=null==s?void 0:s.fields;return t&&t[e]}),[null==s?void 0:s.fields])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(19),i=n(2),r=n.n(i),s=n(163),o=n(951);const l=r.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:i})=>r.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},r.a.createElement(o.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:s.G}))));l.displayName="OpenTimelineModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return V})),n.d(t,"b",(function(){return $}));var a=n(44),i=n(54),r=n.n(i),s=n(63),o=n.n(s),l=n(53),u=n(4),c=n(813),d=n(748),m=n(3),p=n(572),f=n(165),b=n(146),g=n(121),v=n(1246),y=n(158),h=n(184),j=n(250),O=n(131),E=n(718),x=n(292),S=n(118),w=n(5),k=n(1253),C=n(396);n(479);const T=({ecs:e})=>{if(Array.isArray(e)){const t=e.reduce(((e,t)=>{const n=t.timestamp?new Date(t.timestamp):new Date;return e.includes(n.valueOf())?e:[...e,n.valueOf()]}),[]);return{from:new Date(Math.min(...t)).toISOString(),to:new Date(Math.max(...t)).toISOString()}}const t=e,n=Object(O.getField)(t,c.g),a=r.a.duration(r()().diff(o.a.parse(null!=n?n[0]:"now-1d"))),i=Object(O.getField)(t,d.K),s=Array.isArray(i)?i[0]:i,l=r()(null!=s?s:new Date).toISOString();return{to:l,from:r()(l).subtract(a).toISOString()}},M=e=>{const t=Object(O.getField)(e,c.o);return Array.isArray(t)?t[0]:t},I=e=>Object(f.f)(M(e)),_=e=>Object(f.d)(M(e)),A=e=>Object(f.b)(M(e)),P=e=>Object(f.n)(M(e)),D=e=>Object(f.e)(M(e)),F=e=>null!=Object(O.getField)(e,c.t),R=(e,t,n="Alert Ids")=>1===t.length?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:e,params:{query:t[0]}},query:{match_phrase:{_id:t[0]}},$state:{store:l.FilterStateStore.APP_STATE}}]:[{query:{bool:{filter:{ids:{values:t}}}},meta:{alias:n,negate:!1,disabled:!1,type:"phrases",key:e,value:t.join(),params:t},$state:{store:l.FilterStateStore.APP_STATE}}],N=(e,t)=>{const n=1===t.length;return[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-alert-id-${t.join(",")}`,name:t.join(","),enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:n?t[0]:t,operator:n?":":"includes"}}]},z=(e,t,n)=>({filters:"KqlFilter"===t?R("_id",e,n):[],dataProviders:"dataProvider"===t?N("_id",e):[]}),L=async(e,t,n,a,i)=>{try{var s,l,m,f,g,v,h,j,E,x,T,M,I,_,A,P,D,F,R,N,z,L;const u=await S.b.get().http.fetch(w.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),C=(null!==(s=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==s?s:[])[0],B=Object(O.getField)(C,d.t),q=Object(O.getField)(C,c.d),V=(null!==(l=null!==(m=B.filters)&&void 0!==m?m:null===(f=C.signal)||void 0===f||null===(g=f.rule)||void 0===g?void 0:g.filters)&&void 0!==l?l:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),$=null!==(v=null!==(h=B.language)&&void 0!==h?h:null===(j=C.signal)||void 0===j||null===(E=j.rule)||void 0===E?void 0:E.language)&&void 0!==v?v:"kuery",U=null!==(x=null!==(T=B.query)&&void 0!==T?T:null===(M=C.signal)||void 0===M||null===(I=M.rule)||void 0===I?void 0:I.query)&&void 0!==x?x:"",G=null!==(_=null!==(A=Object(O.getField)(C,p.h))&&void 0!==A?A:null===(P=C.signal)||void 0===P||null===(D=P.rule)||void 0===D?void 0:D.index)&&void 0!==_?_:[],{thresholdFrom:H,thresholdTo:Q,dataProviders:W}=(e=>(Array.isArray(e)?e:[e]).reduce(((e,t)=>{var n,a,i,s;const l=null!==(n=Object(O.getField)(t,`${d.t}.threshold`))&&void 0!==n?n:null===(a=t.signal)||void 0===a||null===(i=a.rule)||void 0===i?void 0:i.threshold,u=Object(O.getField)(t,p.j),m=Object(O.getField)(t,p.g),f=Array.isArray(m)?m[0]:m,g=r()(f),v=((e,t)=>{const n=Object(O.getField)(e,c.g),a=Array.isArray(n)?n[0]:n,i=o.a.parse(a),s=r()(),l=r.a.duration(s.diff(i));return t.clone().subtract(l)})(t,g),y=Array.isArray(l.field)?l.field:[l.field];return{thresholdFrom:null!==(s=u.from)&&void 0!==s?s:v.toISOString(),thresholdTo:g.toISOString(),dataProviders:[...e.dataProviders,...y.reduce(((e,t,n)=>{const a=u.terms.filter((e=>e.field===t))[0].value,i=Array.isArray(a)?a[0]:a;if(!i)return e;const r=t.replace(".","-"),s={id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-${r}-${i}`,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:i,operator:":"}};return 0===n?[...e,{...s,and:[]}]:(e[0].and.push(s),e)}),[])]}}),{dataProviders:[],thresholdFrom:"",thresholdTo:""}))(C),K=await i(e),J=(null!==(F=a.filters)&&void 0!==F?F:V).concat(K?[K]:[]);return t({from:H,notes:null,timeline:{...y.b,excludedRowRendererIds:[],columns:null!==(R=a.columns)&&void 0!==R?R:y.b.columns,description:`_id: ${C._id}`,filters:J,dataProviders:null!==(N=a.dataProviders)&&void 0!==N?N:W,id:b.c.active,indexNames:G,dateRange:{start:H,end:Q},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:$,expression:null!==(z=a.query)&&void 0!==z?z:U},serializedQuery:null!==(L=a.query)&&void 0!==L?L:U}}},to:Q,ruleNote:n,ruleAuthor:q})}catch(n){const{toasts:a}=S.b.get().notifications;a.addError(n,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailureTitle",{defaultMessage:"Failed to create threshold alert timeline"})});const i=C.a.toISOString(),r=C.b.toISOString();return t({from:i,notes:null,timeline:{...y.b,id:b.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},B=async(e,t,n,a,i)=>{try{var s,o,l,c,m,f,g,v,h,j,E,x,T,M,I,_,A,P,D,F,R,N;const u=await S.b.get().http.fetch(w.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),C=(null!==(s=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==s?s:[])[0],z=Object(O.getField)(C,d.t),L=(null!==(o=null!==(l=z.filters)&&void 0!==l?l:null===(c=C.signal)||void 0===c||null===(m=c.rule)||void 0===m?void 0:m.filters)&&void 0!==o?o:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),B=null!==(f=null!==(g=z.language)&&void 0!==g?g:null===(v=C.signal)||void 0===v||null===(h=v.rule)||void 0===h?void 0:h.language)&&void 0!==f?f:"kuery",q=null!==(j=null!==(E=z.query)&&void 0!==E?E:null===(x=C.signal)||void 0===x||null===(T=x.rule)||void 0===T?void 0:T.query)&&void 0!==j?j:"",V=null!==(M=null!==(I=Object(O.getField)(C,p.h))&&void 0!==I?I:null===(_=C.signal)||void 0===_||null===(A=_.rule)||void 0===A?void 0:A.index)&&void 0!==M?M:[],{from:$,to:U,dataProviders:G}=(e=>{var t;const n=Array.isArray(e)?e[0]:e,a=Object(O.getField)(n,p.g),i=(null!==(t=Object(O.getField)(n,`${d.t}.new_terms_fields`))&&void 0!==t?t:[]).map(((e,t)=>{const a=e.replace(".","-"),i=Object(O.getField)(n,p.d)[t];return{id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-${a}-${i}`,name:e,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:i,operator:":"},and:[]}})),s=i.length?[{...i[0],and:i.slice(1)}]:[];return{from:a,to:r()().toISOString(),dataProviders:s}})(C),H=await i(e),Q=(null!==(P=a.filters)&&void 0!==P?P:L).concat(H?[H]:[]);return t({from:$,notes:null,timeline:{...y.b,columns:null!==(D=a.columns)&&void 0!==D?D:y.b.columns,excludedRowRendererIds:[],description:`_id: ${C._id}`,filters:Q,dataProviders:null!==(F=a.dataProviders)&&void 0!==F?F:G,id:b.c.active,indexNames:V,dateRange:{start:$,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:B,expression:null!==(R=a.query)&&void 0!==R?R:q},serializedQuery:null!==(N=a.query)&&void 0!==N?N:q}}},to:U,ruleNote:n})}catch(n){const{toasts:a}=S.b.get().notifications;a.addError(n,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailureTitle",{defaultMessage:"Failed to create new terms alert timeline"})});const i=C.a.toISOString(),r=C.b.toISOString();return t({from:i,notes:null,timeline:{...y.b,id:b.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},q=async(e,t,n,a,i)=>{try{var r,s,o,l,m,f,g,v,h,j,E,x,T,M,I,_,A,P,D,F,R,N;const u=await S.b.get().http.fetch(w.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),C=(null!==(r=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==r?r:[])[0],z=Object(O.getField)(C,d.t),L=(null!==(s=null!==(o=z.filters)&&void 0!==o?o:null===(l=C.signal)||void 0===l||null===(m=l.rule)||void 0===m?void 0:m.filters)&&void 0!==s?s:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),B=null!==(f=null!==(g=z.language)&&void 0!==g?g:null===(v=C.signal)||void 0===v||null===(h=v.rule)||void 0===h?void 0:h.language)&&void 0!==f?f:"kuery",q=null!==(j=null!==(E=z.query)&&void 0!==E?E:null===(x=C.signal)||void 0===x||null===(T=x.rule)||void 0===T?void 0:T.query)&&void 0!==j?j:"",V=null!==(M=null!==(I=Object(O.getField)(C,p.h))&&void 0!==I?I:null===(_=C.signal)||void 0===_||null===(A=_.rule)||void 0===A?void 0:A.index)&&void 0!==M?M:[],{from:$,to:U,dataProviders:G}=(e=>{const t=Array.isArray(e)?e[0]:e,n=Object(O.getField)(t,c.w),a=Object(O.getField)(t,c.u),i=Object(O.getField)(t,c.x).map((e=>{const t=e.field.replace(".","-"),n=`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-${t}-${e.value}`;return null==e.value?{id:n,name:t,enabled:!0,excluded:!0,kqlQuery:"",queryMatch:{field:e.field,value:"",operator:":*"}}:{id:n,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e.field,value:e.value,operator:":"}}}));return{from:n,to:a,dataProviders:[{...i[0],and:i.slice(1)}]}})(C),H=await i(e),Q=(null!==(P=a.filters)&&void 0!==P?P:L).concat(H?[H]:[]);return t({from:$,notes:null,timeline:{...y.b,excludedRowRendererIds:[],columns:null!==(D=a.columns)&&void 0!==D?D:y.b.columns,description:`_id: ${C._id}`,filters:Q,dataProviders:null!==(F=a.dataProviders)&&void 0!==F?F:G,id:b.c.active,indexNames:V,dateRange:{start:$,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:B,expression:null!==(R=a.query)&&void 0!==R?R:q},serializedQuery:null!==(N=a.query)&&void 0!==N?N:q}}},to:U,ruleNote:n})}catch(n){const{toasts:a}=S.b.get().notifications;a.addError(n,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailureTitle",{defaultMessage:"Failed to create suppressed alert timeline"})});const i=C.a.toISOString(),r=C.b.toISOString();return t({from:i,notes:null,timeline:{...y.b,id:b.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},V=async(e,t,n="dataProvider",a)=>{const i=Array.isArray(t)?t.map((e=>e._id)):[],{to:r,from:s}=T({ecs:t}),{dataProviders:o,filters:l}=z(i,n,a||`${t.length} event IDs`);await e({from:s,notes:null,timeline:{...y.b,excludedRowRendererIds:[],dataProviders:o,id:b.c.active,indexNames:[],dateRange:{start:s,end:r},eventType:"all",filters:l,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:r})},$=async({createTimeline:e,ecsData:t,updateTimelineIsLoading:n,searchStrategyClient:i,getExceptionFilter:r})=>{const s=Array.isArray(t)?t[0]:t,o=Object(O.getField)(s,c.j),l=Object(O.getField)(s,c.d),u=Array.isArray(o)&&o.length>0?o[0]:"",d=Object(O.getField)(s,p.i),f=Object(a.isEmpty)(d)?"":Array.isArray(d)?d[0]:d,{to:S,from:w}=T({ecs:t});if(Object(a.isEmpty)(f)){if(P(s))return L(s,e,u,{},r);if(I(s))return B(s,e,u,{},r);if(!F(s)||A(s)||_(s)||D(s)){let{dataProviders:n,filters:i}=z([s._id],"dataProvider");if((e=>{const t=Object(O.getField)(e,c.o),n=Object(O.getField)(e,p.a);return("eql"===t||Array.isArray(t)&&"eql"===t[0])&&(null==n?void 0:n.length)>0})(s)){const e=((e,t)=>{if(!Object(a.isEmpty)(e)&&Array.isArray(t)&&t.length>1)return{dataProviders:[],filters:R(p.a,t.reduce(((e,t)=>{const n=Object(O.getField)(t,p.a),a=Array.isArray(n)?n[0]:n;return e.includes(a)?e:[...e,a]}),[]))};if(!Array.isArray(t)||1===t.length){const e=Array.isArray(t)?t[0]:t,n=Object(O.getField)(e,p.a),a=Object(O.getFieldKey)(e,p.a),i=Array.isArray(n)?n[0]:n;return{dataProviders:[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-alert-id-${i}`,name:e._id,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:a,value:i,operator:":"}}],filters:[]}}return{filters:[],dataProviders:[]}})([s._id],t);n=e.dataProviders,i=e.filters}return e({from:w,notes:null,timeline:{...y.b,excludedRowRendererIds:[],dataProviders:n,id:b.c.active,indexNames:[],dateRange:{start:w,end:S},eventType:"all",filters:i,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:S,ruleNote:u,ruleAuthor:l})}return q(s,e,u,{},r)}try{var k,C;n({id:b.c.active,isLoading:!0});const[t,o]=await Promise.all([Object(x.e)(f),Object(m.lastValueFrom)(i.search({defaultIndex:[],indexName:null!==(k=s._index)&&void 0!==k?k:"",eventId:s._id,factoryQueryType:v.c.details},{strategy:"timelineSearchStrategy"}))]),c=Object(a.getOr)({},"data.getOneTimeline",t),d=null!==(C=o.data)&&void 0!==C?C:[];if(!Object(a.isEmpty)(c)){var M,N,V,$,U,G,H;const t=Object(h.f)(c),{timeline:n,notes:a}=Object(h.b)(t,!0,null!==(M=t.timelineType)&&void 0!==M?M:g.m.default),i=Object(E.d)(null!==(N=null===(V=n.kqlQuery)||void 0===V||null===($=V.filterQuery)||void 0===$||null===(U=$.kuery)||void 0===U?void 0:U.expression)&&void 0!==N?N:"",d,n.timelineType),o=Object(E.c)(null!==(G=n.filters)&&void 0!==G?G:[],d),m=Object(E.b)(null!==(H=n.dataProviders)&&void 0!==H?H:[],d,n.timelineType);return P(s)?L(s,e,u,{filters:o,query:i,dataProviders:m,columns:n.columns},r):I(s)?B(s,e,u,{filters:o,query:i,dataProviders:m,columns:n.columns},r):!F(s)||A(s)||_(s)||D(s)?e({from:w,timeline:{...n,excludedRowRendererIds:[],title:"",timelineType:g.m.default,templateTimelineId:null,status:g.l.draft,dataProviders:m,eventType:"all",filters:o,dateRange:{start:w,end:S},kqlQuery:{filterQuery:{kuery:{kind:null!==(Q=null===(W=n.kqlQuery)||void 0===W||null===(K=W.filterQuery)||void 0===K||null===(J=K.kuery)||void 0===J?void 0:J.kind)&&void 0!==Q?Q:"kuery",expression:i},serializedQuery:Object(j.f)(i)}},noteIds:null!==(Y=null==a?void 0:a.map((e=>e.noteId)))&&void 0!==Y?Y:[],show:!0},to:S,ruleNote:u,ruleAuthor:l,notes:null!=a?a:null}):q(s,e,u,{filters:o,query:i,dataProviders:m,columns:n.columns},r);var Q,W,K,J,Y}}catch{return n({id:b.c.active,isLoading:!1}),e({from:w,notes:null,timeline:{...y.b,id:b.c.active,indexNames:[],dateRange:{start:w,end:S},eventType:"all"},to:S})}}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(269),i=n(1342);const r=e=>Object(a.flow)(c,u)(e),s=e=>Object(a.flow)(u)(e),o=e=>Object(a.flow)(l)(e),l=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(i.a)({...e,entries:e.entries.map((e=>Object(i.a)(e)))}):Object(i.a)(e)));return{...e,entries:t}},u=e=>{const{entries:t}=e,n=t.map((e=>"nested"===e.type?Object(i.b)({...e,entries:e.entries.map((e=>Object(i.b)(e)))}):Object(i.b)(e)));return{...e,entries:n}},c=e=>{const{comments:t}=e;if(!t||!t.length)return e;const n=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(2),i=n(43);const r=Object(a.createContext)(void 0),s=Object(a.memo)((({urlKey:e,children:t})=>{const n=Object(a.useMemo)((()=>({urlKey:e})),[e]);return Object(i.jsx)(r.Provider,{value:n},t)}));s.displayName="ExpandableFlyoutContextProvider";const o=()=>{const e=Object(a.useContext)(r);if(void 0===e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(120);const i=a.z.string().min(1).regex(/^(?! *$).+$/),r=(a.z.string().uuid(),a.z.object({id:a.z.string().optional(),name:a.z.string().optional()}));a.z.enum(["asc","desc"]).enum},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return c}));const a="CONNECTORS_TAB",i="CONVERSATIONS_TAB",r="QUICK_PROMPTS_TAB",s="SYSTEM_PROMPTS_TAB",o="ANONYMIZATION_TAB",l="KNOWLEDGE_BASE_TAB",u="EVALUATION_TAB",c=25},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return yt})),n.d(t,"a",(function(){return Et}));var a=n(44),i=n(19),r=n(2),s=n.n(r),o=n(45),l=n(41),u=n.n(l),c=n(64),d=n(122),m=n(140),p=n(129),f=n(158),b=n(243),g=n(127),v=n(55),y=n(59),h=n(365),j=n(331),O=n(121),E=n(4);const x=E.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineBtn",{defaultMessage:"New"}),S=E.i18n.translate("xpack.securitySolution.timeline.modal.newTimeline",{defaultMessage:"New Timeline"}),w=E.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineTemplate",{defaultMessage:"New Timeline template"}),k=E.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtn",{defaultMessage:"Open"}),C=E.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),T=E.i18n.translate("xpack.securitySolution.timeline.modal.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),M=E.i18n.translate("xpack.securitySolution.timeline.modal.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),I=E.i18n.translate("xpack.securitySolution.timeline.modal.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"}),_=E.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),A=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"}),P=E.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),D=E.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),F=E.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),R=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),N=E.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),z=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),L=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),B=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),q=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),V=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"}),$=E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"}),U=s.a.memo((({timelineId:e})=>{const[t,n]=Object(r.useState)(!1),a=Object(r.useCallback)((()=>n((e=>!e))),[]),o=Object(j.a)({timelineId:e,timelineType:O.m.default,onClick:a}),l=Object(j.a)({timelineId:e,timelineType:O.m.template,onClick:a}),u=Object(r.useMemo)((()=>s.a.createElement(i.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right","data-test-subj":"timeline-modal-new-timeline-dropdown-button",onClick:a},x)),[a]),c=Object(r.useCallback)((async()=>{await o()}),[o]),d=Object(r.useCallback)((async()=>{await l()}),[l]),m=Object(r.useMemo)((()=>[s.a.createElement(i.EuiContextMenuItem,{key:"new-timeline",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline",onClick:c},S),s.a.createElement(i.EuiContextMenuItem,{key:"new-timeline-template",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline-template",onClick:d},w)]),[c,d]);return s.a.createElement(i.EuiPopover,{button:u,isOpen:t,closePopover:a,panelPaddingSize:"none"},s.a.createElement(i.EuiContextMenuPanel,{items:m}))}));U.displayName="NewTimelineButton";var G=n(815);const H=["createFrom"],Q=s.a.memo((()=>{const[e,t]=Object(r.useState)(!1),n=Object(r.useCallback)((()=>t((e=>!e))),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"timeline-modal-open-timeline-button",onClick:n,"aria-label":C},k),e?s.a.createElement(G.a,{onClose:n,hideActions:H}):null)}));Q.displayName="OpenTimelineButton";var W=n(36),K=n(169),J=n(213),Y=n(118),X=n(132),Z=n(250);const ee=e=>E.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} other {template}}",values:{isTimeline:e}});var te=n(912),ne=n(913),ae=n(181),ie=n(138),re=n(510),se=n(5),oe=n(13),le=n(146),ue=n(194),ce=n(156);const de=s.a.memo((({timelineId:e})=>{const t=Object(o.useDispatch)(),{graphEventId:n,savedObjectId:a,status:l,title:u,timelineType:c}=Object(o.useSelector)((t=>Object(K.selectTimelineById)(t,e))),{cases:d,application:{navigateToApp:m}}=Object(Y.j)().services,p=d.helpers.canUseCases([se.j]),[f,b]=Object(r.useState)(!1),[g,v]=Object(r.useState)(!1),y=Object(r.useCallback)((()=>b((e=>!e))),[]),h=Object(r.useCallback)((()=>v(!1)),[v]),j=Object(r.useCallback)((async i=>{h(),await m(se.m,{deepLinkId:ce.a.case,path:null!=i?Object(ue.a)({id:i.id}):Object(ue.b)()}),t(Object(oe.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:u}))}),[h,t,n,m,a,e,u]),E=Object(r.useCallback)((()=>{y(),m(se.m,{deepLinkId:ce.a.case,path:Object(ue.b)()}).then((()=>{t(Object(oe.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:u.length>0?u:re.d})),t(Object(oe.showTimeline)({id:le.c.active,show:!1}))}))}),[t,n,m,a,e,u,y]),x=Object(r.useCallback)((()=>{y(),v(!0)}),[y,v]),S=Object(r.useMemo)((()=>s.a.createElement(i.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",disabled:l===O.l.draft||c!==O.m.default,"data-test-subj":"timeline-modal-attach-to-case-dropdown-button",onClick:y},T)),[y,l,c]),w=Object(r.useMemo)((()=>[s.a.createElement(i.EuiContextMenuItem,{key:"new-case","data-test-subj":"timeline-modal-attach-timeline-to-new-case",onClick:E},M),s.a.createElement(i.EuiContextMenuItem,{key:"existing-case","data-test-subj":"timeline-modal-attach-timeline-to-existing-case",onClick:x},I)]),[x,E]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiPopover,{button:S,isOpen:f,closePopover:y,panelPaddingSize:"none"},s.a.createElement(i.EuiContextMenuPanel,{items:w})),g&&d.ui.getAllCasesSelectorModal({onRowClick:j,onClose:h,owner:[se.j],permissions:p}))}));de.displayName="AttachToCaseButton";var me=n(271),pe=n.n(me),fe=n(157),be=n(187),ge=n(219);const ve={title:{type:fe.a.TEXT,validations:[{validator:fe.j.emptyField("")}]},description:{type:fe.a.TEXTAREA,validations:[]}},ye=Object(fe.l)({component:fe.b}),he=`${B} (${q})`,je=s.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:n,showWarning:a})=>{const{startTransaction:l}=Object(be.b)(),u=Object(o.useDispatch)(),{isSaving:c,description:d,status:m,title:f,timelineType:b}=Object(o.useSelector)((e=>Object(K.selectTimelineById)(e,n))),[g,v]=Object(r.useState)(!1),y=Object(r.useCallback)((e=>v(e.target.checked)),[]),h=m===O.l.draft,x=pe()(c),S=Object(j.a)({timelineId:le.c.active,timelineType:O.m.default}),w=Object(r.useCallback)(((e,t)=>(t&&(u(p.a.updateTitleAndDescription({id:n,...e})),u(p.a.saveTimeline({id:n,saveAsNew:g}))),Promise.resolve())),[u,n,g]),k=Object(r.useMemo)((()=>({title:f,description:d})),[f,d]),{form:C}=Object(fe.m)({id:"timelineTitleAndDescriptionForm",schema:ve,onSubmit:w,options:{stripEmptyFields:!1},defaultValue:k}),{isSubmitted:T,isSubmitting:M,submit:I}=C,_=Object(r.useCallback)((()=>{l({name:ge.f.SAVE}),I()}),[I,l]),q=Object(r.useCallback)((async()=>{a&&await S(),e()}),[e,S,a]),U=Object(r.useMemo)((()=>m===O.l.draft&&a?b===O.m.template?N:R:z),[a,m,b]),G=Object(r.useMemo)((()=>m===O.l.draft?b===O.m.template?P:A:b===O.m.template?F:A),[m,b]),H=Object(r.useMemo)((()=>m===O.l.draft&&a?b===O.m.template?P:A:D),[a,m,b]),Q=Object(r.useMemo)((()=>(e=>E.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===O.m.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(b)),[b]),W=Object(r.useMemo)((()=>({"aria-label":L,autoFocus:"title"===t,"data-test-subj":"save-timeline-modal-title-input",disabled:c,spellCheck:!0,placeholder:b===O.m.template?re.c:re.d})),[t,c,b]),J=Object(r.useMemo)((()=>({"aria-label":B,"data-test-subj":"save-timeline-modal-description-input",disabled:c,placeholder:re.a})),[c]);return Object(r.useEffect)((()=>{T&&!c&&x&&e()}),[T,c,x,e]),s.a.createElement(i.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},c&&s.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),s.a.createElement(i.EuiModalHeader,{"data-test-subj":"save-timeline-modal-header"},G),s.a.createElement(i.EuiModalBody,null,a&&s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiCallOut,{title:Q,color:"danger",iconType:"warning","data-test-subj":"save-timeline-modal-callout"}),s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(fe.c,{form:C},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(ye,{path:"title",fullWidth:!0,label:V,euiFieldProps:W}),s.a.createElement(i.EuiSpacer,null)),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(ye,{label:he,path:"description",fullWidth:!0,euiFieldProps:J}),s.a.createElement(i.EuiSpacer,null)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiFlexGroup,{direction:"row",alignItems:"center"},h?null:s.a.createElement(i.EuiSwitch,{label:$,checked:g,onChange:y,"data-test-subj":"save-timeline-modal-save-as-new-switch"}),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},s.a.createElement(i.EuiFlexItem,{grow:!1,component:"span"},s.a.createElement(i.EuiButton,{size:"s",fill:!1,onClick:q,isDisabled:c,"data-test-subj":"save-timeline-modal-close-button"},U)),s.a.createElement(i.EuiFlexItem,{grow:!1,component:"span"},s.a.createElement(i.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:c||M,fill:!0,onClick:_,"data-test-subj":"save-timeline-modal-save-button"},H))))))))}));je.displayName="SaveTimelineModal";const Oe=s.a.memo((({timelineId:e})=>{const[t,n]=Object(r.useState)(!1),a=Object(r.useCallback)((()=>n((e=>!e))),[]),{kibanaSecuritySolutionsPrivileges:{crud:l}}=Object(m.a)(),{status:u,isSaving:c}=Object(o.useSelector)((t=>Object(K.selectTimelineById)(t,e))),d=l&&u!==O.l.immutable,p=u===O.l.draft,f=d?null:_;return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiToolTip,{content:f,position:"bottom","data-test-subj":"timeline-modal-save-timeline-tooltip"},s.a.createElement(i.EuiButton,{id:h.a.SAVE_TIMELINE,fill:!0,size:"s",iconType:"save",isLoading:c,disabled:!d,"data-test-subj":"timeline-modal-save-timeline",onClick:a},D)),t&&d?s.a.createElement(je,{initialFocusOn:p?"title":"save",timelineId:e,showWarning:!1,closeSaveTimeline:a}):null)}));Oe.displayName="SaveTimelineButton";const Ee=u.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1lpfyda-0"})(["width:0;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),xe=Object(y.euiStyled)(i.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({theme:e})=>e.eui.euiBorderRadius};
`,Se=s.a.memo((({timelineId:e,openToggleRef:t})=>{const n=Object(o.useDispatch)(),{browserFields:a,indexPattern:l}=Object(X.a)(g.SourcererScopeName.timeline),{cases:u,uiSettings:c}=Object(Y.j)().services,d=Object(r.useMemo)((()=>Object(v.getEsQueryConfig)(c)),[c]),m=u.helpers.canUseCases([W.APP_ID]),f=Object(o.useSelector)((t=>Object(K.selectTitleByTimelineById)(t,e))),b=Object(o.useSelector)((t=>Object(K.selectDataInTimeline)(t,e))),y=Object(o.useSelector)((t=>Object(K.selectKqlQuery)(t,e))),{activeTab:j,dataProviders:O,timelineType:E,filters:x,kqlMode:S}=Object(o.useSelector)((t=>Object(K.selectTimelineById)(t,e))),w=Object(r.useMemo)((()=>Object(Z.d)({config:d,dataProviders:O,indexPattern:l,browserFields:a,filters:x||[],kqlQuery:y,kqlMode:S})),[a,O,d,x,l,S,y]),k=!b||void 0===(null==w?void 0:w.filterQuery),C=Object(r.useCallback)((()=>{null!=t.current&&t.current.focus(),Object(J.a)(),n(p.a.showTimeline({id:e,show:!1}))}),[n,e,t]);return s.a.createElement(xe,{grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-modal-header-panel"},s.a.createElement(we,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(te.a,{timelineId:e,isPartOfGuidedTour:!0})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(ke,{grow:!1,"data-test-subj":"timeline-modal-header-title"},s.a.createElement("h3",null,f))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(ne.a,{timelineId:e})))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiFlexGroup,{id:h.a.ACTION_MENU,justifyContent:"flexEnd",alignItems:"center",gutterSize:"xs",responsive:!1,"data-test-subj":"timeline-modal-header-actions"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(U,{timelineId:e})),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(Q,null)),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(ae.b,{queryId:`${e}-${j}`,inputId:ie.a.timeline,isDisabled:k})),m.create&&m.read?s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiFlexItem,null,s.a.createElement(Ee,null)),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(de,{timelineId:e}))):null,s.a.createElement(i.EuiFlexItem,null,s.a.createElement(Oe,{timelineId:e})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiToolTip,{content:ee("default"===E)},s.a.createElement(i.EuiButtonIcon,{"aria-label":ee("default"===E),iconType:"cross","data-test-subj":"timeline-modal-header-close-button",onClick:C})))))))}));Se.displayName="TimelineModalHeader";var we=u()(i.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1lpfyda-1"})(["",""],{"overflow-x":"auto"}),ke=u()(i.EuiText).withConfig({displayName:"_StyledEuiText",componentId:"sc-1lpfyda-2"})(["",""],{"white-space":"nowrap"}),Ce=n(124),Te=n(191),Me=n(443),Ie=n(119),_e=n.n(Ie),Ae=n(972),Pe=n(767),De=n(914);const Fe=E.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),Re=E.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),Ne=E.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),ze=E.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),Le=E.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),Be=(E.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),E.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"})),qe=E.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var Ve=n(16);const $e=u.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1fs16o3-0"})(["flex:1;"]),Ue=(e,t=s.a.createElement(i.EuiSkeletonText,{lines:10}))=>{var n;const a=s.a.forwardRef(((n,a)=>s.a.createElement(r.Suspense,{fallback:t},s.a.createElement(e,_e()({},n,{ref:a})))));return a.displayName=`${null!==(n=e.displayName)&&void 0!==n?n:"Tab"}WithSuspense`,a},Ge=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(36)]).then(n.bind(null,2115))))),He=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(37)]).then(n.bind(null,2123))))),Qe=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(49)]).then(n.bind(null,2092))))),We=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(66)]).then(n.bind(null,2139))))),Ke=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(38)]).then(n.bind(null,2093))))),Je=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(67)]).then(n.bind(null,2094))))),Ye=Ue(Object(r.lazy)((()=>n.e(64).then(n.bind(null,2119))))),Xe=Object(r.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:i,showTimeline:o})=>{const{isTimelineEsqlEnabledByFeatureFlag:l,isEsqlAdvancedSettingEnabled:u}=Object(Ae.a)(),c=Object(Ce.b)((e=>Object(K.selectTimelineESQLSavedSearchId)(e,a))),d=Object(r.useMemo)((()=>!!l&&(u||null!=c)),[u,l,c]),m=Object(r.useCallback)((e=>{switch(e){case le.d.graph:return s.a.createElement(Qe,{timelineId:a});case le.d.notes:return s.a.createElement(We,{timelineId:a});case le.d.session:return s.a.createElement(Je,{timelineId:a});default:return null}}),[a]),p=Object(r.useMemo)((()=>[le.d.graph,le.d.notes,le.d.session].includes(e)),[e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement($e,{$isVisible:le.d.query===e,"data-test-subj":`timeline-tab-content-${le.d.query}`},s.a.createElement(Ge,{renderCellValue:t,rowRenderers:n,timelineId:a})),o&&d&&e===le.d.esql&&s.a.createElement($e,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${le.d.esql}`},s.a.createElement(Ye,{timelineId:a})),s.a.createElement($e,{$isVisible:le.d.pinned===e,"data-test-subj":`timeline-tab-content-${le.d.pinned}`},s.a.createElement(Ke,{renderCellValue:t,rowRenderers:n,timelineId:a})),i===O.m.default&&s.a.createElement($e,{$isVisible:le.d.eql===e,"data-test-subj":`timeline-tab-content-${le.d.eql}`},s.a.createElement(He,{renderCellValue:t,rowRenderers:n,timelineId:a})),s.a.createElement($e,{$isVisible:p,isOverflowYScroll:e===le.d.session,"data-test-subj":`timeline-tab-content-${le.d.graph}-${le.d.notes}`},p&&m(e)))}));Xe.displayName="ActiveTimelineTab";const Ze=u()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1fs16o3-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),et=u()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1fs16o3-2"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),tt=u()(i.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1fs16o3-3"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),nt=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:l,timelineType:u,graphEventId:c,sessionViewConfig:d,timelineDescription:m})=>{const f=Object(o.useDispatch)(),b=Object(r.useMemo)((()=>Object(De.a)()),[]),g=Object(r.useMemo)((()=>Object(De.g)()),[]),v=Object(r.useMemo)((()=>Object(De.e)()),[]),y=Object(r.useMemo)((()=>Object(De.d)()),[]),h=Object(r.useMemo)((()=>Object(De.c)()),[]),j=Object(r.useMemo)((()=>Object(De.b)()),[]),{isEsqlAdvancedSettingEnabled:E,isTimelineEsqlEnabledByFeatureFlag:x}=Object(Ae.a)(),S=Object(Ce.b)((e=>Object(K.selectTimelineESQLSavedSearchId)(e,n))),w=Object(Ce.b)((e=>b(e,n))),k=Object(Ce.b)((e=>g(e,n))),C=Object(r.useMemo)((()=>!!x&&(E||null!=S)),[E,x,S]),T=Object(Ce.b)((e=>v(e,n))),M=Object(Ce.a)((e=>h(e,n))),I=Object(Ce.a)((e=>j(e,n))),_=Object(Ce.a)((e=>y(e))),A=Object(Ve.b)().isEnterprise(),P=Object(r.useMemo)((()=>{const e=Object.values(I).reduce(((e,t)=>[...e,...t]),[]);return[...M,...e]}),[M,I]),D=Object(r.useMemo)((()=>_.filter((e=>P.includes(e.id))).length+(Object(a.isEmpty)(m)?0:1)),[_,P,m]),F=Object(r.useCallback)((e=>{f(p.a.setActiveTabTimeline({id:n,activeTab:e}))}),[f,n]),R=Object(r.useCallback)((()=>{F(le.d.query)}),[F]),N=Object(r.useCallback)((()=>{F(le.d.eql)}),[F]),z=Object(r.useCallback)((()=>{F(le.d.graph)}),[F]),L=Object(r.useCallback)((()=>{F(le.d.notes)}),[F]),B=Object(r.useCallback)((()=>{F(le.d.pinned)}),[F]),q=Object(r.useCallback)((()=>{F(le.d.session)}),[F]),V=Object(r.useCallback)((()=>{f(Object(oe.initializeTimelineSettings)({id:n})),F(le.d.esql)}),[F,f,n]);return Object(r.useEffect)((()=>{c||w!==le.d.graph||R()}),[w,c,R]),s.a.createElement(s.a.Fragment,null,!l&&s.a.createElement(tt,{className:"eui-scrollBar"},s.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.query}`,onClick:R,isSelected:w===le.d.query,disabled:!1,key:le.d.query},s.a.createElement("span",null,Fe),k&&s.a.createElement(Pe.b,null)),C&&s.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.esql}`,onClick:V,isSelected:w===le.d.esql,disabled:!1,key:le.d.esql},s.a.createElement("span",null,Be)),u===O.m.default&&s.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.eql}`,onClick:N,isSelected:w===le.d.eql,disabled:!1,key:le.d.eql},s.a.createElement("span",null,Re),k&&s.a.createElement(Pe.a,null)),s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${le.d.graph}`,onClick:z,isSelected:w===le.d.graph,disabled:!c,key:le.d.graph},Ne),A&&s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${le.d.session}`,onClick:q,isSelected:w===le.d.session,disabled:null===d,key:le.d.session},qe),s.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.notes}`,onClick:L,isSelected:w===le.d.notes,disabled:u===O.m.template,key:le.d.notes},s.a.createElement("span",null,ze),k&&D>0&&u===O.m.default&&s.a.createElement("div",null,s.a.createElement(Ze,null,D))),s.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.pinned}`,onClick:B,disabled:u===O.m.template,isSelected:w===le.d.pinned,key:le.d.pinned},s.a.createElement("span",null,Le),k&&T>0&&u===O.m.default&&s.a.createElement("div",null,s.a.createElement(Ze,null,T)))),s.a.createElement(Xe,{activeTimelineTab:w,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:u,timelineDescription:m,showTimeline:k}))},at=Object(r.memo)(nt);var it=n(180),rt=n(206),st=n(583),ot=n(48),lt=n(58),ut=n(198),ct=n(148),dt=n(768),mt=n(651);const pt=e=>{var t;const{activeTab:n,switchToTab:a,timelineType:o}=e,{services:{storage:l}}=Object(Y.j)(),u=Object(r.useMemo)((()=>h.b.filter((e=>!e.timelineType||e.timelineType===o))),[o]),[c,d]=Object(r.useState)((()=>{const e=l.get(se.cc.TIMELINE);return null!=e?e:h.c})),m=Object(r.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),p=Object(r.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(r.useEffect)((()=>{l.set(se.cc.TIMELINE,c)}),[c,l]);const f=Object(r.useCallback)((e=>e===u.length?s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:m},mt.h):[s.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:m},mt.g),s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:p},mt.j)]),[m,p,u.length]),b=null===(t=u[c.currentTourStep-1])||void 0===t?void 0:t.anchor,g=Object(dt.a)(b),v=u[c.currentTourStep-1];return null!=v&&v.timelineTab&&v.timelineTab!==n&&a(v.timelineTab),c.isTourActive&&g?s.a.createElement(s.a.Fragment,null,u.map(((e,t)=>{const n=t+1;if(c.currentTourStep!==n)return null;const a={"data-test-subj":`timeline-tour-step-${t+1}`};return s.a.createElement(i.EuiTourStep,{panelProps:a,key:t,step:n,isStepOpen:c.isTourActive&&c.currentTourStep===t+1,minWidth:c.tourPopoverWidth,stepsTotal:u.length,onFinish:m,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:h.c.tourSubtitle,footerAction:f(n)})}))):null},ft=s.a.memo(pt);var bt=n(274);const gt=u.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),vt=u.a.div.withConfig({displayName:"TimelineBody",componentId:"sc-4r2lej-1"})(["height:100%;display:flex;flex-direction:column;"]),yt=Object(r.createContext)({timelineId:null}),ht=({timelineId:e})=>{const t=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]);return Object(Ce.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:f.b).isSaving}))?s.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},jt=s.a.memo(ht),Ot=({renderCellValue:e,rowRenderers:t,timelineId:n,openToggleRef:l})=>{const u=Object(o.useDispatch)(),v=Object(d.a)("unifiedComponentsInTimelineDisabled"),y=Object(r.useRef)(null),h=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),j=Object(o.useSelector)((e=>ct.e.sourcererScopeSelectedPatterns(e,g.SourcererScopeName.timeline))),E=Object(o.useSelector)((e=>ct.e.sourcererScopeSelectedDataViewId(e,g.SourcererScopeName.timeline))),{dataViewId:x,indexNames:S,graphEventId:w,savedObjectId:k,timelineType:C,description:T,sessionViewConfig:M,initialized:I,show:_,isLoading:A,activeTab:P}=Object(Ce.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=h(e,n))&&void 0!==t?t:f.b)})),{kibanaSecuritySolutionsPrivileges:{crud:D}}=Object(m.a)(),{timelineFullScreen:F}=Object(rt.c)();Object(r.useEffect)((()=>{k||I||u(p.a.createTimeline({id:n,columns:v?b.b:bt.a,dataViewId:E,indexNames:j,show:!1,excludedRowRendererIds:v?[]:f.b.excludedRowRendererIds}))}),[]);const R=Object(r.useCallback)((()=>{!k||null==E||null===x&&0===S.length||x===E&&S.sort().join()===j.sort().join()||u(p.a.updateDataView({dataViewId:E,id:n,indexNames:j}))}),[u,k,E,x,j,S,n]);Object(r.useEffect)((()=>{R()}),[E,j]);const N=Object(r.useCallback)((()=>{var e;const t=null===(e=y.current)||void 0===e?void 0:e.querySelector(st.a);var n,a;null!=t?t.focus():null===(n=y.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[y]),z=Object(r.useCallback)((()=>{var e,t;null===(e=y.current)||void 0===e||null===(t=e.querySelector(`.${Te.c}`))||void 0===t||t.focus()}),[y]),L=Object(r.useCallback)((e=>{Object(c.isTab)(e)&&Object(Te.k)({containerElement:y.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:N,onSkipFocusAfterEventsTable:z})}),[y,N,z]),B=Object(r.useMemo)((()=>({timelineId:n})),[n]),q=(()=>{const{search:e,pathname:t}=Object(ot.useLocation)(),{spaces:n}=Object(Y.j)().services,a=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:l,show:u,graphEventId:c,activeTab:d}=Object(Ce.a)((e=>{var t;return null!==(t=a(e,le.c.active))&&void 0!==t?t:f.b})),m=Object(r.useCallback)((()=>{var a,r,m;const p=new URLSearchParams(e),f=null!==(a=p.get(ut.a.timeline))&&void 0!==a?a:void 0,b={id:null!=l?l:"",isOpen:!!u,activeTab:d,graphEventId:c},g=null!==(r=Object(lt.safeDecode)(null!=f?f:""))&&void 0!==r?r:b,v=null==g?void 0:g.id;if(!n||"conflict"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id)||null==v)return null;const y=null!==(m=null==o?void 0:o.alias_target_id)&&void 0!==m?m:"",h={...g,id:y},j=Object(lt.encode)(h);p.set(ut.a.timeline,j);const O=`${t}?${p.toString()}${window.location.hash}`;return s.a.createElement(s.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:ut.a.timeline,currentObjectId:v,otherObjectId:y,otherObjectPath:O}),s.a.createElement(i.EuiSpacer,null))}),[d,c,t,null==o?void 0:o.alias_target_id,null==o?void 0:o.outcome,l,e,u,n]);return Object(r.useMemo)((()=>m()),[m])})(),V=_&&!A&&D,$=Object(r.useCallback)((e=>{u(p.a.setActiveTabTimeline({id:n,activeTab:e}))}),[n,u]);return s.a.createElement(yt.Provider,{value:B},s.a.createElement(it.B,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:L,ref:y},s.a.createElement(jt,{timelineId:n}),s.a.createElement(vt,{"data-test-subj":"timeline-body"},C===O.m.template&&s.a.createElement(gt,{className:"timeline-template-badge"},Me.f),q,s.a.createElement(it.y,{$isVisible:!F,"data-test-subj":"timeline-hide-show-container"},s.a.createElement(Se,{timelineId:n,openToggleRef:l})),s.a.createElement(at,{graphEventId:w,sessionViewConfig:M,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:C,timelineDescription:T,timelineFullScreen:F}))),V?s.a.createElement(ft,{activeTab:P,switchToTab:$,timelineType:C}):null)};Ot.displayName="StatefulTimelineComponent";const Et=s.a.memo(Ot)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return w}));var a=n(2),i=n(4),r=n(19),s=n(1093),o=n(301);const l=new WeakMap;var u=n(52),c=n.n(u),d=n(480),m=n(43);function p({useTopLevelObjectColumns:e,row:t,columnId:n,dataView:o,shouldShowFieldHandler:u,maxEntries:p,isPlainRecord:f,fieldFormats:b,dataTestSubj:g="discoverCellDescriptionList",className:v}){const y=e?function(e,t,n,a){var i;const r=Object(d.b)(e.fields,t),s=null!==(i=e.highlight)&&void 0!==i?i:{},o=[],l=[];return Object.entries(r).forEach((([t,i])=>{var r;const u=n.getFieldByName(t),c=n.fields.getByName?null===(r=n.fields.getByName(t))||void 0===r?void 0:r.displayName:void 0,d=u?n.getFormatterForField(u):{convert:(e,...t)=>String(e)},m=i.map((t=>d.convert(t,"html",{field:u,hit:e}))).join(", "),p=s[t]?o:l;c?a(c)&&p.push([c,m,t]):p.push([t,m,t])})),[...o,...l]}(t.raw,n,o,u).slice(0,p):function(e,t,n,a,r){var o;const u=l.get(e.raw);if(u&&u.maxEntries===a)return u.formattedHit;const c=null!==(o=e.raw.highlight)&&void 0!==o?o:{},d=e.flattened,m=[],p=[];Object.entries(d).forEach((([a,i])=>{const o=t.fields.getByName(a),l=null==o?void 0:o.displayName,u=c[a]?m:p,d=Object(s.a)(i,e.raw,r,t,o);l?n(a)&&u.push([l,d,a]):u.push([a,d,a])}));const f=[...m,...p],b=f.length<=a?f:[...f.slice(0,a),[i.i18n.translate("discover.formatHit.moreFields",{defaultMessage:"and {count} more {count, plural, one {field} other {fields}}",values:{count:f.length-a}}),"",null]];return l.set(e.raw,{formattedHit:b,maxEntries:a}),b}(t,o,u,p,b);return Object(m.jsx)(r.EuiDescriptionList,{type:"inline",compressed:!0,className:c()("unifiedDataTable__descriptionList","unifiedDataTable__cellValue",v),"data-test-subj":g},y.map((([e,n,i])=>{var s;return f&&i&&null===(null!==(s=t.flattened[i])&&void 0!==s?s:null)?null:Object(m.jsx)(a.Fragment,{key:e},Object(m.jsx)(r.EuiDescriptionListTitle,{className:"unifiedDataTable__descriptionListTitle"},e),Object(m.jsx)(r.EuiDescriptionListDescription,{className:"unifiedDataTable__descriptionListDescription",dangerouslySetInnerHTML:{__html:n}}))})))}n(654);var f=n(93),b=n(94);const g=i.i18n.translate("unifiedDataTable.json.codeEditorAriaLabel",{defaultMessage:"Read only JSON view of an elasticsearch document"}),v=i.i18n.translate("unifiedDataTable.json.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),y=({jsonValue:e,width:t,height:n,hasLineNumbers:a,onEditorDidMount:i,hideCopyButton:s})=>{if(""===e)return null;const o=Object(m.jsx)(b.CodeEditor,{languageId:f.XJsonLang.ID,width:t,height:n,value:e||"",editorDidMount:i,"aria-label":g,options:{automaticLayout:!0,fontSize:12,lineNumbers:a?"on":"off",minimap:{enabled:!1},overviewRulerBorder:!1,readOnly:!0,scrollbar:{alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent"}});return s?o:Object(m.jsx)(r.EuiFlexGroup,{className:"unifiedDataTableJsonEditor",direction:"column",gutterSize:"s"},Object(m.jsx)(r.EuiFlexItem,null,Object(m.jsx)(r.EuiSpacer,{size:"s"}),Object(m.jsx)("div",{className:"eui-textRight"},Object(m.jsx)(r.EuiCopy,{textToCopy:e},(e=>Object(m.jsx)(r.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},v))))),Object(m.jsx)(r.EuiFlexItem,null,o))};function h({json:e,width:t,height:n,hasLineNumbers:a}){const i=JSON.stringify(e,null,2);return Object(m.jsx)(y,{jsonValue:i,width:t,height:n,hasLineNumbers:a,onEditorDidMount:()=>{},hideCopyButton:!0})}var j=n(225);function O(e,t,n){return n?Object(d.b)(t.raw.fields,e):t.raw}var E=({closeButton:e,columnId:t,row:n,useTopLevelObjectColumns:a,dataTestSubj:i="dataTableExpandCellActionJsonPopover"})=>Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"none",direction:"column",justifyContent:"flexEnd",className:"unifiedDataTable__cellPopover","data-test-subj":i},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",responsive:!1},Object(m.jsx)(r.EuiFlexItem,{grow:!1},e))),Object(m.jsx)(r.EuiFlexItem,null,Object(m.jsx)(h,{json:O(t,n,a),width:j.f,height:200})));const x=({children:e})=>Object(m.jsx)("span",{className:"unifiedDataTable__cellPopoverValue eui-textBreakWord"},e),S="unifiedDataTable__cellValue",w=({dataView:e,rows:t,useNewFieldsApi:n,shouldShowFieldHandler:l,closePopover:u,fieldFormats:c,maxEntries:d,externalCustomRenderers:f,isPlainRecord:b})=>function({rowIndex:g,columnId:v,isDetails:y,setCellProps:h,colIndex:j,isExpandable:O,isExpanded:w}){const k=t?t[g]:void 0,C=e.fields.getByName(v),T=Object(a.useContext)(o.a);if(Object(a.useEffect)((()=>{null!=k&&k.isAnchor?h({className:"unifiedDataTable__cell--highlight"}):T.expanded&&k&&T.expanded.id===k.id?h({className:"unifiedDataTable__cell--expanded"}):h({style:void 0})}),[T,k,h]),void 0===k)return Object(m.jsx)("span",{className:S},"-");if(f&&f[v])return Object(m.jsx)("span",{className:S},f[v]({rowIndex:g,columnId:v,isDetails:y,setCellProps:h,isExpandable:O,isExpanded:w,colIndex:j,row:k,dataView:e,fieldFormats:c,closePopover:u}));const M=Boolean(n&&!C&&(null==k?void 0:k.raw.fields)&&!k.raw.fields[v]);return y?function({row:e,field:t,columnId:n,dataView:a,useTopLevelObjectColumns:o,fieldFormats:l,closePopover:u}){const c=Object(m.jsx)(r.EuiButtonIcon,{"aria-label":i.i18n.translate("unifiedDataTable.grid.closePopover",{defaultMessage:"Close popover"}),"data-test-subj":"docTableClosePopover",iconSize:"s",iconType:"cross",size:"xs",onClick:u});return o||"_source"===(null==t?void 0:t.type)?Object(m.jsx)(E,{row:e,columnId:n,useTopLevelObjectColumns:o,closeButton:c}):Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"none",direction:"row",responsive:!1,"data-test-subj":"dataTableExpandCellActionPopover"},Object(m.jsx)(r.EuiFlexItem,null,Object(m.jsx)(x,null,Object(m.jsx)("span",{dangerouslySetInnerHTML:{__html:Object(s.a)(e.flattened[n],e.raw,l,a,t)}}))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},c))}({row:k,field:C,columnId:v,dataView:e,useTopLevelObjectColumns:M,fieldFormats:c,closePopover:u}):"_source"===(null==C?void 0:C.type)||M?Object(m.jsx)(p,{useTopLevelObjectColumns:M,row:k,dataView:e,columnId:v,fieldFormats:c,shouldShowFieldHandler:l,maxEntries:d,isPlainRecord:b}):Object(m.jsx)("span",{className:S,dangerouslySetInnerHTML:{__html:Object(s.a)(k.flattened[v],k.raw,c,e,C)}})}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return y}));var a=n(2),i=n(45),r=n(68),s=n(57),o=n(719),l=n.n(o),u=n(582);const c={byId:{},needsSync:!1},d=Object(r.createReducer)(c,(e=>{e.addCase(u.f,((e,{payload:{preview:t,left:n,right:a,id:i}})=>{i in e.byId?(e.byId[i].right=a,e.byId[i].left=n,e.byId[i].preview=t?[t]:void 0):e.byId[i]={left:n,right:a,preview:t?[t]:void 0},e.needsSync=!0})),e.addCase(u.e,((e,{payload:{left:t,id:n}})=>{n in e.byId?e.byId[n].left=t:e.byId[n]={left:t,right:void 0,preview:void 0},e.needsSync=!0})),e.addCase(u.h,((e,{payload:{right:t,id:n}})=>{n in e.byId?e.byId[n].right=t:e.byId[n]={right:t,left:void 0,preview:void 0},e.needsSync=!0})),e.addCase(u.g,((e,{payload:{preview:t,id:n}})=>{if(n in e.byId)if(e.byId[n].preview){var a,i;l()(t,null===(a=e.byId[n].preview)||void 0===a?void 0:a.at(-1))||null===(i=e.byId[n].preview)||void 0===i||i.push(t)}else e.byId[n].preview=t?[t]:void 0;else e.byId[n]={right:void 0,left:void 0,preview:t?[t]:void 0};e.needsSync=!0})),e.addCase(u.i,((e,{payload:{id:t}})=>{var n;t in e.byId&&(null===(n=e.byId[t].preview)||void 0===n||n.pop()),e.needsSync=!1})),e.addCase(u.b,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0,e.byId[t].left=void 0,e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(u.a,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].left=void 0),e.needsSync=!0})),e.addCase(u.d,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0),e.needsSync=!0})),e.addCase(u.c,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(u.j,((e,{payload:{preview:t,left:n,right:a,id:i}})=>{i in e.byId?(e.byId[i].right=a,e.byId[i].left=n,e.byId[i].preview=t?[t]:void 0):e.byId[i]={right:a,left:n,preview:t?[t]:void 0},e.needsSync=!1}))})),m=Object(r.configureStore)({reducer:d,devTools:!1,enhancers:[]}),p=Object(a.createContext)({store:m,storeState:c}),f=Object(i.createDispatchHook)(p),b=Object(i.createSelectorHook)(p),g=e=>e,v=e=>Object(s.createSelector)(g,(t=>t.byId[e]||{})),y=()=>Object(s.createSelector)(g,(e=>e.needsSync))},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(19),i=n(444),r=n(2),s=n.n(r),o=n(41),l=n.n(o),u=n(60),c=n.n(u),d=n(5),m=n(134),p=n(118),f=n(769),b=n(356);const g=l()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),v=s.a.memo((({value:e})=>Object(b.a)(e)?s.a.createElement(s.a.Fragment,null,e):s.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},f.c)));v.displayName="ValueWrapper";const y=({legendItem:e})=>{const[t]=Object(p.o)(d.W),{color:n,count:i,dataProviderId:r,field:o,scopeId:l,value:u}=e;return s.a.createElement(a.EuiText,{size:"xs"},s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(m.b,{"data-test-subj":`legend-item-${r}`,field:o,hideTopN:!0,id:r,isDraggable:!1,scopeId:l,value:u},null==e.render?s.a.createElement(v,{value:u}):e.render({field:o,value:u}))),null!=i&&s.a.createElement(g,{"data-test-subj":"legendItemCount",grow:!1},c()(i).format(t))))))};y.displayName="DraggableLegendItemComponent";const h=s.a.memo(y),j=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),O=({className:e,height:t=0,legendItems:n,minWidth:i=165})=>0===n.length?null:s.a.createElement(j,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},s.a.createElement(a.EuiText,{size:"xs"},s.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>s.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},s.a.createElement(h,{legendItem:e}),s.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));O.displayName="DraggableLegendComponent";const E=s.a.memo(O)},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(44),i=n(2);const r={pageName:n(156).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},s=Object(i.createContext)([r,()=>a.noop])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(68);const i=Object(a.createSelector)([e=>e.dataViewPicker],(e=>({loading:"loading"===e.state,dataViewId:e.dataView.id||"",patternList:e.patternList,indicesExist:!0,browserFields:{},activePatterns:e.patternList,runtimeMappings:{},selectedPatterns:e.patternList,indexPattern:{fields:[],title:e.dataView.title||""},sourcererDataView:{}})))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.createContext)(null)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],r=t[1],s=i.useMemo((function(){return{set:function(e,t){r((function(n){var i;return a.__assign(a.__assign({},n),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var n=t,i=e;return n[i],a.__rest(n,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),o=a.__assign({get:i.useCallback((function(e){return n[e]}),[n])},s);return[n,o]}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(41);const s=n.n(r).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(r.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));s.displayName="Wrapper";const o=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));o.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(s,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(o,{key:t},e))):i.a.createElement(o,null,e))));l.displayName="Subtitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(119),i=n.n(a),r=n(41),s=n.n(r),o=n(2),l=n.n(o),u=n(19);const c=s()((({loading:e,...t})=>l.a.createElement(u.EuiPanel,i()({},t,{hasBorder:!0})))).withConfig({displayName:"Panel",componentId:"sc-h09jgf-0"})(["position:relative;",""],(({loading:e})=>e&&"\n    overflow: hidden;\n  "));c.displayName="Panel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(45),i=n(1269);const r=e=>{const t=Object(a.useSelector)((t=>Object(i.sourcererScopeSelectedDataViewId)(t,e)));return null!=t?t:void 0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return h}));var a=n(44),i=n(2),r=n(45),s=n(4),o=n(122),l=n(250),u=n(123),c=n(132),d=n(166),m=n(184),p=n(213),f=n(191),b=n(906),g=n(127);const v="createRuleFromTimeline",y="createRuleFromEql",h=e=>{const t=Object(r.useDispatch)(),{addError:n}=Object(u.a)(),{browserFields:h,dataViewId:j,selectedPatterns:O}=Object(c.a)(g.SourcererScopeName.timeline),E=Object(o.a)("unifiedComponentsInTimelineDisabled"),x=Object(i.useRef)(!1),[S,w]=Object(i.useState)(null),[k,C]=Object(i.useState)(!1),T=Object(i.useCallback)((e=>{C(!0),w(e),e.dataViewId===j||Object(a.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[j,t]),[M]=Object(i.useState)({dataViewId:j,selectedPatterns:O}),I=Object(i.useMemo)((()=>null==S||Object(a.isEmpty)(h)||null!==S.dataViewId&&null!==j&&j!==S.dataViewId?null:h),[h,j,S]),_=Object(p.g)(v),A=Object(i.useMemo)(_,[_]),P=Object(p.g)(y),D=Object(i.useMemo)(P,[P]),F=Object(i.useCallback)((()=>{if(null!=S&&null!=I){try{const t=()=>{var e,t,n,a,i,r,s;return{dataProviders:null!=S.dataProviders&&S.dataProviders.length>0?Object(l.f)(Object(f.f)(S.dataProviders,I),{fields:[],title:O.join(",")}):"",query:{query:null!==(e=null===(t=S.kqlQuery.filterQuery)||void 0===t||null===(n=t.kuery)||void 0===n?void 0:n.expression)&&void 0!==e?e:"",language:null!==(a=null===(i=S.kqlQuery.filterQuery)||void 0===i||null===(r=i.kuery)||void 0===r?void 0:r.kind)&&void 0!==a?a:"kuery"},filters:null!==(s=S.filters)&&void 0!==s?s:[],eqlOptions:{}}},n=()=>{var e;return{dataProviders:"",query:{query:null!==(e=S.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:S.eqlOptions}}},a=x.current?n():t();C(!1),e({index:O,queryBar:{filters:""!==a.dataProviders?[...a.filters,Object(b.b)(a.dataProviders)]:a.filters,query:a.query,saved_id:null},...a.eqlOptions})}catch(e){C(!1),n(e,{toastMessage:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:S.id}}),title:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}x.current=!1,M.dataViewId!==j&&t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:M.dataViewId,selectedPatterns:M.selectedPatterns}))}}),[n,j,t,M.dataViewId,M.selectedPatterns,I,O,S,e]);Object(i.useEffect)((()=>{null!=I&&F()}),[F,I]);const R=Object(m.g)(),N=Object(i.useCallback)((e=>{null!=S&&e===S.id||R({timelineId:e,onOpenTimeline:T,unifiedComponentsInTimelineDisabled:E})}),[T,R,S,E]),[z,L]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{if(!z){let e=null;null!=A?e=A:null!=D&&(e=D,x.current=!0),null!=e&&(L(!0),N(e),C(!0))}}),[N,A,D,z]),{loading:k,onOpenTimeline:T}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return j}));var a=n(44),i=n(2),r=n.n(i),s=n(45),o=n(53),l=n(448),u=n.n(l),c=n(138),d=n(132),m=n(127),p=n(250),f=n(579),b=n(971),g=n(191),v=n(129);const y=u.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,h=Object(i.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:o,fromStr:l,kqlMode:u,isRefreshPaused:h,savedQueryId:O,setSavedQueryId:E,refreshInterval:x,timelineId:S,to:w,toStr:k,updateReduxTime:C})=>{const T=Object(s.useDispatch)(),[M,I]=Object(i.useState)(null!=l?l:new Date(o).toISOString()),[_,A]=Object(i.useState)(null!=k?k:new Date(w).toISOString()),{browserFields:P,indexPattern:D}=Object(d.a)(m.SourcererScopeName.timeline),[F,R]=Object(i.useState)(void 0),[N,z]=Object(i.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),L=Object(i.useMemo)((()=>Object(g.i)(t)),[t]),[B,q]=Object(i.useState)(Object(p.f)(Object(g.f)(e,P),D)),V=Object(f.a)(),$=Object(i.useCallback)(((e,t)=>T(v.a.applyKqlFilterQuery({id:S,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(p.f)(e,D)}}))),[T,D,S]);Object(i.useEffect)((()=>{z({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(i.useEffect)((()=>{q(Object(p.f)(Object(g.f)(e,P),D))}),[e,P,D]),Object(i.useEffect)((()=>{null!=l&&null!=k?(I(l),A(k)):null!=o&&null!=w&&(I(new Date(o).toISOString()),A(new Date(w).toISOString()))}),[o,l,w,k]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=O&&null!=V)try{const n=await V.getSavedQuery(O);e&&null!=n&&R({...n,attributes:{...n.attributes,filters:Object(g.i)(t)}})}catch(e){R(void 0)}else e&&R(void 0)}(),()=>{e=!1}}),[O]);const U=Object(i.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&$(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");C({id:c.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:S,hasRangeChanged:!0})}}),[a,S]),G=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==O&&E(e.id),null!=V&&""!==B){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===g.e)):-1;V.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),j(B),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,j(B)]:[]})}}else E(null)}),[B,O,V]);return r.a.createElement(y,{className:"search_bar_container"},r.a.createElement(b.a,{dateRangeFrom:M,dateRangeTo:_,hideSavedQuery:"search"===u,indexPattern:D,isRefreshPaused:h,filterQuery:N,filterManager:n,filters:L,onSubmitQuery:U,refreshInterval:x,savedQuery:F,onSavedQuery:G,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),j=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:g.e,controlledBy:g.e,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:o.FilterStateStore.APP_STATE}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(19),i=n(2),r=n.n(i),s=n(41);const o=n.n(s)()((({iconSide:e,children:t,...n})=>r.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(s.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(s.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(s.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));o.displayName="Link";const l=r.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:s,disabled:l,href:u,iconSide:c="left",iconSize:d="s",iconType:m,onClick:p})=>{const f=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?f(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),b=Object(i.useMemo)((()=>e||f(t)),[e,t,f]);return r.a.createElement(o,{className:"siemLinkIcon",color:n,"data-test-subj":s,disabled:l,href:u,iconSide:c,onClick:p,"aria-label":b},r.a.createElement(a.EuiIcon,{size:d,type:m}),r.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(19),i=n(44),r=n(2),s=n.n(r),o=n(41),l=n.n(o),u=n(121),c=n(747),d=n(184),m=n(163),p=n(130),f=n(443),b=n(137);const g=l()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),v=l()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),y=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:o,timelineType:l,placeholder:y})=>{const[h,j]=Object(r.useState)(50),[O,E]=Object(r.useState)(0),[x,S]=Object(r.useState)(""),[w,k]=Object(r.useState)(!1),{fetchAllTimeline:C,timelines:T,loading:M,totalCount:I}=Object(c.b)(),_=Object(r.useRef)(null),A=Object(r.useRef)(null),P=Object(r.useMemo)((()=>Object(i.debounce)(500,S)),[]),D=Object(r.useCallback)((e=>{P(e)}),[P]),F=Object(r.useCallback)((()=>{k(!w)}),[w]),R=Object(r.useCallback)(((e,t,n)=>{if(e<t&&_.current&&A.current){const e=_.current.clientHeight,t=A.current.clientHeight;n>10&&t-n<1.2*e&&t>O&&(E(t),j(h+50))}}),[O,h]),N=Object(r.useCallback)(((e,t)=>{const n=Object(d.e)({...e,title:e.timelineTitle})?m.Z:e.timelineTitle,r=null!=e.description&&e.description.trim().length>0?e.description:null;return s.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),s.a.createElement(g,{grow:!0},s.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},s.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},s.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(a.EuiHighlight,{search:t},n))),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(a.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},s.a.createElement("small",null,null!=r?r:Object(p.d)())))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),z=Object(r.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&o(Object(i.isEmpty)(t[0].timelineTitle)?m.Z:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,o]),L=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,t,e)),[]),B=Object(r.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=y?y:f.e(l),onSearch:D,incremental:!1,append:s.a.createElement(v,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:w,onClick:F},m.D)})),[F,D,w,l,y]),q=Object(r.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>R((null!=T?T:[]).filter((t=>!e||""!==t.title)).length,I,t),outerRef:_,innerRef:A}})),[R,e,I,T]);return Object(r.useEffect)((()=>{C({pageInfo:{pageIndex:1,pageSize:h},search:x,sort:{sortField:u.g.updated,sortOrder:b.b.desc},onlyUserFavorite:w,status:null,timelineType:l})}),[C,w,h,x,l]),s.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:M&&null==T,listProps:q,renderOption:N,onChange:z,searchable:!0,searchProps:B,singleSelection:!0,options:(V=t({timelines:null!=T?T:[],onlyFavorites:w,searchTimelineValue:x,timelineType:l}),V.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},L);var V},h=Object(r.memo)(y)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(57),i=n(129);const r=()=>Object(a.createSelector)(i.b.selectTimeline,(e=>{var t,n;return{createdBy:e.createdBy,expandedDetail:null!==(t=e.expandedDetail)&&void 0!==t?t:{},eventIdToNoteIds:null!==(n=null==e?void 0:e.eventIdToNoteIds)&&void 0!==n?n:{},noteIds:e.noteIds,status:e.status}}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="memory"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(19),s=n(121),o=n(163),l=n(292);const u=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[u,c]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===s.m.template),[e]),m=Object(a.useMemo)((()=>d?u:null),[u,d]),p=Object(a.useMemo)((()=>null==m?null:m===s.h.elastic?s.l.immutable:s.l.active),[m]),f=Object(a.useMemo)((()=>[{id:s.h.elastic,name:o.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:s.h.custom,name:o.r,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),b=Object(a.useCallback)((e=>{c(u===e?null:e)}),[c,u]),g=Object(a.useMemo)((()=>d?f.map((e=>i.a.createElement(r.EuiFilterButton,{hasActiveFilters:e.id===m,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:b.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[m,f,d,b]),v=Object(a.useCallback)((async()=>{m!==s.h.custom&&await Object(l.g)()}),[m]);return{timelineStatus:p,templateTimelineType:m,templateTimelineFilter:g,installPrepackagedTimelines:v}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(45),s=n(19),o=n(4),l=n(169),u=n(129),c=n(121),d=n(365);const m=o.i18n.translate("xpack.securitySolution.timeline.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),p=o.i18n.translate("xpack.securitySolution.timeline.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),f=i.a.memo((({timelineId:e,isPartOfGuidedTour:t=!1})=>{const n=Object(r.useDispatch)(),{isFavorite:o,status:f}=Object(r.useSelector)((t=>Object(l.selectTimelineById)(t,e))),b=f!==c.l.active,g=o?p:m,v=Object(a.useCallback)((()=>n(u.a.updateIsFavorite({id:e,isFavorite:!o}))),[n,e,o]);return i.a.createElement(s.EuiButtonIcon,{id:t?d.a.ADD_TO_FAVORITES:void 0,iconType:o?"starFilled":"starEmpty",isSelected:o,disabled:b,"aria-label":g,title:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,onClick:v},g)}));f.displayName="AddToFavoritesButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(19),s=n(44),o=n(4),l=n(129),u=n(158),c=n(124),d=n(121);const m=o.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedLabel",{defaultMessage:"Unsaved"}),p=o.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedChangesLabel",{defaultMessage:"Unsaved changes"}),f=i.a.memo((({timelineId:e})=>{const t=Object(a.useMemo)((()=>l.b.getTimelineByIdSelector()),[]),{changed:n=!1,status:o,updated:f}=Object(c.a)((n=>{var a;return Object(s.pick)(["changed","status","updated"],null!==(a=t(n,e))&&void 0!==a?a:u.b)}));let b;return o!==d.l.draft&&f?n&&(b=i.a.createElement(r.EuiBadge,{color:"warning"},p)):b=i.a.createElement(r.EuiBadge,{color:"warning"},m),b?i.a.createElement(r.EuiText,{size:"xs","data-test-subj":"timeline-save-status"},b):null}));f.displayName="TimelineSaveStatus"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return p}));var a=n(57),i=n(146),r=n(1268),s=n(169);const o=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.d.query})),l=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),u=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),c=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),m=()=>Object(a.createSelector)(r.selectNotesById,(e=>Object.values(e))),p=()=>Object(a.createSelector)(s.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(19),s=n(42),o=n(56);const l={tall:490,short:250},u=Object(a.createContext)({tableId:null}),c=({height:e="tall"})=>i.a.createElement(r.EuiPanel,{color:"subdued"},i.a.createElement(r.EuiFlexGroup,{style:{height:l[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},m=()=>{const{http:e}=Object(o.useKibana)().services;return i.a.createElement(r.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPanel,{hasBorder:!0,style:d},i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTitle,null,i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(19),i=n(78),r=n(2),s=n.n(r),o=n(41),l=n.n(o),u=n(414),c=n(138),d=n(474),m=n(447),p=n(658),f=n(267),b=n(282),g=n(625),v=n(127);const y=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),h=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:n,extraOptions:o,getLensAttributes:l,inputId:h=c.a.global,inspectIndex:j=0,isInspectButtonDisabled:O,isMultipleQuery:E,lensAttributes:x,onCloseInspect:S,queryId:w,timerange:k,title:C,scopeId:T=v.SourcererScopeName.default,stackByField:M,withActions:I=g.a,casesAttachmentMetadata:_})=>{const[A,P]=Object(r.useState)(!1),[D,F]=Object(r.useState)(!1),R=Object(r.useCallback)((()=>{P(!A)}),[A]),N=()=>{P(!1)},z=Object(p.a)({applyGlobalQueriesAndFilters:e,extraOptions:o,getLensAttributes:l,lensAttributes:x,scopeId:T,stackByField:M,title:""}),L=`stat-${w}`,B=Object(r.useCallback)((()=>{N(),F(!0)}),[]),q=Object(r.useCallback)((()=>{F(!1),S&&S()}),[S]),{additionalRequests:V,additionalResponses:$,handleClick:U,handleCloseModal:G,isButtonDisabled:H,request:Q,response:W}=Object(m.a)({inputId:h,inspectIndex:j,isDisabled:O,multiple:E,onCloseInspect:q,onClick:B,queryId:w}),K=Object(r.useMemo)((()=>({handleInspectClick:U,isInspectButtonDisabled:H})),[H,U]),J=Object(g.d)({attributes:z,extraActions:n,inspectActionProps:K,timeRange:k,withActions:I,lensMetadata:_}),Y=Object(u.useAsync)((()=>Object(i.buildContextMenuForActions)({actions:J.map((e=>({action:e,context:{},trigger:g.c})))})),[J]),X=Object(r.useMemo)((()=>s.a.createElement(a.EuiButtonIcon,{"aria-label":f.l,className:b.a,"data-test-subj":L,iconType:"boxesHorizontal",onClick:R})),[L,R]);return s.a.createElement(y,{className:t},Y.value&&Y.value.length>0&&s.a.createElement(a.EuiPopover,{button:X,isOpen:A,closePopover:N,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},s.a.createElement(a.EuiContextMenu,{"data-test-subj":"viz-actions-panel",size:"s",panels:Y.value})),D&&null!==Q&&null!==W&&s.a.createElement(d.a,{additionalRequests:V,additionalResponses:$,closeModal:G,inputId:h,request:Q,response:W,title:C}))};h.displayName="VisualizationActionsComponent";const j=s.a.memo(h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"f",(function(){return h}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.addToCaseSuccessToast",{defaultMessage:"Successfully added data quality results to the case"}),r=(a.i18n.translate("xpack.securitySolution.dataQualityDashboard.betaBadge",{defaultMessage:"Beta"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseCold",{defaultMessage:"cold"})),s=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.pageTitle",{defaultMessage:"Data Quality"}),o=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.datePicker.tooltip",{defaultMessage:"Data quality checks are ran on data that was ingested during the Search Boost window. The default window range is 7 days."}),l=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.elasticCommonSchemaReferenceLink",{defaultMessage:"Elastic Common Schema (ECS)"}),u=(a.i18n.translate("xpack.securitySolution.overview.eventsTitle",{defaultMessage:"Event count"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseFrozen",{defaultMessage:"frozen"})),c=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseHot",{defaultMessage:"hot"}),d=a.i18n.translate("xpack.securitySolution.overview.newsFeedSidebarTitle",{defaultMessage:"Security news"}),m=a.i18n.translate("xpack.securitySolution.overview.recentTimelinesSidebarTitle",{defaultMessage:"Recent timelines"}),p=a.i18n.translate("xpack.securitySolution.overview.signalCountTitle",{defaultMessage:"Alert trend"}),f=e=>a.i18n.translate("xpack.securitySolution.overview.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}),b=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseUnmanaged",{defaultMessage:"unmanaged"}),g=a.i18n.translate("xpack.securitySolution.overview.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),v=a.i18n.translate("xpack.securitySolution.overview.viewEventsButtonLabel",{defaultMessage:"View events"}),y=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseWarm",{defaultMessage:"warm"}),h=a.i18n.translate("xpack.securitySolution.detectionResponse.pageTitle",{defaultMessage:"Detection & Response"});a.i18n.translate("xpack.securitySolution.entityAnalytics.technicalPreviewLabel",{defaultMessage:"Technical Preview"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={SYSTEM_PROMPT_SELECTOR:"systemPromptSelector",CONVERSATIONS_MULTISELECTOR:"conversationMultiSelector",ADD_SYSTEM_PROMPT:"addSystemPrompt",PROMPT_SUPERSELECT:"promptSuperSelect",CONVERSATIONS_MULTISELECTOR_OPTION:e=>`conversationMultiSelectorOption-${e}`,SETTINGS_MODAL:"settingsModal",SYSTEM_PROMPT_MODAL:{ID:"systemPromptModal",PROMPT_TEXT:"systemPromptModalPromptText",TOGGLE_ALL_DEFAULT_CONVERSATIONS:"systemPromptModalToggleDefaultConversations",SAVE:"systemPromptModalSave",CANCEL:"systemPromptModalCancel"}}},function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"l",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"m",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"i",(function(){return g})),n.d(t,"e",(function(){return v}));var a=n(4);const i=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAriaLabel",{defaultMessage:"Settings"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsTooltip",{defaultMessage:"Settings"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.settings.securityAiSettingsTitle",{defaultMessage:"Security AI settings"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsUpdatedToastTitle",{defaultMessage:"Settings updated"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConnectorsMenuItemTitle",{defaultMessage:"Connectors"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConversationsMenuItemTitle",{defaultMessage:"Conversations"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsQuickPromptsMenuItemTitle",{defaultMessage:"Quick Prompts"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsSystemPromptsMenuItemTitle",{defaultMessage:"System Prompts"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAnonymizationMenuItemTitle",{defaultMessage:"Anonymization"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsKnowledgeBaseMenuItemTitle",{defaultMessage:"Knowledge Base"}),f=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsEvaluationMenuItemTitle",{defaultMessage:"Evaluation"}),b=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.modalTitle",{defaultMessage:"System Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"})),g=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"}),v=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slDeleteButtonTitle",{defaultMessage:"Delete"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsTitle",{defaultMessage:"System Prompts"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsDescription",{defaultMessage:"Create and manage System Prompts. System Prompts are configurable chunks of context that are always sent for a given conversation."}),s=(a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.modalTitle",{defaultMessage:"System Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.nameLabel",{defaultMessage:"Name"})),o=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptLabel",{defaultMessage:"Prompt"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptPlaceholder",{defaultMessage:"Enter a System Prompt"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsLabel",{defaultMessage:"Default conversations"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultNewConversationTitle",{defaultMessage:"Use as default for all new conversations"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsHelpText",{defaultMessage:"Conversations that should use this System Prompt by default."});a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return ye})),n.d(t,"b",(function(){return he})),n.d(t,"a",(function(){return Oe}));var a=n(2),i=n.n(a),r=n(45),s=n(58),o=n(122),l=n(905),u=n(118),c=n(5),d=n(124),m=n(146),p=n(129),f=n(13),b=n(747),g=n(243),v=n(42),y=n(41),h=n.n(y),j=n(121),O=n(957),E=n(362),x=n(292),S=n(140),w=n(19),k=n(163),C=n(48),T=n(123),M=n(816);const I=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:i}=Object(C.useParams)(),{addSuccess:r}=Object(T.a)(),s=Object(a.useCallback)((t=>{null!=e&&e(),r({title:i===j.m.template?k.T(t):k.S(t),"data-test-subj":"addObjectToContainerSuccess"})}),[r,e,i]),o=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(x.c)({ids:n});e instanceof Blob?(Object(M.a)(e,`${k.n}.ndjson`),s(n.length)):o()}})()}),[n,t]),null};I.displayName="ExportTimeline";const _=i.a.memo(I);var A=n(44);const P=i.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:r}=Object(C.useParams)(),s=r===j.m.template?k.j:k.k,o=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(A.isEmpty)(t)?k.Z:t;return i.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return i.a.createElement(w.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:k.b,confirmButtonText:k.h,defaultFocusedButton:w.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:o()},i.a.createElement("div",{"data-test-subj":"warning"},s))}));P.displayName="DeleteTimelineModal";const D=Object(y.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),F=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:r,onComplete:s,savedSearchIds:o})=>{const{addSuccess:l}=Object(T.a)(),{tabName:u}=Object(C.useParams)(),c=Object(a.useCallback)((()=>{null!=s&&s()}),[s]),d=Object(a.useCallback)((()=>{n.length>0&&null!=o&&o.length>0?(e(n,o),l({title:u===j.m.template?k.R(n.length):k.Q(n.length)})):n.length>0&&(e(n),l({title:u===j.m.template?k.R(n.length):k.Q(n.length)})),null!=s&&s()}),[e,n,s,l,u,o]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(D,{"data-test-subj":"remove-popover"}),t?i.a.createElement(w.EuiModal,{maxWidth:600,onClose:c},i.a.createElement(P,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:r,closeModal:c})):null)}));F.displayName="DeleteTimelineModalOverlay";const R=({deleteTimelines:e,ids:t,savedSearchIds:n,isEnableDownloader:a,isDeleteTimelineModalOpen:r,onComplete:s,title:o})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:s}),null!=e&&i.a.createElement(F,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:r,onComplete:s,savedObjectIds:t,savedSearchIds:n,title:o})),N=i.a.memo(R),z=()=>{const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)(!1),[r,s]=Object(a.useState)(!1),o=Object(a.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(a.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((e=>{s(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((()=>{s(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{i(!1),s(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:o,onOpenDeleteTimelineModal:l,isEnableDownloader:r,enableExportTimelineDownloader:u,disableExportTimelineDownloader:c}},L=h.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));L.displayName="SearchRowContainer";const B=h()(w.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));B.displayName="SearchRowFlexGroup";const q=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:r,children:s,timelineType:o})=>{const l=Object(a.useMemo)((()=>({placeholder:o===j.m.default?k.K:k.L,incremental:!1,"data-test-subj":"search-bar"})),[o]);return i.a.createElement(L,null,i.a.createElement(B,{gutterSize:"s"},i.a.createElement(w.EuiFlexItem,null,i.a.createElement(w.EuiSearchBar,{box:l,onChange:n})),i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(w.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:r,numFilters:null!=e?e:void 0},k.D),!!s&&s)))))}));q.displayName="SearchRow",n(43);const V=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:i,onCreateRule:r,onCreateRuleFromEql:s,hasCrudAccess:o})=>[{width:o?"80px":"150px",actions:[{name:k.g,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:j.m.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===j.m.template&&e.includes("createFrom")},{name:k.f,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:j.m.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==j.m.template&&e.includes("createFrom")},{name:k.E,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==j.m.template&&e.includes("duplicate")},{name:k.F,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===j.m.template&&e.includes("duplicate")},{name:k.o,icon:"exportAction",type:"icon",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==j.l.immutable,description:k.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:k.i,icon:"trash",type:"icon",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==j.l.immutable,description:k.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:k.d,icon:"indexEdit",type:"icon",onClick:e=>{null!=r&&e.savedObjectId&&r(e.savedObjectId)},enabled:e=>null!=r&&null!=e.savedObjectId&&e.status!==j.l.immutable,description:k.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=r&&null!=t&&t.hasQuery},{name:k.e,icon:"indexEdit",type:"icon",onClick:e=>{null!=s&&e.savedObjectId&&s(e.savedObjectId)},enabled:e=>null!=s&&null!=e.savedObjectId&&e.status!==j.l.immutable,description:k.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=s&&null!=t&&t.hasEql}]}],$="45px";var U=n(184),G=n(742),H=n(130),Q=n(151),W=n(149);const K=h.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),J=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{dataType:"auto",isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?i.a.createElement(w.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(A.omit)(a,e)):n({...e,[a]:i.a.createElement(G.a,{notes:t,timelineId:W.f.active})}),"aria-label":e[a]?k.c:k.m,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:$},{dataType:"string",field:"title",name:a===j.m.default?k.X:k.Y,render:(e,n)=>null!=n.savedObjectId?i.a.createElement(w.EuiLink,{"data-test-subj":`timeline-title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(U.e)(n)?k.Z:i.a.createElement(K,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(U.e)(n)?k.Z:e),sortable:!1},{dataType:"string",field:"description",name:k.l,render:e=>i.a.createElement(K,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(H.d)()),sortable:!1},{dataType:"date",field:"updated",name:k.y,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement(Q.b,{value:e}):Object(H.d)()),sortable:!0}],Y=e=>e?[{dataType:"string",field:"updatedBy",name:k.B,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(H.a)(e)),sortable:!1}]:[],X=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(w.EuiToolTip,{content:k.C},i.a.createElement(w.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(U.c)(t)),sortable:!1,width:$},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(w.EuiToolTip,{content:k.I},i.a.createElement(w.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(U.d)(t)}`),sortable:!1,width:$},favorite:{align:"center",field:"favorite",name:i.a.createElement(w.EuiToolTip,{content:k.p},i.a.createElement(w.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(w.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:$}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===j.m.template?n:a},Z=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onTableChange:p,onToggleShowNotes:f,pageIndex:b,pageSize:g,searchResults:v,showExtendedColumns:y,sortField:h,sortDirection:O,tableRef:E,timelineType:x,totalSearchResultsCount:w})=>{const C=Object(a.useMemo)((()=>({showPerPageOptions:y,pageIndex:b,pageSize:g,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:w})),[n,b,g,y,w]),T=Object(a.useMemo)((()=>({sort:{field:h,direction:O}})),[h,O]),M=Object(a.useMemo)((()=>({selectable:e=>null!=e.savedObjectId&&e.status!==j.l.immutable,selectableMessage:e=>e?"":k.A,onSelectionChange:m})),[m]),{kibanaSecuritySolutionsPrivileges:I}=Object(S.a)(),_=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onCreateRule:i,onCreateRuleFromEql:r,onOpenDeleteTimelineModal:s,onOpenTimeline:o,onToggleShowNotes:l,showExtendedColumns:u,timelineType:c,hasCrudAccess:d})=>[...J({itemIdToExpandedNotesRowMap:a,onOpenTimeline:o,onToggleShowNotes:l,timelineType:c}),...Y(u),...X({timelineType:c}),...e.length?V({onCreateRule:i,onCreateRuleFromEql:r,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:s,onOpenTimeline:o,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onToggleShowNotes:f,showExtendedColumns:y,timelineType:x,hasCrudAccess:I.crud})),[e,t,s,o,l,u,c,d,m,f,y,x,I]),A=r||null==v?k.z:x===j.m.template?k.cb:k.bb;return i.a.createElement(ee,{columns:_,"data-test-subj":"timelines-table",itemId:"savedObjectId",itemIdToExpandedRowMap:s,items:null!=v?v:[],loading:r,noItemsMessage:A,onChange:p,pagination:C,selection:e.includes("selectable")?M:void 0,sorting:T,ref:E})}));Z.displayName="TimelinesTable";var ee=h()(w.EuiBasicTable).withConfig({displayName:"_StyledEuiBasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]),te=n(697);const ne=h.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ae=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:r,itemIdToExpandedNotesRowMap:s,importDataModalToggle:o,onCreateRule:l,onCreateRuleFromEql:u,onDeleteSelected:c,onlyFavorites:d,onOpenTimeline:m,onQueryChange:p,onSelectionChange:f,onTableChange:b,onToggleOnlyFavorites:g,onToggleShowNotes:y,pageIndex:h,pageSize:C,query:T,refetch:M,searchResults:I,selectedItems:_,sortDirection:A,setImportDataModalToggle:P,sortField:D,tabName:F,timelineType:R=j.m.default,timelineStatus:L,timelineFilter:B,templateTimelineFilter:V,totalSearchResultsCount:$})=>{var G;const{actionItem:H,enableExportTimelineDownloader:Q,isEnableDownloader:W,isDeleteTimelineModalOpen:K,onOpenDeleteTimelineModal:J,onCompleteEditTimelineAction:Y}=z(),X=Object(a.useRef)(null),{kibanaSecuritySolutionsPrivileges:ee}=Object(S.a)(),{getBatchItemsPopoverContent:ae}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:r=j.m.default})=>{const{enableExportTimelineDownloader:s,disableExportTimelineDownloader:o,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onOpenDeleteTimelineModal:c,onCloseDeleteTimelineModal:d}=z(),m=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),o(),d()}),[o,d,n]),{timelineIds:p,searchIds:f}=Object(a.useMemo)((()=>null!=t?he(ye(t)):{timelineIds:[],searchIds:void 0}),[t]),b=Object(a.useCallback)((()=>s()),[s]),g=Object(a.useCallback)((()=>c()),[c]),v=Object(a.useCallback)((n=>{var a,s,o,c;const d=null==t||0===t.length,v=[];return t&&v.push(i.a.createElement(w.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:b},k.o)),e&&v.push(i.a.createElement(w.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:g},k.i)),i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:p,savedSearchIds:f,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onComplete:m.bind(null,n),title:1!==(null==t?void 0:t.length)?r===j.m.template?k.M(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):k.N(null!==(s=null==t?void 0:t.length)&&void 0!==s?s:0):null!==(o=null===(c=t[0])||void 0===c?void 0:c.title)&&void 0!==o?o:""}),i.a.createElement(w.EuiContextMenuPanel,{items:v}))}),[t,e,p,f,l,u,m,r,b,g]);return{onCompleteBatchActions:m,getBatchItemsPopoverContent:v}})({deleteTimelines:ee.crud?e:void 0,selectedItems:_,tableRef:X,timelineType:R}),ie=Object(a.useMemo)((()=>i.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},T.trim().length?`${k.ab} "${T.trim()}"`:"")}})),[$,T]),re=Object(a.useMemo)((()=>i.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},T.trim().length?`${k.ab} "${T.trim()}"`:"")}})),[$,T]),se=Object(a.useMemo)((()=>null!=H&&null!=H.savedObjectId?[H.savedObjectId]:[]),[H]),oe=Object(a.useMemo)((()=>null!=H&&null!=H.savedSearchId?[H.savedSearchId]:void 0),[H]),le=Object(a.useCallback)((()=>{null!=M&&M()}),[M]),ue=Object(a.useCallback)((()=>{null!=P&&P(!1)}),[P]),ce=Object(a.useCallback)((()=>{null!=P&&P(!1),null!=M&&M()}),[P,M]),de=Object(a.useMemo)((()=>{if(ee.crud){const t=["createFrom","duplicate",...null!=l?["createRule"]:[],...null!=u?["createRuleFromEql"]:[]];return L!==j.l.immutable&&(t.push("export"),t.push("selectable")),null!=c&&null!=e&&L!==j.l.immutable&&t.push("delete"),t}return L!==j.l.immutable?["export","selectable"]:[]}),[l,u,L,c,e,ee]),me=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,V)),[V]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:se,savedSearchIds:oe,isDeleteTimelineModalOpen:K,isEnableDownloader:W,onComplete:Y,title:null!==(G=null==H?void 0:H.title)&&void 0!==G?G:k.Z}),i.a.createElement(O.a,{checkBoxLabel:k.H,closeModal:ue,description:k.O,errorMessage:k.t,failedDetailed:k.u,importComplete:ce,importData:x.f,successMessage:k.U,showCheckBox:!1,showModal:null!=o&&o,submitBtnText:k.w,subtitle:k.x,title:k.v}),i.a.createElement("div",{"data-test-subj":"timelines-page-container",className:U.a},!!B&&B,"notes"!==F?i.a.createElement(i.a.Fragment,null,i.a.createElement(q,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:d,onQueryChange:p,onToggleOnlyFavorites:g,query:T,timelineType:R},me),i.a.createElement(E.a,{border:!0},i.a.createElement(E.d,null,i.a.createElement(E.c,null,i.a.createElement(E.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,k.P," ",R===j.m.template?ie:re))),i.a.createElement(E.c,null,L!==j.l.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(E.e,{"data-test-subj":"selected-count"},R===j.m.template?k.M(_.length):k.N(_.length)),i.a.createElement(E.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:ae,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},k.a))),i.a.createElement(E.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:le},k.J)))),i.a.createElement(Z,{actionTimelineToShow:de,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:Q,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:J,onOpenTimeline:m,onSelectionChange:f,onTableChange:b,onToggleShowNotes:y,pageIndex:h,pageSize:C,searchResults:I,showExtendedColumns:!0,sortDirection:A,sortField:D,timelineType:R,totalSearchResultsCount:$,tableRef:X})):i.a.createElement(te.a,{onOpenTimeline:m})))}));ae.displayName="OpenTimeline";var ie=n(224);const re=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>i.a.createElement(ie.a,{title:a,split:!0,height:40},i.a.createElement(w.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(w.EuiFlexItem,{grow:!1},i.a.createElement(w.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},k.q)),e&&i.a.createElement(w.EuiFlexItem,null,e)))));re.displayName="TitleRow";const se=h.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);se.displayName="HeaderContainer";const oe=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:r=[],isLoading:s,itemIdToExpandedNotesRowMap:o,onAddTimelinesToFavorites:l,onDeleteSelected:u,onlyFavorites:c,onOpenTimeline:d,onQueryChange:m,onSelectionChange:p,onTableChange:f,onToggleOnlyFavorites:b,onToggleShowNotes:g,pageIndex:v,pageSize:y,searchResults:h,selectedItems:j,sortDirection:O,sortField:E,timelineFilter:x,timelineType:S,templateTimelineFilter:k,title:C,totalSearchResultsCount:T})=>{const M=Object(a.useRef)(null),I=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=u&&null!=e&&t.push("delete"),t.filter((e=>!r.includes(e)))}),[u,e,r]),_=Object(a.useMemo)((()=>i.a.createElement(a.Fragment,{key:"search-row-content"},!!k&&k)),[k]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(w.EuiModalHeader,null,i.a.createElement(se,null,i.a.createElement(re,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:j.length,title:C}))),i.a.createElement(w.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!x&&i.a.createElement(i.a.Fragment,null,x,i.a.createElement(w.EuiSpacer,{size:"m"})),i.a.createElement(q,{"data-test-subj":"search-row",onlyFavorites:c,onQueryChange:m,onToggleOnlyFavorites:b,query:"",timelineType:S},_),i.a.createElement(Z,{actionTimelineToShow:I,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:s,itemIdToExpandedNotesRowMap:o,onOpenTimeline:d,onSelectionChange:p,onTableChange:f,onToggleShowNotes:g,pageIndex:v,pageSize:y,searchResults:h,showExtendedColumns:!1,sortDirection:O,sortField:E,timelineType:S,totalSearchResultsCount:T,tableRef:M}))))}));oe.displayName="OpenTimelineModalBody";var le=n(156),ue=n(194);let ce=function(e){return e.tab="tab",e.filter="filter",e}({});var de=n(911),me=n(127),pe=n(132),fe=n(187),be=n(219),ge=n(274),ve=n(158);const ye=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),he=e=>e.reduce(((e,{timelineId:t,searchId:n})=>{let a=e;return null!=n&&(a={...a,searchIds:[...a.searchIds,n]}),null!=t&&(a={...a,timelineIds:[...a.timelineIds,t]}),a}),{timelineIds:[],searchIds:[]}),je=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:v=!1,importDataModalToggle:y,onOpenTimeline:h,setImportDataModalToggle:O,tabName:E,title:S})=>{const T=Object(r.useDispatch)(),{startTransaction:M}=Object(fe.b)(),[I,_]=Object(a.useState)({}),[P,D]=Object(a.useState)(!1),[F,R]=Object(a.useState)(0),[N,z]=Object(a.useState)(t),[L,B]=Object(a.useState)(""),[q,V]=Object(a.useState)([]),[$,G]=Object(a.useState)("desc"),[H,Q]=Object(a.useState)("updated"),W=Object(a.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),K=Object(d.b)((e=>{var t,n;return null!==(t=null===(n=W(e,m.c.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:J,selectedPatterns:Y}=Object(pe.a)(me.SourcererScopeName.timeline),X=Object(o.a)("unifiedComponentsInTimelineDisabled"),{customTemplateTimelineCount:Z,defaultTimelineCount:ee,elasticTemplateTimelineCount:te,favoriteCount:ne,fetchAllTimeline:ie,timelines:re,loading:se,totalCount:je,templateTimelineCount:Oe}=Object(b.b)(),{timelineType:Ee,timelineTabs:xe,timelineFilters:Se}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:r}=Object(ue.l)(le.a.timelines),{navigateToUrl:s}=Object(u.j)().services.application,{tabName:l}=Object(C.useParams)(),[c,d]=Object(a.useState)(l===j.m.default||l===j.m.template?l:j.m.default),m=Object(o.a)("securitySolutionNotesEnabled"),p=Object(a.useMemo)((()=>n(Object(ue.j)(j.m.default,r))),[n,r]),f=Object(a.useMemo)((()=>n(Object(ue.j)(j.m.template,r))),[n,r]),b=Object(a.useMemo)((()=>n(Object(ue.j)("notes",r))),[n,r]),g=Object(a.useCallback)((e=>{e.preventDefault(),s(p)}),[s,p]),v=Object(a.useCallback)((e=>{e.preventDefault(),s(f)}),[s,f]),y=Object(a.useCallback)((e=>{e.preventDefault(),s(b)}),[s,b]),h=Object(a.useCallback)((e=>[{id:j.m.default,name:k.W,href:p,disabled:!1,onClick:e===ce.tab?g:A.noop},{id:j.m.template,name:k.V,href:f,disabled:!1,onClick:e===ce.tab?v:A.noop}]),[p,f,g,v]),O=Object(a.useCallback)(((e,t)=>{d((t=>(t!==e&&d(e),t)))}),[d]),E=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(w.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},h(ce.tab).map((e=>i.a.createElement(w.EuiTab,{"data-test-subj":`timeline-${ce.tab}-${e.id}`,isSelected:e.id===l,disabled:e.disabled,key:`timeline-${ce.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),O(e.id,ce.tab)}},e.name))),m&&i.a.createElement(w.EuiTab,{"data-test-subj":"timeline-notes",isSelected:"notes"===l,key:"timeline-notes",href:b,onClick:y},"Notes")),i.a.createElement(w.EuiSpacer,{size:"m"}))),[l]),x=Object(a.useMemo)((()=>i.a.createElement(w.EuiTabs,null,h(ce.filter).map((e=>i.a.createElement(w.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ce.filter}-${e.id}`,isSelected:e.id===c,key:`timeline-${ce.filter}-${e.id}`,onClick:t=>{e.onClick(t),O(e.id,ce.filter)}},e.name))))),[c,h,O]);return{timelineType:c,timelineTabs:E,timelineFilters:x}})({defaultTimelineCount:ee,templateTimelineCount:Oe}),{timelineStatus:we,templateTimelineFilter:ke,installPrepackagedTimelines:Ce}=Object(de.a)({timelineType:Ee,customTemplateTimelineCount:Z,elasticTemplateTimelineCount:te}),Te=Object(a.useCallback)((()=>{ie({pageInfo:{pageIndex:F+1,pageSize:N},search:L,sort:{sortField:H,sortOrder:$},onlyUserFavorite:P,timelineType:Ee,status:we})}),[ie,F,N,L,H,$,Ee,we,P]),Me=Object(a.useCallback)((e=>{B(e.queryText.trim())}),[]),Ie=Object(a.useCallback)((async(e,t)=>{M({name:e.length>1?be.f.BULK_DELETE:be.f.DELETE}),e.includes(K)&&T(Object(f.createTimeline)({id:m.c.active,columns:X?g.b:ge.a,dataViewId:J,indexNames:Y,show:!1,excludedRowRendererIds:X?[]:ve.b.excludedRowRendererIds})),await Object(x.b)(e,t),Te()}),[M,K,Te,T,J,Y,X]),_e=Object(a.useCallback)((async(e,t)=>{await Ie(e,t)}),[Ie]),Ae=Object(a.useCallback)((async()=>{const e=ye(q),{timelineIds:t,searchIds:n}=he(e);await Ie(t,n),Be()}),[q,Ie]),Pe=Object(a.useCallback)((e=>{V(e)}),[]),De=Object(a.useCallback)((({page:e,sort:t})=>{if(null!=e){const{index:t,size:n}=e;R(t),z(n)}if(null!=t){const{field:e,direction:n}=t;G(n),Q(e)}}),[]),Fe=Object(a.useCallback)((()=>{D(!P)}),[P]),Re=Object(a.useCallback)((e=>{_(e)}),[]),{navigateTo:Ne}=Object(u.l)(),ze=Object(a.useCallback)((e=>Ne({deepLinkId:c.Oc.rulesCreate,path:`?${l.b}=${Object(s.encode)(e)}`})),[Ne]),Le=Object(a.useCallback)((e=>Ne({deepLinkId:c.Oc.rulesCreate,path:`?${l.a}=${Object(s.encode)(e)}`})),[Ne]),Be=Object(a.useCallback)((()=>{V([])}),[]),qe=Object(U.g)(),Ve=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&M({name:be.f.DUPLICATE}),v&&null!=e&&e(),qe({duplicate:t,onOpenTimeline:h,timelineId:n,timelineType:a,unifiedComponentsInTimelineDisabled:X})}),[qe]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${U.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await Ce(),Te()})()}),[Te,Ce]),v?i.a.createElement(oe,{"data-test-subj":"open-timeline-modal",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,hideActions:n,isLoading:se,itemIdToExpandedNotesRowMap:I,onAddTimelinesToFavorites:void 0,onlyFavorites:P,onOpenTimeline:Ve,onQueryChange:Me,onSelectionChange:Pe,onTableChange:De,onToggleOnlyFavorites:Fe,onToggleShowNotes:Re,pageIndex:F,pageSize:N,query:L,searchResults:re,selectedItems:q,sortDirection:$,sortField:H,templateTimelineFilter:ke,timelineType:Ee,timelineStatus:we,timelineFilter:Se,title:S,totalSearchResultsCount:je}):i.a.createElement(ae,{"data-test-subj":"open-timeline",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,isLoading:se,itemIdToExpandedNotesRowMap:I,importDataModalToggle:y,onAddTimelinesToFavorites:void 0,onCreateRule:ze,onCreateRuleFromEql:Le,onDeleteSelected:Ae,onlyFavorites:P,onOpenTimeline:Ve,onQueryChange:Me,onSelectionChange:Pe,onTableChange:De,onToggleOnlyFavorites:Fe,onToggleShowNotes:Re,pageIndex:F,pageSize:N,query:L,refetch:Te,searchResults:re,setImportDataModalToggle:O,selectedItems:q,sortDirection:$,sortField:H,tabName:E,templateTimelineFilter:ke,timelineType:Ee,timelineStatus:we,timelineFilter:xe,title:S,totalSearchResultsCount:je})})),Oe=i.a.memo(je)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(119),i=n.n(a),r=n(2),s=n(90),o=n(981),l=n(8),u=n.n(l),c=n(71),d=n.n(c),m=n(19);const p="eui-global",f="eui-utilities",b={darkMode:!1};var g=n(43);const v=[m.euiStylisPrefixer],y=d()({key:"css",stylisPlugins:v,container:document.querySelector('meta[name="emotion"]')}),h=d()({key:p,stylisPlugins:v,container:document.querySelector(`meta[name="${p}"]`)}),j=d()({key:f,stylisPlugins:v,container:document.querySelector(`meta[name="${f}"]`)});y.compat=!0,h.compat=!0,j.compat=!0;const O={default:y,global:h,utility:j},E=({theme:{theme$:e},globalStyles:t,colorMode:n,modify:a,children:i})=>{const s=u()(e,b),o=Object(r.useMemo)((()=>(e=>e.darkMode?m.COLOR_MODES_STANDARD.dark:m.COLOR_MODES_STANDARD.light)(s)),[s]),l=n||o,c=!1!==t&&void 0;return Object(g.jsx)(m.EuiProvider,{cache:O,modify:a,colorMode:l,globalStyles:c,utilityClasses:c},i)},x=({children:e,i18n:t,...n})=>Object(s.useIsNestedEuiProvider)()?(Object(o.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(g.jsx)(t.Context,null,e)):Object(g.jsx)(E,n,Object(g.jsx)(t.Context,null,e));var S=n(84);const w=({children:e,...t})=>Object(g.jsx)(x,i()({globalStyles:!1},t),Object(g.jsx)(S.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(g.jsx)(S.KibanaErrorBoundary,null,e)))},function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return M}));var a=n(2),i=n.n(a),r=n(19),s=n(121),o=n(908),l=n(194);const u="timeline";var c=n(4);const d=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),m=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),p=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),f=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),b=e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),g=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var v=n(156);const y=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(l.l)(v.a.timelines),u=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),c=Object(a.useCallback)(((e,a,i)=>{const r=n(Object(l.k)(null!=a?a:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${r})`,{block:!1})}),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiModalHeader,null),i.a.createElement(r.EuiModalBody,null,i.a.createElement(o.a,{hideUntitled:!0,getSelectableOptions:u,onTimelineChange:c,onClosePopover:e,timelineType:s.m.default})))},h=Object(a.memo)(y),j=({interactionsUpsellingMessage:e})=>({name:u,button:{label:null!=e?e:d,iconType:"timeline",isDisabled:!!e},helpText:i.a.createElement(r.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return i.a.createElement(h,{onClosePopover:n,onInsert:t})}});var O=n(58),E=n(429);const x=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function i(e,n){if(t[a]!==e)throw new Error(f);a++;let i="",r=0;for(;a<t.length;a++){const s=t[a];if(s===n&&0===r)return a++,i;s===n?r--:s===e&&r++,i+=s}return""}const r=i("[","]"),s=i("(",")"),o=e.now();if(!r)return this.file.info(m,{line:o.line,column:o.column}),!1;try{var l;const t=s.split("?"),n=Object(E.parse)(t[1]),a=Object(O.safeDecode)(null!==(l=n.timeline)&&void 0!==l?l:""),{id:i="",graphEventId:c=""}=null!=a?a:{id:null,graphEventId:""};return i?e(`[${r}](${s})`)({type:u,id:i,title:r,graphEventId:c}):(this.file.info(p,{line:o.line,column:o.column+s.indexOf("id")}),!1)}catch{this.file.info((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(s),{line:o.line,column:o.column})}return!1},i=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,n.splice(n.indexOf("url"),0,u)};var S=n(208),w=n(184),k=n(122),C=n(123);const T=({id:e,title:t,graphEventId:n})=>{const{addError:s}=Object(C.a)(),o=Object(S.b)("investigation_guide_interactions"),l=(()=>{const e=Object(w.g)(),t=Object(k.a)("unifiedComponentsInTimelineDisabled");return Object(a.useCallback)(((n,a,i)=>{e({graphEventId:i,timelineId:n,onError:a,unifiedComponentsInTimelineDisabled:t})}),[e,t])})(),u=Object(a.useCallback)(((e,t)=>{s(e,{title:g,toastMessage:b(t)})}),[s]),d=Object(a.useCallback)((()=>l(null!=e?e:"",u,n)),[e,n,l,u]);return i.a.createElement(r.EuiToolTip,{content:null!=o?o:(m=null!=e?e:"",c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:m}}))},i.a.createElement(r.EuiLink,{onClick:d,disabled:!!o,"data-test-subj":`markdown-timeline-link-${e}`},t));var m},M=Object(a.memo)(T)},function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var a=n(44),i=n(19),r=n(2),s=n.n(r),o=n(41),l=n.n(o),u=n(179),c=n(121),d=n(252),m=n(4);const p=m.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),f=m.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),b=m.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),g=m.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),v=m.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),y=m.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),h=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),j=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),O=m.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),E=m.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),x=m.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),S=m.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),w=m.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),k=m.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),C=e=>m.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),T=[{label:v},{label:h},{label:y},{label:j},{label:f},{label:p}],M=[],I=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):M).map((e=>({label:e})))};var n})):M,_=({browserFields:e,selectedField:t,selectedOperator:n,type:i})=>{const r=t.length>0?t[0].label:"",s=n.length>0?n[0].label:"",o=e&&null!=Object(d.a)(e)[r],l=-1!==Object(a.findIndex)((e=>e.label===s),T),u=i===c.a.template&&(s===y||s===j);return o&&l&&!u},A=e=>{switch(e.length>0?e[0].label:""){case v:case h:return u.d;case y:case j:return u.c;case f:case p:return u.b;default:return u.d}},P=e=>{switch(e.length>0?e[0].label:""){case h:case j:case p:return!0;default:return!1}},D=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var F=n(191);const R=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(N(e));Object(r.useEffect)((()=>{t(z(n))}),[n,t]);const o=Object(r.useCallback)(((e,t=n)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&a([...n,{label:e}])}),[n]),l=Object(r.useCallback)((e=>{a(e)}),[]);return s.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:O,onCreateOption:o,onChange:l})},N=e=>Object(F.j)(e)?e.map((e=>({label:String(e)}))):[],z=e=>e.map((e=>e.label)),L=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(B(e));Object(r.useEffect)((()=>{t(D(n))}),[n,t]);const o=Object(r.useCallback)((e=>{a(e.target.value)}),[]);return s.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:o,placeholder:S,value:D(n)})},B=e=>{var t;return Object(F.j)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},q="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const V=s.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:o,onDataProviderEdited:l,operator:c,providerId:d,timelineId:m,value:O,type:S=u.a.default})=>{const[M,D]=Object(r.useState)([{label:n}]),[F,N]=Object(r.useState)(((e,t)=>":"===t?e?[{label:h}]:[{label:v}]:"includes"===t?e?[{label:j}]:[{label:y}]:e?[{label:p}]:[{label:f}])(o,c)),[z,B]=Object(r.useState)(O),V=Object(r.useMemo)((()=>F.length>0&&(F[0].label===y||F[0].label===j)),[F]),$=Object(r.useMemo)((()=>S!==u.a.template&&F.length>0&&F[0].label!==f&&F[0].label!==p&&!V),[V,S,F]),U=Object(r.useMemo)((()=>V&&Array.isArray(z)&&!z.length),[V,z]),G=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(q);e.length>0&&e[0].focus()}},H=Object(r.useCallback)((e=>{D(e),S===u.a.template&&B(`{${e[0].label}}`),G()}),[S]),Q=Object(r.useCallback)((e=>{N(e),G()}),[]),W=Object(r.useCallback)((e=>{B(e)}),[]),K=Object(r.useCallback)((()=>{l({andProviderId:e,excluded:P(F),field:M.length>0?M[0].label:"",id:m,operator:A(F),providerId:d,value:z,type:S})}),[l,e,F,M,m,d,z,S]);return Object(r.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),s.a.createElement(i.EuiPanel,{paddingSize:"s"},s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:b},s.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:H,options:I(t),placeholder:g,selectedOptions:M,singleSelection:{asPlainText:!0},fullWidth:!0}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:E},s.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:Q,options:T,placeholder:k,selectedOptions:F,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},$&&s.a.createElement(i.EuiFormRow,{label:w},s.a.createElement(L,{onChangeCallback:W,value:O})),V&&S!==u.a.template&&s.a.createElement(i.EuiFormRow,{label:w},s.a.createElement(R,{onChangeCallback:W,value:O}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},S===u.a.template&&V&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:C(F[0].label)}),s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{className:q,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!_({type:S,browserFields:t,selectedField:M,selectedOperator:F})||U,onClick:K,size:"m"},x))))))}));V.displayName="StatefulEditDataProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(2),i=n.n(a),r=n(92);const s={capabilities:Object(r.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var o=n(123),l=n(118),u=n(1532),c=n(1533);const d=Object(u.a)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),m=n(4).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),p={...s,capabilitiesFetched:!1},f=i.a.createContext(p);f.displayName="MlCapabilitiesContext";const b=i.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(p),r=Object(l.i)(),{addError:s}=Object(o.a)(),{start:u,result:b,error:g}=Object(c.a)(d);return Object(a.useEffect)((()=>{u({http:r})}),[r,u]),Object(a.useEffect)((()=>{b&&n({...b,capabilitiesFetched:!0})}),[b]),Object(a.useEffect)((()=>{g&&s(g,{title:m})}),[s,g]),i.a.createElement(f.Provider,{value:t},e)}));b.displayName="MlCapabilitiesProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(2),i=n.n(a),r=n(19),s=n(123),o=n(4);const l=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),u=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),m=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),p=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),f=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),b=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),i=new Error(a.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i};var g=n(242);const v=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:n}=Object(g.c)().services;if(!t||!e.length)return null;const{actionPath:a,message:s,buttonLabel:l}=e[0];return i.a.createElement(r.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:i.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(u=t,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:u},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},i.a.createElement(r.EuiText,{size:"xs"},s)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},i.a.createElement(r.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:n.basePath.prepend(a)},l||p)))));var u};v.displayName="ActionConnectorWarningsComponent";const y=i.a.memo(v);y.displayName="ActionConnectorWarnings";const h=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:p,failedDetailed:g,importComplete:v,importData:h,showCheckBox:j=!0,showExceptionsCheckBox:O=!1,showActionConnectorsCheckBox:E=!1,showModal:x,submitBtnText:S,subtitle:w,successMessage:k,title:C})=>{const[T,M]=Object(a.useState)(null),[I,_]=Object(a.useState)(!1),[A,P]=Object(a.useState)(!1),[D,F]=Object(a.useState)(!1),[R,N]=Object(a.useState)(!1),{addError:z,addSuccess:L}=Object(s.a)(),[B,q]=Object(a.useState)([]),V=Object(a.useMemo)((()=>Object(r.htmlIdGenerator)()()),[]),[$,U]=Object(a.useState)(0),G=Object(a.useCallback)((()=>{t(),P(!1),F(!1),N(!1),q([])}),[t,P,F]),H=Object(a.useCallback)((e=>{_(!1),M(null),v(),e&&(v(),G())}),[G,v]),Q=Object(a.useCallback)((async()=>{if(null!=T){_(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...n}=await h({fileToImport:T[0],overwrite:A,overwriteExceptions:D,overwriteActionConnectors:R,signal:e.signal}),a=n.action_connectors_success_count;q(t),U(a),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:n,successMessage:a,errorMessage:i,errorMessageDetailed:r,addError:s,addSuccess:l})=>{if(e.success)return e.success_count>0&&l(a(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&l((c=e.exceptions_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:c},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(n&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&l((u=e.action_connectors_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:u},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var u,c;if(e.errors.length>0){if(n&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:n}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:n,error:a}=e;t=t&&t!==n?`${t},${n}`:n;const{status_code:i,message:r}=a||{};let s;return s=403===i?f:r,{...e,error:{...a,message:s}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return s(b(r,e,t),{title:m(n||t.length)})}s(b(r,e,e.errors),{title:i(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&s(b(r,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:n,exceptionsIncluded:O,actionConnectorsIncluded:E,successMessage:k,errorMessage:p,errorMessageDetailed:g,addError:z,addSuccess:L}),H(!(null!=t&&t.length))}catch(e){G(),z(e,{title:p(1)})}}}),[T,h,A,D,R,O,k,p,g,z,L,E,H,G]),W=Object(a.useCallback)((()=>{G()}),[G]),K=Object(a.useCallback)((()=>{P((e=>!e))}),[]),J=Object(a.useCallback)((()=>{F((e=>!e))}),[]),Y=Object(a.useCallback)((()=>{N((e=>!e))}),[]),X=Object(a.useCallback)((e=>{M(e&&e.length>0?e:null)}),[]);return i.a.createElement(i.a.Fragment,null,x&&i.a.createElement(r.EuiModal,{onClose:W,maxWidth:"750px"},i.a.createElement(r.EuiModalHeader,null,i.a.createElement(r.EuiModalHeaderTitle,null,C)),i.a.createElement(r.EuiModalBody,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("h4",{id:V},n)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:w,onChange:X,display:"large",fullWidth:!0,isLoading:I,"aria-labelledby":V}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(y,{actionConnectorsWarnings:B,importedActionConnectorsCount:$}),i.a.createElement(r.EuiSpacer,{size:"s"}),j&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:A,onChange:K}),O&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:u,checked:D,onChange:J}),E&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:c,checked:R,onChange:Y}))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:W},l),i.a.createElement(r.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:Q,disabled:null==T||I,fill:!0},S))))};h.displayName="ImportDataModalComponent";const j=i.a.memo(h);j.displayName="ImportDataModal"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n(44),i=n(2),r=n.n(i),s=n(45),o=n(121),l=n(124),u=n(129),c=n(19),d=n(52),m=n.n(d),p=n(41),f=n.n(p),b=n(130),g=n(657),v=n(179),y=n(516);const h=f()(c.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===o.m.template?"140px":"none"));h.displayName="ProviderBadgeStyled";const j=f.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),O=f()(j).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),E=f()(j).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),x=({type:e,toggleType:t})=>e!==v.a.template?r.a.createElement(E,{onClick:t},y.d):r.a.createElement(O,null,y.w),S=r.a.memo(x),w={tabIndex:-1},k=r.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:s,operator:l,providerId:u,togglePopover:c,toggleType:d,displayValue:p,val:f,type:j,timelineType:O})=>{const E=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),x=Object(i.useMemo)((()=>m()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":s})),[n,s]),k=Object(i.useMemo)((()=>Object(a.isString)(f)&&""===f?Object(b.b)():f),[f]),C=Object(i.useMemo)((()=>s?r.a.createElement("span",null,y.q," "):null),[s]),T=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,C,l!==v.b?r.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?p:k}"`):r.a.createElement("span",{className:"field-value"},t," ",y.j))),[p,t,k,l,C]),M=Object(i.useMemo)((()=>y.v({field:t,value:`${k}`})),[t,k]);return r.a.createElement(g.a,{id:`${u}-${t}-${f}`},r.a.createElement(r.a.Fragment,null,r.a.createElement(h,{className:x,color:"hollow",title:"",iconOnClick:E,iconOnClickAriaLabel:y.t,iconType:"cross",iconSide:"right",onClick:c,onClickAriaLabel:M,closeButtonProps:w,"data-test-subj":"providerBadge",$timelineType:O},T),O===o.m.template&&l!==v.c&&r.a.createElement(S,{toggleType:d,type:j})))}));k.displayName="ProviderBadge";var C=n(0),T=n.n(C),M=n(955);const I="edit-data-provider",_="exclude-data-provider",A="enable-data-provider",P="filter-for-field-present-data-provider",D="delete-data-provider",F=f()(c.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);F.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends r.a.PureComponent{constructor(...e){super(...e),T()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:s,type:o})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:s,type:o}),this.props.closePopover()})),T()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:i,type:r}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:v.b,providerId:a,value:i,type:r}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:i,field:s,isEnabled:l,isExcluded:u,isLoading:d,isOpen:m,operator:p,providerId:f,timelineId:b,timelineType:g,toggleEnabledProvider:h,toggleExcludedProvider:j,toggleTypeProvider:O,value:E,type:x}=this.props,S=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:i,isExcluded:s,isLoading:l,operator:u,onDataProviderEdited:c,onFilterForFieldPresent:d,providerId:m,timelineId:p,timelineType:f,toggleEnabled:b,toggleExcluded:g,toggleType:h,type:j,value:O})=>[{id:0,items:[{className:I,disabled:l,icon:"pencil",name:y.g,panel:1},{className:_,disabled:l,icon:s?"plusInCircle":"minusInCircle",name:s?y.p:y.i,onClick:g},{className:A,disabled:l,icon:i?"eyeClosed":"eye",name:i?y.x:y.u,onClick:b},{className:P,disabled:l,icon:"logstashFilter",name:y.k,onClick:d},f===o.m.template?{className:"convert-to-field-data-provider",disabled:l||u===v.c,icon:"visText",name:j===v.a.template?y.c:y.d,onClick:h}:{name:null},{className:D,disabled:l,icon:"trash",name:y.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=p&&null!=c?r.a.createElement(M.a,{andProviderId:e,browserFields:t,field:a,isExcluded:s,onDataProviderEdited:c,operator:u,providerId:m,timelineId:p,value:O,type:j}):null,id:1,title:y.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:s,isEnabled:l,isExcluded:u,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:p,providerId:f,timelineId:b,timelineType:g,toggleEnabled:h,toggleExcluded:j,toggleType:O,value:E,type:x});return r.a.createElement(F,{id:`popoverFor_${f}-${s}-${E}`,isOpen:m,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},r.a.createElement("div",{style:{userSelect:"none"}},r.a.createElement(c.EuiContextMenu,{initialPanelId:0,panels:S,"data-test-subj":"providerActions"})))}}var R=n(337),N=n(158);const z=r.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isPopoverOpen:f,onDataProviderEdited:b,operator:g,providerId:y,register:h,setIsPopoverOpen:j,timelineId:O,toggleEnabledProvider:E,toggleExcludedProvider:x,toggleTypeProvider:S,displayValue:w,val:C,type:T=v.a.default,wrapperRef:M})=>{const I=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),_=Object(l.b)((e=>{var t,n;return O&&null!==(t=null===(n=I(e,O))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:o.m.default})),{isLoading:A}=Object(l.a)((e=>{var t;return null!==(t=I(e,null!=O?O:""))&&void 0!==t?t:N.b})),P=Object(i.useCallback)((()=>{j(!f)}),[f,j]),D=Object(i.useCallback)((()=>{var e;j(!1),null==M||null===(e=M.current)||void 0===e||e.focus()}),[M,j]),F=Object(i.useCallback)((()=>{E(),D()}),[D,E]),z=Object(i.useCallback)((()=>{x(),D()}),[x,D]),L=Object(i.useCallback)((()=>{S(),D()}),[S,D]),[B,q]=Object(i.useState)(!1),V=Object(s.useDispatch)();Object(i.useEffect)((()=>{null!=h&&(V(R.a.registerProvider({provider:{...h,and:[]}})),q(!0))}),[B,V,h,q]);const $=Object(i.useCallback)((()=>{B&&null!=h&&V(R.a.unRegisterProvider({id:h.id}))}),[B,V,h]);Object(i.useEffect)((()=>()=>{$()}),[$]);const U=Object(i.useMemo)((()=>r.a.createElement(k,{deleteProvider:A?a.noop:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,providerId:y,togglePopover:P,toggleType:L,displayValue:null!=w?w:String(C),val:C,operator:g,type:T,timelineType:_})),[n,w,c,m,p,A,d,L,g,y,_,P,T,C]);return r.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:D,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isLoading:A,isOpen:f,onDataProviderEdited:b,operator:g,providerId:y,timelineId:O,timelineType:_,toggleEnabledProvider:F,toggleExcludedProvider:z,toggleTypeProvider:L,value:C,type:T})}));z.displayName="ProviderItemBadge"},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(7),i=n(2),r=n.n(i),s=n(188),o=n.n(s),l=n(11),u=n(70),c=n(12),d=n(118);const m=e=>"esql"in e?{query:e.esql,language:"esql"}:e,p=e=>null!=e&&"object"==typeof e&&Object.hasOwn(e,"getName"),f=Object(i.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:s,isLoading:f=!1,isRefreshPaused:b,filterQuery:g,filterManager:v,filters:y,onChangedQuery:h,onSubmitQuery:j,refreshInterval:O,savedQuery:E,onSavedQuery:x,dataTestSubj:S,displayStyle:w,isDisabled:k})=>{const{data:C}=Object(d.j)().services,[T,M]=Object(i.useState)(),I=Object(i.useCallback)((e=>{if(null!=e.query&&!o()(e.query,g)){const t=m(e.query);j(t)}}),[g,j]),_=Object(i.useCallback)((e=>{if(h&&null!=e.query&&!o()(e.query,g)){const t=m(e.query);h(t)}}),[g,h]),A=Object(i.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;j(t,a),v.setFilters(n||[]),x(e)}),[v,j,x]),P=Object(i.useCallback)((()=>{null!=E&&(j({query:"",language:E.attributes.query.language}),v.setFilters([]),x(void 0))}),[v,j,x,E]),D=Object(i.useCallback)((e=>{v.setFilters(e)}),[v]),F="esql"===(null==g?void 0:g.language),R=Object(i.useMemo)((()=>F&&"string"==typeof g.query?{esql:g.query}:g),[g,F]);Object(i.useEffect)((()=>{let e;return p(s)?M(s):F||(async()=>{e=await C.dataViews.create({id:s.title,title:s.title}),M(e)})(),()=>{var t,n;null!==(t=e)&&void 0!==t&&t.id&&C.dataViews.clearInstanceCache(null===(n=e)||void 0===n?void 0:n.id)}}),[C.dataViews,s,F]);const N=Object(i.useMemo)((()=>{if(p(s)||F)return y;const e=Object(a.cloneDeep)(y);return e.forEach((e=>e.meta.index=s.title)),e}),[y,s,F]),z=Object(i.useMemo)((()=>new l.TimeHistory(new c.Storage(localStorage))),[]),L=Object(i.useMemo)((()=>null!=T?[T]:[]),[T]);return r.a.createElement(u.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:N,indexPatterns:L,isLoading:f,isRefreshPaused:b,query:R,onClearSavedQuery:P,onFiltersUpdated:D,onQueryChange:_,onQuerySubmit:I,onSaved:x,onSavedQueryUpdated:A,refreshInterval:O,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:z,dataTestSubj:S,savedQuery:E,displayStyle:w,isDisabled:k})}));f.displayName="QueryBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(118),r=n(122);const s=()=>{const{uiSettings:e}=Object(i.j)().services,t=null==e?void 0:e.get("enableESQL"),n=Object(r.a)("timelineEsqlTabDisabled"),s=!Object(r.a)("esqlRulesDisabled")&&t;return Object(a.useMemo)((()=>({isEsqlAdvancedSettingEnabled:t,isEsqlRuleTypeEnabled:s,isTimelineEsqlEnabledByFeatureFlag:!n})),[t,n,s])}},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var a=void 0;t.setEuiDevProviderWarning=function(e){return a=e},t.getEuiDevProviderWarning=function(){return a},t.emitEuiProviderWarning=function(e){if("function"==typeof a)return a(e);switch(a){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return a.useMemo((function(){return e.apply(void 0,t)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.createContext(void 0);return[function(){var e=a.useContext(n);if(null==e)throw new Error("useReducerContext must be used inside a ReducerProvider.");return e},function(i){var r=i.children,s=i.initialState;return function(e,t){return a.createElement(n.Provider,e,t)}({value:a.useReducer(e,void 0!==s?s:t)},r)},n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(326));t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=(n=e,function(e,t){return n.reduceRight((function(t,n){return n(e)(t)}),t)});return function(e,t,n){void 0===n&&(n=function(e){return e});var s=i.useRef(n(t)),o=i.useState(s.current)[1],l=i.useCallback((function(t){return s.current=e(s.current,t),o(s.current),t}),[e]),u=i.useRef(a({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l));return r.default((function(){u.current=a({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l)}),[l]),[s.current,u.current]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.createContext(void 0);return[function(){var e=a.useContext(t);if(null==e)throw new Error("useStateContext must be used inside a StateProvider.");return e},function(n){var i=n.children,r=n.initialValue;return function(e,n){return a.createElement(t.Provider,e,n)}({value:a.useState(void 0!==r?r:e)},i)},t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(445));t.default=function(e,t){void 0===t&&(t=[]);var n=i.useState(0),s=n[0],o=n[1],l=r.default(e,a.__spreadArrays(t,[s])),u=l.loading,c=i.useCallback((function(){u||o((function(e){return e+1}))}),a.__spreadArrays(t,[u]));return a.__assign(a.__assign({},l),{retry:c})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(635)).default("audio");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r="object"==typeof navigator?navigator:void 0,s=r&&"function"==typeof r.getBattery;t.default=s?function(){var e=a.useState({isSupported:!0,fetched:!1}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,a=null,s=function(){if(e&&a){var r={isSupported:!0,fetched:!0,level:a.level,charging:a.charging,dischargingTime:a.dischargingTime,chargingTime:a.chargingTime};!i.isDeepEqual(t,r)&&n(r)}};return r.getBattery().then((function(t){e&&(a=t,i.on(a,"chargingchange",s),i.on(a,"chargingtimechange",s),i.on(a,"dischargingtimechange",s),i.on(a,"levelchange",s),s())})),function(){e=!1,a&&(i.off(a,"chargingchange",s),i.off(a,"chargingtimechange",s),i.off(a,"dischargingtimechange",s),i.off(a,"levelchange",s))}}),[]),t}:function(){return{isSupported:!1}}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,i,r;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(i=a;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=a;0!=i--;){var s=r[i];if(!("_owner"===s&&t.$$typeof||e(t[s],n[s])))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===e&&(e=!0);var n=a.useCallback((function(n){if("function"!=typeof e||e())return n.preventDefault(),t&&(n.returnValue=t),t}),[e,t]);a.useEffect((function(){if(e)return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}),[e,n])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(636));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=["mousedown","touchstart"];t.default=function(e,t,n){void 0===n&&(n=r);var s=a.useRef(t);a.useEffect((function(){s.current=t}),[t]),a.useEffect((function(){for(var t=function(t){var n=e.current;n&&!n.contains(t.target)&&s.current(t)},a=0,r=n;a<r.length;a++){var o=r[a];i.on(document,o,t)}return function(){for(var e=0,a=n;e<a.length;e++){var r=a[e];i.off(document,r,t)}}}),[n,e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(998));t.default=function(e){var t=i.useState((function(){return r.default.get(e)||null})),n=t[0],a=t[1];return[n,i.useCallback((function(t,n){r.default.set(e,t,n),a(t)}),[e]),i.useCallback((function(){r.default.remove(e),a(null)}),[e])]}},function(e,t,n){var a,i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */r=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(a){function i(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var l in r)r[l]&&(o+="; "+l,!0!==r[l]&&(o+="="+r[l].split(";")[0]));return document.cookie=t+"="+n+o}}function s(e,n){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var o=r[s].split("="),l=o.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var u=t(o[0]);if(l=(a.read||a)(l,u)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(i[u]=l,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))},void 0===(i="function"==typeof(a=r)?a.call(t,n,t,e):a)||(e.exports=i),e.exports=r()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(576)),r=n(2),s=a.__importDefault(n(251)),o=a.__importDefault(n(327));t.default=function(){var e=s.default(),t=o.default({value:void 0,error:void 0,noUserInteraction:!0}),n=t[0],a=t[1];return[n,r.useCallback((function(t){var n,r;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var s=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void a({value:t,error:s,noUserInteraction:!0})}if(""===t)return s=new Error("Cannot copy empty string to clipboard."),void a({value:t,error:s,noUserInteraction:!0});r=t.toString(),n=i.default(r),a({value:r,error:void 0,noUserInteraction:n})}catch(s){a({value:r,error:s,noUserInteraction:n})}}),[])]}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(1002),r=n(1003),s=n(1004),o=n(1006),l=n(2),u=a.__importDefault(n(37)),c=i.create();r.addon(c),s.addon(c);var d=0;t.default=function(e){var t=l.useMemo((function(){return"react-use-css-"+(d++).toString(36)}),[]),n=l.useMemo((function(){return new c.VSheet}),[]);return u.default((function(){var a={};return o.cssToTree(a,e,"."+t,""),n.diff(a),function(){n.diff({})}})),t}},function(e,t,n){"use strict";var a=/[A-Z]/g;t.create=function(e){var t=(e=e||{}).assign||Object.assign,n=t({raw:"",pfx:"_",client:"object"==typeof window,assign:t,stringify:JSON.stringify,kebab:function(e){return e.replace(a,"-$&").toLowerCase()},decl:function(e,t){return(e=n.kebab(e))+":"+t+";"},hash:function(e){return function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return"_"+(t>>>0).toString(36)}(n.stringify(e))},selector:function(e,t){return e+(":"===t[0]?"":" ")+t},putRaw:function(e){n.raw+=e}},e);return n.client&&(n.sh||document.head.appendChild(n.sh=document.createElement("style")),n.putRaw=function(e){var t=n.sh.sheet;try{t.insertRule(e,t.cssRules.length)}catch(e){}}),n.put=function(e,t,a){var i,r,s="",o=[];for(i in t)(r=t[i])instanceof Object&&!(r instanceof Array)?o.push(i):s+=n.decl(i,r,e,a);s&&(s=e+"{"+s+"}",n.putRaw(a?a+"{"+s+"}":s));for(var l=0;l<o.length;l++)"@"===(i=o[l])[0]&&"@font-face"!==i?n.putAt(e,t[i],i):n.put(n.selector(e,i),t[i],a)},n.putAt=n.put,n}},function(e,t,n){"use strict";t.addon=function(e){e.client&&(document.head.appendChild(e.msh=document.createElement("style")),e.createRule=function(t,n){var a=t+"{}";n&&(a=n+"{"+a+"}");var i=n?e.msh.sheet:e.sh.sheet,r=i.insertRule(a,i.cssRules.length),s=(i.cssRules||i.rules)[r];if(s.index=r,n){var o=(s.cssRules||s.rules)[0];s.style=o.style,s.styleMap=o.styleMap}return s})}},function(e,t,n){"use strict";var a=n(1005).removeRule;t.addon=function(e){if(e.client){var t=e.kebab;n.prototype.diff=function(e){var n,a=this.decl,i=this.rule.style;for(n in a)void 0===e[n]&&i.removeProperty(n);for(n in e)e[n]!==a[n]&&i.setProperty(t(n),e[n]);this.decl=e},n.prototype.del=function(){a(this.rule)},i.prototype.diff=function(e){var t=this.tree;for(var a in t)if(void 0===e[a]){var i=t[a];for(var r in i)i[r].del()}for(var a in e)if(void 0===t[a])for(var r in e[a])(l=new n(r,a)).diff(e[a][r]),e[a][r]=l;else{var s=t[a],o=e[a];for(var r in s)o[r]||s[r].del();for(var r in o){var l;(l=s[r])?(l.diff(o[r]),o[r]=l):((l=new n(r,a)).diff(o[r]),o[r]=l)}}this.tree=e},e.VRule=n,e.VSheet=i}function n(t,n){this.rule=e.createRule(t,n),this.decl={}}function i(){this.tree={}}}},function(e,t){t.removeRule=function(e){var t=e.index,n=e.parentStyleSheet,a=n.cssRules||n.rules;for(t=Math.max(t,a.length-1);t>=0;){if(a[t]===e){n.deleteRule(t);break}t--}}},function(e,t){t.cssToTree=function e(t,n,a,i){var r,s,o={},l=!1;for(r in n)"object"!=typeof(s=n[r])&&(l=!0,o[r]=s);for(r in l&&(t[i]||(t[i]={}),t[i][a]=o),n)if("object"==typeof(s=n[r]))if("@"===r[0])e(t,s,a,r);else{var u=r.indexOf("&")>-1,c=a.split(",");if(u)for(var d=0;d<c.length;d++)c[d]=r.replace(/&/g,c[d]);else for(d=0;d<c.length;d++)c[d]=c[d]+" "+r;e(t,s,c.join(","),i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(t),i=n[0],r=n[1];return null==i?[e,r]:[i,r]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=function(){};t.default=function(e,t){void 0===e&&(e={}),void 0===t&&(t=[]);var n=e.onFiles,s=e.onText,o=e.onUri,l=i.useState(!1),u=l[0],c=l[1],d=i.useCallback(c,[]),m=i.useMemo((function(){return function(e){return function(t,n){var a=t.getData("text/uri-list");if(a)(e.onUri||r)(a,n);else if(t.files&&t.files.length)(e.onFiles||r)(Array.from(t.files),n);else if(n.clipboardData){var i=n.clipboardData.getData("text");(e.onText||r)(i,n)}}}(e)}),[n,s,o]);return i.useEffect((function(){var e=function(e){e.preventDefault(),d(!0)},t=function(e){e.preventDefault(),d(!0)},n=function(){d(!1)},a=function(){d(!1)},i=function(e){e.preventDefault(),d(!1),m(e.dataTransfer,e)},r=function(e){m(e.clipboardData,e)};return document.addEventListener("dragover",e),document.addEventListener("dragenter",t),document.addEventListener("dragleave",n),document.addEventListener("dragexit",a),document.addEventListener("drop",i),s&&document.addEventListener("paste",r),function(){document.removeEventListener("dragover",e),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",n),document.removeEventListener("dragexit",a),document.removeEventListener("drop",i),document.removeEventListener("paste",r)}}),a.__spreadArrays([m],t)),{over:u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251)),s=function(){};t.default=function(e){void 0===e&&(e={});var t=e.onFiles,n=e.onText,a=e.onUri,o=r.default(),l=i.useState(!1),u=l[0],c=l[1],d=i.useMemo((function(){return function(e,t){return function(n,a){var i=n.getData("text/uri-list");i?(e.onUri||s)(i,a):n.files&&n.files.length?(e.onFiles||s)(Array.from(n.files),a):n.items&&n.items.length&&n.items[0].getAsString((function(n){t&&(e.onText||s)(n,a)}))}}(e,o())}),[t,n,a]),m=i.useMemo((function(){return function(e,t){return{onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault(),t(!0)},onDragLeave:function(){t(!1)},onDrop:function(n){n.preventDefault(),n.persist(),t(!1),e(n.dataTransfer,n)},onPaste:function(t){t.persist(),e(t.clipboardData,t)}}}(d,c)}),[d,c]);return[m,{over:u}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredForwardRef=void 0;var a=n(2);function i(e){var t=a.useRef(e&&e.current);return a.useEffect((function(){e&&(e.current=t.current)}),[e]),t}t.default=i,t.ensuredForwardRef=function(e){return a.forwardRef((function(t,n){var a=i(n);return e(t,a)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(null),t=e[0],n=e[1];return a.useEffect((function(){if(t)throw t}),[t]),a.useCallback((function(e){n(e)}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect((function(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(1014)),s=a.__importDefault(n(37)),o=function(){};t.default=function(e,t,n){void 0===n&&(n={});var a=n.video,l=n.onClose,u=void 0===l?o:l,c=i.useState(t),d=c[0],m=c[1];return s.default((function(){if(t&&e.current){var n=function(){a.current.removeEventListener("webkitendfullscreen",n),u()},i=function(){if(r.default.isEnabled){var e=r.default.isFullscreen;m(e),e||u()}};if(r.default.isEnabled){try{r.default.request(e.current),m(!0)}catch(e){u(e),m(!1)}r.default.on("change",i)}else a&&a.current&&a.current.webkitEnterFullscreen?(a.current.webkitEnterFullscreen(),a.current.addEventListener("webkitendfullscreen",n),m(!0)):(u(),m(!1));return function(){if(m(!1),r.default.isEnabled)try{r.default.off("change",i),r.default.exit()}catch(e){}else a&&a.current&&a.current.webkitExitFullscreen&&(a.current.removeEventListener("webkitendfullscreen",n),a.current.webkitExitFullscreen())}}}),[t,a,e]),d}},function(e,t,n){
/*!
* screenfull
* v5.0.0 - 2019-09-09
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,a=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,i=n.length,r={};a<i;a++)if((e=n[a])&&e[1]in t){for(a=0;a<e.length;a++)r[n[0][a]]=e[a];return r}return!1}(),i={change:a.fullscreenchange,error:a.fullscreenerror},r={request:function(e){return new Promise(function(n,i){var r=function(){this.off("change",r),n()}.bind(this);this.on("change",r),e=e||t.documentElement,Promise.resolve(e[a.requestFullscreen]()).catch(i)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i),Promise.resolve(t[a.exitFullscreen]()).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var a=i[e];a&&t.addEventListener(a,n,!1)},off:function(e,n){var a=i[e];a&&t.removeEventListener(a,n,!1)},raw:a};a?(Object.defineProperties(r,{isFullscreen:{get:function(){return Boolean(t[a.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[a.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[a.fullscreenEnabled])}}}),n?e.exports=r:window.screenfull=r):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){var t,n=i.useState({loading:!0,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),r=n[0],s=n[1],o=!0,l=function(e){o&&s({loading:!1,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})},u=function(e){return o&&s((function(t){return a.__assign(a.__assign({},t),{loading:!1,error:e})}))};return i.useEffect((function(){return navigator.geolocation.getCurrentPosition(l,u,e),t=navigator.geolocation.watchPosition(l,u,e),function(){o=!1,navigator.geolocation.clearWatch(t)}}),[]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(280));t.default=function(e){void 0===e&&(e={});var t=r.default(),n=i.useRef(a.__assign({},e));return[i.useCallback((function(){return n.current}),[]),i.useCallback((function(e){e&&(Object.assign(n.current,e),t())}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(1018);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=i.setHarmonicInterval((function(){return n.current()}),t);return function(){return i.clearHarmonicInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,i={};t.clearHarmonicInterval=function(e){var t=e.bucket,n=e.id;delete t.listeners[n];var a=!1;for(var r in t.listeners){a=!0;break}a||(clearInterval(t.timer),delete i[t.ms])},t.setHarmonicInterval=function(e,t){var n,r=a++;if(i[t])i[t].listeners[r]=e;else{var s=setInterval((function(){for(var e,n=i[t].listeners,a=!1,r=0,s=Object.values(n);r<s.length;r++){var o=s[r];try{o()}catch(t){a=!0,e=t}}if(a)throw e}),t);i[t]={ms:t,timer:s,listeners:(n={},n[r]=e,n)}}return{bucket:i[t],id:r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importStar(n(2)),i=a.useState,r=function(){};t.default=function(e){var t,n,s=i(!1),o=s[0],l=s[1];return"function"==typeof e&&(e=e(o)),[a.cloneElement(e,{onMouseEnter:(n=e.props.onMouseEnter,function(e){(n||r)(e),l(!0)}),onMouseLeave:(t=e.props.onMouseLeave,function(e){(t||r)(e),l(!1)})}),o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(1021),r=n(154),s=["mousemove","mousedown","resize","keydown","touchstart","wheel"];t.default=function(e,t,n){void 0===e&&(e=6e4),void 0===t&&(t=!1),void 0===n&&(n=s);var o=a.useState(t),l=o[0],u=o[1];return a.useEffect((function(){for(var t,a=!0,s=l,o=function(e){a&&(s=e,u(e))},c=i.throttle(50,(function(){s&&o(!1),clearTimeout(t),t=setTimeout((function(){return o(!0)}),e)})),d=function(){document.hidden||c()},m=0;m<n.length;m++)r.on(window,n[m],c);return r.on(document,"visibilitychange",d),t=setTimeout((function(){return o(!0)}),e),function(){a=!1;for(var e=0;e<n.length;e++)r.off(window,n[e],c);r.off(document,"visibilitychange",d)}}),[e,n]),l}},function(e,t,n){"use strict";function a(e,t,n,a){var i,r=!1,s=0;function o(){i&&clearTimeout(i)}function l(){var l=this,u=Date.now()-s,c=arguments;function d(){s=Date.now(),n.apply(l,c)}r||(a&&!i&&d(),o(),void 0===a&&u>e?d():!0!==t&&(i=setTimeout(a?function(){i=void 0}:d,void 0===a?e-u:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){o(),r=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=a,t.debounce=function(e,t,n){return void 0===n?a(e,t,!1):a(e,n,!1!==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(null),i=n[0],r=n[1];return a.useEffect((function(){if(e.current&&"function"==typeof IntersectionObserver){var n=new IntersectionObserver((function(e){r(e[0])}),t);return n.observe(e.current),function(){r(null),n.disconnect()}}return function(){}}),[e.current,t.threshold,t.root,t.rootMargin]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return void 0===e&&(e={laptopL:1440,laptop:1024,tablet:768}),function(){var t=a.useState(0),n=t[0],i=t[1];a.useEffect((function(){var e=function(){i(window.innerWidth)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var r=a.useMemo((function(){return Object.entries(e).sort((function(e,t){return e[1]>=t[1]?1:-1}))}),[e]),s=r.reduce((function(e,t){var a=t[0],i=t[1];return n>=i?a:e}),r[0][0]);return s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(641)),r=a.__importDefault(n(326));t.default=function(e,t,n,a){void 0===a&&(a=i.default);var s=a(e),o=s[0],l=s[1];r.default((function(){!o&&n?n(l):o&&t&&t(l)}),[o])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(e){var t=window.history,n=t[e];t[e]=function(t){var a=n.apply(this,arguments),i=new Event(e.toLowerCase());return i.state=t,window.dispatchEvent(i),a}};i.isClient&&(r("pushState"),r("replaceState"));var s=function(e){var t=window.history,n=t.state,a=t.length,i=window.location;return{trigger:e,state:n,length:a,hash:i.hash,host:i.host,hostname:i.hostname,href:i.href,origin:i.origin,pathname:i.pathname,port:i.port,protocol:i.protocol,search:i.search}},o="function"==typeof Event;t.default=i.isClient&&o?function(){var e=a.useState(s("load")),t=e[0],n=e[1];return a.useEffect((function(){var e=function(){return n(s("popstate"))},t=function(){return n(s("pushstate"))},a=function(){return n(s("replacestate"))};return i.on(window,"popstate",e),i.on(window,"pushstate",t),i.on(window,"replacestate",a),function(){i.off(window,"popstate",e),i.off(window,"pushstate",t),i.off(window,"replacestate",a)}}),[]),t}:function(){return{trigger:"load",length:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestBody=void 0;var a=n(2);function i(e){if(!e)return null;if("BODY"===e.tagName)return e;if("IFRAME"===e.tagName){var t=e.contentDocument;return t?t.body:null}return e.offsetParent?i(e.offsetParent):null}function r(e){var t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)}t.getClosestBody=i;var s="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),o=new Map,l="object"==typeof document?document:void 0,u=!1;t.default=l?function(e,t){void 0===e&&(e=!0);var n=a.useRef(l.body);t=t||n;var c=function(e){var t=o.get(e);t&&(1===t.counter?(o.delete(e),s?(e.ontouchmove=null,u&&(document.removeEventListener("touchmove",r),u=!1)):e.style.overflow=t.initialOverflow):o.set(e,{counter:t.counter-1,initialOverflow:t.initialOverflow}))};a.useEffect((function(){var n=i(t.current);n&&(e?function(e){var t=o.get(e);t?o.set(e,{counter:t.counter+1,initialOverflow:t.initialOverflow}):(o.set(e,{counter:1,initialOverflow:e.style.overflow}),s?u||(document.addEventListener("touchmove",r,{passive:!1}),u=!0):e.style.overflow="hidden")}(n):c(n))}),[e,t.current]),a.useEffect((function(){var e=i(t.current);if(e)return function(){c(e)}}),[])}:function(e,t){void 0===e&&(e=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(328)),r=a.__importDefault(n(326));t.default=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.default((function(){return console.log.apply(console,a.__spreadArrays([e+" mounted"],t)),function(){return console.log(e+" unmounted")}})),r.default((function(){console.log.apply(console,a.__spreadArrays([e+" updated"],t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};t.default=function(e,t){var n=void 0===t?{}:t,r=n.isPreventDefault,s=void 0===r||r,o=n.delay,l=void 0===o?300:o,u=a.useRef(),c=a.useRef(),d=a.useCallback((function(t){s&&t.target&&(t.target.addEventListener("touchend",i,{passive:!1}),c.current=t.target),u.current=setTimeout((function(){return e(t)}),l)}),[e,l,s]),m=a.useCallback((function(){u.current&&clearTimeout(u.current),s&&c.current&&c.current.removeEventListener("touchend",i)}),[s]);return{onMouseDown:function(e){return d(e)},onTouchStart:function(e){return d(e)},onMouseUp:m,onMouseLeave:m,onTouchEnd:m}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154);t.default=function(e,t){void 0===t&&(t=!1);var n=a.useState(i.isClient?function(){return window.matchMedia(e).matches}:t),r=n[0],s=n[1];return a.useEffect((function(){var t=!0,n=window.matchMedia(e),a=function(){t&&s(!!n.matches)};return n.addListener(a),s(n.matches),function(){t=!1,n.removeListener(a)}}),[e]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(){};t.default="object"==typeof navigator&&navigator.mediaDevices?function(){var e=a.useState({}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,t=function(){navigator.mediaDevices.enumerateDevices().then((function(t){e&&n({devices:t.map((function(e){return{deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label}}))})})).catch(r)};return i.on(navigator.mediaDevices,"devicechange",t),t(),function(){e=!1,i.off(navigator.mediaDevices,"devicechange",t)}}),[]),t}:function(){return{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMediatedState=void 0;var a=n(2);t.useMediatedState=function(e,t){var n=a.useRef(e),i=a.useState(t),r=i[0],s=i[1];return[r,a.useCallback((function(e){2===n.current.length?n.current(e,s):s(n.current(e))}),[r])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useMemo((function(){return function(t,n){var a;return(a=e(t))[n.type].apply(a,n.payload)}}),[e]),i=a.useReducer(n,t),r=i[0],s=i[1],o=a.useMemo((function(){return Object.keys(e(t)).reduce((function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return s({type:t,payload:e})},e}),{})}),[e,t]);return[r,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r={acceleration:{x:null,y:null,z:null},accelerationIncludingGravity:{x:null,y:null,z:null},rotationRate:{alpha:null,beta:null,gamma:null},interval:16};t.default=function(e){void 0===e&&(e=r);var t=a.useState(e),n=t[0],s=t[1];return a.useEffect((function(){var e=function(e){var t=e.acceleration,n=e.accelerationIncludingGravity,a=e.rotationRate,i=e.interval;s({acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:n.x,y:n.y,z:n.z},rotationRate:{alpha:a.alpha,beta:a.beta,gamma:a.gamma},interval:i})};return i.on(window,"devicemotion",e),function(){i.off(window,"devicemotion",e)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(639)),r=a.__importDefault(n(647)),s={current:null};t.default=function(e,t){void 0===t&&(t={});var n=!!t.whenHovered,a=!!t.bound,o=i.default(e,n),l=r.default(n&&!o?s:e);return a&&(l.elX=Math.max(0,Math.min(l.elX,l.elW)),l.elY=Math.max(0,Math.min(l.elY,l.elH))),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(0),t=e[0],n=e[1];return a.useEffect((function(){var e=function(e){n(e.deltaY+t)};return window.addEventListener("wheel",e,!1),function(){return window.removeEventListener("wheel",e)}})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=n(154),s=function(){if("object"!=typeof navigator)return null;var e=navigator;return e.connection||e.mozConnection||e.webkitConnection},o=function(){var e=s();return e?{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,type:e.type,rtt:e.rtt}:{}};t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],l=t[1];return i.useEffect((function(){var e=n,t=function(t){e=a.__assign(a.__assign({},e),t),l(e)},i=s(),u=function(){t({online:!0,since:new Date})},c=function(){t({online:!1,since:new Date})},d=function(){t(o())};return r.on(window,"online",u),r.on(window,"offline",c),i&&(r.on(i,"change",d),t(a.__assign(a.__assign(a.__assign({},n),{online:navigator.onLine,since:void 0}),o()))),function(){r.off(window,"online",u),r.off(window,"offline",c),i&&r.off(i,"change",d)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(637));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r={angle:0,type:"landscape-primary"};t.default=function(e){void 0===e&&(e=r);var t=window.screen,n=a.useState(e),s=n[0],o=n[1];return a.useEffect((function(){var n=!0,a=function(){if(n){var a=t.orientation;if(a){var i=a.angle,r=a.type;o({angle:i,type:r})}else window.orientation?o({angle:"number"==typeof window.orientation?window.orientation:0,type:""}):o(e)}};return i.on(window,"orientationchange",a),a(),function(){n=!1,i.off(window,"orientationchange",a)}}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=[]),a.useEffect((function(){if(e){var t=function(t){var n=(t=t||window.event).relatedTarget||t.toElement;n&&"HTML"!==n.nodeName||e()};return document.addEventListener("mouseout",t),function(){document.removeEventListener("mouseout",t)}}}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(){};t.default=function(e){var t=!0,n=null,s=a.useState(""),o=s[0],l=s[1],u=function(){t&&n&&l(n.state)};return a.useEffect((function(){return navigator.permissions.query(e).then((function(e){n=e,u(),i.on(n,"change",u)})).catch(r),function(){t=!1,n&&i.off(n,"change",u)}}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(371),r=function(e,t){return e===t};t.default=function(e,t){void 0===t&&(t=r);var n=a.useRef(),s=a.useRef(e);return i.useFirstMountState()||t(s.current,e)||(n.current=s.current,s.current=e),n.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251));t.default=function(){var e=r.default();return i.useCallback((function(t){return new Promise((function(n,a){t.then((function(t){e()&&n(t)}),(function(t){e()&&a(t)}))}))}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){void 0===e&&(e=[]);var t=i.useState(e),n=t[0],r=t[1];return{add:function(e){r((function(t){return a.__spreadArrays(t,[e])}))},remove:function(){var e;return r((function(t){var n=t[0],a=t.slice(1);return e=n,a})),e},get first(){return n[0]},get last(){return n[n.length-1]},get size(){return n.length}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useRef(null),i=a.useRef(!1),r=a.useRef(e);r.current=e;var s=a.useCallback((function(e){i.current&&(r.current(e),n.current=requestAnimationFrame(s))}),[]),o=a.useMemo((function(){return[function(){i.current&&(i.current=!1,n.current&&cancelAnimationFrame(n.current))},function(){i.current||(i.current=!0,n.current=requestAnimationFrame(s))},function(){return i.current}]}),[]);return a.useEffect((function(){return t&&o[1](),o[0]}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return new URLSearchParams(e).get(t)};t.default="object"==typeof window?function(e){var t=window.location,n=a.useState((function(){return i(t.search,e)})),r=n[0],s=n[1];return a.useEffect((function(){var n=function(){s(i(t.search,e))};return window.addEventListener("popstate",n),window.addEventListener("pushstate",n),window.addEventListener("replacestate",n),function(){window.removeEventListener("popstate",n),window.removeEventListener("pushstate",n),window.removeEventListener("replacestate",n)}}),[]),r}:function(){return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScratchSensor=void 0;var a=n(34),i=n(2),r=n(1048),s=a.__importDefault(n(642)),o=function(){},l=function(e){void 0===e&&(e={});var t=e.disabled,n=s.default(e),r=i.useState({isScratching:!1}),l=r[0],u=r[1],c=i.useRef(l),d=i.useRef(!1),m=i.useRef(null),p=i.useState(null),f=p[0],b=p[1];return i.useEffect((function(){if(!t&&f){var e,i,r=function(e,t){cancelAnimationFrame(m.current),m.current=requestAnimationFrame((function(){var i=f.getBoundingClientRect(),r=i.left,s=i.top,l=r+window.scrollX,d=s+window.scrollY,m=e-l,p=t-d;u((function(e){var t=a.__assign(a.__assign({},e),{dx:m-(e.x||0),dy:p-(e.y||0),end:Date.now(),isScratching:!0});return c.current=t,(n.current.onScratch||o)(t),t}))}))},s=function(e){r(e.pageX,e.pageY)},l=function(e){r(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},p=function(){d.current&&(d.current=!1,c.current=a.__assign(a.__assign({},c.current),{isScratching:!1}),(n.current.onScratchEnd||o)(c.current),u({isScratching:!1}),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i))};e=p,i=p;var b=function(t,a){if(d.current){var r=f.getBoundingClientRect(),m=r.left,p=r.top,b=m+window.scrollX,g=p+window.scrollY,v=t-b,y=a-g,h=Date.now(),j={isScratching:!0,start:h,end:h,docX:t,docY:a,x:v,y:y,dx:0,dy:0,elH:f.offsetHeight,elW:f.offsetWidth,elX:b,elY:g};c.current=j,(n.current.onScratchStart||o)(j),u(j),window.addEventListener("mousemove",s),window.addEventListener("touchmove",l),window.addEventListener("mouseup",e),window.addEventListener("touchend",i)}},g=function(e){d.current=!0,b(e.pageX,e.pageY)},v=function(e){d.current=!0,b(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return f.addEventListener("mousedown",g),f.addEventListener("touchstart",v),function(){f.removeEventListener("mousedown",g),f.removeEventListener("touchstart",v),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i),m.current&&cancelAnimationFrame(m.current),m.current=null,d.current=!1,c.current={isScratching:!1},u(c.current)}}}),[f,t,n]),[b,l]};t.ScratchSensor=function(e){e.children;var t=a.__rest(e,["children"]),n=l(t),s=n[0],o=n[1],u=r.render(e,o);return i.cloneElement(u,a.__assign(a.__assign({},u.props),{ref:function(e){u.props.ref&&("object"==typeof u.props.ref&&(u.props.ref.current=e),"function"==typeof u.props.ref&&u.props.ref(e)),s(e)}}))},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hookToRenderProp=t.createEnhancer=t.render=void 0;var a=n(34),i=a.__importDefault(n(649));t.render=i.default;var r=a.__importDefault(n(1049));t.createEnhancer=r.default;var s=a.__importDefault(n(1052));t.hookToRenderProp=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divWrapper=void 0;var a=n(34),i=a.__importStar(n(2)),r=a.__importDefault(n(1050)),s=i.createElement,o=function(e,t,n,i){var r;return s(e,t?a.__assign(((r={})[t]=i,r),n):a.__assign(a.__assign({},i),n))};t.divWrapper=function(e,t,n,a){return s("div",null,o(e,t,n,a))},t.default=function(e,t,n){void 0===n&&(n=o);var a=function(i,o,l){void 0===o&&(o=t),void 0===l&&(l=null);var u="string"==typeof i;if(u)return function(e){return a(e,i||t,o)};var c=function(t){return s(e,l,(function(e){return n(i,o,t,e)}))};return u?r.default(c):c};return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(1051));t.default=function(e){return e.prototype?e:a.default(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importStar(n(2));t.default=function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(n,t),n.prototype.render=function(){return e(this.props,this.context)},n}(i.Component);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(649)),i=function(e){return[e]};t.default=function(e,t){return void 0===t&&(t=i),function(n){return a.default(n,e.apply(void 0,t(n)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(329));t.default=function(e){var t=r.default({x:0,y:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&e.current.addEventListener("scroll",t,{capture:!1,passive:!0}),function(){e.current&&e.current.removeEventListener("scroll",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useState(!1),n=t[0],i=t[1];return a.useEffect((function(){if(e.current){var t,n=function(){i(!0),clearTimeout(t),t=setTimeout((function(){i(!1)}),150)};return e.current.addEventListener("scroll",n,!1),function(){e.current&&e.current.removeEventListener("scroll",n,!1)}}return function(){}}),[e]),n}},function(e,t){var n=Object.keys;t.equal=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var a=n(e),i=a.length,r=0;r<i;r++)if(!(a[r]in t))return!1;for(r=0;r<i;r++)if(e[a[r]]!==t[a[r]])return!1;return i===n(t).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importStar(n(2)),r=n(154),s=i.useState,o=i.useEffect,l=i.useRef;t.default=function(e,t){var n=void 0===t?{}:t,u=n.width,c=void 0===u?1/0:u,d=n.height,m=void 0===d?1/0:d;if(!r.isClient)return["function"==typeof e?e({width:c,height:m}):e,{width:c,height:m}];var p=s({width:c,height:m}),f=p[0],b=p[1];"function"==typeof e&&(e=e(f));var g=e.props.style||{},v=l(null),y=null,h=function(){var e=v.current,t=e?{width:e.offsetWidth,height:e.offsetHeight}:{width:c,height:m};b(t)},j=function(e){e.addEventListener("resize",h),setTimeout(h,35)};return o((function(){var e=v.current;if(e){if(e.contentWindow)y=e.contentWindow,j(y);else{var t=function(){e.removeEventListener("load",t),y=e.contentWindow,j(y)};e.addEventListener("load",t)}return function(){y&&y.removeEventListener&&y.removeEventListener("resize",h)}}}),[]),g.position="relative",[i.cloneElement.apply(i,a.__spreadArrays([e,{style:g}],a.__spreadArrays([i.createElement("iframe",{ref:v,style:{background:"transparent",border:"none",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:-1}})],i.Children.toArray(e.props.children)))),f]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=n(154),s=a.__importDefault(n(251)),o=a.__importDefault(n(327)),l=function(){};t.default=function(e,t){void 0===t&&(t={});var n=s.default(),a=i.useRef(!1),u=i.useRef(0),c=i.useRef(0),d=o.default({isSliding:!1,value:0}),m=d[0],p=d[1];return u.current=m.value,i.useEffect((function(){if(r.isClient){var i=void 0===t.styles||t.styles,s=void 0!==t.reverse&&t.reverse;e.current&&i&&(e.current.style.userSelect="none");var o=function(){!a.current&&n()&&((t.onScrubStart||l)(),a.current=!0,p({isSliding:!0}),v())},d=function(){a.current&&n()&&((t.onScrubStop||l)(u.current),a.current=!1,p({isSliding:!1}),y())},m=function(e){o(),f(e)},f=t.vertical?function(e){return h(e.clientY)}:function(e){return h(e.clientX)},b=function(e){o(),g(e)},g=t.vertical?function(e){return h(e.changedTouches[0].clientY)}:function(e){return h(e.changedTouches[0].clientX)},v=function(){r.on(document,"mousemove",f),r.on(document,"mouseup",d),r.on(document,"touchmove",g),r.on(document,"touchend",d)},y=function(){r.off(document,"mousemove",f),r.off(document,"mouseup",d),r.off(document,"touchmove",g),r.off(document,"touchend",d)},h=function(a){cancelAnimationFrame(c.current),c.current=requestAnimationFrame((function(){if(n()&&e.current){var i=e.current.getBoundingClientRect(),r=t.vertical?i.top:i.left,o=t.vertical?i.height:i.width;if(!o)return;var u=(a-r)/o;u>1?u=1:u<0&&(u=0),s&&(u=1-u),p({value:u}),(t.onScrub||l)(u)}}))};return r.on(e.current,"mousedown",m),r.on(e.current,"touchstart",b),function(){r.off(e.current,"mousedown",m),r.off(e.current,"touchstart",b)}}}),[e,t.vertical]),m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(646)),s=a.__importDefault(n(327)),o="object"==typeof window&&"object"==typeof window.speechSynthesis?window.speechSynthesis.getVoices():[];t.default=function(e,t){void 0===t&&(t={});var n=s.default({isPlaying:!1,lang:t.lang||"default",voice:t.voice||o[0],rate:t.rate||1,pitch:t.pitch||1,volume:t.volume||1}),a=n[0],l=n[1],u=i.useRef(null);return r.default((function(){var n=new SpeechSynthesisUtterance(e);t.lang&&(n.lang=t.lang),t.voice&&(n.voice=t.voice),n.rate=t.rate||1,n.pitch=t.pitch||1,n.volume=t.volume||1,n.onstart=function(){return l({isPlaying:!0})},n.onresume=function(){return l({isPlaying:!0})},n.onend=function(){return l({isPlaying:!1})},n.onpause=function(){return l({isPlaying:!1})},u.current=n,window.speechSynthesis.speak(u.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(37));t.default=function(e){a.default((function(){var t=function(t){var n,a,i,r,s;!function(){var e=document.activeElement,t=document.body;if(!e)return!1;if(e===t)return!1;switch(e.tagName){case"INPUT":case"TEXTAREA":return!0}return e.hasAttribute("contenteditable")}()&&(a=(n=t).keyCode,i=n.metaKey,r=n.ctrlKey,s=n.altKey,!(i||r||s)&&(a>=48&&a<=57||a>=65&&a<=90))&&e(t)};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithHistory=void 0;var a=n(2),i=n(371),r=n(372);t.useStateWithHistory=function(e,t,n){if(void 0===t&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var s=i.useFirstMountState(),o=a.useState(e),l=o[0],u=o[1],c=a.useRef(null!=n?n:[]),d=a.useRef(0);return s&&(c.current.length?(c.current[c.current.length-1]!==e&&c.current.push(e),c.current.length>t&&(c.current=c.current.slice(c.current.length-t))):c.current.push(e),d.current=c.current.length&&c.current.length-1),[l,a.useCallback((function(e){u((function(n){return(e=r.resolveHookState(e))!==n&&(d.current<c.current.length-1&&(c.current=c.current.slice(0,d.current+1)),d.current=c.current.push(e)-1,c.current.length>t&&(c.current=c.current.slice(c.current.length-t))),e}))}),[l,t]),a.useMemo((function(){return{history:c.current,position:d.current,capacity:t,back:function(e){void 0===e&&(e=1),d.current&&u((function(){return d.current-=Math.min(e,d.current),c.current[d.current]}))},forward:function(e){void 0===e&&(e=1),d.current!==c.current.length-1&&u((function(){return d.current=Math.min(d.current+e,c.current.length-1),c.current[d.current]}))},go:function(e){e!==d.current&&u((function(){return d.current=e<0?Math.max(c.current.length+e,0):Math.min(c.current.length-1,e),c.current[d.current]}))}}}),[l])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251)),s=a.__importDefault(n(280)),o=a.__importDefault(n(326));t.default=function(e){void 0===e&&(e=[]);var t=r.default(),n=s.default(),l=i.useRef(0);o.default((function(){e.length<=l.current&&(l.current=e.length-1,n())}),[e.length]);var u=i.useMemo((function(){return{next:function(){return u.setStateAt(l.current+1)},prev:function(){return u.setStateAt(l.current-1)},setStateAt:function(a){t()&&e.length&&a!==l.current&&(l.current=a>=0?a%e.length:e.length+a%e.length,n())},setState:function(a){if(t()){var i=e.length?e.indexOf(a):-1;if(-1===i)throw new Error("State '"+a+"' is not a valid state (does not exist in state list)");l.current=i,n()}}}}),[e]);return a.__assign({state:e[l.current],currentIndex:l.current},u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(373));t.default=function(e,t){void 0===t&&(t=200);var n=i.useState(e),a=n[0],s=n[1],o=i.useRef(),l=i.useRef(null),u=i.useRef(0);return i.useEffect((function(){if(o.current)l.current=e,u.current=!0;else{s(e);var n=function(){u.current?(u.current=!1,s(l.current),o.current=setTimeout(n,t)):o.current=void 0};o.current=setTimeout(n,t)}}),[e]),r.default((function(){o.current&&clearTimeout(o.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(373));t.default=function(e,t,n){void 0===t&&(t=200);var a=i.useState(null),s=a[0],o=a[1],l=i.useRef(),u=i.useRef();return i.useEffect((function(){if(l.current)u.current=n;else{o(e.apply(void 0,n));var a=function(){u.current?(o(e.apply(void 0,u.current)),u.current=void 0,l.current=setTimeout(a,t)):l.current=void 0};l.current=setTimeout(a,t)}}),n),r.default((function(){l.current&&clearTimeout(l.current)})),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(462)),r=a.__importDefault(n(280));t.default=function(e){void 0===e&&(e=0);var t=r.default();return i.default(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i={restoreOnUnmount:!1};t.default="undefined"!=typeof document?function(e,t){void 0===t&&(t=i);var n=a.useRef(document.title);document.title=e,a.useEffect((function(){return t&&t.restoreOnUnmount?function(){document.title=n.current}:void 0}),[])}:function(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(1333),r=a.__importDefault(n(648));t.default=function(e,t,n){return void 0===e&&(e="inCirc"),void 0===t&&(t=200),void 0===n&&(n=0),(0,i.easing[e])(r.default(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1);return a.useEffect((function(){return function(){e.current=!0}})),a.useMemo((function(){return function(t,n){return new Promise((function(a,i){t.then((function(t){e.current||a(t)}),(function(t){e.current?n?n(t):console.error("useUnmountPromise",t):i(t)}))}))}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(644));t.default=function(e,t){void 0===t&&(t=[]);var n=i.default(t),r=n[0],s=n[1];return[r,a.__assign(a.__assign({},s),{upsert:function(t){s.upsert(e,t)}})]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i="object"==typeof navigator&&"vibrate"in navigator;t.default=i?function(e,t,n){void 0===e&&(e=!0),void 0===t&&(t=[1e3,1e3]),void 0===n&&(n=!0),a.useEffect((function(){var a;if(e&&(navigator.vibrate(t),n)){var i=t instanceof Array?t.reduce((function(e,t){return e+t})):t;a=setInterval((function(){navigator.vibrate(t)}),i)}return function(){e&&(navigator.vibrate(0),n&&clearInterval(a))}}),[e])}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(635)).default("video");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){void 0===n&&(n=[void 0]);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var s=a.useState(n),o=s[0],l=s[1],u=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){u()}),[e]),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useScrollbarWidth=void 0;var a=n(1073),i=n(2);t.useScrollbarWidth=function(){var e=i.useState(a.scrollbarWidth()),t=e[0],n=e[1];return i.useEffect((function(){if(void 0===t){var e=requestAnimationFrame((function(){n(a.scrollbarWidth())}));return function(){return cancelAnimationFrame(e)}}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if("undefined"==typeof document)return 0;if(document.body&&(!document.readyState||"loading"!==document.readyState)){if(!0!==e&&"number"==typeof a.__cache)return a.__cache;var t=document.createElement("div"),n=t.style;n.display="block",n.position="absolute",n.width="100px",n.height="100px",n.left="-999px",n.top="-999px",n.overflow="scroll",document.body.insertBefore(t,null);var i=t.clientWidth;if(0!==i)return a.__cache=100-i,document.body.removeChild(t),a.__cache;document.body.removeChild(t)}};t.scrollbarWidth=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMultiStateValidator=void 0;var a=n(2);t.useMultiStateValidator=function(e,t,n){if(void 0===n&&(n=[void 0]),"object"!=typeof e)throw new Error("states expected to be an object or array, got "+typeof e);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var s=a.useState(n),o=s[0],l=s[1],u=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){u()}),Object.values(e)),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=n(154),s=a.__importDefault(n(329));t.default=function(){var e=s.default({x:r.isClient?window.pageXOffset:0,y:r.isClient?window.pageYOffset:0}),t=e[0],n=e[1];return i.useEffect((function(){var e=function(){n({x:window.pageXOffset,y:window.pageYOffset})};return window.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){window.removeEventListener("scroll",e)}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(329)),s=n(154);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var n=r.default({width:s.isClient?window.innerWidth:e,height:s.isClient?window.innerHeight:t}),a=n[0],o=n[1];return i.useEffect((function(){if(s.isClient){var e=function(){o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(37)),s=n(154),o={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};t.default=s.isClient&&window.ResizeObserver?function(){var e=i.useState(null),t=e[0],n=e[1],a=i.useState(o),s=a[0],l=a[1],u=i.useMemo((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,a=t.y,i=t.width,r=t.height,s=t.top,o=t.left,u=t.bottom,c=t.right;l({x:n,y:a,width:i,height:r,top:s,left:o,bottom:u,right:c})}}))}),[]);return r.default((function(){if(t)return u.observe(t),function(){u.disconnect()}}),[t]),[n,s]}:function(){return[function(){},o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRendersCount=void 0;var a=n(2);t.useRendersCount=function(){return++a.useRef(0).current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),n=t[0],r=t[1],s=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(a.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(a.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),o=a.__assign({has:i.useCallback((function(e){return n.has(e)}),[n])},s);return[n,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGlobalState=void 0;var a=n(34),i=n(2),r=a.__importDefault(n(328)),s=a.__importDefault(n(37));function o(e){var t={state:e,setState:function(e){t.state=e,t.setters.forEach((function(e){return e(t.state)}))},setters:[]};return function(){var e=i.useState(t.state),n=e[0],a=e[1];return r.default((function(){return function(){t.setters=t.setters.filter((function(e){return e!==a}))}})),s.default((function(){t.setters.includes(a)||t.setters.push(a)})),[n,t.setState]}}t.createGlobalState=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHash=void 0;var a=n(34),i=n(2),r=a.__importDefault(n(643));t.useHash=function(){var e=i.useState((function(){return window.location.hash})),t=e[0],n=e[1],a=i.useCallback((function(){n(window.location.hash)}),[]);r.default((function(){window.addEventListener("hashchange",a)}),(function(){window.removeEventListener("hashchange",a)}));var s=i.useCallback((function(e){e!==t&&(window.location.hash=e)}),[t]);return[t,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(2),i=n(47),r=n(159),s=n(415),o=n(322);const l=["POST",s.e],u=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(r.w)({signal:e})),{...o.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(2),i=n(47),r=n(159),s=n(415),o=n(322);const l=["POST",s.f],u=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(r.x)({signal:e})),{...o.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(762);n(119),n(2),n(652),n(43),n(323),n(324),n(653);var i=a.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){i[e]=i(e)})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(515);function i(e){return e&&e.__esModule?e:{default:e}}var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,s=i(a).default((function(e){return r.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=s},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r="undefined"!=typeof document,s=!!i.useInsertionEffect&&i.useInsertionEffect,o=r&&s||function(e){return e()},l=s||i.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=o,t.useInsertionEffectWithLayoutFallback=l},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1089);case"v8light":return n(1091)}},function(e,t,n){var a=n(185),i=n(1090);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#2e2d25}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #343741}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#343741}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,n){var a=n(185),i=n(1092);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#fff9e8}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #d3dae6}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#e9edf3}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(233);function i(e,t,n,i,r,s,o){const l=null!=s?s:"html",u={hit:t,field:r,...o};return i&&r?i.getFormatterForField(r).convert(e,l,u):n.getDefaultInstance(a.b.STRING).convert(e,l,u)}},function(e,t,n){var a=n(185),i=n(1095);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,n){var a=n(185),i=n(1097);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByLabel",{defaultMessage:"Group by"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByPlaceholder",{defaultMessage:"Select a field to stack by"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByAriaLabel",{defaultMessage:"Stack the alerts histogram by a field value"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByTopLabel",{defaultMessage:"Group by top"})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return b}));var a=n(60),i=n.n(a),r=n(267),s=n(50);const o=Object(s.v4)();var l,u,c=n(1452);const d=(e,t)=>n=>`${c.e}: ${i()(n).format(e)} ${t?c.d(n):c.c(n)}`,m=[{text:"event.action",value:"event.action"},{text:"event.dataset",value:"event.dataset"},{text:"event.module",value:"event.module"}],p={defaultStackByOption:null!==(l=m.find((e=>"event.action"===e.text)))&&void 0!==l?l:m[0],stackByOptions:m,subtitle:void 0,title:c.b,getLensAttributes:(e="event.action",t={})=>{var n;return{title:"Events",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge",legendStats:["currentAndLastValue"]},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:o,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:null!==(n=t.filters)&&void 0!==n?n:[],datasourceStates:{formBased:{layers:{[o]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto",includeEmptyRows:!0}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",params:{emptyAsNull:!0}},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${o}`}]}}},f=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],b={defaultStackByOption:null!==(u=f.find((e=>"event.module"===e.text)))&&void 0!==u?u:f[0],stackByOptions:f,title:c.a,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge",legendStats:["currentAndLastValue"]},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto",includeEmptyRows:!0}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:r.g,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",params:{emptyAsNull:!0}},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:Object(r.p)(`${e}`),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),r=n(910),s=n(819),o=n(582),l=n(870);const u=()=>{const e=Object(l.e)(),t=Object(i.useHistory)(),{urlKey:n}=Object(s.b)(),u=n||r.a,c=Object(a.useCallback)((({right:t,left:n,preview:a})=>e(Object(o.f)({right:t,left:n,preview:a,id:u}))),[e,u]),d=Object(a.useCallback)((t=>e(Object(o.h)({right:t,id:u}))),[e,u]),m=Object(a.useCallback)((t=>e(Object(o.e)({left:t,id:u}))),[e,u]),p=Object(a.useCallback)((t=>e(Object(o.g)({preview:t,id:u}))),[e,u]),f=Object(a.useCallback)((()=>e(Object(o.d)({id:u}))),[e,u]),b=Object(a.useCallback)((()=>e(Object(o.a)({id:u}))),[e,u]),g=Object(a.useCallback)((()=>e(Object(o.c)({id:u}))),[e,u]),v=Object(a.useCallback)((()=>{u===r.a?e(Object(o.i)({id:u})):t.goBack()}),[e,u,t]),y=Object(a.useCallback)((()=>e(Object(o.b)({id:u}))),[e,u]);return Object(a.useMemo)((()=>({openFlyout:c,openRightPanel:d,openLeftPanel:m,openPreviewPanel:p,closeRightPanel:f,closeLeftPanel:b,closePreviewPanel:g,closeFlyout:y,previousPreviewPanel:v})),[c,d,m,p,f,b,g,y,v])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(19),i=n(41),r=n.n(i),s=n(2),o=n.n(s),l=n(1286),u=n(1343),c=n(1098);const d=r()(a.EuiPanel).withConfig({displayName:"KpiPanel",componentId:"sc-12zc7xr-0"})(["display:flex;flex-direction:column;position:relative;overflow-x:hidden;overflow-y:",";@media only screen and (min-width:","){","}",""],(({$overflowY:e})=>null!=e?e:"hidden"),(e=>e.theme.eui.euiBreakpoints.m),(({height:e,$toggleStatus:t})=>t&&`\n      height: ${null!=e?e:l.d}px;\n  `),(({$toggleStatus:e})=>e&&`\n    height: ${l.c}px;\n  `)),m=r.a.div.withConfig({displayName:"StackByComboBoxWrapper",componentId:"sc-12zc7xr-1"})(["max-width:400px;width:","px;"],(({width:e})=>e)),p=o.a.forwardRef((({"aria-label":e=c.c,"data-test-subj":t,isDisabled:n=!1,onSelect:i,prepend:r=c.d,selected:l,inputRef:d,width:p=400,dropDownoptions:f,useLensCompatibleFields:b},g)=>{const v=Object(s.useCallback)((e=>{e&&e.length>0?i(e[0].value):i("")}),[i]),y=Object(s.useMemo)((()=>[{label:l,value:l}]),[l]),h=Object(u.b)(b),j=Object(s.useMemo)((()=>null!=f?f:h()),[f,h]),O=Object(s.useMemo)((()=>({asPlainText:!0})),[]);return o.a.createElement(m,{width:p},o.a.createElement(a.EuiComboBox,{"data-test-subj":t,"aria-label":e,inputRef:d,isDisabled:n,placeholder:c.e,prepend:r,ref:g,singleSelection:O,isClearable:!1,sortMatchesBy:"startsWith",options:j,selectedOptions:y,compressed:!0,onChange:v}))}));p.displayName="StackByComboBox"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(2),i=n.n(a),r=n(41),s=n.n(r),o=n(19),l=n(44);const u=n(4).i18n.translate("xpack.securitySolution.components.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"});var c=n(224),d=n(903),m=n(514),p=n(257),f=n(282),b=n(568),g=n(417);const v=s()(d.a).withConfig({displayName:"HistogramPanel",componentId:"sc-cnfih-0"})(["display:flex;flex-direction:column;",""],(({height:e})=>null!=e?`min-height: ${e}px;`:"")),y=({chartHeight:e,defaultStackByOption:t,endDate:n,filterQuery:r,getLensAttributes:s,headerChildren:d,hideHistogramIfEmpty:y=!1,id:h,isPtrIncluded:j,lensAttributes:O,paddingSize:E="m",panelHeight:x=300,setQuery:S,showSpacer:w=!0,stackByOptions:k,startDate:C,subtitle:T,sourcererScopeId:M,title:I,titleSize:_,hideQueryToggle:A=!1,applyGlobalQueriesAndFilters:P=!0})=>{const D=`${h}-embeddable`,[F,R]=Object(a.useState)(!0),[N,z]=Object(a.useState)(t);Object(a.useEffect)((()=>{z(t)}),[t]);const L=Object(a.useCallback)((e=>{var n;z(null!==(n=k.find((t=>t.value===e.target.value)))&&void 0!==n?n:t)}),[t,k]),{toggleStatus:B,setToggleStatus:q}=Object(p.a)(h),V=Object(a.useCallback)((e=>{q(e)}),[q]),$=Object(a.useMemo)((()=>null!=I&&"function"==typeof I?I(N):I),[I,N]),{responses:U}=Object(g.a)({visualizationId:D}),G=Object(a.useMemo)((()=>{return U&&0!==(e=U).length&&Object.values(null!==(t=e[0].aggregations)&&void 0!==t?t:{}).some((({buckets:e})=>e.length>0))?U[0].hits.total:0;var e,t}),[U]),H=Object(a.useMemo)((()=>F?null:"function"==typeof T?G>=0?T(G):null:T),[F,T,G]),Q=Object(a.useMemo)((()=>!!((null!=G?G:0)<=0&&y)),[y,G]);Object(a.useEffect)((()=>{F&&U&&R(!1)}),[h,F,U,R,S]);const W=Object(a.useMemo)((()=>({from:C,to:n})),[C,n]),K=Object(a.useMemo)((()=>({dnsIsPtrIncluded:null!=j&&j,filters:r?[{query:Object(l.isString)(r)?JSON.parse(r):r,meta:{}}]:void 0})),[j,r]);return Q?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,{show:!F,targetClassNames:[f.a]},i.a.createElement(v,{"data-test-subj":`${h}Panel`,height:B?x:void 0,paddingSize:E},i.a.createElement(c.a,{id:h,height:B?void 0:0,title:$,titleSize:_,toggleStatus:B,toggleQuery:A?void 0:V,subtitle:H,showInspectButton:!1},i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(o.EuiFlexItem,{grow:!1},k.length>1&&i.a.createElement(o.EuiSelect,{onChange:L,options:k,prepend:u,value:null==N?void 0:N.value,"aria-label":u})),i.a.createElement(o.EuiFlexItem,{grow:!1},d))),B?i.a.createElement(b.a,{scopeId:M,applyGlobalQueriesAndFilters:P,"data-test-subj":"embeddable-matrix-histogram",extraOptions:K,getLensAttributes:s,height:null!=e?e:150,id:D,inspectTitle:I,lensAttributes:O,stackByField:N.value,timerange:W}):null)),w&&i.a.createElement(o.EuiSpacer,{"data-test-subj":"spacer",size:"l"}))},h=i.a.memo(y)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),i=n(1371);const r=a.exact(a.type({comment:i.a})),s=a.array(r),o=(a.union([s,a[void 0]]),new a.Type("DefaultCreateComments",a.array(r).is,(e=>null==e?a.success([]):a.array(r).decode(e)),a.identity))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(35)(188)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s}));const a="kibana.alert.rule.name",i="host.name",r=300,s=500},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(47),i=n(2081),r=n(2080),s=n(241);const o={page:1,per_page:1e3},l=[i.b,o.page,o.per_page,r.a.public.v1],u=e=>{const{assistantAvailability:{isAssistantEnabled:t},http:n}=Object(s.b)();return Object(a.useQuery)(l,(async()=>n.fetch(i.b,{method:"GET",version:r.a.public.v1,query:o,signal:null==e?void 0:e.signal})),{initialData:{data:[],page:1,perPage:5,total:0},placeholderData:{data:[],page:1,perPage:5,total:0},keepPreviousData:!0,enabled:t})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(47),i=n(86),r=n(69),s=n(577);const o=["elastic-assistant, load-action-types"],l=({http:e,toasts:t})=>Object(a.useQuery)(o,(async()=>(await Object(i.loadActionTypes)({http:e,featureId:r.GenerativeAIForSecurityConnectorFeatureId})).sort(((e,t)=>e.name.localeCompare(t.name)))),{retry:!1,keepPreviousData:!0,staleTime:6e4,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.i}))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m}));var a=n(2),i=n(659),r=n(241),s=n(1544),o=n(1456),l=n(1543);const u={page:0,perPage:0,total:0,data:[]},c={},d={page:0,perPage:0,total:0,data:[]},m=(e,t,n,c,d=u)=>{var m,p,f,b;const{assistantTelemetry:g,knowledgeBase:v,assistantStreamingEnabled:y,setAssistantStreamingEnabled:h,setKnowledgeBase:j,http:O,toasts:E}=Object(r.b)(),[x,S]=Object(a.useState)(e),[w,k]=Object(a.useState)({}),[C,T]=Object(a.useState)(t.data.filter((e=>e.promptType===i.a.quick))),[M,I]=Object(a.useState)(t.data.filter((e=>e.promptType===i.a.system))),[_,A]=Object(a.useState)({}),[P,D]=Object(a.useState)({}),[F,R]=Object(a.useState)(d),[N,z]=Object(a.useState)(y),[L,B]=Object(a.useState)(v),q=Object(a.useCallback)((()=>{S(e),k({}),T(t.data.filter((e=>e.promptType===i.a.quick))),B(v),z(y),I(t.data.filter((e=>e.promptType===i.a.system))),D({}),R(d)}),[t,d,y,e,v]),V=w.create||w.update||w.delete,$=_.create||_.update||_.delete,U=P.create||P.update||P.delete,G=Object(a.useCallback)((async()=>{var e,t,n;const a=U?await Object(l.a)(O,P,E):void 0;a&&a.attributes.results.created.forEach((e=>{w.create&&Object.values(w.create).forEach((t=>{var n;(null===(n=t.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)===e.name&&(t.apiConfig.defaultSystemPromptId=e.id)})),w.update&&Object.values(w.update).forEach((t=>{var n;(null===(n=t.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)===e.name&&(t.apiConfig.defaultSystemPromptId=e.id)}))}));const i=V?await Object(s.a)(O,w,E):void 0,r=y!==N,u=v.latestAlerts!==L.latestAlerts;(r||u)&&(null==g||g.reportAssistantSettingToggled({...u?{alertsCountUpdated:u}:{},...r?{assistantStreamingEnabled:N}:{}})),h(N),j(L);const c=$?await Object(o.a)(O,_,E):void 0;return D({}),k({}),(null===(e=null==i?void 0:i.success)||void 0===e||e)&&(null===(t=null==c?void 0:c.success)||void 0===t||t)&&(null===(n=null==a?void 0:a.success)||void 0===n||n)}),[U,O,P,E,V,w,y,N,v.latestAlerts,L,h,j,$,_,g]);return Object(a.useEffect)((()=>{var e,t,n,a;null!==(e=_.create)&&void 0!==e&&e.length||null!==(t=_.update)&&void 0!==t&&t.length||null!==(n=_.delete)&&void 0!==n&&null!==(a=n.ids)&&void 0!==a&&a.length||R(d)}),[d,null===(m=_.create)||void 0===m?void 0:m.length,null===(p=_.delete)||void 0===p||null===(f=p.ids)||void 0===f?void 0:f.length,null===(b=_.update)||void 0===b?void 0:b.length]),Object(a.useEffect)((()=>{n&&S(e)}),[e,n]),Object(a.useEffect)((()=>{c&&(T(t.data.filter((e=>e.promptType===i.a.quick))),I(t.data.filter((e=>e.promptType===i.a.system))))}),[t.data,c]),{conversationSettings:x,conversationsSettingsBulkActions:w,knowledgeBase:L,assistantStreamingEnabled:N,quickPromptSettings:C,resetSettings:q,systemPromptSettings:M,saveSettings:G,updatedAnonymizationData:F,setUpdatedAnonymizationData:R,anonymizationFieldsBulkActions:_,setAnonymizationFieldsBulkActions:A,setUpdatedKnowledgeBaseSettings:B,setUpdatedAssistantStreamingEnabled:z,setUpdatedQuickPromptSettings:T,setUpdatedSystemPromptSettings:I,setConversationSettings:S,setConversationsSettingsBulkActions:k,promptsBulkActions:P,setPromptsBulkActions:D}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="xs"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"q",(function(){return s})),n.d(t,"l",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"n",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"p",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"e",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return j}));var a=n(4);const i=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsLabel",{defaultMessage:"Alerts"}),r=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.askQuestionsAboutLabel",{defaultMessage:"Ask questions about the"}),e=>a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.latestAndRiskiestOpenAlertsLabel",{defaultMessage:"Send AI Assistant information about your {alertsCount} newest and riskiest open or acknowledged alerts.",values:{alertsCount:e}})),s=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.yourAnonymizationSettingsLabel",{defaultMessage:"Your anonymization settings will apply to these alerts."}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.selectFewerAlertsLabel",{defaultMessage:"Send fewer alerts if the model's context window is too small."}),l=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsRangeSliderLabel",{defaultMessage:"Alerts range"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsTitle",{defaultMessage:"Knowledge Base"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsBadgeTitle",{defaultMessage:"Experimental"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsDescription",{defaultMessage:"documentation"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseLabel",{defaultMessage:"Knowledge Base"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.setupKnowledgeBaseButton",{defaultMessage:"Setup"}),f=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.setupKnowledgeBaseButtonToolTip",{defaultMessage:"Knowledge Base unavailable, please see documentation for more details."}),b=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseTooltip",{defaultMessage:"ELSER must be configured to enable the Knowledge Base"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseDescription",{defaultMessage:"Index where Knowledge Base docs are stored"})),g=e=>a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseInstalledDescription",{defaultMessage:"Initialized to `{kbIndexPattern}`",values:{kbIndexPattern:e}}),v=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.initializeKnowledgeBaseButton",{defaultMessage:"Initialize"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.deleteKnowledgeBaseButton",{defaultMessage:"Delete"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserLabel",{defaultMessage:"ELSER Configured"})),y=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserMachineLearningDescription",{defaultMessage:"Machine Learning"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserSeeDocsDescription",{defaultMessage:"See docs"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlLabel",{defaultMessage:"ES|QL Knowledge Base Documents"})),h=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlDescription",{defaultMessage:"Knowledge Base docs for generating ES|QL queries"}),j=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlInstalledDescription",{defaultMessage:"ES|QL Knowledge Base docs loaded"})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(86),s=n(19),o=n(152),l=n(577),u=n(43);const c=Object(o.css)({name:"1vn7jfl",styles:"inline-size:240px;.euiKeyPadMenuItem__label{white-space:nowrap;overflow:hidden;}"}),d=i.a.memo((({actionTypes:e,actionTypeRegistry:t,onClose:n,onSelect:r,actionTypeSelectorInline:o})=>{const d=Object(a.useMemo)((()=>Object(u.jsx)(s.EuiFlexGroup,null,null==e?void 0:e.map((e=>{const n=t.get(e.id);return Object(u.jsx)(s.EuiFlexItem,{"data-test-subj":"action-option",key:e.id,grow:!1},Object(u.jsx)(s.EuiKeyPadMenuItem,{className:c,key:e.id,isDisabled:!e.enabled,label:e.name,"data-test-subj":`action-option-${e.name}`,onClick:()=>r(e)},Object(u.jsx)(s.EuiIcon,{size:"xl",type:n.iconClass})))})))),[t,e,r]);return null!=e&&e.length?o?Object(u.jsx)(i.a.Fragment,null,d):Object(u.jsx)(s.EuiModal,{onClose:n,"data-test-subj":"action-type-selector-modal"},Object(u.jsx)(s.EuiModalHeader,null,Object(u.jsx)(s.EuiModalHeaderTitle,null,l.h)),Object(u.jsx)(s.EuiModalBody,null,d)):null}));d.displayName="ActionTypeSelectorModal";const m=i.a.memo((({actionTypeRegistry:e,actionTypes:t,onClose:n,onSaveConnector:a,onSelectActionType:s,selectedActionType:o,actionTypeSelectorInline:l=!1})=>Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(d,{actionTypes:t,actionTypeRegistry:e,onClose:n,onSelect:s,actionTypeSelectorInline:l}),o&&Object(u.jsx)(r.ConnectorAddModal,{actionType:o,actionTypeRegistry:e,onClose:n,postSaveEventHandler:a}))));m.displayName="AddConnectorModal"},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);const i=e=>e.groups.some((e=>a.Zb.includes(e)))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return p}));var a=n(748),i=n(813);a.s;const r=`${a.k}.building_block_type`,s=`${a.k}.evaluation.threshold`,o=`${a.k}.evaluation.value`,l=`${a.k}.context`,u=`${a.k}.evaluation.values`,c=`${a.k}.group`,d=`${c}.field`,m=`${c}.value`,p=`${a.s}.exceptions_list`;a.s,a.I,a.k,a.s,i.D,i.F,i.E,i.G,a.K,a.a,a.d,a.e,a.f,a.j,a.h,a.o,a.u,a.m,i.a,a.b,i.b,i.c,i.d,i.e,i.f,a.q,i.g,i.h,i.i,a.r,i.j,a.t,i.k,i.l,i.m,a.w,i.n,i.o,a.x,i.p,i.q,i.r,a.A,a.C,i.s,a.B,i.z,a.E,a.F,i.A,a.G,a.H,i.C,a.y,a.n,i.x,i.v,i.y,i.w,i.u,i.t,a.J,a.L},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(50);const i=e=>null!=e.id?e:{...e,id:Object(a.v4)()},r=e=>{const t=e;if(null!=t.id){const{id:e,...n}=t;return n}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(2),i=n(48),r=n(4),s=n(123),o=n(132),l=n(575),u=n(252),c=n(1379);const d=({setQuery:e,response:t,request:n,refetch:i,uniqueQueryId:r,deleteQuery:s,loading:o,searchSessionId:l})=>{Object(a.useEffect)((()=>(null!=i&&null!=e&&e({id:r,inspect:{dsl:[n],response:[t]},loading:o,refetch:i,searchSessionId:l}),()=>{s&&s({id:r})})),[e,o,t,n,i,r,s,l])};function m(e){var t;const n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}const p=e=>{const{pathname:t}=Object(i.useLocation)(),{addError:n}=Object(s.a)(),{browserFields:d}=Object(o.a)(Object(l.a)(t));return Object(a.useCallback)((()=>{try{return function(e,t){const n=[];for(const[a,i]of Object.entries(e))t?i.aggregatable&&Object(c.a)(i.type)&&!m(i)&&n.push({label:a,value:a}):!0===i.aggregatable&&n.push({label:a,value:a});return n}(Object(u.a)(d),e)}catch(e){return n(e,{title:r.i18n.translate("xpack.securitySolution.useStackByFields.error.title",{defaultMessage:"Error fetching fields"}),toastMessage:r.i18n.translate("xpack.securitySolution.useStackByFields.error.toastMessage",{defaultMessage:"This error indicates an exceedingly large number of fields in an index"})}),[]}}),[n,d,e])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var a=n(47),i=n(4),r=n(2),s=n(1383);const o=["elastic-assistant","knowledge-base-status"],l=({http:e,resource:t,toasts:n})=>Object(a.useQuery)(o,(async({signal:n})=>Object(s.a)({http:e,resource:t,signal:n})),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==n||n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:i.i18n.translate("xpack.elasticAssistant.knowledgeBase.statusError",{defaultMessage:"Error fetching Knowledge Base Status"})}))}}),u=()=>{const e=Object(a.useQueryClient)();return Object(r.useCallback)((()=>{e.invalidateQueries(o,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(2),i=n(810),r=n.n(i),s=n(1215),o=n(821);const l={page:{size:o.d,index:0},sort:{field:"",direction:"asc"}},u=({defaultTableOptions:e,nameSpace:t=s.d,storageKey:n})=>{const[i=e,l]=r()(`${t}.${n}`,e),u=Object(a.useMemo)((()=>({initialPageSize:i.page.size,pageSizeOptions:[5,10,o.d,50],pageIndex:i.page.index})),[i]),c=Object(a.useMemo)((()=>({sort:i.sort})),[i.sort]);return{onTableChange:Object(a.useCallback)((({page:e,sort:t})=>{l({page:e,sort:t})}),[l]),pagination:u,sorting:c}}},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(19),i=n(2),r=n.n(i),s=n(7),o=n(4);const l=e=>o.i18n.translate("xpack.elasticAssistant.attackDiscovery.statusSuccess",{values:{totalAttacks:e},defaultMessage:"The connector has updated with {totalAttacks} potential {totalAttacks, plural, =1 {attack} other {attacks}}"}),u=o.i18n.translate("xpack.elasticAssistant.attackDiscovery.statusInProgress",{defaultMessage:"Attack discovery generation in progress."}),c=o.i18n.translate("xpack.elasticAssistant.attackDiscovery.statusFail",{defaultMessage:"The connector encountered an error while generating attack discoveries."});var d=n(43);const m=({hasViewed:e,status:t,count:n})=>"running"===t?Object(d.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"status-running"},Object(d.jsx)(a.EuiToolTip,{"aria-label":u,content:u,position:"bottom"},Object(d.jsx)(a.EuiLoadingSpinner,{size:"s"}))):e?null:"succeeded"===t&&null!=n?Object(d.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"status-succeeded"},Object(d.jsx)(a.EuiToolTip,{"aria-label":l(n),content:l(n),position:"bottom"},Object(d.jsx)(a.EuiNotificationBadge,null,n))):"failed"===t?Object(d.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"status-failed"},Object(d.jsx)(a.EuiIconTip,{"aria-label":c,color:"warning",content:c,position:"bottom",size:"m",type:"warning"})):null;var p=n(755),f=n(577),b=n(1288),g=n(241),v=n(578),y=n(1326);const h="ADD_NEW_CONNECTOR",j=r.a.memo((({isDisabled:e=!1,isOpen:t=!1,displayFancy:n,selectedConnectorId:o,onConnectorSelectionChange:l,setIsOpen:u,stats:c=null})=>{const{actionTypeRegistry:j,http:O,assistantAvailability:E}=Object(g.b)(),[x,S]=Object(i.useState)(!1),{data:w}=Object(b.a)({http:O}),[k,C]=Object(i.useState)(null),{data:T,refetch:M}=Object(p.a)({http:O}),I=e||!E.hasConnectorsReadPrivilege,_=Object(i.useMemo)((()=>({value:h,inputDisplay:f.f,dropdownDisplay:Object(d.jsx)(a.EuiFlexGroup,{gutterSize:"none",key:h},Object(d.jsx)(a.EuiFlexItem,{grow:!0},Object(d.jsx)(a.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",href:"#",iconType:"plus",size:"xs"},f.f)),Object(d.jsx)(a.EuiFlexItem,{grow:!1},Object(d.jsx)("div",{style:{width:"24px"}})))})),[]),A=Object(i.useMemo)((()=>(null!=T?T:[]).map((e=>{var t,i,s,o;const l=null!==(t=null===(i=Object(v.c)(e))||void 0===i?void 0:i.apiProvider)&&void 0!==t?t:Object(v.a)(j.get(e.actionTypeId)),u=e.isPreconfigured?f.m:l,p=null!==c&&null!==(s=c.statsPerConnector.find((t=>t.connectorId===e.id)))&&void 0!==s?s:null;return{value:e.id,"data-test-subj":e.id,inputDisplay:null!==(o=null==n?void 0:n(e.name))&&void 0!==o?o:e.name,dropdownDisplay:Object(d.jsx)(r.a.Fragment,{key:e.id},Object(d.jsx)(a.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none",alignItems:"center"},Object(d.jsx)(a.EuiFlexItem,{grow:!1},Object(d.jsx)("strong",null,e.name),u&&Object(d.jsx)(a.EuiText,{size:"xs",color:"subdued"},Object(d.jsx)("p",null,u))),p&&Object(d.jsx)(m,p)))}}))),[j,T,n,c]),P=Object(i.useMemo)((()=>Object(s.some)(T,["id",o])),[T,o]),D=Object(i.useMemo)((()=>E.hasConnectorsAllPrivilege?[...A,_]:[...A]),[_,E.hasConnectorsAllPrivilege,A]),F=Object(i.useCallback)((()=>{null==u||u(!1),S(!1),C(null)}),[u]),[R,N]=Object(i.useState)(t),z=Object(i.useCallback)((e=>{if(e===h)return N(!1),void S(!0);const t=(null!=T?T:[]).find((t=>t.id===e));t&&l(t)}),[T,l]),L=Object(i.useCallback)((e=>{l({...e}),null==M||M(),F()}),[F,l,M]);return Object(d.jsx)(r.a.Fragment,null,P||A.length?Object(d.jsx)(a.EuiSuperSelect,{"aria-label":f.g,compressed:!0,"data-test-subj":"connector-selector",disabled:I,hasDividers:!0,isOpen:R,onChange:z,options:D,valueOfSelected:o,popoverProps:{panelMinWidth:400,anchorPosition:"downRight"}}):Object(d.jsx)(a.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",iconType:"plusInCircle",size:"xs",onClick:()=>S(!0)},f.a),x&&Object(d.jsx)(i.Suspense,{fallback:!0},Object(d.jsx)(y.a,{actionTypeRegistry:j,actionTypes:w,onClose:()=>S(!1),onSaveConnector:L,onSelectActionType:e=>C(e),selectedActionType:k})))}));j.displayName="ConnectorSelector"},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(47),i=(n(2),n(118));const r=["POST","/api/ml/jobs/jobs_summary"],s=(e,t)=>Object(a.useQuery)([r,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>i.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(233);const i=new Set([a.b.STRING,a.b.BOOLEAN,a.b.NUMBER,a.b.IP]),r=e=>!!e&&i.has(e)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2080),i=n(1446),r=n(1340);const s=async({conversationId:e,alertsIndexPattern:t,assistantStreamingEnabled:n,http:s,message:o,replacements:l,apiConfig:u,signal:c,size:d,traceOptions:m})=>{const p=n,f=Object(r.d)({alertsIndexPattern:t,size:d}),b={model:null==u?void 0:u.model,message:o,subAction:p?"invokeStream":"invokeAI",conversationId:e,actionTypeId:u.actionTypeId,replacements:l,langSmithProject:""===(null==m?void 0:m.langSmithProject)||null==m?void 0:m.langSmithProject,langSmithApiKey:""===(null==m?void 0:m.langSmithApiKey)||null==m?void 0:m.langSmithApiKey,...f};try{var g,v,y,h;if(p){var j,O;const e=await s.fetch(`/internal/elastic_assistant/actions/connector/${null==u?void 0:u.connectorId}/_execute`,{method:"POST",body:JSON.stringify(b),signal:c,asResponse:!0,rawResponse:!0,version:a.a.internal.v1}),t=null==e||null===(j=e.response)||void 0===j||null===(O=j.body)||void 0===O?void 0:O.getReader();return t?{response:t,isStream:!0,isError:!1}:{response:`${i.a}\n\nCould not get reader from response`,isError:!0,isStream:!1}}const e=await s.fetch(`/internal/elastic_assistant/actions/connector/${null==u?void 0:u.connectorId}/_execute`,{method:"POST",body:JSON.stringify(b),headers:{"Content-Type":"application/json"},signal:c,version:a.a.internal.v1});if("ok"!==e.status||!e.data)return e.service_message?{response:`${i.a}\n\n${e.service_message}`,isError:!0,isStream:!1}:{response:i.a,isError:!0,isStream:!1};const t=null!=(null===(g=e.trace_data)||void 0===g?void 0:g.trace_id)&&null!=(null===(v=e.trace_data)||void 0===v?void 0:v.transaction_id)?{traceId:null===(y=e.trace_data)||void 0===y?void 0:y.trace_id,transactionId:null===(h=e.trace_data)||void 0===h?void 0:h.transaction_id}:void 0;return{response:e.data,isError:!1,isStream:!1,traceData:t}}catch(e){var E,x;const t=null==e||null===(E=e.response)||void 0===E||null===(x=E.body)||void 0===x?void 0:x.getReader,n=p&&"function"==typeof t?t.call(e.response.body):null;var S,w;return n?{response:n,isStream:!0,isError:!0}:{response:`${i.a}\n\n${null!==(S=null==e||null===(w=e.body)||void 0===w?void 0:w.message)&&void 0!==S?S:null==e?void 0:e.message}`,isError:!0,isStream:!1}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(4);const i=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.ariaLabel",{defaultMessage:"Select Prompt Context categories this Quick Prompt will be available for."}),r=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.prefixLabel",{defaultMessage:"Select Prompt"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.placeholderLabel",{defaultMessage:"(Quick Prompt will always be visible)."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(2081),i=n(2080);const r=async({http:e,resource:t,signal:n})=>{try{const r=a.g.replace("{resource?}",t||"");return await e.fetch(r,{method:"GET",signal:n,version:i.a.internal.v1})}catch(e){return e}},s=async({http:e,resource:t,signal:n})=>{const r=a.g.replace("{resource?}",t||"");return await e.fetch(r,{method:"POST",signal:n,version:i.a.internal.v1})}},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return m}));var a=n(4);const i=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsTitle",{defaultMessage:"Conversations"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsDescription",{defaultMessage:"Create and manage conversations with the Elastic AI Assistant."}),s=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsAllTitle",{defaultMessage:"All conversations"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsAllDescription",{defaultMessage:"These settings apply to all conversations."}),l=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.connectorTitle",{defaultMessage:"Connector"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptTitle",{defaultMessage:"System Prompt"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptHelpTextTitle",{defaultMessage:"Context provided as part of every conversation."}),d=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.streamingTitle",{defaultMessage:"STREAMING"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.streamingHelpTextTitle",{defaultMessage:"Controls whether streaming responses are used in conversations"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n.n(a),r=n(47);class SecuritySolutionQueryClient extends r.QueryClient{constructor(e={}){var t,n,a;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(a=e.defaultOptions)||void 0===a?void 0:a.queries)&&void 0!==n?n:{}}}})}}const s=new SecuritySolutionQueryClient,o=Object(a.memo)((({queryClient:e,children:t})=>{const n=Object(a.useMemo)((()=>e||s),[e]);return i.a.createElement(r.QueryClientProvider,{client:n},t)}));o.displayName="ReactQueryClientProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.incompatibleTab.dataQualityDashboardConversationId",{defaultMessage:"Data Quality dashboard"})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(19),i=n(2),r=n.n(i),s=n(41),o=n.n(s),l=n(44),u=n(50),c=n(7),d=n(161),m=n(5),p=n(224),f=n(194),b=n(118),g=n(1453),v=n(4);const y=v.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.headerTitle",{defaultMessage:"Trend"}),h=v.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.notAvailableTooltip",{defaultMessage:"Not available for trend view"}),j=v.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.viewAlertsButtonLabel",{defaultMessage:"View alerts"});var O=n(144),E=n(156),x=n(1286),S=n(1217),w=n(257),k=n(1098),C=n(122);const T=Object(u.v4)(),M=(e="kibana.alert.rule.name",t)=>({title:"Alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge",legendStats:["currentAndLastValue"]},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:T,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:null!=t&&t.filters?t.filters:[],datasourceStates:{formBased:{layers:{[T]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto",includeEmptyRows:!0}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",params:{emptyAsNull:!0}},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:1e3,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},secondaryFields:[]}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${T}`}]});var I=n(127),_=n(568),A=n(60),P=n.n(A),D=n(417);const F="detections-histogram",R=o()(a.EuiFlexItem).withConfig({displayName:"ViewAlertsFlexItem",componentId:"sc-tvqkga-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),N=Object(i.memo)((({alignHeader:e,chartHeight:t=155,comboboxRef:n,defaultStackByOption:s=x.a,extraActions:o,filters:T,headerChildren:A,inspectTitle:N,onFieldSelected:z,onlyField:L,paddingSize:B="m",panelHeight:q=x.d,setComboboxInputRef:V,showGroupByPlaceholder:$=!1,showLinkToAlerts:U=!1,showStackBy:G=!0,showTotalAlertsCount:H=!1,stackByLabel:Q,stackByWidth:W,title:K=y,titleSize:J="m",hideQueryToggle:Y=!1,isExpanded:X,setIsExpanded:Z})=>{const{to:ee,from:te}=Object(d.a)(),ne=Object(i.useMemo)((()=>`${F}-${Object(u.v4)()}`),[]),ae=`alerts-trend-embeddable-${ne}`,[ie,re]=Object(i.useState)(!0),[se,oe]=Object(i.useState)(null==L?s:L),le=Object(C.a)("alertsPageChartsEnabled"),ue=Object(i.useCallback)((e=>{oe(e),null!=z&&z(e)}),[z]);Object(i.useEffect)((()=>{oe(null==L?s:L)}),[s,L]);const{toggleStatus:ce,setToggleStatus:de}=Object(w.a)(F),me=Object(i.useCallback)((e=>{le&&void 0!==Z?Z(e):de(e)}),[de,Z,le]),pe=Object(i.useMemo)((()=>({from:te,to:ee})),[te,ee]),fe=Object(b.j)(),{navigateToApp:be}=fe.services.application,{formatUrl:ge,search:ve}=Object(f.l)(E.a.alerts),{loading:ye}=Object(D.a)({visualizationId:ae}),he=(({visualizationId:e})=>{const[t]=Object(b.o)(m.W),{responses:n}=Object(D.a)({visualizationId:e});return Object(i.useMemo)((()=>{const e=null!=n?n[0].hits.total:0;return a=P()(e).format(t),i=e,v.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.showingAlertsTitle",{values:{totalAlertsFormatted:a,totalAlerts:i,modifier:""},defaultMessage:"Showing: {modifier}{totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});var a,i}),[t,n])})({visualizationId:ae}),je=Object(i.useCallback)((e=>{e.preventDefault(),be(m.m,{deepLinkId:E.a.alerts,path:Object(f.c)(ve)})}),[be,ve]);Object(i.useEffect)((()=>{let e=!1;return e||Object(g.d)({isInitialLoading:ie,isLoadingAlerts:ye})||re(!1),()=>{e=!0}}),[ie,ye,re]);const Oe=Object(i.useMemo)((()=>{if(U)return r.a.createElement(R,{grow:!1},r.a.createElement(O.g,{"data-test-subj":"alerts-histogram-panel-go-to-alerts-page",onClick:je,href:ge(Object(f.c)())},j))}),[U,je,ge]),Ee=Object(i.useMemo)((()=>{return null==L?K:(e=L,v.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}));var e}),[L,K]),xe=Object(i.useMemo)((()=>le&&void 0!==X?X:ce),[le,X,ce]),{responses:Se,loading:we}=Object(D.a)({visualizationId:ae}),ke=!we&&!Object(l.isEmpty)(Se),Ce=!!Object(i.useMemo)((()=>we?0:Object(c.sumBy)(Se,(e=>{var t;return Object(c.sumBy)(Object.values(null!==(t=e.aggregations)&&void 0!==t?t:{}),"buckets.length")}))),[we,Se]),Te=xe?Object(g.a)(ke,Ce,he):Object(g.b)(ie,H,he);return r.a.createElement(S.a,{height:q,hasBorder:!0,paddingSize:B,"data-test-subj":"alerts-histogram-panel",$toggleStatus:xe},r.a.createElement(p.a,{alignHeader:e,id:ne,inspectTitle:N,outerDirection:"column",title:Ee,titleSize:J,toggleStatus:xe,toggleQuery:Y?void 0:me,showInspectButton:!1,subtitle:Te,isInspectDisabled:!1},r.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"panelFlexGroup",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},G&&r.a.createElement(r.a.Fragment,null,r.a.createElement(S.b,{"data-test-subj":"stackByComboBox",inputRef:V,onSelect:ue,prepend:Q,ref:n,selected:se,useLensCompatibleFields:!0,width:W}),$&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{"data-test-subj":"placeholderSpacer",size:"s"}),r.a.createElement(a.EuiToolTip,{"data-test-subj":"placeholderTooltip",content:h},r.a.createElement(S.b,{"data-test-subj":"stackByPlaceholder",isDisabled:!0,onSelect:l.noop,prepend:k.b,selected:"",useLensCompatibleFields:!0,width:W})))),null!=A&&A),Oe)),xe?r.a.createElement(_.a,{"data-test-subj":"embeddable-matrix-histogram",extraActions:o,extraOptions:{filters:T},getLensAttributes:M,height:null!=t?t:155,id:ae,inspectTitle:null!=N?N:K,scopeId:I.SourcererScopeName.detections,stackByField:se,timerange:pe}):null)}));N.displayName="AlertsHistogramPanel"},,function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return g}));var a=n(47),i=n(2),r=n(20),s=n(140),o=n(118),l=n(67),u=n(159),c=n(1082),d=n(753),m=n(1083);const p=["POST",l.EPM_API_ROUTES.BULK_INSTALL_PATTERN],f=["POST",l.EPM_API_ROUTES.INSTALL_FROM_REGISTRY_PATTERN],b=()=>{const e=Object(o.j)(),t=Object(s.a)().endpointPrivileges.canAccessFleet,{mutate:n}=(e=>{const t=Object(d.b)(),n=Object(c.b)(),i=Object(m.b)();return Object(a.useMutation)((e=>Object(u.c)(e)),{...e,mutationKey:p,onSettled:(...e)=>{const a=e[0],s=null==a?void 0:a.items.find((e=>e.name===r.d));s&&"result"in s&&"installed"===s.result.status&&(t(),n(),i())}})})(),{mutate:l}=(e=>{const t=Object(d.b)(),n=Object(c.b)(),i=Object(m.b)();return Object(a.useMutation)((e=>Object(u.o)(e)),{...e,mutationKey:f,onSettled:(...e)=>{const{packageName:a}=e[2];a===r.d&&(t(),n(),i())}})})();Object(i.useEffect)((()=>{t&&(async t=>{await(null===(t=e.services.fleet)||void 0===t?void 0:t.isInitialized());const a="traditional"===o.b.getBuildFlavor()&&(o.b.getKibanaVersion().includes("-SNAPSHOT")||"main"===o.b.getKibanaBranch()),i=o.b.getPrebuiltRulesPackageVersion(),s=["endpoint",r.d];null!=i&&(l({packageName:r.d,packageVersion:i,prerelease:a,force:!0}),s.splice(s.indexOf(r.d),1)),n({packages:s,prerelease:a})})()}),[n,t,e.services.fleet,l])},g=()=>Object(a.useIsMutating)({predicate:({options:{mutationKey:e},state:{variables:t}})=>e===p?t.packages.includes(r.d):e===f&&t.packageName===r.d})>0},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(46),i=n(1448),r=n(399),s=n(752),o=n(400),l=n(574),u=n(1256),c=n(275),d=n(891),m=n(506),p=n(507),f=n(1284);const b=a.intersection([a.exact(a.type({description:r.a,entries:s.a,name:o.a,type:l.a})),a.exact(a.partial({comments:u.a,item_id:i.a,list_id:a[void 0],meta:c.a,namespace_type:d.b,os_types:m.c,tags:p.a,expire_time:f.a}))])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),i=n(50),r=n(1371);const s=new a.Type("DefaultUuid",a.string.is,((e,t)=>null==e?a.success(Object(i.v4)()):r.a.validate(e,t)),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);function i(e){return a.preprocess((e=>"string"==typeof e?""===e?[]:e.split(","):e),a.array(e))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(43);const s=()=>Object(r.jsx)(a.Fragment,null),o=i.a.lazy((()=>n.e(56).then(n.bind(null,1413)))),l=function(e){return Object(r.jsx)(i.a.Suspense,{fallback:Object(r.jsx)(s,null)},Object(r.jsx)(o,e))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.eventsTab.externalAlertsUnit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),r=e=>a.i18n.translate("xpack.securitySolution.hosts.navigaton.eventsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),s=a.i18n.translate("xpack.securitySolution.eventsTab.showing",{defaultMessage:"Showing"}),o=a.i18n.translate("xpack.securitySolution.eventsTab.alertsGraphTitle",{defaultMessage:"External alert trend"}),l=(a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),a.i18n.translate("xpack.securitySolution.eventsTab.showExternalAlerts",{defaultMessage:"Show only external alerts"})),u=a.i18n.translate("xpack.securitySolution.eventsGraphTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o})),n(44),n(54);var a=n(1454);const i=({isInitialLoading:e,isLoadingAlerts:t})=>e&&t,r=({callback:e,order:t}={})=>({id:"resetGroupByField",getDisplayName:()=>a.b,getIconType:()=>"editorRedo",type:"actionButton",isCompatible:async()=>!0,async execute({embeddable:t}){null==e||e();const n=t.getInput(),{attributes:{state:{visualization:{columns:a}}}}=n;t.updateInput({...n,attributes:{...n.attributes,state:{...n.attributes.state,visualization:{...n.attributes.state.visualization,columns:a.map((e=>({...e,hidden:!1})))}}}})},order:t}),s=(e,t,n)=>!e&&t&&n,o=(e,t,n)=>e&&t&&n},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.inspectTitle",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.resetGroupByFieldsMenuItem",{defaultMessage:"Reset group by fields"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(47),i=n(4),r=n(1383),s=n(1344);const o=["elastic-assistant","post-knowledge-base"],l=({http:e,toasts:t})=>{const n=Object(s.a)();return Object(a.useMutation)(o,(t=>Object(r.b)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:i.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}))},onSettled:()=>{n()}})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(2081),r=n(2080);const s=async(e,t,n)=>{try{const n=await e.fetch(i.a,{method:"POST",version:r.a.public.v1,body:JSON.stringify(t)});if(!n.success){var s;const e=null===(s=n.attributes.errors)||void 0===s?void 0:s.map((e=>`${e.status_code?`Error code: ${e.status_code}. `:""}Error message: ${e.message} for anonymization field ${e.anonymization_fields.map((e=>e.name)).join(",")}`)).join(",\n");throw new Error(e)}return n}catch(e){null==n||n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:a.i18n.translate("xpack.elasticAssistant.anonymizationFields.bulkActionsAnonymizationFieldsError",{defaultMessage:"Error updating anonymization fields {error}",values:{error:e}})})}}},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsTitle",{defaultMessage:"Quick Prompts"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsDescription",{defaultMessage:"Create and manage Quick Prompts. Quick Prompts are shortcuts to common actions."}),s=(a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.modalTitle",{defaultMessage:"Quick Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.nameLabel",{defaultMessage:"Name"})),o=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptLabel",{defaultMessage:"Prompt"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptPlaceholder",{defaultMessage:"Enter a Quick Prompt"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.badgeColorLabel",{defaultMessage:"Badge color"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsLabel",{defaultMessage:"Contexts"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsHelpText",{defaultMessage:"Select where this Quick Prompt will appear. Selecting none will make this prompt appear everywhere."});a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(659),i=n(2),r=n(241);const s=({onSelectedQuickPromptChange:e,setUpdatedQuickPromptSettings:t,promptsBulkActions:n,setPromptsBulkActions:s})=>{const{currentAppId:o}=Object(r.b)();return{onQuickPromptDeleted:Object(i.useCallback)((e=>{var a,i;t((t=>t.filter((t=>t.id!==e)))),s({...n,delete:{ids:[...null!==(a=null===(i=n.delete)||void 0===i?void 0:i.ids)&&void 0!==a?a:[],e]}})}),[n,s,t]),onQuickPromptSelectionChange:Object(i.useCallback)((i=>{const r="string"==typeof i,l=r?{name:i,id:i,content:"",color:"#D36086",categories:[],promptType:a.a.quick,consumer:o}:i;var u;null!=l&&(t((e=>e.some((e=>e.name===l.name))?e:[...e,l])),r&&s({...n,create:[...null!==(u=n.create)&&void 0!==u?u:[],{...l}]})),e(l)}),[o,e,n,s,t])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>Object.values(e).filter((e=>{var n;return(null==e||null===(n=e.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)===t}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(241);const r=({setUpdatedSystemPromptSettings:e,onSelectedSystemPromptChange:t,promptsBulkActions:n,setPromptsBulkActions:r})=>{const{currentAppId:s}=Object(i.b)();return{onSystemPromptSelectionChange:Object(a.useCallback)((a=>{const i="string"==typeof a,o=i?{id:null!=a?a:"",content:"",name:null!=a?a:"",promptType:"system",consumer:s}:a;null!=o&&(e((e=>e.some((e=>e.id===o.id))?e:[...e,o])),i&&r((e=>{var t;return{...e,create:[...null!==(t=n.create)&&void 0!==t?t:[],{...o}]}}))),t(o)}),[s,t,n,r,e]),onSystemPromptDeleted:Object(a.useCallback)((t=>{var a,i;e((e=>e.filter((e=>e.id!==t)))),r({...n,delete:{ids:[...null!==(a=null===(i=n.delete)||void 0===i?void 0:i.ids)&&void 0!==a?a:[],t]}})}),[n,r,e])}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(4);a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph1",{defaultMessage:"The fields below are allowed by default"}),a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph2",{defaultMessage:"Optionally enable anonymization for these fields"}),a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutTitle",{defaultMessage:"Anonymization defaults"});const i=a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsTitle",{defaultMessage:"Anonymization"}),r=a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsDescription",{defaultMessage:"Define privacy settings for event data sent to third-party LLM providers. You can choose which fields to include, and which to anonymize by replacing their values with random strings. Helpful defaults are provided below."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1380);const i=({anonymizationFields:e=[],rawData:t,replacements:n})=>{const i={allowed:0,anonymized:0,denied:0,total:0};return t?"string"==typeof t?null==n?i:{...i,anonymized:Object.keys(n).length}:Object.keys(t).reduce(((t,n)=>({allowed:t.allowed+(Object(a.a)({anonymizationFields:e,field:n})?1:0),anonymized:t.anonymized+(Object(a.a)({anonymizationFields:e,field:n})&&Object(a.b)({anonymizationFields:e,field:n})?1:0),denied:t.denied+(Object(a.c)({anonymizationFields:e,field:n})?1:0),total:t.total+1})),i):{allowed:e.reduce(((e,t)=>t.allowed?e+1:e),0),anonymized:e.reduce(((e,t)=>t.anonymized?e+1:e),0),denied:e.reduce(((e,t)=>!1===t.allowed?e+1:e),0),total:e.length}}},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Se})),n.d(t,"b",(function(){return Te}));var a=n(2),i=n.n(a),r=n(52),s=n.n(r),o=n(42),l=n(3),u=n(8),c=n.n(u),d=(n(1088),n(19)),m=n(360),p=n(53);var f=n(480),b=n(55),g=n(1093);const v=(e,t)=>t?JSON.stringify(e):JSON.stringify(e,null,2),y=Object(b.createEscapeValue)({separator:",",quoteValues:!0,escapeFormulaValues:!0}),h=e=>y(e);var j=n(7),O=n(225),E=n(860),x=n(4),S=n(79),w=n(301),k=n(43);const C=({children:e})=>Object(k.jsx)("span",{className:"unifiedDataTable__rowControl"},e),T=x.i18n.translate("unifiedDataTable.copyEscapedValueWithFormulasToClipboardWarningText",{defaultMessage:"Values may contain formulas that are escaped."}),M=x.i18n.translate("unifiedDataTable.copyFailedErrorText",{defaultMessage:"Unable to copy to clipboard in this browser"}),I=({rowIndex:e,columnId:t,toastNotifications:n,valueToStringConverter:a})=>{const i=a(e,t),r=i.formattedString;if(!Object(d.copyToClipboard)(r))return n.addWarning({title:M}),null;const s=x.i18n.translate("unifiedDataTable.copyValueToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return i.withFormula?n.addWarning({title:s,text:T}):n.addInfo({title:s}),r},_=async({columnId:e,columnDisplayName:t,toastNotifications:n,valueToStringConverter:a,rowsCount:i})=>{const r={formattedString:h(s=t),withFormula:Object(b.cellHasFormulas)(s)};var s;let o=r.withFormula;const l=[...Array(i)].map(((t,n)=>{const i=a(n,e,{compatibleWithCSV:!0});return o=o||i.withFormula,i.formattedString})),u=`${r.formattedString}\n${l.join("\n")}`;let c;try{var m,p;await(null===(m=window.navigator)||void 0===m||null===(p=m.clipboard)||void 0===p?void 0:p.writeText(u)),c=!0}catch(e){c=Object(d.copyToClipboard)(u)}if(!c)return n.addWarning({title:M}),null;const f=x.i18n.translate("unifiedDataTable.copyColumnValuesToClipboard.toastTitle",{defaultMessage:'Values of "{column}" column copied to clipboard',values:{column:t}});return o?n.addWarning({title:f,text:T}):n.addInfo({title:f}),u},A=({columnDisplayName:e,toastNotifications:t})=>{if(!Object(d.copyToClipboard)(e))return t.addWarning({title:M}),null;const n=x.i18n.translate("unifiedDataTable.copyColumnNameToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return t.addInfo({title:n}),e};function P(e,t,n,a,i){const r=e.rows[t].flattened[n];i&&e.onFilter&&e.onFilter(i,r,a)}const D=({Component:e,rowIndex:t,columnId:n},i)=>{const r=Object(a.useContext)(w.a),s=x.i18n.translate("unifiedDataTable.grid.filterForAria",{defaultMessage:"Filter for this {value}",values:{value:n}});return Object(k.jsx)(e,{onClick:()=>{P(r,t,n,"+",i)},iconType:"plusInCircle","aria-label":s,title:s,"data-test-subj":"filterForButton"},x.i18n.translate("unifiedDataTable.grid.filterFor",{defaultMessage:"Filter for"}))},F=({Component:e,rowIndex:t,columnId:n},i)=>{const r=Object(a.useContext)(w.a),s=x.i18n.translate("unifiedDataTable.grid.filterOutAria",{defaultMessage:"Filter out this {value}",values:{value:n}});return Object(k.jsx)(e,{onClick:()=>{P(r,t,n,"-",i)},iconType:"minusInCircle","aria-label":s,title:s,"data-test-subj":"filterOutButton"},x.i18n.translate("unifiedDataTable.grid.filterOut",{defaultMessage:"Filter out"}))};var R=n(233);function N(e){switch(e){case R.b.IP:case R.b.GEO_SHAPE:case R.b.NUMBER:return"numeric";case R.b.BOOLEAN:return"boolean";case R.b.STRING:return"string";case R.b.DATE:return"datetime";default:return O.i}}function z({isPlainRecord:e,isFilterActive:t,rows:n,selectedDocs:i,setIsFilterActive:r,setSelectedDocs:s}){const[l,u]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>[t?Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowAllDocuments",key:"showAllDocuments",icon:"eye",onClick:()=>{u(!1),r(!1)}},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showAllResults",defaultMessage:"Show all results"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showAllDocuments",defaultMessage:"Show all documents"})):Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowSelectedDocuments",key:"showSelectedDocuments",icon:"eye",onClick:()=>{u(!1),r(!0)}},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showSelectedResultsOnly",defaultMessage:"Show selected results only"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showSelectedDocumentsOnly",defaultMessage:"Show selected documents only"})),Object(k.jsx)(d.EuiCopy,{key:"copyJsonWrapper","data-test-subj":"dscGridCopySelectedDocumentsJSON",textToCopy:n?JSON.stringify(n.filter((e=>i.includes(e.id))).map((e=>e.raw))):""},(t=>Object(k.jsx)(d.EuiContextMenuItem,{key:"copyJSON",icon:"copyClipboard",onClick:t},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.copyResultsToClipboardJSON",defaultMessage:"Copy results to clipboard (JSON)"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.copyToClipboardJSON",defaultMessage:"Copy documents to clipboard (JSON)"})))),Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridClearSelectedDocuments",key:"clearSelection",icon:"cross",onClick:()=>{u(!1),s([]),r(!1)}},Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.clearSelection",defaultMessage:"Clear selection"}))]),[t,e,n,i,r,s]),m=Object(a.useCallback)((()=>u((e=>!e))),[]);return Object(k.jsx)(d.EuiPopover,{closePopover:()=>u(!1),isOpen:l,panelPaddingSize:"none",button:Object(k.jsx)(d.EuiDataGridToolbarControl,{iconType:"documents",onClick:m,"data-selected-documents":i.length,"data-test-subj":"unifiedDataTableSelectionBtn",isSelected:t,badgeContent:i.length},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.selectedResultsButtonLabel",defaultMessage:"Selected",description:"Selected results"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.selectedRowsButtonLabel",defaultMessage:"Selected",description:"Selected documents"}))},l&&Object(k.jsx)(d.EuiContextMenuPanel,{items:c(),"data-test-subj":"unifiedDataTableSelectionMenu"}))}const L=({selectedDocs:e,setIsCompareActive:t})=>Object(k.jsx)(d.EuiDataGridToolbarControl,{iconType:"diff",badgeContent:e.length,"data-test-subj":"unifiedDataTableCompareSelectedDocuments",onClick:()=>{t(!0)}},Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.compareSelectedRowsButtonLabel",defaultMessage:"Compare"}));function B({label:e,onCopy:t,dataTestSubj:n}){return{size:"xs",label:e,iconType:"copyClipboard",iconProps:{size:"m"},onClick:t,"data-test-subj":n}}function q({columnDisplayName:e,toastNotifications:t}){return B({label:Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnNameToClipBoardButton",defaultMessage:"Copy name"}),onCopy:()=>A({columnDisplayName:e,toastNotifications:t}),dataTestSubj:"gridCopyColumnNameToClipBoardButton"})}function V({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:i}){return B({label:Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnValuesToClipBoardButton",defaultMessage:"Copy column"}),onCopy:()=>_({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:i}),dataTestSubj:"gridCopyColumnValuesToClipBoardButton"})}var $=n(119),U=n.n($),G=n(701),H=n(1451),Q=n(655),W=n(44),K=n(49),J=({headerRowHeight:e,children:t})=>{const n=Object(k.css)("overflow-wrap:anywhere;white-space:normal;word-break:break-all;line-height:",K.euiThemeVars.euiSize,";text-align:left;.euiDataGridHeaderCell--numeric &{float:right;}","");return e?Object(k.jsx)(d.EuiTextBlockTruncate,{lines:e,css:n},t):Object(k.jsx)("div",{css:n},t)};const Y=({columnDisplayName:e,showColumnTokens:t,columnName:n,columnsMeta:a,dataView:i,headerRowHeight:r})=>Object(k.jsx)(J,{headerRowHeight:r},t&&Object(k.jsx)(X,{columnName:n,columnsMeta:a,dataView:i}),Object(k.jsx)(Z,{columnDisplayName:e})),X=e=>{const{columnName:t,columnsMeta:n,dataView:i}=e,r=Object(a.useMemo)((()=>function({dataView:e,columnName:t,columnsMeta:n}){if(!t||"_source"===t)return null;if(n){const e=(a=n[t])&&a.type?Object(G.a)({name:"",type:a.type,esTypes:a.esType?[a.esType]:[]}):null;return e&&"unknown"!==e?Object(k.jsx)(H.a,{type:e,css:ee}):null}var a;const i=e.getFieldByName(t);return i?Object(k.jsx)(H.a,U()({},Object(Q.a)(i),{css:ee})):function(e,t){const n=new RegExp(Object(W.escapeRegExp)(e)+"(\\.|$)");return!t.fields.getByName(e)&&!!t.fields.getAll().find((e=>{var t;const a=Object(p.getDataViewFieldSubtypeNested)(e);return!!a&&n.test(null!==(t=null==a?void 0:a.nested.path)&&void 0!==t?t:"")}))}(t,e)?Object(k.jsx)(H.a,{type:"nested",css:ee}):null}({columnName:t,columnsMeta:n,dataView:i})),[t,n,i]);return r?Object(k.jsx)("span",{css:Object(k.css)({paddingRight:K.euiThemeVars.euiSizeXS},"","")},r):null},Z=({columnDisplayName:e})=>Object(k.jsx)("span",{"data-test-subj":"unifiedDataTableColumnTitle"},e),ee={verticalAlign:"bottom"};var te={name:"1flj9lk",styles:"text-align:left"};const ne=({dataView:e,dataViewField:t,headerRowHeight:n=1,columnLabel:a})=>{var i;const r=a||(null!==(i=null==t?void 0:t.customLabel)&&void 0!==i?i:e.timeFieldName),s=x.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltipAriaLabel",{defaultMessage:"{timeFieldName} - this field represents the time that events occurred.",values:{timeFieldName:r}}),o=x.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltip",{defaultMessage:"This field represents the time that events occurred."});return Object(k.jsx)("div",{"aria-label":s,css:te},Object(k.jsx)(J,{headerRowHeight:n},r," ",Object(k.jsx)(d.EuiIconTip,{type:"clock",content:o})))},ae=i.a.memo(Y),ie=i.a.memo(ne),re="openDetails",se="select",oe={id:re,width:26,headerCellRender:()=>Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("span",null,x.i18n.translate("unifiedDataTable.controlColumnHeader",{defaultMessage:"Control column"}))),rowCellRender:({rowIndex:e,setCellProps:t})=>{const n=Object(a.useRef)(null),[i,r]=Object(a.useState)(!1),{expanded:s,setExpanded:o,rows:l,isDarkMode:u,componentsTourSteps:c}=Object(a.useContext)(w.a),m=l[e],p=c?c.expandButton:void 0;Object(a.useEffect)((()=>{m.isAnchor?t({className:"unifiedDataTable__cell--highlight"}):s&&m&&s.id===m.id?t({className:"unifiedDataTable__cell--expanded"}):t({style:void 0})}),[s,m,t,u]);const f=m===s,b=x.i18n.translate("unifiedDataTable.grid.viewDoc",{defaultMessage:"Toggle dialog with details"}),g=m.isAnchor?"docTableExpandToggleColumnAnchor":"docTableExpandToggleColumn";return Object(a.useEffect)((()=>{!f&&i&&(r(!1),setTimeout((()=>{var e;null===(e=n.current)||void 0===e||e.hideToolTip()}),100))}),[f,r,i]),o?Object(k.jsx)(C,null,Object(k.jsx)(d.EuiToolTip,{content:b,delay:"long",ref:n},Object(k.jsx)(d.EuiButtonIcon,{id:0===e?p:void 0,size:"xs",iconSize:"s","aria-label":b,"data-test-subj":g,onClick:()=>{var e;const t=f?void 0:m;null===(e=n.current)||void 0===e||e.hideToolTip(),r(Boolean(t)),null==o||o(t)},color:f?"primary":"text",iconType:f?"minimize":"expand",isSelected:f}))):null}},le={id:se,width:24,rowCellRender:({rowIndex:e,setCellProps:t})=>{const{euiTheme:n}=Object(d.useEuiTheme)(),{selectedDocs:i,expanded:r,rows:s,isDarkMode:o,setSelectedDocs:l}=Object(a.useContext)(w.a),u=Object(a.useMemo)((()=>s[e]),[s,e]),c=Object(a.useMemo)((()=>i.includes(u.id)),[i,u.id]),m=x.i18n.translate("unifiedDataTable.grid.selectDoc",{defaultMessage:"Select document ''{rowNumber}''",values:{rowNumber:e+1}});return Object(a.useEffect)((()=>{r&&u&&r.id===u.id?t({className:"unifiedDataTable__cell--selected"}):t({style:void 0})}),[r,u,t,o]),Object(k.jsx)(d.EuiFlexGroup,{responsive:!1,direction:"column",justifyContent:"center",className:"unifiedDataTable__rowControl",css:Object(k.css)("padding-block:",n.size.xs,";padding-left:",n.size.xs,";","")},Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(d.EuiCheckbox,{id:u.id,"aria-label":m,checked:c,"data-test-subj":`dscGridSelectDoc-${u.id}`,onChange:()=>{if(c){const e=i.filter((e=>e!==u.id));l(e)}else l([...i,u.id])}})))},headerCellRender:()=>Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("span",null,x.i18n.translate("unifiedDataTable.selectColumnHeader",{defaultMessage:"Select column"})))};function ue({columns:e,columnsCellActions:t,rowsCount:n,settings:a,dataView:i,defaultColumns:r,isSortEnabled:s,isPlainRecord:l,services:u,hasEditDataViewPermission:c,valueToStringConverter:d,onFilter:m,editField:p,visibleCellActions:f,columnsMeta:b,showColumnTokens:g,headerRowHeightLines:v,customGridColumnsConfiguration:y}){const h=e=>{var t,n,i;return null!==(t=null==a||null===(n=a.columns)||void 0===n||null===(i=n[e])||void 0===i?void 0:i.width)&&void 0!==t?t:0},j=(e=>{if(e!==O.d.auto)return e===O.d.single?1:e})(v),E=e.length;return e.map(((e,v)=>{var w,C;return function({numberOfColumns:e,columnName:t,columnWidth:n=0,dataView:a,defaultColumns:i,isSortEnabled:r,isPlainRecord:s,toastNotifications:l,hasEditDataViewPermission:u,valueToStringConverter:c,rowsCount:d,onFilter:m,editField:p,columnCellActions:f,visibleCellActions:b,columnsMeta:g,showColumnTokens:v,headerRowHeight:y,customGridColumnsConfiguration:h,columnDisplay:j}){var E,w,C,T,M;const _=s?new S.DataViewField({name:t,type:null!==(E=null==g||null===(w=g[t])||void 0===w?void 0:w.type)&&void 0!==E?E:"unknown",esTypes:null!=g&&null!==(C=g[t])&&void 0!==C&&C.esType?[g[t].esType]:void 0,searchable:!0,aggregatable:!1}):a.getFieldByName(t),A=p&&_&&(({hasEditDataViewPermission:e,dataView:t,field:n,editField:a})=>{if("_source"===n.name)return null;const{canEdit:i}=((e,t)=>{var n;const a=Boolean(null===(n=e.getFieldByName(t.name))||void 0===n?void 0:n.runtimeField);return{canEdit:!("unknown"===t.type||"unknown_selected"===t.type)||a,canDelete:a}})(t,n),r=e()||!t.isPersisted();return i&&r?{size:"xs",label:Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.grid.editFieldButton",defaultMessage:"Edit data view field"}),iconType:"pencil",iconProps:{size:"m"},onClick:()=>{a(n.name)},"data-test-subj":"gridEditFieldButton"}:null})({hasEditDataViewPermission:u,dataView:a,field:_,editField:p}),P=((e,t,n)=>n||("_source"===e?x.i18n.translate("unifiedDataTable.grid.documentHeader",{defaultMessage:"Document"}):t||e))(t,null==_?void 0:_.displayName,j);let R;R=null!=f&&f.length?f:_?function(e,t,n,a){return[...a&&e.filterable?[({Component:t,rowIndex:n,columnId:a})=>D({Component:t,rowIndex:n,columnId:a},e),({Component:t,rowIndex:n,columnId:a})=>F({Component:t,rowIndex:n,columnId:a},e)]:[],({Component:e,rowIndex:a,columnId:i})=>function({Component:e,rowIndex:t,columnId:n},a,i){const r=x.i18n.translate("unifiedDataTable.grid.copyClipboardButtonTitle",{defaultMessage:"Copy value of {column}",values:{column:n}});return Object(k.jsx)(e,{onClick:()=>{I({rowIndex:t,columnId:n,valueToStringConverter:i,toastNotifications:a})},iconType:"copyClipboard","aria-label":r,title:r,"data-test-subj":"copyClipboardButton"},x.i18n.translate("unifiedDataTable.grid.copyCellValueButton",{defaultMessage:"Copy value"}))}({Component:e,rowIndex:a,columnId:i},t,n)]}(_,l,c,m):[];const z={id:t,schema:N(null!==(T=null==g||null===(M=g[t])||void 0===M?void 0:M.type)&&void 0!==T?T:null==_?void 0:_.type),isSortable:r&&(s&&"_source"!==t||!0===(null==_?void 0:_.sortable)),display:v||1!==y?Object(k.jsx)(ae,{dataView:a,columnName:t,columnDisplayName:P,columnsMeta:g,showColumnTokens:v,headerRowHeight:y}):void 0,displayAsText:P,actions:{showHide:!i&&t!==a.timeFieldName&&{label:x.i18n.translate("unifiedDataTable.removeColumnLabel",{defaultMessage:"Remove column"}),iconType:"cross"},showMoveLeft:!i,showMoveRight:!i,additional:[..."__source"===t?[]:[q({columnDisplayName:P,toastNotifications:l})],V({columnId:t,columnDisplayName:P,toastNotifications:l,rowsCount:d,valueToStringConverter:c}),...A?[A]:[]]},cellActions:R,visibleCellActions:b};return z.id===a.timeFieldName&&(z.display=Object(k.jsx)(ie,{dataView:a,dataViewField:_,headerRowHeight:y,columnLabel:j}),e>1&&(z.initialWidth=O.h)),n>0&&(z.initialWidth=Number(n)),h&&h[z.id]?h[z.id]({column:z,headerRowHeight:y}):z}({numberOfColumns:E,columnName:e,columnCellActions:null==t?void 0:t[v],columnWidth:h(e),dataView:i,defaultColumns:r,isSortEnabled:s,isPlainRecord:l,toastNotifications:u.toastNotifications,hasEditDataViewPermission:c,valueToStringConverter:d,rowsCount:n,onFilter:m,editField:p,visibleCellActions:f,columnsMeta:b,showColumnTokens:g,headerRowHeight:j,customGridColumnsConfiguration:y,columnDisplay:null==a||null===(w=a.columns)||void 0===w||null===(C=w[e])||void 0===C?void 0:C.display})}))}const ce=e=>{const{isLoadingMore:t,rowCount:n,sampleSize:i,pageIndex:r,pageCount:s,totalHits:l=0,onFetchMoreRecords:u,data:c}=e,m=c.query.timefilter.timefilter,[p,f]=Object(a.useState)(m.getRefreshInterval());Object(a.useEffect)((()=>{const e=m.getRefreshIntervalUpdate$().subscribe((()=>{f(m.getRefreshInterval())}));return()=>e.unsubscribe()}),[m,f]);const b=Boolean(p&&!1===p.pause&&p.value>0),{euiTheme:g}=Object(d.useEuiTheme)();return r===s-1&&n<l?u&&"boolean"==typeof t?n<=O.c-i?Object(k.jsx)(de,U()({hasButton:!0},e),Object(k.jsx)(d.EuiToolTip,{content:b?x.i18n.translate("unifiedDataTable.gridSampleSize.fetchMoreLinkDisabledTooltip",{defaultMessage:"To load more the refresh interval needs to be disabled first"}):void 0},Object(k.jsx)(d.EuiButtonEmpty,{disabled:b,isLoading:t,flush:"both","data-test-subj":"dscGridSampleSizeFetchMoreLink",onClick:u,css:Object(k.css)("margin-left:",g.size.xs,";","")},Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.fetchMoreLinkLabel",defaultMessage:"Load more"})))):Object(k.jsx)(de,U()({hasButton:!1},e)):n<l?Object(k.jsx)(de,U()({hasButton:!1},e)):null:null},de=({hasButton:e,rowCount:t,children:n,fieldFormats:a})=>{const{euiTheme:i}=Object(d.useEuiTheme)(),r=a.getDefaultInstance(R.b.NUMBER,[R.a.INTEGER]).convert(t);return Object(k.jsx)("p",{"data-test-subj":"unifiedDataTableFooter",css:Object(k.css)("display:flex;flex-direction:row;align-items:center;justify-content:center;flex-shrink:0;background-color:",i.colors.lightestShade,";padding:",e?`0 ${i.size.base}`:`${i.size.s} ${i.size.base}`,";margin-top:",i.size.xs,";text-align:center;","")},Object(k.jsx)("span",null,e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.lastPageDescription",defaultMessage:"Search results are limited to {rowCount} documents.",values:{rowCount:r}}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.limitDescription",defaultMessage:"Search results are limited to {sampleSize} documents. Add more search terms to narrow your search.",values:{sampleSize:r}})),n)};let me=function(e){return e.auto="auto",e.single="single",e.custom="custom",e}({});const pe=Object(d.htmlIdGenerator)()();function fe({label:e,rowHeight:t,rowHeightLines:n,compressed:a,onChangeRowHeight:r,onChangeRowHeightLines:s,maxRowHeight:o,"data-test-subj":l}){const u=[{id:`${pe}${me.single}`,label:x.i18n.translate("unifiedDataTable.rowHeight.single",{defaultMessage:"Single"}),"data-test-subj":`${l}_rowHeight_${me.single}`},{id:`${pe}${me.auto}`,label:x.i18n.translate("unifiedDataTable.rowHeight.auto",{defaultMessage:"Auto fit"}),"data-test-subj":`${l}_rowHeight_${me.auto}`},{id:`${pe}${me.custom}`,label:x.i18n.translate("unifiedDataTable.rowHeight.custom",{defaultMessage:"Custom"}),"data-test-subj":`${l}_rowHeight_${me.custom}`}];return Object(k.jsx)(i.a.Fragment,null,Object(k.jsx)(d.EuiFormRow,{label:e,display:"columnCompressed","data-test-subj":l},Object(k.jsx)(i.a.Fragment,null,Object(k.jsx)(d.EuiButtonGroup,{isFullWidth:!0,legend:e,buttonSize:"compressed",options:u,idSelected:`${pe}${null!=t?t:me.single}`,onChange:e=>{const t=e.replace(pe,"");r(t)},"data-test-subj":`${l}_rowHeightButtonGroup`}),t===me.custom?Object(k.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,showInput:!0,min:1,max:null!=o?o:20,step:1,value:null!=n?n:2,onChange:e=>{const t=Number(e.currentTarget.value);s(t)},"data-test-subj":`${l}_lineCountNumber`,css:Object(k.css)({marginTop:a?K.euiThemeVars.euiSizeXS:K.euiThemeVars.euiSizeM},"","")}):null)))}const be=()=>{},ge=({rowHeight:e,rowHeightLines:t,onChangeRowHeight:n,onChangeRowHeightLines:r,headerRowHeight:s,headerRowHeightLines:o,onChangeHeaderRowHeight:l,onChangeHeaderRowHeightLines:u,maxAllowedSampleSize:c=1e3,sampleSize:m,onChangeSampleSize:p})=>{const[f,b]=Object(a.useState)(m),g=Math.max(Math.min(10,m),1),v=Object(a.useMemo)((()=>Object(j.debounce)(null!=p?p:be,300,{leading:!1,trailing:!0})),[p]),y=Object(a.useCallback)((e=>{var t;if(!e.target.value)return void b("");const n=null!==(t=parseInt(e.target.value,10))&&void 0!==t?t:10;n>=1&&(b(n),n<=c&&v(n))}),[c,b,v]),h=x.i18n.translate("unifiedDataTable.sampleSizeSettings.sampleSizeLabel",{defaultMessage:"Sample size"});Object(a.useEffect)((()=>{b(m)}),[m,b]);const O=[];return l&&u&&O.push(Object(k.jsx)(fe,{rowHeight:s,rowHeightLines:o,label:x.i18n.translate("unifiedDataTable.headerRowHeightLabel",{defaultMessage:"Header row height"}),onChangeRowHeight:l,onChangeRowHeightLines:u,"data-test-subj":"unifiedDataTableHeaderRowHeightSettings",maxRowHeight:5})),n&&r&&O.push(Object(k.jsx)(fe,{rowHeight:e,rowHeightLines:t,label:x.i18n.translate("unifiedDataTable.rowHeightLabel",{defaultMessage:"Cell row height"}),onChangeRowHeight:n,onChangeRowHeightLines:r,"data-test-subj":"unifiedDataTableRowHeightSettings"})),p&&O.push(Object(k.jsx)(d.EuiFormRow,{label:h,display:"columnCompressed"},Object(k.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,min:g,max:c,step:10===g?10:1,showInput:!0,value:f,onChange:y,"data-test-subj":"unifiedDataTableSampleSizeInput"}))),Object(k.jsx)(i.a.Fragment,null,O.map(((e,t)=>Object(k.jsx)(i.a.Fragment,{key:`setting-${t}`},t>0&&Object(k.jsx)(d.EuiHorizontalRule,{margin:"s"}),e))))},ve=e=>"number"==typeof e&&!Number.isNaN(e)&&Math.floor(e)===e&&e>=-1&&e<=20,ye=(e,t)=>`${e}:${t}`,he=(e,t,n,a,i)=>{n.set(ye(a,i),{previousRowHeight:e,previousConfigRowHeight:t})},je=({storage:e,consumer:t,key:n,configRowHeight:i,rowHeightState:r,onUpdateRowHeight:s})=>{const o=Object(a.useMemo)((()=>{const a=((e,t,n)=>{const a=e.get(ye(t,n));return"object"==typeof a&&null!==a&&ve(a.previousRowHeight)&&ve(a.previousConfigRowHeight)?a:null})(e,t,n);let s;var o;return s=ve(r)?r:null!==(o=a)&&i===o.previousConfigRowHeight?a.previousRowHeight:i,s}),[i,t,n,r,e]),l=Object(a.useMemo)((()=>{switch(o){case O.d.auto:return me.auto;case O.d.single:return me.single;default:return me.custom}}),[o]),u=Object(a.useCallback)((a=>{let r;switch(a){case me.auto:r=O.d.auto;break;case me.single:r=O.d.single;break;default:r=i}he(r,i,e,t,n),null==s||s(r)}),[i,t,n,s,e]),c=Object(a.useCallback)((a=>{he(a,i,e,t,n),null==s||s(a)}),[i,t,n,s,e]);return{rowHeight:l,rowHeightLines:o,onChangeRowHeight:s?u:void 0,onChangeRowHeightLines:s?c:void 0}};var Oe=n(1494);const Ee=Object(Oe.a)(Object(a.lazy)((()=>n.e(48).then(n.bind(null,2116))))),xe="unifiedDataTable__fullScreen";let Se=function(e){return e.loading="loading",e.loadingMore="loadingMore",e.loaded="loaded",e}({});const we={darkMode:!1},ke=i.a.memo(d.EuiDataGrid),Ce=["openDetails","select"],Te=({ariaLabelledBy:e,columns:t,columnsMeta:n,showColumnTokens:r,configHeaderRowHeight:u,headerRowHeightState:y,onUpdateHeaderRowHeight:x,controlColumnIds:S=Ce,dataView:C,loadingState:T,onFilter:M,onResize:I,onSetColumns:_,onSort:A,rows:P,searchDescription:D,searchTitle:F,settings:R,showTimeCol:N,showFullScreenButton:B=!0,sort:q,useNewFieldsApi:V,isSortEnabled:$=!0,isPaginationEnabled:U=!0,cellActionsTriggerId:G,className:H,rowHeightState:Q,onUpdateRowHeight:W,maxAllowedSampleSize:K,sampleSizeState:J,onUpdateSampleSize:Y,isPlainRecord:X=!1,rowsPerPageState:Z,onUpdateRowsPerPage:ee,onFieldEdited:te,services:ne,renderCustomGridBody:ae,renderCustomToolbar:ie,trailingControlColumns:de,totalHits:me,onFetchMoreRecords:pe,renderDocumentView:fe,setExpandedDoc:be,expandedDoc:ve,configRowHeight:ye,showMultiFields:he=!0,maxDocFieldsDisplayed:Oe=50,externalControlColumns:Te,externalAdditionalControls:Me,rowsPerPageOptions:Ie,visibleCellActions:_e,externalCustomRenderers:Ae,additionalFieldGroups:Pe,consumer:De="discover",componentsTourSteps:Fe,gridStyleOverride:Re,rowLineHeightOverride:Ne,cellActionsMetadata:ze,customGridColumnsConfiguration:Le,customControlColumnsConfiguration:Be,enableComparisonMode:qe,cellContext:Ve,renderCellPopover:$e})=>{var Ue,Ge,He,Qe;const{fieldFormats:We,toastNotifications:Ke,dataViewFieldEditor:Je,uiSettings:Ye,storage:Xe,data:Ze}=ne,{darkMode:et}=c()(null!==(Ue=null===(Ge=ne.theme)||void 0===Ge?void 0:Ge.theme$)&&void 0!==Ue?Ue:Object(l.of)(we),we),tt=Object(a.useRef)(null),[nt,at]=Object(a.useState)([]),[it,rt]=Object(a.useState)(!1),[st,ot]=Object(a.useState)(!1),lt=Object(f.a)(t,C),ut=lt.includes("_source"),ct=Object(a.useMemo)((()=>{var e;return new Map(null!==(e=null==P?void 0:P.map((e=>[e.id,e])))&&void 0!==e?e:[])}),[P]),dt=Object(a.useCallback)((e=>ct.get(e)),[ct]),mt=Object(a.useMemo)((()=>{if(!nt.length||null==P||!P.length)return[];const e=nt.filter((e=>!!dt(e)));return 0===e.length&&it&&rt(!1),e}),[nt,null==P?void 0:P.length,it,dt]),pt=Object(a.useMemo)((()=>{if(!P)return[];if(!it||0===mt.length)return P;const e=P.filter((e=>mt.includes(e.id)));return e.length?e:P}),[P,mt,it]),ft=Object(a.useCallback)(((e,t,n)=>(({rowIndex:e,rows:t,columnId:n,dataView:a,fieldFormats:i,options:r})=>{var s,o;if(!t[e])return{formattedString:"",withFormula:!1};const l=t[e].flattened,u=null==l?void 0:l[n],c=a.fields.getByName(n),d=Array.isArray(u)?u:[u],m=null!==(s=null==r?void 0:r.compatibleWithCSV)&&void 0!==s&&s,p=null!==(o=null==r?void 0:r.compatibleWithCSV)&&void 0!==o&&o;if("_source"===(null==c?void 0:c.type))return{formattedString:v(l,m),withFormula:!1};let f=!1;return{formattedString:d.map((n=>{const r=Object(g.a)(n,t[e].raw,i,a,c,"text",{skipFormattingInStringifiedJSON:m});return"string"==typeof r?(f=f||Object(b.cellHasFormulas)(r),p?h(r):r):v(r,m)||""})).join(", "),withFormula:f}})({rowIndex:e,rows:pt,dataView:C,columnId:t,fieldFormats:We,options:n})),[pt,C,We]),bt=Object(a.useMemo)((()=>({expanded:ve,setExpanded:be,rows:pt,onFilter:M,dataView:C,isDarkMode:et,selectedDocs:mt,setSelectedDocs:e=>{at(e),it&&0===e.length&&rt(!1)},valueToStringConverter:ft,componentsTourSteps:Fe,isPlainRecord:X})),[Fe,et,C,X,pt,ve,it,M,be,mt,ft]),gt="number"==typeof Z&&Z>0?Z:O.a,[vt,yt]=Object(a.useState)({pageIndex:0,pageSize:gt}),ht=Object(a.useMemo)((()=>pt?pt.length:0),[pt]),jt=Object(a.useMemo)((()=>Math.ceil(ht/vt.pageSize)),[ht,vt]),Ot=Object(a.useMemo)((()=>{return U?{onChangeItemsPerPage:e=>{null==ee||ee(e)},onChangePage:e=>yt((t=>({...t,pageIndex:e}))),pageIndex:vt.pageIndex>jt-1?0:vt.pageIndex,pageSize:vt.pageSize,pageSizeOptions:null!=Ie?Ie:(e=vt.pageSize,Object(j.sortBy)(Object(j.uniq)("number"==typeof e&&e>0?[...O.e,e]:O.e)))}:void 0;var e}),[U,vt.pageIndex,vt.pageSize,jt,Ie,ee]);Object(a.useEffect)((()=>{yt((e=>e.pageSize===gt?e:{...e,pageSize:gt}))}),[gt,yt]);const Et=Object(a.useMemo)((()=>((e,t,n)=>{if(n)return()=>!0;const a=new Map;return e.forEach((e=>{a.set(e,((e,t)=>{var n;const a=t.fields.getByName(e);if(!a)return{show:!0};const i=Object(p.getDataViewFieldSubtypeMulti)(a.spec);return{show:!Boolean(null==i?void 0:i.multi),parentName:null==i||null===(n=i.multi)||void 0===n?void 0:n.parent}})(e,t))})),e=>{const t=a.get(e);return!t||t.show||!!t.parentName&&!a.has(t.parentName)}})(C.fields.getAll().map((e=>e.name)),C,he)),[C,he]),xt=Object(a.useMemo)((()=>Object(E.b)({dataView:C,rows:pt,useNewFieldsApi:V,shouldShowFieldHandler:Et,closePopover:()=>{var e;return null===(e=tt.current)||void 0===e?void 0:e.closeCellPopover()},fieldFormats:We,maxEntries:Oe,externalCustomRenderers:Ae,isPlainRecord:X})),[C,pt,V,Et,Oe,We,Ae,X]),St=Object(a.useMemo)((()=>null!=$e?$e:(()=>{const e=Object(a.memo)((function(e){const{setCellPopoverProps:t,DefaultCellPopover:n}=e;return Object(a.useEffect)((()=>{t({panelClassName:"unifiedDataTable__cellPopover"})}),[t]),Object(k.jsx)(n,e)}));return t=>Object(k.jsx)(e,t)})()),[$e]),wt=Object(a.useMemo)((()=>Object(d.htmlIdGenerator)()()),[]),kt=Object(a.useRef)();Object(a.useEffect)((()=>()=>{null!=kt&&kt.current&&(null==kt||kt.current())}),[]);const Ct=Object(a.useMemo)((()=>te?async e=>{var t;kt.current=te&&await(null==ne||null===(t=ne.dataViewFieldEditor)||void 0===t?void 0:t.openEditor({ctx:{dataView:C},fieldName:e,onSave:async()=>{await te()}}))}:void 0),[C,te,null==ne?void 0:ne.dataViewFieldEditor]),Tt=C.timeFieldName,Mt=Object(a.useCallback)((e=>function(e,t,n,a,i){return!(!a||!t)&&(!i||!!n&&t in n&&e.includes("_source"))}(e,Tt,n,N,X)),[Tt,X,N,n]),It=Object(a.useMemo)((()=>function(e,t,n){const a=t.timeFieldName;return n&&a&&!e.find((e=>e===a))?[a,...e]:e}(lt,C,Mt(lt))),[C,lt,Mt]),_t=Object(a.useCallback)(((e,t)=>pt[t%pt.length].flattened[e]),[pt]),At=Object(a.useMemo)((()=>G&&!X?It.map((e=>{var t,n;return null!==(t=null===(n=C.getFieldByName(e))||void 0===n?void 0:n.toSpec())&&void 0!==t?t:{name:"",type:"",aggregatable:!1,searchable:!1}})):void 0),[G,X,It,C]),Pt=Object(a.useMemo)((()=>({dataViewId:C.id,...null!=ze?ze:{}})),[C,ze]),Dt=Object(m.c)({fields:At,getCellValue:_t,triggerId:G,dataGridRef:tt,metadata:Pt}),{rowHeight:Ft,rowHeightLines:Rt,onChangeRowHeight:Nt,onChangeRowHeightLines:zt}=je({storage:Xe,consumer:De,key:"dataGridHeaderRowHeight",configRowHeight:null!=u?u:1,rowHeightState:y,onUpdateRowHeight:x}),{rowHeight:Lt,rowHeightLines:Bt,onChangeRowHeight:qt,onChangeRowHeightLines:Vt}=je({storage:Xe,consumer:De,key:"dataGridRowHeight",configRowHeight:null!=ye?ye:O.d.default,rowHeightState:Q,onUpdateRowHeight:W}),$t=Object(a.useMemo)((()=>ue({columns:It,columnsCellActions:Dt,rowsCount:pt.length,settings:R,dataView:C,defaultColumns:ut,isSortEnabled:$,isPlainRecord:X,services:{uiSettings:Ye,toastNotifications:Ke},hasEditDataViewPermission:()=>{var e;return Boolean(null==Je||null===(e=Je.userPermissions)||void 0===e?void 0:e.editIndexPattern())},valueToStringConverter:ft,onFilter:M,editField:Ct,visibleCellActions:_e,columnsMeta:n,showColumnTokens:r,headerRowHeightLines:Rt,customGridColumnsConfiguration:Le})),[n,Dt,Le,C,Je,ut,pt.length,Ct,Rt,X,$,M,R,r,Ke,Ye,ft,_e,It]),Ut=Object(a.useMemo)((()=>[{type:O.i,detector:()=>0,sortTextAsc:"",sortTextDesc:"",icon:"",color:""}]),[]),Gt=Object(a.useMemo)((()=>({visibleColumns:It,setVisibleColumns:e=>{const t=!Mt(e);_(e,t)}})),[It,_,Mt]),Ht=Object(a.useMemo)((()=>q.map((([e,t])=>({id:e,direction:t}))).filter((({id:e})=>It.includes(e)))),[q,It]),Qt=Object(a.useCallback)((e=>{$&&A&&A(e.map((({id:e,direction:t})=>[e,t])))}),[A,$]),Wt=Object(a.useMemo)((()=>{if($){if(X&&!t.length)return;return{columns:Ht,onSort:Qt}}return{columns:Ht,onSort:()=>{}}}),[$,Ht,X,t.length,Qt]),Kt=Boolean(be&&!!fe),Jt=Object(a.useMemo)((()=>{const e=function(e){return e?[oe,le]:[le]}(Kt).filter((({id:e})=>S.includes(e)));return Te?[...e,...Te]:e}),[Kt,S,Te]),Yt=null==Be?void 0:Be({controlColumns:{[se]:le,[re]:oe}}),Xt=null!==(He=null==Yt?void 0:Yt.leadingControlColumns)&&void 0!==He?He:Jt,Zt=null!==(Qe=null==Yt?void 0:Yt.trailingControlColumns)&&void 0!==Qe?Qe:de,en=Object(a.useMemo)((()=>Me||mt.length?Object(k.jsx)(i.a.Fragment,null,Boolean(mt.length)&&Object(k.jsx)(d.EuiFlexGroup,{gutterSize:"s",responsive:!1},qe&&mt.length>1&&Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(L,{selectedDocs:mt,setIsCompareActive:ot})),Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(z,{isPlainRecord:X,isFilterActive:it,rows:P,selectedDocs:mt,setSelectedDocs:at,setIsFilterActive:rt}))),Me):null),[Me,mt,X,it,qe,P]),tn=Object(a.useMemo)((()=>ie?e=>ie({toolbarProps:e,gridProps:{additionalControls:en}}):void 0),[ie,en]),nn=Object(a.useMemo)((()=>{const e={};return W&&(e.allowDensity=!1),(W||x||Y)&&(e.allowRowHeight=!1,e.allowResetButton=!1,e.additionalDisplaySettings=Object(k.jsx)(ge,{rowHeight:Lt,rowHeightLines:Bt,onChangeRowHeight:qt,onChangeRowHeightLines:Vt,headerRowHeight:Ft,headerRowHeightLines:Rt,onChangeHeaderRowHeight:Nt,onChangeHeaderRowHeightLines:zt,maxAllowedSampleSize:K,sampleSize:J,onChangeSampleSize:Y})),Object.keys(e).length?e:void 0}),[Ft,Rt,K,Nt,zt,qt,Vt,x,W,Y,Lt,Bt,J]),an=Object(a.useMemo)((()=>X&&t.length?{level:"sorting"}:void 0),[t.length,X]),rn=Object(a.useMemo)((()=>ut?{...O.j,showColumnSelector:!1,showSortSelector:$,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:B}:{...O.j,showSortSelector:$,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:B}),[ut,$,en,nn,B]),sn=(({rowHeightLines:e,rowLineHeight:t=O.g})=>Object(a.useMemo)((()=>{var n;return{defaultHeight:(n=e)===O.d.auto?"auto":n!==O.d.single?{lineCount:n}:void 0,lineHeight:t}}),[e,t]))({rowHeightLines:Bt,rowLineHeight:Ne}),{dataGridId:on,dataGridWrapper:ln,setDataGridWrapper:un}=(()=>{const e=Object(d.useGeneratedHtmlId)({prefix:"unifiedDataTable"}),[t,n]=Object(a.useState)(null),[i,r]=Object(a.useState)(null),s=Object(a.useCallback)(((t,n)=>{const a=document.getElementById(e);a&&(r(a),n.disconnect())}),[e]),o=Object(a.useCallback)((()=>{i&&(e=>{e.classList.contains("euiDataGrid--fullScreen")?document.body.classList.add(xe):document.body.classList.remove(xe)})(i)}),[i]);return Object(d.useMutationObserver)(t,s,{childList:!0,subtree:!0}),Object(d.useMutationObserver)(i,o,{attributes:!0,attributeFilter:["class"]}),{dataGridId:e,dataGridWrapper:t,setDataGridWrapper:n}})(),cn=T!==Se.loading;return ht||T!==Se.loading?ht?Object(k.jsx)(w.a.Provider,{value:bt},Object(k.jsx)("span",{className:"unifiedDataTable__inner"},Object(k.jsx)("div",{ref:un,key:st?"comparisonTable":"docTable","data-test-subj":"discoverDocTable","data-render-complete":cn,"data-shared-item":"","data-title":F,"data-description":D,"data-document-number":pt.length,className:s()(H,"unifiedDataTable__table")},st?Object(k.jsx)(Ee,{id:on,wrapper:ln,consumer:De,ariaDescribedBy:wt,ariaLabelledBy:e,dataView:C,isPlainRecord:X,selectedFieldNames:It,additionalFieldGroups:Pe,selectedDocs:nt,schemaDetectors:Ut,forceShowAllFields:ut,showFullScreenButton:B,fieldFormats:We,getDocById:dt,setSelectedDocs:at,setIsCompareActive:ot}):Object(k.jsx)(ke,{id:on,"aria-describedby":wt,"aria-labelledby":e,columns:$t,columnVisibility:Gt,"data-test-subj":"docTable",leadingControlColumns:Xt,onColumnResize:I,pagination:Ot,renderCellValue:xt,ref:tt,rowCount:ht,schemaDetectors:Ut,sorting:Wt,toolbarVisibility:rn,rowHeightsOptions:sn,inMemory:an,gridStyle:null!=Re?Re:O.b,renderCustomGridBody:ae,renderCustomToolbar:tn,trailingControlColumns:Zt,cellContext:Ve,renderCellPopover:St})),T!==Se.loading&&!mt.length&&U&&!st&&Object(k.jsx)(ce,{isLoadingMore:T===Se.loadingMore,rowCount:ht,sampleSize:J,pageCount:jt,pageIndex:null==Ot?void 0:Ot.pageIndex,totalHits:me,onFetchMoreRecords:pe,data:Ze,fieldFormats:We}),F&&Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("p",{id:String(wt)},D?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescriptionGrid",defaultMessage:"Table generated by search {searchTitle} ({searchDescription})",values:{searchTitle:F,searchDescription:D}}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescription",defaultMessage:"Table generated by search {searchTitle}",values:{searchTitle:F}}))),Kt&&ve&&fe(ve,pt,lt,n))):Object(k.jsx)("div",{className:"euiDataGrid__noResults","data-render-complete":cn,"data-shared-item":"","data-title":F,"data-description":D,"data-document-number":0},Object(k.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(k.jsx)(d.EuiIcon,{type:"discoverApp",size:"m",color:"subdued"}),Object(k.jsx)(d.EuiSpacer,{size:"s"}),Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.noResultsFound",defaultMessage:"No results found"}))):Object(k.jsx)("div",{className:"euiDataGrid__loading","data-test-subj":"unifiedDataTableLoading"},Object(k.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(k.jsx)(d.EuiLoadingSpinner,null),Object(k.jsx)(d.EuiSpacer,{size:"s"}),Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.loadingResults",defaultMessage:"Loading results"})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var a=n(721),i=n.n(a),r=n(19),s=n(2),o=n.n(s),l=n(41),u=n.n(l),c=n(4);const d=c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allActionsTooltip",{defaultMessage:"All actions"}),m=c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowAction",{defaultMessage:"Allow"}),p=(c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowByDefaultAction",{defaultMessage:"Allow by default"}),c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowedColumnTitle",{defaultMessage:"Allowed"})),f=(c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.alwaysSubmenu",{defaultMessage:"Always"}),c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeAction",{defaultMessage:"Anonymize"})),b=(c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeByDefaultAction",{defaultMessage:"Anonymize by default"}),c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizedColumnTitle",{defaultMessage:"Anonymized"})),g=c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.bulkActions",{defaultMessage:"Bulk actions"}),v=(c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.defaultsSubmenu",{defaultMessage:"Defaults"}),c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyAction",{defaultMessage:"Deny"})),y=(c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyByDefaultAction",{defaultMessage:"Deny by default"}),c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.fieldColumnTitle",{defaultMessage:"Field"})),h=c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.noButtonLabel",{defaultMessage:"No"}),j=(c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.resetButton",{defaultMessage:"Reset"}),c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeAction",{defaultMessage:"Unanonymize"})),O=(c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeByDefaultAction",{defaultMessage:"Unanonymize by default"}),c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.valuesColumnTitle",{defaultMessage:"Values"})),E=c.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.yesButtonLabel",{defaultMessage:"Yes"}),x="primary-panel-id";var S=n(43);const w=({appliesTo:e,disabled:t,disableAllow:n=!1,disableAnonymize:a=!1,disableDeny:i=!1,disableUnanonymize:o=!1,onListUpdated:l,selected:u})=>{const[c,p]=Object(s.useState)(!1),b=Object(r.useGeneratedHtmlId)({prefix:"contextEditorBulkActions"}),y=Object(s.useCallback)((()=>p(!1)),[]),h=Object(s.useCallback)((()=>p((e=>!e))),[]),O=Object(s.useMemo)((()=>Object(S.jsx)(r.EuiToolTip,{content:"multipleRows"===e?void 0:d},Object(S.jsx)(r.EuiButtonEmpty,{"data-test-subj":"bulkActionsButton",disabled:t,iconType:"multipleRows"===e?"arrowDown":"boxesVertical",iconSide:"multipleRows"===e?"right":void 0,onClick:h,size:"xs"},"multipleRows"===e?g:null))),[e,t,h]),E=Object(s.useMemo)((()=>(({disableAllow:e,disableAnonymize:t,disableDeny:n,disableUnanonymize:a,closePopover:i,onListUpdated:r,selected:s})=>[{id:x,items:[{disabled:e,icon:"check",name:m,onClick:()=>{i();const e=s.map((({field:e})=>({field:e,operation:"add",update:"allow"})));r(e)}},{disabled:n,icon:"cross",name:v,onClick:()=>{i();const e=s.map((({field:e})=>({field:e,operation:"remove",update:"allow"})));r(e)}},{disabled:t,icon:"eyeClosed",name:f,onClick:()=>{i();const e=s.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"})));r(e)}},{disabled:a,icon:"eye",name:j,onClick:()=>{i();const e=s.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"})));r(e)}},{isSeparator:!0,key:"sep"}]}])({disableAllow:n,disableAnonymize:a,disableDeny:i,disableUnanonymize:o,closePopover:y,onListUpdated:l,selected:u})),[y,n,a,i,o,l,u]);return Object(S.jsx)(r.EuiPopover,{anchorPosition:"downLeft",button:O,closePopover:y,"data-test-subj":"bulkActions",id:b,isOpen:c,panelPaddingSize:"none"},Object(S.jsx)(r.EuiContextMenu,{initialPanelId:x,panels:E,size:"s"}))},k=o.a.memo(w),C="allowed",T="anonymized",M="field",I=u()(r.EuiButtonEmpty)`
  max-height: 24px;
`;var _=n(1380);const A=({onListUpdated:e,onSelectAll:t,selected:n,totalFields:a})=>Object(S.jsx)(r.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbar",gutterSize:"none"},Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(r.EuiText,{color:"subdued","data-test-subj":"selectedFields",size:"xs"},(e=>c.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectedFields",{values:{selected:e},defaultMessage:"Selected {selected} fields"}))(n.length))),Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(r.EuiButtonEmpty,{"data-test-subj":"selectAllFields",iconType:"pagesSelect",onClick:t,size:"xs"},(e=>c.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectAllFields",{values:{totalFields:e},defaultMessage:"Select all {totalFields} fields"}))(a))),Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(k,{appliesTo:"multipleRows",disabled:0===n.length,onListUpdated:e,selected:n})));A.displayName="ToolbarComponent";const P=o.a.memo(A);var D=n(241),F=n(1345),R=n(1215);const N=i()("div",{target:"e9jzbiz0"})({name:"r5zj6l",styles:">div>.euiSpacer{block-size:16px;}"}),z={page:{size:10,index:0},sort:{direction:"asc",field:M}},L={box:{incremental:!0},filters:[{field:C,type:"is",name:p},{field:T,type:"is",name:b}]},B=({anonymizationFields:e,compressed:t=!0,onListUpdated:n,rawData:a,pageSize:i=10})=>{const o=Object(s.useRef)(!1),{assistantAvailability:{hasUpdateAIAssistantAnonymization:l},nameSpace:u}=Object(D.b)(),[c,d]=Object(s.useState)([]),m=Object(s.useMemo)((()=>({selectable:()=>!0,onSelectionChange:e=>{!0===o.current?o.current=!1:d(e)},selected:c})),[c]),f=Object(s.useMemo)((()=>(({compressed:e=!0,hasUpdateAIAssistantAnonymization:t,onListUpdated:n,rawData:a})=>{const i={field:"actions",name:"",render:(e,t)=>Object(S.jsx)(k,{appliesTo:"singleRow",disabled:!1,disableAllow:t.allowed,disableDeny:!t.allowed,disableAnonymize:!t.allowed||t.allowed&&t.anonymized,disableUnanonymize:!t.allowed||t.allowed&&!t.anonymized,onListUpdated:n,selected:[t]}),sortable:!1,width:"36px"},s={field:"rawValues",name:O,render:e=>Object(S.jsx)(r.EuiCode,{"data-test-subj":"rawValues"},e.join(",")),sortable:!1},o=[{field:C,name:p,render:(i,{allowed:s,field:o})=>Object(S.jsx)(r.EuiSwitch,{"data-test-subj":"allowed",checked:s,disabled:!t,label:"",showLabel:!1,compressed:e,onChange:()=>{n([{field:o,operation:s?"remove":"add",update:null==a?"defaultAllow":"allow"}])}}),sortable:!0,width:"75px"},{field:T,name:b,render:(e,{allowed:i,anonymized:s,field:o})=>Object(S.jsx)(I,{"data-test-subj":"anonymized",disabled:!i||!t,color:s?"primary":"text",flush:"both",iconType:s?"eyeClosed":"eye",isSelected:!!s,onClick:()=>n([{field:o,operation:s?"remove":"add",update:null==a?"defaultAllowReplacement":"allowReplacement"}])},Object(S.jsx)(r.EuiText,{size:"xs"},s?E:h)),sortable:!0,width:"102px"},{field:M,name:y,sortable:!0,width:"260px"}];return null==a?[...o,...t?[i]:[]]:[...o,s,...t?[i]:[]]})({onListUpdated:n,rawData:a,hasUpdateAIAssistantAnonymization:l,compressed:t})),[l,n,a,t]),g=Object(s.useMemo)((()=>(({anonymizationFields:e,rawData:t})=>{return null!==t&&"object"==typeof t?Object.keys(t).sort().reduce(((n,a)=>{var i,r,s;return[...n,{field:a,allowed:Object(_.a)({anonymizationFields:null!==(i=null==e?void 0:e.data)&&void 0!==i?i:[],field:a}),anonymized:Object(_.b)({anonymizationFields:null!==(r=null==e?void 0:e.data)&&void 0!==r?r:[],field:a}),denied:Object(_.c)({anonymizationFields:null!==(s=null==e?void 0:e.data)&&void 0!==s?s:[],field:a}),rawValues:t[a]}]}),[]):(null!==(n=null==e?void 0:e.data)&&void 0!==n?n:[]).map((e=>{var t,n,a;return{field:e.field,allowed:null!==(t=e.allowed)&&void 0!==t&&t,anonymized:null!==(n=e.anonymized)&&void 0!==n&&n,denied:!(null!==(a=e.allowed)&&void 0!==a&&a),rawValues:[]}}));var n})({anonymizationFields:e,rawData:a})),[e,a]),v=Object(s.useCallback)((()=>{o.current=!0,d(g)}),[g]),{onTableChange:j,pagination:x,sorting:w}=Object(F.b)({defaultTableOptions:z,nameSpace:u,storageKey:R.a}),A=Object(s.useMemo)((()=>Object(S.jsx)(P,{onListUpdated:n,onSelectAll:v,selected:c,totalFields:null==a?e.total:Object.keys(a).length})),[e.total,n,v,a,c]);return Object(S.jsx)(N,null,Object(S.jsx)(r.EuiInMemoryTable,{allowNeutralSort:!1,childrenBetween:l?A:void 0,columns:f,compressed:t,"data-test-subj":"contextEditor",itemId:M,items:g,pagination:x,search:L,selection:m,sorting:w,onTableChange:j}))};B.displayName="ContextEditorComponent";const q=o.a.memo(B)},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(19),i=n(2),r=n.n(i),s=n(41),o=n.n(s),l=n(1492),u=n(1488),c=n(1462),d=n(43),m=n(49),p=n(1290),f=n(4);const b=f.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableDescription",{defaultMessage:"Available"}),g=({total:e,inline:t,titleSize:n=p.a,gap:r=m.euiThemeVars.euiSizeXS})=>{const s=Object(i.useMemo)((()=>(e=>f.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableTooltip",{values:{total:e},defaultMessage:"{total} fields in this context are available to be included in the conversation"}))(e)),[e]);return Object(d.jsx)(a.EuiToolTip,{content:s},Object(d.jsx)(a.EuiStat,{css:t?Object(d.css)("display:flex;align-items:center;gap:",r,";",""):null,"data-test-subj":"availableStat",description:b,reverse:!0,title:e,titleSize:n}))};g.displayName="AvailableStatComponent";const v=r.a.memo(g),y=o()(a.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,h=({isDataAnonymizable:e,anonymizationFields:t,rawData:n,inline:r,replacements:s,titleSize:o,gap:m})=>{const{allowed:p,anonymized:f,total:b}=Object(i.useMemo)((()=>Object(c.a)({anonymizationFields:t,rawData:n,replacements:s})),[t,n,s]);return Object(d.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"stats",gutterSize:"none"},e&&Object(d.jsx)(y,{grow:!1},Object(d.jsx)(l.a,{allowed:p,gap:m,total:b,inline:r,titleSize:o})),Object(d.jsx)(y,{grow:!1},Object(d.jsx)(u.a,{anonymized:f,isDataAnonymizable:e||f>0,inline:r,titleSize:o,gap:m})),e&&Object(d.jsx)(y,{grow:!1},Object(d.jsx)(v,{total:b,inline:r,titleSize:o,gap:m})))};h.displayName="StatsComponent";const j=r.a.memo(h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n(43),i=n(19),r=n(2),s=n.n(r),o=n(49),l=n(659),u=n(721),c=n.n(u),d=n(44),m=n(4);m.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addSystemPromptTooltip",{defaultMessage:"Add system prompt"});const p=m.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.clearSystemPrompt",{defaultMessage:"Clear system prompt"}),f=m.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.selectASystemPromptPlaceholder",{defaultMessage:"Select a system prompt"}),b=m.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addNewSystemPrompt",{defaultMessage:"Add new system prompt..."}),g=m.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.emptyPrompt",{defaultMessage:"(empty prompt)"}),v=c()("strong",{target:"eqnkmgl0"})("margin-right:",o.euiThemeVars.euiSizeS,";");var y=n(241),h=n(812),j=n(918),O=n(1382),E=n(821);const x="ADD_NEW_SYSTEM_PROMPT";var S={name:"pozf4a",styles:"position:absolute;right:36px"},w={name:"1jqbq32",styles:"padding-right:56px!important"},k={name:"1bxycju",styles:"min-width:100%"},C={name:"qhxz92",styles:"max-width:100%"},T={name:"bjn8wh",styles:"position:relative"};const M=({allPrompts:e,compressed:t=!1,conversation:n,selectedPrompt:u,clearSelectedSystemPrompt:c,isClearable:m=!1,isCleared:M=!1,isDisabled:I=!1,isOpen:_=!1,refetchConversations:A,isSettingsModalVisible:P,onSystemPromptSelectionChange:D,setIsSettingsModalVisible:F,onSelectedConversationChange:R,setConversationSettings:N,setConversationsSettingsBulkActions:z})=>{const{setSelectedSettingsTab:L}=Object(y.b)(),{setApiConfig:B}=Object(h.a)(),q=Object(r.useMemo)((()=>e.filter((e=>e.promptType===l.a.system))),[e]),[V,$]=Object(r.useState)(_),U=Object(r.useCallback)((()=>$(!1)),[]),G=Object(r.useMemo)((()=>null==u?void 0:u.id),[null==u?void 0:u.id]),H=Object(r.useCallback)((async e=>{if(n&&n.apiConfig){const t=await B({conversation:n,apiConfig:{...n.apiConfig,defaultSystemPromptId:e}});return await(null==A?void 0:A()),t}}),[n,A,B]),Q=Object(r.useMemo)((()=>({value:x,inputDisplay:b,dropdownDisplay:Object(a.jsx)(i.EuiFlexGroup,{gutterSize:"none",key:x},Object(a.jsx)(i.EuiFlexItem,{grow:!0},Object(a.jsx)(i.EuiButtonEmpty,{href:"#",iconType:"plus",size:"xs","data-test-subj":"addSystemPrompt"},b)),Object(a.jsx)(i.EuiFlexItem,{grow:!1},Object(a.jsx)("div",{style:{width:"24px"}})))})),[]),W=Object(r.useMemo)((()=>(({prompts:e,isCleared:t})=>{var n;return null!==(n=null==e?void 0:e.map((e=>(({content:e,id:t,isCleared:n,name:r})=>({value:t,inputDisplay:Object(a.jsx)("span",{"data-test-subj":"systemPromptText",css:Object(a.css)("color:",n?o.euiThemeVars.euiColorLightShade:o.euiThemeVars.euiColorDarkestShade,";","")},r),dropdownDisplay:Object(a.jsx)(s.a.Fragment,null,Object(a.jsx)(v,{"data-test-subj":"name"},r),Object(a.jsx)(i.EuiToolTip,{content:void 0},Object(a.jsx)(i.EuiText,{color:"subdued","data-test-subj":"content",size:"s"},Object(d.isEmpty)(e)?Object(a.jsx)("p",null,g):Object(a.jsx)("p",null,e))))}))({...e,isCleared:t}))))&&void 0!==n?n:[]})({prompts:q,isCleared:M})),[q,M]),K=Object(r.useCallback)((async e=>{if(e===x)return F(!0),void L(E.h);null!=D&&D(e);const t=await H(e);t&&(null==N||N((e=>Object.entries(e).reduce(((e,[n,a])=>(t.title===a.title?e[t.id]=t:e[n]=a,e)),{}))),null==R||R(t),null==z||z({}))}),[R,D,N,z,F,L,H]),J=Object(r.useCallback)((()=>{null==c||c()}),[c]);return Object(a.jsx)(i.EuiFlexGroup,{"data-test-subj":"selectSystemPrompt",gutterSize:"none",alignItems:"center",css:T},Object(a.jsx)(i.EuiFlexItem,{css:C},Object(a.jsx)(i.EuiFormRow,{css:k},Object(a.jsx)(i.EuiSuperSelect,{popoverProps:{zIndex:o.euiThemeVars.euiZLevel8},compressed:t,"data-test-subj":j.a.PROMPT_SUPERSELECT,fullWidth:!0,hasDividers:!0,itemLayoutAlign:"top",disabled:I,isOpen:V&&!P,onChange:K,onBlur:U,options:[...W,Q],placeholder:f,valueOfSelected:G,prepend:P?void 0:O.c,css:w}))),Object(a.jsx)(i.EuiFlexItem,{grow:!1,css:S},m&&u&&Object(a.jsx)(i.EuiToolTip,{content:p},Object(a.jsx)(i.EuiButtonIcon,{"aria-label":p,"data-test-subj":"clearSystemPrompt",iconType:"cross",onClick:J,css:Object(a.css)("inline-size:16px;block-size:16px;border-radius:16px;background:",M?o.euiThemeVars.euiColorLightShade:o.euiThemeVars.euiColorMediumShade,";:hover:not(:disabled){background:",M?o.euiThemeVars.euiColorLightShade:o.euiThemeVars.euiColorMediumShade,";transform:none;}>svg{width:8px;height:8px;stroke-width:2px;fill:#fff;stroke:#fff;}","")}))))};M.displayName="SelectSystemPromptComponent";const I=s.a.memo(M)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(19),i=n(2),r=n.n(i),s=n(43),o=n(49),l=n(4);const u=l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.anonymizeFieldsdDescription",{defaultMessage:"Anonymized"});var c=n(1290);const d=({anonymized:e,isDataAnonymizable:t,inline:n,titleSize:r=c.a,gap:d=o.euiThemeVars.euiSizeXS})=>{const m=Object(i.useMemo)((()=>(e=>e?"default":"subdued")(t)),[t]),p=Object(i.useMemo)((()=>(({anonymized:e,isDataAnonymizable:t})=>t&&0!==e?(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.fieldsWillBeAnonymizedTooltip",{values:{anonymized:e},defaultMessage:"{anonymized} {anonymized, plural, =1 {field} other {fields}} in this context will be replaced with random values. Responses are automatically translated back to the original values."}))(e):(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.noneOfTheDataWillBeAnonymizedTooltip",{values:{isDataAnonymizable:e},defaultMessage:"{isDataAnonymizable, select, true {Select fields to be replaced with random values. Responses are automatically translated back to the original values.} other {This context cannot be anonymized}}"}))(t))({anonymized:e,isDataAnonymizable:t})),[e,t]),f=Object(i.useMemo)((()=>Object(s.jsx)(a.EuiText,{color:m,"data-test-subj":"description",size:"s"},u)),[m]);return Object(s.jsx)(a.EuiToolTip,{content:p},Object(s.jsx)(a.EuiStat,{css:n?Object(s.css)("display:flex;align-items:center;gap:",d,";",""):null,"data-test-subj":"anonymizedFieldsStat",description:f,reverse:!0,titleColor:m,title:e,titleSize:r}))};d.displayName="AnonymizedStatComponent";const m=r.a.memo(d)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(204),r=n(818);const s=e=>Object(a.useMemo)((()=>({async addExceptionListItem({listItem:t}){const n=new AbortController,a=Object(r.c)(t);return i.a({http:e,listItem:a,signal:n.signal})},async deleteExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:r}){const s=new AbortController;try{await i.e({http:e,id:t,namespaceType:n,signal:s.signal}),a()}catch(e){r(e)}},async deleteExceptionList({id:t,namespaceType:n,onSuccess:a,onError:r}){const s=new AbortController;try{await i.d({http:e,id:t,namespaceType:n,signal:s.signal}),a()}catch(e){r(e)}},async duplicateExceptionList({includeExpiredExceptions:t,listId:n,namespaceType:a,onError:r,onSuccess:s}){const o=new AbortController;try{s(await i.h({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:o.signal}))}catch(e){r(e)}},async exportExceptionList({id:t,includeExpiredExceptions:n,listId:a,namespaceType:r,onError:s,onSuccess:o}){const l=new AbortController;try{o(await i.i({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:r,signal:l.signal}))}catch(e){s(e)}},async getExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:s}){const o=new AbortController;try{a(Object(r.b)(await i.l({http:e,id:t,namespaceType:n,signal:o.signal})))}catch(e){s(e)}},async getExceptionList({id:t,namespaceType:n,onSuccess:a,onError:r}){const s=new AbortController;try{a(await i.k({http:e,id:t,namespaceType:n,signal:s.signal}))}catch(e){r(e)}},async getExceptionListsItems({lists:t,filter:n,pagination:a,showDetectionsListsOnly:s,showEndpointListsOnly:o,onSuccess:l,onError:u}){const c=new AbortController,{ids:d,namespaces:m}=(({lists:e,showDetection:t,showEndpoint:n})=>e.filter((e=>t?"detection"===e.type:!n||"endpoint"===e.type)).reduce(((e,{listId:t,namespaceType:n})=>({ids:[...e.ids,t],namespaces:[...e.namespaces,n]})),{ids:[],namespaces:[]}))({lists:t,showDetection:s,showEndpoint:o});try{if(d.length>0&&m.length>0){const{data:t,page:s,per_page:o,total:u}=await i.n({filter:n,http:e,listIds:d,namespaceTypes:m,pagination:a,signal:c.signal});l({exceptions:t.map((e=>Object(r.b)(e))),pagination:{page:s,perPage:o,total:u}})}else l({exceptions:[],pagination:{page:0,perPage:null!=a.perPage?a.perPage:0,total:0}})}catch(e){u(e)}},async getExceptionFilterFromIds({exceptionListIds:t,chunkSize:n,alias:a,excludeExceptions:r,onSuccess:s,onError:o}){const l=new AbortController;try{const{filter:o}=await i.q({http:e,exceptionListIds:t,signal:l.signal,chunkSize:n,alias:a,excludeExceptions:r});s(o)}catch(e){o(e)}},async getExceptionFilterFromExceptions({exceptions:t,chunkSize:n,alias:a,excludeExceptions:r,onSuccess:s,onError:o}){const l=new AbortController;try{const{filter:o}=await i.r({http:e,exceptions:t,signal:l.signal,chunkSize:n,alias:a,excludeExceptions:r});s(o)}catch(e){o(e)}},async updateExceptionListItem({listItem:t}){const n=new AbortController,a=Object(r.d)(t);return i.y({http:e,listItem:a,signal:n.signal})}})),[e])},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(19),i=n(2),r=n.n(i),s=n(49),o=n(43),l=n(1290),u=n(4);const c=u.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedDescription",{defaultMessage:"Allowed"}),d=({allowed:e,total:t,inline:n,titleSize:r=l.a,gap:d=s.euiThemeVars.euiSizeXS})=>{const m=Object(i.useMemo)((()=>(({allowed:e,total:t})=>u.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedTooltip",{values:{allowed:e,total:t},defaultMessage:"{allowed} of {total} fields in this context are allowed to be included in the conversation"}))({allowed:e,total:t})),[e,t]);return Object(o.jsx)(a.EuiToolTip,{content:m},Object(o.jsx)(a.EuiStat,{css:n?Object(o.css)("display:flex;align-items:center;gap:",d,";",""):null,"data-test-subj":"allowedStat",description:c,reverse:!0,title:e,titleSize:r}))};d.displayName="AllowedStatComponent";const m=r.a.memo(d)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(119),i=n.n(a),r=n(84),s=n(2),o=n.n(s),l=n(19),u=n(43),c={name:"1azakc",styles:"text-align:center"};const d=()=>{const e=c;return Object(u.jsx)("div",{css:e},Object(u.jsx)(l.EuiLoadingSpinner,null))},m=(e,t=Object(u.jsx)(d,null))=>o.a.forwardRef(((n,a)=>Object(u.jsx)(r.KibanaErrorBoundaryProvider,{analytics:n.analytics},Object(u.jsx)(r.KibanaErrorBoundary,null,Object(u.jsx)(s.Suspense,{fallback:t},Object(u.jsx)(e,i()({},n,{ref:a})))))))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t,n)=>{const a=t.indexOf(e),i=[...t];a>=0?i.splice(a,1):i.push(e),n(i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n(2);var a=n(43);const i={xl:64,l:48,m:32,s:24,xs:16,xxs:12},r=({className:e,size:t="s"})=>Object(a.jsx)("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",width:i[t],height:i[t],viewBox:"0 0 64 64",fill:"none"},Object(a.jsx)("path",{fill:"#F04E98",d:"M36 28h24v36H36V28Z"}),Object(a.jsx)("path",{fill:"#00BFB3",d:"M4 46c0-9.941 8.059-18 18-18h6v36h-6c-9.941 0-18-8.059-18-18Z"}),Object(a.jsx)("path",{fill:"#343741",d:"M60 12c0 6.627-5.373 12-12 12s-12-5.373-12-12S41.373 0 48 0s12 5.373 12 12Z"}),Object(a.jsx)("path",{fill:"#FA744E",d:"M6 23C6 10.85 15.85 1 28 1v22H6Z"}))},function(e,t,n){(function(e){var a=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(1537),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(1285))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var a,i,r,s,o,l=1,u={},c=!1,d=e.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(e);m=m&&m.setTimeout?m:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick((function(){f(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(s="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&f(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),a=function(t){e.postMessage(s+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){f(e.data)},a=function(e){r.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,a=function(e){var t=d.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):a=function(e){setTimeout(f,0,e)},m.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return u[l]=i,a(l),l++},m.clearImmediate=p}function p(e){delete u[e]}function f(e){if(c)setTimeout(f,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(undefined,n)}}(t)}finally{p(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(1285),n(892))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var a=n(119),i=n.n(a),r=n(72),s=n(60),o=n.n(s),l=n(2),u=n.n(l),c=n(41),d=n.n(c),m=n(19),p=n(55),f=n(5),b=n(759),g=n(276),v=n(1255),y=n(250),h=n(118),j=n(1206),O=n(349),E=n(917),x=n(156),S=n(194),w=n(534);const k=e=>({text:e,value:e}),C=d()(m.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-11itwu1-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiSizeL)),T=({filterQuery:e,deleteQuery:t,filters:n,from:a,headerChildren:s,indexPattern:c,onlyField:d,paddingSize:m,query:T,queryType:M,setQuery:I,showSpacer:_=!0,sourcererScopeId:A,to:P,toggleTopN:D,hideQueryToggle:F=!1,applyGlobalQueriesAndFilters:R})=>{const N=Object(l.useMemo)((()=>`eventsByDatasetOverview-${M}`),[M]);Object(l.useEffect)((()=>()=>{t&&t({id:N})}),[t,N]);const z=Object(h.j)(),{formatUrl:L,search:B}=Object(S.l)(x.a.hosts),{navigateToApp:q}=z.services.application,[V]=Object(h.o)(f.W),$=Object(l.useCallback)((e=>{e.preventDefault(),q(f.m,{deepLinkId:x.a.hosts,path:Object(g.c)(O.HostsTableType.events,B)})}),[q,B]),U=Object(l.useMemo)((()=>u.a.createElement(C,{onClick:$,href:L(Object(g.c)(O.HostsTableType.events))},E.o)),[$,L]),[G,H]=Object(l.useMemo)((()=>null==e?Object(y.i)({config:Object(p.getEsQueryConfig)(z.services.uiSettings),indexPattern:c,queries:[T],filters:n}):[e]),[e,z,c,T,n]);Object(w.a)({id:N,filterQuery:G,kqlError:H,query:T,startDate:a,endDate:P});const Q=Object(l.useMemo)((()=>{var e;return{...j.b,stackByOptions:null!=d?[k(d)]:j.b.stackByOptions,defaultStackByOption:null!=d?k(d):null!==(e=j.c.find((e=>"event.dataset"===e.text)))&&void 0!==e?e:j.c[0],legendPosition:r.Position.Right,subtitle:e=>`${b.b}: ${o()(e).format(V)} ${Object(b.c)(e)}`,titleSize:null==d?"m":"s"}}),[d,V]),W=Object(l.useMemo)((()=>null==d||null!=s?u.a.createElement(u.a.Fragment,null,s,null==d&&U):null),[d,s,U]);return u.a.createElement(v.a,i()({endDate:P,filterQuery:G,headerChildren:W,id:N,paddingSize:m,setQuery:I,showSpacer:_,startDate:a,sourcererScopeId:A},Q,{title:null!=d?E.l(d):Q.title,chartHeight:160,hideQueryToggle:F,applyGlobalQueriesAndFilters:R}))};T.displayName="EventsByDatasetComponent";const M=u.a.memo(T)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(1326),r=n(1450),s=n(1288),o=n(812),l=n(241),u=n(755),c=n(578),d=n(43);const m=({conversation:e,onConversationUpdate:t,updateConversationsOnSaveConnector:n=!0})=>{const m=Object(a.useMemo)((()=>e||r.a),[e]),{setApiConfig:p}=Object(o.a)(),{actionTypeRegistry:f,http:b}=Object(l.b)(),{refetch:g}=Object(u.a)({http:b}),{data:v}=Object(s.a)({http:b}),[y,h]=Object(a.useState)(null),j=Object(a.useCallback)((async e=>{if(n){const n=Object(c.c)(e),a=await p({conversation:m,apiConfig:{...m.apiConfig,connectorId:e.id,actionTypeId:e.actionTypeId,provider:null==n?void 0:n.apiProvider,model:null==n?void 0:n.defaultModel}});a&&(null==t||t({cId:a.id,cTitle:a.title}),null==g||g())}else null==g||g()}),[m,t,g,p,n]),O=Object(a.useCallback)((()=>{h(null)}),[]);return Object(d.jsx)(i.a,{actionTypeRegistry:f,actionTypes:v,onClose:O,onSaveConnector:j,onSelectActionType:h,selectedActionType:y,actionTypeSelectorInline:!0})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(2081),r=n(2080);const s=async(e,t,n)=>{try{const n=await e.fetch(i.h,{method:"POST",version:r.a.public.v1,body:JSON.stringify(t)});if(!n.success){var s;const e=null===(s=n.attributes.errors)||void 0===s?void 0:s.map((e=>`${e.status_code?`Error code: ${e.status_code}. `:""}Error message: ${e.message} for prompt ${e.prompts.map((e=>e.name)).join(",")}`)).join(",\n");throw new Error(e)}return n}catch(e){null==n||n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:a.i18n.translate("xpack.elasticAssistant.prompts.bulkActionspromptsError",{defaultMessage:"Error updating prompts {error}",values:{error:e.message?Array.isArray(e.message)?e.message.join(","):e.message:e}})})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(2081),r=n(2080);const s=async(e,t,n)=>{var s,o;const l=t.create?(u=t.create,c=null===(s=t.delete)||void 0===s?void 0:s.ids,Object.keys(u).reduce(((e,t)=>(!u||null!=c&&c.includes(t)||e.push(u[t]),e)),[])):void 0;var u,c;const d=t.update?((e,t)=>Object.keys(e).reduce(((n,a)=>(!e||null!=t&&t.includes(a)||n.push({id:a,...e[a]}),n)),[]))(t.update,null===(o=t.delete)||void 0===o?void 0:o.ids):void 0;try{const n=await e.fetch(i.d,{method:"POST",version:r.a.internal.v1,body:JSON.stringify({update:d,create:l,delete:t.delete})});if(!n.success){var m;const e=null===(m=n.attributes.errors)||void 0===m?void 0:m.map((e=>`${e.status_code?`Error code: ${e.status_code}. `:""}Error message: ${e.message} for conversation ${e.conversations.map((e=>e.name)).join(",")}`)).join(",\n");throw new Error(e)}return n}catch(e){null==n||n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:a.i18n.translate("xpack.elasticAssistant.conversations.bulkActionsConversationsError",{defaultMessage:"Error updating conversations {error}",values:{error:e.message?Array.isArray(e.message)?e.message.join(","):e.message:e}})})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(756);const r=({allSystemPrompts:e,conversationSettings:t,conversationsSettingsBulkActions:n,defaultConnector:r,setConversationSettings:s,setConversationsSettingsBulkActions:o,onSelectedConversationChange:l})=>{const u=Object(a.useMemo)((()=>Object(i.d)({allSystemPrompts:e,conversation:void 0})),[e]);return Object(a.useCallback)(((e="")=>{const a="string"==typeof e,i=a?{id:"",title:null!=e?e:"",category:"assistant",messages:[],replacements:{},...r?{apiConfig:{connectorId:r.id,actionTypeId:r.actionTypeId,provider:r.apiProvider,defaultSystemPromptId:null==u?void 0:u.id}}:{}}:e;var c;i&&(a||""===i.id)?(s({...t,[a?e:i.title]:i}),o({...n,create:{...null!==(c=n.create)&&void 0!==c?c:{},[i.title]:i}})):null!=i&&s((e=>({...e,[i.id]:i}))),l({...i,id:i.id||i.title})}),[t,n,r,null==u?void 0:u.id,l,s,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=({conversationSettings:e,conversationsSettingsBulkActions:t,setConversationSettings:n,setConversationsSettingsBulkActions:i})=>Object(a.useCallback)((a=>{var r,s,o;const l=null===(r=Object.values(e).find((e=>e.title===a)))||void 0===r?void 0:r.id;if(!l)return;const u={...e};delete u[l],n(u),i({...t,delete:{ids:[...null!==(s=null===(o=t.delete)||void 0===o?void 0:o.ids)&&void 0!==s?s:[],l]}})}),[e,t,n,i])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=({anonymizationFields:e,anonymizationFieldsBulkActions:t,setAnonymizationFieldsBulkActions:n,setUpdatedAnonymizationData:i})=>Object(a.useCallback)((async a=>{var r;const s=a.map((e=>e.field)),o=a.map((t=>{var n;return{...null!==(n=e.data.find((e=>e.field===t.field)))&&void 0!==n?n:{id:"",field:""},..."allow"===t.update||"defaultAllow"===t.update?{allowed:"add"===t.operation}:{},..."allowReplacement"===t.update||"defaultAllowReplacement"===t.update?{anonymized:"add"===t.operation}:{}}}));n({...t,update:[...null!==(r=null==t?void 0:t.update)&&void 0!==r?r:[],...o]}),i({...e,data:[...e.data.filter((e=>!s.includes(e.field))),...o]})}),[e,t,n,i])},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(19),i=n(43),r=n(2),s=n.n(r),o=n(1291);const l=({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{const n=Object(a.useGeneratedHtmlId)({prefix:"inputRangeSlider"});return Object(i.jsx)(s.a.Fragment,null,Object(i.jsx)(a.EuiFormRow,{display:"columnCompressedSwitch",label:o.a,css:Object(i.css)(".euiFormRow__labelWrapper{min-width:",95,"px!important;}","")},Object(i.jsx)(s.a.Fragment,null)),Object(i.jsx)(a.EuiSpacer,{size:"xs"}),Object(i.jsx)(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(i.jsx)(a.EuiFlexItem,{css:Object(i.css)("width:",300,"px;",""),grow:!1},Object(i.jsx)(a.EuiSpacer,{size:"xs"}),Object(i.jsx)(a.EuiRange,{"aria-label":o.b,compressed:!0,"data-test-subj":"alertsRange",id:n,max:100,min:10,onChange:n=>t({...e,latestAlerts:Number(n.currentTarget.value)}),showTicks:!0,step:10,value:e.latestAlerts}),Object(i.jsx)(a.EuiSpacer,{size:"s"})),Object(i.jsx)(a.EuiFlexItem,{grow:!1},Object(i.jsx)(a.EuiText,{color:"subdued",size:"xs"},Object(i.jsx)("span",null,o.k(e.latestAlerts)))),Object(i.jsx)(a.EuiFlexItem,{grow:!1},Object(i.jsx)(a.EuiText,{color:"subdued",size:"xs"},Object(i.jsx)("span",null,o.q))),Object(i.jsx)(a.EuiFlexItem,{grow:!1},Object(i.jsx)(a.EuiText,{color:"subdued",size:"xs"},Object(i.jsx)("span",null,o.l)))))},u=s.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(7);const i=(e,t)=>{var n,i;const r={...e,fields:null==e||null===(n=e.searchSource)||void 0===n?void 0:n.getFields()},s={...t,fields:null==t||null===(i=t.searchSource)||void 0===i?void 0:i.getFields()},o=["columns","sort","timeRange","fields.filter","fields.query","title","description"],l=Object(a.pick)(r,o),u=Object(a.pick)(s,o);return Object(a.isEqual)(l,u)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),i=n.n(a),r=n(19),s=n(43),o=n(1457),l=n(4);const u=l.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),c=l.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.deletePromptTitle",{defaultMessage:"Delete Quick Prompt"}),d=l.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.customOptionText",{defaultMessage:"Create new Quick Prompt named"});var m={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},p={name:"d3v9zr",styles:"overflow:hidden"},f={name:"1e5733u",styles:"width:calc(100% - 60px)"};const b=i.a.memo((({isDisabled:e=!1,quickPrompts:t,onQuickPromptDeleted:n,onQuickPromptSelectionChange:i,resetSettings:o,selectedQuickPrompt:l})=>{const[b,g]=Object(a.useState)(t.map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.name,"data-test-subj":e.name,id:e.id,color:e.color}}))),v=Object(a.useMemo)((()=>l?[{value:{isDefault:!0},label:l.name,id:l.id,color:l.color}]:[]),[l]),y=Object(a.useCallback)((e=>{var n,a;null==o||o();const r=0===e.length?void 0:null!==(n=t.find((t=>{var n;return t.name===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==n?n:null===(a=e[0])||void 0===a?void 0:a.label;i(r)}),[i,o,t]),h=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e,id:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||g([...b,a]),y([a])}),[y,b]),j=Object(a.useCallback)((e=>{0===e.length?y([]):-1!==b.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&y(e)}),[y,b]),O=Object(a.useCallback)((e=>{var t,a;const i=null===(t=b.find((t=>t.label===e)))||void 0===t?void 0:t.id;g(b.filter((t=>t.label!==e))),(null==v||null===(a=v[0])||void 0===a?void 0:a.label)===e&&y([]),n(null!=i?i:e)}),[y,n,b,v]);return Object(s.jsx)(r.EuiComboBox,{"data-test-subj":"quickPromptSelector","aria-label":u,compressed:!0,isDisabled:e,placeholder:u,customOptionText:`${d} {searchValue}`,singleSelection:!0,options:b,selectedOptions:v,onChange:j,onCreateOption:h,renderOption:(e,t)=>{const{color:n,label:a,value:i}=e;return Object(s.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(s.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:f},Object(s.jsx)(r.EuiHealth,{color:n,css:p},Object(s.jsx)(r.EuiHighlight,{search:t},a))),!(null!=i&&i.isDefault)&&Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(r.EuiToolTip,{position:"right",content:c},Object(s.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":c,"data-test-subj":"delete-quick-prompt",color:"danger",onClick:e=>{e.stopPropagation(),O(a)},css:m}))))},fullWidth:!0})}));b.displayName="QuickPromptSelector";var g=n(1382);const v=i.a.memo((({isDisabled:e,onPromptContextSelectionChange:t,promptContexts:n,selectedPromptContexts:i=[]})=>{const o=Object(a.useMemo)((()=>n.map((e=>({value:{category:e.category},label:e.description,"data-test-subj":e.description})))),[n]),l=Object(a.useMemo)((()=>null!=i?i.map((e=>({value:{category:e.category},label:e.description}))):[]),[i]),u=Object(a.useCallback)((e=>{const a=n.filter((t=>e.some((e=>t.description===e.label))));t(a)}),[t,n]),c=Object(a.useCallback)((e=>{0===e.length?u([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&u(e)}),[u,o]);return Object(s.jsx)(r.EuiComboBox,{"aria-label":g.a,compressed:!0,fullWidth:!0,isDisabled:e,placeholder:g.b,options:o,selectedOptions:l,onChange:c,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(s.jsx)("span",{className:n},Object(s.jsx)(r.EuiHighlight,{search:t},a),Object(s.jsx)("span",null,` / (${null==i?void 0:i.category})`))}})}));v.displayName="PromptContextSelector";var y=n(241),h=n(1458),j={name:"xpz1vu",styles:"min-height:150px"};const O=({onSelectedQuickPromptChange:e,quickPromptSettings:t,resetSettings:n,selectedQuickPrompt:l,setUpdatedQuickPromptSettings:u,promptsBulkActions:c,setPromptsBulkActions:d})=>{const{basePromptContexts:m}=Object(y.b)(),p=Object(a.useMemo)((()=>{var e,n;return null!==(e=null===(n=t.find((e=>e.id===(null==l?void 0:l.id))))||void 0===n?void 0:n.content)&&void 0!==e?e:""}),[null==l?void 0:l.id,t]),f=Object(a.useCallback)((e=>{var n,a;null!=l&&(u((t=>t.some((e=>e.id===l.id))?t.map((t=>t.id===l.id?{...t,content:e.target.value}:t)):t)),t.find((e=>e.id===l.id))&&d({...c,...l.name!==l.id?{update:[...(null!==(n=c.update)&&void 0!==n?n:[]).filter((e=>e.id!==l.id)),{...l,content:e.target.value}]}:{create:[...(null!==(a=c.create)&&void 0!==a?a:[]).filter((e=>e.name!==l.name)),{...l,content:e.target.value}]}}))}),[c,t,l,d,u]),g=Object(a.useMemo)((()=>{var e;return null!==(e=null==l?void 0:l.color)&&void 0!==e?e:"#D36086"}),[null==l?void 0:l.color]),O=Object(a.useCallback)(((e,{hex:n,isValid:a})=>{var i,r;null!=l&&(u((t=>t.some((e=>e.name===l.name))?t.map((t=>t.name===l.name?{...t,color:e}:t)):t)),t.find((e=>e.id===l.id))&&d({...c,...l.name!==l.id?{update:[...(null!==(i=c.update)&&void 0!==i?i:[]).filter((e=>e.id!==l.id)),{...l,color:e}]}:{create:[...(null!==(r=c.create)&&void 0!==r?r:[]).filter((e=>e.name!==l.name)),{...l,color:e}]}}))}),[c,t,l,d,u]),E=Object(a.useMemo)((()=>{var e;return null!==(e=m.filter((e=>{var t;return null==l||null===(t=l.categories)||void 0===t?void 0:t.some((t=>(null==e?void 0:e.category)===t))})))&&void 0!==e?e:[]}),[m,null==l?void 0:l.categories]),x=Object(a.useCallback)((e=>{var n,a;null!=l&&(u((t=>t.some((e=>e.name===l.name))?t.map((t=>t.name===l.name?{...t,categories:e.map((e=>e.category))}:t)):t)),t.find((e=>e.id===l.id))&&d({...c,...l.name!==l.id?{update:[...(null!==(n=c.update)&&void 0!==n?n:[]).filter((e=>e.id!==l.id)),{...l,categories:e.map((e=>e.category))}]}:{create:[...(null!==(a=c.create)&&void 0!==a?a:[]).filter((e=>e.name!==l.name)),{...l,categories:e.map((e=>e.category))}]}}))}),[c,t,l,d,u]),{onQuickPromptDeleted:S,onQuickPromptSelectionChange:w}=Object(h.a)({onSelectedQuickPromptChange:e,setUpdatedQuickPromptSettings:u,promptsBulkActions:c,setPromptsBulkActions:d});return Object(s.jsx)(i.a.Fragment,null,Object(s.jsx)(r.EuiFormRow,{label:o.d,display:"rowCompressed",fullWidth:!0},Object(s.jsx)(b,{onQuickPromptDeleted:S,onQuickPromptSelectionChange:w,quickPrompts:t,resetSettings:n,selectedQuickPrompt:l})),Object(s.jsx)(r.EuiFormRow,{label:o.e,display:"rowCompressed",fullWidth:!0},Object(s.jsx)(r.EuiTextArea,{compressed:!0,disabled:null==l,fullWidth:!0,"data-test-subj":"quick-prompt-prompt",onChange:f,placeholder:o.f,value:p,css:j})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:o.b,helpText:o.c},Object(s.jsx)(v,{isDisabled:null==l,onPromptContextSelectionChange:x,promptContexts:m,selectedPromptContexts:E})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:o.a},Object(s.jsx)(r.EuiColorPicker,{color:g,compressed:!0,disabled:null==l,onChange:O})))},E=Object(a.memo)(O);E.displayName="QuickPromptSettingsEditor"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(2),i=n.n(a),r=n(19),s=n(44),o=n(43),l=n(920),u=n(918);const c=i.a.memo((({conversations:e,isDisabled:t=!1,onConversationSelectionChange:n,selectedConversations:i=[]})=>{const s=Object(a.useMemo)((()=>e.map((e=>{var t;return{label:null!==(t=e.title)&&void 0!==t?t:"","data-test-subj":u.a.CONVERSATIONS_MULTISELECTOR_OPTION(e.title)}}))),[e]),c=Object(a.useMemo)((()=>null!=i?i.map((e=>({label:e.title}))):[]),[i]),d=Object(a.useCallback)((t=>{const a=e.filter((e=>t.some((t=>e.title===t.label))));n(a)}),[n,e]),m=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==s.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,s]);return Object(o.jsx)(r.EuiComboBox,{"aria-label":l.c,compressed:!0,"data-test-subj":u.a.CONVERSATIONS_MULTISELECTOR,isDisabled:t,fullWidth:!0,options:s,selectedOptions:c,onChange:m})}));c.displayName="ConversationMultiSelector";var d=n(4);const m=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),p=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.deletePromptTitle",{defaultMessage:"Delete System Prompt"}),f=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.customOptionText",{defaultMessage:"Create new System Prompt named"});var b={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},g={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},v={name:"qhxz92",styles:"max-width:100%"},y={name:"1e5733u",styles:"width:calc(100% - 60px)"};const h=i.a.memo((({autoFocus:e=!1,onSystemPromptDeleted:t,onSystemPromptSelectionChange:n,resetSettings:i,selectedSystemPrompt:s,systemPrompts:c})=>{const[d,h]=Object(a.useState)(c.map((e=>{var t,n;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t,isNewConversationDefault:null!==(n=e.isNewConversationDefault)&&void 0!==n&&n},label:e.name,id:e.id,"data-test-subj":`${u.a.SYSTEM_PROMPT_SELECTOR}-${e.id}`}}))),j=Object(a.useMemo)((()=>{var e,t;return s?[{value:{isDefault:null!==(e=s.isDefault)&&void 0!==e&&e,isNewConversationDefault:null!==(t=s.isNewConversationDefault)&&void 0!==t&&t},id:s.id,label:s.name}]:[]}),[s]),O=Object(a.useCallback)((e=>{var t,a;null==i||i();const r=0===e.length?void 0:null!==(t=c.find((t=>{var n;return t.name===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==t?t:null===(a=e[0])||void 0===a?void 0:a.label;n(r)}),[n,i,c]),E=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,id:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||h([...d,a]),O([a])}),[O,d]),x=Object(a.useCallback)((e=>{0===e.length?O([]):-1!==d.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&O(e)}),[O,d]),S=Object(a.useCallback)((e=>{var n,a;const i=null===(n=d.find((t=>t.label===e)))||void 0===n?void 0:n.id;h(d.filter((t=>t.label!==e))),(null==j||null===(a=j[0])||void 0===a?void 0:a.label)===e&&O([]),t(null!=i?i:e)}),[O,t,d,j]);return Object(o.jsx)(r.EuiComboBox,{"aria-label":m,className:"systemPromptSelector",compressed:!0,"data-test-subj":u.a.SYSTEM_PROMPT_SELECTOR,fullWidth:!0,placeholder:m,customOptionText:`${f} {searchValue}`,singleSelection:{asPlainText:!0},options:d,selectedOptions:j,onChange:x,onCreateOption:E,renderOption:(e,t)=>{const{label:n,value:a}=e;return Object(o.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":"systemPromptOptionSelector"},Object(o.jsx)(r.EuiFlexItem,{grow:!1,component:"span",css:y},Object(o.jsx)(r.EuiFlexGroup,{alignItems:"center",component:"span",gutterSize:"s"},Object(o.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:v},Object(o.jsx)(r.EuiHighlight,{search:t,css:g},n)),(null==a?void 0:a.isNewConversationDefault)&&Object(o.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(o.jsx)(r.EuiToolTip,{position:"right",content:l.e},Object(o.jsx)(r.EuiIcon,{type:"starFilled"}))))),!(null!=a&&a.isDefault)&&Object(o.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(o.jsx)(r.EuiToolTip,{position:"right",content:p},Object(o.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":p,color:"danger","data-test-subj":"delete-prompt",onClick:e=>{e.stopPropagation(),S(n)},css:b}))))},autoFocus:e})}));h.displayName="SystemPromptSelector";var j=n(1459),O=n(1460),E=n(756),x={name:"xpz1vu",styles:"min-height:150px"};const S=({connectors:e,conversationSettings:t,onSelectedSystemPromptChange:n,selectedSystemPrompt:d,setUpdatedSystemPromptSettings:m,setConversationSettings:p,systemPromptSettings:f,conversationsSettingsBulkActions:b,setConversationsSettingsBulkActions:g,defaultConnector:v,resetSettings:y,promptsBulkActions:S,setPromptsBulkActions:w})=>{const k=Object(a.useMemo)((()=>{var e,t;return null!==(e=null===(t=f.find((e=>e.id===(null==d?void 0:d.id))))||void 0===t?void 0:t.content)&&void 0!==e?e:""}),[null==d?void 0:d.id,f]),C=Object(a.useCallback)((e=>{if(null!=d&&(m((t=>t.some((e=>e.id===d.id))?t.map((t=>t.id===d.id?{...t,content:e.target.value}:t)):t)),f.find((e=>e.id===d.id)))){var t,n;const a={...S,...d.name!==d.id?{update:[...(null!==(t=S.update)&&void 0!==t?t:[]).filter((e=>e.id!==d.id)),{...d,content:e.target.value}]}:{create:[...(null!==(n=S.create)&&void 0!==n?n:[]).filter((e=>e.name!==d.name)),{...d,content:e.target.value}]}};w(a)}}),[S,d,w,m,f]),T=Object.entries(t).reduce(((t,[n,a])=>(t[n]={...a,...Object(E.b)({allSystemPrompts:f,connectors:e,conversation:a,defaultConnector:v})},t)),{}),M=Object(a.useMemo)((()=>Object.values(T)),[T]),I=Object(a.useMemo)((()=>null!=d?Object(j.a)(T,d.id):[]),[T,d]),_=Object(a.useCallback)((t=>{const n=t.map((e=>e.title)),a=e=>{var t;return n.includes(e.title)?null==d?void 0:d.id:e.apiConfig&&e.apiConfig.defaultSystemPromptId===(null==d?void 0:d.id)||null===(t=e.apiConfig)||void 0===t?void 0:t.defaultSystemPromptId};if(null!=d){p((e=>Object(s.keyBy)("title",Object.values(e).map((e=>{var t,n;return{...e,...e.apiConfig?{apiConfig:{...e.apiConfig,defaultSystemPromptId:a(e)}}:{apiConfig:{defaultSystemPromptId:a(e),connectorId:null!==(t=null==v?void 0:v.id)&&void 0!==t?t:"",actionTypeId:null!==(n=null==v?void 0:v.actionTypeId)&&void 0!==n?n:""}}}})))));let t={...b};Object.values(T).forEach((n=>{var i,r,s;const o=()=>{var t,i;return n.apiConfig?{apiConfig:{...Object(E.b)({allSystemPrompts:f,connectors:e,conversation:n,defaultConnector:v}).apiConfig,defaultSystemPromptId:null!==(t=a(n))&&void 0!==t?t:null===(i=Object(E.e)({allSystemPrompts:f}))||void 0===i?void 0:i.id}}:{}},l=""===n.id?{create:{...null!==(i=t.create)&&void 0!==i?i:{},[n.title]:{...n,...n.apiConfig?o():{}}}}:{},u=""!==n.id?{update:{...null!==(r=t.update)&&void 0!==r?r:{},[n.id]:{...t.update&&null!==(s=t.update[n.id])&&void 0!==s?s:{},...o()}}}:{};t={...t,...l,...u}})),g(t)}}),[e,b,T,v,d,p,g,f]),A=Object(a.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d.isNewConversationDefault)&&void 0!==e&&e}),[null==d?void 0:d.isNewConversationDefault]),P=Object(a.useCallback)((e=>{const t=e.target.checked,n=f.filter((e=>e.isNewConversationDefault)),a=(null==d?void 0:d.name)===(null==d?void 0:d.id),i=(null==d?void 0:d.name)!==(null==d?void 0:d.id);null!=d&&(m((e=>e.map((e=>({...e,isNewConversationDefault:d.id===e.id&&t}))))),w((()=>({update:[...n.filter((e=>{return e.id!==d.id&&(null==(t=e)?void 0:t.name)!==(null==t?void 0:t.id);var t})).map((e=>({...e,isNewConversationDefault:!1}))),...i?[{...d,isNewConversationDefault:t}]:[]],create:[...n.filter((e=>{return e.name!==d.name&&(null==(t=e)?void 0:t.name)===(null==t?void 0:t.id);var t})).map((e=>({...e,isNewConversationDefault:!1}))),...a?[{...d,isNewConversationDefault:t}]:[]]}))))}),[d,w,m,f]),{onSystemPromptSelectionChange:D,onSystemPromptDeleted:F}=Object(O.a)({setUpdatedSystemPromptSettings:m,onSelectedSystemPromptChange:n,promptsBulkActions:S,setPromptsBulkActions:w});return Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)(r.EuiFormRow,{display:"rowCompressed",label:l.f,fullWidth:!0},Object(o.jsx)(h,{onSystemPromptDeleted:F,onSystemPromptSelectionChange:D,selectedSystemPrompt:d,resetSettings:y,systemPrompts:f})),Object(o.jsx)(r.EuiFormRow,{display:"rowCompressed",label:l.g,fullWidth:!0},Object(o.jsx)(r.EuiTextArea,{"data-test-subj":u.a.SYSTEM_PROMPT_MODAL.PROMPT_TEXT,disabled:null==d,onChange:C,placeholder:l.h,value:k,compressed:!0,fullWidth:!0,css:x})),Object(o.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,helpText:l.d,label:l.c},Object(o.jsx)(c,{conversations:M,isDisabled:null==d,onConversationSelectionChange:_,selectedConversations:I})),Object(o.jsx)(r.EuiFormRow,{display:"rowCompressed"},Object(o.jsx)(r.EuiCheckbox,{"data-test-subj":u.a.SYSTEM_PROMPT_MODAL.TOGGLE_ALL_DEFAULT_CONVERSATIONS,disabled:null==d,id:"defaultNewConversation",label:Object(o.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(o.jsx)(r.EuiFlexItem,null,l.e),Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiIcon,{type:A?"starFilled":"starEmpty"}))),checked:A,onChange:P})))},w=i.a.memo(S);w.displayName="SystemPromptEditor"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(45),s=n(1426),o=n(532),l=n(249),u=n(138),c=n(917),d=n(585);const m=({filters:e,headerChildren:t,onlyField:n,paddingSize:m,setAbsoluteRangeDatePickerTarget:p=u.a.global,hideQueryToggle:f=!1})=>{const b=Object(r.useDispatch)(),{signalIndexName:g}=Object(o.a)(),v=(y=e,Object(a.useMemo)((()=>[...y,...Object(d.e)(!1)]),[y]));var y;const h=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;b(Object(l.setAbsoluteRangeDatePicker)({id:p,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[b,p]);return i.a.createElement(s.a,{filters:v,headerChildren:t,onlyField:n,paddingSize:m,showLinkToAlerts:null==n,showStackBy:null==n,showTotalAlertsCount:!0,signalIndexName:g,title:c.b,titleSize:null==n?"m":"s",updateDateRange:h,hideQueryToggle:f})};m.displayName="SignalsByCategoryComponent";const p=i.a.memo(m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(19),i=n(2),r=n.n(i),s=n(42),o=n(97),l=n(44),u=n(1384),c=n(4);const d=c.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.placeholderText",{defaultMessage:"Select or type to create new..."}),m=c.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.modelTitle",{defaultMessage:"Model"}),p=c.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.helpLabel",{defaultMessage:"Model to use for this connector"}),f=c.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.customOptionText",{defaultMessage:"Create new Model named"});var b=n(1362),g=n(1487),v=n(43);const y=["gpt-4o","gpt-4-turbo","gpt-4o-mini"],h=r.a.memo((({models:e=y,onModelSelectionChange:t,selectedModel:n=y[0]})=>{const[r,s]=Object(i.useState)(e.map((e=>({"data-test-subj":e,label:e})))),o=Object(i.useMemo)((()=>n?[{label:n}]:[]),[n]),l=Object(i.useCallback)((n=>{var a,i;const r=0===n.length?void 0:null!==(a=e.find((e=>{var t;return e===(null===(t=n[0])||void 0===t?void 0:t.label)})))&&void 0!==a?a:null===(i=n[0])||void 0===i?void 0:i.label;null==t||t(r)}),[t,e]),u=Object(i.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||s([...r,a]),l([a])}),[l,r]),c=Object(i.useCallback)((e=>{0===e.length?l([]):-1!==r.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&l(e)}),[l,r]);return Object(v.jsx)(a.EuiComboBox,{"aria-label":p,compressed:!0,"data-test-subj":"model-selector",isClearable:!1,placeholder:d,customOptionText:`${f} {searchValue}`,singleSelection:{asPlainText:!0},options:r,selectedOptions:o,onChange:c,onCreateOption:u,fullWidth:!0})}));h.displayName="ModelSelector";var j=n(755),O=n(578),E=n(756);const x=r.a.memo((({allSystemPrompts:e,selectedConversation:t,conversationSettings:n,http:c,isDisabled:d=!1,setConversationSettings:f,conversationsSettingsBulkActions:y,setConversationsSettingsBulkActions:x,onSelectedConversationChange:S,refetchConversations:w})=>{var k,C,T;const{data:M,isSuccess:I}=Object(j.a)({http:c}),_=Object(i.useMemo)((()=>Object(E.d)({allSystemPrompts:e,conversation:t})),[e,t]),A=Object(i.useCallback)((e=>{if(null!=t&&t.apiConfig){const l={...t,apiConfig:{...t.apiConfig,defaultSystemPromptId:e}};if(f({...n,[l.id||l.title]:l}),""!==t.id){var a,i,r,s;x({...y,update:{...null!==(a=y.update)&&void 0!==a?a:{},[l.id]:{...l,...y.update&&null!==(i=y.update[l.id])&&void 0!==i?i:{},apiConfig:{...l.apiConfig,...null!==(r=(y.update&&null!==(s=y.update[l.id])&&void 0!==s?s:{}).apiConfig)&&void 0!==r?r:{},defaultSystemPromptId:e}}}})}else{var o;const e={...y,create:{...null!==(o=y.create)&&void 0!==o?o:{},[l.title]:l}};x(e)}}}),[n,y,t,f,x]),P=Object(i.useMemo)((()=>{var e;const n=null==t||null===(e=t.apiConfig)||void 0===e?void 0:e.connectorId;if(I)return null==M?void 0:M.find((e=>e.id===n))}),[I,M,null==t||null===(k=t.apiConfig)||void 0===k?void 0:k.connectorId]),D=Object(i.useMemo)((()=>{var e;return null==t||null===(e=t.apiConfig)||void 0===e?void 0:e.provider}),[null==t||null===(C=t.apiConfig)||void 0===C?void 0:C.provider]),F=Object(i.useMemo)((()=>""===(null==t?void 0:t.id)?t.title:null==t?void 0:t.id),[t]),R=Object(i.useCallback)((e=>{if(null!=t){const l=Object(O.c)(e),u={...t,apiConfig:{...t.apiConfig,connectorId:e.id,actionTypeId:e.actionTypeId,provider:null==l?void 0:l.apiProvider,model:null==l?void 0:l.defaultModel}};if(f({...n,[F]:u}),""!==t.id){var a,i,r,s;x({...y,update:{...null!==(a=y.update)&&void 0!==a?a:{},[u.id||u.title]:{...u,...y.update&&null!==(i=y.update[u.id])&&void 0!==i?i:{},apiConfig:{...u.apiConfig,...null!==(r=(y.update&&null!==(s=y.update[u.id])&&void 0!==s?s:{}).apiConfig)&&void 0!==r?r:{},connectorId:null==e?void 0:e.id,actionTypeId:null==e?void 0:e.actionTypeId,provider:null==l?void 0:l.apiProvider,model:null==l?void 0:l.defaultModel}}}})}else{var o;const e={...y,create:{...null!==(o=y.create)&&void 0!==o?o:{},[u.title||u.id]:u}};x(e)}}}),[n,y,t,F,f,x]),N=Object(i.useMemo)((()=>{var e,n,a;const i=null===(e=Object(O.c)(P))||void 0===e?void 0:e.defaultModel;return null!==(n=null==t||null===(a=t.apiConfig)||void 0===a?void 0:a.model)&&void 0!==n?n:i}),[P,null==t||null===(T=t.apiConfig)||void 0===T?void 0:T.model]),z=Object(i.useCallback)((e=>{if(null!=t&&t.apiConfig){const l={...t,apiConfig:{...t.apiConfig,model:e}};if(f({...n,[l.id||l.title]:l}),""!==t.id){var a,i,r,s;x({...y,update:{...null!==(a=y.update)&&void 0!==a?a:{},[l.id]:{...l,...y.update&&null!==(i=y.update[l.id])&&void 0!==i?i:{},apiConfig:{...l.apiConfig,...null!==(r=(y.update&&null!==(s=y.update[l.id])&&void 0!==s?s:{}).apiConfig)&&void 0!==r?r:{},model:e}}}})}else{var o;const e={...y,create:{...null!==(o=y.create)&&void 0!==o?o:{},[l.id||l.title]:l}};x(e)}}}),[n,y,t,f,x]);return Object(v.jsx)(r.a.Fragment,null,Object(v.jsx)(a.EuiFormRow,{"data-test-subj":"prompt-field",display:"rowCompressed",fullWidth:!0,label:u.f,helpText:u.e},Object(v.jsx)(g.a,{allPrompts:e,compressed:!0,conversation:t,isDisabled:d,onSystemPromptSelectionChange:A,refetchConversations:w,selectedPrompt:_,isSettingsModalVisible:!0,setIsSettingsModalVisible:l.noop,onSelectedConversationChange:S,setConversationSettings:f,setConversationsSettingsBulkActions:x})),Object(v.jsx)(a.EuiFormRow,{"data-test-subj":"connector-field",display:"rowCompressed",label:u.a,helpText:Object(v.jsx)(a.EuiLink,{href:`${c.basePath.get()}/app/management/insightsAndAlerting/triggersActionsConnectors/connectors`,target:"_blank",external:!0},Object(v.jsx)(s.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.connectorHelpTextTitle",defaultMessage:"The default LLM connector for this conversation type."}))},Object(v.jsx)(b.a,{isDisabled:d,onConnectorSelectionChange:R,selectedConnectorId:null==P?void 0:P.id})),!1===(null==P?void 0:P.isPreconfigured)&&D===o.OpenAiProviderType.OpenAi&&Object(v.jsx)(a.EuiFormRow,{"data-test-subj":"model-field",display:"rowCompressed",label:m,helpText:p},Object(v.jsx)(h,{onModelSelectionChange:z,selectedModel:N})))}));x.displayName="ConversationSettingsEditor"},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));var a=n(119),i=n.n(a),r=n(2),s=n.n(r),o=n(48);const l={services:{}},u=Object(r.createContext)(l);var c=n(809),d=n.n(c),m=n(43);const p=({children:e,component:t,render:n,...a})=>{const l=Object(r.useMemo)((()=>{if(t)return e=>Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(f,null),Object(m.jsx)(t,e))}),[t]);if(l)return Object(m.jsx)(o.Route,i()({},a,{component:l}));if(n||"function"==typeof e){const t="function"==typeof e?e:n;return Object(m.jsx)(o.Route,i()({},a,{render:e=>Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(f,null),t(e))}))}return Object(m.jsx)(o.Route,a,Object(m.jsx)(f,null),e)},f=()=>{const{executionContext:e}=Object(r.useContext)(u).services,t=Object(o.useRouteMatch)();return function(e,t){d()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(19),i=n(2),r=n.n(i),s=n(152),o=n(49),l=n(1362),u=n(241),c=n(812),d=n(578),m=n(43);const p=Object(s.css)({name:"o1fq1c",styles:"height:32px;.euiSuperSelectControl{border:none;box-shadow:none;background:none;padding-left:0;}.euiFormControlLayoutIcons{right:14px;top:2px;}"}),f=Object(s.css)({name:"1v31jro",styles:"margin-right:8px;overflow:hidden;text-overflow:ellipsis"}),b=r.a.memo((({isDisabled:e=!1,selectedConnectorId:t,selectedConversation:n,onConnectorIdSelected:r,onConnectorSelected:s,stats:b=null})=>{const[g,v]=Object(i.useState)(!1),{assistantAvailability:y}=Object(u.b)(),{setApiConfig:h}=Object(c.a)(),j=e||!y.hasConnectorsReadPrivilege,O=Object(i.useCallback)((async e=>{const t=e.id;if("ADD_NEW_CONNECTOR"===t)return;const a=Object(d.c)(e),i=null==a?void 0:a.apiProvider,o=null==a?void 0:a.defaultModel;if(v(!1),null!=n){const a=await h({conversation:n,apiConfig:{...n.apiConfig,actionTypeId:e.actionTypeId,connectorId:t,provider:i,model:o}});a&&null!=s&&s(a)}null!=r&&r(t)}),[n,h,r,s]);return Object(m.jsx)(a.EuiFlexGroup,{alignItems:"center",className:p,direction:"row",gutterSize:"xs",justifyContent:"flexStart",responsive:!1},Object(m.jsx)(a.EuiFlexItem,null,Object(m.jsx)(l.a,{displayFancy:e=>Object(m.jsx)(a.EuiText,{className:f,size:"s",color:o.euiThemeVars.euiColorPrimaryText},e),isOpen:g,isDisabled:j,selectedConnectorId:t,setIsOpen:v,onConnectorSelectionChange:O,stats:b})))}));b.displayName="ConnectorSelectorInline"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(19),s=n(4);const o=s.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeTitle",{defaultMessage:"Manage license"}),l=s.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeButtonLabel",{defaultMessage:"Subscription plans"});var u=n(43);const c=({basePath:e})=>Object(u.jsx)(r.EuiFlexGroup,{gutterSize:"s",wrap:!0,"data-test-subj":"upgrade-buttons",justifyContent:"spaceAround"},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},l)),Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiButton,{href:`${e}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},o))),d=i.a.memo(c);d.displayName="UpgradeButtons"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var a=n(2),i=n(48),r=n(118);const s=()=>{const{pathname:t}=Object(i.useLocation)(),{executionContext:n}=Object(r.j)().services;Object(a.useEffect)((()=>{e((()=>{n.set({page:t})}))}),[t,n])}}).call(this,n(1536).setImmediate)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(7),i=n(2),r=n.n(i),s=n(48),o=n(98),l=n(1617),u=n(43);const c=({legacySwitch:e=!0,children:t})=>{const n=Object(s.useRouteMatch)();return e?Object(u.jsx)(s.Switch,null,t):Object(u.jsx)(o.Routes,null,i.Children.map(t,(e=>{if(r.a.isValidElement(e)&&e.type===l.b){var i;const s=Object(a.replace)(null==e?void 0:e.props.path,n.url+"/",""),c="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(u.jsx)(o.Route,{path:s,element:Object(u.jsx)(r.a.Fragment,null,Object(u.jsx)(l.a,null),(null==e||null===(i=e.props)||void 0===i?void 0:i.component)&&Object(u.jsx)(e.props.component,null)||c&&c()||t)})}return e})))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return de}));var a=n(2),i=n.n(a),r=n(19),s=n(43),o=n(42),l=n(4);l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsTitle",{defaultMessage:"Evaluation"});const u=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsDescription",{defaultMessage:"Run predictions and evaluations against test data sets using different models (connectors), agents, and evaluation schemes."}),c=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsTitle",{defaultMessage:"Run Details"}),d=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsDescription",{defaultMessage:"Configure test run details like project, run name, dataset, and output index."}),m=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsTitle",{defaultMessage:"Predictions"}),p=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsDescription",{defaultMessage:"Choose models (connectors) and corresponding agents the dataset should run against."}),f=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsTitle",{defaultMessage:"Evaluation (Optional)"}),b=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsDescription",{defaultMessage:"Evaluate prediction results using a specific model (connector) and evaluation criterion."}),g=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectLabel",{defaultMessage:"Project"}),v=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectDescription",{defaultMessage:"LangSmith project to write results to."}),y=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectPlaceholder",{defaultMessage:"8.12 Testing"}),h=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameLabel",{defaultMessage:"Run name"}),j=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameDescription",{defaultMessage:"Name for this specific test run."}),O=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNamePlaceholder",{defaultMessage:"8.12 ESQL Query Generation"}),E=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsLabel",{defaultMessage:"Connectors / Models"}),x=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsDescription",{defaultMessage:"Select models to evaluate the dataset against."}),S=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsLabel",{defaultMessage:"Agents"}),w=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsDescription",{defaultMessage:"Select the agents (RAG algorithms) to evaluate the dataset against."}),k=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelLabel",{defaultMessage:"Evaluator Model"}),C=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelDescription",{defaultMessage:"Model that performs the final evaluation."}),T=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeLabel",{defaultMessage:"Evaluation type"}),M=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeDescription",{defaultMessage:'Type of evaluation to perform, e.g. "correctness" "esql-validator", or "custom".'}),I=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptLabel",{defaultMessage:"Evaluation prompt"}),_=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptDescription",{defaultMessage:"Prompt template given `input`, `reference` and `prediction` template variables."}),A=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexLabel",{defaultMessage:"Output index"}),P=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexDescription",{defaultMessage:'Index to write results to. Must be prefixed with ".kibana-elastic-ai-assistant-".'}),D=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.showTraceOptionsLabel",{defaultMessage:"Show Trace Options (for internal use only)"}),F=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.apmUrlLabel",{defaultMessage:"APM URL"}),R=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.apmUrlDescription",{defaultMessage:'URL for the Kibana APM app. Used to link to APM traces for evaluation results. Defaults to "{defaultUrlPath}".',values:{defaultUrlPath:"${basePath}/app/apm"}}),N=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithProjectLabel",{defaultMessage:"LangSmith Project"}),z=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithProjectDescription",{defaultMessage:"LangSmith Project to write traces to."}),L=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithApiKeyLabel",{defaultMessage:"LangSmith API Key"}),B=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithApiKeyDescription",{defaultMessage:"API Key for writing traces to LangSmith. Stored in Session Storage. Close tab to clear session."}),q=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorDatasetLabel",{defaultMessage:"Dataset"}),V=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetLabel",{defaultMessage:"LangSmith"}),$=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetDescription",{defaultMessage:"Name of dataset hosted on LangSmith to evaluate."}),U=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetPlaceholder",{defaultMessage:"ESQL Query Generation"}),G=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetLabel",{defaultMessage:"Custom"}),H=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetDescription",{defaultMessage:'Custom dataset to evaluate. Array of objects with "input" and "references" properties.'}),Q=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.performEvaluationTitle",{defaultMessage:"Perform evaluation..."}),W=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactDiscoverLinkText",{defaultMessage:"Discover"}),K=l.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactApmLinkText",{defaultMessage:"APM"});var J=n(241),Y=n(755),X=n(578),Z=n(577),ee=n(47),te=n(2080);const ne=["elastic-assistant","perform-evaluation"],ae=["elastic-assistant","evaluation-data"],ie=[{label:"correctness"},{label:"esql-validator",disabled:!0},{label:"custom",disabled:!0}];var re={name:"1sl5m7u",styles:"min-height:330px"},se={name:"yz1nei",styles:"margin-top:16px"},oe={name:"yz1nei",styles:"margin-top:16px"},le={name:"vc763q",styles:"min-height:300px"},ue={name:"1bs7qd7",styles:"&:hover{text-decoration:none;}"},ce={name:"yz1nei",styles:"margin-top:16px"};const de=i.a.memo((()=>{var e,t;const{actionTypeRegistry:n,basePath:de,http:me,setTraceOptions:pe,traceOptions:fe}=Object(J.b)(),{data:be}=Object(Y.a)({http:me}),{data:ge,mutate:ve,isLoading:ye}=(({http:e,toasts:t})=>Object(ee.useMutation)(ne,(t=>(async({http:e,evalParams:t,signal:n})=>{try{var a,i,r,s,o,l;const u="/internal/elastic_assistant/evaluate",c={agents:null==t||null===(a=t.agents.sort())||void 0===a?void 0:a.join(","),datasetName:null==t?void 0:t.datasetName,evaluationType:null==t||null===(i=t.evaluationType.sort())||void 0===i?void 0:i.join(","),evalModel:null==t||null===(r=t.evalModel.sort())||void 0===r?void 0:r.join(","),outputIndex:null==t?void 0:t.outputIndex,models:null==t||null===(s=t.models.sort())||void 0===s?void 0:s.join(","),projectName:null==t?void 0:t.projectName,runName:null==t?void 0:t.runName};return await e.post(u,{body:JSON.stringify({dataset:JSON.parse(null!==(o=null==t?void 0:t.dataset)&&void 0!==o?o:"[]"),evalPrompt:null!==(l=null==t?void 0:t.evalPrompt)&&void 0!==l?l:""}),headers:{"Content-Type":"application/json"},query:c,signal:n,version:te.a.internal.v1})}catch(e){return e}})({http:e,evalParams:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:l.i18n.translate("xpack.elasticAssistant.evaluation.evaluationError",{defaultMessage:"Error performing evaluation..."})}))}}))({http:me}),{data:he}=(({http:e,toasts:t})=>Object(ee.useQuery)({queryKey:ae,queryFn:({signal:t})=>(async({http:e,signal:t})=>{try{const n="/internal/elastic_assistant/evaluate";return await e.get(n,{signal:t,version:te.a.internal.v1})}catch(e){return e}})({http:e,signal:t}),retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:l.i18n.translate("xpack.elasticAssistant.evaluation.fetchEvaluationDataError",{defaultMessage:"Error fetching evaluation data..."})}))}}))({http:me}),je=Object(a.useMemo)((()=>{var e;return null!==(e=null==he?void 0:he.agentExecutors)&&void 0!==e?e:[]}),[he]),[Oe,Ee]=Object(a.useState)(),xe=Object(a.useCallback)((e=>{Ee(e.target.value)}),[Ee]),[Se,we]=Object(a.useState)(),ke=Object(a.useCallback)((e=>{we(e.target.value)}),[we]),[Ce,Te]=Object(a.useState)(".kibana-elastic-ai-assistant-evaluation-results"),Me=Object(a.useCallback)((e=>{Te(e.target.value)}),[Te]),[Ie,_e]=Object(a.useState)(!1),Ae=Object(a.useCallback)((e=>{pe({...fe,apmUrl:e.target.value})}),[pe,fe]),Pe=Object(a.useCallback)((e=>{pe({...fe,langSmithProject:e.target.value})}),[pe,fe]),De=Object(a.useCallback)((e=>{pe({...fe,langSmithApiKey:e.target.value})}),[pe,fe]),[Fe,Re]=Object(a.useState)(!0),Ne=Object(a.useMemo)((()=>Object(s.jsx)(r.EuiText,{size:"xs",css:ce},q," (",Object(s.jsx)(r.EuiLink,{color:Fe?"primary":"text",onClick:()=>Re(!0)},V)," / ",Object(s.jsx)(r.EuiLink,{color:Fe?"text":"primary",onClick:()=>Re(!1)},G),")")),[Fe]),[ze,Le]=Object(a.useState)(),Be=Object(a.useCallback)((e=>{Le(e.target.value)}),[Le]),[qe,Ve]=Object(a.useState)(JSON.stringify([{input:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, and really make sure you check your knowledge really well on all the functions I am asking for. check it multiple times if you need to. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema. Ensure the answers are formatted in a way which is easily copyable.\n\nWrite an ESQL query for detecting cryptomining activity on an AWS EC2 instance.",reference:'FROM metrics-apm*\n| WHERE metricset.name == ""transaction"" AND metricset.interval == ""1m""\n| EVAL bucket = AUTO_BUCKET(transaction.duration.histogram, 50, <start-date>, <end-date>)\n| STATS avg_duration = AVG(transaction.duration.histogram) BY bucket'}],null,2)),$e=Object(a.useCallback)((e=>{Ve(e.target.value)}),[Ve]),[Ue,Ge]=Object(a.useState)([]),He=Object(a.useCallback)((e=>{Ge(e)}),[Ge]),Qe=Object(r.euiPaletteComplementary)(null!==(e=null==be?void 0:be.length)&&void 0!==e?e:0),We=Object(a.useMemo)((()=>{var e;return null!==(e=null==be?void 0:be.map(((e,t)=>{var a;const i=null===(a=Object(X.c)(e))||void 0===a?void 0:a.apiProvider,r=null!=i?i:Object(X.a)(n.get(e.actionTypeId)),s=e.isPreconfigured?Z.m:r;return{key:e.id,label:`${e.name} (${s})`,color:Qe[t]}})))&&void 0!==e?e:[]}),[n,be,Qe]),[Ke,Je]=Object(a.useState)([]),Ye=Object(a.useCallback)((e=>{Je(e)}),[Je]),Xe=Object(a.useCallback)((e=>{const t=e.trim();t&&Je([...Ke,{label:t}])}),[Ke]),Ze=Object(a.useMemo)((()=>je.map((e=>({label:e})))),[je]),[et,tt]=Object(a.useState)([]),nt=Object(a.useCallback)((e=>{tt(e)}),[tt]),at=Object(a.useCallback)((e=>{const t=e.trim();t&&tt([{label:t}])}),[tt]),it=Object(a.useMemo)((()=>ie),[]),[rt,st]=Object(a.useState)([]),ot=Object(a.useCallback)((e=>{st(e)}),[st]),[lt,ut]=Object(a.useState)("For the below input: \n\n{{input}} \n\na prediction: \n\n{{prediction}} \n\nwas made. How's it stack up against this reference: \n\n{{reference}} \n\nReturn output in a succinct sentence ranking on a simple grading rubric focused on correctness."),ct=Object(a.useCallback)((e=>{ut(e.target.value)}),[ut]),dt=0===Ue.length||0===Ke.length||0===Ce.length,mt=Object(a.useCallback)((async()=>{const e={models:Ue.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),agents:Ke.map((e=>e.label)),dataset:Fe?void 0:qe,datasetName:Fe?ze:void 0,evalModel:rt.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),evalPrompt:lt,evaluationType:et.map((e=>e.label)),outputIndex:Ce,projectName:Oe,runName:Se};ve(e)}),[ze,qe,lt,Ce,ve,Oe,Se,Ke,et,rt,Ue,Fe]),pt=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-1y%2Fd,to:now))&_a=(columns:!(evaluationId,runName,totalAgents,totalInput,totalRequests,input,reference,prediction,evaluation.value,evaluation.reasoning,connectorName,connectorName.keyword,evaluation.__run.runId,evaluation.__run.runId.keyword,evaluation.score,evaluationEnd,evaluationId.keyword,evaluationStart,input.keyword,inputExampleId,inputExampleId.keyword,evaluationDuration,prediction.keyword,predictionResponse.reason.sendToLLM,predictionResponse.status,ConnectorId,predictionResponse.value.data,predictionResponse.value.data.keyword,predictionResponse.value.status,predictionResponse.value.trace_data.trace_id,predictionResponse.value.trace_data.trace_id.keyword,predictionResponse.value.trace_data.transaction_id,predictionResponse.value.trace_data.transaction_id.keyword,reference.keyword,runName.keyword),filters:!(),grid:(columns:('@timestamp':(width:212),ConnectorId:(width:133),connectorName:(width:181),connectorName.keyword:(width:229),evaluation.__run.runId:(width:282),evaluation.__run.runId.keyword:(width:245),evaluation.reasoning:(width:336),evaluation.reasoning.keyword:(width:232),evaluation.score:(width:209),evaluation.value:(width:156),evaluationDuration:(width:174),evaluationEnd:(width:151),evaluationId:(width:130),evaluationId.keyword:(width:186),evaluationStart:(width:202),input:(width:347),input.keyword:(width:458),prediction:(width:264),prediction.keyword:(width:313),predictionResponse.value.connector_id:(width:294),predictionResponse.value.trace_data.trace_id:(width:278),predictionResponse.value.trace_data.transaction_id.keyword:(width:177),reference:(width:305),reference.keyword:(width:219),runName:(width:405),totalAgents:(width:125),totalInput:(width:111),totalRequests:(width:138))),hideChart:!t,index:ce1b41cb-6298-4612-a33c-ba85b3c18ec7,interval:auto,query:(esql:'from%20.kibana-elastic-ai-assistant-evaluation-results%20%0A%7C%20keep%20@timestamp,%20evaluationId,%20runName,%20totalAgents,%20totalInput,%20totalRequests,%20input,%20reference,%20prediction,%20evaluation.value,%20evaluation.reasoning,%20connectorName,%20*%0A%7C%20drop%20evaluation.reasoning.keyword%0A%7C%20rename%20predictionResponse.value.connector_id%20as%20ConnectorId%0A%7C%20where%20evaluationId%20%3D%3D%20%22${t}%22%0A%7C%20sort%20@timestamp%20desc%0A%7C%20limit%20100%0A%0A%0A'),rowHeight:15,sort:!(!('@timestamp',desc)))`)(de,null!==(e=null==ge?void 0:ge.evaluationId)&&void 0!==e?e:"")}),[de,ge]),ft=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/apm/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=%22labels.evaluationId%22:%20%22${t}%22&rangeFrom=now-1y&rangeTo=now&showCriticalPath=false&traceId=451662121b1f5e6c44084ad7415b9409&transactionId=5f1392fa04766025&type=kql&waterfallItemId=`)(de,null!==(e=null==ge?void 0:ge.evaluationId)&&void 0!==e?e:"")}),[de,ge]),bt=(e,t)=>Object(s.jsx)("div",null,Object(s.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(s.jsx)(r.EuiFlexItem,null,Object(s.jsx)(r.EuiTitle,{size:"xs"},Object(s.jsx)("h3",null,e)))),Object(s.jsx)(r.EuiText,{size:"s"},Object(s.jsx)("p",null,Object(s.jsx)(r.EuiTextColor,{color:"subdued"},t)))),gt=Object(a.useMemo)((()=>bt(c,d)),[]),vt=Object(a.useMemo)((()=>bt(m,p)),[]),yt=Object(a.useMemo)((()=>bt(f,b)),[]),ht=ue;return Object(s.jsx)(r.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(s.jsx)(r.EuiText,{size:"m"},u),Object(s.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(s.jsx)(r.EuiAccordion,{id:c,arrowDisplay:"right",buttonContent:gt,buttonProps:{paddingSize:"s",css:ht},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(s.jsx)(r.EuiFlexGroup,null,Object(s.jsx)(r.EuiFlexItem,null,Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:g,helpText:v},Object(s.jsx)(r.EuiFieldText,{"aria-label":"project-textfield",compressed:!0,onChange:xe,placeholder:y,value:Oe}))),Object(s.jsx)(r.EuiFlexItem,null,Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:h,helpText:j},Object(s.jsx)(r.EuiFieldText,{"aria-label":"run-name-textfield",compressed:!0,onChange:ke,placeholder:O,value:Se})))),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:Ne,fullWidth:!0,helpText:Fe?$:H},Fe?Object(s.jsx)(r.EuiFieldText,{"aria-label":"dataset-name-textfield",compressed:!0,onChange:Be,placeholder:U,value:ze}):Object(s.jsx)(r.EuiTextArea,{"aria-label":"evaluation-dataset-textarea",compressed:!0,css:le,fullWidth:!0,onChange:$e,value:qe})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:A,fullWidth:!0,helpText:P},Object(s.jsx)(r.EuiFieldText,{value:Ce,onChange:Me,"aria-label":"evaluation-output-index-textfield"})),Object(s.jsx)(r.EuiText,{size:"xs",css:oe},Object(s.jsx)(r.EuiLink,{color:"primary",onClick:()=>_e(!Ie)},D)),Ie&&Object(s.jsx)(i.a.Fragment,null,Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:F,fullWidth:!0,helpText:R,css:se},Object(s.jsx)(r.EuiFieldText,{value:fe.apmUrl,onChange:Ae,"aria-label":"apm-url-textfield"})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:N,fullWidth:!0,helpText:z},Object(s.jsx)(r.EuiFieldText,{value:fe.langSmithProject,onChange:Pe,"aria-label":"langsmith-project-textfield"})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:L,fullWidth:!0,helpText:B},Object(s.jsx)(r.EuiFieldText,{value:fe.langSmithApiKey,onChange:De,"aria-label":"langsmith-api-key-textfield"})))),Object(s.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(s.jsx)(r.EuiAccordion,{id:m,arrowDisplay:"right",buttonContent:vt,buttonProps:{paddingSize:"s",css:ht},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:E,helpText:x},Object(s.jsx)(r.EuiComboBox,{"aria-label":"model-selector",compressed:!0,options:We,selectedOptions:Ue,onChange:He})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:S,helpText:w},Object(s.jsx)(r.EuiComboBox,{"aria-label":"agent-selector",compressed:!0,onCreateOption:Xe,options:Ze,selectedOptions:Ke,onChange:Ye}))),Object(s.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(s.jsx)(r.EuiAccordion,{id:f,arrowDisplay:"right",element:"fieldset",buttonProps:{paddingSize:"s",css:ht},buttonContent:yt,paddingSize:"s"},Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:k,helpText:C},Object(s.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,options:We,selectedOptions:rt,singleSelection:{asPlainText:!0},onChange:ot})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:T,helpText:M},Object(s.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,onChange:nt,onCreateOption:at,options:it,selectedOptions:et,singleSelection:{asPlainText:!0}})),Object(s.jsx)(r.EuiFormRow,{display:"rowCompressed",label:I,fullWidth:!0,helpText:_},Object(s.jsx)(r.EuiTextArea,{"aria-label":"evaluation-prompt-textarea",compressed:!0,css:re,disabled:"custom"!==(null===(t=et[0])||void 0===t?void 0:t.label),fullWidth:!0,onChange:ct,value:lt}))),Object(s.jsx)(r.EuiHorizontalRule,null),Object(s.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(r.EuiButton,{size:"s",type:"submit",isDisabled:dt,isLoading:ye,onClick:mt,fill:!0},Q)),Object(s.jsx)(r.EuiFlexItem,null,Object(s.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(s.jsx)(o.FormattedMessage,{defaultMessage:"Closing this dialog will cancel the evaluation. You can watch the Kibana server logs for progress, and view results in {discover} {apm}. Can take many minutes for large datasets.",id:"xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactText",values:{discover:Object(s.jsx)(r.EuiLink,{external:!0,href:pt,target:"_blank"},W),apm:Object(s.jsx)(r.EuiLink,{external:!0,href:ft,target:"_blank"},K)}})))),Object(s.jsx)(r.EuiSpacer,{size:"s"}))}));de.displayName="EvaluationSettings"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"renderApp",(function(){return fo})),n.d(t,"createStoreFactory",(function(){return bo.a}));var a=n(2),i=n.n(a),r=n(66),s=n(45),o=n(953),l=n(59),u=n(360),c=n(1267),d=n(452),m=n(270),p=n(5),f=n(124),b=n(148),g=n(260),v=n(1202);const y=({toastLifeTimeMs:e=5e3})=>{const t=Object(s.useDispatch)(),n=Object(a.useMemo)((()=>b.a.errorsSelector()),[]),i=Object(f.a)(n),[{toasts:r},o]=Object(v.f)();return Object(a.useEffect)((()=>{i.forEach((({id:n,title:a,message:i})=>{r.some((e=>e.id===n))||o({type:"addToaster",toast:{color:"danger",id:n,iconType:"error",title:a,errors:i,toastLifeTimeMs:e}}),t(g.a.removeError({id:n}))}))}),[t,o,i,e,r]),null};y.displayName="ErrorToastDispatcherComponent";const h=i.a.memo(y);var j=n(956),O=n(118),E=n(48),x=n(98),S=n(43);const w=({children:e,...t})=>Object(S.jsx)(E.Router,t,Object(S.jsx)(x.CompatRouter,null,e));var k=n(1868),C=n(1617),T=n(554),M=n(894);const I=({children:e})=>i.a.createElement(M.a.Provider,{value:Object(a.useReducer)(((e,t)=>{switch(t.type){case"updateRoute":return t.route;case"updateRouteWithOutSearch":return{...e,...t.route};case"updateSearch":return{...e,search:t.search};default:return e}}),M.b)},e),_=Object(a.memo)(I);var A=n(555),P=n(44),D=n(75),F=n(188),R=n.n(F),N=n(128),z=n(129),L=n(706),B=n(4);B.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.indexPatternFetchFailureTitle",{defaultMessage:"Index pattern fetch failure"}),B.i18n.translate("xpack.securitySolution.components.hooks.eql.partialResponse",{defaultMessage:"EQL Preview Error"}),B.i18n.translate("xpack.securitySolution.components.hooks.errors.timeIntervalsNotDefined",{defaultMessage:"Time intervals are not defined."});var q=n(146),V=n(121),$=n(222),U=n(158),G=n(243),H=n(266);const Q=[{columnHeaderType:G.a,id:"@timestamp",initialWidth:H.b},{columnHeaderType:G.a,id:"event.module",linkField:"rule.reference"},{columnHeaderType:G.a,id:"event.dataset"},{columnHeaderType:G.a,id:"event.category"},{columnHeaderType:G.a,id:"event.severity"},{columnHeaderType:G.a,id:"observer.name"},{columnHeaderType:G.a,id:"host.name"},{columnHeaderType:G.a,id:"message"},{columnHeaderType:G.a,id:"agent.id"},{columnHeaderType:G.a,id:"agent.type"}];window["__@hello-pangea/dnd-disable-dev-warnings"]=!0;const W=({browserFields:e,children:t})=>{const n=Object(s.useDispatch)(),r=Object(a.useMemo)((()=>z.b.getTimelineByIdSelector()),[]),o=Object(a.useMemo)((()=>b.b.getDataProvidersSelector()),[]),{timelines:l}=Object(O.j)().services,u=[l.getUseAddToTimelineSensor()],{dataProviders:c,timelineType:d}=Object(f.a)((e=>{var t;return Object(P.pick)(["dataProviders","timelineType"],null!==(t=r(e,q.c.active))&&void 0!==t?t:U.b)})),m=Object(f.a)(o),[,p]=Object(v.f)(),g=Object(a.useCallback)((e=>{const t=d===V.m.template?(e=>B.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.template.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline template"}))(e):(e=>B.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline"}))(e);Object(v.d)(t,p)}),[p,d]),y=Object(a.useCallback)((t=>{try{Y(),null!=m&&(({activeTimelineDataProviders:e,browserFields:t,dataProviders:n,dispatch:a,onAddedToTimeline:i,result:r})=>{if(Object($.q)(r))Object(L.e)({dataProviders:e,destination:r.destination,dispatch:a,source:r.source,timelineId:q.c.active});else if(Object($.p)(r))Object($.d)({activeTimelineDataProviders:e,dataProviders:n,dispatch:a,onAddedToTimeline:i,result:r,timelineId:q.c.active});else if(Object($.i)(r)){var s,o;Object($.c)({browserFields:t,defaultsHeader:Q,dispatch:a,result:r,scopeId:Object($.m)(null!==(s=null===(o=r.destination)||void 0===o?void 0:o.droppableId)&&void 0!==s?s:"")})}})({activeTimelineDataProviders:c,browserFields:e,dataProviders:m,dispatch:n,onAddedToTimeline:g,result:t})}finally{document.body.classList.remove(N.c),Object($.e)(t)&&document.body.classList.remove($.b)}}),[c,e,m,n,g]);return i.a.createElement(D.DragDropContext,{onBeforeDragStart:J,onDragEnd:y,sensors:u},t)};W.displayName="DragDropContextWrapperComponent";const K=i.a.memo(W,((e,t)=>R()(e.children,t.children)));K.displayName="DragDropContextWrapper";const J=e=>{Object($.e)(e)||document.body.classList.add(N.c),Object($.e)(e)&&document.body.classList.add($.b)},Y=()=>window.onscroll=()=>P.noop;var X=n(196),Z=n(10);const ee=i.a.memo((()=>{const{chrome:e,docLinks:t}=Object(O.j)().services;return Object(a.useEffect)((()=>{e.setHelpExtension({appName:Z.f,links:[{content:B.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation",{defaultMessage:"Security documentation"}),href:t.links.siem.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{content:B.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation.ecs",{defaultMessage:"ECS documentation"}),href:t.links.ecs.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{linkType:"discuss",href:"https://discuss.elastic.co/c/security",target:"_blank",rel:"noopener"}]})}),[]),null}));ee.displayName="HelpMenu";var te=n(575),ne=n(132),ae=n(19),ie=n(446),re=n(393),se=n(42),oe=n(41),le=n.n(oe),ue=n(85);const ce=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.searchFilterPlaceholder",{defaultMessage:"e.g. Unusual Linux Process"}),de=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.groupsLabel",{defaultMessage:"Groups"}),me=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.noGroupsAvailableDescription",{defaultMessage:"No Groups available"}),pe=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showAllJobsLabel",{defaultMessage:"Elastic jobs"}),fe=B.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showSiemJobsLabel",{defaultMessage:"Custom jobs"});var be=n(1534);const ge=({securityJobs:e,onSelectedGroupsChanged:t})=>{const[n,r]=Object(a.useState)(!1),[s,o]=Object(a.useState)([]),l=e.map((e=>e.groups)).flat().filter((e=>"siem"!==e&&"security"!==e)),u=Array.from(new Set(l));return Object(a.useEffect)((()=>{t(s)}),[s.sort().join()]),i.a.createElement(ae.EuiPopover,{ownFocus:!0,button:i.a.createElement(ae.EuiFilterButton,{"data-test-subj":"groups-filter-popover-button",iconType:"arrowDown",onClick:()=>r(!n),isSelected:n,numFilters:u.length,hasActiveFilters:s.length>0,numActiveFilters:s.length},de),isOpen:n,closePopover:()=>r(!n),panelPaddingSize:"none",repositionOnScroll:!0},u.map(((e,t)=>i.a.createElement(ae.EuiFilterSelectItem,{checked:s.includes(e)?"on":void 0,key:`${t}-${e}`,onClick:()=>Object(be.a)(e,s,o)},`${e} (${l.filter((t=>t===e)).length})`))),0===u.length&&i.a.createElement(ae.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},i.a.createElement(ae.EuiFlexItem,{grow:!0},i.a.createElement(ae.EuiIcon,{type:"minusInCircle"}),i.a.createElement(ae.EuiSpacer,{size:"xs"}),i.a.createElement("p",null,me))))};ge.displayName="GroupsFilterPopoverComponent";const ve=i.a.memo(ge);ve.displayName="GroupsFilterPopover";const ye=({securityJobs:e,onFilterChanged:t})=>{const[n,r]=Object(a.useState)(""),[s,o]=Object(a.useState)([]),[l,u]=Object(a.useState)(!1),[c,d]=Object(a.useState)(!1);Object(a.useEffect)((()=>{t({filterQuery:n,showCustomJobs:l,showElasticJobs:c,selectedGroups:s})}),[n,s,l,c,t]);const m=Object(a.useCallback)((e=>r(e.queryText.trim())),[r]),p=Object(a.useCallback)((()=>{d(!c),u(!1)}),[d,c,u]),f=Object(a.useCallback)((()=>{u(!l),d(!1)}),[d,l,u]);return i.a.createElement(ae.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},i.a.createElement(ae.EuiFlexItem,{grow:!0},i.a.createElement(ae.EuiSearchBar,{"data-test-subj":"jobs-filter-bar",box:{placeholder:ce,incremental:!0},onChange:m})),i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiFilterGroup,null,i.a.createElement(ve,{securityJobs:e,onSelectedGroupsChanged:o}))),i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiFilterGroup,null,i.a.createElement(ae.EuiFilterButton,{hasActiveFilters:c,onClick:p,"data-test-subj":"show-elastic-jobs-filter-button",withNext:!0},pe),i.a.createElement(ae.EuiFilterButton,{hasActiveFilters:l,onClick:f,"data-test-subj":"show-custom-jobs-filter-button"},fe))))};ye.displayName="JobsTableFiltersComponent";const he=i.a.memo(ye);he.displayName="JobsTableFilters";var je=n(982);const Oe=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.jobNameColumn",{defaultMessage:"Job name"}),Ee=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.tagsColumn",{defaultMessage:"Groups"}),xe=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.runJobColumn",{defaultMessage:"Run job"}),Se=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.noItemsDescription",{defaultMessage:"No Security Machine Learning jobs found"}),we=B.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.createCustomJobButtonLabel",{defaultMessage:"Create custom job"});var ke=n(804);const Ce=le.a.div.withConfig({displayName:"JobNameWrapper",componentId:"sc-1gfh62-0"})(["margin:5px 0;"]);Ce.displayName="JobNameWrapper";const Te=({id:e,name:t,description:n,basePath:a})=>{const{services:{ml:r}}=Object(O.j)(),s=Object(ue.useMlHref)(r,a,{page:ue.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:e}},[e]);return i.a.createElement(Ce,null,i.a.createElement(ae.EuiText,{size:"s"},i.a.createElement(ae.EuiLink,{"data-test-subj":"jobs-table-link",href:s,target:"_blank"},null!=t?t:e)),i.a.createElement(ae.EuiText,{color:"subdued",size:"xs"},n.length>200?`${n.substring(0,200)}...`:n))},Me=(e,t,n)=>[{name:Oe,render:({id:e,description:t,customSettings:a})=>{var r;return i.a.createElement(Te,{id:e,name:null!==(r=null==a?void 0:a.security_app_display_name)&&void 0!==r?r:e,description:t,basePath:n})}},{name:Ee,render:({groups:e})=>i.a.createElement(je.a,{items:e,numberOfItemsToDisplay:0,popoverButtonTitle:`${e.length} Groups`,renderItem:(e,t)=>i.a.createElement(ae.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"group"},e),dataTestPrefix:"groups"}),width:"80px"},{name:xe,render:n=>n.isCompatible?i.a.createElement(ke.a,{job:n,isSecurityJobsLoading:e,onJobStateChange:t}):i.a.createElement(ae.EuiIcon,{"aria-label":"Warning",size:"s",type:"warning",color:"warning"}),align:ae.CENTER_ALIGNMENT,width:"80px"}],Ie=(e,t,n)=>e.slice(t*n,t*n+n),_e=({isLoading:e,jobs:t,onJobStateChange:n,mlNodesAvailable:r})=>{const[s,o]=Object(a.useState)(0),l=Object(O.d)(),u={showPerPageOptions:!1,pageIndex:s,pageSize:5,totalItemCount:t.length};return Object(a.useEffect)((()=>{o(0)}),[t.length]),i.a.createElement(ae.EuiBasicTable,{"data-test-subj":"jobs-table",columns:Me(e,n,l),items:Ie(t.map((e=>({...e,isCompatible:!!r&&e.isCompatible}))),s,5),loading:e,noItemsMessage:i.a.createElement(Pe,{basePath:l}),pagination:u,responsiveBreakpoint:!1,onChange:({page:e})=>{o(e.index)}})};_e.displayName="JobsTableComponent";const Ae=i.a.memo(_e);Ae.displayName="JobsTable";const Pe=i.a.memo((({basePath:e})=>{const{services:{ml:t}}=Object(O.j)(),n=Object(ue.useMlHref)(t,e,{page:ue.ML_PAGES.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});return i.a.createElement(ae.EuiEmptyPrompt,{title:i.a.createElement("h3",null,Se),titleSize:"xs",actions:i.a.createElement(ae.EuiButton,{href:n,iconType:"popout",iconSide:"right",size:"s",target:"_blank"},we)})}));Pe.displayName="NoItemsMessage";const De=le.a.div.withConfig({displayName:"ShowingContainer",componentId:"sc-1qc9cz9-0"})(["user-select:none;margin-top:5px;"]);De.displayName="ShowingContainer";const Fe=({filterResultsLength:e})=>i.a.createElement(De,{"data-test-subj":"showing"},i.a.createElement(ae.EuiText,{color:"subdued",size:"xs"},i.a.createElement(se.FormattedMessage,{"data-test-subj":"query-message",id:"xpack.securitySolution.components.mlPopup.showingLabel",defaultMessage:"Showing: {filterResultsLength} {filterResultsLength, plural, one {job} other {jobs}}",values:{filterResultsLength:e}})));Fe.displayName="ShowingCountComponent";const Re=i.a.memo(Fe);Re.displayName="ShowingCount";const Ne=()=>i.a.createElement(ae.EuiText,{size:"s"},i.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.anomalyDetectionDescription",defaultMessage:"Run any of the Machine Learning jobs below to prepare for creating detection rules that produce alerts for detected anomalies, and to view anomalous events throughout the Security application. We’ve provided a collection of common detection jobs to get you started. If you wish to add your own custom ML jobs, create and add them to the “Security” group from the {machineLearning} application.",values:{machineLearning:i.a.createElement(ae.EuiLink,{href:`${Object(O.d)()}/app/ml`,target:"_blank"},i.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.machineLearningLink",defaultMessage:"Machine Learning"}))}}));Ne.displayName="PopoverDescriptionComponent";const ze=i.a.memo(Ne);ze.displayName="PopoverDescription";const Le=B.i18n.translate("xpack.securitySolution.components.mlPopup.mlJobSettingsButtonLabel",{defaultMessage:"ML job settings"}),Be=B.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeTitle",{defaultMessage:"Upgrade to Elastic Platinum"}),qe=B.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),Ve=B.i18n.translate("xpack.securitySolution.components.mlPopup.licenseButtonLabel",{defaultMessage:"Manage license"}),$e=e=>B.i18n.translate("xpack.securitySolution.components.mlPopup.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job is} other {jobs are}} currently unavailable"}),Ue=B.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.AnomalyDetectionDocsTitle",{defaultMessage:"Anomaly Detection with Machine Learning"}),Ge=le.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-1kq19yh-0"})(["width:384px;"]);Ge.displayName="PopoverContentsDiv";const He=()=>i.a.createElement(Ge,{"data-test-subj":"ml-popover-upgrade-contents"},i.a.createElement(ae.EuiPopoverTitle,null,Be),i.a.createElement(ae.EuiText,{size:"s"},i.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.upgradeDescription",defaultMessage:"To access SIEM’s anomaly detection features, you must update your license to Platinum, start a free 30-day trial, or spin up a {cloudLink} on AWS, GCP, or Azure. You can then run Machine Learning jobs and view anomalies.",values:{cloudLink:i.a.createElement(ae.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},i.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.cloudLink",defaultMessage:"cloud deployment"}))}})),i.a.createElement(ae.EuiSpacer,null),i.a.createElement(ae.EuiFlexGroup,{gutterSize:"s",wrap:!0},i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},qe)),i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiButton,{href:`${Object(O.d)()}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},Ve)))),Qe=i.a.memo(He);Qe.displayName="UpgradeContents";var We=n(527),Ke=n(745);const Je=le.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-1wz4ps6-0"})(["max-width:684px;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-bottom:15px;"]);Je.displayName="PopoverContentsDiv";const Ye={filterQuery:"",showCustomJobs:!1,showElasticJobs:!1,selectedGroups:[]},Xe=i.a.memo((()=>{const[e,t]=Object(a.useState)(!1),[n,r]=Object(a.useState)(Ye),[s,o]=Object(a.useState)(!1),{isMlAdmin:l,isLicensed:u,loading:c,jobs:d,refetch:m}=Object(We.a)(),p=Object(O.j)().services.docLinks,{enableDatafeed:f,disableDatafeed:b,isLoading:g}=Object(Ke.a)(),v=Object(a.useCallback)((async(e,t,n)=>{n?await f(e,t):await b(e),m()}),[m,f,b]),y=(({jobs:e,selectedGroups:t,showCustomJobs:n,showElasticJobs:a,filterQuery:i})=>((e,t)=>{const n=null==t?void 0:t.toLowerCase();return e.filter((e=>{var t,a,i;return null==n||e.id.includes(n)||(null===(t=e.customSettings)||void 0===t||null===(a=t.security_app_display_name)||void 0===a||null===(i=a.toLowerCase())||void 0===i?void 0:i.includes(n))||e.description.toLowerCase().includes(n)}))})(e.filter((e=>!n||n&&!e.isElasticJob)).filter((e=>!a||a&&e.isElasticJob)).filter((e=>0===t.length||t.some((t=>e.groups.includes(t))))),i))({jobs:d,...n}),h=d.filter((e=>!e.isCompatible)).length,j=Object(a.useMemo)((()=>d.filter((e=>e.isInstalled)).map((e=>e.id))),[d]);return u?l?i.a.createElement(ae.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:i.a.createElement(ae.EuiHeaderSectionItemButton,{"aria-expanded":e,"aria-haspopup":"true","aria-label":Le,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>{t(!e),m()},textProps:{style:{fontSize:"1rem"}}},Le),isOpen:e,closePopover:()=>t(!e),repositionOnScroll:!0},i.a.createElement(Je,{"data-test-subj":"ml-popover-contents"},i.a.createElement(ae.EuiPopoverTitle,null,Le),i.a.createElement(ze,null),i.a.createElement(ae.EuiSpacer,null),i.a.createElement(he,{securityJobs:d,onFilterChanged:r}),i.a.createElement(Re,{filterResultsLength:y.length}),i.a.createElement(ae.EuiSpacer,{size:"m"}),h>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ae.EuiCallOut,{title:$e(h),color:"warning",iconType:"warning",size:"s"},i.a.createElement("p",null,i.a.createElement(se.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:i.a.createElement("a",{href:`${p.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},Ue)}}))),i.a.createElement(ae.EuiSpacer,{size:"m"})),i.a.createElement(ue.MLJobsAwaitingNodeWarning,{jobIds:j}),i.a.createElement(ue.MlNodeAvailableWarningShared,{size:"s",nodeAvailableCallback:o}),i.a.createElement(Ae,{isLoading:c||g,jobs:y,onJobStateChange:v,mlNodesAvailable:s}))):null:i.a.createElement(ae.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:i.a.createElement(ae.EuiHeaderSectionItemButton,{"aria-expanded":e,"aria-haspopup":"true","aria-label":Le,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>t(!e),textProps:{style:{fontSize:"1rem"}}},Le),isOpen:e,closePopover:()=>t(!e),repositionOnScroll:!0},i.a.createElement(Qe,null))}));Xe.displayName="MlPopover";var Ze=n(131),et=n(500),tt=n(984),nt=n(241),at=n(1535);const it=navigator.platform.toLowerCase().indexOf("mac")>=0,rt=B.i18n.translate("xpack.securitySolution.globalHeader.assistantHeaderLinkShortcutTooltip",{values:{keyboardShortcut:it?"⌘ ;":"Ctrl ;"},defaultMessage:"Keyboard shortcut {keyboardShortcut}"}),st=B.i18n.translate("xpack.securitySolution.globalHeader.assistantHeaderLink",{defaultMessage:"AI Assistant"}),ot=()=>{const{showAssistantOverlay:e,assistantAvailability:t}=Object(nt.b)(),n=Object(a.useCallback)((()=>e({showOverlay:!0})),[e]);return t.hasAssistantPrivilege?i.a.createElement(ae.EuiToolTip,{content:rt},i.a.createElement(ae.EuiHeaderLink,{"data-test-subj":"assistantHeaderLink",color:"primary",onClick:n},i.a.createElement(ae.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(at.a,{size:"xs"})),i.a.createElement(ae.EuiFlexItem,{grow:!1},st)))):null},lt=B.i18n.translate("xpack.securitySolution.globalHeader.buttonAddData",{defaultMessage:"Add integrations"}),ut=i.a.memo((()=>{const e=Object(a.useMemo)((()=>Object(ie.c)()),[]),{theme:t,setHeaderActionMenu:n,i18n:r}=Object(O.j)().services,{pathname:s}=Object(E.useLocation)(),o=Object(a.useMemo)((()=>z.b.getTimelineByIdSelector()),[]),l=Object(f.b)((e=>{var t;return(null!==(t=o(e,q.c.active))&&void 0!==t?t:U.b).show})),u=Object(te.a)(s),c=Object(te.b)(s),d=Object(Ze.isDashboardViewPath)(s),{href:m,onClick:b}=(()=>{const{http:{basePath:{prepend:e}},cloudExperiments:t}=Object(O.j)().services,{pathname:n}=Object(E.useLocation)(),{navigateTo:i}=Object(O.k)(),r=Object(Ze.isThreatIntelligencePath)(n)?p.b:p.a,[s,o]=Object(a.useState)(r);Object(tt.b)(t,"security-solutions.add-integrations-url",r,o);const l=Object(a.useMemo)((()=>e(s)),[e,s]),u=Object(a.useCallback)((e=>{e.preventDefault(),i({url:l})}),[l,i]);return{href:l,onClick:u}})();return Object(a.useEffect)((()=>{if(n)return n((n=>Object(re.a)(i.a.createElement(ie.b,{node:e}),{theme:t,i18n:r})(n))),()=>{d||(e.unmount(),n(void 0))}}),[e,n,t,r,d]),i.a.createElement(ie.a,{node:e},i.a.createElement(ae.EuiHeaderSection,{side:"right"},Object(Ze.isDetectionsPath)(s)&&i.a.createElement(ae.EuiHeaderSectionItem,null,i.a.createElement(Xe,null)),i.a.createElement(ae.EuiHeaderSectionItem,null,i.a.createElement(ae.EuiHeaderLinks,null,i.a.createElement(ae.EuiHeaderLink,{color:"primary","data-test-subj":"add-data",href:m,iconType:"indexOpen",onClick:b},lt),c&&!l&&i.a.createElement(et.a,{scope:u,"data-test-subj":"sourcerer"}),i.a.createElement(ot,null)))))}));ut.displayName="GlobalHeader";var ct=n(899),dt=n(256),mt=n(198),pt=n(18),ft=n(886),bt=n(36);const gt=(e,t)=>{if(!t)return null;for(const a of t){var n;if(null!==(n=a.links)&&void 0!==n&&n.length){const t=gt(e,a.links);if(t)return t}if(e(a))return a}return null};var vt=n(1865),yt=n(1428),ht=n(1200),jt=n(414),Ot=n(55),Et=n(138),xt=n(161),St=n(250),wt=n(758),kt=n(1541),Ct=n(1615),Tt=n(1681);const Mt=le.a.div.withConfig({displayName:"TopNContainer",componentId:"sc-149y4ld-0"})(["min-width:600px;"]),It=le()(ae.EuiButtonIcon).withConfig({displayName:"CloseButton",componentId:"sc-149y4ld-1"})(["position:absolute;right:4px;top:4px;"]),_t=le()(ae.EuiSuperSelect).withConfig({displayName:"ViewSelect",componentId:"sc-149y4ld-2"})(["width:170px;"]),At=le.a.div.withConfig({displayName:"TopNContent",componentId:"sc-149y4ld-3"})(["margin-top:4px;margin-right:",";.euiPanel{border:none;}"],(({theme:e})=>e.eui.euiSizeXS)),Pt=({filterQuery:e,defaultView:t,deleteQuery:n,filters:r,field:s,from:o,indexPattern:l,options:u,paddingSize:c,query:d,setAbsoluteRangeDatePickerTarget:m,setQuery:p,scopeId:f,to:b,toggleTopN:g,applyGlobalQueriesAndFilters:v})=>{const[y,h]=Object(a.useState)(t),j=Object(a.useCallback)((e=>h(e)),[h]),O=Object(wt.b)({scopeId:f,view:y});Object(a.useEffect)((()=>{h(t)}),[t]);const E=Object(a.useMemo)((()=>i.a.createElement(_t,{"data-test-subj":"view-select",disabled:1===u.length,onChange:j,options:u,valueOfSelected:y})),[j,u,y]),x=Object(a.useMemo)((()=>Object(wt.d)({filters:r,tableId:f,view:y})),[r,f,y]);return i.a.createElement(Mt,{"data-test-subj":"topN-container"},i.a.createElement(At,null,"raw"===y||"all"===y?i.a.createElement(kt.a,{filterQuery:e,deleteQuery:n,filters:x,from:o,headerChildren:E,indexPattern:l,onlyField:s,paddingSize:c,query:d,queryType:"topN",setQuery:p,showSpacer:!1,toggleTopN:g,sourcererScopeId:O,to:b,hideQueryToggle:!0,applyGlobalQueriesAndFilters:v}):i.a.createElement(Ct.a,{filters:x,headerChildren:E,onlyField:s,paddingSize:c,setAbsoluteRangeDatePickerTarget:m,hideQueryToggle:!0})),i.a.createElement(It,{"aria-label":Tt.c,"data-test-subj":"close",iconType:"cross",onClick:g}))};Pt.displayName="TopNComponent";const Dt=i.a.memo(Pt),Ft=[],Rt={query:"",language:"kuery"},Nt=Object(s.connect)((()=>{const e=b.d.globalQuerySelector(),t=b.d.globalFiltersQuerySelector(),n=z.b.getTimelineByIdSelector(),a=b.d.getTimelineSelector(),i=z.b.getKqlFilterQuerySelector();return(r,s)=>{var o,l;const u=null!==(o=n(r,q.c.active))&&void 0!==o?o:U.b,c=null!==(l=u.filters)&&void 0!==l?l:Ft,d=a(r),{globalFilters:m}=s;return{activeTimelineEventType:u.eventType,activeTimelineFilters:u.activeTab===q.d.query?c:Ft,activeTimelineFrom:d.timerange.from,activeTimelineKqlQueryExpression:u.activeTab===q.d.query?i(r,q.c.active):null,activeTimelineTo:d.timerange.to,dataProviders:u.activeTab===q.d.query?u.dataProviders:[],globalQuery:e(r),globalFilters:null!=m?m:t(r),kqlMode:u.kqlMode}}})),zt=({activeTimelineEventType:e,activeTimelineFilters:t,activeTimelineFrom:n,activeTimelineKqlQueryExpression:r,activeTimelineTo:s,browserFields:o,dataProviders:l,field:u,indexPattern:c,globalFilters:d=Ft,globalQuery:m=Rt,kqlMode:p,onFilterAdded:f,paddingSize:b,showLegend:g,scopeId:v,toggleTopN:y})=>{const{uiSettings:h}=Object(O.j)().services,{from:j,deleteQuery:E,setQuery:x,to:S}=Object(xt.a)(),w=Object(wt.a)(Object(Ze.isActiveTimeline)(null!=v?v:"")?e:void 0),k=!Object(Ze.isActiveTimeline)(null!=v?v:""),C=Object(a.useMemo)((()=>Object(Ze.isActiveTimeline)(null!=v?v:"")?Object(St.d)({browserFields:o,config:Object(Ot.getEsQueryConfig)(h),dataProviders:l,filters:t,indexPattern:c,kqlMode:p,kqlQuery:{language:"kuery",query:null!=r?r:""}}):void 0),[v,o,h,l,t,c,p,r]),T=Object(a.useMemo)((()=>Object(wt.c)(v)?"alert":w[0].value),[w,v]);return i.a.createElement(Dt,{filterQuery:null==C?void 0:C.filterQuery,"data-test-subj":"top-n",defaultView:T,deleteQuery:Object(Ze.isActiveTimeline)(null!=v?v:"")?void 0:E,field:u,filters:Object(Ze.isActiveTimeline)(null!=v?v:"")?Ft:d,from:Object(Ze.isActiveTimeline)(null!=v?v:"")?n:j,indexPattern:c,options:w,paddingSize:b,query:Object(Ze.isActiveTimeline)(null!=v?v:"")?Rt:m,setAbsoluteRangeDatePickerTarget:Object(Ze.isActiveTimeline)(null!=v?v:"")?Et.a.timeline:Et.a.global,setQuery:x,scopeId:v,to:Object(Ze.isActiveTimeline)(null!=v?v:"")?s:S,toggleTopN:y,onFilterAdded:f,applyGlobalQueriesAndFilters:k})};zt.displayName="StatefulTopNComponent";const Lt=Nt(i.a.memo(zt)),Bt=i.a.memo((()=>{const{pathname:e}=Object(E.useLocation)(),{browserFields:t,indexPattern:n}=Object(ne.a)(Object(te.a)(e)),{services:{topValuesPopover:r}}=Object(O.j)(),s=Object(jt.useObservable)(r.getObservable()),o=Object(a.useCallback)((()=>{r.closePopover()}),[r]);return s&&s.nodeRef?i.a.createElement(ae.EuiWrappingPopover,{isOpen:!0,button:s.nodeRef,closePopover:o,anchorPosition:"downCenter",hasArrow:!1,repositionOnScroll:!0,ownFocus:!0,attachToAnchor:!1},i.a.createElement(Lt,{field:s.fieldName,showLegend:!0,scopeId:s.scopeId,toggleTopN:o,indexPattern:n,browserFields:t})):null}));Bt.displayName="TopValuesPopover";var qt=n(557),Vt=n.n(qt),$t=n(721),Ut=n.n($t),Gt=n(49),Ht=n(7),Qt=n(47),Wt=n(659),Kt=n(1381),Jt=n(812),Yt=n(1380);const Xt=({anonymizationFields:e,currentReplacements:t,getAnonymizedValue:n,getAnonymizedValues:a,rawData:i})=>Object.keys(i).reduce(((r,s)=>{if(Object(Yt.a)({anonymizationFields:null!=e?e:[],field:s})){const{anonymizedValues:o,replacements:l}=a({anonymizationFields:e,currentReplacements:t,field:s,getAnonymizedValue:n,rawData:i});return{anonymizedData:{...r.anonymizedData,[s]:o},replacements:{...r.replacements,...l}}}return r}),{anonymizedData:{},replacements:{}}),Zt=({anonymizationFields:e=[],currentReplacements:t,field:n,getAnonymizedValue:a,rawData:i})=>{var r;return(null!==(r=i[n])&&void 0!==r?r:[]).reduce(((i,r)=>{const s=`${r}`;if(Object(Yt.a)({anonymizationFields:e,field:n})&&Object(Yt.b)({anonymizationFields:e,field:n})){const e=`${a({currentReplacements:t,rawValue:s})}`;return{anonymizedValues:[...i.anonymizedValues,e],replacements:{...i.replacements,[e]:s}}}return Object(Yt.a)({anonymizationFields:e,field:n})?{anonymizedValues:[...i.anonymizedValues,s],replacements:{...i.replacements}}:i}),{anonymizedValues:[],replacements:{}})};var en=n(50);const tn=({currentReplacements:e,rawValue:t})=>{if(null!=e){const n=Object(P.invert)(e)[t];return null!=n?n:Object(en.v4)()}return Object(en.v4)()};var nn=n(1540),an=n(1340),rn=n(756);const sn=({allSystemPrompts:e,currentConversation:t,editingSystemPromptId:n,http:i,selectedPromptContexts:r,setEditingSystemPromptId:s,setSelectedPromptContexts:o,setUserPrompt:l,setCurrentConversation:u})=>{const{assistantTelemetry:c,toasts:d}=Object(nt.b)(),{isLoading:m,sendMessage:p,abortStream:f}=(()=>{const{alertsIndexPattern:e,assistantStreamingEnabled:t,knowledgeBase:n,traceOptions:i}=Object(nt.b)(),[r,s]=Object(a.useState)(!1),o=Object(a.useRef)(new AbortController);return{isLoading:r,sendMessage:Object(a.useCallback)((async({apiConfig:a,http:r,message:l,conversationId:u,replacements:c})=>{s(!0);try{return await Object(Kt.a)({conversationId:u,alertsIndexPattern:e,apiConfig:a,assistantStreamingEnabled:t,http:r,message:l,replacements:c,signal:o.current.signal,size:n.latestAlerts,traceOptions:i})}finally{s(!1)}}),[e,t,n.latestAlerts,i]),abortStream:Object(a.useCallback)((()=>{o.current.abort(),o.current=new AbortController}),[])}})(),{clearConversation:b,removeLastMessage:g}=Object(Jt.a)(),v=Object(a.useCallback)((async a=>{var s,l;if(null==t||!t.apiConfig)return void(null==d||d.addError(new Error("The conversation needs a connector configured in order to send a message."),{title:B.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}));const m=e.find((e=>e.id===n)),f=function({currentReplacements:e,getAnonymizedValue:t=tn,isNewChat:n,promptText:a,selectedPromptContexts:i,selectedSystemPrompt:r}){var s;let o=null!=e?e:{};const l=e=>{o={...o,...e}},u=Object.keys(i).sort().map((n=>{var a,r;const s=(({anonymizationFields:e,currentReplacements:t,getAnonymizedValue:n,onNewReplacements:a,rawData:i})=>{if("string"==typeof i)return i;const r=Xt({anonymizationFields:e,currentReplacements:t,rawData:i,getAnonymizedValue:n,getAnonymizedValues:Zt});return null!=a&&a(r.replacements),s=r.anonymizedData,Object.keys(s).sort().map((e=>`${e},${s[e].join(",")}`)).join("\n");var s})({anonymizationFields:null!==(a=null===(r=i[n].contextAnonymizationFields)||void 0===r?void 0:r.data)&&void 0!==a?a:[],currentReplacements:{...e,...i[n].replacements},getAnonymizedValue:t,onNewReplacements:l,rawData:i[n].rawData});return`${Object(nn.b)(s)}\n`}));return{content:`${n&&r&&r.content.length>0?`${null!==(s=null==r?void 0:r.content)&&void 0!==s?s:""}\n\n`:""}${u.length>0?`${u}\n`:""}${a}`.trim(),role:"user",timestamp:(new Date).toISOString(),replacements:o}}({isNewChat:0===t.messages.length,currentReplacements:t.replacements,promptText:a,selectedPromptContexts:r,selectedSystemPrompt:m}),b=null!==(s=f.replacements)&&void 0!==s?s:t.replacements,g=Object.values(r).reduce(((e,t)=>({...e,...t.replacements})),{}),v={...b,...g},y=[...t.messages,f].map((e=>{var t;return{...e,content:null!==(t=e.content)&&void 0!==t?t:""}}));u({...t,replacements:v,messages:y}),o({});const h=await p({apiConfig:t.apiConfig,http:i,message:null!==(l=f.content)&&void 0!==l?l:"",conversationId:t.id,replacements:v});null==c||c.reportAssistantMessageSent({conversationId:t.title,role:f.role,actionTypeId:t.apiConfig.actionTypeId,model:t.apiConfig.model,provider:t.apiConfig.provider});const j=Object(an.c)(h);u({...t,replacements:v,messages:[...y,j]}),null==c||c.reportAssistantMessageSent({conversationId:t.title,role:j.role,actionTypeId:t.apiConfig.actionTypeId,model:t.apiConfig.model,provider:t.apiConfig.provider})}),[e,c,t,n,i,r,p,u,o,d]),y=Object(a.useCallback)((async()=>{var e;if(null==t||!t.apiConfig)return void(null==d||d.addError(new Error("The conversation needs a connector configured in order to send a message."),{title:B.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}));u({...t,messages:t.messages.slice(0,-1)});const n=null!==(e=await g(t.id))&&void 0!==e?e:[],a=await p({apiConfig:t.apiConfig,http:i,conversationId:t.id,replacements:{}}),r=Object(an.c)(a);u({...t,messages:[...n,r]})}),[t,i,g,p,u,d]);return{abortStream:f,handleOnChatCleared:Object(a.useCallback)((async()=>{var n,a,i;const r=null!==(n=null===(a=Object(rn.d)({allSystemPrompts:e,conversation:t}))||void 0===a?void 0:a.id)&&void 0!==n?n:null===(i=Object(rn.c)(e))||void 0===i?void 0:i.id;if(l(""),o({}),t){const e=await b(t);e&&u(e)}s(r)}),[e,b,t,u,s,o,l]),handlePromptChange:e=>{l(e)},handleSendMessage:v,handleRegenerateResponse:y,isLoading:m}};var on=n(1446);const ln=({isDisabled:e,isLoading:t,onSendMessage:n,promptValue:i})=>{const r=Object(a.useRef)(null),s=Object(a.useCallback)((()=>{var e;null==r||null===(e=r.current)||void 0===e||e.hideToolTip()}),[]);return Object(S.jsx)(ae.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiToolTip,{ref:r,position:"right",content:on.f,display:"block",onMouseOut:s},Object(S.jsx)(ae.EuiButtonIcon,{"aria-label":on.f,"data-test-subj":"submit-chat",color:"primary",display:null!=i&&i.length?"fill":"base",size:"m",iconType:"kqlFunction",isDisabled:e||!(null!=i&&i.length),isLoading:t,onClick:n}))))},un=B.i18n.translate("xpack.elasticAssistant.assistant.promptPlaceholder",{defaultMessage:"Ask me anything from 'summarize this alert' to 'help me build a query...'"});var cn={name:"6c60ce",styles:"padding-right:64px!important;min-height:64px;max-height:350px"};const dn=Object(a.forwardRef)((({isDisabled:e=!1,value:t,onPromptSubmit:n,handlePromptChange:i},r)=>{const s=Object(a.useCallback)((e=>{i(e.target.value)}),[i]),o=Object(a.useCallback)((e=>{var a;13!==e.keyCode||e.shiftKey||(e.preventDefault(),t.trim().length?(n(null===(a=e.target.value)||void 0===a?void 0:a.trim()),i("")):e.stopPropagation())}),[t,n,i]);return Object(S.jsx)(ae.EuiTextArea,{css:cn,className:"eui-scrollBar",inputRef:r,id:"prompt-textarea","data-test-subj":"prompt-textarea",fullWidth:!0,autoFocus:!0,resize:"none",disabled:e,placeholder:un,value:t,onChange:s,onKeyDown:o,rows:1})}));dn.displayName="PromptTextArea";var mn={name:"1d3w5wq",styles:"width:100%"},pn={name:"bjn8wh",styles:"position:relative"};const fn=({handlePromptChange:e,handleSendMessage:t,isDisabled:n,isLoading:i,shouldRefocusPrompt:r,userPrompt:s})=>{const o=Object(a.useRef)(null);Object(a.useEffect)((()=>{r&&o.current&&(null==o||o.current.focus())}),[r]);const l=Object(a.useMemo)((()=>n?"":null!=s?s:""),[n,s]),u=Object(a.useCallback)((()=>{var n,a,i;t(null!==(n=null===(a=o.current)||void 0===a||null===(i=a.value)||void 0===i?void 0:i.trim())&&void 0!==n?n:""),e("")}),[t,o,e]);var c,d;return c=null==o?void 0:o.current,d=l,Object(a.useEffect)((()=>{if(c){c.style.height="0px";const e=c.scrollHeight;c.style.height=`${e}px`}}),[c,d]),Object(a.useEffect)((()=>{e(l)}),[e,l]),Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"none",alignItems:"flexEnd",css:pn},Object(S.jsx)(ae.EuiFlexItem,{css:mn},Object(S.jsx)(dn,{onPromptSubmit:t,ref:o,handlePromptChange:e,value:l,isDisabled:n})),Object(S.jsx)(ae.EuiFlexItem,{css:Object(S.css)("right:0;position:absolute;margin-right:",Gt.euiThemeVars.euiSizeS,";margin-bottom:",Gt.euiThemeVars.euiSizeS,";",""),grow:!1},Object(S.jsx)(ln,{isDisabled:n,isLoading:i,onSendMessage:u,promptValue:l})))};var bn=n(1678),gn=n(1736),vn={name:"1d3w5wq",styles:"width:100%"},yn={name:"3s4yqf",styles:"width:400px"},hn={name:"1d3w5wq",styles:"width:100%"};const jn=({connectorPrompt:e,http:t,isAssistantEnabled:n,isWelcomeSetup:a})=>{const i=t.basePath.get();return n?a?Object(S.jsx)(ae.EuiFlexGroup,{css:vn},Object(S.jsx)(ae.EuiFlexItem,{"data-test-subj":"connector-prompt"},e)):null:Object(S.jsx)(ae.EuiFlexGroup,{justifyContent:"center",direction:"column",alignItems:"center",gutterSize:"l",css:hn},Object(S.jsx)(ae.EuiFlexItem,{grow:!1,css:yn},Object(S.jsx)(ae.EuiText,null,Object(S.jsx)("p",null,bn.a))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(gn.a,{basePath:i})))};var On=n(1376);async function En({anonymizationFields:e,promptContext:t}){const n=await t.getPromptContext();if("string"==typeof n)return{contextAnonymizationFields:void 0,promptContextId:t.id,rawData:n,replacements:t.replacements};{const a=Object.keys(n).reduce(((t,n)=>{var a,i;return[...t,{id:n,field:n,allowed:Object(Yt.a)({anonymizationFields:null!==(a=null==e?void 0:e.data)&&void 0!==a?a:[],field:n}),anonymized:Object(Yt.b)({anonymizationFields:null!==(i=null==e?void 0:e.data)&&void 0!==i?i:[],field:n})}]}),[]);return{contextAnonymizationFields:{page:1,perPage:1e3,total:a.length,data:a},promptContextId:t.id,rawData:n,replacements:t.replacements}}}const xn=({anonymizationFields:e,promptContexts:t,selectedPromptContexts:n,setSelectedPromptContexts:i})=>{const r=Object(a.useMemo)((()=>Object(P.sortBy)("description",Object.values(t))),[t]),s=Object(a.useCallback)((async a=>{if(null==n[a]&&null!=t[a]&&e){const n=await En({anonymizationFields:e,promptContext:t[a]});i((e=>({...e,[a]:n})))}}),[e,t,n,i]);return Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"none",wrap:!0},r.map((({description:e,id:t,tooltip:a})=>{const i=Object(S.jsx)(ae.EuiButtonEmpty,{"data-test-subj":`pillButton-${t}`,disabled:null!=n[t],iconSide:"left",iconType:"plusInCircle",size:"s",onClick:()=>s(t)},e);return Object(S.jsx)(ae.EuiFlexItem,{grow:!1,key:t},null!=n[t]?i:Object(S.jsx)(ae.EuiToolTip,{content:a},i))})))},Sn=i.a.memo(xn),wn=B.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.addQuickPromptTitle",{defaultMessage:"Add quick prompt..."}),kn=B.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.overflowAriaTitle",{defaultMessage:"Show overflow Quick Prompts"});B.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),B.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"});var Cn=n(821),Tn={name:"d3v9zr",styles:"overflow:hidden"},Mn={name:"d3v9zr",styles:"overflow:hidden"};const In=i.a.memo((({setInput:e,setIsSettingsModalVisible:t,trackPrompt:n,allPrompts:i})=>{const[r,{width:s}]=Object(jt.useMeasure)(),{promptContexts:o,setSelectedSettingsTab:l}=Object(nt.b)(),u=Object(a.useMemo)((()=>{const e=Object.values(o).map((e=>e.category));return e.push("knowledge-base"),i.filter((t=>{return t.promptType===Wt.a.quick&&(!t.categories||0===t.categories.length||(null===(n=t.categories)||void 0===n?void 0:n.some((t=>e.includes(t)))));var n}))}),[i,o]),[c,d]=Object(a.useState)(!1),m=Object(a.useCallback)((()=>d(!c)),[c]),p=Object(a.useCallback)((()=>d(!1)),[]),f=Object(a.useCallback)((t=>{e(t.content),t.isDefault?n(t.name):n("Custom")}),[e,n]),b=Object(a.useCallback)((e=>{f(e),p()}),[p,f]),g=Object(a.useCallback)((()=>{t(!0),l(Cn.g)}),[t,l]),v=Object(a.useMemo)((()=>{const e=Math.floor(s/120);return{visible:u.slice(0,e),overflow:u.slice(e)}}),[u,s]);return Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"spaceBetween"},Object(S.jsx)(ae.EuiFlexItem,{css:Mn},Object(S.jsx)(ae.EuiFlexGroup,{ref:r,gutterSize:"s",alignItems:"center",wrap:!1},v.visible.map(((e,t)=>Object(S.jsx)(ae.EuiFlexItem,{grow:!1,key:t,css:Tn},Object(S.jsx)(ae.EuiBadge,{color:e.color,onClick:()=>f(e),onClickAriaLabel:e.name},e.name)))),v.overflow.length>0&&Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiPopover,{button:Object(S.jsx)(ae.EuiButtonIcon,{color:"primary",iconType:"boxesHorizontal",onClick:m,"aria-label":kn}),isOpen:c,closePopover:p,anchorPosition:"rightUp"},Object(S.jsx)(ae.EuiFlexGroup,{direction:"column",gutterSize:"s"},v.overflow.map(((e,t)=>Object(S.jsx)(ae.EuiFlexItem,{key:t,grow:!1},Object(S.jsx)(ae.EuiBadge,{color:e.color,onClick:()=>b(e),onClickAriaLabel:e.name},e.name))))))))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiButtonEmpty,{"data-test-subj":"addQuickPrompt",onClick:g,iconType:"plus",size:"xs"},wn)))}));In.displayName="QuickPrompts";var _n=n(755),An=n(1542),Pn=n(577),Dn=n(97);const Fn=i.a.memo((({setIsConnectorModalVisible:e})=>{const{assistantAvailability:t}=Object(nt.b)(),n=t.hasConnectorsAllPrivilege?Pn.e:Pn.d,i=t.hasConnectorsAllPrivilege?Pn.b:Pn.c,r=Object(a.useCallback)((()=>{null==e||e(!0)}),[e]);return Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceAround"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiCard,{"data-test-subj":"connectorButton",layout:"horizontal",icon:Object(S.jsx)(ae.EuiIcon,{size:"xl",type:Dn.OpenAILogo}),title:n,description:i,onClick:t.hasConnectorsAllPrivilege?r:void 0})))}));Fn.displayName="ConnectorButton";const Rn=i.a.memo((({isConnectorConfigured:e,isSettingsModalVisible:t,setIsSettingsModalVisible:n})=>{const{assistantAvailability:r,setSelectedSettingsTab:s}=Object(nt.b)(),o=Object(a.useCallback)((()=>{t||(n(!0),s(Cn.c))}),[t,n,s]),l=r.hasConnectorsAllPrivilege||r.hasConnectorsReadPrivilege&&e;return Object(S.jsx)(i.a.Fragment,null,l?Object(S.jsx)(ae.EuiCallOut,{"data-test-subj":"connectorMissingCallout",color:"danger",iconType:"controlsVertical",size:"m",title:Pn.k,css:Object(S.css)("padding-left:",Gt.euiLightVars.euiPanelPaddingModifiers.paddingMedium,"!important;padding-right:",Gt.euiLightVars.euiPanelPaddingModifiers.paddingMedium,"!important;","")},Object(S.jsx)("p",null,Object(S.jsx)(se.FormattedMessage,{defaultMessage:"Select a connector above or from the {link} to continue",id:"xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutDescription",values:{link:Object(S.jsx)(ae.EuiLink,{onClick:o},Pn.l)}}))):Object(S.jsx)(Fn,null))}));Rn.displayName="ConnectorMissingCallout",B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.defaultConversationTitle",{defaultMessage:"Conversations"}),B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.nextConversationTitle",{defaultMessage:"Next conversation"});const Nn=B.i18n.translate("xpack.elasticAssistant.assistant.sidePanel.deleteConversationAriaLabel",{defaultMessage:"Delete conversation"}),zn=B.i18n.translate("xpack.elasticAssistant.assistant.conversations.sidePanel.newChatButtonLabel",{defaultMessage:"New chat"}),Ln=B.i18n.translate("xpack.elasticAssistant.assistant.deleteConversationModal.deleteConversationTitle",{defaultMessage:"Delete this conversation"}),Bn=B.i18n.translate("xpack.elasticAssistant.assistant.deleteConversationModal.cancelButtonText",{defaultMessage:"Cancel"}),qn=B.i18n.translate("xpack.elasticAssistant.assistant.deleteConversationModal.deleteButtonText",{defaultMessage:"Delete"}),Vn=navigator.platform.toLowerCase().indexOf("mac")>=0,$n=(e,t)=>Object(Ht.findIndex)(e,(e=>Object(Ht.isEmpty)(e.id)?e.title===(null==t?void 0:t.title):e.id===(null==t?void 0:t.id))),Un=(e,t)=>{const n=t?$n(e,t):0;return n>=e.length-1?e[0]:e[n+1]};var Gn={name:"3vw822",styles:"border-left:0;border-right:0;border-bottom:0;padding-top:12px;padding-bottom:12px"},Hn={name:"1hcx8jb",styles:"padding:0"},Qn={name:"1qmr6ab",styles:"overflow:auto"},Wn={name:"d3v9zr",styles:"overflow:hidden"};const Kn=i.a.memo((({currentConversation:e,onConversationSelected:t,shouldDisableKeyboardShortcut:n=(()=>!1),isDisabled:r=!1,conversations:s,onConversationDeleted:o,onConversationCreate:l})=>{const[u,c]=Object(a.useState)(null),d=Object(a.useMemo)((()=>Object(Ht.orderBy)(Object.values(s),"updatedAt","desc").sort(((e,t)=>e.id.length>t.id.length?-1:1))),[s]),m=Object(a.useMemo)((()=>Object.keys(s)),[s]),p=Object(a.useCallback)((n=>{if((null==e?void 0:e.id)===n.id){const e=Un(d,n);t({cId:e.id,cTitle:e.title})}o(n.id)}),[null==e?void 0:e.id,o,d,t]),f=Object(a.useCallback)((()=>{const n=((e,t)=>{const n=t?$n(e,t):0;return n?e[n-1]:e[e.length-1]})(d,e);t({cId:n.id,cTitle:n.title})}),[d,e,t]),b=Object(a.useCallback)((()=>{const n=Un(d,e);t({cId:n.id,cTitle:n.title})}),[d,e,t]),g=Object(a.useCallback)((e=>{r||m.length<=1||("ArrowUp"===e.key&&(Vn?e.metaKey:e.ctrlKey)&&!n()&&(e.preventDefault(),f()),"ArrowDown"===e.key&&(Vn?e.metaKey:e.ctrlKey)&&!n()&&(e.preventDefault(),b()))}),[m.length,r,f,b,n]),v=Object(a.useCallback)((()=>{c(null)}),[]),y=Object(a.useCallback)((()=>{u&&(c(null),p(u))}),[u,p]);return Vt()("keydown",g),Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween",gutterSize:"none",css:Wn},Object(S.jsx)(ae.EuiFlexItem,{css:Qn},Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,borderRadius:"none"},Object(S.jsx)(ae.EuiListGroup,{size:"xs",css:Hn},d.map((n=>Object(S.jsx)(ae.EuiListGroupItem,{key:n.id+n.title,onClick:()=>t({cId:n.id,cTitle:n.title}),label:n.title,isActive:Object(Ht.isEmpty)(n.id)?n.title===(null==e?void 0:e.title):n.id===(null==e?void 0:e.id),extraAction:{color:"danger",onClick:()=>c(n),iconType:"trash",iconSize:"s",disabled:n.isDefault,"aria-label":Nn,"data-test-subj":"delete-option"}})))))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,hasBorder:!0,borderRadius:"none",paddingSize:"m",css:Gn},Object(S.jsx)(ae.EuiButton,{color:"primary",fill:!0,iconType:"discuss",onClick:l,fullWidth:!0,size:"s"},zn)))),u&&Object(S.jsx)(ae.EuiConfirmModal,{title:Ln,onCancel:v,onConfirm:y,cancelButtonText:Bn,confirmButtonText:qn,buttonColor:"danger",defaultFocusedButton:"confirm"}))}));Kn.displayName="ConversationSidePanel";var Jn=n(1487);const Yn=({conversation:e,editingSystemPromptId:t,isSettingsModalVisible:n,onSystemPromptSelectionChange:i,setIsSettingsModalVisible:r,allSystemPrompts:s,refetchConversations:o})=>{var l,u;const[c,d]=Object(a.useState)(!1),m=Object(a.useMemo)((()=>void 0!==t?(d(!1),s.find((e=>e.id===t))):s.find((t=>{var n;return t.id===(null==e||null===(n=e.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)}))),[s,null==e||null===(l=e.apiConfig)||void 0===l?void 0:l.defaultSystemPromptId,t]),p=Object(a.useCallback)((()=>{var n;void 0===t?(d(!1),i(null===(n=s.find((t=>{var n;return t.id===(null==e||null===(n=e.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)})))||void 0===n?void 0:n.id)):(d(!0),i(void 0))}),[s,null==e||null===(u=e.apiConfig)||void 0===u?void 0:u.defaultSystemPromptId,t,i]);return Object(S.jsx)(Jn.a,{allPrompts:s,clearSelectedSystemPrompt:p,conversation:e,"data-test-subj":"systemPrompt",isClearable:!0,isCleared:c,refetchConversations:o,isSettingsModalVisible:n,onSystemPromptSelectionChange:i,selectedPrompt:m,setIsSettingsModalVisible:r})};Yn.displayName="SystemPromptComponent";const Xn=i.a.memo(Yn),Zn=e=>"string"!=typeof e,ea=({field:e,operation:t,selectedPromptContext:n,update:a})=>{const{contextAnonymizationFields:i}=n;if(!i)return n;switch(a){case"allow":return{...n,contextAnonymizationFields:{...i,data:[...i.data.filter((t=>t.field!==e)),{...i.data.find((t=>t.field===e)),allowed:"add"===t}]}};case"allowReplacement":return{...n,contextAnonymizationFields:{...i,data:[...i.data.filter((t=>t.field!==e)),{...i.data.find((t=>t.field===e)),anonymized:"add"===t}]}};default:return n}},ta=({rawData:e})=>Object(S.jsx)(ae.EuiCodeBlock,{"data-test-subj":"readOnlyContextViewer",isCopyable:!0},Object(nn.b)(e));ta.displayName="ReadOnlyContextViewerComponent";const na=i.a.memo(ta);var aa=n(1485),ia=n(1486),ra=n(1461),sa=n(1456),oa=n(1287),la={name:"j1lte4",styles:"flex-direction:column;align-items:flex-start;padding-bottom:0"};const ua=({onClose:e,onSave:t,promptContext:n})=>{var r,s;const{http:o,toasts:l}=Object(nt.b)(),[u,c]=Object(a.useState)(!1),d=Object(ae.useGeneratedHtmlId)({prefix:"updateSettingPresetsCheckbox"}),{data:m,refetch:p}=Object(oa.a)(),[f,b]=i.a.useState([]),[g,v]=i.a.useState(n),[y,h]=Object(a.useState)({create:[],update:[],delete:{}}),j=Object(a.useMemo)((()=>Zn(g.rawData)),[g.rawData]),O=Object(a.useCallback)((async()=>{t&&t(f);try{await Object(sa.a)(o,y,l),p()}catch(e){}e()}),[y,p,f,o,e,t,l]),E=Object(a.useCallback)((e=>{b((t=>[...t,...e])),h((t=>{var n,a;return e.reduce(((e,t)=>{const n=Object(Ht.find)(m.data,["field",t.field]);var a,i;return n?null===(a=e.update)||void 0===a||a.push({id:n.id,..."allow"===t.update||"defaultAllow"===t.update?{allowed:"add"===t.operation}:{},..."allowReplacement"===t.update||"defaultAllowReplacement"===t.update?{anonymized:"add"===t.operation}:{}}):(null===(i=e.create)||void 0===i||i.push({field:t.field,allowed:"add"===t.operation&&("allow"===t.update||"defaultAllow"===t.update),anonymized:"add"===t.operation&&("allowReplacement"===t.update||"defaultAllowReplacement"===t.update)}),e.create=Object(Ht.uniqBy)(e.create,"field")),e}),{create:null!==(n=t.create)&&void 0!==n?n:[],update:null!==(a=t.update)&&void 0!==a?a:[]})})),v((t=>e.reduce(((e,{field:t,operation:n,update:a})=>ea({field:t,operation:n,selectedPromptContext:e,update:a})),t)))}),[m]),x=Object(a.useCallback)((e=>{c(e.target.checked)}),[]);return Object(S.jsx)(ae.EuiModal,{onClose:e},Object(S.jsx)(ae.EuiModalHeader,{css:la},Object(S.jsx)(ae.EuiModalHeaderTitle,null,ra.b),Object(S.jsx)(ae.EuiSpacer,{size:"xs"}),Object(S.jsx)(ae.EuiText,{size:"xs"},ra.a),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"s"})),Object(S.jsx)(ae.EuiModalBody,null,Object(S.jsx)(ia.a,{isDataAnonymizable:j,anonymizationFields:null===(r=g.contextAnonymizationFields)||void 0===r?void 0:r.data,rawData:g.rawData}),Object(S.jsx)(ae.EuiSpacer,{size:"s"}),Object(S.jsx)(aa.a,{anonymizationFields:null!==(s=g.contextAnonymizationFields)&&void 0!==s?s:{total:0,page:1,perPage:1e3,data:[]},onListUpdated:E,rawData:g.rawData})),Object(S.jsx)(ae.EuiModalFooter,{css:Object(S.css)("background:",Gt.euiThemeVars.euiColorLightestShade,";padding-block:16px;","")},Object(S.jsx)(ae.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiFormRow,{helpText:B.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.updatePresetsCheckboxHelpText",{defaultMessage:"Apply new anonymization settings for current & future conversations."})},Object(S.jsx)(ae.EuiCheckbox,{id:d,label:B.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.updatePresetsCheckboxLabel",{defaultMessage:"Update presets"}),checked:u,onChange:x}))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(S.jsx)(ae.EuiFlexItem,null,Object(S.jsx)(ae.EuiButtonEmpty,{onClick:e,size:"s"},B.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.closeButton",{defaultMessage:"Close"}))),Object(S.jsx)(ae.EuiFlexItem,null,Object(S.jsx)(ae.EuiButton,{onClick:O,fill:!0,size:"s"},B.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.saveButton",{defaultMessage:"Save"}))))))))};ua.displayName="SelectedPromptContextEditor";const ca=i.a.memo(ua),da=({currentReplacements:e,rawValue:t})=>{if(null!=e){const n=Object(P.invert)(e)[t];return null!=n?n:Object(en.v4)()}return Object(en.v4)()},ma=Ut()("strong",{target:"euqp2sh0"})("color:",(e=>e.showRealValues?Gt.euiThemeVars.euiColorSuccess:Gt.euiThemeVars.euiColorAccent),";cursor:pointer;");var pa={name:"10mc5le",styles:"max-height:240px;overflow:auto"};const fa=({selectedPromptContext:e,currentReplacements:t,showRealValues:n,onToggleShowAnonymizedValues:r})=>{const s=Object(a.useMemo)((()=>{var n,a;return Xt({anonymizationFields:null!==(n=null===(a=e.contextAnonymizationFields)||void 0===a?void 0:a.data)&&void 0!==n?n:[],getAnonymizedValue:da,getAnonymizedValues:Zt,rawData:e.rawData,currentReplacements:t})}),[t,e]);return Object(S.jsx)(ae.EuiText,{"data-test-subj":"selectedPromptContextPreview",color:"subdued",size:"xs",css:pa},Object(S.jsx)("code",null,Object(S.jsx)(i.a.Fragment,null,Object.entries(s.anonymizedData).map((([e,t])=>Object(S.jsx)("div",{key:e},`${e},`,s.replacements[t[0]]?Object(S.jsx)(ma,{showRealValues:n,onClick:r},n?s.replacements[t[0]]:t):t))))))};fa.displayName="SelectedPromptContextPreview";const ba=i.a.memo(fa);var ga=n(1462),va=n(1492),ya=n(1488);const ha=({selectedPromptContext:e,currentReplacements:t,onListUpdated:n,isDataAnonymizable:r})=>{const[s,o]=Object(a.useState)(!1),[l,u]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>o(!0)),[]),d=Object(a.useCallback)((()=>{o(!1)}),[]),{allowed:m,anonymized:p,total:f}=Object(a.useMemo)((()=>{var t;return Object(ga.a)({anonymizationFields:null===(t=e.contextAnonymizationFields)||void 0===t?void 0:t.data,rawData:e.rawData})}),[e]),b=Object(a.useCallback)((()=>{u((e=>!e))}),[]);return Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween","data-test-subj":"summary",gutterSize:"m"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"s"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(va.a,{allowed:m,total:f,inline:!0})),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ya.a,{anonymized:p,isDataAnonymizable:r,inline:!0})))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"s"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiButtonEmpty,{size:"xs",iconType:l?"eye":"eyeClosed",onClick:b},B.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.hideRealValues",{defaultMessage:"Show anonymized"}))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiButtonEmpty,{size:"xs",iconType:"documentEdit",onClick:c},B.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.editButton",{defaultMessage:"Edit"})))))),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"xs"}),Object(S.jsx)(ba,{showRealValues:l,selectedPromptContext:e,currentReplacements:t,onToggleShowAnonymizedValues:b}),s&&Object(S.jsx)(ca,{promptContext:e,onClose:d,onSave:n}))};ha.displayName="ContextEditorFlyoutComponent";const ja=i.a.memo(ha),Oa=({markdown:e,replacements:t})=>{const n=Object.keys(t).reduce(((e,n)=>e.replaceAll(n,t[n])),e);return Object(S.jsx)("div",{"data-test-subj":"replacementsContextViewer"},Object(S.jsx)(ae.EuiMarkdownFormat,null,n))};Oa.displayName="ReplacementsContextViewer";const Ea=i.a.memo(Oa),xa=Ut()("div",{target:"e3hk6zn0"})({name:"1j3zebv",styles:"overflow-x:auto"}),Sa=({selectedPromptContext:e,setSelectedPromptContexts:t,currentReplacements:n})=>{const i=Object(a.useMemo)((()=>Zn(e.rawData)),[e]),r=Object(a.useCallback)((n=>{const a=n.reduce(((e,{field:t,operation:n,update:a})=>ea({field:t,operation:n,selectedPromptContext:e,update:a})),e);t((t=>({...t,[e.promptContextId]:a})))}),[e,t]);return Object(S.jsx)(xa,{"data-test-subj":"dataAnonymizationEditor"},Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,paddingSize:"m"},"string"==typeof e.rawData?null!=e.replacements?Object(S.jsx)(Ea,{markdown:e.rawData,replacements:e.replacements}):Object(S.jsx)(na,{rawData:e.rawData}):Object(S.jsx)(ja,{selectedPromptContext:e,onListUpdated:r,currentReplacements:n,isDataAnonymizable:i})))},wa=i.a.memo(Sa),ka=B.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.selectedPromotContexts.removeContextTooltip",{defaultMessage:"Remove context"}),Ca=({promptContexts:e,selectedPromptContexts:t,setSelectedPromptContexts:n,currentReplacements:i})=>{const r=Object(a.useCallback)((e=>{n((t=>Object(P.omit)(e,t)))}),[n]);return Object(P.isEmpty)(e)?null:Object(S.jsx)(ae.EuiFlexGroup,{"data-test-subj":"selectedPromptContexts",direction:"column",gutterSize:"s"},Object.keys(t).sort().map((a=>{var s;return Object(S.jsx)(ae.EuiFlexItem,{"data-test-subj":`selectedPromptContext-${a}`,grow:!1,key:a},Object(S.jsx)(ae.EuiAccordion,{buttonContent:null===(s=e[a])||void 0===s?void 0:s.description,extraAction:Object(S.jsx)(ae.EuiToolTip,{content:ka},Object(S.jsx)(ae.EuiButtonIcon,{"aria-label":ka,"data-test-subj":`removePromptContext-${a}`,iconType:"cross",onClick:()=>r(a)})),id:a,paddingSize:"s",css:Object(S.css)("background:",Gt.euiThemeVars.euiPageBackgroundColor,";border-radius:",Gt.euiThemeVars.euiBorderRadius,";>div:first-child{color:",Gt.euiThemeVars.euiColorPrimary,";padding:",Gt.euiThemeVars.euiFormControlPadding,";}",""),borders:"all",arrowProps:{color:"primary"}},Object(S.jsx)(wa,{currentReplacements:i,selectedPromptContext:t[a],setSelectedPromptContexts:n})))})))},Ta=i.a.memo(Ca);var Ma={name:"d3v9zr",styles:"overflow:hidden"};const Ia=({title:e,selectedConversation:t,refetchConversationsState:n})=>{const[i,r]=Object(a.useState)(e),[s,o]=Object(a.useState)(!1),{updateConversationTitle:l}=Object(Jt.a)(),u=Object(a.useCallback)((async e=>{o(!1),t&&(await l({conversationId:t.id,updatedTitle:e}),await n())}),[n,t,l]);return Object(a.useEffect)((()=>{r(e)}),[e]),Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(at.a,{"data-test-subj":"titleIcon",size:"s"})),Object(S.jsx)(ae.EuiFlexItem,{css:Ma},Object(S.jsx)(ae.EuiInlineEditTitle,{heading:"h2",inputAriaLabel:"Edit text inline",value:null!=i?i:zn,size:"xs",isInvalid:!!s,isReadOnly:null==t?void 0:t.isDefault,onChange:e=>r(e.currentTarget.nodeValue||""),onCancel:()=>r(e),onSave:u,editModeProps:{formRowProps:{fullWidth:!0}}})))};var _a=n(1682);const Aa=Ut()("div",{target:"e1u2yunf0"})(":before{content:'';height:100%;border-left:1px solid ",Gt.euiThemeVars.euiColorLightShade,";}"),Pa=Object(a.memo)((({isExpanded:e,setIsExpanded:t,children:n,onConversationCreate:r,isAssistantEnabled:s})=>{const o=Object(a.useCallback)((()=>t&&t(!e)),[e,t]),l=Object(a.useMemo)((()=>Object(S.jsx)(ae.EuiButtonIcon,{disabled:!s,onClick:o,iconType:e?"arrowEnd":"arrowStart",size:"xs","data-test-subj":"aiAssistantFlyoutNavigationToggle","aria-label":e?B.i18n.translate("xpack.elasticAssistant.flyout.right.header.collapseDetailButtonAriaLabel",{defaultMessage:"Hide chats"}):B.i18n.translate("xpack.elasticAssistant.flyout.right.header.expandDetailButtonAriaLabel",{defaultMessage:"Show chats"})})),[s,e,o]);return Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,borderRadius:"none",paddingSize:"s",grow:!1,css:Object(S.css)("border-bottom:1px solid ",Gt.euiThemeVars.euiColorLightShade,";","")},Object(S.jsx)(ae.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},t&&Object(S.jsx)(ae.EuiFlexItem,{grow:!1},l),r&&Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(Aa,null)),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiButtonEmpty,{size:"xs",color:"primary",iconType:"newChat",onClick:r,disabled:!s},zn))))),n&&Object(S.jsx)(ae.EuiFlexItem,{grow:!1},n)))}));Pa.displayName="FlyoutNavigation";var Da=n(919),Fa=n(918),Ra=n(1289),Na=n(1384);const za=B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.defaultConversationTitle",{defaultMessage:"Conversations"}),La=B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.ariaLabel",{defaultMessage:"Conversation selector"}),Ba=B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.placeholderTitle",{defaultMessage:"Select or type to create new..."}),qa=B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),Va=B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.previousConversationTitle",{defaultMessage:"Previous conversation"}),$a=B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.nextConversationTitle",{defaultMessage:"Next conversation"}),Ua=B.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.deleteConversationTitle",{defaultMessage:"Delete conversation"});var Ga={name:"1v0pok0",styles:"min-width:300px"},Ha={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},Qa={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},Wa={name:"1e5733u",styles:"width:calc(100% - 60px)"};const Ka=i.a.memo((({conversations:e,onConversationDeleted:t,onConversationSelectionChange:n,selectedConversationTitle:i,isDisabled:r})=>{const s=Object(a.useMemo)((()=>Object.values(e).map((e=>e.title))),[e]),[o,l]=Object(a.useState)((()=>Object.values(e).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.title,id:e.id,"data-test-subj":e.title}})))),u=Object(a.useMemo)((()=>{var e;return i&&null!==(e=o.filter((e=>e.label===i)))&&void 0!==e?e:[]}),[o,i]),c=Object(a.useCallback)((t=>{var a,i;const r=0===t.length?void 0:null!==(a=Object.values(e).find((e=>{var n;return e.title===(null===(n=t[0])||void 0===n?void 0:n.label)})))&&void 0!==a?a:null===(i=t[0])||void 0===i?void 0:i.label;n(r)}),[n,e]),d=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e,id:""};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||l([...o,a]),c([a])}),[o,c]),m=Object(a.useCallback)((e=>{0===e.length?c([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&c(e)}),[o,c]),p=Object(a.useCallback)((e=>{var n;l(o.filter((t=>t.label!==e))),(null==u||null===(n=u[0])||void 0===n?void 0:n.label)===e&&c([]),t(e)}),[o,c,t,u]),f=Object(a.useCallback)((()=>{const e=((e,t)=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1])(s,i),t=o.filter((t=>t.label===e));c(t)}),[s,i,o,c]),b=Object(a.useCallback)((()=>{const e=((e,t)=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(s,i),t=o.filter((t=>t.label===e));c(t)}),[s,i,o,c]);return Object(S.jsx)(ae.EuiFormRow,{label:za,display:"rowCompressed",css:Ga},Object(S.jsx)(ae.EuiComboBox,{"data-test-subj":"conversation-selector","aria-label":La,customOptionText:`${qa} {searchValue}`,placeholder:Ba,singleSelection:{asPlainText:!0},options:o,selectedOptions:u,onChange:m,onCreateOption:d,renderOption:(e,t)=>{const{label:n,value:a}=e;return Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(S.jsx)(ae.EuiFlexItem,{component:"span",grow:!1,css:Wa},Object(S.jsx)(ae.EuiHighlight,{search:t,css:Qa},n)),!(null!=a&&a.isDefault)&&Object(S.jsx)(ae.EuiFlexItem,{grow:!1,component:"span"},Object(S.jsx)(ae.EuiToolTip,{position:"right",content:Ua},Object(S.jsx)(ae.EuiButtonIcon,{iconType:"cross","aria-label":Ua,color:"danger","data-test-subj":"delete-conversation",onClick:e=>{e.stopPropagation(),p(n)},css:Ha}))))},compressed:!0,isDisabled:r,prepend:Object(S.jsx)(ae.EuiButtonIcon,{iconType:"arrowLeft","data-test-subj":"arrowLeft","aria-label":Va,onClick:f,disabled:r||s.length<=1}),append:Object(S.jsx)(ae.EuiButtonIcon,{iconType:"arrowRight","data-test-subj":"arrowRight","aria-label":$a,onClick:b,disabled:r||s.length<=1})}))}));Ka.displayName="ConversationSelectorSettings";var Ja=n(1546),Ya=n(1616),Xa=n(1545);const Za=i.a.memo((({allSystemPrompts:e,assistantStreamingEnabled:t,connectors:n,defaultConnector:r,selectedConversation:s,onSelectedConversationChange:o,conversationSettings:l,http:u,isDisabled:c=!1,setAssistantStreamingEnabled:d,setConversationSettings:m,conversationsSettingsBulkActions:p,setConversationsSettingsBulkActions:f})=>{var b;const g=Object(Xa.a)({allSystemPrompts:e,conversationSettings:l,conversationsSettingsBulkActions:p,defaultConnector:r,setConversationSettings:m,setConversationsSettingsBulkActions:f,onSelectedConversationChange:o}),v=Object(Ja.a)({conversationSettings:l,conversationsSettingsBulkActions:p,setConversationSettings:m,setConversationsSettingsBulkActions:f}),y=Object(a.useMemo)((()=>s?{...s,...Object(rn.b)({allSystemPrompts:e,conversation:s,connectors:n,defaultConnector:r})}:s),[e,n,r,s]);return Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiTitle,{size:"s"},Object(S.jsx)("h2",null,Na.g)),Object(S.jsx)(ae.EuiSpacer,{size:"xs"}),Object(S.jsx)(ae.EuiText,{size:"s"},Na.d),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"s"}),Object(S.jsx)(Ka,{selectedConversationTitle:null!==(b=null==s?void 0:s.title)&&void 0!==b?b:"",conversations:l,onConversationDeleted:v,onConversationSelectionChange:g}),Object(S.jsx)(Ya.a,{allSystemPrompts:e,conversationSettings:l,conversationsSettingsBulkActions:p,http:u,isDisabled:c,selectedConversation:y,setConversationSettings:m,setConversationsSettingsBulkActions:f,onSelectedConversationChange:o}),Object(S.jsx)(ae.EuiSpacer,{size:"l"}),Object(S.jsx)(ae.EuiTitle,{size:"s"},Object(S.jsx)("h2",null,Na.c)),Object(S.jsx)(ae.EuiSpacer,{size:"xs"}),Object(S.jsx)(ae.EuiText,{size:"s"},Na.b),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"s"}),Object(S.jsx)(ae.EuiFormRow,{fullWidth:!0,display:"rowCompressed",label:Na.i},Object(S.jsx)(ae.EuiSwitch,{label:Object(S.jsx)(ae.EuiText,{size:"xs"},Na.h),checked:t,onChange:e=>d(e.target.checked),compressed:!0})))}));Za.displayName="ConversationSettings";var ei=n(1457),ti=n(1611);const ni=i.a.memo((({onSelectedQuickPromptChange:e,quickPromptSettings:t,selectedQuickPrompt:n,setUpdatedQuickPromptSettings:a,promptsBulkActions:r,setPromptsBulkActions:s})=>Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiTitle,{size:"s"},Object(S.jsx)("h2",null,ei.h)),Object(S.jsx)(ae.EuiSpacer,{size:"xs"}),Object(S.jsx)(ae.EuiText,{size:"s"},ei.g),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"s"}),Object(S.jsx)(ti.a,{onSelectedQuickPromptChange:e,quickPromptSettings:t,selectedQuickPrompt:n,setUpdatedQuickPromptSettings:a,promptsBulkActions:r,setPromptsBulkActions:s}))));ni.displayName="AddQuickPromptModal";var ai=n(920),ii=n(1612);const ri=i.a.memo((({connectors:e,conversationSettings:t,onSelectedSystemPromptChange:n,selectedSystemPrompt:a,setUpdatedSystemPromptSettings:r,setConversationSettings:s,systemPromptSettings:o,conversationsSettingsBulkActions:l,setConversationsSettingsBulkActions:u,promptsBulkActions:c,defaultConnector:d,setPromptsBulkActions:m})=>Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiTitle,{size:"s"},Object(S.jsx)("h2",null,ai.b)),Object(S.jsx)(ae.EuiSpacer,{size:"xs"}),Object(S.jsx)(ae.EuiText,{size:"s"},ai.a),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"s"}),Object(S.jsx)(ii.a,{connectors:e,conversationSettings:t,onSelectedSystemPromptChange:n,selectedSystemPrompt:a,setUpdatedSystemPromptSettings:r,setConversationSettings:s,systemPromptSettings:o,conversationsSettingsBulkActions:l,setConversationsSettingsBulkActions:u,defaultConnector:d,setPromptsBulkActions:m,promptsBulkActions:c}))));ri.displayName="SystemPromptSettings";var si=n(1547);const oi=({defaultPageSize:e,anonymizationFields:t,anonymizationFieldsBulkActions:n,setAnonymizationFieldsBulkActions:a,setUpdatedAnonymizationData:r})=>{const s=Object(si.a)({anonymizationFields:t,anonymizationFieldsBulkActions:n,setAnonymizationFieldsBulkActions:a,setUpdatedAnonymizationData:r});return Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiTitle,{size:"s"},Object(S.jsx)("h2",null,ra.b)),Object(S.jsx)(ae.EuiSpacer,{size:"xs"}),Object(S.jsx)(ae.EuiText,{size:"xs"},ra.a),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"s"}),Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center","data-test-subj":"summary",gutterSize:"none"},Object(S.jsx)(ia.a,{isDataAnonymizable:!0,anonymizationFields:t.data})),Object(S.jsx)(ae.EuiSpacer,{size:"s"}),Object(S.jsx)(aa.a,{anonymizationFields:t,onListUpdated:s,rawData:null,pageSize:e,compressed:!0}))};oi.displayName="AnonymizationSettingsComponent";const li=i.a.memo(oi);var ui=n(1548),ci=n(1291),di=n(1344),mi=n(1455);const pi="esql";var fi={name:"1tyyxc3",styles:"padding-left:20px"},bi={name:"1tyyxc3",styles:"padding-left:20px"},gi={name:"1tyyxc3",styles:"padding-left:20px"},vi={name:"nvudtm",styles:"padding-left:5px"},yi={name:"1xr0ypo",styles:".euiFormRow__labelWrapper{min-width:95px!important;}"};const hi=i.a.memo((({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{var n,r,s,o,l;const{http:u,toasts:c}=Object(nt.b)(),{data:d,isLoading:m,isFetching:p}=Object(di.b)({http:u,resource:pi}),{mutate:f,isLoading:b}=Object(mi.a)({http:u,toasts:c}),g=null!==(n=null==d?void 0:d.elser_exists)&&void 0!==n&&n,v=null!==(r=null==d?void 0:d.esql_exists)&&void 0!==r&&r,y=null!==(s=g&&v&&(null==d?void 0:d.index_exists)&&(null==d?void 0:d.pipeline_exists))&&void 0!==s&&s,h=null!==(o=null==d?void 0:d.is_setup_in_progress)&&void 0!==o&&o,j=null!==(l=null==d?void 0:d.is_setup_available)&&void 0!==l&&l,O=m||p||b||h,E=g?"success":"subdued",x=y?"success":"subdued",w=v?"success":"subdued",k=Object(a.useCallback)((()=>{f(pi)}),[f]),C=j?void 0:ci.p,T=Object(a.useMemo)((()=>y?Object(S.jsx)(i.a.Fragment,null):Object(S.jsx)(ae.EuiToolTip,{position:"bottom",content:C},Object(S.jsx)(ae.EuiButtonEmpty,{color:"primary","data-test-subj":"setupKnowledgeBaseButton",disabled:!j,onClick:k,size:"xs",isLoading:O},ci.o))),[y,O,j,k,C]),M=Object(a.useMemo)((()=>y?Object(S.jsx)("span",{"data-test-subj":"kb-installed"},ci.g(".kibana-elastic-ai-assistant-knowledge-base-(SPACE)")):Object(S.jsx)("span",{"data-test-subj":"install-kb"},ci.f)),[y]),I=Object(a.useMemo)((()=>v?Object(S.jsx)("span",{"data-test-subj":"esql-installed"},ci.d):Object(S.jsx)("span",{"data-test-subj":"install-esql"},ci.c)),[v]);return Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiTitle,{size:"s"},Object(S.jsx)("h2",null,ci.n," ",Object(S.jsx)(ae.EuiBetaBadge,{iconType:"beaker",label:ci.m,size:"s",color:"hollow"}))),Object(S.jsx)(ae.EuiSpacer,{size:"xs"}),Object(S.jsx)(ae.EuiText,{size:"s"},Object(S.jsx)(se.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSetting.knowledgeBaseDescription",defaultMessage:"Powered by ELSER, the knowledge base enables the AI Assistant to recall documents and other relevant context within your conversation. For more information about user access refer to our {documentation}.",values:{documentation:Object(S.jsx)(ae.EuiLink,{external:!0,href:"https://www.elastic.co/guide/en/security/current/security-assistant.html",target:"_blank"},ci.h)}})),Object(S.jsx)(ae.EuiHorizontalRule,{margin:"s"}),Object(S.jsx)(ae.EuiFormRow,{display:"columnCompressedSwitch",label:ci.j,css:yi},T),Object(S.jsx)(ae.EuiSpacer,{size:"s"}),Object(S.jsx)(ae.EuiFlexGroup,{direction:"column",gutterSize:"s",css:vi},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)("div",null,Object(S.jsx)(ae.EuiHealth,{color:E},ci.i),Object(S.jsx)(ae.EuiText,{size:"xs",color:"subdued",css:gi},Object(S.jsx)(se.FormattedMessage,{defaultMessage:"Elastic Learned Sparse EncodeR - or ELSER - is a retrieval model trained by Elastic for performing semantic search.",id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSettings.knowledgeBaseDescription"})))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)("div",null,Object(S.jsx)(ae.EuiHealth,{color:x},ci.j),Object(S.jsx)(ae.EuiText,{size:"xs",color:"subdued",css:bi},M))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)("span",null,Object(S.jsx)(ae.EuiHealth,{color:w},ci.e),Object(S.jsx)(ae.EuiText,{size:"xs",color:"subdued",css:fi},I)))),Object(S.jsx)(ae.EuiSpacer,{size:"s"}),Object(S.jsx)(ui.a,{knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t}))}));hi.displayName="KnowledgeBaseSettings";var ji=n(2053),Oi=n(1539);const Ei=le()(ae.EuiModal)`
  width: 800px;
  height: 575px;
`;var xi={name:"1r962iv",styles:"padding:4px"},Si={name:"1tk8yx0",styles:"padding:8px"},wi={name:"1jijcm1",styles:"max-height:519px;overflow-y:scroll"},ki={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},Ci={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},Ti={name:"57t0bw",styles:"position:relative;transform:rotateY(180deg);top:-7px"},Mi={name:"15ag9ng",styles:"position:relative;top:-10px"},Ii={name:"18wygtw",styles:"min-inline-size:unset!important;max-width:104px"};const _i=i.a.memo((({defaultConnector:e,onClose:t,onSave:n,selectedConversationId:r,onConversationSelected:s,conversations:o,conversationsLoaded:l})=>{const{assistantFeatures:{assistantModelEvaluation:u},http:c,toasts:d,selectedSettingsTab:m,setSelectedSettingsTab:p}=Object(nt.b)();Object(a.useEffect)((()=>{null==m&&p(Cn.c)}),[m,p]);const{data:f,refetch:b}=Object(oa.a)(),{data:g,isFetched:v}=Object(Oi.b)(),{data:y}=Object(_n.a)({http:c}),{conversationSettings:h,setConversationSettings:j,knowledgeBase:O,quickPromptSettings:E,systemPromptSettings:x,assistantStreamingEnabled:w,setUpdatedAssistantStreamingEnabled:k,setUpdatedKnowledgeBaseSettings:C,setUpdatedQuickPromptSettings:T,promptsBulkActions:M,saveSettings:I,conversationsSettingsBulkActions:_,updatedAnonymizationData:A,setConversationsSettingsBulkActions:P,anonymizationFieldsBulkActions:D,setAnonymizationFieldsBulkActions:F,setUpdatedAnonymizationData:R,setPromptsBulkActions:N,setUpdatedSystemPromptSettings:z}=Object(Ra.d)(o,g,l,v,f),[L,B]=Object(a.useState)(r),q=Object(a.useCallback)((e=>{B(null==e?void 0:e.id)}),[]),V=Object(a.useMemo)((()=>L?h[L]:void 0),[h,L]),[$,U]=Object(a.useState)(),G=Object(a.useCallback)((e=>{U(e)}),[]);Object(a.useEffect)((()=>{null!=$&&U(E.find((e=>e.name===$.name)))}),[E,$]);const[H,Q]=Object(a.useState)(),W=Object(a.useCallback)((e=>{Q(e)}),[]);Object(a.useEffect)((()=>{null!=H&&Q(x.find((e=>e.id===H.id)))}),[H,x]);const K=Object(a.useCallback)((async()=>{var e,t,a,i,o,l,u;const c=r&&null==h[r],m=Object.values(h)[0];c&&null!=m&&s({cId:m.id,cTitle:m.title});const p=await I();null==d||d.addSuccess({iconType:"check",title:Da.m}),((null!==(e=null==D||null===(t=D.create)||void 0===t?void 0:t.length)&&void 0!==e?e:0)>0||(null!==(a=null==D||null===(i=D.update)||void 0===i?void 0:i.length)&&void 0!==a?a:0)>0||(null!==(o=null==D||null===(l=D.delete)||void 0===l||null===(u=l.ids)||void 0===u?void 0:u.length)&&void 0!==o?o:0)>0)&&await b(),await n(p)}),[D,h,r,s,n,b,I,d]);return Object(S.jsx)(Ei,{"data-test-subj":Fa.a.SETTINGS_MODAL,onClose:t},Object(S.jsx)(ae.EuiPage,{paddingSize:"none"},Object(S.jsx)(ae.EuiPageSidebar,{paddingSize:"xs",css:Ii},Object(S.jsx)(ae.EuiKeyPadMenu,null,Object(S.jsx)(ae.EuiKeyPadMenuItem,{id:Cn.c,label:Da.d,isSelected:!m||m===Cn.c,onClick:()=>p(Cn.c),"data-test-subj":`${Cn.c}-button`},Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiIcon,{type:"editorComment",size:"xl",css:Mi}),Object(S.jsx)(ae.EuiIcon,{type:"editorComment",size:"l",css:Ti}))),Object(S.jsx)(ae.EuiKeyPadMenuItem,{id:Cn.g,label:Da.h,isSelected:m===Cn.g,onClick:()=>p(Cn.g),"data-test-subj":`${Cn.g}-button`},Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiIcon,{type:"editorComment",size:"xxl"}),Object(S.jsx)(ae.EuiIcon,{type:"bolt",size:"s",color:"warning",css:Ci}))),Object(S.jsx)(ae.EuiKeyPadMenuItem,{id:Cn.h,label:Da.n,isSelected:m===Cn.h,onClick:()=>p(Cn.h),"data-test-subj":`${Cn.h}-button`},Object(S.jsx)(ae.EuiIcon,{type:"editorComment",size:"xxl"}),Object(S.jsx)(ae.EuiIcon,{type:"storage",size:"s",color:"success",css:ki})),Object(S.jsx)(ae.EuiKeyPadMenuItem,{id:Cn.a,label:Da.a,isSelected:m===Cn.a,onClick:()=>p(Cn.a),"data-test-subj":`${Cn.a}-button`},Object(S.jsx)(ae.EuiIcon,{type:"eyeClosed",size:"l"})),Object(S.jsx)(ae.EuiKeyPadMenuItem,{id:Cn.f,label:Da.g,isSelected:m===Cn.f,onClick:()=>p(Cn.f),"data-test-subj":`${Cn.f}-button`},Object(S.jsx)(ae.EuiIcon,{type:"notebookApp",size:"l"})),u&&Object(S.jsx)(ae.EuiKeyPadMenuItem,{id:Cn.e,label:Da.f,isSelected:m===Cn.e,onClick:()=>p(Cn.e),"data-test-subj":`${Cn.e}-button`},Object(S.jsx)(ae.EuiIcon,{type:"crossClusterReplicationApp",size:"l"})))),Object(S.jsx)(ae.EuiPageBody,{paddingSize:"none",panelled:!0},Object(S.jsx)(ae.EuiSplitPanel.Outer,{grow:!0},Object(S.jsx)(ae.EuiSplitPanel.Inner,{className:"eui-scrollBar",grow:!0,css:wi},!m||m===Cn.c&&Object(S.jsx)(Za,{connectors:y,defaultConnector:e,conversationSettings:h,setConversationsSettingsBulkActions:P,conversationsSettingsBulkActions:_,setConversationSettings:j,allSystemPrompts:x,selectedConversation:V,isDisabled:null==V,assistantStreamingEnabled:w,setAssistantStreamingEnabled:k,onSelectedConversationChange:q,http:c}),m===Cn.g&&Object(S.jsx)(ni,{quickPromptSettings:E,onSelectedQuickPromptChange:G,selectedQuickPrompt:$,setUpdatedQuickPromptSettings:T,setPromptsBulkActions:N,promptsBulkActions:M}),m===Cn.h&&Object(S.jsx)(ri,{connectors:y,conversationSettings:h,defaultConnector:e,systemPromptSettings:x,onSelectedSystemPromptChange:W,selectedSystemPrompt:H,setConversationSettings:j,setConversationsSettingsBulkActions:P,conversationsSettingsBulkActions:_,setUpdatedSystemPromptSettings:z,setPromptsBulkActions:N,promptsBulkActions:M}),m===Cn.a&&Object(S.jsx)(li,{defaultPageSize:5,anonymizationFields:A,anonymizationFieldsBulkActions:D,setAnonymizationFieldsBulkActions:F,setUpdatedAnonymizationData:R}),m===Cn.f&&Object(S.jsx)(hi,{knowledgeBase:O,setUpdatedKnowledgeBaseSettings:C}),m===Cn.e&&Object(S.jsx)(ji.a,null)),Object(S.jsx)(ae.EuiSplitPanel.Inner,{grow:!1,color:"subdued",css:Si},Object(S.jsx)(ae.EuiModalFooter,{css:xi},Object(S.jsx)(ae.EuiButtonEmpty,{size:"s","data-test-subj":"cancel-button",onClick:t},Da.b),Object(S.jsx)(ae.EuiButton,{size:"s",type:"submit","data-test-subj":"save-button",onClick:K,fill:!0},Da.i)))))))}));_i.displayName="AssistantSettings";const Ai=i.a.memo((({defaultConnector:e,isDisabled:t=!1,isSettingsModalVisible:n,setIsSettingsModalVisible:r,selectedConversationId:s,onConversationSelected:o,conversations:l,conversationsLoaded:u,refetchConversationsState:c,refetchPrompts:d})=>{const{toasts:m,setSelectedSettingsTab:p}=Object(nt.b)(),f=Object(a.useCallback)((()=>{r(!1)}),[r]),b=Object(a.useCallback)((()=>{f()}),[f]),g=Object(a.useCallback)((async e=>{f(),await c(),d&&await d(),e&&(null==m||m.addSuccess({iconType:"check",title:Da.m}))}),[f,c,d,m]),v=Object(a.useCallback)((()=>{p(Cn.c),r(!0)}),[r,p]);return Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiToolTip,{position:"right",content:Da.l},Object(S.jsx)(ae.EuiButtonIcon,{"aria-label":Da.k,"data-test-subj":"settings",onClick:v,isDisabled:t,iconType:"gear",size:"xs",color:"text"})),n&&Object(S.jsx)(_i,{defaultConnector:e,selectedConversationId:s,onConversationSelected:o,onClose:b,onSave:g,conversations:l,conversationsLoaded:u}))}));Ai.displayName="AssistantSettingsButton",B.i18n.translate("xpack.elasticAssistant.assistant.settings.anonymizedValues",{defaultMessage:"Anonymized values"});const Pi=B.i18n.translate("xpack.elasticAssistant.assistant.settings.resetConversation",{defaultMessage:"Reset conversation"}),Di=(B.i18n.translate("xpack.elasticAssistant.assistant.settings.connectorTitle",{defaultMessage:"Connector"}),B.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedToggleLabel",{defaultMessage:"Show anonymized"})),Fi=B.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedToggleRealValuesLabel",{defaultMessage:"Show real values"}),Ri=(B.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedTooltip",{defaultMessage:"Show the anonymized values sent to and from the assistant"}),B.i18n.translate("xpack.elasticAssistant.assistant.resetConversationModal.cancelButtonText",{defaultMessage:"Cancel"})),Ni=B.i18n.translate("xpack.elasticAssistant.assistant.resetConversationModal.resetButtonText",{defaultMessage:"Reset"}),zi=B.i18n.translate("xpack.elasticAssistant.assistant.resetConversationModal.clearChatConfirmation",{defaultMessage:"Are you sure you want to clear the current chat? All conversation data will be lost."});var Li={name:"18wgrk7",styles:"border-radius:50%"},Bi={name:"d3v9zr",styles:"overflow:hidden"};const qi=({selectedConversation:e,defaultConnector:t,isDisabled:n,isSettingsModalVisible:r,onToggleShowAnonymizedValues:s,setIsSettingsModalVisible:o,showAnonymizedValues:l,onChatCleared:u,chatHistoryVisible:c,setChatHistoryVisible:d,onCloseFlyout:m,onConversationSelected:p,conversations:f,conversationsLoaded:b,refetchConversationsState:g,onConversationCreate:v,isAssistantEnabled:y,refetchPrompts:h})=>{var j;const O=Object(a.useMemo)((()=>null!=(null==e?void 0:e.replacements)&&Object.keys(null==e?void 0:e.replacements).length>0&&l),[null==e?void 0:e.replacements,l]),E=Object(a.useMemo)((()=>{var t;return null==e||null===(t=e.apiConfig)||void 0===t?void 0:t.connectorId}),[null==e||null===(j=e.apiConfig)||void 0===j?void 0:j.connectorId]),[x,w]=Object(a.useState)(!1),k=Object(a.useCallback)((()=>{w(!x)}),[x]),C=Object(a.useCallback)((()=>{w(!1)}),[]),[T,M]=Object(a.useState)(!1),I=Object(a.useCallback)((()=>M(!1)),[]),_=Object(a.useCallback)((()=>M(!0)),[]),A=Object(a.useCallback)((e=>{p({cId:e.id,cTitle:e.title})}),[p]),P=Object(a.useMemo)((()=>[{id:0,items:[{name:Pi,css:Object(S.css)("color:",Gt.euiThemeVars.euiColorDanger,";",""),onClick:_,icon:"refresh","data-test-subj":"clear-chat"}]}]),[_]),D=Object(a.useCallback)((()=>{u(),I(),C()}),[u,I,C]);return Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(Pa,{isExpanded:!!c,setIsExpanded:d,onConversationCreate:v,isAssistantEnabled:y},Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"s"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(Ai,{defaultConnector:t,isDisabled:n,isSettingsModalVisible:r,selectedConversationId:Object(Ht.isEmpty)(null==e?void 0:e.id)?null==e?void 0:e.title:null==e?void 0:e.id,setIsSettingsModalVisible:o,onConversationSelected:p,conversations:f,conversationsLoaded:b,refetchConversationsState:g,refetchPrompts:h})),m&&Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiButtonIcon,{"data-test-subj":"euiFlyoutCloseButton",iconType:"cross",color:"text",size:"xs",onClick:m})))),Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,paddingSize:"m",css:Object(S.css)("padding-top:",Gt.euiThemeVars.euiSizeS,";padding-bottom:",Gt.euiThemeVars.euiSizeS,";","")},Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"s"},Object(S.jsx)(ae.EuiFlexItem,{css:Bi},Object(S.jsx)(Ia,{title:null==e?void 0:e.title,selectedConversation:e,refetchConversationsState:g})),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(S.jsx)(ae.EuiFlexItem,null,Object(S.jsx)(_a.a,{isDisabled:n||void 0===e,selectedConnectorId:E,selectedConversation:e,onConnectorSelected:A})),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiToolTip,{content:O?Fi:Di},Object(S.jsx)(ae.EuiButtonIcon,{css:Li,display:"base","data-test-subj":"showAnonymizedValues",isSelected:O,"aria-label":O?Di:Fi,iconType:O?"eye":"eyeClosed",onClick:s,isDisabled:Object(Ht.isEmpty)(null==e?void 0:e.replacements)}))),Object(S.jsx)(ae.EuiFlexItem,null,Object(S.jsx)(ae.EuiPopover,{button:Object(S.jsx)(ae.EuiButtonIcon,{"aria-label":"test",iconType:"boxesVertical",onClick:k,"data-test-subj":"chat-context-menu"}),isOpen:x,closePopover:C,panelPaddingSize:"none",anchorPosition:"downLeft"},Object(S.jsx)(ae.EuiContextMenu,{initialPanelId:0,panels:P}))))))),T&&Object(S.jsx)(ae.EuiConfirmModal,{title:Pi,onCancel:I,onConfirm:D,cancelButtonText:Ri,confirmButtonText:Ni,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"reset-conversation-modal"},Object(S.jsx)("p",null,zi)))};var Vi=n(1867),$i=n(578);const Ui=Ut()("div",{target:"e1jrsrrx2"})("display:inline-block;position:relative;width:56px;height:56px;display:flex;justify-content:center;align-items:center;margin-top:",Gt.euiThemeVars.euiSizeXXL,";margin-bottom:",Gt.euiThemeVars.euiSizeL,";:before,:after{content:'';position:absolute;}"),Gi=Ut()("div",{target:"e1jrsrrx1"})("width:99%;height:99%;border-radius:50px;z-index:1;position:relative;&:before,&:after{content:'';position:absolute;width:100%;height:100%;border:inherit;top:0;left:0;z-index:0;border:1px solid ",Gt.euiThemeVars.euiColorPrimary,";border-radius:inherit;animation:4s cubic-bezier(0.42, 0, 0.37, 1) 0.5s infinite normal none running pulsing;}&:after{animation:4s cubic-bezier(0.42, 0, 0.37, 1) 0.5s infinite normal none running pulsing1;}@keyframes pulsing{0%{opacity:1;transform:scaleY(1) scaleX(1);}20%{opacity:0.5;}70%{opacity:0.2;transform:scaleY(2) scaleX(2);}80%{opacity:0;transform:scaleY(2) scaleX(2);}90%{opacity:0;transform:scaleY(1) scaleX(1);}}@keyframes pulsing1{0%{opacity:1;transform:scaleY(1) scaleX(1);}15%{opacity:1;transform:scaleY(1) scaleX(1);}40%{opacity:0.5;}70%{opacity:0.2;transform:scaleY(1.5) scaleX(1.5);}80%{opacity:0;transform:scaleY(1.5) scaleX(1.5);}90%{opacity:0;transform:scaleY(1) scaleX(1);}}"),Hi=Ut()("span",{target:"e1jrsrrx0"})({name:"hh9did",styles:"width:100%;height:100%;position:absolute;top:0;left:0;z-index:2;background:#fff;display:flex;align-items:center;justify-content:center;border-radius:50%;:before,:after{content:'';position:absolute;}"}),Qi=i.a.memo((()=>Object(S.jsx)(Ui,null,Object(S.jsx)(Gi,null),Object(S.jsx)(Hi,null,Object(S.jsx)(at.a,{size:"m"})))));Qi.displayName="AssistantAnimatedIcon";const Wi="esql",Ki=i.a.memo((()=>{const{http:e,toasts:t}=Object(nt.b)(),{data:n}=Object(di.b)({http:e,resource:Wi}),{mutate:i,isLoading:r}=Object(mi.a)({http:e,toasts:t}),s=(null==n?void 0:n.is_setup_in_progress)||r,o=(null==n?void 0:n.elser_exists)&&(null==n?void 0:n.index_exists)&&(null==n?void 0:n.pipeline_exists)&&(null==n?void 0:n.esql_exists),l=Object(a.useCallback)((()=>{i(Wi)}),[i]);if(o)return null;const u=null!=n&&n.is_setup_available?void 0:B.i18n.translate("xpack.elasticAssistant.knowledgeBase.installKnowledgeBaseButtonToolTip",{defaultMessage:"Knowledge Base unavailable, please see documentation for more details."});return Object(S.jsx)(ae.EuiToolTip,{position:"bottom",content:u},Object(S.jsx)(ae.EuiButton,{color:"primary","data-test-subj":"setup-knowledge-base-button",fill:!0,disabled:!(null!=n&&n.is_setup_available),isLoading:s,iconType:"importAction",onClick:l},B.i18n.translate("xpack.elasticAssistant.knowledgeBase.installKnowledgeBaseButton",{defaultMessage:"Setup Knowledge Base"})))}));Ki.displayName="SetupKnowledgeBaseButton";const Ji=Ut()("span",{target:"efzts870"})({name:"1dd35ky",styles:"display:flex;flex:1;overflow:hidden"});var Yi={name:"1qmr6ab",styles:"overflow:auto"},Xi={name:"13yqj0e",styles:"min-height:100px;flex:1;>div{display:flex;flex-direction:column;align-items:stretch;>.euiFlyoutBody__banner{overflow-x:unset;}>.euiFlyoutBody__overflowContent{display:flex;flex:1;overflow:auto;}}"},Zi={name:"qhxz92",styles:"max-width:100%"},er={name:"d3v9zr",styles:"overflow:hidden"},tr={name:"d3v9zr",styles:"overflow:hidden"},nr={name:"b60aq9",styles:"max-width:400px;text-align:center"},ar={name:"b60aq9",styles:"max-width:400px;text-align:center"};const ir=({conversationTitle:e,embeddedLayout:t=!1,promptContextId:n="",shouldRefocusPrompt:s=!1,showTitle:o=!0,setConversationTitle:l,onCloseFlyout:u,chatHistoryVisible:c,setChatHistoryVisible:d,currentUserAvatar:m})=>{var p,f;const{assistantTelemetry:b,augmentMessageCodeBlocks:g,assistantAvailability:{isAssistantEnabled:v},getComments:y,http:h,promptContexts:j,setLastConversationId:O,getLastConversationId:E,baseConversations:x}=Object(nt.b)(),{getDefaultConversation:w,getConversation:k,deleteConversation:C,setApiConfig:T,createConversation:M}=Object(Jt.a)(),[I,_]=Object(a.useState)({}),A=Object(a.useMemo)((()=>Object.keys(I).length),[I]),P=Object(a.useCallback)((e=>Object(an.e)(x,e)),[x]),[D,F]=Object(a.useState)(!1),{data:N,isLoading:z,refetch:L,isFetched:B}=Object(Vi.b)({http:h,onFetch:P,refetchOnWindowFocus:!D,isAssistantEnabled:v}),{data:q,isLoading:V,isError:$,isFetched:U}=Object(oa.a)(),{data:{data:G},refetch:H,isLoading:Q}=Object(Oi.b)(),W=Object(a.useMemo)((()=>Q?[]:G.filter((e=>e.promptType===Wt.a.system))),[G,Q]),{data:K,isFetchedAfterMount:J}=Object(_n.a)({http:h}),Y=Object(a.useMemo)((()=>Object(an.b)(K)),[K]),[X,Z]=Object(a.useState)(),[ee,te]=Object(a.useState)();Object(a.useEffect)((()=>{l&&null!=ee&&ee.title&&l(null==ee?void 0:ee.title)}),[null==ee?void 0:ee.title,l]);const ne=Object(a.useCallback)((async({cId:e,cTitle:t,isStreamRefetch:n=!1}={})=>{var a;if(""===e||t&&!N[t])return;const i=null!==(a=null!=e?e:t&&N[t].id)&&void 0!==a?a:null==ee?void 0:ee.id;if(i){let e=await k(i),t=0;const a=5;for(;n&&e&&"assistant"!==e.messages[e.messages.length-1].role&&t<a;)t++,await Object(an.f)(2e3),e=await k(i);return e&&te(e),e}}),[N,null==ee?void 0:ee.id,k]);Object(a.useEffect)((()=>{J&&B&&Object.keys(N).length>0&&te((t=>{var n,a,i;const r=X&&N[X]||v&&(N[E(e)]||Object(Ht.find)(N,["title",E(e)]))||Object(Ht.find)(N,["title",E(On.b)]);if(R()(t,r))return t;const s=null!==(n=null!==(a=r&&N[""!==(null==r?void 0:r.id)?null==r?void 0:r.id:null==r?void 0:r.title])&&void 0!==a?a:N[On.b])&&void 0!==n?n:w({cTitle:On.b});return Se(null===(i=Object(rn.d)({allSystemPrompts:W,conversation:s}))||void 0===i?void 0:i.id),t&&t.id===s.id&&t.messages.length>s.messages.length?{...s,messages:t.messages}:s}))}),[W,J,e,N,B,X,w,E,v]);const ie=Object(a.useMemo)((()=>{var e;return!Object.keys(N).some((e=>{var t,n;return null!=(null===(t=N[e])||void 0===t||null===(n=t.apiConfig)||void 0===n?void 0:n.connectorId)}))&&0===(null!==(e=null==K?void 0:K.length)&&void 0!==e?e:0)}),[null==K?void 0:K.length,N]),re=ie||!v,se=Object(a.useMemo)((()=>ee&&Object(an.a)(ee,v)),[ee,v]),[oe,le]=Object(a.useState)(!1);Object(a.useEffect)((()=>{if(J&&(null==K||!K.length))return O(On.b);null!=ee&&ee.excludeFromLastConversationStorage||O(Object(Ht.isEmpty)(null==ee?void 0:ee.id)?null==ee?void 0:ee.title:null==ee?void 0:ee.id)}),[J,null==K?void 0:K.length,N,ee,z,O]);const[ue,ce]=Object(a.useState)(!1),[de,me]=Object(a.useState)(null),[pe,fe]=Object(a.useState)(!1),[be,ge]=Object(a.useState)(),[ve,ye]=Object(a.useState)(!1);Object(a.useLayoutEffect)((()=>{ee&&setTimeout((()=>{ge(g(ee,pe))}),0)}),[g,ee,pe]);const he=Object(a.useMemo)((()=>{var e;return!(z||!J||""===(null==ee?void 0:ee.id)||null!=ee&&null!==(e=ee.apiConfig)&&void 0!==e&&e.connectorId&&null!=K&&K.some((e=>{var t;return e.id===(null===(t=ee.apiConfig)||void 0===t?void 0:t.connectorId)})))}),[J,K,null==ee||null===(p=ee.apiConfig)||void 0===p?void 0:p.connectorId,null==ee?void 0:ee.id,z]),je=Object(a.useMemo)((()=>re||he),[he,re]);Object(a.useEffect)((()=>{const e=()=>{const e=document.querySelectorAll(".euiCodeBlock__controls");ye(e.length>0)};e();const t=new MutationObserver(e);return t.observe(document.body,{subtree:!0,childList:!0}),()=>{t.disconnect()}}),[]);const Oe=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t,n;const a=null===(e=Oe.current)||void 0===e?void 0:e.parentElement;a&&(a.scrollTop=a.scrollHeight,null===(t=(null===(n=Oe.current)||void 0===n?void 0:n.childNodes[0].childNodes[0]).lastElementChild)||void 0===t||t.scrollIntoView())}));const Ee=Object(a.useMemo)((()=>Object(rn.d)({allSystemPrompts:W,conversation:ee})),[W,ee]),[xe,Se]=Object(a.useState)(null==Ee?void 0:Ee.id),we=Object(a.useCallback)((async({cId:e,cTitle:t})=>{var n;const a=await L();let i;var r;""===e?(Z(t),i=null==a||null===(r=a.data)||void 0===r?void 0:r[t],Z(t)):(i=await ne({cId:e}),Z(e)),Se(null===(n=Object(rn.d)({allSystemPrompts:W,conversation:i}))||void 0===n?void 0:n.id)}),[W,ne,L]),ke=Object(a.useCallback)((async e=>{await C(N[e].id),await L()}),[N,C,L]),Ce=Object(a.useCallback)((e=>{Se(e)}),[]);[...document.getElementsByClassName("euiCodeBlock")].forEach((e=>e.style.minHeight="75px"));const Te=Object(a.useCallback)((()=>{fe((e=>!e))}),[fe]),Me=Object(a.useMemo)((()=>0===(null==ee?void 0:ee.messages.length)),[null==ee?void 0:ee.messages.length]);Object(a.useEffect)((()=>{if(null!=ee&&ee.messages.length||e!==(null==ee?void 0:ee.title))return;if(ue)return;const t=j[n];null!=t&&!V&&!$&&U&&q&&(ce(!0),Object.keys(I).includes(t.id)||(async()=>{const e=await En({anonymizationFields:q,promptContext:t});_((n=>({...n,[t.id]:e})))})(),null!=t.suggestedUserPrompt&&me(t.suggestedUserPrompt))}),[null==ee?void 0:ee.messages,j,n,e,null==ee?void 0:ee.title,I,ue,V,$,q,U]);const Ie=Object(a.useCallback)((()=>null==be?void 0:be.map(((e,t)=>Object(S.jsx)("span",{key:`${t}`},e.map(((e,n)=>{const a=e.getControlContainer,s=null==a?void 0:a();return Object(S.jsx)("span",{key:`${t}+${n}`},s?Object(r.createPortal)(e.button,s):Object(S.jsx)(i.a.Fragment,null))})))))),[be]),{abortStream:_e,handleOnChatCleared:Ae,handlePromptChange:Pe,handleSendMessage:De,handleRegenerateResponse:Fe,isLoading:Re}=sn({allSystemPrompts:W,currentConversation:ee,setUserPrompt:me,editingSystemPromptId:xe,http:h,setEditingSystemPromptId:Se,selectedPromptContexts:I,setSelectedPromptContexts:_,setCurrentConversation:te}),Ne=Object(a.useCallback)((async()=>{await Ae(),await L()}),[Ae,L]),ze=Object(a.useCallback)((async e=>{await De(e),(null==ee?void 0:ee.title)===zn&&await L()}),[ee,De,L]),Le=Object(a.useMemo)((()=>Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiCommentList,{comments:y({abortStream:_e,currentConversation:ee,showAnonymizedValues:pe,refetchCurrentConversation:ne,regenerateMessage:Fe,isFetchingResponse:Re,setIsStreaming:F,currentUserAvatar:m}),css:Object(S.css)("padding-bottom:",Gt.euiThemeVars.euiSizeL,";>li>div:nth-child(2){overflow:hidden;}","")}),0!==(null==ee?void 0:ee.messages.length)&&A>0&&Object(S.jsx)(ae.EuiSpacer,{size:"m"}))),[y,_e,ee,pe,ne,Fe,Re,m,A]),Be=Object(a.useCallback)((e=>{null!=ee&&ee.title&&(null==b||b.reportAssistantQuickPrompt({conversationId:null==ee?void 0:ee.title,promptTitle:e}))}),[b,null==ee?void 0:ee.title]),qe=Object(a.useCallback)((async()=>{await L()}),[L]),Ve=Object(Qt.useQueryClient)(),{mutateAsync:$e}=Object(Qt.useMutation)(["SET_DEFAULT_CONNECTOR"],{mutationFn:async e=>{var t,n,a;const i=Object($i.c)(Y);return T({conversation:e,apiConfig:{...null==e?void 0:e.apiConfig,connectorId:null!==(t=null==Y?void 0:Y.id)&&void 0!==t?t:"",actionTypeId:null!==(n=null==Y?void 0:Y.actionTypeId)&&void 0!==n?n:".gen-ai",provider:null==i?void 0:i.apiProvider,model:null==i?void 0:i.defaultModel,defaultSystemPromptId:null===(a=W.find((e=>e.isNewConversationDefault)))||void 0===a?void 0:a.id}})},onSuccess:async e=>(await Ve.cancelQueries({queryKey:Vi.a}),e&&Ve.setQueryData(Vi.a,(t=>{var n;return{...null!=t?t:{},data:Object(Ht.uniqBy)([e,...null!==(n=null==t?void 0:t.data)&&void 0!==n?n:[]],"id")}})),e)});Object(a.useEffect)((()=>{(async()=>{if(J&&""===(null==ee?void 0:ee.id)&&!Q){const e=await $e(ee);""===ee.id&&e&&Z(e.id)}})()}),[J,ee,Q,$e]);const Ue=Object(a.useCallback)((async()=>{const e=Object(Ht.find)(N,["title",zn]);if(e&&!e.messages.length)return void we({cId:e.id,cTitle:e.title});const t=await M({title:zn,apiConfig:null==ee?void 0:ee.apiConfig});await qe(),t&&we({cId:t.id,cTitle:t.title})}),[N,M,null==ee?void 0:ee.apiConfig,we,qe]),Ge=Object(a.useMemo)((()=>Me&&Object(S.jsx)(ae.EuiText,{"data-test-subj":"assistant-disclaimer",textAlign:"center",color:Gt.euiThemeVars.euiColorMediumShade,size:"xs",css:Object(S.css)("margin:0 ",Gt.euiThemeVars.euiSizeL," ",Gt.euiThemeVars.euiSizeM," ",Gt.euiThemeVars.euiSizeL,";","")},on.c)),[Me]),He=Object(a.useMemo)((()=>ie?Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,css:ar},Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center",justifyContent:"center",direction:"column"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(Qi,null)),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiText,null,Object(S.jsx)("h3",null,on.h))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiText,{color:"subdued"},Object(S.jsx)("p",null,on.g))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1,"data-test-subj":"connector-prompt"},Object(S.jsx)(An.a,{conversation:se,onConversationUpdate:we})))))):0===(null==ee?void 0:ee.messages.length)?Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,css:nr},Object(S.jsx)(ae.EuiFlexGroup,{alignItems:"center",justifyContent:"center",direction:"column"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(Qi,null)),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(ae.EuiText,null,Object(S.jsx)("h3",null,on.e),Object(S.jsx)("p",null,on.d))),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(Xn,{conversation:ee,editingSystemPromptId:xe,onSystemPromptSelectionChange:Ce,isSettingsModalVisible:oe,setIsSettingsModalVisible:le,allSystemPrompts:W,refetchConversations:L})),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(Ki,null)))))):Object(S.jsx)(ae.EuiPanel,{hasShadow:!1,panelRef:e=>{Oe.current=(null==e?void 0:e.parentElement)||null}},Le)),[W,se,Le,ee,xe,we,Ce,oe,ie,L]);return Object(S.jsx)(ae.EuiFlexGroup,{direction:"row",wrap:!1,gutterSize:"none"},c&&Object(S.jsx)(ae.EuiFlexItem,{grow:!1,css:Object(S.css)("inline-size:",220,"px;border-right:1px solid ",Gt.euiThemeVars.euiColorLightShade,";","")},Object(S.jsx)(Kn,{currentConversation:ee,onConversationSelected:we,conversations:N,onConversationDeleted:ke,onConversationCreate:Ue,refetchConversationsState:qe})),Object(S.jsx)(ae.EuiFlexItem,{css:tr},Object(S.jsx)(Ji,null,Object(S.jsx)(ae.EuiFlexGroup,{css:er},Object(S.jsx)(ae.EuiFlexItem,{css:Zi},Object(S.jsx)(ae.EuiFlyoutHeader,{hasBorder:!0},Object(S.jsx)(qi,{selectedConversation:ee,defaultConnector:Y,isDisabled:re||Re,isSettingsModalVisible:oe,onToggleShowAnonymizedValues:Te,setIsSettingsModalVisible:le,showAnonymizedValues:pe,onCloseFlyout:u,onChatCleared:Ne,chatHistoryVisible:c,setChatHistoryVisible:d,onConversationSelected:we,conversations:N,conversationsLoaded:B,refetchConversationsState:qe,onConversationCreate:Ue,isAssistantEnabled:v,refetchPrompts:H}),Ie()),Object(S.jsx)(ae.EuiFlyoutBody,{css:Xi,banner:!re&&he&&J&&Object(S.jsx)(Rn,{isConnectorConfigured:(null!==(f=null==K?void 0:K.length)&&void 0!==f?f:0)>0,isSettingsModalVisible:oe,setIsSettingsModalVisible:le})},v?Object(S.jsx)(ae.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween"},Object(S.jsx)(ae.EuiFlexItem,{grow:!1},He),Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Ge)):Object(S.jsx)(jn,{connectorPrompt:Object(S.jsx)(An.a,{conversation:se,onConversationUpdate:we}),http:h,isAssistantEnabled:v,isWelcomeSetup:ie})),Object(S.jsx)(ae.EuiFlyoutFooter,{css:Object(S.css)("background:none;border-top:1px solid ",Gt.euiThemeVars.euiColorLightShade,";overflow:hidden;max-height:60%;display:flex;flex-direction:column;","")},Object(S.jsx)(ae.EuiPanel,{paddingSize:"m",hasShadow:!1,css:Yi},!re&&Object.keys(j).length!==A&&Object(S.jsx)(ae.EuiFlexGroup,null,Object(S.jsx)(ae.EuiFlexItem,null,Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(Sn,{anonymizationFields:q,promptContexts:j,selectedPromptContexts:I,setSelectedPromptContexts:_}),Object.keys(j).length>0&&Object(S.jsx)(ae.EuiSpacer,{size:"s"})))),Object(S.jsx)(ae.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object.keys(I).length?Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(Ta,{promptContexts:j,selectedPromptContexts:I,setSelectedPromptContexts:_,currentReplacements:null==ee?void 0:ee.replacements})):null,Object(S.jsx)(ae.EuiFlexItem,{grow:!1},Object(S.jsx)(fn,{isDisabled:je,shouldRefocusPrompt:s,userPrompt:de,handlePromptChange:Pe,handleSendMessage:ze,handleRegenerateResponse:Fe,isLoading:Re})))),!re&&Object(S.jsx)(ae.EuiPanel,{css:Object(S.css)("background:",Gt.euiThemeVars.euiColorLightestShade,";",""),hasShadow:!1,paddingSize:"m",borderRadius:"none"},Object(S.jsx)(In,{setInput:me,setIsSettingsModalVisible:le,trackPrompt:Be,allPrompts:G}))))))))};ir.displayName="AssistantComponent";const rr=i.a.memo(ir),sr=navigator.platform.toLowerCase().indexOf("mac")>=0,or=oe.createGlobalStyle`
  body:has(.timeline-portal-overlay-mask) .euiOverlayMask {
    z-index: 1003 !important;
  }
`;var lr={name:"7kmeoc",styles:"max-inline-size:calc(100% - 20px);min-inline-size:400px;>div{height:100%;}"};const ur=i.a.memo((({currentUserAvatar:e})=>{const[t,n]=Object(a.useState)(!1),[r,s]=Object(a.useState)(On.b),[o,l]=Object(a.useState)(),{assistantTelemetry:u,setShowAssistantOverlay:c,getLastConversationId:d}=Object(nt.b)(),[m,p]=Object(a.useState)(!1),f=Object(a.useCallback)((()=>({showOverlay:e,promptContextId:t,conversationTitle:a})=>{const i=d(a);e&&(null==u||u.reportAssistantInvoked({conversationId:i,invokedBy:"click"})),n(e),l(t),s(i)}),[u,d]);Object(a.useEffect)((()=>{c(f)}),[c,f]);const b=Object(a.useCallback)((()=>{t||(s(d()),null==u||u.reportAssistantInvoked({invokedBy:"shortcut",conversationId:d()})),n(!t)}),[t,d,u]),g=Object(a.useCallback)((e=>{";"===e.key&&(sr?e.metaKey:e.ctrlKey)&&(e.preventDefault(),b())}),[b]);Vt()("keydown",g);const v=Object(a.useCallback)((()=>{n(!1),l(void 0),s(r)}),[r]),y=Object(a.useCallback)((()=>{v()}),[v]),h=Object(a.useCallback)((()=>{p((e=>{if(null!=j&&j.current){const t=parseInt(j.current.style.inlineSize.split("px")[0],10);j.current.style.inlineSize=`${e?t-220:t+220}px`}return!e}))}),[]),j=Object(a.useRef)();return t?Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(ae.EuiFlyoutResizable,{ref:j,css:lr,onClose:y,"data-test-subj":"ai-assistant-flyout",paddingSize:"none",hideCloseButton:!0},Object(S.jsx)(rr,{conversationTitle:r,promptContextId:o,onCloseFlyout:y,chatHistoryVisible:m,setChatHistoryVisible:h,currentUserAvatar:e})),Object(S.jsx)(or,null)):null}));ur.displayName="AssistantOverlay";const cr=()=>{const{services:e}=Object(O.j)(),{data:t}=Object(Qt.useQuery)({queryKey:["currentUserAvatar"],queryFn:()=>{var t;return null===(t=e.security)||void 0===t?void 0:t.userProfiles.getCurrent({dataPath:"avatar"})},select:e=>e.data.avatar,keepPreviousData:!0,refetchOnWindowFocus:!1}),{assistantAvailability:n}=Object(nt.b)();return n.hasAssistantPrivilege?i.a.createElement(ur,{currentUserAvatar:t}):null};var dr=n(166),mr=n(127),pr=n(149),fr=n(531),br=n(123),gr=n(864),vr=n(294),yr=n(189);const hr=({children:e})=>{const{pathname:t}=Object(E.useLocation)();((e=mr.SourcererScopeName.default)=>{const t=Object(s.useDispatch)(),{data:{dataViews:n}}=Object(O.j)().services,i=Object(a.useRef)(new AbortController),r=Object(a.useRef)(!0),o=Object(a.useRef)(!0),{loading:l,isSignalIndexExists:u,signalIndexName:c}=Object(m.c)(),d=Object(yr.d)(mt.a.sourcerer),p=Object(s.useSelector)(dr.d.signalIndexName),b=Object(s.useSelector)(dr.d.defaultDataView),{addError:g,addWarning:v}=Object(br.a)();Object(a.useEffect)((()=>{null!=b.error&&v({title:B.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:B.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[v,b.error]);const y=Object(a.useMemo)((()=>z.b.getTimelineByIdSelector()),[]),h=Object(f.a)((e=>y(e,pr.f.active))),j=Object(s.useSelector)((t=>dr.d.sourcererScopeSelectedDataViewId(t,e))),E=Object(s.useSelector)((t=>dr.d.sourcererScopeSelectedPatterns(t,e))),x=Object(s.useSelector)((t=>dr.d.sourcererScopeMissingPatterns(t,e))),S=Object(s.useSelector)(dr.d.kibanaDataViews),w=Object(s.useSelector)((e=>dr.d.sourcererScopeSelectedDataViewId(e,mr.SourcererScopeName.timeline))),k=Object(s.useSelector)((e=>dr.d.sourcererScopeSelectedPatterns(e,mr.SourcererScopeName.timeline))),C=Object(s.useSelector)((e=>dr.d.sourcererScopeMissingPatterns(e,mr.SourcererScopeName.timeline))),T=Object(a.useMemo)((()=>S.find((e=>e.id===w))),[S,w]),{indexFieldsSearch:M}=Object(vr.b)(),I=Object(a.useCallback)((n=>{null!=n?Object.keys(n).forEach((a=>{var i,r,s,o;a===mr.SourcererScopeName.default&&e===mr.SourcererScopeName.detections||t(dr.a.setSelectedDataView({id:a,selectedDataViewId:null!==(i=null===(r=n[a])||void 0===r?void 0:r.id)&&void 0!==i?i:null,selectedPatterns:null!==(s=null===(o=n[a])||void 0===o?void 0:o.selectedPatterns)&&void 0!==s?s:[]}))})):j&&d({[mr.SourcererScopeName.default]:{id:j,selectedPatterns:E}})}),[t,j,e,E,d]);Object(yr.b)(mt.a.sourcerer,I);const _=Object(a.useRef)([]);Object(a.useEffect)((()=>{[...new Set([j,w])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!_.current.includes(e)){_.current=[..._.current,e];const n=0===t?mr.SourcererScopeName.default:mr.SourcererScopeName.timeline,a=e===j?0===E.length&&0===x.length:w===e&&0===C.length&&0===(null==T?void 0:T.patternList.length);M({dataViewId:e,scopeId:n,needToBeInit:a,...a&&n===mr.SourcererScopeName.timeline?{skipScopeUpdate:k.length>0}:{}})}}))}),[M,x.length,j,E.length,w,C.length,T,k.length]),Object(a.useEffect)((()=>{!l&&null!=c&&null==p&&(null==h||null==h.savedObjectId)&&r.current&&b.id.length>0?(r.current=!1,t(dr.a.setSelectedDataView({id:mr.SourcererScopeName.timeline,selectedDataViewId:b.id,selectedPatterns:Object(fr.b)(b,mr.SourcererScopeName.timeline,c,!0)})),t(dr.a.setSelectedDataView({id:mr.SourcererScopeName.analyzer,selectedDataViewId:b.id,selectedPatterns:Object(fr.b)(b,mr.SourcererScopeName.analyzer,c,!0)}))):null!=p&&(null==h||null==h.savedObjectId)&&r.current&&b.id.length>0&&(r.current=!1,t(dr.a.setSelectedDataView({id:mr.SourcererScopeName.timeline,selectedDataViewId:b.id,selectedPatterns:Object(fr.b)(b,mr.SourcererScopeName.timeline,p,!0)})),t(dr.a.setSelectedDataView({id:mr.SourcererScopeName.analyzer,selectedDataViewId:b.id,selectedPatterns:Object(fr.b)(b,mr.SourcererScopeName.analyzer,p,!0)})))}),[h,b,t,l,c,p]);const{dataViewId:A}=Object(ne.a)(e),P=Object(a.useCallback)((e=>{-1===b.title.indexOf(e)&&(i.current.abort(),(async a=>{i.current=new AbortController,t(dr.a.setSourcererScopeLoading({loading:!0}));try{const r=await Object(gr.a)({body:{patternList:a},signal:i.current.signal,dataViewService:n,dataViewId:A});null!=r&&r.defaultDataView.patternList.includes(e)&&(M({dataViewId:r.defaultDataView.id}),t(dr.a.setSourcererDataViews(r))),t(dr.a.setSourcererScopeLoading({loading:!1}))}catch(e){"AbortError"===e.name||g(e,{title:B.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:B.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(dr.a.setSourcererScopeLoading({loading:!1}))}})([...b.title.split(","),e]))}),[b.title,t,n,A,M,g]),D=Object(a.useCallback)((()=>{!l&&null!=c&&null==p&&b.id.length>0&&(P(c),t(dr.a.setSignalIndexName({signalIndexName:c})))}),[b.id.length,t,l,c,p,P]);Object(a.useEffect)((()=>{D()}),[c]),Object(a.useEffect)((()=>{e===mr.SourcererScopeName.detections&&u&&null!=c&&o.current&&b.id.length>0?(o.current=!1,t(dr.a.setSelectedDataView({id:mr.SourcererScopeName.detections,selectedDataViewId:b.id,selectedPatterns:Object(fr.b)(b,mr.SourcererScopeName.detections,c,!0)}))):e===mr.SourcererScopeName.detections&&null!=p&&r.current&&b.id.length>0&&(o.current=!1,dr.a.setSelectedDataView({id:mr.SourcererScopeName.detections,selectedDataViewId:b.id,selectedPatterns:Object(fr.b)(b,mr.SourcererScopeName.detections,p,!0)}))}),[b,t,u,e,c,p])})(Object(te.a)(t)),Object(mt.b)(),(()=>{const e=(e=>{const{getAppUrl:t}=Object(O.c)(),n=Object(O.d)(),{pathname:i}=Object(E.useLocation)(),r=Object(a.useCallback)((e=>{const{appId:a,deepLinkId:r}=Object(ft.a)(e.id),s=t({appId:a,deepLinkId:r});return!!Object(E.matchPath)(`${n}${bt.APP_PATH}${i}`,{path:s,strict:!1})}),[n,t,i]);return Object(a.useMemo)((()=>gt(r,e)),[e,r])})(Object(pt.c)());Object(a.useEffect)((()=>{var t;document.title=`${null!==(t=null==e?void 0:e.title)&&void 0!==t?t:""} - Kibana`}),[e])})(),Object(vt.a)();const{browserFields:n}=Object(ne.a)(Object(te.a)(t));return Object(yt.b)(),Object(ht.g)(),i.a.createElement(X.h,{id:"security-solution-app",className:"kbnAppWrapper"},i.a.createElement(ct.a,null,i.a.createElement(dt.a,null,i.a.createElement(i.a.Fragment,null,i.a.createElement(ut,null),i.a.createElement(K,{browserFields:n},e),i.a.createElement(ee,null),i.a.createElement(Bt,null),i.a.createElement(cr,null)))))};hr.displayName="HomePage";const jr=i.a.memo(hr),Or=({children:e,history:t})=>{const{cases:n}=Object(O.j)().services,r=n.ui.getCasesContext(),o=n.helpers.canUseCases([p.j]),l=Object(s.useDispatch)();return Object(a.useEffect)((()=>()=>{l({type:"userChangedUrl",payload:{pathname:"",search:"",hash:""}})}),[l]),i.a.createElement(_,null,i.a.createElement(w,{history:t},i.a.createElement(T.a,null,i.a.createElement(k.a,null,i.a.createElement(C.b,{path:"/"},i.a.createElement(r,{owner:[p.j],permissions:o},i.a.createElement(jr,null,e))),i.a.createElement(C.b,null,i.a.createElement(A.a,null))))))},Er=Object(a.memo)(Or);var xr=n(739),Sr=n(1385),wr=n(897),kr=n(1218),Cr=n(1549);const Tr=B.i18n.translate("xpack.securitySolution.timelines.discoverInTimeline.save_saved_search_error",{defaultMessage:"Error while saving the Discover search"}),Mr=B.i18n.translate("xpack.securitySolution.timelines.discoverInTimeline.save_saved_search_unknown_error",{defaultMessage:"Unknown error occurred while saving Discover search"}),Ir={from:"now-15m",to:"now",mode:"relative"},_r=e=>{const t=Object(a.useRef)(),n=(e=>{const{setDiscoverAppState:t}=Object(kr.a)(),{addError:n}=Object(br.a)(),{services:{customDataService:i,savedSearch:r}}=Object(O.j)(),o=Object(s.useDispatch)(),l=Object(a.useMemo)((()=>z.b.getTimelineByIdSelector()),[]),u=Object(f.b)((e=>{var t;return null!==(t=l(e,pr.f.active))&&void 0!==t?t:U.b})),{savedSearchId:c,version:d}=u,m=Object(a.useRef)(u);m.current=u;const p=Object(Qt.useQueryClient)(),{mutateAsync:b,status:g}=Object(Qt.useMutation)({mutationFn:({savedSearch:e,savedSearchOptions:t})=>r.save(e,t),onSuccess:e=>{e&&o(z.a.endTimelineSaving({id:pr.f.active})),p.invalidateQueries({queryKey:["savedSearchById",c]})},mutationKey:[d]}),v=Object(a.useCallback)((t=>{var n;return{savedSearch:t,appState:null===(n=e.current)||void 0===n?void 0:n.appState.getAppStateFromSavedSearch(t)}}),[e]),y=Object(a.useCallback)((async n=>{if(n&&e.current){let d;try{var a,i,r,s,o,l,u,c;d=await(null===(a=e.current)||void 0===a?void 0:a.savedSearchState.load(n));const m=d?v(d):null;null===(i=e.current)||void 0===i||i.appState.initAndSync(d),await(null===(r=e.current)||void 0===r?void 0:r.appState.replaceUrlState(null!==(s=null==m?void 0:m.appState)&&void 0!==s?s:{})),t(null!==(o=null==m?void 0:m.appState)&&void 0!==o?o:{query:{esql:""},sort:[["@timestamp","desc"]],columns:[],interval:"auto",filters:[],hideChart:!0,grid:{}}),null===(l=e.current)||void 0===l||l.globalState.set({...null===(u=e.current)||void 0===u?void 0:u.globalState.get(),time:null!==(c=d.timeRange)&&void 0!==c?c:Ir})}catch(e){}}else{var d,m,p,f;const n={query:{esql:""},sort:[["@timestamp","desc"]],columns:[],interval:"auto",filters:[],hideChart:!0,grid:{}};null===(d=e.current)||void 0===d||d.appState.resetToState(n),await(null===(m=e.current)||void 0===m?void 0:m.appState.replaceUrlState({})),t(n),null===(p=e.current)||void 0===p||p.globalState.set({...null===(f=e.current)||void 0===f?void 0:f.globalState.get(),time:Ir})}}),[e,v,t]),h=Object(a.useCallback)((async(t,a)=>{if(e){if(t)try{const e=await b({savedSearch:t,savedSearchOptions:a});if(e)return{id:e};n(Mr,{title:Tr})}catch(e){n(e,{title:Tr})}}else console.log("Saved search is not open since state container is null")}),[n,e,b]),j=Object(a.useCallback)((async(e,t,n)=>{var a;if(e.timeRestore=!0,e.timeRange=null!==(a=e.timeRange)&&void 0!==a?a:i.query.timefilter.timefilter.getTime(),e.tags=["security-solution-default"],c)e.id=c,m.current.savedSearch?Object(Ht.isEqualWith)(m.current.savedSearch,e,Cr.a)||o(z.a.updateSavedSearch({id:pr.f.active,savedSearch:e})):o(z.a.initializeSavedSearch({id:pr.f.active,savedSearch:e}));else try{if("loading"===g)return;o(z.a.startTimelineSaving({id:pr.f.active}));const t=await h(e,{onTitleDuplicate:()=>{},copyOnSave:!c}),a=!t||!(null!=t&&t.id);if(a)throw new Error("Response is empty");c||a||(o(z.a.updateSavedSearchId({id:pr.f.active,savedSearchId:t.id})),o(z.a.saveTimeline({id:pr.f.active,saveAsNew:!1})),null==n||n())}catch(e){o(z.a.endTimelineSaving({id:pr.f.active}))}}),[h,c,o,i,g]),E=Object(a.useCallback)((async(e,t)=>{o(z.a.initializeSavedSearch({id:pr.f.active,savedSearch:e}))}),[o]);return Object(a.useMemo)((()=>({resetDiscoverAppState:y,updateSavedSearch:j,initializeLocalSavedSearch:E,getAppStateFromSavedSearch:v,defaultDiscoverAppState:{query:{esql:""},sort:[["@timestamp","desc"]],columns:[],interval:"auto",filters:[],hideChart:!0,grid:{}}})),[y,j,E,v])})(t),r=Object(a.useCallback)((e=>{t.current=e}),[]);return i.a.createElement(wr.a.Provider,{value:{discoverStateContainer:t,setDiscoverStateContainer:r,...n}},e.children)};var Ar=n(63),Pr=n(1544),Dr=n(1543),Fr=n(2082),Rr=n(86),Nr=n(1386),zr=n(178),Lr=n(197);const Br=B.i18n.translate("xpack.securitySolution.assistant.conversations.timelineConversationTitle",{defaultMessage:"Timeline"}),qr={[Lr.e]:{id:"",title:Lr.e,category:"assistant",isDefault:!0,messages:[],replacements:{}},[Nr.a]:{id:"",title:Nr.a,category:"assistant",isDefault:!0,messages:[],replacements:{}},[zr.Qb]:{id:"",title:zr.Qb,category:"assistant",isDefault:!0,messages:[],replacements:{}},[Lr.i]:{id:"",title:Lr.i,category:"assistant",isDefault:!0,messages:[],replacements:{}},[Br]:{excludeFromLastConversationStorage:!0,id:"",title:Br,category:"assistant",isDefault:!0,messages:[],replacements:{}},[On.b]:{id:"",title:On.b,category:"assistant",isDefault:!0,messages:[],replacements:{}}};var Vr=n(21);const $r=()=>{const e=Object(Vr.f)(bt.SecurityPageName.dataQuality);return Object(a.useMemo)((()=>e?qr:Object(P.unset)(Nr.a,qr)),[e])};var Ur=n(119),Gr=n.n(Ur),Hr=n(448),Qr=n.n(Hr),Wr=n(3);const Kr=B.i18n.translate("xpack.securitySolution.assistant.getComments.assistant",{defaultMessage:"Assistant"}),Jr=B.i18n.translate("xpack.securitySolution.assistant.getComments.you",{defaultMessage:"You"}),Yr=B.i18n.translate("xpack.securitySolution.assistant.apiErrorTitle",{defaultMessage:"An error occurred sending your message."}),Xr=e=>e.reduce(((e,t)=>{if(t.length)try{const n=JSON.parse(t);return"content"===n.type&&n.payload.length>0?[...e,n.payload]:e}catch(t){return e}return e}),[]);function Zr(e){return i.a.createElement(ae.EuiButtonEmpty,Gr()({"data-test-subj":"stopGeneratingButton",color:"text",iconType:"stop",size:"s"},e),B.i18n.translate("xpack.securitySolution.aiAssistant.stopGeneratingButtonLabel",{defaultMessage:"Stop generating"}))}function es(e){return i.a.createElement(ae.EuiButtonEmpty,Gr()({size:"s","data-test-subj":"regenerateResponseButton",iconType:"sparkles"},e),B.i18n.translate("xpack.securitySolution.aiAssistant.regenerateResponseButtonLabel",{defaultMessage:"Regenerate"}))}function ts(){return i.a.createElement(ae.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiIcon,{type:"alert",color:"danger",size:"s"})),i.a.createElement(ae.EuiFlexItem,null,i.a.createElement(ae.EuiText,{size:"s",color:"danger"},B.i18n.translate("xpack.securitySolution.aiAssistant.failedLoadingResponseText",{defaultMessage:"Failed to load response"}))))}function ns(e){return i.a.createElement(i.a.Fragment,null,e.body,e.error?i.a.createElement("span",{"data-test-subj":"message-error"},e.body?i.a.createElement(ae.EuiSpacer,{size:"xs"}):null,i.a.createElement(ts,null)):null,e.controls?i.a.createElement(i.a.Fragment,null,i.a.createElement(ae.EuiSpacer,{size:"m"}),i.a.createElement(ae.EuiHorizontalRule,{margin:"none"}),i.a.createElement(ae.EuiSpacer,{size:"s"}),e.controls):null)}var as=n(152),is=n(52),rs=n.n(is);const ss=()=>{const e=(t,n)=>{if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}"code"!==t.type||"eql"!==t.lang&&"esql"!==t.lang&&"kql"!==t.lang&&"dsl"!==t.lang&&"json"!==t.lang||(t.type="customCodeBlock")};return t=>{e(t)}},os=({value:e})=>{const t=Object(ae.useEuiTheme)();return i.a.createElement(ae.EuiPanel,{hasShadow:!1,hasBorder:!1,paddingSize:"s",className:as.css`
        background-color: ${t.euiTheme.colors.lightestShade};
        .euiCodeBlock__pre {
          margin-bottom: 0;
          padding: ${t.euiTheme.size.m};
          min-block-size: 48px;
        }
        .euiCodeBlock__controls {
          inset-block-start: ${t.euiTheme.size.m};
          inset-inline-end: ${t.euiTheme.size.m};
        }
      `},i.a.createElement(ae.EuiFlexGroup,{direction:"column",gutterSize:"xs"},i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiCodeBlock,{isCopyable:!0,fontSize:"m"},e))))},ls=as.css`
  @keyframes blink {
    0% {
      opacity: 0;
    }
    50% {
      opacity: 1;
    }
    100% {
      opacity: 0;
    }
  }

  animation: blink ${1}s infinite;
  width: 10px;
  height: 16px;
  vertical-align: middle;
  display: inline-block;
  background: ${Object(ae.transparentize)(Gt.euiThemeVars.euiColorDarkShade,.25)};
`,us=()=>i.a.createElement("span",{"data-test-subj":"cursor",key:"cursor",className:rs()(ls,"cursor")}),cs=" ᠎  ",ds=()=>{const e=(t,n)=>{var a;if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}if("text"!==t.type&&"inlineCode"!==t.type&&"code"!==t.type)return;const i=t;if(-1===i.value.indexOf(cs))return;i.value=i.value.replace(cs,"");const r=null!==(a=null==n?void 0:n.children.indexOf(i))&&void 0!==a?a:0;null==n||n.children.splice(r+1,0,{type:"cursor",value:cs})};return t=>{e(t)}};function ms({loading:e,content:t,index:n}){const a=as.css`
    overflow-wrap: anywhere;
  `,{parsingPluginList:r,processingPluginList:s}=(()=>{const e=Object(ae.getDefaultEuiMarkdownParsingPlugins)(),t=Object(ae.getDefaultEuiMarkdownProcessingPlugins)(),{components:n}=t[1][1];return t[1][1].components={...n,cursor:us,customCodeBlock:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(os,{value:e.value}),i.a.createElement(ae.EuiSpacer,{size:"m"})),table:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(ae.EuiTable,e),i.a.createElement(ae.EuiSpacer,{size:"m"})),th:e=>{const{children:t,...n}=e;return i.a.createElement(ae.EuiTableHeaderCell,n,t)},tr:e=>i.a.createElement(ae.EuiTableRow,e),td:e=>{const{children:t,...n}=e;return i.a.createElement(ae.EuiTableRowCell,Gr()({truncateText:!0},n),t)}},{parsingPluginList:[ds,ss,...e],processingPluginList:t}})();return i.a.createElement(ae.EuiText,{className:a},i.a.createElement(ae.EuiMarkdownFormat,{className:`message-${n}`,"data-test-subj":"messageText",parsingPluginList:r,processingPluginList:s,textSize:"s"},`${t}${e?cs:""}`))}const ps=({abortStream:e,content:t,index:n,isControlsEnabled:r=!1,isError:s=!1,isFetching:o=!1,reader:l,refetchCurrentConversation:u,regenerateMessage:c,setIsStreaming:d,transformMessage:m})=>{const{error:p,isLoading:f,isStreaming:b,pendingMessage:g,setComplete:v}=(({content:e,isError:t,reader:n,refetchCurrentConversation:i})=>{const[r,s]=Object(a.useState)(),[o,l]=Object(a.useState)(!1),[u,c]=Object(a.useState)(),[d,m]=Object(a.useState)(),p=Object(a.useMemo)((()=>null==e&&null!=n?(({isError:e,reader:t,setLoading:n})=>new Wr.Observable((n=>{n.next({chunks:[],loading:!0});const a=new TextDecoder,i=[];let r="";return function s(){t.read().then((({done:t,value:o})=>{try{if(t){if(r){const e=Xr([r])[0];e&&e.length>0&&i.push(e)}return n.next({chunks:i,message:i.join(""),loading:!1}),void n.complete()}const s=a.decode(o);let l;if(e)l=[`${Yr}\n\n${JSON.parse(s).message}`],l.forEach((e=>{i.push(e),n.next({chunks:i,message:i.join(""),loading:!0})}));else{const e=s.split("\n");e[0]=r+e[0],r=e.pop()||"",l=Xr(e),l.forEach((e=>{i.push(e),n.next({chunks:i,message:i.join(""),loading:!0})}))}}catch(e){return void n.error(e)}s()})).catch((e=>{n.error(e)}))}(),()=>{t.cancel()}})).pipe(Object(Wr.timestamp)(),Object(Wr.scan)(((e,t)=>{const n=e.timestamp||0;return{timestamp:Math.max(n+35,t.timestamp),value:t.value}})),Object(Wr.concatMap)((e=>{const t=Date.now(),n=e.timestamp-t;return n<=0?Object(Wr.of)(e.value):Object(Wr.of)(e.value).pipe(Object(Wr.delay)(n))})),Object(Wr.finalize)((()=>n(!1)))))({reader:n,setLoading:l,isError:t}):new Wr.Observable),[e,t,n]),f=Object(a.useCallback)((e=>{null==d||d.unsubscribe(),l(!1),e||i({isStreamRefetch:!0})}),[i,d]),[b,g]=Object(a.useState)({complete:!1,didAbort:!1});return Object(a.useEffect)((()=>{b.complete&&(f(b.didAbort),g({complete:!1,didAbort:!1}))}),[b,f]),Object(a.useEffect)((()=>{const e=p.subscribe({next:({message:e,loading:t})=>{l(t),s(e)},complete:()=>{g({complete:!0,didAbort:!1})},error:e=>{"AbortError"===e.name||c(e.message)}});m(e)}),[p]),{error:u,isLoading:o,isStreaming:o&&null!=r,pendingMessage:null!=r?r:"",setComplete:g}})({refetchCurrentConversation:u,content:t,reader:l,isError:s});Object(a.useEffect)((()=>{d(b)}),[b,d]);const y=Object(a.useCallback)((()=>{v({complete:!0,didAbort:!0}),e()}),[e,v]),h=Object(a.useRef)({isStreaming:b,stopStream:y});Object(a.useEffect)((()=>{h.current={isStreaming:b,stopStream:y}}),[y,b]),Object(a.useEffect)((()=>()=>{h.current.isStreaming&&h.current.stopStream()}),[]);const j=Object(a.useMemo)((()=>null!=t?t:m(g).content),[t,m,g]),O=Object(a.useMemo)((()=>o||f||b),[o,f,b]),E=Object(a.useMemo)((()=>{if(r)return O&&l?i.a.createElement(Zr,{onClick:y}):i.a.createElement(ae.EuiFlexGroup,{direction:"row",justifyContent:"flexEnd"},i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(es,{onClick:c})))}),[O,r,l,c,y]);return i.a.createElement(ns,{body:i.a.createElement(ms,{content:j,index:n,loading:O}),error:p?new Error(p):void 0,controls:E})};var fs=n(65),bs=n(200),gs=n(634);const vs=B.i18n.translate("xpack.securitySolution.assistant.commentActions.addedNoteToTimelineToast",{defaultMessage:"Added note to timeline"}),ys=B.i18n.translate("xpack.securitySolution.assistant.commentActions.viewAPMTraceLabel",{defaultMessage:"View APM Trace for this message"}),hs=B.i18n.translate("xpack.securitySolution.assistant.commentActions.addMessageContentAsTimelineNoteAriaLabel",{defaultMessage:"Add message content as a timeline note"}),js=B.i18n.translate("xpack.securitySolution.assistant.commentActions.addNoteToTimelineTooltip",{defaultMessage:"Add note to timeline"}),Os=B.i18n.translate("xpack.securitySolution.assistant.commentActions.addToCaseExistingCase",{defaultMessage:"Add to existing case"}),Es=B.i18n.translate("xpack.securitySolution.assistant.commentActions.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),xs=B.i18n.translate("xpack.securitySolution.assistant.commentActions.copyToClipboard",{defaultMessage:"Copy to clipboard"});var Ss=n(122);const ws=({message:e})=>{var t;const n=Object(O.n)(),{cases:r}=Object(O.j)().services,o=Object(s.useDispatch)(),l=Object(Ss.a)("assistantModelEvaluation"),{traceOptions:u}=Object(nt.b)(),c=Object(a.useCallback)((e=>o(z.a.addNote({id:pr.f.active,noteId:e}))),[o]),d=Object(a.useCallback)((e=>o(bs.a.updateNote({note:e}))),[o]),m=null!==(t=e.content)&&void 0!==t?t:"",p=Object(a.useCallback)((()=>{Object(gs.b)({associateNote:c,newNote:m,updateNewNote:()=>{},updateNote:d,user:""}),n.addSuccess(vs)}),[c,m,n,d]),f=r.hooks.useCasesAddToExistingCaseModal({onClose:()=>{},onSuccess:()=>{}}),b=Object(a.useCallback)((()=>{f.open({getAttachments:()=>[{comment:m,type:fs.AttachmentType.user,owner:Es}]})}),[m,f]),g=null!=e.traceData&&Object.keys(e.traceData).length>0?`${u.apmUrl}/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=transaction.id:%20${e.traceData.transactionId}&rangeFrom=now-1y/d&rangeTo=now&showCriticalPath=false&traceId=${e.traceData.traceId}&transactionId=${e.traceData.transactionId}&type=kql&waterfallItemId=`:void 0;return i.a.createElement(ae.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},l&&null!=g&&i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiToolTip,{position:"top",content:ys},i.a.createElement(ae.EuiButtonIcon,{"aria-label":ys,color:"primary",iconType:"apmTrace",href:g,target:"_blank"}))),i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiToolTip,{position:"top",content:js},i.a.createElement(ae.EuiButtonIcon,{"aria-label":hs,color:"primary",iconType:"editorComment",onClick:p}))),i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiToolTip,{position:"top",content:Os},i.a.createElement(ae.EuiButtonIcon,{"aria-label":Os,color:"primary",iconType:"addDataApp",onClick:b}))),i.a.createElement(ae.EuiFlexItem,{grow:!1},i.a.createElement(ae.EuiToolTip,{position:"top",content:xs},i.a.createElement(ae.EuiCopy,{textToCopy:m},(e=>i.a.createElement(ae.EuiButtonIcon,{"aria-label":xs,color:"primary",iconType:"copyClipboard",onClick:e}))))))},ks=i.a.memo(ws),Cs=Qr.a.div`
  width: 40px;
  height: 40px;
  display: flex;
  justify-content: center;
`,Ts=({abortStream:e,currentConversation:t,isFetchingResponse:n,refetchCurrentConversation:a,regenerateMessage:r,showAnonymizedValues:s,currentUserAvatar:o,setIsStreaming:l})=>{if(!t)return[];const u=()=>{r(t.id)},c=n?[{username:Kr,timelineAvatar:i.a.createElement(Cs,null,i.a.createElement(ae.EuiLoadingSpinner,{size:"xl"})),timestamp:"...",children:i.a.createElement(ps,{abortStream:e,content:"",refetchCurrentConversation:a,regenerateMessage:u,setIsStreaming:l,transformMessage:()=>({content:""}),isFetching:!0,index:999})}]:[],d=()=>{var e;return o?i.a.createElement(ae.EuiAvatar,Gr()({name:"user",size:"l",color:null!==(e=null==o?void 0:o.color)&&void 0!==e?e:"subdued"},null!=o&&o.imageUrl?{imageUrl:o.imageUrl}:{initials:null==o?void 0:o.initials})):i.a.createElement(ae.EuiAvatar,{name:"user",size:"l",color:"subdued",iconType:"userAvatar"})};return[...t.messages.map(((n,r)=>{var o;const c=r===t.messages.length-1,m="user"===n.role,p=t.replacements,f={timelineAvatar:m?i.a.createElement(d,null):i.a.createElement(ae.EuiAvatar,{name:"machine",size:"l",color:"subdued",iconType:at.a}),timestamp:(b=0===n.timestamp.length?(new Date).toLocaleString():new Date(n.timestamp).toLocaleString(),B.i18n.translate("xpack.securitySolution.assistant.getComments.at",{defaultMessage:"at: {timestamp}",values:{timestamp:b}})),username:m?Jr:Kr,eventColor:n.isError?"danger":void 0};var b;const g=c&&!m,v=e=>(({message:e,content:t,showAnonymizedValues:n,replacements:a})=>({...e,content:n?t:Object(Yt.d)({messageContent:t,replacements:a})}))({message:n,content:e,showAnonymizedValues:s,replacements:p});if(!n.content||!n.content.length)return{...f,children:i.a.createElement(ps,{abortStream:e,index:r,isControlsEnabled:g,isError:n.isError,reader:n.reader,refetchCurrentConversation:a,regenerateMessage:u,setIsStreaming:l,transformMessage:v})};const y=v(null!==(o=n.content)&&void 0!==o?o:"");return{...f,actions:i.a.createElement(ks,{message:y}),children:i.a.createElement(ps,{abortStream:e,content:y.content,index:r,isControlsEnabled:g,reader:y.reader,regenerateMessage:u,refetchCurrentConversation:a,setIsStreaming:l,transformMessage:v})}})),...c]};var Ms=n(965);const Is=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.alertSummarizationTitle",{defaultMessage:"Alert summarization"}),_s=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.alertSummarizationPrompt",{defaultMessage:"As an expert in security operations and incident response, provide a breakdown of the attached alert and summarize what it might mean for my organization."}),As=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.esqlQueryGenerationTitle",{defaultMessage:"ES|QL Query Generation"}),Ps=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.esqlQueryGenerationPrompt",{defaultMessage:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, check your knowledge really well on all the functions I am asking for. For ES|QL answers specifically, you should only ever answer with what's available in your private knowledge. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema and Elastic Agent.\n\nEnsure the answers are formatted in a way which is easily copyable as a separate code block in markdown."}),Ds=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.ruleCreationTitle",{defaultMessage:"Query generation"}),Fs=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.ruleCreationPrompt",{defaultMessage:"As an expert user of Elastic Security, please generate an accurate and valid EQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. If Elastic Security already has a prebuilt rule for the use case, or a similar one, please provide a link to it and describe it."}),Rs=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.workflowAnalysisTitle",{defaultMessage:"Workflow suggestions"}),Ns=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.workflowAnalysisPrompt",{defaultMessage:"As an expert user of Elastic Security, please suggest a workflow, with step by step instructions on how to:"}),zs=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.threatInvestigationGuidesTitle",{defaultMessage:"Custom data ingestion helper"}),Ls=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.threatInvestigationGuidesPrompt",{defaultMessage:"As an expert user of Elastic Security, Elastic Agent, and Ingest pipelines, please list accurate and formatted, step by step instructions on how to ingest the following data using Elastic Agent and Fleet in Kibana and convert it to the Elastic Common Schema:"}),Bs=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.splQueryConversionTitle",{defaultMessage:"Query conversion"}),qs=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.splQueryConversionPrompt",{defaultMessage:"I have the following query from a previous SIEM platform. As an expert user of Elastic Security, please suggest an Elastic EQL equivalent. I should be able to copy it immediately into an Elastic security timeline."}),Vs=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.AutomationTitle",{defaultMessage:"Agent integration advice"}),$s=B.i18n.translate("xpack.securitySolution.assistant.quickPrompts.AutomationPrompt",{defaultMessage:"Which Fleet enabled Elastic Agent integration should I use to collect logs and events from:"});var Us=n(960);const Gs=[{name:Is,content:_s,color:"#F68FBE",categories:[Us.c],isDefault:!0,id:Is,promptType:Wt.a.quick,consumer:bt.APP_UI_ID},{name:As,content:Ps,color:"#9170B8",categories:[Us.a],isDefault:!0,id:As,promptType:Wt.a.quick,consumer:bt.APP_UI_ID},{name:Ds,content:Fs,categories:[Us.d],color:"#7DDED8",isDefault:!0,id:Ds,promptType:Wt.a.quick,consumer:bt.APP_UI_ID},{name:Rs,content:Ns,color:"#36A2EF",isDefault:!0,id:Rs,promptType:Wt.a.quick,consumer:bt.APP_UI_ID},{name:zs,content:Ls,categories:[Us.e],color:"#F3D371",isDefault:!0,id:zs,promptType:Wt.a.quick,consumer:bt.APP_UI_ID},{name:Bs,content:qs,color:"#BADA55",isDefault:!0,id:Bs,promptType:Wt.a.quick,consumer:bt.APP_UI_ID},{name:Vs,content:$s,color:"#FFA500",isDefault:!0,id:Vs,promptType:Wt.a.quick,consumer:bt.APP_UI_ID}],Hs=B.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.youAreAHelpfulExpertAssistant",{defaultMessage:"You are a helpful, expert assistant who answers questions about Elastic Security."}),Qs=B.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.ifYouDontKnowTheAnswer",{defaultMessage:"Do not answer questions unrelated to Elastic Security."}),Ws=B.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.superheroPersonality",{defaultMessage:"Provide the most detailed and relevant answer possible, as if you were relaying this information back to a cyber security expert."}),Ks=B.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.outputFormatting",{defaultMessage:'If you answer a question related to KQL, EQL, or ES|QL, it should be immediately usable within an Elastic Security timeline; please always format the output correctly with back ticks. Any answer provided for Query DSL should also be usable in a security timeline. This means you should only ever include the "filter" portion of the query.'}),Js=`${Hs} ${Qs}\n${Ks}`,Ys=B.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.defaultSystemPromptName",{defaultMessage:"Default system prompt"}),Xs=`${Hs} ${Qs}\n${Ws}\n${Ks}`,Zs=B.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.superheroSystemPromptName",{defaultMessage:"Enhanced system prompt"}),eo=[{id:"default-system-prompt",content:Js,name:Ys,promptType:Wt.a.system,isDefault:!0,isNewConversationDefault:!0,consumer:bt.APP_UI_ID},{id:"CB9FA555-B59F-4F71-AFF9-8A891AC5BC28",content:Xs,name:Zs,promptType:Wt.a.system,consumer:bt.APP_UI_ID,isDefault:!0}];var to=n(533),no=n(532),ao=n(16);const io=B.i18n.translate("xpack.securitySolution.assistant.title",{defaultMessage:"Elastic AI Assistant"}),ro=B.i18n.translate("xpack.securitySolution.assistant.conversationMigrationStatus.title",{defaultMessage:"Local storage conversations persisted successfuly."}),so=({children:e})=>{const{application:{navigateToApp:t,currentAppId$:n},http:r,notifications:s,storage:o,triggersActionsUi:{actionTypeRegistry:l},docLinks:{ELASTIC_WEBSITE_URL:u,DOC_LINK_VERSION:c}}=Object(O.j)().services,d=Object(O.d)(),m=$r(),p=Object(to.a)(),f=(()=>{const{services:{telemetry:e}}=Object(O.j)(),t=$r(),n=Object(a.useCallback)((async e=>t[e]?e:"Custom"),[t]),i=Object(a.useCallback)((async({fn:e,params:{conversationId:t,...a}})=>e({...a,conversationId:await n(t)})),[n]);return{reportAssistantInvoked:t=>i({fn:e.reportAssistantInvoked,params:t}),reportAssistantMessageSent:t=>i({fn:e.reportAssistantMessageSent,params:t}),reportAssistantQuickPrompt:t=>i({fn:e.reportAssistantQuickPrompt,params:t}),reportAssistantSettingToggled:t=>e.reportAssistantSettingToggled(t)}})(),b=Object(jt.useObservable)(n,""),g=ao.a.isEnterprise();Object(a.useEffect)((()=>{const e=Object(P.once)((async()=>{g&&p.isAssistantEnabled&&p.hasAssistantPrivilege&&0===(await Object(Fr.d)({http:r})).total&&await(async(e,t,n)=>{const a=n.get(`${bt.APP_ID}.${Ms.a}`);if(a&&Object.keys(a).length>0){const r=Object.values(a).filter((e=>e.messages&&e.messages.length>0)),s=e=>{var t,n;const a=null===(t=Object(Ar.parse)(null!==(n=e.timestamp)&&void 0!==n?n:""))||void 0===t?void 0:t.toISOString();return{...e,timestamp:null==a?(new Date).toISOString():a}},o=await Object(Rr.loadAllActions)({http:t}),l=await Object(Pr.a)(t,{create:r.reduce(((e,t)=>{var n;if(t.apiConfig&&!t.apiConfig.actionTypeId){const e=(null!=o?o:[]).find((e=>e.id===t.apiConfig.connectorId));t.apiConfig=e?{...t.apiConfig,actionTypeId:e.actionTypeId}:void 0}return e[t.id]={...t,messages:(null!==(n=t.messages)&&void 0!==n?n:[]).map(s),title:t.id,replacements:t.replacements},e}),{})},e.toasts);var i;return!(!l||!l.success||(n.remove(`${bt.APP_ID}.${Ms.a}`),null===(i=e.toasts)||void 0===i||i.addSuccess({iconType:"check",title:ro}),0))}})(s,r,o)}));e()}),[p.hasAssistantPrivilege,p.isAssistantEnabled,g,r,s,o]);const[v,y]=Object(a.useState)(!1);Object(a.useEffect)((()=>{const e=Object(P.once)((async()=>{if(g&&p.isAssistantEnabled&&p.hasAssistantPrivilege)try{0===(await Object(Oi.a)({http:r,toasts:s.toasts})).total&&await(async(e,t)=>{const n=[...Gs,...eo],a=await Object(Dr.a)(t,{create:n},e.toasts);if(a&&a.success)return a.attributes.results.created})(s,r)}catch(e){}y(!0)}));e()}),[p.hasAssistantPrivilege,p.isAssistantEnabled,g,r,s]);const{signalIndexName:h}=Object(no.a)(),j=null!=h?h:void 0,E=Object(br.a)();return i.a.createElement(nt.a,{actionTypeRegistry:l,alertsIndexPattern:j,augmentMessageCodeBlocks:Ms.b,assistantAvailability:p,assistantTelemetry:f,docLinks:{ELASTIC_WEBSITE_URL:u,DOC_LINK_VERSION:c},basePath:d,basePromptContexts:Object.values(Us.b),baseConversations:m,getComments:Ts,http:r,navigateToApp:t,title:io,toasts:E,currentAppId:null!=b?b:"securitySolutionUI"},v?e:null)},oo=({children:e,history:t,store:n,theme$:a})=>{const r=Object(O.j)().services,{application:{capabilities:p},uiActions:f,upselling:b}=r,g=Object(O.g)();return i.a.createElement(o.a,r,i.a.createElement(v.b,null,i.a.createElement(s.Provider,{store:n},i.a.createElement(l.EuiThemeProvider,{darkMode:g},i.a.createElement(j.b,null,i.a.createElement(xr.b,{kibanaCapabilities:p},i.a.createElement(m.a,null,i.a.createElement(c.a,{core:r},i.a.createElement(Sr.a,null,i.a.createElement(u.b,{getTriggerCompatibleActions:f.getTriggerCompatibleActions},i.a.createElement(d.a,{upsellingService:b},i.a.createElement(_r,null,i.a.createElement(so,null,i.a.createElement(Er,{history:t},e))))))))))),i.a.createElement(h,null),i.a.createElement(v.a,null))))},lo=Object(a.memo)(oo),uo=({children:e,history:t,services:n,store:a,theme$:r})=>{var s,o;const l=null!==(s=null===(o=n.cloud)||void 0===o?void 0:o.CloudContextProvider)&&void 0!==s?s:i.a.Fragment;return i.a.createElement(O.a,{services:{appName:p.k,...n}},i.a.createElement(l,null,i.a.createElement(lo,{history:t,store:a,theme$:r},e)))},co=Object(a.memo)(uo),mo=i.a.memo((({services:e,subPluginRoutes:t})=>i.a.createElement(k.a,null,t.map(((e,t)=>i.a.createElement(C.b,Gr()({key:`route-${t}`},e)))),i.a.createElement(C.b,null,i.a.createElement(po,{capabilities:e.application.capabilities})))));mo.displayName="AppRoutes";const po=i.a.memo((({capabilities:e})=>!0===e[p.Lc].show?i.a.createElement(E.Redirect,{to:p.Rb}):!0===e[p.w].read_cases?i.a.createElement(E.Redirect,{to:p.x}):i.a.createElement(A.a,null)));po.displayName="RedirectRoute";const fo=({element:e,history:t,services:n,store:a,usageCollection:s,subPluginRoutes:o,theme$:l,children:u})=>{var c;const d=null!==(c=null==s?void 0:s.components.ApplicationUsageTrackingProvider)&&void 0!==c?c:i.a.Fragment;return Object(r.render)(i.a.createElement(co,{history:t,services:n,store:a,theme$:l},i.a.createElement(d,null,null!=u?u:o&&i.a.createElement(mo,{subPluginRoutes:o,services:n}))),e),()=>{n.data.search.session.clear(),Object(r.unmountComponentAtNode)(e)}};var bo=n(1360)}])]);