/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[67],{1364:function(e,t,i){"use strict";i.d(t,"b",(function(){return N})),i.d(t,"a",(function(){return z}));var l=i(2),n=i.n(l),a=i(19),c=i(41),o=i.n(c),s=i(45),r=i(1799),u=i(1490),b=i(131),d=i(118),m=i(4);const p=m.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),v=m.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"});var g=i(146),j=i(1216),S=i(122),O=i(129),y=i(132),T=i(158),h=i(124),I=i(738),E=i(145),w=i(127),F=i(622),f=i(5),A=i(522),C=i(559),x=i(206),D=i(978),M=i(140);const P=o()(a.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-1bu2jj8-0"})(["margin:4px 0 4px 0;"]),V=({fullScreen:e,globalFullScreen:t,onCloseOverlay:i,isActiveTimelines:l,timelineFullScreen:c,toggleFullScreen:o,graphEventId:s,activeTab:r})=>n.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n.a.createElement(a.EuiFlexItem,{grow:!1},n.a.createElement(a.EuiButtonEmpty,{iconType:"cross",onClick:i,size:"xs","data-test-subj":"close-overlay"},l?r===g.d.graph?p:v:s?p:v)),!1===l&&n.a.createElement(a.EuiFlexItem,{grow:!1},n.a.createElement(a.EuiToolTip,{content:e?C.a:A.d},n.a.createElement(P,{"aria-label":Object(F.b)({globalFullScreen:t,isActiveTimelines:l,timelineFullScreen:c})?C.a:A.d,display:e?"fill":"empty",color:"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:o}))));V.displayName="NavigationComponent";const B=n.a.memo(V),N=({scopeId:e})=>{const t=Object(s.useDispatch)(),i=Object(l.useMemo)((()=>Object(b.isTimelineScope)(e)?O.b.getTimelineByIdSelector():Object(b.isInTableScope)(e)?r.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:a,setGlobalFullScreen:c}=Object(x.a)(),{timelineFullScreen:o,setTimelineFullScreen:d}=Object(x.c)(),m=Object(b.isTimelineScope)(e)?T.b:u.d,{graphEventId:p,sessionViewConfig:v,activeTab:j,prevActiveTab:S}=Object(h.a)((t=>{var l;return{activeTab:T.b.activeTab,prevActiveTab:T.b.prevActiveTab,...null!==(l=i&&i(t,e))&&void 0!==l?l:m}})),y=Object(b.getScopedActions)(e),I=Object(l.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?Object(b.isActiveTimeline)(e)?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(f.Gc,"euiDataGrid__restrictBody"):Object(b.isActiveTimeline)(e)?d(!1):c(!1),!1===Object(b.isActiveTimeline)(e)?y&&(t(y.updateGraphEventId({id:e,graphEventId:""})),t(y.updateSessionViewConfig({id:e,sessionViewConfig:null}))):j===g.d.graph?(y&&t(y.updateGraphEventId({id:e,graphEventId:""})),S!==g.d.session||v||t(O.a.setActiveTabTimeline({id:e,activeTab:g.d.query}))):j===g.d.session&&(Object(b.isTimelineScope)(e)&&(S!==g.d.graph||p?t(O.a.setActiveTabTimeline({id:e,activeTab:S})):t(O.a.setActiveTabTimeline({id:e,activeTab:g.d.query}))),y&&t(y.updateSessionViewConfig({id:e,sessionViewConfig:null})))}),[d,c,y,t,e,j,S,v,p]),E=Object(l.useMemo)((()=>Object(F.b)({globalFullScreen:a,isActiveTimelines:Object(b.isActiveTimeline)(e),timelineFullScreen:o})),[a,e,o]),w=Object(l.useCallback)((()=>{Object(b.isActiveTimeline)(e)?d(!o):c(!a)}),[e,d,o,c,a]),A=Object(l.useMemo)((()=>n.a.createElement(B,{fullScreen:E,globalFullScreen:a,activeTab:j,onCloseOverlay:I,isActiveTimelines:Object(b.isActiveTimeline)(e),timelineFullScreen:o,toggleFullScreen:w,graphEventId:p})),[E,a,j,I,e,o,w,p]);return{onCloseOverlay:I,Navigation:A}},z=({scopeId:e,entityType:t,height:i})=>{const{sessionView:a}=Object(d.j)().services,c=Object(l.useMemo)((()=>Object(b.isTimelineScope)(e)?O.b.getTimelineByIdSelector():Object(b.isInTableScope)(e)?r.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:o}=Object(x.a)(),{timelineFullScreen:m}=Object(x.c)(),{canReadPolicyManagement:p}=Object(M.a)().endpointPrivileges,v=Object(b.isTimelineScope)(e)?T.b:u.d,{sessionViewConfig:f,activeTab:A}=Object(h.a)((t=>{var i;return{activeTab:T.b.activeTab,prevActiveTab:T.b.prevActiveTab,...null!==(i=c&&c(t,e))&&void 0!==i?i:v}})),C=Object(l.useMemo)((()=>Object(F.b)({globalFullScreen:o,isActiveTimelines:Object(b.isActiveTimeline)(e),timelineFullScreen:m})),[o,e,m]),P=Object(l.useMemo)((()=>Object(b.isActiveTimeline)(e)?w.SourcererScopeName.timeline:D.a.includes(e)?w.SourcererScopeName.detections:w.SourcererScopeName.default),[e]),{openEventDetailsPanel:V,shouldShowDetailsPanel:B,DetailsPanel:N}=(({entityType:e,isFlyoutView:t,sourcererScope:i,scopeId:a,tabType:c=g.d.query})=>{const{telemetry:o}=Object(d.j)().services,{browserFields:u,selectedPatterns:m,runtimeMappings:p}=Object(y.a)(i),v=Object(s.useDispatch)(),{openFlyout:w}=Object(j.a)(),F=Object(S.a)("expandableFlyoutDisabled"),f=Object(l.useMemo)((()=>Object(b.isTimelineScope)(a)?O.b.getTimelineByIdSelector():Object(b.isInTableScope)(a)?r.b.getTableByIdSelector():void 0),[a]),A=Object(l.useMemo)((()=>m.join(",")),[m]),C=Object(h.a)((e=>{var t,i;return null===(t=null!==(i=f&&f(e,a))&&void 0!==i?i:T.b)||void 0===t?void 0:t.expandedDetail})),x=Object(l.useRef)((()=>{})),D=()=>{},M=Object(l.useMemo)((()=>{var e;return!!(c&&C&&C[c]&&null!==(e=C[c])&&void 0!==e&&e.panelView)}),[C,c]),P=Object(b.getScopedActions)(a),V=Object(l.useCallback)((e=>{e&&P&&v(P.toggleDetailPanel({...e,tabType:c,id:a}))}),[P,a,v,c]),B=Object(l.useCallback)(((e,t)=>{F?e&&(V({panelView:"eventDetail",params:{eventId:e,indexName:A}}),x.current=null!=t?t:D):(w({right:{id:E.e,params:{id:e,indexName:A,scopeId:a}}}),o.reportDetailsFlyoutOpened({location:a,panel:"right"}))}),[F,w,A,a,o,V]),N=Object(l.useCallback)((()=>{F&&(x.current&&x.current(),P&&v(P.toggleDetailPanel({tabType:c,id:a})))}),[F,P,v,c,a]),z=Object(l.useMemo)((()=>M?n.a.createElement(I.a,{browserFields:u,entityType:e,handleOnPanelClosed:N,isFlyoutView:t,runtimeMappings:p,tabType:c,scopeId:a}):null),[u,e,N,t,p,M,c,a]);return{openEventDetailsPanel:B,shouldShowDetailsPanel:M,DetailsPanel:z}})({isFlyoutView:!Object(b.isActiveTimeline)(e),entityType:t,sourcererScope:P,scopeId:e,tabType:Object(b.isActiveTimeline)(e)?A:g.d.query}),z=Object(l.useMemo)((()=>{const e=i?i-118:void 0;return null!==f?a.getSessionView({...f,loadAlertDetails:V,isFullScreen:C,height:e,canReadPolicyManagement:p}):null}),[i,f,a,V,C,p]);return{openEventDetailsPanel:V,shouldShowDetailsPanel:B,SessionView:z,DetailsPanel:N}}},2094:function(e,t,i){"use strict";i.r(t);var l=i(2),n=i.n(l),a=i(19),c=i(41),o=i.n(c),s=i(1364),r=i(1242);const u=o()(a.EuiFlexItem).withConfig({displayName:"MaxWidthFlexItem",componentId:"sc-y5mbja-0"})(["width:100%;"]),b=o.a.div.withConfig({displayName:"SessionViewWrapper",componentId:"sc-y5mbja-1"})(["",""],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),d=o()(a.EuiFlexGroup).withConfig({displayName:"MaxWidthPageFlexGroup",componentId:"sc-y5mbja-2"})(["max-width:100%;box-sizing:border-box;"]),m=o()(a.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-y5mbja-3"})([""," height:100%;min-width:320px;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`));t.default=({timelineId:e})=>{const[t,i]=Object(l.useState)(0),c=Object(l.useCallback)((e=>{null!==e&&i(e.getBoundingClientRect().height)}),[]),{Navigation:o}=Object(s.b)({scopeId:e}),{SessionView:p,shouldShowDetailsPanel:v,DetailsPanel:g}=Object(s.a)({scopeId:e,height:t});return n.a.createElement(d,{alignItems:"flexStart",gutterSize:"none",ref:c,"data-test-subj":"timeline-session-content"},n.a.createElement(u,{grow:!1},n.a.createElement(a.EuiHorizontalRule,{margin:"none"}),o,n.a.createElement(a.EuiHorizontalRule,{margin:"none"}),n.a.createElement(a.EuiSpacer,{size:"m"}),n.a.createElement(b,null,p)),v&&n.a.createElement(n.a.Fragment,null,n.a.createElement(r.h,null),n.a.createElement(m,{grow:1},g)))}}}]);