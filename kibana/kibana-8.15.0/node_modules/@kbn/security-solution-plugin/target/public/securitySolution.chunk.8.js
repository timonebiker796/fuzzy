/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[8],{1200:function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return k})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return Ee})),n.d(t,"e",(function(){return Oe})),n.d(t,"g",(function(){return je})),n.d(t,"f",(function(){return we}));var a=n(7),r=n(63),i=n.n(r),s=n(118),o=n(341);const l=()=>s.b.get().http;var u=n(2),c=n.n(u),d=n(19),p=n(130),g=n(1610),b=n(1377);const m=Object(p.d)(),f=({status:e,showTooltip:t=!1})=>{var n;const a=null!==(n=Object(b.a)(e))&&void 0!==n?n:m,r=Object(b.b)(e);return t?c.a.createElement(g.b,{status:e}):c.a.createElement(d.EuiHealth,{color:r},a)},h=c.a.memo(f);h.displayName="ExecutionStatusIndicator";var v=n(757);const x=e=>{const{dataTestSubj:t,title:n,items:a,selectedItems:r,onSelectionChange:i,renderItem:s,renderLabel:o}=y(e),[l,,p,g]=Object(v.a)(),b=Object(u.useCallback)((e=>{const t=r.includes(e)?r.filter((t=>t!==e)):[...r,e];i(t)}),[r,i]),m=Object(u.useMemo)((()=>a.map(((e,n)=>{const a=o(e),i=s(e);return c.a.createElement(d.EuiFilterSelectItem,{"data-test-subj":`${t}-item`,title:a,key:`${n}-${a}`,checked:r.includes(e)?"on":void 0,onClick:()=>b(e)},i)}))),[t,a,r,s,o,b]);return c.a.createElement(d.EuiFilterGroup,{"data-test-subj":t},c.a.createElement(d.EuiPopover,{"data-test-subj":`${t}-popover`,button:c.a.createElement(d.EuiFilterButton,{"data-test-subj":`${t}-popoverButton`,iconType:"arrowDown",grow:!1,numFilters:a.length,numActiveFilters:r.length,hasActiveFilters:r.length>0,isSelected:l,onClick:g},n),isOpen:l,closePopover:p,panelPaddingSize:"none",repositionOnScroll:!0},m))},E=(()=>{const e=c.a.memo(x);return e.displayName="MultiselectFilter",e})(),y=e=>{var t,n,r,i;const s=null!==(t=e.onSelectionChange)&&void 0!==t?t:a.noop,o=null!==(n=e.renderLabel)&&void 0!==n?n:String,l=null!==(r=e.renderItem)&&void 0!==r?r:o;return{dataTestSubj:null!==(i=e.dataTestSubj)&&void 0!==i?i:"multiselectFilter",title:e.title,items:e.items,selectedItems:e.selectedItems,onSelectionChange:s,renderLabel:o,renderItem:l}};var S=n(4);const O=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionStatusFilter.filterTitle",{defaultMessage:"Status"}),I=({items:e,selectedItems:t,onChange:n})=>{const a=Object(u.useCallback)((e=>c.a.createElement(h,{status:e})),[]);return c.a.createElement(E,{dataTestSubj:"ExecutionStatusFilter",title:O,items:e,selectedItems:t,onSelectionChange:n,renderItem:a})},j=c.a.memo(I);j.displayName="ExecutionStatusFilter";const T=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionRunTypeFilter.filterTitle",{defaultMessage:"Run type"});var w=n(10);const C=({items:e,selectedItems:t,onChange:n})=>{const{telemetry:a}=Object(s.j)().services,r=Object(u.useCallback)((e=>e===o.h.backfill?w.d:e===o.h.standard?w.e:"-"),[]),i=Object(u.useCallback)((e=>{n(e),a.reportEventLogFilterByRunType({runType:e})}),[n,a]);return c.a.createElement(E,{dataTestSubj:"ExecutionRunTypeFilter",title:T,items:e,selectedItems:t,onSelectionChange:i,renderItem:r})},k=c.a.memo(C);k.displayName="ExecutionRunTypeFilter";var M=n(224),R=n(227);const D=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.messageText",{defaultMessage:"Message"}),_=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.statusChangeText",{defaultMessage:"Status"}),A=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.executionMetricsText",{defaultMessage:"Metrics"}),N=({type:e})=>{const t=(e=>{switch(e){case o.e.message:return"console";case o.e["status-change"]:return"dot";case o.e["execution-metrics"]:return"gear";default:return Object(R.a)(e,"Unknown rule execution event type")}})(e),n=(e=>{switch(e){case o.e.message:return D;case o.e["status-change"]:return _;case o.e["execution-metrics"]:return A;default:return Object(R.a)(e,"Unknown rule execution event type")}})(e);return c.a.createElement(d.EuiBadge,{color:"hollow",iconType:t},n)},F=c.a.memo(N);F.displayName="EventTypeIndicator";const P=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeFilter.filterTitle",{defaultMessage:"Event type"}),z=({selectedItems:e,onChange:t})=>{const n=Object(u.useCallback)((e=>c.a.createElement(F,{type:e})),[]);return c.a.createElement(E,{dataTestSubj:"eventTypeFilter",title:P,items:o.d.options,selectedItems:e,onSelectionChange:t,renderItem:n})},B=c.a.memo(z);B.displayName="EventTypeFilter";const U=({logLevel:e})=>{const t=(e=>{switch(e){case o.b.trace:case o.b.debug:return"hollow";case o.b.info:return"default";case o.b.warn:return"warning";case o.b.error:return"danger";default:return Object(R.a)(e,"Unknown log level")}})(e),n=(e=>Object(a.upperCase)(e))(e);return c.a.createElement(d.EuiBadge,{color:t},n)},L=c.a.memo(U);L.displayName="LogLevelIndicator";const W=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.logLevelFilter.filterTitle",{defaultMessage:"Log level"}),G=({selectedItems:e,onChange:t})=>{const n=Object(u.useCallback)((e=>c.a.createElement(L,{logLevel:e})),[]);return c.a.createElement(E,{dataTestSubj:"logLevelFilter",title:W,items:o.a,selectedItems:e,onSelectionChange:t,renderItem:n})},q=c.a.memo(G);q.displayName="LogLevelFilter";var H=n(1679);const K=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableTitle",{defaultMessage:"Execution log"}),$=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableSubtitle",{defaultMessage:"A detailed log of rule execution events"}),J=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.timestampColumn",{defaultMessage:"Timestamp"}),V=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.logLevelColumn",{defaultMessage:"Level"}),X=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.eventTypeColumn",{defaultMessage:"Type"}),Q=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.messageColumn",{defaultMessage:"Message"}),Y=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution events"}),Z=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.messageTitle",{defaultMessage:"Message"}),ee=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.jsonTitle",{defaultMessage:"Full JSON"}),te=({item:e})=>c.a.createElement(d.EuiDescriptionList,{className:"eui-fullWidth",listItems:[{title:Z,description:c.a.createElement(H.a,{text:e.message})},{title:ee,description:c.a.createElement(H.a,{text:JSON.stringify(e,null,2)})}]}),ne=c.a.memo(te);ne.displayName="ExecutionEventsTableRowDetails";const ae=[10,20,50];var re=n(151);const ie=({text:e})=>null!=e?c.a.createElement("span",{className:"eui-fullWidth eui-textTruncate"},e):null,se=c.a.memo(ie);se.displayName="TruncatedText";const oe={field:"timestamp",name:J,render:e=>c.a.createElement(re.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"20%"},le={field:"level",name:V,render:e=>c.a.createElement(L,{logLevel:e}),sortable:!1,truncateText:!1,width:"8%"},ue={field:"type",name:X,render:e=>c.a.createElement(F,{type:e}),sortable:!1,truncateText:!1,width:"8%"},ce={field:"message",name:Q,render:e=>c.a.createElement(se,{text:e}),sortable:!1,truncateText:!0,width:"64%"},de=({toggleRowExpanded:e,isRowExpanded:t})=>({align:d.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:c.a.createElement(d.EuiScreenReaderOnly,null,c.a.createElement("span",null,"Expand rows")),render:n=>c.a.createElement(d.EuiButtonIcon,{onClick:()=>e(n),"aria-label":t(n)?"Collapse":"Expand",iconType:t(n)?"arrowUp":"arrowDown"})});var pe=n(1680),ge=n(47),be=n(123);const me=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.eventLog.searchAriaLabel",{defaultMessage:"Search by event message"}),fe=S.i18n.translate("xpack.securitySolution.detectionEngine.rules.eventLog.searchPlaceholder",{defaultMessage:"Search by event message"});function he({value:e,onChange:t}){const n=Object(u.useCallback)((e=>t(e.target.value)),[t]);return c.a.createElement(d.EuiFieldSearch,{"aria-label":me,fullWidth:!0,incremental:!1,placeholder:fe,value:e,onChange:n,"data-test-subj":"ruleEventLogMessageSearchField"})}const ve=[10,20,50,100,200],xe=({ruleId:e})=>{const t=Object(u.useCallback)((e=>`${e.timestamp} ${e.sequence}`),[]),n=Object(u.useCallback)((e=>c.a.createElement(ne,{item:e})),[]),r=Object(pe.a)({getItemId:t,renderItem:n}),s=(e=>{const{toggleRowExpanded:t,isRowExpanded:n}=e;return Object(u.useMemo)((()=>[oe,le,ue,ce,de({toggleRowExpanded:t,isRowExpanded:n})]),[t,n])})({toggleRowExpanded:r.toggleRowExpanded,isRowExpanded:r.isRowExpanded}),p=(()=>{const[e,t]=Object(u.useState)(""),[n,a]=Object(u.useState)([]),[r,i]=Object(u.useState)([]),[s,o]=Object(u.useState)({start:"now-24h",end:"now"}),l=Object(u.useMemo)((()=>({searchTerm:e,logLevels:n,eventTypes:r,dateRange:s})),[e,n,r,s]);return Object(u.useMemo)((()=>({state:l,setSearchTerm:t,setLogLevels:a,setEventTypes:i,setDateRange:o})),[l,t,a,i,o])})(),g=((e,t)=>{const[n,a]=Object(u.useState)("timestamp"),[r,i]=Object(u.useState)("desc"),s=Object(u.useMemo)((()=>({sort:{field:n,direction:r}})),[n,r]),o=Object(u.useCallback)((e=>{e.sort&&(a(e.sort.field),i(e.sort.direction))}),[a,i]);return Object(u.useMemo)((()=>({state:s,update:o})),[s,o])})(),b=(e=>{var t,n,a;const r=null!==(t=e.pageSizeOptions)&&void 0!==t?t:ae,i=null!==(n=e.pageSizeDefault)&&void 0!==n?n:r[0],s=null!==(a=e.pageNumberDefault)&&void 0!==a?a:1,[o,l]=Object(u.useState)(i),[c,d]=Object(u.useState)(s),[p,g]=Object(u.useState)(0),b=Object(u.useMemo)((()=>({pageSizeOptions:r,pageSize:o,pageNumber:c,pageIndex:c-1,totalItemCount:p})),[r,o,c,p]),m=Object(u.useCallback)((e=>{d(e.page.index+1),l(e.page.size)}),[d,l]),f=Object(u.useCallback)((e=>{g(null!=e?e:0)}),[g]);return Object(u.useMemo)((()=>({state:b,update:m,updateTotalItemCount:f})),[b,m,f])})({pageSizeOptions:ve}),m=(e=>{const{addError:t}=Object(be.a)();return Object(ge.useQuery)(["detectionEngine","ruleMonitoring","executionEvents",e],(({signal:t})=>(e=>{var t,n,r,s;const{ruleId:u,searchTerm:c,eventTypes:d,logLevels:p,dateRange:g,sortOrder:b,page:m,perPage:f,signal:h}=e,v=Object(o.j)(u),x=null===(t=i.a.parse(null!==(n=null==g?void 0:g.start)&&void 0!==n?n:""))||void 0===t?void 0:t.toISOString(),E=null===(r=i.a.parse(null!==(s=null==g?void 0:g.end)&&void 0!==s?s:"",{roundUp:!0}))||void 0===r?void 0:r.toISOString();return l().fetch(v,{method:"GET",version:"1",query:Object(a.omitBy)({search_term:null!=c&&c.length?c:void 0,event_types:null!=d&&d.length?d.join(","):void 0,log_levels:null!=p&&p.length?p.join(","):void 0,date_start:x,date_end:E,sort_order:b,page:m,per_page:f},a.isUndefined),signal:h})})({...e,signal:t})),{keepPreviousData:!0,refetchInterval:2e4,onError:e=>{t(e,{title:Y})}})})({ruleId:e,searchTerm:p.state.searchTerm,eventTypes:p.state.eventTypes,logLevels:p.state.logLevels,dateRange:p.state.dateRange,sortOrder:g.state.sort.direction,page:b.state.pageNumber,perPage:b.state.pageSize});Object(u.useEffect)((()=>{var e;b.updateTotalItemCount(null===(e=m.data)||void 0===e?void 0:e.pagination.total)}),[m,b]);const f=Object(u.useMemo)((()=>{var e,t;return null!==(e=null===(t=m.data)||void 0===t?void 0:t.events)&&void 0!==e?e:[]}),[m.data]),h=Object(u.useCallback)((e=>{g.update(e),b.update(e)}),[g,b]);return c.a.createElement(d.EuiPanel,{hasBorder:!0},c.a.createElement(d.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(d.EuiFlexItem,{grow:!0},c.a.createElement(M.a,{title:K,subtitle:$})),c.a.createElement(d.EuiFlexItem,{grow:!0},c.a.createElement(he,{value:p.state.searchTerm,onChange:p.setSearchTerm})),c.a.createElement(d.EuiFlexItem,{grow:!1},c.a.createElement(q,{selectedItems:p.state.logLevels,onChange:p.setLogLevels})),c.a.createElement(d.EuiFlexItem,{grow:!1},c.a.createElement(B,{selectedItems:p.state.eventTypes,onChange:p.setEventTypes})),c.a.createElement(d.EuiFlexItem,{grow:!1},c.a.createElement(d.EuiSuperDatePicker,{start:p.state.dateRange.start,end:p.state.dateRange.end,onTimeChange:p.setDateRange,showUpdateButton:!1}))),c.a.createElement(d.EuiBasicTable,{columns:s,items:f,itemId:t,itemIdToExpandedRowMap:r.itemIdToExpandedRowMap,loading:m.isFetching,sorting:g.state,pagination:b.state,onChange:h}))},Ee=c.a.memo(xe);Ee.displayName="RuleExecutionEventsTable";var ye=n(122);const Se=S.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionResultsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution results"}),Oe=e=>{const{addError:t}=Object(be.a)(),n=Object(ye.a)("manualRuleRunEnabled");return Object(ge.useQuery)(["detectionEngine","ruleMonitoring","executionResults",e],(({signal:t})=>{let a=e.runTypeFilters;return n||(a=[o.h.standard]),(e=>{var t,n;const{ruleId:a,start:r,end:s,queryText:u,statusFilters:c,page:d,perPage:p,sortField:g,sortOrder:b,signal:m,runTypeFilters:f}=e,h=Object(o.k)(a),v=i.a.parse(r),x=i.a.parse(s,{roundUp:!0});return l().fetch(h,{method:"GET",version:"1",query:{start:null==v?void 0:v.utc().toISOString(),end:null==x?void 0:x.utc().toISOString(),query_text:u,status_filters:null==c||null===(t=c.sort())||void 0===t?void 0:t.join(","),sort_field:g,sort_order:b,page:d,per_page:p,run_type_filters:null==f||null===(n=f.sort())||void 0===n?void 0:n.join(",")},signal:m})})({...e,runTypeFilters:a,signal:t})}),{keepPreviousData:!0,onError:e=>{t(e,{title:Se})}})},Ie=["POST",o.i],je=e=>{const{mutate:t}=Object(ge.useMutation)((()=>(async()=>{await l().fetch(o.i,{version:"1",method:"POST"})})()),{...e,mutationKey:Ie});Object(u.useEffect)((()=>{t()}),[t])};var Te=n(5);const we=()=>{const e=Object(ye.a)("extendedRuleExecutionLoggingEnabled"),t=Ce(Te.Gb,!1),n=Ce(Te.Hb,o.c.off);return Object(u.useMemo)((()=>({extendedLogging:{isEnabled:e&&t,minLevel:n}})),[e,t,n])},Ce=(e,t)=>{try{const[t]=Object(s.o)(e);return t}catch(e){return t}}},1249:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return b}));const a=n(4).i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"});var r=n(1202),i=n(44);const s=e=>Object(i.has)("error.msg",e)&&Object(i.has)("error.response",e)&&Object(i.has)("error.statusCode",e),o=e=>Object(i.has)("error.error.reason",e),l=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}};var u=n(118);const c=async({indexPatternName:e,signal:t})=>u.b.get().http.fetch(`/internal/ml/modules/recognize/${e.map((e=>encodeURIComponent(e)))}`,{method:"GET",version:"1",asSystemRequest:!0,signal:t,query:{filter:"security"}}),d=async({moduleId:e="",signal:t})=>u.b.get().http.fetch(`/internal/ml/modules/get_module/${encodeURIComponent(e)}`,{method:"GET",version:"1",asSystemRequest:!0,signal:t,query:{filter:"security"}}),p=async({configTemplate:e,indexPatternName:t="auditbeat-*",jobIdErrorFilter:n=[],groups:i=["security"],prefix:c=""})=>{const d=await u.b.get().http.fetch(`/internal/ml/modules/setup/${encodeURIComponent(e)}`,{method:"POST",version:"1",body:JSON.stringify({prefix:c,groups:i,indexPatternName:t,startDatafeed:!1,useDedicatedIndex:!0,applyToAllSpaces:!0}),asSystemRequest:!0});return((e,t=[])=>{const n=[...e.jobs.reduce(((e,n)=>{if(null!=n.error&&t.includes(n.id)){if(s(n))return[...e,n.error.msg,l(n.error.response),`${a} ${n.error.statusCode}`];if(o(n))return[n.error.error.reason]}return e}),[]),...e.datafeeds.reduce(((e,n)=>null!=n.error&&t.includes(n.id.substr(9))?[...e,n.error.msg,l(n.error.response),`${a} ${n.error.statusCode}`]:e),[])];if(n.length>0)throw new r.c(n)})(d,n),d},g=async({datafeedIds:e,start:t=0})=>{const n=await u.b.get().http.fetch("/internal/ml/jobs/force_start_datafeeds",{method:"POST",version:"1",body:JSON.stringify({datafeedIds:e,...0!==t&&{start:t}}),asSystemRequest:!0});return((e,t)=>{const n=t.reduce(((t,n)=>{const r=e[n];return s(r)?[...t,r.error.msg,l(r.error.response),`${a} ${r.error.statusCode}`]:o(r)?[r.error.error.reason]:t}),[]);if(n.length>0)throw new r.c(n)})(n,e),n},b=async({datafeedIds:e})=>{const t=await u.b.get().http.fetch("/internal/ml/jobs/stop_datafeeds",{method:"POST",version:"1",body:JSON.stringify({datafeedIds:e}),asSystemRequest:!0});return[t,await u.b.get().http.fetch("/internal/ml/jobs/close_jobs",{method:"POST",version:"1",body:JSON.stringify({jobIds:e.map((e=>e.startsWith("datafeed-")?e.substring(9):e))}),asSystemRequest:!0})]}},1377:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(7),r=n(227),i=n(341);const s=e=>null==e?null:e===i.g["partial failure"]?"warning":e,o=e=>{const t=s(e);return null!=t?Object(a.capitalize)(t):null},l=e=>null==e?"subdued":e===i.g.succeeded?"success":e===i.g.failed?"danger":e===i.g.running||e===i.g["partial failure"]||e===i.g["going to run"]?"warning":Object(r.a)(e,"Unknown rule execution status")},1378:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n.n(a),i=n(41),s=n.n(i),o=n(19);const l=s.a.div.withConfig({displayName:"StatusTextWrapper",componentId:"sc-1nku0d-0"})(["width:100%;display:inline-grid;"]),u=({tooltipContent:e,children:t,healthColor:n,dataTestSubj:a})=>r.a.createElement(o.EuiToolTip,{content:e},r.a.createElement(o.EuiHealth,{color:n,"data-test-subj":a},r.a.createElement(l,null,r.a.createElement("span",{className:"eui-textTruncate"},t))));u.displayName="HealthTruncateText"},1538:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n.n(a),i=n(130),s=n(1378),o=n(1377),l=n(341);const u=({status:e,message:t,showTooltip:n=!0})=>{const a=e===l.g.failed||e===l.g["partial failure"],u=Object(o.a)(e),c=a&&t?t:u,d=n?null==c?void 0:c.split("\n").map((e=>r.a.createElement("p",null,e))):null,p=Object(o.b)(e);return r.a.createElement(s.a,{tooltipContent:d,healthColor:p,dataTestSubj:"ruleExecutionStatus"},null!=u?u:Object(i.d)())},c=r.a.memo(u);c.displayName="RuleStatusBadge"},1610:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return O.a})),n.d(t,"c",(function(){return R})),n.d(t,"d",(function(){return a}));var a={};n.r(a),n.d(a,"STATUS",(function(){return d})),n.d(a,"STATUS_AT",(function(){return p})),n.d(a,"STATUS_DATE",(function(){return g})),n.d(a,"REFRESH",(function(){return b})),n.d(a,"ERROR_CALLOUT_TITLE",(function(){return m})),n.d(a,"PARTIAL_FAILURE_CALLOUT_TITLE",(function(){return f})),n.d(a,"ASK_ASSISTANT_ERROR_BUTTON",(function(){return h})),n.d(a,"ASK_ASSISTANT_DESCRIPTION",(function(){return v})),n.d(a,"ASK_ASSISTANT_USER_PROMPT",(function(){return x})),n.d(a,"ASK_ASSISTANT_TOOLTIP",(function(){return E}));var r=n(2),i=n.n(r),s=n(19),o=n(151),l=n(130),u=n(1377),c=n(4);const d=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"}),p=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"}),g=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"}),b=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"}),m=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.errorCalloutTitle",{defaultMessage:"Rule failure at"}),f=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.partialErrorCalloutTitle",{defaultMessage:"Warning at"}),h=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.askAssistant",{defaultMessage:"Ask Assistant"}),v=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.askAssistantDesc",{defaultMessage:"Rule's execution failure message"}),x=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.askAssistantUserPrompt",{defaultMessage:"Can you explain this rule execution error and steps to fix?"}),E=c.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.askAssistantToolTip",{defaultMessage:"Add this rule execution error as context"}),y=({status:e,date:t,children:n})=>{const a=Object(u.c)(e),r=Object(u.b)(e);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiHealth,{color:r},i.a.createElement(s.EuiText,{"data-test-subj":"ruleStatus",size:"xs"},null!=a?a:Object(l.d)()))),null!=t&&null!=e&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,p)),i.a.createElement(s.EuiFlexItem,{grow:!0},i.a.createElement(o.a,{value:t,fieldName:g}))),i.a.createElement(s.EuiFlexItem,{grow:!1},n))},S=i.a.memo(y);S.displayName="RuleStatus";var O=n(1538),I=n(41),j=n.n(I),T=n(2135),w=n(341),C=n(178),k=n(533);const M=({ruleName:e,dataSources:t,date:n,message:a,status:l})=>{const{hasAssistantPrivilege:u,isAssistantEnabled:c}=Object(k.a)(),{shouldBeDisplayed:d,color:p,title:g}=D(l),b=Object(r.useCallback)((async()=>null!=e&&null!=t?`Rule name: ${e}\nData sources: ${t}\nError message: ${a}`:`Error message: ${a}`),[a,e,t]);return d?i.a.createElement(_,null,i.a.createElement(s.EuiCallOut,{title:i.a.createElement(i.a.Fragment,null,g," ",i.a.createElement(o.a,{value:n,fieldName:"execution_summary.last_execution.date"})),color:p,iconType:"warning","data-test-subj":"ruleStatusFailedCallOut"},i.a.createElement(s.EuiCodeBlock,{className:"eui-fullWidth",paddingSize:"none",isCopyable:!0,overflowHeight:96,transparentBackground:!0},a),u&&i.a.createElement(T.a,{category:"detection-rules",color:p,conversationId:C.Qb,description:v,getPromptContext:b,suggestedUserPrompt:x,tooltip:E,isAssistantEnabled:c},h))):null},R=i.a.memo(M);R.displayName="RuleStatusFailedCallOut";const D=e=>{switch(e){case w.g.failed:return{shouldBeDisplayed:!0,color:"danger",title:m};case w.g["partial failure"]:return{shouldBeDisplayed:!0,color:"warning",title:f};default:return{shouldBeDisplayed:!1,color:"warning",title:""}}};var _=j()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1dziiut-0"})(["pre{margin-block-end:0;margin-right:24px;padding-inline-end:0;}"])},1679:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),r=n.n(a),i=n(19);const s=({text:e})=>r.a.createElement(i.EuiCodeBlock,{className:"eui-fullWidth",isCopyable:!0,overflowHeight:320,transparentBackground:!0},null!=e?e:""),o=r.a.memo(s);o.displayName="TextBlock"},1680:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=e=>{const{getItemId:t,renderItem:n}=e,[r,i]=Object(a.useState)({}),s=Object(a.useCallback)((e=>{const a={...r},s=t(e);a[s]?delete a[s]:a[s]=n(e),i(a)}),[r,t,n]),o=Object(a.useCallback)((e=>{const n=t(e);return null!=r[n]}),[r,t]);return Object(a.useMemo)((()=>({itemIdToExpandedRowMap:r,getItemId:t,toggleRowExpanded:s,isRowExpanded:o})),[r,t,s,o])}},1681:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.topN.closeButtonLabel",{defaultMessage:"Close"}),i=a.i18n.translate("xpack.securitySolution.topN.allEventsSelectLabel",{defaultMessage:"Alerts and events"}),s=a.i18n.translate("xpack.securitySolution.topN.rawEventsSelectLabel",{defaultMessage:"Raw events"}),o=a.i18n.translate("xpack.securitySolution.topN.alertEventsSelectLabel",{defaultMessage:"Detection alerts"})},1863:function(e,t,n){"use strict";var a=n(1864),r=n(2);function i(e,t,n){return e[t]?e[t][0]?e[t][0][n]:e[t][n]:"contentBoxSize"===t?e.contentRect["inlineSize"===n?"width":"height"]:void 0}e.exports=function(e){void 0===e&&(e={});var t=e.onResize,n=r.useRef(void 0);n.current=t;var s=e.round||Math.round,o=r.useRef(),l=r.useState({width:void 0,height:void 0}),u=l[0],c=l[1],d=r.useRef(!1);r.useEffect((function(){return d.current=!1,function(){d.current=!0}}),[]);var p=r.useRef({width:void 0,height:void 0}),g=function(e,t){var n=r.useRef(null),a=r.useRef(null);a.current=t;var i=r.useRef(null);r.useEffect((function(){s()}));var s=r.useCallback((function(){var t=i.current,r=a.current,s=t||(r?r instanceof Element?r:r.current:null);n.current&&n.current.element===s&&n.current.subscriber===e||(n.current&&n.current.cleanup&&n.current.cleanup(),n.current={element:s,subscriber:e,cleanup:s?e(s):void 0})}),[e]);return r.useEffect((function(){return function(){n.current&&n.current.cleanup&&(n.current.cleanup(),n.current=null)}}),[]),r.useCallback((function(e){i.current=e,s()}),[s])}(r.useCallback((function(t){return o.current&&o.current.box===e.box&&o.current.round===s||(o.current={box:e.box,round:s,instance:new a.ResizeObserver((function(t){var a=t[0],r="border-box"===e.box?"borderBoxSize":"device-pixel-content-box"===e.box?"devicePixelContentBoxSize":"contentBoxSize",o=i(a,r,"inlineSize"),l=i(a,r,"blockSize"),u=o?s(o):void 0,g=l?s(l):void 0;if(p.current.width!==u||p.current.height!==g){var b={width:u,height:g};p.current.width=u,p.current.height=g,n.current?n.current(b):d.current||c(b)}}))}),o.current.instance.observe(t,{box:e.box}),function(){o.current&&o.current.instance.unobserve(t)}}),[e.box,s]),e.ref);return r.useMemo((function(){return{ref:g,width:u.width,height:u.height}}),[g,u.width,u.height])}},1864:function(e,t,n){!function(e){"use strict";var t,n=[],a="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(t||(t={}));var r,i=function(e){return Object.freeze(e)},s=function(e,t){this.inlineSize=e,this.blockSize=t,i(this)},o=function(){function e(e,t,n,a){return this.x=e,this.y=t,this.width=n,this.height=a,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,i(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),l=function(e){return e instanceof SVGElement&&"getBBox"in e},u=function(e){if(l(e)){var t=e.getBBox(),n=t.width,a=t.height;return!n&&!a}var r=e,i=r.offsetWidth,s=r.offsetHeight;return!(i||s||e.getClientRects().length)},c=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},d="undefined"!=typeof window?window:{},p=new WeakMap,g=/auto|scroll/,b=/^tb|vertical/,m=/msie|trident/i.test(d.navigator&&d.navigator.userAgent),f=function(e){return parseFloat(e||"0")},h=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new s((n?t:e)||0,(n?e:t)||0)},v=i({devicePixelContentBoxSize:h(),borderBoxSize:h(),contentBoxSize:h(),contentRect:new o(0,0,0,0)}),x=function(e,t){if(void 0===t&&(t=!1),p.has(e)&&!t)return p.get(e);if(u(e))return p.set(e,v),v;var n=getComputedStyle(e),a=l(e)&&e.ownerSVGElement&&e.getBBox(),r=!m&&"border-box"===n.boxSizing,s=b.test(n.writingMode||""),c=!a&&g.test(n.overflowY||""),d=!a&&g.test(n.overflowX||""),x=a?0:f(n.paddingTop),E=a?0:f(n.paddingRight),y=a?0:f(n.paddingBottom),S=a?0:f(n.paddingLeft),O=a?0:f(n.borderTopWidth),I=a?0:f(n.borderRightWidth),j=a?0:f(n.borderBottomWidth),T=S+E,w=x+y,C=(a?0:f(n.borderLeftWidth))+I,k=O+j,M=d?e.offsetHeight-k-e.clientHeight:0,R=c?e.offsetWidth-C-e.clientWidth:0,D=r?T+C:0,_=r?w+k:0,A=a?a.width:f(n.width)-D-R,N=a?a.height:f(n.height)-_-M,F=A+T+R+C,P=N+w+M+k,z=i({devicePixelContentBoxSize:h(Math.round(A*devicePixelRatio),Math.round(N*devicePixelRatio),s),borderBoxSize:h(F,P,s),contentBoxSize:h(A,N,s),contentRect:new o(S,x,A,N)});return p.set(e,z),z},E=function(e,n,a){var r=x(e,a),i=r.borderBoxSize,s=r.contentBoxSize,o=r.devicePixelContentBoxSize;switch(n){case t.DEVICE_PIXEL_CONTENT_BOX:return o;case t.BORDER_BOX:return i;default:return s}},y=function(e){var t=x(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=i([t.borderBoxSize]),this.contentBoxSize=i([t.contentBoxSize]),this.devicePixelContentBoxSize=i([t.devicePixelContentBoxSize])},S=function(e){if(u(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},O=function(){var e=1/0,t=[];n.forEach((function(n){if(0!==n.activeTargets.length){var a=[];n.activeTargets.forEach((function(t){var n=new y(t.target),r=S(t.target);a.push(n),t.lastReportedSize=E(t.target,t.observedBox),r<e&&(e=r)})),t.push((function(){n.callback.call(n.observer,a,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var a=0,r=t;a<r.length;a++)(0,r[a])();return e},I=function(e){n.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(S(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},j=function(){var e,t=0;for(I(t);n.some((function(e){return e.activeTargets.length>0}));)t=O(),I(t);return n.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:a}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=a),window.dispatchEvent(e)),t>0},T=[],w=function(e){if(!r){var t=0,n=document.createTextNode("");new MutationObserver((function(){return T.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),r=function(){n.textContent="".concat(t?t--:t++)}}T.push(e),r()},C=0,k={attributes:!0,characterData:!0,childList:!0,subtree:!0},M=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],R=function(e){return void 0===e&&(e=0),Date.now()+e},D=!1,_=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t,n=this;if(void 0===e&&(e=250),!D){D=!0;var a=R(e);t=function(){var t=!1;try{t=j()}finally{if(D=!1,e=a-R(),!C)return;t?n.run(1e3):e>0?n.run(e):n.start()}},w((function(){requestAnimationFrame(t)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,k)};document.body?t():d.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),M.forEach((function(t){return d.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),M.forEach((function(t){return d.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),A=function(e){!C&&e>0&&_.start(),!(C+=e)&&_.stop()},N=function(){function e(e,n){this.target=e,this.observedBox=n||t.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=E(this.target,this.observedBox,!0);return e=this.target,!l(e)&&!function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)&&"inline"===getComputedStyle(e).display&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),F=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},P=new WeakMap,z=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},B=function(){function e(){}return e.connect=function(e,t){var n=new F(e,t);P.set(e,n)},e.observe=function(e,t,a){var r=P.get(e),i=0===r.observationTargets.length;z(r.observationTargets,t)<0&&(i&&n.push(r),r.observationTargets.push(new N(t,a&&a.box)),A(1),_.schedule())},e.unobserve=function(e,t){var a=P.get(e),r=z(a.observationTargets,t),i=1===a.observationTargets.length;r>=0&&(i&&n.splice(n.indexOf(a),1),a.observationTargets.splice(r,1),A(-1))},e.disconnect=function(e){var t=this,n=P.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),U=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");B.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");B.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");B.unobserve(this,e)},e.prototype.disconnect=function(){B.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();e.ResizeObserver=U,e.ResizeObserverEntry=y,e.ResizeObserverSize=s,Object.defineProperty(e,"__esModule",{value:!0})}(t)},1866:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n(241),i=n(1677),s=n(812),o=n(1340),l=n(578),u=n(755),c=n(1867);const d=(e,t,n,d,p,g,b,m,f)=>{const{http:h}=Object(r.b)(),{data:v}=Object(u.a)({http:h}),x=Object(a.useMemo)((()=>Object(o.b)(v)),[v]),E=Object(a.useMemo)((()=>Object(l.c)(x)),[x]),{createConversation:y}=Object(s.a)(),S=Object(a.useCallback)((e=>Object(o.e)({},e)),[]),{data:O,isLoading:I}=Object(c.b)({http:h,onFetch:S,isAssistantEnabled:m}),j=Object(a.useMemo)((()=>e),[e]),T=Object(a.useMemo)((()=>n),[n]),w=Object(a.useMemo)((()=>d),[d]),C=Object(a.useMemo)((()=>null!=p?p:Object(i.a)()),[p]),k=Object(a.useMemo)((()=>null!=g?g:void 0),[g]),M=Object(a.useMemo)((()=>b),[b]),R=Object(a.useMemo)((()=>f),[f]),{registerPromptContext:D,showAssistantOverlay:_,unRegisterPromptContext:A}=Object(r.b)(),N=Object(a.useCallback)((async e=>{let n;if(I||(n=t?Object.values(O).find((e=>e.title===t)):void 0),m&&!n&&x&&!I)try{n=await y({apiConfig:{...E,actionTypeId:null==x?void 0:x.actionTypeId,connectorId:null==x?void 0:x.id},category:"assistant",title:null!=t?t:""})}catch(e){}null!=C&&_({showOverlay:e,promptContextId:C,conversationTitle:null!=t?t:void 0})}),[E,_,t,O,y,x,m,I,C]);return Object(a.useEffect)((()=>(A(C),D({category:j,description:T,getPromptContext:w,id:C,suggestedUserPrompt:k,tooltip:M,replacements:null!=R?R:void 0}),()=>A(C))),[j,T,w,R,k,M,C,D,A]),{promptContextId:C,showAssistantOverlay:N}}},2135:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(19),r=n(2),i=n.n(r),s=n(1866);const o=n(4).i18n.translate("xpack.elasticAssistant.assistant.newChat.newChatButton",{defaultMessage:"Chat"});var l=n(43);const u=({category:e,color:t="primary",children:n=o,conversationId:i,description:u,getPromptContext:c,iconType:d,promptContextId:p,suggestedUserPrompt:g,tooltip:b,isAssistantEnabled:m,asLink:f=!1,onShowOverlay:h})=>{const{showAssistantOverlay:v}=Object(s.a)(e,null!=i?i:null,u,c,null!=p?p:null,g,b,m),x=Object(r.useCallback)((()=>{v(!0),null==h||h()}),[v,h]),E=Object(r.useMemo)((()=>{if(null!==d)return null!=d?d:"discuss"}),[d]);return Object(r.useMemo)((()=>f?Object(l.jsx)(a.EuiLink,{color:t,"data-test-subj":"newChatLink",onClick:x},n):Object(l.jsx)(a.EuiButtonEmpty,{color:t,"data-test-subj":"newChat",onClick:x,iconType:E},n)),[n,E,x,t,f])};u.displayName="NewChatComponent";const c=i.a.memo(u)},270:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return g}));var a=n(44),r=n(2),i=n.n(r),s=n(293),o=n(532);const l={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},u=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},c=Object(r.createContext)([l,()=>a.noop]),d=()=>Object(r.useContext)(c),p=({children:e})=>i.a.createElement(c.Provider,{value:Object(r.useReducer)(u,l)},e),g=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:i,hasIndexRead:l,hasIndexUpdateDelete:u,isSignalIndexExists:c,isAuthenticated:p,hasEncryptionKey:g,loading:b,signalIndexName:m,signalIndexMappingOutdated:f},h]=d(),{loading:v,isAuthenticated:x,hasEncryptionKey:E,hasIndexManage:y,hasIndexMaintenance:S,hasIndexUpdateDelete:O,hasIndexWrite:I,hasIndexRead:j,hasKibanaCRUD:T,hasKibanaREAD:w}=Object(s.a)(),{loading:C,signalIndexExists:k,signalIndexName:M,signalIndexMappingOutdated:R,createDeSignalIndex:D}=Object(o.a)();return Object(r.useEffect)((()=>{b||e===T||h({type:"updateCanUserCRUD",canUserCRUD:T})}),[h,b,e,T]),Object(r.useEffect)((()=>{b||t===w||h({type:"updateCanUserREAD",canUserREAD:w})}),[h,b,t,w]),Object(r.useEffect)((()=>{b!==(v||C)&&h({type:"updateLoading",loading:v||C})}),[h,b,v,C]),Object(r.useEffect)((()=>{b||n===y||null==y||h({type:"updateHasIndexManage",hasIndexManage:y})}),[h,b,n,y]),Object(r.useEffect)((()=>{b||i===I||null==I||h({type:"updateHasIndexWrite",hasIndexWrite:I})}),[h,b,i,I]),Object(r.useEffect)((()=>{b||l===j||null==j||h({type:"updateHasIndexRead",hasIndexRead:j})}),[h,b,l,j]),Object(r.useEffect)((()=>{b||u===O||null==O||h({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:O})}),[h,b,u,O]),Object(r.useEffect)((()=>{b||a===S||null==S||h({type:"updateHasIndexMaintenance",hasIndexMaintenance:S})}),[h,b,a,S]),Object(r.useEffect)((()=>{b||c===k||null==k||h({type:"updateIsSignalIndexExists",isSignalIndexExists:k})}),[h,b,c,k]),Object(r.useEffect)((()=>{b||p===x||null==x||h({type:"updateIsAuthenticated",isAuthenticated:x})}),[h,b,p,x]),Object(r.useEffect)((()=>{b||g===E||null==E||h({type:"updateHasEncryptionKey",hasEncryptionKey:E})}),[h,b,g,E]),Object(r.useEffect)((()=>{b||m===M||null==M||h({type:"updateSignalIndexName",signalIndexName:M})}),[h,b,m,M]),Object(r.useEffect)((()=>{b||f===R||null==R||h({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:R})}),[h,b,f,R]),Object(r.useEffect)((()=>{p&&g&&n&&(null!=c&&!c||null!=f&&f)&&null!=D&&D()}),[D,p,g,c,n,f]),{loading:b,isSignalIndexExists:c,isAuthenticated:p,hasEncryptionKey:g,canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:i,hasIndexRead:l,hasIndexUpdateDelete:u,signalIndexName:m,signalIndexMappingOutdated:f}}},293:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(140);const i=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:n,kibanaSecuritySolutionsPrivileges:{crud:i,read:s}}=Object(r.a)();return Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:i,hasKibanaREAD:s})}),[n.error,i,s]),Object(a.useEffect)((()=>{if(null!=n.result){const e=n.result;if(null!=e.index&&Object.keys(e.index).length>0){const n=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[n].manage&&e.cluster.manage,hasIndexMaintenance:e.index[n].maintenance,hasIndexRead:e.index[n].read,hasIndexWrite:e.index[n].create||e.index[n].create_doc||e.index[n].index||e.index[n].write,hasIndexUpdateDelete:e.index[n].write,hasKibanaCRUD:i,hasKibanaREAD:s})}}}),[n.result,i,s]),{loading:n.loading,...e}}},527:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(2),r=n(5),i=n(983),s=n(707),o=n(123),l=n(118),u=n(1367),c=n(201),d=n(896),p=n(47),g=n(1249);const b=["GET","/internal/ml/modules/get_module/:moduleId"],m=["GET","/internal/ml/modules/recognize/:indexPatterns"];var f=n(1339);const h=["security_cloudtrail","security_packetbeat","security_auth","security_linux_v3","security_network","security_windows_v3"],v=(e,t,n)=>{const a=t.find((t=>t.id===e));return void 0!==a?{moduleId:a.moduleId,defaultIndexPattern:a.defaultIndexPattern,isCompatible:n.includes(a.moduleId),isElasticJob:!0}:{moduleId:"",defaultIndexPattern:"",isCompatible:!0,isElasticJob:!1}},x=()=>{const e=Object(c.a)(),[t]=Object(l.o)(r.O),{addError:n}=Object(o.a)(),x=Object(i.a)(e),E=Object(s.a)(e),y=x&&E,S=Object(a.useCallback)((e=>{n(e,{title:d.a})}),[n]),{data:O,isFetching:I,refetch:j}=Object(u.a)({},{enabled:y,onError:S}),{data:T,isFetching:w,refetch:C}=(k={},M={enabled:y,onError:S},Object(p.useQuery)([b,k],(async({signal:e})=>Object(g.b)({signal:e,...k})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...M}));var k,M;const{data:R,isFetching:D,refetch:_}=((e,t)=>Object(p.useQuery)([m,e],(async({signal:t})=>Object(g.a)({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t}))({indexPatternName:t},{enabled:y,onError:S}),A=Object(a.useCallback)((()=>{j(),C(),_()}),[j,C,_]);return{isLicensed:E,isMlAdmin:x,jobs:Object(a.useMemo)((()=>O&&T&&R?((e,t,n)=>{const a=n.map((e=>e.id)),r=((e,t)=>e.filter((e=>h.includes(e.id))).map((e=>[...e.jobs.map((n=>((e,t,n)=>({datafeedId:"",datafeedIndices:[],datafeedState:"",hasDatafeed:!1,isSingleMetricViewerJob:!1,jobState:"closed",memory_status:"",processed_record_count:0,id:t.id,description:t.config.description,groups:[...t.config.groups].sort(),defaultIndexPattern:e.defaultIndexPattern,moduleId:e.id,isCompatible:n,isInstalled:!1,isElasticJob:!0,awaitingNodeAssignment:!1,jobTags:{},bucketSpanSeconds:900,customSettings:t.config.custom_settings}))(e,n,t.includes(e.id))))])).flat())(t,a),i=((e,t,n)=>e.filter(f.a).map((e=>({...e,...v(e.id,t,n),isInstalled:!0}))))(e,r,a);return((e,t)=>{const n=e.map((e=>e.id));return[...e,...t.filter((e=>!n.includes(e.id)))].sort(((e,t)=>e.id.localeCompare(t.id)))})(i,r)})(O,T,R):[]),[R,O,T]),loading:I||w||D,refetch:A}}},532:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),r=n(128),i=n(45),s=n(123),o=n(370),l=n(803),u=n(293),c=n(148);const d=()=>{const[e,t]=Object(a.useState)(!0),[n,d]=Object(a.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:p}=Object(s.a)(),{hasIndexRead:g}=Object(u.a)(),b=Object(i.useSelector)((e=>c.e.signalIndexMappingOutdated(e))),m=Object(i.useSelector)((e=>c.e.signalIndexName(e)));return Object(a.useEffect)((()=>{let e=!0;const n=new AbortController,a=async()=>{try{t(!0);const a=await Object(o.g)({signal:n.signal});e&&null!=a&&d({signalIndexExists:!0,signalIndexName:a.name,signalIndexMappingOutdated:a.index_mapping_outdated,createDeSignalIndex:i})}catch(t){e&&(d({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:i}),Object(r.u)(t)&&404!==t.body.status_code&&p(t,{title:l.c}))}e&&t(!1)},i=async()=>{let s=!1;try{t(!0),await Object(o.d)({signal:n.signal}),e&&(s=!0,a())}catch(t){e&&(Object(r.u)(t)&&409===t.body.status_code?a():(d({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:i}),p(t,{title:l.d})))}e&&!s&&t(!1)};return m?(d({signalIndexExists:!0,signalIndexName:m,signalIndexMappingOutdated:b,createDeSignalIndex:i}),t(!1)):g?a():t(!1),()=>{e=!1,n.abort()}}),[p,g,m,b]),{loading:e,...n}}},533:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(16),r=n(118),i=n(5);const s=()=>{var e,t,n,s,o,l;const u=Object(a.b)().isEnterprise(),c=Object(r.j)().services.application.capabilities,d=!0===(null===(e=c[i.r])||void 0===e?void 0:e["ai-assistant"]),p=!0===(null===(t=c[i.r])||void 0===t?void 0:t.updateAIAssistantAnonymization),g=!0===(null===(n=c.actions)||void 0===n?void 0:n.show)&&!0===(null===(s=c.actions)||void 0===s?void 0:s.execute);return{hasAssistantPrivilege:d,hasConnectorsAllPrivilege:g&&!0===(null===(o=c.actions)||void 0===o?void 0:o.delete)&&!0===(null===(l=c.actions)||void 0===l?void 0:l.save),hasConnectorsReadPrivilege:g,isAssistantEnabled:u,hasUpdateAIAssistantAnonymization:p}}},585:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return f}));var a=n(748),r=n(813),i=n(1341),s=n(1490),o=n(893);const l=e=>{const t="acknowledged"===e?{bool:{should:[{term:{[a.G]:e}},{term:{[a.G]:"in-progress"}}]}}:{term:{[a.G]:e}};return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.G,params:{query:e}},query:t}]},u=e=>[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({term:{[a.G]:e}})))}}}],c=e=>e?[{meta:{alias:null,negate:!1,index:"security-solution-default",disabled:!1,type:"phrase",key:r.l,params:{query:e}},query:{match_phrase:{[r.l]:e}}}]:[],d=e=>e?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"exists",key:i.a,value:"exists",index:"security-solution-default"},query:{exists:{field:i.a}}}],p=e=>e?[{meta:{alias:null,disabled:!1,negate:!1,key:"kibana.alert.rule.type",type:"term",index:"security-solution-default"},query:{term:{"kibana.alert.rule.type":"threat_match"}}}]:[],g=e=>e.length?[{meta:{alias:null,negate:!1,disabled:!1,index:"security-solution-default"},query:{bool:{should:e.map((e=>e?{term:{[a.F]:e}}:{bool:{must_not:{exists:{field:a.F}}}}))}}}]:[],b=e=>({...s.d,columns:Object(o.c)(e),showCheckboxes:!0}),m=e=>({...b(e),columns:Object(o.d)(e),defaultColumns:Object(o.d)(e),sort:[{columnId:"kibana.alert.original_time",columnType:"date",esTypes:["date"],sortDirection:"desc"}],showCheckboxes:!1}),f=["@timestamp","kibana.alert.workflow_status","kibana.alert.workflow_tags","kibana.alert.workflow_assignee_ids","kibana.alert.group.id","kibana.alert.original_time","kibana.alert.building_block_type","kibana.alert.rule.from","kibana.alert.rule.name","kibana.alert.rule.to","kibana.alert.rule.uuid","kibana.alert.rule.rule_id","kibana.alert.rule.type","kibana.alert.suppression.docs_count","kibana.alert.original_event.kind","kibana.alert.original_event.module","file.path","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.hash.sha256","host.os.family","event.code","process.entry_leader.entity_id"]},757:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const r=(e=!1)=>{const[t,n]=Object(a.useState)(e);return[t,Object(a.useCallback)((()=>{n(!0)}),[]),Object(a.useCallback)((()=>{n(!1)}),[]),Object(a.useCallback)((()=>{n((e=>!e))}),[])]}},758:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return E}));var a=n(748),r=n(1341),i=n(813),s=n(1630),o=n(146),l=n(127),u=n(1681);const c=[s.b.alertsOnAlertsPage,s.b.alertsOnRuleDetailsPage,s.b.alertsOnCasePage,o.c.casePage],d=[{value:"all",inputDisplay:u.b,"data-test-subj":"option-all"}],p=[{value:"raw",inputDisplay:u.d,"data-test-subj":"option-raw"}],g=[{value:"alert",inputDisplay:u.a,"data-test-subj":"option-alert"}],b=[...p,...g],m=e=>{switch(e){case"all":return d;case"raw":return p;case"alert":return g;default:return b}},f=e=>!!e&&c.includes(e),h=[a.a,r.a,a.d,a.e,r.c,r.d,a.h,a.k,a.s,a.o,a.u,a.m,i.a,a.B,i.A,a.G,i.C,i.b,i.c,i.d,i.e,i.f,i.g,i.h,i.i,a.r,i.j,a.t,i.k,i.l,i.m,a.w,i.n,i.o,a.x,i.p,i.q,a.y,a.n,i.r,i.s,a.A,i.z,a.E,"signal.rule.building_block_type","signal.rule.id","signal.rule.name","signal.rule.threat_mapping","signal.status"],v=({tableId:e,view:t})=>"raw"===t&&f(e),x=({filters:e,tableId:t,view:n})=>v({tableId:t,view:n})?e.filter((e=>!h.includes(`${e.meta.key}`))):e,E=({scopeId:e,view:t})=>v({tableId:e,view:t})?l.SourcererScopeName.default:f(e)?l.SourcererScopeName.detections:e===o.c.active?l.SourcererScopeName.timeline:l.SourcererScopeName.default},803:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(4);const r=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorGetAlertDescription",{defaultMessage:"Failed to get signal index name"}),i=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorPostAlertDescription",{defaultMessage:"Failed to create signal index"}),s=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.failedToIsolate.title",{defaultMessage:"Failed to isolate host"}),o=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.casesFromAlerts.title",{defaultMessage:"Failed to find associated cases"});a.i18n.translate("xpack.securitySolution.containers.detectionEngine.users.userProfiles.title",{defaultMessage:"Failed to find users"})},982:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),r=n.n(a),i=n(19),s=n(41),o=n.n(s);const l=o()(i.EuiFlexGroup).withConfig({displayName:"PopoverItemsWrapper",componentId:"sc-189fe59-0"})(["width:100%;"]),u=o()(i.EuiBadgeGroup).withConfig({displayName:"PopoverWrapper",componentId:"sc-189fe59-1"})(["max-height:200px;max-width:600px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),c=({items:e,renderItem:t,popoverTitle:n,popoverButtonTitle:s,popoverButtonIcon:o,numberOfItemsToDisplay:c=0,dataTestPrefix:d="items"})=>{const[p,g]=Object(a.useState)(!1),b=({items:e})=>r.a.createElement(r.a.Fragment,null,e.map(t));return e.length<=c?r.a.createElement(l,{"data-test-subj":d,alignItems:"center",gutterSize:"s"},r.a.createElement(b,{items:e})):r.a.createElement(l,{alignItems:"center",gutterSize:"s","data-test-subj":d},0!==c&&r.a.createElement(i.EuiFlexItem,{grow:1,className:"eui-textTruncate"},r.a.createElement(b,{items:e.slice(0,c)})),r.a.createElement(i.EuiPopover,{ownFocus:!0,"data-test-subj":`${d}DisplayPopover`,button:r.a.createElement(i.EuiBadge,{iconType:o,color:"hollow","data-test-subj":`${d}DisplayPopoverButton`,onClick:()=>g(!p),onClickAriaLabel:s},s),isOpen:p,closePopover:()=>g(!p),repositionOnScroll:!0},n?r.a.createElement(i.EuiPopoverTitle,{"data-test-subj":`${d}DisplayPopoverTitle`},n):null,r.a.createElement(u,{"data-test-subj":`${d}DisplayPopoverWrapper`},r.a.createElement(b,{items:e.slice(c)}))))},d=r.a.memo(c);d.displayName="PopoverItems";const p=d},983:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>r(e)&&i(e)&&s(e)&&o(e),r=({capabilities:e})=>e.canGetDatafeeds&&e.canStartStopDatafeed&&e.canUpdateDatafeed&&e.canPreviewDatafeed,i=({capabilities:e})=>e.canCreateJob&&e.canGetJobs&&e.canUpdateJob&&e.canDeleteJob&&e.canOpenJob&&e.canCloseJob&&e.canForecastJob,s=({capabilities:e})=>e.canGetFilters&&e.canCreateFilter&&e.canDeleteFilter,o=({capabilities:e})=>e.canCreateCalendar&&e.canGetCalendars&&e.canDeleteCalendar},984:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(44),r=n(2),i=n(1863),s=n.n(i);n(72),n(73);const o=(e=100)=>{const[t,n]=Object(r.useState)({width:0,height:0}),i=Object(r.useMemo)((()=>Object(a.throttle)(e,n)),[e]),{ref:o}=s()({onResize:i});return{ref:o,...t}},l=(e,t,n,a)=>{Object(r.useEffect)((()=>{!async function(){const r=await(null==e?void 0:e.getVariation(t,n));r&&a(r)}()}),[e,t,n,a])}}}]);