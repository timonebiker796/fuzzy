/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[71],{2141:function(e,t,i){"use strict";i.r(t),i.d(t,"loadFieldExisting",(function(){return d}));var n=i(1725),a=i(3);function r(e,t,i,n){return{bool:{filter:e&&t&&i?[{range:{[e]:{format:"strict_date_optional_time",gte:t,lte:i}}},n]:[n]}}}function s(e,t){const i=new Set(e.map((e=>e.name)));return t.filter((e=>e.isScript||e.runtimeField||i.has(e.name))).map((e=>e.name))}const d=async({data:e,dslQuery:t,fromDate:i,toDate:d,timeFieldName:l,dataViewsService:o,uiSettingsClient:c,dataView:u})=>{const m=c.get(n.a.SEARCH_INCLUDE_FROZEN),F=c.get(n.a.META_FIELDS);return await async function({search:e,dataViewsService:t,dataView:i,dslQuery:n={match_all:{}},fromDate:a,toDate:d,timeFieldName:l,includeFrozen:o,metaFields:c}){const u=await t.getFieldsForIndexPattern(i,{pattern:"",indexFilter:r(l,a,d,n),includeEmptyFields:!1}),m=u.filter((e=>!i.getFieldByName(e.name)));m.length&&await t.refreshFields(i,!1,!0);const F=function(e,t){return e.fields.map((e=>function(e,t){return{name:e.name,isScript:!!e.scripted,lang:e.lang,script:e.script,isMeta:(null==t?void 0:t.includes(e.name))||"_id"===e.name,runtimeField:e.isMapped?void 0:e.runtimeField}}(e,t)))}(i,c);return{indexPatternTitle:i.getIndexPattern(),existingFieldNames:s(u,F),newFields:m}}({dslQuery:t,fromDate:i,toDate:d,timeFieldName:l,dataViewsService:o,includeFrozen:m,metaFields:F,dataView:u,search:async t=>(await Object(a.lastValueFrom)(e.search.search({params:t}))).rawResponse})}}}]);