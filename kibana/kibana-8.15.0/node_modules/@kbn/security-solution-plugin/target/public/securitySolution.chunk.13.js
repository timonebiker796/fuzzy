/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[13],{1203:function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));var n=a(2),s=a.n(n),o=a(19),i=a(42),l=a(4),u=a(126),r=a(119),c=a.n(r),d=a(1213),m=a(10);const p=Object(n.memo)((({agentType:e,...t})=>{const i=Object(d.a)(),[l,u]=Object(n.useState)("empty");return Object(n.useEffect)((()=>{if(i()){const t=e=>{i()&&u(e)};switch(e){case"endpoint":u("logoSecurity");break;case"sentinel_one":a.e(99).then(a.t.bind(null,2095,7)).then((e=>e.default)).then(t);break;case"crowdstrike":a.e(98).then(a.t.bind(null,2096,7)).then((e=>e.default)).then(t)}}}),[e,i]),s.a.createElement(o.EuiIcon,c()({type:l,title:"empty"===l?"":Object(m.n)(e),size:"m"},t))}));p.displayName="AgentTypeVendorLogo";const g=l.i18n.translate("xpack.securitySolution.agentTypeIntegration.integrationSectionLabel",{defaultMessage:"Integration"}),M=Object(n.memo)((({agentType:e,textSize:t="s",layout:a="vertical","data-test-subj":n})=>{const l=Object(u.a)(n);return s.a.createElement(o.EuiFlexGroup,{direction:"horizontal"===a?"row":"column",gutterSize:"s","data-test-subj":l()},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiText,{color:"subdued",size:t,"data-test-subj":l("label")},g,"Â ",s.a.createElement(o.EuiIconTip,{content:s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responder.header.integrationSectionLabelTooltip",defaultMessage:"The integration used to execute response actions on this host"}),position:"horizontal"===a?"bottom":"right",anchorProps:{"data-test-subj":l("tooltipAnchor")}}))),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiFlexGroup,{responsive:!1,wrap:!1,gutterSize:"xs",alignItems:"center"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(p,{agentType:e,"data-test-subj":l("vendorLogo")})),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiText,{size:t,"data-test-subj":l("name")},Object(m.n)(e))))))}));M.displayName="AgentTypeIntegration"},1321:function(e,t,a){"use strict";a.d(t,"a",(function(){return ne}));var n=a(19),s=a(2),o=a.n(s),i=a(42),l=a(122),u=a(174),r=a(517),c=a(620),d=a(296),m=a(126),p=a(59),g=a(56),M=a(55);const j=p.euiStyled.div`
  padding-bottom: ${e=>`${e.theme.eui.euiSizeL}`};
`,y=Object(s.memo)((({dateRangePickerState:e,isDataLoading:t,onRefresh:a,onRefreshChange:i,onTimeChange:l,"data-test-subj":u})=>{const r=Object(m.a)(u),c=Object(g.useKibana)(),{uiSettings:d}=c.services,[p]=Object(s.useState)((()=>{var e,t;return null!==(e=null==d||null===(t=d.get(M.UI_SETTINGS.TIMEPICKER_QUICK_RANGES))||void 0===t?void 0:t.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a}))))&&void 0!==e?e:[]}));return o.a.createElement(j,{"data-test-subj":r("super-date-picker")},o.a.createElement(n.EuiFlexGroup,{alignItems:"center",direction:"row",responsive:!1,gutterSize:"s"},o.a.createElement(n.EuiFlexItem,null,o.a.createElement(n.EuiSuperDatePicker,{isLoading:t,dateFormat:d.get("dateFormat"),commonlyUsedRanges:p,end:e.endDate,isPaused:!e.autoRefreshOptions.enabled,onTimeChange:l,onRefreshChange:i,refreshInterval:e.autoRefreshOptions.duration,onRefresh:a,recentlyUsedRanges:e.recentlyUsedDateRanges,start:e.startDate,showUpdateButton:!1,updateButtonProps:{iconOnly:!0,fill:!1},width:"auto"}))))}));y.displayName="ActionLogDateRangePicker";var b=a(44),N=a(822);const E=Object(s.memo)((({children:e,closePopover:t,filterName:a,hasActiveFilters:i,isPopoverOpen:u,numActiveFilters:r,numFilters:c,onButtonClick:p,"data-test-subj":g})=>{const M=Object(m.a)(g),j=Object(l.a)("responseActionsSentinelOneV1Enabled"),y=Object(n.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),b=Object(s.useMemo)((()=>o.a.createElement(n.EuiFilterButton,{"data-test-subj":M(`${a}-filter-popoverButton`),iconType:"arrowDown",onClick:p,isSelected:u,numFilters:c,hasActiveFilters:i,numActiveFilters:r},"types"===a?j?d.c.types(2):d.c.types(1):d.c[a])),[a,M,i,u,j,r,c,p]);return o.a.createElement(n.EuiPopover,{button:b,closePopover:t,id:y,isOpen:u,panelPaddingSize:"none"},e)}));E.displayName="ActionsLogFilterPopover";var T=a(10),O=a(24);const I=Object(s.memo)((({color:e,status:t,"data-test-subj":a})=>o.a.createElement(n.EuiBadge,{"data-test-subj":a,color:e,title:""},t)));I.displayName="ResponseActionStatusBadge";var D=a(48),L=a(297);const h=e=>{const t={agentTypes:[],commands:[],hosts:[],statuses:[],startDate:A.startDate,endDate:A.endDate,users:[],withOutputs:[],types:[]},a=e.agentTypes?String(e.agentTypes).split(",").reduce(((e,t)=>(Object(N.b)(t)&&e.push(t),e.sort())),[]):[],n=e.commands?String(e.commands).split(",").reduce(((e,t)=>((u.e.includes(t)||"release"===t||"processes"===t)&&e.push(t),e.sort())),[]):[],s=e.hosts?String(e.hosts).split(",").sort():[],o=e.types?String(e.types).split(",").reduce(((e,t)=>(Object(N.a)(t)&&e.push(t),e.sort())),[]):[],i=e.withOutputs?String(e.withOutputs).split(",").sort():[],l=e.statuses?String(e.statuses).split(",").reduce(((e,t)=>(u.g.includes(t)&&e.push(t),e.sort())),[]):[],r=e.users?String(e.users).split(",").sort():[];return t.agentTypes=a.length?a:void 0,t.commands=n.length?n:void 0,t.hosts=s.length?s:void 0,t.statuses=l.length?l:void 0,t.startDate=e.startDate?String(e.startDate):void 0,t.endDate=e.endDate?String(e.endDate):void 0,t.users=r.length?r:void 0,t.withOutputs=i.length?i:void 0,t.types=o.length?o:void 0,t},v=()=>{const e=Object(D.useLocation)(),t=Object(D.useHistory)(),{urlParams:a,toUrlParams:n}=Object(L.a)(),o=Object(s.useMemo)((()=>h(a)),[a]),[i,l]=Object(s.useState)(o),u=Object(s.useCallback)((s=>{t.push({...e,search:n({...a,commands:s.length?s:void 0})})}),[t,e,n,a]),r=Object(s.useCallback)((s=>{t.push({...e,search:n({...a,hosts:s.length?s:void 0})})}),[t,e,n,a]),c=Object(s.useCallback)((s=>{t.push({...e,search:n({...a,withOutputs:s.length?s:void 0})})}),[t,e,n,a]),d=Object(s.useCallback)((s=>{t.push({...e,search:n({...a,statuses:s.length?s:void 0})})}),[t,e,n,a]),m=Object(s.useCallback)((({agentTypes:s,actionTypes:o})=>{t.push({...e,search:n({...a,agentTypes:s.length?s:void 0,types:o.length?o:void 0})})}),[t,e,n,a]),p=Object(s.useCallback)((s=>{t.push({...e,search:n({...a,types:s.length?s:void 0})})}),[t,e,n,a]),g=Object(s.useCallback)((s=>{t.push({...e,search:n({...a,users:s.length?s:void 0})})}),[t,e,n,a]),M=Object(s.useCallback)((({startDate:s,endDate:o})=>{t.push({...e,search:n({...a,startDate:s.length?s:void 0,endDate:o.length?o:void 0})})}),[t,e,n,a]);return Object(s.useEffect)((()=>{l((e=>({...e,...h(a)})))}),[l,a]),{...i,setUrlActionsFilters:u,setUrlDateRangeFilters:M,setUrlHostsFilters:r,setUrlWithOutputs:c,setUrlStatusesFilters:d,setUrlUsersFilters:g,setUrlTypeFilters:p,setUrlTypesFilters:m}};var S=a(47),f=a(118),x=a(167);const C=Object.freeze({default:50,all:1e4}),A=Object.freeze({autoRefreshOptions:{enabled:!1,duration:1e4},startDate:"now-24h/h",endDate:"now",recentlyUsedDateRanges:[]}),k=e=>"failed"===e?d.g.badge.failed:"successful"===e?d.g.badge.successful:"pending"===e?d.g.badge.pending:"",z=e=>"automated"===e?d.d.automated:d.d.manual,w=Object(p.euiStyled)(n.EuiButtonEmpty).attrs({iconType:"cross",color:"danger"})`
  border-top: ${e=>`${e.theme.eui.euiBorderThin}`};
  border-radius : 0;
`,F=Object(s.memo)((({"data-test-subj":e,isDisabled:t,onClick:a})=>o.a.createElement(w,{"data-test-subj":e,isDisabled:t,onClick:a},d.g.filterClearAll)));F.displayName="ClearAllButton";const U=Object(s.memo)((({filterName:e,typesFilters:t,isFlyout:a,onChangeFilterOptions:i,"data-test-subj":r})=>{const c=Object(m.a)(r),p=Object(l.a)("responseActionsSentinelOneV1Enabled"),[g,M]=Object(s.useState)(!1),j=Object(s.useCallback)((()=>{M(!g)}),[M,g]),y=Object(s.useCallback)((()=>{M(!1)}),[M]),[D,L]=Object(s.useState)(""),{areHostsSelectedOnMount:h,isLoading:A,items:w,setItems:U,hasActiveFilters:R,numActiveFilters:Q,numFilters:P,setAreHostsSelectedOnMount:Y,setUrlActionsFilters:H,setUrlHostsFilters:G,setUrlStatusesFilters:B,setUrlTypesFilters:_,setUrlTypeFilters:q}=(({filterName:e,isFlyout:t,searchString:a})=>{const{agentTypes:n=[],commands:i,statuses:r,hosts:c,types:m=[],setUrlActionsFilters:p,setUrlHostsFilters:g,setUrlStatusesFilters:M,setUrlTypesFilters:j,setUrlTypeFilters:y}=v(),b="statuses"===e,N="hosts"===e,E="types"===e,{data:D,isFetching:L}=(({searchString:e,selectedAgentIds:t,options:a={}})=>{const n=Object(f.i)(),s=`united.endpoint.host.hostname:${e.length?`*${e}`:""}*`;let o=[];return t&&(o=t.map((e=>`united.endpoint.agent.id:"${e}"`))),Object(S.useQuery)({queryKey:["get-endpoints-list",s],...a,queryFn:async()=>{const e=(await n.get(x.s,{version:"2023-10-31",query:{page:0,pageSize:t&&t.length>0?C.all:C.default,kuery:[...o,s].join(" or ")}})).data.reduce(((e,a)=>{const n={id:a.metadata.agent.id,name:a.metadata.host.hostname};return null!=t&&t.includes(a.metadata.agent.id)?e.selected.push({...n,selected:!0}):e.rest.push({...n,selected:!1}),e}),{selected:[],rest:[]});let a=0;return t&&(a=t.length),[...e.selected,...e.rest].slice(0,a>=C.default?a+10:C.default)}})})({searchString:a,selectedAgentIds:c}),[h,A]=Object(s.useState)(!1);Object(s.useEffect)((()=>{c&&c.length>0&&A(!0)}),[]);const w=(({isFlyout:e,agentTypes:t,types:a})=>{const n=Object(l.a)("responseActionsSentinelOneV1Enabled"),o=Object(l.a)("responseActionsCrowdstrikeManualHostIsolationEnabled"),i=Object(s.useCallback)((({key:e,label:t,checked:a})=>({key:e,label:t,isGroupLabel:!1,checked:a,"data-test-subj":"types-filter-option"})),[]),r=Object(s.useMemo)((()=>u.h.map((t=>i({key:t,label:z(t),checked:!e&&null!=a&&a.includes(t)?"on":void 0})))),[i,e,a]);return n||o?e?[{label:d.c.actionTypes,isGroupLabel:!0},...r]:[{label:d.c.agentTypes,isGroupLabel:!0},...u.d.map((a=>i({key:a,label:Object(T.n)(a),checked:!e&&null!=t&&t.includes(a)?"on":void 0}))),{label:d.c.actionTypes,isGroupLabel:!0},...r]:r})({isFlyout:t,agentTypes:n,types:m}),[F,U]=Object(s.useState)(E?w:b?u.g.map((a=>({key:a,label:o.a.createElement(I,{color:"successful"===a?"success":"failed"===a?"danger":"warning",status:k(a)}),searchableLabel:a,checked:!t&&null!=r&&r.includes(a)?"on":void 0,"data-test-subj":`${e}-filter-option`}))):N?[]:u.e.filter((e=>{const t=O.a.get();return!("upload"===e&&!t.responseActionUploadEnabled||"scan"===e&&!t.responseActionScanEnabled)})).map((a=>({key:a,label:u.f[a],checked:!t&&null!=i&&i.map((e=>u.k[e])).includes(a)?"on":void 0,"data-test-subj":`${e}-filter-option`}))));Object(s.useEffect)((()=>{N&&D&&U(null==D?void 0:D.map((a=>({key:a.id,label:a.name,checked:!t&&a.selected?"on":void 0,"data-test-subj":`${e}-filter-option`}))))}),[D,e,t,N,U]);const R=Object(s.useMemo)((()=>!!F.find((e=>"on"===e.checked))),[F]),Q=Object(s.useMemo)((()=>F.filter((e=>"on"===e.checked)).length),[F]),P=Object(s.useMemo)((()=>F.filter((e=>e.key&&"on"!==e.checked)).length),[F]);return{areHostsSelectedOnMount:h,isLoading:N&&L,items:F,setItems:U,hasActiveFilters:R,numActiveFilters:Q,numFilters:P,setAreHostsSelectedOnMount:A,setUrlActionsFilters:p,setUrlHostsFilters:g,setUrlStatusesFilters:M,setUrlTypeFilters:y,setUrlTypesFilters:j}})({filterName:e,isFlyout:a,searchString:D}),W=Object(s.useRef)(g);Object(s.useEffect)((()=>()=>{W.current=g}),[g,W]);const V=Object(s.useCallback)(((t=!0)=>t&&W.current&&g&&"hosts"===e),[e,g]),Z=Object(s.useMemo)((()=>V()||h?Object(b.orderBy)("checked","asc",w):w),[h,V,w]),$=Object(s.useMemo)((()=>"statuses"!==e&&"types"!==e),[e]),X=Object(s.useCallback)((n=>{U(n.map((e=>e)));const s=n.reduce(((e,t)=>("on"===t.checked&&t.key&&e.push(t.key),e)),[]),o=s.reduce(((e,t)=>(Object(N.b)(t)&&e.agentTypes.push(t),Object(N.a)(t)&&e.actionTypes.push(t),e)),{actionTypes:[],agentTypes:[]});a||("actions"===e?H(s.map((e=>u.f[e])).join()):"hosts"===e?G(s.join()):"statuses"===e?B(s.join()):"types"===e&&(p?_({agentTypes:o.agentTypes.join(),actionTypes:o.actionTypes.join()}):q(s.join())),V(!1),Y(!1)),t&&void 0===i?(t.agentTypes.onChangeFilterOptions(o.agentTypes),t.actionTypes.onChangeFilterOptions(o.actionTypes)):void 0!==i&&i(s)}),[U,a,t,i,e,V,Y,H,G,B,p,_,q]),K=Object(s.useCallback)((()=>{U(w.map((e=>(e.checked=void 0,e)))),a||("actions"===e?H(""):"hosts"===e?G(""):"statuses"===e?B(""):"types"===e&&_({agentTypes:"",actionTypes:""})),t&&void 0===i?(t.agentTypes.onChangeFilterOptions([]),t.actionTypes.onChangeFilterOptions([])):void 0!==i&&i([])}),[U,w,a,t,i,e,H,G,B,_]);return o.a.createElement(E,{closePopover:y,filterName:e,hasActiveFilters:R,isPopoverOpen:g,numActiveFilters:Q,numFilters:P,onButtonClick:j,"data-test-subj":r},o.a.createElement(n.EuiSelectable,{"aria-label":`${e}`,emptyMessage:d.g.filterEmptyMessage(e),isLoading:A,onChange:X,options:Z,searchable:!!$||void 0,searchProps:{placeholder:d.g.filterSearchPlaceholder(e),compressed:!0,onChange:e=>L(e.trim())}},((t,a)=>o.a.createElement("div",{style:{width:300},"data-test-subj":c(`${e}-filter-popoverList`)},$&&o.a.createElement(n.EuiPopoverTitle,{"data-test-subj":c(`${e}-filter-search`),paddingSize:"s"},a),t,o.a.createElement(n.EuiFlexGroup,null,o.a.createElement(n.EuiFlexItem,null,o.a.createElement(F,{"data-test-subj":c(`${e}-filter-clearAllButton`),isDisabled:!R,onClick:K})))))))}));U.displayName="ActionsLogFilter";const R=Object(s.memo)((({isFlyout:e,onChangeUsersFilter:t,"data-test-subj":a})=>{const i=Object(m.a)(a),{users:l,setUrlUsersFilters:u}=v(),[r,c]=Object(s.useState)(""),p=Object(s.useCallback)((e=>{c(e.target.value)}),[c]),g=Object(s.useCallback)((()=>{const a=r.split(",").reduce(((e,t)=>(""!==t.trim()&&e.push(t.trim()),e)),[]);t(a),e||u(a.join(","))}),[e,t,r,u]),M=Object(s.useCallback)((()=>{c(""),t([]),e||u("")}),[e,t,u,c]);return Object(s.useEffect)((()=>{l&&l.length>0&&c(l.join(","))}),[]),o.a.createElement(n.EuiFormControlLayout,{clear:{onClick:M},fullWidth:!0},o.a.createElement(n.EuiFieldSearch,{"data-test-subj":i("users-filter-search"),isClearable:!0,fullWidth:!0,placeholder:d.c.users,onChange:p,onSearch:g,value:r}))}));R.displayName="ActionsLogUsersFilter";const Q=Object(s.memo)((({dateRangePickerState:e,isDataLoading:t,isFlyout:a,onClick:i,onChangeAgentTypesFilter:u,onChangeHostsFilter:r,onChangeCommandsFilter:c,onChangeStatusesFilter:d,onChangeUsersFilter:p,onChangeTypeFilter:g,onRefresh:M,onRefreshChange:j,onTimeChange:b,showHostsFilter:N,"data-test-subj":E})=>{const T=Object(m.a)(E),O=Object(l.a)("endpointResponseActionsEnabled"),I=Object(l.a)("responseActionsSentinelOneV1Enabled"),D=Object(s.useMemo)((()=>o.a.createElement(o.a.Fragment,null,N&&o.a.createElement(U,{filterName:"hosts",isFlyout:a,onChangeFilterOptions:r,"data-test-subj":E}),o.a.createElement(U,{filterName:"actions",isFlyout:a,onChangeFilterOptions:c,"data-test-subj":E}),o.a.createElement(U,{filterName:"statuses",isFlyout:a,onChangeFilterOptions:d,"data-test-subj":E}),I?O&&o.a.createElement(U,{filterName:"types",typesFilters:{agentTypes:{onChangeFilterOptions:u},actionTypes:{onChangeFilterOptions:g}},isFlyout:a,"data-test-subj":E}):O&&o.a.createElement(U,{filterName:"types",onChangeFilterOptions:g,isFlyout:a,"data-test-subj":E}))),[N,a,I,r,E,c,d,O,u,g]),L=Object(s.useCallback)((()=>i()),[i]);return o.a.createElement(n.EuiFlexGroup,{responsive:!0,gutterSize:"s"},o.a.createElement(n.EuiFlexItem,{grow:a?1:2},o.a.createElement(R,{isFlyout:a,onChangeUsersFilter:p,"data-test-subj":E})),o.a.createElement(n.EuiFlexItem,{grow:1},o.a.createElement(n.EuiFilterGroup,null,D)),o.a.createElement(n.EuiFlexItem,{grow:a?1:2},o.a.createElement(y,{dateRangePickerState:e,isDataLoading:t,onRefresh:M,onRefreshChange:j,onTimeChange:b,"data-test-subj":E})),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiSuperUpdateButton,{iconOnly:!0,"data-test-subj":T("super-refresh-button"),fill:!1,isLoading:t,onClick:L})))}));Q.displayName="ActionsLogFilters";var P=a(518),Y=a(587),H=a(41),G=a.n(H),B=a(4);const _=G()(n.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-9irxg1-0"})(["max-width:100%;"]),q=Object(s.memo)((({"data-test-subj":e})=>{const{docLinks:t}=Object(g.useKibana)().services;return o.a.createElement(r.a,{"data-test-subj":e},o.a.createElement(_,{iconType:"editorUnorderedList",title:o.a.createElement("h2",null,B.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.title",{defaultMessage:"Response actions history is empty"})),body:o.a.createElement("div",null,B.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.content",{defaultMessage:"No response actions performed"})),actions:[o.a.createElement(n.EuiLink,{external:!0,href:null==t?void 0:t.links.securitySolution.responseActions,target:"_blank"},B.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.link",{defaultMessage:"Read more about response actions"}))]}))}));q.displayName="ActionsLogEmptyState";var W=a(5),V=a(194),Z=a(144),$=a(151),X=a(130),K=a(1100),J=a(182);const ee=Object(X.e)(),te=Object(p.euiStyled)(n.EuiFacetButton).attrs({title:void 0})`
  .euiText {
    margin-top: 0.38rem;
    overflow-y: visible !important;
  }
`,ae=Object(s.memo)((({"data-test-subj":e,error:t,items:a,isFlyout:l,loading:r,onChange:c,onShowActionDetails:p,queryParams:g,showHostNames:M,totalItemCount:j})=>{const y=Object(m.a)(e),{pagination:b}=Object(P.b)(),[N,E]=Object(s.useState)({}),T=Object(s.useMemo)((()=>g.withOutputs?"string"==typeof g.withOutputs?[g.withOutputs]:g.withOutputs:[]),[g.withOutputs]),O=Object(s.useCallback)((()=>{if(T.length&&a.length){const t=T.reduce(((t,s)=>{const i=a.find((e=>e.id===s));return t[s]=i?o.a.createElement(K.a,{action:i,"data-test-subj":e}):o.a.createElement(n.EuiSkeletonText,{size:"relative",lines:8}),t}),{});E(t)}}),[T,e,a]);Object(s.useEffect)((()=>{O()}),[O]);const D=Object(s.useCallback)((t=>{const a={...N};a[t.id]?delete a[t.id]:a[t.id]=o.a.createElement(K.a,{action:t,"data-test-subj":e}),p(Object.keys(a)),E(a)}),[N,p,e]),L=Object(s.useCallback)((e=>()=>D(e)),[D]),h=Object(s.useMemo)((()=>({pageIndex:l?(g.page||1)-1:b.page-1,pageSize:l?g.pageSize||10:b.pageSize,totalItemCount:j,pageSizeOptions:J.f})),[l,b.page,b.pageSize,g.page,g.pageSize,j]),v=Object(s.useMemo)((()=>{var e,t;const a=null!==(e=g.page)&&void 0!==e?e:1,n=null!==(t=null==g?void 0:g.pageSize)&&void 0!==t?t:10,s=Math.ceil(j/n),o=n*a-n+1;return{fromCount:o,toCount:a===s||1===s?j:o+n-1}}),[g.page,g.pageSize,j]),S=Object(s.useMemo)((()=>o.a.createElement(n.EuiText,{color:"default",size:"xs","data-test-subj":y("endpointListTableTotal")},o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.list.recordRange",defaultMessage:"Showing {range} of {total} {recordsLabel}",values:{range:o.a.createElement("strong",null,o.a.createElement(n.EuiI18nNumber,{value:v.fromCount}),"-",o.a.createElement(n.EuiI18nNumber,{value:v.toCount})),total:o.a.createElement(n.EuiI18nNumber,{value:j}),recordsLabel:o.a.createElement("strong",null,d.g.recordsLabel(j))}}))),[y,v.fromCount,v.toCount,j]),f=Object(s.useMemo)((()=>(({getTestId:e,expandedRowMap:t,showHostNames:a,onClickCallback:s})=>{const i=[{field:"startedAt",name:d.f.time,width:a?"15%":"21%",truncateText:!0,render:e=>o.a.createElement($.a,{fieldName:d.f.time,value:e,className:"eui-textTruncate"})},{field:"command",name:d.f.command,width:a?"10%":"21%",truncateText:!0,render:t=>{const a=u.f[t];return o.a.createElement(n.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate"},o.a.createElement(n.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-command")},a))}},{name:d.f.user,width:a?"14%":"21%",truncateText:!0,render:({createdBy:t,ruleId:a})=>"unknown"===t&&a?o.a.createElement(n.EuiToolTip,{content:d.g.triggeredByRule,anchorClassName:"eui-textTruncate"},o.a.createElement(Z.k,{"data-test-subj":"ruleName",deepLinkId:W.Oc.rules,path:Object(V.h)(a)},o.a.createElement(n.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-user-name")},d.g.triggeredByRule))):o.a.createElement(te,{icon:o.a.createElement(n.EuiAvatar,{"aria-hidden":!0,title:"",name:t,"data-test-subj":e("column-user-avatar"),size:"s"})},o.a.createElement(n.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},o.a.createElement(n.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-user-name")},t)))},{field:"hosts",name:d.f.hosts,width:"20%",truncateText:!0,render:t=>{const a=t&&Object.values(t),s=a.reduce(((e,t)=>(t.name.trim()&&e.push(t.name),e)),[]).join(", ");let i=s;return s||(a.length>1?i=d.g.unenrolled.hosts:1===a.length&&(i=d.g.unenrolled.host)),o.a.createElement(n.EuiToolTip,{content:i,anchorClassName:"eui-textTruncate"},o.a.createElement(n.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-hostname")},i))}},{field:"comment",name:d.f.comments,width:a?"30%":"21%",truncateText:!0,render:t=>o.a.createElement(n.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},o.a.createElement(n.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-comments")},null!=t?t:ee))},{field:"status",name:d.f.status,width:a?"10%":"15%",render:t=>{const a=k(t);return o.a.createElement(n.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate"},o.a.createElement(I,{color:"failed"===t?"danger":"successful"===t?"success":"warning","data-test-subj":e("column-status"),status:a}))}},{field:"",align:n.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:o.a.createElement(n.EuiScreenReaderOnly,null,o.a.createElement("span",null,d.g.screenReaderExpand)),render:a=>{const i=a.id;return o.a.createElement(n.EuiButtonIcon,{"data-test-subj":e("expand-button"),onClick:s(a),"aria-label":t[i]?d.a.collapse:d.a.expand,iconType:t[i]?"arrowUp":"arrowDown"})}}];return a?i:i.filter((e=>"hosts"!==e.field))})({getTestId:y,expandedRowMap:N,onClickCallback:L,showHostNames:M})),[N,y,L,M]);return o.a.createElement(o.a.Fragment,null,S,o.a.createElement(n.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(n.EuiBasicTable,{"data-test-subj":e,items:a,columns:f,itemId:"id",itemIdToExpandedRowMap:N,pagination:h,onChange:c,loading:r,error:t}))}));ae.displayName="ActionsLogTable";const ne=Object(s.memo)((({agentIds:e,showHostNames:t=!1,isFlyout:a=!0,setIsDataInResponse:p,"data-test-subj":g="response-actions-list"})=>{var M,j;const{pagination:y,setPagination:b}=Object(P.b)(),{agentTypes:N,commands:E,hosts:T,statuses:O,users:I,types:D,withOutputs:L,setUrlWithOutputs:h}=v(),S=Object(m.a)(g),f=Object(l.a)("responseActionsSentinelOneV1Enabled"),x=Object(l.a)("responseActionsCrowdstrikeManualHostIsolationEnabled"),[C,k]=Object(s.useState)(!0),[z,w]=Object(s.useState)({page:a?1:y.page,pageSize:a?10:y.pageSize,agentIds:a?e:null!=T&&T.length?T:e,agentTypes:[],commands:[],statuses:[],userIds:[],withOutputs:[],types:[]});Object(s.useEffect)((()=>{a||w((e=>({...e,agentTypes:f||x?null!=N&&N.length?N:e.agentTypes:[],commands:null!=E&&E.length?E.map((e=>u.k[e])):e.commands,hosts:null!=T&&T.length?T:e.agentIds,statuses:null!=O&&O.length?O:e.statuses,userIds:null!=I&&I.length?I:e.userIds,withOutputs:null!=L&&L.length?L:e.withOutputs,types:null!=D&&D.length?D:e.types})))}),[D,N,E,T,a,x,f,O,w,I,L]);const{dateRangePickerState:F,onRefreshChange:U,onTimeChange:R}=(e=>{const{setUrlDateRangeFilters:t,startDate:a,endDate:n}=v(),[o,i]=Object(s.useState)({...A,startDate:e?A.startDate:null!=a?a:A.startDate,endDate:e?A.endDate:null!=n?n:A.endDate}),l=Object(s.useCallback)((({start:e,end:t})=>{i((a=>({...a,startDate:e,endDate:t})))}),[i]),u=Object(s.useCallback)((e=>{i((t=>({...t,recentlyUsedDateRanges:e})))}),[i]),r=Object(s.useCallback)((e=>{i((t=>({...t,autoRefreshOptions:{enabled:!e.isPaused,duration:e.refreshInterval}})))}),[i]),c=Object(s.useCallback)((({start:a,end:n})=>{l({start:a,end:n});const s=[{start:a,end:n},...o.recentlyUsedDateRanges.filter((e=>!(e.start===a&&e.end===n))).slice(0,9)];u(s),e||t({startDate:a,endDate:n})}),[o.recentlyUsedDateRanges,e,t,l,u]);return{dateRangePickerState:o,onRefreshChange:r,onTimeChange:c}})(a),{error:H,data:G,isFetching:B,isFetched:_,refetch:W}=Object(c.b)({...z,startDate:F.startDate,endDate:F.endDate},{retry:!1}),V=Object(s.useMemo)((()=>{var e;return null!==(e=null==G?void 0:G.total)&&void 0!==e?e:0}),[G]),Z=Object(s.useMemo)((()=>{var e;return null!==(e=null==G?void 0:G.data)&&void 0!==e?e:[]}),[null==G?void 0:G.data]);Object(s.useEffect)((()=>{var e,t;B||404!==(null==H||null===(e=H.body)||void 0===e?void 0:e.statusCode)||"index_not_found_exception"!==(null==H||null===(t=H.body)||void 0===t?void 0:t.message)?!B&&G&&(k(!1),p&&p(!0)):p&&p(!1)}),[G,H,B,p]);const $=Object(s.useCallback)((()=>{F.autoRefreshOptions.enabled&&W()}),[F.autoRefreshOptions.enabled,W]),X=Object(s.useCallback)((e=>{w((t=>({...t,commands:e})))}),[w]),K=Object(s.useCallback)((e=>{w((t=>({...t,statuses:e})))}),[w]),J=Object(s.useCallback)((e=>{w((t=>({...t,agentTypes:e})))}),[w]),ee=Object(s.useCallback)((e=>{w((t=>({...t,types:e})))}),[w]),te=Object(s.useCallback)((e=>{w((t=>({...t,agentIds:e})))}),[w]),ne=Object(s.useCallback)((e=>{w((t=>({...t,userIds:e})))}),[w]),se=Object(s.useCallback)((({page:e})=>{const{index:t,size:n}=e,s={page:t+1,pageSize:n};w((e=>({...e,...s}))),a||b({...s}),W()}),[a,W,w,b]),oe=Object(s.useCallback)((e=>{w((t=>({...t,withOutputs:e}))),a||h(e.join())}),[a,h,w]);return 404===(null==H||null===(M=H.body)||void 0===M?void 0:M.statusCode)&&"index_not_found_exception"===(null==H||null===(j=H.body)||void 0===j?void 0:j.message)?o.a.createElement(q,{"data-test-subj":S("empty-state")}):B&&C?o.a.createElement(Y.a,{"data-test-subj":S("global-loader")}):o.a.createElement(o.a.Fragment,null,o.a.createElement(Q,{isFlyout:a,dateRangePickerState:F,isDataLoading:B,onClick:W,onChangeHostsFilter:te,onChangeCommandsFilter:X,onChangeStatusesFilter:K,onChangeUsersFilter:ne,onChangeAgentTypesFilter:J,onChangeTypeFilter:ee,onRefresh:$,onRefreshChange:U,onTimeChange:R,showHostsFilter:t,"data-test-subj":g}),_&&!V?o.a.createElement(r.a,null,o.a.createElement(n.EuiFlexItem,{"data-test-subj":S("empty-prompt")},o.a.createElement(n.EuiEmptyPrompt,{iconType:"editorUnorderedList",titleSize:"s",title:o.a.createElement("h2",null,o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.title",defaultMessage:"No results match your search criteria"})),body:o.a.createElement("p",null,o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.body",defaultMessage:"Try modifying your search or filter set"})),"data-test-subj":"responseActions-empty"}))):o.a.createElement(ae,{"data-test-subj":g,error:null!==H?d.g.fetchError:void 0,items:Z,isFlyout:a,loading:B,onChange:se,onShowActionDetails:oe,queryParams:z,showHostNames:t,totalItemCount:V}))}));ne.displayName="ResponseActionsLog"},1388:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDMwNC45OTggMzA0Ljk5OCI+PHBhdGggZD0iTTI3NC42NTkgMjQ0Ljg4OGMtOC45NDQtMy42NjMtMTIuNzctOC41MjQtMTIuNC0xNS43NzcuMzgxLTguNDY2LTQuNDIyLTE0LjY2Ny02LjcwMy0xNy4xMTcgMS4zNzgtNS4yNjQgNS40MDUtMjMuNDc0LjAwNC0zOS4yOTEtNS44MDQtMTYuOTMtMjMuNTI0LTQyLjc4Ny00MS44MDgtNjguMjA0LTcuNDg1LTEwLjQzOC03LjgzOS0yMS43ODQtOC4yNDgtMzQuOTIyLS4zOTItMTIuNTMxLS44MzQtMjYuNzM1LTcuODIyLTQyLjUyNUMxOTAuMDg0IDkuODU5IDE3NC44MzggMCAxNTUuODUxIDBjLTExLjI5NSAwLTIyLjg4OSAzLjUzLTMxLjgxMSA5LjY4NC0xOC4yNyAxMi42MDktMTUuODU1IDQwLjEtMTQuMjU3IDU4LjI5MS4yMTkgMi40OTEuNDI1IDQuODQ0LjU0NSA2Ljg1MyAxLjA2NCAxNy44MTYuMDk2IDI3LjIwNi0xLjE3IDMwLjA2LS44MTkgMS44NjUtNC44NTEgNy4xNzMtOS4xMTggMTIuNzkzLTQuNDEzIDUuODEyLTkuNDE2IDEyLjQtMTMuNTE3IDE4LjUzOS00Ljg5MyA3LjM4Ny04Ljg0MyAxOC42NzgtMTIuNjYzIDI5LjU5Ny0yLjc5NSA3Ljk5LTUuNDM1IDE1LjUzNy04LjAwNSAyMC4wNDdhMjcuMjk2IDI3LjI5NiAwIDAwLTIuNjQ3IDIwLjUwNWMtMS44NDQgMS4yODEtNC41MDggMy44MDMtNi43NTcgOC41NTctMi43MTggNS44LTguMjMzIDguOTE3LTE5LjcwMSAxMS4xMjItNS4yNyAxLjA3OC04LjkwNCAzLjI5NC0xMC44MDQgNi41ODYtMi43NjUgNC43OTEtMS4yNTkgMTAuODExLjExNSAxNC45MjUgMi4wMyA2LjA0OC43NjUgOS44NzYtMS41MzUgMTYuODI2LS41MyAxLjYwNC0xLjEzMSAzLjQyLTEuNzQgNS40MjMtLjk1OSAzLjE2MS0uNjEzIDYuMDM1IDEuMDI2IDguNTQyIDQuMzMxIDYuNjIxIDE2Ljk2OSA4Ljk1NiAyOS45NzkgMTAuNDkyIDcuNzY4LjkyMiAxNi4yNyA0LjAyOSAyNC40OTMgNy4wMzUgOC4wNTcgMi45NDQgMTYuMzg4IDUuOTg5IDIzLjk2MSA2LjkxMyAxLjE1MS4xNDUgMi4yOTEuMjE4IDMuMzkuMjE4IDExLjQzNCAwIDE2LjYtNy41ODcgMTguMjM4LTEwLjcwNCA0LjEwNy0uODM4IDE4LjI3Mi0zLjUyMiAzMi44NzEtMy44ODIgMTQuNTc2LS40MTYgMjguNjc5IDIuNDYyIDMyLjY3NCAzLjM1NyAxLjI1NiAyLjQwNCA0LjU2NyA3Ljg5NSA5Ljg0NSAxMC43MjQgMi45MDEgMS41ODYgNi45MzggMi40OTUgMTEuMDczIDIuNDk1aC4wMDFjNC40MTYgMCAxMi44MTctMS4wNDQgMTkuNDY2LTguMDM5IDYuNjMyLTcuMDI4IDIzLjIwMi0xNiAzNS4zMDItMjIuNTUxYTcxNy44NyA3MTcuODcgMCAwMDcuNDQxLTQuMDY1YzYuNzk3LTMuNzY4IDEwLjUwNi05LjE1MiAxMC4xNzUtMTQuNzcxLS4yNzYtNC42NjctMy4zNjUtOC43NjEtOC4wNjItMTAuNjg0em0tMTUwLjQ3LTEuMzUzYy0uODQ2LTUuOTYtOC41MTMtMTEuODcxLTE3LjM5Mi0xOC43MTUtNy4yNi01LjU5Ny0xNS40ODktMTEuOTQtMTcuNzU2LTE3LjMxMi00LjY4NS0xMS4wODItLjk5Mi0zMC41NjggNS40NDctNDAuNjAyIDMuMTgyLTUuMDI0IDUuNzgxLTEyLjY0MyA4LjI5NS0yMC4wMTEgMi43MTQtNy45NTYgNS41MjEtMTYuMTgyIDguNjYtMTkuNzgzIDQuOTcxLTUuNjIyIDkuNTY1LTE2LjU2MSAxMC4zNzktMjUuMTgyIDQuNjU1IDQuNDQ0IDExLjg3NiAxMC4wODMgMTguNTQ3IDEwLjA4MyAxLjAyNyAwIDIuMDI0LS4xMzQgMi45NzctLjQwMyA0LjU2NC0xLjMxOCAxMS4yNzctNS4xOTcgMTcuNzY5LTguOTQ3IDUuNTk3LTMuMjM0IDEyLjQ5OS03LjIyMiAxNS4wOTYtNy41ODUgNC40NTMgNi4zOTQgMzAuMzI4IDYzLjY1NSAzMi45NzIgODIuMDQ0IDIuMDkyIDE0LjU1LS4xMTggMjYuNTc4LTEuMjI5IDMxLjI4OWEyMy4wMTcgMjMuMDE3IDAgMDAtMy4wOC0uMjIxYy03LjIwNyAwLTkuMTE1IDMuOTM0LTkuNjEyIDYuMjgzLTEuMjc4IDYuMTAzLTEuNDEzIDI1LjYxOC0xLjQyNyAzMC4wMDMtMi42MDYgMy4zMTEtMTUuNzg1IDE4LjkwMy0zNC43MDYgMjEuNzA2LTcuNzA3IDEuMTItMTQuOTA0IDEuNjg4LTIxLjM5IDEuNjg4LTUuNTQ0IDAtOS4wODItLjQyOC0xMC41NTEtLjY1MWwtOS41MDgtMTAuODc5YzMuNzQ5LTEuODUxIDcuNDk3LTUuNzU3IDYuNTA5LTEyLjgwNXptMTIuMDY1LTE3OS4zODZjLS4yOTcuMTI4LS41ODkuMjY1LS44NzYuNDExYTE3LjcxMyAxNy43MTMgMCAwMC0uMTk5LTEuOTUyYy0xLjAzOC01Ljk3NS01LTEwLjMxMi05LjQxOS0xMC4zMTItLjMyNyAwLS42NTYuMDI1LTEuMDE3LjA4LTIuNjI5LjQzOC00LjY5MSAyLjQxMy01LjgyMSA1LjIxMy45OTEtNi4xNDQgNC40NzItMTAuNjkzIDguNjAyLTEwLjY5MyA0Ljg1IDAgOC45NDcgNi41MzYgOC45NDcgMTQuMjcyIDAgLjk3NS0uMDcxIDEuOTQ1LS4yMTcgMi45ODF6bTM3LjY4NiA0LjYwN2MuNDQ0LTEuNDE0LjY4NC0yLjk0NC42ODQtNC41MzIgMC03LjAxNC00LjQ1LTEyLjUwOS0xMC4xMzEtMTIuNTA5LTUuNTUyIDAtMTAuMDY5IDUuNjExLTEwLjA2OSAxMi41MDkgMCAuNDcuMDIzLjk0MS4wNjcgMS40MTFsLS44NjEtLjMyOWExOS4xMjUgMTkuMTI1IDAgMDEtLjk2Mi02LjAxNWMwLTguMzg3IDUuMzYtMTUuMjExIDExLjk1LTE1LjIxMSA2LjU4OSAwIDExLjk1IDYuODI0IDExLjk1IDE1LjIxMSAwIDMuNDg5LS45NjMgNi44MTktMi42MjggOS40NjV6bS00Ljg1OSAxNi4zMjRjLS4wOTUuNDI0LS4yOTcuNjEyLTIuNTMxIDEuNzc0LTEuMTI4LjU4Ny0yLjUzMiAxLjMxOC00LjI4OSAyLjM4OGwtMS4xNzQuNzExYy00LjcxOCAyLjg2LTE1Ljc2NSA5LjU1OS0xOC43NjQgOS45NTItMi4wMzcuMjc0LTMuMjk3LS41MTYtNi4xMy0yLjQ0MWE4OC40NDEgODguNDQxIDAgMDAtMi4wNDQtMS4zNjJjLTUuMTA3LTMuMzUxLTguMzkyLTcuMDQyLTguNzYzLTguNDg1IDEuNjY1LTEuMjg3IDUuNzkyLTQuNTA4IDcuOTA1LTYuNDE1IDQuMjg5LTMuOTg4IDguNjA1LTYuNjY4IDEwLjc0MS02LjY2OC4xMTMgMCAuMjE1LjAwOC4zMjEuMDI4IDIuNTEuNDQzIDguNzAxIDIuOTE0IDEzLjIyMyA0LjcxOCAyLjA5LjgzNCAzLjg5NSAxLjU1NCA1LjE2NSAyLjAxIDQuMDAxIDEuMzc0IDYuMDg3IDMuMTMyIDYuMzQgMy43OXptMzUuOTQ3IDE4Ni4zN2MyLjI1Ny0xMC4xODEgNC44NTctMjQuMDMxIDQuNDM2LTMyLjE5Ni0uMDk3LTEuODU1LS4yNjEtMy44NzQtLjQyLTUuODI2LS4yOTctMy42NS0uNzM4LTkuMDc1LS4yODMtMTAuNjg0LjA5LS4wNDIuMTktLjA3OC4zMDEtLjEwOS4wMTkgNC42NjggMS4wMzMgMTMuOTc5IDguNDc5IDE3LjIyNiAyLjIxOS45NjggNC43NTUgMS40NTggNy41MzcgMS40NTggNy40NTkgMCAxNS43MzUtMy42NTkgMTkuMTI1LTcuMDQ5IDEuOTk2LTEuOTk2IDMuNjc1LTQuNDM4IDQuODUxLTYuMzcyLjI1Ny43NTMuNDE1IDEuNzM3LjMzMiAzLjAwNS0uNDQzIDYuODg1IDIuOTAzIDE2LjAxOSA5LjI3MSAxOS4zODVsLjkyNy40ODdjMi4yNjggMS4xOSA4LjI5MiA0LjM1MyA4LjM4OSA1Ljg1My0uMDAxLjAwMS0uMDUxLjE3Ny0uMzg3LjQ4OS0xLjUwOSAxLjM3OS02LjgyIDQuMDkxLTExLjk1NiA2LjcxNC05LjExMSA0LjY1Mi0xOS40MzggOS45MjUtMjQuMDc2IDE0LjgwMy02LjUzIDYuODcyLTEzLjkxNiAxMS40ODgtMTguMzc2IDExLjQ4OGE0LjgzIDQuODMgMCAwMS0xLjQ2MS0uMjA2Yy00Ljg0NC0xLjUxLTguODMxLTguNDk5LTYuNjg5LTE4LjQ2NnpNMzkuOTE3IDI0NS40NzdjLS40OTQtMi4zMTItLjg4NC00LjEzNy0uNDY1LTUuOTA1LjMwNC0xLjMxIDYuNzcxLTIuNzE0IDkuNTMzLTMuMzEzIDMuODgzLS44NDMgNy44OTktMS43MTQgMTAuNTI1LTMuMzA4IDMuNTUxLTIuMTUxIDUuNDc0LTYuMTE4IDcuMTctOS42MTggMS4yMjgtMi41MzEgMi40OTYtNS4xNDggNC4wMDUtNi4wMDcuMDg1LS4wNS4yMTUtLjEwOC40NjMtLjEwOCAyLjgyNyAwIDguNzU5IDUuOTQzIDEyLjE3NyAxMS4yNjIuODY3IDEuMzQxIDIuNDczIDQuMDI4IDQuMzMxIDcuMTM5IDUuNTU3IDkuMjk4IDEzLjE2NiAyMi4wMzMgMTcuMTQgMjYuMzAxIDMuNTgxIDMuODM3IDkuMzc4IDExLjIxNCA3Ljk1MiAxNy41NDEtMS4wNDQgNC45MDktNi42MDIgOC45MDEtNy45MTMgOS43ODQtLjQ3Ni4xMDgtMS4wNjUuMTYzLTEuNzU4LjE2My03LjYwNiAwLTIyLjY2Mi02LjMyOC0zMC43NTEtOS43MjhsLTEuMTk3LS41MDNjLTQuNTE3LTEuODk0LTExLjg5MS0zLjA4Ny0xOS4wMjItNC4yNDEtNS42NzQtLjkxOS0xMy40NDQtMi4xNzYtMTQuNzMyLTMuMzEyLTEuMDQ0LTEuMTcxLjE2Ny00Ljk3OCAxLjIzNS04LjMzNy43NjktMi40MTQgMS41NjMtNC45MSAxLjk5OC03LjUyMy42MTctNC4xNjgtLjEwOS03LjU2MS0uNjkxLTEwLjI4N3oiLz48L3N2Zz4K"},1389:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgdmlld0JveD0iMCAwIDY0MCA2NDAiPjxwYXRoIGQ9Ik0uMiAyOTguNjY5TDAgOTAuNjE1bDI1Ni4wMDctMzQuNzZ2MjQyLjgxNEguMjAxek0yOTguNjU4IDQ5LjY1NEw2MzkuOTA1LS4wMTJ2Mjk4LjY4MUgyOTguNjU3VjQ5LjY1NHpNNjQwIDM0MS4zMzFsLS4wNzEgMjk4LjY4MUwyOTguNjY5IDU5MlYzNDEuMzMyaDM0MS4zM3pNMjU1Ljk4MyA1ODYuNTQzTC4xODkgNTUxLjQ2M3YtMjEwLjE4aDI1NS43OTR2MjQ1LjI2eiIvPjwvc3ZnPgo="},1390:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgdmlld0JveD0iMCAwIDY0MCA2NDAiPjxwYXRoIGQ9Ik00OTQuNzgyIDM0MC4wMmMtLjgwMy04MS4wMjUgNjYuMDg0LTExOS45MDcgNjkuMDcyLTEyMS44MzItMzcuNTk1LTU0Ljk5My05Ni4xNjctNjIuNTUyLTExNy4wMzctNjMuNDAyLTQ5Ljg0My01LjAzMi05Ny4yNDIgMjkuMzYyLTEyMi41NjUgMjkuMzYyLTI1LjI1MyAwLTY0LjI3Ny0yOC42MDctMTA1LjYwNC0yNy44NS01NC4zMi44MDMtMTA0LjQgMzEuNTk0LTEzMi40MDMgODAuMjQ1QzI5LjgxIDMzNC40NTcgNzEuODEgNDc5LjU4IDEyNi44MTYgNTU4Ljk3NmMyNi44NyAzOC44ODIgNTguOTE0IDgyLjU2IDEwMC45OTcgODEgNDAuNTEyLTEuNTk0IDU1Ljg0My0yNi4yNDQgMTA0Ljg0OC0yNi4yNDQgNDguOTkzIDAgNjIuNzUzIDI2LjI0NSAxMDUuNjQgMjUuNDA2IDQzLjYwNi0uODAzIDcxLjIzMi0zOS42MzggOTcuOTI1LTc4LjY1IDMwLjg4Ny00NS4xMiA0My41NDgtODguNzUgNDQuMzE2LTkwLjk5NC0uOTY5LS40MzctODUuMDI5LTMyLjYzNC04NS44NzktMTI5LjQzOWwuMTE4LS4wMzV6TTQxNC4yMyAxMDIuMTc4QzQzNi41NTMgNzUuMDk1IDQ1MS42MzYgMzcuNSA0NDcuNTE0LS4wMjRjLTMyLjE2MiAxLjMxMS03MS4xNjMgMjEuNDM3LTk0LjI1MyA0OC40ODUtMjAuNzI5IDI0LjAxMi0zOC44MzYgNjIuMjgtMzMuOTkzIDk5LjAzNiAzNS45MTggMi44IDcyLjU5MS0xOC4yNDggOTQuOTI2LTQ1LjI3MmwuMDM2LS4wNDd6Ii8+PC9zdmc+Cg=="},586:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(174);const s=({commandName:e,privileges:t})=>Boolean(t[n.j[e]])},620:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return We})),a.d(t,"b",(function(){return Ve})),a.d(t,"a",(function(){return Ze}));var n=a(47),s=a(412),o=a(118),i=a(167);const l=(e,t={})=>{const a=Object(o.i)();return Object(n.useQuery)({queryKey:["get-endpoint-host-info",e],...t,queryFn:()=>a.get(Object(s.a)(i.r,{id:e.trim()||"undefined"}),{version:"2023-10-31"})})};var u=a(2),r=a.n(u),c=a(19),d=a(10),m=a(16),p=a(505),g=a(725),M=a(41),j=a.n(M),y=a(42),b=a(1203),N=a(126),E=a(1388),T=a.n(E),O=a(1389),I=a.n(O),D=a(1390),L=a.n(D);const h=Object(u.memo)((({platform:e,size:t="xl","data-test-subj":a})=>{const n=Object(u.useMemo)((()=>(e=>{switch(e){case"macos":return L.a;case"linux":return T.a;case"windows":return I.a;default:return null}})(e)),[e]);return r.a.createElement(c.EuiIcon,{type:n||"empty",title:e,size:t,"data-test-subj":a})}));h.displayName="PlatformIcon";const v=Object(u.memo)((({platform:e,hostName:t,lastCheckin:a,agentType:n,"data-test-subj":s,children:o})=>{const{euiTheme:i}=Object(c.useEuiTheme)(),l=Object(N.a)(s);return r.a.createElement(c.EuiFlexGroup,{gutterSize:"s",responsive:!1,alignItems:"center","data-test-subj":l("agentInfo")},r.a.createElement(c.EuiFlexItem,{grow:!1},r.a.createElement(h,{"data-test-subj":l("platformIcon"),platform:e})),r.a.createElement(c.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},r.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"xs"},r.a.createElement(c.EuiFlexItem,{grow:!1},r.a.createElement(c.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},r.a.createElement(c.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},r.a.createElement(c.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},r.a.createElement(c.EuiText,{size:"s","data-test-subj":l("hostName"),className:"eui-textTruncate"},r.a.createElement("h6",{className:"eui-textTruncate"},t)))),r.a.createElement(c.EuiFlexItem,{grow:!1},o))),r.a.createElement(c.EuiFlexItem,{grow:!1},r.a.createElement(c.EuiText,{color:"subdued",size:"s","data-test-subj":l("lastSeen")},r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.responder.header.lastSeen",defaultMessage:"Last seen {date}",values:{date:r.a.createElement(y.FormattedRelative,{value:a})}}))))),n&&r.a.createElement(S,{grow:!1,$_css:i.size.l},r.a.createElement(b.a,{agentType:n,"data-test-subj":l("integration")})))}));v.displayName="HeaderAgentInfo";var S=j()(c.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-16ud3nj-0"})((e=>({paddingLeft:e.$_css})));const f=Object(u.memo)((({agentId:e,platform:t,hostName:a,agentType:n})=>{const{data:s}=Object(g.a)(e,n),o=null==s?void 0:s[e],i=o?o.lastSeen:"";return r.a.createElement(v,{platform:t.toLowerCase(),hostName:a,lastCheckin:i,agentType:n,"data-test-subj":"responseConsole"},r.a.createElement(p.a,{agentId:e,agentType:n,"data-test-subj":`responderHeader-${n}-agentIsolationStatus`}))}));f.displayName="AgentInfo";var x=a(140),C=a(4),A=a(503),k=a(586),z=a(1262),w=a(1213),F=a(119),U=a.n(F),R=a(1221);const Q=Object(u.memo)((({action:e,ResultComponent:t,title:a,...n})=>{const s=Object(u.useMemo)((()=>{var t,n,s;if(a)return a;const o=e.agents[0],i=null===(t=e.outputs)||void 0===t||null===(n=t[o])||void 0===n||null===(s=n.content)||void 0===s?void 0:s.code;return i?R.a[i]:void 0}),[a,e.agents,e.outputs]);return r.a.createElement(t,U()({},n,{title:s,agentType:e.agentType}))}));Q.displayName="ActionSuccess";var P=a(885);const Y=Object(u.memo)((({title:e,dataTestSubj:t,action:a,ResultComponent:n})=>r.a.createElement(n,{showAs:"failure",title:e,"data-test-subj":t},r.a.createElement(P.a,{action:a}))));Y.displayName="ActionError";var H=a(790);const G=({actionCreator:e,actionRequestBody:t,setStatus:a,status:l,setStore:c,store:d,ResultComponent:m,dataTestSubj:p,pendingMessage:g,successMessage:M})=>{const j=Object(w.a)(),b=Object(N.a)(p),E="pending"===l,T=Object(u.useMemo)((()=>{var e;return null!==(e=d.actionApiState)&&void 0!==e?e:{request:{sent:!1,error:void 0,actionId:void 0},actionDetails:void 0,actionDetailsError:void 0}}),[d.actionApiState]),{actionDetails:O,actionDetailsError:I}=T,{actionId:D,sent:L,error:h}=T.request,{data:v,error:S}=((e,t={})=>{const a=Object(o.i)();return Object(n.useQuery)({queryKey:["get-action-details",e],...t,queryFn:()=>a.get(Object(s.a)(i.c,{action_id:e.trim()||"undefined"}),{version:"2023-10-31"})})})(null!=D?D:"-",{enabled:Boolean(D)&&E,refetchInterval:!!E&&3e3});return Object(u.useEffect)((()=>{if(!L&&t&&j()){const a={...T.request,sent:!0};e.mutateAsync(t).then((e=>{a.actionId=e.data.id})).catch((e=>{a.error=e})).finally((()=>{j()&&c((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:T,request:{...a}}}}))})),c((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:T,request:a}}}))}}),[e,t,L,T,j,c]),Object(u.useEffect)((()=>{h&&E&&a("error")}),[h,E,a]),Object(u.useEffect)((()=>{S&&E&&(a("error"),c((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:T,actionDetails:void 0,actionDetailsError:S}}})))}),[S,T,E,a,c]),Object(u.useEffect)((()=>{null!=v&&v.data.isCompleted&&E&&(a(null!=v&&v.data.wasSuccessful?"success":"error"),c((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:T,actionDetails:v.data}}})))}),[v,T,E,a,c]),{result:Object(u.useMemo)((()=>{if(E)return r.a.createElement(m,{showAs:"pending","data-test-subj":b("pending")},g);const e=h||I;return e?r.a.createElement(m,{showAs:"failure","data-test-subj":b("apiFailure")},r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.actionSubmitter.apiErrorDetails",defaultMessage:"The following error was encountered:"}),r.a.createElement(H.a,{error:e,"data-test-subj":b("apiErrorDetails")})):O?O.errors?r.a.createElement(Y,{ResultComponent:m,action:O,dataTestSubj:b("actionFailure")}):r.a.createElement(Q,{ResultComponent:m,action:O,"data-test-subj":b("success"),title:M}):r.a.createElement(r.a.Fragment,null)}),[E,h,I,O,m,b,g,M]),actionDetails:T.actionDetails}},B=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:l,ResultComponent:c})=>{var d,m;const p=(e=>{const t=Object(o.i)();return Object(n.useMutation)((({file:e,...a})=>{const n=new FormData;n.append("file",e,e.name);for(const[e,t]of Object.entries(a))void 0!==t&&n.append(e,"string"!=typeof t?JSON.stringify(t):t);return t.post(i.C,{body:n,version:"2023-10-31",headers:{"Content-Type":void 0}})}),void 0)})(),g=Object(u.useMemo)((()=>{var t,a;const n=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId,{comment:s,overwrite:o,file:i}=e.args.args;if(n)return{endpoint_ids:[n],...null!=s&&s[0]?{comment:null==s?void 0:s[0]}:{},parameters:void 0!==o?{overwrite:null==o?void 0:o[0]}:{},file:i[0]}}),[e.args.args,null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId]),{result:M,actionDetails:j}=G({ResultComponent:c,setStore:t,store:a,status:s,setStatus:l,actionCreator:p,actionRequestBody:g,dataTestSubj:"upload"});return null!=j&&j.isCompleted&&j.wasSuccessful?r.a.createElement(c,null,r.a.createElement(z.a,{action:j})):M}));B.displayName="UploadActionResult";const _=C.i18n.translate("xpack.securitySolution.consoleArgumentSelectors.fileSelector.initialDisplayLabel",{defaultMessage:"Click to select file"}),q=C.i18n.translate("xpack.securitySolution.consoleArgumentSelectors.fileSelector.filePickerButtonLabel",{defaultMessage:"Open file picker"}),W=C.i18n.translate("xpack.securitySolution.consoleArgumentSelectors.fileSelector.noFileSelected",{defaultMessage:"No file selected"}),V=Object(u.memo)((({value:e,valueText:t,onChange:a,store:n})=>{const s=Object(u.useMemo)((()=>null!=n?n:{isPopoverOpen:!0}),[n]),o=Object(u.useCallback)((n=>{a({value:e,valueText:t,store:{...s,isPopoverOpen:n}})}),[a,s,e,t]),i=Object(u.useMemo)((()=>Object(c.htmlIdGenerator)("console")()),[]),l=Object(u.useCallback)((()=>{o(!0)}),[o]),d=Object(u.useCallback)((()=>{o(!1)}),[o]),m=Object(u.useCallback)((e=>{const t=null==e?void 0:e.item(0);a({value:null!=t?t:void 0,valueText:t?t.name:"",store:{...s,isPopoverOpen:!1}})}),[a,s]);return r.a.createElement("div",null,r.a.createElement(c.EuiPopover,{isOpen:s.isPopoverOpen,closePopover:d,anchorPosition:"upCenter",initialFocus:`#${i}`,button:r.a.createElement(c.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none"},r.a.createElement(c.EuiFlexItem,{grow:!1,className:"eui-textTruncate",onClick:l},r.a.createElement("div",{className:"eui-textTruncate",title:t||W},t||_)),r.a.createElement(c.EuiFlexItem,{grow:!1},r.a.createElement(c.EuiButtonIcon,{iconType:"folderOpen",size:"xs",onClick:l,"aria-label":q})))},s.isPopoverOpen&&r.a.createElement(c.EuiFilePicker,{id:i,onChange:m,fullWidth:!0,display:"large","data-test-subj":"console-arg-file-picker"})))}));V.displayName="ArgumentFileSelector";var Z=a(24),$=a(174),X=a(869);const K=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:l,ResultComponent:c})=>{var d,m,p,g;const{canWriteFileOperations:M}=Object(x.a)().endpointPrivileges,j=Object(n.useMutation)((e=>o.b.get().http.post(i.p,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const y=Object(u.useMemo)((()=>{var t,a,n,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId,{path:i,comment:l}=e.args.args,u=null===(n=e.commandDefinition)||void 0===n||null===(s=n.meta)||void 0===s?void 0:s.agentType;return o?{agent_type:u,endpoint_ids:[o],comment:null==l?void 0:l[0],parameters:{path:i[0]}}:void 0}),[e.args.args,null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.agentType,null===(p=e.commandDefinition)||void 0===p||null===(g=p.meta)||void 0===g?void 0:g.endpointId]),{result:b,actionDetails:N}=G({ResultComponent:c,setStore:t,store:a,status:s,setStatus:l,actionCreator:j,actionRequestBody:y,dataTestSubj:"getFile",pendingMessage:C.i18n.translate("xpack.securitySolution.getFileAction.pendingMessage",{defaultMessage:"Retrieving the file from host."})});return null!=N&&N.isCompleted&&N.wasSuccessful?r.a.createElement(c,{showAs:"success","data-test-subj":"getFileSuccess",title:C.i18n.translate("xpack.securitySolution.endpointResponseActions.getFileAction.successTitle",{defaultMessage:"File retrieved from the host."})},r.a.createElement(X.a,{action:N,canAccessFileDownloadLink:M})):b}));K.displayName="GetFileActionResult";var J=a(122),ee=a(428);const te=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:o,ResultComponent:i})=>{var l,r,c,d,m;const p=Object(J.a)("responseActionsSentinelOneV1Enabled"),g=Object(n.useMutation)((e=>Object(ee.a)(e)),undefined);const M=Object(u.useMemo)((()=>{var t,a,n,s,o,i;const l=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId,u=null===(n=e.args.args)||void 0===n||null===(s=n.comment)||void 0===s?void 0:s[0],r=null===(o=e.commandDefinition)||void 0===o||null===(i=o.meta)||void 0===i?void 0:i.agentType;return l?{agent_type:p?r:void 0,endpoint_ids:[l],comment:u}:void 0}),[null===(l=e.args.args)||void 0===l?void 0:l.comment,null===(r=e.commandDefinition)||void 0===r||null===(c=r.meta)||void 0===c?void 0:c.agentType,null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId,p]);return G({ResultComponent:i,setStore:t,store:a,status:s,setStatus:o,actionCreator:g,actionRequestBody:M,dataTestSubj:"isolate"}).result}));te.displayName="IsolateActionResult";const ae=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:o,ResultComponent:i})=>{var l,r,c,d,m;const p=Object(J.a)("responseActionsSentinelOneV1Enabled"),g=Object(n.useMutation)((e=>Object(ee.b)(e)),undefined);const M=Object(u.useMemo)((()=>{var t,a,n,s,o,i;const l=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId,u=null===(n=e.args.args)||void 0===n||null===(s=n.comment)||void 0===s?void 0:s[0],r=null===(o=e.commandDefinition)||void 0===o||null===(i=o.meta)||void 0===i?void 0:i.agentType;return l?{agent_type:p?r:void 0,endpoint_ids:[l],comment:u}:void 0}),[null===(l=e.args.args)||void 0===l?void 0:l.comment,null===(r=e.commandDefinition)||void 0===r||null===(c=r.meta)||void 0===c?void 0:c.agentType,null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId,p]);return G({ResultComponent:i,setStore:t,store:a,status:s,setStatus:o,actionCreator:g,actionRequestBody:M,dataTestSubj:"release"}).result}));ae.displayName="ReleaseActionResult";const ne=e=>{var t,a;return e.pid?{pid:Number(e.pid[0])}:{entity_id:null!==(t=null==e||null===(a=e.entityId)||void 0===a?void 0:a[0])&&void 0!==t?t:""}},se=/^\d+(?=(h|m|s){1}$)/,oe=e=>{const t=null==e?void 0:e.trim().match(se);var a,n;if(t)return a=Number(t[0]),n=t[1],(e=>({h:()=>60*e*60,m:()=>60*e,s:()=>e}))(a)[n]()},ie=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:l,ResultComponent:r})=>{var c,d;const m=Object(n.useMutation)((e=>{return t=e,o.b.get().http.post(i.u,{body:JSON.stringify(t),version:"2023-10-31"});var t}),g),p=Object(u.useMemo)((()=>{var t,a,n,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId,i=ne(e.args.args);return o?{endpoint_ids:[o],comment:null===(n=e.args.args)||void 0===n||null===(s=n.comment)||void 0===s?void 0:s[0],parameters:i}:void 0}),[e.args.args,null===(c=e.commandDefinition)||void 0===c||null===(d=c.meta)||void 0===d?void 0:d.endpointId]);var g;return G({ResultComponent:r,setStore:t,store:a,status:s,setStatus:l,actionCreator:m,actionRequestBody:p,dataTestSubj:"killProcess"}).result}));ie.displayName="KillProcessActionResult";const le=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:l,ResultComponent:r})=>{var c,d;const m=Object(n.useMutation)((e=>{return t=e,o.b.get().http.post(i.A,{body:JSON.stringify(t),version:"2023-10-31"});var t}),g),p=Object(u.useMemo)((()=>{var t,a,n,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId,i=ne(e.args.args);return o?{endpoint_ids:[o],comment:null===(n=e.args.args)||void 0===n||null===(s=n.comment)||void 0===s?void 0:s[0],parameters:i}:void 0}),[e.args.args,null===(c=e.commandDefinition)||void 0===c||null===(d=c.meta)||void 0===d?void 0:d.endpointId]);var g;return G({ResultComponent:r,setStore:t,store:a,status:s,setStatus:l,actionCreator:m,actionRequestBody:p,dataTestSubj:"suspendProcess"}).result}));le.displayName="SuspendProcessActionResult";var ue=a(50),re=a(1219),ce=a(883),de=a(151),me=a(900),pe=a(1220);const ge=Object(u.memo)((({command:e,status:t,setStatus:a,store:s,setStore:o,ResultComponent:i})=>{var d,m;const p=null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId,{endpointPendingActions:g,endpointDetails:M,detailsFetchError:j,apiCalled:y}=s,b="pending"===t,N=Object(u.useMemo)((()=>Object(ue.v4)()),[]),{data:E,error:T,isFetching:O,isFetched:I}=l(p,{enabled:b,queryKey:[N]}),{data:D}=((e,t={})=>Object(n.useQuery)({queryKey:["fetch-endpoint-pending-actions-summary",...e],...t,queryFn:()=>Object(ce.a)(e)}))([p],{enabled:b,queryKey:[N,p]}),L=Object(u.useMemo)((()=>{if(null!=g&&g.data.length){var e,t;const a=g.data[0].pending_actions;return{pendingIsolate:null!==(e=a.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(t=a.unisolate)&&void 0!==t?t:0}}return{pendingIsolate:0,pendingUnIsolate:0}}),[null==g?void 0:g.data]);Object(u.useEffect)((()=>{y||o((e=>({...e,apiCalled:!0})))}),[y,o]),Object(u.useEffect)((()=>{I&&b&&(a(j?"error":"success"),o((e=>({...e,endpointDetails:E,detailsFetchError:null!=T?T:void 0}))))}),[j,I,a,b,o,E,T]),Object(u.useEffect)((()=>{D&&!g&&o((e=>({...e,endpointPendingActions:D})))}),[D,o,g]);const h=Object(u.useCallback)((()=>{if(!M)return;const e=[{title:r.a.createElement(me.a,null,C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.agentStatus",{defaultMessage:"Agent status"})),description:r.a.createElement(me.a,null,(()=>{var e;let t="";return L.pendingIsolate>0?t=C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolating",{defaultMessage:"Isolating"}):L.pendingUnIsolate>0?t=C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.releasing",{defaultMessage:"Releasing"}):null!=M&&null!==(e=M.metadata.Endpoint.state)&&void 0!==e&&e.isolation&&(t=C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolated",{defaultMessage:"Isolated"})),`${Object(re.d)(M.host_status)}${t.length>0?` - ${t}`:""}`})())},{title:r.a.createElement(me.a,null,C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.platform",{defaultMessage:"Platform"})),description:r.a.createElement(me.a,null,M.metadata.host.os.full)},{title:r.a.createElement(me.a,null,C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.version",{defaultMessage:"Version"})),description:M.metadata.agent.version},{title:r.a.createElement(me.a,null,C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.policyStatus",{defaultMessage:"Policy status"})),description:r.a.createElement(me.a,null,pe.d[M.metadata.Endpoint.policy.applied.status])},{title:r.a.createElement(me.a,null,C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.appliedPolicyVersion",{defaultMessage:"Policy version"})),description:r.a.createElement(me.a,null,`v${M.metadata.Endpoint.policy.applied.endpoint_policy_version}`)},{title:r.a.createElement(me.a,null,C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.policyName",{defaultMessage:"Policy name"})),description:r.a.createElement(me.a,null,M.metadata.Endpoint.policy.applied.name)},{title:r.a.createElement(me.a,null,C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"})),description:r.a.createElement(me.a,null,r.a.createElement(de.a,{fieldName:C.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"}),value:M.last_checkin}))}];return r.a.createElement(c.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:e,"data-test-subj":"agent-status-console-output"})}),[L.pendingIsolate,L.pendingUnIsolate,M]);return j?r.a.createElement(i,{showAs:"failure"},r.a.createElement(H.a,{error:j})):O||!M?r.a.createElement(i,{showAs:"pending"}):r.a.createElement(i,{showTitle:!1},h())}));ge.displayName="EndpointStatusActionResult";const Me=j()(c.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-10fx62u-0"})(["table{background-color:transparent;}.euiTableHeaderCell{border-bottom:",";.euiTableCellContent__text{font-weight:",";}}.euiTableRow{&:hover{background-color:"," !important;}.euiTableRowCell{border-top:none !important;border-bottom:none !important;}}"],(e=>e.theme.eui.euiBorderThin),(e=>e.theme.eui.euiFontWeightRegular),(({theme:{eui:e}})=>e.euiColorEmptyShade)),je=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:l,ResultComponent:c})=>{var d,m,p;const g=null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId,M=Object(n.useMutation)((e=>o.b.get().http.post(i.q,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const j=Object(u.useMemo)((()=>{var t,a;return g?{endpoint_ids:[g],comment:null===(t=e.args.args)||void 0===t||null===(a=t.comment)||void 0===a?void 0:a[0]}:void 0}),[g,null===(p=e.args.args)||void 0===p?void 0:p.comment]),{result:y,actionDetails:b}=G({ResultComponent:c,setStore:t,store:a,status:s,setStatus:l,actionCreator:M,actionRequestBody:j,dataTestSubj:"getProcesses"}),N=Object(u.useMemo)((()=>[{field:"user","data-test-subj":"process_list_user",name:C.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.user",{defaultMessage:"USER"}),width:"10%"},{field:"pid","data-test-subj":"process_list_pid",name:C.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.pid",{defaultMessage:"PID"}),width:"5%"},{field:"entity_id","data-test-subj":"process_list_entity_id",name:C.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.enityId",{defaultMessage:"ENTITY ID"}),width:"30%"},{field:"command","data-test-subj":"process_list_command",name:C.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.command",{defaultMessage:"COMMAND"}),width:"55%"}]),[]),E=Object(u.useMemo)((()=>{var e,t,a;return g&&null!==(e=null==b||null===(t=b.outputs)||void 0===t||null===(a=t[g])||void 0===a?void 0:a.content.entries)&&void 0!==e?e:[]}),[null==b?void 0:b.outputs,g]);return b&&b.wasSuccessful?r.a.createElement(c,{"data-test-subj":"getProcessesSuccessCallout",showTitle:!1},r.a.createElement(Me,{"data-test-subj":"getProcessListTable",items:[...E],columns:N})):y}));je.displayName="GetProcessesActionResult";var ye=a(1250);const be=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:l,ResultComponent:c})=>{var d,m,p,g,M;const j=Object(n.useMutation)((e=>o.b.get().http.post(i.o,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const y=Object(u.useMemo)((()=>{var t,a,n,s,o;const i=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId;if(i)return{endpoint_ids:[i],parameters:{command:e.args.args.command[0],timeout:oe(null===(n=e.args.args.timeout)||void 0===n?void 0:n[0])},comment:null===(s=e.args.args)||void 0===s||null===(o=s.comment)||void 0===o?void 0:o[0]}}),[null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId,e.args.args.command,e.args.args.timeout,null===(p=e.args.args)||void 0===p?void 0:p.comment]),{result:b,actionDetails:N}=G({ResultComponent:c,setStore:t,store:a,status:s,setStatus:l,actionCreator:j,actionRequestBody:y,dataTestSubj:"execute"});return N&&N.wasSuccessful?r.a.createElement(c,{"data-test-subj":"executeSuccess",showAs:"success",title:C.i18n.translate("xpack.securitySolution.endpointResponseActions.executeAction.successTitle",{defaultMessage:"Command execution was successful."})},r.a.createElement(ye.a,{action:N,canAccessFileDownloadLink:!0,agentId:null===(g=e.commandDefinition)||void 0===g||null===(M=g.meta)||void 0===M?void 0:M.endpointId,textSize:"s","data-test-subj":"console"})):b}));be.displayName="ExecuteActionResult";const Ne=C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.args.command.aboutConsecutiveDashes",{defaultMessage:"Multiple consecutive dashes in the value provided must be escaped. Ex:"}),Ee=C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.args.command.aboutQuotes",{defaultMessage:"Quotes provided in the value can be used without escaping. Ex:"}),Te=C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.unsupportedCommandInfo",{defaultMessage:"This version of the Endpoint does not support this command. Upgrade your Agent in Fleet to use the latest response actions."}),Oe=r.a.memo((()=>r.a.createElement(c.EuiIconTip,{content:Te,type:"warning",color:"danger"})));Oe.displayName="DisabledTooltip";const Ie=({aboutInfo:e,isSupported:t})=>t?e:r.a.createElement(r.a.Fragment,null,e," ",r.a.createElement(Oe,null));var De=a(237);const Le=Object(u.memo)((({command:e,setStore:t,store:a,status:s,setStatus:l,ResultComponent:r})=>{var c,d,m,p;const g=Object(n.useMutation)((e=>o.b.get().http.post(i.y,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const M=Object(u.useMemo)((()=>{var t,a,n,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.endpointId,{path:i,comment:l}=e.args.args,u=null===(n=e.commandDefinition)||void 0===n||null===(s=n.meta)||void 0===s?void 0:s.agentType;return o?{agent_type:u,endpoint_ids:[o],comment:null==l?void 0:l[0],parameters:{path:i[0]}}:void 0}),[e.args.args,null===(c=e.commandDefinition)||void 0===c||null===(d=c.meta)||void 0===d?void 0:d.agentType,null===(m=e.commandDefinition)||void 0===m||null===(p=m.meta)||void 0===p?void 0:p.endpointId]);return G({ResultComponent:r,setStore:t,store:a,status:s,setStatus:l,actionCreator:g,actionRequestBody:M,dataTestSubj:"scan",pendingMessage:C.i18n.translate("xpack.securitySolution.scanAction.pendingMessage",{defaultMessage:"File path scan is in progress."})}).result}));Le.displayName="ScanActionResult";const he=e=>{var t;return(null==e?void 0:e.length)>0&&"string"==typeof e[0]&&(null===(t=e[0])||void 0===t?void 0:t.trim().length)>0||C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.emptyArgumentMessage",{defaultMessage:"Argument cannot be empty"})},ve=e=>{const t=he(e);return!0!==t?t:!!(Number.isSafeInteger(Number(e))&&Number(e)>0)||C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.invalidPidMessage",{defaultMessage:"Argument must be a positive number representing the PID of a process"})},Se=e=>{return!(!String(e).trim().length||(t=String(e).trim(),!se.test(t)))||C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.invalidExecuteTimeout",{defaultMessage:"Argument must be a string with a positive integer value followed by a unit of time (h for hours, m for minutes, s for seconds). Example: 37m."});var t},fe=e=>t=>{const a=t.commandDefinition.meta.privileges,n=t.commandDefinition.meta.capabilities,s=t.commandDefinition.name,o=$.i[s];let i="";return"endpoint"===e&&(o||(i=i.concat(Object(d.m)(e,s))),o&&!n.includes(o)&&(i=i.concat(Object(d.m)(e,s)))),Object(k.a)({commandName:s,privileges:a})||(i=i.concat(d.c)),!i.length||i},xe=Object.freeze({responseActions:{position:0,label:C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.groups.responseActions",{defaultMessage:"Response actions"})}}),Ce=C.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterPidOrEntityId",{defaultMessage:"Enter a pid or an entity id to execute"}),Ae=C.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterOrAddOptionalComment",{defaultMessage:"Hit enter to execute or add an optional comment"}),ke=C.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.commandArgAbout",{defaultMessage:"A comment to go along with the action"}),ze=({endpointAgentId:e,agentType:t,endpointCapabilities:a,endpointPrivileges:n})=>{const s=Z.a.get(),o=s.responseActionUploadEnabled,i=s.responseActionScanEnabled,l=e=>{if("endpoint"!==t)return!0;const n=$.i[e];return!!n&&a.includes(n)},u=[{name:"isolate",about:Ie({aboutInfo:De.b.isolate.about,isSupported:l("isolate")}),RenderComponent:te,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'isolate --comment "isolate this host"',exampleInstruction:Ae,validate:fe(t),args:{comment:{required:!1,allowMultiples:!1,about:ke}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:0,helpDisabled:!1===l("isolate"),helpHidden:!Object(k.a)({commandName:"isolate",privileges:n})},{name:"release",about:Ie({aboutInfo:De.b.release.about,isSupported:l("release")}),RenderComponent:ae,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'release --comment "release this host"',exampleInstruction:Ae,validate:fe(t),args:{comment:{required:!1,allowMultiples:!1,about:ke}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:1,helpDisabled:!1===l("release"),helpHidden:!Object(k.a)({commandName:"release",privileges:n})},{name:"kill-process",about:Ie({aboutInfo:De.b.killProcess.about,isSupported:l("kill-process")}),RenderComponent:ie,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'kill-process --pid 123 --comment "kill this process"',exampleInstruction:Ce,validate:fe(t),mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:ke},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:De.b.killProcess.args.pid.about,validate:ve},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:De.b.killProcess.args.entityId.about,validate:he}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:4,helpDisabled:!1===l("kill-process"),helpHidden:!Object(k.a)({commandName:"kill-process",privileges:n})},{name:"suspend-process",about:Ie({aboutInfo:De.b.suspendProcess.about,isSupported:l("suspend-process")}),RenderComponent:le,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'suspend-process --pid 123 --comment "suspend this process"',exampleInstruction:Ce,validate:fe(t),mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:ke},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:De.b.suspendProcess.args.pid.about,validate:ve},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:De.b.suspendProcess.args.entityId.about,validate:he}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:5,helpDisabled:!1===l("suspend-process"),helpHidden:!Object(k.a)({commandName:"suspend-process",privileges:n})},{name:"status",about:De.b.status.about,RenderComponent:ge,meta:{endpointId:e},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:2},{name:"processes",about:Ie({aboutInfo:De.b.processes.about,isSupported:l("processes")}),RenderComponent:je,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'processes --comment "get the processes"',exampleInstruction:Ae,validate:fe(t),args:{comment:{required:!1,allowMultiples:!1,about:ke}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:3,helpDisabled:!1===l("processes"),helpHidden:!Object(k.a)({commandName:"processes",privileges:n})},{name:"get-file",about:Ie({aboutInfo:De.b.getFile.about,isSupported:l("get-file")}),RenderComponent:K,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'get-file --path "/full/path/to/file.txt" --comment "Possible malware"',exampleInstruction:Ae,validate:fe(t),mustHaveArgs:!0,args:{path:{required:!0,allowMultiples:!1,about:De.b.getFile.args.path.about,validate:e=>he(e)},comment:{required:!1,allowMultiples:!1,about:ke}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:6,helpDisabled:!l("get-file"),helpHidden:!Object(k.a)({commandName:"get-file",privileges:n})},{name:"execute",about:Ie({aboutInfo:De.b.execute.about,isSupported:l("execute")}),RenderComponent:be,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'execute --command "ls -al" --timeout 2s --comment "Get list of all files"',exampleInstruction:Ae,validate:fe(t),mustHaveArgs:!0,args:{command:{required:!0,allowMultiples:!1,about:r.a.createElement(r.a.Fragment,null,r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpointConsoleCommands.execute.args.command.about",defaultMessage:"The command to execute."}),r.a.createElement("br",null),`${Ne} execute --command "/opt/directory\\-\\-\\-directory/myBinary \\-\\-version"`,r.a.createElement("br",null),`${Ee} execute --command "cd "C:\\Program Files\\directory""`),mustHaveValue:"non-empty-string"},timeout:{required:!1,allowMultiples:!1,about:De.b.execute.args.timeout.about,mustHaveValue:"non-empty-string",validate:Se},comment:{required:!1,allowMultiples:!1,about:ke}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:6,helpDisabled:!l("execute"),helpHidden:!Object(k.a)({commandName:"execute",privileges:n})}];switch(o&&u.push({name:"upload",about:Ie({aboutInfo:De.b.upload.about,isSupported:l("upload")}),RenderComponent:B,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'upload --file --overwrite --comment "script to fix registry"',exampleInstruction:Ae,validate:fe(t),mustHaveArgs:!0,args:{file:{required:!0,allowMultiples:!1,about:De.b.upload.args.file.about,mustHaveValue:"truthy",SelectorComponent:V},overwrite:{required:!1,allowMultiples:!1,about:De.b.upload.args.overwrite.about,mustHaveValue:!1},comment:{required:!1,allowMultiples:!1,mustHaveValue:"non-empty-string",about:ke}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:7,helpDisabled:!l("upload"),helpHidden:!Object(k.a)({commandName:"upload",privileges:n})}),i&&u.push({name:"scan",about:Ie({aboutInfo:De.b.scan.about,isSupported:l("scan")}),RenderComponent:Le,meta:{agentType:t,endpointId:e,capabilities:a,privileges:n},exampleUsage:'scan --path "/full/path/to/folder" --comment "Scan folder for malware"',exampleInstruction:Ae,validate:fe(t),mustHaveArgs:!0,args:{path:{required:!0,allowMultiples:!1,mustHaveValue:"non-empty-string",about:De.b.scan.args.path.about},comment:{required:!1,allowMultiples:!1,about:ke}},helpGroupLabel:xe.responseActions.label,helpGroupPosition:xe.responseActions.position,helpCommandPosition:8,helpDisabled:!l("scan"),helpHidden:!Object(k.a)({commandName:"scan",privileges:n})}),t){case"sentinel_one":return Fe({commandList:u});case"crowdstrike":return Ue({commandList:u});default:return u}},we=(e,t)=>{e.helpDisabled=!0,e.helpHidden=!0,e.validate=()=>Object(d.m)(t,e.name)},Fe=({commandList:e})=>e.map((e=>("status"!==e.name&&Object(A.a)("sentinel_one",$.k[e.name],"manual")||we(e,"sentinel_one"),e))),Ue=({commandList:e})=>e.map((e=>("status"!==e.name&&Object(A.a)("crowdstrike",$.k[e.name],"manual")||we(e,"crowdstrike"),e)));var Re=a(1321),Qe=a(296);const Pe=Object(u.memo)((e=>{const{euiTheme:t}=Object(c.useEuiTheme)(),[a,n]=Object(u.useState)(!1),s=Object(u.useCallback)((()=>{n((e=>!e))}),[]),o=Object(c.useGeneratedHtmlId)({prefix:"responderActionLogFlyoutTitle"});return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.EuiButton,{onClick:s,disabled:a,iconType:"list","data-test-subj":"responderShowActionLogButton"},r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.responseActionsHistoryButton.label",defaultMessage:"Response actions history"})),a&&r.a.createElement(c.EuiFlyout,{onClose:s,size:"m",paddingSize:"l","aria-labelledby":o,"data-test-subj":"responderActionLogFlyout",maskProps:{style:`z-index: ${t.levels.flyout+3}`}},r.a.createElement(c.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(c.EuiTitle,{size:"m"},r.a.createElement("h1",{id:o},Qe.g.flyoutTitle(e.meta.hostName)))),r.a.createElement(c.EuiFlyoutBody,null,r.a.createElement(Re.a,{agentIds:e.meta.agentId}))))}));Pe.displayName="ActionLogButton";var Ye=a(921);Object(u.memo)((({endpointId:e})=>{const{data:t,isLoading:a}=l(e,{refetchInterval:1e4});return a?r.a.createElement(c.EuiSkeletonText,{lines:2}):t?r.a.createElement(v,{platform:Object(Ye.a)(t.metadata),hostName:t.metadata.host.name,lastCheckin:t.last_checkin,agentType:"endpoint","data-test-subj":"responseConsole"},r.a.createElement(p.a,{agentId:e,agentType:"endpoint","data-test-subj":"responderHeaderEndpointAgentIsolationStatus"})):null})).displayName="HeaderEndpointInfo";var He=a(203);const Ge=Object(u.memo)((({agentType:e,endpointId:t,hostName:a})=>{const{data:n}=Object(g.a)(t,e);return(null==n?void 0:n[t].status)===He.d.OFFLINE?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.EuiCallOut,{iconType:"offline",color:"warning","data-test-subj":"offlineCallout",title:C.i18n.translate("xpack.securitySolution.responder.hostOffline.callout.title",{defaultMessage:"Host Offline"})},r.a.createElement("p",null,r.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.responder.hostOffline.callout.body",defaultMessage:"The host {name} is offline, so its responses may be delayed. Pending commands will execute when the host reconnects.",values:{name:r.a.createElement("strong",null,a)}}))),r.a.createElement(c.EuiSpacer,{size:"m"})):null}));Ge.displayName="OfflineCallout",a(1320);var Be=a(899),_e=a(877);const qe=C.i18n.translate("xpack.securitySolution.responder_overlay.pageTitle",{defaultMessage:"Response console"}),We=()=>{const e=Object(Be.b)(),t=Object(x.a)().endpointPrivileges,a=Object(m.b)().isEnterprise(),n=Object(J.a)("responseActionsSentinelOneV1Enabled"),s=Object(J.a)("responseActionsCrowdstrikeManualHostIsolationEnabled");return Object(u.useCallback)((o=>{const{agentId:i,agentType:l,capabilities:u,hostName:m,platform:p}=o,g=n&&"sentinel_one"===l||s&&"crowdstrike"===l;if("endpoint"===l&&!t.canAccessResponseConsole)return void window.console.error(new Error(`Access denied to ${l} response actions console`));if("endpoint"!==l&&!a)return void window.console.error(new Error(`Access denied to ${l} response actions console`));const M=e.getOne(i);if(M)M.show();else{const a={commands:ze({agentType:l,endpointAgentId:i,endpointCapabilities:u,endpointPrivileges:t}),"data-test-subj":`${l}ResponseActionsConsole`,storagePrefix:"xpack.securitySolution.Responder",TitleComponent:()=>r.a.createElement(f,{agentId:i,agentType:l,hostName:m,platform:p})};e.register({id:i,meta:{agentId:i,hostName:m,capabilities:u,platform:p},consoleProps:a,PageTitleComponent:()=>g?r.a.createElement(c.EuiFlexGroup,null,r.a.createElement(c.EuiFlexItem,null,qe),r.a.createElement(c.EuiFlexItem,{grow:!1},r.a.createElement(c.EuiBetaBadge,{label:d.g,tooltipContent:d.h}))):r.a.createElement(r.a.Fragment,null,qe),ActionComponents:t.canReadActionsLogManagement?[Pe]:void 0,PageBodyComponent:()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Ge,{endpointId:o.agentId,agentType:l,hostName:m}),r.a.createElement(_e.a,null))}).show()}}),[n,s,t,a,e])},Ve=(e,t={})=>{const a=Object(o.i)();let s=e.userIds;return"string"==typeof e.userIds?s=`*${e.userIds}*`:Array.isArray(e.userIds)&&(s=e.userIds.map((e=>`*${e}*`))),Object(n.useQuery)({queryKey:["get-action-list",e],...t,keepPreviousData:!0,queryFn:async()=>a.get(i.g,{version:"2023-10-31",query:{agentIds:e.agentIds,agentTypes:e.agentTypes,commands:e.commands,endDate:e.endDate,page:e.page,pageSize:e.pageSize,startDate:e.startDate,statuses:e.statuses,userIds:s,withOutputs:e.withOutputs,types:e.types}})})},Ze=()=>{const e=Object(o.i)();return Object(n.useQuery)({queryKey:["get-action-state"],queryFn:()=>e.get(i.d,{version:"2023-10-31"})})}},877:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),s=a.n(n),o=a(19),i=a(42),l=a(4),u=a(620),r=a(118);const c=Object(n.memo)((()=>{const{data:e}=Object(u.a)(),[t,a]=Object(n.useState)(!1),{docLinks:c}=Object(r.j)().services,d=Object(n.useCallback)((()=>a(!0)),[]);return e?t||!0===e.data.canEncrypt?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiCallOut,{color:"warning",iconType:"iInCircle","data-test-subj":"missingEncryptionKeyCallout",title:l.i18n.translate("xpack.securitySolution.responder.missingEncryptionKey.callout.title",{defaultMessage:"Set up encryption key"})},s.a.createElement("div",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responder.missingEncryptionKey.callout.body",defaultMessage:"We recommend encryption keys be configured to protect sensitive information and make your environment more secure. Without encryption keys configured, some features may not perform as intended. {viewMore}.",values:{viewMore:s.a.createElement(o.EuiLink,{href:c.links.kibana.secureSavedObject,target:"_blank"},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responder.missingEncryptionKey.docsLink",defaultMessage:"View more information"}))}})),s.a.createElement(o.EuiButtonEmpty,{onClick:d,color:"warning","data-test-subj":"dismissEncryptionKeyCallout"},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responder.missingEncryptionKey.callout.dismissButton.label",defaultMessage:"Dismiss"}))),s.a.createElement(o.EuiSpacer,{size:"m"})):null}));c.displayName="MissingEncryptionKeyCallout"}}]);