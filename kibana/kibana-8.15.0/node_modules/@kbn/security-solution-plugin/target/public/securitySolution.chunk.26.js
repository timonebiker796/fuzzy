/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[26],{123:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(44),o=a(128),s=a(91),i=a(118);const l=()=>{const e=Object(i.n)(),t=Object(n.useRef)(e.addError.bind(e)).current,a=Object(n.useRef)(e.addSuccess.bind(e)).current,r=Object(n.useRef)(e.addWarning.bind(e)).current,o=Object(n.useRef)(e.remove.bind(e)).current,s=Object(n.useCallback)(((e,a)=>{const n=c(e);return t(n,a)}),[t]);return Object(n.useMemo)((()=>({api:e,addError:s,addSuccess:a,addWarning:r,remove:o})),[s,a,r,o,e])},c=e=>null!=e&&Object(s.isEsError)(e)?d(e):Object(o.r)(e)?u(e):e instanceof Error?m(e):p(e),d=e=>{var t,a,n,r,o,s,i;const l=null!=e.err?e.err:e,c=null!=(null===(t=e.err)||void 0===t?void 0:t.statusCode)?`(${e.err.statusCode})`:null!=e.statusCode?`(${e.statusCode})`:"",d=g(l),u=new Error(`${null!==(a=null===(n=e.attributes)||void 0===n||null===(r=n.error)||void 0===r?void 0:r.reason)&&void 0!==a?a:e.message} ${c}`);return u.name=null!==(o=null===(s=e.attributes)||void 0===s||null===(i=s.error)||void 0===i?void 0:i.reason)&&void 0!==o?o:e.message,null!=d&&(u.stack=d),u},u=e=>{const t=Object(o.s)(e)?`(${e.body.statusCode})`:Object(o.u)(e)?`(${e.body.status_code})`:"",a=g(e),n=new Error(`${""!==String(e.body.message).trim()?e.body.message:e.message} ${t}`);return n.name=null!=e.name?e.name:"",null!=a&&(n.stack=a),n},m=e=>{const t=g(e),a=new Error(e.message);return a.name=e.name,null!=t&&(a.stack=t),a},p=e=>{const t=g(e),a=Object(r.isString)(e)?e:e instanceof Object&&null!=t?t:String(e),n=new Error(a);return n.name=a,null!=t&&(n.stack=t),n},g=e=>{try{return JSON.stringify(e,((e,t)=>{const a=b(t);return f(a)?void 0:a}),2)}catch(e){return}},b=e=>e instanceof Error?{...e,name:e.name,message:e.message,stack:e.stack}:e,f=e=>{if(!(e instanceof Object))return!1;try{return"{}"===JSON.stringify(e)}catch(e){return!1}}},2121:function(e,t,a){"use strict";a.r(t),a.d(t,"resolverPluginSetup",(function(){return y}));var n=a(45),r=a(88),o=a(1637),s=a(1726),i=a(1727);const l=e=>{const t=Object(o.composeWithDevTools)({name:"Resolver",actionsBlacklist:["userMovedPointer"]}),a=Object(r.applyMiddleware)(Object(i.a)(e));return Object(r.createStore)(s.a,t(a))};var c=a(621);function d({entityID:e,processName:t="process name",parentEntityID:a,timestamp:n=0,eventType:r="start",eventCategory:o="process",pid:s=0,eventID:i="event id"}){return{"@timestamp":n,event:{type:r,category:o,id:String(i)},agent:{id:"agent.id",version:"agent.version",type:"agent.type"},ecs:{version:"ecs.version"},user:{name:"user.name",domain:"user.domain"},process:{entity_id:e,executable:"executable",args:["args0","args1","args2"],name:t,pid:s,hash:{md5:"hash.md5"},parent:{pid:0,entity_id:a}}}}var u=a(212),m=a(309);function p({id:e,name:t="node",timestamp:a,parentID:n,stats:r={total:0,byCategory:{}}}){return{id:e,name:t,stats:r,parent:n,data:{"@timestamp":a,"process.entity_id":e,"process.name":t,"process.parent.entity_id":n}}}const g="id of first related event",b="id of second related event";function f(){const e={databaseDocumentID:"_id",entityIDs:{origin:"origin",firstChild:"firstChild",secondChild:"secondChild"}},{tree:t,relatedEvents:a,nodeDataResponse:n}=function({originID:e,firstChildID:t,secondChildID:a}){const{resolverTree:n,nodeDataResponse:r}=function({originID:e,firstChildID:t,secondChildID:a}){const n=d({pid:0,entityID:e,processName:"c.ext",parentEntityID:"none",timestamp:1600863932316}),r=d({pid:1,entityID:t,processName:"d",parentEntityID:e,timestamp:1600863932317}),o=d({pid:2,entityID:a,processName:"really_really_really_really_really_really_really_really_really_really_really_really_really_really_long_node_name",parentEntityID:e,timestamp:1600863932318}),s=[p({id:e,name:"c.ext",stats:{total:2,byCategory:{}},timestamp:1600863932316}),p({id:t,name:"d",parentID:e,timestamp:1600863932317}),p({id:a,name:"really_really_really_really_really_really_really_really_really_really_really_really_really_really_long_node_name",parentID:e,timestamp:1600863932318})];return{treeResponse:s,resolverTree:{originID:e,nodes:s},relatedEvents:{entityID:e,events:[],nextEvent:null},nodeDataResponse:[n,r,o]}}({originID:e,firstChildID:t,secondChildID:a}),o=m.d(n.nodes.find((t=>t.id===e))),s=[d({entityID:e,parentEntityID:o,eventID:g,eventType:"access",eventCategory:"registry"}),d({entityID:e,parentEntityID:o,eventID:b,eventType:"access",eventCategory:"registry"})],i=["authentication","database","driver","file","host","iam","intrusion_detection","malware","network","package","process","web"];for(const t of i)s.push(d({entityID:e,parentEntityID:o,eventID:`${s.length}`,eventType:"access",eventCategory:t}));return function(e,t,a,n){const r={total:0,byCategory:{}};for(const e of t){r.total++;for(const t of u.d(e))r.byCategory[t]=r.byCategory[t]?r.byCategory[t]+1:1}const o=e.nodes.find((e=>e.id===n));return o&&(o.stats=r),{tree:e,relatedEvents:{entityID:n,events:t,nextEvent:null},nodeDataResponse:a}}(n,s,r,e)}({originID:e.entityIDs.origin,firstChildID:e.entityIDs.firstChild,secondChildID:e.entityIDs.secondChild});return{metadata:e,dataAccessLayer:{relatedEvents:async({entityID:t,timeRange:n,indexPatterns:r})=>({entityID:t,events:t===e.entityIDs.origin?a.events:[],nextEvent:null}),eventsWithEntityIDAndCategory:async({entityID:t,category:n,after:r,timeRange:o,indexPatterns:s})=>({events:t===e.entityIDs.origin?a.events.filter((e=>u.d(e).includes(n))):[],nextEvent:null}),async event({nodeID:e,eventID:t,eventCategory:n,eventTimestamp:r,winlogRecordID:o,timeRange:s,indexPatterns:i}){var l;return null!==(l=a.events.find((e=>u.e(e)===t)))&&void 0!==l?l:null},nodeData:async({ids:e,timeRange:t,indexPatterns:a,limit:r,agentId:o})=>n,resolverTree:async({dataId:e,schema:a,timeRange:n,indices:r,ancestors:o,descendants:s,agentId:i})=>t.nodes,entities:async()=>[{name:"endpoint",schema:{id:"process.entity_id",parent:"process.parent.entity_id",ancestry:"process.Ext.ancestry",name:"process.name",agentId:"agent.id"},id:e.entityIDs.origin,agentId:"mockedAgentId"}]}}}function y(){return{Provider:n.Provider,storeFactory:l,ResolverWithoutProviders:c.a,mocks:{dataAccessLayer:{noAncestorsTwoChildrenWithRelatedEventsOnOrigin:f}}}}},251:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},427:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(34),r=a(2),o=n.__importDefault(a(251));t.default=function(e,t,a){void 0===t&&(t=[]),void 0===a&&(a={loading:!1});var s=r.useRef(0),i=o.default(),l=r.useState(a),c=l[0],d=l[1],u=r.useCallback((function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r=++s.current;return d((function(e){return n.__assign(n.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return i()&&r===s.current&&d({value:e,loading:!1}),e}),(function(e){return i()&&r===s.current&&d({error:e,loading:!1}),e}))}),t);return[c,u]}},429:function(e,t,a){"use strict";const n=a(805),r=a(806),o=a(807);function s(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function l(e,t){return t.decode?r(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function d(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=d(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function m(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function p(e,t){s((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const a=function(e){let t;switch(e.arrayFormat){case"index":return(e,a,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=a):n[e]=a};case"bracket":return(e,a,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],a):n[e]=[a]:n[e]=a};case"comma":case"separator":return(t,a,n)=>{const r="string"==typeof a&&a.split("").indexOf(e.arrayFormatSeparator)>-1?a.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===a?a:l(a,e);n[t]=r};default:return(e,t,a)=>{void 0!==a[e]?a[e]=[].concat(a[e],t):a[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const r of e.split("&")){let[e,s]=o(t.decode?r.replace(/\+/g," "):r,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:l(s,t),a(l(e,t),s,n)}for(const e of Object.keys(n)){const a=n[e];if("object"==typeof a&&null!==a)for(const e of Object.keys(a))a[e]=m(a[e],t);else n[e]=m(a,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const a=n[t];return Boolean(a)&&"object"==typeof a&&!Array.isArray(a)?e[t]=c(a):e[t]=a,e}),Object.create(null))}t.extract=u,t.parse=p,t.stringify=(e,t)=>{if(!e)return"";s((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const a=a=>t.skipNull&&null==e[a]||t.skipEmptyString&&""===e[a],n=function(e){switch(e.arrayFormat){case"index":return t=>(a,n)=>{const r=a.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?a:null===n?[...a,[i(t,e),"[",r,"]"].join("")]:[...a,[i(t,e),"[",i(r,e),"]=",i(n,e)].join("")]};case"bracket":return t=>(a,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?a:null===n?[...a,[i(t,e),"[]"].join("")]:[...a,[i(t,e),"[]=",i(n,e)].join("")];case"comma":case"separator":return t=>(a,n)=>null==n||0===n.length?a:0===a.length?[[i(t,e),"=",i(n,e)].join("")]:[[a,i(n,e)].join(e.arrayFormatSeparator)];default:return t=>(a,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?a:null===n?[...a,i(t,e)]:[...a,[i(t,e),"=",i(n,e)].join("")]}}(t),r={};for(const t of Object.keys(e))a(t)||(r[t]=e[t]);const o=Object.keys(r);return!1!==t.sort&&o.sort(t.sort),o.map((a=>{const r=e[a];return void 0===r?"":null===r?i(a,t):Array.isArray(r)?r.reduce(n(a),[]).join("&"):i(a,t)+"="+i(r,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[a,n]=o(e,"#");return Object.assign({url:a.split("?")[0]||"",query:p(u(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:l(n,t)}:{})},t.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0},a);const n=d(e.url).split("?")[0]||"",r=t.extract(e.url),o=t.parse(r,{sort:!1}),s=Object.assign(o,e.query);let l=t.stringify(s,a);l&&(l=`?${l}`);let c=function(e){let t="";const a=e.indexOf("#");return-1!==a&&(t=e.slice(a)),t}(e.url);return e.fragmentIdentifier&&(c=`#${i(e.fragmentIdentifier,a)}`),`${n}${l}${c}`}},445:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(34),r=a(2),o=n.__importDefault(a(427));t.default=function(e,t){void 0===t&&(t=[]);var a=o.default(e,t,{loading:!0}),n=a[0],s=a[1];return r.useEffect((function(){s()}),[s]),n}},459:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),r=a(4),o=a(45),s=a(166),i=a(132),l=a(127),c=a(294),d=a(123),u=a(118),m=a(864);const p=()=>{const{indicesExist:e,dataViewId:t}=Object(i.a)(l.SourcererScopeName.detections),{indexFieldsSearch:a}=Object(c.b)(),p=Object(o.useDispatch)(),{addError:g}=Object(d.a)(),b=Object(n.useRef)(new AbortController),{data:{dataViews:f}}=Object(u.j)().services,y=Object(o.useSelector)(s.d.signalIndexName),v=Object(o.useSelector)(s.d.defaultDataView),E=Object(n.useMemo)((()=>!v.title.includes(`${y}`)),[v.title,y]),h=Object(n.useMemo)((()=>!e&&!E),[e,E]),x=Object(n.useCallback)((()=>{null!==y&&(b.current.abort(),(async()=>{b.current=new AbortController;try{const e=await Object(m.a)({body:{patternList:v.title.split(",")},signal:b.current.signal,dataViewId:t,dataViewService:f});null!==y&&null!=e&&e.defaultDataView.patternList.includes(y)&&(a({dataViewId:e.defaultDataView.id}),p(s.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||g(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[g,t,f,v.title,p,a,y]);return{...h?{pollForSignalIndex:x}:{},signalIndexNeedsInit:E}}},500:function(e,t,a){"use strict";a.d(t,"a",(function(){return Ve}));var n=a(19),r=a(2),o=a.n(r),s=a(45),i=a(4);const l=i.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=i.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),d=i.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),u=i.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),m=i.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),p=i.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),g=i.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),b=i.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),f=i.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),y=i.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),v=i.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),E=i.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),h=i.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),x=i.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),j=i.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),C=i.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),S=i.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),k=i.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),O=i.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),w=i.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),D=i.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),M=i.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),I=i.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),P=i.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),T=i.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),L=i.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),N=i.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),F=i.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),z=i.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),V=i.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),B=i.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),A=i.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),R=i.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),$=i.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var _=a(166),U=a(127),Z=a(531),W=a(41),q=a.n(W),G=a(49);const H=q()(n.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1bcjjxf-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),Y=q()(n.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1bcjjxf-1"})(["max-width:none;"]),K=q()(n.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1bcjjxf-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),X=q()(n.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1bcjjxf-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),J=q.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1bcjjxf-4"})(["width:600px;"]),Q=q()(n.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1bcjjxf-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],G.euiThemeVars.euiSizeXS),ee=q.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1bcjjxf-6"})(["",""],(({theme:e})=>Object(W.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),te=(e,t)=>e.filter((e=>e!==t));var ae=a(308),ne=a(118),re=a(511);const oe=(e,t)=>Object(ae.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var se=a(42);const ie=q()(n.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-yfgyo3-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),le=o.a.memo((({isShowing:e,onDismissModal:t,onContinue:a,onUpdate:r,missingPatterns:s})=>e?o.a.createElement(ie,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},o.a.createElement(n.EuiModalHeader,null,o.a.createElement(n.EuiModalHeaderTitle,null,y)),o.a.createElement(n.EuiModalBody,null,o.a.createElement(n.EuiText,{size:"s"},o.a.createElement(n.EuiTextColor,{color:"subdued"},o.a.createElement("p",null,o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:o.a.createElement(ee,null,s.join(", "))}}),f))),o.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(X,{"aria-label":v,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:a,title:v},v)),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:r,size:"s"},E))))):null));le.displayName="UpdateDefaultDataViewModal";var ce=a(149),de=a(121),ue=a(129),me=a(124),pe=a(158);const ge=({activePatterns:e,deadPatterns:t,selectedPatterns:a,timelineType:s})=>{const i=Object(r.useMemo)((()=>t.length>0?o.a.createElement(n.EuiToolTip,{content:o.a.createElement(be,{activePatterns:e,selectedPatterns:a,timelineType:s})},o.a.createElement(n.EuiIcon,{type:"questionInCircle",title:F})):null),[e,t.length,a,s]);return s===de.m.template?o.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:i,callout:o.a.createElement(ee,null,e.join(", "))}})):o.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:i,callout:o.a.createElement(ee,null,e.join(", "))}}))},be=({activePatterns:e,selectedPatterns:t,timelineType:a})=>{const n=Object(r.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return a===de.m.template?o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}}):o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}})},fe=({timelineType:e,selectedPatterns:t})=>{const a=Object(r.useMemo)((()=>o.a.createElement(ee,null,t.join(", "))),[t]);return e===de.m.template?o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:a}}):o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:a}})},ye=({onReset:e,timelineType:t})=>t===de.m.template?o.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},g)}})):o.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},g)}})),ve=({onReset:e,timelineType:t})=>t===de.m.template?o.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},g)}})):o.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},g)}})),Ee={deprecated:{title:{[de.m.default]:c,[de.m.template]:d},update:T},missingPatterns:{title:{[de.m.default]:u,[de.m.template]:m},update:E}},he=o.a.memo((({activePatterns:e,indicesExist:t,isModified:a,onDismiss:s,onReset:i,onUpdate:l,selectedPatterns:c,missingPatterns:d})=>{const u=Object(r.useMemo)((()=>o.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:l,size:"s",disabled:!t},Ee[a].update)),[t,a,l]),m=Object(r.useMemo)((()=>t?u:o.a.createElement(n.EuiToolTip,{position:"top",content:z,"data-test-subj":"sourcerer-tooltip"},u)),[t,u]),p=e&&e.length>0?c.filter((t=>!e.includes(t))):[],g=Object(r.useMemo)((()=>ue.b.getTimelineByIdSelector()),[]),b=Object(me.a)((e=>{var t;return(null!==(t=g(e,ce.f.active))&&void 0!==t?t:pe.b).timelineType}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:Ee[a].title[b]}),o.a.createElement(n.EuiSpacer,{size:"s"}),o.a.createElement(n.EuiText,{size:"s"},o.a.createElement(n.EuiTextColor,{color:"subdued"},o.a.createElement("p",null,e&&e.length>0?o.a.createElement(ge,{timelineType:b,activePatterns:e,deadPatterns:p,selectedPatterns:c}):o.a.createElement(fe,{timelineType:b,selectedPatterns:c}),"deprecated"===a&&o.a.createElement(ye,{timelineType:b,onReset:i}),"missingPatterns"===a&&o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:o.a.createElement(ee,null,d.join(", "))}})),o.a.createElement(ve,{timelineType:b,onReset:i}))))),o.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(X,{"aria-label":N,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:s,title:N},N)),o.a.createElement(n.EuiFlexItem,{grow:!1},m)))}));he.displayName="TemporarySourcererComp";const xe=o.a.memo((({activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onContinueWithoutUpdate:r,onDismiss:s,onReset:i,onUpdateStepOne:l,onUpdateStepTwo:c,selectedPatterns:d,isShowingUpdateModal:u,onDismissModal:m})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(he,{activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onDismiss:s,onReset:i,onUpdate:l,selectedPatterns:d}),o.a.createElement(le,{isShowing:u,missingPatterns:n,onDismissModal:m,onContinue:r,onUpdate:c}))));xe.displayName="TemporarySourcerer";var je=a(132),Ce=a(393),Se=a(5);const ke=q()(n.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-12c6aaf-0"})(["float:right;"]),Oe=o.a.memo((()=>{const e=Object(r.useCallback)((()=>{document.location.reload()}),[]);return o.a.createElement(ke,{onClick:e,"data-test-subj":"page-refresh"},R)}));Oe.displayName="RefreshButton";var we=a(123);const De=({activePatterns:e,disabled:t,isModified:a,isOnlyDetectionAlerts:s,isPopoverOpen:i,isTimelineSourcerer:l,loading:c,onClick:d,selectedPatterns:u,signalIndexName:m})=>{const p=Object(r.useMemo)((()=>{switch(a){case"modified":return o.a.createElement(Q,{"data-test-subj":"sourcerer-modified-badge"},h);case"alerts":return o.a.createElement(Q,{"data-test-subj":"sourcerer-alerts-badge"},x);case"deprecated":return o.a.createElement(Q,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},j);case"missingPatterns":return o.a.createElement(Q,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},j);default:return null}}),[a]),g=Object(r.useMemo)((()=>l?n.EuiButton:K),[l]),f=Object(r.useMemo)((()=>o.a.createElement(g,{"aria-label":b,"data-test-subj":l?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:d,title:b},b,!t&&p)),[t,p,l,c,d,g]),y=Object(r.useMemo)((()=>t?P:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:a,signalIndexName:n})=>t||e&&!n?null:(e?[n]:a).join(", "))({isOnlyDetectionAlerts:s,isPopoverOpen:i,selectedPatterns:null!=e?e:u,signalIndexName:m})),[e,t,s,i,u,m]);return y?o.a.createElement(n.EuiToolTip,{position:"top",content:y,"data-test-subj":"sourcerer-tooltip"},f):f},Me=Object(r.memo)(De),Ie=o.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?o.a.createElement(n.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Ie.displayName="SourcererCallout";const Pe=o.a.memo((({onChange:e,checked:t,isShow:a})=>a?o.a.createElement(Y,null,o.a.createElement(n.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:B,onChange:e})):null));Pe.displayName="AlertsCheckbox";const Te=o.a.memo((({disableSave:e,isShow:t,onReset:a,onSave:r})=>t?o.a.createElement(Y,null,o.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(X,{"aria-label":L,"data-test-subj":"sourcerer-reset",flush:"left",onClick:a,title:L},L)),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiButton,{onClick:r,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},O)))):null));Te.displayName="SaveButtons";var Le=a(459),Ne=a(189),Fe=a(198);const ze=o.a.memo((({showSourcerer:e,activePatterns:t,isTriggerDisabled:a,isModified:r,isOnlyDetectionAlerts:s,isPopoverOpen:i,loading:l,setPopoverIsOpenCb:c,selectedPatterns:d,signalIndexName:u,handleClosePopOver:m,isTimelineSourcerer:p,selectedDataViewId:g,sourcererMissingPatterns:b,onUpdateDetectionAlertsChecked:f,setMissingPatterns:y,setDataViewId:v,scopeId:E,children:h})=>e?E===U.SourcererScopeName.analyzer?o.a.createElement(o.a.Fragment,null,h):o.a.createElement(n.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:o.a.createElement(Me,{activePatterns:t,disabled:a,isModified:r,isOnlyDetectionAlerts:s,isPopoverOpen:i,isTimelineSourcerer:p,loading:l,onClick:c,selectedPatterns:d,signalIndexName:u}),closePopover:m,"data-test-subj":p?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:i,ownFocus:!0,repositionOnScroll:!0},o.a.createElement(o.a.Fragment,null,h)):null));ze.displayName="SourcererPopover";const Ve=o.a.memo((({scope:e})=>{const t=Object(s.useDispatch)(),a=e===U.SourcererScopeName.detections,i=e===U.SourcererScopeName.timeline,c=e===U.SourcererScopeName.default,d=Object(Ne.d)(Fe.a.sourcerer),u=Object(s.useSelector)(_.d.signalIndexName),m=Object(s.useSelector)(_.d.defaultDataView),b=Object(s.useSelector)(_.d.kibanaDataViews),f=Object(s.useSelector)((t=>_.d.sourcererScopeSelectedDataViewId(t,e))),y=Object(s.useSelector)((t=>_.d.sourcererScopeSelectedPatterns(t,e))),v=Object(s.useSelector)((t=>_.d.sourcererScopeMissingPatterns(t,e))),{pollForSignalIndex:E}=Object(Le.a)();Object(r.useEffect)((()=>{null!=E&&(i||a)&&E()}),[a,i,E]);const{activePatterns:j,indicesExist:O,loading:P}=Object(je.a)(e),[T,L]=Object(r.useState)(j&&j.length>0?v.filter((e=>j.includes(e))):[]);Object(r.useEffect)((()=>{j&&j.length>0&&L(v.filter((e=>j.includes(e))))}),[j,v]);const[N,F]=Object(r.useState)(i&&y.join()===u),z=Object(r.useCallback)((()=>{F(i&&y.join()===u)}),[i,y,u]);Object(r.useEffect)((()=>{z()}),[y]);const B=a||i&&N,[R,W]=Object(r.useState)(!1),[q,G]=Object(r.useState)(f),{allOptions:X,dataViewSelectOptions:ee,loadingIndexPatterns:ie,isModified:le,handleOutsideClick:ce,onChangeCombo:de,renderOption:ue,selectedOptions:me,setIndexPatternsByDataView:pe}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:a,kibanaDataViews:i,missingPatterns:l,scopeId:c,selectedDataViewId:d,selectedPatterns:u,signalIndexName:m})=>{const p=Object(s.useDispatch)(),{data:{dataViews:g}}=Object(ne.j)().services,b=Object(r.useRef)(!0),[f,y]=Object(r.useState)(!1),v=Object(r.useMemo)((()=>m?oe([m]):[]),[m]),E=Object(r.useMemo)((()=>oe(u)),[u]),[j,k]=Object(r.useState)(a?v:E),[O,w]=Object(r.useState)(null==e?"deprecated":l.length>0?"missingPatterns":""),{allPatterns:D,selectablePatterns:M}=Object(r.useMemo)((()=>{if(a&&m)return{allPatterns:[m],selectablePatterns:[m]};const t=i.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const n=[...new Set(t.title.split(","))];return c===_.b.SourcererScopeName.default?{allPatterns:te(n,m),selectablePatterns:te(t.patternList,m)}:{allPatterns:n,selectablePatterns:t.patternList}}),[e,a,i,c,m]),I=Object(r.useMemo)((()=>oe(D,M)),[D,M]),P=Object(r.useCallback)(((e,a=!1)=>c===U.SourcererScopeName.detections||a?v:oe(Object(Z.b)(i.find((t=>t.id===e)),c,m,e===t))),[v,i,c,m,t]),T=Object(r.useMemo)((()=>null!=e?P(e):[]),[e,P]),L=Object(r.useCallback)(((e,t)=>{if(null==t)return w("deprecated");if(l.length>0)return w("missingPatterns");if(a)return w("alerts");const n=T.length!==e.length||!T.every((t=>e.find((e=>t.value===e))));return w(n?"modified":"")}),[T,a,l.length]);Object(r.useEffect)((()=>{k(c===U.SourcererScopeName.detections?v:E)}),[u,c,E,v]),Object(r.useEffect)((()=>{L(u.map((e=>e)),d)}),[a,d,l,c,u]);const N=Object(r.useCallback)((e=>{k(e)}),[]),F=Object(r.useCallback)((({value:e})=>o.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),z=Object(r.useCallback)((async(e,t)=>{if(i.some((t=>t.id===e&&0===t.indexFields.length))){try{y(!0),k([]);const t=await Object(re.a)(e,g);b.current&&(p(_.a.setDataView(t)),k(a?v:oe(t.patternList)))}catch(e){}y(!1)}else k(P(e,t))}),[v,p,P,a,i,g]),V=Object(r.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:a,isOnlyDetectionAlerts:r,kibanaDataViews:s})=>r?[{inputDisplay:o.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},o.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",S,o.a.createElement(Q,{"data-test-subj":"security-alerts-option-badge"},x)),value:t}]:s.map((({title:r,id:s})=>({inputDisplay:s===t?o.a.createElement("span",{"data-test-subj":"security-option-super"},o.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",C,a&&s===e&&o.a.createElement(Q,{"data-test-subj":"security-modified-option-badge"},h)):o.a.createElement("span",{"data-test-subj":"dataView-option-super"},o.a.createElement(n.EuiIcon,{type:"logoKibana",size:"s"})," ",r,a&&s===e&&o.a.createElement(Q,{"data-test-subj":"security-modified-option-badge"},h)),value:s}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===O,isOnlyDetectionAlerts:a,kibanaDataViews:i}):[]),[e,t,O,a,i]);return Object(r.useEffect)((()=>(b.current=!0,()=>{b.current=!1})),[]),{allOptions:I,dataViewSelectOptions:V,loadingIndexPatterns:f,handleOutsideClick:Object(r.useCallback)((()=>{k(E)}),[E]),isModified:O,onChangeCombo:N,renderOption:F,selectedOptions:j,setIndexPatternsByDataView:z}})({dataViewId:q,defaultDataViewId:m.id,isOnlyDetectionAlerts:B,kibanaDataViews:b,missingPatterns:T,scopeId:e,selectedDataViewId:f,selectedPatterns:y,signalIndexName:u}),ge=Object(r.useCallback)((e=>{F(e.target.checked),G(m.id),pe(m.id,e.target.checked)}),[m.id,pe]),[be,fe]=Object(r.useState)(!1),[ye,ve]=Object(r.useState)(!1),Ee=Object(r.useCallback)((()=>{W((e=>!e)),fe(!1)}),[]),he=Object(r.useCallback)(((a,n,r)=>{t(_.a.setSelectedDataView({id:e,selectedDataViewId:a,selectedPatterns:n,shouldValidateSelectedPatterns:r})),c&&d({[U.SourcererScopeName.default]:{id:a,selectedPatterns:n}})}),[t,e,c,d]),ke=Object(r.useCallback)((e=>{G(e),pe(e)}),[pe]),De=Object(r.useCallback)((()=>{G(m.id),pe(m.id),F(!1),L([])}),[m.id,pe]),Me=Object(r.useCallback)((()=>{const e=me.map((e=>e.label));null!=q&&he(q,e),W(!1)}),[he,q,me]),Ve=Object(r.useCallback)((()=>{ce(),G(f),L(v),z(),W(!1),fe(!1)}),[ce,z,f,v]),Be=Object(r.useCallback)((()=>{ve(!1);const e=y.filter((e=>m.patternList.includes(e)));he(m.id,e),W(!1)}),[m.id,m.patternList,he,y]),Ae=Object(r.useCallback)((()=>{0===T.length?Be():ve(!0)}),[T,Be]),[Re,$e]=Object(r.useState)(!1),_e=(e=>{const{uiSettings:t,...a}=Object(ne.j)().services,{addSuccess:s,addError:i}=Object(we.a)();return Object(r.useCallback)((async r=>{const[l,c]=await(async()=>{try{const e=[...t.get(Se.O),...r];return[await t.set(Se.O,Object(ae.a)(e)),null]}catch(e){return[!1,e]}})();return l?(s({color:"success",title:Object(Ce.a)(A,a),text:Object(Ce.a)(o.a.createElement(Oe,null),a),iconType:void 0,toastLifeTimeMs:6e5}),!0):(i(null!==c?c:new Error($),{title:$,toastMessage:o.a.createElement(o.a.Fragment,null,o.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},g)}}))}),!1)}),[i,s,e,t,a])})(Object(r.useCallback)((()=>{W(!0),De()}),[De])),Ue=Object(r.useCallback)((async()=>{const e=await _e(T);ve(!1),W(!1),e&&(he(m.id,null!=j?j:y,!1),$e(!0))}),[j,m.id,T,he,y,_e]);Object(r.useEffect)((()=>{G(f)}),[f]);const Ze=Object(r.useCallback)((()=>{fe((e=>!e))}),[]),We=Object(r.useMemo)((()=>O||[U.SourcererScopeName.analyzer,U.SourcererScopeName.timeline].includes(e)),[O,e]);return o.a.createElement(ze,{showSourcerer:We,activePatterns:j,isTriggerDisabled:Re,isModified:le,isOnlyDetectionAlerts:B,isPopoverOpen:R,isTimelineSourcerer:i,loading:P,handleOutsideClick:ce,setPopoverIsOpenCb:Ee,selectedPatterns:y,signalIndexName:u,handleClosePopOver:Ve,selectedDataViewId:f,sourcererMissingPatterns:v,onUpdateDetectionAlertsChecked:z,setMissingPatterns:L,setDataViewId:G,scopeId:e},o.a.createElement(J,null,o.a.createElement(n.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},o.a.createElement(o.a.Fragment,null,k)),o.a.createElement(Ie,{isOnlyDetectionAlerts:B,title:i?p:l}),o.a.createElement(n.EuiSpacer,{size:"s"}),null===q&&"deprecated"===le||"missingPatterns"===le?o.a.createElement(xe,{activePatterns:j,indicesExist:O,isModified:le,isShowingUpdateModal:ye,missingPatterns:T,onContinueWithoutUpdate:Be,onDismiss:Ee,onDismissModal:()=>ve(!1),onReset:De,onUpdateStepOne:"deprecated"===le?Ae:Ue,onUpdateStepTwo:Ue,selectedPatterns:y}):o.a.createElement(n.EuiForm,{component:"form"},o.a.createElement(o.a.Fragment,null,o.a.createElement(Pe,{isShow:i,checked:N,onChange:ge}),q&&o.a.createElement(Y,{label:w},o.a.createElement(n.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:ie,disabled:B,fullWidth:!0,onChange:ke,options:ee,placeholder:w,valueOfSelected:q})),o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(K,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:be?"arrowDown":"arrowRight",onClick:Ze},D),be&&o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(H,{isDisabled:ie,$expandAdvancedOptions:be,helpText:B?void 0:I,label:M},o.a.createElement(n.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:B||ie,onChange:de,options:X,placeholder:V,renderOption:ue,selectedOptions:me})),o.a.createElement(Te,{disableSave:0===me.length,isShow:!a,onReset:De,onSave:Me})),o.a.createElement(n.EuiSpacer,{size:"s"}))))}));Ve.displayName="Sourcerer"},621:function(e,t,a){"use strict";a.d(t,"a",(function(){return Pt}));var n=a(2),r=a.n(n),o=a(45),s=a(19),i=a(42),l=a(48),c=a(888),d=a(147),u=a(41),m=a.n(u),p=a(410);function g(e,t,a){return t+(e>1?a*(e-1):0)}var b=a(49);function f(){return Object(n.useMemo)((()=>({copyableFieldBackground:b.euiThemeVars.euiColorLightShade,descriptionText:b.euiThemeVars.euiTextColor,full:b.euiThemeVars.euiColorFullShade,graphControls:b.euiThemeVars.euiColorDarkestShade,graphControlsBackground:b.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:b.euiThemeVars.euiColorLightShade,processBackingFill:`${b.euiThemeVars.euiColorPrimary}${b.darkMode?"1F":"0F"}`,resolverBackground:b.euiThemeVars.euiColorEmptyShade,resolverEdge:b.darkMode?b.euiThemeVars.euiColorLightShade:b.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:b.euiThemeVars.euiColorLightestShade,resolverEdgeText:b.darkMode?b.euiThemeVars.euiColorFullShade:b.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${b.euiThemeVars.euiColorDanger}${b.darkMode?"1F":"0F"}`,pillStroke:b.euiThemeVars.euiColorLightShade,linkColor:b.euiThemeVars.euiLinkColor})),[])}const y=m.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${g(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),v=m.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),E=r.a.memo((({className:e,edgeLineMetadata:t,startPosition:a,endPosition:n,projectionMatrix:o})=>{const s=Object(p.c)(a,o),l=Object(p.c)(n,o),[c]=o,d=f(),u=null==t?void 0:t.elapsedTime,m=Object(p.d)(s,l),b=g(c,10,7.5),E={left:`${s[0]}px`,top:`${s[1]}px`,width:`${m}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(p.b)(s,l)}rad)`};let h=50;return c<1&&(h+=1/c*(10*(1-c))),r.a.createElement(y,{className:e,style:E,resolverEdgeColor:d.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},u&&r.a.createElement(v,{backgroundColor:d.resolverEdge,leftPct:h,scaledTypeSize:b,textColor:d.resolverEdgeText},r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:u.duration,durationType:u.durationType}})))}));var h=a(4);const x={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},j=Object(n.createContext)(x);var C=a(509),S=a(122);const k=["fit-content(10em)","auto"],O=m()(s.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-160k3ht-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),w=m.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-160k3ht-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),D=m()(s.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-160k3ht-2"})(["text-transform:uppercase;"]),M=m()(s.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-160k3ht-3"})(["lineheight:'2.2em';"]),I=m()(s.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-160k3ht-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),P=m.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-160k3ht-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor));var T=a(500),L=a(127);const N=h.i18n.translate("xpack.securitySolution.resolver.graphControls.sourcererButtonTitle",{defaultMessage:"Data View Selection"}),F=Object(n.memo)((({id:e,closePopover:t,setActivePopover:a,isOpen:o})=>{const i=Object(n.useCallback)((()=>a("sourcererSelection")),[a]),l=f();return r.a.createElement(s.EuiPopover,{button:r.a.createElement(I,{"data-test-subj":"resolver:graph-controls:sourcerer-button",size:"m",title:N,"aria-label":N,onClick:i,iconType:"indexSettings",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:o,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(T.a,{scope:L.SourcererScopeName.analyzer}))}));F.displayName="SourcererButton";var z=a(346),V=a(310);const B=[],A=h.i18n.translate("xpack.securitySolution.resolver.graphControls.datePickerButtonTitle",{defaultMessage:"Date Range Selection"}),R=h.i18n.translate("xpack.securitySolution.resolver.graphControls.datePicker",{defaultMessage:"date range selection"}),$=Object(n.memo)((({id:e,closePopover:t,setActivePopover:a,isOpen:i})=>{const l=Object(o.useDispatch)(),c=Object(n.useCallback)((()=>a("datePicker")),[a]),u=f(),m=Object(o.useSelector)((t=>d.e(t.analyzer[e]))),p=Object(n.useCallback)((({start:t,end:a,isInvalid:n})=>{if(!n){const n=t.includes("now")||a.includes("now"),r=Object(z.c)(t);let o=Object(z.c)(a,{roundUp:!0});n&&(o=t===a?Object(z.c)("now"):Object(z.c)(a)),l(Object(V.userOverrodeDateRange)({id:e,timeRange:{from:r,to:o}}))}}),[l,e]);return r.a.createElement(s.EuiPopover,{button:r.a.createElement(I,{"data-test-subj":"resolver:graph-controls:date-picker-button",size:"m",title:A,"aria-label":A,onClick:c,iconType:"calendar",$backgroundColor:u.graphControlsBackground,$iconColor:u.graphControls,$borderColor:u.graphControlsBorderColor}),isOpen:i,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},R),r.a.createElement(s.EuiSuperDatePicker,{onTimeChange:p,start:null==m?void 0:m.from,end:null==m?void 0:m.to,showUpdateButton:!1,recentlyUsedRanges:B,width:"auto"}))}));$.displayName="DateSelectionButton";const _=Object(n.memo)(m()(s.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),U=m()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),Z=m()(s.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),W=m.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),q=m.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),G=m.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),H=m.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],q,G),Y=m()(s.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),K=m()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function X({id:e}){return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function J(e,t,a){const r=X({id:e}),o=f(),s=Object(n.useMemo)((()=>({runningProcessCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.runningProcessCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.loadingCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},errorCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.errorCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:o.triggerBackingFill,cubeSymbol:`#${r.runningTriggerCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.terminatedProcessCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:o.triggerBackingFill,cubeSymbol:`#${r.terminatedTriggerCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger}})),[r,o]);return"terminated"===t?a?s.terminatedTriggerCube:s[Q.processTerminated]:"running"===t?a?s[Q.processCausedAlert]:s[Q.processRan]:"error"===t?s[Q.processError]:s[Q.processLoading]}const Q={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},ee=Object(n.memo)((function({id:e,className:t,size:a="2.15em",state:n,isOrigin:o,"data-test-subj":s}){const{cubeSymbol:i,strokeColor:l}=J(e,n,!1),{processCubeActiveBacking:c}=X({id:e});return r.a.createElement(te,{className:t,width:a,height:a,viewBox:"0 0 34 34","data-test-subj":s,isOrigin:o,style:{verticalAlign:"middle"}},r.a.createElement("desc",null,h.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process} other {Unknown Process State}}",values:{state:n}})),o&&r.a.createElement("use",{xlinkHref:`#${c}`,fill:"transparent",x:0,y:-1,stroke:l,strokeDashoffset:0,width:"100%",height:"100%"}),r.a.createElement("use",{role:"presentation",xlinkHref:i,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),te=m.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),ae=r.a.memo((function({children:e}){return r.a.createElement(r.a.Fragment,null,r.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,r.a.createElement("wbr",null)]}),[])]}return e})))})),ne=({id:e,closePopover:t,setActivePopover:a,isOpen:o})=>{const i=Object(n.useCallback)((()=>a("nodeLegend")),[a]),l=f(),c=h.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return r.a.createElement(s.EuiPopover,{button:r.a.createElement(I,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:c,"aria-label":c,onClick:i,iconType:"node",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:o,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},h.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),r.a.createElement("div",{style:{maxWidth:"212px"}},r.a.createElement(_,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:k,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))},re=({id:e,closePopover:t,setActivePopover:a,isOpen:i})=>{var l,c,u;const m=f(),p=Object(o.useSelector)((t=>d.H(t.analyzer[e]))),g=Object(n.useCallback)((()=>a("schemaInfo")),[a]),b=h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),y=h.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return r.a.createElement(s.EuiPopover,{button:r.a.createElement(I,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:b,"aria-label":b,onClick:g,iconType:"iInCircle",$backgroundColor:m.graphControlsBackground,$iconColor:m.graphControls,$borderColor:m.graphControlsBorderColor}),isOpen:i,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),r.a.createElement(s.EuiIconTip,{content:h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),r.a.createElement("div",{style:{maxWidth:"268px"}},r.a.createElement(_,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:k,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),r.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(l=null==p?void 0:p.dataSource)&&void 0!==l?l:y)),r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),r.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(c=null==p?void 0:p.schema.id)&&void 0!==c?c:y)),r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),r.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(u=null==p?void 0:p.schema.parent)&&void 0!==u?u:y))))))},oe=r.a.memo((({id:e,className:t})=>{const a=Object(o.useDispatch)(),i=Object(o.useSelector)((t=>d.I(t.analyzer[e]))),{timestamp:l}=Object(n.useContext)(j),c=Object(S.a)("analyzerDatePickersAndSourcererDisabled"),[u,m]=Object(n.useState)(null),p=f(),g=Object(n.useCallback)((e=>{m(e===u?null:e)}),[m,u]),b=Object(n.useCallback)((()=>m(null)),[]),y=Object(n.useCallback)((t=>{const n=parseFloat(t.target.value);!1===isNaN(n)&&a(Object(C.userSetZoomLevel)({id:e,zoomLevel:n}))}),[a,e]),v=Object(n.useCallback)((()=>{a(Object(C.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[a,e]),E=Object(n.useCallback)((()=>{a(Object(C.userClickedZoomOut)({id:e}))}),[a,e]),x=Object(n.useCallback)((()=>{a(Object(C.userClickedZoomIn)({id:e}))}),[a,e]),[k,D,M,I]=Object(n.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{a(Object(C.userNudgedCamera)({id:e,direction:t,time:l()}))}))),[a,l,e]);return r.a.createElement(P,{className:t,$iconColor:p.graphControls,"data-test-subj":"resolver:graph-controls"},r.a.createElement(w,null,r.a.createElement(re,{id:e,closePopover:b,isOpen:"schemaInfo"===u,setActivePopover:g}),r.a.createElement(ne,{id:e,closePopover:b,isOpen:"nodeLegend"===u,setActivePopover:g}),c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{id:e,closePopover:b,isOpen:"sourcererSelection"===u,setActivePopover:g}),r.a.createElement($,{id:e,closePopover:b,isOpen:"datePicker"===u,setActivePopover:g}))),r.a.createElement(w,null,r.a.createElement(s.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("div",{className:"panning-controls-top"},r.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:k},r.a.createElement(s.EuiIcon,{type:"arrowUp"}))),r.a.createElement("div",{className:"panning-controls-middle"},r.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:I},r.a.createElement(s.EuiIcon,{type:"arrowLeft"})),r.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:v},r.a.createElement(s.EuiIcon,{type:"bullseye"})),r.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:D},r.a.createElement(s.EuiIcon,{type:"arrowRight"}))),r.a.createElement("div",{className:"panning-controls-bottom"},r.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:M},r.a.createElement(s.EuiIcon,{type:"arrowDown"})))),r.a.createElement(s.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("button",{title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:x},r.a.createElement(s.EuiIcon,{type:"plusInCircle"})),r.a.createElement(O,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:i,onChange:y}),r.a.createElement("button",{title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:E},r.a.createElement(s.EuiIcon,{type:"minusInCircle"})))))}));function se(e,t){return function(e,t){const a=Object(l.useHistory)(),r=Object(n.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.push(e)))}),[a,t,e]);return{href:a.createHref(e),onClick:r}}({search:Object(o.useSelector)((a=>d.F(a.analyzer[e])(t)))})}oe.displayName="GraphControls";var ie=a(228),le=a(217);const ce=r.a.memo((({id:e,className:t,nodeID:a,nodeStats:o})=>{const s=Object(n.useMemo)((()=>void 0===o?[]:Object.entries(o.byCategory).map((([e,t])=>({prefix:r.a.createElement(ie.a,{count:t||0}),category:e})))),[o]);return void 0===s?null:r.a.createElement("ul",{className:`${t} options`,"aria-describedby":a},s.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>r.a.createElement(de,{id:e,pill:t,nodeID:a,key:t.category}))))})),de=({id:e,pill:t,nodeID:a})=>{const s=se(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:a,eventCategory:t.category}}),{pillStroke:i,resolverBackground:l}=f(),c=Object(n.useMemo)((()=>({border:`1.5px solid ${i}`,backgroundColor:l})),[i,l]),d=Object(o.useDispatch)(),{timestamp:u}=Object(n.useContext)(j),m=Object(n.useCallback)((t=>{s.onClick(t),d(Object(le.userSelectedResolverNode)({id:e,nodeID:a,time:u()}))}),[u,s,d,a,e]);return r.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:c,key:t.category},r.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:m},t.prefix," ",t.category))},ue=m()(ce).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),me=m.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),pe=m()(s.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),ge=m.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),be=m()(s.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var fe=a(309),ye=a(212),ve=a(291);const Ee=m.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),he=m.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),xe=m.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),je=m.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),Ce=r.a.memo((({id:e,className:t,position:a,node:l,nodeID:c,projectionMatrix:u,timeAtRender:m})=>{const b=`resolver:${e}`,y=X({id:e}),{timestamp:v}=Object(n.useContext)(j),[E,x]=Object(p.c)(a,u),[C]=u,S=Object(o.useSelector)((t=>d.b(t.analyzer[e]))),k=Object(o.useSelector)((t=>d.J(t.analyzer[e]))),O=Object(o.useSelector)((t=>d.A(t.analyzer[e]))),w=Object(o.useSelector)((t=>d.z(t.analyzer[e])(c))),D=Object(n.useCallback)((e=>Object(s.htmlIdGenerator)(b)(`${e}:node`)),[b]),M=Object(o.useSelector)((t=>d.d(t.analyzer[e])(c))),I=Object(o.useSelector)((t=>d.c(t.analyzer[e])(m)(c))),P=C>.8,T=C>=.55,L=(P?3.5:T?1:21)*C+5,N=360*(P?-.147413:-.147413-.08*(C-.5))*C,F=120*(P?-.53684:.2*-C*(1-C)/C-.53684)*C,z=Object(n.useMemo)((()=>({left:`${E+N}px`,top:`${x+F}px`,width:360*C+"px",height:120*C+"px"})),[E,C,N,F,x]),B=g(C,18.75,12.5),A=r.a.createRef(),R=f(),$=Object(o.useSelector)((t=>d.x(t.analyzer[e])(c))),_="loading"===$,{backingFill:U,cubeSymbol:Z,descriptionText:W,isLabelFilled:q,labelButtonFill:G,strokeColor:H}=J(e,$,!1),Y=Object(n.useMemo)((()=>Object(s.htmlIdGenerator)("resolver")(`${c}:label`)),[c]),K=c===S,Q=c===k,ee=c===O,te=Object(o.useDispatch)(),ae=se(e,{panelView:"nodeDetail",panelParameters:{nodeID:c}}),ne=Object(n.useCallback)((()=>{te(Object(le.userFocusedOnResolverNode)({id:e,nodeID:c,time:v()}))}),[te,c,v,e]),re=Object(n.useCallback)((t=>{var a;null!==(a=A.current)&&void 0!==a&&a.beginElement&&A.current.beginElement(),"error"===$?te(Object(V.userReloadedResolverNode)({id:e,nodeID:c})):(te(Object(le.userSelectedResolverNode)({id:e,nodeID:c,time:v()})),ae.onClick(t))}),[A,te,c,ae,$,v,e]),oe=Object(o.useSelector)((t=>d.K(t.analyzer[e])(l))),ie=fe.c(l),ce=Object(o.useSelector)((t=>ve.a(d.w(t.analyzer[e])(String(l.id))))),de=Object(n.useMemo)((()=>void 0!==ce?ye.l(ce):ie),[ce,ie]),me=Object(n.useMemo)((()=>null===I?void 0:D(I)),[I,D]),pe=Object(n.useMemo)((()=>D(c)),[D,c]);return r.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":c,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===M?void 0:M,"aria-flowto":me,"aria-labelledby":Y,"aria-haspopup":"true","aria-current":K?"true":void 0,"aria-selected":Q?"true":void 0,style:z,id:pe,tabIndex:-1},r.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{ne(),re(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},r.a.createElement(je,{isNodeLoading:_},r.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:U,x:-15.35,y:-15.35,stroke:H,width:22.5,height:22.5,className:"backing"}),ee&&r.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:H,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),r.a.createElement("use",{role:"presentation",xlinkHref:Z,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},r.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:A})))),r.a.createElement(Ee,{color:R.full,fontSize:B,topPct:L},r.a.createElement(he,{backgroundColor:R.resolverBackground,color:R.descriptionText,isDisplaying:T,"data-test-subj":"resolver:node:description"},r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event · {descriptionText}} other {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:W}})),r.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:re,onFocus:ne,tabIndex:-1,style:{backgroundColor:R.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},r.a.createElement(s.EuiButton,{iconSide:_?"right":"left",isLoading:_,color:G,fill:q,iconType:"error"===$?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*C,32)}px`,maxWidth:(P?400:210*C)+"px"},tabIndex:-1,title:de,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":c},r.a.createElement(xe,{isShowingIcon:"loading"===$||"error"===$,className:"eui-textTruncate","data-test-subj":"euiButton__text"},h.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:$,nodeName:de}})))),r.a.createElement(s.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:R.resolverBackground,display:P?"flex":"none",margin:"2px 0 0 0",padding:0}},r.a.createElement(s.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==oe&&oe>0&&r.a.createElement(ue,{id:e,buttonFill:R.resolverBackground,nodeStats:w,nodeID:c})))))})),Se=m()(Ce).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var ke=a(56);function Oe({id:e}){const t=e;return Object(n.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const we=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),De=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),Me=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),Ie=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),Pe=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),Te=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Le=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Ne=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=Oe({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#6D6D6D"}),r.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),r.a.createElement("linearGradient",{id:a.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),r.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),r.a.createElement("linearGradient",{id:a.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),r.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),r.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#DD0A73"}),r.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Fe=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=X({id:e}),n=Oe({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("symbol",{id:a.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},r.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),r.a.createElement("symbol",{id:a.loadingCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,we),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),r.a.createElement("symbol",{id:a.errorCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,De),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.errorCube})`}),r.a.createElement("g",{opacity:"0.6"},r.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.errorCube})`}),r.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.runningProcessCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Me),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningProcessCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{id:a.runningTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Ie),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningTriggerCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{viewBox:"0 0 88 100",id:a.terminatedProcessCube},r.a.createElement("title",null,Pe),r.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),r.a.createElement("g",{opacity:"0.7"},r.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.terminatedProcessCube})`}),r.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.terminatedTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Te),t&&r.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("g",{opacity:"0.6"},!t&&r.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${n.terminatedTriggerCube})`}),r.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{viewBox:"0 -3 88 106",id:a.processCubeActiveBacking},r.a.createElement("title",null,Le),r.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),ze=Object(n.memo)((({id:e})=>{const t=Object(ke.useDarkMode)();return r.a.createElement(Ve,null,r.a.createElement("defs",null,r.a.createElement(Ne,{id:e,isDarkMode:t}),r.a.createElement(Fe,{id:e,isDarkMode:t})))})),Ve=m()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Be=a(119),Ae=a.n(Be);const Re=Object(n.memo)((function({breadcrumbs:e}){const t=Object(n.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:a,resolverEdgeText:o}=f();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,{background:a,text:o,breadcrumbs:t,truncate:!1}))})),$e=m.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function _e({id:e}){const t=h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),a=h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),o=se(e,{panelView:"nodes"}),i=Object(n.useMemo)((()=>[{text:a,...o}]),[o,a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re,{breadcrumbs:i}),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(s.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},r.a.createElement($e,null,r.a.createElement(s.EuiLoadingSpinner,{size:"m"})),r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function Ue({event:e}){var t,a,n,o,s,l,c,d,u,m,p,g,b,f,y,v,E,h,x;return Object(ye.i)(e)?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(ye.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(m=e.network)||void 0===m?void 0:m.forwarded_ip),networkDirection:String(null===(p=e.network)||void 0===p?void 0:p.direction)}}):null!==(a=e.kibana)&&void 0!==a&&null!==(n=a.alert)&&void 0!==n&&null!==(o=n.rule)&&void 0!==o&&o.name?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(g=e.kibana)||void 0===g||null===(b=g.alert)||void 0===b||null===(f=b.rule)||void 0===f?void 0:f.name)}}):null!==(s=e.file)&&void 0!==s&&s.path?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(y=e.file)||void 0===y?void 0:y.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(v=e.registry)||void 0===v?void 0:v.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(E=e.registry)||void 0===E?void 0:E.key)}}):null!==(d=e.dns)&&void 0!==d&&null!==(u=d.question)&&void 0!==u&&u.name?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(h=e.dns)||void 0===h||null===(x=h.question)||void 0===x?void 0:x.name)}}):r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(ye.b)(e)}})}var Ze=a(73),We=a.n(Ze);const qe=h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),Ge=new Intl.DateTimeFormat(h.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function He(e){const t=Object(ke.useUiSetting)("dateFormat"),a=Object(ke.useUiSetting)("dateFormat:tz"),n="Browser"===a?We.a.tz.guess():a;if(!e)return;const r=new Date(e);return r&&Number.isFinite(r.getTime())?t?We.a.tz(r,n).format(t):Ge.format(r):qe}var Ye=a(262);const Ke=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(o.useSelector)((a=>d.i(a.analyzer[e])(t))),l=Object(o.useSelector)((t=>d.r(t.analyzer[e]))),c=Object(o.useSelector)((t=>d.j(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(_e,{id:e})):r.a.createElement(pe,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},c||!n?r.a.createElement(s.EuiCallOut,{title:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},r.a.createElement("p",null,r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Qe,{id:e,nodeName:n.name,eventCategory:a,nodeID:t}),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(Je,{id:e,eventCategory:a,nodeID:t}))))})),Xe=Object(n.memo)((function({id:e,event:t,nodeID:a,eventCategory:n}){const o=Object(Ye.a)(t),l=ye.g(o),c=ye.e(o),d=ye.p(o),u=He(l)||h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),m=se(e,{panelView:"eventDetail",panelParameters:{nodeID:a,eventCategory:n,eventID:c,eventTimestamp:String(l),winlogRecordID:String(d)}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiText,null,r.a.createElement(Y,null,r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:ye.d(o).join(", "),eventType:ye.h(o).join(", ")},defaultMessage:"{category} {eventType}"})),r.a.createElement(K,{dateTime:u},r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:u},defaultMessage:"@ {date}"}))),r.a.createElement(s.EuiSpacer,{size:"xs"}),r.a.createElement(s.EuiButtonEmpty,Ae()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},m),r.a.createElement(Ue,{event:o})))})),Je=Object(n.memo)((function({id:e,eventCategory:t,nodeID:a}){const l=Object(o.useSelector)((t=>d.y(t.analyzer[e]))),c=Object(o.useDispatch)(),u=Object(n.useCallback)((()=>{c(Object(V.userRequestedAdditionalRelatedEvents)({id:e}))}),[c,e]),m=Object(o.useSelector)((t=>d.q(t.analyzer[e]))),p=Object(o.useSelector)((t=>d.t(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l.map(((o,i)=>r.a.createElement(n.Fragment,{key:i},r.a.createElement(Xe,{id:e,nodeID:a,eventCategory:t,event:o}),i===l.length-1?null:r.a.createElement(s.EuiHorizontalRule,{margin:"m"})))),p&&r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiButton,{color:"primary",size:"s",fill:!0,onClick:u,isLoading:m,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Qe=Object(n.memo)((function({id:e,nodeName:t,eventCategory:a,nodeID:n}){const s=Object(o.useSelector)((t=>d.M(t.analyzer[e])(n))),l=Object(o.useSelector)((t=>d.D(t.analyzer[e])(n,a))),c=se(e,{panelView:"nodes"}),u=se(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),m=se(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}});return r.a.createElement(Re,{breadcrumbs:[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...c},{text:t,...u},{text:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:s},defaultMessage:"{totalCount} Events"}),...m},{text:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:l,category:a},defaultMessage:"{count} {category}"})}]})}));function et({id:e,nodeID:t}){const a=Object(o.useSelector)((a=>ve.a(d.w(a.analyzer[e])(t)))),n=Object(o.useSelector)((a=>d.z(a.analyzer[e])(t)));return void 0===a||void 0===n?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(_e,{id:e})):r.a.createElement(pe,{hasBorder:!0},r.a.createElement(at,{id:e,nodeName:ye.l(a),nodeID:t,totalEventCount:n.total}),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(tt,{id:e,nodeID:t,relatedStats:n}))}const tt=Object(n.memo)((function({id:e,nodeID:t,relatedStats:a}){const o=Object(n.useMemo)((()=>Object.entries(a.byCategory).map((([e,t])=>({eventType:e,count:t})))),[a.byCategory]),i=Object(n.useMemo)((()=>[{field:"count",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"25%",sortable:!0,render:e=>r.a.createElement(s.EuiToolTip,{position:"top",content:e},r.a.createElement(ie.a,{count:e}))},{field:"eventType",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"75%",sortable:!0,render:a=>r.a.createElement(nt,{id:e,nodeID:t,eventType:a},a)}]),[t,e]);return r.a.createElement(s.EuiInMemoryTable,{items:o,columns:i,sorting:!0})})),at=Object(n.memo)((function({id:e,nodeID:t,nodeName:a,totalEventCount:n}){return r.a.createElement(Re,{breadcrumbs:[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...se(e,{panelView:"nodes"})},{text:a,...se(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...se(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),nt=Object(n.memo)((({id:e,nodeID:t,eventType:a,children:n})=>{const o=se(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:a}});return r.a.createElement(s.EuiButtonEmpty,Ae()({"data-test-subj":"resolver:panel:node-events:event-type-link"},o),n)}));var rt=a(173),ot=a(131),st=a(889);const it=Object(n.memo)((function({id:e,translatedErrorMessage:t}){const a=se(e,{panelView:"nodes"}),o=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...a},{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re,{breadcrumbs:o}),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(s.EuiButtonEmpty,a,h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),lt=m()(ee).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),ct=h.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),dt=Object(n.memo)((function({id:e,nodeID:t}){const a=Object(o.useSelector)((a=>ve.a(d.w(a.analyzer[e])(t))));return"loading"===Object(o.useSelector)((a=>d.x(a.analyzer[e])(t)))?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(_e,{id:e})):a?r.a.createElement(pe,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},r.a.createElement(ut,{id:e,nodeID:t,processEvent:a})):r.a.createElement(pe,{hasBorder:!0},r.a.createElement(it,{id:e,translatedErrorMessage:ct}))})),ut=Object(n.memo)((function({id:e,processEvent:t,nodeID:a}){const l=ye.l(t),c=Object(o.useSelector)((t=>d.x(t.analyzer[e])(a))),u=Object(o.useSelector)((t=>d.E(t.analyzer[e])(a))),m=ye.g(t),p=He(m),g=Object(n.useMemo)((()=>{const e={title:"@timestamp",description:p,value:m},a={title:"process.executable",description:Object(st.d)(t)},n={title:"process.pid",description:Object(st.c)(t)},r={title:"user.name",description:ye.o(t)};return[e,a,n,{title:"process.entity_id",description:ye.c(t)},r,{title:"user.domain",description:ye.n(t)},{title:"process.parent.pid",description:ye.k(t)},{title:"process.hash.md5",description:ye.j(t)},{title:"process.args",description:ye.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:String(e.description)})))}),[p,m,t]),b=se(e,{panelView:"nodes"}),f=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...b},{text:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:l},defaultMessage:"Details for: {processName}"})}]),[l,b]),{descriptionText:y}=J(e,c,!1),v=se(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}}),E=Object(n.useMemo)((()=>Object(s.htmlIdGenerator)("resolverTable")()),[]),x=[{field:"title","data-test-subj":"resolver:node-detail:entry-title",name:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0,render:e=>r.a.createElement(ae,null,e)},{name:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.valueTitle",defaultMessage:"Value"}),"data-test-subj":"resolver:node-detail:entry-description",render(t){var a;return r.a.createElement(rt.c,{data:{field:t.title,value:null!==(a=t.value)&&void 0!==a?a:t.description},triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,visibleCellActions:5,sourcererScopeId:Object(ot.getSourcererScopeId)(e),metadata:{scopeId:e}},t.description)}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re,{breadcrumbs:f}),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(s.EuiTitle,{size:"xs"},r.a.createElement(U,{"aria-describedby":E},r.a.createElement(lt,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:c}),r.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},r.a.createElement(ae,null,l)))),r.a.createElement(s.EuiText,null,r.a.createElement(s.EuiTextColor,{color:"subdued"},r.a.createElement("span",{id:E},y))),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(s.EuiLink,Ae()({},v,{"data-test-subj":"resolver:node-detail:node-events-link"}),r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:u},defaultMessage:"{relatedEventTotal} Events"})),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(s.EuiInMemoryTable,{"data-test-subj":"resolver:node-detail",items:g,columns:x,sorting:!0}))})),mt=r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),pt=r.a.memo((function({numberOfEntries:e}){return r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),gt=r.a.memo((function({numberDisplayed:e}){return r.a.createElement(be,{size:"s",title:r.a.createElement(pt,{numberOfEntries:e})},r.a.createElement("p",null,mt))})),bt=Object(n.memo)((({id:e})=>{const t=Object(n.useMemo)((()=>[{field:"name",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,a)=>r.a.createElement(ft,{id:e,name:t,nodeID:a.nodeID})},{field:"timestamp",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:t=>r.a.createElement(yt,{eventDate:t,id:e})}]),[e]),a=Object(o.useSelector)(Object(n.useCallback)((t=>{const{processNodePositions:a}=d.u(t.analyzer[e]),n=[];for(const e of a.keys()){const t=fe.c(e),a=fe.b(e);void 0!==a&&n.push({name:t,timestamp:fe.a(e),nodeID:a})}return n}),[e])),i=a.length,l=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),c=Object(o.useSelector)((t=>d.m(t.analyzer[e]))),u=Object(o.useSelector)((t=>d.l(t.analyzer[e]))),m=Object(o.useSelector)((t=>d.n(t.analyzer[e]))),p=!0===c||!0===u||!0===m,g=Object(n.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return r.a.createElement(pe,{hasBorder:!0},r.a.createElement(Re,{breadcrumbs:l}),p&&r.a.createElement(gt,{numberDisplayed:i}),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(s.EuiInMemoryTable,{rowProps:g,"data-test-subj":"resolver:node-list",items:a,columns:t,sorting:!0}))}));bt.displayName="NodeList";const ft=Object(n.memo)((({id:e,name:t,nodeID:a})=>{const i=Object(o.useSelector)((t=>d.A(t.analyzer[e])===a)),l=Object(o.useSelector)((t=>d.x(t.analyzer[e])(a))),{descriptionText:c}=f(),u=se(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),m=Object(o.useDispatch)(),{timestamp:p}=Object(n.useContext)(j),g=Object(n.useCallback)((t=>{u.onClick(t),m(Object(le.userSelectedResolverNode)({id:e,nodeID:a,time:p()}))}),[p,u,m,a,e]);return r.a.createElement(s.EuiButtonEmpty,{onClick:g,href:u.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":a},void 0===t?r.a.createElement(s.EuiBadge,{color:"warning"},h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):r.a.createElement(W,null,r.a.createElement(ee,{id:e,state:l,isOrigin:i,"data-test-subj":"resolver:node-list:node-link:icon"}),r.a.createElement(H,null,i&&r.a.createElement(q,{color:c,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},h.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),r.a.createElement(G,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}));ft.displayName="NodeDetailLink";const yt=Object(n.memo)((({eventDate:e,id:t})=>{const a=He(e);return a?r.a.createElement(rt.c,{data:{field:"@timestamp",value:e},triggerId:rt.d.DEFAULT,visibleCellActions:5,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(ot.getSourcererScopeId)(t),metadata:{scopeId:t}},a):r.a.createElement("span",null,"—")}));function vt(e){const t=[{path:[],value:e}],a=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:n,value:r}=e;Array.isArray(r)?t.push(...r.map((e=>({path:[...n],value:e})))):"object"==typeof r&&null!==r?t.push(...Object.keys(r).map((e=>({path:[...n,e],value:r[e]})))):null!=r&&a.push([n,r])}return a}yt.displayName="NodeDetailTimestamp";const Et=h.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),ht=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(o.useSelector)((t=>d.p(t.analyzer[e]))),s=Object(o.useSelector)((t=>d.s(t.analyzer[e]))),i=Object(o.useSelector)((a=>ve.a(d.w(a.analyzer[e])(t)))),l=Object(o.useSelector)((a=>d.x(a.analyzer[e])(t))),c=n||s||"loading"===l,u=Object(o.useSelector)((t=>d.f(t.analyzer[e])));return c?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(_e,{id:e})):u?r.a.createElement(xt,{id:e,nodeID:t,event:u,processEvent:i,eventType:a}):r.a.createElement(pe,{hasBorder:!0},r.a.createElement(it,{id:e,translatedErrorMessage:Et}))})),xt=Object(n.memo)((function({id:e,nodeID:t,event:a,eventType:n,processEvent:o}){const l=He(ye.m(a))||h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),c=o?ye.l(o):null;return r.a.createElement(pe,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},r.a.createElement(Ct,{id:e,nodeID:t,nodeName:c,event:a,breadcrumbEventCategory:n}),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(s.EuiText,{size:"s"},r.a.createElement(Y,null,r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:n,eventType:String(ye.h(a))},defaultMessage:"{category} {eventType}"})),r.a.createElement(K,{dateTime:l},r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:l},defaultMessage:"@ {date}"}))),r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(St,null,r.a.createElement(ae,null,r.a.createElement(Ue,{event:a}))),r.a.createElement(s.EuiSpacer,{size:"l"}),r.a.createElement(jt,{event:a,id:e}))}));function jt({event:e,id:t}){const a=Object(n.useMemo)((()=>{const t=[],a=Object(Ye.a)(e);for(const[e,n]of Object.entries(a)){if("agent"===e||"ecs"===e||"@timestamp"===e||!n)continue;const a=vt(n).map((([t,a])=>({title:[e,...t].join("."),description:String(a)})));t.push(...a)}return t}),[e]),o=[{field:"title","data-test-subj":"resolver:panel:event-detail:event-field-title",name:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0},{name:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.valueTitle",defaultMessage:"Value"}),render:e=>r.a.createElement(rt.c,{data:{field:e.title,value:e.description},visibleCellActions:5,triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(ot.getSourcererScopeId)(t),metadata:{scopeId:t}},e.description)}];return r.a.createElement(s.EuiInMemoryTable,{items:a,columns:o,search:{box:{incremental:!0,schema:!0}},pagination:!0,sorting:!0})}function Ct({id:e,nodeID:t,nodeName:a,event:s,breadcrumbEventCategory:l}){const c=Object(o.useSelector)((a=>d.D(a.analyzer[e])(t,l))),u=Object(o.useSelector)((a=>d.E(a.analyzer[e])(t))),m=se(e,{panelView:"nodes"}),p=se(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),g=se(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),b=se(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:l}}),f=Object(n.useMemo)((()=>{const e=[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...m},{text:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:u},defaultMessage:"{totalCount} Events"}),...g},{text:r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:c,category:l},defaultMessage:"{count} {category}"}),...b},{text:r.a.createElement(Ue,{event:s})}];return a&&e.splice(1,0,{text:a,...p}),e}),[l,c,s,p,g,a,u,m,b]);return r.a.createElement(Re,{breadcrumbs:f})}const St=Object(n.memo)(m()(s.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),kt=Object(n.memo)((function({id:e}){const t=Object(o.useSelector)((t=>d.B(t.analyzer[e])));return"nodeDetail"===t.panelView?r.a.createElement(dt,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?r.a.createElement(et,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?r.a.createElement(Ke,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?r.a.createElement(ht,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):r.a.createElement(bt,{id:e})}));var Ot=a(959);const wt=m()(s.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),Dt=m()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),Mt=()=>r.a.createElement(Dt,{"data-test-subj":"resolver:no-process-events",direction:"column"},r.a.createElement(s.EuiTitle,null,r.a.createElement("h4",null,h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(s.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(s.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(s.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(wt,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var It=a(123);const Pt=r.a.memo(r.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:a,indices:u,shouldUpdate:m,filters:p},g){!function(e){const t=Object(n.useRef)();t.current=Object(l.useLocation)().search;const a=Object(o.useDispatch)(),r=Object(l.useHistory)(),s=Object(c.a)(e);Object(n.useEffect)((()=>{const e=s;return()=>{const a=new URLSearchParams(t.current);a.delete(e);const n={search:a.toString()};r.replace(n)}}),[s,r,a,e])}(a),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:a,filters:r,shouldUpdate:s}){const i=Object(o.useDispatch)(),c=Object(l.useLocation)().search;Object(n.useLayoutEffect)((()=>{i(Object(le.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:c,indices:a,shouldUpdate:s,filters:r}))}),[i,e,t,c,a,s,r])}({databaseDocumentID:t,resolverComponentInstanceID:a,indices:u,shouldUpdate:m,filters:p}),function({id:e}){const{addSuccess:t}=Object(It.a)(),{from:a,to:r}=Object(o.useSelector)((t=>{const a=d.g(t.analyzer[e]);return{from:null!=a&&a.from?a.from:void 0,to:null!=a&&a.to?a.to:void 0}})),s=He(a),i=He(r),l=Object(n.useMemo)((()=>h.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:s,to:i}})),[s,i]);Object(n.useEffect)((()=>{(a||r)&&t(l)}),[t,l,a,r])}({id:a}),function({id:e}){const t=Object(o.useDispatch)(),a=e,r=Object(l.useLocation)().search,s=Object(n.useContext)(j),i=Object(o.useSelector)((t=>d.J(t.analyzer[e]))),c=Object(o.useSelector)((t=>d.i(t.analyzer[e]))),u=Object(Ot.a)({locationSearch:r,resolverComponentInstanceID:a});let m;"nodes"!==u.panelView&&(m=u.panelParameters.nodeID),Object(n.useEffect)((()=>{m&&c(m)&&m!==i&&t(Object(le.userSelectedResolverNode)({id:e,nodeID:m,time:s.timestamp()}))}),[u.panelView,m,t,c,i,s,e])}({id:a});const{timestamp:b}=Object(n.useContext)(j),y=b(),{processNodePositions:v,connectingEdgeLineSegments:x}=Object(o.useSelector)((e=>d.Q(e.analyzer[a])(y))),{projectionMatrix:S,ref:k,onMouseDown:O}=function({id:e}){const t=Object(o.useDispatch)(),a=Object(n.useContext)(j),[r,s]=Object(n.useState)(null),i=Object(o.useSelector)(Object(n.useCallback)((t=>d.C(t.analyzer[e])),[e])),l=Object(n.useRef)(),[c,u]=Object(n.useState)(i(a.timestamp())),m=Object(o.useSelector)((t=>d.P(t.analyzer[e]))),p=Object(o.useSelector)((t=>d.o(t.analyzer[e]))),[g,b]=function(){const{getBoundingClientRect:e}=Object(n.useContext)(j),[t,a]=Object(n.useState)(null),{ResizeObserver:r,requestAnimationFrame:o}=Object(n.useContext)(j),[s,i]=Object(n.useState)(null),l=Object(n.useCallback)((e=>{i(e)}),[]);return Object(n.useEffect)((()=>{null!==s&&a(e(s))}),[s,e]),Object(n.useEffect)((()=>{let t=window.scrollX,n=window.scrollY;const r=()=>{o((()=>{const r=window.scrollX,o=window.scrollY;null===s||t===r&&n===o||a(e(s)),t=r,n=o}))};return window.addEventListener("scroll",r,{passive:!0}),()=>{window.removeEventListener("scroll",r)}}),[s,o,e]),Object(n.useEffect)((()=>{if(null!==s){const t=new r((t=>{null!==s&&s===t[0].target&&a(e(s))}));return t.observe(s),()=>{t.disconnect()}}}),[r,s,e]),[t,l]}(),f=Object(n.useCallback)((e=>null===g?null:[e.clientX-g.x,e.clientY-g.y]),[g]),y=Object(n.useCallback)((n=>{const r=f(n);null!==r&&t(Object(C.userStartedPanning)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),v=Object(n.useCallback)((n=>{const r=f(n);r&&t(Object(C.userMovedPointer)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),E=Object(n.useCallback)((()=>{m&&t(Object(C.userStoppedPanning)({id:e,time:a.timestamp()}))}),[t,a,m,e]),h=Object(n.useCallback)((n=>{null!==g&&n.ctrlKey&&0!==n.deltaY&&0===n.deltaMode&&(n.preventDefault(),t(Object(C.userZoomed)({id:e,zoomChange:n.deltaY/-g.height,time:a.timestamp()})))}),[g,t,a,e]),x=Object(n.useCallback)((e=>{s(e),b(e)}),[b]);return Object(n.useEffect)((()=>(window.addEventListener("mouseup",E,{passive:!0}),()=>{window.removeEventListener("mouseup",E)})),[E]),Object(n.useEffect)((()=>(window.addEventListener("mousemove",v,{passive:!0}),()=>{window.removeEventListener("mousemove",v)})),[v]),Object(n.useEffect)((()=>{if(null!==r)return r.addEventListener("wheel",h),()=>{r.removeEventListener("wheel",h)}}),[r,h]),Object(n.useLayoutEffect)((()=>{l.current=i}),[i]),Object(n.useLayoutEffect)((()=>{u(i(a.timestamp()))}),[i,a]),Object(n.useLayoutEffect)((()=>{const e=a.timestamp();if(p(e)){let e=null;const t=()=>{const n=a.timestamp();void 0!==l.current&&u(l.current(n)),e=p(n)?a.requestAnimationFrame(t):null};return e=a.requestAnimationFrame(t),()=>{null!==e&&a.cancelAnimationFrame(e)}}}),[p,a]),Object(n.useEffect)((()=>{null!==g&&t(Object(C.userSetRasterSize)({id:e,dimensions:[g.width,g.height]}))}),[t,g,e]),{ref:x,onMouseDown:y,projectionMatrix:c}}({id:a}),w=Object(n.useCallback)((e=>{k(e),"function"==typeof g?g(e):null!==g&&(g.current=e)}),[k,g]),D=Object(o.useSelector)((e=>d.s(e.analyzer[a]))),M=Object(o.useSelector)((e=>d.k(e.analyzer[a]))),I=Object(o.useSelector)((e=>d.b(e.analyzer[a]))),P=Object(o.useSelector)((e=>d.G(e.analyzer[a]))),T=f();return r.a.createElement(me,{className:e,backgroundColor:T.resolverBackground},D?r.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},r.a.createElement(s.EuiLoadingSpinner,{size:"xl"})):M?r.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},r.a.createElement("div",null," ",r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):P?r.a.createElement(r.a.Fragment,null,r.a.createElement(ge,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:O,ref:w,role:"tree",tabIndex:0,"aria-activedescendant":I||void 0},x.map((({points:[e,t],metadata:a})=>r.a.createElement(E,{edgeLineMetadata:a,key:a.reactKey,startPosition:e,endPosition:t,projectionMatrix:S}))),[...v].map((([e,t])=>{const n=fe.b(e);if(void 0===n)throw new Error("Tried to render a node without an ID");return r.a.createElement(Se,{id:a,key:n,nodeID:n,position:t,projectionMatrix:S,node:e,timeAtRender:y})}))),r.a.createElement(kt,{id:a})):r.a.createElement(Mt,null),r.a.createElement(oe,{id:a}),r.a.createElement(ze,{id:a}))})))},805:function(e,t,a){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},806:function(e,t,a){"use strict";var n="%[a-f0-9]{2}",r=new RegExp("("+n+")|([^%]+?)","gi"),o=new RegExp("("+n+")+","gi");function s(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var a=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],s(a),s(n))}function i(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(r)||[],a=1;a<t.length;a++)t=(e=s(t,a).join("")).match(r)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},a=o.exec(e);a;){try{t[a[0]]=decodeURIComponent(a[0])}catch(e){var n=i(a[0]);n!==a[0]&&(t[a[0]]=n)}a=o.exec(e)}t["%C2"]="�";for(var r=Object.keys(t),s=0;s<r.length;s++){var l=r[s];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},807:function(e,t,a){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const a=e.indexOf(t);return-1===a?[e]:[e.slice(0,a),e.slice(a+t.length)]}}}]);