/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[11],{1196:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return f}));var r=n(48),i=n(57),o=n(182);const a=e=>e.artifacts.location,s=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},c=Object(i.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:o.n,exact:!0}))),l=Object(i.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:o.r,exact:!0}))),u=Object(i.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:o.m,exact:!0}))),p=Object(i.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:o.o,exact:!0}))),d=Object(i.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:o.l,exact:!0}))),f=Object(i.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:o.q,exact:!0})))},1205:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return p}));const r=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,o=e=>"LoadedResourceState"===e.type,a=e=>"FailedResourceState"===e.type,s=()=>({type:"UninitialisedResourceState"}),c=e=>({type:"LoadingResourceState",previousState:e}),l=e=>({type:"LoadedResourceState",data:e}),u=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),p=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return s()}}},1258:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7);const i=e=>{const{id:t,revision:n,created_by:i,created_at:o,updated_by:a,updated_at:s,...c}=e,l=Object(r.cloneDeep)(c),u=l.inputs[0].config.policy.value;return[u.windows.popup.malware,u.mac.popup.malware].forEach((e=>e.message.trim())),l}},1385:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(2),i=n.n(r),o=n(47);class SecuritySolutionQueryClient extends o.QueryClient{constructor(e={}){var t,n,r;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(r=e.defaultOptions)||void 0===r?void 0:r.queries)&&void 0!==n?n:{}}}})}}const a=new SecuritySolutionQueryClient,s=Object(r.memo)((({queryClient:e,children:t})=>{const n=Object(r.useMemo)((()=>e||a),[e]);return i.a.createElement(o.QueryClientProvider,{client:n},t)}));s.displayName="ReactQueryClientProvider"},1391:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var p,d,f,g,m=e[u].replace(s,"%20"),y=m.indexOf(n);y>=0?(p=m.substr(0,y),d=m.substr(y+1)):(p=m,d=""),f=decodeURIComponent(p),g=decodeURIComponent(d),r(a,f)?i(a[f])?a[f].push(g):a[f]=[a[f],g]:a[f]=g}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},1392:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),(function(a){var s=encodeURIComponent(r(a))+n;return i(e[a])?o(e[a],(function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[a]))})).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},1422:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return p}));var r=n(976),i=n(975),o=n(544),a=n(1258);const s=e=>{const t={coreStart:e};return e=>n=>async s=>{n(s),(async({coreStart:e},{dispatch:t,getState:n},s)=>{const c=e.http,l=n();if("userChangedUrl"===s.type&&Object(i.f)(l)&&Object(i.d)(l)){const e=Object(i.i)(l);let n;try{n=(await Object(o.e)(c,e)).item,""===n.inputs[0].config.policy.value.windows.popup.malware.message&&(n.inputs[0].config.policy.value.windows.popup.malware.message=r.a,n.inputs[0].config.policy.value.mac.popup.malware.message=r.a,n.inputs[0].config.policy.value.linux.popup.malware.message=r.a),""===n.inputs[0].config.policy.value.windows.popup.ransomware.message&&(n.inputs[0].config.policy.value.windows.popup.ransomware.message=r.a),""===n.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(n.inputs[0].config.policy.value.windows.popup.memory_protection.message=r.b),""===n.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(n.inputs[0].config.policy.value.mac.popup.memory_protection.message=r.b),""===n.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(n.inputs[0].config.policy.value.linux.popup.memory_protection.message=r.b),""===n.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.windows.popup.behavior_protection.message=r.b),""===n.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.mac.popup.behavior_protection.message=r.b),""===n.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.linux.popup.behavior_protection.message=r.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:n}}),n.policy_id){const{results:e}=await Object(o.d)(c,n.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===s.type){const{id:e}=Object(i.g)(l),n=Object(i.h)(l);let r;try{r=await Object(o.f)(c,e,n).catch((t=>t.response&&409===t.response.status?Object(o.e)(c,e).then((t=>{const r=t.item;return r.inputs[0].config.policy=n.inputs[0].config.policy,Object(o.f)(c,e,Object(a.a)(r))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:r.item,updateStatus:{success:!0}}})}})(t,e,s)}};var c=n(726),l=n(265),u=n(182);const p=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0,all:0,active:0},artifacts:{location:{page:u.b,pageSize:u.c,show:void 0,filter:""}}}),d=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),f=(e=p(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const n={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(l.b)(Object(c.parse)(t.payload.search.slice(1)))}},r=Object(i.d)(n),o=Object(i.d)(e),a=Object(i.e)(n);return r?o?n:{...n,isLoading:!0}:{...p(),location:t.payload,license:a}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const n={...e,policyItem:{...e.policyItem}},r={...Object(i.c)(e)};return n.policyItem.inputs[0].config.policy.value=r,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{r[e]={...r[e],...t}})),n}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const n=Object(i.c)(e);return{...e,policyItem:d(e.policyItem,{...n,windows:{...n.windows,antivirus_registration:{...n.windows.antivirus_registration,enabled:t.payload.enabled}}})}}return e}if("userChangedCredentialHardening"===t.type){if(e.policyItem){const n=Object(i.c)(e);return{...e,policyItem:d(e.policyItem,{...n,windows:{...n.windows,attack_surface_reduction:{credential_hardening:{enabled:t.payload.enabled}}}})}}return e}return e},g=(e=p(),t)=>[f].reduce(((e,n)=>n(e,t)),e)},1586:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n.n(r),o=n(45),a=n(16);const s=Object(r.memo)((({children:e})=>{const t=Object(o.useDispatch)();return Object(r.useEffect)((()=>{var e;const n=null===(e=a.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==n?void 0:n.unsubscribe()}),[t]),i.a.createElement(i.a.Fragment,null,e)}));s.displayName="CurrentLicense"},1613:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(88),i=n(1422),o=n(182),a=n(691),s=n(167),c=n(1205);const l=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,sortDirection:s.i,sortField:s.j,loading:!1,error:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(c.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:o.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,isolationRequestState:Object(c.e)(),metadataTransformStats:Object(c.e)(),isInitialized:!1}),u=r.combineReducers,p=(o.w,Object(i.a)(),o.u,l(),u({[o.w]:i.c,[o.u]:(e=l(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:n,total:r,page:i,pageSize:o,sortDirection:a,sortField:s}=t.payload;return{...e,hosts:n,total:r,pageIndex:i,pageSize:o,sortField:s,sortDirection:a,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("serverFinishedInitialization"===t.type)return{...e,isInitialized:t.payload};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var n,r;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(n=t.payload.isAutoRefreshEnabled)&&void 0!==n?n:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(r=t.payload.autoRefreshInterval)&&void 0!==r?r:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const n={...e,location:t.payload},r=Object(a.isOnEndpointPage)(n)&&!Object(a.hasSelectedEndpoint)(n),i=Object(a.isOnEndpointPage)(e)&&!Object(a.hasSelectedEndpoint)(e),o=Object(a.isOnEndpointPage)(n)&&Object(a.hasSelectedEndpoint)(n),s=Object(a.isOnEndpointPage)(e)&&Object(a.hasSelectedEndpoint)(e),l={location:t.payload,error:void 0};if("isolate"===Object(a.uiQueryParams)(n).show||Object(c.i)(Object(a.getCurrentIsolationRequestState)(n))||(l.isolationRequestState=Object(c.e)()),r){if(!i)return{...e,...l,loading:!0,policyItemsLoading:!0}}else if(o)return s||i?{...e,...l,detailsLoading:!0}:{...e,...l,loading:!0,policyItemsLoading:!0};return{...e,...l,endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},1621:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(148),i=n(182),o=n(1422),a=n(3),s=n(421),c=n.n(s),l=n(167),u=n(428),p=n(935),d=n(1205),f=n(544),g=n(691);const m=console.error,y=(e,t)=>{async function n(e){var n;const r=null!==(n=Object(g.endpointPackageVersion)(e))&&void 0!==n?n:"",i=r.includes("-")?r.substring(0,r.indexOf("-")):r,o=c()(i,"1.2.0")?l.w:l.E,s=t.data.search.search({indices:[o],onlyCheckIfIndicesExist:!1},{strategy:l.l});return[{title:o,fields:(await Object(a.firstValueFrom)(s)).indexFields}]}return t=>r=>async i=>{r(i);const{getState:o,dispatch:a}=t;return await async function(e,t,n){if(Object(g.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(d.d)(Object(d.a)(Object(g.endpointPackageInfo)(e)))});try{const e=await Object(f.c)(n.http);t({type:"endpointPackageInfoStateChanged",payload:Object(d.c)(e)})}catch(e){m(e),t({type:"endpointPackageInfoStateChanged",payload:Object(d.b)(e)})}}}(o(),a,e),"userChangedUrl"!==i.type&&"appRequestedEndpointList"!==i.type||!Object(g.isOnEndpointPage)(o())||await async function({store:e,coreStart:t,fetchIndexPatterns:n}){const{getState:r,dispatch:i}=e,{page_index:o,page_size:a,sort_field:s,sort_direction:c}=Object(g.uiQueryParams)(r());let u;try{const n=Object(g.searchBarQuery)(r());u=await t.http.get(l.s,{version:"2023-10-31",query:{page:o,pageSize:a,kuery:n.query,sortField:s,sortDirection:c}}),i({type:"serverReturnedEndpointList",payload:u}),async function({store:e,hosts:t,http:n}){const{getState:r,dispatch:i}=e;try{const e=await b(n,t,Object(g.nonExistingPolicies)(r()));void 0!==(null==e?void 0:e.packagePolicy)&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){m(e)}}({http:t.http,hosts:u.data,store:e})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(g.patterns)(r()).length)try{const e=await n(r());void 0!==e&&i({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){i({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(u&&0===u.data.length){const e=t.http;if(await E(e))return void i({type:"serverFinishedInitialization",payload:!0});i({type:"serverReturnedEndpointExistValue",payload:!1});try{i({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(p.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var d;i({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(d=e.body)&&void 0!==d?d:e})}}else i({type:"serverCancelledPolicyItemsLoading"}),i({type:"serverReturnedEndpointExistValue",payload:!0});i({type:"serverFinishedInitialization",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:n}),"endpointIsolationRequest"===i.type?h(t,i):"loadMetadataTransformStats"===i.type?async function(e,t){const{getState:n,dispatch:r}=t;if(!e||!n||!r)return;const i=n();if(!Object(g.isMetadataTransformStatsLoading)(i)){r({type:"metadataTransformStatsChanged",payload:Object(d.d)(Object(d.a)(Object(g.getMetadataTransformStats)(i)))});try{const t=await e.get(l.v,{version:"2023-10-31"});r({type:"metadataTransformStatsChanged",payload:Object(d.c)(t.transforms)})}catch(e){r({type:"metadataTransformStatsChanged",payload:Object(d.b)(e)})}}}(e.http,t):void 0}},b=async(e,t,n)=>{if(0===t.length)return;const r=[...new Set(t.reduce(((e,t)=>{const r=t.metadata.Endpoint.policy.applied.id;return n[r]||e.push(r),e}),[]))];if(0===r.length)return;const i=(await Object(f.b)(e,r)).items.reduce(((e,t)=>(e.packagePolicy[t.id]=!0,e.agentPolicy[t.id]=t.policy_ids[0],e)),{packagePolicy:{},agentPolicy:{}}),o=r.reduce(((e,t)=>i.packagePolicy[t]?(e.agentPolicy[t]=i.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(o.packagePolicy).length||0!==Object.keys(o.agentPolicy).length?o:void 0},E=async e=>{try{return await(async e=>{try{return(await e.get(l.s,{version:"2023-10-31",query:{page:0,pageSize:1}})).total}catch(e){m("error while trying to check for total endpoints"),m(e)}return 0})(e)>0}catch(e){m("error while trying to check if endpoints exist"),m(e)}return!1},h=async({getState:e,dispatch:t},n)=>{const r=e();if(!Object(g.getIsIsolationRequestPending)(r)){t({type:"endpointIsolationRequestStateChange",payload:Object(d.d)(Object(d.a)(Object(g.getCurrentIsolationRequestState)(r)))});try{let e;e="unisolate"===n.payload.type?await Object(u.b)(n.payload.data):await Object(u.a)(n.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(d.c)(e)})}catch(e){var i;t({type:"endpointIsolationRequestStateChange",payload:Object(d.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}},v=e=>t=>t[i.v][e],O=(e,t)=>[Object(r.f)(v(i.w),Object(o.b)(e,t)),Object(r.f)(v(i.u),y(e,t))]},164:function(e,t,n){const r=n(347),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(348),{safeRe:a,t:s}=n(311),c=n(431),{compareIdentifiers:l}=n(558);class SemVer{constructor(e,t){if(t=c(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},182:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"k",(function(){return a})),n.d(t,"n",(function(){return s})),n.d(t,"r",(function(){return c})),n.d(t,"m",(function(){return l})),n.d(t,"o",(function(){return u})),n.d(t,"l",(function(){return p})),n.d(t,"q",(function(){return d})),n.d(t,"p",(function(){return f})),n.d(t,"t",(function(){return g})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return y})),n.d(t,"g",(function(){return b})),n.d(t,"s",(function(){return E})),n.d(t,"v",(function(){return h})),n.d(t,"w",(function(){return v})),n.d(t,"u",(function(){return O})),n.d(t,"f",(function(){return I})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return R})),n.d(t,"e",(function(){return _})),n.d(t,"d",(function(){return j})),n.d(t,"a",(function(){return w}));var r=n(5),i=n(660);const o=`${r.Tb}/:tabName(${i.a.endpoints})`,a=`${r.Tb}/:tabName(${i.a.policies})`,s=`${r.Tb}/:tabName(${i.a.policies})/:policyId/settings`,c=`${r.Tb}/:tabName(${i.a.policies})/:policyId/trustedApps`,l=`${r.Tb}/:tabName(${i.a.policies})/:policyId/eventFilters`,u=`${r.Tb}/:tabName(${i.a.policies})/:policyId/hostIsolationExceptions`,p=`${r.Tb}/:tabName(${i.a.policies})/:policyId/blocklists`,d=`${r.Tb}/:tabName(${i.a.policies})/:policyId/protectionUpdates`,f=`${r.Tb}/:tabName(${i.a.policies})/:policyId`,g=`${r.Tb}/:tabName(${i.a.trustedApps})`,m=`${r.Tb}/:tabName(${i.a.eventFilters})`,y=`${r.Tb}/:tabName(${i.a.hostIsolationExceptions})`,b=`${r.Tb}/:tabName(${i.a.blocklist})`,E=`${r.Tb}/:tabName(${i.a.responseActionsHistory})`,h="management",v="policyDetails",O="endpoints",I=[10,20,50],S=0,R=10,_="desc",j="created_at",w=1e4},190:function(e,t,n){const r=n(164);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},2129:function(e,t,n){"use strict";n.r(t),n.d(t,"withSecurityContext",(function(){return v}));var r=n(2),i=n.n(r),o=n(88),a=n(1613),s=n(260),c=n(24),l=n(1621);const u=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.compose;var p=n(45),d=n(1267),f=n(452),g=n(739),m=n(1385),y=n(1214),b=n(1586),E=n(118);const h=Object(r.memo)((({store:e,depsStart:t,queryClient:n,upsellingService:r,children:o})=>{const a=Object(E.j)().services,{application:{capabilities:s}}=a;return i.a.createElement(p.Provider,{store:e},i.a.createElement(m.a,{queryClient:n},i.a.createElement(y.a.Provider,{value:t},i.a.createElement(g.b,{kibanaCapabilities:s},i.a.createElement(d.a,{core:a},i.a.createElement(b.a,null,i.a.createElement(f.a,{upsellingService:r},o)))))))}));h.displayName="RenderContextProviders";const v=({coreStart:e,depsStart:t,services:{upsellingService:n},WrappedComponent:p})=>{let d;return Object(r.memo)((r=>(d||(d=(({coreStart:e,depsStart:t,reducersObject:n={management:a.a,app:s.b},preloadedState:r={management:void 0,app:{enableExperimental:c.a.get()}},additionalMiddleware:i=[]})=>Object(o.createStore)(Object(o.combineReducers)(n),r,u(Object(o.applyMiddleware)(...Object(l.a)(e,t),...i))))({coreStart:e,depsStart:t})),i.a.createElement(h,{store:d,depsStart:t,upsellingService:n},i.a.createElement(p,r)))))}},265:function(e,t,n){"use strict";n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"h",(function(){return y})),n.d(t,"j",(function(){return b})),n.d(t,"o",(function(){return E})),n.d(t,"l",(function(){return h})),n.d(t,"a",(function(){return _})),n.d(t,"p",(function(){return j})),n.d(t,"b",(function(){return w})),n.d(t,"k",(function(){return P})),n.d(t,"f",(function(){return L})),n.d(t,"g",(function(){return N})),n.d(t,"m",(function(){return $})),n.d(t,"c",(function(){return A})),n.d(t,"i",(function(){return T})),n.d(t,"n",(function(){return C}));var r=n(44),i=n(726),o=n.n(i),a=n(48),s=n(207),c=n(518),l=n(660),u=n(182);const p=(e,t)=>void 0===e||e===t||0===e,d=(e,t={})=>`${e}${Object(s.a)(o.a.stringify(((e={})=>({...p(e.page,1)?{}:{page:e.page},...p(e.pageSize,u.c)?{}:{pageSize:e.pageSize},...p(e.show,void 0)?{}:{show:e.show},...p(e.itemId,void 0)?{}:{itemId:e.itemId},...p(e.filter,"")?"":{filter:e.filter},...p(e.includedPolicies,"")?"":{includedPolicies:e.includedPolicies}}))(t)))}`,f=e=>o.a.stringify(e),g=(e,t)=>{const{name:n,...i}=e,o=f(i),c=`${o&&!Object(r.isEmpty)(t)?"&":""}${null!=t?t:""}`;return"endpointList"===n?`${Object(a.generatePath)(u.h,{tabName:l.a.endpoints})}${Object(s.a)(`${o?`${o}${c}`:c}`)}`:`${Object(s.a)(`${o?`${o}${c}`:c}`)}`},m=(e,t)=>{const{name:n,show:i,...o}=e,c={...o};switch(e.name){case"endpointDetails":c.show="details";break;case"endpointIsolate":c.show="isolate";break;case"endpointUnIsolate":c.show="unisolate";break;case"endpointPolicyResponse":c.show="policy_response";break;case"endpointActivityLog":c.show="activity_log"}const p=f(c),d=`${p&&!Object(r.isEmpty)(t)?"&":""}${null!=t?t:""}`;return`${Object(a.generatePath)(u.h,{tabName:l.a.endpoints})}${Object(s.a)(`${p?`${p}${d}`:d}`)}`},y=e=>`${Object(a.generatePath)(u.k,{tabName:l.a.policies})}${Object(s.a)(e)}`,b=(e,t)=>`${Object(a.generatePath)(u.n,{tabName:l.a.policies,policyId:e})}${Object(s.a)(t)}`,E=(e,t)=>`${Object(a.generatePath)(u.r,{tabName:l.a.policies,policyId:e})}${Object(s.a)(t)}`,h=(e,t)=>`${Object(a.generatePath)(u.m,{tabName:l.a.policies,policyId:e})}${Object(s.a)(o.a.stringify(v(t)))}`,v=e=>e?{...p(e.page,u.b+1)?{}:{page:e.page},...p(e.pageSize,u.c)?{}:{pageSize:e.pageSize},...p(e.show,void 0)?{}:{show:e.show},...p(e.filter,"")?"":{filter:e.filter}}:{},O=(e,t)=>{const n=e[t];return Array.isArray(n)?n[n.length-1]:n},I=e=>{const t=Number(O(e,"page_index"));return!Number.isFinite(t)||t<0?u.b:t},S=e=>{const t=Number(O(e,"page_size"));return u.f.includes(t)?t:u.c},R=e=>O(e,"filter")||"",_=e=>({page_index:I(e),page_size:S(e),filter:R(e)}),j=e=>{const t=Object(a.generatePath)(u.t,{tabName:l.a.trustedApps});return d(t,e)},w=e=>{const t=O(e,"show"),n=Object(c.a)(e);return{page:n.page,pageSize:n.pageSize,filter:e.filter,show:t&&"list"===t?t:void 0}},P=(e,t)=>`${Object(a.generatePath)(u.r,{tabName:l.a.policies,policyId:e})}${Object(s.a)(o.a.stringify(v(t)))}`,L=e=>{const t=Object(a.generatePath)(u.i,{tabName:l.a.eventFilters});return d(t,e)},N=e=>{const t=Object(a.generatePath)(u.j,{tabName:l.a.hostIsolationExceptions});return d(t,e)},$=(e,t)=>`${Object(a.generatePath)(u.o,{tabName:l.a.policies,policyId:e})}${Object(s.a)(o.a.stringify(v(t)))}`,A=e=>{const t=Object(a.generatePath)(u.g,{tabName:l.a.blocklist});return d(t,e)},T=(e,t)=>`${Object(a.generatePath)(u.l,{tabName:l.a.policies,policyId:e})}${Object(s.a)(o.a.stringify(v(t)))}`,C=(e,t)=>`${Object(a.generatePath)(u.q,{tabName:l.a.policies,policyId:e})}${Object(s.a)(o.a.stringify(v(t)))}`},297:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(429),o=n(48);function a(){const{search:e}=Object(o.useLocation)();return Object(r.useMemo)((()=>{const t=Object(i.parse)(e);return{urlParams:t,toUrlParams:(e=t)=>Object(i.stringify)(e)}}),[e])}},311:function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=n(348),a=n(347),s=(t=e.exports={}).re=[],c=t.safeRe=[],l=t.src=[],u=t.t={};let p=0;const d="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",o],[d,i]],g=(e,t,n)=>{const r=(e=>{for(const[t,n]of f)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=p++;a(e,i,t),u[e]=i,l[i]=t,s[i]=new RegExp(t,n?"g":void 0),c[i]=new RegExp(r,n?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),g("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${d}+`),g("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),g("FULL",`^${l[u.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),g("LOOSE",`^${l[u.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),g("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),g("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?`+`(?:${l[u.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",l[u.COERCE],!0),g("COERCERTLFULL",l[u.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},347:function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(892))},348:function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},421:function(e,t,n){const r=n(190);e.exports=(e,t,n)=>r(e,t,n)>=0},431:function(e,t){const n=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:r},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(2),i=n.n(r);const o=i.a.createContext(null),a=Object(r.memo)((({upsellingService:e,children:t})=>i.a.createElement(o.Provider,{value:e},t)));a.displayName="UpsellingProvider";const s=()=>{const e=Object(r.useContext)(o);if(!e)throw new Error("UpsellingProviderContext not found");return e}},518:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(2),i=n(48),o=n(182),a=n(297);const s=e=>{var t,n,r;const i={pageSize:o.c,page:1};return i.page=Number(null!==(t=Array.isArray(e.page)?e.page[e.page.length-1]:e.page)&&void 0!==t?t:i.page),i.pageSize=null!==(n=Number(null!==(r=Array.isArray(e.pageSize)?e.pageSize[e.pageSize.length-1]:e.pageSize)&&void 0!==r?r:i.pageSize))&&void 0!==n?n:i.pageSize,(!Number.isFinite(i.page)||i.page<1)&&(i.page=1),o.f.includes(i.pageSize)||(i.pageSize=o.c),i},c=()=>{const e=Object(i.useLocation)(),t=Object(i.useHistory)(),{urlParams:n,toUrlParams:c}=Object(a.a)(),l=Object(r.useMemo)((()=>s(n)),[n]),[u,p]=Object(r.useState)(l),d=Object(r.useCallback)((({pageSize:r,page:i})=>{t.push({...e,search:c({...n,page:i,pageSize:r})})}),[t,e,c,n]);return Object(r.useEffect)((()=>{p((e=>({...e,...s(n)})))}),[p,n]),{pagination:u,setPagination:d,pageSizeOptions:[...o.f]}}},544:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return p}));var r=n(67);const i="/api/fleet",o=`${i}/package_policies`,a=`${i}/agent_status`,s=(e,t,n)=>e.get(`${o}/${t}`,{...n,version:r.API_VERSIONS.public.v1}),c=(e,t,n)=>e.post(`${o}/_bulk_get`,{...n,version:r.API_VERSIONS.public.v1,body:JSON.stringify({ids:t,ignoreMissing:!0})}),l=(e,t,n,i={})=>e.put(`${o}/${t}`,{...i,version:r.API_VERSIONS.public.v1,body:JSON.stringify(n)}),u=(e,t,n={})=>e.get(a,{...n,version:r.API_VERSIONS.public.v1,query:{policyId:t}}),p=async e=>{const t=r.epmRouteService.getInfoPath("endpoint"),n=(await e.get(t,{version:r.API_VERSIONS.public.v1})).item;if(!n)throw new Error("Endpoint package was not found.");return n}},558:function(e,t){const n=/^[0-9]+$/,r=(e,t)=>{const r=n.test(e),i=n.test(t);return r&&i&&(e=+e,t=+t),e===t?0:r&&!i?-1:i&&!r?1:e<t?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},660:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));let r=function(e){return e.endpoints="endpoints",e.policies="policy",e.trustedApps="trusted_apps",e.eventFilters="event_filters",e.hostIsolationExceptions="host_isolation_exceptions",e.blocklist="blocklist",e.responseActionsHistory="response_actions_history",e.protectionUpdates="protection_updates",e}({})},691:function(e,t,n){"use strict";n.r(t),n.d(t,"listData",(function(){return p})),n.d(t,"pageIndex",(function(){return d})),n.d(t,"pageSize",(function(){return f})),n.d(t,"sortField",(function(){return g})),n.d(t,"sortDirection",(function(){return m})),n.d(t,"totalHits",(function(){return y})),n.d(t,"listLoading",(function(){return b})),n.d(t,"listError",(function(){return E})),n.d(t,"policyItems",(function(){return h})),n.d(t,"policyItemsLoading",(function(){return v})),n.d(t,"isInitialized",(function(){return O})),n.d(t,"selectedPolicyId",(function(){return I})),n.d(t,"endpointPackageInfo",(function(){return S})),n.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return R})),n.d(t,"isAutoRefreshEnabled",(function(){return _})),n.d(t,"autoRefreshInterval",(function(){return j})),n.d(t,"endpointPackageVersion",(function(){return w})),n.d(t,"patterns",(function(){return P})),n.d(t,"patternsError",(function(){return L})),n.d(t,"isOnEndpointPage",(function(){return N})),n.d(t,"uiQueryParams",(function(){return $})),n.d(t,"hasSelectedEndpoint",(function(){return A})),n.d(t,"showView",(function(){return T})),n.d(t,"nonExistingPolicies",(function(){return C})),n.d(t,"agentPolicies",(function(){return D})),n.d(t,"endpointsExist",(function(){return F})),n.d(t,"searchBarQuery",(function(){return x})),n.d(t,"getCurrentIsolationRequestState",(function(){return k})),n.d(t,"getIsIsolationRequestPending",(function(){return U})),n.d(t,"getWasIsolationRequestSuccessful",(function(){return M})),n.d(t,"getIsolationRequestError",(function(){return G})),n.d(t,"getMetadataTransformStats",(function(){return V})),n.d(t,"metadataTransformStats",(function(){return z})),n.d(t,"isMetadataTransformStatsLoading",(function(){return q}));var r=n(726),i=n.n(r),o=n(57),a=n(48),s=n(58),c=n(265),l=n(182),u=n(1205);const p=e=>e.hosts,d=e=>e.pageIndex,f=e=>e.pageSize,g=e=>e.sortField,m=e=>e.sortDirection,y=e=>e.total,b=e=>e.loading,E=e=>e.error,h=e=>e.policyItems,v=e=>e.policyItemsLoading,O=e=>e.isInitialized,I=e=>e.selectedPolicyId,S=e=>e.endpointPackageInfo,R=Object(o.createSelector)(S,(e=>Object(u.i)(e))),_=e=>e.isAutoRefreshEnabled,j=e=>e.autoRefreshInterval,w=Object(o.createSelector)(S,(e=>Object(u.g)(e)?e.data.version:void 0)),P=e=>e.patterns,L=e=>e.patternsError,N=e=>{var t,n;return null!==Object(a.matchPath)(null!==(t=null===(n=e.location)||void 0===n?void 0:n.pathname)&&void 0!==t?t:"",{path:l.h,exact:!0})},$=Object(o.createSelector)((e=>e.location),(e=>{const t={page_index:String(l.b),page_size:String(l.c)};if(e){const n=i.a.parse(e.search.slice(1)),r=Object(c.a)(n),o=["selected_endpoint","show","admin_query","sort_field","sort_direction"],a=["policy_response","details","isolate","unisolate","activity_log"];for(const e of o){const r="string"==typeof n[e]?n[e]:Array.isArray(n[e])?n[e][n[e].length-1]:void 0;void 0!==r&&("show"===e?a.includes(r)&&(t[e]=r):"sort_direction"===e?["asc","desc"].includes(r)&&(t[e]=r):t[e]=r)}t.page_size=String(r.page_size),t.page_index=String(r.page_index)}return t})),A=Object(o.createSelector)($,(({selected_endpoint:e})=>void 0!==e)),T=Object(o.createSelector)($,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),C=e=>e.nonExistingPolicies,D=e=>e.agentPolicies,F=e=>e.endpointsExist,x=Object(o.createSelector)($,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const n=Object(s.decode)(e);n&&"string"==typeof n.query&&(t.query=n.query),!n||"string"!=typeof n.language||"kuery"!==n.language&&"lucene"!==n.language||(t.language=n.language)}return t})),k=e=>e.isolationRequestState,U=Object(o.createSelector)(k,(e=>Object(u.h)(e))),M=Object(o.createSelector)(k,(e=>Object(u.g)(e))),G=Object(o.createSelector)(k,(e=>{if(Object(u.f)(e))return e.error})),V=e=>e.metadataTransformStats,z=e=>Object(u.g)(e.metadataTransformStats)?e.metadataTransformStats.data:[],q=e=>Object(u.h)(e.metadataTransformStats)},726:function(e,t,n){"use strict";t.decode=t.parse=n(1391),t.encode=t.stringify=n(1392)},935:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(67),i=n(544);const o=(e,t={})=>{var n;return e.get(i.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${r.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`},version:r.API_VERSIONS.public.v1})}},975:function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return y})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return S}));var r=n(48),i=n(57),o=n(29),a=n(976),s=n(182),c=n(1258),l=n(1196);const u=e=>e.policyItem,p=Object(i.createSelector)(u,(e=>e.license),((e,t)=>{if(e){const n=((e,t)=>{if(Object(o.b)(t,"enterprise"))return Object(a.d)(e);if(Object(o.b)(t,"platinum")){const t=Object(a.d)(e);return Object(a.e)(t)}return Object(a.f)(e)})(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:n}}}]}}return e})),d=Object(i.createSelector)(p,(e=>{if(e)return Object(c.a)(e)})),f=e=>!e.policyItem&&!e.apiError,g=e=>Object(l.e)(e)||Object(l.f)(e)||Object(l.d)(e)||Object(l.c)(e)||Object(l.b)(e)||Object(l.g)(e),m=e=>e.license,y=Object(i.createSelector)((e=>e.location),(e=>{var t,n,i,o;return null!==(t=null===(n=Object(r.matchPath)(null!==(o=null==e?void 0:e.pathname)&&void 0!==o?o:"",{path:[s.n,s.r,s.m,s.o,s.l,s.q],exact:!0}))||void 0===n||null===(i=n.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),b=Object(a.c)(),E=Object(i.createSelector)(p,(e=>{var t,n,r,i;return null!==(t=null==e||null===(n=e.inputs[0])||void 0===n||null===(r=n.config)||void 0===r||null===(i=r.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:b})),h=Object(i.createSelector)(E,(e=>null==e?void 0:e.windows)),v=Object(i.createSelector)(E,(e=>null==e?void 0:e.mac)),O=Object(i.createSelector)(E,(e=>null==e?void 0:e.linux)),I=(Object(i.createSelector)(h,v,O,((e,t,n)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:n.advanced,events:n.events,malware:n.malware,behavior_protection:n.behavior_protection,memory_protection:n.memory_protection,popup:n.popup}}))),e=>e.apiError),S=e=>e.agentStatusSummary},976:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p}));var r=n(203),i=n(7);const o=[r.f.mac,r.f.linux,r.f.windows],a=(e="",t=!1,n="",a="",s="",c=!1)=>{const l={meta:{license:e,license_uuid:n,cluster_uuid:a,cluster_name:s,cloud:t,serverless:c},global_manifest_version:"latest",windows:{events:{credential_access:!0,dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:r.g.prevent,blocklist:!0,on_write_scan:!0},ransomware:{mode:r.g.prevent,supported:!0},memory_protection:{mode:r.g.prevent,supported:!0},behavior_protection:{mode:r.g.prevent,reputation_service:t,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{mode:r.a.sync,enabled:!0},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:r.g.prevent,blocklist:!0,on_write_scan:!0},behavior_protection:{mode:r.g.prevent,reputation_service:t,supported:!0},memory_protection:{mode:r.g.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"DYLD_INSERT_LIBRARIES,DYLD_FRAMEWORK_PATH,DYLD_LIBRARY_PATH,LD_PRELOAD"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:r.g.prevent,blocklist:!0,on_write_scan:!0},behavior_protection:{mode:r.g.prevent,reputation_service:t,supported:!0},memory_protection:{mode:r.g.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"LD_PRELOAD,LD_LIBRARY_PATH"}}};return l.meta.billable=function(e){return!!e.meta.serverless&&!(e=>{let t;return{isOnlyCollectingEvents:![{keyPath:"malware.mode",osList:[...o],disableValue:r.g.off,enableValue:r.g.prevent},{keyPath:"ransomware.mode",osList:[r.f.windows],disableValue:r.g.off,enableValue:r.g.prevent},{keyPath:"memory_protection.mode",osList:[...o],disableValue:r.g.off,enableValue:r.g.prevent},{keyPath:"behavior_protection.mode",osList:[...o],disableValue:r.g.off,enableValue:r.g.prevent},{keyPath:"attack_surface_reduction.credential_hardening.enabled",osList:[r.f.windows],disableValue:!1,enableValue:!0},{keyPath:"antivirus_registration.enabled",osList:[r.f.windows],disableValue:!1,enableValue:!0}].some((({keyPath:n,osList:r,disableValue:o})=>r.some((r=>{const a=`${r}.${n}`,s=Object(i.get)(e,a),c=s!==o;return c&&(t=`property [${a}] is set to [${s}]`),c})))),message:t}})(e).isOnlyCollectingEvents}(l),l},s=(e=a())=>({...e,global_manifest_version:"latest"}),c=(e=a())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,global_manifest_version:"latest",windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:r.g.off,supported:!1},memory_protection:{mode:r.g.off,supported:!1},behavior_protection:{mode:r.g.off,reputation_service:!1,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:r.g.off,reputation_service:!1,supported:!1},memory_protection:{mode:r.g.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:r.g.off,reputation_service:!1,supported:!1},memory_protection:{mode:r.g.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},l=(e=a())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),u="Elastic Security {action} {filename}",p="Elastic Security {action} {rule}"}}]);