/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[0],{118:function(e,t,n){"use strict";var r=n(364);n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return r.b})),n.d(t,"e",(function(){return r.c})),n.d(t,"f",(function(){return r.d})),n.d(t,"h",(function(){return r.e})),n.d(t,"i",(function(){return r.f})),n.d(t,"k",(function(){return r.g})),n.d(t,"l",(function(){return r.h})),n.d(t,"m",(function(){return r.i})),n.d(t,"n",(function(){return r.j}));var a=n(242);n.d(t,"a",(function(){return a.a})),n.d(t,"g",(function(){return a.b})),n.d(t,"j",(function(){return a.c})),n.d(t,"o",(function(){return a.e}));var o=n(31);n.d(t,"b",(function(){return o.a}))},119:function(e,t,n){e.exports=n(35)(4)},1202:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"c",(function(){return errors_ToasterError})),n.d(t,"f",(function(){return C})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return w}));var r=n(19),a=n(44),o=n(2),i=n.n(o),s=n(41),c=n.n(s),l=n(4);const u=l.i18n.translate("xpack.securitySolution.modalAllErrors.seeAllErrors.button",{defaultMessage:"See the full error(s)"}),d=l.i18n.translate("xpack.securitySolution.modalAllErrors.title",{defaultMessage:"Your visualization has error(s)"}),m=l.i18n.translate("xpack.securitySolution.modalAllErrors.close.button",{defaultMessage:"Close"}),g=({isShowing:e,toast:t,toggle:n})=>{const a=Object(o.useCallback)((()=>n(t)),[n,t]);return e&&null!=t?i.a.createElement(r.EuiModal,{onClose:a},i.a.createElement(r.EuiModalHeader,null,i.a.createElement(r.EuiModalHeaderTitle,null,d)),i.a.createElement(r.EuiModalBody,null,i.a.createElement(r.EuiCallOut,{title:t.title,color:"danger",size:"s",iconType:"warning"}),i.a.createElement(r.EuiSpacer,{size:"s"}),Array.isArray(t.errors)&&t.errors.map(((e,n)=>i.a.createElement(r.EuiAccordion,{key:`${t.id}-${n}`,id:"accordion1",initialIsOpen:0===n,buttonContent:e.length>100?`${e.substring(0,100)} ...`:e,"data-test-subj":"modal-all-errors-accordion"},i.a.createElement(p,null,e))))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButton,{onClick:a,fill:!0,"data-test-subj":"modal-all-errors-close"},m))):null},f=i.a.memo(g),p=c()(r.EuiCodeBlock).withConfig({displayName:"MyEuiCodeBlock",componentId:"sc-1ils255-0"})(["margin-top:4px;"]);p.displayName="MyEuiCodeBlock";var b=n(50),y=n(128),j=n(0),O=n.n(j);class errors_ToasterError extends Error{constructor(e){super(e[0]),O()(this,"messages",void 0),this.name="ToasterError",this.messages=e}}const h=(e,t,n=Object(b.v4)())=>{t({type:"addToaster",toast:{id:n,title:e,color:"success",iconType:"check"}})},v=({id:e=Object(b.v4)(),title:t,error:n,color:r="danger",iconType:o="error",dispatchToaster:i})=>{let s;s=(e=>e instanceof errors_ToasterError)(n)?{id:e,title:t,color:r,iconType:o,errors:n.messages}:Object(y.r)(n)?{id:e,title:t,color:r,iconType:o,errors:[n.body.message]}:Object(a.isError)(n)?{id:e,title:t,color:r,iconType:o,errors:[n.message]}:{id:e,title:t,color:r,iconType:o,errors:["Network Error"]},i({type:"addToaster",toast:s})},E={toasts:[]},k=Object(o.createContext)([E,()=>a.noop]),C=()=>Object(o.useContext)(k),T=({children:e})=>i.a.createElement(k.Provider,{value:Object(o.useReducer)(((e,t)=>{switch(t.type){case"addToaster":return{...e,toasts:[...e.toasts,t.toast]};case"deleteToaster":return{...e,toasts:e.toasts.filter((e=>e.id!==t.id))};default:return e}}),E)},e),I=c.a.div.withConfig({displayName:"GlobalToasterListContainer",componentId:"sc-1nee03s-0"})(["position:absolute;right:0;bottom:0;"]),w=({toastLifeTimeMs:e=5e3})=>{const[{toasts:t},n]=C(),[a,s]=Object(o.useState)(!1),[c,l]=Object(o.useState)(null),u=e=>{a?(n({type:"deleteToaster",id:e.id}),l(null)):l(e),s(!a)};return i.a.createElement(i.a.Fragment,null,t.length>0&&!a&&i.a.createElement(I,null,i.a.createElement(r.EuiGlobalToastList,{toasts:[$(t[0],u)],dismissToast:({id:e})=>{n({type:"deleteToaster",id:e})},toastLifeTimeMs:e})),null!=c&&i.a.createElement(f,{isShowing:a,toast:c,toggle:u}))},$=(e,t)=>(null!=e&&null!=e.errors&&e.errors.length>0&&(e.text=i.a.createElement(x,null,i.a.createElement(r.EuiButton,{"data-test-subj":"toaster-show-all-error-modal",size:"s",color:"danger",onClick:()=>null!=e&&t(e)},u))),e),x=c.a.div.withConfig({displayName:"ErrorToastContainer",componentId:"sc-1nee03s-1"})(["text-align:right;"]);x.displayName="ErrorToastContainer"},1267:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var r=n(2),a=n(43);const o=Object(r.createContext)(null),i=({core:e,children:t})=>Object(a.jsx)(o.Provider,{value:e},t),s=()=>{const e=Object(r.useContext)(o);if(!e)throw new Error("Kibana services not found in navigation context");return e}},128:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"s",(function(){return s})),n.d(t,"u",(function(){return c})),n.d(t,"r",(function(){return l})),n.d(t,"t",(function(){return u})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return j})),n.d(t,"l",(function(){return O})),n.d(t,"k",(function(){return h})),n.d(t,"q",(function(){return v})),n.d(t,"p",(function(){return E})),n.d(t,"m",(function(){return k})),n.d(t,"f",(function(){return C})),n.d(t,"o",(function(){return I})),n.d(t,"n",(function(){return w})),n.d(t,"i",(function(){return $})),n.d(t,"v",(function(){return M})),n.d(t,"w",(function(){return U})),n.d(t,"j",(function(){return _})),n.d(t,"b",(function(){return P})),n.d(t,"d",(function(){return D}));const r=20,a="draggable-keyboard-wrapper",o="is-dragging";var i=n(44);const s=e=>Object(i.has)("message",e)&&Object(i.has)("body.message",e)&&Object(i.has)("body.statusCode",e),c=e=>Object(i.has)("message",e)&&Object(i.has)("body.message",e)&&Object(i.has)("body.status_code",e),l=e=>s(e)||c(e),u=e=>s(e)&&404===e.body.statusCode||c(e)&&404===e.body.status_code,d="draggableId",m="droppableId",g=`${d}.content.`,f=`${d}.timelineProviders.`,p=`${d}.field.`,b=`${m}.content.`,y=`${m}.timelineProviders.`,j=`${m}.timelineColumns.`,O=e=>`${g}${e}`,h=({contextId:e,fieldId:t})=>`${p}${x(e)}.${S(t)}`,v=({groupIndex:e,timelineId:t})=>`${y}${t}.group.${e}`,E=({dataProviderId:e,groupIndex:t,timelineId:n})=>`${f}${n}.group.${t}.${e}`,k=e=>`${b}${e}`,C=e=>e.draggableId.startsWith(p),T=e=>"DROP"===e.reason,I=e=>e.draggableId.substring(e.draggableId.lastIndexOf(".")+1),w=e=>A(e.draggableId.substring(e.draggableId.lastIndexOf(".")+1)),$=e=>e.replace(/\./g,"_"),x=e=>e.replace(/\./g,"_"),S=e=>e.replace(/\./g,"!!!DOT!!!"),A=e=>e.replace(/!!!DOT!!!/g,"."),M=e=>T(e)&&(e=>e.draggableId.startsWith(g))(e)&&(e=>e.source.droppableId.startsWith(b))(e)&&(e=>null!=e.destination&&e.destination.droppableId.startsWith(y))(e),U=e=>T(e)&&(e=>{const t=/^droppableId\.timelineProviders\.(\S+)\./,n=e.source.droppableId.match(t)||[],r=e.destination&&e.destination.droppableId.match(t)||[];return n.length>=2&&r.length>=2&&n[1]===r[1]})(e),_=e=>T(e)&&C(e)&&(e=>null!=e.destination&&e.destination.droppableId.startsWith(j))(e),P="drag-type-field",D="is-timeline-field-dragging"},242:function(e,t,n){"use strict";n.d(t,"c",(function(){return a}));var r=n(56);n.d(t,"a",(function(){return r.KibanaContextProvider})),n.d(t,"d",(function(){return r.useUiSetting})),n.d(t,"e",(function(){return r.useUiSetting$})),n.d(t,"b",(function(){return r.useDarkMode}));const a=()=>Object(r.useKibana)()},364:function(e,t,n){"use strict";n.d(t,"e",(function(){return g})),n.d(t,"i",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"j",(function(){return b})),n.d(t,"f",(function(){return y})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return E}));var r=n(73),a=n.n(r),o=n(2),i=n(4),s=n(7),c=n(105),l=n(886);n.d(t,"g",(function(){return l.c})),n.d(t,"h",(function(){return l.d}));var u=n(5),d=n(1202),m=n(242);const g=()=>Object(m.d)(u.K),f=()=>{const e=Object(m.d)(u.L);return"Browser"===e?a.a.tz.guess():e},p=()=>Object(m.c)().services.http.basePath.get(),b=()=>Object(m.c)().services.notifications.toasts,y=()=>Object(m.c)().services.http,j=e=>e.reduce(((e,t)=>Object(s.isArray)(t)?[...e,j(t)]:Object(s.isObject)(t)?[...e,O(t)]:[...e,t]),[]),O=e=>Object.entries(e).reduce(((e,[t,n])=>(Object(s.isArray)(n)?Object(c.set)(e,Object(s.camelCase)(t),j(n)):Object(s.isObject)(n)?Object(c.set)(e,Object(s.camelCase)(t),O(n)):Object(c.set)(e,Object(s.camelCase)(t),n),e)),{}),h=()=>{const e=Object(o.useRef)(!1),[t,n]=Object(o.useState)(null),[,r]=Object(d.f)(),{security:a}=Object(m.c)().services,s=Object(o.useCallback)((()=>{let t=!1;return(async()=>{try{if(null!=a){const r=await a.authc.getCurrentUser();if(!e.current)return;t||n(O(r))}else n({username:i.i18n.translate("xpack.securitySolution.getCurrentUser.unknownUser",{defaultMessage:"Unknown"}),email:"",fullName:"",roles:[],enabled:!1,authenticationRealm:{name:"",type:""},lookupRealm:{name:"",type:""},authenticationProvider:""})}catch(e){t||(Object(d.e)({title:i.i18n.translate("xpack.securitySolution.getCurrentUser.Error",{defaultMessage:"Error getting user"}),error:e.body&&e.body.message?new Error(e.body.message):e,dispatchToaster:r}),n(null))}})(),()=>{t=!0}}),[a]);return Object(o.useEffect)((()=>(e.current=!0,s(),()=>{e.current=!1})),[]),t},v=l.b,E=e=>{const{capabilities:t}=Object(m.c)().services.application;return e?t[e]:t}},454:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return b}));var r=n(119),a=n.n(r),o=n(2),i=n.n(o),s=n(19),c=n(886),l=n(43);const u=()=>{const{getAppUrl:e}=Object(c.b)();return Object(o.useCallback)((({id:t,path:n="",absolute:r=!1,urlState:a})=>{const{appId:o,deepLinkId:i,path:s=""}=b(t),c=y(s,n),l=a?j(c,a):c;return e({deepLinkId:i,appId:o,path:l,absolute:r})}),[e])},d=()=>{const e=u(),{navigateTo:t}=Object(c.c)();return Object(o.useCallback)((({id:n,path:r,urlState:a,onClick:o,overrideNavigation:i=!0})=>{const s=e({id:n,path:r,urlState:a});return{href:s,onClick:e=>{O(e)||(o&&o(e),i&&(e.preventDefault(),t({url:s})))}}}),[e,t])},m=e=>i.a.memo((function({id:t,path:n,urlState:r,onClick:o,...i}){const s=d(),{onClick:c,href:u}=s({id:t,path:n,urlState:r,onClick:o,..."_blank"===i.target&&{overrideNavigation:!1}});return Object(l.jsx)(e,a()({onClick:c,href:u},i))})),g=m(s.EuiButton),f=m(s.EuiLink),p=e=>!e.includes(":"),b=e=>{const[t,n]=e.split(/\/(.*)/),r=n?`/${n}`:"";if(!p(t)){const[e,n]=t.split(":");return{appId:e,deepLinkId:n,path:r}}return{deepLinkId:t,path:r}},y=(e,t)=>e&&t?`${e.replace(/\/$/,"")}/${t.replace(/^\//,"")}`:e||t||"",j=(e,t)=>{const n=t.replace("?",""),[r,a]=e.split("?");let o="";return n&&a?o=`?${a}&${n}`:a?o=`?${a}`:n&&(o=`?${n}`),`${r}${o}`},O=e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey},886:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(2),a=n(977),o=n(1267),i=n(454);const s=()=>{const{getUrlForApp:e}=Object(o.b)().application;return{getAppUrl:Object(r.useCallback)((({appId:t=a.c,...n})=>e(t,n)),[e])}},c=()=>{const{navigateToApp:e,navigateToUrl:t}=Object(o.b)().application;return{navigateTo:Object(r.useCallback)((({url:n,appId:r=a.c,restoreScroll:o,...i})=>{o&&l(),n?t(n):e(r,i)}),[e,t])}},l=()=>{const e=window.scrollY;window.addEventListener("scroll",(()=>window.scrollTo(0,e)),{once:!0})},u=()=>{const{navigateTo:e}=c(),{getAppUrl:t}=s();return{navigateTo:e,getAppUrl:t}},d=e=>{const{appId:t=a.c,...n}=Object(i.c)(e);return{appId:t,...n}}},977:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),n(81);const r="securitySolutionUI";let a=function(e){return e.title="title",e.collapsibleTitle="collapsibleTitle",e.accordion="accordion",e.separator="separator",e}({}),o=function(e){return e.discover="discover:",e.osquery="osquery:",e.maps="maps:",e.visualize="visualize:",e.mlOverview="ml:overview",e.mlNotifications="ml:notifications",e.mlMemoryUsage="ml:memoryUsage",e.mlAnomalyDetection="ml:anomalyDetection",e.mlAnomalyExplorer="ml:anomalyExplorer",e.mlSingleMetricViewer="ml:singleMetricViewer",e.mlSettings="ml:settings",e.mlDataFrameAnalytics="ml:dataFrameAnalytics",e.mlResultExplorer="ml:resultExplorer",e.mlAnalyticsMap="ml:analyticsMap",e.mlNodesOverview="ml:nodesOverview",e.mlNodes="ml:nodes",e.mlFileUpload="ml:fileUpload",e.mlIndexDataVisualizer="ml:indexDataVisualizer",e.mlDataDrift="ml:dataDrift",e.mlExplainLogRateSpikes="ml:logRateAnalysis",e.mlLogPatternAnalysis="ml:logPatternAnalysis",e.mlChangePointDetections="ml:changePointDetections",e.devTools="dev_tools:",e.fleet="fleet:",e.fleetAgents="fleet:agents",e.fleetPolicies="fleet:policies",e.fleetEnrollmentTokens="fleet:enrollment_tokens",e.fleetUninstallTokens="fleet:uninstall_tokens",e.fleetDataStreams="fleet:data_streams",e.fleetSettings="fleet:settings",e.integrationsSecurity="integrations:/browse/security",e.management="management:",e.managementIngestPipelines="management:ingest_pipelines",e.managementPipelines="management:pipelines",e.managementIndexManagement="management:index_management",e.managementTransforms="management:transform",e.managementMaintenanceWindows="management:maintenanceWindows",e.managementTriggersActions="management:triggersActions",e.managementCases="management:cases",e.managementTriggersActionsConnectors="management:triggersActionsConnectors",e.managementReporting="management:reporting",e.managementJobsListLink="management:jobsListLink",e.managementDataViews="management:dataViews",e.managementObjects="management:objects",e.managementApiKeys="management:api_keys",e.managementTags="management:tags",e.managementFiles="management:filesManagement",e.managementSpaces="management:spaces",e.managementSettings="management:settings",e.cloudUsersAndRoles="cloud:usersAndRoles",e.cloudBilling="cloud:billing",e.cloudPerformance="cloud:performance",e}({})}}]);