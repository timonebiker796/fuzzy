/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[29],{1084:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(762);n(119),n(2),n(652),n(43),n(323),n(324),n(653);var i=a.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){i[e]=i(e)})),t.default=i},1087:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},1088:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1089);case"v8light":return n(1091)}},1089:function(e,t,n){var a=n(185),i=n(1090);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},1090:function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#2e2d25}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #343741}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#343741}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},1091:function(e,t,n){var a=n(185),i=n(1092);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},1092:function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#fff9e8}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #d3dae6}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#e9edf3}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},1093:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(233);function i(e,t,n,i,l,r,o){const s=null!=r?r:"html",u={hit:t,field:l,...o};return i&&l?i.getFormatterForField(l).convert(e,s,u):n.getDefaultInstance(a.b.STRING).convert(e,s,u)}},1094:function(e,t,n){var a=n(185),i=n(1095);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},1095:function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},1096:function(e,t,n){var a=n(185),i=n(1097);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},1097:function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},1216:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),l=n(910),r=n(819),o=n(582),s=n(870);const u=()=>{const e=Object(s.e)(),t=Object(i.useHistory)(),{urlKey:n}=Object(r.b)(),u=n||l.a,c=Object(a.useCallback)((({right:t,left:n,preview:a})=>e(Object(o.f)({right:t,left:n,preview:a,id:u}))),[e,u]),d=Object(a.useCallback)((t=>e(Object(o.h)({right:t,id:u}))),[e,u]),m=Object(a.useCallback)((t=>e(Object(o.e)({left:t,id:u}))),[e,u]),p=Object(a.useCallback)((t=>e(Object(o.g)({preview:t,id:u}))),[e,u]),b=Object(a.useCallback)((()=>e(Object(o.d)({id:u}))),[e,u]),f=Object(a.useCallback)((()=>e(Object(o.a)({id:u}))),[e,u]),g=Object(a.useCallback)((()=>e(Object(o.c)({id:u}))),[e,u]),y=Object(a.useCallback)((()=>{u===l.a?e(Object(o.i)({id:u})):t.goBack()}),[e,u,t]),v=Object(a.useCallback)((()=>e(Object(o.b)({id:u}))),[e,u]);return Object(a.useMemo)((()=>({openFlyout:c,openRightPanel:d,openLeftPanel:m,openPreviewPanel:p,closeRightPanel:b,closeLeftPanel:f,closePreviewPanel:g,closeFlyout:v,previousPreviewPanel:y})),[c,d,m,p,b,f,g,v,y])}},1256:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),i=n(1371);const l=a.exact(a.type({comment:i.a})),r=a.array(l),o=(a.union([r,a[void 0]]),new a.Type("DefaultCreateComments",a.array(l).is,(e=>null==e?a.success([]):a.array(l).decode(e)),a.identity))},126:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>Object(a.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},130:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return b})),n.d(t,"f",(function(){return f}));var a=n(44),i=n(2),l=n.n(i),r=n(41),o=n.n(r);const s=n(4).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),u=o.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorDarkShade));u.displayName="EmptyWrapper";const c=()=>"â€”",d=()=>`(${s})`,m=()=>l.a.createElement(u,null,c()),p=()=>l.a.createElement(u,null,d()),b=e=>null==e?m():Object(a.isString)(e)&&""===e?p():l.a.createElement(l.a.Fragment,null,e),f=e=>null==e?m():""===e?p():l.a.createElement(l.a.Fragment,null,e)},1339:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);const i=e=>e.groups.some((e=>a.Zb.includes(e)))},134:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v}));var a=n(19),i=n(2),l=n.n(i),r=n(41),o=n.n(r),s=n(363),u=n(222),c=n(130),d=n(179),m=n(416);const p=({field:e,tooltipContent:t})=>null!=t?t:e,b=l.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:i,value:r})=>(e=>null===e)(n)?l.a.createElement(l.a.Fragment,null,e||r):l.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:p({tooltipContent:n,field:t})},l.a.createElement(l.a.Fragment,null,e||r))));b.displayName="Content";const f=l.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:r="",isAggregatable:o=!1,value:c,name:p,children:f,scopeId:g,tooltipContent:y,tooltipPosition:v,queryValue:h,truncate:E})=>{const j=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(u.h)(t),name:p||(null!==(e=null==c?void 0:c.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:h||(null!=c?c:""),operator:d.d}}}),[a,t,p,h,c]),T=Object(i.useCallback)(((e,t,n)=>n.isDragging?l.a.createElement(s.a,null,l.a.createElement(m.a,{dataProvider:e})):l.a.createElement(b,{field:a,tooltipContent:y,tooltipPosition:v,value:c},f)),[f,a,y,v,c]);return null==c?null:l.a.createElement(s.b,{dataProvider:j,fieldType:r,isAggregatable:o,hideTopN:e,isDraggable:n,render:T,scopeId:g,truncate:E})}));f.displayName="DefaultDraggable";const g=o()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);g.displayName="Badge";const y=({contextId:e,eventId:t,field:n,value:a,iconType:i,isDraggable:r,isAggregatable:o,fieldType:s,name:u,color:d="hollow",children:m,scopeId:p,tooltipContent:b,queryValue:y})=>null!=a?l.a.createElement(f,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:r,isAggregatable:o,fieldType:s,field:n,name:u,value:a,scopeId:p,tooltipContent:b,queryValue:y},l.a.createElement(g,{iconType:i,color:d,title:""},m||(""!==a?a:Object(c.c)()))):null;y.displayName="DraggableBadgeComponent";const v=l.a.memo(y);v.displayName="DraggableBadge"},1341:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return p}));var a=n(748),i=n(813);a.s;const l=`${a.k}.building_block_type`,r=`${a.k}.evaluation.threshold`,o=`${a.k}.evaluation.value`,s=`${a.k}.context`,u=`${a.k}.evaluation.values`,c=`${a.k}.group`,d=`${c}.field`,m=`${c}.value`,p=`${a.s}.exceptions_list`;a.s,a.I,a.k,a.s,i.D,i.F,i.E,i.G,a.K,a.a,a.d,a.e,a.f,a.j,a.h,a.o,a.u,a.m,i.a,a.b,i.b,i.c,i.d,i.e,i.f,a.q,i.g,i.h,i.i,a.r,i.j,a.t,i.k,i.l,i.m,a.w,i.n,i.o,a.x,i.p,i.q,i.r,a.A,a.C,i.s,a.B,i.z,a.E,a.F,i.A,a.G,a.H,i.C,a.y,a.n,i.x,i.v,i.y,i.w,i.u,i.t,a.J,a.L},1342:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l}));var a=n(50);const i=e=>null!=e.id?e:{...e,id:Object(a.v4)()},l=e=>{const t=e;if(null!=t.id){const{id:e,...n}=t;return n}return e}},1367:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(47),i=(n(2),n(118));const l=["POST","/api/ml/jobs/jobs_summary"],r=(e,t)=>Object(a.useQuery)([l,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>i.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},1379:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(233);const i=new Set([a.b.STRING,a.b.BOOLEAN,a.b.NUMBER,a.b.IP]),l=e=>!!e&&i.has(e)},140:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(739);const l=()=>Object(a.useContext)(i.a)},144:function(e,t,n){"use strict";n.d(t,"g",(function(){return j.d})),n.d(t,"f",(function(){return j.c})),n.d(t,"o",(function(){return k})),n.d(t,"m",(function(){return I})),n.d(t,"d",(function(){return _})),n.d(t,"h",(function(){return R})),n.d(t,"a",(function(){return z})),n.d(t,"c",(function(){return P})),n.d(t,"i",(function(){return L})),n.d(t,"e",(function(){return B})),n.d(t,"b",(function(){return q})),n.d(t,"j",(function(){return H})),n.d(t,"n",(function(){return Q})),n.d(t,"l",(function(){return W})),n.d(t,"k",(function(){return J}));var a=n(19),i=n(2),l=n.n(i),r=n(44),o=n(305),s=n(170),u=n(256),c=n(5),d=n(433),m=n(194),p=n(409),b=n(118),f=n(356),g=n(4),y=n(378);const v=e=>g.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var h=n(156),E=n(560),j=n(312),T=n(119),O=n.n(T),x=n(454),S=n(529);const k=()=>{const e=Object(x.e)(),t=Object(S.a)();return Object(i.useCallback)((({deepLinkId:n,path:a,onClick:i})=>{const l=t(n);return e({id:n,path:a,urlState:l,onClick:i})}),[e,t])},C=e=>(e=>l.a.memo((function({deepLinkId:t,...n}){const a=Object(S.a)()(t);return l.a.createElement(e,O()({id:t,urlState:a},n))})))(Object(x.g)(e)),w=({children:e,Component:t,userName:n,isButton:a,onClick:r,title:o,userTab:s})=>{const u=encodeURIComponent(n),{formatUrl:d,search:p}=Object(m.l)(h.a.users),{application:{navigateToApp:f},telemetry:g}=Object(b.j)().services,y=Object(i.useCallback)((e=>{e.preventDefault(),f(c.m,{deepLinkId:h.a.users,path:s?Object(E.a)(u,s,p):Object(E.c)(u,p)})}),[u,f,p,s]),v=Object(i.useMemo)((()=>d(s?Object(E.a)(u,s):Object(E.c)(u))),[d,u,s]),T=Object(i.useCallback)((e=>{g.reportEntityDetailsClicked({entity:"user"}),(null!=r?r:y)(e)}),[y,r,g]);return a?l.a.createElement(j.b,{Component:t,dataTestSubj:"data-grid-user-details",href:v,onClick:T,title:null!=o?o:n},e||n):l.a.createElement(j.c,{"data-test-subj":"users-link-anchor",onClick:T,href:v},e||n)},I=l.a.memo(w),M=({children:e,Component:t,hostName:n,isButton:a,onClick:r,title:o,hostTab:s})=>{const{formatUrl:u,search:d}=Object(m.l)(h.a.hosts),{application:{navigateToApp:p},telemetry:f}=Object(b.j)().services,g=encodeURIComponent(n),y=Object(i.useCallback)((e=>{e.preventDefault(),p(c.m,{deepLinkId:h.a.hosts,path:s?Object(m.i)(g,s,d):Object(m.d)(g,d)})}),[g,p,d,s]),v=Object(i.useMemo)((()=>u(s?Object(m.i)(g,s):Object(m.d)(g))),[u,g,s]),E=Object(i.useCallback)((e=>{f.reportEntityDetailsClicked({entity:"host"}),(null!=r?r:y)(e)}),[y,r,f]);return a?l.a.createElement(j.b,{Component:t,dataTestSubj:"data-grid-host-details",href:v,iconType:"expand",onClick:E,title:null!=o?o:n},e):l.a.createElement(j.c,{onClick:E,href:v,"data-test-subj":"host-details-button"},e||n)},_=l.a.memo(M),N=["http://","https://"],D=l.a.memo((({url:e,children:t,idx:n,overflowIndexStart:i=5,allItemsLimit:o=5})=>{const s=i-1,u=o-1,c=Math.max(0,Math.min(s,u)),d=N.some((t=>0===e.indexOf(t)));return e&&d&&!Object(f.c)(e)&&t?l.a.createElement(a.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},l.a.createElement(l.a.Fragment,null,l.a.createElement(a.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(r.isNil)(n)&&n<c&&l.a.createElement(j.a,{"data-test-subj":"externalLinkComma"}))):null}));D.displayName="ExternalLink";const A=({Component:e,children:t,ip:n,flowTarget:a=p.a.source,isButton:o,onClick:s,title:u})=>{const c=k(),b=Object(i.useCallback)(((n,i)=>{const{onClick:r,href:p}=c({deepLinkId:h.a.network,path:Object(m.f)(encodeURIComponent(Object(d.c)(n)),a)}),b=null!=s?s:e=>r(e);return o?l.a.createElement(j.b,{Component:e,key:`${n}-${i}`,dataTestSubj:"data-grid-network-details",onClick:b,href:p,title:null!=u?u:n},t):l.a.createElement(j.c,{key:`${n}-${i}`,onClick:b,href:p,"data-test-subj":"network-details"},t||n)}),[t,e,a,c,s,o,u]);return Object(r.isArray)(n)?l.a.createElement(l.a.Fragment,null,n.map(b)):b(n,0)},R=l.a.memo(A),F=({index:e,children:t,detailName:n,title:a})=>{const{formatUrl:r,search:d}=Object(m.l)(h.a.case),{navigateToApp:p}=Object(b.j)().services.application,{activeStep:f,isTourShown:g}=Object(u.b)(),y=Object(i.useMemo)((()=>f===s.a.viewCase&&g(s.b.alertsCases)&&0===e),[f,e,g]),E=Object(i.useCallback)((async e=>(e&&e.preventDefault(),p(c.m,{deepLinkId:h.a.case,path:Object(m.a)({id:n,search:d})}))),[n,p,d]);return Object(i.useEffect)((()=>{var e;y&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[y]),l.a.createElement(o.a,{onClick:E,isTourAnchor:y,step:s.a.viewCase,tourId:s.b.alertsCases},l.a.createElement(j.c,{onClick:E,href:r(Object(m.a)({id:n})),"data-test-subj":"case-details-link","aria-label":v(null!=a?a:n)},t||n))},z=l.a.memo(F);z.displayName="CaseDetailsLink",l.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(m.l)(h.a.case),{navigateToApp:a}=Object(b.j)().services.application,r=Object(i.useCallback)((async e=>(e.preventDefault(),a(c.m,{deepLinkId:h.a.case,path:Object(m.b)(n)}))),[a,n]);return l.a.createElement(j.c,{onClick:r,href:t(Object(m.b)())},e)})).displayName="CreateCaseLink";const P=l.a.memo((({children:e,link:t})=>{const n=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return l.a.createElement(D,{url:n},e||t)}));P.displayName="GoogleLink";const L=l.a.memo((({Component:e,title:t,children:n,portOrServiceName:r})=>{var o;const s=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(r))}`),[r]);return e?l.a.createElement(e,{href:s,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(o=null!=t?t:n)&&void 0!==o?o:r):l.a.createElement(j.e,null,l.a.createElement(a.EuiLink,{"data-test-subj":"port-or-service-name-link",href:s,target:"_blank"},n||r))}));L.displayName="PortOrServiceNameLink";const B=l.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return l.a.createElement(a.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));B.displayName="Ja3FingerprintLink";const q=l.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return l.a.createElement(a.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));q.displayName="CertificateFingerprintLink";var $=function(e){return e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com",e}($||{});function V(e){return e===$["virustotal.com"]||e===$["talosIntelligence.com"]}const G={[$["virustotal.com"]]:y.m,[$["talosIntelligence.com"]]:y.l},U=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:o,direction:s="row"})=>{const[u]=Object(b.o)(c.Pb),d=Object(i.useMemo)((()=>null==u?void 0:u.slice(0,t).filter((({url_template:e,name:t})=>!Object(r.isNil)(e)&&!Object(r.isNil)(t)&&!Object(f.c)(e))).map((({name:e,url_template:t})=>({name:V(e)?G[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(o))})))),[u,o,G,t]),m=Object(i.useCallback)((n=>{var a;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&l.a.createElement(D,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},l.a.createElement(l.a.Fragment,null,null!==(a=n.name)&&void 0!==a?a:o))}),[t,o,e]);return(null==d?void 0:d.length)>0?l.a.createElement("section",null,l.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:s,alignItems:"center","data-test-subj":"reputationLinkGroup"},l.a.createElement(a.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:a},i)=>l.a.createElement(D,{allItemsLimit:d.length,idx:i,overflowIndexStart:e,url:a,"data-test-subj":"externalLinkComponent",key:`reputationLink-${i}`},l.a.createElement(l.a.Fragment,null,n?o:null!=t?t:o))))),l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(j.f,{rowItems:d,render:m,moreMaxHeight:"200px",overflowIndexStart:e})))):null};U.displayName="ReputationLinkComponent";const H=l.a.memo(U),Q=l.a.memo((({children:e,domain:t})=>{const n=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return l.a.createElement(D,{url:n},e||t)}));Q.displayName="WhoIsLink";const W=C(j.d),J=C(j.c)},1447:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(46),i=n(1448),l=n(399),r=n(752),o=n(400),s=n(574),u=n(1256),c=n(275),d=n(891),m=n(506),p=n(507),b=n(1284);const f=a.intersection([a.exact(a.type({description:l.a,entries:r.a,name:o.a,type:s.a})),a.exact(a.partial({comments:u.a,item_id:i.a,list_id:a[void 0],meta:c.a,namespace_type:d.b,os_types:m.c,tags:p.a,expire_time:b.a}))])},1448:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46),i=n(50),l=n(1371);const r=new a.Type("DefaultUuid",a.string.is,((e,t)=>null==e?a.success(Object(i.v4)()):l.a.validate(e,t)),a.identity)},1449:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);function i(e){return a.preprocess((e=>"string"==typeof e?""===e?[]:e.split(","):e),a.array(e))}},145:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return s}));const a="document-details-right",i="document-details-left",l="document-details-preview",r="document-details-isolate-host",o="document-details-alert-reason",s="document-details-rule-overview"},1451:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n.n(a),l=n(43);const r=()=>Object(l.jsx)(a.Fragment,null),o=i.a.lazy((()=>n.e(56).then(n.bind(null,1413)))),s=function(e){return Object(l.jsx)(i.a.Suspense,{fallback:Object(l.jsx)(r,null)},Object(l.jsx)(o,e))}},1484:function(e,t,n){"use strict";n.d(t,"a",(function(){return xe})),n.d(t,"b",(function(){return we}));var a=n(2),i=n.n(a),l=n(52),r=n.n(l),o=n(42),s=n(3),u=n(8),c=n.n(u),d=(n(1088),n(19)),m=n(360),p=n(53);var b=n(480),f=n(55),g=n(1093);const y=(e,t)=>t?JSON.stringify(e):JSON.stringify(e,null,2),v=Object(f.createEscapeValue)({separator:",",quoteValues:!0,escapeFormulaValues:!0}),h=e=>v(e);var E=n(7),j=n(225),T=n(860),O=n(4),x=n(79),S=n(301),k=n(43);const C=({children:e})=>Object(k.jsx)("span",{className:"unifiedDataTable__rowControl"},e),w=O.i18n.translate("unifiedDataTable.copyEscapedValueWithFormulasToClipboardWarningText",{defaultMessage:"Values may contain formulas that are escaped."}),I=O.i18n.translate("unifiedDataTable.copyFailedErrorText",{defaultMessage:"Unable to copy to clipboard in this browser"}),M=({rowIndex:e,columnId:t,toastNotifications:n,valueToStringConverter:a})=>{const i=a(e,t),l=i.formattedString;if(!Object(d.copyToClipboard)(l))return n.addWarning({title:I}),null;const r=O.i18n.translate("unifiedDataTable.copyValueToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return i.withFormula?n.addWarning({title:r,text:w}):n.addInfo({title:r}),l},_=async({columnId:e,columnDisplayName:t,toastNotifications:n,valueToStringConverter:a,rowsCount:i})=>{const l={formattedString:h(r=t),withFormula:Object(f.cellHasFormulas)(r)};var r;let o=l.withFormula;const s=[...Array(i)].map(((t,n)=>{const i=a(n,e,{compatibleWithCSV:!0});return o=o||i.withFormula,i.formattedString})),u=`${l.formattedString}\n${s.join("\n")}`;let c;try{var m,p;await(null===(m=window.navigator)||void 0===m||null===(p=m.clipboard)||void 0===p?void 0:p.writeText(u)),c=!0}catch(e){c=Object(d.copyToClipboard)(u)}if(!c)return n.addWarning({title:I}),null;const b=O.i18n.translate("unifiedDataTable.copyColumnValuesToClipboard.toastTitle",{defaultMessage:'Values of "{column}" column copied to clipboard',values:{column:t}});return o?n.addWarning({title:b,text:w}):n.addInfo({title:b}),u},N=({columnDisplayName:e,toastNotifications:t})=>{if(!Object(d.copyToClipboard)(e))return t.addWarning({title:I}),null;const n=O.i18n.translate("unifiedDataTable.copyColumnNameToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return t.addInfo({title:n}),e};function D(e,t,n,a,i){const l=e.rows[t].flattened[n];i&&e.onFilter&&e.onFilter(i,l,a)}const A=({Component:e,rowIndex:t,columnId:n},i)=>{const l=Object(a.useContext)(S.a),r=O.i18n.translate("unifiedDataTable.grid.filterForAria",{defaultMessage:"Filter for this {value}",values:{value:n}});return Object(k.jsx)(e,{onClick:()=>{D(l,t,n,"+",i)},iconType:"plusInCircle","aria-label":r,title:r,"data-test-subj":"filterForButton"},O.i18n.translate("unifiedDataTable.grid.filterFor",{defaultMessage:"Filter for"}))},R=({Component:e,rowIndex:t,columnId:n},i)=>{const l=Object(a.useContext)(S.a),r=O.i18n.translate("unifiedDataTable.grid.filterOutAria",{defaultMessage:"Filter out this {value}",values:{value:n}});return Object(k.jsx)(e,{onClick:()=>{D(l,t,n,"-",i)},iconType:"minusInCircle","aria-label":r,title:r,"data-test-subj":"filterOutButton"},O.i18n.translate("unifiedDataTable.grid.filterOut",{defaultMessage:"Filter out"}))};var F=n(233);function z(e){switch(e){case F.b.IP:case F.b.GEO_SHAPE:case F.b.NUMBER:return"numeric";case F.b.BOOLEAN:return"boolean";case F.b.STRING:return"string";case F.b.DATE:return"datetime";default:return j.i}}function P({isPlainRecord:e,isFilterActive:t,rows:n,selectedDocs:i,setIsFilterActive:l,setSelectedDocs:r}){const[s,u]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>[t?Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowAllDocuments",key:"showAllDocuments",icon:"eye",onClick:()=>{u(!1),l(!1)}},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showAllResults",defaultMessage:"Show all results"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showAllDocuments",defaultMessage:"Show all documents"})):Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowSelectedDocuments",key:"showSelectedDocuments",icon:"eye",onClick:()=>{u(!1),l(!0)}},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showSelectedResultsOnly",defaultMessage:"Show selected results only"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.showSelectedDocumentsOnly",defaultMessage:"Show selected documents only"})),Object(k.jsx)(d.EuiCopy,{key:"copyJsonWrapper","data-test-subj":"dscGridCopySelectedDocumentsJSON",textToCopy:n?JSON.stringify(n.filter((e=>i.includes(e.id))).map((e=>e.raw))):""},(t=>Object(k.jsx)(d.EuiContextMenuItem,{key:"copyJSON",icon:"copyClipboard",onClick:t},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.copyResultsToClipboardJSON",defaultMessage:"Copy results to clipboard (JSON)"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.copyToClipboardJSON",defaultMessage:"Copy documents to clipboard (JSON)"})))),Object(k.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridClearSelectedDocuments",key:"clearSelection",icon:"cross",onClick:()=>{u(!1),r([]),l(!1)}},Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.clearSelection",defaultMessage:"Clear selection"}))]),[t,e,n,i,l,r]),m=Object(a.useCallback)((()=>u((e=>!e))),[]);return Object(k.jsx)(d.EuiPopover,{closePopover:()=>u(!1),isOpen:s,panelPaddingSize:"none",button:Object(k.jsx)(d.EuiDataGridToolbarControl,{iconType:"documents",onClick:m,"data-selected-documents":i.length,"data-test-subj":"unifiedDataTableSelectionBtn",isSelected:t,badgeContent:i.length},e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.selectedResultsButtonLabel",defaultMessage:"Selected",description:"Selected results"}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.selectedRowsButtonLabel",defaultMessage:"Selected",description:"Selected documents"}))},s&&Object(k.jsx)(d.EuiContextMenuPanel,{items:c(),"data-test-subj":"unifiedDataTableSelectionMenu"}))}const L=({selectedDocs:e,setIsCompareActive:t})=>Object(k.jsx)(d.EuiDataGridToolbarControl,{iconType:"diff",badgeContent:e.length,"data-test-subj":"unifiedDataTableCompareSelectedDocuments",onClick:()=>{t(!0)}},Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.compareSelectedRowsButtonLabel",defaultMessage:"Compare"}));function B({label:e,onCopy:t,dataTestSubj:n}){return{size:"xs",label:e,iconType:"copyClipboard",iconProps:{size:"m"},onClick:t,"data-test-subj":n}}function q({columnDisplayName:e,toastNotifications:t}){return B({label:Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnNameToClipBoardButton",defaultMessage:"Copy name"}),onCopy:()=>N({columnDisplayName:e,toastNotifications:t}),dataTestSubj:"gridCopyColumnNameToClipBoardButton"})}function $({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:i}){return B({label:Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnValuesToClipBoardButton",defaultMessage:"Copy column"}),onCopy:()=>_({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:i}),dataTestSubj:"gridCopyColumnValuesToClipBoardButton"})}var V=n(119),G=n.n(V),U=n(701),H=n(1451),Q=n(655),W=n(44),J=n(49),X=({headerRowHeight:e,children:t})=>{const n=Object(k.css)("overflow-wrap:anywhere;white-space:normal;word-break:break-all;line-height:",J.euiThemeVars.euiSize,";text-align:left;.euiDataGridHeaderCell--numeric &{float:right;}","");return e?Object(k.jsx)(d.EuiTextBlockTruncate,{lines:e,css:n},t):Object(k.jsx)("div",{css:n},t)};const K=({columnDisplayName:e,showColumnTokens:t,columnName:n,columnsMeta:a,dataView:i,headerRowHeight:l})=>Object(k.jsx)(X,{headerRowHeight:l},t&&Object(k.jsx)(Y,{columnName:n,columnsMeta:a,dataView:i}),Object(k.jsx)(Z,{columnDisplayName:e})),Y=e=>{const{columnName:t,columnsMeta:n,dataView:i}=e,l=Object(a.useMemo)((()=>function({dataView:e,columnName:t,columnsMeta:n}){if(!t||"_source"===t)return null;if(n){const e=(a=n[t])&&a.type?Object(U.a)({name:"",type:a.type,esTypes:a.esType?[a.esType]:[]}):null;return e&&"unknown"!==e?Object(k.jsx)(H.a,{type:e,css:ee}):null}var a;const i=e.getFieldByName(t);return i?Object(k.jsx)(H.a,G()({},Object(Q.a)(i),{css:ee})):function(e,t){const n=new RegExp(Object(W.escapeRegExp)(e)+"(\\.|$)");return!t.fields.getByName(e)&&!!t.fields.getAll().find((e=>{var t;const a=Object(p.getDataViewFieldSubtypeNested)(e);return!!a&&n.test(null!==(t=null==a?void 0:a.nested.path)&&void 0!==t?t:"")}))}(t,e)?Object(k.jsx)(H.a,{type:"nested",css:ee}):null}({columnName:t,columnsMeta:n,dataView:i})),[t,n,i]);return l?Object(k.jsx)("span",{css:Object(k.css)({paddingRight:J.euiThemeVars.euiSizeXS},"","")},l):null},Z=({columnDisplayName:e})=>Object(k.jsx)("span",{"data-test-subj":"unifiedDataTableColumnTitle"},e),ee={verticalAlign:"bottom"};var te={name:"1flj9lk",styles:"text-align:left"};const ne=({dataView:e,dataViewField:t,headerRowHeight:n=1,columnLabel:a})=>{var i;const l=a||(null!==(i=null==t?void 0:t.customLabel)&&void 0!==i?i:e.timeFieldName),r=O.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltipAriaLabel",{defaultMessage:"{timeFieldName} - this field represents the time that events occurred.",values:{timeFieldName:l}}),o=O.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltip",{defaultMessage:"This field represents the time that events occurred."});return Object(k.jsx)("div",{"aria-label":r,css:te},Object(k.jsx)(X,{headerRowHeight:n},l," ",Object(k.jsx)(d.EuiIconTip,{type:"clock",content:o})))},ae=i.a.memo(K),ie=i.a.memo(ne),le="openDetails",re="select",oe={id:le,width:26,headerCellRender:()=>Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("span",null,O.i18n.translate("unifiedDataTable.controlColumnHeader",{defaultMessage:"Control column"}))),rowCellRender:({rowIndex:e,setCellProps:t})=>{const n=Object(a.useRef)(null),[i,l]=Object(a.useState)(!1),{expanded:r,setExpanded:o,rows:s,isDarkMode:u,componentsTourSteps:c}=Object(a.useContext)(S.a),m=s[e],p=c?c.expandButton:void 0;Object(a.useEffect)((()=>{m.isAnchor?t({className:"unifiedDataTable__cell--highlight"}):r&&m&&r.id===m.id?t({className:"unifiedDataTable__cell--expanded"}):t({style:void 0})}),[r,m,t,u]);const b=m===r,f=O.i18n.translate("unifiedDataTable.grid.viewDoc",{defaultMessage:"Toggle dialog with details"}),g=m.isAnchor?"docTableExpandToggleColumnAnchor":"docTableExpandToggleColumn";return Object(a.useEffect)((()=>{!b&&i&&(l(!1),setTimeout((()=>{var e;null===(e=n.current)||void 0===e||e.hideToolTip()}),100))}),[b,l,i]),o?Object(k.jsx)(C,null,Object(k.jsx)(d.EuiToolTip,{content:f,delay:"long",ref:n},Object(k.jsx)(d.EuiButtonIcon,{id:0===e?p:void 0,size:"xs",iconSize:"s","aria-label":f,"data-test-subj":g,onClick:()=>{var e;const t=b?void 0:m;null===(e=n.current)||void 0===e||e.hideToolTip(),l(Boolean(t)),null==o||o(t)},color:b?"primary":"text",iconType:b?"minimize":"expand",isSelected:b}))):null}},se={id:re,width:24,rowCellRender:({rowIndex:e,setCellProps:t})=>{const{euiTheme:n}=Object(d.useEuiTheme)(),{selectedDocs:i,expanded:l,rows:r,isDarkMode:o,setSelectedDocs:s}=Object(a.useContext)(S.a),u=Object(a.useMemo)((()=>r[e]),[r,e]),c=Object(a.useMemo)((()=>i.includes(u.id)),[i,u.id]),m=O.i18n.translate("unifiedDataTable.grid.selectDoc",{defaultMessage:"Select document ''{rowNumber}''",values:{rowNumber:e+1}});return Object(a.useEffect)((()=>{l&&u&&l.id===u.id?t({className:"unifiedDataTable__cell--selected"}):t({style:void 0})}),[l,u,t,o]),Object(k.jsx)(d.EuiFlexGroup,{responsive:!1,direction:"column",justifyContent:"center",className:"unifiedDataTable__rowControl",css:Object(k.css)("padding-block:",n.size.xs,";padding-left:",n.size.xs,";","")},Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(d.EuiCheckbox,{id:u.id,"aria-label":m,checked:c,"data-test-subj":`dscGridSelectDoc-${u.id}`,onChange:()=>{if(c){const e=i.filter((e=>e!==u.id));s(e)}else s([...i,u.id])}})))},headerCellRender:()=>Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("span",null,O.i18n.translate("unifiedDataTable.selectColumnHeader",{defaultMessage:"Select column"})))};function ue({columns:e,columnsCellActions:t,rowsCount:n,settings:a,dataView:i,defaultColumns:l,isSortEnabled:r,isPlainRecord:s,services:u,hasEditDataViewPermission:c,valueToStringConverter:d,onFilter:m,editField:p,visibleCellActions:b,columnsMeta:f,showColumnTokens:g,headerRowHeightLines:y,customGridColumnsConfiguration:v}){const h=e=>{var t,n,i;return null!==(t=null==a||null===(n=a.columns)||void 0===n||null===(i=n[e])||void 0===i?void 0:i.width)&&void 0!==t?t:0},E=(e=>{if(e!==j.d.auto)return e===j.d.single?1:e})(y),T=e.length;return e.map(((e,y)=>{var S,C;return function({numberOfColumns:e,columnName:t,columnWidth:n=0,dataView:a,defaultColumns:i,isSortEnabled:l,isPlainRecord:r,toastNotifications:s,hasEditDataViewPermission:u,valueToStringConverter:c,rowsCount:d,onFilter:m,editField:p,columnCellActions:b,visibleCellActions:f,columnsMeta:g,showColumnTokens:y,headerRowHeight:v,customGridColumnsConfiguration:h,columnDisplay:E}){var T,S,C,w,I;const _=r?new x.DataViewField({name:t,type:null!==(T=null==g||null===(S=g[t])||void 0===S?void 0:S.type)&&void 0!==T?T:"unknown",esTypes:null!=g&&null!==(C=g[t])&&void 0!==C&&C.esType?[g[t].esType]:void 0,searchable:!0,aggregatable:!1}):a.getFieldByName(t),N=p&&_&&(({hasEditDataViewPermission:e,dataView:t,field:n,editField:a})=>{if("_source"===n.name)return null;const{canEdit:i}=((e,t)=>{var n;const a=Boolean(null===(n=e.getFieldByName(t.name))||void 0===n?void 0:n.runtimeField);return{canEdit:!("unknown"===t.type||"unknown_selected"===t.type)||a,canDelete:a}})(t,n),l=e()||!t.isPersisted();return i&&l?{size:"xs",label:Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.grid.editFieldButton",defaultMessage:"Edit data view field"}),iconType:"pencil",iconProps:{size:"m"},onClick:()=>{a(n.name)},"data-test-subj":"gridEditFieldButton"}:null})({hasEditDataViewPermission:u,dataView:a,field:_,editField:p}),D=((e,t,n)=>n||("_source"===e?O.i18n.translate("unifiedDataTable.grid.documentHeader",{defaultMessage:"Document"}):t||e))(t,null==_?void 0:_.displayName,E);let F;F=null!=b&&b.length?b:_?function(e,t,n,a){return[...a&&e.filterable?[({Component:t,rowIndex:n,columnId:a})=>A({Component:t,rowIndex:n,columnId:a},e),({Component:t,rowIndex:n,columnId:a})=>R({Component:t,rowIndex:n,columnId:a},e)]:[],({Component:e,rowIndex:a,columnId:i})=>function({Component:e,rowIndex:t,columnId:n},a,i){const l=O.i18n.translate("unifiedDataTable.grid.copyClipboardButtonTitle",{defaultMessage:"Copy value of {column}",values:{column:n}});return Object(k.jsx)(e,{onClick:()=>{M({rowIndex:t,columnId:n,valueToStringConverter:i,toastNotifications:a})},iconType:"copyClipboard","aria-label":l,title:l,"data-test-subj":"copyClipboardButton"},O.i18n.translate("unifiedDataTable.grid.copyCellValueButton",{defaultMessage:"Copy value"}))}({Component:e,rowIndex:a,columnId:i},t,n)]}(_,s,c,m):[];const P={id:t,schema:z(null!==(w=null==g||null===(I=g[t])||void 0===I?void 0:I.type)&&void 0!==w?w:null==_?void 0:_.type),isSortable:l&&(r&&"_source"!==t||!0===(null==_?void 0:_.sortable)),display:y||1!==v?Object(k.jsx)(ae,{dataView:a,columnName:t,columnDisplayName:D,columnsMeta:g,showColumnTokens:y,headerRowHeight:v}):void 0,displayAsText:D,actions:{showHide:!i&&t!==a.timeFieldName&&{label:O.i18n.translate("unifiedDataTable.removeColumnLabel",{defaultMessage:"Remove column"}),iconType:"cross"},showMoveLeft:!i,showMoveRight:!i,additional:[..."__source"===t?[]:[q({columnDisplayName:D,toastNotifications:s})],$({columnId:t,columnDisplayName:D,toastNotifications:s,rowsCount:d,valueToStringConverter:c}),...N?[N]:[]]},cellActions:F,visibleCellActions:f};return P.id===a.timeFieldName&&(P.display=Object(k.jsx)(ie,{dataView:a,dataViewField:_,headerRowHeight:v,columnLabel:E}),e>1&&(P.initialWidth=j.h)),n>0&&(P.initialWidth=Number(n)),h&&h[P.id]?h[P.id]({column:P,headerRowHeight:v}):P}({numberOfColumns:T,columnName:e,columnCellActions:null==t?void 0:t[y],columnWidth:h(e),dataView:i,defaultColumns:l,isSortEnabled:r,isPlainRecord:s,toastNotifications:u.toastNotifications,hasEditDataViewPermission:c,valueToStringConverter:d,rowsCount:n,onFilter:m,editField:p,visibleCellActions:b,columnsMeta:f,showColumnTokens:g,headerRowHeight:E,customGridColumnsConfiguration:v,columnDisplay:null==a||null===(S=a.columns)||void 0===S||null===(C=S[e])||void 0===C?void 0:C.display})}))}const ce=e=>{const{isLoadingMore:t,rowCount:n,sampleSize:i,pageIndex:l,pageCount:r,totalHits:s=0,onFetchMoreRecords:u,data:c}=e,m=c.query.timefilter.timefilter,[p,b]=Object(a.useState)(m.getRefreshInterval());Object(a.useEffect)((()=>{const e=m.getRefreshIntervalUpdate$().subscribe((()=>{b(m.getRefreshInterval())}));return()=>e.unsubscribe()}),[m,b]);const f=Boolean(p&&!1===p.pause&&p.value>0),{euiTheme:g}=Object(d.useEuiTheme)();return l===r-1&&n<s?u&&"boolean"==typeof t?n<=j.c-i?Object(k.jsx)(de,G()({hasButton:!0},e),Object(k.jsx)(d.EuiToolTip,{content:f?O.i18n.translate("unifiedDataTable.gridSampleSize.fetchMoreLinkDisabledTooltip",{defaultMessage:"To load more the refresh interval needs to be disabled first"}):void 0},Object(k.jsx)(d.EuiButtonEmpty,{disabled:f,isLoading:t,flush:"both","data-test-subj":"dscGridSampleSizeFetchMoreLink",onClick:u,css:Object(k.css)("margin-left:",g.size.xs,";","")},Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.fetchMoreLinkLabel",defaultMessage:"Load more"})))):Object(k.jsx)(de,G()({hasButton:!1},e)):n<s?Object(k.jsx)(de,G()({hasButton:!1},e)):null:null},de=({hasButton:e,rowCount:t,children:n,fieldFormats:a})=>{const{euiTheme:i}=Object(d.useEuiTheme)(),l=a.getDefaultInstance(F.b.NUMBER,[F.a.INTEGER]).convert(t);return Object(k.jsx)("p",{"data-test-subj":"unifiedDataTableFooter",css:Object(k.css)("display:flex;flex-direction:row;align-items:center;justify-content:center;flex-shrink:0;background-color:",i.colors.lightestShade,";padding:",e?`0 ${i.size.base}`:`${i.size.s} ${i.size.base}`,";margin-top:",i.size.xs,";text-align:center;","")},Object(k.jsx)("span",null,e?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.lastPageDescription",defaultMessage:"Search results are limited to {rowCount} documents.",values:{rowCount:l}}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.limitDescription",defaultMessage:"Search results are limited to {sampleSize} documents. Add more search terms to narrow your search.",values:{sampleSize:l}})),n)};let me=function(e){return e.auto="auto",e.single="single",e.custom="custom",e}({});const pe=Object(d.htmlIdGenerator)()();function be({label:e,rowHeight:t,rowHeightLines:n,compressed:a,onChangeRowHeight:l,onChangeRowHeightLines:r,maxRowHeight:o,"data-test-subj":s}){const u=[{id:`${pe}${me.single}`,label:O.i18n.translate("unifiedDataTable.rowHeight.single",{defaultMessage:"Single"}),"data-test-subj":`${s}_rowHeight_${me.single}`},{id:`${pe}${me.auto}`,label:O.i18n.translate("unifiedDataTable.rowHeight.auto",{defaultMessage:"Auto fit"}),"data-test-subj":`${s}_rowHeight_${me.auto}`},{id:`${pe}${me.custom}`,label:O.i18n.translate("unifiedDataTable.rowHeight.custom",{defaultMessage:"Custom"}),"data-test-subj":`${s}_rowHeight_${me.custom}`}];return Object(k.jsx)(i.a.Fragment,null,Object(k.jsx)(d.EuiFormRow,{label:e,display:"columnCompressed","data-test-subj":s},Object(k.jsx)(i.a.Fragment,null,Object(k.jsx)(d.EuiButtonGroup,{isFullWidth:!0,legend:e,buttonSize:"compressed",options:u,idSelected:`${pe}${null!=t?t:me.single}`,onChange:e=>{const t=e.replace(pe,"");l(t)},"data-test-subj":`${s}_rowHeightButtonGroup`}),t===me.custom?Object(k.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,showInput:!0,min:1,max:null!=o?o:20,step:1,value:null!=n?n:2,onChange:e=>{const t=Number(e.currentTarget.value);r(t)},"data-test-subj":`${s}_lineCountNumber`,css:Object(k.css)({marginTop:a?J.euiThemeVars.euiSizeXS:J.euiThemeVars.euiSizeM},"","")}):null)))}const fe=()=>{},ge=({rowHeight:e,rowHeightLines:t,onChangeRowHeight:n,onChangeRowHeightLines:l,headerRowHeight:r,headerRowHeightLines:o,onChangeHeaderRowHeight:s,onChangeHeaderRowHeightLines:u,maxAllowedSampleSize:c=1e3,sampleSize:m,onChangeSampleSize:p})=>{const[b,f]=Object(a.useState)(m),g=Math.max(Math.min(10,m),1),y=Object(a.useMemo)((()=>Object(E.debounce)(null!=p?p:fe,300,{leading:!1,trailing:!0})),[p]),v=Object(a.useCallback)((e=>{var t;if(!e.target.value)return void f("");const n=null!==(t=parseInt(e.target.value,10))&&void 0!==t?t:10;n>=1&&(f(n),n<=c&&y(n))}),[c,f,y]),h=O.i18n.translate("unifiedDataTable.sampleSizeSettings.sampleSizeLabel",{defaultMessage:"Sample size"});Object(a.useEffect)((()=>{f(m)}),[m,f]);const j=[];return s&&u&&j.push(Object(k.jsx)(be,{rowHeight:r,rowHeightLines:o,label:O.i18n.translate("unifiedDataTable.headerRowHeightLabel",{defaultMessage:"Header row height"}),onChangeRowHeight:s,onChangeRowHeightLines:u,"data-test-subj":"unifiedDataTableHeaderRowHeightSettings",maxRowHeight:5})),n&&l&&j.push(Object(k.jsx)(be,{rowHeight:e,rowHeightLines:t,label:O.i18n.translate("unifiedDataTable.rowHeightLabel",{defaultMessage:"Cell row height"}),onChangeRowHeight:n,onChangeRowHeightLines:l,"data-test-subj":"unifiedDataTableRowHeightSettings"})),p&&j.push(Object(k.jsx)(d.EuiFormRow,{label:h,display:"columnCompressed"},Object(k.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,min:g,max:c,step:10===g?10:1,showInput:!0,value:b,onChange:v,"data-test-subj":"unifiedDataTableSampleSizeInput"}))),Object(k.jsx)(i.a.Fragment,null,j.map(((e,t)=>Object(k.jsx)(i.a.Fragment,{key:`setting-${t}`},t>0&&Object(k.jsx)(d.EuiHorizontalRule,{margin:"s"}),e))))},ye=e=>"number"==typeof e&&!Number.isNaN(e)&&Math.floor(e)===e&&e>=-1&&e<=20,ve=(e,t)=>`${e}:${t}`,he=(e,t,n,a,i)=>{n.set(ve(a,i),{previousRowHeight:e,previousConfigRowHeight:t})},Ee=({storage:e,consumer:t,key:n,configRowHeight:i,rowHeightState:l,onUpdateRowHeight:r})=>{const o=Object(a.useMemo)((()=>{const a=((e,t,n)=>{const a=e.get(ve(t,n));return"object"==typeof a&&null!==a&&ye(a.previousRowHeight)&&ye(a.previousConfigRowHeight)?a:null})(e,t,n);let r;var o;return r=ye(l)?l:null!==(o=a)&&i===o.previousConfigRowHeight?a.previousRowHeight:i,r}),[i,t,n,l,e]),s=Object(a.useMemo)((()=>{switch(o){case j.d.auto:return me.auto;case j.d.single:return me.single;default:return me.custom}}),[o]),u=Object(a.useCallback)((a=>{let l;switch(a){case me.auto:l=j.d.auto;break;case me.single:l=j.d.single;break;default:l=i}he(l,i,e,t,n),null==r||r(l)}),[i,t,n,r,e]),c=Object(a.useCallback)((a=>{he(a,i,e,t,n),null==r||r(a)}),[i,t,n,r,e]);return{rowHeight:s,rowHeightLines:o,onChangeRowHeight:r?u:void 0,onChangeRowHeightLines:r?c:void 0}};var je=n(1494);const Te=Object(je.a)(Object(a.lazy)((()=>n.e(48).then(n.bind(null,2116))))),Oe="unifiedDataTable__fullScreen";let xe=function(e){return e.loading="loading",e.loadingMore="loadingMore",e.loaded="loaded",e}({});const Se={darkMode:!1},ke=i.a.memo(d.EuiDataGrid),Ce=["openDetails","select"],we=({ariaLabelledBy:e,columns:t,columnsMeta:n,showColumnTokens:l,configHeaderRowHeight:u,headerRowHeightState:v,onUpdateHeaderRowHeight:O,controlColumnIds:x=Ce,dataView:C,loadingState:w,onFilter:I,onResize:M,onSetColumns:_,onSort:N,rows:D,searchDescription:A,searchTitle:R,settings:F,showTimeCol:z,showFullScreenButton:B=!0,sort:q,useNewFieldsApi:$,isSortEnabled:V=!0,isPaginationEnabled:G=!0,cellActionsTriggerId:U,className:H,rowHeightState:Q,onUpdateRowHeight:W,maxAllowedSampleSize:J,sampleSizeState:X,onUpdateSampleSize:K,isPlainRecord:Y=!1,rowsPerPageState:Z,onUpdateRowsPerPage:ee,onFieldEdited:te,services:ne,renderCustomGridBody:ae,renderCustomToolbar:ie,trailingControlColumns:de,totalHits:me,onFetchMoreRecords:pe,renderDocumentView:be,setExpandedDoc:fe,expandedDoc:ye,configRowHeight:ve,showMultiFields:he=!0,maxDocFieldsDisplayed:je=50,externalControlColumns:we,externalAdditionalControls:Ie,rowsPerPageOptions:Me,visibleCellActions:_e,externalCustomRenderers:Ne,additionalFieldGroups:De,consumer:Ae="discover",componentsTourSteps:Re,gridStyleOverride:Fe,rowLineHeightOverride:ze,cellActionsMetadata:Pe,customGridColumnsConfiguration:Le,customControlColumnsConfiguration:Be,enableComparisonMode:qe,cellContext:$e,renderCellPopover:Ve})=>{var Ge,Ue,He,Qe;const{fieldFormats:We,toastNotifications:Je,dataViewFieldEditor:Xe,uiSettings:Ke,storage:Ye,data:Ze}=ne,{darkMode:et}=c()(null!==(Ge=null===(Ue=ne.theme)||void 0===Ue?void 0:Ue.theme$)&&void 0!==Ge?Ge:Object(s.of)(Se),Se),tt=Object(a.useRef)(null),[nt,at]=Object(a.useState)([]),[it,lt]=Object(a.useState)(!1),[rt,ot]=Object(a.useState)(!1),st=Object(b.a)(t,C),ut=st.includes("_source"),ct=Object(a.useMemo)((()=>{var e;return new Map(null!==(e=null==D?void 0:D.map((e=>[e.id,e])))&&void 0!==e?e:[])}),[D]),dt=Object(a.useCallback)((e=>ct.get(e)),[ct]),mt=Object(a.useMemo)((()=>{if(!nt.length||null==D||!D.length)return[];const e=nt.filter((e=>!!dt(e)));return 0===e.length&&it&&lt(!1),e}),[nt,null==D?void 0:D.length,it,dt]),pt=Object(a.useMemo)((()=>{if(!D)return[];if(!it||0===mt.length)return D;const e=D.filter((e=>mt.includes(e.id)));return e.length?e:D}),[D,mt,it]),bt=Object(a.useCallback)(((e,t,n)=>(({rowIndex:e,rows:t,columnId:n,dataView:a,fieldFormats:i,options:l})=>{var r,o;if(!t[e])return{formattedString:"",withFormula:!1};const s=t[e].flattened,u=null==s?void 0:s[n],c=a.fields.getByName(n),d=Array.isArray(u)?u:[u],m=null!==(r=null==l?void 0:l.compatibleWithCSV)&&void 0!==r&&r,p=null!==(o=null==l?void 0:l.compatibleWithCSV)&&void 0!==o&&o;if("_source"===(null==c?void 0:c.type))return{formattedString:y(s,m),withFormula:!1};let b=!1;return{formattedString:d.map((n=>{const l=Object(g.a)(n,t[e].raw,i,a,c,"text",{skipFormattingInStringifiedJSON:m});return"string"==typeof l?(b=b||Object(f.cellHasFormulas)(l),p?h(l):l):y(l,m)||""})).join(", "),withFormula:b}})({rowIndex:e,rows:pt,dataView:C,columnId:t,fieldFormats:We,options:n})),[pt,C,We]),ft=Object(a.useMemo)((()=>({expanded:ye,setExpanded:fe,rows:pt,onFilter:I,dataView:C,isDarkMode:et,selectedDocs:mt,setSelectedDocs:e=>{at(e),it&&0===e.length&&lt(!1)},valueToStringConverter:bt,componentsTourSteps:Re,isPlainRecord:Y})),[Re,et,C,Y,pt,ye,it,I,fe,mt,bt]),gt="number"==typeof Z&&Z>0?Z:j.a,[yt,vt]=Object(a.useState)({pageIndex:0,pageSize:gt}),ht=Object(a.useMemo)((()=>pt?pt.length:0),[pt]),Et=Object(a.useMemo)((()=>Math.ceil(ht/yt.pageSize)),[ht,yt]),jt=Object(a.useMemo)((()=>{return G?{onChangeItemsPerPage:e=>{null==ee||ee(e)},onChangePage:e=>vt((t=>({...t,pageIndex:e}))),pageIndex:yt.pageIndex>Et-1?0:yt.pageIndex,pageSize:yt.pageSize,pageSizeOptions:null!=Me?Me:(e=yt.pageSize,Object(E.sortBy)(Object(E.uniq)("number"==typeof e&&e>0?[...j.e,e]:j.e)))}:void 0;var e}),[G,yt.pageIndex,yt.pageSize,Et,Me,ee]);Object(a.useEffect)((()=>{vt((e=>e.pageSize===gt?e:{...e,pageSize:gt}))}),[gt,vt]);const Tt=Object(a.useMemo)((()=>((e,t,n)=>{if(n)return()=>!0;const a=new Map;return e.forEach((e=>{a.set(e,((e,t)=>{var n;const a=t.fields.getByName(e);if(!a)return{show:!0};const i=Object(p.getDataViewFieldSubtypeMulti)(a.spec);return{show:!Boolean(null==i?void 0:i.multi),parentName:null==i||null===(n=i.multi)||void 0===n?void 0:n.parent}})(e,t))})),e=>{const t=a.get(e);return!t||t.show||!!t.parentName&&!a.has(t.parentName)}})(C.fields.getAll().map((e=>e.name)),C,he)),[C,he]),Ot=Object(a.useMemo)((()=>Object(T.b)({dataView:C,rows:pt,useNewFieldsApi:$,shouldShowFieldHandler:Tt,closePopover:()=>{var e;return null===(e=tt.current)||void 0===e?void 0:e.closeCellPopover()},fieldFormats:We,maxEntries:je,externalCustomRenderers:Ne,isPlainRecord:Y})),[C,pt,$,Tt,je,We,Ne,Y]),xt=Object(a.useMemo)((()=>null!=Ve?Ve:(()=>{const e=Object(a.memo)((function(e){const{setCellPopoverProps:t,DefaultCellPopover:n}=e;return Object(a.useEffect)((()=>{t({panelClassName:"unifiedDataTable__cellPopover"})}),[t]),Object(k.jsx)(n,e)}));return t=>Object(k.jsx)(e,t)})()),[Ve]),St=Object(a.useMemo)((()=>Object(d.htmlIdGenerator)()()),[]),kt=Object(a.useRef)();Object(a.useEffect)((()=>()=>{null!=kt&&kt.current&&(null==kt||kt.current())}),[]);const Ct=Object(a.useMemo)((()=>te?async e=>{var t;kt.current=te&&await(null==ne||null===(t=ne.dataViewFieldEditor)||void 0===t?void 0:t.openEditor({ctx:{dataView:C},fieldName:e,onSave:async()=>{await te()}}))}:void 0),[C,te,null==ne?void 0:ne.dataViewFieldEditor]),wt=C.timeFieldName,It=Object(a.useCallback)((e=>function(e,t,n,a,i){return!(!a||!t)&&(!i||!!n&&t in n&&e.includes("_source"))}(e,wt,n,z,Y)),[wt,Y,z,n]),Mt=Object(a.useMemo)((()=>function(e,t,n){const a=t.timeFieldName;return n&&a&&!e.find((e=>e===a))?[a,...e]:e}(st,C,It(st))),[C,st,It]),_t=Object(a.useCallback)(((e,t)=>pt[t%pt.length].flattened[e]),[pt]),Nt=Object(a.useMemo)((()=>U&&!Y?Mt.map((e=>{var t,n;return null!==(t=null===(n=C.getFieldByName(e))||void 0===n?void 0:n.toSpec())&&void 0!==t?t:{name:"",type:"",aggregatable:!1,searchable:!1}})):void 0),[U,Y,Mt,C]),Dt=Object(a.useMemo)((()=>({dataViewId:C.id,...null!=Pe?Pe:{}})),[C,Pe]),At=Object(m.c)({fields:Nt,getCellValue:_t,triggerId:U,dataGridRef:tt,metadata:Dt}),{rowHeight:Rt,rowHeightLines:Ft,onChangeRowHeight:zt,onChangeRowHeightLines:Pt}=Ee({storage:Ye,consumer:Ae,key:"dataGridHeaderRowHeight",configRowHeight:null!=u?u:1,rowHeightState:v,onUpdateRowHeight:O}),{rowHeight:Lt,rowHeightLines:Bt,onChangeRowHeight:qt,onChangeRowHeightLines:$t}=Ee({storage:Ye,consumer:Ae,key:"dataGridRowHeight",configRowHeight:null!=ve?ve:j.d.default,rowHeightState:Q,onUpdateRowHeight:W}),Vt=Object(a.useMemo)((()=>ue({columns:Mt,columnsCellActions:At,rowsCount:pt.length,settings:F,dataView:C,defaultColumns:ut,isSortEnabled:V,isPlainRecord:Y,services:{uiSettings:Ke,toastNotifications:Je},hasEditDataViewPermission:()=>{var e;return Boolean(null==Xe||null===(e=Xe.userPermissions)||void 0===e?void 0:e.editIndexPattern())},valueToStringConverter:bt,onFilter:I,editField:Ct,visibleCellActions:_e,columnsMeta:n,showColumnTokens:l,headerRowHeightLines:Ft,customGridColumnsConfiguration:Le})),[n,At,Le,C,Xe,ut,pt.length,Ct,Ft,Y,V,I,F,l,Je,Ke,bt,_e,Mt]),Gt=Object(a.useMemo)((()=>[{type:j.i,detector:()=>0,sortTextAsc:"",sortTextDesc:"",icon:"",color:""}]),[]),Ut=Object(a.useMemo)((()=>({visibleColumns:Mt,setVisibleColumns:e=>{const t=!It(e);_(e,t)}})),[Mt,_,It]),Ht=Object(a.useMemo)((()=>q.map((([e,t])=>({id:e,direction:t}))).filter((({id:e})=>Mt.includes(e)))),[q,Mt]),Qt=Object(a.useCallback)((e=>{V&&N&&N(e.map((({id:e,direction:t})=>[e,t])))}),[N,V]),Wt=Object(a.useMemo)((()=>{if(V){if(Y&&!t.length)return;return{columns:Ht,onSort:Qt}}return{columns:Ht,onSort:()=>{}}}),[V,Ht,Y,t.length,Qt]),Jt=Boolean(fe&&!!be),Xt=Object(a.useMemo)((()=>{const e=function(e){return e?[oe,se]:[se]}(Jt).filter((({id:e})=>x.includes(e)));return we?[...e,...we]:e}),[Jt,x,we]),Kt=null==Be?void 0:Be({controlColumns:{[re]:se,[le]:oe}}),Yt=null!==(He=null==Kt?void 0:Kt.leadingControlColumns)&&void 0!==He?He:Xt,Zt=null!==(Qe=null==Kt?void 0:Kt.trailingControlColumns)&&void 0!==Qe?Qe:de,en=Object(a.useMemo)((()=>Ie||mt.length?Object(k.jsx)(i.a.Fragment,null,Boolean(mt.length)&&Object(k.jsx)(d.EuiFlexGroup,{gutterSize:"s",responsive:!1},qe&&mt.length>1&&Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(L,{selectedDocs:mt,setIsCompareActive:ot})),Object(k.jsx)(d.EuiFlexItem,{grow:!1},Object(k.jsx)(P,{isPlainRecord:Y,isFilterActive:it,rows:D,selectedDocs:mt,setSelectedDocs:at,setIsFilterActive:lt}))),Ie):null),[Ie,mt,Y,it,qe,D]),tn=Object(a.useMemo)((()=>ie?e=>ie({toolbarProps:e,gridProps:{additionalControls:en}}):void 0),[ie,en]),nn=Object(a.useMemo)((()=>{const e={};return W&&(e.allowDensity=!1),(W||O||K)&&(e.allowRowHeight=!1,e.allowResetButton=!1,e.additionalDisplaySettings=Object(k.jsx)(ge,{rowHeight:Lt,rowHeightLines:Bt,onChangeRowHeight:qt,onChangeRowHeightLines:$t,headerRowHeight:Rt,headerRowHeightLines:Ft,onChangeHeaderRowHeight:zt,onChangeHeaderRowHeightLines:Pt,maxAllowedSampleSize:J,sampleSize:X,onChangeSampleSize:K})),Object.keys(e).length?e:void 0}),[Rt,Ft,J,zt,Pt,qt,$t,O,W,K,Lt,Bt,X]),an=Object(a.useMemo)((()=>Y&&t.length?{level:"sorting"}:void 0),[t.length,Y]),ln=Object(a.useMemo)((()=>ut?{...j.j,showColumnSelector:!1,showSortSelector:V,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:B}:{...j.j,showSortSelector:V,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:B}),[ut,V,en,nn,B]),rn=(({rowHeightLines:e,rowLineHeight:t=j.g})=>Object(a.useMemo)((()=>{var n;return{defaultHeight:(n=e)===j.d.auto?"auto":n!==j.d.single?{lineCount:n}:void 0,lineHeight:t}}),[e,t]))({rowHeightLines:Bt,rowLineHeight:ze}),{dataGridId:on,dataGridWrapper:sn,setDataGridWrapper:un}=(()=>{const e=Object(d.useGeneratedHtmlId)({prefix:"unifiedDataTable"}),[t,n]=Object(a.useState)(null),[i,l]=Object(a.useState)(null),r=Object(a.useCallback)(((t,n)=>{const a=document.getElementById(e);a&&(l(a),n.disconnect())}),[e]),o=Object(a.useCallback)((()=>{i&&(e=>{e.classList.contains("euiDataGrid--fullScreen")?document.body.classList.add(Oe):document.body.classList.remove(Oe)})(i)}),[i]);return Object(d.useMutationObserver)(t,r,{childList:!0,subtree:!0}),Object(d.useMutationObserver)(i,o,{attributes:!0,attributeFilter:["class"]}),{dataGridId:e,dataGridWrapper:t,setDataGridWrapper:n}})(),cn=w!==xe.loading;return ht||w!==xe.loading?ht?Object(k.jsx)(S.a.Provider,{value:ft},Object(k.jsx)("span",{className:"unifiedDataTable__inner"},Object(k.jsx)("div",{ref:un,key:rt?"comparisonTable":"docTable","data-test-subj":"discoverDocTable","data-render-complete":cn,"data-shared-item":"","data-title":R,"data-description":A,"data-document-number":pt.length,className:r()(H,"unifiedDataTable__table")},rt?Object(k.jsx)(Te,{id:on,wrapper:sn,consumer:Ae,ariaDescribedBy:St,ariaLabelledBy:e,dataView:C,isPlainRecord:Y,selectedFieldNames:Mt,additionalFieldGroups:De,selectedDocs:nt,schemaDetectors:Gt,forceShowAllFields:ut,showFullScreenButton:B,fieldFormats:We,getDocById:dt,setSelectedDocs:at,setIsCompareActive:ot}):Object(k.jsx)(ke,{id:on,"aria-describedby":St,"aria-labelledby":e,columns:Vt,columnVisibility:Ut,"data-test-subj":"docTable",leadingControlColumns:Yt,onColumnResize:M,pagination:jt,renderCellValue:Ot,ref:tt,rowCount:ht,schemaDetectors:Gt,sorting:Wt,toolbarVisibility:ln,rowHeightsOptions:rn,inMemory:an,gridStyle:null!=Fe?Fe:j.b,renderCustomGridBody:ae,renderCustomToolbar:tn,trailingControlColumns:Zt,cellContext:$e,renderCellPopover:xt})),w!==xe.loading&&!mt.length&&G&&!rt&&Object(k.jsx)(ce,{isLoadingMore:w===xe.loadingMore,rowCount:ht,sampleSize:X,pageCount:Et,pageIndex:null==jt?void 0:jt.pageIndex,totalHits:me,onFetchMoreRecords:pe,data:Ze,fieldFormats:We}),R&&Object(k.jsx)(d.EuiScreenReaderOnly,null,Object(k.jsx)("p",{id:String(St)},A?Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescriptionGrid",defaultMessage:"Table generated by search {searchTitle} ({searchDescription})",values:{searchTitle:R,searchDescription:A}}):Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescription",defaultMessage:"Table generated by search {searchTitle}",values:{searchTitle:R}}))),Jt&&ye&&be(ye,pt,st,n))):Object(k.jsx)("div",{className:"euiDataGrid__noResults","data-render-complete":cn,"data-shared-item":"","data-title":R,"data-description":A,"data-document-number":0},Object(k.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(k.jsx)(d.EuiIcon,{type:"discoverApp",size:"m",color:"subdued"}),Object(k.jsx)(d.EuiSpacer,{size:"s"}),Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.noResultsFound",defaultMessage:"No results found"}))):Object(k.jsx)("div",{className:"euiDataGrid__loading","data-test-subj":"unifiedDataTableLoading"},Object(k.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(k.jsx)(d.EuiLoadingSpinner,null),Object(k.jsx)(d.EuiSpacer,{size:"s"}),Object(k.jsx)(o.FormattedMessage,{id:"unifiedDataTable.loadingResults",defaultMessage:"Loading results"})))}},1491:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(204),l=n(818);const r=e=>Object(a.useMemo)((()=>({async addExceptionListItem({listItem:t}){const n=new AbortController,a=Object(l.c)(t);return i.a({http:e,listItem:a,signal:n.signal})},async deleteExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:l}){const r=new AbortController;try{await i.e({http:e,id:t,namespaceType:n,signal:r.signal}),a()}catch(e){l(e)}},async deleteExceptionList({id:t,namespaceType:n,onSuccess:a,onError:l}){const r=new AbortController;try{await i.d({http:e,id:t,namespaceType:n,signal:r.signal}),a()}catch(e){l(e)}},async duplicateExceptionList({includeExpiredExceptions:t,listId:n,namespaceType:a,onError:l,onSuccess:r}){const o=new AbortController;try{r(await i.h({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:o.signal}))}catch(e){l(e)}},async exportExceptionList({id:t,includeExpiredExceptions:n,listId:a,namespaceType:l,onError:r,onSuccess:o}){const s=new AbortController;try{o(await i.i({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:l,signal:s.signal}))}catch(e){r(e)}},async getExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:r}){const o=new AbortController;try{a(Object(l.b)(await i.l({http:e,id:t,namespaceType:n,signal:o.signal})))}catch(e){r(e)}},async getExceptionList({id:t,namespaceType:n,onSuccess:a,onError:l}){const r=new AbortController;try{a(await i.k({http:e,id:t,namespaceType:n,signal:r.signal}))}catch(e){l(e)}},async getExceptionListsItems({lists:t,filter:n,pagination:a,showDetectionsListsOnly:r,showEndpointListsOnly:o,onSuccess:s,onError:u}){const c=new AbortController,{ids:d,namespaces:m}=(({lists:e,showDetection:t,showEndpoint:n})=>e.filter((e=>t?"detection"===e.type:!n||"endpoint"===e.type)).reduce(((e,{listId:t,namespaceType:n})=>({ids:[...e.ids,t],namespaces:[...e.namespaces,n]})),{ids:[],namespaces:[]}))({lists:t,showDetection:r,showEndpoint:o});try{if(d.length>0&&m.length>0){const{data:t,page:r,per_page:o,total:u}=await i.n({filter:n,http:e,listIds:d,namespaceTypes:m,pagination:a,signal:c.signal});s({exceptions:t.map((e=>Object(l.b)(e))),pagination:{page:r,perPage:o,total:u}})}else s({exceptions:[],pagination:{page:0,perPage:null!=a.perPage?a.perPage:0,total:0}})}catch(e){u(e)}},async getExceptionFilterFromIds({exceptionListIds:t,chunkSize:n,alias:a,excludeExceptions:l,onSuccess:r,onError:o}){const s=new AbortController;try{const{filter:o}=await i.q({http:e,exceptionListIds:t,signal:s.signal,chunkSize:n,alias:a,excludeExceptions:l});r(o)}catch(e){o(e)}},async getExceptionFilterFromExceptions({exceptions:t,chunkSize:n,alias:a,excludeExceptions:l,onSuccess:r,onError:o}){const s=new AbortController;try{const{filter:o}=await i.r({http:e,exceptions:t,signal:s.signal,chunkSize:n,alias:a,excludeExceptions:l});r(o)}catch(e){o(e)}},async updateExceptionListItem({listItem:t}){const n=new AbortController,a=Object(l.d)(t);return i.y({http:e,listItem:a,signal:n.signal})}})),[e])},1494:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(119),i=n.n(a),l=n(84),r=n(2),o=n.n(r),s=n(19),u=n(43),c={name:"1azakc",styles:"text-align:center"};const d=()=>{const e=c;return Object(u.jsx)("div",{css:e},Object(u.jsx)(s.EuiLoadingSpinner,null))},m=(e,t=Object(u.jsx)(d,null))=>o.a.forwardRef(((n,a)=>Object(u.jsx)(l.KibanaErrorBoundaryProvider,{analytics:n.analytics},Object(u.jsx)(l.KibanaErrorBoundary,null,Object(u.jsx)(r.Suspense,{fallback:t},Object(u.jsx)(e,i()({},n,{ref:a})))))))},151:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y}));var a=n(73),i=n.n(a),l=n(2),r=n.n(l),o=n(42),s=n(118),u=n(130),c=n(754),d=n(1270);const m=r.a.memo((({value:e,dateFormat:t=Object(s.h)()})=>r.a.createElement(r.a.Fragment,null,i.a.tz(e,Object(s.m)()).format(t))));m.displayName="PreferenceFormattedDate";const p=({value:e})=>{if(null==e)return Object(u.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(u.f)(e);const n=t.toDate();return r.a.createElement(m,{value:n})};p.displayName="PreferenceFormattedDateFromPrimitive";const b=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,f=r.a.memo((({value:e})=>{const[t]=Object(s.o)("dateFormat:scaled"),n=Array.isArray(t)?t.find(b):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return r.a.createElement(m,{dateFormat:a,value:e})}));f.displayName="PreferenceFormattedP1DTDate";const g=r.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a,tooltipProps:i})=>{if(null==e)return Object(u.f)(e);const l=Object(d.a)(e);return l.isValid()?r.a.createElement(c.a,{date:l.toDate(),fieldName:t,className:n,tooltipProps:i},r.a.createElement(m,{value:l.toDate(),dateFormat:a})):Object(u.f)(e)}));g.displayName="FormattedDate";const y=r.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:l=1})=>{if(null==e)return Object(u.f)(e);const s=Object(d.a)(e);if(!s.isValid())return Object(u.f)(e);const p=s.toDate(),b=i()(p).add(l,"hours").isBefore(new Date);return r.a.createElement(c.a,{date:p,fieldName:n,className:a},b?r.a.createElement(m,{"data-test-subj":"preference-time",value:p,dateFormat:t}):r.a.createElement(o.FormattedRelative,{"data-test-subj":"relative-time",value:p}))}));y.displayName="FormattedRelativePreferenceDate"},157:function(e,t,n){"use strict";var a=n(51);n.d(t,"l",(function(){return a.getUseField})),n.d(t,"k",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"g",(function(){return a.UseField})),n.d(t,"h",(function(){return a.UseMultiFields})),n.d(t,"f",(function(){return a.UseArray})),n.d(t,"m",(function(){return a.useForm})),n.d(t,"n",(function(){return a.useFormContext})),n.d(t,"o",(function(){return a.useFormData})),n.d(t,"i",(function(){return a.VALIDATION_TYPES}));var i=n(62);n.d(t,"b",(function(){return i.Field})),n.d(t,"e",(function(){return i.SelectField})),n.d(t,"d",(function(){return i.HiddenField}));var l=n(77);n.d(t,"j",(function(){return l.fieldValidators}))},159:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"y",(function(){return p})),n.d(t,"p",(function(){return b})),n.d(t,"v",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"h",(function(){return y})),n.d(t,"k",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return E})),n.d(t,"e",(function(){return j})),n.d(t,"q",(function(){return T})),n.d(t,"b",(function(){return O})),n.d(t,"n",(function(){return x})),n.d(t,"i",(function(){return S})),n.d(t,"l",(function(){return k})),n.d(t,"a",(function(){return C})),n.d(t,"o",(function(){return w})),n.d(t,"c",(function(){return I})),n.d(t,"m",(function(){return M})),n.d(t,"x",(function(){return _})),n.d(t,"w",(function(){return N})),n.d(t,"r",(function(){return D})),n.d(t,"s",(function(){return A})),n.d(t,"t",(function(){return R})),n.d(t,"u",(function(){return F}));var a=n(23),i=n(69),l=n(67),r=n(811),o=n(232),s=n(5),u=n(440),c=n(501),d=n(118);n(178);const m=async({rule:e,signal:t})=>d.b.get().http.fetch(s.qb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),p=async({rule:e,signal:t})=>d.b.get().http.fetch(s.qb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(s.qb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({rule:e,signal:t})=>d.b.get().http.fetch(s.pb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:a})=>{const i=Object(r.a)(e),l={page:n.page,per_page:n.perPage,sort_field:t.field,sort_order:t.order,...""!==i?{filter:i}:{}};return d.b.get().http.fetch(s.rb,{method:"GET",version:"2023-10-31",query:l,signal:a})},y=async({id:e,signal:t})=>d.b.get().http.fetch(s.qb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),v=async({ids:e,signal:t})=>{var n;return null===(n=(await d.b.get().http.fetch(a.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===n?void 0:n.reduce(((e,{id:t,...n})=>{var a,i;return e[t]={muteAll:null!==(a=n.mute_all)&&void 0!==a&&a,activeSnoozes:null!==(i=n.active_snoozes)&&void 0!==i?i:[],isSnoozedUntil:n.is_snoozed_until?new Date(n.is_snoozed_until):void 0,snoozeSchedule:n.snooze_schedule},e}),{})},h=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),E=async({filter:e,signal:t})=>d.b.get().http.fetch(o.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),j=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function T({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===o.b.edit?e.editPayload:void 0,duplicate:e.type===o.b.duplicate?e.duplicatePayload:void 0,run:e.type===o.b.run?e.runPayload:void 0};return d.b.get().http.fetch(s.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(n),query:{dry_run:t}})}async function O(e){const t={action:o.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(s.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const x=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,overwriteActionConnectors:a=!1,signal:i})=>{const l=new FormData;return l.append("file",e),d.b.get().http.fetch(`${s.qb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n,overwrite_action_connectors:a},body:l,signal:i})},S=async({signal:e})=>d.b.get().http.fetch(o.g,{method:"GET",version:"1",signal:e}),k=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(c.a,{method:"GET",version:"1",query:n,signal:t})},C=async({ruleId:e,items:t,signal:n})=>d.b.get().http.fetch(`${s.qb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:n}),w=({packageName:e,packageVersion:t,prerelease:n=!1,force:a=!0})=>d.b.get().http.post(l.epmRouteService.getInstallPath(e,t),{query:{prerelease:n},version:"2023-10-31",body:JSON.stringify({force:a})}),I=({packages:e,prerelease:t=!1})=>d.b.get().http.post(l.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),M=async({signal:e})=>d.b.get().http.fetch(u.a,{method:"GET",version:"1",signal:e}),_=async({signal:e})=>d.b.get().http.fetch(u.f,{method:"POST",version:"1",signal:e}),N=async({signal:e})=>d.b.get().http.fetch(u.e,{method:"POST",version:"1",signal:e}),D=async()=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),A=async e=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),R=async()=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),F=async e=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},161:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(44),i=n(2),l=n(45),r=n(138),o=n(124),s=n(148),u=n(200);const c=()=>{const e=Object(l.useDispatch)(),{from:t,to:n}=Object(o.a)((e=>Object(a.pick)(["from","to"],s.d.globalTimeRangeSelector(e)))),[c,d]=Object(i.useState)(!0),m=Object(i.useRef)([]),p=Object(i.useCallback)((({id:t,inspect:n,loading:a,refetch:i,searchSessionId:l})=>{m.current=[...m.current,t],e(u.c.setQuery({inputId:r.a.global,id:t,inspect:n,loading:a,refetch:i,searchSessionId:l}))}),[e]),b=Object(i.useCallback)((({id:t})=>e(u.c.deleteOneQuery({inputId:r.a.global,id:t}))),[e]);return Object(i.useEffect)((()=>{d(!1)}),[]),Object(i.useEffect)((()=>()=>{m.current.length>0&&m.current.forEach((e=>b({id:e})))}),[b]),Object(i.useMemo)((()=>({isInitializing:c,from:t,to:n,setQuery:p,deleteQuery:b})),[b,t,c,p,n])}},163:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return b})),n.d(t,"q",(function(){return f})),n.d(t,"p",(function(){return g})),n.d(t,"y",(function(){return y})),n.d(t,"A",(function(){return v})),n.d(t,"B",(function(){return h})),n.d(t,"C",(function(){return E})),n.d(t,"D",(function(){return j})),n.d(t,"d",(function(){return T})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return x})),n.d(t,"g",(function(){return S})),n.d(t,"E",(function(){return k})),n.d(t,"F",(function(){return C})),n.d(t,"G",(function(){return w})),n.d(t,"I",(function(){return I})),n.d(t,"J",(function(){return M})),n.d(t,"K",(function(){return _})),n.d(t,"L",(function(){return N})),n.d(t,"X",(function(){return D})),n.d(t,"Y",(function(){return A})),n.d(t,"Z",(function(){return R})),n.d(t,"ab",(function(){return F})),n.d(t,"z",(function(){return z})),n.d(t,"bb",(function(){return P})),n.d(t,"cb",(function(){return L})),n.d(t,"M",(function(){return B})),n.d(t,"N",(function(){return q})),n.d(t,"P",(function(){return $})),n.d(t,"S",(function(){return V})),n.d(t,"T",(function(){return G})),n.d(t,"Q",(function(){return U})),n.d(t,"R",(function(){return H})),n.d(t,"W",(function(){return Q})),n.d(t,"V",(function(){return W})),n.d(t,"s",(function(){return J})),n.d(t,"r",(function(){return X})),n.d(t,"w",(function(){return K})),n.d(t,"O",(function(){return Y})),n.d(t,"x",(function(){return Z})),n.d(t,"H",(function(){return ee})),n.d(t,"U",(function(){return te})),n.d(t,"t",(function(){return ne})),n.d(t,"v",(function(){return ae})),n.d(t,"u",(function(){return ie}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),r=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),T=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),C=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),w=(a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timelineâ€¦"}),a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"})),I=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),M=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),z=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),P=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),L=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),B=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),$=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),V=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),G=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),Q=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),Z=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),ee=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),te=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ne=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ae=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Importâ€¦"}),ie=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},164:function(e,t,n){const a=n(347),{MAX_LENGTH:i,MAX_SAFE_INTEGER:l}=n(348),{safeRe:r,t:o}=n(311),s=n(431),{compareIdentifiers:u}=n(558);class SemVer{constructor(e,t){if(t=s(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?r[o.LOOSE]:r[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>l||this.major<0)throw new TypeError("Invalid major version");if(this.minor>l||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>l||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<l)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(a("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===n&&(a=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},165:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return r})),n.d(t,"n",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"m",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"p",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"o",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return E}));var a=n(7),i=n(20);const l=e=>{if(null!=e){const t=e.trim().split(/[ \t\r\n]+/);return"sequence"===t[0]&&"where"!==t[1]}return!1},r=e=>"eql"===e,o=e=>"threshold"===e,s=e=>"query"===e||"saved_query"===e,u=e=>"threat_match"===e,c=e=>"machine_learning"===e,d=e=>"new_terms"===e,m=e=>"esql"===e,p=e=>Array.isArray(e)?e:Object(a.isEmpty)(e)?[]:[e],b=e=>{var t;return null!==(t=null==e?void 0:e.trim().startsWith("sequence"))&&void 0!==t&&t},f=e=>Array.isArray(e)?e:[e],g=e=>i.e.includes(e),y=e=>g(e),v=e=>!o(e)&&g(e),h=e=>!o(e)&&g(e),E=e=>g(e)&&i.f.includes(e)},170:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return m}));var a=n(4);let i=function(e){return e.rules="rules",e.alertsCases="alertsCases",e}({}),l=function(e){return e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase",e}({});const r={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},o=(e,t)=>`tourStepAnchor-${t}-${e}`,s={[i.alertsCases]:[l.pointToAlertName,l.expandEvent]},u={[i.alertsCases]:[l.pointToAlertName,l.expandEvent,l.reviewAlertDetailsFlyout,l.addAlertToCase,l.viewCase]},c=[{...r,step:l.pointToAlertName,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:o(l.pointToAlertName,i.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...r,step:l.expandEvent,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:o(l.expandEvent,i.alertsCases)},{...r,step:l.reviewAlertDetailsFlyout,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${o(l.reviewAlertDetailsFlyout,i.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:o(l.reviewAlertDetailsFlyout,i.alertsCases)},{...r,step:l.addAlertToCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:o(l.addAlertToCase,i.alertsCases)},{...r,step:l.createCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:o(l.createCase,i.alertsCases),offset:20,repositionOnScroll:!1},{...r,step:l.submitCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:o(l.submitCase,i.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...r,step:l.viewCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:o(l.viewCase,i.alertsCases)}],d={title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},m={[i.rules]:[],[i.alertsCases]:c}},171:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},176:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return We})),n.d(t,"c",(function(){return Je})),n.d(t,"f",(function(){return Xe})),n.d(t,"d",(function(){return Ke})),n.d(t,"e",(function(){return Ye}));var a=n(120),i=n(199),l=n(464),r=n(466),o=n(463),s=n(467),u=n(468),c=n(469),d=n(470);const m=a.z.object({name:i.K,description:i.B,risk_score:i.r,severity:i.Y}),p=a.z.object({rule_name_override:i.L.optional(),timestamp_override:i.db.optional(),timestamp_override_fallback_disabled:i.eb.optional(),timeline_id:i.bb.optional(),timeline_title:i.cb.optional(),outcome:i.V.optional(),alias_target_id:i.U.optional(),alias_purpose:i.T.optional(),license:i.I.optional(),note:i.j.optional(),building_block_type:i.f.optional(),output_index:i.d.optional(),namespace:i.e.optional(),meta:i.J.optional(),investigation_fields:i.i.optional(),throttle:i.z.optional()}),b=a.z.object({version:i.S.optional(),tags:i.R.optional(),enabled:i.k.optional(),risk_score_mapping:i.s.optional(),severity_mapping:i.Z.optional(),interval:i.F.optional(),from:i.G.optional(),to:i.H.optional(),actions:a.z.array(i.t).optional(),exceptions_list:a.z.array(i.C).optional(),author:i.A.optional(),false_positives:i.D.optional(),references:i.O.optional(),max_signals:i.n.optional(),threat:i.ab.optional(),setup:i.X.optional(),related_integrations:i.o.optional(),required_fields:a.z.array(i.q).optional()}),f=m.merge(p).merge(b),g=m.partial().merge(p).merge(b),y=m.merge(p).merge(b.required()),v=a.z.object({id:i.M,rule_id:i.P,immutable:i.l,rule_source:i.Q.optional(),updated_at:a.z.string().datetime(),updated_by:a.z.string(),created_at:a.z.string().datetime(),created_by:a.z.string(),revision:a.z.number().int().min(0),required_fields:i.p,execution_summary:l.a.optional()}),h=f.merge(a.z.object({rule_id:i.P.optional()})),E=f.merge(a.z.object({id:i.M.optional(),rule_id:i.P.optional()})),j=g.merge(a.z.object({id:i.M.optional(),rule_id:i.P.optional()})),T=y.merge(v),O=a.z.literal("eql"),x=a.z.object({type:a.z.literal("eql"),query:i.N,language:O}),S=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),event_category_override:r.a.optional(),tiebreaker_field:r.b.optional(),timestamp_field:r.c.optional(),alert_suppression:i.a.optional()}),k=x.merge(S),C=x.merge(S),w=x.partial().merge(S),I=T.merge(C),M=h.merge(k),_=E.merge(k),N=j.merge(w),D=a.z.object({type:a.z.literal("query")}),A=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:i.a.optional()}),R=a.z.object({query:i.N.optional(),language:i.m.optional()}),F=D.merge(A).merge(R),z=D.partial().merge(A).merge(R),P=D.merge(A).merge(R.required()),L=T.merge(P),B=h.merge(F),q=E.merge(F),$=j.merge(z),V=a.z.object({type:a.z.literal("saved_query"),saved_id:i.W}),G=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:i.a.optional(),query:i.N.optional()}),U=a.z.object({language:i.m.optional()}),H=V.merge(G).merge(U),Q=V.partial().merge(G).merge(U),W=V.merge(G).merge(U.required()),J=T.merge(W),X=h.merge(H),K=E.merge(H),Y=j.merge(Q),Z=a.z.object({type:a.z.literal("threshold"),query:i.N,threshold:s.a}),ee=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),alert_suppression:s.b.optional()}),te=a.z.object({language:i.m.optional()}),ne=Z.merge(ee).merge(te),ae=Z.partial().merge(ee).merge(te),ie=Z.merge(ee).merge(te.required()),le=T.merge(ie),re=h.merge(ne),oe=E.merge(ne),se=j.merge(ae),ue=a.z.object({type:a.z.literal("threat_match"),query:i.N,threat_query:u.g,threat_mapping:u.f,threat_index:u.d}),ce=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),threat_filters:u.c.optional(),threat_indicator_path:u.e.optional(),threat_language:i.m.optional(),concurrent_searches:u.a.optional(),items_per_search:u.b.optional(),alert_suppression:i.a.optional()}),de=a.z.object({language:i.m.optional()}),me=ue.merge(ce).merge(de),pe=ue.partial().merge(ce).merge(de),be=ue.merge(ce).merge(de.required()),fe=T.merge(be),ge=h.merge(me),ye=E.merge(me),ve=j.merge(pe),he=a.z.object({type:a.z.literal("machine_learning"),anomaly_threshold:c.a,machine_learning_job_id:c.b}),Ee=a.z.object({alert_suppression:i.a.optional()}),je=he.partial().merge(Ee),Te=he.merge(Ee),Oe=he.merge(Ee),xe=T.merge(Te),Se=h.merge(Oe),ke=E.merge(Oe),Ce=j.merge(je),we=a.z.object({type:a.z.literal("new_terms"),query:i.N,new_terms_fields:d.b,history_window_start:d.a}),Ie=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),alert_suppression:i.a.optional()}),Me=a.z.object({language:i.m.optional()}),_e=we.partial().merge(Ie).merge(Me),Ne=we.merge(Ie).merge(Me.required()),De=we.merge(Ie).merge(Me),Ae=T.merge(Ne),Re=h.merge(De),Fe=E.merge(De),ze=j.merge(_e),Pe=a.z.literal("esql"),Le=a.z.object({type:a.z.literal("esql"),language:Pe,query:i.N}),Be=a.z.object({alert_suppression:i.a.optional()}),qe=Be.merge(Le.partial()),$e=Be.merge(Le),Ve=Be.merge(Le),Ge=T.merge($e),Ue=h.merge(Ve),He=E.merge(Ve),Qe=j.merge(qe.partial()),We=a.z.discriminatedUnion("type",[k,F,H,ne,me,Oe,De,Ve]),Je=(a.z.union([w,z,Q,ae,pe,je,_e,qe]),a.z.discriminatedUnion("type",[C,P,W,ie,be,Te,Ne,$e]),a.z.discriminatedUnion("type",[M,B,X,re,ge,Se,Re,Ue])),Xe=a.z.discriminatedUnion("type",[_,q,K,oe,ye,ke,Fe,He]),Ke=a.z.union([N,$,Y,se,ve,Ce,ze,Qe]),Ye=a.z.discriminatedUnion("type",[I,L,J,le,fe,xe,Ae,Ge])},178:function(e,t,n){"use strict";n.d(t,"xc",(function(){return i})),n.d(t,"dc",(function(){return l})),n.d(t,"fc",(function(){return r})),n.d(t,"zd",(function(){return o})),n.d(t,"yd",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"wc",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"Tb",(function(){return m})),n.d(t,"yc",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"t",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"u",(function(){return y})),n.d(t,"x",(function(){return v})),n.d(t,"s",(function(){return h})),n.d(t,"n",(function(){return E})),n.d(t,"v",(function(){return j})),n.d(t,"A",(function(){return T})),n.d(t,"g",(function(){return O})),n.d(t,"o",(function(){return x})),n.d(t,"j",(function(){return S})),n.d(t,"q",(function(){return k})),n.d(t,"w",(function(){return C})),n.d(t,"h",(function(){return w})),n.d(t,"p",(function(){return I})),n.d(t,"k",(function(){return M})),n.d(t,"i",(function(){return _})),n.d(t,"z",(function(){return N})),n.d(t,"y",(function(){return D})),n.d(t,"ib",(function(){return A})),n.d(t,"gb",(function(){return R})),n.d(t,"hb",(function(){return F})),n.d(t,"kb",(function(){return z})),n.d(t,"mb",(function(){return P})),n.d(t,"E",(function(){return L})),n.d(t,"m",(function(){return B})),n.d(t,"C",(function(){return q})),n.d(t,"l",(function(){return $})),n.d(t,"D",(function(){return V})),n.d(t,"jb",(function(){return G})),n.d(t,"lb",(function(){return U})),n.d(t,"pb",(function(){return H})),n.d(t,"ob",(function(){return Q})),n.d(t,"nb",(function(){return W})),n.d(t,"eb",(function(){return J})),n.d(t,"T",(function(){return X})),n.d(t,"F",(function(){return K})),n.d(t,"V",(function(){return Y})),n.d(t,"G",(function(){return Z})),n.d(t,"I",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"H",(function(){return ne})),n.d(t,"U",(function(){return ae})),n.d(t,"W",(function(){return ie})),n.d(t,"X",(function(){return le})),n.d(t,"P",(function(){return re})),n.d(t,"bb",(function(){return oe})),n.d(t,"Q",(function(){return se})),n.d(t,"fb",(function(){return ue})),n.d(t,"S",(function(){return ce})),n.d(t,"R",(function(){return de})),n.d(t,"cb",(function(){return me})),n.d(t,"db",(function(){return pe})),n.d(t,"N",(function(){return be})),n.d(t,"M",(function(){return fe})),n.d(t,"L",(function(){return ge})),n.d(t,"K",(function(){return ye})),n.d(t,"O",(function(){return ve})),n.d(t,"Z",(function(){return he})),n.d(t,"Y",(function(){return Ee})),n.d(t,"ab",(function(){return je})),n.d(t,"Yb",(function(){return Te})),n.d(t,"od",(function(){return Oe})),n.d(t,"nd",(function(){return xe})),n.d(t,"td",(function(){return Se})),n.d(t,"rd",(function(){return ke})),n.d(t,"rb",(function(){return Ce})),n.d(t,"qd",(function(){return we})),n.d(t,"Ub",(function(){return Ie})),n.d(t,"jc",(function(){return Me})),n.d(t,"kc",(function(){return _e})),n.d(t,"Sb",(function(){return Ne})),n.d(t,"Zb",(function(){return De})),n.d(t,"Pb",(function(){return Ae})),n.d(t,"lc",(function(){return Re})),n.d(t,"mc",(function(){return Fe})),n.d(t,"Eb",(function(){return ze})),n.d(t,"Db",(function(){return Pe})),n.d(t,"Fb",(function(){return Le})),n.d(t,"yb",(function(){return Be})),n.d(t,"Ab",(function(){return qe})),n.d(t,"zb",(function(){return $e})),n.d(t,"Hb",(function(){return Ve})),n.d(t,"xb",(function(){return Ge})),n.d(t,"sb",(function(){return Ue})),n.d(t,"Gb",(function(){return He})),n.d(t,"vb",(function(){return Qe})),n.d(t,"wb",(function(){return We})),n.d(t,"Bb",(function(){return Je})),n.d(t,"Cb",(function(){return Xe})),n.d(t,"tb",(function(){return Ke})),n.d(t,"ub",(function(){return Ye})),n.d(t,"Wb",(function(){return Ze})),n.d(t,"Rb",(function(){return et})),n.d(t,"Jb",(function(){return tt})),n.d(t,"Vb",(function(){return nt})),n.d(t,"wd",(function(){return at})),n.d(t,"pd",(function(){return it})),n.d(t,"ed",(function(){return lt})),n.d(t,"tc",(function(){return rt})),n.d(t,"gd",(function(){return ot})),n.d(t,"nc",(function(){return st})),n.d(t,"sc",(function(){return ut})),n.d(t,"oc",(function(){return ct})),n.d(t,"pc",(function(){return dt})),n.d(t,"qc",(function(){return mt})),n.d(t,"rc",(function(){return pt})),n.d(t,"Kb",(function(){return bt})),n.d(t,"b",(function(){return ft})),n.d(t,"md",(function(){return gt})),n.d(t,"fd",(function(){return yt})),n.d(t,"Lb",(function(){return vt})),n.d(t,"a",(function(){return ht})),n.d(t,"ld",(function(){return Et})),n.d(t,"c",(function(){return jt})),n.d(t,"uc",(function(){return Tt})),n.d(t,"Ib",(function(){return Ot})),n.d(t,"Mb",(function(){return xt})),n.d(t,"ec",(function(){return St})),n.d(t,"sd",(function(){return kt})),n.d(t,"gc",(function(){return Ct})),n.d(t,"vc",(function(){return wt})),n.d(t,"vd",(function(){return It})),n.d(t,"bc",(function(){return Mt})),n.d(t,"cc",(function(){return _t})),n.d(t,"B",(function(){return Nt})),n.d(t,"ud",(function(){return Dt})),n.d(t,"Ob",(function(){return At})),n.d(t,"Nb",(function(){return Rt})),n.d(t,"zc",(function(){return Ft})),n.d(t,"qb",(function(){return zt})),n.d(t,"Yc",(function(){return Pt})),n.d(t,"Zc",(function(){return Lt})),n.d(t,"Xc",(function(){return Bt})),n.d(t,"Vc",(function(){return qt})),n.d(t,"Wc",(function(){return $t})),n.d(t,"Kc",(function(){return Vt})),n.d(t,"Lc",(function(){return Gt})),n.d(t,"Ic",(function(){return Ut})),n.d(t,"Jc",(function(){return Ht})),n.d(t,"Cc",(function(){return Qt})),n.d(t,"Dc",(function(){return Wt})),n.d(t,"Ac",(function(){return Jt})),n.d(t,"Bc",(function(){return Xt})),n.d(t,"Tc",(function(){return Kt})),n.d(t,"Uc",(function(){return Yt})),n.d(t,"Rc",(function(){return Zt})),n.d(t,"Sc",(function(){return en})),n.d(t,"Gc",(function(){return tn})),n.d(t,"Hc",(function(){return nn})),n.d(t,"Ec",(function(){return an})),n.d(t,"Fc",(function(){return ln})),n.d(t,"cd",(function(){return rn})),n.d(t,"ad",(function(){return on})),n.d(t,"dd",(function(){return sn})),n.d(t,"bd",(function(){return un})),n.d(t,"Oc",(function(){return cn})),n.d(t,"Qc",(function(){return dn})),n.d(t,"Pc",(function(){return mn})),n.d(t,"Mc",(function(){return pn})),n.d(t,"Nc",(function(){return bn})),n.d(t,"kd",(function(){return fn})),n.d(t,"hd",(function(){return gn})),n.d(t,"Xb",(function(){return yn})),n.d(t,"Qb",(function(){return vn})),n.d(t,"id",(function(){return hn})),n.d(t,"hc",(function(){return En})),n.d(t,"ic",(function(){return jn})),n.d(t,"xd",(function(){return Tn})),n.d(t,"ac",(function(){return On})),n.d(t,"jd",(function(){return xn}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),r=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Manage value lists"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),s=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRunTitle",{defaultMessage:"Manual run"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.investigationFieldsTitle",{defaultMessage:"Custom highlighted fields"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),_=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),R=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),F=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),P=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be scheduled"}),L=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),B=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),V=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),G=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),U=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkManualRuleRunConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Schedule {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorMessage",{defaultMessage:"This action can only be applied"}),Q=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorTitle",{values:{rulesCount:e},defaultMessage:"Manual rule run cannot be scheduled for more than {rulesCount, plural, =1 {# rule} other {# rules}}"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorCloseButton",{defaultMessage:"Close"}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),le=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ue=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),de=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),pe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.investigationFieldsRequiredErrorMessage",{defaultMessage:"A minimum of one custom highlighted field is required."}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsOverwriteCheckboxLabel",{defaultMessage:"Overwrite the custom highlighted fields for the selected rules"}),ge=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxLabel",{defaultMessage:"Add custom highlighted fields for selected rules"}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter fields that you want to add.  You can choose from any of the fields included in the default Elastic Security indices."}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxLabel",{defaultMessage:"Delete custom highlighted fields for selected rules"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter the fields that you want to remove from the selected rules. After you remove these fields, they will no longer appear in the Highlighted fields section of the alerts generated by selected rules."}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),Te=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CKâ„¢ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),Se=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ke=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),we=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),Ie=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),_e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunDescription",{defaultMessage:"Manual run"}),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunTooltip",{defaultMessage:"Manual run available only for enabled rules"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),Pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.integrationsTitle",{defaultMessage:"Integrations"}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Ze=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),it=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),st=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),ut=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),ct=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),dt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),ft=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),ht=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),Et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),Tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),Ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),xt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),St=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),kt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),Ct=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),wt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),It=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),Mt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),_t=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),Nt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),Dt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),At=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),Rt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),Ft=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),zt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),Pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),Lt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),Bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),$t=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),Vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),Gt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ut=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),Ht=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),Wt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),Xt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),Kt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),Yt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Zt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),en=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),tn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),nn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),an=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),ln=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),rn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastTitle",{defaultMessage:"Rules scheduled"}),on=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastTitle",{defaultMessage:"Error scheduling manual rule run"}),sn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully scheduled manual rule run for {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),un=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastDescription",{values:{failedRulesCount:e},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to schedule manual rule run."}),cn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),dn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),mn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),pn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),bn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),fn=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),gn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),yn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),vn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),hn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),En=a.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),jn=e=>a.i18n.translate("xpack.securitySolution.addRules.installRuleButton.ariaLabel",{defaultMessage:'Install "{ruleName}"',values:{ruleName:e}}),Tn=a.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),On=a.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),xn=a.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},181:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return b}));var a=n(19),i=n(2),l=n.n(i),r=n(138),o=n(514),s=n(474),u=n(447),c=n(650);const d="inspectButtonComponent",m=({children:e,show:t=!0})=>l.a.createElement(o.a,{show:t,targetClassNames:[d]},e),p=({compact:e=!1,inputId:t=r.a.global,inspectIndex:n=0,isDisabled:i,multiple:o=!1,onCloseInspect:m,queryId:p="",showInspectButton:b=!0,title:f=""})=>{const{additionalRequests:g,additionalResponses:y,handleClick:v,handleCloseModal:h,isButtonDisabled:E,isShowingModal:j,loading:T,request:O,response:x}=Object(u.a)({inputId:t,inspectIndex:n,isDisabled:i,multiple:o,onCloseInspect:m,queryId:p});return l.a.createElement(l.a.Fragment,null,t===r.a.timeline&&!e&&b&&l.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":c.d,"data-test-subj":"inspect-empty-button",isDisabled:E,isLoading:T,onClick:v},c.d),(t===r.a.global||e)&&b&&l.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":c.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:E,title:c.d,onClick:v}),j&&null!==O&&null!==x&&l.a.createElement(s.a,{additionalRequests:g,additionalResponses:y,closeModal:h,"data-test-subj":"inspect-modal",inputId:t,request:O,response:x,title:f}))};p.displayName="InspectButtonComponent";const b=l.a.memo(p)},182:function(e,t,n){"use strict";n.d(t,"h",(function(){return l})),n.d(t,"k",(function(){return r})),n.d(t,"n",(function(){return o})),n.d(t,"r",(function(){return s})),n.d(t,"m",(function(){return u})),n.d(t,"o",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"q",(function(){return m})),n.d(t,"p",(function(){return p})),n.d(t,"t",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"g",(function(){return y})),n.d(t,"s",(function(){return v})),n.d(t,"v",(function(){return h})),n.d(t,"w",(function(){return E})),n.d(t,"u",(function(){return j})),n.d(t,"f",(function(){return T})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return x})),n.d(t,"e",(function(){return S})),n.d(t,"d",(function(){return k})),n.d(t,"a",(function(){return C}));var a=n(5),i=n(660);const l=`${a.Tb}/:tabName(${i.a.endpoints})`,r=`${a.Tb}/:tabName(${i.a.policies})`,o=`${a.Tb}/:tabName(${i.a.policies})/:policyId/settings`,s=`${a.Tb}/:tabName(${i.a.policies})/:policyId/trustedApps`,u=`${a.Tb}/:tabName(${i.a.policies})/:policyId/eventFilters`,c=`${a.Tb}/:tabName(${i.a.policies})/:policyId/hostIsolationExceptions`,d=`${a.Tb}/:tabName(${i.a.policies})/:policyId/blocklists`,m=`${a.Tb}/:tabName(${i.a.policies})/:policyId/protectionUpdates`,p=`${a.Tb}/:tabName(${i.a.policies})/:policyId`,b=`${a.Tb}/:tabName(${i.a.trustedApps})`,f=`${a.Tb}/:tabName(${i.a.eventFilters})`,g=`${a.Tb}/:tabName(${i.a.hostIsolationExceptions})`,y=`${a.Tb}/:tabName(${i.a.blocklist})`,v=`${a.Tb}/:tabName(${i.a.responseActionsHistory})`,h="management",E="policyDetails",j="endpoints",T=[10,20,50],O=0,x=10,S="desc",k="created_at",C=1e4},185:function(e,t,n){"use strict";var a,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),l=[];function r(e){for(var t=-1,n=0;n<l.length;n++)if(l[n].identifier===e){t=n;break}return t}function o(e,t){for(var n={},a=[],i=0;i<e.length;i++){var o=e[i],s=t.base?o[0]+t.base:o[0],u=n[s]||0,c="".concat(s," ").concat(u);n[s]=u+1;var d=r(c),m={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(l[d].references++,l[d].updater(m)):l.push({identifier:c,updater:f(m,t),references:1}),a.push(c)}return a}function s(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var l=n.nc;l&&(a.nonce=l)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var r=i(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,n,a){var i=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var l=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(l,r[t]):e.appendChild(l)}}function m(e,t,n){var a=n.css,i=n.media,l=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),l&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var p=null,b=0;function f(e,t){var n,a,i;if(t.singleton){var l=b++;n=p||(p=s(t)),a=d.bind(null,n,l,!1),i=d.bind(null,n,l,!0)}else n=s(t),a=m.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var i=r(n[a]);l[i].references--}for(var s=o(e,t),u=0;u<n.length;u++){var c=r(n[u]);0===l[c].references&&(l[c].updater(),l.splice(c,1))}n=s}}}},186:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,a,i,l=e[1]||"",r=e[3];if(!r)return l;if(t&&"function"==typeof btoa){var o=(n=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),s=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[l].concat(s).concat([o]).join("\n")}return[l].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var l=0;l<this.length;l++){var r=this[l][0];null!=r&&(i[r]=!0)}for(var o=0;o<e.length;o++){var s=[].concat(e[o]);a&&i[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}},187:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(118);const l={managed:!0},r=()=>{const{services:{apm:e}}=Object(i.j)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:l)),[e])}},o=e=>`Timeline search ${e}`},194:function(e,t,n){"use strict";n.d(t,"c",(function(){return s.a})),n.d(t,"h",(function(){return s.d})),n.d(t,"d",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return m.b})),n.d(t,"f",(function(){return m.a})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return b})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return v}));var a=n(44),i=n(2),l=n(454),r=n(529),o=n(364),s=n(258),u=n(276),c=(n(5),n(207));const d=(e,t)=>`/${e}${Object(c.a)(t)}`;var m=n(375);const p=(e,t)=>`/${e}${Object(c.a)(t)}`,b=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,f=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(c.a)(null!=t?t:void 0)}`,g=e=>`/create${Object(c.a)(null!=e?e:void 0)}`,y=e=>{const{getAppUrl:t}=Object(o.a)(),n=Object(r.b)(e);return{formatUrl:Object(i.useCallback)(((i,{absolute:l=!1,skipSearch:r=!1}={})=>{const o=function(e,t,n){const[i,l]=e.split("?");return`${i}${n?Object(a.isEmpty)(l)?"":`?${l}`:Object(a.isEmpty)(l)?t:`?${l}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}(i,n,r);return t({deepLinkId:e,path:o,absolute:l})}),[t,e,n]),search:n}},v=()=>{const e=Object(l.f)(),t=Object(r.a)();return Object(i.useCallback)((({deepLinkId:n,path:a="",absolute:i=!1,skipSearch:l=!1})=>{const r=l?"":t(n);return e({id:n,path:a,urlState:r,absolute:i})}),[e,t])}},197:function(e,t,n){"use strict";n.d(t,"C",(function(){return i})),n.d(t,"q",(function(){return l})),n.d(t,"v",(function(){return r})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"B",(function(){return m})),n.d(t,"r",(function(){return p})),n.d(t,"u",(function(){return b})),n.d(t,"y",(function(){return f})),n.d(t,"k",(function(){return g})),n.d(t,"E",(function(){return y})),n.d(t,"w",(function(){return v})),n.d(t,"b",(function(){return h})),n.d(t,"x",(function(){return E})),n.d(t,"z",(function(){return j})),n.d(t,"t",(function(){return T})),n.d(t,"s",(function(){return O})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return S})),n.d(t,"F",(function(){return k})),n.d(t,"g",(function(){return C})),n.d(t,"A",(function(){return w})),n.d(t,"D",(function(){return I})),n.d(t,"e",(function(){return M})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return N})),n.d(t,"i",(function(){return D})),n.d(t,"h",(function(){return A})),n.d(t,"j",(function(){return R}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),m=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),p=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),y=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),v=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),h=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),E=a.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),j=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),T=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),O=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),x=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),C=Object.freeze({tried:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),w=a.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),I=a.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),M=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),_=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),N=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),D=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),A=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),R=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},201:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(956);const l=()=>Object(a.useContext)(i.a)},208:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));var a=n(2),i=n(8),l=n.n(i),r=n(452);const o=e=>{const t=Object(r.b)(),n=l()(t.sections$,t.getSectionsValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},s=e=>{const t=Object(r.b)(),n=l()(t.messages$,t.getMessagesValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},u=e=>{const t=Object(r.b)(),n=Object(a.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=n?n:null}},2111:function(e,t,n){"use strict";n.r(t),n.d(t,"registerActions",(function(){return Ge}));var a=n(80),i=n(113);n(553);const l=e=>t=>{const n=e(t);return r(n)},r=e=>{const t=t=>s(e,t);return t.combine=t=>{const n=o(e,t);return r(n)},t},o=(e,t)=>u(e,t),s=(e,t)=>u(e,t),u=(e,t)=>{const{isCompatible:n,execute:a,...i}=t;let l=e.isCompatible;n&&(l=a?n:async t=>!!await e.isCompatible(t)&&n(t));const r=null!=a?a:e.execute;return{...e,isCompatible:l,execute:r,...i}};var c=n(576),d=n.n(c),m=n(4),p=n(44),b=n(411),f=n(233);const g=[f.b.DATE,f.b.IP,f.b.STRING,f.b.NUMBER,f.b.BOOLEAN],y=e=>g.includes(e),v=e=>e.every((e=>Object(p.isString)(e)||Object(p.isNumber)(e)||Object(p.isBoolean)(e)))&&(e=>e.every((t=>typeof t==typeof e[0])))(e),h=e=>e.filter((e=>null!=e)),E=e=>Array.isArray(e)?e:[e],j=m.i18n.translate("cellActions.actions.incompatibility.warningMessage",{defaultMessage:"The action can not be executed because the value and type are incompatible"}),T=m.i18n.translate("cellActions.actions.copyToClipboard.displayName",{defaultMessage:"Copy to Clipboard"}),O=m.i18n.translate("cellActions.actions.copyToClipboard.successMessage",{defaultMessage:"Copied to the clipboard"}),x=l((({notifications:e})=>({type:b.a,getIconType:()=>"copyClipboard",getDisplayName:()=>T,getDisplayNameTooltip:()=>T,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&null!=n.name&&y(n.type)},execute:async({data:t})=>{var n,a;const i=null===(n=t[0])||void 0===n?void 0:n.field,l=null===(a=t[0])||void 0===a?void 0:a.value,r=h(E(l));if(!v(r))return void e.toasts.addWarning({title:j});const o=r.map((e=>Object(p.isString)(e)?`"${(e=>e.replace(/"/g,'\\"'))(e)}"`:e)).join(" AND "),s=""!==o?`${i.name}: ${o}`:i.name;d()(s,{debug:!0})&&e.toasts.addSuccess({title:O},{toastLifeTimeMs:800})}})));var S=n(53);const k=({key:e,negate:t,dataViewId:n})=>({meta:{key:e,negate:t,type:S.FILTERS.EXISTS,value:"exists",index:n},query:{exists:{field:e}}}),C=({key:e,negate:t,value:n,dataViewId:a})=>({meta:{index:a,key:e,negate:t,type:S.FILTERS.PHRASE,params:{query:n.toString()}},query:{match_phrase:{[e]:{query:n.toString()}}}}),w=({filterManager:e,key:t,value:n,negate:a,dataViewId:i})=>{e.addFilters((({key:e,value:t,negate:n,dataViewId:a})=>0===t.length?k({key:e,negate:n,dataViewId:a}):t.length>1?(({values:e,key:t,negate:n,dataViewId:a})=>({meta:{index:a,key:t,negate:n,type:S.FILTERS.COMBINED,relation:S.BooleanRelation.AND,params:e.map((e=>C({key:t,value:e,dataViewId:a})))}}))({key:e,negate:n,values:t,dataViewId:a}):C({key:e,negate:n,value:t[0],dataViewId:a}))({key:t,value:n,negate:a,dataViewId:i}))},I=e=>0===e.length||e.every((e=>""===e)),M=m.i18n.translate("cellActions.actions.filterIn",{defaultMessage:"Filter In"}),_=l((({filterManager:e,notifications:{toasts:t}})=>({type:b.c,getIconType:()=>"plusInCircle",getDisplayName:()=>M,getDisplayNameTooltip:()=>M,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!n.name&&y(n.type)},execute:async({data:n,metadata:a})=>{var i,l;const r=null===(i=n[0])||void 0===i?void 0:i.field,o=null===(l=n[0])||void 0===l?void 0:l.value,s="string"==typeof(null==a?void 0:a.dataViewId)?a.dataViewId:void 0,u=h(E(o));v(u)?N({filterManager:e,fieldName:r.name,value:u,dataViewId:s}):t.addWarning({title:j})}}))),N=({filterManager:e,fieldName:t,value:n,dataViewId:a})=>{null!=e&&w({filterManager:e,key:t,value:n,negate:I(n),dataViewId:a})},D=m.i18n.translate("cellActions.actions.filterOut",{defaultMessage:"Filter Out"}),A=l((({filterManager:e,notifications:{toasts:t}})=>({type:b.c,getIconType:()=>"minusInCircle",getDisplayName:()=>D,getDisplayNameTooltip:()=>D,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!n.name&&y(n.type)},execute:async({data:n,metadata:a})=>{var i,l;const r=null===(i=n[0])||void 0===i?void 0:i.field,o=null===(l=n[0])||void 0===l?void 0:l.value,s="string"==typeof(null==a?void 0:a.dataViewId)?a.dataViewId:void 0,u=h(E(o));v(u)?R({filterManager:e,fieldName:r.name,value:u,dataViewId:s}):t.addWarning({title:j})}}))),R=({filterManager:e,fieldName:t,value:n,dataViewId:a})=>{null!=e&&w({filterManager:e,key:t,value:n,negate:!I(n),dataViewId:a})};var F=n(114),z=n(5);const P=["signal.rule.risk_score","kibana.alert.risk_score","signal.reason","kibana.alert.reason"],L=e=>!!e&&e===z.m,B=e=>e.type===F.LENS_EMBEDDABLE_TYPE,q=e=>!!e&&!P.includes(e),$=(e,t)=>"number"===e&&"value_count"===t;var V=n(131),G=n(236);const U=({services:e})=>{const{filterManager:t}=e.data.query,{notifications:n}=e,{query:{filterManager:a}}=e.timelineDataService;return _({filterManager:t,notifications:n}).combine({type:G.d.FILTER,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&q(n.name)&&y(n.type)},execute:async({data:e,metadata:i})=>{var l,r;const o=null===(l=e[0])||void 0===l?void 0:l.field.name,s=null===(r=e[0])||void 0===r?void 0:r.value,u=null==i?void 0:i.dataViewId,c=h(E(s));if(!v(c))return void n.toasts.addWarning({title:j});if(!o)return;const d=!0===(null==i?void 0:i.negateFilters)?R:N;null!=i&&i.scopeId&&Object(V.isTimelineScope)(i.scopeId)?d({filterManager:a,fieldName:o,value:c,dataViewId:u}):d({filterManager:t,fieldName:o,value:c,dataViewId:u})}})},H=({services:e})=>{const{filterManager:t}=e.data.query,{notifications:n}=e,{query:{filterManager:a}}=e.timelineDataService;return A({filterManager:t,notifications:n}).combine({type:G.d.FILTER,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&q(n.name)&&y(n.type)},execute:async({data:e,metadata:i})=>{var l,r;const o=null===(l=e[0])||void 0===l?void 0:l.field.name,s=null===(r=e[0])||void 0===r?void 0:r.value,u=null==i?void 0:i.dataViewId,c=h(E(s));if(!v(c))return void n.toasts.addWarning({title:j});if(!o)return;const d=!0===(null==i?void 0:i.negateFilters)?N:R;null!=i&&i.scopeId&&Object(V.isTimelineScope)(i.scopeId)?d({filterManager:a,fieldName:o,value:c,dataViewId:u}):d({filterManager:t,fieldName:o,value:c,dataViewId:u})}})},Q=({store:e,services:t})=>{const{application:n}=t;let a;return n.currentAppId$.subscribe((e=>{a=e})),U({store:e,services:t}).combine({isCompatible:async()=>L(a)})},W=({store:e,services:t})=>{const{application:n}=t;let a;return n.currentAppId$.subscribe((e=>{a=e})),H({store:e,services:t}).combine({isCompatible:async()=>L(a)})};var J=n(78),X=n(129),K=n(149);const Y=({id:e,order:t,store:n,services:i,negate:l})=>{const{application:r,notifications:o,data:s,topValuesPopover:u,timelineDataService:c}=i,{query:{filterManager:d}}=c;let p;r.currentAppId$.subscribe((e=>{p=e}));const b=X.b.getTimelineByIdSelector();return Object(J.createAction)({id:e,order:t,getIconType:()=>l?"minusInCircle":"plusInCircle",getDisplayName:()=>l?m.i18n.translate("xpack.securitySolution.actions.filterOutTimeline",{defaultMessage:"Filter out"}):m.i18n.translate("xpack.securitySolution.actions.filterForTimeline",{defaultMessage:"Filter for"}),type:G.a.FILTER,isCompatible:async({embeddable:e,data:t})=>!Object(a.isErrorEmbeddable)(e)&&B(e)&&function(e){return!!e&&e.length>0&&e.every((({columnMeta:e})=>e&&q(e.field)))}(t)&&L(p),execute:async({data:e})=>{var t,a,i,r,c,m,p,f,g;const y=null===(t=e[0])||void 0===t||null===(a=t.columnMeta)||void 0===a?void 0:a.field,T="value_count"===(null===(i=e[0])||void 0===i||null===(r=i.columnMeta)||void 0===r||null===(c=r.sourceParams)||void 0===c?void 0:c.type),O=null===(m=e[0])||void 0===m?void 0:m.value,x=null===(p=e[0])||void 0===p||null===(f=p.columnMeta)||void 0===f||null===(g=f.sourceParams)||void 0===g?void 0:g.indexPatternId,S="string"==typeof x?x:void 0,C=h(E(O));if(!v(C))return void o.toasts.addWarning({title:j});if(!y)return;u.closePopover();const w=b(n.getState(),K.f.active),I=null!=w&&w.show?d:s.query.filterManager;T?(({filterManager:e,key:t,negate:n,dataViewId:a})=>{e.addFilters(k({key:t,negate:n,dataViewId:a}))})({filterManager:I,key:y,negate:!!l,dataViewId:S}):(!0===l?R:N)({filterManager:I,fieldName:y,value:C,dataViewId:S})}})};var Z=n(13);const ee="timeline",te=m.i18n.translate("xpack.securitySolution.actions.cellValue.addToTimeline.displayName",{defaultMessage:"Add to timeline"}),ne=m.i18n.translate("xpack.securitySolution.actions.cellValue.addToNewTimeline.displayName",{defaultMessage:"Investigate in timeline"}),ae=e=>m.i18n.translate("xpack.securitySolution.actions.addToTimeline.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline"}),ie=m.i18n.translate("xpack.securitySolution.actions.cellValue.addToTimeline.warningTitle",{defaultMessage:"Unable to add to timeline"}),le=m.i18n.translate("xpack.securitySolution.actions.cellValue.addToTimeline.warningMessage",{defaultMessage:"Filter received is empty or cannot be added to timeline"});var re=n(128),oe=n(195),se=n(406),ue=n(382),ce=n(520),de=n(1349),me=n(229);const pe=({field:e,id:t,value:n,operator:a=K.e,excluded:i=!1})=>({and:[],enabled:!0,id:Object(re.i)(t),name:e,excluded:i,kqlQuery:"",queryMatch:{field:e,value:n,operator:a}}),be=({contextId:e,eventId:t,field:n,fieldFormat:a,fieldType:i,values:l,sourceParamType:r,negate:o})=>null==n?null:(Array.isArray(l)?l.length>0?l:[null]:[l]).reduce(((l,s,u)=>{let c="";const d=null!=s?s.toString():s,m=`${e}${t?`-${t}`:""}-${n}-${u}${d?`-${d}`:""}`;if(!fe(n,i))return l;if($(i,r))return c=`value-count-data-provider-${e}-${n}`,l.push(pe({field:n,id:c,value:"",excluded:!1,operator:K.a})),l;if(null==d)return c=`empty-value-${m}`,l.push(pe({field:n,id:c,value:"",excluded:!0,operator:K.a})),l;if(i===se.b&&(c=`formatted-ip-data-provider-${e}-${n}-${d}${t?`-${t}`:""}`,Object(p.isString)(d)&&!Object(p.isEmpty)(d))){let e=d;try{e=JSON.parse(d)}catch(e){}return Object(p.isArray)(e)?e.forEach((e=>l.push(pe({field:n,id:c,value:e})))):l.push(pe({field:n,id:c,value:e})),l}return c=ge({field:n,fieldFormat:a,appendedUniqueId:m,value:d}),l.push(pe({field:n,id:c,value:d,excluded:o})),l}),[]),fe=(e,t)=>t!==me.f&&e!==me.i,ge=({field:e,fieldFormat:t,appendedUniqueId:n,value:a})=>{let i;return i=ue.b.some((t=>e===t))?`port-default-${n}`:e===ce.b?`duration-default-${n}`:t===de.a?`bytes-default-${n}`:e===me.o?`alert-field-default-${n}`:[me.m,me.l,me.e,oe.j,me.n,me.c].includes(e)?`event-field-default-${n}-${a}`:`event-field-default-${n}`,i},ye=l((({store:e,services:t})=>{const{notifications:n}=t;return{type:G.d.ADD_TO_TIMELINE,getIconType:()=>ee,getDisplayName:()=>te,getDisplayNameTooltip:()=>te,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&q(n.name)&&fe(n.name,n.type)&&y(n.type)},execute:async({data:t,metadata:a})=>{var i,l,r;const{name:o,type:s}=null===(i=t[0])||void 0===i?void 0:i.field,u=null===(l=t[0])||void 0===l?void 0:l.value,c=h(E(u));if(!v(c))return void n.toasts.addWarning({title:j});const[d,...m]=c,[p]=null!==(r=be({contextId:K.f.active,fieldType:s,values:d,field:o,negate:!0===(null==a?void 0:a.negateFilters)}))&&void 0!==r?r:[];if(p&&m.forEach((e=>{var t;const[n]=null!==(t=be({contextId:K.f.active,fieldType:s,values:e,field:o,negate:!0===(null==a?void 0:a.negateFilters)}))&&void 0!==t?t:[];n&&p.and.push(n)})),p){e.dispatch(Object(Z.addProvider)({id:K.f.active,providers:[p]}));const t=c.join(", ");n.toasts.addSuccess({title:ae(t)})}else n.toasts.addWarning({title:ie,text:le})}}}));var ve=n(158);const he=l((({store:e,services:t})=>{const{notifications:n}=t;return{type:G.d.INVESTIGATE_IN_NEW_TIMELINE,getIconType:()=>ee,getDisplayName:()=>ne,getDisplayNameTooltip:()=>ne,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&q(n.name)&&fe(n.name,n.type)&&y(n.type)},execute:async({data:t,metadata:a})=>{var i,l,r;const o=null===(i=t[0])||void 0===i?void 0:i.field,s=null===(l=t[0])||void 0===l?void 0:l.value,u=h(E(s));if(!v(u))return void n.toasts.addWarning({title:j});const c=null!==(r=be({contextId:K.f.active,fieldType:o.type,values:u,field:o.name,negate:!0===(null==a?void 0:a.negateFilters)}))&&void 0!==r?r:[];for(const e of null!==(d=null==a?void 0:a.andFilters)&&void 0!==d?d:[]){var d,m;const t=null!==(m=be({contextId:K.f.active,field:e.field,values:e.value}))&&void 0!==m?m:[];if(t)for(const e of c)e.and.push(...t)}c.length>0?(e.dispatch(X.a.createTimeline({...ve.b,id:K.f.active})),e.dispatch(Object(Z.showTimeline)({id:K.f.active,show:!0})),e.dispatch(Object(Z.addProvider)({id:K.f.active,providers:c}))):n.toasts.addWarning({title:ie,text:le})}}}));var Ee=n(118);const je="embeddable_addToTimeline",Te=({store:e,services:t})=>{const{application:n}=t;let a;return n.currentAppId$.subscribe((e=>{a=e})),ye({store:e,services:t}).combine({isCompatible:async()=>L(a)})};var Oe=n(1379);const xe=e=>m.i18n.translate("xpack.securitySolution.actions.showTopTooltip",{values:{fieldName:e},defaultMessage:"Show top {fieldName}"}),Se=l((({services:e})=>({type:G.d.SHOW_TOP_N,getIconType:()=>"visBarVertical",getDisplayName:({data:e})=>{var t;return xe(null===(t=e[0])||void 0===t?void 0:t.field.name)},getDisplayNameTooltip:({data:e})=>{var t;return xe(null===(t=e[0])||void 0===t?void 0:t.field.name)},isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&q(n.name)&&Object(Oe.a)(n.type)&&!Object(S.isDataViewFieldSubtypeNested)(n)&&!!n.aggregatable},execute:async t=>{var n;const a=Object(p.first)(t.data);t.nodeRef.current&&a&&e.topValuesPopover.showPopover({fieldName:a.field.name,scopeId:null===(n=t.metadata)||void 0===n?void 0:n.scopeId,nodeRef:t.nodeRef.current})}}))),ke=m.i18n.translate("xpack.securitySolution.actions.cellValue.copyToClipboard.displayName",{defaultMessage:"Copy to Clipboard"}),Ce=m.i18n.translate("xpack.securitySolution.actions.cellValue.copyToClipboard.successMessage",{defaultMessage:"Copied to the clipboard"}),we="embeddable_copyToClipboard",Ie=({services:e})=>{const{notifications:t}=e;return x({notifications:t}).combine({type:G.d.COPY,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return q(n.name)}})},Me=({services:e})=>{const{application:t}=e;let n;return t.currentAppId$.subscribe((e=>{n=e})),Ie({services:e}).combine({isCompatible:async()=>L(n)})};var _e=n(1799),Ne=n(1490),De=n(266),Ae=n(1630);const Re={[Ae.b.alertsOnAlertsPage]:z.e.ALERTS_PAGE,[Ae.b.alertsOnRuleDetailsPage]:z.e.RULE_DETAILS,[Ae.b.alertsOnCasePage]:z.e.CASE,[Ae.b.alertsRiskInputs]:z.e.RISK_INPUTS},Fe=m.i18n.translate("xpack.securitySolution.actions.toggleColumnToggle.label",{defaultMessage:"Toggle column in table"}),ze=l((({store:e,services:t})=>({type:G.d.TOGGLE_COLUMN,getIconType:()=>"listAdd",getDisplayName:()=>Fe,getDisplayNameTooltip:({data:e,metadata:t})=>{var n,a;return null!=t&&t.isObjectArray?(a=null===(n=e[0])||void 0===n?void 0:n.field.name,m.i18n.translate("xpack.securitySolution.actions.toggleColumnToggle.nestedLabel",{values:{field:a},defaultMessage:"The {field} field is an object, and is broken down into nested fields which can be added as columns"})):Fe},isCompatible:async({data:e,metadata:t})=>{var n;const a=null===(n=e[0])||void 0===n?void 0:n.field;return 1===e.length&&q(a.name)&&!(null==t||!t.scopeId)&&(Object(V.isTimelineScope)(t.scopeId)||Object(V.isInTableScope)(t.scopeId))},execute:async({metadata:n,data:a})=>{var i,l;const r=null===(i=a[0])||void 0===i?void 0:i.field,o=null==n?void 0:n.scopeId;if(!o)return;const s=Object(V.getScopedActions)(o);if(!s)return;const u=(e=>{if(Re[e])return Re[e]})(o);var c;if(u)return void(null===(c=t.triggersActionsUi.alertsTableConfigurationRegistry.getActions(u))||void 0===c||c.toggleColumn(r.name));const d=Object(V.isTimelineScope)(o)?X.b.getTimelineByIdSelector():_e.b.getTableByIdSelector(),m=Object(V.isTimelineScope)(o)?ve.b:Ne.d,{columns:p}=null!==(l=d(e.getState(),o))&&void 0!==l?l:m;p.some((e=>e.id===r.name))?e.dispatch(s.removeColumn({columnId:r.name,id:o})):e.dispatch(s.upsertColumn({column:{columnHeaderType:Ne.a,id:r.name,initialWidth:De.a},id:o,index:1}))}})));var Pe=n(321),Le=n(567);const Be=m.i18n.translate("xpack.securitySolution.actions.toggleFieldToAssetTable.label",{defaultMessage:"Toggle field in asset table"}),qe=l((({store:e})=>({type:G.d.TOGGLE_COLUMN,getIconType:()=>"listAdd",getDisplayName:()=>Be,getDisplayNameTooltip:({data:e})=>Be,isCompatible:async({data:e,metadata:t})=>{var n;const a=null===(n=e[0])||void 0===n?void 0:n.field;return 1===e.length&&q(a.name)&&!(null!=t&&t.isObjectArray)&&!(null==t||!t.scopeId)&&Object.values(Pe.UserAssetTableType).includes(null==t?void 0:t.scopeId)},execute:async({metadata:t,data:n})=>{var a;const i=null===(a=n[0])||void 0===a?void 0:a.field,l=null==t?void 0:t.scopeId;if(!l)return;const{fields:r}=Le.e.selectUserAssetTableById(e.getState(),l);r.some((e=>e===i.name))?e.dispatch(Le.c.removeUserAssetTableField({fieldName:i.name,tableId:l})):e.dispatch(Le.c.addUserAssetTableField({fieldName:i.name,tableId:l}))}}))),$e=(e,t)=>{const{telemetry:n}=t,{execute:a,...i}=e;return{...i,execute:e=>(n.reportCellActionClicked({actionId:i.id,displayName:i.getDisplayName(e),fieldName:e.data.map((({field:e})=>e.name)).join(", "),metadata:e.metadata}),a(e))}};var Ve=n(70);const Ge=(e,t,n,a)=>{Ue(e,a),He(e,a),Qe(e,t,a),((e,t,n,a)=>{((e,t,n)=>{n.uiActions.registerTrigger({id:G.c.HISTOGRAM_TRIGGER})})(0,0,a);const i=((e,t,n,a)=>{const i=Object(Ve.createFilterAction)(a.customDataService.query.filterManager,a.customDataService.query.timefilter.timefilter,n,G.b.VIS_FILTER_ACTION,G.b.VIS_FILTER_ACTION);return a.uiActions.registerAction(i),i})(0,0,n,a);a.uiActions.attachAction(G.c.HISTOGRAM_TRIGGER,i.id)})(0,0,n,a)},Ue=(e,t)=>{const{uiActions:n}=t,i=(({store:e,order:t,services:n})=>Y({id:"embeddable_filterIn",order:t,store:e,services:n}))({store:e,order:2,services:t});n.addTriggerAction(a.CELL_VALUE_TRIGGER,i);const l=(({store:e,order:t,services:n})=>Y({id:"embeddable_filterOut",order:t,store:e,services:n,negate:!0}))({store:e,order:3,services:t});n.addTriggerAction(a.CELL_VALUE_TRIGGER,l);const r=(({store:e,order:t})=>{const{application:n,notifications:{toasts:i}}=Ee.b.get();let l;return n.currentAppId$.subscribe((e=>{l=e})),Object(J.createAction)({id:je,type:je,order:t,getIconType:()=>ee,getDisplayName:()=>te,isCompatible:async({embeddable:e,data:t})=>!Object(a.isErrorEmbeddable)(e)&&B(e)&&Object(a.isFilterableEmbeddable)(e)&&function(e){return!!e&&e.length>0&&e.every((({columnMeta:e})=>{var t;return e&&q(e.field)&&"esaggs"===e.source&&(null===(t=e.sourceParams)||void 0===t?void 0:t.indexPatternId)}))}(t)&&L(l),execute:async({data:t})=>{const n=t.reduce(((e,{columnMeta:t,value:n,eventId:a})=>{var i;const l=be({contextId:K.f.active,fieldType:null==t?void 0:t.type,values:n,field:null==t?void 0:t.field,eventId:a,sourceParamType:null==t||null===(i=t.sourceParams)||void 0===i?void 0:i.type});return l&&e.push(...l),e}),[]);if(n.length>0){e.dispatch(Object(Z.addProvider)({id:K.f.active,providers:n}));const t=(e=>e.reduce(((e,{queryMatch:{value:t,operator:n,field:a}})=>{if(null!=t)if(n===K.a)e.push(a);else{const n=Array.isArray(t)?t.join(", "):t.toString();e.push(n)}return e}),[]).join(", "))(n);t.length>0&&i.addSuccess({title:ae(t)})}else i.addWarning({title:ie,text:le})}})})({store:e,order:4});n.addTriggerAction(a.CELL_VALUE_TRIGGER,r);const o=(({order:e})=>{const{application:t}=Ee.b.get();let n;return t.currentAppId$.subscribe((e=>{n=e})),Object(J.createAction)({id:we,type:we,order:e,getIconType:()=>"copyClipboard",getDisplayName:()=>ke,isCompatible:async({embeddable:e,data:t})=>!Object(a.isErrorEmbeddable)(e)&&B(e)&&function(e){return!!e&&e.length>0&&e.every((({columnMeta:e})=>e&&q(e.field)))}(t)&&L(n),execute:async({data:e})=>{const{notifications:{toasts:t}}=Ee.b.get(),n=e.map((({columnMeta:e,value:t})=>{var n;return $(null==e?void 0:e.type,null==e||null===(n=e.sourceParams)||void 0===n?void 0:n.type)?`${null==e?void 0:e.field}: *`:`${null==e?void 0:e.field}${null!=t?`: "${t}"`:""}`})).join(" | ");d()(n,{debug:!0})&&t.addSuccess({title:Ce,toastLifeTimeMs:800})}})})({order:5});n.addTriggerAction(a.CELL_VALUE_TRIGGER,o)},He=(e,t)=>{const{uiActions:n}=t,a={filterIn:Q({store:e,services:t}),filterOut:W({store:e,services:t}),addToTimeline:Te({store:e,services:t}),copyToClipboard:Me({services:t})};var l;l=i.SEARCH_EMBEDDABLE_CELL_ACTIONS_TRIGGER_ID,["filterIn","filterOut","addToTimeline","copyToClipboard"].forEach(((e,i)=>{const r=a[e];if(r){const a=r({id:`${l}-${e}`,order:i}),o=$e(a,t);n.addTriggerAction(l,o)}}))},Qe=(e,t,n)=>{const{uiActions:a}=n,i={filterIn:U({store:e,services:n}),filterOut:H({store:e,services:n}),addToTimeline:ye({store:e,services:n}),investigateInNewTimeline:he({store:e,services:n}),showTopN:Se({services:n}),copyToClipboard:Ie({services:n}),toggleColumn:ze({store:e,services:n}),toggleUserAssetField:qe({store:e})},l=(e,t)=>{a.registerTrigger({id:e}),t.forEach(((t,l)=>{const r=i[t];if(r){const i=r({id:`${e}-${t}`,order:l}),o=$e(i,n);a.addTriggerAction(e,o)}}))};l(G.e.DEFAULT,["filterIn","filterOut","addToTimeline","showTopN","copyToClipboard"]),l(G.e.DETAILS_FLYOUT,["filterIn","filterOut","addToTimeline","toggleColumn","toggleUserAssetField","showTopN","copyToClipboard"]),l(G.e.ALERTS_COUNT,["investigateInNewTimeline"])}},219:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u}));var a=n(5);const i={ENABLE:`${a.m} singleRuleActions enable`,DISABLE:`${a.m} singleRuleActions disable`,DUPLICATE:`${a.m} singleRuleActions duplicate`,EXPORT:`${a.m} singleRuleActions export`,DELETE:`${a.m} singleRuleActions delete`,MANUAL_RULE_RUN:`${a.m} singleRuleActions manual rule run`,PREVIEW:`${a.m} singleRuleActions preview`,SAVE:`${a.m} singleRuleActions save`},l={ENABLE:`${a.m} bulkRuleActions enable`,DISABLE:`${a.m} bulkRuleActions disable`,DUPLICATE:`${a.m} bulkRuleActions duplicate`,EXPORT:`${a.m} bulkRuleActions export`,MANUAL_RULE_RUN:`${a.m} bulkRuleActions manual rule run`,DELETE:`${a.m} bulkRuleActions delete`,EDIT:`${a.m} bulkRuleActions edit`},r={REFRESH:`${a.m} rulesTable refresh`,FILTER:`${a.m} rulesTable filter`,LOAD_PREBUILT:`${a.m} rulesTable loadPrebuilt`},o={SAVE:`${a.m} timeline save`,DUPLICATE:`${a.m} timeline duplicate`,DELETE:`${a.m} timeline delete`,BULK_DELETE:`${a.m} timeline bulkDelete`},s={OPEN_ANALYZER:`${a.m} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.m} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.m} alerts investigateInTimeline`},u={FIELD_SAVED:`${a.m} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.m} fieldBrowser fieldDeleted`}},222:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return m})),n.d(t,"m",(function(){return p}));var a=n(44),i=n(128),l=n(1630),r=n(266),o=n(131),s=n(200),u=n(706);n.d(t,"e",(function(){return i.f})),n.d(t,"g",(function(){return i.h})),n.d(t,"f",(function(){return i.g})),n.d(t,"k",(function(){return i.l})),n.d(t,"j",(function(){return i.k})),n.d(t,"o",(function(){return i.q})),n.d(t,"n",(function(){return i.p})),n.d(t,"l",(function(){return i.m})),n.d(t,"h",(function(){return i.i})),n.d(t,"p",(function(){return i.v})),n.d(t,"q",(function(){return i.w})),n.d(t,"i",(function(){return i.j})),n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.d}));const c=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:a,timelineId:l,noProviderFound:r=s.b.noProviderFound,onAddedToTimeline:o})=>{const c=Object(i.o)(a),d=t[c];d?Object(u.b)({dataProviders:e,destination:a.destination,dispatch:n,onAddedToTimeline:o,providerToAdd:d,timelineId:l}):n(r({id:c}))},d={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},m=({browserFields:e,dispatch:t,result:n,scopeId:s,defaultsHeader:u})=>{var c;const m=Object(i.n)(n),p=(e=>Object(a.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[m],b=s!==l.b.alertsOnAlertsPage&&s!==l.b.alertsOnRuleDetailsPage||null===(c=u.find((e=>e.id===m)))||void 0===c?{}:c,f=Object(o.getScopedActions)(s);var g;null!=p&&f?t(f.upsertColumn({column:{columnHeaderType:"not-filtered",id:m,linkField:null!==(g=d[m])&&void 0!==g?g:void 0,type:p.type,aggregatable:p.aggregatable,initialWidth:r.a,...b},id:s,index:null!=n.destination?n.destination.index:0})):f&&t(f.upsertColumn({column:{columnHeaderType:"not-filtered",id:m,initialWidth:r.a},id:s,index:null!=n.destination?n.destination.index:0}))},p=e=>e.slice(e.lastIndexOf(".")+1)},224:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(19),i=n(2),l=n.n(i),r=n(41),o=n.n(r),s=n(52),u=n.n(s),c=n(181),d=n(901),m=n(902);const p=o.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(r.css)(["height:","px;"],e)),(({border:e})=>e&&Object(r.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));p.displayName="Header";const b=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",f=({alignHeader:e,border:t,children:n,outerDirection:r="column",growLeftSplit:o=!0,headerFilters:s,height:f,hideSubtitle:g=!1,id:y,inspectMultiple:v=!1,inspectTitle:h,isInspectDisabled:E,showInspectButton:j=!0,split:T,stackHeader:O,subtitle:x,title:S,titleSize:k="l",toggleQuery:C,toggleStatus:w=!0,tooltip:I,tooltipTitle:M})=>{const _=Object(i.useCallback)((()=>{C&&C(!w)}),[C,w]),N=u()({"toggle-expand":w,siemHeaderSection:!0});return l.a.createElement(p,{"data-test-subj":"header-section",border:t,height:f,className:N,$hideSubtitle:g},l.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:r,gutterSize:"xs",responsive:!1},l.a.createElement(a.EuiFlexItem,{grow:o},l.a.createElement(a.EuiFlexGroup,{alignItems:b({alignHeader:e,stackHeader:O}),"data-test-subj":"headerSectionInnerFlexGroup",direction:O?"column":"row",gutterSize:"s"},l.a.createElement(a.EuiFlexItem,{grow:o,className:w?"":"no-margin"},l.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},l.a.createElement(a.EuiFlexItem,null,l.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},C&&l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":m.a(w),color:"text",display:"empty",iconType:w?"arrowDown":"arrowRight",onClick:_,size:"s",title:m.a(w)})),l.a.createElement(a.EuiFlexItem,null,l.a.createElement(a.EuiTitle,{size:k},l.a.createElement("h2",{"data-test-subj":"header-section-title"},l.a.createElement("span",{className:"eui-textBreakNormal"},S),I&&l.a.createElement(l.a.Fragment,null,l.a.createElement(a.EuiIconTip,{color:"subdued",title:M,content:I,size:"l",type:"iInCircle"}))))))),y&&w&&l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(c.b,{isDisabled:E,queryId:y,multiple:v,showInspectButton:j,title:null!=h?h:S})),s&&w&&l.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},s))),n&&w&&l.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!T},n))),!g&&w&&l.a.createElement(a.EuiFlexItem,null,l.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:x}))))},g=l.a.memo(f)},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return m}));const a=100,i=1e4,l=[10,25,50,a,250,500],r={auto:-1,single:0,default:3},o="1.6em",s=370,u=212,c="kibana-json",d={border:"horizontal",fontSize:"s",cellPadding:"l",rowHover:"highlight",header:"underline",stripes:!0},m={showColumnSelector:{allowHide:!1,allowReorder:!0}}},232:function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return B})),n.d(t,"d",(function(){return $})),n.d(t,"e",(function(){return Y})),n.d(t,"g",(function(){return ne.b})),n.d(t,"f",(function(){return ne.a}));var a=n(120);const i=a.enum(["true","false"]).or(a.boolean()).transform((e=>"boolean"==typeof e?e:"true"===e));var l=n(176),r=n(199);const o=a.z.literal("RULE_NOT_MODIFIED"),s=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:o}),u=a.z.object({id:a.z.string(),name:a.z.string().optional()}),c=a.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN","MANUAL_RULE_RUN_FEATURE","MANUAL_RULE_RUN_DISABLED_RULE"]),d=(c.enum,a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:c.optional(),rules:a.z.array(u)})),m=a.z.object({updated:a.z.array(l.e),created:a.z.array(l.e),deleted:a.z.array(l.e),skipped:a.z.array(s)}),p=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),b=a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),rules_count:a.z.number().int().optional(),attributes:a.z.object({results:m,summary:p,errors:a.z.array(d).optional()})}),f=a.z.string(),g=a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()}),y=g.merge(a.z.object({action:a.z.literal("delete")})),v=g.merge(a.z.object({action:a.z.literal("disable")})),h=g.merge(a.z.object({action:a.z.literal("enable")})),E=g.merge(a.z.object({action:a.z.literal("export")})),j=g.merge(a.z.object({action:a.z.literal("duplicate"),duplicate:a.z.object({include_exceptions:a.z.boolean(),include_expired_exceptions:a.z.boolean()}).optional()})),T=g.merge(a.z.object({action:a.z.literal("run"),run:a.z.object({start_date:a.z.string(),end_date:a.z.string().optional()})})),O=a.z.enum(["rule","1h","1d","7d"]),x=(O.enum,a.z.enum(["enable","disable","export","delete","duplicate","edit","run"]).enum),S=a.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule","add_investigation_fields","delete_investigation_fields","set_investigation_fields"]).enum,k=a.z.object({group:r.w,id:r.x,params:r.y,frequency:r.v.optional(),alerts_filter:r.u.optional()}).strict(),C=a.z.object({type:a.z.enum(["add_rule_actions","set_rule_actions"]),value:a.z.object({throttle:O.optional(),actions:a.z.array(k)})}),w=a.z.object({type:a.z.literal("set_schedule"),value:a.z.object({interval:a.z.string().regex(/^[1-9]\d*[smh]$/),lookback:a.z.string().regex(/^[1-9]\d*[smh]$/)})}),I=a.z.object({type:a.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:r.h,overwrite_data_views:a.z.boolean().optional()}),M=a.z.object({type:a.z.enum(["add_tags","delete_tags","set_tags"]),value:r.R}),_=a.z.object({type:a.z.enum(["add_investigation_fields","delete_investigation_fields","set_investigation_fields"]),value:r.i}),N=a.z.object({type:a.z.literal("set_timeline"),value:a.z.object({timeline_id:r.bb,timeline_title:r.cb})}),D=a.z.union([M,I,_,N,C,w]),A=g.merge(a.z.object({action:a.z.literal("edit"),edit:a.z.array(D).min(1)}));a.z.object({dry_run:i.optional()}),a.z.union([y,v,h,E,j,T,A]),a.z.union([b,f]);var R=n(374);a.z.array(a.z.union([l.e,R.a])),a.z.array(l.c),a.z.array(a.z.object({id:r.M.optional(),rule_id:r.P.optional()})),a.z.array(l.d),a.z.array(l.f);var F=n(46),z=n(2074),P=n(1371),L=n(2072);let B=function(e){return e.Enabled="enabled",e.Disabled="disabled",e}({});const q=Object(z.a)("CoverageOverviewRuleActivity",B);let $=function(e){return e.Prebuilt="prebuilt",e.Custom="custom",e}({});const V=Object(z.a)("CoverageOverviewRuleSource",$),G=F.partial({search_term:P.a,activity:Object(L.a)(q),source:Object(L.a)(V)}),U=(F.exact(F.partial({filter:G})),F.type({name:F.string,activity:q})),H=(F.exact(F.type({coverage:F.record(F.string,Object(L.a)(F.string)),unmapped_rule_ids:F.array(F.string),rules_data:F.record(F.string,U)})),l.c,l.e,a.z.object({id:r.M.optional(),rule_id:r.P.optional()}),l.e,l.d,l.e,a.z.object({id:r.M.optional(),rule_id:r.P.optional()}),l.e,l.f,l.e,{exported_exception_list_count:F.number,exported_exception_list_item_count:F.number,missing_exception_list_item_count:F.number,missing_exception_list_items:F.array(F.exact(F.type({item_id:P.a}))),missing_exception_lists:F.array(F.exact(F.type({list_id:P.a}))),missing_exception_lists_count:F.number}),Q=(F.exact(F.type(H)),{exported_count:F.number,exported_rules_count:F.number,missing_rules:F.array(F.exact(F.type({rule_id:P.a}))),missing_rules_count:F.number}),W=F.intersection([F.exact(F.type({id:P.a,type:P.a})),F.exact(F.partial({reason:F.string}))]),J={exported_action_connector_count:F.number,missing_action_connection_count:F.number,missing_action_connections:F.array(F.exact(F.type({id:P.a,type:P.a}))),excluded_action_connection_count:F.number,excluded_action_connections:F.array(W)};F.intersection([F.exact(F.type(Q)),F.exact(F.partial(H)),F.exact(F.partial(J))]),a.z.object({exclude_export_details:i.optional().default(!1),file_name:a.z.string().optional().default("export.ndjson")}),a.z.object({objects:a.z.array(a.z.object({rule_id:r.P}))}).nullable();var X=n(1449),K=n(330);const Y=a.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);Y.enum,a.z.object({fields:Object(X.a)(a.z.string()).optional(),filter:a.z.string().optional(),sort_field:Y.optional(),sort_order:K.a.optional(),page:a.z.coerce.number().int().min(1).optional().default(1),per_page:a.z.coerce.number().int().min(0).optional().default(20)}),a.z.object({page:a.z.number().int(),perPage:a.z.number().int(),total:a.z.number().int(),data:a.z.array(l.e)});var Z=n(2075);F.exact(F.type({rules_summary:F.type({custom_count:Z.a,prebuilt_installed_count:Z.a}),aggregated_fields:F.type({tags:F.array(F.string)})}));var ee=n(472);a.z.object({overwrite:i.optional().default(!1),overwrite_exceptions:i.optional().default(!1),overwrite_action_connectors:i.optional().default(!1),as_new_list:i.optional().default(!1)}),a.z.object({exceptions_success:a.z.boolean(),exceptions_success_count:a.z.number().int().min(0),exceptions_errors:a.z.array(R.a),rules_count:a.z.number().int().min(0),success:a.z.boolean(),success_count:a.z.number().int().min(0),errors:a.z.array(R.a),action_connectors_errors:a.z.array(R.a),action_connectors_warnings:a.z.array(ee.a),action_connectors_success:a.z.boolean(),action_connectors_success_count:a.z.number().int().min(0)}).strict();var te=n(290);te.b.and(te.g).and(te.d.partial().extend({rule_id:te.e,immutable:a.literal(!1).default(!1),required_fields:a.array(te.c).optional()})),r.R;var ne=n(473)},233:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return l}));var a=n(0),i=n.n(a);let l=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),r=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){i()(this,"name",void 0),i()(this,"sortable",void 0),i()(this,"filterable",void 0),i()(this,"esTypes",void 0),this.name=e.name||r.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}const o=new kbn_field_type_KbnFieldType({name:r.UNKNOWN}),s=[new kbn_field_type_KbnFieldType({name:r.STRING,sortable:!0,filterable:!0,esTypes:[l.STRING,l.TEXT,l.MATCH_ONLY_TEXT,l.KEYWORD,l.VERSION,l._TYPE,l._ID]}),new kbn_field_type_KbnFieldType({name:r.NUMBER,sortable:!0,filterable:!0,esTypes:[l.FLOAT,l.HALF_FLOAT,l.SCALED_FLOAT,l.DOUBLE,l.INTEGER,l.LONG,l.UNSIGNED_LONG,l.SHORT,l.BYTE,l.TOKEN_COUNT,l.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:r.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[l.FLOAT_RANGE,l.DOUBLE_RANGE,l.INTEGER_RANGE,l.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:r.DATE,sortable:!0,filterable:!0,esTypes:[l.DATE,l.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:r.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[l.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:r.IP,sortable:!0,filterable:!0,esTypes:[l.IP]}),new kbn_field_type_KbnFieldType({name:r.IP_RANGE,sortable:!0,filterable:!0,esTypes:[l.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:r.BOOLEAN,sortable:!0,filterable:!0,esTypes:[l.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:r.OBJECT,esTypes:[l.OBJECT]}),new kbn_field_type_KbnFieldType({name:r.NESTED,esTypes:[l.NESTED]}),new kbn_field_type_KbnFieldType({name:r.GEO_POINT,esTypes:[l.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:r.GEO_SHAPE,esTypes:[l.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:r.ATTACHMENT,esTypes:[l.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:r.MURMUR3,esTypes:[l.MURMUR3]}),new kbn_field_type_KbnFieldType({name:r._SOURCE,esTypes:[l._SOURCE]}),new kbn_field_type_KbnFieldType({name:r.HISTOGRAM,filterable:!0,esTypes:[l.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:r.CONFLICT}),o],u=e=>{const t=s.find((t=>t.esTypes.includes(e)));return t&&t.name?t.name:r.UNKNOWN};function c(e){switch(e){case l._INDEX:return r.STRING;case"_version":return r.NUMBER;case"datetime":return r.DATE;default:return u(e)}}},247:function(e,t,n){"use strict";var a=n(463);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}))},256:function(e,t,n){"use strict";var a=n(295);n.d(t,"b",(function(){return a.b})),n.d(t,"a",(function(){return a.a}))},258:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(207);const i=e=>`${Object(a.a)(e)}`,l=e=>`${Object(a.a)(e)}`,r=(e,t)=>`/id/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,s=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},263:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(119),i=n.n(a),l=n(2),r=n.n(l),o=n(19),s=n(45),u=n(148),c=n(138),d=n(183),m=n(13),p=n(200),b=n(127),f=n(146),g=n(121),y=n(331),v=n(172);const h=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:h,keepDataView:E,iconType:j,...T})=>{const O=Object(s.useDispatch)(),x=Object(s.useSelector)(u.e.signalIndexName),S=Object(s.useSelector)(u.e.defaultDataView),k=n&&n.find((e=>"template"===e.type)),C=Object(y.a)({timelineId:f.c.active,timelineType:k?g.m.template:g.m.default}),w=Object(l.useCallback)((async()=>{(n||a)&&(h?await C({timeRange:h}):await C(),n&&O(Object(m.updateProviders)({id:f.c.active,providers:n})),a&&O(Object(m.setFilters)({id:f.c.active,filters:a})),E||O(p.d.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:S.id,selectedPatterns:[x||""]})),O(d.b.removeLinkTo([c.a.timeline,c.a.global])))}),[n,C,O,S.id,x,a,h,E]);return e?r.a.createElement(o.EuiButtonEmpty,{"aria-label":v.i,onClick:w,flush:"right",size:"xs",iconType:j},t):r.a.createElement(o.EuiButton,i()({"aria-label":v.i,onClick:w},T),t)};h.displayName="InvestigateInTimelineButton"},267:function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return l})),n.d(t,"m",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"n",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"o",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"p",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return E}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),b=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),g=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),y=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),v=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),h=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),E=a.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},272:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return f}));var a=n(44),i=n(121),l=n(432);const r=(e,t)=>"__typename"!==e&&null!=t?t:void 0,o=e=>!Object(a.isEmpty)(e),s=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===i.m.template?l.b(e):n?l.d(e):t?l.c(e):l.g(e),u=({eventId:e,pinnedEventIds:t})=>!0===t[e],c=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:i})=>{e&&(i?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),m=e=>{var t,n;return!Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n?void 0:n.building_block_type)},p=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,i;const t=(null!==(n=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},b=e=>{var t,n,i,l;return Object(a.isEmpty)(null==e||null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.uuid)?Object(a.isEmpty)(null==e||null===(l=e.eql)||void 0===l?void 0:l.parentId)?"raw":"eql":"signal"},f="note-content"},273:function(e,t,n){"use strict";n.d(t,"i",(function(){return d.h})),n.d(t,"g",(function(){return m.a})),n.d(t,"h",(function(){return p.g})),n.d(t,"a",(function(){return b.b})),n.d(t,"b",(function(){return b.c})),n.d(t,"c",(function(){return b.d})),n.d(t,"d",(function(){return b.f})),n.d(t,"e",(function(){return f.f})),n.d(t,"f",(function(){return f.g}));var a=n(120),i=n(268);const l=a.z.array(i.a).min(1),r=i.a,o=a.z.array(r),s=a.z.enum(["open","closed","acknowledged","in-progress"]),u=(s.enum,a.z.object({add:a.z.array(i.a),remove:a.z.array(i.a)})),c=(a.z.object({assignees:u,ids:l}),a.z.object({tags_to_add:o,tags_to_remove:o}));a.z.object({ids:l,tags:c}),a.z.object({}).catchall(a.z.unknown()),n(624),a.z.object({acknowledged:a.z.boolean()}),a.z.object({acknowledged:a.z.boolean()}),a.z.object({name:a.z.string(),index_mapping_outdated:a.z.boolean().nullable()}),n(247);var d=n(290),m=(n(374),n(471),n(425),n(330)),p=(n(472),n(440)),b=(n(501),n(232)),f=n(341);d.f.and(d.g).and(a.object({invocationCount:a.number(),timeframeEnd:a.string()}));const g=a.z.union([a.z.string(),a.z.object({}).catchall(a.z.unknown())]),y=a.z.union([g,a.z.array(g)]),v=(a.z.object({query:a.z.object({}).catchall(a.z.unknown()).optional(),aggs:a.z.object({}).catchall(a.z.unknown()).optional(),size:a.z.number().int().min(0).optional(),track_total_hits:a.z.boolean().optional(),_source:a.z.union([a.z.boolean(),a.z.string(),a.z.array(a.z.string())]).optional(),fields:a.z.array(a.z.string()).optional(),runtime_mappings:a.z.object({}).catchall(a.z.unknown()).optional(),sort:y.optional()}),a.z.object({}).catchall(a.z.unknown()),a.z.object({signal_ids:a.z.array(i.a).min(1),status:s})),h=a.z.object({query:a.z.object({}).catchall(a.z.unknown()),status:s,conflicts:a.z.enum(["abort","proceed"]).optional().default("abort")}),E=(a.z.union([v,h]),a.z.object({}).catchall(a.z.unknown()),a.z.object({requests_per_second:a.z.number().int().min(1).optional(),size:a.z.number().int().min(1).optional(),slices:a.z.number().int().min(1).optional()})),j=a.z.object({index:a.z.string(),migration_id:a.z.string(),migration_index:a.z.string()}),T=a.z.object({index:a.z.string(),error:a.z.object({message:a.z.string(),status_code:a.z.string()})}),O=a.z.object({index:a.z.string()}),x=(a.z.object({index:a.z.array(i.a).min(1)}).merge(E),a.z.object({indices:a.z.array(a.z.union([j,T,O]))}),a.z.object({id:a.z.string(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()})),S=(a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(x),a.z.object({id:a.z.string(),completed:a.z.boolean(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()}));a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(S);var k=n(2073);const C=a.z.object({version:a.z.number().int(),count:a.z.number().int()}),w=a.z.object({id:i.a,status:a.z.enum(["success","failure","pending"]),version:a.z.number().int(),updated:a.z.string().datetime()}),I=a.z.object({index:i.a,version:a.z.number().int(),signal_versions:a.z.array(C),migrations:a.z.array(w),is_outdated:a.z.boolean()});a.z.object({from:a.z.string().superRefine(k.a)}),a.z.object({indices:a.z.array(I)})},276:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return r})),n(5);var a=n(207);const i=(e,t)=>`/${e}${Object(a.a)(t)}`,l=(e,t)=>`/name/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},281:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return r}));var a=n(120);const i=a.z.enum(["going to run","running","partial failure","failed","succeeded"]),l=i.enum,r=a.z.number().int()},282:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return m}));var a=n(5);const i="histogram-actions-trigger",l={[a.Oc.hosts]:"host",[a.Oc.users]:"user"},r=(e,t)=>{const n=l[e];return n&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${n}.name`,params:{query:t}},query:{match_phrase:{[`${n}.name`]:t}}}]:[]},o=e=>{const t=l[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},s=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],u=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],c=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var n,a,i,l,r,o;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(i=a.indexFilter)||void 0===i?void 0:i.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(l=null==t||null===(r=t.response)||void 0===r||null===(o=r.json)||void 0===o?void 0:o.rawResponse)&&void 0!==l?l:{},null,2)]}}),{requests:[],responses:[]}),m=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},283:function(e,t,n){const a=n(164);e.exports=(e,t,n=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!n)return null;throw e}}},290:function(e,t,n){"use strict";n.d(t,"e",(function(){return a.P})),n.d(t,"c",(function(){return a.q})),n.d(t,"a",(function(){return a.c})),n.d(t,"b",(function(){return i.a})),n.d(t,"d",(function(){return i.b})),n.d(t,"f",(function(){return i.g})),n.d(t,"g",(function(){return i.h})),n.d(t,"h",(function(){return l}));var a=n(199),i=n(176);function l(e){var t;return"external"===(null===(t=e.rule_source)||void 0===t?void 0:t.type)&&e.rule_source.is_customized}n(466),n(469),n(470),n(468),n(467)},295:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y}));var a=n(2),i=n.n(a),l=n(8),r=n.n(l),o=n(3),s=n(48),u=n(794),c=n(131),d=n(118),m=n(170);const p={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{},hidden:!1,setAllTourStepsHidden:()=>{}},b=Object(a.createContext)(p),f=({children:e})=>{var t,n,l,s;const{guidedOnboarding:c}=Object(d.j)().services,[p,f]=Object(a.useState)(!1),g=Object(a.useCallback)((e=>{f(e)}),[]),y=r()(null!==(t=null==c||null===(n=c.guidedOnboardingApi)||void 0===n?void 0:n.isGuideStepActive$(u.a,m.b.rules).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==t?t:Object(o.of)(!1),!1),v=r()(null!==(l=null==c||null===(s=c.guidedOnboardingApi)||void 0===s?void 0:s.isGuideStepActive$(u.a,m.b.alertsCases).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==l?l:Object(o.of)(!1),!1),h=Object(a.useMemo)((()=>({[m.b.rules]:{active:y,hidden:!1},[m.b.alertsCases]:{active:v,hidden:!1}})),[y,v]),E=Object(a.useCallback)((e=>h[e].active),[h]),[j,T]=Object(a.useState)(1),O=Object(a.useCallback)((e=>{T((t=>(t>=m.g[e].length?0:t)+1))}),[]),x=Object(a.useCallback)(((e,t)=>{t<=m.g[e].length&&T(t)}),[]),[S,k]=Object(a.useState)(null);Object(a.useEffect)((()=>{if(!S||null==c||!c.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==c||null===(t=c.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(u.a,S)),e||(k(null),T(1))})(),()=>{e=!0}}),[S,c]);const C=Object(a.useCallback)((e=>{k(e)}),[]),w=Object(a.useMemo)((()=>({hidden:p,setAllTourStepsHidden:g,activeStep:j,endTourStep:C,incrementStep:O,isTourShown:E,setStep:x})),[j,C,p,O,E,g,x]);return i.a.createElement(b.Provider,{value:w},e)},g=({children:e})=>{const{pathname:t}=Object(s.useLocation)(),n=Object(a.useMemo)((()=>Object(c.isTourPath)(t)?f:b.Provider),[t]);return i.a.createElement(n,{value:p},e)},y=()=>{const e=Object(a.useContext)(b);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},300:function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return T.a}));var a=n(119),i=n.n(a),l=n(2),r=n.n(l),o=n(44),s=n(19),u=n(476),c=n.n(u),d=n(42),m=n(696);const p=({disableLinks:e,href:t,target:n,children:a,...i})=>r.a.createElement(s.EuiToolTip,{content:t},r.a.createElement(s.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),b=Object(l.memo)(p);var f=n(118),g=n(16),y=n(4);const v=y.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),h=y.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),E=({children:e,disableLinks:t,textSize:n="m"})=>{const a=Object(l.useMemo)((()=>e=>r.a.createElement(b,i()({},e,{disableLinks:t}))),[t]),u=Object(o.cloneDeep)(m.c);u[1][1].components.a=a;const p=Object(g.b)().isAtLeast("platinum"),{application:y}=Object(f.j)().services,E=Object(l.useMemo)((()=>{if(!1===p){const t=String(e);return m.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,p]),j=Object(l.useMemo)((()=>c()().use(m.a).use(u)),[u]),T=Object(l.useMemo)((()=>{try{return j.processSync(e),null}catch(e){return String(e.message)}}),[e,j]);return r.a.createElement(r.a.Fragment,null,E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiCallOut,{title:v,color:"primary",iconType:"lock"},r.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:r.a.createElement(s.EuiLink,{href:y.getUrlForApp("management",{path:"stack/license_management/home"})},r.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),r.a.createElement(s.EuiSpacer,{size:"s"})),null!==T&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiCallOut,{title:h,color:"danger",iconType:"error"},T),r.a.createElement(s.EuiSpacer,{size:"s"})),r.a.createElement(s.EuiMarkdownFormat,{parsingPluginList:m.a,processingPluginList:u,textSize:n},e))};E.displayName="MarkdownRendererComponent";const j=Object(l.memo)(E);var T=n(481);n(581)},301:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2);const i={},l=n.n(a).a.createContext(i)},305:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(119),i=n.n(a),l=n(2),r=n.n(l),o=n(19),s=n(42),u=n(41),c=n.n(u),d=n(124),m=n(149),p=n(158),b=n(129),f=n(295),g=n(170),y=n(48),v=n(118),h=n(198),E=n(213);const j=(e,t)=>(t===g.a.createCase||t===g.a.submitCase)&&e===g.b.alertsCases,T=c()(o.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>j(t,e)?"9000 !important":"1000 !important")),O=r.a.memo((({children:e,onClick:t,step:n,tourId:a})=>{const{activeStep:u,incrementStep:c,isTourShown:y}=Object(f.b)(),v=Object(l.useMemo)((()=>g.g[a].find((e=>e.step===n))),[n,a]),h=Object(l.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),E=Object(d.b)((e=>{var t;return(null!==(t=h(e,m.f.active))&&void 0!==t?t:p.b).show})),O=Object(l.useCallback)((()=>t?t():c(a)),[c,t,a]),x=Object(l.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),S=j(a,n);if(null==v||(n!==u||!y(a))&&!S||E)return e||null;const{anchor:k,content:C,imageConfig:w,dataTestSubj:I,hideNextButton:M=!1,..._}=v,N=M?r.a.createElement(r.a.Fragment,null):r.a.createElement(o.EuiButtonEmpty,{onClick:O,onKeyDown:x,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),D={..._,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiText,{size:"s"},r.a.createElement("p",null,C)),w&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(o.EuiImage,{alt:w.altText,src:w.src,size:"fullWidth"}))),footerAction:N,isStepOpen:!0,onFinish:()=>null,stepsTotal:g.g[a].length,panelProps:{"data-test-subj":I}};return null!=k?r.a.createElement(r.a.Fragment,null,r.a.createElement(T,i()({tourId:a},D,{anchor:k})),r.a.createElement(r.a.Fragment,null,e)):null!=e?r.a.createElement(T,i()({tourId:a},D),e):null}));O.displayName="SecurityTourStep";const x=r.a.memo((({children:e,isTourAnchor:t=!0,...n})=>t?r.a.createElement(S,n,e):r.a.createElement(r.a.Fragment,null,e)));x.displayName="GuidedOnboardingTourStep";const S=r.a.memo((({children:e,...t})=>{const{hidden:n}=Object(f.b)(),a=(({tourId:e,step:t})=>{const{useIsAddToCaseOpen:n}=Object(v.j)().services.cases.hooks,a=n(),{search:i}=Object(y.useLocation)(),r=Object(l.useMemo)((()=>Object(E.c)(h.a.flyout,i)),[i]),o=null==r?void 0:r.left,s=Object(l.useMemo)((()=>{var e;return o&&(null===(e=g.e[g.b.alertsCases])||void 0===e?void 0:e.includes(t))}),[o,t]),u=Object(l.useMemo)((()=>{var n;return a&&(null===(n=g.d[e])||void 0===n?void 0:n.includes(t))}),[a,e,t]);return s||u})({tourId:t.tourId,step:t.step});return n||a?r.a.createElement(r.a.Fragment,null,e):r.a.createElement(O,t,e)}));S.displayName="SecurityTourStepAnchor"},311:function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:l}=n(348),r=n(347),o=(t=e.exports={}).re=[],s=t.safeRe=[],u=t.src=[],c=t.t={};let d=0;const m="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",l],[m,i]],b=(e,t,n)=>{const a=(e=>{for(const[t,n]of p)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;r(e,i,t),c[e]=i,u[i]=t,o[i]=new RegExp(t,n?"g":void 0),s[i]=new RegExp(a,n?"g":void 0)};b("NUMERICIDENTIFIER","0|[1-9]\\d*"),b("NUMERICIDENTIFIERLOOSE","\\d+"),b("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),b("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),b("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),b("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),b("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),b("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),b("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),b("BUILDIDENTIFIER",`${m}+`),b("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),b("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),b("FULL",`^${u[c.FULLPLAIN]}$`),b("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),b("LOOSE",`^${u[c.LOOSEPLAIN]}$`),b("GTLT","((?:<|>)?=?)"),b("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),b("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),b("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),b("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),b("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),b("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),b("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),b("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),b("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?`+`(?:${u[c.BUILD]})?(?:$|[^\\d])`),b("COERCERTL",u[c.COERCE],!0),b("COERCERTLFULL",u[c.COERCEFULL],!0),b("LONETILDE","(?:~>?)"),b("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",b("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),b("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),b("LONECARET","(?:\\^)"),b("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",b("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),b("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),b("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),b("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),b("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",b("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),b("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),b("STAR","(<|>)?=?\\s*\\*"),b("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),b("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},312:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return g}));var a=n(2),i=n.n(a),l=n(19),r=n(41),o=n.n(r),s=n(42),u=n(130);const c=({children:e,...t})=>i.a.createElement(l.EuiButton,t,e),d=({children:e,...t})=>i.a.createElement(l.EuiLink,t,e),m=o()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);m.displayName="Comma";const p=({children:e,Component:t,dataTestSubj:n,href:a,onClick:l,title:r,iconType:o="expand"})=>t?i.a.createElement(t,{"data-test-subj":n,href:a,iconType:o,onClick:l,title:r},null!=r?r:e):i.a.createElement(c,{"data-test-subj":n,href:a,onClick:l},null!=r?r:e),b=i.a.memo(p),f=o.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),g=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:r})=>{const[o,u]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>u((e=>!e))),[]),d=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null," ,",i.a.createElement(l.EuiButtonEmpty,{size:"xs",onClick:c},`+${r.length-t} `,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[c,t,r.length]);return i.a.createElement(l.EuiFlexItem,{grow:!1},r.length>t&&i.a.createElement(l.EuiPopover,{id:"popover",button:d,isOpen:o,closePopover:c,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},i.a.createElement(y,{render:n,rowItems:r,moreMaxHeight:e,overflowIndexStart:t})))}));g.displayName="ReputationLinksOverflow";const y=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:r})=>{const o=Object(a.useMemo)((()=>r.slice(t).map(((e,t)=>{var a;return i.a.createElement(l.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(u.a)(e))}))),[t,n,r]);return i.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},i.a.createElement(l.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},o))}));y.displayName="MoreReputationLinksContainer"},322:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},330:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(120).z.enum(["asc","desc"]);a.enum},331:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),i=n(45),l=n(138),r=n(243),o=n(129),s=n(206),u=n(146),c=n(121),d=n(124),m=n(183),p=n(166),b=n(127),f=n(260),g=n(513),y=n(122),v=n(274),h=n(158);const E=({timelineId:e,timelineType:t,onClick:n})=>{var E;const j=Object(i.useDispatch)(),T=Object(y.a)("unifiedComponentsInTimelineDisabled"),{id:O,patternList:x}=null!==(E=Object(i.useSelector)(p.d.defaultDataView))&&void 0!==E?E:{id:"",patternList:[]},{timelineFullScreen:S,setTimelineFullScreen:k}=Object(s.c)(),C=Object(d.a)(m.d.globalTimeRangeSelector),{resetDiscoverAppState:w}=Object(g.a)(),I=Object(a.useCallback)((({id:e,show:n,timeRange:a})=>{const i=null!=a?a:C;e===u.c.active&&S&&k(!1),j(p.a.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:O,selectedPatterns:x})),j(o.a.createTimeline({columns:T?r.b:v.a,dataViewId:O,id:e,indexNames:x,show:n,timelineType:t,updated:void 0,excludedRowRendererIds:T||t===c.m.template?[]:h.b.excludedRowRendererIds})),j(m.b.addLinkTo([l.a.global,l.a.timeline])),j(f.a.addNotes({notes:[]})),a&&j(m.b.removeLinkTo([l.a.timeline,l.a.global])),"absolute"===(null==i?void 0:i.kind)?j(m.b.setAbsoluteRangeDatePicker({...i,id:l.a.timeline})):"relative"===(null==i?void 0:i.kind)&&j(m.b.setRelativeRangeDatePicker({...i,id:l.a.timeline}))}),[j,C,O,x,k,S,t,T]);return Object(a.useCallback)((async a=>{await w(),I({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n()}),[I,e,t,n,w])}},341:function(e,t,n){"use strict";n.d(t,"i",(function(){return x})),n.d(t,"j",(function(){return S})),n.d(t,"k",(function(){return k})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return C})),n.d(t,"f",(function(){return v.a})),n.d(t,"g",(function(){return v.b})),n.d(t,"h",(function(){return E})),n.d(t,"a",(function(){return w}));var a=n(46),i=n(1531);let l=function(e){return e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range",e}({}),r=function(e){return e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month",e}({});const o=a.union([a.exact(a.type({type:a.literal(l.last_hour),granularity:a.literal(r.minute)})),a.exact(a.type({type:a.literal(l.last_day),granularity:a.union([a.literal(r.minute),a.literal(r.hour)])})),a.exact(a.type({type:a.literal(l.last_week),granularity:a.union([a.literal(r.hour),a.literal(r.day)])})),a.exact(a.type({type:a.literal(l.last_month),granularity:a.union([a.literal(r.day),a.literal(r.week)])})),a.exact(a.type({type:a.literal(l.last_year),granularity:a.union([a.literal(r.week),a.literal(r.month)])})),a.exact(a.type({type:a.literal(l.custom_range),granularity:a.union([a.literal(r.minute),a.literal(r.hour),a.literal(r.day),a.literal(r.week),a.literal(r.month)]),from:i.a,to:i.a}))]);a.exact(a.partial({interval:o,debug:a.boolean}));var s=n(1371);a.exact(a.intersection([a.type({rule_id:s.a}),a.partial({interval:o,debug:a.boolean})])),a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.type({}));var u=n(120),c=n(1449);const d=u.z.enum(["trace","debug","info","warn","error"]),m=d.enum,p=u.z.enum(["message","status-change","execution-metrics"]),b=p.enum,f=u.z.object({timestamp:u.z.string().datetime(),sequence:u.z.number().int(),level:d,type:p,execution_id:u.z.string().min(1),message:u.z.string()});var g=n(330),y=n(471);u.z.object({search_term:u.z.string().optional(),event_types:Object(c.a)(p).optional().default([]),log_levels:Object(c.a)(d).optional().default([]),date_start:u.z.string().datetime().optional(),date_end:u.z.string().datetime().optional(),sort_order:g.a.optional().default("desc"),page:u.z.coerce.number().int().optional().default(1),per_page:u.z.coerce.number().int().optional().default(20)}),u.z.object({ruleId:u.z.string().min(1)}),u.z.object({events:u.z.array(f),pagination:y.a});var v=n(281);const h=u.z.enum(["backfill","standard"]),E=h.enum,j=u.z.object({execution_uuid:u.z.string(),timestamp:u.z.string().datetime(),duration_ms:u.z.number().int(),status:u.z.string(),message:u.z.string(),num_active_alerts:u.z.number().int(),num_new_alerts:u.z.number().int(),num_recovered_alerts:u.z.number().int(),num_triggered_actions:u.z.number().int(),num_succeeded_actions:u.z.number().int(),num_errored_actions:u.z.number().int(),total_search_duration_ms:u.z.number().int(),es_search_duration_ms:u.z.number().int(),schedule_delay_ms:u.z.number().int(),timed_out:u.z.boolean(),indexing_duration_ms:u.z.number().int(),search_duration_ms:u.z.number().int(),gap_duration_s:u.z.number().int(),security_status:u.z.string(),security_message:u.z.string(),backfill:u.z.object({from:u.z.string().datetime(),to:u.z.string().datetime()}).optional()}),T=u.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);T.enum,u.z.object({start:u.z.string().datetime(),end:u.z.string().datetime(),query_text:u.z.string().optional().default(""),status_filters:Object(c.a)(v.a).optional().default([]),run_type_filters:Object(c.a)(h).optional().default([]),sort_field:T.optional().default("timestamp"),sort_order:g.a.optional().default("desc"),page:u.z.coerce.number().int().optional().default(1),per_page:u.z.coerce.number().int().optional().default(20)}),u.z.object({ruleId:u.z.string().min(1)}),u.z.object({events:u.z.array(j).optional(),total:u.z.number().int().optional()});var O=n(5);O.Lb,O.Lb,O.Lb;const x=`${O.Lb}/health/_setup`,S=(O.Lb,e=>`${O.Lb}/rules/${e}/execution/events`),k=(O.Lb,e=>`${O.Lb}/rules/${e}/execution/results`);n(465);let C=function(e){return e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off",e}({});n(227),n(464);const w=d.options},347:function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(892))},348:function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},356:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(44);const i=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},l=["http:","https:"],r=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(l.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function o(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},362:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return j}));var a=n(2),i=n.n(a),l=n(41),r=n.n(l);const o=r.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(l.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(l.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));o.displayName="Bar";const s=r.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(l.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(l.css)(["flex:1;"]))));s.displayName="BarSection";const u=r.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(l.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(l.css)(["flex:1;"]))));u.displayName="BarGroup";const c=r.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(l.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));c.displayName="BarText";const d=r.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(l.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const m=r.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(l.css)(["flex:1;"])));m.displayName="BarSpacer";const p=i.a.memo((({border:e,children:t})=>i.a.createElement(o,{border:e},t)));p.displayName="UtilityBar";var b=n(19),f=n(907);const g=r()(b.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(l.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),y=i.a.memo((({children:e,color:t,iconSide:n,iconSize:l,iconType:r,popoverContent:o,disabled:s,ownFocus:u,dataTestSubj:c,popoverPanelPaddingSize:d,onClick:m})=>{const[p,g]=Object(a.useState)(!1),y=Object(a.useCallback)((()=>g(!1)),[g]),v=Object(a.useCallback)((()=>{null==m||m(),g(!p)}),[p,m]);return i.a.createElement(b.EuiPopover,{ownFocus:u,panelPaddingSize:d,button:i.a.createElement(f.a,{dataTestSubj:c,color:t,iconSide:n,iconSize:l,iconType:r,disabled:s,onClick:v},e),closePopover:y,isOpen:p,repositionOnScroll:!0},null==o?void 0:o(y))}));y.displayName="Popover";const v=i.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:l,iconSide:r,iconSize:o,iconType:s,ownFocus:u,onClick:c,popoverContent:m,popoverPanelPaddingSize:p,inProgress:b})=>b?i.a.createElement(d,null,i.a.createElement(g,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):i.a.createElement(d,{"data-test-subj":n},m?i.a.createElement(y,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:r,iconSize:o,iconType:s,ownFocus:u,popoverPanelPaddingSize:p,popoverContent:m,onClick:c},e):i.a.createElement(f.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:l,iconSide:r,iconSize:o,iconType:s,onClick:c},e))));v.displayName="UtilityBarAction";const h=i.a.memo((({grow:e,children:t})=>i.a.createElement(u,{grow:e},t)));h.displayName="UtilityBarGroup";const E=i.a.memo((({grow:e,children:t,dataTestSubj:n})=>i.a.createElement(s,{grow:e,"data-test-subj":n},t)));E.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(m,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const j=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1,className:a})=>i.a.createElement(c,{"data-test-subj":t,shouldWrap:n,className:a},e)));j.displayName="UtilityBarText"},363:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return _}));var a=n(119),i=n.n(a),l=n(19),r=n(128),o=n(2),s=n.n(o),u=n(75),c=n(45),d=n(41),m=n.n(d),p=n(1630),b=n(337),f=n(171),g=n(424),y=n(149),v=n(173),h=n(131),E=n(857),j=n(915);const T=s.a.memo((({dataProvider:e,scopeId:t=y.f.active,children:n,hideTopN:a=!1})=>{const{timelineId:i}=Object(o.useContext)(E.b),{tableId:l}=Object(o.useContext)(j.b),r=Object(o.useMemo)((()=>{var e;return Object(h.getSourcererScopeId)(null!==(e=null!=t?t:i)&&void 0!==e?e:l)}),[t,l,i]),u=Object(o.useMemo)((()=>{const{value:t,field:n}=e.queryMatch;return{value:t||[],field:n}}),[e.queryMatch]),c=Object(o.useMemo)((()=>a?[v.b.SHOW_TOP_N]:[]),[a]);return s.a.createElement(v.c,{mode:v.a.HOVER_DOWN,visibleCellActions:6,showActionTooltips:!0,triggerId:v.d.DEFAULT,data:u,disabledActionTypes:c,sourcererScopeId:r,metadata:{scopeId:t}},n)}));T.displayName="CellActionsWrapper";var O=n(222),x=n(657),S=n(720);const k=m.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);k.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends s.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const C=m.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));C.displayName="Wrapper";const w=m.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),I=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,M=s.a.memo((({dataProvider:e,render:t,scopeId:n,truncate:a,hideTopN:d})=>{const[m,p]=Object(o.useState)(!1),y=e.id.includes(`-${f.a}-`),v=Object(c.useDispatch)(),h=Object(o.useCallback)((()=>{y||(v(b.a.registerProvider({provider:e})),p(!0))}),[y,v,e]),E=Object(o.useCallback)((()=>m&&v(b.a.unRegisterProvider({id:e.id}))),[m,v,e.id]);Object(o.useEffect)((()=>()=>{E()}),[E]);const j=Object(o.useCallback)(((n,a)=>s.a.createElement(N,{registerProvider:h},s.a.createElement("div",i()({},n.draggableProps,n.dragHandleProps,{style:I(n.draggableProps.style,a),ref:n.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),s.a.createElement(w,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,a))))),[e,h,t]),k=Object(o.useCallback)(((n,r)=>s.a.createElement(x.a,i()({},n.draggableProps,n.dragHandleProps,{ref:e=>{n.innerRef(e)},"data-test-subj":"providerContainer",isDragging:r.isDragging,registerProvider:h,tabIndex:-1}),s.a.createElement(l.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},s.a.createElement("p",null,e.queryMatch.field)),a&&!r.isDragging?s.a.createElement(g.b,{"data-test-subj":"draggable-truncatable-content"},t(e,n,r)):s.a.createElement(w,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,r)),!r.isDragging&&s.a.createElement(l.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},s.a.createElement("p",null,S.b)))),[e,h,t,a]),M=Object(o.useCallback)((t=>s.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),s.a.createElement("div",{className:r.a,"data-test-subj":"draggableWrapperKeyboardHandler",role:"button",tabIndex:0},s.a.createElement(u.Draggable,{draggableId:Object(O.k)(e.id),index:0,key:Object(O.k)(e.id),isDragDisabled:y},k)),t.placeholder)),[k,e.id,y]),_=Object(o.useMemo)((()=>s.a.createElement(C,{"data-test-subj":"draggableWrapperDiv",disabled:y},s.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,s.a.createElement(u.Droppable,{isDropDisabled:!0,droppableId:Object(O.l)(e.id),renderClone:j},M)))),[M,j,e.id,y]);return y?s.a.createElement(s.a.Fragment,null,_):s.a.createElement(T,{dataProvider:e,scopeId:n,hideTopN:d},_)}));M.displayName="DraggableOnWrapper";const _=s.a.memo((({dataProvider:e,isDraggable:t=!1,render:n,scopeId:a,truncate:i,hideTopN:l})=>{const r=Object(o.useMemo)((()=>s.a.createElement("div",{tabIndex:-1,"data-provider-id":Object(O.k)(e.id)},i?s.a.createElement(g.b,{"data-test-subj":"render-truncatable-content"},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):s.a.createElement(w,{"data-test-subj":`render-content-${e.queryMatch.field}`},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,n,i]);return t?s.a.createElement(M,{dataProvider:e,render:n,scopeId:a,truncate:i}):(u=a,[p.b.rulePreview,f.a].includes(null!=u?u:"")?s.a.createElement(s.a.Fragment,null,r):s.a.createElement(T,{dataProvider:e,scopeId:a,hideTopN:l},r));var u}));_.displayName="DraggableWrapper";const N=s.a.memo((({children:e,registerProvider:t})=>(Object(o.useEffect)((()=>{t()}),[t]),s.a.createElement(s.a.Fragment,null,e))));N.displayName="ConditionalPortal"},365:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(19),i=n(2),l=n.n(i),r=n(42),o=n(121),s=n(149),u=n(651);const c={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:u.o,content:l.a.createElement(a.EuiText,null,l.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:l.a.createElement(a.EuiCode,null,u.i),openButton:l.a.createElement(a.EuiCode,null,u.k)}})),anchor:c.ACTION_MENU},{title:u.a,content:l.a.createElement(a.EuiText,null,l.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:c.ADD_TO_FAVORITES},{timelineTab:s.g.query,title:u.b,content:l.a.createElement(a.EuiText,null,l.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:l.a.createElement(a.EuiCode,null," ",u.e)}})),anchor:c.DATA_VIEW},{timelineType:o.m.default,timelineTab:s.g.query,title:u.d,content:l.a.createElement(a.EuiText,null,u.c),anchor:c.DATA_PROVIDER},{title:u.m,content:l.a.createElement(a.EuiText,null,l.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:l.a.createElement(a.EuiCode,null,u.l),editButton:l.a.createElement(a.EuiCode,null,u.f)}})),anchor:c.SAVE_TIMELINE}],m={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:u.n}},374:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(120),i=n(199);const l=a.z.object({id:a.z.string().optional(),rule_id:i.P.optional(),list_id:a.z.string().min(1).optional(),item_id:a.z.string().min(1).optional(),error:a.z.object({status_code:a.z.number().int().min(400),message:a.z.string()})}).strict()},375:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(409),i=n(580),l=n(207);const r=e=>`${Object(l.a)(e)}`,o=(e,t,n,r=i.a.events)=>`/ip/${e}/${t||a.a.source}/${r}${Object(l.a)(n)}`},376:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(44);const i=e=>Object(a.isString)(e)?e:JSON.stringify(e)},377:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(2),i=n(45),l=n(4),r=n(1341),o=n(748),s=n(1334),u=n(1491),c=n(122),d=n(213),m=n(118),p=n(146),b=n(121),f=n(129),g=n(817),y=n(556),v=n(331),h=n(172),E=n(131),j=n(123),T=n(187),O=n(219),x=n(274),S=n(243);const k=({ecsRowData:e,onInvestigateInTimelineAlertClick:t})=>{const{addError:n}=Object(j.a)(),{data:{search:k}}=Object(m.j)().services,C=Object(i.useDispatch)(),{startTransaction:w}=Object(T.b)(),{services:I}=Object(m.j)(),{getExceptionFilterFromIds:M}=Object(u.a)(I.http),_=Object(a.useCallback)((async e=>{const t=(e=>{var t;let n=null!==(t=Object(E.getField)(e,r.i))&&void 0!==t?t:[],a=[];try{if(Array.isArray(n)&&0===n.length){var i;const t=null!==(i=Object(E.getField)(e,o.t))&&void 0!==i?i:{};if(t.length>0){var l;const e=JSON.parse(t[0]);n=null!==(l=null==e?void 0:e.exceptions_list)&&void 0!==l?l:[]}}else if(n&&n.list_id)return n.list_id.map(((e,t)=>{const a=n.type[t];return{exception_list_id:e,namespace_type:n.namespace_type[t],type:a}})).filter((e=>e.type===s.a.DETECTION))}catch(e){}return a=n.reduce(((e,t)=>{try{const n="string"==typeof t?JSON.parse(t):t;if(n.type===s.a.DETECTION){const t={exception_list_id:n.list_id,namespace_type:n.namespace_type};e.push(t)}}catch{}return e}),[]),a})(e);let a;return t.length>0&&await M({exceptionListIds:t,excludeExceptions:!0,chunkSize:20,alias:"Exceptions",onSuccess:e=>{a=e},onError:e=>{n(e,{title:l.i18n.translate("xpack.securitySolution.detectionEngine.alerts.fetchExceptionFilterFailure",{defaultMessage:"Error fetching exception filter."})})}}),a}),[n,M]),N=Object(a.useCallback)((e=>C(f.a.updateIsLoading(e))),[C]),D=Object(v.a)({timelineId:p.c.active,timelineType:b.m.default}),A=Object(c.a)("unifiedComponentsInTimelineDisabled"),R=Object(y.a)(),F=Object(a.useCallback)((async({from:e,timeline:t,to:n,ruleNote:a})=>{var i;await D(),N({id:p.c.active,isLoading:!1}),R({duplicate:!0,from:e,id:p.c.active,notes:[],timeline:{...t,columns:A?S.b:x.a,indexNames:null!==(i=t.indexNames)&&void 0!==i?i:[],show:!0,excludedRowRendererIds:A||t.timelineType===b.m.template?[]:t.excludedRowRendererIds},to:n,ruleNote:a})}),[R,N,D,A]),z=Object(a.useCallback)((async()=>{Object(d.a)(),w({name:O.a.INVESTIGATE_IN_TIMELINE}),t&&t(),null!=e&&await Object(g.b)({createTimeline:F,ecsData:e,searchStrategyClient:k,updateTimelineIsLoading:N,getExceptionFilter:_})}),[w,F,e,t,k,N,_]);return{investigateInTimelineActionItems:Object(a.useMemo)((()=>[{key:"investigate-in-timeline-action-item","data-test-subj":"investigate-in-timeline-action-item",disabled:null==e,onClick:z,name:h.i}]),[e,z]),investigateInTimelineAlertClick:z}}},378:function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"j",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return y})),n.d(t,"g",(function(){return v}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),y=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),v=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},394:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return j}));var a=n(19),i=n(2),l=n.n(i),r=n(41),o=n.n(r),s=n(197),u=n(300),c=n(4);const d=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),m=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),p=o()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),b=o.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),f=o.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),g=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(i.useState)(null),[r,o]=(e=>{const[t,n]=Object(i.useState)(null),a=Object(i.useRef)(null);return Object(i.useEffect)((()=>{var e,t,i,l,r,o,s,u,c;null!=(null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==a||null===(i=a.current)||void 0===i?void 0:i.scrollHeight)&&void 0!==t?t:0)>(null!==(l=null==a||null===(r=a.current)||void 0===r?void 0:r.clientHeight)&&void 0!==l?l:0)&&n(!0),(null!==(o=null===(s=a.current)||void 0===s?void 0:s.scrollHeight)&&void 0!==o?o:0)<=(null!==(u=null==a||null===(c=a.current)||void 0===c?void 0:c.clientHeight)&&void 0!==u?u:0)&&n(!1))}),[a,e]),[t,a]})(e),s=Object(i.useCallback)((()=>{a((e=>!e))}),[]);return n?l.a.createElement(l.a.Fragment,null,l.a.createElement(b,{"data-test-subj":"expanded-line-clamp"},l.a.createElement("p",null,e)),r&&l.a.createElement(p,{onClick:s,size:"s","data-test-subj":"summary-view-readmore"},m)):l.a.createElement(l.a.Fragment,null,null==r||!0===r?l.a.createElement(f,{"data-test-subj":"styled-line-clamp",ref:o,lineClampHeight:t},e):e,r&&l.a.createElement(p,{onClick:s,size:"s","data-test-subj":"summary-view-readmore"},d))},y=l.a.memo(g),v=o.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),h=Object(i.createContext)({}),E=({basicData:e,ruleNote:t,showFullView:n=!1,showTitle:i=!0})=>l.a.createElement(h.Provider,{value:e},i&&l.a.createElement(l.a.Fragment,null,l.a.createElement(a.EuiSpacer,{size:"l"}),l.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},l.a.createElement("h5",null,s.q)),l.a.createElement(a.EuiSpacer,{size:"s"})),l.a.createElement(v,null,n?l.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},l.a.createElement(u.b,null,t)):l.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},l.a.createElement(y,{lineClampHeight:4.5},l.a.createElement(u.b,null,t))))),j=l.a.memo(E)},404:function(e,t,n){"use strict";n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return i})),n.d(t,"NetworkDetailsTableType",(function(){return l}));let a=function(e){return e.page="page",e.details="details",e}({}),i=function(e){return e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies",e}({}),l=function(e){return e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies",e}({})},415:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(5);const i=`${a.qb}/prepackaged`,l=`${a.Lb}/prebuilt_rules`,r=`${i}/_status`,o=`${l}/status`,s=`${l}/upgrade/_review`,u=`${l}/upgrade/_perform`,c=`${l}/installation/_review`,d=`${l}/installation/_perform`},416:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(44),i=n(2),l=n.n(i),r=n(179),o=n(961);const s=l.a.memo((({dataProvider:e})=>{var t;const[n,s]=Object(i.useState)(!1);return l.a.createElement(o.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:s,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||r.d,type:e.type||r.a.default})}));s.displayName="Provider"},417:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(282),l=n(124),r=n(148);const o=({visualizationId:e})=>{const t=Object(a.useMemo)((()=>r.d.globalQueryByIdSelector()),[]),{inspect:n,loading:o,searchSessionId:s}=Object(l.a)((n=>t(n,e)));return Object(a.useMemo)((()=>({requests:n?Object(i.g)(null==n?void 0:n.dsl):null,responses:n?Object(i.g)(null==n?void 0:n.response):null,loading:o,searchSessionId:s})),[n,o,s])}},424:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(119),i=n.n(a),l=n(2),r=n.n(l),o=n(41),s=n.n(o),u=n(19);const c=s.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?r.a.createElement(u.EuiToolTip,{display:"block",content:e},r.a.createElement(c,i()({"data-test-subj":n},a),t)):r.a.createElement(c,i()({"data-test-subj":n},a),t)}c.displayName="EllipsisText"},431:function(e,t){const n=Object.freeze({loose:!0}),a=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:a},432:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),l=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),r=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),s=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),u=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),c=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},433:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return r}));var a=n(44);const i=e=>e.replace(/:/g,"-"),l=e=>e.replace(/-/g,":"),r=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e)},440:function(e,t,n){"use strict";n.d(t,"d",(function(){return b.d})),n.d(t,"a",(function(){return b.a})),n.d(t,"f",(function(){return b.f})),n.d(t,"c",(function(){return b.c})),n.d(t,"e",(function(){return b.e})),n.d(t,"b",(function(){return b.b})),n.d(t,"g",(function(){return K}));var a=n(120);a.z.object({rules_custom_installed:a.z.number().int().min(0),rules_installed:a.z.number().int().min(0),rules_not_installed:a.z.number().int().min(0),rules_not_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_not_installed:a.z.number().int().min(0),timelines_not_updated:a.z.number().int().min(0)}).strict(),a.z.object({rules_installed:a.z.number().int().min(0),rules_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_updated:a.z.number().int().min(0)}).strict();var i=n(46);const l=i.exact(i.type({rule_id:i.string,version:i.number})),r=i.exact(i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(l)})),o=i.exact(i.type({mode:i.literal("ALL_RULES")}));i.union([o,r]);var s=n(2074);let u=function(e){return e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET",e}({});const c=Object(s.a)("PickVersionValues",u),d=i.exact(i.intersection([i.type({rule_id:i.string,revision:i.number,version:i.number}),i.partial({pick_version:c})])),m=i.exact(i.intersection([i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(d)}),i.partial({pick_version:c})])),p=i.exact(i.intersection([i.type({mode:i.literal("ALL_RULES")}),i.partial({pick_version:c})]));i.union([p,m]);var b=n(415),f=n(439);const g=e=>i.intersection([i.exact(i.type(e.required)),i.exact(i.type(Object(f.N)(e.optional)))]);var y=n(2076),v=n(425);let h=function(e){return e.index_patterns="index_patterns",e.data_view="data_view",e}({});const E=i.exact(i.type({type:i.literal(h.index_patterns),index_patterns:f.g})),j=i.exact(i.type({type:i.literal(h.data_view),data_view_id:f.c})),T=i.union([E,j]);let O=function(e){return e.inline_query="inline_query",e.saved_query="saved_query",e}({});const x=i.exact(i.type({type:i.literal(O.inline_query),query:f.w,language:f.i,filters:f.q})),S=i.exact(i.type({type:i.literal(O.saved_query),saved_query_id:v.b})),k=i.union([x,S]),C=i.exact(i.type({query:f.w,language:i.literal("eql"),filters:f.q})),w=i.exact(i.type({query:f.w,language:i.literal("esql")})),I=i.exact(i.type({interval:Object(y.a)({allowedUnits:["s","m","h"]}),lookback:Object(y.a)({allowedUnits:["s","m","h"]})})),M=i.exact(i.type({field_name:f.u})),_=i.exact(i.type({field_name:f.L,fallback_disabled:f.M})),N=i.exact(i.type({timeline_id:f.I,timeline_title:f.J})),D=i.exact(i.type({type:f.b}));var A=n(1781),R=n(2079),F=n(1780),z=n(2077),P=n(2131),L=n(1782),B=n(2137),q=n(2138);const $=g({required:{rule_id:f.y,version:f.A,meta:f.s,name:f.t,tags:f.z,description:f.o,severity:A.a,severity_mapping:R.a,risk_score:F.a,risk_score_mapping:z.a,references:f.x,false_positives:f.p,threat:f.F,note:f.h,setup:f.E,related_integrations:f.l,required_fields:f.m,author:f.n,license:f.r,rule_schedule:I,actions:P.a,throttle:L.a,exceptions_list:f.e,max_signals:f.j},optional:{rule_name_override:M,timestamp_override:_,timeline_template:N,building_block:D}}),V=g({required:{type:i.literal("query"),kql_query:k},optional:{data_source:T,alert_suppression:f.a}}),G=g({required:{type:i.literal("saved_query"),kql_query:k},optional:{data_source:T,alert_suppression:f.a}}),U=g({required:{type:i.literal("eql"),eql_query:C},optional:{data_source:T,event_category_override:f.d,timestamp_field:f.K,tiebreaker_field:f.H}}),H=g({required:{type:i.literal("esql"),esql_query:w},optional:{}}),Q=g({required:{type:i.literal("threat_match"),kql_query:k,threat_query:x,threat_index:B.e,threat_mapping:B.g},optional:{data_source:T,threat_indicator_path:B.f,concurrent_searches:B.a,items_per_search:B.b}}),W=g({required:{type:i.literal("threshold"),kql_query:k,threshold:f.G},optional:{data_source:T}}),J=g({required:{type:i.literal("machine_learning"),machine_learning_job_id:q.a,anomaly_threshold:v.a},optional:{}}),X=g({required:{type:i.literal("new_terms"),kql_query:x,new_terms_fields:f.k,history_window_start:f.f},optional:{data_source:T}});i.intersection([$,i.union([V,G,U,H,Q,W,J,X])]),n(7),Symbol("MissingVersion");let K=function(e){return e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C",e}({})},446:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a,i=n(2),l=n(66),r=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o="html",s="svg",u=function(e,t){var n,a,i,l={};if(e===o)i=document.createElement("div");else{if(e!==s)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var r=0,u=Object.entries(t.attributes);r<u.length;r++){var c=u[r],d=c[0],m=c[1];i.setAttribute(d,m)}var p={element:i,elementType:e,setPortalProps:function(e){l=e},getInitialPortalProps:function(){return l},mount:function(t,i){if(i!==a){if(p.unmount(),t!==n&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===s)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(p.element,i),n=t,a=i}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,p.element),n=void 0,a=void 0)}};return p},c=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return r(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return l.createPortal(i.Children.map(n,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(i.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=i.createRef(),n.passPropsThroughPortal(),n}return r(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),m=u.bind(null,o);u.bind(null,s)},447:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(45),l=n(138),r=n(124),o=n(148),s=n(200);const u=({inputId:e=l.a.global,inspectIndex:t=0,isDisabled:n,multiple:u=!1,onClick:c,onCloseInspect:d,queryId:m})=>{const p=Object(i.useDispatch)(),b=Object(a.useMemo)((()=>o.d.globalQueryByIdSelector()),[]),f=Object(a.useMemo)((()=>o.d.timelineQueryByIdSelector()),[]),{loading:g,inspect:y,selectedInspectIndex:v,isInspected:h,searchSessionId:E}=Object(r.a)((t=>e===l.a.global?b(t,m):f(t,m))),j=Object(a.useCallback)((()=>{c&&c(),p(s.c.setInspectionParameter({id:m,inputId:e,isInspected:!0,selectedInspectIndex:t,searchSessionId:E}))}),[c,p,m,e,t,E]),T=Object(a.useCallback)((()=>{null!=d&&d(),p(s.c.setInspectionParameter({id:m,inputId:e,isInspected:!1,selectedInspectIndex:t,searchSessionId:E}))}),[d,p,m,e,t,E]),O=Object(a.useMemo)((()=>null!=y&&y.dsl.length>0?u?y.dsl[0]:y.dsl[t]:null),[t,u,y]),x=Object(a.useMemo)((()=>u?null==y?void 0:y.dsl.slice(1):null),[u,y]),S=Object(a.useMemo)((()=>null!=y&&y.response.length>0?u?y.response[0]:y.response[t]:null),[t,u,y]),k=Object(a.useMemo)((()=>u?null==y?void 0:y.response.slice(1):null),[u,y]),C=Object(a.useMemo)((()=>!g&&v===t&&h),[t,h,g,v]);return{additionalRequests:x,additionalResponses:k,handleClick:j,handleCloseModal:T,isButtonDisabled:Object(a.useMemo)((()=>g||n||null==O||null==S||null==m),[n,g,m,O,S]),isShowingModal:C,loading:g,request:O,response:S}}},448:function(e,t,n){"use strict";e.exports=n(1084)},452:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(2),i=n.n(a);const l=i.a.createContext(null),r=Object(a.memo)((({upsellingService:e,children:t})=>i.a.createElement(l.Provider,{value:e},t)));r.displayName="UpsellingProvider";const o=()=>{const e=Object(a.useContext)(l);if(!e)throw new Error("UpsellingProviderContext not found");return e}},463:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return g}));var a=n(120);const i=a.z.enum([".osquery",".endpoint"]),l=i.enum,r=a.z.object({}).catchall(a.z.object({field:a.z.string().optional(),value:a.z.union([a.z.string(),a.z.array(a.z.string())]).optional()})),o=a.z.object({id:a.z.string(),query:a.z.string(),ecs_mapping:r.optional(),version:a.z.string().optional(),platform:a.z.string().optional(),removed:a.z.boolean().optional(),snapshot:a.z.boolean().optional()}),s=a.z.object({query:a.z.string().optional(),ecs_mapping:r.optional(),queries:a.z.array(o).optional(),pack_id:a.z.string().optional(),saved_query_id:a.z.string().optional(),timeout:a.z.number().optional()}),u=a.z.object({query:a.z.string().optional(),ecsMapping:r.optional(),queries:a.z.array(o).optional(),packId:a.z.string().optional(),savedQueryId:a.z.string().optional(),timeout:a.z.number().optional()}),c=a.z.object({action_type_id:a.z.literal(".osquery"),params:s}),d=a.z.object({actionTypeId:a.z.literal(".osquery"),params:u}),m=a.z.object({command:a.z.literal("isolate"),comment:a.z.string().optional()}),p=a.z.object({command:a.z.enum(["kill-process","suspend-process"]),comment:a.z.string().optional(),config:a.z.object({field:a.z.string(),overwrite:a.z.boolean().optional().default(!0)})}),b=a.z.object({action_type_id:a.z.literal(".endpoint"),params:a.z.union([m,p])}),f=a.z.object({actionTypeId:a.z.literal(".endpoint"),params:a.z.union([m,p])}),g=a.z.union([c,b]);a.z.union([d,f])},464:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(120),i=n(281),l=n(465);const r=a.z.object({last_execution:a.z.object({date:a.z.string().datetime(),status:i.a,status_order:i.c,message:a.z.string(),metrics:l.a})})},465:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);const i=a.z.object({total_search_duration_ms:a.z.number().int().min(0).optional(),total_indexing_duration_ms:a.z.number().int().min(0).optional(),total_enrichment_duration_ms:a.z.number().int().min(0).optional(),execution_gap_duration_s:a.z.number().int().min(0).optional()})},466:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return r}));var a=n(120);const i=a.z.string(),l=a.z.string(),r=a.z.string()},467:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(120),i=n(199);const l=a.z.array(a.z.object({field:a.z.string(),value:a.z.number().int().min(0)})),r=a.z.number().int().min(1),o=a.z.union([a.z.string(),a.z.array(a.z.string())]),s=a.z.array(a.z.string()),u=a.z.object({field:o,value:r,cardinality:l.optional()}),c=(a.z.object({field:s,value:r,cardinality:l.optional()}),a.z.object({field:s,value:r,cardinality:l}),a.z.object({duration:i.b}))},468:function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(120),i=n(268);const l=a.z.string(),r=a.z.array(a.z.object({entries:a.z.array(a.z.object({field:i.a,type:a.z.literal("mapping"),value:i.a}))})).min(1),o=a.z.array(a.z.string()),s=a.z.array(a.z.unknown()),u=a.z.string(),c=a.z.number().int().min(1),d=a.z.number().int().min(1)},469:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l}));var a=n(120);const i=a.z.number().int().min(0),l=a.z.union([a.z.string(),a.z.array(a.z.string()).min(1)])},470:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return r}));var a=n(120),i=n(268);const l=a.z.array(a.z.string()).min(1).max(3),r=i.a},471:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(120);const i=a.z.number().int().min(1),l=a.z.number().int().min(0),r=a.z.object({page:i,per_page:l,total:a.z.number().int().min(0)})},472:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);const i=a.z.object({type:a.z.string(),message:a.z.string(),actionPath:a.z.string(),buttonLabel:a.z.string().optional()})},473:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return l}));var a=n(5);const i=`${a.Lb}/rules/_rule_management_filters`,l=`${a.Lb}/rules/_coverage_overview`},474:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(19),i=n(60),l=n.n(i),r=n(2),o=n.n(r),s=n(41),u=n.n(s),c=n(48),d=n(5),m=n(650),p=n(575),b=n(132),f=n(127);const g=u()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));height:41vh;.euiModal__flex{width:60vw;}[role='tabpanel']{height:calc(41vh - 208px) !important;}"]);g.displayName="MyEuiModal";const y=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},v=(e=[])=>1===e.length&&e[0]===d.hc?o.a.createElement("i",null,m.f):e.length>0?e.filter((e=>e!==d.hc)).join(", "):m.k,h=({adHocDataViews:e,additionalRequests:t,additionalResponses:n,closeModal:i,inputId:s,request:u,response:d,title:h})=>{const{pathname:E}=Object(c.useLocation)(),{selectedPatterns:j}=Object(b.a)("timeline"===s?f.SourcererScopeName.timeline:Object(p.a)(E)),T=Object(r.useMemo)((()=>[u,...null!=t?t:[]]),[u,t]),O=Object(r.useMemo)((()=>[d,...null!=n?n:[]]),[d,n]),x=Object(r.useMemo)((()=>y(T)),[T]),S=Object(r.useMemo)((()=>y(O)),[O]),k=Object(r.useMemo)((()=>{var e,t;return(null!==(e=null===(t=x[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>j.includes(e.trim())))}),[x,j]),C=Object(r.useMemo)((()=>{var t,n,i,r;return[{title:o.a.createElement("span",{"data-test-subj":"index-pattern-title"},m.b," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.c,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"index-pattern-description"},o.a.createElement("p",null,v(null!=e&&e.length>0?e:null!==(t=null===(n=x[0])||void 0===n?void 0:n.index)&&void 0!==t?t:[])),!k&&o.a.createElement("p",null,o.a.createElement("small",null,o.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},m.e))))},{title:o.a.createElement("span",{"data-test-subj":"query-time-title"},m.g," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.h,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(i=S[0])||void 0===i?void 0:i.took)?"0ms":null!==(r=S[0])&&void 0!==r&&r.took?`${l()(S[0].took).format("0,0")}ms`:m.k)},{title:o.a.createElement("span",{"data-test-subj":"request-timestamp-title"},m.i," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.j,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}]}),[e,x,S,k]),w=Object(r.useMemo)((()=>[{id:"statistics",name:"Statistics","data-test-subj":"modal-inspect-statistics-tab",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiDescriptionList,{listItems:C,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request","data-test-subj":"modal-inspect-request-tab",content:x.length>0?x.map(((e,t)=>o.a.createElement(r.Fragment,{key:t},o.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-request-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return m.k}})(e.body))))):o.a.createElement(a.EuiCodeBlock,null,m.k)},{id:"response",name:"Response","data-test-subj":"modal-inspect-response-tab",content:S.length>0?O.map(((e,t)=>o.a.createElement(r.Fragment,{key:t},o.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-response-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},e)))):o.a.createElement(a.EuiCodeBlock,null,m.k)}]),[x,S,O,C]);return o.a.createElement(g,{onClose:i,"data-test-subj":"modal-inspect-euiModal"},o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,m.d," ",h)),o.a.createElement(a.EuiModalBody,null,o.a.createElement(a.EuiTabbedContent,{tabs:w,initialSelectedTab:w[0],autoFocus:"selected"})),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButton,{onClick:i,fill:!0,"data-test-subj":"modal-inspect-close"},m.a)))}},476:function(e,t,n){e.exports=n(35)(1029)},477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=(a=n(2))&&"object"==typeof a&&"default"in a?a:{default:a},l=e=>"checkbox"===e.type,r=e=>e instanceof Date,o=e=>null==e;const s=e=>"object"==typeof e;var u=e=>!o(e)&&!Array.isArray(e)&&s(e)&&!r(e),c=e=>u(e)&&e.target?l(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),m="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function p(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(m&&(e instanceof Blob||e instanceof FileList)||!n&&!u(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return u(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=p(e[n]));else t=e}return t}var b=e=>Array.isArray(e)?e.filter(Boolean):[],f=e=>void 0===e,g=(e,t,n)=>{if(!t||!u(e))return n;const a=b(t.split(/[,[\].]+?/)).reduce(((e,t)=>o(e)?e:e[t]),e);return f(a)||a===e?f(e[t])?n:e[t]:a};const y="blur",v="onChange",h="onSubmit",E="all",j="pattern",T="required",O=i.default.createContext(null),x=()=>i.default.useContext(O);var S=(e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(i,l,{get:()=>{const i=l;return t._proxyFormState[i]!==E&&(t._proxyFormState[i]=!a||E),n&&(n[i]=!0),e[i]}});return i},k=e=>u(e)&&!Object.keys(e).length,C=(e,t,n,a)=>{n(e);const{name:i,...l}=e;return k(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find((e=>t[e]===(!a||E)))},w=e=>Array.isArray(e)?e:[e],I=(e,t,n)=>n&&t?e===t:!e||!t||e===t||w(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function M(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function _(e){const t=x(),{control:n=t.control,disabled:a,name:l,exact:r}=e||{},[o,s]=i.default.useState(n._formState),u=i.default.useRef(!0),c=i.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(l);return d.current=l,M({disabled:a,next:e=>u.current&&I(d.current,e.name,r)&&C(e,c.current,n._updateFormState)&&s({...n._formState,...e}),subject:n._subjects.state}),i.default.useEffect((()=>(u.current=!0,c.current.isValid&&n._updateValid(!0),()=>{u.current=!1})),[n]),S(o,n,c.current,!1)}var N=e=>"string"==typeof e,D=(e,t,n,a,i)=>N(e)?(a&&t.watch.add(e),g(n,e,i)):Array.isArray(e)?e.map((e=>(a&&t.watch.add(e),g(n,e)))):(a&&(t.watchAll=!0),n);function A(e){const t=x(),{control:n=t.control,name:a,defaultValue:l,disabled:r,exact:o}=e||{},s=i.default.useRef(a);s.current=a,M({disabled:r,subject:n._subjects.values,next:e=>{I(s.current,e.name,o)&&c(p(D(s.current,n._names,e.values||n._formValues,!1,l)))}});const[u,c]=i.default.useState(n._getWatch(a,l));return i.default.useEffect((()=>n._removeUnmounted())),u}var R=e=>/^\w*$/.test(e),F=e=>b(e.replace(/["|']|\]/g,"").split(/\.|\[/));function z(e,t,n){let a=-1;const i=R(t)?[t]:F(t),l=i.length,r=l-1;for(;++a<l;){const t=i[a];let l=n;if(a!==r){const n=e[t];l=u(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}e[t]=l,e=e[t]}return e}function P(e){const t=x(),{name:n,control:a=t.control,shouldUnregister:l}=e,r=d(a._names.array,n),o=A({control:a,name:n,defaultValue:g(a._formValues,n,g(a._defaultValues,n,e.defaultValue)),exact:!0}),s=_({control:a,name:n}),u=i.default.useRef(a.register(n,{...e.rules,value:o}));return u.current=a.register(n,e.rules),i.default.useEffect((()=>{const e=a._options.shouldUnregister||l,t=(e,t)=>{const n=g(a._fields,e);n&&(n._f.mount=t)};if(t(n,!0),e){const e=p(g(a._options.defaultValues,n));z(a._defaultValues,n,e),f(g(a._formValues,n))&&z(a._formValues,n,e)}return()=>{(r?e&&!a._state.action:e)?a.unregister(n):t(n,!1)}}),[n,a,r,l]),{field:{name:n,value:o,onChange:i.default.useCallback((e=>u.current.onChange({target:{value:c(e),name:n},type:"change"})),[n]),onBlur:i.default.useCallback((()=>u.current.onBlur({target:{value:g(a._formValues,n),name:n},type:y})),[n,a]),ref:e=>{const t=g(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:s,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!g(s.errors,n)},isDirty:{enumerable:!0,get:()=>!!g(s.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!g(s.touchedFields,n)},error:{enumerable:!0,get:()=>g(s.errors,n)}})}}const L="post";var B=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{};const q=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=g(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else u(a)&&q(a,t)}}};var $=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},V=(e,t,n={})=>n.shouldFocus||f(n.shouldFocus)?n.focusName||`${e}.${f(n.focusIndex)?t:n.focusIndex}.`:"",G=e=>({isOnSubmit:!e||e===h,isOnBlur:"onBlur"===e,isOnChange:e===v,isOnAll:e===E,isOnTouch:"onTouched"===e}),U=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),H=(e,t,n)=>{const a=b(g(e,n));return z(a,"root",t[n]),z(e,n,a),e},Q=e=>"boolean"==typeof e,W=e=>"file"===e.type,J=e=>"function"==typeof e,X=e=>{if(!m)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},K=e=>N(e),Y=e=>"radio"===e.type,Z=e=>e instanceof RegExp;const ee={value:!1,isValid:!1},te={value:!0,isValid:!0};var ne=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!f(e[0].attributes.value)?f(e[0].value)||""===e[0].value?te:{value:e[0].value,isValid:!0}:te:ee}return ee};const ae={isValid:!1,value:null};var ie=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),ae):ae;function le(e,t,n="validate"){if(K(e)||Array.isArray(e)&&e.every(K)||Q(e)&&!e)return{type:n,message:K(e)?e:"",ref:t}}var re=e=>u(e)&&!Z(e)?e:{value:e,message:""},oe=async(e,t,n,a,i)=>{const{ref:r,refs:s,required:c,maxLength:d,minLength:m,min:p,max:b,pattern:y,validate:v,name:h,valueAsNumber:E,mount:O,disabled:x}=e._f,S=g(t,h);if(!O||x)return{};const C=s?s[0]:r,w=e=>{a&&C.reportValidity&&(C.setCustomValidity(Q(e)?"":e||""),C.reportValidity())},I={},M=Y(r),_=l(r),D=M||_,A=(E||W(r))&&f(r.value)&&f(S)||X(r)&&""===r.value||""===S||Array.isArray(S)&&!S.length,R=B.bind(null,h,n,I),F=(e,t,n,a="maxLength",i="minLength")=>{const l=e?t:n;I[h]={type:e?a:i,message:l,ref:r,...R(e?a:i,l)}};if(i?!Array.isArray(S)||!S.length:c&&(!D&&(A||o(S))||Q(S)&&!S||_&&!ne(s).isValid||M&&!ie(s).isValid)){const{value:e,message:t}=K(c)?{value:!!c,message:c}:re(c);if(e&&(I[h]={type:T,message:t,ref:C,...R(T,t)},!n))return w(t),I}if(!(A||o(p)&&o(b))){let e,t;const a=re(b),i=re(p);if(o(S)||isNaN(S)){const n=r.valueAsDate||new Date(S),l=e=>new Date((new Date).toDateString()+" "+e),o="time"==r.type,s="week"==r.type;N(a.value)&&S&&(e=o?l(S)>l(a.value):s?S>a.value:n>new Date(a.value)),N(i.value)&&S&&(t=o?l(S)<l(i.value):s?S<i.value:n<new Date(i.value))}else{const n=r.valueAsNumber||(S?+S:S);o(a.value)||(e=n>a.value),o(i.value)||(t=n<i.value)}if((e||t)&&(F(!!e,a.message,i.message,"max","min"),!n))return w(I[h].message),I}if((d||m)&&!A&&(N(S)||i&&Array.isArray(S))){const e=re(d),t=re(m),a=!o(e.value)&&S.length>+e.value,i=!o(t.value)&&S.length<+t.value;if((a||i)&&(F(a,e.message,t.message),!n))return w(I[h].message),I}if(y&&!A&&N(S)){const{value:e,message:t}=re(y);if(Z(e)&&!S.match(e)&&(I[h]={type:j,message:t,ref:r,...R(j,t)},!n))return w(t),I}if(v)if(J(v)){const e=le(await v(S,t),C);if(e&&(I[h]={...e,...R("validate",e.message)},!n))return w(e.message),I}else if(u(v)){let e={};for(const a in v){if(!k(e)&&!n)break;const i=le(await v[a](S,t),C,a);i&&(e={...i,...R(a,i.message)},w(i.message),n&&(I[h]=e))}if(!k(e)&&(I[h]={ref:C,...e},!n))return I}return w(!0),I};function se(e,t){return[...e,...w(t)]}var ue=e=>Array.isArray(e)?e.map((()=>{})):void 0;function ce(e,t,n){return[...e.slice(0,t),...w(n),...e.slice(t)]}var de=(e,t,n)=>Array.isArray(e)?(f(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function me(e,t){return[...w(t),...w(e)]}var pe=(e,t)=>f(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return b(a).length?a:[]}(e,w(t).sort(((e,t)=>e-t))),be=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function fe(e,t){const n=Array.isArray(t)?t:R(t)?[t]:F(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=f(e)?a++:e[t[a++]];return e}(e,n),i=n.length-1,l=n[i];return a&&delete a[l],0!==i&&(u(a)&&k(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!f(e[t]))return!1;return!0}(a))&&fe(e,n.slice(0,-1)),e}var ge=(e,t,n)=>(e[t]=n,e);function ye(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var ve=e=>o(e)||!s(e);function he(e,t){if(ve(e)||ve(t))return e===t;if(r(e)&&r(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(r(n)&&r(e)||u(n)&&u(e)||Array.isArray(n)&&Array.isArray(e)?!he(n,e):n!==e)return!1}}return!0}var Ee=e=>"select-multiple"===e.type,je=e=>X(e)&&e.isConnected,Te=e=>{for(const t in e)if(J(e[t]))return!0;return!1};function Oe(e,t={}){const n=Array.isArray(e);if(u(e)||n)for(const n in e)Array.isArray(e[n])||u(e[n])&&!Te(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Oe(e[n],t[n])):o(e[n])||(t[n]=!0);return t}function xe(e,t,n){const a=Array.isArray(e);if(u(e)||a)for(const a in e)Array.isArray(e[a])||u(e[a])&&!Te(e[a])?f(t)||ve(n[a])?n[a]=Array.isArray(e[a])?Oe(e[a],[]):{...Oe(e[a])}:xe(e[a],o(t)?{}:t[a],n[a]):n[a]=!he(e[a],t[a]);return n}var Se=(e,t)=>xe(e,t,Oe(t)),ke=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>f(e)?e:t?""===e?NaN:e?+e:e:n&&N(e)?new Date(e):a?a(e):e;function Ce(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return W(t)?t.files:Y(t)?ie(e.refs).value:Ee(t)?[...t.selectedOptions].map((({value:e})=>e)):l(t)?ne(e.refs).value:ke(f(t.value)?e.ref.value:t.value,e)}var we=e=>f(e)?e:Z(e)?e.source:u(e)?Z(e.value)?e.value.source:e.value:e;function Ie(e,t,n){const a=g(e,n);if(a||R(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),l=g(t,a),r=g(e,a);if(l&&!Array.isArray(l)&&n!==a)return{name:n};if(r&&r.type)return{name:a,error:r};i.pop()}return{name:n}}const Me={mode:h,reValidateMode:v,shouldFocusError:!0};function _e(e={},t){let n,a={...Me,...e},i={submitCount:0,isDirty:!1,isLoading:J(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},s={},v=(u(a.defaultValues)||u(a.values))&&p(a.defaultValues||a.values)||{},h=a.shouldUnregister?{}:p(v),j={action:!1,mount:!1,watch:!1},T={mount:new Set,unMount:new Set,array:new Set,watch:new Set},O=0;const x={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},S={values:ye(),array:ye(),state:ye()},C=e.resetOptions&&e.resetOptions.keepDirtyValues,I=G(a.mode),M=G(a.reValidateMode),_=a.criteriaMode===E,A=async e=>{if(x.isValid||e){const e=a.resolver?k((await B()).errors):await $(s,!0);e!==i.isValid&&S.state.next({isValid:e})}},R=e=>x.isValidating&&S.state.next({isValidating:e}),F=(e,t,n,a)=>{const i=g(s,e);if(i){const l=g(h,e,f(n)?g(v,e):n);f(l)||a&&a.defaultChecked||t?z(h,e,t?l:Ce(i._f)):Z(e,l),j.mount&&A()}},P=(e,t,n,a,l)=>{let r=!1,o=!1;const s={name:e};if(!n||a){x.isDirty&&(o=i.isDirty,i.isDirty=s.isDirty=V(),r=o!==s.isDirty);const n=he(g(v,e),t);o=g(i.dirtyFields,e),n?fe(i.dirtyFields,e):z(i.dirtyFields,e,!0),s.dirtyFields=i.dirtyFields,r=r||x.dirtyFields&&o!==!n}if(n){const t=g(i.touchedFields,e);t||(z(i.touchedFields,e,n),s.touchedFields=i.touchedFields,r=r||x.touchedFields&&t!==n)}return r&&l&&S.state.next(s),r?s:{}},L=(t,a,l,r)=>{const o=g(i.errors,t),s=x.isValid&&Q(a)&&i.isValid!==a;var u;if(e.delayError&&l?(u=()=>((e,t)=>{z(i.errors,e,t),S.state.next({errors:i.errors})})(t,l),n=e=>{clearTimeout(O),O=setTimeout(u,e)},n(e.delayError)):(clearTimeout(O),n=null,l?z(i.errors,t,l):fe(i.errors,t)),(l?!he(o,l):o)||!k(r)||s){const e={...r,...s&&Q(a)?{isValid:a}:{},errors:i.errors,name:t};i={...i,...e},S.state.next(e)}R(!1)},B=async e=>a.resolver(h,a.context,((e,t,n,a)=>{const i={};for(const n of e){const e=g(t,n);e&&z(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||T.mount,s,a.criteriaMode,a.shouldUseNativeValidation)),$=async(e,t,n={valid:!0})=>{for(const l in e){const r=e[l];if(r){const{_f:e,...l}=r;if(e){const l=T.array.has(e.name),o=await oe(r,h,_,a.shouldUseNativeValidation&&!t,l);if(o[e.name]&&(n.valid=!1,t))break;!t&&(g(o,e.name)?l?H(i.errors,o,e.name):z(i.errors,e.name,o[e.name]):fe(i.errors,e.name))}l&&await $(l,t,n)}}return n.valid},V=(e,t)=>(e&&t&&z(h,e,t),!he(ie(),v)),K=(e,t,n)=>D(e,T,{...j.mount?h:f(t)?v:N(e)?{[e]:t}:t},n,t),Z=(e,t,n={})=>{const a=g(s,e);let i=t;if(a){const n=a._f;n&&(!n.disabled&&z(h,e,ke(t,n)),i=X(n.ref)&&o(t)?"":t,Ee(n.ref)?[...n.ref.options].forEach((e=>e.selected=i.includes(e.value))):n.refs?l(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):n.refs[0]&&(n.refs[0].checked=!!i):n.refs.forEach((e=>e.checked=e.value===i)):W(n.ref)?n.ref.value="":(n.ref.value=i,n.ref.type||S.values.next({name:e,values:{...h}})))}(n.shouldDirty||n.shouldTouch)&&P(e,i,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ae(e)},ee=(e,t,n)=>{for(const a in t){const i=t[a],l=`${e}.${a}`,o=g(s,l);!T.array.has(e)&&ve(i)&&(!o||o._f)||r(i)?Z(l,i,n):ee(l,i,n)}},te=(e,n,a={})=>{const l=g(s,e),r=T.array.has(e),u=p(n);z(h,e,u),r?(S.array.next({name:e,values:{...h}}),(x.isDirty||x.dirtyFields)&&a.shouldDirty&&S.state.next({name:e,dirtyFields:Se(v,h),isDirty:V(e,u)})):!l||l._f||o(u)?Z(e,u,a):ee(e,u,a),U(e,T)&&S.state.next({...i}),S.values.next({name:e,values:{...h}}),!j.mount&&t()},ne=async e=>{const t=e.target;let l=t.name,r=!0;const o=g(s,l);if(o){let d,m;const p=t.type?Ce(o._f):c(e),b=e.type===y||"focusout"===e.type,f=!((u=o._f).mount&&(u.required||u.min||u.max||u.maxLength||u.minLength||u.pattern||u.validate)||a.resolver||g(i.errors,l)||o._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(b,g(i.touchedFields,l),i.isSubmitted,M,I),v=U(l,T,b);z(h,l,p),b?(o._f.onBlur&&o._f.onBlur(e),n&&n(0)):o._f.onChange&&o._f.onChange(e);const E=P(l,p,b,!1),j=!k(E)||v;if(!b&&S.values.next({name:l,type:e.type,values:{...h}}),f)return x.isValid&&A(),j&&S.state.next({name:l,...v?{}:E});if(!b&&v&&S.state.next({...i}),R(!0),a.resolver){const{errors:e}=await B([l]),t=Ie(i.errors,s,l),n=Ie(e,s,t.name||l);d=n.error,l=n.name,m=k(e)}else d=(await oe(o,h,_,a.shouldUseNativeValidation))[l],r=isNaN(p)||p===g(h,l,p),r&&(d?m=!1:x.isValid&&(m=await $(s,!0)));r&&(o._f.deps&&ae(o._f.deps),L(l,m,d,E))}var u},ae=async(e,t={})=>{let n,l;const r=w(e);if(R(!0),a.resolver){const t=await(async e=>{const{errors:t}=await B();if(e)for(const n of e){const e=g(t,n);e?z(i.errors,n,e):fe(i.errors,n)}else i.errors=t;return t})(f(e)?e:r);n=k(t),l=e?!r.some((e=>g(t,e))):n}else e?(l=(await Promise.all(r.map((async e=>{const t=g(s,e);return await $(t&&t._f?{[e]:t}:t)})))).every(Boolean),(l||i.isValid)&&A()):l=n=await $(s);return S.state.next({...!N(e)||x.isValid&&n!==i.isValid?{}:{name:e},...a.resolver||!e?{isValid:n}:{},errors:i.errors,isValidating:!1}),t.shouldFocus&&!l&&q(s,(e=>e&&g(i.errors,e)),e?r:T.mount),l},ie=e=>{const t={...v,...j.mount?h:{}};return f(e)?t:N(e)?g(t,e):e.map((e=>g(t,e)))},le=(e,t)=>({invalid:!!g((t||i).errors,e),isDirty:!!g((t||i).dirtyFields,e),isTouched:!!g((t||i).touchedFields,e),error:g((t||i).errors,e)}),re=(e,t,n)=>{const a=(g(s,e,{_f:{}})._f||{}).ref;z(i.errors,e,{...t,ref:a}),S.state.next({name:e,errors:i.errors,isValid:!1}),n&&n.shouldFocus&&a&&a.focus&&a.focus()},se=(e,t={})=>{for(const n of e?w(e):T.mount)T.mount.delete(n),T.array.delete(n),t.keepValue||(fe(s,n),fe(h,n)),!t.keepError&&fe(i.errors,n),!t.keepDirty&&fe(i.dirtyFields,n),!t.keepTouched&&fe(i.touchedFields,n),!a.shouldUnregister&&!t.keepDefaultValue&&fe(v,n);S.values.next({values:{...h}}),S.state.next({...i,...t.keepDirty?{isDirty:V()}:{}}),!t.keepIsValid&&A()},ue=(e,t={})=>{let n=g(s,e);const i=Q(t.disabled);return z(s,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),T.mount.add(e),n?i&&z(h,e,t.disabled?void 0:g(h,e,Ce(n._f))):F(e,!0,t.value),{...i?{disabled:t.disabled}:{},...a.progressive?{required:!!t.required,min:we(t.min),max:we(t.max),minLength:we(t.minLength),maxLength:we(t.maxLength),pattern:we(t.pattern)}:{},name:e,onChange:ne,onBlur:ne,ref:i=>{if(i){ue(e,t),n=g(s,e);const a=f(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,r=(e=>Y(e)||l(e))(a),o=n._f.refs||[];if(r?o.find((e=>e===a)):a===n._f.ref)return;z(s,e,{_f:{...n._f,...r?{refs:[...o.filter(je),a,...Array.isArray(g(v,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),F(e,!1,void 0,a)}else n=g(s,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(T.array,e)||!j.action)&&T.unMount.add(e)}}},ce=()=>a.shouldFocusError&&q(s,(e=>e&&g(i.errors,e)),T.mount),de=(e,t)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let l=p(h);if(S.state.next({isSubmitting:!0}),a.resolver){const{errors:e,values:t}=await B();i.errors=e,l=t}else await $(s);fe(i.errors,"root"),k(i.errors)?(S.state.next({errors:{}}),await e(l,n)):(t&&await t({...i.errors},n),ce(),setTimeout(ce)),S.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:k(i.errors),submitCount:i.submitCount+1,errors:i.errors})},me=(n,a={})=>{const l=n||v,r=p(l),o=n&&!k(n)?r:v;if(a.keepDefaultValues||(v=l),!a.keepValues){if(a.keepDirtyValues||C)for(const e of T.mount)g(i.dirtyFields,e)?z(o,e,g(h,e)):te(e,g(o,e));else{if(m&&f(n))for(const e of T.mount){const t=g(s,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(X(e)){const t=e.closest("form");if(t){t.reset();break}}}}s={}}h=e.shouldUnregister?a.keepDefaultValues?p(v):{}:p(o),S.array.next({values:{...o}}),S.values.next({values:{...o}})}T={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!j.mount&&t(),j.mount=!x.isValid||!!a.keepIsValid,j.watch=!!e.shouldUnregister,S.state.next({submitCount:a.keepSubmitCount?i.submitCount:0,isDirty:a.keepDirty?i.isDirty:!(!a.keepDefaultValues||he(n,v)),isSubmitted:!!a.keepIsSubmitted&&i.isSubmitted,dirtyFields:a.keepDirtyValues?i.dirtyFields:a.keepDefaultValues&&n?Se(v,n):{},touchedFields:a.keepTouched?i.touchedFields:{},errors:a.keepErrors?i.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},pe=(e,t)=>me(J(e)?e(h):e,t);return{control:{register:ue,unregister:se,getFieldState:le,handleSubmit:de,setError:re,_executeSchema:B,_getWatch:K,_getDirty:V,_updateValid:A,_removeUnmounted:()=>{for(const e of T.unMount){const t=g(s,e);t&&(t._f.refs?t._f.refs.every((e=>!je(e))):!je(t._f.ref))&&se(e)}T.unMount=new Set},_updateFieldArray:(e,t=[],n,a,l=!0,r=!0)=>{if(a&&n){if(j.action=!0,r&&Array.isArray(g(s,e))){const t=n(g(s,e),a.argA,a.argB);l&&z(s,e,t)}if(r&&Array.isArray(g(i.errors,e))){const t=n(g(i.errors,e),a.argA,a.argB);l&&z(i.errors,e,t),((e,t)=>{!b(g(e,t)).length&&fe(e,t)})(i.errors,e)}if(x.touchedFields&&r&&Array.isArray(g(i.touchedFields,e))){const t=n(g(i.touchedFields,e),a.argA,a.argB);l&&z(i.touchedFields,e,t)}x.dirtyFields&&(i.dirtyFields=Se(v,h)),S.state.next({name:e,isDirty:V(e,t),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else z(h,e,t)},_getFieldArray:t=>b(g(j.mount?h:v,t,e.shouldUnregister?g(v,t,[]):[])),_reset:me,_resetDefaultValues:()=>J(a.defaultValues)&&a.defaultValues().then((e=>{pe(e,a.resetOptions),S.state.next({isLoading:!1})})),_updateFormState:e=>{i={...i,...e}},_subjects:S,_proxyFormState:x,get _fields(){return s},get _formValues(){return h},get _state(){return j},set _state(e){j=e},get _defaultValues(){return v},get _names(){return T},set _names(e){T=e},get _formState(){return i},set _formState(e){i=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:ae,register:ue,handleSubmit:de,watch:(e,t)=>J(e)?S.values.subscribe({next:n=>e(K(void 0,t),n)}):K(e,t,!0),setValue:te,getValues:ie,reset:pe,resetField:(e,t={})=>{g(s,e)&&(f(t.defaultValue)?te(e,g(v,e)):(te(e,t.defaultValue),z(v,e,t.defaultValue)),t.keepTouched||fe(i.touchedFields,e),t.keepDirty||(fe(i.dirtyFields,e),i.isDirty=t.defaultValue?V(e,g(v,e)):V()),t.keepError||(fe(i.errors,e),x.isValid&&A()),S.state.next({...i}))},clearErrors:e=>{e&&w(e).forEach((e=>fe(i.errors,e))),S.state.next({errors:e?i.errors:{}})},unregister:se,setError:re,setFocus:(e,t={})=>{const n=g(s,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:le}}t.Controller=e=>e.render(P(e)),t.Form=function(e){const t=x(),[n,a]=i.default.useState(!1),{control:l=t.control,onSubmit:r,children:o,action:s,method:u=L,headers:c,encType:d,onError:m,render:p,onSuccess:b,validateStatus:f,...y}=e,v=async t=>{let n=!1,a="";await l.handleSubmit((async e=>{const i=new FormData;let o="";try{o=JSON.stringify(e)}catch(e){}for(const t of l._names.mount)i.append(t,g(e,t));if(r&&r({data:e,event:t,method:u,formData:i,formDataJson:o}),s)try{const e=[c&&c["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(s,{method:u,headers:{...c,...d?{"Content-Type":d}:{}},body:e?o:i});t&&(f?!f(t.status):t.status<200||t.status>=300)?(n=!0,m&&m({response:t}),a=String(t.status)):b&&b({response:t})}catch(e){n=!0,m&&m({error:e})}}))(t),n&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:a}))};return i.default.useEffect((()=>{a(!0)}),[]),p?i.default.createElement(i.default.Fragment,null,p({submit:v})):i.default.createElement("form",{noValidate:n,action:s,method:u,encType:d,onSubmit:v,...y},o)},t.FormProvider=e=>{const{children:t,...n}=e;return i.default.createElement(O.Provider,{value:n},t)},t.appendErrors=B,t.get=g,t.set=z,t.useController=P,t.useFieldArray=function(e){const t=x(),{control:n=t.control,name:a,keyName:l="id",shouldUnregister:r}=e,[o,s]=i.default.useState(n._getFieldArray(a)),u=i.default.useRef(n._getFieldArray(a).map($)),c=i.default.useRef(o),d=i.default.useRef(a),m=i.default.useRef(!1);d.current=a,c.current=o,n._names.array.add(a),e.rules&&n.register(a,e.rules),M({next:({values:e,name:t})=>{if(t===d.current||!t){const t=g(e,d.current);Array.isArray(t)&&(s(t),u.current=t.map($))}},subject:n._subjects.array});const b=i.default.useCallback((e=>{m.current=!0,n._updateFieldArray(a,e)}),[n,a]);return i.default.useEffect((()=>{if(n._state.action=!1,U(a,n._names)&&n._subjects.state.next({...n._formState}),m.current&&(!G(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=g(e.errors,a),i=g(n._formState.errors,a);(i?!t&&i.type||t&&(i.type!==t.type||i.message!==t.message):t&&t.type)&&(t?z(n._formState.errors,a,t):fe(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=g(n._fields,a);e&&e._f&&oe(e,n._formValues,n._options.criteriaMode===E,n._options.shouldUseNativeValidation,!0).then((e=>!k(e)&&n._subjects.state.next({errors:H(n._formState.errors,e,a)})))}n._subjects.values.next({name:a,values:{...n._formValues}}),n._names.focus&&q(n._fields,(e=>!!e&&e.startsWith(n._names.focus||""))),n._names.focus="",n._updateValid()}),[o,a,n]),i.default.useEffect((()=>(!g(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||r)&&n.unregister(a)})),[a,n,l,r]),{swap:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);be(i,e,t),be(u.current,e,t),b(i),s(i),n._updateFieldArray(a,i,be,{argA:e,argB:t},!1)}),[b,a,n]),move:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);de(i,e,t),de(u.current,e,t),b(i),s(i),n._updateFieldArray(a,i,de,{argA:e,argB:t},!1)}),[b,a,n]),prepend:i.default.useCallback(((e,t)=>{const i=w(p(e)),l=me(n._getFieldArray(a),i);n._names.focus=V(a,0,t),u.current=me(u.current,i.map($)),b(l),s(l),n._updateFieldArray(a,l,me,{argA:ue(e)})}),[b,a,n]),append:i.default.useCallback(((e,t)=>{const i=w(p(e)),l=se(n._getFieldArray(a),i);n._names.focus=V(a,l.length-1,t),u.current=se(u.current,i.map($)),b(l),s(l),n._updateFieldArray(a,l,se,{argA:ue(e)})}),[b,a,n]),remove:i.default.useCallback((e=>{const t=pe(n._getFieldArray(a),e);u.current=pe(u.current,e),b(t),s(t),n._updateFieldArray(a,t,pe,{argA:e})}),[b,a,n]),insert:i.default.useCallback(((e,t,i)=>{const l=w(p(t)),r=ce(n._getFieldArray(a),e,l);n._names.focus=V(a,e,i),u.current=ce(u.current,e,l.map($)),b(r),s(r),n._updateFieldArray(a,r,ce,{argA:e,argB:ue(t)})}),[b,a,n]),update:i.default.useCallback(((e,t)=>{const i=p(t),l=ge(n._getFieldArray(a),e,i);u.current=[...l].map(((t,n)=>t&&n!==e?u.current[n]:$())),b(l),s([...l]),n._updateFieldArray(a,l,ge,{argA:e,argB:i},!0,!1)}),[b,a,n]),replace:i.default.useCallback((e=>{const t=w(p(e));u.current=t.map($),b([...t]),s([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[b,a,n]),fields:i.default.useMemo((()=>o.map(((e,t)=>({...e,[l]:u.current[t]||$()})))),[o,l])}},t.useForm=function(e={}){const t=i.default.useRef(),[n,a]=i.default.useState({isDirty:!1,isValidating:!1,isLoading:J(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:J(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={..._e(e,(()=>a((e=>({...e}))))),formState:n});const l=t.current.control;return l._options=e,M({subject:l._subjects.state,next:e=>{C(e,l._proxyFormState,l._updateFormState,!0)&&a({...l._formState})}}),i.default.useEffect((()=>{e.values&&!he(e.values,l._defaultValues)?l._reset(e.values,l._options.resetOptions):l._resetDefaultValues()}),[e.values,l]),i.default.useEffect((()=>{l._state.mount||(l._updateValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()})),t.current.formState=S(n,l),t.current},t.useFormContext=x,t.useFormState=_,t.useWatch=A},478:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i="!{osquery",l={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}i+=n;try{l=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return i+="}",e(i)({type:"osquery",configuration:l})},n.splice(n.indexOf("text"),0,"osquery")}},479:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(370);const i=({status:e,query:t,signalIds:n,signal:i})=>{if(n&&n.length>0)return Object(a.i)({status:e,signalIds:n,signal:i}).then((({updated:e})=>({updated:null!=e?e:0,version_conflicts:0})));if(t)return Object(a.j)({status:e,query:t,signal:i}).then((({updated:e,version_conflicts:t})=>({updated:null!=e?e:0,version_conflicts:t})));throw new Error("Either query or signalIds must be provided")}},480:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l}));const a=["_source"];function i(e=[],t){return e&&e.length>0&&(1!==e.length||e[0]!==t.timeFieldName)?e:a}function l(e,t){return Object.fromEntries(Object.entries(e).filter((([e])=>e.startsWith(`${t}.`))))}},481:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),l=n(19),r=n(696),o=n(208);const s=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:s,dataTestSubj:u,height:c,autoFocusDisabled:d,setIsMarkdownInvalid:m,includePlugins:p=!0},b)=>{const[f,g]=Object(a.useState)([]),y=Object(a.useCallback)(((e,{messages:t})=>{g(e?[e]:t),m(!!e)}),[m]),v=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t;d||null===(e=v.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const h=Object(o.b)("investigation_guide"),E=Object(o.b)("investigation_guide_interactions"),j=Object(a.useMemo)((()=>p?Object(r.d)({insightsUpsellingMessage:h,interactionsUpsellingMessage:E}):void 0),[p,h,E]);return Object(a.useImperativeHandle)(b,(()=>{var e,t;if(!v.current)return null;const n=null===(e=v.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...v.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(l.EuiMarkdownEditor,{ref:v,"aria-label":n,editorId:s,onChange:e,value:t,uiPlugins:j,parsingPluginList:r.a,processingPluginList:r.c,onParse:y,errors:f,"data-test-subj":u,height:c})}));s.displayName="MarkdownEditorComponent";const u=Object(a.memo)(s)},501:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(46),i=n(1447),l=n(2069);a.exact(a.type({id:l.a})),a.exact(a.type({items:a.array(i.a)})),a.exact(a.type({name:a.string,description:a.string}));var r=n(891);const o=a.array(r.b),s=new a.Type("DefaultNamespaceArray",o.is,((e,t)=>{if(null==e)return a.success(["single"]);if("string"==typeof e){const n=e.trim().split(",").map((e=>e.trim()));return o.validate(n,t)}return a.failure(e,t)}),String);var u=n(2071),c=n(799),d=n(255);const m=new a.Type("NonEmptyStringArray",a.array(a.string).is,((e,t)=>{if("string"==typeof e&&""!==e.trim()){const n=e.trim().split(",").map((e=>e.trim()));return n.some((e=>""===e))?a.failure(e,t):a.success(n)}return a.failure(e,t)}),String);var p=n(439);a.intersection([a.exact(a.type({namespace_types:s})),a.exact(a.partial({ids:m,list_ids:m}))]);const b=a.exact(a.type({name:p.t,id:p.v,rule_id:p.y,exception_lists:u.a})),f=a.intersection([c.a,a.exact(a.type({referenced_rules:a.array(b)}))]),g=a.record(d.a,f);a.exact(a.type({references:a.array(g)}));var y=n(5);const v=`${y.Lb}/rules`,h=(y.qb,`${v}/exceptions/_find_references`)},514:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),l=n(41),r=n.n(l),o=n(44);const s=r.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(l.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;&:focus-visible{pointer-events:auto;opacity:1;}}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(o.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),u=i.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?i.a.createElement(s,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):i.a.createElement(i.a.Fragment,null,n)));u.displayName="HoverVisibilityContainer"},516:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"n",(function(){return b})),n.d(t,"p",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return y})),n.d(t,"u",(function(){return v})),n.d(t,"t",(function(){return h})),n.d(t,"v",(function(){return E})),n.d(t,"x",(function(){return j})),n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return O})),n.d(t,"w",(function(){return x})),n.d(t,"s",(function(){return S})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return C}));var a=n(4);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),r=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),o=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),s=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),u=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),c=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),y=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),v=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),h=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),E=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),j=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),T=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),O=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),x=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),S=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),k=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),C=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},529:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(189),l=n(21);const r=e=>{const t=o();return Object(a.useMemo)((()=>t(e)),[t,e])},o=()=>{const e=Object(i.a)();return Object(a.useCallback)((t=>((e,t)=>Object(l.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},558:function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),i=n.test(t);return a&&i&&(e=+e,t=+t),e===t?0:a&&!i?-1:i&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},559:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},560:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return r}));var a=n(207);const i=(e,t)=>`/name/${e}${Object(a.a)(t)}`,l=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,r=(e,t)=>`/${e}${Object(a.a)(t)}`},568:function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n(119),i=n.n(a),l=n(2),r=n.n(l),o=n(45),s=n(41),u=n.n(s),c=n(760),d=n(124),m=n(183),p=n(761),b=n(138),f=n(118),g=n(148),y=n(200),v=n(42),h=n(80),E=n(19),j=n(249),T=n(658),O=n(625),x=n(474),S=n(127),k=n(916),C=n(282),w=n(417),I=n(447);const M=["ACTION_CUSTOMIZE_PANEL"],_=u.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),N=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraActions:n,extraOptions:a,getLensAttributes:i,height:s,id:u,inputsModelId:c=b.a.global,inspectTitle:d,lensAttributes:m,onLoad:p,scopeId:g=S.SourcererScopeName.default,enableLegendActions:y=!0,stackByField:N,timerange:A,width:R,withActions:F=O.a,disableOnClickFilter:z=!1,casesAttachmentMetadata:P})=>{var L,B,q;const $=Object(l.useMemo)((()=>({height:null!=s?s:"100%",minWidth:"100px",width:null!=R?R:"100%"})),[s,R]),{lens:V,data:{actions:{createFiltersFromValueClickAction:G}}}=Object(f.j)().services,U=Object(o.useDispatch)(),{searchSessionId:H}=Object(w.a)({visualizationId:u}),Q=Object(T.a)({applyGlobalQueriesAndFilters:e,applyPageAndTabsFilters:t,extraOptions:a,getLensAttributes:i,lensAttributes:m,scopeId:g,stackByField:N,title:""}),W=null==Q||null===(L=Q.state)||void 0===L||null===(B=L.visualization)||void 0===B?void 0:B.preferredSeriesType,J="lnsLegacyMetric"!==(null==Q?void 0:Q.visualizationType)&&"lnsPie"!==(null==Q?void 0:Q.visualizationType),X=V.EmbeddableComponent,K=Object(l.useMemo)((()=>y?void 0:{settings:{legendAction:"ignore",onBrushEnd:"ignore"}}),[y]),{setInspectData:Y}=(Z=p,{setInspectData:Object(l.useCallback)(((e,t)=>{var n;if(!t)return;const a=Object(C.f)(null==t||null===(n=t.requests)||void 0===n?void 0:n.getRequests());null==Z||Z({requests:a.requests,responses:a.responses,isLoading:e})}),[Z])});var Z;const{responses:ee,loading:te}=Object(w.a)({visualizationId:u}),{additionalRequests:ne,additionalResponses:ae,handleClick:ie,handleCloseModal:le,isButtonDisabled:re,isShowingModal:oe,request:se,response:ue}=Object(I.a)({inputId:c,isDisabled:te,multiple:null!=ee&&ee.length>1,queryId:u}),ce=Object(l.useMemo)((()=>({handleInspectClick:ie,isInspectButtonDisabled:re})),[ie,re]),de=Object(O.d)({attributes:Q,extraActions:n,inspectActionProps:ce,timeRange:A,withActions:F,lensMetadata:P}),me=Object(l.useCallback)((({range:e})=>{const[t,n]=e;U(Object(j.setAbsoluteRangeDatePicker)({id:c,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[U,c]),pe=Object(l.useCallback)((e=>{if(!z)return async e=>{if(!D(e)||"area"!==W)return void e.preventDefault();const[{query:t}]=await G({data:e.data,negate:e.negate}),n=null==t?void 0:t.range["@timestamp"];null!=n&&n.gte&&null!=n&&n.lt&&me({range:[n.gte,n.lt]})};e.preventDefault()}),[G,me,W,z]),be=Object(l.useMemo)((()=>{var e,t;return null!=(null==Q||null===(e=Q.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==Q||null===(t=Q.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==Q||null===(q=Q.state)||void 0===q?void 0:q.adHocDataViews]);return H?!Q||null!=ee&&0===ee.length?r.a.createElement(E.EuiFlexGroup,null,r.a.createElement(E.EuiFlexItem,{grow:1},r.a.createElement(E.EuiEmptyPrompt,{body:r.a.createElement(E.EuiText,{size:"xs"},r.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),r.a.createElement(E.EuiFlexItem,{grow:!1},r.a.createElement(k.a,{extraActions:n,getLensAttributes:i,inputId:c,isInspectButtonDisabled:!0,lensAttributes:Q,queryId:u,stackByField:N,timerange:A,title:d,withActions:F,casesAttachmentMetadata:P}))):r.a.createElement(r.a.Fragment,null,Q&&H&&r.a.createElement(_,{$height:s,width:R,$addHoverActionsPadding:J},r.a.createElement(X,{attributes:Q,disabledActions:M,extraActions:de,id:u,onBrushEnd:me,onFilter:pe,onLoad:Y,overrides:K,searchSessionId:H,showInspector:!1,style:$,syncCursor:!1,syncTooltips:!1,timeRange:A,viewMode:h.ViewMode.VIEW,withDefaultActions:!1})),oe&&null!=se&&null!=ue&&r.a.createElement(x.a,{adHocDataViews:be,additionalRequests:ne,additionalResponses:ae,closeModal:le,"data-test-subj":"inspect-modal",inputId:c,request:se,response:ue,title:d})):null},D=e=>Array.isArray(e.data)&&"column"in e.data[0],A=r.a.memo(N);var R=n(132);const F=e=>{var t,n;const a=Object(o.useDispatch)(),{inputId:u=b.a.global,id:v,isDonut:h,label:E,donutTextWrapperClassName:j,onLoad:T,...O}=e,{session:x,refetchByRestartingSession:S,refetchByDeletingSession:k}=(({inputId:e,queryId:t})=>{const n=Object(o.useDispatch)(),{data:a}=Object(f.j)().services,i=Object(l.useRef)(a.search.session),r=Object(l.useMemo)((()=>g.d.globalQueryByIdSelector()),[]),s=Object(l.useMemo)((()=>g.d.timelineQueryByIdSelector()),[]),{selectedInspectIndex:u}=Object(d.a)((n=>e===b.a.global?r(n,t):s(n,t))),c=Object(l.useCallback)((()=>{const e=i.current.start();n(y.c.setInspectionParameter({id:t,selectedInspectIndex:u,isInspected:!1,inputId:b.a.global,searchSessionId:e}))}),[n,t,u]),m=Object(l.useCallback)((()=>{n(y.c.deleteOneQuery({inputId:b.a.global,id:t}))}),[n,t]);return{session:i,refetchByRestartingSession:c,refetchByDeletingSession:m}})({inputId:u,queryId:v}),{indicesExist:C}=Object(R.a)(O.scopeId),I=Object(l.useRef)(O.timerange),M=Object(l.useMemo)((()=>m.d.globalQueryByIdSelector()),[]),{searchSessionId:_}=Object(d.a)((e=>M(e,v))),{responses:N}=Object(w.a)({visualizationId:v}),D=null!=N&&0!==(null===(t=N[0])||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.total),F=D?Object(s.css)(["top:40%;right:12%;"]):Object(s.css)(["top:66%;right:12%;"]),z=Object(l.useCallback)((({requests:e,responses:t,isLoading:n})=>{a(m.b.setQuery({inputId:u,id:v,searchSessionId:x.current.start(),refetch:S,loading:n,inspect:{dsl:e,response:t}})),"function"==typeof T&&T({requests:e,responses:t,isLoading:n})}),[a,u,v,x,S,T]);return Object(l.useEffect)((()=>{var e,t;(!C&&(null===(e=I.current)||void 0===e?void 0:e.from)!==O.timerange.from||(null===(t=I.current)||void 0===t?void 0:t.to)!==O.timerange.to)&&(I.current=O.timerange,a(m.b.deleteOneQuery({inputId:u,id:v})))}),[a,v,C,u,O.timerange]),Object(l.useEffect)((()=>{_||setTimeout((()=>{a(m.b.setQuery({inputId:u,id:v,searchSessionId:x.current.start(),refetch:D?S:k,loading:!1,inspect:null}))}),200)}),[a,u,v,x,D,S,_,k]),Object(l.useEffect)((()=>()=>{a(m.b.deleteOneQuery({inputId:u,id:v}))}),[a,v,u]),(O.getLensAttributes||O.lensAttributes)&&O.timerange?h?r.a.createElement(p.b,{isChartEmbeddablesEnabled:!0,dataExists:D,label:E,title:N?r.a.createElement(c.a,{count:null===(P=N[0])||void 0===P||null===(L=P.hits)||void 0===L?void 0:L.total}):null,donutTextWrapperClassName:j,donutTextWrapperStyles:F},r.a.createElement(A,i()({},O,{id:v,onLoad:z}))):r.a.createElement(A,i()({},O,{id:v,onLoad:z})):null;var P,L},z=r.a.memo(F)},571:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),i=n.n(a),l=n(41),r=n.n(l),o=n(19),s=n(47),u=n(118),c=n(42);const d=({handleClick:e})=>i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),m=i.a.memo(d);var p=n(716);const b=r.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),f=({agentId:e,defaultValues:t,onClose:n,ecsData:l})=>{const{euiTheme:r}=Object(o.useEuiTheme)(),c=Object(a.useMemo)((()=>({style:`z-index: ${r.levels.flyout+3}`})),[r.levels.flyout]),{services:{osquery:d}}=Object(u.j)(),f=Object(s.useQueryClient)(),g=Object(a.useCallback)((()=>{var e;f.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,f]),y=Object(o.useGeneratedHtmlId)({prefix:"osqueryFlyoutTitle"});return null!=d&&d.OsqueryAction?i.a.createElement(o.EuiFlyout,{size:"m",onClose:n,"aria-labelledby":y,maskProps:c},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h2",{id:y},p.a))),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(b,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(d.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:l,onSuccess:g}))),i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(m,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},g=i.a.memo(f)},575:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(48),i=n(5),l=n(127);const r=[i.d,i.C,`${i.Cc}/id/:id`,i.Ib,i.bd,i.ac,i.ic],o=[i.d,`${i.Cc}/id/:id`,`${i.x}/:detailName`],s=e=>null==Object(a.matchPath)(e,{path:o,strict:!1})?l.SourcererScopeName.default:l.SourcererScopeName.detections,u=e=>null!=Object(a.matchPath)(e,{path:r,strict:!1})},579:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(11),l=n(118);const r=()=>{const e=Object(l.j)(),{http:t}=e.services,[n,r]=Object(a.useState)(Object(i.createSavedQueryService)(t));return Object(a.useEffect)((()=>{r(Object(i.createSavedQueryService)(t))}),[t]),n}},580:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n(404).NetworkType.details;let a=function(e){return e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users",e}({})},581:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),l=n(41),r=n.n(l),o=n(19),s=n(157),u=n(481);const c=r()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:l,bottomRightContent:r,includePlugins:d},m)=>{const{isInvalid:p,errorMessage:b}=Object(s.k)(t),[f,g]=Object(a.useState)(!1);return i.a.createElement(o.EuiFormRow,{"data-test-subj":n,describedByIds:l?[l]:void 0,error:b,fullWidth:!0,helpText:t.helpText,isInvalid:p||f,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{ref:m,ariaLabel:l,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`,setIsMarkdownInvalid:g,includePlugins:d}),r&&i.a.createElement(c,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},r))))})));d.displayName="MarkdownEditorForm"},582:function(e,t,n){"use strict";n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return b}));var a=n(68);let i=function(e){return e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout",e.urlChanged="urlChanged",e}({});const l=Object(a.createAction)(i.openFlyout),r=Object(a.createAction)(i.openRightPanel),o=Object(a.createAction)(i.openLeftPanel),s=Object(a.createAction)(i.openPreviewPanel),u=Object(a.createAction)(i.closeFlyout),c=Object(a.createAction)(i.closeRightPanel),d=Object(a.createAction)(i.closeLeftPanel),m=Object(a.createAction)(i.closePreviewPanel),p=Object(a.createAction)(i.previousPreviewPanel),b=Object(a.createAction)(i.urlChanged)},583:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var a=n(19),i=n(2),l=n.n(i),r=n(559);const o="exit-full-screen",s=({fullScreen:e,setFullScreen:t})=>{const n=Object(i.useCallback)((()=>{t(!1)}),[t]),s=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?l.a.createElement(l.a.Fragment,null,l.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:s}),l.a.createElement(a.EuiButton,{className:o,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:n},r.a)):null};s.displayName="ExitFullScreenComponent";const u=l.a.memo(s)},584:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events",e}({})},624:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l}));var a=n(5);const i=`${a.Lb}/fleet/integrations/all`,l=`${a.Lb}/fleet/integrations/installed`},625:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return h}));var a=n(2),i=n.n(a),l=n(78),r=n(242),o=n(65),s=n(36),u=n(118),c=n(267),d=n(393),m=n(66),p=n(194);let b=function(e){return e.addToExistingCase="addToExistingCase",e.addToNewCase="addToNewCase",e.inspect="inspect",e.openInLens="openInLens",e.saveToLibrary="saveToLibrary",e}({});const f=[b.inspect,b.addToNewCase,b.addToExistingCase,b.saveToLibrary,b.openInLens],g=[b.inspect],y={id:"VISUALIZATION_CONTEXT_MENU_TRIGGER"},v={[b.inspect]:{id:b.inspect,getDisplayName:()=>c.k,getIconType:()=>"inspect",type:"actionButton",order:4},[b.addToNewCase]:{id:b.addToNewCase,getDisplayName:()=>c.d,getIconType:()=>"casesApp",type:"actionButton",order:3},[b.addToExistingCase]:{id:b.addToExistingCase,getDisplayName:()=>c.c,getIconType:()=>"casesApp",type:"actionButton",order:2},[b.saveToLibrary]:{id:b.saveToLibrary,getDisplayName:()=>c.a,getIconType:()=>"save",type:"actionButton",order:1},[b.openInLens]:{id:b.openInLens,getDisplayName:()=>c.m,getIconType:()=>"visArea",type:"actionButton",order:0}},h=({attributes:e,lensMetadata:t,extraActions:n,inspectActionProps:g,timeRange:y,withActions:h=f})=>{const{services:E}=Object(r.c)(),{lens:{navigateToPrefilledEditor:j,canUseEditor:T}}=E,O=Object(a.useCallback)((()=>{y&&e&&j({id:"",timeRange:y,attributes:e},{openInNewTab:!0})}),[e,j,y]),{disabled:x,onAddToExistingCaseClicked:S}=(({onAddToCaseClicked:e,lensAttributes:t,timeRange:n,lensMetadata:i})=>{const{cases:l}=Object(u.j)().services,r=l.helpers.canUseCases([s.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:n,metadata:i},persistableStateAttachmentTypeId:o.LENS_ATTACHMENT_TYPE,type:o.AttachmentType.persistableState}]),[t,i,n]),{open:m}=l.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:c.b}});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),m({getAttachments:()=>d})}),[d,e,m]),disabled:null==t||null==n||!r.create||!r.read}})({lensAttributes:e,timeRange:y,lensMetadata:t}),{onAddToNewCaseClicked:k,disabled:C}=(({onClick:e,timeRange:t,lensAttributes:n,lensMetadata:i})=>{const{cases:l}=Object(u.j)().services,r=l.helpers.canUseCases([s.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:n,timeRange:t,metadata:i},persistableStateAttachmentTypeId:o.LENS_ATTACHMENT_TYPE,type:o.AttachmentType.persistableState}]),[n,i,t]),{open:m}=l.hooks.useCasesAddToNewCaseFlyout({toastContent:c.b});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),m({attachments:d})}),[d,m,e]),disabled:null==n||null==t||!r.create||!r.read}})({timeRange:y,lensAttributes:e,lensMetadata:t}),{openSaveVisualizationFlyout:w,disableVisualizations:I}=(({attributes:e})=>{const t=Object(u.j)().services,{SaveModalComponent:n,canUseEditor:l}=t.lens,r=Object(p.m)(),{redirectTo:o,getEditOrCreateDashboardPath:c}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(u.k)(),n=Object(a.useMemo)((()=>`${e({deepLinkId:s.SecurityPageName.dashboards})}`),[e]),i=Object(a.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),l=Object(a.useCallback)((t=>`${e({deepLinkId:s.SecurityPageName.dashboards,path:i(t)})}`),[i,e]);return{redirectTo:Object(a.useCallback)((e=>{"listing"===e.destination&&t({url:n}),"dashboard"===e.destination&&t({url:l(e.id)})}),[n,l,t]),getEditOrCreateDashboardPath:i,getEditOrCreateDashboardUrl:l,dashboardListingUrl:n}})({getSecuritySolutionUrl:r});return{openSaveVisualizationFlyout:Object(a.useCallback)((()=>{const a=document.createElement("div");Object(d.a)(i.a.createElement(n,{initialInput:e,onSave:()=>Object(m.unmountComponentAtNode)(a),onClose:()=>Object(m.unmountComponentAtNode)(a),originatingApp:s.APP_UI_ID,getOriginatingPath:e=>`${s.SecurityPageName.dashboards}/${c(e)}`,redirectTo:o}),t)(a)}),[n,e,c,o,t]),disableVisualizations:Object(a.useMemo)((()=>!l()||null==e),[e,l])}})({attributes:e});return Object(a.useMemo)((()=>[Object(l.createAction)({...v[b.inspect],execute:async()=>{g.handleInspectClick()},disabled:g.isInspectButtonDisabled,isCompatible:async()=>h.includes(b.inspect)}),Object(l.createAction)({...v[b.addToNewCase],execute:async()=>{k()},disabled:C,isCompatible:async()=>h.includes(b.addToNewCase)}),Object(l.createAction)({...v[b.addToExistingCase],execute:async()=>{S()},disabled:x,isCompatible:async()=>h.includes(b.addToExistingCase),order:2}),Object(l.createAction)({...v[b.saveToLibrary],execute:async()=>{w()},disabled:I,isCompatible:async()=>h.includes(b.saveToLibrary),order:1}),Object(l.createAction)({...v[b.openInLens],execute:async()=>{O()},isCompatible:async()=>T()&&h.includes(b.openInLens),order:0}),...null!=n?n:[]].map(((e,t,n)=>({...e,order:Math.max(n.length-(1+t),0)})))),[T,I,n,g,x,C,S,k,O,w,h])}},650:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"k",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return b}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),r=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),u=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),c=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),b=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},651:function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return l})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"m",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return g})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return v}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),l=a.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),r=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),o=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),s=a.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),u=a.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),c=a.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),m=a.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),p=a.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),b=a.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),f=a.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),g=a.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),y=a.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),v=a.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},654:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1094);case"v8light":return n(1096)}},655:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(701);function i(e){return{type:Object(a.a)(e),scripted:e.scripted}}},656:function(e,t,n){const a=n(283);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},657:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),l=n(41),r=n.n(l),o=n(191);const s=r.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(l.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),o.d,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),o.d,o.d,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(l.css)(["&{z-index:9999 !important;}"])));s.displayName="ProviderContainerComponent";const u=i.a.memo(s);u.displayName="ProviderContainer"},658:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(5),l=n(584),r=n(132),o=n(124),s=n(148),u=n(127),c=n(246),d=n(282);const m=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraOptions:n,getLensAttributes:m,lensAttributes:p,scopeId:b=u.SourcererScopeName.default,stackByField:f,title:g})=>{var y,v;const{selectedPatterns:h,dataViewId:E,indicesExist:j}=Object(r.a)(b),T=Object(a.useMemo)((()=>s.d.globalQuerySelector()),[]),O=Object(a.useMemo)((()=>s.d.globalFiltersQuerySelector()),[]),x=Object(o.a)(T),S=Object(o.a)(O),[{detailName:k,pageName:C,tabName:w}]=Object(c.a)(),I=Object(a.useMemo)((()=>w===l.a.events?C===i.Oc.network?d.h:Object(d.b)(C):[]),[C,w]),M=Object(a.useMemo)((()=>[i.Oc.hosts,i.Oc.users].indexOf(C)>=0&&null!=k?Object(d.c)(C,k):i.Oc.network===C?Object(d.e)(k):[]),[k,C]),_=Object(a.useMemo)((()=>null!=p?p:m&&f&&m(f,n)),[n,m,p,f]),N=Object.values(null!==(y=null==_||null===(v=_.state)||void 0===v?void 0:v.adHocDataViews)&&void 0!==y?y:{}).length>0,D=Object(a.useMemo)((()=>{var n;if(null==p&&(null==m||null==f||0===(null==f?void 0:f.length)))return null;const a=N?[]:Object(d.d)(h);return{..._,...null!=g?{title:g}:{},state:{..._.state,...e?{query:x}:{},filters:[..._.state.filters,...t?M:[],...t?I:[],...a,...e?S:[]]},references:null==_||null===(n=_.references)||void 0===n?void 0:n.map((e=>({...e,id:E})))}}),[e,t,_,E,S,m,N,p,M,x,h,f,I,g]);return N||!N&&j?D:null}},660:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.endpoints="endpoints",e.policies="policy",e.trustedApps="trusted_apps",e.eventFilters="event_filters",e.hostIsolationExceptions="host_isolation_exceptions",e.blocklist="blocklist",e.responseActionsHistory="response_actions_history",e.protectionUpdates="protection_updates",e}({})},696:function(e,t,n){"use strict";n.d(t,"a",(function(){return _e})),n.d(t,"c",(function(){return Ne})),n.d(t,"b",(function(){return De})),n.d(t,"d",(function(){return Ae}));var a=n(19),i=n(954),l=n(477),r=n(2),o=n.n(r),s=n(7),u=n(42),c=n(4),d=n(119),m=n.n(d);const p=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:i},fieldState:{error:s}}=Object(l.useController)({name:"label",defaultValue:""}),u=Object(r.useMemo)((()=>!(null==s||!s.message)),[null==s?void 0:s.message]);return o.a.createElement(a.EuiFormRow,{label:c.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==s?void 0:s.message,isInvalid:u,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({isInvalid:u,onChange:t,value:n,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},b=o.a.memo(p),f=c.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),g=()=>o.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,f),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(a.EuiCode,null,"osquery")}}))});var y=n(118);const v=({node:e,onSave:t,onCancel:n})=>{var i,d,m;const p=null!=e,{osquery:f,application:{capabilities:{osquery:v}}}=Object(y.j)().services,h=Object(l.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(m=e.configuration)||void 0===m?void 0:m.ecs_mapping}}),E=Object(r.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(s.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(s.isEmpty)(e))))}}`,{block:!0})}),[t]),j=Object(r.useMemo)((()=>!(v.runSavedQueries&&v.readSavedQueries||v.writeLiveQueries)),[v.readSavedQueries,v.runSavedQueries,v.writeLiveQueries]),T=Object(r.useMemo)((()=>{if(null!=f&&f.LiveQueryField){const{LiveQueryField:e}=f;return o.a.createElement(l.FormProvider,h,o.a.createElement(b,null),o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(e,{formMethods:h}))}return null}),[h,f]);return j?o.a.createElement(g,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement("h1",null,p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),o.a.createElement(a.EuiModalBody,null,o.a.createElement(o.a.Fragment,null,T)),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},c.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),o.a.createElement(a.EuiButton,{onClick:h.handleSubmit(E),fill:!0},p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},h=o.a.memo(v);var E=n(478),j=n(41),T=n.n(j),O=n(208),x=n(394),S=n(262),k=n(1087),C=n.n(k),w=n(571);const I=T()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var M=n(54),_=n.n(M),N=n(60),D=n.n(N),A=(n(43),n(53)),R=n(123),F=n(55),z=n(1484),P=n(146),L=n(250),B=n(717),q=n(132),$=n(127);const V=["*"],G={};var U=n(121),H=n(179);const Q=e=>e===A.FILTERS.EXISTS?H.b:e===A.FILTERS.PHRASES?H.c:H.d,W={$state:{store:A.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},J={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:U.a.default,queryMatch:{field:"",value:"",operator:H.b}},X=e=>{const t={...W,meta:{...W.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===A.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===A.FILTERS.PHRASES){var n;let a=JSON.parse(String(e.value));return"number"===e.valueType?a=a.map(Number):"boolean"===e.valueType&&(a=a.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(n=a)||void 0===n?void 0:n.map((t=>({match_phrase:{[e.field]:t}})))}}}}var a;if(e.queryType===A.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(a=e.value)&&void 0!==a?a:""}}};if(e.queryType===A.FILTERS.RANGE){let n,a;try{const t=JSON.parse(String(e.value));n=t.gte,a=t.lt}catch{n="",a=""}const i={gte:n,lt:a};return{...t,meta:{...t.meta,params:i},query:{range:{[e.field]:i}}}}return t},K=({providers:e,alertData:t})=>{const n=Object(r.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(r.useMemo)((()=>n?[]:((e,t)=>e.map((e=>e.reduce(((e,n,a)=>{const{field:i,value:l,excluded:r,queryType:o}=n,{result:u,matchedBrackets:c}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const n=/\{{([^}]+)\}}/g,a=e.match(new RegExp(n));let i=e;a&&t&&Object(s.each)(a,(e=>{const n=e.replace(/{{|}}/g,"").trim();if(i.includes(e)){const a=t.find((({field:e})=>e===n));if(a&&a.values){const{values:[t]}=a;i=i.replace(e,t)}}}));const l=new RegExp(n).test(i);return{result:i,skipped:l,matchedBrackets:a}})(l,t),d=!t&&c;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(i+l),name:i,excluded:r,kqlQuery:"",type:d?U.a.template:U.a.default,queryMatch:{field:i,value:u,operator:Q(o)}};{const t={enabled:!0,id:JSON.stringify(i+l),name:i,excluded:r,kqlQuery:"",type:d?U.a.template:U.a.default,queryMatch:{field:i,value:u,operator:Q(o)}};e.and.push(t)}return e}),J))))(e,t)),[t,e,n]),filters:Object(r.useMemo)((()=>n?((e,t)=>{const n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.length>1){const e=a.map((e=>X(e))),t={$state:{store:A.FilterStateStore.APP_STATE},meta:{type:A.FILTERS.COMBINED,relation:A.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};n.push(t)}else{const e=a[0],t=X(e);n.push(t)}}return n})(e):[]),[n,e,t])}};var Y=n(263),Z=n(396),ee=n(5);const te=e=>{var t,n,a,i,l,r;const o=null!==(t=null===(n=e.meta)||void 0===n?void 0:n.key)&&void 0!==t?t:"",s={field:o,excluded:null!==(a=null===(i=e.meta)||void 0===i?void 0:i.negate)&&void 0!==a&&a,queryType:null!==(l=null===(r=e.meta)||void 0===r?void 0:r.type)&&void 0!==l?l:A.FILTERS.PHRASE};if(Object(A.isRangeFilter)(e)){var u;const{gte:t,lt:n}=e.query.range[o],a=JSON.stringify({gte:t,lt:n});return{...s,value:a,queryType:null!==(u=e.meta.type)&&void 0!==u?u:A.FILTERS.RANGE}}if(Object(A.isPhrasesFilter)(e)){var c,d,m,p;const t=typeof(null===(c=e.meta)||void 0===c?void 0:c.params[0]);return{...s,value:JSON.stringify(null!==(d=null===(m=e.meta)||void 0===m?void 0:m.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(p=e.meta.type)&&void 0!==p?p:A.FILTERS.PHRASES}}var b;if(Object(A.isExistsFilter)(e))return{...s,value:"",queryType:null!==(b=e.meta.type)&&void 0!==b?b:A.FILTERS.EXISTS};if(Object(A.isPhraseFilter)(e)){var f,g,y,v,h,E;const t=typeof(null===(f=e.meta)||void 0===f||null===(g=f.params)||void 0===g?void 0:g.query);return{...s,value:null!==(y=null===(v=e.meta)||void 0===v||null===(h=v.params)||void 0===h?void 0:h.query)&&void 0!==y?y:"",valueType:t,queryType:null!==(E=e.meta.type)&&void 0!==E?E:A.FILTERS.PHRASE}}return{...s,value:"",queryType:A.FILTERS.PHRASE}},ne=e=>e.map((e=>te(e))),ae=e=>!1===e.some(A.isCombinedFilter)?[ne(e)]:e.reduce(((e,t)=>{if(Object(A.isCombinedFilter)(t)){const n=t.meta.params;if(t.meta.relation===A.BooleanRelation.OR){const t=n.map((e=>{const t=ae([e]);return Object(s.flatten)(t)}));return[...e,...t]}{const t=ae(n);return[...e,...t]}}return[...e,[te(t)]]}),[]);var ie=n(16),le=n(63),re=n.n(le),oe=n(656),se=n.n(oe),ue=n(233);function ce(e,t,n){var a;if(void 0===t||"undefined"===n)return!1;switch(e.type){case"date":const n="string"==typeof t?re.a.parse(t):null;return Boolean("string"==typeof t&&n&&n.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new F.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(a=e.esTypes)&&void 0!==a&&a.includes(ue.a.VERSION)?Boolean(se()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const de=c.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),me=c.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),pe=c.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),be=c.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),fe=c.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),ge=c.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),ye=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),ve=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),he=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),Ee=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),je=c.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),Te=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"});var Oe=n(766);const xe="!{investigate",Se=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:l})=>{const{addError:s}=Object(R.a)();let u=[];try{void 0!==n&&(u=JSON.parse(n))}catch(e){s(e,{title:Te})}const{data:c,timestamp:d}=Object(r.useContext)(x.a),{dataProviders:m,filters:p}=K({providers:u,alertData:c}),b=Object(r.useMemo)((()=>{if(i&&l){const e=d?_()(d):_()();return{kind:"absolute",from:Object(Z.e)(i,Z.a,!1,_.a,e.toDate()).toISOString(),to:Object(Z.e)(l,Z.b,!0,_.a,e.toDate()).toISOString()}}return null}),[i,l,d]),{totalCount:f,isQueryLoading:g,oldestTimestamp:v,hasError:h}=(({dataProviders:e,filters:t,relativeTimerange:n})=>{const{uiSettings:a}=Object(y.j)().services,i=Object(r.useMemo)((()=>Object(F.getEsQueryConfig)(a)),[a]),{browserFields:l,selectedPatterns:o,indexPattern:s,dataViewId:u}=Object(q.a)($.SourcererScopeName.timeline),[c,d]=Object(r.useState)(!1),m=Object(r.useMemo)((()=>{try{if(!1===c)return Object(L.d)({config:i,dataProviders:e,indexPattern:s,browserFields:l,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[l,e,i,c,s,t]),[p,{events:b,totalCount:f}]=Object(B.a)({dataViewId:u,fields:V,filterQuery:null==m?void 0:m.filterQuery,id:P.c.active,indexNames:o,language:"kuery",limit:1,runtimeMappings:G,startDate:null==n?void 0:n.from,endDate:null==n?void 0:n.to,fetchNotes:!1}),g=Object(r.useMemo)((()=>[z.a.loading,z.a.loadingMore].includes(p)),[p]),[v]=b,h=v&&v.data&&v.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:g,totalCount:f,oldestTimestamp:h&&h.value&&h.value[0],hasError:c}})({dataProviders:m,filters:p,relativeTimerange:b}),E=Object(r.useMemo)((()=>{if(b)return b;if(null!=v)return{kind:"absolute",from:v,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(Z.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[v,b]);return g?o.a.createElement(a.EuiLoadingSpinner,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(Y.a,{asEmptyButton:!1,isDisabled:h,dataProviders:m,filters:p,timeRange:E,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},o.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${D()(f).format("0,0.[000]a")})`),o.a.createElement("div",null,t))},ke=({node:e,onSave:t,onCancel:n})=>{const i=null!=e,{indexPattern:c}=Object(q.a)($.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:d}},uiSettings:p}=Object(y.j)().services,b=Object(Oe.a)({sourcererScope:$.SourcererScopeName.default}),[f,g]=Object(r.useState)([[]]),v=Object(r.useMemo)((()=>[{value:"0",text:""},...p.get(ee.db).map((({display:e},t)=>({value:String(t),text:e})))]),[p]),h=Object(l.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),E=Object(l.useController)({name:"label",control:h.control}),j=Object(l.useController)({name:"description",control:h.control}),T=Object(l.useController)({name:"relativeTimerange",control:h.control}),O=Object(r.useCallback)((e=>{const t=v.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),n=p.get(ee.db);return{relativeFrom:n[e].from,relativeTo:n[e].to}}return{}}),[v,p]),x=Object(r.useCallback)((()=>{t(`${xe}${JSON.stringify(Object(s.pickBy)({label:E.field.value,description:j.field.value,providers:f,...O(T.field.value)},(e=>!Object(s.isEmpty)(e))))}}`,{block:!0})}),[t,f,E.field.value,j.field.value,T.field.value,O]),S=Object(r.useCallback)((e=>{g(ae(e))}),[]),k=Object(r.useCallback)((e=>{T.field.onChange(e.target.value)}),[T.field]),C=Object(r.useMemo)((()=>{var e;const t=null!==(e=E.field.value)&&void 0!==e?e:"",n=f.flat();return""===t.trim()||0===n.length||n.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return ce(t,e.value,e.valueType);case"phrases":const n="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(n)||!n.length)&&n.every((n=>ce(t,n,e.valueType)));case"range":const a=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof a&&(!a.gte||ce(t,a.gte,e.valueType))&&(!a.lt||ce(t,a.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==b?void 0:b.getFieldByName(e.field))))}),[E.field.value,f,b]),w=Object(r.useMemo)((()=>{const e=c&&c.getName?c.getName():"*";return[{$state:{store:A.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[c]),I=Object(ie.b)().isAtLeast("platinum");return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ie,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(a.EuiFlexItem,null,i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===I&&o.a.createElement(a.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),o.a.createElement(a.EuiModalBody,null,o.a.createElement(l.FormProvider,h,o.a.createElement(a.EuiForm,{fullWidth:!0},o.a.createElement(a.EuiFormRow,{label:ge,fullWidth:!0},o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:de,helpText:pe,isInvalid:void 0!==E.field.value&&0===E.field.value.trim().length,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},h.register("label"),{ref:null,name:"label",onChange:E.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:be,helpText:fe,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},h.register("description"),{ref:null,name:"description",onChange:j.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:ye,helpText:ve,fullWidth:!0},b?o.a.createElement(d,{filters:w,onChange:S,dataView:b,maxDepth:1}):o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:he,helpText:Ee,fullWidth:!0},o.a.createElement(a.EuiSelect,m()({},h.register("relativeTimerange"),{ref:null,onChange:k,options:v})))))),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},je),o.a.createElement(a.EuiButton,{onClick:h.handleSubmit(x),fill:!0,disabled:C},i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Ce=o.a.memo(ke),we=`${xe}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var Ie=T()(a.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Me=Object(a.getDefaultEuiMarkdownUiPlugins)(),_e=Object(a.getDefaultEuiMarkdownParsingPlugins)(),Ne=Object(a.getDefaultEuiMarkdownProcessingPlugins)(),De=[xe],Ae=({insightsUpsellingMessage:e,interactionsUpsellingMessage:t})=>{const n=Me.map((e=>e.name)),l=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:me,iconType:"timelineWithArrow",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},we),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:Ce}))({insightsUpsellingMessage:e}),r=i.b({interactionsUpsellingMessage:t}),s=(({interactionsUpsellingMessage:e})=>({name:"osquery",button:{label:null!=e?e:"Osquery",iconType:"logoOsquery",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:h}))({interactionsUpsellingMessage:t});if(!1===n.includes(l.name))Me.push(r),Me.push(s),Me.push(l);else{const e=Me.findIndex((e=>e.name===l.name));Me[e]=l}return Me};_e.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){if(!1===t.startsWith(xe))return!1;const a=t[13];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i={};if("{"===a){let n="",a=0;for(let e=13;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}try{return i=JSON.parse(n),e(t)({type:"insight",...i,providers:JSON.stringify(i.providers)})}catch(t){const n=e.now();this.file.fail((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:n.line,column:n.column+13})}}return!1};a.locator=(e,t)=>e.indexOf(xe,t),t.insight=a,n.splice(n.indexOf("text"),0,"insight")})),_e.push(i.a),_e.push(E.a),Ne[1][1].components.insight=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:l})=>{const r=Object(O.b)("investigation_guide");return r?o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiToolTip,{content:r},o.a.createElement(a.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`)),o.a.createElement("div",null,t)):o.a.createElement(Se,{label:e,description:t,providers:n,relativeFrom:i,relativeTo:l})},Ne[1][1].components.timeline=i.c,Ne[1][1].components.osquery=({configuration:e})=>{var t;const[n,i]=Object(r.useState)(!1),{agentId:l,alertId:u,data:d}=Object(r.useContext)(x.a),m=Object(r.useCallback)((()=>i(!0)),[i]),p=Object(r.useCallback)((()=>i(!1)),[i]),b=Object(O.b)("investigation_guide_interactions"),f=Object(r.useMemo)((()=>{const e=Object(s.reduce)(d,((e,t)=>{var n;return{...e,[t.field]:null==t||null===(n=t.values)||void 0===n?void 0:n[0]}}),{});return Object(S.a)(e)}),[d]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiToolTip,{content:b},o.a.createElement(I,{iconType:C.a,onClick:m,disabled:!!b},null!==(t=e.label)&&void 0!==t?t:c.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"}))),n&&o.a.createElement(w.a,{defaultValues:{...u?{alertIds:[u]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:l,onClose:p,ecsData:f}))}},697:function(e,t,n){"use strict";n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return z.a})),n.d(t,"e",(function(){return z.e})),n.d(t,"d",(function(){return z.d})),n.d(t,"c",(function(){return z.c})),n.d(t,"f",(function(){return z.h})),n.d(t,"g",(function(){return z.l})),n.d(t,"j",(function(){return z.r})),n.d(t,"n",(function(){return z.v})),n.d(t,"m",(function(){return z.u})),n.d(t,"l",(function(){return z.t})),n.d(t,"k",(function(){return z.s})),n.d(t,"h",(function(){return z.o})),n.d(t,"i",(function(){return z.p})),n.d(t,"r",(function(){return z.A})),n.d(t,"s",(function(){return z.B})),n.d(t,"v",(function(){return z.E})),n.d(t,"p",(function(){return z.y})),n.d(t,"t",(function(){return z.C})),n.d(t,"o",(function(){return z.x})),n.d(t,"u",(function(){return z.D})),n.d(t,"q",(function(){return z.z}));var a=n(2),i=n.n(a),l=n(19),r=n(45),o=n(151),s=n(41),u=n.n(s);const c=u.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-170nqoz-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));c.displayName="SearchRowContainer";const d=u()(l.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-170nqoz-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));d.displayName="SearchRowFlexGroup";const m=i.a.memo((()=>{const e=Object(r.useDispatch)(),t=Object(a.useMemo)((()=>({placeholder:"Search note contents",incremental:!1,"data-test-subj":"notes-search-bar"})),[]),n=Object(a.useCallback)((({queryText:t})=>{e(Object(z.y)(t.trim()))}),[e]);return i.a.createElement(c,null,i.a.createElement(d,{gutterSize:"s"},i.a.createElement(l.EuiFlexItem,null,i.a.createElement(l.EuiSearchBar,{box:t,onChange:n,defaultQuery:""}))))}));m.displayName="SearchRow";var p=n(362),b=n(4);const f=b.i18n.translate("xpack.securitySolution.notes.management.batchActionsTitle",{defaultMessage:"Bulk actions"}),g=b.i18n.translate("xpack.securitySolution.notes.management.createdColumnTitle",{defaultMessage:"Created"}),y=b.i18n.translate("xpack.securitySolution.notes.management.createdByColumnTitle",{defaultMessage:"Created by"}),v=b.i18n.translate("xpack.securitySolution.notes.management.eventIdColumnTitle",{defaultMessage:"View Document"}),h=b.i18n.translate("xpack.securitySolution.notes.management.timelineColumnTitle",{defaultMessage:"Timeline"}),E=b.i18n.translate("xpack.securitySolution.notes.management.noteContentColumnTitle",{defaultMessage:"Note content"}),j=b.i18n.translate("xpack.securitySolution.notes.management.deleteAction",{defaultMessage:"Delete"}),T=b.i18n.translate("xpack.securitySolution.notes.management.deleteDescription",{defaultMessage:"Delete this note"}),O=b.i18n.translate("xpack.securitySolution.notes.management.tableError",{defaultMessage:"Unable to load notes"}),x=b.i18n.translate("xpack.securitySolution.notes.management.deleteNotesModalTitle",{defaultMessage:"Delete notes?"}),S=b.i18n.translate("xpack.securitySolution.notes.management.deleteNotesCancel",{defaultMessage:"Cancel"}),k=b.i18n.translate("xpack.securitySolution.notes.management.deleteSelected",{defaultMessage:"Delete selected notes"}),C=b.i18n.translate("xpack.securitySolution.notes.management.refresh",{defaultMessage:"Refresh"}),w=b.i18n.translate("xpack.securitySolution.notes.management.openTimeline",{defaultMessage:"Open timeline"}),I=b.i18n.translate("xpack.securitySolution.notes.management.viewEventInTimeline",{defaultMessage:"View event in timeline"}),M=i.a.memo((()=>{const e=Object(r.useDispatch)(),t=Object(r.useSelector)(z.r),n=Object(r.useSelector)(z.v),o=Object(r.useSelector)(z.u),s=Object(a.useMemo)((()=>{const{perPage:e,page:n,total:a}=t,i=e*(n-1)+1,l=Math.min(e*n,a);return 0===e?"All":`${i}-${l} of ${a}`}),[t]),u=Object(a.useCallback)((()=>{e(Object(z.z)())}),[e]),c=Object(r.useSelector)(z.t),d=Object(a.useCallback)((()=>i.a.createElement(l.EuiContextMenuItem,{"data-test-subj":"notes-management-delete-notes",onClick:u,disabled:0===o.length,icon:"trash",key:"DeleteItemKey"},k)),[u,o.length]),m=Object(a.useCallback)((()=>{e(Object(z.d)({page:t.page,perPage:t.perPage,sortField:n.field,sortOrder:n.direction,filter:"",search:c}))}),[e,t.page,t.perPage,n.field,n.direction,c]);return i.a.createElement(p.a,{border:!0},i.a.createElement(p.d,null,i.a.createElement(p.c,null,i.a.createElement(p.e,{"data-test-subj":"notes-management-pagination-count"},`Showing: ${s}`)),i.a.createElement(p.c,null,i.a.createElement(p.e,{"data-test-subj":"notes-management-selected-count"},o.length>0?`${o.length} selected`:""),i.a.createElement(p.b,{dataTestSubj:"notes-management-utility-bar-actions",iconSide:"right",iconType:"arrowDown",popoverContent:d},i.a.createElement("span",{"data-test-subj":"notes-management-utility-bar-action-button"},f)),i.a.createElement(p.b,{dataTestSubj:"notes-management-utility-bar-refresh-button",iconSide:"right",iconType:"refresh",onClick:m},C))))}));M.displayName="NotesUtilityBar";const _=i.a.memo((()=>{const e=Object(r.useDispatch)(),t=Object(r.useSelector)(z.s),n=Object(r.useSelector)(z.l)===z.a.Loading,o=Object(a.useCallback)((()=>{e(Object(z.x)())}),[e]),s=Object(a.useCallback)((()=>{e(Object(z.c)({ids:t,refetch:!0}))}),[e,t]);return i.a.createElement(l.EuiConfirmModal,{"aria-labelledby":"delete-notes-modal",title:x,onCancel:o,onConfirm:s,isLoading:n,cancelButtonText:S,confirmButtonText:j,buttonColor:"danger",defaultFocusedButton:"confirm"},(u=t.length,b.i18n.translate("xpack.securitySolution.notes.management.deleteNotesConfirm",{values:{selectedNotes:u},defaultMessage:"Are you sure you want to delete {selectedNotes} {selectedNotes, plural, one {note} other {notes}}?"})));var u}));_.displayName="DeleteConfirmModal";var N=n(377);const D=Object(a.memo)((({eventId:e})=>{const t={event:{id:[e]},_id:e},{investigateInTimelineAlertClick:n}=Object(N.a)({ecsRowData:t});return i.a.createElement(l.EuiLink,{onClick:n,"data-test-subj":"open-event-in-timeline"},I)}));D.displayName="OpenEventInTimeline";const A=e=>[{field:"created",name:g,sortable:!0,render:e=>i.a.createElement(o.b,{value:e})},{field:"createdBy",name:y},{field:"eventId",name:v,sortable:!0,render:e=>i.a.createElement(D,{eventId:e})},{field:"timelineId",name:h,render:t=>t?i.a.createElement(l.EuiLink,{onClick:()=>e({timelineId:t,duplicate:!1})},w):null},{field:"note",name:E}],R=[10,25,50,100],F=({onOpenTimeline:e})=>{const t=Object(r.useDispatch)(),n=Object(r.useSelector)(z.h),o=Object(r.useSelector)(z.r),s=Object(r.useSelector)(z.v),u=Object(r.useSelector)(z.t),c=Object(r.useSelector)(z.s).length>0,d=Object(r.useSelector)(z.p),p=d===z.a.Loading,b=d===z.a.Failed,f=Object(r.useSelector)(z.o),g=Object(a.useCallback)((()=>{t(Object(z.d)({page:o.page,perPage:o.perPage,sortField:s.field,sortOrder:s.direction,filter:"",search:u}))}),[t,o.page,o.perPage,s.field,s.direction,u]);Object(a.useEffect)((()=>{g()}),[g]);const y=Object(a.useCallback)((({page:e,sort:n})=>{e&&(t(Object(z.A)(e.index+1)),t(Object(z.B)(e.size))),n&&t(Object(z.E)({field:n.field,direction:n.direction}))}),[t]),v=Object(a.useCallback)((e=>{t(Object(z.D)(e))}),[t]),h=Object(a.useCallback)((e=>{const n=e.map((e=>e.noteId));t(Object(z.C)(n))}),[t]),E=Object(a.useCallback)((e=>e.noteId),[]),x=Object(a.useMemo)((()=>{const t=[{name:j,description:T,color:"primary",icon:"trash",type:"icon",onClick:e=>v(e.noteId)}];return[...A(e),{name:"actions",actions:t}]}),[v,e]),S=Object(a.useMemo)((()=>({pageIndex:o.page-1,pageSize:o.perPage,totalItemCount:o.total,pageSizeOptions:R})),[o]),k=Object(a.useMemo)((()=>({onSelectionChange:h,selectable:()=>!0})),[h]),C=Object(a.useMemo)((()=>({sort:s})),[s]);return b?i.a.createElement(l.EuiEmptyPrompt,{iconType:"error",color:"danger",title:i.a.createElement("h2",null,O),body:i.a.createElement("p",null,f)}):i.a.createElement(i.a.Fragment,null,i.a.createElement(m,null),i.a.createElement(M,null),i.a.createElement(l.EuiBasicTable,{items:n,pagination:S,columns:x,onChange:y,selection:k,sorting:C,itemId:E,loading:p}),c&&i.a.createElement(_,null))};F.displayName="NoteManagementPage";var z=n(289)},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(765);function i(e,t){var n;const i=t?t(e):function(e){var t;return e.timeSeriesMetric||(null!==(t=e.type)&&void 0!==t?t:"string")}(e),l=(null===(n=e.esTypes)||void 0===n?void 0:n[0])||null;return l&&["_id","_index","_ignored"].includes(l)&&"string"===i?"keyword":"unknown"===i&&l&&Object(a.c)(l)||"string"===i&&l?l:i}},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},708:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return y})),n.d(t,"e",(function(){return v})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return E}));var a=n(72),i=n(19),l=n(2),r=n.n(l),o=n(41),s=n.n(o),u=n(118);const c="100%",d=s.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:c};\n  `));d.displayName="WrappedByAutoSizer";const m=r.a.memo(d),p={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},b=()=>({baseTheme:Object(u.g)()?a.LEGACY_DARK_THEME:a.LEGACY_LIGHT_THEME,theme:p}),f={rotation:0,rendering:"canvas",showLegend:!1,legendValues:[],debug:!1,legendPosition:a.Position.Bottom},g=(e,t)=>{const n=e||t;return n?`${n}px`:c},y=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},v=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),h=s.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),E=(s()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),s()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"]))},716:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},717:function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return C}));var a=n(188),i=n.n(a),l=n(44),r=n(2),o=n(45),s=n(3),u=n(55),c=n(1484),d=n(118),m=n(376),p=n(129),b=n(978),f=n(131),g=n(137),y=n(146),v=n(246),h=n(980),E=n(763),j=n(5),T=n(764);const O="timelineEventsQuery",x=[{field:"@timestamp",direction:g.b.asc,type:"date",esTypes:["date"]}],S=e=>({...Object(l.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(l.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(l.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(l.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),k=({dataViewId:e,endDate:t,eqlOptions:n,id:a=O,indexNames:T,fields:k,filterQuery:C,runtimeMappings:w,startDate:I,language:M="kuery",limit:_,sort:N=x,skip:D=!1,timerangeKind:A})=>{const[{pageName:R}]=Object(v.a)(),F=Object(o.useDispatch)(),{data:z}=Object(d.j)().services,P=Object(r.useRef)(l.noop),L=Object(r.useRef)(new AbortController),B=Object(r.useRef)(new s.Subscription),[q,$]=Object(r.useState)(c.a.loaded),[V,G]=Object(r.useState)(a===y.c.active?h.a.getActivePage():0),[U,H]=Object(r.useState)(null),Q=Object(r.useRef)(null),{startTracking:W}=Object(E.a)(),J=Object(r.useCallback)((()=>{null!=a&&b.a.some((e=>e===a))&&(F(p.a.clearEventsLoading({id:a})),F(p.a.clearEventsDeleted({id:a})))}),[F,a]),X=Object(r.useCallback)((e=>{J(),a===y.c.active&&h.a.setActivePage(e),G(e)}),[J,a]),K=Object(r.useCallback)((()=>{null!=P.current&&P.current(),X(0)}),[X]),[Y,Z]=Object(r.useState)({id:a,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:X,refreshedAt:0}),ee=Object(r.useCallback)((async(t,n)=>{if(null==t||""===R||D)return;const i=async()=>{Q.current=t,L.current=new AbortController,$(0===V?c.a.loading:c.a.loadingMore);const{endTracking:i}=W({name:`${j.m} timeline events search`});B.current=z.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:L.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(u.isRunningResponse)(e)||(i("success"),$(c.a.loaded),Z((i=>{const l={...i,events:(r=e.edges,r.map((e=>e.node))),inspect:Object(f.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var r;return a===y.c.active&&(h.a.setPageName(R),"eql"===t.language?(h.a.setEqlRequest(t),h.a.setEqlResponse(l)):(h.a.setRequest(t),h.a.setResponse(l))),n&&n(l),l})),B.current.unsubscribe())},error:e=>{i(L.current.signal.aborted?"aborted":"error"),$(c.a.loaded),z.search.showError(e),B.current.unsubscribe()}})};if(a===y.c.active&&""!==h.a.getPageName()&&R!==h.a.getPageName()){if(h.a.setPageName(R),L.current.abort(),$(c.a.loaded),"eql"===t.language?(Q.current=h.a.getEqlRequest(),P.current=i.bind(null,h.a.getEqlRequest())):(Q.current=h.a.getRequest(),P.current=i.bind(null,h.a.getRequest())),Z((e=>{const n="eql"===t.language?h.a.getEqlResponse():h.a.getResponse();return null!=n?{...n,refetch:K,loadPage:X}:e})),"eql"!==t.language&&null!=h.a.getResponse())return;if("eql"===t.language&&null!=h.a.getEqlResponse())return}B.current.unsubscribe(),L.current.abort(),await i(),P.current=i}),[R,D,a,V,W,z.search,e,K,X]);Object(r.useEffect)((()=>{0!==T.length&&H((e=>{var l,r,o,s,u,c,d;const p=e,b={defaultIndex:null!==(l=null==e?void 0:e.defaultIndex)&&void 0!==l?l:[],filterQuery:null!==(r=null==e?void 0:e.filterQuery)&&void 0!==r?r:"",querySize:null!==(o=null==e||null===(s=e.pagination)||void 0===s?void 0:s.querySize)&&void 0!==o?o:0,sort:null!==(u=null==e?void 0:e.sort)&&void 0!==u?u:x,timerange:null!==(c=null==e?void 0:e.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(d=null==e?void 0:e.runtimeMappings)&&void 0!==d?d:{},...S(p)},f=I&&t?{timerange:{interval:"12h",from:I,to:t}}:{},v={defaultIndex:T,filterQuery:Object(m.a)(C),querySize:_,sort:N,runtimeMappings:w,...f,...S(n)},E=i()(b,v)?V:0;let j=k;const O=k.filter((t=>{var n;return!(null!=e&&null!==(n=e.fieldRequested)&&void 0!==n&&n.includes(t))}));var D,A;j=O.length>0?[...null!==(D=null==e?void 0:e.fieldRequested)&&void 0!==D?D:[],...O]:null!==(A=null==e?void 0:e.fieldRequested)&&void 0!==A?A:[];const R={defaultIndex:T,factoryQueryType:g.w.all,fieldRequested:j,fields:j,filterQuery:Object(m.a)(C),pagination:{activePage:E,querySize:_},language:M,runtimeMappings:w,sort:N,...f,...n||{}};return V!==E&&(G(E),a===y.c.active&&h.a.setActivePage(E)),i()(e,R)?e:R}))}),[F,T,V,t,n,C,a,M,_,I,N,k,w]);const te=Object(r.useCallback)((async e=>{a===y.c.active&&"absolute"!==A&&i()(Q.current,U)||await ee(U,e)}),[a,U,ee,A]);return Object(r.useEffect)((()=>{Object(l.isEmpty)(C)&&Z({id:a,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:X,refreshedAt:0})}),[C,a,K,X]),[q,Y,te]},C=({dataViewId:e,endDate:t,eqlOptions:n,id:a=O,indexNames:i,fields:l,filterQuery:o,runtimeMappings:s,startDate:u,language:c="kuery",limit:d,sort:m=x,skip:p=!1,timerangeKind:b,fetchNotes:f=!0})=>{const[g,y,v]=k({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:i,fields:l,filterQuery:o,runtimeMappings:s,startDate:u,language:c,limit:d,sort:m,skip:p,timerangeKind:b}),{onLoad:h}=Object(T.a)(),E=Object(r.useCallback)((e=>{f&&h(e.events)}),[f,h]);return Object(r.useEffect)((()=>{v&&v(E)}),[v,E]),[g,y]}},718:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return b}));var a=n(44),i=n(53),l=n(121),r=n(179);const o=["host.name","host.hostname","host.domain","host.id","host.ip","client.ip","destination.ip","server.ip","source.ip","network.community_id","user.name","process.name"],s=(e,t,n=console)=>{var a,i;const l=null!==(a=null===(i=t.find((t=>t.field===e)))||void 0===i?void 0:i.values)&&void 0!==a?a:null;return null==l?[]:"string"==typeof l?[l]:Array.isArray(l)&&l.every((e=>"string"==typeof e))?l:(n.trace("Data type that is not a string or string array detected:",l,"when trying to access field:",e,"from data object of:",t),[])},u=(e,t=[])=>{let n=t;return"is"===e.function&&o.includes(e.arguments[0].value)&&(n=[...n,{field:e.arguments[0].value,valueToChange:e.arguments[1].value}]),e.arguments.reduce(((e,t)=>"is"===t.function&&o.includes(t.arguments[0].value)?[...e,{field:t.arguments[0].value,valueToChange:t.arguments[1].value}]:t.arguments?u(t,e):e),n)},c=(e,t,n=l.m.default)=>n===l.m.default?""!==e.trim()?u(Object(i.fromKueryExpression)(e)).reduce(((e,n)=>{const a=s(n.field,t);return a.length?e.replace(n.valueToChange,a[0]):e}),e):"":e.trim(),d=(e,t)=>e.map((e=>{if("phrase"===e.meta.type&&null!=e.meta.key&&o.includes(e.meta.key)){const n=s(e.meta.key,t);n.length&&(e.meta.params={query:n[0]},e.query={match_phrase:{[e.meta.key]:n[0]}})}return e})),m=(e,t,n=l.m.default)=>{if(n!==l.m.template){if(o.includes(e.queryMatch.field)){const n=s(e.queryMatch.field,t);n.length&&(e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0)}return e.type=r.a.default,e}if(n===l.m.template){var a;if(e.type===r.a.template&&":"===e.queryMatch.operator){const n=s(e.queryMatch.field,t);return n.length||(e.enabled=!1),e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0,e.type=r.a.default,e}return e.type=null!==(a=e.type)&&void 0!==a?a:r.a.default,e}return e},p=(e,t,n=l.m.default)=>e.map((e=>{const i=m(e,t,n);return null==i.and||Object(a.isEmpty)(i.and)||(i.and=i.and.map((e=>m(e,t,n)))),i})),b=(e,t)=>[{range:{"@timestamp":{gte:e,lte:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lte:t,format:"strict_date_optional_time"}},$state:{store:i.FilterStateStore.APP_STATE}}]},719:function(e,t,n){"use strict";var a=Array.isArray,i=Object.keys,l=Object.prototype.hasOwnProperty,r="undefined"!=typeof Element;function o(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,s,u,c=a(e),d=a(t);if(c&&d){if((s=e.length)!=t.length)return!1;for(n=s;0!=n--;)if(!o(e[n],t[n]))return!1;return!0}if(c!=d)return!1;var m=e instanceof Date,p=t instanceof Date;if(m!=p)return!1;if(m&&p)return e.getTime()==t.getTime();var b=e instanceof RegExp,f=t instanceof RegExp;if(b!=f)return!1;if(b&&f)return e.toString()==t.toString();var g=i(e);if((s=g.length)!==i(t).length)return!1;for(n=s;0!=n--;)if(!l.call(t,g[n]))return!1;if(r&&e instanceof Element&&t instanceof Element)return e===t;for(n=s;0!=n--;)if(!("_owner"===(u=g[n])&&e.$$typeof||o(e[u],t[u])))return!1;return!0}return e!=e&&t!=t}e.exports=function(e,t){try{return o(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}}},720:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),l=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},742:function(e,t,n){"use strict";n.d(t,"b",(function(){return R})),n.d(t,"a",(function(){return q}));var a=n(44),i=n(19),l=n(42),r=n(2),o=n.n(r),s=n(41),u=n.n(s),c=n(45),d=n(1216),m=n(122),p=n(118),b=n(145),f=n(130),g=n(300),y=n(129),v=n(272),h=n(4);const E=h.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),j=h.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),T=h.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),O=h.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),x=h.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),S=h.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),k=h.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var C=n(146),w=n(124),I=n(127),M=n(132),_=n(47),N=n(123),D=n(260),A=n(909);const R=u.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));R.displayName="NotePreviewsContainer";const F=({eventId:e,timelineId:t})=>{const n=Object(c.useDispatch)(),{selectedPatterns:a}=Object(M.a)(I.SourcererScopeName.timeline),{telemetry:l}=Object(p.j)().services,{openFlyout:s}=Object(d.a)(),u=Object(m.a)("expandableFlyoutDisabled"),f=Object(r.useCallback)((()=>{const i=a.join(",");u?n(y.a.toggleDetailPanel({panelView:"eventDetail",tabType:C.d.notes,id:t,params:{eventId:e,indexName:i}})):(s({right:{id:b.e,params:{id:e,indexName:i,scopeId:t}}}),l.reportDetailsFlyoutOpened({location:t,panel:"right"}))}),[n,e,u,s,a,l,t]);return o.a.createElement(i.EuiButtonIcon,{"data-test-subj":"notes-toggle-event-details",title:E,"aria-label":E,color:"text",iconType:"arrowRight",onClick:f})},z=o.a.memo(F),P=o.a.memo((({closeModal:e,confirmModal:t})=>o.a.createElement(i.EuiConfirmModal,{title:k,onCancel:e,onConfirm:t,cancelButtonText:S,confirmButtonText:x,buttonColor:"danger",defaultFocusedButton:"confirm"})));P.displayName="DeleteNoteConfirm";const L=o.a.memo((({noteId:e,eventId:t,confirmingNoteId:n,timelineId:a,eventIdToNoteIds:l,savedObjectId:s})=>{const u=Object(c.useDispatch)(),[d,m]=Object(r.useState)(!1),{mutate:b,isLoading:f}=function(e,t,n,a){const{services:{http:i}}=Object(p.j)(),l=Object(c.useDispatch)(),{addError:r}=Object(N.a)();return Object(_.useMutation)({mutationFn:e=>i.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{const i=null==n?void 0:n[null!=t?t:""];a&&l(D.a.deleteNote({id:a})),e&&t&&l(y.a.deleteNoteFromEvent({id:C.c.active,noteId:e,eventId:t})),t&&i&&1===i.length&&l(y.a.unPinEvent({eventId:t,id:C.c.active}))},onError:e=>{var t;r(e,{title:(t=e,h.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:"string"==typeof t?t:null==t?void 0:t.message}}))})}})}(e,t,l,s),g=Object(r.useCallback)((()=>{m(!0),u(y.a.setConfirmingNoteId({confirmingNoteId:e,id:null!=a?a:C.c.active}))}),[e,u,a]),v=Object(r.useCallback)((()=>{m(!1),u(y.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:C.c.active}))}),[u,a]),E=Object(r.useCallback)((()=>{b(s),m(!1),u(y.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:C.c.active}))}),[b,s,u,a]),j=Object(r.useMemo)((()=>f||null==s),[f,s]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiButtonIcon,{title:x,"aria-label":x,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:g,disabled:j}),n===e&&d?o.a.createElement(P,{closeModal:v,confirmModal:E}):null)}));L.displayName="DeleteNoteButton";const B=o.a.memo((({eventId:e,timelineId:t,noteId:n,confirmingNoteId:a,eventIdToNoteIds:i,savedObjectId:l,showToggleEventDetailsAction:r=!0})=>e&&t?o.a.createElement(o.a.Fragment,null,r?o.a.createElement(z,{eventId:e,timelineId:t}):null,o.a.createElement(L,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:l,timelineId:t,eventIdToNoteIds:i})):o.a.createElement(L,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:l,timelineId:t,eventIdToNoteIds:i})));B.displayName="NoteActions";const q=o.a.memo((({notes:e,timelineId:t,showTimelineDescription:n,showToggleEventDetailsAction:s=!0})=>{const u=Object(r.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),c=Object(r.useMemo)((()=>Object(A.a)()),[]),d=Object(w.a)((e=>u(e,null!=t?t:C.c.active))),m=Object(w.a)((e=>c(e,null!=t?t:C.c.active))),p=null==m?void 0:m.eventIdToNoteIds,b=Object(r.useMemo)((()=>n&&t&&null!=d&&d.description?[{username:Object(f.a)(d.updatedBy),event:T,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:d.updated?o.a.createElement(l.FormattedRelative,{"data-test-subj":"updated",value:new Date(d.updated)}):Object(f.e)(),children:o.a.createElement(i.EuiText,{size:"s"},d.description),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=d.updatedBy?d.updatedBy:"?",size:"l"}),actions:null}]:[]),[d,t,n]),h=Object(r.useMemo)((()=>Object(a.uniqBy)("savedObjectId",e).map((e=>{var n,a,r;const u=null!=p?Object.entries(p).reduce(((t,[n,a])=>{var i;return a.includes(null!==(i=e.noteId)&&void 0!==i?i:"")?n:t}),null):null!==(n=e.eventId)&&void 0!==n?n:null;return{"data-test-subj":`note-preview-${e.savedObjectId}`,username:Object(f.a)(e.updatedBy),event:j,timestamp:e.updated?o.a.createElement(l.FormattedRelative,{"data-test-subj":"updated",value:new Date(e.updated)}):Object(f.e)(),children:o.a.createElement("div",{className:v.a,tabIndex:0},o.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},o.a.createElement("p",null,`${null!==(a=e.updatedBy)&&void 0!==a?a:O} ${j}`)),o.a.createElement(g.b,null,null!==(r=e.note)&&void 0!==r?r:"")),actions:o.a.createElement(B,{eventId:u,timelineId:t,noteId:e.noteId,savedObjectId:e.savedObjectId,confirmingNoteId:null==d?void 0:d.confirmingNoteId,eventIdToNoteIds:p,showToggleEventDetailsAction:s}),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=e.updatedBy?e.updatedBy:"?",size:"l"})}}))),[p,e,t,null==d?void 0:d.confirmingNoteId,s]),E=Object(r.useMemo)((()=>[...b,...h]),[b,h]);return o.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:E})}));q.displayName="NotePreviews"},752:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46),i=n(796),l=n(750);const r=new a.Type("NonEmptyEntriesArray",i.a.is,((e,t)=>Array.isArray(e)&&0===e.length?a.failure(e,t):Array.isArray(e)&&e.some((e=>l.a.is(e)))&&e.some((e=>!l.a.is(e)))?a.failure(e,t,"Cannot have entry of type list and other"):i.a.validate(e,t)),a.identity)},754:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),i=n.n(a),l=n(19),r=n(42),o=n(54),s=n.n(o),u=n(2),c=n.n(u);const d=c.a.memo((({children:e,date:t,fieldName:n,className:a="",tooltipProps:o})=>c.a.createElement(l.EuiToolTip,i()({"data-test-subj":"localized-date-tool-tip",anchorClassName:a},o,{content:c.a.createElement(l.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?c.a.createElement(l.EuiFlexItem,{grow:!1},c.a.createElement("span",{"data-test-subj":"field-name"},n)):null,c.a.createElement(l.EuiFlexItem,{grow:!1},c.a.createElement(r.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:s.a.utc(t).toDate()})),c.a.createElement(l.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},s.a.utc(t).local().format("llll")),c.a.createElement(l.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},s()(t).format()))}),c.a.createElement(c.a.Fragment,null,e))));d.displayName="LocalizedDateTooltip"},760:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),i=n(2),l=n.n(i),r=n(41),o=n.n(r),s=n(228);const u=o.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e,onClick:t})=>{const n=Object(i.useCallback)((()=>t&&t()),[t]);return e?t?l.a.createElement(a.EuiLink,{onClick:n},l.a.createElement("b",null,l.a.createElement(s.a,{count:e}))):l.a.createElement("b",null,l.a.createElement(s.a,{count:e})):l.a.createElement(u,null)};c.displayName="ChartLabelComponent";const d=l.a.memo(c)},761:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return h}));var a=n(19),i=n(2),l=n.n(i),r=n(72),o=n(7),s=n(41),u=n.n(s),c=n(4),d=n(708),m=n(882),p=n(770);const b={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},f=u()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),g=u()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),y=({children:e,dataExists:t,donutTextWrapperClassName:n,donutTextWrapperStyles:r,isChartEmbeddablesEnabled:o,label:s,title:u})=>{const{euiTheme:c}=Object(a.useEuiTheme)(),d=Object(i.useMemo)((()=>({color:c.colors.darkShade})),[c.colors.darkShade]),m=o?void 0:"eui-textTruncate";return l.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},l.a.createElement(g,{grow:o},l.a.createElement(f,{$dataExists:t,$donutTextWrapperStyles:r,$isChartEmbeddablesEnabled:o,alignItems:"center",className:n,direction:"column",gutterSize:"none",justifyContent:"center"},l.a.createElement(a.EuiFlexItem,null,u),s&&l.a.createElement(a.EuiFlexItem,{className:m},l.a.createElement(a.EuiToolTip,{content:s},l.a.createElement(a.EuiText,{className:m,size:"s",style:t?void 0:d},s)))),e))},v=l.a.memo(y),h=({data:e,fillColor:t,height:n=90,label:s,legendItems:u,onPartitionClick:f,title:g,totalCount:y})=>{const{baseTheme:h,theme:E}=Object(d.h)(),j=Object(i.useCallback)((e=>{if(f){var t;const n=e.flat(2),a=n.length>0&&"groupByRollup"in n[0]&&null!=(null===(t=n[0])||void 0===t?void 0:t.groupByRollup)?`${n[0].groupByRollup}`:"";Object(o.isEmpty)(a.trim())||f(a.toLowerCase())}}),[f]);return l.a.createElement(v,{dataExists:null!=e&&e.length>0,label:s,title:g,isChartEmbeddablesEnabled:!1},l.a.createElement(l.a.Fragment,null,null==e||null==y||0===y?l.a.createElement(p.a,{size:n}):l.a.createElement(r.Chart,{size:n},l.a.createElement(r.Settings,{theme:[b,E],baseTheme:h,onElementClick:j,locale:c.i18n.getLocale()}),l.a.createElement(r.Partition,{id:"donut-chart",data:e,layout:r.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(r.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),u&&(null==u?void 0:u.length)>0&&l.a.createElement(a.EuiFlexItem,null,l.a.createElement(m.a,{legendItems:u,height:n}))))}},763:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(187);const l=()=>{const{startTransaction:e}=Object(i.b)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),i=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==i||i.end()}}}),[e])}}},764:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(45),l=n(122),r=n(697);const o=()=>{const e=Object(i.useDispatch)(),t=Object(l.a)("securitySolutionNotesEnabled");return{onLoad:Object(a.useCallback)((n=>{if(!t||0===n.length)return;const a=n.map((e=>e._id)).filter((e=>null!=e));e(Object(r.e)({documentIds:a}))}),[e,t])}}},765:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l}));let a=function(e){return e.DOCUMENT="document",e.BINARY="binary",e.BOOLEAN="boolean",e.CONFLICT="conflict",e.COUNTER="counter",e.DATE="date",e.DATE_RANGE="date_range",e.DENSE_VECTOR="dense_vector",e.GAUGE="gauge",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.HISTOGRAM="histogram",e.IP="ip",e.IP_RANGE="ip_range",e.FLATTENED="flattened",e.KEYWORD="keyword",e.MURMUR3="murmur3",e.NUMBER="number",e.NESTED="nested",e.RANK_FEATURE="rank_feature",e.RANK_FEATURES="rank_features",e.POINT="point",e.SHAPE="shape",e.SPARSE_VECTOR="sparse_vector",e.SEMANTIC_TEXT="semantic_text",e.STRING="string",e.TEXT="text",e.VERSION="version",e}({});const i=Object.values(a),l=e=>!!e&&i.includes(e)},766:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(79),l=n(132),r=n(118);const o=({sourcererScope:e})=>{const{services:{fieldFormats:t}}=Object(r.j)(),{sourcererDataView:n}=Object(l.a)(e);return Object(a.useMemo)((()=>n?new i.DataView({spec:n,fieldFormats:t}):void 0),[n,t])}},767:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),l=n(446);const r=Object(l.c)(),o=Object(l.c)(),s=()=>{const[e]=Object(a.useState)(r);return{portalNode:e}},u=i.a.memo((()=>{const{portalNode:e}=s();return i.a.createElement(l.b,{node:e})}));u.displayName="TimelineEventsCountBadge";const c=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=c();return i.a.createElement(l.b,{node:e})}));d.displayName="EqlEventsCountBadge"},768:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const a=new MutationObserver((()=>{const a=!!document.getElementById(e);a&&!t&&n(!0),!a&&t&&n(!1)}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[t,e]),t}},769:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return r}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),l=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),r=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},770:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),l=n(41),r=n.n(l),o=n(19);const s="#FAFBFD",u=r.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${s};\n    text-align: center;\n    line-height: ${e}px;`)),c=r.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(o.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(u,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,m=i.a.memo(d)},794:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);a.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),a.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),a.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const i="siem"},811:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(273),i=n(1275),l=n(26);const r=`${l.c}: true`,o=`${l.c}: false`,s=`${l.a}: true`,u=`${l.a}: false`;function c({filter:e,showCustomRules:t,showElasticRules:n,enabled:c,tags:m,excludeRuleTypes:p=[],ruleExecutionStatus:b}){const f=[];var g;return null!=e&&e.length&&f.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(i.b)(e)}`)).join(" OR ")}(e)})`),t&&n||(n?f.push(r):t&&f.push(o)),void 0!==c&&f.push(c?s:u),null!=m&&m.length&&f.push(function(e){return`${l.g}:(${e.map(i.b).join(" AND ")})`}(m)),p.length&&f.push("NOT "+(g=p,`${l.d}: (${g.map(i.b).join(" OR ")})`)),b===a.f.succeeded?f.push(`${l.b}: "succeeded"`):b===a.f["partial failure"]?f.push(`${l.b}: "warning"`):b===a.f.failed&&f.push(`${l.b}: "failed"`),f.join(" AND ")}const d=[l.e,l.f.INDEX,l.f.TACTIC_ID,l.f.TACTIC_NAME,l.f.TECHNIQUE_ID,l.f.TECHNIQUE_NAME,l.f.SUBTECHNIQUE_ID,l.f.SUBTECHNIQUE_NAME]},813:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return v})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return E})),n.d(t,"n",(function(){return j})),n.d(t,"o",(function(){return T})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return x})),n.d(t,"r",(function(){return S})),n.d(t,"s",(function(){return k})),n.d(t,"t",(function(){return D})),n.d(t,"u",(function(){return N})),n.d(t,"v",(function(){return I})),n.d(t,"w",(function(){return _})),n.d(t,"x",(function(){return w})),n.d(t,"y",(function(){return M})),n.d(t,"z",(function(){return A})),n.d(t,"A",(function(){return R})),n.d(t,"C",(function(){return F})),n.d(t,"B",(function(){return z})),n.d(t,"D",(function(){return i})),n.d(t,"E",(function(){return l})),n.d(t,"F",(function(){return r})),n.d(t,"G",(function(){return o}));var a=n(748);const i="ecs.version",l="event.action",r="event.kind",o="tags",s=`${a.k}.risk_score`,u=`${a.s}.author`,c=`${a.s}.created_at`,d=`${a.s}.created_by`,m=`${a.s}.description`,p=`${a.s}.enabled`,b=`${a.s}.from`,f=`${a.s}.interval`,g=`${a.s}.license`,y=`${a.s}.note`,v=`${a.s}.references`,h=`${a.s}.rule_id`,E=`${a.s}.rule_name_override`,j=`${a.s}.to`,T=`${a.s}.type`,O=`${a.s}.updated_at`,x=`${a.s}.updated_by`,S=`${a.s}.version`,k=`${a.k}.severity`,C=`${a.k}.suppression`,w=`${C}.terms`,I=`${w}.field`,M=`${w}.value`,_=`${C}.start`,N=`${C}.end`,D=`${C}.docs_count`,A=`${a.k}.system_status`,R=`${a.k}.workflow_reason`,F=`${a.k}.workflow_user`,z=`${a.k}.workflow_status_updated_at`},815:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(19),i=n(2),l=n.n(i),r=n(163),o=n(951);const s=l.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:i})=>l.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},l.a.createElement(o.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:r.G}))));s.displayName="OpenTimelineModal"},816:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},817:function(e,t,n){"use strict";n.d(t,"a",(function(){return F})),n.d(t,"c",(function(){return $})),n.d(t,"b",(function(){return V}));var a=n(44),i=n(54),l=n.n(i),r=n(63),o=n.n(r),s=n(53),u=n(4),c=n(813),d=n(748),m=n(3),p=n(572),b=n(165),f=n(146),g=n(121),y=n(1246),v=n(158),h=n(184),E=n(250),j=n(131),T=n(718),O=n(292),x=n(118),S=n(5),k=n(1253),C=n(396);n(479);const w=({ecs:e})=>{if(Array.isArray(e)){const t=e.reduce(((e,t)=>{const n=t.timestamp?new Date(t.timestamp):new Date;return e.includes(n.valueOf())?e:[...e,n.valueOf()]}),[]);return{from:new Date(Math.min(...t)).toISOString(),to:new Date(Math.max(...t)).toISOString()}}const t=e,n=Object(j.getField)(t,c.g),a=l.a.duration(l()().diff(o.a.parse(null!=n?n[0]:"now-1d"))),i=Object(j.getField)(t,d.K),r=Array.isArray(i)?i[0]:i,s=l()(null!=r?r:new Date).toISOString();return{to:s,from:l()(s).subtract(a).toISOString()}},I=e=>{const t=Object(j.getField)(e,c.o);return Array.isArray(t)?t[0]:t},M=e=>Object(b.f)(I(e)),_=e=>Object(b.d)(I(e)),N=e=>Object(b.b)(I(e)),D=e=>Object(b.n)(I(e)),A=e=>Object(b.e)(I(e)),R=e=>null!=Object(j.getField)(e,c.t),F=(e,t,n="Alert Ids")=>1===t.length?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:e,params:{query:t[0]}},query:{match_phrase:{_id:t[0]}},$state:{store:s.FilterStateStore.APP_STATE}}]:[{query:{bool:{filter:{ids:{values:t}}}},meta:{alias:n,negate:!1,disabled:!1,type:"phrases",key:e,value:t.join(),params:t},$state:{store:s.FilterStateStore.APP_STATE}}],z=(e,t)=>{const n=1===t.length;return[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${f.c.active}-alert-id-${t.join(",")}`,name:t.join(","),enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:n?t[0]:t,operator:n?":":"includes"}}]},P=(e,t,n)=>({filters:"KqlFilter"===t?F("_id",e,n):[],dataProviders:"dataProvider"===t?z("_id",e):[]}),L=async(e,t,n,a,i)=>{try{var r,s,m,b,g,y,h,E,T,O,w,I,M,_,N,D,A,R,F,z,P,L;const u=await x.b.get().http.fetch(S.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),C=(null!==(r=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==r?r:[])[0],B=Object(j.getField)(C,d.t),q=Object(j.getField)(C,c.d),$=(null!==(s=null!==(m=B.filters)&&void 0!==m?m:null===(b=C.signal)||void 0===b||null===(g=b.rule)||void 0===g?void 0:g.filters)&&void 0!==s?s:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),V=null!==(y=null!==(h=B.language)&&void 0!==h?h:null===(E=C.signal)||void 0===E||null===(T=E.rule)||void 0===T?void 0:T.language)&&void 0!==y?y:"kuery",G=null!==(O=null!==(w=B.query)&&void 0!==w?w:null===(I=C.signal)||void 0===I||null===(M=I.rule)||void 0===M?void 0:M.query)&&void 0!==O?O:"",U=null!==(_=null!==(N=Object(j.getField)(C,p.h))&&void 0!==N?N:null===(D=C.signal)||void 0===D||null===(A=D.rule)||void 0===A?void 0:A.index)&&void 0!==_?_:[],{thresholdFrom:H,thresholdTo:Q,dataProviders:W}=(e=>(Array.isArray(e)?e:[e]).reduce(((e,t)=>{var n,a,i,r;const s=null!==(n=Object(j.getField)(t,`${d.t}.threshold`))&&void 0!==n?n:null===(a=t.signal)||void 0===a||null===(i=a.rule)||void 0===i?void 0:i.threshold,u=Object(j.getField)(t,p.j),m=Object(j.getField)(t,p.g),b=Array.isArray(m)?m[0]:m,g=l()(b),y=((e,t)=>{const n=Object(j.getField)(e,c.g),a=Array.isArray(n)?n[0]:n,i=o.a.parse(a),r=l()(),s=l.a.duration(r.diff(i));return t.clone().subtract(s)})(t,g),v=Array.isArray(s.field)?s.field:[s.field];return{thresholdFrom:null!==(r=u.from)&&void 0!==r?r:y.toISOString(),thresholdTo:g.toISOString(),dataProviders:[...e.dataProviders,...v.reduce(((e,t,n)=>{const a=u.terms.filter((e=>e.field===t))[0].value,i=Array.isArray(a)?a[0]:a;if(!i)return e;const l=t.replace(".","-"),r={id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${f.c.active}-${l}-${i}`,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:i,operator:":"}};return 0===n?[...e,{...r,and:[]}]:(e[0].and.push(r),e)}),[])]}}),{dataProviders:[],thresholdFrom:"",thresholdTo:""}))(C),J=await i(e),X=(null!==(R=a.filters)&&void 0!==R?R:$).concat(J?[J]:[]);return t({from:H,notes:null,timeline:{...v.b,excludedRowRendererIds:[],columns:null!==(F=a.columns)&&void 0!==F?F:v.b.columns,description:`_id: ${C._id}`,filters:X,dataProviders:null!==(z=a.dataProviders)&&void 0!==z?z:W,id:f.c.active,indexNames:U,dateRange:{start:H,end:Q},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:V,expression:null!==(P=a.query)&&void 0!==P?P:G},serializedQuery:null!==(L=a.query)&&void 0!==L?L:G}}},to:Q,ruleNote:n,ruleAuthor:q})}catch(n){const{toasts:a}=x.b.get().notifications;a.addError(n,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailureTitle",{defaultMessage:"Failed to create threshold alert timeline"})});const i=C.a.toISOString(),l=C.b.toISOString();return t({from:i,notes:null,timeline:{...v.b,id:f.c.active,indexNames:[],dateRange:{start:i,end:l},eventType:"all"},to:l})}},B=async(e,t,n,a,i)=>{try{var r,o,s,c,m,b,g,y,h,E,T,O,w,I,M,_,N,D,A,R,F,z;const u=await x.b.get().http.fetch(S.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),C=(null!==(r=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==r?r:[])[0],P=Object(j.getField)(C,d.t),L=(null!==(o=null!==(s=P.filters)&&void 0!==s?s:null===(c=C.signal)||void 0===c||null===(m=c.rule)||void 0===m?void 0:m.filters)&&void 0!==o?o:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),B=null!==(b=null!==(g=P.language)&&void 0!==g?g:null===(y=C.signal)||void 0===y||null===(h=y.rule)||void 0===h?void 0:h.language)&&void 0!==b?b:"kuery",q=null!==(E=null!==(T=P.query)&&void 0!==T?T:null===(O=C.signal)||void 0===O||null===(w=O.rule)||void 0===w?void 0:w.query)&&void 0!==E?E:"",$=null!==(I=null!==(M=Object(j.getField)(C,p.h))&&void 0!==M?M:null===(_=C.signal)||void 0===_||null===(N=_.rule)||void 0===N?void 0:N.index)&&void 0!==I?I:[],{from:V,to:G,dataProviders:U}=(e=>{var t;const n=Array.isArray(e)?e[0]:e,a=Object(j.getField)(n,p.g),i=(null!==(t=Object(j.getField)(n,`${d.t}.new_terms_fields`))&&void 0!==t?t:[]).map(((e,t)=>{const a=e.replace(".","-"),i=Object(j.getField)(n,p.d)[t];return{id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${f.c.active}-${a}-${i}`,name:e,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:i,operator:":"},and:[]}})),r=i.length?[{...i[0],and:i.slice(1)}]:[];return{from:a,to:l()().toISOString(),dataProviders:r}})(C),H=await i(e),Q=(null!==(D=a.filters)&&void 0!==D?D:L).concat(H?[H]:[]);return t({from:V,notes:null,timeline:{...v.b,columns:null!==(A=a.columns)&&void 0!==A?A:v.b.columns,excludedRowRendererIds:[],description:`_id: ${C._id}`,filters:Q,dataProviders:null!==(R=a.dataProviders)&&void 0!==R?R:U,id:f.c.active,indexNames:$,dateRange:{start:V,end:G},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:B,expression:null!==(F=a.query)&&void 0!==F?F:q},serializedQuery:null!==(z=a.query)&&void 0!==z?z:q}}},to:G,ruleNote:n})}catch(n){const{toasts:a}=x.b.get().notifications;a.addError(n,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailureTitle",{defaultMessage:"Failed to create new terms alert timeline"})});const i=C.a.toISOString(),l=C.b.toISOString();return t({from:i,notes:null,timeline:{...v.b,id:f.c.active,indexNames:[],dateRange:{start:i,end:l},eventType:"all"},to:l})}},q=async(e,t,n,a,i)=>{try{var l,r,o,s,m,b,g,y,h,E,T,O,w,I,M,_,N,D,A,R,F,z;const u=await x.b.get().http.fetch(S.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(k.a)([e._id]))}),C=(null!==(l=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(k.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==l?l:[])[0],P=Object(j.getField)(C,d.t),L=(null!==(r=null!==(o=P.filters)&&void 0!==o?o:null===(s=C.signal)||void 0===s||null===(m=s.rule)||void 0===m?void 0:m.filters)&&void 0!==r?r:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),B=null!==(b=null!==(g=P.language)&&void 0!==g?g:null===(y=C.signal)||void 0===y||null===(h=y.rule)||void 0===h?void 0:h.language)&&void 0!==b?b:"kuery",q=null!==(E=null!==(T=P.query)&&void 0!==T?T:null===(O=C.signal)||void 0===O||null===(w=O.rule)||void 0===w?void 0:w.query)&&void 0!==E?E:"",$=null!==(I=null!==(M=Object(j.getField)(C,p.h))&&void 0!==M?M:null===(_=C.signal)||void 0===_||null===(N=_.rule)||void 0===N?void 0:N.index)&&void 0!==I?I:[],{from:V,to:G,dataProviders:U}=(e=>{const t=Array.isArray(e)?e[0]:e,n=Object(j.getField)(t,c.w),a=Object(j.getField)(t,c.u),i=Object(j.getField)(t,c.x).map((e=>{const t=e.field.replace(".","-"),n=`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${f.c.active}-${t}-${e.value}`;return null==e.value?{id:n,name:t,enabled:!0,excluded:!0,kqlQuery:"",queryMatch:{field:e.field,value:"",operator:":*"}}:{id:n,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e.field,value:e.value,operator:":"}}}));return{from:n,to:a,dataProviders:[{...i[0],and:i.slice(1)}]}})(C),H=await i(e),Q=(null!==(D=a.filters)&&void 0!==D?D:L).concat(H?[H]:[]);return t({from:V,notes:null,timeline:{...v.b,excludedRowRendererIds:[],columns:null!==(A=a.columns)&&void 0!==A?A:v.b.columns,description:`_id: ${C._id}`,filters:Q,dataProviders:null!==(R=a.dataProviders)&&void 0!==R?R:U,id:f.c.active,indexNames:$,dateRange:{start:V,end:G},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:B,expression:null!==(F=a.query)&&void 0!==F?F:q},serializedQuery:null!==(z=a.query)&&void 0!==z?z:q}}},to:G,ruleNote:n})}catch(n){const{toasts:a}=x.b.get().notifications;a.addError(n,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailureTitle",{defaultMessage:"Failed to create suppressed alert timeline"})});const i=C.a.toISOString(),l=C.b.toISOString();return t({from:i,notes:null,timeline:{...v.b,id:f.c.active,indexNames:[],dateRange:{start:i,end:l},eventType:"all"},to:l})}},$=async(e,t,n="dataProvider",a)=>{const i=Array.isArray(t)?t.map((e=>e._id)):[],{to:l,from:r}=w({ecs:t}),{dataProviders:o,filters:s}=P(i,n,a||`${t.length} event IDs`);await e({from:r,notes:null,timeline:{...v.b,excludedRowRendererIds:[],dataProviders:o,id:f.c.active,indexNames:[],dateRange:{start:r,end:l},eventType:"all",filters:s,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:l})},V=async({createTimeline:e,ecsData:t,updateTimelineIsLoading:n,searchStrategyClient:i,getExceptionFilter:l})=>{const r=Array.isArray(t)?t[0]:t,o=Object(j.getField)(r,c.j),s=Object(j.getField)(r,c.d),u=Array.isArray(o)&&o.length>0?o[0]:"",d=Object(j.getField)(r,p.i),b=Object(a.isEmpty)(d)?"":Array.isArray(d)?d[0]:d,{to:x,from:S}=w({ecs:t});if(Object(a.isEmpty)(b)){if(D(r))return L(r,e,u,{},l);if(M(r))return B(r,e,u,{},l);if(!R(r)||N(r)||_(r)||A(r)){let{dataProviders:n,filters:i}=P([r._id],"dataProvider");if((e=>{const t=Object(j.getField)(e,c.o),n=Object(j.getField)(e,p.a);return("eql"===t||Array.isArray(t)&&"eql"===t[0])&&(null==n?void 0:n.length)>0})(r)){const e=((e,t)=>{if(!Object(a.isEmpty)(e)&&Array.isArray(t)&&t.length>1)return{dataProviders:[],filters:F(p.a,t.reduce(((e,t)=>{const n=Object(j.getField)(t,p.a),a=Array.isArray(n)?n[0]:n;return e.includes(a)?e:[...e,a]}),[]))};if(!Array.isArray(t)||1===t.length){const e=Array.isArray(t)?t[0]:t,n=Object(j.getField)(e,p.a),a=Object(j.getFieldKey)(e,p.a),i=Array.isArray(n)?n[0]:n;return{dataProviders:[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${f.c.active}-alert-id-${i}`,name:e._id,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:a,value:i,operator:":"}}],filters:[]}}return{filters:[],dataProviders:[]}})([r._id],t);n=e.dataProviders,i=e.filters}return e({from:S,notes:null,timeline:{...v.b,excludedRowRendererIds:[],dataProviders:n,id:f.c.active,indexNames:[],dateRange:{start:S,end:x},eventType:"all",filters:i,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:x,ruleNote:u,ruleAuthor:s})}return q(r,e,u,{},l)}try{var k,C;n({id:f.c.active,isLoading:!0});const[t,o]=await Promise.all([Object(O.e)(b),Object(m.lastValueFrom)(i.search({defaultIndex:[],indexName:null!==(k=r._index)&&void 0!==k?k:"",eventId:r._id,factoryQueryType:y.c.details},{strategy:"timelineSearchStrategy"}))]),c=Object(a.getOr)({},"data.getOneTimeline",t),d=null!==(C=o.data)&&void 0!==C?C:[];if(!Object(a.isEmpty)(c)){var I,z,$,V,G,U,H;const t=Object(h.f)(c),{timeline:n,notes:a}=Object(h.b)(t,!0,null!==(I=t.timelineType)&&void 0!==I?I:g.m.default),i=Object(T.d)(null!==(z=null===($=n.kqlQuery)||void 0===$||null===(V=$.filterQuery)||void 0===V||null===(G=V.kuery)||void 0===G?void 0:G.expression)&&void 0!==z?z:"",d,n.timelineType),o=Object(T.c)(null!==(U=n.filters)&&void 0!==U?U:[],d),m=Object(T.b)(null!==(H=n.dataProviders)&&void 0!==H?H:[],d,n.timelineType);return D(r)?L(r,e,u,{filters:o,query:i,dataProviders:m,columns:n.columns},l):M(r)?B(r,e,u,{filters:o,query:i,dataProviders:m,columns:n.columns},l):!R(r)||N(r)||_(r)||A(r)?e({from:S,timeline:{...n,excludedRowRendererIds:[],title:"",timelineType:g.m.default,templateTimelineId:null,status:g.l.draft,dataProviders:m,eventType:"all",filters:o,dateRange:{start:S,end:x},kqlQuery:{filterQuery:{kuery:{kind:null!==(Q=null===(W=n.kqlQuery)||void 0===W||null===(J=W.filterQuery)||void 0===J||null===(X=J.kuery)||void 0===X?void 0:X.kind)&&void 0!==Q?Q:"kuery",expression:i},serializedQuery:Object(E.f)(i)}},noteIds:null!==(K=null==a?void 0:a.map((e=>e.noteId)))&&void 0!==K?K:[],show:!0},to:x,ruleNote:u,ruleAuthor:s,notes:null!=a?a:null}):q(r,e,u,{filters:o,query:i,dataProviders:m,columns:n.columns},l);var Q,W,J,X,K}}catch{return n({id:f.c.active,isLoading:!1}),e({from:S,notes:null,timeline:{...v.b,id:f.c.active,indexNames:[],dateRange:{start:S,end:x},eventType:"all"},to:x})}}},818:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(269),i=n(1342);const l=e=>Object(a.flow)(c,u)(e),r=e=>Object(a.flow)(u)(e),o=e=>Object(a.flow)(s)(e),s=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(i.a)({...e,entries:e.entries.map((e=>Object(i.a)(e)))}):Object(i.a)(e)));return{...e,entries:t}},u=e=>{const{entries:t}=e,n=t.map((e=>"nested"===e.type?Object(i.b)({...e,entries:e.entries.map((e=>Object(i.b)(e)))}):Object(i.b)(e)));return{...e,entries:n}},c=e=>{const{comments:t}=e;if(!t||!t.length)return e;const n=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:n}}},819:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(2),i=n(43);const l=Object(a.createContext)(void 0),r=Object(a.memo)((({urlKey:e,children:t})=>{const n=Object(a.useMemo)((()=>({urlKey:e})),[e]);return Object(i.jsx)(l.Provider,{value:n},t)}));r.displayName="ExpandableFlyoutContextProvider";const o=()=>{const e=Object(a.useContext)(l);if(void 0===e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e}},857:function(e,t,n){"use strict";n.d(t,"b",(function(){return vt})),n.d(t,"a",(function(){return Tt}));var a=n(44),i=n(19),l=n(2),r=n.n(l),o=n(45),s=n(41),u=n.n(s),c=n(64),d=n(122),m=n(140),p=n(129),b=n(158),f=n(243),g=n(127),y=n(55),v=n(59),h=n(365),E=n(331),j=n(121),T=n(4);const O=T.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineBtn",{defaultMessage:"New"}),x=T.i18n.translate("xpack.securitySolution.timeline.modal.newTimeline",{defaultMessage:"New Timeline"}),S=T.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineTemplate",{defaultMessage:"New Timeline template"}),k=T.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtn",{defaultMessage:"Open"}),C=T.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),w=T.i18n.translate("xpack.securitySolution.timeline.modal.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),I=T.i18n.translate("xpack.securitySolution.timeline.modal.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),M=T.i18n.translate("xpack.securitySolution.timeline.modal.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"}),_=T.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),N=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"}),D=T.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),A=T.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),R=T.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),F=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),z=T.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),P=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),L=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),B=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),q=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),$=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"}),V=T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"}),G=r.a.memo((({timelineId:e})=>{const[t,n]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>n((e=>!e))),[]),o=Object(E.a)({timelineId:e,timelineType:j.m.default,onClick:a}),s=Object(E.a)({timelineId:e,timelineType:j.m.template,onClick:a}),u=Object(l.useMemo)((()=>r.a.createElement(i.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right","data-test-subj":"timeline-modal-new-timeline-dropdown-button",onClick:a},O)),[a]),c=Object(l.useCallback)((async()=>{await o()}),[o]),d=Object(l.useCallback)((async()=>{await s()}),[s]),m=Object(l.useMemo)((()=>[r.a.createElement(i.EuiContextMenuItem,{key:"new-timeline",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline",onClick:c},x),r.a.createElement(i.EuiContextMenuItem,{key:"new-timeline-template",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline-template",onClick:d},S)]),[c,d]);return r.a.createElement(i.EuiPopover,{button:u,isOpen:t,closePopover:a,panelPaddingSize:"none"},r.a.createElement(i.EuiContextMenuPanel,{items:m}))}));G.displayName="NewTimelineButton";var U=n(815);const H=["createFrom"],Q=r.a.memo((()=>{const[e,t]=Object(l.useState)(!1),n=Object(l.useCallback)((()=>t((e=>!e))),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"timeline-modal-open-timeline-button",onClick:n,"aria-label":C},k),e?r.a.createElement(U.a,{onClose:n,hideActions:H}):null)}));Q.displayName="OpenTimelineButton";var W=n(36),J=n(169),X=n(213),K=n(118),Y=n(132),Z=n(250);const ee=e=>T.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} other {template}}",values:{isTimeline:e}});var te=n(912),ne=n(913),ae=n(181),ie=n(138),le=n(510),re=n(5),oe=n(13),se=n(146),ue=n(194),ce=n(156);const de=r.a.memo((({timelineId:e})=>{const t=Object(o.useDispatch)(),{graphEventId:n,savedObjectId:a,status:s,title:u,timelineType:c}=Object(o.useSelector)((t=>Object(J.selectTimelineById)(t,e))),{cases:d,application:{navigateToApp:m}}=Object(K.j)().services,p=d.helpers.canUseCases([re.j]),[b,f]=Object(l.useState)(!1),[g,y]=Object(l.useState)(!1),v=Object(l.useCallback)((()=>f((e=>!e))),[]),h=Object(l.useCallback)((()=>y(!1)),[y]),E=Object(l.useCallback)((async i=>{h(),await m(re.m,{deepLinkId:ce.a.case,path:null!=i?Object(ue.a)({id:i.id}):Object(ue.b)()}),t(Object(oe.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:u}))}),[h,t,n,m,a,e,u]),T=Object(l.useCallback)((()=>{v(),m(re.m,{deepLinkId:ce.a.case,path:Object(ue.b)()}).then((()=>{t(Object(oe.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:u.length>0?u:le.d})),t(Object(oe.showTimeline)({id:se.c.active,show:!1}))}))}),[t,n,m,a,e,u,v]),O=Object(l.useCallback)((()=>{v(),y(!0)}),[v,y]),x=Object(l.useMemo)((()=>r.a.createElement(i.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",disabled:s===j.l.draft||c!==j.m.default,"data-test-subj":"timeline-modal-attach-to-case-dropdown-button",onClick:v},w)),[v,s,c]),S=Object(l.useMemo)((()=>[r.a.createElement(i.EuiContextMenuItem,{key:"new-case","data-test-subj":"timeline-modal-attach-timeline-to-new-case",onClick:T},I),r.a.createElement(i.EuiContextMenuItem,{key:"existing-case","data-test-subj":"timeline-modal-attach-timeline-to-existing-case",onClick:O},M)]),[O,T]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiPopover,{button:x,isOpen:b,closePopover:v,panelPaddingSize:"none"},r.a.createElement(i.EuiContextMenuPanel,{items:S})),g&&d.ui.getAllCasesSelectorModal({onRowClick:E,onClose:h,owner:[re.j],permissions:p}))}));de.displayName="AttachToCaseButton";var me=n(271),pe=n.n(me),be=n(157),fe=n(187),ge=n(219);const ye={title:{type:be.a.TEXT,validations:[{validator:be.j.emptyField("")}]},description:{type:be.a.TEXTAREA,validations:[]}},ve=Object(be.l)({component:be.b}),he=`${B} (${q})`,Ee=r.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:n,showWarning:a})=>{const{startTransaction:s}=Object(fe.b)(),u=Object(o.useDispatch)(),{isSaving:c,description:d,status:m,title:b,timelineType:f}=Object(o.useSelector)((e=>Object(J.selectTimelineById)(e,n))),[g,y]=Object(l.useState)(!1),v=Object(l.useCallback)((e=>y(e.target.checked)),[]),h=m===j.l.draft,O=pe()(c),x=Object(E.a)({timelineId:se.c.active,timelineType:j.m.default}),S=Object(l.useCallback)(((e,t)=>(t&&(u(p.a.updateTitleAndDescription({id:n,...e})),u(p.a.saveTimeline({id:n,saveAsNew:g}))),Promise.resolve())),[u,n,g]),k=Object(l.useMemo)((()=>({title:b,description:d})),[b,d]),{form:C}=Object(be.m)({id:"timelineTitleAndDescriptionForm",schema:ye,onSubmit:S,options:{stripEmptyFields:!1},defaultValue:k}),{isSubmitted:w,isSubmitting:I,submit:M}=C,_=Object(l.useCallback)((()=>{s({name:ge.f.SAVE}),M()}),[M,s]),q=Object(l.useCallback)((async()=>{a&&await x(),e()}),[e,x,a]),G=Object(l.useMemo)((()=>m===j.l.draft&&a?f===j.m.template?z:F:P),[a,m,f]),U=Object(l.useMemo)((()=>m===j.l.draft?f===j.m.template?D:N:f===j.m.template?R:N),[m,f]),H=Object(l.useMemo)((()=>m===j.l.draft&&a?f===j.m.template?D:N:A),[a,m,f]),Q=Object(l.useMemo)((()=>(e=>T.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===j.m.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(f)),[f]),W=Object(l.useMemo)((()=>({"aria-label":L,autoFocus:"title"===t,"data-test-subj":"save-timeline-modal-title-input",disabled:c,spellCheck:!0,placeholder:f===j.m.template?le.c:le.d})),[t,c,f]),X=Object(l.useMemo)((()=>({"aria-label":B,"data-test-subj":"save-timeline-modal-description-input",disabled:c,placeholder:le.a})),[c]);return Object(l.useEffect)((()=>{w&&!c&&O&&e()}),[w,c,O,e]),r.a.createElement(i.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},c&&r.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),r.a.createElement(i.EuiModalHeader,{"data-test-subj":"save-timeline-modal-header"},U),r.a.createElement(i.EuiModalBody,null,a&&r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiCallOut,{title:Q,color:"danger",iconType:"warning","data-test-subj":"save-timeline-modal-callout"}),r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(be.c,{form:C},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(ve,{path:"title",fullWidth:!0,label:$,euiFieldProps:W}),r.a.createElement(i.EuiSpacer,null)),r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(ve,{label:he,path:"description",fullWidth:!0,euiFieldProps:X}),r.a.createElement(i.EuiSpacer,null)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiFlexGroup,{direction:"row",alignItems:"center"},h?null:r.a.createElement(i.EuiSwitch,{label:V,checked:g,onChange:v,"data-test-subj":"save-timeline-modal-save-as-new-switch"}),r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(i.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(i.EuiButton,{size:"s",fill:!1,onClick:q,isDisabled:c,"data-test-subj":"save-timeline-modal-close-button"},G)),r.a.createElement(i.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(i.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:c||I,fill:!0,onClick:_,"data-test-subj":"save-timeline-modal-save-button"},H))))))))}));Ee.displayName="SaveTimelineModal";const je=r.a.memo((({timelineId:e})=>{const[t,n]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>n((e=>!e))),[]),{kibanaSecuritySolutionsPrivileges:{crud:s}}=Object(m.a)(),{status:u,isSaving:c}=Object(o.useSelector)((t=>Object(J.selectTimelineById)(t,e))),d=s&&u!==j.l.immutable,p=u===j.l.draft,b=d?null:_;return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiToolTip,{content:b,position:"bottom","data-test-subj":"timeline-modal-save-timeline-tooltip"},r.a.createElement(i.EuiButton,{id:h.a.SAVE_TIMELINE,fill:!0,size:"s",iconType:"save",isLoading:c,disabled:!d,"data-test-subj":"timeline-modal-save-timeline",onClick:a},A)),t&&d?r.a.createElement(Ee,{initialFocusOn:p?"title":"save",timelineId:e,showWarning:!1,closeSaveTimeline:a}):null)}));je.displayName="SaveTimelineButton";const Te=u.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1lpfyda-0"})(["width:0;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),Oe=Object(v.euiStyled)(i.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({theme:e})=>e.eui.euiBorderRadius};
`,xe=r.a.memo((({timelineId:e,openToggleRef:t})=>{const n=Object(o.useDispatch)(),{browserFields:a,indexPattern:s}=Object(Y.a)(g.SourcererScopeName.timeline),{cases:u,uiSettings:c}=Object(K.j)().services,d=Object(l.useMemo)((()=>Object(y.getEsQueryConfig)(c)),[c]),m=u.helpers.canUseCases([W.APP_ID]),b=Object(o.useSelector)((t=>Object(J.selectTitleByTimelineById)(t,e))),f=Object(o.useSelector)((t=>Object(J.selectDataInTimeline)(t,e))),v=Object(o.useSelector)((t=>Object(J.selectKqlQuery)(t,e))),{activeTab:E,dataProviders:j,timelineType:T,filters:O,kqlMode:x}=Object(o.useSelector)((t=>Object(J.selectTimelineById)(t,e))),S=Object(l.useMemo)((()=>Object(Z.d)({config:d,dataProviders:j,indexPattern:s,browserFields:a,filters:O||[],kqlQuery:v,kqlMode:x})),[a,j,d,O,s,x,v]),k=!f||void 0===(null==S?void 0:S.filterQuery),C=Object(l.useCallback)((()=>{null!=t.current&&t.current.focus(),Object(X.a)(),n(p.a.showTimeline({id:e,show:!1}))}),[n,e,t]);return r.a.createElement(Oe,{grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-modal-header-panel"},r.a.createElement(Se,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(te.a,{timelineId:e,isPartOfGuidedTour:!0})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(ke,{grow:!1,"data-test-subj":"timeline-modal-header-title"},r.a.createElement("h3",null,b))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(ne.a,{timelineId:e})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiFlexGroup,{id:h.a.ACTION_MENU,justifyContent:"flexEnd",alignItems:"center",gutterSize:"xs",responsive:!1,"data-test-subj":"timeline-modal-header-actions"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(G,{timelineId:e})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(Q,null)),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(ae.b,{queryId:`${e}-${E}`,inputId:ie.a.timeline,isDisabled:k})),m.create&&m.read?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiFlexItem,null,r.a.createElement(Te,null)),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(de,{timelineId:e}))):null,r.a.createElement(i.EuiFlexItem,null,r.a.createElement(je,{timelineId:e})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiToolTip,{content:ee("default"===T)},r.a.createElement(i.EuiButtonIcon,{"aria-label":ee("default"===T),iconType:"cross","data-test-subj":"timeline-modal-header-close-button",onClick:C})))))))}));xe.displayName="TimelineModalHeader";var Se=u()(i.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1lpfyda-1"})(["",""],{"overflow-x":"auto"}),ke=u()(i.EuiText).withConfig({displayName:"_StyledEuiText",componentId:"sc-1lpfyda-2"})(["",""],{"white-space":"nowrap"}),Ce=n(124),we=n(191),Ie=n(443),Me=n(119),_e=n.n(Me),Ne=n(972),De=n(767),Ae=n(914);const Re=T.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),Fe=T.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),ze=T.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),Pe=T.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),Le=T.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),Be=(T.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),T.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"})),qe=T.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var $e=n(16);const Ve=u.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1fs16o3-0"})(["flex:1;"]),Ge=(e,t=r.a.createElement(i.EuiSkeletonText,{lines:10}))=>{var n;const a=r.a.forwardRef(((n,a)=>r.a.createElement(l.Suspense,{fallback:t},r.a.createElement(e,_e()({},n,{ref:a})))));return a.displayName=`${null!==(n=e.displayName)&&void 0!==n?n:"Tab"}WithSuspense`,a},Ue=Ge(Object(l.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(36)]).then(n.bind(null,2115))))),He=Ge(Object(l.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(37)]).then(n.bind(null,2123))))),Qe=Ge(Object(l.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(49)]).then(n.bind(null,2092))))),We=Ge(Object(l.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(66)]).then(n.bind(null,2139))))),Je=Ge(Object(l.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(38)]).then(n.bind(null,2093))))),Xe=Ge(Object(l.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(67)]).then(n.bind(null,2094))))),Ke=Ge(Object(l.lazy)((()=>n.e(64).then(n.bind(null,2119))))),Ye=Object(l.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:i,showTimeline:o})=>{const{isTimelineEsqlEnabledByFeatureFlag:s,isEsqlAdvancedSettingEnabled:u}=Object(Ne.a)(),c=Object(Ce.b)((e=>Object(J.selectTimelineESQLSavedSearchId)(e,a))),d=Object(l.useMemo)((()=>!!s&&(u||null!=c)),[u,s,c]),m=Object(l.useCallback)((e=>{switch(e){case se.d.graph:return r.a.createElement(Qe,{timelineId:a});case se.d.notes:return r.a.createElement(We,{timelineId:a});case se.d.session:return r.a.createElement(Xe,{timelineId:a});default:return null}}),[a]),p=Object(l.useMemo)((()=>[se.d.graph,se.d.notes,se.d.session].includes(e)),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ve,{$isVisible:se.d.query===e,"data-test-subj":`timeline-tab-content-${se.d.query}`},r.a.createElement(Ue,{renderCellValue:t,rowRenderers:n,timelineId:a})),o&&d&&e===se.d.esql&&r.a.createElement(Ve,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${se.d.esql}`},r.a.createElement(Ke,{timelineId:a})),r.a.createElement(Ve,{$isVisible:se.d.pinned===e,"data-test-subj":`timeline-tab-content-${se.d.pinned}`},r.a.createElement(Je,{renderCellValue:t,rowRenderers:n,timelineId:a})),i===j.m.default&&r.a.createElement(Ve,{$isVisible:se.d.eql===e,"data-test-subj":`timeline-tab-content-${se.d.eql}`},r.a.createElement(He,{renderCellValue:t,rowRenderers:n,timelineId:a})),r.a.createElement(Ve,{$isVisible:p,isOverflowYScroll:e===se.d.session,"data-test-subj":`timeline-tab-content-${se.d.graph}-${se.d.notes}`},p&&m(e)))}));Ye.displayName="ActiveTimelineTab";const Ze=u()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1fs16o3-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),et=u()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1fs16o3-2"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),tt=u()(i.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1fs16o3-3"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),nt=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:s,timelineType:u,graphEventId:c,sessionViewConfig:d,timelineDescription:m})=>{const b=Object(o.useDispatch)(),f=Object(l.useMemo)((()=>Object(Ae.a)()),[]),g=Object(l.useMemo)((()=>Object(Ae.g)()),[]),y=Object(l.useMemo)((()=>Object(Ae.e)()),[]),v=Object(l.useMemo)((()=>Object(Ae.d)()),[]),h=Object(l.useMemo)((()=>Object(Ae.c)()),[]),E=Object(l.useMemo)((()=>Object(Ae.b)()),[]),{isEsqlAdvancedSettingEnabled:T,isTimelineEsqlEnabledByFeatureFlag:O}=Object(Ne.a)(),x=Object(Ce.b)((e=>Object(J.selectTimelineESQLSavedSearchId)(e,n))),S=Object(Ce.b)((e=>f(e,n))),k=Object(Ce.b)((e=>g(e,n))),C=Object(l.useMemo)((()=>!!O&&(T||null!=x)),[T,O,x]),w=Object(Ce.b)((e=>y(e,n))),I=Object(Ce.a)((e=>h(e,n))),M=Object(Ce.a)((e=>E(e,n))),_=Object(Ce.a)((e=>v(e))),N=Object($e.b)().isEnterprise(),D=Object(l.useMemo)((()=>{const e=Object.values(M).reduce(((e,t)=>[...e,...t]),[]);return[...I,...e]}),[I,M]),A=Object(l.useMemo)((()=>_.filter((e=>D.includes(e.id))).length+(Object(a.isEmpty)(m)?0:1)),[_,D,m]),R=Object(l.useCallback)((e=>{b(p.a.setActiveTabTimeline({id:n,activeTab:e}))}),[b,n]),F=Object(l.useCallback)((()=>{R(se.d.query)}),[R]),z=Object(l.useCallback)((()=>{R(se.d.eql)}),[R]),P=Object(l.useCallback)((()=>{R(se.d.graph)}),[R]),L=Object(l.useCallback)((()=>{R(se.d.notes)}),[R]),B=Object(l.useCallback)((()=>{R(se.d.pinned)}),[R]),q=Object(l.useCallback)((()=>{R(se.d.session)}),[R]),$=Object(l.useCallback)((()=>{b(Object(oe.initializeTimelineSettings)({id:n})),R(se.d.esql)}),[R,b,n]);return Object(l.useEffect)((()=>{c||S!==se.d.graph||F()}),[S,c,F]),r.a.createElement(r.a.Fragment,null,!s&&r.a.createElement(tt,{className:"eui-scrollBar"},r.a.createElement(et,{"data-test-subj":`timelineTabs-${se.d.query}`,onClick:F,isSelected:S===se.d.query,disabled:!1,key:se.d.query},r.a.createElement("span",null,Re),k&&r.a.createElement(De.b,null)),C&&r.a.createElement(et,{"data-test-subj":`timelineTabs-${se.d.esql}`,onClick:$,isSelected:S===se.d.esql,disabled:!1,key:se.d.esql},r.a.createElement("span",null,Be)),u===j.m.default&&r.a.createElement(et,{"data-test-subj":`timelineTabs-${se.d.eql}`,onClick:z,isSelected:S===se.d.eql,disabled:!1,key:se.d.eql},r.a.createElement("span",null,Fe),k&&r.a.createElement(De.a,null)),r.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${se.d.graph}`,onClick:P,isSelected:S===se.d.graph,disabled:!c,key:se.d.graph},ze),N&&r.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${se.d.session}`,onClick:q,isSelected:S===se.d.session,disabled:null===d,key:se.d.session},qe),r.a.createElement(et,{"data-test-subj":`timelineTabs-${se.d.notes}`,onClick:L,isSelected:S===se.d.notes,disabled:u===j.m.template,key:se.d.notes},r.a.createElement("span",null,Pe),k&&A>0&&u===j.m.default&&r.a.createElement("div",null,r.a.createElement(Ze,null,A))),r.a.createElement(et,{"data-test-subj":`timelineTabs-${se.d.pinned}`,onClick:B,disabled:u===j.m.template,isSelected:S===se.d.pinned,key:se.d.pinned},r.a.createElement("span",null,Le),k&&w>0&&u===j.m.default&&r.a.createElement("div",null,r.a.createElement(Ze,null,w)))),r.a.createElement(Ye,{activeTimelineTab:S,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:u,timelineDescription:m,showTimeline:k}))},at=Object(l.memo)(nt);var it=n(180),lt=n(206),rt=n(583),ot=n(48),st=n(58),ut=n(198),ct=n(148),dt=n(768),mt=n(651);const pt=e=>{var t;const{activeTab:n,switchToTab:a,timelineType:o}=e,{services:{storage:s}}=Object(K.j)(),u=Object(l.useMemo)((()=>h.b.filter((e=>!e.timelineType||e.timelineType===o))),[o]),[c,d]=Object(l.useState)((()=>{const e=s.get(re.cc.TIMELINE);return null!=e?e:h.c})),m=Object(l.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),p=Object(l.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(l.useEffect)((()=>{s.set(re.cc.TIMELINE,c)}),[c,s]);const b=Object(l.useCallback)((e=>e===u.length?r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:m},mt.h):[r.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:m},mt.g),r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:p},mt.j)]),[m,p,u.length]),f=null===(t=u[c.currentTourStep-1])||void 0===t?void 0:t.anchor,g=Object(dt.a)(f),y=u[c.currentTourStep-1];return null!=y&&y.timelineTab&&y.timelineTab!==n&&a(y.timelineTab),c.isTourActive&&g?r.a.createElement(r.a.Fragment,null,u.map(((e,t)=>{const n=t+1;if(c.currentTourStep!==n)return null;const a={"data-test-subj":`timeline-tour-step-${t+1}`};return r.a.createElement(i.EuiTourStep,{panelProps:a,key:t,step:n,isStepOpen:c.isTourActive&&c.currentTourStep===t+1,minWidth:c.tourPopoverWidth,stepsTotal:u.length,onFinish:m,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:h.c.tourSubtitle,footerAction:b(n)})}))):null},bt=r.a.memo(pt);var ft=n(274);const gt=u.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),yt=u.a.div.withConfig({displayName:"TimelineBody",componentId:"sc-4r2lej-1"})(["height:100%;display:flex;flex-direction:column;"]),vt=Object(l.createContext)({timelineId:null}),ht=({timelineId:e})=>{const t=Object(l.useMemo)((()=>p.b.getTimelineByIdSelector()),[]);return Object(Ce.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:b.b).isSaving}))?r.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Et=r.a.memo(ht),jt=({renderCellValue:e,rowRenderers:t,timelineId:n,openToggleRef:s})=>{const u=Object(o.useDispatch)(),y=Object(d.a)("unifiedComponentsInTimelineDisabled"),v=Object(l.useRef)(null),h=Object(l.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),E=Object(o.useSelector)((e=>ct.e.sourcererScopeSelectedPatterns(e,g.SourcererScopeName.timeline))),T=Object(o.useSelector)((e=>ct.e.sourcererScopeSelectedDataViewId(e,g.SourcererScopeName.timeline))),{dataViewId:O,indexNames:x,graphEventId:S,savedObjectId:k,timelineType:C,description:w,sessionViewConfig:I,initialized:M,show:_,isLoading:N,activeTab:D}=Object(Ce.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=h(e,n))&&void 0!==t?t:b.b)})),{kibanaSecuritySolutionsPrivileges:{crud:A}}=Object(m.a)(),{timelineFullScreen:R}=Object(lt.c)();Object(l.useEffect)((()=>{k||M||u(p.a.createTimeline({id:n,columns:y?f.b:ft.a,dataViewId:T,indexNames:E,show:!1,excludedRowRendererIds:y?[]:b.b.excludedRowRendererIds}))}),[]);const F=Object(l.useCallback)((()=>{!k||null==T||null===O&&0===x.length||O===T&&x.sort().join()===E.sort().join()||u(p.a.updateDataView({dataViewId:T,id:n,indexNames:E}))}),[u,k,T,O,E,x,n]);Object(l.useEffect)((()=>{F()}),[T,E]);const z=Object(l.useCallback)((()=>{var e;const t=null===(e=v.current)||void 0===e?void 0:e.querySelector(rt.a);var n,a;null!=t?t.focus():null===(n=v.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[v]),P=Object(l.useCallback)((()=>{var e,t;null===(e=v.current)||void 0===e||null===(t=e.querySelector(`.${we.c}`))||void 0===t||t.focus()}),[v]),L=Object(l.useCallback)((e=>{Object(c.isTab)(e)&&Object(we.k)({containerElement:v.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:z,onSkipFocusAfterEventsTable:P})}),[v,z,P]),B=Object(l.useMemo)((()=>({timelineId:n})),[n]),q=(()=>{const{search:e,pathname:t}=Object(ot.useLocation)(),{spaces:n}=Object(K.j)().services,a=Object(l.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:s,show:u,graphEventId:c,activeTab:d}=Object(Ce.a)((e=>{var t;return null!==(t=a(e,se.c.active))&&void 0!==t?t:b.b})),m=Object(l.useCallback)((()=>{var a,l,m;const p=new URLSearchParams(e),b=null!==(a=p.get(ut.a.timeline))&&void 0!==a?a:void 0,f={id:null!=s?s:"",isOpen:!!u,activeTab:d,graphEventId:c},g=null!==(l=Object(st.safeDecode)(null!=b?b:""))&&void 0!==l?l:f,y=null==g?void 0:g.id;if(!n||"conflict"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id)||null==y)return null;const v=null!==(m=null==o?void 0:o.alias_target_id)&&void 0!==m?m:"",h={...g,id:v},E=Object(st.encode)(h);p.set(ut.a.timeline,E);const j=`${t}?${p.toString()}${window.location.hash}`;return r.a.createElement(r.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:ut.a.timeline,currentObjectId:y,otherObjectId:v,otherObjectPath:j}),r.a.createElement(i.EuiSpacer,null))}),[d,c,t,null==o?void 0:o.alias_target_id,null==o?void 0:o.outcome,s,e,u,n]);return Object(l.useMemo)((()=>m()),[m])})(),$=_&&!N&&A,V=Object(l.useCallback)((e=>{u(p.a.setActiveTabTimeline({id:n,activeTab:e}))}),[n,u]);return r.a.createElement(vt.Provider,{value:B},r.a.createElement(it.B,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:L,ref:v},r.a.createElement(Et,{timelineId:n}),r.a.createElement(yt,{"data-test-subj":"timeline-body"},C===j.m.template&&r.a.createElement(gt,{className:"timeline-template-badge"},Ie.f),q,r.a.createElement(it.y,{$isVisible:!R,"data-test-subj":"timeline-hide-show-container"},r.a.createElement(xe,{timelineId:n,openToggleRef:s})),r.a.createElement(at,{graphEventId:S,sessionViewConfig:I,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:C,timelineDescription:w,timelineFullScreen:R}))),$?r.a.createElement(bt,{activeTab:D,switchToTab:V,timelineType:C}):null)};jt.displayName="StatefulTimelineComponent";const Tt=r.a.memo(jt)},860:function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return S}));var a=n(2),i=n(4),l=n(19),r=n(1093),o=n(301);const s=new WeakMap;var u=n(52),c=n.n(u),d=n(480),m=n(43);function p({useTopLevelObjectColumns:e,row:t,columnId:n,dataView:o,shouldShowFieldHandler:u,maxEntries:p,isPlainRecord:b,fieldFormats:f,dataTestSubj:g="discoverCellDescriptionList",className:y}){const v=e?function(e,t,n,a){var i;const l=Object(d.b)(e.fields,t),r=null!==(i=e.highlight)&&void 0!==i?i:{},o=[],s=[];return Object.entries(l).forEach((([t,i])=>{var l;const u=n.getFieldByName(t),c=n.fields.getByName?null===(l=n.fields.getByName(t))||void 0===l?void 0:l.displayName:void 0,d=u?n.getFormatterForField(u):{convert:(e,...t)=>String(e)},m=i.map((t=>d.convert(t,"html",{field:u,hit:e}))).join(", "),p=r[t]?o:s;c?a(c)&&p.push([c,m,t]):p.push([t,m,t])})),[...o,...s]}(t.raw,n,o,u).slice(0,p):function(e,t,n,a,l){var o;const u=s.get(e.raw);if(u&&u.maxEntries===a)return u.formattedHit;const c=null!==(o=e.raw.highlight)&&void 0!==o?o:{},d=e.flattened,m=[],p=[];Object.entries(d).forEach((([a,i])=>{const o=t.fields.getByName(a),s=null==o?void 0:o.displayName,u=c[a]?m:p,d=Object(r.a)(i,e.raw,l,t,o);s?n(a)&&u.push([s,d,a]):u.push([a,d,a])}));const b=[...m,...p],f=b.length<=a?b:[...b.slice(0,a),[i.i18n.translate("discover.formatHit.moreFields",{defaultMessage:"and {count} more {count, plural, one {field} other {fields}}",values:{count:b.length-a}}),"",null]];return s.set(e.raw,{formattedHit:f,maxEntries:a}),f}(t,o,u,p,f);return Object(m.jsx)(l.EuiDescriptionList,{type:"inline",compressed:!0,className:c()("unifiedDataTable__descriptionList","unifiedDataTable__cellValue",y),"data-test-subj":g},v.map((([e,n,i])=>{var r;return b&&i&&null===(null!==(r=t.flattened[i])&&void 0!==r?r:null)?null:Object(m.jsx)(a.Fragment,{key:e},Object(m.jsx)(l.EuiDescriptionListTitle,{className:"unifiedDataTable__descriptionListTitle"},e),Object(m.jsx)(l.EuiDescriptionListDescription,{className:"unifiedDataTable__descriptionListDescription",dangerouslySetInnerHTML:{__html:n}}))})))}n(654);var b=n(93),f=n(94);const g=i.i18n.translate("unifiedDataTable.json.codeEditorAriaLabel",{defaultMessage:"Read only JSON view of an elasticsearch document"}),y=i.i18n.translate("unifiedDataTable.json.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),v=({jsonValue:e,width:t,height:n,hasLineNumbers:a,onEditorDidMount:i,hideCopyButton:r})=>{if(""===e)return null;const o=Object(m.jsx)(f.CodeEditor,{languageId:b.XJsonLang.ID,width:t,height:n,value:e||"",editorDidMount:i,"aria-label":g,options:{automaticLayout:!0,fontSize:12,lineNumbers:a?"on":"off",minimap:{enabled:!1},overviewRulerBorder:!1,readOnly:!0,scrollbar:{alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent"}});return r?o:Object(m.jsx)(l.EuiFlexGroup,{className:"unifiedDataTableJsonEditor",direction:"column",gutterSize:"s"},Object(m.jsx)(l.EuiFlexItem,null,Object(m.jsx)(l.EuiSpacer,{size:"s"}),Object(m.jsx)("div",{className:"eui-textRight"},Object(m.jsx)(l.EuiCopy,{textToCopy:e},(e=>Object(m.jsx)(l.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},y))))),Object(m.jsx)(l.EuiFlexItem,null,o))};function h({json:e,width:t,height:n,hasLineNumbers:a}){const i=JSON.stringify(e,null,2);return Object(m.jsx)(v,{jsonValue:i,width:t,height:n,hasLineNumbers:a,onEditorDidMount:()=>{},hideCopyButton:!0})}var E=n(225);function j(e,t,n){return n?Object(d.b)(t.raw.fields,e):t.raw}var T=({closeButton:e,columnId:t,row:n,useTopLevelObjectColumns:a,dataTestSubj:i="dataTableExpandCellActionJsonPopover"})=>Object(m.jsx)(l.EuiFlexGroup,{gutterSize:"none",direction:"column",justifyContent:"flexEnd",className:"unifiedDataTable__cellPopover","data-test-subj":i},Object(m.jsx)(l.EuiFlexItem,{grow:!1},Object(m.jsx)(l.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",responsive:!1},Object(m.jsx)(l.EuiFlexItem,{grow:!1},e))),Object(m.jsx)(l.EuiFlexItem,null,Object(m.jsx)(h,{json:j(t,n,a),width:E.f,height:200})));const O=({children:e})=>Object(m.jsx)("span",{className:"unifiedDataTable__cellPopoverValue eui-textBreakWord"},e),x="unifiedDataTable__cellValue",S=({dataView:e,rows:t,useNewFieldsApi:n,shouldShowFieldHandler:s,closePopover:u,fieldFormats:c,maxEntries:d,externalCustomRenderers:b,isPlainRecord:f})=>function({rowIndex:g,columnId:y,isDetails:v,setCellProps:h,colIndex:E,isExpandable:j,isExpanded:S}){const k=t?t[g]:void 0,C=e.fields.getByName(y),w=Object(a.useContext)(o.a);if(Object(a.useEffect)((()=>{null!=k&&k.isAnchor?h({className:"unifiedDataTable__cell--highlight"}):w.expanded&&k&&w.expanded.id===k.id?h({className:"unifiedDataTable__cell--expanded"}):h({style:void 0})}),[w,k,h]),void 0===k)return Object(m.jsx)("span",{className:x},"-");if(b&&b[y])return Object(m.jsx)("span",{className:x},b[y]({rowIndex:g,columnId:y,isDetails:v,setCellProps:h,isExpandable:j,isExpanded:S,colIndex:E,row:k,dataView:e,fieldFormats:c,closePopover:u}));const I=Boolean(n&&!C&&(null==k?void 0:k.raw.fields)&&!k.raw.fields[y]);return v?function({row:e,field:t,columnId:n,dataView:a,useTopLevelObjectColumns:o,fieldFormats:s,closePopover:u}){const c=Object(m.jsx)(l.EuiButtonIcon,{"aria-label":i.i18n.translate("unifiedDataTable.grid.closePopover",{defaultMessage:"Close popover"}),"data-test-subj":"docTableClosePopover",iconSize:"s",iconType:"cross",size:"xs",onClick:u});return o||"_source"===(null==t?void 0:t.type)?Object(m.jsx)(T,{row:e,columnId:n,useTopLevelObjectColumns:o,closeButton:c}):Object(m.jsx)(l.EuiFlexGroup,{gutterSize:"none",direction:"row",responsive:!1,"data-test-subj":"dataTableExpandCellActionPopover"},Object(m.jsx)(l.EuiFlexItem,null,Object(m.jsx)(O,null,Object(m.jsx)("span",{dangerouslySetInnerHTML:{__html:Object(r.a)(e.flattened[n],e.raw,s,a,t)}}))),Object(m.jsx)(l.EuiFlexItem,{grow:!1},c))}({row:k,field:C,columnId:y,dataView:e,useTopLevelObjectColumns:I,fieldFormats:c,closePopover:u}):"_source"===(null==C?void 0:C.type)||I?Object(m.jsx)(p,{useTopLevelObjectColumns:I,row:k,dataView:e,columnId:y,fieldFormats:c,shouldShowFieldHandler:s,maxEntries:d,isPlainRecord:f}):Object(m.jsx)("span",{className:x,dangerouslySetInnerHTML:{__html:Object(r.a)(k.flattened[y],k.raw,c,e,C)}})}},870:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return f})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return v}));var a=n(2),i=n(45),l=n(68),r=n(57),o=n(719),s=n.n(o),u=n(582);const c={byId:{},needsSync:!1},d=Object(l.createReducer)(c,(e=>{e.addCase(u.f,((e,{payload:{preview:t,left:n,right:a,id:i}})=>{i in e.byId?(e.byId[i].right=a,e.byId[i].left=n,e.byId[i].preview=t?[t]:void 0):e.byId[i]={left:n,right:a,preview:t?[t]:void 0},e.needsSync=!0})),e.addCase(u.e,((e,{payload:{left:t,id:n}})=>{n in e.byId?e.byId[n].left=t:e.byId[n]={left:t,right:void 0,preview:void 0},e.needsSync=!0})),e.addCase(u.h,((e,{payload:{right:t,id:n}})=>{n in e.byId?e.byId[n].right=t:e.byId[n]={right:t,left:void 0,preview:void 0},e.needsSync=!0})),e.addCase(u.g,((e,{payload:{preview:t,id:n}})=>{if(n in e.byId)if(e.byId[n].preview){var a,i;s()(t,null===(a=e.byId[n].preview)||void 0===a?void 0:a.at(-1))||null===(i=e.byId[n].preview)||void 0===i||i.push(t)}else e.byId[n].preview=t?[t]:void 0;else e.byId[n]={right:void 0,left:void 0,preview:t?[t]:void 0};e.needsSync=!0})),e.addCase(u.i,((e,{payload:{id:t}})=>{var n;t in e.byId&&(null===(n=e.byId[t].preview)||void 0===n||n.pop()),e.needsSync=!1})),e.addCase(u.b,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0,e.byId[t].left=void 0,e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(u.a,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].left=void 0),e.needsSync=!0})),e.addCase(u.d,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0),e.needsSync=!0})),e.addCase(u.c,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(u.j,((e,{payload:{preview:t,left:n,right:a,id:i}})=>{i in e.byId?(e.byId[i].right=a,e.byId[i].left=n,e.byId[i].preview=t?[t]:void 0):e.byId[i]={right:a,left:n,preview:t?[t]:void 0},e.needsSync=!1}))})),m=Object(l.configureStore)({reducer:d,devTools:!1,enhancers:[]}),p=Object(a.createContext)({store:m,storeState:c}),b=Object(i.createDispatchHook)(p),f=Object(i.createSelectorHook)(p),g=e=>e,y=e=>Object(r.createSelector)(g,(t=>t.byId[e]||{})),v=()=>Object(r.createSelector)(g,(e=>e.needsSync))},882:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(19),i=n(444),l=n(2),r=n.n(l),o=n(41),s=n.n(o),u=n(60),c=n.n(u),d=n(5),m=n(134),p=n(118),b=n(769),f=n(356);const g=s()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),y=r.a.memo((({value:e})=>Object(f.a)(e)?r.a.createElement(r.a.Fragment,null,e):r.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},b.c)));y.displayName="ValueWrapper";const v=({legendItem:e})=>{const[t]=Object(p.o)(d.W),{color:n,count:i,dataProviderId:l,field:o,scopeId:s,value:u}=e;return r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(m.b,{"data-test-subj":`legend-item-${l}`,field:o,hideTopN:!0,id:l,isDraggable:!1,scopeId:s,value:u},null==e.render?r.a.createElement(y,{value:u}):e.render({field:o,value:u}))),null!=i&&r.a.createElement(g,{"data-test-subj":"legendItemCount",grow:!1},c()(i).format(t))))))};v.displayName="DraggableLegendItemComponent";const h=r.a.memo(v),E=s.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),j=({className:e,height:t=0,legendItems:n,minWidth:i=165})=>0===n.length?null:r.a.createElement(E,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>r.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},r.a.createElement(h,{legendItem:e}),r.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));j.displayName="DraggableLegendComponent";const T=r.a.memo(j)},896:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},901:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n.n(a),l=n(41);const r=n.n(l).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(l.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));r.displayName="Wrapper";const o=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));o.displayName="SubtitleItem";const s=i.a.memo((({items:e})=>i.a.createElement(r,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(o,{key:t},e))):i.a.createElement(o,null,e))));s.displayName="Subtitle"},902:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},905:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return h}));var a=n(44),i=n(2),l=n(45),r=n(4),o=n(122),s=n(250),u=n(123),c=n(132),d=n(166),m=n(184),p=n(213),b=n(191),f=n(906),g=n(127);const y="createRuleFromTimeline",v="createRuleFromEql",h=e=>{const t=Object(l.useDispatch)(),{addError:n}=Object(u.a)(),{browserFields:h,dataViewId:E,selectedPatterns:j}=Object(c.a)(g.SourcererScopeName.timeline),T=Object(o.a)("unifiedComponentsInTimelineDisabled"),O=Object(i.useRef)(!1),[x,S]=Object(i.useState)(null),[k,C]=Object(i.useState)(!1),w=Object(i.useCallback)((e=>{C(!0),S(e),e.dataViewId===E||Object(a.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[E,t]),[I]=Object(i.useState)({dataViewId:E,selectedPatterns:j}),M=Object(i.useMemo)((()=>null==x||Object(a.isEmpty)(h)||null!==x.dataViewId&&null!==E&&E!==x.dataViewId?null:h),[h,E,x]),_=Object(p.g)(y),N=Object(i.useMemo)(_,[_]),D=Object(p.g)(v),A=Object(i.useMemo)(D,[D]),R=Object(i.useCallback)((()=>{if(null!=x&&null!=M){try{const t=()=>{var e,t,n,a,i,l,r;return{dataProviders:null!=x.dataProviders&&x.dataProviders.length>0?Object(s.f)(Object(b.f)(x.dataProviders,M),{fields:[],title:j.join(",")}):"",query:{query:null!==(e=null===(t=x.kqlQuery.filterQuery)||void 0===t||null===(n=t.kuery)||void 0===n?void 0:n.expression)&&void 0!==e?e:"",language:null!==(a=null===(i=x.kqlQuery.filterQuery)||void 0===i||null===(l=i.kuery)||void 0===l?void 0:l.kind)&&void 0!==a?a:"kuery"},filters:null!==(r=x.filters)&&void 0!==r?r:[],eqlOptions:{}}},n=()=>{var e;return{dataProviders:"",query:{query:null!==(e=x.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:x.eqlOptions}}},a=O.current?n():t();C(!1),e({index:j,queryBar:{filters:""!==a.dataProviders?[...a.filters,Object(f.b)(a.dataProviders)]:a.filters,query:a.query,saved_id:null},...a.eqlOptions})}catch(e){C(!1),n(e,{toastMessage:r.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:x.id}}),title:r.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}O.current=!1,I.dataViewId!==E&&t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:I.dataViewId,selectedPatterns:I.selectedPatterns}))}}),[n,E,t,I.dataViewId,I.selectedPatterns,M,j,x,e]);Object(i.useEffect)((()=>{null!=M&&R()}),[R,M]);const F=Object(m.g)(),z=Object(i.useCallback)((e=>{null!=x&&e===x.id||F({timelineId:e,onOpenTimeline:w,unifiedComponentsInTimelineDisabled:T})}),[w,F,x,T]),[P,L]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{if(!P){let e=null;null!=N?e=N:null!=A&&(e=A,O.current=!0),null!=e&&(L(!0),z(e),C(!0))}}),[z,N,A,P]),{loading:k,onOpenTimeline:w}}},906:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return E}));var a=n(44),i=n(2),l=n.n(i),r=n(45),o=n(53),s=n(448),u=n.n(s),c=n(138),d=n(132),m=n(127),p=n(250),b=n(579),f=n(971),g=n(191),y=n(129);const v=u.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,h=Object(i.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:o,fromStr:s,kqlMode:u,isRefreshPaused:h,savedQueryId:j,setSavedQueryId:T,refreshInterval:O,timelineId:x,to:S,toStr:k,updateReduxTime:C})=>{const w=Object(r.useDispatch)(),[I,M]=Object(i.useState)(null!=s?s:new Date(o).toISOString()),[_,N]=Object(i.useState)(null!=k?k:new Date(S).toISOString()),{browserFields:D,indexPattern:A}=Object(d.a)(m.SourcererScopeName.timeline),[R,F]=Object(i.useState)(void 0),[z,P]=Object(i.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),L=Object(i.useMemo)((()=>Object(g.i)(t)),[t]),[B,q]=Object(i.useState)(Object(p.f)(Object(g.f)(e,D),A)),$=Object(b.a)(),V=Object(i.useCallback)(((e,t)=>w(y.a.applyKqlFilterQuery({id:x,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(p.f)(e,A)}}))),[w,A,x]);Object(i.useEffect)((()=>{P({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(i.useEffect)((()=>{q(Object(p.f)(Object(g.f)(e,D),A))}),[e,D,A]),Object(i.useEffect)((()=>{null!=s&&null!=k?(M(s),N(k)):null!=o&&null!=S&&(M(new Date(o).toISOString()),N(new Date(S).toISOString()))}),[o,s,S,k]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=j&&null!=$)try{const n=await $.getSavedQuery(j);e&&null!=n&&F({...n,attributes:{...n.attributes,filters:Object(g.i)(t)}})}catch(e){F(void 0)}else e&&F(void 0)}(),()=>{e=!1}}),[j]);const G=Object(i.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&V(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");C({id:c.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:x,hasRangeChanged:!0})}}),[a,x]),U=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==j&&T(e.id),null!=$&&""!==B){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===g.e)):-1;$.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),E(B),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,E(B)]:[]})}}else T(null)}),[B,j,$]);return l.a.createElement(v,{className:"search_bar_container"},l.a.createElement(f.a,{dateRangeFrom:I,dateRangeTo:_,hideSavedQuery:"search"===u,indexPattern:A,isRefreshPaused:h,filterQuery:z,filterManager:n,filters:L,onSubmitQuery:G,refreshInterval:O,savedQuery:R,onSavedQuery:U,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),E=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:g.e,controlledBy:g.e,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:o.FilterStateStore.APP_STATE}}}},907:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(19),i=n(2),l=n.n(i),r=n(41);const o=n.n(r)()((({iconSide:e,children:t,...n})=>l.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(r.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(r.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(r.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));o.displayName="Link";const s=l.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:r,disabled:s,href:u,iconSide:c="left",iconSize:d="s",iconType:m,onClick:p})=>{const b=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?b(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),f=Object(i.useMemo)((()=>e||b(t)),[e,t,b]);return l.a.createElement(o,{className:"siemLinkIcon",color:n,"data-test-subj":r,disabled:s,href:u,iconSide:c,onClick:p,"aria-label":f},l.a.createElement(a.EuiIcon,{size:d,type:m}),l.a.createElement("span",{className:"siemLinkIcon__label"},t))}));s.displayName="LinkIcon"},908:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(19),i=n(44),l=n(2),r=n.n(l),o=n(41),s=n.n(o),u=n(121),c=n(747),d=n(184),m=n(163),p=n(130),b=n(443),f=n(137);const g=s()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),y=s()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),v=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:o,timelineType:s,placeholder:v})=>{const[h,E]=Object(l.useState)(50),[j,T]=Object(l.useState)(0),[O,x]=Object(l.useState)(""),[S,k]=Object(l.useState)(!1),{fetchAllTimeline:C,timelines:w,loading:I,totalCount:M}=Object(c.b)(),_=Object(l.useRef)(null),N=Object(l.useRef)(null),D=Object(l.useMemo)((()=>Object(i.debounce)(500,x)),[]),A=Object(l.useCallback)((e=>{D(e)}),[D]),R=Object(l.useCallback)((()=>{k(!S)}),[S]),F=Object(l.useCallback)(((e,t,n)=>{if(e<t&&_.current&&N.current){const e=_.current.clientHeight,t=N.current.clientHeight;n>10&&t-n<1.2*e&&t>j&&(T(t),E(h+50))}}),[j,h]),z=Object(l.useCallback)(((e,t)=>{const n=Object(d.e)({...e,title:e.timelineTitle})?m.Z:e.timelineTitle,l=null!=e.description&&e.description.trim().length>0?e.description:null;return r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),r.a.createElement(g,{grow:!0},r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},r.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},r.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},r.a.createElement(a.EuiHighlight,{search:t},n))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiToolTip,{content:l,anchorClassName:"eui-textTruncate eui-alignMiddle"},r.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},r.a.createElement("small",null,null!=l?l:Object(p.d)())))))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),P=Object(l.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&o(Object(i.isEmpty)(t[0].timelineTitle)?m.Z:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,o]),L=Object(l.useCallback)(((e,t)=>r.a.createElement(r.a.Fragment,null,t,e)),[]),B=Object(l.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=v?v:b.e(s),onSearch:A,incremental:!1,append:r.a.createElement(y,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:S,onClick:R},m.D)})),[R,A,S,s,v]),q=Object(l.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>F((null!=w?w:[]).filter((t=>!e||""!==t.title)).length,M,t),outerRef:_,innerRef:N}})),[F,e,M,w]);return Object(l.useEffect)((()=>{C({pageInfo:{pageIndex:1,pageSize:h},search:O,sort:{sortField:u.g.updated,sortOrder:f.b.desc},onlyUserFavorite:S,status:null,timelineType:s})}),[C,S,h,O,s]),r.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:I&&null==w,listProps:q,renderOption:z,onChange:P,searchable:!0,searchProps:B,singleSelection:!0,options:($=t({timelines:null!=w?w:[],onlyFavorites:S,searchTimelineValue:O,timelineType:s}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},L);var $},h=Object(l.memo)(v)},909:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(57),i=n(129);const l=()=>Object(a.createSelector)(i.b.selectTimeline,(e=>{var t,n;return{createdBy:e.createdBy,expandedDetail:null!==(t=e.expandedDetail)&&void 0!==t?t:{},eventIdToNoteIds:null!==(n=null==e?void 0:e.eventIdToNoteIds)&&void 0!==n?n:{},noteIds:e.noteIds,status:e.status}}))},910:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="memory"},911:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),l=n(19),r=n(121),o=n(163),s=n(292);const u=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[u,c]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===r.m.template),[e]),m=Object(a.useMemo)((()=>d?u:null),[u,d]),p=Object(a.useMemo)((()=>null==m?null:m===r.h.elastic?r.l.immutable:r.l.active),[m]),b=Object(a.useMemo)((()=>[{id:r.h.elastic,name:o.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:r.h.custom,name:o.r,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),f=Object(a.useCallback)((e=>{c(u===e?null:e)}),[c,u]),g=Object(a.useMemo)((()=>d?b.map((e=>i.a.createElement(l.EuiFilterButton,{hasActiveFilters:e.id===m,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:f.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[m,b,d,f]),y=Object(a.useCallback)((async()=>{m!==r.h.custom&&await Object(s.g)()}),[m]);return{timelineStatus:p,templateTimelineType:m,templateTimelineFilter:g,installPrepackagedTimelines:y}}},912:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),i=n.n(a),l=n(45),r=n(19),o=n(4),s=n(169),u=n(129),c=n(121),d=n(365);const m=o.i18n.translate("xpack.securitySolution.timeline.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),p=o.i18n.translate("xpack.securitySolution.timeline.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),b=i.a.memo((({timelineId:e,isPartOfGuidedTour:t=!1})=>{const n=Object(l.useDispatch)(),{isFavorite:o,status:b}=Object(l.useSelector)((t=>Object(s.selectTimelineById)(t,e))),f=b!==c.l.active,g=o?p:m,y=Object(a.useCallback)((()=>n(u.a.updateIsFavorite({id:e,isFavorite:!o}))),[n,e,o]);return i.a.createElement(r.EuiButtonIcon,{id:t?d.a.ADD_TO_FAVORITES:void 0,iconType:o?"starFilled":"starEmpty",isSelected:o,disabled:f,"aria-label":g,title:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,onClick:y},g)}));b.displayName="AddToFavoritesButton"},913:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),i=n.n(a),l=n(19),r=n(44),o=n(4),s=n(129),u=n(158),c=n(124),d=n(121);const m=o.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedLabel",{defaultMessage:"Unsaved"}),p=o.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedChangesLabel",{defaultMessage:"Unsaved changes"}),b=i.a.memo((({timelineId:e})=>{const t=Object(a.useMemo)((()=>s.b.getTimelineByIdSelector()),[]),{changed:n=!1,status:o,updated:b}=Object(c.a)((n=>{var a;return Object(r.pick)(["changed","status","updated"],null!==(a=t(n,e))&&void 0!==a?a:u.b)}));let f;return o!==d.l.draft&&b?n&&(f=i.a.createElement(l.EuiBadge,{color:"warning"},p)):f=i.a.createElement(l.EuiBadge,{color:"warning"},m),f?i.a.createElement(l.EuiText,{size:"xs","data-test-subj":"timeline-save-status"},f):null}));b.displayName="TimelineSaveStatus"},914:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return p}));var a=n(57),i=n(146),l=n(1268),r=n(169);const o=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.d.query})),s=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),u=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),c=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),m=()=>Object(a.createSelector)(l.selectNotesById,(e=>Object.values(e))),p=()=>Object(a.createSelector)(r.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},915:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),l=n(19),r=n(42),o=n(56);const s={tall:490,short:250},u=Object(a.createContext)({tableId:null}),c=({height:e="tall"})=>i.a.createElement(l.EuiPanel,{color:"subdued"},i.a.createElement(l.EuiFlexGroup,{style:{height:s[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},m=()=>{const{http:e}=Object(o.useKibana)().services;return i.a.createElement(l.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},i.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiPanel,{hasBorder:!0,style:d},i.a.createElement(l.EuiFlexGroup,null,i.a.createElement(l.EuiFlexItem,null,i.a.createElement(l.EuiText,{size:"s"},i.a.createElement(l.EuiTitle,null,i.a.createElement("h3",null,i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),i.a.createElement("p",null,i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},916:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(19),i=n(78),l=n(2),r=n.n(l),o=n(41),s=n.n(o),u=n(414),c=n(138),d=n(474),m=n(447),p=n(658),b=n(267),f=n(282),g=n(625),y=n(127);const v=s.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),h=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:n,extraOptions:o,getLensAttributes:s,inputId:h=c.a.global,inspectIndex:E=0,isInspectButtonDisabled:j,isMultipleQuery:T,lensAttributes:O,onCloseInspect:x,queryId:S,timerange:k,title:C,scopeId:w=y.SourcererScopeName.default,stackByField:I,withActions:M=g.a,casesAttachmentMetadata:_})=>{const[N,D]=Object(l.useState)(!1),[A,R]=Object(l.useState)(!1),F=Object(l.useCallback)((()=>{D(!N)}),[N]),z=()=>{D(!1)},P=Object(p.a)({applyGlobalQueriesAndFilters:e,extraOptions:o,getLensAttributes:s,lensAttributes:O,scopeId:w,stackByField:I,title:""}),L=`stat-${S}`,B=Object(l.useCallback)((()=>{z(),R(!0)}),[]),q=Object(l.useCallback)((()=>{R(!1),x&&x()}),[x]),{additionalRequests:$,additionalResponses:V,handleClick:G,handleCloseModal:U,isButtonDisabled:H,request:Q,response:W}=Object(m.a)({inputId:h,inspectIndex:E,isDisabled:j,multiple:T,onCloseInspect:q,onClick:B,queryId:S}),J=Object(l.useMemo)((()=>({handleInspectClick:G,isInspectButtonDisabled:H})),[H,G]),X=Object(g.d)({attributes:P,extraActions:n,inspectActionProps:J,timeRange:k,withActions:M,lensMetadata:_}),K=Object(u.useAsync)((()=>Object(i.buildContextMenuForActions)({actions:X.map((e=>({action:e,context:{},trigger:g.c})))})),[X]),Y=Object(l.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{"aria-label":b.l,className:f.a,"data-test-subj":L,iconType:"boxesHorizontal",onClick:F})),[L,F]);return r.a.createElement(v,{className:t},K.value&&K.value.length>0&&r.a.createElement(a.EuiPopover,{button:Y,isOpen:N,closePopover:z,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},r.a.createElement(a.EuiContextMenu,{"data-test-subj":"viz-actions-panel",size:"s",panels:K.value})),A&&null!==Q&&null!==W&&r.a.createElement(d.a,{additionalRequests:$,additionalResponses:V,closeModal:U,inputId:h,request:Q,response:W,title:C}))};h.displayName="VisualizationActionsComponent";const E=r.a.memo(h)},951:function(e,t,n){"use strict";n.d(t,"c",(function(){return ve})),n.d(t,"b",(function(){return he})),n.d(t,"a",(function(){return je}));var a=n(2),i=n.n(a),l=n(45),r=n(58),o=n(122),s=n(905),u=n(118),c=n(5),d=n(124),m=n(146),p=n(129),b=n(13),f=n(747),g=n(243),y=n(42),v=n(41),h=n.n(v),E=n(121),j=n(957),T=n(362),O=n(292),x=n(140),S=n(19),k=n(163),C=n(48),w=n(123),I=n(816);const M=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:i}=Object(C.useParams)(),{addSuccess:l}=Object(w.a)(),r=Object(a.useCallback)((t=>{null!=e&&e(),l({title:i===E.m.template?k.T(t):k.S(t),"data-test-subj":"addObjectToContainerSuccess"})}),[l,e,i]),o=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(O.c)({ids:n});e instanceof Blob?(Object(I.a)(e,`${k.n}.ndjson`),r(n.length)):o()}})()}),[n,t]),null};M.displayName="ExportTimeline";const _=i.a.memo(M);var N=n(44);const D=i.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:l}=Object(C.useParams)(),r=l===E.m.template?k.j:k.k,o=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(N.isEmpty)(t)?k.Z:t;return i.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return i.a.createElement(S.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:k.b,confirmButtonText:k.h,defaultFocusedButton:S.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:o()},i.a.createElement("div",{"data-test-subj":"warning"},r))}));D.displayName="DeleteTimelineModal";const A=Object(v.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),R=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:l,onComplete:r,savedSearchIds:o})=>{const{addSuccess:s}=Object(w.a)(),{tabName:u}=Object(C.useParams)(),c=Object(a.useCallback)((()=>{null!=r&&r()}),[r]),d=Object(a.useCallback)((()=>{n.length>0&&null!=o&&o.length>0?(e(n,o),s({title:u===E.m.template?k.R(n.length):k.Q(n.length)})):n.length>0&&(e(n),s({title:u===E.m.template?k.R(n.length):k.Q(n.length)})),null!=r&&r()}),[e,n,r,s,u,o]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(A,{"data-test-subj":"remove-popover"}),t?i.a.createElement(S.EuiModal,{maxWidth:600,onClose:c},i.a.createElement(D,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:l,closeModal:c})):null)}));R.displayName="DeleteTimelineModalOverlay";const F=({deleteTimelines:e,ids:t,savedSearchIds:n,isEnableDownloader:a,isDeleteTimelineModalOpen:l,onComplete:r,title:o})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:r}),null!=e&&i.a.createElement(R,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:l,onComplete:r,savedObjectIds:t,savedSearchIds:n,title:o})),z=i.a.memo(F),P=()=>{const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)(!1),[l,r]=Object(a.useState)(!1),o=Object(a.useCallback)((()=>{i(!1),t(null)}),[e]),s=Object(a.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((e=>{r(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((()=>{r(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{i(!1),r(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:o,onOpenDeleteTimelineModal:s,isEnableDownloader:l,enableExportTimelineDownloader:u,disableExportTimelineDownloader:c}},L=h.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));L.displayName="SearchRowContainer";const B=h()(S.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));B.displayName="SearchRowFlexGroup";const q=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:l,children:r,timelineType:o})=>{const s=Object(a.useMemo)((()=>({placeholder:o===E.m.default?k.K:k.L,incremental:!1,"data-test-subj":"search-bar"})),[o]);return i.a.createElement(L,null,i.a.createElement(B,{gutterSize:"s"},i.a.createElement(S.EuiFlexItem,null,i.a.createElement(S.EuiSearchBar,{box:s,onChange:n})),i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:l,numFilters:null!=e?e:void 0},k.D),!!r&&r)))))}));q.displayName="SearchRow",n(43);const $=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:i,onCreateRule:l,onCreateRuleFromEql:r,hasCrudAccess:o})=>[{width:o?"80px":"150px",actions:[{name:k.g,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:E.m.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===E.m.template&&e.includes("createFrom")},{name:k.f,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:E.m.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==E.m.template&&e.includes("createFrom")},{name:k.E,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==E.m.template&&e.includes("duplicate")},{name:k.F,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===E.m.template&&e.includes("duplicate")},{name:k.o,icon:"exportAction",type:"icon",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==E.l.immutable,description:k.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:k.i,icon:"trash",type:"icon",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==E.l.immutable,description:k.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:k.d,icon:"indexEdit",type:"icon",onClick:e=>{null!=l&&e.savedObjectId&&l(e.savedObjectId)},enabled:e=>null!=l&&null!=e.savedObjectId&&e.status!==E.l.immutable,description:k.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=l&&null!=t&&t.hasQuery},{name:k.e,icon:"indexEdit",type:"icon",onClick:e=>{null!=r&&e.savedObjectId&&r(e.savedObjectId)},enabled:e=>null!=r&&null!=e.savedObjectId&&e.status!==E.l.immutable,description:k.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=r&&null!=t&&t.hasEql}]}],V="45px";var G=n(184),U=n(742),H=n(130),Q=n(151),W=n(149);const J=h.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),X=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{dataType:"auto",isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?i.a.createElement(S.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(N.omit)(a,e)):n({...e,[a]:i.a.createElement(U.a,{notes:t,timelineId:W.f.active})}),"aria-label":e[a]?k.c:k.m,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:V},{dataType:"string",field:"title",name:a===E.m.default?k.X:k.Y,render:(e,n)=>null!=n.savedObjectId?i.a.createElement(S.EuiLink,{"data-test-subj":`timeline-title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(G.e)(n)?k.Z:i.a.createElement(J,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(G.e)(n)?k.Z:e),sortable:!1},{dataType:"string",field:"description",name:k.l,render:e=>i.a.createElement(J,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(H.d)()),sortable:!1},{dataType:"date",field:"updated",name:k.y,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement(Q.b,{value:e}):Object(H.d)()),sortable:!0}],K=e=>e?[{dataType:"string",field:"updatedBy",name:k.B,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(H.a)(e)),sortable:!1}]:[],Y=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(S.EuiToolTip,{content:k.C},i.a.createElement(S.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(G.c)(t)),sortable:!1,width:V},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(S.EuiToolTip,{content:k.I},i.a.createElement(S.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(G.d)(t)}`),sortable:!1,width:V},favorite:{align:"center",field:"favorite",name:i.a.createElement(S.EuiToolTip,{content:k.p},i.a.createElement(S.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(S.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:V}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===E.m.template?n:a},Z=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:l,itemIdToExpandedNotesRowMap:r,enableExportTimelineDownloader:o,onCreateRule:s,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onTableChange:p,onToggleShowNotes:b,pageIndex:f,pageSize:g,searchResults:y,showExtendedColumns:v,sortField:h,sortDirection:j,tableRef:T,timelineType:O,totalSearchResultsCount:S})=>{const C=Object(a.useMemo)((()=>({showPerPageOptions:v,pageIndex:f,pageSize:g,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:S})),[n,f,g,v,S]),w=Object(a.useMemo)((()=>({sort:{field:h,direction:j}})),[h,j]),I=Object(a.useMemo)((()=>({selectable:e=>null!=e.savedObjectId&&e.status!==E.l.immutable,selectableMessage:e=>e?"":k.A,onSelectionChange:m})),[m]),{kibanaSecuritySolutionsPrivileges:M}=Object(x.a)(),_=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onCreateRule:i,onCreateRuleFromEql:l,onOpenDeleteTimelineModal:r,onOpenTimeline:o,onToggleShowNotes:s,showExtendedColumns:u,timelineType:c,hasCrudAccess:d})=>[...X({itemIdToExpandedNotesRowMap:a,onOpenTimeline:o,onToggleShowNotes:s,timelineType:c}),...K(u),...Y({timelineType:c}),...e.length?$({onCreateRule:i,onCreateRuleFromEql:l,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:r,onOpenTimeline:o,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:r,enableExportTimelineDownloader:o,onCreateRule:s,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onToggleShowNotes:b,showExtendedColumns:v,timelineType:O,hasCrudAccess:M.crud})),[e,t,r,o,s,u,c,d,m,b,v,O,M]),N=l||null==y?k.z:O===E.m.template?k.cb:k.bb;return i.a.createElement(ee,{columns:_,"data-test-subj":"timelines-table",itemId:"savedObjectId",itemIdToExpandedRowMap:r,items:null!=y?y:[],loading:l,noItemsMessage:N,onChange:p,pagination:C,selection:e.includes("selectable")?I:void 0,sorting:w,ref:T})}));Z.displayName="TimelinesTable";var ee=h()(S.EuiBasicTable).withConfig({displayName:"_StyledEuiBasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]),te=n(697);const ne=h.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ae=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:l,itemIdToExpandedNotesRowMap:r,importDataModalToggle:o,onCreateRule:s,onCreateRuleFromEql:u,onDeleteSelected:c,onlyFavorites:d,onOpenTimeline:m,onQueryChange:p,onSelectionChange:b,onTableChange:f,onToggleOnlyFavorites:g,onToggleShowNotes:v,pageIndex:h,pageSize:C,query:w,refetch:I,searchResults:M,selectedItems:_,sortDirection:N,setImportDataModalToggle:D,sortField:A,tabName:R,timelineType:F=E.m.default,timelineStatus:L,timelineFilter:B,templateTimelineFilter:$,totalSearchResultsCount:V})=>{var U;const{actionItem:H,enableExportTimelineDownloader:Q,isEnableDownloader:W,isDeleteTimelineModalOpen:J,onOpenDeleteTimelineModal:X,onCompleteEditTimelineAction:K}=P(),Y=Object(a.useRef)(null),{kibanaSecuritySolutionsPrivileges:ee}=Object(x.a)(),{getBatchItemsPopoverContent:ae}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:l=E.m.default})=>{const{enableExportTimelineDownloader:r,disableExportTimelineDownloader:o,isEnableDownloader:s,isDeleteTimelineModalOpen:u,onOpenDeleteTimelineModal:c,onCloseDeleteTimelineModal:d}=P(),m=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),o(),d()}),[o,d,n]),{timelineIds:p,searchIds:b}=Object(a.useMemo)((()=>null!=t?he(ve(t)):{timelineIds:[],searchIds:void 0}),[t]),f=Object(a.useCallback)((()=>r()),[r]),g=Object(a.useCallback)((()=>c()),[c]),y=Object(a.useCallback)((n=>{var a,r,o,c;const d=null==t||0===t.length,y=[];return t&&y.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:f},k.o)),e&&y.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:g},k.i)),i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{deleteTimelines:e,ids:p,savedSearchIds:b,isEnableDownloader:s,isDeleteTimelineModalOpen:u,onComplete:m.bind(null,n),title:1!==(null==t?void 0:t.length)?l===E.m.template?k.M(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):k.N(null!==(r=null==t?void 0:t.length)&&void 0!==r?r:0):null!==(o=null===(c=t[0])||void 0===c?void 0:c.title)&&void 0!==o?o:""}),i.a.createElement(S.EuiContextMenuPanel,{items:y}))}),[t,e,p,b,s,u,m,l,f,g]);return{onCompleteBatchActions:m,getBatchItemsPopoverContent:y}})({deleteTimelines:ee.crud?e:void 0,selectedItems:_,tableRef:Y,timelineType:F}),ie=Object(a.useMemo)((()=>i.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:V,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},w.trim().length?`${k.ab} "${w.trim()}"`:"")}})),[V,w]),le=Object(a.useMemo)((()=>i.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:V,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},w.trim().length?`${k.ab} "${w.trim()}"`:"")}})),[V,w]),re=Object(a.useMemo)((()=>null!=H&&null!=H.savedObjectId?[H.savedObjectId]:[]),[H]),oe=Object(a.useMemo)((()=>null!=H&&null!=H.savedSearchId?[H.savedSearchId]:void 0),[H]),se=Object(a.useCallback)((()=>{null!=I&&I()}),[I]),ue=Object(a.useCallback)((()=>{null!=D&&D(!1)}),[D]),ce=Object(a.useCallback)((()=>{null!=D&&D(!1),null!=I&&I()}),[D,I]),de=Object(a.useMemo)((()=>{if(ee.crud){const t=["createFrom","duplicate",...null!=s?["createRule"]:[],...null!=u?["createRuleFromEql"]:[]];return L!==E.l.immutable&&(t.push("export"),t.push("selectable")),null!=c&&null!=e&&L!==E.l.immutable&&t.push("delete"),t}return L!==E.l.immutable?["export","selectable"]:[]}),[s,u,L,c,e,ee]),me=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,$)),[$]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{deleteTimelines:e,ids:re,savedSearchIds:oe,isDeleteTimelineModalOpen:J,isEnableDownloader:W,onComplete:K,title:null!==(U=null==H?void 0:H.title)&&void 0!==U?U:k.Z}),i.a.createElement(j.a,{checkBoxLabel:k.H,closeModal:ue,description:k.O,errorMessage:k.t,failedDetailed:k.u,importComplete:ce,importData:O.f,successMessage:k.U,showCheckBox:!1,showModal:null!=o&&o,submitBtnText:k.w,subtitle:k.x,title:k.v}),i.a.createElement("div",{"data-test-subj":"timelines-page-container",className:G.a},!!B&&B,"notes"!==R?i.a.createElement(i.a.Fragment,null,i.a.createElement(q,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:d,onQueryChange:p,onToggleOnlyFavorites:g,query:w,timelineType:F},me),i.a.createElement(T.a,{border:!0},i.a.createElement(T.d,null,i.a.createElement(T.c,null,i.a.createElement(T.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,k.P," ",F===E.m.template?ie:le))),i.a.createElement(T.c,null,L!==E.l.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(T.e,{"data-test-subj":"selected-count"},F===E.m.template?k.M(_.length):k.N(_.length)),i.a.createElement(T.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:ae,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},k.a))),i.a.createElement(T.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:se},k.J)))),i.a.createElement(Z,{actionTimelineToShow:de,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:l,itemIdToExpandedNotesRowMap:r,enableExportTimelineDownloader:Q,onCreateRule:s,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:X,onOpenTimeline:m,onSelectionChange:b,onTableChange:f,onToggleShowNotes:v,pageIndex:h,pageSize:C,searchResults:M,showExtendedColumns:!0,sortDirection:N,sortField:A,timelineType:F,totalSearchResultsCount:V,tableRef:Y})):i.a.createElement(te.a,{onOpenTimeline:m})))}));ae.displayName="OpenTimeline";var ie=n(224);const le=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>i.a.createElement(ie.a,{title:a,split:!0,height:40},i.a.createElement(S.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},k.q)),e&&i.a.createElement(S.EuiFlexItem,null,e)))));le.displayName="TitleRow";const re=h.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);re.displayName="HeaderContainer";const oe=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:l=[],isLoading:r,itemIdToExpandedNotesRowMap:o,onAddTimelinesToFavorites:s,onDeleteSelected:u,onlyFavorites:c,onOpenTimeline:d,onQueryChange:m,onSelectionChange:p,onTableChange:b,onToggleOnlyFavorites:f,onToggleShowNotes:g,pageIndex:y,pageSize:v,searchResults:h,selectedItems:E,sortDirection:j,sortField:T,timelineFilter:O,timelineType:x,templateTimelineFilter:k,title:C,totalSearchResultsCount:w})=>{const I=Object(a.useRef)(null),M=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=u&&null!=e&&t.push("delete"),t.filter((e=>!l.includes(e)))}),[u,e,l]),_=Object(a.useMemo)((()=>i.a.createElement(a.Fragment,{key:"search-row-content"},!!k&&k)),[k]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiModalHeader,null,i.a.createElement(re,null,i.a.createElement(le,{"data-test-subj":"title-row",onAddTimelinesToFavorites:s,selectedTimelinesCount:E.length,title:C}))),i.a.createElement(S.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!O&&i.a.createElement(i.a.Fragment,null,O,i.a.createElement(S.EuiSpacer,{size:"m"})),i.a.createElement(q,{"data-test-subj":"search-row",onlyFavorites:c,onQueryChange:m,onToggleOnlyFavorites:f,query:"",timelineType:x},_),i.a.createElement(Z,{actionTimelineToShow:M,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:o,onOpenTimeline:d,onSelectionChange:p,onTableChange:b,onToggleShowNotes:g,pageIndex:y,pageSize:v,searchResults:h,showExtendedColumns:!1,sortDirection:j,sortField:T,timelineType:x,totalSearchResultsCount:w,tableRef:I}))))}));oe.displayName="OpenTimelineModalBody";var se=n(156),ue=n(194);let ce=function(e){return e.tab="tab",e.filter="filter",e}({});var de=n(911),me=n(127),pe=n(132),be=n(187),fe=n(219),ge=n(274),ye=n(158);const ve=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),he=e=>e.reduce(((e,{timelineId:t,searchId:n})=>{let a=e;return null!=n&&(a={...a,searchIds:[...a.searchIds,n]}),null!=t&&(a={...a,timelineIds:[...a.timelineIds,t]}),a}),{timelineIds:[],searchIds:[]}),Ee=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:y=!1,importDataModalToggle:v,onOpenTimeline:h,setImportDataModalToggle:j,tabName:T,title:x})=>{const w=Object(l.useDispatch)(),{startTransaction:I}=Object(be.b)(),[M,_]=Object(a.useState)({}),[D,A]=Object(a.useState)(!1),[R,F]=Object(a.useState)(0),[z,P]=Object(a.useState)(t),[L,B]=Object(a.useState)(""),[q,$]=Object(a.useState)([]),[V,U]=Object(a.useState)("desc"),[H,Q]=Object(a.useState)("updated"),W=Object(a.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),J=Object(d.b)((e=>{var t,n;return null!==(t=null===(n=W(e,m.c.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:X,selectedPatterns:K}=Object(pe.a)(me.SourcererScopeName.timeline),Y=Object(o.a)("unifiedComponentsInTimelineDisabled"),{customTemplateTimelineCount:Z,defaultTimelineCount:ee,elasticTemplateTimelineCount:te,favoriteCount:ne,fetchAllTimeline:ie,timelines:le,loading:re,totalCount:Ee,templateTimelineCount:je}=Object(f.b)(),{timelineType:Te,timelineTabs:Oe,timelineFilters:xe}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:l}=Object(ue.l)(se.a.timelines),{navigateToUrl:r}=Object(u.j)().services.application,{tabName:s}=Object(C.useParams)(),[c,d]=Object(a.useState)(s===E.m.default||s===E.m.template?s:E.m.default),m=Object(o.a)("securitySolutionNotesEnabled"),p=Object(a.useMemo)((()=>n(Object(ue.j)(E.m.default,l))),[n,l]),b=Object(a.useMemo)((()=>n(Object(ue.j)(E.m.template,l))),[n,l]),f=Object(a.useMemo)((()=>n(Object(ue.j)("notes",l))),[n,l]),g=Object(a.useCallback)((e=>{e.preventDefault(),r(p)}),[r,p]),y=Object(a.useCallback)((e=>{e.preventDefault(),r(b)}),[r,b]),v=Object(a.useCallback)((e=>{e.preventDefault(),r(f)}),[r,f]),h=Object(a.useCallback)((e=>[{id:E.m.default,name:k.W,href:p,disabled:!1,onClick:e===ce.tab?g:N.noop},{id:E.m.template,name:k.V,href:b,disabled:!1,onClick:e===ce.tab?y:N.noop}]),[p,b,g,y]),j=Object(a.useCallback)(((e,t)=>{d((t=>(t!==e&&d(e),t)))}),[d]),T=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},h(ce.tab).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`timeline-${ce.tab}-${e.id}`,isSelected:e.id===s,disabled:e.disabled,key:`timeline-${ce.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),j(e.id,ce.tab)}},e.name))),m&&i.a.createElement(S.EuiTab,{"data-test-subj":"timeline-notes",isSelected:"notes"===s,key:"timeline-notes",href:f,onClick:v},"Notes")),i.a.createElement(S.EuiSpacer,{size:"m"}))),[s]),O=Object(a.useMemo)((()=>i.a.createElement(S.EuiTabs,null,h(ce.filter).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ce.filter}-${e.id}`,isSelected:e.id===c,key:`timeline-${ce.filter}-${e.id}`,onClick:t=>{e.onClick(t),j(e.id,ce.filter)}},e.name))))),[c,h,j]);return{timelineType:c,timelineTabs:T,timelineFilters:O}})({defaultTimelineCount:ee,templateTimelineCount:je}),{timelineStatus:Se,templateTimelineFilter:ke,installPrepackagedTimelines:Ce}=Object(de.a)({timelineType:Te,customTemplateTimelineCount:Z,elasticTemplateTimelineCount:te}),we=Object(a.useCallback)((()=>{ie({pageInfo:{pageIndex:R+1,pageSize:z},search:L,sort:{sortField:H,sortOrder:V},onlyUserFavorite:D,timelineType:Te,status:Se})}),[ie,R,z,L,H,V,Te,Se,D]),Ie=Object(a.useCallback)((e=>{B(e.queryText.trim())}),[]),Me=Object(a.useCallback)((async(e,t)=>{I({name:e.length>1?fe.f.BULK_DELETE:fe.f.DELETE}),e.includes(J)&&w(Object(b.createTimeline)({id:m.c.active,columns:Y?g.b:ge.a,dataViewId:X,indexNames:K,show:!1,excludedRowRendererIds:Y?[]:ye.b.excludedRowRendererIds})),await Object(O.b)(e,t),we()}),[I,J,we,w,X,K,Y]),_e=Object(a.useCallback)((async(e,t)=>{await Me(e,t)}),[Me]),Ne=Object(a.useCallback)((async()=>{const e=ve(q),{timelineIds:t,searchIds:n}=he(e);await Me(t,n),Be()}),[q,Me]),De=Object(a.useCallback)((e=>{$(e)}),[]),Ae=Object(a.useCallback)((({page:e,sort:t})=>{if(null!=e){const{index:t,size:n}=e;F(t),P(n)}if(null!=t){const{field:e,direction:n}=t;U(n),Q(e)}}),[]),Re=Object(a.useCallback)((()=>{A(!D)}),[D]),Fe=Object(a.useCallback)((e=>{_(e)}),[]),{navigateTo:ze}=Object(u.l)(),Pe=Object(a.useCallback)((e=>ze({deepLinkId:c.Oc.rulesCreate,path:`?${s.b}=${Object(r.encode)(e)}`})),[ze]),Le=Object(a.useCallback)((e=>ze({deepLinkId:c.Oc.rulesCreate,path:`?${s.a}=${Object(r.encode)(e)}`})),[ze]),Be=Object(a.useCallback)((()=>{$([])}),[]),qe=Object(G.g)(),$e=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&I({name:fe.f.DUPLICATE}),y&&null!=e&&e(),qe({duplicate:t,onOpenTimeline:h,timelineId:n,timelineType:a,unifiedComponentsInTimelineDisabled:Y})}),[qe]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${G.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await Ce(),we()})()}),[we,Ce]),y?i.a.createElement(oe,{"data-test-subj":"open-timeline-modal",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,hideActions:n,isLoading:re,itemIdToExpandedNotesRowMap:M,onAddTimelinesToFavorites:void 0,onlyFavorites:D,onOpenTimeline:$e,onQueryChange:Ie,onSelectionChange:De,onTableChange:Ae,onToggleOnlyFavorites:Re,onToggleShowNotes:Fe,pageIndex:R,pageSize:z,query:L,searchResults:le,selectedItems:q,sortDirection:V,sortField:H,templateTimelineFilter:ke,timelineType:Te,timelineStatus:Se,timelineFilter:xe,title:x,totalSearchResultsCount:Ee}):i.a.createElement(ae,{"data-test-subj":"open-timeline",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,isLoading:re,itemIdToExpandedNotesRowMap:M,importDataModalToggle:v,onAddTimelinesToFavorites:void 0,onCreateRule:Pe,onCreateRuleFromEql:Le,onDeleteSelected:Ne,onlyFavorites:D,onOpenTimeline:$e,onQueryChange:Ie,onSelectionChange:De,onTableChange:Ae,onToggleOnlyFavorites:Re,onToggleShowNotes:Fe,pageIndex:R,pageSize:z,query:L,refetch:we,searchResults:le,setImportDataModalToggle:j,selectedItems:q,sortDirection:V,sortField:H,tabName:T,templateTimelineFilter:ke,timelineType:Te,timelineStatus:Se,timelineFilter:Oe,title:x,totalSearchResultsCount:Ee})})),je=i.a.memo(Ee)},954:function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return I}));var a=n(2),i=n.n(a),l=n(19),r=n(121),o=n(908),s=n(194);const u="timeline";var c=n(4);const d=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),m=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),p=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),b=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),f=e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),g=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var y=n(156);const v=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(s.l)(y.a.timelines),u=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),c=Object(a.useCallback)(((e,a,i)=>{const l=n(Object(s.k)(null!=a?a:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${l})`,{block:!1})}),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiModalHeader,null),i.a.createElement(l.EuiModalBody,null,i.a.createElement(o.a,{hideUntitled:!0,getSelectableOptions:u,onTimelineChange:c,onClosePopover:e,timelineType:r.m.default})))},h=Object(a.memo)(v),E=({interactionsUpsellingMessage:e})=>({name:u,button:{label:null!=e?e:d,iconType:"timeline",isDisabled:!!e},helpText:i.a.createElement(l.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return i.a.createElement(h,{onClosePopover:n,onInsert:t})}});var j=n(58),T=n(429);const O=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function i(e,n){if(t[a]!==e)throw new Error(b);a++;let i="",l=0;for(;a<t.length;a++){const r=t[a];if(r===n&&0===l)return a++,i;r===n?l--:r===e&&l++,i+=r}return""}const l=i("[","]"),r=i("(",")"),o=e.now();if(!l)return this.file.info(m,{line:o.line,column:o.column}),!1;try{var s;const t=r.split("?"),n=Object(T.parse)(t[1]),a=Object(j.safeDecode)(null!==(s=n.timeline)&&void 0!==s?s:""),{id:i="",graphEventId:c=""}=null!=a?a:{id:null,graphEventId:""};return i?e(`[${l}](${r})`)({type:u,id:i,title:l,graphEventId:c}):(this.file.info(p,{line:o.line,column:o.column+r.indexOf("id")}),!1)}catch{this.file.info((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(r),{line:o.line,column:o.column})}return!1},i=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,n.splice(n.indexOf("url"),0,u)};var x=n(208),S=n(184),k=n(122),C=n(123);const w=({id:e,title:t,graphEventId:n})=>{const{addError:r}=Object(C.a)(),o=Object(x.b)("investigation_guide_interactions"),s=(()=>{const e=Object(S.g)(),t=Object(k.a)("unifiedComponentsInTimelineDisabled");return Object(a.useCallback)(((n,a,i)=>{e({graphEventId:i,timelineId:n,onError:a,unifiedComponentsInTimelineDisabled:t})}),[e,t])})(),u=Object(a.useCallback)(((e,t)=>{r(e,{title:g,toastMessage:f(t)})}),[r]),d=Object(a.useCallback)((()=>s(null!=e?e:"",u,n)),[e,n,s,u]);return i.a.createElement(l.EuiToolTip,{content:null!=o?o:(m=null!=e?e:"",c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:m}}))},i.a.createElement(l.EuiLink,{onClick:d,disabled:!!o,"data-test-subj":`markdown-timeline-link-${e}`},t));var m},I=Object(a.memo)(w)},955:function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(44),i=n(19),l=n(2),r=n.n(l),o=n(41),s=n.n(o),u=n(179),c=n(121),d=n(252),m=n(4);const p=m.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),b=m.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),f=m.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),g=m.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),y=m.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),v=m.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),h=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),E=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),j=m.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),T=m.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),O=m.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),x=m.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),S=m.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),k=m.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),C=e=>m.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),w=[{label:y},{label:h},{label:v},{label:E},{label:b},{label:p}],I=[],M=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):I).map((e=>({label:e})))};var n})):I,_=({browserFields:e,selectedField:t,selectedOperator:n,type:i})=>{const l=t.length>0?t[0].label:"",r=n.length>0?n[0].label:"",o=e&&null!=Object(d.a)(e)[l],s=-1!==Object(a.findIndex)((e=>e.label===r),w),u=i===c.a.template&&(r===v||r===E);return o&&s&&!u},N=e=>{switch(e.length>0?e[0].label:""){case y:case h:return u.d;case v:case E:return u.c;case b:case p:return u.b;default:return u.d}},D=e=>{switch(e.length>0?e[0].label:""){case h:case E:case p:return!0;default:return!1}},A=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var R=n(191);const F=({value:e,onChangeCallback:t})=>{const[n,a]=Object(l.useState)(z(e));Object(l.useEffect)((()=>{t(P(n))}),[n,t]);const o=Object(l.useCallback)(((e,t=n)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&a([...n,{label:e}])}),[n]),s=Object(l.useCallback)((e=>{a(e)}),[]);return r.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:j,onCreateOption:o,onChange:s})},z=e=>Object(R.j)(e)?e.map((e=>({label:String(e)}))):[],P=e=>e.map((e=>e.label)),L=({value:e,onChangeCallback:t})=>{const[n,a]=Object(l.useState)(B(e));Object(l.useEffect)((()=>{t(A(n))}),[n,t]);const o=Object(l.useCallback)((e=>{a(e.target.value)}),[]);return r.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:o,placeholder:x,value:A(n)})},B=e=>{var t;return Object(R.j)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},q="edit-data-provider-save";s.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const $=r.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:o,onDataProviderEdited:s,operator:c,providerId:d,timelineId:m,value:j,type:x=u.a.default})=>{const[I,A]=Object(l.useState)([{label:n}]),[R,z]=Object(l.useState)(((e,t)=>":"===t?e?[{label:h}]:[{label:y}]:"includes"===t?e?[{label:E}]:[{label:v}]:e?[{label:p}]:[{label:b}])(o,c)),[P,B]=Object(l.useState)(j),$=Object(l.useMemo)((()=>R.length>0&&(R[0].label===v||R[0].label===E)),[R]),V=Object(l.useMemo)((()=>x!==u.a.template&&R.length>0&&R[0].label!==b&&R[0].label!==p&&!$),[$,x,R]),G=Object(l.useMemo)((()=>$&&Array.isArray(P)&&!P.length),[$,P]),U=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(q);e.length>0&&e[0].focus()}},H=Object(l.useCallback)((e=>{A(e),x===u.a.template&&B(`{${e[0].label}}`),U()}),[x]),Q=Object(l.useCallback)((e=>{z(e),U()}),[]),W=Object(l.useCallback)((e=>{B(e)}),[]),J=Object(l.useCallback)((()=>{s({andProviderId:e,excluded:D(R),field:I.length>0?I[0].label:"",id:m,operator:N(R),providerId:d,value:P,type:x})}),[s,e,R,I,m,d,P,x]);return Object(l.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),r.a.createElement(i.EuiPanel,{paddingSize:"s"},r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiFormRow,{label:f},r.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:H,options:M(t),placeholder:g,selectedOptions:I,singleSelection:{asPlainText:!0},fullWidth:!0}))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiFormRow,{label:T},r.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:Q,options:w,placeholder:k,selectedOptions:R,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!1},V&&r.a.createElement(i.EuiFormRow,{label:S},r.a.createElement(L,{onChangeCallback:W,value:j})),$&&x!==u.a.template&&r.a.createElement(i.EuiFormRow,{label:S},r.a.createElement(F,{onChangeCallback:W,value:j}))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!1},x===u.a.template&&$&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:C(R[0].label)}),r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{className:q,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!_({type:x,browserFields:t,selectedField:I,selectedOperator:R})||G,onClick:J,size:"m"},O))))))}));$.displayName="StatefulEditDataProvider"},956:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var a=n(2),i=n.n(a),l=n(92);const r={capabilities:Object(l.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var o=n(123),s=n(118),u=n(1532),c=n(1533);const d=Object(u.a)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),m=n(4).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),p={...r,capabilitiesFetched:!1},b=i.a.createContext(p);b.displayName="MlCapabilitiesContext";const f=i.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(p),l=Object(s.i)(),{addError:r}=Object(o.a)(),{start:u,result:f,error:g}=Object(c.a)(d);return Object(a.useEffect)((()=>{u({http:l})}),[l,u]),Object(a.useEffect)((()=>{f&&n({...f,capabilitiesFetched:!0})}),[f]),Object(a.useEffect)((()=>{g&&r(g,{title:m})}),[r,g]),i.a.createElement(b.Provider,{value:t},e)}));f.displayName="MlCapabilitiesProvider"},957:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),i=n.n(a),l=n(19),r=n(123),o=n(4);const s=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),u=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),m=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),p=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),b=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),f=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),i=new Error(a.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i};var g=n(242);const y=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:n}=Object(g.c)().services;if(!t||!e.length)return null;const{actionPath:a,message:r,buttonLabel:s}=e[0];return i.a.createElement(l.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:i.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(u=t,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:u},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},i.a.createElement(l.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(l.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},i.a.createElement(l.EuiText,{size:"xs"},r)),i.a.createElement(l.EuiFlexItem,null,i.a.createElement(l.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},i.a.createElement(l.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:n.basePath.prepend(a)},s||p)))));var u};y.displayName="ActionConnectorWarningsComponent";const v=i.a.memo(y);v.displayName="ActionConnectorWarnings";const h=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:p,failedDetailed:g,importComplete:y,importData:h,showCheckBox:E=!0,showExceptionsCheckBox:j=!1,showActionConnectorsCheckBox:T=!1,showModal:O,submitBtnText:x,subtitle:S,successMessage:k,title:C})=>{const[w,I]=Object(a.useState)(null),[M,_]=Object(a.useState)(!1),[N,D]=Object(a.useState)(!1),[A,R]=Object(a.useState)(!1),[F,z]=Object(a.useState)(!1),{addError:P,addSuccess:L}=Object(r.a)(),[B,q]=Object(a.useState)([]),$=Object(a.useMemo)((()=>Object(l.htmlIdGenerator)()()),[]),[V,G]=Object(a.useState)(0),U=Object(a.useCallback)((()=>{t(),D(!1),R(!1),z(!1),q([])}),[t,D,R]),H=Object(a.useCallback)((e=>{_(!1),I(null),y(),e&&(y(),U())}),[U,y]),Q=Object(a.useCallback)((async()=>{if(null!=w){_(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...n}=await h({fileToImport:w[0],overwrite:N,overwriteExceptions:A,overwriteActionConnectors:F,signal:e.signal}),a=n.action_connectors_success_count;q(t),G(a),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:n,successMessage:a,errorMessage:i,errorMessageDetailed:l,addError:r,addSuccess:s})=>{if(e.success)return e.success_count>0&&s(a(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&s((c=e.exceptions_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:c},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(n&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&s((u=e.action_connectors_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:u},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var u,c;if(e.errors.length>0){if(n&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:n}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:n,error:a}=e;t=t&&t!==n?`${t},${n}`:n;const{status_code:i,message:l}=a||{};let r;return r=403===i?b:l,{...e,error:{...a,message:r}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return r(f(l,e,t),{title:m(n||t.length)})}r(f(l,e,e.errors),{title:i(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&r(f(l,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:n,exceptionsIncluded:j,actionConnectorsIncluded:T,successMessage:k,errorMessage:p,errorMessageDetailed:g,addError:P,addSuccess:L}),H(!(null!=t&&t.length))}catch(e){U(),P(e,{title:p(1)})}}}),[w,h,N,A,F,j,k,p,g,P,L,T,H,U]),W=Object(a.useCallback)((()=>{U()}),[U]),J=Object(a.useCallback)((()=>{D((e=>!e))}),[]),X=Object(a.useCallback)((()=>{R((e=>!e))}),[]),K=Object(a.useCallback)((()=>{z((e=>!e))}),[]),Y=Object(a.useCallback)((e=>{I(e&&e.length>0?e:null)}),[]);return i.a.createElement(i.a.Fragment,null,O&&i.a.createElement(l.EuiModal,{onClose:W,maxWidth:"750px"},i.a.createElement(l.EuiModalHeader,null,i.a.createElement(l.EuiModalHeaderTitle,null,C)),i.a.createElement(l.EuiModalBody,null,i.a.createElement(l.EuiText,{size:"s"},i.a.createElement("h4",{id:$},n)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:S,onChange:Y,display:"large",fullWidth:!0,isLoading:M,"aria-labelledby":$}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(v,{actionConnectorsWarnings:B,importedActionConnectorsCount:V}),i.a.createElement(l.EuiSpacer,{size:"s"}),E&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:N,onChange:J}),j&&i.a.createElement(l.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:u,checked:A,onChange:X}),T&&i.a.createElement(l.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:c,checked:F,onChange:K}))),i.a.createElement(l.EuiModalFooter,null,i.a.createElement(l.EuiButtonEmpty,{onClick:W},s),i.a.createElement(l.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:Q,disabled:null==w||M,fill:!0},x))))};h.displayName="ImportDataModalComponent";const E=i.a.memo(h);E.displayName="ImportDataModal"},961:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var a=n(44),i=n(2),l=n.n(i),r=n(45),o=n(121),s=n(124),u=n(129),c=n(19),d=n(52),m=n.n(d),p=n(41),b=n.n(p),f=n(130),g=n(657),y=n(179),v=n(516);const h=b()(c.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===o.m.template?"140px":"none"));h.displayName="ProviderBadgeStyled";const E=b.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),j=b()(E).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),T=b()(E).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),O=({type:e,toggleType:t})=>e!==y.a.template?l.a.createElement(T,{onClick:t},v.d):l.a.createElement(j,null,v.w),x=l.a.memo(O),S={tabIndex:-1},k=l.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:r,operator:s,providerId:u,togglePopover:c,toggleType:d,displayValue:p,val:b,type:E,timelineType:j})=>{const T=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),O=Object(i.useMemo)((()=>m()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":r})),[n,r]),k=Object(i.useMemo)((()=>Object(a.isString)(b)&&""===b?Object(f.b)():b),[b]),C=Object(i.useMemo)((()=>r?l.a.createElement("span",null,v.q," "):null),[r]),w=Object(i.useMemo)((()=>l.a.createElement(l.a.Fragment,null,C,s!==y.b?l.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===s?p:k}"`):l.a.createElement("span",{className:"field-value"},t," ",v.j))),[p,t,k,s,C]),I=Object(i.useMemo)((()=>v.v({field:t,value:`${k}`})),[t,k]);return l.a.createElement(g.a,{id:`${u}-${t}-${b}`},l.a.createElement(l.a.Fragment,null,l.a.createElement(h,{className:O,color:"hollow",title:"",iconOnClick:T,iconOnClickAriaLabel:v.t,iconType:"cross",iconSide:"right",onClick:c,onClickAriaLabel:I,closeButtonProps:S,"data-test-subj":"providerBadge",$timelineType:j},w),j===o.m.template&&s!==y.c&&l.a.createElement(x,{toggleType:d,type:E})))}));k.displayName="ProviderBadge";var C=n(0),w=n.n(C),I=n(955);const M="edit-data-provider",_="exclude-data-provider",N="enable-data-provider",D="filter-for-field-present-data-provider",A="delete-data-provider",R=b()(c.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);R.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends l.a.PureComponent{constructor(...e){super(...e),w()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:l,value:r,type:o})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:l,value:r,type:o}),this.props.closePopover()})),w()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:i,type:l}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:y.b,providerId:a,value:i,type:l}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:i,field:r,isEnabled:s,isExcluded:u,isLoading:d,isOpen:m,operator:p,providerId:b,timelineId:f,timelineType:g,toggleEnabledProvider:h,toggleExcludedProvider:E,toggleTypeProvider:j,value:T,type:O}=this.props,x=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:i,isExcluded:r,isLoading:s,operator:u,onDataProviderEdited:c,onFilterForFieldPresent:d,providerId:m,timelineId:p,timelineType:b,toggleEnabled:f,toggleExcluded:g,toggleType:h,type:E,value:j})=>[{id:0,items:[{className:M,disabled:s,icon:"pencil",name:v.g,panel:1},{className:_,disabled:s,icon:r?"plusInCircle":"minusInCircle",name:r?v.p:v.i,onClick:g},{className:N,disabled:s,icon:i?"eyeClosed":"eye",name:i?v.x:v.u,onClick:f},{className:D,disabled:s,icon:"logstashFilter",name:v.k,onClick:d},b===o.m.template?{className:"convert-to-field-data-provider",disabled:s||u===y.c,icon:"visText",name:E===y.a.template?v.c:v.d,onClick:h}:{name:null},{className:A,disabled:s,icon:"trash",name:v.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=p&&null!=c?l.a.createElement(I.a,{andProviderId:e,browserFields:t,field:a,isExcluded:r,onDataProviderEdited:c,operator:u,providerId:m,timelineId:p,value:j,type:E}):null,id:1,title:v.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:r,isEnabled:s,isExcluded:u,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:p,providerId:b,timelineId:f,timelineType:g,toggleEnabled:h,toggleExcluded:E,toggleType:j,value:T,type:O});return l.a.createElement(R,{id:`popoverFor_${b}-${r}-${T}`,isOpen:m,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},l.a.createElement("div",{style:{userSelect:"none"}},l.a.createElement(c.EuiContextMenu,{initialPanelId:0,panels:x,"data-test-subj":"providerActions"})))}}var F=n(337),z=n(158);const P=l.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isPopoverOpen:b,onDataProviderEdited:f,operator:g,providerId:v,register:h,setIsPopoverOpen:E,timelineId:j,toggleEnabledProvider:T,toggleExcludedProvider:O,toggleTypeProvider:x,displayValue:S,val:C,type:w=y.a.default,wrapperRef:I})=>{const M=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),_=Object(s.b)((e=>{var t,n;return j&&null!==(t=null===(n=M(e,j))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:o.m.default})),{isLoading:N}=Object(s.a)((e=>{var t;return null!==(t=M(e,null!=j?j:""))&&void 0!==t?t:z.b})),D=Object(i.useCallback)((()=>{E(!b)}),[b,E]),A=Object(i.useCallback)((()=>{var e;E(!1),null==I||null===(e=I.current)||void 0===e||e.focus()}),[I,E]),R=Object(i.useCallback)((()=>{T(),A()}),[A,T]),P=Object(i.useCallback)((()=>{O(),A()}),[O,A]),L=Object(i.useCallback)((()=>{x(),A()}),[x,A]),[B,q]=Object(i.useState)(!1),$=Object(r.useDispatch)();Object(i.useEffect)((()=>{null!=h&&($(F.a.registerProvider({provider:{...h,and:[]}})),q(!0))}),[B,$,h,q]);const V=Object(i.useCallback)((()=>{B&&null!=h&&$(F.a.unRegisterProvider({id:h.id}))}),[B,$,h]);Object(i.useEffect)((()=>()=>{V()}),[V]);const G=Object(i.useMemo)((()=>l.a.createElement(k,{deleteProvider:N?a.noop:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,providerId:v,togglePopover:D,toggleType:L,displayValue:null!=S?S:String(C),val:C,operator:g,type:w,timelineType:_})),[n,S,c,m,p,N,d,L,g,v,_,D,w,C]);return l.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:G,closePopover:A,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isLoading:N,isOpen:b,onDataProviderEdited:f,operator:g,providerId:v,timelineId:j,timelineType:_,toggleEnabledProvider:R,toggleExcludedProvider:P,toggleTypeProvider:L,value:C,type:w})}));P.displayName="ProviderItemBadge"},971:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(7),i=n(2),l=n.n(i),r=n(188),o=n.n(r),s=n(11),u=n(70),c=n(12),d=n(118);const m=e=>"esql"in e?{query:e.esql,language:"esql"}:e,p=e=>null!=e&&"object"==typeof e&&Object.hasOwn(e,"getName"),b=Object(i.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:r,isLoading:b=!1,isRefreshPaused:f,filterQuery:g,filterManager:y,filters:v,onChangedQuery:h,onSubmitQuery:E,refreshInterval:j,savedQuery:T,onSavedQuery:O,dataTestSubj:x,displayStyle:S,isDisabled:k})=>{const{data:C}=Object(d.j)().services,[w,I]=Object(i.useState)(),M=Object(i.useCallback)((e=>{if(null!=e.query&&!o()(e.query,g)){const t=m(e.query);E(t)}}),[g,E]),_=Object(i.useCallback)((e=>{if(h&&null!=e.query&&!o()(e.query,g)){const t=m(e.query);h(t)}}),[g,h]),N=Object(i.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;E(t,a),y.setFilters(n||[]),O(e)}),[y,E,O]),D=Object(i.useCallback)((()=>{null!=T&&(E({query:"",language:T.attributes.query.language}),y.setFilters([]),O(void 0))}),[y,E,O,T]),A=Object(i.useCallback)((e=>{y.setFilters(e)}),[y]),R="esql"===(null==g?void 0:g.language),F=Object(i.useMemo)((()=>R&&"string"==typeof g.query?{esql:g.query}:g),[g,R]);Object(i.useEffect)((()=>{let e;return p(r)?I(r):R||(async()=>{e=await C.dataViews.create({id:r.title,title:r.title}),I(e)})(),()=>{var t,n;null!==(t=e)&&void 0!==t&&t.id&&C.dataViews.clearInstanceCache(null===(n=e)||void 0===n?void 0:n.id)}}),[C.dataViews,r,R]);const z=Object(i.useMemo)((()=>{if(p(r)||R)return v;const e=Object(a.cloneDeep)(v);return e.forEach((e=>e.meta.index=r.title)),e}),[v,r,R]),P=Object(i.useMemo)((()=>new s.TimeHistory(new c.Storage(localStorage))),[]),L=Object(i.useMemo)((()=>null!=w?[w]:[]),[w]);return l.a.createElement(u.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:z,indexPatterns:L,isLoading:b,isRefreshPaused:f,query:F,onClearSavedQuery:D,onFiltersUpdated:A,onQueryChange:_,onQuerySubmit:M,onSaved:O,onSavedQueryUpdated:N,refreshInterval:j,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:P,dataTestSubj:x,savedQuery:T,displayStyle:S,isDisabled:k})}));b.displayName="QueryBar"},972:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(118),l=n(122);const r=()=>{const{uiSettings:e}=Object(i.j)().services,t=null==e?void 0:e.get("enableESQL"),n=Object(l.a)("timelineEsqlTabDisabled"),r=!Object(l.a)("esqlRulesDisabled")&&t;return Object(a.useMemo)((()=>({isEsqlAdvancedSettingEnabled:t,isEsqlRuleTypeEnabled:r,isTimelineEsqlEnabledByFeatureFlag:!n})),[t,n,r])}}}]);