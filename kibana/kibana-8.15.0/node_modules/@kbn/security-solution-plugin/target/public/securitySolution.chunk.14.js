/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[14],{1101:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(7),r=a(2),i=a.n(r),o=a(19),s=a(4),l=a(42),c=a(964),u=a(130),d=a(405),p=a(923),m=a(208),y=a(16),g=a(293),f=a(661),b=a(966),h=a(135);const v=Object(r.memo)((({togglePopover:e,isDisabled:t,toolTipMessage:a})=>i.a.createElement(o.EuiToolTip,{position:"bottom",content:a},i.a.createElement(o.EuiButtonIcon,{"aria-label":"Update assignees","data-test-subj":h.g,iconType:"plusInCircle",onClick:e,isDisabled:t}))));v.displayName="UpdateAssigneesButton";const E=Object(r.memo)((({eventId:e,assignedUserIds:t,onAssigneesUpdated:a,isPreview:E})=>{const x=Object(y.b)().isPlatinumPlus(),k=Object(m.b)("alert_assignments"),{hasIndexWrite:w}=Object(g.a)(),S=Object(c.a)(),j=Object(r.useMemo)((()=>new Set(t)),[t]),{data:O}=Object(f.a)({uids:j}),[I,C]=Object(r.useState)(!1),T=Object(r.useCallback)((()=>{a&&a()}),[a]),M=Object(r.useCallback)((()=>{C((e=>!e))}),[]),_=Object(r.useCallback)((async t=>{C(!1),S&&await S(t,[e],T,n.noop)}),[e,T,S]),N=Object(o.useGeneratedHtmlId)({prefix:"searchInput"}),D=Object(r.useMemo)((()=>i.a.createElement(o.EuiPopover,{panelPaddingSize:"none",initialFocus:`#${N}`,button:i.a.createElement(v,{togglePopover:M,isDisabled:!w||!x,toolTipMessage:null!=k?k:s.i18n.translate("xpack.securitySolution.flyout.right.visualizations.assignees.popoverTooltip",{defaultMessage:"Assign alert"})}),isOpen:I,panelStyle:{minWidth:d.a},closePopover:M},i.a.createElement(p.a,{searchInputId:N,assignedUserIds:t,onApply:_}))),[t,_,w,x,I,N,M,k]);return i.a.createElement(o.EuiFlexGroup,{"data-test-subj":h.h,direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiTitle,{size:"xxs","data-test-subj":h.i},i.a.createElement("h3",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.assignedTitle",defaultMessage:"Assignees"})))),E?Object(u.d)():i.a.createElement(o.EuiFlexGroup,{gutterSize:"none",responsive:!1},O&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(b.a,{userProfiles:O,maxVisibleAvatars:2})),i.a.createElement(o.EuiFlexItem,{grow:!1},D)))}));E.displayName="Assignees"},1105:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={BULK_QUERY_STATUS_UPDATE:"Data table bulkQueryStatusUpdate",BULK_STATUS_UPDATE:"Data table bulkStatusUpdate",STATUS_UPDATE:"Data table statusUpdate"}},1106:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return y}));var n=a(2),r=a.n(n),i=a(44),o=a(19),s=a(1301),l=a.n(s),c=a(1304),u=a(41);const d=a.n(u).a.span.withConfig({displayName:"FlagWrapper",componentId:"sc-pwsog3-0"})(["position:relative;top:1px;"]),p=e=>e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCharCode(55356,56741+e.charCodeAt(0)))):null,m=Object(n.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{Object(n.useEffect)((()=>{t&&Object(i.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c)}),[]);const a=p(e);return null!==a?t?r.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},r.a.createElement(d,{"data-test-subj":"country-flag"},a)):r.a.createElement(d,{"data-test-subj":"country-flag"},a):null}));m.displayName="CountryFlag";const y=Object(n.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{const[a,s]=Object(n.useState)(!1);Object(n.useEffect)((()=>{Object(i.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c),s(!0)}),[]);const u=p(e);return null!==u&&a?t?r.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},r.a.createElement(d,{"data-test-subj":"country-flag"},u)):r.a.createElement(r.a.Fragment,null,r.a.createElement(d,{"data-test-subj":"country-flag"},u),` ${l.a.getName(e,"en")}`):null}));y.displayName="CountryFlagAndName"},1107:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(140);const i=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.manage},o=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.read},s=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&(a.create||a.create_doc||a.index||a.write)},l=()=>{const[e,t]=Object(n.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:a}=Object(r.a)();return Object(n.useEffect)((()=>{if(null!=a.result){const{is_authenticated:e,lists:{index:n},listItems:{index:r}}=a.result;t({isAuthenticated:e,canReadIndex:o(n)&&o(r),canManageIndex:i(n)&&i(r),canWriteIndex:s(n)&&s(r)})}}),[a.result]),Object(n.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[a.error]),{loading:a.loading,...e}}},1201:function(e,t,a){"use strict";a.d(t,"a",(function(){return F}));var n=a(2),r=a.n(n),i=a(45),o=a(294),s=a(118),l=a(148),c=a(243),u=a(266),d=a(19),p=a(41),m=a.n(p),y=a(4);const g=y.i18n.translate("xpack.securitySolution.fieldBrowser.createFieldButton",{defaultMessage:"Create field"}),f=m()(d.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-1abg8tf-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),b=y.i18n.translate("xpack.securitySolution.fieldBrowser.fieldName",{defaultMessage:"Name"}),h=y.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionLabel",{defaultMessage:"Description"}),v=y.i18n.translate("xpack.securitySolution.fieldBrowser.categoryLabel",{defaultMessage:"Category"}),E=y.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeLabel",{defaultMessage:"Runtime"}),x=y.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeTitle",{defaultMessage:"Runtime Field"}),k=y.i18n.translate("xpack.securitySolution.fieldBrowser.actionsLabel",{defaultMessage:"Actions"}),w=y.i18n.translate("xpack.securitySolution.fieldBrowser.editButton",{defaultMessage:"Edit"}),S=y.i18n.translate("xpack.securitySolution.fieldBrowser.removeButton",{defaultMessage:"Remove"}),j=y.i18n.translate("xpack.securitySolution.fieldBrowser.editButtonDescription",{defaultMessage:"Edit runtime field"}),O=y.i18n.translate("xpack.securitySolution.fieldBrowser.removeButtonDescription",{defaultMessage:"Delete runtime field"});var I=a(284),C=a(130),T=a(424);const M=m()(d.EuiIcon).withConfig({displayName:"TypeIcon",componentId:"sc-1coc1q1-0"})(["margin:0 4px;position:relative;top:-1px;"]);M.displayName="TypeIcon";const _=m.a.span.withConfig({displayName:"Description",componentId:"sc-1coc1q1-1"})(["user-select:text;width:",";"],(({width:e})=>e));_.displayName="Description";const N=r.a.memo((({fieldId:e,highlight:t=""})=>r.a.createElement(d.EuiText,{size:"xs"},r.a.createElement(d.EuiHighlight,{"data-test-subj":`field-${e}-name`,search:t},e))));N.displayName="FieldName";var D=a(187),A=a(219);const F=({sourcererScope:e,editorActionsRef:t,removeColumn:a,upsertColumn:p})=>{const[m,F]=Object(n.useState)(null),{startTransaction:q}=Object(D.b)(),{indexFieldsSearch:L}=Object(o.b)(),{dataViewFieldEditor:R,data:{dataViews:P}}=Object(s.j)().services,z=Object(i.useSelector)((t=>l.e.sourcererScopeMissingPatterns(t,e))),B=Object(i.useSelector)((t=>l.e.sourcererScopeSelectedDataViewId(t,e)));Object(n.useEffect)((()=>{let e=!1;return null==B||z.length||(async t=>{const a=await P.get(t);e||F(a)})(B),()=>{e=!0}}),[B,z,P]);const $=Object(n.useCallback)((async e=>{if(m&&B){const n=await R.openEditor({ctx:{dataView:m},fieldName:e,onSave:async n=>{q({name:A.c.FIELD_SAVED}),await L({dataViewId:B,cleanCache:!0});for(const t of n)e&&e!==t.name&&a(e),p({columnHeaderType:c.a,id:t.name,initialWidth:u.a},0);t&&(t.current=null)}});t&&(t.current={closeEditor:()=>{t.current=null,n()}})}}),[m,B,R,t,L,a,p,q]),G=Object(n.useCallback)((e=>{m&&B&&R.openDeleteModal({ctx:{dataView:m},fieldName:e,onDelete:async()=>{q({name:A.c.FIELD_DELETED}),await L({dataViewId:B}),a(e)}})}),[m,B,R,L,a,q]),U=Object(n.useMemo)((()=>null==R?void 0:R.userPermissions.editIndexPattern()),[null==R?void 0:R.userPermissions]),V=(({isAllowed:e,loading:t,openFieldEditor:a})=>{const i=Object(n.useCallback)((({onHide:e})=>r.a.createElement(f,{iconType:t?"none":"plusInCircle","aria-label":g,"data-test-subj":"create-field",onClick:()=>{a(),e()},isLoading:t},g)),[t,a]);return e?i:void 0})({isAllowed:U&&!!B,loading:!m,openFieldEditor:$}),H=(({hasFieldEditPermission:e,openFieldEditor:t,openDeleteFieldModal:a})=>Object(n.useCallback)((({highlight:n,onHide:i})=>{const o=e?[{name:w,description:j,type:"icon",icon:"pencil",isPrimary:!0,onClick:({name:e})=>{t(e),i()},available:({isRuntime:e})=>e,"data-test-subj":"actionEditRuntimeField"},{name:S,description:O,type:"icon",icon:"trash",color:"danger",isPrimary:!0,onClick:({name:e})=>{a(e),i()},available:({isRuntime:e})=>e,"data-test-subj":"actionDeleteRuntimeField"}]:[];return[{field:"name",name:b,render:(e,{type:t})=>r.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(d.EuiToolTip,{content:t},r.a.createElement(M,{"data-test-subj":`field-${e}-icon`,type:Object(I.d)(null!=t?t:null)}))),r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(N,{fieldId:e,highlight:n}))),sortable:!0,width:"225px"},{field:"description",name:h,render:(e,{name:t})=>{return r.a.createElement(d.EuiToolTip,{content:e},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"descriptionForScreenReaderOnly"},r.a.createElement("p",null,(a=t,y.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionForScreenReaderOnly",{values:{field:a},defaultMessage:"Description for field {field}:"})))),r.a.createElement(T.a,null,r.a.createElement(_,{width:o.length>0?"335px":"400px","data-test-subj":`field-${t}-description`},`${null!=e?e:Object(C.e)()}`))));var a},sortable:!0,width:o.length>0?"335px":"400px"},{field:"isRuntime",name:E,render:e=>e?r.a.createElement(d.EuiHealth,{color:"success",title:x}):null,sortable:!0,width:"80px"},{field:"category",name:v,render:(e,{name:t})=>r.a.createElement(d.EuiBadge,{"data-test-subj":`field-${t}-category`},e),sortable:!0,width:"115px"},...o.length>0?[{name:k,actions:o,width:"80px"}]:[]]}),[e,t,a]))({hasFieldEditPermission:U,openFieldEditor:$,openDeleteFieldModal:G});return Object(n.useMemo)((()=>({createFieldButton:V,getFieldTableColumns:H})),[V,H])}},1204:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(2),r=a.n(n),i=a(19),o=a(4),s=a(41),l=a.n(s),c=a(42),u=a(122);const d=o.i18n.translate("xpack.securitySolution.management.policiesSelector.globalEntries",{defaultMessage:"Global entries"}),p=o.i18n.translate("xpack.securitySolution.management.policiesSelector.unassignedEntries",{defaultMessage:"Unassigned entries"}),m=Object(n.memo)((({policies:e,onChangeSelection:t,defaultExcludedPolicies:a,defaultIncludedPolicies:o})=>{const{euiTheme:s}=Object(i.useEuiTheme)(),[l,m]=Object(n.useState)(!1),[g,f]=Object(n.useState)(""),[b,h]=Object(n.useState)([]),v=Object(u.a)("excludePoliciesInFilterEnabled");Object(n.useEffect)((()=>{const t=o?o.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},n=a?a.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},r=e=>t[e]?"on":n[e]?"off":void 0;h([...e.map((e=>({name:e.name,id:e.id,checked:r(e.id)}))),{name:d,id:"global",checked:r("global")},{name:p,id:"unassigned",checked:r("unassigned")}])}),[e]);const E=Object(n.useCallback)((()=>{m((e=>!e))}),[]),x=Object(n.useCallback)((()=>{m(!1)}),[]),k=Object(n.useCallback)((e=>{const t=e.target.value||"";f(t)}),[]),w=Object(n.useCallback)((e=>{if(!b[e])return;const a=[...b];switch(a[e].checked){case"on":a[e].checked=v?"off":void 0;break;case"off":a[e].checked=void 0;break;default:a[e].checked="on"}h(a),t(a)}),[b,t,v]),S=Object(n.useMemo)((()=>b.map(((e,t)=>e.name.toLowerCase().includes(g.toLowerCase())?r.a.createElement(i.EuiFilterSelectItem,{checked:e.checked,key:t,onClick:()=>w(t),"data-test-subj":`policiesSelector-popover-items-${e.id}`},e.name):null))),[b,g,w]),j=Object(n.useMemo)((()=>r.a.createElement(i.EuiFilterButton,{iconType:"arrowDown","data-test-subj":"policiesSelectorButton",onClick:E,isSelected:l,numFilters:b.length,hasActiveFilters:!!b.find((e=>"on"===e.checked)),numActiveFilters:b.filter((e=>"on"===e.checked)).length},r.a.createElement(i.EuiText,null,r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.management.policiesSelector.label",defaultMessage:"Policies"})))),[l,b,E]);return r.a.createElement(i.EuiFlexGroup,{"data-test-subj":"policiesSelector",direction:"row",alignItems:"center",gutterSize:"l"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFilterGroup,null,r.a.createElement(i.EuiPopover,{button:j,isOpen:l,closePopover:x,panelPaddingSize:"none"},r.a.createElement(i.EuiPopoverTitle,{paddingSize:"s"},r.a.createElement(i.EuiFieldSearch,{"data-test-subj":"policiesSelectorSearch",compressed:!0,onChange:k,value:g})),r.a.createElement(y,{"data-test-subj":"policiesSelector-popover",className:"eui-yScroll",$_css:30*s.base},S)))))}));m.displayName="PoliciesSelector";var y=l()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-gji8ln-0"})((e=>({maxHeight:e.$_css}))),g=a(140);const f=Object(n.memo)((({defaultValue:e="",onSearch:t,placeholder:a,hasPolicyFilter:s,policyList:l,defaultIncludedPolicies:c,hideRefreshButton:u=!1})=>{const{canCreateArtifactsByPolicy:d}=Object(g.a)().endpointPrivileges,[p,y]=Object(n.useState)(e),[f,b]=Object(n.useState)(c||""),h=Object(n.useCallback)((e=>{const a=e.filter((e=>"on"===e.checked)).map((e=>e.id)).join(",");b(a),t(p,a,!1)}),[t,p]),v=Object(n.useCallback)((e=>y(e.target.value)),[y]),E=Object(n.useCallback)((()=>t(p,f,!0)),[t,p,f]),x=Object(n.useCallback)((e=>{t(e,f,!1)}),[t,f]);return r.a.createElement(i.EuiFlexGroup,{"data-test-subj":"searchExceptions",direction:"row",alignItems:"center",gutterSize:"m"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFieldSearch,{defaultValue:e,placeholder:a,onChange:v,onSearch:x,isClearable:!0,fullWidth:!0,"data-test-subj":"searchField"})),d&&s&&l?r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(m,{policies:l,defaultIncludedPolicies:c,onChangeSelection:h})):null,u?null:r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{iconType:"refresh",onClick:E,"data-test-subj":"searchButton"},o.i18n.translate("xpack.securitySolution.management.search.button",{defaultMessage:"Refresh"}))))}));f.displayName="SearchExceptions"},1207:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(2),r=a(1558),i=a(527),o=a(1532),s=a(1533),l=a(314),c=a(707),u=a(123),d=a(118),p=a(201),m=a(896);const y=Object(o.a)((async({http:e,jobIds:t,signal:a})=>e.fetch("/internal/ml/jobs/jobs",{method:"POST",version:"1",body:JSON.stringify({jobIds:t}),asSystemRequest:!0,signal:a}))),g=(e,t,a)=>{const o=Object(n.useMemo)((()=>null!=e?e:[]),[e]),{loading:g,jobs:f}=Object(i.a)(),b=Object(n.useMemo)((()=>f.filter((({id:e})=>o.includes(e)))),[f,o]),h=Object(n.useMemo)((()=>b.filter((({isInstalled:e})=>e)).map((e=>e.id))),[b]),{loading:v,jobs:E}=(e=>{const[t,a]=Object(n.useState)([]),{addError:r}=Object(u.a)(),i=Object(p.a)(),o=Object(d.i)(),{error:g,loading:f,result:b,start:h}=Object(s.a)(y),v=Object(l.a)(i),E=Object(c.a)(i);return Object(n.useEffect)((()=>{v&&E&&e.length>0&&h({http:o,jobIds:e})}),[o,v,E,h,e]),Object(n.useEffect)((()=>{b&&a(b)}),[b]),Object(n.useEffect)((()=>{g&&r(g,{title:m.a})}),[r,g]),{isLicensed:E,isMlUser:v,jobs:t,loading:f}})(h),x=Object(n.useMemo)((()=>{const e=E.map((e=>`.ml-anomalies-${e.results_index_name}`));return[...new Set(e)]}),[E]);return{mlJobLoading:g||v,ruleIndices:Object(n.useMemo)((()=>x.length>0?x:a?Object(r.a)(a):null!=t?t:[]),[t,a,x])}}},1210:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(5);a(99);var i=a(364);const o=({_id:e,_index:t,timestamp:a})=>{const{getAppUrl:o}=Object(i.a)(),s=(({alertId:e,index:t,timestamp:a})=>`${r.g}/${e}?index=${t}&timestamp=${a}`)({alertId:e,index:t,timestamp:a}),l=t.includes(r.X);return Object(n.useMemo)((()=>{if(l)return null;const e=o({path:s});return`${window.location.origin}${e}`}),[l,o,s])}},1222:function(e,t,a){"use strict";a.d(t,"t",(function(){return T})),a.d(t,"h",(function(){return M})),a.d(t,"d",(function(){return _})),a.d(t,"o",(function(){return N})),a.d(t,"r",(function(){return D})),a.d(t,"e",(function(){return A})),a.d(t,"n",(function(){return F})),a.d(t,"m",(function(){return R})),a.d(t,"j",(function(){return P})),a.d(t,"s",(function(){return B})),a.d(t,"g",(function(){return $})),a.d(t,"k",(function(){return G})),a.d(t,"q",(function(){return U})),a.d(t,"p",(function(){return V})),a.d(t,"i",(function(){return W})),a.d(t,"a",(function(){return Y})),a.d(t,"c",(function(){return Z})),a.d(t,"b",(function(){return K})),a.d(t,"l",(function(){return Q})),a.d(t,"f",(function(){return X}));var n=a(41),r=a.n(n),i=a(19),o=a(813),s=a(44),l=a(2),c=a.n(l),u=a(70),d=a(566),p=a(290),m=a(662),y=a(227),g=a(1223),f=a(1224),b=a(663),h=a(298),v=a(248),E=a(130),x=a(772),k=a(773),w=a(791);const S=r()(i.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-1fdewst-0"})(["height:105px;overflow-y:hidden;"]),j=r()(i.EuiFlexItem).withConfig({displayName:"SetupDescriptionContainer",componentId:"sc-1fdewst-1"})(["height:105px;overflow-y:hidden;"]),O=e=>!Object(s.isEmpty)(e.join("")),I=r()(i.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-1fdewst-2"})([".euiBadge__text{white-space:pre-wrap !important;}"]),C=r.a.div.withConfig({displayName:"Query",componentId:"sc-1fdewst-3"})(["white-space:pre-wrap;"]),T=e=>{switch(e){case"eql":return b.g;case"saved_query":return b.t;case"esql":return b.k;default:return b.q}},M=({field:e,filters:t,filterManager:a,query:n,savedId:r,savedQueryName:o,indexPatterns:l,queryLabel:d})=>{let p=[];const m=!Object(s.isEmpty)(r)&&!Object(s.isEmpty)(o);return m&&(p=[...p,{title:c.a.createElement(c.a.Fragment,null,b.u," "),description:c.a.createElement(c.a.Fragment,null,o," ")}]),Object(s.isEmpty)(t)||(a.setFilters(t),p=[...p,{title:c.a.createElement(c.a.Fragment,null,m?b.s:b.m," "),description:c.a.createElement(i.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},a.getFilters().map(((t,a)=>c.a.createElement(J,{grow:!1,key:`${e}-filter-${a}`},c.a.createElement(I,{color:"hollow"},null!=l?c.a.createElement(u.FilterBadgeGroup,{filters:[t],dataViews:[l]}):c.a.createElement(i.EuiLoadingSpinner,{size:"m"}))))))}]),Object(s.isEmpty)(n)||(p=[...p,{title:c.a.createElement(c.a.Fragment,null,m?b.t:null!=d?d:b.q),description:c.a.createElement(C,null,n)}]),p},_=e=>{let t=[];return Object(s.isEmpty)(e.eventCategoryField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,b.f),description:c.a.createElement(c.a.Fragment,null,e.eventCategoryField)}]),Object(s.isEmpty)(e.tiebreakerField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,b.h),description:c.a.createElement(c.a.Fragment,null,e.tiebreakerField)}]),Object(s.isEmpty)(e.timestampField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,b.i),description:c.a.createElement(c.a.Fragment,null,e.timestampField)}]),t},N=({threat:e,label:t})=>e.length>0?[{title:t,description:c.a.createElement(k.a,{threat:e})}]:[],D=(e,t,a)=>O(a)?[{title:e,description:c.a.createElement(i.EuiText,{size:"s"},c.a.createElement("ul",null,a.map((e=>Object(s.isEmpty)(e)?null:c.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[],A=(e,t)=>{if(Object(s.isEmpty)(t))return[];const a=c.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(s.isEmpty)(t)?null:c.a.createElement(i.EuiFlexItem,{grow:!1,key:`${e}-${t}`},c.a.createElement(I,{"data-test-subj":"customHighlightedFieldsStringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:e,description:a}]},F=(e,t,a)=>O(a)?[{title:e,description:c.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},a.map((e=>Object(s.isEmpty)(e)?null:c.a.createElement(i.EuiFlexItem,{grow:!1,key:`${t}-${e}`},c.a.createElement(I,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[],q=r()(i.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-1fdewst-4"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),L=r()(i.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-1fdewst-5"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),R=e=>[{title:g.a,description:c.a.createElement(h.a,{value:e.value})},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?g.d:"",description:c.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},c.a.createElement(q,null,c.a.createElement(i.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},c.a.createElement(c.a.Fragment,null,`${e.field}:`))),c.a.createElement(L,null,c.a.createElement(i.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(E.a)(e.value))),c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(i.EuiIcon,{type:"sortRight"})),c.a.createElement(i.EuiFlexItem,null,c.a.createElement(h.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]],P=e=>[{title:f.b,description:e.value},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?f.e:"",description:c.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},c.a.createElement(q,null,c.a.createElement(i.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},c.a.createElement(c.a.Fragment,null,e.field))),c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(i.EuiIcon,{type:"sortRight"})),c.a.createElement(i.EuiFlexItem,null,o.a))}))):[]],z=r()(i.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-1fdewst-6"})(["word-break:break-word;"]),B=(e,t)=>O(t)?[{title:e,description:c.a.createElement(i.EuiText,{size:"s"},c.a.createElement("ul",null,t.filter((e=>!Object(s.isEmpty)(e))).map(((e,t)=>c.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},c.a.createElement(z,{href:e,external:!0,target:"_blank"},e))))))}]:[],$=(e,t)=>""!==t.trim()?[{title:e,description:c.a.createElement(S,null,c.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],G=(e,t)=>{switch(t){case"machine_learning":return[{title:e,description:b.o}];case"query":case"saved_query":return[{title:e,description:b.r}];case"threshold":return[{title:e,description:b.z}];case"eql":return[{title:e,description:b.j}];case"threat_match":return[{title:e,description:b.v}];case"new_terms":return[{title:e,description:b.p}];case"esql":return[{title:e,description:b.l}];default:return Object(y.a)(t)}},U=(e,t)=>[{title:e,description:c.a.createElement(c.a.Fragment,null,Object(s.isEmpty)(t.field[0])?`${b.y} >= ${t.value}`:`${b.x} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}],V=(e,t)=>[{title:e,description:t.reduce(((e,t,a,{length:n})=>{const r=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${m.d} ${t.value}`:0===a?`(${t.field} ${m.d} ${t.value})`:`${e} ${m.a} (${t.field} ${m.d} ${t.value})`),"");return 1===n?`${r}`:0===a?`(${r})`:`${e} ${m.e} (${r})`}),"")}],H=r()(i.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-1fdewst-7"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),W=(e,t)=>Object(s.isEmpty)(t)?[]:[{title:e,description:c.a.createElement(i.EuiFlexGrid,{gutterSize:"s"},t.map(((e,a)=>c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(x.a,{"data-test-subj":"field-type-icon",type:e.type})),c.a.createElement(i.EuiFlexItem,{grow:!1},c.a.createElement(H,{grow:!1,size:"s"},` ${e.name}${a+1!==t.length?", ":""}`)))))))}],Y=(e=b.n,t,a)=>{if(Object(s.isEmpty)(t))return[];const n=c.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(s.isEmpty)(t)?null:c.a.createElement(i.EuiFlexItem,{grow:!1,key:`${e}-${t}`},c.a.createElement(I,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:c.a.createElement(w.a,{label:e,ruleType:a}),description:n}]},Z=(e,t,a,n)=>{const r=a===v.b.PerTimePeriod?`${t.value}${t.unit}`:b.b;return[{title:c.a.createElement(w.a,{label:e,ruleType:n}),description:r}]},K=(e,t,a)=>{if(Object(s.isEmpty)(t))return[];const n=t===p.a.suppress?b.c:b.a;return[{title:c.a.createElement(w.a,{label:e,ruleType:a}),description:n}]},Q=(e,t)=>""!==t.trim()?[{title:e,description:c.a.createElement(j,null,c.a.createElement("div",{"data-test-subj":"setupDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],X=(e,t)=>[{title:e,description:c.a.createElement(d.a,{interval:t})}];var J=r()(i.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1fdewst-8"})({width:"100%"})},1223:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"g",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),i=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),o=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),s=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),l=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),c=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),d=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."})},1224:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return d}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),i=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),o=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),s=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),l=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),c=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),d=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."})},1225:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),r=a(149),i=a(333),o=a(479),s=a(123),l=a(187),c=a(1105);const u=({eventIds:e,currentStatus:t,query:a,setEventsLoading:u,showAlertStatusActions:d=!0,setEventsDeleted:p,onUpdateSuccess:m,onUpdateFailure:y,customBulkActions:g})=>{const{addSuccess:f,addError:b,addWarning:h}=Object(s.a)(),{startTransaction:v}=Object(l.b)(),E=Object(n.useCallback)(((e,t,a)=>{if(t>0)h({title:i.x(t),text:i.y(e,t)});else{let t;switch(a){case"closed":t=i.p(e);break;case"open":t=i.r(e);break;case"acknowledged":t=i.b(e)}f({title:t})}m&&m(e,t,a)}),[f,h,m]),x=Object(n.useCallback)(((e,t)=>{let a;switch(e){case"closed":a=i.o;break;case"open":a=i.q;break;case"acknowledged":a=i.a}b(t.message,{title:a}),y&&y(e,t)}),[b,y]),k=Object(n.useCallback)((async t=>{a?v({name:c.a.BULK_QUERY_STATUS_UPDATE}):e.length>1?v({name:c.a.BULK_STATUS_UPDATE}):v({name:c.a.STATUS_UPDATE});try{var n,r;u({eventIds:e,isLoading:!0});const s=await Object(o.a)({status:t,query:a&&JSON.parse(a),signalIds:e});if(p({eventIds:e,isDeleted:!0}),s.version_conflicts&&1===e.length)throw new Error(i.l);E(null!==(n=s.updated)&&void 0!==n?n:0,null!==(r=s.version_conflicts)&&void 0!==r?r:0,t)}catch(e){x(t,e)}finally{u({eventIds:e,isLoading:!1})}}),[u,e,a,p,E,x,v]);return Object(n.useMemo)((()=>{const n=[];d&&(t!==r.d&&n.push({key:"open","data-test-subj":"open-alert-status",onClick:()=>k(r.d),name:i.m}),t!==r.b&&n.push({key:"acknowledge","data-test-subj":"acknowledged-alert-status",onClick:()=>k(r.b),name:i.j}),t!==r.c&&n.push({key:"close","data-test-subj":"close-alert-status",onClick:()=>k(r.c),name:i.k}));const o=g?g.reduce(((t,n)=>{const r=!(!a||!n.disableOnQuery);return t.push({key:n.key,disabled:r,"data-test-subj":n["data-test-subj"],toolTipContent:r?n.disabledLabel:null,onClick:()=>n.onClick(e),name:n.label}),t}),[]):[];return[...n,...o]}),[t,g,e,k,a,d])}},1226:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(2),r=a(661);const i=["kibana.alert.workflow_assignee_ids","kibana.alert.workflow_user"],o=({alerts:e,columns:t})=>{const a=Object(n.useMemo)((()=>{const a=new Set;return e.forEach((e=>{i.forEach((n=>{if(null!=t.find((e=>e.id===n))){const t=e[n];null==t||t.forEach((e=>a.add(e)))}}))})),a}),[e,t]),o=Object(r.a)({uids:a});return Object(n.useMemo)((()=>({profiles:o.data,isLoading:o.isLoading})),[o.data,o.isLoading])}},1227:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.closeEventDetailsLabel",{defaultMessage:"close"}),i=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.placeholder",{defaultMessage:"Select an event to show event details"}),o=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.eventTitleLabel",{defaultMessage:"Event details"}),s=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.alertTitleLabel",{defaultMessage:"Alert details"}),l=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),c=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.technicalPreviewDescription",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),u=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.shareAlert",{defaultMessage:"Share alert"})},1228:function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(19),l=a(732),c=a(1229);const u=o()(s.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1sj6853-0"})(["line-height:inherit;"]),d=[{value:"low",inputDisplay:r.a.createElement(u,{color:c.c},l.j)},{value:"medium",inputDisplay:r.a.createElement(u,{color:c.d},l.k)},{value:"high",inputDisplay:r.a.createElement(u,{color:c.b},l.i)},{value:"critical",inputDisplay:r.a.createElement(u,{color:c.a},l.g)}],p={low:c.g,medium:c.h,high:c.f,critical:c.e}},1229:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d}));var n=a(49);const r=n.euiLightVars.euiColorVis0,i=n.euiLightVars.euiColorVis5,o=n.euiLightVars.euiColorVis7,s=n.euiLightVars.euiColorVis9,l=21,c=47,u=73,d=99},1230:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(159),i=a(118),o=a(353);const s=()=>{const e=Object(i.n)(),[t,a]=Object(n.useState)(!0),[s,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(null),d=Object(n.useRef)(null);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return d.current=async i=>{try{a(!0);const{references:e}=await Object(r.l)({lists:i,signal:n.signal}),o=e.reduce(((e,t)=>{const[[a,n]]=Object.entries(t);return e[a]=n,e}),{});t&&(a(!1),l(!1),u(o))}catch(n){t&&(l(!0),a(!1),e.addError(n,{title:o.d}))}},()=>{t=!1,n.abort()}}),[e]),[t,s,c,d.current]}},1231:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"j",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"i",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(4);const r=n.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),i=n.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),o=n.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),s=n.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),l=n.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),c=n.i18n.translate("autocomplete.invalidBinaryType",{defaultMessage:"Binary fields are currently unsupported"}),u=n.i18n.translate("autocomplete.fieldSpaceWarning",{defaultMessage:"Warning: Spaces at the start or end of this value aren't being displayed."}),d=(n.i18n.translate("autocomplete.listsTooltipWarning",{defaultMessage:"Lists that aren't able to be processed by this rule type will be disabled."}),n.i18n.translate("autocomplete.seeDocumentation",{defaultMessage:"See Documentation"}),n.i18n.translate("autocomplete.conflictIndicesWarning.title",{defaultMessage:"Mapping Conflict"})),p=n.i18n.translate("autocomplete.conflictIndicesWarning.description",{defaultMessage:"This field is defined as different types across the following indices or is unmapped. This can cause unexpected query results."}),m=(e,t)=>n.i18n.translate("autocomplete.conflictIndicesWarning.index.description",{defaultMessage:"{name} ({count} indices)",values:{count:t,name:e}});n.i18n.translate("autocomplete.showValueListModal",{defaultMessage:"Show value list"}),t.k={LOADING:r,SELECT_FIELD_FIRST:i,FIELD_REQUIRED_ERR:o,NUMBER_ERR:s,DATE_ERR:l,FIELD_SPACE_WARNING:u,BINARY_TYPE_NOT_SUPPORTED:c}},1232:function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"e",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"d",(function(){return h})),a.d(t,"f",(function(){return v})),a.d(t,"g",(function(){return E})),a.d(t,"c",(function(){return k}));var n=a(2),r=a.n(n),i=a(4),o=a(42),s=a(19),l=a(140),c=a(118),u=a(952),d=a(602),p=a(881),m=a(603),y=a(1233);const g=i.i18n.translate("xpack.securitySolution.eventFilters.aboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),f=i.i18n.translate("xpack.securitySolution.eventFilter.form.name.label",{defaultMessage:"Name"}),b=i.i18n.translate("xpack.securitySolution.eventFilter.form.description.placeholder",{defaultMessage:"Description"}),h=i.i18n.translate("xpack.securitySolution.eventFilter.form.name.error",{defaultMessage:"The name can't be empty"}),v=i.i18n.translate("xpack.securitySolution.eventFilter.form.os.label",{defaultMessage:"Select operating system"}),E=i.i18n.translate("xpack.securitySolution.eventFilter.form.rule.name",{defaultMessage:"Endpoint Event Filtering"}),x={pageTitle:i.i18n.translate("xpack.securitySolution.eventFilters.pageTitle",{defaultMessage:"Event Filters"}),pageAboutInfo:i.i18n.translate("xpack.securitySolution.eventFilters.pageAboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),pageAddButtonTitle:i.i18n.translate("xpack.securitySolution.eventFilters.pageAddButtonTitle",{defaultMessage:"Add event filter"}),getShowingCountLabel:e=>i.i18n.translate("xpack.securitySolution.eventFilters.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {event filter} other {event filters}}",values:{total:e}}),cardActionEditLabel:i.i18n.translate("xpack.securitySolution.eventFilters.cardActionEditLabel",{defaultMessage:"Edit event filter"}),cardActionDeleteLabel:i.i18n.translate("xpack.securitySolution.eventFilters.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),flyoutCreateTitle:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateTitle",{defaultMessage:"Add event filter"}),flyoutEditTitle:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditTitle",{defaultMessage:"Edit event filter"}),flyoutCreateSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add event filter"}),flyoutCreateSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),r.a.createElement(s.EuiLink,{target:"_blank",href:`${e.eventFilters}`},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsLink",defaultMessage:"Event filters documentation"}))),deleteActionSuccess:e=>i.i18n.translate("xpack.securitySolution.eventFilters.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from event filters list.',values:{itemName:e}}),emptyStateTitleNoEntries:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitleNoEntries",{defaultMessage:"There are no event filters to display."}),emptyStateTitle:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitle",{defaultMessage:"Add your first event filter"}),emptyStateInfo:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateInfo",{defaultMessage:"Add an event filter to exclude high volume or unwanted events from being written to Elasticsearch."}),emptyStatePrimaryButtonLabel:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStatePrimaryButtonLabel",{defaultMessage:"Add event filter"}),searchPlaceholderInfo:i.i18n.translate("xpack.securitySolution.eventFilters.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"})},k=Object(n.memo)((()=>{const{canWriteEventFilters:e}=Object(l.a)().endpointPrivileges,t=Object(c.i)(),a=d.a.getInstance(t);return r.a.createElement(u.a,{apiClient:a,ArtifactFormComponent:p.a,labels:x,"data-test-subj":"EventFiltersListPage",searchableFields:m.d,flyoutSize:"l",allowCardCreateAction:e,allowCardEditAction:e,allowCardDeleteAction:e,CardDecorator:y.a})}));k.displayName="EventFiltersList"},1233:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(42),c=a(126),u=a(122),d=a(259),p=a(846);const m=Object(i.memo)((({item:e,"data-test-subj":t,...a})=>{const n=Object(c.a)(t);return Object(u.a)("filterProcessDescendantsForEventFiltersEnabled")&&Object(d.g)(e)?o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiText,r()({},a,{"data-test-subj":n("processDescendantIndication")}),o.a.createElement("code",null,o.a.createElement("strong",null,o.a.createElement(l.FormattedMessage,{defaultMessage:"Filtering descendants of process",id:"xpack.securitySolution.eventFilters.filteringProcessDescendants"})," ",o.a.createElement(p.a,{indicateExtraEntry:!0,"data-test-subj":n("processDescendantIndicationTooltip")})))),o.a.createElement(s.EuiSpacer,{size:"m"})):o.a.createElement(o.a.Fragment,null)}));m.displayName="EventFiltersProcessDescendantIndicator"},1234:function(e,t,a){"use strict";a.r(t),a.d(t,"updateNetworkTable",(function(){return i})),a.d(t,"setNetworkDetailsTablesActivePageToZero",(function(){return o})),a.d(t,"setNetworkTablesActivePageToZero",(function(){return s})),a.d(t,"updateNetworkAnomaliesJobIdFilter",(function(){return l})),a.d(t,"updateNetworkAnomaliesInterval",(function(){return c}));var n=a(22);const r=a.n(n)()("x-pack/security_solution/local/network"),i=r("UPDATE_NETWORK_TABLE"),o=r("SET_IP_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),s=r("SET_NETWORK_TABLES_ACTIVE_PAGE_TO_ZERO"),l=r("UPDATE_NETWORK_ANOMALIES_JOB_ID_FILTER"),c=r("UPDATE_NETWORK_ANOMALIES_INTERVAL")},1242:function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"a",(function(){return m}));var n=a(19),r=a(41),i=a.n(r);const o=i.a.div.withConfig({displayName:"TabHeaderContainer",componentId:"sc-1jac2cy-0"})(["width:100%;"]);o.displayName="TimelineHeaderContainer";const s=i()(n.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-1jac2cy-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;padding:0;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0 0 0;`)),l=i()(n.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1jac2cy-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),c=i()(n.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-1jac2cy-3"})(["background:none;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0;`)),u=i()(n.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1jac2cy-4"})(["margin:0;width:100%;overflow:hidden;"]),d=i()(n.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1jac2cy-5"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`));i()(n.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-1jac2cy-6"})(["align-items:flex-end;"]).displayName="SourcererFlex";const p=i.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-1jac2cy-7"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));p.displayName="VerticalRule";const m=i()(n.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-1jac2cy-8"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS))},1245:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(19),r=a(2),i=a.n(r),o=a(293),s=a(748),l=a(5),c=a(118),u=a(333),d=a(7);const p=(e,t)=>e.checked?t.checked&&e.checked<=t.checked?1:-1:t.checked?1:0,m=(e,t)=>{const a=Object(d.intersection)(...e),n=Object(d.union)(...e);return Object(d.union)(n,t).map((e=>{let t={checked:void 0,"data-test-subj":"unselected-alert-tag"};return a.includes(e)?t={checked:"on","data-test-subj":"selected-alert-tag"}:n.includes(e)&&(t={checked:"mixed","data-test-subj":"mixed-alert-tag"}),{label:e,...t}})).sort(p)},y={selectableAlertTags:[],tagsToAdd:new Set,tagsToRemove:new Set},g=({alertItems:e,refresh:t,refetchQuery:a,setIsLoading:o,clearSelection:d,closePopoverMenu:p,onSubmit:g})=>{const[f]=Object(c.o)(l.E),b=Object(r.useMemo)((()=>e.map((e=>{var t,a;return null!==(t=null===(a=e.data.find((e=>e.field===s.H)))||void 0===a?void 0:a.value)&&void 0!==t?t:[]}))),[e]),[{selectableAlertTags:h,tagsToAdd:v,tagsToRemove:E},x]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"addAlertTag":{const{value:a}=t;return e.tagsToAdd.add(a),e.tagsToRemove.delete(a),e}case"removeAlertTag":{const{value:a}=t;return e.tagsToRemove.add(a),e.tagsToAdd.delete(a),e}case"setSelectableAlertTags":{const{value:a}=t;return{...e,selectableAlertTags:a}}default:return e}}),y),k=Object(r.useCallback)((e=>{x({type:"addAlertTag",value:e})}),[x]),w=Object(r.useCallback)((e=>{x({type:"removeAlertTag",value:e})}),[x]),S=Object(r.useCallback)((e=>{x({type:"setSelectableAlertTags",value:e})}),[x]),j=Object(r.useCallback)((async()=>{if(0===v.size&&0===E.size)return void p();const n=Array.from(v),r=Array.from(E),i=e.map((e=>e._id)),s={tags_to_add:n,tags_to_remove:r};null!=g&&(p(),await g(s,i,(()=>{a&&a(),t&&t(),d&&d()}),o))}),[p,v,E,e,a,t,d,o,g]),O=Object(r.useCallback)(((e,t,a)=>{"on"===a.checked?k(a.label):a.checked||w(a.label),S(e)}),[k,w,S]);return Object(r.useEffect)((()=>{x({type:"setSelectableAlertTags",value:m(b,f)})}),[b,f]),i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSelectable,{searchable:!0,searchProps:{placeholder:u.i},"aria-label":u.i,options:h,onChange:O,emptyMessage:u.g,noMatchesMessage:u.h,"data-test-subj":"alert-tags-selectable-menu"},((e,t)=>i.a.createElement("div",null,i.a.createElement(n.EuiPopoverTitle,null,t),e))),i.a.createElement(n.EuiButton,{"data-test-subj":"alert-tags-update-button",fullWidth:!0,size:"s",onClick:j},u.d))},f=Object(r.memo)(g);var b=a(56),h=a(123);const v=({refetch:e})=>{const{hasIndexWrite:t}=Object(o.a)(),a=(()=>{const{http:e}=Object(b.useKibana)().services,{addSuccess:t,addError:a}=Object(h.a)(),n=Object(r.useRef)(null),i=Object(r.useCallback)(((e=0)=>t(u.A(e))),[t]),o=Object(r.useCallback)((e=>{a(e.message,{title:u.z})}),[a]);return Object(r.useEffect)((()=>{let e=!1;const t=new AbortController;return n.current=async(a,n,r,s)=>{try{s(!0);const o=await(async({tags:e,ids:t,signal:a})=>c.b.get().http.fetch(l.kb,{method:"POST",version:"2023-10-31",body:JSON.stringify({tags:e,ids:t}),signal:a}))({tags:a,ids:n,signal:t.signal});e||(r(),s(!1),i(o.updated))}catch(t){e||(s(!1),o(t))}},()=>{e=!0,t.abort()}}),[e,o,i]),n.current})(),s=Object(r.useCallback)((async(e,t,n,r)=>{a&&await a(e,t,n,r)}),[a]),d=Object(r.useMemo)((()=>t?[{key:"manage-alert-tags","data-test-subj":"alert-tags-context-menu-item",name:u.e,panel:1,label:u.e,disableOnQuery:!0}]:[]),[t]),p=Object(r.useMemo)((()=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(n.EuiFlexItem,{grow:!1},u.e),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiIconTip,{content:u.f,position:"right"})))),[]),m=Object(r.useCallback)((({alertItems:t,refresh:a,setIsBulkActionsLoading:n,clearSelection:r,closePopoverMenu:o})=>i.a.createElement(f,{alertItems:t,refresh:a,refetchQuery:e,setIsLoading:n,clearSelection:r,closePopoverMenu:o,onSubmit:s})),[s,e]),y=Object(r.useMemo)((()=>t?[{id:1,title:p,"data-test-subj":"alert-tags-context-menu-panel",renderContent:m}]:[]),[p,t,m]);return Object(r.useMemo)((()=>({alertTagsItems:d,alertTagsPanels:y})),[d,y])}},1247:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return E})),a.d(t,"b",(function(){return Z}));var n=a(19),r=a(41),i=a.n(r),o=a(2),s=a.n(o),l=a(342),c=a(922);const u=i()(n.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-p7dcu3-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow:hidden;padding:",";}}"],(({theme:e})=>`0 ${e.eui.euiSizeM} ${e.eui.euiSizeM}`)),d=({alertId:e,browserFields:t,detailsData:a,detailsEcsData:n,event:r,handleIsolationActionSuccess:i,handleOnEventClosed:o,hostName:d,isAlert:p,isDraggable:m,isReadOnly:y,isolateAction:g,isHostIsolationPanelOpen:f,isIsolateActionSuccessBannerVisible:b,loading:h,rawEventData:v,showAlertDetails:E,scopeId:x})=>s.a.createElement(u,null,b&&s.a.createElement(l.d,{hostName:d,alertId:e,isolateAction:g}),f?s.a.createElement(l.f,{details:a,cancelCallback:E,successCallback:i,isolateAction:g}):s.a.createElement(c.a,{browserFields:t,detailsData:a,detailsEcsData:n,event:r,isAlert:p,isDraggable:m,loading:h,rawEventData:v,scopeId:x,timelineTabType:"flyout",handleOnEventClosed:o,isReadOnly:y})),p=s.a.memo(d);a(43);var m=a(1227);const y=({showAlertDetails:e,showExperimentalBadge:t,isolateAction:a})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiButtonEmpty,{iconType:"arrowLeft",iconSide:"left",flush:"left",onClick:e},s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement("p",null,m.a))),s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiTitle,null,s.a.createElement("h2",null,"isolateHost"===a?l.g:l.h))),s.a.createElement(n.EuiFlexItem,{grow:!1},t&&s.a.createElement(f,{label:m.f,size:"s",tooltipContent:m.g})))),g=s.a.memo(y);var f=i()(n.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-16ihl46-0"})(["display:inline-flex;"]),b=a(174);const h=({eventId:e,eventIndex:t,isAlert:a,isHostIsolationPanelOpen:n,isolateAction:r,loading:i,promptContextId:l,ruleName:u,showAlertDetails:d,timestamp:p,scopeId:m,refetchFlyoutData:y,getFieldsData:f})=>{const h=Object(o.useMemo)((()=>{var e;return!(!a||null===(e=f(b.b.sentinel_one))||void 0===e||!e.length)}),[f,a]);return s.a.createElement(s.a.Fragment,null,n?s.a.createElement(g,{isolateAction:r,showAlertDetails:d,showExperimentalBadge:h}):s.a.createElement(c.b,{eventId:e,eventIndex:t,isAlert:a,loading:i,promptContextId:l,ruleName:u,timestamp:p,scopeId:m,refetchFlyoutData:y,getFieldsData:f}))},v=({eventId:e,eventIndex:t,isAlert:a,isHostIsolationPanelOpen:r,isolateAction:i,loading:o,promptContextId:l,ruleName:c,showAlertDetails:u,timestamp:d,scopeId:p,refetchFlyoutData:m,getFieldsData:y})=>s.a.createElement(n.EuiFlyoutHeader,{hasBorder:r},s.a.createElement(h,{eventId:e,eventIndex:t,isAlert:a,isHostIsolationPanelOpen:r,isolateAction:i,loading:o,promptContextId:l,ruleName:c,showAlertDetails:u,timestamp:d,scopeId:p,refetchFlyoutData:m,getFieldsData:y})),E=s.a.memo(v);var x=a(119),k=a.n(x),w=a(44),S=a(519),j=a(131),O=a(1630),I=a(305),C=a(170),T=a(1305),M=a(928),_=a(667),N=a(377),D=a(929),A=a(502),F=a(140),q=a(973),L=a(118),R=a(930),P=a(931),z=a(932);const B=s.a.memo((({detailsData:e,ecsData:t,handleOnEventClosed:a,isHostIsolationPanelOpen:r,loadingEventDetails:i,onAddEventFilterClick:c,onAddExceptionTypeClick:u,onAddIsolationStatusClick:d,refetch:p,refetchFlyoutData:m,onOsqueryClick:y,scopeId:g})=>{var f;const{loading:b,canWriteEventFilters:h}=Object(F.a)().endpointPrivileges,v=Object(o.useMemo)((()=>!b&&h),[h,b]),{osquery:E}=Object(L.j)().services,[x,k]=Object(o.useState)(!1),w=Object(o.useMemo)((()=>[{category:"kibana",field:"kibana.alert.rule.uuid",name:"ruleId"},{category:"kibana",field:"kibana.alert.rule.name",name:"ruleName"},{category:"kibana",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"event",field:"event.kind",name:"eventKind"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,a)=>({...t,[a.name]:Object(S.a)({category:a.category,field:a.field},e)})),{})),[e]),B="event"===w.eventKind,$=Object(o.useMemo)((()=>{var e,a;return null==t||null===(e=t.agent)||void 0===e||null===(a=e.type)||void 0===a?void 0:a.includes("endpoint")}),[t]),G=Object(o.useMemo)((()=>B&&$),[B,$]),U=Object(o.useMemo)((()=>Object(S.a)({category:"agent",field:"agent.id"},e)),[e]),V=Object(o.useCallback)((()=>{k(!x)}),[x]),H=Object(o.useCallback)((()=>{k(!1)}),[]),W=Object(o.useCallback)((()=>{a(),k(!1)}),[a]),Y=Object(o.useCallback)((e=>{d(e),k(!1)}),[d]),Z=Object(l.i)({closePopover:H,detailsData:e,onAddIsolationStatusClick:Y,isHostIsolationPanelOpen:r}),K=Object(A.e)(e,H),Q=Object(o.useCallback)((e=>{u(e),k(!1)}),[u]),{exceptionActionItems:X}=Object(M.a)({isEndpointAlert:Boolean($),onAddExceptionTypeClick:Q}),J=Object(o.useCallback)((()=>{c(),k(!1)}),[c]),{eventFilterActionItems:ee}=Object(D.a)({onAddEventFilterClick:J}),te=Object(o.useCallback)((()=>{H()}),[H]),{actionItems:ae}=Object(_.a)({alertStatus:w.alertStatus,closePopover:W,eventId:w.eventId,refetch:p,scopeId:g}),{alertTagsItems:ne,alertTagsPanels:re}=Object(P.a)({closePopover:H,ecsRowData:null!=t?t:{_id:w.eventId},refetch:p}),ie=Object(o.useCallback)((()=>{p&&p(),m&&m()}),[p,m]),{alertAssigneesItems:oe,alertAssigneesPanels:se}=Object(z.a)({closePopover:H,ecsRowData:null!=t?t:{_id:w.eventId},refetch:ie}),{investigateInTimelineActionItems:le}=Object(N.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:H}),ce=null==E?void 0:E.isOsqueryAvailable({agentId:U}),ue=Object(o.useCallback)((()=>{y(U),k(!1)}),[y,k,U]),de=Object(o.useMemo)((()=>Object(R.a)({handleClick:ue})),[ue]),pe=Object(o.useMemo)((()=>!B&&w.ruleId?[...ae,...ne,...oe,...X]:G&&v?ee:[]),[ee,G,v,X,ae,B,w.ruleId,ne,oe]),me=[O.b.alertsOnAlertsPage,O.b.alertsOnRuleDetailsPage].includes(g),{addToCaseActionItems:ye,handleAddToNewCaseClick:ge}=Object(q.a)({ecsData:t,nonEcsData:null!==(f=null==e?void 0:e.map((e=>({field:e.field,value:e.values}))))&&void 0!==f?f:[],onMenuItemClick:te,onSuccess:m,isActiveTimelines:Object(j.isActiveTimeline)(g),isInDetections:me,refetch:p}),fe=Object(o.useMemo)((()=>[...ye,...pe,...Z,...K,...ce?[de]:[],...le]),[ye,pe,Z,K,ce,de,le]),be=[{id:0,items:fe},...re,...se],he=Object(o.useMemo)((()=>s.a.createElement(I.a,{onClick:ge,step:C.a.addAlertToCase,tourId:C.b.alertsCases},s.a.createElement(n.EuiButton,{"data-test-subj":"take-action-dropdown-btn",fill:!0,iconSide:"right",iconType:"arrowDown",onClick:V},T.d))),[ge,V]);return fe.length&&!i&&t?s.a.createElement(n.EuiPopover,{id:"AlertTakeActionPanel",button:he,isOpen:x,closePopover:H,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},s.a.createElement(n.EuiContextMenu,{size:"s",initialPanelId:0,panels:be,"data-test-subj":"takeActionPanelMenu"})):null}));var $=a(933),G=a(969),U=a(962),V=a(936),H=a(571),W=a(775);const Y=({detailsData:e,detailsEcsData:t,handleOnEventClosed:a,isHostIsolationPanelOpen:r,isReadOnly:i,loadingEventDetails:l,onAddIsolationStatusClick:c,scopeId:u,refetchFlyoutData:d})=>{var p;const{euiTheme:m}=Object(n.useEuiTheme)(),y=Object(o.useMemo)((()=>({style:`z-index: ${m.levels.flyout+3}`})),[m]),g=null!=t&&null!==(p=t.kibana)&&void 0!==p&&p.alert?null==t?void 0:t._id:null,f=Object(o.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=Object(w.find)({category:"signal",field:"signal.rule.index"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:null===(n=Object(w.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},e))||void 0===n?void 0:n.values}),[e]),b=Object(o.useMemo)((()=>Array.isArray(f)?f:void 0),[f]),h=Object(o.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=Object(w.find)({category:"signal",field:"signal.rule.data_view_id"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:null===(n=Object(w.find)({category:"kibana",field:"kibana.alert.rule.parameters.data_view_id"},e))||void 0===n?void 0:n.values}),[e]),v=Object(o.useMemo)((()=>Array.isArray(h)?h[0]:void 0),[h]),E=Object(o.useMemo)((()=>[{category:"signal",field:"signal.rule.id",name:"ruleId"},{category:"signal",field:"signal.rule.rule_id",name:"ruleRuleId"},{category:"signal",field:"signal.rule.name",name:"ruleName"},{category:"signal",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,a)=>({...t,[a.name]:Object(S.a)({category:a.category,field:a.field},e)})),{})),[e]),{refetch:x}=Object(W.a)({scopeId:u}),{exceptionFlyoutType:O,openAddExceptionFlyout:I,onAddExceptionTypeClick:C,onAddExceptionCancel:T,onAddExceptionConfirm:M}=Object($.a)({refetch:x,isActiveTimelines:Object(j.isActiveTimeline)(u)}),{closeAddEventFilterModal:_,isAddEventFilterModalOpen:N,onAddEventFilterClick:D}=Object(V.a)(),[A,F]=Object(o.useState)(null),q=Object(o.useCallback)((()=>{F(null)}),[F]);return i?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiFlyoutFooter,{className:"side-panel-flyout-footer","data-test-subj":"side-panel-flyout-footer"},s.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(n.EuiFlexItem,{grow:!1},t&&s.a.createElement(B,{detailsData:e,ecsData:t,handleOnEventClosed:a,isHostIsolationPanelOpen:r,loadingEventDetails:l,onAddEventFilterClick:D,onAddExceptionTypeClick:C,onAddIsolationStatusClick:c,refetchFlyoutData:d,refetch:x,scopeId:u,onOsqueryClick:F})))),I&&null!=E.ruleId&&null!=E.ruleRuleId&&null!=E.eventId&&s.a.createElement(G.a,k()({},E,{ruleIndices:b,ruleDataViewId:v,exceptionListType:O,onCancel:T,onConfirm:M})),N&&null!=t&&s.a.createElement(U.a,{data:t,onCancel:_,maskProps:y}),A&&null!=t&&s.a.createElement(H.a,{agentId:A,defaultValues:g?{alertIds:[g]}:void 0,onClose:q,ecsData:t}))},Z=s.a.memo(Y)},1248:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(44),r=a(2),i=a.n(r),o=a(19),s=a(4),l=a(42),c=a(827),u=a(1293),d=a(43);const p="null",m=({selectedOptions:e,defaultOptions:t,options:a,onChange:n,onSearchChange:m,isLoading:f=!1,singleSelection:b=!1,limit:h,height:v,loadingMessage:E,noMatchesMessage:x,emptyMessage:k,errorMessage:w,searchPlaceholder:S,searchInputId:j,selectedStatusMessage:O,limitReachedMessage:I,nullOptionLabel:C,nullOptionProps:T,defaultOptionsLabel:M,clearButtonLabel:_,...N})=>{const[D,A]=Object(r.useState)([]),[F,q]=Object(r.useState)(""),L=e?e.length:0,R=!!h&&L>=h,P=()=>{a||A((a=>{const n=[...a],r=e?e.filter((e=>!n.find((t=>g(t,e))))).map((e=>y(e,C,T))):[],i=t?t.filter((e=>!n.find((t=>g(t,e)))&&!r.find((t=>g(t,e))))).map((e=>y(e,C,T))):[];if(i.length){const e=(e=>{let t=e.findIndex((e=>e.isGroupLabel));return-1===t&&(t=e.push({label:null!=M?M:s.i18n.translate("userProfileComponents.userProfilesSelectable.defaultOptionsLabel",{defaultMessage:"Suggested"}),isGroupLabel:!0})-1),t})(n);n.splice(e,0,...r),n.push(...i)}else n.push(...r);return n}))};return Object(r.useEffect)((()=>{a?A(a.map((e=>y(e,C,T)))):(A([]),P())}),[a]),Object(r.useEffect)(P,[t,e]),Object(r.useEffect)((()=>{A((t=>t.map((t=>{if(e){var a;const n=void 0===e.find((e=>g(t,e)))?void 0:"on",r=!n&&R;return{...t,checked:n,disabled:r,prepend:t.data?Object(d.jsx)(u.a,{user:t.data.user,avatar:null===(a=t.data.data)||void 0===a?void 0:a.avatar,size:"s",isDisabled:r}):void 0}}return{...t,checked:void 0,disabled:void 0}}))))}),[a,t,e]),Object(d.jsx)(o.EuiSelectable,{"data-test-subj":N["data-test-subj"],options:D,onChange:t=>{if(!n)return;const a=t.filter((t=>!(t.isGroupLabel||"on"!==t.checked||e&&void 0!==e.find((e=>g(t,e)))))).map((e=>e.key===p?null:e.data));e&&!b&&e.forEach((e=>{const n=t.find((t=>g(t,e)));void 0!==n&&"on"!==n.checked||(n&&n.key===p?a.unshift(e):a.push(e))})),n(a)},style:{maxHeight:v},singleSelection:b,searchable:!0,searchProps:{placeholder:null!=S?S:s.i18n.translate("userProfileComponents.userProfilesSelectable.searchPlaceholder",{defaultMessage:"Search"}),value:F,onChange:e=>{q(e),null==m||m(e)},isLoading:f,isClearable:!f,id:j},isPreFiltered:!0,listProps:{onFocusBadge:!1,rowHeight:48},loadingMessage:E,noMatchesMessage:x,emptyMessage:k,errorMessage:w,renderOption:(e,t)=>{if(e.user){const a=Object(c.e)(e.user);return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)("div",{className:"eui-textTruncate"},Object(d.jsx)(o.EuiHighlight,{search:t},a)),e.user.email&&e.user.email!==a?Object(d.jsx)(o.EuiText,{size:"xs",color:e.disabled?"disabled":"subdued",className:"eui-textTruncate"},t?Object(d.jsx)(o.EuiHighlight,{search:t},e.user.email):e.user.email):void 0)}return Object(d.jsx)(o.EuiHighlight,{search:t},e.label)}},((e,t)=>Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.EuiPanel,{hasShadow:!1,paddingSize:"s"},t,b?void 0:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(o.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"s",responsive:!1},Object(d.jsx)(o.EuiFlexItem,{grow:!1},Object(d.jsx)(o.EuiText,{size:"xs",color:"subdued"},O?O(L):Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.selectedStatusMessage",defaultMessage:"{count, plural, one {# user selected} other {# users selected}}",values:{count:L}}))),Object(d.jsx)(o.EuiFlexItem,{grow:!1},L?Object(d.jsx)(o.EuiButtonEmpty,{size:"xs",flush:"right",onClick:()=>null==n?void 0:n([]),style:{height:"1rem"}},null!=_?_:Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.clearButtonLabel",defaultMessage:"Remove all users"})):void 0)))),h&&L>=h?Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.EuiHorizontalRule,{margin:"none"}),Object(d.jsx)(o.EuiCallOut,{title:I?I(h):Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.limitReachedMessage",defaultMessage:"You've selected the maximum of {count, plural, one {# user} other {# users}}",values:{count:h}}),color:"warning",size:"s"})):void 0,Object(d.jsx)(o.EuiHorizontalRule,{margin:"none"}),e)))};function y(e,t,a){return e?{key:e.uid,label:Object(c.d)(e.user),data:e,"data-test-subj":`userProfileSelectableOption-${e.user.username}`}:{key:p,label:null!=t?t:s.i18n.translate("userProfileComponents.userProfilesSelectable.nullOptionLabel",{defaultMessage:"No users"}),"data-test-subj":"userProfileSelectableOption-null",...a}}function g(e,t){return e.key===(t?t.uid:p)}var f=a(7),b=a(47),h=a(483),v=a(118),E=a(123),x=a(824),k=a(405),w=a(5);var S=a(661),j=a(825),O=a(826);const I=Object(r.memo)((({searchInputId:e,assignedUserIds:t,showUnassignedOption:a,onSelectionChange:o})=>{const{data:s}=(()=>{const{security:e}=Object(v.j)().services,{addError:t}=Object(E.a)();return Object(b.useQuery)(["useGetCurrentUserProfile"],(async()=>(async({security:e})=>e.userProfiles.getCurrent({dataPath:"avatar"}))({security:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:h.a})}})})(),l=Object(r.useMemo)((()=>new Set(Object(j.b)(t))),[t]),{isLoading:c,data:u}=Object(S.a)({uids:l}),[d,p]=Object(r.useState)(""),{isLoading:y,data:g}=(({searchTerm:e})=>{const{addError:t}=Object(E.a)();return Object(b.useQuery)(["useSuggestUsers",e],(async()=>(async({searchTerm:e})=>(async({searchTerm:e})=>v.b.get().http.fetch(w.jb,{method:"GET",version:"1",query:{searchTerm:e}}))({searchTerm:e}))({searchTerm:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:h.c})}})})({searchTerm:d}),I=Object(r.useMemo)((()=>{var e;const t=null!==(e=Object(j.a)(s,g))&&void 0!==e?e:[];return a&&Object(f.isEmpty)(d)?[k.b,...t]:t}),[s,d,a,g]),[C,T]=Object(r.useState)([]);Object(r.useEffect)((()=>{if(c||!u)return;const e=void 0!==t.find((e=>e===k.b))?[k.b,...u]:u;T(e)}),[t,u,c]);const M=Object(r.useCallback)((e=>{Object(n.isEqual)(e,C)||(T(e),null==o||o(e.map((e=>{var t;return null!==(t=null==e?void 0:e.uid)&&void 0!==t?t:k.b}))))}),[o,C]),_=Object(r.useCallback)((e=>x.e(e)),[]),N=c||y;return i.a.createElement("div",{"data-test-subj":O.c},i.a.createElement(m,{searchInputId:e,onSearchChange:e=>{p(e)},onChange:M,selectedStatusMessage:_,options:I,selectedOptions:C,isLoading:N,height:"full",singleSelection:!1,searchPlaceholder:x.d,clearButtonLabel:x.b,nullOptionLabel:x.c}))}));I.displayName="AssigneesSelectable"},1252:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(7),r=a(2),i=a.n(r),o=a(19),s=a(748),l=a(16),c=a(293),u=a(405),d=a(923);const p=({alertItems:e,refresh:t,setIsLoading:a,clearSelection:o,closePopoverMenu:l,onSubmit:c})=>{const u=Object(r.useMemo)((()=>e.map((e=>e._id))),[e]),p=Object(r.useMemo)((()=>Object(n.intersection)(...e.map((e=>{var t,a;return null!==(t=null===(a=e.data.find((e=>e.field===s.F)))||void 0===a?void 0:a.value)&&void 0!==t?t:[]})))),[e]),m=Object(r.useCallback)((()=>{t&&t(),o&&o()}),[o,t]),y=Object(r.useCallback)((async e=>{l(),c&&(l(),await c(e,u,m,a))}),[u,l,c,m,a]);return i.a.createElement("div",{"data-test-subj":"alert-assignees-selectable-menu"},i.a.createElement(d.a,{assignedUserIds:p,onApply:y}))},m=Object(r.memo)(p);var y=a(333),g=a(964);const f=({onAssigneesUpdate:e})=>{const t=Object(l.b)().isPlatinumPlus(),{hasIndexWrite:a}=Object(c.a)(),d=Object(g.a)(),p=Object(r.useCallback)((async(e,t,a,n)=>{d&&await d(e,t,a,n)}),[d]),f=Object(r.useCallback)((()=>{null==e||e()}),[e]),b=Object(r.useCallback)((async(e,t,a)=>{const r=e.map((e=>e._id)),i=Object(n.union)(...e.map((e=>{var t,a;return null!==(t=null===(a=e.data.find((e=>e.field===s.F)))||void 0===a?void 0:a.value)&&void 0!==t?t:[]})));if(!i.length)return;const o={add:[],remove:i};d&&await d(o,r,f,a)}),[f,d]),h=Object(r.useMemo)((()=>a&&t?[{key:"manage-alert-assignees","data-test-subj":"alert-assignees-context-menu-item",name:y.c,panel:2,label:y.c,disableOnQuery:!0},{key:"remove-all-alert-assignees","data-test-subj":"remove-alert-assignees-menu-item",name:y.s,label:y.s,disableOnQuery:!0,onClick:b}]:[]),[a,t,b]),v=Object(r.useMemo)((()=>i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(o.EuiFlexItem,{grow:!1},y.c))),[]),E=Object(r.useCallback)((({alertItems:e,refresh:t,setIsBulkActionsLoading:a,clearSelection:n,closePopoverMenu:r})=>i.a.createElement(m,{alertItems:e,refresh:()=>{f(),null==t||t()},setIsLoading:a,clearSelection:n,closePopoverMenu:r,onSubmit:p})),[p,f]),x=Object(r.useMemo)((()=>a&&t?[{id:2,title:v,"data-test-subj":"alert-assignees-context-menu-panel",renderContent:E,width:u.a}]:[]),[v,a,t,E]);return Object(r.useMemo)((()=>({alertAssigneesItems:h,alertAssigneesPanels:x})),[h,x])}},1257:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a(2);var n=a(19),r=a(43),i=a(49);const o=Object(r.css)("border-bottom:1px solid ",i.euiThemeVars.euiColorLightShade,";",""),s=Object(r.css)("color:",i.euiThemeVars.euiColorPrimary,";flex-basis:content;",""),l=({dataTestSubj:e,linkedRules:t,securityLinkAnchorComponent:a,leftIcon:i=""})=>{if(!t.length||null===a)return null;const l=a;return t.map((a=>Object(r.jsx)(n.EuiContextMenuItem,{css:t.length>1?o:"","data-test-subj":`${e||""}ActionItem${a.id}`,key:a.id},Object(r.jsx)(n.EuiFlexGroup,{gutterSize:"s",css:s},i?Object(r.jsx)(n.EuiFlexItem,{"data-test-subj":`${e||""}LeftIcon`,grow:!1},Object(r.jsx)(n.EuiIcon,{type:i})):null,Object(r.jsx)(n.EuiFlexItem,{css:s},Object(r.jsx)(l,{external:!0,referenceName:a.name,referenceId:a.id}))))))}},1259:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(19),r=a(128),i=a(2),o=a.n(i);const s=o.a.memo((({hoverContent:e,anchorPosition:t="downCenter",children:a})=>{const[s,l]=Object(i.useState)(null!=e),[c,u]=Object(i.useState)(!1),[,d]=Object(i.useState)(void 0),p=Object(i.useRef)(null),m=Object(i.useCallback)((()=>{d((e=>{clearTimeout(e)})),u(!1)}),[]),y=Object(i.useCallback)((()=>{d(Number(setTimeout((()=>{document.body.classList.contains(r.c)||u(!0)}),100)))}),[d,u]),g=Object(i.useCallback)((()=>{m()}),[m]),f=Object(i.useCallback)((e=>{s&&"Escape"===e.key&&g()}),[s,g]);return Object(i.useEffect)((()=>{l(null!=e&&c)}),[e,c]),Object(i.useEffect)((()=>{var e;s&&(null==p||null===(e=p.current)||void 0===e||e.positionPopoverFluid())}),[e,s]),o.a.createElement("div",{onMouseLeave:g},o.a.createElement(n.EuiPopover,{ref:p,anchorPosition:t,button:o.a.createElement("div",{"data-test-subj":"HoverPopoverButton",onMouseEnter:y},a),closePopover:m,hasArrow:!1,isOpen:s,ownFocus:!1,panelPaddingSize:"none",panelStyle:{minInlineSize:"fit-content"},panelClassName:"HoverPopover__popover",repositionOnScroll:!0},s?o.a.createElement("div",{onKeyDown:f},e):null))}));s.displayName="HoverPopover"},1260:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(118),i=a(128),o=a(64);const s=({closePopover:e,draggableId:t,fieldName:a,keyboardHandlerRef:s,openPopover:l})=>{const{timelines:c}=Object(r.j)().services,u=c.getUseAddToTimeline(),{beginDrag:d,cancelDrag:p,dragToLocation:m,endDrag:y,hasDraggableLock:g}=u({draggableId:t,fieldName:a}),[f,b]=Object(n.useState)(null),h=Object(n.useCallback)((()=>{b((e=>e?(p(e),null):null))}),[p]),v=Object(n.useCallback)((a=>{const n=document.querySelector(`[data-rbd-drag-handle-draggable-id="${t}"]`);var r;n&&((g()||!g()&&" "===a.key)&&(a.preventDefault(),a.stopPropagation()),(({beginDrag:e,cancelDragActions:t,closePopover:a,draggableElement:n,dragActions:r,dragToLocation:s,endDrag:l,keyboardEvent:c,openPopover:u,setDragActions:d})=>{let p=null;switch(c.key){case" ":r?(l(r),d(null)):(null!=a&&a(),d(e()));break;case"Escape":t();break;case"Tab":(e=>{const t=e.querySelectorAll("a, button");t.forEach((e=>{e.setAttribute("tabindex","-1")})),setTimeout((()=>{t.forEach((e=>{e.setAttribute("tabindex","0")}))}),0)})(n);break;case"ArrowUp":p=n.getBoundingClientRect(),s({dragActions:r,position:{x:p.x,y:p.y-i.e}});break;case"ArrowDown":p=n.getBoundingClientRect(),s({dragActions:r,position:{x:p.x,y:p.y+i.e}});break;case"ArrowLeft":p=n.getBoundingClientRect(),s({dragActions:r,position:{x:p.x-i.e,y:p.y}});break;case"ArrowRight":p=n.getBoundingClientRect(),s({dragActions:r,position:{x:p.x+i.e,y:p.y}});break;case"Enter":Object(o.stopPropagationAndPreventDefault)(c),r||null==u||u()}})({beginDrag:d,cancelDragActions:h,closePopover:e,dragActions:f,draggableElement:n,dragToLocation:m,endDrag:y,keyboardEvent:a,openPopover:l,setDragActions:b}),null===(r=s.current)||void 0===r||r.focus())}),[d,h,e,f,t,m,y,g,s,l,b]);return Object(n.useMemo)((()=>({onBlur:h,onKeyDown:v})),[h,v])}},1261:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(41),c=a.n(l),u=a(42),d=a(50),p=a(126),m=a(182);const y=c.a.div.withConfig({displayName:"RootContainer",componentId:"sc-ptw6hp-0"})(["position:relative;padding-top:",";.body{min-height:",";&-content{position:relative;}}"],(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXXL)),g=Object(i.memo)((({"data-test-subj":e})=>o.a.createElement(s.EuiEmptyPrompt,{"data-test-subj":e,title:o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.endpoint.paginatedContent.noItemsFoundTitle",defaultMessage:"No items found"})})));g.displayName="DefaultNoItemsFound";const f=Object(i.memo)((({message:e,"data-test-subj":t})=>o.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiIcon,{type:"minusInCircle",color:"danger"})," ",e,o.a.createElement(s.EuiSpacer,{size:"m"}))));f.displayName="ErrorMessage";const b=Object(i.memo)((({items:e,ItemComponent:t,itemComponentProps:a,itemId:n,onChange:l,pagination:c,loading:u,noItemsMessage:b,error:h,contentClassName:v,"data-test-subj":E,"aria-label":x,className:k,CardDecorator:w,children:S})=>{const[j]=Object(i.useState)(new WeakMap),O=Object(p.a)(E),I=Object(i.useMemo)((()=>Math.ceil(((null==c?void 0:c.totalItemCount)||1)/((null==c?void 0:c.pageSize)||1))),[null==c?void 0:c.pageSize,null==c?void 0:c.totalItemCount]);Object(i.useEffect)((()=>{!u&&I>0&&I<((null==c?void 0:c.pageIndex)||0)+1&&l({pageIndex:I-1,pageSize:(null==c?void 0:c.pageSize)||0})}),[I,l,c,u]);const C=Object(i.useCallback)((e=>{if(null!=c&&c.pageIndex){var t,a;const n=Math.floor((null!==(t=null==c?void 0:c.pageIndex)&&void 0!==t?t:m.b)*(null!==(a=null==c?void 0:c.pageSize)&&void 0!==a?a:m.c)/e);l({pageSize:e,pageIndex:isNaN(n)?m.b:n})}else l({pageSize:e,pageIndex:m.b})}),[l,c]),T=Object(i.useCallback)((e=>{l({pageIndex:e,pageSize:(null==c?void 0:c.pageSize)||m.c})}),[l,null==c?void 0:c.pageSize]),M=Object(i.useMemo)((()=>{if(h)return h instanceof Error?o.a.createElement(f,{message:h.message,"data-test-subj":O("error")}):"string"==typeof h?o.a.createElement(f,{message:h,"data-test-subj":O("error")}):h;const i=t;return e.length?e.map((e=>{let t;return n?t=e[n]:j.has(e)?t=j.get(e):(t=Object(d.v4)(),j.set(e,t)),o.a.createElement(i,r()({},a(e),{key:t,Decorator:w}))})):u?void 0:b||o.a.createElement(g,{"data-test-subj":O("noResults")})}),[h,t,e,u,b,O,n,a,w,j]);return o.a.createElement(y,{"data-test-subj":E,"aria-label":x,className:k},u&&o.a.createElement(s.EuiProgress,{size:"xs",color:"primary",position:"absolute","data-test-subj":O("loader")}),o.a.createElement("div",{className:"body","data-test-subj":O("body")},o.a.createElement("div",{className:`body-content ${v}`},S||M)),c&&(S||e.length>0)&&o.a.createElement("div",{"data-test-subj":O("footer")},o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(s.EuiTablePagination,{activePage:c.pageIndex,itemsPerPage:c.pageSize,itemsPerPageOptions:c.pageSizeOptions,pageCount:I,showPerPageOptions:c.showPerPageOptions,onChangeItemsPerPage:C,onChangePage:T})))}));b.displayName="PaginatedContent"},1293:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(119),r=a.n(n),i=a(19),o=(a(2),a(827)),s=a(43);const l=({user:e,avatar:t,...a})=>{const{euiTheme:n}=Object(i.useEuiTheme)();if(!e)return Object(s.jsx)(i.EuiAvatar,r()({name:"",color:n.colors.lightestShade,initials:"?"},a));const l=Object(o.d)(e);return null!=t&&t.imageUrl?Object(s.jsx)(i.EuiAvatar,r()({name:l,imageUrl:t.imageUrl,color:"plain"},a)):Object(s.jsx)(i.EuiAvatar,r()({name:l,initials:Object(o.c)(e,t),initialsLength:o.a,color:Object(o.b)(e,t)},a))}},1294:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},1296:function(e,t,a){!function(e,t,a,n,r,i){"use strict";function o(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function s(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const l=Symbol("implicit");function c(){var e=new Map,t=[],a=[],n=l;function r(r){var i=r+"",o=e.get(i);if(!o){if(n!==l)return n;e.set(i,o=t.push(r))}return a[(o-1)%a.length]}return r.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const n of a){const a=n+"";e.has(a)||e.set(a,t.push(n))}return r},r.range=function(e){return arguments.length?(a=Array.from(e),r):a.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return c(t,a).unknown(n)},o.apply(r,arguments),r}function u(){var e,a,n=c().unknown(void 0),r=n.domain,i=n.range,s=0,l=1,d=!1,p=0,m=0,y=.5;function g(){var n=r().length,o=l<s,c=o?l:s,u=o?s:l;e=(u-c)/Math.max(1,n-p+2*m),d&&(e=Math.floor(e)),c+=(u-c-e*(n-p))*y,a=e*(1-p),d&&(c=Math.round(c),a=Math.round(a));var g=t.range(n).map((function(t){return c+e*t}));return i(o?g.reverse():g)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),g()):r()},n.range=function(e){return arguments.length?([s,l]=e,s=+s,l=+l,g()):[s,l]},n.rangeRound=function(e){return[s,l]=e,s=+s,l=+l,d=!0,g()},n.bandwidth=function(){return a},n.step=function(){return e},n.round=function(e){return arguments.length?(d=!!e,g()):d},n.padding=function(e){return arguments.length?(p=Math.min(1,m=+e),g()):p},n.paddingInner=function(e){return arguments.length?(p=Math.min(1,e),g()):p},n.paddingOuter=function(e){return arguments.length?(m=+e,g()):m},n.align=function(e){return arguments.length?(y=Math.max(0,Math.min(1,e)),g()):y},n.copy=function(){return u(r(),[s,l]).round(d).paddingInner(p).paddingOuter(m).align(y)},o.apply(g(),arguments)}function d(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return d(t())},e}function p(e){return+e}var m=[0,1];function y(e){return e}function g(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:(a=isNaN(t)?NaN:.5,function(){return a});var a}function f(e,t,a){var n=e[0],r=e[1],i=t[0],o=t[1];return r<n?(n=g(r,n),i=a(o,i)):(n=g(n,r),i=a(i,o)),function(e){return i(n(e))}}function b(e,a,n){var r=Math.min(e.length,a.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),a=a.slice().reverse());++s<r;)i[s]=g(e[s],e[s+1]),o[s]=n(a[s],a[s+1]);return function(a){var n=t.bisect(e,a,1,r)-1;return o[n](i[n](a))}}function h(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function v(){var e,t,n,r,i,o,s=m,l=m,c=a.interpolate,u=y;function d(){var e,t,a,n=Math.min(s.length,l.length);return u!==y&&(e=s[0],t=s[n-1],e>t&&(a=e,e=t,t=a),u=function(a){return Math.max(e,Math.min(t,a))}),r=n>2?b:f,i=o=null,g}function g(t){return null==t||isNaN(t=+t)?n:(i||(i=r(s.map(e),l,c)))(e(u(t)))}return g.invert=function(n){return u(t((o||(o=r(l,s.map(e),a.interpolateNumber)))(n)))},g.domain=function(e){return arguments.length?(s=Array.from(e,p),d()):s.slice()},g.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},g.rangeRound=function(e){return l=Array.from(e),c=a.interpolateRound,d()},g.clamp=function(e){return arguments.length?(u=!!e||y,d()):u!==y},g.interpolate=function(e){return arguments.length?(c=e,d()):c},g.unknown=function(e){return arguments.length?(n=e,g):n},function(a,n){return e=a,t=n,d()}}function E(){return v()(y,y)}function x(e,a,r,i){var o,s=t.tickStep(e,a,r);switch((i=n.formatSpecifier(null==i?",f":i)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(a));return null!=i.precision||isNaN(o=n.precisionPrefix(s,l))||(i.precision=o),n.formatPrefix(i,l);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=n.precisionRound(s,Math.max(Math.abs(e),Math.abs(a))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=n.precisionFixed(s))||(i.precision=o-2*("%"===i.type))}return n.format(i)}function k(e){var a=e.domain;return e.ticks=function(e){var n=a();return t.ticks(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,t){var n=a();return x(n[0],n[n.length-1],null==e?10:e,t)},e.nice=function(n){null==n&&(n=10);var r,i,o=a(),s=0,l=o.length-1,c=o[s],u=o[l],d=10;for(u<c&&(i=c,c=u,u=i,i=s,s=l,l=i);d-- >0;){if((i=t.tickIncrement(c,u,n))===r)return o[s]=c,o[l]=u,a(o);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function w(e,t){var a,n=0,r=(e=e.slice()).length-1,i=e[n],o=e[r];return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),e[n]=t.floor(i),e[r]=t.ceil(o),e}function S(e){return Math.log(e)}function j(e){return Math.exp(e)}function O(e){return-Math.log(-e)}function I(e){return-Math.exp(-e)}function C(e){return isFinite(e)?+("1e"+e):e<0?0:e}function T(e){return function(t){return-e(-t)}}function M(e){var a,r,i=e(S,j),o=i.domain,s=10;function l(){return a=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(s),r=function(e){return 10===e?C:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(s),o()[0]<0?(a=T(a),r=T(r),e(O,I)):e(S,j),i}return i.base=function(e){return arguments.length?(s=+e,l()):s},i.domain=function(e){return arguments.length?(o(e),l()):o()},i.ticks=function(e){var n,i=o(),l=i[0],c=i[i.length-1];(n=c<l)&&(m=l,l=c,c=m);var u,d,p,m=a(l),y=a(c),g=null==e?10:+e,f=[];if(!(s%1)&&y-m<g){if(m=Math.floor(m),y=Math.ceil(y),l>0){for(;m<=y;++m)for(d=1,u=r(m);d<s;++d)if(!((p=u*d)<l)){if(p>c)break;f.push(p)}}else for(;m<=y;++m)for(d=s-1,u=r(m);d>=1;--d)if(!((p=u*d)<l)){if(p>c)break;f.push(p)}2*f.length<g&&(f=t.ticks(l,c,g))}else f=t.ticks(m,y,Math.min(y-m,g)).map(r);return n?f.reverse():f},i.tickFormat=function(e,t){if(null==t&&(t=10===s?".0e":","),"function"!=typeof t&&(t=n.format(t)),e===1/0)return t;null==e&&(e=10);var o=Math.max(1,s*e/i.ticks().length);return function(e){var n=e/r(Math.round(a(e)));return n*s<s-.5&&(n*=s),n<=o?t(e):""}},i.nice=function(){return o(w(o(),{floor:function(e){return r(Math.floor(a(e)))},ceil:function(e){return r(Math.ceil(a(e)))}}))},i}function _(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function N(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function D(e){var t=1,a=e(_(t),N(t));return a.constant=function(a){return arguments.length?e(_(t=+a),N(t)):t},k(a)}function A(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function F(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function q(e){return e<0?-e*e:e*e}function L(e){var t=e(y,y),a=1;return t.exponent=function(t){return arguments.length?1===(a=+t)?e(y,y):.5===a?e(F,q):e(A(a),A(1/a)):a},k(t)}function R(){var e=L(v());return e.copy=function(){return h(e,R()).exponent(e.exponent())},o.apply(e,arguments),e}function P(e){return Math.sign(e)*e*e}function z(e){return new Date(e)}function B(e){return e instanceof Date?+e:+new Date(+e)}function $(e,t,a,n,r,i,o,s,l,c){var u=E(),d=u.invert,p=u.domain,m=c(".%L"),y=c(":%S"),g=c("%I:%M"),f=c("%I %p"),b=c("%a %d"),v=c("%b %d"),x=c("%B"),k=c("%Y");function S(e){return(l(e)<e?m:s(e)<e?y:o(e)<e?g:i(e)<e?f:n(e)<e?r(e)<e?b:v:a(e)<e?x:k)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?p(Array.from(e,B)):p().map(z)},u.ticks=function(t){var a=p();return e(a[0],a[a.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?S:c(t)},u.nice=function(e){var a=p();return e&&"function"==typeof e.range||(e=t(a[0],a[a.length-1],null==e?10:e)),e?p(w(a,e)):u},u.copy=function(){return h(u,$(e,t,a,n,r,i,o,s,l,c))},u}function G(){var e,t,n,r,i,o=0,s=1,l=y,c=!1;function u(t){return null==t||isNaN(t=+t)?i:l(0===n?.5:(t=(r(t)-e)*n,c?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var a,n;return arguments.length?([a,n]=t,l=e(a,n),u):[l(0),l(1)]}}return u.domain=function(a){return arguments.length?([o,s]=a,e=r(o=+o),t=r(s=+s),n=e===t?0:1/(t-e),u):[o,s]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(l=e,u):l},u.range=d(a.interpolate),u.rangeRound=d(a.interpolateRound),u.unknown=function(e){return arguments.length?(i=e,u):i},function(a){return r=a,e=a(o),t=a(s),n=e===t?0:1/(t-e),u}}function U(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function V(){var e=L(G());return e.copy=function(){return U(e,V()).exponent(e.exponent())},s.apply(e,arguments)}function H(){var e,t,n,r,i,o,s,l=0,c=.5,u=1,d=1,p=y,m=!1;function g(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-t)*(d*e<d*t?r:i),p(m?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,p=a.piecewise(e,[n,r,i]),g):[p(0),p(.5),p(1)]}}return g.domain=function(a){return arguments.length?([l,c,u]=a,e=o(l=+l),t=o(c=+c),n=o(u=+u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),d=t<e?-1:1,g):[l,c,u]},g.clamp=function(e){return arguments.length?(m=!!e,g):m},g.interpolator=function(e){return arguments.length?(p=e,g):p},g.range=f(a.interpolate),g.rangeRound=f(a.interpolateRound),g.unknown=function(e){return arguments.length?(s=e,g):s},function(a){return o=a,e=a(l),t=a(c),n=a(u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),d=t<e?-1:1,g}}function W(){var e=L(H());return e.copy=function(){return U(e,W()).exponent(e.exponent())},s.apply(e,arguments)}e.scaleBand=u,e.scaleDiverging=function e(){var t=k(H()(y));return t.copy=function(){return U(t,e())},s.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=M(H()).domain([.1,1,10]);return t.copy=function(){return U(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleDivergingPow=W,e.scaleDivergingSqrt=function(){return W.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=D(H());return t.copy=function(){return U(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleIdentity=function e(t){var a;function n(e){return null==e||isNaN(e=+e)?a:e}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,p),n):t.slice()},n.unknown=function(e){return arguments.length?(a=e,n):a},n.copy=function(){return e(t).unknown(a)},t=arguments.length?Array.from(t,p):[0,1],k(n)},e.scaleImplicit=l,e.scaleLinear=function e(){var t=E();return t.copy=function(){return h(t,e())},o.apply(t,arguments),k(t)},e.scaleLog=function e(){var t=M(v()).domain([1,10]);return t.copy=function(){return h(t,e()).base(t.base())},o.apply(t,arguments),t},e.scaleOrdinal=c,e.scalePoint=function(){return d(u.apply(null,arguments).paddingInner(1))},e.scalePow=R,e.scaleQuantile=function e(){var a,n=[],r=[],i=[];function s(){var e=0,a=Math.max(1,r.length);for(i=new Array(a-1);++e<a;)i[e-1]=t.quantileSorted(n,e/a);return l}function l(e){return null==e||isNaN(e=+e)?a:r[t.bisect(i,e)]}return l.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},l.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(t.ascending),s()},l.range=function(e){return arguments.length?(r=Array.from(e),s()):r.slice()},l.unknown=function(e){return arguments.length?(a=e,l):a},l.quantiles=function(){return i.slice()},l.copy=function(){return e().domain(n).range(r).unknown(a)},o.apply(l,arguments)},e.scaleQuantize=function e(){var a,n=0,r=1,i=1,s=[.5],l=[0,1];function c(e){return null!=e&&e<=e?l[t.bisect(s,e,0,i)]:a}function u(){var e=-1;for(s=new Array(i);++e<i;)s[e]=((e+1)*r-(e-i)*n)/(i+1);return c}return c.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,u()):[n,r]},c.range=function(e){return arguments.length?(i=(l=Array.from(e)).length-1,u()):l.slice()},c.invertExtent=function(e){var t=l.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,s[0]]:t>=i?[s[i-1],r]:[s[t-1],s[t]]},c.unknown=function(e){return arguments.length?(a=e,c):c},c.thresholds=function(){return s.slice()},c.copy=function(){return e().domain([n,r]).range(l).unknown(a)},o.apply(k(c),arguments)},e.scaleRadial=function e(){var t,a=E(),n=[0,1],r=!1;function i(e){var n=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(a(e));return isNaN(n)?t:r?Math.round(n):n}return i.invert=function(e){return a.invert(P(e))},i.domain=function(e){return arguments.length?(a.domain(e),i):a.domain()},i.range=function(e){return arguments.length?(a.range((n=Array.from(e,p)).map(P)),i):n.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(r=!!e,i):r},i.clamp=function(e){return arguments.length?(a.clamp(e),i):a.clamp()},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e(a.domain(),n).round(r).clamp(a.clamp()).unknown(t)},o.apply(i,arguments),k(i)},e.scaleSequential=function e(){var t=k(G()(y));return t.copy=function(){return U(t,e())},s.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=M(G()).domain([1,10]);return t.copy=function(){return U(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleSequentialPow=V,e.scaleSequentialQuantile=function e(){var a=[],n=y;function r(e){if(null!=e&&!isNaN(e=+e))return n((t.bisect(a,e,1)-1)/(a.length-1))}return r.domain=function(e){if(!arguments.length)return a.slice();a=[];for(let t of e)null==t||isNaN(t=+t)||a.push(t);return a.sort(t.ascending),r},r.interpolator=function(e){return arguments.length?(n=e,r):n},r.range=function(){return a.map(((e,t)=>n(t/(a.length-1))))},r.quantiles=function(e){return Array.from({length:e+1},((n,r)=>t.quantile(a,r/e)))},r.copy=function(){return e(n).domain(a)},s.apply(r,arguments)},e.scaleSequentialSqrt=function(){return V.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=D(G());return t.copy=function(){return U(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleSqrt=function(){return R.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=D(v());return t.copy=function(){return h(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleThreshold=function e(){var a,n=[.5],r=[0,1],i=1;function s(e){return null!=e&&e<=e?r[t.bisect(n,e,0,i)]:a}return s.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),s):n.slice()},s.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),s):r.slice()},s.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},s.unknown=function(e){return arguments.length?(a=e,s):a},s.copy=function(){return e().domain(n).range(r).unknown(a)},o.apply(s,arguments)},e.scaleTime=function(){return o.apply($(r.timeTicks,r.timeTickInterval,r.timeYear,r.timeMonth,r.timeWeek,r.timeDay,r.timeHour,r.timeMinute,r.timeSecond,i.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return o.apply($(r.utcTicks,r.utcTickInterval,r.utcYear,r.utcMonth,r.utcWeek,r.utcDay,r.utcHour,r.utcMinute,r.utcSecond,i.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(833),a(1297),a(1299),a(834),a(1300))},1297:function(e,t,a){!function(e,t){"use strict";function a(e,t,a,n,r){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*a+(1+3*e+3*i-3*o)*n+o*r)/6}function n(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,l=r<t-1?e[r+2]:2*o-i;return a((n-r/t)*t,s,i,o,l)}}function r(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],l=e[(r+2)%t];return a((n-r/t)*t,i,o,s,l)}}var i=e=>()=>e;function o(e,t){return function(a){return e+a*t}}function s(e,t){var a=t-e;return a?o(e,a>180||a<-180?a-360*Math.round(a/360):a):i(isNaN(e)?t:e)}function l(e){return 1==(e=+e)?c:function(t,a){return a-t?function(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(n){return Math.pow(e+n*t,a)}}(t,a,e):i(isNaN(t)?a:t)}}function c(e,t){var a=t-e;return a?o(e,a):i(isNaN(e)?t:e)}var u=function e(a){var n=l(a);function r(e,a){var r=n((e=t.rgb(e)).r,(a=t.rgb(a)).r),i=n(e.g,a.g),o=n(e.b,a.b),s=c(e.opacity,a.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function d(e){return function(a){var n,r,i=a.length,o=new Array(i),s=new Array(i),l=new Array(i);for(n=0;n<i;++n)r=t.rgb(a[n]),o[n]=r.r||0,s[n]=r.g||0,l[n]=r.b||0;return o=e(o),s=e(s),l=e(l),r.opacity=1,function(e){return r.r=o(e),r.g=s(e),r.b=l(e),r+""}}}var p=d(n),m=d(r);function y(e,t){t||(t=[]);var a,n=e?Math.min(t.length,e.length):0,r=t.slice();return function(i){for(a=0;a<n;++a)r[a]=e[a]*(1-i)+t[a]*i;return r}}function g(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function f(e,t){var a,n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n);for(a=0;a<r;++a)i[a]=w(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(e){for(a=0;a<r;++a)o[a]=i[a](e);return o}}function b(e,t){var a=new Date;return e=+e,t=+t,function(n){return a.setTime(e*(1-n)+t*n),a}}function h(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function v(e,t){var a,n={},r={};for(a in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)a in e?n[a]=w(e[a],t[a]):r[a]=t[a];return function(e){for(a in n)r[a]=n[a](e);return r}}var E=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(E.source,"g");function k(e,t){var a,n,r,i=E.lastIndex=x.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(a=E.exec(e))&&(n=x.exec(t));)(r=n.index)>i&&(r=t.slice(i,r),s[o]?s[o]+=r:s[++o]=r),(a=a[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:h(a,n)})),i=x.lastIndex;return i<t.length&&(r=t.slice(i),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var a,n=0;n<t;++n)s[(a=l[n]).i]=a.x(e);return s.join("")})}function w(e,a){var n,r=typeof a;return null==a||"boolean"===r?i(a):("number"===r?h:"string"===r?(n=t.color(a))?(a=n,u):k:a instanceof t.color?u:a instanceof Date?b:g(a)?y:Array.isArray(a)?f:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?v:h)(e,a)}var S,j=180/Math.PI,O={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function I(e,t,a,n,r,i){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*a+t*n)&&(a-=e*l,n-=t*l),(s=Math.sqrt(a*a+n*n))&&(a/=s,n/=s,l/=s),e*n<t*a&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*j,skewX:Math.atan(l)*j,scaleX:o,scaleY:s}}function C(e,t,a,n){function r(e){return e.length?e.pop()+" ":""}return function(i,o){var s=[],l=[];return i=e(i),o=e(o),function(e,n,r,i,o,s){if(e!==r||n!==i){var l=o.push("translate(",null,t,null,a);s.push({i:l-4,x:h(e,r)},{i:l-2,x:h(n,i)})}else(r||i)&&o.push("translate("+r+t+i+a)}(i.translateX,i.translateY,o.translateX,o.translateY,s,l),function(e,t,a,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:a.push(r(a)+"rotate(",null,n)-2,x:h(e,t)})):t&&a.push(r(a)+"rotate("+t+n)}(i.rotate,o.rotate,s,l),function(e,t,a,i){e!==t?i.push({i:a.push(r(a)+"skewX(",null,n)-2,x:h(e,t)}):t&&a.push(r(a)+"skewX("+t+n)}(i.skewX,o.skewX,s,l),function(e,t,a,n,i,o){if(e!==a||t!==n){var s=i.push(r(i)+"scale(",null,",",null,")");o.push({i:s-4,x:h(e,a)},{i:s-2,x:h(t,n)})}else 1===a&&1===n||i.push(r(i)+"scale("+a+","+n+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,s,l),i=o=null,function(e){for(var t,a=-1,n=l.length;++a<n;)s[(t=l[a]).i]=t.x(e);return s.join("")}}}var T=C((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?O:I(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),M=C((function(e){return null==e?O:(S||(S=document.createElementNS("http://www.w3.org/2000/svg","g")),S.setAttribute("transform",e),(e=S.transform.baseVal.consolidate())?I((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):O)}),", ",")",")");function _(e){return((e=Math.exp(e))+1/e)/2}var N=function e(t,a,n){function r(e,r){var i,o,s=e[0],l=e[1],c=e[2],u=r[0],d=r[1],p=r[2],m=u-s,y=d-l,g=m*m+y*y;if(g<1e-12)o=Math.log(p/c)/t,i=function(e){return[s+e*m,l+e*y,c*Math.exp(t*e*o)]};else{var f=Math.sqrt(g),b=(p*p-c*c+n*g)/(2*c*a*f),h=(p*p-c*c-n*g)/(2*p*a*f),v=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(h*h+1)-h);o=(E-v)/t,i=function(e){var n,r=e*o,i=_(v),u=c/(a*f)*(i*(n=t*r+v,((n=Math.exp(2*n))-1)/(n+1))-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+u*m,l+u*y,c*i/_(t*r+v)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return r.rho=function(t){var a=Math.max(.001,+t),n=a*a;return e(a,n,n*n)},r}(Math.SQRT2,2,4);function D(e){return function(a,n){var r=e((a=t.hsl(a)).h,(n=t.hsl(n)).h),i=c(a.s,n.s),o=c(a.l,n.l),s=c(a.opacity,n.opacity);return function(e){return a.h=r(e),a.s=i(e),a.l=o(e),a.opacity=s(e),a+""}}}var A=D(s),F=D(c);function q(e){return function(a,n){var r=e((a=t.hcl(a)).h,(n=t.hcl(n)).h),i=c(a.c,n.c),o=c(a.l,n.l),s=c(a.opacity,n.opacity);return function(e){return a.h=r(e),a.c=i(e),a.l=o(e),a.opacity=s(e),a+""}}}var L=q(s),R=q(c);function P(e){return function a(n){function r(a,r){var i=e((a=t.cubehelix(a)).h,(r=t.cubehelix(r)).h),o=c(a.s,r.s),s=c(a.l,r.l),l=c(a.opacity,r.opacity);return function(e){return a.h=i(e),a.s=o(e),a.l=s(Math.pow(e,n)),a.opacity=l(e),a+""}}return n=+n,r.gamma=a,r}(1)}var z=P(s),B=P(c);e.interpolate=w,e.interpolateArray=function(e,t){return(g(t)?y:f)(e,t)},e.interpolateBasis=n,e.interpolateBasisClosed=r,e.interpolateCubehelix=z,e.interpolateCubehelixLong=B,e.interpolateDate=b,e.interpolateDiscrete=function(e){var t=e.length;return function(a){return e[Math.max(0,Math.min(t-1,Math.floor(a*t)))]}},e.interpolateHcl=L,e.interpolateHclLong=R,e.interpolateHsl=A,e.interpolateHslLong=F,e.interpolateHue=function(e,t){var a=s(+e,+t);return function(e){var t=a(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,a){var n=c((e=t.lab(e)).l,(a=t.lab(a)).l),r=c(e.a,a.a),i=c(e.b,a.b),o=c(e.opacity,a.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}},e.interpolateNumber=h,e.interpolateNumberArray=y,e.interpolateObject=v,e.interpolateRgb=u,e.interpolateRgbBasis=p,e.interpolateRgbBasisClosed=m,e.interpolateRound=function(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}},e.interpolateString=k,e.interpolateTransformCss=T,e.interpolateTransformSvg=M,e.interpolateZoom=N,e.piecewise=function(e,t){void 0===t&&(t=e,e=w);for(var a=0,n=t.length-1,r=t[0],i=new Array(n<0?0:n);a<n;)i[a]=e(r,r=t[++a]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return i[t](e-t)}},e.quantize=function(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e(n/(t-1));return a},Object.defineProperty(e,"__esModule",{value:!0})}(t,a(1298))},1298:function(e,t,a){!function(e){"use strict";function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var n in t)a[n]=t[n];return a}function n(){}var r=.7,i=1/r,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),p=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),y=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),g=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),f={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function h(){return this.rgb().formatRgb()}function v(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(a=t[1].length,t=parseInt(t[1],16),6===a?E(t):3===a?new S(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===a?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===a?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new S(t[1],t[2],t[3],1):(t=d.exec(e))?new S(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?x(t[1],t[2],t[3],t[4]):(t=m.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=y.exec(e))?C(t[1],t[2]/100,t[3]/100,1):(t=g.exec(e))?C(t[1],t[2]/100,t[3]/100,t[4]):f.hasOwnProperty(e)?E(f[e]):"transparent"===e?new S(NaN,NaN,NaN,0):null}function E(e){return new S(e>>16&255,e>>8&255,255&e,1)}function x(e,t,a,n){return n<=0&&(e=t=a=NaN),new S(e,t,a,n)}function k(e){return e instanceof n||(e=v(e)),e?new S((e=e.rgb()).r,e.g,e.b,e.opacity):new S}function w(e,t,a,n){return 1===arguments.length?k(e):new S(e,t,a,null==n?1:n)}function S(e,t,a,n){this.r=+e,this.g=+t,this.b=+a,this.opacity=+n}function j(){return"#"+I(this.r)+I(this.g)+I(this.b)}function O(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function I(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function C(e,t,a,n){return n<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new _(e,t,a,n)}function T(e){if(e instanceof _)return new _(e.h,e.s,e.l,e.opacity);if(e instanceof n||(e=v(e)),!e)return new _;if(e instanceof _)return e;var t=(e=e.rgb()).r/255,a=e.g/255,r=e.b/255,i=Math.min(t,a,r),o=Math.max(t,a,r),s=NaN,l=o-i,c=(o+i)/2;return l?(s=t===o?(a-r)/l+6*(a<r):a===o?(r-t)/l+2:(t-a)/l+4,l/=c<.5?o+i:2-o-i,s*=60):l=c>0&&c<1?0:s,new _(s,l,c,e.opacity)}function M(e,t,a,n){return 1===arguments.length?T(e):new _(e,t,a,null==n?1:n)}function _(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}function N(e,t,a){return 255*(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)}t(n,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:b,formatHex:b,formatHsl:function(){return T(this).formatHsl()},formatRgb:h,toString:h}),t(S,w,a(n,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new S(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new S(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:j,formatHex:j,formatRgb:O,toString:O})),t(_,M,a(n,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new _(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new _(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,n=a+(a<.5?a:1-a)*t,r=2*a-n;return new S(N(e>=240?e-240:e+120,r,n),N(e,r,n),N(e<120?e+240:e-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const D=Math.PI/180,A=180/Math.PI,F=.96422,q=1,L=.82521,R=4/29,P=6/29,z=3*P*P,B=P*P*P;function $(e){if(e instanceof U)return new U(e.l,e.a,e.b,e.opacity);if(e instanceof Q)return X(e);e instanceof S||(e=k(e));var t,a,n=Y(e.r),r=Y(e.g),i=Y(e.b),o=V((.2225045*n+.7168786*r+.0606169*i)/q);return n===r&&r===i?t=a=o:(t=V((.4360747*n+.3850649*r+.1430804*i)/F),a=V((.0139322*n+.0971045*r+.7141733*i)/L)),new U(116*o-16,500*(t-o),200*(o-a),e.opacity)}function G(e,t,a,n){return 1===arguments.length?$(e):new U(e,t,a,null==n?1:n)}function U(e,t,a,n){this.l=+e,this.a=+t,this.b=+a,this.opacity=+n}function V(e){return e>B?Math.pow(e,1/3):e/z+R}function H(e){return e>P?e*e*e:z*(e-R)}function W(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Y(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Z(e){if(e instanceof Q)return new Q(e.h,e.c,e.l,e.opacity);if(e instanceof U||(e=$(e)),0===e.a&&0===e.b)return new Q(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*A;return new Q(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function K(e,t,a,n){return 1===arguments.length?Z(e):new Q(e,t,a,null==n?1:n)}function Q(e,t,a,n){this.h=+e,this.c=+t,this.l=+a,this.opacity=+n}function X(e){if(isNaN(e.h))return new U(e.l,0,0,e.opacity);var t=e.h*D;return new U(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(U,G,a(n,{brighter:function(e){return new U(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new U(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return new S(W(3.1338561*(t=F*H(t))-1.6168667*(e=q*H(e))-.4906146*(a=L*H(a))),W(-.9787684*t+1.9161415*e+.033454*a),W(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(Q,K,a(n,{brighter:function(e){return new Q(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Q(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return X(this).rgb()}}));var J=-.14861,ee=1.78277,te=-.29227,ae=-.90649,ne=1.97294,re=ne*ae,ie=ne*ee,oe=ee*te-ae*J;function se(e,t,a,n){return 1===arguments.length?function(e){if(e instanceof le)return new le(e.h,e.s,e.l,e.opacity);e instanceof S||(e=k(e));var t=e.r/255,a=e.g/255,n=e.b/255,r=(oe*n+re*t-ie*a)/(oe+re-ie),i=n-r,o=(ne*(a-r)-te*i)/ae,s=Math.sqrt(o*o+i*i)/(ne*r*(1-r)),l=s?Math.atan2(o,i)*A-120:NaN;return new le(l<0?l+360:l,s,r,e.opacity)}(e):new le(e,t,a,null==n?1:n)}function le(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}t(le,se,a(n,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new le(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new le(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*D,t=+this.l,a=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),r=Math.sin(e);return new S(255*(t+a*(J*n+ee*r)),255*(t+a*(te*n+ae*r)),255*(t+a*(ne*n)),this.opacity)}})),e.color=v,e.cubehelix=se,e.gray=function(e,t){return new U(e,0,0,null==t?1:t)},e.hcl=K,e.hsl=M,e.lab=G,e.lch=function(e,t,a,n){return 1===arguments.length?Z(e):new Q(a,t,e,null==n?1:n)},e.rgb=w,Object.defineProperty(e,"__esModule",{value:!0})}(t)},1299:function(e,t,a){!function(e){"use strict";function t(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,n=e.slice(0,a);return[n.length>1?n[0]+n.slice(2):n,+e.slice(a+1)]}function a(e){return(e=t(Math.abs(e)))?e[1]:NaN}var n,r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i(e){if(!(t=r.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function s(e,a){var n=t(e,a);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}i.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>s(100*e,t),r:s,s:function(e,a){var r=t(e,a);if(!r)return e+"";var i=r[0],o=r[1],s=o-(n=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=i.length;return s===l?i:s>l?i+new Array(s-l+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,a+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c(e){return e}var u,d=Array.prototype.map,p=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,r,o=void 0===e.grouping||void 0===e.thousands?c:(t=d.call(e.grouping,Number),r=e.thousands+"",function(e,a){for(var n=e.length,i=[],o=0,s=t[0],l=0;n>0&&s>0&&(l+s+1>a&&(s=Math.max(1,a-l)),i.push(e.substring(n-=s,n+s)),!((l+=s+1)>a));)s=t[o=(o+1)%t.length];return i.reverse().join(r)}),s=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",m=void 0===e.decimal?".":e.decimal+"",y=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(d.call(e.numerals,String)),g=void 0===e.percent?"%":e.percent+"",f=void 0===e.minus?"−":e.minus+"",b=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=i(e)).fill,a=e.align,r=e.sign,c=e.symbol,d=e.zero,h=e.width,v=e.comma,E=e.precision,x=e.trim,k=e.type;"n"===k?(v=!0,k="g"):l[k]||(void 0===E&&(E=12),x=!0,k="g"),(d||"0"===t&&"="===a)&&(d=!0,t="0",a="=");var w="$"===c?s:"#"===c&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",S="$"===c?u:/[%p]/.test(k)?g:"",j=l[k],O=/[defgprs%]/.test(k);function I(e){var i,s,l,c=w,u=S;if("c"===k)u=j(e)+u,e="";else{var g=(e=+e)<0||1/e<0;if(e=isNaN(e)?b:j(Math.abs(e),E),x&&(e=function(e){e:for(var t,a=e.length,n=1,r=-1;n<a;++n)switch(e[n]){case".":r=t=n;break;case"0":0===r&&(r=n),t=n;break;default:if(!+e[n])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),g&&0==+e&&"+"!==r&&(g=!1),c=(g?"("===r?r:f:"-"===r||"("===r?"":r)+c,u=("s"===k?p[8+n/3]:"")+u+(g&&"("===r?")":""),O)for(i=-1,s=e.length;++i<s;)if(48>(l=e.charCodeAt(i))||l>57){u=(46===l?m+e.slice(i+1):e.slice(i))+u,e=e.slice(0,i);break}}v&&!d&&(e=o(e,1/0));var I=c.length+e.length+u.length,C=I<h?new Array(h-I+1).join(t):"";switch(v&&d&&(e=o(C+e,C.length?h-u.length:1/0),C=""),a){case"<":e=c+e+u+C;break;case"=":e=c+C+e+u;break;case"^":e=C.slice(0,I=C.length>>1)+c+e+u+C.slice(I);break;default:e=C+c+e+u}return y(e)}return E=void 0===E?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E)),I.toString=function(){return e+""},I}return{format:h,formatPrefix:function(e,t){var n=h(((e=i(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),o=Math.pow(10,-r),s=p[8+r/3];return function(e){return n(o*e)+s}}}}function y(t){return u=m(t),e.format=u.format,e.formatPrefix=u.formatPrefix,u}y({thousands:",",grouping:[3],currency:["$",""]}),e.FormatSpecifier=o,e.formatDefaultLocale=y,e.formatLocale=m,e.formatSpecifier=i,e.precisionFixed=function(e){return Math.max(0,-a(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},1300:function(e,t,a){!function(e,t){"use strict";function a(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function r(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function i(e){var i=e.dateTime,o=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,p=e.months,H=e.shortMonths,pe=m(c),Se=y(c),je=m(u),Oe=y(u),Ie=m(d),Ce=y(d),Te=m(p),Me=y(p),_e=m(H),Ne=y(H),De={a:function(e){return d[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return H[e.getMonth()]},B:function(e){return p[e.getMonth()]},c:null,d:F,e:F,f:z,g:Q,G:J,H:q,I:L,j:R,L:P,m:B,M:$,p:function(e){return c[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ke,s:we,S:G,u:U,U:V,V:W,w:Y,W:Z,x:null,X:null,y:K,Y:X,Z:ee,"%":xe},Ae={a:function(e){return d[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return H[e.getUTCMonth()]},B:function(e){return p[e.getUTCMonth()]},c:null,d:te,e:te,f:oe,g:be,G:ve,H:ae,I:ne,j:re,L:ie,m:se,M:le,p:function(e){return c[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ke,s:we,S:ce,u:ue,U:de,V:me,w:ye,W:ge,x:null,X:null,y:fe,Y:he,Z:Ee,"%":xe},Fe={a:function(e,t,a){var n=Ie.exec(t.slice(a));return n?(e.w=Ce.get(n[0].toLowerCase()),a+n[0].length):-1},A:function(e,t,a){var n=je.exec(t.slice(a));return n?(e.w=Oe.get(n[0].toLowerCase()),a+n[0].length):-1},b:function(e,t,a){var n=_e.exec(t.slice(a));return n?(e.m=Ne.get(n[0].toLowerCase()),a+n[0].length):-1},B:function(e,t,a){var n=Te.exec(t.slice(a));return n?(e.m=Me.get(n[0].toLowerCase()),a+n[0].length):-1},c:function(e,t,a){return Re(e,i,t,a)},d:j,e:j,f:_,g:x,G:E,H:I,I:I,j:O,L:M,m:S,M:C,p:function(e,t,a){var n=pe.exec(t.slice(a));return n?(e.p=Se.get(n[0].toLowerCase()),a+n[0].length):-1},q:w,Q:D,s:A,S:T,u:f,U:b,V:h,w:g,W:v,x:function(e,t,a){return Re(e,o,t,a)},X:function(e,t,a){return Re(e,l,t,a)},y:x,Y:E,Z:k,"%":N};function qe(e,t){return function(a){var n,r,i,o=[],l=-1,c=0,u=e.length;for(a instanceof Date||(a=new Date(+a));++l<u;)37===e.charCodeAt(l)&&(o.push(e.slice(c,l)),null!=(r=s[n=e.charAt(++l)])?n=e.charAt(++l):r="e"===n?" ":"0",(i=t[n])&&(n=i(a,r)),o.push(n),c=l+1);return o.push(e.slice(c,l)),o.join("")}}function Le(e,i){return function(o){var s,l,c=r(1900,void 0,1);if(Re(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(i&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(s=n(r(c.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(c.V-1)),c.y=s.getUTCFullYear(),c.m=s.getUTCMonth(),c.d=s.getUTCDate()+(c.w+6)%7):(l=(s=a(r(c.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(c.V-1)),c.y=s.getFullYear(),c.m=s.getMonth(),c.d=s.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?n(r(c.y,0,1)).getUTCDay():a(r(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,n(c)):a(c)}}function Re(e,t,a,n){for(var r,i,o=0,l=t.length,c=a.length;o<l;){if(n>=c)return-1;if(37===(r=t.charCodeAt(o++))){if(r=t.charAt(o++),!(i=Fe[r in s?t.charAt(o++):r])||(n=i(e,a,n))<0)return-1}else if(r!=a.charCodeAt(n++))return-1}return n}return De.x=qe(o,De),De.X=qe(l,De),De.c=qe(i,De),Ae.x=qe(o,Ae),Ae.X=qe(l,Ae),Ae.c=qe(i,Ae),{format:function(e){var t=qe(e+="",De);return t.toString=function(){return e},t},parse:function(e){var t=Le(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=qe(e+="",Ae);return t.toString=function(){return e},t},utcParse:function(e){var t=Le(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,a){var n=e<0?"-":"",r=(n?-e:e)+"",i=r.length;return n+(i<a?new Array(a-i+1).join(t)+r:r)}function p(e){return e.replace(u,"\\$&")}function m(e){return new RegExp("^(?:"+e.map(p).join("|")+")","i")}function y(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function g(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.w=+n[0],a+n[0].length):-1}function f(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.u=+n[0],a+n[0].length):-1}function b(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.U=+n[0],a+n[0].length):-1}function h(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.V=+n[0],a+n[0].length):-1}function v(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.W=+n[0],a+n[0].length):-1}function E(e,t,a){var n=l.exec(t.slice(a,a+4));return n?(e.y=+n[0],a+n[0].length):-1}function x(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),a+n[0].length):-1}function k(e,t,a){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),a+n[0].length):-1}function w(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.q=3*n[0]-3,a+n[0].length):-1}function S(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.m=n[0]-1,a+n[0].length):-1}function j(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.d=+n[0],a+n[0].length):-1}function O(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.m=0,e.d=+n[0],a+n[0].length):-1}function I(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.H=+n[0],a+n[0].length):-1}function C(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.M=+n[0],a+n[0].length):-1}function T(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.S=+n[0],a+n[0].length):-1}function M(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.L=+n[0],a+n[0].length):-1}function _(e,t,a){var n=l.exec(t.slice(a,a+6));return n?(e.L=Math.floor(n[0]/1e3),a+n[0].length):-1}function N(e,t,a){var n=c.exec(t.slice(a,a+1));return n?a+n[0].length:-1}function D(e,t,a){var n=l.exec(t.slice(a));return n?(e.Q=+n[0],a+n[0].length):-1}function A(e,t,a){var n=l.exec(t.slice(a));return n?(e.s=+n[0],a+n[0].length):-1}function F(e,t){return d(e.getDate(),t,2)}function q(e,t){return d(e.getHours(),t,2)}function L(e,t){return d(e.getHours()%12||12,t,2)}function R(e,a){return d(1+t.timeDay.count(t.timeYear(e),e),a,3)}function P(e,t){return d(e.getMilliseconds(),t,3)}function z(e,t){return P(e,t)+"000"}function B(e,t){return d(e.getMonth()+1,t,2)}function $(e,t){return d(e.getMinutes(),t,2)}function G(e,t){return d(e.getSeconds(),t,2)}function U(e){var t=e.getDay();return 0===t?7:t}function V(e,a){return d(t.timeSunday.count(t.timeYear(e)-1,e),a,2)}function H(e){var a=e.getDay();return a>=4||0===a?t.timeThursday(e):t.timeThursday.ceil(e)}function W(e,a){return e=H(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),a,2)}function Y(e){return e.getDay()}function Z(e,a){return d(t.timeMonday.count(t.timeYear(e)-1,e),a,2)}function K(e,t){return d(e.getFullYear()%100,t,2)}function Q(e,t){return d((e=H(e)).getFullYear()%100,t,2)}function X(e,t){return d(e.getFullYear()%1e4,t,4)}function J(e,a){var n=e.getDay();return d((e=n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e)).getFullYear()%1e4,a,4)}function ee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function te(e,t){return d(e.getUTCDate(),t,2)}function ae(e,t){return d(e.getUTCHours(),t,2)}function ne(e,t){return d(e.getUTCHours()%12||12,t,2)}function re(e,a){return d(1+t.utcDay.count(t.utcYear(e),e),a,3)}function ie(e,t){return d(e.getUTCMilliseconds(),t,3)}function oe(e,t){return ie(e,t)+"000"}function se(e,t){return d(e.getUTCMonth()+1,t,2)}function le(e,t){return d(e.getUTCMinutes(),t,2)}function ce(e,t){return d(e.getUTCSeconds(),t,2)}function ue(e){var t=e.getUTCDay();return 0===t?7:t}function de(e,a){return d(t.utcSunday.count(t.utcYear(e)-1,e),a,2)}function pe(e){var a=e.getUTCDay();return a>=4||0===a?t.utcThursday(e):t.utcThursday.ceil(e)}function me(e,a){return e=pe(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),a,2)}function ye(e){return e.getUTCDay()}function ge(e,a){return d(t.utcMonday.count(t.utcYear(e)-1,e),a,2)}function fe(e,t){return d(e.getUTCFullYear()%100,t,2)}function be(e,t){return d((e=pe(e)).getUTCFullYear()%100,t,2)}function he(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function ve(e,a){var n=e.getUTCDay();return d((e=n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e)).getUTCFullYear()%1e4,a,4)}function Ee(){return"+0000"}function xe(){return"%"}function ke(e){return+e}function we(e){return Math.floor(+e/1e3)}function Se(t){return o=i(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}Se({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var je="%Y-%m-%dT%H:%M:%S.%LZ";var Oe=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(je);var Ie=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(je);e.isoFormat=Oe,e.isoParse=Ie,e.timeFormatDefaultLocale=Se,e.timeFormatLocale=i,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(834))},1301:function(e,t,a){"use strict";var n=a(1302),r=a(1303).remove,i={},o={},s={},l={},c={};function u(e){return String("000"+(e||"")).slice(-3)}function d(e){return s[e]}function p(e){return o[e]}function m(e){var t=u(e);return p(l[t])}function y(e){var t=u(e);return l[t]}function g(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return y(e);if(2===e.length)return e.toUpperCase();if(3===e.length)return d(e.toUpperCase())}if("number"==typeof e)return y(e)}n.forEach((function(e){var t=e;o[t[0]]=t[1],s[t[1]]=t[0],l[t[2]]=t[0],c[t[0]]=t[2]})),t.registerLocale=function(e){if(!e.locale)throw new TypeError("Missing localeData.locale");if(!e.countries)throw new TypeError("Missing localeData.countries");i[e.locale]=e.countries},t.alpha3ToAlpha2=d,t.alpha2ToAlpha3=p,t.alpha3ToNumeric=function(e){return c[d(e)]},t.alpha2ToNumeric=function(e){return c[e]},t.numericToAlpha3=m,t.numericToAlpha2=y,t.toAlpha3=function(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return m(e);if(2===e.length)return p(e.toUpperCase());if(3===e.length)return e.toUpperCase()}if("number"==typeof e)return m(e)},t.toAlpha2=g,t.getName=function(e,t){try{return i[t.toLowerCase()][g(e)]}catch(e){return}},t.getNames=function(e){var t=i[e.toLowerCase()];return void 0===t?{}:t},t.getAlpha2Code=function(e,t){try{var a,n=i[t.toLowerCase()];for(a in n)if(n.hasOwnProperty(a)&&n[a].toLowerCase()===e.toLowerCase())return a;return}catch(e){return}},t.getSimpleAlpha2Code=function(e,t){try{var a,n=i[t.toLowerCase()];for(a in n)if(n.hasOwnProperty(a)&&r(n[a].toLowerCase())===r(e.toLowerCase()))return a;return}catch(e){return}},t.getAlpha2Codes=function(){return o},t.getAlpha3Code=function(e,t){var a=this.getAlpha2Code(e,t);return a?this.toAlpha3(a):void 0},t.getSimpleAlpha3Code=function(e,t){var a=this.getSimpleAlpha2Code(e,t);return a?this.toAlpha3(a):void 0},t.getAlpha3Codes=function(){return s},t.getNumericCodes=function(){return l},t.langs=function(){return Object.keys(i)},t.isValid=function(e){if(!e)return!1;var t=e.toString().toUpperCase();return s.hasOwnProperty(t)||o.hasOwnProperty(t)||l.hasOwnProperty(t)}},1302:function(e){e.exports=JSON.parse('[["AF","AFG","004","ISO 3166-2:AF"],["AX","ALA","248","ISO 3166-2:AX"],["AL","ALB","008","ISO 3166-2:AL"],["DZ","DZA","012","ISO 3166-2:DZ"],["AS","ASM","016","ISO 3166-2:AS"],["AD","AND","020","ISO 3166-2:AD"],["AO","AGO","024","ISO 3166-2:AO"],["AI","AIA","660","ISO 3166-2:AI"],["AQ","ATA","010","ISO 3166-2:AQ"],["AG","ATG","028","ISO 3166-2:AG"],["AR","ARG","032","ISO 3166-2:AR"],["AM","ARM","051","ISO 3166-2:AM"],["AW","ABW","533","ISO 3166-2:AW"],["AU","AUS","036","ISO 3166-2:AU"],["AT","AUT","040","ISO 3166-2:AT"],["AZ","AZE","031","ISO 3166-2:AZ"],["BS","BHS","044","ISO 3166-2:BS"],["BH","BHR","048","ISO 3166-2:BH"],["BD","BGD","050","ISO 3166-2:BD"],["BB","BRB","052","ISO 3166-2:BB"],["BY","BLR","112","ISO 3166-2:BY"],["BE","BEL","056","ISO 3166-2:BE"],["BZ","BLZ","084","ISO 3166-2:BZ"],["BJ","BEN","204","ISO 3166-2:BJ"],["BM","BMU","060","ISO 3166-2:BM"],["BT","BTN","064","ISO 3166-2:BT"],["BO","BOL","068","ISO 3166-2:BO"],["BQ","BES","535","ISO 3166-2:BQ"],["BA","BIH","070","ISO 3166-2:BA"],["BW","BWA","072","ISO 3166-2:BW"],["BV","BVT","074","ISO 3166-2:BV"],["BR","BRA","076","ISO 3166-2:BR"],["IO","IOT","086","ISO 3166-2:IO"],["BN","BRN","096","ISO 3166-2:BN"],["BG","BGR","100","ISO 3166-2:BG"],["BF","BFA","854","ISO 3166-2:BF"],["BI","BDI","108","ISO 3166-2:BI"],["KH","KHM","116","ISO 3166-2:KH"],["CM","CMR","120","ISO 3166-2:CM"],["CA","CAN","124","ISO 3166-2:CA"],["CV","CPV","132","ISO 3166-2:CV"],["KY","CYM","136","ISO 3166-2:KY"],["CF","CAF","140","ISO 3166-2:CF"],["TD","TCD","148","ISO 3166-2:TD"],["CL","CHL","152","ISO 3166-2:CL"],["CN","CHN","156","ISO 3166-2:CN"],["CX","CXR","162","ISO 3166-2:CX"],["CC","CCK","166","ISO 3166-2:CC"],["CO","COL","170","ISO 3166-2:CO"],["KM","COM","174","ISO 3166-2:KM"],["CG","COG","178","ISO 3166-2:CG"],["CD","COD","180","ISO 3166-2:CD"],["CK","COK","184","ISO 3166-2:CK"],["CR","CRI","188","ISO 3166-2:CR"],["CI","CIV","384","ISO 3166-2:CI"],["HR","HRV","191","ISO 3166-2:HR"],["CU","CUB","192","ISO 3166-2:CU"],["CW","CUW","531","ISO 3166-2:CW"],["CY","CYP","196","ISO 3166-2:CY"],["CZ","CZE","203","ISO 3166-2:CZ"],["DK","DNK","208","ISO 3166-2:DK"],["DJ","DJI","262","ISO 3166-2:DJ"],["DM","DMA","212","ISO 3166-2:DM"],["DO","DOM","214","ISO 3166-2:DO"],["EC","ECU","218","ISO 3166-2:EC"],["EG","EGY","818","ISO 3166-2:EG"],["SV","SLV","222","ISO 3166-2:SV"],["GQ","GNQ","226","ISO 3166-2:GQ"],["ER","ERI","232","ISO 3166-2:ER"],["EE","EST","233","ISO 3166-2:EE"],["ET","ETH","231","ISO 3166-2:ET"],["FK","FLK","238","ISO 3166-2:FK"],["FO","FRO","234","ISO 3166-2:FO"],["FJ","FJI","242","ISO 3166-2:FJ"],["FI","FIN","246","ISO 3166-2:FI"],["FR","FRA","250","ISO 3166-2:FR"],["GF","GUF","254","ISO 3166-2:GF"],["PF","PYF","258","ISO 3166-2:PF"],["TF","ATF","260","ISO 3166-2:TF"],["GA","GAB","266","ISO 3166-2:GA"],["GM","GMB","270","ISO 3166-2:GM"],["GE","GEO","268","ISO 3166-2:GE"],["DE","DEU","276","ISO 3166-2:DE"],["GH","GHA","288","ISO 3166-2:GH"],["GI","GIB","292","ISO 3166-2:GI"],["GR","GRC","300","ISO 3166-2:GR"],["GL","GRL","304","ISO 3166-2:GL"],["GD","GRD","308","ISO 3166-2:GD"],["GP","GLP","312","ISO 3166-2:GP"],["GU","GUM","316","ISO 3166-2:GU"],["GT","GTM","320","ISO 3166-2:GT"],["GG","GGY","831","ISO 3166-2:GG"],["GN","GIN","324","ISO 3166-2:GN"],["GW","GNB","624","ISO 3166-2:GW"],["GY","GUY","328","ISO 3166-2:GY"],["HT","HTI","332","ISO 3166-2:HT"],["HM","HMD","334","ISO 3166-2:HM"],["VA","VAT","336","ISO 3166-2:VA"],["HN","HND","340","ISO 3166-2:HN"],["HK","HKG","344","ISO 3166-2:HK"],["HU","HUN","348","ISO 3166-2:HU"],["IS","ISL","352","ISO 3166-2:IS"],["IN","IND","356","ISO 3166-2:IN"],["ID","IDN","360","ISO 3166-2:ID"],["IR","IRN","364","ISO 3166-2:IR"],["IQ","IRQ","368","ISO 3166-2:IQ"],["IE","IRL","372","ISO 3166-2:IE"],["IM","IMN","833","ISO 3166-2:IM"],["IL","ISR","376","ISO 3166-2:IL"],["IT","ITA","380","ISO 3166-2:IT"],["JM","JAM","388","ISO 3166-2:JM"],["JP","JPN","392","ISO 3166-2:JP"],["JE","JEY","832","ISO 3166-2:JE"],["JO","JOR","400","ISO 3166-2:JO"],["KZ","KAZ","398","ISO 3166-2:KZ"],["KE","KEN","404","ISO 3166-2:KE"],["KI","KIR","296","ISO 3166-2:KI"],["KP","PRK","408","ISO 3166-2:KP"],["KR","KOR","410","ISO 3166-2:KR"],["KW","KWT","414","ISO 3166-2:KW"],["KG","KGZ","417","ISO 3166-2:KG"],["LA","LAO","418","ISO 3166-2:LA"],["LV","LVA","428","ISO 3166-2:LV"],["LB","LBN","422","ISO 3166-2:LB"],["LS","LSO","426","ISO 3166-2:LS"],["LR","LBR","430","ISO 3166-2:LR"],["LY","LBY","434","ISO 3166-2:LY"],["LI","LIE","438","ISO 3166-2:LI"],["LT","LTU","440","ISO 3166-2:LT"],["LU","LUX","442","ISO 3166-2:LU"],["MO","MAC","446","ISO 3166-2:MO"],["MK","MKD","807","ISO 3166-2:MK"],["MG","MDG","450","ISO 3166-2:MG"],["MW","MWI","454","ISO 3166-2:MW"],["MY","MYS","458","ISO 3166-2:MY"],["MV","MDV","462","ISO 3166-2:MV"],["ML","MLI","466","ISO 3166-2:ML"],["MT","MLT","470","ISO 3166-2:MT"],["MH","MHL","584","ISO 3166-2:MH"],["MQ","MTQ","474","ISO 3166-2:MQ"],["MR","MRT","478","ISO 3166-2:MR"],["MU","MUS","480","ISO 3166-2:MU"],["YT","MYT","175","ISO 3166-2:YT"],["MX","MEX","484","ISO 3166-2:MX"],["FM","FSM","583","ISO 3166-2:FM"],["MD","MDA","498","ISO 3166-2:MD"],["MC","MCO","492","ISO 3166-2:MC"],["MN","MNG","496","ISO 3166-2:MN"],["ME","MNE","499","ISO 3166-2:ME"],["MS","MSR","500","ISO 3166-2:MS"],["MA","MAR","504","ISO 3166-2:MA"],["MZ","MOZ","508","ISO 3166-2:MZ"],["MM","MMR","104","ISO 3166-2:MM"],["NA","NAM","516","ISO 3166-2:NA"],["NR","NRU","520","ISO 3166-2:NR"],["NP","NPL","524","ISO 3166-2:NP"],["NL","NLD","528","ISO 3166-2:NL"],["NC","NCL","540","ISO 3166-2:NC"],["NZ","NZL","554","ISO 3166-2:NZ"],["NI","NIC","558","ISO 3166-2:NI"],["NE","NER","562","ISO 3166-2:NE"],["NG","NGA","566","ISO 3166-2:NG"],["NU","NIU","570","ISO 3166-2:NU"],["NF","NFK","574","ISO 3166-2:NF"],["MP","MNP","580","ISO 3166-2:MP"],["NO","NOR","578","ISO 3166-2:NO"],["OM","OMN","512","ISO 3166-2:OM"],["PK","PAK","586","ISO 3166-2:PK"],["PW","PLW","585","ISO 3166-2:PW"],["PS","PSE","275","ISO 3166-2:PS"],["PA","PAN","591","ISO 3166-2:PA"],["PG","PNG","598","ISO 3166-2:PG"],["PY","PRY","600","ISO 3166-2:PY"],["PE","PER","604","ISO 3166-2:PE"],["PH","PHL","608","ISO 3166-2:PH"],["PN","PCN","612","ISO 3166-2:PN"],["PL","POL","616","ISO 3166-2:PL"],["PT","PRT","620","ISO 3166-2:PT"],["PR","PRI","630","ISO 3166-2:PR"],["QA","QAT","634","ISO 3166-2:QA"],["RE","REU","638","ISO 3166-2:RE"],["RO","ROU","642","ISO 3166-2:RO"],["RU","RUS","643","ISO 3166-2:RU"],["RW","RWA","646","ISO 3166-2:RW"],["BL","BLM","652","ISO 3166-2:BL"],["SH","SHN","654","ISO 3166-2:SH"],["KN","KNA","659","ISO 3166-2:KN"],["LC","LCA","662","ISO 3166-2:LC"],["MF","MAF","663","ISO 3166-2:MF"],["PM","SPM","666","ISO 3166-2:PM"],["VC","VCT","670","ISO 3166-2:VC"],["WS","WSM","882","ISO 3166-2:WS"],["SM","SMR","674","ISO 3166-2:SM"],["ST","STP","678","ISO 3166-2:ST"],["SA","SAU","682","ISO 3166-2:SA"],["SN","SEN","686","ISO 3166-2:SN"],["RS","SRB","688","ISO 3166-2:RS"],["SC","SYC","690","ISO 3166-2:SC"],["SL","SLE","694","ISO 3166-2:SL"],["SG","SGP","702","ISO 3166-2:SG"],["SX","SXM","534","ISO 3166-2:SX"],["SK","SVK","703","ISO 3166-2:SK"],["SI","SVN","705","ISO 3166-2:SI"],["SB","SLB","090","ISO 3166-2:SB"],["SO","SOM","706","ISO 3166-2:SO"],["ZA","ZAF","710","ISO 3166-2:ZA"],["GS","SGS","239","ISO 3166-2:GS"],["SS","SSD","728","ISO 3166-2:SS"],["ES","ESP","724","ISO 3166-2:ES"],["LK","LKA","144","ISO 3166-2:LK"],["SD","SDN","729","ISO 3166-2:SD"],["SR","SUR","740","ISO 3166-2:SR"],["SJ","SJM","744","ISO 3166-2:SJ"],["SZ","SWZ","748","ISO 3166-2:SZ"],["SE","SWE","752","ISO 3166-2:SE"],["CH","CHE","756","ISO 3166-2:CH"],["SY","SYR","760","ISO 3166-2:SY"],["TW","TWN","158","ISO 3166-2:TW"],["TJ","TJK","762","ISO 3166-2:TJ"],["TZ","TZA","834","ISO 3166-2:TZ"],["TH","THA","764","ISO 3166-2:TH"],["TL","TLS","626","ISO 3166-2:TL"],["TG","TGO","768","ISO 3166-2:TG"],["TK","TKL","772","ISO 3166-2:TK"],["TO","TON","776","ISO 3166-2:TO"],["TT","TTO","780","ISO 3166-2:TT"],["TN","TUN","788","ISO 3166-2:TN"],["TR","TUR","792","ISO 3166-2:TR"],["TM","TKM","795","ISO 3166-2:TM"],["TC","TCA","796","ISO 3166-2:TC"],["TV","TUV","798","ISO 3166-2:TV"],["UG","UGA","800","ISO 3166-2:UG"],["UA","UKR","804","ISO 3166-2:UA"],["AE","ARE","784","ISO 3166-2:AE"],["GB","GBR","826","ISO 3166-2:GB"],["US","USA","840","ISO 3166-2:US"],["UM","UMI","581","ISO 3166-2:UM"],["UY","URY","858","ISO 3166-2:UY"],["UZ","UZB","860","ISO 3166-2:UZ"],["VU","VUT","548","ISO 3166-2:VU"],["VE","VEN","862","ISO 3166-2:VE"],["VN","VNM","704","ISO 3166-2:VN"],["VG","VGB","092","ISO 3166-2:VG"],["VI","VIR","850","ISO 3166-2:VI"],["WF","WLF","876","ISO 3166-2:WF"],["EH","ESH","732","ISO 3166-2:EH"],["YE","YEM","887","ISO 3166-2:YE"],["ZM","ZMB","894","ISO 3166-2:ZM"],["ZW","ZWE","716","ISO 3166-2:ZW"],["XK","XKX","","ISO 3166-2:XK"]]')},1303:function(e,t){t.remove=function(e){return e.replace(/[^\u0000-\u007e]/g,(function(e){return n[e]||e}))};for(var a=[{base:" ",chars:" "},{base:"0",chars:"߀"},{base:"A",chars:"ⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",chars:"Ꜳ"},{base:"AE",chars:"ÆǼǢ"},{base:"AO",chars:"Ꜵ"},{base:"AU",chars:"Ꜷ"},{base:"AV",chars:"ꜸꜺ"},{base:"AY",chars:"Ꜽ"},{base:"B",chars:"ⒷＢḂḄḆɃƁ"},{base:"C",chars:"ⒸＣꜾḈĆCĈĊČÇƇȻ"},{base:"D",chars:"ⒹＤḊĎḌḐḒḎĐƊƉᴅꝹ"},{base:"Dh",chars:"Ð"},{base:"DZ",chars:"ǱǄ"},{base:"Dz",chars:"ǲǅ"},{base:"E",chars:"ɛⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎᴇ"},{base:"F",chars:"ꝼⒻＦḞƑꝻ"},{base:"G",chars:"ⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾɢ"},{base:"H",chars:"ⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",chars:"ⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",chars:"ⒿＪĴɈȷ"},{base:"K",chars:"ⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",chars:"ⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",chars:"Ǉ"},{base:"Lj",chars:"ǈ"},{base:"M",chars:"ⓂＭḾṀṂⱮƜϻ"},{base:"N",chars:"ꞤȠⓃＮǸŃÑṄŇṆŅṊṈƝꞐᴎ"},{base:"NJ",chars:"Ǌ"},{base:"Nj",chars:"ǋ"},{base:"O",chars:"ⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OE",chars:"Œ"},{base:"OI",chars:"Ƣ"},{base:"OO",chars:"Ꝏ"},{base:"OU",chars:"Ȣ"},{base:"P",chars:"ⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",chars:"ⓆＱꝖꝘɊ"},{base:"R",chars:"ⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",chars:"ⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",chars:"ⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"Th",chars:"Þ"},{base:"TZ",chars:"Ꜩ"},{base:"U",chars:"ⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",chars:"ⓋＶṼṾƲꝞɅ"},{base:"VY",chars:"Ꝡ"},{base:"W",chars:"ⓌＷẀẂŴẆẄẈⱲ"},{base:"X",chars:"ⓍＸẊẌ"},{base:"Y",chars:"ⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",chars:"ⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",chars:"ⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑ"},{base:"aa",chars:"ꜳ"},{base:"ae",chars:"æǽǣ"},{base:"ao",chars:"ꜵ"},{base:"au",chars:"ꜷ"},{base:"av",chars:"ꜹꜻ"},{base:"ay",chars:"ꜽ"},{base:"b",chars:"ⓑｂḃḅḇƀƃɓƂ"},{base:"c",chars:"ｃⓒćĉċčçḉƈȼꜿↄ"},{base:"d",chars:"ⓓｄḋďḍḑḓḏđƌɖɗƋᏧԁꞪ"},{base:"dh",chars:"ð"},{base:"dz",chars:"ǳǆ"},{base:"e",chars:"ⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇǝ"},{base:"f",chars:"ⓕｆḟƒ"},{base:"ff",chars:"ﬀ"},{base:"fi",chars:"ﬁ"},{base:"fl",chars:"ﬂ"},{base:"ffi",chars:"ﬃ"},{base:"ffl",chars:"ﬄ"},{base:"g",chars:"ⓖｇǵĝḡğġǧģǥɠꞡꝿᵹ"},{base:"h",chars:"ⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",chars:"ƕ"},{base:"i",chars:"ⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",chars:"ⓙｊĵǰɉ"},{base:"k",chars:"ⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",chars:"ⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇɭ"},{base:"lj",chars:"ǉ"},{base:"m",chars:"ⓜｍḿṁṃɱɯ"},{base:"n",chars:"ⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥлԉ"},{base:"nj",chars:"ǌ"},{base:"o",chars:"ⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿꝋꝍɵɔᴑ"},{base:"oe",chars:"œ"},{base:"oi",chars:"ƣ"},{base:"oo",chars:"ꝏ"},{base:"ou",chars:"ȣ"},{base:"p",chars:"ⓟｐṕṗƥᵽꝑꝓꝕρ"},{base:"q",chars:"ⓠｑɋꝗꝙ"},{base:"r",chars:"ⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",chars:"ⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛʂ"},{base:"ss",chars:"ß"},{base:"t",chars:"ⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"th",chars:"þ"},{base:"tz",chars:"ꜩ"},{base:"u",chars:"ⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",chars:"ⓥｖṽṿʋꝟʌ"},{base:"vy",chars:"ꝡ"},{base:"w",chars:"ⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",chars:"ⓧｘẋẍ"},{base:"y",chars:"ⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",chars:"ⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],n={},r=0;r<a.length;r+=1)for(var i=a[r].chars,o=0;o<i.length;o+=1)n[i[o]]=a[r].base;t.replacementList=a,t.diacriticsMap=n},1304:function(e){e.exports=JSON.parse('{"locale":"en","countries":{"AF":"Afghanistan","AL":"Albania","DZ":"Algeria","AS":"American Samoa","AD":"Andorra","AO":"Angola","AI":"Anguilla","AQ":"Antarctica","AG":"Antigua and Barbuda","AR":"Argentina","AM":"Armenia","AW":"Aruba","AU":"Australia","AT":"Austria","AZ":"Azerbaijan","BS":"Bahamas","BH":"Bahrain","BD":"Bangladesh","BB":"Barbados","BY":"Belarus","BE":"Belgium","BZ":"Belize","BJ":"Benin","BM":"Bermuda","BT":"Bhutan","BO":"Bolivia","BA":"Bosnia and Herzegovina","BW":"Botswana","BV":"Bouvet Island","BR":"Brazil","IO":"British Indian Ocean Territory","BN":"Brunei Darussalam","BG":"Bulgaria","BF":"Burkina Faso","BI":"Burundi","KH":"Cambodia","CM":"Cameroon","CA":"Canada","CV":"Cape Verde","KY":"Cayman Islands","CF":"Central African Republic","TD":"Chad","CL":"Chile","CN":"China","CX":"Christmas Island","CC":"Cocos (Keeling) Islands","CO":"Colombia","KM":"Comoros","CG":"Congo","CD":"Congo, the Democratic Republic of the","CK":"Cook Islands","CR":"Costa Rica","CI":"Cote D\'Ivoire","HR":"Croatia","CU":"Cuba","CY":"Cyprus","CZ":"Czech Republic","DK":"Denmark","DJ":"Djibouti","DM":"Dominica","DO":"Dominican Republic","EC":"Ecuador","EG":"Egypt","SV":"El Salvador","GQ":"Equatorial Guinea","ER":"Eritrea","EE":"Estonia","ET":"Ethiopia","FK":"Falkland Islands (Malvinas)","FO":"Faroe Islands","FJ":"Fiji","FI":"Finland","FR":"France","GF":"French Guiana","PF":"French Polynesia","TF":"French Southern Territories","GA":"Gabon","GM":"Gambia","GE":"Georgia","DE":"Germany","GH":"Ghana","GI":"Gibraltar","GR":"Greece","GL":"Greenland","GD":"Grenada","GP":"Guadeloupe","GU":"Guam","GT":"Guatemala","GN":"Guinea","GW":"Guinea-Bissau","GY":"Guyana","HT":"Haiti","HM":"Heard Island and Mcdonald Islands","VA":"Holy See (Vatican City State)","HN":"Honduras","HK":"Hong Kong","HU":"Hungary","IS":"Iceland","IN":"India","ID":"Indonesia","IR":"Iran, Islamic Republic of","IQ":"Iraq","IE":"Ireland","IL":"Israel","IT":"Italy","JM":"Jamaica","JP":"Japan","JO":"Jordan","KZ":"Kazakhstan","KE":"Kenya","KI":"Kiribati","KP":"North Korea","KR":"South Korea","KW":"Kuwait","KG":"Kyrgyzstan","LA":"Lao People\'s Democratic Republic","LV":"Latvia","LB":"Lebanon","LS":"Lesotho","LR":"Liberia","LY":"Libya","LI":"Liechtenstein","LT":"Lithuania","LU":"Luxembourg","MO":"Macao","MG":"Madagascar","MW":"Malawi","MY":"Malaysia","MV":"Maldives","ML":"Mali","MT":"Malta","MH":"Marshall Islands","MQ":"Martinique","MR":"Mauritania","MU":"Mauritius","YT":"Mayotte","MX":"Mexico","FM":"Micronesia, Federated States of","MD":"Moldova, Republic of","MC":"Monaco","MN":"Mongolia","MS":"Montserrat","MA":"Morocco","MZ":"Mozambique","MM":"Myanmar","NA":"Namibia","NR":"Nauru","NP":"Nepal","NL":"Netherlands","NC":"New Caledonia","NZ":"New Zealand","NI":"Nicaragua","NE":"Niger","NG":"Nigeria","NU":"Niue","NF":"Norfolk Island","MK":"North Macedonia, Republic of","MP":"Northern Mariana Islands","NO":"Norway","OM":"Oman","PK":"Pakistan","PW":"Palau","PS":"Palestinian Territory, Occupied","PA":"Panama","PG":"Papua New Guinea","PY":"Paraguay","PE":"Peru","PH":"Philippines","PN":"Pitcairn","PL":"Poland","PT":"Portugal","PR":"Puerto Rico","QA":"Qatar","RE":"Reunion","RO":"Romania","RU":"Russian Federation","RW":"Rwanda","SH":"Saint Helena","KN":"Saint Kitts and Nevis","LC":"Saint Lucia","PM":"Saint Pierre and Miquelon","VC":"Saint Vincent and the Grenadines","WS":"Samoa","SM":"San Marino","ST":"Sao Tome and Principe","SA":"Saudi Arabia","SN":"Senegal","SC":"Seychelles","SL":"Sierra Leone","SG":"Singapore","SK":"Slovakia","SI":"Slovenia","SB":"Solomon Islands","SO":"Somalia","ZA":"South Africa","GS":"South Georgia and the South Sandwich Islands","ES":"Spain","LK":"Sri Lanka","SD":"Sudan","SR":"Suriname","SJ":"Svalbard and Jan Mayen","SZ":"Swaziland","SE":"Sweden","CH":"Switzerland","SY":"Syrian Arab Republic","TW":"Taiwan","TJ":"Tajikistan","TZ":"Tanzania, United Republic of","TH":"Thailand","TL":"Timor-Leste","TG":"Togo","TK":"Tokelau","TO":"Tonga","TT":"Trinidad and Tobago","TN":"Tunisia","TR":"Turkey","TM":"Turkmenistan","TC":"Turks and Caicos Islands","TV":"Tuvalu","UG":"Uganda","UA":"Ukraine","AE":"United Arab Emirates","GB":"United Kingdom","US":"United States of America","UM":"United States Minor Outlying Islands","UY":"Uruguay","UZ":"Uzbekistan","VU":"Vanuatu","VE":"Venezuela","VN":"Viet Nam","VG":"Virgin Islands, British","VI":"Virgin Islands, U.S.","WF":"Wallis and Futuna","EH":"Western Sahara","YE":"Yemen","ZM":"Zambia","ZW":"Zimbabwe","AX":"Åland Islands","BQ":"Bonaire, Sint Eustatius and Saba","CW":"Curaçao","GG":"Guernsey","IM":"Isle of Man","JE":"Jersey","ME":"Montenegro","BL":"Saint Barthélemy","MF":"Saint Martin (French part)","RS":"Serbia","SX":"Sint Maarten (Dutch part)","SS":"South Sudan","XK":"Kosovo"}}')},1305:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showOnlyThreatIndicatorAlerts",{defaultMessage:"Show only threat indicator alerts"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"})},1306:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=a(66),i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])},i(e,t)};function o(e,t){function a(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}var s=function(){return s=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)},l={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},c={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},u={width:"20px",height:"20px",position:"absolute"},d={top:s(s({},l),{top:"-5px"}),right:s(s({},c),{left:void 0,right:"-5px"}),bottom:s(s({},l),{top:void 0,bottom:"-5px"}),left:s(s({},c),{left:"-5px"}),topRight:s(s({},u),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:s(s({},u),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:s(s({},u),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:s(s({},u),{left:"-10px",top:"-10px",cursor:"nw-resize"})},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return o(t,e),t.prototype.render=function(){return n.createElement("div",{className:this.props.className||"",style:s(s({position:"absolute",userSelect:"none"},d[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(n.PureComponent),m={width:"auto",height:"auto"},y=function(e,t,a){return Math.max(Math.min(e,a),t)},g=function(e,t){return Math.round(e/t)*t},f=function(e,t){return new RegExp(e,"i").test(t)},b=function(e){return Boolean(e.touches&&e.touches.length)},h=function(e,t,a){void 0===a&&(a=0);var n=t.reduce((function(a,n,r){return Math.abs(n-e)<Math.abs(t[a]-e)?r:a}),0),r=Math.abs(t[n]-e);return 0===a||r<a?t[n]:e},v=function(e){return"auto"===(e=e.toString())||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},E=function(e,t,a,n){if(e&&"string"==typeof e){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%"))return t*(Number(e.replace("%",""))/100);if(e.endsWith("vw"))return a*(Number(e.replace("vw",""))/100);if(e.endsWith("vh"))return n*(Number(e.replace("vh",""))/100)}return e},x=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],k="__resizable_base__",w=function(e){function t(t){var a=e.call(this,t)||this;return a.ratio=1,a.resizable=null,a.parentLeft=0,a.parentTop=0,a.resizableLeft=0,a.resizableRight=0,a.resizableTop=0,a.resizableBottom=0,a.targetLeft=0,a.targetTop=0,a.appendBase=function(){if(!a.resizable||!a.window)return null;var e=a.parentNode;if(!e)return null;var t=a.window.document.createElement("div");return t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0 0 100%",t.classList?t.classList.add(k):t.className+=k,e.appendChild(t),t},a.removeBase=function(e){var t=a.parentNode;t&&t.removeChild(e)},a.ref=function(e){e&&(a.resizable=e)},a.state={isResizing:!1,width:void 0===(a.propsSize&&a.propsSize.width)?"auto":a.propsSize&&a.propsSize.width,height:void 0===(a.propsSize&&a.propsSize.height)?"auto":a.propsSize&&a.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},a.onResizeStart=a.onResizeStart.bind(a),a.onMouseMove=a.onMouseMove.bind(a),a.onMouseUp=a.onMouseUp.bind(a),a}return o(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||m},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var a=this.resizable.offsetWidth,n=this.resizable.offsetHeight,r=this.resizable.style.position;"relative"!==r&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:a,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:n,this.resizable.style.position=r}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,a=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&e.propsSize[t].toString().endsWith("%")){if(e.state[t].toString().endsWith("%"))return e.state[t].toString();var a=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/a[t]*100+"%"}return v(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?v(t.width):a("width"),height:t&&void 0!==t.height&&!this.state.isResizing?v(t.height):a("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,a=this.parentNode.style.flexWrap;"wrap"!==a&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var n={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=a),this.removeBase(e),n},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(e,t){var a=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==a&&"auto"!==a?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){var a,n,r=this.props.boundsByDirection,i=this.state.direction,o=r&&f("left",i),s=r&&f("top",i);if("parent"===this.props.bounds){var l=this.parentNode;l&&(a=o?this.resizableRight-this.parentLeft:l.offsetWidth+(this.parentLeft-this.resizableLeft),n=s?this.resizableBottom-this.parentTop:l.offsetHeight+(this.parentTop-this.resizableTop))}else"window"===this.props.bounds?this.window&&(a=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,n=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(a=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),n=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return a&&Number.isFinite(a)&&(e=e&&e<a?e:a),n&&Number.isFinite(n)&&(t=t&&t<n?t:n),{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var a=this.props.scale||1,n=this.props.resizeRatio||1,r=this.state,i=r.direction,o=r.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=o.width,p=o.height,m=c||0,y=u||0;return f("right",i)&&(d=o.width+(e-o.x)*n/a,l&&(p=(d-y)/this.ratio+m)),f("left",i)&&(d=o.width-(e-o.x)*n/a,l&&(p=(d-y)/this.ratio+m)),f("bottom",i)&&(p=o.height+(t-o.y)*n/a,l&&(d=(p-m)*this.ratio+y)),f("top",i)&&(p=o.height-(t-o.y)*n/a,l&&(d=(p-m)*this.ratio+y)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,a,n){var r=this.props,i=r.lockAspectRatio,o=r.lockAspectRatioExtraHeight,s=r.lockAspectRatioExtraWidth,l=void 0===n.width?10:n.width,c=void 0===a.width||a.width<0?e:a.width,u=void 0===n.height?10:n.height,d=void 0===a.height||a.height<0?t:a.height,p=o||0,m=s||0;if(i){var g=(u-p)*this.ratio+m,f=(d-p)*this.ratio+m,b=(l-m)/this.ratio+p,h=(c-m)/this.ratio+p,v=Math.max(l,g),E=Math.min(c,f),x=Math.max(u,b),k=Math.min(d,h);e=y(e,v,E),t=y(t,x,k)}else e=y(e,l,c),t=y(t,u,d);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var a=this.props.bounds.getBoundingClientRect();this.targetLeft=a.left,this.targetTop=a.top}if(this.resizable){var n=this.resizable.getBoundingClientRect(),r=n.left,i=n.top,o=n.right,s=n.bottom;this.resizableLeft=r,this.resizableRight=o,this.resizableTop=i,this.resizableBottom=s}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var a,n=0,r=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)?(n=e.nativeEvent.clientX,r=e.nativeEvent.clientY):e.nativeEvent&&b(e.nativeEvent)&&(n=e.nativeEvent.touches[0].clientX,r=e.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var i=this.window.getComputedStyle(this.resizable);if("auto"!==i.flexBasis){var o=this.parentNode;if(o){var l=this.window.getComputedStyle(o).flexDirection;this.flexDir=l.startsWith("row")?"row":"column",a=i.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var c={original:{x:n,y:r,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:a};this.setState(c)}},t.prototype.onMouseMove=function(e){var t=this;if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&b(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var a=this.props,n=a.maxWidth,i=a.maxHeight,o=a.minWidth,s=a.minHeight,l=b(e)?e.touches[0].clientX:e.clientX,c=b(e)?e.touches[0].clientY:e.clientY,u=this.state,d=u.direction,p=u.original,m=u.width,y=u.height,f=this.getParentSize(),v=function(e,t,a,n,r,i,o){return n=E(n,e.width,t,a),r=E(r,e.height,t,a),i=E(i,e.width,t,a),o=E(o,e.height,t,a),{maxWidth:void 0===n?void 0:Number(n),maxHeight:void 0===r?void 0:Number(r),minWidth:void 0===i?void 0:Number(i),minHeight:void 0===o?void 0:Number(o)}}(f,this.window.innerWidth,this.window.innerHeight,n,i,o,s);n=v.maxWidth,i=v.maxHeight,o=v.minWidth,s=v.minHeight;var x=this.calculateNewSizeFromDirection(l,c),k=x.newHeight,w=x.newWidth,S=this.calculateNewMaxFromBoundary(n,i);this.props.snap&&this.props.snap.x&&(w=h(w,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(k=h(k,this.props.snap.y,this.props.snapGap));var j=this.calculateNewSizeFromAspectRatio(w,k,{width:S.maxWidth,height:S.maxHeight},{width:o,height:s});if(w=j.newWidth,k=j.newHeight,this.props.grid){var O=g(w,this.props.grid[0]),I=g(k,this.props.grid[1]),C=this.props.snapGap||0;w=0===C||Math.abs(O-w)<=C?O:w,k=0===C||Math.abs(I-k)<=C?I:k}var T={width:w-p.width,height:k-p.height};m&&"string"==typeof m&&(m.endsWith("%")?w=w/f.width*100+"%":m.endsWith("vw")?w=w/this.window.innerWidth*100+"vw":m.endsWith("vh")&&(w=w/this.window.innerHeight*100+"vh")),y&&"string"==typeof y&&(y.endsWith("%")?k=k/f.height*100+"%":y.endsWith("vw")?k=k/this.window.innerWidth*100+"vw":y.endsWith("vh")&&(k=k/this.window.innerHeight*100+"vh"));var M={width:this.createSizeForCssProperty(w,"width"),height:this.createSizeForCssProperty(k,"height")};"row"===this.flexDir?M.flexBasis=M.width:"column"===this.flexDir&&(M.flexBasis=M.height),r.flushSync((function(){t.setState(M)})),this.props.onResize&&this.props.onResize(e,d,this.resizable,T)}},t.prototype.onMouseUp=function(e){var t=this.state,a=t.isResizing,n=t.direction,r=t.original;if(a&&this.resizable){var i={width:this.size.width-r.width,height:this.size.height-r.height};this.props.onResizeStop&&this.props.onResizeStop(e,n,this.resizable,i),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,a=t.enable,r=t.handleStyles,i=t.handleClasses,o=t.handleWrapperStyle,s=t.handleWrapperClass,l=t.handleComponent;if(!a)return null;var c=Object.keys(a).map((function(t){return!1!==a[t]?n.createElement(p,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:r&&r[t],className:i&&i[t]},l&&l[t]?l[t]:null):null}));return n.createElement("div",{className:s,style:o},c)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,a){return-1!==x.indexOf(a)||(t[a]=e.props[a]),t}),{}),a=s(s(s({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(a.flexBasis=this.state.flexBasis);var r=this.props.as||"div";return n.createElement(r,s({ref:this.ref,style:a,className:this.props.className},t),this.state.isResizing&&n.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(n.PureComponent);t.Resizable=w},1307:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);const r=e=>JSON.stringify(e),i=({pageIndex:e,pageSize:t})=>{const[a,i]=Object(n.useState)({}),o=Object(n.useCallback)((n=>{i({...a,[r({pageIndex:e+1,pageSize:t})]:n})}),[e,t]);let s;for(let n=e;n>=0&&(s=a[r({pageIndex:n,pageSize:t})],!s);n--);return[s,o]}},1308:function(e,t,a){"use strict";e.exports=a(1309)},1309:function(e,t,a){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var r=n(a(1310)),i=n(a(1373)),o=n(a(1311)),s=a(2),l=n(a(719)),c=n(a(1312)),u=n(a(1372)),d=n(a(1375)),p=n(a(1313));function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function y(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function g(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)t.indexOf(a=i[n])>=0||(r[a]=e[a]);return r}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var b=s.createContext(void 0);b.displayName="FormikContext";var h=b.Provider,v=b.Consumer;function E(){var e=s.useContext(b);return e||c(!1),e}var x=function(e){return Array.isArray(e)&&0===e.length},k=function(e){return"function"==typeof e},w=function(e){return null!==e&&"object"==typeof e},S=function(e){return String(Math.floor(Number(e)))===e},j=function(e){return"[object String]"===Object.prototype.toString.call(e)},O=function(e){return 0===s.Children.count(e)},I=function(e){return w(e)&&k(e.then)};function C(e,t,a,n){void 0===n&&(n=0);for(var r=d(t);e&&n<r.length;)e=e[r[n++]];return n===r.length||e?void 0===e?a:e:a}function T(e,t,a){for(var n=u(e),r=n,i=0,o=d(t);i<o.length-1;i++){var s=o[i],l=C(e,o.slice(0,i+1));if(l&&(w(l)||Array.isArray(l)))r=r[s]=u(l);else{var c=o[i+1];r=r[s]=S(c)&&Number(c)>=0?[]:{}}}return(0===i?e:r)[o[i]]===a?e:(void 0===a?delete r[o[i]]:r[o[i]]=a,0===i&&void 0===a&&delete n[o[i]],n)}function M(e,t,a,n){void 0===a&&(a=new WeakMap),void 0===n&&(n={});for(var r=0,i=Object.keys(e);r<i.length;r++){var o=i[r],s=e[o];w(s)?a.get(s)||(a.set(s,!0),n[o]=Array.isArray(s)?[]:{},M(s,t,a,n[o])):n[o]=t}return n}var _={},N={};function D(e){var t=e.validateOnChange,a=void 0===t||t,n=e.validateOnBlur,i=void 0===n||n,c=e.validateOnMount,u=void 0!==c&&c,d=e.isInitialValid,p=e.enableReinitialize,y=void 0!==p&&p,f=e.onSubmit,b=g(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),h=m({validateOnChange:a,validateOnBlur:i,validateOnMount:u,onSubmit:f},b),v=s.useRef(h.initialValues),E=s.useRef(h.initialErrors||_),x=s.useRef(h.initialTouched||N),S=s.useRef(h.initialStatus),O=s.useRef(!1),D=s.useRef({});s.useEffect((function(){return O.current=!0,function(){O.current=!1}}),[]);var A=s.useState(0)[1],L=s.useRef({values:o(h.initialValues),errors:o(h.initialErrors)||_,touched:o(h.initialTouched)||N,status:o(h.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),P=L.current,B=s.useCallback((function(e){var t=L.current;L.current=function(e,t){switch(t.type){case"SET_VALUES":return m({},e,{values:t.payload});case"SET_TOUCHED":return m({},e,{touched:t.payload});case"SET_ERRORS":return l(e.errors,t.payload)?e:m({},e,{errors:t.payload});case"SET_STATUS":return m({},e,{status:t.payload});case"SET_ISSUBMITTING":return m({},e,{isSubmitting:t.payload});case"SET_ISVALIDATING":return m({},e,{isValidating:t.payload});case"SET_FIELD_VALUE":return m({},e,{values:T(e.values,t.payload.field,t.payload.value)});case"SET_FIELD_TOUCHED":return m({},e,{touched:T(e.touched,t.payload.field,t.payload.value)});case"SET_FIELD_ERROR":return m({},e,{errors:T(e.errors,t.payload.field,t.payload.value)});case"RESET_FORM":return m({},e,t.payload);case"SET_FORMIK_STATE":return t.payload(e);case"SUBMIT_ATTEMPT":return m({},e,{touched:M(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":case"SUBMIT_SUCCESS":return m({},e,{isSubmitting:!1});default:return e}}(t,e),t!==L.current&&A((function(e){return e+1}))}),[]),$=s.useCallback((function(e,t){return new Promise((function(a,n){var r=h.validate(e,t);null==r?a(_):I(r)?r.then((function(e){a(e||_)}),(function(e){n(e)})):a(r)}))}),[h.validate]),G=s.useCallback((function(e,t){var a=h.validationSchema,n=k(a)?a(t):a,r=t&&n.validateAt?n.validateAt(t,e):q(e,n);return new Promise((function(e,t){r.then((function(){e(_)}),(function(a){"ValidationError"===a.name?e(F(a)):t(a)}))}))}),[h.validationSchema]),U=s.useCallback((function(e,t){return new Promise((function(a){return a(D.current[e].validate(t))}))}),[]),V=s.useCallback((function(e){var t=Object.keys(D.current).filter((function(e){return k(D.current[e].validate)})),a=t.length>0?t.map((function(t){return U(t,C(e,t))})):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(a).then((function(e){return e.reduce((function(e,a,n){return"DO_NOT_DELETE_YOU_WILL_BE_FIRED"===a||a&&(e=T(e,t[n],a)),e}),{})}))}),[U]),H=s.useCallback((function(e){return Promise.all([V(e),h.validationSchema?G(e):{},h.validate?$(e):{}]).then((function(e){return r.all([e[0],e[1],e[2]],{arrayMerge:R})}))}),[h.validate,h.validationSchema,V,$,G]),W=z((function(e){return void 0===e&&(e=P.values),B({type:"SET_ISVALIDATING",payload:!0}),H(e).then((function(e){return O.current&&(B({type:"SET_ISVALIDATING",payload:!1}),B({type:"SET_ERRORS",payload:e})),e}))}));s.useEffect((function(){u&&!0===O.current&&l(v.current,h.initialValues)&&W(v.current)}),[u,W]);var Y=s.useCallback((function(e){var t=e&&e.values?e.values:v.current,a=e&&e.errors?e.errors:E.current?E.current:h.initialErrors||{},n=e&&e.touched?e.touched:x.current?x.current:h.initialTouched||{},r=e&&e.status?e.status:S.current?S.current:h.initialStatus;v.current=t,E.current=a,x.current=n,S.current=r;var i=function(){B({type:"RESET_FORM",payload:{isSubmitting:!!e&&!!e.isSubmitting,errors:a,touched:n,status:r,values:t,isValidating:!!e&&!!e.isValidating,submitCount:e&&e.submitCount&&"number"==typeof e.submitCount?e.submitCount:0}})};if(h.onReset){var o=h.onReset(P.values,me);I(o)?o.then(i):i()}else i()}),[h.initialErrors,h.initialStatus,h.initialTouched,h.onReset]);s.useEffect((function(){!0!==O.current||l(v.current,h.initialValues)||y&&(v.current=h.initialValues,Y(),u&&W(v.current))}),[y,h.initialValues,Y,u,W]),s.useEffect((function(){y&&!0===O.current&&!l(E.current,h.initialErrors)&&(E.current=h.initialErrors||_,B({type:"SET_ERRORS",payload:h.initialErrors||_}))}),[y,h.initialErrors]),s.useEffect((function(){y&&!0===O.current&&!l(x.current,h.initialTouched)&&(x.current=h.initialTouched||N,B({type:"SET_TOUCHED",payload:h.initialTouched||N}))}),[y,h.initialTouched]),s.useEffect((function(){y&&!0===O.current&&!l(S.current,h.initialStatus)&&(S.current=h.initialStatus,B({type:"SET_STATUS",payload:h.initialStatus}))}),[y,h.initialStatus,h.initialTouched]);var Z=z((function(e){if(D.current[e]&&k(D.current[e].validate)){var t=C(P.values,e),a=D.current[e].validate(t);return I(a)?(B({type:"SET_ISVALIDATING",payload:!0}),a.then((function(e){return e})).then((function(t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:t}}),B({type:"SET_ISVALIDATING",payload:!1})}))):(B({type:"SET_FIELD_ERROR",payload:{field:e,value:a}}),Promise.resolve(a))}return h.validationSchema?(B({type:"SET_ISVALIDATING",payload:!0}),G(P.values,e).then((function(e){return e})).then((function(t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:C(t,e)}}),B({type:"SET_ISVALIDATING",payload:!1})}))):Promise.resolve()})),K=s.useCallback((function(e,t){D.current[e]={validate:t.validate}}),[]),Q=s.useCallback((function(e){delete D.current[e]}),[]),X=z((function(e,t){return B({type:"SET_TOUCHED",payload:e}),(void 0===t?i:t)?W(P.values):Promise.resolve()})),J=s.useCallback((function(e){B({type:"SET_ERRORS",payload:e})}),[]),ee=z((function(e,t){var n=k(e)?e(P.values):e;return B({type:"SET_VALUES",payload:n}),(void 0===t?a:t)?W(n):Promise.resolve()})),te=s.useCallback((function(e,t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:t}})}),[]),ae=z((function(e,t,n){return B({type:"SET_FIELD_VALUE",payload:{field:e,value:t}}),(void 0===n?a:n)?W(T(P.values,e,t)):Promise.resolve()})),ne=s.useCallback((function(e,t){var a,n=t,r=e;if(!j(e)){e.persist&&e.persist();var i=e.target?e.target:e.currentTarget,o=i.type,s=i.value,l=i.checked,c=i.options,u=i.multiple;n=t||i.name||i.id,r=/number|range/.test(o)?(a=parseFloat(s),isNaN(a)?"":a):/checkbox/.test(o)?function(e,t,a){if("boolean"==typeof e)return Boolean(t);var n=[],r=!1,i=-1;if(Array.isArray(e))n=e,r=(i=e.indexOf(a))>=0;else if(!a||"true"==a||"false"==a)return Boolean(t);return t&&a&&!r?n.concat(a):r?n.slice(0,i).concat(n.slice(i+1)):n}(C(P.values,n),l,s):c&&u?function(e){return Array.from(e).filter((function(e){return e.selected})).map((function(e){return e.value}))}(c):s}n&&ae(n,r)}),[ae,P.values]),re=z((function(e){if(j(e))return function(t){return ne(t,e)};ne(e)})),ie=z((function(e,t,a){return void 0===t&&(t=!0),B({type:"SET_FIELD_TOUCHED",payload:{field:e,value:t}}),(void 0===a?i:a)?W(P.values):Promise.resolve()})),oe=s.useCallback((function(e,t){e.persist&&e.persist();var a=e.target;ie(t||a.name||a.id,!0)}),[ie]),se=z((function(e){if(j(e))return function(t){return oe(t,e)};oe(e)})),le=s.useCallback((function(e){k(e)?B({type:"SET_FORMIK_STATE",payload:e}):B({type:"SET_FORMIK_STATE",payload:function(){return e}})}),[]),ce=s.useCallback((function(e){B({type:"SET_STATUS",payload:e})}),[]),ue=s.useCallback((function(e){B({type:"SET_ISSUBMITTING",payload:e})}),[]),de=z((function(){return B({type:"SUBMIT_ATTEMPT"}),W().then((function(e){var t=e instanceof Error;if(!t&&0===Object.keys(e).length){var a;try{if(void 0===(a=ye()))return}catch(e){throw e}return Promise.resolve(a).then((function(e){return O.current&&B({type:"SUBMIT_SUCCESS"}),e})).catch((function(e){if(O.current)throw B({type:"SUBMIT_FAILURE"}),e}))}if(O.current&&(B({type:"SUBMIT_FAILURE"}),t))throw e}))})),pe=z((function(e){e&&e.preventDefault&&k(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&k(e.stopPropagation)&&e.stopPropagation(),de().catch((function(e){console.warn("Warning: An unhandled error was caught from submitForm()",e)}))})),me={resetForm:Y,validateForm:W,validateField:Z,setErrors:J,setFieldError:te,setFieldTouched:ie,setFieldValue:ae,setStatus:ce,setSubmitting:ue,setTouched:X,setValues:ee,setFormikState:le,submitForm:de},ye=z((function(){return f(P.values,me)})),ge=z((function(e){e&&e.preventDefault&&k(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&k(e.stopPropagation)&&e.stopPropagation(),Y()})),fe=s.useCallback((function(e){return{value:C(P.values,e),error:C(P.errors,e),touched:!!C(P.touched,e),initialValue:C(v.current,e),initialTouched:!!C(x.current,e),initialError:C(E.current,e)}}),[P.errors,P.touched,P.values]),be=s.useCallback((function(e){return{setValue:function(t,a){return ae(e,t,a)},setTouched:function(t,a){return ie(e,t,a)},setError:function(t){return te(e,t)}}}),[ae,ie,te]),he=s.useCallback((function(e){var t=w(e),a=t?e.name:e,n=C(P.values,a),r={name:a,value:n,onChange:re,onBlur:se};if(t){var i=e.type,o=e.value,s=e.as,l=e.multiple;"checkbox"===i?void 0===o?r.checked=!!n:(r.checked=!(!Array.isArray(n)||!~n.indexOf(o)),r.value=o):"radio"===i?(r.checked=n===o,r.value=o):"select"===s&&l&&(r.value=r.value||[],r.multiple=!0)}return r}),[se,re,P.values]),ve=s.useMemo((function(){return!l(v.current,P.values)}),[v.current,P.values]),Ee=s.useMemo((function(){return void 0!==d?ve?P.errors&&0===Object.keys(P.errors).length:!1!==d&&k(d)?d(h):d:P.errors&&0===Object.keys(P.errors).length}),[d,ve,P.errors,h]);return m({},P,{initialValues:v.current,initialErrors:E.current,initialTouched:x.current,initialStatus:S.current,handleBlur:se,handleChange:re,handleReset:ge,handleSubmit:pe,resetForm:Y,setErrors:J,setFormikState:le,setFieldTouched:ie,setFieldValue:ae,setFieldError:te,setStatus:ce,setSubmitting:ue,setTouched:X,setValues:ee,submitForm:de,validateForm:W,validateField:Z,isValid:Ee,dirty:ve,unregisterField:Q,registerField:K,getFieldProps:he,getFieldMeta:fe,getFieldHelpers:be,validateOnBlur:i,validateOnChange:a,validateOnMount:u})}function A(e){var t=D(e),a=e.component,n=e.children,r=e.render;return s.useImperativeHandle(e.innerRef,(function(){return t})),s.createElement(h,{value:t},a?s.createElement(a,t):r?r(t):n?k(n)?n(t):O(n)?null:s.Children.only(n):null)}function F(e){var t={};if(e.inner){if(0===e.inner.length)return T(t,e.path,e.message);var a=e.inner,n=Array.isArray(a),r=0;for(a=n?a:a[Symbol.iterator]();;){var i;if(n){if(r>=a.length)break;i=a[r++]}else{if((r=a.next()).done)break;i=r.value}var o=i;C(t,o.path)||(t=T(t,o.path,o.message))}}return t}function q(e,t,a,n){void 0===a&&(a=!1);var r=L(e);return t[a?"validateSync":"validate"](r,{abortEarly:!1,context:n||r})}function L(e){var t=Array.isArray(e)?[]:{};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=String(a);t[n]=!0===Array.isArray(e[n])?e[n].map((function(e){return!0===Array.isArray(e)||i(e)?L(e):""!==e?e:void 0})):i(e[n])?L(e[n]):""!==e[n]?e[n]:void 0}return t}function R(e,t,a){var n=e.slice();return t.forEach((function(t,i){if(void 0===n[i]){var o=!1!==a.clone&&a.isMergeableObject(t);n[i]=o?r(Array.isArray(t)?[]:{},t,a):t}else a.isMergeableObject(t)?n[i]=r(e[i],t,a):-1===e.indexOf(t)&&n.push(t)})),n}var P="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?s.useLayoutEffect:s.useEffect;function z(e){var t=s.useRef(e);return P((function(){t.current=e})),s.useCallback((function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return t.current.apply(void 0,a)}),[])}var B=s.forwardRef((function(e,t){var a=e.action,n=g(e,["action"]),r=null!=a?a:"#",i=E();return s.createElement("form",m({onSubmit:i.handleSubmit,ref:t,onReset:i.handleReset,action:r},n))}));function $(e){var t=function(t){return s.createElement(v,null,(function(a){return a||c(!1),s.createElement(e,m({},t,{formik:a}))}))},a=e.displayName||e.name||e.constructor&&e.constructor.name||"Component";return t.WrappedComponent=e,t.displayName="FormikConnect("+a+")",p(t,e)}B.displayName="Form";var G=function(e,t,a){var n=W(e),r=n[t];return n.splice(t,1),n.splice(a,0,r),n},U=function(e,t,a){var n=W(e),r=n[t];return n[t]=n[a],n[a]=r,n},V=function(e,t,a){var n=W(e);return n.splice(t,0,a),n},H=function(e,t,a){var n=W(e);return n[t]=a,n},W=function(e){if(e){if(Array.isArray(e))return[].concat(e);var t=Object.keys(e).map((function(e){return parseInt(e)})).reduce((function(e,t){return t>e?t:e}),0);return Array.from(m({},e,{length:t+1}))}return[]},Y=function(e,t){var a="function"==typeof e?e:t;return function(e){if(Array.isArray(e)||w(e)){var t=W(e);return a(t)}return e}},Z=function(e){function t(t){var a;return(a=e.call(this,t)||this).updateArrayField=function(e,t,n){var r=a.props,i=r.name;(0,r.formik.setFormikState)((function(a){var r=Y(n,e),o=Y(t,e),s=T(a.values,i,e(C(a.values,i))),l=n?r(C(a.errors,i)):void 0,c=t?o(C(a.touched,i)):void 0;return x(l)&&(l=void 0),x(c)&&(c=void 0),m({},a,{values:s,errors:n?T(a.errors,i,l):a.errors,touched:t?T(a.touched,i,c):a.touched})}))},a.push=function(e){return a.updateArrayField((function(t){return[].concat(W(t),[o(e)])}),!1,!1)},a.handlePush=function(e){return function(){return a.push(e)}},a.swap=function(e,t){return a.updateArrayField((function(a){return U(a,e,t)}),!0,!0)},a.handleSwap=function(e,t){return function(){return a.swap(e,t)}},a.move=function(e,t){return a.updateArrayField((function(a){return G(a,e,t)}),!0,!0)},a.handleMove=function(e,t){return function(){return a.move(e,t)}},a.insert=function(e,t){return a.updateArrayField((function(a){return V(a,e,t)}),(function(t){return V(t,e,null)}),(function(t){return V(t,e,null)}))},a.handleInsert=function(e,t){return function(){return a.insert(e,t)}},a.replace=function(e,t){return a.updateArrayField((function(a){return H(a,e,t)}),!1,!1)},a.handleReplace=function(e,t){return function(){return a.replace(e,t)}},a.unshift=function(e){var t=-1;return a.updateArrayField((function(a){var n=a?[e].concat(a):[e];return t=n.length,n}),(function(e){return e?[null].concat(e):[null]}),(function(e){return e?[null].concat(e):[null]})),t},a.handleUnshift=function(e){return function(){return a.unshift(e)}},a.handleRemove=function(e){return function(){return a.remove(e)}},a.handlePop=function(){return function(){return a.pop()}},a.remove=a.remove.bind(f(a)),a.pop=a.pop.bind(f(a)),a}y(t,e);var a=t.prototype;return a.componentDidUpdate=function(e){this.props.validateOnChange&&this.props.formik.validateOnChange&&!l(C(e.formik.values,e.name),C(this.props.formik.values,this.props.name))&&this.props.formik.validateForm(this.props.formik.values)},a.remove=function(e){var t;return this.updateArrayField((function(a){var n=a?W(a):[];return t||(t=n[e]),k(n.splice)&&n.splice(e,1),k(n.every)&&n.every((function(e){return void 0===e}))?[]:n}),!0,!0),t},a.pop=function(){var e;return this.updateArrayField((function(t){var a=t.slice();return e||(e=a&&a.pop&&a.pop()),a}),!0,!0),e},a.render=function(){var e=this.props,t=e.component,a=e.render,n=e.children,r=e.name,i=m({},{push:this.push,pop:this.pop,swap:this.swap,move:this.move,insert:this.insert,replace:this.replace,unshift:this.unshift,remove:this.remove,handlePush:this.handlePush,handlePop:this.handlePop,handleSwap:this.handleSwap,handleMove:this.handleMove,handleInsert:this.handleInsert,handleReplace:this.handleReplace,handleUnshift:this.handleUnshift,handleRemove:this.handleRemove},{form:g(e.formik,["validate","validationSchema"]),name:r});return t?s.createElement(t,i):a?a(i):n?"function"==typeof n?n(i):O(n)?null:s.Children.only(n):null},t}(s.Component);Z.defaultProps={validateOnChange:!0};var K=$(Z),Q=$(function(e){function t(){return e.apply(this,arguments)||this}y(t,e);var a=t.prototype;return a.shouldComponentUpdate=function(e){return C(this.props.formik.errors,this.props.name)!==C(e.formik.errors,this.props.name)||C(this.props.formik.touched,this.props.name)!==C(e.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(e).length},a.render=function(){var e=this.props,t=e.component,a=e.formik,n=e.render,r=e.children,i=e.name,o=g(e,["component","formik","render","children","name"]),l=C(a.touched,i),c=C(a.errors,i);return l&&c?n?k(n)?n(c):null:r?k(r)?r(c):null:t?s.createElement(t,o,c):c:null},t}(s.Component)),X=$(function(e){function t(t){var a;a=e.call(this,t)||this;var n=t.render,r=t.children,i=t.component,o=t.as;return n&&c(!1),i&&n&&c(!1),o&&r&&k(r)&&c(!1),i&&r&&k(r)&&c(!1),n&&r&&!O(r)&&c(!1),a}y(t,e);var a=t.prototype;return a.shouldComponentUpdate=function(e){return this.props.shouldUpdate?this.props.shouldUpdate(e,this.props):e.name!==this.props.name||C(e.formik.values,this.props.name)!==C(this.props.formik.values,this.props.name)||C(e.formik.errors,this.props.name)!==C(this.props.formik.errors,this.props.name)||C(e.formik.touched,this.props.name)!==C(this.props.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(e).length||e.formik.isSubmitting!==this.props.formik.isSubmitting},a.componentDidMount=function(){this.props.formik.registerField(this.props.name,{validate:this.props.validate})},a.componentDidUpdate=function(e){this.props.name!==e.name&&(this.props.formik.unregisterField(e.name),this.props.formik.registerField(this.props.name,{validate:this.props.validate})),this.props.validate!==e.validate&&this.props.formik.registerField(this.props.name,{validate:this.props.validate})},a.componentWillUnmount=function(){this.props.formik.unregisterField(this.props.name)},a.render=function(){var e=this.props,t=e.name,a=e.render,n=e.as,r=e.children,i=e.component,o=e.formik,l=g(e,["validate","name","render","as","children","component","shouldUpdate","formik"]),c=g(o,["validate","validationSchema"]),u=o.getFieldProps(m({name:t},l)),d={field:u,meta:{value:C(o.values,t),error:C(o.errors,t),touched:!!C(o.touched,t),initialValue:C(o.initialValues,t),initialTouched:!!C(o.initialTouched,t),initialError:C(o.initialErrors,t)},form:c};if(a)return a(d);if(k(r))return r(d);if(i){if("string"==typeof i){var p=l.innerRef,y=g(l,["innerRef"]);return s.createElement(i,m({ref:p},u,y),r)}return s.createElement(i,m({field:u,form:o},l),r)}var f=n||"input";if("string"==typeof f){var b=l.innerRef,h=g(l,["innerRef"]);return s.createElement(f,m({ref:b},u,h),r)}return s.createElement(f,m({},u,l),r)},t}(s.Component));t.ErrorMessage=Q,t.FastField=X,t.Field=function(e){var t=e.validate,a=e.name,n=e.render,r=e.children,i=e.as,o=e.component,l=e.className,c=g(e,["validate","name","render","children","as","component","className"]),u=g(E(),["validate","validationSchema"]),d=u.registerField,p=u.unregisterField;s.useEffect((function(){return d(a,{validate:t}),function(){p(a)}}),[d,p,a,t]);var y=u.getFieldProps(m({name:a},c)),f=u.getFieldMeta(a),b={field:y,form:u};if(n)return n(m({},b,{meta:f}));if(k(r))return r(m({},b,{meta:f}));if(o){if("string"==typeof o){var h=c.innerRef,v=g(c,["innerRef"]);return s.createElement(o,m({ref:h},y,v,{className:l}),r)}return s.createElement(o,m({field:y,form:u},c,{className:l}),r)}var x=i||"input";if("string"==typeof x){var w=c.innerRef,S=g(c,["innerRef"]);return s.createElement(x,m({ref:w},y,S,{className:l}),r)}return s.createElement(x,m({},y,c,{className:l}),r)},t.FieldArray=K,t.Form=B,t.Formik=A,t.FormikConsumer=v,t.FormikContext=b,t.FormikProvider=h,t.connect=$,t.getActiveElement=function(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}},t.getIn=C,t.insert=V,t.isEmptyArray=x,t.isEmptyChildren=O,t.isFunction=k,t.isInputEvent=function(e){return e&&w(e)&&w(e.target)},t.isInteger=S,t.isNaN=function(e){return e!=e},t.isObject=w,t.isPromise=I,t.isString=j,t.move=G,t.prepareDataForValidation=L,t.replace=H,t.setIn=T,t.setNestedObjectValues=M,t.swap=U,t.useField=function(e){var t=E(),a=t.getFieldProps,n=t.getFieldMeta,r=t.getFieldHelpers,i=t.registerField,o=t.unregisterField,l=w(e)?e:{name:e},u=l.name,d=l.validate;s.useEffect((function(){return u&&i(u,{validate:d}),function(){u&&o(u)}}),[i,o,u,d]),u||c(!1);var p=s.useMemo((function(){return r(u)}),[r,u]);return[a(l),n(u),p]},t.useFormik=D,t.useFormikContext=E,t.validateYupSchema=q,t.withFormik=function(e){var t=e.mapPropsToValues,a=void 0===t?function(e){var t={};for(var a in e)e.hasOwnProperty(a)&&"function"!=typeof e[a]&&(t[a]=e[a]);return t}:t,n=g(e,["mapPropsToValues"]);return function(e){var t=e.displayName||e.name||e.constructor&&e.constructor.name||"Component",r=function(t){function r(){for(var a,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(a=t.call.apply(t,[this].concat(i))||this).validate=function(e){return n.validate(e,a.props)},a.validationSchema=function(){return k(n.validationSchema)?n.validationSchema(a.props):n.validationSchema},a.handleSubmit=function(e,t){return n.handleSubmit(e,m({},t,{props:a.props}))},a.renderFormComponent=function(t){return s.createElement(e,m({},a.props,t))},a}return y(r,t),r.prototype.render=function(){var e=g(this.props,["children"]);return s.createElement(A,m({},e,n,{validate:n.validate&&this.validate,validationSchema:n.validationSchema&&this.validationSchema,initialValues:a(this.props),initialStatus:n.mapPropsToStatus&&n.mapPropsToStatus(this.props),initialErrors:n.mapPropsToErrors&&n.mapPropsToErrors(this.props),initialTouched:n.mapPropsToTouched&&n.mapPropsToTouched(this.props),onSubmit:this.handleSubmit,children:this.renderFormComponent}))},r}(s.Component);return r.displayName="WithFormik("+t+")",p(r,e)}},t.yupToFormErrors=F},1310:function(e,t,a){e.exports=function(){"use strict";var e=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var a=Object.prototype.toString.call(e);return"[object RegExp]"===a||"[object Date]"===a||function(e){return e.$$typeof===t}(e)}(e)};var t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(e,t){return!1!==t.clone&&t.isMergeableObject(e)?r((a=e,Array.isArray(a)?[]:{}),e,t):e;var a}function n(e,t,n){return e.concat(t).map((function(e){return a(e,n)}))}function r(t,i,o){(o=o||{}).arrayMerge=o.arrayMerge||n,o.isMergeableObject=o.isMergeableObject||e;var s=Array.isArray(i);return s===Array.isArray(t)?s?o.arrayMerge(t,i,o):function(e,t,n){var i={};return n.isMergeableObject(e)&&Object.keys(e).forEach((function(t){i[t]=a(e[t],n)})),Object.keys(t).forEach((function(o){n.isMergeableObject(t[o])&&e[o]?i[o]=r(e[o],t[o],n):i[o]=a(t[o],n)})),i}(t,i,o):a(i,o)}return r.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,a){return r(e,a,t)}),{})},r}()},1311:function(e,t,a){var n=a(1338);e.exports=function(e){return n(e,5)}},1312:function(e,t,a){"use strict";e.exports=function(e,t){}},1313:function(e,t,a){e.exports=a(35)(231)},1314:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));let n=function(e){return e.ERROR="error",e.EMPTY="empty",e.EMPTY_SEARCH="empty_search",e.LOADING="loading",e.SEARCHING="searching",e.DELETING="deleting",e}({})},1315:function(e,t,a){e.exports=a.p+"94cccf20036d014924e63d4d595e88e1.svg"},1325:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(168);const r=n.q,i=n.r,o=({namespaceType:e})=>e.map((e=>(({namespaceType:e})=>"agnostic"===e?i:r)({namespaceType:e})))},135:function(e,t,a){"use strict";a.d(t,"H",(function(){return o})),a.d(t,"I",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"kb",(function(){return c})),a.d(t,"eb",(function(){return u})),a.d(t,"fb",(function(){return d})),a.d(t,"jb",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"i",(function(){return y})),a.d(t,"g",(function(){return g})),a.d(t,"a",(function(){return f})),a.d(t,"gb",(function(){return b})),a.d(t,"c",(function(){return v})),a.d(t,"b",(function(){return E})),a.d(t,"C",(function(){return x})),a.d(t,"E",(function(){return k})),a.d(t,"F",(function(){return w})),a.d(t,"D",(function(){return S})),a.d(t,"bb",(function(){return O})),a.d(t,"ab",(function(){return I})),a.d(t,"Z",(function(){return C})),a.d(t,"X",(function(){return M})),a.d(t,"W",(function(){return _})),a.d(t,"G",(function(){return N})),a.d(t,"V",(function(){return D})),a.d(t,"U",(function(){return A})),a.d(t,"S",(function(){return F})),a.d(t,"T",(function(){return q})),a.d(t,"O",(function(){return R})),a.d(t,"M",(function(){return P})),a.d(t,"L",(function(){return z})),a.d(t,"K",(function(){return B})),a.d(t,"N",(function(){return $})),a.d(t,"J",(function(){return G})),a.d(t,"Q",(function(){return U})),a.d(t,"P",(function(){return V})),a.d(t,"B",(function(){return H})),a.d(t,"z",(function(){return W})),a.d(t,"y",(function(){return Y})),a.d(t,"w",(function(){return Z})),a.d(t,"x",(function(){return K})),a.d(t,"A",(function(){return Q})),a.d(t,"v",(function(){return X})),a.d(t,"s",(function(){return J})),a.d(t,"r",(function(){return ee})),a.d(t,"t",(function(){return te})),a.d(t,"q",(function(){return ae})),a.d(t,"u",(function(){return ne})),a.d(t,"R",(function(){return re})),a.d(t,"p",(function(){return ie})),a.d(t,"o",(function(){return oe})),a.d(t,"n",(function(){return se})),a.d(t,"m",(function(){return le})),a.d(t,"l",(function(){return ce})),a.d(t,"k",(function(){return ue})),a.d(t,"j",(function(){return de})),a.d(t,"Y",(function(){return pe})),a.d(t,"lb",(function(){return me})),a.d(t,"f",(function(){return ye})),a.d(t,"e",(function(){return ge})),a.d(t,"ib",(function(){return fe})),a.d(t,"hb",(function(){return be})),a.d(t,"db",(function(){return ve})),a.d(t,"cb",(function(){return Ee}));var n=a(211),r=a(279);const i=`${n.a}Header`,o=`${n.a}AlertTitle`,s=`${n.a}EventTitle`,l=`${i}AlertSumaryPanel`,c=`${i}StatusTitle`,u=`${i}RiskScoreTitle`,d=`${i}RiskScoreValue`,p=`${i}ShareButton`,m=`${i}AssigneesHeader`,y=`${i}AssigneesTitle`,g=`${i}AssigneesAddButton`,f=`${n.a}AboutSection`,b=(r.c,r.a,`${n.a}RuleSummaryButton`),h=`${n.a}AlertDescription`,v=`${h}Title`,E=`${h}Details`,x=`${n.a}EventCategoryDescription`,k=`${n.a}EventKindDescription`,w=`${k}Text`,S=`${k}Categories`,j=`${n.a}Reason`,O=`${j}Title`,I=`${j}Details`,C=`${j}PreviewButton`,T=`${n.a}MitreAttack`,M=`${T}Title`,_=`${T}Details`,N=`${n.a}EventRenderer`,D=`${n.a}InvestigationSection`,A=(r.c,r.a,`${n.a}InvestigationGuide`),F=`${A}Button`,q=`${A}Loading`,L=`${n.a}HighlightedFields`,R=`${L}Title`,P=`${L}Details`,z=`${L}Cell`,B=`${L}BasicCell`,$=`${L}LinkedCell`,G=`${L}AgentStatusCell`,U=`${n.a}Insights`,V=(r.c,r.a,`${n.a}InsightsEntities`),H=`${V}UserOverview`,W=`${H}Loading`,Y=`${H}Link`,Z=`${H}Domain`,K=`${H}LastSeen`,Q=`${H}RiskLevel`,X=`${V}HostOverview`,J=`${X}Loading`,ee=`${X}Link`,te=`${X}OsFamily`,ae=`${X}LastSeen`,ne=`${X}RiskLevel`,re=`${n.a}InsightsThreatIntelligence`,ie=`${n.a}Correlations`,oe=`${ie}SuppressedAlerts`,se=`${oe}TechnicalPreview`,le=`${ie}RelatedCases`,ce=`${ie}RelatedAlertsBySession`,ue=`${ie}RelatedAlertsBySameSourceEvent`,de=`${ie}RelatedAlertsByAncestry`,pe=`${n.a}InsightsPrevalence`,me=`${n.a}Visualizations`,ye=(r.c,r.a,`${n.a}AnalyzerPreview`),ge=`${ye}Loading`,fe=`${n.a}SessionPreview`,be=`${fe}RuleDetailsLink`,he=`${n.a}Response`,ve=`${he}Section`,Ee=(r.c,r.a,`${he}Button`)},1403:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));let n=function(e){return e.query="query",e.graph="graph",e.notes="notes",e.pinned="pinned",e.eql="eql",e.session="session",e}({})},1471:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>e&&e.trim().length!==e.length},1472:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(49),r=a(2),i=a.n(r),o=a(118),s=a(130),l=a(937),c=a(367),u=a(378),d=a(196),p=a(340),m=a(862),y=a(201),g=a(314),f=a(181),b=a(334);const h=i.a.memo((({contextID:e,id:t,ip:a,data:r,isDraggable:h=!1,isInDetailsSidePanel:v=!1,loading:E,flowTarget:x,startDate:k,endDate:w,isLoadingAnomaliesData:S,anomaliesData:j,narrowDateRange:O,indexPatterns:I,jobNameById:C})=>{const T=Object(y.a)(),M=Object(g.a)(T),_=Object(o.g)(),N=r[x],D=[{title:u.i,description:Object(l.e)([`${x}.geo.city_name`,`${x}.geo.region_name`],r,e,h)},{title:u.c,description:N?Object(l.b)(N.autonomousSystem,x,e,h):Object(s.d)()}],A=[M?[...D,{title:u.j,description:i.a.createElement(m.a,{anomalies:j,startDate:k,endDate:w,isLoading:S,narrowDateRange:O,jobNameById:C})}]:D,[{title:u.d,description:i.a.createElement(c.a,{indexPatterns:I,field:`${x}.ip`,value:a,type:c.b.FIRST_SEEN})},{title:u.h,description:i.a.createElement(c.a,{indexPatterns:I,field:`${x}.ip`,value:a,type:c.b.LAST_SEEN})}],[{title:u.e,description:N&&r.host?Object(l.c)({host:r.host,isDraggable:h,ipFilter:a,contextID:e}):Object(s.d)()},{title:u.f,description:N&&r.host?Object(l.d)(r.host,a,e,h):Object(s.d)()}],[{title:u.o,description:Object(l.g)(a)},{title:u.k,description:Object(l.f)(a)}]];return i.a.createElement(f.c,null,i.a.createElement(d.g,{direction:v?"column":"row"},!v&&i.a.createElement(f.b,{queryId:t,title:u.g,inspectIndex:0}),A.map(((e,t)=>i.a.createElement(b.a,{descriptionList:e,key:t}))),E&&i.a.createElement(p.a,{overlay:!0,overlayBackground:_?n.euiDarkVars.euiPageBackgroundColor:n.euiLightVars.euiPageBackgroundColor,size:"xl"})))}));h.displayName="IpOverview"},1473:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(137);const r=(e,t)=>t===n.g.source?[{fieldName:"source.ip",fieldValue:e}]:t===n.g.destination?[{fieldName:"destination.ip",fieldValue:e}]:[]},1493:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(2),r=a(376),i=a(137),o=a(4);const s=o.i18n.translate("xpack.securitySolution.networkDetails.errorSearchDescription",{defaultMessage:"An error has occurred on network details search"});o.i18n.translate("xpack.securitySolution.networkDetails.failSearchDescription",{defaultMessage:"Failed to run search on network details"});var l=a(306);const c="networkDetailsQuery",u=({filterQuery:e,id:t=c,indexNames:a,ip:o,skip:u})=>{const{loading:d,result:p,search:m,refetch:y,inspect:g}=Object(l.a)({factoryQueryType:i.o.details,initialResult:{networkDetails:{}},errorMessage:s,abort:u}),f=Object(n.useMemo)((()=>({networkDetails:p.networkDetails,id:t,inspect:g,isInspected:!1,refetch:y})),[t,g,y,p.networkDetails]),b=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:i.o.details,filterQuery:Object(r.a)(e),ip:o})),[e,a,o]);return Object(n.useEffect)((()=>{!u&&b&&m(b)}),[b,m,u]),[d,f]}},150:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"g",(function(){return m}));var n=a(19),r=a(44),i=a(41),o=a.n(i);const s="details",l=o.a.div.attrs((()=>({className:s}))).withConfig({displayName:"Details",componentId:"sc-1ucey7j-0"})(["margin:5px 0 5px 10px;& .euiBadge{margin:2px 0 2px 0;}& .euiFlexGroup{justify-content:center;}"]);l.displayName="Details";const c=o()(n.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1ucey7j-1"})(["margin-left:3px;"]);function u(e){return Object(r.isNumber)(e)?!isFinite(e):Object(r.isEmpty)(e)}c.displayName="TokensFlexItem";const d=({eventCategory:e,eventDataset:t})=>"file"===(null==e?void 0:e.toLowerCase())||"file"===(null==t?void 0:t.toLowerCase())||"endpoint.events.file"===(null==t?void 0:t.toLowerCase()),p=e=>["process_stopped","termination_event"].includes(`${e}`.toLowerCase()),m=e=>["created","creation","deleted","deletion","file_create_event","file_delete_event","files-encrypted","load","modification","overwrite","rename"].includes(`${e}`.toLowerCase())},153:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"L",(function(){return i})),a.d(t,"x",(function(){return s})),a.d(t,"I",(function(){return l})),a.d(t,"D",(function(){return c})),a.d(t,"A",(function(){return u})),a.d(t,"H",(function(){return d})),a.d(t,"B",(function(){return p})),a.d(t,"F",(function(){return m})),a.d(t,"y",(function(){return y})),a.d(t,"z",(function(){return g})),a.d(t,"C",(function(){return f})),a.d(t,"G",(function(){return b})),a.d(t,"E",(function(){return h})),a.d(t,"n",(function(){return v})),a.d(t,"Q",(function(){return E})),a.d(t,"P",(function(){return x})),a.d(t,"O",(function(){return k})),a.d(t,"q",(function(){return w})),a.d(t,"p",(function(){return S})),a.d(t,"o",(function(){return j})),a.d(t,"N",(function(){return O})),a.d(t,"l",(function(){return I})),a.d(t,"f",(function(){return C})),a.d(t,"h",(function(){return T})),a.d(t,"g",(function(){return M})),a.d(t,"j",(function(){return _})),a.d(t,"i",(function(){return N})),a.d(t,"k",(function(){return D})),a.d(t,"M",(function(){return A})),a.d(t,"J",(function(){return q})),a.d(t,"K",(function(){return L})),a.d(t,"s",(function(){return R})),a.d(t,"r",(function(){return P})),a.d(t,"u",(function(){return z})),a.d(t,"t",(function(){return B})),a.d(t,"b",(function(){return $})),a.d(t,"c",(function(){return G})),a.d(t,"a",(function(){return U})),a.d(t,"v",(function(){return V})),a.d(t,"m",(function(){return H})),a.d(t,"e",(function(){return W})),a.d(t,"w",(function(){return Y}));var n=a(211);const r=`${n.a}AnalyzerGraph`,i=`${n.a}SessionView`,o=`${n.a}PrevalenceDetails`,s=`${o}DatePicker`,l=`${o}Upsell`,c=`${o}Table`,u=`${c}FieldCell`,d=`${c}ValueCell`,p=`${c}HostCell`,m=`${c}UserCell`,y=`${c}AlertCountCell`,g=`${c}DocCountCell`,f=`${c}HostPrevalenceCell`,b=`${c}UserPrevalenceCell`,h=`${c}UpsellCell`,v=`${n.a}EntitiesDetails`,E=`${n.a}UsersDetails`,x=`${E}RelatedHostsTable`,k=`${E}RelatedHostsLink`,w=`${n.a}HostsDetails`,S=`${w}RelatedUsersTable`,j=`${w}RelatedUsersLink`,O=`${n.a}ThreatIntelligenceDetailsLoading`,I=`${n.a}CorrelationsDetails`,C=`${I}AlertsByAncestrySection`,T=`${I}AlertsBySourceSection`,M=`${I}AlertsBySessionSection`,_=`${I}CasesSection`,N=`${_}Table`,D=`${I}SuppressedAlertsSection`,A=`${I}SuppressedAlertsSectionTechnicalPreview`,F=`${n.a}Response`,q=`${F}Details`,L=`${F}NoData`,R=`${n.a}InvestigationGuide`,P=`${R}Loading`,z=`${n.a}NotesLoading`,B=`${n.a}NotesComment`,$=`${n.a}AddNotesLoading`,G=`${n.a}AddNotesMarkdown`,U=`${n.a}AddNotesButton`,V=`${n.a}NoteAvatar`,H=`${n.a}DeleteNotesButton`,W=`${n.a}AttachToTimelineCheckbox`,Y=`${n.a}OpenTimelineButton`},1555:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return m})),a.d(t,"g",(function(){return y}));var n=a(50),r=a(1342),i=a(1870),o=(a(1619),a(1282),a(1283),a(796),a(1328),a(1556),a(1447),a(403));a(750),a(53),a(233),a(1470);const s=e=>e.map((e=>"nested"===e.type?Object(r.a)({...e,entries:e.entries.map((e=>Object(r.a)(e)))}):Object(r.a)(e))),l=({listId:e,namespaceType:t,name:a})=>({comments:[],description:"Exception list item",entries:s([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:e,meta:{temporaryUuid:Object(n.v4)()},name:a,namespace_type:t,tags:[],type:"simple"}),c=e=>{switch(e.type){case"match":return o.b.MATCH;case"match_any":return o.b.MATCH_ANY;case"wildcard":return o.b.WILDCARD;case"list":return o.b.LIST;default:return o.b.EXISTS}},u=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time > "${t}" OR NOT ${e}.attributes.expire_time: *`)).join(",")},d=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time <= "${t}"`)).join(",")},p=e=>{let t=e.match(/.ds-(.*?)-[0-9]{4}\.[0-9]{2}\.[0-9]{2}-[0-9]{6}/);return t&&2===t.length?t[1]:(t=e.match(/.siem-(.*?)-[0-9]{6}/),t&&2===t.length?`.siem-${t[1]}`:e)},m=e=>{if(!e.conflictDescriptions)return null;const t=[];for(const[a,n]of Object.entries(e.conflictDescriptions)){const e=[],r={};n.forEach((e=>{const t=p(e);r[t]||(r[t]=0),r[t]++}));for(const[t,a]of Object.entries(r))e.push({name:t,count:a});e.sort(((e,t)=>t.count-e.count)),t.push({type:a,totalIndexCount:n.length,groupedIndices:e})}return t},y=e=>e.flatMap((e=>e.entries)).some((e=>{if("list"!==e.type&&"value"in e)return Object(i.f)({operator:e.type,value:e.value})}))},1556:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(46),r=a(1448),i=a(1256),o=a(506),s=a(399),l=a(255),c=a(400),u=a(574),d=a(275),p=a(456),m=a(507),y=a(752),g=a(1284);const f=n.intersection([n.exact(n.type({description:s.a,entries:y.a,list_id:l.a,name:c.a,type:u.a})),n.exact(n.partial({comments:i.a,expire_time:g.a,item_id:r.a,meta:d.a,namespace_type:p.a,os_types:o.c,tags:m.a}))])},1557:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(204),r=a(1532),i=a(1533);const o=Object(r.a)(n.t),s=()=>Object(i.a)(o)},1558:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a(1559);const r=e=>{try{const t=Object(n.a)(e);return i(t)}catch(e){return[]}},i=e=>e?e.split(",").map((e=>e.trim())):[]},1559:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(89);function r(e){var t;const{ast:a}=Object(n.getAstAndSyntaxErrors)(e),r=a.find((({name:e})=>["from","metrics"].includes(e))),i=(null!==(t=null==r?void 0:r.args)&&void 0!==t?t:[]).filter((e=>"index"===e.sourceType));return null==i?void 0:i.map((e=>e.text)).join(",")}},1560:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>e},1561:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a(2);var n=a(42),r=a(4),i=a(19),o=a(43);const s=()=>Object(o.jsx)(i.EuiCallOut,{title:r.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.title",{defaultMessage:"Please review your entries"}),iconType:"warning",color:"warning",size:"s","data-test-subj":"wildcardWithWrongOperatorCallout"},Object(o.jsx)("p",null,Object(o.jsx)(n.FormattedMessage,{id:"exceptionList-components.wildcardWithWrongOperatorCallout.body",defaultMessage:'Using a "*" or a "?" in the value with the "is" operator can make the entry ineffective. {operator} to "{matches}" to ensure wildcards run properly.',values:{operator:Object(o.jsx)("strong",null,r.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.changeTheOperator",{defaultMessage:"Change the operator"})),matches:Object(o.jsx)("strong",null,r.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.matches",{defaultMessage:"matches"}))}})))},1562:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a.n(n),i=a(43),o=a(19),s=a(49),l=a(1314),c=a(842),u=a(1315),d=a.n(u);const p=Object(i.css)("margin:",s.euiThemeVars.euiSizeL," 0;padding:",s.euiThemeVars.euiSizeL," 0;",""),m=({title:e,body:t,buttonText:a,listType:r,isReadOnly:s,viewerStatus:u,onEmptyButtonStateClick:m})=>{const{euiTheme:y}=Object(o.useEuiTheme)(),g=Object(n.useMemo)((()=>{switch(u){case l.a.ERROR:return{color:"danger",iconType:"error",title:Object(i.jsx)("h2",{"data-test-subj":"errorTitle"},e||c.g),body:Object(i.jsx)("p",{"data-test-subj":"errorBody"},t||c.f),"data-test-subj":"errorViewerState"};case l.a.EMPTY:return{color:"subdued",iconType:"plusInCircle",iconColor:y.colors.darkestShade,title:Object(i.jsx)("h2",{"data-test-subj":"emptyTitle"},e||c.d),body:Object(i.jsx)("p",{"data-test-subj":"emptyBody"},t||c.a),"data-test-subj":"emptyViewerState",actions:[Object(i.jsx)(o.EuiButton,{"data-test-subj":"emptyStateButton",onClick:m,iconType:"plusInCircle",color:"primary",isDisabled:s,fill:!0},a||c.e(r||"rule"))]};case l.a.EMPTY_SEARCH:return{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:Object(i.jsx)(o.EuiImage,{size:"fullWidth",alt:"",src:d.a}),title:Object(i.jsx)("h3",{"data-test-subj":"emptySearchTitle"},e||c.c),body:Object(i.jsx)("p",{"data-test-subj":"emptySearchBody"},t||c.b),"data-test-subj":"emptySearchViewerState"}}}),[u,y.colors.darkestShade,e,t,m,s,a,r]);return Object(i.jsx)(o.EuiSkeletonText,{lines:4,"data-test-subj":"loadingViewerState",isLoading:u===l.a.LOADING||u===l.a.SEARCHING},Object(i.jsx)(o.EuiPanel,{css:p,color:"empty_search"===u?"subdued":"transparent"},Object(i.jsx)(o.EuiEmptyPrompt,g)))},y=r.a.memo(m);y.displayName="EmptyViewerState"},1622:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(7),r=a(44),i=a(1325);const o=({filters:e,namespaceTypes:t,hideLists:a})=>{const o=Object(i.a)({namespaceType:t}),s=((e,t)=>Object.keys(e).map((a=>{const i=Object(r.get)(a,e);return Object(n.isArray)(i)||null!=i&&""!==i.trim()?`(${t.map((e=>{const t="name"===a?"name.text":"types"===a?"type":a;return Object(n.isArray)(i)?i.map((a=>`${e}.attributes.${t}:${a}`)).join(" OR "):`${e}.attributes.${t}:${i}`})).join(" OR ")})`:null})).filter((e=>null!=e)).join(" AND "))(e,o);return[s,...a.map((e=>`(${o.map((t=>`not ${t}.attributes.list_id: ${e}*`)).join(" AND ")})`))].filter((e=>""!==e.trim())).join(" AND ")}},1737:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(19),r=a(2),i=a.n(r),o=a(241);const s=a(4).i18n.translate("xpack.elasticAssistant.assistant.newChatByTitle.newChatByTitleButton",{defaultMessage:"Chat"});var l=a(43);const c=({children:e=s,conversationTitle:t,iconType:a,promptContextId:i,iconOnly:c=!1})=>{const{showAssistantOverlay:u}=Object(o.b)(),d=Object(r.useCallback)((()=>{u({conversationTitle:t,promptContextId:i,showOverlay:!0})}),[t,i,u]),p=Object(r.useMemo)((()=>{if(null!==a)return null!=a?a:"discuss"}),[a]);return Object(r.useMemo)((()=>c?Object(l.jsx)(n.EuiToolTip,{content:s},Object(l.jsx)(n.EuiButtonIcon,{"data-test-subj":"newChatByTitle",iconType:null!=p?p:"discuss",onClick:d,color:"text","aria-label":s})):Object(l.jsx)(n.EuiButtonEmpty,{"data-test-subj":"newChatByTitle",iconType:p,onClick:d,"aria-label":s},e)),[e,p,d,c])};c.displayName="NewChatByTitleComponent";const u=i.a.memo(c)},221:function(e,t,a){"use strict";a.d(t,"B",(function(){return r})),a.d(t,"y",(function(){return i})),a.d(t,"A",(function(){return o})),a.d(t,"z",(function(){return s})),a.d(t,"x",(function(){return l})),a.d(t,"w",(function(){return c})),a.d(t,"q",(function(){return u})),a.d(t,"p",(function(){return d})),a.d(t,"u",(function(){return p})),a.d(t,"t",(function(){return m})),a.d(t,"Y",(function(){return y})),a.d(t,"ab",(function(){return g})),a.d(t,"W",(function(){return f})),a.d(t,"X",(function(){return b})),a.d(t,"Z",(function(){return h})),a.d(t,"j",(function(){return v})),a.d(t,"O",(function(){return E})),a.d(t,"E",(function(){return x})),a.d(t,"F",(function(){return k})),a.d(t,"s",(function(){return w})),a.d(t,"k",(function(){return S})),a.d(t,"o",(function(){return j})),a.d(t,"hb",(function(){return O.U})),a.d(t,"m",(function(){return O.p})),a.d(t,"C",(function(){return O.u})),a.d(t,"r",(function(){return O.s})),a.d(t,"v",(function(){return O.t})),a.d(t,"n",(function(){return O.r})),a.d(t,"ob",(function(){return O.db})),a.d(t,"eb",(function(){return O.R})),a.d(t,"nb",(function(){return O.cb})),a.d(t,"cb",(function(){return O.P})),a.d(t,"db",(function(){return O.Q})),a.d(t,"qb",(function(){return O.fb})),a.d(t,"D",(function(){return O.v})),a.d(t,"fb",(function(){return O.S})),a.d(t,"kb",(function(){return O.Y})),a.d(t,"mb",(function(){return O.ab})),a.d(t,"lb",(function(){return O.Z})),a.d(t,"S",(function(){return O.I})),a.d(t,"R",(function(){return O.G})),a.d(t,"U",(function(){return O.K})),a.d(t,"T",(function(){return O.J})),a.d(t,"Q",(function(){return O.F})),a.d(t,"P",(function(){return O.E})),a.d(t,"bb",(function(){return O.O})),a.d(t,"a",(function(){return O.c})),a.d(t,"V",(function(){return O.L})),a.d(t,"gb",(function(){return O.T})),a.d(t,"b",(function(){return O.d})),a.d(t,"i",(function(){return O.m})),a.d(t,"l",(function(){return O.o})),a.d(t,"h",(function(){return O.l})),a.d(t,"f",(function(){return O.j})),a.d(t,"g",(function(){return O.k})),a.d(t,"d",(function(){return O.h})),a.d(t,"e",(function(){return O.i})),a.d(t,"c",(function(){return O.e})),a.d(t,"pb",(function(){return O.eb})),a.d(t,"jb",(function(){return O.X})),a.d(t,"ib",(function(){return O.V})),a.d(t,"G",(function(){return O.w})),a.d(t,"M",(function(){return O.C})),a.d(t,"K",(function(){return O.A})),a.d(t,"J",(function(){return O.z})),a.d(t,"L",(function(){return O.B})),a.d(t,"N",(function(){return O.D})),a.d(t,"H",(function(){return O.x})),a.d(t,"I",(function(){return O.y}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_title",{defaultMessage:"Create exceptions to this list"}),i=e=>n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_body",{values:{listName:e},defaultMessage:"There is no exception in your [{listName}]. Create rule exceptions to this list."}),o=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button_endpoint",{defaultMessage:"Create endpoint exception"}),s=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button",{defaultMessage:"Create rule exception"}),l=n.i18n.translate("xpack.securitySolution.exception.list.search_bar_button_enpoint",{defaultMessage:"Add endpoint exception to list"}),c=n.i18n.translate("xpack.securitySolution.exception.list.search_bar_button",{defaultMessage:"Add rule exception to list"}),u=(n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"})),d=n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),p=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),m=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessText",{values:{itemName:e},defaultMessage:'"{itemName}" deleted successfully.'}),y=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_cancel",{defaultMessage:"Cancel"}),g=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_save",{defaultMessage:"Save"}),f=n.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_header",{defaultMessage:"Link rules"}),b=n.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_overflow_button_title",{defaultMessage:"Link rules"}),h=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_description",{defaultMessage:"Link or unlink rules to this exception list."}),v=n.i18n.translate("xpack.securitySolution.exceptionsTable.deleteExceptionList",{defaultMessage:"Delete exception list"}),E=n.i18n.translate("xpack.securitySolution.exceptionsTable.exportExceptionList",{defaultMessage:"Export exception list"}),x=n.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesError",{defaultMessage:"Manage rules error"}),k=n.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesErrorDescription",{defaultMessage:"An error occurred linking or unlinking rules"}),w=n.i18n.translate("xpack.securitySolution.exceptionsTable.exportListDescription",{defaultMessage:"An error occurred exporting a list"}),S=n.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateExceptionList",{defaultMessage:"Duplicate exception list"}),j=n.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateListDescription",{defaultMessage:"An error occurred duplicating a list"});a(597);var O=a(777)},226:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),r=a.n(n),i=a(19),o=a(41),s=a.n(o),l=a(49),c=a(589),u=a(1259);const d=s.a.div.withConfig({displayName:"RiskBadge",componentId:"sc-169ah31-0"})(["",""],(({theme:e,$severity:t,$hideBackgroundColor:a})=>Object(o.css)(["width:fit-content;padding-right:",";padding-left:",";",";"],e.eui.euiSizeS,e.eui.euiSizeXS,("Critical"===t||"High"===t)&&!a&&Object(o.css)(["background-color:",";border-radius:999px;"],Object(i.transparentize)(e.eui.euiColorDanger,.2))))),p=s.a.div.withConfig({displayName:"TooltipContainer",componentId:"sc-169ah31-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),m=r.a.memo((({severity:e,hideBackgroundColor:t=!1,toolTipContent:a,"data-test-subj":n})=>null!=a?r.a.createElement(u.a,{hoverContent:r.a.createElement(p,null,a)},r.a.createElement(y,{severity:e,hideBackgroundColor:t,"data-test-subj":n})):r.a.createElement(y,{severity:e,hideBackgroundColor:t,"data-test-subj":n})));m.displayName="RiskScoreLevel";const y=r.a.memo((({severity:e,hideBackgroundColor:t=!1,"data-test-subj":a})=>r.a.createElement(d,{color:l.euiLightVars.euiColorDanger,$severity:e,$hideBackgroundColor:t,"data-test-subj":null!=a?a:"risk-score"},r.a.createElement(i.EuiTextColor,{color:"default"},r.a.createElement(i.EuiHealth,{className:"eui-alignMiddle",color:c.d[e]},e)))));y.displayName="RiskScoreBadge"},230:function(e,t,a){"use strict";a.d(t,"W",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"r",(function(){return l})),a.d(t,"A",(function(){return c})),a.d(t,"B",(function(){return u})),a.d(t,"H",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"i",(function(){return y})),a.d(t,"n",(function(){return g})),a.d(t,"q",(function(){return f})),a.d(t,"s",(function(){return b})),a.d(t,"t",(function(){return h})),a.d(t,"u",(function(){return v})),a.d(t,"v",(function(){return E})),a.d(t,"E",(function(){return x})),a.d(t,"k",(function(){return k})),a.d(t,"G",(function(){return w})),a.d(t,"F",(function(){return S})),a.d(t,"m",(function(){return j})),a.d(t,"l",(function(){return O})),a.d(t,"j",(function(){return I})),a.d(t,"p",(function(){return C})),a.d(t,"J",(function(){return T})),a.d(t,"o",(function(){return M})),a.d(t,"I",(function(){return _})),a.d(t,"z",(function(){return N})),a.d(t,"h",(function(){return D})),a.d(t,"w",(function(){return A})),a.d(t,"d",(function(){return F})),a.d(t,"a",(function(){return q})),a.d(t,"y",(function(){return L})),a.d(t,"x",(function(){return R})),a.d(t,"K",(function(){return P})),a.d(t,"L",(function(){return z})),a.d(t,"M",(function(){return B})),a.d(t,"D",(function(){return $})),a.d(t,"C",(function(){return G})),a.d(t,"N",(function(){return U})),a.d(t,"R",(function(){return V})),a.d(t,"P",(function(){return H})),a.d(t,"T",(function(){return W})),a.d(t,"Q",(function(){return Y})),a.d(t,"U",(function(){return Z})),a.d(t,"O",(function(){return K})),a.d(t,"S",(function(){return Q})),a.d(t,"V",(function(){return X}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.system.withResultDescription",{defaultMessage:"with result"}),i=n.i18n.translate("xpack.securitySolution.system.acceptedAConnectionViaDescription",{defaultMessage:"accepted a connection via"}),o=n.i18n.translate("xpack.securitySolution.system.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),s=n.i18n.translate("xpack.securitySolution.system.disconnectedViaDescription",{defaultMessage:"disconnected via"}),l=n.i18n.translate("xpack.securitySolution.system.loggedOutDescription",{defaultMessage:"logged out via"}),c=(n.i18n.translate("xpack.securitySolution.system.usingDescription",{defaultMessage:"using"}),n.i18n.translate("xpack.securitySolution.system.processStartedDescription",{defaultMessage:"started process"})),u=n.i18n.translate("xpack.securitySolution.system.processStoppedDescription",{defaultMessage:"stopped process"}),d=n.i18n.translate("xpack.securitySolution.system.terminatedProcessDescription",{defaultMessage:"terminated process"}),p=n.i18n.translate("xpack.securitySolution.system.createdFileDescription",{defaultMessage:"created a file"}),m=n.i18n.translate("xpack.securitySolution.system.deletedFileDescription",{defaultMessage:"deleted a file"}),y=n.i18n.translate("xpack.securitySolution.rowRenderer.executedProcessDescription",{defaultMessage:"executed process"}),g=n.i18n.translate("xpack.securitySolution.rowRenderer.forkedProcessDescription",{defaultMessage:"forked process"}),f=n.i18n.translate("xpack.securitySolution.rowRenderer.loadedLibraryDescription",{defaultMessage:"loaded library"}),b=n.i18n.translate("xpack.securitySolution.rowRenderer.madeAHttpRequestViaDescription",{defaultMessage:"made a http request via"}),h=n.i18n.translate("xpack.securitySolution.rowRenderer.modifiedFileDescription",{defaultMessage:"modified a file"}),v=n.i18n.translate("xpack.securitySolution.rowRenderer.modifiedRegistryKeyDescription",{defaultMessage:"modified registry key"}),E=n.i18n.translate("xpack.securitySolution.rowRenderer.overwroteFileDescription",{defaultMessage:"overwrote a file"}),x=n.i18n.translate("xpack.securitySolution.rowRenderer.renamedFileDescription",{defaultMessage:"renamed a file"}),k=n.i18n.translate("xpack.securitySolution.system.existingProcessDescription",{defaultMessage:"is running process"}),w=n.i18n.translate("xpack.securitySolution.system.socketOpenedDescription",{defaultMessage:"opened a socket with"}),S=n.i18n.translate("xpack.securitySolution.system.socketClosedDescription",{defaultMessage:"closed a socket with"}),j=n.i18n.translate("xpack.securitySolution.system.existingUserDescription",{defaultMessage:"is an existing user"}),O=n.i18n.translate("xpack.securitySolution.system.existingSocketDescription",{defaultMessage:"is using an existing socket from"}),I=n.i18n.translate("xpack.securitySolution.system.existingPackageDescription",{defaultMessage:"is using an existing package"}),C=n.i18n.translate("xpack.securitySolution.system.invalidDescription",{defaultMessage:"attempted invalid usage of"}),T=n.i18n.translate("xpack.securitySolution.system.userChangedDescription",{defaultMessage:"user has changed"}),M=n.i18n.translate("xpack.securitySolution.system.hostDescription",{defaultMessage:"host information"}),_=n.i18n.translate("xpack.securitySolution.system.userAddedDescription",{defaultMessage:"user was added"}),N=n.i18n.translate("xpack.securitySolution.system.processErrorDescription",{defaultMessage:"encountered a process error with"}),D=n.i18n.translate("xpack.securitySolution.system.errorDescription",{defaultMessage:"encountered an error with"}),A=n.i18n.translate("xpack.securitySolution.system.packageInstalledDescription",{defaultMessage:"installed package"}),F=n.i18n.translate("xpack.securitySolution.system.packageSystemStartedDescription",{defaultMessage:"system started"}),q=n.i18n.translate("xpack.securitySolution.system.acceptedDescription",{defaultMessage:"accepted the user via"}),L=n.i18n.translate("xpack.securitySolution.system.packageUpdatedDescription",{defaultMessage:"updated package"}),R=n.i18n.translate("xpack.securitySolution.system.packageRemovedDescription",{defaultMessage:"removed package"}),P=n.i18n.translate("xpack.securitySolution.system.userRemovedDescription",{defaultMessage:"was removed"}),z=n.i18n.translate("xpack.securitySolution.system.viaDescription",{defaultMessage:"via"}),B=n.i18n.translate("xpack.securitySolution.system.viaParentProcessDescription",{defaultMessage:"via parent process"}),$=n.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasPreventedFromeEcryptingFilesDescription",{defaultMessage:"ransomware was prevented from encrypting files"}),G=n.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasDetectedEcryptingFilesDescription",{defaultMessage:"ransomware was detected encrypting files"}),U=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedCreatingAMaliciousFileDescription",{defaultMessage:"was detected creating a malicious file"}),V=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromCreatingAMaliciousFileDescription",{defaultMessage:"was prevented from creating a malicious file"}),H=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedModifyingAMaliciousFileDescription",{defaultMessage:"was detected modifying a malicious file"}),W=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromModifyingAMaliciousFileDescription",{defaultMessage:"was prevented from modifying a malicious file"}),Y=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedRenamingAMaliciousFileDescription",{defaultMessage:"was detected renaming a malicious file"}),Z=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromRenamingAMaliciousFileDescription",{defaultMessage:"was prevented from renaming a malicious file"}),K=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedExecutingAMaliciousProcessDescription",{defaultMessage:"was detected executing a malicious process"}),Q=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromExecutingAMaliciousProcessDescription",{defaultMessage:"was prevented from executing a malicious process"}),X=n.i18n.translate("xpack.securitySolution.system.withExitCodeDescription",{defaultMessage:"with exit code"})},231:function(e,t,a){"use strict";a.d(t,"h",(function(){return Ee})),a.d(t,"b",(function(){return xe})),a.d(t,"f",(function(){return ke})),a.d(t,"c",(function(){return we})),a.d(t,"d",(function(){return Se})),a.d(t,"g",(function(){return je})),a.d(t,"j",(function(){return Oe})),a.d(t,"i",(function(){return Ie})),a.d(t,"a",(function(){return Ce})),a.d(t,"e",(function(){return Te})),a.d(t,"k",(function(){return It}));var n=a(44),r=a(2),i=a.n(r),o=a(121),s=a(19),l=a(150),c=a(278),u=a(134),d=a(317),p=a(836);const m=i.a.memo((({contextId:e,eventId:t,hostName:a,hostNameSeparator:n="@",isDraggable:r,userDomain:o,userDomainField:s="user.domain",userName:c,userNameField:d="user.name",workingDirectory:m})=>null!=c||null!=o||null!=a||null!=m?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:d,isDraggable:r,value:c,iconType:"user",fieldType:"keyword",isAggregatable:!0})),null!=o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{"data-test-subj":"user-host-working-dir-domain-separator-text",grow:!1,component:"span"},"\\"),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:s,isDraggable:r,value:o,fieldType:"keyword",isAggregatable:!0}))),null!=a&&null!=c&&i.a.createElement(l.c,{grow:!1,component:"span"},n),i.a.createElement(p.a,{contextId:e,eventId:t,hostName:a,isDraggable:r,workingDirectory:m})):null));m.displayName="UserHostWorkingDir";var y=a(4);const g=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.askedForDescription",{defaultMessage:"asked for"}),f=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.responseCodeDescription",{defaultMessage:"response code:"}),b=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.viaDescription",{defaultMessage:"via"}),h=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.whichResolvedToDescription",{defaultMessage:", which resolved to"}),v=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.withQuestionTypeDescription",{defaultMessage:"with question type"}),E=i.a.memo((({contextId:e,dnsQuestionName:t,dnsQuestionType:a,dnsResolvedIp:n,dnsResponseCode:r,eventCode:o,hostName:c,id:p,isDraggable:y,processExecutable:E,processName:x,processPid:k,userDomain:w,userName:S,winlogEventId:j})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:p,hostName:c,isDraggable:y,userDomain:w,userName:S,workingDirectory:void 0}),!Object(l.e)(t)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"asked-for",grow:!1},g),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.name",isDraggable:y,value:t,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"with-question-type",grow:!1},v),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.type",isDraggable:y,value:a,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"which-resolved-to",grow:!1},h),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.resolved_ip",isDraggable:y,value:n,isAggregatable:!0,fieldType:"ip"}))),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"response-code",grow:!1},f),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.response_code",isDraggable:y,value:r,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),i.a.createElement(l.c,{component:"span",grow:!1},b),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:p,isDraggable:y,processPid:k,processName:x,processExecutable:E})),(!Object(l.e)(o)||!Object(l.e)(j))&&i.a.createElement(i.a.Fragment,null,Object(l.e)(o)?i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,iconType:"logoWindows",field:"winlog.event_id",isDraggable:y,value:j,isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"event.code",isDraggable:y,value:o,isAggregatable:!0,fieldType:"number"})))))));E.displayName="DnsRequestEventDetailsLine";const x=i.a.memo((({data:e,contextId:t,isDraggable:a,timelineId:r})=>{const o=Object(n.get)("dns.question.name[0]",e),u=Object(n.get)("dns.question.type[0]",e),d=Object(n.get)("dns.resolved_ip[0]",e),p=Object(n.get)("dns.response_code[0]",e),m=Object(n.get)("event.code[0]",e),y=Object(n.get)("host.name[0]",e),g=e._id,f=Object(n.get)("process.executable[0]",e),b=Object(n.get)("process.name[0]",e),h=Object(n.get)("process.pid[0]",e),v=Object(n.get)("user.domain[0]",e),x=Object(n.get)("user.name[0]",e),k=Object(n.get)("winlog.event_id[0]",e);return i.a.createElement(l.b,null,i.a.createElement(E,{contextId:t,dnsQuestionName:o,dnsQuestionType:u,dnsResolvedIp:d,dnsResponseCode:p,eventCode:m,hostName:y,id:g,isDraggable:a,processExecutable:f,processName:b,processPid:h,userDomain:v,userName:x,winlogEventId:k}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:e,isDraggable:a,timelineId:r}))}));x.displayName="DnsRequestEventDetails";const k=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.aLoginWasAttemptedUsingExplicitCredentialsDescription",{defaultMessage:"A login was attempted using explicit credentials"}),w=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.asRequestedBySubjectDescription",{defaultMessage:"as requested by subject"}),S=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogInDescription",{defaultMessage:"failed to log in"}),j=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogOffDescription",{defaultMessage:"failed to log off"}),O=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.loggedOffDescription",{defaultMessage:"logged off"}),I=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeBatchDescription",{defaultMessage:"Batch"}),C=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeCachedInteractiveDescription",{defaultMessage:"Cached Interactive"}),T=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeInteractiveDescription",{defaultMessage:"Interactive"}),M=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkDescription",{defaultMessage:"Network"}),_=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkCleartextDescription",{defaultMessage:"Network Cleartext"}),N=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNewCredentialsDescription",{defaultMessage:"New Credentials"}),D=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeRemoteInteractiveDescription",{defaultMessage:"Remote Interactive"}),A=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeServiceDescription",{defaultMessage:"Service"}),F=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeUnlockDescription",{defaultMessage:"Unlock"}),q=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.subjectLogonIdDescription",{defaultMessage:"subject logon ID"}),L=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.successfullyLoggedInDescription",{defaultMessage:"successfully logged in"}),R=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.targetLogonIdDescription",{defaultMessage:"target logon ID"}),P=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.toDescription",{defaultMessage:"to"}),z=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.usingLogonTypeDescription",{defaultMessage:"using logon type"}),B=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.viaDescription",{defaultMessage:"via"}),$=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.withSpecialPrivilegesDescription",{defaultMessage:"With special privileges,"}),G=e=>{if(Object(l.e)(e))return"";switch(e){case 2:return T;case 3:return M;case 4:return I;case 5:return A;case 7:return F;case 8:return _;case 9:return N;case 10:return D;case 11:return C;default:return`${e}`}},U=e=>"explicit_user_logon"===e||"user_logoff"===e,V=i.a.memo((({contextId:e,endgameLogonType:t,endgameSubjectDomainName:a,endgameSubjectLogonId:n,endgameSubjectUserName:r,endgameTargetDomainName:o,endgameTargetLogonId:c,endgameTargetUserName:p,eventAction:y,eventCode:g,eventOutcome:f,hostName:b,id:h,isDraggable:v,processExecutable:E,processName:x,processPid:I,userDomain:C,userName:T,winlogEventId:M})=>{const _=U(y)?o:C,N=(({eventAction:e,eventOutcome:t})=>{switch(e){case"explicit_user_logon":return"";case"log_off":case"user_logoff":return"failure"===(null==t?void 0:t.toLowerCase())?j:O;default:return"failure"===(null==t?void 0:t.toLowerCase())?S:L}})({eventAction:y,eventOutcome:f}),D=(e=>"explicit_user_logon"===e?P:"@")(y),A=U(y)?p:T,F=(e=>U(e)?"endgame.target_domain_name":"user.domain")(y),V=(e=>U(e)?"endgame.target_user_name":"user.name")(y);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},"admin_logon"===y&&i.a.createElement(l.c,{component:"span","data-test-subj":"with-special-privileges",grow:!1},$),"explicit_user_logon"===y&&i.a.createElement(l.c,{component:"span","data-test-subj":"a-login-was-attempted",grow:!1},k),i.a.createElement(m,{contextId:e,eventId:h,hostName:b,hostNameSeparator:D,isDraggable:v,userDomain:_,userDomainField:F,userName:A,userNameField:V,workingDirectory:void 0}),i.a.createElement(l.c,{component:"span","data-test-subj":"event-details",grow:!1},N),!Object(l.e)(t)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},z),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.logon_type",isDraggable:v,queryValue:String(t),value:`${t} - ${G(t)}`,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(c)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},R),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.target_logon_id",isDraggable:v,value:c,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),i.a.createElement(l.c,{component:"span",grow:!1},B),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:h,isDraggable:v,processPid:I,processName:x,processExecutable:E})),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"as-requested-by-subject",grow:!1},w),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_user_name",isDraggable:v,iconType:"user",value:r,isAggregatable:!0,fieldType:"keyword"}))),null!=a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"subject-domain-name-domain-separator-text",grow:!1},"\\"),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_domain_name",isDraggable:v,value:a,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"subject-login-id",grow:!1},q),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_logon_id",isDraggable:v,value:n,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),(!Object(l.e)(g)||!Object(l.e)(M))&&i.a.createElement(i.a.Fragment,null,Object(l.e)(g)?i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,iconType:"logoWindows",field:"winlog.event_id",value:M,isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"event.code",value:g,isAggregatable:!0,fieldType:"keyword"})))))}));V.displayName="EndgameSecurityEventDetailsLine";const H=i.a.memo((({data:e,contextId:t,isDraggable:a,timelineId:r})=>{const o=Object(n.get)("endgame.logon_type[0]",e),u=Object(n.get)("endgame.subject_domain_name[0]",e),d=Object(n.get)("endgame.subject_logon_id[0]",e),p=Object(n.get)("endgame.subject_user_name[0]",e),m=Object(n.get)("endgame.target_logon_id[0]",e),y=Object(n.get)("endgame.target_domain_name[0]",e),g=Object(n.get)("endgame.target_user_name[0]",e),f=Object(n.get)("event.action[0]",e),b=Object(n.get)("event.code[0]",e),h=Object(n.get)("event.outcome[0]",e),v=Object(n.get)("host.name[0]",e),E=e._id,x=Object(n.get)("process.executable[0]",e),k=Object(n.get)("process.name[0]",e),w=Object(n.get)("process.pid[0]",e),S=Object(n.get)("user.domain[0]",e),j=Object(n.get)("user.name[0]",e),O=Object(n.get)("winlog.event_id[0]",e);return i.a.createElement(l.b,null,i.a.createElement(V,{contextId:t,endgameLogonType:o,endgameSubjectDomainName:u,endgameSubjectLogonId:d,endgameSubjectUserName:p,endgameTargetDomainName:y,endgameTargetLogonId:m,endgameTargetUserName:g,eventAction:f,eventCode:b,eventOutcome:h,hostName:v,id:E,isDraggable:a,processExecutable:x,processName:k,processPid:w,userDomain:S,userName:j,winlogEventId:O}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:e,timelineId:r}))}));H.displayName="EndgameSecurityEventDetails";const W=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.viaDescription",{defaultMessage:"via"}),Y=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.withNewValueDescription",{defaultMessage:"with new value"}),Z=({contextId:e,hostName:t,id:a,isDraggable:n,processName:o,processPid:c,registryKey:p,registryPath:y,text:g,userDomain:f,userName:b})=>{const h=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"registry.key"),i.a.createElement("div",null,p))),[p]),v=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"registry.path"),i.a.createElement("div",null,y))),[y]);return Object(l.e)(p)?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:a,hostName:t,isDraggable:n,userDomain:f,userName:b,workingDirectory:void 0}),!Object(l.e)(p)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"text",grow:!1},g),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:a,field:"registry.key",isDraggable:n,tooltipContent:h,value:p,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(y)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"with-new-value",grow:!1},Y),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:a,field:"registry.path",isDraggable:n,tooltipContent:v,value:y,isAggregatable:!0,fieldType:"keyword"}))),i.a.createElement(l.c,{component:"span",grow:!1},W),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:a,isDraggable:n,processPid:c,processName:o,processExecutable:void 0}))))},K=i.a.memo(Z),Q=({contextId:e,data:t,isDraggable:a,text:r})=>{const o=Object(n.get)("host.name[0]",t),s=t._id,c=Object(n.get)("process.name[0]",t),u=Object(n.get)("process.pid[0]",t),d=Object(n.get)("registry.key[0]",t),p=Object(n.get)("registry.path[0]",t),m=Object(n.get)("user.domain[0]",t),y=Object(n.get)("user.name[0]",t);return Object(l.e)(d)?null:i.a.createElement(l.b,null,i.a.createElement(K,{contextId:e,hostName:o,id:s,isDraggable:a,processName:c,processPid:u,registryKey:d,registryPath:p,text:r,userDomain:m,userName:y}))};Q.displayName="RegistryEventDetailsComponent";const X=i.a.memo(Q);var J=a(315),ee=a(485),te=a(230);const ae=i.a.memo((({contextId:e,eventId:t,isDraggable:a,packageName:n,packageSummary:r,packageVersion:o})=>null!=n||null!=r||null!=o?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:a,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:a,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.summary",isDraggable:a,value:r,isAggregatable:!0,fieldType:"keyword"}))):null));ae.displayName="Package";const ne=i.a.memo((({contextId:e,eventId:t,isDraggable:a,sshSignature:n,sshMethod:r})=>i.a.createElement(i.a.Fragment,null,null!=n&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:a,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),null!=r&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:a,value:r,iconType:"document",isAggregatable:!0,fieldType:"keyword"})))));ne.displayName="AuthSsh";var re=a(196);const ie=i.a.memo((({contextId:e,hostName:t,id:a,isDraggable:n,message:r,outcome:o,packageName:c,packageSummary:p,packageVersion:y,processPid:g,processName:f,processExecutable:b,sshSignature:h,sshMethod:v,text:E,userDomain:x,userName:k,workingDirectory:w})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:a,hostName:t,isDraggable:n,userDomain:x,userName:k,workingDirectory:w}),i.a.createElement(l.c,{grow:!1,component:"span"},E),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(d.a,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:a,isDraggable:n,processPid:g,processName:f,processExecutable:b})),null!=o&&i.a.createElement(l.c,{grow:!1,component:"span"},te.W),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"event.outcome",isDraggable:n,queryValue:o,value:o,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(ne,{contextId:e,eventId:a,isDraggable:n,sshSignature:h,sshMethod:v}),i.a.createElement(ae,{contextId:e,eventId:a,isDraggable:n,packageName:c,packageSummary:p,packageVersion:y})),null!=r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(re.b,{iconType:"editorComment",color:"hollow",title:""},i.a.createElement(ee.a,{value:r}))))))));ie.displayName="SystemGenericLine";const oe=i.a.memo((({contextId:e,data:t,isDraggable:a,text:r,timelineId:o})=>{const u=t._id,d=null!=t.message?t.message[0]:null,p=Object(n.get)("host.name[0]",t),m=Object(n.get)("user.domain[0]",t),y=Object(n.get)("user.name[0]",t),g=Object(n.get)("event.outcome[0]",t),f=Object(n.get)("system.audit.package.name[0]",t),b=Object(n.get)("system.audit.package.summary[0]",t),h=Object(n.get)("system.audit.package.version[0]",t),v=Object(n.get)("process.pid[0]",t),E=Object(n.get)("process.name[0]",t),x=Object(n.get)("process.executable[0]",t),k=Object(n.get)("system.auth.ssh.signature[0]",t),w=Object(n.get)("system.auth.ssh.method[0]",t),S=Object(n.get)("process.working_directory[0]",t);return i.a.createElement(l.b,null,i.a.createElement(ie,{contextId:e,hostName:p,id:u,isDraggable:a,message:d,outcome:g,packageName:f,packageSummary:b,packageVersion:h,processExecutable:x,processPid:v,processName:E,sshMethod:w,sshSignature:k,text:r,userDomain:m,userName:y,workingDirectory:S}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:t,isDraggable:a,timelineId:o}))}));oe.displayName="SystemGenericDetails";var se=a(593);const le=i.a.memo((({contextId:e,endgameExitCode:t,eventId:a,isDraggable:n,processExitCode:r,text:o})=>Object(l.e)(r)&&Object(l.e)(t)?null:i.a.createElement(i.a.Fragment,null,!Object(l.e)(o)&&i.a.createElement(l.c,{"data-test-subj":"exit-code-draggable-text",grow:!1,component:"span"},o),!Object(l.e)(r)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.exit_code",isDraggable:n,value:`${r}`,fieldType:"number",isAggregatable:!0})),!Object(l.e)(t)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.exit_code",isDraggable:n,value:t,fieldType:"number",isAggregatable:!0})))));le.displayName="ExitCodeDraggable";var ce=a(434);const ue=i.a.memo((({contextId:e,endgameFileName:t,endgameFilePath:a,eventId:n,fileExtOriginalPath:r,fileName:o,filePath:s,isDraggable:c})=>{if(Object(l.e)(o)&&Object(l.e)(t)&&Object(l.e)(s)&&Object(l.e)(a))return null;const d=!Object(l.e)(s)||!Object(l.e)(a);return i.a.createElement(i.a.Fragment,null,Object(l.e)(o)?Object(l.e)(t)?null:i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.file_name",isDraggable:c,value:t,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"file.name",isDraggable:c,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),d&&i.a.createElement(l.c,{"data-test-subj":"in",grow:!1,component:"span"},ce.e),Object(l.e)(s)?Object(l.e)(a)?null:i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.file_path",isDraggable:c,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"file.path",isDraggable:c,value:s,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},ce.d),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"file.Ext.original.path",isDraggable:c,value:r,iconType:"document",isAggregatable:!0,fieldType:"keyword"}))))}));ue.displayName="FileDraggable";var de=a(41),pe=a.n(de);const me=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-ezi1kd-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ye=i.a.memo((({contextId:e,eventId:t,fileHashSha256:a,isDraggable:n})=>Object(l.e)(a)?null:i.a.createElement(me,{alignItems:"center",direction:"column",gutterSize:"none"},i.a.createElement(l.c,{grow:!1,component:"div"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"file.hash.sha256",isDraggable:n,iconType:"number",value:a,isAggregatable:!0,fieldType:"keyword"})))));ye.displayName="FileHash";const ge=i.a.memo((({contextId:e,endgameParentProcessName:t,eventId:a,isDraggable:n,processParentName:r,processParentPid:o,processPpid:s,text:c})=>Object(l.e)(r)&&Object(l.e)(t)?null:i.a.createElement(i.a.Fragment,null,!Object(l.e)(c)&&i.a.createElement(l.c,{"data-test-subj":"parent-process-draggable-text",grow:!1,component:"span"},c),!Object(l.e)(r)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.parent.name",isDraggable:n,value:r,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(t)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.parent_process_name",isDraggable:n,value:t,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(o)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.parent.pid",isDraggable:n,queryValue:String(o),value:`(${String(o)})`,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(s)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.ppid",isDraggable:n,queryValue:String(s),value:`(${String(s)})`,fieldType:"keyword",isAggregatable:!0})))));ge.displayName="ParentProcessDraggable";const fe=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-joyfnh-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),be=i.a.memo((({contextId:e,eventId:t,isDraggable:a,processHashSha256:n})=>Object(l.e)(n)?null:i.a.createElement(fe,{alignItems:"center",direction:"column",gutterSize:"none"},i.a.createElement(l.c,{grow:!1,component:"div"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"process.hash.sha256",iconType:"number",isDraggable:a,value:n,fieldType:"keyword",isAggregatable:!0})))));be.displayName="ProcessHash";const he=i.a.memo((({args:e,contextId:t,endgameExitCode:a,endgameFileName:n,endgameFilePath:r,endgameParentProcessName:o,endgamePid:c,endgameProcessName:p,eventAction:y,fileExtOriginalPath:g,fileHashSha256:f,fileName:b,filePath:h,hostName:v,id:E,isDraggable:x,message:k,outcome:w,packageName:S,processParentName:j,processParentPid:O,processExitCode:I,packageSummary:C,packageVersion:T,processExecutable:M,processHashSha256:_,processName:N,processPid:D,processPpid:A,processTitle:F,showMessage:q,skipRedundantFileDetails:L=!1,skipRedundantProcessDetails:R=!1,sshSignature:P,sshMethod:z,text:B,userDomain:$,userName:G,workingDirectory:U})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{eventId:E,contextId:t,isDraggable:x,userDomain:$,userName:G,workingDirectory:U,hostName:v}),i.a.createElement(l.c,{grow:!1,component:"span"},B),!L&&i.a.createElement(ue,{contextId:t,endgameFileName:n,endgameFilePath:r,eventId:E,fileExtOriginalPath:g,fileName:b,filePath:h,isDraggable:x}),Object(l.g)(y)&&i.a.createElement(l.c,{"data-test-subj":"via",grow:!1,component:"span"},te.L),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(d.b,{contextId:t,endgamePid:c,endgameProcessName:p,eventId:E,isDraggable:x,processPid:D,processName:N,processExecutable:M})),i.a.createElement(se.a,{args:e,contextId:t,eventId:E,processTitle:F,isDraggable:x}),i.a.createElement(le,{contextId:t,endgameExitCode:a,eventId:E,isDraggable:x,processExitCode:I,text:te.V}),!Object(l.f)(y)&&i.a.createElement(ge,{contextId:t,endgameParentProcessName:o,eventId:E,isDraggable:x,processParentName:j,processParentPid:O,processPpid:A,text:te.M}),null!=w&&i.a.createElement(l.c,{grow:!1,component:"span"},te.W),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:t,eventId:E,field:"event.outcome",isDraggable:x,queryValue:w,value:w,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(ne,{contextId:t,eventId:E,isDraggable:x,sshSignature:P,sshMethod:z}),i.a.createElement(ae,{contextId:t,eventId:E,isDraggable:x,packageName:S,packageSummary:C,packageVersion:T})),!L&&i.a.createElement(ye,{contextId:t,eventId:E,fileHashSha256:f,isDraggable:x}),!R&&i.a.createElement(be,{contextId:t,eventId:E,isDraggable:x,processHashSha256:_}),null!=k&&q&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(re.b,{iconType:"editorComment",color:"hollow",title:""},i.a.createElement(ee.a,{value:k}))))))));he.displayName="SystemGenericFileLine";const ve=i.a.memo((({contextId:e,data:t,isDraggable:a,showMessage:r=!0,skipRedundantFileDetails:o=!1,skipRedundantProcessDetails:u=!1,text:d,timelineId:p})=>{const m=t._id,y=null!=t.message?t.message[0]:null,g=Object(n.get)("host.name[0]",t),f=Object(n.get)("endgame.exit_code[0]",t),b=Object(n.get)("endgame.file_name[0]",t),h=Object(n.get)("endgame.file_path[0]",t),v=Object(n.get)("endgame.parent_process_name[0]",t),E=Object(n.get)("endgame.pid[0]",t),x=Object(n.get)("endgame.process_name[0]",t),k=Object(n.get)("event.action[0]",t),w=Object(n.get)("file.Ext.original.path[0]",t),S=Object(n.get)("file.hash.sha256[0]",t),j=Object(n.get)("file.name[0]",t),O=Object(n.get)("file.path[0]",t),I=Object(n.get)("user.domain[0]",t),C=Object(n.get)("user.name[0]",t),T=Object(n.get)("event.outcome[0]",t),M=Object(n.get)("system.audit.package.name[0]",t),_=Object(n.get)("system.audit.package.summary[0]",t),N=Object(n.get)("system.audit.package.version[0]",t),D=Object(n.get)("process.exit_code[0]",t),A=Object(n.get)("process.parent.name[0]",t),F=Object(n.get)("process.parent.pid[0]",t),q=Object(n.get)("process.hash.sha256[0]",t),L=Object(n.get)("process.pid[0]",t),R=Object(n.get)("process.ppid[0]",t),P=Object(n.get)("process.name[0]",t),z=Object(n.get)("system.auth.ssh.signature[0]",t),B=Object(n.get)("system.auth.ssh.method[0]",t),$=Object(n.get)("process.executable[0]",t),G=Object(n.get)("process.title[0]",t),U=Object(n.get)("process.working_directory[0]",t),V=Object(n.get)("process.args",t);return i.a.createElement(l.b,null,i.a.createElement(he,{id:m,contextId:e,text:d,hostName:g,endgameExitCode:f,endgameFileName:b,endgameFilePath:h,endgameParentProcessName:v,endgamePid:E,endgameProcessName:x,eventAction:k,fileExtOriginalPath:w,fileHashSha256:S,fileName:j,filePath:O,userDomain:I,userName:C,message:y,processExitCode:D,processParentName:A,processParentPid:F,processTitle:G,workingDirectory:U,args:V,packageName:M,packageSummary:_,packageVersion:N,processHashSha256:q,processName:P,processPid:L,processPpid:R,processExecutable:$,showMessage:r,skipRedundantFileDetails:o,skipRedundantProcessDetails:u,sshSignature:z,sshMethod:B,outcome:T,isDraggable:a}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:t,isDraggable:a,timelineId:p}))}));ve.displayName="SystemGenericFileDetails";const Ee=({actionName:e,text:t})=>({id:o.e.system,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"system"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(oe,{contextId:`${e}-${r}`,data:a,isDraggable:n,text:t,timelineId:r}))}),xe=({actionName:e,text:t})=>({id:o.e.system_file,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.category[0]",t),i=Object(n.get)("event.dataset[0]",t);return("process"===(null==r?void 0:r.toLowerCase())||"endpoint.events.process"===(null==i?void 0:i.toLowerCase()))&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{data:a,contextId:`endgame-process-${e}-${r}`,isDraggable:n,showMessage:!1,text:t,timelineId:r}))}),ke=({actionName:e,text:t})=>({id:o.e.system_fim,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.category[0]",t),i=Object(n.get)("event.dataset[0]",t);return Object(l.d)({eventCategory:r,eventDataset:i})&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{data:a,contextId:`fim-${e}-${r}`,isDraggable:n,showMessage:!1,text:t,timelineId:r}))}),we=({eventAction:e,eventCategory:t,eventType:a,skipRedundantFileDetails:r=!1,skipRedundantProcessDetails:s=!1,text:l})=>({id:o.e.alerts,isInstance:r=>{var i,o,s;const l=Object(n.get)("event.action",r),c=Object(n.get)("event.category",r),u=Object(n.get)("event.dataset[0]",r),d=Object(n.get)("event.type",r),p=null!==(i=null==l?void 0:l.includes(e))&&void 0!==i&&i,m=null!==(o=null==c?void 0:c.includes(t))&&void 0!==o&&o,y=null!==(s=null==d?void 0:d.includes(a))&&void 0!==s&&s;return"endpoint.alerts"===(null==u?void 0:u.toLowerCase())&&y&&m&&p},renderRow:({data:n,isDraggable:o,scopeId:c})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`endpoint-alerts-row-renderer-${e}-${t}-${a}-${c}`,data:n,isDraggable:o,showMessage:!1,skipRedundantFileDetails:r,skipRedundantProcessDetails:s,text:l,timelineId:c}))}),Se=({actionName:e,text:t})=>({id:o.e.library,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.dataset[0]",t);return"endpoint.events.library"===(null==r?void 0:r.toLowerCase())&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`library-row-renderer-${e}-${r}`,data:a,isDraggable:n,showMessage:!1,text:t,timelineId:r}))}),je=({actionName:e,text:t})=>({id:o.e.system_file,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"system"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`${e}-${r}`,data:a,isDraggable:n,text:t,timelineId:r}))}),Oe=({actionName:e,text:t})=>({id:o.e.system_socket,isInstance:t=>{const a=Object(n.get)("event.action[0]",t);return null!=a&&a.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`socket-${e}-${r}`,data:a,isDraggable:n,text:t,timelineId:r}))}),Ie=({actionName:e})=>({id:o.e.system_security_event,isInstance:t=>{const a=Object(n.get)("event.category[0]",t),r=Object(n.get)("event.action[0]",t),i=Object(n.get)("event.dataset[0]",t);return("authentication"===(null==a?void 0:a.toLowerCase())||"endpoint.events.security"===(null==i?void 0:i.toLowerCase()))&&(null==r?void 0:r.toLowerCase())===e},renderRow:({data:t,isDraggable:a,scopeId:n})=>i.a.createElement(J.a,null,i.a.createElement(H,{contextId:`authentication-${e}-${n}`,data:t,isDraggable:a,timelineId:n}))}),Ce=()=>({id:o.e.system_dns,isInstance:e=>{const t=Object(n.get)("dns.question.type[0]",e),a=Object(n.get)("dns.question.name[0]",e);return!Object(l.e)(t)&&!Object(l.e)(a)},renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(J.a,null,i.a.createElement(x,{contextId:`dns-request-${a}`,data:e,isDraggable:t,timelineId:a}))}),Te=({actionName:e,text:t})=>({id:o.e.registry,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.dataset[0]",t);return"endpoint.events.registry"===(null==r?void 0:r.toLowerCase())&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:e,isDraggable:a,scopeId:n})=>i.a.createElement(J.a,null,i.a.createElement(X,{contextId:`registry-event-${n}`,data:e,isDraggable:a,text:t}))}),Me=Ee({actionName:"user_login",text:te.c}),_e=je({actionName:"process_started",text:te.A}),Ne=xe({actionName:"creation_event",text:te.A}),De=xe({actionName:"start",text:te.A}),Ae=Te({actionName:"modification",text:te.u}),Fe=je({actionName:"process_stopped",text:te.B}),qe=xe({actionName:"termination_event",text:te.H}),Le=xe({actionName:"end",text:te.H}),Re=ke({actionName:"file_create_event",text:te.e}),Pe=ke({actionName:"creation",text:te.e}),ze=ke({actionName:"created",text:te.e}),Be=ke({actionName:"file_delete_event",text:te.f}),$e=ke({actionName:"deletion",text:te.f}),Ge=ke({actionName:"modification",text:te.t}),Ue=ke({actionName:"overwrite",text:te.v}),Ve=ke({actionName:"rename",text:te.E}),He=ke({actionName:"deleted",text:te.f}),We=je({actionName:"existing_process",text:te.k}),Ye=[{eventAction:"creation",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.R},{eventAction:"creation",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.N},{eventAction:"files-encrypted",eventCategory:"file",eventType:"denied",skipRedundantFileDetails:!0,text:te.D},{eventAction:"files-encrypted",eventCategory:"file",eventType:"allowed",skipRedundantFileDetails:!0,text:te.C},{eventAction:"modification",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.T},{eventAction:"modification",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.P},{eventAction:"rename",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.U},{eventAction:"rename",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.Q},{eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:te.S},{eventAction:"execution",eventCategory:"process",eventType:"allowed",skipRedundantFileDetails:!0,text:te.O}].map((e=>we(e))),Ze=Se({actionName:"load",text:te.q}),Ke=Oe({actionName:"socket_opened",text:te.G}),Qe=Oe({actionName:"socket_closed",text:te.F}),Xe=Oe({actionName:"ipv4_connection_accept_event",text:te.b}),Je=Oe({actionName:"connection_accepted",text:te.b}),et=Oe({actionName:"http_request",text:te.s}),tt=xe({actionName:"exec",text:te.i}),at=xe({actionName:"fork",text:te.n}),nt=Oe({actionName:"ipv6_connection_accept_event",text:te.b}),rt=Oe({actionName:"ipv4_disconnect_received_event",text:te.g}),it=Oe({actionName:"disconnect_received",text:te.g}),ot=Oe({actionName:"ipv6_disconnect_received_event",text:te.g}),st=Ie({actionName:"admin_logon"}),lt=Ie({actionName:"explicit_user_logon"}),ct=Ie({actionName:"user_logoff"}),ut=Ie({actionName:"user_logon"}),dt=Ie({actionName:"log_on"}),pt=Ce(),mt=Ee({actionName:"existing_user",text:te.m}),yt=je({actionName:"existing_socket",text:te.l}),gt=Ee({actionName:"existing_package",text:te.j}),ft=je({actionName:"invalid",text:te.p}),bt=Ee({actionName:"user_changed",text:te.J}),ht=Ee({actionName:"host",text:te.o}),vt=Ee({actionName:"user_added",text:te.I}),Et=Ee({actionName:"user_logout",text:te.r}),xt=Ie({actionName:"log_off"}),kt=je({actionName:"process_error",text:te.z}),wt=Ee({actionName:"error:",text:te.h}),St=Ee({actionName:"error",text:te.h}),jt=Ee({actionName:"package_installed",text:te.w}),Ot=Ee({actionName:"boot",text:te.d}),It=[pt,st,lt,Re,Pe,Be,$e,Ue,Ve,...Ye,Ze,Ge,Ae,Xe,Je,et,tt,at,nt,rt,it,ot,Ne,De,qe,Le,ct,ut,dt,ze,He,Ee({actionName:"accepted",text:te.a}),Ot,St,wt,gt,We,yt,mt,ht,ft,Me,Et,xt,jt,Ee({actionName:"package_updated",text:te.y}),Ee({actionName:"package_removed",text:te.x}),kt,_e,Fe,Qe,Ke,vt,bt,Ee({actionName:"user_removed",text:te.K})]},244:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"l",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"n",(function(){return y})),a.d(t,"b",(function(){return g})),a.d(t,"k",(function(){return f})),a.d(t,"a",(function(){return b})),a.d(t,"m",(function(){return h})),a.d(t,"o",(function(){return v}));var n=a(4),r=a(264);a.d(t,"p",(function(){return r.d}));const i=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.feedNamePreposition",{defaultMessage:"from"}),o=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTitle",{defaultMessage:"Threat match detected"}),s=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTitle",{defaultMessage:"Enriched with threat intelligence"}),l=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTooltipContent",{defaultMessage:"Shows available threat indicator matches."}),c=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTooltipContent",{defaultMessage:"Shows additional threat intelligence for the alert. The past 30 days were queried by default."}),u=(n.i18n.translate("xpack.securitySolution.alertDetails.noInvestigationEnrichmentsDescription",{defaultMessage:"This alert does not have supplemental threat intelligence data."}),n.i18n.translate("xpack.securitySolution.alertDetails.noEnrichmentsFoundDescription",{defaultMessage:"This alert does not have threat intelligence."})),d=n.i18n.translate("xpack.securitySolution.alertDetails.investigationTimeQueryTitle",{defaultMessage:"Enrichment with Threat Intelligence"}),p=n.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryStartDate",{defaultMessage:"Start date"}),m=n.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryEndDate",{defaultMessage:"End date"}),y=n.i18n.translate("xpack.securitySolution.alertDetails.refresh",{defaultMessage:"Refresh"}),g=n.i18n.translate("xpack.securitySolution.alertDetails.overview.enrichedDataTitle",{defaultMessage:"Enriched data"}),f=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentObjectValuesNotRendered",{defaultMessage:"This field contains nested object values, which are not rendered here. See the full document for all fields/values"}),b=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskLevel",{defaultMessage:"Current {riskEntity} risk level",values:{riskEntity:Object(r.e)(e,!0)}}),h=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.originalHostRiskLevel",{defaultMessage:"Original {riskEntity} risk level",values:{riskEntity:Object(r.e)(e,!0)}}),v=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskDataTitle",{defaultMessage:"{riskEntity} Risk Data",values:{riskEntity:Object(r.e)(e)}})},248:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));let n=function(e){return e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions",e}({}),r=function(e){return e.IndexPatterns="indexPatterns",e.DataView="dataView",e}({}),i=function(e){return e.PerRuleExecution="per-rule-execution",e.PerTimePeriod="per-time-period",e}({})},253:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"g",(function(){return i})),a.d(t,"h",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"k",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"o",(function(){return u})),a.d(t,"n",(function(){return d})),a.d(t,"m",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"u",(function(){return y})),a.d(t,"t",(function(){return g})),a.d(t,"s",(function(){return f})),a.d(t,"r",(function(){return b})),a.d(t,"d",(function(){return h})),a.d(t,"b",(function(){return v})),a.d(t,"a",(function(){return E})),a.d(t,"c",(function(){return x})),a.d(t,"p",(function(){return k})),a.d(t,"q",(function(){return w})),a.d(t,"f",(function(){return S})),a.d(t,"v",(function(){return j})),a.d(t,"w",(function(){return O}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights",{defaultMessage:"Insights"}),i=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry",{defaultMessage:"Related alerts by process ancestry"}),o=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} by process ancestry",values:{count:e}}),s=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_error",{defaultMessage:"Failed to fetch alerts."}),l=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.processAncestryFilter",{defaultMessage:"Process Ancestry Alert IDs"}),c=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_empty",{defaultMessage:"There are no related alerts by process ancestry."}),u=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),d=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_error",{defaultMessage:"Failed to load related alerts by session"}),p=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_empty",{defaultMessage:"There are no related alerts by session"}),m=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by session",values:{count:e}}),y=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),g=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_error",{defaultMessage:"Failed to load related alerts by source event"}),f=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_empty",{defaultMessage:"There are no related alerts by source event"}),b=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights_related_alerts_by_source_event_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by source event",values:{count:e}}),h=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_loading",{defaultMessage:"Loading related cases"}),v=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_error",{defaultMessage:"Failed to load related cases"}),E=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_count",{defaultMessage:"{count} {count, plural, =1 {case} other {cases}} related to this alert",values:{count:e}}),x=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.relatedCasesFailure",{defaultMessage:'Unable to load related cases: "{error}"',values:{error:e}}),k=n.i18n.translate("xpack.securitySolution.alertDetails.overview.simpleAlertTable.error",{defaultMessage:"Failed to load the alerts."}),w=n.i18n.translate("xpack.securitySolution.alertDetails.overview.limitedAlerts",{defaultMessage:"Showing only the latest 10 alerts. View the rest of alerts in timeline."}),S=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.alertUpsellTitle",{defaultMessage:"Get more insights with a platinum subscription"}),j=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCount",{defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),O=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCountTechnicalPreview",{defaultMessage:"Technical Preview"})},259:function(e,t,a){"use strict";a.d(t,"f",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"a",(function(){return y}));var n=a(50),r=a(245);const i=r.b.length,o=e=>{var t;return(null!==(t=e.tags)&&void 0!==t?t:[]).includes(r.e)},s=e=>!o(e),l=e=>{var t;const a=[],n=null!==(t=e.tags)&&void 0!==t?t:[];for(const e of n)e!==r.e&&e.startsWith(r.b)&&a.push(e.substring(i));return a},c=e=>e.startsWith(r.b)||e===r.e,u=e=>e.isGlobal?[r.e]:e.selected.map((e=>`${r.b}${e.id}`)),d=(e,t)=>e.find((e=>e===r.e))?{isGlobal:!0,selected:[]}:{isGlobal:!1,selected:e.reduce(((e,a)=>{const n=a.split(":")[1],r=t.find((e=>e.id===n));return void 0!==r&&e.push(r),e}),[])},p=e=>{var t;return(null!==(t=e.tags)&&void 0!==t?t:[]).includes(r.d)},m=e=>e===r.d,y=e=>({comments:[],description:"",entries:[],item_id:void 0,list_id:e,meta:{temporaryUuid:Object(n.v4)()},name:"",namespace_type:"agnostic",tags:[r.e],type:"simple",os_types:["windows"]})},264:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"e",(function(){return y})),a.d(t,"a",(function(){return f}));var n=a(4),r=a(137);const i=n.i18n.translate("xpack.securitySolution.riskScore.overview.hostTitle",{defaultMessage:"Host"}),o=n.i18n.translate("xpack.securitySolution.riskScore.overview.hosts",{defaultMessage:"Hosts"}),s=n.i18n.translate("xpack.securitySolution.riskScore.overview.userTitle",{defaultMessage:"User"}),l=n.i18n.translate("xpack.securitySolution.riskScore.overview.users",{defaultMessage:"Users"}),c=n.i18n.translate("xpack.securitySolution.riskScore.overview.entityTitle",{defaultMessage:"Entity"}),u=n.i18n.translate("xpack.securitySolution.riskScore.overview.entities",{defaultMessage:"Entities"}),d=e=>n.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoreTitle",{defaultMessage:"{riskEntity} Risk Score",values:{riskEntity:y(e)}}),p=n.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoringTitle",{defaultMessage:"Entity Risk Scoring"}),m=e=>n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskLevelTitle",{defaultMessage:"{riskEntity} risk level",values:{riskEntity:y(e)}}),y=(e,t=!1,a=!1)=>{const n=g(e,a);return t?n.toLowerCase():n},g=(e,t)=>{switch(e){case r.t.host:return t?o:i;case r.t.user:return t?l:s;default:return t?u:c}},f=n.i18n.translate("xpack.securitySolution.riskScore.overview.alerts",{defaultMessage:"Alerts"})},278:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(44),r=a(2),i=a.n(r),o=a(433),s=a(629),l=a(520),c=a(590),u=a(406),d=a(630),p=a(859),m=a(592),y=a(382),g=a(591),f=a(569),b=a(486);const h=i.a.memo((({data:e,timelineId:t,isDraggable:a})=>i.a.createElement(p.a,{contextId:`netflow-renderer-${t}-${e._id}`,destinationBytes:Object(o.a)(Object(n.get)(f.a,e)),destinationGeoContinentName:Object(o.a)(Object(n.get)(g.b,e)),destinationGeoCountryName:Object(o.a)(Object(n.get)(g.d,e)),destinationGeoCountryIsoCode:Object(o.a)(Object(n.get)(g.c,e)),destinationGeoRegionName:Object(o.a)(Object(n.get)(g.e,e)),destinationGeoCityName:Object(o.a)(Object(n.get)(g.a,e)),destinationIp:Object(o.a)(Object(n.get)(u.a,e)),destinationPackets:Object(o.a)(Object(n.get)(f.b,e)),destinationPort:Object(o.a)(Object(n.get)(y.a,e)),eventDuration:Object(o.a)(Object(n.get)(l.b,e)),eventId:Object(n.get)(c.a,e),eventEnd:Object(o.a)(Object(n.get)(m.b,e)),eventStart:Object(o.a)(Object(n.get)(m.c,e)),isDraggable:a,networkBytes:Object(o.a)(Object(n.get)(b.a,e)),networkCommunityId:Object(o.a)(Object(n.get)(b.b,e)),networkDirection:Object(o.a)(Object(n.get)(b.c,e)),networkPackets:Object(o.a)(Object(n.get)(b.d,e)),networkProtocol:Object(o.a)(Object(n.get)(b.e,e)),sourceBytes:Object(o.a)(Object(n.get)(f.c,e)),sourceGeoContinentName:Object(o.a)(Object(n.get)(g.h,e)),sourceGeoCountryName:Object(o.a)(Object(n.get)(g.j,e)),sourceGeoCountryIsoCode:Object(o.a)(Object(n.get)(g.i,e)),sourceGeoRegionName:Object(o.a)(Object(n.get)(g.k,e)),sourceGeoCityName:Object(o.a)(Object(n.get)(g.g,e)),sourceIp:Object(o.a)(Object(n.get)(u.d,e)),sourcePackets:Object(o.a)(Object(n.get)(f.d,e)),sourcePort:Object(o.a)(Object(n.get)(y.c,e)),tlsClientCertificateFingerprintSha1:Object(o.a)(Object(n.get)(s.b,e)),tlsFingerprintsJa3Hash:Object(o.a)(Object(n.get)(d.a,e)),tlsServerCertificateFingerprintSha1:Object(o.a)(Object(n.get)(s.c,e)),transport:Object(o.a)(Object(n.get)(b.f,e)),userName:void 0})));h.displayName="NetflowRenderer"},279:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(19),r=a(2),i=a.n(r),o=a(118),s=a(484);const l="closed",c="open",u=(e,t)=>{const{storage:a,title:n}=t;if(a&&n){const t=a.get(s.a.OVERVIEW_TAB_EXPANDED_SECTIONS);a.set(s.a.OVERVIEW_TAB_EXPANDED_SECTIONS,{...t,[n]:e!==c})}return e===l?c:l},d="Header",p="Content",m=({expanded:e,title:t,children:a,gutterSize:s="none",localStorageKey:m,"data-test-subj":y})=>{const g=Object(n.useGeneratedHtmlId)({prefix:"accordion"}),{renderContent:f,state:b,toggle:h}=(e=>{const{storage:t}=Object(o.j)().services,a=e?c:l,[n,i]=Object(r.useReducer)(u,a);return{renderContent:n===c,state:n,toggle:e=>{i({storage:t,title:e})}}})(e),v=y+d,E=y+p,x=i.a.createElement(n.EuiTitle,{size:"xs","data-test-subj":v},i.a.createElement("h4",null,t));return i.a.createElement(n.EuiAccordion,{forceState:b,onToggle:()=>h(m),id:g,buttonContent:x},i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(n.EuiFlexGroup,{gutterSize:s,direction:"column","data-test-subj":E},f&&a))};m.displayName="ExpandableSection"},298:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a.n(n),i=a(44),o=a(49),s=a(1378);const{euiColorVis0:l,euiColorVis5:c,euiColorVis7:u,euiColorVis9:d}=o.euiLightVars,p={low:l,medium:c,high:u,critical:d},m=({value:e,"data-test-subj":t="severity"})=>{var a;const n=Object(i.upperFirst)(e),o=null!==(a=p[e])&&void 0!==a?a:"subdued";return r.a.createElement(s.a,{healthColor:o,tooltipContent:n,dataTestSubj:t},n)},y=r.a.memo(m)},299:function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var n=a(44),r=a(19),i=a(2),o=a.n(i),s=a(134),l=a(41),c=a.n(l),u=a(149);const d="destination.ip",p="destination.port",m="event.category",y="file.name",g="host.name",f="kibana.alert.rule.name",b="kibana.alert.severity",h="process.parent.name",v="process.name",E="source.ip",x="source.port",k="user.name",w=[d,p,y,v,h,E,x],S=c()(r.EuiFlexGroup).withConfig({displayName:"AlertFieldFlexGroup",componentId:"sc-1itxfus-0"})(["flex-grow:0;gap:","px;"],(({$scopeId:e})=>e===u.f.active?0:3)),j=({contextId:e,eventId:t,field:a,fieldType:n="keyword",isAggregatable:i=!0,isDraggable:l,showSeparator:c,scopeId:u,value:d})=>o.a.createElement(S,{alignItems:"center","data-test-subj":"alertFieldBadge",$scopeId:u,gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(s.c,{contextId:`${e}-alert-field`,eventId:t,field:a,fieldType:n,isAggregatable:i,isDraggable:l,scopeId:u,value:d})),c&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"separator"},", ")));j.displayName="AlertFieldBadgeComponent";const O=o.a.memo(j),I=({contextId:e,"data-test-subj":t="alertField",eventId:a,field:n,fieldType:i="keyword",isAggregatable:s=!0,isDraggable:l,prefix:c,suffix:u,scopeId:d,values:p})=>null!=p?o.a.createElement(S,{alignItems:"center","data-test-subj":t,$scopeId:d,gutterSize:"none"},null!=c&&o.a.createElement(r.EuiFlexItem,{"data-test-subj":"prefix",grow:!1},c),p.map(((t,c)=>o.a.createElement(r.EuiFlexItem,{key:`${t}-${c}`,grow:!1},o.a.createElement(O,{contextId:`${e}-alert-field`,eventId:a,field:n,fieldType:i,isAggregatable:s,isDraggable:l,showSeparator:c<p.length-1,scopeId:d,value:t})))),null!=u&&o.a.createElement(r.EuiFlexItem,{"data-test-subj":"suffix",grow:!1},u)):null;I.displayName="AlertFieldComponent";const C=o.a.memo(I);var T=a(121),M=a(150),_=a(315),N=a(4);const D=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.alertLabel",{defaultMessage:"alert"}),A=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.byLabel",{defaultMessage:"by"}),F=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.createdLabel",{defaultMessage:"created"}),q=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.destinationLabel",{defaultMessage:"destination"}),L=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.eventLabel",{defaultMessage:"event"}),R=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.fileLabel",{defaultMessage:"file"}),P=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.onLabel",{defaultMessage:"on"}),z=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.parentProcessLabel",{defaultMessage:"parent process"}),B=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.processLabel",{defaultMessage:"process"}),$=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.sourceLabel",{defaultMessage:"source"}),G=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.withLabel",{defaultMessage:"with"}),U={id:T.e.alert,isInstance:e=>{return null!==(a=null==(t=Object(n.get)("event.kind",e))?void 0:t.some((e=>null!=e.toLocaleLowerCase&&"signal"===e.toLowerCase())))&&void 0!==a&&a;var t,a},renderRow:({contextId:e="alert-renderer",data:t,isDraggable:a,scopeId:i})=>{const s=Object(n.get)("_id",t),l=Object(n.get)(d,t),c=Object(n.get)(p,t),u=Object(n.get)(m,t),S=Object(n.get)(y,t),j=Object(n.get)(g,t),O=Object(n.get)(f,t),I=Object(n.get)(b,t),T=Object(n.get)(v,t),N=Object(n.get)(h,t),U=Object(n.get)(E,t),V=Object(n.get)(x,t),H=Object(n.get)(k,t);return o.a.createElement(_.a,null,o.a.createElement(M.b,{"data-test-subj":"alertRenderer"},o.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"center",wrap:!0},o.a.createElement(C,{contextId:e,"data-test-subj":m,eventId:s,field:m,isDraggable:a,scopeId:i,values:u}),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"event"},` ${L} `)),(({data:e,fieldNames:t})=>t.some((t=>Object(n.has)(t,e))))({data:t,fieldNames:w})&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"with"},` ${G} `)),o.a.createElement(C,{contextId:e,"data-test-subj":v,eventId:s,field:v,isDraggable:a,prefix:` ${B} `,suffix:", ",scopeId:i,values:T}),o.a.createElement(C,{contextId:e,"data-test-subj":h,eventId:s,field:h,isDraggable:a,prefix:` ${z} `,suffix:", ",scopeId:i,values:N}),o.a.createElement(C,{contextId:e,"data-test-subj":y,eventId:s,field:y,isDraggable:a,prefix:` ${R} `,suffix:", ",scopeId:i,values:S}),o.a.createElement(C,{contextId:e,"data-test-subj":E,eventId:s,field:E,isDraggable:a,prefix:` ${$} `,scopeId:i,values:U}),o.a.createElement(C,{contextId:e,"data-test-subj":x,eventId:s,field:x,isDraggable:a,prefix:":",suffix:", ",scopeId:i,values:V}),o.a.createElement(C,{contextId:e,"data-test-subj":d,eventId:s,field:d,isDraggable:a,prefix:` ${q} `,scopeId:i,values:l}),o.a.createElement(C,{contextId:e,"data-test-subj":p,eventId:s,field:p,isDraggable:a,prefix:":",suffix:", ",scopeId:i,values:c}),o.a.createElement(C,{contextId:e,"data-test-subj":k,eventId:s,field:k,isDraggable:a,prefix:` ${A} `,scopeId:i,values:H}),o.a.createElement(C,{contextId:e,"data-test-subj":g,eventId:s,field:g,isDraggable:a,prefix:` ${P} `,scopeId:i,values:j}),o.a.createElement(C,{contextId:e,"data-test-subj":b,eventId:s,field:b,isDraggable:a,prefix:` ${F} `,suffix:` ${D} `,scopeId:i,values:I}),o.a.createElement(C,{contextId:e,"data-test-subj":f,eventId:s,field:f,isDraggable:a,suffix:".",scopeId:i,values:O}))))}},V=({data:e,rowRenderers:t})=>{var a;const n=null!==(a=t.find((t=>t.isInstance(e))))&&void 0!==a?a:null;return U.isInstance(e)?null!=n?(({a:e,b:t,id:a})=>({id:a,isInstance:a=>e.isInstance(a)||t.isInstance(a),renderRow:({contextId:a,data:n,isDraggable:r,scopeId:i})=>o.a.createElement(o.a.Fragment,null,e.isInstance(n)&&e.renderRow({contextId:a,data:n,isDraggable:r,scopeId:i}),t.isInstance(n)&&t.renderRow({contextId:a,data:n,isDraggable:r,scopeId:i}))}))({a:U,b:n,id:n.id}):U:n}},302:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return y})),a.d(t,"c",(function(){return g}));var n=a(128),r=a(44),i=a(2),o=a(229),s=a(1349),l=a(520),c=a(706),u=a(382),d=a(195),p=a(149);const m=(e,t,a,r=p.e,i=!1)=>({and:[],enabled:!0,id:Object(n.i)(t),name:e,excluded:i,kqlQuery:"",queryMatch:{field:e,value:a,operator:r,displayValue:Object(c.d)(a)}}),y=(e,t,a,n=p.e,r=!1)=>{const{and:i,...o}=m(e,t,a,n,r);return o},g=({contextId:e,eventId:t,field:a,fieldFormat:n,fieldFromBrowserField:c,fieldType:p,isObjectArray:y,linkValue:g,values:f})=>Object(i.useMemo)((()=>{if(null==f)return null;const i=Array.isArray(f)?f:[f];let b=[];return i.length>1&&(b=[{meta:{},query:{bool:{must:i.map((e=>({term:{[a]:e}})))}}}]),i.reduce(((i,b,h)=>{let v="",E=Object(r.isString)(b)?b:`${f}`;const x=`${e}-${t}-${a}-${h}-${b}`;if(null==c)return i.values.push(E),i;if(y||p===o.f||[o.i].includes(a))return i.values.push(E),i;if(p===o.h){if(v=`formatted-ip-data-provider-${e}-${a}-${b}-${t}`,Object(r.isString)(b)&&!Object(r.isEmpty)(b)){let e=b;try{e=JSON.parse(b)}catch(e){}return Object(r.isArray)(e)&&(E=e.join(","),e.forEach((e=>i.dataProviders.push(m(a,v,e))))),i.dataProviders.push(m(a,v,e)),i.values.push(E),i}}else u.b.some((e=>a===e))?v=`port-default-draggable-${x}`:a===l.b?v=`duration-default-draggable-${x}`:a===o.g?v=`event-details-value-default-draggable-${x}`:n===s.a?v=`bytes-default-draggable-${x}`:a===o.n?v=`event-details-value-default-draggable-${x}-${g}`:a===o.c?v=`event-details-value-default-draggable-${x}-${b}`:a===o.o?v=`alert-details-value-default-draggable-${x}`:a===o.a?(v=`event-details-value-default-draggable-${x}`,E="string"==typeof b?b:""):v=[o.m,o.l,o.e,d.j].includes(a)?`event-details-value-default-draggable-${x}-${b}`:`event-details-value-default-draggable-${x}`;return i.values.push(E),i.dataProviders.push(m(a,v,b)),i}),{values:[],dataProviders:[],filters:b})}),[e,t,a,n,c,p,y,g,f])},303:function(e,t,a){"use strict";a.d(t,"h",(function(){return E})),a.d(t,"g",(function(){return k})),a.d(t,"b",(function(){return S})),a.d(t,"f",(function(){return O})),a.d(t,"c",(function(){return T})),a.d(t,"i",(function(){return N})),a.d(t,"d",(function(){return z})),a.d(t,"e",(function(){return B})),a.d(t,"a",(function(){return $}));var n=a(63),r=a.n(n),i=a(54),o=a.n(i),s=a(395),l=a.n(s),c=(a(48),a(41)),u=a.n(c),d=a(19),p=a(168),m=a(1560),y=a(165),g=a(227),f=a(731),b=a(248),h=a(1228),v=a(20);const E=({rule:e,detailsView:t=!1})=>{const a=w(e);return{aboutRuleData:I(e,t),modifiedAboutRuleDetailsData:_(e),defineRuleData:a,scheduleRuleData:j(e),ruleActionsData:x(e)}},x=e=>{const{enabled:t,meta:a,actions:n=[],response_actions:r}=e;return{actions:null==n?void 0:n.map((e=>Object(f.d)(e))),responseActions:null==r?void 0:r.map(f.e),kibanaSiemAppUrl:"string"==typeof(null==a?void 0:a.kibana_siem_app_url)?a.kibana_siem_app_url:void 0,enabled:t}},k=e=>{if("machine_learning"===e.type)return"string"==typeof e.machine_learning_job_id?[e.machine_learning_job_id]:e.machine_learning_job_id},w=e=>{var t,a,n,r,i,o,s,l,c,u,d;return{ruleType:e.type,anomalyThreshold:"anomaly_threshold"in e?e.anomaly_threshold:50,machineLearningJobId:k(e)||[],index:"index"in e&&e.index||[],dataViewId:"data_view_id"in e?e.data_view_id:void 0,threatIndex:"threat_index"in e&&e.threat_index||[],threatQueryBar:{query:{query:"threat_query"in e&&e.threat_query||"",language:"threat_language"in e&&e.threat_language||""},filters:"threat_filters"in e&&e.threat_filters||[],saved_id:null},threatMapping:"threat_mapping"in e&&e.threat_mapping||[],queryBar:{query:{query:"query"in e&&e.query||"",language:"language"in e&&e.language||""},filters:"filters"in e&&e.filters||[],saved_id:"saved_id"in e&&e.saved_id||null},relatedIntegrations:null!==(t=e.related_integrations)&&void 0!==t?t:[],requiredFields:null!==(a=e.required_fields)&&void 0!==a?a:[],timeline:{id:null!==(n=e.timeline_id)&&void 0!==n?n:null,title:null!==(r=e.timeline_title)&&void 0!==r?r:null},threshold:{field:Object(y.p)("threshold"in e?null===(i=e.threshold)||void 0===i?void 0:i.field:void 0),value:`${"threshold"in e&&(null===(o=e.threshold)||void 0===o?void 0:o.value)||100}`,..."threshold"in e&&null!==(s=e.threshold)&&void 0!==s&&null!==(l=s.cardinality)&&void 0!==l&&l.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:"timestamp_field"in e?e.timestamp_field:void 0,eventCategoryField:"event_category_override"in e?e.event_category_override:void 0,tiebreakerField:"tiebreaker_field"in e?e.tiebreaker_field:void 0},dataSourceType:"data_view_id"in e&&e.data_view_id?b.a.DataView:b.a.IndexPatterns,newTermsFields:"new_terms_fields"in e&&e.new_terms_fields||[],historyWindowSize:"history_window_start"in e&&e.history_window_start?S(e.history_window_start):"7d",shouldLoadQueryDynamically:Boolean("saved_query"===e.type&&e.saved_id),groupByFields:"alert_suppression"in e&&e.alert_suppression&&"group_by"in e.alert_suppression&&e.alert_suppression.group_by||[],groupByRadioSelection:"alert_suppression"in e&&null!==(c=e.alert_suppression)&&void 0!==c&&c.duration?b.b.PerTimePeriod:b.b.PerRuleExecution,groupByDuration:"alert_suppression"in e&&(null===(u=e.alert_suppression)||void 0===u?void 0:u.duration)||{value:5,unit:"m"},suppressionMissingFields:"alert_suppression"in e&&e.alert_suppression&&"missing_fields_strategy"in e.alert_suppression&&e.alert_suppression.missing_fields_strategy||v.a,enableThresholdSuppression:Boolean("alert_suppression"in e&&(null===(d=e.alert_suppression)||void 0===d?void 0:d.duration))}},S=e=>e.startsWith("now-")?e.substring(4):e,j=e=>{const{interval:t,from:a}=e;return{interval:t,from:O(a,t)}},O=(e,t)=>{var a,n;const i=null!==(a=r.a.parse(e))&&void 0!==a?a:o()(),s=null!==(n=r.a.parse(`now-${t}`))&&void 0!==n?n:o()(),l=o.a.duration(s.diff(i)),c=Math.floor(l.asSeconds());return 0===c?"0s":c%3600==0?c/3600+"h":c%60==0?c/60+"m":`${c}s`},I=(e,t)=>{var a,n;const{name:r,description:i,note:o,setup:s}=M(e,t),{author:l,building_block_type:c,exceptions_list:u,license:d,risk_score_mapping:y,rule_name_override:g,severity_mapping:f,timestamp_override:b,timestamp_override_fallback_disabled:h,references:v,severity:E,false_positives:x,risk_score:k,investigation_fields:w,tags:S,threat:j,max_signals:O}=e,I="threat_indicator_path"in e?e.threat_indicator_path:void 0;return{author:l,isAssociatedToEndpointList:null!==(a=null==u?void 0:u.some((({id:e})=>e===p.k)))&&void 0!==a&&a,isBuildingBlock:void 0!==c,license:null!=d?d:"",ruleNameOverride:null!=g?g:"",timestampOverride:null!=b?b:"",timestampOverrideFallbackDisabled:h,name:r,description:i,note:o,references:v,severity:{value:E,mapping:T(f),isMappingChecked:f.length>0},tags:S,riskScore:{value:k,mapping:Object(m.a)(y),isMappingChecked:y.length>0},falsePositives:x,investigationFields:null!==(n=null==w?void 0:w.field_names)&&void 0!==n?n:[],threat:j,threatIndicatorPath:I,maxSignals:O,setup:s}},C={low:0,medium:1,high:2,critical:3},T=e=>{const t=h.b.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>C[e.severity]-C[t.severity]))},M=(e,t)=>{const{name:a,description:n,note:r,setup:i}=e;return t?{name:"",description:"",note:"",setup:""}:{name:a,description:n,setup:i,note:null!=r?r:""}},_=e=>{var t,a;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(a=e.setup)&&void 0!==a?a:""}},N=(e,t,a,n)=>!1===e||!1===t||!1===a||n,D=["id","name","description","false_positives","investigation_fields","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"],A=["index","filters","language","query","saved_id","response_actions"],F=["filters","language","query","response_actions"],q=["anomaly_threshold","machine_learning_job_id"],L=["threshold",...A],R=e=>{switch(e){case"machine_learning":return q;case"threshold":return L;case"esql":return F;case"new_terms":case"threat_match":case"query":case"saved_query":case"eql":return A}Object(g.a)(e)},P=e=>({state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...e.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}),z=l()((e=>{if(!e)return{state:[],params:[]};const t=(e=>[...D,...R(e)].sort())(e);return P(t)})),B=()=>P((()=>{const e=[...D,...A,...q,...L].sort();return Array.from(new Set(e))})()),$=u()(d.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-15hicli-0"})(["max-width:1000px;overflow:hidden;"])},304:function(e,t,a){"use strict";a.d(t,"b",(function(){return q})),a.d(t,"a",(function(){return L}));var n=a(626),r=a(2),i=a.n(r),o=a(363),s=a(222),l=a(130),c=a(179),u=a(416),d=a(1394);const p={isInstance:(e,t)=>((e,t)=>-1===t.findIndex((t=>t.field===e)))(e,t),renderColumn:({columnName:e,eventId:t,field:a,isDraggable:n=!0,scopeId:r,truncate:p})=>n?i.a.createElement(o.b,{dataProvider:{enabled:!0,id:Object(s.h)(`empty-column-renderer-draggable-wrapper-${r}-${e}-${t}-${a.id}`),name:`${e}: ${Object(d.a)(null)}`,queryMatch:{field:a.id,value:Object(d.a)(null),displayValue:Object(l.e)(),operator:c.b},excluded:!0,kqlQuery:"",and:[]},isDraggable:n,key:`empty-column-renderer-draggable-wrapper-${r}-${e}-${t}-${a.id}`,render:(e,t,a)=>a.isDragging?i.a.createElement(o.a,null,i.a.createElement(u.a,{dataProvider:e})):i.a.createElement("span",null,Object(l.e)()),truncate:p,scopeId:r}):i.a.createElement("span",null,Object(l.e)())};var m=a(837),y=a(44),g=a(422);const f={isInstance:(e,t)=>((e,t)=>-1!==t.findIndex((t=>t.field===e)))(e,t),renderColumn:({asPlainText:e,columnName:t,eventId:a,field:n,isDraggable:r=!0,scopeId:o,truncate:s,values:c,linkValues:u})=>{return Array.isArray(c)&&0!==c.length?r?c.map(((l,c)=>{var d,p,m;return i.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:a,fieldFormat:null!==(d=n.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=n.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=n.type)&&void 0!==m?m:"",isDraggable:r,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${a}-${n.id}-${l}-${c}`,linkValue:Object(y.head)(u),truncate:s,value:l})})):i.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:a,fieldFormat:null!==(d=n.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=n.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=n.type)&&void 0!==m?m:"",isDraggable:r,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${a}-${n.id}`,linkValue:Object(y.head)(u),truncate:s,value:b(c)}):Object(l.d)();var d,p,m}};function b(e){return Array.isArray(e)?e.length>0?e.join(", "):e[0]:e}var h=a(863);const v={isInstance:()=>!0,renderColumn:()=>Object(l.d)()};var E=a(865),x=a(231),k=a(861),w=a(19),S=a(1630),j=a(229),O=a(299);const I={isInstance:Object(y.isEqual)(j.k),renderColumn:({columnName:e,ecsData:t,eventId:a,field:n,isDetails:r,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d})=>r&&d&&t&&l?d.map(((r,o)=>i.a.createElement(C,{ecsData:t,key:`reason-column-renderer-value-${c}-${e}-${a}-${n.id}-${r}-${o}`,rowRenderers:l,scopeId:c,value:r}))):f.renderColumn({columnName:e,eventId:a,field:n,isDetails:r,isDraggable:o,linkValues:s,scopeId:c,truncate:u,values:d})},C=({ecsData:e,rowRenderers:t,scopeId:a,value:n})=>{const o=Object(r.useMemo)((()=>Object(O.a)({data:e,rowRenderers:t})),[e,t]),s=Object(r.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:a})),[o,e,a]),l=Object(r.useMemo)((()=>a===S.b.rulePreview),[a]);return i.a.createElement(i.a.Fragment,null,o&&s&&!l?i.a.createElement(w.EuiPanel,{color:"subdued",className:"eui-xScroll","data-test-subj":"reason-cell-renderer"},i.a.createElement(w.EuiText,{size:"xs"},i.a.createElement("div",{className:"eui-displayInlineBlock"},s))):n)};var T=a(41);const M=a.n(T)()(w.EuiFlexItem).withConfig({displayName:"EventRenderedFlexItem",componentId:"sc-1jiiiew-0"})(["div:first-child{padding-left:0px;div{margin:0px;}}"]),_={isInstance:Object(y.isEqual)(j.d),renderColumn:({ecsData:e,columnName:t,eventId:a,field:n,isDetails:r,linkValues:o,rowRenderers:s=[],scopeId:l,truncate:c,values:u})=>e&&s?i.a.createElement(N,{ecsData:e,key:`reason-column-renderer-value-${l}-${t}-${a}-${n.id}`,rowRenderers:s,scopeId:l,values:u}):f.renderColumn({columnName:t,eventId:a,field:n,isDetails:r,isDraggable:!1,linkValues:o,scopeId:l,truncate:c,values:u})},N=({ecsData:e,rowRenderers:t,scopeId:a,values:n})=>{const o=Object(r.useMemo)((()=>Object(O.a)({data:e,rowRenderers:t})),[e,t]),s=Object(r.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:a})),[o,e,a]);return i.a.createElement(w.EuiFlexGroup,{gutterSize:"none",direction:"column",className:"eui-fullWidth"},o&&s?i.a.createElement(M,{className:"eui-xScroll"},i.a.createElement("div",{className:"eui-displayInlineBlock",style:{width:"fit-content"}},s)):n&&i.a.createElement(w.EuiFlexItem,{"data-test-subj":"plain-text-reason"},n))};var D=a(966),A=a(1226);const F={isInstance:(e,t,a)=>A.a.includes(e)&&!!a,renderColumn:({columnName:e,ecsData:t,eventId:a,field:n,isDetails:r,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d,context:p})=>{var m;if(null!=p&&p.isLoading)return i.a.createElement(w.EuiLoadingSpinner,{size:"s"});const y=null!==(m=null==d?void 0:d.map((e=>{var t;return null==p||null===(t=p.profiles)||void 0===t?void 0:t.find((t=>e===t.uid))})))&&void 0!==m?m:[];return i.a.createElement(D.a,{userProfiles:y,maxVisibleAvatars:4})}},q=[k.a,...n.a,...x.k,h.a,E.a,m.a],L=[I,_,F,f,p,v]},315:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a.n(n),i=a(180);const o=r.a.memo((({children:e})=>r.a.createElement(i.w,{className:"siemEventsTable__trSupplement--summary"},e)));o.displayName="RowRendererContainer"},316:function(e,t,a){"use strict";a.d(t,"Vb",(function(){return r})),a.d(t,"oc",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"eb",(function(){return s})),a.d(t,"Yb",(function(){return l})),a.d(t,"db",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"pc",(function(){return d})),a.d(t,"gb",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"T",(function(){return y})),a.d(t,"kc",(function(){return g})),a.d(t,"Db",(function(){return f})),a.d(t,"y",(function(){return b})),a.d(t,"A",(function(){return h})),a.d(t,"z",(function(){return v})),a.d(t,"ob",(function(){return E})),a.d(t,"gc",(function(){return x})),a.d(t,"V",(function(){return k})),a.d(t,"Bb",(function(){return w})),a.d(t,"Ob",(function(){return S})),a.d(t,"S",(function(){return j})),a.d(t,"Q",(function(){return O})),a.d(t,"dc",(function(){return I})),a.d(t,"ic",(function(){return C})),a.d(t,"Z",(function(){return T})),a.d(t,"N",(function(){return M})),a.d(t,"mb",(function(){return _})),a.d(t,"t",(function(){return N})),a.d(t,"Hb",(function(){return D})),a.d(t,"Ub",(function(){return A})),a.d(t,"lb",(function(){return F})),a.d(t,"D",(function(){return q})),a.d(t,"M",(function(){return L})),a.d(t,"ub",(function(){return R})),a.d(t,"L",(function(){return P})),a.d(t,"h",(function(){return z})),a.d(t,"Rb",(function(){return B})),a.d(t,"g",(function(){return $})),a.d(t,"u",(function(){return G})),a.d(t,"nb",(function(){return U})),a.d(t,"H",(function(){return V})),a.d(t,"rb",(function(){return H})),a.d(t,"hc",(function(){return W})),a.d(t,"f",(function(){return Y})),a.d(t,"U",(function(){return Z})),a.d(t,"hb",(function(){return K})),a.d(t,"jc",(function(){return Q})),a.d(t,"ib",(function(){return X})),a.d(t,"o",(function(){return J})),a.d(t,"Eb",(function(){return ee})),a.d(t,"n",(function(){return te})),a.d(t,"ec",(function(){return ae})),a.d(t,"nc",(function(){return ne})),a.d(t,"lc",(function(){return re})),a.d(t,"B",(function(){return ie})),a.d(t,"P",(function(){return oe})),a.d(t,"v",(function(){return se})),a.d(t,"Jb",(function(){return le})),a.d(t,"Cb",(function(){return ce})),a.d(t,"X",(function(){return ue})),a.d(t,"Y",(function(){return de})),a.d(t,"ac",(function(){return pe})),a.d(t,"d",(function(){return me})),a.d(t,"a",(function(){return ye})),a.d(t,"Lb",(function(){return ge})),a.d(t,"Mb",(function(){return fe})),a.d(t,"Wb",(function(){return be})),a.d(t,"p",(function(){return he})),a.d(t,"Ib",(function(){return ve})),a.d(t,"Pb",(function(){return Ee})),a.d(t,"Qb",(function(){return xe})),a.d(t,"Zb",(function(){return ke})),a.d(t,"ab",(function(){return we})),a.d(t,"bb",(function(){return Se})),a.d(t,"w",(function(){return je})),a.d(t,"Kb",(function(){return Oe})),a.d(t,"q",(function(){return Ie})),a.d(t,"C",(function(){return Ce})),a.d(t,"xb",(function(){return Te})),a.d(t,"jb",(function(){return Me})),a.d(t,"yb",(function(){return _e})),a.d(t,"Fb",(function(){return Ne})),a.d(t,"E",(function(){return De})),a.d(t,"tb",(function(){return Ae})),a.d(t,"J",(function(){return Fe})),a.d(t,"qb",(function(){return qe})),a.d(t,"K",(function(){return Le})),a.d(t,"j",(function(){return Re})),a.d(t,"zb",(function(){return Pe})),a.d(t,"Nb",(function(){return ze})),a.d(t,"mc",(function(){return Be})),a.d(t,"bc",(function(){return $e})),a.d(t,"cc",(function(){return Ge})),a.d(t,"s",(function(){return Ue})),a.d(t,"O",(function(){return Ve})),a.d(t,"Xb",(function(){return He})),a.d(t,"Tb",(function(){return We})),a.d(t,"fc",(function(){return Ye})),a.d(t,"Sb",(function(){return Ze})),a.d(t,"c",(function(){return Ke})),a.d(t,"r",(function(){return Qe})),a.d(t,"G",(function(){return Xe})),a.d(t,"Gb",(function(){return Je})),a.d(t,"fb",(function(){return et})),a.d(t,"sb",(function(){return tt})),a.d(t,"F",(function(){return at})),a.d(t,"pb",(function(){return nt})),a.d(t,"Ab",(function(){return rt})),a.d(t,"I",(function(){return it})),a.d(t,"b",(function(){return ot})),a.d(t,"x",(function(){return st})),a.d(t,"kb",(function(){return lt})),a.d(t,"W",(function(){return ct})),a.d(t,"cb",(function(){return ut})),a.d(t,"R",(function(){return dt})),a.d(t,"k",(function(){return pt})),a.d(t,"vb",(function(){return mt})),a.d(t,"wb",(function(){return yt})),a.d(t,"l",(function(){return gt}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.auditd.sessionDescription",{defaultMessage:"Session"}),i=n.i18n.translate("xpack.securitySolution.auditd.wasAuthorizedToUseDescription",{defaultMessage:"was authorized to use"}),o=n.i18n.translate("xpack.securitySolution.auditd.acquiredCredentialsDescription",{defaultMessage:"acquired credentials to"}),s=n.i18n.translate("xpack.securitySolution.auditd.endedFromDescription",{defaultMessage:"ended from"}),l=n.i18n.translate("xpack.securitySolution.auditd.startedAtDescription",{defaultMessage:"started"}),c=n.i18n.translate("xpack.securitySolution.auditd.disposedCredentialsDescription",{defaultMessage:"disposed credentials to"}),u=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),d=n.i18n.translate("xpack.securitySolution.auditd.withResultDescription",{defaultMessage:"with result"}),p=n.i18n.translate("xpack.securitySolution.auditd.executedDescription",{defaultMessage:"executed"}),m=n.i18n.translate("xpack.securitySolution.auditd.asDescription",{defaultMessage:"as"}),y=n.i18n.translate("xpack.securitySolution.auditd.connectedUsingDescription",{defaultMessage:"connected using"}),g=n.i18n.translate("xpack.securitySolution.auditd.usingDescription",{defaultMessage:"using"}),f=n.i18n.translate("xpack.securitySolution.auditd.OpenedFileDescription",{defaultMessage:"opened file"}),b=n.i18n.translate("xpack.securitySolution.auditd.ChangedFileAttributesOfDescription",{defaultMessage:"changed file attributes of"}),h=n.i18n.translate("xpack.securitySolution.auditd.changedFilePermissionOfDescription",{defaultMessage:"changed file permissions of"}),v=n.i18n.translate("xpack.securitySolution.auditd.changeidleOwernshipOfDescription",{defaultMessage:"changed file ownership of"}),E=n.i18n.translate("xpack.securitySolution.auditd.loaedKernelModuleOfDescription",{defaultMessage:"loaded kernel module of"}),x=n.i18n.translate("xpack.securitySolution.auditd.unloadedKernelModuleOfDescription",{defaultMessage:"unloaded kernel module of"}),k=n.i18n.translate("xpack.securitySolution.auditd.createdDirectoryDescription",{defaultMessage:"created directory"}),w=n.i18n.translate("xpack.securitySolution.auditd.mountedDescription",{defaultMessage:"mounted"}),S=n.i18n.translate("xpack.securitySolution.auditd.renamedDescription",{defaultMessage:"renamed"}),j=n.i18n.translate("xpack.securitySolution.auditd.chedckedMetaDataOfDescription",{defaultMessage:"checked metadata of"}),O=n.i18n.translate("xpack.securitySolution.auditd.checkedFileSystemMetadataOfDescription",{defaultMessage:"checked filesystem metadata of"}),I=n.i18n.translate("xpack.securitySolution.auditd.symLinkedDescription",{defaultMessage:"symbolically linked"}),C=n.i18n.translate("xpack.securitySolution.auditd.unmountedDescription",{defaultMessage:"unmounted"}),T=n.i18n.translate("xpack.securitySolution.auditd.deletedDescription",{defaultMessage:"deleted"}),M=n.i18n.translate("xpack.securitySolution.auditd.changedTimeStampOfDescription",{defaultMessage:"changed time stamp of"}),_=n.i18n.translate("xpack.securitySolution.auditd.ListeningForConnectionsUsingDescription",{defaultMessage:"listening for connections using"}),N=n.i18n.translate("xpack.securitySolution.auditd.boundSocketFromDescription",{defaultMessage:"bound socket from"}),D=n.i18n.translate("xpack.securitySolution.auditd.receivedFromDescription",{defaultMessage:"received from"}),A=n.i18n.translate("xpack.securitySolution.auditd.sentToDescription",{defaultMessage:"sent to"}),F=n.i18n.translate("xpack.securitySolution.auditd.killedProcessIdDescription",{defaultMessage:"killed process id of"}),q=n.i18n.translate("xpack.securitySolution.auditd.changedIdentityUsingDescription",{defaultMessage:"changed identity using"}),L=n.i18n.translate("xpack.securitySolution.auditd.changedSystemTimeWithDescription",{defaultMessage:"changed system time with"}),R=n.i18n.translate("xpack.securitySolution.auditd.madeDeviceWithDescription",{defaultMessage:"made device with"}),P=n.i18n.translate("xpack.securitySolution.auditd.changedSystemNameDescription",{defaultMessage:"changed system name"}),z=n.i18n.translate("xpack.securitySolution.auditd.allocatedMemoryForDescription",{defaultMessage:"allocated memory for"}),B=n.i18n.translate("xpack.securitySolution.auditd.scheduledPolicyOFDescription",{defaultMessage:"scheduled policy of"}),$=n.i18n.translate("xpack.securitySolution.auditd.addedUserAccountDescription",{defaultMessage:"added user account"}),G=n.i18n.translate("xpack.securitySolution.auditd.causedMacPolicyErrorDescription",{defaultMessage:"caused mac policy error"}),U=n.i18n.translate("xpack.securitySolution.auditd.loadedFirewallRuleDescription",{defaultMessage:"loaded firewall rule"}),V=n.i18n.translate("xpack.securitySolution.auditd.promiscuousModeDescription",{defaultMessage:"changed promiscuous mode on the device using"}),H=n.i18n.translate("xpack.securitySolution.auditd.lockedAccountDescription",{defaultMessage:"locked account"}),W=n.i18n.translate("xpack.securitySolution.auditd.unlockedAccountDescription",{defaultMessage:"unlocked account"}),Y=n.i18n.translate("xpack.securitySolution.auditd.adddedGroupAccountUsingDescription",{defaultMessage:"added group account using"}),Z=n.i18n.translate("xpack.securitySolution.auditd.crashedProgramDescription",{defaultMessage:"crashed program"}),K=n.i18n.translate("xpack.securitySolution.auditd.executionOfForbiddenProgramDescription",{defaultMessage:"execution of forbidden program"}),Q=n.i18n.translate("xpack.securitySolution.auditd.suspiciousProgramDescription",{defaultMessage:"used suspicious program"}),X=n.i18n.translate("xpack.securitySolution.auditd.failedLoginTooManyTimesDescription",{defaultMessage:"failed login due to logging in too many times"}),J=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusalPlaceDescription",{defaultMessage:"attempted login from unusual place"}),ee=n.i18n.translate("xpack.securitySolution.auditd.openedTooManySessionsDescription",{defaultMessage:"opened too many sessions"}),te=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusualHourDescription",{defaultMessage:"attempted login from unusual hour"}),ae=n.i18n.translate("xpack.securitySolution.auditd.testedFileSystemIntegrityDescription",{defaultMessage:"tested file system integrity"}),ne=n.i18n.translate("xpack.securitySolution.auditd.violatedSeLinuxPolicyDescription",{defaultMessage:"violated selinux policy"}),re=n.i18n.translate("xpack.securitySolution.auditd.violatedAppArmorPolicyFromDescription",{defaultMessage:"violated app armor policy from"}),ie=n.i18n.translate("xpack.securitySolution.auditd.changedGroupDescription",{defaultMessage:"changed group"}),oe=n.i18n.translate("xpack.securitySolution.auditd.changedUserIdDescription",{defaultMessage:"changed user id"}),se=n.i18n.translate("xpack.securitySolution.auditd.changedAuditConfigurationDescription",{defaultMessage:"changed audit configuration"}),le=n.i18n.translate("xpack.securitySolution.auditd.refreshedCredentialsForDescription",{defaultMessage:"refreshed credentials for"}),ce=n.i18n.translate("xpack.securitySolution.auditd.negotiatedCryptoKeyDescription",{defaultMessage:"negotiated crypto key"}),ue=n.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedInDescription",{defaultMessage:"crypto officer logged in"}),de=n.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedOutDescription",{defaultMessage:"crypto officer logged out"}),pe=n.i18n.translate("xpack.securitySolution.auditd.startedCryptoSessionDescription",{defaultMessage:"started crypto session"}),me=n.i18n.translate("xpack.securitySolution.auditd.accessResultDescription",{defaultMessage:"access result"}),ye=n.i18n.translate("xpack.securitySolution.auditd.abortedAuditStartupDescription",{defaultMessage:"aborted audit startup"}),ge=n.i18n.translate("xpack.securitySolution.auditd.remoteAuditConnectedDescription",{defaultMessage:"remote audit connected"}),fe=n.i18n.translate("xpack.securitySolution.auditd.remoteAuditDisconnectedDescription",{defaultMessage:"remote audit disconnected"}),be=n.i18n.translate("xpack.securitySolution.auditd.shutDownAuditDescription",{defaultMessage:"shutdown audit"}),he=n.i18n.translate("xpack.securitySolution.auditd.auditErrorDescription",{defaultMessage:"audit error"}),ve=n.i18n.translate("xpack.securitySolution.auditd.reconfiguredAuditDescription",{defaultMessage:"reconfigured audit"}),Ee=n.i18n.translate("xpack.securitySolution.auditd.resumedAuditLoggingDescription",{defaultMessage:"resumed audit logging"}),xe=n.i18n.translate("xpack.securitySolution.auditd.rotatedAuditLogsDescription",{defaultMessage:"rotated-audit-logs"}),ke=n.i18n.translate("xpack.securitySolution.auditd.startedAuditDescription",{defaultMessage:"started audit"}),we=n.i18n.translate("xpack.securitySolution.auditd.deletedGroupAccountUsingDescription",{defaultMessage:"deleted group account using"}),Se=n.i18n.translate("xpack.securitySolution.auditd.deletedUserAccountUsingDescription",{defaultMessage:"deleted user account using"}),je=n.i18n.translate("xpack.securitySolution.auditd.changedAuditFeatureDescription",{defaultMessage:"changed audit feature"}),Oe=n.i18n.translate("xpack.securitySolution.auditd.relabeledFileSystemDescription",{defaultMessage:"relabeled filesystem"}),Ie=n.i18n.translate("xpack.securitySolution.auditd.authenticatedToGroupDescription",{defaultMessage:"authenticated to group"}),Ce=n.i18n.translate("xpack.securitySolution.auditd.changedGroupPasswordDescription",{defaultMessage:"changed group password"}),Te=n.i18n.translate("xpack.securitySolution.auditd.modifiedGroupAccountDescription",{defaultMessage:"modified group account"}),Me=n.i18n.translate("xpack.securitySolution.auditd.initializedAuditSubsystemDescription",{defaultMessage:"initialized audit subsystem"}),_e=n.i18n.translate("xpack.securitySolution.auditd.modifiedLevelOfDescription",{defaultMessage:"modified level of"}),Ne=n.i18n.translate("xpack.securitySolution.auditd.overrodeLabelOfDescription",{defaultMessage:"overrode label of"}),De=n.i18n.translate("xpack.securitySolution.auditd.changedLoginIdToDescription",{defaultMessage:"changed login id to"}),Ae=n.i18n.translate("xpack.securitySolution.auditd.macPermissionDescription",{defaultMessage:"mac permission"}),Fe=n.i18n.translate("xpack.securitySolution.auditd.changedSeLinuxBooleanDescription",{defaultMessage:"changed selinux boolean"}),qe=n.i18n.translate("xpack.securitySolution.auditd.loadedSeLinuxPolicyDescription",{defaultMessage:"loaded selinux policy"}),Le=n.i18n.translate("xpack.securitySolution.auditd.changedSelinuxEnforcementDescription",{defaultMessage:"changed selinux enforcement"}),Re=n.i18n.translate("xpack.securitySolution.auditd.assignedUserRoleToDescription",{defaultMessage:"assigned user role to"}),Pe=n.i18n.translate("xpack.securitySolution.auditd.modifiedRoleDescription",{defaultMessage:"modified role"}),ze=n.i18n.translate("xpack.securitySolution.auditd.removedUserRoleFromDescription",{defaultMessage:"removed user role from"}),Be=n.i18n.translate("xpack.securitySolution.auditd.violatedSeccompPolicyWithDescription",{defaultMessage:"violated seccomp policy with"}),$e=n.i18n.translate("xpack.securitySolution.auditd.startedServiceDescription",{defaultMessage:"started service"}),Ge=n.i18n.translate("xpack.securitySolution.auditd.stoppedServiceDescription",{defaultMessage:"stopped service"}),Ue=n.i18n.translate("xpack.securitySolution.auditd.bootedSystemDescription",{defaultMessage:"booted system"}),Ve=n.i18n.translate("xpack.securitySolution.auditd.changedToRunLevelWithDescription",{defaultMessage:"changed to run level with"}),He=n.i18n.translate("xpack.securitySolution.auditd.shutdownSystemDescription",{defaultMessage:"shutdown system"}),We=n.i18n.translate("xpack.securitySolution.auditd.sentTestDescription",{defaultMessage:"sent test"}),Ye=n.i18n.translate("xpack.securitySolution.auditd.unknownDescription",{defaultMessage:"unknown"}),Ze=n.i18n.translate("xpack.securitySolution.auditd.sentMessageDescription",{defaultMessage:"sent message"}),Ke=n.i18n.translate("xpack.securitySolution.auditd.accessPermissionDescription",{defaultMessage:"access permission"}),Qe=n.i18n.translate("xpack.securitySolution.auditd.authenticatedUsingDescription",{defaultMessage:"authenticated using"}),Xe=n.i18n.translate("xpack.securitySolution.auditd.changedPasswordWithDescription",{defaultMessage:"changed password with"}),Je=n.i18n.translate("xpack.securitySolution.auditd.ranCommandDescription",{defaultMessage:"ran command"}),et=n.i18n.translate("xpack.securitySolution.auditd.errorFromDescription",{defaultMessage:"error from"}),tt=n.i18n.translate("xpack.securitySolution.auditd.loggedOutDescription",{defaultMessage:"logged out"}),at=n.i18n.translate("xpack.securitySolution.auditd.changedMacConfigurationDescription",{defaultMessage:"changed mac configuration"}),nt=n.i18n.translate("xpack.securitySolution.auditd.loadedMacPolicyDescription",{defaultMessage:"loaded mac policy"}),rt=n.i18n.translate("xpack.securitySolution.auditd.modifiedUserAccountDescription",{defaultMessage:"modified user account"}),it=n.i18n.translate("xpack.securitySolution.auditd.changedRoleUsingDescription",{defaultMessage:"changed role using"}),ot=n.i18n.translate("xpack.securitySolution.auditd.accessErrorDescription",{defaultMessage:"access error"}),st=n.i18n.translate("xpack.securitySolution.auditd.changedConfigurationWIthDescription",{defaultMessage:"changed configuration with"}),lt=n.i18n.translate("xpack.securitySolution.auditd.issuedVmControlDescription",{defaultMessage:"issued vm control"}),ct=n.i18n.translate("xpack.securitySolution.auditd.createdVmImageDescription",{defaultMessage:"created vm image"}),ut=n.i18n.translate("xpack.securitySolution.auditd.deletedVmImageDescription",{defaultMessage:"deleted vm image"}),dt=n.i18n.translate("xpack.securitySolution.auditd.checkedIntegrityOfDescription",{defaultMessage:"checked integrity of"}),pt=n.i18n.translate("xpack.securitySolution.auditd.assignedVmIdDescription",{defaultMessage:"assigned vm id"}),mt=n.i18n.translate("xpack.securitySolution.auditd.migratedVmFromDescription",{defaultMessage:"migrated vm from"}),yt=n.i18n.translate("xpack.securitySolution.auditd.migratedVmToDescription",{defaultMessage:"migrated vm to"}),gt=n.i18n.translate("xpack.securitySolution.auditd.assignedVMResourceDescription",{defaultMessage:"assigned vm resource"})},317:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(19),r=a(2),i=a.n(r),o=a(134),s=a(150),l=a(434);const c=i.a.memo((({contextId:e,endgamePid:t,endgameProcessName:a,eventId:r,processExecutable:l,processName:c,processPid:u,isDraggable:d})=>Object(s.e)(c)&&Object(s.e)(l)&&Object(s.e)(a)&&Object(s.e)(u)&&Object(s.e)(t)?null:i.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(s.e)(c)?Object(s.e)(l)?Object(s.e)(a)?null:i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"endgame.process_name",value:a,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.executable",value:l,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.name",value:c,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})),Object(s.e)(u)?Object(s.e)(t)?null:i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"endgame.pid",queryValue:String(t),value:`(${String(t)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.pid",queryValue:String(u),value:`(${String(u)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})))));c.displayName="ProcessDraggable";const u=i.a.memo((({contextId:e,endgamePid:t,endgameProcessName:a,eventId:n,processExecutable:r,processName:o,processPid:s,isDraggable:u})=>null==t&&null==a&&null==r&&null==o&&null==s?i.a.createElement(i.a.Fragment,null,l.g):i.a.createElement(c,{contextId:e,endgamePid:t,endgameProcessName:a,eventId:n,processExecutable:r,processName:o,processPid:s,isDraggable:u})));u.displayName="ProcessDraggableWithNonExistentProcess"},332:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),r=a(44),i=a(4),o=a(921),s=a(519),l=a(503),c=a(174),u=a(10);const d=i.i18n.translate("xpack.securitySolution.useAlertResponseActionsSupport.notAnAlert",{defaultMessage:"Response actions are only supported for Alerts (not events)"}),p=(e=[])=>{const t=Object(n.useMemo)((()=>Object(r.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e)),[e]),a=Object(n.useMemo)((()=>{var t,a,n,i;if((null!==(t=null===(a=Object(r.find)({field:"agent.type"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:[]).includes("endpoint"))return"endpoint";const o=null!==(n=null===(i=Object(r.find)({field:"event.module"},e))||void 0===i?void 0:i.values)&&void 0!==n?n:[];return o.includes("sentinel_one")?"sentinel_one":o.includes("crowdstrike")?"crowdstrike":void 0}),[e]),p=Object(n.useMemo)((()=>!!a&&Object(l.a)(a)),[a]),m=Object(n.useMemo)((()=>a?"endpoint"===a?Object(s.a)({category:"agent",field:"agent.id"},e):"sentinel_one"===a?Object(s.a)({category:"observer",field:c.b.sentinel_one},e):"crowdstrike"===a?Object(s.a)({category:"device",field:c.b.crowdstrike},e):"":""),[a,e]),y=Object(n.useMemo)((()=>Boolean(p&&t&&m&&a)),[m,a,t,p]),g=Object(n.useMemo)((()=>a?c.b[a]:""),[a]),f=Object(n.useMemo)((()=>c.e.reduce(((e,t)=>(e[t]=!1,a&&p&&(e[t]=Object(l.a)(a,t,"manual")),e)),{})),[a,p]),b=Object(n.useMemo)((()=>Object(s.a)({category:"host",field:"host.name"},e)),[e]),h=Object(n.useMemo)((()=>Object(o.a)(null!=e?e:[])),[e]),v=Object(n.useMemo)((()=>{if(!y){if(!t)return d;if(!a)return;if(!m)return e=Object(u.n)(a),n=g,i.i18n.translate("xpack.securitySolution.useAlertResponseActionsSupport.missingAgentIdField",{defaultMessage:"Alert event data missing {agentTypeName} agent identifier field ({missingField})",values:{missingField:n,agentTypeName:e}})}var e,n}),[m,g,a,y,t]);return Object(n.useMemo)((()=>({isSupported:y,unsupportedReason:v,isAlert:t,details:{agentType:a||"endpoint",agentId:m,hostName:b,platform:h,agentIdField:g,agentSupport:f}})),[m,g,a,y,b,t,h,f,v])}},333:function(e,t,a){"use strict";a.d(t,"u",(function(){return o})),a.d(t,"t",(function(){return s})),a.d(t,"n",(function(){return l})),a.d(t,"x",(function(){return c})),a.d(t,"y",(function(){return u})),a.d(t,"p",(function(){return d})),a.d(t,"r",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"o",(function(){return y})),a.d(t,"q",(function(){return g})),a.d(t,"a",(function(){return f})),a.d(t,"l",(function(){return b})),a.d(t,"m",(function(){return h})),a.d(t,"j",(function(){return v})),a.d(t,"k",(function(){return E})),a.d(t,"A",(function(){return x})),a.d(t,"z",(function(){return k})),a.d(t,"i",(function(){return w})),a.d(t,"h",(function(){return S})),a.d(t,"g",(function(){return j})),a.d(t,"d",(function(){return O})),a.d(t,"e",(function(){return I})),a.d(t,"f",(function(){return C})),a.d(t,"w",(function(){return T})),a.d(t,"v",(function(){return M})),a.d(t,"c",(function(){return _})),a.d(t,"s",(function(){return N}));var n=a(4),r=a(1630);const i=(e,t)=>{switch(e){case r.a.alert:return n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityAlerts",{values:{count:t},defaultMessage:"{count, plural, =1 {alert} other {alerts}}"});case r.a.event:return n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityEvents",{values:{count:t},defaultMessage:"{count, plural, =1 {event} other {events}}"});case r.a.session:return n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entitySessions",{values:{count:t},defaultMessage:"{count, plural, =1 {session} other {sessions}}"})}},o=(e,t,a)=>n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectAllEntitiesTitle",{values:{entityPlural:i(e,a),totalFormatted:t,total:a},defaultMessage:"Select {total, plural, =1 {} other {all}} {totalFormatted} {entityPlural}"}),s=(e,t,a)=>n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectedEntitiesTitle",{values:{entityPlural:i(e,a),totalFormatted:t},defaultMessage:"Selected {totalFormatted} {entityPlural}"}),l=n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.clearSelectionTitle",{defaultMessage:"Clear selection"}),c=e=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailed",{values:{conflicts:e},defaultMessage:"Failed to update { conflicts } {conflicts, plural, =1 {alert} other {alerts}}."}),u=(e,t)=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedDetailed",{values:{updated:e,conflicts:t},defaultMessage:"{ updated } {updated, plural, =1 {alert was} other {alerts were}} updated successfully, but { conflicts } failed to update\n         because { conflicts, plural, =1 {it was} other {they were}} already being modified."}),d=e=>n.i18n.translate("xpack.securitySolution.bulkActions.closedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully closed {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),p=e=>n.i18n.translate("xpack.securitySolution.bulkActions.openedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully opened {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),m=e=>n.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully marked {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}} as acknowledged."}),y=n.i18n.translate("xpack.securitySolution.bulkActions.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),g=n.i18n.translate("xpack.securitySolution.bulkActions.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),f=n.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),b=n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedSingleAlert",{defaultMessage:"Failed to update alert because it was already being modified."}),h=n.i18n.translate("xpack.securitySolution.bulkActions.openSelectedTitle",{defaultMessage:"Mark as open"}),v=n.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedSelectedTitle",{defaultMessage:"Mark as acknowledged"}),E=n.i18n.translate("xpack.securitySolution.bulkActions.closeSelectedTitle",{defaultMessage:"Mark as closed"}),x=e=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated tags for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),k=n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsFailedToastMessage",{defaultMessage:"Failed to update alert tags."}),w=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchPlaceholderMessage",{defaultMessage:"Search tags"}),S=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchNoTagsFoundMessage",{defaultMessage:"No tags match current search"}),j=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuEmptyMessage",{defaultMessage:"No alert tag options exist, add tag options in Kibana Advanced Settings."}),O=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsApplyButtonMessage",{defaultMessage:"Apply tags"}),I=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTitle",{defaultMessage:"Apply alert tags"}),C=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTooltip",{defaultMessage:"Change alert tag options in Kibana Advanced Settings."}),T=e=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated assignees for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),M=n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesFailedToastMessage",{defaultMessage:"Failed to update alert assignees."}),_=n.i18n.translate("xpack.securitySolution.bulkActions.alertAssigneesContextMenuItemTitle",{defaultMessage:"Assign alert"}),N=n.i18n.translate("xpack.securitySolution.bulkActions.removeAlertAssignessContextMenuTitle",{defaultMessage:"Unassign alert"})},334:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(19),r=a(2),i=a.n(r),o=a(196);const s=({dataTestSubj:e,descriptionList:t})=>i.a.createElement(n.EuiFlexItem,{grow:!0},i.a.createElement(o.d,{"data-test-subj":e,listItems:t}))},336:function(e,t,a){"use strict";a.d(t,"f",(function(){return w})),a.d(t,"g",(function(){return S})),a.d(t,"h",(function(){return j})),a.d(t,"d",(function(){return C})),a.d(t,"b",(function(){return M})),a.d(t,"c",(function(){return _})),a.d(t,"e",(function(){return N})),a.d(t,"a",(function(){return D}));var n=a(7);const r={"@timestamp":{type:"date",array:!1,required:!0},"agent.build.original":{type:"keyword",array:!1,required:!1},"agent.ephemeral_id":{type:"keyword",array:!1,required:!1},"agent.id":{type:"keyword",array:!1,required:!1},"agent.name":{type:"keyword",array:!1,required:!1},"agent.type":{type:"keyword",array:!1,required:!1},"agent.version":{type:"keyword",array:!1,required:!1},"client.address":{type:"keyword",array:!1,required:!1},"client.as.number":{type:"long",array:!1,required:!1},"client.as.organization.name":{type:"keyword",array:!1,required:!1},"client.bytes":{type:"long",array:!1,required:!1},"client.domain":{type:"keyword",array:!1,required:!1},"client.geo.city_name":{type:"keyword",array:!1,required:!1},"client.geo.continent_code":{type:"keyword",array:!1,required:!1},"client.geo.continent_name":{type:"keyword",array:!1,required:!1},"client.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.country_name":{type:"keyword",array:!1,required:!1},"client.geo.location":{type:"geo_point",array:!1,required:!1},"client.geo.name":{type:"keyword",array:!1,required:!1},"client.geo.postal_code":{type:"keyword",array:!1,required:!1},"client.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.region_name":{type:"keyword",array:!1,required:!1},"client.geo.timezone":{type:"keyword",array:!1,required:!1},"client.ip":{type:"ip",array:!1,required:!1},"client.mac":{type:"keyword",array:!1,required:!1},"client.nat.ip":{type:"ip",array:!1,required:!1},"client.nat.port":{type:"long",array:!1,required:!1},"client.packets":{type:"long",array:!1,required:!1},"client.port":{type:"long",array:!1,required:!1},"client.registered_domain":{type:"keyword",array:!1,required:!1},"client.subdomain":{type:"keyword",array:!1,required:!1},"client.top_level_domain":{type:"keyword",array:!1,required:!1},"client.user.domain":{type:"keyword",array:!1,required:!1},"client.user.email":{type:"keyword",array:!1,required:!1},"client.user.full_name":{type:"keyword",array:!1,required:!1},"client.user.group.domain":{type:"keyword",array:!1,required:!1},"client.user.group.id":{type:"keyword",array:!1,required:!1},"client.user.group.name":{type:"keyword",array:!1,required:!1},"client.user.hash":{type:"keyword",array:!1,required:!1},"client.user.id":{type:"keyword",array:!1,required:!1},"client.user.name":{type:"keyword",array:!1,required:!1},"client.user.roles":{type:"keyword",array:!0,required:!1},"cloud.account.id":{type:"keyword",array:!1,required:!1},"cloud.account.name":{type:"keyword",array:!1,required:!1},"cloud.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.instance.id":{type:"keyword",array:!1,required:!1},"cloud.instance.name":{type:"keyword",array:!1,required:!1},"cloud.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.account.id":{type:"keyword",array:!1,required:!1},"cloud.origin.account.name":{type:"keyword",array:!1,required:!1},"cloud.origin.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.id":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.name":{type:"keyword",array:!1,required:!1},"cloud.origin.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.project.id":{type:"keyword",array:!1,required:!1},"cloud.origin.project.name":{type:"keyword",array:!1,required:!1},"cloud.origin.provider":{type:"keyword",array:!1,required:!1},"cloud.origin.region":{type:"keyword",array:!1,required:!1},"cloud.origin.service.name":{type:"keyword",array:!1,required:!1},"cloud.project.id":{type:"keyword",array:!1,required:!1},"cloud.project.name":{type:"keyword",array:!1,required:!1},"cloud.provider":{type:"keyword",array:!1,required:!1},"cloud.region":{type:"keyword",array:!1,required:!1},"cloud.service.name":{type:"keyword",array:!1,required:!1},"cloud.target.account.id":{type:"keyword",array:!1,required:!1},"cloud.target.account.name":{type:"keyword",array:!1,required:!1},"cloud.target.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.target.instance.id":{type:"keyword",array:!1,required:!1},"cloud.target.instance.name":{type:"keyword",array:!1,required:!1},"cloud.target.machine.type":{type:"keyword",array:!1,required:!1},"cloud.target.project.id":{type:"keyword",array:!1,required:!1},"cloud.target.project.name":{type:"keyword",array:!1,required:!1},"cloud.target.provider":{type:"keyword",array:!1,required:!1},"cloud.target.region":{type:"keyword",array:!1,required:!1},"cloud.target.service.name":{type:"keyword",array:!1,required:!1},"container.id":{type:"keyword",array:!1,required:!1},"container.image.name":{type:"keyword",array:!1,required:!1},"container.image.tag":{type:"keyword",array:!0,required:!1},"container.labels":{type:"object",array:!1,required:!1},"container.name":{type:"keyword",array:!1,required:!1},"container.runtime":{type:"keyword",array:!1,required:!1},"destination.address":{type:"keyword",array:!1,required:!1},"destination.as.number":{type:"long",array:!1,required:!1},"destination.as.organization.name":{type:"keyword",array:!1,required:!1},"destination.bytes":{type:"long",array:!1,required:!1},"destination.domain":{type:"keyword",array:!1,required:!1},"destination.geo.city_name":{type:"keyword",array:!1,required:!1},"destination.geo.continent_code":{type:"keyword",array:!1,required:!1},"destination.geo.continent_name":{type:"keyword",array:!1,required:!1},"destination.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.country_name":{type:"keyword",array:!1,required:!1},"destination.geo.location":{type:"geo_point",array:!1,required:!1},"destination.geo.name":{type:"keyword",array:!1,required:!1},"destination.geo.postal_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_name":{type:"keyword",array:!1,required:!1},"destination.geo.timezone":{type:"keyword",array:!1,required:!1},"destination.ip":{type:"ip",array:!1,required:!1},"destination.mac":{type:"keyword",array:!1,required:!1},"destination.nat.ip":{type:"ip",array:!1,required:!1},"destination.nat.port":{type:"long",array:!1,required:!1},"destination.packets":{type:"long",array:!1,required:!1},"destination.port":{type:"long",array:!1,required:!1},"destination.registered_domain":{type:"keyword",array:!1,required:!1},"destination.subdomain":{type:"keyword",array:!1,required:!1},"destination.top_level_domain":{type:"keyword",array:!1,required:!1},"destination.user.domain":{type:"keyword",array:!1,required:!1},"destination.user.email":{type:"keyword",array:!1,required:!1},"destination.user.full_name":{type:"keyword",array:!1,required:!1},"destination.user.group.domain":{type:"keyword",array:!1,required:!1},"destination.user.group.id":{type:"keyword",array:!1,required:!1},"destination.user.group.name":{type:"keyword",array:!1,required:!1},"destination.user.hash":{type:"keyword",array:!1,required:!1},"destination.user.id":{type:"keyword",array:!1,required:!1},"destination.user.name":{type:"keyword",array:!1,required:!1},"destination.user.roles":{type:"keyword",array:!0,required:!1},"dll.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"dll.code_signature.exists":{type:"boolean",array:!1,required:!1},"dll.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.status":{type:"keyword",array:!1,required:!1},"dll.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"dll.code_signature.team_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.timestamp":{type:"date",array:!1,required:!1},"dll.code_signature.trusted":{type:"boolean",array:!1,required:!1},"dll.code_signature.valid":{type:"boolean",array:!1,required:!1},"dll.hash.md5":{type:"keyword",array:!1,required:!1},"dll.hash.sha1":{type:"keyword",array:!1,required:!1},"dll.hash.sha256":{type:"keyword",array:!1,required:!1},"dll.hash.sha512":{type:"keyword",array:!1,required:!1},"dll.hash.ssdeep":{type:"keyword",array:!1,required:!1},"dll.name":{type:"keyword",array:!1,required:!1},"dll.path":{type:"keyword",array:!1,required:!1},"dll.pe.architecture":{type:"keyword",array:!1,required:!1},"dll.pe.company":{type:"keyword",array:!1,required:!1},"dll.pe.description":{type:"keyword",array:!1,required:!1},"dll.pe.file_version":{type:"keyword",array:!1,required:!1},"dll.pe.imphash":{type:"keyword",array:!1,required:!1},"dll.pe.original_file_name":{type:"keyword",array:!1,required:!1},"dll.pe.product":{type:"keyword",array:!1,required:!1},"dns.answers":{type:"object",array:!0,required:!1},"dns.answers.class":{type:"keyword",array:!1,required:!1},"dns.answers.data":{type:"keyword",array:!1,required:!1},"dns.answers.name":{type:"keyword",array:!1,required:!1},"dns.answers.ttl":{type:"long",array:!1,required:!1},"dns.answers.type":{type:"keyword",array:!1,required:!1},"dns.header_flags":{type:"keyword",array:!0,required:!1},"dns.id":{type:"keyword",array:!1,required:!1},"dns.op_code":{type:"keyword",array:!1,required:!1},"dns.question.class":{type:"keyword",array:!1,required:!1},"dns.question.name":{type:"keyword",array:!1,required:!1},"dns.question.registered_domain":{type:"keyword",array:!1,required:!1},"dns.question.subdomain":{type:"keyword",array:!1,required:!1},"dns.question.top_level_domain":{type:"keyword",array:!1,required:!1},"dns.question.type":{type:"keyword",array:!1,required:!1},"dns.resolved_ip":{type:"ip",array:!0,required:!1},"dns.response_code":{type:"keyword",array:!1,required:!1},"dns.type":{type:"keyword",array:!1,required:!1},"ecs.version":{type:"keyword",array:!1,required:!0},"error.code":{type:"keyword",array:!1,required:!1},"error.id":{type:"keyword",array:!1,required:!1},"error.message":{type:"match_only_text",array:!1,required:!1},"error.stack_trace":{type:"wildcard",array:!1,required:!1},"error.type":{type:"keyword",array:!1,required:!1},"event.action":{type:"keyword",array:!1,required:!1},"event.agent_id_status":{type:"keyword",array:!1,required:!1},"event.category":{type:"keyword",array:!0,required:!1},"event.code":{type:"keyword",array:!1,required:!1},"event.created":{type:"date",array:!1,required:!1},"event.dataset":{type:"keyword",array:!1,required:!1},"event.duration":{type:"long",array:!1,required:!1},"event.end":{type:"date",array:!1,required:!1},"event.hash":{type:"keyword",array:!1,required:!1},"event.id":{type:"keyword",array:!1,required:!1},"event.ingested":{type:"date",array:!1,required:!1},"event.kind":{type:"keyword",array:!1,required:!1},"event.module":{type:"keyword",array:!1,required:!1},"event.original":{type:"keyword",array:!1,required:!1},"event.outcome":{type:"keyword",array:!1,required:!1},"event.provider":{type:"keyword",array:!1,required:!1},"event.reason":{type:"keyword",array:!1,required:!1},"event.reference":{type:"keyword",array:!1,required:!1},"event.risk_score":{type:"float",array:!1,required:!1},"event.risk_score_norm":{type:"float",array:!1,required:!1},"event.sequence":{type:"long",array:!1,required:!1},"event.severity":{type:"long",array:!1,required:!1},"event.start":{type:"date",array:!1,required:!1},"event.timezone":{type:"keyword",array:!1,required:!1},"event.type":{type:"keyword",array:!0,required:!1},"event.url":{type:"keyword",array:!1,required:!1},"faas.coldstart":{type:"boolean",array:!1,required:!1},"faas.execution":{type:"keyword",array:!1,required:!1},"faas.trigger":{type:"nested",array:!1,required:!1},"faas.trigger.request_id":{type:"keyword",array:!1,required:!1},"faas.trigger.type":{type:"keyword",array:!1,required:!1},"file.accessed":{type:"date",array:!1,required:!1},"file.attributes":{type:"keyword",array:!0,required:!1},"file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"file.code_signature.exists":{type:"boolean",array:!1,required:!1},"file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"file.code_signature.status":{type:"keyword",array:!1,required:!1},"file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"file.code_signature.timestamp":{type:"date",array:!1,required:!1},"file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"file.code_signature.valid":{type:"boolean",array:!1,required:!1},"file.created":{type:"date",array:!1,required:!1},"file.ctime":{type:"date",array:!1,required:!1},"file.device":{type:"keyword",array:!1,required:!1},"file.directory":{type:"keyword",array:!1,required:!1},"file.drive_letter":{type:"keyword",array:!1,required:!1},"file.elf.architecture":{type:"keyword",array:!1,required:!1},"file.elf.byte_order":{type:"keyword",array:!1,required:!1},"file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"file.elf.creation_date":{type:"date",array:!1,required:!1},"file.elf.exports":{type:"flattened",array:!0,required:!1},"file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"file.elf.header.class":{type:"keyword",array:!1,required:!1},"file.elf.header.data":{type:"keyword",array:!1,required:!1},"file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"file.elf.header.type":{type:"keyword",array:!1,required:!1},"file.elf.header.version":{type:"keyword",array:!1,required:!1},"file.elf.imports":{type:"flattened",array:!0,required:!1},"file.elf.sections":{type:"nested",array:!0,required:!1},"file.elf.sections.chi2":{type:"long",array:!1,required:!1},"file.elf.sections.entropy":{type:"long",array:!1,required:!1},"file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"file.elf.sections.name":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"file.elf.sections.type":{type:"keyword",array:!1,required:!1},"file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"file.elf.segments":{type:"nested",array:!0,required:!1},"file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"file.elf.segments.type":{type:"keyword",array:!1,required:!1},"file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"file.elf.telfhash":{type:"keyword",array:!1,required:!1},"file.extension":{type:"keyword",array:!1,required:!1},"file.fork_name":{type:"keyword",array:!1,required:!1},"file.gid":{type:"keyword",array:!1,required:!1},"file.group":{type:"keyword",array:!1,required:!1},"file.hash.md5":{type:"keyword",array:!1,required:!1},"file.hash.sha1":{type:"keyword",array:!1,required:!1},"file.hash.sha256":{type:"keyword",array:!1,required:!1},"file.hash.sha512":{type:"keyword",array:!1,required:!1},"file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"file.inode":{type:"keyword",array:!1,required:!1},"file.mime_type":{type:"keyword",array:!1,required:!1},"file.mode":{type:"keyword",array:!1,required:!1},"file.mtime":{type:"date",array:!1,required:!1},"file.name":{type:"keyword",array:!1,required:!1},"file.owner":{type:"keyword",array:!1,required:!1},"file.path":{type:"keyword",array:!1,required:!1},"file.pe.architecture":{type:"keyword",array:!1,required:!1},"file.pe.company":{type:"keyword",array:!1,required:!1},"file.pe.description":{type:"keyword",array:!1,required:!1},"file.pe.file_version":{type:"keyword",array:!1,required:!1},"file.pe.imphash":{type:"keyword",array:!1,required:!1},"file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"file.pe.product":{type:"keyword",array:!1,required:!1},"file.size":{type:"long",array:!1,required:!1},"file.target_path":{type:"keyword",array:!1,required:!1},"file.type":{type:"keyword",array:!1,required:!1},"file.uid":{type:"keyword",array:!1,required:!1},"file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.not_after":{type:"date",array:!1,required:!1},"file.x509.not_before":{type:"date",array:!1,required:!1},"file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"file.x509.public_key_size":{type:"long",array:!1,required:!1},"file.x509.serial_number":{type:"keyword",array:!1,required:!1},"file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"file.x509.subject.country":{type:"keyword",array:!0,required:!1},"file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.version_number":{type:"keyword",array:!1,required:!1},"group.domain":{type:"keyword",array:!1,required:!1},"group.id":{type:"keyword",array:!1,required:!1},"group.name":{type:"keyword",array:!1,required:!1},"host.architecture":{type:"keyword",array:!1,required:!1},"host.boot.id":{type:"keyword",array:!1,required:!1},"host.cpu.usage":{type:"scaled_float",array:!1,required:!1,scaling_factor:1e3},"host.disk.read.bytes":{type:"long",array:!1,required:!1},"host.disk.write.bytes":{type:"long",array:!1,required:!1},"host.domain":{type:"keyword",array:!1,required:!1},"host.geo.city_name":{type:"keyword",array:!1,required:!1},"host.geo.continent_code":{type:"keyword",array:!1,required:!1},"host.geo.continent_name":{type:"keyword",array:!1,required:!1},"host.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.country_name":{type:"keyword",array:!1,required:!1},"host.geo.location":{type:"geo_point",array:!1,required:!1},"host.geo.name":{type:"keyword",array:!1,required:!1},"host.geo.postal_code":{type:"keyword",array:!1,required:!1},"host.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.region_name":{type:"keyword",array:!1,required:!1},"host.geo.timezone":{type:"keyword",array:!1,required:!1},"host.hostname":{type:"keyword",array:!1,required:!1},"host.id":{type:"keyword",array:!1,required:!1},"host.ip":{type:"ip",array:!0,required:!1},"host.mac":{type:"keyword",array:!0,required:!1},"host.name":{type:"keyword",array:!1,required:!1},"host.network.egress.bytes":{type:"long",array:!1,required:!1},"host.network.egress.packets":{type:"long",array:!1,required:!1},"host.network.ingress.bytes":{type:"long",array:!1,required:!1},"host.network.ingress.packets":{type:"long",array:!1,required:!1},"host.os.family":{type:"keyword",array:!1,required:!1},"host.os.full":{type:"keyword",array:!1,required:!1},"host.os.kernel":{type:"keyword",array:!1,required:!1},"host.os.name":{type:"keyword",array:!1,required:!1},"host.os.platform":{type:"keyword",array:!1,required:!1},"host.os.type":{type:"keyword",array:!1,required:!1},"host.os.version":{type:"keyword",array:!1,required:!1},"host.pid_ns_ino":{type:"keyword",array:!1,required:!1},"host.risk.calculated_level":{type:"keyword",array:!1,required:!1},"host.risk.calculated_score":{type:"float",array:!1,required:!1},"host.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"host.risk.static_level":{type:"keyword",array:!1,required:!1},"host.risk.static_score":{type:"float",array:!1,required:!1},"host.risk.static_score_norm":{type:"float",array:!1,required:!1},"host.type":{type:"keyword",array:!1,required:!1},"host.uptime":{type:"long",array:!1,required:!1},"http.request.body.bytes":{type:"long",array:!1,required:!1},"http.request.body.content":{type:"wildcard",array:!1,required:!1},"http.request.bytes":{type:"long",array:!1,required:!1},"http.request.id":{type:"keyword",array:!1,required:!1},"http.request.method":{type:"keyword",array:!1,required:!1},"http.request.mime_type":{type:"keyword",array:!1,required:!1},"http.request.referrer":{type:"keyword",array:!1,required:!1},"http.response.body.bytes":{type:"long",array:!1,required:!1},"http.response.body.content":{type:"wildcard",array:!1,required:!1},"http.response.bytes":{type:"long",array:!1,required:!1},"http.response.mime_type":{type:"keyword",array:!1,required:!1},"http.response.status_code":{type:"long",array:!1,required:!1},"http.version":{type:"keyword",array:!1,required:!1},labels:{type:"object",array:!1,required:!1},"log.file.path":{type:"keyword",array:!1,required:!1},"log.level":{type:"keyword",array:!1,required:!1},"log.logger":{type:"keyword",array:!1,required:!1},"log.origin.file.line":{type:"long",array:!1,required:!1},"log.origin.file.name":{type:"keyword",array:!1,required:!1},"log.origin.function":{type:"keyword",array:!1,required:!1},"log.syslog":{type:"object",array:!1,required:!1},"log.syslog.facility.code":{type:"long",array:!1,required:!1},"log.syslog.facility.name":{type:"keyword",array:!1,required:!1},"log.syslog.priority":{type:"long",array:!1,required:!1},"log.syslog.severity.code":{type:"long",array:!1,required:!1},"log.syslog.severity.name":{type:"keyword",array:!1,required:!1},message:{type:"match_only_text",array:!1,required:!1},"network.application":{type:"keyword",array:!1,required:!1},"network.bytes":{type:"long",array:!1,required:!1},"network.community_id":{type:"keyword",array:!1,required:!1},"network.direction":{type:"keyword",array:!1,required:!1},"network.forwarded_ip":{type:"ip",array:!1,required:!1},"network.iana_number":{type:"keyword",array:!1,required:!1},"network.inner":{type:"object",array:!1,required:!1},"network.inner.vlan.id":{type:"keyword",array:!1,required:!1},"network.inner.vlan.name":{type:"keyword",array:!1,required:!1},"network.name":{type:"keyword",array:!1,required:!1},"network.packets":{type:"long",array:!1,required:!1},"network.protocol":{type:"keyword",array:!1,required:!1},"network.transport":{type:"keyword",array:!1,required:!1},"network.type":{type:"keyword",array:!1,required:!1},"network.vlan.id":{type:"keyword",array:!1,required:!1},"network.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress":{type:"object",array:!1,required:!1},"observer.egress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.egress.interface.id":{type:"keyword",array:!1,required:!1},"observer.egress.interface.name":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress.zone":{type:"keyword",array:!1,required:!1},"observer.geo.city_name":{type:"keyword",array:!1,required:!1},"observer.geo.continent_code":{type:"keyword",array:!1,required:!1},"observer.geo.continent_name":{type:"keyword",array:!1,required:!1},"observer.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.country_name":{type:"keyword",array:!1,required:!1},"observer.geo.location":{type:"geo_point",array:!1,required:!1},"observer.geo.name":{type:"keyword",array:!1,required:!1},"observer.geo.postal_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_name":{type:"keyword",array:!1,required:!1},"observer.geo.timezone":{type:"keyword",array:!1,required:!1},"observer.hostname":{type:"keyword",array:!1,required:!1},"observer.ingress":{type:"object",array:!1,required:!1},"observer.ingress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.id":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.name":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.ingress.zone":{type:"keyword",array:!1,required:!1},"observer.ip":{type:"ip",array:!0,required:!1},"observer.mac":{type:"keyword",array:!0,required:!1},"observer.name":{type:"keyword",array:!1,required:!1},"observer.os.family":{type:"keyword",array:!1,required:!1},"observer.os.full":{type:"keyword",array:!1,required:!1},"observer.os.kernel":{type:"keyword",array:!1,required:!1},"observer.os.name":{type:"keyword",array:!1,required:!1},"observer.os.platform":{type:"keyword",array:!1,required:!1},"observer.os.type":{type:"keyword",array:!1,required:!1},"observer.os.version":{type:"keyword",array:!1,required:!1},"observer.product":{type:"keyword",array:!1,required:!1},"observer.serial_number":{type:"keyword",array:!1,required:!1},"observer.type":{type:"keyword",array:!1,required:!1},"observer.vendor":{type:"keyword",array:!1,required:!1},"observer.version":{type:"keyword",array:!1,required:!1},"orchestrator.api_version":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.id":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.name":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.url":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.version":{type:"keyword",array:!1,required:!1},"orchestrator.namespace":{type:"keyword",array:!1,required:!1},"orchestrator.organization":{type:"keyword",array:!1,required:!1},"orchestrator.resource.id":{type:"keyword",array:!1,required:!1},"orchestrator.resource.ip":{type:"ip",array:!0,required:!1},"orchestrator.resource.name":{type:"keyword",array:!1,required:!1},"orchestrator.resource.parent.type":{type:"keyword",array:!1,required:!1},"orchestrator.resource.type":{type:"keyword",array:!1,required:!1},"orchestrator.type":{type:"keyword",array:!1,required:!1},"organization.id":{type:"keyword",array:!1,required:!1},"organization.name":{type:"keyword",array:!1,required:!1},"package.architecture":{type:"keyword",array:!1,required:!1},"package.build_version":{type:"keyword",array:!1,required:!1},"package.checksum":{type:"keyword",array:!1,required:!1},"package.description":{type:"keyword",array:!1,required:!1},"package.install_scope":{type:"keyword",array:!1,required:!1},"package.installed":{type:"date",array:!1,required:!1},"package.license":{type:"keyword",array:!1,required:!1},"package.name":{type:"keyword",array:!1,required:!1},"package.path":{type:"keyword",array:!1,required:!1},"package.reference":{type:"keyword",array:!1,required:!1},"package.size":{type:"long",array:!1,required:!1},"package.type":{type:"keyword",array:!1,required:!1},"package.version":{type:"keyword",array:!1,required:!1},"process.args":{type:"keyword",array:!0,required:!1},"process.args_count":{type:"long",array:!1,required:!1},"process.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.code_signature.status":{type:"keyword",array:!1,required:!1},"process.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.command_line":{type:"wildcard",array:!1,required:!1},"process.elf.architecture":{type:"keyword",array:!1,required:!1},"process.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.elf.creation_date":{type:"date",array:!1,required:!1},"process.elf.exports":{type:"flattened",array:!0,required:!1},"process.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.elf.header.class":{type:"keyword",array:!1,required:!1},"process.elf.header.data":{type:"keyword",array:!1,required:!1},"process.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.elf.header.type":{type:"keyword",array:!1,required:!1},"process.elf.header.version":{type:"keyword",array:!1,required:!1},"process.elf.imports":{type:"flattened",array:!0,required:!1},"process.elf.sections":{type:"nested",array:!0,required:!1},"process.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.elf.segments":{type:"nested",array:!0,required:!1},"process.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.end":{type:"date",array:!1,required:!1},"process.entity_id":{type:"keyword",array:!1,required:!1},"process.entry_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.executable":{type:"keyword",array:!1,required:!1},"process.exit_code":{type:"long",array:!1,required:!1},"process.hash.md5":{type:"keyword",array:!1,required:!1},"process.hash.sha1":{type:"keyword",array:!1,required:!1},"process.hash.sha256":{type:"keyword",array:!1,required:!1},"process.hash.sha512":{type:"keyword",array:!1,required:!1},"process.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.name":{type:"keyword",array:!1,required:!1},"process.parent.args":{type:"keyword",array:!0,required:!1},"process.parent.args_count":{type:"long",array:!1,required:!1},"process.parent.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.status":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.parent.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.parent.command_line":{type:"wildcard",array:!1,required:!1},"process.parent.elf.architecture":{type:"keyword",array:!1,required:!1},"process.parent.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.parent.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.parent.elf.creation_date":{type:"date",array:!1,required:!1},"process.parent.elf.exports":{type:"flattened",array:!0,required:!1},"process.parent.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.class":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.data":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.parent.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.version":{type:"keyword",array:!1,required:!1},"process.parent.elf.imports":{type:"flattened",array:!0,required:!1},"process.parent.elf.sections":{type:"nested",array:!0,required:!1},"process.parent.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.parent.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.parent.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.parent.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.parent.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.parent.elf.segments":{type:"nested",array:!0,required:!1},"process.parent.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.parent.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.parent.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.parent.end":{type:"date",array:!1,required:!1},"process.parent.entity_id":{type:"keyword",array:!1,required:!1},"process.parent.executable":{type:"keyword",array:!1,required:!1},"process.parent.exit_code":{type:"long",array:!1,required:!1},"process.parent.hash.md5":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha1":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha256":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha512":{type:"keyword",array:!1,required:!1},"process.parent.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.parent.name":{type:"keyword",array:!1,required:!1},"process.parent.pe.architecture":{type:"keyword",array:!1,required:!1},"process.parent.pe.company":{type:"keyword",array:!1,required:!1},"process.parent.pe.description":{type:"keyword",array:!1,required:!1},"process.parent.pe.file_version":{type:"keyword",array:!1,required:!1},"process.parent.pe.imphash":{type:"keyword",array:!1,required:!1},"process.parent.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.parent.pe.product":{type:"keyword",array:!1,required:!1},"process.parent.pgid":{type:"long",array:!1,required:!1},"process.parent.pid":{type:"long",array:!1,required:!1},"process.parent.start":{type:"date",array:!1,required:!1},"process.parent.thread.id":{type:"long",array:!1,required:!1},"process.parent.thread.name":{type:"keyword",array:!1,required:!1},"process.parent.title":{type:"keyword",array:!1,required:!1},"process.parent.uptime":{type:"long",array:!1,required:!1},"process.parent.working_directory":{type:"keyword",array:!1,required:!1},"process.pe.architecture":{type:"keyword",array:!1,required:!1},"process.pe.company":{type:"keyword",array:!1,required:!1},"process.pe.description":{type:"keyword",array:!1,required:!1},"process.pe.file_version":{type:"keyword",array:!1,required:!1},"process.pe.imphash":{type:"keyword",array:!1,required:!1},"process.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.pe.product":{type:"keyword",array:!1,required:!1},"process.pgid":{type:"long",array:!1,required:!1},"process.pid":{type:"long",array:!1,required:!1},"process.session_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.start":{type:"date",array:!1,required:!1},"process.thread.id":{type:"long",array:!1,required:!1},"process.thread.name":{type:"keyword",array:!1,required:!1},"process.title":{type:"keyword",array:!1,required:!1},"process.uptime":{type:"long",array:!1,required:!1},"process.working_directory":{type:"keyword",array:!1,required:!1},"registry.data.bytes":{type:"keyword",array:!1,required:!1},"registry.data.strings":{type:"wildcard",array:!0,required:!1},"registry.data.type":{type:"keyword",array:!1,required:!1},"registry.hive":{type:"keyword",array:!1,required:!1},"registry.key":{type:"keyword",array:!1,required:!1},"registry.path":{type:"keyword",array:!1,required:!1},"registry.value":{type:"keyword",array:!1,required:!1},"related.hash":{type:"keyword",array:!0,required:!1},"related.hosts":{type:"keyword",array:!0,required:!1},"related.ip":{type:"ip",array:!0,required:!1},"related.user":{type:"keyword",array:!0,required:!1},"rule.author":{type:"keyword",array:!0,required:!1},"rule.category":{type:"keyword",array:!1,required:!1},"rule.description":{type:"keyword",array:!1,required:!1},"rule.id":{type:"keyword",array:!1,required:!1},"rule.license":{type:"keyword",array:!1,required:!1},"rule.name":{type:"keyword",array:!1,required:!1},"rule.reference":{type:"keyword",array:!1,required:!1},"rule.ruleset":{type:"keyword",array:!1,required:!1},"rule.uuid":{type:"keyword",array:!1,required:!1},"rule.version":{type:"keyword",array:!1,required:!1},"server.address":{type:"keyword",array:!1,required:!1},"server.as.number":{type:"long",array:!1,required:!1},"server.as.organization.name":{type:"keyword",array:!1,required:!1},"server.bytes":{type:"long",array:!1,required:!1},"server.domain":{type:"keyword",array:!1,required:!1},"server.geo.city_name":{type:"keyword",array:!1,required:!1},"server.geo.continent_code":{type:"keyword",array:!1,required:!1},"server.geo.continent_name":{type:"keyword",array:!1,required:!1},"server.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.country_name":{type:"keyword",array:!1,required:!1},"server.geo.location":{type:"geo_point",array:!1,required:!1},"server.geo.name":{type:"keyword",array:!1,required:!1},"server.geo.postal_code":{type:"keyword",array:!1,required:!1},"server.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.region_name":{type:"keyword",array:!1,required:!1},"server.geo.timezone":{type:"keyword",array:!1,required:!1},"server.ip":{type:"ip",array:!1,required:!1},"server.mac":{type:"keyword",array:!1,required:!1},"server.nat.ip":{type:"ip",array:!1,required:!1},"server.nat.port":{type:"long",array:!1,required:!1},"server.packets":{type:"long",array:!1,required:!1},"server.port":{type:"long",array:!1,required:!1},"server.registered_domain":{type:"keyword",array:!1,required:!1},"server.subdomain":{type:"keyword",array:!1,required:!1},"server.top_level_domain":{type:"keyword",array:!1,required:!1},"server.user.domain":{type:"keyword",array:!1,required:!1},"server.user.email":{type:"keyword",array:!1,required:!1},"server.user.full_name":{type:"keyword",array:!1,required:!1},"server.user.group.domain":{type:"keyword",array:!1,required:!1},"server.user.group.id":{type:"keyword",array:!1,required:!1},"server.user.group.name":{type:"keyword",array:!1,required:!1},"server.user.hash":{type:"keyword",array:!1,required:!1},"server.user.id":{type:"keyword",array:!1,required:!1},"server.user.name":{type:"keyword",array:!1,required:!1},"server.user.roles":{type:"keyword",array:!0,required:!1},"service.address":{type:"keyword",array:!1,required:!1},"service.environment":{type:"keyword",array:!1,required:!1},"service.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.id":{type:"keyword",array:!1,required:!1},"service.name":{type:"keyword",array:!1,required:!1},"service.node.name":{type:"keyword",array:!1,required:!1},"service.origin.address":{type:"keyword",array:!1,required:!1},"service.origin.environment":{type:"keyword",array:!1,required:!1},"service.origin.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.origin.id":{type:"keyword",array:!1,required:!1},"service.origin.name":{type:"keyword",array:!1,required:!1},"service.origin.node.name":{type:"keyword",array:!1,required:!1},"service.origin.state":{type:"keyword",array:!1,required:!1},"service.origin.type":{type:"keyword",array:!1,required:!1},"service.origin.version":{type:"keyword",array:!1,required:!1},"service.state":{type:"keyword",array:!1,required:!1},"service.target.address":{type:"keyword",array:!1,required:!1},"service.target.environment":{type:"keyword",array:!1,required:!1},"service.target.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.target.id":{type:"keyword",array:!1,required:!1},"service.target.name":{type:"keyword",array:!1,required:!1},"service.target.node.name":{type:"keyword",array:!1,required:!1},"service.target.state":{type:"keyword",array:!1,required:!1},"service.target.type":{type:"keyword",array:!1,required:!1},"service.target.version":{type:"keyword",array:!1,required:!1},"service.type":{type:"keyword",array:!1,required:!1},"service.version":{type:"keyword",array:!1,required:!1},"source.address":{type:"keyword",array:!1,required:!1},"source.as.number":{type:"long",array:!1,required:!1},"source.as.organization.name":{type:"keyword",array:!1,required:!1},"source.bytes":{type:"long",array:!1,required:!1},"source.domain":{type:"keyword",array:!1,required:!1},"source.geo.city_name":{type:"keyword",array:!1,required:!1},"source.geo.continent_code":{type:"keyword",array:!1,required:!1},"source.geo.continent_name":{type:"keyword",array:!1,required:!1},"source.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.country_name":{type:"keyword",array:!1,required:!1},"source.geo.location":{type:"geo_point",array:!1,required:!1},"source.geo.name":{type:"keyword",array:!1,required:!1},"source.geo.postal_code":{type:"keyword",array:!1,required:!1},"source.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.region_name":{type:"keyword",array:!1,required:!1},"source.geo.timezone":{type:"keyword",array:!1,required:!1},"source.ip":{type:"ip",array:!1,required:!1},"source.mac":{type:"keyword",array:!1,required:!1},"source.nat.ip":{type:"ip",array:!1,required:!1},"source.nat.port":{type:"long",array:!1,required:!1},"source.packets":{type:"long",array:!1,required:!1},"source.port":{type:"long",array:!1,required:!1},"source.registered_domain":{type:"keyword",array:!1,required:!1},"source.subdomain":{type:"keyword",array:!1,required:!1},"source.top_level_domain":{type:"keyword",array:!1,required:!1},"source.user.domain":{type:"keyword",array:!1,required:!1},"source.user.email":{type:"keyword",array:!1,required:!1},"source.user.full_name":{type:"keyword",array:!1,required:!1},"source.user.group.domain":{type:"keyword",array:!1,required:!1},"source.user.group.id":{type:"keyword",array:!1,required:!1},"source.user.group.name":{type:"keyword",array:!1,required:!1},"source.user.hash":{type:"keyword",array:!1,required:!1},"source.user.id":{type:"keyword",array:!1,required:!1},"source.user.name":{type:"keyword",array:!1,required:!1},"source.user.roles":{type:"keyword",array:!0,required:!1},"span.id":{type:"keyword",array:!1,required:!1},tags:{type:"keyword",array:!0,required:!1},"threat.enrichments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator":{type:"object",array:!1,required:!1},"threat.enrichments.indicator.as.number":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.created":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.enrichments.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.ip":{type:"ip",array:!1,required:!1},"threat.enrichments.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.enrichments.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.sightings":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.atomic":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.field":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.id":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.index":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.type":{type:"keyword",array:!1,required:!1},"threat.framework":{type:"keyword",array:!1,required:!1},"threat.group.alias":{type:"keyword",array:!0,required:!1},"threat.group.id":{type:"keyword",array:!1,required:!1},"threat.group.name":{type:"keyword",array:!1,required:!1},"threat.group.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.as.number":{type:"long",array:!1,required:!1},"threat.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.indicator.description":{type:"keyword",array:!1,required:!1},"threat.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.indicator.file.created":{type:"date",array:!1,required:!1},"threat.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.indicator.file.size":{type:"long",array:!1,required:!1},"threat.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.indicator.ip":{type:"ip",array:!1,required:!1},"threat.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.indicator.port":{type:"long",array:!1,required:!1},"threat.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.indicator.sightings":{type:"long",array:!1,required:!1},"threat.indicator.type":{type:"keyword",array:!1,required:!1},"threat.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.port":{type:"long",array:!1,required:!1},"threat.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.software.alias":{type:"keyword",array:!0,required:!1},"threat.software.id":{type:"keyword",array:!1,required:!1},"threat.software.name":{type:"keyword",array:!1,required:!1},"threat.software.platforms":{type:"keyword",array:!0,required:!1},"threat.software.reference":{type:"keyword",array:!1,required:!1},"threat.software.type":{type:"keyword",array:!1,required:!1},"threat.tactic.id":{type:"keyword",array:!0,required:!1},"threat.tactic.name":{type:"keyword",array:!0,required:!1},"threat.tactic.reference":{type:"keyword",array:!0,required:!1},"threat.technique.id":{type:"keyword",array:!0,required:!1},"threat.technique.name":{type:"keyword",array:!0,required:!1},"threat.technique.reference":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.id":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.name":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.reference":{type:"keyword",array:!0,required:!1},"tls.cipher":{type:"keyword",array:!1,required:!1},"tls.client.certificate":{type:"keyword",array:!1,required:!1},"tls.client.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.client.hash.md5":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.client.issuer":{type:"keyword",array:!1,required:!1},"tls.client.ja3":{type:"keyword",array:!1,required:!1},"tls.client.not_after":{type:"date",array:!1,required:!1},"tls.client.not_before":{type:"date",array:!1,required:!1},"tls.client.server_name":{type:"keyword",array:!1,required:!1},"tls.client.subject":{type:"keyword",array:!1,required:!1},"tls.client.supported_ciphers":{type:"keyword",array:!0,required:!1},"tls.client.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.not_after":{type:"date",array:!1,required:!1},"tls.client.x509.not_before":{type:"date",array:!1,required:!1},"tls.client.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.client.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.client.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.client.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.curve":{type:"keyword",array:!1,required:!1},"tls.established":{type:"boolean",array:!1,required:!1},"tls.next_protocol":{type:"keyword",array:!1,required:!1},"tls.resumed":{type:"boolean",array:!1,required:!1},"tls.server.certificate":{type:"keyword",array:!1,required:!1},"tls.server.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.server.hash.md5":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.server.issuer":{type:"keyword",array:!1,required:!1},"tls.server.ja3s":{type:"keyword",array:!1,required:!1},"tls.server.not_after":{type:"date",array:!1,required:!1},"tls.server.not_before":{type:"date",array:!1,required:!1},"tls.server.subject":{type:"keyword",array:!1,required:!1},"tls.server.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.not_after":{type:"date",array:!1,required:!1},"tls.server.x509.not_before":{type:"date",array:!1,required:!1},"tls.server.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.server.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.server.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.server.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.version":{type:"keyword",array:!1,required:!1},"tls.version_protocol":{type:"keyword",array:!1,required:!1},"trace.id":{type:"keyword",array:!1,required:!1},"transaction.id":{type:"keyword",array:!1,required:!1},"url.domain":{type:"keyword",array:!1,required:!1},"url.extension":{type:"keyword",array:!1,required:!1},"url.fragment":{type:"keyword",array:!1,required:!1},"url.full":{type:"wildcard",array:!1,required:!1},"url.original":{type:"wildcard",array:!1,required:!1},"url.password":{type:"keyword",array:!1,required:!1},"url.path":{type:"wildcard",array:!1,required:!1},"url.port":{type:"long",array:!1,required:!1},"url.query":{type:"keyword",array:!1,required:!1},"url.registered_domain":{type:"keyword",array:!1,required:!1},"url.scheme":{type:"keyword",array:!1,required:!1},"url.subdomain":{type:"keyword",array:!1,required:!1},"url.top_level_domain":{type:"keyword",array:!1,required:!1},"url.username":{type:"keyword",array:!1,required:!1},"user.changes.domain":{type:"keyword",array:!1,required:!1},"user.changes.email":{type:"keyword",array:!1,required:!1},"user.changes.full_name":{type:"keyword",array:!1,required:!1},"user.changes.group.domain":{type:"keyword",array:!1,required:!1},"user.changes.group.id":{type:"keyword",array:!1,required:!1},"user.changes.group.name":{type:"keyword",array:!1,required:!1},"user.changes.hash":{type:"keyword",array:!1,required:!1},"user.changes.id":{type:"keyword",array:!1,required:!1},"user.changes.name":{type:"keyword",array:!1,required:!1},"user.changes.roles":{type:"keyword",array:!0,required:!1},"user.domain":{type:"keyword",array:!1,required:!1},"user.effective.domain":{type:"keyword",array:!1,required:!1},"user.effective.email":{type:"keyword",array:!1,required:!1},"user.effective.full_name":{type:"keyword",array:!1,required:!1},"user.effective.group.domain":{type:"keyword",array:!1,required:!1},"user.effective.group.id":{type:"keyword",array:!1,required:!1},"user.effective.group.name":{type:"keyword",array:!1,required:!1},"user.effective.hash":{type:"keyword",array:!1,required:!1},"user.effective.id":{type:"keyword",array:!1,required:!1},"user.effective.name":{type:"keyword",array:!1,required:!1},"user.effective.roles":{type:"keyword",array:!0,required:!1},"user.email":{type:"keyword",array:!1,required:!1},"user.full_name":{type:"keyword",array:!1,required:!1},"user.group.domain":{type:"keyword",array:!1,required:!1},"user.group.id":{type:"keyword",array:!1,required:!1},"user.group.name":{type:"keyword",array:!1,required:!1},"user.hash":{type:"keyword",array:!1,required:!1},"user.id":{type:"keyword",array:!1,required:!1},"user.name":{type:"keyword",array:!1,required:!1},"user.risk.calculated_level":{type:"keyword",array:!1,required:!1},"user.risk.calculated_score":{type:"float",array:!1,required:!1},"user.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"user.risk.static_level":{type:"keyword",array:!1,required:!1},"user.risk.static_score":{type:"float",array:!1,required:!1},"user.risk.static_score_norm":{type:"float",array:!1,required:!1},"user.roles":{type:"keyword",array:!0,required:!1},"user.target.domain":{type:"keyword",array:!1,required:!1},"user.target.email":{type:"keyword",array:!1,required:!1},"user.target.full_name":{type:"keyword",array:!1,required:!1},"user.target.group.domain":{type:"keyword",array:!1,required:!1},"user.target.group.id":{type:"keyword",array:!1,required:!1},"user.target.group.name":{type:"keyword",array:!1,required:!1},"user.target.hash":{type:"keyword",array:!1,required:!1},"user.target.id":{type:"keyword",array:!1,required:!1},"user.target.name":{type:"keyword",array:!1,required:!1},"user.target.roles":{type:"keyword",array:!0,required:!1},"user_agent.device.name":{type:"keyword",array:!1,required:!1},"user_agent.name":{type:"keyword",array:!1,required:!1},"user_agent.original":{type:"keyword",array:!1,required:!1},"user_agent.os.family":{type:"keyword",array:!1,required:!1},"user_agent.os.full":{type:"keyword",array:!1,required:!1},"user_agent.os.kernel":{type:"keyword",array:!1,required:!1},"user_agent.os.name":{type:"keyword",array:!1,required:!1},"user_agent.os.platform":{type:"keyword",array:!1,required:!1},"user_agent.os.type":{type:"keyword",array:!1,required:!1},"user_agent.os.version":{type:"keyword",array:!1,required:!1},"user_agent.version":{type:"keyword",array:!1,required:!1},"vulnerability.category":{type:"keyword",array:!0,required:!1},"vulnerability.classification":{type:"keyword",array:!1,required:!1},"vulnerability.description":{type:"keyword",array:!1,required:!1},"vulnerability.enumeration":{type:"keyword",array:!1,required:!1},"vulnerability.id":{type:"keyword",array:!1,required:!1},"vulnerability.reference":{type:"keyword",array:!1,required:!1},"vulnerability.report_id":{type:"keyword",array:!1,required:!1},"vulnerability.scanner.vendor":{type:"keyword",array:!1,required:!1},"vulnerability.score.base":{type:"float",array:!1,required:!1},"vulnerability.score.environmental":{type:"float",array:!1,required:!1},"vulnerability.score.temporal":{type:"float",array:!1,required:!1},"vulnerability.score.version":{type:"keyword",array:!1,required:!1},"vulnerability.severity":{type:"keyword",array:!1,required:!1}};var i=a(1341);const o={[i.c]:{type:"scaled_float",scaling_factor:100,required:!1},[i.d]:{type:"scaled_float",scaling_factor:100,required:!1},[i.b]:{type:"object",array:!1,required:!1},[i.e]:{type:"scaled_float",scaling_factor:100,required:!1,array:!0},[i.f]:{type:"object",array:!0,required:!1},[i.g]:{type:"keyword",array:!0,required:!1},[i.h]:{type:"keyword",array:!0,required:!1}};var s=a(748),l=a(813);const c={[s.a]:{type:"keyword",array:!1,required:!1},[s.b]:{type:"keyword",array:!0,required:!1},[s.d]:{type:"long",array:!1,required:!1},[s.e]:{type:"date",array:!1,required:!1},[s.f]:{type:"boolean",array:!1,required:!1},[s.g]:{type:"boolean",array:!0,required:!1},[s.j]:{type:"keyword",array:!0,required:!1},[s.c]:{type:"long",array:!1,required:!1},[s.h]:{type:"keyword",array:!1,required:!0},[s.i]:{type:"date",required:!1,array:!1},[s.l]:{type:"keyword",array:!1,required:!1},[s.m]:{type:"keyword",array:!1,required:!1,multi_fields:[{flat_name:`${s.m}.text`,name:"text",type:"match_only_text"}]},[s.n]:{type:"keyword",array:!1,required:!0},[s.o]:{type:"keyword",array:!1,required:!0},[s.p]:{type:"date",array:!1,required:!1},[s.q]:{type:"keyword",array:!1,required:!1},[s.r]:{type:"keyword",array:!1,required:!0},[s.t]:{array:!1,type:"flattened",ignore_above:4096,required:!1},[s.u]:{type:"keyword",array:!1,required:!0},[s.v]:{type:"long",array:!1,required:!0},[s.w]:{type:"keyword",array:!0,required:!1},[s.x]:{type:"keyword",array:!1,required:!0},[s.y]:{type:"keyword",array:!1,required:!0},[s.z]:{type:"boolean",array:!1,required:!1},[s.A]:{type:"date",array:!1,required:!1},[s.B]:{type:"keyword",array:!1,required:!0},[s.C]:{type:"date_range",format:"epoch_millis||strict_date_optional_time",array:!1,required:!1},[s.D]:{type:"keyword",array:!1,index:!1,required:!1,ignore_above:2048},[s.E]:{type:"keyword",array:!1,required:!0},[s.G]:{type:"keyword",array:!1,required:!1},[s.H]:{type:"keyword",array:!0,required:!1},[s.F]:{type:"keyword",array:!0,required:!1},[l.E]:{type:"keyword",array:!1,required:!1},[l.F]:{type:"keyword",array:!1,required:!1},[s.J]:{type:"keyword",array:!0,required:!0},[l.G]:{type:"keyword",array:!0,required:!1},[s.K]:{type:"date",required:!0,array:!1},[s.L]:{type:"version",array:!1,required:!1}},u={[l.a]:{type:"float",array:!1,required:!1},[l.b]:{type:"keyword",array:!1,required:!1},[l.c]:{type:"date",array:!1,required:!1},[l.d]:{type:"keyword",array:!1,required:!1},[l.e]:{type:"keyword",array:!1,required:!1},[l.f]:{type:"keyword",array:!1,required:!1},[l.g]:{type:"keyword",array:!1,required:!1},[l.h]:{type:"keyword",array:!1,required:!1},[l.i]:{type:"keyword",array:!1,required:!1},[l.j]:{type:"keyword",array:!1,required:!1},[l.k]:{type:"keyword",array:!0,required:!1},[l.l]:{type:"keyword",array:!1,required:!1},[l.m]:{type:"keyword",array:!1,required:!1},[l.n]:{type:"keyword",array:!1,required:!1},[l.o]:{type:"keyword",array:!1,required:!1},[l.p]:{type:"date",array:!1,required:!1},[l.q]:{type:"keyword",array:!1,required:!1},[l.r]:{type:"keyword",array:!1,required:!1},[l.s]:{type:"keyword",array:!1,required:!1},[l.t]:{type:"long",array:!1,required:!1},[l.u]:{type:"date",array:!1,required:!1},[l.v]:{type:"keyword",array:!0,required:!1},[l.w]:{type:"date",array:!1,required:!1},[l.y]:{type:"keyword",array:!0,required:!1},[l.z]:{type:"keyword",array:!1,required:!1},[l.A]:{type:"keyword",array:!1,required:!1},[l.C]:{type:"keyword",array:!1,required:!1},[l.B]:{type:"date",array:!1,required:!1},[l.D]:{type:"keyword",array:!1,required:!1}};function d(e,...t){const a=Object.keys(e).filter((e=>t.some((t=>{if(t===e)return!0;const a=e.split("."),n=t.split(".");return n.indexOf("*")===n.length-1&&a.every(((e,t)=>{const a=n.length-1<t?"*":n[t];return e===a||"*"===a}))}))));return Object(n.pick)(e,a)}const p={...d(c,"*"),...d(u,"*")};var m=a(44),y=a(5);const g=e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,t.toString()];case"object":try{return[...e,JSON.stringify(t)]}catch{return[...e,"Invalid Object"]}case"string":return[...e,t];default:return[...e,`${t}`]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[`${e}`];try{return[JSON.stringify(e)]}catch{return["Invalid Object"]}},f=["@timestamp","labels","message","tags"],b=e=>{const t=e.length>0?e[0]:null;if(null!=t&&!Object(m.isEmpty)(t.coordinates))try{return g({lon:t.coordinates[0],lat:t.coordinates[1]})}catch{return g(e)}return g(e)},h=(e,t,a)=>Object.keys(e).reduce(((n,i)=>{const s=e[i],l=null!=a?a:(e=>{const t=e.split(".")[0];return!Object(m.isEmpty)(t)&&f.includes(t)?"base":t})(i);if((e=>e.includes("geo.location")||e.includes("geoip.location"))(i))return[...n,{category:l,field:i,values:b(s),originalValue:b(s),isObjectArray:!0}];const c=(e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,{str:t.toString()}];case"object":try{return[...e,{str:JSON.stringify(t),isObjectArray:!0}]}catch{return[...e,{str:"Invalid Object"}]}case"string":return[...e,{str:t}];default:return[...e,{str:`${t}`}]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[{str:`${e}`}];try{return[{str:JSON.stringify(e),isObjectArray:!0}]}catch{return[{str:"Invalid Object"}]}})(s),u=c.map((({str:e})=>e)),d=c.some((e=>e.isObjectArray)),g=t?`${t}.${i}`:i;if(!d||void 0===Object.keys({...r,...p,...o}).find((e=>e===i)))return[...n,{category:l,field:g,values:u,originalValue:u,isObjectArray:d}];const v=((e,t)=>(null==t?void 0:t.includes(y.yb))||e===y.yb)(i,t)?[{category:l,field:g,values:u,originalValue:u,isObjectArray:d}]:[],E=Array.isArray(s)?s.reduce(((e,t)=>[...e,h(t,g,l)]),[]).flat():h(s,t,l),x=[...n,...E,...v].reduce(((e,t)=>({...e,...null!=e[t.field]?{[t.field]:{...t,originalValue:e[t.field].originalValue.includes(t.originalValue[0])?e[t.field].originalValue:[...e[t.field].originalValue,...t.originalValue],values:e[t.field].values.includes(t.values[0])?e[t.field].values:[...e[t.field].values,...t.values]}}:{[t.field]:t}})),{});return Object.values(x)}),[]);var v=a(195),E=a(797);const x=e=>e?e[0]:void 0;var k=a(244);const w=e=>e===v.c.InvestigationTime,S=e=>{const t=e.find((({field:e,originalValue:t})=>e===y.yb&&t));if(!t)return[];const{originalValue:a}=t;return(Array.isArray(a)?a:[a]).reduce(((e,t)=>{try{const a=h(JSON.parse(t));e.push(a)}catch(e){}return e}),[])},j=e=>e.reduce(((e,t)=>(e[t.field]=t.originalValue,e)),{}),O=(e,t)=>x(e[t]),I=(e,t)=>O(e,t)||O(e,`threatintel.${t}`)||O(e,`threat.${t}`),C=e=>({id:O(e,v.m),field:O(e,v.l),value:O(e,v.k),type:O(e,v.n),feedName:I(e,v.e)}),T=e=>{const{id:t,field:a}=C(e);return`${t}${a}`},M=e=>{if(e.length<2)return e;const t=Object(n.groupBy)(e,T);return Object.values(t).map((e=>{var t;return null!==(t=e.find((e=>!w(O(e,v.n)))))&&void 0!==t?t:e[0]}))},_=e=>e.reduce(((e,t)=>{if(Object(E.b)(t.field)){const a=x(t.originalValue);if(a)return{...e,[t.field]:a}}return e}),{}),N=e=>{const t=I(e,v.f),a=Date.parse(null!=t?t:"no date");return Number.isInteger(a)?a:new Date(-1).valueOf()},D=e=>Object.keys(e).sort().map((t=>{const a=t.startsWith(y.P)?t.replace(`${y.P}`,"indicator"):t;let r=x(e[t]);return Object(n.isObject)(r)&&(r=k.k),{title:a,description:{fieldName:t,value:r}}}))},340:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(19),r=a(444),i=a(2),o=a.n(i),s=a(41),l=a.n(s);const c=l.a.aside.withConfig({displayName:"Aside",componentId:"sc-tazcmx-0"})(["padding:",";",""],(({theme:e})=>e.eui.euiSizeM),(({overlay:e,overlayBackground:t,theme:a})=>e&&Object(s.css)(["background:",";bottom:0;left:0;position:absolute;right:0;top:0;z-index:",";"],t?Object(r.rgba)(t,.9):Object(r.rgba)(a.eui.euiColorEmptyShade,.9),a.eui.euiZLevel1)));c.displayName="Aside";const u=l()(n.EuiFlexGroup).attrs((()=>({alignItems:"center",direction:"column",gutterSize:"s",justifyContent:"center"}))).withConfig({displayName:"FlexGroup",componentId:"sc-tazcmx-1"})(["",""],(({overlay:e})=>e&&Object(s.css)(["height:100%;"])));u.displayName="FlexGroup";const d=o.a.memo((({children:e,overlay:t,overlayBackground:a,size:r})=>o.a.createElement(c,{overlay:t,overlayBackground:a},o.a.createElement(u,{overlay:{overlay:t}},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:r})),e&&o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiText,{color:"subdued",size:"s"},o.a.createElement("p",null,e)))))));d.displayName="Loader"},342:function(e,t,a){"use strict";a.d(t,"d",(function(){return w})),a.d(t,"c",(function(){return j})),a.d(t,"e",(function(){return O})),a.d(t,"a",(function(){return I})),a.d(t,"f",(function(){return q})),a.d(t,"i",(function(){return B})),a.d(t,"g",(function(){return T})),a.d(t,"h",(function(){return M})),a.d(t,"b",(function(){return $.a}));var n=a(2),r=a.n(n),i=a(19),o=a(42),s=a(4);const l=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.cancel",{defaultMessage:"Cancel"}),c=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.confirm",{defaultMessage:"Confirm"}),u=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment",{defaultMessage:"Comment"}),d=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment.placeholder",{defaultMessage:"You may leave an optional note here."}),p=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolation.successfulMessage",{defaultMessage:"Isolation on host {hostName} successfully submitted",values:{hostName:e}}),m=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolate.successfulMessage",{defaultMessage:"Release on host {hostName} successfully submitted",values:{hostName:e}}),y=s.i18n.translate("xpack.securitySolution.endpoint.hostisolation.unisolate",{defaultMessage:"release"}),g=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolated",{defaultMessage:"isolated"});var f=a(7),b=a(5),h=a(123),v=a(370),E=a(803);const x=({alertId:e})=>{const[t,a]=Object(n.useState)(!1),[r,i]=Object(n.useState)([]),{addError:o}=Object(h.a)();return Object(n.useEffect)((()=>{let t=!0;return a(!0),Object(f.isEmpty)(e)||(async()=>{try{const a=await Object(v.f)({alertId:e,owner:[b.j]});t&&i(a)}catch(e){o(e.message,{title:E.a})}t&&a(!1)})(),()=>{t=!1}}),[e,o]),{loading:t,casesInfo:r}};var k=a(144);const w=Object(n.memo)((({hostName:e,alertId:t,isolateAction:a="isolateHost",additionalInfo:s})=>r.a.createElement(i.EuiCallOut,{iconType:"check",color:"success",title:"isolateHost"===a?p(e):m(e),"data-test-subj":"isolateHost"===a?"hostIsolateSuccessMessage":"hostUnisolateSuccessMessage"},void 0!==t?(({alertIdForCase:e})=>{const{casesInfo:t}=x({alertId:e}),a=Object(n.useMemo)((()=>t.length),[t]),s=Object(n.useMemo)((()=>t.map(((e,t)=>r.a.createElement("li",{key:e.id},r.a.createElement(k.a,{detailName:e.id},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.placeholderCase",defaultMessage:"{caseName}",values:{caseName:e.title}})))))),[t]);return r.a.createElement(r.a.Fragment,null,a>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.successfulIsolation.cases",defaultMessage:"This action has been attached to the following {caseCount, plural, one {case} other {cases}}:",values:{caseCount:a}}))),r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("ul",null,s))))})({alertIdForCase:t}):s)));w.displayName="EndpointIsolateSuccess";var S=a(877);const j=Object(n.memo)((({hostName:e,onCancel:t,onConfirm:a,onChange:s,comment:p="",messageAppend:m,isLoading:y=!1})=>{const g=Object(n.useCallback)((e=>{s({comment:e.target.value})}),[s]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,null),r.a.createElement(i.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHost",defaultMessage:"Isolate host {hostName} from network.",values:{hostName:r.a.createElement("b",null,e)}}),r.a.createElement("br",null)),r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHostAbout",defaultMessage:"Isolating a host will disconnect it from the network. The host will only be able to communicate with the Kibana platform."})," ",m))),r.a.createElement(i.EuiFormRow,{label:u,fullWidth:!0},r.a.createElement(i.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:p,onChange:g})),r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{onClick:t,disabled:y,"data-test-subj":"hostIsolateCancelButton"},l)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{fill:!0,onClick:a,disabled:y,isLoading:y,"data-test-subj":"hostIsolateConfirmButton"},c))))))}));j.displayName="EndpointIsolateForm";const O=Object(n.memo)((({hostName:e,onCancel:t,onConfirm:a,onChange:s,comment:p="",messageAppend:m,isLoading:f=!1})=>{const b=Object(n.useCallback)((e=>{s({comment:e.target.value})}),[s]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,null),r.a.createElement(i.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.unIsolateThisHost",defaultMessage:"{hostName} is currently {isolated}. Are you sure you want to {unisolate} this host?",values:{hostName:r.a.createElement("b",null,e),isolated:r.a.createElement("b",null,g),unisolate:r.a.createElement("b",null,y)}})," ",m))),r.a.createElement(i.EuiFormRow,{label:u,fullWidth:!0},r.a.createElement(i.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:p,onChange:b})),r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{onClick:t,disabled:f,"data-test-subj":"hostIsolateCancelButton"},l)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{fill:!0,onClick:a,disabled:f,isLoading:f},c))))))}));O.displayName="EndpointUnisolateForm";const I=r.a.memo((({onClick:e,buttonText:t})=>{const a=Object(n.useCallback)((()=>e()),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{flush:"right",onClick:a,"data-test-subj":"hostIsolateSuccessCompleteButton"},r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,t))))))}));I.displayName="ActionCompletionReturnButton";var C=a(519);const T=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost",{defaultMessage:"Isolate host"}),M=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolateHost",{defaultMessage:"Release host"}),_=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost.casesAssociatedWithAlert",{defaultMessage:"{caseCount} {caseCount, plural, one {case} other {cases}} associated with this host",values:{caseCount:e}}),N=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.returnToAlertDetails",{defaultMessage:"Return to alert details"}),D=r.a.memo((({endpointId:e,hostName:t,casesInfo:a,agentType:s,cancelCallback:l,successCallback:c})=>{const[u,d]=Object(n.useState)(""),[p,m]=Object(n.useState)(!1),y=a.map((e=>e.id)),{loading:g,isolateHost:f}=(({endpointId:e,comment:t,caseIds:a,agentType:r})=>{const[i,o]=Object(n.useState)(!1),{addError:s}=Object(h.a)();return{loading:i,isolateHost:Object(n.useCallback)((async()=>{try{o(!0);const n=await Object(v.b)({endpointId:e,comment:t,caseIds:a&&a.length>0?a:void 0,agentType:r});return o(!1),!!n.action}catch(e){return o(!1),s(e.message,{title:E.b}),!1}}),[e,t,a,r,s])}})({endpointId:e,comment:u,caseIds:y,agentType:s}),b=Object(n.useCallback)((async()=>{const e=await f();m(e),e&&c&&c()}),[f,c]),x=Object(n.useCallback)((()=>l()),[l]),k=Object(n.useCallback)((({comment:e})=>d(e)),[]),w=Object(n.useMemo)((()=>a.length),[a]),S=Object(n.useMemo)((()=>r.a.createElement(I,{onClick:x,buttonText:N})),[x]),O=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(j,{hostName:t,onCancel:x,onConfirm:b,onChange:k,comment:u,isLoading:g,messageAppend:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:r.a.createElement("b",null,_(w))}})}))),[t,x,b,k,u,g,w]);return p?S:O}));D.displayName="IsolateHost";const A=r.a.memo((({endpointId:e,hostName:t,casesInfo:a,agentType:s,cancelCallback:l,successCallback:c})=>{const[u,d]=Object(n.useState)(""),[p,m]=Object(n.useState)(!1),y=a.map((e=>e.id)),{loading:g,unIsolateHost:f}=(({endpointId:e,comment:t,caseIds:a,agentType:r})=>{const[i,o]=Object(n.useState)(!1),{addError:s}=Object(h.a)();return{loading:i,unIsolateHost:Object(n.useCallback)((async()=>{try{o(!0);const n=await Object(v.c)({endpointId:e,comment:t,caseIds:a&&a.length>0?a:void 0,agentType:r});return o(!1),!!n.action}catch(e){return o(!1),s(e.message,{title:E.b}),!1}}),[e,t,a,r,s])}})({endpointId:e,comment:u,caseIds:y,agentType:s}),b=Object(n.useCallback)((async()=>{const e=await f();m(e),e&&c&&c()}),[c,f]),x=Object(n.useCallback)((()=>l()),[l]),k=Object(n.useCallback)((({comment:e})=>d(e)),[]),w=Object(n.useMemo)((()=>a.length),[a]),S=Object(n.useMemo)((()=>r.a.createElement(I,{onClick:x,buttonText:N})),[x]),j=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(O,{hostName:t,onCancel:x,onConfirm:b,onChange:k,comment:u,isLoading:g,messageAppend:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:r.a.createElement("b",null,_(w))}})}))),[t,x,b,k,u,g,w]);return p?S:j}));A.displayName="UnisolateHost";var F=a(332);const q=r.a.memo((({details:e,cancelCallback:t,successCallback:a,isolateAction:s})=>{const{isSupported:l,details:{agentId:c,agentType:u,hostName:d}}=Object(F.a)(e),p=Object(n.useMemo)((()=>Object(C.a)({category:"_id",field:"_id"},e)),[e]),{casesInfo:m}=x({alertId:p}),y=Object(n.useMemo)((()=>({endpointId:c,hostName:d,casesInfo:m,agentType:u,cancelCallback:t,successCallback:a})),[c,u,t,m,d,a]);return l?"isolateHost"===s?r.a.createElement(D,y):r.a.createElement(A,y):r.a.createElement(i.EuiCallOut,{color:"warning","data-test-subj":"unsupportedAlertHost"},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.alertHostNotSupported",defaultMessage:"The alert's host ({hostName}) does not support host isolation response actions.",values:{hostName:d}}))}));q.displayName="HostIsolationContent";var L=a(502),R=a(203),P=a(140),z=a(725);const B=({closePopover:e,detailsData:t,isHostIsolationPanelOpen:a,onAddIsolationStatusClick:r})=>{const{isSupported:i,isAlert:o,unsupportedReason:s,details:{agentType:l,agentId:c,agentSupport:{isolate:u}}}=Object(F.a)(t),{canIsolateHost:d,canUnIsolateHost:p}=Object(P.a)().endpointPrivileges,{data:m,isLoading:y,isFetched:g}=Object(z.a)(c,l,{enabled:i}),f=null==m?void 0:m[c],b=Object(n.useMemo)((()=>i&&u),[i,u]),h=Object(n.useMemo)((()=>Boolean(null==f?void 0:f.isolated)),[null==f?void 0:f.isolated]),v=Object(n.useCallback)((()=>{e(),b&&r(h?"unisolateHost":"isolateHost")}),[e,b,h,r]),E=Object(n.useMemo)((()=>!i||!(null!=f&&f.found)||f.status===R.d.UNENROLLED),[i,f]);return Object(n.useMemo)((()=>{if(!o||h&&!p||!d)return[];const e={key:"isolate-host-action-item","data-test-subj":"isolate-host-action-item",disabled:E||a,onClick:v,name:h?M:T};return b?y||!g?(e.disabled=!0,e.toolTipContent=L.b):E&&(e.disabled=!0,e.toolTipContent="endpoint"===l?L.a:L.c):(e.disabled=!0,e.toolTipContent=l&&s?s:L.c),[e]}),[o,h,p,d,E,a,v,b,y,g,l,s])};var $=a(823)},343:function(e,t,a){"use strict";a.d(t,"j",(function(){return h})),a.d(t,"i",(function(){return v})),a.d(t,"m",(function(){return E})),a.d(t,"d",(function(){return x})),a.d(t,"e",(function(){return k})),a.d(t,"a",(function(){return w})),a.d(t,"c",(function(){return S})),a.d(t,"n",(function(){return j})),a.d(t,"l",(function(){return O})),a.d(t,"b",(function(){return N})),a.d(t,"f",(function(){return D})),a.d(t,"g",(function(){return A})),a.d(t,"h",(function(){return F})),a.d(t,"k",(function(){return q}));var n=a(2),r=a.n(n),i=a(19),o=a(7),s=a(54),l=a.n(s),c=(a(1281),a(506)),u=a(403),d=a(1555),p=a(818),m=a(549),y=a(353),g=a(873),f=a(572);const b=["kibana.alert.rule","signal.rule","rule"],h=e=>e.map((e=>({username:e.created_by,timestamp:l()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:y.b,timelineAvatar:r.a.createElement(i.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:r.a.createElement(i.EuiText,{size:"s"},e.comment),actions:r.a.createElement(g.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:y.a})}))),v=e=>{const{created_at:t,created_by:a,list_id:n,tie_breaker_id:r,updated_at:i,updated_by:o,...s}=e;return{...s}},E=e=>e.map((e=>{if(void 0!==e.entries){const t=e.entries.map((e=>{const t=Object(o.omit)(e,"id");return{...t,field:t.field.startsWith("event.")?t.field.replace(/^event./,`${f.f}.`):t.field}}));return{...e,entries:t,comments:[]}}return{...e,comments:[]}})),x=(e,t)=>e.map((e=>({...e,comments:t}))),k=(e,t)=>{const a=void 0!==t?t.toISOString():void 0;return e.map((e=>({...e,expire_time:a})))},w=e=>({query:{match:{_id:{query:e||""}}}}),S=(e,t)=>e.map((e=>({...e,os_types:t}))),j=e=>{const t=["windows","macos"];if(null!=e){var a,n,r,i,o,s;const l="endpoint"===(null==e||null===(a=e.agent)||void 0===a?void 0:a.type)?null===(n=e.host)||void 0===n||null===(r=n.os)||void 0===r||null===(i=r.name)||void 0===i?void 0:i.toLowerCase():null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family;if(null!=l)return c.a.is(l)?[l]:t}return t},O=e=>e.map((e=>{const t=e.entries.map((e=>{if(e.field.includes(".hash")){if("match"===e.type)return{...e,value:e.value.toLowerCase()};if("match_any"===e.type)return{...e,value:e.value.map((e=>e.toLowerCase()))}}return e}));return{...e,entries:t}})),I=e=>{if(Array.isArray(e)&&e.length>0)return e.map((e=>{var t,a,n;return{subjectName:null!==(t=null==e?void 0:e.subject_name)&&void 0!==t?t:"",trusted:null!==(a=null==e||null===(n=e.trusted)||void 0===n?void 0:n.toString())&&void 0!==a?a:""}}));{var t,a;const n=Array.isArray(e)?void 0:e;return[{subjectName:null!==(t=null==n?void 0:n.subject_name)&&void 0!==t?t:"",trusted:null!==(a=null==n?void 0:n.trusted)&&void 0!==a?a:""}]}};function C(e){const t=[];for(const a of e)void 0!==a.entries?(a.entries=a.entries.filter((e=>void 0!==e.value&&e.value.length>0)),t.push(a)):void 0!==a.value&&a.value.length>0&&t.push(a);return t}const T=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:r})=>{var i,o,s,l,c,u;const{process:p}=r,m=C([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(i=null===(o=r.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==i?i:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==p?void 0:p.executable)&&void 0!==s?s:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(l=null==p?void 0:p.name)&&void 0!==l?l:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!==(c=null==p||null===(u=p.hash)||void 0===u?void 0:u.sha256)&&void 0!==c?c:""}]);return{...Object(d.e)({listId:e,namespaceType:n,name:t}),entries:Object(d.a)(m)}},M=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:r})=>{var i,o,s,l,c,u,p,m,y;const{process:g}=r,f=C([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(i=null===(o=r.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==i?i:""},{field:"Memory_protection.self_injection",operator:"included",type:"match",value:null!==(s=String(null===(l=r.Memory_protection)||void 0===l?void 0:l.self_injection))&&void 0!==s?s:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(c=null==g?void 0:g.executable)&&void 0!==c?c:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(u=null==g?void 0:g.name)&&void 0!==u?u:""},{field:"process.Ext.token.integrity_level_name",operator:"included",type:"match",value:null!==(p=null==g||null===(m=g.Ext)||void 0===m||null===(y=m.token)||void 0===y?void 0:y.integrity_level_name)&&void 0!==p?p:""}]);return{...Object(d.e)({listId:e,namespaceType:n,name:t}),entries:Object(d.a)(f)}},_=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:r})=>{var i,o,s,l,c,u,p,m,y,g,f,b,h,v,E,x,k,w,S,j,O,I,T,M,_,N,D,A,F,q,L,R,P,z,B,$,G,U,V;const{process:H}=r,W=C([{field:"rule.id",operator:"included",type:"match",value:null!==(i=null===(o=r.rule)||void 0===o?void 0:o.id)&&void 0!==i?i:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==H?void 0:H.executable)&&void 0!==s?s:""},{field:"process.command_line",operator:"included",type:"match",value:null!==(l=null==H?void 0:H.command_line)&&void 0!==l?l:""},{field:"process.parent.executable",operator:"included",type:"match",value:null!==(c=null==H||null===(u=H.parent)||void 0===u?void 0:u.executable)&&void 0!==c?c:""},{field:"process.code_signature.subject_name",operator:"included",type:"match",value:null!==(p=null==H||null===(m=H.code_signature)||void 0===m?void 0:m.subject_name)&&void 0!==p?p:""},{field:"file.path",operator:"included",type:"match",value:null!==(y=null===(g=r.file)||void 0===g?void 0:g.path)&&void 0!==y?y:""},{field:"file.name",operator:"included",type:"match",value:null!==(f=null===(b=r.file)||void 0===b?void 0:b.name)&&void 0!==f?f:""},{field:"source.ip",operator:"included",type:"match",value:null!==(h=null===(v=r.source)||void 0===v?void 0:v.ip)&&void 0!==h?h:""},{field:"destination.ip",operator:"included",type:"match",value:null!==(E=null===(x=r.destination)||void 0===x?void 0:x.ip)&&void 0!==E?E:""},{field:"registry.path",operator:"included",type:"match",value:null!==(k=null===(w=r.registry)||void 0===w?void 0:w.path)&&void 0!==k?k:""},{field:"registry.value",operator:"included",type:"match",value:null!==(S=null===(j=r.registry)||void 0===j?void 0:j.value)&&void 0!==S?S:""},{field:"registry.data.strings",operator:"included",type:"match",value:null!==(O=null===(I=r.registry)||void 0===I||null===(T=I.data)||void 0===T?void 0:T.strings)&&void 0!==O?O:""},{field:"dll.path",operator:"included",type:"match",value:null!==(M=null===(_=r.dll)||void 0===_?void 0:_.path)&&void 0!==M?M:""},{field:"dll.code_signature.subject_name",operator:"included",type:"match",value:null!==(N=null===(D=r.dll)||void 0===D||null===(A=D.code_signature)||void 0===A?void 0:A.subject_name)&&void 0!==N?N:""},{field:"dll.pe.original_file_name",operator:"included",type:"match",value:null!==(F=null===(q=r.dll)||void 0===q||null===(L=q.pe)||void 0===L?void 0:L.original_file_name)&&void 0!==F?F:""},{field:"dns.question.name",operator:"included",type:"match",value:null!==(R=null===(P=r.dns)||void 0===P||null===(z=P.question)||void 0===z?void 0:z.name)&&void 0!==R?R:""},{field:"dns.question.type",operator:"included",type:"match",value:null!==(B=null===($=r.dns)||void 0===$||null===(G=$.question)||void 0===G?void 0:G.type)&&void 0!==B?B:""},{field:"user.id",operator:"included",type:"match",value:null!==(U=null===(V=r.user)||void 0===V?void 0:V.id)&&void 0!==U?U:""}]);return{...Object(d.e)({listId:e,namespaceType:n,name:t}),entries:Object(d.a)(W)}},N=(e,t,a)=>{var n,r;const i=null!==(n=a["event.code"])&&void 0!==n?n:null===(r=a.event)||void 0===r?void 0:r.code;switch(i){case"behavior":return[_({listId:e,name:t,eventCode:i,alertEcsData:a})];case"memory_signature":return[T({listId:e,name:t,eventCode:i,alertEcsData:a})];case"shellcode_thread":return[M({listId:e,name:t,eventCode:i,alertEcsData:a})];case"ransomware":return(e=>{const{process:t}=e,a=t&&t.Ext&&t.Ext.code_signature;return I(a)})(a).map((n=>(({listId:e,name:t,codeSignature:a,eventCode:n,listNamespace:r="agnostic",alertEcsData:i})=>{var o,s,l,c;const{process:u,Ransomware:p}=i,m=null!==(o=null==u||null===(s=u.hash)||void 0===s?void 0:s.sha256)&&void 0!==o?o:"",y=null!==(l=null==u?void 0:u.executable)&&void 0!==l?l:"",g=null!==(c=null==p?void 0:p.feature)&&void 0!==c?c:"";return{...Object(d.e)({listId:e,namespaceType:r,name:t}),entries:Object(d.a)([{field:"process.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=a?a.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=a?a.trusted:""}]},{field:"process.executable",operator:"included",type:"match",value:null!=y?y:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!=m?m:""},{field:"Ransomware.feature",operator:"included",type:"match",value:null!=g?g:""},{field:"event.code",operator:"included",type:"match",value:null!=n?n:""}])}})({listId:e,name:t,eventCode:i,codeSignature:n,alertEcsData:a})));default:return(e=>{const{file:t}=e,a=t&&t.Ext&&t.Ext.code_signature;return I(a)})(a).map((n=>(({listId:e,name:t,codeSignature:a,eventCode:n,listNamespace:r="agnostic",alertEcsData:i})=>{var o,s,l,c;const{file:u,host:p}=i,m=null!==(o=null==u?void 0:u.path)&&void 0!==o?o:"",y=null!==(s=null==u||null===(l=u.hash)||void 0===l?void 0:l.sha256)&&void 0!==s?s:"",g="Linux"===(null==p||null===(c=p.os)||void 0===c?void 0:c.name),f=[{field:g?"file.path":"file.path.caseless",operator:"included",type:"match",value:null!=m?m:""},{field:"file.hash.sha256",operator:"included",type:"match",value:null!=y?y:""},{field:"event.code",operator:"included",type:"match",value:null!=n?n:""}];return{...Object(d.e)({listId:e,namespaceType:r,name:t}),entries:g?Object(d.a)(f):Object(d.a)([{field:"file.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=a?a.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=a?a.trusted:""}]},...f])}})({listId:e,name:t,eventCode:null!=i?i:"",codeSignature:n,alertEcsData:a})))}},D=(e,t)=>e.map((e=>({...e,name:t}))),A=e=>e.map((e=>({...Object(p.a)(e),list_id:void 0,namespace_type:"single"}))),F=(e,t)=>t.flatMap((t=>e.map((e=>({...Object(p.a)(e),list_id:t.list_id,namespace_type:t.namespace_type}))))),q=({alertData:e,exceptionItemName:t,ruleCustomHighlightedFields:a})=>{const n=L(e,a);if(!n.length)return null;const r=(({highlightedFields:e,alertData:t})=>Object.values(e).reduce(((e,a)=>{var n;const r=a.id,i=null!==(n=Object(o.get)(t,r))&&void 0!==n?n:Object(o.get)(t,`kibana.alert.${r}`);if(null!=i){const t=Array.isArray(i)?u.b.MATCH_ANY:u.b.MATCH,a=Array.isArray(i)?i.map(String):i.toString();e.push({field:r,operator:u.a.INCLUDED,type:t,value:a})}return e}),[]))({highlightedFields:n,alertData:e});return r.length?(({name:e,exceptionEntries:t})=>({...Object(d.e)({listId:void 0,namespaceType:"single",name:e}),entries:Object(d.a)(t)}))({name:t,exceptionEntries:r}):null},L=(e,t)=>{const a=Object(o.get)(e,"event.category"),n=Object(o.get)(e,"event.code"),r=Object(o.get)(e,"kibana.alert.rule.type"),i={primaryEventCategory:Array.isArray(a)?a[0]:a,allEventCategories:[a]};return((e,t,a)=>e.filter((({id:e})=>"agent.id"===e?R(a):!t.some((t=>e.startsWith(t))))))(Object(m.b)({eventCategories:i,eventCode:n,eventRuleType:r,highlightedFieldsOverride:t}),b,e)},R=e=>{if(!Object(o.get)(e,"kibana.alert.rule.uuid"))return!1;const t=Object(o.get)(e,"agent.type");return"endpoint"===(Array.isArray(t)?t[0]:t)}},352:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a(5),i=a(161),o=a(381),s=a(380),l=a(124),c=a(148);const u="countOfAlertsWithSameFieldAndValue",d=({field:e,value:t,isActiveTimelines:a,signalIndexName:r,includeAlertIds:d=!1,ignoreTimerange:m=!1})=>{const y=Object(l.a)((e=>c.d.timelineTimeRangeSelector(e))),g=Object(i.a)();let f,b;!1===m&&({to:f,from:b}=a?y:g);const[h]=Object(n.useState)((()=>p(e,t,b,f,d))),{loading:v,data:E,setQuery:x}=Object(o.a)({query:h,indexName:r,queryName:s.a.PREVALENCE});let k;if(Object(n.useEffect)((()=>{x(p(e,t,b,f,d))}),[x,e,t,b,f,d]),E){var w,S;const e=null===(w=E.aggregations)||void 0===w||null===(S=w[u])||void 0===S?void 0:S.buckets;e&&e.length>0&&(k=e[0].doc_count)}const j=!v&&void 0===k;return Object(n.useMemo)((()=>({loading:v,count:k,error:j,alertIds:null==E?void 0:E.hits.hits.map((({_id:e})=>e))})),[k,E,j,v])},p=(e,t,a,n,i)=>{const o=i?{size:r.V}:{size:0},s=i?{sort:{"@timestamp":"desc"}}:{},l=Array.isArray(t)&&1===t.length?t[0]:t;let c;return c={bool:{must:{match:{[e]:l}}}},void 0!==a&&void 0!==n&&(c={...c,bool:{...c.bool,filter:[{range:{"@timestamp":{gte:a,lte:n}}}]}}),Array.isArray(t)&&t.length>1&&(c={bool:{must:t.map((t=>({term:{[e]:t}})))}},void 0!==a&&void 0!==n&&c.bool.must.push({range:{"@timestamp":{gte:a,lte:n}}})),{...o,...s,_source:!1,aggs:{[u]:{terms:{field:e,size:r.V}}},query:c,runtime_mappings:{}}}},353:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"c",(function(){return m}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),i=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o=(n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"})),s=(n.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),n.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),n.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),n.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),n.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),n.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"})),l=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),c=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),u=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),d=n.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"}),p=n.i18n.translate("xpack.securitySolution.ruleExceptions.addException.ruleException",{defaultMessage:"rule exception"}),m=n.i18n.translate("xpack.securitySolution.ruleExceptions.addException.endpointException",{defaultMessage:"endpoint exception"})},354:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return v})),a.d(t,"d",(function(){return E})),a.d(t,"c",(function(){return x}));var n=a(2),r=a.n(n),i=a(44),o=a(1334),s=a(19),l=a(778),c=a(1257),u=a(982),d=a(343),p=a(950),m=a(595);const y=e=>t=>""!==e.trim()?Object(d.d)(t,[{comment:e}]):t,g=e=>t=>""!==e.trim()?Object(d.f)(t,e):t,f=e=>t=>Object(d.e)(t,e),b=(e,t)=>a=>e===o.a.ENDPOINT?Object(d.l)(Object(d.c)(a,t)):a,h=({itemName:e,commentToAdd:t,addToRules:a,addToSharedLists:n,sharedLists:r,selectedOs:s,listType:l,expireTime:c,items:u})=>{const p=Object(i.pipe)(y(t),f(c),g(e),b(l,s),((e,t)=>a=>t&&e!==o.a.ENDPOINT?Object(d.g)(a):a)(l,a),((e,t,a)=>n=>t&&e!==o.a.ENDPOINT?Object(d.h)(n,a):n)(l,n,r))(u);return p},v=({itemName:e,commentToAdd:t,selectedOs:a,listType:n,expireTime:r,items:o})=>Object(i.pipe)(y(t),f(r),g(e),b(n,a))(o),E=()=>[{field:"name",name:m.c,sortable:!0,"data-test-subj":"exceptionListNameCell"},{field:"referenced_rules",name:"Number of rules linked to",sortable:!1,"data-test-subj":"exceptionListRulesLinkedToIdCell",render:e=>r.a.createElement(l.a,{emptyButton:!0,useCustomActions:!0,actions:Object(c.a)({dataTestSubj:"addToSharedListsLinkedRulesMenu",linkedRules:e,securityLinkAnchorComponent:p.f}),panelPaddingSize:"none",disableActions:!1,text:e.length.toString(),dataTestSubj:"addToSharedListsLinkedRulesMenuAction"})},{name:m.a,"data-test-subj":"exceptionListRulesActionCell",render:e=>r.a.createElement(p.e,{dataTestSubj:"exceptionListActionCell-link",linkTitle:m.e,listId:e.list_id,external:!0})}],x=()=>[{field:"name",align:"left",name:m.c,sortable:!0,"data-test-subj":"ruleNameCell",truncateText:!1},{field:"tags",align:"left",name:m.d,"data-test-subj":"ruleNameCell",render:e=>0===e.length?null:r.a.createElement(u.a,{items:e,popoverTitle:m.d,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>r.a.createElement(s.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)})},{name:m.a,"data-test-subj":"ruleAction-view",render:e=>r.a.createElement(p.f,{external:!0,referenceId:e.id,referenceName:m.f})}]},355:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return K}));var n=a(49);const r=parseInt(n.euiThemeVars.euiSizeXL,10)-parseInt(n.euiThemeVars.euiSizeXS,10),i=e=>"signal"===e,o=e=>(e>0?e*r:r)+2*parseInt(n.euiThemeVars.euiDataGridCellPaddingM,10);var s=a(2),l=a.n(s),c=a(45),u=a(19),d=a(41),p=a.n(d),m=a(1403),y=a(1630),g=a(289),f=a(169),b=a(272),h=a(131),v=a(541),E=a(129),x=a(149),k=a(934),w=a(121),S=a(140),j=a(594),O=a(838);const I=({ariaLabel:e,timelineType:t,toggleShowNotes:a,eventId:n,notesCount:r})=>{const{kibanaSecuritySolutionsPrivileges:i}=Object(S.a)(),o=Object(s.useMemo)((()=>r>0?j.g({notesCount:r}):j.f),[r]);return l.a.createElement(O.a,null,l.a.createElement(k.b,{ariaLabel:e,"data-test-subj":"add-note",isDisabled:!1===i.crud,timelineType:t,toggleShowNotes:a,toolTip:t===w.m.template?j.h:o,eventId:n,notesCount:r}))};I.displayName="AddEventNoteActionComponent";const C=l.a.memo(I);var T=a(180),M=a(839);const _=({ariaLabel:e,isAlert:t,noteIds:a,onPinClicked:n,eventIsPinned:i,timelineType:o})=>{const{kibanaSecuritySolutionsPrivileges:c}=Object(S.a)(),d=Object(s.useMemo)((()=>Object(b.g)({isPinned:i,isAlert:t,eventHasNotes:Object(b.b)(a),timelineType:o})),[i,t,a,o]);return l.a.createElement("div",{key:"timeline-action-pin-tool-tip"},l.a.createElement(T.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"timeline-action-pin-tool-tip",content:d},l.a.createElement(M.a,{ariaLabel:e,allowUnpinning:!Object(b.b)(a),"data-test-subj":"pin-event",isDisabled:!1===c.crud,isAlert:t,onClick:n,pinned:i,timelineType:o}))))};_.displayName="PinEventActionComponent";const N=l.a.memo(_);var D=a(124),A=a(158),F=a(187),q=a(16),L=a(206),R=a(219),P=a(13),z=a(969),B=a(730),$=a(256),G=a(170),U=a(758),V=a(305),H=a(122);const W=p.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-3eeodk-0"})(["align-items:center;display:flex;"]),Y=[],Z=({ariaRowindex:e,columnValues:t,disableExpandAction:a=!1,ecsData:n,eventId:o,eventIdToNoteIds:d,isEventPinned:p=!1,isEventViewer:k=!1,onEventDetailsPanelOpened:w,onRuleChange:S,showNotes:O,timelineId:I,refetch:M,toggleShowNotes:_,disablePinAction:Z=!0})=>{const K=Object(c.useDispatch)(),{timelineType:Q}=Object(D.b)((e=>Object(h.isTimelineScope)(I)?Object(f.selectTimelineById)(e,I):A.b)),{startTransaction:X}=Object(F.b)(),J=Object(q.b)().isEnterprise(),ee=Object(s.useCallback)((e=>K(E.a.pinEvent({id:I,eventId:e}))),[K,I]),te=Object(s.useCallback)((e=>K(E.a.unPinEvent({id:I,eventId:e}))),[K,I]),ae=Object(s.useCallback)((()=>Object(b.f)({allowUnpinning:!d||!Object(b.b)(d[o]),eventId:o,onPinEvent:ee,onUnPinEvent:te,isEventPinned:p})),[d,o,p,ee,te]),ne=Object(b.e)(n),re=Object(s.useMemo)((()=>{var e,t,a,r;return"signal"!==ne&&!(null!==(e=n.event)&&void 0!==e&&null!==(t=e.kind)&&void 0!==t&&t.includes("event")&&null!==(a=n.agent)&&void 0!==a&&null!==(r=a.type)&&void 0!==r&&r.includes("endpoint"))}),[n,ne]),ie=!Object(v.a)(n),{setGlobalFullScreen:oe}=Object(L.a)(),{setTimelineFullScreen:se}=Object(L.c)(),le=Object(s.useCallback)((()=>{X({name:R.a.OPEN_ANALYZER});const e=Object(h.getScopedActions)(I),t=document.querySelector(".euiDataGrid--fullScreen");e&&K(e.updateGraphEventId({id:I,graphEventId:n._id})),I===x.f.active?(t&&se(!0),K(Object(P.setActiveTabTimeline)({id:I,activeTab:m.a.graph}))):t&&oe(!0)}),[X,I,K,n._id,se,oe]),ce=Object(s.useMemo)((()=>{var e,t,a,r,i,o,s,l,c,u;const{process:d,_id:p,_index:m,timestamp:y,kibana:g}=n,f=null==d||null===(e=d.entry_leader)||void 0===e||null===(t=e.entity_id)||void 0===t?void 0:t[0],b=null==d||null===(a=d.entry_leader)||void 0===a||null===(r=a.start)||void 0===r?void 0:r[0],h=(null==g||null===(i=g.alert)||void 0===i||null===(o=i.ancestors)||void 0===o||null===(s=o.index)||void 0===s?void 0:s[0])||m;if(void 0===h||void 0===f||void 0===b)return null;const v=null==d||null===(l=d.entity_id)||void 0===l?void 0:l[0],E="signal"===ne||"eql"===ne?p:void 0;return{index:h,sessionEntityId:f,sessionStartTime:b,jumpToEntityId:v,jumpToCursor:E&&(null===(c=n.kibana)||void 0===c||null===(u=c.alert.original_time)||void 0===u?void 0:u[0])||y,investigatedAlertId:E}}),[n,ne]),ue=Object(s.useCallback)((()=>{const e=document.querySelector(".euiDataGrid--fullScreen");X({name:R.a.OPEN_SESSION_VIEW});const t=Object(h.getScopedActions)(I);I===x.f.active?(e&&se(!0),null!==ce&&K(Object(P.setActiveTabTimeline)({id:I,activeTab:m.a.session}))):e&&oe(!0),null!==ce&&t&&K(t.updateSessionViewConfig({id:I,sessionViewConfig:ce}))}),[X,I,ce,se,K,oe]),{activeStep:de,isTourShown:pe,incrementStep:me}=Object($.b)(),ye=Object(s.useMemo)((()=>pe(G.b.alertsCases)&&"signal"===ne&&Object(U.c)(I)&&1===e),[pe,e,ne,I]),ge=Object(s.useCallback)((()=>{ye&&de===G.a.expandEvent&&pe(G.b.alertsCases)&&me(G.b.alertsCases),w()}),[de,me,ye,pe,w]),fe=Object(H.a)("securitySolutionNotesEnabled"),be=Object(H.a)("expandableFlyoutDisabled"),he=Object(c.useSelector)((e=>Object(g.q)(e,o))),ve=Object(s.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d[o])&&void 0!==e?e:Y}),[d,o]),Ee=Object(s.useMemo)((()=>fe&&!be?he.length:ve.length),[he,ve,fe,be]),xe=Object(s.useMemo)((()=>fe&&!be?he.map((e=>e.noteId)):ve),[he,ve,fe,be]);return l.a.createElement(W,{"data-test-subj":"actions-container"},l.a.createElement(l.a.Fragment,null,!a&&l.a.createElement(V.a,{isTourAnchor:ye,onClick:ge,step:G.a.expandEvent,tourId:G.b.alertsCases},l.a.createElement("div",{key:"expand-event"},l.a.createElement(T.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:j.m},l.a.createElement(u.EuiButtonIcon,{"aria-label":j.n({ariaRowindex:e,columnValues:t}),"data-test-subj":"expand-event",iconType:"expand",onClick:ge,size:"s"}))))),l.a.createElement(l.a.Fragment,null,I!==x.f.active&&l.a.createElement(B.a,{ariaLabel:j.k({ariaRowindex:e,columnValues:t}),key:"investigate-in-timeline",ecsRowData:n})),!k&&O&&l.a.createElement(C,{ariaLabel:j.c({ariaRowindex:e,columnValues:t}),key:"add-event-note",timelineType:Q,notesCount:Ee,eventId:o,toggleShowNotes:_}),!k&&!Z&&l.a.createElement(N,{ariaLabel:j.j({ariaRowindex:e,columnValues:t,isEventPinned:p}),isAlert:i(ne),key:"pin-event",onPinClicked:ae,noteIds:xe,eventIsPinned:p,timelineType:Q}),l.a.createElement(z.b,{ariaLabel:j.e({ariaRowindex:e,columnValues:t}),ariaRowindex:e,columnValues:t,key:"alert-context-menu",ecsRowData:n,scopeId:I,disabled:re,onRuleChange:S,refetch:M}),!1===ie?l.a.createElement("div",null,l.a.createElement(T.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"view-in-analyzer-tool-tip",content:j.a},l.a.createElement(u.EuiButtonIcon,{"aria-label":j.b({ariaRowindex:e,columnValues:t}),"data-test-subj":"view-in-analyzer",iconType:"analyzeEvent",onClick:le,size:"s"})))):null,null===ce||!J&&I!==y.b.kubernetesPageSessions?null:l.a.createElement("div",null,l.a.createElement(T.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:j.i},l.a.createElement(u.EuiButtonIcon,{"aria-label":j.n({ariaRowindex:e,columnValues:t}),"data-test-subj":"session-view-button",iconType:"sessionViewer",onClick:ue,size:"s"}))))))};Z.displayName="ActionsComponent";const K=l.a.memo(Z);a(698)},357:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(19),r=a(2),i=a.n(r);const o=a(4).i18n.translate("xpack.securitySolution.overview.informationAriaLabel",{defaultMessage:"Information"});var s=a(666);const l=({toolTipContent:e,toolTipTitle:t,width:a=270,anchorPosition:s="leftCenter"})=>{const[l,c]=Object(r.useState)(!1),u=Object(r.useCallback)((()=>{c(!l)}),[l,c]),d=Object(r.useCallback)((()=>{c(!1)}),[c]);return i.a.createElement(n.EuiPopover,{isOpen:l,closePopover:d,anchorPosition:s,button:i.a.createElement(n.EuiButtonIcon,{color:"text",size:"xs",iconSize:"m",iconType:"iInCircle","aria-label":o,onClick:u})},t&&i.a.createElement(n.EuiPopoverTitle,null,t),i.a.createElement(n.EuiText,{size:"s",style:{width:`${a}px`}},e))},c=({anchorPosition:e})=>i.a.createElement(l,{anchorPosition:e,toolTipContent:i.a.createElement(s.a,null)})},367:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(2),r=a.n(n),i=a(19),o=a(1363),s=a(130),l=a(151),c=a(137);let u=function(e){return e.FIRST_SEEN="first-seen",e.LAST_SEEN="last-seen",e}({});const d=r.a.memo((({indexPatterns:e,field:t,type:a,value:d})=>{const[p,{firstSeen:m,lastSeen:y,errorMessage:g}]=Object(o.a)({field:t,value:d,order:a===u.FIRST_SEEN?c.b.asc:c.b.desc,defaultIndex:e}),f=Object(n.useMemo)((()=>a===u.FIRST_SEEN?m:y),[m,y,a]);return null!=g?r.a.createElement(i.EuiToolTip,{position:"top",content:g,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":`firstLastSeenError-${a}`,id:`firstLastSeenError-${t}-${a}`},r.a.createElement(i.EuiIcon,{"aria-describedby":`firstLastSeenError-${t}-${a}`,type:"warning"})):r.a.createElement(r.a.Fragment,null,p&&r.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"m"}),p||null==f||"Invalid Date"!==new Date(f).toString()?!p&&null!==f&&r.a.createElement(i.EuiText,{"data-test-subj":"first-last-seen-value",size:"s"},r.a.createElement(l.b,{value:`${f}`})):f,!p&&null===f&&Object(s.d)())}));d.displayName="FirstLastSeen"},383:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(47),r=a(2),i=a(5),o=a(159),s=a(322);const l=["GET",i.rb],c=(e,t)=>Object(n.useQuery)([...l,e],(async({signal:t})=>{const a=await Object(o.j)({signal:t,...e});return{rules:a.data,total:a.total}}),{...s.a,staleTime:0,...t}),u=()=>{const e=Object(n.useQueryClient)();return Object(r.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])},d=()=>{const e=Object(n.useQueryClient)();return Object(r.useCallback)((t=>{e.setQueriesData(l,(e=>e?{rules:p(e.rules,t),total:e.total}:void 0))}),[e])};function p(e,t){const a=new Map(t.map((e=>[e.id,e])));return e.some((e=>a.has(e.id)))?e.map((e=>{var t;return null!==(t=a.get(e.id))&&void 0!==t?t:e})):e}},392:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return g})),a.d(t,"d",(function(){return f}));var n={};a.r(n),a.d(n,"dnsSelector",(function(){return E})),a.d(n,"topNFlowSelector",(function(){return k})),a.d(n,"tlsSelector",(function(){return S})),a.d(n,"topCountriesSelector",(function(){return O})),a.d(n,"httpSelector",(function(){return C})),a.d(n,"usersSelector",(function(){return T})),a.d(n,"networkAnomaliesJobIdFilterSelector",(function(){return M})),a.d(n,"networkAnomaliesIntervalSelector",(function(){return _}));var r=a(1234),i=a(404),o=a(57),s=a(44),l=a(409),c=a(552),u=a(979),d=a(137),p=a(1212);const m=e=>({...e.page.queries,[i.NetworkTableType.topCountriesSource]:{...e.page.queries[i.NetworkTableType.topCountriesSource],activePage:p.a},[i.NetworkTableType.topCountriesDestination]:{...e.page.queries[i.NetworkTableType.topCountriesDestination],activePage:p.a},[i.NetworkTableType.topNFlowSource]:{...e.page.queries[i.NetworkTableType.topNFlowSource],activePage:p.a},[i.NetworkTableType.topNFlowDestination]:{...e.page.queries[i.NetworkTableType.topNFlowDestination],activePage:p.a},[i.NetworkTableType.dns]:{...e.page.queries[i.NetworkTableType.dns],activePage:p.a},[i.NetworkTableType.tls]:{...e.page.queries[i.NetworkTableType.tls],activePage:p.a},[i.NetworkTableType.http]:{...e.page.queries[i.NetworkTableType.http],activePage:p.a}}),y=e=>({...e.details.queries,[i.NetworkDetailsTableType.topCountriesSource]:{...e.details.queries[i.NetworkDetailsTableType.topCountriesSource],activePage:p.a},[i.NetworkDetailsTableType.topCountriesDestination]:{...e.details.queries[i.NetworkDetailsTableType.topCountriesDestination],activePage:p.a},[i.NetworkDetailsTableType.topNFlowSource]:{...e.details.queries[i.NetworkDetailsTableType.topNFlowSource],activePage:p.a},[i.NetworkDetailsTableType.topNFlowDestination]:{...e.details.queries[i.NetworkDetailsTableType.topNFlowDestination],activePage:p.a},[i.NetworkDetailsTableType.tls]:{...e.details.queries[i.NetworkDetailsTableType.tls],activePage:p.a},[i.NetworkDetailsTableType.users]:{...e.details.queries[i.NetworkDetailsTableType.users],activePage:p.a},[i.NetworkDetailsTableType.http]:{...e.details.queries[i.NetworkDetailsTableType.http],activePage:p.a}}),g={page:{queries:{[i.NetworkTableType.topNFlowSource]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_out,direction:d.b.desc}},[i.NetworkTableType.topNFlowDestination]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_in,direction:d.b.desc}},[i.NetworkTableType.dns]:{activePage:p.a,limit:p.b,sort:{field:d.m.uniqueDomains,direction:d.b.desc},isPtrIncluded:!1},[i.NetworkTableType.http]:{activePage:p.a,limit:p.b,sort:{direction:d.b.desc}},[i.NetworkTableType.tls]:{activePage:p.a,limit:p.b,sort:{field:d.p._id,direction:d.b.desc}},[i.NetworkTableType.topCountriesSource]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_out,direction:d.b.desc}},[i.NetworkTableType.topCountriesDestination]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_in,direction:d.b.desc}},[i.NetworkTableType.alerts]:{activePage:p.a,limit:p.b},[i.NetworkTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}}},details:{queries:{[i.NetworkDetailsTableType.http]:{activePage:p.a,limit:p.b,sort:{direction:d.b.desc}},[i.NetworkDetailsTableType.topCountriesSource]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_out,direction:d.b.desc}},[i.NetworkDetailsTableType.topCountriesDestination]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_in,direction:d.b.desc}},[i.NetworkDetailsTableType.topNFlowSource]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_out,direction:d.b.desc}},[i.NetworkDetailsTableType.topNFlowDestination]:{activePage:p.a,limit:p.b,sort:{field:d.q.bytes_in,direction:d.b.desc}},[i.NetworkDetailsTableType.tls]:{activePage:p.a,limit:p.b,sort:{field:d.p._id,direction:d.b.desc}},[i.NetworkDetailsTableType.users]:{activePage:p.a,limit:p.b,sort:{field:d.r.name,direction:d.b.asc}},[i.NetworkDetailsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}},flowTarget:d.f.source}},f=Object(c.reducerWithInitialState)(g).case(r.updateNetworkTable,((e,{networkType:t,tableType:a,updates:n})=>({...e,[t]:{...e[t],queries:{...e[t].queries,[a]:{...Object(s.get)([t,"queries",a],e),...n}}}}))).case(r.setNetworkTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:m(e)},details:{...e.details,queries:y(e)}}))).case(r.setNetworkDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:y(e)}}))).case(r.updateNetworkAnomaliesJobIdFilter,((e,{jobIds:t,networkType:a})=>a===i.NetworkType.page?Object(u.set)("page.queries.anomalies.jobIdSelection",t,e):Object(u.set)("details.queries.anomalies.jobIdSelection",t,e))).case(r.updateNetworkAnomaliesInterval,((e,{interval:t,networkType:a})=>a===i.NetworkType.page?Object(u.set)("page.queries.anomalies.intervalSelection",t,e):Object(u.set)("details.queries.anomalies.intervalSelection",t,e))).build(),b=(e,t)=>Object(s.get)(t,e.network),h=e=>e.network.page,v=e=>e.network.details,E=()=>Object(o.createSelector)(h,(e=>e.queries.dns)),x=(e,t,a)=>{const n=a===l.b.source?"topNFlowSource":"topNFlowDestination",r=t===i.NetworkType.page?i.NetworkTableType[n]:i.NetworkDetailsTableType[n];return Object(s.get)([t,"queries",r],e.network)||Object(s.get)([t,"queries",r],g)},k=()=>Object(o.createSelector)(x,(e=>e)),w=(e,t)=>{const a=t===i.NetworkType.page?i.NetworkTableType.tls:i.NetworkDetailsTableType.tls;return Object(s.get)([t,"queries",a],e.network)||Object(s.get)([t,"queries",a],g)},S=()=>Object(o.createSelector)(w,(e=>e)),j=(e,t,a)=>{const n=a===l.b.source?"topCountriesSource":"topCountriesDestination",r=t===i.NetworkType.page?i.NetworkTableType[n]:i.NetworkDetailsTableType[n];return Object(s.get)([t,"queries",r],e.network)||Object(s.get)([t,"queries",r],g)},O=()=>Object(o.createSelector)(j,(e=>e)),I=(e,t)=>{const a=t===i.NetworkType.page?i.NetworkTableType.http:i.NetworkDetailsTableType.http;return Object(s.get)([t,"queries",a],e.network)||Object(s.get)([t,"queries",a],g)},C=()=>Object(o.createSelector)(I,(e=>e)),T=()=>Object(o.createSelector)(v,(e=>e.queries.users)),M=()=>Object(o.createSelector)(b,(e=>e.queries[i.NetworkTableType.anomalies].jobIdSelection)),_=()=>Object(o.createSelector)(b,(e=>e.queries[i.NetworkTableType.anomalies].intervalSelection))},405:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n=400,r=null},441:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return k})),a.d(t,"c",(function(){return j}));var n=a(1532),r=a(2083),i=a(3),o=a(55),s=a(797);const l=Object(n.a)((e=>(({data:e,defaultIndex:t,eventFields:a,filterQuery:n,timerange:r,signal:i})=>e.search.search({defaultIndex:t,eventFields:a,factoryQueryType:s.a.eventEnrichment,filterQuery:n,timerange:r},{strategy:"securitySolutionSearchStrategy",abortSignal:i}))(e).pipe(Object(i.filter)((e=>!Object(o.isRunningResponse)(e)))))),c=()=>Object(r.a)(l);var u=a(2),d=a(45),p=a(7),m=a(271),y=a.n(m),g=a(138),f=a(195),b=a(123),h=a(118),v=a(200);const E=a(4).i18n.translate("xpack.securitySolution.investigationEnrichment.requestError",{defaultMessage:"An error occurred while requesting threat intelligence"});var x=a(5);const k="investigation_time_enrichment",w=()=>{},S={enrichments:[]},j=e=>{const{addError:t}=Object(b.a)(),{data:a,uiSettings:n}=Object(h.j)().services,r=n.get(x.bb),i=Object(d.useDispatch)(),[o,s]=Object(u.useState)({from:f.a,to:f.b}),{error:l,loading:m,result:j,start:O}=c(),I=Object(u.useCallback)((()=>{i(v.c.deleteOneQuery({inputId:g.a.global,id:k}))}),[i]);Object(u.useEffect)((()=>(!m&&j&&i(v.c.setQuery({inputId:g.a.global,id:k,inspect:{dsl:j.inspect.dsl,response:[JSON.stringify(j.rawResponse,null,2)]},loading:m,refetch:w})),I)),[I,i,m,j]),Object(u.useEffect)((()=>{l&&t(l,{title:E})}),[t,l]);const C=y()(e),T=y()(o);return Object(u.useEffect)((()=>{Object(p.isEmpty)(e)||Object(p.isEqual)(e,C)&&Object(p.isEqual)(o,T)||O({data:a,timerange:{...o,interval:""},defaultIndex:r,eventFields:e,filterQuery:""})}),[O,a,e,C,o,T,r]),{result:Object(p.isEmpty)(e)?S:j,range:o,setRange:s,loading:m}}},451:function(e,t,a){"use strict";var n=a(259);a.d(t,"f",(function(){return n.f})),a.d(t,"e",(function(){return n.e})),a.d(t,"d",(function(){return n.d})),a.d(t,"c",(function(){return n.c})),a.d(t,"b",(function(){return n.b}));var r=a(245);a.d(t,"a",(function(){return r.b}))},483:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.userProfiles.fetchCurrentUserProfile.failure",{defaultMessage:"Failed to find current user"}),i=n.i18n.translate("xpack.securitySolution.userProfiles.fetchUserProfiles.failure",{defaultMessage:"Failed to find users"}),o=n.i18n.translate("xpack.securitySolution.userProfiles.unknownUser.displayName",{defaultMessage:"Unknown"})},484:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={OVERVIEW_TAB_EXPANDED_SECTIONS:"securitySolution.documentDetailsFlyout.overviewSectionExpanded.v8.14",RIGHT_PANEL_SELECTED_TABS:"securitySolution.documentDetailsFlyout.rightPanel.selectedTabs.v8.14"}},486:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return l}));const n="network.bytes",r="network.community_id",i="network.direction",o="network.packets",s="network.protocol",l="network.transport"},487:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a.n(n),i=a(19),o=a(126);const s=Object(n.memo)((({title:e,body:t,confirmButton:a,cancelButton:n,onCancel:s,onSuccess:l,"data-test-subj":c})=>{const u=Object(o.a)(c);return r.a.createElement(i.EuiModal,{onClose:s,"data-test-subj":c},r.a.createElement(i.EuiModalHeader,{"data-test-subj":u("header")},r.a.createElement(i.EuiModalHeaderTitle,null,e)),r.a.createElement(i.EuiModalBody,{"data-test-subj":u("body")},r.a.createElement(i.EuiText,null,r.a.createElement("p",null,t))),r.a.createElement(i.EuiModalFooter,null,r.a.createElement(i.EuiButtonEmpty,{onClick:s,"data-test-subj":u("cancelButton")},n),r.a.createElement(i.EuiButton,{fill:!0,onClick:l,"data-test-subj":u("submitButton")},a)))}));s.displayName="ArtifactConfirmModal"},502:function(e,t,a){"use strict";a.d(t,"d",(function(){return b})),a.d(t,"e",(function(){return h})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(19),r=a(2),i=a.n(r),o=a(42),s=a(332),l=a(620),c=a(203),u=a(4);const d=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.notSupportedTooltip",{defaultMessage:"Add the Elastic Defend integration via Elastic Agent to enable this feature"}),p=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.unenrolledTooltip",{defaultMessage:"Host is no longer enrolled with the Elastic Defend integration"}),m=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.loadingTooltip",{defaultMessage:"Loading"}),y=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.generalMetadataErrorTooltip",{defaultMessage:"Failed to retrieve Endpoint metadata"}),g=(e,t=!0)=>{const{data:a,isFetching:n,error:i}=Object(l.c)(e,{enabled:t});return Object(r.useMemo)((()=>{var e,r,o,s,l,u;const g={isDisabled:!1,tooltip:void 0,capabilities:[],hostName:"",platform:""};return t?n?(g.isDisabled=!0,g.tooltip=m,g):i&&404===(null===(e=i.body)||void 0===e?void 0:e.statusCode)?(g.isDisabled=!0,g.tooltip=d,g):i&&400===(null===(r=i.body)||void 0===r?void 0:r.statusCode)&&null!==(o=i.body)&&void 0!==o&&o.message.includes("unenrolled")||(null==a?void 0:a.host_status)===c.d.UNENROLLED?(g.isDisabled=!0,g.tooltip=p,g):(i&&(g.isDisabled=!0,g.tooltip=y),g.capabilities=null!==(s=null==a?void 0:a.metadata.Endpoint.capabilities)&&void 0!==s?s:[],g.hostName=null!==(l=null==a?void 0:a.metadata.host.name)&&void 0!==l?l:"",g.platform=null!==(u=null==a?void 0:a.metadata.host.os.name.toLowerCase())&&void 0!==u?u:"",g):(g.isDisabled=!0,g)}),[t,n,i,null==a?void 0:a.host_status,null==a?void 0:a.metadata.Endpoint.capabilities,null==a?void 0:a.metadata.host.name,null==a?void 0:a.metadata.host.os.name])};var f=a(140);const b=Object(r.memo)((({agentType:e,agentId:t})=>{const{handleResponseActionsClick:a,isDisabled:s,tooltip:c}=(({onClick:e,agentId:t,agentType:a})=>{const n="endpoint"===a,i=Object(l.d)(),{tooltip:o,isDisabled:s,capabilities:c,hostName:u,platform:p}=g(t,n),m=Object(r.useCallback)((()=>{s||(i({agentId:t,agentType:a,hostName:u,platform:p,capabilities:n?c:[]}),e&&e())}),[s,i,t,a,u,p,n,c,e]);return Object(r.useMemo)((()=>({isDisabled:!n||s,tooltip:n?o:d,handleResponseActionsClick:m})),[m,s,n,o])})({agentType:e,agentId:t});if(!Object(f.a)().endpointPrivileges.canAccessResponseConsole)return null;const u="endpointResponseActions-action-button";return i.a.createElement(n.EuiToolTip,{position:"top",content:c},i.a.createElement(n.EuiButton,{fill:!0,key:u,"data-test-subj":u,disabled:s,onClick:a},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"})))}));b.displayName="ResponderActionButton";const h=(e,t)=>{const{loading:a,canAccessResponseConsole:n}=Object(f.a)().endpointPrivileges,{isAlert:c}=Object(s.a)(e),{handleResponseActionsClick:u,isDisabled:p,tooltip:m}=(({eventData:e=[],onClick:t})=>{const{isSupported:a,unsupportedReason:n,details:{agentType:i,agentId:o,platform:c,hostName:u}}=Object(s.a)(e),p="endpoint"===i,m=g(o,a&&p),y=Object(l.d)(),[f,b]=Object(r.useMemo)((()=>a?p?[m.isDisabled,m.tooltip]:[!1,void 0]:[!0,i&&n?n:d]),[a,p,i,n,m.isDisabled,m.tooltip]);return{handleResponseActionsClick:Object(r.useCallback)((()=>{f||(y({agentId:o,agentType:i,hostName:u,platform:c,capabilities:p?m.capabilities:[]}),t&&t())}),[f,y,o,i,u,c,p,m.capabilities,t]),isDisabled:f,tooltip:b}})({onClick:t,eventData:e});return Object(r.useMemo)((()=>{const e=[];return!a&&n&&c&&e.push({key:"endpointResponseActions-action-item","data-test-subj":"endpointResponseActions-action-item",disabled:p,toolTipContent:m,size:"s",onClick:u,name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"})}),e}),[n,u,c,a,p,m])}},521:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(42),o=a(137);const s=({riskScoreEntity:e,title:t})=>r.a.createElement(r.a.Fragment,null,null!=t?t:e===o.t.user?r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.usersRiskDashboard.title",defaultMessage:"User Risk Scores"}):r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.hostsRiskDashboard.title",defaultMessage:"Host Risk Scores"})),l=r.a.memo(s);l.displayName="RiskScoreHeaderTitle"},522:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"f",(function(){return p}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.timeline.categoryTooltip",{defaultMessage:"Category"}),i=n.i18n.translate("xpack.securitySolution.timeline.descriptionTooltip",{defaultMessage:"Description"}),o=n.i18n.translate("xpack.securitySolution.timeline.fieldTooltip",{defaultMessage:"Field"}),s=n.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),l=n.i18n.translate("xpack.securitySolution.timeline.hideColumnLabel",{defaultMessage:"Hide column"}),c=n.i18n.translate("xpack.securitySolution.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),u=n.i18n.translate("xpack.securitySolution.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),d=n.i18n.translate("xpack.securitySolution.timeline.typeTooltip",{defaultMessage:"Type"}),p=n.i18n.translate("xpack.securitySolution.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})},539:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(47),r=a(118),i=a(277);function o({documentId:e,isActiveTimeline:t,indices:a}){const o=Object(r.i)(),{selectedPatterns:s}=Object(i.a)(t),l=[...new Set(s.concat(a))],{loading:c,id:u,schema:d,agentId:p}=function({documentId:e,indices:t}){const a=Object(r.i)(),i=Object(n.useQuery)(["getAlertPrevalenceSchema",e],(()=>a.get("/api/endpoint/resolver/entity",{query:{_id:e,indices:t}})));if(i.isLoading)return{loading:!0,error:!1,id:null,schema:null,agentId:null};if(i.data&&i.data.length>0){const{data:[{schema:e,id:t,agentId:a}]}=i;return{loading:!1,error:!1,id:t,schema:e,agentId:a}}return{loading:!1,error:!0,id:null,schema:null,agentId:null}}({documentId:e,indices:l}),m=Object(n.useQuery)(["getAlertPrevalenceFromProcessTree",u],(()=>o.post("/api/endpoint/resolver/tree",{body:JSON.stringify({schema:d,ancestors:200,descendants:500,indexPatterns:l,nodes:[u],includeHits:!0,agentId:p})})),{enabled:null!==d&&null!==u});return m.isLoading||c?{loading:!0,error:!1,alertIds:void 0,statsNodes:void 0}:m.data?{loading:!1,error:!1,alertIds:m.data.alertIds,statsNodes:m.data.statsNodes}:{loading:!1,error:!0,alertIds:void 0,statsNodes:void 0}}},540:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(350);const r=e=>Object(n.a)(e)},541:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(44),i=a(122);const o=e=>{const t=Object(i.a)("sentinelOneDataInAnalyzerEnabled"),a=Object(i.a)("crowdstrikeDataInAnalyzerEnabled"),o=Object(i.a)("jamfDataInAnalyzerEnabled");return Object(n.useMemo)((()=>{const n=[...t?["sentinel_one_cloud_funnel","sentinel_one"]:[],...a?["crowdstrike"]:[],...o?["jamf_protect"]:[]],i=Object(r.get)(["agent","type",0],e),s=Object(r.get)(["process","entity_id"],e),l=Object(r.get)(["process","entity_id",0],e),c=Object(r.get)(["event","module",0],e),u=Object(r.get)(["event","dataset"],e),d=Array.isArray(u)&&u.some((e=>e.includes("windows.sysmon"))),p="endpoint"===i,m="winlogbeat"===i&&"sysmon"===c,y="filebeat"===i&&n.includes(c),g=p||m||d||y,f=null!=s&&1===s.length&&""!==l;return g&&f}),[a,e,t,o])}},542:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(41),c=a.n(l),u=a(482),d=a(126);const p=c()(s.EuiContextMenuItem).withConfig({displayName:"StyledEuiContextMenuItem",componentId:"sc-t3r55d-0"})([".additional-info{display:none;max-width:50%;}&:hover{.additional-info{display:block !important;}}"]),m=c()("div").withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-t3r55d-1"})(["max-width:50%;padding-right:",";"],(e=>e.theme.eui.euiSizeS)),y=c()(s.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-t3r55d-2"})(["padding:",";line-height:",";"],(e=>e.theme.eui.euiSizeM),(e=>e.theme.eui.euiFontSizeM)),g=Object(i.memo)((({navigateAppId:e,navigateOptions:t,onClick:a,textTruncate:n,hoverInfo:l,children:c,isNavigationDisabled:g=!1,...f})=>{const b=Object(u.a)(null!=e?e:"",{...t,onClick:a}),h=Object(d.a)(f["data-test-subj"]),v=Object(i.useMemo)((()=>{const e="additional-info "+("object"!=typeof l?"eui-textTruncate":"");return l?o.a.createElement(m,{className:e},l):null}),[l]),E=n?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",r()({className:"eui-textTruncate","data-test-subj":h("truncateWrapper")},"string"==typeof c?{title:c}:{}),c),v):o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiFlexItem,null,c),v);return g?o.a.createElement(y,{size:"s",className:"eui-textTruncate","data-test-subj":f["data-test-subj"]},E):o.a.createElement(p,r()({},f,{onClick:e?b:a}),o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},E))}));g.displayName="EuiContextMenuItemNavByRouter"},543:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return p}));var n=a(47),r=a(3),i=a(167),o=a(118),s=a(182),l=a(544),c=a(935);function u({onError:e,page:t,perPage:a}={page:1,perPage:s.c}){const r=Object(o.i)();return Object(n.useQuery)(["endpointSpecificPolicies",t,a],(()=>Object(c.a)(r,{query:{page:t,perPage:a,withAgentCount:!0}})),e?{onError:e}:void 0)}function d(e){const{data:t}=Object(o.j)().services;return Object(n.useQuery)(["endpointPackagePoliciesStatsStrategy"],(async()=>Object(r.firstValueFrom)(t.search.search({},{strategy:i.m}))),{select:e=>e.rawResponse,enabled:e})}function p({customQueryOptions:e}){const t=Object(o.i)();return Object(n.useQuery)(["endpointPackageVersion",e],(()=>Object(l.c)(t)),e)}},544:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(67);const r="/api/fleet",i=`${r}/package_policies`,o=`${r}/agent_status`,s=(e,t,a)=>e.get(`${i}/${t}`,{...a,version:n.API_VERSIONS.public.v1}),l=(e,t,a)=>e.post(`${i}/_bulk_get`,{...a,version:n.API_VERSIONS.public.v1,body:JSON.stringify({ids:t,ignoreMissing:!0})}),c=(e,t,a,r={})=>e.put(`${i}/${t}`,{...r,version:n.API_VERSIONS.public.v1,body:JSON.stringify(a)}),u=(e,t,a={})=>e.get(o,{...a,version:n.API_VERSIONS.public.v1,query:{policyId:t}}),d=async e=>{const t=n.epmRouteService.getInfoPath("endpoint"),a=(await e.get(t,{version:n.API_VERSIONS.public.v1})).item;if(!a)throw new Error("Endpoint package was not found.");return a}},546:function(e,t,a){"use strict";a.d(t,"a",(function(){return be}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(44),l=a(19),c=a(168),u=a(1334),d=a(1555),p=a(1561),m=a(4);const y=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.cancel",{defaultMessage:"Cancel"}),g=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.createRuleExceptionLabel",{defaultMessage:"Add rule exception"}),f=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.addEndpointException",{defaultMessage:"Add Endpoint Exception"}),b=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.title",{defaultMessage:"An error occured submitting exception"}),h=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.dismissButton",{defaultMessage:"Dismiss"}),v=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.message",{defaultMessage:"View toast for error details."}),E=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.success",{defaultMessage:"Rule exception added to shared exception list"}),x=m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception added"});var k=a(632),w=a(343),S=a(353);const j={initialItems:[],exceptionItems:[],exceptionItemMeta:{name:""},newComment:"",commentErrorExists:!1,itemConditionValidationErrorExists:!1,closeSingleAlert:!1,bulkCloseAlerts:!1,disableBulkClose:!1,bulkCloseIndex:void 0,selectedOs:void 0,exceptionListsToAddTo:[],addExceptionToRadioSelection:"add_to_rule",selectedRulesToAddTo:[],listType:u.a.RULE_DEFAULT,errorSubmitting:null,expireTime:void 0,expireErrorExists:!1,wildcardWarningExists:!1};var O=a(878),I=a(879),C=a(840),T=a(871);const M=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addExceptionToRuleOrList.addToListsLabel",{defaultMessage:"Add to rule or lists"});var _=a(42),N=a(868);const D=({possibleRules:e,isSingleRule:t,isBulkAction:a,selectedRadioOption:i,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(n.useMemo)((()=>a&&null!=e?{id:"add_to_rules",label:r.a.createElement(l.EuiText,{"data-test-subj":"addToRulesRadioOption"},r.a.createElement(_.FormattedMessage,{defaultMessage:"Add to [{numRules}] selected rules: {ruleNames}",id:"xpack.securitySolution.exceptions.common.addToRulesOptionLabel",values:{numRules:e.length,ruleNames:r.a.createElement("span",{style:{fontWeight:"bold"}},e.map((({name:e})=>e)).join(","))}})),checked:"add_to_rules"===i,"data-test-subj":"addToRulesOptionsRadio",onChange:()=>{s("add_to_rules"),o(e)}}:t&&null!=e?{id:"add_to_rule",label:r.a.createElement(l.EuiText,{"data-test-subj":"addToRuleRadioOption"},r.a.createElement(_.FormattedMessage,{defaultMessage:"Add to this rule: {ruleName}",id:"xpack.securitySolution.exceptions.common.addToRuleOptionLabel",values:{ruleName:r.a.createElement("span",{style:{fontWeight:"bold"}},e[0].name)}})),checked:"add_to_rule"===i,"data-test-subj":"addToRuleOptionsRadio",onChange:()=>{s("add_to_rule"),o(e)}}:{id:"select_rules_to_add_to",label:r.a.createElement(l.EuiText,{"data-test-subj":"selectRulesToAddToRadioOption"},r.a.createElement(_.FormattedMessage,{defaultMessage:"Add to rules",id:"xpack.securitySolution.exceptions.common.selectRulesOptionLabel"})),checked:"select_rules_to_add_to"===i,"data-test-subj":"selectRulesToAddToOptionRadio",onChange:()=>s("select_rules_to_add_to")}),[a,e,t,i,s,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiRadio,c),"select_rules_to_add_to"===i&&r.a.createElement(N.a,{onRuleSelectionChange:o,initiallySelectedRules:[]}))},A=r.a.memo(D);A.displayName="ExceptionsAddToRulesOptions";const F=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsOptionLabel",{defaultMessage:"Add to shared exception lists"}),q=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.gotToSharedExceptions",{defaultMessage:"Manage shared exception lists"}),L=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltip",{defaultMessage:"Shared exception list is a group of exceptions. Select this option if you’d like to add this exception to shared exception lists."}),R=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipAriaLabel",{defaultMessage:"Learn more about shared exception lists"}),P=e=>m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipTitle",{values:{rulesCount:e},defaultMessage:"Shared exception list is a group of exceptions shared across rules. {rulesCount, plural, =1 {This rule currently has no shared} other {These rules currently have no commonly shared}} exception lists attached. To create one, visit the Shared Exception Lists page."});var z=a(627);const B=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.addToListsDescription",{defaultMessage:"After you create the exception, it is added to the exception lists you select."}),$=(m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.viewListDetailActionLabel",{defaultMessage:"View list detail"}),m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.referencesFetchError",{defaultMessage:"Unable to load shared exception lists"}));var G=a(595);const U=e=>m.i18n.translate("xpack.securitySolution.rule_exceptions.addToListTable.linkListSwitch.ariaLabel",{values:{name:e},defaultMessage:'Link "{name}"'}),V=Object(n.memo)((({list:e,linkedList:t,onListLinkChange:a,dataTestSubj:i})=>{const o=Object(n.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(n.useCallback)((({target:{checked:n}})=>{const r=n?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof a&&a(r)}),[t,a,e]);return r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiSwitch,{"data-test-subj":i,onChange:s,checked:o,label:U(e.name),showLabel:!1}))}));V.displayName="LinkListSwitch";var H=a(354);const W=({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a})=>{const{error:i,isLoading:o,pagination:s,lists:c,listTableColumnsWithLinkSwitch:d,onTableChange:p,addToSelectedListDescription:m}=(({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a})=>{const[i,o]=Object(n.useState)([]),[s,l]=Object(n.useState)(!1),c=Object(n.useMemo)((()=>e?[]:t),[e,t]),[d,p]=Object(n.useState)([]),[m,y]=Object(n.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[g,f]=Object(n.useState)(void 0),b=Object(n.useCallback)((async()=>{try{return l(!0),Object(z.c)(c.length?c:[{namespace_type:"single"}])}catch(e){f($)}}),[c]),h=Object(n.useCallback)((async()=>{const e=await b();if(!e)return l(!1);const t=[];for(const a of Object.values(e))a.type===u.a.DETECTION&&t.push(a);o(t),l(!1)}),[b]);Object(n.useEffect)((()=>{h()}),[c,b,h]),Object(n.useEffect)((()=>{a(d.map((({referenced_rules:e,namespace_type:t,os_types:a,tags:n,...r})=>({...r,namespace_type:null!=t?t:"single",os_types:null!=a?a:[],tags:null!=n?n:[]}))))}),[d,a]);const v=Object(n.useMemo)((()=>[{field:"link",name:G.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>r.a.createElement(V,{dataTestSubj:"addToSharedListSwitch",list:t,linkedList:d,onListLinkChange:p})},...Object(H.d)()]),[d]),E=Object(n.useCallback)((({page:{index:e}})=>y({...m,pageIndex:e})),[m]);return{error:g,isLoading:s,pagination:m,lists:i,listTableColumnsWithLinkSwitch:v,addToSelectedListDescription:B,onTableChange:E}})({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a});return r.a.createElement(l.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiText,{size:"s"},m),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{sorting:!0,tableLayout:"auto",tableCaption:"Table of exception lists","data-test-subj":"addExceptionToSharedListsTable",error:i,items:c,loading:o,message:o?r.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,columns:d,pagination:s,onTableChange:p})))},Y=r.a.memo(W);Y.displayName="ExceptionsAddToListsTable";var Z=a(118);const K=({rulesCount:e,selectedRadioOption:t,sharedLists:a,onListsSelectionChange:i,onRadioChange:o})=>{const{navigateToApp:s}=Object(Z.j)().services.application,[c,u]=Object(n.useState)(!1);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiRadio,{id:"add_to_lists",label:r.a.createElement(l.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",responsive:!1,"data-test-subj":"addToListsRadioOptionLabel"},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiText,null,F)),r.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":"addToListsOption"},r.a.createElement(l.EuiPopover,{button:r.a.createElement(l.EuiButtonIcon,{iconType:"iInCircle",onClick:()=>u(!c),"aria-label":R}),isOpen:c,closePopover:()=>u(!1),anchorPosition:"upCenter"},r.a.createElement("div",{style:{width:"300px"}},r.a.createElement(l.EuiText,{size:"s"},0===a.length?P(e):L)),r.a.createElement(l.EuiPopoverFooter,null,r.a.createElement(l.EuiButtonEmpty,{size:"s",iconType:"popout",iconSide:"right",onClick:()=>s("security",{openInNewTab:!0,path:"/exceptions"})},q))))),checked:"add_to_lists"===t,disabled:0===a.length&&e>0,onChange:()=>o("add_to_lists"),"data-test-subj":"addToListsRadioOption"}),"add_to_lists"===t&&(a.length>0||0===e)&&r.a.createElement(Y,{showAllSharedLists:0===e,sharedExceptionLists:a,onListSelectionChange:i,"data-test-subj":"exceptionsAddToListTable"}))},Q=r.a.memo(K);Q.displayName="ExceptionsAddToListsOptions";const X=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-oec11w-0"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),J=({rules:e,isBulkAction:t,selectedRadioOption:a,onListSelectionChange:i,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(n.useMemo)((()=>null!=e&&1===e.length),[e]),d=Object(n.useMemo)((()=>{var t,a,n;if(null==e)return[];if(1===e.length)return null!==(t=null===(a=e[0].exceptions_list)||void 0===a?void 0:a.filter((e=>e.type===u.a.DETECTION)))&&void 0!==t?t:[];const r=null!==(n=null==e?void 0:e.map((e=>null!=e.exceptions_list?e.exceptions_list:[])))&&void 0!==n?n:[];r.sort(((e,t)=>e.length-t.length));const i=r.shift();return null!=i&&i.length?i.filter((e=>r.every((t=>t.some((({id:t})=>e.id===t)))))).filter((e=>e.type===u.a.DETECTION)):[]}),[e]),p=Object(n.useMemo)((()=>null!=e?e.length:0),[e]);return r.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemAddToRuleOrListSection"},r.a.createElement(X,{size:"xs"},r.a.createElement("h3",null,M)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(A,{possibleRules:e,isSingleRule:c,isBulkAction:t,selectedRadioOption:a,onRuleSelectionChange:o,onRadioChange:s}),r.a.createElement(Q,{rulesCount:p,selectedRadioOption:a,sharedLists:d,onListsSelectionChange:i,onRadioChange:s}))},ee=r.a.memo(J);ee.displayName="ExceptionsAddToRulesOrLists";var te=a(1447),ae=a(1328),ne=a(1556),re=a(123),ie=a(841),oe=a(159);var se=a(872);const le=["query","machine_learning","saved_query","threat_match"];var ce=a(588),ue=a(880),de=a(237),pe=a(487);const me=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-v0j9bz-0"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),ye=o()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-v0j9bz-1"})(["",""],(()=>Object(i.css)(["&.builder-section{overflow-y:scroll;}"]))),ge=o()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-v0j9bz-2"})(["",""],(({theme:e})=>Object(i.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),fe=o()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-v0j9bz-3"})(["",""],(({theme:e})=>Object(i.css)(["padding:",";"],e.eui.euiSizeS))),be=Object(n.memo)((function({rules:e,isBulkAction:t,isEndpointItem:a,alertData:i,showAlertCloseOptions:o,isAlertDataLoading:M,alertStatus:_,sharedListToAddTo:N,onCancel:D,onConfirm:A}){const{euiTheme:F}=Object(l.useEuiTheme)(),[q,L]=Object(n.useState)(!1),{isLoading:R,indexPatterns:P,getExtendedFields:z}=Object(C.a)(e),[B,$]=(()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(re.a)(),[r,i]=(()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useRef)(null);return Object(n.useEffect)((()=>{const e=new AbortController;return a.current=async(a,n)=>{try{t(!0);const r=await Promise.all(n.map((async t=>Object(oe.a)({items:a,ruleId:t.id,signal:e.signal}))));return t(!1),r.flatMap((e=>e))}catch(e){throw t(!1),e}},()=>{t(!1),e.abort()}}),[]),[e,a.current]})(),[o,s]=Object(ie.a)(),[l,c]=Object(n.useState)(!1),d=Object(n.useRef)(null),p=Object(n.useCallback)((e=>e.every((e=>te.a.is(e)))),[]),y=Object(n.useCallback)((e=>e.every((e=>ae.a.is(e)||ne.a.is(e)))),[]);return Object(n.useEffect)((()=>{const a=new AbortController;return d.current=async({itemsToAdd:a,listType:n,selectedRulesToAddTo:r,addToRules:o,addToSharedLists:l,sharedLists:d})=>{try{let t=[];if(c(!0),o&&null!=i&&n!==u.a.ENDPOINT&&p(a)){t=await i(a,r);const n=r.map((({name:e})=>e)).join(", ");e({title:x,text:(f=n,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessText",{values:{ruleName:f},defaultMessage:"Exception has been added to rules - {ruleName}."}))})}else if((n===u.a.ENDPOINT||l)&&null!=s&&y(a)){t=await s(a);const n=d.map((({name:e})=>e));e({title:E,text:(g=n.join(","),m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.closeAlerts.successDetails",{values:{listNames:g},defaultMessage:"Rule exception has been added to shared lists: {listNames}."}))})}return c(!1),t}catch(e){throw c(!1),t(e,{title:b}),e}var g,f},()=>{a.abort()}}),[e,t,a,i,s,p,y]),[l||o||r,d.current]})(),[G,U]=Object(se.a)(),V=Object(ce.b)(),W=Object(n.useMemo)((()=>null==e||1!==e.length||le.includes(e[0].type)),[e]),Y=Object(n.useMemo)((()=>t?"add_to_rules":1===(null==e?void 0:e.length)||void 0!==M?"add_to_rule":"select_rules_to_add_to"),[M,t,e]),Z=Object(n.useMemo)((()=>a?u.a.ENDPOINT:N?u.a.DETECTION:u.a.RULE_DEFAULT),[a,N]),[{exceptionItemMeta:{name:K},listType:Q,selectedOs:X,initialItems:J,exceptionItems:be,disableBulkClose:he,bulkCloseAlerts:ve,closeSingleAlert:Ee,bulkCloseIndex:xe,addExceptionToRadioSelection:ke,selectedRulesToAddTo:we,exceptionListsToAddTo:Se,newComment:je,commentErrorExists:Oe,itemConditionValidationErrorExists:Ie,errorSubmitting:Ce,expireTime:Te,expireErrorExists:Me,wildcardWarningExists:_e},Ne]=Object(n.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:a}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[a[0]]:a[1]}}}case"setInitialExceptionItems":{const{items:a}=t;return{...e,initialItems:a}}case"setExceptionItems":{const{items:a}=t;return{...e,exceptionItems:a}}case"setConditionValidationErrorExists":{const{errorExists:a}=t;return{...e,itemConditionValidationErrorExists:a}}case"setWildcardWithWrongOperator":{const{warningExists:a}=t;return{...e,wildcardWarningExists:a}}case"setComment":{const{comment:a}=t;return{...e,newComment:a}}case"setCommentError":{const{errorExists:a}=t;return{...e,commentErrorExists:a}}case"setCloseSingleAlert":{const{close:a}=t;return{...e,closeSingleAlert:a}}case"setBulkCloseAlerts":{const{bulkClose:a}=t;return{...e,bulkCloseAlerts:a}}case"setBulkCloseIndex":{const{bulkCloseIndex:a}=t;return{...e,bulkCloseIndex:a}}case"setSelectedOsOptions":{const{selectedOs:a}=t;return{...e,selectedOs:a}}case"setAddExceptionToLists":{const{listsToAddTo:a}=t;return{...e,exceptionListsToAddTo:a}}case"setListOrRuleRadioOption":{const{option:a}=t;return{...e,addExceptionToRadioSelection:a,listType:"add_to_lists"===a?u.a.DETECTION:u.a.RULE_DEFAULT,selectedRulesToAddTo:"add_to_lists"===a?[]:e.selectedRulesToAddTo}}case"setSelectedRulesToAddTo":{const{rules:a}=t;return{...e,selectedRulesToAddTo:a}}case"setListType":{const{listType:a}=t;return{...e,listType:a}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:a}=t;return{...e,disableBulkClose:a}}case"setErrorSubmitting":{const{err:a}=t;return{...e,errorSubmitting:a}}case"setExpireTime":{const{expireTime:a}=t;return{...e,expireTime:a}}case"setExpireError":{const{errorExists:a}=t;return{...e,expireErrorExists:a}}default:return e}}),{...j,addExceptionToRadioSelection:Y,listType:Z,selectedRulesToAddTo:null!=e?e:[]}),De=Object(n.useMemo)((()=>null!=i),[i]),Ae=Object(n.useCallback)((e=>{Ne({type:"setInitialExceptionItems",items:e})}),[Ne]),Fe=Object(n.useCallback)((e=>{Ne({type:"setWildcardWithWrongOperator",warningExists:Object(d.g)(e)}),Ne({type:"setExceptionItems",items:e})}),[Ne]),qe=Object(n.useCallback)((e=>{Ne({type:"setListOrRuleRadioOption",option:e})}),[Ne]),Le=Object(n.useCallback)((e=>{Ne({type:"setSelectedRulesToAddTo",rules:e})}),[Ne]),Re=Object(n.useCallback)((e=>{Ne({type:"setAddExceptionToLists",listsToAddTo:e})}),[Ne]),Pe=Object(n.useCallback)((e=>{Ne({type:"setExceptionItemMeta",value:e})}),[Ne]),ze=Object(n.useCallback)((e=>{Ne({type:"setConditionValidationErrorExists",errorExists:e})}),[Ne]),Be=Object(n.useCallback)((e=>{Ne({type:"setSelectedOsOptions",selectedOs:e})}),[Ne]),$e=Object(n.useCallback)((e=>{Ne({type:"setComment",comment:e})}),[Ne]),Ge=Object(n.useCallback)((e=>{Ne({type:"setCommentError",errorExists:e})}),[Ne]),Ue=Object(n.useCallback)((e=>{Ne({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[Ne]),Ve=Object(n.useCallback)((e=>{Ne({type:"setCloseSingleAlert",close:e})}),[Ne]),He=Object(n.useCallback)((e=>{Ne({type:"setBulkCloseAlerts",bulkClose:e})}),[Ne]),We=Object(n.useCallback)((e=>{Ne({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[Ne]),Ye=Object(n.useCallback)((e=>{Ne({type:"setErrorSubmitting",err:e})}),[Ne]),Ze=Object(n.useCallback)((e=>{Ne({type:"setExpireTime",expireTime:e})}),[Ne]),Ke=Object(n.useCallback)((e=>{Ne({type:"setExpireError",errorExists:e})}),[Ne]);Object(n.useEffect)((()=>{if(i)switch(Q){case u.a.ENDPOINT:return Ae(Object(w.b)(c.k,K,i));case u.a.RULE_DEFAULT:{var t,a,n;const o=Object(w.k)({alertData:i,exceptionItemName:K,ruleCustomHighlightedFields:null!==(t=null==e||null===(a=e[0])||void 0===a||null===(n=a.investigation_fields)||void 0===n?void 0:n.field_names)&&void 0!==t?t:[]});if(o)return $e((r=i._id,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionFromAlertComment",{values:{alertId:r},defaultMessage:"Exception conditions are pre-filled with relevant data from an alert with the alert id (_id): {alertId}."}))),Ae([o])}}var r}),[Q,K,i,e,Ae,$e]);const Qe=Object(n.useMemo)((()=>De?Object(w.n)(i):X?[...X]:[]),[De,i,X]),Xe=Object(n.useCallback)((async()=>{if(null!=$)try{const t=["add_to_rule","add_to_rules","select_rules_to_add_to"].includes(ke),a=!(null==N||!N.length)||"add_to_lists"===ke&&!Object(s.isEmpty)(Se),n=null!=N&&N.length?N:Se,r=Object(H.b)({itemName:K,commentToAdd:je,addToRules:t,addToSharedLists:a,sharedLists:n,listType:Q,selectedOs:Qe,expireTime:Te,items:be}),o=await $({itemsToAdd:r,selectedRulesToAddTo:we,listType:Q,addToRules:t&&!Object(s.isEmpty)(we),addToSharedLists:a,sharedLists:n}),l=Ee&&i?i._id:void 0,c=t?we.map((({rule_id:e})=>e)):(null!=e?e:[]).map((({rule_id:e})=>e));null==U||Object(s.isEmpty)(c)||!ve&&!Ee||await U(c,o,l,xe),V(),A(!0,Ee,ve)}catch(e){Ye(e)}}),[N,$,ke,K,je,Se,Q,Qe,be,we,Ee,i,e,U,ve,A,xe,Ye,V,Te]),Je=Object(n.useCallback)((()=>{if(!_e)return Xe();L(!0)}),[_e,Xe]),et=Object(n.useMemo)((()=>B||G||null!=Ce||""===K.trim()||be.every((e=>0===e.entries.length))||Ie||Oe||Me||"add_to_lists"===ke&&Object(s.isEmpty)(Se)||"select_rules_to_add_to"===ke&&Object(s.isEmpty)(we)&&Q===u.a.RULE_DEFAULT),[B,G,Ce,K,be,Ie,ke,Se,Me,we,Q,Oe]),tt=Object(n.useCallback)((()=>{Ye(null)}),[Ye]),at=Object(n.useCallback)((()=>{D(!1)}),[D]),nt=Object(n.useMemo)((()=>Q===u.a.ENDPOINT?f:g),[Q]),rt=Object(l.useGeneratedHtmlId)({prefix:"exceptionFlyoutTitle"}),it=Object(n.useMemo)((()=>{const{title:e,body:t,confirmButton:a,cancelButton:n}=Object(de.a)(Q===u.a.ENDPOINT?S.c:S.j);return r.a.createElement(pe.a,{title:e,body:t,confirmButton:a,cancelButton:n,onSuccess:Xe,onCancel:()=>L(!1),"data-test-subj":"artifactConfirmModal"})}),[Q,Xe]);return r.a.createElement(l.EuiFlyout,{size:"l",onClose:at,"data-test-subj":"addExceptionFlyout","aria-labelledby":rt,maskProps:{style:`z-index: ${F.levels.flyout+3}`}},r.a.createElement(ge,null,r.a.createElement(l.EuiTitle,null,r.a.createElement("h2",{id:rt,"data-test-subj":"exceptionFlyoutTitle"},nt)),r.a.createElement(l.EuiSpacer,{size:"m"})),r.a.createElement(ye,{className:"builder-section"},R&&r.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingAddExceptionFlyout",lines:4}),null!=Ce&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiCallOut,{"data-test-subj":"addExceptionErrorCallOut",title:b,color:"danger",iconType:"warning"},r.a.createElement(l.EuiText,null,v),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionErrorDismissButton",color:"danger",onClick:tt},h)),r.a.createElement(l.EuiSpacer,{size:"s"})),r.a.createElement(O.a,{exceptionItemName:K,onChange:Pe}),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(I.a,{exceptionItemName:K,allowLargeValueLists:W,exceptionListItems:J,exceptionListType:Q,indexPatterns:P,rules:e,selectedOs:X,showOsTypeOptions:Q===u.a.ENDPOINT&&!De,isEdit:!1,onOsChange:Be,onExceptionItemAdd:Fe,onSetErrorExists:ze,getExtendedFields:z}),_e&&r.a.createElement(p.a,null),Q!==u.a.ENDPOINT&&!(null!=N&&N.length)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(ee,{rules:e,isBulkAction:t,selectedRadioOption:ke,onListSelectionChange:Re,onRuleSelectionChange:Le,onRadioChange:qe})),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(k.a,{accordionTitle:r.a.createElement(me,{size:"xs"},r.a.createElement("h3",null,(ot=je?1:0,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.commentsTitle",{values:{comments:ot},defaultMessage:"Add comments ({comments})"})))),initialIsOpen:!!je,newCommentValue:je,newCommentOnChange:$e,setCommentError:Ge}),Q!==u.a.ENDPOINT&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(ue.a,{expireTime:Te,setExpireTime:Ze,setExpireError:Ke})),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(T.a,{exceptionListType:Q,shouldCloseSingleAlert:Ee,shouldBulkCloseAlert:ve,disableBulkClose:he,exceptionListItems:be,alertData:i,alertStatus:_,isAlertDataLoading:null!=M&&M,onDisableBulkClose:We,onUpdateBulkCloseIndex:Ue,onBulkCloseCheckboxChange:He,onSingleAlertCloseCheckboxChange:Ve}))),r.a.createElement(l.EuiFlyoutFooter,null,r.a.createElement(fe,{justifyContent:"spaceBetween"},r.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:at},y),r.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionConfirmButton",onClick:Je,isDisabled:et,fill:!0},nt))),q&&it);var ot}))},547:function(e,t,a){"use strict";a.d(t,"a",(function(){return we}));var n=a(19),r=a(2),i=a.n(r),o=a(1107),s=a(122),l=a(152),c=a(47),u=a(204),d=a(1532),p=a(1307);const m=Object(d.a)(u.o),y="FIND_LIST_ITEMS",g=()=>{const e=Object(c.useQueryClient)();return Object(r.useCallback)((()=>{e.invalidateQueries([y],{refetchType:"active"})}),[e])},f=Object(d.a)(u.s);var b=a(49),h=a(151),v=a(118),E=a(1308);const x=Object(d.a)(u.c),k=["POST","LIST_ITEM_CREATE"];var w=a(123),S=a(242),j=a(4);const O=j.i18n.translate("xpack.securitySolution.listItems.addListItem",{defaultMessage:"Create list item"}),I=j.i18n.translate("xpack.securitySolution.listItems.successfullyAddedItem",{defaultMessage:"Successfully added list item"}),C=j.i18n.translate("xpack.securitySolution.listItems.valueRequired",{defaultMessage:"Value is required"}),T=j.i18n.translate("xpack.securitySolution.listItems.valueLabel",{defaultMessage:"Enter a new value for the list"}),M=j.i18n.translate("xpack.securitySolution.listItems.addListItemButton",{defaultMessage:"Add list item"}),_=j.i18n.translate("xpack.securitySolution.listItems.addingListItemButton",{defaultMessage:"Adding..."}),N=j.i18n.translate("xpack.securitySolution.listItems.successfullyDeletedItem",{defaultMessage:"Successfully deleted list item"}),D=j.i18n.translate("xpack.securitySolution.listItems.editTextInlineLabel",{defaultMessage:"Edit text inline"}),A=j.i18n.translate("xpack.securitySolution.listItems.successfullyUpdatedListItem",{defaultMessage:"Successfully updated list item"}),F=j.i18n.translate("xpack.securitySolution.listItems.columnValue",{defaultMessage:"Value"}),q=j.i18n.translate("xpack.securitySolution.listItems.columnUpdatedAt",{defaultMessage:"Updated at"}),L=j.i18n.translate("xpack.securitySolution.listItems.columnUpdatedBy",{defaultMessage:"Updated by"}),R=j.i18n.translate("xpack.securitySolution.listItems.columnActions",{defaultMessage:"Action"}),P=j.i18n.translate("xpack.securitySolution.listItems.failedToFetchListItem",{defaultMessage:"Failed to load list items. You can change the search query or contact your administrator"}),z=j.i18n.translate("xpack.securitySolution.listItems.deleteListItem",{defaultMessage:"Delete"}),B=j.i18n.translate("xpack.securitySolution.listItems.deleteListItemDescription",{defaultMessage:"Delete list item"}),$=j.i18n.translate("xpack.securitySolution.listItems.successfullyUploadListItems",{defaultMessage:"Successfully uploaded list items"}),G=j.i18n.translate("xpack.securitySolution.listItems.failedToUploadListItem",{defaultMessage:"Failed to upload list items"}),U=j.i18n.translate("xpack.securitySolution.listItems.failedToUploadListItemTitle",{defaultMessage:"Error"}),V=j.i18n.translate("xpack.securitySolution.listItems.uploadTooltip",{defaultMessage:"All items from the file will be added to the value list."}),H=j.i18n.translate("xpack.securitySolution.listItems.uploadFilePickerInitialPromptText",{defaultMessage:"Select or drag and drop a file"}),W=j.i18n.translate("xpack.securitySolution.listItems.uploadListItem",{defaultMessage:"Upload"}),Y=j.i18n.translate("xpack.securitySolution.listItems.infoType",{defaultMessage:"Type:"}),Z=j.i18n.translate("xpack.securitySolution.listItems.infoUpdatedAt",{defaultMessage:"Updated at:"}),K=j.i18n.translate("xpack.securitySolution.listItems.infoUpdatedBy",{defaultMessage:"Updated by:"}),Q=j.i18n.translate("xpack.securitySolution.listItems.infoTotalItems",{defaultMessage:"Total items:"}),X=j.i18n.translate("xpack.securitySolution.listItems.notFoundItems",{defaultMessage:"0 list items match your search criteria."});var J=a(17);const ee=({listId:e})=>{const[t,a]=Object(r.useState)(!1),{addSuccess:o,addError:s}=Object(w.a)(),l=Object(S.c)().services.http,u=(e=>{const t=g();return Object(c.useMutation)((({listId:e,value:t,http:a})=>x({listId:e,value:t,http:a,refresh:"true"})),{...e,mutationKey:k,onSettled:(...a)=>{t(),null!=e&&e.onSettled&&e.onSettled(...a)}})})({onSuccess:()=>{o(I)},onError:e=>{var t,a;s(e,{title:e.message,toastMessage:null!==(t=null==e||null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message})}}),d=Object(E.useFormik)({initialValues:{value:""},validate:e=>{if(""===e.value.trim())return{value:C}},onSubmit:async t=>{Object(J.h)(J.a.COUNT,J.c.CREATE_VALUE_LIST_ITEM),await u.mutateAsync({listId:e,value:t.value,http:l}),a(!1),d.resetForm()}});return i.a.createElement(n.EuiPopover,{initialFocus:"#value-list-item-value",button:i.a.createElement(n.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"value-list-item-add-button-show-popover",onClick:()=>a(!0)},O),isOpen:t,closePopover:()=>a(!1)},i.a.createElement("div",{style:{width:500}},i.a.createElement(n.EuiForm,{onSubmit:d.handleSubmit,component:"form"},i.a.createElement(n.EuiFlexGroup,null,i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiFormRow,{label:T,id:"value-list-item-value",isInvalid:!!d.errors.value,error:[d.errors.value]},i.a.createElement(n.EuiFieldText,{autoComplete:"off",onChange:d.handleChange,value:d.values.value,name:"value",icon:"listAdd","data-test-subj":"value-list-item-add-input",isInvalid:!!d.errors.value}))),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiFormRow,{hasEmptyLabelSpace:!0},i.a.createElement(n.EuiButton,{"data-test-subj":"value-list-item-add-button-submit",isLoading:u.isLoading,type:"submit"},u.isLoading?_:M)))))))};var te=a(1557);const ae=["text/csv","text/plain"],ne={toastLifeTimeMs:5e3},re=l.css`
  min-width: 300px;
`,ie=({listId:e,type:t})=>{const[a,o]=Object(r.useState)(null),{http:s}=Object(v.j)().services,l=Object(r.useRef)(new AbortController),{start:c,...u}=Object(te.a)(),d=g(),{addSuccess:p,addError:m}=Object(w.a)(),y=Object(r.useCallback)((e=>{var t;o(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),f=Object(r.useCallback)((()=>{!u.loading&&a&&(l.current=new AbortController,Object(J.h)(J.a.COUNT,J.c.ADDITIONAL_UPLOAD_VALUE_LIST_ITEM),c({file:a,listId:e,http:s,signal:l.current.signal,type:t,refresh:"true"}))}),[u.loading,a,c,s,t,e]),b=!a||ae.some((e=>a.type===e));Object(r.useEffect)((()=>{!u.loading&&u.result?p($,ne):!u.loading&&u.error&&m(G,{title:U,...ne}),d()}),[u.error,u.loading,u.result,p,m,d]);const h=null==a||!b||u.loading;return i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiToolTip,{position:"bottom",content:V},i.a.createElement(n.EuiFilePicker,{className:re,accept:ae.join(),id:"value-list-item-upload",initialPromptText:H,onChange:y,display:"default",isLoading:u.loading,isInvalid:!b,"data-test-subj":"value-list-items-file-picker"})),i.a.createElement(n.EuiButton,{onClick:f,disabled:h,"data-test-subj":"value-list-items-upload"},W))},oe=Object(d.a)(u.u),se=["PATCH","LIST_ITEM_MUTATION"],le={toastLifeTimeMs:5e3},ce=({listItem:e})=>{const[t,a]=Object(r.useState)(e.value),{addSuccess:o,addError:s}=Object(w.a)(),l=Object(S.c)().services.http,u=(e=>{const t=g();return Object(c.useMutation)((({id:e,value:t,_version:a,http:n})=>oe({id:e,value:t,http:n,refresh:"true",_version:a})),{...e,mutationKey:se,onSettled:(...a)=>{t(),null!=e&&e.onSettled&&e.onSettled(...a)}})})({onSuccess:()=>{o(A,le)},onError:e=>{var t,a;s(e,{title:e.message,toastMessage:null!==(t=null==e||null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message})}}),d=Object(r.useCallback)((e=>{a(e.target.value)}),[]),p=Object(r.useCallback)((()=>{a(e.value)}),[e]),m=Object(r.useCallback)((async t=>(Object(J.h)(J.a.COUNT,J.c.EDIT_VALUE_LIST_ITEM),await u.mutateAsync({id:e.id,value:t,_version:e._version,http:l}),!0)),[e._version,e.id,u,l]);return i.a.createElement(n.EuiInlineEditText,{"data-test-subj":`value-list-item-update-${e.value}`,size:"s",inputAriaLabel:D,value:t,onChange:d,onSave:m,onCancel:p,isLoading:u.isLoading})},ue=Object(d.a)(u.g),de=["POST"," DELETE_LIST_ITEM_MUTATION"],pe={toastLifeTimeMs:5e3},me=({id:e,value:t})=>{const{addSuccess:a,addError:o}=Object(w.a)(),s=Object(v.j)().services.http,l=(e=>{const t=g();return Object(c.useMutation)((({id:e,http:t})=>ue({id:e,http:t,refresh:"true"})),{...e,mutationKey:de,onSettled:(...a)=>{t(),null!=e&&e.onSettled&&e.onSettled(...a)}})})({onSuccess:()=>{a(N,pe)},onError:e=>{var t,a;o(e,{title:e.message,toastMessage:null!==(t=null==e||null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message})}}),u=Object(r.useCallback)((()=>{Object(J.h)(J.a.COUNT,J.c.DELETE_VALUE_LIST_ITEM),l.mutate({id:e,http:s})}),[l,e,s]);return i.a.createElement(n.EuiButtonIcon,{color:"danger",onClick:u,iconType:"trash",isLoading:l.isLoading,"data-test-subj":`delete-list-item-${t}`})};let ye=function(e){return e.value="value",e.updatedAt="updated_at",e.updatedBy="updated_by",e}({});const ge=({canWriteIndex:e,items:t,pagination:a,sorting:r,loading:o,onChange:s,isError:l,list:c})=>{const u=[{field:ye.value,name:F,render:(t,a)=>e?i.a.createElement(ce,{listItem:a,key:t}):t,sortable:"text"!==c.type},{field:ye.updatedAt,name:q,render:e=>i.a.createElement(h.a,{value:e,fieldName:ye.updatedAt}),width:"25%",sortable:!0},{field:ye.updatedBy,name:L,width:"15%"}];return e&&u.push({name:R,actions:[{name:z,description:B,isPrimary:!0,render:e=>i.a.createElement(me,{id:e.id,value:e.value})}],width:"10%"}),i.a.createElement(n.EuiBasicTable,{"data-test-subj":"value-list-items-modal-table",items:t,columns:u,pagination:a,sorting:r,error:l?P:void 0,loading:o,onChange:s,noItemsMessage:X})},fe=l.css`
  margin-right: ${b.euiThemeVars.euiSizeS};
`,be=l.css`
  margin-right: ${b.euiThemeVars.euiSizeXS};
`,he=({label:e,value:t})=>i.a.createElement(n.EuiText,{size:"xs",className:fe},i.a.createElement("b",{className:be},e," ")," ",t),ve=l.css`
  overflow: hidden;
  padding: ${b.euiThemeVars.euiSize};
`,Ee=l.css`
  min-height: 90vh;
  margin-top: 5vh;
  max-width: 1400px;
  min-width: 700px;
`,xe=l.css`
  overflow: scroll;
`,ke=({listId:e,onCloseModal:t,canWriteIndex:a})=>{var o,s,l,u;const[d,g]=Object(r.useState)(""),b=Object(v.j)().services.http,[E,x]=Object(r.useState)(0),[k,w]=Object(r.useState)(10),[S,O]=Object(r.useState)("updated_at"),[I,C]=Object(r.useState)("desc"),{data:T,isLoading:M,isError:_}=(({pageIndex:e,pageSize:t,sortField:a,sortOrder:n,listId:r,filter:i,http:o})=>{const[s,l]=Object(p.a)({pageIndex:e,pageSize:t});return Object(c.useQuery)([y,e,t,a,n,r,i],(async({signal:l})=>await m({http:o,signal:l,pageIndex:e,pageSize:t,sortField:a,sortOrder:n,listId:r,cursor:s,filter:i})),{keepPreviousData:!0,refetchOnWindowFocus:!1,retry:!1,onSuccess:e=>{null!=e&&e.cursor&&l(null==e?void 0:e.cursor)}})})({listId:e,pageIndex:E+1,pageSize:k,sortField:S,sortOrder:I,filter:d,http:b}),{data:N,isLoading:D}=(({http:e,id:t})=>Object(c.useQuery)(["GET_LIST_BY_ID",t],(async({signal:a})=>await f({http:e,signal:a,id:t})),{refetchOnWindowFocus:!1}))({http:b,id:e}),A={sort:{field:S,direction:I},enableAllColumns:!1},F={pageIndex:E,pageSize:k,totalItemCount:null!==(o=null==T?void 0:T.total)&&void 0!==o?o:0,pageSizeOptions:[5,10,25]},q=Object(r.useCallback)((e=>{g(e.queryText)}),[]),L=!D&&!!N;return i.a.createElement(n.EuiModal,{maxWidth:!1,className:Ee,onClose:t},i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiModalHeader,null,L&&i.a.createElement(n.EuiFlexGroup,{justifyContent:"spaceBetween",wrap:!0},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiModalHeaderTitle,{"data-test-subj":"value-list-items-modal-title"},N.id),i.a.createElement(n.EuiSpacer,{size:"s"}),N.description&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiText,{size:"s"},N.description),i.a.createElement(n.EuiSpacer,{size:"xs"})),i.a.createElement(n.EuiFlexGroup,{"data-test-subj":"value-list-items-modal-info",justifyContent:"flexStart"},i.a.createElement(he,{label:Y,value:N.type}),i.a.createElement(he,{label:Z,value:i.a.createElement(h.a,{value:N.updated_at,fieldName:"updated_at"})}),i.a.createElement(he,{label:K,value:N.updated_by}),T&&i.a.createElement(he,{label:Q,value:null!==(s=null==T?void 0:T.total)&&void 0!==s?s:"-"}))),i.a.createElement(n.EuiFlexItem,{grow:!0},a&&i.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart",justifyContent:"flexEnd"},i.a.createElement(ee,{listId:e}),i.a.createElement(ie,{listId:e,type:N.type}))))),i.a.createElement(n.EuiFlexGroup,{className:ve,direction:"column"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiSearchBar,{onChange:q,"data-test-subj":"value-list-items-modal-search-bar",box:{"data-test-subj":"value-list-items-modal-search-bar-input",placeholder:(R=null!==(l=null==N?void 0:N.type)&&void 0!==l?l:"",j.i18n.translate("xpack.securitySolution.listItems.searchBar",{defaultMessage:"Filter your data using KQL syntax, for example: {listType}:*",values:{listType:R}}))}})),i.a.createElement(n.EuiFlexItem,{grow:!0,className:xe},L?i.a.createElement(ge,{items:null!==(u=null==T?void 0:T.data)&&void 0!==u?u:[],pagination:F,sorting:A,loading:M,onChange:({page:e,sort:t})=>{e&&(x(e.index),w(e.size)),t&&(O(t.field),C(t.direction))},isError:_,canWriteIndex:a,list:N}):i.a.createElement(n.EuiLoadingSpinner,{size:"xxl"})))));var R},we=({listId:e,children:t,shouldShowContentIfModalNotAvailable:a})=>{const[l,c]=Object(r.useState)(!1),{canWriteIndex:u,canReadIndex:d,loading:p}=Object(o.a)(),m=Object(s.a)("valueListItemsModalEnabled"),y=Object(r.useCallback)((()=>c(!1)),[]),g=Object(r.useCallback)((()=>{Object(J.h)(J.a.CLICK,J.c.OPEN_VALUE_LIST_MODAL),c(!0)}),[]);return p?null:d&&m?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiLink,{"data-test-subj":`show-value-list-modal-${e}`,onClick:g},t),l&&i.a.createElement(ke,{canWriteIndex:null!=u&&u,onCloseModal:y,listId:e})):a?i.a.createElement(i.a.Fragment,null,t):null}},549:function(e,t,a){"use strict";a.d(t,"b",(function(){return O})),a.d(t,"a",(function(){return I})),a.d(t,"c",(function(){return C}));var n=a(2),r=a(44),i=a(813),o=a(748);let s=function(e){return e.MALICIOUS_FILE="malicious_file",e.RANSOMWARE="ransomware",e.MEMORY_SIGNATURE="memory_signature",e.SHELLCODE_THREAD="shellcode_thread",e.BEHAVIOR="behavior",e}({}),l=function(e){return e.PROCESS="process",e.FILE="file",e.NETWORK="network",e.REGISTRY="registry",e.MALWARE="malware",e}({});var c=a(174),u=a(503),d=a(332),p=a(197),m=a(172),y=a(572),g=a(229),f=a(284);const b=`${y.j}.terms.field`,h=`${y.j}.terms.value`,v=`${y.j}.cardinality.field`,E=`${y.j}.cardinality.value`,x=`${y.j}.count`,k=[{id:"host.name"},{id:"agent.id",overrideField:g.a,label:p.b},{id:c.b.sentinel_one,overrideField:g.a,label:p.b},{id:c.b.crowdstrike,overrideField:g.a,label:p.b},{id:"user.name"},{id:"rule.name"},{id:"cloud.provider"},{id:"cloud.region"},{id:"cloud.provider"},{id:"cloud.region"},{id:"orchestrator.cluster.id"},{id:"orchestrator.cluster.name"},{id:"container.image.name"},{id:"container.image.tag"},{id:"orchestrator.namespace"},{id:"orchestrator.resource.parent.type"},{id:"orchestrator.resource.type"},{id:"process.executable"},{id:"file.path"},{id:i.o,label:p.z}];function w({primaryEventCategory:e,allEventCategories:t}){switch(e){case l.PROCESS:return[{id:"process.name"},{id:"process.parent.name"},{id:"process.args"}];case l.FILE:return[{id:"file.name"},{id:"file.hash.sha256"},{id:"file.directory"},{id:"process.name"}];case l.NETWORK:return[{id:"destination.address"},{id:"destination.port"},{id:"source.address"},{id:"source.port"},{id:"dns.question.name"},{id:"process.name"}];case l.REGISTRY:return[{id:"registry.key"},{id:"registry.value"},{id:"process.name"}];case l.MALWARE:return w({primaryEventCategory:l.FILE,allEventCategories:t});default:let e=[];return null!=t&&t.includes(l.FILE)&&(e=e.concat(w({primaryEventCategory:l.FILE}))),null!=t&&t.includes(l.PROCESS)&&(e=e.concat(w({primaryEventCategory:l.PROCESS}))),e}}function S(e,t){switch(e){case s.BEHAVIOR:return[{id:"rule.description",label:m.u},...w({...t,primaryEventCategory:void 0})];case s.SHELLCODE_THREAD:return[{id:"Target.process.executable"},{id:"Memory_protection.unique_key_v1"}];case s.RANSOMWARE:return[{id:"Ransomware.feature"},{id:"process.hash.sha256"},...w({...t,primaryEventCategory:void 0})];case s.MEMORY_SIGNATURE:return w({...t,primaryEventCategory:void 0});case s.MALICIOUS_FILE:return[{id:"file.Ext.quarantine_path",overrideField:g.j,label:p.x}];default:return[]}}function j(e){switch(e){case"threshold":return[{id:x,label:m.y},{id:b,overrideField:h,label:m.z},{id:v,label:m.x}];case"machine_learning":return[{id:`${o.t}.machine_learning_job_id`,legacyId:"signal.rule.machine_learning_job_id"},{id:`${o.t}.anomaly_threshold`,legacyId:"signal.rule.anomaly_threshold"}];case"threat_match":return[{id:`${o.t}.threat_index`,legacyId:"signal.rule.threat_index"},{id:`${o.t}.threat_query`,legacyId:"signal.rule.threat_query"}];case"new_terms":return[{id:y.e,label:m.q},{id:y.d,label:m.p}];default:return[]}}function O({eventCategories:e,eventCode:t,eventRuleType:a,highlightedFieldsOverride:n}){const i=[...(o=n,o.map((e=>({id:e})))),...k,...w(e),...S(t,e),...j(a)];var o;return Object(r.uniqBy)("id",i)}function I(e){const t=Object(r.find)({category:"event",field:"event.category"},e);let a,n;return Array.isArray(null==t?void 0:t.originalValue)?(a=null==t?void 0:t.originalValue[0],n=null==t?void 0:t.originalValue):(a=null==t?void 0:t.originalValue,a&&(n=[a])),{primaryEventCategory:a,allEventCategories:n}}const C=({data:e,browserFields:t,scopeId:a,eventId:o,isDraggable:s=!1,isReadOnly:l=!1,investigationFields:c})=>{const p=Object(d.a)(e);return Object(n.useMemo)((()=>{var n,d;const y=I(e),g=Object(r.find)({category:"event",field:"event.code"},e),x=Array.isArray(null==g?void 0:g.originalValue)?null==g||null===(n=g.originalValue)||void 0===n?void 0:n[0]:null==g?void 0:g.originalValue,w=Object(r.find)({category:"kibana",field:i.o},e),S=O({eventCategories:y,eventCode:x,eventRuleType:Array.isArray(null==w?void 0:w.originalValue)?null==w||null===(d=w.originalValue)||void 0===d?void 0:d[0]:null==w?void 0:w.originalValue,highlightedFieldsOverride:null!=c?c:[]});return null!=e?S.reduce(((n,i)=>{var c;const d=e.find((e=>e.field===i.id||i.legacyId&&e.field===i.legacyId));if(!d||Object(r.isEmpty)(d.values))return n;d.field===i.legacyId&&(i.id=i.legacyId);const y=null!=i.linkField&&e.find((e=>e.field===i.linkField)),g={...Object(f.b)({item:d,linkValueField:y||void 0,contextId:a,scopeId:a,browserFields:t,eventId:o,field:i}),isDraggable:s,isReadOnly:l};if(Object(u.b)(i.id)&&p.isSupported&&p.details.agentIdField!==i.id)return n;if(i.id===b){const t=function({values:e},t,a){const n=t.find((e=>e.field===h)),r=n&&n.values;if(Array.isArray(e)&&e.length>0&&Array.isArray(r)&&e.length===r.length)return e.map(((e,t)=>({title:e,description:{...a,values:[r[t]]}}))).filter((e=>!k.map((e=>e.id)).includes(e.title)))}(d,e,g);return t?[...n,...t]:n}if(i.id===v){const t=function({values:e},t,a){const n=t.find((e=>e.field===E)),r=n&&n.values;if(Array.isArray(e)&&1===e.length&&Array.isArray(r)&&e.length===r.length)return{title:m.x,description:{...a,values:[`count(${e[0]}) >= ${r[0]}`]}}}(d,e,g);return t?[...n,t]:n}return[...n,{title:null!==(c=i.label)&&void 0!==c?c:i.id,description:g}]}),[]):[]}),[e,c,a,t,o,s,l,p.details.agentIdField,p.isSupported])}},563:function(e,t,a){"use strict";a.d(t,"k",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"h",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"m",(function(){return m})),a.d(t,"l",(function(){return y})),a.d(t,"d",(function(){return g})),a.d(t,"e",(function(){return f}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Let’s set up your detection engine"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),f=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:e},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."})},566:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a(19),r=a(2),i=a.n(r),o=a(4);const s=o.i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),l=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:a,showShortcut:r})=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&i.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},i.a.createElement("p",null,e)),r&&i.a.createElement(n.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},i.a.createElement("span",null,s)," ",i.a.createElement(n.EuiBadge,{color:"hollow"},a))),c=i.a.memo(l);c.displayName="TooltipWithKeyboardShortcut";const u=({interval:e})=>{const t=Object(r.useMemo)((()=>{if(e){const a=parseInt(e.slice(0,-1),10),n=e.charAt(e.length-1);if(Number.isFinite(a))switch(n){case"s":return t=a,o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.seconds",{defaultMessage:"{value} {value, plural, one { second } other { seconds }}",values:{value:t}});case"m":return(e=>o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.minutes",{defaultMessage:"{value} {value, plural, one { minute } other { minutes }}",values:{value:e}}))(a);case"h":return(e=>o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.hours",{defaultMessage:"{value} {value, plural, one { hour } other { hours }}",values:{value:e}}))(a)}}var t}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{"data-test-subj":"interval-abbr-value","aria-hidden":Boolean(t)},e),t&&i.a.createElement(n.EuiScreenReaderOnly,null,i.a.createElement("p",null,t)))}},569:function(e,t,a){"use strict";a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return v})),a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return x})),a.d(t,"e",(function(){return I}));var n=a(19),r=a(60),i=a.n(r),o=a(2),s=a.n(o),l=a(41),c=a.n(l);const u=c.a.span.withConfig({displayName:"ArrowBody",componentId:"sc-11kjqat-0"})(["background-color:",";height:",";width:25px;"],(e=>e.theme.eui.euiColorLightShade),(({height:e})=>`${e}px`));u.displayName="ArrowBody";const d=s.a.memo((({direction:e})=>s.a.createElement(n.EuiIcon,{color:"subdued","data-test-subj":"arrow-icon",size:"s",type:e})));d.displayName="ArrowHead";var p=a(1296);const m=Object(p.scaleLinear)().domain([0,100]).range([1,4]).clamp(!0),y=e=>Array.isArray(e)&&1===e.length;var g=a(134),f=a(665),b=a(832);const h="source.bytes",v="source.packets",E="destination.bytes",x="destination.packets",k=c.a.span.withConfig({displayName:"Percent",componentId:"sc-19xyyc3-0"})(["margin-right:5px;"]);k.displayName="Percent";const w=c()(n.EuiFlexGroup).withConfig({displayName:"SourceDestinationArrowsContainer",componentId:"sc-19xyyc3-1"})(["margin:0 2px;.euiToolTipAnchor{white-space:nowrap;}"]);w.displayName="SourceDestinationArrowsContainer";const S=c()(n.EuiText).withConfig({displayName:"Data",componentId:"sc-19xyyc3-2"})(["margin:0 5px;"]);S.displayName="Data";const j=s.a.memo((({contextId:e,eventId:t,isDraggable:a,sourceBytes:r,sourceBytesPercent:o,sourcePackets:l})=>{const c=null!=o?m(o):1;return s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==r||isNaN(Number(r))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:h,id:`source-arrow-default-draggable-${e}-${t}-${h}-${r}`,isDraggable:a,value:r},s.a.createElement(S,{size:"xs"},null!=o?s.a.createElement(k,null,`(${i()(o).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(f.a,{value:r}))))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==l||isNaN(Number(l))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:v,id:`source-arrow-default-draggable-${e}-${t}-${v}-${l}`,isDraggable:a,value:l},s.a.createElement(S,{size:"xs"},s.a.createElement("span",null,`${l} ${b.a}`)))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowRight"})))}));j.displayName="SourceArrow";const O=s.a.memo((({contextId:e,destinationBytes:t,destinationBytesPercent:a,destinationPackets:r,eventId:o,isDraggable:l})=>{const c=null!=a?m(a):1;return s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowLeft"})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==t||isNaN(Number(t))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:E,id:`destination-arrow-default-draggable-${e}-${o}-${E}-${t}`,isDraggable:l,value:t},s.a.createElement(S,{size:"xs"},null!=a?s.a.createElement(k,null,`(${i()(a).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(f.a,{value:t}))))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==r||isNaN(Number(r))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:x,id:`destination-arrow-default-draggable-${e}-${o}-${x}-${r}`,isDraggable:l,value:r},s.a.createElement(S,{size:"xs"},s.a.createElement("span",null,`${i()(r).format("0,0")} ${b.a}`)))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})))}));O.displayName="DestinationArrow";const I=s.a.memo((({contextId:e,destinationBytes:t,destinationPackets:a,eventId:r,isDraggable:i,sourceBytes:o,sourcePackets:l})=>{const c=null!=o&&y(o)?o[0]:void 0,u=null!=l&&y(l)?l[0]:void 0,d=null!=t&&y(t)?t[0]:void 0,p=null!=a&&y(a)?a[0]:void 0,m=null!=c&&null!=d?(({numerator:e,denominator:t})=>{if(!(Math.abs(t)<Number.EPSILON)&&Number.isFinite(e)&&Number.isFinite(t))return e/t*100})({numerator:Number(c),denominator:Number(c)+Number(d)}):void 0,g=null!=m?100-m:void 0;return s.a.createElement(w,{alignItems:"center",justifyContent:"center",direction:"column",gutterSize:"none"},null!=c?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(j,{contextId:e,eventId:r,isDraggable:i,sourceBytes:c,sourcePackets:u,sourceBytesPercent:m})):null,null!=d?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(O,{contextId:e,destinationBytes:d,destinationPackets:p,destinationBytesPercent:g,eventId:r,isDraggable:i})):null)}));I.displayName="SourceDestinationArrows"},590:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="_id"},591:function(e,t,a){"use strict";a.d(t,"h",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"k",(function(){return y})),a.d(t,"g",(function(){return g})),a.d(t,"b",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"c",(function(){return h})),a.d(t,"e",(function(){return v})),a.d(t,"a",(function(){return E})),a.d(t,"f",(function(){return S}));var n=a(19),r=a(44),i=a(2),o=a.n(i),s=a(41),l=a.n(s),c=a(134),u=a(1106);const d="source.geo.continent_name",p="source.geo.country_name",m="source.geo.country_iso_code",y="source.geo.region_name",g="source.geo.city_name",f="destination.geo.continent_name",b="destination.geo.country_name",h="destination.geo.country_iso_code",v="destination.geo.region_name",E="destination.geo.city_name",x=[{prop:"GeoContinentName",fieldName:"geo.continent_name"},{prop:"GeoCountryName",fieldName:"geo.country_name"},{prop:"GeoCountryIsoCode",fieldName:"geo.country_iso_code"},{prop:"GeoRegionName",fieldName:"geo.region_name"},{prop:"GeoCityName",fieldName:"geo.city_name"}],k=l()(n.EuiFlexItem).withConfig({displayName:"GeoFlexItem",componentId:"sc-19jrcd0-0"})(["margin-right:5px;"]);k.displayName="GeoFlexItem";const w=o.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:i,values:s})=>null!=s?o.a.createElement(o.a.Fragment,null,Object(r.uniq)(s).map((r=>o.a.createElement(k,{grow:!1,key:`${e}-${t}-${a}-${r}`},o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},a===m||a===h?o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u.a,{countryCode:r})):null,o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(c.b,{"data-test-subj":a,field:a,id:`geo-field-values-default-draggable-${e}-${t}-${a}-${r}`,isDraggable:i,tooltipContent:a,value:r}))))))):null));w.displayName="GeoFieldValues";const S=o.a.memo((e=>{const{contextId:t,eventId:a,isDraggable:i,type:s}=e,l=(e=>x.map((({prop:t,fieldName:a})=>({prop:`${e}${t}`,fieldName:`${e}.${a}`}))))(s);return o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(r.uniq)(l).map((n=>o.a.createElement(w,{contextId:t,eventId:a,fieldName:n.fieldName,isDraggable:i,key:n.fieldName,values:Object(r.get)(n.prop,e)}))))}));S.displayName="GeoFields"},592:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return f}));var n=a(19),r=a(44),i=a(2),o=a.n(i),s=a(41),l=a.n(s),c=a(134),u=a(520),d=a(151),p=a(1430);const m="event.start",y="event.end",g=l()(n.EuiIcon).withConfig({displayName:"TimeIcon",componentId:"sc-181wv62-0"})(["margin-right:3px;position:relative;top:-1px;"]);g.displayName="TimeIcon";const f=o.a.memo((({contextId:e,eventDuration:t,eventId:a,eventEnd:i,eventStart:s,isDraggable:l})=>o.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"duration-and-start-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=t?Object(r.uniq)(t).map((t=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:u.b,id:`duration-event-start-end-default-draggable-${e}-${a}-${u.b}-${t}`,isDraggable:l,name:name,tooltipContent:null,value:t},o.a.createElement(n.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(p.a,{maybeDurationNanoseconds:t,tooltipTitle:u.b})))))):null,null!=s?Object(r.uniq)(s).map((t=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:m,id:`duration-event-start-end-default-draggable-${e}-${a}-${m}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(n.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:m,value:t})))))):null,null!=i?Object(r.uniq)(i).map((t=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:y,id:`duration-event-start-end-default-draggable-${e}-${a}-${y}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(n.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:y,value:t})))))):null)));f.displayName="DurationEventStartEnd"},593:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(134),o=a(150);const s=({args:e,contextId:t,eventId:a,processTitle:n,isDraggable:s})=>Object(o.e)(e)&&Object(o.e)(n)?null:r.a.createElement(r.a.Fragment,null,null!=e&&e.map(((e,n)=>r.a.createElement(o.c,{key:`${t}-args-${n}-${e}`,grow:!1,component:"span"},r.a.createElement(i.c,{contextId:`${t}-args-${n}-${e}`,eventId:a,field:"process.args",isDraggable:s,value:e,fieldType:"keyword",isAggregatable:!0})))),!Object(o.e)(n)&&r.a.createElement(o.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:t,eventId:a,field:"process.title",isDraggable:s,value:n,fieldType:"keyword",isAggregatable:!0})));s.displayName="ArgsComponent";const l=r.a.memo(s);l.displayName="Args"},594:function(e,t,a){"use strict";a.d(t,"i",(function(){return r})),a.d(t,"h",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"l",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"n",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"k",(function(){return y})),a.d(t,"c",(function(){return g})),a.d(t,"j",(function(){return f})),a.d(t,"e",(function(){return b}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.timeline.body.openSessionViewLabel",{defaultMessage:"Open Session View"}),i=n.i18n.translate("xpack.securitySolution.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),o=n.i18n.translate("xpack.securitySolution.timeline.body.notes.addNoteTooltip",{defaultMessage:"Add Note"}),s=({notesCount:e})=>n.i18n.translate("xpack.securitySolution.timeline.body.notes.addNote.multipleNotesAvailableTooltip",{values:{notesCount:e},defaultMessage:"{notesCount} {notesCount, plural, one {Note} other {Notes}  } available. Click to view {notesCount, plural, one {it} other {them}} & add more."}),l=n.i18n.translate("xpack.securitySolution.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),c=n.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),u=n.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsAriaLabel",{defaultMessage:"View details"}),d=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),p=n.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),m=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Analyze the alert or event in row {ariaRowindex}, with columns {columnValues}"}),y=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.sendAlertToTimelineForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Send the alert in row {ariaRowindex} to timeline, with columns {columnValues}"}),g=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.addNotesForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Add notes for the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),f=({ariaRowindex:e,columnValues:t,isEventPinned:a})=>n.i18n.translate("xpack.securitySolution.hoverActions.pinEventForRowAriaLabel",{defaultMessage:"{isEventPinned, select, true {Unpin} other {Pin} } the event in row {ariaRowindex} to timeline, with columns {columnValues}",values:{ariaRowindex:e,columnValues:t,isEventPinned:a}}),b=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.moreActionsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Select more actions for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},595:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewListDetailActionLabel",{defaultMessage:"View list detail"}),i=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewRuleDetailActionLabel",{defaultMessage:"View rule detail"}),o=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.link_column",{defaultMessage:"Link"}),s=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.name_column",{defaultMessage:"Name"}),l=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.action_column",{defaultMessage:"Action"}),c=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.tags_column",{defaultMessage:"Tags"})},596:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(1532),r=a(1533),i=a(5);const o=Object(n.a)((async({name:e,description:t,http:a,signal:n})=>await a.post(i.Mc,{version:"2023-10-31",body:JSON.stringify({name:e,description:t}),headers:{"Content-Type":"application/json"},method:"POST",signal:n}))),s=()=>Object(r.a)(o)},597:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return l}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.edit.label",{defaultMessage:"Edit rule exception"}),i=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.edit.label",{defaultMessage:"Edit endpoint exception"}),o=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.delete.label",{defaultMessage:"Delete rule exception"}),s=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.delete.label",{defaultMessage:"Delete endpoint exception"}),l=n.i18n.translate("xpack.securitySolution.exceptions.list.utility.title",{defaultMessage:"rule exceptions"})},598:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),r=a(1334),i=a(1314),o=a(19),s=a(144),l=a(5),c=a(599),u=a(221),d=a(884),p=a(780);const m=({exceptionsList:e,handleExport:t,handleDelete:a,handleDuplicate:m,handleManageRules:y})=>{const[g,f]=Object(n.useState)(i.a.LOADING),[b,h]=Object(n.useState)(),[v,E]=Object(n.useState)(!1),[x,k]=Object(n.useState)(!1),[w,S]=Object(n.useState)(null),{name:j,list_id:O,rules:I,type:C,created_by:T,created_at:M,description:_}=e,N=Object(n.useCallback)((()=>{f("")}),[f]),D=e=>{h(e),k(!0)},{lastUpdated:A,exceptionViewerStatus:F,exceptions:q,pagination:L,ruleReferences:R,fetchItems:P,onDeleteException:z,onPaginationChange:B}=Object(c.a)({list:e,deleteToastTitle:u.u,deleteToastBody:e=>u.t(e),errorToastBody:u.p,errorToastTitle:u.q,onEditListExceptionItem:D,onFinishFetchingExceptions:N});Object(n.useEffect)((()=>{P(null,i.a.LOADING)}),[P]);const[$,G]=Object(n.useState)(!1),U=Object(o.useGeneratedHtmlId)({prefix:"openAccordion"}),V=Object(d.a)(e),H=Object(n.useMemo)((()=>g===i.a.EMPTY?u.B:""),[g]),W=Object(n.useMemo)((()=>g===i.a.EMPTY?u.y(e.name):""),[e.name,g]),Y=Object(n.useMemo)((()=>e.type===r.a.ENDPOINT?u.A:u.z),[e.type]),Z=Object(n.useMemo)((()=>[{key:"Export",icon:"exportAction",label:u.O,onClick:a=>{C===r.a.ENDPOINT?t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:!0})():S(p.a.EXPORT)}},{key:"Duplicate",icon:"copy",label:u.k,disabled:V,onClick:e=>{S(p.a.DUPLICATE)}},{key:"Delete",icon:"trash",disabled:V,label:u.j,onClick:t=>{a({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"LinkRules",icon:"gear",disabled:V,label:u.X,onClick:e=>{y()}}]),[V,C,t,e.id,e.list_id,e.name,e.namespace_type,a,y]),K=Object(n.useCallback)((()=>{E(!0)}),[E]),Q=Object(n.useCallback)((e=>{E(!1),k(!1),e&&P()}),[P,E,k]),X=Object(n.useCallback)((()=>{S(p.a.EXPORT)}),[S]),J=Object(n.useCallback)((a=>{w===p.a.EXPORT&&t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:a})(),w===p.a.DUPLICATE&&m({listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:a})()}),[w,t,e.id,e.list_id,e.name,e.namespace_type,m]),{onClick:ee}=Object(s.o)()({deepLinkId:l.Oc.exceptions,path:`/details/${e.list_id}`});return{listId:O,listName:j,listDescription:_,createdAt:new Date(M).toDateString(),createdBy:T,listRulesCount:I.length.toString(),exceptionItemsCount:L.totalItemCount.toString(),listType:C,menuActionItems:Z,showAddExceptionFlyout:v,toggleAccordion:$,openAccordionId:U,viewerStatus:g,exceptionToEdit:b,showEditExceptionFlyout:x,lastUpdated:A,exceptions:q,ruleReferences:R,pagination:L,exceptionViewerStatus:F,onEditExceptionItem:D,onDeleteException:z,onPaginationChange:B,setToggleAccordion:G,onAddExceptionClick:K,handleConfirmExceptionFlyout:Q,handleCancelExceptionItemFlyout:()=>{E(!1),k(!1)},goToExceptionDetail:ee,emptyViewerTitle:H,emptyViewerBody:W,emptyViewerButtonText:Y,showIncludeExpiredExceptionsModal:w,onExportListClick:X,handleCancelExpiredExceptionsModal:()=>{S(null)},handleConfirmExpiredExceptionsModal:J}}},599:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(1314),i=a(118),o=a(627);const s=({list:e,deleteToastTitle:t,deleteToastBody:a,errorToastTitle:s,errorToastBody:l,onEditListExceptionItem:c,onFinishFetchingExceptions:u})=>{const{services:d}=Object(i.j)(),{http:p}=d,m=Object(i.n)(),[y,g]=Object(n.useState)([]),[f,b]=Object(n.useState)({}),[h,v]=Object(n.useState)({pageIndex:0,pageSize:0,totalItemCount:0}),[E,x]=Object(n.useState)(null),[k,w]=Object(n.useState)(""),S=Object(n.useCallback)(((e,t,a)=>{null==m||m.addError(e,{title:t||s,toastMessage:a||l}),w(r.a.ERROR)}),[l,s,m]),j=Object(n.useCallback)((async()=>{try{const t=await Object(o.c)([e]);b(t)}catch(e){S(e)}}),[S,e,b]),O=Object(n.useCallback)(((e,t,a)=>{v(e),x(Date.now()),setTimeout((()=>{if(a===r.a.EMPTY_SEARCH)return w(t?"":a);w(t?"":r.a.EMPTY)}),200)}),[]),I=Object(n.useCallback)((async(t,a)=>{try{w(r.a.LOADING);const{data:n,pagination:i}=await Object(o.b)({http:p,...Object(o.g)(null,e,t)});g(n),j(),O(i,n.length,a),"function"==typeof u&&u()}catch(e){S(e)}}),[p,e,j,O,u,S]),C=Object(n.useCallback)((async({id:e,name:n,namespaceType:i})=>{try{w(r.a.LOADING),await Object(o.a)({id:e,http:p,namespaceType:i}),null==m||m.addSuccess({title:t,text:"function"==typeof a?a(n):""}),I()}catch(e){S(e)}}),[p,m,t,a,I,S]),T=Object(n.useCallback)((async e=>{I(e)}),[I]);return{exceptions:y,lastUpdated:E,pagination:h,exceptionViewerStatus:k,ruleReferences:f,fetchItems:I,onDeleteException:C,onEditExceptionItem:e=>{"function"==typeof c&&c(e)},onPaginationChange:T}}},600:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(168),r=a(1532),i=a(1533);const o=Object(r.a)((async({file:e,http:t,signal:a,overwrite:r,overwriteExceptions:i,asNewList:o})=>{const s=new FormData;return s.append("file",e),await t.post(`${n.s}/_import`,{version:"2023-10-31",body:s,query:{overwrite:r,overwrite_exceptions:i,as_new_list:o},headers:{"Content-Type":void 0},method:"POST",signal:a})})),s=()=>Object(i.a)(o)},601:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(1334),i=a(1314),o=a(221),s=a(795);const l=(e,t)=>{const[a,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(),[m,y]=Object(n.useState)(i.a.LOADING),g=Object(n.useCallback)((()=>{y("")}),[y]),f=e=>{p(e),u(!0)},{exceptionViewerStatus:b,exceptions:h,lastUpdated:v,pagination:E,ruleReferences:x,fetchItems:k,onDeleteException:w,onPaginationChange:S}=Object(s.b)({list:e,deleteToastTitle:o.u,deleteToastBody:e=>o.t(e),errorToastBody:o.p,errorToastTitle:o.q,onEditListExceptionItem:f,onFinishFetchingExceptions:g});Object(n.useEffect)((()=>{k(null,i.a.LOADING)}),[k,t]);const j=Object(n.useMemo)((()=>m===i.a.EMPTY?o.B:""),[m]),O=Object(n.useMemo)((()=>m===i.a.EMPTY?o.y(e.name):""),[e.name,m]),I=Object(n.useMemo)((()=>e.type===r.a.ENDPOINT?o.A:o.z),[e.type]),C=Object(n.useCallback)((async e=>{y(i.a.SEARCHING),k(e,i.a.EMPTY_SEARCH)}),[k,y]),T=Object(n.useCallback)((()=>{l(!0),k()}),[k,l]),M=Object(n.useCallback)((e=>{l(!1),u(!1),e&&k()}),[k,l,u]);return{exceptionViewerStatus:b,listName:e.name,exceptions:h,listType:e.type,lastUpdated:v,pagination:E,viewerStatus:m,emptyViewerTitle:j,emptyViewerBody:O,emptyViewerButtonText:I,ruleReferences:x,showAddExceptionFlyout:a,showEditExceptionFlyout:c,exceptionToEdit:d,onSearch:C,onAddExceptionClick:T,onDeleteException:w,onEditExceptionItem:f,onPaginationChange:S,handleCancelExceptionItemFlyout:()=>{l(!1),u(!1)},handleConfirmExceptionFlyout:M}}},604:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(19);const o=Object(n.lazy)((()=>a.e(52).then(a.bind(null,1740)))),s={display:"flex",margin:"auto"},l=()=>r.a.createElement(n.Suspense,{fallback:r.a.createElement(i.EuiLoadingLogo,{logo:"logoSecurity",size:"xl",style:s})},r.a.createElement(o,null))},622:function(e,t,a){"use strict";a.d(t,"b",(function(){return ce})),a.d(t,"a",(function(){return de}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(75),l=a(45),c=a(13),u=a(363),d=a(444),p=a(41),m=a.n(p);const y=m.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-1xzawmf-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS));y.displayName="Field";const g=o.a.memo((({fieldId:e,fieldWidth:t})=>o.a.createElement(y,{"data-test-subj":"field",width:t},e)));g.displayName="DraggableFieldBadge";var f=a(222),b=a(180),h=a(19),v=a(1306),E=a(128),x=a(1260),k=a(266),w=a(146),S=a(137),j=a(191),O=a(44),I=a(53),C=a(124),T=a(129),M=a(522);const _=o.a.memo((({columnId:e,onColumnRemoved:t})=>{const a=Object(i.useCallback)((a=>{a.preventDefault(),a.stopPropagation(),t(e)}),[e,t]);return o.a.createElement(h.EuiButtonIcon,{"aria-label":M.f,color:"text","data-test-subj":"remove-column",iconType:"cross",onClick:a})}));_.displayName="CloseButton";const N=o.a.memo((({header:e,onColumnRemoved:t,sort:a,isLoading:n})=>o.a.createElement(o.a.Fragment,null,a.some((t=>t.columnId===e.id))&&n?o.a.createElement(b.d,{className:"siemEventsHeading__extra--loading"},o.a.createElement(b.h,{"data-test-subj":"timeline-loading-spinner"})):o.a.createElement(b.d,{className:"siemEventsHeading__extra--close"},o.a.createElement(_,{columnId:e.id,onColumnRemoved:t})))));N.displayName="Actions";const D=m()(h.EuiFieldText).withConfig({displayName:"FieldText",componentId:"sc-14rl5n4-0"})(["min-width:",";"],(e=>e.minwidth));D.displayName="FieldText";const A=o.a.memo((({columnId:e,minWidth:t,filter:a="",onFilterChange:n=O.noop,placeholder:r="Filter"})=>o.a.createElement(D,{"data-test-subj":"textFilter",minwidth:`${t}px`,placeholder:r,value:a,onChange:t=>{n({columnId:e,filter:t.target.value})}})));A.displayName="TextFilter";const F=o.a.memo((({header:e,onFilterChange:t=O.noop})=>{var a;return"text-filter"===e.columnHeaderType?o.a.createElement(A,{columnId:e.id,minWidth:null!==(a=e.initialWidth)&&void 0!==a?a:k.a,onFilterChange:t,placeholder:e.placeholder}):null}));F.displayName="Filter";const q=({header:e,sort:t})=>t.reduce(((t,a)=>e.id===a.columnId?a.sortDirection:t),"none"),L=({header:e,sort:t})=>t.findIndex((t=>t.columnId===e.id));var R=a(424),P=a(432);const z=o.a.memo((({sortNumber:e})=>e>=0?o.a.createElement(h.EuiNotificationBadge,{color:"subdued","data-test-subj":"sortNumber"},e+1):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortEmptyNumber",type:"empty"})));z.displayName="SortNumber";var B=function(e){return e.SORT_UP="sortUp",e.SORT_DOWN="sortDown",e}(B||{});const $=o.a.memo((({sortDirection:e,sortNumber:t})=>{const a=(e=>{switch(e){case S.b.asc:return B.SORT_UP;case S.b.desc:return B.SORT_DOWN;case"none":return;default:throw new Error("Unhandled sort direction")}})(e);return null!=a?o.a.createElement(h.EuiToolTip,{content:a===B.SORT_UP?P.e:P.f,"data-test-subj":"sort-indicator-tooltip"},o.a.createElement(o.a.Fragment,null,o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:a}),o.a.createElement(z,{sortNumber:t}))):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:"empty"})}));$.displayName="SortIndicator";var G=a(284);const U=m()(h.EuiIcon).withConfig({displayName:"IconType",componentId:"sc-1mjgpab-0"})(["margin-right:3px;position:relative;top:-2px;"]);U.displayName="IconType";const V=m.a.span.withConfig({displayName:"P",componentId:"sc-1mjgpab-1"})(["margin-bottom:5px;"]);V.displayName="P";const H=m.a.span.withConfig({displayName:"ToolTipTableMetadata",componentId:"sc-1mjgpab-2"})(["margin-right:5px;display:block;font-weight:bold;"]);H.displayName="ToolTipTableMetadata";const W=m.a.span.withConfig({displayName:"ToolTipTableValue",componentId:"sc-1mjgpab-3"})(["word-wrap:break-word;"]);W.displayName="ToolTipTableValue";const Y=o.a.memo((({header:e})=>{var t;return o.a.createElement(o.a.Fragment,null,!Object(O.isEmpty)(e.category)&&o.a.createElement(V,null,o.a.createElement(H,{"data-test-subj":"category"},M.a,":"),o.a.createElement(W,{"data-test-subj":"category-value"},e.category)),o.a.createElement(V,null,o.a.createElement(H,{"data-test-subj":"field"},M.c,":"),o.a.createElement(W,{"data-test-subj":"field-value"},e.id)),o.a.createElement(V,null,o.a.createElement(H,{"data-test-subj":"type"},M.i,":"),o.a.createElement(W,null,o.a.createElement(U,{"data-test-subj":"type-icon",type:Object(G.d)(e.type)}),null===(t=e.esTypes)||void 0===t?void 0:t.map((e=>o.a.createElement(h.EuiBadge,{"data-test-subj":`type-value-${e}`,key:e},e))))),!Object(O.isEmpty)(e.description)&&o.a.createElement(V,null,o.a.createElement(H,{"data-test-subj":"description"},M.b,":"),o.a.createElement(W,{"data-test-subj":"description-value"},e.description)))}));Y.displayName="HeaderToolTipContent";const Z=({children:e,header:t,isLoading:a,isResizing:n,onClick:r,showSortingCapability:i,sort:s})=>{var l,c;return o.a.createElement(b.c,{"data-test-subj":`header-${t.id}`,isLoading:a},t.aggregatable&&i?o.a.createElement(b.f,{"data-test-subj":"header-sort-button",onClick:n||a?O.noop:r},o.a.createElement(R.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Y,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(l=t.displayAsText)&&void 0!==l?l:t.id))),o.a.createElement($,{"data-test-subj":"header-sort-indicator",sortDirection:q({header:t,sort:s}),sortNumber:L({header:t,sort:s})})):o.a.createElement(b.g,null,o.a.createElement(R.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Y,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(c=t.displayAsText)&&void 0!==c?c:t.id)))),e)},K=o.a.memo(Z);var Q=a(57),X=a(169);const J=({header:e,onFilterChange:t=O.noop,sort:a,timelineId:n})=>{const r=Object(l.useDispatch)(),s=Object(i.useMemo)((()=>Object(Q.createSelector)(X.selectTimeline,(e=>(null==e?void 0:e.activeTab)===w.d.eql))),[]),c=Object(C.b)((e=>s(e,n))),u=Object(i.useCallback)((()=>{var t,i;const o=e.id,s=null!==(t=e.type)&&void 0!==t?t:"",l=null!==(i=e.esTypes)&&void 0!==i?i:[],c=(({clickedHeader:e,currentSort:t})=>t.reduce(((t,a)=>e.id===a.columnId?(e=>{switch(e.sortDirection){case S.b.desc:return S.b.asc;case S.b.asc:default:return S.b.desc}})(a):t),S.b.desc))({clickedHeader:e,currentSort:a}),u=a.findIndex((e=>e.columnId===o));let d=[];d=-1===u?[...a,{columnId:o,columnType:s,esTypes:l,sortDirection:c}]:[...a.slice(0,u),{columnId:o,columnType:s,esTypes:l,sortDirection:c},...a.slice(u+1)],r(T.a.updateSort({id:n,sort:d}))}),[r,e,a,n]),d=Object(i.useCallback)((e=>r(T.a.removeColumn({id:n,columnId:e}))),[r,n]),p=Object(i.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{isLoading:m}=Object(C.a)((e=>p(e,n)||{isLoading:!1})),y=!c&&!Object(I.isDataViewFieldSubtypeNested)(e);return o.a.createElement(o.a.Fragment,null,o.a.createElement(K,{header:e,isLoading:m,isResizing:!1,onClick:u,showSortingCapability:y,sort:a},o.a.createElement(N,{header:e,isLoading:m,onColumnRemoved:d,sort:a})),o.a.createElement(F,{header:e,onFilterChange:t}))},ee=o.a.memo(J),te=m()(h.EuiContextMenu).withConfig({displayName:"ContextMenu",componentId:"sc-wn02ez-0"})(["width:115px;& .euiContextMenuItem{font-size:12px;padding:4px 8px;width:115px;}"]),ae=m.a.div.withConfig({displayName:"PopoverContainer",componentId:"sc-wn02ez-1"})(["& .euiPopover{padding-right:8px;width:","px;}"],(({$width:e})=>e)),ne={right:!0},re=({draggableIndex:e,header:t,timelineId:a,isDragging:n,onFilterChange:c,sort:u,tabType:d})=>{const p=Object(i.useRef)(null),[m,y]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()}),[]),O=Object(l.useDispatch)(),I=Object(i.useMemo)((()=>{var e;return{width:null!==(e=t.initialWidth)&&void 0!==e?e:k.a,height:"auto"}}),[t.initialWidth]),C=Object(i.useMemo)((()=>({position:n?"absolute":"relative"})),[n]),_=Object(i.useMemo)((()=>({right:o.a.createElement(b.e,null)})),[]),N=Object(i.useCallback)(((e,n,r,i)=>{O(T.a.applyDeltaToColumnWidth({columnId:t.id,delta:i.width,id:a}))}),[O,t.id,a]),D=Object(i.useMemo)((()=>Object(f.j)({contextId:`timeline-column-headers-${d}-${a}`,fieldId:t.id})),[d,a,t.id]),A=Object(i.useCallback)((e=>{var n,r;const i=t.id,o=null!==(n=t.type)&&void 0!==n?n:"",s=null!==(r=t.esTypes)&&void 0!==r?r:[],l=u.findIndex((e=>e.columnId===i)),c=-1===l?[...u,{columnId:i,columnType:o,esTypes:s,sortDirection:e}]:[...u.slice(0,l),{columnId:i,columnType:o,esTypes:s,sortDirection:e},...u.slice(l+1)];O(T.a.updateSort({id:a,sort:c}))}),[O,t,u,a]),F=Object(i.useCallback)((()=>{y(!1),g()}),[g]),q=Object(i.useMemo)((()=>[{id:0,items:[{icon:o.a.createElement(h.EuiIcon,{type:"eyeClosed",size:"s"}),name:M.e,onClick:()=>{O(T.a.removeColumn({id:a,columnId:t.id})),F()}},...d!==w.d.eql?[{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortUp",size:"s"}),name:M.g,onClick:()=>{A(S.b.asc),F()}},{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortDown",size:"s"}),name:M.h,onClick:()=>{A(S.b.desc),F()}}]:[]]}]),[O,F,t.aggregatable,t.id,A,d,a]),L=Object(i.useMemo)((()=>o.a.createElement(ee,{timelineId:a,header:t,onFilterChange:c,sort:u})),[t,c,u,a]),R=Object(i.useCallback)((e=>{var a;return o.a.createElement(b.o,r()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(b.p,null,o.a.createElement(ae,{$width:null!==(a=t.initialWidth)&&void 0!==a?a:k.a},o.a.createElement(h.EuiPopover,{anchorPosition:"downLeft",button:L,closePopover:F,isOpen:m,ownFocus:!0,panelPaddingSize:"none"},o.a.createElement(te,{initialPanelId:0,panels:q})))))}),[F,L,t.initialWidth,m,q]),P=Object(i.useCallback)((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),[]),z=Object(i.useCallback)((()=>{y(!0)}),[]),{onBlur:B,onKeyDown:$}=Object(x.a)({closePopover:F,draggableId:D,fieldName:t.id,keyboardHandlerRef:p,openPopover:z}),G=Object(i.useCallback)((e=>{m||$(e)}),[m,$]);return o.a.createElement(v.Resizable,{enable:ne,size:I,style:C,handleComponent:_,onResizeStop:N},o.a.createElement("div",{"aria-colindex":null!=e?e+j.b:void 0,className:E.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:P,onBlur:B,onKeyDown:G,ref:p,role:"columnheader",tabIndex:0},o.a.createElement(s.Draggable,{"data-test-subj":"draggable",disableInteractiveElementBlocking:!0,draggableId:D,index:e,key:t.id},R)))},ie=o.a.memo(re);var oe=a(127),se=a(1201);const le=o.a.memo((({children:e,onMount:t,onUnmount:a})=>(Object(i.useEffect)((()=>(t(),()=>a())),[t,a]),o.a.createElement(o.a.Fragment,null,e))));le.displayName="DraggableContainer";const ce=({globalFullScreen:e,isActiveTimelines:t,timelineFullScreen:a})=>t&&a||!1===t&&e,ue=({actionsColumnWidth:e,browserFields:t,columnHeaders:a,isEventViewer:n=!1,isSelectAllChecked:d,onSelectAll:p,show:m,showEventsSelect:y,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,leadingControlColumns:k,trailingControlColumns:w})=>{const S=Object(l.useDispatch)(),[j,O]=Object(i.useState)(null),I=Object(i.useRef)(null);Object(i.useEffect)((()=>()=>{I.current&&I.current.closeEditor()}),[]),Object(i.useEffect)((()=>{!m&&I.current&&I.current.closeEditor()}),[m]);const C=Object(i.useCallback)(((e,t,n)=>{const i=n.source.index,s=a[i];return o.a.createElement(b.o,r()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(le,{onMount:()=>O(i),onUnmount:()=>O(null)},o.a.createElement(u.a,null,o.a.createElement(g,{fieldId:s.id,fieldWidth:s.initialWidth}))))}),[a,O]),T=Object(i.useMemo)((()=>a.map(((e,t)=>o.a.createElement(ie,{key:e.id,draggableIndex:t,timelineId:x,header:e,isDragging:j===t,sort:v,tabType:E})))),[a,x,j,v,E]),M=Object(i.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,o.a.createElement(b.r,r()({"data-test-subj":"headers-group",ref:e.innerRef,isDragging:t.isDraggingOver},e.droppableProps),T))),[T]),_=Object(i.useMemo)((()=>k?k.map((e=>e.headerCellRender)):[]),[k]),N=Object(i.useMemo)((()=>w?w.map((e=>e.headerCellRender)):[]),[w]),D=Object(se.a)({sourcererScope:oe.SourcererScopeName.timeline,editorActionsRef:I,upsertColumn:(e,t)=>S(Object(c.upsertColumn)({column:e,id:x,index:t})),removeColumn:e=>S(Object(c.removeColumn)({columnId:e,id:x}))}),A=Object(i.useMemo)((()=>_.map(((r,i)=>{const s=k[i]&&k[i].width||e;return o.a.createElement(b.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:n,key:i},r&&o.a.createElement(r,{width:s,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:y,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:D}))}))),[_,k,e,t,a,D,n,d,p,y,h,v,E,x]),F=Object(i.useMemo)((()=>N.map(((r,i)=>{const s=w[i]&&w[i].width||e;return o.a.createElement(b.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:n,key:i},r&&o.a.createElement(r,{width:s,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:y,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:D}))}))),[N,w,e,t,a,D,n,d,p,y,h,v,E,x]);return o.a.createElement(b.s,{"data-test-subj":"column-headers"},o.a.createElement(b.v,null,A,o.a.createElement(s.Droppable,{direction:"horizontal",droppableId:`${f.f}-${E}.${x}`,isDropDisabled:!1,type:f.a,renderClone:C},M),F))},de=o.a.memo(ue)},626:function(e,t,a){"use strict";a.d(t,"b",(function(){return S})),a.d(t,"c",(function(){return j})),a.d(t,"a",(function(){return _e}));var n=a(44),r=a(2),i=a.n(r),o=a(121),s=a(315),l=a(19),c=a(134),u=a(316),d=a(278),p=a(150),m=a(317),y=a(593),g=a(836);const f=e=>null==e||"unset"===e.toLowerCase(),b=i.a.memo((({contextId:e,eventId:t,primary:a,secondary:n,isDraggable:r})=>f(a)&&f(n)?null:!f(a)&&f(n)?i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:r,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):f(a)&&!f(n)||a===n?i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:r,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):i.a.createElement(l.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:r,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(p.c,{grow:!1,component:"span"},u.i),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:r,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))));b.displayName="PrimarySecondary";const h=i.a.memo((({contextId:e,eventId:t,userName:a,primary:n,secondary:r,isDraggable:o})=>f(a)&&f(n)&&f(r)?null:f(a)||f(n)||f(r)||a!==n||a!==r?!f(a)&&f(n)&&f(r)?i.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):i.a.createElement(b,{contextId:e,eventId:t,isDraggable:o,primary:n,secondary:r}):i.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})));h.displayName="PrimarySecondaryUserInfo";const v=i.a.memo((({eventId:e,contextId:t,hostName:a,userName:n,primary:r,secondary:o,workingDirectory:s,session:l,isDraggable:d})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(p.c,{grow:!1,component:"span"},u.Vb),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.session",value:l,iconType:"number",isDraggable:d,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(h,{contextId:t,eventId:e,userName:n,primary:r,secondary:o,isDraggable:d})),null!=a&&i.a.createElement(p.c,{grow:!1,component:"span"},"@"),i.a.createElement(g.a,{contextId:t,eventId:e,workingDirectory:s,hostName:a,isDraggable:d}))));v.displayName="SessionUserHostWorkingDir";const E=i.a.memo((({id:e,contextId:t,hostName:a,userName:n,primary:r,processName:o,processPid:s,processExecutable:d,processTitle:g,secondary:f,workingDirectory:b,args:h,result:E,session:x,text:k,isDraggable:w})=>i.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(v,{eventId:e,contextId:t,hostName:a,userName:n,primary:r,secondary:f,workingDirectory:b,session:x,isDraggable:w}),null!=d&&i.a.createElement(p.c,{grow:!1,component:"span"},k),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,processPid:s,processName:o,processExecutable:d,isDraggable:w})),i.a.createElement(y.a,{eventId:e,args:h,contextId:t,isDraggable:w,processTitle:g}),null!=E&&i.a.createElement(p.c,{grow:!1,component:"span"},u.pc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:w,queryValue:E,value:E,isAggregatable:!0,fieldType:"keyword"})))));E.displayName="AuditdGenericLine";const x=i.a.memo((({data:e,contextId:t,isDraggable:a,text:r,timelineId:o})=>{const s=e._id,c=Object(n.get)("auditd.session[0]",e),u=Object(n.get)("host.name[0]",e),m=Object(n.get)("user.name[0]",e),y=Object(n.get)("auditd.result[0]",e),g=Object(n.get)("process.pid[0]",e),f=Object(n.get)("process.name[0]",e),b=Object(n.get)("process.executable[0]",e),h=Object(n.get)("process.title[0]",e),v=Object(n.get)("process.working_directory[0]",e),x=Object(n.get)("auditd.summary.actor.primary[0]",e),k=Object(n.get)("auditd.summary.actor.secondary[0]",e),w=Object(n.get)("process.args",e);return null!=e.process?i.a.createElement(p.b,null,i.a.createElement(E,{id:s,contextId:t,text:r,hostName:u,userName:m,processName:f,processPid:g,processExecutable:b,processTitle:h,workingDirectory:v,args:w,session:c,primary:x,result:y,secondary:k,isDraggable:a}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:a,timelineId:o})):null}));x.displayName="AuditdGenericDetails";const k=i.a.memo((({id:e,contextId:t,hostName:a,userName:n,result:r,primary:o,secondary:s,filePath:d,processName:g,processPid:f,processExecutable:b,processTitle:h,workingDirectory:E,args:x,session:k,text:w,fileIcon:S,isDraggable:j})=>i.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(v,{eventId:e,contextId:t,hostName:a,userName:n,primary:o,secondary:s,workingDirectory:E,session:k,isDraggable:j}),(null!=d||null!=b)&&i.a.createElement(p.c,{grow:!1,component:"span"},w),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"file.path",isDraggable:j,value:d,iconType:S})),null!=b&&i.a.createElement(p.c,{grow:!1,component:"span"},u.kc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,isDraggable:j,processPid:f,processName:g,processExecutable:b})),i.a.createElement(y.a,{eventId:e,args:x,contextId:t,isDraggable:j,processTitle:h}),null!=r&&i.a.createElement(p.c,{grow:!1,component:"span"},u.pc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:j,queryValue:r,value:r})))));k.displayName="AuditdGenericFileLine";const w=i.a.memo((({data:e,contextId:t,text:a,fileIcon:r="document",timelineId:o,isDraggable:s})=>{const c=e._id,u=Object(n.get)("auditd.session[0]",e),m=Object(n.get)("host.name[0]",e),y=Object(n.get)("user.name[0]",e),g=Object(n.get)("auditd.result[0]",e),f=Object(n.get)("process.pid[0]",e),b=Object(n.get)("process.name[0]",e),h=Object(n.get)("process.executable[0]",e),v=Object(n.get)("process.title[0]",e),E=Object(n.get)("process.working_directory[0]",e),x=Object(n.get)("file.path[0]",e),w=Object(n.get)("auditd.summary.actor.primary[0]",e),S=Object(n.get)("auditd.summary.actor.secondary[0]",e),j=Object(n.get)("process.args",e);return null!=e.process?i.a.createElement(p.b,null,i.a.createElement(k,{id:c,contextId:t,text:a,hostName:m,userName:y,filePath:x,processName:b,processPid:f,processExecutable:h,processTitle:v,workingDirectory:E,args:j,session:u,primary:w,secondary:S,fileIcon:r,result:g,isDraggable:s}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:s,timelineId:o})):null}));w.displayName="AuditdGenericFileDetails";const S=({actionName:e,text:t})=>({id:o.e.auditd,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"auditd"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(s.a,null,i.a.createElement(x,{data:a,isDraggable:n,contextId:`${e}-${r}`,text:t,timelineId:r}))}),j=({actionName:e,text:t,fileIcon:a="document"})=>({id:o.e.auditd_file,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"auditd"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:n,isDraggable:r,scopeId:o})=>i.a.createElement(s.a,null,i.a.createElement(w,{contextId:`${e}-${o}`,data:n,fileIcon:a,isDraggable:r,text:t,timelineId:o}))}),O=S({actionName:"was-authorized",text:u.oc}),I=S({actionName:"started-session",text:u.Yb}),C=S({actionName:"logged-in",text:u.m}),T=S({actionName:"login",text:u.m}),M=S({actionName:"executed",text:u.gb}),_=S({actionName:"ended-session",text:u.eb}),N=S({actionName:"acquired-credentials",text:u.e}),D=S({actionName:"disposed-credentials",text:u.db}),A=S({actionName:"connected-to",text:u.T}),F=j({actionName:"opened-file",text:u.Db}),q=S({actionName:"changed-file-attributes-of",text:u.y}),L=j({actionName:"changed-file-permissions-of",text:u.A}),R=j({actionName:"changed-file-ownership-of",text:u.z}),P=S({actionName:"loaded-kernel-module",text:u.ob}),z=S({actionName:"unloaded-kernel-module",text:u.gc}),B=j({actionName:"created-directory",text:u.V,fileIcon:"folderOpen"}),$=j({actionName:"mounted",text:u.Bb}),G=j({actionName:"renamed",text:u.Ob}),U=j({actionName:"checked-metadata-of",text:u.S}),V=j({actionName:"checked-filesystem-metadata-of",text:u.Q}),H=j({actionName:"symlinked",text:u.dc}),W=j({actionName:"unmounted",text:u.ic}),Y=j({actionName:"deleted",text:u.Z}),Z=j({actionName:"changed-timestamp-of",text:u.N}),K=S({actionName:"listen-for-connections",text:u.mb}),Q=S({actionName:"bound-socket",text:u.t}),X=S({actionName:"received-from",text:u.Hb}),J=S({actionName:"sent-to",text:u.Ub}),ee=S({actionName:"killed-pid",text:u.lb}),te=S({actionName:"changed-identity-of",text:u.D}),ae=S({actionName:"changed-system-time",text:u.M}),ne=S({actionName:"make-device",text:u.ub}),re=S({actionName:"changed-system-name",text:u.L}),ie=S({actionName:"allocated-memory",text:u.h}),oe=S({actionName:"adjusted-scheduling-policy-of",text:u.Rb}),se=S({actionName:"added-user-account",text:u.g}),le=S({actionName:"caused-mac-policy-error",text:u.u}),ce=S({actionName:"loaded-firewall-rule-to",text:u.nb}),ue=S({actionName:"changed-promiscuous-mode-on-device",text:u.H}),de=S({actionName:"locked-account",text:u.rb}),pe=S({actionName:"unlocked-account",text:u.hc}),me=S({actionName:"added-group-account-to",text:u.f}),ye=S({actionName:"crashed-program",text:u.U}),ge=S({actionName:"attempted-execution-of-forbidden-program",text:u.hb}),fe=S({actionName:"used-suspcious-link",text:u.jc}),be=S({actionName:"used-suspicious-link",text:u.jc}),he=S({actionName:"failed-log-in-too-many-times-to",text:u.ib}),ve=S({actionName:"failed-login-too-many-times-to",text:u.ib}),Ee=S({actionName:"attempted-log-in-from-unusual-place-to",text:u.o}),xe=S({actionName:"attempted-login-from-unusual-place-to",text:u.o}),ke=S({actionName:"opened-too-many-sessions-to",text:u.Eb}),we=S({actionName:"attempted-log-in-during-unusual-hour-to",text:u.n}),Se=S({actionName:"attempted-login-during-unusual-hour-to",text:u.n}),je=S({actionName:"tested-file-system-integrity-of",text:u.ec}),Oe=S({actionName:"violated-selinux-policy",text:u.nc}),Ie=S({actionName:"violated-apparmor-policy",text:u.lc}),Ce=S({actionName:"changed-group",text:u.B}),Te=S({actionName:"changed-user-id",text:u.P}),Me=S({actionName:"changed-auditd-configuration",text:u.v}),_e=[M,C,T,O,N,_,D,I,A,F,q,L,R,P,z,B,$,G,U,V,H,W,Y,Z,K,Q,X,J,ee,te,ae,ne,re,ie,oe,se,me,ge,le,ue,ye,ce,de,fe,be,pe,he,ve,xe,ke,Ee,we,Se,je,Oe,Ie,Ce,Te,S({actionName:"changed-audit-configuration",text:u.v}),S({actionName:"refreshed-credentials",text:u.Jb}),S({actionName:"negotiated-crypto-key",text:u.Cb}),S({actionName:"crypto-officer-logged-in",text:u.X}),S({actionName:"crypto-officer-login",text:u.X}),S({actionName:"crypto-officer-logged-out",text:u.Y}),S({actionName:"crypto-officer-logout",text:u.Y}),S({actionName:"started-crypto-session",text:u.ac}),S({actionName:"access-result",text:u.d}),S({actionName:"aborted-auditd-startup",text:u.a}),S({actionName:"aborted-audit-startup",text:u.a}),S({actionName:"remote-audit-connected",text:u.Lb}),S({actionName:"remote-audit-disconnected",text:u.Mb}),S({actionName:"shutdown-audit",text:u.Wb}),S({actionName:"audit-error",text:u.p}),S({actionName:"reconfigured-auditd",text:u.Ib}),S({actionName:"reconfigured-audit",text:u.Ib}),S({actionName:"resumed-audit-logging",text:u.Pb}),S({actionName:"rotated-audit-logs",text:u.Qb}),S({actionName:"started-audit",text:u.Zb}),S({actionName:"deleted-group-account-from",text:u.ab}),S({actionName:"deleted-user-account",text:u.bb}),S({actionName:"changed-audit-feature",text:u.w}),S({actionName:"relabeled-filesystem",text:u.Kb}),S({actionName:"authenticated-to-group",text:u.q}),S({actionName:"changed-group-password",text:u.C}),S({actionName:"modified-group-account",text:u.xb}),S({actionName:"initialized-audit-subsystem",text:u.jb}),S({actionName:"modified-level-of",text:u.yb}),S({actionName:"overrode-label-of",text:u.Fb}),S({actionName:"changed-login-id-to",text:u.E}),S({actionName:"mac-permission",text:u.tb}),S({actionName:"changed-selinux-boolean",text:u.J}),S({actionName:"loaded-selinux-policy",text:u.qb}),S({actionName:"changed-selinux-enforcement",text:u.K}),S({actionName:"assigned-user-role-to",text:u.j}),S({actionName:"modified-role",text:u.zb}),S({actionName:"removed-use-role-from",text:u.Nb}),S({actionName:"removed-user-role-from",text:u.Nb}),Me,S({actionName:"violated-seccomp-policy",text:u.mc}),S({actionName:"started-service",text:u.bc}),S({actionName:"stopped-service",text:u.cc}),S({actionName:"booted-system",text:u.s}),S({actionName:"changed-to-runlevel",text:u.O}),S({actionName:"shutdown-system",text:u.Xb}),S({actionName:"sent-test",text:u.Tb}),S({actionName:"unknown",text:u.fc}),S({actionName:"sent-message",text:u.Sb}),S({actionName:"access-permission",text:u.c}),S({actionName:"authenticated",text:u.r}),S({actionName:"changed-password",text:u.G}),S({actionName:"ran-command",text:u.Gb}),S({actionName:"error",text:u.fb}),S({actionName:"logged-out",text:u.sb}),S({actionName:"logout",text:u.sb}),S({actionName:"changed-mac-configuration",text:u.F}),S({actionName:"loaded-mac-policy",text:u.pb}),S({actionName:"modified-user-account",text:u.Ab}),S({actionName:"changed-role-to",text:u.I}),S({actionName:"access-error",text:u.b}),S({actionName:"changed-configuration",text:u.x}),S({actionName:"issued-vm-control",text:u.kb}),S({actionName:"created-vm-image",text:u.W}),S({actionName:"deleted-vm-image",text:u.cb}),S({actionName:"checked-integrity-of",text:u.R}),S({actionName:"assigned-vm-id",text:u.k}),S({actionName:"migrated-vm-from",text:u.vb}),S({actionName:"migrated-vm-to",text:u.wb}),S({actionName:"assigned-vm-resource",text:u.l})]},627:function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return y})),a.d(t,"i",(function(){return g})),a.d(t,"h",(function(){return f})),a.d(t,"f",(function(){return b}));var n=a(204),r=a(818),i=a(159);const o=(e,t,a)=>{const{pagination:n,search:r,filters:i}=a||{};let o=[],s=[];return Array.isArray(e)&&e.length?(o=e.map((e=>e.list_id)),s=e.map((e=>e.namespace_type))):t&&(o=[t.list_id],s=[t.namespace_type]),{listIds:o,namespaceTypes:s,pagination:n,search:r,filters:i}},s=async({namespaceTypes:e,listIds:t,http:a,pagination:i,search:o})=>{try{const s=new AbortController,{pageIndex:l,pageSize:c,totalItemCount:u}=i||{},{page:d,per_page:p,total:m,data:y}=await Object(n.n)({filter:void 0,http:a,listIds:null!=t?t:[],namespaceTypes:null!=e?e:[],search:o,pagination:{perPage:c,page:(l||0)+1,total:u},signal:s.signal});return{data:y.map((e=>Object(r.b)(e))),pagination:{pageIndex:d-1,pageSize:p,totalItemCount:m}}}catch(e){throw new Error(e)}},l=async e=>{try{const t=new AbortController,{references:a}=await Object(i.l)({lists:e.map((e=>({id:e.id,listId:e.list_id,namespaceType:e.namespace_type}))),signal:t.signal});return a.reduce(((e,t)=>({...e,...t})),{})}catch(e){throw new Error(e)}},c=async({id:e,namespaceType:t,http:a})=>{try{const r=new AbortController;await Object(n.e)({http:a,id:e,namespaceType:t,signal:r.signal})}catch(e){throw new Error(e)}};var u=a(1622),d=a(82),p=a(245);const m=async({id:e,http:t})=>{try{const a=new AbortController,r=Object(u.a)({filters:{list_id:e},namespaceTypes:["single","agnostic"],hideLists:p.a}),i=["single","agnostic"].join(),{data:o}=await Object(n.m)({filters:r,http:t,signal:a.signal,namespaceTypes:i,pagination:{}});return a.abort(),o&&o.length?o[0]:null}catch(e){throw new Error(e)}},y=async e=>{try{const t=new AbortController,{data:a}=await Object(i.j)({signal:t.signal,pagination:{page:1,perPage:1e4}});return t.abort(),a.reduce(((t,a,n)=>{var r;return(null===(r=a.exceptions_list)||void 0===r?void 0:r.find((t=>t.list_id===e)))&&t.push(a),t}),[])}catch(e){throw new Error(e)}},g=async({list:e,http:t})=>{try{const a=new AbortController;await Object(n.x)({http:t,list:e,signal:a.signal}),a.abort()}catch(e){throw new Error(e)}},f=async({rules:e,listId:t})=>{try{if(!e.length)return;const a=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var n;const r=(null!==(n=e.exceptions_list)&&void 0!==n?n:[]).filter((({list_id:e})=>e!==t));await Object(i.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:r},signal:a.signal})}))}catch(e){throw new Error(e)}},b=async({rules:e,listId:t,id:a,listType:n,listNamespaceType:r})=>{try{if(!e.length)return;const o=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var s;const l={list_id:t,id:a,type:n,namespace_type:r},c=[...null!==(s=e.exceptions_list)&&void 0!==s?s:[],l];await Object(i.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:c},signal:o.signal})}))}catch(e){throw new Error(e)}}},629:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return y})),a.d(t,"a",(function(){return f}));var n=a(19),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(134),c=a(144),u=a(4);const d=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.clientCertLabel",{defaultMessage:"client cert"}),p=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.serverCertLabel",{defaultMessage:"server cert"}),m="tls.client_certificate.fingerprint.sha1",y="tls.server_certificate.fingerprint.sha1",g=s.a.span.withConfig({displayName:"FingerprintLabel",componentId:"sc-1isap0l-0"})(["margin-right:5px;"]);g.displayName="FingerprintLabel";const f=i.a.memo((({eventId:e,certificateType:t,contextId:a,fieldName:r,isDraggable:o,value:s})=>i.a.createElement(l.c,{contextId:a,"data-test-subj":`${t}-certificate-fingerprint`,eventId:e,field:r,iconType:"snowflake",isDraggable:o,tooltipContent:i.a.createElement(n.EuiText,{size:"xs"},i.a.createElement("span",null,r)),value:s,isAggregatable:!0,fieldType:"keyword"},i.a.createElement(g,null,"client"===t?d:p),i.a.createElement(c.b,{certificateFingerprint:s||""}))));f.displayName="CertificateFingerprint"},630:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return p}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(134),l=a(144);const c=a(4).i18n.translate("xpack.securitySolution.ja3.fingerprint.ja3.fingerprintLabel",{defaultMessage:"ja3"}),u="tls.fingerprints.ja3.hash",d=o.a.span.withConfig({displayName:"Ja3FingerprintLabel",componentId:"sc-94sjip-0"})(["margin-right:5px;"]);d.displayName="Ja3FingerprintLabel";const p=r.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:n,value:i})=>r.a.createElement(s.c,{contextId:e,"data-test-subj":"ja3-hash",eventId:t,field:a,iconType:"snowflake",isDraggable:n,value:i,isAggregatable:!0,fieldType:"keyword"},r.a.createElement(d,null,c),r.a.createElement(l.e,{"data-test-subj":"ja3-hash-link",ja3Fingerprint:i||""}))));p.displayName="Ja3Fingerprint"},632:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(19),l=a(5),c=a(4);const u=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.unknownAvatarName",{defaultMessage:"Uknown"}),d=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.addCommentPlaceholder",{defaultMessage:"Add a new comment..."});var p=a(118),m=a(343);const y="exceptionCommentAccordionButton",g=o()(s.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-ggp4j5-0"})(["",""],(({theme:e})=>Object(i.css)(["margin-right:",";"],e.eui.euiSizeS))),f=o()(s.EuiAccordion).withConfig({displayName:"CommentAccordion",componentId:"sc-ggp4j5-1"})(["",""],(({theme:e})=>Object(i.css)([".","{color:",";padding:"," 0;}"],y,e.eui.euiColorPrimary,e.eui.euiSizeM))),b=Object(n.memo)((function({exceptionItemComments:e,newCommentValue:t,accordionTitle:a,initialIsOpen:i=!1,newCommentOnChange:o,setCommentError:b}){const[h,v]=Object(n.useState)(!1),[E,x]=Object(n.useState)(!1),k=Object(p.f)(),w=null==k?void 0:k.fullName,S=null==k?void 0:k.username,j=null==k?void 0:k.email,O=Object(n.useMemo)((()=>w&&w.length>0?w:j&&j.length>0?j:S&&S.length>0?S:u),[w,j,S]);Object(n.useEffect)((()=>{b(h)}),[h,b]);const I=Object(n.useCallback)((e=>{o(e.target.value),v(e.target.value.length>l.Vb)}),[o]),C=Object(n.useCallback)((e=>{x(e)}),[]),T=Object(n.useMemo)((()=>{return e&&e.length>0?r.a.createElement(s.EuiText,{size:"s","data-test-subj":"ExceptionItemCommentsAccordionButton"},E?(e=>c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.hideCommentsLabel",{values:{comments:e},defaultMessage:"Hide ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))(e.length):(t=e.length,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.showCommentsLabel",{values:{comments:t},defaultMessage:"Show ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))):null;var t}),[e,E]),M=Object(n.useMemo)((()=>e&&e.length>0?Object(m.j)(e):[]),[e]);return r.a.createElement("div",null,r.a.createElement(f,{initialIsOpen:i&&!!t,id:"add-exception-comments-accordion",buttonClassName:y,buttonContent:null!=a?a:T,"data-test-subj":"exceptionItemCommentsAccordion",onToggle:e=>C(e)},r.a.createElement(s.EuiCommentList,{comments:M}),r.a.createElement(s.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(g,{name:O,size:"l","data-test-subj":"exceptionItemCommentAvatar"})),r.a.createElement(s.EuiFlexItem,{grow:1},r.a.createElement(s.EuiFormRow,{fullWidth:!0,error:(_=l.Vb,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.maxLengthError",{values:{length:_},defaultMessage:"The length of the comment is too long. The maximum length is {length} characters."})),isInvalid:h},r.a.createElement(s.EuiTextArea,{placeholder:d,"aria-label":"Comment Input",value:t,onChange:I,fullWidth:!0,"data-test-subj":"newExceptionItemCommentTextArea"}))))));var _}))},661:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(47),r=a(118),i=a(123),o=a(483);const s=({uids:e})=>{const{security:t}=Object(r.j)().services,{addError:a}=Object(i.a)();return Object(n.useQuery)(["useBulkGetUserProfiles",...e],(async()=>(async({security:e,uids:t})=>0===t.size?[]:e.userProfiles.bulkGet({uids:t,dataPath:"avatar"}))({security:t,uids:e})),{retry:!1,staleTime:1/0,onError:e=>{a(e,{title:o.c})}})}},662:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"f",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return c}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),i=n.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),o=n.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),s=n.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),l=n.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),c=n.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"})},663:function(e,t,a){"use strict";a.d(t,"m",(function(){return r})),a.d(t,"q",(function(){return i})),a.d(t,"g",(function(){return o})),a.d(t,"k",(function(){return s})),a.d(t,"w",(function(){return l})),a.d(t,"u",(function(){return c})),a.d(t,"s",(function(){return u})),a.d(t,"t",(function(){return d})),a.d(t,"o",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"r",(function(){return y})),a.d(t,"z",(function(){return g})),a.d(t,"v",(function(){return f})),a.d(t,"p",(function(){return b})),a.d(t,"l",(function(){return h})),a.d(t,"y",(function(){return v})),a.d(t,"x",(function(){return E})),a.d(t,"f",(function(){return x})),a.d(t,"h",(function(){return k})),a.d(t,"i",(function(){return w})),a.d(t,"b",(function(){return S})),a.d(t,"c",(function(){return j})),a.d(t,"a",(function(){return O})),a.d(t,"e",(function(){return I})),a.d(t,"d",(function(){return C})),a.d(t,"n",(function(){return T}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryLabel",{defaultMessage:"Custom query"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlQueryLabel",{defaultMessage:"EQL query"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryFiltersLabel",{defaultMessage:"Saved query filters"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryLabel",{defaultMessage:"Saved query"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.newTermsRuleTypeDescription",{defaultMessage:"New Terms"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlRuleTypeDescription",{defaultMessage:"ES|QL"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionPerRuleExecution",{defaultMessage:"One rule execution"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionSuppressOnMissingFieldsDescription",{defaultMessage:"Suppress and group alerts for events with missing fields"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionDoNotSuppressOnMissingFieldsDescription",{defaultMessage:"Do not suppress alerts for events with missing fields"}),I=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockLabel",{defaultMessage:"Building block"}),C=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'}),T=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"})},666:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(19),r=a(42),i=a(2),o=a.n(i),s=a(118);const l=({title:e})=>{const{docLinks:t}=Object(s.j)().services,a=t.links.securitySolution.entityAnalytics;return o.a.createElement(n.EuiLink,{target:"_blank",rel:"noopener nofollow noreferrer",href:a.entityRiskScoring},e||o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.learnMore",defaultMessage:"Learn more about entity risk scoring"}))},c=o.a.memo(l);c.displayName="EntityAnalyticsLearnMoreLink"},667:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(45),i=a(1225),o=a(131),s=a(293);const l=({alertStatus:e,closePopover:t,eventId:a,scopeId:l,refetch:c})=>{const u=Object(r.useDispatch)(),{hasIndexWrite:d}=Object(s.a)(),p=Object(n.useCallback)((()=>{t(),c&&c()}),[t,c]),m=Object(o.getScopedActions)(l),y=Object(n.useCallback)((({eventIds:e,isLoading:t})=>{m&&u(m.setEventsLoading({id:l,eventIds:e,isLoading:t}))}),[u,l,m]),g=Object(n.useCallback)((({eventIds:e,isDeleted:t})=>{m&&u(m.setEventsDeleted({id:l,eventIds:e,isDeleted:t}))}),[u,l,m]),f=Object(n.useMemo)((()=>[a]),[a]),b=Object(n.useMemo)((()=>({eventIds:f,currentStatus:e,setEventsLoading:y,setEventsDeleted:g,onUpdateSuccess:p,onUpdateFailure:p})),[e,f,y,p,g]),h=Object(i.a)(b);return Object(n.useMemo)((()=>({actionItems:d?h:[]})),[h,d])}},668:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return p}));var n=a(2),r=a(1334),i=a(44),o=a(540),s=a(563),l=a(733),c=a(1200);let u=function(e){return e.alerts="alerts",e.exceptions="rule_exceptions",e.endpointExceptions="endpoint_exceptions",e.executionResults="execution_results",e.executionEvents="execution_events",e}({});const d={[u.alerts]:s.a,[u.exceptions]:l.e,[u.endpointExceptions]:l.d,[u.executionResults]:l.g,[u.executionEvents]:l.f},p=({rule:e,ruleId:t,isExistingRule:a,hasIndexRead:s})=>{const l=Object(n.useMemo)((()=>({[u.alerts]:{id:u.alerts,name:d[u.alerts],disabled:!1,href:`/rules/id/${t}/${u.alerts}`},[u.exceptions]:{id:u.exceptions,name:d[u.exceptions],disabled:null==e,href:`/rules/id/${t}/${u.exceptions}`},[u.endpointExceptions]:{id:u.endpointExceptions,name:d[u.endpointExceptions],disabled:null==e,href:`/rules/id/${t}/${u.endpointExceptions}`},[u.executionResults]:{id:u.executionResults,name:d[u.executionResults],disabled:!a,href:`/rules/id/${t}/${u.executionResults}`},[u.executionEvents]:{id:u.executionEvents,name:d[u.executionEvents],disabled:!a,href:`/rules/id/${t}/${u.executionEvents}`}})),[a,e,t]),[p,m]=Object(n.useState)(l),y=Object(c.f)(),g=Object(o.a)("showEndpointExceptions");return Object(n.useEffect)((()=>{const t=[];var a;(s||t.push(u.alerts),y.extendedLogging.isEnabled||t.push(u.executionEvents),g||t.push(u.endpointExceptions),null!=e)&&((null!==(a=e.exceptions_list)&&void 0!==a?a:[]).some((e=>e.type===r.a.ENDPOINT))||t.push(u.endpointExceptions));const n=Object(i.omit)(t,l);m(n)}),[g,s,e,l,y]),p}},694:function(e,t,a){"use strict";a.d(t,"a",(function(){return Ce})),a.d(t,"b",(function(){return _e})),a.d(t,"c",(function(){return Le})),a.d(t,"e",(function(){return xe})),a.d(t,"d",(function(){return qe})),a.d(t,"f",(function(){return Re.a}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(41),c=a.n(l),u=a(4);const d=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdated",{defaultMessage:"Last updated"}),p=u.i18n.translate("xpack.securitySolution.artifactCard.created",{defaultMessage:"Created"}),m=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdatedBy",{defaultMessage:"Updated by"}),y=u.i18n.translate("xpack.securitySolution.artifactCard.createdBy",{defaultMessage:"Created by"}),g=u.i18n.translate("xpack.securitySolution.artifactCard.globalEffectScope",{defaultMessage:"Applied globally"}),f=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope",{defaultMessage:"Applied to {count} {count, plural, one {policy} other {policies}}",values:{count:e}}),b=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope.title",{defaultMessage:"Applied to the following {count, plural, one {policy} other {policies}}",values:{count:e}}),h=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator",{defaultMessage:"IS"}),v=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),E=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),x=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),k=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.nestedOperator",{defaultMessage:"has"}),w=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator",{defaultMessage:"is one of"}),S=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),j=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.existsOperator",{defaultMessage:"exists"}),O=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.listOperator",{defaultMessage:"included in"}),I=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.os",{defaultMessage:"OS"}),C=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.and",{defaultMessage:"AND"}),T=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.windows",{defaultMessage:"Windows"}),M=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.linux",{defaultMessage:"Linux"}),_=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.macos",{defaultMessage:"Mac"}),N=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.expand",{defaultMessage:"Expand"}),D=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.collpase",{defaultMessage:"Collapse"}),A=u.i18n.translate("xpack.securitySolution.artifactMinifiedCard.descriptionLabel",{defaultMessage:"Description"});var F=a(151),q=a(52),L=a.n(q),R=a(130);const P=Object(i.memo)((({bold:e,truncate:t,size:a="s",withTooltip:n=!1,"data-test-subj":r,children:l})=>{const c=Object(i.useMemo)((()=>L()({"eui-textTruncate":t,"eui-textBreakWord":!0})),[t]),u=Object(i.useMemo)((()=>e?o.a.createElement("strong",null,l):l),[e,l]);return o.a.createElement(s.EuiText,{className:c,size:a,"data-test-subj":r},n&&"string"==typeof l&&l.length>0&&l!==Object(R.e)()?o.a.createElement(s.EuiToolTip,{anchorClassName:c,content:l,position:"top"},o.a.createElement(o.a.Fragment,null,u)):u)}));P.displayName="TextValueDisplay";var z=a(126);const B=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1dvdnzg-0"})(["padding-top:2px;"]),$=Object(i.memo)((({date:e,type:t,"data-test-subj":a})=>{const n=Object(z.a)(a);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"m","data-test-subj":a},o.a.createElement(B,{grow:!1},o.a.createElement(s.EuiIcon,{type:"calendar"})),o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiFlexGroup,{responsive:!1,direction:"column",alignItems:"flexStart",gutterSize:"xs"},o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("label")},o.a.createElement(P,null,"update"===t?d:p)),o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("value")},o.a.createElement(P,{bold:!0},o.a.createElement(F.b,{value:e,dateFormat:"M/D/YYYY"}))))))}));$.displayName="DateField";var G=a(50),U=a(542);const V=Object(i.memo)((({items:e,button:t,panelPaddingSize:a,anchorPosition:n,maxWidth:l="32ch",maxHeight:c="255px",fixedWidth:u=!1,title:d,loading:p=!1,hoverInfo:m,isNavigationDisabled:y=!1,...g})=>{const f=Object(z.a)(g["data-test-subj"]),[b,h]=Object(i.useState)(!1),v=Object(i.useCallback)((()=>h(!1)),[h]),E=Object(i.useCallback)((()=>h(!b)),[b]),x=Object(i.useMemo)((()=>({"data-test-subj":f("popoverPanel")})),[f]),k=Object(i.useMemo)((()=>e.map(((e,t)=>{var a,n;return p?o.a.createElement(s.EuiSkeletonText,{lines:1,key:Object(G.v4)(),"data-test-subj":null!==(n=e["data-test-subj"])&&void 0!==n?n:f(`item-loading-${t}`)}):o.a.createElement(U.a,r()({},e,{isNavigationDisabled:y,key:Object(G.v4)(),"data-test-subj":null!==(a=e["data-test-subj"])&&void 0!==a?a:f(`item-${t}`),textTruncate:Boolean(l)||e.textTruncate,hoverInfo:m,onClick:t=>{if(v(),e.onClick)return e.onClick(t)}}))}))),[e,p,y,f,l,m,v]),w=Object(i.useMemo)((()=>{const e={className:"eui-yScroll",style:{}};return l&&!u&&(e.style.maxWidth=l),c&&(e.style.maxHeight=c),u&&(e.style.width=null!=l?l:"32ch"),e}),[l,u,c]);return o.a.createElement(s.EuiPopover,r()({},g,{anchorPosition:n,panelPaddingSize:a,panelProps:x,button:o.a.createElement("div",{className:"eui-displayInlineBlock","data-test-subj":f("triggerButtonWrapper"),onClick:E},t),isOpen:b,closePopover:v}),d?o.a.createElement(s.EuiPopoverTitle,{paddingSize:"m"},d):null,o.a.createElement(s.EuiContextMenuPanel,r()({},w,{items:k})))}));V.displayName="ContextMenuWithRouterSupport";const H=Object(i.memo)((({items:e,"data-test-subj":t,icon:a="boxesHorizontal"})=>{const n=Object(z.a)(t),[l,c]=Object(i.useState)(!1),d=Object(i.useCallback)((()=>c(!1)),[c]),p=Object(i.useCallback)((()=>c(!l)),[l]),m=Object(i.useMemo)((()=>({"data-test-subj":n("popoverPanel")})),[n]),y=Object(i.useMemo)((()=>e.map((e=>o.a.createElement(U.a,r()({},e,{key:Object(G.v4)(),onClick:t=>{if(d(),e.onClick)return e.onClick(t)}}))))),[d,e]);return o.a.createElement(s.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:m,"data-test-subj":t,button:o.a.createElement(s.EuiButtonIcon,{"data-test-subj":n("button"),iconType:a,onClick:p,"aria-label":u.i18n.translate("xpack.securitySolution.actionsContextMenu.label",{defaultMessage:"Open"})}),isOpen:l,closePopover:d},o.a.createElement(s.EuiContextMenuPanel,{items:y,"data-test-subj":n("contextMenuPanel")}))}));H.displayName="ActionsContextMenu";const W=Object(i.memo)((({actions:e,"data-test-subj":t})=>e&&e.length>0?o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(H,{items:e,icon:"boxesHorizontal","data-test-subj":t})):null));W.displayName="CardActionsFlexItem";const Y=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemSmallBottomMargin",componentId:"sc-1orjmip-0"})(["margin-bottom:4px !important;"]),Z=Object(i.memo)((({name:e,createdDate:t,updatedDate:a,actions:n,"data-test-subj":r})=>{const i=Object(z.a)(r);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart","data-test-subj":r},o.a.createElement(Y,{grow:!0},o.a.createElement(s.EuiFlexGroup,{alignItems:"flexStart"},o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiTitle,{size:"s"},o.a.createElement("h3",{"data-test-subj":i("title")},e))),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xl"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement($,{date:a,type:"update","data-test-subj":i("updated")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement($,{date:t,type:"create","data-test-subj":i("created")})))))),o.a.createElement(W,{actions:n,"data-test-subj":i("actions")}))}));Z.displayName="CardHeader";const K=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oz5dfu-0"})(["margin:6px;"]),Q=Object(i.memo)((({createdBy:e,updatedBy:t,"data-test-subj":a})=>{const n=Object(z.a)(a);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"l",responsive:!1,"data-test-subj":a},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:y,value:e,"data-test-subj":n("createdBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:m,value:t,"data-test-subj":n("updatedBy")})))}));Q.displayName="TouchedByUsers";const X=Object(i.memo)((({label:e,value:t,"data-test-subj":a})=>{const n=Object(z.a)(a);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!1,responsive:!1,"data-test-subj":a},o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiBadge,{"data-test-subj":n("label")},e)),o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center",wrap:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiAvatar,{name:t,size:"s","data-test-subj":n("avatar")})),o.a.createElement(s.EuiFlexItem,{grow:!1,className:"eui-textTruncate","data-test-subj":n("value")},o.a.createElement(P,null,t)))))}));X.displayName="UserName";var J=a(42),ee=a(140);const te=c()("div").withConfig({displayName:"StyledWithContextMenuShiftedWrapper",componentId:"sc-d4sgp-0"})(["margin-left:-10px;"]),ae=c()(s.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-d4sgp-1"})(["height:10px !important;"]),ne=Object(i.memo)((({policies:e,loadingPoliciesList:t=!1,"data-test-subj":a})=>{const n=Object(z.a)(a),{canReadPolicyManagement:r}=Object(ee.a)().endpointPrivileges,[l,c]=Object(i.useMemo)((()=>e?["partial",f(e.length)]:["globe",g]),[e]),u=o.a.createElement(s.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"s","data-test-subj":a},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:l,size:"s"})),o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":n("value")},o.a.createElement(P,{size:"xs"},c)));return e&&e.length?o.a.createElement(te,null,o.a.createElement(re,{policies:e,loadingPoliciesList:t,canReadPolicies:r,"data-test-subj":n("popupMenu")},u)):u}));ne.displayName="EffectScope";const re=Object(i.memo)((({policies:e,loadingPoliciesList:t=!1,canReadPolicies:a,children:n,"data-test-subj":r})=>{const l=Object(z.a)(r),c=Object(i.useMemo)((()=>a?o.a.createElement(ae,{flush:"right",size:"s",iconSide:"right",iconType:"popout"},o.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.contextMenuItemByRouter.viewDetails",defaultMessage:"View details"})):void 0),[a]);return o.a.createElement(V,{maxHeight:"235px",fixedWidth:!0,panelPaddingSize:"none",items:e,anchorPosition:e.length>1?"rightCenter":"rightUp","data-test-subj":r,loading:t,hoverInfo:c,button:o.a.createElement(s.EuiButtonEmpty,{size:"xs","data-test-subj":l("button")},n),title:b(e.length),isNavigationDisabled:!a})}));re.displayName="WithContextMenu";const ie=Object(i.memo)((({createdBy:e,updatedBy:t,policies:a,loadingPoliciesList:n=!1,"data-test-subj":r})=>{const i=Object(z.a)(r);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",responsive:!0,"data-test-subj":r},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(Q,{createdBy:e,updatedBy:t,"data-test-subj":i("touchedBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(ne,{policies:a,loadingPoliciesList:n,"data-test-subj":i("effectScope")})))}));ie.displayName="CardSubHeader";var oe=a(403);const se=Object.freeze({linux:M,mac:_,macos:_,windows:T}),le=Object.freeze({[oe.b.NESTED]:k,[oe.b.MATCH_ANY]:w,[oe.b.MATCH]:h,[oe.b.WILDCARD]:E,[oe.b.EXISTS]:j,[oe.b.LIST]:O}),ce=Object.freeze({[oe.b.MATCH_ANY]:S,[oe.b.MATCH]:v,[oe.b.WILDCARD]:x}),ue=c()(s.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-1oxtqy5-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),de=c()(s.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-1oxtqy5-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),pe=c()("span").withConfig({displayName:"StyledCondition",componentId:"sc-1oxtqy5-2"})(["margin-right:6px;"]),me=Object(i.memo)((({os:e,entries:t,"data-test-subj":a})=>{const n=Object(z.a)(a),r=Object(i.useMemo)((()=>e.map((e=>{var t;return null!==(t=se[e])&&void 0!==t?t:e})).join(", ")),[e]),l=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>o.a.createElement(s.EuiBadge,{color:"hollow"},e))):t,c=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=le[e])&&void 0!==a?a:e:null!==(n=ce[e])&&void 0!==n?n:e},u=Object(i.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((({field:e,type:t,value:a,operator:r})=>o.a.createElement(ue,{"data-test-subj":n("nestedCondition"),key:e+t+a,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiToken,{iconType:"tokenNested",size:"s"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:"",value:e,color:"subdued"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:c(t,r),value:l(t,a)})))))}),[n]);return o.a.createElement("div",{"data-test-subj":a},o.a.createElement("div",{"data-test-subj":n("os")},o.a.createElement("strong",null,o.a.createElement(s.EuiExpression,{description:"",value:I}),o.a.createElement(s.EuiExpression,{description:h,value:r}))),t.map((({field:e,type:t,value:a,operator:r,entries:i=[]})=>o.a.createElement("div",{"data-test-subj":n("condition"),key:e+t+a},o.a.createElement("div",{className:"eui-xScroll"},o.a.createElement(s.EuiExpression,{description:o.a.createElement(pe,null,C),value:e,color:"subdued"}),o.a.createElement(s.EuiExpression,{description:c(t,r),value:l(t,a)})),u(t,i)))))}));me.displayName="CriteriaConditions";const ye=e=>"effectScope"in e;var ge=a(245);const fe=e=>(e=>{const t=e.filter((e=>e.startsWith(ge.b)));return t.some((e=>e===`${ge.b}all`))?{type:"global"}:{type:"policy",policies:t.map((e=>e.substr(ge.b.length)))}})(e.tags),be=e=>Object(i.useMemo)((()=>(e=>{var t;const a=e,{name:n,created_by:r,created_at:i,updated_at:o,updated_by:s,description:l="",entries:c}=a;return{name:n,created_by:r,created_at:i,updated_at:o,updated_by:s,description:l,comments:ye(a)?[]:a.comments,entries:c,os:ye(a)?[a.os]:null!==(t=a.os_types)&&void 0!==t?t:[],effectScope:ye(a)?a.effectScope:fe(a)}})(e)),[e]),he=c()(s.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-1qnczpg-0"})(["&.artifactEntryCard + &.artifactEntryCard{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),ve=Object(i.memo)((({className:e,...t})=>o.a.createElement(he,r()({},t,{hasBorder:!0,paddingSize:"none",className:`artifactEntryCard ${null!=e?e:""}`}))));ve.displayName="CardContainerPanel";const Ee=c()(s.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1aw8s5s-0"})(["padding:32px;&.top-section{padding-bottom:24px;}&.bottom-section{padding-top:24px;}&.artifact-entry-collapsible-card{padding:24px !important;}"]),xe=Object(i.memo)((e=>o.a.createElement(Ee,r()({},e,{hasBorder:!1,hasShadow:!1,paddingSize:"l"}))));xe.displayName="CardSectionPanel";var ke=a(44),we=a(353);const Se=c()(s.EuiAvatar).withConfig({displayName:"CustomEuiAvatar",componentId:"sc-3lb0zi-0"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightShade)),je=Object(i.memo)((({comments:e,"data-test-subj":t})=>{const a=Object(z.a)(t),[n,r]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{r(!n)}),[r,n]),c=Object(i.useMemo)((()=>(e=>e.map((e=>({username:e.created_by,timestamp:o.a.createElement(F.b,{value:e.created_at,dateFormat:"MMM D, YYYY"}),event:we.b,timelineAvatar:o.a.createElement(Se,{size:"s",name:e.created_by}),children:o.a.createElement(s.EuiText,{size:"s"},e.comment)}))))(e)),[e]),d=Object(i.useMemo)((()=>n?((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.hide",{defaultMessage:"Hide comments ({count})",values:{count:e}}))(e.length):((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.show",{defaultMessage:"Show comments ({count})",values:{count:e}}))(e.length)),[e.length,n]);return Object(ke.isEmpty)(e)?null:o.a.createElement("div",{"data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiButtonEmpty,{onClick:l,flush:"left",size:"xs","data-test-subj":a("label")},d),o.a.createElement(s.EuiAccordion,{id:"1",arrowDisplay:"none",forceState:n?"open":"closed"},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiCommentList,{comments:c,"data-test-subj":a("list")})))}));je.displayName="CardComments";const Oe=(e,t)=>Object(i.useMemo)((()=>"policy"===e.effectScope.type?null==e?void 0:e.effectScope.policies.map((e=>t&&t[e]?t[e]:{children:e})):void 0),[e.effectScope,t]),Ie=Object(i.memo)((({truncate:e,children:t,"data-test-subj":a,withTooltip:n})=>o.a.createElement(P,{size:"m",truncate:e,"data-test-subj":a,withTooltip:n},t||Object(R.e)())));Ie.displayName="ArtifactDescription";const Ce=Object(i.memo)((({item:e,policies:t,loadingPoliciesList:a=!1,actions:n,hideDescription:i=!1,hideComments:l=!1,Decorator:c,"data-test-subj":u,...d})=>{const p=be(e),m=Object(z.a)(u),y=Oe(p,t);return o.a.createElement(ve,r()({},d,{"data-test-subj":u}),o.a.createElement(xe,{className:"top-section"},o.a.createElement(Z,{name:p.name,createdDate:p.created_at,updatedDate:p.updated_at,actions:n,"data-test-subj":m("header")}),o.a.createElement(ie,{createdBy:p.created_by,updatedBy:p.updated_by,policies:y,loadingPoliciesList:a,"data-test-subj":m("subHeader")}),!i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(Ie,{"data-test-subj":m("description")},p.description)),l?null:o.a.createElement(o.a.Fragment,null,i&&o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(je,{comments:p.comments,"data-test-subj":m("comments")}))),o.a.createElement(s.EuiHorizontalRule,{margin:"none"}),o.a.createElement(xe,{className:"bottom-section"},c&&o.a.createElement(c,{item:e,"data-test-subj":m("decorator")}),o.a.createElement(me,{os:p.os,entries:p.entries,"data-test-subj":m("criteriaConditions")})))}));Ce.displayName="ArtifactEntryCard";const Te=c()(s.EuiSplitPanel.Outer).withConfig({displayName:"CardContainerPanel",componentId:"sc-lh5b0s-0"})(["&.artifactEntryCardMinified + &.artifactEntryCardMinified{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),Me=c()(s.EuiSplitPanel.Inner).withConfig({displayName:"CustomSplitInnerPanel",componentId:"sc-lh5b0s-1"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),_e=Object(i.memo)((({item:e,isSelected:t=!1,onToggleSelectedArtifact:a,"data-test-subj":n,Decorator:l,...c})=>{var u;const d=be(e),p=Object(z.a)(n),[m,y]=Object(i.useState)("closed"),g=Object(i.useCallback)((()=>{y((e=>"closed"===e?"open":"closed"))}),[]),f=Object(i.useCallback)((()=>"open"===m?"Hide details":"Show details"),[m]),b=Object(i.useMemo)((()=>o.a.createElement(Me,null,o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiCheckbox,{id:d.name,"data-test-subj":`${d.name}_checkbox`,checked:t,onChange:()=>a(!t)})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":p("title")},d.name)))))),[d.name,p,t,a]);return o.a.createElement(Te,r()({},c,{"data-test-subj":n,className:`${null!==(u=c.className)&&void 0!==u?u:""}  artifactEntryCardMinified`,id:d.name,hasShadow:!1,hasBorder:!0}),b,o.a.createElement(s.EuiSplitPanel.Inner,{paddingSize:"s"},o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":p("descriptionTitle")},A)),o.a.createElement(Ie,{"data-test-subj":p("description")},d.description)),o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiButtonEmpty,{"data-test-subj":p("collapse"),color:"primary",size:"s",flush:"left",iconType:"open"===m?"arrowUp":"arrowDown",iconSide:"right",iconSize:"m",onClick:g,style:{fontWeight:400}},f()),o.a.createElement(s.EuiAccordion,{id:"showDetails",arrowDisplay:"none",forceState:m},l&&o.a.createElement(l,{item:e,"data-test-subj":p("decorator")}),o.a.createElement(me,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")})))))}));_e.displayName="ArtifactEntryCardMinified";const Ne=Object(i.memo)((({expanded:e,onClick:t,"data-test-subj":a})=>o.a.createElement(s.EuiButtonIcon,{iconType:e?"arrowUp":"arrowDown",onClick:t,"data-test-subj":a,"aria-label":e?D:N})));Ne.displayName="CardExpandButton";const De=Object(i.memo)((({artifact:e,onExpandCollapse:t,policies:a,actions:n,expanded:r=!1,"data-test-subj":s})=>{const l=Object(z.a)(s),c=Oe(e,a),u=Object(i.useCallback)((()=>{t()}),[t]);return o.a.createElement(qe,{"data-test-subj":s,expanded:r,expandToggle:o.a.createElement(Ne,{expanded:r,onClick:u,"data-test-subj":l("expandCollapse")}),name:o.a.createElement(P,{bold:!0,truncate:!r,withTooltip:!r},e.name),description:o.a.createElement(Ie,{truncate:!r,withTooltip:!r},e.description),effectScope:o.a.createElement(ne,{policies:c,"data-test-subj":l("effectScope")}),actionMenu:o.a.createElement(W,{actions:n,"data-test-subj":l("actions")})})}));De.displayName="CardCompressedHeader";const Ae=c.a.div.withConfig({displayName:"ButtonIconPlaceHolder",componentId:"sc-j6qhqr-0"})(["display:inline-block;width:",";height:",";"],(({theme:e})=>e.eui.euiSizeL),(({theme:e})=>e.eui.euiSizeL)),Fe=c()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-j6qhqr-1"})(["&.flushTop,.flushTop{padding-top:0;margin-top:0;}"]),qe=Object(i.memo)((({expanded:e,name:t,expandToggle:a,effectScope:n,actionMenu:r,description:l,"data-test-subj":c,flushTop:u})=>{const d=Object(z.a)(c),p=(e=>Object(i.useMemo)((()=>L()({"eui-textTruncate":!e})),[e]))(e),m=u?" flushTop":"";return o.a.createElement(Fe,{responsive:!1,alignItems:"center","data-test-subj":c,className:m},o.a.createElement(s.EuiFlexItem,{grow:!1,className:m,"data-test-subj":d("expandCollapseHolder")},a),o.a.createElement(s.EuiFlexItem,{className:p+m},o.a.createElement(s.EuiFlexGroup,{alignItems:"center",className:m},o.a.createElement(s.EuiFlexItem,{grow:2,className:p+m,"data-test-subj":d("titleHolder")},t),o.a.createElement(s.EuiFlexItem,{grow:3,className:p+m,"data-test-subj":d("descriptionHolder")},l),o.a.createElement(s.EuiFlexItem,{grow:1,"data-test-subj":d("effectScopeHolder"),className:m},n))),!0===r?o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":d("cardActionsPlaceholder"),className:m},o.a.createElement(Ae,null)):r)}));qe.displayName="CardCompressedHeaderLayout";const Le=Object(i.memo)((({item:e,onExpandCollapse:t,policies:a,actions:n,expanded:i=!1,"data-test-subj":l,Decorator:c,...u})=>{const d=be(e),p=Object(z.a)(l);return o.a.createElement(ve,r()({},u,{"data-test-subj":l}),o.a.createElement(xe,{className:"artifact-entry-collapsible-card"},o.a.createElement(De,{artifact:d,actions:n,policies:a,expanded:i,onExpandCollapse:t,"data-test-subj":p("header")})),i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(xe,null,c&&o.a.createElement(c,{item:e,"data-test-subj":p("decorator")}),o.a.createElement(me,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")}))))}));Le.displayName="ArtifactEntryCollapsibleCard";var Re=a(782)},695:function(e,t,a){"use strict";a.d(t,"b",(function(){return wt})),a.d(t,"a",(function(){return Mt}));var n=a(119),r=a.n(n),i=a(19),o=a(2),s=a.n(o),l=a(41),c=a.n(l),u=a(7),d=a(175),p=a(379),m=a(740),y=a(122),g=a(829),f=a(305),b=a(758),h=a(170),v=a(1393),E=a(272);const x=c.a.div.withConfig({displayName:"EuiCodeEditorContainer",componentId:"sc-a6c5kq-0"})([".euiCodeEditorWrapper{position:absolute;}"]),k=s.a.memo((({rawEventData:e})=>{const t=Object(o.useMemo)((()=>JSON.stringify(e,E.j,2)),[e]);return s.a.createElement(x,null,s.a.createElement(i.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",isCopyable:!0,"data-test-subj":"jsonView"},t))}));k.displayName="JsonView";var w=a(244),S=a(42),j=a(226),O=a(137),I=a(130),C=a(666),T=a(521);const M=({risk:e,riskEntity:t,originalRisk:a})=>{var n,r,o,l,c,u,d,p;const m=t===O.t.host?null==e||null===(n=e.result)||void 0===n||null===(r=n[0])||void 0===r||null===(o=r.host)||void 0===o||null===(l=o.risk)||void 0===l?void 0:l.calculated_level:null==e||null===(c=e.result)||void 0===c||null===(u=c[0])||void 0===u||null===(d=u.user)||void 0===d||null===(p=d.risk)||void 0===p?void 0:p.calculated_level;return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:s.a.createElement(T.a,{title:w.o(t),riskScoreEntity:t}),toolTipTitle:s.a.createElement(T.a,{title:w.o(t),riskScoreEntity:t}),toolTipContent:s.a.createElement(S.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.riskDataTooltipContent",defaultMessage:"Risk level is displayed only when available for a {riskEntity}. Ensure {riskScoreDocumentationLink} is enabled within your environment.",values:{riskEntity:t,riskScoreDocumentationLink:s.a.createElement(C.a,{title:w.p})}})}),e.loading&&s.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading"}),!e.loading&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Z,{field:w.a(t),value:m?s.a.createElement(j.a,{severity:m,hideBackgroundColor:!0}):Object(I.e)()}),a&&m!==a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Z,{field:w.m(t),value:s.a.createElement(j.a,{severity:a,hideBackgroundColor:!0})})))))},_=s.a.memo(M);var N=a(44),D=a(173),A=a(336),F=a(422),q=a(131);const L=c.a.span.withConfig({displayName:"EnrichmentFieldFeedName",componentId:"sc-1cy82j8-0"})(["white-space:nowrap;font-style:italic;"]),R=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1cy82j8-1"})([".inlineActions{opacity:0;}.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}"]),P=({data:e,eventId:t,index:a,feedName:n,scopeId:r,value:l,isDraggable:c,isReadOnly:u})=>{const d=Object(o.useMemo)((()=>({scopeId:r})),[r]);if(!e||!l)return null;const p=`alert-details-value-formatted-field-value-${r}-${t}-${e.field}-${l}-${a}-${n}`;return s.a.createElement(R,{key:p,direction:"row",gutterSize:"xs",alignItems:"center"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("div",null,s.a.createElement(F.a,{contextId:r,eventId:p,fieldFormat:e.format,fieldName:e.field,fieldType:e.type,isDraggable:c,isObjectArray:e.isObjectArray,value:l,truncate:!1}),n&&s.a.createElement(L,null," ",w.e," ",n))),s.a.createElement(i.EuiFlexItem,null,l&&!u&&s.a.createElement(D.c,{data:{field:e.field,value:l},triggerId:D.d.DETAILS_FLYOUT,mode:D.a.INLINE,sourcererScopeId:Object(q.getSourcererScopeId)(r),metadata:d,visibleCellActions:3})))},z=({browserFields:e,data:t,enrichments:a,scopeId:n,eventId:r,isDraggable:o,isReadOnly:l})=>{const c=a.map(((a,n)=>{var r,i,o,s;const{field:l,type:c,feedName:u,value:d}=Object(A.d)(a),p=t.find((e=>e.field===l)),m=null!==(r=null==p?void 0:p.category)&&void 0!==r?r:"",y=Object(N.get)([m,"fields",null!=l?l:""],e);return{fieldsData:{field:null!=l?l:"",format:null!==(i=null==y?void 0:y.format)&&void 0!==i?i:"",type:null!==(o=null==y?void 0:y.type)&&void 0!==o?o:"",isObjectArray:null!==(s=null==p?void 0:p.isObjectArray)&&void 0!==s&&s},type:c,feedName:u,index:n,field:l,browserField:y,value:d}})),[d,p]=Object(u.partition)(c,(({type:e})=>Object(A.f)(e)));return s.a.createElement(s.a.Fragment,null,p.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:w.f,toolTipContent:w.g}),p.map((({fieldsData:e,index:t,field:a,feedName:i,browserField:c,value:u})=>s.a.createElement(Z,{key:a,field:a,value:s.a.createElement(P,{eventId:r,index:t,feedName:i,scopeId:n,value:u,data:e,isDraggable:o,isReadOnly:l})}))))),d.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:w.h,toolTipContent:w.j}),d.map((({fieldsData:e,index:t,field:a,feedName:i,browserField:c,value:u})=>s.a.createElement(Z,{key:a,field:a,value:s.a.createElement(P,{eventId:r,index:t,feedName:i,scopeId:n,value:u,data:e,isDraggable:o,isReadOnly:l})}))))))},B=s.a.memo(z);var $=a(350),G=a(357);const U=c()(i.EuiTitle).withConfig({displayName:"UppercaseEuiTitle",componentId:"sc-1az7ye2-0"})(["text-transform:uppercase;"]),V=({children:e})=>s.a.createElement(U,{size:"xxxs"},s.a.createElement("h5",null,e)),H=c()(i.EuiTitle).withConfig({displayName:"StyledEnrichmentFieldTitle",componentId:"sc-1az7ye2-1"})(["width:220px;"]),W=({title:e})=>s.a.createElement(H,{size:"xxxs"},s.a.createElement("h6",null,e)),Y=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1az7ye2-2"})(["font-size:",";margin-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeS)),Z=({field:e,value:t})=>s.a.createElement(Y,{direction:"row",gutterSize:"none",responsive:!0,alignItems:"center","data-test-subj":"EnrichedDataRow"},s.a.createElement(i.EuiFlexItem,{style:{flexShrink:0},grow:!1},s.a.createElement(W,{title:e})),s.a.createElement(i.EuiFlexItem,{className:"eui-textBreakWord"},t)),K=({title:e,toolTipContent:t,toolTipTitle:a})=>s.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(V,null,e)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(G.b,{toolTipContent:t,toolTipTitle:null!=a?a:e}))),Q=({browserFields:e,data:t,enrichments:a,eventId:n,scopeId:r,hostRisk:o,userRisk:l,isDraggable:c,isReadOnly:u})=>{var d,p,m,y;const g=null==t||null===(d=t.find((e=>"host.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===d||null===(p=d.values)||void 0===p?void 0:p[0],f=null==t||null===(m=t.find((e=>"user.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===m||null===(y=m.values)||void 0===y?void 0:y[0],b=Object($.a)("entity-analytics");return b||0!==a.length?s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,w.b)),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{flexGrow:0}},b&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:O.t.host,risk:o,originalRisk:g})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:O.t.user,risk:l,originalRisk:f}))),s.a.createElement(B,{browserFields:e,data:t,enrichments:a,scopeId:r,eventId:n,isDraggable:c,isReadOnly:u}))):null},X=s.a.memo(Q);var J=a(741),ee=a(197),te=a(549);const ae=c()(i.EuiInMemoryTable).withConfig({displayName:"SummaryTable",componentId:"sc-12oammb-0"})([".inlineActions{opacity:0;}.flyoutTableHoverActions{.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}}"]);var ne=a(1348),re=a(284),ie=a(149);const oe={flexGrow:0},se=({data:e,eventId:t,fieldFromBrowserField:a,isDraggable:n,linkValue:r,scopeId:i,values:o,isReadOnly:l})=>{const c=Object(re.e)(e.field);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ne.a,{contextId:i,data:e,eventId:t,fieldFromBrowserField:a,linkValue:r,isDraggable:n,style:oe,values:o}),i!==ie.f.active&&!l&&c&&s.a.createElement(D.c,{data:{field:e.field,value:o},triggerId:D.d.DETAILS_FLYOUT,mode:D.a.INLINE,visibleCellActions:3,sourcererScopeId:Object(q.getSourcererScopeId)(i),metadata:{scopeId:i}}))};se.displayName="SummaryValueCell";var le=a(263),ce=a(302),ue=a(352);const de=({data:e,eventId:t,fieldFromBrowserField:a,linkValue:n,scopeId:r,values:o})=>{const{loading:l,count:c}=Object(ue.a)({field:e.field,isActiveTimelines:r===ie.f.active,value:o,signalIndexName:null}),u=Object(ce.c)({contextId:r,eventId:t,field:e.field,fieldFormat:e.format,fieldFromBrowserField:a,fieldType:e.type,isObjectArray:e.isObjectArray,linkValue:n,values:o});return l?s.a.createElement(i.EuiLoadingSpinner,null):"number"==typeof c&&null!=u&&u.dataProviders&&null!=u&&u.dataProviders.length?s.a.createElement(le.a,{asEmptyButton:!0,dataProviders:u.dataProviders,filters:u.filters},s.a.createElement("span",{"data-test-subj":"alert-prevalence"},c)):Object(I.d)()};de.displayName="PrevalenceCell";const pe=[{field:"title",truncateText:!1,name:ee.o,textOnly:!0},{field:"description",truncateText:!1,render:se,name:ee.p}],me=[...pe,{field:"description",truncateText:!0,render:e=>s.a.createElement(de,e),name:s.a.createElement(s.a.Fragment,null,ee.m," ",s.a.createElement(i.EuiIconTip,{type:"iInCircle",color:"subdued",title:ee.m,content:s.a.createElement("span",null,ee.n)})),align:"right",width:"130px"}],ye={className:"flyoutTableHoverActions"},ge=({goToTable:e,rows:t,title:a,isReadOnly:n})=>{const r=n?pe:me;return s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,null,s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,a))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiLink,{onClick:e,"data-test-subj":"summary-view-go-to-table-link"},s.a.createElement(i.EuiText,{size:"xs"},ee.F)))),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(ae,{"data-test-subj":"summary-view",items:t,columns:r,rowProps:ye,compressed:!0}))},fe=s.a.memo(ge),be=({browserFields:e,data:t,eventId:a,isDraggable:n,scopeId:r,title:i,goToTable:o,isReadOnly:l,investigationFields:c})=>{const u=Object(te.c)({browserFields:e,data:t,eventId:a,isDraggable:n,scopeId:r,isReadOnly:l,investigationFields:c});return s.a.createElement(fe,{goToTable:o,isReadOnly:l,rows:u,title:i})},he=s.a.memo(be);var ve=a(441),Ee=a(728),xe=a(394),ke=a(59),we=a(172),Se=a(229);const je=ke.euiStyled.div`
  margin-left: ${({theme:e})=>e.eui.euiSizeS};
`,Oe=Object(ke.euiStyled)(i.EuiPanel)`
  &&& {
    background-color: ${({theme:e})=>e.eui.euiColorLightestShade};
    padding: ${({theme:e})=>e.eui.euiSizeS};
    height: 78px;
  }

  &:hover {
    .inlineActions {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
  }

  .inlineActions {
    opacity: 0;
    width: 0;
    transform: translate(6px);
    transition: transform 50ms ease-in-out;

    &.inlineActions-popoverOpen {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
   }
`,Ie=({title:e,children:t})=>s.a.createElement(Oe,{borderRadius:"none",hasShadow:!1,hasBorder:!1,paddingSize:"s"},s.a.createElement(i.EuiText,{size:"s"},e),s.a.createElement(i.EuiSpacer,{size:"s"}),t);Ie.displayName="OverviewCard";const Ce=ke.euiStyled.div`
  /* Clamp text content to 2 lines */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
`;Ce.displayName="ClampedContent";const Te=({title:e,children:t,contextId:a,dataTestSubj:n,enrichedFieldInfo:r})=>s.a.createElement(Ie,{title:e},s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(Ce,{"data-test-subj":n},t),s.a.createElement(je,null,s.a.createElement(D.c,{data:{field:r.data.field,value:null==r?void 0:r.values},triggerId:D.d.DETAILS_FLYOUT,mode:D.a.INLINE,sourcererScopeId:Object(q.getSourcererScopeId)(a),metadata:{scopeId:a},visibleCellActions:3}))));Te.displayName="OverviewCardWithActions";var Me=a(831),_e=a(298),Ne=a(984);const De=Object(ke.euiStyled)(i.EuiFlexGroup)`
  flex-grow: 0;
`,Ae=s.a.memo((({browserFields:e,contextId:t,data:a,eventId:n,handleOnEventClosed:r,scopeId:l,isReadOnly:c})=>{const u=Object(o.useMemo)((()=>{const r=Object(N.find)({field:Se.o,category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,a,n,l]),d=Object(o.useMemo)((()=>{const r=Object(N.find)({field:"kibana.alert.severity",category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,a,n,l]),p=Object(o.useMemo)((()=>{const r=Object(N.find)({field:"kibana.alert.risk_score",category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,a,n,l]),m=Object(o.useMemo)((()=>{const r=Object(N.find)({field:Se.n,category:"kibana"},a),i=Object(N.find)({field:"kibana.alert.rule.uuid",category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r,linkValueField:i})}),[e,t,a,n,l]),y=Fe(u)&&!c?s.a.createElement(i.EuiFlexItem,{key:"status"},s.a.createElement(Te,{title:we.P,enrichedFieldInfo:u,contextId:t},s.a.createElement(Me.a,{eventId:n,contextId:t,enrichedFieldInfo:u,scopeId:l,handleOnEventClosed:r}))):null,g=Fe(d)?s.a.createElement(i.EuiFlexItem,{key:"severity"},c?s.a.createElement(Ie,{title:we.w},s.a.createElement(_e.a,{value:d.values[0]})):s.a.createElement(Te,{title:we.w,enrichedFieldInfo:d,contextId:t},s.a.createElement(_e.a,{value:d.values[0]}))):null,f=Fe(p)?s.a.createElement(i.EuiFlexItem,{key:"riskScore"},c?s.a.createElement(Ie,{title:we.s},p.values[0]):s.a.createElement(Te,{title:we.s,enrichedFieldInfo:p,contextId:t,dataTestSubj:"riskScore"},p.values[0])):null,b=Fe(m)&&!c?s.a.createElement(i.EuiFlexItem,{key:"ruleName"},s.a.createElement(Te,{title:we.t,enrichedFieldInfo:m,contextId:t},s.a.createElement(F.a,{contextId:t,eventId:n,value:m.values[0],fieldName:m.data.field,linkValue:m.linkValue,fieldType:m.data.type,fieldFormat:m.data.format,isDraggable:!1,truncate:!1}))):null,{width:h,ref:v}=Object(Ne.a)(),E=0===h||h&&h>=675,x=[y,g,f,b].filter(qe),k=E?s.a.createElement(De,{gutterSize:"s"},x):s.a.createElement(s.a.Fragment,null,Object(N.chunk)(2,x).map(((e,t,{length:a})=>{const n=t<a-1;return s.a.createElement(o.Fragment,{key:t},s.a.createElement(De,{gutterSize:"s"},e),n&&s.a.createElement(i.EuiSpacer,{size:"s"}))})));return s.a.createElement("div",{ref:v},k)}));function Fe(e){return!!e&&Array.isArray(e.values)}function qe(e){return null!==e}Ae.displayName="Overview";var Le=a(813),Re=a(36),Pe=a(253);function ze(e){return Boolean(e&&e.values&&e.values.length)}var Be=a(16),$e=a(539);const Ge=Object(ke.euiStyled)(i.EuiAccordion)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
`,Ue=s.a.memo((({prefix:e,state:t,text:a,renderContent:n,onToggle:r=N.noop,extraAction:o,forceState:l})=>{const c=Object(i.useGeneratedHtmlId)({prefix:e});switch(t){case"loading":return s.a.createElement(Ge,{id:c,buttonContent:a,onToggle:r,isLoading:!0});case"error":return s.a.createElement(Ge,{id:c,buttonContent:s.a.createElement("span",null,s.a.createElement(i.EuiIcon,{type:"warning",color:"danger",style:{marginRight:"6px"}}),a),onToggle:r,extraAction:o});case"success":return s.a.createElement(Ge,{"tour-step":`${e}-accordion`,"data-test-subj":`${e}-accordion`,id:c,buttonContent:a,onToggle:r,paddingSize:"l",extraAction:o,forceState:l},n());default:return null}}));Ue.displayName="InsightAccordion";var Ve=a(151),He=a(381),We=a(380);const Ye=["*"],Ze=(e,t)=>({fields:t,_source:!1,query:{ids:{values:e}}}),Ke=["@timestamp","kibana.alert.rule.name","kibana.alert.severity"],Qe=[{field:"kibana.alert.rule.name",name:"Rule"},{field:"@timestamp",name:"@timestamp",render:e=>s.a.createElement(Ve.c,{value:new Date(e)})},{field:"kibana.alert.severity",name:"Severity",render:e=>s.a.createElement(_e.a,{value:e})}],Xe=s.a.memo((({alertIds:e})=>{const t=Object(o.useMemo)((()=>e.slice(0,10)),[e]),{loading:a,error:n,data:r}=(({alertIds:e,fields:t=Ye})=>{const[a]=Object(o.useState)((()=>Ze(e,t))),{loading:n,data:r,setQuery:i}=Object(He.a)({query:a,queryName:We.a.BY_ID});return Object(o.useEffect)((()=>{i(Ze(e,t))}),[i,e,t]),{loading:n,error:!n&&void 0===r,data:null==r?void 0:r.hits.hits}})({alertIds:t,fields:Ke}),l=Object(o.useMemo)((()=>{if(r)return r.map((e=>e.fields))}),[r]);if(a)return s.a.createElement(i.EuiSkeletonText,{lines:2});if(n)return s.a.createElement(s.a.Fragment,null,Pe.p);if(l){const t=e.length>10;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("div",null,s.a.createElement("em",null,Pe.q),s.a.createElement(i.EuiSpacer,null)),s.a.createElement(i.EuiBasicTable,{compressed:!0,items:l,columns:Qe}))}return null}));Xe.displayName="SimpleAlertTable";const Je=s.a.memo((({originalDocumentId:e,index:t,eventId:a,scopeId:n})=>{const[r,i]=Object(o.useState)(!1),[l,c]=Object(o.useState)({}),u=Object(o.useCallback)((e=>i(e)),[]),d=Object(o.useCallback)((()=>r?l.alertIds?s.a.createElement(tt,{eventId:a,scopeId:n,alertIds:l.alertIds}):s.a.createElement(et,{index:t,originalDocumentId:e,eventId:a,isActiveTimelines:Object(q.isActiveTimeline)(null!=n?n:""),onCacheLoad:c}):null),[r,l.alertIds,t,e,a,n]);return s.a.createElement(Ue,{prefix:"RelatedAlertsByProcessAncestry",state:"success",text:l.alertIds?Object(Pe.h)(l.alertIds.length):Pe.g,renderContent:d,onToggle:u})}));Je.displayName="RelatedAlertsByProcessAncestry";const et=({originalDocumentId:e,index:t,isActiveTimelines:a,onCacheLoad:n,eventId:r})=>{const{values:l}=t,{values:c}=e,u=Array.isArray(c)?c[0]:"",{loading:d,error:p,alertIds:m}=Object($e.a)({isActiveTimeline:a,documentId:u,indices:null!=l?l:[]});return Object(o.useEffect)((()=>{m&&0!==m.length&&n({alertIds:m})}),[m,n]),d?s.a.createElement(i.EuiLoadingSpinner,null):p?s.a.createElement(s.a.Fragment,null,Pe.j):m&&0!==m.length?null:s.a.createElement(s.a.Fragment,null,Pe.i)};et.displayName="FetchAndNotifyCachedAlertsByProcessAncestry";const tt=({alertIds:e,eventId:t,scopeId:a})=>{const n=e&&e.length&&e.length>=5,r=Object(o.useMemo)((()=>e&&e.length?n?null:e.reduce(((e,n,r)=>{const i=`${a}-${t}-event.id-${r}-${n}`;return e.push(Object(ce.a)("_id",i,n)),e}),[]):null),[e,n,a,t]),l=Object(o.useMemo)((()=>n?[{meta:{alias:Pe.k,type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null),[e,n]);return r||l?s.a.createElement(s.a.Fragment,null,s.a.createElement(Xe,{alertIds:e}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:r,filters:l,"data-test-subj":"investigate-ancestry-in-timeline"},we.i)):null};tt.displayName="ActualRelatedAlertsByProcessAncestry";var at=a(256),nt=a(118),rt=a(144),it=a(5);const ot=s.a.memo((({eventId:e})=>{const{services:{cases:t}}=Object(nt.j)(),a=Object(nt.n)(),[n,r]=Object(o.useState)(void 0),[i,l]=Object(o.useState)(!1),{activeStep:c,isTourShown:u}=Object(at.b)(),d=Object(o.useMemo)((()=>c===h.a.viewCase&&u(h.b.alertsCases)),[c,u]),p=Object(o.useCallback)((()=>function(e=[]){const t=e.length;return s.a.createElement("span",null,s.a.createElement(S.FormattedMessage,{defaultMessage:"This alert was found in {caseCount}",id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content",values:{caseCount:s.a.createElement("strong",null,s.a.createElement(S.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content_count",defaultMessage:"{caseCount} {caseCount, plural, =0 {cases.} =1 {case:} other {cases:}}",values:{caseCount:t}}))}}),e.map((({id:t,title:a},n)=>t&&a?s.a.createElement("span",{key:t}," ",s.a.createElement(rt.a,{detailName:t,title:a,index:n},a),e[n+1]?",":""):s.a.createElement(s.a.Fragment,null))))}(n)),[n]),[m,y]=Object(o.useState)(!1);Object(o.useEffect)((()=>{if(!m)return;let n=!1;return(async()=>{let i=[];try{var o;e&&(i=null!==(o=await t.api.getRelatedCases(e,{owner:it.j}))&&void 0!==o?o:[])}catch(e){n||l(!0),a.addWarning(Object(Pe.c)(e))}n||(r(i),y(!1))})(),()=>{n=!0}}),[t.api,e,m,a]),Object(o.useEffect)((()=>{y(!0)}),[e]);let g="loading";return i?g="error":n&&(g="success"),s.a.createElement(Ue,{prefix:"RelatedCases",state:g,text:st(g,null==n?void 0:n.length),renderContent:p,forceState:d?"open":void 0})}));function st(e,t=0){switch(e){case"loading":return Pe.d;case"error":return Pe.b;case"success":return Object(Pe.a)(t);default:return""}}ot.displayName="RelatedCases";const lt=s.a.memo((({browserFields:e,data:t,eventId:a,scopeId:n})=>{const{field:r,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:r,value:l,isActiveTimelines:Object(q.isActiveTimeline)(n),signalIndexName:null,includeAlertIds:!0}),{fieldFromBrowserField:p}=Object(re.b)({browserFields:e,contextId:n,eventId:a,field:{id:t.field},scopeId:n,item:t}),m=Object(ce.c)({field:r,values:l,contextId:n,eventId:a,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),y=0===u;let g="loading";c?g="error":d&&(g="success");const f=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?y&&"loading"!==g?Pe.s:s.a.createElement(s.a.Fragment,null,s.a.createElement(Xe,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},we.i)):null),[d,null==m?void 0:m.dataProviders,y,g]);return s.a.createElement(Ue,{prefix:"RelatedAlertsBySourceEvent",state:g,text:ct(g,u),renderContent:f})}));function ct(e,t){switch(e){case"loading":return Pe.u;case"error":return Pe.t;case"success":return Object(Pe.r)(t);default:return""}}lt.displayName="RelatedAlertsBySourceEvent";const ut=s.a.memo((({browserFields:e,data:t,eventId:a,scopeId:n})=>{const{field:r,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:r,value:l,isActiveTimelines:Object(q.isActiveTimeline)(n),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0}),{fieldFromBrowserField:p}=Object(re.b)({browserFields:e,contextId:n,eventId:a,field:{id:t.field},scopeId:n,item:t}),m=Object(ce.c)({field:r,values:l,contextId:n,eventId:a,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),y=0===u;let g="loading";c?g="error":(d||y)&&(g="success");const f=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?y&&"loading"!==g?Pe.m:s.a.createElement(s.a.Fragment,null,s.a.createElement(Xe,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},we.i)):null),[d,null==m?void 0:m.dataProviders,y,g]);return s.a.createElement(Ue,{prefix:"RelatedAlertsBySession",state:g,text:dt(g,u),renderContent:f})}));function dt(e,t){switch(e){case"loading":return Pe.o;case"error":return Pe.n;case"success":return Object(Pe.l)(t);default:return""}}ut.displayName="RelatedAlertsBySession";const pt=ke.euiStyled.div`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 12px;
  border-radius: 6px;
`,mt=Object(ke.euiStyled)(i.EuiIcon)`
  margin-right: 10px;
`,yt=s.a.memo((()=>{const{application:e}=Object(nt.j)().services;return s.a.createElement(pt,null,s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(mt,{size:"m",type:"lock"})),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiLink,{color:"subdued",target:"_blank",href:e.getUrlForApp("management",{path:"stack/license_management/home"})},Pe.f)))))}));yt.displayName="RelatedAlertsUpsell";const gt=Object(ke.euiStyled)(i.EuiFlexItem)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
  display: inline-flex;
`,ft=s.a.memo((({browserFields:e,eventId:t,data:a,isReadOnly:n,scopeId:r})=>{const{cases:o}=Object(nt.j)().services,l=Object(Be.b)().isPlatinumPlus(),c=Object(N.find)({category:"kibana",field:"kibana.alert.ancestors.id"},a),u=Object(N.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},a),d=Object(N.find)({category:"agent",field:"agent.type"},a),p=Object(N.find)({category:"event",field:"event.module"},a),m=ze(Object(N.find)({category:"process",field:"process.entity_id"},a))&&function(e,t){return ze(e)&&("endpoint"===e.values[0]||"winlogbeat"===e.values[0]&&ze(t)&&"sysmon"===t.values[0])}(d,p),y=Object(N.find)({category:"process",field:"process.entry_leader.entity_id"},a),g=ze(y),f=Object(N.find)({category:"kibana",field:"kibana.alert.original_event.id"},a),b=ze(f),h=Object(N.find)({category:"kibana",field:Le.t},a),v=ze(h),E=o.helpers.canUseCases([Re.APP_ID]).read,x=m&&c&&u;return n||!(E||m||b||g)?null:s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,Pe.e))),v&&s.a.createElement(gt,null,s.a.createElement("div",null,s.a.createElement(i.EuiIcon,{type:"layers",style:{marginLeft:"4px",marginRight:"8px"}}),Pe.v(parseInt(h.values[0],10)),s.a.createElement(i.EuiBetaBadge,{label:Pe.w,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}))),E&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(ot,{eventId:t})),f&&f.values&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(lt,{browserFields:e,data:f,eventId:t,scopeId:r})),y&&y.values&&s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-session"},s.a.createElement(ut,{browserFields:e,data:y,eventId:t,scopeId:r})),x&&(l?s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-ancestry"},s.a.createElement(Je,{originalDocumentId:c,index:u,eventId:t,scopeId:r})):s.a.createElement(i.EuiFlexItem,null,s.a.createElement(yt,null)))))}));ft.displayName="Insights";var bt=a(313);const ht={cursorStart:0,querySize:1};var vt=a(299),Et=a(150),xt=a(304),kt=a(729);let wt=function(e){return e.tableView="table-view",e.jsonView="json-view",e.summaryView="summary-view",e.threatIntelView="threat-intel-view",e.osqueryView="osquery-results-view",e.responseActionsView="response-actions-results-view",e}({});const St=c()(i.EuiTabbedContent).withConfig({displayName:"StyledEuiTabbedContent",componentId:"sc-xa1bmm-0"})(["display:flex;flex:1;flex-direction:column;overflow:hidden;> [role='tabpanel']{display:flex;flex:1;flex-direction:column;overflow:hidden;overflow-y:auto;::-webkit-scrollbar{-webkit-appearance:none;width:7px;}::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,0.5);-webkit-box-shadow:0 0 1px rgba(255,255,255,0.5);}}"]),jt=c.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-xa1bmm-1"})(["height:100%;position:relative;"]),Ot=c.a.div.withConfig({displayName:"RendererContainer",componentId:"sc-xa1bmm-2"})(["overflow-x:auto;padding-right:",";& ."," .euiFlexGroup{justify-content:flex-start;}"],(e=>e.theme.eui.euiSizeXS),Et.a),It=c()(i.EuiFlexGroup).withConfig({displayName:"ThreatTacticContainer",componentId:"sc-xa1bmm-3"})(["flex-grow:0;flex-wrap:nowrap;& .euiFlexGroup{flex-wrap:nowrap;}"]),Ct=c.a.div.withConfig({displayName:"ThreatTacticDescription",componentId:"sc-xa1bmm-4"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeL)),Tt=({browserFields:e,data:t,detailsEcsData:a,id:n,isAlert:l,isDraggable:c,rawEventData:E,scopeId:x,timelineTabType:w,handleOnEventClosed:S,isReadOnly:j})=>{var I;const[C,T]=Object(o.useState)(wt.summaryView),M=Object(o.useCallback)((e=>T(e.id)),[]),_=Object(o.useCallback)((()=>T(wt.tableView)),[]),N=Object(o.useMemo)((()=>Object(A.c)(t)),[t]),D=Object(d.b)(t),{rule:F}=Object(p.a)(D.ruleId),q=Object(o.useMemo)((()=>l?Object(A.g)(t).map((e=>Object(A.h)(e))):[]),[t,l]),{result:L,loading:R,setRange:P,range:z}=Object(ve.c)(N),B=Object(o.useMemo)((()=>Object(g.a)(E)),[E]),$=Object(o.useMemo)((()=>R||null==L||!L.enrichments?q:Object(A.b)([...q,...L.enrichments])),[R,L,q]),G=$.length,{hostRisk:U,userRisk:V,isAuthorized:H}=(e=>{const{hostName:t,userName:a}=Object(d.b)(e),n=Object(o.useMemo)((()=>t?Object(O.z)([t]):void 0),[t]),{data:r,loading:i,isAuthorized:s,isModuleEnabled:l}=Object(bt.a)({filterQuery:n,pagination:ht,riskEntity:O.t.host,skip:!n}),c=Object(o.useMemo)((()=>({loading:i,isModuleEnabled:l,result:r})),[r,i,l]),u=Object(o.useMemo)((()=>a?Object(O.A)([a]):void 0),[a]),{data:p,loading:m,isAuthorized:y,isModuleEnabled:g}=Object(bt.a)({filterQuery:u,pagination:ht,riskEntity:O.t.user,skip:!u});return{userRisk:Object(o.useMemo)((()=>({loading:m,isModuleEnabled:g,result:p})),[m,g,p]),hostRisk:c,isAuthorized:s&&y}})(t),W=Object(o.useMemo)((()=>null!=a?Object(vt.a)({data:a,rowRenderers:xt.b}):null),[a]),Y=Object(o.useMemo)((()=>Object(b.c)(x)),[x]),Z=Object(o.useMemo)((()=>G>0||H&&(U||V)),[G,U,H,V]),K=Object(y.a)("endpointResponseActionsEnabled"),Q=Object(o.useMemo)((()=>{var r,o;return l?{id:wt.summaryView,name:ee.v,"data-test-subj":"overviewTab",content:s.a.createElement(f.a,{isTourAnchor:Y,step:h.a.reviewAlertDetailsFlyout,tourId:h.b.alertsCases},s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(Ae,{browserFields:e,contextId:x,data:t,eventId:n,scopeId:x,handleOnEventClosed:S,isReadOnly:j}),s.a.createElement(i.EuiSpacer,{size:"l"}),B&&B[0]&&s.a.createElement(It,{alignItems:"flexStart",direction:"column",wrap:!1,gutterSize:"none"},s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiTitle,{size:"xxs"},s.a.createElement("h5",null,B[0].title)),s.a.createElement(Ct,null,B[0].description))),s.a.createElement(i.EuiSpacer,{size:"l"}),null!=W&&null!=a&&s.a.createElement("div",null,s.a.createElement(i.EuiTitle,{size:"xs"},s.a.createElement("h5",null,ee.c)),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(Ot,{"data-test-subj":"renderer"},W.renderRow({contextId:"event-details",data:a,isDraggable:null!=c&&c,scopeId:x}))),s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(he,{data:t,eventId:n,browserFields:e,isDraggable:c,scopeId:x,title:ee.l,isReadOnly:j,goToTable:_,investigationFields:null!==(r=null==F||null===(o=F.investigation_fields)||void 0===o?void 0:o.field_names)&&void 0!==r?r:[]}),s.a.createElement(i.EuiSpacer,{size:"xl"}),s.a.createElement(ft,{browserFields:e,eventId:n,data:t,scopeId:x,isReadOnly:j}),Z&&s.a.createElement(X,{isDraggable:c,hostRisk:U,userRisk:V,browserFields:e,data:t,eventId:n,scopeId:x,enrichments:$,isReadOnly:j}),R&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSkeletonText,{lines:2})),D.ruleId&&(null==F?void 0:F.note)&&s.a.createElement(xe.b,{basicData:D,ruleNote:F.note})))}:void 0}),[l,Y,e,x,t,n,S,j,B,W,a,c,_,null==F||null===(I=F.investigation_fields)||void 0===I?void 0:I.field_names,null==F?void 0:F.note,Z,U,V,$,R,D]),te=Object(o.useMemo)((()=>l&&!j?{id:wt.threatIntelView,"data-test-subj":"threatIntelTab",name:ee.C,append:s.a.createElement(s.a.Fragment,null,R?s.a.createElement(i.EuiLoadingSpinner,null):s.a.createElement(i.EuiNotificationBadge,{"data-test-subj":"enrichment-count-notification"},G)),content:s.a.createElement(J.a,{before:s.a.createElement(i.EuiSpacer,{size:"m"}),loading:R,enrichments:$,showInvestigationTimeEnrichments:!Object(u.isEmpty)(N)},s.a.createElement(s.a.Fragment,null,s.a.createElement(Ee.a,{setRange:P,loading:R,range:z}),s.a.createElement(i.EuiSpacer,{size:"m"})))}:void 0),[$,P,z,G,l,N,R,j]),ae=Object(o.useMemo)((()=>({id:wt.tableView,"data-test-subj":"tableTab",name:ee.B,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"l"}),s.a.createElement(v.a,{browserFields:e,data:t,eventId:n,isDraggable:c,scopeId:x,timelineTabType:w,isReadOnly:j}))})),[e,t,n,c,x,w,j]),ne=Object(o.useMemo)((()=>({id:wt.jsonView,"data-test-subj":"jsonViewTab",name:ee.r,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(jt,{"data-test-subj":"jsonViewWrapper"},s.a.createElement(k,{rawEventData:E})))})),[E]),re=Object(m.a)({rawEventData:E,...null!==a?{ecsData:a}:{}}),ie=Object(kt.a)({rawEventData:E,...null!==a?{ecsData:a}:{}}),oe=Object(o.useMemo)((()=>K?[re]:[ie]),[K,ie,re]),se=Object(o.useMemo)((()=>[Q,te,ae,ne,...oe].filter((e=>!!e))),[Q,te,ae,ne,oe]),le=Object(o.useMemo)((()=>{var e;return null!==(e=se.find((e=>e.id===C)))&&void 0!==e?e:se[0]}),[se,C]),ce=Object(o.useMemo)((()=>Y?{"tour-step":Object(h.c)(3,h.b.alertsCases)}:{}),[Y]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(St,r()({},ce,{"data-test-subj":"eventDetails",tabs:se,selectedTab:le,onTabClick:M,key:"event-summary-tabs"})))};Tt.displayName="EventDetailsComponent";const Mt=s.a.memo(Tt)},698:function(e,t,a){"use strict";a.d(t,"a",(function(){return W}));var n=a(2),r=a.n(n),i=a(19),o=a(45),s=a(41),l=a.n(s),c=a(149),u=a(622),d=a(131),p=a(664),m=a(129),y=a(206),g=a(118),f=a(355),b=a(180),h=a(949),v=a(559),E=a(44),x=a(839),k=a(4);const w=k.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.pinSelected",{defaultMessage:"Pin selected"}),S=k.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectAll",{defaultMessage:"All"}),j=k.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectNone",{defaultMessage:"None"}),O=k.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectPinned",{defaultMessage:"Pinned"}),I=k.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectUnpinned",{defaultMessage:"Unpinned"}),C=k.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.unpinSelected",{defaultMessage:"Unpin selected"}),T=l.a.div.withConfig({displayName:"InputDisplay",componentId:"sc-oi2e53-0"})(["width:5px;"]);T.displayName="InputDisplay";const M=l.a.div.withConfig({displayName:"PinIconContainer",componentId:"sc-oi2e53-1"})(["margin-right:5px;"]);M.displayName="PinIconContainer";const _=l.a.div.withConfig({displayName:"PinActionItem",componentId:"sc-oi2e53-2"})(["display:flex;flex-direction:row;"]);_.displayName="PinActionItem";const N=r.a.memo((({text:e})=>r.a.createElement(i.EuiText,{size:"s",color:"subdued"},e)));N.displayName="DropdownDisplay";const D=Object(s.createGlobalStyle)([".eventsSelectItem{width:100% !important;.euiContextMenu__icon{display:none !important;}}.eventsSelectDropdown{width:","px;}"],60),A=l.a.div.withConfig({displayName:"CheckboxContainer",componentId:"sc-1giocnz-0"})(["position:relative;"]);A.displayName="CheckboxContainer";const F=l.a.div.withConfig({displayName:"PositionedCheckbox",componentId:"sc-1giocnz-1"})(["left:7px;position:absolute;top:-28px;"]);F.displayName="PositionedCheckbox";const q=r.a.memo((({checkState:e,timelineId:t})=>r.a.createElement("div",{"data-test-subj":"events-select"},r.a.createElement(i.EuiSuperSelect,{className:"eventsSelectDropdown","data-test-subj":"events-select-dropdown",itemClassName:"eventsSelectItem",onChange:E.noop,options:[{inputDisplay:r.a.createElement(T,null),disabled:!0,dropdownDisplay:r.a.createElement(N,{text:S}),value:"select-all"},{inputDisplay:r.a.createElement(T,null),disabled:!0,dropdownDisplay:r.a.createElement(N,{text:j}),value:"select-none"},{inputDisplay:r.a.createElement(T,null),disabled:!0,dropdownDisplay:r.a.createElement(N,{text:O}),value:"select-pinned"},{inputDisplay:r.a.createElement(T,null),disabled:!0,dropdownDisplay:r.a.createElement(N,{text:I}),value:"select-unpinned"},{inputDisplay:r.a.createElement(T,null),disabled:!0,dropdownDisplay:r.a.createElement(_,null,r.a.createElement(M,null,r.a.createElement(x.a,{allowUnpinning:!0,isAlert:!1,pinned:!0})),r.a.createElement(N,{text:w})),value:"pin-selected"},{inputDisplay:r.a.createElement(T,null),disabled:!0,dropdownDisplay:r.a.createElement(_,null,r.a.createElement(M,null,r.a.createElement(x.a,{allowUnpinning:!0,isAlert:!1,pinned:!1})),r.a.createElement(N,{text:C})),value:"unpin-selected"}]}),r.a.createElement(A,{"data-test-subj":"timeline-events-select-checkbox-container"},r.a.createElement(F,{"data-test-subj":"timeline-events-select-positioned-checkbox"},r.a.createElement(i.EuiCheckbox,{checked:"checked"===e,"data-test-subj":"events-select-checkbox",disabled:!0,id:`timeline-${t}-events-select`,indeterminate:"indeterminate"===e,onChange:E.noop}))),r.a.createElement(D,null))));q.displayName="EventsSelect";var L=a(594),R=a(122),P=a(124),z=a(169);const B=l.a.div.withConfig({displayName:"SortingColumnsContainer",componentId:"sc-1ls1217-0"})(["button{color:",";}.euiPopover .euiButtonEmpty{padding:0;.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>e.eui.euiColorPrimary)),$=l.a.div.withConfig({displayName:"FieldBrowserContainer",componentId:"sc-1ls1217-1"})([".euiToolTipAnchor{.euiButtonContent{padding:",";}button{color:",";}.euiButtonContent__icon{width:16px;height:16px;}.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>`0 ${e.eui.euiSizeXS}`),(({theme:e})=>e.eui.euiColorPrimary)),G=l.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1ls1217-2"})(["align-items:center;display:flex;"]),U={},V=[],H=Object(n.memo)((({width:e,browserFields:t,columnHeaders:a,isEventViewer:s=!1,isSelectAllChecked:l,onSelectAll:E,showEventsSelect:x,showSelectAllCheckbox:k,showFullScreenToggle:w=!0,sort:S,tabType:j,timelineId:O,fieldBrowserOptions:I})=>{const{triggersActionsUi:C}=Object(g.j)().services,{globalFullScreen:T,setGlobalFullScreen:M}=Object(y.a)(),{timelineFullScreen:_,setTimelineFullScreen:N}=Object(y.c)(),D=Object(o.useDispatch)(),A=Object(R.a)("unifiedComponentsInTimelineDisabled"),{defaultColumns:F}=Object(P.a)((e=>Object(z.selectTimelineById)(e,O))),H=Object(n.useCallback)((()=>{O===c.f.active?N(!_):M(!T)}),[O,N,_,M,T]),W=Object(n.useMemo)((()=>Object(u.b)({globalFullScreen:T,isActiveTimelines:Object(d.isActiveTimeline)(O),timelineFullScreen:_})),[T,_,O]),Y=Object(n.useCallback)((e=>{E({isSelected:e.currentTarget.checked})}),[E]),Z=Object(n.useCallback)((e=>D(m.a.updateSort({id:O,sort:e.map((({id:e,direction:t})=>{var n,r;const i=a.find((t=>t.id===e)),o=null!==(n=null==i?void 0:i.type)&&void 0!==n?n:"",s=null!==(r=null==i?void 0:i.esTypes)&&void 0!==r?r:[];return{columnId:e,columnType:o,esTypes:s,sortDirection:t}}))}))),[a,D,O]),K=Object(n.useMemo)((()=>{var e;return{onSort:Z,columns:null!==(e=null==S?void 0:S.map((({columnId:e,sortDirection:t})=>({id:e,direction:t}))))&&void 0!==e?e:[]}}),[Z,S]),Q=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.reduce(((e,t)=>{var a;return{...e,[t.id]:null!==(a=t.displayAsText)&&void 0!==a?a:t.id}}),{}))&&void 0!==e?e:{}}),[a]),X=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.map((({aggregatable:e,displayAsText:t,id:a,type:n})=>({id:a,isSortable:e,displayAsText:t,schema:n}))))&&void 0!==e?e:[]}),[a]),J=Object(n.useCallback)((()=>{D(m.a.updateColumns({id:O,columns:F}))}),[F,D,O]),ee=Object(n.useCallback)((e=>{a.some((({id:t})=>t===e))?D(m.a.removeColumn({columnId:e,id:O})):D(m.a.upsertColumn({column:Object(p.a)(e,F),id:O,index:1}))}),[a,D,O,F]),te=Object(i.useDataGridColumnSorting)({columns:X,sorting:K,schema:U,schemaDetectors:V,displayValues:Q});return r.a.createElement(G,{"data-test-subj":"header-actions-container"},k&&r.a.createElement(b.o,{role:"checkbox"},r.a.createElement(b.p,{textAlign:"center",width:f.b},r.a.createElement(i.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:l,onChange:Y}))),I&&r.a.createElement(b.o,{role:"button"},r.a.createElement($,null,C.getFieldBrowser({browserFields:t,columnIds:a.map((({id:e})=>e)),onResetColumns:J,onToggleColumn:ee,options:I}))),A&&r.a.createElement(b.o,{role:"button"},r.a.createElement(h.a,{timelineId:O})),w&&r.a.createElement(b.o,{role:"button"},r.a.createElement(b.p,{textAlign:"center",width:f.b},r.a.createElement(i.EuiToolTip,{content:W?v.a:L.d},r.a.createElement(i.EuiButtonIcon,{"aria-label":Object(u.b)({globalFullScreen:T,isActiveTimelines:Object(d.isActiveTimeline)(O),timelineFullScreen:_})?v.a:L.d,display:W?"fill":"empty",color:"primary","data-test-subj":Object(d.isActiveTimeline)(O)?"full-screen-active":"full-screen",iconType:"fullScreen",onClick:H})))),j!==c.g.eql&&A&&r.a.createElement(b.o,{role:"button","data-test-subj":"timeline-sorting-fields"},r.a.createElement(b.p,{textAlign:"center",width:f.b},r.a.createElement(i.EuiToolTip,{content:L.l},r.a.createElement(B,null,te)))),x&&r.a.createElement(b.o,{role:"button"},r.a.createElement(b.p,{textAlign:"center",width:f.b},r.a.createElement(q,{checkState:"unchecked",timelineId:O}))))}));H.displayName="HeaderActionsComponent";const W=r.a.memo(H)},728:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(54),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(244),c=a(195);const u=({range:e,setRange:t,loading:a})=>{const[n,u]=Object(i.useState)(e.from===c.a?r()().subtract(30,"d"):r()(e.from)),[d,p]=Object(i.useState)(e.to===c.b?r()():r()(e.to)),m=Object(i.useCallback)((()=>{n&&d&&n.isBefore(d)&&t({from:n.toISOString(),to:d.toISOString()})}),[d,t,n]),y=Object(i.useMemo)((()=>null==n?void 0:n.isBefore(d)),[n,d]);return o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiDatePickerRange,{"data-test-subj":"enrichment-query-range-picker",startDateControl:o.a.createElement(s.EuiDatePicker,{className:"start-picker",selected:n,onChange:u,startDate:n,endDate:d,isInvalid:!y,"aria-label":l.d,showTimeSelect:!0}),endDateControl:o.a.createElement(s.EuiDatePicker,{className:"end-picker",selected:d,onChange:p,startDate:n,endDate:d,isInvalid:!y,"aria-label":l.c,showTimeSelect:!0})})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButton,{iconType:"refresh",onClick:m,isLoading:a,"data-test-subj":"enrichment-button",isDisabled:!y},l.n)))}},729:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(19),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(262),c=a(122),u=a(118),d=a(695),p=a(197),m=a(247);const y=s.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-woclj6-0"})(["height:100%;position:relative;"]),g=({rawEventData:e,ecsData:t})=>{var a,r,o,s,g,f,b,h,v;const{services:{osquery:E}}=Object(u.j)(),x=Object(c.a)("responseActionsEnabled"),k=Object(c.a)("endpointResponseActionsEnabled"),w=e?Object(l.a)(e.fields):void 0,S=null==w||null===(a=w.kibana)||void 0===a||null===(r=a.alert)||void 0===r||null===(o=r.rule)||void 0===o||null===(s=o.parameters)||void 0===s?void 0:s[0].response_actions,j=!e||!x||k||!t||!(null!=S&&S.length),O=null!==(g=null==e?void 0:e._id)&&void 0!==g?g:"",{OsqueryResults:I,fetchAllLiveQueries:C}=E,{data:T}=C({kuery:`alert_ids: ( ${O} )`,alertId:O,skip:j});if(j)return;const M=S.filter((e=>e.action_type_id===m.b[".osquery"]));if(null==M||!M.length)return;const _=(null==T?void 0:T.data.items)||[],N=null==w||null===(f=w.kibana)||void 0===f||null===(b=f.alert)||void 0===b||null===(h=b.rule)||void 0===h||null===(v=h.name)||void 0===v?void 0:v[0],D=i.a.createElement(y,{"data-test-subj":"osqueryViewWrapper"},i.a.createElement(I,{ruleName:N,actionItems:_,ecsData:t}),i.a.createElement(n.EuiSpacer,{size:"s"}));return{id:d.b.osqueryView,"data-test-subj":"osqueryViewTab",name:p.u,append:i.a.createElement(n.EuiNotificationBadge,{"data-test-subj":"osquery-actions-notification"},_.length),content:D}}},730:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(838),o=a(172),s=a(377);const l=({ariaLabel:e=o.j,ecsRowData:t,buttonType:a,onInvestigateInTimelineAlertClick:n})=>{const{investigateInTimelineAlertClick:l}=Object(s.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:n});return r.a.createElement(i.a,{ariaLabel:e,content:o.i,dataTestSubj:"send-alert-to-timeline",iconType:"timeline",onClick:l,isDisabled:!1,buttonType:a})},c=r.a.memo(l)},731:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return l}));var n=a(247);const r=({group:e,id:t,action_type_id:a,params:n,uuid:r,frequency:i,alerts_filter:o})=>({group:e,id:t,params:n,actionTypeId:a,...o&&{alertsFilter:o},...r&&{uuid:r},...i&&{frequency:i}}),i=({group:e,id:t,actionTypeId:a,params:n,uuid:r,frequency:i,alertsFilter:o})=>({group:e,id:t,params:n,action_type_id:a,...o&&{alerts_filter:o},...r&&{uuid:r},...i&&{frequency:i}}),o=({group:e,id:t,params:a,frequency:n,alertsFilter:r})=>({group:e,id:t,params:a,...r&&{alerts_filter:r},...n&&{frequency:n}}),s=({action_type_id:e,params:t})=>{if(e===n.b[".osquery"]){const{saved_query_id:a,ecs_mapping:n,pack_id:r,...i}=t;return{params:{...i,savedQueryId:a,ecsMapping:n,packId:r},actionTypeId:e}}return{params:t,actionTypeId:e}},l=({actionTypeId:e,params:t})=>{if(e===n.b[".osquery"]){const{savedQueryId:a,ecsMapping:n,packId:r,...i}=t;return{params:{...i,saved_query_id:a,ecs_mapping:n,pack_id:r},action_type_id:e}}return{params:t,action_type_id:e}}},732:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"c",(function(){return y})),a.d(t,"d",(function(){return g}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),s=(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addCustomHighlightedFieldDescription",{defaultMessage:"Add a custom highlighted field"}),n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"})),l=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.setupHelpText",{defaultMessage:"Add rule setup guide..."})},733:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(4);n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"}),n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"});const r=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"}),i=(n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExceptionsTab",{defaultMessage:"Rule exceptions"})),o=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.endpointExceptionsTab",{defaultMessage:"Endpoint exceptions"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionResultsTab",{defaultMessage:"Execution results"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionEventsTab",{defaultMessage:"Execution events"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deleteRuleConfirmationBody",{defaultMessage:'This action will delete the rule. Click "Delete" to continue.'})},734:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(42),l=a(19),c=a(41),u=a.n(c),d=a(482);const p=u()(l.EuiButtonEmpty).withConfig({displayName:"EuiButtonEmptyStyled",componentId:"sc-1h0vyjj-0"})(["margin-bottom:",";.euiIcon{width:",";height:",";}.text{font-size:",";margin-inline-start:",";}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),m=Object(i.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:a,...n})=>{const i=Object(d.a)(...a);return o.a.createElement(p,r()({"data-test-subj":"backToOrigin"},n,{flush:"left",size:"xs",iconType:"arrowLeft",href:t,onClick:i,textProps:{className:"text"}}),e||o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));m.displayName="BackToExternalAppButton"},735:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"k",(function(){return o})),a.d(t,"n",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"m",(function(){return d})),a.d(t,"p",(function(){return p})),a.d(t,"o",(function(){return m})),a.d(t,"c",(function(){return y})),a.d(t,"r",(function(){return g})),a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"q",(function(){return h})),a.d(t,"i",(function(){return v})),a.d(t,"l",(function(){return E})),a.d(t,"h",(function(){return x}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"}),i=n.i18n.translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"}),o=n.i18n.translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"}),s=n.i18n.translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),l=n.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),c=n.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskLevel",{defaultMessage:"Host risk level"}),u=n.i18n.translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),d=n.i18n.translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"}),p=n.i18n.translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"}),m=n.i18n.translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"}),y=n.i18n.translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"}),g=n.i18n.translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"}),f=n.i18n.translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"}),b=n.i18n.translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"}),h=n.i18n.translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"}),v=n.i18n.translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"}),E=n.i18n.translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"}),x=n.i18n.translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"})},736:function(e,t,a){"use strict";a.d(t,"i",(function(){return r})),a.d(t,"h",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"j",(function(){return y}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.user.details.overview.userIdTitle",{defaultMessage:"User ID"}),i=n.i18n.translate("xpack.securitySolution.user.details.overview.userDomainTitle",{defaultMessage:"Domain"}),o=n.i18n.translate("xpack.securitySolution.user.details.overview.familyTitle",{defaultMessage:"Family"}),s=n.i18n.translate("xpack.securitySolution.user.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),l=n.i18n.translate("xpack.securitySolution.user.details.overview.osTitle",{defaultMessage:"Operating system"}),c=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),u=n.i18n.translate("xpack.securitySolution.user.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),d=n.i18n.translate("xpack.securitySolution.user.details.overview.inspectTitle",{defaultMessage:"User overview"}),p=n.i18n.translate("xpack.securitySolution.user.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),m=n.i18n.translate("xpack.securitySolution.user.details.overview.userRiskScoreTitle",{defaultMessage:"User risk score"}),y=n.i18n.translate("xpack.securitySolution.user.details.overview.userRiskLevel",{defaultMessage:"User risk level"})},738:function(e,t,a){"use strict";a.d(t,"a",(function(){return Pe}));var n=a(2),r=a.n(n),i=a(45),o=a(19),s=a(1799),l=a(131),c=a(129),u=a(158),d=a(146),p=a(124),m=a(1866),y=a(41),g=a.n(y),f=a(188),b=a.n(f),h=a(1550),v=a(533),E=a(965),x=a(922),k=a(1209),w=a(776),S=a(1247),j=a(175),O=a(724),I=a(342),C=a(197),T=a(960);const M=g()(o.EuiPanel).withConfig({displayName:"FlyoutFooterContainerPanel",componentId:"sc-1y4op3v-0"})([".side-panel-flyout-footer{background-color:transparent;}"]),_=()=>({promptContextId:void 0}),N=({browserFields:e,entityType:t="events",expandedEvent:a,handleOnEventClosed:i,isDraggable:s,isFlyoutView:l,runtimeMappings:c,tabType:u,scopeId:d,isReadOnly:p})=>{var y,g;const{hasAssistantPrivilege:f,isAssistantEnabled:b}=Object(v.a)(),N=f?m.a:_,D=Object(O.a)(),{indexName:A}=a,F=null!==(y=Object(j.a)(A,D))&&void 0!==y?y:A,[q,L,R,P,z]=Object(k.a)({entityType:t,indexName:null!=F?F:"",eventId:null!==(g=a.eventId)&&void 0!==g?g:"",runtimeMappings:c,skip:!a.eventId}),B=Object(h.a)(null==R?void 0:R.fields),{isolateAction:$,isHostIsolationPanelOpen:G,isIsolateActionSuccessBannerVisible:U,handleIsolationActionSuccess:V,showAlertDetails:H,showHostIsolationPanel:W}=Object(w.a)(),{alertId:Y,isAlert:Z,hostName:K,ruleName:Q,timestamp:X}=Object(j.b)(L),J=Object(n.useMemo)((()=>l?C.A:C.D),[l]),ee=Object(n.useCallback)((async()=>Object(E.d)(null!=L?L:[])),[L]),{promptContextId:te}=N(Z?"alert":"event",Z?C.e:C.i,Z?Object(C.d)(J):Object(C.h)(J),ee,null,Z?T.b[T.c].suggestedUserPrompt:T.b[T.e].suggestedUserPrompt,Z?C.f:C.j,b),ae=Object(n.useMemo)((()=>l||G?r.a.createElement(S.c,{eventId:a.eventId,eventIndex:F,isHostIsolationPanelOpen:G,isAlert:Z,isolateAction:$,loading:q,ruleName:Q,showAlertDetails:H,timestamp:X,promptContextId:te,scopeId:d,refetchFlyoutData:z,getFieldsData:B}):r.a.createElement(x.b,{eventId:a.eventId,eventIndex:F,isAlert:Z,loading:q,ruleName:Q,timestamp:X,handleOnEventClosed:i,promptContextId:te,scopeId:d,refetchFlyoutData:z,getFieldsData:B})),[l,G,a.eventId,F,Z,$,q,Q,H,X,te,i,d,z,B]),ne=Object(n.useMemo)((()=>l?r.a.createElement(S.a,{alertId:Y,browserFields:e,detailsData:L,detailsEcsData:P,event:a,hostName:K,handleIsolationActionSuccess:V,handleOnEventClosed:i,isAlert:Z,isDraggable:s,isolateAction:$,isIsolateActionSuccessBannerVisible:U,isHostIsolationPanelOpen:G,loading:q,rawEventData:R,showAlertDetails:H,scopeId:d,isReadOnly:p}):G?r.a.createElement(r.a.Fragment,null,U&&r.a.createElement(I.d,{hostName:K,alertId:Y,isolateAction:$}),r.a.createElement(o.EuiFlyoutBody,null,r.a.createElement(I.f,{details:L,cancelCallback:H,successCallback:V,isolateAction:$}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(x.a,{browserFields:e,detailsData:L,detailsEcsData:P,event:a,isAlert:Z,isDraggable:s,loading:q,rawEventData:R,scopeId:d,timelineTabType:u,handleOnEventClosed:i}))),[Y,e,L,P,a,V,i,K,Z,s,l,G,U,p,$,q,R,H,u,d]);return null!=a&&a.eventId?r.a.createElement(r.a.Fragment,null,ae,ne,r.a.createElement(M,{hasShadow:!1,borderRadius:"none"},r.a.createElement(S.b,{detailsData:L,detailsEcsData:P,refetchFlyoutData:z,handleOnEventClosed:i,isHostIsolationPanelOpen:G,isReadOnly:p,loadingEventDetails:q,onAddIsolationStatusClick:W,scopeId:d}))):null},D=r.a.memo(N,((e,t)=>b()(e.browserFields,t.browserFields)&&b()(e.expandedEvent,t.expandedEvent)&&e.scopeId===t.scopeId&&e.isDraggable===t.isDraggable));var A=a(4),F=a(925),q=a(138),L=a(144),R=a(161),P=a(132),z=a(792),B=a(249),$=a(450),G=a(561),U=a(419),V=a(570);const H=g.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1xbsnt9-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),W=({hostName:e})=>r.a.createElement(o.EuiTitle,{size:"s"},r.a.createElement(H,{"data-test-subj":"host-details-header"},A.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.title",{defaultMessage:"Host details"}),`: ${e}`)),Y=({hostName:e})=>r.a.createElement(L.d,{hostName:e,isButton:!0},A.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.hostDetailsPageLink",{defaultMessage:"View details page"})),Z=({contextID:e,scopeId:t,hostName:a,isDraggable:o=!1})=>{const{to:s,from:l,isInitializing:c}=Object(R.a)(),{selectedPatterns:u}=Object(P.a)(),d=Object(i.useDispatch)(),[p,{hostDetails:m}]=Object(V.b)({endDate:s,hostName:a,indexNames:u,startDate:l}),y=Object(n.useCallback)(((e,t)=>{const a=Object(U.a)(e,t);d(Object(B.setAbsoluteRangeDatePicker)({id:q.a.global,from:a.from,to:a.to}))}),[d]);return r.a.createElement($.a,{criteriaFields:Object(G.a)(m),startDate:l,endDate:s,skip:c},(({isLoadingAnomaliesData:n,anomaliesData:i,jobNameById:c})=>r.a.createElement(z.b,{contextID:e,scopeId:t,id:V.a,isInDetailsSidePanel:!0,data:m,anomaliesData:i,isDraggable:o,isLoadingAnomaliesData:n,indexNames:u,loading:p,startDate:l,endDate:s,narrowDateRange:y,hostName:a,jobNameById:c})))},K=g()(o.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1i9mt5q-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;margin-bottom:64px;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 0px`)),Q=g()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1i9mt5q-1"})(["flex:1 0 auto;"]),X=g()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1i9mt5q-2"})(["align-self:flex-start;flex:1 0 auto;"]),J=g.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1i9mt5q-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),ee=r.a.memo((({contextID:e,scopeId:t,expandedHost:a,handleOnHostClosed:i,isDraggable:s,isFlyoutView:l})=>{const{hostName:c}=a,u=Object(n.useMemo)((()=>({name:c,type:"host"})),[c]);return c?l?r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(W,{hostName:c})),r.a.createElement(K,null,r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(Y,{hostName:c}),r.a.createElement(o.EuiHorizontalRule,null),r.a.createElement(F.a,{entity:u}),r.a.createElement(Z,{contextID:e,scopeId:t,hostName:c}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{justifyContent:"spaceBetween",wrap:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(W,{hostName:c})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonIcon,{iconType:"cross","aria-label":A.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.close",{defaultMessage:"close"}),onClick:i}))),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(X,{grow:!1},r.a.createElement(Y,{hostName:c})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(F.a,{entity:u}),r.a.createElement(J,null,r.a.createElement(Z,{contextID:e,scopeId:t,hostName:c,isDraggable:s}))):null}));var te=a(55),ae=a(534),ne=a(1472),re=a(1473),ie=a(118),oe=a(250),se=a(148),le=a(1493),ce=a(392),ue=a(1327),de=a(562),pe=a(604);const me=g.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1jm2ava-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),ye=({ip:e})=>r.a.createElement(o.EuiTitle,{size:"s"},r.a.createElement(me,null,A.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.title",{defaultMessage:"Network details"}),`: ${e}`)),ge=({expandedNetwork:{ip:e,flowTarget:t}})=>r.a.createElement(L.h,{ip:e,flowTarget:t,isButton:!0},A.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.networkDetailsPageLink",{defaultMessage:"View details page"})),fe=({contextID:e,expandedNetwork:t,isDraggable:a})=>{const{ip:o,flowTarget:s}=t,l=Object(i.useDispatch)(),{to:c,from:u,isInitializing:d}=Object(R.a)(),m=Object(n.useMemo)((()=>se.d.globalQuerySelector()),[]),y=Object(n.useMemo)((()=>se.d.globalFiltersQuerySelector()),[]),g=Object(p.a)(m),f=Object(p.a)(y),b=ce.c.NetworkType.details,h=Object(n.useCallback)(((e,t)=>{const a=Object(U.a)(e,t);l(Object(B.setAbsoluteRangeDatePicker)({id:q.a.global,from:a.from,to:a.to}))}),[l]),{services:{uiSettings:v}}=Object(ie.j)(),{indicesExist:E,indexPattern:x,selectedPatterns:k}=Object(P.a)(),[w,S]=Object(oe.i)({config:Object(te.getEsQueryConfig)(v),indexPattern:x,queries:[g],filters:f}),[j,{id:O,networkDetails:I}]=Object(le.b)({skip:d||void 0===w,filterQuery:w,indexNames:k,ip:o});Object(ae.a)({id:O,filterQuery:w,kqlError:S,query:g,startDate:u,endDate:c});const{jobNameById:C}=Object(de.a)(),T=Object(n.useMemo)((()=>Object.keys(C)),[C]),[M,_]=Object(ue.a)({criteriaFields:Object(re.a)(o,s),startDate:u,endDate:c,skip:d,jobIds:T,aggregationInterval:"auto"});return E?r.a.createElement(ne.a,{contextID:e,id:O,ip:o,data:I,anomaliesData:_,loading:j,isInDetailsSidePanel:!0,isLoadingAnomaliesData:M,isDraggable:a,type:b,flowTarget:s,startDate:u,endDate:c,narrowDateRange:h,indexPatterns:k,jobNameById:C}):r.a.createElement(pe.a,null)},be=g()(o.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1tify25-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),he=g()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1tify25-1"})(["flex:1 0 auto;"]),ve=g()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1tify25-2"})(["align-self:flex-start;flex:1 0 auto;"]),Ee=g.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1tify25-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),xe=r.a.memo((({contextID:e,expandedNetwork:t,handleOnNetworkClosed:a,isFlyoutView:n,isDraggable:i})=>{const{ip:s}=t;return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(ye,{ip:s})),r.a.createElement(be,null,r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(ge,{expandedNetwork:t}),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(fe,{contextID:e,expandedNetwork:t}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(he,{justifyContent:"spaceBetween",wrap:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(ye,{ip:s})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonIcon,{iconType:"cross","aria-label":A.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:a}))),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(ve,{grow:!1},r.a.createElement(ge,{expandedNetwork:t})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(Ee,null,r.a.createElement(fe,{contextID:e,expandedNetwork:t,isDraggable:i})))}));var ke=a(785),we=a(548),Se=a(1401),je=a(321);const Oe=g.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-19b6yfb-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),Ie=({userName:e})=>r.a.createElement(o.EuiTitle,{size:"s"},r.a.createElement(Oe,null,A.i18n.translate("xpack.securitySolution.timeline.sidePanel.userDetails.title",{defaultMessage:"User details"}),`: ${e}`)),Ce=({userName:e})=>r.a.createElement(L.m,{userName:e,isButton:!0},A.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.userDetails",{defaultMessage:"View details page"})),Te=({contextID:e,scopeId:t,userName:a,isDraggable:o})=>{const{to:s,from:l,isInitializing:c}=Object(R.a)(),{selectedPatterns:u}=Object(P.a)(),d=Object(i.useDispatch)(),[p,{userDetails:m}]=Object(we.b)({endDate:s,startDate:l,userName:a,indexNames:u,skip:c}),y=Object(n.useCallback)(((e,t)=>{const a=Object(U.a)(e,t);d(Object(B.setAbsoluteRangeDatePicker)({id:q.a.global,from:a.from,to:a.to}))}),[d]);return r.a.createElement($.a,{criteriaFields:Object(Se.a)(je.UsersType.details,a),startDate:l,endDate:s,skip:c},(({isLoadingAnomaliesData:n,anomaliesData:i,jobNameById:c})=>r.a.createElement(ke.b,{userName:a,isInDetailsSidePanel:!0,data:m,loading:p,contextID:e,scopeId:t,isDraggable:o,id:"usersDetailsQuery",anomaliesData:i,isLoadingAnomaliesData:n,startDate:l,endDate:s,narrowDateRange:y,indexPatterns:u,jobNameById:c})))},Me=g()(o.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-iwngk-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),_e=({contextID:e,scopeId:t,userName:a})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(Ie,{userName:a})),r.a.createElement(Me,null,r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(Ce,{userName:a}),r.a.createElement(o.EuiHorizontalRule,null),r.a.createElement(F.a,{entity:{type:"user",name:a}}),r.a.createElement(Te,{contextID:e,scopeId:t,userName:a}))),Ne=g()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-190swzt-0"})(["flex:1 0 auto;"]),De=g()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-190swzt-1"})(["align-self:flex-start;flex:1 0 auto;"]),Ae=g.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-190swzt-2"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),Fe=({contextID:e,scopeId:t,userName:a,isDraggable:i,handleOnClose:s})=>{const l=Object(n.useMemo)((()=>({name:a,type:"user"})),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ne,{justifyContent:"spaceBetween",wrap:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(Ie,{userName:a})),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonIcon,{iconType:"cross","aria-label":A.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:s}))),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(De,{grow:!1},r.a.createElement(Ce,{userName:a})),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(F.a,{entity:l}),r.a.createElement(Ae,null,r.a.createElement(Te,{contextID:e,scopeId:t,userName:a,isDraggable:i})))},qe=({contextID:e,scopeId:t,userName:a,handleOnClose:n,isFlyoutView:i,isDraggable:o})=>i?r.a.createElement(_e,{userName:a,contextID:e,scopeId:t}):r.a.createElement(Fe,{userName:a,contextID:e,isDraggable:o,handleOnClose:n,scopeId:t}),Le=r.a.memo(qe),Re={zIndex:1001},Pe=r.a.memo((({browserFields:e,entityType:t,handleOnPanelClosed:a,isFlyoutView:m,runtimeMappings:y,tabType:g,scopeId:f,isReadOnly:b})=>{var h,v,E,x;const k=Object(i.useDispatch)(),w=Object(n.useMemo)((()=>Object(l.isTimelineScope)(f)?c.b.getTimelineByIdSelector():Object(l.isInTableScope)(f)?s.b.getTableByIdSelector():void 0),[f]),S=Object(p.a)((e=>{var t,a;return null===(t=null!==(a=w&&w(e,f))&&void 0!==a?a:u.b)||void 0===t?void 0:t.expandedDetail}));Object(n.useEffect)((()=>()=>{k(s.a.toggleDetailPanel({id:f}))}),[k,f]);const j=Object(n.useCallback)((()=>{const e=Object(l.getScopedActions)(f);e&&k(e.toggleDetailPanel({id:f}))}),[k,f]),O=null!=g?g:d.d.query,I=Object(n.useCallback)((()=>{a?a():j()}),[j,a]);if(!S)return null;const C=S[O];if(null==C||!C.panelView)return null;let T=null,M="s",_=f;const N=`${f}-${O}`,A=f===d.c.active&&O===d.d.query;return"eventDetail"===(null==C?void 0:C.panelView)&&null!=C&&null!==(h=C.params)&&void 0!==h&&h.eventId&&(M="m",_=C.params.eventId,T=r.a.createElement(D,{browserFields:e,entityType:t,expandedEvent:null==C?void 0:C.params,handleOnEventClosed:I,isDraggable:A,isFlyoutView:m,runtimeMappings:y,tabType:O,scopeId:f,isReadOnly:b})),"hostDetail"===(null==C?void 0:C.panelView)&&null!=C&&null!==(v=C.params)&&void 0!==v&&v.hostName&&(_=C.params.hostName,T=r.a.createElement(ee,{contextID:N,expandedHost:null==C?void 0:C.params,handleOnHostClosed:I,isDraggable:A,isFlyoutView:m,scopeId:f})),"userDetail"===(null==C?void 0:C.panelView)&&null!=C&&null!==(E=C.params)&&void 0!==E&&E.userName&&(_=C.params.userName,T=r.a.createElement(Le,{contextID:N,userName:C.params.userName,handleOnClose:I,isDraggable:A,isFlyoutView:m,scopeId:f})),"networkDetail"===(null==C?void 0:C.panelView)&&null!=C&&null!==(x=C.params)&&void 0!==x&&x.ip&&(_=C.params.ip,T=r.a.createElement(xe,{contextID:N,expandedNetwork:null==C?void 0:C.params,handleOnNetworkClosed:I,isDraggable:A,isFlyoutView:m})),m?r.a.createElement(o.EuiFlyout,{"data-test-subj":"timeline:details-panel:flyout",size:M,style:Re,onClose:I,ownFocus:!1,key:_},T):T}));Pe.displayName="DetailsPanel"},740:function(e,t,a){"use strict";a.d(t,"a",(function(){return D}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(19),l=a(42),c=a(153),u=a(140),d=a(47),p=a(3),m=a(7),y=a(167),g=a(262);let f=function(e){return e.asc="asc",e.desc="desc",e}({}),b=function(e){return e.actions="responseActions",e.results="responseActionsResults",e}({});var h=a(118);var v=a(1100),E=a(197),x=a(771);const k=({type:e})=>{const t=Object(n.useMemo)((()=>{if("endpoint"===e)return{icon:"logoSecurity",name:"Elastic Defend"}}),[e]);return r.a.createElement(s.EuiEmptyPrompt,{iconType:t.icon,title:r.a.createElement("h2",null,x.b),titleSize:"xs",body:r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.responseActions.results.missingPrivileges",defaultMessage:"To access these results, ask your administrator for {integration} Kibana privileges.",values:{integration:r.a.createElement(s.EuiCode,null,t.name)}})})},w=({action:e,ruleName:t})=>{const{agent:a}=e,{action_id:i,expiration:o}=e.EndpointActions,{endpointPrivileges:{canAccessEndpointActionsLogManagement:c}}=Object(u.a)(),[m,g]=Object(n.useState)(!0),{data:E}=((e,{enabled:t,action:a,isLive:n=!1})=>{const{data:r}=Object(h.j)().services,{expiration:i,actionId:o,agent:s}=e;return Object(d.useQuery)({queryKey:["allResponsesResults",{actionId:o}],queryFn:async()=>{var e,t,a;const n=await Object(p.lastValueFrom)(r.search.search({actionId:o,expiration:i,sort:{order:f.desc,field:"@timestamp"},agents:(Array.isArray(s.id)?s.id:[s.id]).length,factoryQueryType:b.results},{strategy:y.n}));return{action_id:o,completedAt:null===(e=n.edges[0])||void 0===e||null===(t=e.fields)||void 0===t||null===(a=t["EndpointActions.completed_at"])||void 0===a?void 0:a[0],isExpired:n.isExpired,wasSuccessful:n.wasSuccessful,isCompleted:n.isCompleted,status:n.status}},select:e=>((e,t)=>{var a;const{rule:n}=e,{parameters:r,alert_id:i,comment:o,command:s,hosts:l}=e.EndpointActions.data;return{id:e.EndpointActions.action_id,agents:Array.isArray(e.agent.id)?e.agent.id:[e.agent.id],agentType:"endpoint",parameters:r,...null!=i&&i.length?{alertIds:i}:{},...n?{ruleId:n.id,ruleName:n.name}:{},createdBy:(null===(a=e.rule)||void 0===a?void 0:a.name)||"unknown",comment:o,command:s,hosts:l,startedAt:e["@timestamp"],completedAt:null==t?void 0:t.completedAt,isCompleted:!(null==t||!t.isCompleted),isExpired:!(null==t||!t.isExpired),wasSuccessful:"successful"===t.status,status:t.status,agentState:{},errors:e.error?[e.error.message]:void 0}})(a,e),keepPreviousData:!0,enabled:t,refetchInterval:!!n&&5e3})})({actionId:i,expiration:o,agent:a},{enabled:c,action:e,isLive:m});Object(n.useEffect)((()=>{g((()=>{var e;return!E||!(null!==(e=E.errors)&&void 0!==e&&e.length)&&"pending"===E.status}))}),[E]);const x=E?S(E):"",w=Object(n.useMemo)((()=>null!=E&&E.hosts?Object.values(E.hosts)[0].name:""),[null==E?void 0:E.hosts]);return r.a.createElement(s.EuiComment,{username:t,timestamp:r.a.createElement(l.FormattedRelative,{value:e["@timestamp"]}),event:x,"data-test-subj":"endpoint-results-comment"},c?E?r.a.createElement(v.a,{action:E,fromAlertWorkaround:!0,"data-test-subj":`response-results-${w}`}):r.a.createElement(s.EuiLoadingSpinner,null):r.a.createElement(k,{type:"endpoint"}))},S=e=>{var t;return null!==(t=e.errors)&&void 0!==t&&t.length?E.g.failed(e.command):"pending"===e.status?E.g.pending(e.command):"successful"===e.status?E.g.executed(e.command):E.g.tried(e.command)},j=r.a.memo((({actions:e,ruleName:t,ecsData:a})=>{const{services:{osquery:i}}=Object(h.j)(),{OsqueryResult:o}=i,l=Object(n.useCallback)((e=>{if(O(e)){const n=e.action_id,i=e["@timestamp"];return r.a.createElement(o,{key:n,actionId:n,startDate:i,ruleName:t,ecsData:a})}return I(e)?r.a.createElement(w,{action:e,ruleName:t,key:e.EndpointActions.action_id}):null}),[o,a,t]);return r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),l(e),r.a.createElement(s.EuiSpacer,{size:"s"})))))}));j.displayName="ResponseActionsResults";const O=e=>!(!e||!("input_type"in e)||"osquery"!==(null==e?void 0:e.input_type)),I=e=>{var t;return!(!e||!("EndpointActions"in e)||"endpoint"!==(null==e||null===(t=e.EndpointActions)||void 0===t?void 0:t.input_type))};var C=a(695),T=a(122);const M=o.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-1y7ogme-0"})(["height:100%;position:relative;"]),_=o.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-1y7ogme-1"})(["display:inline-block;line-height:1.7em;"]),N=()=>r.a.createElement(_,{"data-test-subj":c.K},r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataDescription",defaultMessage:"There are no response actions defined for this event. To add some, edit the rule's settings and set up {link}.",values:{link:r.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-create.html#rule-response-action",target:"_blank"},r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataLinkText",defaultMessage:"response actions"}))}})),D=({rawEventData:e,ecsData:t})=>{var a,i,o,l,c;const u=Object(n.useMemo)((()=>({id:C.b.responseActionsView,"data-test-subj":"responseActionsViewTab",name:E.y})),[]),v=Object(T.a)("endpointResponseActionsEnabled"),x=e?Object(g.a)(e.fields):void 0,k=null==x||null===(a=x.kibana)||void 0===a||null===(i=a.alert)||void 0===i||null===(o=i.rule)||void 0===o||null===(l=o.parameters)||void 0===l?void 0:l[0].response_actions,w=!e||!v,S=null!==(c=null==e?void 0:e._id)&&void 0!==c?c:"",[O,I]=Object(n.useState)(!1),{data:_,isFetched:D}=((e,{enabled:t,isLive:a})=>{const{data:n}=Object(h.j)().services,{alertIds:r}=e;return Object(d.useQuery)({queryKey:["actions",{alertId:r[0]}],queryFn:async()=>{const e=await Object(p.lastValueFrom)(n.search.search({alertIds:r,sort:{order:f.desc,field:"@timestamp"},factoryQueryType:b.actions},{strategy:y.n})),t=Object(m.map)(Object(m.filter)(e.edges,"fields"),(e=>Object(g.a)(e.fields,!0)));return{...e,items:Object(m.compact)(t)}},enabled:t,refetchInterval:!!a&&5e3,keepPreviousData:!0})})({alertIds:[S]},{enabled:!w,isLive:O});if(Object(n.useEffect)((()=>{I((()=>{var e;return!(null==k||!k.length||null!=_&&null!==(e=_.items)&&void 0!==e&&e.length)}))}),[_,null==k?void 0:k.length]),w)return{...u,content:r.a.createElement(N,null)};{var A,F,q,L,R;const e=null==x||null===(A=x.kibana)||void 0===A||null===(F=A.alert)||void 0===F||null===(q=F.rule)||void 0===q||null===(L=q.name)||void 0===L?void 0:L[0],a=null!==(R=null==_?void 0:_.items)&&void 0!==R?R:[];return{...u,append:r.a.createElement(s.EuiNotificationBadge,{"data-test-subj":"response-actions-notification"},a.length),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(M,{"data-test-subj":"responseActionsViewWrapper"},D&&a.length?r.a.createElement(j,{actions:a,ruleName:e,ecsData:t}):r.a.createElement(N,null)))}}}},741:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(19),r=a(2),i=a.n(r),o=a(7),s=a(195),l=a(244),c=a(336);const u=e=>Object(c.f)(e)?l.j:l.g,d=({type:e})=>i.a.createElement(n.EuiToolTip,{content:u(e)},i.a.createElement(n.EuiIcon,{type:"iInCircle",size:"m"}));var p=a(41),m=a.n(p);const y=m.a.div.withConfig({displayName:"OverflowParent",componentId:"sc-sjnml3-0"})(["display:inline-grid;"]),g=m.a.div.withConfig({displayName:"OverflowContainer",componentId:"sc-sjnml3-1"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold;"]),f=({field:e="",feedName:t="",value:a=""})=>{const r=`${e} ${a}${t?` ${l.e} ${t}`:""}`;return i.a.createElement(n.EuiToolTip,{content:a},i.a.createElement(y,{"data-test-subj":"enrichment-button-content"},i.a.createElement(g,null,r)))},b=m.a.h5.withConfig({displayName:"StyledH5",componentId:"sc-1i38kio-0"})(["line-height:1.7rem;"]),h=e=>i.a.createElement(n.EuiTitle,{size:"xxxs"},i.a.createElement(b,null,e));h.displayName="ThreatSummaryTitle";var v=a(181),E=a(441);const x=m()(n.EuiInMemoryTable).withConfig({displayName:"ThreatSummaryTable",componentId:"sc-1pwinz3-0"})([".euiTableHeaderCell,.euiTableRowCell{border:none;}.euiTableHeaderCell .euiTableCellContent{padding:0;}"]),k=m()(n.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-mlcc85-0"})([".euiAccordion__triggerWrapper{background:",";border-radius:",";height:",";margin-bottom:",";padding-left:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXL),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),w=[{field:"title",truncateText:!1,render:h,width:"220px",name:""},{field:"description",truncateText:!1,render:({fieldName:e,value:t})=>{const a=e.match(s.p)?i.a.createElement(n.EuiLink,{href:t,target:"_blank"},t):i.a.createElement("span",null,t);return i.a.createElement(n.EuiToolTip,{"data-test-subj":"message-tool-tip",content:i.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement("span",null,e)))},a)},name:""}],S=({enrichment:e,index:t})=>{const{id:a="threat-details-item",field:r,feedName:o,type:s,value:u}=Object(c.d)(e),d=`${a}${r}`;return i.a.createElement(k,{id:d,key:d,initialIsOpen:!0,arrowDisplay:"right",buttonContent:i.a.createElement(f,{field:r,feedName:o,value:u}),extraAction:Object(c.f)(s)&&i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(v.b,{queryId:E.a,title:l.i}))},i.a.createElement(x,{columns:w,compressed:!0,"data-test-subj":`threat-details-view-${t}`,items:Object(c.a)(e)}))},j=({enrichments:e})=>i.a.createElement(i.a.Fragment,null,e.sort(((e,t)=>Object(c.e)(t)-Object(c.e)(e))).map(((t,a)=>i.a.createElement(i.a.Fragment,{key:`${t.id}`},i.a.createElement(S,{enrichment:t,index:a}),a<e.length-1&&i.a.createElement(n.EuiSpacer,{size:"m"})))));var O=a(42);const I=m.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-oksmx3-0"})(["display:inline-block;line-height:1.7em;"]),C=({type:e})=>e?i.a.createElement(I,{"data-test-subj":"no-enrichments-found"},e===s.c.IndicatorMatchRule?l.l:i.a.createElement(O.FormattedMessage,{id:"xpack.securitySolution.enrichment.noInvestigationEnrichment",defaultMessage:"Additional threat intelligence wasn't found within the selected time frame. Try a different time frame, or {link} to collect threat intelligence for threat detection and matching.",values:{link:i.a.createElement(n.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/es-threat-intel-integrations.html",target:"_blank"},i.a.createElement(O.FormattedMessage,{id:"xpack.securitySolution.enrichment.investigationEnrichmentDocumentationLink",defaultMessage:"enable threat intelligence integrations"}))}})):null,T=({type:e})=>e?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"baseline"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiTitle,{size:"xxxs"},i.a.createElement("h3",null,e===s.c.IndicatorMatchRule?l.f:l.h))),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(d,{type:e}))),i.a.createElement(n.EuiSpacer,{size:"s"})):null,M=({enrichments:e,type:t,loading:a,dataTestSubj:r,children:o})=>i.a.createElement("div",{"data-test-subj":r},i.a.createElement(T,{type:t}),o,Array.isArray(e)?i.a.createElement(j,{enrichments:e}):i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{type:t}),a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(n.EuiSkeletonText,{"data-test-subj":"loading-enrichments",lines:4})))),_=({enrichments:e,before:t=null,showInvestigationTimeEnrichments:a,loading:r,children:l})=>{const{[s.c.IndicatorMatchRule]:c,[s.c.InvestigationTime]:u,undefined:d}=Object(o.groupBy)(e,"matched.type");return i.a.createElement(i.a.Fragment,null,t,i.a.createElement(M,{dataTestSubj:"threat-match-detected",enrichments:c,type:s.c.IndicatorMatchRule}),a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiHorizontalRule,null),i.a.createElement(M,{dataTestSubj:"enriched-with-threat-intel",enrichments:u,type:s.c.InvestigationTime,loading:r},l)),d&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiHorizontalRule,null),c&&i.a.createElement(n.EuiSpacer,{size:"l"}),i.a.createElement(M,{enrichments:d,dataTestSubj:"matches-with-no-type"})))},N=i.a.memo(_)},771:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(4);const r=n.i18n.translate("xpack.securitySolution.osquery.action.shortEmptyTitle",{defaultMessage:"Osquery is not available"}),i=n.i18n.translate("xpack.securitySolution.osquery.action.permissionDenied",{defaultMessage:"Permission denied"}),o=n.i18n.translate("xpack.securitySolution.osquery.action.unavailable",{defaultMessage:"The Osquery Manager integration is not added to the agent policy. To run queries on the host, add the Osquery Manager integration to the agent policy in Fleet."})},772:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(233),l=a(1451);function c({type:e,label:t=e,"data-test-subj":a,...n}){return o.a.createElement(l.a,r()({},function(e){switch(e){case s.a._ID:case s.a._INDEX:return{type:"keyword"};case s.a.OBJECT:return{type:e,iconType:"tokenObject"};case s.a.DATE_NANOS:return{type:"date"};case s.a.FLOAT:case s.a.HALF_FLOAT:case s.a.SCALED_FLOAT:case s.a.DOUBLE:case s.a.INTEGER:case s.a.LONG:case s.a.SHORT:case s.a.UNSIGNED_LONG:case s.a.AGGREGATE_METRIC_DOUBLE:case s.a.FLOAT_RANGE:case s.a.DOUBLE_RANGE:case s.a.INTEGER_RANGE:case s.a.LONG_RANGE:case s.a.BYTE:case s.a.TOKEN_COUNT:return{type:"number"};default:return{type:e}}}(e),{label:t,"data-test-subj":a},n))}},773:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(19),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(1294),c=a.n(l);const u=s()(n.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroupStyles",componentId:"sc-rh40g1-0"})([".euiFlexItem{margin-bottom:0px;}"]),d=s()(n.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-rh40g1-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),p=s()(n.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-rh40g1-2"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),m=({threat:e,"data-test-subj":t="threat"})=>{const[o,s]=Object(r.useState)([]),[l,m]=Object(r.useState)([]),[y,g]=Object(r.useState)([]);return Object(r.useEffect)((()=>{!async function(){const e=await a.e(24).then(a.bind(null,1481));g(e.subtechniques),s(e.techniques),m(e.tactics)}()}),[]),i.a.createElement(u,{direction:"column","data-test-subj":t},e.map(((e,t)=>{const a=l.find((t=>t.id===e.tactic.id));return i.a.createElement(n.EuiFlexItem,{key:`${e.tactic.name}-${t}`},i.a.createElement(n.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=a?a.label:`${e.tactic.name} (${e.tactic.id})`),i.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var a;const r=o.find((t=>t.id===e.id));return i.a.createElement(n.EuiFlexItem,{key:null!==(a=null==r?void 0:r.id)&&void 0!==a?a:t},i.a.createElement(p,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=r?r.label:`${e.name} (${e.id})`),i.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var a;const n=y.find((t=>t.id===e.id));return i.a.createElement(d,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},i.a.createElement(p,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`))}))))}))))})))}},775:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(124),i=a(131),o=a(148);const s=({scopeId:e})=>{const t=Object(n.useMemo)((()=>o.d.globalQuery()),[]),a=Object(n.useMemo)((()=>o.d.timelineQueryByIdSelector()),[]),{globalQuery:s,timelineQuery:l}=Object(r.a)((n=>({globalQuery:t(n),timelineQuery:a(n,e)})));return{refetch:Object(n.useCallback)((()=>{const t=e=>{e.forEach((e=>e.refetch&&e.refetch()))};Object(i.isActiveTimeline)(e)?t([l]):t(s)}),[e,l,s])}}},776:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(823);const i={isolateAction:"isolateHost",isHostIsolationPanelOpen:!1,isIsolateActionSuccessBannerVisible:!1};function o(e,t){switch(t.type){case"setIsolateAction":return{...e,isolateAction:t.isolateAction};case"setIsHostIsolationPanel":return{...e,isHostIsolationPanelOpen:t.isHostIsolationPanelOpen};case"setIsIsolateActionSuccessBannerVisible":return{...e,isIsolateActionSuccessBannerVisible:t.isIsolateActionSuccessBannerVisible};default:throw new Error}}const s=()=>{const[{isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:a},s]=Object(n.useReducer)(o,i),l=Object(n.useCallback)((()=>{s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!1}),s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!1})}),[]),c=Object(n.useCallback)((e=>{"isolateHost"!==e&&"unisolateHost"!==e||(s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!0}),s({type:"setIsolateAction",isolateAction:e}))}),[]),u=Object(r.b)(),d=Object(n.useCallback)((()=>{s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!0}),u&&u.refreshCase()}),[u]);return Object(n.useMemo)((()=>({isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:a,handleIsolationActionSuccess:d,showAlertDetails:l,showHostIsolationPanel:c})),[t,a,e,d,l,c])}},777:function(e,t,a){"use strict";a.d(t,"U",(function(){return r})),a.d(t,"n",(function(){return i})),a.d(t,"M",(function(){return o})),a.d(t,"p",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"bb",(function(){return u})),a.d(t,"N",(function(){return d})),a.d(t,"u",(function(){return p})),a.d(t,"s",(function(){return m})),a.d(t,"t",(function(){return y})),a.d(t,"r",(function(){return g})),a.d(t,"q",(function(){return f})),a.d(t,"db",(function(){return b})),a.d(t,"R",(function(){return h})),a.d(t,"cb",(function(){return v})),a.d(t,"P",(function(){return E})),a.d(t,"Q",(function(){return x})),a.d(t,"fb",(function(){return k})),a.d(t,"v",(function(){return w})),a.d(t,"S",(function(){return S})),a.d(t,"Y",(function(){return j})),a.d(t,"ab",(function(){return O})),a.d(t,"Z",(function(){return I})),a.d(t,"H",(function(){return C})),a.d(t,"I",(function(){return T})),a.d(t,"G",(function(){return M})),a.d(t,"K",(function(){return _})),a.d(t,"J",(function(){return N})),a.d(t,"F",(function(){return D})),a.d(t,"E",(function(){return A})),a.d(t,"O",(function(){return F})),a.d(t,"c",(function(){return q})),a.d(t,"L",(function(){return L})),a.d(t,"T",(function(){return R})),a.d(t,"d",(function(){return P})),a.d(t,"m",(function(){return z})),a.d(t,"o",(function(){return B})),a.d(t,"g",(function(){return $})),a.d(t,"f",(function(){return G})),a.d(t,"l",(function(){return U})),a.d(t,"j",(function(){return V})),a.d(t,"k",(function(){return H})),a.d(t,"h",(function(){return W})),a.d(t,"i",(function(){return Y})),a.d(t,"e",(function(){return Z})),a.d(t,"eb",(function(){return K})),a.d(t,"X",(function(){return Q})),a.d(t,"V",(function(){return X})),a.d(t,"W",(function(){return J})),a.d(t,"w",(function(){return ee})),a.d(t,"C",(function(){return te})),a.d(t,"A",(function(){return ae})),a.d(t,"z",(function(){return ne})),a.d(t,"B",(function(){return re})),a.d(t,"D",(function(){return ie})),a.d(t,"x",(function(){return oe})),a.d(t,"y",(function(){return se}));var n=a(4);n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"});const r=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.showingExceptionLists",{values:{totalLists:e},defaultMessage:"Showing {totalLists} {totalLists, plural, =1 {list} other {lists}}"}),i=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"})),o=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Shared Exception Lists"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableSubtitle",{defaultMessage:"To view rule specific exceptions navigate to that rule's details page."}),u=e=>n.i18n.translate("xpack.securitySolution.exceptions.allExceptionsRowPerPage",{defaultMessage:"Rows per page: {rowSize}",values:{rowSize:e}}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),p=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.export_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" exported successfully'}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),y=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.duplicate_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" duplicated successfully'}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.duplicateError",{defaultMessage:"Exception list duplication error"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),b=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),h=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),v=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDefaultDescription",{defaultMessage:"Are you sure you wish to DELETE exception list with the name {listName}?",values:{listName:e}}),E=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),x=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),k=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:e}}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.searchPlaceholder",{defaultMessage:"Search by name or list_id:id"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.refresh",{defaultMessage:"Refresh"}),j=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsImportButton",{defaultMessage:"Import list"}),O=n.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccessTitle",{defaultMessage:"Exception list imported"}),I=n.i18n.translate("xpack.securitySolution.lists.exceptionListUploadError",{defaultMessage:"There was an error uploading the exception list."}),C=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.importExceptionList",{defaultMessage:"Import exception list"}),T=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutHeader",{defaultMessage:"Import shared exception list"}),M=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutBody",{defaultMessage:"Select shared exception lists to import"}),_=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListWarning",{defaultMessage:"We found a pre-existing list with that id"}),N=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListOverwrite",{defaultMessage:"Overwrite the existing list"}),D=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListAsNewList",{defaultMessage:"Create new list"}),A=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionEndpointListWarning",{defaultMessage:"Multiple exception lists for Endpoint Security are not allowed."}),F=n.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"}),q=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsCloseImportFlyout",{defaultMessage:"Close"}),L=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsFilePickerPrompt",{defaultMessage:"Select or drag and drop multiple files"}),R=n.i18n.translate("xpack.securitySolution.exceptionsTable.rulesCountLabel",{defaultMessage:"Rules"}),P=n.i18n.translate("xpack.securitySolution.exceptionsTable.createdBy",{defaultMessage:"Created By"}),z=n.i18n.translate("xpack.securitySolution.exceptionsTable.createdAt",{defaultMessage:"Date created"}),B=n.i18n.translate("xpack.securitySolution.exceptionsTable.exceptionsCountLabel",{defaultMessage:"Exceptions"}),$=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createSharedListButton",{defaultMessage:"Create shared list"}),G=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createItemButton",{defaultMessage:"Create exception item"}),U=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListTitle",{defaultMessage:"Create shared exception list"}),V=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameField",{defaultMessage:"Shared exception list name"}),H=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameFieldPlaceholder",{defaultMessage:"New exception list"}),W=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescription",{defaultMessage:"Description (optional)"}),Y=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescriptionPlaceholder",{defaultMessage:"New exception list description"}),Z=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutCreateButton",{defaultMessage:"Create shared exception list"}),K=e=>n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessDescription",{defaultMessage:"List with name {listName} was created!",values:{listName:e}}),Q=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessTitle",{defaultMessage:"Created list"}),X=n.i18n.translate("xpack.securitySolution.exceptions.sortBy",{defaultMessage:"Sort by:"}),J=n.i18n.translate("xpack.securitySolution.exceptions.sortByCreateAt",{defaultMessage:"Created At"}),ee=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalCancelButton",{defaultMessage:"Cancel"}),te=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalExportTitle",{defaultMessage:"Export exception list?"}),ae=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalDuplicateTitle",{defaultMessage:"Duplicate exception list?"}),ne=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeDuplicateDescription",{defaultMessage:"You’re duplicating an exception list. Switch the toggle off to exclude expired exceptions."}),re=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeExportDescription",{defaultMessage:"You’re exporting an exception list. Switch the toggle off to exclude expired exceptions."}),ie=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeSwitchLabel",{defaultMessage:"Include expired exceptions"}),oe=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmDuplicateButton",{defaultMessage:"Duplicate"}),se=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmExportButton",{defaultMessage:"Export"})},778:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(19),o=a(43);const s={name:"qeawqx",styles:"max-height:300px;height:100%;overflow-x:hidden;overflow-y:auto"},l=({text:e,dataTestSubj:t,actions:a,disableActions:r,emptyButton:l,useCustomActions:c,iconType:u,iconSide:d="left",anchorPosition:p="downCenter",panelPaddingSize:m="s"})=>{const[y,g]=Object(n.useState)(!1),f=()=>g((e=>!e)),b=()=>g(!1),h=Object(n.useMemo)((()=>c||null===a?a:a.map((e=>Object(o.jsx)(i.EuiContextMenuItem,{"data-test-subj":`${t||""}ActionItem${e.key}`,key:e.key,icon:e.icon,disabled:e.disabled,layoutAlign:"center",onClick:t=>{b(),"function"==typeof e.onClick&&e.onClick(t)}},e.label)))),[a,t,c]);return Object(o.jsx)(i.EuiFlexGroup,{responsive:!0},Object(o.jsx)(i.EuiPopover,{button:l?Object(o.jsx)(i.EuiButtonEmpty,{isDisabled:r,onClick:f,iconType:u||void 0,iconSide:d,"data-test-subj":`${t||""}EmptyButton`,"aria-label":"Header menu Button Empty"},e):Object(o.jsx)(i.EuiButtonIcon,{isDisabled:r,onClick:f,iconType:u||"boxesHorizontal","data-test-subj":`${t||""}ButtonIcon`,"aria-label":"Header menu Button Icon"},e),onClick:e=>e.stopPropagation(),panelPaddingSize:m,isOpen:y,closePopover:b,anchorPosition:p,"data-test-subj":`${t||""}Items`},h?Object(o.jsx)(i.EuiContextMenuPanel,{css:s,className:"eui-scrollBar","data-test-subj":`${t||""}MenuPanel`,size:"s",items:h}):null))};l.displayName="HeaderMenuComponent";const c=r.a.memo(l);c.displayName="HeaderMenu"},779:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),r=a(159);const i=({exceptionLists:e})=>{const[t,a]=Object(n.useState)(!0),[i,o]=Object(n.useState)([]),[s,l]=Object(n.useState)({}),c=Object(n.useCallback)((t=>{const a=e.reduce(((e,{id:t,...a})=>(e[t]={...a,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const a=t.exceptions_list;return null!=a&&a.length>0&&a.forEach((a=>{const n=e[a.id];null!=n&&(e[a.id]={...n,rules:[...n.rules,t]})})),e}),a)}),[e]);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{if(0===e.length&&t)return a(!1),o([]),void l({});try{a(!0);const{data:e}=await Object(r.j)({pagination:{page:1,perPage:1e4},signal:n.signal}),i=c(e),s=Object.keys(i).map((e=>i[e]));o(s),l(i),t&&a(!1)}catch(e){t&&a(!1)}})(),()=>{t=!1,n.abort()}}),[e.length,c]),[t,i,s]}},780:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(2),r=a.n(n),i=a(19),o=a(221);const s={DUPLICATE:"duplicate",EXPORT:"export"},l=Object(n.memo)((({handleCloseModal:e,onModalConfirm:t,action:a})=>{const[l,c]=Object(n.useState)(!0),u=Object(n.useCallback)((()=>{c(!l)}),[c,l]),d=Object(n.useCallback)((()=>{t(l),e()}),[l,e,t]);return r.a.createElement(i.EuiConfirmModal,{title:a===s.EXPORT?o.M:o.K,onCancel:e,onConfirm:d,cancelButtonText:o.G,confirmButtonText:a===s.EXPORT?o.I:o.H,defaultFocusedButton:"confirm","data-test-subj":"includeExpiredExceptionsConfirmationModal"},r.a.createElement(i.EuiText,null,a===s.EXPORT?o.L:o.J),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiSwitch,{label:o.N,checked:l,onChange:u,"data-test-subj":"includeExpiredExceptionsConfirmationModalSwitch"}))}));l.displayName="IncludeExpiredExceptionsModal"},781:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(123),r=a(383),i=a(449);const o=(e,t)=>{const{addError:a}=Object(n.a)();return Object(r.a)(e,{onError:e=>a(e,{title:i.b}),...t})}},782:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(118),i=a(265);const o=(e=[])=>{const{getAppUrl:t}=Object(r.c)();return Object(n.useMemo)((()=>e.reduce(((e,a)=>{var n;const r=a.id,o=Object(i.j)(r);return e[r]={href:t({path:o}),children:null!==(n=a.name)&&void 0!==n?n:r,target:"_blank"},e}),{})),[t,e])}},783:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(48),r=a(2),i=a(7),o=a(297);const s=()=>{const e=Object(n.useLocation)(),t=Object(n.useHistory)(),{toUrlParams:a,urlParams:s}=Object(o.a)();return Object(r.useCallback)(((n,r=!1)=>{t.push({...e,search:a(r?n:Object(i.pickBy)({...s,...n},(e=>void 0!==e)))})}),[s,t,e,a])}},785:function(e,t,a){"use strict";a.d(t,"a",(function(){return N})),a.d(t,"b",(function(){return D}));var n=a(19),r=a(49),i=a(44),o=a(2),s=a.n(o),l=a(41),c=a.n(l),u=a(161),d=a(875),p=a(209),m=a(313),y=a(137),g=a(118),f=a(130),b=a(351),h=a(367),v=a(181),E=a(340),x=a(144),k=a(314),w=a(201),S=a(862),j=a(196),O=a(736),I=a(334),C=a(226),T=a(521),M=a(357);const _=c()(n.EuiFlexGroup).withConfig({displayName:"UserRiskOverviewWrapper",componentId:"sc-1f042fn-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),N="riskInputsTabQuery",D=s.a.memo((({anomaliesData:e,contextID:t,scopeId:a,data:l,id:c,isDraggable:D=!1,isInDetailsSidePanel:A=!1,isLoadingAnomaliesData:F,loading:q,narrowDateRange:L,startDate:R,endDate:P,userName:z,indexPatterns:B,jobNameById:$})=>{const G=Object(w.a)(),U=Object(k.a)(G),V=Object(g.g)(),H=Object(o.useMemo)((()=>z?Object(y.A)([z]):void 0),[z]),{deleteQuery:W,setQuery:Y}=Object(u.a)(),{data:Z,isAuthorized:K,inspect:Q,loading:X,refetch:J}=Object(m.a)({filterQuery:H,skip:null==z,riskEntity:y.t.user,onlyLatest:!1,pagination:d.a});Object(p.b)({deleteQuery:W,inspect:Q,loading:X,queryId:N,refetch:J,setQuery:Y});const ee=Object(o.useCallback)(((e,n)=>s.a.createElement(b.a,{rowItems:Object(i.getOr)([],e,n),attrName:e,idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:D,scopeId:a})),[t,D,a]),[te,ae]=Object(o.useMemo)((()=>{const e=Z&&Z.length>0?Z[0]:void 0;return[{title:s.a.createElement(T.a,{title:O.k,riskScoreEntity:y.t.user}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.user.risk.calculated_score_norm):Object(f.d)())},{title:s.a.createElement(n.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(T.a,{title:O.j,riskScoreEntity:y.t.user})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(M.a,{anchorPosition:"upCenter"}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(C.a,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(f.d)())}]}),[Z]),ne=Object(o.useMemo)((()=>[{title:O.i,description:l&&l.user?ee("user.id",l):Object(f.d)()},{title:O.h,description:l&&l.user?ee("user.domain",l):Object(f.d)()}]),[l,ee]),re=Object(o.useMemo)((()=>U?[...ne,{title:O.g,description:s.a.createElement(S.a,{anomalies:e,startDate:R,endDate:P,isLoading:F,narrowDateRange:L,jobNameById:$})}]:ne),[e,ne,P,F,L,R,U,$]),ie=Object(o.useMemo)((()=>[re,[{title:O.a,description:s.a.createElement(h.a,{indexPatterns:B,field:"user.name",value:z,type:h.b.FIRST_SEEN})},{title:O.f,description:s.a.createElement(h.a,{indexPatterns:B,field:"user.name",value:z,type:h.b.LAST_SEEN})}],[{title:O.d,description:ee("host.os.name",l)},{title:O.b,description:ee("host.os.family",l)},{title:O.c,description:s.a.createElement(b.a,{rowItems:Object(i.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`user-overview-${t}`:"user-overview",scopeId:a,isDraggable:D,render:e=>null!=e?s.a.createElement(x.h,{ip:e}):Object(f.d)()})}]]),[l,B,ee,t,a,D,z,re]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.c,null,s.a.createElement(j.g,{direction:A?"column":"row","data-test-subj":"user-overview"},!A&&s.a.createElement(v.b,{queryId:c,title:O.e,inspectIndex:0}),ie.map(((e,t)=>s.a.createElement(I.a,{descriptionList:e,key:t}))),q&&s.a.createElement(E.a,{overlay:!0,overlayBackground:V?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))),K&&s.a.createElement(_,{gutterSize:A?"m":"none",direction:A?"column":"row","data-test-subj":"user-risk-overview",$width:A?"100%":"66.6%"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(j.d,{listItems:[te]})),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(j.d,{listItems:[ae]}))))}));D.displayName="UserOverview"},788:function(e,t,a){"use strict";a.d(t,"a",(function(){return pe}));var n=a(44),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(19),c=a(46),u=a(1371),d=a(214);const p=c.intersection([c.exact(c.type({comment:u.a})),c.exact(c.partial({id:d.a}))]),m=c.array(p),y=(c.union([m,c[void 0]]),new c.Type("DefaultUpdateComments",m.is,((e,t)=>null==e?c.success([]):m.validate(e,t)),c.identity));var g=a(574),f=a(752),b=a(506),h=a(507),v=a(399),E=a(400),x=a(345),k=a(275),w=a(456),S=a(1284);const j=c.intersection([c.exact(c.type({description:v.a,entries:f.a,name:E.a,type:g.a})),c.exact(c.partial({_version:x.a,comments:y,expire_time:S.a,id:d.a,item_id:c.union([c.string,c[void 0]]),meta:k.a,namespace_type:w.a,os_types:b.c,tags:h.a}))]);var O=a(1334),I=a(1555),C=a(1561),T=a(54),M=a.n(T),_=a(165),N=a(878),D=a(4);const A=D.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.title",{defaultMessage:"Linked to shared list"}),F=D.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.error",{defaultMessage:"Unable to fetch exception list."});var q=a(354);const L=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1rq9jba-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),R=({isLoadingReferences:e,errorFetchingReferences:t,listAndReferences:a})=>{const[n,o]=Object(r.useState)(i.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemListsTableLoading"})),[s,c]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{t?c(F):e||o(void 0)}),[t,e]),i.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemLinkedToListSection"},i.a.createElement(L,{size:"xs"},i.a.createElement("h3",null,A)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{tableCaption:"Table of exception lists",itemId:"id",message:n,loading:e,items:a,error:s,columns:Object(q.d)(),sorting:!0,"data-test-subj":"exceptionItemSharedList"}))},P=i.a.memo(R);P.displayName="ExceptionsLinkedToLists";const z=D.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToRule.title",{defaultMessage:"Linked to rule"}),B=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-6bqv6k-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),$=({rule:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B,{size:"xs","data-test-subj":"exceptionItemLinkedToRuleSection"},i.a.createElement("h3",null,z)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{tableCaption:"Rules table",itemId:"id",items:[e],columns:Object(q.c)(),sorting:!0,"data-test-subj":"addExceptionToRulesTable"})),G=i.a.memo($);G.displayName="ExceptionsLinkedToRule";var U=a(871),V=a(879),H=a(840),W=a(872),Y=a(1230),Z=a(632);const K=D.i18n.translate("xpack.securitySolution.ruleExceptions.editException.cancel",{defaultMessage:"Cancel"}),Q=D.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editExceptionTitle",{defaultMessage:"Edit rule exception"}),X=D.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit endpoint exception"}),J=D.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception updated"}),ee=D.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastErrorTitle",{defaultMessage:"Error updating exception"});var te=a(123),ae=a(841),ne=a(353),re=a(880),ie=a(237),oe=a(487);const se=s()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-1j5dcqi-0"})(["",""],(({theme:e})=>Object(o.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),le=s()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-1j5dcqi-1"})(["",""],(()=>Object(o.css)(["&.builder-section{overflow-y:scroll;}"]))),ce=s()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-1j5dcqi-2"})(["",""],(({theme:e})=>Object(o.css)(["padding:",";"],e.eui.euiSizeS))),ue=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1j5dcqi-3"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),de=({list:e,itemToEdit:t,rule:a,showAlertCloseOptions:o,openedFromListDetailPage:s,onCancel:c,onConfirm:u})=>{var d;const p=Object(r.useMemo)((()=>t.os_types),[t]),m=Object(r.useMemo)((()=>null!=a?[a]:null),[a]),y=Object(r.useMemo)((()=>e.type),[e]),{isLoading:g,indexPatterns:f,getExtendedFields:b}=Object(H.a)(m),[h,v]=(()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(te.a)(),[n,i]=Object(ae.a)(),[o,s]=Object(r.useState)(!1),l=Object(r.useRef)(null);return Object(r.useEffect)((()=>{let a=!0;const n=new AbortController;return l.current=async({itemsToUpdate:n})=>{var r,o;if(null!=i)try{s(!0),await i(n),e({title:J,text:(r=n.map((({name:e})=>e)).join(", "),o=n.length,D.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessText",{values:{exceptionItemName:r,numItems:o},defaultMessage:"{numItems, plural, =1 {Exception} other {Exceptions}} - {exceptionItemName} - {numItems, plural, =1 {has} other {have}} been updated."}))}),a&&s(!1)}catch(e){if(a)throw s(!1),t(e,{title:ee}),new Error(e)}},()=>{a=!1,n.abort()}}),[e,t,a,i]),[o||n,l.current]})(),[E,x]=Object(W.a)(),[{exceptionItems:k,exceptionItemMeta:{name:w},newComment:S,commentErrorExists:T,bulkCloseAlerts:A,disableBulkClose:F,bulkCloseIndex:L,entryErrorExists:R,expireTime:z,expireErrorExists:B,wildcardWarningExists:$},de]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:a}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[a[0]]:a[1]}}}case"setComment":{const{comment:a}=t;return{...e,newComment:a}}case"setCommentError":{const{errorExists:a}=t;return{...e,commentErrorExists:a}}case"setBulkCloseAlerts":{const{bulkClose:a}=t;return{...e,bulkCloseAlerts:a}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:a}=t;return{...e,disableBulkClose:a}}case"setBulkCloseIndex":{const{bulkCloseIndex:a}=t;return{...e,bulkCloseIndex:a}}case"setExceptionItems":{const{items:a}=t;return{...e,exceptionItems:a}}case"setConditionValidationErrorExists":{const{errorExists:a}=t;return{...e,entryErrorExists:a}}case"setExpireTime":{const{expireTime:a}=t;return{...e,expireTime:a}}case"setExpireError":{const{errorExists:a}=t;return{...e,expireErrorExists:a}}case"setWildcardWithWrongOperator":{const{warningExists:a}=t;return{...e,wildcardWarningExists:a}}default:return e}}),{exceptionItems:[t],exceptionItemMeta:{name:t.name},newComment:"",commentErrorExists:!1,bulkCloseAlerts:!1,disableBulkClose:!0,bulkCloseIndex:void 0,entryErrorExists:!1,expireTime:void 0!==t.expire_time?M()(t.expire_time):void 0,expireErrorExists:!1,wildcardWarningExists:!1}),pe=Object(r.useMemo)((()=>null==a||!Object(_.b)(a.type)&&!Object(_.n)(a.type)&&!Object(_.f)(a.type)),[a]),[me,ye]=Object(r.useState)($),[ge,fe,be,he]=Object(Y.a)();Object(r.useEffect)((()=>{null!=he&&he([{id:e.id,listId:e.list_id,namespaceType:e.namespace_type}])}),[e,he]);const ve=Object(r.useCallback)((e=>{de({type:"setWildcardWithWrongOperator",warningExists:Object(I.g)(e)}),de({type:"setExceptionItems",items:e})}),[de]),Ee=Object(r.useCallback)((e=>{de({type:"setExceptionItemMeta",value:e})}),[de]),xe=Object(r.useCallback)((e=>{de({type:"setComment",comment:e})}),[de]),ke=Object(r.useCallback)((e=>{de({type:"setCommentError",errorExists:e})}),[de]),we=Object(r.useCallback)((e=>{de({type:"setBulkCloseAlerts",bulkClose:e})}),[de]),Se=Object(r.useCallback)((e=>{de({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[de]),je=Object(r.useCallback)((e=>{de({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[de]),Oe=Object(r.useCallback)((e=>{de({type:"setConditionValidationErrorExists",errorExists:e})}),[de]),Ie=Object(r.useCallback)((e=>{de({type:"setExpireTime",expireTime:e})}),[de]),Ce=Object(r.useCallback)((e=>{de({type:"setExpireError",errorExists:e})}),[de]),Te=Object(r.useCallback)((()=>{c(!1)}),[c]),Me=Object(r.useCallback)((e=>e.every((e=>j.is(e)))),[]),_e=Object(r.useCallback)((async()=>{if(null!=v)try{const r=Object(q.a)({itemName:w,commentToAdd:S,listType:y,selectedOs:t.os_types,expireTime:z,items:k});if(Me(r)){await v({itemsToUpdate:r});const t=null!=a?[a.rule_id]:[],i=null!=be?be[e.list_id].referenced_rules.map((({rule_id:e})=>e)):[],o=y===O.a.RULE_DEFAULT?t:i;null!=x&&!Object(n.isEmpty)(o)&&A&&await x(o,r,void 0,L),u(!0)}}catch(e){c(!1)}}),[v,w,S,y,t.os_types,k,Me,a,be,e.list_id,x,A,u,L,c,z]),Ne=Object(r.useCallback)((()=>{if(!$)return _e();ye(!0)}),[$,_e]),De=Object(r.useMemo)((()=>y===O.a.ENDPOINT?X:Q),[y]),Ae=Object(r.useMemo)((()=>h||E||k.every((e=>0===e.entries.length))||g||R||B||T),[g,R,k,h,E,B,T]),Fe=Object(l.useGeneratedHtmlId)({prefix:"exceptionFlyoutTitle"}),qe=Object(r.useMemo)((()=>{const{title:e,body:t,confirmButton:a,cancelButton:n}=Object(ie.a)(y===O.a.ENDPOINT?ne.c:ne.j);return i.a.createElement(oe.a,{title:e,body:t,confirmButton:a,cancelButton:n,onSuccess:_e,onCancel:()=>ye(!1),"data-test-subj":"artifactConfirmModal"})}),[y,_e]);return i.a.createElement(l.EuiFlyout,{size:"l",onClose:Te,"data-test-subj":"editExceptionFlyout","aria-labelledby":Fe},i.a.createElement(se,null,i.a.createElement(l.EuiTitle,null,i.a.createElement("h2",{id:Fe,"data-test-subj":"exceptionFlyoutTitle"},De)),i.a.createElement(l.EuiSpacer,{size:"m"})),i.a.createElement(le,{className:"builder-section"},g&&i.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingEditExceptionFlyout",lines:4}),i.a.createElement(N.a,{exceptionItemName:w,onChange:Ee}),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(V.a,{exceptionItemName:w,allowLargeValueLists:pe,exceptionListItems:[t],exceptionListType:y,indexPatterns:f,rules:m,selectedOs:p,showOsTypeOptions:y===O.a.ENDPOINT,isEdit:!0,onExceptionItemAdd:ve,onSetErrorExists:Oe,getExtendedFields:b}),$&&i.a.createElement(C.a,null),!s&&y===O.a.DETECTION&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(P,{isLoadingReferences:ge,errorFetchingReferences:fe,listAndReferences:null!=be?[be[e.list_id]]:[]})),!s&&y===O.a.RULE_DEFAULT&&null!=a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(G,{rule:a})),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(Z.a,{accordionTitle:i.a.createElement(ue,{size:"xs"},i.a.createElement("h3",null,(Le=null!==(d=t.comments.length)&&void 0!==d?d:0,D.i18n.translate("xpack.securitySolution.ruleExceptions.editExceptionFlyout.commentsTitle",{values:{comments:Le},defaultMessage:"Add comments ({comments})"})))),exceptionItemComments:t.comments,newCommentValue:S,newCommentOnChange:xe,setCommentError:ke}),y!==O.a.ENDPOINT&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(re.a,{expireTime:z,setExpireTime:Ie,setExpireError:Ce})),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(U.a,{exceptionListType:y,shouldBulkCloseAlert:A,disableBulkClose:F,exceptionListItems:k,onDisableBulkClose:Se,onUpdateBulkCloseIndex:je,onBulkCloseCheckboxChange:we}))),i.a.createElement(l.EuiFlyoutFooter,null,i.a.createElement(ce,{justifyContent:"spaceBetween"},i.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionEditButton",onClick:Te},K),i.a.createElement(l.EuiButton,{"data-test-subj":"editExceptionConfirmButton",onClick:Ne,isDisabled:Ae,fill:!0},De))),me&&qe);var Le},pe=i.a.memo(de);pe.displayName="EditExceptionFlyout"},791:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),r=a.n(n),i=a(19),o=a(165);const s=a(4).i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.TechnicalPreviewLabel",{defaultMessage:"Technical Preview"}),l=({label:e})=>r.a.createElement(r.a.Fragment,null,e,r.a.createElement(i.EuiBetaBadge,{label:s,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}));var c=a(208);const u=({label:e,ruleType:t})=>{const a=Object(c.b)("alert_suppression_rule_details");return r.a.createElement(r.a.Fragment,null,t&&Object(o.l)(t)?e:r.a.createElement(l,{label:e}),a&&r.a.createElement(i.EuiToolTip,{position:"top",content:a},r.a.createElement(i.EuiIcon,{type:"warning",size:"l",color:"#BD271E",style:{marginLeft:"8px"},"data-test-subj":"alertSuppressionInsufficientLicensingIcon"})))}},792:function(e,t,a){"use strict";a.d(t,"a",(function(){return B})),a.d(t,"b",(function(){return $}));var n=a(19),r=a(49),i=a(44),o=a(2),s=a.n(o),l=a(41),c=a.n(l),u=a(161),d=a(209),p=a(875),m=a(313),y=a(137),g=a(118),f=a(130),b=a(937),h=a(351),v=a(367),E=a(181),x=a(340),k=a(144),w=a(314),S=a(201),j=a(862),O=a(196),I=a(735),C=a(505),T=a(334),M=a(4);const _=M.i18n.translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Endpoint integration policy"}),N=M.i18n.translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Policy Status"}),D=M.i18n.translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Endpoint version"}),A=M.i18n.translate("xpack.securitySolution.host.details.endpoint.fleetAgentStatus",{defaultMessage:"Agent status"});var F=a(1322);const q=s.a.memo((({contextID:e,data:t,scopeId:a})=>{const r=Object(o.useCallback)(((t,n,r)=>s.a.createElement(h.a,{rowItems:[Object(i.getOr)("",t,n)],attrName:r,idPrefix:e?`endpoint-overview-${e}`:"endpoint-overview",scopeId:a})),[e,a]),l=Object(o.useMemo)((()=>{var e,a,i;const o=null==t||null===(e=t.hostInfo)||void 0===e?void 0:e.metadata.Endpoint.policy.applied;return[[{title:_,description:null!==(a=null==o?void 0:o.name)&&void 0!==a?a:Object(f.d)()}],[{title:N,description:null!=o&&o.status?s.a.createElement(n.EuiHealth,{"aria-label":null==o?void 0:o.status,color:(null==o?void 0:o.status)===F.a.failure?"danger":null==o?void 0:o.status},null==o?void 0:o.status):Object(f.d)()}],[{title:D,description:null!=t&&null!==(i=t.hostInfo)&&void 0!==i&&i.metadata.agent.version?r("hostInfo.metadata.agent.version",t,"agent.version"):Object(f.d)()}],[{title:A,description:null!=t&&t.hostInfo?s.a.createElement(C.a,{agentId:t.hostInfo.metadata.agent.id,agentType:"endpoint"}):Object(f.d)()}]]}),[t,r]);return s.a.createElement(s.a.Fragment,null,l.map(((e,t)=>s.a.createElement(T.a,{dataTestSubj:"endpoint-overview",descriptionList:e,key:t}))))}));q.displayName="EndpointOverview";var L=a(226),R=a(521),P=a(357);const z=c()(n.EuiFlexGroup).withConfig({displayName:"HostRiskOverviewWrapper",componentId:"sc-p9r0sg-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),B="riskInputsTabQuery",$=s.a.memo((({anomaliesData:e,contextID:t,scopeId:a,data:l,endDate:c,id:C,isDraggable:M=!1,isInDetailsSidePanel:_=!1,isLoadingAnomaliesData:N,indexNames:D,loading:A,narrowDateRange:F,startDate:$,hostName:G,jobNameById:U})=>{const V=Object(S.a)(),H=Object(w.a)(V),W=Object(g.g)(),Y=Object(o.useMemo)((()=>G?Object(y.z)([G]):void 0),[G]),{deleteQuery:Z,setQuery:K}=Object(u.a)(),{data:Q,isAuthorized:X,inspect:J,loading:ee,refetch:te}=Object(m.a)({filterQuery:Y,riskEntity:y.t.host,skip:null==G,onlyLatest:!1,pagination:p.a});Object(d.b)({deleteQuery:Z,inspect:J,loading:ee,queryId:B,refetch:te,setQuery:K});const ae=Object(o.useCallback)(((e,n)=>s.a.createElement(h.a,{rowItems:Object(i.getOr)([],e,n),attrName:e,idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:M,scopeId:a})),[t,M,a]),[ne,re]=Object(o.useMemo)((()=>{const e=Q&&Q.length>0?Q[0]:void 0;return[{title:s.a.createElement(R.a,{title:I.g,riskScoreEntity:y.t.host}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.host.risk.calculated_score_norm):Object(f.d)())},{title:s.a.createElement(n.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(R.a,{title:I.f,riskScoreEntity:y.t.host})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(P.a,{anchorPosition:"upCenter"}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(L.a,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(f.d)())}]}),[Q]),ie=Object(o.useMemo)((()=>[{title:I.e,description:l&&l.host?Object(b.c)({host:l.host,isDraggable:M,noLink:!0}):Object(f.d)()},{title:I.d,description:s.a.createElement(v.a,{indexPatterns:D,field:"host.name",value:G,type:v.b.FIRST_SEEN})},{title:I.k,description:s.a.createElement(v.a,{indexPatterns:D,field:"host.name",value:G,type:v.b.LAST_SEEN})}]),[l,D,G,M]),oe=Object(o.useMemo)((()=>H?[...ie,{title:I.n,description:s.a.createElement(j.a,{anomalies:e,startDate:$,endDate:c,isLoading:N,narrowDateRange:F,jobNameById:U})}]:ie),[e,ie,c,N,F,$,H,U]),se=Object(o.useMemo)((()=>[oe,[{title:I.j,description:s.a.createElement(h.a,{rowItems:Object(i.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`host-overview-${t}`:"host-overview",scopeId:a,isDraggable:M,render:e=>null!=e?s.a.createElement(k.h,{ip:e}):Object(f.d)()})},{title:I.m,description:ae("host.mac",l)},{title:I.p,description:ae("host.os.platform",l)}],[{title:I.o,description:ae("host.os.name",l)},{title:I.c,description:ae("host.os.family",l)},{title:I.r,description:ae("host.os.version",l)},{title:I.a,description:ae("host.architecture",l)}],[{title:I.b,description:ae("cloud.provider",l)},{title:I.q,description:ae("cloud.region",l)},{title:I.i,description:ae("cloud.instance.id",l)},{title:I.l,description:ae("cloud.machine.type",l)}]]),[t,a,l,oe,ae,M]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(E.c,null,s.a.createElement(O.g,{direction:_?"column":"row","data-test-subj":"host-overview"},!_&&s.a.createElement(E.b,{queryId:C,title:I.h,inspectIndex:0}),se.map(((e,t)=>s.a.createElement(T.a,{descriptionList:e,key:t}))),A&&s.a.createElement(x.a,{overlay:!0,overlayBackground:W?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))),X&&s.a.createElement(z,{gutterSize:_?"m":"none",direction:_?"column":"row","data-test-subj":"host-risk-overview",$width:_?"100%":"50%"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(O.d,{listItems:[ne]})),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(O.d,{listItems:[re]}))),l&&null!=l.endpoint?s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiHorizontalRule,null),s.a.createElement(O.g,{direction:_?"column":"row"},s.a.createElement(q,{contextID:t,data:l.endpoint,scopeId:a}),A&&s.a.createElement(x.a,{overlay:!0,overlayBackground:W?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))):null)}));$.displayName="HostOverview"},793:function(e,t,a){"use strict";a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return k}));var n=a(2),r=a.n(n),i=a(4),o=a(19),s=a(1213),l=a(297),c=a(845),u=a(126),d=a(783),p=a(587),m=a(118),y=a(259),g=a(843),f=a(140),b=a(451),h=a(361),v=a(487);const E=Object.freeze({flyoutEditTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditTitle",{defaultMessage:"Add artifact"}),flyoutCreateTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateTitle",{defaultMessage:"Create artifact"}),flyoutCancelButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),flyoutCreateSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add"}),flyoutEditSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitButtonLabel",{defaultMessage:"Save"}),flyoutDowngradedLicenseTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.expiredLicenseTitle",{defaultMessage:"Expired License"}),flyoutDowngradedLicenseInfo:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseInfo",{defaultMessage:"Your Kibana license has been downgraded. Future policy configurations will now be globally assigned to all policies."}),flyoutDowngradedLicenseDocsInfo:e=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseDocsInfo",{defaultMessage:"For more information, see our documentation."}),flyoutEditItemLoadFailure:e=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditItemLoadFailure",{defaultMessage:"Failed to retrieve item for edit. Reason: {errorMessage}",values:{errorMessage:e}}),flyoutCreateSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.some_page.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}})}),x=(e,t)=>({isValid:!1,item:null!=t?t:Object(y.a)(e)}),k=Object(n.memo)((({apiClient:e,item:t,policies:a,policiesIsLoading:i,FormComponent:y,onSuccess:k,onClose:w,submitHandler:S,labels:j={},"data-test-subj":O,size:I="m"})=>{var C,T;const{docLinks:{links:{securitySolution:M}}}=Object(m.j)().services,_=Object(u.a)(O),N=Object(m.n)(),D=Object(c.a)(),A=Object(d.a)(),{urlParams:F}=Object(l.a)(),q=Object(s.a)(),L=Object(n.useMemo)((()=>({...E,...j})),[j]),[R,P]=Object(n.useState)(!1),[z,B]=Object(n.useState)(void 0),[$,G]=Object(n.useState)(!1),U="edit"===F.show,V=U?"edit":"create",{isLoading:H,mutateAsync:W,error:Y}=Object(g.a)(e,V),Z=Object(n.useMemo)((()=>S?R:H),[R,H,S]),K=Object(n.useMemo)((()=>S?z:Y),[z,Y,S]),{isRefetching:Q,error:X,refetch:J}=Object(h.d)(e,null!==(C=F.itemId)&&void 0!==C?C:"",void 0,{enabled:!1}),[ee,te]=Object(n.useState)(x.bind(null,e.listId,t)),ae=((e,t)=>{const a=Object(f.a)().endpointPrivileges;return Object(n.useMemo)((()=>"edit"===t&&!a.canCreateArtifactsByPolicy&&Object(b.e)(e)),[a.canCreateArtifactsByPolicy,e,t])})({tags:null!==(T=ee.item.tags)&&void 0!==T?T:[]},V),ne=Object(n.useMemo)((()=>!!t||!!ee.item.item_id),[ee.item.item_id,t]),re=Object(n.useMemo)((()=>U&&!ne),[ne,U]),ie=Object(n.useCallback)((()=>{Z||(A({...F,itemId:void 0,show:void 0},!0),w())}),[Z,w,A,F]),oe=Object(n.useCallback)((({item:e,isValid:t,confirmModalLabels:a})=>{q()&&te({item:e,isValid:t,confirmModalLabels:a})}),[q]),se=Object(n.useCallback)((e=>{N.addSuccess(U?L.flyoutEditSubmitSuccess(e):L.flyoutCreateSubmitSuccess(e)),q()&&(A({...F,itemId:void 0,show:void 0},!0),k())}),[U,q,L,k,A,N,F]),le=Object(n.useCallback)((()=>{S?(P(!0),S(ee.item,V).then(se).catch((e=>{q()&&B(e)})).finally((()=>{q()&&P(!1)}))):ee.confirmModalLabels?G(!0):W(ee.item).then(se)}),[V,ee.item,ee.confirmModalLabels,se,q,W,S]),ce=Object(n.useCallback)((()=>W(ee.item).then(se)),[W,ee.item,se]),ue=Object(n.useMemo)((()=>{if(ee.confirmModalLabels){const{title:e,body:t,confirmButton:a,cancelButton:n}=ee.confirmModalLabels;return r.a.createElement(v.a,{title:e,body:t,confirmButton:a,cancelButton:n,onSuccess:ce,onCancel:()=>G(!1),"data-test-subj":"artifactConfirmModal"})}}),[ee,ce]);Object(n.useEffect)((()=>{!U||ne||X||!re||Q||J().then((({data:t})=>{t&&q()&&te(x(e.listId,t))}))}),[e.listId,X,J,U,re,Q,ne,q]),Object(n.useEffect)((()=>{var e;U&&X&&(N.addWarning(L.flyoutEditItemLoadFailure((null==X||null===(e=X.body)||void 0===e?void 0:e.message)||X.message)),A({itemId:void 0,show:void 0}))}),[X,U,L,A,N,F.itemId]);const de=Object(o.useGeneratedHtmlId)({prefix:"artifactFlyoutTitle"});return!D||X?null:r.a.createElement(o.EuiFlyout,{size:I,onClose:ie,"data-test-subj":O,"aria-labelledby":de},r.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(o.EuiTitle,{size:"m"},r.a.createElement("h2",{id:de},U?L.flyoutEditTitle:L.flyoutCreateTitle))),!re&&ae&&r.a.createElement(o.EuiCallOut,{title:L.flyoutDowngradedLicenseTitle,color:"warning",iconType:"help","data-test-subj":_("expiredLicenseCallout")},L.flyoutDowngradedLicenseInfo," ",L.flyoutDowngradedLicenseDocsInfo(M)),r.a.createElement(o.EuiFlyoutBody,null,re&&r.a.createElement(p.a,{"data-test-subj":_("loader")}),!re&&r.a.createElement(y,{onChange:oe,disabled:Z,item:ee.item,error:null!=K?K:void 0,mode:V,policies:a,policiesIsLoading:i})),!re&&r.a.createElement(o.EuiFlyoutFooter,null,r.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":_("cancelButton"),onClick:ie,disabled:Z},L.flyoutCancelButtonLabel)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{"data-test-subj":_("submitButton"),fill:!0,disabled:!ee.isValid||Z,onClick:le,isLoading:Z},U?L.flyoutEditSubmitButtonLabel:L.flyoutCreateSubmitButtonLabel)))),$&&ue)}));k.displayName="ArtifactFlyout"},795:function(e,t,a){"use strict";a.d(t,"b",(function(){return n.a})),a.d(t,"a",(function(){return b})),a(779),a(596),a(598),a(600);var n=a(599),r=(a(601),a(2)),i=a(1314),o=a(1491),s=a(7),l=a(245),c=a(270),u=a(5),d=a(118),p=a(627),m=a(884),y=a(221),g=a(588);const f={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},b=e=>{const t=Object(d.n)(),{services:a}=Object(d.j)(),{http:n,notifications:b}=a,{navigateToApp:h}=a.application,{exportExceptionList:v,deleteExceptionList:E,duplicateExceptionList:x}=Object(o.a)(n),[{loading:k,canUserCRUD:w,canUserREAD:S}]=Object(c.b)(),[j,O]=Object(r.useState)(),[I,C]=Object(r.useState)(!1),[T,M]=Object(r.useState)(),[_,N]=Object(r.useState)(!1),[D,A]=Object(r.useState)([]),[F,q]=Object(r.useState)([]),[L,R]=Object(r.useState)(!0),[P,z]=Object(r.useState)(""),[B,$]=Object(r.useState)(),[G,U]=Object(r.useState)(!1),[V,H]=Object(r.useState)(f),[W,Y]=Object(r.useState)(!0),[Z,K]=Object(r.useState)(!1),Q=Object(g.b)(),X=Object(r.useMemo)((()=>({pageId:u.Oc.exceptions,path:"",onNavigate:()=>{h(u.m,{deepLinkId:u.Oc.exceptions,path:""})}})),[h]),J=Object(r.useCallback)(((e,a,n,r)=>{null==t||t.addError(e,{title:null!=n?n:"",toastMessage:null!=r?r:""}),z(null!=a?a:"")}),[t]),ee=Object(r.useCallback)((async e=>{const t=await Object(p.e)(e.list_id);A(t)}),[]),te=Object(r.useCallback)((async()=>{try{if(l.a.includes(e))return N(!0);O(!0);const t=await Object(p.d)({id:e,http:n});if(!t||!Object(m.b)(t))return O(!1),N(!0);if(M(t),await ee(t),O(!1),N(!1),Object(m.a)(t))return R(!1)}catch(e){J(e,i.a.ERROR,y.q,y.p)}}),[e,n,ee,J]);Object(r.useEffect)((()=>{te()}),[te]);const[ae,ne]=Object(r.useState)(!1),re=Object(r.useCallback)((async t=>{try{var a;T&&await Object(p.i)({http:n,list:{id:T.id,list_id:e,type:T.type,name:t.name,description:null!==(a=t.description)&&void 0!==a?a:"",namespace_type:T.namespace_type}})}catch(e){J(e)}}),[e,J,n,T]),ie=Object(r.useCallback)((async e=>{try{if(!T)return;await v({id:T.id,listId:T.list_id,includeExpiredExceptions:e,namespaceType:T.namespace_type,onError:e=>J(e),onSuccess:e=>{$(e),null==t||t.addSuccess(y.C(T.name))}})}catch(e){J(e,void 0,y.r,y.s)}}),[T,v,J,t]),oe=Object(r.useCallback)((async e=>{try{if(!T)return;await x({listId:T.list_id,includeExpiredExceptions:e,namespaceType:T.namespace_type,onError:e=>J(e),onSuccess:e=>{null==t||t.addSuccess(y.v(T.name)),h(u.m,{deepLinkId:u.Oc.exceptions,path:`/details/${e.list_id}`})}})}catch(e){J(e,void 0,y.n,y.o)}}),[T,x,J,t,h]),se=Object(r.useCallback)((()=>{$(void 0)}),[]),le=Object(r.useCallback)((e=>()=>{b.toasts.addSuccess({title:y.ob(null!=e?e:V.listId)})}),[b.toasts,V.listId]),ce=Object(r.useCallback)((e=>{J(e)}),[J]),ue=Object(r.useCallback)((async()=>{try{if(!T)return;await E({id:T.id,namespaceType:T.namespace_type,onError:ce,onSuccess:le})}catch(e){J(e)}finally{H(f),U(!1),h(u.m,{deepLinkId:u.Oc.exceptions,path:""})}}),[T,E,ce,le,J,h]),de=Object(r.useCallback)((()=>{try{if(!T)return;H({contentText:D.length?y.qb(D.length):y.nb(T.name),rulesReferences:D.map((({name:e})=>e)),isLoading:!0,listId:T.list_id,listNamespaceType:T.namespace_type}),U(!0)}catch(e){J(e)}}),[J,D,T]),pe=Object(r.useCallback)((()=>{U(!1),H({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),me=Object(r.useCallback)((async()=>{try{await Object(p.h)({rules:D,listId:e}),ue()}catch(e){J(e)}}),[e,D,J,ue]),ye=Object(r.useCallback)((()=>{A(F),q(F),ne(!1),C(!1),Y(!0)}),[F]),ge=Object(r.useCallback)((()=>{ne(!0)}),[]),fe=Object(r.useCallback)((()=>F.filter((e=>!D.includes(e)))),[D,F]),be=Object(r.useCallback)((()=>D.filter((e=>!F.includes(e)))),[D,F]),he=Object(r.useCallback)((e=>{q(e),Y(!1)}),[]),ve=Object(r.useCallback)((async()=>{try{if(!T)return ne(!1);C(!0);const t=fe(),a=be();if(!t.length&&!a.length||Object(s.isEqual)(t,a))return ye();Promise.all([Object(p.h)({rules:a,listId:e}),Object(p.f)({rules:t,listId:e,id:T.id,listType:T.type,listNamespaceType:T.namespace_type})]).then((()=>{K(!0),ye()})).then((()=>K(!1))).then((()=>Q())).catch((e=>{J(e,void 0,y.E,y.F),C(!1)})).finally((()=>{te()}))}catch(e){J(e)}}),[T,fe,be,ye,e,Q,J,te]),Ee=Object(r.useCallback)((()=>{ne(!1)}),[]);return{isLoading:j||k,invalidListId:_,isReadOnly:!(w||!S),list:T,listName:null==T?void 0:T.name,listDescription:null==T?void 0:T.description,listId:e,canUserEditList:L,linkedRules:D,exportedList:B,handleOnDownload:se,viewerStatus:P,showManageRulesFlyout:ae,headerBackOptions:X,referenceModalState:V,showReferenceErrorModal:G,showManageButtonLoader:I,refreshExceptions:Z,disableManageButton:W,handleDelete:de,onDuplicateList:oe,onEditListDetails:re,onExportList:ie,onDeleteList:ue,onManageRules:ge,onSaveManageRules:ve,onCancelManageRules:Ee,onRuleSelectionChange:he,handleCloseReferenceErrorModal:pe,handleReferenceDelete:me}}},823:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a(2);const r=a.n(n).a.createContext(null),i=()=>{var e;return null===(e=Object(n.useContext)(r))||void 0===e?void 0:e.current}},824:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return l}));var n=a(4);const r=e=>n.i18n.translate("xpack.securitySolution.assignees.totalUsersAssigned",{defaultMessage:"{total, plural, one {# filter} other {# filters}} selected",values:{total:e}}),i=n.i18n.translate("xpack.securitySolution.assignees.applyButtonTitle",{defaultMessage:"Apply"}),o=n.i18n.translate("xpack.securitySolution.assignees.selectableSearchPlaceholder",{defaultMessage:"Search users"}),s=n.i18n.translate("xpack.securitySolution.assignees.clearFilters",{defaultMessage:"Clear filters"}),l=n.i18n.translate("xpack.securitySolution.assignees.noAssigneesLabel",{defaultMessage:"No assignees"})},825:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s}));var n=a(7),r=a(405);const i=e=>{var t,a,n,r,i,o,s;return null!==(t=null!==(a=null===(n=e.user)||void 0===n||null===(r=n.full_name)||void 0===r?void 0:r.toLowerCase())&&void 0!==a?a:null===(i=e.user)||void 0===i||null===(o=i.email)||void 0===o?void 0:o.toLowerCase())&&void 0!==t?t:null===(s=e.user)||void 0===s?void 0:s.username.toLowerCase()},o=(e,t)=>((e,t)=>{if(!t)return;if(!e)return t;if(!t.find((t=>t.uid===e.uid)))return t;const a=t.filter((t=>t.uid!==e.uid));return[e,...a]})(e,(e=>{if(e)return Object(n.sortBy)(e,i)})(t)),s=e=>e.filter((e=>e!==r.b))},826:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));const n="securitySolutionAssignees",r=`${n}Selectable`,i=`${n}ApplyPanel`,o=`${n}ApplyButton`},827:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return c}));var n=a(19);const r=97,i=2;function o(e,t){if(t&&t.color)return t.color;const a=l(e).codePointAt(0)||r;return n.VISUALIZATION_COLORS[a%n.VISUALIZATION_COLORS.length]}function s(e,t){if(t&&t.initials)return t.initials;const a=l(e).split(" "),n=Math.min(i,a.length);return a.splice(n,a.length),a.map((e=>e.substring(0,1))).join("")}function l(e){return e.full_name||e.email||e.username}function c(e){const t=l(e);return e.email&&e.email!==t?`${t} (${e.email})`:t}},829:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(1222);const r=e=>{var t;const a=null!=e&&e.fields?null==e?void 0:e.fields["kibana.alert.rule.parameters"]:null,r=a?null===(t=a[0])||void 0===t?void 0:t.threat:null;return r&&r.length>0?Object(n.o)({label:r[0].framework,threat:r}):null}},831:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(19),r=a(2),i=a.n(r),o=a(667),s=a(172),l=a(422),c=a(148),u=a(124);const d=i.a.memo((({eventId:e,contextId:t,enrichedFieldInfo:a,scopeId:d,handleOnEventClosed:p})=>{const[m,y]=Object(r.useState)(!1),g=Object(r.useCallback)((()=>y(!m)),[m]),f=Object(r.useCallback)((()=>y(!1)),[]),b=Object(r.useCallback)((()=>{f(),p()}),[f,p]),h=Object(r.useMemo)((()=>c.d.globalQuery()),[]),v=Object(u.a)(h),E=Object(r.useCallback)((()=>{v.forEach((e=>e.refetch&&e.refetch()))}),[v]),{actionItems:x}=Object(o.a)({closePopover:b,eventId:e,scopeId:d,alertStatus:a.values[0],refetch:E}),k=Object(r.useMemo)((()=>[{id:0,items:x}]),[x]),w=Object(r.useMemo)((()=>x.length>0),[x]),S=Object(r.useMemo)((()=>i.a.createElement(l.a,{contextId:t,eventId:e,value:a.values[0],fieldName:a.data.field,linkValue:a.linkValue,fieldType:a.data.type,fieldFormat:a.data.format,isDraggable:!1,truncate:!1,isButton:w,onClick:w?g:void 0,onClickAriaLabel:s.D})),[t,e,a,g,w]);return w?i.a.createElement(n.EuiPopover,{button:S,isOpen:m,closePopover:f,panelPaddingSize:"none","data-test-subj":"alertStatus"},i.a.createElement(n.EuiPopoverTitle,{paddingSize:"m"},s.C),i.a.createElement(n.EuiContextMenu,{panels:k,initialPanelId:0,"data-test-subj":"event-details-alertStatusPopover"})):S}));d.displayName="StatusPopoverButton"},832:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(4).i18n.translate("xpack.securitySolution.source.destination.packetsLabel",{defaultMessage:"pkts"})},833:function(e,t,a){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function a(e){let a=e,n=e;function r(e,t,a,r){for(null==a&&(a=0),null==r&&(r=e.length);a<r;){const i=a+r>>>1;n(e[i],t)<0?a=i+1:r=i}return a}return 1===e.length&&(a=(t,a)=>e(t)-a,n=function(e){return(a,n)=>t(e(a),n)}(e)),{left:r,center:function(e,t,n,i){null==n&&(n=0),null==i&&(i=e.length);const o=r(e,t,n,i-1);return o>n&&a(e[o-1],t)>-a(e[o],t)?o-1:o},right:function(e,t,a,r){for(null==a&&(a=0),null==r&&(r=e.length);a<r;){const i=a+r>>>1;n(e[i],t)>0?r=i:a=i+1}return a}}}function n(e){return null===e?NaN:+e}const r=a(t),i=r.right,o=r.left,s=a(n).center;function l(e,t){let a=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++a;else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&++a}return a}function c(e){return 0|e.length}function u(e){return!(e>0)}function d(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function p(e,t){let a,n=0,r=0,i=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(a=t-r,r+=a/++n,i+=a*(t-r));else{let o=-1;for(let s of e)null!=(s=t(s,++o,e))&&(s=+s)>=s&&(a=s-r,r+=a/++n,i+=a*(s-r))}if(n>1)return i/(n-1)}function m(e,t){const a=p(e,t);return a?Math.sqrt(a):a}function y(e,t){let a,n;if(void 0===t)for(const t of e)null!=t&&(void 0===a?t>=t&&(a=n=t):(a>t&&(a=t),n<t&&(n=t)));else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(void 0===a?i>=i&&(a=n=i):(a>i&&(a=i),n<i&&(n=i)))}return[a,n]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let a=0;for(let n=0;n<this._n&&n<32;n++){const r=t[n],i=e+r,o=Math.abs(e)<Math.abs(r)?e-(i-r):r-(i-e);o&&(t[a++]=o),e=i}return t[a]=e,this._n=a+1,this}valueOf(){const e=this._partials;let t,a,n,r=this._n,i=0;if(r>0){for(i=e[--r];r>0&&(t=i,a=e[--r],i=t+a,n=a-(i-t),!n););r>0&&(n<0&&e[r-1]<0||n>0&&e[r-1]>0)&&(a=2*n,t=i+a,a==t-i&&(i=t))}return i}}class InternMap extends Map{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,a]of e)this.set(t,a)}get(e){return super.get(g(this,e))}has(e){return super.has(g(this,e))}set(e,t){return super.set(f(this,e),t)}delete(e){return super.delete(b(this,e))}}class InternSet extends Set{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(g(this,e))}add(e){return super.add(f(this,e))}delete(e){return super.delete(b(this,e))}}function g({_intern:e,_key:t},a){const n=t(a);return e.has(n)?e.get(n):a}function f({_intern:e,_key:t},a){const n=t(a);return e.has(n)?e.get(n):(e.set(n,a),a)}function b({_intern:e,_key:t},a){const n=t(a);return e.has(n)&&(a=e.get(a),e.delete(n)),a}function h(e){return null!==e&&"object"==typeof e?e.valueOf():e}function v(e){return e}function E(e,...t){return w(e,v,v,t)}function x(e,t,...a){return w(e,v,t,a)}function k(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function w(e,t,a,n){return function e(r,i){if(i>=n.length)return a(r);const o=new InternMap,s=n[i++];let l=-1;for(const e of r){const t=s(e,++l,r),a=o.get(t);a?a.push(e):o.set(t,[e])}for(const[t,a]of o)o.set(t,e(a,i));return t(o)}(e,0)}function S(e,t){return Array.from(t,(t=>e[t]))}function j(e,...a){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[n=t]=a;if(1===n.length||a.length>1){const r=Uint32Array.from(e,((e,t)=>t));return a.length>1?(a=a.map((t=>e.map(t))),r.sort(((e,n)=>{for(const r of a){const a=t(r[e],r[n]);if(a)return a}}))):(n=e.map(n),r.sort(((e,a)=>t(n[e],n[a])))),S(e,r)}return e.sort(n)}var O=Array.prototype.slice;function I(e){return function(){return e}}var C=Math.sqrt(50),T=Math.sqrt(10),M=Math.sqrt(2);function _(e,t,a){var n,r,i,o,s=-1;if(a=+a,(e=+e)==(t=+t)&&a>0)return[e];if((n=t<e)&&(r=e,e=t,t=r),0===(o=N(e,t,a))||!isFinite(o))return[];if(o>0){let a=Math.round(e/o),n=Math.round(t/o);for(a*o<e&&++a,n*o>t&&--n,i=new Array(r=n-a+1);++s<r;)i[s]=(a+s)*o}else{o=-o;let a=Math.round(e*o),n=Math.round(t*o);for(a/o<e&&++a,n/o>t&&--n,i=new Array(r=n-a+1);++s<r;)i[s]=(a+s)/o}return n&&i.reverse(),i}function N(e,t,a){var n=(t-e)/Math.max(0,a),r=Math.floor(Math.log(n)/Math.LN10),i=n/Math.pow(10,r);return r>=0?(i>=C?10:i>=T?5:i>=M?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(i>=C?10:i>=T?5:i>=M?2:1)}function D(e,t,a){let n;for(;;){const r=N(e,t,a);if(r===n||0===r||!isFinite(r))return[e,t];r>0?(e=Math.floor(e/r)*r,t=Math.ceil(t/r)*r):r<0&&(e=Math.ceil(e*r)/r,t=Math.floor(t*r)/r),n=r}}function A(e){return Math.ceil(Math.log(l(e))/Math.LN2)+1}function F(){var e=v,t=y,a=A;function n(n){Array.isArray(n)||(n=Array.from(n));var r,o,s=n.length,l=new Array(s);for(r=0;r<s;++r)l[r]=e(n[r],r,n);var c=t(l),u=c[0],d=c[1],p=a(l,u,d);if(!Array.isArray(p)){const e=d,a=+p;if(t===y&&([u,d]=D(u,d,a)),(p=_(u,d,a))[p.length-1]>=d)if(e>=d&&t===y){const e=N(u,d,a);isFinite(e)&&(e>0?d=(Math.floor(d/e)+1)*e:e<0&&(d=(Math.ceil(d*-e)+1)/-e))}else p.pop()}for(var m=p.length;p[0]<=u;)p.shift(),--m;for(;p[m-1]>d;)p.pop(),--m;var g,f=new Array(m+1);for(r=0;r<=m;++r)(g=f[r]=[]).x0=r>0?p[r-1]:u,g.x1=r<m?p[r]:d;for(r=0;r<s;++r)u<=(o=l[r])&&o<=d&&f[i(p,o,0,m)].push(n[r]);return f}return n.value=function(t){return arguments.length?(e="function"==typeof t?t:I(t),n):e},n.domain=function(e){return arguments.length?(t="function"==typeof e?e:I([e[0],e[1]]),n):t},n.thresholds=function(e){return arguments.length?(a="function"==typeof e?e:Array.isArray(e)?I(O.call(e)):I(e),n):a},n}function q(e,t){let a;if(void 0===t)for(const t of e)null!=t&&(a<t||void 0===a&&t>=t)&&(a=t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(a<r||void 0===a&&r>=r)&&(a=r)}return a}function L(e,t){let a;if(void 0===t)for(const t of e)null!=t&&(a>t||void 0===a&&t>=t)&&(a=t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(a>r||void 0===a&&r>=r)&&(a=r)}return a}function R(e,a,n=0,r=e.length-1,i=t){for(;r>n;){if(r-n>600){const t=r-n+1,o=a-n+1,s=Math.log(t),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(t-l)/t)*(o-t/2<0?-1:1);R(e,a,Math.max(n,Math.floor(a-o*l/t+c)),Math.min(r,Math.floor(a+(t-o)*l/t+c)),i)}const t=e[a];let o=n,s=r;for(P(e,n,a),i(e[r],t)>0&&P(e,n,r);o<s;){for(P(e,o,s),++o,--s;i(e[o],t)<0;)++o;for(;i(e[s],t)>0;)--s}0===i(e[n],t)?P(e,n,s):(++s,P(e,s,r)),s<=a&&(n=s+1),a<=s&&(r=s-1)}return e}function P(e,t,a){const n=e[t];e[t]=e[a],e[a]=n}function z(e,t,a){if(n=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let a=-1;for(let n of e)null!=(n=t(n,++a,e))&&(n=+n)>=n&&(yield n)}}(e,a))).length){if((t=+t)<=0||n<2)return L(e);if(t>=1)return q(e);var n,r=(n-1)*t,i=Math.floor(r),o=q(R(e,i).subarray(0,i+1));return o+(L(e.subarray(i+1))-o)*(r-i)}}function B(e,t){let a,n=-1,r=-1;if(void 0===t)for(const t of e)++r,null!=t&&(a<t||void 0===a&&t>=t)&&(a=t,n=r);else for(let i of e)null!=(i=t(i,++r,e))&&(a<i||void 0===a&&i>=i)&&(a=i,n=r);return n}function $(e,t){let a,n=-1,r=-1;if(void 0===t)for(const t of e)++r,null!=t&&(a>t||void 0===a&&t>=t)&&(a=t,n=r);else for(let i of e)null!=(i=t(i,++r,e))&&(a>i||void 0===a&&i>=i)&&(a=i,n=r);return n}function G(e,t){return[e,t]}function U(e,a=t){if(1===a.length)return $(e,a);let n,r=-1,i=-1;for(const t of e)++i,(r<0?0===a(t,t):a(t,n)<0)&&(n=t,r=i);return r}var V=H(Math.random);function H(e){return function(t,a=0,n=t.length){let r=n-(a=+a);for(;r;){const n=e()*r--|0,i=t[r+a];t[r+a]=t[n+a],t[n+a]=i}return t}}function W(e){if(!(r=e.length))return[];for(var t=-1,a=L(e,Y),n=new Array(a);++t<a;)for(var r,i=-1,o=n[t]=new Array(r);++i<r;)o[i]=e[i][t];return n}function Y(e){return e.length}function Z(e){return e instanceof Set?e:new Set(e)}function K(e,t){const a=e[Symbol.iterator](),n=new Set;for(const e of t){if(n.has(e))continue;let t,r;for(;({value:t,done:r}=a.next());){if(r)return!1;if(n.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=F,e.bisect=i,e.bisectCenter=s,e.bisectLeft=o,e.bisectRight=i,e.bisector=a,e.count=l,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),a=(e=e.map(d)).map(c),n=e.length-1,r=new Array(n+1).fill(0),i=[];if(n<0||a.some(u))return i;for(;;){i.push(r.map(((t,a)=>e[a][t])));let o=n;for(;++r[o]===a[o];){if(0===o)return t?i.map(t):i;r[o--]=0}}},e.cumsum=function(e,t){var a=0,n=0;return Float64Array.from(e,void 0===t?e=>a+=+e||0:r=>a+=+t(r,n++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.difference=function(e,...t){e=new Set(e);for(const a of t)for(const t of a)e.delete(t);return e},e.disjoint=function(e,t){const a=t[Symbol.iterator](),n=new Set;for(const t of e){if(n.has(t))return!1;let e,r;for(;({value:e,done:r}=a.next())&&!r;){if(Object.is(t,e))return!1;n.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let a=-1;for(const n of e)if(!t(n,++a,e))return!1;return!0},e.extent=y,e.fcumsum=function(e,t){const a=new Adder;let n=-1;return Float64Array.from(e,void 0===t?e=>a.add(+e||0):r=>a.add(+t(r,++n,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const a=[];let n=-1;for(const r of e)t(r,++n,e)&&a.push(r);return a},e.fsum=function(e,t){const a=new Adder;if(void 0===t)for(let t of e)(t=+t)&&a.add(t);else{let n=-1;for(let r of e)(r=+t(r,++n,e))&&a.add(r)}return+a},e.greatest=function(e,a=t){let n,r=!1;if(1===a.length){let i;for(const o of e){const e=a(o);(r?t(e,i)>0:0===t(e,e))&&(n=o,i=e,r=!0)}}else for(const t of e)(r?a(t,n)>0:0===a(t,t))&&(n=t,r=!0);return n},e.greatestIndex=function(e,a=t){if(1===a.length)return B(e,a);let n,r=-1,i=-1;for(const t of e)++i,(r<0?0===a(t,t):a(t,n)>0)&&(n=t,r=i);return r},e.group=E,e.groupSort=function(e,a,n){return(1===a.length?j(x(e,a,n),(([e,a],[n,r])=>t(a,r)||t(e,n))):j(E(e,n),(([e,n],[r,i])=>a(n,i)||t(e,r)))).map((([e])=>e))},e.groups=function(e,...t){return w(e,Array.from,v,t)},e.histogram=F,e.index=function(e,...t){return w(e,v,k,t)},e.indexes=function(e,...t){return w(e,Array.from,k,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(Z);e:for(const a of e)for(const n of t)if(!n.has(a)){e.delete(a);continue e}return e},e.least=function(e,a=t){let n,r=!1;if(1===a.length){let i;for(const o of e){const e=a(o);(r?t(e,i)<0:0===t(e,e))&&(n=o,i=e,r=!0)}}else for(const t of e)(r?a(t,n)<0:0===a(t,t))&&(n=t,r=!0);return n},e.leastIndex=U,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((a,n)=>t(a,n,e)))},e.max=q,e.maxIndex=B,e.mean=function(e,t){let a=0,n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++a,n+=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(i=+i)>=i&&(++a,n+=i)}if(a)return n/a},e.median=function(e,t){return z(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=L,e.minIndex=$,e.nice=D,e.pairs=function(e,t=G){const a=[];let n,r=!1;for(const i of e)r&&a.push(t(n,i)),n=i,r=!0;return a},e.permute=S,e.quantile=z,e.quantileSorted=function(e,t,a=n){if(r=e.length){if((t=+t)<=0||r<2)return+a(e[0],0,e);if(t>=1)return+a(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+a(e[o],o,e);return s+(+a(e[o+1],o+1,e)-s)*(i-o)}},e.quickselect=R,e.range=function(e,t,a){e=+e,t=+t,a=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+a;for(var n=-1,r=0|Math.max(0,Math.ceil((t-e)/a)),i=new Array(r);++n<r;)i[n]=e+n*a;return i},e.reduce=function(e,t,a){if("function"!=typeof t)throw new TypeError("reducer is not a function");const n=e[Symbol.iterator]();let r,i,o=-1;if(arguments.length<3){if(({done:r,value:a}=n.next()),r)return;++o}for(;({done:r,value:i}=n.next()),!r;)a=t(a,i,++o,e);return a},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=x,e.rollups=function(e,t,...a){return w(e,Array.from,t,a)},e.scan=function(e,t){const a=U(e,t);return a<0?void 0:a},e.shuffle=V,e.shuffler=H,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let a=-1;for(const n of e)if(t(n,++a,e))return!0;return!1},e.sort=j,e.subset=function(e,t){return K(t,e)},e.sum=function(e,t){let a=0;if(void 0===t)for(let t of e)(t=+t)&&(a+=t);else{let n=-1;for(let r of e)(r=+t(r,++n,e))&&(a+=r)}return a},e.superset=K,e.thresholdFreedmanDiaconis=function(e,t,a){return Math.ceil((a-t)/(2*(z(e,.75)-z(e,.25))*Math.pow(l(e),-1/3)))},e.thresholdScott=function(e,t,a){return Math.ceil((a-t)/(3.5*m(e)*Math.pow(l(e),-1/3)))},e.thresholdSturges=A,e.tickIncrement=N,e.tickStep=function(e,t,a){var n=Math.abs(t-e)/Math.max(0,a),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),i=n/r;return i>=C?r*=10:i>=T?r*=5:i>=M&&(r*=2),t<e?-r:r},e.ticks=_,e.transpose=W,e.union=function(...e){const t=new Set;for(const a of e)for(const e of a)t.add(e);return t},e.variance=p,e.zip=function(){return W(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},834:function(e,t,a){!function(e,t){"use strict";var a=new Date,n=new Date;function r(e,t,i,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},s.round=function(e){var t=s(e),a=s.ceil(e);return e-t<a-e?t:a},s.offset=function(e,a){return t(e=new Date(+e),null==a?1:Math.floor(a)),e},s.range=function(a,n,r){var i,o=[];if(a=s.ceil(a),r=null==r?1:Math.floor(r),!(a<n&&r>0))return o;do{o.push(i=new Date(+a)),t(a,r),e(a)}while(i<a&&a<n);return o},s.filter=function(a){return r((function(t){if(t>=t)for(;e(t),!a(t);)t.setTime(t-1)}),(function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;t(e,-1),!a(e););else for(;--n>=0;)for(;t(e,1),!a(e););}))},i&&(s.count=function(t,r){return a.setTime(+t),n.setTime(+r),e(a),e(n),Math.floor(i(a,n))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var i=r((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,a){t.setTime(+t+a*e)}),(function(t,a){return(a-t)/e})):i:null};var o=i.range;const s=1e3,l=6e4,c=36e5,u=864e5,d=6048e5,p=2592e6,m=31536e6;var y=r((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCSeconds()})),g=y.range,f=r((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getMinutes()})),b=f.range,h=r((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s-e.getMinutes()*l)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getHours()})),v=h.range,E=r((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/u),(e=>e.getDate()-1)),x=E.range;function k(e){return r((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/d}))}var w=k(0),S=k(1),j=k(2),O=k(3),I=k(4),C=k(5),T=k(6),M=w.range,_=S.range,N=j.range,D=O.range,A=I.range,F=C.range,q=T.range,L=r((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),R=L.range,P=r((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));P.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,a){t.setFullYear(t.getFullYear()+a*e)})):null};var z=P.range,B=r((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCMinutes()})),$=B.range,G=r((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCHours()})),U=G.range,V=r((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1})),H=V.range;function W(e){return r((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/d}))}var Y=W(0),Z=W(1),K=W(2),Q=W(3),X=W(4),J=W(5),ee=W(6),te=Y.range,ae=Z.range,ne=K.range,re=Q.range,ie=X.range,oe=J.range,se=ee.range,le=r((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ce=le.range,ue=r((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));ue.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,a){t.setUTCFullYear(t.getUTCFullYear()+a*e)})):null};var de=ue.range;function pe(e,a,n,r,o,g){const f=[[y,1,s],[y,5,5e3],[y,15,15e3],[y,30,3e4],[g,1,l],[g,5,3e5],[g,15,9e5],[g,30,18e5],[o,1,c],[o,3,108e5],[o,6,216e5],[o,12,432e5],[r,1,u],[r,2,1728e5],[n,1,d],[a,1,p],[a,3,7776e6],[e,1,m]];function b(a,n,r){const o=Math.abs(n-a)/r,s=t.bisector((([,,e])=>e)).right(f,o);if(s===f.length)return e.every(t.tickStep(a/m,n/m,r));if(0===s)return i.every(Math.max(t.tickStep(a,n,r),1));const[l,c]=f[o/f[s-1][2]<f[s][2]/o?s-1:s];return l.every(c)}return[function(e,t,a){const n=t<e;n&&([e,t]=[t,e]);const r=a&&"function"==typeof a.range?a:b(e,t,a),i=r?r.range(e,+t+1):[];return n?i.reverse():i},b]}const[me,ye]=pe(ue,le,Y,V,G,B),[ge,fe]=pe(P,L,w,E,h,f);e.timeDay=E,e.timeDays=x,e.timeFriday=C,e.timeFridays=F,e.timeHour=h,e.timeHours=v,e.timeInterval=r,e.timeMillisecond=i,e.timeMilliseconds=o,e.timeMinute=f,e.timeMinutes=b,e.timeMonday=S,e.timeMondays=_,e.timeMonth=L,e.timeMonths=R,e.timeSaturday=T,e.timeSaturdays=q,e.timeSecond=y,e.timeSeconds=g,e.timeSunday=w,e.timeSundays=M,e.timeThursday=I,e.timeThursdays=A,e.timeTickInterval=fe,e.timeTicks=ge,e.timeTuesday=j,e.timeTuesdays=N,e.timeWednesday=O,e.timeWednesdays=D,e.timeWeek=w,e.timeWeeks=M,e.timeYear=P,e.timeYears=z,e.utcDay=V,e.utcDays=H,e.utcFriday=J,e.utcFridays=oe,e.utcHour=G,e.utcHours=U,e.utcMillisecond=i,e.utcMilliseconds=o,e.utcMinute=B,e.utcMinutes=$,e.utcMonday=Z,e.utcMondays=ae,e.utcMonth=le,e.utcMonths=ce,e.utcSaturday=ee,e.utcSaturdays=se,e.utcSecond=y,e.utcSeconds=g,e.utcSunday=Y,e.utcSundays=te,e.utcThursday=X,e.utcThursdays=ie,e.utcTickInterval=ye,e.utcTicks=me,e.utcTuesday=K,e.utcTuesdays=ne,e.utcWednesday=Q,e.utcWednesdays=re,e.utcWeek=Y,e.utcWeeks=te,e.utcYear=ue,e.utcYears=de,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(833))},835:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u}));var n=a(19),r=a(44),i=a(2),o=a.n(i),s=a(134);const l="process.name",c="user.name",u=o.a.memo((({contextId:e,eventId:t,isDraggable:a,processName:i,userName:u})=>o.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"user-process",direction:"column",justifyContent:"center",gutterSize:"none"},null!=u?Object(r.uniq)(u).map((r=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:r},o.a.createElement(s.c,{contextId:e,"data-test-subj":"user-name",eventId:t,field:c,isDraggable:a,value:r,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))):null,null!=i?Object(r.uniq)(i).map((r=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:r},o.a.createElement(s.c,{contextId:e,eventId:t,field:l,isDraggable:a,value:r,iconType:"console",isAggregatable:!0,fieldType:"keyword"})))):null)));u.displayName="UserProcess"},836:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(134),o=a(434),s=a(150);const l=r.a.memo((({contextId:e,eventId:t,hostName:a,workingDirectory:n,isDraggable:l})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:e,eventId:t,field:"host.name",value:a,isDraggable:l,fieldType:"keyword",isAggregatable:!0})),null!=n&&r.a.createElement(s.c,{grow:!1,component:"span"},o.e),r.a.createElement(s.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:e,eventId:t,field:"process.working_directory",value:n,iconType:"folderOpen",isDraggable:l,fieldType:"keyword",isAggregatable:!0})))));l.displayName="HostWorkingDir"},837:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(44),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(121),c=a(433),u=a(629),d=a(520),p=a(590),m=a(406),y=a(630),g=a(859),f=a(592),b=a(835),h=a(382),v=a(486),E=a(591),x=a(569),k=a(315);const w=s.a.div.withConfig({displayName:"Details",componentId:"sc-1voakd9-0"})(["margin:5px 0;"]);w.displayName="Details";const S={id:l.e.netflow,isInstance:e=>"network_traffic"===`${Object(n.get)("event.category",e)}`.toLowerCase()||(e=>{const t=`${e}`.toLowerCase();return"network_flow"===t||"netflow_flow"===t})(Object(n.get)("event.action",e)),renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(k.a,null,i.a.createElement(w,null,i.a.createElement(g.a,{contextId:`netflow-row-renderer-render-row-${a}-${e._id}`,destinationBytes:Object(c.a)(Object(n.get)(x.a,e)),destinationGeoContinentName:Object(c.a)(Object(n.get)(E.b,e)),destinationGeoCountryName:Object(c.a)(Object(n.get)(E.d,e)),destinationGeoCountryIsoCode:Object(c.a)(Object(n.get)(E.c,e)),destinationGeoRegionName:Object(c.a)(Object(n.get)(E.e,e)),destinationGeoCityName:Object(c.a)(Object(n.get)(E.a,e)),destinationIp:Object(c.a)(Object(n.get)(m.a,e)),destinationPackets:Object(c.a)(Object(n.get)(x.b,e)),destinationPort:Object(c.a)(Object(n.get)(h.a,e)),eventDuration:Object(c.a)(Object(n.get)(d.b,e)),eventId:Object(n.get)(p.a,e),eventEnd:Object(c.a)(Object(n.get)(f.b,e)),eventStart:Object(c.a)(Object(n.get)(f.c,e)),isDraggable:t,networkBytes:Object(c.a)(Object(n.get)(v.a,e)),networkCommunityId:Object(c.a)(Object(n.get)(v.b,e)),networkDirection:Object(c.a)(Object(n.get)(v.c,e)),networkPackets:Object(c.a)(Object(n.get)(v.d,e)),networkProtocol:Object(c.a)(Object(n.get)(v.e,e)),processName:Object(c.a)(Object(n.get)(b.a,e)),sourceBytes:Object(c.a)(Object(n.get)(x.c,e)),sourceGeoContinentName:Object(c.a)(Object(n.get)(E.h,e)),sourceGeoCountryName:Object(c.a)(Object(n.get)(E.j,e)),sourceGeoCountryIsoCode:Object(c.a)(Object(n.get)(E.i,e)),sourceGeoRegionName:Object(c.a)(Object(n.get)(E.k,e)),sourceGeoCityName:Object(c.a)(Object(n.get)(E.g,e)),sourceIp:Object(c.a)(Object(n.get)(m.d,e)),sourcePackets:Object(c.a)(Object(n.get)(x.d,e)),sourcePort:Object(c.a)(Object(n.get)(h.c,e)),tlsClientCertificateFingerprintSha1:Object(c.a)(Object(n.get)(u.b,e)),tlsFingerprintsJa3Hash:Object(c.a)(Object(n.get)(y.a,e)),tlsServerCertificateFingerprintSha1:Object(c.a)(Object(n.get)(u.c,e)),transport:Object(c.a)(Object(n.get)(v.f,e)),userName:Object(c.a)(Object(n.get)(b.b,e))})))}},838:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(19),o=a(180),s=a(355);const l=({width:e=s.b,dataTestSubj:t,content:a,ariaLabel:n,iconType:l="",isDisabled:c=!1,onClick:u,children:d,buttonType:p="icon"})=>r.a.createElement(r.a.Fragment,null,"icon"===p&&r.a.createElement("div",null,r.a.createElement(o.l,{textAlign:"center",width:e},null!=d?d:r.a.createElement(i.EuiToolTip,{"data-test-subj":`${t}-tool-tip`,content:a},r.a.createElement(i.EuiButtonIcon,{"aria-label":n,"data-test-subj":`${t}-button`,iconType:l,isDisabled:c,onClick:u,size:"s"})))),"text"===p&&r.a.createElement(i.EuiContextMenuItem,{"aria-label":n,"data-test-subj":`${t}-button-menu-item`,disabled:c,onClick:u,color:"text",size:"s"},r.a.createElement(i.EuiText,{"data-test-subj":`${t}-button`,size:"m"},a)),"emptyButton"===p&&r.a.createElement(i.EuiButtonEmpty,{onClick:u,iconType:"timeline",flush:"right",size:"xs","data-test-subj":t},a));l.displayName="ActionIconItemComponent";const c=r.a.memo(l)},839:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(19),r=a(44),i=a(2),o=a.n(i),s=a(121),l=a(432);const c=e=>e?"pinFilled":"pin",u=o.a.memo((({ariaLabel:e,allowUnpinning:t,isAlert:a,isDisabled:i,onClick:u=r.noop,pinned:d,timelineType:p})=>{const m=p===s.m.template,y=(({isAlert:e,isTemplate:t,isPinned:a})=>t?l.b(e):a?l.c(e):l.g(e))({isAlert:a,isTemplate:m,isPinned:d}),g=null==e||m?y:e;return o.a.createElement(n.EuiButtonIcon,{"aria-label":g,"data-test-subj":"pin",iconType:c(d),onClick:u,isDisabled:i||m||!t,size:"s"})}));u.displayName="Pin"},840:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a(1558),i=a(123),o=a(118),s=a(252),l=a(512),c=a(1207),u=a(303);const d=e=>{const{data:t,spaces:a}=Object(o.j)().services,{addWarning:d}=Object(i.a)(),[p,m]=Object(n.useState)(!1),[y,g]=Object(n.useState)(""),f=Object(n.useMemo)((()=>null!=e&&1===e.length),[e]),b=Object(n.useMemo)((()=>null!=e&&f&&"machine_learning"===e[0].type),[f,e]);Object(n.useEffect)((()=>{(async()=>{if(a){const e=await a.getActiveSpace();g(e.id)}})()}),[a]);const h=Object(n.useMemo)((()=>null!=e&&f?"data_view_id"in e[0]&&e[0].data_view_id||null:`security-solution-${y}`),[f,e,y]),v=Object(n.useMemo)((()=>null!=e&&f&&"esql"===e[0].type?Object(r.a)(null==e?void 0:e[0].query):!h&&null!=e&&f&&"index"in e[0]&&null!=e[0].index?e[0].index:[]),[h,f,e]),E=Object(n.useMemo)((()=>{var t;return b&&f&&null!=e&&null!==(t=Object(u.g)(e[0]))&&void 0!==t?t:[]}),[b,f,e]),{mlJobLoading:x,ruleIndices:k}=Object(c.a)(E),w=Object(n.useMemo)((()=>b&&k.length>0?k:null!=h?[]:v),[b,h,v,k]),[S,{indexPatterns:j,dataView:O}]=Object(s.b)(w,!1,"indexFields"),[I,C]=Object(n.useState)(null),[T,M]=Object(n.useState)(null);Object(n.useEffect)((()=>{(async()=>{if(""!==y&&h){m(!0);const e=await t.dataViews.get(h);m(!1),C(e),M(e.toSpec())}})()}),[h,t.dataViews,C,y]);const _=Object(n.useCallback)((async e=>{let a=[];const n=null!=T?T:O;if(!n)return a;try{a=await t.dataViews.getFieldsForIndexPattern(n,{pattern:"",includeUnmapped:!0,fields:e})}catch(e){d(e,{title:l.b})}return a}),[d,t.dataViews,T,O]);return{isLoading:S||x||p,indexPatterns:Object(n.useMemo)((()=>h&&null!=I?I:j),[h,I,j]),getExtendedFields:_}}},841:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(1491),i=a(343),o=a(118);const s=()=>{const{services:{http:e}}=Object(o.j)(),[t,a]=Object(n.useState)(!1),s=Object(n.useRef)(null),{addExceptionListItem:l,updateExceptionListItem:c}=Object(r.a)(e);return Object(n.useEffect)((()=>{const e=new AbortController;return s.current=async e=>{try{a(!0);const t=await Promise.all(e.map((e=>{if("id"in e&&null!=e.id){const t=Object(i.i)(e);return c({listItem:t})}return l({listItem:e})})));return a(!1),t}catch(e){throw a(!1),e}},()=>{a(!1),e.abort()}}),[c,e,l]),[t,s.current]}},842:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"p",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"r",(function(){return y})),a.d(t,"q",(function(){return g})),a.d(t,"h",(function(){return f})),a.d(t,"s",(function(){return b})),a.d(t,"t",(function(){return h})),a.d(t,"j",(function(){return v})),a.d(t,"o",(function(){return E})),a.d(t,"n",(function(){return x})),a.d(t,"m",(function(){return k})),a.d(t,"u",(function(){return w})),a.d(t,"k",(function(){return S})),a.d(t,"v",(function(){return j}));var n=a(4);const r=n.i18n.translate("exceptionList-components.empty.viewer.state.empty.title",{defaultMessage:"Add exceptions to this list"}),i=n.i18n.translate("exceptionList-components.empty.viewer.state.empty.body",{defaultMessage:"There is no exception in your list. Create your first exception."}),o=n.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.search.title",{defaultMessage:"No results match your search criteria"}),s=n.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.body",{defaultMessage:"Try modifying your search"}),l=e=>n.i18n.translate("exceptionList-components.empty.viewer.state.empty.viewer_button",{values:{exceptionType:e},defaultMessage:"Create {exceptionType} exception"}),c=n.i18n.translate("exceptionList-components.empty.viewer.state.error_title",{defaultMessage:"Unable to load exception items"}),u=n.i18n.translate("exceptionList-components.empty.viewer.state.error_body",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),d=n.i18n.translate("exceptionList-components.exception_list_header_export_action",{defaultMessage:"Export exception list"}),p=n.i18n.translate("exceptionList-components.exception_list_header_delete_action",{defaultMessage:"Delete exception list"}),m=n.i18n.translate("exceptionList-components.exception_list_header_duplicate_action",{defaultMessage:"Duplicate exception list"}),y=n.i18n.translate("exceptionList-components.exception_list_header_link_rules_button",{defaultMessage:"Link rules"}),g=e=>n.i18n.translate("exceptionList-components.exception_list_header_linked_rules",{values:{noOfRules:e},defaultMessage:"Linked to {noOfRules} rules"}),f=n.i18n.translate("exceptionList-components.exception_list_header_breadcrumb",{defaultMessage:"Shared Exception Lists"}),b=n.i18n.translate("exceptionList-components.exception_list_header_list_id",{defaultMessage:"List ID"}),h=n.i18n.translate("exceptionList-components.exception_list_header_name",{defaultMessage:"Add a name"}),v=n.i18n.translate("exceptionList-components.exception_list_header_description",{defaultMessage:"Add a description"}),E=e=>n.i18n.translate("exceptionList-components.exception_list_header_edit_modal_name",{defaultMessage:"Edit {listName}",values:{listName:e}}),x=n.i18n.translate("exceptionList-components.exception_list_header_edit_modal_save_button",{defaultMessage:"Save"}),k=n.i18n.translate("exceptionList-components.exception_list_header_edit_modal_cancel_button",{defaultMessage:"Cancel"}),w=n.i18n.translate("exceptionList-components.exception_list_header_Name_textbox",{defaultMessage:"Name"}),S=n.i18n.translate("exceptionList-components.exception_list_header_description_textbox",{defaultMessage:"Description (optional)"}),j=n.i18n.translate("exceptionList-components.exception_list_header_description_textboxexceptionList-components.exception_list_header_name_required_eror",{defaultMessage:"List name cannot be empty"})},843:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(361);const r=(e,t)=>{const a=Object(n.h)(e),r=Object(n.b)(e);return"create"===t?r:a}},844:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a.n(n),i=a(19),o=a(126);const s=Object(n.memo)((({title:e,subtitle:t,actions:a,children:s,restrictWidth:l=!1,hasBottomBorder:c=!0,hideHeader:u=!1,headerBackComponent:d,...p})=>{const m=Object(n.useMemo)((()=>r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},r.a.createElement(i.EuiFlexItem,{grow:!1},d&&r.a.createElement(r.a.Fragment,null,d)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"l"},r.a.createElement("span",{"data-test-subj":"header-page-title"},e))))),[d,e]),y=Object(n.useMemo)((()=>t?r.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},t):void 0),[t]),g=Object(o.a)(p["data-test-subj"]);return r.a.createElement("div",p,!u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiPageHeader,{pageTitle:m,description:y,bottomBorder:c,rightSideItems:a?[a]:void 0,restrictWidth:l,"data-test-subj":g("header")}),r.a.createElement(i.EuiSpacer,{size:"l"})),r.a.createElement(i.EuiPageSection,{paddingSize:"none",color:"transparent",restrictWidth:l},s))}));s.displayName="AdministrationListPage"},845:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(297);const i=["create","edit"],o=(e=!0,t=!0)=>{var a;const o=null!==(a=Object(r.a)().urlParams.show)&&void 0!==a?a:"";return Object(n.useMemo)((()=>!!i.includes(o)&&("create"===o&&t||"edit"===o&&e)),[t,e,o])}},846:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(42),c=a(126),u=a(245);const d=Object(i.memo)((({indicateExtraEntry:e=!1,"data-test-subj":t,...a})=>{const n=Object(c.a)(t);return o.a.createElement(s.EuiToolTip,r()({},a,{content:o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltip",defaultMessage:"Filtering the descendants of a process means that events from the matched process are ingested, but events from its descendant processes are omitted."})),e&&o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltipExtraEntry",defaultMessage:"Note: the following additional condition is applied:"})),o.a.createElement("p",null,o.a.createElement("code",null,u.g))),o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltipVersionInfo",defaultMessage:"Process descendant filtering works only with Agents v8.15 and newer."}))),"data-test-subj":n("tooltipText")}),o.a.createElement(s.EuiIcon,{type:"iInCircle","data-test-subj":n("tooltipIcon")}))}));d.displayName="ProcessDescendantsTooltip"},859:function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n=a(19),r=a(2),i=a.n(r),o=a(44),s=a(629),l=a(630);const c=i.a.memo((({contextId:e,eventId:t,isDraggable:a,tlsClientCertificateFingerprintSha1:r,tlsFingerprintsJa3Hash:c,tlsServerCertificateFingerprintSha1:u})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"fingerprints-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=c?Object(o.uniq)(c).map((r=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:r},i.a.createElement(l.b,{eventId:t,fieldName:l.a,contextId:e,isDraggable:a,value:r})))):null,null!=r?Object(o.uniq)(r).map((r=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:r},i.a.createElement(s.a,{eventId:t,certificateType:"client",contextId:e,fieldName:s.b,isDraggable:a,value:r})))):null,null!=u?Object(o.uniq)(u).map((r=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:r},i.a.createElement(s.a,{eventId:t,certificateType:"server",contextId:e,fieldName:s.c,isDraggable:a,value:r})))):null)));c.displayName="Fingerprints";var u=a(41),d=a.n(u),p=a(137),m=a(134),y=a(486);const g="questionInCircle",f=e=>{if(null==e)return g;switch(`${e}`.toLowerCase()){case p.l.outbound:case p.l.outgoing:return"arrowUp";case p.l.inbound:case p.l.incoming:case p.l.listening:return"arrowDown";case p.l.external:return"globe";case p.l.internal:return"bullseye";case p.l.unknown:default:return g}},b=i.a.memo((({contextId:e,eventId:t,direction:a,isDraggable:n})=>i.a.createElement(m.c,{contextId:e,eventId:t,field:y.c,iconType:f(a),isDraggable:n,value:a,isAggregatable:!0,fieldType:"keyword"})));b.displayName="DirectionBadge";var h=a(832),v=a(665);const E=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-10udnrm-0"})(["margin-right:3px;"]);E.displayName="EuiFlexItemMarginRight";const x=d()(n.EuiText).withConfig({displayName:"Stats",componentId:"sc-10udnrm-1"})(["margin:0 5px;"]);x.displayName="Stats";const k=i.a.memo((({bytes:e,communityId:t,contextId:a,direction:r,eventId:s,isDraggable:l,packets:c,protocol:u,transport:d})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none"},null!=r?Object(o.uniq)(r).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(b,{contextId:a,direction:e,eventId:s,isDraggable:l})))):null,null!=u?Object(o.uniq)(u).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.c,{contextId:a,eventId:s,field:y.e,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=e?Object(o.uniq)(e).map((e=>isNaN(Number(e))?null:i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.b,{field:y.a,id:`network-default-draggable-${a}-${s}-${y.a}-${e}`,isDraggable:l,value:e},i.a.createElement(x,{size:"xs"},i.a.createElement("span",null,i.a.createElement(v.a,{value:e}))))))):null,null!=c?Object(o.uniq)(c).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.b,{field:y.d,id:`network-default-draggable-${a}-${s}-${y.d}-${e}`,isDraggable:l,value:e},i.a.createElement(x,{size:"xs"},i.a.createElement("span",null,`${e} ${h.a}`)))))):null,null!=d?Object(o.uniq)(d).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.c,{contextId:a,"data-test-subj":"network-transport",eventId:s,field:y.f,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=t?Object(o.uniq)(t).map((e=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:e},i.a.createElement(m.c,{contextId:a,eventId:s,field:y.b,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null)));k.displayName="Network";var w=a(569),S=a(188),j=a.n(S),O=a(406),I=a(1102),C=a(382),T=a(434),M=a(591);const _=d.a.span.withConfig({displayName:"IpPortSeparator",componentId:"sc-12b0nt-0"})(["margin:0 3px;"]);_.displayName="IpPortSeparator";const N=i.a.memo((({contextId:e,eventId:t,isDraggable:a,port:r,portFieldName:o})=>null!=r?i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(_,{"data-test-subj":"ip-port-separator"},":")),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:t,fieldName:o,isDraggable:a,value:r}))):null));N.displayName="PortWithSeparator";const D=i.a.memo((({contextId:e,eventId:t,ip:a,ipFieldName:r,isDraggable:o,port:s,portFieldName:l})=>i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(O.c,{contextId:e,"data-test-subj":"ip",eventId:t,fieldName:r,isDraggable:o,value:a})),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(N,{contextId:e,eventId:t,isDraggable:o,port:s,portFieldName:l})))));D.displayName="IpWithPort";const A=d.a.div.withConfig({displayName:"Label",componentId:"sc-1ym4dlz-0"})(["font-weight:bold;margin-top:2px;"]),F=({destinationIp:e,sourceIp:t,type:a})=>"source"===a&&null!=t&&t.some((e=>!Object(o.isEmpty)(e)))||"destination"===a&&null!=e&&e.some((e=>!Object(o.isEmpty)(e))),q=({destinationPort:e,sourcePort:t,type:a})=>("source"===a&&null!=t?t:"destination"===a&&null!=e?e:[]).filter((e=>null!=e)).map((e=>`${e}`)).filter((e=>!Object(o.isEmpty)(e))),L=i.a.memo((({contextId:e,destinationIp:t,destinationPort:a,eventId:r,isDraggable:s,sourceIp:l,sourcePort:c,type:u})=>{const d="source"===u?l:t,p="source"===u?O.d:O.a,m="source"===u?c:a,y="source"===u?C.c:C.a;if(null==d)return null;const g=null!=m&&d.length===m.length?d.map(((e,t)=>({ip:e,port:null!=m[t]?`${m[t]}`:null}))):d.map((e=>({ip:e,port:null})));return i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},Object(o.uniqWith)(j.a,g).map((t=>null!=t.ip&&i.a.createElement(n.EuiFlexItem,{grow:!1,key:t.ip},i.a.createElement(D,{contextId:e,"data-test-subj":`${u}-ip-and-port`,eventId:r,ip:t.ip,ipFieldName:p,isDraggable:s,port:t.port,portFieldName:y})))))}));L.displayName="IpAdressesWithPorts";const R=i.a.memo((({contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:a,destinationGeoCountryIsoCode:r,destinationGeoRegionName:o,destinationGeoCityName:s,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:y,sourceGeoRegionName:g,sourceGeoCityName:f,sourceIp:b,sourcePort:h,type:v})=>{const E="source"===v?T.i:T.c;return F({destinationIp:l,sourceIp:b,type:v})||(({destinationPort:e,sourcePort:t,type:a})=>q({destinationPort:e,sourcePort:t,type:a}).length>0)({destinationPort:c,sourcePort:h,type:v})?i.a.createElement(n.EuiBadge,{"data-test-subj":`${v}-ip-badge`,color:"hollow",title:""},i.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":`${v}-ip-group`,direction:"column",gutterSize:"xs"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(A,null,E)),i.a.createElement(n.EuiFlexItem,{grow:!1},F({destinationIp:l,sourceIp:b,type:v})?i.a.createElement(L,{contextId:e,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceIp:b,sourcePort:h,type:v}):i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},q({destinationPort:c,sourcePort:h,type:v}).map(((t,a)=>i.a.createElement(n.EuiFlexItem,{key:`port-${t}-${a}`,grow:!1},i.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:u,fieldName:`${v}.port`,isDraggable:d,value:t})))))),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(M.f,{contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:a,destinationGeoCountryIsoCode:r,destinationGeoRegionName:o,destinationGeoCityName:s,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:y,sourceGeoRegionName:g,sourceGeoCityName:f,type:v})))):null}));R.displayName="SourceDestinationIp";const P=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:y,sourceGeoContinentName:g,sourceGeoCountryName:f,sourceGeoCountryIsoCode:b,sourceGeoRegionName:h,sourceGeoCityName:v,sourcePackets:E,sourceIp:x,sourcePort:k})=>i.a.createElement(n.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(R,{contextId:e,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:f,sourceGeoCountryIsoCode:b,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:k,type:"source"})),i.a.createElement(w.e,{contextId:e,destinationBytes:t,destinationPackets:u,eventId:p,isDraggable:m,sourceBytes:y,sourcePackets:E}),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(R,{contextId:e,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:f,sourceGeoCountryIsoCode:b,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:k,type:"destination"})))));P.displayName="SourceDestinationWithArrows";const z=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginTop",componentId:"sc-ru6rd-0"})(["margin-top:3px;"]);z.displayName="EuiFlexItemMarginTop";const B=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,networkBytes:y,networkCommunityId:g,networkDirection:f,networkPackets:b,networkProtocol:h,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:w,sourceGeoRegionName:S,sourceGeoCityName:j,sourceIp:O,sourcePackets:I,sourcePort:C,transport:T})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center",direction:"column",justifyContent:"center",gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(k,{bytes:y,packets:b,communityId:g,contextId:e,direction:f,eventId:p,isDraggable:m,protocol:h,transport:T})),i.a.createElement(z,{grow:!1},i.a.createElement(P,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:w,sourceGeoRegionName:S,sourceGeoCityName:j,sourceIp:O,sourcePackets:I,sourcePort:C})))));B.displayName="SourceDestination";var $=a(592),G=a(835);const U=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-ub9rva-0"})(["margin-right:10px;"]);U.displayName="EuiFlexItemMarginRight";const V=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventDuration:p,eventId:m,eventEnd:y,eventStart:g,isDraggable:f,networkBytes:b,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,processName:k,sourceBytes:w,sourceGeoContinentName:S,sourceGeoCountryName:j,sourceGeoCountryIsoCode:O,sourceGeoRegionName:I,sourceGeoCityName:C,sourceIp:T,sourcePackets:M,sourcePort:_,transport:N,userName:D})=>i.a.createElement(n.EuiFlexGroup,{"data-test-subj":"netflow-columns",gutterSize:"none",justifyContent:"center",wrap:!0},i.a.createElement(U,{grow:!1},i.a.createElement(G.c,{contextId:e,eventId:m,isDraggable:f,processName:k,userName:D})),i.a.createElement(U,{grow:!1},i.a.createElement($.a,{contextId:e,eventDuration:p,eventId:m,eventEnd:y,eventStart:g,isDraggable:f})),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(B,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:m,isDraggable:f,networkBytes:b,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,sourceBytes:w,sourceGeoContinentName:S,sourceGeoCountryName:j,sourceGeoCountryIsoCode:O,sourceGeoRegionName:I,sourceGeoCityName:C,sourceIp:T,sourcePackets:M,sourcePort:_,transport:N})))));V.displayName="NetflowColumns";const H=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:y,eventEnd:g,eventStart:f,isDraggable:b,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:k,processName:w,sourceBytes:S,sourceGeoContinentName:j,sourceGeoCountryName:O,sourceGeoCountryIsoCode:I,sourceGeoRegionName:C,sourceGeoCityName:T,sourcePackets:M,sourceIp:_,sourcePort:N,tlsClientCertificateFingerprintSha1:D,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:F,transport:q,userName:L})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"netflow-rows",direction:"column",justifyContent:"center",wrap:!0,gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(V,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:y,eventEnd:g,eventStart:f,isDraggable:b,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:k,processName:w,sourceBytes:S,sourceGeoContinentName:j,sourceGeoCountryName:O,sourceGeoCountryIsoCode:I,sourceGeoRegionName:C,sourceGeoCityName:T,sourceIp:_,sourcePackets:M,sourcePort:N,transport:q,userName:L})),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(c,{contextId:e,eventId:y,isDraggable:b,tlsClientCertificateFingerprintSha1:D,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:F})))));H.displayName="Netflow"},861:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(121),r=a(7),i=a(41),o=a.n(i),s=a(5),l=a(195);const c=o.a.div.withConfig({displayName:"HorizontalSpacer",componentId:"sc-1o769t7-0"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeXS));var u=a(19),d=a(2),p=a.n(d),m=a(590),y=a(315),g=a(44),f=a(42),b=a(134);const h=({contextId:e,eventId:t,isDraggable:a,sourceField:n,sourceValue:r})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-details-source-field",eventId:t,field:l.g,isDraggable:a,value:n,isAggregatable:!0,fieldType:"keyword"})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,p.a.createElement(f.FormattedMessage,{defaultMessage:"matched",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.matchedVerb"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-details-source-value",eventId:t,field:n,isDraggable:a,value:r,isAggregatable:!0,fieldType:"keyword"})));var v=a(422);const E=({contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:r,isDraggable:i})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"threat-match-indicator-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},r&&p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-type",eventId:t,field:l.h,isDraggable:i,value:r,isAggregatable:!0,fieldType:"keyword"})),a&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1,component:"span"},p.a.createElement(c,null,p.a.createElement(f.FormattedMessage,{defaultMessage:"provided by",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.providerPreposition"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-feedName",eventId:t,field:l.e,isDraggable:i,value:a,isAggregatable:!0,fieldType:"keyword"}))),n&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,":")),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(v.a,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-reference",eventId:t,fieldName:l.j,isDraggable:i,value:n,isAggregatable:!0,fieldType:"keyword"})))),x=({contextId:e,data:t,eventId:a,isDraggable:n})=>{const r={contextId:e,eventId:a,indicatorReference:Object(g.getOr)([],l.p,t)[0],feedName:Object(g.getOr)([],l.e,t)[0],indicatorType:Object(g.getOr)([],l.n,t)[0],isDraggable:n,sourceField:Object(g.get)(l.l,t)[0],sourceValue:Object(g.get)(l.k,t)[0]};return p.a.createElement(k,r)},k=({contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:r,isDraggable:i,sourceField:o,sourceValue:s})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-row",gutterSize:"s",justifyContent:"center"},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(h,{contextId:e,eventId:t,isDraggable:i,sourceField:o,sourceValue:s})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(E,{contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:r,isDraggable:i})));var w=a(434);const S=o.a.div.withConfig({displayName:"SpacedContainer",componentId:"sc-e4rhpb-0"})(["margin:"," 0;"],(({theme:e})=>e.eui.euiSizeS)),j=({data:e,isDraggable:t,scopeId:a})=>{const n=Object(r.get)(e,s.yb),i=Object(r.get)(e,m.a),o=Object(d.useCallback)(((e="max")=>{const r="max"===e?n.slice(0,2):n;return p.a.createElement(y.a,{"data-test-subj":"threat-match-row-renderer"},p.a.createElement(S,null,r.map(((e,r)=>{const o=`threat-match-row-${a}-${i}-${r}`;return p.a.createElement(d.Fragment,{key:o},p.a.createElement(x,{contextId:o,data:e,eventId:i,isDraggable:t}),r<n.length-1&&p.a.createElement(u.EuiHorizontalRule,{margin:"s"}))}))))}),[n,i,t,a]),l=Object(d.useCallback)((()=>o("all")),[o]);return p.a.createElement(u.EuiFlexGroup,{direction:"column",justifyContent:"center",alignItems:"center",gutterSize:"none"},p.a.createElement(u.EuiFlexItem,null,o()),n.length>2&&p.a.createElement(u.EuiFlexItem,null,p.a.createElement(O,{title:Object(w.h)(n.length),renderChildren:l})))},O=({title:e,renderChildren:t})=>{const[a,n]=Object(d.useState)(!1),r=()=>n(!1);let i;return a&&(i=p.a.createElement(u.EuiModal,{onClose:r},p.a.createElement(u.EuiModalHeader,{"data-test-subj":"threat-match-row-modal"},p.a.createElement(u.EuiModalHeaderTitle,null,w.b)),p.a.createElement(u.EuiModalBody,null,t()),p.a.createElement(u.EuiModalFooter,null,p.a.createElement(u.EuiButton,{onClick:r,fill:!0},w.a)))),p.a.createElement("div",null,p.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"threat-match-row-show-all",iconType:"popout",color:"primary",onClick:()=>n(!0)},e),i)},I={id:n.e.threat_match,isInstance:e=>(e=>{const t=Object(r.get)(e,s.yb);return null==t?[]:Array.isArray(t)?t:[t]})(e).some((e=>l.i.some((t=>!Object(r.isEmpty)(Object(r.get)(e,t)))))),renderRow:({data:e,isDraggable:t,scopeId:a})=>p.a.createElement(j,{data:e,isDraggable:t,scopeId:a})}},863:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(44),r=a(2),i=a.n(r),o=a(121),s=a(315),l=a(19),c=a(41),u=a.n(c),d=a(278),p=a(363),m=a(222),y=a(144),g=a(416),f=a(150);const b=["IPv4","IPv6"];var h=a(134),v=a(179);const E="suricata.eve.alert.signature",x="suricata.eve.alert.signature_id",k=u()(l.EuiFlexItem).withConfig({displayName:"SignatureFlexItem",componentId:"sc-1paeiel-0"})(["min-width:77px;"]);k.displayName="SignatureFlexItem";const w=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1paeiel-1"})(["vertical-align:top;"]);w.displayName="Badge";const S=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1paeiel-2"})(["margin-left:6px;"]);S.displayName="LinkFlexItem";const j=i.a.memo((({tokens:e})=>i.a.createElement(i.a.Fragment,null,e.map((e=>i.a.createElement(f.c,{key:e,grow:!1},i.a.createElement(l.EuiBadge,{iconType:"tag",color:"hollow",title:""},e)))))));j.displayName="Tokens";const O=i.a.memo((({id:e,isDraggable:t,signatureId:a})=>{const n=Object(r.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`suricata-draggable-signature-id-${e}-sig-${a}`),name:String(a),excluded:!1,kqlQuery:"",queryMatch:{field:x,value:a,operator:v.d}})),[e,a]),o=Object(r.useCallback)(((e,t,n)=>n.isDragging?i.a.createElement(p.a,null,i.a.createElement(g.a,{dataProvider:e})):i.a.createElement(l.EuiToolTip,{"data-test-subj":"signature-id-tooltip",content:x},i.a.createElement(w,{iconType:"number",color:"hollow",title:""},a))),[a]);return i.a.createElement(k,{grow:!1},i.a.createElement(p.b,{dataProvider:n,isDraggable:t,render:o,isAggregatable:!0,fieldType:"keyword"}))}));O.displayName="DraggableSignatureId";const I=i.a.memo((({contextId:e,id:t,isDraggable:a,signature:n,signatureId:r})=>{const o=(e=>e.trim().split(" ").reduce(((e,t,a)=>e.length===a&&t===t.toUpperCase()&&""!==t||b.includes(t)?[...e,t]:e),[]))(n);return i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(O,{id:`draggable-signature-id-${e}-${t}`,isDraggable:a,signatureId:r}),i.a.createElement(j,{tokens:o}),i.a.createElement(S,{grow:!1},i.a.createElement(h.b,{"data-test-subj":"draggable-signature-link",field:E,id:`suricata-signature-default-draggable-${e}-${t}-${E}`,isDraggable:a,value:n,tooltipPosition:"bottom"},i.a.createElement("div",null,i.a.createElement(y.c,{link:n},n.split(" ").splice(o.length).join(" "))))))}));I.displayName="SuricataSignature";const C=u()(l.EuiFlexItem).withConfig({displayName:"LinkEuiFlexItem",componentId:"sc-i69i1c-0"})(["display:inline;"]);C.displayName="LinkEuiFlexItem";const T=i.a.memo((({signatureId:e})=>{const[t,o]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{let t=!0;return async function(){if(null!=e)try{const r=await(async e=>{const t=(await a.e(25).then(a.t.bind(null,2097,7))).db,r=(i=t,o=e,Object.prototype.hasOwnProperty.call(i,o)?t[e]:null);var i,o;return null!=r?Object(n.uniq)(r):[]})(e);t&&null!=r&&o(r)}catch(e){o(void 0)}else t&&o(void 0)}(),()=>{t=!1}}),[e]),i.a.createElement(l.EuiFlexGroup,{"data-test-subj":"suricataRefs",gutterSize:"none",justifyContent:"center",wrap:!0},t&&t.map((e=>i.a.createElement(C,{key:e,grow:!1},i.a.createElement(l.EuiLink,{href:e,color:"subdued",target:"_blank"},e)))))}));T.displayName="SuricataRefs";const M=u.a.div.withConfig({displayName:"Details",componentId:"sc-1y9aljy-0"})(["margin:5px 0;"]);M.displayName="Details";const _=i.a.memo((({data:e,isDraggable:t,timelineId:a})=>{const r=Object(n.get)("suricata.eve.alert.signature[0]",e),o=Object(n.get)("suricata.eve.alert.signature_id[0]",e);return null!=o&&null!=r?i.a.createElement(M,null,i.a.createElement(I,{contextId:`suricata-signature-${a}-${e._id}`,id:e._id,isDraggable:t,signature:r,signatureId:o}),i.a.createElement(T,{signatureId:o}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:t,timelineId:a})):null}));_.displayName="SuricataDetails";const N={id:o.e.suricata,isInstance:e=>{const t=Object(n.get)("event.module[0]",e);return null!=t&&"suricata"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(s.a,null,i.a.createElement(_,{data:e,isDraggable:t,timelineId:a}))}},865:function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n=a(44),r=a(2),i=a.n(r),o=a(121),s=a(315),l=a(19),c=a(41),u=a.n(c),d=a(278),p=a(363),m=a(222),y=a(144),g=a(416),f=a(179),b=a(4);const h=b.i18n.translate("xpack.securitySolution.zeek.s0Description",{defaultMessage:"Connection attempt seen, no reply"}),v=b.i18n.translate("xpack.securitySolution.zeek.s1Description",{defaultMessage:"Connection established, not terminated"}),E=b.i18n.translate("xpack.securitySolution.zeek.s2Description",{defaultMessage:"Connection established and close attempt by originator seen (but no reply from responder)"}),x=b.i18n.translate("xpack.securitySolution.zeek.s3Description",{defaultMessage:"Connection established and close attempt by responder seen (but no reply from originator)"}),k=b.i18n.translate("xpack.securitySolution.zeek.sfDescription",{defaultMessage:"Normal SYN/FIN completion"}),w=b.i18n.translate("xpack.securitySolution.zeek.rejDescription",{defaultMessage:"Connection attempt rejected"}),S=b.i18n.translate("xpack.securitySolution.zeek.rstoODescription",{defaultMessage:"Connection established, originator aborted (sent a RST)"}),j=b.i18n.translate("xpack.securitySolution.zeek.rstrDescription",{defaultMessage:"Established, responder aborted"}),O=b.i18n.translate("xpack.securitySolution.zeek.rstosoDescription",{defaultMessage:"Originator sent a SYN followed by a RST, no SYN-ACK from the responder"}),I=b.i18n.translate("xpack.securitySolution.zeek.rstrhDescription",{defaultMessage:"Responder sent a SYN ACK followed by a RST, no SYN from the (purported) originator"}),C=b.i18n.translate("xpack.securitySolution.zeek.shDescription",{defaultMessage:"Originator sent a SYN followed by a FIN, no SYN ACK from the responder"}),T=b.i18n.translate("xpack.securitySolution.zeek.shrDescription",{defaultMessage:"Responder sent a SYN ACK followed by a FIN, no SYN from the originator"}),M=b.i18n.translate("xpack.securitySolution.zeek.othDescription",{defaultMessage:"No SYN seen, just midstream traffic"}),_=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1b5gq3p-0"})(["vertical-align:top;"]);_.displayName="Badge";const N=u()(l.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1b5gq3p-1"})(["margin-left:3px;"]);N.displayName="TokensFlexItem";const D=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1b5gq3p-2"})(["margin-left:6px;"]);D.displayName="LinkFlexItem";const A=e=>e,F=e=>{const t=e.split(".");return t.length>=2&&null!=t[1]?""!==t[1]?t[1]:t[0]:e},q=e=>`Dropped:${e}`,L=e=>`md5: ${e.substr(0,7)}...`,R=e=>`sha1: ${e.substr(0,7)}...`,P=i.a.memo((({id:e,field:t,isDraggable:a,value:n,stringRenderer:o=A})=>{const s=Object(r.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`draggable-zeek-element-draggable-wrapper-${e}-${t}-${n}`),name:String(n),excluded:!1,kqlQuery:"",queryMatch:{field:t,value:String(n),operator:f.d}})),[t,e,n]),c=Object(r.useCallback)(((e,a,r)=>r.isDragging?i.a.createElement(p.a,null,i.a.createElement(g.a,{dataProvider:e})):i.a.createElement(l.EuiToolTip,{"data-test-subj":"badge-tooltip",content:t},i.a.createElement(_,{iconType:"tag",color:"hollow",title:""},o(String(n))))),[t,o,n]);return null!=n?i.a.createElement(N,{grow:!1},i.a.createElement(p.b,{dataProvider:s,isDraggable:a,render:c,isAggregatable:!0,fieldType:"keyword"})):null}));P.displayName="DraggableZeekElement";const z=i.a.memo((({value:e,link:t})=>null!=e?null!=t?i.a.createElement(D,{grow:!1},i.a.createElement("div",null,i.a.createElement(y.c,{link:t},e))):i.a.createElement(D,{grow:!1},i.a.createElement("div",null,i.a.createElement(y.c,{link:e}))):null));z.displayName="Link";const B=i.a.memo((({value:e})=>null!=e?i.a.createElement(D,{grow:!1},i.a.createElement("div",null,i.a.createElement(y.j,{domain:e,overflowIndexStart:1,showDomain:!0,"data-test-subj":"reputationLinkSha"}))):null));B.displayName="TotalVirusLinkSha";const $={S0:h,S1:v,S2:E,S3:x,SF:k,REJ:w,RSTO:S,RSTR:j,RSTOS0:O,RSTRH:I,SH:C,SHR:T,OTH:M},G=i.a.memo((({data:e,isDraggable:t,timelineId:a})=>{const r=`zeek-signature-draggable-zeek-element-${a}-${e._id}`,o=Object(n.get)("zeek.session_id[0]",e),s=Object(n.get)("event.dataset[0]",e),c=Object(n.get)("zeek.ssl.version[0]",e),u=Object(n.get)("zeek.ssl.cipher[0]",e),d=Object(n.get)("zeek.connection.state[0]",e),p=Object(n.get)("zeek.connection.history[0]",e),m=Object(n.get)("zeek.notice.note[0]",e),y=Object(n.get)("zeek.notice.msg[0]",e),g=(e=>null!=e?String(e):null)(Object(n.get)("zeek.notice.dropped[0]",e)),f=Object(n.get)("zeek.dns.query[0]",e),b=Object(n.get)("zeek.dns.qclass_name[0]",e),h=Object(n.get)("http.request.method[0]",e),v=Object(n.get)("http.response.status_code[0]",e),E=Object(n.get)("url.original[0]",e),x=Object(n.get)("zeek.files.sha1[0]",e),k=Object(n.get)("zeek.files.md5[0]",e),w=(e=>{if(null!=e){const t=$[e];return null!=t?`${e} ${t}`:e}return null})(d),S=(e=>null!=e&&null!=$[e]?$[e]:null)(d);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(P,{id:r,field:"zeek.session_id",isDraggable:t,value:o}),i.a.createElement(P,{id:r,field:"event.dataset",isDraggable:t,value:s,stringRenderer:F}),i.a.createElement(P,{id:r,field:"zeek.files.sha1",isDraggable:t,value:x,stringRenderer:R}),i.a.createElement(P,{id:r,field:"zeek.files.md5",isDraggable:t,value:k,stringRenderer:L}),i.a.createElement(P,{id:r,field:"zeek.notice.dropped",isDraggable:t,value:g,stringRenderer:q}),i.a.createElement(P,{id:r,field:"zeek.ssl.version",isDraggable:t,value:c}),i.a.createElement(P,{id:r,field:"zeek.ssl.cipher",isDraggable:t,value:u}),i.a.createElement(P,{id:r,field:"zeek.connection.state",isDraggable:t,value:d}),i.a.createElement(P,{id:r,field:"http.request.method",isDraggable:t,value:h}),i.a.createElement(P,{id:r,field:"zeek.connection.history",isDraggable:t,value:p}),i.a.createElement(P,{id:r,field:"zeek.notice.note",isDraggable:t,value:m}),i.a.createElement(P,{id:r,field:"zeek.dns.query",isDraggable:t,value:f}),i.a.createElement(P,{id:r,field:"zeek.dns.qclass_name",isDraggable:t,value:b}),i.a.createElement(P,{id:r,field:"http.response.status_code",isDraggable:t,value:v})),i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(z,{link:w,value:S}),i.a.createElement(z,{value:u}),i.a.createElement(z,{value:f}),i.a.createElement(z,{value:y}),i.a.createElement(z,{value:E}),i.a.createElement(B,{value:x})))}));G.displayName="ZeekSignature";const U=u.a.div.withConfig({displayName:"Details",componentId:"sc-1ixpiaf-0"})(["margin:5px 0;"]);U.displayName="Details";const V=i.a.memo((({data:e,isDraggable:t,timelineId:a})=>null!=e.zeek?i.a.createElement(U,null,i.a.createElement(G,{data:e,isDraggable:t,timelineId:a}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:t,timelineId:a})):null));V.displayName="ZeekDetails";const H={id:o.e.zeek,isInstance:e=>{const t=Object(n.get)("event.module[0]",e);return null!=t&&"zeek"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(s.a,null,i.a.createElement(V,{data:e,isDraggable:t,timelineId:a}))}},868:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a.n(n),i=a(19),o=a(7),s=a(4);const l=s.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.addToSelectedRulesDescription",{defaultMessage:"After you create the exception, it is added to the rules you link. "});var c=a(595),u=a(354);const d=Object(n.memo)((({rule:e,linkedRules:t,onRuleLinkChange:a})=>{const o=Object(n.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(n.useCallback)((({target:{checked:n}})=>{const r=n?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof a&&a(r)}),[t,a,e]);return r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSwitch,{onChange:s,label:"",checked:o}))}));d.displayName="LinkRuleSwitch";var p=a(781);const m=({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{isLoading:a,searchOptions:m,pagination:y,sortedRulesByLinkedRulesOnTop:g,rulesTableColumnsWithLinkSwitch:f,onTableChange:b,addToSelectedRulesDescription:h}=(({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{data:{rules:a}={rules:[],total:0},isFetched:i}=Object(p.a)({filterOptions:{filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:void 0,pagination:{page:1,perPage:1e4}}),[m,y]=Object(n.useState)({pageIndex:0,initialPageSize:25,showPerPageOptions:!1}),[g,f]=Object(n.useState)(e||[]);Object(n.useEffect)((()=>{t(g)}),[g,t]);const b=Object(n.useMemo)((()=>Object(o.sortBy)(a,[t=>null==e?void 0:e.find((e=>e.id===t.id))])),[e,a]),h=Object(n.useMemo)((()=>{const e=b.reduce(((e,t)=>{const{tags:a}=t;return a.forEach((t=>e.add(t))),e}),new Set);return Array.from(e).map((e=>({value:e,name:e,field:"tags"})))}),[b]),v=Object(n.useMemo)((()=>({box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",operator:"exact",name:s.i18n.translate("xpack.securitySolution.exceptions.addToRulesTable.tagsFilterLabel",{defaultMessage:"Tags"}),multiSelect:"or",options:h}]})),[h]),E=Object(n.useMemo)((()=>[{field:"link",name:c.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>r.a.createElement(d,{rule:t,linkedRules:g,onRuleLinkChange:f})},...Object(u.c)()]),[g]),x=Object(n.useCallback)((({page:{index:e}})=>y({...m,pageIndex:e})),[m]);return{isLoading:!i,pagination:m,searchOptions:v,sortedRulesByLinkedRulesOnTop:b,rulesTableColumnsWithLinkSwitch:E,addToSelectedRulesDescription:l,onTableChange:x}})({initiallySelectedRules:e,onRuleSelectionChange:t});return r.a.createElement(i.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"s"},h),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiInMemoryTable,{tableLayout:"auto",search:m,"data-test-subj":"addExceptionToRulesTable",tableCaption:"Rules table",items:g,loading:a,columns:f,message:a?r.a.createElement(i.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPromptsLoading"}):void 0,pagination:y,onTableChange:b})))},y=r.a.memo(m);y.displayName="ExceptionsAddToRulesTable"},871:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(2),r=a.n(n),i=a(41),o=a.n(i),s=a(19),l=a(532),c=a(252),u=a(403),d=a(1555),p=a(4);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.sectionTitle",{defaultMessage:"Alerts actions"}),y=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.singleAlertCloseLabel",{defaultMessage:"Close this alert"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),f=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by selected rule/s"}),b=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),h=o.a.section.withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-1ggwgok-0"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),v=o()(s.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1ggwgok-1"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),E=({isAlertDataLoading:e,exceptionListItems:t,exceptionListType:a,shouldCloseSingleAlert:i,shouldBulkCloseAlert:o,disableBulkClose:p,alertData:E,alertStatus:x,onDisableBulkClose:k,onUpdateBulkCloseIndex:w,onBulkCloseCheckboxChange:S,onSingleAlertCloseCheckboxChange:j})=>{const{loading:O,signalIndexName:I}=Object(l.a)(),C=Object(n.useMemo)((()=>null!==I?[I]:[]),[I]),[T,{indexPatterns:M}]=Object(c.b)(C),_=Object(n.useCallback)((e=>{S(e.currentTarget.checked)}),[S]),N=Object(n.useCallback)((e=>{null!=j&&j(e.currentTarget.checked)}),[j]);return Object(n.useEffect)((()=>{w(o&&null!=C?C:void 0)}),[C,w,o]),Object(n.useEffect)((()=>{!0===p&&S(!1)}),[p,S]),Object(n.useEffect)((()=>{!1===T&&!1===O&&k((e=>{for(const{entries:t}of e)for(const e of null!=t?t:[])if(Object(d.f)(e)===u.b.LIST)return!0;return!1})(t)||((e,t)=>{const a=e=>t.fields.some((({name:t})=>t===e.field));if(0===e.length)return!1;for(const{entries:t}of e)for(const e of null!=t?t:[])if("nested"===e.type){for(const t of e.entries)if(!1===a(t))return!0}else if(!1===a(e))return!0;return!1})(t,M)||t.every((e=>0===e.entries.length)))}),[k,t,T,O,M]),r.a.createElement(h,null,r.a.createElement(v,{size:"xs"},r.a.createElement("h3",null,m)),r.a.createElement(s.EuiSpacer,{size:"s"}),null!=E&&"closed"!==x&&r.a.createElement(s.EuiFormRow,{fullWidth:!0},r.a.createElement(s.EuiCheckbox,{"data-test-subj":"closeAlertOnAddExceptionCheckbox",id:"close-alert-on-add-add-exception-checkbox",label:y,checked:i,onChange:N,disabled:O||T||e})),r.a.createElement(s.EuiFormRow,{fullWidth:!0},r.a.createElement(s.EuiCheckbox,{"data-test-subj":"bulkCloseAlertOnAddExceptionCheckbox",id:"bulk-close-alert-on-add-add-exception-checkbox",label:p?g:f,checked:o,onChange:_,disabled:p||O||T||e})),"endpoint"===a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(s.EuiText,{"data-test-subj":"addExceptionEndpointText",color:"subdued",size:"s"},b)))},x=r.a.memo(E);x.displayName="ExceptionItemsFlyoutAlertsActions"},872:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a(585),i=a(204),o=a(53),s=a(118);var l=a(343),c=a(10),u=a(4);const d=u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.error",{defaultMessage:"Failed to close alerts"});var p=a(123),m=a(479);const y=()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(p.a)(),[y,g]=Object(n.useState)(!1),f=Object(n.useRef)(null);return Object(n.useEffect)((()=>{let n=!0;const p=new AbortController;return f.current=async(y,f,b,h)=>{try{var v,E,x,k,w,S,j,O;let t,d;if(g(!0),null!=b&&(t=await Object(m.a)({signalIds:[b],status:"closed",signal:p.signal})),null!=h){const e=Object(r.c)(["open","acknowledged","in-progress"]),t=await(async(e,t,a,n,r,l=!0)=>{const c={fields:[],title:n.join()},{filter:u}=await Object(i.r)({http:s.b.get().http,exceptions:r,excludeExceptions:l,chunkSize:10}),d={query:e,language:t},p=((e,t)=>null!=t?[...e,t]:[...e])(a,u);return Object(o.buildEsQuery)(c,d,p,{allowLeadingWildcards:!0,queryStringOptions:{analyze_wildcard:!0},ignoreFilterIfFieldNotInIndex:!1,dateFormatTZ:"Zulu"})})("","kuery",[...y.flatMap((e=>Object(r.d)(e))),...e],h,Object(l.m)(f),!1);d=await Object(m.a)({query:t,status:"closed",signal:p.signal})}const C=(null!==(v=null===(E=t)||void 0===E?void 0:E.updated)&&void 0!==v?v:0)+(null!==(x=null===(k=d)||void 0===k?void 0:k.updated)&&void 0!==x?x:0),T=null!==(w=null===(S=t)||void 0===S?void 0:S.version_conflicts)&&void 0!==w?w:0+(null!==(j=null===(O=d)||void 0===O?void 0:O.version_conflicts)&&void 0!==j?j:0);n&&(g(!1),e((I=C,u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.success",{values:{numAlerts:I},defaultMessage:"Successfully updated {numAlerts} {numAlerts, plural, =1 {alert} other {alerts}}"}))),T>0&&a({title:c.k(T),text:c.l(C,T)}))}catch(e){n&&(g(!1),t(e,{title:d}))}var I},()=>{n=!1,p.abort()}}),[e,t,a]),[y,f.current]}},873:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(19),r=a(2),i=a.n(r),o=a(566),s=a(720),l=a(52),c=a.n(l),u=a(576),d=a.n(u),p=a(4);p.i18n.translate("xpack.securitySolution.clipboard.copy",{defaultMessage:"Copy"});const m=p.i18n.translate("xpack.securitySolution.clipboard.copied",{defaultMessage:"Copied"}),y=p.i18n.translate("xpack.securitySolution.clipboard.to.the.clipboard",{defaultMessage:"to the clipboard"}),g=p.i18n.translate("xpack.securitySolution.clipboard.copy.to.the.clipboard",{defaultMessage:"Copy to the clipboard"});var f=a(123);const b=({children:e,content:t,isHoverAction:a,onCopy:r,titleSummary:o,toastLifeTimeMs:s})=>{const{addSuccess:l}=Object(f.a)(),u=c()("copy-to-clipboard",{securitySolution__hoverActionButton:a});return i.a.createElement(n.EuiButtonIcon,{"aria-label":g,className:u,"data-test-subj":"clipboard",iconType:"copyClipboard",onClick:e=>{e.preventDefault(),e.stopPropagation();const a=d()(`${t}`,{debug:!0});null!=r&&r({content:t,isSuccess:a}),a&&l(`${m} ${o} ${y}`,{toastLifeTimeMs:s})}},e)},h=i.a.memo((({isHoverAction:e,keyboardShortcut:t="",text:a,titleSummary:r})=>i.a.createElement(n.EuiToolTip,{content:i.a.createElement(o.b,{additionalScreenReaderOnlyContext:a,content:s.a,shortcut:t,showShortcut:""!==t})},i.a.createElement(b,{content:a,isHoverAction:e,titleSummary:r,toastLifeTimeMs:800}))));h.displayName="WithCopyToClipboard"},878:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),r=a.n(n),i=a(19),o=a(4);const s=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.nameLabel",{defaultMessage:"Exception name"}),l=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.namePlaceholder",{defaultMessage:"Name your exception"}),c=({exceptionItemName:e,onChange:t})=>{const a=Object(n.useCallback)((e=>{t(["name",e.target.value])}),[t]);return r.a.createElement(i.EuiFormRow,{label:s,"data-test-subj":"exceptionFlyoutName"},r.a.createElement(i.EuiFieldText,{placeholder:l,value:e,onChange:a,"data-test-subj":"exceptionFlyoutNameInput"}))},u=r.a.memo(c);u.displayName="ExceptionsFlyoutMeta"},879:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(2),r=a.n(n),i=a(19),o=a(87),s=a(1334),l=a(41),c=a.n(l),u=a(168),d=a(165),p=a(118),m=a(4);const y=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.conditionsTitle",{defaultMessage:"Conditions"}),g=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),f=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningAdd",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception created will apply to all events in the sequence."}),b=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningEdit",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."}),h=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.operatingSystemPlaceHolder",{defaultMessage:"Select an operating system"});var v=a(353),E=a(547);const x=[{label:v.h,value:["windows"]},{label:v.g,value:["macos"]},{label:v.f,value:["linux"]},{label:v.i,value:["windows","macos"]}],k=c()(i.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-x9h592-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),w=({exceptionItemName:e,allowLargeValueLists:t,exceptionListItems:a,indexPatterns:l,rules:c,exceptionListType:m,showOsTypeOptions:w,selectedOs:S,isEdit:j,onOsChange:O,onExceptionItemAdd:I,onSetErrorExists:C,getExtendedFields:T})=>{const{http:M,unifiedSearch:_}=Object(p.j)().services,N=Object(n.useMemo)((()=>m===s.a.ENDPOINT),[m]),D=Object(n.useMemo)((()=>null!=c&&c.some((e=>"eql"===e.type&&Object(d.a)(e.query)))),[c]),A=Object(n.useMemo)((()=>{if(N)return"endpoint_list";const e=N?u.k:void 0;return j?a[0].list_id:e}),[N,j,a]),F=Object(n.useMemo)((()=>{const e=N?"agnostic":void 0;return j?a[0].namespace_type:e}),[a,j,N]),q=Object(n.useCallback)((({exceptionItems:e,errorExists:t})=>{I(e),C(t)}),[C,I]),L=Object(n.useCallback)((e=>{const t=e[0].value;null!=O&&O(t||void 0)}),[O]),R=Object(n.useMemo)((()=>({asPlainText:!0})),[]),P=Object(n.useMemo)((()=>x.filter((e=>S===e.value))),[S]),z=Object(n.useMemo)((()=>w&&void 0===S),[w,S]),B=Object(n.useMemo)((()=>j?b:f),[j]),$=Object(n.useMemo)((()=>{var e;return null!==(e=j?a[0].os_types:S)&&void 0!==e?e:[]}),[a,j,S]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{size:"xs"},r.a.createElement("h3",null,y)),D&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiCallOut,{"data-test-subj":"eqlSequenceCallout",title:B}),r.a.createElement(i.EuiSpacer,null)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiText,{size:"s"},g),r.a.createElement(i.EuiSpacer,{size:"s"}),w&&!j&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiFormRow,{label:v.e},r.a.createElement(i.EuiComboBox,{placeholder:h,singleSelection:R,options:x,selectedOptions:P,onChange:L,isClearable:!1,"data-test-subj":"osSelectionDropdown"})),r.a.createElement(i.EuiSpacer,{size:"l"})),w&&j&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"xs","data-test-subj":"exceptionItemSelectedOs"},r.a.createElement("dl",null,r.a.createElement("dt",null,v.e),r.a.createElement("dd",null,(e=>e.reduce(((e,t)=>`${(e=>"linux"===e?v.f:"macos"===e?v.g:v.h)(t)}, ${e}`),"").slice(0,-2))($)))),r.a.createElement(i.EuiSpacer,null)),Object(o.getExceptionBuilderComponentLazy)({allowLargeValueLists:t,httpService:M,autocompleteService:_.autocomplete,exceptionListItems:a,listType:m,osTypes:$,listId:A,listNamespaceType:F,exceptionItemName:e,indexPatterns:l,isOrDisabled:z,isAndDisabled:z,isNestedDisabled:z,dataTestSubj:"alertExceptionBuilder",idAria:"alertExceptionBuilder",onChange:q,isDisabled:z,allowCustomFieldOptions:!N,getExtendedFields:T,showValueListModal:E.a}))},S=r.a.memo(w);S.displayName="ExceptionsConditions"},880:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(19),r=a(54),i=a.n(r),o=a(2),s=a.n(o),l=a(41),c=a.n(l),u=a(4);const d=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.expireTimeLabel",{defaultMessage:"Exception will expire at"}),p=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTime",{defaultMessage:"Exception Expiration"}),m=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTimeError",{defaultMessage:"Selected date and time must be in the future."}),y=c()(n.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1t4zrw1-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),g=({expireTime:e,setExpireTime:t,setExpireError:a})=>{const[r,l]=Object(o.useState)(e),[c,u]=Object(o.useState)(!1),[g,f]=Object(o.useState)([]),b=Object(o.useCallback)((e=>{l(null!=e?e:void 0),t(null!=e?e:void 0),null!=e&&e.isBefore()?(u(!0),f([m]),a(!0)):(u(!1),f([]),a(!1))}),[l,t,a]);return s.a.createElement("div",null,s.a.createElement(y,{size:"xs"},s.a.createElement("h3",null,p)),s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiFormRow,{error:g,isInvalid:c,label:d},s.a.createElement(n.EuiDatePicker,{showTimeSelect:!0,selected:r,isInvalid:c,onChange:b,onClear:()=>b(null),minDate:i()()})))},f=s.a.memo(g);f.displayName="ExceptionsExpireTime"},881:function(e,t,a){"use strict";a.d(t,"a",(function(){return R}));var n=a(41),r=a.n(n),i=a(2),o=a.n(i),s=a(7),l=a(19),c=a(4),u=a(42),d=(a(43),a(1555)),p=a(1470),m=a(1561),y=a(1870),g=a(87),f=a(122),b=a(361),h=a(245),v=a(259),E=a(167),x=a(126),k=a(252),w=a(340),S=a(16),j=a(118),O=a(451),I=a(1232),C=a(237),T=a(603),M=a(967),_=a(632),N=a(602),D=a(547),A=a(846);const F=[y.c.MAC,y.c.WINDOWS,y.c.LINUX].map((e=>({value:e,inputDisplay:C.c[e]}))),q=Object.freeze({policySelection:v.i,processDescendantsFiltering:v.h}),L=e=>e.entries.map((e=>(delete e.id,e))),R=Object(i.memo)((({allowSelectOs:e=!0,item:t,policies:a,policiesIsLoading:n,onChange:r,mode:R})=>{const z=Object(x.a)("eventFilters-form"),{http:B}=Object(j.j)().services,$=Object(i.useCallback)((({field:e,query:t})=>new N.a(B).getSuggestions({field:e.name,query:t})),[B]),G=(U=$,Object(i.useMemo)((()=>({getQuerySuggestions:()=>{},hasQuerySuggestions:e=>!1,getValueSuggestions:U})),[U]));var U;const[V,H]=Object(i.useState)(!1),[W,Y]=Object(i.useState)(!t.name),[Z,K]=Object(i.useState)(""),[Q,X]=Object(i.useState)(!1),[J,ee]=Object(i.useState)(!1),[te,ae]=Object(i.useState)([]),ne=Object(S.b)().isPlatinumPlus(),re=Object(i.useMemo)((()=>Object(O.f)(t)),[t]),[ie,oe]=Object(i.useState)(!Object(O.f)(t)),[se,le]=Object(i.useState)(!1),[ce,ue]=Object(i.useState)(Object(d.g)([t])),de=Object(i.useMemo)((()=>[E.D]),[]),[pe,{indexPatterns:me}]=Object(k.b)(de,void 0,E.l),{getTagsUpdatedBy:ye}=Object(b.e)(t,q),ge=Object(l.useEuiTheme)(),fe=Object(f.a)("filterProcessDescendantsForEventFiltersEnabled"),be=Object(i.useMemo)((()=>Object(v.g)(t)),[t]),[he,ve]=Object(i.useState)(!!t.entries.length||!1),Ee=Object(i.useMemo)((()=>null==t?void 0:t.comments),[]),xe=Object(i.useMemo)((()=>ne||"edit"===R&&(!re||ie&&re&&V)),[R,re,V,ne,ie]),ke=Object(i.useMemo)((()=>!W&&!Q&&!!t.entries.length&&t.entries.some((e=>""!==e.value||e.value.length))),[Q,W,t.entries]),we=Object(i.useCallback)((e=>{const a=e?{...t,...e}:t;L(a),r({item:a,isValid:ke&&he,confirmModalLabels:ce?Object(C.a)(c.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.confirmModal.name",{defaultMessage:"event filter"})):void 0})}),[he,t,ke,r,ce]);Object(i.useEffect)((()=>{!V&&t.tags&&oe(!Object(O.f)({tags:t.tags}))}),[t.tags,V]),Object(i.useEffect)((()=>{if(V)return;const e=t.tags?Object(O.d)({tags:t.tags}):[];if(!e.length)return;const n=a.filter((t=>e.includes(t.id)));ae(n)}),[V,t,a]);const Se=Object(i.useMemo)((()=>{const e=t;return e.entries=t.entries.length?t.entries:[{field:"",operator:"included",type:"match",value:""}],L(e),ve(!!t.entries.length),e}),[t]),je=Object(i.useCallback)((e=>{if(!t)return;const a=e.target.value.trim();Y(!a),we({name:a}),V||H(!0)}),[t,V,we]),Oe=Object(i.useMemo)((()=>{var e;return o.a.createElement(l.EuiFormRow,{label:I.e,fullWidth:!0,isInvalid:W&&J,error:I.d},o.a.createElement(l.EuiFieldText,{"aria-label":I.e,id:"eventFiltersFormInputName",defaultValue:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"","data-test-subj":z("name-input"),fullWidth:!0,maxLength:256,required:J,onChange:je,onBlur:()=>!J&&ee(!0)}))}),[z,W,je,J,null==t?void 0:t.name]),Ie=Object(i.useCallback)((e=>{t&&(V||H(!0),we({description:e.target.value.toString().trim()}))}),[t,V,we]),Ce=Object(i.useMemo)((()=>{var e;return o.a.createElement(l.EuiFormRow,{label:I.b,fullWidth:!0},o.a.createElement(l.EuiTextArea,{id:"eventFiltersFormInputDescription",defaultValue:null!==(e=null==t?void 0:t.description)&&void 0!==e?e:"",onChange:Ie,fullWidth:!0,"data-test-subj":z("description-input"),"aria-label":I.b,maxLength:256}))}),[null==t?void 0:t.description,z,Ie]),Te=Object(i.useMemo)((()=>{var e;return null!=t&&null!==(e=t.os_types)&&void 0!==e&&e.length?t.os_types[0]:y.c.WINDOWS}),[null==t?void 0:t.os_types]),Me=Object(i.useCallback)((e=>{t&&(we({os_types:[e],entries:t.entries}),V||H(!0))}),[t,V,we]),_e=Object(i.useMemo)((()=>o.a.createElement(l.EuiFormRow,{label:I.f,fullWidth:!0},o.a.createElement(l.EuiSuperSelect,{name:"os",options:F,fullWidth:!0,valueOfSelected:Te,onChange:Me}))),[Me,Te]),Ne=Object(i.useCallback)((e=>{t&&(K(e),we({comments:[{comment:e}]}),V||H(!0))}),[t,V,we]),De=Object(i.useMemo)((()=>o.a.createElement(_.a,{exceptionItemComments:Ee,newCommentValue:Z,newCommentOnChange:Ne,setCommentError:X})),[Ee,Ne,Z]),Ae=Object(i.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionTitle",defaultMessage:"Comments"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionDescription",defaultMessage:"Add a comment to your event filter."}))),o.a.createElement(l.EuiSpacer,{size:"m"}),De)),[De]),Fe=Object(i.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.detailsSectionTitle",defaultMessage:"Details"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,I.a)),o.a.createElement(l.EuiSpacer,{size:"m"}),Oe,Ce)),[Oe,Ce]),qe=Object(i.useCallback)((e=>{const t="descendants"===e?[h.d]:[],a=ye("processDescendantsFiltering",t);we({tags:a}),V||H(!0)}),[ye,V,we]),Le=Object(i.useMemo)((()=>[{id:"events",label:o.a.createElement(l.EuiText,{size:"s"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.eventsButton",defaultMessage:"Events"})),iconType:be?"empty":"checkInCircleFilled","data-test-subj":z("filterEventsButton")},{id:"descendants",label:o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},o.a.createElement(l.EuiText,{size:"s"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.processDescendantsButton",defaultMessage:"Process Descendants"})),o.a.createElement(A.a,{"data-test-subj":z("filterProcessDescendantsTooltip")})),iconType:be?"checkInCircleFilled":"empty","data-test-subj":z("filterProcessDescendantsButton")}]),[z,be]),Re=Object(i.useMemo)((()=>fe?o.a.createElement(o.a.Fragment,null,o.a.createElement(P,{legend:"Events or Process descendants selector",color:"primary",onChange:qe,options:Le,idSelected:be?"descendants":"events",$_css:ge.euiTheme.size.l}),o.a.createElement(l.EuiSpacer,{size:"m"}),be&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"s","data-test-subj":z("filterProcessDescendants-additionalConditionDescription")},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.additionalConditionDescription",defaultMessage:"Additional condition added:"})),o.a.createElement("code",null,h.g),o.a.createElement(l.EuiSpacer,{size:"m"}))):null),[fe,qe,ge.euiTheme.size.l,Le,be,z]),Pe=Object(i.useCallback)((e=>{var a,n,r,i,o,l,c,u,p;if(!V&&void 0===e.exceptionItems[0]||Object(s.isEqual)(null===(a=e.exceptionItems[0])||void 0===a?void 0:a.entries,null==t?void 0:t.entries)){var m;const t=(null===(m=e.exceptionItems[0])||void 0===m?void 0:m.entries.map((e=>e.field)))||[""];return fe&&be&&t.push(h.f.field),le((p=t.reduce(((e,t)=>(t in e?e[t]++:e[t]=1,e)),{}),Object.values(p).some((e=>e>1)))),void(V||H(!0))}le(!1),ue(Object(d.g)(e.exceptionItems));const g=void 0!==e.exceptionItems[0]?{...e.exceptionItems[0],name:null!==(n=null==t?void 0:t.name)&&void 0!==n?n:"",description:null!==(r=null==t?void 0:t.description)&&void 0!==r?r:"",comments:null!==(i=null==t?void 0:t.comments)&&void 0!==i?i:[],os_types:null!==(o=null==t?void 0:t.os_types)&&void 0!==o?o:[y.c.WINDOWS],tags:null!==(l=null==t?void 0:t.tags)&&void 0!==l?l:[],meta:t.meta}:t,f=void 0!==e.exceptionItems[0]&&!(e.errorExists&&(null===(c=e.exceptionItems[0])||void 0===c||null===(u=c.entries)||void 0===u||!u.length));ve(f),we(g),V||H(!0)}),[t,V,fe,be,we]),ze=Object(i.useMemo)((()=>Object(g.getExceptionBuilderComponentLazy)({allowLargeValueLists:!1,httpService:B,autocompleteService:G,exceptionListItems:[Se],listType:T.c,listId:T.a,listNamespaceType:"agnostic",ruleName:I.g,indexPatterns:me,isOrDisabled:!0,isOrHidden:!0,isAndDisabled:!1,isNestedDisabled:!1,dataTestSubj:"alert-exception-builder",idAria:"alert-exception-builder",onChange:Pe,operatorsList:p.c,osTypes:t.os_types,showValueListModal:D.a})),[G,Pe,B,me,t,Se]),Be=Object(i.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionTitle",defaultMessage:"Conditions"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,e?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withOs",defaultMessage:"Select an operating system and add conditions."}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withoutOs",defaultMessage:"Add conditions."}))),o.a.createElement(l.EuiSpacer,{size:"m"}),e?o.a.createElement(o.a.Fragment,null,_e,o.a.createElement(l.EuiSpacer,null)):null,Re,ze)),[e,ze,_e,Re]),$e=Object(i.useCallback)((e=>{const t=Object(O.b)(e);e.isGlobal||ae(e.selected);const a=ye("policySelection",t);we({tags:a}),V||H(!0)}),[we,ye,V]),Ge=Object(i.useMemo)((()=>o.a.createElement(M.a,{selected:te,options:a,isGlobal:re,isLoading:n,isPlatinumPlus:ne,onChange:$e,"data-test-subj":z("effectedPolicies")})),[te,a,re,n,ne,$e,z]);return Object(i.useEffect)((()=>{we()}),[we]),pe||!t?o.a.createElement(w.a,{size:"xl"}):o.a.createElement(l.EuiForm,{component:"div"},Fe,o.a.createElement(l.EuiHorizontalRule,null),Be,ce&&o.a.createElement(m.a,null),se&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{color:"subdued",size:"xs","data-test-subj":"duplicate-fields-warning-message"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.warningMessage.duplicateFields",defaultMessage:"Using multiples of the same field values can degrade Endpoint performance and/or create ineffective rules"}))),xe&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiHorizontalRule,null),Ge),o.a.createElement(l.EuiHorizontalRule,null),Ae)}));R.displayName="EventFiltersForm";var P=r()(l.EuiButtonGroup).withConfig({displayName:"_StyledEuiButtonGroup",componentId:"sc-1xvgrer-0"})([".euiButtonGroupButton{padding-right:",";}"],(e=>e.$_css))},884:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(799);const r=["endpoint_list"],i=e=>!!r.find((t=>t===e.list_id)),o=e=>n.a.is(e)},922:function(e,t,a){"use strict";a.d(t,"b",(function(){return j})),a.d(t,"a",(function(){return O}));var n=a(1737),r=a(44),i=a(19),o=a(2),s=a.n(o),l=a(41),c=a.n(l),u=a(748),d=a(1630),p=a(145),m=a(198),y=a(1101),g=a(533),f=a(695),b=a(1227),h=a(197),v=a(151),E=a(1210),x=a(775);const k=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-4qbs0b-0"})(["flex:0 1 auto;",""],(({theme:e})=>`margin-top: ${e.eui.euiSizeS};`)),w=c()(i.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-4qbs0b-1"})(["height:100%;"]),S=c()(i.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-4qbs0b-2"})(["&.euiFlexItem{flex:1 0 0;overflow:hidden;}"]),j=s.a.memo((({eventId:e,eventIndex:t,isAlert:a,loading:l,handleOnEventClosed:c,promptContextId:f,ruleName:w,timestamp:S,scopeId:j,refetchFlyoutData:O,getFieldsData:I})=>{const{hasAssistantPrivilege:C}=Object(g.a)(),T=Object(E.a)({_id:e,_index:t,timestamp:S}),{refetch:M}=Object(x.a)({scopeId:j}),_=Object(o.useMemo)((()=>{var e;return null!==(e=I(u.F))&&void 0!==e?e:[]}),[I]),N=Object(o.useCallback)((()=>{M(),O()}),[M,O]);return s.a.createElement(k,{gutterSize:"none",justifyContent:"spaceBetween",wrap:!0},s.a.createElement(i.EuiFlexItem,{grow:!1},!l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiTitle,{size:"s"},s.a.createElement("h4",null,a&&!Object(r.isEmpty)(w)?w:b.c)),S&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(v.c,{value:new Date(S)})))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiFlexGroup,{direction:"column",alignItems:"flexEnd",gutterSize:"none"},c&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButtonIcon,{iconType:"cross","aria-label":b.b,onClick:c})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},C&&null!=f&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(n.a,{conversationTitle:a?h.e:h.i,promptContextId:f})),a&&T&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiCopy,{textToCopy:(D=T,`${D}&${m.a.flyout}=(preview:!(),right:(id:${p.e},params:(id:'${e}',indexName:${t},scopeId:${j})))`)},(e=>s.a.createElement(i.EuiButtonEmpty,{onClick:e,iconType:"share","data-test-subj":"copy-alert-flyout-link"},b.e)))))),a&&j!==d.b.rulePreview&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(y.a,{eventId:e,assignedUserIds:_,onAssigneesUpdated:N})))));var D}));j.displayName="ExpandableEventTitle";const O=s.a.memo((({browserFields:e,event:t,scopeId:a,timelineTabType:n,isAlert:r,isDraggable:o,loading:l,detailsData:c,detailsEcsData:u,rawEventData:d,handleOnEventClosed:p,isReadOnly:m})=>t.eventId?l?s.a.createElement(i.EuiSkeletonText,{lines:10}):s.a.createElement(w,{direction:"column",gutterSize:"none"},s.a.createElement(S,{grow:!0},s.a.createElement(f.a,{browserFields:e,data:null!=c?c:[],detailsEcsData:u,id:t.eventId,isAlert:r,isDraggable:o,rawEventData:d,scopeId:a,timelineTabType:n,handleOnEventClosed:p,isReadOnly:m}))):s.a.createElement(i.EuiTextColor,{color:"subdued"},b.d)));O.displayName="ExpandableEvent"},923:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),r=a.n(n),i=a(19),o=a(824),s=a(825),l=a(826),c=a(1248);const u=Object(n.memo)((({searchInputId:e,assignedUserIds:t,onApply:a})=>{const[u,d]=Object(n.useState)(t),p=Object(n.useMemo)((()=>{const e=Object(s.b)(u);return{add:e.filter((e=>!t.includes(e))),remove:t.filter((t=>!e.includes(t)))}}),[t,u]),m=Object(n.useMemo)((()=>p.add.length||p.remove.length),[p]),y=Object(n.useCallback)((e=>{d(e)}),[]),g=Object(n.useCallback)((async()=>{a(p)}),[p,a]);return r.a.createElement("div",{"data-test-subj":l.b},r.a.createElement(c.a,{searchInputId:e,assignedUserIds:t,onSelectionChange:y}),r.a.createElement(i.EuiButton,{"data-test-subj":l.a,fullWidth:!0,size:"s",onClick:g,isDisabled:!m},o.a))}));u.displayName="AssigneesPanel"},928:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(1334),i=a(540),o=a(270),s=a(172);const l=({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const{exceptionActionItems:a}=(({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const[{canUserCRUD:a,hasIndexWrite:i}]=Object(o.b)(),l=Object(n.useCallback)((()=>{t()}),[t]),c=Object(n.useCallback)((()=>{t(r.a.ENDPOINT)}),[t]),u=!a||!i||!e,d=!a||!i;return{exceptionActionItems:Object(n.useMemo)((()=>d?[]:[{key:"add-endpoint-exception-menu-item","data-test-subj":"add-endpoint-exception-menu-item",disabled:u,onClick:c,name:s.d},{key:"add-exception-menu-item","data-test-subj":"add-exception-menu-item",disabled:d,onClick:l,name:s.g}]),[u,d,l,c])}})({isEndpointAlert:e,onAddExceptionTypeClick:t});return Object(i.a)("crudEndpointExceptions")?{exceptionActionItems:a}:{exceptionActionItems:a.map((e=>({...e,disabled:e.name===s.d})))}}},929:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),r=a(172);const i=({onAddEventFilterClick:e,disabled:t=!1,tooltipMessage:a})=>({eventFilterActionItems:Object(n.useMemo)((()=>[{key:"add-event-filter-menu-item","data-test-subj":"add-event-filter-menu-item",onClick:e,disabled:t,toolTipContent:a,name:r.e}]),[e,t,a])})},930:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(716);const r=({handleClick:e})=>({key:"osquery-action-item","data-test-subj":"osquery-action-item",onClick:e,size:"s",name:n.a})},931:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(748),i=a(1245),o=a(293);const s=({closePopover:e,ecsRowData:t,refetch:a})=>{var s;const{hasIndexWrite:l}=Object(o.a)(),c=t._id,u=Object(n.useMemo)((()=>{var e,a,n,i;return[{_id:c,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:r.H,value:null!==(a=null==t||null===(n=t.kibana)||void 0===n?void 0:n.alert.workflow_tags)&&void 0!==a?a:[]}],ecs:{_id:c,_index:null!==(i=t._index)&&void 0!==i?i:""}}]}),[c,t._index,null==t||null===(s=t.kibana)||void 0===s?void 0:s.alert.workflow_tags]),{alertTagsItems:d,alertTagsPanels:p}=Object(i.a)({refetch:a}),m=Object(n.useMemo)((()=>d.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key})))),[d]);return{alertTagsItems:l?m:[],alertTagsPanels:Object(n.useMemo)((()=>p.map((t=>{const a=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:u});return{title:t.title,content:a,id:t.id}}))),[u,p,e])}}},932:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(7),r=a(2),i=a(748),o=a(405),s=a(1252),l=a(293);const c=({closePopover:e,ecsRowData:t,refetch:a})=>{var c;const{hasIndexWrite:u}=Object(l.a)(),d=t._id,p=Object(r.useMemo)((()=>{var e,a,n,r;return[{_id:d,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:i.F,value:null!==(a=null==t||null===(n=t.kibana)||void 0===n?void 0:n.alert.workflow_assignee_ids)&&void 0!==a?a:[]}],ecs:{_id:d,_index:null!==(r=t._index)&&void 0!==r?r:""}}]}),[d,t._index,null==t||null===(c=t.kibana)||void 0===c?void 0:c.alert.workflow_assignee_ids]),m=Object(r.useCallback)((()=>{e(),a&&a()}),[e,a]),{alertAssigneesItems:y,alertAssigneesPanels:g}=Object(s.a)({onAssigneesUpdate:m}),f=Object(r.useMemo)((()=>y.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key,onClick:()=>{var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,p,!1,n.noop,n.noop,n.noop)}})))),[p,y]);return{alertAssigneesItems:u?f:[],alertAssigneesPanels:Object(r.useMemo)((()=>g.map((t=>{const a=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:p,refresh:m});return{title:t.title,content:a,id:t.id,width:o.a}}))),[p,g,e,m])}}},933:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),r=a(256);const i=({refetch:e,onRuleChange:t,isActiveTimelines:a})=>{const{setAllTourStepsHidden:i}=Object(r.b)(),[o,s]=Object(n.useState)(!1),[l,c]=Object(n.useState)(null);return{exceptionFlyoutType:l,openAddExceptionFlyout:o,onAddExceptionTypeClick:Object(n.useCallback)((e=>{c(null!=e?e:null),i(!0),s(!0)}),[i]),onAddExceptionCancel:Object(n.useCallback)((()=>{c(null),i(!1),s(!1)}),[i]),onAddExceptionConfirm:Object(n.useCallback)(((n,r,o)=>{e&&(!1===a||o)&&e(),null!=t&&n&&t(),i(!1),s(!1)}),[e,a,t,i])}}},934:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return y}));var n=a(19),r=a(2),i=a.n(r),o=a(41),s=a.n(o),l=a(121),c=a(510);const u=s.a.span.withConfig({displayName:"NotificationDot",componentId:"sc-v4xtfs-0"})(["position:absolute;display:block;width:6px;height:6px;border-radius:50%;background-color:",";top:17%;left:52%;"],(({theme:e})=>e.eui.euiColorDanger)),d="notes-button",p=s()(n.EuiFlexGroup).withConfig({displayName:"NotesButtonContainer",componentId:"sc-v4xtfs-1"})(["position:relative;"]),m=i.a.memo((({ariaLabel:e=c.b,isDisabled:t,toggleShowNotes:a,timelineType:o,eventId:s,notesCount:m})=>{const y=o===l.m.template,g=Object(r.useCallback)((()=>{null!=s?null==a||a(s):null==a||a()}),[a,s]);return i.a.createElement(p,null,i.a.createElement(n.EuiFlexItem,{grow:!1},m>0?i.a.createElement(u,{className:"timeline-notes-notification-dot","data-test-subj":"timeline-notes-notification-dot"}):null,i.a.createElement(n.EuiButtonIcon,{"aria-label":e,className:d,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:g,size:"s",isDisabled:y})))}));m.displayName="SmallNotesButton";const y=i.a.memo((({ariaLabel:e,isDisabled:t,timelineType:a,toggleShowNotes:r,toolTip:o,eventId:s,notesCount:l})=>i.a.createElement(n.EuiToolTip,{content:o,"data-test-subj":"timeline-notes-tool-tip"},i.a.createElement(m,{ariaLabel:e,isDisabled:t,toggleShowNotes:r,timelineType:a,eventId:s,notesCount:null!=l?l:0}))));y.displayName="NotesButton"},935:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(67),r=a(544);const i=(e,t={})=>{var a;return e.get(r.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(a=t.query)&&void 0!==a&&a.kuery?`${t.query.kuery} and `:""}${n.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`},version:n.API_VERSIONS.public.v1})}},936:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2);const r=()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useCallback)((()=>{t(!0)}),[]);return{closeAddEventFilterModal:Object(n.useCallback)((()=>{t(!1)}),[]),isAddEventFilterModalOpen:e,onAddEventFilterClick:a}}},937:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return y})),a.d(t,"d",(function(){return g})),a.d(t,"g",(function(){return f})),a.d(t,"f",(function(){return b}));var n=a(19),r=a(44),i=a(2),o=a.n(i),s=a(134),l=a(130),c=a(144),u=a(378);const d="ip-overview",p=(e,t,a,c)=>e.length>0&&e.every((e=>Object(r.getOr)(null,e,t)))?o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},e.map(((e,l)=>{const u=Object(r.getOr)("",e,t);return o.a.createElement(i.Fragment,{key:`${d}-${e}`},l?", ":"",o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`location-renderer-default-draggable-${d}-${a?`${a}-`:""}${e}`,isDraggable:null!=c&&c,field:e,value:u,isAggregatable:!0,fieldType:"keyword"})))}))):Object(l.d)(),m=(e,t,a,r)=>e&&e.organization&&e.organization.name&&e.number?o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`autonomous-system-renderer-default-draggable-${d}-${a?`${a}-`:""}${t}.as.organization.name`,isDraggable:null!=r&&r,field:`${t}.as.organization.name`,value:e.organization.name})),o.a.createElement(n.EuiFlexItem,{grow:!1},"/"),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`autonomous-system-renderer-default-draggable-${d}-${a?`${a}-`:""}${t}.as.number`,isDraggable:!1,field:`${t}.as.number`,value:`${e.number}`,isAggregatable:!0,fieldType:"number"}))):Object(l.d)(),y=({contextID:e,host:t,isDraggable:a=!1,ipFilter:n,noLink:r})=>t.id&&t.ip&&(null==n||t.ip.includes(n))?o.a.createElement(o.a.Fragment,null,t.name&&null!=t.name[0]?o.a.createElement(s.b,{id:`host-id-renderer-default-draggable-${d}-${e?`${e}-`:""}host-id`,isDraggable:a,field:"host.id",value:t.id[0],isAggregatable:!0,fieldType:"keyword"},r?o.a.createElement(o.a.Fragment,null,t.id):o.a.createElement(c.d,{hostName:t.name[0]},t.id)):o.a.createElement(o.a.Fragment,null,t.id)):Object(l.d)(),g=(e,t,a,n)=>e&&e.name&&e.name[0]&&e.ip&&(null==t||e.ip.includes(t))?o.a.createElement(s.b,{id:`host-name-renderer-default-draggable-${d}-${a?`${a}-`:""}host-name`,isDraggable:null!=n&&n,field:"host.name",value:e.name[0],isAggregatable:!0,fieldType:"keyword"},o.a.createElement(c.d,{hostName:e.name[0]},e.name?e.name:Object(l.d)())):Object(l.d)(),f=e=>o.a.createElement(c.n,{domain:e},u.n),b=e=>o.a.createElement(c.j,{domain:e,direction:"column"})},949:function(e,t,a){"use strict";a.d(t,"a",(function(){return kt}));var n=a(19),r=a(2),i=a.n(r),o=a(45),s=a(41),l=a.n(s),c=a(121),u=a(124),d=a(13),p=a(129),m=a(158),y=a(44);const g={process:{hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTY5MjAtMTMyNDg5OTk2OTAuNDgzMzA3NzAw"],executable:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],name:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],pid:[6920],args:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1518)"],name:["Windows"],version:["1809 (10.0.17763.1518)"],platform:["windows"],family:["windows"],kernel:["1809 (10.0.17763.1518)"]},mac:["aa:bb:cc:dd:ee:ff"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"],name:["win2019-endpoint-1"]},file:{mtime:["2020-11-04T21:40:51.494Z"],path:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],owner:["sean"],hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},name:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],extension:["exe"],size:[1604112]},event:{category:["malware","intrusion_detection","process"],outcome:["success"],severity:[73],code:["malicious_file"],action:["execution"],id:["LsuMZVr+sdhvehVM++++Gp2Y"],kind:["alert"],created:["2020-11-04T21:41:30.533Z"],module:["endpoint"],type:["info","start","denied"],dataset:["endpoint.alerts"]},agent:{type:["endpoint"]},timestamp:"2020-11-04T21:41:30.533Z",message:["Malware Prevention Alert"],_id:"0dA2lXUBn9bLIbfPkY7d"};var f=a(231),b=a(230),h=a(171);const v=()=>{const e=Object(f.c)({eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:b.S});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:g,isDraggable:!1,scopeId:h.a}))},E=i.a.memo(v),x=[{_id:"1",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"event.kind",value:["signal"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3],kind:["signal"]},source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"3",data:[{field:"@timestamp",value:["2018-11-07T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["nginx"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["evan.davis"]}],ecs:{_id:"3",timestamp:"2018-11-07T19:03:25.937Z",host:{name:["nginx"],ip:["192.168.0.1"]},event:{id:["3"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[1]},source:{ip:["192.168.0.3"],port:[443]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["3"],name:["evan.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"4",data:[{field:"@timestamp",value:["2018-11-08T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Attempted Administrator Privilege Gain"]},{field:"host.name",value:["suricata"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jenny.jones"]}],ecs:{_id:"4",timestamp:"2018-11-08T19:03:25.937Z",host:{name:["suricata"],ip:["192.168.0.1"]},event:{id:["4"],category:["Attempted Administrator Privilege Gain"],type:["Alert"],module:["suricata"],severity:[1]},source:{ip:["192.168.0.3"],port:[53]},destination:{ip:["192.168.0.3"],port:[6343]},suricata:{eve:{flow_id:[4],proto:[""],alert:{signature:["ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174)"],signature_id:[4]}}},user:{id:["4"],name:["jenny.jones"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"5",data:[{field:"@timestamp",value:["2018-11-09T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["becky.davis"]}],ecs:{_id:"5",timestamp:"2018-11-09T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["5"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.3"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["5"],name:["becky.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"6",data:[{field:"@timestamp",value:["2018-11-10T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["braden.davis"]},{field:"source.ip",value:["192.168.0.6"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"6",timestamp:"2018-11-10T19:03:25.937Z",host:{name:["braden.davis"],ip:["192.168.0.1"]},event:{id:["6"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.6"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"8",data:[{field:"@timestamp",value:["2018-11-12T19:03:25.937Z"]},{field:"event.severity",value:["2"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"8",timestamp:"2018-11-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["8"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[2]},suricata:{eve:{flow_id:[8],proto:[""],alert:{signature:["ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie"],signature_id:[8]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["8"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"7",data:[{field:"@timestamp",value:["2018-11-11T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.7"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"7",timestamp:"2018-11-11T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["7"],category:["Access"],type:["HTTP Request"],module:["apache"],severity:[3]},source:{ip:["192.168.0.7"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["7"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"9",data:[{field:"@timestamp",value:["2018-11-13T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.9"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"9",timestamp:"2018-11-13T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["9"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.9"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["9"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"10",data:[{field:"@timestamp",value:["2018-11-14T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.10"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"10",timestamp:"2018-11-14T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["10"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.10"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["10"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"11",data:[{field:"@timestamp",value:["2018-11-15T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.11"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"11",timestamp:"2018-11-15T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["11"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.11"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["11"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"12",data:[{field:"@timestamp",value:["2018-11-16T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.12"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"12",timestamp:"2018-11-16T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["12"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.12"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["12"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"2",data:[{field:"@timestamp",value:["2018-11-06T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Authentication"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.2"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["joe.bob"]}],ecs:{_id:"2",timestamp:"2018-11-06T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["2"],category:["Authentication"],type:["Authentication Success"],module:["authlog"],severity:[3]},source:{ip:["192.168.0.2"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["joe.bob"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"13",data:[{field:"@timestamp",value:["2018-13-12T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"13",timestamp:"2018-12-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["13"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[1]},suricata:{eve:{flow_id:[13],proto:[""],alert:{signature:["ET WEB_SERVER Possible Attempt in HTTP Cookie"],signature_id:[13]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"14",data:[{field:"@timestamp",value:["2019-03-07T05:06:51.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.26.101"]},{field:"destination.ip",value:["192.168.238.205"]}],ecs:{_id:"14",timestamp:"2019-03-07T05:06:51.000Z",event:{module:["zeek"],dataset:["zeek.connection"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["185.176.26.101"],port:[44059]},destination:{ip:["207.154.238.205"],port:[11568]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["tcp"]},zeek:{session_id:["C8DRTq362Fios6hw16"],connection:{local_resp:[!1],local_orig:[!1],missed_bytes:[0],state:["REJ"],history:["Sr"]}}}},{_id:"15",data:[{field:"@timestamp",value:["2019-03-07T00:51:28.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.67.3"]}],ecs:{_id:"15",timestamp:"2019-03-07T00:51:28.000Z",event:{module:["zeek"],dataset:["zeek.dns"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[57475]},destination:{ip:["67.207.67.3"],port:[53]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["udp"]},zeek:{session_id:["CyIrMA1L1JtLqdIuol"],dns:{AA:[!1],RD:[!1],trans_id:[65252],RA:[!1],TC:[!1]}}}},{_id:"16",data:[{field:"@timestamp",value:["2019-03-05T07:00:20.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.164.26"]}],ecs:{_id:"16",timestamp:"2019-03-05T07:00:20.000Z",event:{module:["zeek"],dataset:["zeek.http"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[36220]},destination:{ip:["192.241.164.26"],port:[80]},geo:{region_name:["New York"],country_iso_code:["US"]},http:{version:["1.1"],request:{body:{bytes:[0]}},response:{status_code:[302],body:{bytes:[154]}}},zeek:{session_id:["CZLkpC22NquQJOpkwe"],http:{resp_mime_types:["text/html"],trans_depth:["3"],status_msg:["Moved Temporarily"],resp_fuids:["FzeujEPP7GTHmYPsc"],tags:[]}}}},{_id:"17",data:[{field:"@timestamp",value:["2019-02-28T22:36:28.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.77.171"]}],ecs:{_id:"17",timestamp:"2019-02-28T22:36:28.000Z",event:{module:["zeek"],dataset:["zeek.notice"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["8.42.77.171"]},zeek:{notice:{suppress_for:[3600],msg:["8.42.77.171 scanned at least 15 unique ports of host 207.154.238.205 in 0m0s"],note:["Scan::Port_Scan"],sub:["remote"],dst:["207.154.238.205"],dropped:[!1],peer_descr:["bro"]}}}},{_id:"18",data:[{field:"@timestamp",value:["2019-02-22T21:12:13.000Z"]},{field:"host.name",value:["zeek-sensor-amsterdam"]},{field:"source.ip",value:["192.168.66.184"]},{field:"destination.ip",value:["192.168.95.15"]}],ecs:{_id:"18",timestamp:"2019-02-22T21:12:13.000Z",event:{module:["zeek"],dataset:["zeek.ssl"]},host:{id:["2ce8b1e7d69e4a1d9c6bcddc473da9d9"],name:["zeek-sensor-amsterdam"]},source:{ip:["188.166.66.184"],port:[34514]},destination:{ip:["91.189.95.15"],port:[443]},geo:{region_name:["England"],country_iso_code:["GB"]},zeek:{session_id:["CmTxzt2OVXZLkGDaRe"],ssl:{cipher:["TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"],established:[!1],resumed:[!1],version:["TLSv12"]}}}},{_id:"19",data:[{field:"@timestamp",value:["2019-03-03T04:26:38.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]}],ecs:{_id:"19",timestamp:"2019-03-03T04:26:38.000Z",event:{module:["zeek"],dataset:["zeek.files"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},zeek:{session_id:["Cu0n232QMyvNtzb75j"],files:{session_ids:["Cu0n232QMyvNtzb75j"],timedout:[!1],local_orig:[!1],tx_host:["5.101.111.50"],source:["HTTP"],is_orig:[!1],overflow_bytes:[0],sha1:["fa5195a5dfacc9d1c68d43600f0e0262cad14dde"],duration:[0],depth:[0],analyzers:["MD5","SHA1"],mime_type:["text/plain"],rx_host:["206.189.35.240"],total_bytes:[88722],fuid:["FePz1uVEVCZ3I0FQi"],seen_bytes:[1198],missing_bytes:[0],md5:["f7653f1951693021daa9e6be61226e32"]}}}},{_id:"20",data:[{field:"@timestamp",value:["2019-03-13T05:42:11.815Z"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-sanfran"]},{field:"process.args",value:["gpgconf","--list-dirs","agent-socket"]}],ecs:{_id:"20",timestamp:"2019-03-13T05:42:11.815Z",event:{action:["executed"],module:["auditd"],category:["audit-rule"]},host:{id:["f896741c3b3b44bdb8e351a4ab6d2d7c"],name:["zeek-sanfran"],ip:["134.209.63.134","10.46.0.5","fe80::a0d9:16ff:fecf:e70b"]},user:{name:["alice"]},process:{pid:[5402],name:["gpgconf"],ppid:[5401],args:["gpgconf","--list-dirs","agent-socket"],executable:["/usr/bin/gpgconf"],title:["gpgconf --list-dirs agent-socket"],working_directory:["/"]}}},{_id:"21",data:[{field:"@timestamp",value:["2019-03-14T22:30:25.527Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"source.ip",value:["192.168.77.171"]},{field:"user.name",value:["root"]}],ecs:{_id:"21",timestamp:"2019-03-14T22:30:25.527Z",event:{action:["logged-in"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["14"],data:{terminal:["/dev/pts/0"],op:["login"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["/dev/pts/0"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["8.42.77.171"]},user:{name:["root"]},process:{pid:[17471],executable:["/usr/sbin/sshd"]}}},{_id:"22",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"22",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["disposed-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:setcred"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"23",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"23",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["ended-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:session_close"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"24",data:[{field:"@timestamp",value:["2019-03-18T23:17:01.645Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"24",timestamp:"2019-03-18T23:17:01.645Z",event:{action:["acquired-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["unset"],data:{acct:["root"],terminal:["cron"],op:["PAM:setcred"]},summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[9592],executable:["/usr/sbin/cron"]}}},{_id:"25",data:[{field:"@timestamp",value:["2019-03-19T01:17:01.336Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["siem-kibana"]},{field:"user.name",value:["root"]}],ecs:{_id:"25",timestamp:"2019-03-19T01:17:01.336Z",event:{action:["started-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["2908"],data:{acct:["root"],terminal:["cron"],op:["PAM:session_open"]},summary:{actor:{primary:["root"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["aa7ca589f1b8220002f2fc61c64cfbf1"],name:["siem-kibana"]},user:{name:["root"]},process:{pid:[725],executable:["/usr/sbin/cron"]}}},{_id:"26",data:[{field:"@timestamp",value:["2019-03-13T03:34:08.890Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["alice"]}],ecs:{_id:"26",timestamp:"2019-03-13T03:34:08.890Z",event:{action:["was-authorized"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["338"],data:{terminal:["/dev/pts/0"]},summary:{actor:{primary:["root"],secondary:["alice"]},object:{primary:["/dev/pts/0"],type:["user-session"]},how:["/sbin/pam_tally2"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["alice"]},process:{pid:[21170],executable:["/sbin/pam_tally2"]}}},{_id:"27",data:[{field:"@timestamp",value:["2019-03-22T19:13:11.026Z"]},{field:"event.action",value:["connected-to"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"destination.ip",value:["192.168.216.34"]},{field:"user.name",value:["alice"]}],ecs:{_id:"27",timestamp:"2019-03-22T19:13:11.026Z",event:{action:["connected-to"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["246"],summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["192.168.216.34"],secondary:["80"],type:["socket"]},how:["/usr/bin/wget"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},destination:{ip:["192.168.216.34"],port:[80]},user:{name:["alice"]},process:{pid:[1490],name:["wget"],ppid:[1476],executable:["/usr/bin/wget"],title:["wget www.example.com"]}}},{_id:"28",data:[{field:"@timestamp",value:["2019-03-26T22:12:18.609Z"]},{field:"event.action",value:["opened-file"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"28",timestamp:"2019-03-26T22:12:18.609Z",event:{action:["opened-file"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["242"],summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["/proc/15990/attr/current"],type:["file"]},how:["/lib/systemd/systemd-journald"]}},file:{path:["/proc/15990/attr/current"],device:["00:00"],inode:["27672309"],uid:["0"],owner:["root"],gid:["0"],group:["root"],mode:["0666"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[27244],name:["systemd-journal"],ppid:[1],executable:["/lib/systemd/systemd-journald"],title:["/lib/systemd/systemd-journald"],working_directory:["/"]}}},{_id:"29",data:[{field:"@timestamp",value:["2019-04-08T21:18:57.000Z"]},{field:"event.action",value:["user_login"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Braden"]}],ecs:{_id:"29",event:{action:["user_login"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Braden"]},process:{pid:[6278]}}},{_id:"30",data:[{field:"@timestamp",value:["2019-04-08T22:27:14.814Z"]},{field:"event.action",value:["process_started"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Evan"]}],ecs:{_id:"30",event:{action:["process_started"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Evan"]},process:{pid:[6278]}}},{_id:"31",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"message",value:["I am a log file message"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3]},message:["I am a log file message"],source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"32",data:[],ecs:{_id:"BuBP4W0BOpWiDweSoYSg",timestamp:"2019-10-18T23:59:15.091Z",threat:{enrichments:[{indicator:{provider:["indicator_provider"],reference:["https://example.com"]},matched:{atomic:["192.168.1.1"],field:["source.ip"],type:["ip"]},feed:{name:["feed_name"]}}]}}}];var k=a(626),w=a(316);const S=()=>{const e=Object(k.b)({actionName:"connected-to",text:w.T});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:x[26].ecs,isDraggable:!1,scopeId:h.a}))},j=i.a.memo(S),O=()=>{const e=Object(k.c)({actionName:"opened-file",text:`${w.Db} ${w.kc}`});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:x[27].ecs,isDraggable:!1,scopeId:h.a}))},I=i.a.memo(O),C={file:{path:["C:\\Windows\\System32\\bcrypt.dll"],hash:{md5:["00439016776de367bad087d739a03797"],sha1:["2c4ba5c1482987d50a182bad915f52cd6611ee63"],sha256:["e70f5d8f87aab14e3160227d38387889befbe37fa4f8f5adc59eff52804b35fd"]},name:["bcrypt.dll"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["library"],kind:["event"],created:["2021-02-05T21:27:23.921Z"],module:["endpoint"],action:["load"],type:["start"],id:["LzzWB9jjGmCwGMvk++++Da5H"],dataset:["endpoint.events.library"]},process:{name:["sshd.exe"],pid:[9644],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTk2NDQtMTMyNTcwMzQwNDEuNzgyMTczODAw"],executable:["C:\\Program Files\\OpenSSH-Win64\\sshd.exe"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint DLL load event"],timestamp:"2021-02-05T21:27:23.921Z",_id:"IAUYdHcBGrBB52F2zo8Q"},T=()=>{const e=Object(f.d)({actionName:"load",text:b.q});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:C,isDraggable:!1,scopeId:h.a}))},M=i.a.memo(T);var _=a(1368),N=a(837);const D=()=>i.a.createElement(i.a.Fragment,null,N.a.renderRow({data:{destination:{bytes:[40],geo:{city_name:["New York"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["New York"]},ip:["10.1.2.3"],packets:[1],port:[80]},event:{action:["network_flow"],category:["network_traffic"],duration:[_.a],end:["2018-11-12T19:03:25.936Z"],start:["2018-11-12T19:03:25.836Z"]},_id:"abcd",network:{bytes:[100],community_id:["we.live.in.a"],direction:["outgoing"],packets:[3],protocol:["http"],transport:["tcp"]},process:{name:["rat"]},source:{bytes:[60],geo:{city_name:["Atlanta"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["Georgia"]},ip:["192.168.1.2"],packets:[2],port:[9987]},timestamp:"2018-11-12T19:03:25.936Z",tls:{client_certificate:{fingerprint:{sha1:["tls.client_certificate.fingerprint.sha1-value"]}},fingerprints:{ja3:{hash:["tls.fingerprints.ja3.hash-value"]}},server_certificate:{fingerprint:{sha1:["tls.server_certificate.fingerprint.sha1-value"]}}},user:{name:["first.last"]}},isDraggable:!1,scopeId:h.a})),A=i.a.memo(D),F={host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["registry"],kind:["event"],created:["2021-02-04T13:44:31.559Z"],module:["endpoint"],action:["modification"],type:["change"],id:["LzzWB9jjGmCwGMvk++++CbOn"],dataset:["endpoint.events.registry"]},process:{name:["GoogleUpdate.exe"],pid:[7408],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTc0MDgtMTMyNTY5MTk4NDguODY4NTI0ODAw"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},registry:{hive:["HKLM"],key:["SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState"],path:["HKLM\\SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState\\StateValue"],value:["StateValue"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint registry event"],timestamp:"2021-02-04T13:44:31.559Z",_id:"4cxLbXcBGrBB52F2uOfF"},q=()=>{const e=Object(f.e)({actionName:"modification",text:b.u});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:F,isDraggable:!1,scopeId:h.a}))},L=i.a.memo(q);var R=a(863);const P=()=>i.a.createElement(i.a.Fragment,null,R.a.renderRow({data:x[2].ecs,isDraggable:!1,scopeId:h.a})),z=i.a.memo(P),B={_id:"2MjPcG0BOpWiDweSoutC",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["termination_event"],category:["process"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["bd4401441a21bf1abce6404f4231db4d"],sha1:["797255e72d5ed5c058d4785950eba7abaa057653"],sha256:["87976f3430cc99bc939e0694247c0759961a49832b87218f4313d6fc0bc3a776"]},pid:[442384],ppid:[8],name:["RuntimeBroker.exe"],executable:["C:\\Windows\\System32\\RuntimeBroker.exe"]},endgame:{pid:[442384],process_name:["RuntimeBroker.exe"],exit_code:[0]}},$=()=>{const e=Object(f.h)({actionName:"termination_event",text:b.H});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:B,isDraggable:!1,scopeId:h.a}))},G=i.a.memo($),U={_id:"S8jPcG0BOpWiDweSou3g",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["request_event"],category:["network"],kind:["event"]},message:["DNS query is completed for the name %1, type %2, query options %3 with status %4 Results %5 "],timestamp:"1569555712000",dns:{question:{name:["update.googleapis.com"],type:["A"]},resolved_ip:["10.100.197.67"]},network:{protocol:["dns"]},process:{pid:[443192],name:["GoogleUpdate.exe"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},winlog:{event_id:[3008]},endgame:{process_name:["GoogleUpdate.exe"],pid:[443192]}},V=()=>{const e=Object(f.a)();return i.a.createElement(i.a.Fragment,null,e.renderRow({data:U,isDraggable:!1,scopeId:h.a}))},H=i.a.memo(V),W={_id:"BcjPcG0BOpWiDweSou3g",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["creation_event"],category:["process"],type:["process_start"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["62d06d7235b37895b68de56687895743"],sha1:["12563599116157778a22600d2a163d8112aed845"],sha256:["d4c97ed46046893141652e2ec0056a698f6445109949d7fcabbce331146889ee"]},pid:[441684],ppid:[8],name:["Microsoft.Photos.exe"],executable:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe"],args:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe","-ServerName:App.AppXzst44mncqdg84v7sv6p7yznqwssy6f7f.mca"]},endgame:{process_name:["Microsoft.Photos.exe"],pid:[441684],parent_process_name:["svchost.exe"]}},Y=()=>{const e=Object(f.b)({actionName:"creation_event",text:b.A});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:W,isDraggable:!1,scopeId:h.a}))},Z=i.a.memo(Y),K={_id:"98jPcG0BOpWiDweSouzg",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["file_create_event"],category:["file"],kind:["event"]},timestamp:"1569555712000",endgame:{process_name:["chrome.exe"],pid:[11620],file_path:["C:\\Users\\Arun\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\63d78c21-e593-4484-b7a9-db33cd522ddc.tmp"]}},Q={_id:"OMjPcG0BOpWiDweSeuW9",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["file_delete_event"],category:["file"],kind:["event"]},timestamp:"1569555704000",endgame:{pid:[1084],file_name:["tmp000002f6"],file_path:["C:\\Windows\\TEMP\\tmp00000404\\tmp000002f6"],process_name:["AmSvc.exe"]}},X=()=>{const e=Object(f.g)({actionName:"file_delete_event",text:b.f});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:Q,isDraggable:!1,scopeId:h.a}))},J=i.a.memo(X),ee=()=>{const e=Object(f.f)({actionName:"file_create_event",text:b.e});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:K,isDraggable:!1,scopeId:h.a}))},te=i.a.memo(ee),ae={_id:"QsjPcG0BOpWiDweSeuRE",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["user_logon"],category:["authentication"],type:["authentication_success"],kind:["event"]},message:["An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tWIN-Q3DOP1UKA81$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3e7\r\n\r\nLogon Type:\t\t\t5\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3e7\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x1b0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."],timestamp:"1569555704000",process:{pid:[432],name:["C:\\Windows\\System32\\services.exe"],executable:["C:\\Windows\\System32\\services.exe"]},winlog:{event_id:[4624]},endgame:{target_logon_id:["0x3e7"],pid:[432],process_name:["C:\\Windows\\System32\\services.exe"],logon_type:[5],subject_user_name:["WIN-Q3DOP1UKA81$"],subject_logon_id:["0x3e7"],target_user_name:["SYSTEM"],target_domain_name:["NT AUTHORITY"]}},ne=()=>{const e=Object(f.i)({actionName:"user_logon"});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:ae,isDraggable:!1,scopeId:h.a}))},re=i.a.memo(ne),ie={_id:"LsjPcG0BOpWiDweSCNfu",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.43.255.177"],name:["HD-gqf-0af7b4fe"]},event:{module:["endgame"],dataset:["esensor"],action:["ipv4_connection_accept_event"],category:["network"],kind:["event"]},timestamp:"1569555676000",network:{community_id:["1:network-community_id"],transport:["tcp"]},process:{pid:[1084],name:["AmSvc.exe"],executable:["C:\\Program Files\\Cybereason ActiveProbe\\AmSvc.exe"]},source:{ip:["127.0.0.1"],port:[49306]},destination:{port:[49305],ip:["127.0.0.1"]},endgame:{pid:[1084]}},oe=()=>{const e=Object(f.j)({actionName:"ipv4_connection_accept_event",text:b.b});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:ie,isDraggable:!1,scopeId:h.a}))},se=i.a.memo(oe);var le=a(861);const ce=()=>i.a.createElement(i.a.Fragment,null,le.a.renderRow({data:x[31].ecs,isDraggable:!1,scopeId:h.a})),ue=i.a.memo(ce);var de=a(865);const pe=()=>i.a.createElement(i.a.Fragment,null,de.a.renderRow({data:x[13].ecs,isDraggable:!1,scopeId:h.a})),me=i.a.memo(pe);var ye=a(4);const ge=ye.i18n.translate("xpack.securitySolution.eventRenderers.alertName",{defaultMessage:"Alert"}),fe=ye.i18n.translate("xpack.securitySolution.eventRenderers.alertsName",{defaultMessage:"Alerts"}),be=ye.i18n.translate("xpack.securitySolution.eventRenderers.alertsDescription",{defaultMessage:"Alerts are displayed when malware or ransomware is prevented and detected"}),he=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdName",{defaultMessage:"Auditd"}),ve=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdDescriptionPart1",{defaultMessage:"audit events convey security-relevant logs from the Linux Audit Framework."}),Ee=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileName",{defaultMessage:"Auditd File"}),xe=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),ke=ye.i18n.translate("xpack.securitySolution.eventRenderers.authenticationName",{defaultMessage:"Authentication"}),we=ye.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart1",{defaultMessage:"Authentication events show users (and system accounts) successfully or unsuccessfully logging into hosts."}),Se=ye.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart2",{defaultMessage:"Some authentication events may include additional details when users authenticate on behalf of other users."}),je=ye.i18n.translate("xpack.securitySolution.eventRenderers.dnsName",{defaultMessage:"Domain Name System (DNS)"}),Oe=ye.i18n.translate("xpack.securitySolution.eventRenderers.dnsDescriptionPart1",{defaultMessage:"Domain Name System (DNS) events show users (and system accounts) making requests via specific processes to translate from host names to IP addresses."}),Ie=ye.i18n.translate("xpack.securitySolution.eventRenderers.fileName",{defaultMessage:"File"}),Ce=ye.i18n.translate("xpack.securitySolution.eventRenderers.fileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),Te=ye.i18n.translate("xpack.securitySolution.eventRenderers.fimName",{defaultMessage:"File Integrity Module (FIM)"}),Me=ye.i18n.translate("xpack.securitySolution.eventRenderers.fimDescriptionPart1",{defaultMessage:"File Integrity Module (FIM) events show users (and system accounts) performing CRUD operations on files via specific processes."}),_e=ye.i18n.translate("xpack.securitySolution.eventRenderers.flowName",{defaultMessage:"Flow"}),Ne=ye.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart1",{defaultMessage:"The Flow renderer visualizes the flow of data between a source and destination. It's applicable to many types of events."}),De=ye.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart2",{defaultMessage:"The hosts, ports, protocol, direction, duration, amount transferred, process, geographic location, and other details are visualized when available."}),Ae=ye.i18n.translate("xpack.securitySolution.eventRenderers.libraryName",{defaultMessage:"Library"}),Fe=ye.i18n.translate("xpack.securitySolution.eventRenderers.libraryDescription",{defaultMessage:"Library events display a Dynamically Linked Library (DLL) being loaded by a process"}),qe=ye.i18n.translate("xpack.securitySolution.eventRenderers.processName",{defaultMessage:"Process"}),Le=ye.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart1",{defaultMessage:"Process events show users (and system accounts) starting and stopping processes."}),Re=ye.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart2",{defaultMessage:"Details including the command line arguments, parent process, and if applicable, file hashes are displayed when available."}),Pe=ye.i18n.translate("xpack.securitySolution.eventRenderers.registryName",{defaultMessage:"Registry"}),ze=ye.i18n.translate("xpack.securitySolution.eventRenderers.registryDescription",{defaultMessage:"Registry events show updates to the Windows Registry"}),Be=ye.i18n.translate("xpack.securitySolution.eventRenderers.socketName",{defaultMessage:"Socket (Network)"}),$e=ye.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart1",{defaultMessage:"Socket (Network) events show processes listening, accepting, and closing connections."}),Ge=ye.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart2",{defaultMessage:"Details including the protocol, ports, and a community ID for correlating all network events related to a single flow are displayed when available."}),Ue=ye.i18n.translate("xpack.securitySolution.eventRenderers.suricataName",{defaultMessage:"Suricata"}),Ve=ye.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart1",{defaultMessage:"Summarizes"}),He=ye.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart2",{defaultMessage:"intrusion detection (IDS), inline intrusion prevention (IPS), and network security monitoring (NSM) events"}),We=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemName",{defaultMessage:"System"}),Ye=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart1",{defaultMessage:"The Auditbeat"}),Ze=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart2",{defaultMessage:"module collects various security related information about a system."}),Ke=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart3",{defaultMessage:"All datasets send both periodic state information (e.g. all currently running processes) and real-time changes (e.g. when a new process starts or stops)."}),Qe=ye.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchName",{defaultMessage:"Threat Indicator Match"}),Xe=ye.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchDescription",{defaultMessage:"Summarizes events that matched threat indicators"}),Je=ye.i18n.translate("xpack.securitySolution.eventRenderers.zeekName",{defaultMessage:"Zeek (formerly Bro)"}),et=ye.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart1",{defaultMessage:"Summarizes events from the"}),tt=ye.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart2",{defaultMessage:"Network Security Monitoring (NSM) tool"}),at={[c.e.alert]:ge,[c.e.alerts]:fe,[c.e.auditd]:he,[c.e.auditd_file]:Ee,[c.e.library]:Ae,[c.e.system_security_event]:ke,[c.e.system_dns]:je,[c.e.netflow]:_e,[c.e.system]:We,[c.e.system_endgame_process]:qe,[c.e.registry]:Pe,[c.e.system_fim]:Te,[c.e.system_file]:Ie,[c.e.system_socket]:Be,[c.e.suricata]:"Suricata",[c.e.threat_match]:Qe,[c.e.zeek]:Je,[c.e.plain]:""},nt=({children:e,url:t})=>i.a.createElement(n.EuiLink,{href:t,target:"_blank",rel:"noopener nofollow noreferrer","data-test-subj":"externalLink"},e),rt=[{id:c.e.alerts,name:at[c.e.alerts],description:be,example:E,searchableDescription:be},{id:c.e.auditd,name:at[c.e.auditd],description:i.a.createElement("span",null,i.a.createElement(nt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},he)," ",ve),example:j,searchableDescription:`${he} ${ve}`},{id:c.e.auditd_file,name:at[c.e.auditd_file],description:i.a.createElement("span",null,i.a.createElement(nt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},he)," ",xe),example:I,searchableDescription:`${Ee} ${xe}`},{id:c.e.library,name:at[c.e.library],description:Fe,example:M,searchableDescription:Fe},{id:c.e.system_security_event,name:at[c.e.system_security_event],description:i.a.createElement("div",null,i.a.createElement("p",null,we),i.a.createElement("br",null),i.a.createElement("p",null,Se)),example:re,searchableDescription:`${we} ${Se}`},{id:c.e.system_dns,name:at[c.e.system_dns],description:Oe,example:H,searchableDescription:Oe},{id:c.e.netflow,name:at[c.e.netflow],description:i.a.createElement("div",null,i.a.createElement("p",null,Ne),i.a.createElement("br",null),i.a.createElement("p",null,De)),example:A,searchableDescription:`${Ne} ${De}`},{id:c.e.system,name:at[c.e.system],description:i.a.createElement("div",null,i.a.createElement("p",null,Ye," ",i.a.createElement(nt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-system.html"},We)," ",Ze),i.a.createElement("br",null),i.a.createElement("p",null,Ke)),example:G,searchableDescription:`${Ye} ${We} ${Ze} ${Ke}`},{id:c.e.system_endgame_process,name:at[c.e.system_endgame_process],description:i.a.createElement("div",null,i.a.createElement("p",null,Le),i.a.createElement("br",null),i.a.createElement("p",null,Re)),example:Z,searchableDescription:`${Le} ${Re}`},{id:c.e.registry,name:at[c.e.registry],description:ze,example:L,searchableDescription:ze},{id:c.e.system_fim,name:at[c.e.system_fim],description:Me,example:te,searchableDescription:Me},{id:c.e.system_file,name:at[c.e.system_file],description:Ce,example:J,searchableDescription:Ce},{id:c.e.system_socket,name:at[c.e.system_socket],description:i.a.createElement("div",null,i.a.createElement("p",null,$e),i.a.createElement("br",null),i.a.createElement("p",null,Ge)),example:se,searchableDescription:`${$e} ${Ge}`},{id:c.e.suricata,name:at[c.e.suricata],description:i.a.createElement("p",null,Ve," ",i.a.createElement(nt,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-suricata.html"},Ue)," ",He),example:z,searchableDescription:`${Ve} ${Ue} ${He}`},{id:c.e.threat_match,name:at[c.e.threat_match],description:Xe,example:ue,searchableDescription:`${Qe} ${Xe}`},{id:c.e.zeek,name:at[c.e.zeek],description:i.a.createElement("p",null,et," ",i.a.createElement(nt,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-zeek.html"},Je)," ",tt),example:me,searchableDescription:`${et} ${Je} ${tt}`}],it=l()(n.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-ietqpj-0"})([".euiTable{tr:has(.isNotSelected){background-color:",";}tr > *:last-child{display:none;}.euiTableHeaderCellCheckbox > .euiTableCellContent{display:none;}}"],(e=>e.theme.eui.euiColorLightestShade)),ot=l()(n.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-ietqpj-1"})(["overflow:auto;> div{padding:0;> div{margin:0;}}"]),st=e=>{if(e)return i.a.createElement(ot,{grow:1},i.a.createElement(e,null))},lt={box:{incremental:!0,schema:!0}},ct=()=>i.a.createElement(i.a.Fragment,null),ut={sort:{field:"name",direction:"asc"}},dt=l.a.button.withConfig({displayName:"StyledNameButton",componentId:"sc-ietqpj-2"})(["text-align:left;"]),pt=({excludedRowRendererIds:e=[],setExcludedRowRendererIds:t})=>{const a=Object(r.useCallback)((a=>()=>{const n=Object(y.xor)([a.id],e);t(n)}),[e,t]),o=Object(r.useCallback)(((e,t)=>i.a.createElement(dt,{className:"kbn-resetFocusState",onClick:a(t)},e)),[a]),s=Object(r.useCallback)(((t,r)=>i.a.createElement(n.EuiCheckbox,{id:r.id,onChange:a(r),className:e.includes(r.id)?"isNotSelected":"isSelected",checked:!e.includes(r.id)})),[e,a]),l=Object(r.useMemo)((()=>[{field:"id",name:"",sortable:!1,width:"32px",render:s,"data-test-subj":"renderer-checkbox"},{field:"name",name:"Name",sortable:!0,width:"10%",render:o,"data-test-subj":"renderer-name"},{field:"description",name:"Description",width:"25%",render:e=>e,"data-test-subj":"renderer-description"},{field:"example",name:"Example",width:"65%",render:st,"data-test-subj":"renderer-example"},{field:"searchableDescription",name:"Searchable Description",sortable:!1,width:"0px",render:ct,"data-test-subj":"renderer-searchable-description"}]),[s,o]);return i.a.createElement(it,{items:rt,itemId:"id",columns:l,search:lt,sorting:ut})};pt.displayName="RowRenderersBrowserComponent";const mt=i.a.memo(pt);mt.displayName="RowRenderersBrowser";const yt=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.eventRenderersTitle",{defaultMessage:"Event renderers"}),gt=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersTitle",{defaultMessage:"Customize event renderers"}),ft=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersDescription",{defaultMessage:"Event renderers automatically convey the most relevant details in an event to reveal its story"}),bt=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.enableAllRenderersButtonLabel",{defaultMessage:"Enable all"}),ht=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.disableAllRenderersButtonLabel",{defaultMessage:"Disable all"}),vt=l()(n.EuiModal).withConfig({displayName:"StyledEuiModal",componentId:"sc-m3n5c2-0"})([""," max-width:95vw;min-height:90vh;> .euiModal__flex{max-height:90vh;}"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`)),Et=l()(n.EuiModalBody).withConfig({displayName:"StyledEuiModalBody",componentId:"sc-m3n5c2-1"})([".euiModalBody__overflow{display:flex;align-items:stretch;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;> div:first-child{flex:0;}.euiBasicTable{flex:1;overflow:auto;}}}"]),xt=({timelineId:e})=>{const t=Object(o.useDispatch)(),a=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),s=Object(u.a)((t=>{var n;return(null!==(n=a(t,e))&&void 0!==n?n:m.b).excludedRowRendererIds})),[l,y]=Object(r.useState)(!1),g=Object(r.useCallback)((a=>t(Object(d.setExcludedRowRendererIds)({id:e,excludedRowRendererIds:a}))),[t,e]),f=Object(r.useCallback)((()=>y(!l)),[l]),b=Object(r.useCallback)((()=>y(!1)),[]),h=Object(r.useCallback)((()=>{g(Object.values(c.e))}),[g]),v=Object(r.useCallback)((()=>{g([])}),[g]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiToolTip,{content:gt},i.a.createElement(n.EuiButtonIcon,{"aria-label":gt,"data-test-subj":"show-row-renderers-gear",iconType:"gear",onClick:f},yt)),l&&i.a.createElement(vt,{onClose:b,"data-test-subj":"row-renderers-modal"},i.a.createElement(n.EuiModalHeader,null,i.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",direction:"row",gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiModalHeaderTitle,null,gt),i.a.createElement(n.EuiText,{size:"s"},ft)),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiFlexGroup,null,i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButtonEmpty,{size:"s","data-test-subj":"disable-all",onClick:h},ht)),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButton,{fill:!0,size:"s","data-test-subj":"enable-all",onClick:v},bt)))))),i.a.createElement(Et,null,i.a.createElement(mt,{excludedRowRendererIds:s,setExcludedRowRendererIds:g}))))},kt=i.a.memo(xt)},950:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return st})),a.d(t,"d",(function(){return ut})),a.d(t,"f",(function(){return Be})),a.d(t,"e",(function(){return pt})),a.d(t,"g",(function(){return Je})),a.d(t,"h",(function(){return vt})),a.d(t,"j",(function(){return nt})),a.d(t,"c",(function(){return Et})),a.d(t,"i",(function(){return St}));var n=a(2),r=a.n(n),i=a(19),o=a(4),s=a(56),l=a(5),c=a(596),u=a(221);const d=Object(n.memo)((({handleRefresh:e,http:t,handleCloseFlyout:a,addSuccess:d,addError:p})=>{const{navigateToApp:m}=Object(s.useKibana)().services.application,{start:y,...g}=Object(c.a)(),f=Object(n.useRef)(new AbortController);let b=function(e){return e.name="name",e.description="description",e}({});const[h,v]=Object(n.useState)({name:"",description:""}),E=({target:e},t)=>{const{value:a}=e;v({...h,[t]:a})};Object(n.useEffect)((()=>{null!=g.result&&m(l.m,{deepLinkId:l.Oc.exceptions,path:`/details/${g.result.list_id}`})}),[g,m]);const x=Object(n.useCallback)((()=>{var e;g.loading||""===h.name||(f.current=new AbortController,y({http:t,signal:f.current.signal,name:h.name,description:null!==(e=h.description)&&void 0!==e?e:""}))}),[g.loading,h.name,h.description,y,t]),k=Object(n.useCallback)((t=>{d({text:Object(u.pb)(h.name),title:u.jb}),e(),a()}),[d,a,e,h]),w=Object(n.useCallback)((e=>{var t;e.message.includes("AbortError")||null!=e&&null!==(t=e.body)&&void 0!==t&&t.message.includes("AbortError")||p(e,{title:o.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListErrorTitle",{defaultMessage:"creation error"})})}),[p]);Object(n.useEffect)((()=>{g.loading||(null!=g&&g.result?k(g.result):null!=g&&g.error&&w(null==g?void 0:g.error))}),[null==g?void 0:g.error,g.loading,g.result,w,k]);const S=Object(i.useGeneratedHtmlId)({prefix:"createSharedExceptionListFlyout"});return r.a.createElement(i.EuiFlyout,{ownFocus:!0,size:"s",onClose:a,"data-test-subj":"createSharedExceptionListFlyout","aria-labelledby":S},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{id:S,"data-test-subj":"createSharedExceptionListTitle"},u.h))),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(i.EuiText,null,u.f),r.a.createElement(i.EuiFieldText,{placeholder:u.g,value:h.name,onChange:e=>E(e,b.name),"aria-label":"Shared exception list name","data-test-subj":"createSharedExceptionListNameInput"}),r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiText,null,u.d),r.a.createElement(i.EuiTextArea,{placeholder:u.e,value:h.description,onChange:e=>E(e,b.description),"aria-label":"Shared exception list description","data-test-subj":"createSharedExceptionListDescriptionInput"})),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{iconType:"cross",onClick:a,flush:"left"},u.a)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"exception-lists-form-create-shared",onClick:x,disabled:""===h.name},u.c)))))}));d.displayName="CreateSharedListFlyout";var p=a(152),m=a(1334),y=a(778),g=a(41),f=a.n(g),b=a(49),h=a(788),v=a(546);const E=f()(i.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-19zoulh-0"})(["border-right:1px solid #d3dae6;padding:"," "," "," 0;"],b.euiThemeVars.euiSizeXS,b.euiThemeVars.euiSizeS,b.euiThemeVars.euiSizeXS),x=f()(i.EuiText).withConfig({displayName:"TextContainer",componentId:"sc-19zoulh-1"})(["width:max-content;"]),k=Object(n.memo)((({title:e,badgeString:t})=>r.a.createElement(i.EuiFlexGroup,{alignItems:"center"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(x,{grow:!0,size:"xs"},`${e}:`)),r.a.createElement(E,null,r.a.createElement(i.EuiBadge,null,t)))));k.displayName="TitleBadge";var w=a(43),S=a(1562);const j=Object(n.memo)((({item:e,actions:t,disableActions:a=!1,dataTestSubj:n})=>Object(w.jsx)(i.EuiFlexGroup,{responsive:!0,"data-test-subj":n,justifyContent:"spaceBetween"},Object(w.jsx)(i.EuiFlexItem,{grow:9},Object(w.jsx)(i.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${n}Title`},Object(w.jsx)("h3",null,e.name))),Object(w.jsx)(i.EuiFlexItem,{grow:!1},Object(w.jsx)(y.a,{iconType:"boxesHorizontal",disableActions:a,actions:t,"aria-label":"Exception item actions menu",dataTestSubj:n,anchorPosition:"downCenter"})))));j.displayName="ExceptionItemCardHeader";const O=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.editItemButton",{values:{listType:e},defaultMessage:"Edit {listType} exception"}),I=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.deleteItemButton",{values:{listType:e},defaultMessage:"Delete {listType} exception"}),C=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.createdLabel",{defaultMessage:"Created"}),T=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.updatedLabel",{defaultMessage:"Updated"}),M=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiresLabel",{defaultMessage:"Expires at"}),_=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiredLabel",{defaultMessage:"Expired at"}),N=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.metaDetailsBy",{defaultMessage:"by"}),D=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),A=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator",{defaultMessage:"IS"}),F=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),q=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),L=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),R=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.nestedOperator",{defaultMessage:"has"}),P=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator",{defaultMessage:"is one of"}),z=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),B=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator",{defaultMessage:"exists"}),$=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator.not",{defaultMessage:"does not exist"}),G=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator",{defaultMessage:"included in"}),U=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator.not",{defaultMessage:"is not included in"}),V=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.and",{defaultMessage:"AND"}),H=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.os",{defaultMessage:"OS"}),W=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.windows",{defaultMessage:"Windows"}),Y=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.linux",{defaultMessage:"Linux"}),Z=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.macos",{defaultMessage:"Mac"}),K=Object(w.css)("font-family:",b.euiThemeVars.euiFontFamily,";",""),Q=Object(n.memo)((({label:e,lastUpdate:t,lastUpdateValue:a,dataTestSubj:n})=>Object(w.jsx)(i.EuiFlexGroup,{"data-test-subj":`${n||""}metaInfoDetails`,alignItems:"center",gutterSize:"s",wrap:!0,responsive:!0},Object(w.jsx)(i.EuiFlexItem,{grow:!1},Object(w.jsx)(i.EuiText,{size:"xs",css:K},e)),Object(w.jsx)(i.EuiFlexItem,{grow:!1,"data-test-subj":`${n||""}lastUpdate`},Object(w.jsx)(i.EuiBadge,{color:"default",css:K},t)),null!=a&&Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(i.EuiFlexItem,{grow:!1},Object(w.jsx)(i.EuiText,{size:"xs",css:K},N)),Object(w.jsx)(i.EuiFlexItem,{grow:!1,"data-test-subj":`${n||""}lastUpdateValue`},Object(w.jsx)(i.EuiFlexGroup,{responsive:!0,gutterSize:"xs",alignItems:"center"},Object(w.jsx)(i.EuiFlexItem,{grow:!1},Object(w.jsx)(i.EuiBadge,{color:"hollow",css:K},a))))))));Q.displayName="MetaInfoDetails";var X=a(1257);const J=Object(w.css)("border-right:1px solid #d3dae6;padding:",b.euiThemeVars.euiSizeS," ",b.euiThemeVars.euiSizeM," ",b.euiThemeVars.euiSizeS," 0;",""),ee=Object(n.memo)((({item:e,rules:t,dataTestSubj:a,securityLinkAnchorComponent:s,formattedDateComponent:l})=>{const c=l,u=Object(n.useMemo)((()=>Object(X.a)({dataTestSubj:a,linkedRules:t,securityLinkAnchorComponent:s})),[a,t,s]),d=Object(n.useMemo)((()=>!!e.expire_time&&new Date(e.expire_time)<=new Date),[e]);return Object(w.jsx)(i.EuiFlexGroup,{alignItems:"center",responsive:!0,gutterSize:"s","data-test-subj":a},null!==c&&Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(i.EuiFlexItem,{css:J,grow:!1},Object(w.jsx)(Q,{label:C,lastUpdate:Object(w.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentCreatedBy",fieldName:"created_at",value:e.created_at}),lastUpdateValue:e.created_by,dataTestSubj:`${a||""}CreatedBy`})),Object(w.jsx)(i.EuiFlexItem,{css:J,grow:!1},Object(w.jsx)(Q,{label:T,lastUpdate:Object(w.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentUpdatedBy",fieldName:"updated_at",value:e.updated_at}),lastUpdateValue:e.updated_by,dataTestSubj:`${a||""}UpdatedBy`})),null!=e.expire_time&&Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(i.EuiFlexItem,{css:J,grow:!1},Object(w.jsx)(Q,{label:d?_:M,lastUpdate:Object(w.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentExpireTime",fieldName:"expire_time",value:e.expire_time}),dataTestSubj:`${a||""}ExpireTime`})))),Object(w.jsx)(i.EuiFlexItem,null,Object(w.jsx)(y.a,{emptyButton:!0,useCustomActions:!0,iconType:"list",actions:u,disableActions:!1,text:(p=t.length,o.i18n.translate("exceptionList-components.exceptions.card.exceptionItem.affectedRules",{values:{numRules:p},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"})),dataTestSubj:a})));var p}));ee.displayName="ExceptionItemCardMetaInfo";const te=Object(w.css)("margin-left:",b.euiThemeVars.euiSizeXL,";margin-bottom:",b.euiThemeVars.euiSizeXS,";padding-top:",b.euiThemeVars.euiSizeXS,";",""),ae=Object(p.cx)("eui-xScroll","\n  border: 1px;\n  border-color: #d3dae6;\n  border-style: solid;\n"),ne=Object(w.css)("display:flex;align-items:center;margin-left:",b.euiThemeVars.euiSizeS,";",""),re={name:"s5xdrg",styles:"display:flex;align-items:center"};var ie=a(1471),oe=a(1231);const se=Object(p.css)("display:inline;margin-left:",b.euiThemeVars.euiSizeXS,";",""),le=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:a})=>{const{showSpaceWarningIcon:n,warningText:r}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(ie.a):Object(ie.a)(e)),warningText:t||oe.k.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:a});return n&&e?Object(w.jsx)("div",{className:se},Object(w.jsx)(i.EuiToolTip,{position:"top",content:r},Object(w.jsx)(i.EuiIcon,{"data-test-subj":"valueWithSpaceWarningTooltip",type:t,color:"warning"}))):null};var ce=a(403);const ue=Object.freeze({linux:Y,mac:Z,macos:Z,windows:W}),de=Object.freeze({[ce.b.NESTED]:R,[ce.b.MATCH_ANY]:P,[ce.b.MATCH]:A,[ce.b.WILDCARD]:q,[ce.b.EXISTS]:B,[ce.b.LIST]:G}),pe=Object.freeze({[ce.b.MATCH_ANY]:z,[ce.b.MATCH]:F,[ce.b.WILDCARD]:L,[ce.b.EXISTS]:$,[ce.b.LIST]:U}),me=Object(p.css)({name:"1089mxj",styles:"white-space:pre-wrap"}),ye=({children:e})=>Object(w.jsx)("span",{className:me},e),ge=(e,t,a)=>{var n;const r=a;return"match_any"===e&&Array.isArray(t)?t.map(((e,t)=>Object(w.jsx)(i.EuiBadge,{key:t,"data-test-subj":`matchAnyBadge${t}`,color:"hollow"},Object(w.jsx)(ye,null,e)))):"list"===e&&t?Object(w.jsx)(r,{shouldShowContentIfModalNotAvailable:!0,listId:t.toString()},t):null!==(n=Object(w.jsx)(ye,null,t))&&void 0!==n?n:""},fe=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=de[e])&&void 0!==a?a:e:null!==(n=pe[e])&&void 0!==n?n:e},be=(e,t,a,n)=>Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(i.EuiExpression,{description:fe(e,t),value:ge(e,a,n),"data-test-subj":"entryValueExpression"}),Object(w.jsx)(le,{value:a})),he=Object(n.memo)((({entry:e,index:t,isNestedEntry:a=!1,dataTestSubj:n,showValueListModal:o})=>{const{field:s,type:l}=e,c=(e=>"list"===e.type?e.list.id:"value"in e?e.value:"")(e),u="operator"in e?e.operator:"",d=`${s}${l}${c}${t}`;return Object(w.jsx)("div",{"data-test-subj":`${n||""}${d}EntryContent`,key:d},Object(w.jsx)("div",{css:re},a?Object(w.jsx)(i.EuiFlexGroup,{responsive:!0,css:te,direction:"row",alignItems:"center",gutterSize:"m","data-test-subj":`${n||""}NestedEntry`},Object(w.jsx)(i.EuiToken,{"data-test-subj":"nstedEntryIcon",iconType:"tokenNested",size:"s"}),Object(w.jsx)("div",{css:ne},Object(w.jsx)(i.EuiExpression,{description:"",value:s,color:"subdued"}),be(l,u,c,o))):Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(i.EuiExpression,{description:0===t?"":V,value:s,color:0===t?"primary":"subdued","data-test-subj":`${n||""}SingleEntry`}),be(l,u,c,o))))}));he.displayName="EntryContent";const ve=Object(n.memo)((({os:e,dataTestSubj:t})=>{const a=Object(n.useMemo)((()=>e.map((e=>{var t;return null!==(t=ue[e])&&void 0!==t?t:e})).join(", ")),[e]);return a?Object(w.jsx)("div",{"data-test-subj":`${t||""}Os`},Object(w.jsx)("strong",null,Object(w.jsx)(i.EuiExpression,{"data-test-subj":"osLabel",description:"",value:H}),Object(w.jsx)(i.EuiExpression,{"data-test-subj":"osValue",description:A,value:a}))):null}));ve.displayName="OsCondition";const Ee=Object(n.memo)((({os:e,entries:t,dataTestSubj:a,showValueListModal:n})=>Object(w.jsx)(i.EuiPanel,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":a,className:ae},null!=e&&e.length?Object(w.jsx)(ve,{os:e,dataTestSubj:a}):null,t.map(((e,t)=>{const r="entries"in e?e.entries:[];return Object(w.jsx)("div",{key:`ExceptionItemCardConditionsContainer${t}`},Object(w.jsx)(he,{key:`entry${t}`,entry:e,index:t,dataTestSubj:a,showValueListModal:n}),null!=r&&r.length?r.map(((e,r)=>Object(w.jsx)(he,{key:`nestedEntry${t}${r}`,entry:e,index:r,isNestedEntry:!0,dataTestSubj:a,showValueListModal:n}))):null)})))));Ee.displayName="ExceptionItemCardConditions";const xe=Object(w.css)("color:",b.euiThemeVars.euiColorPrimary,";",""),ke=Object(n.memo)((({comments:e,dataTestSubj:t})=>e.length?Object(w.jsx)(i.EuiFlexItem,{"data-test-subj":t},Object(w.jsx)(i.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:Object(w.jsx)(i.EuiText,{size:"s",css:xe,"data-test-subj":`${t||""}TextButton`},D(e.length)),arrowDisplay:"none","data-test-subj":"exceptionItemCardComments"},Object(w.jsx)(i.EuiPanel,{"data-test-subj":"accordionContentPanel",hasBorder:!0,hasShadow:!0,paddingSize:"m"},Object(w.jsx)(i.EuiCommentList,{"data-test-subj":"accordionCommentList",comments:e})))):null));ke.displayName="ExceptionItemCardComments";const we=({disableActions:e=!1,exceptionItem:t,listType:a,ruleReferences:r,dataTestSubj:o,editActionLabel:s,deleteActionLabel:l,securityLinkAnchorComponent:c,formattedDateComponent:u,getFormattedComments:d,onDeleteException:p,onEditException:m,showValueListModal:y})=>{const{actions:g,formattedComments:f}=(({listType:e,editActionLabel:t,deleteActionLabel:a,exceptionItem:r,getFormattedComments:i,onEditException:o,onDeleteException:s})=>{const l=Object(n.useCallback)((()=>{s({id:r.id,name:r.name,namespaceType:r.namespace_type})}),[s,r.id,r.name,r.namespace_type]),c=Object(n.useCallback)((()=>{o(r)}),[o,r]),u=Object(n.useMemo)((()=>i(r.comments)),[r.comments,i]);return{actions:Object(n.useMemo)((()=>[{key:"edit",icon:"controlsHorizontal",label:t||O(e),onClick:c},{key:"delete",icon:"trash",label:a||I(e),onClick:l}]),[t,e,a,l,c]),formattedComments:u}})({listType:a,editActionLabel:s,deleteActionLabel:l,exceptionItem:t,getFormattedComments:d,onEditException:m,onDeleteException:p});return Object(w.jsx)(i.EuiPanel,{key:`${t.id}exceptionItemPanel`,paddingSize:"l","data-test-subj":o||"",hasBorder:!0,hasShadow:!1},Object(w.jsx)(i.EuiFlexGroup,{responsive:!0,gutterSize:"m",direction:"column"},Object(w.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardHeaderContainer"},Object(w.jsx)(j,{item:t,actions:g,disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),Object(w.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardMeta"},Object(w.jsx)(ee,{item:t,rules:r,dataTestSubj:"exceptionItemCardMetaInfo",securityLinkAnchorComponent:c,formattedDateComponent:u})),Object(w.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardCondition"},Object(w.jsx)(Ee,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions",showValueListModal:y})),f.length>0&&Object(w.jsx)(ke,{dataTestSubj:"exceptionsItemCommentAccordion",comments:f})))};we.displayName="ExceptionItemCardComponent";const Se=r.a.memo(we);Se.displayName="ExceptionItemCard";const je=({dataTestSubj:e,ariaLabel:t,pagination:a,onPaginationChange:r})=>{const{pageIndex:o,pageCount:s,pageSize:l,pageSizeOptions:c,handleItemsPerPageChange:u,handlePageIndexChange:d}=(({pagination:e,onPaginationChange:t})=>{const{pageIndex:a,totalItemCount:r,pageSize:i,pageSizeOptions:o}=e,s=Object(n.useMemo)((()=>isFinite(r/i)?Math.ceil(r/i):0),[i,r]),l=Object(n.useCallback)((e=>{t({pagination:{pageIndex:a,pageSize:e,totalItemCount:r}})}),[a,r,t]),c=Object(n.useCallback)((e=>{t({pagination:{pageIndex:e,pageSize:i,totalItemCount:r}})}),[i,r,t]);return{pageCount:s,pageIndex:a,pageSize:i,pageSizeOptions:o,handleItemsPerPageChange:l,handlePageIndexChange:c}})({pagination:a,onPaginationChange:r});return Object(w.jsx)(i.EuiTablePagination,{"data-test-subj":e,"aria-label":t,pageCount:s,activePage:o,itemsPerPage:l,onChangePage:d,onChangeItemsPerPage:u,itemsPerPageOptions:c})};je.displayName="PaginationComponent";const Oe=r.a.memo(je);Oe.displayName="Pagination";const Ie=Object(w.css)("margin:",b.euiThemeVars.euiSize," 0;&div:first-child{margin:",b.euiThemeVars.euiSizeXS," 0 ",b.euiThemeVars.euiSize,";}",""),Ce=({lastUpdated:e,viewerStatus:t,isReadOnly:a,exceptions:n,listType:o,ruleReferences:s,emptyViewerTitle:l,emptyViewerBody:c,emptyViewerButtonText:u,pagination:d,dataTestSubj:p,editActionLabel:m,deleteActionLabel:y,securityLinkAnchorComponent:g,exceptionsUtilityComponent:f,formattedDateComponent:b,getFormattedComments:h,onPaginationChange:v,onDeleteException:E,onEditExceptionItem:x,onCreateExceptionListItem:k,showValueListModal:j})=>{const O=f;if(!n.length||t)return Object(w.jsx)(S.a,{isReadOnly:a,title:l,viewerStatus:t,buttonText:u,body:c,onEmptyButtonStateClick:k});const I=j;return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(O,{pagination:d,lastUpdated:e}),Object(w.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"none",className:"eui-yScrollWithShadows"},Object(w.jsx)(i.EuiFlexItem,{grow:!1},Object(w.jsx)(i.EuiFlexGroup,{css:Ie,"data-test-subj":`${p||""}exceptionsContainer`,direction:"column",gutterSize:"s"},n.map((e=>Object(w.jsx)(i.EuiFlexItem,{"data-test-subj":`${p||""}exceptionItemContainer`,grow:!1,key:e.id},Object(w.jsx)(Se,{key:`${e.id}exceptionItemCardKey`,dataTestSubj:`${p||""}exceptionItemCard`,disableActions:a,exceptionItem:e,listType:o,ruleReferences:Object.keys(s).length&&s[e.list_id]?s[e.list_id].referenced_rules:[],editActionLabel:m,deleteActionLabel:y,onDeleteException:E,onEditException:x,securityLinkAnchorComponent:g,formattedDateComponent:b,getFormattedComments:h,showValueListModal:I}))))))),Object(w.jsx)(Oe,{dataTestSubj:`${p||""}pagination`,pagination:d,onPaginationChange:v}))};Ce.displayName="ExceptionItemsComponent";const Te=r.a.memo(Ce);Te.displayName="ExceptionsItems";var Me=a(151),_e=a(54),Ne=a.n(_e);const De=o.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),Ae=(o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"}));o.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),o.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),o.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),o.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"});var Fe=a(873);const qe=e=>e.map((e=>({username:e.created_by,timestamp:Ne()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:De,timelineAvatar:r.a.createElement(i.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:r.a.createElement(i.EuiText,{size:"s"},e.comment),actions:r.a.createElement(Fe.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:Ae})})));var Le=a(144),Re=a(668),Pe=a(258);const ze=({referenceName:e,referenceId:t,external:a,dataTestSubj:n})=>r.a.createElement(Le.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=n?n:""}`,deepLinkId:l.Oc.rules,path:Object(Pe.c)(t,Re.b.alerts),target:a?"_blank":void 0},e);ze.displayName="LinkToRuleDetailsComponent";const Be=r.a.memo(ze);Be.displayName="LinkToRuleDetails";var $e=a(42),Ge=a(362);const Ue=f.a.span.withConfig({displayName:"StyledText",componentId:"sc-1q48q07-0"})(["font-weight:bold;color:",";"],(({theme:e})=>e.eui.euiColorDarkestShade)),Ve=f()(i.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-1q48q07-1"})(["height:50px;"]),He=f.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-1q48q07-2"})(["display:inline-block !important;vertical-align:middle !important;line-height:1;"]),We=({dataTestSubj:e,pagination:t,lastUpdated:a,exceptionsTitle:n})=>{const{pageSize:o,totalItemCount:s}=t;return r.a.createElement(Ve,{alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(Ge.a,null,r.a.createElement(Ge.d,null,r.a.createElement(Ge.c,null,r.a.createElement(Ge.e,{dataTestSubj:`${e}ShowingText`},r.a.createElement($e.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:r.a.createElement(Ue,null,`1-${Math.min(o,s)}`),partTwo:r.a.createElement(Ue,null,`${s}`)}})),n&&r.a.createElement(Ue,{"data-test-subj":`${e}exceptionsTitle`},n))))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiText,{size:"s","data-test-subj":`${e}LastUpdated`},r.a.createElement($e.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:r.a.createElement(He,null,r.a.createElement(Me.b,{value:a,tooltipAnchorClassName:"eui-textTruncate"}))}}))))};We.displayName="ExceptionsUtilityComponent";const Ye=r.a.memo(We);Ye.displayName="ExceptionsUtility";var Ze=a(597),Ke=a(540),Qe=a(547);const Xe=({isReadOnly:e,exceptions:t,listType:a,lastUpdated:i,pagination:o,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,viewerStatus:u,ruleReferences:d,hideUtility:p=!1,onDeleteException:y,onEditExceptionItem:g,onPaginationChange:f,onCreateExceptionListItem:b})=>{const h=Object(Ke.a)("crudEndpointExceptions"),v=Object(n.useMemo)((()=>a===m.a.ENDPOINT?Ze.c:Ze.d),[a]),E=Object(n.useMemo)((()=>a===m.a.ENDPOINT?Ze.a:Ze.b),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Te,{viewerStatus:u,listType:a,ruleReferences:d,isReadOnly:e||!h,exceptions:t,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,pagination:o,lastUpdated:i,editActionLabel:v,deleteActionLabel:E,onPaginationChange:f,onEditExceptionItem:g,onDeleteException:y,getFormattedComments:qe,securityLinkAnchorComponent:Be,formattedDateComponent:Me.a,onCreateExceptionListItem:b,exceptionsUtilityComponent:()=>p?null:r.a.createElement(Ye,{exceptionsTitle:Ze.e,pagination:o,lastUpdated:i}),showValueListModal:Qe.a}))};Xe.displayName="ListExceptionItemsComponent";const Je=r.a.memo(Xe);Je.displayName="ListExceptionItems";var et=a(795),tt=a(598),at=a(868);const nt=Object(n.memo)((({linkedRules:e,showButtonLoader:t,saveIsDisabled:a=!0,onSave:n,onCancel:o,onRuleSelectionChange:s})=>{const l=Object(i.useGeneratedHtmlId)({prefix:"complicatedFlyoutTitle"});return r.a.createElement(i.EuiFlyout,{hideCloseButton:!0,ownFocus:!0,onClose:o,"aria-labelledby":l},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{id:l},u.W)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiText,{size:"s",color:"subdued"},u.Z)),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(at.a,{initiallySelectedRules:e,onRuleSelectionChange:s})),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{onClick:o,flush:"left"},u.Y)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"manageListRulesSaveButton",isLoading:t,disabled:a,onClick:n,fill:!0},u.ab)))))}));nt.displayName="ManageRules";var rt=a(780);const it=f()(i.EuiPanel).withConfig({displayName:"ExceptionPanel",componentId:"sc-11ogn3z-0"})(["margin:-"," "," 0 ",";"],b.euiThemeVars.euiSizeS,b.euiThemeVars.euiSizeM,b.euiThemeVars.euiSizeM),ot=f()(i.EuiFlexGroup).withConfig({displayName:"ListHeaderContainer",componentId:"sc-11ogn3z-1"})(["padding:",";text-align:initial;"],b.euiThemeVars.euiSizeS),st=Object(n.memo)((({exceptionsList:e,handleDelete:t,handleExport:a,handleDuplicate:o,readOnly:s})=>{const{linkedRules:l,showManageRulesFlyout:c,showManageButtonLoader:d,disableManageButton:g,onManageRules:f,onSaveManageRules:b,onCancelManageRules:E,onRuleSelectionChange:x}=Object(et.a)(e.list_id),{euiTheme:w}=Object(i.useEuiTheme)(),S=Object(i.useEuiShadow)(),j=Object(n.useMemo)((()=>p.css`
        .euiAccordion__buttonContent {
          flex: 1 1 auto;
          cursor: pointer;
        }
        .euiAccordion__triggerWrapper {
          z-index: 100;
          position: relative;
          border-radius: ${w.border.radius.medium};
          padding: ${w.size.base};
          ${S}
        }
      `),[w.border.radius.medium,w.size.base,S]),{listId:O,listName:I,listType:C,createdAt:T,createdBy:M,exceptions:_,pagination:N,ruleReferences:D,toggleAccordion:A,openAccordionId:F,menuActionItems:q,listDescription:L,exceptionItemsCount:R,onEditExceptionItem:P,onDeleteException:z,onPaginationChange:B,setToggleAccordion:$,exceptionViewerStatus:G,showAddExceptionFlyout:U,showEditExceptionFlyout:V,exceptionToEdit:H,onAddExceptionClick:W,handleConfirmExceptionFlyout:Y,handleCancelExceptionItemFlyout:Z,goToExceptionDetail:K,emptyViewerTitle:Q,emptyViewerBody:X,emptyViewerButtonText:J,handleCancelExpiredExceptionsModal:ee,handleConfirmExpiredExceptionsModal:te,showIncludeExpiredExceptionsModal:ae}=Object(tt.a)({exceptionsList:e,handleExport:a,handleDelete:t,handleDuplicate:o,handleManageRules:f});return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiAccordion,{className:j,id:F,buttonElement:"div",onToggle:()=>$(!A),buttonContent:r.a.createElement(ot,{gutterSize:"m",alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiFlexGroup,{direction:"column",key:O,alignItems:"flexStart",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiText,{size:"m"},r.a.createElement(i.EuiLink,{"data-test-subj":"exception-list-name",onClick:K},I))),r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiText,{size:"xs"},r.a.createElement(i.EuiTextColor,{color:"subdued"},L))))),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",wrap:!0,responsive:!0},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(k,{title:u.i,badgeString:T})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(k,{title:u.b,badgeString:M})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(k,{title:u.l,badgeString:R})),r.a.createElement(i.EuiFlexItem,{"data-test-subj":"exceptionListCardLinkedRulesBadge",grow:!1},r.a.createElement(k,{title:u.gb,badgeString:l.length.toString()})))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(y.a,{disableActions:s,dataTestSubj:"sharedListOverflowCard",actions:q}))),"data-test-subj":`exceptionsManagementListCard-${O}`},r.a.createElement(it,{hasBorder:!0},r.a.createElement(Je,{isReadOnly:s,exceptions:_,listType:e.type,pagination:N,hideUtility:!0,viewerStatus:G,ruleReferences:D,onDeleteException:z,onEditExceptionItem:P,onPaginationChange:B,onCreateExceptionListItem:W,lastUpdated:null,emptyViewerTitle:Q,emptyViewerBody:X,emptyViewerButtonText:J}))),U?r.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:C===m.a.ENDPOINT,sharedListToAddTo:[e],onCancel:Z,onConfirm:Y,"data-test-subj":"addExceptionItemFlyoutInSharedLists",showAlertCloseOptions:!1}):null,V&&H?r.a.createElement(h.a,{list:e,itemToEdit:H,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:Z,onConfirm:Y,"data-test-subj":"editExceptionItemFlyoutInSharedLists"}):null,c?r.a.createElement(nt,{linkedRules:l,showButtonLoader:d,saveIsDisabled:g,onSave:b,onCancel:E,onRuleSelectionChange:x}):null,ae?r.a.createElement(rt.b,{handleCloseModal:ee,onModalConfirm:te,action:ae}):null)}));st.displayName="ExceptionsListCard";var lt=a(168),ct=a(600);const ut=r.a.memo((({handleRefresh:e,http:t,addSuccess:a,addError:o,setDisplayImportListFlyout:s})=>{var l;const c=Object(n.useRef)(null),d=Object(i.useGeneratedHtmlId)({prefix:"filePicker"}),[p,m]=Object(n.useState)(null),[y,g]=Object(n.useState)(!1),[f,b]=Object(n.useState)(!1),[h,v]=Object(n.useState)(!1),[E,x]=Object(n.useState)(!1),k=Object(n.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),m(null),v(!1),x(!1),b(!1),g(!1)}),[]),{start:w,...S}=Object(ct.a)(),j=Object(n.useRef)(new AbortController),O=Object(n.useCallback)((()=>{!S.loading&&p&&(j.current=new AbortController,Array.from(p).forEach((e=>w({file:e,http:t,signal:j.current.signal,overwrite:y,overwriteExceptions:y,asNewList:f}))))}),[f,p,t,w,S.loading,y]),I=Object(n.useCallback)((t=>{k(),a({title:u.mb}),e()}),[k,a,e]),C=Object(n.useCallback)((e=>{e.forEach((e=>{e.error.message.includes("AbortError")||o(e.error.message,{title:u.lb})}))}),[o]);Object(n.useEffect)((()=>{var e;if(!S.loading)if(null!=S&&null!==(e=S.result)&&void 0!==e&&e.success)I(null==S?void 0:S.result);else{var t,a;const e=[];var n,r;null!=S&&null!==(t=S.error)&&void 0!==t&&t.body&&e.push({error:{...null==S||null===(n=S.error)||void 0===n?void 0:n.body}}),null!=S&&null!==(a=S.result)&&void 0!==a&&a.errors&&(null==S||null===(r=S.result)||void 0===r||r.errors.forEach((t=>{t.error.message.includes("already exists")&&(v(!0),t.error.message.includes(`Found that list_id: "${lt.k}" already exists`)&&x(!0)),e.push(t)}))),C(e)}}),[C,I,null==S?void 0:S.error,S.loading,null==S?void 0:S.result,null==S||null===(l=S.result)||void 0===l?void 0:l.errors]);const T=Object(n.useCallback)((e=>{m(null!=e?e:null)}),[]),M=Object(i.useGeneratedHtmlId)({prefix:"importExceptionListFlyoutTitle"});return r.a.createElement(i.EuiFlyout,{ownFocus:!0,size:"s",onClose:()=>s(!1),"aria-labelledby":M},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{id:M},u.S))),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(i.EuiText,null,u.R),r.a.createElement(i.EuiFilePicker,{id:d,multiple:!0,ref:c,initialPromptText:u.V,onChange:T,display:"large","aria-label":"Use aria labels when no actual label is in use"}),h&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiTextColor,{color:"danger"},u.U),r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiCheckbox,{id:"basicCheckboxId",label:u.T,checked:y,"data-test-subj":"importExceptionListOverwriteExistingCheckbox",onChange:e=>{g(!y),b(!1)}}),r.a.createElement(i.EuiToolTip,{position:"bottom",content:E?u.P:""},r.a.createElement(i.EuiCheckbox,{id:"createNewListCheckbox",label:u.Q,"data-test-subj":"importExceptionListCreateNewCheckbox",checked:f,disabled:E,onChange:e=>{b(!f),g(!1)}})))),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"exceptionListsImportFormCloseBTN",iconType:"cross",onClick:()=>s(!1),flush:"left"},u.a)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"exception-lists-form-import-action",onClick:O,disabled:null==p||S.loading},u.kb)))))})),dt=({linkTitle:e,listId:t,external:a,dataTestSubj:n})=>r.a.createElement(Le.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=n?n:""}`,deepLinkId:l.Oc.exceptions,path:`/details/${t}`,target:a?"_blank":void 0},e);dt.displayName="LinkToListDetailsComponent";const pt=r.a.memo(dt);pt.displayName="LinkToListDetails";var mt=a(1314);const yt={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},gt=({addExceptionButtonText:e,placeholdertext:t,canAddException:a,listType:r,isSearching:o,dataTestSubj:s,filters:l=[],isButtonFilled:c=!0,buttonIconType:u,onSearch:d,onAddExceptionClick:p})=>{const m=Object(n.useCallback)((({queryText:e})=>{d({search:e})}),[d]),y=Object(n.useCallback)((()=>{p(r)}),[p,r]);return Object(w.jsx)(i.EuiFlexGroup,{alignItems:"center"},Object(w.jsx)(i.EuiFlexItem,{grow:!0},Object(w.jsx)(i.EuiSearchBar,{box:{placeholder:t,incremental:!1,schema:yt,"data-test-subj":`${s||""}searchBar`},filters:l,onChange:m})),!a&&Object(w.jsx)(i.EuiFlexItem,{grow:!1},Object(w.jsx)(i.EuiButton,{"data-test-subj":`${s||""}Button`,onClick:y,isDisabled:o,fill:c,iconType:u},e)))};gt.displayName="SearchBarComponent";const ft=r.a.memo(gt);ft.displayName="SearchBar";var bt=a(601);const ht=({list:e,isReadOnly:t,refreshExceptions:a})=>{const{listName:n,exceptions:o,listType:s,lastUpdated:l,pagination:c,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:y,viewerStatus:g,ruleReferences:f,showAddExceptionFlyout:b,showEditExceptionFlyout:E,exceptionToEdit:x,exceptionViewerStatus:k,onSearch:w,onAddExceptionClick:j,onDeleteException:O,onEditExceptionItem:I,onPaginationChange:C,handleCancelExceptionItemFlyout:T,handleConfirmExceptionFlyout:M}=Object(bt.a)(e,a);return r.a.createElement(r.a.Fragment,null,b?r.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:s===m.a.ENDPOINT,sharedListToAddTo:[e],onCancel:T,onConfirm:M,"data-test-subj":"addExceptionItemFlyoutInList",showAlertCloseOptions:!1}):g===mt.a.EMPTY||g===mt.a.LOADING?r.a.createElement(S.a,{isReadOnly:t,viewerStatus:g,onEmptyButtonStateClick:j,title:u.B,body:u.y(n),buttonText:u.z}):r.a.createElement(i.EuiPanel,{hasBorder:!1,hasShadow:!1},r.a.createElement(r.a.Fragment,null,E&&x&&r.a.createElement(h.a,{list:e,itemToEdit:x,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:T,onConfirm:M,"data-test-subj":"editExceptionItemFlyoutInList"}),r.a.createElement(ft,{addExceptionButtonText:s===m.a.ENDPOINT?u.x:u.w,listType:s,onSearch:w,onAddExceptionClick:j,isSearching:g===mt.a.SEARCHING,isButtonFilled:!1,buttonIconType:"plusInCircle"}),r.a.createElement(Je,{viewerStatus:k,listType:s,ruleReferences:f,isReadOnly:t,exceptions:o,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:y,pagination:c,lastUpdated:l,onPaginationChange:C,onEditExceptionItem:I,onDeleteException:O,onCreateExceptionListItem:j}))))};ht.displayName="ListWithSearchComponent";const vt=r.a.memo(ht);vt.displayName="ListWithSearch";const Et=({onRefresh:e,totalExceptionLists:t,setSort:a,sort:n,sortFields:o})=>{var s;const l=null==o?void 0:o.find((e=>e.field===(null==n?void 0:n.field)));return r.a.createElement(Ge.a,{border:!0},r.a.createElement(Ge.d,null,r.a.createElement(Ge.c,null,r.a.createElement(Ge.e,{dataTestSubj:"showingExceptionLists"},u.hb(t))),r.a.createElement(Ge.c,null,r.a.createElement(Ge.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:e},u.fb))),r.a.createElement(Ge.d,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(Ge.c,null,n&&r.a.createElement(Ge.b,{dataTestSubj:"sortExceptions",iconSide:"right",iconType:"asc"===n.order?"sortUp":"sortDown",popoverPanelPaddingSize:"s",popoverContent:()=>r.a.createElement(i.EuiContextMenuPanel,{size:"s",items:null==o?void 0:o.map((e=>{const t=(null==l?void 0:l.field)===e.field;let o=e.defaultOrder;return t&&(o="asc"===n.order?"desc":"asc"),r.a.createElement(i.EuiContextMenuItem,{key:e.field,onClick:()=>null==a?void 0:a({field:e.field,order:o})},r.a.createElement(xt,null,e.label," ",(null==l?void 0:l.field)===e.field&&r.a.createElement(kt,{type:"asc"===n.order?"sortUp":"sortDown"})))}))})},r.a.createElement(xt,null,u.ib," ",null==o||null===(s=o.find((e=>e.field===n.field)))||void 0===s?void 0:s.label))))))},xt=f()("div").withConfig({displayName:"SortMenuItem",componentId:"sc-1h5b7pp-0"})(["display:flex;align-items:center;"]),kt=f()(i.EuiIcon).withConfig({displayName:"SortIcon",componentId:"sc-1h5b7pp-1"})(["margin-left:8px;"]);Et.displayName="ExceptionsTableUtilityBar";const wt={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},St=r.a.memo((({onSearch:e})=>r.a.createElement(i.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":u.m,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:u.D,incremental:!1,schema:wt}})));St.displayName="ListsSearchBar"},952:function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var n=a(2),r=a.n(n),i=a(19),o=a(48),s=a(1213),l=a(844),c=a(1261),u=a(694),d=a(4),p=a(793),m=a(119),y=a.n(m);const g=Object(n.memo)((e=>{const t=Object(n.useRef)(null),a=r.a.createElement(i.EuiButton,y()({buttonRef:t},e));return Object(n.useEffect)((()=>{t.current&&t.current.focus()}),[]),a}));g.displayName="AutoFocusButton";var f=a(126),b=a(451),h=a(118),v=a(361);const E=Object.freeze({deleteActionFailure:(e,t)=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionFailure",{defaultMessage:'Unable to remove "{itemName}". Reason: {errorMessage}',values:{itemName:e,errorMessage:t}}),deleteActionSuccess:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionSuccess",{defaultMessage:'"{itemName}" has been removed',values:{itemName:e}})}),x=Object.freeze({deleteModalTitle:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalTitle",{defaultMessage:"Delete {itemName}",values:{itemName:e}}),deleteModalImpactTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactTitle",{defaultMessage:"Warning"}),deleteModalImpactInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfo",{defaultMessage:"Deleting this entry will remove it from {count} associated {count, plural, one {policy} other {policies}}.",values:{count:Object(b.f)(e)?d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfoAll",{defaultMessage:"all"}):Object(b.d)(e).length}}),deleteModalConfirmInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalConfirmInfo",{defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalSubmitButtonTitle",{defaultMessage:"Delete"}),deleteModalCancelButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalCancelButtonTitle",{defaultMessage:"Cancel"})}),k=Object(n.memo)((({apiClient:e,item:t,onCancel:a,onSuccess:o,"data-test-subj":s,labels:l})=>{const c=Object(f.a)(s),{deleteArtifactItem:u,isLoading:d}=((e,t,a)=>{const r=Object(h.n)(),i=Object(v.c)(e,{onError:e=>{var n;r.addDanger(a.deleteActionFailure(t.name,(null===(n=e.body)||void 0===n?void 0:n.message)||e.message))},onSuccess:e=>{r.addSuccess(a.deleteActionSuccess(e.name))}});return Object(n.useMemo)((()=>({...i,deleteArtifactItem:i.mutateAsync})),[i])})(e,t,l),p=Object(n.useCallback)((()=>{u(t).then((()=>o()))}),[u,t,o]),m=Object(n.useCallback)((()=>{d||a()}),[d,a]);return r.a.createElement(i.EuiModal,{onClose:m,"data-test-subj":s},r.a.createElement(i.EuiModalHeader,{"data-test-subj":c("header")},r.a.createElement(i.EuiModalHeaderTitle,null,l.deleteModalTitle(t.name))),r.a.createElement(i.EuiModalBody,{"data-test-subj":c("body")},r.a.createElement(i.EuiText,null,r.a.createElement(i.EuiCallOut,{"data-test-subj":c("impactCallout"),title:l.deleteModalImpactTitle,color:"danger",iconType:"warning"},r.a.createElement("p",{"data-test-subj":c("impactCalloutInfo")},l.deleteModalImpactInfo(t))),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement("p",null,l.deleteModalConfirmInfo))),r.a.createElement(i.EuiModalFooter,null,r.a.createElement(i.EuiButtonEmpty,{onClick:m,isDisabled:d,"data-test-subj":c("cancelButton")},l.deleteModalCancelButtonTitle),r.a.createElement(g,{fill:!0,color:"danger",onClick:p,isLoading:d,isDisabled:d,"data-test-subj":c("submitButton")},l.deleteModalSubmitButtonTitle)))}));k.displayName="ArtifactDeleteModal";const w=Object.freeze({pageTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.pageTitle",{defaultMessage:"Artifact"}),pageAboutInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.aboutInfo",{defaultMessage:"A list of artifacts for endpoint"}),pageAddButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.addButtonTitle",{defaultMessage:"Add artifact"}),emptyStateTitleNoEntries:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitleNoEntries",{defaultMessage:"There are no entries to display."}),emptyStateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitle",{defaultMessage:"Add your first artifact"}),emptyStateInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateInfo",{defaultMessage:"Add an artifact"}),emptyStatePrimaryButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStatePrimaryButtonLabel",{defaultMessage:"Add"}),searchPlaceholderInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"}),getShowingCountLabel:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.showingTotal",{defaultMessage:"Showing {total, plural, one {# artifact} other {# artifacts}}",values:{total:e}}),cardActionEditLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionEditLabel",{defaultMessage:"Edit artifact"}),cardActionDeleteLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),...p.a,...x,...E});var S=a(587),j=a(1204),O=a(543),I=a(237),C=a(41),T=a.n(C),M=a(517);const _=T()(i.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1flznkw-0"})(["",""],(()=>Object(C.css)(["max-width:100%;"]))),N=Object(n.memo)((({onAdd:e,isAddDisabled:t=!1,backComponent:a,"data-test-subj":n,titleLabel:o,titleNoEntriesLabel:s,aboutInfo:l,primaryButtonLabel:c,secondaryAboutInfo:u,canCreateItems:d=!0})=>{const p=Object(f.a)(n);return r.a.createElement(M.a,null,d?r.a.createElement(_,{"data-test-subj":n,iconType:"plusInCircle",title:r.a.createElement("h2",{"data-test-subj":p("title")},o),body:r.a.createElement("div",{"data-test-subj":p("aboutInfo")},l,u?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),u):void 0),actions:[r.a.createElement(i.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":p("addButton")},c),...a?[a]:[]]}):r.a.createElement(_,{"data-test-subj":n,iconType:"iInCircle",title:r.a.createElement("h2",{"data-test-subj":p("title-no-entries")},s)}))}));N.displayName="NoDataEmptyState";var D=a(845),A=a(783),F=a(47),q=a(182),L=a(297),R=a(1352),P=a(518);var z=a(245),B=a(42),$=a(482);const G=Object(n.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:a,...n})=>{const o=Object($.a)(...a);return r.a.createElement(i.EuiButtonEmpty,y()({},n,{"data-test-subj":"backToOrigin",size:"s",href:t,onClick:o,textProps:{className:"text"}}),e||r.a.createElement(B.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));G.displayName="BackToExternalAppSecondaryButton";var U=a(734);const V=Object(n.memo)((({apiClient:e,ArtifactFormComponent:t,searchableFields:a=z.c,labels:d={},secondaryPageInfo:m,onFormSubmit:y,flyoutSize:g,"data-test-subj":b,allowCardEditAction:E=!0,allowCardCreateAction:x=!0,allowCardDeleteAction:C=!0,CardDecorator:T})=>{var M,_;const{state:B}=Object(o.useLocation)(),$=Object(f.a)(b),V=Object(h.n)(),H=Object(s.a)(),W=Object(D.a)(E,x),Y=Object(A.a)(),{urlParams:{filter:Z,includedPolicies:K}}=Object(L.a)(),{isPageInitializing:Q,isFetching:X,data:J,uiPagination:ee,doesDataExist:te,error:ae,refetch:ne}=((e,t)=>{const a=Object(s.a)(),{urlParams:{filter:r,includedPolicies:i}}=Object(L.a)(),{pagination:{page:o,pageSize:l}}=Object(P.b)(),c=((e,t,a)=>Object(n.useMemo)((()=>Object(R.a)({kuery:Object(R.b)(e,t),policies:a?a.split(","):[]})),[t,e,a]))(r,t,i),{data:u,isFetching:d,refetch:p}=Object(F.useQuery)(["does-data-exists",e],(async()=>e.hasData()),{enabled:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),[m,y]=Object(n.useState)({totalItemCount:0,pageSize:l,pageSizeOptions:[...q.f],pageIndex:o-1}),[g,f]=Object(n.useState)(!0),b=Object(v.f)(e,{page:o,perPage:l,filter:r,policies:i?i.split(","):[]},t),{data:h,isFetching:E,error:x,isSuccess:k}=b;return Object(n.useEffect)((()=>{a()&&g&&!d&&f(!1)}),[d,a,g]),Object(n.useEffect)((()=>{a()&&h&&!E&&k&&y((e=>({...e,pageIndex:h.page-1,pageSize:h.per_page,totalItemCount:h.total})))}),[E,a,k,h]),Object(n.useEffect)((()=>{!a()||E||d||x||"1"!==String(o)||c||!(h&&0===h.total&&u||h&&h.total>0&&!u)||p()}),[p,u,r,i,d,E,a,c,h,x,o]),Object(n.useMemo)((()=>({isPageInitializing:g,doesDataExist:null!=u&&u,uiPagination:m,...b})),[u,g,b,m])})(e,a);Object(n.useEffect)((()=>{var e;!X&&ae&&V.addDanger((null==ae||null===(e=ae.body)||void 0===e?void 0:e.message)||ae.message)}),[ae,V,X]);const re=Object(n.useMemo)((()=>{var e;return null!==(e=null==J?void 0:J.data)&&void 0!==e?e:[]}),[null==J?void 0:J.data]),[ie,oe]=Object(n.useState)(void 0),[se,le]=Object(n.useState)(void 0),ce=Object(n.useMemo)((()=>({...w,...d})),[d]),ue=(({items:e,onAction:t,cardActionDeleteLabel:a,cardActionEditLabel:r,dataTestSubj:i,allowCardDeleteAction:o=!0,allowCardEditAction:s=!0})=>{const l=Object(f.a)(i),c=Object(h.n)(),{data:d}=Object(O.c)({onError:e=>{c.addDanger(Object(I.d)(e))}}),p=Object(u.f)(null==d?void 0:d.items),m=Object(n.useMemo)((()=>{const n={};for(const c of e){const e=[];s&&e.push({icon:"controlsHorizontal",onClick:()=>{t({type:"edit",item:c})},"data-test-subj":l("cardEditAction"),children:r}),o&&e.push({icon:"trash",onClick:()=>{t({type:"delete",item:c})},"data-test-subj":l("cardDeleteAction"),children:a}),n[c.id]={item:c,policies:p,"data-test-subj":i,actions:e.length>0?e:void 0,hideDescription:!c.description,hideComments:!c.comments.length}}return n}),[e,s,o,p,i,l,r,t,a]);return Object(n.useCallback)((e=>m[e.id]),[m])})({items:re,onAction:Object(n.useCallback)((({type:e,item:t})=>{switch(e){case"edit":le(t),Y({show:"edit",itemId:t.item_id});break;case"delete":oe(t)}}),[Y]),cardActionDeleteLabel:ce.cardActionDeleteLabel,cardActionEditLabel:ce.cardActionEditLabel,dataTestSubj:$("card"),allowCardDeleteAction:C,allowCardEditAction:E}),de=Object(O.c)({perPage:1e3,onError:e=>{V.addWarning(Object(I.d)(e))}}),pe=function(e){const[t,a]=Object(n.useState)();return Object(n.useEffect)((()=>{e&&e.onBackButtonNavigateTo&&a(e)}),[e]),t}(B),me=Object(n.useMemo)((()=>{if(pe&&pe.onBackButtonNavigateTo)return r.a.createElement(G,pe)}),[pe]),ye=Object(n.useMemo)((()=>{if(pe&&pe.onBackButtonNavigateTo)return r.a.createElement(U.a,pe)}),[pe]),ge=Object(n.useCallback)((()=>{Y({show:"create"})}),[Y]),fe=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{Y({page:e+1,pageSize:t}),window.scrollTo({top:0,left:0,behavior:"smooth"})}),[Y]),be=Object(n.useCallback)(((e,t,a)=>{const n=e!==(null!=Z?Z:"")||t!==(null!=K?K:"");Y({filter:""===e.trim()?void 0:e,includedPolicies:""===t.trim()?void 0:t}),a&&!n&&ne()}),[Z,K,ne,Y]),he=Object(n.useCallback)((()=>{H()&&(oe(void 0),ne())}),[H,ne]),ve=Object(n.useCallback)((()=>{oe(void 0)}),[]),Ee=Object(n.useCallback)((()=>{le(void 0),ne()}),[ne]),xe=Object(n.useCallback)((()=>{le(void 0)}),[]),ke=Object(n.useMemo)((()=>{const e=ce.pageAboutInfo?r.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},ce.pageAboutInfo):void 0,t=m?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),m):void 0;return r.a.createElement(r.a.Fragment,null,e,t)}),[ce.pageAboutInfo,m]);return Q?r.a.createElement(S.a,{"data-test-subj":$("pageLoader")}):r.a.createElement(l.a,{headerBackComponent:ye,hideHeader:!te,title:ce.pageTitle,subtitle:ke,actions:x&&r.a.createElement(i.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:W,onClick:ge,"data-test-subj":$("pageAddButton")},ce.pageAddButtonTitle),"data-test-subj":$("container")},W&&r.a.createElement(p.b,{apiClient:e,item:se,onSuccess:Ee,onClose:xe,FormComponent:t,labels:ce,size:g,submitHandler:y,policies:(null===(M=de.data)||void 0===M?void 0:M.items)||[],policiesIsLoading:de.isLoading,"data-test-subj":$("flyout")}),ie&&r.a.createElement(k,{apiClient:e,item:ie,labels:ce,"data-test-subj":$("deleteModal"),onSuccess:he,onCancel:ve}),te?r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{defaultValue:Z,onSearch:be,placeholder:ce.searchPlaceholderInfo,hasPolicyFilter:!0,policyList:null===(_=de.data)||void 0===_?void 0:_.items,defaultIncludedPolicies:K}),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiText,{color:"subdued",size:"xs","data-test-subj":$("showCount")},ce.getShowingCountLabel(ee.totalItemCount)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{items:re,ItemComponent:u.a,itemComponentProps:ue,onChange:fe,error:ae,loading:X,pagination:ee,contentClassName:"card-container","data-test-subj":$("list"),CardDecorator:T})):r.a.createElement(N,{onAdd:ge,titleNoEntriesLabel:ce.emptyStateTitleNoEntries,titleLabel:ce.emptyStateTitle,aboutInfo:ce.emptyStateInfo,primaryButtonLabel:ce.emptyStatePrimaryButtonLabel,backComponent:me,"data-test-subj":$("emptyState"),secondaryAboutInfo:m,canCreateItems:x}))}));V.displayName="ArtifactListPage"},962:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(42),l=a(19),c=a(3),u=a(843),d=a(487),p=a(881),m=a(50),y=a(603);const g=e=>{var t,a,n,r,i,o,s;return null!=e&&null!==(t=e.agent)&&void 0!==t&&null!==(a=t.type)&&void 0!==a&&a.includes("endpoint")?((null==e||null===(n=e.host)||void 0===n||null===(r=n.os)||void 0===r?void 0:r.name)||["windows"]).map((e=>e.toLowerCase())):null!==(i=null==e||null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family)&&void 0!==i?i:["windows"]},f=e=>{var t,a;return{comments:[],description:"",entries:e&&e.event&&e.process?[{field:"event.category",operator:"included",type:"match",value:(null!==(t=e.event.category)&&void 0!==t?t:[])[0]},{field:"process.executable",operator:"included",type:"match",value:(null!==(a=e.process.executable)&&void 0!==a?a:[])[0]}]:[{field:"",operator:"included",type:"match",value:""}],item_id:void 0,list_id:y.a,meta:{temporaryUuid:Object(m.v4)()},name:"",namespace_type:"agnostic",tags:["policy:all"],type:"simple",os_types:g(e)}};var b=a(118),h=a(543),v=a(237),E=a(602),x=a(4);const k=Object(i.memo)((({onCancel:e,data:t,...a})=>{var n,m;const y=Object(b.n)(),g=Object(b.i)(),{isLoading:k,mutateAsync:w}=Object(u.a)(E.a.getInstance(g),"create"),[S,j]=Object(i.useState)(),[O,I]=Object(i.useState)(!1),{data:{search:C}}=Object(b.j)().services,T=Object(h.c)({perPage:1e3,onError:e=>{y.addWarning(Object(v.d)(e))}}),[M,_]=Object(i.useState)(f(t)),[N,D]=Object(i.useState)(),[A,F]=Object(i.useState)(!1),q=Object(i.useMemo)((()=>T.isLoading||T.isRefetching),[T]);Object(i.useEffect)((()=>(t&&(async()=>{var e;if(!t||!t._index)return;const a=await Object(c.lastValueFrom)(C.search({params:{index:t._index,body:{query:{match:{_id:t._id}}}}}));j({...t,host:{...t.host,os:{...(null==t||null===(e=t.host)||void 0===e?void 0:e.os)||{},name:[a.rawResponse.hits.hits[0]._source.host.os.name]}}})})(),()=>{_(f())})),[]);const L=Object(i.useCallback)((()=>{q||k||e()}),[k,q,e]),R=Object(i.useCallback)((()=>w(M,{onSuccess:t=>{var a;y.addSuccess((a=t,x.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.creationSuccessToastTitle",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:null==a?void 0:a.name}}))),e()},onError:e=>{y.addError(e,{title:'There was an error creating the new event filter: "{error}"',message:{error:e.message}})}})),[M,e,w,y]),P=Object(i.useCallback)((()=>{if(!N)return R();F(!0)}),[N,R]),z=Object(i.useMemo)((()=>o.a.createElement(l.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:!O||k||!!t&&!S||q,onClick:P,isLoading:q},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.update.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.create",defaultMessage:"Add event filter"}))),[t,S,P,O,k,q]),B=Object(i.useCallback)((e=>{e&&(I(e.isValid),_(e.item),D(e.confirmModalLabels))}),[]),$=Object(l.useGeneratedHtmlId)({prefix:"eventFiltersCreateFlyoutTitle"}),G=Object(i.useMemo)((()=>{if(N){const{title:e,body:t,confirmButton:a,cancelButton:n}=N;return o.a.createElement(d.a,{title:e,body:t,confirmButton:a,cancelButton:n,onSuccess:R,onCancel:()=>F(!1),"data-test-subj":"artifactConfirmModal"})}}),[N,R]);return o.a.createElement(l.EuiFlyout,r()({size:"l",onClose:L,"data-test-subj":"eventFiltersCreateFlyout","aria-labelledby":$},a),o.a.createElement(l.EuiFlyoutHeader,{hasBorder:!0},o.a.createElement(l.EuiTitle,{size:"m"},o.a.createElement("h2",{id:$},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.title.create.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create",defaultMessage:"Add event filter"}))),t?o.a.createElement(l.EuiTextColor,{color:"subdued"},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create.withData",defaultMessage:"Endpoint security"})):null),o.a.createElement(l.EuiFlyoutBody,null,o.a.createElement(p.a,{allowSelectOs:!t,error:void 0,disabled:!1,item:M,mode:"create",onChange:B,policies:null!==(n=null==T||null===(m=T.data)||void 0===m?void 0:m.items)&&void 0!==n?n:[],policiesIsLoading:q})),o.a.createElement(l.EuiFlyoutFooter,null,o.a.createElement(l.EuiFlexGroup,{justifyContent:"spaceBetween"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiButtonEmpty,{isDisabled:k,"data-test-subj":"cancelExceptionAddButton",onClick:L},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.cancel",defaultMessage:"Cancel"}))),o.a.createElement(l.EuiFlexItem,{grow:!1},z))),A&&G)}));k.displayName="EventFiltersFlyout"},964:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(56),r=a(2),i=a(123),o=a(333),s=a(5),l=a(118);const c=()=>{const{http:e}=Object(n.useKibana)().services,{addSuccess:t,addError:a}=Object(i.a)(),c=Object(r.useRef)(null),u=Object(r.useCallback)(((e=0)=>t(o.w(e))),[t]),d=Object(r.useCallback)((e=>{a(e.message,{title:o.v})}),[a]);return Object(r.useEffect)((()=>{let e=!1;const t=new AbortController;return c.current=async(a,n,r,i)=>{try{i(!0);const o=await(async({assignees:e,ids:t,signal:a})=>l.b.get().http.fetch(s.ib,{method:"POST",version:"2023-10-31",body:JSON.stringify({assignees:e,ids:t}),signal:a}))({assignees:a,ids:n,signal:t.signal});e||(r(),i(!1),u(o.updated))}catch(t){e||(i(!1),d(t))}},()=>{e=!0,t.abort()}}),[e,d,u]),c.current}},966:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a.n(n),i=a(19),o=a(1293),s=a(483);const l="securitySolutionUsers",c=`${l}AvatarsPanel`,u=`${l}AvatarsCountBadge`,d=Object(n.memo)((({userProfiles:e,maxVisibleAvatars:t})=>t&&e.length>t?r.a.createElement(i.EuiToolTip,{position:"top",content:e.map((e=>{var t;return r.a.createElement("div",null,e?null!==(t=e.user.email)&&void 0!==t?t:e.user.username:s.b)})),repositionOnScroll:!0},r.a.createElement(i.EuiNotificationBadge,{"data-test-subj":u,color:"subdued"},e.length)):r.a.createElement(i.EuiFlexGroup,{"data-test-subj":c,alignItems:"center",direction:"row",gutterSize:"xs"},e.map(((e,t)=>{var a,n;return r.a.createElement(i.EuiFlexItem,{key:t,grow:!1},r.a.createElement(o.a,{"data-test-subj":(n=null!==(a=null==e?void 0:e.user.username)&&void 0!==a?a:`Unknown-${t}`,`${l}Avatar-${n}`),user:null==e?void 0:e.user,avatar:null==e?void 0:e.data.avatar,size:"s"}))})))));d.displayName="UsersAvatarsPanel"},967:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(119),r=a.n(n),i=a(2),o=a.n(i),s=a(19),l=a(4),c=a(42),u=a(41),d=a.n(u),p=a(140),m=a(536),y=a(265),g=a(126),f=a(364),b=a(340);const h=()=>{},v={bordered:!0,showIcons:!1},E={className:"effected-policies-search"},x=d.a.div.withConfig({displayName:"StyledEuiSelectable",componentId:"sc-rb0j09-0"})([".effected-policies-search{border-bottom-left-radius:0;border-bottom-right-radius:0;}.euiSelectableList{border-top-left-radius:0;border-top-right-radius:0;border-top-width:0;}"]),k=d()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemButtonGroup",componentId:"sc-rb0j09-1"})(["@media only screen and (max-width:","){align-items:center;}"],(e=>e.theme.eui.euiBreakpoints.m)),w=d()(s.EuiButtonGroup).withConfig({displayName:"StyledButtonGroup",componentId:"sc-rb0j09-2"})(["display:flex;justify-content:right;.euiButtonGroupButton{padding-right:",";}"],(e=>e.theme.eui.euiSizeL)),S=d.a.div.withConfig({displayName:"EffectivePolicyFormContainer",componentId:"sc-rb0j09-3"})([".policy-name .euiSelectableListItem__text{text-decoration:none !important;color:"," !important;}"],(e=>e.theme.eui.euiTextColor)),j=Object(i.memo)((({isGlobal:e,isPlatinumPlus:t,description:a,isLoading:n=!1,onChange:u,listProps:d,options:j,selected:O=[],disabled:I=!1,"data-test-subj":C,...T})=>{const{getAppUrl:M}=Object(f.a)(),{canReadPolicyManagement:_}=Object(p.a)().endpointPrivileges,N=Object(g.a)(C),D=Object(i.useMemo)((()=>[{id:"globalPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.global",{defaultMessage:"Global"}),iconType:e?"checkInCircleFilled":"empty","data-test-subj":N("global")},{id:"perPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.perPolicy",{defaultMessage:"Per Policy"}),iconType:e?"empty":"checkInCircleFilled","data-test-subj":N("perPolicy")}]),[N,e]),A=Object(i.useMemo)((()=>{const a=new Set(O.map((e=>e.id)));return j.map((n=>({label:n.name,className:"policy-name",prepend:o.a.createElement(s.EuiCheckbox,{id:Object(s.htmlIdGenerator)()(),onChange:h,checked:a.has(n.id),disabled:e||!t||I,"data-test-subj":`policy-${n.id}-checkbox`}),append:_?o.a.createElement(m.a,{href:M({path:Object(y.j)(n.id)}),appPath:Object(y.j)(n.id),target:"_blank","data-test-subj":N("policyLink")},o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.viewPolicyLinkLabel",defaultMessage:"View policy"})):null,policy:n,checked:a.has(n.id)?"on":void 0,disabled:e||!t||I,"data-test-subj":`policy-${n.id}`}))).sort((({label:e},{label:t})=>e.localeCompare(t)))}),[_,I,M,N,e,t,j,O]),F=Object(i.useCallback)((t=>{u({isGlobal:e,selected:t.filter((e=>e.checked)).map((e=>e.policy))})}),[e,u]),q=Object(i.useCallback)((e=>{u({isGlobal:"globalPolicy"===e,selected:O})}),[u,O]),L=Object(i.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]);return o.a.createElement(S,null,o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.assignmentSectionTitle",defaultMessage:"Assignment"}))),o.a.createElement(s.EuiSpacer,{size:"xs"}),o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:2},o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,a||l.i18n.translate("xpack.securitySolution.effectedPolicySelect.assignmentSectionDescription",{defaultMessage:"Assign globally across all policies, or assign it to specific policies."})))),o.a.createElement(k,{grow:1},o.a.createElement(s.EuiFormRow,{fullWidth:!0,isDisabled:I},o.a.createElement(w,{legend:"Global Policy Toggle",options:D,idSelected:e?"globalPolicy":"perPolicy",onChange:q,color:"primary","data-test-subj":N("byPolicyGlobalButtonGroup"),isDisabled:I})))),o.a.createElement(s.EuiSpacer,null),!e&&(n?o.a.createElement(b.a,{size:"l","data-test-subj":N("policiesLoader")}):o.a.createElement(s.EuiFormRow,{fullWidth:!0},o.a.createElement(x,null,o.a.createElement(s.EuiSelectable,r()({},T,{options:A,listProps:d||v,onChange:F,searchProps:E,searchable:!0,"data-test-subj":N("policiesSelectable")}),L)))))}));j.displayName="EffectedPolicySelect"},969:function(e,t,a){"use strict";a.d(t,"b",(function(){return L})),a.d(t,"a",(function(){return R}));var n=a(2),r=a.n(n),i=a(19),o=a(7),s=a(45),l=a(1334),c=a(44),u=a(1630),d=a(379),p=a(355),m=a(131),y=a(930),g=a(118),f=a(571),b=a(343),h=a(140),v=a(180),E=a(546),x=a(172),k=a(148),w=a(381),S=a(380),j=a(532),O=a(962),I=a(667),C=a(933),T=a(928),M=a(936),_=a(432),N=a(929),D=a(973),A=a(931),F=a(932);const q=({ariaLabel:e=x.K,ariaRowindex:t,columnValues:a,disabled:l,ecsRowData:d,onRuleChange:b,scopeId:E,refetch:w})=>{var S,j,q,L,P,z,B,$,G,U,V,H,W,Y,Z,K,Q,X,J;const[ee,te]=Object(n.useState)(!1),[ae,ne]=Object(n.useState)(!1),re=Object(n.useCallback)((()=>{te(!1)}),[]),ie=Object(n.useMemo)((()=>k.d.globalQuery()),[]),oe=Object(n.useMemo)((()=>k.d.timelineQueryByIdSelector()),[]),se=Object(s.useSelector)((e=>ie(e))),le=Object(s.useSelector)((e=>oe(e,E))),ce=null!=d&&null!==(ue=d.kibana)&&void 0!==ue&&ue.alert?null==d?void 0:d._id:null;var ue;const de=Object(c.get)(0,null==d||null===(S=d.kibana)||void 0===S||null===(j=S.alert)||void 0===j||null===(q=j.rule)||void 0===q?void 0:q.uuid),pe=Object(c.get)(0,null==d||null===(L=d.kibana)||void 0===L||null===(P=L.alert)||void 0===P||null===(z=P.rule)||void 0===z?void 0:z.rule_id),me=Object(c.get)(0,null==d||null===(B=d.kibana)||void 0===B||null===($=B.alert)||void 0===$||null===(G=$.rule)||void 0===G?void 0:G.name),ye=[u.b.alertsOnAlertsPage,u.b.alertsOnRuleDetailsPage].includes(E),{addToCaseActionItems:ge}=Object(D.a)({ecsData:d,onMenuItemClick:re,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:""),ariaLabel:Object(_.a)({ariaRowindex:t,columnValues:a}),isInDetections:ye,refetch:w}),{loading:fe,canWriteEventFilters:be}=Object(h.a)().endpointPrivileges,he=Object(n.useMemo)((()=>!fe&&be),[be,fe]),ve=Object(c.get)(0,null==d||null===(U=d.kibana)||void 0===U||null===(V=U.alert)||void 0===V?void 0:V.workflow_status),Ee=Object(n.useMemo)((()=>{var e;return-1!==Object(o.indexOf)(null===(e=d.event)||void 0===e?void 0:e.kind,"event")}),[d]),xe=Object(n.useMemo)((()=>{var e,t;return null===(e=d.agent)||void 0===e||null===(t=e.type)||void 0===t?void 0:t.includes("endpoint")}),[d]),ke=Object(n.useMemo)((()=>Ee&&xe),[Ee,xe]),we=Object(n.useMemo)((()=>{const e=Object(c.getOr)([],"kibana.alert.original_event.module",d),t=Object(c.getOr)([],"kibana.alert.original_event.kind",d);return e.includes("endpoint")&&t.includes("alert")}),[d]),Se=Object(n.useMemo)((()=>E===u.b.hostsPageEvents||E===u.b.usersPageEvents),[E]),je=Object(n.useCallback)((()=>{te(!ee)}),[ee]),Oe=Object(n.useCallback)((()=>{te(!1)}),[]),Ie=Object(n.useMemo)((()=>r.a.createElement(i.EuiToolTip,{position:"top",content:x.K},r.a.createElement(i.EuiButtonIcon,{"aria-label":e,"data-test-subj":"timeline-context-menu-button",size:"s",iconType:"boxesHorizontal","data-popover-open":ee,onClick:je,isDisabled:l}))),[l,je,e,ee]),Ce=Object(n.useCallback)((()=>{const e=e=>{e.forEach((e=>e.refetch&&e.refetch()))};Object(m.isActiveTimeline)(null!=E?E:"")?e([le]):e(se),w&&w()}),[E,se,le,w]),Te=null!==(H=null===(W=d["kibana.alert.rule.parameters"])||void 0===W?void 0:W.index)&&void 0!==H?H:null==d||null===(Y=d.signal)||void 0===Y||null===(Z=Y.rule)||void 0===Z?void 0:Z.index,Me=null!==(K=null===(Q=d["kibana.alert.rule.parameters"])||void 0===Q?void 0:Q.data_view_id)&&void 0!==K?K:null==d||null===(X=d.signal)||void 0===X||null===(J=X.rule)||void 0===J?void 0:J.data_view_id,{exceptionFlyoutType:_e,openAddExceptionFlyout:Ne,onAddExceptionCancel:De,onAddExceptionConfirm:Ae,onAddExceptionTypeClick:Fe}=Object(C.a)({refetch:Ce,onRuleChange:b,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:"")}),{closeAddEventFilterModal:qe,isAddEventFilterModalOpen:Le,onAddEventFilterClick:Re}=Object(M.a)(),{actionItems:Pe}=Object(I.a)({alertStatus:ve,eventId:null==d?void 0:d._id,scopeId:E,refetch:Ce,closePopover:Oe}),ze=Object(n.useCallback)((e=>{Fe(e),Oe()}),[Oe,Fe]),Be=Object(n.useCallback)((()=>{Re(),Oe()}),[Oe,Re]),{exceptionActionItems:$e}=Object(T.a)({isEndpointAlert:we,onAddExceptionTypeClick:ze}),{eventFilterActionItems:Ge}=Object(N.a)({onAddEventFilterClick:Be,disabled:!ke||!Se,tooltipMessage:Se?void 0:x.f}),Ue=Object(n.useMemo)((()=>{var e;return Object(c.get)(0,null==d||null===(e=d.agent)||void 0===e?void 0:e.id)}),[d]),Ve=Object(n.useCallback)((()=>{ne((e=>!e)),te(!1)}),[]),{osqueryActionItems:He}=(({handleClick:e})=>{const t=Object(n.useMemo)((()=>Object(y.a)({handleClick:e})),[e]),a=Object(g.j)().services.application.capabilities.osquery;return{osqueryActionItems:null!=a&&a.writeLiveQueries||null!=a&&a.runSavedQueries?[t]:[]}})({handleClick:Ve}),{alertTagsItems:We,alertTagsPanels:Ye}=Object(A.a)({closePopover:Oe,ecsRowData:d,refetch:Ce}),{alertAssigneesItems:Ze,alertAssigneesPanels:Ke}=Object(F.a)({closePopover:Oe,ecsRowData:d,refetch:Ce}),Qe=Object(n.useMemo)((()=>!Ee&&de?[...ge,...Pe,...We,...Ze,...$e,...Ue?He:[]]:[...ge,...he?Ge:[],...Ue?He:[]]),[Ee,de,ge,Pe,$e,Ue,He,Ge,he,We,Ze]),Xe=Object(n.useMemo)((()=>[{id:0,items:Qe},...Ye,...Ke]),[Ye,Ke,Qe]),Je=Object(n.useMemo)((()=>r.a.createElement(f.a,{agentId:Ue,defaultValues:ce?{alertIds:[ce]}:void 0,onClose:Ve,ecsData:d})),[Ue,ce,d,Ve]);return r.a.createElement(r.a.Fragment,null,Qe.length>0&&r.a.createElement("div",{key:"actions-context-menu"},r.a.createElement(v.l,{textAlign:"center",width:p.b},r.a.createElement(i.EuiPopover,{id:"singlePanel",button:Ie,isOpen:ee,closePopover:Oe,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},r.a.createElement(i.EuiContextMenu,{size:"s",initialPanelId:0,panels:Xe,"data-test-subj":"actions-context-menu"})))),Ne&&de&&pe&&null!=me&&null!=(null==d?void 0:d._id)&&r.a.createElement(R,{ruleId:de,ruleRuleId:pe,ruleIndices:Te,ruleDataViewId:Me,ruleName:me,exceptionListType:_e,eventId:null==d?void 0:d._id,onCancel:De,onConfirm:Ae,alertStatus:ve}),Le&&null!=d&&r.a.createElement(O.a,{data:d,onCancel:qe}),ae&&Ue&&null!=d&&Je)},L=r.a.memo(q),R=({ruleId:e,ruleRuleId:t,ruleIndices:a,ruleDataViewId:i,ruleName:o,exceptionListType:s,eventId:c,onCancel:u,onConfirm:p,alertStatus:m})=>{var y;const{loading:g,signalIndexName:f}=Object(j.a)(),{rule:h,loading:v}=Object(d.a)(e),{loading:x,data:k}=Object(w.a)({query:Object(b.a)(c),indexName:f,queryName:S.a.ADD_EXCEPTION_FLYOUT}),O=Object(n.useMemo)((()=>{if(!1===x){const e=null==k?void 0:k.hits.hits[0];if(!e)return;const{_id:t,_index:a,_source:n}=e;return{...n,_id:t,_index:a}}}),[null==k?void 0:k.hits.hits,x]),I=Object(n.useMemo)((()=>{var e,t,n;return null!=O&&null!=(null===(e=O["kibana.alert.rule.parameters"])||void 0===e?void 0:e.index)?Array.isArray(O["kibana.alert.rule.parameters"].index)?O["kibana.alert.rule.parameters"].index:[O["kibana.alert.rule.parameters"].index]:null!=O&&null!=(null==O||null===(t=O.signal)||void 0===t||null===(n=t.rule)||void 0===n?void 0:n.index)?Array.isArray(O.signal.rule.index)?O.signal.rule.index:[O.signal.rule.index]:a}),[O,a]),C=Object(n.useMemo)((()=>{var e;return null!=O&&null!=(null===(e=O["kibana.alert.rule.parameters"])||void 0===e?void 0:e.data_view_id)?O["kibana.alert.rule.parameters"].data_view_id:i}),[O,i]),T=Object(n.useMemo)((()=>h?[h]:null),[h]),M=null==O||null===(y=O["kibana.alert.rule.parameters"])||void 0===y?void 0:y.type,_=x&&g||null==O||!("esql"===M||"machine_learning"===M)&&null==I&&null==C;return _||v?null:r.a.createElement(E.a,{rules:T,isEndpointItem:s===l.a.ENDPOINT,alertData:O,isAlertDataLoading:_||v,alertStatus:m,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:u,onConfirm:p})}},973:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a.n(n),i=a(65),o=a(36),s=a(170),l=a(305);const c=()=>document.querySelector('[tour-step="create-case-submit"]'),u=()=>{const[e,t]=Object(n.useState)(s.a.createCase),a=Object(n.useCallback)((()=>{var e;null===(e=c())||void 0===e||e.scrollIntoView()}),[]),i=Object(n.useCallback)((()=>{t(s.a.submitCase),a(),setTimeout((()=>{var e;null===(e=c())||void 0===e||e.focus()}),500)}),[a]);return r.a.createElement(r.a.Fragment,null,e===s.a.createCase&&r.a.createElement(l.a,{onClick:i,step:s.a.createCase,tourId:s.b.alertsCases}),e===s.a.submitCase&&r.a.createElement(l.a,{step:s.a.submitCase,tourId:s.b.alertsCases}))};var d=a(256),p=a(118),m=a(172);const y=({onMenuItemClick:e,ariaLabel:t,ecsData:a,nonEcsData:l,onSuccess:c,isActiveTimelines:y,isInDetections:g,refetch:f})=>{const{cases:b}=Object(p.j)().services,h=b.helpers.canUseCases([o.APP_ID]),v=Object(n.useMemo)((()=>{var e,t;return null==a||null===(e=a.event)||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.includes("signal")}),[a]),E=Object(n.useMemo)((()=>{var e,t;return null!=a&&a._id?[{alertId:null!==(e=null==a?void 0:a._id)&&void 0!==e?e:"",index:null!==(t=null==a?void 0:a._index)&&void 0!==t?t:"",type:i.AttachmentType.alert,rule:b.helpers.getRuleIdFromEvent({ecs:a,data:null!=l?l:[]})}]:[]}),[b.helpers,a,l]),{activeStep:x,incrementStep:k,setStep:w,isTourShown:S}=Object(d.b)(),j=Object(n.useCallback)((()=>{c&&c(),f&&f()}),[c,f]),O=Object(n.useCallback)((async()=>{S(s.b.alertsCases)&&w(s.b.alertsCases,s.a.viewCase)}),[w,S]),I=Object(n.useMemo)((()=>!S(s.b.alertsCases)||x!==s.a.addAlertToCase&&x!==s.a.createCase&&x!==s.a.submitCase?{}:{initialValue:s.f}),[x,S]),C=Object(n.useMemo)((()=>({onClose:e,onSuccess:j,afterCaseCreated:O,...I})),[e,j,O,I]),T=b.hooks.useCasesAddToNewCaseFlyout(C),M=Object(n.useMemo)((()=>({onClose:e,onSuccess:j})),[e,j]),_=b.hooks.useCasesAddToExistingCaseModal(M),N=Object(n.useCallback)((()=>{e(),T.open({attachments:E,...S(s.b.alertsCases)?{headerContent:r.a.createElement(u,null)}:{}}),S(s.b.alertsCases)&&x===s.a.addAlertToCase&&k(s.b.alertsCases)}),[e,T,E,S,x,k]),D=Object(n.useCallback)((()=>{e(),_.open({getAttachments:()=>E})}),[E,e,_]);return{addToCaseActionItems:Object(n.useMemo)((()=>(y||g)&&h.create&&h.read&&v?[{"aria-label":t,"data-test-subj":"add-to-existing-case-action",key:"add-to-existing-case-action",onClick:D,size:"s",name:m.k},{"aria-label":t,"data-test-subj":"add-to-new-case-action",key:"add-to-new-case-action",onClick:N,size:"s",name:m.l}]:[]),[t,D,N,h.create,h.read,g,y,v]),handleAddToNewCaseClick:N,handleAddToExistingCaseClick:D}}}}]);