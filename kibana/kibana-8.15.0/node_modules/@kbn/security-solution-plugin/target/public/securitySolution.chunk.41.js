/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[41],{1197:function(e,t,a){"use strict";a.d(t,"a",(function(){return BlocklistsApiClient}));var n=a(168),i=a(1254),s=a(784),o=a(1317);function l(e){return{...e,entries:Object(i.b)(e.entries)}}function r(e){return{...e,entries:Object(i.a)(e.entries)}}class BlocklistsApiClient extends s.a{constructor(e){super(e,n.c,o.a,l,r)}static getInstance(e){return super.getInstance(e,n.c,o.a,l,r)}}},122:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(45),i=a(14);const s=Object(i.b)(),o=e=>{const t=l();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${s.join(", ")}`);return t[e]},l=()=>Object(n.useSelector)((({app:{enableExperimental:e}})=>e))},1236:function(e,t,a){"use strict";a.d(t,"a",(function(){return TrustedAppsApiClient}));var n=a(168),i=a(1254),s=a(784),o=a(1237);function l(e){return{...e,entries:Object(i.b)(e.entries)}}function r(e){return{...e,entries:Object(i.a)(e.entries,!0)}}class TrustedAppsApiClient extends s.a{constructor(e){super(e,n.n,o.b,l,r)}static getInstance(e){return super.getInstance(e,n.n,o.b,l,r)}}},1237:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(1334),i=a(168);const s=["name","description","item_id","entries.value","entries.entries.value"],o={name:i.o,namespace_type:"agnostic",description:i.m,list_id:i.n,type:n.a.ENDPOINT_TRUSTED_APPS}},1238:function(e,t,a){"use strict";a.d(t,"a",(function(){return HostIsolationExceptionsApiClient}));var n=a(168),i=a(784),s=a(948);class HostIsolationExceptionsApiClient extends i.a{constructor(e){super(e,n.i,s.a)}static getInstance(e){return super.getInstance(e,n.i,s.a)}}},1254:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return u}));var n=a(1870);const i="included",s=e=>{switch(e.length){case 32:return"md5";case 40:return"sha1";case 64:return"sha256"}},o=(e,t)=>({field:e,value:t,type:"match",operator:i}),l=(e,t)=>({field:e,value:t,type:"match_any",operator:i});const r=(e,t=!1)=>{const a=[];return e.forEach((e=>{if(e.field.includes(n.b.HASH))(function(e,t){const a=[];if(!Array.isArray(t.value)){const i=o(`${e}${n.b.HASH}${s(t.value)}`,t.value.toLowerCase());return a.push(i),a}const i=t.value.reduce(((e,t)=>{const a=s(t);return a?{...e,[a]:[...e[a],t]}:e}),{md5:[],sha1:[],sha256:[]});return Object.entries(i).forEach((([t,i])=>{if(!i.length)return;const s=l(`${e}${n.b.HASH}${t}`,i.map((e=>e.toLowerCase())));a.push(s)})),a})(e.field.split(".")[0],e).forEach((e=>a.push(e)));else if(e.field.includes(n.b.SIGNER)){const n=function(e,t,a=!1){const n=Array.isArray(t)?l("subject_name",t):o("subject_name",t),i=[];return a&&i.push(o("trusted","true")),i.push(n),((e,t)=>({field:e,entries:t,type:"nested"}))(e,i)}(e.field,e.value,t);a.push(n)}else if((e.field.includes(n.b.EXECUTABLE)||e.field.includes(n.b.PATH))&&"wildcard"===e.type){const t=function(e,t){return Array.isArray(t)?l(e,t):((e,t)=>({field:e,value:t,type:"wildcard",operator:i}))(e,t)}(e.field,e.value);a.push(t)}else{const t=(r=e.field,c=e.value,Array.isArray(c)?l(r,c):o(r,c));a.push(t)}var r,c})),a},c=(e,t,a)=>({field:e,value:a,type:t,operator:i});function d(e){return`${e.split(".")[0]}${n.b.HASH}*`}const u=e=>{const t=(e=>e.reduce(((e,t)=>{const a=t.field;if(a.includes(n.b.HASH)&&"match"===t.type){const n=d(a);return{...e,[n]:c(n,t.type,t.value)}}if(a.includes(n.b.HASH)&&"match_any"===t.type){var i,s;const n=d(a),o=null!==(i=null===(s=e[n])||void 0===s?void 0:s.value)&&void 0!==i?i:[];return{...e,[n]:c(n,t.type,[...o,...t.value])}}if((a.includes(n.b.EXECUTABLE)||a.includes(n.b.PATH))&&("match"===t.type||"match_any"===t.type||"wildcard"===t.type))return{...e,[a]:c(a,t.type,t.value)};if(a.includes(n.b.SIGNER)&&"nested"===t.type){const n=t.entries.find((e=>"subject_name"===e.field&&("match"===e.type||"match_any"===e.type)));if(n)return{...e,[a]:c(a,n.type,n.value)}}return e}),{}))(e);return Object.values(t).reduce(((e,t)=>t?[...e,t]:e),[])}},126:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);const i=e=>Object(n.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},130:function(e,t,a){"use strict";a.d(t,"e",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return f})),a.d(t,"f",(function(){return y}));var n=a(44),i=a(2),s=a.n(i),o=a(41),l=a.n(o);const r=a(4).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),c=l.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorDarkShade));c.displayName="EmptyWrapper";const d=()=>"â€”",u=()=>`(${r})`,p=()=>s.a.createElement(c,null,d()),m=()=>s.a.createElement(c,null,u()),f=e=>null==e?p():Object(n.isString)(e)&&""===e?m():s.a.createElement(s.a.Fragment,null,e),y=e=>null==e?p():""===e?m():s.a.createElement(s.a.Fragment,null,e)},1317:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(1334),i=a(168);const s=n.a.ENDPOINT_BLOCKLISTS,o={name:i.d,namespace_type:"agnostic",description:i.b,list_id:i.c,type:s},l=["name","description","item_id","entries.value","entries.entries.value","comments.comment"]},1342:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var n=a(50);const i=e=>null!=e.id?e:{...e,id:Object(n.v4)()},s=e=>{const t=e;if(null!=t.id){const{id:e,...a}=t;return a}return e}},1356:function(e,t,a){"use strict";var n=a(1197);a.d(t,"a",(function(){return n.a}))},140:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(739);const s=()=>Object(n.useContext)(i.a)},1585:function(e,t,a){"use strict";var n=a(1236);a.d(t,"a",(function(){return n.a}))},1589:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(140);const s=()=>{const{canReadBlocklist:e,canReadEventFilters:t,canReadTrustedApplications:a,canReadHostIsolationExceptions:s}=Object(i.a)().endpointPrivileges;return Object(n.useMemo)((()=>e||t||a||s),[e,t,a,s])}},1590:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),i=a.n(n),s=a(19),o=a(41),l=a.n(o),r=a(4);const c=["windows","macos","linux","total"],d={windows:r.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.windows",{defaultMessage:"Windows"}),linux:r.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.linux",{defaultMessage:"Linux"}),macos:r.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.macos",{defaultMessage:"Mac"}),total:r.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.total",{defaultMessage:"Total"})},u=l()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-y73df1-0"})(["font-size:",";font-weight:",";"],(({isSmall:e,theme:t})=>e?t.eui.euiFontSizeXS:"inherit"),(({isSmall:e})=>e?"1px":"inherit")),p={fontWeight:"bold"},m=Object(n.memo)((({stats:e,isSmall:t=!1})=>{const a=Object(n.useCallback)((a=>{var n;return"total"!==a&&t?null:i.a.createElement(s.EuiFlexItem,{key:a},i.a.createElement(f,{value:null!==(n=null==e?void 0:e[a])&&void 0!==n?n:0,color:"total"!==a||t?"default":"primary",key:a,isSmall:t},d[a]))}),[e,t]);return i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:t?"flexStart":"spaceAround",gutterSize:t?"s":"l"},c.map((e=>a(e))))}));m.displayName="ExceptionItemsSummary";const f=Object(n.memo)((({children:e,value:t,color:a,isSmall:n=!1,...o})=>i.a.createElement(s.EuiText,{className:"eui-displayInlineBlock",size:n?"xs":"s"},i.a.createElement(u,{justifyContent:n?"flexStart":"center",direction:n?"rowReverse":"row",alignItems:"center",gutterSize:n?"xs":"l",isSmall:n},n?null:i.a.createElement(s.EuiFlexItem,{grow:!1,style:"primary"===a?p:void 0},e),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiBadge,{color:a},t))))));f.displayName="SummaryState"},1591:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(41),i=a.n(n),s=a(2),o=a.n(s),l=a(19),r=a(536);const c=i.a.span.withConfig({displayName:"LinkLabel",componentId:"sc-p54il1-0"})(["display:inline-block;padding-right:",";font-size:",";"],(e=>e.theme.eui.euiSizeS),(({size:e,theme:t})=>"m"===e?t.eui.euiFontSizeXS:"innherit")),d=Object(s.memo)((({children:e,size:t="l",...a})=>o.a.createElement(r.a,a,o.a.createElement(c,{size:t},e),o.a.createElement(l.EuiIcon,{type:"m"===t?"arrowRight":"popout"}))));d.displayName="LinkWithIcon"},1592:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return r}));var n=a(41),i=a.n(n),s=a(19);const o=i()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-1i8l9we-0"})(["display:grid;grid-template-columns:33% 45% 22%;grid-template-areas:'title summary link';"]),l=i()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexGridItem",componentId:"sc-1i8l9we-1"})(["grid-area:",";align-items:",";margin:0px;padding:12px;"],(({gridarea:e})=>e),(({alignitems:e})=>null!=e?e:"center")),r=i()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1i8l9we-2"})(["flex-direction:row-reverse;"])},1605:function(e,t,a){"use strict";a.d(t,"a",(function(){return Ae}));var n=a(119),i=a.n(n),s=a(2),o=a.n(s),l=a(19),r=a(4),c=a(203);const d=e=>e.windows.malware.mode===c.g.prevent;var u=a(525),p=a(1870),m=a(7),f=a(126),y=a(42),v=a(41),g=a.n(v),b=a(237);const _={type:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailType",{defaultMessage:"Type"}),os:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailOS",{defaultMessage:"Operating system"})},h=Object(s.memo)((({children:e,"data-test-subj":t})=>o.a.createElement(l.EuiTitle,{size:"xxs","data-test-subj":t},o.a.createElement("h5",null,e))));h.displayName="SettingCardHeader";const w=Object(s.memo)((({type:e,supportedOss:t,osRestriction:a,dataTestSubj:n,rightCorner:i,children:r,selected:c=!0,mode:d="edit"})=>{const u=Object(s.useContext)(v.ThemeContext).eui.euiPanelPaddingModifiers.paddingMedium,p=Object(f.a)(n);return o.a.createElement(l.EuiPanel,{"data-test-subj":p(),hasBorder:!0,hasShadow:!1,paddingSize:"none"},o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center",style:{padding:`${u} ${u} 0 ${u}`}},o.a.createElement(l.EuiFlexItem,{grow:1},o.a.createElement(h,null,_.type),o.a.createElement(l.EuiText,{size:"s","data-test-subj":p("type")},e)),o.a.createElement(l.EuiFlexItem,{grow:2},o.a.createElement(h,null,_.os),o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center","data-test-subj":p("osValueContainer")},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiText,{size:"s","data-test-subj":p("osValues")},t.map((e=>b.c[e])).join(", ")," ")),a&&o.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":p("osRestriction")},o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"xs"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiTextColor,{color:"subdued"},o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.antivirusRegistration.osRestriction",defaultMessage:"Restrictions"}))),o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiIconTip,{type:"warning",color:"warning",content:a,anchorProps:{"data-test-subj":p("osRestrictionTooltipIcon")}})))))),o.a.createElement(l.EuiShowFor,{sizes:["m","l","xl"]},o.a.createElement(l.EuiFlexItem,{grow:3},o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"none",justifyContent:"flexEnd"},o.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":p("rightCornerContainer")},i)))),o.a.createElement(l.EuiShowFor,{sizes:i?["s","xs"]:[]},o.a.createElement(l.EuiFlexItem,{"data-test-subj":p("rightCornerContainer")},i))),"edit"===d||c?o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiHorizontalRule,{margin:"m"}),o.a.createElement("div",{style:{padding:`0 ${u} ${u} ${u}`}},r)):o.a.createElement(l.EuiSpacer,{size:"m"}))}));w.displayName="SettingCard";const k=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.type",{defaultMessage:"Register as antivirus"}),x=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.explanation",{defaultMessage:"Enable to register Elastic as an official Antivirus solution for Windows OS. This will also disable Windows Defender."}),E=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.syncWithMalwarePrevent.enabled",{defaultMessage:"enabled"}),S=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.syncWithMalwarePrevent.disabled",{defaultMessage:"disabled"}),M=Object(s.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(f.a)(n),y=!Object(u.a)(),v="edit"===a,g=e.windows.antivirus_registration.mode,b=Object(s.useMemo)((()=>({[c.a.disabled]:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.disabled",{defaultMessage:"Disabled"}),[c.a.enabled]:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.enabled",{defaultMessage:"Enabled"}),[c.a.sync]:o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"s"},r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.syncWithMalwarePrevent",{defaultMessage:"Sync with malware protection level"})," ",o.a.createElement(l.EuiIconTip,{position:"right",content:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.syncWithMalwarePrevent.tooltip",{defaultMessage:"Use this setting to automatically enable antivirus registration if malware protection is set to Prevent. In any other case, antivirus registration will be disabled."})})),o.a.createElement(l.EuiText,{color:v?"subdued":void 0,size:"xs"},r.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.syncWithMalwarePrevent.currentOutcome",{defaultMessage:"(Current level: {currentOutcome})",values:{currentOutcome:d(e)?E:S}})))})),[v,e]),_=a=>{const n=Object(m.cloneDeep)(e);n.windows.antivirus_registration.mode=a.target.value,t({isValid:!0,updatedPolicy:n})};return y?o.a.createElement(w,{type:k,supportedOss:[p.c.WINDOWS],dataTestSubj:i(),osRestriction:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.av.windowsServerNotSupported",{defaultMessage:"Windows Server operating systems unsupported because Antivirus registration requires Windows Security Center, which is not included in Windows Server operating systems."})},v&&o.a.createElement(l.EuiText,{size:"s"},x),o.a.createElement(l.EuiSpacer,{size:"s"}),o.a.createElement(l.EuiFlexGroup,{"data-test-subj":i("radioButtons")},Object.values(c.a).map((e=>o.a.createElement(l.EuiFlexItem,{key:e},o.a.createElement(l.EuiRadio,{name:"antivirus-registration",id:e,value:e,onChange:_,label:b[e],checked:g===e,disabled:!v,"data-test-subj":i(e)})))))):null}));M.displayName="AntivirusRegistrationCard";var C=a(130);const j={[p.c.WINDOWS]:c.f.windows,[p.c.LINUX]:c.f.linux,[p.c.MAC]:c.f.mac},D=Object(s.memo)((({policy:e,onChange:t,mode:a,os:n,options:i,selection:c,supplementalOptions:d,"data-test-subj":u})=>{const p=Object(f.a)(u),m="edit"===a,y=Object(s.useContext)(v.ThemeContext),g=i.length,b=j[n],_=Object(s.useMemo)((()=>{const e=d?d.map((e=>e.protectionField)):[];return Object.entries(c).filter((([t,a])=>!e.includes(t)&&a)).length}),[c,d]);return o.a.createElement(w,{type:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollection",{defaultMessage:"Event collection"}),supportedOss:[n],mode:a,selected:_>0,rightCorner:o.a.createElement(l.EuiText,{size:"s",color:"subdued","data-test-subj":p("selectedCount")},r.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollectionsEnabled",{defaultMessage:"{selected} / {total} event collections enabled",values:{selected:_,total:g}})),dataTestSubj:p()},o.a.createElement(h,null,r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.eventingEvents",{defaultMessage:"Events"})),o.a.createElement(l.EuiSpacer,{size:"s"}),o.a.createElement("div",{"data-test-subj":p("options")},i.map((({name:a,protectionField:n})=>{const i=`${b}.events.${String(n)}`;return o.a.createElement(O,{label:a,key:i,keyPath:i,policy:e,onChange:t,disabled:!m,"data-test-subj":p(n)})})),0===_&&!m&&o.a.createElement("div",null,Object(C.e)())),d&&d.map((({title:a,description:n,name:i,protectionField:s,tooltipText:r,beta:c,indented:d,isDisabled:u})=>{const f=`${b}.events.${String(s)}`,v=s,g=!m||!!u&&u(e);return o.a.createElement("div",{key:String(s),style:d?{paddingLeft:y.eui.euiSizeL}:{},"data-test-subj":p(`${v}Container`)},a&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(h,{"data-test-subj":p(`${v}Title`)},a)),n&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"s"}),o.a.createElement(l.EuiText,{size:"xs",color:"subdued","data-test-subj":p(`${v}Description`)},n)),o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiSpacer,{size:"s"}),o.a.createElement(O,{label:i,key:f,keyPath:f,policy:e,onChange:t,disabled:g,"data-test-subj":p(v)})),r&&o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiIconTip,{position:"right",content:r,anchorProps:{"data-test-subj":p(`${v}TooltipIcon`)}})),c&&o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiBetaBadge,{label:"beta",size:"s","data-test-subj":p(`${v}Badge`)}))))})))}));D.displayName="EventCollectionCard";const O=Object(s.memo)((({policy:e,onChange:t,label:a,keyPath:n,disabled:i,"data-test-subj":r})=>{const c=Object(m.get)(e,n),d=Object(s.useCallback)((a=>{const i=Object(m.cloneDeep)(e);Object(m.set)(i,n,a.target.checked),t({isValid:!0,updatedPolicy:i})}),[n,t,e]);return o.a.createElement(l.EuiCheckbox,{key:n,id:n,label:a,"data-test-subj":r,checked:c,onChange:d,disabled:i})}));O.displayName="EventCheckbox";const I=[{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.process",{defaultMessage:"Process"}),protectionField:"process"}],P=[{id:"sessionDataSection",title:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.title",{defaultMessage:"Session data"}),description:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.description",{defaultMessage:"Turn this on to capture the extended process data required for Session View. Session View provides you a visual representation of session and process execution data. Session View data is organized according to the Linux process model to help you investigate process, user, and service activity on your Linux infrastructure."}),name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.label",{defaultMessage:"Collect session data"}),protectionField:"session_data",isDisabled:e=>!e.linux.events.process},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_io.label",{defaultMessage:"Capture terminal output"}),protectionField:"tty_io",tooltipText:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_io.tooltip",{defaultMessage:"Turn this on to collect terminal (tty) output. Terminal output appears in Session View, and you can view it separately to see what commands were executed and how they were typed, provided the terminal is in echo mode. Only works on hosts that support ebpf."}),indented:!0,isDisabled:e=>!e.linux.events.session_data}],A=Object(s.memo)((({onChange:e,mode:t,...a})=>{const n=Object(s.useMemo)((()=>"edit"===t?P:P.map((e=>"sessionDataSection"===e.id?{...e,description:void 0}:e))),[t]),l=Object(s.useCallback)((({isValid:t,updatedPolicy:a})=>{t&&!1===a.linux.events.session_data&&(a.linux.events.tty_io=!1),e({isValid:t,updatedPolicy:a})}),[e]);return o.a.createElement(D,i()({},a,{mode:t,onChange:l,os:p.c.LINUX,selection:a.policy.linux.events,supplementalOptions:n,options:I}))}));A.displayName="LinuxEventCollectionCard";const F=[{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.network",{defaultMessage:"Network"}),protectionField:"network"}],T=Object(s.memo)((e=>o.a.createElement(D,i()({},e,{os:p.c.MAC,selection:e.policy.mac.events,options:F}))));T.displayName="MacEventCollectionCard";const L=[{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.credentialAccess",{defaultMessage:"API"}),protectionField:"credential_access"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dllDriverLoad",{defaultMessage:"DLL and Driver Load"}),protectionField:"dll_and_driver_load"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dns",{defaultMessage:"DNS"}),protectionField:"dns"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.registry",{defaultMessage:"Registry"}),protectionField:"registry"},{name:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.security",{defaultMessage:"Security"}),protectionField:"security"}],z=Object(s.memo)((e=>o.a.createElement(D,i()({},e,{os:p.c.WINDOWS,selection:e.policy.windows.events,options:L}))));z.displayName="WindowsEventCollectionCard";var N=a(16);const R=g.a.div.withConfig({displayName:"LockedPolicyDiv",componentId:"sc-sl8jse-0"})([".euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.lockedCardDescription{padding:0 33.3%;}"]),W=Object(s.memo)((({title:e,"data-test-subj":t})=>{const a=Object(f.a)(t);return o.a.createElement(R,null,o.a.createElement(l.EuiCard,{"data-test-subj":a(),betaBadgeProps:{"data-test-subj":a("badge"),label:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.platinum",{defaultMessage:"Platinum"})},isDisabled:!0,icon:o.a.createElement(l.EuiIcon,{size:"xl",type:"lock"}),title:o.a.createElement("h3",{"data-test-subj":a("title")},o.a.createElement("strong",null,e)),description:!1},o.a.createElement(l.EuiFlexGroup,{className:"lockedCardDescription",direction:"column",gutterSize:"none"},o.a.createElement(l.EuiText,null,o.a.createElement(l.EuiFlexItem,null,o.a.createElement("h4",null,o.a.createElement(l.EuiTextColor,{color:"subdued"},o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.upgradeToPlatinum",defaultMessage:"Upgrade to Elastic Platinum"})))),o.a.createElement(l.EuiFlexItem,null,o.a.createElement("p",null,o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.lockedCardUpgradeMessage",defaultMessage:"To turn on this protection, you must upgrade your license to Platinum, start a free 30-day trial, or spin up a {cloudDeploymentLink} on AWS, GCP, or Azure.",values:{cloudDeploymentLink:o.a.createElement(l.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank","data-test-subj":a("cloudLink")},o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cloudDeploymentLInk",defaultMessage:"cloud deployment"}))}})))))))}));W.displayName="SettingLockedCard";const $=[p.c.WINDOWS],B=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.attack_surface_reduction",{defaultMessage:"Attack Surface Reduction"}),U=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.attackSurfaceReduction.type",{defaultMessage:"Attack surface reduction"}),H=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.credentialHardening",{defaultMessage:"Credential hardening"}),G=Object(s.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(N.b)().isPlatinumPlus(),r=Object(f.a)(n),c=!Object(u.a)(),d=e.windows.attack_surface_reduction.credential_hardening.enabled,p="edit"===a,y=Object(s.useCallback)((a=>{const n=Object(m.cloneDeep)(e);n.windows.attack_surface_reduction.credential_hardening.enabled=a.target.checked,t({isValid:!0,updatedPolicy:n})}),[t,e]);return c?i?o.a.createElement(w,{type:U,supportedOss:$,dataTestSubj:r()},o.a.createElement(l.EuiSwitch,{label:H,checked:d,disabled:!p,onChange:y,"data-test-subj":r("enableDisableSwitch"),labelProps:{"data-test-subj":r("switchLabel")}})):o.a.createElement(W,{title:B,"data-test-subj":r("locked")}):null}));G.displayName="AttackSurfaceReductionCard";var V=a(118);const q=o.a.memo((({policy:e,onChange:t,mode:a,protection:n,"data-test-subj":i})=>{var d;const u="edit"===a,{cloud:p}=Object(V.j)().services,v=null!==(d=null==p?void 0:p.isCloudEnabled)&&void 0!==d&&d,g=Object(f.a)(i),b=e.windows.behavior_protection.mode!==c.g.off,_=e.windows.behavior_protection.reputation_service&&b,w=Object(s.useCallback)((a=>{const n=Object(m.cloneDeep)(e);n.windows.behavior_protection.reputation_service=a.target.checked,n.mac.behavior_protection.reputation_service=a.target.checked,n.linux.behavior_protection.reputation_service=a.target.checked,t({isValid:!0,updatedPolicy:n})}),[e,t]);return v?o.a.createElement("div",{"data-test-subj":g()},o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(h,null,o.a.createElement(l.EuiFlexGroup,{gutterSize:"xs"},o.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":g("label")},o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("h4",null,o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.reputationService",defaultMessage:"Reputation service"})))),o.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":g("tooltipIcon")},o.a.createElement(l.EuiIconTip,{position:"right","data-test-subj":g("tooltip"),content:o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.reputationServiceTooltip",defaultMessage:"This option enables/disables the Reputation Service feature in Endpoint. When the option is ON, Endpoint will reach out to a Cloud API for additional detection coverage. When it's OFF, Endpoint will not reach out to the Cloud API, resulting in reduced efficacy."})})))),o.a.createElement(l.EuiSpacer,{size:"s"}),o.a.createElement(l.EuiCheckbox,{"data-test-subj":g("checkbox"),id:`${n}ReputationServiceCheckbox}`,onChange:w,checked:_,disabled:!b||!u,label:r.i18n.translate("xpack.securitySolution.endpoint.policyDetail.reputationService",{defaultMessage:"Reputation service"})})):null}));q.displayName="ReputationService";const X=Object.freeze({malware:"7.11+",ransomware:"7.12+",memory_protection:"7.15+",behavior_protection:"7.15+"}),K=r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.userNotification",{defaultMessage:"User notification"}),Y=r.i18n.translate("xpack.securitySolution.endpoint.policyDetail.notifyUser",{defaultMessage:"Notify user"}),J=r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.notificationMessage",{defaultMessage:"Notification message"}),Q=r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.customizeUserNotification",{defaultMessage:"Customize notification message"}),Z=o.a.memo((({policy:e,onChange:t,mode:a,protection:n,osList:i,"data-test-subj":d})=>{const u=Object(N.b)().isPlatinumPlus(),p=Object(f.a)(d),v="edit"===a,g=e.windows[n].mode,b=e.windows.popup[n].enabled,_=e.windows.popup[n].message,w=Object(s.useCallback)((a=>{const s=Object(m.cloneDeep)(e);for(const e of i)("windows"===e||"mac"===e||"linux"===e)&&(s[e].popup[n].enabled=a.target.checked);t({isValid:!0,updatedPolicy:s})}),[e,t,i,n]),k=Object(s.useCallback)((a=>{const s=Object(m.cloneDeep)(e);for(const e of i)("windows"===e||"mac"===e||"linux"===e)&&(s[e].popup[n].message=a.target.value);t({isValid:!0,updatedPolicy:s})}),[e,t,i,n]),x=Object(s.useCallback)((e=>"memory_protection"===e?r.i18n.translate("xpack.securitySolution.endpoint.policyDetail.memoryProtectionTooltip",{defaultMessage:"memory threat"}):"behavior_protection"===e?r.i18n.translate("xpack.securitySolution.endpoint.policyDetail.behaviorProtectionTooltip",{defaultMessage:"malicious behavior"}):e),[]),E=Object(s.useCallback)((e=>"memory_protection"===e||"behavior_protection"===n?r.i18n.translate("xpack.securitySolution.endpoint.policyDetail.rule",{defaultMessage:"rule"}):r.i18n.translate("xpack.securitySolution.endpoint.policyDetail.filename",{defaultMessage:"filename"})),[n]);return u?o.a.createElement("div",{"data-test-subj":p()},o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(h,{"data-test-subj":p("title")},K),o.a.createElement(ee,{protection:n,"data-test-subj":p("supportedVersion")}),o.a.createElement(l.EuiSpacer,{size:"s"}),o.a.createElement(l.EuiCheckbox,{"data-test-subj":p("checkbox"),id:`${n}UserNotificationCheckbox}`,onChange:w,checked:b,disabled:!v||g===c.g.off,label:Y}),b&&(v?o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(l.EuiFlexGroup,{gutterSize:"xs"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiText,{size:"s","data-test-subj":p("customMessageTitle")},o.a.createElement("h4",null,Q))),o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiIconTip,{position:"right","data-test-subj":p("tooltipInfo"),anchorProps:{"data-test-subj":p("tooltipIcon")},content:o.a.createElement(o.a.Fragment,null,o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.a",defaultMessage:"Selecting the user notification option will display a notification to the host user when { protectionName } is prevented or detected.",values:{protectionName:x(n)}}),o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.c",defaultMessage:" The user notification can be customized in the text box below. Bracketed tags can be used to dynamically populate the applicable action (such as prevented or detected) and the { bracketText }.",values:{bracketText:E(n)}}))}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiTextArea,{placeholder:r.i18n.translate("xpack.securitySolution.endpoint.policyDetails.userNotification.placeholder",{defaultMessage:"Input your custom notification message"}),value:_,onChange:k,fullWidth:!0,disabled:!v,"data-test-subj":p("customMessage")})):o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("h4",null,J)),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(o.a.Fragment,null,_||Object(C.e)())))):null}));Z.displayName="NotifyUserOption";const ee=o.a.memo((({protection:e,"data-test-subj":t})=>{const a=Object(s.useMemo)((()=>X[e]),[e]);return a?o.a.createElement(l.EuiText,{color:"subdued",size:"xs","data-test-subj":t},o.a.createElement("i",null,o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.supportedVersion",defaultMessage:"Agent version {version}",values:{version:a}}))):null}));ee.displayName="SupportedVersionForProtectionNotice";const te=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.detect",{defaultMessage:"Detect"}),ae=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.prevent",{defaultMessage:"Prevent"}),ne=Object(s.memo)((({policy:e,protection:t,osList:a,mode:n,onChange:i,"data-test-subj":r})=>{const d="edit"===n,u=Object(f.a)(r),p=Object(s.useMemo)((()=>[{id:c.g.detect,label:te,flexGrow:1},{id:c.g.prevent,label:ae,flexGrow:5}]),[]),m=Object(s.useMemo)((()=>{const a=p.find((a=>a.id===e.windows[t].mode));return a?a.label:ae}),[e.windows,t,p]);return o.a.createElement("div",{"data-test-subj":u()},o.a.createElement(h,null,o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.protectionLevel",defaultMessage:"Protection level"})),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiFlexGroup,null,d?p.map((({label:s,id:r,flexGrow:c})=>o.a.createElement(l.EuiFlexItem,{grow:c,key:r},o.a.createElement(ie,{policy:e,onChange:i,mode:n,protection:t,protectionMode:r,osList:a,label:s,"data-test-subj":u(`${r}Radio`)})))):o.a.createElement(o.a.Fragment,null,m)))}));ne.displayName="DetectPreventProtectionLevel";const ie=o.a.memo((({protection:e,protectionMode:t,osList:a,label:n,onChange:i,policy:r,mode:d,"data-test-subj":u})=>{const p=r.windows[e].mode,f=Object(N.b)().isPlatinumPlus(),y="edit"===d,v=Object(s.useMemo)((()=>`${a.join("-")}-${e}-${t}`),[a,e,t]),g=Object(s.useCallback)((()=>{const n=Object(m.cloneDeep)(r);for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=t),f&&("windows"===i||"mac"===i||"linux"===i)&&(t===c.g.prevent?n[i].popup[e].enabled=!0:n[i].popup[e].enabled=!1);i({isValid:!0,updatedPolicy:n})}),[f,i,a,r,e,t]);return o.a.createElement(l.EuiRadio,{label:n,id:v,checked:p===t,onChange:g,disabled:!y||p===c.g.off,"data-test-subj":u})}));ie.displayName="ProtectionRadio";const se=o.a.memo((({protection:e,protectionLabel:t,osList:a,additionalOnSwitchChange:n,onChange:i,policy:r,mode:d,selected:u,"data-test-subj":p})=>{const y=Object(f.a)(p),v=Object(N.b)().isPlatinumPlus(),g="edit"===d,b=Object(s.useCallback)((t=>{const s=Object(m.cloneDeep)(r);if(!1===t.target.checked)for(const n of a)("windows"===n||"mac"===n||"linux"===n)&&(s[n][e].mode=c.g.off),v&&(("windows"===n||"mac"===n||"linux"===n)&&(s[n].popup[e].enabled=t.target.checked),"behavior_protection"===e&&(s.windows.behavior_protection.reputation_service=!1,s.mac.behavior_protection.reputation_service=!1,s.linux.behavior_protection.reputation_service=!1));else for(const n of a)("windows"===n||"mac"===n||"linux"===n)&&(s[n][e].mode=c.g.prevent),v&&("behavior_protection"===e&&(s.windows.behavior_protection.reputation_service=!0,s.mac.behavior_protection.reputation_service=!0,s.linux.behavior_protection.reputation_service=!0),("windows"===n||"mac"===n||"linux"===n)&&(s[n].popup[e].enabled=t.target.checked));i({isValid:!0,updatedPolicy:n?n({value:t.target.checked,policyConfigData:s,protectionOsList:a}):s})}),[r,i,n,a,v,e]);return o.a.createElement(l.EuiSwitch,{label:t,labelProps:{"data-test-subj":y("label")},checked:u,disabled:!g,onChange:b,"data-test-subj":y()})}));se.displayName="ProtectionSettingCardSwitch";const oe=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior",{defaultMessage:"Malicious Behavior"}),le=[c.f.windows,c.f.mac,c.f.linux],re=Object(s.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(N.b)().isPlatinumPlus(),s=Object(f.a)(n),d=!Object(u.a)(),m="behavior_protection",y=r.i18n.translate("xpack.securitySolution.endpoint.policy.protections.behavior",{defaultMessage:"Malicious behavior protections"}),v=(e&&e.windows[m].mode)!==c.g.off;return d?i?o.a.createElement(w,{type:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior_protection",{defaultMessage:"Malicious behavior"}),selected:v,mode:a,supportedOss:[p.c.WINDOWS,p.c.MAC,p.c.LINUX],dataTestSubj:s(),rightCorner:o.a.createElement(se,{selected:v,policy:e,onChange:t,mode:a,protection:m,protectionLabel:y,osList:le,"data-test-subj":s("enableDisableSwitch")})},o.a.createElement(ne,{policy:e,onChange:t,mode:a,protection:m,osList:le,"data-test-subj":s("protectionLevel")}),o.a.createElement(q,{policy:e,onChange:t,mode:a,protection:m,"data-test-subj":s("reputationService")}),o.a.createElement(Z,{policy:e,onChange:t,mode:a,protection:m,osList:le,"data-test-subj":s("notifyUser")}),o.a.createElement(l.EuiSpacer,{size:"m"})):o.a.createElement(W,{title:oe,"data-test-subj":s("locked")}):null}));re.displayName="BehaviourProtectionCard";const ce=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory",{defaultMessage:"Memory Threat"}),de=[c.f.windows,c.f.mac,c.f.linux],ue=Object(s.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(N.b)().isPlatinumPlus(),s=Object(f.a)(n),d=!Object(u.a)(),m="memory_protection",y=(e&&e.windows[m].mode)!==c.g.off,v=r.i18n.translate("xpack.securitySolution.endpoint.policy.protections.memory",{defaultMessage:"Memory threat protections"});return d?i?o.a.createElement(w,{type:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory_protection",{defaultMessage:"Memory threat"}),supportedOss:[p.c.WINDOWS,p.c.MAC,p.c.LINUX],dataTestSubj:s(),selected:y,mode:a,rightCorner:o.a.createElement(se,{selected:y,policy:e,onChange:t,mode:a,protection:m,protectionLabel:v,osList:de,"data-test-subj":s("enableDisableSwitch")})},o.a.createElement(ne,{policy:e,onChange:t,mode:a,protection:m,osList:de,"data-test-subj":s("protectionLevel")}),o.a.createElement(Z,{policy:e,onChange:t,mode:a,protection:m,osList:de,"data-test-subj":s("notifyUser")}),o.a.createElement(l.EuiSpacer,{size:"m"})):o.a.createElement(W,{title:ce,"data-test-subj":s("locked")}):null}));ue.displayName="MemoryProtectionCard";const pe=Object(s.memo)((({"data-test-subj":e})=>{const t=Object(f.a)(e),{docLinks:{links:{securitySolution:a}}}=Object(V.j)().services;return o.a.createElement(l.EuiCallOut,{iconType:"iInCircle","data-test-subj":t()},o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesDocsMessage",defaultMessage:"The Endpoint Security detection rule is enabled automatically with Elastic Defend. This rule must remain enabled to receive Endpoint alerts. {detectionRulesDocsLink}.",values:{detectionRulesDocsLink:o.a.createElement(l.EuiLink,{"data-test-subj":t("link"),target:"_blank",href:`${a.detectionEngineOverview}`},o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessageDocsLink",defaultMessage:"Learn More"}))}}))}));pe.displayName="RelatedDetectionRulesCallout";const me=[c.f.windows],fe=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),ye=o.a.memo((({policy:e,onChange:t,mode:a,"data-test-subj":n})=>{const i=Object(N.b)().isPlatinumPlus(),s=!Object(u.a)(),d=Object(f.a)(n),m="ransomware",y=(e&&e.windows[m].mode)!==c.g.off,v=r.i18n.translate("xpack.securitySolution.endpoint.policy.protections.ransomware",{defaultMessage:"Ransomware protections"});return s?i?o.a.createElement(w,{type:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),supportedOss:[p.c.WINDOWS],dataTestSubj:d(),selected:y,mode:a,rightCorner:o.a.createElement(se,{selected:y,policy:e,onChange:t,mode:a,protection:m,protectionLabel:v,osList:me,"data-test-subj":d("enableDisableSwitch")})},o.a.createElement(ne,{protection:m,osList:me,onChange:t,policy:e,mode:a,"data-test-subj":d("protectionLevel")}),o.a.createElement(Z,{policy:e,onChange:t,mode:a,protection:m,osList:me,"data-test-subj":d("notifyUser")}),o.a.createElement(l.EuiSpacer,{size:"m"})):o.a.createElement(W,{title:fe,"data-test-subj":d("locked")}):null}));ye.displayName="RansomwareProtectionCard";var ve=a(122);const ge={label:r.i18n.translate("xpack.securitySolution.endpoint.policy.protections.blocklistLabel",{defaultMessage:"Blocklist"}),hint:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.blocklistTooltip",{defaultMessage:"Enables or disables the blocklist associated with this policy. The blocklist is a collection hashes, paths, or signers which extends the list of processes the endpoint considers malicious. See the blocklist tab for entry details."})},be={label:r.i18n.translate("xpack.securitySolution.endpoint.policy.protections.onWriteScanLabel",{defaultMessage:"Scan files upon modification"}),hint:r.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.onWriteScanTooltip",{defaultMessage:"Enables or disables scanning files when they're modified. Disabling this feature improves Endpoint performance."}),versionCompatibilityHint:r.i18n.translate("xpack.securitySolution.endpoint.policy.protections.onWriteVersionCompatibilityHint",{defaultMessage:"Always enabled on Agent versions 8.13 and older."})},_e=({value:e,policyConfigData:t,protectionOsList:a})=>{for(const n of a)t[n].malware.blocklist=e;return t},he=({value:e,policyConfigData:t,protectionOsList:a})=>{for(const n of a)t[n].malware.on_write_scan=e;return t},we=({policyConfigData:e,...t})=>{const a=_e({policyConfigData:e,...t});return he({policyConfigData:a,...t})},ke=[c.f.windows,c.f.mac,c.f.linux],xe=o.a.memo((({policy:e,onChange:t,mode:a="edit","data-test-subj":n})=>{const i=Object(ve.a)("malwareOnWriteScanOptionAvailable"),s=Object(f.a)(n),d=!Object(u.a)(),m="malware",y=(e&&e.windows[m].mode)!==c.g.off,v=r.i18n.translate("xpack.securitySolution.endpoint.policy.protections.malware",{defaultMessage:"Malware protections"});return d?o.a.createElement(w,{type:r.i18n.translate("xpack.securitySolution.endpoint.policy.details.malware",{defaultMessage:"Malware"}),supportedOss:[p.c.WINDOWS,p.c.MAC,p.c.LINUX],dataTestSubj:s(),selected:y,mode:a,rightCorner:o.a.createElement(se,{selected:y,protection:m,protectionLabel:v,osList:ke,additionalOnSwitchChange:we,policy:e,onChange:t,mode:a,"data-test-subj":s("enableDisableSwitch")})},o.a.createElement(ne,{policy:e,onChange:t,mode:a,protection:m,osList:ke,"data-test-subj":s("protectionLevel")}),o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(Ee,{policy:e,onChange:t,mode:a,"data-test-subj":s("blocklist"),labels:ge,checked:e.windows.malware.blocklist,adjustSubfeatureOnProtectionSwitch:_e}),i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(Ee,{policy:e,onChange:t,mode:a,"data-test-subj":s("onWriteScan"),labels:be,checked:e.windows.malware.on_write_scan,adjustSubfeatureOnProtectionSwitch:he})),o.a.createElement(Z,{policy:e,onChange:t,mode:a,protection:m,osList:ke,"data-test-subj":s("notifyUser")}),o.a.createElement(l.EuiSpacer,{size:"m"})):null}));xe.displayName="MalwareProtectionsCard";const Ee=Object(s.memo)((({policy:e,onChange:t,mode:a,"data-test-subj":n,labels:i,adjustSubfeatureOnProtectionSwitch:r,checked:c})=>{const d=Object(f.a)(n),u="edit"===a,p="off"===e.windows.malware.mode||!u,y=Object(s.useCallback)((a=>{const n=a.target.checked,i=Object(m.cloneDeep)(e);r({value:n,policyConfigData:i,protectionOsList:ke}),t({isValid:!0,updatedPolicy:i})}),[r,t,e]);return o.a.createElement(l.EuiFlexGroup,{gutterSize:"xs","data-test-subj":d()},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiSwitch,{label:i.label,checked:c,onChange:y,disabled:p,"data-test-subj":d("enableDisableSwitch")})),o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiIconTip,{position:"right",content:o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,i.hint),i.versionCompatibilityHint&&o.a.createElement(l.EuiSpacer,null),i.versionCompatibilityHint&&o.a.createElement("i",null,i.versionCompatibilityHint))})))}));Ee.displayName="SubfeatureSwitch";const Se=[{key:"linux.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"linux.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.base_url",{defaultMessage:"Base URL from which to download global artifact manifests. Default: https://artifacts.security.elastic.co."})},{key:"linux.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip.",ignoreTag:!0})},{key:"linux.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"linux.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"linux.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"linux.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"linux.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"linux.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"linux.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"linux.advanced.logging.file",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.logging.syslog",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.tty_io.max_kilobytes_per_process",first_supported_version:"8.5",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_process",{defaultMessage:"The maximum kilobytes of terminal output to record for a single process. Default: 512"})},{key:"linux.advanced.tty_io.max_kilobytes_per_event",first_supported_version:"8.5",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_event",{defaultMessage:"The maximum kilobytes of terminal output to record in a single event. Default: 512"})},{key:"linux.advanced.capture_env_vars",first_supported_version:"8.6",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.capture_env_vars",{defaultMessage:"The list of environment variables to capture (up to five), separated by commas."})},{key:"linux.advanced.tty_io.max_event_interval_seconds",first_supported_version:"8.5",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_event_interval_seconds",{defaultMessage:"The maximum amount of time (seconds) to batch terminal output in a single event. Default: 30"})},{key:"linux.advanced.network_events_exclude_local",first_supported_version:"8.10.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.network_events_exclude_local",{defaultMessage:"Exclude local connections from network events. Default: false."})},{key:"mac.advanced.network_events_exclude_local",first_supported_version:"8.10.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.network_events_exclude_local",{defaultMessage:"Exclude local connections from network events. Default: false."})},{key:"linux.advanced.capture_command_line",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.capture_command_line",{defaultMessage:"Include process command line in all events that are related to this process. Default: false."})},{key:"mac.advanced.capture_command_line",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.capture_command_line",{defaultMessage:"Include process command line in all events that are related to this process. Default: false."})},{key:"mac.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"mac.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"mac.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip.",ignoreTag:!0})},{key:"mac.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"mac.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"mac.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"mac.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"mac.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"mac.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"mac.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"mac.advanced.logging.file",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.logging.syslog",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.malware.quarantine",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"mac.advanced.malware.threshold",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"mac.advanced.kernel.connect",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"mac.advanced.kernel.process",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"mac.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"mac.advanced.kernel.network",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"mac.advanced.harden.self_protect",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.harden.self_protect",{defaultMessage:"Enables self-protection on macOS. Default: true."})},{key:"windows.advanced.network_events_exclude_local",first_supported_version:"8.10.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.network_events_exclude_local",{defaultMessage:"Exclude local connections from network events. Default: false."})},{key:"windows.advanced.capture_command_line",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.capture_command_line",{defaultMessage:"Include process command line in all events that are related to this process. Default: false."})},{key:"windows.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"windows.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"windows.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip.",ignoreTag:!0})},{key:"windows.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"windows.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"windows.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"windows.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"windows.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"windows.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"windows.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"windows.advanced.logging.file",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.logging.debugview",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.debugview",{defaultMessage:"A supplied value will configure logging to Debugview (a Sysinternals tool). Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.malware.quarantine",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.malware.threshold",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"windows.advanced.kernel.connect",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"windows.advanced.kernel.process",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"windows.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"windows.advanced.kernel.filewrite_sync",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.filewrite_sync",{defaultMessage:"Send file kernel driver write notifications synchronously where possible.  May improve the reliability of file write and malware-on-write enrichments at the cost of system responsiveness. Default: false."})},{key:"windows.advanced.kernel.network",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"windows.advanced.kernel.network_report_loopback",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.network_report_loopback",{defaultMessage:"Controls whether the kernel reports loopback network events. Default: true."})},{key:"windows.advanced.kernel.fileopen",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileopen",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file open events. Default: true."})},{key:"windows.advanced.kernel.asyncimageload",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.asyncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel async image load events. Default: true."})},{key:"windows.advanced.kernel.syncimageload",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.syncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel sync image load events. Default: true."})},{key:"windows.advanced.kernel.registry",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registry",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel registry events. Default: true."})},{key:"windows.advanced.kernel.fileaccess",first_supported_version:"7.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileaccess",{defaultMessage:"Report limited file access (read) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.kernel.registryaccess",first_supported_version:"7.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registryaccess",{defaultMessage:"Report limited registry access (queryvalue, savekey) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.kernel.process_handle",first_supported_version:"8.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process_handle",{defaultMessage:"Capture process and thread handle events. Default: true."})},{key:"windows.advanced.diagnostic.enabled",first_supported_version:"7.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"linux.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"mac.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"windows.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Windows alerts. Default: true."})},{key:"mac.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Mac alerts. Default: true."})},{key:"windows.advanced.ransomware.mbr",first_supported_version:"7.12",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.mbr",{defaultMessage:"A value of 'false' disables Ransomware MBR protection. Default: true."})},{key:"windows.advanced.ransomware.canary",first_supported_version:"7.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.canary",{defaultMessage:"A value of 'false' disables Ransomware canary protection. Default: true."})},{key:"windows.advanced.memory_protection.shellcode",first_supported_version:"7.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode",{defaultMessage:"Enable shellcode injection detection as a part of memory protection. Default: true."})},{key:"windows.advanced.memory_protection.memory_scan",first_supported_version:"7.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.malware.quarantine",first_supported_version:"7.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"linux.advanced.memory_protection.enable_fork_scan",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.enable_fork_scan",{defaultMessage:"Enable memory scanning on process fork events. This will have the effect of more memory regions being scanned. Default: true."})},{key:"linux.advanced.memory_protection.enable_shared_dirty_scan",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.enable_shared_dirty_scan",{defaultMessage:"Instead of ignoring regions with just no Private_Dirty bytes, ingore regions with the combination of no Private_Dirty bytes, no Shared_Dirty bytes and is file backed. This has the effect of scanning more memory regions because of the loosened restrictions. Default: true."})},{key:"windows.advanced.memory_protection.shellcode_collect_sample",first_supported_version:"7.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected shellcode regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.shellcode_enhanced_pe_parsing",first_supported_version:"7.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.memory_protection.shellcode_enhanced_pe_parsing",{defaultMessage:"Attempt to identify and extract PE metadata from injected shellcode, including Authenticode signatures and version resource information. Default: true."})},{key:"mac.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"mac.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"linux.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"mac.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.events.etw",first_supported_version:"8.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.etw",{defaultMessage:"Deprecated."})},{key:"windows.advanced.diagnostic.rollback_telemetry_enabled",first_supported_version:"8.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.rollback_telemetry_enabled",{defaultMessage:"Enable diagnostic rollback telemetry. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_content_filtering",first_supported_version:"8.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_content_filtering",{defaultMessage:"Enable or disable the network content filter, this will enable/disable network eventing. Host isolation will fail if this option is disabled. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_packet_filtering",first_supported_version:"8.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_packet_filtering",{defaultMessage:"Enable or disable the network packet filter. Host isolation will fail if this option is disabled. Default: true"})},{key:"windows.advanced.memory_protection.shellcode_trampoline_detection",first_supported_version:"8.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_trampoline_detection",{defaultMessage:"Enable trampoline-based shellcode injection detection as a part of memory protection. Default: true"})},{key:"linux.advanced.kernel.capture_mode",first_supported_version:"8.2",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.kernel.capture_mode",{defaultMessage:"Allows users to control whether kprobes or ebpf are used to gather data. Options are kprobe, ebpf, or auto. Auto uses ebpf if possible, otherwise uses kprobe. Default: auto"})},{key:"linux.advanced.event_filter.default",first_supported_version:"8.3",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"mac.advanced.event_filter.default",first_supported_version:"8.3",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.event_filter.default",first_supported_version:"8.3",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 100"})},{key:"linux.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 50"})},{key:"windows.advanced.alerts.rollback.self_healing.enabled",first_supported_version:"8.4",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.rollback.self_healing.enabled",{defaultMessage:"Self-healing erases attack artifacts when prevention alerts are triggered. Warning: data loss can occur. Default: false"}),license:"platinum"},{key:"linux.advanced.fanotify.ignore_unknown_filesystems",first_supported_version:"8.4",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignore_unknown_filesystems",{defaultMessage:'Whether fanotify should ignore unknown filesystems. When true, only CI tested filesystems will be marked by default; additional filesystems can be added or removed with "monitored_filesystems" and "ignored_filesystems", respectively. When false, only an internally curated list of filesystems will be ignored, all others will be marked; additional filesystems can be ignored via "ignored_filesystems". "monitored_filesystems" is ignored when "ignore_unknown_filesystems" is false. Default: true'})},{key:"linux.advanced.fanotify.monitored_filesystems",first_supported_version:"8.4",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.monitored_filesystems",{defaultMessage:'Additional filesystems for fanotify to monitor. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "jfs,ufs,ramfs". It is recommended to avoid network-backed filesystems. When "ignore_unknown_filesystems" is false, this option is ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option are monitored by fanotify unless overridden by entries in "ignored_filesystems" or internally known bad filesystems.'})},{key:"linux.advanced.fanotify.ignored_filesystems",first_supported_version:"8.4",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignored_filesystems",{defaultMessage:'Additional filesystems for fanotify to ignore. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "ext4,tmpfs". When "ignore_unknown_filesystems" is false, parsed entries of this option supplement internally known bad filesystems to be ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option override entries in "monitored_filesystems" and internally CI tested filesystems.'})},{key:"linux.advanced.fanotify.seccomp_restricted",first_supported_version:"8.13.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.seccomp_restricted",{defaultMessage:"Prevent the Defend permission checking thread from calling the open/openat syscalls when running on kernels which require FAN_OPEN_PERM (older than 5.0). Will avoid potential deadlocks with other anti-virus vendors at the cost of racy hash-based trusted application entries. Ignored when running on newer kernels. Default: false"})},{key:"windows.advanced.memory_protection.context_manipulation_detection",first_supported_version:"8.4",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.context_manipulation_detection",{defaultMessage:"Detect injection based on thread context manipulation (e.g. `SetThreadContext`) as a part of memory protection. Default: true"})},{key:"windows.advanced.kernel.image_and_process_file_timestamp",first_supported_version:"8.4",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.image_and_process_file_timestamp",{defaultMessage:"Collect executable/dll timestamps for process and async image load events. Default: true"})},{key:"linux.advanced.host_isolation.allowed",first_supported_version:"8.6.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.host_isolation.allowed",{defaultMessage:"A value of false disallows host isolation activity on Linux endpoints, regardless of whether host isolation is supported. Note that if a host is currently not isolated, it will refuse to isolate, and likewise, a host will refuse to release if it is currently isolated. A value of true will allow Linux endpoints to isolate if supported. Default: true"})},{key:"mac.advanced.capture_env_vars",first_supported_version:"8.7",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.capture_env_vars",{defaultMessage:"The list of environment variables to capture (up to five), separated by commas."})},{key:"linux.advanced.events.disable_fd_kprobes",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.events.disable_fd_kprobes",{defaultMessage:"When only process events are being collected, this option will disable file descriptor tracking probes. This can be used to reduce Endpoint processing at the expense of missing fchdir based working directory changes. This only applies if the capture_mode is kprobe or if auto resolves tracefs (kprobe) probes. ebpf based event collection ignores this setting. Default is false."})},{key:"linux.advanced.events.enable_caps",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.events.enable_caps",{defaultMessage:"This setting ensures thread capability arrays are not pruned from Linux process events before being sent to Elasticsearch. At the expense of higher Endpoint data volumes, a true value will ensure capability matching detection rules running within the Elastic stack can match. Detection rules running within Elastic Defend are unaffected because capabilities are conditionally pruned after rule processing. Default is false."})},{key:"windows.advanced.events.callstacks.emit_in_events",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.emit_in_events",{defaultMessage:"If set, callstacks will be included in regular events where they are collected. Otherwise, they are only included in events that trigger behavioral protection rules. Note that setting this may significantly increase data volumes. Default: false"})},{key:"windows.advanced.events.callstacks.process",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.process",{defaultMessage:"Collect callstacks during process events?  Default: true"})},{key:"windows.advanced.events.callstacks.image_load",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.image_load",{defaultMessage:"Collect callstacks during image/library load events?  Default: true"})},{key:"windows.advanced.events.callstacks.file",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.file",{defaultMessage:"Collect callstacks during file events?  Default: true"})},{key:"windows.advanced.events.callstacks.registry",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.registry",{defaultMessage:"Collect callstacks during registry events?  Default: true"})},{key:"windows.advanced.events.callstacks.timeout_microseconds",first_supported_version:"8.12",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.timeout_microseconds",{defaultMessage:"Maximum runtime of inline callstack collection/enrichment.  Default: 100000"})},{key:"windows.advanced.events.process_ancestry_length",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.process_ancestry_length",{defaultMessage:"Maximum number of process ancestry entries to include in process events. Default: 5"})},{key:"mac.advanced.events.process_ancestry_length",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.events.process_ancestry_length",{defaultMessage:"Maximum number of process ancestry entries to include in process events. Default: 5"})},{key:"linux.advanced.events.process_ancestry_length",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.events.process_ancestry_length",{defaultMessage:"Maximum number of process ancestry entries to include in process events. Default: 5"})},{key:"windows.advanced.events.ancestry_in_all_events",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.ancestry_in_all_events",{defaultMessage:"Include ancestor process entity IDs in all event types, by default it is only included in alerts and process events. Default: false"})},{key:"mac.advanced.events.ancestry_in_all_events",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.events.ancestry_in_all_events",{defaultMessage:"Include ancestor process entity IDs in all event types, by default it is only included in alerts and process events. Default: false"})},{key:"linux.advanced.events.ancestry_in_all_events",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.events.ancestry_in_all_events",{defaultMessage:"Include ancestor process entity IDs in all event types, by default it is only included in alerts and process events. Default: false"})},{key:"windows.advanced.artifacts.global.proxy_url",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.proxy_url",{defaultMessage:"Proxy server to use when downloading global artifact manifests. Default: none"})},{key:"windows.advanced.artifacts.global.proxy_disable",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading global artifact manifests. Default: false"})},{key:"windows.advanced.artifacts.user.proxy_url",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.proxy_url",{defaultMessage:"Proxy server to use when downloading user artifact manifests. Default: none"})},{key:"windows.advanced.artifacts.user.proxy_disable",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading user artifact manifests. Default: false"})},{key:"mac.advanced.artifacts.global.proxy_url",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.proxy_url",{defaultMessage:"Proxy server to use when downloading global artifact manifests. Default: none"})},{key:"mac.advanced.artifacts.global.proxy_disable",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading global artifact manifests. Default: false"})},{key:"mac.advanced.artifacts.user.proxy_url",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.proxy_url",{defaultMessage:"Proxy server to use when downloading user artifact manifests. Default: none"})},{key:"mac.advanced.artifacts.user.proxy_disable",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading user artifact manifests. Default: false"})},{key:"linux.advanced.artifacts.global.proxy_url",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.proxy_url",{defaultMessage:"Proxy server to use when downloading global artifact manifests. Default: none"})},{key:"linux.advanced.artifacts.global.proxy_disable",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading global artifact manifests. Default: false"})},{key:"linux.advanced.artifacts.user.proxy_url",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.proxy_url",{defaultMessage:"Proxy server to use when downloading user artifact manifests. Default: none"})},{key:"linux.advanced.artifacts.user.proxy_disable",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.proxy_disable",{defaultMessage:"If the proxy setting should be used when downloading user artifact manifests. Default: false"})},{key:"windows.advanced.events.api",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.api",{defaultMessage:"Controls whether ETW API events are enabled. Set to false to disable ETW event collection. Default: true"})},{key:"windows.advanced.events.api_disabled",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.api_disabled",{defaultMessage:"A comma separated list of API names to selectively disable."})},{key:"windows.advanced.events.api_verbose",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.api_verbose",{defaultMessage:"Controls whether high volume API events are forwarded. Event filtering is recommended if enabled. Default: false"})},{key:"windows.advanced.alerts.rollback.self_healing.registry_enabled",first_supported_version:"8.8",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.rollback.self_healing.registry_enabled",{defaultMessage:"Enables self-healing of registry based malware artifacts. Requires rollback.self_healing.enabled to also be enabled. Default: true"})},{key:"windows.advanced.events.callstacks.include_network_images",first_supported_version:"8.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.callstacks.include_network_images",{defaultMessage:"Should executables and DLLs on network shares be parsed for call stack symbols?  This may cause Endpoint to hang on some networks. Default: true"})},{key:"windows.advanced.kernel.ppl.harden_images",first_supported_version:"8.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.ppl.harden_images",{defaultMessage:"Mitigate attacks like PPLFault by preventing Protected Process Light (PPL) processes from loading DLLs over the network. Default: true"})},{key:"windows.advanced.kernel.ppl.harden_am_images",first_supported_version:"8.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.ppl.harden_am_images",{defaultMessage:'Apply the windows.advanced.kernel.ppl.harden_images mitigation to Anti-Malware PPL as well. Disable this if third-party Anti-Malware is blocked from loading DLLs over the network. If this happens, there will be Event ID 8 events in the "Microsoft-Windows-Security-Mitigations/Kernel Mode" event log. Default: true'})},{key:"windows.advanced.malware.networkshare",first_supported_version:"8.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.networkshare",{defaultMessage:"Controls whether malware protection is applied to network drives. Default: true"})},{key:"windows.advanced.events.check_debug_registers",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.check_debug_registers",{defaultMessage:"Check debug registers inline to detect the use of hardware breakpoints. Malware may use hardware breakpoints to forge benign-looking call stacks. Default: true"})},{key:"mac.advanced.kernel.fileaccess",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.fileaccess",{defaultMessage:"A value of false overrides other config settings that would enable kernel fileaccess events. Default: true."})},{key:"mac.advanced.events.image_load",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.events.image_load",{defaultMessage:"A value of false overrides other config settings that would enable kernel image load events. Default: true."})},{key:"mac.advanced.image_load.capture",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.image_load.collect",{defaultMessage:"Collect and send image load events to Elasticsearch. Take caution, this can be a very high data volume. Adding an event filter to drop unwanted events is strongly recommended. Default: false"})},{key:"windows.advanced.document_enrichment.fields",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.document_enrichment.fields",{defaultMessage:"A comma delimited set of key=value pairs of values to add into all Endpoint documents. Each key must begin with Custom. An example is Custom.key=value1,Custom.key2=value2"})},{key:"mac.advanced.document_enrichment.fields",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.document_enrichment.fields",{defaultMessage:"A comma delimited set of key=value pairs of values to add into all Endpoint documents. Each key must begin with Custom. An example is Custom.key=value1,Custom.key2=value2"})},{key:"linux.advanced.document_enrichment.fields",first_supported_version:"8.11",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.document_enrichment.fields",{defaultMessage:"A comma delimited set of key=value pairs of values to add into all Endpoint documents. Each key must begin with Custom. An example is Custom.key=value1,Custom.key2=value2"})},{key:"linux.advanced.file_cache.file_object_cache_size",first_supported_version:"8.12.0",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.file_cache.file_object_cache_size",{defaultMessage:"Maximum size of the file cache.  Larger values can improve performance but increase memory usage. Default: 250"})},{key:"mac.advanced.file_cache.file_object_cache_size",first_supported_version:"8.12.0",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.file_cache.file_object_cache_size",{defaultMessage:"Maximum size of the file cache.  Larger values can improve performance but increase memory usage. Default: 250"})},{key:"windows.advanced.file_cache.file_object_cache_size",first_supported_version:"8.12.0",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.file_cache.file_object_cache_size",{defaultMessage:"Maximum size of the file cache.  Larger values can improve performance but increase memory usage. Default: 250"})},{key:"windows.advanced.utilization_limits.resident_memory_target_mb",first_supported_version:"8.12.0",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.utilization_limits.resident_memory_target_mb",{defaultMessage:"How much memory (in MB) should Endpoint aim to keep resident in RAM? This setting affects Private Working Set on Windows. It does not affect the amount of virtual memory that Endpoint requests from the OS (Private Bytes aka Commit Charge). If plenty of unused RAM is available, Windows may give Endpoint more RAM than requested to reduce unnecessary paging and improve performance. If the current Defend configuration requires regularly touching more than the requested amount of memory, then the Private Working Set will be higher than requested here. Default 200. This value cannot be decreased below 50."})},{key:"windows.advanced.alerts.sample_collection",first_supported_version:"8.13",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.sample_collection",{defaultMessage:"A value of 'false' disables malicious sample collection for Windows alerts. Default: true."})},{key:"mac.advanced.alerts.sample_collection",first_supported_version:"8.13",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.alerts.sample_collection",{defaultMessage:"A value of 'false' disables malicious sample collection for Mac alerts. Default: true."})},{key:"linux.advanced.alerts.sample_collection",first_supported_version:"8.13",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.alerts.sample_collection",{defaultMessage:"A value of 'false' disables malicious sample collection for Linux alerts. Default: true."})},{key:"windows.advanced.events.disable_image_load_suppression_cache",first_supported_version:"8.12.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.disable_image_load_suppression_cache",{defaultMessage:"The image load suppression cache improves system performance by enabling Endpoint to tell its kernel driver about DLLs which are un-interesting and will never be evented upon. This feature improves system reponsiveness and reduces Endpoint CPU usage.  Use this setting only for troubleshooting if image load events are not being generated as expected. Default: false"})},{key:"windows.advanced.events.disable_registry_write_suppression",first_supported_version:"8.12.1",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.disable_registry_write_suppression",{defaultMessage:"Registry write suppression improves system performance by enabling Endpoint to tell its driver that certain types of registry operations are uninteresting. Once deemed uninteresting, the driver can quickly drop these events, improving system responsiveness and reducing Endpoint CPU usage. Use this setting only for troubleshooting if registry events are not functioning as expected. Default: false"})},{key:"windows.advanced.events.process.creation_flags",first_supported_version:"8.13.0",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.process.creation_flags",{defaultMessage:"Enables an additional enrichment for process events. Use this setting only for troubleshooting if process events are not functioning as expected. Default: true"})},{key:"windows.advanced.events.memory_scan",first_supported_version:"8.14",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.memory_scan",{defaultMessage:"On behavior alerts, this feature enables an additional scan of identified memory regions against well-known malware signatures. Default: true"})},{key:"windows.advanced.flags",first_supported_version:"8.13.0",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.flags",{defaultMessage:"A comma-separated list of feature flags. Currently no feature flags are supported."})},{key:"windows.advanced.artifacts.global.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.ca_cert",{defaultMessage:"PEM-encoded certificate for security artifacts server certificate authority."})},{key:"mac.advanced.artifacts.global.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.ca_cert",{defaultMessage:"PEM-encoded certificate for security artifacts server certificate authority."})},{key:"linux.advanced.artifacts.global.ca_cert",first_supported_version:"7.9",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.ca_cert",{defaultMessage:"PEM-encoded certificate for security artifacts server certificate authority."})},{key:"windows.advanced.events.event_on_access.file_paths",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.event_on_access.file_paths",{defaultMessage:"Comma-separated list of additional wildcard patterns that will be monitored for read access. Endpoint will report at most one match per pattern per process. Endpoint will attempt to convert drive letters to NT paths (e.g. \\\\Device\\\\HarddiskVolume4), but conversion will fail for per-user drives such as network drives. Put only commas (no spaces) between entries. Wildcard matching is case-insensitive. See Microsoft FsRtlIsNameInExpression documentation for wildcard matching rules."})},{key:"windows.advanced.events.event_on_access.registry_paths",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.event_on_access.registry_paths",{defaultMessage:"Comma-separated list of registry paths that will be monitored for read access. These must be NT paths (e.g. \\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Microsoft\\\\...). Endpoint will report at most one match per pattern per process. Put only commas (no spaces) between entries. Wildcard matching is case-insensitive. See Microsoft FsRtlIsNameInExpression documentation for wildcard matching rules."})},{key:"mac.advanced.events.event_on_access.file_paths",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.events.event_on_access.file_paths",{defaultMessage:"Comma-separated list of additional wildcard patterns that will be monitored for read access.  Put only commas (no spaces) between entries. Wildcard matching is case-insensitive."})},{key:"mac.advanced.events.deduplicate_network_events",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.events.deduplicate_network_events",{defaultMessage:"A value of 'false' disables network events deduplication. Default: true"})},{key:"windows.advanced.events.deduplicate_network_events",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.deduplicate_network_events",{defaultMessage:"A value of 'false' disables network events deduplication. Default: true"})},{key:"linux.advanced.events.deduplicate_network_events",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.events.deduplicate_network_events",{defaultMessage:"A value of 'false' disables network events deduplication. Default: true"})},{key:"mac.advanced.events.deduplicate_network_events_below_bytes",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.events.deduplicate_network_events_below_bytes",{defaultMessage:"Deduplication transfer threshold in bytes. Events exceeding the transfer will not be deduplicated. A value '0' means disabled. Default: 1048576 (1MB)"})},{key:"windows.advanced.events.deduplicate_network_events_below_bytes",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.deduplicate_network_events_below_bytes",{defaultMessage:"Deduplication transfer threshold in bytes. Events exceeding the transfer will not be deduplicated. A value '0' means disabled. Default: 1048576 (1MB)"})},{key:"linux.advanced.events.deduplicate_network_events_below_bytes",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.events.deduplicate_network_events_below_bytes",{defaultMessage:"Deduplication transfer threshold in bytes. Events exceeding the transfer will not be deduplicated. A value '0' means disabled. Default: 1048576 (1MB)"})},{key:"windows.advanced.events.registry.enforce_registry_filters",first_supported_version:"8.15",documentation:r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.registry.enforce_registry_filters",{defaultMessage:"Reduce data volume by filtering out registry events which are not relevant to behavioral protections.  Default: true"})}],Me=r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.calloutTitle",{defaultMessage:"Proceed with caution!"}),Ce=r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.warningMessage",{defaultMessage:"This section contains policy values that support advanced use cases. If not configured\n    properly, these values can cause unpredictable behavior. Please consult documentation\n    carefully or contact support before editing these values."}),je=r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.hide",{defaultMessage:"Hide"}),De=r.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.show",{defaultMessage:"Show"}),Oe=Object(s.memo)((({policy:e,mode:t,onChange:a,"data-test-subj":n})=>{const i=Object(f.a)(n),[r,c]=Object(s.useState)(!1),d=Object(N.b)().isPlatinumPlus(),u="edit"===t,p=Object(s.useCallback)((()=>{c((e=>!e))}),[]),v=Object(s.useCallback)((t=>{const n=Object(m.cloneDeep)(e);!function(e,t,a){let n=e;for(let e=0;e<a.length-1;e++)n[a[e]]||(n[a[e]]={}),n=n[a[e]];if(n[a[a.length-1]]=t,""===t||void 0===t){n=e;for(let t=a.length;t>=0;t--){const i=a.slice(0,t);for(let e=0;e<i.length-1;e++)n=n[i[e]];if(void 0!==n[i[i.length-1]]&&""!==n[i[i.length-1]]&&0!==Object.keys(n[i[i.length-1]]).length)break;"advanced"===i[i.length-1]?n[i[i.length-1]]=void 0:delete n[i[i.length-1]],n=e}}}(n,t.target.value,t.target.name.split(".")),a({isValid:!0,updatedPolicy:n})}),[a,e]);return o.a.createElement("div",{"data-test-subj":i()},o.a.createElement(l.EuiButtonEmpty,{"data-test-subj":i("showButton"),onClick:p},o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced.showHideButtonLabel",defaultMessage:"{action} advanced settings",values:{action:r?je:De}})),o.a.createElement(l.EuiSpacer,{size:"l"}),r&&o.a.createElement("div",null,u&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiCallOut,{title:Me,color:"warning",iconType:"warning","data-test-subj":i("warning")},o.a.createElement("p",null,Ce)),o.a.createElement(l.EuiSpacer,null)),o.a.createElement(l.EuiText,{size:"xs",color:"subdued"},o.a.createElement("h4",null,o.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced",defaultMessage:"Advanced settings"}))),o.a.createElement(l.EuiPanel,{"data-test-subj":i("settings"),paddingSize:"s"},Se.map((({key:t,documentation:a,first_supported_version:n,last_supported_version:s,license:r},c)=>{if(!d&&"platinum"===r)return o.a.createElement(o.a.Fragment,{key:t});const p=t.split("."),m=function(e,t){let a=e;for(let e=0;e<t.length-1;e++){if(!a[t[e]])return"";a=a[t[e]]}return a[t[t.length-1]]}(e,p);return o.a.createElement(l.EuiFormRow,{key:t,fullWidth:!0,"data-test-subj":i(`${t}-container`),label:o.a.createElement(l.EuiFlexGroup,{responsive:!1},o.a.createElement(l.EuiFlexItem,{grow:!0,"data-test-subj":i(`${t}-label`)},t),a&&o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiIconTip,{content:a,position:"right",anchorProps:{"data-test-subj":i(`${t}-tooltipIcon`)}}))),labelAppend:o.a.createElement(l.EuiText,{size:"xs","data-test-subj":i(`${t}-versionInfo`)},s?`${n}-${s}`:`${n}+`)},u?o.a.createElement(l.EuiFieldText,{"data-test-subj":t,fullWidth:!0,name:t,value:m,onChange:v}):o.a.createElement(l.EuiText,{size:"xs","data-test-subj":i(`${t}-viewValue`)},m||Object(C.e)()))})))))}));Oe.displayName="AdvancedSection";const Ie=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.protections",{defaultMessage:"Protections"}),Pe=r.i18n.translate("xpack.securitySolution.endpoint.policy.details.settings",{defaultMessage:"Settings"}),Ae=Object(s.memo)((e=>{const t=Object(f.a)(e["data-test-subj"]),a=Object(u.a)(),n=({isValid:t,updatedPolicy:a})=>{(e=>{const t={[c.a.enabled]:!0,[c.a.disabled]:!1,[c.a.sync]:d(e)},a=e.windows.antivirus_registration.mode;var n;a&&(e.windows.antivirus_registration.enabled=null!==(n=t[a])&&void 0!==n&&n)})(a),e.onChange({isValid:t,updatedPolicy:a})};return o.a.createElement("div",{"data-test-subj":t()},o.a.createElement(Fe,null,Ie),o.a.createElement(l.EuiSpacer,{size:"s"}),a&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(a,null),o.a.createElement(l.EuiSpacer,{size:"l"})),!a&&o.a.createElement(o.a.Fragment,null,o.a.createElement(pe,null),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(xe,i()({},e,{onChange:n,"data-test-subj":t("malware")})),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(ye,i()({},e,{"data-test-subj":t("ransomware")})),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(ue,i()({},e,{"data-test-subj":t("memory")})),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(re,i()({},e,{"data-test-subj":t("behaviour")})),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(G,i()({},e,{"data-test-subj":t("attackSurface")})),o.a.createElement(l.EuiSpacer,{size:"l"})),o.a.createElement(Fe,null,Pe),o.a.createElement(l.EuiSpacer,{size:"s"}),o.a.createElement(z,i()({},e,{"data-test-subj":t("windowsEvents")})),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(T,i()({},e,{"data-test-subj":t("macEvents")})),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(A,i()({},e,{"data-test-subj":t("linuxEvents")})),o.a.createElement(l.EuiSpacer,{size:"l"}),o.a.createElement(M,i()({},e,{onChange:n,"data-test-subj":t("antivirusRegistration")})),o.a.createElement(l.EuiSpacer,{size:"m"}),o.a.createElement(Oe,i()({},e,{"data-test-subj":t("advancedSection")})))}));Ae.displayName="PolicySettingsForm";const Fe=Object(s.memo)((({children:e})=>o.a.createElement(l.EuiText,{size:"xs",color:"subdued"},o.a.createElement("h4",null,e))));Fe.displayName="FormSectionTitle"},208:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return c}));var n=a(2),i=a(8),s=a.n(i),o=a(452);const l=e=>{const t=Object(o.b)(),a=s()(t.sections$,t.getSectionsValue());return Object(n.useMemo)((()=>{var t;return null!==(t=null==a?void 0:a.get(e))&&void 0!==t?t:null}),[e,a])},r=e=>{const t=Object(o.b)(),a=s()(t.messages$,t.getMessagesValue());return Object(n.useMemo)((()=>{var t;return null!==(t=null==a?void 0:a.get(e))&&void 0!==t?t:null}),[e,a])},c=e=>{const t=Object(o.b)(),a=Object(n.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=a?a:null}},2124:function(e,t,a){"use strict";a.r(t),a.d(t,"EndpointPolicyEditExtension",(function(){return W}));var n=a(2),i=a.n(n),s=a(19),o=a(42),l=a(7),r=a(140),c=a(4);const d={artifactsSummaryApiError:e=>c.i18n.translate("xpack.securitySolution.endpoint.fleetIntegrationCard.blocklistsSummary.error",{defaultMessage:'There was an error trying to fetch blocklist stats: "{error}"',values:{error:e}}),cardTitle:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.blocklist.fleetIntegration.title",defaultMessage:"Blocklist"}),linkLabel:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetIntegrationCard.blocklistsManageLabel",defaultMessage:"Manage blocklist"})},u={artifactsSummaryApiError:e=>c.i18n.translate("xpack.securitySolution.endpoint.fleetIntegrationCard.hostIsolationExceptionsSummary.error",{defaultMessage:'There was an error trying to fetch host isolation exceptions stats: "{error}"',values:{error:e}}),cardTitle:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationExceptions.fleetIntegration.title",defaultMessage:"Host isolation exceptions"}),linkLabel:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetIntegrationCard.hostIsolationExceptionsManageLabel",defaultMessage:"Manage host isolation exceptions"})},p={artifactsSummaryApiError:e=>c.i18n.translate("xpack.securitySolution.endpoint.fleetIntegrationCard.eventFiltersSummary.error",{defaultMessage:'There was an error trying to fetch event filters stats: "{error}"',values:{error:e}}),cardTitle:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.eventFilters.fleetIntegration.title",defaultMessage:"Event filters"}),linkLabel:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetIntegrationCard.eventFiltersManageLabel",defaultMessage:"Manage event filters"})},m={artifactsSummaryApiError:e=>c.i18n.translate("xpack.securitySolution.endpoint.fleetIntegrationCard.trustedAppsSummary.error",{defaultMessage:'There was an error trying to fetch trusted apps stats: "{error}"',values:{error:e}}),cardTitle:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.trustedApps.fleetIntegration.title",defaultMessage:"Trusted applications"}),linkLabel:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetIntegrationCard.trustedAppsManageLabel",defaultMessage:"Manage trusted applications"})};var f=a(1589),y=a(1356),v=a(1238),g=a(602),b=a(1585),_=a(265),h=a(1237),w=a(67),k=a(95),x=a(118),E=a(1590),S=a(1591),M=a(1592),C=a(361),j=a(126);const D={artifactsSummaryApiError:e=>c.i18n.translate("xpack.securitySolution.endpoint.fleetIntegrationCard.artifactsSummary.error",{defaultMessage:'There was an error trying to fetch artifacts stats: "{error}"',values:{error:e}}),cardTitle:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetIntegrationCard.title",defaultMessage:"Artifacts"}),linkLabel:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetIntegrationCard.artifactsManageLabel",defaultMessage:"Manage artifacts"})},O=Object(n.memo)((({policyId:e,artifactApiClientInstance:t,getArtifactsPath:a,searchableFields:o,labels:l=D,privileges:r=!0,"data-test-subj":d})=>{const u=Object(x.n)(),{getAppUrl:p}=Object(x.c)(),m=a(e),f=Object(j.a)(d),{data:y}=Object(C.g)(t,{policies:[e,"all"]},o,{onError:e=>{u.addDanger(l.artifactsSummaryApiError(e.message))}}),v=Object(n.useMemo)((()=>{const t=`#${k.pagePathGetters.integration_policy_edit({packagePolicyId:e})[1]}`;return{backLink:{label:c.i18n.translate("xpack.securitySolution.endpoint.fleetIntegrationCard.artifacts.backButtonLabel",{defaultMessage:"Back to Fleet integration policy"}),navigateTo:[w.INTEGRATIONS_PLUGIN_ID,{path:t}],href:p({appId:w.INTEGRATIONS_PLUGIN_ID,path:t})}}}),[p,e]),g=Object(n.useMemo)((()=>i.a.createElement(S.a,{href:p({path:m}),appPath:m,appState:v,"data-test-subj":f("link-to-exceptions"),size:"m"},l.linkLabel)),[p,f,l.linkLabel,m,v]);return void 0===y&&!r||0===(null==y?void 0:y.total)&&!r?null:i.a.createElement(s.EuiPanel,{hasShadow:!1,paddingSize:"l",hasBorder:!0,"data-test-subj":f("fleet-integration-card")},i.a.createElement(s.EuiFlexGroup,{alignItems:"baseline",justifyContent:"flexStart",gutterSize:"s",direction:"row",responsive:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiText,null,i.a.createElement("h5",null,l.cardTitle))),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(E.a,{stats:y,isSmall:!0})),i.a.createElement(M.c,{grow:1},g)))}));O.displayName="FleetIntegrationArtifactsCard";var I=a(603),P=a(948),A=a(1317);const F=Object(n.memo)((({policyId:e})=>{const t=Object(x.i)(),a=Object(n.useMemo)((()=>b.a.getInstance(t)),[t]),{canReadPolicyManagement:s}=Object(r.a)().endpointPrivileges,o=Object(n.useCallback)((()=>s?Object(_.o)(e):Object(_.p)({includedPolicies:`${e},global`})),[s,e]);return i.a.createElement(O,{policyId:e,artifactApiClientInstance:a,getArtifactsPath:o,searchableFields:h.a,labels:m,"data-test-subj":"trustedApps"})}));F.displayName="TrustedAppsPolicyCard";const T=Object(n.memo)((({policyId:e})=>{const t=Object(x.i)(),a=Object(n.useMemo)((()=>g.a.getInstance(t)),[t]),{canReadPolicyManagement:s}=Object(r.a)().endpointPrivileges,o=Object(n.useCallback)((()=>s?Object(_.l)(e):Object(_.f)({includedPolicies:`${e},global`})),[s,e]);return i.a.createElement(O,{policyId:e,artifactApiClientInstance:a,getArtifactsPath:o,searchableFields:I.d,labels:p,"data-test-subj":"eventFilters"})}));T.displayName="EventFiltersPolicyCard";const L=Object(n.memo)((({policyId:e})=>{const t=Object(x.i)(),a=Object(n.useMemo)((()=>v.a.getInstance(t)),[t]),{canReadPolicyManagement:s}=Object(r.a)().endpointPrivileges,o=Object(n.useCallback)((()=>s?Object(_.m)(e):Object(_.g)({includedPolicies:`${e},global`})),[s,e]);return i.a.createElement(O,{policyId:e,artifactApiClientInstance:a,getArtifactsPath:o,searchableFields:P.b,labels:u,"data-test-subj":"hostIsolationExceptions"})}));L.displayName="HostIsolationExceptionsPolicyCard";const z=Object(n.memo)((({policyId:e})=>{const t=Object(x.i)(),a=Object(n.useMemo)((()=>y.a.getInstance(t)),[t]),{canReadPolicyManagement:s}=Object(r.a)().endpointPrivileges,o=Object(n.useCallback)((()=>s?Object(_.i)(e):Object(_.c)({includedPolicies:`${e},global`})),[s,e]);return i.a.createElement(O,{policyId:e,artifactApiClientInstance:a,getArtifactsPath:o,searchableFields:A.b,labels:d,"data-test-subj":"blocklists"})}));z.displayName="BlocklistPolicyCard";const N=Object(n.memo)((({policyId:e})=>{const{loading:t,canReadBlocklist:a,canReadEventFilters:n,canReadTrustedApplications:l,canReadHostIsolationExceptions:c}=Object(r.a)().endpointPrivileges,d=Object(f.a)();return t?i.a.createElement(s.EuiSkeletonText,{lines:4}):d?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,i.a.createElement(s.EuiText,null,i.a.createElement("h5",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.artifacts.title",defaultMessage:"Artifacts"}))),i.a.createElement(s.EuiSpacer,{size:"s"}),l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(F,{policyId:e}),i.a.createElement(s.EuiSpacer,{size:"s"})),n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(T,{policyId:e}),i.a.createElement(s.EuiSpacer,{size:"s"})),c&&i.a.createElement(i.a.Fragment,null,i.a.createElement(L,{policyId:e}),i.a.createElement(s.EuiSpacer,{size:"s"})),a&&i.a.createElement(z,{policyId:e})),i.a.createElement(s.EuiSpacer,{size:"l"})):null}));N.displayName="EndpointPolicyArtifactCards";var R=a(1605);const W=Object(n.memo)((({policy:e,onChange:t,newPolicy:a})=>{const c=a,d=c.inputs[0].config.policy.value,{canAccessFleet:u}=Object(r.a)().endpointPrivileges,p=Object(n.useCallback)((({isValid:e,updatedPolicy:a})=>{const n=Object(l.cloneDeep)(c.inputs);n[0].config.policy.value=a,t({isValid:e,updatedPolicy:{inputs:n}})}),[t,c.inputs]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement("div",{"data-test-subj":"endpointIntegrationPolicyForm"},i.a.createElement(N,{policyId:e.id}),i.a.createElement("div",null,i.a.createElement(s.EuiText,null,i.a.createElement("h5",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.settings.title",defaultMessage:"Policy settings"}))),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(R.a,{policy:d,onChange:p,mode:u?"edit":"view","data-test-subj":"endpointPolicyForm"}))))}));W.displayName="EndpointPolicyEditExtension"},237:function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return r}));var n=a(4),i=a(1870);n.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),n.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),n.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),n.i18n.translate("xpack.securitySolution.eventFiltersTab",{defaultMessage:"Event filters"});const s={[i.c.WINDOWS]:n.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[i.c.MAC]:n.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[i.c.LINUX]:n.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})},o=e=>n.i18n.translate("xpack.securitySolution.exceptions.failedLoadPolicies",{defaultMessage:'There was an error loading policies: "{error}"',values:{error:e.message}}),l={isolate:{title:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.title",{defaultMessage:"Isolate"}),about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.about",{defaultMessage:"Isolate the host"}),privileges:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.privileges",{defaultMessage:"Insufficient privileges to isolate hosts. Contact your Kibana administrator if you think you should have this permission."})},release:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.release.about",{defaultMessage:"Release the host"})},killProcess:{title:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.title",{defaultMessage:"Kill process"}),about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.about",{defaultMessage:"Kill/terminate a process"}),privileges:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.privileges",{defaultMessage:"Insufficient privileges to kill process. Contact your Kibana administrator if you think you should have this permission."}),args:{pid:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.pid.arg.comment",{defaultMessage:"A PID representing the process to kill"})},entityId:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.entityId.arg.comment",{defaultMessage:"An entity id representing the process to kill"})}}},suspendProcess:{title:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.title",{defaultMessage:"Suspend process"}),about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.about",{defaultMessage:"Temporarily suspend a process"}),privileges:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.privileges",{defaultMessage:"Insufficient privileges to supend process. Contact your Kibana administrator if you think you should have this permission."}),args:{pid:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.pid.arg.comment",{defaultMessage:"A PID representing the process to suspend"})},entityId:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.entityId.arg.comment",{defaultMessage:"An entity id representing the process to suspend"})}}},status:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.status.about",{defaultMessage:"Show host status information"})},processes:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.processes.about",{defaultMessage:"Show all running processes"})},getFile:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.getFile.about",{defaultMessage:"Retrieve a file from the host"}),args:{path:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.getFile.pathArgAbout",{defaultMessage:"The full file path to be retrieved"})}}},execute:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.about",{defaultMessage:"Execute a command on the host"}),args:{timeout:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.args.timeout.about",{defaultMessage:"The timeout in units of time (h for hours, m for minutes, s for seconds) for the endpoint to wait for the script to complete. Example: 37m. If not given, it defaults to 4 hours."})}}},upload:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.upload.about",{defaultMessage:"Upload a file to the host"}),args:{file:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.upload.args.file.about",{defaultMessage:"The file that will be sent to the host"})},overwrite:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.upload.args.overwrite.about",{defaultMessage:"Overwrite the file on the host if it already exists"})}}},scan:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.scan.about",{defaultMessage:"Scan the host for malware"}),args:{path:{about:n.i18n.translate("xpack.securitySolution.endpointConsoleCommands.scan.args.path.about",{defaultMessage:"The absolute path to a file or directory to be scanned"})}}}},r=e=>({title:n.i18n.translate("xpack.securitySolution.artifacts.confirmWarningModal.title",{defaultMessage:"Confirm {type}",values:{type:e}}),body:n.i18n.translate("xpack.securitySolution.artifacts.confirmWarningModal.body",{defaultMessage:'Using a "*" or a "?" in the value with the "is" operator can make the entry ineffective. Change the operator to "matches" to ensure wildcards run properly. Select â€œCancelâ€ to revise your entry, or "Add" to continue with the entry in its current state.'}),confirmButton:n.i18n.translate("xpack.securitySolution.artifacts.confirmWarningModal.confirmButtonText",{defaultMessage:"Add"}),cancelButton:n.i18n.translate("xpack.securitySolution.trustedapps.confirmWarningModal.cancelButtonText",{defaultMessage:"Cancel"})})},452:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(2),i=a.n(n);const s=i.a.createContext(null),o=Object(n.memo)((({upsellingService:e,children:t})=>i.a.createElement(s.Provider,{value:e},t)));o.displayName="UpsellingProvider";const l=()=>{const e=Object(n.useContext)(s);if(!e)throw new Error("UpsellingProviderContext not found");return e}},525:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(208);const i=()=>Object(n.a)("endpointPolicyProtections")},818:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(269),i=a(1342);const s=e=>Object(n.flow)(d,c)(e),o=e=>Object(n.flow)(c)(e),l=e=>Object(n.flow)(r)(e),r=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(i.a)({...e,entries:e.entries.map((e=>Object(i.a)(e)))}):Object(i.a)(e)));return{...e,entries:t}},c=e=>{const{entries:t}=e,a=t.map((e=>"nested"===e.type?Object(i.b)({...e,entries:e.entries.map((e=>Object(i.b)(e)))}):Object(i.b)(e)));return{...e,entries:a}},d=e=>{const{comments:t}=e;if(!t||!t.length)return e;const a=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:a}}},948:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(1334),i=a(168);const s=["item_id","name","description","entries.value"],o={name:i.j,namespace_type:"agnostic",description:i.h,list_id:i.i,type:n.a.ENDPOINT_HOST_ISOLATION_EXCEPTIONS}}}]);