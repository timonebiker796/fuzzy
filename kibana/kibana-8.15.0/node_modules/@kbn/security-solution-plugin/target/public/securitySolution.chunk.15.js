/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[15,28],{122:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(45),i=n(14);const r=Object(i.b)(),l=e=>{const t=o();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},o=()=>Object(a.useSelector)((({app:{enableExperimental:e}})=>e))},124:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return o}));var a=n(45),i=n(188),r=n.n(i);const l=e=>Object(a.useSelector)(e,a.shallowEqual),o=e=>Object(a.useSelector)(e,r.a)},131:function(e,t,n){"use strict";n.r(t),n.d(t,"parseRoute",(function(){return v})),n.d(t,"manageOldSiemRoutes",(function(){return O})),n.d(t,"getInspectResponse",(function(){return y})),n.d(t,"isDetectionsPath",(function(){return j})),n.d(t,"isDashboardViewPath",(function(){return h})),n.d(t,"isTourPath",(function(){return S})),n.d(t,"isThreatIntelligencePath",(function(){return k})),n.d(t,"getSubPluginRoutesByCapabilities",(function(){return I})),n.d(t,"isSubPluginAvailable",(function(){return w})),n.d(t,"getFieldKey",(function(){return x})),n.d(t,"getField",(function(){return N})),n.d(t,"isTimelineScope",(function(){return P})),n.d(t,"isInTableScope",(function(){return D})),n.d(t,"isAlertsPageScope",(function(){return C})),n.d(t,"getScopedActions",(function(){return R})),n.d(t,"getScopedSelectors",(function(){return A})),n.d(t,"isActiveTimeline",(function(){return F})),n.d(t,"getSourcererScopeId",(function(){return q}));var a=n(748),i=n(44),r=n(2),l=n.n(r),o=n(48),c=n(1630),s=n(1799),u=n(7),d=n(5),p=n(528),b=n(156),m=n(129),f=n(149),g=n(127);const v=e=>{if(!Object(i.isEmpty)(e.hash)){var t;const n=e.hash.split("?"),a=n.length>=1?`?${n[1]}`:"",i=n.length>0?n[0].split("/"):[];return{pageName:i.length>=1?i[1]:"",path:`/${null!==(t=i.slice(2).join("/"))&&void 0!==t?t:""}${a}`,search:a}}const n=e.search,a=e.pathname.split("/");return{pageName:a[3],path:`${a.length>4?`/${a.slice(4).join("/")}`:""}${n}`,search:n}},O=async e=>{const{application:t}=e,{pageName:n,path:a}=v(window.location);switch(n){case b.a.overview:t.navigateToApp(d.m,{deepLinkId:b.a.overview,replace:!0,path:a});break;case"ml-hosts":t.navigateToApp(d.m,{deepLinkId:b.a.hosts,replace:!0,path:`/ml-hosts${a}`});break;case b.a.hosts:t.navigateToApp(d.m,{deepLinkId:b.a.hosts,replace:!0,path:a});break;case"ml-network":t.navigateToApp(d.m,{deepLinkId:b.a.network,replace:!0,path:`/ml-network${a}`});break;case b.a.network:t.navigateToApp(d.m,{deepLinkId:b.a.network,replace:!0,path:a});break;case b.a.timelines:t.navigateToApp(d.m,{deepLinkId:b.a.timelines,replace:!0,path:a});break;case b.a.case:case"case":t.navigateToApp(d.m,{deepLinkId:b.a.case,replace:!0,path:a});break;case b.a.detections:case b.a.alerts:t.navigateToApp(d.m,{deepLinkId:b.a.alerts,replace:!0,path:a});break;case b.a.rules:t.navigateToApp(d.m,{deepLinkId:b.a.rules,replace:!0,path:a});break;case b.a.exceptions:t.navigateToApp(d.m,{deepLinkId:b.a.exceptions,replace:!0,path:a});break;default:t.navigateToApp(d.m,{deepLinkId:b.a.landing,replace:!0,path:a})}},y=(e,t)=>({dsl:Object(u.isObject)(null==e?void 0:e.inspect)&&null!=e&&e.inspect.dsl?e.inspect.dsl:(null==t?void 0:t.dsl)||[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}),j=e=>!!Object(o.matchPath)(e,{path:`(${d.d}|${d.Cc}|${d.Db})`,strict:!1}),h=e=>null!=Object(o.matchPath)(e,{path:`${d.B}/:detailName`,exact:!1,strict:!1}),S=e=>(e=>!!Object(o.matchPath)(e,{path:`${d.d}`,strict:!1}))(e)||(e=>!!Object(o.matchPath)(e,{path:`${d.x}/:detailName`,strict:!1}))(e),k=e=>!!Object(o.matchPath)(e,{path:`(${d.Pc})`,strict:!1}),I=(e,t)=>Object.entries(e).reduce(((e,[n,a])=>{if(w(n,t.application.capabilities))e.push(...a.routes);else{const i=e=>e.siem.privileges;e.push(...a.routes.map((e=>({path:e.path,component:()=>{const e=t.upselling.getPageUpselling(n);return e?l.a.createElement(e,null):l.a.createElement(p.b,{pageName:n,docLinkSelector:i})}}))))}return e}),[]),w=(e,t)=>"cases"===e?!0===t[d.w].read_cases:!0===t[d.Lc].show,T={[a.y]:"signal.rule.id",[a.r]:"signal.rule.name",[`${a.t}.filters`]:"signal.rule.filters",[`${a.t}.language`]:"signal.rule.language",[`${a.t}.query`]:"signal.rule.query"},E={"signal.rule.id":a.y,"signal.rule.name":a.r,"signal.rule.filters":`${a.t}.filters`,"signal.rule.language":`${a.t}.language`,"signal.rule.query":`${a.t}.query`},x=(e,t)=>{var n,a;const r=(null!==(n=E[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),l=(null!==(a=T[t])&&void 0!==a?a:t).replace("kibana.alert","signal");return Object(i.has)(r,e)?r:l},N=(e,t)=>{var n,a,r;const l=(null!==(n=E[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),o=(null!==(a=T[t])&&void 0!==a?a:t).replace("kibana.alert","signal"),c=l.split(".");if(c.includes("parameters")&&"parameters"!==c[c.length-1]){const t=c.slice(0,c.length-1).join("."),n=Object(i.get)(t,e);return Object(i.get)(c[c.length-1],n)}return null!==(r=Object(i.get)(l,e))&&void 0!==r?r:Object(i.get)(o,e)},P=e=>Object.values(f.f).includes(e),D=e=>Object.values(c.b).includes(e),C=e=>[c.b.alertsOnAlertsPage,c.b.alertsOnRuleDetailsPage,c.b.alertsOnCasePage].includes(e),R=e=>P(e)?m.a:D(e)?s.a:void 0,A=e=>P(e)?m.a:D(e)?s.a:void 0,F=e=>e===f.f.active,q=e=>P(e)?g.SourcererScopeName.timeline:C(e)?g.SourcererScopeName.detections:g.SourcererScopeName.default},156:function(e,t,n){"use strict";var a=n(5);n.d(t,"a",(function(){return a.Oc}))},184:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"d",(function(){return k})),n.d(t,"c",(function(){return I})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return E})),n.d(t,"b",(function(){return B})),n.d(t,"g",(function(){return Q}));var a=n(979),i=n(44),r=n(50),l=n(413),o=n.n(l),c=n(45),s=n(2),u=n(513),d=n(121),p=n(146),b=n(556),m=n(158),f=n(243),g=n(179),v=n(705),O=n(396),y=n(292),j=n(274),h=n(129);const S="open-timeline",k=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,I=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),w=({title:e})=>null==e||0===e.trim().length,T=(e,t)=>"__typename"===e?void 0:t,E=e=>JSON.parse(JSON.stringify(e),T),x=e=>{try{return JSON.parse(e)}catch{return e}},N=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:x(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:x(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:x(e.meta.value)}:{}},...null!=e.exists?{exists:x(e.exists)}:{},...null!=e.match_all?{exists:x(e.match_all)}:{},...null!=e.missing?{exists:x(e.missing)}:{},...null!=e.query?{query:x(e.query)}:{},...null!=e.range?{range:x(e.range)}:{},...null!=e.script?{exists:x(e.script)}:{}}),P=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},D=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},C=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},R=(e,t,n)=>n===d.m.default&&e.timelineType===d.m.template?e.templateTimelineId:t&&e.timelineType===d.m.template?Object(r.v4)():e.templateTimelineId,A=({and:e,...t})=>t.type===d.a.template?o()(t,{type:d.a.default,enabled:t.queryMatch.operator!==g.d,queryMatch:{value:t.queryMatch.operator===g.d?"":t.queryMatch.value}}):t,F=(e,t,n)=>e&&t&&n===d.m.default?t.map((e=>{var t,n;return{...A(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(A))&&void 0!==t?t:[]}})):t,q=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",L=(e,t,n)=>n&&e.timelineType!==n?d.l.draft:t?d.l.active:e.status,M=(e,t,n,i)=>{const r=e.timelineType===d.m.template,l=i?f.b:j.a,o={...e,columns:null!=e.columns?e.columns.map((e=>((e,t)=>{var n;return Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:f.a,id:null!=e.id?e.id:"unknown",initialWidth:null===(n=t.find((t=>e.id===t.id)))||void 0===n?void 0:n.initialWidth})})(e,l))):l,defaultColumns:l,dateRange:e.status===d.l.immutable&&e.timelineType===d.m.template?{start:O.a.toISOString(),end:O.b.toISOString()}:e.dateRange,dataProviders:F(t,e.dataProviders,n),excludedRowRendererIds:r?[]:Object.keys(d.e),eventIdToNoteIds:P(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(N):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:C(t,e.pinnedEventIds),pinnedEventsSaveObject:D(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:L(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:q(e,t,n),templateTimelineId:R(e,t,n),templateTimelineVersion:t&&r?1:e.templateTimelineVersion};return Object.entries(o).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...m.b,id:""})},B=(e,t=!1,n,a)=>{const{notes:i,...r}=e;return{notes:i,timeline:M(r,t,n,a)}},Q=()=>{const{resetDiscoverAppState:e}=Object(u.a)(),t=Object(b.a)(),n=Object(c.useDispatch)(),a=Object(s.useCallback)((e=>n(h.a.updateIsLoading(e))),[n]);return({activeTimelineTab:n=p.d.query,duplicate:r=!1,graphEventId:l="",timelineId:o,timelineType:c,onError:s,onOpenTimeline:u,openTimeline:b=!0,savedSearchId:g,unifiedComponentsInTimelineDisabled:h=!1})=>{if(a({id:p.c.active,isLoading:!0}),null!=o)return Promise.resolve(Object(y.j)(o)).then((a=>{const o=Object(i.getOr)(null,"data",a);if(!o)return;const s=E(o.timeline),{timeline:d,notes:m}=B(s,r,c,h);if(null!=u)u(d);else if(t){const{from:a,to:c}=Object(v.a)({from:Object(i.getOr)(null,"dateRange.start",d),to:Object(i.getOr)(null,"dateRange.end",d)});return t({duplicate:r,from:a,id:p.c.active,notes:m,resolveTimelineConfig:{outcome:o.outcome,alias_target_id:o.alias_target_id,alias_purpose:o.alias_purpose},timeline:{...d,activeTab:n,graphEventId:l,show:b,dateRange:{start:a,end:c},savedSearchId:d.savedSearchId},to:c,preventSettingQuery:!0}),e(d.savedSearchId)}})).catch((e=>{null!=s&&s(e,o)})).finally((()=>{a({id:p.c.active,isLoading:!1})}));t({id:p.c.active,duplicate:!1,notes:[],from:O.a.toISOString(),to:O.b.toISOString(),timeline:{...m.b,columns:h?f.b:j.a,id:p.c.active,activeTab:n,show:b,initialized:!0,savedSearchId:null!=g?g:null,excludedRowRendererIds:h||c===d.m.template?[]:m.b.excludedRowRendererIds}}),e(),a({id:p.c.active,isLoading:!1})}}},189:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return v}));var a=n(2),i=n(44),r=n(45),l=n(271),o=n.n(l),c=n(58),s=n(213),u=n(124),d=n(1361),p=n(246),b=n(21);const m=(e,t,n)=>{const i=Object(r.useDispatch)(),l=Object(s.g)(e);Object(a.useEffect)((()=>{const a=n&&""!==n?n:e,r=l();return i(d.a.registerUrlParam({key:a,initialValue:r})),t(r),()=>{i(d.a.deregisterUrlParam({key:a}))}}),[])},f=e=>{const t=Object(r.useDispatch)();return Object(a.useCallback)((n=>{t(d.a.updateUrlParam({key:e,value:n}))}),[t,e])},g=()=>{const e=Object(u.b)(d.c.selectGlobalUrlParam);return Object(a.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((n=>{const a=e[n];if(a&&("object"!=typeof a||!Object(i.isEmpty)(a)))try{t[n]=Object(c.encode)(a)}catch{}})),Object(s.b)(Object(i.pickBy)((e=>!Object(i.isEmpty)(e)),t))):""}),[e])},v=()=>{const[{pageName:e}]=Object(p.a)(),t=Object(u.b)(d.c.selectGlobalUrlParam),n=o()(t),r=Object(s.h)();Object(a.useEffect)((()=>{var a;const l=null!==(a=Object(b.b)(e))&&void 0!==a?a:{skipUrlState:!0},o={...t};l.skipUrlState&&Object.keys(o).forEach((e=>{o[e]=null})),Object(i.difference)(Object.keys(null!=n?n:{}),Object.keys(t)).forEach((e=>{o[e]=null})),Object.keys(o).length>0&&r(o)}),[n,t,e,r])}},196:function(e,t,n){"use strict";n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return m}));var a=n(19),i=n(41),r=n.n(i);const l=r.a.div.withConfig({displayName:"SecuritySolutionAppWrapper",componentId:"sc-2kezi3-0"})(["display:flex;flex-direction:column;flex:1 1 auto;width:100%;"]);l.displayName="SecuritySolutionAppWrapper";const o=()=>Object(i.css)([".euiOverlayMask[data-relative-to-header='below']{top:0 !important;}.euiFlyout{top:0 !important;height:100% !important;}"]),c=Object(i.createGlobalStyle)([".euiDataGridRowCell__popover{max-width:815px !important;max-height:none !important;overflow:hidden;.expandable-top-value-button{&.euiButtonEmpty:focus{background-color:transparent;}}&.euiPopover__panel[data-popover-open]{padding:8px 0;min-width:65px;}.euiPopoverFooter{border:0;margin-top:0;.euiFlexGroup{flex-direction:column;}}.euiText + .euiPopoverFooter{border-top:1px solid ",";margin-top:",";}}.euiPanel-loading-hide-border{border:none;}body.euiBody-hasOverlayMask{.euiDataGridRowCell__popover[data-popover-open],.withHoverActions__popover[data-popover-open]{visibility:hidden !important;}}.euiScreenReaderOnly{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeS)),s=r()(a.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-2kezi3-1"})(["",""],(({theme:e})=>`\n    word-break: break-word;\n    dt {\n      font-size: ${e.eui.euiFontSizeXS} !important;\n    }\n    dd {\n      width: fit-content;\n    }\n    dd > div {\n      width: fit-content;\n    }\n  `));s.displayName="DescriptionListStyled";const u=r()(a.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-2kezi3-2"})(["margin-left:5px;"]);u.displayName="CountBadge";const d=r.a.span.withConfig({displayName:"Spacer",componentId:"sc-2kezi3-3"})(["margin-left:5px;"]);d.displayName="Spacer";const p=r()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-2kezi3-4"})(["vertical-align:top;"]);p.displayName="Badge";const b=r()(a.EuiIcon).withConfig({displayName:"MoreRowItems",componentId:"sc-2kezi3-5"})(["margin-left:5px;"]);b.displayName="MoreRowItems";const m=r()(a.EuiFlexGroup).withConfig({displayName:"OverviewWrapper",componentId:"sc-2kezi3-6"})(["position:relative;.euiButtonIcon{position:absolute;right:",";top:6px;z-index:2;}"],(e=>e.theme.eui.euiSizeM));m.displayName="OverviewWrapper"},198:function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return D}));var a=n(189),i=n(45),r=n(2),l=n(138),o=n(118),c=n(148),s=n(183),u=n(44),d=n(122),p=n(705),b=n(346);var m=n(271),f=n.n(m),g=n(213),v=n(246);var O=n(58),y=n(149),j=n(184),h=n(169),S=n(129),k=n(124),I=n(48);const w=({search:e,urlKey:t})=>Object(g.d)(Object(g.e)(e),t);var T=n(1799),E=n(1630),x=n(1490),N=n(5);const P=()=>{Object(a.c)(),(()=>{const e=Object(i.useDispatch)(),{filterManager:t,savedQueries:n}=Object(o.j)().services.data.query,u=Object(r.useMemo)((()=>c.d.globalFiltersQuerySelector()),[]),d=Object(i.useSelector)(u),p=Object(r.useCallback)((t=>{null!=t&&e(s.b.setFilterQuery({id:l.a.global,query:t.query,language:t.language}))}),[e]),b=Object(r.useCallback)((n=>{null!=n?(t.setFilters(n),e(s.b.setSearchBarFilter({id:l.a.global,filters:n}))):(t.setAppFilters(d),e(s.b.setSearchBarFilter({id:l.a.global,filters:t.getFilters()})))}),[t,e,d]),m=Object(r.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],i=n.attributes.query;t.setFilters(a),e(s.b.setSearchBarFilter({id:l.a.global,filters:a})),e(s.b.setFilterQuery({id:l.a.global,...i})),e(s.b.setSavedQuery({id:l.a.global,savedQuery:n}))}))}),[e,t,n]);Object(a.b)(D.appQuery,p),Object(a.b)(D.filters,b),Object(a.b)(D.savedQuery,m)})(),(()=>{const e=Object(i.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),n=Object(r.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(u.get)("global.linkTo",e)},i=Object(u.get)("global.timerange.kind",e),r={linkTo:Object(u.get)("timeline.linkTo",e)},o=Object(u.get)("timeline.timerange.kind",e),c={linkTo:Object(u.get)("socTrends.linkTo",e)},d=Object(u.get)("socTrends.timerange.kind",e);if(n&&(Object(u.isEmpty)(c.linkTo)?t(s.b.removeLinkTo([l.a.global,l.a.socTrends])):t(s.b.addLinkTo([l.a.global,l.a.socTrends]))),Object(u.isEmpty)(a.linkTo)?(t(s.b.removeLinkTo([l.a.global,l.a.timeline])),n&&t(s.b.removeLinkTo([l.a.global,l.a.socTrends]))):(t(s.b.addLinkTo([l.a.global,l.a.timeline])),n&&t(s.b.addLinkTo([l.a.global,l.a.socTrends]))),Object(u.isEmpty)(r.linkTo)?t(s.b.removeLinkTo([l.a.global,l.a.timeline])):t(s.b.addLinkTo([l.a.global,l.a.timeline])),o){if("absolute"===o){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));t(s.b.setAbsoluteRangeDatePicker({...n,id:l.a.timeline}))}if("relative"===o){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));n.from=Object(b.c)(n.fromStr),n.to=Object(b.c)(n.toStr,{roundUp:!0}),t(s.b.setRelativeRangeDatePicker({...n,id:l.a.timeline}))}}if(i){if("absolute"===i){const n=Object(p.a)(Object(u.get)("global.timerange",e));t(s.b.setAbsoluteRangeDatePicker({...n,id:l.a.global}))}if("relative"===i){const n=Object(p.a)(Object(u.get)("global.timerange",e));n.from=Object(b.c)(n.fromStr),n.to=Object(b.c)(n.toStr,{roundUp:!0}),t(s.b.setRelativeRangeDatePicker({...n,id:l.a.global}))}}if(n&&d){if("absolute"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));t(s.b.setAbsoluteRangeDatePicker({...n,id:l.a.socTrends}))}if("relative"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));n.from=Object(b.c)(n.fromStr),n.to=Object(b.c)(n.toStr,{roundUp:!0}),t(s.b.setRelativeRangeDatePicker({...n,id:l.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(a.b)(D.timerange,n)})(),(()=>{const[{pageName:e}]=Object(v.a)(),t=Object(i.useDispatch)(),n=f()(e),a=Object(r.useMemo)((()=>c.d.inputsSelector()),[]),o=Object(i.useSelector)(a),{timerange:u}=o.global,{timerange:d}=o.timeline;Object(r.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(g.f)(e))(e,n)&&("relative"===d.kind&&t(s.b.setRelativeRangeDatePicker({...d,from:Object(b.c)(d.fromStr),to:Object(b.c)(d.toStr,{roundUp:!0}),id:l.a.timeline})),"relative"===u.kind&&t(s.b.setRelativeRangeDatePicker({...u,from:Object(b.c)(u.fromStr),to:Object(b.c)(u.toStr,{roundUp:!0}),id:l.a.global})))}),[e,n,t,d,u])})(),(()=>{const e=Object(d.a)("unifiedComponentsInTimelineDisabled"),t=Object(d.a)("timelineEsqlTabDisabled"),n=Object(j.g)(),l=Object(i.useSelector)((e=>Object(h.selectTimelineById)(e,y.f.active))),o=Object(r.useCallback)((a=>{null!=a&&n({activeTimelineTab:a.activeTab===y.g.esql&&t?y.g.query:a.activeTab,duplicate:!1,graphEventId:a.graphEventId,timelineId:a.id,openTimeline:a.isOpen,savedSearchId:a.savedSearchId,unifiedComponentsInTimelineDisabled:e})}),[t,n,e]);Object(r.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(D.timeline);if(!e)return;const t=Object(O.safeDecode)(e);(function(e,t){return e&&t&&(e.id!==t.id||e.savedSearchId!==t.savedSearchId||e.graphEventId!==t.graphEventId)})(l,t)||o(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[o,l]),Object(a.b)(D.timeline,o)})(),(()=>{const e=Object(a.d)(D.timeline),t=Object(r.useMemo)((()=>S.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:i,show:l,savedObjectId:o,savedSearchId:c}=Object(k.b)((e=>{var n;return null!==(n=t(e,y.f.active))&&void 0!==n?n:{}}));Object(r.useEffect)((()=>{const t={...o?{id:o}:{},isOpen:l,activeTab:n,graphEventId:null!=i?i:"",savedSearchId:c||void 0};e(t)}),[n,i,o,l,e,c])})(),(()=>{var e;const t=Object(r.useMemo)((()=>S.b.getTimelineByIdSelector()),[]),n=Object(k.b)((e=>t(e,y.f.active))),{search:a}=Object(I.useLocation)(),i=f()(a),l=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",o=Object(d.a)("unifiedComponentsInTimelineDisabled"),[c,s]=Object(r.useMemo)((()=>{const e=w({urlKey:D.timeline,search:null!=i?i:""}),t=w({urlKey:D.timeline,search:a});return null!=e&&null!=t?[Object(O.safeDecode)(e),Object(O.safeDecode)(t)]:[null,null]}),[i,a]),u=null==c?void 0:c.id,{id:p,activeTab:b,graphEventId:m}=s||{},g=Object(j.g)();Object(r.useEffect)((()=>{p&&p!==u&&p!==l&&g({activeTimelineTab:null!=b?b:y.g.query,duplicate:!1,graphEventId:m,timelineId:p,openTimeline:!0,unifiedComponentsInTimelineDisabled:o})}),[l,u,p,b,m,g,o])})(),(()=>{const{search:e}=Object(I.useLocation)(),t=Object(d.a)("expandableFlyoutDisabled"),[n,l]=Object(r.useState)(null),[o,c]=Object(r.useState)(!1),s=Object(i.useDispatch)(),u=T.b.getTableByIdSelector(),p=Object(k.b)((e=>{var t;return null!==(t=u(e,E.b.alertsOnAlertsPage))&&void 0!==t?t:x.d})),b=Object(r.useCallback)((e=>{t&&null!=e&&e.panelView&&l(e)}),[t]),m=Object(r.useCallback)((()=>{if(!t)return;const{initialized:e,isLoading:a,totalCount:i,additionalFilters:r}=p,l=e&&!a&&i>0;n&&(r&&r.showBuildingBlockAlerts||s(T.a.updateShowBuildingBlockAlertsFilter({id:E.b.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),l&&(c(!0),s(T.a.toggleDetailPanel({id:E.b.alertsOnAlertsPage,...n}))))}),[p,s,t,n]);Object(r.useEffect)((()=>{t&&!o&&m()}),[o,t,m]);const f=w({urlKey:D.eventFlyout,search:e});let g="",v="";t&&(f?(g=D.eventFlyout,v=D.flyout):g=D.flyout),Object(a.b)(g,b,v)})(),(()=>{const e=Object(d.a)("expandableFlyoutDisabled"),t=Object(a.d)(D.flyout),{pathname:n}=Object(I.useLocation)(),l=Object(i.useDispatch)(),o=T.b.getTableByIdSelector(),{expandedDetail:c}=Object(k.b)((e=>{var t;return null!==(t=o(e,E.b.alertsOnAlertsPage))&&void 0!==t?t:x.d}));Object(r.useEffect)((()=>{var a;if(!e)return;const i=n===N.d;i&&null!=c&&null!=c&&c.query?t(c.query.panelView?c.query:null):!i&&null!=c&&null!==(a=c.query)&&void 0!==a&&a.panelView&&(l(T.a.toggleDetailPanel({id:E.b.alertsOnAlertsPage})),t(null))}),[l,c,e,n,t])})()},D={appQuery:"query",eventFlyout:"eventFlyout",flyout:"flyout",timelineFlyout:"timelineFlyout",filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},200:function(e,t,n){"use strict";var a=n(260);n.d(t,"a",(function(){return a.a}));var i=n(337);n.d(t,"b",(function(){return i.a}));var r=n(183);n.d(t,"c",(function(){return r.b}));var l=n(166);n.d(t,"d",(function(){return l.a}))},206:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(2),i=n(45),r=n(138),l=n(5),o=n(124),c=n(148),s=n(200);const u=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(o.b)(c.d.globalFullScreenSelector))&&void 0!==e&&e,u=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add(l.Gc,"euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove(l.Gc,"euiDataGrid__restrictBody"),t(s.c.setFullScreen({id:r.a.global,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({globalFullScreen:n,setGlobalFullScreen:u})),[n,u])},d=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(o.b)(c.d.timelineFullScreenSelector))&&void 0!==e&&e,l=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add("euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove("euiDataGrid__restrictBody"),t(s.c.setFullScreen({id:r.a.timeline,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({timelineFullScreen:n,setTimelineFullScreen:l})),[n,l])},p=()=>{const{globalFullScreen:e}=u(),{timelineFullScreen:t}=d(),n=(()=>{const[e,t]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const e=document.body,n=new MutationObserver((n=>{for(const a of n)"class"===a.attributeName&&t(e.classList.contains("euiDataGrid__restrictBody"))}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[]),e})();return e||t||n}},213:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return b})),n.d(t,"b",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(58),i=n(429),r=n(12),l=n(48),o=n(2),c=n(156);const s=e=>e===c.a.alerts||e===c.a.rules||e===c.a.rulesAdd||e===c.a.rulesCreate||e===c.a.exceptions,u=e=>e.substring(1),d=(e,t)=>{const n=Object(i.parse)(e,{sort:!1})[t];return Array.isArray(n)?n[0]:n},p=(e,t)=>{const n=d(u(null!=t?t:window.location.search),e);return Object(a.safeDecode)(null!=n?n:"")},b=e=>Object(o.useCallback)((()=>p(e)),[e]),m=e=>Object(i.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),f=()=>{const e=Object(l.useHistory)();return Object(o.useCallback)((t=>{const n=window.location.search,r=Object(i.parse)(n,{sort:!1});Object.keys(t).forEach((e=>{const n=t[e];if(null!=n&&""!==n)try{r[e]=Object(a.encode)(n)}catch{console.error("Unable to encode url param value")}else delete r[e]}));const l=m(r);u(n)!==l&&e.replace({search:l})}),[e])},g=()=>{window.history.pushState({},"",window.location.href)}},235:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(119),i=n.n(a),r=n(52),l=n.n(r),o=n(2),c=n.n(o),s=n(41),u=n.n(s),d=n(206),p=n(196);const b=u.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1kulm59-0"})(["&.securitySolutionWrapper--fullHeight{height:100%;display:flex;flex-direction:column;flex:1 1 auto;}&.securitySolutionWrapper--noPadding{padding:0;display:flex;flex-direction:column;flex:1 1 auto;}"]);b.displayName="Wrapper";const m=({children:e,className:t,style:n,noPadding:a,noTimeline:r,...s})=>{const{globalFullScreen:u,setGlobalFullScreen:m}=Object(d.a)();Object(o.useEffect)((()=>{m(!1)}),[m]);const f=l()(t,{securitySolutionWrapper:!0,"securitySolutionWrapper--noPadding":a,"securitySolutionWrapper--withTimeline":!r,"securitySolutionWrapper--fullHeight":u});return c.a.createElement(b,i()({className:f,style:n},s),e,c.a.createElement(p.a,null))},f=c.a.memo(m)},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(894);const r=()=>Object(a.useContext)(i.a)},271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef();return a.useEffect((function(){t.current=e})),t.current}},346:function(e,t,n){"use strict";n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return I}));var a=n(63),i=n.n(a),r=n(19),l=n(44),o=n(2),c=n.n(o),s=n(45),u=n(188),d=n.n(u),p=n(1332),b=n(5),m=n(129),f=n(118),g=n(200),v=n(138),O=n(460);const y={fill:!1},j=e=>{e.forEach((e=>e.refetch&&e.refetch()))},h=c.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:i,kqlQuery:s,policy:u,queries:d,setDuration:p,showUpdateButton:m=!0,start:g,startAutoReload:v,stopAutoReload:O,timelineId:h,toStr:k,updateReduxTime:I,disabled:w,width:T="restricted",compressed:E=!1})=>{const[x,N]=Object(o.useState)([]),P=Object(o.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:r}=I({end:n,id:a,isInvalid:!1,isQuickSelection:i,kql:s,start:e,timelineId:h,hasRangeChanged:!1}),l=S(e),o=i?S(n,{roundUp:!0}):S(n);!d||r||i&&(g!==l||t!==o)||j(d)}),[t,a,s,d,g,h,I]),D=Object(o.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=n&&n.includes("now")||null!=k&&k.includes("now");e!==i&&p({id:a,duration:i}),t&&"interval"===u?O({id:a}):t||"manual"!==u||v({id:a}),d&&!t&&(!r||r&&"now"!==k)&&j(d)}),[n,k,e,u,p,a,O,v,d]),C=Object(o.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){I({end:t,id:a,isInvalid:n,isQuickSelection:i,kql:s,start:e,timelineId:h,hasRangeChanged:!0});const r=[{start:e,end:t},...Object(l.take)(9,x.filter((n=>!(n.start===e&&n.end===t))))];N(r)}}),[I,a,s,h,x]),R=null!=k?k:new Date(t).toISOString(),A=null!=n?n:new Date(g).toISOString(),[F]=Object(f.o)(b.db),[q]=Object(f.o)(b.K),L=Object(l.isEmpty)(F)?[]:F.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return c.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:L,end:R,isLoading:i,isPaused:"manual"===u,onRefresh:P,onRefreshChange:D,onTimeChange:C,recentlyUsedRanges:x,refreshInterval:e,showUpdateButton:m,start:A,isDisabled:w,width:T,compressed:E,updateButtonProps:y,dateFormat:q})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),S=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},k=e=>({end:t,id:n,isQuickSelection:a,kql:i,start:r,timelineId:l,hasRangeChanged:o})=>{const c=S(r);let s=S(t,{roundUp:!0});var u;return a?e(t===r?g.c.setAbsoluteRangeDatePicker({id:n,fromStr:r,toStr:t,from:c,to:s}):g.c.setRelativeRangeDatePicker({id:n,fromStr:r,toStr:t,from:c,to:s})):(s=S(t),e(g.c.setAbsoluteRangeDatePicker({id:n,from:S(r),to:S(t)}))),null!=l&&o&&e(m.a.updateRange({id:l,start:c,end:s})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(u=i.refetch(e))&&void 0!==u&&u}:{kqlHaveBeenUpdated:!1}};h.displayName="SuperDatePickerComponent";const I=Object(s.connect)((()=>{const e=Object(O.a)(),t=Object(O.b)(),n=Object(O.c)(),a=Object(O.d)(),i=Object(O.e)(),r=Object(O.f)(),o=Object(O.g)(),c=Object(O.h)(),s=Object(O.i)(),u=Object(O.j)();return(d,{id:b})=>{const m=Object(l.getOr)({},`inputs.${b}`,d);return{duration:e(m),end:t(m),fromStr:n(m),kind:i(m),policy:o(m),start:s(m),toStr:u(m),isLoading:!1,...Object(p.c)(m)&&(b===v.a.timeline||b===v.a.global)&&{isLoading:a(m),kqlQuery:r(m),queries:c(d,b)}}}}),(e=>({startAutoReload:({id:t})=>e(g.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(g.c.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(g.c.setDuration({id:t,duration:n})),updateReduxTime:k(e)})))(h)},413:function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function l(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function c(e,t){try{return t in e}catch(e){return!1}}function s(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||l,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&o(e).forEach((function(t){a[t]=r(e[t],n)})),o(t).forEach((function(i){(function(e,t){return c(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(c(e,i)&&n.isMergeableObject(t[i])?a[i]=function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s}(i,n)(e[i],t[i],n):a[i]=r(t[i],n))})),a}(e,t,n):r(t,n)}s.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return s(e,n,t)}),{})};var u=s;e.exports=u},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),l=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),o=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),c=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),s=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),u=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},460:function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return y}));var a=n(7),i=n(57),r=n(138);const l=e=>e.policy,o=e=>e.timerange,c=e=>e.queries,s=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===r.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},u=()=>Object(i.createSelector)(l,(e=>e.kind)),d=()=>Object(i.createSelector)(l,(e=>e.duration)),p=()=>Object(i.createSelector)(o,(e=>e.kind)),b=()=>Object(i.createSelector)(o,(e=>e.from)),m=()=>Object(i.createSelector)(o,(e=>e.to)),f=()=>Object(i.createSelector)(o,(e=>e.fromStr)),g=()=>Object(i.createSelector)(o,(e=>e.toStr)),v=()=>Object(i.createSelector)(c,(e=>e.some((e=>!0===e.loading)))),O=()=>Object(i.createSelector)(s,(e=>e.filter((e=>"kql"!==e.id)))),y=()=>Object(i.createSelector)(c,(e=>e.find((e=>"kql"===e.id))))},513:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(897);const r=()=>{const e=Object(a.useContext)(i.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},528:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return v}));var a=n(2),i=n.n(a),r=n(19),l=n(41),o=n.n(l),c=n(118),s=n(235),u=n(573),d=n(4);const p=d.i18n.translate("xpack.securitySolution.noPermissionsTitle",{defaultMessage:"Privileges required"}),b=d.i18n.translate("xpack.securitySolution.noPrivilegesDefaultMessage",{defaultMessage:"To view this page, you must update privileges. For more information, contact your Kibana administrator."}),m=d.i18n.translate("xpack.securitySolution.goToDocumentationButton",{defaultMessage:"View documentation"}),f=o()(r.EuiFlexItem).withConfig({displayName:"SizedEuiFlexItem",componentId:"sc-156zz3c-0"})(["min-height:460px;font-size:1.1rem;"]),g=i.a.memo((({pageName:e,docLinkSelector:t})=>i.a.createElement(s.a,null,i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(f,null,i.a.createElement(r.EuiPageTemplate.EmptyPrompt,null,i.a.createElement(v,{pageName:e,docLinkSelector:t})))))));g.displayName="NoPrivilegePage";const v=i.a.memo((({pageName:e,docLinkSelector:t})=>{const{docLinks:n}=Object(c.j)().services,r=Object(a.useMemo)((()=>({feature:{icon:"documents",label:m,url:t(n.links),target:"_blank"}})),[t,n.links]),l=e?(e=>d.i18n.translate("xpack.securitySolution.noPrivilegesPerPageMessage",{values:{pageName:e},defaultMessage:"To view {pageName}, you must update privileges. For more information, contact your Kibana administrator."}))(e):b;return i.a.createElement(u.a,{actions:r,message:l,"data-test-subj":"noPrivilegesPage",title:p})}));v.displayName="NoPrivileges"},556:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n(45),r=n(44),l=n(121),o=n(634),c=n(138),s=n(166),u=n(127),d=n(887),p=n(249),b=n(13),m=n(396);const f=()=>{const e=Object(i.useDispatch)();return Object(a.useCallback)((({duplicate:t,id:n,forceNotes:a=!1,from:i,notes:f,resolveTimelineConfig:g,timeline:v,to:O,ruleNote:y,ruleAuthor:j,preventSettingQuery:h})=>{let S=v;var k;if(t&&(S={...v,updated:void 0,changed:void 0,version:null}),Object(r.isEmpty)(S.indexNames)||e(s.a.setSelectedDataView({id:u.SourcererScopeName.timeline,selectedDataViewId:S.dataViewId,selectedPatterns:S.indexNames})),S.status===l.l.immutable&&S.timelineType===l.m.template?e(Object(p.setRelativeRangeDatePicker)({id:c.a.timeline,fromStr:"now-24h",toStr:"now",from:m.a.toISOString(),to:m.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:i,to:O})),e(Object(b.addTimeline)({id:n,timeline:S,resolveTimelineConfig:g,savedTimeline:t})),h||null==S.kqlQuery||null==S.kqlQuery.filterQuery||null==S.kqlQuery.filterQuery.kuery||""===S.kqlQuery.filterQuery.kuery.expression||e(Object(b.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(k=S.kqlQuery.filterQuery.kuery.kind)&&void 0!==k?k:"kuery",expression:S.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:S.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=y&&!Object(r.isEmpty)(y)){const t=Object(o.a)({newNote:y,user:j||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(b.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=f?f.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}),[e])}},573:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),i=n.n(a),r=n(19),l=n(2),o=n.n(l),c=n(41);const s=n.n(c)()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-tln1ed-0"})(["align-self:center;max-width:60em;"]);s.displayName="EmptyPrompt";const u=o.a.memo((({actions:e,message:t,title:n,...a})=>{const c=Object.keys(e),u=Object(l.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:n,url:a,descriptionTitle:i,description:l,onClick:s,fill:u=!0},d)=>null!=i||null!=l?o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${c[d]}-action`},o.a.createElement(r.EuiCard,{title:null!=i&&i,description:null!=l&&l,footer:o.a.createElement(r.EuiButton,{href:a,onClick:s,iconType:e,target:n,fill:u,"data-test-subj":`empty-page-${c[d]}-action`},t)})):o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${c[d]}-action`},o.a.createElement(r.EuiButton,{href:a,onClick:s,iconType:e,target:n,"data-test-subj":`empty-page-${c[d]}-action`},t))))),[e,c]);return o.a.createElement(s,i()({iconType:"logoSecurity",title:o.a.createElement(r.EuiText,null,o.a.createElement("h2",null,n)),body:t&&o.a.createElement("p",null,t),actions:o.a.createElement(r.EuiFlexGroup,{justifyContent:"center"},u)},a))}));u.displayName="EmptyPageComponent";const d=o.a.memo(u);d.displayName="EmptyPage"},634:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(19),i=n(54),r=n.n(i),l=n(2),o=n.n(l),c=n(41),s=n.n(c),u=n(50),d=n(430),p=n(196);d.f;const b=s.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);b.displayName="TitleText",o.a.memo((({noteIds:e})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiTitle,{size:"s"},o.a.createElement(b,null,d.e))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(p.c,{color:"hollow"},e.length))))).displayName="NotesCount";const m=({newNote:e,user:t})=>({created:r.a.utc().toDate(),id:Object(u.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),f=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a,user:i})=>{const r=m({newNote:t,user:i});a(r),e(r.id),n("")}},894:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return l}));var a=n(44),i=n(2);const r={pageName:n(156).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},l=Object(i.createContext)([r,()=>a.noop])},897:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.createContext)(null)}}]);