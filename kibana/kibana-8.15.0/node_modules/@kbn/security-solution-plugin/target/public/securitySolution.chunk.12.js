/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[12],{1218:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(2),n=a(45),s=a(1370);const r=()=>{const e=Object(n.useSelector)((e=>e.discover.app)),t=Object(n.useSelector)((e=>e.discover.internal)),a=Object(n.useSelector)((e=>e.discover.savedSearch)),r=Object(n.useDispatch)();return{discoverAppState:e,setDiscoverAppState:Object(i.useCallback)((e=>{r(Object(s.a)({newState:e}))}),[r]),discoverInternalState:t,setDiscoverInternalState:Object(i.useCallback)((e=>{r(Object(s.b)({newState:e}))}),[r]),discoverSavedSearchState:a,setDiscoverSavedSearchState:Object(i.useCallback)((e=>{r(Object(s.c)({newState:e}))}),[r])}}},1292:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(2),n=a(48),s=a(1346);const r=()=>{const{pathname:e}=Object(n.useLocation)(),t=Object(s.a)();return[Object(i.useMemo)((()=>t(e)),[e,t])]}},1346:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a(2),n=a(48),s=a(21),r=a(127),l=a(132),o=a(118);const u=()=>{const{indicesExist:e,dataViewId:t}=Object(l.a)(r.SourcererScopeName.timeline),a=Object(o.j)().services.application.capabilities.siem.show,u=Object(i.useMemo)((()=>a&&(e||null===t)),[e,t,a]);return Object(i.useCallback)((e=>{return!!u&&(t=e,!Object(s.c)().map((e=>e.path)).find((e=>Object(n.matchPath)(t,e))));var t}),[u])}},1380:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return r}));const i=({anonymizationFields:e,field:t})=>{var a,i;return null!==(a=null===(i=e.find((e=>e.field===t)))||void 0===i?void 0:i.allowed)&&void 0!==a&&a},n=({anonymizationFields:e,field:t})=>{var a,i;return!(null!==(a=null===(i=e.find((e=>e.field===t)))||void 0===i?void 0:i.allowed)&&void 0!==a&&a)},s=({anonymizationFields:e,field:t})=>{var a,i;return null!==(a=null===(i=e.find((e=>e.field===t)))||void 0===i?void 0:i.anonymized)&&void 0!==a&&a},r=({messageContent:e,replacements:t})=>null!=t?Object.keys(t).reduce(((e,a)=>{const i=t[a];return e.replaceAll(a,i)}),e):e},534:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(2),n=a(45),s=a(148),r=a(260),l=a(123),o=a(124);const u=e=>e.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0).toString(),c=({id:e,filterQuery:t,kqlError:a,query:c,startDate:d,endDate:p})=>{const{addError:y}=Object(l.a)(),g=Object(n.useDispatch)(),b=Object(i.useMemo)((()=>s.a.errorsSelector()),[]),h=Object(o.a)(b),f=null==a?void 0:a.name,m=null==a?void 0:a.message;Object(i.useEffect)((()=>{!t&&m&&f&&g(r.a.addErrorHash({id:e,hash:u(m),title:f,message:[m]}))}),[e,t,y,c,d,p,g,m,f]),Object(i.useEffect)((()=>{const t=h.find((t=>t.id===e));null!=t&&t.displayError&&null!=a&&(delete a.stack,y(a,{title:a.name}))}),[y,h,e,a])}},535:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return o})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"j",(function(){return y})),a.d(t,"k",(function(){return g})),a.d(t,"l",(function(){return b})),a.d(t,"m",(function(){return h})),a.d(t,"n",(function(){return f})),a.d(t,"o",(function(){return m})),a.d(t,"p",(function(){return v})),a.d(t,"q",(function(){return D})),a.d(t,"r",(function(){return S})),a.d(t,"s",(function(){return k})),a.d(t,"u",(function(){return q})),a.d(t,"v",(function(){return P})),a.d(t,"x",(function(){return x})),a.d(t,"w",(function(){return M})),a.d(t,"z",(function(){return T})),a.d(t,"B",(function(){return Q})),a.d(t,"y",(function(){return O})),a.d(t,"C",(function(){return j})),a.d(t,"D",(function(){return w})),a.d(t,"E",(function(){return E})),a.d(t,"F",(function(){return C})),a.d(t,"A",(function(){return I})),a.d(t,"t",(function(){return L}));var i=a(4);const n=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.addToNewCaseButton",{defaultMessage:"Add to new case"}),s=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.cancelButton",{defaultMessage:"Cancel"}),r=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.checkAllButton",{defaultMessage:"Check all"}),l=e=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.checkingLabel",{values:{index:e},defaultMessage:"Checking {index}"}),o=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.coldDescription",{defaultMessage:"The index is no longer being updated and is queried infrequently. The information still needs to be searchable, but it’s okay if those queries are slower."}),u=({indices:e,pattern:t})=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.coldPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} cold. Cold indices are no longer being updated and are queried infrequently. The information still needs to be searchable, but it’s okay if those queries are slower."}),c=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.toasts.copiedResultsToastTitle",{defaultMessage:"Copied results to the clipboard"}),d=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.copyToClipboardButton",{defaultMessage:"Copy to clipboard"}),p=e=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.dataQualityPromptContextPill",{values:{indexName:e},defaultMessage:"Data Quality ({indexName})"}),y=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.dataQualityPromptContextPillTooltip",{defaultMessage:"Add this Data Quality report as context"}),g=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.securitySolutionPackages.ecsDataQualityDashboardSubtitle",{defaultMessage:"Check index mappings and values for compatibility with the"}),b=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.dataQualitySuggestedUserPrompt",{defaultMessage:"Explain the results above, and describe some options to fix incompatibilities."}),h=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.securitySolutionPackages.ecsDataQualityDashboardTitle",{defaultMessage:"Data quality"}),f=(i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.defaultPanelTitle",{defaultMessage:"Check index mappings"}),i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.ecsVersionStat",{defaultMessage:"ECS version"}),e=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingIlmExplainLabel",{values:{details:e},defaultMessage:"Error loading ILM Explain: {details}"})),m=({details:e,patternOrIndexName:t})=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingMappingsLabel",{values:{details:e,patternOrIndexName:t},defaultMessage:"Error loading mappings for {patternOrIndexName}: {details}"}),v=e=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingStatsLabel",{values:{details:e},defaultMessage:"Error loading stats: {details}"}),D=({details:e,indexName:t})=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingUnallowedValuesLabel",{values:{details:e,indexName:t},defaultMessage:"Error loading unallowed values for index {indexName}: {details}"}),S=(i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.fieldsLabel",{defaultMessage:"Fields"}),i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.frozenDescription",{defaultMessage:"The index is no longer being updated and is queried rarely. The information still needs to be searchable, but it's okay if those queries are extremely slow."})),k=({indices:e,pattern:t})=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.frozenPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} frozen. Frozen indices are no longer being updated and are queried rarely. The information still needs to be searchable, but it's okay if those queries are extremely slow."}),q=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.hotDescription",{defaultMessage:"The index is actively being updated and queried"}),P=({indices:e,pattern:t})=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.hotPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} hot. Hot indices are actively being updated and queried."}),x=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.indexLifecycleManagementPhasesTooltip",{defaultMessage:"Indices with these Index Lifecycle Management (ILM) phases will be checked for data quality"}),M=(i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.indexNameLabel",{defaultMessage:"Index name"}),i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.ilmPhaseLabel",{defaultMessage:"ILM phase"})),T=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.lastCheckedLabel",{defaultMessage:"Last checked"}),Q=(i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.emptyLoadingPrompt.loadingEcsMetadataPrompt",{defaultMessage:"Loading ECS metadata"}),i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.selectAnIndexPrompt",{defaultMessage:"Select an index to compare it against ECS version"}),i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.selectOneOrMorPhasesPlaceholder",{defaultMessage:"Select one or more ILM phases"})),O=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.indexSizeTooltip",{defaultMessage:"The size of the primary index (does not include replicas)"}),j=(i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.timestampDescriptionLabel",{defaultMessage:"Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events."}),i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.unmanagedDescription",{defaultMessage:"The index isn't managed by Index Lifecycle Management (ILM)"})),w=({indices:e,pattern:t})=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.unmanagedPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} unmanaged by Index Lifecycle Management (ILM)"}),E=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.warmDescription",{defaultMessage:"The index is no longer being updated but is still being queried"}),C=({indices:e,pattern:t})=>i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.warmPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} warm. Warm indices are no longer being updated but are still being queried."}),I=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.postResultErrorTitle",{defaultMessage:"Error writing saved data quality check results"}),L=i.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.getResultErrorTitle",{defaultMessage:"Error reading saved data quality check results"})},960:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return b}));var i=a(535),n=a(4);const s=n.i18n.translate("xpack.securitySolution.assistant.content.promptContexts.viewTitle",{defaultMessage:"view"}),r=n.i18n.translate("xpack.securitySolution.assistant.content.promptContexts.indexTitle",{defaultMessage:"index"});var l=a(178),o=a(197);const u=`${n.i18n.translate("xpack.securitySolution.assistant.content.prompts.user.thenSummarizeSuggestedKqlAndEqlQueries",{defaultMessage:"Evaluate the event from the context above and format your output neatly in markdown syntax for my Elastic Security case."})}\n${n.i18n.translate("xpack.securitySolution.assistant.content.prompts.user.finallySuggestInvestigationGuideAndFormatAsMarkdown",{defaultMessage:"Add your description, recommended actions and bulleted triage steps. Use the MITRE ATT&CK data provided to add more context and recommendations from MITRE, and hyperlink to the relevant pages on MITRE's website. Be sure to include the user and host risk score data from the context. Your response should include steps that point to Elastic Security specific features, including endpoint response actions, the Elastic Agent OSQuery manager integration (with example osquery queries), timelines and entity analytics and link to all the relevant Elastic Security documentation."})}`,c="alert",d="event",p="detection-rules",y="data-quality-dashboard",g="knowledge-base",b={[c]:{category:c,suggestedUserPrompt:u,description:o.d(s),tooltip:o.f},[d]:{category:d,suggestedUserPrompt:u,description:o.h(s),tooltip:o.j},[y]:{category:y,suggestedUserPrompt:i.l,description:i.i(r),tooltip:i.j},[p]:{category:p,suggestedUserPrompt:l.Xb,description:l.hd,tooltip:l.id}}},965:function(e,t,a){"use strict";a.d(t,"a",(function(){return M})),a.d(t,"c",(function(){return T})),a.d(t,"d",(function(){return Q})),a.d(t,"b",(function(){return j}));var i=a(19),n=a(756),s=a(2),r=a.n(s),l=a(1380),o=a(119),u=a.n(o),c=a(45),d=a(241),p=a(148),y=a(200),g=a(183),b=a(138),h=a(127),f=a(146),m=a(172),v=a(13),D=a(513),S=a(1292),k=a(122),q=a(132),P=a(1218);const x=({asEmptyButton:e,children:t,dataProviders:a,filters:n,timeRange:l,keepDataView:o,...x})=>{var M,T;const Q=Object(c.useDispatch)(),{showAssistantOverlay:O}=Object(d.b)(),[j]=Object(S.a)(),{discoverStateContainer:w,defaultDiscoverAppState:E}=Object(D.a)(),{dataViewId:C}=Object(q.a)(h.SourcererScopeName.timeline),{setDiscoverAppState:I}=Object(P.a)(),L=Object(k.a)("timelineEsqlTabDisabled"),A=Object(c.useSelector)(p.e.signalIndexName),N=Object(c.useSelector)(p.e.defaultDataView),z=Object(s.useCallback)((async()=>{if(O({showOverlay:!1}),a||n){var e,t,i,s;if("esql"===(null==a||null===(e=a[0])||void 0===e?void 0:e.queryType)||"sql"===(null==a||null===(t=a[0])||void 0===t?void 0:t.queryType))return w.current?(null===(i=w.current)||void 0===i||i.appState.set({query:{esql:a[0].kqlQuery}}),await(null===(s=w.current)||void 0===s?void 0:s.appState.replaceUrlState({query:{esql:a[0].kqlQuery}}))):I({...E,query:{esql:a[0].kqlQuery}}),Q(Object(v.setActiveTabTimeline)({id:f.c.active,activeTab:f.d.esql})),void Q(Object(v.showTimeline)({id:f.c.active,show:!0}));if(a)switch(Q(Object(v.updateDataView)({id:f.c.active,dataViewId:"security-solution-default",indexNames:["logs-*"]})),a[0].queryType){case"eql":Q(Object(v.updateEqlOptions)({id:f.c.active,field:"query",value:a[0].kqlQuery})),Q(Object(v.setActiveTabTimeline)({id:f.c.active,activeTab:f.d.eql})),Q(Object(v.showTimeline)({id:f.c.active,show:!0}));break;case"kql":Q(Object(v.applyKqlFilterQuery)({id:f.c.active,filterQuery:{kuery:{kind:"kuery",expression:a[0].kqlQuery},serializedQuery:a[0].kqlQuery}})),Q(Object(v.setActiveTabTimeline)({id:f.c.active,activeTab:f.d.query})),Q(Object(v.showTimeline)({id:f.c.active,show:!0}));break;case"dsl":const e={meta:{type:"custom",disabled:!1,negate:!1,alias:a[0].name,key:"query",value:a[0].kqlQuery,index:null!=C?C:void 0},query:JSON.parse(a[0].kqlQuery)};Q(Object(v.setFilters)({id:f.c.active,filters:[e]})),Q(Object(v.setActiveTabTimeline)({id:f.c.active,activeTab:f.d.query})),Q(Object(v.showTimeline)({id:f.c.active,show:!0}))}n&&Q(Object(v.setFilters)({id:f.c.active,filters:n})),o||Q(y.d.setSelectedDataView({id:h.SourcererScopeName.timeline,selectedDataViewId:N.id,selectedPatterns:[A||""]})),Q(g.b.removeLinkTo([b.a.timeline,b.a.global]))}}),[O,a,n,o,Q,w,C,N.id,A,I,E]),B=j?m.i:m.h,F=!j;return"esql"!==(null==a||null===(M=a[0])||void 0===M?void 0:M.queryType)&&"sql"!==(null==a||null===(T=a[0])||void 0===T?void 0:T.queryType)||!L?e?r.a.createElement(i.EuiButtonEmpty,{"aria-label":B,onClick:z,isDisabled:F,color:"text",flush:"both",size:"xs"},r.a.createElement(i.EuiToolTip,{position:"right",content:B},r.a.createElement(r.a.Fragment,null,t))):r.a.createElement(i.EuiButton,u()({"aria-label":B,isDisabled:F,onClick:z},x),r.a.createElement(i.EuiToolTip,{position:"right",content:B},r.a.createElement(r.a.Fragment,null,t))):null};x.displayName="SendToTimelineButton";const M="securityAssistant",T=e=>e.map((e=>`Rule Name:${e.name}\nRule Description:${e.description}`)).join("\n\n"),Q=e=>e.filter((({field:e})=>!e.startsWith("signal."))).reduce(((e,{field:t,values:a})=>({...e,[t]:null!=a?a:[]})),{}),O=["kql","dsl","eql","esql","sql"],j=(e,t)=>e.messages.map((({content:a})=>Object(n.a)(t?null!=a?a:"":Object(l.d)({messageContent:null!=a?a:"",replacements:e.replacements})))).map(((t,a)=>t.map(((t,n)=>{var s;return{...t,getControlContainer:()=>document.querySelectorAll(`.message-${a} .euiCodeBlock__controls`)[n],button:O.includes(t.type)?r.a.createElement(x,{asEmptyButton:!0,dataProviders:[{id:"assistant-data-provider",name:`Assistant Query from conversation ${e.id}`,enabled:!0,excluded:!1,queryType:t.type,kqlQuery:null!==(s=t.content)&&void 0!==s?s:"",queryMatch:{field:"host.name",operator:":",value:"test"},and:[]}],keepDataView:!0},r.a.createElement(i.EuiIcon,{type:"timeline"})):null}}))))}}]);