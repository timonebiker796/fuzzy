/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[35,4,10,13,15,16,17,28],Array(122).concat([function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(45),i=n(14);const r=Object(i.b)(),o=e=>{const t=s();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},s=()=>Object(a.useSelector)((({app:{enableExperimental:e}})=>e))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(44),r=n(128),o=n(91),s=n(118);const l=()=>{const e=Object(s.n)(),t=Object(a.useRef)(e.addError.bind(e)).current,n=Object(a.useRef)(e.addSuccess.bind(e)).current,i=Object(a.useRef)(e.addWarning.bind(e)).current,r=Object(a.useRef)(e.remove.bind(e)).current,o=Object(a.useCallback)(((e,n)=>{const a=c(e);return t(a,n)}),[t]);return Object(a.useMemo)((()=>({api:e,addError:o,addSuccess:n,addWarning:i,remove:r})),[o,n,i,r,e])},c=e=>null!=e&&Object(o.isEsError)(e)?u(e):Object(r.r)(e)?d(e):e instanceof Error?p(e):m(e),u=e=>{var t,n,a,i,r,o,s;const l=null!=e.err?e.err:e,c=null!=(null===(t=e.err)||void 0===t?void 0:t.statusCode)?`(${e.err.statusCode})`:null!=e.statusCode?`(${e.statusCode})`:"",u=f(l),d=new Error(`${null!==(n=null===(a=e.attributes)||void 0===a||null===(i=a.error)||void 0===i?void 0:i.reason)&&void 0!==n?n:e.message} ${c}`);return d.name=null!==(r=null===(o=e.attributes)||void 0===o||null===(s=o.error)||void 0===s?void 0:s.reason)&&void 0!==r?r:e.message,null!=u&&(d.stack=u),d},d=e=>{const t=Object(r.s)(e)?`(${e.body.statusCode})`:Object(r.u)(e)?`(${e.body.status_code})`:"",n=f(e),a=new Error(`${""!==String(e.body.message).trim()?e.body.message:e.message} ${t}`);return a.name=null!=e.name?e.name:"",null!=n&&(a.stack=n),a},p=e=>{const t=f(e),n=new Error(e.message);return n.name=e.name,null!=t&&(n.stack=t),n},m=e=>{const t=f(e),n=Object(i.isString)(e)?e:e instanceof Object&&null!=t?t:String(e),a=new Error(n);return a.name=n,null!=t&&(a.stack=t),a},f=e=>{try{return JSON.stringify(e,((e,t)=>{const n=g(t);return b(n)?void 0:n}),2)}catch(e){return}},g=e=>e instanceof Error?{...e,name:e.name,message:e.message,stack:e.stack}:e,b=e=>{if(!(e instanceof Object))return!1;try{return"{}"===JSON.stringify(e)}catch(e){return!1}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(45),i=n(188),r=n.n(i);const o=e=>Object(a.useSelector)(e,a.shallowEqual),s=e=>Object(a.useSelector)(e,r.a)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>Object(a.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return g}));var a=n(44),i=n(2),r=n.n(i),o=n(41),s=n.n(o);const l=n(4).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),c=s.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorDarkShade));c.displayName="EmptyWrapper";const u=()=>"—",d=()=>`(${l})`,p=()=>r.a.createElement(c,null,u()),m=()=>r.a.createElement(c,null,d()),f=e=>null==e?p():Object(a.isString)(e)&&""===e?m():r.a.createElement(r.a.Fragment,null,e),g=e=>null==e?p():""===e?m():r.a.createElement(r.a.Fragment,null,e)},function(e,t,n){"use strict";n.r(t),n.d(t,"parseRoute",(function(){return y})),n.d(t,"manageOldSiemRoutes",(function(){return h})),n.d(t,"getInspectResponse",(function(){return v})),n.d(t,"isDetectionsPath",(function(){return E})),n.d(t,"isDashboardViewPath",(function(){return x})),n.d(t,"isTourPath",(function(){return j})),n.d(t,"isThreatIntelligencePath",(function(){return S})),n.d(t,"getSubPluginRoutesByCapabilities",(function(){return O})),n.d(t,"isSubPluginAvailable",(function(){return k})),n.d(t,"getFieldKey",(function(){return I})),n.d(t,"getField",(function(){return M})),n.d(t,"isTimelineScope",(function(){return C})),n.d(t,"isInTableScope",(function(){return _})),n.d(t,"isAlertsPageScope",(function(){return D})),n.d(t,"getScopedActions",(function(){return A})),n.d(t,"getScopedSelectors",(function(){return F})),n.d(t,"isActiveTimeline",(function(){return N})),n.d(t,"getSourcererScopeId",(function(){return P}));var a=n(748),i=n(44),r=n(2),o=n.n(r),s=n(48),l=n(1630),c=n(1799),u=n(7),d=n(5),p=n(528),m=n(156),f=n(129),g=n(149),b=n(127);const y=e=>{if(!Object(i.isEmpty)(e.hash)){var t;const n=e.hash.split("?"),a=n.length>=1?`?${n[1]}`:"",i=n.length>0?n[0].split("/"):[];return{pageName:i.length>=1?i[1]:"",path:`/${null!==(t=i.slice(2).join("/"))&&void 0!==t?t:""}${a}`,search:a}}const n=e.search,a=e.pathname.split("/");return{pageName:a[3],path:`${a.length>4?`/${a.slice(4).join("/")}`:""}${n}`,search:n}},h=async e=>{const{application:t}=e,{pageName:n,path:a}=y(window.location);switch(n){case m.a.overview:t.navigateToApp(d.m,{deepLinkId:m.a.overview,replace:!0,path:a});break;case"ml-hosts":t.navigateToApp(d.m,{deepLinkId:m.a.hosts,replace:!0,path:`/ml-hosts${a}`});break;case m.a.hosts:t.navigateToApp(d.m,{deepLinkId:m.a.hosts,replace:!0,path:a});break;case"ml-network":t.navigateToApp(d.m,{deepLinkId:m.a.network,replace:!0,path:`/ml-network${a}`});break;case m.a.network:t.navigateToApp(d.m,{deepLinkId:m.a.network,replace:!0,path:a});break;case m.a.timelines:t.navigateToApp(d.m,{deepLinkId:m.a.timelines,replace:!0,path:a});break;case m.a.case:case"case":t.navigateToApp(d.m,{deepLinkId:m.a.case,replace:!0,path:a});break;case m.a.detections:case m.a.alerts:t.navigateToApp(d.m,{deepLinkId:m.a.alerts,replace:!0,path:a});break;case m.a.rules:t.navigateToApp(d.m,{deepLinkId:m.a.rules,replace:!0,path:a});break;case m.a.exceptions:t.navigateToApp(d.m,{deepLinkId:m.a.exceptions,replace:!0,path:a});break;default:t.navigateToApp(d.m,{deepLinkId:m.a.landing,replace:!0,path:a})}},v=(e,t)=>({dsl:Object(u.isObject)(null==e?void 0:e.inspect)&&null!=e&&e.inspect.dsl?e.inspect.dsl:(null==t?void 0:t.dsl)||[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}),E=e=>!!Object(s.matchPath)(e,{path:`(${d.d}|${d.Cc}|${d.Db})`,strict:!1}),x=e=>null!=Object(s.matchPath)(e,{path:`${d.B}/:detailName`,exact:!1,strict:!1}),j=e=>(e=>!!Object(s.matchPath)(e,{path:`${d.d}`,strict:!1}))(e)||(e=>!!Object(s.matchPath)(e,{path:`${d.x}/:detailName`,strict:!1}))(e),S=e=>!!Object(s.matchPath)(e,{path:`(${d.Pc})`,strict:!1}),O=(e,t)=>Object.entries(e).reduce(((e,[n,a])=>{if(k(n,t.application.capabilities))e.push(...a.routes);else{const i=e=>e.siem.privileges;e.push(...a.routes.map((e=>({path:e.path,component:()=>{const e=t.upselling.getPageUpselling(n);return e?o.a.createElement(e,null):o.a.createElement(p.b,{pageName:n,docLinkSelector:i})}}))))}return e}),[]),k=(e,t)=>"cases"===e?!0===t[d.w].read_cases:!0===t[d.Lc].show,w={[a.y]:"signal.rule.id",[a.r]:"signal.rule.name",[`${a.t}.filters`]:"signal.rule.filters",[`${a.t}.language`]:"signal.rule.language",[`${a.t}.query`]:"signal.rule.query"},T={"signal.rule.id":a.y,"signal.rule.name":a.r,"signal.rule.filters":`${a.t}.filters`,"signal.rule.language":`${a.t}.language`,"signal.rule.query":`${a.t}.query`},I=(e,t)=>{var n,a;const r=(null!==(n=T[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),o=(null!==(a=w[t])&&void 0!==a?a:t).replace("kibana.alert","signal");return Object(i.has)(r,e)?r:o},M=(e,t)=>{var n,a,r;const o=(null!==(n=T[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),s=(null!==(a=w[t])&&void 0!==a?a:t).replace("kibana.alert","signal"),l=o.split(".");if(l.includes("parameters")&&"parameters"!==l[l.length-1]){const t=l.slice(0,l.length-1).join("."),n=Object(i.get)(t,e);return Object(i.get)(l[l.length-1],n)}return null!==(r=Object(i.get)(o,e))&&void 0!==r?r:Object(i.get)(s,e)},C=e=>Object.values(g.f).includes(e),_=e=>Object.values(l.b).includes(e),D=e=>[l.b.alertsOnAlertsPage,l.b.alertsOnRuleDetailsPage,l.b.alertsOnCasePage].includes(e),A=e=>C(e)?f.a:_(e)?c.a:void 0,F=e=>C(e)?f.a:_(e)?c.a:void 0,N=e=>e===g.f.active,P=e=>C(e)?b.SourcererScopeName.timeline:D(e)?b.SourcererScopeName.detections:b.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(45),r=n(166),o=n(127),s=n(531),l=n(294),c=n(252),u=n(308),d=n(1276),p=n(895);const m=(e=o.SourcererScopeName.default)=>{const t=Object(i.useSelector)(r.d.kibanaDataViews),n=Object(i.useSelector)(r.d.signalIndexName),m=Object(i.useSelector)(r.d.defaultDataView),f=Object(i.useSelector)((t=>r.d.sourcererScopeSelectedDataViewId(t,e))),g=Object(a.useMemo)((()=>t.find((e=>e.id===f))),[t,f]),b=Object(i.useSelector)((t=>r.d.sourcererScopeIsLoading(t,e))),y=Object(i.useSelector)((t=>r.d.sourcererScopeSelectedPatterns(t,e))),h=Object(i.useSelector)((t=>r.d.sourcererScopeMissingPatterns(t,e))),v=Object(a.useMemo)((()=>Object(u.b)(y)),[y]),[E,x]=Object(a.useState)([]),[j,S]=Object(c.b)(E),O=Object(a.useMemo)((()=>{var e,t,n,a,i,r,o;return{...S,dataView:S.dataView,runtimeMappings:null!==(e=null===(t=S.dataView)||void 0===t?void 0:t.runtimeFieldMap)&&void 0!==e?e:{},title:null!==(n=null===(a=S.dataView)||void 0===a?void 0:a.title)&&void 0!==n?n:"",id:null!==(i=null===(r=S.dataView)||void 0===r?void 0:r.id)&&void 0!==i?i:null,loading:j,patternList:S.indexes,indexFields:S.indexPatterns.fields,fields:null===(o=S.dataView)||void 0===o?void 0:o.fields}}),[S,j]);Object(a.useEffect)((()=>{null==g||h.length>0?x(v):x([])}),[h,g,v]);const k=Object(a.useMemo)((()=>{const e=null==g||h.length>0?O:g;return{...e,dataView:{...e.dataView,title:v.join(","),name:v.join(",")}}}),[O,h.length,g,v]),w=Object(a.useMemo)((()=>!(!b&&!k.loading)||Object(s.a)({scopeId:e,signalIndexName:n,patternList:k.patternList,isDefaultDataViewSelected:k.id===m.id})),[m.id,b,e,n,k.id,k.loading,k.patternList]),T=Object(a.useCallback)((()=>{const{browserFields:e}=Object(l.a)(k.patternList.join(","),k.fields);return e}),[k.fields,k.patternList]);return((e,t)=>{const n=Object(i.useSelector)(p.a),r=Object(a.useMemo)((()=>({...n,browserFields:t.browserFields,sourcererDataView:t.sourcererDataView})),[n,t.browserFields,t.sourcererDataView]);return Object(d.a)()?r:t})(0,Object(a.useMemo)((()=>({browserFields:T(),dataViewId:k.id,indexPattern:{fields:k.indexFields,title:v.join(","),getName:()=>v.join(",")},indicesExist:w,loading:b||k.loading,runtimeMappings:k.runtimeMappings,patternList:k.title.split(","),selectedPatterns:v,...E.length>0?{activePatterns:k.patternList}:{},sourcererDataView:k.dataView})),[T,k,v,w,b,E.length]))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(363),c=n(222),u=n(130),d=n(179),p=n(416);const m=({field:e,tooltipContent:t})=>null!=t?t:e,f=r.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:i,value:o})=>(e=>null===e)(n)?r.a.createElement(r.a.Fragment,null,e||o):r.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:m({tooltipContent:n,field:t})},r.a.createElement(r.a.Fragment,null,e||o))));f.displayName="Content";const g=r.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:o="",isAggregatable:s=!1,value:u,name:m,children:g,scopeId:b,tooltipContent:y,tooltipPosition:h,queryValue:v,truncate:E})=>{const x=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(c.h)(t),name:m||(null!==(e=null==u?void 0:u.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:v||(null!=u?u:""),operator:d.d}}}),[a,t,m,v,u]),j=Object(i.useCallback)(((e,t,n)=>n.isDragging?r.a.createElement(l.a,null,r.a.createElement(p.a,{dataProvider:e})):r.a.createElement(f,{field:a,tooltipContent:y,tooltipPosition:h,value:u},g)),[g,a,y,h,u]);return null==u?null:r.a.createElement(l.b,{dataProvider:x,fieldType:o,isAggregatable:s,hideTopN:e,isDraggable:n,render:j,scopeId:b,truncate:E})}));g.displayName="DefaultDraggable";const b=s()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);b.displayName="Badge";const y=({contextId:e,eventId:t,field:n,value:a,iconType:i,isDraggable:o,isAggregatable:s,fieldType:l,name:c,color:d="hollow",children:p,scopeId:m,tooltipContent:f,queryValue:y})=>null!=a?r.a.createElement(g,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:o,isAggregatable:s,fieldType:l,field:n,name:c,value:a,scopeId:m,tooltipContent:f,queryValue:y},r.a.createElement(b,{iconType:i,color:d,title:""},p||(""!==a?a:Object(u.c)()))):null;y.displayName="DraggableBadgeComponent";const h=r.a.memo(y);h.displayName="DraggableBadge"},function(e,t,n){"use strict";n.d(t,"H",(function(){return o})),n.d(t,"I",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"kb",(function(){return c})),n.d(t,"eb",(function(){return u})),n.d(t,"fb",(function(){return d})),n.d(t,"jb",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"gb",(function(){return y})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return E})),n.d(t,"C",(function(){return x})),n.d(t,"E",(function(){return j})),n.d(t,"F",(function(){return S})),n.d(t,"D",(function(){return O})),n.d(t,"bb",(function(){return w})),n.d(t,"ab",(function(){return T})),n.d(t,"Z",(function(){return I})),n.d(t,"X",(function(){return C})),n.d(t,"W",(function(){return _})),n.d(t,"G",(function(){return D})),n.d(t,"V",(function(){return A})),n.d(t,"U",(function(){return F})),n.d(t,"S",(function(){return N})),n.d(t,"T",(function(){return P})),n.d(t,"O",(function(){return L})),n.d(t,"M",(function(){return z})),n.d(t,"L",(function(){return q})),n.d(t,"K",(function(){return B})),n.d(t,"N",(function(){return $})),n.d(t,"J",(function(){return V})),n.d(t,"Q",(function(){return U})),n.d(t,"P",(function(){return G})),n.d(t,"B",(function(){return H})),n.d(t,"z",(function(){return W})),n.d(t,"y",(function(){return Q})),n.d(t,"w",(function(){return Y})),n.d(t,"x",(function(){return K})),n.d(t,"A",(function(){return J})),n.d(t,"v",(function(){return Z})),n.d(t,"s",(function(){return X})),n.d(t,"r",(function(){return ee})),n.d(t,"t",(function(){return te})),n.d(t,"q",(function(){return ne})),n.d(t,"u",(function(){return ae})),n.d(t,"R",(function(){return ie})),n.d(t,"p",(function(){return re})),n.d(t,"o",(function(){return oe})),n.d(t,"n",(function(){return se})),n.d(t,"m",(function(){return le})),n.d(t,"l",(function(){return ce})),n.d(t,"k",(function(){return ue})),n.d(t,"j",(function(){return de})),n.d(t,"Y",(function(){return pe})),n.d(t,"lb",(function(){return me})),n.d(t,"f",(function(){return fe})),n.d(t,"e",(function(){return ge})),n.d(t,"ib",(function(){return be})),n.d(t,"hb",(function(){return ye})),n.d(t,"db",(function(){return ve})),n.d(t,"cb",(function(){return Ee}));var a=n(211),i=n(279);const r=`${a.a}Header`,o=`${a.a}AlertTitle`,s=`${a.a}EventTitle`,l=`${r}AlertSumaryPanel`,c=`${r}StatusTitle`,u=`${r}RiskScoreTitle`,d=`${r}RiskScoreValue`,p=`${r}ShareButton`,m=`${r}AssigneesHeader`,f=`${r}AssigneesTitle`,g=`${r}AssigneesAddButton`,b=`${a.a}AboutSection`,y=(i.c,i.a,`${a.a}RuleSummaryButton`),h=`${a.a}AlertDescription`,v=`${h}Title`,E=`${h}Details`,x=`${a.a}EventCategoryDescription`,j=`${a.a}EventKindDescription`,S=`${j}Text`,O=`${j}Categories`,k=`${a.a}Reason`,w=`${k}Title`,T=`${k}Details`,I=`${k}PreviewButton`,M=`${a.a}MitreAttack`,C=`${M}Title`,_=`${M}Details`,D=`${a.a}EventRenderer`,A=`${a.a}InvestigationSection`,F=(i.c,i.a,`${a.a}InvestigationGuide`),N=`${F}Button`,P=`${F}Loading`,R=`${a.a}HighlightedFields`,L=`${R}Title`,z=`${R}Details`,q=`${R}Cell`,B=`${R}BasicCell`,$=`${R}LinkedCell`,V=`${R}AgentStatusCell`,U=`${a.a}Insights`,G=(i.c,i.a,`${a.a}InsightsEntities`),H=`${G}UserOverview`,W=`${H}Loading`,Q=`${H}Link`,Y=`${H}Domain`,K=`${H}LastSeen`,J=`${H}RiskLevel`,Z=`${G}HostOverview`,X=`${Z}Loading`,ee=`${Z}Link`,te=`${Z}OsFamily`,ne=`${Z}LastSeen`,ae=`${Z}RiskLevel`,ie=`${a.a}InsightsThreatIntelligence`,re=`${a.a}Correlations`,oe=`${re}SuppressedAlerts`,se=`${oe}TechnicalPreview`,le=`${re}RelatedCases`,ce=`${re}RelatedAlertsBySession`,ue=`${re}RelatedAlertsBySameSourceEvent`,de=`${re}RelatedAlertsByAncestry`,pe=`${a.a}InsightsPrevalence`,me=`${a.a}Visualizations`,fe=(i.c,i.a,`${a.a}AnalyzerPreview`),ge=`${fe}Loading`,be=`${a.a}SessionPreview`,ye=`${be}RuleDetailsLink`,he=`${a.a}Response`,ve=`${he}Section`,Ee=(i.c,i.a,`${he}Button`)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(739);const r=()=>Object(a.useContext)(i.a)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a=(e,t)=>"string"==typeof e?e:Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?e[0]:null!=t?t:null,i=e=>"string"==typeof e?[e]:Array.isArray(e)&&e.length>0?e:[]},,function(e,t,n){"use strict";n.d(t,"g",(function(){return x.d})),n.d(t,"f",(function(){return x.c})),n.d(t,"o",(function(){return w})),n.d(t,"m",(function(){return M})),n.d(t,"d",(function(){return _})),n.d(t,"h",(function(){return N})),n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return L})),n.d(t,"i",(function(){return z})),n.d(t,"e",(function(){return q})),n.d(t,"b",(function(){return B})),n.d(t,"j",(function(){return H})),n.d(t,"n",(function(){return W})),n.d(t,"l",(function(){return Q})),n.d(t,"k",(function(){return Y}));var a=n(19),i=n(2),r=n.n(i),o=n(44),s=n(305),l=n(170),c=n(256),u=n(5),d=n(433),p=n(194),m=n(409),f=n(118),g=n(356),b=n(4),y=n(378);const h=e=>b.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var v=n(156),E=n(560),x=n(312),j=n(119),S=n.n(j),O=n(454),k=n(529);const w=()=>{const e=Object(O.e)(),t=Object(k.a)();return Object(i.useCallback)((({deepLinkId:n,path:a,onClick:i})=>{const r=t(n);return e({id:n,path:a,urlState:r,onClick:i})}),[e,t])},T=e=>(e=>r.a.memo((function({deepLinkId:t,...n}){const a=Object(k.a)()(t);return r.a.createElement(e,S()({id:t,urlState:a},n))})))(Object(O.g)(e)),I=({children:e,Component:t,userName:n,isButton:a,onClick:o,title:s,userTab:l})=>{const c=encodeURIComponent(n),{formatUrl:d,search:m}=Object(p.l)(v.a.users),{application:{navigateToApp:g},telemetry:b}=Object(f.j)().services,y=Object(i.useCallback)((e=>{e.preventDefault(),g(u.m,{deepLinkId:v.a.users,path:l?Object(E.a)(c,l,m):Object(E.c)(c,m)})}),[c,g,m,l]),h=Object(i.useMemo)((()=>d(l?Object(E.a)(c,l):Object(E.c)(c))),[d,c,l]),j=Object(i.useCallback)((e=>{b.reportEntityDetailsClicked({entity:"user"}),(null!=o?o:y)(e)}),[y,o,b]);return a?r.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-user-details",href:h,onClick:j,title:null!=s?s:n},e||n):r.a.createElement(x.c,{"data-test-subj":"users-link-anchor",onClick:j,href:h},e||n)},M=r.a.memo(I),C=({children:e,Component:t,hostName:n,isButton:a,onClick:o,title:s,hostTab:l})=>{const{formatUrl:c,search:d}=Object(p.l)(v.a.hosts),{application:{navigateToApp:m},telemetry:g}=Object(f.j)().services,b=encodeURIComponent(n),y=Object(i.useCallback)((e=>{e.preventDefault(),m(u.m,{deepLinkId:v.a.hosts,path:l?Object(p.i)(b,l,d):Object(p.d)(b,d)})}),[b,m,d,l]),h=Object(i.useMemo)((()=>c(l?Object(p.i)(b,l):Object(p.d)(b))),[c,b,l]),E=Object(i.useCallback)((e=>{g.reportEntityDetailsClicked({entity:"host"}),(null!=o?o:y)(e)}),[y,o,g]);return a?r.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-host-details",href:h,iconType:"expand",onClick:E,title:null!=s?s:n},e):r.a.createElement(x.c,{onClick:E,href:h,"data-test-subj":"host-details-button"},e||n)},_=r.a.memo(C),D=["http://","https://"],A=r.a.memo((({url:e,children:t,idx:n,overflowIndexStart:i=5,allItemsLimit:s=5})=>{const l=i-1,c=s-1,u=Math.max(0,Math.min(l,c)),d=D.some((t=>0===e.indexOf(t)));return e&&d&&!Object(g.c)(e)&&t?r.a.createElement(a.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(o.isNil)(n)&&n<u&&r.a.createElement(x.a,{"data-test-subj":"externalLinkComma"}))):null}));A.displayName="ExternalLink";const F=({Component:e,children:t,ip:n,flowTarget:a=m.a.source,isButton:s,onClick:l,title:c})=>{const u=w(),f=Object(i.useCallback)(((n,i)=>{const{onClick:o,href:m}=u({deepLinkId:v.a.network,path:Object(p.f)(encodeURIComponent(Object(d.c)(n)),a)}),f=null!=l?l:e=>o(e);return s?r.a.createElement(x.b,{Component:e,key:`${n}-${i}`,dataTestSubj:"data-grid-network-details",onClick:f,href:m,title:null!=c?c:n},t):r.a.createElement(x.c,{key:`${n}-${i}`,onClick:f,href:m,"data-test-subj":"network-details"},t||n)}),[t,e,a,u,l,s,c]);return Object(o.isArray)(n)?r.a.createElement(r.a.Fragment,null,n.map(f)):f(n,0)},N=r.a.memo(F),P=({index:e,children:t,detailName:n,title:a})=>{const{formatUrl:o,search:d}=Object(p.l)(v.a.case),{navigateToApp:m}=Object(f.j)().services.application,{activeStep:g,isTourShown:b}=Object(c.b)(),y=Object(i.useMemo)((()=>g===l.a.viewCase&&b(l.b.alertsCases)&&0===e),[g,e,b]),E=Object(i.useCallback)((async e=>(e&&e.preventDefault(),m(u.m,{deepLinkId:v.a.case,path:Object(p.a)({id:n,search:d})}))),[n,m,d]);return Object(i.useEffect)((()=>{var e;y&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[y]),r.a.createElement(s.a,{onClick:E,isTourAnchor:y,step:l.a.viewCase,tourId:l.b.alertsCases},r.a.createElement(x.c,{onClick:E,href:o(Object(p.a)({id:n})),"data-test-subj":"case-details-link","aria-label":h(null!=a?a:n)},t||n))},R=r.a.memo(P);R.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(p.l)(v.a.case),{navigateToApp:a}=Object(f.j)().services.application,o=Object(i.useCallback)((async e=>(e.preventDefault(),a(u.m,{deepLinkId:v.a.case,path:Object(p.b)(n)}))),[a,n]);return r.a.createElement(x.c,{onClick:o,href:t(Object(p.b)())},e)})).displayName="CreateCaseLink";const L=r.a.memo((({children:e,link:t})=>{const n=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(A,{url:n},e||t)}));L.displayName="GoogleLink";const z=r.a.memo((({Component:e,title:t,children:n,portOrServiceName:o})=>{var s;const l=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(o))}`),[o]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(s=null!=t?t:n)&&void 0!==s?s:o):r.a.createElement(x.e,null,r.a.createElement(a.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||o))}));z.displayName="PortOrServiceNameLink";const q=r.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));q.displayName="Ja3FingerprintLink";const B=r.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));B.displayName="CertificateFingerprintLink";var $=function(e){return e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com",e}($||{});function V(e){return e===$["virustotal.com"]||e===$["talosIntelligence.com"]}const U={[$["virustotal.com"]]:y.m,[$["talosIntelligence.com"]]:y.l},G=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:s,direction:l="row"})=>{const[c]=Object(f.o)(u.Pb),d=Object(i.useMemo)((()=>null==c?void 0:c.slice(0,t).filter((({url_template:e,name:t})=>!Object(o.isNil)(e)&&!Object(o.isNil)(t)&&!Object(g.c)(e))).map((({name:e,url_template:t})=>({name:V(e)?U[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(s))})))),[c,s,U,t]),p=Object(i.useCallback)((n=>{var a;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&r.a.createElement(A,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(a=n.name)&&void 0!==a?a:s))}),[t,s,e]);return(null==d?void 0:d.length)>0?r.a.createElement("section",null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:l,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(a.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:a},i)=>r.a.createElement(A,{allItemsLimit:d.length,idx:i,overflowIndexStart:e,url:a,"data-test-subj":"externalLinkComponent",key:`reputationLink-${i}`},r.a.createElement(r.a.Fragment,null,n?s:null!=t?t:s))))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(x.f,{rowItems:d,render:p,moreMaxHeight:"200px",overflowIndexStart:e})))):null};G.displayName="ReputationLinkComponent";const H=r.a.memo(G),W=r.a.memo((({children:e,domain:t})=>{const n=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(A,{url:n},e||t)}));W.displayName="WhoIsLink";const Q=T(x.d),Y=T(x.c)},function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l}));const a="document-details-right",i="document-details-left",r="document-details-preview",o="document-details-isolate-host",s="document-details-alert-reason",l="document-details-rule-overview"},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return m}));var a=n(19),i=n(44),r=n(41),o=n.n(r);const s="details",l=o.a.div.attrs((()=>({className:s}))).withConfig({displayName:"Details",componentId:"sc-1ucey7j-0"})(["margin:5px 0 5px 10px;& .euiBadge{margin:2px 0 2px 0;}& .euiFlexGroup{justify-content:center;}"]);l.displayName="Details";const c=o()(a.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1ucey7j-1"})(["margin-left:3px;"]);function u(e){return Object(i.isNumber)(e)?!isFinite(e):Object(i.isEmpty)(e)}c.displayName="TokensFlexItem";const d=({eventCategory:e,eventDataset:t})=>"file"===(null==e?void 0:e.toLowerCase())||"file"===(null==t?void 0:t.toLowerCase())||"endpoint.events.file"===(null==t?void 0:t.toLowerCase()),p=e=>["process_stopped","termination_event"].includes(`${e}`.toLowerCase()),m=e=>["created","creation","deleted","deletion","file_create_event","file_delete_event","files-encrypted","load","modification","overwrite","rename"].includes(`${e}`.toLowerCase())},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(73),i=n.n(a),r=n(2),o=n.n(r),s=n(42),l=n(118),c=n(130),u=n(754),d=n(1270);const p=o.a.memo((({value:e,dateFormat:t=Object(l.h)()})=>o.a.createElement(o.a.Fragment,null,i.a.tz(e,Object(l.m)()).format(t))));p.displayName="PreferenceFormattedDate";const m=({value:e})=>{if(null==e)return Object(c.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(c.f)(e);const n=t.toDate();return o.a.createElement(p,{value:n})};m.displayName="PreferenceFormattedDateFromPrimitive";const f=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,g=o.a.memo((({value:e})=>{const[t]=Object(l.o)("dateFormat:scaled"),n=Array.isArray(t)?t.find(f):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return o.a.createElement(p,{dateFormat:a,value:e})}));g.displayName="PreferenceFormattedP1DTDate";const b=o.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a,tooltipProps:i})=>{if(null==e)return Object(c.f)(e);const r=Object(d.a)(e);return r.isValid()?o.a.createElement(u.a,{date:r.toDate(),fieldName:t,className:n,tooltipProps:i},o.a.createElement(p,{value:r.toDate(),dateFormat:a})):Object(c.f)(e)}));b.displayName="FormattedDate";const y=o.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:r=1})=>{if(null==e)return Object(c.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(c.f)(e);const m=l.toDate(),f=i()(m).add(r,"hours").isBefore(new Date);return o.a.createElement(u.a,{date:m,fieldName:n,className:a},f?o.a.createElement(p,{"data-test-subj":"preference-time",value:m,dateFormat:t}):o.a.createElement(s.FormattedRelative,{"data-test-subj":"relative-time",value:m}))}));y.displayName="FormattedRelativePreferenceDate"},function(e,t,n){"use strict";e.exports=n(722)},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"L",(function(){return r})),n.d(t,"x",(function(){return s})),n.d(t,"I",(function(){return l})),n.d(t,"D",(function(){return c})),n.d(t,"A",(function(){return u})),n.d(t,"H",(function(){return d})),n.d(t,"B",(function(){return p})),n.d(t,"F",(function(){return m})),n.d(t,"y",(function(){return f})),n.d(t,"z",(function(){return g})),n.d(t,"C",(function(){return b})),n.d(t,"G",(function(){return y})),n.d(t,"E",(function(){return h})),n.d(t,"n",(function(){return v})),n.d(t,"Q",(function(){return E})),n.d(t,"P",(function(){return x})),n.d(t,"O",(function(){return j})),n.d(t,"q",(function(){return S})),n.d(t,"p",(function(){return O})),n.d(t,"o",(function(){return k})),n.d(t,"N",(function(){return w})),n.d(t,"l",(function(){return T})),n.d(t,"f",(function(){return I})),n.d(t,"h",(function(){return M})),n.d(t,"g",(function(){return C})),n.d(t,"j",(function(){return _})),n.d(t,"i",(function(){return D})),n.d(t,"k",(function(){return A})),n.d(t,"M",(function(){return F})),n.d(t,"J",(function(){return P})),n.d(t,"K",(function(){return R})),n.d(t,"s",(function(){return L})),n.d(t,"r",(function(){return z})),n.d(t,"u",(function(){return q})),n.d(t,"t",(function(){return B})),n.d(t,"b",(function(){return $})),n.d(t,"c",(function(){return V})),n.d(t,"a",(function(){return U})),n.d(t,"v",(function(){return G})),n.d(t,"m",(function(){return H})),n.d(t,"e",(function(){return W})),n.d(t,"w",(function(){return Q}));var a=n(211);const i=`${a.a}AnalyzerGraph`,r=`${a.a}SessionView`,o=`${a.a}PrevalenceDetails`,s=`${o}DatePicker`,l=`${o}Upsell`,c=`${o}Table`,u=`${c}FieldCell`,d=`${c}ValueCell`,p=`${c}HostCell`,m=`${c}UserCell`,f=`${c}AlertCountCell`,g=`${c}DocCountCell`,b=`${c}HostPrevalenceCell`,y=`${c}UserPrevalenceCell`,h=`${c}UpsellCell`,v=`${a.a}EntitiesDetails`,E=`${a.a}UsersDetails`,x=`${E}RelatedHostsTable`,j=`${E}RelatedHostsLink`,S=`${a.a}HostsDetails`,O=`${S}RelatedUsersTable`,k=`${S}RelatedUsersLink`,w=`${a.a}ThreatIntelligenceDetailsLoading`,T=`${a.a}CorrelationsDetails`,I=`${T}AlertsByAncestrySection`,M=`${T}AlertsBySourceSection`,C=`${T}AlertsBySessionSection`,_=`${T}CasesSection`,D=`${_}Table`,A=`${T}SuppressedAlertsSection`,F=`${T}SuppressedAlertsSectionTechnicalPreview`,N=`${a.a}Response`,P=`${N}Details`,R=`${N}NoData`,L=`${a.a}InvestigationGuide`,z=`${L}Loading`,q=`${a.a}NotesLoading`,B=`${a.a}NotesComment`,$=`${a.a}AddNotesLoading`,V=`${a.a}AddNotesMarkdown`,U=`${a.a}AddNotesButton`,G=`${a.a}NoteAvatar`,H=`${a.a}DeleteNotesButton`,W=`${a.a}AttachToTimelineCheckbox`,Q=`${a.a}OpenTimelineButton`},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=n(34).__importDefault(n(993));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},function(e,t,n){"use strict";e.exports=function(e){return e<-2}},function(e,t,n){"use strict";var a=n(5);n.d(t,"a",(function(){return a.Oc}))},function(e,t,n){"use strict";var a=n(51);n.d(t,"l",(function(){return a.getUseField})),n.d(t,"k",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"g",(function(){return a.UseField})),n.d(t,"h",(function(){return a.UseMultiFields})),n.d(t,"f",(function(){return a.UseArray})),n.d(t,"m",(function(){return a.useForm})),n.d(t,"n",(function(){return a.useFormContext})),n.d(t,"o",(function(){return a.useFormData})),n.d(t,"i",(function(){return a.VALIDATION_TYPES}));var i=n(62);n.d(t,"b",(function(){return i.Field})),n.d(t,"e",(function(){return i.SelectField})),n.d(t,"d",(function(){return i.HiddenField}));var r=n(77);n.d(t,"j",(function(){return r.fieldValidators}))},,function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"y",(function(){return m})),n.d(t,"p",(function(){return f})),n.d(t,"v",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"k",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return E})),n.d(t,"e",(function(){return x})),n.d(t,"q",(function(){return j})),n.d(t,"b",(function(){return S})),n.d(t,"n",(function(){return O})),n.d(t,"i",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"o",(function(){return I})),n.d(t,"c",(function(){return M})),n.d(t,"m",(function(){return C})),n.d(t,"x",(function(){return _})),n.d(t,"w",(function(){return D})),n.d(t,"r",(function(){return A})),n.d(t,"s",(function(){return F})),n.d(t,"t",(function(){return N})),n.d(t,"u",(function(){return P}));var a=n(23),i=n(69),r=n(67),o=n(811),s=n(232),l=n(5),c=n(440),u=n(501),d=n(118);n(178);const p=async({rule:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),m=async({rule:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({rule:e,signal:t})=>d.b.get().http.fetch(l.pb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:a})=>{const i=Object(o.a)(e),r={page:n.page,per_page:n.perPage,sort_field:t.field,sort_order:t.order,...""!==i?{filter:i}:{}};return d.b.get().http.fetch(l.rb,{method:"GET",version:"2023-10-31",query:r,signal:a})},y=async({id:e,signal:t})=>d.b.get().http.fetch(l.qb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),h=async({ids:e,signal:t})=>{var n;return null===(n=(await d.b.get().http.fetch(a.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===n?void 0:n.reduce(((e,{id:t,...n})=>{var a,i;return e[t]={muteAll:null!==(a=n.mute_all)&&void 0!==a&&a,activeSnoozes:null!==(i=n.active_snoozes)&&void 0!==i?i:[],isSnoozedUntil:n.is_snoozed_until?new Date(n.is_snoozed_until):void 0,snoozeSchedule:n.snooze_schedule},e}),{})},v=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),E=async({filter:e,signal:t})=>d.b.get().http.fetch(s.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),x=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function j({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===s.b.edit?e.editPayload:void 0,duplicate:e.type===s.b.duplicate?e.duplicatePayload:void 0,run:e.type===s.b.run?e.runPayload:void 0};return d.b.get().http.fetch(l.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(n),query:{dry_run:t}})}async function S(e){const t={action:s.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(l.ob,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const O=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,overwriteActionConnectors:a=!1,signal:i})=>{const r=new FormData;return r.append("file",e),d.b.get().http.fetch(`${l.qb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n,overwrite_action_connectors:a},body:r,signal:i})},k=async({signal:e})=>d.b.get().http.fetch(s.g,{method:"GET",version:"1",signal:e}),w=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(u.a,{method:"GET",version:"1",query:n,signal:t})},T=async({ruleId:e,items:t,signal:n})=>d.b.get().http.fetch(`${l.qb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:n}),I=({packageName:e,packageVersion:t,prerelease:n=!1,force:a=!0})=>d.b.get().http.post(r.epmRouteService.getInstallPath(e,t),{query:{prerelease:n},version:"2023-10-31",body:JSON.stringify({force:a})}),M=({packages:e,prerelease:t=!1})=>d.b.get().http.post(r.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),C=async({signal:e})=>d.b.get().http.fetch(c.a,{method:"GET",version:"1",signal:e}),_=async({signal:e})=>d.b.get().http.fetch(c.f,{method:"POST",version:"1",signal:e}),D=async({signal:e})=>d.b.get().http.fetch(c.e,{method:"POST",version:"1",signal:e}),A=async()=>d.b.get().http.fetch(c.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),F=async e=>d.b.get().http.fetch(c.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),N=async()=>d.b.get().http.fetch(c.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),P=async e=>d.b.get().http.fetch(c.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},function(e,t,n){"use strict";var a=n(220);e.exports=function(e,t,n,i){var r=i?i-1:1/0,o=0;return function(i){return a(i)?(e.enter(n),s(i)):t(i)};function s(i){return a(i)&&o++<r?(e.consume(i),s):(e.exit(n),t(i))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(44),i=n(2),r=n(45),o=n(138),s=n(124),l=n(148),c=n(200);const u=()=>{const e=Object(r.useDispatch)(),{from:t,to:n}=Object(s.a)((e=>Object(a.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[u,d]=Object(i.useState)(!0),p=Object(i.useRef)([]),m=Object(i.useCallback)((({id:t,inspect:n,loading:a,refetch:i,searchSessionId:r})=>{p.current=[...p.current,t],e(c.c.setQuery({inputId:o.a.global,id:t,inspect:n,loading:a,refetch:i,searchSessionId:r}))}),[e]),f=Object(i.useCallback)((({id:t})=>e(c.c.deleteOneQuery({inputId:o.a.global,id:t}))),[e]);return Object(i.useEffect)((()=>{d(!1)}),[]),Object(i.useEffect)((()=>()=>{p.current.length>0&&p.current.forEach((e=>f({id:e})))}),[f]),Object(i.useMemo)((()=>({isInitializing:u,from:t,to:n,setQuery:m,deleteQuery:f})),[f,t,u,m,n])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"p",(function(){return b})),n.d(t,"y",(function(){return y})),n.d(t,"A",(function(){return h})),n.d(t,"B",(function(){return v})),n.d(t,"C",(function(){return E})),n.d(t,"D",(function(){return x})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return k})),n.d(t,"E",(function(){return w})),n.d(t,"F",(function(){return T})),n.d(t,"G",(function(){return I})),n.d(t,"I",(function(){return M})),n.d(t,"J",(function(){return C})),n.d(t,"K",(function(){return _})),n.d(t,"L",(function(){return D})),n.d(t,"X",(function(){return A})),n.d(t,"Y",(function(){return F})),n.d(t,"Z",(function(){return N})),n.d(t,"ab",(function(){return P})),n.d(t,"z",(function(){return R})),n.d(t,"bb",(function(){return L})),n.d(t,"cb",(function(){return z})),n.d(t,"M",(function(){return q})),n.d(t,"N",(function(){return B})),n.d(t,"P",(function(){return $})),n.d(t,"S",(function(){return V})),n.d(t,"T",(function(){return U})),n.d(t,"Q",(function(){return G})),n.d(t,"R",(function(){return H})),n.d(t,"W",(function(){return W})),n.d(t,"V",(function(){return Q})),n.d(t,"s",(function(){return Y})),n.d(t,"r",(function(){return K})),n.d(t,"w",(function(){return J})),n.d(t,"O",(function(){return Z})),n.d(t,"x",(function(){return X})),n.d(t,"H",(function(){return ee})),n.d(t,"U",(function(){return te})),n.d(t,"t",(function(){return ne})),n.d(t,"v",(function(){return ae})),n.d(t,"u",(function(){return ie}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),r=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),w=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),T=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),I=(a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timeline…"}),a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"})),M=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),C=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),P=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),L=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),z=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),B=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),$=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),V=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),G=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),Q=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),Z=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),ee=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),te=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ne=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ae=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Import…"}),ie=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},function(e,t,n){const a=n(347),{MAX_LENGTH:i,MAX_SAFE_INTEGER:r}=n(348),{safeRe:o,t:s}=n(311),l=n(431),{compareIdentifiers:c}=n(558);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(a("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===n&&(a=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"p",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"l",(function(){return E}));var a=n(7),i=n(20);const r=e=>{if(null!=e){const t=e.trim().split(/[ \t\r\n]+/);return"sequence"===t[0]&&"where"!==t[1]}return!1},o=e=>"eql"===e,s=e=>"threshold"===e,l=e=>"query"===e||"saved_query"===e,c=e=>"threat_match"===e,u=e=>"machine_learning"===e,d=e=>"new_terms"===e,p=e=>"esql"===e,m=e=>Array.isArray(e)?e:Object(a.isEmpty)(e)?[]:[e],f=e=>{var t;return null!==(t=null==e?void 0:e.trim().startsWith("sequence"))&&void 0!==t&&t},g=e=>Array.isArray(e)?e:[e],b=e=>i.e.includes(e),y=e=>b(e),h=e=>!s(e)&&b(e),v=e=>!s(e)&&b(e),E=e=>b(e)&&i.f.includes(e)},,function(e,t,n){"use strict";n.d(t,"D",(function(){return r})),n.d(t,"E",(function(){return o})),n.d(t,"F",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"s",(function(){return u})),n.d(t,"r",(function(){return d})),n.d(t,"v",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"x",(function(){return f})),n.d(t,"z",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"t",(function(){return y})),n.d(t,"B",(function(){return h})),n.d(t,"q",(function(){return v})),n.d(t,"u",(function(){return E})),n.d(t,"A",(function(){return x})),n.d(t,"p",(function(){return j})),n.d(t,"o",(function(){return S})),n.d(t,"C",(function(){return O})),n.d(t,"y",(function(){return k})),n.d(t,"e",(function(){return w})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return M})),n.d(t,"d",(function(){return C})),n.d(t,"f",(function(){return _})),n.d(t,"j",(function(){return D})),n.d(t,"i",(function(){return A})),n.d(t,"k",(function(){return F})),n.d(t,"l",(function(){return N})),n.d(t,"n",(function(){return P})),n.d(t,"m",(function(){return R}));var a=n(67),i=n(203);const r="logs-endpoint.events.*",o="metrics-endpoint.metadata_current_*",s="endpoint.metadata_current-default",l=".metrics-endpoint.metadata_united_default",c=(Object(a.getFileMetadataIndexName)("endpoint"),Object(a.getFileDataIndexName)("endpoint"),"/api/endpoint"),u=`${c}/metadata`,d=`${u}/{id}`,p=`${c}/metadata/transforms`,m=`${c}/policy_response`,f=`${c}/protection_updates_note/{package_policy_id}`,g=`${c}/suggestions/{suggestion_type}`,b=`${c}/action`,y=`${b}/isolate`,h=`${b}/unisolate`,v=`${b}/running_procs`,E=`${b}/kill_process`,x=`${b}/suspend_process`,j=`${b}/get_file`,S=`${b}/execute`,O=`${b}/upload`,k=`${b}/scan`,w=`${c}/action_status`,T=`${b}/{action_id}`,I=`${b}/{action_id}/file/{file_id}`,M=`${b}/{action_id}/file/{file_id}/download`,C=`${b}/state`,_=`/internal${c}/agent_status`,D=i.b.ENROLLED_AT,A="desc",F={ES_CONNECTION_ERROR:-272,OUTPUT_SERVER_ERROR:-273},N="endpointFields",P="endpointSearchStrategy",R="endpointPackagePoliciesStatsStrategy"},function(e,t,n){"use strict";n.d(t,"z",(function(){return i})),n.d(t,"w",(function(){return r})),n.d(t,"x",(function(){return o})),n.d(t,"y",(function(){return s})),n.d(t,"v",(function(){return c})),n.d(t,"u",(function(){return u})),n.d(t,"s",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"t",(function(){return m})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"n",(function(){return E})),n.d(t,"o",(function(){return x})),n.d(t,"m",(function(){return j})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return k})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return T})),n.d(t,"h",(function(){return I})),n.d(t,"c",(function(){return M})),n.d(t,"d",(function(){return C})),n.d(t,"b",(function(){return _}));var a=n(82);const i="/api/lists",r=`${i}/index`,o=`${i}/items`,s=`${i}/privileges`,l="/internal/lists",c=`${l}/_find_lists_by_size`,u=`${l}/_create_filter`,d="/api/exception_lists",p="/api/exception_lists/items",m=`/internal${d}/_create`,f="exception-list-agnostic",g="exception-list",b="/api/endpoint_list",y="endpoint_list",h=Object(a.deepFreeze)({trustedApps:{id:"endpoint_trusted_apps",name:"Endpoint Security Trusted Apps List",description:"Endpoint Security Trusted Apps List"},eventFilters:{id:"endpoint_event_filters",name:"Endpoint Security Event Filters List",description:"Endpoint Security Event Filters List"},hostIsolationExceptions:{id:"endpoint_host_isolation_exceptions",name:"Endpoint Security Host isolation exceptions List",description:"Endpoint Security Host isolation exceptions List"},blocklists:{id:"endpoint_blocklists",name:"Endpoint Security Blocklists List",description:"Endpoint Security Blocklists List"}}),v=Object.freeze(Object.values(h).map((({id:e})=>e))),E=h.trustedApps.id,x=h.trustedApps.name,j=h.trustedApps.description,S=h.eventFilters.id,O=h.eventFilters.name,k=h.eventFilters.description,w=h.hostIsolationExceptions.id,T=h.hostIsolationExceptions.name,I=h.hostIsolationExceptions.description,M=h.blocklists.id,C=h.blocklists.name,_=h.blocklists.description},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p}));var a=n(4);let i=function(e){return e.rules="rules",e.alertsCases="alertsCases",e}({}),r=function(e){return e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase",e}({});const o={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},s=(e,t)=>`tourStepAnchor-${t}-${e}`,l={[i.alertsCases]:[r.pointToAlertName,r.expandEvent]},c={[i.alertsCases]:[r.pointToAlertName,r.expandEvent,r.reviewAlertDetailsFlyout,r.addAlertToCase,r.viewCase]},u=[{...o,step:r.pointToAlertName,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:s(r.pointToAlertName,i.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...o,step:r.expandEvent,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:s(r.expandEvent,i.alertsCases)},{...o,step:r.reviewAlertDetailsFlyout,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${s(r.reviewAlertDetailsFlyout,i.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:s(r.reviewAlertDetailsFlyout,i.alertsCases)},{...o,step:r.addAlertToCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:s(r.addAlertToCase,i.alertsCases)},{...o,step:r.createCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:s(r.createCase,i.alertsCases),offset:20,repositionOnScroll:!1},{...o,step:r.submitCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:s(r.submitCase,i.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...o,step:r.viewCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:s(r.viewCase,i.alertsCases)}],d={title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},p={[i.rules]:[],[i.alertsCases]:u}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},,function(e,t,n){"use strict";n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return f}));var a=n(119),i=n.n(a),r=n(360),o=n(2),s=n.n(o),l=n(236);n.d(t,"d",(function(){return l.e})),n.d(t,"b",(function(){return l.d}));var c=n(127),u=n(814),d=n(904),p=n(475);n.d(t,"a",(function(){return p.b}));const m=r.c,f=({sourcererScopeId:e=c.SourcererScopeName.default,data:t,metadata:n,children:a,...l})=>{const p=Object(u.a)(e),m=Object(d.a)(e),f=JSON.stringify(t),g=Object(o.useMemo)((()=>(Array.isArray(t)?t:[t]).map((({field:e,value:t})=>({field:p(e),value:t}))).filter((e=>!!e.field))),[f,p]),b=Object(o.useMemo)((()=>({...n,dataViewId:m})),[m,n]);return g.length>0?s.a.createElement(r.a,i()({data:g,metadata:b},l),a):s.a.createElement(s.a.Fragment,null,a)}},function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return m}));const a=["failed","pending","successful"],i=["automated","manual"],r=["endpoint","sentinel_one","crowdstrike"],o=["isolate","unisolate","kill-process","suspend-process","running-processes","get-file","execute","upload","scan"],s=["isolate"],l=(Object.freeze({isolate:"writeHostIsolation",release:"writeHostIsolationRelease","kill-process":"writeProcessOperations","suspend-process":"writeProcessOperations",processes:"writeProcessOperations","get-file":"writeFileOperations",execute:"writeExecuteOperations",upload:"writeFileOperations",scan:"writeScanOperations"}),Object.freeze({isolate:"isolate",unisolate:"release",execute:"execute","get-file":"get-file","running-processes":"processes","kill-process":"kill-process","suspend-process":"suspend-process",upload:"upload",scan:"scan"})),c=Object.freeze({isolate:"isolate",release:"unisolate",execute:"execute","get-file":"get-file",processes:"running-processes","kill-process":"kill-process","suspend-process":"suspend-process",upload:"upload",scan:"scan"}),u=Object.freeze({isolate:"isolation",release:"isolation",execute:"execute","get-file":"get_file",processes:"running_processes","kill-process":"kill_process","suspend-process":"suspend_process",upload:"upload_file",scan:"scan"}),d=Object.freeze({isolate:"canIsolateHost",release:"canUnIsolateHost",execute:"canWriteExecuteOperations","get-file":"canWriteFileOperations",upload:"canWriteFileOperations",processes:"canGetRunningProcesses","kill-process":"canKillProcess","suspend-process":"canSuspendProcess",scan:"canWriteScanOperations"}),p=Object.freeze({endpoint:"elastic",sentinel_one:"Elastic@123",crowdstrike:"tbd.."}),m=Object.freeze({endpoint:"agent.id",sentinel_one:"observer.serial_number",crowdstrike:"device.id"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return Qe})),n.d(t,"c",(function(){return Ye})),n.d(t,"f",(function(){return Ke})),n.d(t,"d",(function(){return Je})),n.d(t,"e",(function(){return Ze}));var a=n(120),i=n(199),r=n(464),o=n(466),s=n(463),l=n(467),c=n(468),u=n(469),d=n(470);const p=a.z.object({name:i.K,description:i.B,risk_score:i.r,severity:i.Y}),m=a.z.object({rule_name_override:i.L.optional(),timestamp_override:i.db.optional(),timestamp_override_fallback_disabled:i.eb.optional(),timeline_id:i.bb.optional(),timeline_title:i.cb.optional(),outcome:i.V.optional(),alias_target_id:i.U.optional(),alias_purpose:i.T.optional(),license:i.I.optional(),note:i.j.optional(),building_block_type:i.f.optional(),output_index:i.d.optional(),namespace:i.e.optional(),meta:i.J.optional(),investigation_fields:i.i.optional(),throttle:i.z.optional()}),f=a.z.object({version:i.S.optional(),tags:i.R.optional(),enabled:i.k.optional(),risk_score_mapping:i.s.optional(),severity_mapping:i.Z.optional(),interval:i.F.optional(),from:i.G.optional(),to:i.H.optional(),actions:a.z.array(i.t).optional(),exceptions_list:a.z.array(i.C).optional(),author:i.A.optional(),false_positives:i.D.optional(),references:i.O.optional(),max_signals:i.n.optional(),threat:i.ab.optional(),setup:i.X.optional(),related_integrations:i.o.optional(),required_fields:a.z.array(i.q).optional()}),g=p.merge(m).merge(f),b=p.partial().merge(m).merge(f),y=p.merge(m).merge(f.required()),h=a.z.object({id:i.M,rule_id:i.P,immutable:i.l,rule_source:i.Q.optional(),updated_at:a.z.string().datetime(),updated_by:a.z.string(),created_at:a.z.string().datetime(),created_by:a.z.string(),revision:a.z.number().int().min(0),required_fields:i.p,execution_summary:r.a.optional()}),v=g.merge(a.z.object({rule_id:i.P.optional()})),E=g.merge(a.z.object({id:i.M.optional(),rule_id:i.P.optional()})),x=b.merge(a.z.object({id:i.M.optional(),rule_id:i.P.optional()})),j=y.merge(h),S=a.z.literal("eql"),O=a.z.object({type:a.z.literal("eql"),query:i.N,language:S}),k=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),event_category_override:o.a.optional(),tiebreaker_field:o.b.optional(),timestamp_field:o.c.optional(),alert_suppression:i.a.optional()}),w=O.merge(k),T=O.merge(k),I=O.partial().merge(k),M=j.merge(T),C=v.merge(w),_=E.merge(w),D=x.merge(I),A=a.z.object({type:a.z.literal("query")}),F=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),response_actions:a.z.array(s.a).optional(),alert_suppression:i.a.optional()}),N=a.z.object({query:i.N.optional(),language:i.m.optional()}),P=A.merge(F).merge(N),R=A.partial().merge(F).merge(N),L=A.merge(F).merge(N.required()),z=j.merge(L),q=v.merge(P),B=E.merge(P),$=x.merge(R),V=a.z.object({type:a.z.literal("saved_query"),saved_id:i.W}),U=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),response_actions:a.z.array(s.a).optional(),alert_suppression:i.a.optional(),query:i.N.optional()}),G=a.z.object({language:i.m.optional()}),H=V.merge(U).merge(G),W=V.partial().merge(U).merge(G),Q=V.merge(U).merge(G.required()),Y=j.merge(Q),K=v.merge(H),J=E.merge(H),Z=x.merge(W),X=a.z.object({type:a.z.literal("threshold"),query:i.N,threshold:l.a}),ee=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),alert_suppression:l.b.optional()}),te=a.z.object({language:i.m.optional()}),ne=X.merge(ee).merge(te),ae=X.partial().merge(ee).merge(te),ie=X.merge(ee).merge(te.required()),re=j.merge(ie),oe=v.merge(ne),se=E.merge(ne),le=x.merge(ae),ce=a.z.object({type:a.z.literal("threat_match"),query:i.N,threat_query:c.g,threat_mapping:c.f,threat_index:c.d}),ue=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),saved_id:i.W.optional(),threat_filters:c.c.optional(),threat_indicator_path:c.e.optional(),threat_language:i.m.optional(),concurrent_searches:c.a.optional(),items_per_search:c.b.optional(),alert_suppression:i.a.optional()}),de=a.z.object({language:i.m.optional()}),pe=ce.merge(ue).merge(de),me=ce.partial().merge(ue).merge(de),fe=ce.merge(ue).merge(de.required()),ge=j.merge(fe),be=v.merge(pe),ye=E.merge(pe),he=x.merge(me),ve=a.z.object({type:a.z.literal("machine_learning"),anomaly_threshold:u.a,machine_learning_job_id:u.b}),Ee=a.z.object({alert_suppression:i.a.optional()}),xe=ve.partial().merge(Ee),je=ve.merge(Ee),Se=ve.merge(Ee),Oe=j.merge(je),ke=v.merge(Se),we=E.merge(Se),Te=x.merge(xe),Ie=a.z.object({type:a.z.literal("new_terms"),query:i.N,new_terms_fields:d.b,history_window_start:d.a}),Me=a.z.object({index:i.h.optional(),data_view_id:i.g.optional(),filters:i.E.optional(),alert_suppression:i.a.optional()}),Ce=a.z.object({language:i.m.optional()}),_e=Ie.partial().merge(Me).merge(Ce),De=Ie.merge(Me).merge(Ce.required()),Ae=Ie.merge(Me).merge(Ce),Fe=j.merge(De),Ne=v.merge(Ae),Pe=E.merge(Ae),Re=x.merge(_e),Le=a.z.literal("esql"),ze=a.z.object({type:a.z.literal("esql"),language:Le,query:i.N}),qe=a.z.object({alert_suppression:i.a.optional()}),Be=qe.merge(ze.partial()),$e=qe.merge(ze),Ve=qe.merge(ze),Ue=j.merge($e),Ge=v.merge(Ve),He=E.merge(Ve),We=x.merge(Be.partial()),Qe=a.z.discriminatedUnion("type",[w,P,H,ne,pe,Se,Ae,Ve]),Ye=(a.z.union([I,R,W,ae,me,xe,_e,Be]),a.z.discriminatedUnion("type",[T,L,Q,ie,fe,je,De,$e]),a.z.discriminatedUnion("type",[C,q,K,oe,be,ke,Ne,Ge])),Ke=a.z.discriminatedUnion("type",[_,B,J,se,ye,we,Pe,He]),Je=a.z.union([D,$,Z,le,he,Te,Re,We]),Ze=a.z.discriminatedUnion("type",[M,z,Y,re,ge,Oe,Fe,Ue])},,function(e,t,n){"use strict";n.d(t,"xc",(function(){return i})),n.d(t,"dc",(function(){return r})),n.d(t,"fc",(function(){return o})),n.d(t,"zd",(function(){return s})),n.d(t,"yd",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"wc",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"Tb",(function(){return p})),n.d(t,"yc",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"t",(function(){return g})),n.d(t,"r",(function(){return b})),n.d(t,"u",(function(){return y})),n.d(t,"x",(function(){return h})),n.d(t,"s",(function(){return v})),n.d(t,"n",(function(){return E})),n.d(t,"v",(function(){return x})),n.d(t,"A",(function(){return j})),n.d(t,"g",(function(){return S})),n.d(t,"o",(function(){return O})),n.d(t,"j",(function(){return k})),n.d(t,"q",(function(){return w})),n.d(t,"w",(function(){return T})),n.d(t,"h",(function(){return I})),n.d(t,"p",(function(){return M})),n.d(t,"k",(function(){return C})),n.d(t,"i",(function(){return _})),n.d(t,"z",(function(){return D})),n.d(t,"y",(function(){return A})),n.d(t,"ib",(function(){return F})),n.d(t,"gb",(function(){return N})),n.d(t,"hb",(function(){return P})),n.d(t,"kb",(function(){return R})),n.d(t,"mb",(function(){return L})),n.d(t,"E",(function(){return z})),n.d(t,"m",(function(){return q})),n.d(t,"C",(function(){return B})),n.d(t,"l",(function(){return $})),n.d(t,"D",(function(){return V})),n.d(t,"jb",(function(){return U})),n.d(t,"lb",(function(){return G})),n.d(t,"pb",(function(){return H})),n.d(t,"ob",(function(){return W})),n.d(t,"nb",(function(){return Q})),n.d(t,"eb",(function(){return Y})),n.d(t,"T",(function(){return K})),n.d(t,"F",(function(){return J})),n.d(t,"V",(function(){return Z})),n.d(t,"G",(function(){return X})),n.d(t,"I",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"H",(function(){return ne})),n.d(t,"U",(function(){return ae})),n.d(t,"W",(function(){return ie})),n.d(t,"X",(function(){return re})),n.d(t,"P",(function(){return oe})),n.d(t,"bb",(function(){return se})),n.d(t,"Q",(function(){return le})),n.d(t,"fb",(function(){return ce})),n.d(t,"S",(function(){return ue})),n.d(t,"R",(function(){return de})),n.d(t,"cb",(function(){return pe})),n.d(t,"db",(function(){return me})),n.d(t,"N",(function(){return fe})),n.d(t,"M",(function(){return ge})),n.d(t,"L",(function(){return be})),n.d(t,"K",(function(){return ye})),n.d(t,"O",(function(){return he})),n.d(t,"Z",(function(){return ve})),n.d(t,"Y",(function(){return Ee})),n.d(t,"ab",(function(){return xe})),n.d(t,"Yb",(function(){return je})),n.d(t,"od",(function(){return Se})),n.d(t,"nd",(function(){return Oe})),n.d(t,"td",(function(){return ke})),n.d(t,"rd",(function(){return we})),n.d(t,"rb",(function(){return Te})),n.d(t,"qd",(function(){return Ie})),n.d(t,"Ub",(function(){return Me})),n.d(t,"jc",(function(){return Ce})),n.d(t,"kc",(function(){return _e})),n.d(t,"Sb",(function(){return De})),n.d(t,"Zb",(function(){return Ae})),n.d(t,"Pb",(function(){return Fe})),n.d(t,"lc",(function(){return Ne})),n.d(t,"mc",(function(){return Pe})),n.d(t,"Eb",(function(){return Re})),n.d(t,"Db",(function(){return Le})),n.d(t,"Fb",(function(){return ze})),n.d(t,"yb",(function(){return qe})),n.d(t,"Ab",(function(){return Be})),n.d(t,"zb",(function(){return $e})),n.d(t,"Hb",(function(){return Ve})),n.d(t,"xb",(function(){return Ue})),n.d(t,"sb",(function(){return Ge})),n.d(t,"Gb",(function(){return He})),n.d(t,"vb",(function(){return We})),n.d(t,"wb",(function(){return Qe})),n.d(t,"Bb",(function(){return Ye})),n.d(t,"Cb",(function(){return Ke})),n.d(t,"tb",(function(){return Je})),n.d(t,"ub",(function(){return Ze})),n.d(t,"Wb",(function(){return Xe})),n.d(t,"Rb",(function(){return et})),n.d(t,"Jb",(function(){return tt})),n.d(t,"Vb",(function(){return nt})),n.d(t,"wd",(function(){return at})),n.d(t,"pd",(function(){return it})),n.d(t,"ed",(function(){return rt})),n.d(t,"tc",(function(){return ot})),n.d(t,"gd",(function(){return st})),n.d(t,"nc",(function(){return lt})),n.d(t,"sc",(function(){return ct})),n.d(t,"oc",(function(){return ut})),n.d(t,"pc",(function(){return dt})),n.d(t,"qc",(function(){return pt})),n.d(t,"rc",(function(){return mt})),n.d(t,"Kb",(function(){return ft})),n.d(t,"b",(function(){return gt})),n.d(t,"md",(function(){return bt})),n.d(t,"fd",(function(){return yt})),n.d(t,"Lb",(function(){return ht})),n.d(t,"a",(function(){return vt})),n.d(t,"ld",(function(){return Et})),n.d(t,"c",(function(){return xt})),n.d(t,"uc",(function(){return jt})),n.d(t,"Ib",(function(){return St})),n.d(t,"Mb",(function(){return Ot})),n.d(t,"ec",(function(){return kt})),n.d(t,"sd",(function(){return wt})),n.d(t,"gc",(function(){return Tt})),n.d(t,"vc",(function(){return It})),n.d(t,"vd",(function(){return Mt})),n.d(t,"bc",(function(){return Ct})),n.d(t,"cc",(function(){return _t})),n.d(t,"B",(function(){return Dt})),n.d(t,"ud",(function(){return At})),n.d(t,"Ob",(function(){return Ft})),n.d(t,"Nb",(function(){return Nt})),n.d(t,"zc",(function(){return Pt})),n.d(t,"qb",(function(){return Rt})),n.d(t,"Yc",(function(){return Lt})),n.d(t,"Zc",(function(){return zt})),n.d(t,"Xc",(function(){return qt})),n.d(t,"Vc",(function(){return Bt})),n.d(t,"Wc",(function(){return $t})),n.d(t,"Kc",(function(){return Vt})),n.d(t,"Lc",(function(){return Ut})),n.d(t,"Ic",(function(){return Gt})),n.d(t,"Jc",(function(){return Ht})),n.d(t,"Cc",(function(){return Wt})),n.d(t,"Dc",(function(){return Qt})),n.d(t,"Ac",(function(){return Yt})),n.d(t,"Bc",(function(){return Kt})),n.d(t,"Tc",(function(){return Jt})),n.d(t,"Uc",(function(){return Zt})),n.d(t,"Rc",(function(){return Xt})),n.d(t,"Sc",(function(){return en})),n.d(t,"Gc",(function(){return tn})),n.d(t,"Hc",(function(){return nn})),n.d(t,"Ec",(function(){return an})),n.d(t,"Fc",(function(){return rn})),n.d(t,"cd",(function(){return on})),n.d(t,"ad",(function(){return sn})),n.d(t,"dd",(function(){return ln})),n.d(t,"bd",(function(){return cn})),n.d(t,"Oc",(function(){return un})),n.d(t,"Qc",(function(){return dn})),n.d(t,"Pc",(function(){return pn})),n.d(t,"Mc",(function(){return mn})),n.d(t,"Nc",(function(){return fn})),n.d(t,"kd",(function(){return gn})),n.d(t,"hd",(function(){return bn})),n.d(t,"Xb",(function(){return yn})),n.d(t,"Qb",(function(){return hn})),n.d(t,"id",(function(){return vn})),n.d(t,"hc",(function(){return En})),n.d(t,"ic",(function(){return xn})),n.d(t,"xd",(function(){return jn})),n.d(t,"ac",(function(){return Sn})),n.d(t,"jd",(function(){return On}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Manage value lists"}),s=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRunTitle",{defaultMessage:"Manual run"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.investigationFieldsTitle",{defaultMessage:"Custom highlighted fields"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),_=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),F=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),N=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),R=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),L=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be scheduled"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),q=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),B=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),V=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),U=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),G=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkManualRuleRunConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Schedule {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorMessage",{defaultMessage:"This action can only be applied"}),W=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorTitle",{values:{rulesCount:e},defaultMessage:"Manual rule run cannot be scheduled for more than {rulesCount, plural, =1 {# rule} other {# rules}}"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkManualRuleRunLimitErrorCloseButton",{defaultMessage:"Close"}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),le=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),ue=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),de=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),pe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.investigationFieldsRequiredErrorMessage",{defaultMessage:"A minimum of one custom highlighted field is required."}),ge=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsOverwriteCheckboxLabel",{defaultMessage:"Overwrite the custom highlighted fields for the selected rules"}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxLabel",{defaultMessage:"Add custom highlighted fields for selected rules"}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter fields that you want to add.  You can choose from any of the fields included in the default Elastic Security indices."}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addInvestigationFieldsTitle",{defaultMessage:"Add custom highlighted fields"}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxLabel",{defaultMessage:"Delete custom highlighted fields for selected rules"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsComboboxHelpText",{defaultMessage:"Enter the fields that you want to remove from the selected rules. After you remove these fields, they will no longer appear in the Highlighted fields section of the alerts generated by selected rules."}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteInvestigationFieldsTitle",{defaultMessage:"Delete custom highlighted fields"}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),Se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CK™ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),ke=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),we=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),Te=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),Ie=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),_e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunDescription",{defaultMessage:"Manual run"}),Pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.manualRuleRunTooltip",{defaultMessage:"Manual run available only for enabled rules"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.integrationsTitle",{defaultMessage:"Integrations"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),Je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Xe=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),it=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),st=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),ct=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),ut=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),dt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),ft=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),ht=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),Et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),St=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),Ot=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),kt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),wt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),Tt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),It=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),Mt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),Ct=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),_t=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),Dt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),At=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),Ft=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),Nt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),Pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),Rt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),Lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),zt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),Bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),$t=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),Vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),Ut=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),Ht=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Wt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),Qt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),Kt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),Jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),Zt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),en=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),tn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),nn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),an=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),rn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),on=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastTitle",{defaultMessage:"Rules scheduled"}),sn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastTitle",{defaultMessage:"Error scheduling manual rule run"}),ln=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully scheduled manual rule run for {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),cn=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.manualRuleRun.errorToastDescription",{values:{failedRulesCount:e},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to schedule manual rule run."}),un=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),dn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),pn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),mn=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),fn=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),gn=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),bn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),yn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),hn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),vn=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),En=a.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),xn=e=>a.i18n.translate("xpack.securitySolution.addRules.installRuleButton.ariaLabel",{defaultMessage:'Install "{ruleName}"',values:{ruleName:e}}),jn=a.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),Sn=a.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),On=a.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return f}));var a=n(19),i=n(2),r=n.n(i),o=n(138),s=n(514),l=n(474),c=n(447),u=n(650);const d="inspectButtonComponent",p=({children:e,show:t=!0})=>r.a.createElement(s.a,{show:t,targetClassNames:[d]},e),m=({compact:e=!1,inputId:t=o.a.global,inspectIndex:n=0,isDisabled:i,multiple:s=!1,onCloseInspect:p,queryId:m="",showInspectButton:f=!0,title:g=""})=>{const{additionalRequests:b,additionalResponses:y,handleClick:h,handleCloseModal:v,isButtonDisabled:E,isShowingModal:x,loading:j,request:S,response:O}=Object(c.a)({inputId:t,inspectIndex:n,isDisabled:i,multiple:s,onCloseInspect:p,queryId:m});return r.a.createElement(r.a.Fragment,null,t===o.a.timeline&&!e&&f&&r.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":u.d,"data-test-subj":"inspect-empty-button",isDisabled:E,isLoading:j,onClick:h},u.d),(t===o.a.global||e)&&f&&r.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":u.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:E,title:u.d,onClick:h}),x&&null!==S&&null!==O&&r.a.createElement(l.a,{additionalRequests:b,additionalResponses:y,closeModal:v,"data-test-subj":"inspect-modal",inputId:t,request:S,response:O,title:g}))};m.displayName="InspectButtonComponent";const f=r.a.memo(m)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return k})),n.d(t,"f",(function(){return T})),n.d(t,"b",(function(){return z})),n.d(t,"g",(function(){return q}));var a=n(979),i=n(44),r=n(50),o=n(413),s=n.n(o),l=n(45),c=n(2),u=n(513),d=n(121),p=n(146),m=n(556),f=n(158),g=n(243),b=n(179),y=n(705),h=n(396),v=n(292),E=n(274),x=n(129);const j="open-timeline",S=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,O=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),k=({title:e})=>null==e||0===e.trim().length,w=(e,t)=>"__typename"===e?void 0:t,T=e=>JSON.parse(JSON.stringify(e),w),I=e=>{try{return JSON.parse(e)}catch{return e}},M=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:I(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:I(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:I(e.meta.value)}:{}},...null!=e.exists?{exists:I(e.exists)}:{},...null!=e.match_all?{exists:I(e.match_all)}:{},...null!=e.missing?{exists:I(e.missing)}:{},...null!=e.query?{query:I(e.query)}:{},...null!=e.range?{range:I(e.range)}:{},...null!=e.script?{exists:I(e.script)}:{}}),C=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},_=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},D=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},A=(e,t,n)=>n===d.m.default&&e.timelineType===d.m.template?e.templateTimelineId:t&&e.timelineType===d.m.template?Object(r.v4)():e.templateTimelineId,F=({and:e,...t})=>t.type===d.a.template?s()(t,{type:d.a.default,enabled:t.queryMatch.operator!==b.d,queryMatch:{value:t.queryMatch.operator===b.d?"":t.queryMatch.value}}):t,N=(e,t,n)=>e&&t&&n===d.m.default?t.map((e=>{var t,n;return{...F(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(F))&&void 0!==t?t:[]}})):t,P=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",R=(e,t,n)=>n&&e.timelineType!==n?d.l.draft:t?d.l.active:e.status,L=(e,t,n,i)=>{const r=e.timelineType===d.m.template,o=i?g.b:E.a,s={...e,columns:null!=e.columns?e.columns.map((e=>((e,t)=>{var n;return Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:g.a,id:null!=e.id?e.id:"unknown",initialWidth:null===(n=t.find((t=>e.id===t.id)))||void 0===n?void 0:n.initialWidth})})(e,o))):o,defaultColumns:o,dateRange:e.status===d.l.immutable&&e.timelineType===d.m.template?{start:h.a.toISOString(),end:h.b.toISOString()}:e.dateRange,dataProviders:N(t,e.dataProviders,n),excludedRowRendererIds:r?[]:Object.keys(d.e),eventIdToNoteIds:C(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(M):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:D(t,e.pinnedEventIds),pinnedEventsSaveObject:_(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:R(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:P(e,t,n),templateTimelineId:A(e,t,n),templateTimelineVersion:t&&r?1:e.templateTimelineVersion};return Object.entries(s).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...f.b,id:""})},z=(e,t=!1,n,a)=>{const{notes:i,...r}=e;return{notes:i,timeline:L(r,t,n,a)}},q=()=>{const{resetDiscoverAppState:e}=Object(u.a)(),t=Object(m.a)(),n=Object(l.useDispatch)(),a=Object(c.useCallback)((e=>n(x.a.updateIsLoading(e))),[n]);return({activeTimelineTab:n=p.d.query,duplicate:r=!1,graphEventId:o="",timelineId:s,timelineType:l,onError:c,onOpenTimeline:u,openTimeline:m=!0,savedSearchId:b,unifiedComponentsInTimelineDisabled:x=!1})=>{if(a({id:p.c.active,isLoading:!0}),null!=s)return Promise.resolve(Object(v.j)(s)).then((a=>{const s=Object(i.getOr)(null,"data",a);if(!s)return;const c=T(s.timeline),{timeline:d,notes:f}=z(c,r,l,x);if(null!=u)u(d);else if(t){const{from:a,to:l}=Object(y.a)({from:Object(i.getOr)(null,"dateRange.start",d),to:Object(i.getOr)(null,"dateRange.end",d)});return t({duplicate:r,from:a,id:p.c.active,notes:f,resolveTimelineConfig:{outcome:s.outcome,alias_target_id:s.alias_target_id,alias_purpose:s.alias_purpose},timeline:{...d,activeTab:n,graphEventId:o,show:m,dateRange:{start:a,end:l},savedSearchId:d.savedSearchId},to:l,preventSettingQuery:!0}),e(d.savedSearchId)}})).catch((e=>{null!=c&&c(e,s)})).finally((()=>{a({id:p.c.active,isLoading:!1})}));t({id:p.c.active,duplicate:!1,notes:[],from:h.a.toISOString(),to:h.b.toISOString(),timeline:{...f.b,columns:x?g.b:E.a,id:p.c.active,activeTab:n,show:m,initialized:!0,savedSearchId:null!=b?b:null,excludedRowRendererIds:x||l===d.m.template?[]:f.b.excludedRowRendererIds}}),e(),a({id:p.c.active,isLoading:!1})}}},function(e,t,n){"use strict";var a,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function o(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},a=[],i=0;i<e.length;i++){var s=e[i],l=t.base?s[0]+t.base:s[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var d=o(u),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(r[d].references++,r[d].updater(p)):r.push({identifier:u,updater:g(p,t),references:1}),a.push(u)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=n.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,n,a){var i=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var r=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(r,o[t]):e.appendChild(r)}}function p(e,t,n){var a=n.css,i=n.media,r=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,f=0;function g(e,t){var n,a,i;if(t.singleton){var r=f++;n=m||(m=l(t)),a=d.bind(null,n,r,!1),i=d.bind(null,n,r,!0)}else n=l(t),a=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var i=o(n[a]);r[i].references--}for(var l=s(e,t),c=0;c<n.length;c++){var u=o(n[c]);0===r[u].references&&(r[u].updater(),r.splice(u,1))}n=l}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,a,i,r=e[1]||"",o=e[3];if(!o)return r;if(t&&"function"==typeof btoa){var s=(n=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[r].concat(l).concat([s]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(2),i=n(118);const r={managed:!0},o=()=>{const{services:{apm:e}}=Object(i.j)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:r)),[e])}},s=e=>`Timeline search ${e}`},,function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return y}));var a=n(2),i=n(44),r=n(45),o=n(271),s=n.n(o),l=n(58),c=n(213),u=n(124),d=n(1361),p=n(246),m=n(21);const f=(e,t,n)=>{const i=Object(r.useDispatch)(),o=Object(c.g)(e);Object(a.useEffect)((()=>{const a=n&&""!==n?n:e,r=o();return i(d.a.registerUrlParam({key:a,initialValue:r})),t(r),()=>{i(d.a.deregisterUrlParam({key:a}))}}),[])},g=e=>{const t=Object(r.useDispatch)();return Object(a.useCallback)((n=>{t(d.a.updateUrlParam({key:e,value:n}))}),[t,e])},b=()=>{const e=Object(u.b)(d.c.selectGlobalUrlParam);return Object(a.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((n=>{const a=e[n];if(a&&("object"!=typeof a||!Object(i.isEmpty)(a)))try{t[n]=Object(l.encode)(a)}catch{}})),Object(c.b)(Object(i.pickBy)((e=>!Object(i.isEmpty)(e)),t))):""}),[e])},y=()=>{const[{pageName:e}]=Object(p.a)(),t=Object(u.b)(d.c.selectGlobalUrlParam),n=s()(t),r=Object(c.h)();Object(a.useEffect)((()=>{var a;const o=null!==(a=Object(m.b)(e))&&void 0!==a?a:{skipUrlState:!0},s={...t};o.skipUrlState&&Object.keys(s).forEach((e=>{s[e]=null})),Object(i.difference)(Object.keys(null!=n?n:{}),Object.keys(t)).forEach((e=>{s[e]=null})),Object.keys(s).length>0&&r(s)}),[n,t,e,r])}},function(e,t,n){const a=n(164);e.exports=(e,t,n)=>new a(e,n).compare(new a(t,n))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.alert="alert",e.asset="asset",e.enrichment="enrichment",e.event="event",e.metric="metric",e.state="state",e.pipeline_error="pipeline_error",e.signal="signal",e}({})},function(e,t,n){class Range{constructor(e,t){if(t=i(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!g(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&b(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&m)|(this.options.loose&&f))+":"+e,n=a.get(t);if(n)return n;const i=this.options.loose,s=i?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(s,I(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),o("comparator trim",e),e=e.replace(l[c.TILDETRIM],d),o("tilde trim",e),e=e.replace(l[c.CARETTRIM],p),o("caret trim",e);let b=e.split(" ").map((e=>h(e,this.options))).join(" ").split(/\s+/).map((e=>T(e,this.options)));i&&(b=b.filter((e=>(o("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE]))))),o("range list",b);const y=new Map,v=b.map((e=>new r(e,this.options)));for(const e of v){if(g(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const E=[...y.values()];return a.set(t,E),E}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((n=>y(n,t)&&e.set.some((e=>y(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new s(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(M(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const a=new(n(1119)),i=n(431),r=n(386),o=n(347),s=n(164),{safeRe:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=n(311),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:f}=n(348),g=e=>"<0.0.0-0"===e.value,b=e=>""===e.value,y=(e,t)=>{let n=!0;const a=e.slice();let i=a.pop();for(;n&&a.length;)n=a.every((e=>i.intersects(e,t))),i=a.pop();return n},h=(e,t)=>(o("comp",e,t),e=j(e,t),o("caret",e),e=E(e,t),o("tildes",e),e=O(e,t),o("xrange",e),e=w(e,t),o("stars",e),e),v=e=>!e||"x"===e.toLowerCase()||"*"===e,E=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{const n=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(n,((t,n,a,i,r)=>{let s;return o("tilde",e,t,n,a,i,r),v(n)?s="":v(a)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:v(i)?s=`>=${n}.${a}.0 <${n}.${+a+1}.0-0`:r?(o("replaceTilde pr",r),s=`>=${n}.${a}.${i}-${r} <${n}.${+a+1}.0-0`):s=`>=${n}.${a}.${i} <${n}.${+a+1}.0-0`,o("tilde return",s),s}))},j=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{o("caret",e,t);const n=t.loose?l[c.CARETLOOSE]:l[c.CARET],a=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,r,s)=>{let l;return o("caret",e,t,n,i,r,s),v(n)?l="":v(i)?l=`>=${n}.0.0${a} <${+n+1}.0.0-0`:v(r)?l="0"===n?`>=${n}.${i}.0${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${a} <${+n+1}.0.0-0`:s?(o("replaceCaret pr",s),l="0"===n?"0"===i?`>=${n}.${i}.${r}-${s} <${n}.${i}.${+r+1}-0`:`>=${n}.${i}.${r}-${s} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${r}-${s} <${+n+1}.0.0-0`):(o("no pr"),l="0"===n?"0"===i?`>=${n}.${i}.${r}${a} <${n}.${i}.${+r+1}-0`:`>=${n}.${i}.${r}${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${r} <${+n+1}.0.0-0`),o("caret return",l),l}))},O=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map((e=>k(e,t))).join(" ")),k=(e,t)=>{e=e.trim();const n=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(n,((n,a,i,r,s,l)=>{o("xRange",e,n,a,i,r,s,l);const c=v(i),u=c||v(r),d=u||v(s),p=d;return"="===a&&p&&(a=""),l=t.includePrerelease?"-0":"",c?n=">"===a||"<"===a?"<0.0.0-0":"*":a&&p?(u&&(r=0),s=0,">"===a?(a=">=",u?(i=+i+1,r=0,s=0):(r=+r+1,s=0)):"<="===a&&(a="<",u?i=+i+1:r=+r+1),"<"===a&&(l="-0"),n=`${a+i}.${r}.${s}${l}`):u?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${r}.0${l} <${i}.${+r+1}.0-0`),o("xRange return",n),n}))},w=(e,t)=>(o("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),T=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),I=e=>(t,n,a,i,r,o,s,l,c,u,d,p)=>`${n=v(a)?"":v(i)?`>=${a}.0.0${e?"-0":""}`:v(r)?`>=${a}.${i}.0${e?"-0":""}`:o?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=v(c)?"":v(u)?`<${+c+1}.0.0-0`:v(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),M=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(o(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const a=e[n].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}},function(e,t,n){"use strict";n.d(t,"c",(function(){return l.a})),n.d(t,"h",(function(){return l.d})),n.d(t,"d",(function(){return c.a})),n.d(t,"i",(function(){return c.b})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p.b})),n.d(t,"f",(function(){return p.a})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return h}));var a=n(44),i=n(2),r=n(454),o=n(529),s=n(364),l=n(258),c=n(276),u=(n(5),n(207));const d=(e,t)=>`/${e}${Object(u.a)(t)}`;var p=n(375);const m=(e,t)=>`/${e}${Object(u.a)(t)}`,f=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,g=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(u.a)(null!=t?t:void 0)}`,b=e=>`/create${Object(u.a)(null!=e?e:void 0)}`,y=e=>{const{getAppUrl:t}=Object(s.a)(),n=Object(o.b)(e);return{formatUrl:Object(i.useCallback)(((i,{absolute:r=!1,skipSearch:o=!1}={})=>{const s=function(e,t,n){const[i,r]=e.split("?");return`${i}${n?Object(a.isEmpty)(r)?"":`?${r}`:Object(a.isEmpty)(r)?t:`?${r}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}(i,n,o);return t({deepLinkId:e,path:s,absolute:r})}),[t,e,n]),search:n}},h=()=>{const e=Object(r.f)(),t=Object(o.a)();return Object(i.useCallback)((({deepLinkId:n,path:a="",absolute:i=!1,skipSearch:r=!1})=>{const o=r?"":t(n);return e({id:n,path:a,urlState:o,absolute:i})}),[e,t])}},,function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return f}));var a=n(19),i=n(41),r=n.n(i);const o=r.a.div.withConfig({displayName:"SecuritySolutionAppWrapper",componentId:"sc-2kezi3-0"})(["display:flex;flex-direction:column;flex:1 1 auto;width:100%;"]);o.displayName="SecuritySolutionAppWrapper";const s=()=>Object(i.css)([".euiOverlayMask[data-relative-to-header='below']{top:0 !important;}.euiFlyout{top:0 !important;height:100% !important;}"]),l=Object(i.createGlobalStyle)([".euiDataGridRowCell__popover{max-width:815px !important;max-height:none !important;overflow:hidden;.expandable-top-value-button{&.euiButtonEmpty:focus{background-color:transparent;}}&.euiPopover__panel[data-popover-open]{padding:8px 0;min-width:65px;}.euiPopoverFooter{border:0;margin-top:0;.euiFlexGroup{flex-direction:column;}}.euiText + .euiPopoverFooter{border-top:1px solid ",";margin-top:",";}}.euiPanel-loading-hide-border{border:none;}body.euiBody-hasOverlayMask{.euiDataGridRowCell__popover[data-popover-open],.withHoverActions__popover[data-popover-open]{visibility:hidden !important;}}.euiScreenReaderOnly{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeS)),c=r()(a.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-2kezi3-1"})(["",""],(({theme:e})=>`\n    word-break: break-word;\n    dt {\n      font-size: ${e.eui.euiFontSizeXS} !important;\n    }\n    dd {\n      width: fit-content;\n    }\n    dd > div {\n      width: fit-content;\n    }\n  `));c.displayName="DescriptionListStyled";const u=r()(a.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-2kezi3-2"})(["margin-left:5px;"]);u.displayName="CountBadge";const d=r.a.span.withConfig({displayName:"Spacer",componentId:"sc-2kezi3-3"})(["margin-left:5px;"]);d.displayName="Spacer";const p=r()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-2kezi3-4"})(["vertical-align:top;"]);p.displayName="Badge";const m=r()(a.EuiIcon).withConfig({displayName:"MoreRowItems",componentId:"sc-2kezi3-5"})(["margin-left:5px;"]);m.displayName="MoreRowItems";const f=r()(a.EuiFlexGroup).withConfig({displayName:"OverviewWrapper",componentId:"sc-2kezi3-6"})(["position:relative;.euiButtonIcon{position:absolute;right:",";top:6px;z-index:2;}"],(e=>e.theme.eui.euiSizeM));f.displayName="OverviewWrapper"},function(e,t,n){"use strict";n.d(t,"C",(function(){return i})),n.d(t,"q",(function(){return r})),n.d(t,"v",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"o",(function(){return l})),n.d(t,"p",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"B",(function(){return p})),n.d(t,"r",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"y",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"E",(function(){return y})),n.d(t,"w",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"x",(function(){return E})),n.d(t,"z",(function(){return x})),n.d(t,"t",(function(){return j})),n.d(t,"s",(function(){return S})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return k})),n.d(t,"F",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"A",(function(){return I})),n.d(t,"D",(function(){return M})),n.d(t,"e",(function(){return C})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return D})),n.d(t,"i",(function(){return A})),n.d(t,"h",(function(){return F})),n.d(t,"j",(function(){return N}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),p=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),m=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),y=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),h=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),v=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),E=a.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),x=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),j=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),O=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),w=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),T=Object.freeze({tried:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),I=a.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),M=a.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),C=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),_=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),D=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),A=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),F=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),N=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return _}));var a=n(189),i=n(45),r=n(2),o=n(138),s=n(118),l=n(148),c=n(183),u=n(44),d=n(122),p=n(705),m=n(346);var f=n(271),g=n.n(f),b=n(213),y=n(246);var h=n(58),v=n(149),E=n(184),x=n(169),j=n(129),S=n(124),O=n(48);const k=({search:e,urlKey:t})=>Object(b.d)(Object(b.e)(e),t);var w=n(1799),T=n(1630),I=n(1490),M=n(5);const C=()=>{Object(a.c)(),(()=>{const e=Object(i.useDispatch)(),{filterManager:t,savedQueries:n}=Object(s.j)().services.data.query,u=Object(r.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),d=Object(i.useSelector)(u),p=Object(r.useCallback)((t=>{null!=t&&e(c.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),m=Object(r.useCallback)((n=>{null!=n?(t.setFilters(n),e(c.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(c.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(r.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],i=n.attributes.query;t.setFilters(a),e(c.b.setSearchBarFilter({id:o.a.global,filters:a})),e(c.b.setFilterQuery({id:o.a.global,...i})),e(c.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(a.b)(_.appQuery,p),Object(a.b)(_.filters,m),Object(a.b)(_.savedQuery,f)})(),(()=>{const e=Object(i.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),n=Object(r.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(u.get)("global.linkTo",e)},i=Object(u.get)("global.timerange.kind",e),r={linkTo:Object(u.get)("timeline.linkTo",e)},s=Object(u.get)("timeline.timerange.kind",e),l={linkTo:Object(u.get)("socTrends.linkTo",e)},d=Object(u.get)("socTrends.timerange.kind",e);if(n&&(Object(u.isEmpty)(l.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.socTrends])):t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(a.linkTo)?(t(c.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(c.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(r.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.timeline])):t(c.b.addLinkTo([o.a.global,o.a.timeline])),s){if("absolute"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(i){if("absolute"===i){const n=Object(p.a)(Object(u.get)("global.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===i){const n=Object(p.a)(Object(u.get)("global.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&d){if("absolute"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(a.b)(_.timerange,n)})(),(()=>{const[{pageName:e}]=Object(y.a)(),t=Object(i.useDispatch)(),n=g()(e),a=Object(r.useMemo)((()=>l.d.inputsSelector()),[]),s=Object(i.useSelector)(a),{timerange:u}=s.global,{timerange:d}=s.timeline;Object(r.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(b.f)(e))(e,n)&&("relative"===d.kind&&t(c.b.setRelativeRangeDatePicker({...d,from:Object(m.c)(d.fromStr),to:Object(m.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===u.kind&&t(c.b.setRelativeRangeDatePicker({...u,from:Object(m.c)(u.fromStr),to:Object(m.c)(u.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,u])})(),(()=>{const e=Object(d.a)("unifiedComponentsInTimelineDisabled"),t=Object(d.a)("timelineEsqlTabDisabled"),n=Object(E.g)(),o=Object(i.useSelector)((e=>Object(x.selectTimelineById)(e,v.f.active))),s=Object(r.useCallback)((a=>{null!=a&&n({activeTimelineTab:a.activeTab===v.g.esql&&t?v.g.query:a.activeTab,duplicate:!1,graphEventId:a.graphEventId,timelineId:a.id,openTimeline:a.isOpen,savedSearchId:a.savedSearchId,unifiedComponentsInTimelineDisabled:e})}),[t,n,e]);Object(r.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(_.timeline);if(!e)return;const t=Object(h.safeDecode)(e);(function(e,t){return e&&t&&(e.id!==t.id||e.savedSearchId!==t.savedSearchId||e.graphEventId!==t.graphEventId)})(o,t)||s(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[s,o]),Object(a.b)(_.timeline,s)})(),(()=>{const e=Object(a.d)(_.timeline),t=Object(r.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:i,show:o,savedObjectId:s,savedSearchId:l}=Object(S.b)((e=>{var n;return null!==(n=t(e,v.f.active))&&void 0!==n?n:{}}));Object(r.useEffect)((()=>{const t={...s?{id:s}:{},isOpen:o,activeTab:n,graphEventId:null!=i?i:"",savedSearchId:l||void 0};e(t)}),[n,i,s,o,e,l])})(),(()=>{var e;const t=Object(r.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),n=Object(S.b)((e=>t(e,v.f.active))),{search:a}=Object(O.useLocation)(),i=g()(a),o=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",s=Object(d.a)("unifiedComponentsInTimelineDisabled"),[l,c]=Object(r.useMemo)((()=>{const e=k({urlKey:_.timeline,search:null!=i?i:""}),t=k({urlKey:_.timeline,search:a});return null!=e&&null!=t?[Object(h.safeDecode)(e),Object(h.safeDecode)(t)]:[null,null]}),[i,a]),u=null==l?void 0:l.id,{id:p,activeTab:m,graphEventId:f}=c||{},b=Object(E.g)();Object(r.useEffect)((()=>{p&&p!==u&&p!==o&&b({activeTimelineTab:null!=m?m:v.g.query,duplicate:!1,graphEventId:f,timelineId:p,openTimeline:!0,unifiedComponentsInTimelineDisabled:s})}),[o,u,p,m,f,b,s])})(),(()=>{const{search:e}=Object(O.useLocation)(),t=Object(d.a)("expandableFlyoutDisabled"),[n,o]=Object(r.useState)(null),[s,l]=Object(r.useState)(!1),c=Object(i.useDispatch)(),u=w.b.getTableByIdSelector(),p=Object(S.b)((e=>{var t;return null!==(t=u(e,T.b.alertsOnAlertsPage))&&void 0!==t?t:I.d})),m=Object(r.useCallback)((e=>{t&&null!=e&&e.panelView&&o(e)}),[t]),f=Object(r.useCallback)((()=>{if(!t)return;const{initialized:e,isLoading:a,totalCount:i,additionalFilters:r}=p,o=e&&!a&&i>0;n&&(r&&r.showBuildingBlockAlerts||c(w.a.updateShowBuildingBlockAlertsFilter({id:T.b.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),o&&(l(!0),c(w.a.toggleDetailPanel({id:T.b.alertsOnAlertsPage,...n}))))}),[p,c,t,n]);Object(r.useEffect)((()=>{t&&!s&&f()}),[s,t,f]);const g=k({urlKey:_.eventFlyout,search:e});let b="",y="";t&&(g?(b=_.eventFlyout,y=_.flyout):b=_.flyout),Object(a.b)(b,m,y)})(),(()=>{const e=Object(d.a)("expandableFlyoutDisabled"),t=Object(a.d)(_.flyout),{pathname:n}=Object(O.useLocation)(),o=Object(i.useDispatch)(),s=w.b.getTableByIdSelector(),{expandedDetail:l}=Object(S.b)((e=>{var t;return null!==(t=s(e,T.b.alertsOnAlertsPage))&&void 0!==t?t:I.d}));Object(r.useEffect)((()=>{var a;if(!e)return;const i=n===M.d;i&&null!=l&&null!=l&&l.query?t(l.query.panelView?l.query:null):!i&&null!=l&&null!==(a=l.query)&&void 0!==a&&a.panelView&&(o(w.a.toggleDetailPanel({id:T.b.alertsOnAlertsPage})),t(null))}),[o,l,e,n,t])})()},_={appQuery:"query",eventFlyout:"eventFlyout",flyout:"flyout",timelineFlyout:"timelineFlyout",filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},,function(e,t,n){"use strict";var a=n(260);n.d(t,"a",(function(){return a.a}));var i=n(337);n.d(t,"b",(function(){return i.a}));var r=n(183);n.d(t,"c",(function(){return r.b}));var o=n(166);n.d(t,"d",(function(){return o.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(956);const r=()=>Object(a.useContext)(i.a)},,function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c}));let a=function(e){return e.windows="windows",e.mac="mac",e.linux="linux",e}({}),i=function(e){return e.is="is",e.matches="matches",e}({}),r=function(e){return e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled",e}({}),o=function(e){return e.detect="detect",e.prevent="prevent",e.off="off",e}({}),s=function(e){return e.enabled="enabled",e.disabled="disabled",e.sync="sync_with_malware_prevent",e}({}),l=function(e){return e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported",e}({}),c=function(e){return e.ENROLLED_AT="enrolled_at",e.HOSTNAME="metadata.host.hostname",e.HOST_STATUS="host_status",e.POLICY_NAME="metadata.Endpoint.policy.applied.name",e.POLICY_STATUS="metadata.Endpoint.policy.applied.status",e.HOST_OS_NAME="metadata.host.os.name",e.HOST_IP="metadata.host.ip",e.AGENT_VERSION="metadata.agent.version",e.LAST_SEEN="last_checkin",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"x",(function(){return S})),n.d(t,"y",(function(){return O})),n.d(t,"m",(function(){return k})),n.d(t,"k",(function(){return w})),n.d(t,"n",(function(){return T})),n.d(t,"l",(function(){return I})),n.d(t,"d",(function(){return M})),n.d(t,"e",(function(){return C})),n.d(t,"i",(function(){return _})),n.d(t,"q",(function(){return D})),n.d(t,"r",(function(){return A})),n.d(t,"h",(function(){return F})),n.d(t,"p",(function(){return xe})),n.d(t,"t",(function(){return je})),n.d(t,"f",(function(){return Se})),n.d(t,"j",(function(){return Oe})),n.d(t,"v",(function(){return ke})),n.d(t,"w",(function(){return we})),n.d(t,"b",(function(){return Te})),n.d(t,"s",(function(){return Ie})),n.d(t,"o",(function(){return Le})),n.d(t,"g",(function(){return ze})),n.d(t,"u",(function(){return qe})),n.d(t,"c",(function(){return Be}));var a=n(455),i=n(269),r=n(1619),o=n(799),s=n(1328),l=n(46);const c=l.number,u=(l.union([c,l[void 0]]),l.number),d=(l.union([u,l[void 0]]),l.string),p=l.exact(l.type({id:d,keepAlive:l.union([l.string,l[void 0]])})),m=(l.union([p,l[void 0]]),l.number),f=(l.union([m,l[void 0]]),l.intersection([l.exact(l.type({data:l.array(o.a),page:c,per_page:u,total:m})),l.exact(l.partial({pit:d}))])),g=l.intersection([l.exact(l.type({data:l.array(s.a),page:c,per_page:u,total:m})),l.exact(l.partial({pit:d}))]);l.union([o.a,l.exact(l.type({}))]);var b=n(168),y=n(426),h=n(344);const v=async e=>Object(y.pipe)(await e(),Object(h.fold)((e=>Promise.reject(e)),(e=>Promise.resolve(e)))),E=e=>e instanceof Error?e:new Error(String(e)),x="2023-10-31",j=async({http:e,listItem:t,signal:n})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(b.p,{body:JSON.stringify(t),method:"POST",signal:n,version:x}))({http:e,listItem:t,signal:n})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(s.a,e)))),Object(i.flow)(v))(),S=async({http:e,list:t,signal:n})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,list:t,signal:n})=>e.fetch(b.s,{body:JSON.stringify(t),method:"PUT",signal:n,version:x}))({http:e,list:t,signal:n})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(o.a,e)))),Object(i.flow)(v))(),O=async({http:e,listItem:t,signal:n})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(b.p,{body:JSON.stringify(t),method:"PUT",signal:n,version:x}))({http:e,listItem:t,signal:n})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(s.a,e)))),Object(i.flow)(v))(),k=async({filters:e,http:t,namespaceTypes:n,pagination:o,signal:s,sort:l})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,filters:t,namespaceTypes:n,pagination:a,signal:i,sort:r})=>{const o={filter:t||void 0,namespace_type:n,page:a.page?`${a.page}`:"1",per_page:a.perPage?`${a.perPage}`:"20",sort_field:null!=r&&r.field?null==r?void 0:r.field:"exception-list.created_at",sort_order:null!=r&&r.order?null==r?void 0:r.order:"desc"};return e.fetch(`${b.s}/_find`,{method:"GET",query:o,signal:i,version:x})})({filters:e,http:t,namespaceTypes:n,pagination:o,signal:s,sort:l})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(f,e)))),Object(i.flow)(v))(),w=async({http:e,id:t,namespaceType:n,signal:s})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.s,{method:"GET",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:s})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(o.a,e)))),Object(i.flow)(v))(),T=async({filter:e,http:t,listIds:n,namespaceTypes:o,pagination:s,search:l,signal:c})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listIds:t,namespaceTypes:n,filter:a,pagination:i,search:r,signal:o})=>{const s={list_id:t.join(","),namespace_type:n.join(","),page:i.page?`${i.page}`:"1",per_page:i.perPage?`${i.perPage}`:"20",search:r,sort_field:"exception-list.created_at",sort_order:"desc",filter:a};return e.fetch(`${b.p}/_find`,{method:"GET",query:s,signal:o,version:x})})({filter:e,http:t,listIds:n,namespaceTypes:o,pagination:s,search:l,signal:c})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(g,e)))),Object(i.flow)(v))(),I=async({http:e,id:t,namespaceType:n,signal:o})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.p,{method:"GET",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:o})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(s.a,e)))),Object(i.flow)(v))(),M=async({http:e,id:t,namespaceType:n,signal:s})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.s,{method:"DELETE",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:s})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(o.a,e)))),Object(i.flow)(v))(),C=async({http:e,id:t,namespaceType:n,signal:o})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(b.p,{method:"DELETE",query:{id:t,namespace_type:n},signal:a,version:x}))({http:e,id:t,namespaceType:n,signal:o})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(s.a,e)))),Object(i.flow)(v))(),_=async({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:i,signal:r})=>e.fetch(`${b.s}/_export`,{method:"POST",query:{id:t,list_id:a,namespace_type:i,include_expired_exceptions:n},signal:r,version:x}),D=async({alias:e,chunkSize:t,exceptionListIds:n,excludeExceptions:a,http:i,signal:r})=>i.fetch(b.u,{method:"POST",version:"1",body:JSON.stringify({exception_list_ids:n,type:"exception_list_ids",alias:e,exclude_exceptions:a,chunk_size:t}),signal:r}),A=async({exceptions:e,alias:t,excludeExceptions:n,http:a,chunkSize:i,signal:r})=>a.fetch(b.u,{method:"POST",version:"1",body:JSON.stringify({exceptions:e,type:"exception_items",alias:t,exclude_exceptions:n,chunk_size:i}),signal:r}),F=async({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:i})=>e.fetch(`${b.s}/_duplicate`,{method:"POST",query:{list_id:n,namespace_type:a,include_expired_exceptions:t},signal:i,version:x}),N=new l.Type("StringToPositiveNumber",l.number.is,((e,t)=>h.either.chain(l.string.validate(e,t),(n=>{const a=+n;return 0===n.trim().length||isNaN(a)||a<=0?l.failure(e,t):l.success(a)}))),String),P=l.string,R=(l.union([P,l[void 0]]),l.string),L=(l.union([R,l[void 0]]),l.string),z=(l.union([L,l[void 0]]),l.keyof({asc:null,desc:null})),q=(l.union([z,l[void 0]]),l.exact(l.partial({cursor:P,filter:R,page:N,per_page:N,sort_field:L,sort_order:z})));var B=n(2070),$=n(345);const V=l.string,U=l.union([V,l[void 0]]);var G=n(275);const H=l.string,W=l.union([H,l[void 0]]);var Q=n(397),Y=n(1531);Y.a;const K=l.union([Y.a,l[void 0]]);var J=n(398),Z=n(399),X=n(214),ee=n(800),te=n(400),ne=n(457),ae=n(458),ie=n(401),re=n(402);const oe=l.exact(l.type({_version:$.b,"@timestamp":K,created_at:Q.a,created_by:J.a,description:Z.a,deserializer:U,id:X.a,immutable:ee.a,meta:G.b,name:te.a,serializer:W,tie_breaker_id:ne.a,type:ae.a,updated_at:ie.a,updated_by:re.a,version:B.a})),se=(l.array(oe),l.exact(l.type({cursor:P,data:l.array(oe),page:c,per_page:u,total:m})));l.exact(l.type({largeLists:l.array(oe),smallLists:l.array(oe)}));var le=n(255);const ce=l.union([l.literal("true"),l.literal("false")]),ue=l.union([l.literal("true"),l.literal("false"),l.literal("wait_for")]),de=l.exact(l.partial({deserializer:V,list_id:le.a,serializer:H,type:ae.a,refresh:ue})),pe=l.object,me=l.exact(l.type({file:pe})),fe=new l.Type("DefaultStringBooleanFalse",l.boolean.is,((e,t)=>null==e?l.success(!1):"string"==typeof e&&"true"===e.toLowerCase()?l.success(!0):"string"==typeof e&&"false"===e.toLowerCase()?l.success(!1):l.boolean.validate(e,t)),l.identity),ge=l.intersection([l.exact(l.type({id:X.a})),l.exact(l.partial({deleteReferences:fe,ignoreReferences:fe}))]),be=l.exact(l.type({list_id:le.a})),ye=l.exact(l.type({list_index:l.boolean,list_item_index:l.boolean})),he=l.exact(l.type({acknowledged:l.boolean})),ve=l.exact(l.type({id:X.a})),Ee="2023-10-31",xe=async({cursor:e,http:t,pageIndex:n,pageSize:o,signal:s,sortField:l,sortOrder:c})=>Object(y.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=o?o.toString():void 0,sort_field:null!=l?l.toString():void 0,sort_order:c},(e=>Object(a.fromEither)(Object(r.b)(q,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({http:e,cursor:t,page:n,per_page:a,signal:i,sort_field:r,sort_order:o})=>e.fetch(`${b.z}/_find`,{method:"GET",query:{cursor:t,page:n,per_page:a,sort_field:r,sort_order:o},signal:i,version:Ee}))({http:t,signal:s,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(se,e)))),Object(i.flow)(v)),je=async({file:e,http:t,listId:n,type:i,signal:o,refresh:s})=>Object(y.pipe)({list_id:n,type:i,refresh:s},(e=>Object(a.fromEither)(Object(r.b)(de,e))),Object(a.chain)((t=>Object(y.pipe)(Object(a.fromEither)(Object(r.b)(me,{file:e})),Object(a.map)((e=>({...e,...t})))))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({file:e,http:t,list_id:n,type:a,signal:i,refresh:r})=>{const o=new FormData;return o.append("file",e),t.fetch(`${b.x}/_import`,{body:o,headers:{"Content-Type":void 0},method:"POST",query:{list_id:n,type:a,refresh:r},signal:i,version:Ee})})({http:t,signal:o,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(oe,e)))),v),Se=async({deleteReferences:e,http:t,id:n,ignoreReferences:o,signal:s})=>Object(y.pipe)({deleteReferences:e,id:n,ignoreReferences:o},(e=>Object(a.fromEither)(Object(r.b)(ge,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({deleteReferences:e=!1,http:t,id:n,ignoreReferences:a=!1,signal:i})=>t.fetch(b.z,{method:"DELETE",query:{deleteReferences:e,id:n,ignoreReferences:a},signal:i,version:Ee}))({http:t,signal:s,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(oe,e)))),Object(i.flow)(v)),Oe=async({http:e,listId:t,signal:n})=>Object(y.pipe)({list_id:t},(e=>Object(a.fromEither)(Object(r.b)(be,e))),Object(a.chain)((t=>Object(a.tryCatch)((()=>(async({http:e,list_id:t,signal:n})=>e.fetch(`${b.x}/_export`,{method:"POST",query:{list_id:t},signal:n,version:Ee}))({http:e,signal:n,...t})),E))),Object(i.flow)(v)),ke=async({http:e,signal:t})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(b.w,{method:"GET",signal:t,version:Ee}))({http:e,signal:t})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(ye,e)))),Object(i.flow)(v))(),we=async({http:e,signal:t})=>e.fetch(b.y,{method:"GET",signal:t,version:Ee}),Te=async({http:e,signal:t})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(b.w,{method:"POST",signal:t,version:Ee}))({http:e,signal:t})),E)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(he,e)))),Object(i.flow)(v))(),Ie=async({http:e,signal:t,id:n})=>Object(y.pipe)({id:n},(e=>Object(a.fromEither)(Object(r.b)(ve,e))),Object(a.chain)((n=>Object(a.tryCatch)((()=>(async({http:e,signal:t,id:n})=>e.fetch(`${b.z}`,{method:"GET",query:{id:n},signal:t,version:Ee}))({http:e,signal:t,...n})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(oe,e)))),Object(i.flow)(v)),Me=l.intersection([l.exact(l.type({list_id:le.a})),l.exact(l.partial({cursor:P,filter:R,page:N,per_page:N,sort_field:L,sort_order:z}))]),Ce=l.string,_e=l.union([Ce,l[void 0]]),De=l.exact(l.type({_version:$.b,"@timestamp":K,created_at:Q.a,created_by:J.a,deserializer:U,id:X.a,list_id:le.a,meta:G.b,serializer:W,tie_breaker_id:ne.a,type:ae.a,updated_at:ie.a,updated_by:re.a,value:Ce})),Ae=(l.array(De),l.exact(l.type({cursor:P,data:l.array(De),page:c,per_page:u,total:m}))),Fe=l.intersection([l.exact(l.type({value:_e})),l.exact(l.partial({id:X.a,list_id:le.a,refresh:ce}))]),Ne=l.intersection([l.exact(l.type({id:X.a})),l.exact(l.partial({_version:$.a,meta:G.a,value:Ce,refresh:ce}))]),Pe=l.intersection([l.exact(l.type({list_id:le.a,value:Ce})),l.exact(l.partial({id:X.a,meta:G.a,refresh:ue}))]),Re="2023-10-31",Le=async({cursor:e,http:t,pageIndex:n,pageSize:o,signal:s,sortField:l,sortOrder:c,filter:u,listId:d})=>Object(y.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=o?o.toString():void 0,sort_field:null!=l?l.toString():void 0,filter:null!=u?u.toString():void 0,sort_order:c,list_id:d},(e=>Object(a.fromEither)(Object(r.b)(Me,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({http:e,cursor:t,page:n,list_id:a,per_page:i,signal:r,sort_field:o,sort_order:s,filter:l})=>e.fetch(`${b.x}/_find`,{method:"GET",query:{cursor:t,page:n,per_page:i,sort_field:o,sort_order:s,list_id:a,filter:l},signal:r,version:Re}))({http:t,signal:s,...e})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(Ae,e)))),Object(i.flow)(v)),ze=async({http:e,id:t,signal:n,refresh:o})=>Object(y.pipe)({id:t,refresh:o},(e=>Object(a.fromEither)(Object(r.b)(Fe,e))),Object(a.chain)((t=>Object(a.tryCatch)((()=>(async({http:e,id:t,signal:n,refresh:a})=>e.fetch(b.x,{method:"DELETE",query:{id:t,refresh:a},signal:n,version:Re}))({http:e,signal:n,...t,value:void 0,list_id:void 0})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(De,e)))),Object(i.flow)(v)),qe=async({http:e,id:t,signal:n,value:o,refresh:s,_version:l})=>Object(y.pipe)({id:t,value:o,_version:l,refresh:s},(e=>Object(a.fromEither)(Object(r.b)(Ne,e))),Object(a.chain)((t=>Object(a.tryCatch)((()=>(async({http:e,id:t,signal:n,value:a,_version:i})=>e.fetch(b.x,{method:"PATCH",body:JSON.stringify({id:t,value:a,_version:i}),signal:n,version:Re}))({http:e,signal:n,...t})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(De,e)))),Object(i.flow)(v)),Be=async({http:e,signal:t,value:n,refresh:o,listId:s})=>Object(y.pipe)({list_id:s,value:n,refresh:o},(e=>Object(a.fromEither)(Object(r.b)(Pe,e))),Object(a.chain)((n=>Object(a.tryCatch)((()=>(async({http:e,signal:t,value:n,list_id:a,refresh:i})=>e.fetch(b.x,{method:"POST",body:JSON.stringify({value:n,list_id:a,refresh:i}),signal:t,version:Re}))({http:e,signal:t,...n})),E))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.b)(De,e)))),Object(i.flow)(v))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(2),i=n(45),r=n(138),o=n(5),s=n(124),l=n(148),c=n(200);const u=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(s.b)(l.d.globalFullScreenSelector))&&void 0!==e&&e,u=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add(o.Gc,"euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove(o.Gc,"euiDataGrid__restrictBody"),t(c.c.setFullScreen({id:r.a.global,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({globalFullScreen:n,setGlobalFullScreen:u})),[n,u])},d=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(s.b)(l.d.timelineFullScreenSelector))&&void 0!==e&&e,o=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add("euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove("euiDataGrid__restrictBody"),t(c.c.setFullScreen({id:r.a.timeline,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({timelineFullScreen:n,setTimelineFullScreen:o})),[n,o])},p=()=>{const{globalFullScreen:e}=u(),{timelineFullScreen:t}=d(),n=(()=>{const[e,t]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const e=document.body,n=new MutationObserver((n=>{for(const a of n)"class"===a.attributeName&&t(e.classList.contains("euiDataGrid__restrictBody"))}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[]),e})();return e||t||n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(44);const i=e=>Object(a.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(2),i=n(8),r=n.n(i),o=n(452);const s=e=>{const t=Object(o.b)(),n=r()(t.sections$,t.getSectionsValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},l=e=>{const t=Object(o.b)(),n=r()(t.messages$,t.getMessagesValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},c=e=>{const t=Object(o.b)(),n=Object(a.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=n?n:null}},,function(e,t,n){"use strict";n.d(t,"f",(function(){return Pe})),n.d(t,"b",(function(){return Re})),n.d(t,"c",(function(){return Le})),n.d(t,"e",(function(){return ze})),n.d(t,"d",(function(){return qe})),n.d(t,"a",(function(){return Be}));var a=n(2),i=n.n(a),r=n(1216),o=n(122),s=n(145),l=n(118),c=n(41),u=n.n(c),d=n(19),p=(n(43),n(537)),m=n(142),f=n(192),g=n(125);const b=Object(a.memo)((({selectedTabId:e,setSelectedTabId:t,tabs:n})=>{const{getFieldsData:a}=Object(g.b)(),r=Object(m.a)(a("event.kind"))===f.a.signal,o=n.map(((n,a)=>i.a.createElement(d.EuiTab,{onClick:()=>{return e=n.id,t(e);var e},isSelected:n.id===e,key:a,"data-test-subj":n["data-test-subj"]},n.name)));return i.a.createElement(y,{$_css:Object(d.useEuiBackgroundColor)("subdued")},i.a.createElement(d.EuiTabs,{size:"l",expand:r},o))}));b.displayName="PanelHeader";var y=u()(p.a).withConfig({displayName:"_StyledFlyoutHeader",componentId:"sc-1qgelk0-0"})(["background-color:",";padding-bottom:0 !important;border-block-end:none !important;"],(e=>e.$_css)),h=n(418);const v=({selectedTabId:e,tabs:t})=>{const n=Object(a.useMemo)((()=>{var n;return null===(n=t.find((t=>t.id===e)))||void 0===n?void 0:n.content}),[e,t]);return i.a.createElement(E,{$_css:Object(d.useEuiBackgroundColor)("subdued")},n)};v.displayName="PanelContent";var E=u()(h.a).withConfig({displayName:"_StyledFlyoutBody",componentId:"sc-1pfozwl-0"})(["background-color:",";"],(e=>e.$_css)),x=n(42),j=n(45),S=n(4),O=n(384),k=n(285),w=n(149),T=n(129),I=n(153),M=n(123),C=n(289),_=n(300);const D=S.i18n.translate("xpack.securitySolution.notes.markdownAriaLabel",{defaultMessage:"Note"}),A=S.i18n.translate("xpack.securitySolution.notes.addNoteBtnLabel",{defaultMessage:"Add note"}),F=S.i18n.translate("xpack.securitySolution.notes.createNoteErrorLabel",{defaultMessage:"Error create note"}),N=S.i18n.translate("xpack.securitySolution.notes.attachToTimelineCheckboxLabel",{defaultMessage:"Attach to active timeline"}),P=S.i18n.translate("xpack.securitySolution.notes.attachToTimelineInfoLabel",{defaultMessage:"The active timeline must be saved before a note can be associated with it"}),R=Object(a.memo)((({eventId:e})=>{const{telemetry:t}=Object(l.j)().services,n=Object(j.useDispatch)(),{addError:r}=Object(M.a)(),[o,s]=Object(a.useState)(""),[c,u]=Object(a.useState)(!1),p=Object(j.useSelector)((e=>T.b.selectTimelineById(e,w.f.active))),m=Object(O.a)()===k.a.timeline,[f,g]=Object(a.useState)(!0),b=Object(a.useCallback)((e=>g(e.target.checked)),[]),y=Object(j.useSelector)((e=>Object(C.j)(e))),h=Object(j.useSelector)((e=>Object(C.i)(e))),v=Object(a.useCallback)((()=>{n(Object(C.b)({note:{timelineId:f&&(null==p?void 0:p.savedObjectId)||"",eventId:e,note:o}})),t.reportAddNoteFromExpandableFlyoutClicked({isRelatedToATimeline:f&&null!==(null==p?void 0:p.savedObjectId)}),s("")}),[null==p?void 0:p.savedObjectId,f,n,o,e,t]);Object(a.useEffect)((()=>{y===C.a.Failed&&h&&r(null,{title:F})}),[r,h,y]);const E=Object(a.useMemo)((()=>0===o.trim().length||c),[o,c]),x=Object(a.useMemo)((()=>m&&null!=p.savedObjectId),[null==p?void 0:p.savedObjectId,m]),S=Object(a.useMemo)((()=>!m||m&&null==(null==p?void 0:p.savedObjectId)),[null==p?void 0:p.savedObjectId,m]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiCommentList,null,i.a.createElement(d.EuiComment,{username:""},i.a.createElement(_.a,{dataTestSubj:I.c,value:o,onChange:s,ariaLabel:D,setIsMarkdownInvalid:u}))),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",responsive:!1},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiCheckbox,{"data-test-subj":I.e,id:"xpack.securitySolution.notes.attachToTimelineCheckboxId",label:i.a.createElement(i.a.Fragment,null,N,i.a.createElement(d.EuiToolTip,{position:"top",content:P},i.a.createElement(L,{type:"iInCircle"}))),disabled:S,checked:x&&f,onChange:e=>b(e)}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{onClick:v,isLoading:y===C.a.Loading,disabled:E,"data-test-subj":I.a},A))))}));R.displayName="AddNote";var L=u()(d.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-sgqe0x-0"})(["margin-left:4px;"]),z=n(184),q=n(140);const B=S.i18n.translate("xpack.securitySolution.notes.addedANoteLabel",{defaultMessage:"added a note"}),$=S.i18n.translate("xpack.securitySolution.notes.fetchNotesErrorLabel",{defaultMessage:"Error fetching notes"}),V=S.i18n.translate("xpack.securitySolution.notes.noNotesLabel",{defaultMessage:"No notes have been created for this document"}),U=S.i18n.translate("xpack.securitySolution.notes.deleteNoteLabel",{defaultMessage:"Delete note"}),G=S.i18n.translate("xpack.securitySolution.notes.deleteNoteErrorLabel",{defaultMessage:"Error deleting note"}),H=Object(a.memo)((({eventId:e})=>{const t=Object(j.useDispatch)(),{addError:n}=Object(M.a)(),{kibanaSecuritySolutionsPrivileges:r}=Object(q.a)(),s=r.crud,l=Object(o.a)("unifiedComponentsInTimelineDisabled"),c=Object(j.useSelector)((e=>Object(C.n)(e))),u=Object(j.useSelector)((e=>Object(C.m)(e))),p=Object(j.useSelector)((t=>Object(C.w)(t,{documentId:e,sort:{field:"created",direction:"desc"}}))),m=Object(j.useSelector)((e=>Object(C.j)(e))),f=Object(j.useSelector)((e=>Object(C.l)(e))),g=Object(j.useSelector)((e=>Object(C.k)(e))),[b,y]=Object(a.useState)(""),h=Object(a.useCallback)((e=>{y(e),t(Object(C.c)({ids:[e]}))}),[t]),v=Object(z.g)(),E=Object(a.useCallback)((({timelineId:e})=>v({duplicate:!1,onOpenTimeline:void 0,timelineId:e,timelineType:void 0,unifiedComponentsInTimelineDisabled:l})),[v,l]);return Object(a.useEffect)((()=>{c===C.a.Failed&&u&&n(null,{title:$})}),[n,u,c]),Object(a.useEffect)((()=>{f===C.a.Failed&&g&&n(null,{title:G})}),[n,g,f]),c===C.a.Loading?i.a.createElement(d.EuiLoadingElastic,{"data-test-subj":I.u,size:"xxl"}):c===C.a.Succeeded&&0===p.length?i.a.createElement("p",null,V):i.a.createElement(d.EuiCommentList,null,p.map(((e,t)=>i.a.createElement(d.EuiComment,{"data-test-subj":`${I.t}-${t}`,key:e.noteId,username:e.createdBy,timestamp:i.a.createElement(i.a.Fragment,null,e.created&&i.a.createElement(x.FormattedRelative,{value:new Date(e.created)})),event:B,actions:i.a.createElement(i.a.Fragment,null,e.timelineId&&e.timelineId.length>0&&i.a.createElement(d.EuiButtonIcon,{"data-test-subj":`${I.w}-${t}`,title:"Open timeline","aria-label":"Open timeline",color:"text",iconType:"timeline",onClick:()=>E(e)}),s&&i.a.createElement(d.EuiButtonIcon,{"data-test-subj":`${I.m}-${t}`,title:U,"aria-label":U,color:"text",iconType:"trash",onClick:()=>h(e.noteId),disabled:b!==e.noteId&&f===C.a.Loading,isLoading:b===e.noteId&&f===C.a.Loading})),timelineAvatar:i.a.createElement(d.EuiAvatar,{"data-test-subj":`${I.v}-${t}`,size:"l",name:e.updatedBy||"?"})},i.a.createElement(_.b,null,e.note||"")))),m===C.a.Loading&&i.a.createElement(d.EuiLoadingElastic,{size:"xxl","data-test-subj":I.b}))}));H.displayName="NotesList";const W=Object(a.memo)((()=>{const e=Object(j.useDispatch)(),{eventId:t}=Object(g.b)(),{kibanaSecuritySolutionsPrivileges:n}=Object(q.a)(),r=n.crud;return Object(a.useEffect)((()=>{e(Object(C.e)({documentIds:[t]}))}),[e,t]),i.a.createElement(i.a.Fragment,null,i.a.createElement(H,{eventId:t}),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,null),i.a.createElement(R,{eventId:t})))}));W.displayName="NotesDetails";var Q=n(254);const Y=Object(a.memo)((()=>i.a.createElement(d.EuiPanel,{"data-test-subj":Q.i,hasShadow:!1},i.a.createElement(W,null))));Y.displayName="NotesTab";var K=n(1397),J=n(669),Z=n(277),X=n(131);const ee="analyze_graph",te=()=>{const{eventId:e}=Object(g.b)(),t="flyout",{from:n,to:r,shouldUpdate:o,selectedPatterns:s}=Object(Z.a)(Object(X.isActiveTimeline)(t)),l=Object(a.useMemo)((()=>({from:n,to:r})),[n,r]);return i.a.createElement("div",{"data-test-subj":I.d},i.a.createElement(J.a,{databaseDocumentID:e,resolverComponentInstanceID:t,indices:s,shouldUpdate:o,filters:l}))};te.displayName="AnalyzeGraph";var ne=n(234);const ae="session-view",ie=()=>{const{sessionView:e}=Object(l.j)().services,{getFieldsData:t,indexName:n}=Object(g.b)(),a=Object(m.a)(t(ne.b)),r=Object(m.a)(t(ne.c))||"",o=Object(m.a)(t(ne.d))||"",s=a||n;return i.a.createElement("div",{"data-test-subj":I.L},e.getSessionView({index:s,sessionEntityId:r,sessionStartTime:o,isFullScreen:!0}))};ie.displayName="SessionView";var re=n(219),oe=n(187);const se=[{id:ae,label:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.sessionViewButtonLabel",defaultMessage:"Session View"}),"data-test-subj":Q.m},{id:ee,label:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.analyzerGraphButtonLabel",defaultMessage:"Analyzer Graph"}),"data-test-subj":Q.l}];Object(a.memo)((()=>{var e,t,n,o,l;const{eventId:c,indexName:u,scopeId:p}=Object(g.b)(),{openLeftPanel:m}=Object(r.a)(),f=Object(K.a)(),[b,y]=Object(a.useState)(null!==(e=null===(t=f.left)||void 0===t||null===(n=t.path)||void 0===n?void 0:n.subTab)&&void 0!==e?e:ae),{startTransaction:h}=Object(oe.b)(),v=Object(a.useCallback)((e=>{y(e),e===ee&&h({name:re.a.OPEN_ANALYZER}),m({id:s.c,path:{tab:Pe,subTab:e},params:{id:c,indexName:u,scopeId:p}})}),[h,c,u,p,m]);return Object(a.useEffect)((()=>{var e,t,n,a;null!==(e=f.left)&&void 0!==e&&null!==(t=e.path)&&void 0!==t&&t.subTab&&y(null===(n=f.left)||void 0===n||null===(a=n.path)||void 0===a?void 0:a.subTab)}),[null===(o=f.left)||void 0===o||null===(l=o.path)||void 0===l?void 0:l.subTab]),i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiButtonGroup,{color:"primary",name:"coarsness",legend:S.i18n.translate("xpack.securitySolution.flyout.left.visualize.buttonGroupLegendLabel",{defaultMessage:"Visualize options"}),options:se,idSelected:b,onChange:e=>v(e),buttonSize:"compressed",isFullWidth:!0,"data-test-subj":Q.k}),i.a.createElement(d.EuiSpacer,{size:"m"}),b===ae&&i.a.createElement(ie,null),b===ee&&i.a.createElement(te,null))})).displayName="VisualizeTab";var le=n(605),ce=n(394),ue=n(339);const de=()=>{const{dataFormattedForFieldBrowser:e,isPreview:t}=Object(g.b)(),{loading:n,error:a,basicAlertData:r,ruleNote:o}=Object(le.a)({dataFormattedForFieldBrowser:e});return i.a.createElement("div",{"data-test-subj":I.s},t?i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."}):n?i.a.createElement(ue.a,{"data-test-subj":I.r}):!a&&r.ruleId&&o?i.a.createElement(ce.b,{basicData:r,ruleNote:o,showTitle:!1,showFullView:!0}):i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataDescription",defaultMessage:"There's no investigation guide for this rule. {documentation} to add one.",values:{documentation:i.a.createElement(d.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-management.html#edit-rules-settings",target:"_blank"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataLinkText",defaultMessage:"Edit the rule's settings"}))}}))};de.displayName="InvestigationGuide";const pe=Object(a.memo)((()=>i.a.createElement(d.EuiPanel,{"data-test-subj":Q.h,hasShadow:!1},i.a.createElement(de,null))));pe.displayName="InvestigationTab";var me=n(320),fe=n(633),ge=n(606),be=n(623);const ye=[{id:me.a,label:i.a.createElement("div",{"data-test-subj":Q.c},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entitiesButtonLabel",defaultMessage:"Entities"})),"data-test-subj":Q.d},{id:fe.a,label:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.threatIntelligenceButtonLabel",defaultMessage:"Threat intelligence"}),"data-test-subj":Q.g},{id:ge.a,label:i.a.createElement("div",{"data-test-subj":Q.e},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalenceButtonLabel",defaultMessage:"Prevalence"})),"data-test-subj":Q.f},{id:be.a,label:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlationsButtonLabel",defaultMessage:"Correlations"}),"data-test-subj":Q.b}],he=Object(a.memo)((()=>{var e,t,n;const{telemetry:o}=Object(l.j)().services,{eventId:c,indexName:u,scopeId:p,getFieldsData:b}=Object(g.b)(),y=Object(m.a)(b("event.kind"))===f.a.signal,{openLeftPanel:h}=Object(r.a)(),v=null!==(e=null===(t=Object(K.a)().left)||void 0===t||null===(n=t.path)||void 0===n?void 0:n.subTab)&&void 0!==e?e:me.a,E=Object(a.useMemo)((()=>y?ye:ye.filter((e=>e.id!==fe.a))),[y]),x=Object(a.useCallback)((e=>{h({id:s.c,path:{tab:Re,subTab:e},params:{id:c,indexName:u,scopeId:p}}),o.reportDetailsFlyoutTabClicked({location:p,panel:"left",tabId:e})}),[c,u,p,h,o]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiButtonGroup,{color:"primary",legend:S.i18n.translate("xpack.securitySolution.flyout.left.insights.buttonGroupLegendLabel",{defaultMessage:"Insights options"}),options:E,idSelected:v,onChange:x,buttonSize:"compressed",isFullWidth:!0,"data-test-subj":Q.a,style:y?void 0:{maxWidth:450}}),i.a.createElement(d.EuiSpacer,{size:"m"}),v===me.a&&i.a.createElement(me.b,null),v===fe.a&&i.a.createElement(fe.b,null),v===ge.a&&i.a.createElement(ge.b,null),v===be.a&&i.a.createElement(be.b,null))}));he.displayName="InsightsTab";var ve=n(211);ve.a;const Ee=`${ve.a}InsightsTab`,xe=`${ve.a}InvestigationTab`,je=`${ve.a}ResponseTab`,Se=`${ve.a}NotesTab`;var Oe=n(729),ke=n(740);const we=u.a.div.withConfig({displayName:"ExtendedFlyoutWrapper",componentId:"sc-qxbnld-0"})(["figure{background-color:white"]),Te=()=>{const{searchHit:e,dataAsNestedObject:t,isPreview:n}=Object(g.b)(),a=Object(o.a)("endpointResponseActionsEnabled"),r=Object(ke.a)({rawEventData:e,ecsData:t}),s=Object(Oe.a)({rawEventData:e,ecsData:t});return i.a.createElement("div",{"data-test-subj":I.J},n?i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.previewMessage",defaultMessage:"Response is not available in alert preview."}):i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"xxxs"},i.a.createElement("h5",null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.responseTitle",defaultMessage:"Responses"}))),i.a.createElement(d.EuiSpacer,{size:"s"}),i.a.createElement(we,null,a?null==r?void 0:r.content:null==s?void 0:s.content)))};Te.displayName="ResponseDetails";const Ie=Object(a.memo)((()=>i.a.createElement(d.EuiPanel,{"data-test-subj":Q.j,hasShadow:!1},i.a.createElement(Te,null))));Ie.displayName="ResponseTab",x.FormattedMessage;const Me={id:"insights","data-test-subj":Ee,name:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.tabLabel",defaultMessage:"Insights"}),content:i.a.createElement(he,null)},Ce={id:"investigation","data-test-subj":xe,name:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigations.tabLabel",defaultMessage:"Investigation"}),content:i.a.createElement(pe,null)},_e={id:"response","data-test-subj":je,name:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.tabLabel",defaultMessage:"Response"}),content:i.a.createElement(Ie,null)},De={id:"notes","data-test-subj":Se,name:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.flyout.left.notes.tabLabel",defaultMessage:"Notes"}),content:i.a.createElement(Y,null)};var Ae=n(631),Fe=n(436);const Ne=Object(a.memo)((()=>{const{getFieldsData:e,isPreview:t}=Object(g.b)(),n=Object(m.a)(e("event.kind"))===f.a.signal,r=Object(O.a)()===k.a.timeline,o=n&&!t&&!r,s=Object(a.useMemo)((()=>Object(Fe.a)()),[]);return o?i.a.createElement(Ae.a,{tourStepContent:s,totalSteps:5}):null}));Ne.displayName="LeftPanelTour";const Pe="visualize",Re="insights",Le="investigation",ze="response",qe="notes",Be=Object(a.memo)((({path:e})=>{const{telemetry:t}=Object(l.j)().services,{openLeftPanel:n}=Object(r.a)(),{eventId:c,indexName:u,scopeId:d,getFieldsData:p,isPreview:y}=Object(g.b)(),h=Object(m.a)(p("event.kind")),E=Object(o.a)("securitySolutionNotesEnabled"),x=Object(a.useMemo)((()=>{const e=h===f.a.signal?[Me,Ce,_e]:[Me];return E&&!y&&e.push(De),e}),[h,y,E]),j=Object(a.useMemo)((()=>{var t;const n=x[0].id;return e&&null!==(t=x.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:n}),[e,x]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ne,null),i.a.createElement(b,{selectedTabId:j,setSelectedTabId:e=>{n({id:s.c,path:{tab:e},params:{id:c,indexName:u,scopeId:d}}),t.reportDetailsFlyoutTabClicked({location:d,panel:"left",tabId:e})},tabs:x}),i.a.createElement(v,{selectedTabId:j,tabs:x}))}));Be.displayName="LeftPanel"},,,function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"a",(function(){return b}));var a=n(58),i=n(429),r=n(12),o=n(48),s=n(2),l=n(156);const c=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesAdd||e===l.a.rulesCreate||e===l.a.exceptions,u=e=>e.substring(1),d=(e,t)=>{const n=Object(i.parse)(e,{sort:!1})[t];return Array.isArray(n)?n[0]:n},p=(e,t)=>{const n=d(u(null!=t?t:window.location.search),e);return Object(a.safeDecode)(null!=n?n:"")},m=e=>Object(s.useCallback)((()=>p(e)),[e]),f=e=>Object(i.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),g=()=>{const e=Object(o.useHistory)();return Object(s.useCallback)((t=>{const n=window.location.search,r=Object(i.parse)(n,{sort:!1});Object.keys(t).forEach((e=>{const n=t[e];if(null!=n&&""!==n)try{r[e]=Object(a.encode)(n)}catch{console.error("Unable to encode url param value")}else delete r[e]}));const o=f(r);u(n)!==o&&e.replace({search:o})}),[e])},b=()=>{window.history.pushState({},"",window.location.href)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=n(1371).a;a.union([i,a[void 0]])},,,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(5);const i={ENABLE:`${a.m} singleRuleActions enable`,DISABLE:`${a.m} singleRuleActions disable`,DUPLICATE:`${a.m} singleRuleActions duplicate`,EXPORT:`${a.m} singleRuleActions export`,DELETE:`${a.m} singleRuleActions delete`,MANUAL_RULE_RUN:`${a.m} singleRuleActions manual rule run`,PREVIEW:`${a.m} singleRuleActions preview`,SAVE:`${a.m} singleRuleActions save`},r={ENABLE:`${a.m} bulkRuleActions enable`,DISABLE:`${a.m} bulkRuleActions disable`,DUPLICATE:`${a.m} bulkRuleActions duplicate`,EXPORT:`${a.m} bulkRuleActions export`,MANUAL_RULE_RUN:`${a.m} bulkRuleActions manual rule run`,DELETE:`${a.m} bulkRuleActions delete`,EDIT:`${a.m} bulkRuleActions edit`},o={REFRESH:`${a.m} rulesTable refresh`,FILTER:`${a.m} rulesTable filter`,LOAD_PREBUILT:`${a.m} rulesTable loadPrebuilt`},s={SAVE:`${a.m} timeline save`,DUPLICATE:`${a.m} timeline duplicate`,DELETE:`${a.m} timeline delete`,BULK_DELETE:`${a.m} timeline bulkDelete`},l={OPEN_ANALYZER:`${a.m} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.m} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.m} alerts investigateInTimeline`},c={FIELD_SAVED:`${a.m} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.m} fieldBrowser fieldDeleted`}},function(e,t,n){"use strict";e.exports=function(e){return-2===e||-1===e||32===e}},function(e,t,n){"use strict";n.d(t,"B",(function(){return i})),n.d(t,"y",(function(){return r})),n.d(t,"A",(function(){return o})),n.d(t,"z",(function(){return s})),n.d(t,"x",(function(){return l})),n.d(t,"w",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"t",(function(){return m})),n.d(t,"Y",(function(){return f})),n.d(t,"ab",(function(){return g})),n.d(t,"W",(function(){return b})),n.d(t,"X",(function(){return y})),n.d(t,"Z",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"O",(function(){return E})),n.d(t,"E",(function(){return x})),n.d(t,"F",(function(){return j})),n.d(t,"s",(function(){return S})),n.d(t,"k",(function(){return O})),n.d(t,"o",(function(){return k})),n.d(t,"hb",(function(){return w.U})),n.d(t,"m",(function(){return w.p})),n.d(t,"C",(function(){return w.u})),n.d(t,"r",(function(){return w.s})),n.d(t,"v",(function(){return w.t})),n.d(t,"n",(function(){return w.r})),n.d(t,"ob",(function(){return w.db})),n.d(t,"eb",(function(){return w.R})),n.d(t,"nb",(function(){return w.cb})),n.d(t,"cb",(function(){return w.P})),n.d(t,"db",(function(){return w.Q})),n.d(t,"qb",(function(){return w.fb})),n.d(t,"D",(function(){return w.v})),n.d(t,"fb",(function(){return w.S})),n.d(t,"kb",(function(){return w.Y})),n.d(t,"mb",(function(){return w.ab})),n.d(t,"lb",(function(){return w.Z})),n.d(t,"S",(function(){return w.I})),n.d(t,"R",(function(){return w.G})),n.d(t,"U",(function(){return w.K})),n.d(t,"T",(function(){return w.J})),n.d(t,"Q",(function(){return w.F})),n.d(t,"P",(function(){return w.E})),n.d(t,"bb",(function(){return w.O})),n.d(t,"a",(function(){return w.c})),n.d(t,"V",(function(){return w.L})),n.d(t,"gb",(function(){return w.T})),n.d(t,"b",(function(){return w.d})),n.d(t,"i",(function(){return w.m})),n.d(t,"l",(function(){return w.o})),n.d(t,"h",(function(){return w.l})),n.d(t,"f",(function(){return w.j})),n.d(t,"g",(function(){return w.k})),n.d(t,"d",(function(){return w.h})),n.d(t,"e",(function(){return w.i})),n.d(t,"c",(function(){return w.e})),n.d(t,"pb",(function(){return w.eb})),n.d(t,"jb",(function(){return w.X})),n.d(t,"ib",(function(){return w.V})),n.d(t,"G",(function(){return w.w})),n.d(t,"M",(function(){return w.C})),n.d(t,"K",(function(){return w.A})),n.d(t,"J",(function(){return w.z})),n.d(t,"L",(function(){return w.B})),n.d(t,"N",(function(){return w.D})),n.d(t,"H",(function(){return w.x})),n.d(t,"I",(function(){return w.y}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_title",{defaultMessage:"Create exceptions to this list"}),r=e=>a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_body",{values:{listName:e},defaultMessage:"There is no exception in your [{listName}]. Create rule exceptions to this list."}),o=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button_endpoint",{defaultMessage:"Create endpoint exception"}),s=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button",{defaultMessage:"Create rule exception"}),l=a.i18n.translate("xpack.securitySolution.exception.list.search_bar_button_enpoint",{defaultMessage:"Add endpoint exception to list"}),c=a.i18n.translate("xpack.securitySolution.exception.list.search_bar_button",{defaultMessage:"Add rule exception to list"}),u=(a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"})),d=a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),p=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),m=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessText",{values:{itemName:e},defaultMessage:'"{itemName}" deleted successfully.'}),f=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_cancel",{defaultMessage:"Cancel"}),g=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_save",{defaultMessage:"Save"}),b=a.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_header",{defaultMessage:"Link rules"}),y=a.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_overflow_button_title",{defaultMessage:"Link rules"}),h=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_description",{defaultMessage:"Link or unlink rules to this exception list."}),v=a.i18n.translate("xpack.securitySolution.exceptionsTable.deleteExceptionList",{defaultMessage:"Delete exception list"}),E=a.i18n.translate("xpack.securitySolution.exceptionsTable.exportExceptionList",{defaultMessage:"Export exception list"}),x=a.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesError",{defaultMessage:"Manage rules error"}),j=a.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesErrorDescription",{defaultMessage:"An error occurred linking or unlinking rules"}),S=a.i18n.translate("xpack.securitySolution.exceptionsTable.exportListDescription",{defaultMessage:"An error occurred exporting a list"}),O=a.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateExceptionList",{defaultMessage:"Duplicate exception list"}),k=a.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateListDescription",{defaultMessage:"An error occurred duplicating a list"});n(597);var w=n(777)},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"m",(function(){return m}));var a=n(44),i=n(128),r=n(1630),o=n(266),s=n(131),l=n(200),c=n(706);n.d(t,"e",(function(){return i.f})),n.d(t,"g",(function(){return i.h})),n.d(t,"f",(function(){return i.g})),n.d(t,"k",(function(){return i.l})),n.d(t,"j",(function(){return i.k})),n.d(t,"o",(function(){return i.q})),n.d(t,"n",(function(){return i.p})),n.d(t,"l",(function(){return i.m})),n.d(t,"h",(function(){return i.i})),n.d(t,"p",(function(){return i.v})),n.d(t,"q",(function(){return i.w})),n.d(t,"i",(function(){return i.j})),n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.d}));const u=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:a,timelineId:r,noProviderFound:o=l.b.noProviderFound,onAddedToTimeline:s})=>{const u=Object(i.o)(a),d=t[u];d?Object(c.b)({dataProviders:e,destination:a.destination,dispatch:n,onAddedToTimeline:s,providerToAdd:d,timelineId:r}):n(o({id:u}))},d={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},p=({browserFields:e,dispatch:t,result:n,scopeId:l,defaultsHeader:c})=>{var u;const p=Object(i.n)(n),m=(e=>Object(a.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[p],f=l!==r.b.alertsOnAlertsPage&&l!==r.b.alertsOnRuleDetailsPage||null===(u=c.find((e=>e.id===p)))||void 0===u?{}:u,g=Object(s.getScopedActions)(l);var b;null!=m&&g?t(g.upsertColumn({column:{columnHeaderType:"not-filtered",id:p,linkField:null!==(b=d[p])&&void 0!==b?b:void 0,type:m.type,aggregatable:m.aggregatable,initialWidth:o.a,...f},id:l,index:null!=n.destination?n.destination.index:0})):g&&t(g.upsertColumn({column:{columnHeaderType:"not-filtered",id:p,initialWidth:o.a},id:l,index:null!=n.destination?n.destination.index:0}))},m=e=>e.slice(e.lastIndexOf(".")+1)},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c}));const a=["started","opened"],i=["starting","stopping","opening","closing"],r=["deleted","failed"],o=(e,t)=>a.includes(e)&&a.includes(t),s=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>r.includes(e)||r.includes(t),c=e=>"machine_learning"===e},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(52),c=n.n(l),u=n(181),d=n(901),p=n(902);const m=s.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(o.css)(["height:","px;"],e)),(({border:e})=>e&&Object(o.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));m.displayName="Header";const f=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",g=({alignHeader:e,border:t,children:n,outerDirection:o="column",growLeftSplit:s=!0,headerFilters:l,height:g,hideSubtitle:b=!1,id:y,inspectMultiple:h=!1,inspectTitle:v,isInspectDisabled:E,showInspectButton:x=!0,split:j,stackHeader:S,subtitle:O,title:k,titleSize:w="l",toggleQuery:T,toggleStatus:I=!0,tooltip:M,tooltipTitle:C})=>{const _=Object(i.useCallback)((()=>{T&&T(!I)}),[T,I]),D=c()({"toggle-expand":I,siemHeaderSection:!0});return r.a.createElement(m,{"data-test-subj":"header-section",border:t,height:g,className:D,$hideSubtitle:b},r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:o,gutterSize:"xs",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:s},r.a.createElement(a.EuiFlexGroup,{alignItems:f({alignHeader:e,stackHeader:S}),"data-test-subj":"headerSectionInnerFlexGroup",direction:S?"column":"row",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:s,className:I?"":"no-margin"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},T&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":p.a(I),color:"text",display:"empty",iconType:I?"arrowDown":"arrowRight",onClick:_,size:"s",title:p.a(I)})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiTitle,{size:w},r.a.createElement("h2",{"data-test-subj":"header-section-title"},r.a.createElement("span",{className:"eui-textBreakNormal"},k),M&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiIconTip,{color:"subdued",title:C,content:M,size:"l",type:"iInCircle"}))))))),y&&I&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(u.b,{isDisabled:E,queryId:y,multiple:h,showInspectButton:x,title:null!=v?v:k})),l&&I&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),n&&I&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!j},n))),!b&&I&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:O}))))},b=r.a.memo(g)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return p}));const a=100,i=1e4,r=[10,25,50,a,250,500],o={auto:-1,single:0,default:3},s="1.6em",l=370,c=212,u="kibana-json",d={border:"horizontal",fontSize:"s",cellPadding:"l",rowHover:"highlight",header:"underline",stripes:!0},p={showColumnSelector:{allowHide:!1,allowReorder:!0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(19),o=n(41),s=n.n(o),l=n(49),c=n(589),u=n(1259);const d=s.a.div.withConfig({displayName:"RiskBadge",componentId:"sc-169ah31-0"})(["",""],(({theme:e,$severity:t,$hideBackgroundColor:n})=>Object(o.css)(["width:fit-content;padding-right:",";padding-left:",";",";"],e.eui.euiSizeS,e.eui.euiSizeXS,("Critical"===t||"High"===t)&&!n&&Object(o.css)(["background-color:",";border-radius:999px;"],Object(r.transparentize)(e.eui.euiColorDanger,.2))))),p=s.a.div.withConfig({displayName:"TooltipContainer",componentId:"sc-169ah31-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),m=i.a.memo((({severity:e,hideBackgroundColor:t=!1,toolTipContent:n,"data-test-subj":a})=>null!=n?i.a.createElement(u.a,{hoverContent:i.a.createElement(p,null,n)},i.a.createElement(f,{severity:e,hideBackgroundColor:t,"data-test-subj":a})):i.a.createElement(f,{severity:e,hideBackgroundColor:t,"data-test-subj":a})));m.displayName="RiskScoreLevel";const f=i.a.memo((({severity:e,hideBackgroundColor:t=!1,"data-test-subj":n})=>i.a.createElement(d,{color:l.euiLightVars.euiColorDanger,$severity:e,$hideBackgroundColor:t,"data-test-subj":null!=n?n:"risk-score"},i.a.createElement(r.EuiTextColor,{color:"default"},i.a.createElement(r.EuiHealth,{className:"eui-alignMiddle",color:c.d[e]},e)))));f.displayName="RiskScoreBadge"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(19),i=n(4),r=n(42),o=n(2),s=n.n(o);const l=({count:e})=>{const[t,n,l]=Object(o.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),a={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},r=new Map([[1,""],[1e3,a.compactThousands],[1e6,a.compactMillions],[1e9,a.compactBillions],[1e12,a.compactTrillions]]),o=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),s=null!==(t=r.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),s,e/n%1>Number.EPSILON?o:""]}(e||0)),[e]);return null==e?null:0===e?s.a.createElement(s.a.Fragment,null,0):s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:s.a.createElement(a.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},c=s.a.memo(l)},,function(e,t,n){"use strict";n.d(t,"W",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"A",(function(){return c})),n.d(t,"B",(function(){return u})),n.d(t,"H",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"n",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"u",(function(){return v})),n.d(t,"v",(function(){return E})),n.d(t,"E",(function(){return x})),n.d(t,"k",(function(){return j})),n.d(t,"G",(function(){return S})),n.d(t,"F",(function(){return O})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"j",(function(){return T})),n.d(t,"p",(function(){return I})),n.d(t,"J",(function(){return M})),n.d(t,"o",(function(){return C})),n.d(t,"I",(function(){return _})),n.d(t,"z",(function(){return D})),n.d(t,"h",(function(){return A})),n.d(t,"w",(function(){return F})),n.d(t,"d",(function(){return N})),n.d(t,"a",(function(){return P})),n.d(t,"y",(function(){return R})),n.d(t,"x",(function(){return L})),n.d(t,"K",(function(){return z})),n.d(t,"L",(function(){return q})),n.d(t,"M",(function(){return B})),n.d(t,"D",(function(){return $})),n.d(t,"C",(function(){return V})),n.d(t,"N",(function(){return U})),n.d(t,"R",(function(){return G})),n.d(t,"P",(function(){return H})),n.d(t,"T",(function(){return W})),n.d(t,"Q",(function(){return Q})),n.d(t,"U",(function(){return Y})),n.d(t,"O",(function(){return K})),n.d(t,"S",(function(){return J})),n.d(t,"V",(function(){return Z}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.system.withResultDescription",{defaultMessage:"with result"}),r=a.i18n.translate("xpack.securitySolution.system.acceptedAConnectionViaDescription",{defaultMessage:"accepted a connection via"}),o=a.i18n.translate("xpack.securitySolution.system.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),s=a.i18n.translate("xpack.securitySolution.system.disconnectedViaDescription",{defaultMessage:"disconnected via"}),l=a.i18n.translate("xpack.securitySolution.system.loggedOutDescription",{defaultMessage:"logged out via"}),c=(a.i18n.translate("xpack.securitySolution.system.usingDescription",{defaultMessage:"using"}),a.i18n.translate("xpack.securitySolution.system.processStartedDescription",{defaultMessage:"started process"})),u=a.i18n.translate("xpack.securitySolution.system.processStoppedDescription",{defaultMessage:"stopped process"}),d=a.i18n.translate("xpack.securitySolution.system.terminatedProcessDescription",{defaultMessage:"terminated process"}),p=a.i18n.translate("xpack.securitySolution.system.createdFileDescription",{defaultMessage:"created a file"}),m=a.i18n.translate("xpack.securitySolution.system.deletedFileDescription",{defaultMessage:"deleted a file"}),f=a.i18n.translate("xpack.securitySolution.rowRenderer.executedProcessDescription",{defaultMessage:"executed process"}),g=a.i18n.translate("xpack.securitySolution.rowRenderer.forkedProcessDescription",{defaultMessage:"forked process"}),b=a.i18n.translate("xpack.securitySolution.rowRenderer.loadedLibraryDescription",{defaultMessage:"loaded library"}),y=a.i18n.translate("xpack.securitySolution.rowRenderer.madeAHttpRequestViaDescription",{defaultMessage:"made a http request via"}),h=a.i18n.translate("xpack.securitySolution.rowRenderer.modifiedFileDescription",{defaultMessage:"modified a file"}),v=a.i18n.translate("xpack.securitySolution.rowRenderer.modifiedRegistryKeyDescription",{defaultMessage:"modified registry key"}),E=a.i18n.translate("xpack.securitySolution.rowRenderer.overwroteFileDescription",{defaultMessage:"overwrote a file"}),x=a.i18n.translate("xpack.securitySolution.rowRenderer.renamedFileDescription",{defaultMessage:"renamed a file"}),j=a.i18n.translate("xpack.securitySolution.system.existingProcessDescription",{defaultMessage:"is running process"}),S=a.i18n.translate("xpack.securitySolution.system.socketOpenedDescription",{defaultMessage:"opened a socket with"}),O=a.i18n.translate("xpack.securitySolution.system.socketClosedDescription",{defaultMessage:"closed a socket with"}),k=a.i18n.translate("xpack.securitySolution.system.existingUserDescription",{defaultMessage:"is an existing user"}),w=a.i18n.translate("xpack.securitySolution.system.existingSocketDescription",{defaultMessage:"is using an existing socket from"}),T=a.i18n.translate("xpack.securitySolution.system.existingPackageDescription",{defaultMessage:"is using an existing package"}),I=a.i18n.translate("xpack.securitySolution.system.invalidDescription",{defaultMessage:"attempted invalid usage of"}),M=a.i18n.translate("xpack.securitySolution.system.userChangedDescription",{defaultMessage:"user has changed"}),C=a.i18n.translate("xpack.securitySolution.system.hostDescription",{defaultMessage:"host information"}),_=a.i18n.translate("xpack.securitySolution.system.userAddedDescription",{defaultMessage:"user was added"}),D=a.i18n.translate("xpack.securitySolution.system.processErrorDescription",{defaultMessage:"encountered a process error with"}),A=a.i18n.translate("xpack.securitySolution.system.errorDescription",{defaultMessage:"encountered an error with"}),F=a.i18n.translate("xpack.securitySolution.system.packageInstalledDescription",{defaultMessage:"installed package"}),N=a.i18n.translate("xpack.securitySolution.system.packageSystemStartedDescription",{defaultMessage:"system started"}),P=a.i18n.translate("xpack.securitySolution.system.acceptedDescription",{defaultMessage:"accepted the user via"}),R=a.i18n.translate("xpack.securitySolution.system.packageUpdatedDescription",{defaultMessage:"updated package"}),L=a.i18n.translate("xpack.securitySolution.system.packageRemovedDescription",{defaultMessage:"removed package"}),z=a.i18n.translate("xpack.securitySolution.system.userRemovedDescription",{defaultMessage:"was removed"}),q=a.i18n.translate("xpack.securitySolution.system.viaDescription",{defaultMessage:"via"}),B=a.i18n.translate("xpack.securitySolution.system.viaParentProcessDescription",{defaultMessage:"via parent process"}),$=a.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasPreventedFromeEcryptingFilesDescription",{defaultMessage:"ransomware was prevented from encrypting files"}),V=a.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasDetectedEcryptingFilesDescription",{defaultMessage:"ransomware was detected encrypting files"}),U=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedCreatingAMaliciousFileDescription",{defaultMessage:"was detected creating a malicious file"}),G=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromCreatingAMaliciousFileDescription",{defaultMessage:"was prevented from creating a malicious file"}),H=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedModifyingAMaliciousFileDescription",{defaultMessage:"was detected modifying a malicious file"}),W=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromModifyingAMaliciousFileDescription",{defaultMessage:"was prevented from modifying a malicious file"}),Q=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedRenamingAMaliciousFileDescription",{defaultMessage:"was detected renaming a malicious file"}),Y=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromRenamingAMaliciousFileDescription",{defaultMessage:"was prevented from renaming a malicious file"}),K=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedExecutingAMaliciousProcessDescription",{defaultMessage:"was detected executing a malicious process"}),J=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromExecutingAMaliciousProcessDescription",{defaultMessage:"was prevented from executing a malicious process"}),Z=a.i18n.translate("xpack.securitySolution.system.withExitCodeDescription",{defaultMessage:"with exit code"})},function(e,t,n){"use strict";n.d(t,"h",(function(){return Ee})),n.d(t,"b",(function(){return xe})),n.d(t,"f",(function(){return je})),n.d(t,"c",(function(){return Se})),n.d(t,"d",(function(){return Oe})),n.d(t,"g",(function(){return ke})),n.d(t,"j",(function(){return we})),n.d(t,"i",(function(){return Te})),n.d(t,"a",(function(){return Ie})),n.d(t,"e",(function(){return Me})),n.d(t,"k",(function(){return Tt}));var a=n(44),i=n(2),r=n.n(i),o=n(121),s=n(19),l=n(150),c=n(278),u=n(134),d=n(317),p=n(836);const m=r.a.memo((({contextId:e,eventId:t,hostName:n,hostNameSeparator:a="@",isDraggable:i,userDomain:o,userDomainField:s="user.domain",userName:c,userNameField:d="user.name",workingDirectory:m})=>null!=c||null!=o||null!=n||null!=m?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:d,isDraggable:i,value:c,iconType:"user",fieldType:"keyword",isAggregatable:!0})),null!=o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{"data-test-subj":"user-host-working-dir-domain-separator-text",grow:!1,component:"span"},"\\"),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:s,isDraggable:i,value:o,fieldType:"keyword",isAggregatable:!0}))),null!=n&&null!=c&&r.a.createElement(l.c,{grow:!1,component:"span"},a),r.a.createElement(p.a,{contextId:e,eventId:t,hostName:n,isDraggable:i,workingDirectory:m})):null));m.displayName="UserHostWorkingDir";var f=n(4);const g=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.askedForDescription",{defaultMessage:"asked for"}),b=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.responseCodeDescription",{defaultMessage:"response code:"}),y=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.viaDescription",{defaultMessage:"via"}),h=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.whichResolvedToDescription",{defaultMessage:", which resolved to"}),v=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.withQuestionTypeDescription",{defaultMessage:"with question type"}),E=r.a.memo((({contextId:e,dnsQuestionName:t,dnsQuestionType:n,dnsResolvedIp:a,dnsResponseCode:i,eventCode:o,hostName:c,id:p,isDraggable:f,processExecutable:E,processName:x,processPid:j,userDomain:S,userName:O,winlogEventId:k})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:p,hostName:c,isDraggable:f,userDomain:S,userName:O,workingDirectory:void 0}),!Object(l.e)(t)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"asked-for",grow:!1},g),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.name",isDraggable:f,value:t,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"with-question-type",grow:!1},v),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.type",isDraggable:f,value:n,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"which-resolved-to",grow:!1},h),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.resolved_ip",isDraggable:f,value:a,isAggregatable:!0,fieldType:"ip"}))),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"response-code",grow:!1},b),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.response_code",isDraggable:f,value:i,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),r.a.createElement(l.c,{component:"span",grow:!1},y),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:p,isDraggable:f,processPid:j,processName:x,processExecutable:E})),(!Object(l.e)(o)||!Object(l.e)(k))&&r.a.createElement(r.a.Fragment,null,Object(l.e)(o)?r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,iconType:"logoWindows",field:"winlog.event_id",isDraggable:f,value:k,isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"event.code",isDraggable:f,value:o,isAggregatable:!0,fieldType:"number"})))))));E.displayName="DnsRequestEventDetailsLine";const x=r.a.memo((({data:e,contextId:t,isDraggable:n,timelineId:i})=>{const o=Object(a.get)("dns.question.name[0]",e),u=Object(a.get)("dns.question.type[0]",e),d=Object(a.get)("dns.resolved_ip[0]",e),p=Object(a.get)("dns.response_code[0]",e),m=Object(a.get)("event.code[0]",e),f=Object(a.get)("host.name[0]",e),g=e._id,b=Object(a.get)("process.executable[0]",e),y=Object(a.get)("process.name[0]",e),h=Object(a.get)("process.pid[0]",e),v=Object(a.get)("user.domain[0]",e),x=Object(a.get)("user.name[0]",e),j=Object(a.get)("winlog.event_id[0]",e);return r.a.createElement(l.b,null,r.a.createElement(E,{contextId:t,dnsQuestionName:o,dnsQuestionType:u,dnsResolvedIp:d,dnsResponseCode:p,eventCode:m,hostName:f,id:g,isDraggable:n,processExecutable:b,processName:y,processPid:h,userDomain:v,userName:x,winlogEventId:j}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:e,isDraggable:n,timelineId:i}))}));x.displayName="DnsRequestEventDetails";const j=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.aLoginWasAttemptedUsingExplicitCredentialsDescription",{defaultMessage:"A login was attempted using explicit credentials"}),S=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.asRequestedBySubjectDescription",{defaultMessage:"as requested by subject"}),O=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogInDescription",{defaultMessage:"failed to log in"}),k=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogOffDescription",{defaultMessage:"failed to log off"}),w=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.loggedOffDescription",{defaultMessage:"logged off"}),T=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeBatchDescription",{defaultMessage:"Batch"}),I=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeCachedInteractiveDescription",{defaultMessage:"Cached Interactive"}),M=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeInteractiveDescription",{defaultMessage:"Interactive"}),C=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkDescription",{defaultMessage:"Network"}),_=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkCleartextDescription",{defaultMessage:"Network Cleartext"}),D=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNewCredentialsDescription",{defaultMessage:"New Credentials"}),A=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeRemoteInteractiveDescription",{defaultMessage:"Remote Interactive"}),F=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeServiceDescription",{defaultMessage:"Service"}),N=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeUnlockDescription",{defaultMessage:"Unlock"}),P=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.subjectLogonIdDescription",{defaultMessage:"subject logon ID"}),R=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.successfullyLoggedInDescription",{defaultMessage:"successfully logged in"}),L=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.targetLogonIdDescription",{defaultMessage:"target logon ID"}),z=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.toDescription",{defaultMessage:"to"}),q=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.usingLogonTypeDescription",{defaultMessage:"using logon type"}),B=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.viaDescription",{defaultMessage:"via"}),$=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.withSpecialPrivilegesDescription",{defaultMessage:"With special privileges,"}),V=e=>{if(Object(l.e)(e))return"";switch(e){case 2:return M;case 3:return C;case 4:return T;case 5:return F;case 7:return N;case 8:return _;case 9:return D;case 10:return A;case 11:return I;default:return`${e}`}},U=e=>"explicit_user_logon"===e||"user_logoff"===e,G=r.a.memo((({contextId:e,endgameLogonType:t,endgameSubjectDomainName:n,endgameSubjectLogonId:a,endgameSubjectUserName:i,endgameTargetDomainName:o,endgameTargetLogonId:c,endgameTargetUserName:p,eventAction:f,eventCode:g,eventOutcome:b,hostName:y,id:h,isDraggable:v,processExecutable:E,processName:x,processPid:T,userDomain:I,userName:M,winlogEventId:C})=>{const _=U(f)?o:I,D=(({eventAction:e,eventOutcome:t})=>{switch(e){case"explicit_user_logon":return"";case"log_off":case"user_logoff":return"failure"===(null==t?void 0:t.toLowerCase())?k:w;default:return"failure"===(null==t?void 0:t.toLowerCase())?O:R}})({eventAction:f,eventOutcome:b}),A=(e=>"explicit_user_logon"===e?z:"@")(f),F=U(f)?p:M,N=(e=>U(e)?"endgame.target_domain_name":"user.domain")(f),G=(e=>U(e)?"endgame.target_user_name":"user.name")(f);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},"admin_logon"===f&&r.a.createElement(l.c,{component:"span","data-test-subj":"with-special-privileges",grow:!1},$),"explicit_user_logon"===f&&r.a.createElement(l.c,{component:"span","data-test-subj":"a-login-was-attempted",grow:!1},j),r.a.createElement(m,{contextId:e,eventId:h,hostName:y,hostNameSeparator:A,isDraggable:v,userDomain:_,userDomainField:N,userName:F,userNameField:G,workingDirectory:void 0}),r.a.createElement(l.c,{component:"span","data-test-subj":"event-details",grow:!1},D),!Object(l.e)(t)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},q),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.logon_type",isDraggable:v,queryValue:String(t),value:`${t} - ${V(t)}`,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(c)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},L),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.target_logon_id",isDraggable:v,value:c,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),r.a.createElement(l.c,{component:"span",grow:!1},B),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:h,isDraggable:v,processPid:T,processName:x,processExecutable:E})),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"as-requested-by-subject",grow:!1},S),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_user_name",isDraggable:v,iconType:"user",value:i,isAggregatable:!0,fieldType:"keyword"}))),null!=n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"subject-domain-name-domain-separator-text",grow:!1},"\\"),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_domain_name",isDraggable:v,value:n,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"subject-login-id",grow:!1},P),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_logon_id",isDraggable:v,value:a,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),(!Object(l.e)(g)||!Object(l.e)(C))&&r.a.createElement(r.a.Fragment,null,Object(l.e)(g)?r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,iconType:"logoWindows",field:"winlog.event_id",value:C,isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"event.code",value:g,isAggregatable:!0,fieldType:"keyword"})))))}));G.displayName="EndgameSecurityEventDetailsLine";const H=r.a.memo((({data:e,contextId:t,isDraggable:n,timelineId:i})=>{const o=Object(a.get)("endgame.logon_type[0]",e),u=Object(a.get)("endgame.subject_domain_name[0]",e),d=Object(a.get)("endgame.subject_logon_id[0]",e),p=Object(a.get)("endgame.subject_user_name[0]",e),m=Object(a.get)("endgame.target_logon_id[0]",e),f=Object(a.get)("endgame.target_domain_name[0]",e),g=Object(a.get)("endgame.target_user_name[0]",e),b=Object(a.get)("event.action[0]",e),y=Object(a.get)("event.code[0]",e),h=Object(a.get)("event.outcome[0]",e),v=Object(a.get)("host.name[0]",e),E=e._id,x=Object(a.get)("process.executable[0]",e),j=Object(a.get)("process.name[0]",e),S=Object(a.get)("process.pid[0]",e),O=Object(a.get)("user.domain[0]",e),k=Object(a.get)("user.name[0]",e),w=Object(a.get)("winlog.event_id[0]",e);return r.a.createElement(l.b,null,r.a.createElement(G,{contextId:t,endgameLogonType:o,endgameSubjectDomainName:u,endgameSubjectLogonId:d,endgameSubjectUserName:p,endgameTargetDomainName:f,endgameTargetLogonId:m,endgameTargetUserName:g,eventAction:b,eventCode:y,eventOutcome:h,hostName:v,id:E,isDraggable:n,processExecutable:x,processName:j,processPid:S,userDomain:O,userName:k,winlogEventId:w}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:e,timelineId:i}))}));H.displayName="EndgameSecurityEventDetails";const W=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.viaDescription",{defaultMessage:"via"}),Q=f.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.withNewValueDescription",{defaultMessage:"with new value"}),Y=({contextId:e,hostName:t,id:n,isDraggable:a,processName:o,processPid:c,registryKey:p,registryPath:f,text:g,userDomain:b,userName:y})=>{const h=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"registry.key"),r.a.createElement("div",null,p))),[p]),v=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"registry.path"),r.a.createElement("div",null,f))),[f]);return Object(l.e)(p)?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:n,hostName:t,isDraggable:a,userDomain:b,userName:y,workingDirectory:void 0}),!Object(l.e)(p)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"text",grow:!1},g),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:n,field:"registry.key",isDraggable:a,tooltipContent:h,value:p,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(f)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"with-new-value",grow:!1},Q),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:n,field:"registry.path",isDraggable:a,tooltipContent:v,value:f,isAggregatable:!0,fieldType:"keyword"}))),r.a.createElement(l.c,{component:"span",grow:!1},W),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:n,isDraggable:a,processPid:c,processName:o,processExecutable:void 0}))))},K=r.a.memo(Y),J=({contextId:e,data:t,isDraggable:n,text:i})=>{const o=Object(a.get)("host.name[0]",t),s=t._id,c=Object(a.get)("process.name[0]",t),u=Object(a.get)("process.pid[0]",t),d=Object(a.get)("registry.key[0]",t),p=Object(a.get)("registry.path[0]",t),m=Object(a.get)("user.domain[0]",t),f=Object(a.get)("user.name[0]",t);return Object(l.e)(d)?null:r.a.createElement(l.b,null,r.a.createElement(K,{contextId:e,hostName:o,id:s,isDraggable:n,processName:c,processPid:u,registryKey:d,registryPath:p,text:i,userDomain:m,userName:f}))};J.displayName="RegistryEventDetailsComponent";const Z=r.a.memo(J);var X=n(315),ee=n(485),te=n(230);const ne=r.a.memo((({contextId:e,eventId:t,isDraggable:n,packageName:a,packageSummary:i,packageVersion:o})=>null!=a||null!=i||null!=o?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:n,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:n,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.summary",isDraggable:n,value:i,isAggregatable:!0,fieldType:"keyword"}))):null));ne.displayName="Package";const ae=r.a.memo((({contextId:e,eventId:t,isDraggable:n,sshSignature:a,sshMethod:i})=>r.a.createElement(r.a.Fragment,null,null!=a&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:n,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),null!=i&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:n,value:i,iconType:"document",isAggregatable:!0,fieldType:"keyword"})))));ae.displayName="AuthSsh";var ie=n(196);const re=r.a.memo((({contextId:e,hostName:t,id:n,isDraggable:a,message:i,outcome:o,packageName:c,packageSummary:p,packageVersion:f,processPid:g,processName:b,processExecutable:y,sshSignature:h,sshMethod:v,text:E,userDomain:x,userName:j,workingDirectory:S})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:n,hostName:t,isDraggable:a,userDomain:x,userName:j,workingDirectory:S}),r.a.createElement(l.c,{grow:!1,component:"span"},E),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(d.a,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:n,isDraggable:a,processPid:g,processName:b,processExecutable:y})),null!=o&&r.a.createElement(l.c,{grow:!1,component:"span"},te.W),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"event.outcome",isDraggable:a,queryValue:o,value:o,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(ae,{contextId:e,eventId:n,isDraggable:a,sshSignature:h,sshMethod:v}),r.a.createElement(ne,{contextId:e,eventId:n,isDraggable:a,packageName:c,packageSummary:p,packageVersion:f})),null!=i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"xs"}),r.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(ie.b,{iconType:"editorComment",color:"hollow",title:""},r.a.createElement(ee.a,{value:i}))))))));re.displayName="SystemGenericLine";const oe=r.a.memo((({contextId:e,data:t,isDraggable:n,text:i,timelineId:o})=>{const u=t._id,d=null!=t.message?t.message[0]:null,p=Object(a.get)("host.name[0]",t),m=Object(a.get)("user.domain[0]",t),f=Object(a.get)("user.name[0]",t),g=Object(a.get)("event.outcome[0]",t),b=Object(a.get)("system.audit.package.name[0]",t),y=Object(a.get)("system.audit.package.summary[0]",t),h=Object(a.get)("system.audit.package.version[0]",t),v=Object(a.get)("process.pid[0]",t),E=Object(a.get)("process.name[0]",t),x=Object(a.get)("process.executable[0]",t),j=Object(a.get)("system.auth.ssh.signature[0]",t),S=Object(a.get)("system.auth.ssh.method[0]",t),O=Object(a.get)("process.working_directory[0]",t);return r.a.createElement(l.b,null,r.a.createElement(re,{contextId:e,hostName:p,id:u,isDraggable:n,message:d,outcome:g,packageName:b,packageSummary:y,packageVersion:h,processExecutable:x,processPid:v,processName:E,sshMethod:S,sshSignature:j,text:i,userDomain:m,userName:f,workingDirectory:O}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:t,isDraggable:n,timelineId:o}))}));oe.displayName="SystemGenericDetails";var se=n(593);const le=r.a.memo((({contextId:e,endgameExitCode:t,eventId:n,isDraggable:a,processExitCode:i,text:o})=>Object(l.e)(i)&&Object(l.e)(t)?null:r.a.createElement(r.a.Fragment,null,!Object(l.e)(o)&&r.a.createElement(l.c,{"data-test-subj":"exit-code-draggable-text",grow:!1,component:"span"},o),!Object(l.e)(i)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.exit_code",isDraggable:a,value:`${i}`,fieldType:"number",isAggregatable:!0})),!Object(l.e)(t)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.exit_code",isDraggable:a,value:t,fieldType:"number",isAggregatable:!0})))));le.displayName="ExitCodeDraggable";var ce=n(434);const ue=r.a.memo((({contextId:e,endgameFileName:t,endgameFilePath:n,eventId:a,fileExtOriginalPath:i,fileName:o,filePath:s,isDraggable:c})=>{if(Object(l.e)(o)&&Object(l.e)(t)&&Object(l.e)(s)&&Object(l.e)(n))return null;const d=!Object(l.e)(s)||!Object(l.e)(n);return r.a.createElement(r.a.Fragment,null,Object(l.e)(o)?Object(l.e)(t)?null:r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.file_name",isDraggable:c,value:t,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"file.name",isDraggable:c,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),d&&r.a.createElement(l.c,{"data-test-subj":"in",grow:!1,component:"span"},ce.e),Object(l.e)(s)?Object(l.e)(n)?null:r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.file_path",isDraggable:c,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"file.path",isDraggable:c,value:s,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},ce.d),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"file.Ext.original.path",isDraggable:c,value:i,iconType:"document",isAggregatable:!0,fieldType:"keyword"}))))}));ue.displayName="FileDraggable";var de=n(41),pe=n.n(de);const me=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-ezi1kd-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),fe=r.a.memo((({contextId:e,eventId:t,fileHashSha256:n,isDraggable:a})=>Object(l.e)(n)?null:r.a.createElement(me,{alignItems:"center",direction:"column",gutterSize:"none"},r.a.createElement(l.c,{grow:!1,component:"div"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"file.hash.sha256",isDraggable:a,iconType:"number",value:n,isAggregatable:!0,fieldType:"keyword"})))));fe.displayName="FileHash";const ge=r.a.memo((({contextId:e,endgameParentProcessName:t,eventId:n,isDraggable:a,processParentName:i,processParentPid:o,processPpid:s,text:c})=>Object(l.e)(i)&&Object(l.e)(t)?null:r.a.createElement(r.a.Fragment,null,!Object(l.e)(c)&&r.a.createElement(l.c,{"data-test-subj":"parent-process-draggable-text",grow:!1,component:"span"},c),!Object(l.e)(i)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.parent.name",isDraggable:a,value:i,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(t)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.parent_process_name",isDraggable:a,value:t,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(o)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.parent.pid",isDraggable:a,queryValue:String(o),value:`(${String(o)})`,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(s)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.ppid",isDraggable:a,queryValue:String(s),value:`(${String(s)})`,fieldType:"keyword",isAggregatable:!0})))));ge.displayName="ParentProcessDraggable";const be=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-joyfnh-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ye=r.a.memo((({contextId:e,eventId:t,isDraggable:n,processHashSha256:a})=>Object(l.e)(a)?null:r.a.createElement(be,{alignItems:"center",direction:"column",gutterSize:"none"},r.a.createElement(l.c,{grow:!1,component:"div"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"process.hash.sha256",iconType:"number",isDraggable:n,value:a,fieldType:"keyword",isAggregatable:!0})))));ye.displayName="ProcessHash";const he=r.a.memo((({args:e,contextId:t,endgameExitCode:n,endgameFileName:a,endgameFilePath:i,endgameParentProcessName:o,endgamePid:c,endgameProcessName:p,eventAction:f,fileExtOriginalPath:g,fileHashSha256:b,fileName:y,filePath:h,hostName:v,id:E,isDraggable:x,message:j,outcome:S,packageName:O,processParentName:k,processParentPid:w,processExitCode:T,packageSummary:I,packageVersion:M,processExecutable:C,processHashSha256:_,processName:D,processPid:A,processPpid:F,processTitle:N,showMessage:P,skipRedundantFileDetails:R=!1,skipRedundantProcessDetails:L=!1,sshSignature:z,sshMethod:q,text:B,userDomain:$,userName:V,workingDirectory:U})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{eventId:E,contextId:t,isDraggable:x,userDomain:$,userName:V,workingDirectory:U,hostName:v}),r.a.createElement(l.c,{grow:!1,component:"span"},B),!R&&r.a.createElement(ue,{contextId:t,endgameFileName:a,endgameFilePath:i,eventId:E,fileExtOriginalPath:g,fileName:y,filePath:h,isDraggable:x}),Object(l.g)(f)&&r.a.createElement(l.c,{"data-test-subj":"via",grow:!1,component:"span"},te.L),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(d.b,{contextId:t,endgamePid:c,endgameProcessName:p,eventId:E,isDraggable:x,processPid:A,processName:D,processExecutable:C})),r.a.createElement(se.a,{args:e,contextId:t,eventId:E,processTitle:N,isDraggable:x}),r.a.createElement(le,{contextId:t,endgameExitCode:n,eventId:E,isDraggable:x,processExitCode:T,text:te.V}),!Object(l.f)(f)&&r.a.createElement(ge,{contextId:t,endgameParentProcessName:o,eventId:E,isDraggable:x,processParentName:k,processParentPid:w,processPpid:F,text:te.M}),null!=S&&r.a.createElement(l.c,{grow:!1,component:"span"},te.W),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:t,eventId:E,field:"event.outcome",isDraggable:x,queryValue:S,value:S,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(ae,{contextId:t,eventId:E,isDraggable:x,sshSignature:z,sshMethod:q}),r.a.createElement(ne,{contextId:t,eventId:E,isDraggable:x,packageName:O,packageSummary:I,packageVersion:M})),!R&&r.a.createElement(fe,{contextId:t,eventId:E,fileHashSha256:b,isDraggable:x}),!L&&r.a.createElement(ye,{contextId:t,eventId:E,isDraggable:x,processHashSha256:_}),null!=j&&P&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"xs"}),r.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(ie.b,{iconType:"editorComment",color:"hollow",title:""},r.a.createElement(ee.a,{value:j}))))))));he.displayName="SystemGenericFileLine";const ve=r.a.memo((({contextId:e,data:t,isDraggable:n,showMessage:i=!0,skipRedundantFileDetails:o=!1,skipRedundantProcessDetails:u=!1,text:d,timelineId:p})=>{const m=t._id,f=null!=t.message?t.message[0]:null,g=Object(a.get)("host.name[0]",t),b=Object(a.get)("endgame.exit_code[0]",t),y=Object(a.get)("endgame.file_name[0]",t),h=Object(a.get)("endgame.file_path[0]",t),v=Object(a.get)("endgame.parent_process_name[0]",t),E=Object(a.get)("endgame.pid[0]",t),x=Object(a.get)("endgame.process_name[0]",t),j=Object(a.get)("event.action[0]",t),S=Object(a.get)("file.Ext.original.path[0]",t),O=Object(a.get)("file.hash.sha256[0]",t),k=Object(a.get)("file.name[0]",t),w=Object(a.get)("file.path[0]",t),T=Object(a.get)("user.domain[0]",t),I=Object(a.get)("user.name[0]",t),M=Object(a.get)("event.outcome[0]",t),C=Object(a.get)("system.audit.package.name[0]",t),_=Object(a.get)("system.audit.package.summary[0]",t),D=Object(a.get)("system.audit.package.version[0]",t),A=Object(a.get)("process.exit_code[0]",t),F=Object(a.get)("process.parent.name[0]",t),N=Object(a.get)("process.parent.pid[0]",t),P=Object(a.get)("process.hash.sha256[0]",t),R=Object(a.get)("process.pid[0]",t),L=Object(a.get)("process.ppid[0]",t),z=Object(a.get)("process.name[0]",t),q=Object(a.get)("system.auth.ssh.signature[0]",t),B=Object(a.get)("system.auth.ssh.method[0]",t),$=Object(a.get)("process.executable[0]",t),V=Object(a.get)("process.title[0]",t),U=Object(a.get)("process.working_directory[0]",t),G=Object(a.get)("process.args",t);return r.a.createElement(l.b,null,r.a.createElement(he,{id:m,contextId:e,text:d,hostName:g,endgameExitCode:b,endgameFileName:y,endgameFilePath:h,endgameParentProcessName:v,endgamePid:E,endgameProcessName:x,eventAction:j,fileExtOriginalPath:S,fileHashSha256:O,fileName:k,filePath:w,userDomain:T,userName:I,message:f,processExitCode:A,processParentName:F,processParentPid:N,processTitle:V,workingDirectory:U,args:G,packageName:C,packageSummary:_,packageVersion:D,processHashSha256:P,processName:z,processPid:R,processPpid:L,processExecutable:$,showMessage:i,skipRedundantFileDetails:o,skipRedundantProcessDetails:u,sshSignature:q,sshMethod:B,outcome:M,isDraggable:n}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:t,isDraggable:n,timelineId:p}))}));ve.displayName="SystemGenericFileDetails";const Ee=({actionName:e,text:t})=>({id:o.e.system,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"system"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(X.a,null,r.a.createElement(oe,{contextId:`${e}-${i}`,data:n,isDraggable:a,text:t,timelineId:i}))}),xe=({actionName:e,text:t})=>({id:o.e.system_file,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.category[0]",t),r=Object(a.get)("event.dataset[0]",t);return("process"===(null==i?void 0:i.toLowerCase())||"endpoint.events.process"===(null==r?void 0:r.toLowerCase()))&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(X.a,null,r.a.createElement(ve,{data:n,contextId:`endgame-process-${e}-${i}`,isDraggable:a,showMessage:!1,text:t,timelineId:i}))}),je=({actionName:e,text:t})=>({id:o.e.system_fim,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.category[0]",t),r=Object(a.get)("event.dataset[0]",t);return Object(l.d)({eventCategory:i,eventDataset:r})&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(X.a,null,r.a.createElement(ve,{data:n,contextId:`fim-${e}-${i}`,isDraggable:a,showMessage:!1,text:t,timelineId:i}))}),Se=({eventAction:e,eventCategory:t,eventType:n,skipRedundantFileDetails:i=!1,skipRedundantProcessDetails:s=!1,text:l})=>({id:o.e.alerts,isInstance:i=>{var r,o,s;const l=Object(a.get)("event.action",i),c=Object(a.get)("event.category",i),u=Object(a.get)("event.dataset[0]",i),d=Object(a.get)("event.type",i),p=null!==(r=null==l?void 0:l.includes(e))&&void 0!==r&&r,m=null!==(o=null==c?void 0:c.includes(t))&&void 0!==o&&o,f=null!==(s=null==d?void 0:d.includes(n))&&void 0!==s&&s;return"endpoint.alerts"===(null==u?void 0:u.toLowerCase())&&f&&m&&p},renderRow:({data:a,isDraggable:o,scopeId:c})=>r.a.createElement(X.a,null,r.a.createElement(ve,{contextId:`endpoint-alerts-row-renderer-${e}-${t}-${n}-${c}`,data:a,isDraggable:o,showMessage:!1,skipRedundantFileDetails:i,skipRedundantProcessDetails:s,text:l,timelineId:c}))}),Oe=({actionName:e,text:t})=>({id:o.e.library,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.dataset[0]",t);return"endpoint.events.library"===(null==i?void 0:i.toLowerCase())&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(X.a,null,r.a.createElement(ve,{contextId:`library-row-renderer-${e}-${i}`,data:n,isDraggable:a,showMessage:!1,text:t,timelineId:i}))}),ke=({actionName:e,text:t})=>({id:o.e.system_file,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"system"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(X.a,null,r.a.createElement(ve,{contextId:`${e}-${i}`,data:n,isDraggable:a,text:t,timelineId:i}))}),we=({actionName:e,text:t})=>({id:o.e.system_socket,isInstance:t=>{const n=Object(a.get)("event.action[0]",t);return null!=n&&n.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(X.a,null,r.a.createElement(ve,{contextId:`socket-${e}-${i}`,data:n,isDraggable:a,text:t,timelineId:i}))}),Te=({actionName:e})=>({id:o.e.system_security_event,isInstance:t=>{const n=Object(a.get)("event.category[0]",t),i=Object(a.get)("event.action[0]",t),r=Object(a.get)("event.dataset[0]",t);return("authentication"===(null==n?void 0:n.toLowerCase())||"endpoint.events.security"===(null==r?void 0:r.toLowerCase()))&&(null==i?void 0:i.toLowerCase())===e},renderRow:({data:t,isDraggable:n,scopeId:a})=>r.a.createElement(X.a,null,r.a.createElement(H,{contextId:`authentication-${e}-${a}`,data:t,isDraggable:n,timelineId:a}))}),Ie=()=>({id:o.e.system_dns,isInstance:e=>{const t=Object(a.get)("dns.question.type[0]",e),n=Object(a.get)("dns.question.name[0]",e);return!Object(l.e)(t)&&!Object(l.e)(n)},renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(X.a,null,r.a.createElement(x,{contextId:`dns-request-${n}`,data:e,isDraggable:t,timelineId:n}))}),Me=({actionName:e,text:t})=>({id:o.e.registry,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.dataset[0]",t);return"endpoint.events.registry"===(null==i?void 0:i.toLowerCase())&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:e,isDraggable:n,scopeId:a})=>r.a.createElement(X.a,null,r.a.createElement(Z,{contextId:`registry-event-${a}`,data:e,isDraggable:n,text:t}))}),Ce=Ee({actionName:"user_login",text:te.c}),_e=ke({actionName:"process_started",text:te.A}),De=xe({actionName:"creation_event",text:te.A}),Ae=xe({actionName:"start",text:te.A}),Fe=Me({actionName:"modification",text:te.u}),Ne=ke({actionName:"process_stopped",text:te.B}),Pe=xe({actionName:"termination_event",text:te.H}),Re=xe({actionName:"end",text:te.H}),Le=je({actionName:"file_create_event",text:te.e}),ze=je({actionName:"creation",text:te.e}),qe=je({actionName:"created",text:te.e}),Be=je({actionName:"file_delete_event",text:te.f}),$e=je({actionName:"deletion",text:te.f}),Ve=je({actionName:"modification",text:te.t}),Ue=je({actionName:"overwrite",text:te.v}),Ge=je({actionName:"rename",text:te.E}),He=je({actionName:"deleted",text:te.f}),We=ke({actionName:"existing_process",text:te.k}),Qe=[{eventAction:"creation",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.R},{eventAction:"creation",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.N},{eventAction:"files-encrypted",eventCategory:"file",eventType:"denied",skipRedundantFileDetails:!0,text:te.D},{eventAction:"files-encrypted",eventCategory:"file",eventType:"allowed",skipRedundantFileDetails:!0,text:te.C},{eventAction:"modification",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.T},{eventAction:"modification",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.P},{eventAction:"rename",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.U},{eventAction:"rename",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.Q},{eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:te.S},{eventAction:"execution",eventCategory:"process",eventType:"allowed",skipRedundantFileDetails:!0,text:te.O}].map((e=>Se(e))),Ye=Oe({actionName:"load",text:te.q}),Ke=we({actionName:"socket_opened",text:te.G}),Je=we({actionName:"socket_closed",text:te.F}),Ze=we({actionName:"ipv4_connection_accept_event",text:te.b}),Xe=we({actionName:"connection_accepted",text:te.b}),et=we({actionName:"http_request",text:te.s}),tt=xe({actionName:"exec",text:te.i}),nt=xe({actionName:"fork",text:te.n}),at=we({actionName:"ipv6_connection_accept_event",text:te.b}),it=we({actionName:"ipv4_disconnect_received_event",text:te.g}),rt=we({actionName:"disconnect_received",text:te.g}),ot=we({actionName:"ipv6_disconnect_received_event",text:te.g}),st=Te({actionName:"admin_logon"}),lt=Te({actionName:"explicit_user_logon"}),ct=Te({actionName:"user_logoff"}),ut=Te({actionName:"user_logon"}),dt=Te({actionName:"log_on"}),pt=Ie(),mt=Ee({actionName:"existing_user",text:te.m}),ft=ke({actionName:"existing_socket",text:te.l}),gt=Ee({actionName:"existing_package",text:te.j}),bt=ke({actionName:"invalid",text:te.p}),yt=Ee({actionName:"user_changed",text:te.J}),ht=Ee({actionName:"host",text:te.o}),vt=Ee({actionName:"user_added",text:te.I}),Et=Ee({actionName:"user_logout",text:te.r}),xt=Te({actionName:"log_off"}),jt=ke({actionName:"process_error",text:te.z}),St=Ee({actionName:"error:",text:te.h}),Ot=Ee({actionName:"error",text:te.h}),kt=Ee({actionName:"package_installed",text:te.w}),wt=Ee({actionName:"boot",text:te.d}),Tt=[pt,st,lt,Le,ze,Be,$e,Ue,Ge,...Qe,Ye,Ve,Fe,Ze,Xe,et,tt,nt,at,it,rt,ot,De,Ae,Pe,Re,ct,ut,dt,qe,He,Ee({actionName:"accepted",text:te.a}),wt,Ot,St,gt,We,ft,mt,ht,bt,Ce,Et,xt,kt,Ee({actionName:"package_updated",text:te.y}),Ee({actionName:"package_removed",text:te.x}),jt,_e,Ne,Je,Ke,vt,yt,Ee({actionName:"user_removed",text:te.K})]},function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return k})),n.d(t,"c",(function(){return q})),n.d(t,"d",(function(){return $})),n.d(t,"e",(function(){return Z})),n.d(t,"g",(function(){return ne.b})),n.d(t,"f",(function(){return ne.a}));var a=n(120);const i=a.enum(["true","false"]).or(a.boolean()).transform((e=>"boolean"==typeof e?e:"true"===e));var r=n(176),o=n(199);const s=a.z.literal("RULE_NOT_MODIFIED"),l=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:s}),c=a.z.object({id:a.z.string(),name:a.z.string().optional()}),u=a.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN","MANUAL_RULE_RUN_FEATURE","MANUAL_RULE_RUN_DISABLED_RULE"]),d=(u.enum,a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:u.optional(),rules:a.z.array(c)})),p=a.z.object({updated:a.z.array(r.e),created:a.z.array(r.e),deleted:a.z.array(r.e),skipped:a.z.array(l)}),m=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),f=a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),rules_count:a.z.number().int().optional(),attributes:a.z.object({results:p,summary:m,errors:a.z.array(d).optional()})}),g=a.z.string(),b=a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()}),y=b.merge(a.z.object({action:a.z.literal("delete")})),h=b.merge(a.z.object({action:a.z.literal("disable")})),v=b.merge(a.z.object({action:a.z.literal("enable")})),E=b.merge(a.z.object({action:a.z.literal("export")})),x=b.merge(a.z.object({action:a.z.literal("duplicate"),duplicate:a.z.object({include_exceptions:a.z.boolean(),include_expired_exceptions:a.z.boolean()}).optional()})),j=b.merge(a.z.object({action:a.z.literal("run"),run:a.z.object({start_date:a.z.string(),end_date:a.z.string().optional()})})),S=a.z.enum(["rule","1h","1d","7d"]),O=(S.enum,a.z.enum(["enable","disable","export","delete","duplicate","edit","run"]).enum),k=a.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule","add_investigation_fields","delete_investigation_fields","set_investigation_fields"]).enum,w=a.z.object({group:o.w,id:o.x,params:o.y,frequency:o.v.optional(),alerts_filter:o.u.optional()}).strict(),T=a.z.object({type:a.z.enum(["add_rule_actions","set_rule_actions"]),value:a.z.object({throttle:S.optional(),actions:a.z.array(w)})}),I=a.z.object({type:a.z.literal("set_schedule"),value:a.z.object({interval:a.z.string().regex(/^[1-9]\d*[smh]$/),lookback:a.z.string().regex(/^[1-9]\d*[smh]$/)})}),M=a.z.object({type:a.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:o.h,overwrite_data_views:a.z.boolean().optional()}),C=a.z.object({type:a.z.enum(["add_tags","delete_tags","set_tags"]),value:o.R}),_=a.z.object({type:a.z.enum(["add_investigation_fields","delete_investigation_fields","set_investigation_fields"]),value:o.i}),D=a.z.object({type:a.z.literal("set_timeline"),value:a.z.object({timeline_id:o.bb,timeline_title:o.cb})}),A=a.z.union([C,M,_,D,T,I]),F=b.merge(a.z.object({action:a.z.literal("edit"),edit:a.z.array(A).min(1)}));a.z.object({dry_run:i.optional()}),a.z.union([y,h,v,E,x,j,F]),a.z.union([f,g]);var N=n(374);a.z.array(a.z.union([r.e,N.a])),a.z.array(r.c),a.z.array(a.z.object({id:o.M.optional(),rule_id:o.P.optional()})),a.z.array(r.d),a.z.array(r.f);var P=n(46),R=n(2074),L=n(1371),z=n(2072);let q=function(e){return e.Enabled="enabled",e.Disabled="disabled",e}({});const B=Object(R.a)("CoverageOverviewRuleActivity",q);let $=function(e){return e.Prebuilt="prebuilt",e.Custom="custom",e}({});const V=Object(R.a)("CoverageOverviewRuleSource",$),U=P.partial({search_term:L.a,activity:Object(z.a)(B),source:Object(z.a)(V)}),G=(P.exact(P.partial({filter:U})),P.type({name:P.string,activity:B})),H=(P.exact(P.type({coverage:P.record(P.string,Object(z.a)(P.string)),unmapped_rule_ids:P.array(P.string),rules_data:P.record(P.string,G)})),r.c,r.e,a.z.object({id:o.M.optional(),rule_id:o.P.optional()}),r.e,r.d,r.e,a.z.object({id:o.M.optional(),rule_id:o.P.optional()}),r.e,r.f,r.e,{exported_exception_list_count:P.number,exported_exception_list_item_count:P.number,missing_exception_list_item_count:P.number,missing_exception_list_items:P.array(P.exact(P.type({item_id:L.a}))),missing_exception_lists:P.array(P.exact(P.type({list_id:L.a}))),missing_exception_lists_count:P.number}),W=(P.exact(P.type(H)),{exported_count:P.number,exported_rules_count:P.number,missing_rules:P.array(P.exact(P.type({rule_id:L.a}))),missing_rules_count:P.number}),Q=P.intersection([P.exact(P.type({id:L.a,type:L.a})),P.exact(P.partial({reason:P.string}))]),Y={exported_action_connector_count:P.number,missing_action_connection_count:P.number,missing_action_connections:P.array(P.exact(P.type({id:L.a,type:L.a}))),excluded_action_connection_count:P.number,excluded_action_connections:P.array(Q)};P.intersection([P.exact(P.type(W)),P.exact(P.partial(H)),P.exact(P.partial(Y))]),a.z.object({exclude_export_details:i.optional().default(!1),file_name:a.z.string().optional().default("export.ndjson")}),a.z.object({objects:a.z.array(a.z.object({rule_id:o.P}))}).nullable();var K=n(1449),J=n(330);const Z=a.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);Z.enum,a.z.object({fields:Object(K.a)(a.z.string()).optional(),filter:a.z.string().optional(),sort_field:Z.optional(),sort_order:J.a.optional(),page:a.z.coerce.number().int().min(1).optional().default(1),per_page:a.z.coerce.number().int().min(0).optional().default(20)}),a.z.object({page:a.z.number().int(),perPage:a.z.number().int(),total:a.z.number().int(),data:a.z.array(r.e)});var X=n(2075);P.exact(P.type({rules_summary:P.type({custom_count:X.a,prebuilt_installed_count:X.a}),aggregated_fields:P.type({tags:P.array(P.string)})}));var ee=n(472);a.z.object({overwrite:i.optional().default(!1),overwrite_exceptions:i.optional().default(!1),overwrite_action_connectors:i.optional().default(!1),as_new_list:i.optional().default(!1)}),a.z.object({exceptions_success:a.z.boolean(),exceptions_success_count:a.z.number().int().min(0),exceptions_errors:a.z.array(N.a),rules_count:a.z.number().int().min(0),success:a.z.boolean(),success_count:a.z.number().int().min(0),errors:a.z.array(N.a),action_connectors_errors:a.z.array(N.a),action_connectors_warnings:a.z.array(ee.a),action_connectors_success:a.z.boolean(),action_connectors_success_count:a.z.number().int().min(0)}).strict();var te=n(290);te.b.and(te.g).and(te.d.partial().extend({rule_id:te.e,immutable:a.literal(!1).default(!1),required_fields:a.array(te.c).optional()})),o.R;var ne=n(473)},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var a=n(0),i=n.n(a);let r=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),o=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){i()(this,"name",void 0),i()(this,"sortable",void 0),i()(this,"filterable",void 0),i()(this,"esTypes",void 0),this.name=e.name||o.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}const s=new kbn_field_type_KbnFieldType({name:o.UNKNOWN}),l=[new kbn_field_type_KbnFieldType({name:o.STRING,sortable:!0,filterable:!0,esTypes:[r.STRING,r.TEXT,r.MATCH_ONLY_TEXT,r.KEYWORD,r.VERSION,r._TYPE,r._ID]}),new kbn_field_type_KbnFieldType({name:o.NUMBER,sortable:!0,filterable:!0,esTypes:[r.FLOAT,r.HALF_FLOAT,r.SCALED_FLOAT,r.DOUBLE,r.INTEGER,r.LONG,r.UNSIGNED_LONG,r.SHORT,r.BYTE,r.TOKEN_COUNT,r.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:o.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[r.FLOAT_RANGE,r.DOUBLE_RANGE,r.INTEGER_RANGE,r.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:o.DATE,sortable:!0,filterable:!0,esTypes:[r.DATE,r.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:o.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[r.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:o.IP,sortable:!0,filterable:!0,esTypes:[r.IP]}),new kbn_field_type_KbnFieldType({name:o.IP_RANGE,sortable:!0,filterable:!0,esTypes:[r.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:o.BOOLEAN,sortable:!0,filterable:!0,esTypes:[r.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:o.OBJECT,esTypes:[r.OBJECT]}),new kbn_field_type_KbnFieldType({name:o.NESTED,esTypes:[r.NESTED]}),new kbn_field_type_KbnFieldType({name:o.GEO_POINT,esTypes:[r.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:o.GEO_SHAPE,esTypes:[r.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:o.ATTACHMENT,esTypes:[r.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:o.MURMUR3,esTypes:[r.MURMUR3]}),new kbn_field_type_KbnFieldType({name:o._SOURCE,esTypes:[r._SOURCE]}),new kbn_field_type_KbnFieldType({name:o.HISTOGRAM,filterable:!0,esTypes:[r.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:o.CONFLICT}),s],c=e=>{const t=l.find((t=>t.esTypes.includes(e)));return t&&t.name?t.name:o.UNKNOWN};function u(e){switch(e){case r._INDEX:return o.STRING;case"_version":return o.NUMBER;case"datetime":return o.DATE;default:return c(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s}));const a="kibana.alert.ancestors.id",i="kibana.alert.rule.indices",r="process.entry_leader.entity_id",o="process.entry_leader.start",s="kibana.alert.ancestors.index"},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(119),i=n.n(a),r=n(52),o=n.n(r),s=n(2),l=n.n(s),c=n(41),u=n.n(c),d=n(206),p=n(196);const m=u.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1kulm59-0"})(["&.securitySolutionWrapper--fullHeight{height:100%;display:flex;flex-direction:column;flex:1 1 auto;}&.securitySolutionWrapper--noPadding{padding:0;display:flex;flex-direction:column;flex:1 1 auto;}"]);m.displayName="Wrapper";const f=({children:e,className:t,style:n,noPadding:a,noTimeline:r,...c})=>{const{globalFullScreen:u,setGlobalFullScreen:f}=Object(d.a)();Object(s.useEffect)((()=>{f(!1)}),[f]);const g=o()(t,{securitySolutionWrapper:!0,"securitySolutionWrapper--noPadding":a,"securitySolutionWrapper--withTimeline":!r,"securitySolutionWrapper--fullHeight":u});return l.a.createElement(m,i()({className:g,style:n},c),e,l.a.createElement(p.a,null))},g=l.a.memo(f)},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(475);let i=function(e){return e.DEFAULT="security-default-cellActions",e.DETAILS_FLYOUT="security-detailsFlyout-cellActions",e.ALERTS_COUNT="security-alertsCount-cellActions",e}({}),r=function(e){return e.HISTOGRAM_TRIGGER="security-discoverInTimeline-histogramTrigger",e}({}),o=function(e){return e.VIS_FILTER_ACTION="security-discoverInTimeline-visFilterAction",e}({}),s=function(e){return e.FILTER="security-cellAction-type-filter",e.COPY="security-cellAction-type-copyToClipboard",e.ADD_TO_TIMELINE="security-cellAction-type-addToTimeline",e.INVESTIGATE_IN_NEW_TIMELINE="security-cellAction-type-investigateInNewTimeline",e.SHOW_TOP_N="security-cellAction-type-showTopN",e.TOGGLE_COLUMN="security-cellAction-type-toggleColumn",e}({});const l={FILTER:a.c,COPY:a.a}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(4),i=n(1870);a.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),a.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),a.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),a.i18n.translate("xpack.securitySolution.eventFiltersTab",{defaultMessage:"Event filters"});const r={[i.c.WINDOWS]:a.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[i.c.MAC]:a.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[i.c.LINUX]:a.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})},o=e=>a.i18n.translate("xpack.securitySolution.exceptions.failedLoadPolicies",{defaultMessage:'There was an error loading policies: "{error}"',values:{error:e.message}}),s={isolate:{title:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.title",{defaultMessage:"Isolate"}),about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.about",{defaultMessage:"Isolate the host"}),privileges:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.privileges",{defaultMessage:"Insufficient privileges to isolate hosts. Contact your Kibana administrator if you think you should have this permission."})},release:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.release.about",{defaultMessage:"Release the host"})},killProcess:{title:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.title",{defaultMessage:"Kill process"}),about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.about",{defaultMessage:"Kill/terminate a process"}),privileges:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.privileges",{defaultMessage:"Insufficient privileges to kill process. Contact your Kibana administrator if you think you should have this permission."}),args:{pid:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.pid.arg.comment",{defaultMessage:"A PID representing the process to kill"})},entityId:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.entityId.arg.comment",{defaultMessage:"An entity id representing the process to kill"})}}},suspendProcess:{title:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.title",{defaultMessage:"Suspend process"}),about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.about",{defaultMessage:"Temporarily suspend a process"}),privileges:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.privileges",{defaultMessage:"Insufficient privileges to supend process. Contact your Kibana administrator if you think you should have this permission."}),args:{pid:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.pid.arg.comment",{defaultMessage:"A PID representing the process to suspend"})},entityId:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.entityId.arg.comment",{defaultMessage:"An entity id representing the process to suspend"})}}},status:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.status.about",{defaultMessage:"Show host status information"})},processes:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.processes.about",{defaultMessage:"Show all running processes"})},getFile:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.getFile.about",{defaultMessage:"Retrieve a file from the host"}),args:{path:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.getFile.pathArgAbout",{defaultMessage:"The full file path to be retrieved"})}}},execute:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.about",{defaultMessage:"Execute a command on the host"}),args:{timeout:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.args.timeout.about",{defaultMessage:"The timeout in units of time (h for hours, m for minutes, s for seconds) for the endpoint to wait for the script to complete. Example: 37m. If not given, it defaults to 4 hours."})}}},upload:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.upload.about",{defaultMessage:"Upload a file to the host"}),args:{file:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.upload.args.file.about",{defaultMessage:"The file that will be sent to the host"})},overwrite:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.upload.args.overwrite.about",{defaultMessage:"Overwrite the file on the host if it already exists"})}}},scan:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.scan.about",{defaultMessage:"Scan the host for malware"}),args:{path:{about:a.i18n.translate("xpack.securitySolution.endpointConsoleCommands.scan.args.path.about",{defaultMessage:"The absolute path to a file or directory to be scanned"})}}}},l=e=>({title:a.i18n.translate("xpack.securitySolution.artifacts.confirmWarningModal.title",{defaultMessage:"Confirm {type}",values:{type:e}}),body:a.i18n.translate("xpack.securitySolution.artifacts.confirmWarningModal.body",{defaultMessage:'Using a "*" or a "?" in the value with the "is" operator can make the entry ineffective. Change the operator to "matches" to ensure wildcards run properly. Select “Cancel” to revise your entry, or "Add" to continue with the entry in its current state.'}),confirmButton:a.i18n.translate("xpack.securitySolution.artifacts.confirmWarningModal.confirmButtonText",{defaultMessage:"Add"}),cancelButton:a.i18n.translate("xpack.securitySolution.trustedapps.confirmWarningModal.cancelButtonText",{defaultMessage:"Cancel"})})},function(e,t,n){"use strict";var a=n(1141);e.exports=function(e,t,n,i){var r,o=e.length,s=0;if(t=t<0?-t>o?0:o+t:t>o?o:t,n=n>0?n:0,i.length<1e4)(r=Array.from(i)).unshift(t,n),a.apply(e,r);else for(n&&a.apply(e,[t,n]);s<i.length;)(r=i.slice(s,s+1e4)).unshift(t,0),a.apply(e,r),s+=1e4,t+=1e4}},function(e,t,n){"use strict";e.exports=function(e){return e<0||32===e}},function(e,t,n){"use strict";var a=n(388);e.exports=function(e){return function(t){return e.test(a(t))}}},,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"o",(function(){return v}));var a=n(4),i=n(264);n.d(t,"p",(function(){return i.d}));const r=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.feedNamePreposition",{defaultMessage:"from"}),o=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTitle",{defaultMessage:"Threat match detected"}),s=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTitle",{defaultMessage:"Enriched with threat intelligence"}),l=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTooltipContent",{defaultMessage:"Shows available threat indicator matches."}),c=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTooltipContent",{defaultMessage:"Shows additional threat intelligence for the alert. The past 30 days were queried by default."}),u=(a.i18n.translate("xpack.securitySolution.alertDetails.noInvestigationEnrichmentsDescription",{defaultMessage:"This alert does not have supplemental threat intelligence data."}),a.i18n.translate("xpack.securitySolution.alertDetails.noEnrichmentsFoundDescription",{defaultMessage:"This alert does not have threat intelligence."})),d=a.i18n.translate("xpack.securitySolution.alertDetails.investigationTimeQueryTitle",{defaultMessage:"Enrichment with Threat Intelligence"}),p=a.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryStartDate",{defaultMessage:"Start date"}),m=a.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryEndDate",{defaultMessage:"End date"}),f=a.i18n.translate("xpack.securitySolution.alertDetails.refresh",{defaultMessage:"Refresh"}),g=a.i18n.translate("xpack.securitySolution.alertDetails.overview.enrichedDataTitle",{defaultMessage:"Enriched data"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentObjectValuesNotRendered",{defaultMessage:"This field contains nested object values, which are not rendered here. See the full document for all fields/values"}),y=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskLevel",{defaultMessage:"Current {riskEntity} risk level",values:{riskEntity:Object(i.e)(e,!0)}}),h=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.originalHostRiskLevel",{defaultMessage:"Original {riskEntity} risk level",values:{riskEntity:Object(i.e)(e,!0)}}),v=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskDataTitle",{defaultMessage:"{riskEntity} Risk Data",values:{riskEntity:Object(i.e)(e)}})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(894);const r=()=>Object(a.useContext)(i.a)},function(e,t,n){"use strict";var a=n(463);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));let a=function(e){return e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions",e}({}),i=function(e){return e.IndexPatterns="indexPatterns",e.DataView="dataView",e}({}),r=function(e){return e.PerRuleExecution="per-rule-execution",e.PerTimePeriod="per-time-period",e}({})},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1),t=a.useCallback((function(){return e.current}),[]);return a.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var a=n(44),i=n(395),r=n.n(i),o=n(2),s=n(118),l=n(512),c=n(294),u=n(123);const d=e=>Object(a.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),p=r()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(a.pick)(["name","searchable","type","aggregatable","esTypes","subType","conflictDescriptions"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),m={},f={fields:[],title:""},g=(e,t=!1,n="indexFields")=>{const{data:i}=Object(s.j)().services,r=Object(o.useRef)(new AbortController),d=Object(o.useRef)([]),[g,b]=Object(o.useState)({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),{addError:y}=Object(u.a)(),h=Object(o.useCallback)((t=>{(async()=>{try{b({...g,loading:!0}),r.current=new AbortController;const e=await i.dataViews.create({title:t.join(","),allowNoIndex:!0}),n=e.toSpec(),{browserFields:a}=Object(c.a)(t,n.fields);d.current=e.getIndexPattern().split(","),b({loading:!1,dataView:n,browserFields:a,indexes:e.getIndexPattern().split(","),indexExists:e.getIndexPattern().split(",").length>0,indexPatterns:p(e.getIndexPattern(),e.fields)})}catch(t){b({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),y(null==t?void 0:t.message,{title:l.a})}})()}),[y,i.dataViews,e,g]);return Object(o.useEffect)((()=>(Object(a.isEmpty)(e)||Object(a.isEqual)(d.current,e)||h(e),()=>{r.current.abort()})),[e,d]),[g.loading,g]}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"t",(function(){return g})),n.d(t,"s",(function(){return b})),n.d(t,"r",(function(){return y})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"c",(function(){return x})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"v",(function(){return k})),n.d(t,"w",(function(){return w}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights",{defaultMessage:"Insights"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry",{defaultMessage:"Related alerts by process ancestry"}),o=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} by process ancestry",values:{count:e}}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_error",{defaultMessage:"Failed to fetch alerts."}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.processAncestryFilter",{defaultMessage:"Process Ancestry Alert IDs"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_empty",{defaultMessage:"There are no related alerts by process ancestry."}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_error",{defaultMessage:"Failed to load related alerts by session"}),p=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_empty",{defaultMessage:"There are no related alerts by session"}),m=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by session",values:{count:e}}),f=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),g=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_error",{defaultMessage:"Failed to load related alerts by source event"}),b=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_empty",{defaultMessage:"There are no related alerts by source event"}),y=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights_related_alerts_by_source_event_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by source event",values:{count:e}}),h=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_loading",{defaultMessage:"Loading related cases"}),v=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_error",{defaultMessage:"Failed to load related cases"}),E=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_count",{defaultMessage:"{count} {count, plural, =1 {case} other {cases}} related to this alert",values:{count:e}}),x=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.relatedCasesFailure",{defaultMessage:'Unable to load related cases: "{error}"',values:{error:e}}),j=a.i18n.translate("xpack.securitySolution.alertDetails.overview.simpleAlertTable.error",{defaultMessage:"Failed to load the alerts."}),S=a.i18n.translate("xpack.securitySolution.alertDetails.overview.limitedAlerts",{defaultMessage:"Showing only the latest 10 alerts. View the rest of alerts in timeline."}),O=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.alertUpsellTitle",{defaultMessage:"Get more insights with a platinum subscription"}),k=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCount",{defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),w=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCountTechnicalPreview",{defaultMessage:"Technical Preview"})},function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"i",(function(){return h}));var a=n(211);const i=`${a.a}VisualizeTab`,r=`${i}ButtonGroup`,o=`${i}SessionViewButton`,s=`${i}GraphAnalyzerButton`,l=`${a.a}InsightsTab`,c=`${l}ButtonGroup`,u=`${l}EntitiesButton`,d=`${l}Entities`,p=`${l}ThreatIntelligenceButton`,m=`${l}Prevalence`,f=`${l}PrevalenceButton`,g=`${l}CorrelationsButton`,b=`${a.a}InvestigationsTabContent`,y=`${a.a}ResponseTabContent`,h=`${a.a}NotesTabContent`},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=n(1371).a;a.union([i,a[void 0]])},function(e,t,n){"use strict";var a=n(295);n.d(t,"b",(function(){return a.b})),n.d(t,"a",(function(){return a.a}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(207);const i=e=>`${Object(a.a)(e)}`,r=e=>`${Object(a.a)(e)}`,o=(e,t)=>`/id/${e}${Object(a.a)(t)}`,s=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,l=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"a",(function(){return f}));var a=n(50),i=n(245);const r=i.b.length,o=e=>{var t;return(null!==(t=e.tags)&&void 0!==t?t:[]).includes(i.e)},s=e=>!o(e),l=e=>{var t;const n=[],a=null!==(t=e.tags)&&void 0!==t?t:[];for(const e of a)e!==i.e&&e.startsWith(i.b)&&n.push(e.substring(r));return n},c=e=>e.startsWith(i.b)||e===i.e,u=e=>e.isGlobal?[i.e]:e.selected.map((e=>`${i.b}${e.id}`)),d=(e,t)=>e.find((e=>e===i.e))?{isGlobal:!0,selected:[]}:{isGlobal:!1,selected:e.reduce(((e,n)=>{const a=n.split(":")[1],i=t.find((e=>e.id===a));return void 0!==i&&e.push(i),e}),[])},p=e=>{var t;return(null!==(t=e.tags)&&void 0!==t?t:[]).includes(i.d)},m=e=>e===i.d,f=e=>({comments:[],description:"",entries:[],item_id:void 0,list_id:e,meta:{temporaryUuid:Object(a.v4)()},name:"",namespace_type:"agnostic",tags:[i.e],type:"simple",os_types:["windows"]})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(7);const i=(e,t=!1)=>{if(Array.isArray(e))return e;const n={};return Object.entries(e).forEach((([e,i])=>{const r=t&&Array.isArray(i)&&1===i.length;Object(a.merge)(n,Object(a.setWith)({},e,r?i[0]:i,Object))})),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(45),c=n(148),u=n(138),d=n(183),p=n(13),m=n(200),f=n(127),g=n(146),b=n(121),y=n(331),h=n(172);const v=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:v,keepDataView:E,iconType:x,...j})=>{const S=Object(l.useDispatch)(),O=Object(l.useSelector)(c.e.signalIndexName),k=Object(l.useSelector)(c.e.defaultDataView),w=n&&n.find((e=>"template"===e.type)),T=Object(y.a)({timelineId:g.c.active,timelineType:w?b.m.template:b.m.default}),I=Object(r.useCallback)((async()=>{(n||a)&&(v?await T({timeRange:v}):await T(),n&&S(Object(p.updateProviders)({id:g.c.active,providers:n})),a&&S(Object(p.setFilters)({id:g.c.active,filters:a})),E||S(m.d.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:k.id,selectedPatterns:[O||""]})),S(d.b.removeLinkTo([u.a.timeline,u.a.global])))}),[n,T,S,k.id,O,a,v,E]);return e?o.a.createElement(s.EuiButtonEmpty,{"aria-label":h.i,onClick:I,flush:"right",size:"xs",iconType:x},t):o.a.createElement(s.EuiButton,i()({"aria-label":h.i,onClick:I},j),t)};v.displayName="InvestigateInTimelineButton"},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(4),i=n(137);const r=a.i18n.translate("xpack.securitySolution.riskScore.overview.hostTitle",{defaultMessage:"Host"}),o=a.i18n.translate("xpack.securitySolution.riskScore.overview.hosts",{defaultMessage:"Hosts"}),s=a.i18n.translate("xpack.securitySolution.riskScore.overview.userTitle",{defaultMessage:"User"}),l=a.i18n.translate("xpack.securitySolution.riskScore.overview.users",{defaultMessage:"Users"}),c=a.i18n.translate("xpack.securitySolution.riskScore.overview.entityTitle",{defaultMessage:"Entity"}),u=a.i18n.translate("xpack.securitySolution.riskScore.overview.entities",{defaultMessage:"Entities"}),d=e=>a.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoreTitle",{defaultMessage:"{riskEntity} Risk Score",values:{riskEntity:f(e)}}),p=a.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoringTitle",{defaultMessage:"Entity Risk Scoring"}),m=e=>a.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskLevelTitle",{defaultMessage:"{riskEntity} risk level",values:{riskEntity:f(e)}}),f=(e,t=!1,n=!1)=>{const a=g(e,n);return t?a.toLowerCase():a},g=(e,t)=>{switch(e){case i.t.host:return t?o:r;case i.t.user:return t?l:s;default:return t?u:c}},b=a.i18n.translate("xpack.securitySolution.riskScore.overview.alerts",{defaultMessage:"Alerts"})},,,function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"m",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"a",(function(){return E}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),r=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),g=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),b=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),y=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),h=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),v=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),E=a.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef();return a.useEffect((function(){t.current=e})),t.current}},function(e,t,n){"use strict";n.d(t,"j",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(44),i=n(121),r=n(432);const o=(e,t)=>"__typename"!==e&&null!=t?t:void 0,s=e=>!Object(a.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===i.m.template?r.b(e):n?r.d(e):t?r.c(e):r.g(e),c=({eventId:e,pinnedEventIds:t})=>!0===t[e],u=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:i})=>{e&&(i?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),p=e=>{var t,n;return!Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n?void 0:n.building_block_type)},m=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,i;const t=(null!==(n=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},f=e=>{var t,n,i,r;return Object(a.isEmpty)(null==e||null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.uuid)?Object(a.isEmpty)(null==e||null===(r=e.eql)||void 0===r?void 0:r.parentId)?"raw":"eql":"signal"},g="note-content"},function(e,t,n){"use strict";n.d(t,"i",(function(){return d.h})),n.d(t,"g",(function(){return p.a})),n.d(t,"h",(function(){return m.g})),n.d(t,"a",(function(){return f.b})),n.d(t,"b",(function(){return f.c})),n.d(t,"c",(function(){return f.d})),n.d(t,"d",(function(){return f.f})),n.d(t,"e",(function(){return g.f})),n.d(t,"f",(function(){return g.g}));var a=n(120),i=n(268);const r=a.z.array(i.a).min(1),o=i.a,s=a.z.array(o),l=a.z.enum(["open","closed","acknowledged","in-progress"]),c=(l.enum,a.z.object({add:a.z.array(i.a),remove:a.z.array(i.a)})),u=(a.z.object({assignees:c,ids:r}),a.z.object({tags_to_add:s,tags_to_remove:s}));a.z.object({ids:r,tags:u}),a.z.object({}).catchall(a.z.unknown()),n(624),a.z.object({acknowledged:a.z.boolean()}),a.z.object({acknowledged:a.z.boolean()}),a.z.object({name:a.z.string(),index_mapping_outdated:a.z.boolean().nullable()}),n(247);var d=n(290),p=(n(374),n(471),n(425),n(330)),m=(n(472),n(440)),f=(n(501),n(232)),g=n(341);d.f.and(d.g).and(a.object({invocationCount:a.number(),timeframeEnd:a.string()}));const b=a.z.union([a.z.string(),a.z.object({}).catchall(a.z.unknown())]),y=a.z.union([b,a.z.array(b)]),h=(a.z.object({query:a.z.object({}).catchall(a.z.unknown()).optional(),aggs:a.z.object({}).catchall(a.z.unknown()).optional(),size:a.z.number().int().min(0).optional(),track_total_hits:a.z.boolean().optional(),_source:a.z.union([a.z.boolean(),a.z.string(),a.z.array(a.z.string())]).optional(),fields:a.z.array(a.z.string()).optional(),runtime_mappings:a.z.object({}).catchall(a.z.unknown()).optional(),sort:y.optional()}),a.z.object({}).catchall(a.z.unknown()),a.z.object({signal_ids:a.z.array(i.a).min(1),status:l})),v=a.z.object({query:a.z.object({}).catchall(a.z.unknown()),status:l,conflicts:a.z.enum(["abort","proceed"]).optional().default("abort")}),E=(a.z.union([h,v]),a.z.object({}).catchall(a.z.unknown()),a.z.object({requests_per_second:a.z.number().int().min(1).optional(),size:a.z.number().int().min(1).optional(),slices:a.z.number().int().min(1).optional()})),x=a.z.object({index:a.z.string(),migration_id:a.z.string(),migration_index:a.z.string()}),j=a.z.object({index:a.z.string(),error:a.z.object({message:a.z.string(),status_code:a.z.string()})}),S=a.z.object({index:a.z.string()}),O=(a.z.object({index:a.z.array(i.a).min(1)}).merge(E),a.z.object({indices:a.z.array(a.z.union([x,j,S]))}),a.z.object({id:a.z.string(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()})),k=(a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(O),a.z.object({id:a.z.string(),completed:a.z.boolean(),destinationIndex:a.z.string(),status:a.z.enum(["success","failure","pending"]),sourceIndex:a.z.string(),version:a.z.string(),updated:a.z.string().datetime(),error:a.z.object({message:a.z.string(),status_code:a.z.number().int()}).optional()}));a.z.object({migration_ids:a.z.array(a.z.string()).min(1)}),a.z.array(k);var w=n(2073);const T=a.z.object({version:a.z.number().int(),count:a.z.number().int()}),I=a.z.object({id:i.a,status:a.z.enum(["success","failure","pending"]),version:a.z.number().int(),updated:a.z.string().datetime()}),M=a.z.object({index:i.a,version:a.z.number().int(),signal_versions:a.z.array(T),migrations:a.z.array(I),is_outdated:a.z.boolean()});a.z.object({from:a.z.string().superRefine(w.a)}),a.z.object({indices:a.z.array(M)})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(46);const i=a.object,r=a.union([i,a[void 0]]);a.union([r,a.null])},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n(5);var a=n(207);const i=(e,t)=>`/${e}${Object(a.a)(t)}`,r=(e,t)=>`/name/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(44),i=n(2),r=n.n(i),o=n(433),s=n(629),l=n(520),c=n(590),u=n(406),d=n(630),p=n(859),m=n(592),f=n(382),g=n(591),b=n(569),y=n(486);const h=r.a.memo((({data:e,timelineId:t,isDraggable:n})=>r.a.createElement(p.a,{contextId:`netflow-renderer-${t}-${e._id}`,destinationBytes:Object(o.a)(Object(a.get)(b.a,e)),destinationGeoContinentName:Object(o.a)(Object(a.get)(g.b,e)),destinationGeoCountryName:Object(o.a)(Object(a.get)(g.d,e)),destinationGeoCountryIsoCode:Object(o.a)(Object(a.get)(g.c,e)),destinationGeoRegionName:Object(o.a)(Object(a.get)(g.e,e)),destinationGeoCityName:Object(o.a)(Object(a.get)(g.a,e)),destinationIp:Object(o.a)(Object(a.get)(u.a,e)),destinationPackets:Object(o.a)(Object(a.get)(b.b,e)),destinationPort:Object(o.a)(Object(a.get)(f.a,e)),eventDuration:Object(o.a)(Object(a.get)(l.b,e)),eventId:Object(a.get)(c.a,e),eventEnd:Object(o.a)(Object(a.get)(m.b,e)),eventStart:Object(o.a)(Object(a.get)(m.c,e)),isDraggable:n,networkBytes:Object(o.a)(Object(a.get)(y.a,e)),networkCommunityId:Object(o.a)(Object(a.get)(y.b,e)),networkDirection:Object(o.a)(Object(a.get)(y.c,e)),networkPackets:Object(o.a)(Object(a.get)(y.d,e)),networkProtocol:Object(o.a)(Object(a.get)(y.e,e)),sourceBytes:Object(o.a)(Object(a.get)(b.c,e)),sourceGeoContinentName:Object(o.a)(Object(a.get)(g.h,e)),sourceGeoCountryName:Object(o.a)(Object(a.get)(g.j,e)),sourceGeoCountryIsoCode:Object(o.a)(Object(a.get)(g.i,e)),sourceGeoRegionName:Object(o.a)(Object(a.get)(g.k,e)),sourceGeoCityName:Object(o.a)(Object(a.get)(g.g,e)),sourceIp:Object(o.a)(Object(a.get)(u.d,e)),sourcePackets:Object(o.a)(Object(a.get)(b.d,e)),sourcePort:Object(o.a)(Object(a.get)(f.c,e)),tlsClientCertificateFingerprintSha1:Object(o.a)(Object(a.get)(s.b,e)),tlsFingerprintsJa3Hash:Object(o.a)(Object(a.get)(d.a,e)),tlsServerCertificateFingerprintSha1:Object(o.a)(Object(a.get)(s.c,e)),transport:Object(o.a)(Object(a.get)(y.f,e)),userName:void 0})));h.displayName="NetflowRenderer"},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(19),i=n(2),r=n.n(i),o=n(118),s=n(484);const l="closed",c="open",u=(e,t)=>{const{storage:n,title:a}=t;if(n&&a){const t=n.get(s.a.OVERVIEW_TAB_EXPANDED_SECTIONS);n.set(s.a.OVERVIEW_TAB_EXPANDED_SECTIONS,{...t,[a]:e!==c})}return e===l?c:l},d="Header",p="Content",m=({expanded:e,title:t,children:n,gutterSize:s="none",localStorageKey:m,"data-test-subj":f})=>{const g=Object(a.useGeneratedHtmlId)({prefix:"accordion"}),{renderContent:b,state:y,toggle:h}=(e=>{const{storage:t}=Object(o.j)().services,n=e?c:l,[a,r]=Object(i.useReducer)(u,n);return{renderContent:a===c,state:a,toggle:e=>{r({storage:t,title:e})}}})(e),v=f+d,E=f+p,x=r.a.createElement(a.EuiTitle,{size:"xs","data-test-subj":v},r.a.createElement("h4",null,t));return r.a.createElement(a.EuiAccordion,{forceState:y,onToggle:()=>h(m),id:g,buttonContent:x},r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiFlexGroup,{gutterSize:s,direction:"column","data-test-subj":E},b&&n))};m.displayName="ExpandableSection"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){return(e+1)%1e6};t.default=function(){return a.useReducer(i,0)[1]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var a=n(120);const i=a.z.enum(["going to run","running","partial failure","failed","succeeded"]),r=i.enum,o=a.z.number().int()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p}));var a=n(5);const i="histogram-actions-trigger",r={[a.Oc.hosts]:"host",[a.Oc.users]:"user"},o=(e,t)=>{const n=r[e];return n&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${n}.name`,params:{query:t}},query:{match_phrase:{[`${n}.name`]:t}}}]:[]},s=e=>{const t=r[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],c=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],u=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var n,a,i,r,o,s;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(i=a.indexFilter)||void 0===i?void 0:i.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(r=null==t||null===(o=t.response)||void 0===o||null===(s=o.json)||void 0===s?void 0:s.rawResponse)&&void 0!==r?r:{},null,2)]}}),{requests:[],responses:[]}),p=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},function(e,t,n){const a=n(164);e.exports=(e,t,n=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!n)return null;throw e}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.securitySolution="SecuritySolution",e.timeline="Timeline",e}({})},function(e,t,n){"use strict";var a=n(335);e.exports=function(e){return a({},e)}},,,,function(e,t,n){"use strict";n.d(t,"e",(function(){return a.P})),n.d(t,"c",(function(){return a.q})),n.d(t,"a",(function(){return a.c})),n.d(t,"b",(function(){return i.a})),n.d(t,"d",(function(){return i.b})),n.d(t,"f",(function(){return i.g})),n.d(t,"g",(function(){return i.h})),n.d(t,"h",(function(){return r}));var a=n(199),i=n(176);function r(e){var t;return"external"===(null===(t=e.rule_source)||void 0===t?void 0:t.type)&&e.rule_source.is_customized}n(466),n(469),n(470),n(468),n(467)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(2),i=n(45),r=n(395),o=n.n(r),s=n(83),l=n(118),c=n(166),u=n(127),d=n(511),p=n(512),m=n(123);const f=o()(((e,t)=>{if(null==t)return{browserFields:{}};{const e={};for(const[n,a]of Object.entries(t)){const t=Object(s.getCategory)(n);null==e[t]&&(e[t]={fields:{}});const i=e[t].fields;i&&(i[n]=a)}return{browserFields:e}}}),((e,t)=>{var n,a;return e[0]===t[0]&&(null===(n=e[1])||void 0===n?void 0:n.length)===(null===(a=t[1])||void 0===a?void 0:a.length)})),g=()=>{const{data:e}=Object(l.j)().services,t=Object(a.useRef)({}),n=Object(a.useRef)({}),r=Object(i.useDispatch)(),{addError:o}=Object(m.a)(),s=Object(a.useCallback)((({id:e,loading:t})=>{r(c.a.setDataViewLoading({id:e,loading:t}))}),[r]);return{indexFieldsSearch:Object(a.useCallback)((({dataViewId:a,scopeId:i=u.SourcererScopeName.default,needToBeInit:l=!1,cleanCache:m=!1,skipScopeUpdate:f=!1})=>(n.current[a]&&n.current[a].unsubscribe(),t.current[a]&&t.current[a].abort(),(async()=>{try{t.current={...t.current,[a]:new AbortController},s({id:a,loading:!0});const n=await Object(d.a)(a,e.dataViews,m);l&&i&&!f&&r(c.a.setSelectedDataView({id:i,selectedDataViewId:a,selectedPatterns:n.patternList})),r(c.a.setDataView({...n,loading:!1}))}catch(e){o(null==e?void 0:e.message,{title:p.a})}})())),[s,e.dataViews,r,o])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(2),i=n.n(a),r=n(8),o=n.n(r),s=n(3),l=n(48),c=n(794),u=n(131),d=n(118),p=n(170);const m={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{},hidden:!1,setAllTourStepsHidden:()=>{}},f=Object(a.createContext)(m),g=({children:e})=>{var t,n,r,l;const{guidedOnboarding:u}=Object(d.j)().services,[m,g]=Object(a.useState)(!1),b=Object(a.useCallback)((e=>{g(e)}),[]),y=o()(null!==(t=null==u||null===(n=u.guidedOnboardingApi)||void 0===n?void 0:n.isGuideStepActive$(c.a,p.b.rules).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==t?t:Object(s.of)(!1),!1),h=o()(null!==(r=null==u||null===(l=u.guidedOnboardingApi)||void 0===l?void 0:l.isGuideStepActive$(c.a,p.b.alertsCases).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==r?r:Object(s.of)(!1),!1),v=Object(a.useMemo)((()=>({[p.b.rules]:{active:y,hidden:!1},[p.b.alertsCases]:{active:h,hidden:!1}})),[y,h]),E=Object(a.useCallback)((e=>v[e].active),[v]),[x,j]=Object(a.useState)(1),S=Object(a.useCallback)((e=>{j((t=>(t>=p.g[e].length?0:t)+1))}),[]),O=Object(a.useCallback)(((e,t)=>{t<=p.g[e].length&&j(t)}),[]),[k,w]=Object(a.useState)(null);Object(a.useEffect)((()=>{if(!k||null==u||!u.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==u||null===(t=u.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(c.a,k)),e||(w(null),j(1))})(),()=>{e=!0}}),[k,u]);const T=Object(a.useCallback)((e=>{w(e)}),[]),I=Object(a.useMemo)((()=>({hidden:m,setAllTourStepsHidden:b,activeStep:x,endTourStep:T,incrementStep:S,isTourShown:E,setStep:O})),[x,T,m,S,E,b,O]);return i.a.createElement(f.Provider,{value:I},e)},b=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),n=Object(a.useMemo)((()=>Object(u.isTourPath)(t)?g:f.Provider),[t]);return i.a.createElement(n,{value:m},e)},y=()=>{const e=Object(a.useContext)(f);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u}));var a=n(4);const i=Object.freeze({hasExpired:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hasExpired",{defaultMessage:"{command} failed: action expired",values:{command:e}}),wasSuccessful:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.wasSuccessful",{defaultMessage:"{command} completed successfully",values:{command:e}}),submittedSuccessfully:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.submittedSuccessfully",{defaultMessage:"{command} submitted successfully",values:{command:e}}),isPending:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.isPending",{defaultMessage:"{command} is pending",values:{command:e}}),hasFailed:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hasFailed",{defaultMessage:"{command} failed",values:{command:e}}),expandSection:{placedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.placedAt",{defaultMessage:"Command placed"}),input:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.input",{defaultMessage:"Input"}),output:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.output",{defaultMessage:"Output"}),startedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.startedAt",{defaultMessage:"Execution started on"}),parameters:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.parameters",{defaultMessage:"Parameters"}),completedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.completedAt",{defaultMessage:"Execution completed"}),comment:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.comment",{defaultMessage:"Comment"}),hostname:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.hostname",{defaultMessage:"Hostname"}),agentType:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.agentType",{defaultMessage:"Agent type"})}}),r=Object.freeze({time:a.i18n.translate("xpack.securitySolution.responseActionsList.list.time",{defaultMessage:"Time"}),command:a.i18n.translate("xpack.securitySolution.responseActionsList.list.command",{defaultMessage:"Command"}),user:a.i18n.translate("xpack.securitySolution.responseActionsList.list.user",{defaultMessage:"User"}),hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.hosts",{defaultMessage:"Hosts"}),comments:a.i18n.translate("xpack.securitySolution.responseActionsList.list.comments",{defaultMessage:"Comments"}),status:a.i18n.translate("xpack.securitySolution.responseActionsList.list.status",{defaultMessage:"Status"}),rule:a.i18n.translate("xpack.securitySolution.responseActionsList.list.rule",{defaultMessage:"Rule"})}),o=Object.freeze({flyoutTitle:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.flyout.title",{defaultMessage:"Response actions history : {hostname}",values:{hostname:e}}),pageSubTitle:a.i18n.translate("xpack.securitySolution.responseActionsList.list.pageSubTitle",{defaultMessage:"View the history of response actions performed on hosts."}),fetchError:a.i18n.translate("xpack.securitySolution.responseActionsList.list.errorMessage",{defaultMessage:"Error while retrieving response actions"}),filterClearAll:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.clearAll",{defaultMessage:"Clear all"}),filterSearchPlaceholder:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.searchPlaceholder",{defaultMessage:"Search {filterName}",values:{filterName:e}}),filterEmptyMessage:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.emptyMessage",{defaultMessage:"No {filterName} available",values:{filterName:e}}),badge:{successful:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.successful",{defaultMessage:"Successful"}),failed:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.failed",{defaultMessage:"Failed"}),pending:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.pending",{defaultMessage:"Pending"})},unenrolled:{hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hosts.unenrolled.hosts",{defaultMessage:"Hosts unenrolled"}),host:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hosts.unenrolled.host",{defaultMessage:"Host unenrolled"})},screenReaderExpand:a.i18n.translate("xpack.securitySolution.responseActionsList.list.screenReader.expand",{defaultMessage:"Expand rows"}),recordsLabel:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.recordRangeLabel",{defaultMessage:"{records, plural, one {response action} other {response actions}}",values:{records:e}}),triggeredByRule:a.i18n.translate("xpack.securitySolution.responseActionsList.list.rule.triggeredByRule",{defaultMessage:"Triggered by rule"})}),s=Object.freeze({actions:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.actions",{defaultMessage:"Actions"}),actionTypes:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.actionTypes",{defaultMessage:"Action types"}),agentTypes:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.agentTypes",{defaultMessage:"Agent types"}),hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.Hosts",{defaultMessage:"Hosts"}),statuses:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.statuses",{defaultMessage:"Statuses"}),users:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.users",{defaultMessage:"Filter by username"}),types:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.types",{defaultMessage:"{countOfTypes, plural, one {Type} other {Types}}",values:{countOfTypes:e}})}),l=Object.freeze({collapse:a.i18n.translate("xpack.securitySolution.responseActionsList.list.expandButton.collapse",{defaultMessage:"Collapse"}),expand:a.i18n.translate("xpack.securitySolution.responseActionsList.list.expandButton.expand",{defaultMessage:"Expand"})}),c=a.i18n.translate("xpack.securitySolution.responseActionExecuteDownloadLink.downloadButtonLabel",{defaultMessage:"Click here to download full output"}),u=Object.freeze({manual:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.manual",{defaultMessage:"Triggered manually"}),automated:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.automated",{defaultMessage:"Triggered by rule"})})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(44),o=n(49),s=n(1378);const{euiColorVis0:l,euiColorVis5:c,euiColorVis7:u,euiColorVis9:d}=o.euiLightVars,p={low:l,medium:c,high:u,critical:d},m=({value:e,"data-test-subj":t="severity"})=>{var n;const a=Object(r.upperFirst)(e),o=null!==(n=p[e])&&void 0!==n?n:"subdued";return i.a.createElement(s.a,{healthColor:o,tooltipContent:a,dataTestSubj:t},a)},f=i.a.memo(m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(44),i=n(19),r=n(2),o=n.n(r),s=n(134),l=n(41),c=n.n(l),u=n(149);const d="destination.ip",p="destination.port",m="event.category",f="file.name",g="host.name",b="kibana.alert.rule.name",y="kibana.alert.severity",h="process.parent.name",v="process.name",E="source.ip",x="source.port",j="user.name",S=[d,p,f,v,h,E,x],O=c()(i.EuiFlexGroup).withConfig({displayName:"AlertFieldFlexGroup",componentId:"sc-1itxfus-0"})(["flex-grow:0;gap:","px;"],(({$scopeId:e})=>e===u.f.active?0:3)),k=({contextId:e,eventId:t,field:n,fieldType:a="keyword",isAggregatable:r=!0,isDraggable:l,showSeparator:c,scopeId:u,value:d})=>o.a.createElement(O,{alignItems:"center","data-test-subj":"alertFieldBadge",$scopeId:u,gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(s.c,{contextId:`${e}-alert-field`,eventId:t,field:n,fieldType:a,isAggregatable:r,isDraggable:l,scopeId:u,value:d})),c&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"separator"},", ")));k.displayName="AlertFieldBadgeComponent";const w=o.a.memo(k),T=({contextId:e,"data-test-subj":t="alertField",eventId:n,field:a,fieldType:r="keyword",isAggregatable:s=!0,isDraggable:l,prefix:c,suffix:u,scopeId:d,values:p})=>null!=p?o.a.createElement(O,{alignItems:"center","data-test-subj":t,$scopeId:d,gutterSize:"none"},null!=c&&o.a.createElement(i.EuiFlexItem,{"data-test-subj":"prefix",grow:!1},c),p.map(((t,c)=>o.a.createElement(i.EuiFlexItem,{key:`${t}-${c}`,grow:!1},o.a.createElement(w,{contextId:`${e}-alert-field`,eventId:n,field:a,fieldType:r,isAggregatable:s,isDraggable:l,showSeparator:c<p.length-1,scopeId:d,value:t})))),null!=u&&o.a.createElement(i.EuiFlexItem,{"data-test-subj":"suffix",grow:!1},u)):null;T.displayName="AlertFieldComponent";const I=o.a.memo(T);var M=n(121),C=n(150),_=n(315),D=n(4);const A=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.alertLabel",{defaultMessage:"alert"}),F=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.byLabel",{defaultMessage:"by"}),N=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.createdLabel",{defaultMessage:"created"}),P=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.destinationLabel",{defaultMessage:"destination"}),R=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.eventLabel",{defaultMessage:"event"}),L=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.fileLabel",{defaultMessage:"file"}),z=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.onLabel",{defaultMessage:"on"}),q=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.parentProcessLabel",{defaultMessage:"parent process"}),B=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.processLabel",{defaultMessage:"process"}),$=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.sourceLabel",{defaultMessage:"source"}),V=D.i18n.translate("xpack.securitySolution.renderers.alertRenderer.withLabel",{defaultMessage:"with"}),U={id:M.e.alert,isInstance:e=>{return null!==(n=null==(t=Object(a.get)("event.kind",e))?void 0:t.some((e=>null!=e.toLocaleLowerCase&&"signal"===e.toLowerCase())))&&void 0!==n&&n;var t,n},renderRow:({contextId:e="alert-renderer",data:t,isDraggable:n,scopeId:r})=>{const s=Object(a.get)("_id",t),l=Object(a.get)(d,t),c=Object(a.get)(p,t),u=Object(a.get)(m,t),O=Object(a.get)(f,t),k=Object(a.get)(g,t),w=Object(a.get)(b,t),T=Object(a.get)(y,t),M=Object(a.get)(v,t),D=Object(a.get)(h,t),U=Object(a.get)(E,t),G=Object(a.get)(x,t),H=Object(a.get)(j,t);return o.a.createElement(_.a,null,o.a.createElement(C.b,{"data-test-subj":"alertRenderer"},o.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"center",wrap:!0},o.a.createElement(I,{contextId:e,"data-test-subj":m,eventId:s,field:m,isDraggable:n,scopeId:r,values:u}),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"event"},` ${R} `)),(({data:e,fieldNames:t})=>t.some((t=>Object(a.has)(t,e))))({data:t,fieldNames:S})&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"with"},` ${V} `)),o.a.createElement(I,{contextId:e,"data-test-subj":v,eventId:s,field:v,isDraggable:n,prefix:` ${B} `,suffix:", ",scopeId:r,values:M}),o.a.createElement(I,{contextId:e,"data-test-subj":h,eventId:s,field:h,isDraggable:n,prefix:` ${q} `,suffix:", ",scopeId:r,values:D}),o.a.createElement(I,{contextId:e,"data-test-subj":f,eventId:s,field:f,isDraggable:n,prefix:` ${L} `,suffix:", ",scopeId:r,values:O}),o.a.createElement(I,{contextId:e,"data-test-subj":E,eventId:s,field:E,isDraggable:n,prefix:` ${$} `,scopeId:r,values:U}),o.a.createElement(I,{contextId:e,"data-test-subj":x,eventId:s,field:x,isDraggable:n,prefix:":",suffix:", ",scopeId:r,values:G}),o.a.createElement(I,{contextId:e,"data-test-subj":d,eventId:s,field:d,isDraggable:n,prefix:` ${P} `,scopeId:r,values:l}),o.a.createElement(I,{contextId:e,"data-test-subj":p,eventId:s,field:p,isDraggable:n,prefix:":",suffix:", ",scopeId:r,values:c}),o.a.createElement(I,{contextId:e,"data-test-subj":j,eventId:s,field:j,isDraggable:n,prefix:` ${F} `,scopeId:r,values:H}),o.a.createElement(I,{contextId:e,"data-test-subj":g,eventId:s,field:g,isDraggable:n,prefix:` ${z} `,scopeId:r,values:k}),o.a.createElement(I,{contextId:e,"data-test-subj":y,eventId:s,field:y,isDraggable:n,prefix:` ${N} `,suffix:` ${A} `,scopeId:r,values:T}),o.a.createElement(I,{contextId:e,"data-test-subj":b,eventId:s,field:b,isDraggable:n,suffix:".",scopeId:r,values:w}))))}},G=({data:e,rowRenderers:t})=>{var n;const a=null!==(n=t.find((t=>t.isInstance(e))))&&void 0!==n?n:null;return U.isInstance(e)?null!=a?(({a:e,b:t,id:n})=>({id:n,isInstance:n=>e.isInstance(n)||t.isInstance(n),renderRow:({contextId:n,data:a,isDraggable:i,scopeId:r})=>o.a.createElement(o.a.Fragment,null,e.isInstance(a)&&e.renderRow({contextId:n,data:a,isDraggable:i,scopeId:r}),t.isInstance(a)&&t.renderRow({contextId:n,data:a,isDraggable:i,scopeId:r}))}))({a:U,b:a,id:a.id}):U:a}},function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return j.a}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(44),l=n(19),c=n(476),u=n.n(c),d=n(42),p=n(696);const m=({disableLinks:e,href:t,target:n,children:a,...i})=>o.a.createElement(l.EuiToolTip,{content:t},o.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),f=Object(r.memo)(m);var g=n(118),b=n(16),y=n(4);const h=y.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),v=y.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),E=({children:e,disableLinks:t,textSize:n="m"})=>{const a=Object(r.useMemo)((()=>e=>o.a.createElement(f,i()({},e,{disableLinks:t}))),[t]),c=Object(s.cloneDeep)(p.c);c[1][1].components.a=a;const m=Object(b.b)().isAtLeast("platinum"),{application:y}=Object(g.j)().services,E=Object(r.useMemo)((()=>{if(!1===m){const t=String(e);return p.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,m]),x=Object(r.useMemo)((()=>u()().use(p.a).use(c)),[c]),j=Object(r.useMemo)((()=>{try{return x.processSync(e),null}catch(e){return String(e.message)}}),[e,x]);return o.a.createElement(o.a.Fragment,null,E&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiCallOut,{title:h,color:"primary",iconType:"lock"},o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:o.a.createElement(l.EuiLink,{href:y.getUrlForApp("management",{path:"stack/license_management/home"})},o.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),o.a.createElement(l.EuiSpacer,{size:"s"})),null!==j&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiCallOut,{title:v,color:"danger",iconType:"error"},j),o.a.createElement(l.EuiSpacer,{size:"s"})),o.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:p.a,processingPluginList:c,textSize:n},e))};E.displayName="MarkdownRendererComponent";const x=Object(r.memo)(E);var j=n(481);n(581)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const i={},r=n.n(a).a.createContext(i)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g}));var a=n(128),i=n(44),r=n(2),o=n(229),s=n(1349),l=n(520),c=n(706),u=n(382),d=n(195),p=n(149);const m=(e,t,n,i=p.e,r=!1)=>({and:[],enabled:!0,id:Object(a.i)(t),name:e,excluded:r,kqlQuery:"",queryMatch:{field:e,value:n,operator:i,displayValue:Object(c.d)(n)}}),f=(e,t,n,a=p.e,i=!1)=>{const{and:r,...o}=m(e,t,n,a,i);return o},g=({contextId:e,eventId:t,field:n,fieldFormat:a,fieldFromBrowserField:c,fieldType:p,isObjectArray:f,linkValue:g,values:b})=>Object(r.useMemo)((()=>{if(null==b)return null;const r=Array.isArray(b)?b:[b];let y=[];return r.length>1&&(y=[{meta:{},query:{bool:{must:r.map((e=>({term:{[n]:e}})))}}}]),r.reduce(((r,y,h)=>{let v="",E=Object(i.isString)(y)?y:`${b}`;const x=`${e}-${t}-${n}-${h}-${y}`;if(null==c)return r.values.push(E),r;if(f||p===o.f||[o.i].includes(n))return r.values.push(E),r;if(p===o.h){if(v=`formatted-ip-data-provider-${e}-${n}-${y}-${t}`,Object(i.isString)(y)&&!Object(i.isEmpty)(y)){let e=y;try{e=JSON.parse(y)}catch(e){}return Object(i.isArray)(e)&&(E=e.join(","),e.forEach((e=>r.dataProviders.push(m(n,v,e))))),r.dataProviders.push(m(n,v,e)),r.values.push(E),r}}else u.b.some((e=>n===e))?v=`port-default-draggable-${x}`:n===l.b?v=`duration-default-draggable-${x}`:n===o.g?v=`event-details-value-default-draggable-${x}`:a===s.a?v=`bytes-default-draggable-${x}`:n===o.n?v=`event-details-value-default-draggable-${x}-${g}`:n===o.c?v=`event-details-value-default-draggable-${x}-${y}`:n===o.o?v=`alert-details-value-default-draggable-${x}`:n===o.a?(v=`event-details-value-default-draggable-${x}`,E="string"==typeof y?y:""):v=[o.m,o.l,o.e,d.j].includes(n)?`event-details-value-default-draggable-${x}-${y}`:`event-details-value-default-draggable-${x}`;return r.values.push(E),r.dataProviders.push(m(n,v,y)),r}),{values:[],dataProviders:[],filters:y})}),[e,t,n,a,c,p,f,g,b])},function(e,t,n){"use strict";n.d(t,"h",(function(){return E})),n.d(t,"g",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"f",(function(){return w})),n.d(t,"c",(function(){return M})),n.d(t,"i",(function(){return D})),n.d(t,"d",(function(){return q})),n.d(t,"e",(function(){return B})),n.d(t,"a",(function(){return $}));var a=n(63),i=n.n(a),r=n(54),o=n.n(r),s=n(395),l=n.n(s),c=(n(48),n(41)),u=n.n(c),d=n(19),p=n(168),m=n(1560),f=n(165),g=n(227),b=n(731),y=n(248),h=n(1228),v=n(20);const E=({rule:e,detailsView:t=!1})=>{const n=S(e);return{aboutRuleData:T(e,t),modifiedAboutRuleDetailsData:_(e),defineRuleData:n,scheduleRuleData:k(e),ruleActionsData:x(e)}},x=e=>{const{enabled:t,meta:n,actions:a=[],response_actions:i}=e;return{actions:null==a?void 0:a.map((e=>Object(b.d)(e))),responseActions:null==i?void 0:i.map(b.e),kibanaSiemAppUrl:"string"==typeof(null==n?void 0:n.kibana_siem_app_url)?n.kibana_siem_app_url:void 0,enabled:t}},j=e=>{if("machine_learning"===e.type)return"string"==typeof e.machine_learning_job_id?[e.machine_learning_job_id]:e.machine_learning_job_id},S=e=>{var t,n,a,i,r,o,s,l,c,u,d;return{ruleType:e.type,anomalyThreshold:"anomaly_threshold"in e?e.anomaly_threshold:50,machineLearningJobId:j(e)||[],index:"index"in e&&e.index||[],dataViewId:"data_view_id"in e?e.data_view_id:void 0,threatIndex:"threat_index"in e&&e.threat_index||[],threatQueryBar:{query:{query:"threat_query"in e&&e.threat_query||"",language:"threat_language"in e&&e.threat_language||""},filters:"threat_filters"in e&&e.threat_filters||[],saved_id:null},threatMapping:"threat_mapping"in e&&e.threat_mapping||[],queryBar:{query:{query:"query"in e&&e.query||"",language:"language"in e&&e.language||""},filters:"filters"in e&&e.filters||[],saved_id:"saved_id"in e&&e.saved_id||null},relatedIntegrations:null!==(t=e.related_integrations)&&void 0!==t?t:[],requiredFields:null!==(n=e.required_fields)&&void 0!==n?n:[],timeline:{id:null!==(a=e.timeline_id)&&void 0!==a?a:null,title:null!==(i=e.timeline_title)&&void 0!==i?i:null},threshold:{field:Object(f.p)("threshold"in e?null===(r=e.threshold)||void 0===r?void 0:r.field:void 0),value:`${"threshold"in e&&(null===(o=e.threshold)||void 0===o?void 0:o.value)||100}`,..."threshold"in e&&null!==(s=e.threshold)&&void 0!==s&&null!==(l=s.cardinality)&&void 0!==l&&l.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:"timestamp_field"in e?e.timestamp_field:void 0,eventCategoryField:"event_category_override"in e?e.event_category_override:void 0,tiebreakerField:"tiebreaker_field"in e?e.tiebreaker_field:void 0},dataSourceType:"data_view_id"in e&&e.data_view_id?y.a.DataView:y.a.IndexPatterns,newTermsFields:"new_terms_fields"in e&&e.new_terms_fields||[],historyWindowSize:"history_window_start"in e&&e.history_window_start?O(e.history_window_start):"7d",shouldLoadQueryDynamically:Boolean("saved_query"===e.type&&e.saved_id),groupByFields:"alert_suppression"in e&&e.alert_suppression&&"group_by"in e.alert_suppression&&e.alert_suppression.group_by||[],groupByRadioSelection:"alert_suppression"in e&&null!==(c=e.alert_suppression)&&void 0!==c&&c.duration?y.b.PerTimePeriod:y.b.PerRuleExecution,groupByDuration:"alert_suppression"in e&&(null===(u=e.alert_suppression)||void 0===u?void 0:u.duration)||{value:5,unit:"m"},suppressionMissingFields:"alert_suppression"in e&&e.alert_suppression&&"missing_fields_strategy"in e.alert_suppression&&e.alert_suppression.missing_fields_strategy||v.a,enableThresholdSuppression:Boolean("alert_suppression"in e&&(null===(d=e.alert_suppression)||void 0===d?void 0:d.duration))}},O=e=>e.startsWith("now-")?e.substring(4):e,k=e=>{const{interval:t,from:n}=e;return{interval:t,from:w(n,t)}},w=(e,t)=>{var n,a;const r=null!==(n=i.a.parse(e))&&void 0!==n?n:o()(),s=null!==(a=i.a.parse(`now-${t}`))&&void 0!==a?a:o()(),l=o.a.duration(s.diff(r)),c=Math.floor(l.asSeconds());return 0===c?"0s":c%3600==0?c/3600+"h":c%60==0?c/60+"m":`${c}s`},T=(e,t)=>{var n,a;const{name:i,description:r,note:o,setup:s}=C(e,t),{author:l,building_block_type:c,exceptions_list:u,license:d,risk_score_mapping:f,rule_name_override:g,severity_mapping:b,timestamp_override:y,timestamp_override_fallback_disabled:h,references:v,severity:E,false_positives:x,risk_score:j,investigation_fields:S,tags:O,threat:k,max_signals:w}=e,T="threat_indicator_path"in e?e.threat_indicator_path:void 0;return{author:l,isAssociatedToEndpointList:null!==(n=null==u?void 0:u.some((({id:e})=>e===p.k)))&&void 0!==n&&n,isBuildingBlock:void 0!==c,license:null!=d?d:"",ruleNameOverride:null!=g?g:"",timestampOverride:null!=y?y:"",timestampOverrideFallbackDisabled:h,name:i,description:r,note:o,references:v,severity:{value:E,mapping:M(b),isMappingChecked:b.length>0},tags:O,riskScore:{value:j,mapping:Object(m.a)(f),isMappingChecked:f.length>0},falsePositives:x,investigationFields:null!==(a=null==S?void 0:S.field_names)&&void 0!==a?a:[],threat:k,threatIndicatorPath:T,maxSignals:w,setup:s}},I={low:0,medium:1,high:2,critical:3},M=e=>{const t=h.b.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>I[e.severity]-I[t.severity]))},C=(e,t)=>{const{name:n,description:a,note:i,setup:r}=e;return t?{name:"",description:"",note:"",setup:""}:{name:n,description:a,setup:r,note:null!=i?i:""}},_=e=>{var t,n;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(n=e.setup)&&void 0!==n?n:""}},D=(e,t,n,a)=>!1===e||!1===t||!1===n||a,A=["id","name","description","false_positives","investigation_fields","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"],F=["index","filters","language","query","saved_id","response_actions"],N=["filters","language","query","response_actions"],P=["anomaly_threshold","machine_learning_job_id"],R=["threshold",...F],L=e=>{switch(e){case"machine_learning":return P;case"threshold":return R;case"esql":return N;case"new_terms":case"threat_match":case"query":case"saved_query":case"eql":return F}Object(g.a)(e)},z=e=>({state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...e.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}),q=l()((e=>{if(!e)return{state:[],params:[]};const t=(e=>[...A,...L(e)].sort())(e);return z(t)})),B=()=>z((()=>{const e=[...A,...F,...P,...R].sort();return Array.from(new Set(e))})()),$=u()(d.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-15hicli-0"})(["max-width:1000px;overflow:hidden;"])},function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return R}));var a=n(626),i=n(2),r=n.n(i),o=n(363),s=n(222),l=n(130),c=n(179),u=n(416),d=n(1394);const p={isInstance:(e,t)=>((e,t)=>-1===t.findIndex((t=>t.field===e)))(e,t),renderColumn:({columnName:e,eventId:t,field:n,isDraggable:a=!0,scopeId:i,truncate:p})=>a?r.a.createElement(o.b,{dataProvider:{enabled:!0,id:Object(s.h)(`empty-column-renderer-draggable-wrapper-${i}-${e}-${t}-${n.id}`),name:`${e}: ${Object(d.a)(null)}`,queryMatch:{field:n.id,value:Object(d.a)(null),displayValue:Object(l.e)(),operator:c.b},excluded:!0,kqlQuery:"",and:[]},isDraggable:a,key:`empty-column-renderer-draggable-wrapper-${i}-${e}-${t}-${n.id}`,render:(e,t,n)=>n.isDragging?r.a.createElement(o.a,null,r.a.createElement(u.a,{dataProvider:e})):r.a.createElement("span",null,Object(l.e)()),truncate:p,scopeId:i}):r.a.createElement("span",null,Object(l.e)())};var m=n(837),f=n(44),g=n(422);const b={isInstance:(e,t)=>((e,t)=>-1!==t.findIndex((t=>t.field===e)))(e,t),renderColumn:({asPlainText:e,columnName:t,eventId:n,field:a,isDraggable:i=!0,scopeId:o,truncate:s,values:c,linkValues:u})=>{return Array.isArray(c)&&0!==c.length?i?c.map(((l,c)=>{var d,p,m;return r.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:n,fieldFormat:null!==(d=a.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=a.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=a.type)&&void 0!==m?m:"",isDraggable:i,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${n}-${a.id}-${l}-${c}`,linkValue:Object(f.head)(u),truncate:s,value:l})})):r.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:n,fieldFormat:null!==(d=a.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=a.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=a.type)&&void 0!==m?m:"",isDraggable:i,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${n}-${a.id}`,linkValue:Object(f.head)(u),truncate:s,value:y(c)}):Object(l.d)();var d,p,m}};function y(e){return Array.isArray(e)?e.length>0?e.join(", "):e[0]:e}var h=n(863);const v={isInstance:()=>!0,renderColumn:()=>Object(l.d)()};var E=n(865),x=n(231),j=n(861),S=n(19),O=n(1630),k=n(229),w=n(299);const T={isInstance:Object(f.isEqual)(k.k),renderColumn:({columnName:e,ecsData:t,eventId:n,field:a,isDetails:i,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d})=>i&&d&&t&&l?d.map(((i,o)=>r.a.createElement(I,{ecsData:t,key:`reason-column-renderer-value-${c}-${e}-${n}-${a.id}-${i}-${o}`,rowRenderers:l,scopeId:c,value:i}))):b.renderColumn({columnName:e,eventId:n,field:a,isDetails:i,isDraggable:o,linkValues:s,scopeId:c,truncate:u,values:d})},I=({ecsData:e,rowRenderers:t,scopeId:n,value:a})=>{const o=Object(i.useMemo)((()=>Object(w.a)({data:e,rowRenderers:t})),[e,t]),s=Object(i.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:n})),[o,e,n]),l=Object(i.useMemo)((()=>n===O.b.rulePreview),[n]);return r.a.createElement(r.a.Fragment,null,o&&s&&!l?r.a.createElement(S.EuiPanel,{color:"subdued",className:"eui-xScroll","data-test-subj":"reason-cell-renderer"},r.a.createElement(S.EuiText,{size:"xs"},r.a.createElement("div",{className:"eui-displayInlineBlock"},s))):a)};var M=n(41);const C=n.n(M)()(S.EuiFlexItem).withConfig({displayName:"EventRenderedFlexItem",componentId:"sc-1jiiiew-0"})(["div:first-child{padding-left:0px;div{margin:0px;}}"]),_={isInstance:Object(f.isEqual)(k.d),renderColumn:({ecsData:e,columnName:t,eventId:n,field:a,isDetails:i,linkValues:o,rowRenderers:s=[],scopeId:l,truncate:c,values:u})=>e&&s?r.a.createElement(D,{ecsData:e,key:`reason-column-renderer-value-${l}-${t}-${n}-${a.id}`,rowRenderers:s,scopeId:l,values:u}):b.renderColumn({columnName:t,eventId:n,field:a,isDetails:i,isDraggable:!1,linkValues:o,scopeId:l,truncate:c,values:u})},D=({ecsData:e,rowRenderers:t,scopeId:n,values:a})=>{const o=Object(i.useMemo)((()=>Object(w.a)({data:e,rowRenderers:t})),[e,t]),s=Object(i.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:n})),[o,e,n]);return r.a.createElement(S.EuiFlexGroup,{gutterSize:"none",direction:"column",className:"eui-fullWidth"},o&&s?r.a.createElement(C,{className:"eui-xScroll"},r.a.createElement("div",{className:"eui-displayInlineBlock",style:{width:"fit-content"}},s)):a&&r.a.createElement(S.EuiFlexItem,{"data-test-subj":"plain-text-reason"},a))};var A=n(966),F=n(1226);const N={isInstance:(e,t,n)=>F.a.includes(e)&&!!n,renderColumn:({columnName:e,ecsData:t,eventId:n,field:a,isDetails:i,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d,context:p})=>{var m;if(null!=p&&p.isLoading)return r.a.createElement(S.EuiLoadingSpinner,{size:"s"});const f=null!==(m=null==d?void 0:d.map((e=>{var t;return null==p||null===(t=p.profiles)||void 0===t?void 0:t.find((t=>e===t.uid))})))&&void 0!==m?m:[];return r.a.createElement(A.a,{userProfiles:f,maxVisibleAvatars:4})}},P=[j.a,...a.a,...x.k,h.a,E.a,m.a],R=[T,_,N,b,p,v]},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(42),c=n(41),u=n.n(c),d=n(124),p=n(149),m=n(158),f=n(129),g=n(295),b=n(170),y=n(48),h=n(118),v=n(198),E=n(213);const x=(e,t)=>(t===b.a.createCase||t===b.a.submitCase)&&e===b.b.alertsCases,j=u()(s.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>x(t,e)?"9000 !important":"1000 !important")),S=o.a.memo((({children:e,onClick:t,step:n,tourId:a})=>{const{activeStep:c,incrementStep:u,isTourShown:y}=Object(g.b)(),h=Object(r.useMemo)((()=>b.g[a].find((e=>e.step===n))),[n,a]),v=Object(r.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),E=Object(d.b)((e=>{var t;return(null!==(t=v(e,p.f.active))&&void 0!==t?t:m.b).show})),S=Object(r.useCallback)((()=>t?t():u(a)),[u,t,a]),O=Object(r.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),k=x(a,n);if(null==h||(n!==c||!y(a))&&!k||E)return e||null;const{anchor:w,content:T,imageConfig:I,dataTestSubj:M,hideNextButton:C=!1,..._}=h,D=C?o.a.createElement(o.a.Fragment,null):o.a.createElement(s.EuiButtonEmpty,{onClick:S,onKeyDown:O,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),A={..._,content:o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,T)),I&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiImage,{alt:I.altText,src:I.src,size:"fullWidth"}))),footerAction:D,isStepOpen:!0,onFinish:()=>null,stepsTotal:b.g[a].length,panelProps:{"data-test-subj":M}};return null!=w?o.a.createElement(o.a.Fragment,null,o.a.createElement(j,i()({tourId:a},A,{anchor:w})),o.a.createElement(o.a.Fragment,null,e)):null!=e?o.a.createElement(j,i()({tourId:a},A),e):null}));S.displayName="SecurityTourStep";const O=o.a.memo((({children:e,isTourAnchor:t=!0,...n})=>t?o.a.createElement(k,n,e):o.a.createElement(o.a.Fragment,null,e)));O.displayName="GuidedOnboardingTourStep";const k=o.a.memo((({children:e,...t})=>{const{hidden:n}=Object(g.b)(),a=(({tourId:e,step:t})=>{const{useIsAddToCaseOpen:n}=Object(h.j)().services.cases.hooks,a=n(),{search:i}=Object(y.useLocation)(),o=Object(r.useMemo)((()=>Object(E.c)(v.a.flyout,i)),[i]),s=null==o?void 0:o.left,l=Object(r.useMemo)((()=>{var e;return s&&(null===(e=b.e[b.b.alertsCases])||void 0===e?void 0:e.includes(t))}),[s,t]),c=Object(r.useMemo)((()=>{var n;return a&&(null===(n=b.d[e])||void 0===n?void 0:n.includes(t))}),[a,e,t]);return l||c})({tourId:t.tourId,step:t.step});return n||a?o.a.createElement(o.a.Fragment,null,e):o.a.createElement(S,t,e)}));k.displayName="SecurityTourStepAnchor"},,,,,,function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=n(348),o=n(347),s=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.t={};let d=0;const p="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",r],[p,i]],f=(e,t,n)=>{const a=(e=>{for(const[t,n]of m)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;o(e,i,t),u[e]=i,c[i]=t,s[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(a,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),f("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${c[u.NUMERICIDENTIFIER]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NUMERICIDENTIFIERLOOSE]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${p}+`),f("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`),f("FULL",`^${c[u.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`),f("LOOSE",`^${c[u.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?)?)?`),f("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),f("COERCE",`${c[u.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",c[u.COERCEPLAIN]+`(?:${c[u.PRERELEASE]})?`+`(?:${c[u.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",c[u.COERCE],!0),f("COERCERTLFULL",c[u.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})\\s+-\\s+(${c[u.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[u.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return b}));var a=n(2),i=n.n(a),r=n(19),o=n(41),s=n.n(o),l=n(42),c=n(130);const u=({children:e,...t})=>i.a.createElement(r.EuiButton,t,e),d=({children:e,...t})=>i.a.createElement(r.EuiLink,t,e),p=s()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);p.displayName="Comma";const m=({children:e,Component:t,dataTestSubj:n,href:a,onClick:r,title:o,iconType:s="expand"})=>t?i.a.createElement(t,{"data-test-subj":n,href:a,iconType:s,onClick:r,title:o},null!=o?o:e):i.a.createElement(u,{"data-test-subj":n,href:a,onClick:r},null!=o?o:e),f=i.a.memo(m),g=s.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),b=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:o})=>{const[s,c]=Object(a.useState)(!1),u=Object(a.useCallback)((()=>c((e=>!e))),[]),d=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null," ,",i.a.createElement(r.EuiButtonEmpty,{size:"xs",onClick:u},`+${o.length-t} `,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[u,t,o.length]);return i.a.createElement(r.EuiFlexItem,{grow:!1},o.length>t&&i.a.createElement(r.EuiPopover,{id:"popover",button:d,isOpen:s,closePopover:u,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},i.a.createElement(y,{render:n,rowItems:o,moreMaxHeight:e,overflowIndexStart:t})))}));b.displayName="ReputationLinksOverflow";const y=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:o})=>{const s=Object(a.useMemo)((()=>o.slice(t).map(((e,t)=>{var a;return i.a.createElement(r.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(c.a)(e))}))),[t,n,o]);return i.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},s))}));y.displayName="MoreReputationLinksContainer"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n.n(a),r=n(180);const o=i.a.memo((({children:e})=>i.a.createElement(r.w,{className:"siemEventsTable__trSupplement--summary"},e)));o.displayName="RowRendererContainer"},function(e,t,n){"use strict";n.d(t,"Vb",(function(){return i})),n.d(t,"oc",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"eb",(function(){return s})),n.d(t,"Yb",(function(){return l})),n.d(t,"db",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"pc",(function(){return d})),n.d(t,"gb",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"T",(function(){return f})),n.d(t,"kc",(function(){return g})),n.d(t,"Db",(function(){return b})),n.d(t,"y",(function(){return y})),n.d(t,"A",(function(){return h})),n.d(t,"z",(function(){return v})),n.d(t,"ob",(function(){return E})),n.d(t,"gc",(function(){return x})),n.d(t,"V",(function(){return j})),n.d(t,"Bb",(function(){return S})),n.d(t,"Ob",(function(){return O})),n.d(t,"S",(function(){return k})),n.d(t,"Q",(function(){return w})),n.d(t,"dc",(function(){return T})),n.d(t,"ic",(function(){return I})),n.d(t,"Z",(function(){return M})),n.d(t,"N",(function(){return C})),n.d(t,"mb",(function(){return _})),n.d(t,"t",(function(){return D})),n.d(t,"Hb",(function(){return A})),n.d(t,"Ub",(function(){return F})),n.d(t,"lb",(function(){return N})),n.d(t,"D",(function(){return P})),n.d(t,"M",(function(){return R})),n.d(t,"ub",(function(){return L})),n.d(t,"L",(function(){return z})),n.d(t,"h",(function(){return q})),n.d(t,"Rb",(function(){return B})),n.d(t,"g",(function(){return $})),n.d(t,"u",(function(){return V})),n.d(t,"nb",(function(){return U})),n.d(t,"H",(function(){return G})),n.d(t,"rb",(function(){return H})),n.d(t,"hc",(function(){return W})),n.d(t,"f",(function(){return Q})),n.d(t,"U",(function(){return Y})),n.d(t,"hb",(function(){return K})),n.d(t,"jc",(function(){return J})),n.d(t,"ib",(function(){return Z})),n.d(t,"o",(function(){return X})),n.d(t,"Eb",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"ec",(function(){return ne})),n.d(t,"nc",(function(){return ae})),n.d(t,"lc",(function(){return ie})),n.d(t,"B",(function(){return re})),n.d(t,"P",(function(){return oe})),n.d(t,"v",(function(){return se})),n.d(t,"Jb",(function(){return le})),n.d(t,"Cb",(function(){return ce})),n.d(t,"X",(function(){return ue})),n.d(t,"Y",(function(){return de})),n.d(t,"ac",(function(){return pe})),n.d(t,"d",(function(){return me})),n.d(t,"a",(function(){return fe})),n.d(t,"Lb",(function(){return ge})),n.d(t,"Mb",(function(){return be})),n.d(t,"Wb",(function(){return ye})),n.d(t,"p",(function(){return he})),n.d(t,"Ib",(function(){return ve})),n.d(t,"Pb",(function(){return Ee})),n.d(t,"Qb",(function(){return xe})),n.d(t,"Zb",(function(){return je})),n.d(t,"ab",(function(){return Se})),n.d(t,"bb",(function(){return Oe})),n.d(t,"w",(function(){return ke})),n.d(t,"Kb",(function(){return we})),n.d(t,"q",(function(){return Te})),n.d(t,"C",(function(){return Ie})),n.d(t,"xb",(function(){return Me})),n.d(t,"jb",(function(){return Ce})),n.d(t,"yb",(function(){return _e})),n.d(t,"Fb",(function(){return De})),n.d(t,"E",(function(){return Ae})),n.d(t,"tb",(function(){return Fe})),n.d(t,"J",(function(){return Ne})),n.d(t,"qb",(function(){return Pe})),n.d(t,"K",(function(){return Re})),n.d(t,"j",(function(){return Le})),n.d(t,"zb",(function(){return ze})),n.d(t,"Nb",(function(){return qe})),n.d(t,"mc",(function(){return Be})),n.d(t,"bc",(function(){return $e})),n.d(t,"cc",(function(){return Ve})),n.d(t,"s",(function(){return Ue})),n.d(t,"O",(function(){return Ge})),n.d(t,"Xb",(function(){return He})),n.d(t,"Tb",(function(){return We})),n.d(t,"fc",(function(){return Qe})),n.d(t,"Sb",(function(){return Ye})),n.d(t,"c",(function(){return Ke})),n.d(t,"r",(function(){return Je})),n.d(t,"G",(function(){return Ze})),n.d(t,"Gb",(function(){return Xe})),n.d(t,"fb",(function(){return et})),n.d(t,"sb",(function(){return tt})),n.d(t,"F",(function(){return nt})),n.d(t,"pb",(function(){return at})),n.d(t,"Ab",(function(){return it})),n.d(t,"I",(function(){return rt})),n.d(t,"b",(function(){return ot})),n.d(t,"x",(function(){return st})),n.d(t,"kb",(function(){return lt})),n.d(t,"W",(function(){return ct})),n.d(t,"cb",(function(){return ut})),n.d(t,"R",(function(){return dt})),n.d(t,"k",(function(){return pt})),n.d(t,"vb",(function(){return mt})),n.d(t,"wb",(function(){return ft})),n.d(t,"l",(function(){return gt}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.auditd.sessionDescription",{defaultMessage:"Session"}),r=a.i18n.translate("xpack.securitySolution.auditd.wasAuthorizedToUseDescription",{defaultMessage:"was authorized to use"}),o=a.i18n.translate("xpack.securitySolution.auditd.acquiredCredentialsDescription",{defaultMessage:"acquired credentials to"}),s=a.i18n.translate("xpack.securitySolution.auditd.endedFromDescription",{defaultMessage:"ended from"}),l=a.i18n.translate("xpack.securitySolution.auditd.startedAtDescription",{defaultMessage:"started"}),c=a.i18n.translate("xpack.securitySolution.auditd.disposedCredentialsDescription",{defaultMessage:"disposed credentials to"}),u=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),d=a.i18n.translate("xpack.securitySolution.auditd.withResultDescription",{defaultMessage:"with result"}),p=a.i18n.translate("xpack.securitySolution.auditd.executedDescription",{defaultMessage:"executed"}),m=a.i18n.translate("xpack.securitySolution.auditd.asDescription",{defaultMessage:"as"}),f=a.i18n.translate("xpack.securitySolution.auditd.connectedUsingDescription",{defaultMessage:"connected using"}),g=a.i18n.translate("xpack.securitySolution.auditd.usingDescription",{defaultMessage:"using"}),b=a.i18n.translate("xpack.securitySolution.auditd.OpenedFileDescription",{defaultMessage:"opened file"}),y=a.i18n.translate("xpack.securitySolution.auditd.ChangedFileAttributesOfDescription",{defaultMessage:"changed file attributes of"}),h=a.i18n.translate("xpack.securitySolution.auditd.changedFilePermissionOfDescription",{defaultMessage:"changed file permissions of"}),v=a.i18n.translate("xpack.securitySolution.auditd.changeidleOwernshipOfDescription",{defaultMessage:"changed file ownership of"}),E=a.i18n.translate("xpack.securitySolution.auditd.loaedKernelModuleOfDescription",{defaultMessage:"loaded kernel module of"}),x=a.i18n.translate("xpack.securitySolution.auditd.unloadedKernelModuleOfDescription",{defaultMessage:"unloaded kernel module of"}),j=a.i18n.translate("xpack.securitySolution.auditd.createdDirectoryDescription",{defaultMessage:"created directory"}),S=a.i18n.translate("xpack.securitySolution.auditd.mountedDescription",{defaultMessage:"mounted"}),O=a.i18n.translate("xpack.securitySolution.auditd.renamedDescription",{defaultMessage:"renamed"}),k=a.i18n.translate("xpack.securitySolution.auditd.chedckedMetaDataOfDescription",{defaultMessage:"checked metadata of"}),w=a.i18n.translate("xpack.securitySolution.auditd.checkedFileSystemMetadataOfDescription",{defaultMessage:"checked filesystem metadata of"}),T=a.i18n.translate("xpack.securitySolution.auditd.symLinkedDescription",{defaultMessage:"symbolically linked"}),I=a.i18n.translate("xpack.securitySolution.auditd.unmountedDescription",{defaultMessage:"unmounted"}),M=a.i18n.translate("xpack.securitySolution.auditd.deletedDescription",{defaultMessage:"deleted"}),C=a.i18n.translate("xpack.securitySolution.auditd.changedTimeStampOfDescription",{defaultMessage:"changed time stamp of"}),_=a.i18n.translate("xpack.securitySolution.auditd.ListeningForConnectionsUsingDescription",{defaultMessage:"listening for connections using"}),D=a.i18n.translate("xpack.securitySolution.auditd.boundSocketFromDescription",{defaultMessage:"bound socket from"}),A=a.i18n.translate("xpack.securitySolution.auditd.receivedFromDescription",{defaultMessage:"received from"}),F=a.i18n.translate("xpack.securitySolution.auditd.sentToDescription",{defaultMessage:"sent to"}),N=a.i18n.translate("xpack.securitySolution.auditd.killedProcessIdDescription",{defaultMessage:"killed process id of"}),P=a.i18n.translate("xpack.securitySolution.auditd.changedIdentityUsingDescription",{defaultMessage:"changed identity using"}),R=a.i18n.translate("xpack.securitySolution.auditd.changedSystemTimeWithDescription",{defaultMessage:"changed system time with"}),L=a.i18n.translate("xpack.securitySolution.auditd.madeDeviceWithDescription",{defaultMessage:"made device with"}),z=a.i18n.translate("xpack.securitySolution.auditd.changedSystemNameDescription",{defaultMessage:"changed system name"}),q=a.i18n.translate("xpack.securitySolution.auditd.allocatedMemoryForDescription",{defaultMessage:"allocated memory for"}),B=a.i18n.translate("xpack.securitySolution.auditd.scheduledPolicyOFDescription",{defaultMessage:"scheduled policy of"}),$=a.i18n.translate("xpack.securitySolution.auditd.addedUserAccountDescription",{defaultMessage:"added user account"}),V=a.i18n.translate("xpack.securitySolution.auditd.causedMacPolicyErrorDescription",{defaultMessage:"caused mac policy error"}),U=a.i18n.translate("xpack.securitySolution.auditd.loadedFirewallRuleDescription",{defaultMessage:"loaded firewall rule"}),G=a.i18n.translate("xpack.securitySolution.auditd.promiscuousModeDescription",{defaultMessage:"changed promiscuous mode on the device using"}),H=a.i18n.translate("xpack.securitySolution.auditd.lockedAccountDescription",{defaultMessage:"locked account"}),W=a.i18n.translate("xpack.securitySolution.auditd.unlockedAccountDescription",{defaultMessage:"unlocked account"}),Q=a.i18n.translate("xpack.securitySolution.auditd.adddedGroupAccountUsingDescription",{defaultMessage:"added group account using"}),Y=a.i18n.translate("xpack.securitySolution.auditd.crashedProgramDescription",{defaultMessage:"crashed program"}),K=a.i18n.translate("xpack.securitySolution.auditd.executionOfForbiddenProgramDescription",{defaultMessage:"execution of forbidden program"}),J=a.i18n.translate("xpack.securitySolution.auditd.suspiciousProgramDescription",{defaultMessage:"used suspicious program"}),Z=a.i18n.translate("xpack.securitySolution.auditd.failedLoginTooManyTimesDescription",{defaultMessage:"failed login due to logging in too many times"}),X=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusalPlaceDescription",{defaultMessage:"attempted login from unusual place"}),ee=a.i18n.translate("xpack.securitySolution.auditd.openedTooManySessionsDescription",{defaultMessage:"opened too many sessions"}),te=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusualHourDescription",{defaultMessage:"attempted login from unusual hour"}),ne=a.i18n.translate("xpack.securitySolution.auditd.testedFileSystemIntegrityDescription",{defaultMessage:"tested file system integrity"}),ae=a.i18n.translate("xpack.securitySolution.auditd.violatedSeLinuxPolicyDescription",{defaultMessage:"violated selinux policy"}),ie=a.i18n.translate("xpack.securitySolution.auditd.violatedAppArmorPolicyFromDescription",{defaultMessage:"violated app armor policy from"}),re=a.i18n.translate("xpack.securitySolution.auditd.changedGroupDescription",{defaultMessage:"changed group"}),oe=a.i18n.translate("xpack.securitySolution.auditd.changedUserIdDescription",{defaultMessage:"changed user id"}),se=a.i18n.translate("xpack.securitySolution.auditd.changedAuditConfigurationDescription",{defaultMessage:"changed audit configuration"}),le=a.i18n.translate("xpack.securitySolution.auditd.refreshedCredentialsForDescription",{defaultMessage:"refreshed credentials for"}),ce=a.i18n.translate("xpack.securitySolution.auditd.negotiatedCryptoKeyDescription",{defaultMessage:"negotiated crypto key"}),ue=a.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedInDescription",{defaultMessage:"crypto officer logged in"}),de=a.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedOutDescription",{defaultMessage:"crypto officer logged out"}),pe=a.i18n.translate("xpack.securitySolution.auditd.startedCryptoSessionDescription",{defaultMessage:"started crypto session"}),me=a.i18n.translate("xpack.securitySolution.auditd.accessResultDescription",{defaultMessage:"access result"}),fe=a.i18n.translate("xpack.securitySolution.auditd.abortedAuditStartupDescription",{defaultMessage:"aborted audit startup"}),ge=a.i18n.translate("xpack.securitySolution.auditd.remoteAuditConnectedDescription",{defaultMessage:"remote audit connected"}),be=a.i18n.translate("xpack.securitySolution.auditd.remoteAuditDisconnectedDescription",{defaultMessage:"remote audit disconnected"}),ye=a.i18n.translate("xpack.securitySolution.auditd.shutDownAuditDescription",{defaultMessage:"shutdown audit"}),he=a.i18n.translate("xpack.securitySolution.auditd.auditErrorDescription",{defaultMessage:"audit error"}),ve=a.i18n.translate("xpack.securitySolution.auditd.reconfiguredAuditDescription",{defaultMessage:"reconfigured audit"}),Ee=a.i18n.translate("xpack.securitySolution.auditd.resumedAuditLoggingDescription",{defaultMessage:"resumed audit logging"}),xe=a.i18n.translate("xpack.securitySolution.auditd.rotatedAuditLogsDescription",{defaultMessage:"rotated-audit-logs"}),je=a.i18n.translate("xpack.securitySolution.auditd.startedAuditDescription",{defaultMessage:"started audit"}),Se=a.i18n.translate("xpack.securitySolution.auditd.deletedGroupAccountUsingDescription",{defaultMessage:"deleted group account using"}),Oe=a.i18n.translate("xpack.securitySolution.auditd.deletedUserAccountUsingDescription",{defaultMessage:"deleted user account using"}),ke=a.i18n.translate("xpack.securitySolution.auditd.changedAuditFeatureDescription",{defaultMessage:"changed audit feature"}),we=a.i18n.translate("xpack.securitySolution.auditd.relabeledFileSystemDescription",{defaultMessage:"relabeled filesystem"}),Te=a.i18n.translate("xpack.securitySolution.auditd.authenticatedToGroupDescription",{defaultMessage:"authenticated to group"}),Ie=a.i18n.translate("xpack.securitySolution.auditd.changedGroupPasswordDescription",{defaultMessage:"changed group password"}),Me=a.i18n.translate("xpack.securitySolution.auditd.modifiedGroupAccountDescription",{defaultMessage:"modified group account"}),Ce=a.i18n.translate("xpack.securitySolution.auditd.initializedAuditSubsystemDescription",{defaultMessage:"initialized audit subsystem"}),_e=a.i18n.translate("xpack.securitySolution.auditd.modifiedLevelOfDescription",{defaultMessage:"modified level of"}),De=a.i18n.translate("xpack.securitySolution.auditd.overrodeLabelOfDescription",{defaultMessage:"overrode label of"}),Ae=a.i18n.translate("xpack.securitySolution.auditd.changedLoginIdToDescription",{defaultMessage:"changed login id to"}),Fe=a.i18n.translate("xpack.securitySolution.auditd.macPermissionDescription",{defaultMessage:"mac permission"}),Ne=a.i18n.translate("xpack.securitySolution.auditd.changedSeLinuxBooleanDescription",{defaultMessage:"changed selinux boolean"}),Pe=a.i18n.translate("xpack.securitySolution.auditd.loadedSeLinuxPolicyDescription",{defaultMessage:"loaded selinux policy"}),Re=a.i18n.translate("xpack.securitySolution.auditd.changedSelinuxEnforcementDescription",{defaultMessage:"changed selinux enforcement"}),Le=a.i18n.translate("xpack.securitySolution.auditd.assignedUserRoleToDescription",{defaultMessage:"assigned user role to"}),ze=a.i18n.translate("xpack.securitySolution.auditd.modifiedRoleDescription",{defaultMessage:"modified role"}),qe=a.i18n.translate("xpack.securitySolution.auditd.removedUserRoleFromDescription",{defaultMessage:"removed user role from"}),Be=a.i18n.translate("xpack.securitySolution.auditd.violatedSeccompPolicyWithDescription",{defaultMessage:"violated seccomp policy with"}),$e=a.i18n.translate("xpack.securitySolution.auditd.startedServiceDescription",{defaultMessage:"started service"}),Ve=a.i18n.translate("xpack.securitySolution.auditd.stoppedServiceDescription",{defaultMessage:"stopped service"}),Ue=a.i18n.translate("xpack.securitySolution.auditd.bootedSystemDescription",{defaultMessage:"booted system"}),Ge=a.i18n.translate("xpack.securitySolution.auditd.changedToRunLevelWithDescription",{defaultMessage:"changed to run level with"}),He=a.i18n.translate("xpack.securitySolution.auditd.shutdownSystemDescription",{defaultMessage:"shutdown system"}),We=a.i18n.translate("xpack.securitySolution.auditd.sentTestDescription",{defaultMessage:"sent test"}),Qe=a.i18n.translate("xpack.securitySolution.auditd.unknownDescription",{defaultMessage:"unknown"}),Ye=a.i18n.translate("xpack.securitySolution.auditd.sentMessageDescription",{defaultMessage:"sent message"}),Ke=a.i18n.translate("xpack.securitySolution.auditd.accessPermissionDescription",{defaultMessage:"access permission"}),Je=a.i18n.translate("xpack.securitySolution.auditd.authenticatedUsingDescription",{defaultMessage:"authenticated using"}),Ze=a.i18n.translate("xpack.securitySolution.auditd.changedPasswordWithDescription",{defaultMessage:"changed password with"}),Xe=a.i18n.translate("xpack.securitySolution.auditd.ranCommandDescription",{defaultMessage:"ran command"}),et=a.i18n.translate("xpack.securitySolution.auditd.errorFromDescription",{defaultMessage:"error from"}),tt=a.i18n.translate("xpack.securitySolution.auditd.loggedOutDescription",{defaultMessage:"logged out"}),nt=a.i18n.translate("xpack.securitySolution.auditd.changedMacConfigurationDescription",{defaultMessage:"changed mac configuration"}),at=a.i18n.translate("xpack.securitySolution.auditd.loadedMacPolicyDescription",{defaultMessage:"loaded mac policy"}),it=a.i18n.translate("xpack.securitySolution.auditd.modifiedUserAccountDescription",{defaultMessage:"modified user account"}),rt=a.i18n.translate("xpack.securitySolution.auditd.changedRoleUsingDescription",{defaultMessage:"changed role using"}),ot=a.i18n.translate("xpack.securitySolution.auditd.accessErrorDescription",{defaultMessage:"access error"}),st=a.i18n.translate("xpack.securitySolution.auditd.changedConfigurationWIthDescription",{defaultMessage:"changed configuration with"}),lt=a.i18n.translate("xpack.securitySolution.auditd.issuedVmControlDescription",{defaultMessage:"issued vm control"}),ct=a.i18n.translate("xpack.securitySolution.auditd.createdVmImageDescription",{defaultMessage:"created vm image"}),ut=a.i18n.translate("xpack.securitySolution.auditd.deletedVmImageDescription",{defaultMessage:"deleted vm image"}),dt=a.i18n.translate("xpack.securitySolution.auditd.checkedIntegrityOfDescription",{defaultMessage:"checked integrity of"}),pt=a.i18n.translate("xpack.securitySolution.auditd.assignedVmIdDescription",{defaultMessage:"assigned vm id"}),mt=a.i18n.translate("xpack.securitySolution.auditd.migratedVmFromDescription",{defaultMessage:"migrated vm from"}),ft=a.i18n.translate("xpack.securitySolution.auditd.migratedVmToDescription",{defaultMessage:"migrated vm to"}),gt=a.i18n.translate("xpack.securitySolution.auditd.assignedVMResourceDescription",{defaultMessage:"assigned vm resource"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(19),i=n(2),r=n.n(i),o=n(134),s=n(150),l=n(434);const c=r.a.memo((({contextId:e,endgamePid:t,endgameProcessName:n,eventId:i,processExecutable:l,processName:c,processPid:u,isDraggable:d})=>Object(s.e)(c)&&Object(s.e)(l)&&Object(s.e)(n)&&Object(s.e)(u)&&Object(s.e)(t)?null:r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(s.e)(c)?Object(s.e)(l)?Object(s.e)(n)?null:r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"endgame.process_name",value:n,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"process.executable",value:l,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"process.name",value:c,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})),Object(s.e)(u)?Object(s.e)(t)?null:r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"endgame.pid",queryValue:String(t),value:`(${String(t)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"process.pid",queryValue:String(u),value:`(${String(u)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})))));c.displayName="ProcessDraggable";const u=r.a.memo((({contextId:e,endgamePid:t,endgameProcessName:n,eventId:a,processExecutable:i,processName:o,processPid:s,isDraggable:u})=>null==t&&null==n&&null==i&&null==o&&null==s?r.a.createElement(r.a.Fragment,null,l.g):r.a.createElement(c,{contextId:e,endgamePid:t,endgameProcessName:n,eventId:a,processExecutable:i,processName:o,processPid:s,isDraggable:u})));u.displayName="ProcessDraggableWithNonExistentProcess"},function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return F}));var a=n(41),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=(n(152),n(44)),c=n(4),u=n(1216),d=n(122),p=n(313),m=n(125),f=n(367),g=n(137),b=n(130),y=n(196),h=n(334),v=n(226),E=n(132),x=n(161),j=n(570),S=n(142),O=n(366),k=n(735),w=n(320),T=n(135),I=n(145),M=n(210),C=n(357),_=n(288),D=n(118);const A={title:c.i18n.translate("xpack.securitySolution.flyout.right.host.hostPreviewTitle",{defaultMessage:"Preview host details"}),backgroundColor:"warning",textColor:"warning"},F=({hostName:e})=>{const{eventId:t,indexName:n,scopeId:a}=Object(m.b)(),{openLeftPanel:i,openPreviewPanel:F}=Object(u.a)(),{telemetry:P}=Object(D.j)().services,R=!Object(d.a)("entityAlertPreviewDisabled"),L=Object(r.useCallback)((()=>{i({id:I.c,path:{tab:M.b,subTab:w.a},params:{id:t,indexName:n,scopeId:a}})}),[t,i,n,a]),z=Object(r.useCallback)((()=>{F({id:_.e,params:{hostName:e,scopeId:a,banner:A}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[F,e,a,P]),{from:q,to:B}=Object(x.a)(),{selectedPatterns:$}=Object(E.a)(),V=Object(r.useMemo)((()=>({from:q,to:B})),[q,B]),U=Object(r.useMemo)((()=>e?Object(g.z)([e]):void 0),[e]),{data:G,isAuthorized:H,loading:W}=Object(p.a)({filterQuery:U,riskEntity:g.t.host,skip:null==e,timerange:V}),[Q,{hostDetails:Y}]=Object(j.b)({hostName:e,indexNames:$,startDate:q,endDate:B}),K=Object(r.useMemo)((()=>Object(S.a)(Object(l.getOr)([],"host.os.family",Y))),[Y]),J=Object(r.useMemo)((()=>[{title:k.c,description:K?o.a.createElement(O.a,{field:"host.os.family",value:K},K):Object(b.d)()}]),[K]),Z=Object(r.useMemo)((()=>[{title:k.k,description:o.a.createElement(f.a,{indexPatterns:$,field:"host.name",value:e,type:f.b.LAST_SEEN})}]),[e,$]),{euiTheme:X}=Object(s.useEuiTheme)(),ee=Object(s.useEuiFontSize)("xs").fontSize,[te]=Object(r.useMemo)((()=>{const e=G&&G.length>0?G[0]:void 0;return[{title:o.a.createElement(s.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},k.f),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(C.a,null))),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(v.a,{severity:e.host.risk.calculated_level}):Object(b.d)())}]}),[G]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":T.v},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{gutterSize:"m",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:"storage"})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(N,{"data-test-subj":T.r,onClick:R?z:L,$_css:ee,$_css2:X.font.weight.bold},e)))),W||Q?o.a.createElement(s.EuiSkeletonText,{"data-test-subj":T.s,contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.hostLoadingAriaLabel",{defaultMessage:"host overview"})}):o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(h.a,{dataTestSubj:T.t,descriptionList:J})),o.a.createElement(s.EuiFlexItem,null,H?o.a.createElement(y.d,{"data-test-subj":T.u,listItems:[te]}):o.a.createElement(h.a,{dataTestSubj:T.q,descriptionList:Z})))))};F.displayName="HostEntityOverview";var N=i()(s.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-cud8pg-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2))},function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return F}));var a=n(41),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=(n(152),n(44)),c=n(4),u=n(1216),d=n(122),p=n(145),m=n(210),f=n(320),g=n(125),b=n(142),y=n(366),h=n(367),v=n(137),E=n(130),x=n(196),j=n(334),S=n(226),O=n(132),k=n(161),w=n(313),T=n(118),I=n(736),M=n(135),C=n(548),_=n(357),D=n(287);const A={title:c.i18n.translate("xpack.securitySolution.flyout.right.user.userPreviewTitle",{defaultMessage:"Preview user details"}),backgroundColor:"warning",textColor:"warning"},F=({userName:e})=>{const{eventId:t,indexName:n,scopeId:a}=Object(g.b)(),{openLeftPanel:i,openPreviewPanel:F}=Object(u.a)(),{telemetry:P}=Object(T.j)().services,R=!Object(d.a)("entityAlertPreviewDisabled"),L=Object(r.useCallback)((()=>{i({id:p.c,path:{tab:m.b,subTab:f.a},params:{id:t,indexName:n,scopeId:a}})}),[t,i,n,a]),z=Object(r.useCallback)((()=>{F({id:D.d,params:{userName:e,scopeId:a,banner:A}}),P.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[F,e,a,P]),{from:q,to:B}=Object(k.a)(),{selectedPatterns:$}=Object(O.a)(),V=Object(r.useMemo)((()=>({from:q,to:B})),[q,B]),U=Object(r.useMemo)((()=>e?Object(v.A)([e]):void 0),[e]),[G,{userDetails:H}]=Object(C.b)({endDate:B,userName:e,indexNames:$,startDate:q}),{data:W,isAuthorized:Q,loading:Y}=Object(w.a)({filterQuery:U,riskEntity:v.t.user,timerange:V}),K=Object(r.useMemo)((()=>Object(b.a)(Object(l.getOr)([],"user.domain",H))),[H]),J=Object(r.useMemo)((()=>[{title:I.h,description:K?o.a.createElement(y.a,{field:"user.domain",value:K},K):Object(E.d)()}]),[K]),Z=Object(r.useMemo)((()=>[{title:I.f,description:o.a.createElement(h.a,{indexPatterns:$,field:"user.name",value:e,type:h.b.LAST_SEEN})}]),[e,$]),{euiTheme:X}=Object(s.useEuiTheme)(),ee=Object(s.useEuiFontSize)("xs").fontSize,[te]=Object(r.useMemo)((()=>{const e=W&&W.length>0?W[0]:void 0;return[{title:o.a.createElement(s.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},I.j),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(_.a,null))),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(S.a,{severity:e.user.risk.calculated_level}):Object(E.d)())}]}),[W]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":M.B},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiFlexGroup,{gutterSize:"m",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:"user"})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(N,{"data-test-subj":M.y,onClick:R?z:L,$_css:ee,$_css2:X.font.weight.bold},e)))),o.a.createElement(s.EuiFlexItem,null,G||Y?o.a.createElement(s.EuiSkeletonText,{contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.userLoadingAriaLabel",{defaultMessage:"user overview"}),"data-test-subj":M.z}):o.a.createElement(s.EuiFlexGroup,{responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(j.a,{dataTestSubj:M.w,descriptionList:J})),o.a.createElement(s.EuiFlexItem,null,Q?o.a.createElement(x.d,{"data-test-subj":M.A,listItems:[te]}):o.a.createElement(j.a,{dataTestSubj:M.x,descriptionList:Z})))))};var N=i()(s.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-f1yfvo-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2))},function(e,t,n){"use strict";n.d(t,"a",(function(){return ie})),n.d(t,"b",(function(){return re}));var a=n(2),i=n.n(a),r=n(19),o=n(42),s=n(125),l=n(142),c=n(45),u=n(50),d=n(4),p=n(1216),m=n(122),f=n(202),g=n(785),b=n(450),y=n(181),h=n(144),v=n(137),E=n(226),x=n(351),j=n(131),S=n(175),O=n(236),k=n(173);const w=({field:e,value:t,isObjectArray:n,children:r})=>{const{dataFormattedForFieldBrowser:o,scopeId:l,isPreview:c}=Object(s.b)(),{isAlert:u}=Object(S.b)(o),d=u?k.d.DETAILS_FLYOUT:k.d.DEFAULT,p=Object(a.useMemo)((()=>({field:e,value:t})),[e,t]),m=Object(a.useMemo)((()=>({scopeId:l,isObjectArray:n})),[l,n]),f=Object(a.useMemo)((()=>c?[O.d.FILTER,O.d.TOGGLE_COLUMN]:[]),[c]);return i.a.createElement(k.c,{data:p,mode:k.a.HOVER_RIGHT,triggerId:d,visibleCellActions:6,sourcererScopeId:Object(j.getSourcererScopeId)(l),metadata:m,disabledActionTypes:f},r)};w.displayName="CellActions";var T=n(138),I=n(161),M=n(132),C=n(419),_=n(249),D=n(561),A=n(209),F=n(548),N=n(699),P=n(306);const R=d.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedHostsDescription",{defaultMessage:"Failed to run search on related hosts"});var L=n(359),z=n(201),q=n(130),B=n(153),$=n(118),V=n(264),U=n(350),G=n(288),H=n(318),W=n(287),Q=n(319);const Y=Object(A.a)(g.b),K=Object(A.a)(y.c),J=({userName:e,timestamp:t,scopeId:n})=>{const{to:s,from:l,deleteQuery:g,setQuery:j,isInitializing:S}=Object(I.a)(),{selectedPatterns:O}=Object(M.a)(),k=Object(c.useDispatch)(),{telemetry:A}=Object($.j)().services,J=Object(a.useMemo)((()=>`entities-users-details-${Object(u.v4)()}`),[]),Z=Object(a.useMemo)((()=>`entities-users-related-hosts-${Object(u.v4)()}`),[]),X=Object(U.a)("entity-analytics"),ee=Object(z.a)().isPlatinumOrTrialLicense&&X,{openPreviewPanel:te}=Object(p.a)(),ne=!Object(m.a)("entityAlertPreviewDisabled"),ae=Object(a.useCallback)(((e,t)=>{const n=Object(C.a)(e,t);k(Object(_.setAbsoluteRangeDatePicker)({id:T.a.global,from:n.from,to:n.to}))}),[k]),ie=Object(a.useCallback)((()=>{te({id:W.d,params:{userName:e,scopeId:n,banner:Q.a}}),A.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[te,e,n,A]),re=Object(a.useCallback)((e=>{te({id:G.e,params:{hostName:e,scopeId:n,banner:H.a}}),A.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[te,n,A]),[oe,{inspect:se,userDetails:le,refetch:ce}]=Object(F.b)({id:J,startDate:l,endDate:s,userName:e,indexNames:O,skip:0===O.length}),{loading:ue,inspect:de,relatedHosts:pe,totalCount:me,refetch:fe}=(({userName:e,indexNames:t,from:n,skip:i=!1})=>{const{loading:r,result:o,search:s,refetch:l,inspect:c}=Object(P.a)({factoryQueryType:N.a.relatedHosts,initialResult:{totalCount:0,relatedHosts:[]},errorMessage:R,abort:i}),{installed:u,isLoading:d}=Object(L.b)(),p=Object(a.useMemo)((()=>({inspect:c,totalCount:o.totalCount,relatedHosts:o.relatedHosts,refetch:l,loading:r})),[c,l,o.totalCount,o.relatedHosts,r]),m=Object(a.useMemo)((()=>({defaultIndex:t,factoryQueryType:N.a.relatedHosts,userName:e,from:n,isNewRiskScoreModuleInstalled:u})),[t,n,e,u]);return Object(a.useEffect)((()=>{i||d||s(m)}),[m,s,i,d]),p})({userName:e,indexNames:O,from:t,skip:0===O.length}),ge=Object(a.useMemo)((()=>[{field:"host",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNameColumnLabel",defaultMessage:"Name"}),render:e=>i.a.createElement(r.EuiText,{grow:!1,size:"xs"},i.a.createElement(w,{field:"host.name",value:e},ne?i.a.createElement(r.EuiLink,{"data-test-subj":B.O,onClick:()=>re(e)},e):i.a.createElement(i.a.Fragment,null,e)))},{field:"ip",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>i.a.createElement(x.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?i.a.createElement(h.h,{ip:e}):Object(q.d)(),scopeId:n})},...ee?[{field:"risk",name:Object(V.b)(v.t.host),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(E.a,{severity:e}):Object(q.d)()}]:[]]),[ee,n,re,ne]),be=Object(a.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIcon,{type:"storage"})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxxs"},i.a.createElement(r.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsCountLabel",defaultMessage:"Related hosts: {count}",values:{count:me}})))))),[me]),ye=Object(a.useMemo)((()=>ne?{callback:ie,tooltip:d.i18n.translate("xpack.securitySolution.flyout.left.insights.entities.user.userPreviewTitle",{defaultMessage:"Preview user"})}:void 0),[ne,ie]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsTitle",defaultMessage:"User"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(f.a,{header:{title:e,iconType:"user",headerContent:be,link:ye},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":B.Q},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsInfoTitle",defaultMessage:"User information"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(b.a,{criteriaFields:Object(D.a)(le),startDate:l,endDate:s,skip:S},(({isLoadingAnomaliesData:t,anomaliesData:n,jobNameById:a})=>i.a.createElement(Y,{id:J,isInDetailsSidePanel:!1,data:le,anomaliesData:n,isLoadingAnomaliesData:t,loading:oe,startDate:l,endDate:s,narrowDateRange:ae,setQuery:j,refetch:ce,inspect:se,userName:e,indexPatterns:O,jobNameById:a}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTitle",defaultMessage:"Related hosts"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTooltip",defaultMessage:"After this event, {userName} logged into these hosts. Check if this activity is normal.",values:{userName:e}})},i.a.createElement(r.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(K,{id:Z,inspect:de,loading:ue,setQuery:j,deleteQuery:g,refetch:fe},i.a.createElement(r.EuiInMemoryTable,{columns:ge,items:pe,loading:ue,"data-test-subj":B.P,pagination:{pageSize:4,showPerPageOptions:!1},message:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNoDataDescription",defaultMessage:"No hosts identified"})}),i.a.createElement(y.b,{queryId:Z,title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsInspectButtonTitle",defaultMessage:"Related hosts"}),inspectIndex:0})))))};var Z=n(792),X=n(570);const ee=d.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedUsersDescription",{defaultMessage:"Failed to run search on related users"}),te=Object(A.a)(Z.b),ne=Object(A.a)(y.c),ae=({hostName:e,timestamp:t,scopeId:n})=>{const{to:s,from:l,deleteQuery:g,setQuery:j,isInitializing:S}=Object(I.a)(),{selectedPatterns:O}=Object(M.a)(),k=Object(c.useDispatch)(),{telemetry:A}=Object($.j)().services,F=Object(a.useMemo)((()=>`entities-hosts-details-${Object(u.v4)()}`),[]),R=Object(a.useMemo)((()=>`entities-hosts-related-users-${Object(u.v4)()}`),[]),Y=Object(U.a)("entity-analytics"),K=Object(z.a)().isPlatinumOrTrialLicense&&Y,{openPreviewPanel:J}=Object(p.a)(),Z=!Object(m.a)("entityAlertPreviewDisabled"),ae=Object(a.useCallback)(((e,t)=>{const n=Object(C.a)(e,t);k(Object(_.setAbsoluteRangeDatePicker)({id:T.a.global,from:n.from,to:n.to}))}),[k]),ie=Object(a.useCallback)((()=>{J({id:G.e,params:{hostName:e,scopeId:n,banner:H.a}}),A.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[J,e,n,A]),re=Object(a.useCallback)((e=>{J({id:W.d,params:{userName:e,scopeId:n,banner:Q.a}}),A.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[J,n,A]),[oe,{inspect:se,hostDetails:le,refetch:ce}]=Object(X.b)({id:F,startDate:l,endDate:s,hostName:e,indexNames:O,skip:0===O.length}),{loading:ue,inspect:de,relatedUsers:pe,totalCount:me,refetch:fe}=(({hostName:e,indexNames:t,from:n,skip:i=!1})=>{const{installed:r,isLoading:o}=Object(L.b)(),{loading:s,result:l,search:c,refetch:u,inspect:d}=Object(P.a)({factoryQueryType:N.a.relatedUsers,initialResult:{totalCount:0,relatedUsers:[]},errorMessage:ee,abort:i}),p=Object(a.useMemo)((()=>({inspect:d,totalCount:l.totalCount,relatedUsers:l.relatedUsers,refetch:u,loading:s})),[d,u,l.totalCount,l.relatedUsers,s]),m=Object(a.useMemo)((()=>({defaultIndex:t,factoryQueryType:N.a.relatedUsers,hostName:e,from:n,isNewRiskScoreModuleInstalled:r})),[t,n,e,r]);return Object(a.useEffect)((()=>{i||o||c(m)}),[m,o,c,i]),p})({hostName:e,indexNames:O,from:t,skip:0===O.length}),ge=Object(a.useMemo)((()=>[{field:"user",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNameColumnLabel",defaultMessage:"Name"}),render:e=>i.a.createElement(r.EuiText,{grow:!1,size:"xs"},i.a.createElement(w,{field:"user.name",value:e},Z?i.a.createElement(r.EuiLink,{"data-test-subj":B.o,onClick:()=>re(e)},e):i.a.createElement(i.a.Fragment,null,e)))},{field:"ip",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>i.a.createElement(x.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?i.a.createElement(h.h,{ip:e}):Object(q.d)(),scopeId:n})},...K?[{field:"risk",name:Object(V.b)(v.t.user),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(E.a,{severity:e}):Object(q.d)()}]:[]]),[K,n,Z,re]),be=Object(a.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIcon,{type:"user"})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxxs"},i.a.createElement(r.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersCountLabel",defaultMessage:"Related users: {count}",values:{count:me}})))))),[me]),ye=Object(a.useMemo)((()=>Z?{callback:ie,tooltip:d.i18n.translate("xpack.securitySolution.flyout.left.insights.entities.host.hostPreviewTitle",{defaultMessage:"Preview host"})}:void 0),[Z,ie]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsTitle",defaultMessage:"Host"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(f.a,{header:{title:e,iconType:"storage",headerContent:be,link:ye},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":B.q},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsInfoTitle",defaultMessage:"Host information"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(b.a,{criteriaFields:Object(D.a)(le),startDate:l,endDate:s,skip:S},(({isLoadingAnomaliesData:t,anomaliesData:n,jobNameById:a})=>i.a.createElement(te,{id:F,hostName:e,data:le,indexNames:O,jobNameById:a,anomaliesData:n,isLoadingAnomaliesData:t,isInDetailsSidePanel:!1,loading:oe,startDate:l,endDate:s,narrowDateRange:ae,setQuery:j,refetch:ce,inspect:se,deleteQuery:g}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTitle",defaultMessage:"Related users"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTooltip",defaultMessage:"After this event, these users logged into {hostName}. Check if this activity is normal.",values:{hostName:e}})},i.a.createElement(r.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(ne,{id:R,inspect:de,loading:ue,setQuery:j,deleteQuery:g,refetch:fe},i.a.createElement(r.EuiInMemoryTable,{columns:ge,items:pe,loading:ue,"data-test-subj":B.p,pagination:{pageSize:4,showPerPageOptions:!1},message:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNoDataDescription",defaultMessage:"No users identified"})}),i.a.createElement(y.b,{queryId:R,title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersInspectButtonTitle",defaultMessage:"Related users"}),inspectIndex:0})))))};ae.displayName="HostDetails";const ie="entity",re=()=>{const{getFieldsData:e,scopeId:t}=Object(s.b)(),n=Object(l.a)(e("host.name")),a=Object(l.a)(e("user.name")),c=Object(l.a)(e("@timestamp")),u=c&&(n||a),d=a&&c,p=n&&c;return i.a.createElement(i.a.Fragment,null,u?i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"m","data-test-subj":B.n},d&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(J,{userName:a,timestamp:c,scopeId:t})),p&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(ae,{hostName:n,timestamp:c,scopeId:t}))):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."}))};re.displayName="EntitiesDetails"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,n){"use strict";e.exports=n(710)},function(e,t,n){"use strict";e.exports=n(711)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(371);t.default=function(e,t){var n=i.useFirstMountState();a.useEffect((function(){if(!n)return e()}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){void 0===e&&(e={});var t=a.useState(e),n=t[0],i=t[1];return[n,a.useCallback((function(e){i((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[i])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect(e,[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(373));t.default=function(e){var t=i.useRef(0),n=i.useState(e),a=n[0],o=n[1],s=i.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){o(e)}))}),[]);return r.default((function(){cancelAnimationFrame(t.current)})),[a,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(120).z.enum(["asc","desc"]);a.enum},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),i=n(45),r=n(138),o=n(243),s=n(129),l=n(206),c=n(146),u=n(121),d=n(124),p=n(183),m=n(166),f=n(127),g=n(260),b=n(513),y=n(122),h=n(274),v=n(158);const E=({timelineId:e,timelineType:t,onClick:n})=>{var E;const x=Object(i.useDispatch)(),j=Object(y.a)("unifiedComponentsInTimelineDisabled"),{id:S,patternList:O}=null!==(E=Object(i.useSelector)(m.d.defaultDataView))&&void 0!==E?E:{id:"",patternList:[]},{timelineFullScreen:k,setTimelineFullScreen:w}=Object(l.c)(),T=Object(d.a)(p.d.globalTimeRangeSelector),{resetDiscoverAppState:I}=Object(b.a)(),M=Object(a.useCallback)((({id:e,show:n,timeRange:a})=>{const i=null!=a?a:T;e===c.c.active&&k&&w(!1),x(m.a.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:S,selectedPatterns:O})),x(s.a.createTimeline({columns:j?o.b:h.a,dataViewId:S,id:e,indexNames:O,show:n,timelineType:t,updated:void 0,excludedRowRendererIds:j||t===u.m.template?[]:v.b.excludedRowRendererIds})),x(p.b.addLinkTo([r.a.global,r.a.timeline])),x(g.a.addNotes({notes:[]})),a&&x(p.b.removeLinkTo([r.a.timeline,r.a.global])),"absolute"===(null==i?void 0:i.kind)?x(p.b.setAbsoluteRangeDatePicker({...i,id:r.a.timeline})):"relative"===(null==i?void 0:i.kind)&&x(p.b.setRelativeRangeDatePicker({...i,id:r.a.timeline}))}),[x,T,S,O,w,k,t,j]);return Object(a.useCallback)((async a=>{await I(),M({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n()}),[M,e,t,n,I])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n(44),r=n(4),o=n(921),s=n(519),l=n(503),c=n(174),u=n(10);const d=r.i18n.translate("xpack.securitySolution.useAlertResponseActionsSupport.notAnAlert",{defaultMessage:"Response actions are only supported for Alerts (not events)"}),p=(e=[])=>{const t=Object(a.useMemo)((()=>Object(i.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e)),[e]),n=Object(a.useMemo)((()=>{var t,n,a,r;if((null!==(t=null===(n=Object(i.find)({field:"agent.type"},e))||void 0===n?void 0:n.values)&&void 0!==t?t:[]).includes("endpoint"))return"endpoint";const o=null!==(a=null===(r=Object(i.find)({field:"event.module"},e))||void 0===r?void 0:r.values)&&void 0!==a?a:[];return o.includes("sentinel_one")?"sentinel_one":o.includes("crowdstrike")?"crowdstrike":void 0}),[e]),p=Object(a.useMemo)((()=>!!n&&Object(l.a)(n)),[n]),m=Object(a.useMemo)((()=>n?"endpoint"===n?Object(s.a)({category:"agent",field:"agent.id"},e):"sentinel_one"===n?Object(s.a)({category:"observer",field:c.b.sentinel_one},e):"crowdstrike"===n?Object(s.a)({category:"device",field:c.b.crowdstrike},e):"":""),[n,e]),f=Object(a.useMemo)((()=>Boolean(p&&t&&m&&n)),[m,n,t,p]),g=Object(a.useMemo)((()=>n?c.b[n]:""),[n]),b=Object(a.useMemo)((()=>c.e.reduce(((e,t)=>(e[t]=!1,n&&p&&(e[t]=Object(l.a)(n,t,"manual")),e)),{})),[n,p]),y=Object(a.useMemo)((()=>Object(s.a)({category:"host",field:"host.name"},e)),[e]),h=Object(a.useMemo)((()=>Object(o.a)(null!=e?e:[])),[e]),v=Object(a.useMemo)((()=>{if(!f){if(!t)return d;if(!n)return;if(!m)return e=Object(u.n)(n),a=g,r.i18n.translate("xpack.securitySolution.useAlertResponseActionsSupport.missingAgentIdField",{defaultMessage:"Alert event data missing {agentTypeName} agent identifier field ({missingField})",values:{missingField:a,agentTypeName:e}})}var e,a}),[m,g,n,f,t]);return Object(a.useMemo)((()=>({isSupported:f,unsupportedReason:v,isAlert:t,details:{agentType:n||"endpoint",agentId:m,hostName:y,platform:h,agentIdField:g,agentSupport:b}})),[m,g,n,f,y,t,h,b,v])}},function(e,t,n){"use strict";n.d(t,"u",(function(){return o})),n.d(t,"t",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"x",(function(){return c})),n.d(t,"y",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"r",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return E})),n.d(t,"A",(function(){return x})),n.d(t,"z",(function(){return j})),n.d(t,"i",(function(){return S})),n.d(t,"h",(function(){return O})),n.d(t,"g",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return T})),n.d(t,"f",(function(){return I})),n.d(t,"w",(function(){return M})),n.d(t,"v",(function(){return C})),n.d(t,"c",(function(){return _})),n.d(t,"s",(function(){return D}));var a=n(4),i=n(1630);const r=(e,t)=>{switch(e){case i.a.alert:return a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityAlerts",{values:{count:t},defaultMessage:"{count, plural, =1 {alert} other {alerts}}"});case i.a.event:return a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityEvents",{values:{count:t},defaultMessage:"{count, plural, =1 {event} other {events}}"});case i.a.session:return a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entitySessions",{values:{count:t},defaultMessage:"{count, plural, =1 {session} other {sessions}}"})}},o=(e,t,n)=>a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectAllEntitiesTitle",{values:{entityPlural:r(e,n),totalFormatted:t,total:n},defaultMessage:"Select {total, plural, =1 {} other {all}} {totalFormatted} {entityPlural}"}),s=(e,t,n)=>a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectedEntitiesTitle",{values:{entityPlural:r(e,n),totalFormatted:t},defaultMessage:"Selected {totalFormatted} {entityPlural}"}),l=a.i18n.translate("xpack.securitySolution.toolbar.bulkActions.clearSelectionTitle",{defaultMessage:"Clear selection"}),c=e=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailed",{values:{conflicts:e},defaultMessage:"Failed to update { conflicts } {conflicts, plural, =1 {alert} other {alerts}}."}),u=(e,t)=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedDetailed",{values:{updated:e,conflicts:t},defaultMessage:"{ updated } {updated, plural, =1 {alert was} other {alerts were}} updated successfully, but { conflicts } failed to update\n         because { conflicts, plural, =1 {it was} other {they were}} already being modified."}),d=e=>a.i18n.translate("xpack.securitySolution.bulkActions.closedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully closed {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),p=e=>a.i18n.translate("xpack.securitySolution.bulkActions.openedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully opened {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),m=e=>a.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully marked {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}} as acknowledged."}),f=a.i18n.translate("xpack.securitySolution.bulkActions.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),g=a.i18n.translate("xpack.securitySolution.bulkActions.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),b=a.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),y=a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedSingleAlert",{defaultMessage:"Failed to update alert because it was already being modified."}),h=a.i18n.translate("xpack.securitySolution.bulkActions.openSelectedTitle",{defaultMessage:"Mark as open"}),v=a.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedSelectedTitle",{defaultMessage:"Mark as acknowledged"}),E=a.i18n.translate("xpack.securitySolution.bulkActions.closeSelectedTitle",{defaultMessage:"Mark as closed"}),x=e=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated tags for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),j=a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsFailedToastMessage",{defaultMessage:"Failed to update alert tags."}),S=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchPlaceholderMessage",{defaultMessage:"Search tags"}),O=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchNoTagsFoundMessage",{defaultMessage:"No tags match current search"}),k=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuEmptyMessage",{defaultMessage:"No alert tag options exist, add tag options in Kibana Advanced Settings."}),w=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsApplyButtonMessage",{defaultMessage:"Apply tags"}),T=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTitle",{defaultMessage:"Apply alert tags"}),I=a.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTooltip",{defaultMessage:"Change alert tag options in Kibana Advanced Settings."}),M=e=>a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated assignees for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),C=a.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesFailedToastMessage",{defaultMessage:"Failed to update alert assignees."}),_=a.i18n.translate("xpack.securitySolution.bulkActions.alertAssigneesContextMenuItemTitle",{defaultMessage:"Assign alert"}),D=a.i18n.translate("xpack.securitySolution.bulkActions.removeAlertAssignessContextMenuTitle",{defaultMessage:"Unassign alert"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(19),i=n(2),r=n.n(i),o=n(196);const s=({dataTestSubj:e,descriptionList:t})=>r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(o.d,{"data-test-subj":e,listItems:t}))},function(e,t,n){"use strict";var a=Object.assign;e.exports=a},function(e,t,n){"use strict";n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return O})),n.d(t,"h",(function(){return k})),n.d(t,"d",(function(){return I})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return _})),n.d(t,"e",(function(){return D})),n.d(t,"a",(function(){return A}));var a=n(7);const i={"@timestamp":{type:"date",array:!1,required:!0},"agent.build.original":{type:"keyword",array:!1,required:!1},"agent.ephemeral_id":{type:"keyword",array:!1,required:!1},"agent.id":{type:"keyword",array:!1,required:!1},"agent.name":{type:"keyword",array:!1,required:!1},"agent.type":{type:"keyword",array:!1,required:!1},"agent.version":{type:"keyword",array:!1,required:!1},"client.address":{type:"keyword",array:!1,required:!1},"client.as.number":{type:"long",array:!1,required:!1},"client.as.organization.name":{type:"keyword",array:!1,required:!1},"client.bytes":{type:"long",array:!1,required:!1},"client.domain":{type:"keyword",array:!1,required:!1},"client.geo.city_name":{type:"keyword",array:!1,required:!1},"client.geo.continent_code":{type:"keyword",array:!1,required:!1},"client.geo.continent_name":{type:"keyword",array:!1,required:!1},"client.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.country_name":{type:"keyword",array:!1,required:!1},"client.geo.location":{type:"geo_point",array:!1,required:!1},"client.geo.name":{type:"keyword",array:!1,required:!1},"client.geo.postal_code":{type:"keyword",array:!1,required:!1},"client.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.region_name":{type:"keyword",array:!1,required:!1},"client.geo.timezone":{type:"keyword",array:!1,required:!1},"client.ip":{type:"ip",array:!1,required:!1},"client.mac":{type:"keyword",array:!1,required:!1},"client.nat.ip":{type:"ip",array:!1,required:!1},"client.nat.port":{type:"long",array:!1,required:!1},"client.packets":{type:"long",array:!1,required:!1},"client.port":{type:"long",array:!1,required:!1},"client.registered_domain":{type:"keyword",array:!1,required:!1},"client.subdomain":{type:"keyword",array:!1,required:!1},"client.top_level_domain":{type:"keyword",array:!1,required:!1},"client.user.domain":{type:"keyword",array:!1,required:!1},"client.user.email":{type:"keyword",array:!1,required:!1},"client.user.full_name":{type:"keyword",array:!1,required:!1},"client.user.group.domain":{type:"keyword",array:!1,required:!1},"client.user.group.id":{type:"keyword",array:!1,required:!1},"client.user.group.name":{type:"keyword",array:!1,required:!1},"client.user.hash":{type:"keyword",array:!1,required:!1},"client.user.id":{type:"keyword",array:!1,required:!1},"client.user.name":{type:"keyword",array:!1,required:!1},"client.user.roles":{type:"keyword",array:!0,required:!1},"cloud.account.id":{type:"keyword",array:!1,required:!1},"cloud.account.name":{type:"keyword",array:!1,required:!1},"cloud.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.instance.id":{type:"keyword",array:!1,required:!1},"cloud.instance.name":{type:"keyword",array:!1,required:!1},"cloud.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.account.id":{type:"keyword",array:!1,required:!1},"cloud.origin.account.name":{type:"keyword",array:!1,required:!1},"cloud.origin.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.id":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.name":{type:"keyword",array:!1,required:!1},"cloud.origin.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.project.id":{type:"keyword",array:!1,required:!1},"cloud.origin.project.name":{type:"keyword",array:!1,required:!1},"cloud.origin.provider":{type:"keyword",array:!1,required:!1},"cloud.origin.region":{type:"keyword",array:!1,required:!1},"cloud.origin.service.name":{type:"keyword",array:!1,required:!1},"cloud.project.id":{type:"keyword",array:!1,required:!1},"cloud.project.name":{type:"keyword",array:!1,required:!1},"cloud.provider":{type:"keyword",array:!1,required:!1},"cloud.region":{type:"keyword",array:!1,required:!1},"cloud.service.name":{type:"keyword",array:!1,required:!1},"cloud.target.account.id":{type:"keyword",array:!1,required:!1},"cloud.target.account.name":{type:"keyword",array:!1,required:!1},"cloud.target.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.target.instance.id":{type:"keyword",array:!1,required:!1},"cloud.target.instance.name":{type:"keyword",array:!1,required:!1},"cloud.target.machine.type":{type:"keyword",array:!1,required:!1},"cloud.target.project.id":{type:"keyword",array:!1,required:!1},"cloud.target.project.name":{type:"keyword",array:!1,required:!1},"cloud.target.provider":{type:"keyword",array:!1,required:!1},"cloud.target.region":{type:"keyword",array:!1,required:!1},"cloud.target.service.name":{type:"keyword",array:!1,required:!1},"container.id":{type:"keyword",array:!1,required:!1},"container.image.name":{type:"keyword",array:!1,required:!1},"container.image.tag":{type:"keyword",array:!0,required:!1},"container.labels":{type:"object",array:!1,required:!1},"container.name":{type:"keyword",array:!1,required:!1},"container.runtime":{type:"keyword",array:!1,required:!1},"destination.address":{type:"keyword",array:!1,required:!1},"destination.as.number":{type:"long",array:!1,required:!1},"destination.as.organization.name":{type:"keyword",array:!1,required:!1},"destination.bytes":{type:"long",array:!1,required:!1},"destination.domain":{type:"keyword",array:!1,required:!1},"destination.geo.city_name":{type:"keyword",array:!1,required:!1},"destination.geo.continent_code":{type:"keyword",array:!1,required:!1},"destination.geo.continent_name":{type:"keyword",array:!1,required:!1},"destination.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.country_name":{type:"keyword",array:!1,required:!1},"destination.geo.location":{type:"geo_point",array:!1,required:!1},"destination.geo.name":{type:"keyword",array:!1,required:!1},"destination.geo.postal_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_name":{type:"keyword",array:!1,required:!1},"destination.geo.timezone":{type:"keyword",array:!1,required:!1},"destination.ip":{type:"ip",array:!1,required:!1},"destination.mac":{type:"keyword",array:!1,required:!1},"destination.nat.ip":{type:"ip",array:!1,required:!1},"destination.nat.port":{type:"long",array:!1,required:!1},"destination.packets":{type:"long",array:!1,required:!1},"destination.port":{type:"long",array:!1,required:!1},"destination.registered_domain":{type:"keyword",array:!1,required:!1},"destination.subdomain":{type:"keyword",array:!1,required:!1},"destination.top_level_domain":{type:"keyword",array:!1,required:!1},"destination.user.domain":{type:"keyword",array:!1,required:!1},"destination.user.email":{type:"keyword",array:!1,required:!1},"destination.user.full_name":{type:"keyword",array:!1,required:!1},"destination.user.group.domain":{type:"keyword",array:!1,required:!1},"destination.user.group.id":{type:"keyword",array:!1,required:!1},"destination.user.group.name":{type:"keyword",array:!1,required:!1},"destination.user.hash":{type:"keyword",array:!1,required:!1},"destination.user.id":{type:"keyword",array:!1,required:!1},"destination.user.name":{type:"keyword",array:!1,required:!1},"destination.user.roles":{type:"keyword",array:!0,required:!1},"dll.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"dll.code_signature.exists":{type:"boolean",array:!1,required:!1},"dll.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.status":{type:"keyword",array:!1,required:!1},"dll.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"dll.code_signature.team_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.timestamp":{type:"date",array:!1,required:!1},"dll.code_signature.trusted":{type:"boolean",array:!1,required:!1},"dll.code_signature.valid":{type:"boolean",array:!1,required:!1},"dll.hash.md5":{type:"keyword",array:!1,required:!1},"dll.hash.sha1":{type:"keyword",array:!1,required:!1},"dll.hash.sha256":{type:"keyword",array:!1,required:!1},"dll.hash.sha512":{type:"keyword",array:!1,required:!1},"dll.hash.ssdeep":{type:"keyword",array:!1,required:!1},"dll.name":{type:"keyword",array:!1,required:!1},"dll.path":{type:"keyword",array:!1,required:!1},"dll.pe.architecture":{type:"keyword",array:!1,required:!1},"dll.pe.company":{type:"keyword",array:!1,required:!1},"dll.pe.description":{type:"keyword",array:!1,required:!1},"dll.pe.file_version":{type:"keyword",array:!1,required:!1},"dll.pe.imphash":{type:"keyword",array:!1,required:!1},"dll.pe.original_file_name":{type:"keyword",array:!1,required:!1},"dll.pe.product":{type:"keyword",array:!1,required:!1},"dns.answers":{type:"object",array:!0,required:!1},"dns.answers.class":{type:"keyword",array:!1,required:!1},"dns.answers.data":{type:"keyword",array:!1,required:!1},"dns.answers.name":{type:"keyword",array:!1,required:!1},"dns.answers.ttl":{type:"long",array:!1,required:!1},"dns.answers.type":{type:"keyword",array:!1,required:!1},"dns.header_flags":{type:"keyword",array:!0,required:!1},"dns.id":{type:"keyword",array:!1,required:!1},"dns.op_code":{type:"keyword",array:!1,required:!1},"dns.question.class":{type:"keyword",array:!1,required:!1},"dns.question.name":{type:"keyword",array:!1,required:!1},"dns.question.registered_domain":{type:"keyword",array:!1,required:!1},"dns.question.subdomain":{type:"keyword",array:!1,required:!1},"dns.question.top_level_domain":{type:"keyword",array:!1,required:!1},"dns.question.type":{type:"keyword",array:!1,required:!1},"dns.resolved_ip":{type:"ip",array:!0,required:!1},"dns.response_code":{type:"keyword",array:!1,required:!1},"dns.type":{type:"keyword",array:!1,required:!1},"ecs.version":{type:"keyword",array:!1,required:!0},"error.code":{type:"keyword",array:!1,required:!1},"error.id":{type:"keyword",array:!1,required:!1},"error.message":{type:"match_only_text",array:!1,required:!1},"error.stack_trace":{type:"wildcard",array:!1,required:!1},"error.type":{type:"keyword",array:!1,required:!1},"event.action":{type:"keyword",array:!1,required:!1},"event.agent_id_status":{type:"keyword",array:!1,required:!1},"event.category":{type:"keyword",array:!0,required:!1},"event.code":{type:"keyword",array:!1,required:!1},"event.created":{type:"date",array:!1,required:!1},"event.dataset":{type:"keyword",array:!1,required:!1},"event.duration":{type:"long",array:!1,required:!1},"event.end":{type:"date",array:!1,required:!1},"event.hash":{type:"keyword",array:!1,required:!1},"event.id":{type:"keyword",array:!1,required:!1},"event.ingested":{type:"date",array:!1,required:!1},"event.kind":{type:"keyword",array:!1,required:!1},"event.module":{type:"keyword",array:!1,required:!1},"event.original":{type:"keyword",array:!1,required:!1},"event.outcome":{type:"keyword",array:!1,required:!1},"event.provider":{type:"keyword",array:!1,required:!1},"event.reason":{type:"keyword",array:!1,required:!1},"event.reference":{type:"keyword",array:!1,required:!1},"event.risk_score":{type:"float",array:!1,required:!1},"event.risk_score_norm":{type:"float",array:!1,required:!1},"event.sequence":{type:"long",array:!1,required:!1},"event.severity":{type:"long",array:!1,required:!1},"event.start":{type:"date",array:!1,required:!1},"event.timezone":{type:"keyword",array:!1,required:!1},"event.type":{type:"keyword",array:!0,required:!1},"event.url":{type:"keyword",array:!1,required:!1},"faas.coldstart":{type:"boolean",array:!1,required:!1},"faas.execution":{type:"keyword",array:!1,required:!1},"faas.trigger":{type:"nested",array:!1,required:!1},"faas.trigger.request_id":{type:"keyword",array:!1,required:!1},"faas.trigger.type":{type:"keyword",array:!1,required:!1},"file.accessed":{type:"date",array:!1,required:!1},"file.attributes":{type:"keyword",array:!0,required:!1},"file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"file.code_signature.exists":{type:"boolean",array:!1,required:!1},"file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"file.code_signature.status":{type:"keyword",array:!1,required:!1},"file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"file.code_signature.timestamp":{type:"date",array:!1,required:!1},"file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"file.code_signature.valid":{type:"boolean",array:!1,required:!1},"file.created":{type:"date",array:!1,required:!1},"file.ctime":{type:"date",array:!1,required:!1},"file.device":{type:"keyword",array:!1,required:!1},"file.directory":{type:"keyword",array:!1,required:!1},"file.drive_letter":{type:"keyword",array:!1,required:!1},"file.elf.architecture":{type:"keyword",array:!1,required:!1},"file.elf.byte_order":{type:"keyword",array:!1,required:!1},"file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"file.elf.creation_date":{type:"date",array:!1,required:!1},"file.elf.exports":{type:"flattened",array:!0,required:!1},"file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"file.elf.header.class":{type:"keyword",array:!1,required:!1},"file.elf.header.data":{type:"keyword",array:!1,required:!1},"file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"file.elf.header.type":{type:"keyword",array:!1,required:!1},"file.elf.header.version":{type:"keyword",array:!1,required:!1},"file.elf.imports":{type:"flattened",array:!0,required:!1},"file.elf.sections":{type:"nested",array:!0,required:!1},"file.elf.sections.chi2":{type:"long",array:!1,required:!1},"file.elf.sections.entropy":{type:"long",array:!1,required:!1},"file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"file.elf.sections.name":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"file.elf.sections.type":{type:"keyword",array:!1,required:!1},"file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"file.elf.segments":{type:"nested",array:!0,required:!1},"file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"file.elf.segments.type":{type:"keyword",array:!1,required:!1},"file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"file.elf.telfhash":{type:"keyword",array:!1,required:!1},"file.extension":{type:"keyword",array:!1,required:!1},"file.fork_name":{type:"keyword",array:!1,required:!1},"file.gid":{type:"keyword",array:!1,required:!1},"file.group":{type:"keyword",array:!1,required:!1},"file.hash.md5":{type:"keyword",array:!1,required:!1},"file.hash.sha1":{type:"keyword",array:!1,required:!1},"file.hash.sha256":{type:"keyword",array:!1,required:!1},"file.hash.sha512":{type:"keyword",array:!1,required:!1},"file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"file.inode":{type:"keyword",array:!1,required:!1},"file.mime_type":{type:"keyword",array:!1,required:!1},"file.mode":{type:"keyword",array:!1,required:!1},"file.mtime":{type:"date",array:!1,required:!1},"file.name":{type:"keyword",array:!1,required:!1},"file.owner":{type:"keyword",array:!1,required:!1},"file.path":{type:"keyword",array:!1,required:!1},"file.pe.architecture":{type:"keyword",array:!1,required:!1},"file.pe.company":{type:"keyword",array:!1,required:!1},"file.pe.description":{type:"keyword",array:!1,required:!1},"file.pe.file_version":{type:"keyword",array:!1,required:!1},"file.pe.imphash":{type:"keyword",array:!1,required:!1},"file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"file.pe.product":{type:"keyword",array:!1,required:!1},"file.size":{type:"long",array:!1,required:!1},"file.target_path":{type:"keyword",array:!1,required:!1},"file.type":{type:"keyword",array:!1,required:!1},"file.uid":{type:"keyword",array:!1,required:!1},"file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.not_after":{type:"date",array:!1,required:!1},"file.x509.not_before":{type:"date",array:!1,required:!1},"file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"file.x509.public_key_size":{type:"long",array:!1,required:!1},"file.x509.serial_number":{type:"keyword",array:!1,required:!1},"file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"file.x509.subject.country":{type:"keyword",array:!0,required:!1},"file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.version_number":{type:"keyword",array:!1,required:!1},"group.domain":{type:"keyword",array:!1,required:!1},"group.id":{type:"keyword",array:!1,required:!1},"group.name":{type:"keyword",array:!1,required:!1},"host.architecture":{type:"keyword",array:!1,required:!1},"host.boot.id":{type:"keyword",array:!1,required:!1},"host.cpu.usage":{type:"scaled_float",array:!1,required:!1,scaling_factor:1e3},"host.disk.read.bytes":{type:"long",array:!1,required:!1},"host.disk.write.bytes":{type:"long",array:!1,required:!1},"host.domain":{type:"keyword",array:!1,required:!1},"host.geo.city_name":{type:"keyword",array:!1,required:!1},"host.geo.continent_code":{type:"keyword",array:!1,required:!1},"host.geo.continent_name":{type:"keyword",array:!1,required:!1},"host.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.country_name":{type:"keyword",array:!1,required:!1},"host.geo.location":{type:"geo_point",array:!1,required:!1},"host.geo.name":{type:"keyword",array:!1,required:!1},"host.geo.postal_code":{type:"keyword",array:!1,required:!1},"host.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.region_name":{type:"keyword",array:!1,required:!1},"host.geo.timezone":{type:"keyword",array:!1,required:!1},"host.hostname":{type:"keyword",array:!1,required:!1},"host.id":{type:"keyword",array:!1,required:!1},"host.ip":{type:"ip",array:!0,required:!1},"host.mac":{type:"keyword",array:!0,required:!1},"host.name":{type:"keyword",array:!1,required:!1},"host.network.egress.bytes":{type:"long",array:!1,required:!1},"host.network.egress.packets":{type:"long",array:!1,required:!1},"host.network.ingress.bytes":{type:"long",array:!1,required:!1},"host.network.ingress.packets":{type:"long",array:!1,required:!1},"host.os.family":{type:"keyword",array:!1,required:!1},"host.os.full":{type:"keyword",array:!1,required:!1},"host.os.kernel":{type:"keyword",array:!1,required:!1},"host.os.name":{type:"keyword",array:!1,required:!1},"host.os.platform":{type:"keyword",array:!1,required:!1},"host.os.type":{type:"keyword",array:!1,required:!1},"host.os.version":{type:"keyword",array:!1,required:!1},"host.pid_ns_ino":{type:"keyword",array:!1,required:!1},"host.risk.calculated_level":{type:"keyword",array:!1,required:!1},"host.risk.calculated_score":{type:"float",array:!1,required:!1},"host.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"host.risk.static_level":{type:"keyword",array:!1,required:!1},"host.risk.static_score":{type:"float",array:!1,required:!1},"host.risk.static_score_norm":{type:"float",array:!1,required:!1},"host.type":{type:"keyword",array:!1,required:!1},"host.uptime":{type:"long",array:!1,required:!1},"http.request.body.bytes":{type:"long",array:!1,required:!1},"http.request.body.content":{type:"wildcard",array:!1,required:!1},"http.request.bytes":{type:"long",array:!1,required:!1},"http.request.id":{type:"keyword",array:!1,required:!1},"http.request.method":{type:"keyword",array:!1,required:!1},"http.request.mime_type":{type:"keyword",array:!1,required:!1},"http.request.referrer":{type:"keyword",array:!1,required:!1},"http.response.body.bytes":{type:"long",array:!1,required:!1},"http.response.body.content":{type:"wildcard",array:!1,required:!1},"http.response.bytes":{type:"long",array:!1,required:!1},"http.response.mime_type":{type:"keyword",array:!1,required:!1},"http.response.status_code":{type:"long",array:!1,required:!1},"http.version":{type:"keyword",array:!1,required:!1},labels:{type:"object",array:!1,required:!1},"log.file.path":{type:"keyword",array:!1,required:!1},"log.level":{type:"keyword",array:!1,required:!1},"log.logger":{type:"keyword",array:!1,required:!1},"log.origin.file.line":{type:"long",array:!1,required:!1},"log.origin.file.name":{type:"keyword",array:!1,required:!1},"log.origin.function":{type:"keyword",array:!1,required:!1},"log.syslog":{type:"object",array:!1,required:!1},"log.syslog.facility.code":{type:"long",array:!1,required:!1},"log.syslog.facility.name":{type:"keyword",array:!1,required:!1},"log.syslog.priority":{type:"long",array:!1,required:!1},"log.syslog.severity.code":{type:"long",array:!1,required:!1},"log.syslog.severity.name":{type:"keyword",array:!1,required:!1},message:{type:"match_only_text",array:!1,required:!1},"network.application":{type:"keyword",array:!1,required:!1},"network.bytes":{type:"long",array:!1,required:!1},"network.community_id":{type:"keyword",array:!1,required:!1},"network.direction":{type:"keyword",array:!1,required:!1},"network.forwarded_ip":{type:"ip",array:!1,required:!1},"network.iana_number":{type:"keyword",array:!1,required:!1},"network.inner":{type:"object",array:!1,required:!1},"network.inner.vlan.id":{type:"keyword",array:!1,required:!1},"network.inner.vlan.name":{type:"keyword",array:!1,required:!1},"network.name":{type:"keyword",array:!1,required:!1},"network.packets":{type:"long",array:!1,required:!1},"network.protocol":{type:"keyword",array:!1,required:!1},"network.transport":{type:"keyword",array:!1,required:!1},"network.type":{type:"keyword",array:!1,required:!1},"network.vlan.id":{type:"keyword",array:!1,required:!1},"network.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress":{type:"object",array:!1,required:!1},"observer.egress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.egress.interface.id":{type:"keyword",array:!1,required:!1},"observer.egress.interface.name":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress.zone":{type:"keyword",array:!1,required:!1},"observer.geo.city_name":{type:"keyword",array:!1,required:!1},"observer.geo.continent_code":{type:"keyword",array:!1,required:!1},"observer.geo.continent_name":{type:"keyword",array:!1,required:!1},"observer.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.country_name":{type:"keyword",array:!1,required:!1},"observer.geo.location":{type:"geo_point",array:!1,required:!1},"observer.geo.name":{type:"keyword",array:!1,required:!1},"observer.geo.postal_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_name":{type:"keyword",array:!1,required:!1},"observer.geo.timezone":{type:"keyword",array:!1,required:!1},"observer.hostname":{type:"keyword",array:!1,required:!1},"observer.ingress":{type:"object",array:!1,required:!1},"observer.ingress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.id":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.name":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.ingress.zone":{type:"keyword",array:!1,required:!1},"observer.ip":{type:"ip",array:!0,required:!1},"observer.mac":{type:"keyword",array:!0,required:!1},"observer.name":{type:"keyword",array:!1,required:!1},"observer.os.family":{type:"keyword",array:!1,required:!1},"observer.os.full":{type:"keyword",array:!1,required:!1},"observer.os.kernel":{type:"keyword",array:!1,required:!1},"observer.os.name":{type:"keyword",array:!1,required:!1},"observer.os.platform":{type:"keyword",array:!1,required:!1},"observer.os.type":{type:"keyword",array:!1,required:!1},"observer.os.version":{type:"keyword",array:!1,required:!1},"observer.product":{type:"keyword",array:!1,required:!1},"observer.serial_number":{type:"keyword",array:!1,required:!1},"observer.type":{type:"keyword",array:!1,required:!1},"observer.vendor":{type:"keyword",array:!1,required:!1},"observer.version":{type:"keyword",array:!1,required:!1},"orchestrator.api_version":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.id":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.name":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.url":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.version":{type:"keyword",array:!1,required:!1},"orchestrator.namespace":{type:"keyword",array:!1,required:!1},"orchestrator.organization":{type:"keyword",array:!1,required:!1},"orchestrator.resource.id":{type:"keyword",array:!1,required:!1},"orchestrator.resource.ip":{type:"ip",array:!0,required:!1},"orchestrator.resource.name":{type:"keyword",array:!1,required:!1},"orchestrator.resource.parent.type":{type:"keyword",array:!1,required:!1},"orchestrator.resource.type":{type:"keyword",array:!1,required:!1},"orchestrator.type":{type:"keyword",array:!1,required:!1},"organization.id":{type:"keyword",array:!1,required:!1},"organization.name":{type:"keyword",array:!1,required:!1},"package.architecture":{type:"keyword",array:!1,required:!1},"package.build_version":{type:"keyword",array:!1,required:!1},"package.checksum":{type:"keyword",array:!1,required:!1},"package.description":{type:"keyword",array:!1,required:!1},"package.install_scope":{type:"keyword",array:!1,required:!1},"package.installed":{type:"date",array:!1,required:!1},"package.license":{type:"keyword",array:!1,required:!1},"package.name":{type:"keyword",array:!1,required:!1},"package.path":{type:"keyword",array:!1,required:!1},"package.reference":{type:"keyword",array:!1,required:!1},"package.size":{type:"long",array:!1,required:!1},"package.type":{type:"keyword",array:!1,required:!1},"package.version":{type:"keyword",array:!1,required:!1},"process.args":{type:"keyword",array:!0,required:!1},"process.args_count":{type:"long",array:!1,required:!1},"process.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.code_signature.status":{type:"keyword",array:!1,required:!1},"process.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.command_line":{type:"wildcard",array:!1,required:!1},"process.elf.architecture":{type:"keyword",array:!1,required:!1},"process.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.elf.creation_date":{type:"date",array:!1,required:!1},"process.elf.exports":{type:"flattened",array:!0,required:!1},"process.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.elf.header.class":{type:"keyword",array:!1,required:!1},"process.elf.header.data":{type:"keyword",array:!1,required:!1},"process.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.elf.header.type":{type:"keyword",array:!1,required:!1},"process.elf.header.version":{type:"keyword",array:!1,required:!1},"process.elf.imports":{type:"flattened",array:!0,required:!1},"process.elf.sections":{type:"nested",array:!0,required:!1},"process.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.elf.segments":{type:"nested",array:!0,required:!1},"process.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.end":{type:"date",array:!1,required:!1},"process.entity_id":{type:"keyword",array:!1,required:!1},"process.entry_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.executable":{type:"keyword",array:!1,required:!1},"process.exit_code":{type:"long",array:!1,required:!1},"process.hash.md5":{type:"keyword",array:!1,required:!1},"process.hash.sha1":{type:"keyword",array:!1,required:!1},"process.hash.sha256":{type:"keyword",array:!1,required:!1},"process.hash.sha512":{type:"keyword",array:!1,required:!1},"process.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.name":{type:"keyword",array:!1,required:!1},"process.parent.args":{type:"keyword",array:!0,required:!1},"process.parent.args_count":{type:"long",array:!1,required:!1},"process.parent.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.status":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.parent.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.parent.command_line":{type:"wildcard",array:!1,required:!1},"process.parent.elf.architecture":{type:"keyword",array:!1,required:!1},"process.parent.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.parent.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.parent.elf.creation_date":{type:"date",array:!1,required:!1},"process.parent.elf.exports":{type:"flattened",array:!0,required:!1},"process.parent.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.class":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.data":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.parent.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.version":{type:"keyword",array:!1,required:!1},"process.parent.elf.imports":{type:"flattened",array:!0,required:!1},"process.parent.elf.sections":{type:"nested",array:!0,required:!1},"process.parent.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.parent.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.parent.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.parent.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.parent.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.parent.elf.segments":{type:"nested",array:!0,required:!1},"process.parent.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.parent.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.parent.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.parent.end":{type:"date",array:!1,required:!1},"process.parent.entity_id":{type:"keyword",array:!1,required:!1},"process.parent.executable":{type:"keyword",array:!1,required:!1},"process.parent.exit_code":{type:"long",array:!1,required:!1},"process.parent.hash.md5":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha1":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha256":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha512":{type:"keyword",array:!1,required:!1},"process.parent.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.parent.name":{type:"keyword",array:!1,required:!1},"process.parent.pe.architecture":{type:"keyword",array:!1,required:!1},"process.parent.pe.company":{type:"keyword",array:!1,required:!1},"process.parent.pe.description":{type:"keyword",array:!1,required:!1},"process.parent.pe.file_version":{type:"keyword",array:!1,required:!1},"process.parent.pe.imphash":{type:"keyword",array:!1,required:!1},"process.parent.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.parent.pe.product":{type:"keyword",array:!1,required:!1},"process.parent.pgid":{type:"long",array:!1,required:!1},"process.parent.pid":{type:"long",array:!1,required:!1},"process.parent.start":{type:"date",array:!1,required:!1},"process.parent.thread.id":{type:"long",array:!1,required:!1},"process.parent.thread.name":{type:"keyword",array:!1,required:!1},"process.parent.title":{type:"keyword",array:!1,required:!1},"process.parent.uptime":{type:"long",array:!1,required:!1},"process.parent.working_directory":{type:"keyword",array:!1,required:!1},"process.pe.architecture":{type:"keyword",array:!1,required:!1},"process.pe.company":{type:"keyword",array:!1,required:!1},"process.pe.description":{type:"keyword",array:!1,required:!1},"process.pe.file_version":{type:"keyword",array:!1,required:!1},"process.pe.imphash":{type:"keyword",array:!1,required:!1},"process.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.pe.product":{type:"keyword",array:!1,required:!1},"process.pgid":{type:"long",array:!1,required:!1},"process.pid":{type:"long",array:!1,required:!1},"process.session_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.start":{type:"date",array:!1,required:!1},"process.thread.id":{type:"long",array:!1,required:!1},"process.thread.name":{type:"keyword",array:!1,required:!1},"process.title":{type:"keyword",array:!1,required:!1},"process.uptime":{type:"long",array:!1,required:!1},"process.working_directory":{type:"keyword",array:!1,required:!1},"registry.data.bytes":{type:"keyword",array:!1,required:!1},"registry.data.strings":{type:"wildcard",array:!0,required:!1},"registry.data.type":{type:"keyword",array:!1,required:!1},"registry.hive":{type:"keyword",array:!1,required:!1},"registry.key":{type:"keyword",array:!1,required:!1},"registry.path":{type:"keyword",array:!1,required:!1},"registry.value":{type:"keyword",array:!1,required:!1},"related.hash":{type:"keyword",array:!0,required:!1},"related.hosts":{type:"keyword",array:!0,required:!1},"related.ip":{type:"ip",array:!0,required:!1},"related.user":{type:"keyword",array:!0,required:!1},"rule.author":{type:"keyword",array:!0,required:!1},"rule.category":{type:"keyword",array:!1,required:!1},"rule.description":{type:"keyword",array:!1,required:!1},"rule.id":{type:"keyword",array:!1,required:!1},"rule.license":{type:"keyword",array:!1,required:!1},"rule.name":{type:"keyword",array:!1,required:!1},"rule.reference":{type:"keyword",array:!1,required:!1},"rule.ruleset":{type:"keyword",array:!1,required:!1},"rule.uuid":{type:"keyword",array:!1,required:!1},"rule.version":{type:"keyword",array:!1,required:!1},"server.address":{type:"keyword",array:!1,required:!1},"server.as.number":{type:"long",array:!1,required:!1},"server.as.organization.name":{type:"keyword",array:!1,required:!1},"server.bytes":{type:"long",array:!1,required:!1},"server.domain":{type:"keyword",array:!1,required:!1},"server.geo.city_name":{type:"keyword",array:!1,required:!1},"server.geo.continent_code":{type:"keyword",array:!1,required:!1},"server.geo.continent_name":{type:"keyword",array:!1,required:!1},"server.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.country_name":{type:"keyword",array:!1,required:!1},"server.geo.location":{type:"geo_point",array:!1,required:!1},"server.geo.name":{type:"keyword",array:!1,required:!1},"server.geo.postal_code":{type:"keyword",array:!1,required:!1},"server.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.region_name":{type:"keyword",array:!1,required:!1},"server.geo.timezone":{type:"keyword",array:!1,required:!1},"server.ip":{type:"ip",array:!1,required:!1},"server.mac":{type:"keyword",array:!1,required:!1},"server.nat.ip":{type:"ip",array:!1,required:!1},"server.nat.port":{type:"long",array:!1,required:!1},"server.packets":{type:"long",array:!1,required:!1},"server.port":{type:"long",array:!1,required:!1},"server.registered_domain":{type:"keyword",array:!1,required:!1},"server.subdomain":{type:"keyword",array:!1,required:!1},"server.top_level_domain":{type:"keyword",array:!1,required:!1},"server.user.domain":{type:"keyword",array:!1,required:!1},"server.user.email":{type:"keyword",array:!1,required:!1},"server.user.full_name":{type:"keyword",array:!1,required:!1},"server.user.group.domain":{type:"keyword",array:!1,required:!1},"server.user.group.id":{type:"keyword",array:!1,required:!1},"server.user.group.name":{type:"keyword",array:!1,required:!1},"server.user.hash":{type:"keyword",array:!1,required:!1},"server.user.id":{type:"keyword",array:!1,required:!1},"server.user.name":{type:"keyword",array:!1,required:!1},"server.user.roles":{type:"keyword",array:!0,required:!1},"service.address":{type:"keyword",array:!1,required:!1},"service.environment":{type:"keyword",array:!1,required:!1},"service.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.id":{type:"keyword",array:!1,required:!1},"service.name":{type:"keyword",array:!1,required:!1},"service.node.name":{type:"keyword",array:!1,required:!1},"service.origin.address":{type:"keyword",array:!1,required:!1},"service.origin.environment":{type:"keyword",array:!1,required:!1},"service.origin.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.origin.id":{type:"keyword",array:!1,required:!1},"service.origin.name":{type:"keyword",array:!1,required:!1},"service.origin.node.name":{type:"keyword",array:!1,required:!1},"service.origin.state":{type:"keyword",array:!1,required:!1},"service.origin.type":{type:"keyword",array:!1,required:!1},"service.origin.version":{type:"keyword",array:!1,required:!1},"service.state":{type:"keyword",array:!1,required:!1},"service.target.address":{type:"keyword",array:!1,required:!1},"service.target.environment":{type:"keyword",array:!1,required:!1},"service.target.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.target.id":{type:"keyword",array:!1,required:!1},"service.target.name":{type:"keyword",array:!1,required:!1},"service.target.node.name":{type:"keyword",array:!1,required:!1},"service.target.state":{type:"keyword",array:!1,required:!1},"service.target.type":{type:"keyword",array:!1,required:!1},"service.target.version":{type:"keyword",array:!1,required:!1},"service.type":{type:"keyword",array:!1,required:!1},"service.version":{type:"keyword",array:!1,required:!1},"source.address":{type:"keyword",array:!1,required:!1},"source.as.number":{type:"long",array:!1,required:!1},"source.as.organization.name":{type:"keyword",array:!1,required:!1},"source.bytes":{type:"long",array:!1,required:!1},"source.domain":{type:"keyword",array:!1,required:!1},"source.geo.city_name":{type:"keyword",array:!1,required:!1},"source.geo.continent_code":{type:"keyword",array:!1,required:!1},"source.geo.continent_name":{type:"keyword",array:!1,required:!1},"source.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.country_name":{type:"keyword",array:!1,required:!1},"source.geo.location":{type:"geo_point",array:!1,required:!1},"source.geo.name":{type:"keyword",array:!1,required:!1},"source.geo.postal_code":{type:"keyword",array:!1,required:!1},"source.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.region_name":{type:"keyword",array:!1,required:!1},"source.geo.timezone":{type:"keyword",array:!1,required:!1},"source.ip":{type:"ip",array:!1,required:!1},"source.mac":{type:"keyword",array:!1,required:!1},"source.nat.ip":{type:"ip",array:!1,required:!1},"source.nat.port":{type:"long",array:!1,required:!1},"source.packets":{type:"long",array:!1,required:!1},"source.port":{type:"long",array:!1,required:!1},"source.registered_domain":{type:"keyword",array:!1,required:!1},"source.subdomain":{type:"keyword",array:!1,required:!1},"source.top_level_domain":{type:"keyword",array:!1,required:!1},"source.user.domain":{type:"keyword",array:!1,required:!1},"source.user.email":{type:"keyword",array:!1,required:!1},"source.user.full_name":{type:"keyword",array:!1,required:!1},"source.user.group.domain":{type:"keyword",array:!1,required:!1},"source.user.group.id":{type:"keyword",array:!1,required:!1},"source.user.group.name":{type:"keyword",array:!1,required:!1},"source.user.hash":{type:"keyword",array:!1,required:!1},"source.user.id":{type:"keyword",array:!1,required:!1},"source.user.name":{type:"keyword",array:!1,required:!1},"source.user.roles":{type:"keyword",array:!0,required:!1},"span.id":{type:"keyword",array:!1,required:!1},tags:{type:"keyword",array:!0,required:!1},"threat.enrichments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator":{type:"object",array:!1,required:!1},"threat.enrichments.indicator.as.number":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.created":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.enrichments.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.ip":{type:"ip",array:!1,required:!1},"threat.enrichments.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.enrichments.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.sightings":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.atomic":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.field":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.id":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.index":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.type":{type:"keyword",array:!1,required:!1},"threat.framework":{type:"keyword",array:!1,required:!1},"threat.group.alias":{type:"keyword",array:!0,required:!1},"threat.group.id":{type:"keyword",array:!1,required:!1},"threat.group.name":{type:"keyword",array:!1,required:!1},"threat.group.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.as.number":{type:"long",array:!1,required:!1},"threat.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.indicator.description":{type:"keyword",array:!1,required:!1},"threat.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.indicator.file.created":{type:"date",array:!1,required:!1},"threat.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.indicator.file.size":{type:"long",array:!1,required:!1},"threat.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.indicator.ip":{type:"ip",array:!1,required:!1},"threat.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.indicator.port":{type:"long",array:!1,required:!1},"threat.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.indicator.sightings":{type:"long",array:!1,required:!1},"threat.indicator.type":{type:"keyword",array:!1,required:!1},"threat.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.port":{type:"long",array:!1,required:!1},"threat.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.software.alias":{type:"keyword",array:!0,required:!1},"threat.software.id":{type:"keyword",array:!1,required:!1},"threat.software.name":{type:"keyword",array:!1,required:!1},"threat.software.platforms":{type:"keyword",array:!0,required:!1},"threat.software.reference":{type:"keyword",array:!1,required:!1},"threat.software.type":{type:"keyword",array:!1,required:!1},"threat.tactic.id":{type:"keyword",array:!0,required:!1},"threat.tactic.name":{type:"keyword",array:!0,required:!1},"threat.tactic.reference":{type:"keyword",array:!0,required:!1},"threat.technique.id":{type:"keyword",array:!0,required:!1},"threat.technique.name":{type:"keyword",array:!0,required:!1},"threat.technique.reference":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.id":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.name":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.reference":{type:"keyword",array:!0,required:!1},"tls.cipher":{type:"keyword",array:!1,required:!1},"tls.client.certificate":{type:"keyword",array:!1,required:!1},"tls.client.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.client.hash.md5":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.client.issuer":{type:"keyword",array:!1,required:!1},"tls.client.ja3":{type:"keyword",array:!1,required:!1},"tls.client.not_after":{type:"date",array:!1,required:!1},"tls.client.not_before":{type:"date",array:!1,required:!1},"tls.client.server_name":{type:"keyword",array:!1,required:!1},"tls.client.subject":{type:"keyword",array:!1,required:!1},"tls.client.supported_ciphers":{type:"keyword",array:!0,required:!1},"tls.client.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.not_after":{type:"date",array:!1,required:!1},"tls.client.x509.not_before":{type:"date",array:!1,required:!1},"tls.client.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.client.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.client.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.client.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.curve":{type:"keyword",array:!1,required:!1},"tls.established":{type:"boolean",array:!1,required:!1},"tls.next_protocol":{type:"keyword",array:!1,required:!1},"tls.resumed":{type:"boolean",array:!1,required:!1},"tls.server.certificate":{type:"keyword",array:!1,required:!1},"tls.server.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.server.hash.md5":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.server.issuer":{type:"keyword",array:!1,required:!1},"tls.server.ja3s":{type:"keyword",array:!1,required:!1},"tls.server.not_after":{type:"date",array:!1,required:!1},"tls.server.not_before":{type:"date",array:!1,required:!1},"tls.server.subject":{type:"keyword",array:!1,required:!1},"tls.server.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.not_after":{type:"date",array:!1,required:!1},"tls.server.x509.not_before":{type:"date",array:!1,required:!1},"tls.server.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.server.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.server.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.server.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.version":{type:"keyword",array:!1,required:!1},"tls.version_protocol":{type:"keyword",array:!1,required:!1},"trace.id":{type:"keyword",array:!1,required:!1},"transaction.id":{type:"keyword",array:!1,required:!1},"url.domain":{type:"keyword",array:!1,required:!1},"url.extension":{type:"keyword",array:!1,required:!1},"url.fragment":{type:"keyword",array:!1,required:!1},"url.full":{type:"wildcard",array:!1,required:!1},"url.original":{type:"wildcard",array:!1,required:!1},"url.password":{type:"keyword",array:!1,required:!1},"url.path":{type:"wildcard",array:!1,required:!1},"url.port":{type:"long",array:!1,required:!1},"url.query":{type:"keyword",array:!1,required:!1},"url.registered_domain":{type:"keyword",array:!1,required:!1},"url.scheme":{type:"keyword",array:!1,required:!1},"url.subdomain":{type:"keyword",array:!1,required:!1},"url.top_level_domain":{type:"keyword",array:!1,required:!1},"url.username":{type:"keyword",array:!1,required:!1},"user.changes.domain":{type:"keyword",array:!1,required:!1},"user.changes.email":{type:"keyword",array:!1,required:!1},"user.changes.full_name":{type:"keyword",array:!1,required:!1},"user.changes.group.domain":{type:"keyword",array:!1,required:!1},"user.changes.group.id":{type:"keyword",array:!1,required:!1},"user.changes.group.name":{type:"keyword",array:!1,required:!1},"user.changes.hash":{type:"keyword",array:!1,required:!1},"user.changes.id":{type:"keyword",array:!1,required:!1},"user.changes.name":{type:"keyword",array:!1,required:!1},"user.changes.roles":{type:"keyword",array:!0,required:!1},"user.domain":{type:"keyword",array:!1,required:!1},"user.effective.domain":{type:"keyword",array:!1,required:!1},"user.effective.email":{type:"keyword",array:!1,required:!1},"user.effective.full_name":{type:"keyword",array:!1,required:!1},"user.effective.group.domain":{type:"keyword",array:!1,required:!1},"user.effective.group.id":{type:"keyword",array:!1,required:!1},"user.effective.group.name":{type:"keyword",array:!1,required:!1},"user.effective.hash":{type:"keyword",array:!1,required:!1},"user.effective.id":{type:"keyword",array:!1,required:!1},"user.effective.name":{type:"keyword",array:!1,required:!1},"user.effective.roles":{type:"keyword",array:!0,required:!1},"user.email":{type:"keyword",array:!1,required:!1},"user.full_name":{type:"keyword",array:!1,required:!1},"user.group.domain":{type:"keyword",array:!1,required:!1},"user.group.id":{type:"keyword",array:!1,required:!1},"user.group.name":{type:"keyword",array:!1,required:!1},"user.hash":{type:"keyword",array:!1,required:!1},"user.id":{type:"keyword",array:!1,required:!1},"user.name":{type:"keyword",array:!1,required:!1},"user.risk.calculated_level":{type:"keyword",array:!1,required:!1},"user.risk.calculated_score":{type:"float",array:!1,required:!1},"user.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"user.risk.static_level":{type:"keyword",array:!1,required:!1},"user.risk.static_score":{type:"float",array:!1,required:!1},"user.risk.static_score_norm":{type:"float",array:!1,required:!1},"user.roles":{type:"keyword",array:!0,required:!1},"user.target.domain":{type:"keyword",array:!1,required:!1},"user.target.email":{type:"keyword",array:!1,required:!1},"user.target.full_name":{type:"keyword",array:!1,required:!1},"user.target.group.domain":{type:"keyword",array:!1,required:!1},"user.target.group.id":{type:"keyword",array:!1,required:!1},"user.target.group.name":{type:"keyword",array:!1,required:!1},"user.target.hash":{type:"keyword",array:!1,required:!1},"user.target.id":{type:"keyword",array:!1,required:!1},"user.target.name":{type:"keyword",array:!1,required:!1},"user.target.roles":{type:"keyword",array:!0,required:!1},"user_agent.device.name":{type:"keyword",array:!1,required:!1},"user_agent.name":{type:"keyword",array:!1,required:!1},"user_agent.original":{type:"keyword",array:!1,required:!1},"user_agent.os.family":{type:"keyword",array:!1,required:!1},"user_agent.os.full":{type:"keyword",array:!1,required:!1},"user_agent.os.kernel":{type:"keyword",array:!1,required:!1},"user_agent.os.name":{type:"keyword",array:!1,required:!1},"user_agent.os.platform":{type:"keyword",array:!1,required:!1},"user_agent.os.type":{type:"keyword",array:!1,required:!1},"user_agent.os.version":{type:"keyword",array:!1,required:!1},"user_agent.version":{type:"keyword",array:!1,required:!1},"vulnerability.category":{type:"keyword",array:!0,required:!1},"vulnerability.classification":{type:"keyword",array:!1,required:!1},"vulnerability.description":{type:"keyword",array:!1,required:!1},"vulnerability.enumeration":{type:"keyword",array:!1,required:!1},"vulnerability.id":{type:"keyword",array:!1,required:!1},"vulnerability.reference":{type:"keyword",array:!1,required:!1},"vulnerability.report_id":{type:"keyword",array:!1,required:!1},"vulnerability.scanner.vendor":{type:"keyword",array:!1,required:!1},"vulnerability.score.base":{type:"float",array:!1,required:!1},"vulnerability.score.environmental":{type:"float",array:!1,required:!1},"vulnerability.score.temporal":{type:"float",array:!1,required:!1},"vulnerability.score.version":{type:"keyword",array:!1,required:!1},"vulnerability.severity":{type:"keyword",array:!1,required:!1}};var r=n(1341);const o={[r.c]:{type:"scaled_float",scaling_factor:100,required:!1},[r.d]:{type:"scaled_float",scaling_factor:100,required:!1},[r.b]:{type:"object",array:!1,required:!1},[r.e]:{type:"scaled_float",scaling_factor:100,required:!1,array:!0},[r.f]:{type:"object",array:!0,required:!1},[r.g]:{type:"keyword",array:!0,required:!1},[r.h]:{type:"keyword",array:!0,required:!1}};var s=n(748),l=n(813);const c={[s.a]:{type:"keyword",array:!1,required:!1},[s.b]:{type:"keyword",array:!0,required:!1},[s.d]:{type:"long",array:!1,required:!1},[s.e]:{type:"date",array:!1,required:!1},[s.f]:{type:"boolean",array:!1,required:!1},[s.g]:{type:"boolean",array:!0,required:!1},[s.j]:{type:"keyword",array:!0,required:!1},[s.c]:{type:"long",array:!1,required:!1},[s.h]:{type:"keyword",array:!1,required:!0},[s.i]:{type:"date",required:!1,array:!1},[s.l]:{type:"keyword",array:!1,required:!1},[s.m]:{type:"keyword",array:!1,required:!1,multi_fields:[{flat_name:`${s.m}.text`,name:"text",type:"match_only_text"}]},[s.n]:{type:"keyword",array:!1,required:!0},[s.o]:{type:"keyword",array:!1,required:!0},[s.p]:{type:"date",array:!1,required:!1},[s.q]:{type:"keyword",array:!1,required:!1},[s.r]:{type:"keyword",array:!1,required:!0},[s.t]:{array:!1,type:"flattened",ignore_above:4096,required:!1},[s.u]:{type:"keyword",array:!1,required:!0},[s.v]:{type:"long",array:!1,required:!0},[s.w]:{type:"keyword",array:!0,required:!1},[s.x]:{type:"keyword",array:!1,required:!0},[s.y]:{type:"keyword",array:!1,required:!0},[s.z]:{type:"boolean",array:!1,required:!1},[s.A]:{type:"date",array:!1,required:!1},[s.B]:{type:"keyword",array:!1,required:!0},[s.C]:{type:"date_range",format:"epoch_millis||strict_date_optional_time",array:!1,required:!1},[s.D]:{type:"keyword",array:!1,index:!1,required:!1,ignore_above:2048},[s.E]:{type:"keyword",array:!1,required:!0},[s.G]:{type:"keyword",array:!1,required:!1},[s.H]:{type:"keyword",array:!0,required:!1},[s.F]:{type:"keyword",array:!0,required:!1},[l.E]:{type:"keyword",array:!1,required:!1},[l.F]:{type:"keyword",array:!1,required:!1},[s.J]:{type:"keyword",array:!0,required:!0},[l.G]:{type:"keyword",array:!0,required:!1},[s.K]:{type:"date",required:!0,array:!1},[s.L]:{type:"version",array:!1,required:!1}},u={[l.a]:{type:"float",array:!1,required:!1},[l.b]:{type:"keyword",array:!1,required:!1},[l.c]:{type:"date",array:!1,required:!1},[l.d]:{type:"keyword",array:!1,required:!1},[l.e]:{type:"keyword",array:!1,required:!1},[l.f]:{type:"keyword",array:!1,required:!1},[l.g]:{type:"keyword",array:!1,required:!1},[l.h]:{type:"keyword",array:!1,required:!1},[l.i]:{type:"keyword",array:!1,required:!1},[l.j]:{type:"keyword",array:!1,required:!1},[l.k]:{type:"keyword",array:!0,required:!1},[l.l]:{type:"keyword",array:!1,required:!1},[l.m]:{type:"keyword",array:!1,required:!1},[l.n]:{type:"keyword",array:!1,required:!1},[l.o]:{type:"keyword",array:!1,required:!1},[l.p]:{type:"date",array:!1,required:!1},[l.q]:{type:"keyword",array:!1,required:!1},[l.r]:{type:"keyword",array:!1,required:!1},[l.s]:{type:"keyword",array:!1,required:!1},[l.t]:{type:"long",array:!1,required:!1},[l.u]:{type:"date",array:!1,required:!1},[l.v]:{type:"keyword",array:!0,required:!1},[l.w]:{type:"date",array:!1,required:!1},[l.y]:{type:"keyword",array:!0,required:!1},[l.z]:{type:"keyword",array:!1,required:!1},[l.A]:{type:"keyword",array:!1,required:!1},[l.C]:{type:"keyword",array:!1,required:!1},[l.B]:{type:"date",array:!1,required:!1},[l.D]:{type:"keyword",array:!1,required:!1}};function d(e,...t){const n=Object.keys(e).filter((e=>t.some((t=>{if(t===e)return!0;const n=e.split("."),a=t.split(".");return a.indexOf("*")===a.length-1&&n.every(((e,t)=>{const n=a.length-1<t?"*":a[t];return e===n||"*"===n}))}))));return Object(a.pick)(e,n)}const p={...d(c,"*"),...d(u,"*")};var m=n(44),f=n(5);const g=e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,t.toString()];case"object":try{return[...e,JSON.stringify(t)]}catch{return[...e,"Invalid Object"]}case"string":return[...e,t];default:return[...e,`${t}`]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[`${e}`];try{return[JSON.stringify(e)]}catch{return["Invalid Object"]}},b=["@timestamp","labels","message","tags"],y=e=>{const t=e.length>0?e[0]:null;if(null!=t&&!Object(m.isEmpty)(t.coordinates))try{return g({lon:t.coordinates[0],lat:t.coordinates[1]})}catch{return g(e)}return g(e)},h=(e,t,n)=>Object.keys(e).reduce(((a,r)=>{const s=e[r],l=null!=n?n:(e=>{const t=e.split(".")[0];return!Object(m.isEmpty)(t)&&b.includes(t)?"base":t})(r);if((e=>e.includes("geo.location")||e.includes("geoip.location"))(r))return[...a,{category:l,field:r,values:y(s),originalValue:y(s),isObjectArray:!0}];const c=(e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,{str:t.toString()}];case"object":try{return[...e,{str:JSON.stringify(t),isObjectArray:!0}]}catch{return[...e,{str:"Invalid Object"}]}case"string":return[...e,{str:t}];default:return[...e,{str:`${t}`}]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[{str:`${e}`}];try{return[{str:JSON.stringify(e),isObjectArray:!0}]}catch{return[{str:"Invalid Object"}]}})(s),u=c.map((({str:e})=>e)),d=c.some((e=>e.isObjectArray)),g=t?`${t}.${r}`:r;if(!d||void 0===Object.keys({...i,...p,...o}).find((e=>e===r)))return[...a,{category:l,field:g,values:u,originalValue:u,isObjectArray:d}];const v=((e,t)=>(null==t?void 0:t.includes(f.yb))||e===f.yb)(r,t)?[{category:l,field:g,values:u,originalValue:u,isObjectArray:d}]:[],E=Array.isArray(s)?s.reduce(((e,t)=>[...e,h(t,g,l)]),[]).flat():h(s,t,l),x=[...a,...E,...v].reduce(((e,t)=>({...e,...null!=e[t.field]?{[t.field]:{...t,originalValue:e[t.field].originalValue.includes(t.originalValue[0])?e[t.field].originalValue:[...e[t.field].originalValue,...t.originalValue],values:e[t.field].values.includes(t.values[0])?e[t.field].values:[...e[t.field].values,...t.values]}}:{[t.field]:t}})),{});return Object.values(x)}),[]);var v=n(195),E=n(797);const x=e=>e?e[0]:void 0;var j=n(244);const S=e=>e===v.c.InvestigationTime,O=e=>{const t=e.find((({field:e,originalValue:t})=>e===f.yb&&t));if(!t)return[];const{originalValue:n}=t;return(Array.isArray(n)?n:[n]).reduce(((e,t)=>{try{const n=h(JSON.parse(t));e.push(n)}catch(e){}return e}),[])},k=e=>e.reduce(((e,t)=>(e[t.field]=t.originalValue,e)),{}),w=(e,t)=>x(e[t]),T=(e,t)=>w(e,t)||w(e,`threatintel.${t}`)||w(e,`threat.${t}`),I=e=>({id:w(e,v.m),field:w(e,v.l),value:w(e,v.k),type:w(e,v.n),feedName:T(e,v.e)}),M=e=>{const{id:t,field:n}=I(e);return`${t}${n}`},C=e=>{if(e.length<2)return e;const t=Object(a.groupBy)(e,M);return Object.values(t).map((e=>{var t;return null!==(t=e.find((e=>!S(w(e,v.n)))))&&void 0!==t?t:e[0]}))},_=e=>e.reduce(((e,t)=>{if(Object(E.b)(t.field)){const n=x(t.originalValue);if(n)return{...e,[t.field]:n}}return e}),{}),D=e=>{const t=T(e,v.f),n=Date.parse(null!=t?t:"no date");return Number.isInteger(n)?n:new Date(-1).valueOf()},A=e=>Object.keys(e).sort().map((t=>{const n=t.startsWith(f.P)?t.replace(`${f.P}`,"indicator"):t;let i=x(e[t]);return Object(a.isObject)(i)&&(i=j.k),{title:n,description:{fieldName:t,value:i}}}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),i=n(444),r=n(2),o=n.n(r),s=n(41),l=n.n(s);const c=l.a.aside.withConfig({displayName:"Aside",componentId:"sc-tazcmx-0"})(["padding:",";",""],(({theme:e})=>e.eui.euiSizeM),(({overlay:e,overlayBackground:t,theme:n})=>e&&Object(s.css)(["background:",";bottom:0;left:0;position:absolute;right:0;top:0;z-index:",";"],t?Object(i.rgba)(t,.9):Object(i.rgba)(n.eui.euiColorEmptyShade,.9),n.eui.euiZLevel1)));c.displayName="Aside";const u=l()(a.EuiFlexGroup).attrs((()=>({alignItems:"center",direction:"column",gutterSize:"s",justifyContent:"center"}))).withConfig({displayName:"FlexGroup",componentId:"sc-tazcmx-1"})(["",""],(({overlay:e})=>e&&Object(s.css)(["height:100%;"])));u.displayName="FlexGroup";const d=o.a.memo((({children:e,overlay:t,overlayBackground:n,size:i})=>o.a.createElement(c,{overlay:t,overlayBackground:n},o.a.createElement(u,{overlay:{overlay:t}},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:i})),e&&o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiText,{color:"subdued",size:"s"},o.a.createElement("p",null,e)))))));d.displayName="Loader"},function(e,t,n){"use strict";n.d(t,"i",(function(){return O})),n.d(t,"j",(function(){return k})),n.d(t,"k",(function(){return w})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return T})),n.d(t,"f",(function(){return h.a})),n.d(t,"g",(function(){return h.b})),n.d(t,"h",(function(){return E})),n.d(t,"a",(function(){return I}));var a=n(46),i=n(1531);let r=function(e){return e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range",e}({}),o=function(e){return e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month",e}({});const s=a.union([a.exact(a.type({type:a.literal(r.last_hour),granularity:a.literal(o.minute)})),a.exact(a.type({type:a.literal(r.last_day),granularity:a.union([a.literal(o.minute),a.literal(o.hour)])})),a.exact(a.type({type:a.literal(r.last_week),granularity:a.union([a.literal(o.hour),a.literal(o.day)])})),a.exact(a.type({type:a.literal(r.last_month),granularity:a.union([a.literal(o.day),a.literal(o.week)])})),a.exact(a.type({type:a.literal(r.last_year),granularity:a.union([a.literal(o.week),a.literal(o.month)])})),a.exact(a.type({type:a.literal(r.custom_range),granularity:a.union([a.literal(o.minute),a.literal(o.hour),a.literal(o.day),a.literal(o.week),a.literal(o.month)]),from:i.a,to:i.a}))]);a.exact(a.partial({interval:s,debug:a.boolean}));var l=n(1371);a.exact(a.intersection([a.type({rule_id:l.a}),a.partial({interval:s,debug:a.boolean})])),a.exact(a.partial({interval:s,debug:a.boolean})),a.exact(a.type({}));var c=n(120),u=n(1449);const d=c.z.enum(["trace","debug","info","warn","error"]),p=d.enum,m=c.z.enum(["message","status-change","execution-metrics"]),f=m.enum,g=c.z.object({timestamp:c.z.string().datetime(),sequence:c.z.number().int(),level:d,type:m,execution_id:c.z.string().min(1),message:c.z.string()});var b=n(330),y=n(471);c.z.object({search_term:c.z.string().optional(),event_types:Object(u.a)(m).optional().default([]),log_levels:Object(u.a)(d).optional().default([]),date_start:c.z.string().datetime().optional(),date_end:c.z.string().datetime().optional(),sort_order:b.a.optional().default("desc"),page:c.z.coerce.number().int().optional().default(1),per_page:c.z.coerce.number().int().optional().default(20)}),c.z.object({ruleId:c.z.string().min(1)}),c.z.object({events:c.z.array(g),pagination:y.a});var h=n(281);const v=c.z.enum(["backfill","standard"]),E=v.enum,x=c.z.object({execution_uuid:c.z.string(),timestamp:c.z.string().datetime(),duration_ms:c.z.number().int(),status:c.z.string(),message:c.z.string(),num_active_alerts:c.z.number().int(),num_new_alerts:c.z.number().int(),num_recovered_alerts:c.z.number().int(),num_triggered_actions:c.z.number().int(),num_succeeded_actions:c.z.number().int(),num_errored_actions:c.z.number().int(),total_search_duration_ms:c.z.number().int(),es_search_duration_ms:c.z.number().int(),schedule_delay_ms:c.z.number().int(),timed_out:c.z.boolean(),indexing_duration_ms:c.z.number().int(),search_duration_ms:c.z.number().int(),gap_duration_s:c.z.number().int(),security_status:c.z.string(),security_message:c.z.string(),backfill:c.z.object({from:c.z.string().datetime(),to:c.z.string().datetime()}).optional()}),j=c.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);j.enum,c.z.object({start:c.z.string().datetime(),end:c.z.string().datetime(),query_text:c.z.string().optional().default(""),status_filters:Object(u.a)(h.a).optional().default([]),run_type_filters:Object(u.a)(v).optional().default([]),sort_field:j.optional().default("timestamp"),sort_order:b.a.optional().default("desc"),page:c.z.coerce.number().int().optional().default(1),per_page:c.z.coerce.number().int().optional().default(20)}),c.z.object({ruleId:c.z.string().min(1)}),c.z.object({events:c.z.array(x).optional(),total:c.z.number().int().optional()});var S=n(5);S.Lb,S.Lb,S.Lb;const O=`${S.Lb}/health/_setup`,k=(S.Lb,e=>`${S.Lb}/rules/${e}/execution/events`),w=(S.Lb,e=>`${S.Lb}/rules/${e}/execution/results`);n(465);let T=function(e){return e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off",e}({});n(227),n(464);const I=d.options},function(e,t,n){"use strict";n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return k})),n.d(t,"e",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"f",(function(){return P})),n.d(t,"i",(function(){return B})),n.d(t,"g",(function(){return M})),n.d(t,"h",(function(){return C})),n.d(t,"b",(function(){return $.a}));var a=n(2),i=n.n(a),r=n(19),o=n(42),s=n(4);const l=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.cancel",{defaultMessage:"Cancel"}),c=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.confirm",{defaultMessage:"Confirm"}),u=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment",{defaultMessage:"Comment"}),d=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment.placeholder",{defaultMessage:"You may leave an optional note here."}),p=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolation.successfulMessage",{defaultMessage:"Isolation on host {hostName} successfully submitted",values:{hostName:e}}),m=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolate.successfulMessage",{defaultMessage:"Release on host {hostName} successfully submitted",values:{hostName:e}}),f=s.i18n.translate("xpack.securitySolution.endpoint.hostisolation.unisolate",{defaultMessage:"release"}),g=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolated",{defaultMessage:"isolated"});var b=n(7),y=n(5),h=n(123),v=n(370),E=n(803);const x=({alertId:e})=>{const[t,n]=Object(a.useState)(!1),[i,r]=Object(a.useState)([]),{addError:o}=Object(h.a)();return Object(a.useEffect)((()=>{let t=!0;return n(!0),Object(b.isEmpty)(e)||(async()=>{try{const n=await Object(v.f)({alertId:e,owner:[y.j]});t&&r(n)}catch(e){o(e.message,{title:E.a})}t&&n(!1)})(),()=>{t=!1}}),[e,o]),{loading:t,casesInfo:i}};var j=n(144);const S=Object(a.memo)((({hostName:e,alertId:t,isolateAction:n="isolateHost",additionalInfo:s})=>i.a.createElement(r.EuiCallOut,{iconType:"check",color:"success",title:"isolateHost"===n?p(e):m(e),"data-test-subj":"isolateHost"===n?"hostIsolateSuccessMessage":"hostUnisolateSuccessMessage"},void 0!==t?(({alertIdForCase:e})=>{const{casesInfo:t}=x({alertId:e}),n=Object(a.useMemo)((()=>t.length),[t]),s=Object(a.useMemo)((()=>t.map(((e,t)=>i.a.createElement("li",{key:e.id},i.a.createElement(j.a,{detailName:e.id},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.placeholderCase",defaultMessage:"{caseName}",values:{caseName:e.title}})))))),[t]);return i.a.createElement(i.a.Fragment,null,n>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.successfulIsolation.cases",defaultMessage:"This action has been attached to the following {caseCount, plural, one {case} other {cases}}:",values:{caseCount:n}}))),i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("ul",null,s))))})({alertIdForCase:t}):s)));S.displayName="EndpointIsolateSuccess";var O=n(877);const k=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:s,comment:p="",messageAppend:m,isLoading:f=!1})=>{const g=Object(a.useCallback)((e=>{s({comment:e.target.value})}),[s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,null),i.a.createElement(r.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},i.a.createElement(r.EuiFormRow,{fullWidth:!0},i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHost",defaultMessage:"Isolate host {hostName} from network.",values:{hostName:i.a.createElement("b",null,e)}}),i.a.createElement("br",null)),i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHostAbout",defaultMessage:"Isolating a host will disconnect it from the network. The host will only be able to communicate with the Kibana platform."})," ",m))),i.a.createElement(r.EuiFormRow,{label:u,fullWidth:!0},i.a.createElement(r.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:p,onChange:g})),i.a.createElement(r.EuiFormRow,{fullWidth:!0},i.a.createElement(r.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{onClick:t,disabled:f,"data-test-subj":"hostIsolateCancelButton"},l)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{fill:!0,onClick:n,disabled:f,isLoading:f,"data-test-subj":"hostIsolateConfirmButton"},c))))))}));k.displayName="EndpointIsolateForm";const w=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:s,comment:p="",messageAppend:m,isLoading:b=!1})=>{const y=Object(a.useCallback)((e=>{s({comment:e.target.value})}),[s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(O.a,null),i.a.createElement(r.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},i.a.createElement(r.EuiFormRow,{fullWidth:!0},i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.unIsolateThisHost",defaultMessage:"{hostName} is currently {isolated}. Are you sure you want to {unisolate} this host?",values:{hostName:i.a.createElement("b",null,e),isolated:i.a.createElement("b",null,g),unisolate:i.a.createElement("b",null,f)}})," ",m))),i.a.createElement(r.EuiFormRow,{label:u,fullWidth:!0},i.a.createElement(r.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:p,onChange:y})),i.a.createElement(r.EuiFormRow,{fullWidth:!0},i.a.createElement(r.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{onClick:t,disabled:b,"data-test-subj":"hostIsolateCancelButton"},l)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{fill:!0,onClick:n,disabled:b,isLoading:b},c))))))}));w.displayName="EndpointUnisolateForm";const T=i.a.memo((({onClick:e,buttonText:t})=>{const n=Object(a.useCallback)((()=>e()),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{flush:"right",onClick:n,"data-test-subj":"hostIsolateSuccessCompleteButton"},i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("p",null,t))))))}));T.displayName="ActionCompletionReturnButton";var I=n(519);const M=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost",{defaultMessage:"Isolate host"}),C=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolateHost",{defaultMessage:"Release host"}),_=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost.casesAssociatedWithAlert",{defaultMessage:"{caseCount} {caseCount, plural, one {case} other {cases}} associated with this host",values:{caseCount:e}}),D=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.returnToAlertDetails",{defaultMessage:"Return to alert details"}),A=i.a.memo((({endpointId:e,hostName:t,casesInfo:n,agentType:s,cancelCallback:l,successCallback:c})=>{const[u,d]=Object(a.useState)(""),[p,m]=Object(a.useState)(!1),f=n.map((e=>e.id)),{loading:g,isolateHost:b}=(({endpointId:e,comment:t,caseIds:n,agentType:i})=>{const[r,o]=Object(a.useState)(!1),{addError:s}=Object(h.a)();return{loading:r,isolateHost:Object(a.useCallback)((async()=>{try{o(!0);const a=await Object(v.b)({endpointId:e,comment:t,caseIds:n&&n.length>0?n:void 0,agentType:i});return o(!1),!!a.action}catch(e){return o(!1),s(e.message,{title:E.b}),!1}}),[e,t,n,i,s])}})({endpointId:e,comment:u,caseIds:f,agentType:s}),y=Object(a.useCallback)((async()=>{const e=await b();m(e),e&&c&&c()}),[b,c]),x=Object(a.useCallback)((()=>l()),[l]),j=Object(a.useCallback)((({comment:e})=>d(e)),[]),S=Object(a.useMemo)((()=>n.length),[n]),O=Object(a.useMemo)((()=>i.a.createElement(T,{onClick:x,buttonText:D})),[x]),w=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(k,{hostName:t,onCancel:x,onConfirm:y,onChange:j,comment:u,isLoading:g,messageAppend:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:i.a.createElement("b",null,_(S))}})}))),[t,x,y,j,u,g,S]);return p?O:w}));A.displayName="IsolateHost";const F=i.a.memo((({endpointId:e,hostName:t,casesInfo:n,agentType:s,cancelCallback:l,successCallback:c})=>{const[u,d]=Object(a.useState)(""),[p,m]=Object(a.useState)(!1),f=n.map((e=>e.id)),{loading:g,unIsolateHost:b}=(({endpointId:e,comment:t,caseIds:n,agentType:i})=>{const[r,o]=Object(a.useState)(!1),{addError:s}=Object(h.a)();return{loading:r,unIsolateHost:Object(a.useCallback)((async()=>{try{o(!0);const a=await Object(v.c)({endpointId:e,comment:t,caseIds:n&&n.length>0?n:void 0,agentType:i});return o(!1),!!a.action}catch(e){return o(!1),s(e.message,{title:E.b}),!1}}),[e,t,n,i,s])}})({endpointId:e,comment:u,caseIds:f,agentType:s}),y=Object(a.useCallback)((async()=>{const e=await b();m(e),e&&c&&c()}),[c,b]),x=Object(a.useCallback)((()=>l()),[l]),j=Object(a.useCallback)((({comment:e})=>d(e)),[]),S=Object(a.useMemo)((()=>n.length),[n]),O=Object(a.useMemo)((()=>i.a.createElement(T,{onClick:x,buttonText:D})),[x]),k=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(w,{hostName:t,onCancel:x,onConfirm:y,onChange:j,comment:u,isLoading:g,messageAppend:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:i.a.createElement("b",null,_(S))}})}))),[t,x,y,j,u,g,S]);return p?O:k}));F.displayName="UnisolateHost";var N=n(332);const P=i.a.memo((({details:e,cancelCallback:t,successCallback:n,isolateAction:s})=>{const{isSupported:l,details:{agentId:c,agentType:u,hostName:d}}=Object(N.a)(e),p=Object(a.useMemo)((()=>Object(I.a)({category:"_id",field:"_id"},e)),[e]),{casesInfo:m}=x({alertId:p}),f=Object(a.useMemo)((()=>({endpointId:c,hostName:d,casesInfo:m,agentType:u,cancelCallback:t,successCallback:n})),[c,u,t,m,d,n]);return l?"isolateHost"===s?i.a.createElement(A,f):i.a.createElement(F,f):i.a.createElement(r.EuiCallOut,{color:"warning","data-test-subj":"unsupportedAlertHost"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.alertHostNotSupported",defaultMessage:"The alert's host ({hostName}) does not support host isolation response actions.",values:{hostName:d}}))}));P.displayName="HostIsolationContent";var R=n(502),L=n(203),z=n(140),q=n(725);const B=({closePopover:e,detailsData:t,isHostIsolationPanelOpen:n,onAddIsolationStatusClick:i})=>{const{isSupported:r,isAlert:o,unsupportedReason:s,details:{agentType:l,agentId:c,agentSupport:{isolate:u}}}=Object(N.a)(t),{canIsolateHost:d,canUnIsolateHost:p}=Object(z.a)().endpointPrivileges,{data:m,isLoading:f,isFetched:g}=Object(q.a)(c,l,{enabled:r}),b=null==m?void 0:m[c],y=Object(a.useMemo)((()=>r&&u),[r,u]),h=Object(a.useMemo)((()=>Boolean(null==b?void 0:b.isolated)),[null==b?void 0:b.isolated]),v=Object(a.useCallback)((()=>{e(),y&&i(h?"unisolateHost":"isolateHost")}),[e,y,h,i]),E=Object(a.useMemo)((()=>!r||!(null!=b&&b.found)||b.status===L.d.UNENROLLED),[r,b]);return Object(a.useMemo)((()=>{if(!o||h&&!p||!d)return[];const e={key:"isolate-host-action-item","data-test-subj":"isolate-host-action-item",disabled:E||n,onClick:v,name:h?C:M};return y?f||!g?(e.disabled=!0,e.toolTipContent=R.b):E&&(e.disabled=!0,e.toolTipContent="endpoint"===l?R.a:R.c):(e.disabled=!0,e.toolTipContent=l&&s?s:R.c),[e]}),[o,h,p,d,E,n,v,y,f,g,l,s])};var $=n(823)},function(e,t,n){"use strict";n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"m",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return j})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"n",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"b",(function(){return D})),n.d(t,"f",(function(){return A})),n.d(t,"g",(function(){return F})),n.d(t,"h",(function(){return N})),n.d(t,"k",(function(){return P}));var a=n(2),i=n.n(a),r=n(19),o=n(7),s=n(54),l=n.n(s),c=(n(1281),n(506)),u=n(403),d=n(1555),p=n(818),m=n(549),f=n(353),g=n(873),b=n(572);const y=["kibana.alert.rule","signal.rule","rule"],h=e=>e.map((e=>({username:e.created_by,timestamp:l()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:f.b,timelineAvatar:i.a.createElement(r.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:i.a.createElement(r.EuiText,{size:"s"},e.comment),actions:i.a.createElement(g.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:f.a})}))),v=e=>{const{created_at:t,created_by:n,list_id:a,tie_breaker_id:i,updated_at:r,updated_by:o,...s}=e;return{...s}},E=e=>e.map((e=>{if(void 0!==e.entries){const t=e.entries.map((e=>{const t=Object(o.omit)(e,"id");return{...t,field:t.field.startsWith("event.")?t.field.replace(/^event./,`${b.f}.`):t.field}}));return{...e,entries:t,comments:[]}}return{...e,comments:[]}})),x=(e,t)=>e.map((e=>({...e,comments:t}))),j=(e,t)=>{const n=void 0!==t?t.toISOString():void 0;return e.map((e=>({...e,expire_time:n})))},S=e=>({query:{match:{_id:{query:e||""}}}}),O=(e,t)=>e.map((e=>({...e,os_types:t}))),k=e=>{const t=["windows","macos"];if(null!=e){var n,a,i,r,o,s;const l="endpoint"===(null==e||null===(n=e.agent)||void 0===n?void 0:n.type)?null===(a=e.host)||void 0===a||null===(i=a.os)||void 0===i||null===(r=i.name)||void 0===r?void 0:r.toLowerCase():null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family;if(null!=l)return c.a.is(l)?[l]:t}return t},w=e=>e.map((e=>{const t=e.entries.map((e=>{if(e.field.includes(".hash")){if("match"===e.type)return{...e,value:e.value.toLowerCase()};if("match_any"===e.type)return{...e,value:e.value.map((e=>e.toLowerCase()))}}return e}));return{...e,entries:t}})),T=e=>{if(Array.isArray(e)&&e.length>0)return e.map((e=>{var t,n,a;return{subjectName:null!==(t=null==e?void 0:e.subject_name)&&void 0!==t?t:"",trusted:null!==(n=null==e||null===(a=e.trusted)||void 0===a?void 0:a.toString())&&void 0!==n?n:""}}));{var t,n;const a=Array.isArray(e)?void 0:e;return[{subjectName:null!==(t=null==a?void 0:a.subject_name)&&void 0!==t?t:"",trusted:null!==(n=null==a?void 0:a.trusted)&&void 0!==n?n:""}]}};function I(e){const t=[];for(const n of e)void 0!==n.entries?(n.entries=n.entries.filter((e=>void 0!==e.value&&e.value.length>0)),t.push(n)):void 0!==n.value&&n.value.length>0&&t.push(n);return t}const M=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:i})=>{var r,o,s,l,c,u;const{process:p}=i,m=I([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(r=null===(o=i.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==r?r:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==p?void 0:p.executable)&&void 0!==s?s:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(l=null==p?void 0:p.name)&&void 0!==l?l:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!==(c=null==p||null===(u=p.hash)||void 0===u?void 0:u.sha256)&&void 0!==c?c:""}]);return{...Object(d.e)({listId:e,namespaceType:a,name:t}),entries:Object(d.a)(m)}},C=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:i})=>{var r,o,s,l,c,u,p,m,f;const{process:g}=i,b=I([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(r=null===(o=i.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==r?r:""},{field:"Memory_protection.self_injection",operator:"included",type:"match",value:null!==(s=String(null===(l=i.Memory_protection)||void 0===l?void 0:l.self_injection))&&void 0!==s?s:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(c=null==g?void 0:g.executable)&&void 0!==c?c:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(u=null==g?void 0:g.name)&&void 0!==u?u:""},{field:"process.Ext.token.integrity_level_name",operator:"included",type:"match",value:null!==(p=null==g||null===(m=g.Ext)||void 0===m||null===(f=m.token)||void 0===f?void 0:f.integrity_level_name)&&void 0!==p?p:""}]);return{...Object(d.e)({listId:e,namespaceType:a,name:t}),entries:Object(d.a)(b)}},_=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:i})=>{var r,o,s,l,c,u,p,m,f,g,b,y,h,v,E,x,j,S,O,k,w,T,M,C,_,D,A,F,N,P,R,L,z,q,B,$,V,U,G;const{process:H}=i,W=I([{field:"rule.id",operator:"included",type:"match",value:null!==(r=null===(o=i.rule)||void 0===o?void 0:o.id)&&void 0!==r?r:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==H?void 0:H.executable)&&void 0!==s?s:""},{field:"process.command_line",operator:"included",type:"match",value:null!==(l=null==H?void 0:H.command_line)&&void 0!==l?l:""},{field:"process.parent.executable",operator:"included",type:"match",value:null!==(c=null==H||null===(u=H.parent)||void 0===u?void 0:u.executable)&&void 0!==c?c:""},{field:"process.code_signature.subject_name",operator:"included",type:"match",value:null!==(p=null==H||null===(m=H.code_signature)||void 0===m?void 0:m.subject_name)&&void 0!==p?p:""},{field:"file.path",operator:"included",type:"match",value:null!==(f=null===(g=i.file)||void 0===g?void 0:g.path)&&void 0!==f?f:""},{field:"file.name",operator:"included",type:"match",value:null!==(b=null===(y=i.file)||void 0===y?void 0:y.name)&&void 0!==b?b:""},{field:"source.ip",operator:"included",type:"match",value:null!==(h=null===(v=i.source)||void 0===v?void 0:v.ip)&&void 0!==h?h:""},{field:"destination.ip",operator:"included",type:"match",value:null!==(E=null===(x=i.destination)||void 0===x?void 0:x.ip)&&void 0!==E?E:""},{field:"registry.path",operator:"included",type:"match",value:null!==(j=null===(S=i.registry)||void 0===S?void 0:S.path)&&void 0!==j?j:""},{field:"registry.value",operator:"included",type:"match",value:null!==(O=null===(k=i.registry)||void 0===k?void 0:k.value)&&void 0!==O?O:""},{field:"registry.data.strings",operator:"included",type:"match",value:null!==(w=null===(T=i.registry)||void 0===T||null===(M=T.data)||void 0===M?void 0:M.strings)&&void 0!==w?w:""},{field:"dll.path",operator:"included",type:"match",value:null!==(C=null===(_=i.dll)||void 0===_?void 0:_.path)&&void 0!==C?C:""},{field:"dll.code_signature.subject_name",operator:"included",type:"match",value:null!==(D=null===(A=i.dll)||void 0===A||null===(F=A.code_signature)||void 0===F?void 0:F.subject_name)&&void 0!==D?D:""},{field:"dll.pe.original_file_name",operator:"included",type:"match",value:null!==(N=null===(P=i.dll)||void 0===P||null===(R=P.pe)||void 0===R?void 0:R.original_file_name)&&void 0!==N?N:""},{field:"dns.question.name",operator:"included",type:"match",value:null!==(L=null===(z=i.dns)||void 0===z||null===(q=z.question)||void 0===q?void 0:q.name)&&void 0!==L?L:""},{field:"dns.question.type",operator:"included",type:"match",value:null!==(B=null===($=i.dns)||void 0===$||null===(V=$.question)||void 0===V?void 0:V.type)&&void 0!==B?B:""},{field:"user.id",operator:"included",type:"match",value:null!==(U=null===(G=i.user)||void 0===G?void 0:G.id)&&void 0!==U?U:""}]);return{...Object(d.e)({listId:e,namespaceType:a,name:t}),entries:Object(d.a)(W)}},D=(e,t,n)=>{var a,i;const r=null!==(a=n["event.code"])&&void 0!==a?a:null===(i=n.event)||void 0===i?void 0:i.code;switch(r){case"behavior":return[_({listId:e,name:t,eventCode:r,alertEcsData:n})];case"memory_signature":return[M({listId:e,name:t,eventCode:r,alertEcsData:n})];case"shellcode_thread":return[C({listId:e,name:t,eventCode:r,alertEcsData:n})];case"ransomware":return(e=>{const{process:t}=e,n=t&&t.Ext&&t.Ext.code_signature;return T(n)})(n).map((a=>(({listId:e,name:t,codeSignature:n,eventCode:a,listNamespace:i="agnostic",alertEcsData:r})=>{var o,s,l,c;const{process:u,Ransomware:p}=r,m=null!==(o=null==u||null===(s=u.hash)||void 0===s?void 0:s.sha256)&&void 0!==o?o:"",f=null!==(l=null==u?void 0:u.executable)&&void 0!==l?l:"",g=null!==(c=null==p?void 0:p.feature)&&void 0!==c?c:"";return{...Object(d.e)({listId:e,namespaceType:i,name:t}),entries:Object(d.a)([{field:"process.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=n?n.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=n?n.trusted:""}]},{field:"process.executable",operator:"included",type:"match",value:null!=f?f:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!=m?m:""},{field:"Ransomware.feature",operator:"included",type:"match",value:null!=g?g:""},{field:"event.code",operator:"included",type:"match",value:null!=a?a:""}])}})({listId:e,name:t,eventCode:r,codeSignature:a,alertEcsData:n})));default:return(e=>{const{file:t}=e,n=t&&t.Ext&&t.Ext.code_signature;return T(n)})(n).map((a=>(({listId:e,name:t,codeSignature:n,eventCode:a,listNamespace:i="agnostic",alertEcsData:r})=>{var o,s,l,c;const{file:u,host:p}=r,m=null!==(o=null==u?void 0:u.path)&&void 0!==o?o:"",f=null!==(s=null==u||null===(l=u.hash)||void 0===l?void 0:l.sha256)&&void 0!==s?s:"",g="Linux"===(null==p||null===(c=p.os)||void 0===c?void 0:c.name),b=[{field:g?"file.path":"file.path.caseless",operator:"included",type:"match",value:null!=m?m:""},{field:"file.hash.sha256",operator:"included",type:"match",value:null!=f?f:""},{field:"event.code",operator:"included",type:"match",value:null!=a?a:""}];return{...Object(d.e)({listId:e,namespaceType:i,name:t}),entries:g?Object(d.a)(b):Object(d.a)([{field:"file.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=n?n.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=n?n.trusted:""}]},...b])}})({listId:e,name:t,eventCode:null!=r?r:"",codeSignature:a,alertEcsData:n})))}},A=(e,t)=>e.map((e=>({...e,name:t}))),F=e=>e.map((e=>({...Object(p.a)(e),list_id:void 0,namespace_type:"single"}))),N=(e,t)=>t.flatMap((t=>e.map((e=>({...Object(p.a)(e),list_id:t.list_id,namespace_type:t.namespace_type}))))),P=({alertData:e,exceptionItemName:t,ruleCustomHighlightedFields:n})=>{const a=R(e,n);if(!a.length)return null;const i=(({highlightedFields:e,alertData:t})=>Object.values(e).reduce(((e,n)=>{var a;const i=n.id,r=null!==(a=Object(o.get)(t,i))&&void 0!==a?a:Object(o.get)(t,`kibana.alert.${i}`);if(null!=r){const t=Array.isArray(r)?u.b.MATCH_ANY:u.b.MATCH,n=Array.isArray(r)?r.map(String):r.toString();e.push({field:i,operator:u.a.INCLUDED,type:t,value:n})}return e}),[]))({highlightedFields:a,alertData:e});return i.length?(({name:e,exceptionEntries:t})=>({...Object(d.e)({listId:void 0,namespaceType:"single",name:e}),entries:Object(d.a)(t)}))({name:t,exceptionEntries:i}):null},R=(e,t)=>{const n=Object(o.get)(e,"event.category"),a=Object(o.get)(e,"event.code"),i=Object(o.get)(e,"kibana.alert.rule.type"),r={primaryEventCategory:Array.isArray(n)?n[0]:n,allEventCategories:[n]};return((e,t,n)=>e.filter((({id:e})=>"agent.id"===e?L(n):!t.some((t=>e.startsWith(t))))))(Object(m.b)({eventCategories:r,eventCode:a,eventRuleType:i,highlightedFieldsOverride:t}),y,e)},L=e=>{if(!Object(o.get)(e,"kibana.alert.rule.uuid"))return!1;const t=Object(o.get)(e,"agent.type");return"endpoint"===(Array.isArray(t)?t[0]:t)}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(46);const i=a.string,r=a.union([i,a[void 0]])},function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return O}));var a=n(63),i=n.n(a),r=n(19),o=n(44),s=n(2),l=n.n(s),c=n(45),u=n(188),d=n.n(u),p=n(1332),m=n(5),f=n(129),g=n(118),b=n(200),y=n(138),h=n(460);const v={fill:!1},E=e=>{e.forEach((e=>e.refetch&&e.refetch()))},x=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:i,kqlQuery:c,policy:u,queries:d,setDuration:p,showUpdateButton:f=!0,start:b,startAutoReload:y,stopAutoReload:h,timelineId:x,toStr:S,updateReduxTime:O,disabled:k,width:w="restricted",compressed:T=!1})=>{const[I,M]=Object(s.useState)([]),C=Object(s.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:r}=O({end:n,id:a,isInvalid:!1,isQuickSelection:i,kql:c,start:e,timelineId:x,hasRangeChanged:!1}),o=j(e),s=i?j(n,{roundUp:!0}):j(n);!d||r||i&&(b!==o||t!==s)||E(d)}),[t,a,c,d,b,x,O]),_=Object(s.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=n&&n.includes("now")||null!=S&&S.includes("now");e!==i&&p({id:a,duration:i}),t&&"interval"===u?h({id:a}):t||"manual"!==u||y({id:a}),d&&!t&&(!r||r&&"now"!==S)&&E(d)}),[n,S,e,u,p,a,h,y,d]),D=Object(s.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){O({end:t,id:a,isInvalid:n,isQuickSelection:i,kql:c,start:e,timelineId:x,hasRangeChanged:!0});const r=[{start:e,end:t},...Object(o.take)(9,I.filter((n=>!(n.start===e&&n.end===t))))];M(r)}}),[O,a,c,x,I]),A=null!=S?S:new Date(t).toISOString(),F=null!=n?n:new Date(b).toISOString(),[N]=Object(g.o)(m.db),[P]=Object(g.o)(m.K),R=Object(o.isEmpty)(N)?[]:N.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:R,end:A,isLoading:i,isPaused:"manual"===u,onRefresh:C,onRefreshChange:_,onTimeChange:D,recentlyUsedRanges:I,refreshInterval:e,showUpdateButton:f,start:F,isDisabled:k,width:w,compressed:T,updateButtonProps:v,dateFormat:P})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),j=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},S=e=>({end:t,id:n,isQuickSelection:a,kql:i,start:r,timelineId:o,hasRangeChanged:s})=>{const l=j(r);let c=j(t,{roundUp:!0});var u;return a?e(t===r?b.c.setAbsoluteRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:c}):b.c.setRelativeRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:c})):(c=j(t),e(b.c.setAbsoluteRangeDatePicker({id:n,from:j(r),to:j(t)}))),null!=o&&s&&e(f.a.updateRange({id:o,start:l,end:c})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(u=i.refetch(e))&&void 0!==u&&u}:{kqlHaveBeenUpdated:!1}};x.displayName="SuperDatePickerComponent";const O=Object(c.connect)((()=>{const e=Object(h.a)(),t=Object(h.b)(),n=Object(h.c)(),a=Object(h.d)(),i=Object(h.e)(),r=Object(h.f)(),s=Object(h.g)(),l=Object(h.h)(),c=Object(h.i)(),u=Object(h.j)();return(d,{id:m})=>{const f=Object(o.getOr)({},`inputs.${m}`,d);return{duration:e(f),end:t(f),fromStr:n(f),kind:i(f),policy:s(f),start:c(f),toStr:u(f),isLoading:!1,...Object(p.c)(f)&&(m===y.a.timeline||m===y.a.global)&&{isLoading:a(f),kqlQuery:r(f),queries:l(d,m)}}}}),(e=>({startAutoReload:({id:t})=>e(b.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(b.c.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(b.c.setDuration({id:t,duration:n})),updateReduxTime:S(e)})))(x)},function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(892))},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},function(e,t,n){"use strict";n.r(t),n.d(t,"HostsType",(function(){return a})),n.d(t,"HostsTableType",(function(){return i}));let a=function(e){return e.page="page",e.details="details",e}({}),i=function(e){return e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions",e}({})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n(5),r=n(161),o=n(381),s=n(380),l=n(124),c=n(148);const u="countOfAlertsWithSameFieldAndValue",d=({field:e,value:t,isActiveTimelines:n,signalIndexName:i,includeAlertIds:d=!1,ignoreTimerange:m=!1})=>{const f=Object(l.a)((e=>c.d.timelineTimeRangeSelector(e))),g=Object(r.a)();let b,y;!1===m&&({to:b,from:y}=n?f:g);const[h]=Object(a.useState)((()=>p(e,t,y,b,d))),{loading:v,data:E,setQuery:x}=Object(o.a)({query:h,indexName:i,queryName:s.a.PREVALENCE});let j;if(Object(a.useEffect)((()=>{x(p(e,t,y,b,d))}),[x,e,t,y,b,d]),E){var S,O;const e=null===(S=E.aggregations)||void 0===S||null===(O=S[u])||void 0===O?void 0:O.buckets;e&&e.length>0&&(j=e[0].doc_count)}const k=!v&&void 0===j;return Object(a.useMemo)((()=>({loading:v,count:j,error:k,alertIds:null==E?void 0:E.hits.hits.map((({_id:e})=>e))})),[j,E,k,v])},p=(e,t,n,a,r)=>{const o=r?{size:i.V}:{size:0},s=r?{sort:{"@timestamp":"desc"}}:{},l=Array.isArray(t)&&1===t.length?t[0]:t;let c;return c={bool:{must:{match:{[e]:l}}}},void 0!==n&&void 0!==a&&(c={...c,bool:{...c.bool,filter:[{range:{"@timestamp":{gte:n,lte:a}}}]}}),Array.isArray(t)&&t.length>1&&(c={bool:{must:t.map((t=>({term:{[e]:t}})))}},void 0!==n&&void 0!==a&&c.bool.must.push({range:{"@timestamp":{gte:n,lte:a}}})),{...o,...s,_source:!1,aggs:{[u]:{terms:{field:e,size:i.V}}},query:c,runtime_mappings:{}}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"c",(function(){return m}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),r=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o=(a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"})),s=(a.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),a.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),a.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),a.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),a.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"})),l=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),c=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),u=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),d=a.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"}),p=a.i18n.translate("xpack.securitySolution.ruleExceptions.addException.ruleException",{defaultMessage:"rule exception"}),m=a.i18n.translate("xpack.securitySolution.ruleExceptions.addException.endpointException",{defaultMessage:"endpoint exception"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return x}));var a=n(2),i=n.n(a),r=n(44),o=n(1334),s=n(19),l=n(778),c=n(1257),u=n(982),d=n(343),p=n(950),m=n(595);const f=e=>t=>""!==e.trim()?Object(d.d)(t,[{comment:e}]):t,g=e=>t=>""!==e.trim()?Object(d.f)(t,e):t,b=e=>t=>Object(d.e)(t,e),y=(e,t)=>n=>e===o.a.ENDPOINT?Object(d.l)(Object(d.c)(n,t)):n,h=({itemName:e,commentToAdd:t,addToRules:n,addToSharedLists:a,sharedLists:i,selectedOs:s,listType:l,expireTime:c,items:u})=>{const p=Object(r.pipe)(f(t),b(c),g(e),y(l,s),((e,t)=>n=>t&&e!==o.a.ENDPOINT?Object(d.g)(n):n)(l,n),((e,t,n)=>a=>t&&e!==o.a.ENDPOINT?Object(d.h)(a,n):a)(l,a,i))(u);return p},v=({itemName:e,commentToAdd:t,selectedOs:n,listType:a,expireTime:i,items:o})=>Object(r.pipe)(f(t),b(i),g(e),y(a,n))(o),E=()=>[{field:"name",name:m.c,sortable:!0,"data-test-subj":"exceptionListNameCell"},{field:"referenced_rules",name:"Number of rules linked to",sortable:!1,"data-test-subj":"exceptionListRulesLinkedToIdCell",render:e=>i.a.createElement(l.a,{emptyButton:!0,useCustomActions:!0,actions:Object(c.a)({dataTestSubj:"addToSharedListsLinkedRulesMenu",linkedRules:e,securityLinkAnchorComponent:p.f}),panelPaddingSize:"none",disableActions:!1,text:e.length.toString(),dataTestSubj:"addToSharedListsLinkedRulesMenuAction"})},{name:m.a,"data-test-subj":"exceptionListRulesActionCell",render:e=>i.a.createElement(p.e,{dataTestSubj:"exceptionListActionCell-link",linkTitle:m.e,listId:e.list_id,external:!0})}],x=()=>[{field:"name",align:"left",name:m.c,sortable:!0,"data-test-subj":"ruleNameCell",truncateText:!1},{field:"tags",align:"left",name:m.d,"data-test-subj":"ruleNameCell",render:e=>0===e.length?null:i.a.createElement(u.a,{items:e,popoverTitle:m.d,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>i.a.createElement(s.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)})},{name:m.a,"data-test-subj":"ruleAction-view",render:e=>i.a.createElement(p.f,{external:!0,referenceId:e.id,referenceName:m.f})}]},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return K}));var a=n(49);const i=parseInt(a.euiThemeVars.euiSizeXL,10)-parseInt(a.euiThemeVars.euiSizeXS,10),r=e=>"signal"===e,o=e=>(e>0?e*i:i)+2*parseInt(a.euiThemeVars.euiDataGridCellPaddingM,10);var s=n(2),l=n.n(s),c=n(45),u=n(19),d=n(41),p=n.n(d),m=n(1403),f=n(1630),g=n(289),b=n(169),y=n(272),h=n(131),v=n(541),E=n(129),x=n(149),j=n(934),S=n(121),O=n(140),k=n(594),w=n(838);const T=({ariaLabel:e,timelineType:t,toggleShowNotes:n,eventId:a,notesCount:i})=>{const{kibanaSecuritySolutionsPrivileges:r}=Object(O.a)(),o=Object(s.useMemo)((()=>i>0?k.g({notesCount:i}):k.f),[i]);return l.a.createElement(w.a,null,l.a.createElement(j.b,{ariaLabel:e,"data-test-subj":"add-note",isDisabled:!1===r.crud,timelineType:t,toggleShowNotes:n,toolTip:t===S.m.template?k.h:o,eventId:a,notesCount:i}))};T.displayName="AddEventNoteActionComponent";const I=l.a.memo(T);var M=n(180),C=n(839);const _=({ariaLabel:e,isAlert:t,noteIds:n,onPinClicked:a,eventIsPinned:r,timelineType:o})=>{const{kibanaSecuritySolutionsPrivileges:c}=Object(O.a)(),d=Object(s.useMemo)((()=>Object(y.g)({isPinned:r,isAlert:t,eventHasNotes:Object(y.b)(n),timelineType:o})),[r,t,n,o]);return l.a.createElement("div",{key:"timeline-action-pin-tool-tip"},l.a.createElement(M.l,{textAlign:"center",width:i},l.a.createElement(u.EuiToolTip,{"data-test-subj":"timeline-action-pin-tool-tip",content:d},l.a.createElement(C.a,{ariaLabel:e,allowUnpinning:!Object(y.b)(n),"data-test-subj":"pin-event",isDisabled:!1===c.crud,isAlert:t,onClick:a,pinned:r,timelineType:o}))))};_.displayName="PinEventActionComponent";const D=l.a.memo(_);var A=n(124),F=n(158),N=n(187),P=n(16),R=n(206),L=n(219),z=n(13),q=n(969),B=n(730),$=n(256),V=n(170),U=n(758),G=n(305),H=n(122);const W=p.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-3eeodk-0"})(["align-items:center;display:flex;"]),Q=[],Y=({ariaRowindex:e,columnValues:t,disableExpandAction:n=!1,ecsData:a,eventId:o,eventIdToNoteIds:d,isEventPinned:p=!1,isEventViewer:j=!1,onEventDetailsPanelOpened:S,onRuleChange:O,showNotes:w,timelineId:T,refetch:C,toggleShowNotes:_,disablePinAction:Y=!0})=>{const K=Object(c.useDispatch)(),{timelineType:J}=Object(A.b)((e=>Object(h.isTimelineScope)(T)?Object(b.selectTimelineById)(e,T):F.b)),{startTransaction:Z}=Object(N.b)(),X=Object(P.b)().isEnterprise(),ee=Object(s.useCallback)((e=>K(E.a.pinEvent({id:T,eventId:e}))),[K,T]),te=Object(s.useCallback)((e=>K(E.a.unPinEvent({id:T,eventId:e}))),[K,T]),ne=Object(s.useCallback)((()=>Object(y.f)({allowUnpinning:!d||!Object(y.b)(d[o]),eventId:o,onPinEvent:ee,onUnPinEvent:te,isEventPinned:p})),[d,o,p,ee,te]),ae=Object(y.e)(a),ie=Object(s.useMemo)((()=>{var e,t,n,i;return"signal"!==ae&&!(null!==(e=a.event)&&void 0!==e&&null!==(t=e.kind)&&void 0!==t&&t.includes("event")&&null!==(n=a.agent)&&void 0!==n&&null!==(i=n.type)&&void 0!==i&&i.includes("endpoint"))}),[a,ae]),re=!Object(v.a)(a),{setGlobalFullScreen:oe}=Object(R.a)(),{setTimelineFullScreen:se}=Object(R.c)(),le=Object(s.useCallback)((()=>{Z({name:L.a.OPEN_ANALYZER});const e=Object(h.getScopedActions)(T),t=document.querySelector(".euiDataGrid--fullScreen");e&&K(e.updateGraphEventId({id:T,graphEventId:a._id})),T===x.f.active?(t&&se(!0),K(Object(z.setActiveTabTimeline)({id:T,activeTab:m.a.graph}))):t&&oe(!0)}),[Z,T,K,a._id,se,oe]),ce=Object(s.useMemo)((()=>{var e,t,n,i,r,o,s,l,c,u;const{process:d,_id:p,_index:m,timestamp:f,kibana:g}=a,b=null==d||null===(e=d.entry_leader)||void 0===e||null===(t=e.entity_id)||void 0===t?void 0:t[0],y=null==d||null===(n=d.entry_leader)||void 0===n||null===(i=n.start)||void 0===i?void 0:i[0],h=(null==g||null===(r=g.alert)||void 0===r||null===(o=r.ancestors)||void 0===o||null===(s=o.index)||void 0===s?void 0:s[0])||m;if(void 0===h||void 0===b||void 0===y)return null;const v=null==d||null===(l=d.entity_id)||void 0===l?void 0:l[0],E="signal"===ae||"eql"===ae?p:void 0;return{index:h,sessionEntityId:b,sessionStartTime:y,jumpToEntityId:v,jumpToCursor:E&&(null===(c=a.kibana)||void 0===c||null===(u=c.alert.original_time)||void 0===u?void 0:u[0])||f,investigatedAlertId:E}}),[a,ae]),ue=Object(s.useCallback)((()=>{const e=document.querySelector(".euiDataGrid--fullScreen");Z({name:L.a.OPEN_SESSION_VIEW});const t=Object(h.getScopedActions)(T);T===x.f.active?(e&&se(!0),null!==ce&&K(Object(z.setActiveTabTimeline)({id:T,activeTab:m.a.session}))):e&&oe(!0),null!==ce&&t&&K(t.updateSessionViewConfig({id:T,sessionViewConfig:ce}))}),[Z,T,ce,se,K,oe]),{activeStep:de,isTourShown:pe,incrementStep:me}=Object($.b)(),fe=Object(s.useMemo)((()=>pe(V.b.alertsCases)&&"signal"===ae&&Object(U.c)(T)&&1===e),[pe,e,ae,T]),ge=Object(s.useCallback)((()=>{fe&&de===V.a.expandEvent&&pe(V.b.alertsCases)&&me(V.b.alertsCases),S()}),[de,me,fe,pe,S]),be=Object(H.a)("securitySolutionNotesEnabled"),ye=Object(H.a)("expandableFlyoutDisabled"),he=Object(c.useSelector)((e=>Object(g.q)(e,o))),ve=Object(s.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d[o])&&void 0!==e?e:Q}),[d,o]),Ee=Object(s.useMemo)((()=>be&&!ye?he.length:ve.length),[he,ve,be,ye]),xe=Object(s.useMemo)((()=>be&&!ye?he.map((e=>e.noteId)):ve),[he,ve,be,ye]);return l.a.createElement(W,{"data-test-subj":"actions-container"},l.a.createElement(l.a.Fragment,null,!n&&l.a.createElement(G.a,{isTourAnchor:fe,onClick:ge,step:V.a.expandEvent,tourId:V.b.alertsCases},l.a.createElement("div",{key:"expand-event"},l.a.createElement(M.l,{textAlign:"center",width:i},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:k.m},l.a.createElement(u.EuiButtonIcon,{"aria-label":k.n({ariaRowindex:e,columnValues:t}),"data-test-subj":"expand-event",iconType:"expand",onClick:ge,size:"s"}))))),l.a.createElement(l.a.Fragment,null,T!==x.f.active&&l.a.createElement(B.a,{ariaLabel:k.k({ariaRowindex:e,columnValues:t}),key:"investigate-in-timeline",ecsRowData:a})),!j&&w&&l.a.createElement(I,{ariaLabel:k.c({ariaRowindex:e,columnValues:t}),key:"add-event-note",timelineType:J,notesCount:Ee,eventId:o,toggleShowNotes:_}),!j&&!Y&&l.a.createElement(D,{ariaLabel:k.j({ariaRowindex:e,columnValues:t,isEventPinned:p}),isAlert:r(ae),key:"pin-event",onPinClicked:ne,noteIds:xe,eventIsPinned:p,timelineType:J}),l.a.createElement(q.b,{ariaLabel:k.e({ariaRowindex:e,columnValues:t}),ariaRowindex:e,columnValues:t,key:"alert-context-menu",ecsRowData:a,scopeId:T,disabled:ie,onRuleChange:O,refetch:C}),!1===re?l.a.createElement("div",null,l.a.createElement(M.l,{textAlign:"center",width:i},l.a.createElement(u.EuiToolTip,{"data-test-subj":"view-in-analyzer-tool-tip",content:k.a},l.a.createElement(u.EuiButtonIcon,{"aria-label":k.b({ariaRowindex:e,columnValues:t}),"data-test-subj":"view-in-analyzer",iconType:"analyzeEvent",onClick:le,size:"s"})))):null,null===ce||!X&&T!==f.b.kubernetesPageSessions?null:l.a.createElement("div",null,l.a.createElement(M.l,{textAlign:"center",width:i},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:k.i},l.a.createElement(u.EuiButtonIcon,{"aria-label":k.n({ariaRowindex:e,columnValues:t}),"data-test-subj":"session-view-button",iconType:"sessionViewer",onClick:ue,size:"s"}))))))};Y.displayName="ActionsComponent";const K=l.a.memo(Y);n(698)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(44);const i=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},r=["http:","https:"],o=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(r.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function s(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));var a=n(19),i=n(2),r=n.n(i);const o=n(4).i18n.translate("xpack.securitySolution.overview.informationAriaLabel",{defaultMessage:"Information"});var s=n(666);const l=({toolTipContent:e,toolTipTitle:t,width:n=270,anchorPosition:s="leftCenter"})=>{const[l,c]=Object(i.useState)(!1),u=Object(i.useCallback)((()=>{c(!l)}),[l,c]),d=Object(i.useCallback)((()=>{c(!1)}),[c]);return r.a.createElement(a.EuiPopover,{isOpen:l,closePopover:d,anchorPosition:s,button:r.a.createElement(a.EuiButtonIcon,{color:"text",size:"xs",iconSize:"m",iconType:"iInCircle","aria-label":o,onClick:u})},t&&r.a.createElement(a.EuiPopoverTitle,null,t),r.a.createElement(a.EuiText,{size:"s",style:{width:`${n}px`}},e))},c=({anchorPosition:e})=>r.a.createElement(l,{anchorPosition:e,toolTipContent:r.a.createElement(s.a,null)})},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return z})),n.d(t,"c",(function(){return B})),n(553);var a=n(44),i=n(2),r=n.n(i),o=n(43);const s=Object(i.createContext)(null),l=({children:e,getTriggerCompatibleActions:t})=>{const n=Object(i.useMemo)((()=>({getActions:e=>t(e.trigger.id,e).then((e=>Object(a.orderBy)(["order","id"],["asc","asc"],e)))})),[t]);return Object(o.jsx)(s.Provider,{value:n},e)},c=()=>{const e=Object(i.useContext)(s);if(!e)throw new Error("No CellActionsContext found. Please wrap the application with CellActionsProvider");return e};var u=n(19),d=n(119),p=n.n(d);const m=({action:e,actionContext:t,showTooltip:n,onClick:a})=>{const r=Object(i.useMemo)((()=>({iconType:e.getIconType(t),onClick:()=>{e.execute(t),a&&a()},"data-test-subj":`actionItem-${e.id}`,"aria-label":e.getDisplayName(t)})),[e,t,a]);return r.iconType?n?Object(o.jsx)(u.EuiToolTip,{content:e.getDisplayNameTooltip?e.getDisplayNameTooltip(t):""},Object(o.jsx)(u.EuiButtonIcon,p()({},r,{iconSize:"s"}))):Object(o.jsx)(u.EuiButtonIcon,p()({},r,{iconSize:"s"})):null},f=(e,t)=>t<=1?{extraActions:e,visibleActions:[]}:e.length<=t?{extraActions:[],visibleActions:e}:{visibleActions:e.slice(0,t-1),extraActions:e.slice(t-1,e.length)};var g=n(49),b=n(4);const y=e=>b.i18n.translate("cellActions.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:e},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."}),h=b.i18n.translate("cellActions.extraActionsAriaLabel",{defaultMessage:"Extra actions"}),v=b.i18n.translate("cellActions.showMoreActionsLabel",{defaultMessage:"More actions"}),E=b.i18n.translate("cellActions.actionsAriaLabel",{defaultMessage:"Actions"}),x=Object(o.css)("color:",g.euiThemeVars.euiColorPrimaryText,";",""),j=({anchorPosition:e,actions:t,actionContext:n,isOpen:a,closePopOver:i,button:r})=>Object(o.jsx)(u.EuiPopover,{button:r,isOpen:a,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!0,repositionOnScroll:!0,ownFocus:!0,"data-test-subj":"extraActionsPopOver","aria-label":h},Object(o.jsx)(O,{actions:t,actionContext:n,closePopOver:i})),S=({anchorPosition:e,anchorRef:t,actionContext:n,isOpen:a,closePopOver:i,actions:r})=>t.current?Object(o.jsx)(u.EuiWrappingPopover,{"aria-label":h,button:t.current,isOpen:a,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!1,repositionOnScroll:!0,ownFocus:!0,attachToAnchor:!1,"data-test-subj":"extraActionsPopOverWithAnchor"},Object(o.jsx)(O,{actions:r,actionContext:n,closePopOver:i})):null,O=({actionContext:e,actions:t,closePopOver:n})=>{const a=Object(i.useMemo)((()=>t.map((t=>Object(o.jsx)(u.EuiContextMenuItem,{css:x,key:t.id,icon:t.getIconType(e),"aria-label":t.getDisplayName(e),"data-test-subj":`actionItem-${t.id}`,onClick:()=>{n(),t.execute(e)}},t.getDisplayName(e))))),[e,t,n]);return Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(u.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,y(e.data.map((({field:e})=>e.name)).join(", ")))),Object(o.jsx)(u.EuiContextMenuPanel,{size:"s",items:a}))},k=({onClick:e,showTooltip:t})=>t?Object(o.jsx)(u.EuiToolTip,{content:v},Object(o.jsx)(u.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":v,iconType:"boxesHorizontal",onClick:e})):Object(o.jsx)(u.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":v,iconType:"boxesHorizontal",onClick:e});var w=n(445),T=n.n(w),I=n(427),M=n.n(I);const C=e=>{if(e)throw e},_=(e,t)=>Object(i.useMemo)((()=>D(e,t)),[e,t]),D=(e,t=[])=>e?e.filter((({type:e})=>!(null!=t&&t.includes(e)))):void 0,A=({actionContext:e,anchorPosition:t,showActionTooltips:n,visibleCellActions:a,disabledActionTypes:r})=>{const{value:s}=((e,t={})=>{const{getActions:n}=c(),{error:a,value:i,loading:r}=T()((()=>n(e)),[]),o=_(i,t.disabledActionTypes);return C(a),{value:o,loading:r}})(e,{disabledActionTypes:r}),{extraActions:l,visibleActions:d}=((e,t)=>Object(i.useMemo)((()=>f(null!=e?e:[],t)),[e,t]))(null!=s?s:[],a),[p,g]=Object(i.useState)(!1),b=Object(i.useCallback)((()=>g((e=>!e))),[]),y=Object(i.useCallback)((()=>g(!1)),[]),h=Object(i.useMemo)((()=>Object(o.jsx)(k,{onClick:b,showTooltip:n})),[b,n]);return Object(o.jsx)(u.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"none","data-test-subj":"inlineActions",className:"inlineActions "+(p?"inlineActions-popoverOpen":"")},d.map((t=>Object(o.jsx)(u.EuiFlexItem,{grow:!1,key:`action-item-${t.id}`},Object(o.jsx)(m,{action:t,actionContext:e,showTooltip:n})))),l.length>0?Object(o.jsx)(u.EuiFlexItem,{grow:!1},Object(o.jsx)(j,{actions:l,actionContext:e,anchorPosition:t,button:h,closePopOver:y,isOpen:p})):null)};var F=n(7);const N={minWidth:"24px"},P=Object(o.css)("padding:0 ",g.euiThemeVars.euiSizeS,";",""),R=({anchorPosition:e,children:t,visibleCellActions:n,actionContext:a,showActionTooltips:s,disabledActionTypes:l})=>{const d=Object(i.useRef)(null),[p,b]=Object(i.useState)(!1),[h,v]=Object(i.useState)(!1),[{value:x},j]=((e={})=>{const{getActions:t}=c(),[{error:n,value:a,loading:i},r]=M()(t,[]),o=_(a,e.disabledActionTypes);return C(n),[{value:o,loading:i},r]})({disabledActionTypes:l}),{visibleActions:O,extraActions:w}=Object(i.useMemo)((()=>f(null!=x?x:[],n)),[x,n]),T=Object(i.useMemo)((()=>Object(F.debounce)((()=>{document.body.classList.contains("is-dragging")||v(!0)}),100)),[]);Object(i.useEffect)((()=>()=>{T.cancel()}),[T]);const I=Object(i.useCallback)((()=>{T.cancel(),v(!1)}),[T]),D=Object(i.useCallback)((()=>b(!1)),[b]),A=Object(i.useCallback)((()=>{b(!0),I()}),[I,b]),R=Object(i.useCallback)((async()=>{p||(void 0===x&&j(a),T())}),[p,x,T,j,a]),L=Object(i.useMemo)((()=>Object(o.jsx)("div",{ref:d,onMouseEnter:R,onClick:D},t)),[R,D,t]),z=Object(i.useMemo)((()=>"rightCenter"===e?{marginTop:g.euiThemeVars.euiSizeS}:{}),[e]);return Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)("div",{onMouseLeave:I},Object(o.jsx)(u.EuiPopover,{panelStyle:{...N,...z},anchorPosition:e,button:L,closePopover:I,hasArrow:!1,isOpen:h,panelPaddingSize:"none",repositionOnScroll:!0,ownFocus:!1,panelProps:{"data-test-subj":"hoverActionsPopover"},"aria-label":E},h&&Object(o.jsx)("div",{css:P},Object(o.jsx)(u.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,y(a.data.map((({field:e})=>e.name)).join(", ")))),O.map((e=>Object(o.jsx)(m,{key:e.id,action:e,actionContext:a,showTooltip:s,onClick:I}))),w.length>0&&Object(o.jsx)(k,{onClick:A,showTooltip:s})))),Object(o.jsx)(S,{anchorPosition:e,actions:w,anchorRef:d,actionContext:a,closePopOver:D,isOpen:p}))};var L=n(411);const z=({data:e,triggerId:t,children:n,mode:r,showActionTooltips:s=!0,visibleCellActions:l=3,disabledActionTypes:c=[],metadata:d,className:p})=>{const m=Object(i.useRef)(null),f=Object(i.useMemo)((()=>Object(a.isArray)(e)?e:[e]),[e]),g=Object(i.useMemo)((()=>({data:f,trigger:{id:t},nodeRef:m,metadata:d})),[f,t,d]),b=Object(i.useMemo)((()=>r===L.b.HOVER_DOWN?"downCenter":"rightCenter"),[r]),y=`cellActions-renderContent-${f.map((({field:e})=>e.name)).join("-")}`;return r===L.b.HOVER_DOWN||r===L.b.HOVER_RIGHT?Object(o.jsx)("div",{className:p,ref:m,"data-test-subj":y},Object(o.jsx)(R,{anchorPosition:b,actionContext:g,showActionTooltips:s,visibleCellActions:l,disabledActionTypes:c},n)):Object(o.jsx)(u.EuiFlexGroup,{responsive:!1,alignItems:"center",ref:m,gutterSize:"none",justifyContent:"flexStart",className:p,"data-test-subj":y},Object(o.jsx)(u.EuiFlexItem,{grow:!1},n),Object(o.jsx)(u.EuiFlexItem,{grow:!1},Object(o.jsx)(A,{anchorPosition:b,actionContext:g,showActionTooltips:s,visibleCellActions:l,disabledActionTypes:c})))},q=[],B=({fields:e,getCellValue:t,triggerId:n,metadata:a,dataGridRef:r,disabledActionTypes:o=[]})=>{const[s,l]=Object(i.useState)(q),u=Object(i.useMemo)((()=>{if(n&&null!=e&&e.length)return e.map((e=>({data:[{field:e}],trigger:{id:n},metadata:a})))}),[e,n,a]),{loading:d,value:p}=((e,t={})=>{const{getActions:n}=c(),{error:a,...i}=T()((()=>{var a;return Promise.all(null!==(a=null==e?void 0:e.map((e=>n(e).then((e=>{var n;return null!==(n=D(e,t.disabledActionTypes))&&void 0!==n?n:[]})))))&&void 0!==a?a:[])}),[e]);return C(a),i})(u,{disabledActionTypes:o});return Object(i.useEffect)((()=>{!d&&n&&null!=p&&p.length&&null!=e&&e.length&&p.length===e.length&&l(p.map(((i,o)=>i.map((i=>$({action:i,field:e[o],getCellValue:t,metadata:a,triggerId:n,dataGridRef:r}))))))}),[p,e,t,d,a,n,r]),s},$=({action:e,field:t,getCellValue:n,metadata:a,triggerId:r,dataGridRef:s})=>function({Component:l,rowIndex:c,isExpanded:u}){var d;const p=Object(i.useRef)(null),m=Object(i.useRef)(null),f=Object(i.useMemo)((()=>{const{name:e}=t,i=n(e,c);return{data:[{field:t,value:i}],trigger:{id:r},nodeRef:p,metadata:a}}),[c]),g=Object(i.useCallback)((async()=>{f.nodeRef.current=await V({dataGrid:s.current,isExpanded:u,buttonRef:m}),e.execute(f)}),[f,u]);return Object(o.jsx)(l,{buttonRef:m,"aria-label":e.getDisplayName(f),title:e.getDisplayName(f),"data-test-subj":`dataGridColumnCellAction-${e.id}`,iconType:null!==(d=e.getIconType(f))&&void 0!==d?d:"",onClick:g},e.getDisplayName(f))},V=({dataGrid:e,isExpanded:t,buttonRef:n})=>new Promise((a=>{const i=t?document.querySelector('div[role="gridcell"].euiDataGridRowCell--open'):U(n.current);null==e||e.closeCellPopover(),setTimeout((()=>{var e;a(null!==(e=null==i?void 0:i.firstElementChild)&&void 0!==e?e:null)}))})),U=e=>null==e?null:"DIV"===e.nodeName&&"gridcell"===e.getAttribute("role")?e:U(e.parentElement)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return x}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r);const s=o.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(r.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(r.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));s.displayName="Bar";const l=o.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));l.displayName="BarSection";const c=o.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));c.displayName="BarGroup";const u=o.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(r.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));u.displayName="BarText";const d=o.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const p=o.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(r.css)(["flex:1;"])));p.displayName="BarSpacer";const m=i.a.memo((({border:e,children:t})=>i.a.createElement(s,{border:e},t)));m.displayName="UtilityBar";var f=n(19),g=n(907);const b=o()(f.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(r.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),y=i.a.memo((({children:e,color:t,iconSide:n,iconSize:r,iconType:o,popoverContent:s,disabled:l,ownFocus:c,dataTestSubj:u,popoverPanelPaddingSize:d,onClick:p})=>{const[m,b]=Object(a.useState)(!1),y=Object(a.useCallback)((()=>b(!1)),[b]),h=Object(a.useCallback)((()=>{null==p||p(),b(!m)}),[m,p]);return i.a.createElement(f.EuiPopover,{ownFocus:c,panelPaddingSize:d,button:i.a.createElement(g.a,{dataTestSubj:u,color:t,iconSide:n,iconSize:r,iconType:o,disabled:l,onClick:h},e),closePopover:y,isOpen:m,repositionOnScroll:!0},null==s?void 0:s(y))}));y.displayName="Popover";const h=i.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:r,iconSide:o,iconSize:s,iconType:l,ownFocus:c,onClick:u,popoverContent:p,popoverPanelPaddingSize:m,inProgress:f})=>f?i.a.createElement(d,null,i.a.createElement(b,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):i.a.createElement(d,{"data-test-subj":n},p?i.a.createElement(y,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:o,iconSize:s,iconType:l,ownFocus:c,popoverPanelPaddingSize:m,popoverContent:p,onClick:u},e):i.a.createElement(g.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:r,iconSide:o,iconSize:s,iconType:l,onClick:u},e))));h.displayName="UtilityBarAction";const v=i.a.memo((({grow:e,children:t})=>i.a.createElement(c,{grow:e},t)));v.displayName="UtilityBarGroup";const E=i.a.memo((({grow:e,children:t,dataTestSubj:n})=>i.a.createElement(l,{grow:e,"data-test-subj":n},t)));E.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(p,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const x=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1,className:a})=>i.a.createElement(u,{"data-test-subj":t,shouldWrap:n,className:a},e)));x.displayName="UtilityBarText"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return _}));var a=n(119),i=n.n(a),r=n(19),o=n(128),s=n(2),l=n.n(s),c=n(75),u=n(45),d=n(41),p=n.n(d),m=n(1630),f=n(337),g=n(171),b=n(424),y=n(149),h=n(173),v=n(131),E=n(857),x=n(915);const j=l.a.memo((({dataProvider:e,scopeId:t=y.f.active,children:n,hideTopN:a=!1})=>{const{timelineId:i}=Object(s.useContext)(E.b),{tableId:r}=Object(s.useContext)(x.b),o=Object(s.useMemo)((()=>{var e;return Object(v.getSourcererScopeId)(null!==(e=null!=t?t:i)&&void 0!==e?e:r)}),[t,r,i]),c=Object(s.useMemo)((()=>{const{value:t,field:n}=e.queryMatch;return{value:t||[],field:n}}),[e.queryMatch]),u=Object(s.useMemo)((()=>a?[h.b.SHOW_TOP_N]:[]),[a]);return l.a.createElement(h.c,{mode:h.a.HOVER_DOWN,visibleCellActions:6,showActionTooltips:!0,triggerId:h.d.DEFAULT,data:c,disabledActionTypes:u,sourcererScopeId:o,metadata:{scopeId:t}},n)}));j.displayName="CellActionsWrapper";var S=n(222),O=n(657),k=n(720);const w=p.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);w.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const T=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));T.displayName="Wrapper";const I=p.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),M=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,C=l.a.memo((({dataProvider:e,render:t,scopeId:n,truncate:a,hideTopN:d})=>{const[p,m]=Object(s.useState)(!1),y=e.id.includes(`-${g.a}-`),h=Object(u.useDispatch)(),v=Object(s.useCallback)((()=>{y||(h(f.a.registerProvider({provider:e})),m(!0))}),[y,h,e]),E=Object(s.useCallback)((()=>p&&h(f.a.unRegisterProvider({id:e.id}))),[p,h,e.id]);Object(s.useEffect)((()=>()=>{E()}),[E]);const x=Object(s.useCallback)(((n,a)=>l.a.createElement(D,{registerProvider:v},l.a.createElement("div",i()({},n.draggableProps,n.dragHandleProps,{style:M(n.draggableProps.style,a),ref:n.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(I,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,a))))),[e,v,t]),w=Object(s.useCallback)(((n,o)=>l.a.createElement(O.a,i()({},n.draggableProps,n.dragHandleProps,{ref:e=>{n.innerRef(e)},"data-test-subj":"providerContainer",isDragging:o.isDragging,registerProvider:v,tabIndex:-1}),l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),a&&!o.isDragging?l.a.createElement(b.b,{"data-test-subj":"draggable-truncatable-content"},t(e,n,o)):l.a.createElement(I,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},t(e,n,o)),!o.isDragging&&l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,k.b)))),[e,v,t,a]),C=Object(s.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:o.a,"data-test-subj":"draggableWrapperKeyboardHandler",role:"button",tabIndex:0},l.a.createElement(c.Draggable,{draggableId:Object(S.k)(e.id),index:0,key:Object(S.k)(e.id),isDragDisabled:y},w)),t.placeholder)),[w,e.id,y]),_=Object(s.useMemo)((()=>l.a.createElement(T,{"data-test-subj":"draggableWrapperDiv",disabled:y},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(c.Droppable,{isDropDisabled:!0,droppableId:Object(S.l)(e.id),renderClone:x},C)))),[C,x,e.id,y]);return y?l.a.createElement(l.a.Fragment,null,_):l.a.createElement(j,{dataProvider:e,scopeId:n,hideTopN:d},_)}));C.displayName="DraggableOnWrapper";const _=l.a.memo((({dataProvider:e,isDraggable:t=!1,render:n,scopeId:a,truncate:i,hideTopN:r})=>{const o=Object(s.useMemo)((()=>l.a.createElement("div",{tabIndex:-1,"data-provider-id":Object(S.k)(e.id)},i?l.a.createElement(b.b,{"data-test-subj":"render-truncatable-content"},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):l.a.createElement(I,{"data-test-subj":`render-content-${e.queryMatch.field}`},n(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,n,i]);return t?l.a.createElement(C,{dataProvider:e,render:n,scopeId:a,truncate:i}):(c=a,[m.b.rulePreview,g.a].includes(null!=c?c:"")?l.a.createElement(l.a.Fragment,null,o):l.a.createElement(j,{dataProvider:e,scopeId:a,hideTopN:r},o));var c}));_.displayName="DraggableWrapper";const D=l.a.memo((({children:e,registerProvider:t})=>(Object(s.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));D.displayName="ConditionalPortal"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var a=n(19),i=n(2),r=n.n(i),o=n(42),s=n(121),l=n(149),c=n(651);const u={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:c.o,content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:r.a.createElement(a.EuiCode,null,c.i),openButton:r.a.createElement(a.EuiCode,null,c.k)}})),anchor:u.ACTION_MENU},{title:c.a,content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:u.ADD_TO_FAVORITES},{timelineTab:l.g.query,title:c.b,content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:r.a.createElement(a.EuiCode,null," ",c.e)}})),anchor:u.DATA_VIEW},{timelineType:s.m.default,timelineTab:l.g.query,title:c.d,content:r.a.createElement(a.EuiText,null,c.c),anchor:u.DATA_PROVIDER},{title:c.m,content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:r.a.createElement(a.EuiCode,null,c.l),editButton:r.a.createElement(a.EuiCode,null,c.f)}})),anchor:u.SAVE_TIMELINE}],p={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:c.n}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(19),o=n(1363),s=n(130),l=n(151),c=n(137);let u=function(e){return e.FIRST_SEEN="first-seen",e.LAST_SEEN="last-seen",e}({});const d=i.a.memo((({indexPatterns:e,field:t,type:n,value:d})=>{const[p,{firstSeen:m,lastSeen:f,errorMessage:g}]=Object(o.a)({field:t,value:d,order:n===u.FIRST_SEEN?c.b.asc:c.b.desc,defaultIndex:e}),b=Object(a.useMemo)((()=>n===u.FIRST_SEEN?m:f),[m,f,n]);return null!=g?i.a.createElement(r.EuiToolTip,{position:"top",content:g,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":`firstLastSeenError-${n}`,id:`firstLastSeenError-${t}-${n}`},i.a.createElement(r.EuiIcon,{"aria-describedby":`firstLastSeenError-${t}-${n}`,type:"warning"})):i.a.createElement(i.a.Fragment,null,p&&i.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"m"}),p||null==b||"Invalid Date"!==new Date(b).toString()?!p&&null!==b&&i.a.createElement(r.EuiText,{"data-test-subj":"first-last-seen-value",size:"s"},i.a.createElement(l.b,{value:`${b}`})):b,!p&&null===b&&Object(s.d)())}));d.displayName="FirstLastSeen"},function(e,t,n){"use strict";n.d(t,"z",(function(){return i})),n.d(t,"s",(function(){return r})),n.d(t,"X",(function(){return o})),n.d(t,"t",(function(){return s})),n.d(t,"l",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"H",(function(){return d})),n.d(t,"I",(function(){return p})),n.d(t,"x",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"J",(function(){return h})),n.d(t,"K",(function(){return v})),n.d(t,"D",(function(){return E})),n.d(t,"E",(function(){return x})),n.d(t,"A",(function(){return j})),n.d(t,"m",(function(){return S})),n.d(t,"r",(function(){return O})),n.d(t,"u",(function(){return k})),n.d(t,"F",(function(){return w})),n.d(t,"P",(function(){return T})),n.d(t,"S",(function(){return I})),n.d(t,"W",(function(){return M})),n.d(t,"O",(function(){return C})),n.d(t,"p",(function(){return _})),n.d(t,"g",(function(){return D})),n.d(t,"i",(function(){return A})),n.d(t,"h",(function(){return F})),n.d(t,"G",(function(){return N})),n.d(t,"U",(function(){return P})),n.d(t,"v",(function(){return R})),n.d(t,"b",(function(){return L})),n.d(t,"B",(function(){return z})),n.d(t,"C",(function(){return q})),n.d(t,"V",(function(){return B})),n.d(t,"R",(function(){return $})),n.d(t,"T",(function(){return V})),n.d(t,"Q",(function(){return U})),n.d(t,"M",(function(){return G})),n.d(t,"N",(function(){return H})),n.d(t,"L",(function(){return W})),n.d(t,"y",(function(){return Q})),n.d(t,"o",(function(){return Y})),n.d(t,"q",(function(){return K})),n.d(t,"n",(function(){return J})),n.d(t,"w",(function(){return Z})),n.d(t,"f",(function(){return X}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.overviewTabLabel",{defaultMessage:"Overview"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationGuideTabLabel",{defaultMessage:"Investigation guide"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.updatesTabLabel",{defaultMessage:"Updates"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.jsonViewUpdatesTabLabel",{defaultMessage:"JSON view"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dismissButtonLabel",{defaultMessage:"Dismiss"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.aboutSectionLabel",{defaultMessage:"About"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.definitionSectionLabel",{defaultMessage:"Definition"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.scheduleSectionLabel",{defaultMessage:"Schedule"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.setupGuideSectionLabel",{defaultMessage:"Setup guide"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.nameFieldLabel",{defaultMessage:"Name"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.descriptionFieldLabel",{defaultMessage:"Description"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.authorFieldLabel",{defaultMessage:"Author"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldLabel",{defaultMessage:"Building block"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityFieldLabel",{defaultMessage:"Severity"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityMappingFieldLabel",{defaultMessage:"Severity override"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreFieldLabel",{defaultMessage:"Risk score"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreMappingFieldLabel",{defaultMessage:"Risk score override"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.referencesFieldLabel",{defaultMessage:"Reference URLs"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.falsePositivesFieldLabel",{defaultMessage:"False positive examples"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationFieldsFieldLabel",{defaultMessage:"Custom highlighted fields"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.licenseFieldLabel",{defaultMessage:"License"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleNameOverrideFieldLabel",{defaultMessage:"Rule name override"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFieldLabel",{defaultMessage:"MITRE ATT&CK™"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndicatorPathFieldLabel",{defaultMessage:"Indicator prefix override"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timestampOverrideFieldLabel",{defaultMessage:"Timestamp override"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.tagsFieldLabel",{defaultMessage:"Tags"}),_=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.indexFieldLabel",{defaultMessage:"Index patterns"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIdFieldLabel",{defaultMessage:"Data view ID"}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFieldLabel",{defaultMessage:"Data view index pattern"}),F=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFetchErrorMessage",{defaultMessage:"Could not load data view index pattern"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleTypeFieldLabel",{defaultMessage:"Rule type"}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.thresholdFieldLabel",{defaultMessage:"Threshold"}),R=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.machineLearningJobIdFieldLabel",{defaultMessage:"Machine Learning job"}),L=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.anomalyThresholdFieldLabel",{defaultMessage:"Anomaly score threshold"}),z=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.relatedIntegrationsFieldLabel",{defaultMessage:"Related integrations"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.requiredFieldsFieldLabel",{defaultMessage:"Required fields"}),B=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timelineTitleFieldLabel",{defaultMessage:"Timeline template"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndexFieldLabel",{defaultMessage:"Indicator index patterns"}),V=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatMappingFieldLabel",{defaultMessage:"Indicator mapping"}),U=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFiltersFieldLabel",{defaultMessage:"Indicator filters"}),G=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsByFieldLabel",{defaultMessage:"Suppress alerts by"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsForFieldLabel",{defaultMessage:"Suppress alerts for"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressionFieldMissingFieldLabel",{defaultMessage:"If a suppression field is missing"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.newTermsFieldsFieldLabel",{defaultMessage:"Fields"}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.historyWindowSizeFieldLabel",{defaultMessage:"History Window Size"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.intervalFieldLabel",{defaultMessage:"Runs every"}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.fromFieldLabel",{defaultMessage:"Additional look-back time"}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.maxAlertsFieldLabel",{defaultMessage:"Max alerts per run"}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.customizedPrebuiltRuleLabel",{defaultMessage:"Customized Elastic rule"})},,function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return b}));var a=n(65),i=n(5),r=(n(167),n(118)),o=n(428);n(412);const s=async({query:e,signal:t})=>r.b.get().http.fetch(i.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(e),signal:t}),l=async({query:e,status:t,signal:n})=>r.b.get().http.fetch(i.sb,{version:"2023-10-31",method:"POST",body:JSON.stringify({conflicts:"proceed",status:t,query:e}),signal:n}),c=async({signalIds:e,status:t,signal:n})=>r.b.get().http.fetch(i.sb,{version:"2023-10-31",method:"POST",body:JSON.stringify({status:t,signal_ids:e}),signal:n}),u=async({signal:e})=>r.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"GET",signal:e}),d=async({signal:e})=>r.b.get().http.fetch(i.hb,{version:"1",method:"GET",signal:e}),p=async({signal:e})=>r.b.get().http.fetch(i.mb,{version:"2023-10-31",method:"GET",signal:e}),m=async({signal:e})=>r.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"POST",signal:e}),f=async({endpointId:e,comment:t="",caseIds:n,agentType:a})=>Object(o.a)({endpoint_ids:[e],comment:t,case_ids:n,agent_type:a}),g=async({endpointId:e,comment:t="",caseIds:n,agentType:a})=>Object(o.b)({endpoint_ids:[e],comment:t,case_ids:n,agent_type:a}),b=async({alertId:e,owner:t})=>r.b.get().http.fetch(Object(a.getCasesFromAlertsUrl)(e),{method:"get",query:{...t.length>0?{owner:t}:{}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var a=n(2);t.useFirstMountState=function(){var e=a.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveHookState=void 0,t.resolveHookState=function(e,t){return"function"==typeof e?e(t):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(328));t.default=function(e){var t=i.useRef(e);t.current=e,r.default((function(){return function(){return t.current()}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(120),i=n(199);const r=a.z.object({id:a.z.string().optional(),rule_id:i.P.optional(),list_id:a.z.string().min(1).optional(),item_id:a.z.string().min(1).optional(),error:a.z.object({status_code:a.z.number().int().min(400),message:a.z.string()})}).strict()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(409),i=n(580),r=n(207);const o=e=>`${Object(r.a)(e)}`,s=(e,t,n,o=i.a.events)=>`/ip/${e}/${t||a.a.source}/${o}${Object(r.a)(n)}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(44);const i=e=>Object(a.isString)(e)?e:JSON.stringify(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(2),i=n(45),r=n(4),o=n(1341),s=n(748),l=n(1334),c=n(1491),u=n(122),d=n(213),p=n(118),m=n(146),f=n(121),g=n(129),b=n(817),y=n(556),h=n(331),v=n(172),E=n(131),x=n(123),j=n(187),S=n(219),O=n(274),k=n(243);const w=({ecsRowData:e,onInvestigateInTimelineAlertClick:t})=>{const{addError:n}=Object(x.a)(),{data:{search:w}}=Object(p.j)().services,T=Object(i.useDispatch)(),{startTransaction:I}=Object(j.b)(),{services:M}=Object(p.j)(),{getExceptionFilterFromIds:C}=Object(c.a)(M.http),_=Object(a.useCallback)((async e=>{const t=(e=>{var t;let n=null!==(t=Object(E.getField)(e,o.i))&&void 0!==t?t:[],a=[];try{if(Array.isArray(n)&&0===n.length){var i;const t=null!==(i=Object(E.getField)(e,s.t))&&void 0!==i?i:{};if(t.length>0){var r;const e=JSON.parse(t[0]);n=null!==(r=null==e?void 0:e.exceptions_list)&&void 0!==r?r:[]}}else if(n&&n.list_id)return n.list_id.map(((e,t)=>{const a=n.type[t];return{exception_list_id:e,namespace_type:n.namespace_type[t],type:a}})).filter((e=>e.type===l.a.DETECTION))}catch(e){}return a=n.reduce(((e,t)=>{try{const n="string"==typeof t?JSON.parse(t):t;if(n.type===l.a.DETECTION){const t={exception_list_id:n.list_id,namespace_type:n.namespace_type};e.push(t)}}catch{}return e}),[]),a})(e);let a;return t.length>0&&await C({exceptionListIds:t,excludeExceptions:!0,chunkSize:20,alias:"Exceptions",onSuccess:e=>{a=e},onError:e=>{n(e,{title:r.i18n.translate("xpack.securitySolution.detectionEngine.alerts.fetchExceptionFilterFailure",{defaultMessage:"Error fetching exception filter."})})}}),a}),[n,C]),D=Object(a.useCallback)((e=>T(g.a.updateIsLoading(e))),[T]),A=Object(h.a)({timelineId:m.c.active,timelineType:f.m.default}),F=Object(u.a)("unifiedComponentsInTimelineDisabled"),N=Object(y.a)(),P=Object(a.useCallback)((async({from:e,timeline:t,to:n,ruleNote:a})=>{var i;await A(),D({id:m.c.active,isLoading:!1}),N({duplicate:!0,from:e,id:m.c.active,notes:[],timeline:{...t,columns:F?k.b:O.a,indexNames:null!==(i=t.indexNames)&&void 0!==i?i:[],show:!0,excludedRowRendererIds:F||t.timelineType===f.m.template?[]:t.excludedRowRendererIds},to:n,ruleNote:a})}),[N,D,A,F]),R=Object(a.useCallback)((async()=>{Object(d.a)(),I({name:S.a.INVESTIGATE_IN_TIMELINE}),t&&t(),null!=e&&await Object(b.b)({createTimeline:P,ecsData:e,searchStrategyClient:w,updateTimelineIsLoading:D,getExceptionFilter:_})}),[I,P,e,t,w,D,_]);return{investigateInTimelineActionItems:Object(a.useMemo)((()=>[{key:"investigate-in-timeline-action-item","data-test-subj":"investigate-in-timeline-action-item",disabled:null==e,onClick:R,name:v.i}]),[e,R]),investigateInTimelineAlertClick:R}}},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"g",(function(){return h}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),y=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),h=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(47),i=n(2),r=n(5),o=n(159),s=n(322);const l=["GET",r.rb],c=(e,t)=>Object(a.useQuery)([...l,e],(async({signal:t})=>{const n=await Object(o.j)({signal:t,...e});return{rules:n.data,total:n.total}}),{...s.a,staleTime:0,...t}),u=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])},d=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((t=>{e.setQueriesData(l,(e=>e?{rules:p(e.rules,t),total:e.total}:void 0))}),[e])};function p(e,t){const n=new Map(t.map((e=>[e.id,e])));return e.some((e=>n.has(e.id)))?e.map((e=>{var t;return null!==(t=n.get(e.id))&&void 0!==t?t:e})):e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(285),i=n(198);const r=()=>{const e=new URLSearchParams(window.location.search),t=e.has(i.a.flyout),n="()"!==e.get(i.a.flyout)&&"(preview:!())"!==e.get(i.a.flyout),r=t&&n,o=e.has(i.a.timelineFlyout),s="()"!==e.get(i.a.timelineFlyout)&&"(preview:!())"!==e.get(i.a.timelineFlyout),l=o&&s;return r&&l?a.a.timeline:r?a.a.securitySolution:l?a.a.timeline:null}},function(e,t,n){const a=n(190);e.exports=(e,t,n)=>a(e,t,n)>0},function(e,t,n){const a=Symbol("SemVer ANY");class Comparator{static get ANY(){return a}constructor(e,t){if(t=i(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===a?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?r[o.COMPARATORLOOSE]:r[o.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new c(n[2],this.options.loose):this.semver=a}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===a||e===a)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return s(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(e.value,t).test(this.value):""===e.operator?""===e.value||new u(this.value,t).test(e.semver):!((t=i(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(s(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(s(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=Comparator;const i=n(431),{safeRe:r,t:o}=n(311),s=n(673),l=n(347),c=n(164),u=n(193)},function(e,t,n){const a=n(193);e.exports=(e,t,n)=>{try{t=new a(t,n)}catch(e){return!1}return t.test(e)}},function(e,t,n){"use strict";var a=String.fromCharCode;e.exports=a},function(e,t,n){"use strict";var a=n(155),i=n(160),r={tokenize:function(e,t,n){return i(e,(function(e){return null===e||a(e)?t(e):n(e)}),"linePrefix")},partial:!0};e.exports=r},function(e,t,n){"use strict";var a=n(677);e.exports=function(e,t){var n=e[e.length-1];return n&&n[1].type===t?a(n[2].sliceStream(n[1])):0}},function(e,t,n){"use strict";var a=n(240)(/[\dA-Za-z]/);e.exports=a},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(66),r=n.n(i),o=n(953),s=n(43);const l=(e,t)=>n=>(r.a.render(Object(s.jsx)(o.a,t,e),n),()=>r.a.unmountComponentAtNode(n));n(0),n(4),a.Component},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return x}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(197),c=n(300),u=n(4);const d=u.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),p=u.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),m=s()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),f=s.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),g=s.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),b=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(i.useState)(null),[o,s]=(e=>{const[t,n]=Object(i.useState)(null),a=Object(i.useRef)(null);return Object(i.useEffect)((()=>{var e,t,i,r,o,s,l,c,u;null!=(null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==a||null===(i=a.current)||void 0===i?void 0:i.scrollHeight)&&void 0!==t?t:0)>(null!==(r=null==a||null===(o=a.current)||void 0===o?void 0:o.clientHeight)&&void 0!==r?r:0)&&n(!0),(null!==(s=null===(l=a.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==s?s:0)<=(null!==(c=null==a||null===(u=a.current)||void 0===u?void 0:u.clientHeight)&&void 0!==c?c:0)&&n(!1))}),[a,e]),[t,a]})(e),l=Object(i.useCallback)((()=>{a((e=>!e))}),[]);return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{"data-test-subj":"expanded-line-clamp"},r.a.createElement("p",null,e)),o&&r.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},p)):r.a.createElement(r.a.Fragment,null,null==o||!0===o?r.a.createElement(g,{"data-test-subj":"styled-line-clamp",ref:s,lineClampHeight:t},e):e,o&&r.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},d))},y=r.a.memo(b),h=s.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),v=Object(i.createContext)({}),E=({basicData:e,ruleNote:t,showFullView:n=!1,showTitle:i=!0})=>r.a.createElement(v.Provider,{value:e},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},r.a.createElement("h5",null,l.q)),r.a.createElement(a.EuiSpacer,{size:"s"})),r.a.createElement(h,null,n?r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},r.a.createElement(c.b,null,t)):r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},r.a.createElement(y,{lineClampHeight:4.5},r.a.createElement(c.b,null,t))))),x=r.a.memo(E)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=a.string;a.union([i,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=a.string;a.union([i,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(46);const i=a.keyof({excluded:null,included:null});let r=function(e){return e.INCLUDED="included",e.EXCLUDED="excluded",e}({});a.keyof({nested:null,match:null,match_any:null,wildcard:null,exists:null,list:null});let o=function(e){return e.NESTED="nested",e.MATCH="match",e.MATCH_ANY="match_any",e.WILDCARD="wildcard",e.EXISTS="exists",e.LIST="list",e}({})},function(e,t,n){"use strict";n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return i})),n.d(t,"NetworkDetailsTableType",(function(){return r}));let a=function(e){return e.page="page",e.details="details",e}({}),i=function(e){return e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies",e}({}),r=function(e){return e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a=400,i=null},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(23),i=n(47),r=n(2),o=n(159),s=n(322);const l=["GET",a.INTERNAL_ALERTING_API_FIND_RULES_PATH],c=(e,t)=>Object(i.useQuery)([...l,...e],(({signal:t})=>Object(o.k)({ids:e,signal:t})),{...s.a,...t}),u=()=>{const e=Object(i.useQueryClient)();return Object(r.useCallback)((()=>e.invalidateQueries(l,{refetchType:"active"})),[e])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return c}));const a=["50%","50%"],i=["30%","70%"],r=["version","name","description","author","building_block","severity","severity_mapping","risk_score","risk_score_mapping","references","false_positives","license","rule_name_override","threat","threat_indicator_path","timestamp_override","tags"],o=["data_source","type","kql_query","eql_query","event_category_override","timestamp_field","tiebreaker_field","esql_query","anomaly_threshold","machine_learning_job_id","related_integrations","required_fields","timeline_template","threshold","threat_index","threat_mapping","threat_query","threat_indicator_path","concurrent_searches","items_per_search","alert_suppression","new_terms_fields","history_window_start","max_signals"],s=["rule_schedule"],l=["setup","note"],c=[...r,...o,...s,...l]},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const a="cellAction-filter",i="cellAction-copy";let r=function(e){return e.HOVER_DOWN="hover-down",e.HOVER_RIGHT="hover-right",e.INLINE="inline",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>Object.keys(t).reduce(((e,n)=>e.replace(new RegExp(`\\{${n}\\}`,"g"),String(t[n]))),e)},function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function c(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&s(e).forEach((function(t){a[t]=r(e[t],n)})),s(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&n.isMergeableObject(t[i])?a[i]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"==typeof n?n:c}(i,n)(e[i],t[i],n):a[i]=r(t[i],n))})),a}(e,t,n):r(t,n)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};var u=c;e.exports=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(985);Object.defineProperty(t,"createMemo",{enumerable:!0,get:function(){return a.default}});var i=n(986);Object.defineProperty(t,"createReducerContext",{enumerable:!0,get:function(){return i.default}});var r=n(987);Object.defineProperty(t,"createReducer",{enumerable:!0,get:function(){return r.default}});var o=n(988);Object.defineProperty(t,"createStateContext",{enumerable:!0,get:function(){return o.default}});var s=n(445);Object.defineProperty(t,"useAsync",{enumerable:!0,get:function(){return s.default}});var l=n(427);Object.defineProperty(t,"useAsyncFn",{enumerable:!0,get:function(){return l.default}});var c=n(989);Object.defineProperty(t,"useAsyncRetry",{enumerable:!0,get:function(){return c.default}});var u=n(990);Object.defineProperty(t,"useAudio",{enumerable:!0,get:function(){return u.default}});var d=n(992);Object.defineProperty(t,"useBattery",{enumerable:!0,get:function(){return d.default}});var p=n(994);Object.defineProperty(t,"useBeforeUnload",{enumerable:!0,get:function(){return p.default}});var m=n(995);Object.defineProperty(t,"useBoolean",{enumerable:!0,get:function(){return m.default}});var f=n(996);Object.defineProperty(t,"useClickAway",{enumerable:!0,get:function(){return f.default}});var g=n(997);Object.defineProperty(t,"useCookie",{enumerable:!0,get:function(){return g.default}});var b=n(999);Object.defineProperty(t,"useCopyToClipboard",{enumerable:!0,get:function(){return b.default}});var y=n(637);Object.defineProperty(t,"useCounter",{enumerable:!0,get:function(){return y.default}});var h=n(1001);Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return h.default}});var v=n(461);Object.defineProperty(t,"useCustomCompareEffect",{enumerable:!0,get:function(){return v.default}});var E=n(808);Object.defineProperty(t,"useDebounce",{enumerable:!0,get:function(){return E.default}});var x=n(809);Object.defineProperty(t,"useDeepCompareEffect",{enumerable:!0,get:function(){return x.default}});var j=n(1007);Object.defineProperty(t,"useDefault",{enumerable:!0,get:function(){return j.default}});var S=n(1008);Object.defineProperty(t,"useDrop",{enumerable:!0,get:function(){return S.default}});var O=n(1009);Object.defineProperty(t,"useDropArea",{enumerable:!0,get:function(){return O.default}});var k=n(328);Object.defineProperty(t,"useEffectOnce",{enumerable:!0,get:function(){return k.default}});var w=n(1010);Object.defineProperty(t,"useEnsuredForwardedRef",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"ensuredForwardRef",{enumerable:!0,get:function(){return w.ensuredForwardRef}});var T=n(557);Object.defineProperty(t,"useEvent",{enumerable:!0,get:function(){return T.default}});var I=n(1011);Object.defineProperty(t,"useError",{enumerable:!0,get:function(){return I.default}});var M=n(1012);Object.defineProperty(t,"useFavicon",{enumerable:!0,get:function(){return M.default}});var C=n(1013);Object.defineProperty(t,"useFullscreen",{enumerable:!0,get:function(){return C.default}});var _=n(1015);Object.defineProperty(t,"useGeolocation",{enumerable:!0,get:function(){return _.default}});var D=n(638);Object.defineProperty(t,"useGetSet",{enumerable:!0,get:function(){return D.default}});var A=n(1016);Object.defineProperty(t,"useGetSetState",{enumerable:!0,get:function(){return A.default}});var F=n(1017);Object.defineProperty(t,"useHarmonicIntervalFn",{enumerable:!0,get:function(){return F.default}});var N=n(1019);Object.defineProperty(t,"useHover",{enumerable:!0,get:function(){return N.default}});var P=n(639);Object.defineProperty(t,"useHoverDirty",{enumerable:!0,get:function(){return P.default}});var R=n(1020);Object.defineProperty(t,"useIdle",{enumerable:!0,get:function(){return R.default}});var L=n(1022);Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return L.default}});var z=n(1023);Object.defineProperty(t,"useInterval",{enumerable:!0,get:function(){return z.default}});var q=n(37);Object.defineProperty(t,"useIsomorphicLayoutEffect",{enumerable:!0,get:function(){return q.default}});var B=n(640);Object.defineProperty(t,"useKey",{enumerable:!0,get:function(){return B.default}});var $=n(1024);Object.defineProperty(t,"createBreakpoint",{enumerable:!0,get:function(){return $.default}});var V=n(641);Object.defineProperty(t,"useKeyPress",{enumerable:!0,get:function(){return V.default}});var U=n(1025);Object.defineProperty(t,"useKeyPressEvent",{enumerable:!0,get:function(){return U.default}});var G=n(642);Object.defineProperty(t,"useLatest",{enumerable:!0,get:function(){return G.default}});var H=n(643);Object.defineProperty(t,"useLifecycles",{enumerable:!0,get:function(){return H.default}});var W=n(644);Object.defineProperty(t,"useList",{enumerable:!0,get:function(){return W.default}});var Q=n(645);Object.defineProperty(t,"useLocalStorage",{enumerable:!0,get:function(){return Q.default}});var Y=n(1026);Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return Y.default}});var K=n(1027);Object.defineProperty(t,"useLockBodyScroll",{enumerable:!0,get:function(){return K.default}});var J=n(1028);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return J.default}});var Z=n(1029);Object.defineProperty(t,"useLongPress",{enumerable:!0,get:function(){return Z.default}});var X=n(898);Object.defineProperty(t,"useMap",{enumerable:!0,get:function(){return X.default}});var ee=n(1030);Object.defineProperty(t,"useMedia",{enumerable:!0,get:function(){return ee.default}});var te=n(1031);Object.defineProperty(t,"useMediaDevices",{enumerable:!0,get:function(){return te.default}});var ne=n(1032);Object.defineProperty(t,"useMediatedState",{enumerable:!0,get:function(){return ne.useMediatedState}});var ae=n(1033);Object.defineProperty(t,"useMethods",{enumerable:!0,get:function(){return ae.default}});var ie=n(1034);Object.defineProperty(t,"useMotion",{enumerable:!0,get:function(){return ie.default}});var re=n(646);Object.defineProperty(t,"useMount",{enumerable:!0,get:function(){return re.default}});var oe=n(251);Object.defineProperty(t,"useMountedState",{enumerable:!0,get:function(){return oe.default}});var se=n(647);Object.defineProperty(t,"useMouse",{enumerable:!0,get:function(){return se.default}});var le=n(1035);Object.defineProperty(t,"useMouseHovered",{enumerable:!0,get:function(){return le.default}});var ce=n(1036);Object.defineProperty(t,"useMouseWheel",{enumerable:!0,get:function(){return ce.default}});var ue=n(1037);Object.defineProperty(t,"useNetwork",{enumerable:!0,get:function(){return ue.default}});var de=n(1038);Object.defineProperty(t,"useNumber",{enumerable:!0,get:function(){return de.default}});var pe=n(8);Object.defineProperty(t,"useObservable",{enumerable:!0,get:function(){return pe.default}});var me=n(1039);Object.defineProperty(t,"useOrientation",{enumerable:!0,get:function(){return me.default}});var fe=n(1040);Object.defineProperty(t,"usePageLeave",{enumerable:!0,get:function(){return fe.default}});var ge=n(1041);Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return ge.default}});var be=n(271);Object.defineProperty(t,"usePrevious",{enumerable:!0,get:function(){return be.default}});var ye=n(1042);Object.defineProperty(t,"usePreviousDistinct",{enumerable:!0,get:function(){return ye.default}});var he=n(1043);Object.defineProperty(t,"usePromise",{enumerable:!0,get:function(){return he.default}});var ve=n(1044);Object.defineProperty(t,"useQueue",{enumerable:!0,get:function(){return ve.default}});var Ee=n(648);Object.defineProperty(t,"useRaf",{enumerable:!0,get:function(){return Ee.default}});var xe=n(1045);Object.defineProperty(t,"useRafLoop",{enumerable:!0,get:function(){return xe.default}});var je=n(329);Object.defineProperty(t,"useRafState",{enumerable:!0,get:function(){return je.default}});var Se=n(1046);Object.defineProperty(t,"useSearchParam",{enumerable:!0,get:function(){return Se.default}});var Oe=n(1047);Object.defineProperty(t,"useScratch",{enumerable:!0,get:function(){return Oe.default}});var ke=n(1053);Object.defineProperty(t,"useScroll",{enumerable:!0,get:function(){return ke.default}});var we=n(1054);Object.defineProperty(t,"useScrolling",{enumerable:!0,get:function(){return we.default}});var Te=n(810);Object.defineProperty(t,"useSessionStorage",{enumerable:!0,get:function(){return Te.default}});var Ie=n(327);Object.defineProperty(t,"useSetState",{enumerable:!0,get:function(){return Ie.default}});var Me=n(751);Object.defineProperty(t,"useShallowCompareEffect",{enumerable:!0,get:function(){return Me.default}});var Ce=n(1056);Object.defineProperty(t,"useSize",{enumerable:!0,get:function(){return Ce.default}});var _e=n(1057);Object.defineProperty(t,"useSlider",{enumerable:!0,get:function(){return _e.default}});var De=n(1058);Object.defineProperty(t,"useSpeech",{enumerable:!0,get:function(){return De.default}});var Ae=n(1059);Object.defineProperty(t,"useStartTyping",{enumerable:!0,get:function(){return Ae.default}});var Fe=n(1060);Object.defineProperty(t,"useStateWithHistory",{enumerable:!0,get:function(){return Fe.useStateWithHistory}});var Ne=n(1061);Object.defineProperty(t,"useStateList",{enumerable:!0,get:function(){return Ne.default}});var Pe=n(1062);Object.defineProperty(t,"useThrottle",{enumerable:!0,get:function(){return Pe.default}});var Re=n(1063);Object.defineProperty(t,"useThrottleFn",{enumerable:!0,get:function(){return Re.default}});var Le=n(1064);Object.defineProperty(t,"useTimeout",{enumerable:!0,get:function(){return Le.default}});var ze=n(462);Object.defineProperty(t,"useTimeoutFn",{enumerable:!0,get:function(){return ze.default}});var qe=n(1065);Object.defineProperty(t,"useTitle",{enumerable:!0,get:function(){return qe.default}});var Be=n(636);Object.defineProperty(t,"useToggle",{enumerable:!0,get:function(){return Be.default}});var $e=n(1066);Object.defineProperty(t,"useTween",{enumerable:!0,get:function(){return $e.default}});var Ve=n(373);Object.defineProperty(t,"useUnmount",{enumerable:!0,get:function(){return Ve.default}});var Ue=n(1067);Object.defineProperty(t,"useUnmountPromise",{enumerable:!0,get:function(){return Ue.default}});var Ge=n(280);Object.defineProperty(t,"useUpdate",{enumerable:!0,get:function(){return Ge.default}});var He=n(326);Object.defineProperty(t,"useUpdateEffect",{enumerable:!0,get:function(){return He.default}});var We=n(1068);Object.defineProperty(t,"useUpsert",{enumerable:!0,get:function(){return We.default}});var Qe=n(1069);Object.defineProperty(t,"useVibrate",{enumerable:!0,get:function(){return Qe.default}});var Ye=n(1070);Object.defineProperty(t,"useVideo",{enumerable:!0,get:function(){return Ye.default}});var Ke=n(1071);Object.defineProperty(t,"useStateValidator",{enumerable:!0,get:function(){return Ke.default}});var Je=n(1072);Object.defineProperty(t,"useScrollbarWidth",{enumerable:!0,get:function(){return Je.useScrollbarWidth}});var Ze=n(1074);Object.defineProperty(t,"useMultiStateValidator",{enumerable:!0,get:function(){return Ze.useMultiStateValidator}});var Xe=n(1075);Object.defineProperty(t,"useWindowScroll",{enumerable:!0,get:function(){return Xe.default}});var et=n(1076);Object.defineProperty(t,"useWindowSize",{enumerable:!0,get:function(){return et.default}});var tt=n(1077);Object.defineProperty(t,"useMeasure",{enumerable:!0,get:function(){return tt.default}});var nt=n(1078);Object.defineProperty(t,"useRendersCount",{enumerable:!0,get:function(){return nt.useRendersCount}});var at=n(371);Object.defineProperty(t,"useFirstMountState",{enumerable:!0,get:function(){return at.useFirstMountState}});var it=n(1079);Object.defineProperty(t,"useSet",{enumerable:!0,get:function(){return it.default}});var rt=n(1080);Object.defineProperty(t,"createGlobalState",{enumerable:!0,get:function(){return rt.createGlobalState}});var ot=n(1081);Object.defineProperty(t,"useHash",{enumerable:!0,get:function(){return ot.useHash}})},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(5);const i=`${a.qb}/prepackaged`,r=`${a.Lb}/prebuilt_rules`,o=`${i}/_status`,s=`${r}/status`,l=`${r}/upgrade/_review`,c=`${r}/upgrade/_perform`,u=`${r}/installation/_review`,d=`${r}/installation/_perform`},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(44),i=n(2),r=n.n(i),o=n(179),s=n(961);const l=r.a.memo((({dataProvider:e})=>{var t;const[n,l]=Object(i.useState)(!1);return r.a.createElement(s.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:l,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||o.d,type:e.type||o.a.default})}));l.displayName="Provider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(282),r=n(124),o=n(148);const s=({visualizationId:e})=>{const t=Object(a.useMemo)((()=>o.d.globalQueryByIdSelector()),[]),{inspect:n,loading:s,searchSessionId:l}=Object(r.a)((n=>t(n,e)));return Object(a.useMemo)((()=>({requests:n?Object(i.g)(null==n?void 0:n.dsl):null,responses:n?Object(i.g)(null==n?void 0:n.response):null,loading:s,searchSessionId:l})),[n,s,l])}},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(178),i=n(223),r=n(563);const o=e=>"boolean"==typeof e,s=(e,t)=>{var n;return null==e||!((null===(n=e.actions)||void 0===n?void 0:n.length)>0&&o(t))||t},l=e=>null==e||e,c=(e,t,n,o)=>null==e?void 0:Object(i.d)(e.type)&&!t?r.d:s(e,n)?l(o)?void 0:a.kc:a.jc},function(e,t,n){const a=n(190);e.exports=(e,t,n)=>a(e,t,n)>=0},,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return E}));var a=n(7),i=n(2),r=n.n(i),o=n(407),s=n(5),l=n(670),c=n(198),u=n(118),d=n(213),p=n(781),m=n(523),f=n(939),g=n(618);function b(e,t){const n=t.safeParse(e);if(n.success)return n.data}const y=Object(i.createContext)(null),h=({children:e})=>{var t,n,a,l,h,v,E,j,S;const[O]=Object(u.o)(s.Z),{sessionStorage:k}=Object(u.j)().services,{filter:w,sorting:T,pagination:I}=function(){const e=Object(d.g)(c.a.rulesTable),{services:{sessionStorage:t}}=Object(u.j)(),n=e(),a=function(e){try{return e.get(m.c)}catch{return null}}(t);if(!n&&!a)return{};const[i,r,o]=function(e,t){var n,a,i,r,o,l,c,u;const d=b(e,g.b),p=b(t,g.b),m={searchTerm:null!==(n=null==d?void 0:d.searchTerm)&&void 0!==n?n:null==p?void 0:p.searchTerm,source:null!==(a=null==d?void 0:d.source)&&void 0!==a?a:null==p?void 0:p.source,tags:null!==(i=null==d?void 0:d.tags)&&void 0!==i?i:null==p?void 0:p.tags,enabled:null!==(r=null==d?void 0:d.enabled)&&void 0!==r?r:null==p?void 0:p.enabled,ruleExecutionStatus:null!==(o=null==d?void 0:d.ruleExecutionStatus)&&void 0!==o?o:null==p?void 0:p.ruleExecutionStatus},f=b(e,g.c),y=b(t,g.c),h={field:null!==(l=null==f?void 0:f.field)&&void 0!==l?l:null==y?void 0:y.field,order:null!==(c=null==f?void 0:f.order)&&void 0!==c?c:null==y?void 0:y.order},v=b(e,g.e),E=b(t,g.d),x={page:null==v?void 0:v.page,perPage:null!==(u=null==v?void 0:v.perPage)&&void 0!==u?u:null==E?void 0:E.perPage};return x.perPage&&(x.perPage<0||x.perPage>s.Dc)&&delete x.perPage,[m,h,x]}(n,a);return{filter:i,sorting:r,pagination:o}}(),[M,C]=Object(i.useState)({filter:null!==(t=null==w?void 0:w.searchTerm)&&void 0!==t?t:f.a.filter,tags:null!==(n=null==w?void 0:w.tags)&&void 0!==n?n:f.a.tags,showCustomRules:null!==(a=(null==w?void 0:w.source)===g.a.Custom)&&void 0!==a?a:f.a.showCustomRules,showElasticRules:null!==(l=(null==w?void 0:w.source)===g.a.Prebuilt)&&void 0!==l?l:f.a.showElasticRules,enabled:null==w?void 0:w.enabled,ruleExecutionStatus:null!==(h=null==w?void 0:w.ruleExecutionStatus)&&void 0!==h?h:f.a.ruleExecutionStatus}),[_,D]=Object(i.useState)({field:null!==(v=null==T?void 0:T.field)&&void 0!==v?v:f.d.field,order:null!==(E=null==T?void 0:T.order)&&void 0!==E?E:f.d.order}),[A,F]=Object(i.useState)(!1),[N,P]=Object(i.useState)(O.on),[R,L]=Object(i.useState)({ids:[],action:null}),[z,q]=Object(i.useState)(!1),[B,$]=Object(i.useState)(null!==(j=null==I?void 0:I.page)&&void 0!==j?j:f.b),[V,U]=Object(i.useState)(null!==(S=null==I?void 0:I.perPage)&&void 0!==S?S:f.c),[G,H]=Object(i.useState)([]),W=Object(i.useRef)(null),Q=R.ids.length>0,Y=Object(i.useMemo)((()=>({page:B,perPage:V})),[B,V]),K=Object(i.useCallback)((e=>{C((t=>({...t,...e}))),$(1),H([]),F(!1)}),[]),J=Object(i.useCallback)((()=>{H([]),F(!1)}),[]),Z=Object(d.h)(),X=Object(i.useCallback)((()=>{C({filter:f.a.filter,showElasticRules:f.a.showElasticRules,showCustomRules:f.a.showCustomRules,tags:f.a.tags,enabled:void 0,ruleExecutionStatus:f.a.ruleExecutionStatus}),D({field:f.d.field,order:f.d.order}),$(f.b),U(f.c),Z({[c.a.rulesTable]:null}),k.remove(m.c)}),[C,D,$,U,Z,k]);Object(i.useEffect)((()=>{var e;G.length>0?(P(!1),null==W.current&&(W.current=N)):(P(null!==(e=W.current)&&void 0!==e?e:N),W.current=null)}),[G,N]);const{data:{rules:ee,total:te}={rules:[],total:0},refetch:ne,dataUpdatedAt:ae,isFetched:ie,isFetching:re,isLoading:oe,isRefetching:se}=Object(p.a)({filterOptions:M,sortingOptions:_,pagination:Y},{refetchOnWindowFocus:N&&!Q,refetchOnReconnect:N&&!Q,refetchInterval:N&&!Q&&O.value,keepPreviousData:!0}),{data:le,isLoading:ce,isFetching:ue,isError:de,refetch:pe}=Object(o.a)(ee.map((e=>e.id)),{enabled:ee.length>0}),me=Object(i.useCallback)((async()=>{const e=await ne();return await pe(),e}),[ne,pe]),fe=Object(i.useMemo)((()=>({reFetchRules:me,setFilterOptions:K,setIsAllSelected:F,setIsRefreshOn:P,setLoadingRules:L,setPage:$,setPerPage:U,setSelectedRuleIds:H,setSortingOptions:D,clearRulesSelection:J,setIsPreflightInProgress:q,clearFilters:X})),[me,K,F,P,L,$,U,H,D,J,q,X]),ge=Object(i.useMemo)((()=>({state:{rules:ee,rulesSnoozeSettings:{data:null!=le?le:{},isLoading:ce,isFetching:ue,isError:de},pagination:{page:B,perPage:V,total:te},filterOptions:M,isPreflightInProgress:z,isActionInProgress:Q,isAllSelected:A,isFetched:ie,isFetching:re,isLoading:oe,isRefetching:se,isRefreshOn:N,lastUpdated:ae,loadingRuleIds:R.ids,loadingRulesAction:R.action,selectedRuleIds:G,sortingOptions:_,isDefault:x(M,_,{page:B,perPage:V,total:te})},actions:fe})),[ee,le,ce,ue,de,B,V,te,M,z,Q,A,ie,re,oe,se,N,ae,R.ids,R.action,G,_,fe]);return r.a.createElement(y.Provider,{value:ge},e)},v=()=>{const e=Object(i.useContext)(y);return Object(l.a)(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},E=()=>Object(i.useContext)(y);function x(e,t,n){return Object(a.isEqual)(e,f.a)&&Object(a.isEqual)(t,f.d)&&n.page===f.b&&n.perPage===f.c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(19);const u=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?o.a.createElement(c.EuiToolTip,{display:"block",content:e},o.a.createElement(u,i()({"data-test-subj":n},a),t)):o.a.createElement(u,i()({"data-test-subj":n},a),t)}u.displayName="EllipsisText"},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251));t.default=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var o=i.useRef(0),s=r.default(),l=i.useState(n),c=l[0],u=l[1],d=i.useCallback((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=++o.current;return u((function(e){return a.__assign(a.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return s()&&i===o.current&&u({value:e,loading:!1}),e}),(function(e){return s()&&i===o.current&&u({error:e,loading:!1}),e}))}),t);return[c,d]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(118),i=n(167);const r=async e=>a.b.get().http.post(i.t,{body:JSON.stringify(e),version:"2023-10-31"}),o=async e=>a.b.get().http.post(i.B,{body:JSON.stringify(e),version:"2023-10-31"})},function(e,t,n){"use strict";const a=n(805),i=n(806),r=n(807);function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function l(e,t){return t.decode?i(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function m(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=n):a[e]=n};case"bracket":return(e,n,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],n):a[e]=[n]:a[e]=n};case"comma":case"separator":return(t,n,a)=>{const i="string"==typeof n&&n.split("").indexOf(e.arrayFormatSeparator)>-1?n.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===n?n:l(n,e);a[t]=i};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const i of e.split("&")){let[e,o]=r(t.decode?i.replace(/\+/g," "):i,"=");o=void 0===o?null:["comma","separator"].includes(t.arrayFormat)?o:l(o,t),n(l(e,t),o,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=p(n[e],t);else a[e]=p(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=c(n):e[t]=n,e}),Object.create(null))}t.extract=d,t.parse=m,t.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,a)=>{const i=n.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[s(t,e),"[",i,"]"].join("")]:[...n,[s(t,e),"[",s(i,e),"]=",s(a,e)].join("")]};case"bracket":return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[s(t,e),"[]"].join("")]:[...n,[s(t,e),"[]=",s(a,e)].join("")];case"comma":case"separator":return t=>(n,a)=>null==a||0===a.length?n:0===n.length?[[s(t,e),"=",s(a,e)].join("")]:[[n,s(a,e)].join(e.arrayFormatSeparator)];default:return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,s(t,e)]:[...n,[s(t,e),"=",s(a,e)].join("")]}}(t),i={};for(const t of Object.keys(e))n(t)||(i[t]=e[t]);const r=Object.keys(i);return!1!==t.sort&&r.sort(t.sort),r.map((n=>{const i=e[n];return void 0===i?"":null===i?s(n,t):Array.isArray(i)?i.reduce(a(n),[]).join("&"):s(n,t)+"="+s(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,a]=r(e,"#");return Object.assign({url:n.split("?")[0]||"",query:m(d(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:l(a,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const a=u(e.url).split("?")[0]||"",i=t.extract(e.url),r=t.parse(i,{sort:!1}),o=Object.assign(r,e.query);let l=t.stringify(o,n);l&&(l=`?${l}`);let c=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(c=`#${s(e.fragmentIdentifier,n)}`),`${a}${l}${c}`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),o=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),s=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),c=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),u=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t){const n=Object.freeze({loose:!0}),a=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:a},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),r=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),o=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),s=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),l=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),c=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),u=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(44);const i=e=>e.replace(/:/g,"-"),r=e=>e.replace(/-/g,":"),o=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e)},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(19),i=n(2),r=n.n(i),o=n(42),s=n(4),l=n(1103),c=n(488),u=n(135),d=n(254);const p={OVERVIEW_TAB:c.c,RULE_PREVIEW:u.gb,NAVIGATION_BUTTON:l.f,ENTITIES:d.c,PREVALENCE:d.e},m={currentTourStep:1,isTourActive:!0},f=()=>[{title:s.i18n.translate("xpack.securitySolution.flyout.tour.overview.title",{defaultMessage:"More ways to understand your alerts"}),content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.overview.description",defaultMessage:"Explore new insights in the {entities} and {prevalence} sections.",values:{entities:r.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.overview.entities.text",{defaultMessage:"Entities"})),prevalence:r.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.overview.prevalence.text",{defaultMessage:"Prevalence"}))}})),stepNumber:1,anchor:p.OVERVIEW_TAB,anchorPosition:"downCenter"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.preview.title",{defaultMessage:"A quick way to access rule details"}),content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.rulePreview.description",defaultMessage:"Click {rulePreview} to learn more about the rule that generated the alert.",values:{rulePreview:r.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.rulePreview.text",{defaultMessage:"Show rule summary"}))}})),stepNumber:2,anchor:p.RULE_PREVIEW,anchorPosition:"rightUp"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.expandDetails.title",{defaultMessage:"An expanded view of important alert details"}),content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.expandDetails.description",defaultMessage:"Click the linked text to open and close the flyout's left panel. The left panel is a detailed view of sections in the right panel."})),stepNumber:3,anchor:p.NAVIGATION_BUTTON,anchorPosition:"downCenter"}],g=()=>[{title:s.i18n.translate("xpack.securitySolution.flyout.tour.entities.title",{defaultMessage:"New host and user insights are available"}),content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.entities.description",defaultMessage:"Check out the expanded {entities} view to learn more about hosts and users that are related to the alert.",values:{entities:r.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.entities.text",{defaultMessage:"Entities"}))}})),stepNumber:4,anchor:p.ENTITIES,anchorPosition:"rightUp"},{title:s.i18n.translate("xpack.securitySolution.flyout.tour.prevalence.title",{defaultMessage:"New host and user insights are available"}),content:r.a.createElement(a.EuiText,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.tour.prevalence.description",defaultMessage:"Check out the expanded {prevalence} view to learn how the alert is related to other alerts, events, and entities.",values:{prevalence:r.a.createElement(a.EuiCode,null,s.i18n.translate("xpack.securitySolution.flyout.tour.prevalence.text",{defaultMessage:"Prevalence"}))}})),stepNumber:5,anchor:p.PREVALENCE,anchorPosition:"rightUp"}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(2),i=n(47),r=n(473),o=n(159),s=n(322);const l=["GET",r.b],c=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(o.i)({signal:e})),{...s.a,...e}),u=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"g",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"f",(function(){return E})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return k})),n.d(t,"c",(function(){return w}));var a=n(44),i=n(54),r=n.n(i),o=n(413),s=n.n(o),l=n(1193),c=n.n(l),u=n(168),d=n(227),p=n(731),m=n(248),f=n(564),g=n(20);const b=e=>{const t={unit:"ms",value:0},n=e.match(/\d+/g),i=e.match(/[a-zA-Z]+/g);return Object(a.isEmpty)(n)||null==n||isNaN(Number(n[0]))||(t.value=Number(n[0])),!Object(a.isEmpty)(i)&&null!=i&&["s","m","h","d"].includes(i[0])&&(t.unit=i[0]),t},y=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:n,threshold:a,threatIndex:i,threatQueryBar:r,threatMapping:o,eqlOptions:s,newTermsFields:l,historyWindowSize:c,...u}=e;return u;case"threshold":const{anomalyThreshold:d,machineLearningJobId:p,threatIndex:m,threatQueryBar:f,threatMapping:g,eqlOptions:b,newTermsFields:y,historyWindowSize:h,...v}=e;return v;case"threat_match":const{anomalyThreshold:E,machineLearningJobId:x,threshold:j,eqlOptions:S,newTermsFields:O,historyWindowSize:k,...w}=e;return w;case"query":case"saved_query":const{anomalyThreshold:T,machineLearningJobId:I,threshold:M,threatIndex:C,threatQueryBar:_,threatMapping:D,eqlOptions:A,newTermsFields:F,historyWindowSize:N,...P}=e;return P;case"eql":const{anomalyThreshold:R,machineLearningJobId:L,threshold:z,threatIndex:q,threatQueryBar:B,threatMapping:$,newTermsFields:V,historyWindowSize:U,...G}=e;return G;case"new_terms":const{anomalyThreshold:H,machineLearningJobId:W,threshold:Q,threatIndex:Y,threatQueryBar:K,threatMapping:J,eqlOptions:Z,...X}=e;return X;case"esql":const{anomalyThreshold:ee,machineLearningJobId:te,threshold:ne,threatIndex:ae,threatQueryBar:ie,threatMapping:re,newTermsFields:oe,historyWindowSize:se,eqlOptions:le,index:ce,dataViewId:ue,...de}=e;return de}Object(d.a)(t)};function h(e){return e.filter((e=>"none"!==e.name))}const v=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:h(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?h(e.subtechnique):[]})))}})),E=e=>{const t={...e};return e.dataSourceType===m.a.DataView?c()(t,["index","dataSourceType"]):e.dataSourceType===m.a.IndexPatterns?c()(t,["dataViewId","dataSourceType"]):t},x=e=>{var t,n,i,r,o,s,l,c,u,d,p,f,b,h,v,x,j,S,O,k,w,T,I,M,C,_,D,A,F,N,P,R,L,z,q,B,$,V,U,G,H,W,Q,Y,K,J,Z,X,ee,te,ne,ae;const ie=E(e),re=y(ie,ie.ruleType),{ruleType:oe,timeline:se}=re,le={type:oe,related_integrations:null===(t=e.relatedIntegrations)||void 0===t?void 0:t.filter((e=>!Object(a.isEmpty)(e.package))),...null!=se.id&&null!=se.title&&{timeline_id:se.id,timeline_title:se.title}},ce=re.groupByFields.length>0?{alert_suppression:{group_by:re.groupByFields,duration:re.groupByRadioSelection===m.b.PerTimePeriod?re.groupByDuration:void 0,missing_fields_strategy:re.suppressionMissingFields||g.a}}:{},ue=(e=>e.filter((e=>""!==e.name&&""!==e.type)))(null!==(n=e.requiredFields)&&void 0!==n?n:[]);var de;return{...le,...(de=re,Object(a.has)("anomalyThreshold",de)?{anomaly_threshold:re.anomalyThreshold,machine_learning_job_id:re.machineLearningJobId,...ce}:(e=>Object(a.has)("threshold",e))(re)?{index:re.index,filters:null===(i=re.queryBar)||void 0===i?void 0:i.filters,language:null===(r=re.queryBar)||void 0===r||null===(o=r.query)||void 0===o?void 0:o.language,query:null===(s=re.queryBar)||void 0===s||null===(l=s.query)||void 0===l?void 0:l.query,saved_id:null!==(c=null===(u=re.queryBar)||void 0===u?void 0:u.saved_id)&&void 0!==c?c:void 0,required_fields:ue,..."threshold"===oe&&{threshold:{field:null!==(d=null===(p=re.threshold)||void 0===p?void 0:p.field)&&void 0!==d?d:[],value:null!==(f=parseInt(null===(b=re.threshold)||void 0===b?void 0:b.value,10))&&void 0!==f?f:0,cardinality:Object(a.isEmpty)(null===(h=re.threshold.cardinality)||void 0===h?void 0:h.field)||null==(null===(v=re.threshold.cardinality)||void 0===v?void 0:v.value)?[]:[{field:re.threshold.cardinality.field[0],value:parseInt(re.threshold.cardinality.value,10)}]},...re.enableThresholdSuppression&&{alert_suppression:{duration:re.groupByDuration}}}}:(e=>Object(a.has)("threatIndex",e))(re)?{index:re.index,filters:null===(x=re.queryBar)||void 0===x?void 0:x.filters,language:null===(j=re.queryBar)||void 0===j||null===(S=j.query)||void 0===S?void 0:S.language,query:null===(O=re.queryBar)||void 0===O||null===(k=O.query)||void 0===k?void 0:k.query,saved_id:null!==(w=null===(T=re.queryBar)||void 0===T?void 0:T.saved_id)&&void 0!==w?w:void 0,required_fields:ue,threat_index:re.threatIndex,threat_query:null===(I=re.threatQueryBar)||void 0===I||null===(M=I.query)||void 0===M?void 0:M.query,threat_filters:null===(C=re.threatQueryBar)||void 0===C?void 0:C.filters,threat_mapping:re.threatMapping,threat_language:null===(_=re.threatQueryBar)||void 0===_||null===(D=_.query)||void 0===D?void 0:D.language,...ce}:(e=>Object(a.has)("eqlOptions",e))(re)?{index:re.index,filters:null===(A=re.queryBar)||void 0===A?void 0:A.filters,language:null===(F=re.queryBar)||void 0===F||null===(N=F.query)||void 0===N?void 0:N.language,query:null===(P=re.queryBar)||void 0===P||null===(R=P.query)||void 0===R?void 0:R.query,saved_id:null!==(L=null===(z=re.queryBar)||void 0===z?void 0:z.saved_id)&&void 0!==L?L:void 0,required_fields:ue,timestamp_field:null===(q=re.eqlOptions)||void 0===q?void 0:q.timestampField,event_category_override:null===(B=re.eqlOptions)||void 0===B?void 0:B.eventCategoryField,tiebreaker_field:null===($=re.eqlOptions)||void 0===$?void 0:$.tiebreakerField,...ce}:(e=>Object(a.has)("newTermsFields",e))(re)?{index:re.index,filters:null===(V=re.queryBar)||void 0===V?void 0:V.filters,language:null===(U=re.queryBar)||void 0===U||null===(G=U.query)||void 0===G?void 0:G.language,query:null===(H=re.queryBar)||void 0===H||null===(W=H.query)||void 0===W?void 0:W.query,required_fields:ue,new_terms_fields:re.newTermsFields,history_window_start:`now-${re.historyWindowSize}`,...ce}:(e=>"esql"===Object(a.get)("queryBar.query.language",e))(re)&&!("index"in re)?{language:null===(Q=re.queryBar)||void 0===Q||null===(Y=Q.query)||void 0===Y?void 0:Y.language,query:null===(K=re.queryBar)||void 0===K||null===(J=K.query)||void 0===J?void 0:J.query,required_fields:ue,...ce}:{...ce,index:re.index,filters:null===(Z=re.queryBar)||void 0===Z?void 0:Z.filters,language:null===(X=re.queryBar)||void 0===X||null===(ee=X.query)||void 0===ee?void 0:ee.language,query:null===(te=re.queryBar)||void 0===te||null===(ne=te.query)||void 0===ne?void 0:ne.query,saved_id:void 0,required_fields:ue,type:"query",...["query","saved_query"].includes(oe)&&(null===(ae=re.queryBar)||void 0===ae?void 0:ae.saved_id)&&re.shouldLoadQueryDynamically&&{type:"saved_query",query:void 0,filters:void 0,saved_id:re.queryBar.saved_id}}),..."dataViewId"in re?{data_view_id:re.dataViewId}:{}}},j=e=>{const{...t}=e;if(!Object(a.isEmpty)(t.interval)&&!Object(a.isEmpty)(t.from)){const{unit:e,value:n}=b(t.interval),{unit:a,value:i}=b(t.from),o=r.a.duration(n,e);o.add(i,a),t.from=`now-${o.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},S=(e,t)=>{const{author:n,falsePositives:i,investigationFields:r,references:o,riskScore:s,severity:l,threat:c,isAssociatedToEndpointList:d,isBuildingBlock:p,maxSignals:m,note:f,ruleNameOverride:g,threatIndicatorPath:b,timestampOverride:y,timestampOverrideFallbackDisabled:h,...E}=e,x=null!=t?t.filter((e=>"endpoint"!==e.type)):[],j=r.every((e=>Object(a.isEmpty)(e.trim())));return{author:n.filter((e=>!Object(a.isEmpty)(e))),...p?{building_block_type:"default"}:{},...d?{exceptions_list:[{id:u.k,list_id:u.k,namespace_type:"agnostic",type:"endpoint"},...x]}:null!=t?{exceptions_list:[...x]}:{},false_positives:i.filter((e=>!Object(a.isEmpty)(e))),references:o.filter((e=>!Object(a.isEmpty)(e))),investigation_fields:j?void 0:{field_names:r},risk_score:s.value,risk_score_mapping:s.isMappingChecked?s.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==g?g:void 0,severity:l.value,severity_mapping:l.isMappingChecked?l.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:v(c).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:b,timestamp_override:""!==y?y:void 0,timestamp_override_fallback_disabled:h,...Object(a.isEmpty)(f)?{}:{note:f},max_signals:Number.isSafeInteger(m)?m:void 0,...E}},O=e=>{const{actions:t=[],responseActions:n,enabled:a,kibanaSiemAppUrl:i}=e;return{actions:t.map((e=>Object(p.b)(e))),response_actions:null==n?void 0:n.map(p.c),enabled:a,meta:{kibana_siem_app_url:i}}},k=(e,t,n,a,i)=>s.a.all([x(e),S(t,i),j(n),O(a)]),w=({defineRuleData:e,aboutRuleData:t,scheduleRuleData:n,exceptionsList:a})=>{const i={...t,name:"Preview Rule",description:"Preview Rule"};return{...k(e,i,n,f.c,a)}}},,function(e,t,n){"use strict";n.d(t,"d",(function(){return f.d})),n.d(t,"a",(function(){return f.a})),n.d(t,"f",(function(){return f.f})),n.d(t,"c",(function(){return f.c})),n.d(t,"e",(function(){return f.e})),n.d(t,"b",(function(){return f.b})),n.d(t,"g",(function(){return J}));var a=n(120);a.z.object({rules_custom_installed:a.z.number().int().min(0),rules_installed:a.z.number().int().min(0),rules_not_installed:a.z.number().int().min(0),rules_not_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_not_installed:a.z.number().int().min(0),timelines_not_updated:a.z.number().int().min(0)}).strict(),a.z.object({rules_installed:a.z.number().int().min(0),rules_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_updated:a.z.number().int().min(0)}).strict();var i=n(46);const r=i.exact(i.type({rule_id:i.string,version:i.number})),o=i.exact(i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(r)})),s=i.exact(i.type({mode:i.literal("ALL_RULES")}));i.union([s,o]);var l=n(2074);let c=function(e){return e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET",e}({});const u=Object(l.a)("PickVersionValues",c),d=i.exact(i.intersection([i.type({rule_id:i.string,revision:i.number,version:i.number}),i.partial({pick_version:u})])),p=i.exact(i.intersection([i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(d)}),i.partial({pick_version:u})])),m=i.exact(i.intersection([i.type({mode:i.literal("ALL_RULES")}),i.partial({pick_version:u})]));i.union([m,p]);var f=n(415),g=n(439);const b=e=>i.intersection([i.exact(i.type(e.required)),i.exact(i.type(Object(g.N)(e.optional)))]);var y=n(2076),h=n(425);let v=function(e){return e.index_patterns="index_patterns",e.data_view="data_view",e}({});const E=i.exact(i.type({type:i.literal(v.index_patterns),index_patterns:g.g})),x=i.exact(i.type({type:i.literal(v.data_view),data_view_id:g.c})),j=i.union([E,x]);let S=function(e){return e.inline_query="inline_query",e.saved_query="saved_query",e}({});const O=i.exact(i.type({type:i.literal(S.inline_query),query:g.w,language:g.i,filters:g.q})),k=i.exact(i.type({type:i.literal(S.saved_query),saved_query_id:h.b})),w=i.union([O,k]),T=i.exact(i.type({query:g.w,language:i.literal("eql"),filters:g.q})),I=i.exact(i.type({query:g.w,language:i.literal("esql")})),M=i.exact(i.type({interval:Object(y.a)({allowedUnits:["s","m","h"]}),lookback:Object(y.a)({allowedUnits:["s","m","h"]})})),C=i.exact(i.type({field_name:g.u})),_=i.exact(i.type({field_name:g.L,fallback_disabled:g.M})),D=i.exact(i.type({timeline_id:g.I,timeline_title:g.J})),A=i.exact(i.type({type:g.b}));var F=n(1781),N=n(2079),P=n(1780),R=n(2077),L=n(2131),z=n(1782),q=n(2137),B=n(2138);const $=b({required:{rule_id:g.y,version:g.A,meta:g.s,name:g.t,tags:g.z,description:g.o,severity:F.a,severity_mapping:N.a,risk_score:P.a,risk_score_mapping:R.a,references:g.x,false_positives:g.p,threat:g.F,note:g.h,setup:g.E,related_integrations:g.l,required_fields:g.m,author:g.n,license:g.r,rule_schedule:M,actions:L.a,throttle:z.a,exceptions_list:g.e,max_signals:g.j},optional:{rule_name_override:C,timestamp_override:_,timeline_template:D,building_block:A}}),V=b({required:{type:i.literal("query"),kql_query:w},optional:{data_source:j,alert_suppression:g.a}}),U=b({required:{type:i.literal("saved_query"),kql_query:w},optional:{data_source:j,alert_suppression:g.a}}),G=b({required:{type:i.literal("eql"),eql_query:T},optional:{data_source:j,event_category_override:g.d,timestamp_field:g.K,tiebreaker_field:g.H}}),H=b({required:{type:i.literal("esql"),esql_query:I},optional:{}}),W=b({required:{type:i.literal("threat_match"),kql_query:w,threat_query:O,threat_index:q.e,threat_mapping:q.g},optional:{data_source:j,threat_indicator_path:q.f,concurrent_searches:q.a,items_per_search:q.b}}),Q=b({required:{type:i.literal("threshold"),kql_query:w,threshold:g.G},optional:{data_source:j}}),Y=b({required:{type:i.literal("machine_learning"),machine_learning_job_id:B.a,anomaly_threshold:h.a},optional:{}}),K=b({required:{type:i.literal("new_terms"),kql_query:O,new_terms_fields:g.k,history_window_start:g.f},optional:{data_source:j}});i.intersection([$,i.union([V,U,G,H,W,Q,Y,K])]),n(7),Symbol("MissingVersion");let J=function(e){return e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C",e}({})},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return k}));var a=n(1532),i=n(2083),r=n(3),o=n(55),s=n(797);const l=Object(a.a)((e=>(({data:e,defaultIndex:t,eventFields:n,filterQuery:a,timerange:i,signal:r})=>e.search.search({defaultIndex:t,eventFields:n,factoryQueryType:s.a.eventEnrichment,filterQuery:a,timerange:i},{strategy:"securitySolutionSearchStrategy",abortSignal:r}))(e).pipe(Object(r.filter)((e=>!Object(o.isRunningResponse)(e)))))),c=()=>Object(i.a)(l);var u=n(2),d=n(45),p=n(7),m=n(271),f=n.n(m),g=n(138),b=n(195),y=n(123),h=n(118),v=n(200);const E=n(4).i18n.translate("xpack.securitySolution.investigationEnrichment.requestError",{defaultMessage:"An error occurred while requesting threat intelligence"});var x=n(5);const j="investigation_time_enrichment",S=()=>{},O={enrichments:[]},k=e=>{const{addError:t}=Object(y.a)(),{data:n,uiSettings:a}=Object(h.j)().services,i=a.get(x.bb),r=Object(d.useDispatch)(),[o,s]=Object(u.useState)({from:b.a,to:b.b}),{error:l,loading:m,result:k,start:w}=c(),T=Object(u.useCallback)((()=>{r(v.c.deleteOneQuery({inputId:g.a.global,id:j}))}),[r]);Object(u.useEffect)((()=>(!m&&k&&r(v.c.setQuery({inputId:g.a.global,id:j,inspect:{dsl:k.inspect.dsl,response:[JSON.stringify(k.rawResponse,null,2)]},loading:m,refetch:S})),T)),[T,r,m,k]),Object(u.useEffect)((()=>{l&&t(l,{title:E})}),[t,l]);const I=f()(e),M=f()(o);return Object(u.useEffect)((()=>{Object(p.isEmpty)(e)||Object(p.isEqual)(e,I)&&Object(p.isEqual)(o,M)||w({data:n,timerange:{...o,interval:""},defaultIndex:i,eventFields:e,filterQuery:""})}),[w,n,e,I,o,M,i]),{result:Object(p.isEmpty)(e)?O:k,range:o,setRange:s,loading:m}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(47),i=n(2),r=n(489),o=n(273),s=n(159),l=n(7);const c=["TA0043","TA0042","TA0001","TA0002","TA0003","TA0004","TA0005","TA0006","TA0007","TA0008","TA0009","TA0011","TA0010","TA0040"];function u(e){const t={totalRulesCount:Object.keys(e).length,totalEnabledRulesCount:0};for(const n of Object.keys(e))e[n].activity===o.b.Enabled&&t.totalEnabledRulesCount++;return t}function d(e){const t={enabledRules:[],disabledRules:[],availableRules:[]};for(const n of e.unmapped_rule_ids)p(t,n,e.rules_data[n]);return t}function p(e,t,n){n&&(n.activity===o.b.Enabled?e.enabledRules.push({id:t,name:n.name}):n.activity===o.b.Disabled&&e.disabledRules.push({id:t,name:n.name}))}var m=n(322),f=n(123);const g=["POST",o.d],b=(e={},t)=>{const{addError:i}=Object(f.a)();return Object(a.useQuery)([...g,e],(async({signal:t})=>async function(e){const t=await n.e(24).then(n.bind(null,1481)),{tactics:a,techniques:i,subtechniques:r}=t,o=function(e,t,n){const a=new Map;for(const e of n){const t={id:e.id,name:e.name,reference:e.reference,enabledRules:[],disabledRules:[],availableRules:[]},n=a.get(e.techniqueId);n?n.push(t):a.set(e.techniqueId,[t])}const i=new Map;for(const e of t){var r;const t=null!==(r=a.get(e.id))&&void 0!==r?r:[];for(const n of e.tactics){const a={id:e.id,name:e.name,reference:e.reference,subtechniques:t,enabledRules:[],disabledRules:[],availableRules:[]},r=i.get(n);r?r.push(a):i.set(n,[a])}}const o=e.sort(((e,t)=>c.indexOf(e.id)-c.indexOf(t.id))),s=[];for(const e of o){var u;s.push({id:e.id,name:e.name,reference:e.reference,techniques:null!==(u=i.get(Object(l.kebabCase)(e.name)))&&void 0!==u?u:[],enabledRules:[],disabledRules:[],availableRules:[]})}return s}(a,i,r);for(const t of o){for(const n of null!==(s=e.coverage[t.id])&&void 0!==s?s:[]){var s;p(t,n,e.rules_data[n])}for(const n of t.techniques){for(const a of null!==(m=e.coverage[n.id])&&void 0!==m?m:[]){var m,f;null!==(f=e.coverage[t.id])&&void 0!==f&&f.includes(a)&&p(n,a,e.rules_data[a])}for(const a of n.subtechniques)for(const n of null!==(g=e.coverage[a.id])&&void 0!==g?g:[]){var g,b;null!==(b=e.coverage[t.id])&&void 0!==b&&b.includes(n)&&p(a,n,e.rules_data[n])}}}return{mitreTactics:o,unmappedRules:d(e),metrics:u(e.rules_data)}}(await Object(s.g)({signal:t,filter:e}))),{...m.a,...t,onError:e=>{i(e,{title:r.c})}})},y=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(g,{refetchType:"active"})}),[e])}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(427));t.default=function(e,t){void 0===t&&(t=[]);var n=r.default(e,t,{loading:!0}),a=n[0],o=n[1];return i.useEffect((function(){o()}),[o]),a}},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a,i=n(2),r=n(66),o=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s="html",l="svg",c=function(e,t){var n,a,i,r={};if(e===s)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var o=0,c=Object.entries(t.attributes);o<c.length;o++){var u=c[o],d=u[0],p=u[1];i.setAttribute(d,p)}var m={element:i,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,i){if(i!==a){if(m.unmount(),t!==n&&!function(e,t){if(t===s)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,i),n=t,a=i}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,m.element),n=void 0,a=void 0)}};return m},u=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return o(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return r.createPortal(i.Children.map(n,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(i.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=i.createRef(),n.passPropsThroughPortal(),n}return o(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),p=c.bind(null,s);c.bind(null,l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n(45),r=n(138),o=n(124),s=n(148),l=n(200);const c=({inputId:e=r.a.global,inspectIndex:t=0,isDisabled:n,multiple:c=!1,onClick:u,onCloseInspect:d,queryId:p})=>{const m=Object(i.useDispatch)(),f=Object(a.useMemo)((()=>s.d.globalQueryByIdSelector()),[]),g=Object(a.useMemo)((()=>s.d.timelineQueryByIdSelector()),[]),{loading:b,inspect:y,selectedInspectIndex:h,isInspected:v,searchSessionId:E}=Object(o.a)((t=>e===r.a.global?f(t,p):g(t,p))),x=Object(a.useCallback)((()=>{u&&u(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!0,selectedInspectIndex:t,searchSessionId:E}))}),[u,m,p,e,t,E]),j=Object(a.useCallback)((()=>{null!=d&&d(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!1,selectedInspectIndex:t,searchSessionId:E}))}),[d,m,p,e,t,E]),S=Object(a.useMemo)((()=>null!=y&&y.dsl.length>0?c?y.dsl[0]:y.dsl[t]:null),[t,c,y]),O=Object(a.useMemo)((()=>c?null==y?void 0:y.dsl.slice(1):null),[c,y]),k=Object(a.useMemo)((()=>null!=y&&y.response.length>0?c?y.response[0]:y.response[t]:null),[t,c,y]),w=Object(a.useMemo)((()=>c?null==y?void 0:y.response.slice(1):null),[c,y]),T=Object(a.useMemo)((()=>!b&&h===t&&v),[t,v,b,h]);return{additionalRequests:O,additionalResponses:w,handleClick:x,handleCloseModal:j,isButtonDisabled:Object(a.useMemo)((()=>b||n||null==S||null==k||null==p),[n,b,p,S,k]),isShowingModal:T,loading:b,request:S,response:k}}},function(e,t,n){"use strict";e.exports=n(1084)},,,function(e,t,n){"use strict";var a=n(259);n.d(t,"f",(function(){return a.f})),n.d(t,"e",(function(){return a.e})),n.d(t,"d",(function(){return a.d})),n.d(t,"c",(function(){return a.c})),n.d(t,"b",(function(){return a.b}));var i=n(245);n.d(t,"a",(function(){return i.b}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(2),i=n.n(a);const r=i.a.createContext(null),o=Object(a.memo)((({upsellingService:e,children:t})=>i.a.createElement(r.Provider,{value:e},t)));o.displayName="UpsellingProvider";const s=()=>{const e=Object(a.useContext)(r);if(!e)throw new Error("UpsellingProviderContext not found");return e}},,,function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.apSW=t.bind=t.bindW=t.bindTo=t.bracket=t.taskify=t.taskEitherSeq=t.taskEither=t.Alt=t.Bifunctor=t.ApplicativeSeq=t.ApplicativePar=t.Functor=t.getFilterable=t.getTaskValidation=t.getAltTaskValidation=t.getApplicativeTaskValidation=t.getApplyMonoid=t.getApplySemigroup=t.getSemigroup=t.URI=t.throwError=t.fromTask=t.fromIO=t.of=t.alt=t.flatten=t.chainFirst=t.chainFirstW=t.chain=t.chainW=t.apSecond=t.apFirst=t.ap=t.apW=t.mapLeft=t.bimap=t.map=t.chainIOEitherK=t.chainIOEitherKW=t.chainEitherK=t.chainEitherKW=t.fromIOEitherK=t.fromEitherK=t.tryCatchK=t.filterOrElse=t.swap=t.orElse=t.getOrElse=t.getOrElseW=t.fold=t.tryCatch=t.fromPredicate=t.fromOption=t.fromEither=t.fromIOEither=t.leftIO=t.rightIO=t.leftTask=t.rightTask=t.right=t.left=void 0;var o=r(n(344)),s=n(1277),l=n(269),c=r(n(1280));function u(e,t){return function(){return e().then(o.right,(function(e){return o.left(t(e))}))}}function d(e){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.fromEither(e.apply(void 0,n))}}function p(e){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.fromIOEither(e.apply(void 0,n))}}t.left=l.flow(o.left,c.of),t.right=l.flow(o.right,c.of),t.rightTask=c.map(o.right),t.leftTask=c.map(o.left),t.rightIO=l.flow(c.fromIO,t.rightTask),t.leftIO=l.flow(c.fromIO,t.leftTask),t.fromIOEither=c.fromIO,t.fromEither=o.fold(t.left,(function(e){return t.right(e)})),t.fromOption=function(e){return function(n){return"None"===n._tag?t.left(e()):t.right(n.value)}},t.fromPredicate=function(e,n){return function(a){return e(a)?t.right(a):t.left(n(a))}},t.tryCatch=u,t.fold=l.flow(o.fold,c.chain),t.getOrElseW=function(e){return function(t){return l.pipe(t,c.chain(o.fold(e,c.of)))}},t.getOrElse=t.getOrElseW,t.orElse=function(e){return c.chain(o.fold(e,t.right))},t.swap=c.map(o.swap),t.filterOrElse=function(e,n){return t.chain((function(a){return e(a)?t.right(a):t.left(n(a))}))},t.tryCatchK=function(e,t){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return u((function(){return e.apply(void 0,n)}),t)}},t.fromEitherK=d,t.fromIOEitherK=p,t.chainEitherKW=function(e){return t.chainW(d(e))},t.chainEitherK=t.chainEitherKW,t.chainIOEitherKW=function(e){return t.chainW(p(e))},t.chainIOEitherK=t.chainIOEitherKW;var m=function(e,n){return l.pipe(e,t.map(n))},f=function(e,n,a){return l.pipe(e,t.bimap(n,a))},g=function(e,n){return l.pipe(e,t.mapLeft(n))},b=function(e,n){return l.pipe(e,t.ap(n))},y=function(e,n){return l.pipe(e,t.chain((function(e){return l.pipe(n,t.map(e))})))},h=function(e,n){return l.pipe(e,t.chain(n))},v=function(e,n){return l.pipe(e,t.alt(n))};function E(e){return c.getSemigroup(o.getApplySemigroup(e))}function x(e,n){var a=o.getApplicativeValidation(n);return{URI:t.URI,_E:void 0,map:m,ap:function(t,n){return l.pipe(t,(i=n,function(t){return e.ap(e.map(t,(function(e){return function(t){return a.ap(e,t)}})),i)}));var i},of:t.of}}function j(e){return{URI:t.URI,_E:void 0,map:m,alt:function(t,n){return l.pipe(t,c.chain((function(t){return o.isRight(t)?c.of(t):l.pipe(n(),c.map((function(n){return o.isLeft(n)?o.left(e.concat(t.left,n.left)):n})))})))}}}t.map=function(e){return c.map(o.map(e))},t.bimap=l.flow(o.bimap,c.map),t.mapLeft=function(e){return c.map(o.mapLeft(e))},t.apW=function(e){return l.flow(c.map((function(e){return function(t){return o.apW(t)(e)}})),c.ap(e))},t.ap=t.apW,t.apFirst=function(e){return l.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return l.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.chainW=function(e){return function(n){return l.pipe(n,c.chain(o.fold(t.left,e)))}},t.chain=t.chainW,t.chainFirstW=function(e){return t.chainW((function(n){return l.pipe(e(n),t.map((function(){return n})))}))},t.chainFirst=t.chainFirstW,t.flatten=t.chain(l.identity),t.alt=function(e){return c.chain(o.fold(e,t.right))},t.of=t.right,t.fromIO=t.rightIO,t.fromTask=t.rightTask,t.throwError=t.left,t.URI="TaskEither",t.getSemigroup=function(e){return c.getSemigroup(o.getSemigroup(e))},t.getApplySemigroup=E,t.getApplyMonoid=function(e){return{concat:E(e).concat,empty:t.right(e.empty)}},t.getApplicativeTaskValidation=x,t.getAltTaskValidation=j,t.getTaskValidation=function(e){var n=x(c.ApplicativePar,e),a=j(e);return{URI:t.URI,_E:void 0,map:m,ap:n.ap,of:t.of,chain:h,bimap:f,mapLeft:g,alt:a.alt,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError}},t.getFilterable=function(e){var n=o.getWitherable(e),a=s.getFilterableComposition(c.Monad,n);return{URI:t.URI,_E:void 0,map:m,compact:a.compact,separate:a.separate,filter:a.filter,filterMap:a.filterMap,partition:a.partition,partitionMap:a.partitionMap}},t.Functor={URI:t.URI,map:m},t.ApplicativePar={URI:t.URI,map:m,ap:b,of:t.of},t.ApplicativeSeq={URI:t.URI,map:m,ap:y,of:t.of},t.Bifunctor={URI:t.URI,bimap:f,mapLeft:g},t.Alt={URI:t.URI,map:m,alt:v},t.taskEither={URI:t.URI,bimap:f,mapLeft:g,map:m,of:t.of,ap:b,chain:h,alt:v,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError},t.taskEitherSeq={URI:t.URI,bimap:f,mapLeft:g,map:m,of:t.of,ap:y,chain:h,alt:v,fromIO:t.fromIO,fromTask:t.fromTask,throwError:t.throwError},t.taskify=function(e){return function(){var t=Array.prototype.slice.call(arguments);return function(){return new Promise((function(n){e.apply(null,t.concat((function(e,t){return n(null!=e?o.left(e):o.right(t))})))}))}}},t.bracket=function(e,n,a){return l.pipe(e,t.chain((function(e){return l.pipe(l.pipe(n(e),c.map(o.right)),t.chain((function(n){return l.pipe(a(e,n),t.chain((function(){return o.isLeft(n)?t.left(n.left):t.of(n.right)})))})))})))},t.bindTo=function(e){return t.map(l.bindTo_(e))},t.bindW=function(e,n){return t.chainW((function(a){return l.pipe(n(a),t.map((function(t){return l.bind_(a,e,t)})))}))},t.bind=t.bindW,t.apSW=function(e,n){return l.flow(t.map((function(t){return function(n){return l.bind_(t,e,n)}})),t.apW(n))},t.apS=t.apSW},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(891).a},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(46).string},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=a.keyof({binary:null,boolean:null,byte:null,date:null,date_nanos:null,date_range:null,double:null,double_range:null,float:null,float_range:null,geo_point:null,geo_shape:null,half_float:null,integer:null,integer_range:null,ip:null,ip_range:null,keyword:null,long:null,long_range:null,shape:null,short:null,text:null});a.union([i,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(4),r=n(45),o=n(166),s=n(132),l=n(127),c=n(294),u=n(123),d=n(118),p=n(864);const m=()=>{const{indicesExist:e,dataViewId:t}=Object(s.a)(l.SourcererScopeName.detections),{indexFieldsSearch:n}=Object(c.b)(),m=Object(r.useDispatch)(),{addError:f}=Object(u.a)(),g=Object(a.useRef)(new AbortController),{data:{dataViews:b}}=Object(d.j)().services,y=Object(r.useSelector)(o.d.signalIndexName),h=Object(r.useSelector)(o.d.defaultDataView),v=Object(a.useMemo)((()=>!h.title.includes(`${y}`)),[h.title,y]),E=Object(a.useMemo)((()=>!e&&!v),[e,v]),x=Object(a.useCallback)((()=>{null!==y&&(g.current.abort(),(async()=>{g.current=new AbortController;try{const e=await Object(p.a)({body:{patternList:h.title.split(",")},signal:g.current.signal,dataViewId:t,dataViewService:b});null!==y&&null!=e&&e.defaultDataView.patternList.includes(y)&&(n({dataViewId:e.defaultDataView.id}),m(o.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||f(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[f,t,b,h.title,m,n,y]);return{...E?{pollForSignalIndex:x}:{},signalIndexNeedsInit:v}}},function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return v}));var a=n(7),i=n(57),r=n(138);const o=e=>e.policy,s=e=>e.timerange,l=e=>e.queries,c=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===r.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},u=()=>Object(i.createSelector)(o,(e=>e.kind)),d=()=>Object(i.createSelector)(o,(e=>e.duration)),p=()=>Object(i.createSelector)(s,(e=>e.kind)),m=()=>Object(i.createSelector)(s,(e=>e.from)),f=()=>Object(i.createSelector)(s,(e=>e.to)),g=()=>Object(i.createSelector)(s,(e=>e.fromStr)),b=()=>Object(i.createSelector)(s,(e=>e.toStr)),y=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),h=()=>Object(i.createSelector)(c,(e=>e.filter((e=>"kql"!==e.id)))),v=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){var i=a.useRef(void 0);i.current&&n(t,i.current)||(i.current=t),a.useEffect(e,i.current)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),i=a.useRef(),r=a.useRef(e),o=a.useCallback((function(){return n.current}),[]),s=a.useCallback((function(){n.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){n.current=!0,r.current()}),t)}),[t]),l=a.useCallback((function(){n.current=null,i.current&&clearTimeout(i.current)}),[]);return a.useEffect((function(){r.current=e}),[e]),a.useEffect((function(){return s(),l}),[t]),[o,l,s]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return b}));var a=n(120);const i=a.z.enum([".osquery",".endpoint"]),r=i.enum,o=a.z.object({}).catchall(a.z.object({field:a.z.string().optional(),value:a.z.union([a.z.string(),a.z.array(a.z.string())]).optional()})),s=a.z.object({id:a.z.string(),query:a.z.string(),ecs_mapping:o.optional(),version:a.z.string().optional(),platform:a.z.string().optional(),removed:a.z.boolean().optional(),snapshot:a.z.boolean().optional()}),l=a.z.object({query:a.z.string().optional(),ecs_mapping:o.optional(),queries:a.z.array(s).optional(),pack_id:a.z.string().optional(),saved_query_id:a.z.string().optional(),timeout:a.z.number().optional()}),c=a.z.object({query:a.z.string().optional(),ecsMapping:o.optional(),queries:a.z.array(s).optional(),packId:a.z.string().optional(),savedQueryId:a.z.string().optional(),timeout:a.z.number().optional()}),u=a.z.object({action_type_id:a.z.literal(".osquery"),params:l}),d=a.z.object({actionTypeId:a.z.literal(".osquery"),params:c}),p=a.z.object({command:a.z.literal("isolate"),comment:a.z.string().optional()}),m=a.z.object({command:a.z.enum(["kill-process","suspend-process"]),comment:a.z.string().optional(),config:a.z.object({field:a.z.string(),overwrite:a.z.boolean().optional().default(!0)})}),f=a.z.object({action_type_id:a.z.literal(".endpoint"),params:a.z.union([p,m])}),g=a.z.object({actionTypeId:a.z.literal(".endpoint"),params:a.z.union([p,m])}),b=a.z.union([u,f]);a.z.union([d,g])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(120),i=n(281),r=n(465);const o=a.z.object({last_execution:a.z.object({date:a.z.string().datetime(),status:i.a,status_order:i.c,message:a.z.string(),metrics:r.a})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);const i=a.z.object({total_search_duration_ms:a.z.number().int().min(0).optional(),total_indexing_duration_ms:a.z.number().int().min(0).optional(),total_enrichment_duration_ms:a.z.number().int().min(0).optional(),execution_gap_duration_s:a.z.number().int().min(0).optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(120);const i=a.z.string(),r=a.z.string(),o=a.z.string()},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(120),i=n(199);const r=a.z.array(a.z.object({field:a.z.string(),value:a.z.number().int().min(0)})),o=a.z.number().int().min(1),s=a.z.union([a.z.string(),a.z.array(a.z.string())]),l=a.z.array(a.z.string()),c=a.z.object({field:s,value:o,cardinality:r.optional()}),u=(a.z.object({field:l,value:o,cardinality:r.optional()}),a.z.object({field:l,value:o,cardinality:r}),a.z.object({duration:i.b}))},function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(120),i=n(268);const r=a.z.string(),o=a.z.array(a.z.object({entries:a.z.array(a.z.object({field:i.a,type:a.z.literal("mapping"),value:i.a}))})).min(1),s=a.z.array(a.z.string()),l=a.z.array(a.z.unknown()),c=a.z.string(),u=a.z.number().int().min(1),d=a.z.number().int().min(1)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(120);const i=a.z.number().int().min(0),r=a.z.union([a.z.string(),a.z.array(a.z.string()).min(1)])},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(120),i=n(268);const r=a.z.array(a.z.string()).min(1).max(3),o=i.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(120);const i=a.z.number().int().min(1),r=a.z.number().int().min(0),o=a.z.object({page:i,per_page:r,total:a.z.number().int().min(0)})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);const i=a.z.object({type:a.z.string(),message:a.z.string(),actionPath:a.z.string(),buttonLabel:a.z.string().optional()})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(5);const i=`${a.Lb}/rules/_rule_management_filters`,r=`${a.Lb}/rules/_coverage_overview`},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(19),i=n(60),r=n.n(i),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(48),d=n(5),p=n(650),m=n(575),f=n(132),g=n(127);const b=c()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));height:41vh;.euiModal__flex{width:60vw;}[role='tabpanel']{height:calc(41vh - 208px) !important;}"]);b.displayName="MyEuiModal";const y=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},h=(e=[])=>1===e.length&&e[0]===d.hc?s.a.createElement("i",null,p.f):e.length>0?e.filter((e=>e!==d.hc)).join(", "):p.k,v=({adHocDataViews:e,additionalRequests:t,additionalResponses:n,closeModal:i,inputId:l,request:c,response:d,title:v})=>{const{pathname:E}=Object(u.useLocation)(),{selectedPatterns:x}=Object(f.a)("timeline"===l?g.SourcererScopeName.timeline:Object(m.a)(E)),j=Object(o.useMemo)((()=>[c,...null!=t?t:[]]),[c,t]),S=Object(o.useMemo)((()=>[d,...null!=n?n:[]]),[d,n]),O=Object(o.useMemo)((()=>y(j)),[j]),k=Object(o.useMemo)((()=>y(S)),[S]),w=Object(o.useMemo)((()=>{var e,t;return(null!==(e=null===(t=O[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>x.includes(e.trim())))}),[O,x]),T=Object(o.useMemo)((()=>{var t,n,i,o;return[{title:s.a.createElement("span",{"data-test-subj":"index-pattern-title"},p.b," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.c,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"index-pattern-description"},s.a.createElement("p",null,h(null!=e&&e.length>0?e:null!==(t=null===(n=O[0])||void 0===n?void 0:n.index)&&void 0!==t?t:[])),!w&&s.a.createElement("p",null,s.a.createElement("small",null,s.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},p.e))))},{title:s.a.createElement("span",{"data-test-subj":"query-time-title"},p.g," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.h,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(i=k[0])||void 0===i?void 0:i.took)?"0ms":null!==(o=k[0])&&void 0!==o&&o.took?`${r()(k[0].took).format("0,0")}ms`:p.k)},{title:s.a.createElement("span",{"data-test-subj":"request-timestamp-title"},p.i," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.j,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}]}),[e,O,k,w]),I=Object(o.useMemo)((()=>[{id:"statistics",name:"Statistics","data-test-subj":"modal-inspect-statistics-tab",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiSpacer,null),s.a.createElement(a.EuiDescriptionList,{listItems:T,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request","data-test-subj":"modal-inspect-request-tab",content:O.length>0?O.map(((e,t)=>s.a.createElement(o.Fragment,{key:t},s.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-request-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return p.k}})(e.body))))):s.a.createElement(a.EuiCodeBlock,null,p.k)},{id:"response",name:"Response","data-test-subj":"modal-inspect-response-tab",content:k.length>0?S.map(((e,t)=>s.a.createElement(o.Fragment,{key:t},s.a.createElement(a.EuiCodeBlock,{"data-test-subj":"modal-inspect-response-preview",language:"json",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:"100%",isCopyable:!0,isVirtualized:!0,lineNumbers:!0},e)))):s.a.createElement(a.EuiCodeBlock,null,p.k)}]),[O,k,S,T]);return s.a.createElement(b,{onClose:i,"data-test-subj":"modal-inspect-euiModal"},s.a.createElement(a.EuiModalHeader,null,s.a.createElement(a.EuiModalHeaderTitle,null,p.d," ",v)),s.a.createElement(a.EuiModalBody,null,s.a.createElement(a.EuiTabbedContent,{tabs:I,initialSelectedTab:I[0],autoFocus:"selected"})),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButton,{onClick:i,fill:!0,"data-test-subj":"modal-inspect-close"},p.a)))}},function(e,t,n){"use strict";var a=n(411);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"c",(function(){return a.c}))},function(e,t,n){e.exports=n(35)(1029)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=(a=n(2))&&"object"==typeof a&&"default"in a?a:{default:a},r=e=>"checkbox"===e.type,o=e=>e instanceof Date,s=e=>null==e;const l=e=>"object"==typeof e;var c=e=>!s(e)&&!Array.isArray(e)&&l(e)&&!o(e),u=e=>c(e)&&e.target?r(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),p="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function m(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(p&&(e instanceof Blob||e instanceof FileList)||!n&&!c(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return c(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=m(e[n]));else t=e}return t}var f=e=>Array.isArray(e)?e.filter(Boolean):[],g=e=>void 0===e,b=(e,t,n)=>{if(!t||!c(e))return n;const a=f(t.split(/[,[\].]+?/)).reduce(((e,t)=>s(e)?e:e[t]),e);return g(a)||a===e?g(e[t])?n:e[t]:a};const y="blur",h="onChange",v="onSubmit",E="all",x="pattern",j="required",S=i.default.createContext(null),O=()=>i.default.useContext(S);var k=(e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==E&&(t._proxyFormState[i]=!a||E),n&&(n[i]=!0),e[i]}});return i},w=e=>c(e)&&!Object.keys(e).length,T=(e,t,n,a)=>{n(e);const{name:i,...r}=e;return w(r)||Object.keys(r).length>=Object.keys(t).length||Object.keys(r).find((e=>t[e]===(!a||E)))},I=e=>Array.isArray(e)?e:[e],M=(e,t,n)=>n&&t?e===t:!e||!t||e===t||I(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function C(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function _(e){const t=O(),{control:n=t.control,disabled:a,name:r,exact:o}=e||{},[s,l]=i.default.useState(n._formState),c=i.default.useRef(!0),u=i.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(r);return d.current=r,C({disabled:a,next:e=>c.current&&M(d.current,e.name,o)&&T(e,u.current,n._updateFormState)&&l({...n._formState,...e}),subject:n._subjects.state}),i.default.useEffect((()=>(c.current=!0,u.current.isValid&&n._updateValid(!0),()=>{c.current=!1})),[n]),k(s,n,u.current,!1)}var D=e=>"string"==typeof e,A=(e,t,n,a,i)=>D(e)?(a&&t.watch.add(e),b(n,e,i)):Array.isArray(e)?e.map((e=>(a&&t.watch.add(e),b(n,e)))):(a&&(t.watchAll=!0),n);function F(e){const t=O(),{control:n=t.control,name:a,defaultValue:r,disabled:o,exact:s}=e||{},l=i.default.useRef(a);l.current=a,C({disabled:o,subject:n._subjects.values,next:e=>{M(l.current,e.name,s)&&u(m(A(l.current,n._names,e.values||n._formValues,!1,r)))}});const[c,u]=i.default.useState(n._getWatch(a,r));return i.default.useEffect((()=>n._removeUnmounted())),c}var N=e=>/^\w*$/.test(e),P=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function R(e,t,n){let a=-1;const i=N(t)?[t]:P(t),r=i.length,o=r-1;for(;++a<r;){const t=i[a];let r=n;if(a!==o){const n=e[t];r=c(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}e[t]=r,e=e[t]}return e}function L(e){const t=O(),{name:n,control:a=t.control,shouldUnregister:r}=e,o=d(a._names.array,n),s=F({control:a,name:n,defaultValue:b(a._formValues,n,b(a._defaultValues,n,e.defaultValue)),exact:!0}),l=_({control:a,name:n}),c=i.default.useRef(a.register(n,{...e.rules,value:s}));return c.current=a.register(n,e.rules),i.default.useEffect((()=>{const e=a._options.shouldUnregister||r,t=(e,t)=>{const n=b(a._fields,e);n&&(n._f.mount=t)};if(t(n,!0),e){const e=m(b(a._options.defaultValues,n));R(a._defaultValues,n,e),g(b(a._formValues,n))&&R(a._formValues,n,e)}return()=>{(o?e&&!a._state.action:e)?a.unregister(n):t(n,!1)}}),[n,a,o,r]),{field:{name:n,value:s,onChange:i.default.useCallback((e=>c.current.onChange({target:{value:u(e),name:n},type:"change"})),[n]),onBlur:i.default.useCallback((()=>c.current.onBlur({target:{value:b(a._formValues,n),name:n},type:y})),[n,a]),ref:e=>{const t=b(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!b(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!b(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!b(l.touchedFields,n)},error:{enumerable:!0,get:()=>b(l.errors,n)}})}}const z="post";var q=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{};const B=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=b(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else c(a)&&B(a,t)}}};var $=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},V=(e,t,n={})=>n.shouldFocus||g(n.shouldFocus)?n.focusName||`${e}.${g(n.focusIndex)?t:n.focusIndex}.`:"",U=e=>({isOnSubmit:!e||e===v,isOnBlur:"onBlur"===e,isOnChange:e===h,isOnAll:e===E,isOnTouch:"onTouched"===e}),G=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),H=(e,t,n)=>{const a=f(b(e,n));return R(a,"root",t[n]),R(e,n,a),e},W=e=>"boolean"==typeof e,Q=e=>"file"===e.type,Y=e=>"function"==typeof e,K=e=>{if(!p)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},J=e=>D(e),Z=e=>"radio"===e.type,X=e=>e instanceof RegExp;const ee={value:!1,isValid:!1},te={value:!0,isValid:!0};var ne=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!g(e[0].attributes.value)?g(e[0].value)||""===e[0].value?te:{value:e[0].value,isValid:!0}:te:ee}return ee};const ae={isValid:!1,value:null};var ie=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),ae):ae;function re(e,t,n="validate"){if(J(e)||Array.isArray(e)&&e.every(J)||W(e)&&!e)return{type:n,message:J(e)?e:"",ref:t}}var oe=e=>c(e)&&!X(e)?e:{value:e,message:""},se=async(e,t,n,a,i)=>{const{ref:o,refs:l,required:u,maxLength:d,minLength:p,min:m,max:f,pattern:y,validate:h,name:v,valueAsNumber:E,mount:S,disabled:O}=e._f,k=b(t,v);if(!S||O)return{};const T=l?l[0]:o,I=e=>{a&&T.reportValidity&&(T.setCustomValidity(W(e)?"":e||""),T.reportValidity())},M={},C=Z(o),_=r(o),A=C||_,F=(E||Q(o))&&g(o.value)&&g(k)||K(o)&&""===o.value||""===k||Array.isArray(k)&&!k.length,N=q.bind(null,v,n,M),P=(e,t,n,a="maxLength",i="minLength")=>{const r=e?t:n;M[v]={type:e?a:i,message:r,ref:o,...N(e?a:i,r)}};if(i?!Array.isArray(k)||!k.length:u&&(!A&&(F||s(k))||W(k)&&!k||_&&!ne(l).isValid||C&&!ie(l).isValid)){const{value:e,message:t}=J(u)?{value:!!u,message:u}:oe(u);if(e&&(M[v]={type:j,message:t,ref:T,...N(j,t)},!n))return I(t),M}if(!(F||s(m)&&s(f))){let e,t;const a=oe(f),i=oe(m);if(s(k)||isNaN(k)){const n=o.valueAsDate||new Date(k),r=e=>new Date((new Date).toDateString()+" "+e),s="time"==o.type,l="week"==o.type;D(a.value)&&k&&(e=s?r(k)>r(a.value):l?k>a.value:n>new Date(a.value)),D(i.value)&&k&&(t=s?r(k)<r(i.value):l?k<i.value:n<new Date(i.value))}else{const n=o.valueAsNumber||(k?+k:k);s(a.value)||(e=n>a.value),s(i.value)||(t=n<i.value)}if((e||t)&&(P(!!e,a.message,i.message,"max","min"),!n))return I(M[v].message),M}if((d||p)&&!F&&(D(k)||i&&Array.isArray(k))){const e=oe(d),t=oe(p),a=!s(e.value)&&k.length>+e.value,i=!s(t.value)&&k.length<+t.value;if((a||i)&&(P(a,e.message,t.message),!n))return I(M[v].message),M}if(y&&!F&&D(k)){const{value:e,message:t}=oe(y);if(X(e)&&!k.match(e)&&(M[v]={type:x,message:t,ref:o,...N(x,t)},!n))return I(t),M}if(h)if(Y(h)){const e=re(await h(k,t),T);if(e&&(M[v]={...e,...N("validate",e.message)},!n))return I(e.message),M}else if(c(h)){let e={};for(const a in h){if(!w(e)&&!n)break;const i=re(await h[a](k,t),T,a);i&&(e={...i,...N(a,i.message)},I(i.message),n&&(M[v]=e))}if(!w(e)&&(M[v]={ref:T,...e},!n))return M}return I(!0),M};function le(e,t){return[...e,...I(t)]}var ce=e=>Array.isArray(e)?e.map((()=>{})):void 0;function ue(e,t,n){return[...e.slice(0,t),...I(n),...e.slice(t)]}var de=(e,t,n)=>Array.isArray(e)?(g(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function pe(e,t){return[...I(t),...I(e)]}var me=(e,t)=>g(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return f(a).length?a:[]}(e,I(t).sort(((e,t)=>e-t))),fe=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function ge(e,t){const n=Array.isArray(t)?t:N(t)?[t]:P(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=g(e)?a++:e[t[a++]];return e}(e,n),i=n.length-1,r=n[i];return a&&delete a[r],0!==i&&(c(a)&&w(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!g(e[t]))return!1;return!0}(a))&&ge(e,n.slice(0,-1)),e}var be=(e,t,n)=>(e[t]=n,e);function ye(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var he=e=>s(e)||!l(e);function ve(e,t){if(he(e)||he(t))return e===t;if(o(e)&&o(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(o(n)&&o(e)||c(n)&&c(e)||Array.isArray(n)&&Array.isArray(e)?!ve(n,e):n!==e)return!1}}return!0}var Ee=e=>"select-multiple"===e.type,xe=e=>K(e)&&e.isConnected,je=e=>{for(const t in e)if(Y(e[t]))return!0;return!1};function Se(e,t={}){const n=Array.isArray(e);if(c(e)||n)for(const n in e)Array.isArray(e[n])||c(e[n])&&!je(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Se(e[n],t[n])):s(e[n])||(t[n]=!0);return t}function Oe(e,t,n){const a=Array.isArray(e);if(c(e)||a)for(const a in e)Array.isArray(e[a])||c(e[a])&&!je(e[a])?g(t)||he(n[a])?n[a]=Array.isArray(e[a])?Se(e[a],[]):{...Se(e[a])}:Oe(e[a],s(t)?{}:t[a],n[a]):n[a]=!ve(e[a],t[a]);return n}var ke=(e,t)=>Oe(e,t,Se(t)),we=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>g(e)?e:t?""===e?NaN:e?+e:e:n&&D(e)?new Date(e):a?a(e):e;function Te(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return Q(t)?t.files:Z(t)?ie(e.refs).value:Ee(t)?[...t.selectedOptions].map((({value:e})=>e)):r(t)?ne(e.refs).value:we(g(t.value)?e.ref.value:t.value,e)}var Ie=e=>g(e)?e:X(e)?e.source:c(e)?X(e.value)?e.value.source:e.value:e;function Me(e,t,n){const a=b(e,n);if(a||N(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),r=b(t,a),o=b(e,a);if(r&&!Array.isArray(r)&&n!==a)return{name:n};if(o&&o.type)return{name:a,error:o};i.pop()}return{name:n}}const Ce={mode:v,reValidateMode:h,shouldFocusError:!0};function _e(e={},t){let n,a={...Ce,...e},i={submitCount:0,isDirty:!1,isLoading:Y(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},l={},h=(c(a.defaultValues)||c(a.values))&&m(a.defaultValues||a.values)||{},v=a.shouldUnregister?{}:m(h),x={action:!1,mount:!1,watch:!1},j={mount:new Set,unMount:new Set,array:new Set,watch:new Set},S=0;const O={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},k={values:ye(),array:ye(),state:ye()},T=e.resetOptions&&e.resetOptions.keepDirtyValues,M=U(a.mode),C=U(a.reValidateMode),_=a.criteriaMode===E,F=async e=>{if(O.isValid||e){const e=a.resolver?w((await q()).errors):await $(l,!0);e!==i.isValid&&k.state.next({isValid:e})}},N=e=>O.isValidating&&k.state.next({isValidating:e}),P=(e,t,n,a)=>{const i=b(l,e);if(i){const r=b(v,e,g(n)?b(h,e):n);g(r)||a&&a.defaultChecked||t?R(v,e,t?r:Te(i._f)):X(e,r),x.mount&&F()}},L=(e,t,n,a,r)=>{let o=!1,s=!1;const l={name:e};if(!n||a){O.isDirty&&(s=i.isDirty,i.isDirty=l.isDirty=V(),o=s!==l.isDirty);const n=ve(b(h,e),t);s=b(i.dirtyFields,e),n?ge(i.dirtyFields,e):R(i.dirtyFields,e,!0),l.dirtyFields=i.dirtyFields,o=o||O.dirtyFields&&s!==!n}if(n){const t=b(i.touchedFields,e);t||(R(i.touchedFields,e,n),l.touchedFields=i.touchedFields,o=o||O.touchedFields&&t!==n)}return o&&r&&k.state.next(l),o?l:{}},z=(t,a,r,o)=>{const s=b(i.errors,t),l=O.isValid&&W(a)&&i.isValid!==a;var c;if(e.delayError&&r?(c=()=>((e,t)=>{R(i.errors,e,t),k.state.next({errors:i.errors})})(t,r),n=e=>{clearTimeout(S),S=setTimeout(c,e)},n(e.delayError)):(clearTimeout(S),n=null,r?R(i.errors,t,r):ge(i.errors,t)),(r?!ve(s,r):s)||!w(o)||l){const e={...o,...l&&W(a)?{isValid:a}:{},errors:i.errors,name:t};i={...i,...e},k.state.next(e)}N(!1)},q=async e=>a.resolver(v,a.context,((e,t,n,a)=>{const i={};for(const n of e){const e=b(t,n);e&&R(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||j.mount,l,a.criteriaMode,a.shouldUseNativeValidation)),$=async(e,t,n={valid:!0})=>{for(const r in e){const o=e[r];if(o){const{_f:e,...r}=o;if(e){const r=j.array.has(e.name),s=await se(o,v,_,a.shouldUseNativeValidation&&!t,r);if(s[e.name]&&(n.valid=!1,t))break;!t&&(b(s,e.name)?r?H(i.errors,s,e.name):R(i.errors,e.name,s[e.name]):ge(i.errors,e.name))}r&&await $(r,t,n)}}return n.valid},V=(e,t)=>(e&&t&&R(v,e,t),!ve(ie(),h)),J=(e,t,n)=>A(e,j,{...x.mount?v:g(t)?h:D(e)?{[e]:t}:t},n,t),X=(e,t,n={})=>{const a=b(l,e);let i=t;if(a){const n=a._f;n&&(!n.disabled&&R(v,e,we(t,n)),i=K(n.ref)&&s(t)?"":t,Ee(n.ref)?[...n.ref.options].forEach((e=>e.selected=i.includes(e.value))):n.refs?r(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):n.refs[0]&&(n.refs[0].checked=!!i):n.refs.forEach((e=>e.checked=e.value===i)):Q(n.ref)?n.ref.value="":(n.ref.value=i,n.ref.type||k.values.next({name:e,values:{...v}})))}(n.shouldDirty||n.shouldTouch)&&L(e,i,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ae(e)},ee=(e,t,n)=>{for(const a in t){const i=t[a],r=`${e}.${a}`,s=b(l,r);!j.array.has(e)&&he(i)&&(!s||s._f)||o(i)?X(r,i,n):ee(r,i,n)}},te=(e,n,a={})=>{const r=b(l,e),o=j.array.has(e),c=m(n);R(v,e,c),o?(k.array.next({name:e,values:{...v}}),(O.isDirty||O.dirtyFields)&&a.shouldDirty&&k.state.next({name:e,dirtyFields:ke(h,v),isDirty:V(e,c)})):!r||r._f||s(c)?X(e,c,a):ee(e,c,a),G(e,j)&&k.state.next({...i}),k.values.next({name:e,values:{...v}}),!x.mount&&t()},ne=async e=>{const t=e.target;let r=t.name,o=!0;const s=b(l,r);if(s){let d,p;const m=t.type?Te(s._f):u(e),f=e.type===y||"focusout"===e.type,g=!((c=s._f).mount&&(c.required||c.min||c.max||c.maxLength||c.minLength||c.pattern||c.validate)||a.resolver||b(i.errors,r)||s._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(f,b(i.touchedFields,r),i.isSubmitted,C,M),h=G(r,j,f);R(v,r,m),f?(s._f.onBlur&&s._f.onBlur(e),n&&n(0)):s._f.onChange&&s._f.onChange(e);const E=L(r,m,f,!1),x=!w(E)||h;if(!f&&k.values.next({name:r,type:e.type,values:{...v}}),g)return O.isValid&&F(),x&&k.state.next({name:r,...h?{}:E});if(!f&&h&&k.state.next({...i}),N(!0),a.resolver){const{errors:e}=await q([r]),t=Me(i.errors,l,r),n=Me(e,l,t.name||r);d=n.error,r=n.name,p=w(e)}else d=(await se(s,v,_,a.shouldUseNativeValidation))[r],o=isNaN(m)||m===b(v,r,m),o&&(d?p=!1:O.isValid&&(p=await $(l,!0)));o&&(s._f.deps&&ae(s._f.deps),z(r,p,d,E))}var c},ae=async(e,t={})=>{let n,r;const o=I(e);if(N(!0),a.resolver){const t=await(async e=>{const{errors:t}=await q();if(e)for(const n of e){const e=b(t,n);e?R(i.errors,n,e):ge(i.errors,n)}else i.errors=t;return t})(g(e)?e:o);n=w(t),r=e?!o.some((e=>b(t,e))):n}else e?(r=(await Promise.all(o.map((async e=>{const t=b(l,e);return await $(t&&t._f?{[e]:t}:t)})))).every(Boolean),(r||i.isValid)&&F()):r=n=await $(l);return k.state.next({...!D(e)||O.isValid&&n!==i.isValid?{}:{name:e},...a.resolver||!e?{isValid:n}:{},errors:i.errors,isValidating:!1}),t.shouldFocus&&!r&&B(l,(e=>e&&b(i.errors,e)),e?o:j.mount),r},ie=e=>{const t={...h,...x.mount?v:{}};return g(e)?t:D(e)?b(t,e):e.map((e=>b(t,e)))},re=(e,t)=>({invalid:!!b((t||i).errors,e),isDirty:!!b((t||i).dirtyFields,e),isTouched:!!b((t||i).touchedFields,e),error:b((t||i).errors,e)}),oe=(e,t,n)=>{const a=(b(l,e,{_f:{}})._f||{}).ref;R(i.errors,e,{...t,ref:a}),k.state.next({name:e,errors:i.errors,isValid:!1}),n&&n.shouldFocus&&a&&a.focus&&a.focus()},le=(e,t={})=>{for(const n of e?I(e):j.mount)j.mount.delete(n),j.array.delete(n),t.keepValue||(ge(l,n),ge(v,n)),!t.keepError&&ge(i.errors,n),!t.keepDirty&&ge(i.dirtyFields,n),!t.keepTouched&&ge(i.touchedFields,n),!a.shouldUnregister&&!t.keepDefaultValue&&ge(h,n);k.values.next({values:{...v}}),k.state.next({...i,...t.keepDirty?{isDirty:V()}:{}}),!t.keepIsValid&&F()},ce=(e,t={})=>{let n=b(l,e);const i=W(t.disabled);return R(l,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),j.mount.add(e),n?i&&R(v,e,t.disabled?void 0:b(v,e,Te(n._f))):P(e,!0,t.value),{...i?{disabled:t.disabled}:{},...a.progressive?{required:!!t.required,min:Ie(t.min),max:Ie(t.max),minLength:Ie(t.minLength),maxLength:Ie(t.maxLength),pattern:Ie(t.pattern)}:{},name:e,onChange:ne,onBlur:ne,ref:i=>{if(i){ce(e,t),n=b(l,e);const a=g(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,o=(e=>Z(e)||r(e))(a),s=n._f.refs||[];if(o?s.find((e=>e===a)):a===n._f.ref)return;R(l,e,{_f:{...n._f,...o?{refs:[...s.filter(xe),a,...Array.isArray(b(h,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),P(e,!1,void 0,a)}else n=b(l,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(j.array,e)||!x.action)&&j.unMount.add(e)}}},ue=()=>a.shouldFocusError&&B(l,(e=>e&&b(i.errors,e)),j.mount),de=(e,t)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let r=m(v);if(k.state.next({isSubmitting:!0}),a.resolver){const{errors:e,values:t}=await q();i.errors=e,r=t}else await $(l);ge(i.errors,"root"),w(i.errors)?(k.state.next({errors:{}}),await e(r,n)):(t&&await t({...i.errors},n),ue(),setTimeout(ue)),k.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:w(i.errors),submitCount:i.submitCount+1,errors:i.errors})},pe=(n,a={})=>{const r=n||h,o=m(r),s=n&&!w(n)?o:h;if(a.keepDefaultValues||(h=r),!a.keepValues){if(a.keepDirtyValues||T)for(const e of j.mount)b(i.dirtyFields,e)?R(s,e,b(v,e)):te(e,b(s,e));else{if(p&&g(n))for(const e of j.mount){const t=b(l,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(K(e)){const t=e.closest("form");if(t){t.reset();break}}}}l={}}v=e.shouldUnregister?a.keepDefaultValues?m(h):{}:m(s),k.array.next({values:{...s}}),k.values.next({values:{...s}})}j={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!x.mount&&t(),x.mount=!O.isValid||!!a.keepIsValid,x.watch=!!e.shouldUnregister,k.state.next({submitCount:a.keepSubmitCount?i.submitCount:0,isDirty:a.keepDirty?i.isDirty:!(!a.keepDefaultValues||ve(n,h)),isSubmitted:!!a.keepIsSubmitted&&i.isSubmitted,dirtyFields:a.keepDirtyValues?i.dirtyFields:a.keepDefaultValues&&n?ke(h,n):{},touchedFields:a.keepTouched?i.touchedFields:{},errors:a.keepErrors?i.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},me=(e,t)=>pe(Y(e)?e(v):e,t);return{control:{register:ce,unregister:le,getFieldState:re,handleSubmit:de,setError:oe,_executeSchema:q,_getWatch:J,_getDirty:V,_updateValid:F,_removeUnmounted:()=>{for(const e of j.unMount){const t=b(l,e);t&&(t._f.refs?t._f.refs.every((e=>!xe(e))):!xe(t._f.ref))&&le(e)}j.unMount=new Set},_updateFieldArray:(e,t=[],n,a,r=!0,o=!0)=>{if(a&&n){if(x.action=!0,o&&Array.isArray(b(l,e))){const t=n(b(l,e),a.argA,a.argB);r&&R(l,e,t)}if(o&&Array.isArray(b(i.errors,e))){const t=n(b(i.errors,e),a.argA,a.argB);r&&R(i.errors,e,t),((e,t)=>{!f(b(e,t)).length&&ge(e,t)})(i.errors,e)}if(O.touchedFields&&o&&Array.isArray(b(i.touchedFields,e))){const t=n(b(i.touchedFields,e),a.argA,a.argB);r&&R(i.touchedFields,e,t)}O.dirtyFields&&(i.dirtyFields=ke(h,v)),k.state.next({name:e,isDirty:V(e,t),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else R(v,e,t)},_getFieldArray:t=>f(b(x.mount?v:h,t,e.shouldUnregister?b(h,t,[]):[])),_reset:pe,_resetDefaultValues:()=>Y(a.defaultValues)&&a.defaultValues().then((e=>{me(e,a.resetOptions),k.state.next({isLoading:!1})})),_updateFormState:e=>{i={...i,...e}},_subjects:k,_proxyFormState:O,get _fields(){return l},get _formValues(){return v},get _state(){return x},set _state(e){x=e},get _defaultValues(){return h},get _names(){return j},set _names(e){j=e},get _formState(){return i},set _formState(e){i=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:ae,register:ce,handleSubmit:de,watch:(e,t)=>Y(e)?k.values.subscribe({next:n=>e(J(void 0,t),n)}):J(e,t,!0),setValue:te,getValues:ie,reset:me,resetField:(e,t={})=>{b(l,e)&&(g(t.defaultValue)?te(e,b(h,e)):(te(e,t.defaultValue),R(h,e,t.defaultValue)),t.keepTouched||ge(i.touchedFields,e),t.keepDirty||(ge(i.dirtyFields,e),i.isDirty=t.defaultValue?V(e,b(h,e)):V()),t.keepError||(ge(i.errors,e),O.isValid&&F()),k.state.next({...i}))},clearErrors:e=>{e&&I(e).forEach((e=>ge(i.errors,e))),k.state.next({errors:e?i.errors:{}})},unregister:le,setError:oe,setFocus:(e,t={})=>{const n=b(l,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:re}}t.Controller=e=>e.render(L(e)),t.Form=function(e){const t=O(),[n,a]=i.default.useState(!1),{control:r=t.control,onSubmit:o,children:s,action:l,method:c=z,headers:u,encType:d,onError:p,render:m,onSuccess:f,validateStatus:g,...y}=e,h=async t=>{let n=!1,a="";await r.handleSubmit((async e=>{const i=new FormData;let s="";try{s=JSON.stringify(e)}catch(e){}for(const t of r._names.mount)i.append(t,b(e,t));if(o&&o({data:e,event:t,method:c,formData:i,formDataJson:s}),l)try{const e=[u&&u["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(l,{method:c,headers:{...u,...d?{"Content-Type":d}:{}},body:e?s:i});t&&(g?!g(t.status):t.status<200||t.status>=300)?(n=!0,p&&p({response:t}),a=String(t.status)):f&&f({response:t})}catch(e){n=!0,p&&p({error:e})}}))(t),n&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:a}))};return i.default.useEffect((()=>{a(!0)}),[]),m?i.default.createElement(i.default.Fragment,null,m({submit:h})):i.default.createElement("form",{noValidate:n,action:l,method:c,encType:d,onSubmit:h,...y},s)},t.FormProvider=e=>{const{children:t,...n}=e;return i.default.createElement(S.Provider,{value:n},t)},t.appendErrors=q,t.get=b,t.set=R,t.useController=L,t.useFieldArray=function(e){const t=O(),{control:n=t.control,name:a,keyName:r="id",shouldUnregister:o}=e,[s,l]=i.default.useState(n._getFieldArray(a)),c=i.default.useRef(n._getFieldArray(a).map($)),u=i.default.useRef(s),d=i.default.useRef(a),p=i.default.useRef(!1);d.current=a,u.current=s,n._names.array.add(a),e.rules&&n.register(a,e.rules),C({next:({values:e,name:t})=>{if(t===d.current||!t){const t=b(e,d.current);Array.isArray(t)&&(l(t),c.current=t.map($))}},subject:n._subjects.array});const f=i.default.useCallback((e=>{p.current=!0,n._updateFieldArray(a,e)}),[n,a]);return i.default.useEffect((()=>{if(n._state.action=!1,G(a,n._names)&&n._subjects.state.next({...n._formState}),p.current&&(!U(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=b(e.errors,a),i=b(n._formState.errors,a);(i?!t&&i.type||t&&(i.type!==t.type||i.message!==t.message):t&&t.type)&&(t?R(n._formState.errors,a,t):ge(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=b(n._fields,a);e&&e._f&&se(e,n._formValues,n._options.criteriaMode===E,n._options.shouldUseNativeValidation,!0).then((e=>!w(e)&&n._subjects.state.next({errors:H(n._formState.errors,e,a)})))}n._subjects.values.next({name:a,values:{...n._formValues}}),n._names.focus&&B(n._fields,(e=>!!e&&e.startsWith(n._names.focus||""))),n._names.focus="",n._updateValid()}),[s,a,n]),i.default.useEffect((()=>(!b(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||o)&&n.unregister(a)})),[a,n,r,o]),{swap:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);fe(i,e,t),fe(c.current,e,t),f(i),l(i),n._updateFieldArray(a,i,fe,{argA:e,argB:t},!1)}),[f,a,n]),move:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);de(i,e,t),de(c.current,e,t),f(i),l(i),n._updateFieldArray(a,i,de,{argA:e,argB:t},!1)}),[f,a,n]),prepend:i.default.useCallback(((e,t)=>{const i=I(m(e)),r=pe(n._getFieldArray(a),i);n._names.focus=V(a,0,t),c.current=pe(c.current,i.map($)),f(r),l(r),n._updateFieldArray(a,r,pe,{argA:ce(e)})}),[f,a,n]),append:i.default.useCallback(((e,t)=>{const i=I(m(e)),r=le(n._getFieldArray(a),i);n._names.focus=V(a,r.length-1,t),c.current=le(c.current,i.map($)),f(r),l(r),n._updateFieldArray(a,r,le,{argA:ce(e)})}),[f,a,n]),remove:i.default.useCallback((e=>{const t=me(n._getFieldArray(a),e);c.current=me(c.current,e),f(t),l(t),n._updateFieldArray(a,t,me,{argA:e})}),[f,a,n]),insert:i.default.useCallback(((e,t,i)=>{const r=I(m(t)),o=ue(n._getFieldArray(a),e,r);n._names.focus=V(a,e,i),c.current=ue(c.current,e,r.map($)),f(o),l(o),n._updateFieldArray(a,o,ue,{argA:e,argB:ce(t)})}),[f,a,n]),update:i.default.useCallback(((e,t)=>{const i=m(t),r=be(n._getFieldArray(a),e,i);c.current=[...r].map(((t,n)=>t&&n!==e?c.current[n]:$())),f(r),l([...r]),n._updateFieldArray(a,r,be,{argA:e,argB:i},!0,!1)}),[f,a,n]),replace:i.default.useCallback((e=>{const t=I(m(e));c.current=t.map($),f([...t]),l([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[f,a,n]),fields:i.default.useMemo((()=>s.map(((e,t)=>({...e,[r]:c.current[t]||$()})))),[s,r])}},t.useForm=function(e={}){const t=i.default.useRef(),[n,a]=i.default.useState({isDirty:!1,isValidating:!1,isLoading:Y(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:Y(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={..._e(e,(()=>a((e=>({...e}))))),formState:n});const r=t.current.control;return r._options=e,C({subject:r._subjects.state,next:e=>{T(e,r._proxyFormState,r._updateFormState,!0)&&a({...r._formState})}}),i.default.useEffect((()=>{e.values&&!ve(e.values,r._defaultValues)?r._reset(e.values,r._options.resetOptions):r._resetDefaultValues()}),[e.values,r]),i.default.useEffect((()=>{r._state.mount||(r._updateValid(),r._state.mount=!0),r._state.watch&&(r._state.watch=!1,r._subjects.state.next({...r._formState})),r._removeUnmounted()})),t.current.formState=k(n,r),t.current},t.useFormContext=O,t.useFormState=_,t.useWatch=F},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i="!{osquery",r={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}i+=n;try{r=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return i+="}",e(i)({type:"osquery",configuration:r})},n.splice(n.indexOf("text"),0,"osquery")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(370);const i=({status:e,query:t,signalIds:n,signal:i})=>{if(n&&n.length>0)return Object(a.i)({status:e,signalIds:n,signal:i}).then((({updated:e})=>({updated:null!=e?e:0,version_conflicts:0})));if(t)return Object(a.j)({status:e,query:t,signal:i}).then((({updated:e,version_conflicts:t})=>({updated:null!=e?e:0,version_conflicts:t})));throw new Error("Either query or signalIds must be provided")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const a=["_source"];function i(e=[],t){return e&&e.length>0&&(1!==e.length||e[0]!==t.timeFieldName)?e:a}function r(e,t){return Object.fromEntries(Object.entries(e).filter((([e])=>e.startsWith(`${t}.`))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(19),o=n(696),s=n(208);const l=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:l,dataTestSubj:c,height:u,autoFocusDisabled:d,setIsMarkdownInvalid:p,includePlugins:m=!0},f)=>{const[g,b]=Object(a.useState)([]),y=Object(a.useCallback)(((e,{messages:t})=>{b(e?[e]:t),p(!!e)}),[p]),h=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t;d||null===(e=h.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const v=Object(s.b)("investigation_guide"),E=Object(s.b)("investigation_guide_interactions"),x=Object(a.useMemo)((()=>m?Object(o.d)({insightsUpsellingMessage:v,interactionsUpsellingMessage:E}):void 0),[m,v,E]);return Object(a.useImperativeHandle)(f,(()=>{var e,t;if(!h.current)return null;const n=null===(e=h.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...h.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(r.EuiMarkdownEditor,{ref:h,"aria-label":n,editorId:l,onChange:e,value:t,uiPlugins:x,parsingPluginList:o.a,processingPluginList:o.c,onParse:y,errors:g,"data-test-subj":c,height:u})}));l.displayName="MarkdownEditorComponent";const c=Object(a.memo)(l)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.userProfiles.fetchCurrentUserProfile.failure",{defaultMessage:"Failed to find current user"}),r=a.i18n.translate("xpack.securitySolution.userProfiles.fetchUserProfiles.failure",{defaultMessage:"Failed to find users"}),o=a.i18n.translate("xpack.securitySolution.userProfiles.unknownUser.displayName",{defaultMessage:"Unknown"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={OVERVIEW_TAB_EXPANDED_SECTIONS:"securitySolution.documentDetailsFlyout.overviewSectionExpanded.v8.14",RIGHT_PANEL_SELECTED_TABS:"securitySolution.documentDetailsFlyout.rightPanel.selectedTabs.v8.14"}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l}));const a="network.bytes",i="network.community_id",r="network.direction",o="network.packets",s="network.protocol",l="network.transport"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n.n(a),r=n(19),o=n(126);const s=Object(a.memo)((({title:e,body:t,confirmButton:n,cancelButton:a,onCancel:s,onSuccess:l,"data-test-subj":c})=>{const u=Object(o.a)(c);return i.a.createElement(r.EuiModal,{onClose:s,"data-test-subj":c},i.a.createElement(r.EuiModalHeader,{"data-test-subj":u("header")},i.a.createElement(r.EuiModalHeaderTitle,null,e)),i.a.createElement(r.EuiModalBody,{"data-test-subj":u("body")},i.a.createElement(r.EuiText,null,i.a.createElement("p",null,t))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:s,"data-test-subj":u("cancelButton")},a),i.a.createElement(r.EuiButton,{fill:!0,onClick:l,"data-test-subj":u("submitButton")},n)))}));s.displayName="ArtifactConfirmModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(211);const i=`${a.a}Body`,r=`${a.a}OverviewTab`,o=`${a.a}OverviewTabLabel`,s=`${a.a}TableTab`,l=`${a.a}JsonTab`},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"x",(function(){return o})),n.d(t,"t",(function(){return s})),n.d(t,"v",(function(){return l})),n.d(t,"y",(function(){return c})),n.d(t,"w",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"s",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"n",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"j",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return E})),n.d(t,"f",(function(){return x})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return S})),n.d(t,"r",(function(){return O})),n.d(t,"l",(function(){return k})),n.d(t,"k",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return I}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.pageTitle",{defaultMessage:"MITRE ATT&CK® coverage"}),r=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.collapseCellsButton",{defaultMessage:"Collapse cells"}),o=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.expandCellsButton",{defaultMessage:"Expand cells"}),s=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesMetadataLabel",{defaultMessage:"Disabled Rules:"}),l=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesMetadataLabel",{defaultMessage:"Enabled Rules:"}),c=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.subtechniques",{defaultMessage:"Sub-techniques"}),u=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enableAllDisabledButtonLabel",{defaultMessage:"Enable all disabled"}),d=(e,t)=>a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreTechniques",{values:{enabledTechniques:e,totalTechniques:t},defaultMessage:"{enabledTechniques}/{totalTechniques} techniques"}),p=(e,t)=>a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreSubtechniques",{values:{enabledSubtechniques:e,totalSubtechniques:t},defaultMessage:"Sub-techniques {enabledSubtechniques}/{totalSubtechniques}"}),m=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesListLabel",{defaultMessage:"Disabled rules"}),f=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesListLabel",{defaultMessage:"Enabled rules"}),g=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendTitle",{defaultMessage:"Legend"}),b=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendSubtitle",{defaultMessage:"(count will include all rules selected)"}),y=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendRulesLabel",{defaultMessage:"rules"}),h=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRuleActivity",{defaultMessage:"Enabled rules"}),v=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRuleActivity",{defaultMessage:"Disabled rules"}),E=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.elasticRuleSource",{defaultMessage:"Elastic rules"}),x=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.customRuleSource",{defaultMessage:"Custom rules"}),j=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleActivityFilterLabel",{defaultMessage:"Installed rule status"}),S=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleSourceFilterLabel",{defaultMessage:"Installed rule type"}),O=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.searchBarPlaceholder",{defaultMessage:'Search for the tactic, technique (e.g.,"defense evasion" or "TA0005") or rule name'}),k=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverTitle",{defaultMessage:"Select to view on framework"}),w=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverClearAll",{defaultMessage:"Clear all"}),T=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.dashboardInformation",{defaultMessage:"Your current coverage of MITRE ATT&CK® tactics and techniques, based on installed rules. Click a cell to view and enable a technique's rules. Rules must be mapped to the MITRE ATT&CK® framework to be displayed."}),I=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.fetchErrorTitle",{defaultMessage:"Failed to fetch coverage overview data"})},function(e,t,n){const a=n(164);e.exports=(e,t,n)=>{const i=new a(e,n),r=new a(t,n);return i.compare(r)||i.compareBuild(r)}},function(e,t,n){const a=n(190);e.exports=(e,t,n)=>a(e,t,n)<0},function(e,t,n){const a=n(190);e.exports=(e,t,n)=>a(e,t,n)<=0},function(e,t,n){const a=n(164),i=n(386),{ANY:r}=i,o=n(193),s=n(387),l=n(385),c=n(491),u=n(492),d=n(421);e.exports=(e,t,n,p)=>{let m,f,g,b,y;switch(e=new a(e,p),t=new o(t,p),n){case">":m=l,f=u,g=c,b=">",y=">=";break;case"<":m=c,f=d,g=l,b="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,p))return!1;for(let n=0;n<t.set.length;++n){const a=t.set[n];let o=null,s=null;if(a.forEach((e=>{e.semver===r&&(e=new i(">=0.0.0")),o=o||e,s=s||e,m(e.semver,o.semver,p)?o=e:g(e.semver,s.semver,p)&&(s=e)})),o.operator===b||o.operator===y)return!1;if((!s.operator||s.operator===b)&&f(e,s.semver))return!1;if(s.operator===y&&g(e,s.semver))return!1}return!0}},function(e,t,n){"use strict";e.exports=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}},function(e,t,n){"use strict";e.exports=function(e){return null==e?[]:"length"in e?e:[e]}},function(e,t,n){"use strict";var a=n(238);e.exports=function(e,t){return e.length?(a(e,e.length,0,t),e):t}},function(e,t,n){"use strict";e.exports=function(e,t,n){for(var a,i=[],r=-1;++r<e.length;)(a=e[r].resolveAll)&&i.indexOf(a)<0&&(t=a(t,n),i.push(a));return t}},function(e,t,n){"use strict";var a=n(240)(/[A-Za-z]/);e.exports=a},function(e,t,n){"use strict";var a=n(239),i=n(496),r=n(238),o=n(494),s=n(497),l=n(286),c=n(683),u=n(684),d=n(686),p=n(685),m={name:"labelEnd",tokenize:function(e,t,n){for(var a,i,r=this,s=r.events.length;s--;)if(("labelImage"===r.events[s][1].type||"labelLink"===r.events[s][1].type)&&!r.events[s][1]._balanced){a=r.events[s][1];break}return function(t){return a?a._inactive?c(t):(i=r.parser.defined.indexOf(o(r.sliceSerialize({start:a.end,end:r.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):n(t)};function l(n){return 40===n?e.attempt(f,t,i?t:c)(n):91===n?e.attempt(g,t,i?e.attempt(b,t,c):c)(n):i?t(n):c(n)}function c(e){return a._balanced=!0,n(e)}},resolveTo:function(e,t){for(var n,a,o,c,u,d,p,m=e.length,f=0;m--;)if(c=e[m][1],u){if("link"===c.type||"labelLink"===c.type&&c._inactive)break;"enter"===e[m][0]&&"labelLink"===c.type&&(c._inactive=!0)}else if(d){if("enter"===e[m][0]&&("labelImage"===c.type||"labelLink"===c.type)&&!c._balanced&&(u=m,"labelLink"!==c.type)){f=2;break}}else"labelEnd"===c.type&&(d=m);return n={type:"labelLink"===e[u][1].type?"link":"image",start:l(e[u][1].start),end:l(e[e.length-1][1].end)},a={type:"label",start:l(e[u][1].start),end:l(e[d][1].end)},o={type:"labelText",start:l(e[u+f+2][1].end),end:l(e[d-2][1].start)},p=i(p=[["enter",n,t],["enter",a,t]],e.slice(u+1,u+f+3)),p=i(p,[["enter",o,t]]),p=i(p,s(t.parser.constructs.insideSpan.null,e.slice(u+f+4,d-3),t)),p=i(p,[["exit",o,t],e[d-2],e[d-1],["exit",a,t]]),p=i(p,e.slice(d+1)),p=i(p,[["exit",n,t]]),r(e,u,e.length,p),e},resolveAll:function(e){for(var t,n=-1;++n<e.length;)(t=e[n][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(n+1,"labelImage"===t.type?4:2),t.type="data",n++);return e}},f={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),p(e,i)};function i(t){return 41===t?s(t):c(e,r,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function r(t){return a(t)?p(e,o)(t):s(t)}function o(t){return 34===t||39===t||40===t?d(e,p(e,s),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):s(t)}function s(a){return 41===a?(e.enter("resourceMarker"),e.consume(a),e.exit("resourceMarker"),e.exit("resource"),t):n(a)}}},g={tokenize:function(e,t,n){var a=this;return function(t){return u.call(a,e,i,n,"reference","referenceMarker","referenceString")(t)};function i(e){return a.parser.defined.indexOf(o(a.sliceSerialize(a.events[a.events.length-1][1]).slice(1,-1)))<0?n(e):t(e)}}},b={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),a};function a(a){return 93===a?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):n(a)}}};e.exports=m},function(e,t,n){"use strict";n.d(t,"a",(function(){return Re}));var a=n(19),i=n(2),r=n.n(i),o=n(45),s=n(4);const l=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),u=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),p=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),m=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),f=s.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),g=s.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),b=s.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),y=s.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),h=s.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),v=s.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),E=s.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),x=s.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),j=s.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),S=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),O=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),k=s.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),w=s.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),T=s.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),I=s.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),M=s.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),C=s.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),_=s.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),D=s.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),A=s.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),F=s.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),N=s.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),P=s.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),R=s.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),L=s.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),z=s.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),q=s.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),B=s.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var $=n(166),V=n(127),U=n(531),G=n(41),H=n.n(G),W=n(49);const Q=H()(a.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1bcjjxf-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),Y=H()(a.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1bcjjxf-1"})(["max-width:none;"]),K=H()(a.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1bcjjxf-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),J=H()(a.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1bcjjxf-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),Z=H.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1bcjjxf-4"})(["width:600px;"]),X=H()(a.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1bcjjxf-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],W.euiThemeVars.euiSizeXS),ee=H.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1bcjjxf-6"})(["",""],(({theme:e})=>Object(G.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),te=(e,t)=>e.filter((e=>e!==t));var ne=n(308),ae=n(118),ie=n(511);const re=(e,t)=>Object(ne.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var oe=n(42);const se=H()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-yfgyo3-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),le=r.a.memo((({isShowing:e,onDismissModal:t,onContinue:n,onUpdate:i,missingPatterns:o})=>e?r.a.createElement(se,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},r.a.createElement(a.EuiModalHeader,null,r.a.createElement(a.EuiModalHeaderTitle,null,y)),r.a.createElement(a.EuiModalBody,null,r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(a.EuiTextColor,{color:"subdued"},r.a.createElement("p",null,r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:r.a.createElement(ee,null,o.join(", "))}}),b))),r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(J,{"aria-label":h,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:n,title:h},h)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:i,size:"s"},v))))):null));le.displayName="UpdateDefaultDataViewModal";var ce=n(149),ue=n(121),de=n(129),pe=n(124),me=n(158);const fe=({activePatterns:e,deadPatterns:t,selectedPatterns:n,timelineType:o})=>{const s=Object(i.useMemo)((()=>t.length>0?r.a.createElement(a.EuiToolTip,{content:r.a.createElement(ge,{activePatterns:e,selectedPatterns:n,timelineType:o})},r.a.createElement(a.EuiIcon,{type:"questionInCircle",title:N})):null),[e,t.length,n,o]);return o===ue.m.template?r.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:s,callout:r.a.createElement(ee,null,e.join(", "))}})):r.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:s,callout:r.a.createElement(ee,null,e.join(", "))}}))},ge=({activePatterns:e,selectedPatterns:t,timelineType:n})=>{const a=Object(i.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return n===ue.m.template?r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}}):r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}})},be=({timelineType:e,selectedPatterns:t})=>{const n=Object(i.useMemo)((()=>r.a.createElement(ee,null,t.join(", "))),[t]);return e===ue.m.template?r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:n}}):r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:n}})},ye=({onReset:e,timelineType:t})=>t===ue.m.template?r.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})):r.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})),he=({onReset:e,timelineType:t})=>t===ue.m.template?r.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})):r.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e},f)}})),ve={deprecated:{title:{[ue.m.default]:c,[ue.m.template]:u},update:D},missingPatterns:{title:{[ue.m.default]:d,[ue.m.template]:p},update:v}},Ee=r.a.memo((({activePatterns:e,indicesExist:t,isModified:n,onDismiss:o,onReset:s,onUpdate:l,selectedPatterns:c,missingPatterns:u})=>{const d=Object(i.useMemo)((()=>r.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:l,size:"s",disabled:!t},ve[n].update)),[t,n,l]),p=Object(i.useMemo)((()=>t?d:r.a.createElement(a.EuiToolTip,{position:"top",content:P,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),m=e&&e.length>0?c.filter((t=>!e.includes(t))):[],f=Object(i.useMemo)((()=>de.b.getTimelineByIdSelector()),[]),g=Object(pe.a)((e=>{var t;return(null!==(t=f(e,ce.f.active))&&void 0!==t?t:me.b).timelineType}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:ve[n].title[g]}),r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(a.EuiTextColor,{color:"subdued"},r.a.createElement("p",null,e&&e.length>0?r.a.createElement(fe,{timelineType:g,activePatterns:e,deadPatterns:m,selectedPatterns:c}):r.a.createElement(be,{timelineType:g,selectedPatterns:c}),"deprecated"===n&&r.a.createElement(ye,{timelineType:g,onReset:s}),"missingPatterns"===n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:r.a.createElement(ee,null,u.join(", "))}})),r.a.createElement(he,{timelineType:g,onReset:s}))))),r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(J,{"aria-label":F,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:o,title:F},F)),r.a.createElement(a.EuiFlexItem,{grow:!1},p)))}));Ee.displayName="TemporarySourcererComp";const xe=r.a.memo((({activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onContinueWithoutUpdate:i,onDismiss:o,onReset:s,onUpdateStepOne:l,onUpdateStepTwo:c,selectedPatterns:u,isShowingUpdateModal:d,onDismissModal:p})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee,{activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onDismiss:o,onReset:s,onUpdate:l,selectedPatterns:u}),r.a.createElement(le,{isShowing:d,missingPatterns:a,onDismissModal:p,onContinue:i,onUpdate:c}))));xe.displayName="TemporarySourcerer";var je=n(132),Se=n(393),Oe=n(5);const ke=H()(a.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-12c6aaf-0"})(["float:right;"]),we=r.a.memo((()=>{const e=Object(i.useCallback)((()=>{document.location.reload()}),[]);return r.a.createElement(ke,{onClick:e,"data-test-subj":"page-refresh"},q)}));we.displayName="RefreshButton";var Te=n(123);const Ie=({activePatterns:e,disabled:t,isModified:n,isOnlyDetectionAlerts:o,isPopoverOpen:s,isTimelineSourcerer:l,loading:c,onClick:u,selectedPatterns:d,signalIndexName:p})=>{const m=Object(i.useMemo)((()=>{switch(n){case"modified":return r.a.createElement(X,{"data-test-subj":"sourcerer-modified-badge"},E);case"alerts":return r.a.createElement(X,{"data-test-subj":"sourcerer-alerts-badge"},x);case"deprecated":return r.a.createElement(X,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},j);case"missingPatterns":return r.a.createElement(X,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},j);default:return null}}),[n]),f=Object(i.useMemo)((()=>l?a.EuiButton:K),[l]),b=Object(i.useMemo)((()=>r.a.createElement(f,{"aria-label":g,"data-test-subj":l?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:u,title:g},g,!t&&m)),[t,m,l,c,u,f]),y=Object(i.useMemo)((()=>t?_:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:n,signalIndexName:a})=>t||e&&!a?null:(e?[a]:n).join(", "))({isOnlyDetectionAlerts:o,isPopoverOpen:s,selectedPatterns:null!=e?e:d,signalIndexName:p})),[e,t,o,s,d,p]);return y?r.a.createElement(a.EuiToolTip,{position:"top",content:y,"data-test-subj":"sourcerer-tooltip"},b):b},Me=Object(i.memo)(Ie),Ce=r.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?r.a.createElement(a.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Ce.displayName="SourcererCallout";const _e=r.a.memo((({onChange:e,checked:t,isShow:n})=>n?r.a.createElement(Y,null,r.a.createElement(a.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:L,onChange:e})):null));_e.displayName="AlertsCheckbox";const De=r.a.memo((({disableSave:e,isShow:t,onReset:n,onSave:i})=>t?r.a.createElement(Y,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(J,{"aria-label":A,"data-test-subj":"sourcerer-reset",flush:"left",onClick:n,title:A},A)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButton,{onClick:i,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},w)))):null));De.displayName="SaveButtons";var Ae=n(459),Fe=n(189),Ne=n(198);const Pe=r.a.memo((({showSourcerer:e,activePatterns:t,isTriggerDisabled:n,isModified:i,isOnlyDetectionAlerts:o,isPopoverOpen:s,loading:l,setPopoverIsOpenCb:c,selectedPatterns:u,signalIndexName:d,handleClosePopOver:p,isTimelineSourcerer:m,selectedDataViewId:f,sourcererMissingPatterns:g,onUpdateDetectionAlertsChecked:b,setMissingPatterns:y,setDataViewId:h,scopeId:v,children:E})=>e?v===V.SourcererScopeName.analyzer?r.a.createElement(r.a.Fragment,null,E):r.a.createElement(a.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:r.a.createElement(Me,{activePatterns:t,disabled:n,isModified:i,isOnlyDetectionAlerts:o,isPopoverOpen:s,isTimelineSourcerer:m,loading:l,onClick:c,selectedPatterns:u,signalIndexName:d}),closePopover:p,"data-test-subj":m?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:s,ownFocus:!0,repositionOnScroll:!0},r.a.createElement(r.a.Fragment,null,E)):null));Pe.displayName="SourcererPopover";const Re=r.a.memo((({scope:e})=>{const t=Object(o.useDispatch)(),n=e===V.SourcererScopeName.detections,s=e===V.SourcererScopeName.timeline,c=e===V.SourcererScopeName.default,u=Object(Fe.d)(Ne.a.sourcerer),d=Object(o.useSelector)($.d.signalIndexName),p=Object(o.useSelector)($.d.defaultDataView),g=Object(o.useSelector)($.d.kibanaDataViews),b=Object(o.useSelector)((t=>$.d.sourcererScopeSelectedDataViewId(t,e))),y=Object(o.useSelector)((t=>$.d.sourcererScopeSelectedPatterns(t,e))),h=Object(o.useSelector)((t=>$.d.sourcererScopeMissingPatterns(t,e))),{pollForSignalIndex:v}=Object(Ae.a)();Object(i.useEffect)((()=>{null!=v&&(s||n)&&v()}),[n,s,v]);const{activePatterns:j,indicesExist:w,loading:_}=Object(je.a)(e),[D,A]=Object(i.useState)(j&&j.length>0?h.filter((e=>j.includes(e))):[]);Object(i.useEffect)((()=>{j&&j.length>0&&A(h.filter((e=>j.includes(e))))}),[j,h]);const[F,N]=Object(i.useState)(s&&y.join()===d),P=Object(i.useCallback)((()=>{N(s&&y.join()===d)}),[s,y,d]);Object(i.useEffect)((()=>{P()}),[y]);const L=n||s&&F,[q,G]=Object(i.useState)(!1),[H,W]=Object(i.useState)(b),{allOptions:J,dataViewSelectOptions:ee,loadingIndexPatterns:se,isModified:le,handleOutsideClick:ce,onChangeCombo:ue,renderOption:de,selectedOptions:pe,setIndexPatternsByDataView:me}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:n,kibanaDataViews:s,missingPatterns:l,scopeId:c,selectedDataViewId:u,selectedPatterns:d,signalIndexName:p})=>{const m=Object(o.useDispatch)(),{data:{dataViews:f}}=Object(ae.j)().services,g=Object(i.useRef)(!0),[b,y]=Object(i.useState)(!1),h=Object(i.useMemo)((()=>p?re([p]):[]),[p]),v=Object(i.useMemo)((()=>re(d)),[d]),[j,k]=Object(i.useState)(n?h:v),[w,T]=Object(i.useState)(null==e?"deprecated":l.length>0?"missingPatterns":""),{allPatterns:I,selectablePatterns:M}=Object(i.useMemo)((()=>{if(n&&p)return{allPatterns:[p],selectablePatterns:[p]};const t=s.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const a=[...new Set(t.title.split(","))];return c===$.b.SourcererScopeName.default?{allPatterns:te(a,p),selectablePatterns:te(t.patternList,p)}:{allPatterns:a,selectablePatterns:t.patternList}}),[e,n,s,c,p]),C=Object(i.useMemo)((()=>re(I,M)),[I,M]),_=Object(i.useCallback)(((e,n=!1)=>c===V.SourcererScopeName.detections||n?h:re(Object(U.b)(s.find((t=>t.id===e)),c,p,e===t))),[h,s,c,p,t]),D=Object(i.useMemo)((()=>null!=e?_(e):[]),[e,_]),A=Object(i.useCallback)(((e,t)=>{if(null==t)return T("deprecated");if(l.length>0)return T("missingPatterns");if(n)return T("alerts");const a=D.length!==e.length||!D.every((t=>e.find((e=>t.value===e))));return T(a?"modified":"")}),[D,n,l.length]);Object(i.useEffect)((()=>{k(c===V.SourcererScopeName.detections?h:v)}),[d,c,v,h]),Object(i.useEffect)((()=>{A(d.map((e=>e)),u)}),[n,u,l,c,d]);const F=Object(i.useCallback)((e=>{k(e)}),[]),N=Object(i.useCallback)((({value:e})=>r.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),P=Object(i.useCallback)((async(e,t)=>{if(s.some((t=>t.id===e&&0===t.indexFields.length))){try{y(!0),k([]);const t=await Object(ie.a)(e,f);g.current&&(m($.a.setDataView(t)),k(n?h:re(t.patternList)))}catch(e){}y(!1)}else k(_(e,t))}),[h,m,_,n,s,f]),R=Object(i.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:n,isOnlyDetectionAlerts:i,kibanaDataViews:o})=>i?[{inputDisplay:r.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},r.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",O,r.a.createElement(X,{"data-test-subj":"security-alerts-option-badge"},x)),value:t}]:o.map((({title:i,id:o})=>({inputDisplay:o===t?r.a.createElement("span",{"data-test-subj":"security-option-super"},r.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",S,n&&o===e&&r.a.createElement(X,{"data-test-subj":"security-modified-option-badge"},E)):r.a.createElement("span",{"data-test-subj":"dataView-option-super"},r.a.createElement(a.EuiIcon,{type:"logoKibana",size:"s"})," ",i,n&&o===e&&r.a.createElement(X,{"data-test-subj":"security-modified-option-badge"},E)),value:o}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===w,isOnlyDetectionAlerts:n,kibanaDataViews:s}):[]),[e,t,w,n,s]);return Object(i.useEffect)((()=>(g.current=!0,()=>{g.current=!1})),[]),{allOptions:C,dataViewSelectOptions:R,loadingIndexPatterns:b,handleOutsideClick:Object(i.useCallback)((()=>{k(v)}),[v]),isModified:w,onChangeCombo:F,renderOption:N,selectedOptions:j,setIndexPatternsByDataView:P}})({dataViewId:H,defaultDataViewId:p.id,isOnlyDetectionAlerts:L,kibanaDataViews:g,missingPatterns:D,scopeId:e,selectedDataViewId:b,selectedPatterns:y,signalIndexName:d}),fe=Object(i.useCallback)((e=>{N(e.target.checked),W(p.id),me(p.id,e.target.checked)}),[p.id,me]),[ge,be]=Object(i.useState)(!1),[ye,he]=Object(i.useState)(!1),ve=Object(i.useCallback)((()=>{G((e=>!e)),be(!1)}),[]),Ee=Object(i.useCallback)(((n,a,i)=>{t($.a.setSelectedDataView({id:e,selectedDataViewId:n,selectedPatterns:a,shouldValidateSelectedPatterns:i})),c&&u({[V.SourcererScopeName.default]:{id:n,selectedPatterns:a}})}),[t,e,c,u]),ke=Object(i.useCallback)((e=>{W(e),me(e)}),[me]),Ie=Object(i.useCallback)((()=>{W(p.id),me(p.id),N(!1),A([])}),[p.id,me]),Me=Object(i.useCallback)((()=>{const e=pe.map((e=>e.label));null!=H&&Ee(H,e),G(!1)}),[Ee,H,pe]),Re=Object(i.useCallback)((()=>{ce(),W(b),A(h),P(),G(!1),be(!1)}),[ce,P,b,h]),Le=Object(i.useCallback)((()=>{he(!1);const e=y.filter((e=>p.patternList.includes(e)));Ee(p.id,e),G(!1)}),[p.id,p.patternList,Ee,y]),ze=Object(i.useCallback)((()=>{0===D.length?Le():he(!0)}),[D,Le]),[qe,Be]=Object(i.useState)(!1),$e=(e=>{const{uiSettings:t,...n}=Object(ae.j)().services,{addSuccess:o,addError:s}=Object(Te.a)();return Object(i.useCallback)((async i=>{const[l,c]=await(async()=>{try{const e=[...t.get(Oe.O),...i];return[await t.set(Oe.O,Object(ne.a)(e)),null]}catch(e){return[!1,e]}})();return l?(o({color:"success",title:Object(Se.a)(z,n),text:Object(Se.a)(r.a.createElement(we,null),n),iconType:void 0,toastLifeTimeMs:6e5}),!0):(s(null!==c?c:new Error(B),{title:B,toastMessage:r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:r.a.createElement(a.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},f)}}))}),!1)}),[s,o,e,t,n])})(Object(i.useCallback)((()=>{G(!0),Ie()}),[Ie])),Ve=Object(i.useCallback)((async()=>{const e=await $e(D);he(!1),G(!1),e&&(Ee(p.id,null!=j?j:y,!1),Be(!0))}),[j,p.id,D,Ee,y,$e]);Object(i.useEffect)((()=>{W(b)}),[b]);const Ue=Object(i.useCallback)((()=>{be((e=>!e))}),[]),Ge=Object(i.useMemo)((()=>w||[V.SourcererScopeName.analyzer,V.SourcererScopeName.timeline].includes(e)),[w,e]);return r.a.createElement(Pe,{showSourcerer:Ge,activePatterns:j,isTriggerDisabled:qe,isModified:le,isOnlyDetectionAlerts:L,isPopoverOpen:q,isTimelineSourcerer:s,loading:_,handleOutsideClick:ce,setPopoverIsOpenCb:ve,selectedPatterns:y,signalIndexName:d,handleClosePopOver:Re,selectedDataViewId:b,sourcererMissingPatterns:h,onUpdateDetectionAlertsChecked:P,setMissingPatterns:A,setDataViewId:W,scopeId:e},r.a.createElement(Z,null,r.a.createElement(a.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},r.a.createElement(r.a.Fragment,null,k)),r.a.createElement(Ce,{isOnlyDetectionAlerts:L,title:s?m:l}),r.a.createElement(a.EuiSpacer,{size:"s"}),null===H&&"deprecated"===le||"missingPatterns"===le?r.a.createElement(xe,{activePatterns:j,indicesExist:w,isModified:le,isShowingUpdateModal:ye,missingPatterns:D,onContinueWithoutUpdate:Le,onDismiss:ve,onDismissModal:()=>he(!1),onReset:Ie,onUpdateStepOne:"deprecated"===le?ze:Ve,onUpdateStepTwo:Ve,selectedPatterns:y}):r.a.createElement(a.EuiForm,{component:"form"},r.a.createElement(r.a.Fragment,null,r.a.createElement(_e,{isShow:s,checked:F,onChange:fe}),H&&r.a.createElement(Y,{label:T},r.a.createElement(a.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:se,disabled:L,fullWidth:!0,onChange:ke,options:ee,placeholder:T,valueOfSelected:H})),r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(K,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:ge?"arrowDown":"arrowRight",onClick:Ue},I),ge&&r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(Q,{isDisabled:se,$expandAdvancedOptions:ge,helpText:L?void 0:C,label:M},r.a.createElement(a.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:L||se,onChange:ue,options:J,placeholder:R,renderOption:de,selectedOptions:pe})),r.a.createElement(De,{disableSave:0===pe.length,isShow:!n,onReset:Ie,onSave:Me})),r.a.createElement(a.EuiSpacer,{size:"s"}))))}));Re.displayName="Sourcerer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(46),i=n(1447),r=n(2069);a.exact(a.type({id:r.a})),a.exact(a.type({items:a.array(i.a)})),a.exact(a.type({name:a.string,description:a.string}));var o=n(891);const s=a.array(o.b),l=new a.Type("DefaultNamespaceArray",s.is,((e,t)=>{if(null==e)return a.success(["single"]);if("string"==typeof e){const n=e.trim().split(",").map((e=>e.trim()));return s.validate(n,t)}return a.failure(e,t)}),String);var c=n(2071),u=n(799),d=n(255);const p=new a.Type("NonEmptyStringArray",a.array(a.string).is,((e,t)=>{if("string"==typeof e&&""!==e.trim()){const n=e.trim().split(",").map((e=>e.trim()));return n.some((e=>""===e))?a.failure(e,t):a.success(n)}return a.failure(e,t)}),String);var m=n(439);a.intersection([a.exact(a.type({namespace_types:l})),a.exact(a.partial({ids:p,list_ids:p}))]);const f=a.exact(a.type({name:m.t,id:m.v,rule_id:m.y,exception_lists:c.a})),g=a.intersection([u.a,a.exact(a.type({referenced_rules:a.array(f)}))]),b=a.record(d.a,g);a.exact(a.type({references:a.array(b)}));var y=n(5);const h=`${y.Lb}/rules`,v=(y.qb,`${h}/exceptions/_find_references`)},function(e,t,n){"use strict";n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(19),i=n(2),r=n.n(i),o=n(42),s=n(332),l=n(620),c=n(203),u=n(4);const d=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.notSupportedTooltip",{defaultMessage:"Add the Elastic Defend integration via Elastic Agent to enable this feature"}),p=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.unenrolledTooltip",{defaultMessage:"Host is no longer enrolled with the Elastic Defend integration"}),m=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.loadingTooltip",{defaultMessage:"Loading"}),f=u.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.generalMetadataErrorTooltip",{defaultMessage:"Failed to retrieve Endpoint metadata"}),g=(e,t=!0)=>{const{data:n,isFetching:a,error:r}=Object(l.c)(e,{enabled:t});return Object(i.useMemo)((()=>{var e,i,o,s,l,u;const g={isDisabled:!1,tooltip:void 0,capabilities:[],hostName:"",platform:""};return t?a?(g.isDisabled=!0,g.tooltip=m,g):r&&404===(null===(e=r.body)||void 0===e?void 0:e.statusCode)?(g.isDisabled=!0,g.tooltip=d,g):r&&400===(null===(i=r.body)||void 0===i?void 0:i.statusCode)&&null!==(o=r.body)&&void 0!==o&&o.message.includes("unenrolled")||(null==n?void 0:n.host_status)===c.d.UNENROLLED?(g.isDisabled=!0,g.tooltip=p,g):(r&&(g.isDisabled=!0,g.tooltip=f),g.capabilities=null!==(s=null==n?void 0:n.metadata.Endpoint.capabilities)&&void 0!==s?s:[],g.hostName=null!==(l=null==n?void 0:n.metadata.host.name)&&void 0!==l?l:"",g.platform=null!==(u=null==n?void 0:n.metadata.host.os.name.toLowerCase())&&void 0!==u?u:"",g):(g.isDisabled=!0,g)}),[t,a,r,null==n?void 0:n.host_status,null==n?void 0:n.metadata.Endpoint.capabilities,null==n?void 0:n.metadata.host.name,null==n?void 0:n.metadata.host.os.name])};var b=n(140);const y=Object(i.memo)((({agentType:e,agentId:t})=>{const{handleResponseActionsClick:n,isDisabled:s,tooltip:c}=(({onClick:e,agentId:t,agentType:n})=>{const a="endpoint"===n,r=Object(l.d)(),{tooltip:o,isDisabled:s,capabilities:c,hostName:u,platform:p}=g(t,a),m=Object(i.useCallback)((()=>{s||(r({agentId:t,agentType:n,hostName:u,platform:p,capabilities:a?c:[]}),e&&e())}),[s,r,t,n,u,p,a,c,e]);return Object(i.useMemo)((()=>({isDisabled:!a||s,tooltip:a?o:d,handleResponseActionsClick:m})),[m,s,a,o])})({agentType:e,agentId:t});if(!Object(b.a)().endpointPrivileges.canAccessResponseConsole)return null;const u="endpointResponseActions-action-button";return r.a.createElement(a.EuiToolTip,{position:"top",content:c},r.a.createElement(a.EuiButton,{fill:!0,key:u,"data-test-subj":u,disabled:s,onClick:n},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"})))}));y.displayName="ResponderActionButton";const h=(e,t)=>{const{loading:n,canAccessResponseConsole:a}=Object(b.a)().endpointPrivileges,{isAlert:c}=Object(s.a)(e),{handleResponseActionsClick:u,isDisabled:p,tooltip:m}=(({eventData:e=[],onClick:t})=>{const{isSupported:n,unsupportedReason:a,details:{agentType:r,agentId:o,platform:c,hostName:u}}=Object(s.a)(e),p="endpoint"===r,m=g(o,n&&p),f=Object(l.d)(),[b,y]=Object(i.useMemo)((()=>n?p?[m.isDisabled,m.tooltip]:[!1,void 0]:[!0,r&&a?a:d]),[n,p,r,a,m.isDisabled,m.tooltip]);return{handleResponseActionsClick:Object(i.useCallback)((()=>{b||(f({agentId:o,agentType:r,hostName:u,platform:c,capabilities:p?m.capabilities:[]}),t&&t())}),[b,f,o,r,u,c,p,m.capabilities,t]),isDisabled:b,tooltip:y}})({onClick:t,eventData:e});return Object(i.useMemo)((()=>{const e=[];return!n&&a&&c&&e.push({key:"endpointResponseActions-action-item","data-test-subj":"endpointResponseActions-action-item",disabled:p,toolTipContent:m,size:"s",onClick:u,name:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"})}),e}),[a,u,c,n,p,m])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));const a={isolate:{automated:{endpoint:!0,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!0,crowdstrike:!0}},unisolate:{automated:{endpoint:!1,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!0,crowdstrike:!0}},upload:{automated:{endpoint:!1,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!1,crowdstrike:!1}},"get-file":{automated:{endpoint:!1,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!0,crowdstrike:!1}},"kill-process":{automated:{endpoint:!0,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!1,crowdstrike:!1}},execute:{automated:{endpoint:!1,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!1,crowdstrike:!1}},"suspend-process":{automated:{endpoint:!0,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!1,crowdstrike:!1}},"running-processes":{automated:{endpoint:!1,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!1,crowdstrike:!1}},scan:{automated:{endpoint:!1,sentinel_one:!1,crowdstrike:!1},manual:{endpoint:!0,sentinel_one:!1,crowdstrike:!1}}};var i=n(24);const r=(e,t,n="manual")=>{const r=i.a.get(),o=r.responseActionsSentinelOneV1Enabled,s=r.responseActionsSentinelOneGetFileEnabled,l=r.responseActionsCrowdstrikeManualHostIsolationEnabled,c="endpoint"===e||"sentinel_one"===e&&o||"crowdstrike"===e&&l;let u=!t||((e,t,n)=>a[t][n][e])(e,t,n);return c&&u&&t&&"sentinel_one"===e&&"get-file"===t&&(s||(u=!1)),Boolean(c&&u)};var o=n(174);const s=Object.values(o.b),l=e=>s.includes(e);n(428),n(883)},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return S}));var a=n(19),i=n(2),r=n.n(i),o=n(44),s=n(128),l=n(191),c=n(180),u=n(119),d=n.n(u);const p=({rowIndex:e,colIndex:t,data:n,header:a,eventId:o,linkValues:s,renderCellValue:l,tabType:c,timelineId:u})=>{const[p,m]=Object(i.useState)({});return r.a.createElement("div",d()({"data-test-subj":"statefulCell"},p),l({columnId:a.id,eventId:o,data:n,header:a,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:s,rowIndex:e,colIndex:t,setCellProps:m,scopeId:u,key:null!=c?`${u}-${c}`:u}))};p.displayName="StatefulCellComponent";const m=r.a.memo(p);var f=n(4);const g=({column:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),b=e=>f.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),y=({notesCount:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),h=e=>{var t;const{altKey:n,ctrlKey:a,key:i,metaKey:r,shiftKey:o,target:l,type:u}=e,d=l;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(i)&&null!==(t=d.className)&&void 0!==t&&t.includes(c.b)){const t=d.querySelector(`.${s.a}`),l=new KeyboardEvent(u,{altKey:n,bubbles:!0,cancelable:!0,ctrlKey:a,key:i,metaKey:r,shiftKey:o});" "===i&&e.preventDefault(),null==t||t.dispatchEvent(l)}},v=({action:e,width:t,actionsColumnWidth:n,ariaRowindex:i,columnId:o,columnValues:s,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:v,eventId:E,loadingEventIds:x,notesCount:j,onEventDetailsPanelOpened:S,onRowSelected:O,refetch:k,rowIndex:w,hasRowRenderers:T,onRuleChange:I,selectedEventIds:M,showCheckboxes:C,showNotes:_,tabType:D,timelineId:A,toggleShowNotes:F,setEventsLoading:N,setEventsDeleted:P})=>{const R=t||n;return r.a.createElement(c.m,{width:R,"data-test-subj":"event-actions-container",tabIndex:0},r.a.createElement(c.k,{$ariaColumnIndex:m+l.b,key:null!=D?`${E}_${D}`:`${E}`,onKeyDown:h,role:"button",tabIndex:0,width:t},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,g({row:i,column:m+2}))),e&&r.a.createElement(e,{ariaRowindex:i,width:t,checked:Object.keys(M).includes(E),columnId:o,columnValues:s,eventId:E,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:v,loadingEventIds:x,onEventDetailsPanelOpened:S,onRowSelected:O,refetch:k,rowIndex:w,onRuleChange:I,showCheckboxes:C,showNotes:_,timelineId:A,toggleShowNotes:F,setEventsLoading:N,setEventsDeleted:P}))),T?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,b(i))):null,j?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:i,notesCount:j}))):null))},E=({_id:e,ariaRowindex:t,index:n,header:i,data:s,ecsData:u,hasRowRenderers:d,notesCount:p,renderCellValue:f,tabType:v,timelineId:E})=>{var x;const j=n+l.b;return r.a.createElement(c.k,{$ariaColumnIndex:j,key:null!=v?`${i.id}_${v}`:`${i.id}`,onKeyDown:h,role:"button",tabIndex:0,width:i.initialWidth},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,g({row:t,column:j}))),r.a.createElement(m,{rowIndex:t-1,colIndex:j-1,data:s,header:i,eventId:e,linkValues:Object(o.getOr)([],null!==(x=i.linkField)&&void 0!==x?x:"",u),renderCellValue:f,tabType:v,timelineId:E}))),d?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,b(t))):null,p?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:t,notesCount:p}))):null)},x=r.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:n,columnValues:a,data:o,ecsData:s,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,id:p,loadingEventIds:m,notesCount:f,onEventDetailsPanelOpened:g,onRowSelected:b,refetch:y,hasRowRenderers:h,onRuleChange:x,renderCellValue:j,selectedEventIds:S,showCheckboxes:O,showNotes:k,tabType:w,timelineId:T,toggleShowNotes:I,trailingControlColumns:M,leadingControlColumns:C,setEventsLoading:_,setEventsDeleted:D})=>{const A=Object(i.useMemo)((()=>M?M.map((e=>e.rowCellRender)):[]),[M]),F=Object(i.useMemo)((()=>C.length+n.length),[C,n]),N=Object(i.useMemo)((()=>A.map(((n,i)=>n&&r.a.createElement(v,{action:n,width:M[i].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(S).includes(p),columnId:M[i].id||"",columnValues:a,onRowSelected:b,"data-test-subj":"actions",eventId:p,data:o,key:i,index:F+i,rowIndex:e,ecsData:s,loadingEventIds:m,onEventDetailsPanelOpened:g,showCheckboxes:O,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,notesCount:f,refetch:y,hasRowRenderers:h,onRuleChange:x,selectedEventIds:S,showNotes:k,tabType:w,timelineId:T,toggleShowNotes:I,setEventsLoading:_,setEventsDeleted:D})))),[M,p,o,s,b,u,d,t,e,a,l,h,F,m,f,g,x,y,S,O,k,w,T,I,A,_,D]),P=Object(i.useMemo)((()=>n.map(((t,n)=>r.a.createElement(E,{_id:p,index:n,header:t,key:null!=w?`${t.id}_${w}`:`${t.id}`,ariaRowindex:e,data:o,ecsData:s,hasRowRenderers:h,notesCount:f,renderCellValue:j,tabType:w,timelineId:T})))),[p,e,n,o,s,h,f,j,w,T]);return r.a.createElement(c.n,{"data-test-subj":"data-driven-columns"},P,N)}));x.displayName="DataDrivenColumns";const j=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const n=e.find((e=>e.field===t));return null!=n&&null!=n.value?n.value:void 0},S=({data:e,fieldName:t})=>Object(i.useMemo)((()=>j({data:e,fieldName:t})),[e,t])},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var a=n(46);const i=a.keyof({linux:null,macos:null,windows:null}),r=(e=>{const t=a.array(e);return new a.Type("DefaultArray",t.is,((e,n)=>null==e?a.success([]):t.validate(e,n)),a.identity)})(i),o=a.union([r,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=new a.Type("DefaultStringArray",a.array(a.string).is,((e,t)=>null==e?a.success([]):a.array(a.string).validate(e,t)),a.identity);a.union([i,a[void 0]])},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(308),i=n(294);const r=async(e,t,n=!1)=>{var r,o;const s=await t.get(e,!0,n),l=s.toSpec(),c=Object(a.a)(s.getIndexPattern().split(",")),u=await t.getExistingIndices(c);return{loading:!1,id:null!==(r=l.id)&&void 0!==r?r:"",title:s.getIndexPattern(),indexFields:s.fields,fields:l.fields,patternList:u,dataView:l,browserFields:Object(i.a)(null!==(o=l.id)&&void 0!==o?o:"",l.fields).browserFields,runtimeMappings:l.runtimeFieldMap}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.indexFieldsSearch.errorSearchDescription",{defaultMessage:"An error has occurred creating the ad-hoc data view"}),r=a.i18n.translate("xpack.securitySolution.dataView.fetchFields.warning",{defaultMessage:"Failed to fetch detailed fields information"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(897);const r=()=>{const e=Object(a.useContext)(i.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(44);const l=o.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(r.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;&:focus-visible{pointer-events:auto;opacity:1;}}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(s.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),c=i.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):i.a.createElement(i.a.Fragment,null,n)));c.displayName="HoverVisibilityContainer"},function(e,t,n){"use strict";e.exports=n(709)},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"r",(function(){return y})),n.d(t,"u",(function(){return h})),n.d(t,"t",(function(){return v})),n.d(t,"v",(function(){return E})),n.d(t,"x",(function(){return x})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return S})),n.d(t,"w",(function(){return O})),n.d(t,"s",(function(){return k})),n.d(t,"m",(function(){return w})),n.d(t,"l",(function(){return T}));var a=n(4);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),r=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),o=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),s=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),c=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),u=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),y=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),h=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),v=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),E=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),x=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),j=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),S=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),O=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),k=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),w=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),T=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(19),o=n(41);const s=n.n(o)()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-osvxz7-0"})(["min-height:calc(100vh - 140px);"]),l=Object(a.memo)((({children:e,"data-test-subj":t})=>i.a.createElement(s,{justifyContent:"center",direction:"column","data-test-subj":t},i.a.createElement(r.EuiPageTemplate.Section,{grow:!1,alignment:"center"},i.a.createElement(r.EuiPanel,{color:"subdued"},e)))));l.displayName="ManagementEmptyStateWrapper"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(42),o=n(137);const s=({riskScoreEntity:e,title:t})=>i.a.createElement(i.a.Fragment,null,null!=t?t:e===o.t.user?i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.usersRiskDashboard.title",defaultMessage:"User Risk Scores"}):i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.hostsRiskDashboard.title",defaultMessage:"Host Risk Scores"})),l=i.a.memo(s);l.displayName="RiskScoreHeaderTitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return p}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.timeline.categoryTooltip",{defaultMessage:"Category"}),r=a.i18n.translate("xpack.securitySolution.timeline.descriptionTooltip",{defaultMessage:"Description"}),o=a.i18n.translate("xpack.securitySolution.timeline.fieldTooltip",{defaultMessage:"Field"}),s=a.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),l=a.i18n.translate("xpack.securitySolution.timeline.hideColumnLabel",{defaultMessage:"Hide column"}),c=a.i18n.translate("xpack.securitySolution.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),u=a.i18n.translate("xpack.securitySolution.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),d=a.i18n.translate("xpack.securitySolution.timeline.typeTooltip",{defaultMessage:"Type"}),p=a.i18n.translate("xpack.securitySolution.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var a=n(5);const i=20,r=[5,10,20,50,a.Dc],o="securitySolution.rulesTable"},function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"l",(function(){return c})),n.d(t,"r",(function(){return u})),n.d(t,"q",(function(){return d})),n.d(t,"v",(function(){return p})),n.d(t,"p",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"w",(function(){return b})),n.d(t,"D",(function(){return y})),n.d(t,"E",(function(){return h})),n.d(t,"z",(function(){return v})),n.d(t,"A",(function(){return E})),n.d(t,"y",(function(){return x})),n.d(t,"x",(function(){return j})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return k})),n.d(t,"k",(function(){return w})),n.d(t,"d",(function(){return T})),n.d(t,"e",(function(){return I})),n.d(t,"B",(function(){return M})),n.d(t,"C",(function(){return C})),n.d(t,"i",(function(){return _})),n.d(t,"j",(function(){return D})),n.d(t,"s",(function(){return A})),n.d(t,"t",(function(){return F})),n.d(t,"o",(function(){return N})),n.d(t,"m",(function(){return P})),n.d(t,"n",(function(){return R}));var a=n(2),i=n.n(a),r=n(4),o=n(42);const s=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),l=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),c=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryFieldRequiredError",{defaultMessage:"An ES|QL query is required."}),u=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),d=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),p=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),m=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),f=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),g=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),b=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.SavedQueryFormRowLabel",{defaultMessage:"Saved query"}),y=e=>r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabel",{defaultMessage:'Load saved query "{savedQueryName}" dynamically on each rule execution',values:{savedQueryName:e}}),h=()=>r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabelWithoutName",{defaultMessage:"Load saved query dynamically on each rule execution"}),v=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),E=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),x=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),j=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.source",{defaultMessage:"Source"}),S=(r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.title",{defaultMessage:"Select a data source"}),r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.subTitle",{defaultMessage:"Data sources"}),r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.content",{defaultMessage:"Rules can now query index patterns or data views."}),r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.rulePreviewTitle",{defaultMessage:"Rule Preview"}),r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})),O=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsSuppressLabel",{defaultMessage:"Suppress and group alerts for events with missing fields"}),k=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsDoNotSuppressLabel",{defaultMessage:"Do not suppress alerts for events with missing fields"}),w=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),T=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perRuleExecutionLabel",{defaultMessage:"Per rule execution"}),I=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perTimePeriodLabel",{defaultMessage:"Per time period"}),M=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.Su.perRuleExecutionWarning",{defaultMessage:"Per rule execution option is not available for Threshold rule type"}),C=e=>null!=e&&e.length?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionForFieldsLabel",defaultMessage:"Suppress alerts by selected fields: {fieldsString} (Technical Preview)",values:{fieldsString:i.a.createElement("strong",null,e.join(", "))}}):r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionLabel",{defaultMessage:"Suppress alerts (Technical Preview)"}),_=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlSequenceSuppressionDisableText",{defaultMessage:"Suppression is not supported for EQL sequence queries."}),D=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlSequenceSuppressionValidationText",{defaultMessage:"{EQL_SEQUENCE_SUPPRESSION_DISABLE_TOOLTIP} Change the EQL query to a non-sequence query, or remove the suppression fields.",values:{EQL_SEQUENCE_SUPPRESSION_DISABLE_TOOLTIP:_}}),A=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningSuppressionDisabledLabel",{defaultMessage:"To enable alert suppression, start relevant Machine Learning jobs."}),F=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningSuppressionIncompleteLabel",{defaultMessage:"This list of fields might be incomplete as some Machine Learning jobs are not running. Start all relevant jobs for a complete list."}),N=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsTechPreviewLabelAppend",{defaultMessage:"Optional (Technical Preview)"}),P=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsGALabelAppend",{defaultMessage:"Optional"}),R=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"})},,function(e,t,n){"use strict";n.d(t,"d",(function(){return a.q})),n.d(t,"c",(function(){return a.n})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"f",(function(){return j.a}));var a=n(159),i=n(123),r=n(47),o=n(727),s=n(5),l=n(383),c=n(588),u=n(437),d=n(442);const p=["PUT",s.qb];var m=n(449);const f=()=>{const{addError:e}=Object(i.a)();return(e=>{const t=Object(l.b)(),n=Object(u.b)(),i=Object(d.b)(),s=Object(c.c)();return Object(r.useMutation)((e=>Object(a.y)({rule:Object(o.b)(e)})),{...e,mutationKey:p,onSettled:(...a)=>{var r;t(),n(),i();const[o]=a;o&&s(o),null==e||null===(r=e.onSettled)||void 0===r||r.call(e,...a)}})})({onError:t=>{e(t,{title:m.a})}})},g=["POST",s.qb],b=()=>{const{addError:e}=Object(i.a)();return(e=>{const t=Object(l.b)(),n=Object(u.b)(),i=Object(d.b)();return Object(r.useMutation)((e=>Object(a.d)({rule:Object(o.b)(e)})),{...e,mutationKey:g,onSettled:(...a)=>{t(),n(),i(),null!=e&&e.onSettled&&e.onSettled(...a)}})})({onError:t=>{e(t,{title:m.a})}})};var y=n(120),h=n(273),v=n(232);const E=y.object({page:y.number().int().min(0),perPage:y.number().int().min(0),total:y.number().int().min(0)}),x=y.object({field:v.e,order:h.g});var j=n(828)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return y}));var a=n(2),i=n.n(a),r=n(19),o=n(41),s=n.n(o),l=n(118),c=n(235),u=n(573),d=n(4);const p=d.i18n.translate("xpack.securitySolution.noPermissionsTitle",{defaultMessage:"Privileges required"}),m=d.i18n.translate("xpack.securitySolution.noPrivilegesDefaultMessage",{defaultMessage:"To view this page, you must update privileges. For more information, contact your Kibana administrator."}),f=d.i18n.translate("xpack.securitySolution.goToDocumentationButton",{defaultMessage:"View documentation"}),g=s()(r.EuiFlexItem).withConfig({displayName:"SizedEuiFlexItem",componentId:"sc-156zz3c-0"})(["min-height:460px;font-size:1.1rem;"]),b=i.a.memo((({pageName:e,docLinkSelector:t})=>i.a.createElement(c.a,null,i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(g,null,i.a.createElement(r.EuiPageTemplate.EmptyPrompt,null,i.a.createElement(y,{pageName:e,docLinkSelector:t})))))));b.displayName="NoPrivilegePage";const y=i.a.memo((({pageName:e,docLinkSelector:t})=>{const{docLinks:n}=Object(l.j)().services,r=Object(a.useMemo)((()=>({feature:{icon:"documents",label:f,url:t(n.links),target:"_blank"}})),[t,n.links]),o=e?(e=>d.i18n.translate("xpack.securitySolution.noPrivilegesPerPageMessage",{values:{pageName:e},defaultMessage:"To view {pageName}, you must update privileges. For more information, contact your Kibana administrator."}))(e):m;return i.a.createElement(u.a,{actions:r,message:o,"data-test-subj":"noPrivilegesPage",title:p})}));y.displayName="NoPrivileges"},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(2),i=n(189),r=n(21);const o=e=>{const t=s();return Object(a.useMemo)((()=>t(e)),[t,e])},s=()=>{const e=Object(i.a)();return Object(a.useCallback)((t=>((e,t)=>Object(r.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return g})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return y})),n.d(t,"o",(function(){return h})),n.d(t,"p",(function(){return v})),n.d(t,"q",(function(){return E})),n.d(t,"r",(function(){return x})),n.d(t,"s",(function(){return j})),n.d(t,"u",(function(){return S})),n.d(t,"v",(function(){return O})),n.d(t,"x",(function(){return k})),n.d(t,"w",(function(){return w})),n.d(t,"z",(function(){return T})),n.d(t,"B",(function(){return I})),n.d(t,"y",(function(){return M})),n.d(t,"C",(function(){return C})),n.d(t,"D",(function(){return _})),n.d(t,"E",(function(){return D})),n.d(t,"F",(function(){return A})),n.d(t,"A",(function(){return F})),n.d(t,"t",(function(){return N}));var a=n(4);const i=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.addToNewCaseButton",{defaultMessage:"Add to new case"}),r=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.cancelButton",{defaultMessage:"Cancel"}),o=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.checkAllButton",{defaultMessage:"Check all"}),s=e=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.checkingLabel",{values:{index:e},defaultMessage:"Checking {index}"}),l=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.coldDescription",{defaultMessage:"The index is no longer being updated and is queried infrequently. The information still needs to be searchable, but it’s okay if those queries are slower."}),c=({indices:e,pattern:t})=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.coldPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} cold. Cold indices are no longer being updated and are queried infrequently. The information still needs to be searchable, but it’s okay if those queries are slower."}),u=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.toasts.copiedResultsToastTitle",{defaultMessage:"Copied results to the clipboard"}),d=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.copyToClipboardButton",{defaultMessage:"Copy to clipboard"}),p=e=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.dataQualityPromptContextPill",{values:{indexName:e},defaultMessage:"Data Quality ({indexName})"}),m=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.dataQualityPromptContextPillTooltip",{defaultMessage:"Add this Data Quality report as context"}),f=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.securitySolutionPackages.ecsDataQualityDashboardSubtitle",{defaultMessage:"Check index mappings and values for compatibility with the"}),g=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.dataQualitySuggestedUserPrompt",{defaultMessage:"Explain the results above, and describe some options to fix incompatibilities."}),b=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.securitySolutionPackages.ecsDataQualityDashboardTitle",{defaultMessage:"Data quality"}),y=(a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.defaultPanelTitle",{defaultMessage:"Check index mappings"}),a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.ecsVersionStat",{defaultMessage:"ECS version"}),e=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingIlmExplainLabel",{values:{details:e},defaultMessage:"Error loading ILM Explain: {details}"})),h=({details:e,patternOrIndexName:t})=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingMappingsLabel",{values:{details:e,patternOrIndexName:t},defaultMessage:"Error loading mappings for {patternOrIndexName}: {details}"}),v=e=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingStatsLabel",{values:{details:e},defaultMessage:"Error loading stats: {details}"}),E=({details:e,indexName:t})=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.errorLoadingUnallowedValuesLabel",{values:{details:e,indexName:t},defaultMessage:"Error loading unallowed values for index {indexName}: {details}"}),x=(a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.fieldsLabel",{defaultMessage:"Fields"}),a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.frozenDescription",{defaultMessage:"The index is no longer being updated and is queried rarely. The information still needs to be searchable, but it's okay if those queries are extremely slow."})),j=({indices:e,pattern:t})=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.frozenPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} frozen. Frozen indices are no longer being updated and are queried rarely. The information still needs to be searchable, but it's okay if those queries are extremely slow."}),S=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.hotDescription",{defaultMessage:"The index is actively being updated and queried"}),O=({indices:e,pattern:t})=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.hotPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} hot. Hot indices are actively being updated and queried."}),k=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.indexLifecycleManagementPhasesTooltip",{defaultMessage:"Indices with these Index Lifecycle Management (ILM) phases will be checked for data quality"}),w=(a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.indexNameLabel",{defaultMessage:"Index name"}),a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.ilmPhaseLabel",{defaultMessage:"ILM phase"})),T=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.lastCheckedLabel",{defaultMessage:"Last checked"}),I=(a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.emptyLoadingPrompt.loadingEcsMetadataPrompt",{defaultMessage:"Loading ECS metadata"}),a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.selectAnIndexPrompt",{defaultMessage:"Select an index to compare it against ECS version"}),a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.selectOneOrMorPhasesPlaceholder",{defaultMessage:"Select one or more ILM phases"})),M=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.indexSizeTooltip",{defaultMessage:"The size of the primary index (does not include replicas)"}),C=(a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.timestampDescriptionLabel",{defaultMessage:"Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events."}),a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.unmanagedDescription",{defaultMessage:"The index isn't managed by Index Lifecycle Management (ILM)"})),_=({indices:e,pattern:t})=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.unmanagedPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} unmanaged by Index Lifecycle Management (ILM)"}),D=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.warmDescription",{defaultMessage:"The index is no longer being updated but is still being queried"}),A=({indices:e,pattern:t})=>a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.warmPatternTooltip",{values:{indices:e,pattern:t},defaultMessage:"{indices} {indices, plural, =1 {index} other {indices}} matching the {pattern} pattern {indices, plural, =1 {is} other {are}} warm. Warm indices are no longer being updated but are still being queried."}),F=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.postResultErrorTitle",{defaultMessage:"Error writing saved data quality check results"}),N=a.i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.getResultErrorTitle",{defaultMessage:"Error reading saved data quality check results"})},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(47),i=n(118),r=n(277);function o({documentId:e,isActiveTimeline:t,indices:n}){const o=Object(i.i)(),{selectedPatterns:s}=Object(r.a)(t),l=[...new Set(s.concat(n))],{loading:c,id:u,schema:d,agentId:p}=function({documentId:e,indices:t}){const n=Object(i.i)(),r=Object(a.useQuery)(["getAlertPrevalenceSchema",e],(()=>n.get("/api/endpoint/resolver/entity",{query:{_id:e,indices:t}})));if(r.isLoading)return{loading:!0,error:!1,id:null,schema:null,agentId:null};if(r.data&&r.data.length>0){const{data:[{schema:e,id:t,agentId:n}]}=r;return{loading:!1,error:!1,id:t,schema:e,agentId:n}}return{loading:!1,error:!0,id:null,schema:null,agentId:null}}({documentId:e,indices:l}),m=Object(a.useQuery)(["getAlertPrevalenceFromProcessTree",u],(()=>o.post("/api/endpoint/resolver/tree",{body:JSON.stringify({schema:d,ancestors:200,descendants:500,indexPatterns:l,nodes:[u],includeHits:!0,agentId:p})})),{enabled:null!==d&&null!==u});return m.isLoading||c?{loading:!0,error:!1,alertIds:void 0,statsNodes:void 0}:m.data?{loading:!1,error:!1,alertIds:m.data.alertIds,statsNodes:m.data.statsNodes}:{loading:!1,error:!0,alertIds:void 0,statsNodes:void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(350);const i=e=>Object(a.a)(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(44),r=n(122);const o=e=>{const t=Object(r.a)("sentinelOneDataInAnalyzerEnabled"),n=Object(r.a)("crowdstrikeDataInAnalyzerEnabled"),o=Object(r.a)("jamfDataInAnalyzerEnabled");return Object(a.useMemo)((()=>{const a=[...t?["sentinel_one_cloud_funnel","sentinel_one"]:[],...n?["crowdstrike"]:[],...o?["jamf_protect"]:[]],r=Object(i.get)(["agent","type",0],e),s=Object(i.get)(["process","entity_id"],e),l=Object(i.get)(["process","entity_id",0],e),c=Object(i.get)(["event","module",0],e),u=Object(i.get)(["event","dataset"],e),d=Array.isArray(u)&&u.some((e=>e.includes("windows.sysmon"))),p="endpoint"===r,m="winlogbeat"===r&&"sysmon"===c,f="filebeat"===r&&a.includes(c),g=p||m||d||f,b=null!=s&&1===s.length&&""!==l;return g&&b}),[n,e,t,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(41),c=n.n(l),u=n(482),d=n(126);const p=c()(s.EuiContextMenuItem).withConfig({displayName:"StyledEuiContextMenuItem",componentId:"sc-t3r55d-0"})([".additional-info{display:none;max-width:50%;}&:hover{.additional-info{display:block !important;}}"]),m=c()("div").withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-t3r55d-1"})(["max-width:50%;padding-right:",";"],(e=>e.theme.eui.euiSizeS)),f=c()(s.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-t3r55d-2"})(["padding:",";line-height:",";"],(e=>e.theme.eui.euiSizeM),(e=>e.theme.eui.euiFontSizeM)),g=Object(r.memo)((({navigateAppId:e,navigateOptions:t,onClick:n,textTruncate:a,hoverInfo:l,children:c,isNavigationDisabled:g=!1,...b})=>{const y=Object(u.a)(null!=e?e:"",{...t,onClick:n}),h=Object(d.a)(b["data-test-subj"]),v=Object(r.useMemo)((()=>{const e="additional-info "+("object"!=typeof l?"eui-textTruncate":"");return l?o.a.createElement(m,{className:e},l):null}),[l]),E=a?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",i()({className:"eui-textTruncate","data-test-subj":h("truncateWrapper")},"string"==typeof c?{title:c}:{}),c),v):o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiFlexItem,null,c),v);return g?o.a.createElement(f,{size:"s",className:"eui-textTruncate","data-test-subj":b["data-test-subj"]},E):o.a.createElement(p,i()({},b,{onClick:e?y:n}),o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},E))}));g.displayName="EuiContextMenuItemNavByRouter"},function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(47),i=n(3),r=n(167),o=n(118),s=n(182),l=n(544),c=n(935);function u({onError:e,page:t,perPage:n}={page:1,perPage:s.c}){const i=Object(o.i)();return Object(a.useQuery)(["endpointSpecificPolicies",t,n],(()=>Object(c.a)(i,{query:{page:t,perPage:n,withAgentCount:!0}})),e?{onError:e}:void 0)}function d(e){const{data:t}=Object(o.j)().services;return Object(a.useQuery)(["endpointPackagePoliciesStatsStrategy"],(async()=>Object(i.firstValueFrom)(t.search.search({},{strategy:r.m}))),{select:e=>e.rawResponse,enabled:e})}function p({customQueryOptions:e}){const t=Object(o.i)();return Object(a.useQuery)(["endpointPackageVersion",e],(()=>Object(l.c)(t)),e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(67);const i="/api/fleet",r=`${i}/package_policies`,o=`${i}/agent_status`,s=(e,t,n)=>e.get(`${r}/${t}`,{...n,version:a.API_VERSIONS.public.v1}),l=(e,t,n)=>e.post(`${r}/_bulk_get`,{...n,version:a.API_VERSIONS.public.v1,body:JSON.stringify({ids:t,ignoreMissing:!0})}),c=(e,t,n,i={})=>e.put(`${r}/${t}`,{...i,version:a.API_VERSIONS.public.v1,body:JSON.stringify(n)}),u=(e,t,n={})=>e.get(o,{...n,version:a.API_VERSIONS.public.v1,query:{policyId:t}}),d=async e=>{const t=a.epmRouteService.getInfoPath("endpoint"),n=(await e.get(t,{version:a.API_VERSIONS.public.v1})).item;if(!n)throw new Error("Endpoint package was not found.");return n}},function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"l",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return b}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return ye}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(44),l=n(19),c=n(168),u=n(1334),d=n(1555),p=n(1561),m=n(4);const f=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.cancel",{defaultMessage:"Cancel"}),g=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.createRuleExceptionLabel",{defaultMessage:"Add rule exception"}),b=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.addEndpointException",{defaultMessage:"Add Endpoint Exception"}),y=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.title",{defaultMessage:"An error occured submitting exception"}),h=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.dismissButton",{defaultMessage:"Dismiss"}),v=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.message",{defaultMessage:"View toast for error details."}),E=m.i18n.translate("xpack.securitySolution.ruleExceptions.addException.success",{defaultMessage:"Rule exception added to shared exception list"}),x=m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception added"});var j=n(632),S=n(343),O=n(353);const k={initialItems:[],exceptionItems:[],exceptionItemMeta:{name:""},newComment:"",commentErrorExists:!1,itemConditionValidationErrorExists:!1,closeSingleAlert:!1,bulkCloseAlerts:!1,disableBulkClose:!1,bulkCloseIndex:void 0,selectedOs:void 0,exceptionListsToAddTo:[],addExceptionToRadioSelection:"add_to_rule",selectedRulesToAddTo:[],listType:u.a.RULE_DEFAULT,errorSubmitting:null,expireTime:void 0,expireErrorExists:!1,wildcardWarningExists:!1};var w=n(878),T=n(879),I=n(840),M=n(871);const C=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addExceptionToRuleOrList.addToListsLabel",{defaultMessage:"Add to rule or lists"});var _=n(42),D=n(868);const A=({possibleRules:e,isSingleRule:t,isBulkAction:n,selectedRadioOption:r,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(a.useMemo)((()=>n&&null!=e?{id:"add_to_rules",label:i.a.createElement(l.EuiText,{"data-test-subj":"addToRulesRadioOption"},i.a.createElement(_.FormattedMessage,{defaultMessage:"Add to [{numRules}] selected rules: {ruleNames}",id:"xpack.securitySolution.exceptions.common.addToRulesOptionLabel",values:{numRules:e.length,ruleNames:i.a.createElement("span",{style:{fontWeight:"bold"}},e.map((({name:e})=>e)).join(","))}})),checked:"add_to_rules"===r,"data-test-subj":"addToRulesOptionsRadio",onChange:()=>{s("add_to_rules"),o(e)}}:t&&null!=e?{id:"add_to_rule",label:i.a.createElement(l.EuiText,{"data-test-subj":"addToRuleRadioOption"},i.a.createElement(_.FormattedMessage,{defaultMessage:"Add to this rule: {ruleName}",id:"xpack.securitySolution.exceptions.common.addToRuleOptionLabel",values:{ruleName:i.a.createElement("span",{style:{fontWeight:"bold"}},e[0].name)}})),checked:"add_to_rule"===r,"data-test-subj":"addToRuleOptionsRadio",onChange:()=>{s("add_to_rule"),o(e)}}:{id:"select_rules_to_add_to",label:i.a.createElement(l.EuiText,{"data-test-subj":"selectRulesToAddToRadioOption"},i.a.createElement(_.FormattedMessage,{defaultMessage:"Add to rules",id:"xpack.securitySolution.exceptions.common.selectRulesOptionLabel"})),checked:"select_rules_to_add_to"===r,"data-test-subj":"selectRulesToAddToOptionRadio",onChange:()=>s("select_rules_to_add_to")}),[n,e,t,r,s,o]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiRadio,c),"select_rules_to_add_to"===r&&i.a.createElement(D.a,{onRuleSelectionChange:o,initiallySelectedRules:[]}))},F=i.a.memo(A);F.displayName="ExceptionsAddToRulesOptions";const N=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsOptionLabel",{defaultMessage:"Add to shared exception lists"}),P=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.gotToSharedExceptions",{defaultMessage:"Manage shared exception lists"}),R=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltip",{defaultMessage:"Shared exception list is a group of exceptions. Select this option if you’d like to add this exception to shared exception lists."}),L=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipAriaLabel",{defaultMessage:"Learn more about shared exception lists"}),z=e=>m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipTitle",{values:{rulesCount:e},defaultMessage:"Shared exception list is a group of exceptions shared across rules. {rulesCount, plural, =1 {This rule currently has no shared} other {These rules currently have no commonly shared}} exception lists attached. To create one, visit the Shared Exception Lists page."});var q=n(627);const B=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.addToListsDescription",{defaultMessage:"After you create the exception, it is added to the exception lists you select."}),$=(m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.viewListDetailActionLabel",{defaultMessage:"View list detail"}),m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.referencesFetchError",{defaultMessage:"Unable to load shared exception lists"}));var V=n(595);const U=e=>m.i18n.translate("xpack.securitySolution.rule_exceptions.addToListTable.linkListSwitch.ariaLabel",{values:{name:e},defaultMessage:'Link "{name}"'}),G=Object(a.memo)((({list:e,linkedList:t,onListLinkChange:n,dataTestSubj:r})=>{const o=Object(a.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(a.useCallback)((({target:{checked:a}})=>{const i=a?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof n&&n(i)}),[t,n,e]);return i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiSwitch,{"data-test-subj":r,onChange:s,checked:o,label:U(e.name),showLabel:!1}))}));G.displayName="LinkListSwitch";var H=n(354);const W=({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n})=>{const{error:r,isLoading:o,pagination:s,lists:c,listTableColumnsWithLinkSwitch:d,onTableChange:p,addToSelectedListDescription:m}=(({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n})=>{const[r,o]=Object(a.useState)([]),[s,l]=Object(a.useState)(!1),c=Object(a.useMemo)((()=>e?[]:t),[e,t]),[d,p]=Object(a.useState)([]),[m,f]=Object(a.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[g,b]=Object(a.useState)(void 0),y=Object(a.useCallback)((async()=>{try{return l(!0),Object(q.c)(c.length?c:[{namespace_type:"single"}])}catch(e){b($)}}),[c]),h=Object(a.useCallback)((async()=>{const e=await y();if(!e)return l(!1);const t=[];for(const n of Object.values(e))n.type===u.a.DETECTION&&t.push(n);o(t),l(!1)}),[y]);Object(a.useEffect)((()=>{h()}),[c,y,h]),Object(a.useEffect)((()=>{n(d.map((({referenced_rules:e,namespace_type:t,os_types:n,tags:a,...i})=>({...i,namespace_type:null!=t?t:"single",os_types:null!=n?n:[],tags:null!=a?a:[]}))))}),[d,n]);const v=Object(a.useMemo)((()=>[{field:"link",name:V.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>i.a.createElement(G,{dataTestSubj:"addToSharedListSwitch",list:t,linkedList:d,onListLinkChange:p})},...Object(H.d)()]),[d]),E=Object(a.useCallback)((({page:{index:e}})=>f({...m,pageIndex:e})),[m]);return{error:g,isLoading:s,pagination:m,lists:r,listTableColumnsWithLinkSwitch:v,addToSelectedListDescription:B,onTableChange:E}})({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n});return i.a.createElement(l.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiText,{size:"s"},m),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{sorting:!0,tableLayout:"auto",tableCaption:"Table of exception lists","data-test-subj":"addExceptionToSharedListsTable",error:r,items:c,loading:o,message:o?i.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,columns:d,pagination:s,onTableChange:p})))},Q=i.a.memo(W);Q.displayName="ExceptionsAddToListsTable";var Y=n(118);const K=({rulesCount:e,selectedRadioOption:t,sharedLists:n,onListsSelectionChange:r,onRadioChange:o})=>{const{navigateToApp:s}=Object(Y.j)().services.application,[c,u]=Object(a.useState)(!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiRadio,{id:"add_to_lists",label:i.a.createElement(l.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",responsive:!1,"data-test-subj":"addToListsRadioOptionLabel"},i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiText,null,N)),i.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":"addToListsOption"},i.a.createElement(l.EuiPopover,{button:i.a.createElement(l.EuiButtonIcon,{iconType:"iInCircle",onClick:()=>u(!c),"aria-label":L}),isOpen:c,closePopover:()=>u(!1),anchorPosition:"upCenter"},i.a.createElement("div",{style:{width:"300px"}},i.a.createElement(l.EuiText,{size:"s"},0===n.length?z(e):R)),i.a.createElement(l.EuiPopoverFooter,null,i.a.createElement(l.EuiButtonEmpty,{size:"s",iconType:"popout",iconSide:"right",onClick:()=>s("security",{openInNewTab:!0,path:"/exceptions"})},P))))),checked:"add_to_lists"===t,disabled:0===n.length&&e>0,onChange:()=>o("add_to_lists"),"data-test-subj":"addToListsRadioOption"}),"add_to_lists"===t&&(n.length>0||0===e)&&i.a.createElement(Q,{showAllSharedLists:0===e,sharedExceptionLists:n,onListSelectionChange:r,"data-test-subj":"exceptionsAddToListTable"}))},J=i.a.memo(K);J.displayName="ExceptionsAddToListsOptions";const Z=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-oec11w-0"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),X=({rules:e,isBulkAction:t,selectedRadioOption:n,onListSelectionChange:r,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(a.useMemo)((()=>null!=e&&1===e.length),[e]),d=Object(a.useMemo)((()=>{var t,n,a;if(null==e)return[];if(1===e.length)return null!==(t=null===(n=e[0].exceptions_list)||void 0===n?void 0:n.filter((e=>e.type===u.a.DETECTION)))&&void 0!==t?t:[];const i=null!==(a=null==e?void 0:e.map((e=>null!=e.exceptions_list?e.exceptions_list:[])))&&void 0!==a?a:[];i.sort(((e,t)=>e.length-t.length));const r=i.shift();return null!=r&&r.length?r.filter((e=>i.every((t=>t.some((({id:t})=>e.id===t)))))).filter((e=>e.type===u.a.DETECTION)):[]}),[e]),p=Object(a.useMemo)((()=>null!=e?e.length:0),[e]);return i.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemAddToRuleOrListSection"},i.a.createElement(Z,{size:"xs"},i.a.createElement("h3",null,C)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(F,{possibleRules:e,isSingleRule:c,isBulkAction:t,selectedRadioOption:n,onRuleSelectionChange:o,onRadioChange:s}),i.a.createElement(J,{rulesCount:p,selectedRadioOption:n,sharedLists:d,onListsSelectionChange:r,onRadioChange:s}))},ee=i.a.memo(X);ee.displayName="ExceptionsAddToRulesOrLists";var te=n(1447),ne=n(1328),ae=n(1556),ie=n(123),re=n(841),oe=n(159);var se=n(872);const le=["query","machine_learning","saved_query","threat_match"];var ce=n(588),ue=n(880),de=n(237),pe=n(487);const me=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-v0j9bz-0"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),fe=o()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-v0j9bz-1"})(["",""],(()=>Object(r.css)(["&.builder-section{overflow-y:scroll;}"]))),ge=o()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-v0j9bz-2"})(["",""],(({theme:e})=>Object(r.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),be=o()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-v0j9bz-3"})(["",""],(({theme:e})=>Object(r.css)(["padding:",";"],e.eui.euiSizeS))),ye=Object(a.memo)((function({rules:e,isBulkAction:t,isEndpointItem:n,alertData:r,showAlertCloseOptions:o,isAlertDataLoading:C,alertStatus:_,sharedListToAddTo:D,onCancel:A,onConfirm:F}){const{euiTheme:N}=Object(l.useEuiTheme)(),[P,R]=Object(a.useState)(!1),{isLoading:L,indexPatterns:z,getExtendedFields:q}=Object(I.a)(e),[B,$]=(()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(ie.a)(),[i,r]=(()=>{const[e,t]=Object(a.useState)(!1),n=Object(a.useRef)(null);return Object(a.useEffect)((()=>{const e=new AbortController;return n.current=async(n,a)=>{try{t(!0);const i=await Promise.all(a.map((async t=>Object(oe.a)({items:n,ruleId:t.id,signal:e.signal}))));return t(!1),i.flatMap((e=>e))}catch(e){throw t(!1),e}},()=>{t(!1),e.abort()}}),[]),[e,n.current]})(),[o,s]=Object(re.a)(),[l,c]=Object(a.useState)(!1),d=Object(a.useRef)(null),p=Object(a.useCallback)((e=>e.every((e=>te.a.is(e)))),[]),f=Object(a.useCallback)((e=>e.every((e=>ne.a.is(e)||ae.a.is(e)))),[]);return Object(a.useEffect)((()=>{const n=new AbortController;return d.current=async({itemsToAdd:n,listType:a,selectedRulesToAddTo:i,addToRules:o,addToSharedLists:l,sharedLists:d})=>{try{let t=[];if(c(!0),o&&null!=r&&a!==u.a.ENDPOINT&&p(n)){t=await r(n,i);const a=i.map((({name:e})=>e)).join(", ");e({title:x,text:(b=a,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessText",{values:{ruleName:b},defaultMessage:"Exception has been added to rules - {ruleName}."}))})}else if((a===u.a.ENDPOINT||l)&&null!=s&&f(n)){t=await s(n);const a=d.map((({name:e})=>e));e({title:E,text:(g=a.join(","),m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.closeAlerts.successDetails",{values:{listNames:g},defaultMessage:"Rule exception has been added to shared lists: {listNames}."}))})}return c(!1),t}catch(e){throw c(!1),t(e,{title:y}),e}var g,b},()=>{n.abort()}}),[e,t,n,r,s,p,f]),[l||o||i,d.current]})(),[V,U]=Object(se.a)(),G=Object(ce.b)(),W=Object(a.useMemo)((()=>null==e||1!==e.length||le.includes(e[0].type)),[e]),Q=Object(a.useMemo)((()=>t?"add_to_rules":1===(null==e?void 0:e.length)||void 0!==C?"add_to_rule":"select_rules_to_add_to"),[C,t,e]),Y=Object(a.useMemo)((()=>n?u.a.ENDPOINT:D?u.a.DETECTION:u.a.RULE_DEFAULT),[n,D]),[{exceptionItemMeta:{name:K},listType:J,selectedOs:Z,initialItems:X,exceptionItems:ye,disableBulkClose:he,bulkCloseAlerts:ve,closeSingleAlert:Ee,bulkCloseIndex:xe,addExceptionToRadioSelection:je,selectedRulesToAddTo:Se,exceptionListsToAddTo:Oe,newComment:ke,commentErrorExists:we,itemConditionValidationErrorExists:Te,errorSubmitting:Ie,expireTime:Me,expireErrorExists:Ce,wildcardWarningExists:_e},De]=Object(a.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:n}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[n[0]]:n[1]}}}case"setInitialExceptionItems":{const{items:n}=t;return{...e,initialItems:n}}case"setExceptionItems":{const{items:n}=t;return{...e,exceptionItems:n}}case"setConditionValidationErrorExists":{const{errorExists:n}=t;return{...e,itemConditionValidationErrorExists:n}}case"setWildcardWithWrongOperator":{const{warningExists:n}=t;return{...e,wildcardWarningExists:n}}case"setComment":{const{comment:n}=t;return{...e,newComment:n}}case"setCommentError":{const{errorExists:n}=t;return{...e,commentErrorExists:n}}case"setCloseSingleAlert":{const{close:n}=t;return{...e,closeSingleAlert:n}}case"setBulkCloseAlerts":{const{bulkClose:n}=t;return{...e,bulkCloseAlerts:n}}case"setBulkCloseIndex":{const{bulkCloseIndex:n}=t;return{...e,bulkCloseIndex:n}}case"setSelectedOsOptions":{const{selectedOs:n}=t;return{...e,selectedOs:n}}case"setAddExceptionToLists":{const{listsToAddTo:n}=t;return{...e,exceptionListsToAddTo:n}}case"setListOrRuleRadioOption":{const{option:n}=t;return{...e,addExceptionToRadioSelection:n,listType:"add_to_lists"===n?u.a.DETECTION:u.a.RULE_DEFAULT,selectedRulesToAddTo:"add_to_lists"===n?[]:e.selectedRulesToAddTo}}case"setSelectedRulesToAddTo":{const{rules:n}=t;return{...e,selectedRulesToAddTo:n}}case"setListType":{const{listType:n}=t;return{...e,listType:n}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:n}=t;return{...e,disableBulkClose:n}}case"setErrorSubmitting":{const{err:n}=t;return{...e,errorSubmitting:n}}case"setExpireTime":{const{expireTime:n}=t;return{...e,expireTime:n}}case"setExpireError":{const{errorExists:n}=t;return{...e,expireErrorExists:n}}default:return e}}),{...k,addExceptionToRadioSelection:Q,listType:Y,selectedRulesToAddTo:null!=e?e:[]}),Ae=Object(a.useMemo)((()=>null!=r),[r]),Fe=Object(a.useCallback)((e=>{De({type:"setInitialExceptionItems",items:e})}),[De]),Ne=Object(a.useCallback)((e=>{De({type:"setWildcardWithWrongOperator",warningExists:Object(d.g)(e)}),De({type:"setExceptionItems",items:e})}),[De]),Pe=Object(a.useCallback)((e=>{De({type:"setListOrRuleRadioOption",option:e})}),[De]),Re=Object(a.useCallback)((e=>{De({type:"setSelectedRulesToAddTo",rules:e})}),[De]),Le=Object(a.useCallback)((e=>{De({type:"setAddExceptionToLists",listsToAddTo:e})}),[De]),ze=Object(a.useCallback)((e=>{De({type:"setExceptionItemMeta",value:e})}),[De]),qe=Object(a.useCallback)((e=>{De({type:"setConditionValidationErrorExists",errorExists:e})}),[De]),Be=Object(a.useCallback)((e=>{De({type:"setSelectedOsOptions",selectedOs:e})}),[De]),$e=Object(a.useCallback)((e=>{De({type:"setComment",comment:e})}),[De]),Ve=Object(a.useCallback)((e=>{De({type:"setCommentError",errorExists:e})}),[De]),Ue=Object(a.useCallback)((e=>{De({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[De]),Ge=Object(a.useCallback)((e=>{De({type:"setCloseSingleAlert",close:e})}),[De]),He=Object(a.useCallback)((e=>{De({type:"setBulkCloseAlerts",bulkClose:e})}),[De]),We=Object(a.useCallback)((e=>{De({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[De]),Qe=Object(a.useCallback)((e=>{De({type:"setErrorSubmitting",err:e})}),[De]),Ye=Object(a.useCallback)((e=>{De({type:"setExpireTime",expireTime:e})}),[De]),Ke=Object(a.useCallback)((e=>{De({type:"setExpireError",errorExists:e})}),[De]);Object(a.useEffect)((()=>{if(r)switch(J){case u.a.ENDPOINT:return Fe(Object(S.b)(c.k,K,r));case u.a.RULE_DEFAULT:{var t,n,a;const o=Object(S.k)({alertData:r,exceptionItemName:K,ruleCustomHighlightedFields:null!==(t=null==e||null===(n=e[0])||void 0===n||null===(a=n.investigation_fields)||void 0===a?void 0:a.field_names)&&void 0!==t?t:[]});if(o)return $e((i=r._id,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionFromAlertComment",{values:{alertId:i},defaultMessage:"Exception conditions are pre-filled with relevant data from an alert with the alert id (_id): {alertId}."}))),Fe([o])}}var i}),[J,K,r,e,Fe,$e]);const Je=Object(a.useMemo)((()=>Ae?Object(S.n)(r):Z?[...Z]:[]),[Ae,r,Z]),Ze=Object(a.useCallback)((async()=>{if(null!=$)try{const t=["add_to_rule","add_to_rules","select_rules_to_add_to"].includes(je),n=!(null==D||!D.length)||"add_to_lists"===je&&!Object(s.isEmpty)(Oe),a=null!=D&&D.length?D:Oe,i=Object(H.b)({itemName:K,commentToAdd:ke,addToRules:t,addToSharedLists:n,sharedLists:a,listType:J,selectedOs:Je,expireTime:Me,items:ye}),o=await $({itemsToAdd:i,selectedRulesToAddTo:Se,listType:J,addToRules:t&&!Object(s.isEmpty)(Se),addToSharedLists:n,sharedLists:a}),l=Ee&&r?r._id:void 0,c=t?Se.map((({rule_id:e})=>e)):(null!=e?e:[]).map((({rule_id:e})=>e));null==U||Object(s.isEmpty)(c)||!ve&&!Ee||await U(c,o,l,xe),G(),F(!0,Ee,ve)}catch(e){Qe(e)}}),[D,$,je,K,ke,Oe,J,Je,ye,Se,Ee,r,e,U,ve,F,xe,Qe,G,Me]),Xe=Object(a.useCallback)((()=>{if(!_e)return Ze();R(!0)}),[_e,Ze]),et=Object(a.useMemo)((()=>B||V||null!=Ie||""===K.trim()||ye.every((e=>0===e.entries.length))||Te||we||Ce||"add_to_lists"===je&&Object(s.isEmpty)(Oe)||"select_rules_to_add_to"===je&&Object(s.isEmpty)(Se)&&J===u.a.RULE_DEFAULT),[B,V,Ie,K,ye,Te,je,Oe,Ce,Se,J,we]),tt=Object(a.useCallback)((()=>{Qe(null)}),[Qe]),nt=Object(a.useCallback)((()=>{A(!1)}),[A]),at=Object(a.useMemo)((()=>J===u.a.ENDPOINT?b:g),[J]),it=Object(l.useGeneratedHtmlId)({prefix:"exceptionFlyoutTitle"}),rt=Object(a.useMemo)((()=>{const{title:e,body:t,confirmButton:n,cancelButton:a}=Object(de.a)(J===u.a.ENDPOINT?O.c:O.j);return i.a.createElement(pe.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:Ze,onCancel:()=>R(!1),"data-test-subj":"artifactConfirmModal"})}),[J,Ze]);return i.a.createElement(l.EuiFlyout,{size:"l",onClose:nt,"data-test-subj":"addExceptionFlyout","aria-labelledby":it,maskProps:{style:`z-index: ${N.levels.flyout+3}`}},i.a.createElement(ge,null,i.a.createElement(l.EuiTitle,null,i.a.createElement("h2",{id:it,"data-test-subj":"exceptionFlyoutTitle"},at)),i.a.createElement(l.EuiSpacer,{size:"m"})),i.a.createElement(fe,{className:"builder-section"},L&&i.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingAddExceptionFlyout",lines:4}),null!=Ie&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiCallOut,{"data-test-subj":"addExceptionErrorCallOut",title:y,color:"danger",iconType:"warning"},i.a.createElement(l.EuiText,null,v),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionErrorDismissButton",color:"danger",onClick:tt},h)),i.a.createElement(l.EuiSpacer,{size:"s"})),i.a.createElement(w.a,{exceptionItemName:K,onChange:ze}),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(T.a,{exceptionItemName:K,allowLargeValueLists:W,exceptionListItems:X,exceptionListType:J,indexPatterns:z,rules:e,selectedOs:Z,showOsTypeOptions:J===u.a.ENDPOINT&&!Ae,isEdit:!1,onOsChange:Be,onExceptionItemAdd:Ne,onSetErrorExists:qe,getExtendedFields:q}),_e&&i.a.createElement(p.a,null),J!==u.a.ENDPOINT&&!(null!=D&&D.length)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(ee,{rules:e,isBulkAction:t,selectedRadioOption:je,onListSelectionChange:Le,onRuleSelectionChange:Re,onRadioChange:Pe})),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(j.a,{accordionTitle:i.a.createElement(me,{size:"xs"},i.a.createElement("h3",null,(ot=ke?1:0,m.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.commentsTitle",{values:{comments:ot},defaultMessage:"Add comments ({comments})"})))),initialIsOpen:!!ke,newCommentValue:ke,newCommentOnChange:$e,setCommentError:Ve}),J!==u.a.ENDPOINT&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(ue.a,{expireTime:Me,setExpireTime:Ye,setExpireError:Ke})),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(M.a,{exceptionListType:J,shouldCloseSingleAlert:Ee,shouldBulkCloseAlert:ve,disableBulkClose:he,exceptionListItems:ye,alertData:r,alertStatus:_,isAlertDataLoading:null!=C&&C,onDisableBulkClose:We,onUpdateBulkCloseIndex:Ue,onBulkCloseCheckboxChange:He,onSingleAlertCloseCheckboxChange:Ge}))),i.a.createElement(l.EuiFlyoutFooter,null,i.a.createElement(be,{justifyContent:"spaceBetween"},i.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:nt},f),i.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionConfirmButton",onClick:Xe,isDisabled:et,fill:!0},at))),P&&rt);var ot}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return Se}));var a=n(19),i=n(2),r=n.n(i),o=n(1107),s=n(122),l=n(152),c=n(47),u=n(204),d=n(1532),p=n(1307);const m=Object(d.a)(u.o),f="FIND_LIST_ITEMS",g=()=>{const e=Object(c.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries([f],{refetchType:"active"})}),[e])},b=Object(d.a)(u.s);var y=n(49),h=n(151),v=n(118),E=n(1308);const x=Object(d.a)(u.c),j=["POST","LIST_ITEM_CREATE"];var S=n(123),O=n(242),k=n(4);const w=k.i18n.translate("xpack.securitySolution.listItems.addListItem",{defaultMessage:"Create list item"}),T=k.i18n.translate("xpack.securitySolution.listItems.successfullyAddedItem",{defaultMessage:"Successfully added list item"}),I=k.i18n.translate("xpack.securitySolution.listItems.valueRequired",{defaultMessage:"Value is required"}),M=k.i18n.translate("xpack.securitySolution.listItems.valueLabel",{defaultMessage:"Enter a new value for the list"}),C=k.i18n.translate("xpack.securitySolution.listItems.addListItemButton",{defaultMessage:"Add list item"}),_=k.i18n.translate("xpack.securitySolution.listItems.addingListItemButton",{defaultMessage:"Adding..."}),D=k.i18n.translate("xpack.securitySolution.listItems.successfullyDeletedItem",{defaultMessage:"Successfully deleted list item"}),A=k.i18n.translate("xpack.securitySolution.listItems.editTextInlineLabel",{defaultMessage:"Edit text inline"}),F=k.i18n.translate("xpack.securitySolution.listItems.successfullyUpdatedListItem",{defaultMessage:"Successfully updated list item"}),N=k.i18n.translate("xpack.securitySolution.listItems.columnValue",{defaultMessage:"Value"}),P=k.i18n.translate("xpack.securitySolution.listItems.columnUpdatedAt",{defaultMessage:"Updated at"}),R=k.i18n.translate("xpack.securitySolution.listItems.columnUpdatedBy",{defaultMessage:"Updated by"}),L=k.i18n.translate("xpack.securitySolution.listItems.columnActions",{defaultMessage:"Action"}),z=k.i18n.translate("xpack.securitySolution.listItems.failedToFetchListItem",{defaultMessage:"Failed to load list items. You can change the search query or contact your administrator"}),q=k.i18n.translate("xpack.securitySolution.listItems.deleteListItem",{defaultMessage:"Delete"}),B=k.i18n.translate("xpack.securitySolution.listItems.deleteListItemDescription",{defaultMessage:"Delete list item"}),$=k.i18n.translate("xpack.securitySolution.listItems.successfullyUploadListItems",{defaultMessage:"Successfully uploaded list items"}),V=k.i18n.translate("xpack.securitySolution.listItems.failedToUploadListItem",{defaultMessage:"Failed to upload list items"}),U=k.i18n.translate("xpack.securitySolution.listItems.failedToUploadListItemTitle",{defaultMessage:"Error"}),G=k.i18n.translate("xpack.securitySolution.listItems.uploadTooltip",{defaultMessage:"All items from the file will be added to the value list."}),H=k.i18n.translate("xpack.securitySolution.listItems.uploadFilePickerInitialPromptText",{defaultMessage:"Select or drag and drop a file"}),W=k.i18n.translate("xpack.securitySolution.listItems.uploadListItem",{defaultMessage:"Upload"}),Q=k.i18n.translate("xpack.securitySolution.listItems.infoType",{defaultMessage:"Type:"}),Y=k.i18n.translate("xpack.securitySolution.listItems.infoUpdatedAt",{defaultMessage:"Updated at:"}),K=k.i18n.translate("xpack.securitySolution.listItems.infoUpdatedBy",{defaultMessage:"Updated by:"}),J=k.i18n.translate("xpack.securitySolution.listItems.infoTotalItems",{defaultMessage:"Total items:"}),Z=k.i18n.translate("xpack.securitySolution.listItems.notFoundItems",{defaultMessage:"0 list items match your search criteria."});var X=n(17);const ee=({listId:e})=>{const[t,n]=Object(i.useState)(!1),{addSuccess:o,addError:s}=Object(S.a)(),l=Object(O.c)().services.http,u=(e=>{const t=g();return Object(c.useMutation)((({listId:e,value:t,http:n})=>x({listId:e,value:t,http:n,refresh:"true"})),{...e,mutationKey:j,onSettled:(...n)=>{t(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onSuccess:()=>{o(T)},onError:e=>{var t,n;s(e,{title:e.message,toastMessage:null!==(t=null==e||null===(n=e.body)||void 0===n?void 0:n.message)&&void 0!==t?t:e.message})}}),d=Object(E.useFormik)({initialValues:{value:""},validate:e=>{if(""===e.value.trim())return{value:I}},onSubmit:async t=>{Object(X.h)(X.a.COUNT,X.c.CREATE_VALUE_LIST_ITEM),await u.mutateAsync({listId:e,value:t.value,http:l}),n(!1),d.resetForm()}});return r.a.createElement(a.EuiPopover,{initialFocus:"#value-list-item-value",button:r.a.createElement(a.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"value-list-item-add-button-show-popover",onClick:()=>n(!0)},w),isOpen:t,closePopover:()=>n(!1)},r.a.createElement("div",{style:{width:500}},r.a.createElement(a.EuiForm,{onSubmit:d.handleSubmit,component:"form"},r.a.createElement(a.EuiFlexGroup,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFormRow,{label:M,id:"value-list-item-value",isInvalid:!!d.errors.value,error:[d.errors.value]},r.a.createElement(a.EuiFieldText,{autoComplete:"off",onChange:d.handleChange,value:d.values.value,name:"value",icon:"listAdd","data-test-subj":"value-list-item-add-input",isInvalid:!!d.errors.value}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFormRow,{hasEmptyLabelSpace:!0},r.a.createElement(a.EuiButton,{"data-test-subj":"value-list-item-add-button-submit",isLoading:u.isLoading,type:"submit"},u.isLoading?_:C)))))))};var te=n(1557);const ne=["text/csv","text/plain"],ae={toastLifeTimeMs:5e3},ie=l.css`
  min-width: 300px;
`,re=({listId:e,type:t})=>{const[n,o]=Object(i.useState)(null),{http:s}=Object(v.j)().services,l=Object(i.useRef)(new AbortController),{start:c,...u}=Object(te.a)(),d=g(),{addSuccess:p,addError:m}=Object(S.a)(),f=Object(i.useCallback)((e=>{var t;o(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),b=Object(i.useCallback)((()=>{!u.loading&&n&&(l.current=new AbortController,Object(X.h)(X.a.COUNT,X.c.ADDITIONAL_UPLOAD_VALUE_LIST_ITEM),c({file:n,listId:e,http:s,signal:l.current.signal,type:t,refresh:"true"}))}),[u.loading,n,c,s,t,e]),y=!n||ne.some((e=>n.type===e));Object(i.useEffect)((()=>{!u.loading&&u.result?p($,ae):!u.loading&&u.error&&m(V,{title:U,...ae}),d()}),[u.error,u.loading,u.result,p,m,d]);const h=null==n||!y||u.loading;return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiToolTip,{position:"bottom",content:G},r.a.createElement(a.EuiFilePicker,{className:ie,accept:ne.join(),id:"value-list-item-upload",initialPromptText:H,onChange:f,display:"default",isLoading:u.loading,isInvalid:!y,"data-test-subj":"value-list-items-file-picker"})),r.a.createElement(a.EuiButton,{onClick:b,disabled:h,"data-test-subj":"value-list-items-upload"},W))},oe=Object(d.a)(u.u),se=["PATCH","LIST_ITEM_MUTATION"],le={toastLifeTimeMs:5e3},ce=({listItem:e})=>{const[t,n]=Object(i.useState)(e.value),{addSuccess:o,addError:s}=Object(S.a)(),l=Object(O.c)().services.http,u=(e=>{const t=g();return Object(c.useMutation)((({id:e,value:t,_version:n,http:a})=>oe({id:e,value:t,http:a,refresh:"true",_version:n})),{...e,mutationKey:se,onSettled:(...n)=>{t(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onSuccess:()=>{o(F,le)},onError:e=>{var t,n;s(e,{title:e.message,toastMessage:null!==(t=null==e||null===(n=e.body)||void 0===n?void 0:n.message)&&void 0!==t?t:e.message})}}),d=Object(i.useCallback)((e=>{n(e.target.value)}),[]),p=Object(i.useCallback)((()=>{n(e.value)}),[e]),m=Object(i.useCallback)((async t=>(Object(X.h)(X.a.COUNT,X.c.EDIT_VALUE_LIST_ITEM),await u.mutateAsync({id:e.id,value:t,_version:e._version,http:l}),!0)),[e._version,e.id,u,l]);return r.a.createElement(a.EuiInlineEditText,{"data-test-subj":`value-list-item-update-${e.value}`,size:"s",inputAriaLabel:A,value:t,onChange:d,onSave:m,onCancel:p,isLoading:u.isLoading})},ue=Object(d.a)(u.g),de=["POST"," DELETE_LIST_ITEM_MUTATION"],pe={toastLifeTimeMs:5e3},me=({id:e,value:t})=>{const{addSuccess:n,addError:o}=Object(S.a)(),s=Object(v.j)().services.http,l=(e=>{const t=g();return Object(c.useMutation)((({id:e,http:t})=>ue({id:e,http:t,refresh:"true"})),{...e,mutationKey:de,onSettled:(...n)=>{t(),null!=e&&e.onSettled&&e.onSettled(...n)}})})({onSuccess:()=>{n(D,pe)},onError:e=>{var t,n;o(e,{title:e.message,toastMessage:null!==(t=null==e||null===(n=e.body)||void 0===n?void 0:n.message)&&void 0!==t?t:e.message})}}),u=Object(i.useCallback)((()=>{Object(X.h)(X.a.COUNT,X.c.DELETE_VALUE_LIST_ITEM),l.mutate({id:e,http:s})}),[l,e,s]);return r.a.createElement(a.EuiButtonIcon,{color:"danger",onClick:u,iconType:"trash",isLoading:l.isLoading,"data-test-subj":`delete-list-item-${t}`})};let fe=function(e){return e.value="value",e.updatedAt="updated_at",e.updatedBy="updated_by",e}({});const ge=({canWriteIndex:e,items:t,pagination:n,sorting:i,loading:o,onChange:s,isError:l,list:c})=>{const u=[{field:fe.value,name:N,render:(t,n)=>e?r.a.createElement(ce,{listItem:n,key:t}):t,sortable:"text"!==c.type},{field:fe.updatedAt,name:P,render:e=>r.a.createElement(h.a,{value:e,fieldName:fe.updatedAt}),width:"25%",sortable:!0},{field:fe.updatedBy,name:R,width:"15%"}];return e&&u.push({name:L,actions:[{name:q,description:B,isPrimary:!0,render:e=>r.a.createElement(me,{id:e.id,value:e.value})}],width:"10%"}),r.a.createElement(a.EuiBasicTable,{"data-test-subj":"value-list-items-modal-table",items:t,columns:u,pagination:n,sorting:i,error:l?z:void 0,loading:o,onChange:s,noItemsMessage:Z})},be=l.css`
  margin-right: ${y.euiThemeVars.euiSizeS};
`,ye=l.css`
  margin-right: ${y.euiThemeVars.euiSizeXS};
`,he=({label:e,value:t})=>r.a.createElement(a.EuiText,{size:"xs",className:be},r.a.createElement("b",{className:ye},e," ")," ",t),ve=l.css`
  overflow: hidden;
  padding: ${y.euiThemeVars.euiSize};
`,Ee=l.css`
  min-height: 90vh;
  margin-top: 5vh;
  max-width: 1400px;
  min-width: 700px;
`,xe=l.css`
  overflow: scroll;
`,je=({listId:e,onCloseModal:t,canWriteIndex:n})=>{var o,s,l,u;const[d,g]=Object(i.useState)(""),y=Object(v.j)().services.http,[E,x]=Object(i.useState)(0),[j,S]=Object(i.useState)(10),[O,w]=Object(i.useState)("updated_at"),[T,I]=Object(i.useState)("desc"),{data:M,isLoading:C,isError:_}=(({pageIndex:e,pageSize:t,sortField:n,sortOrder:a,listId:i,filter:r,http:o})=>{const[s,l]=Object(p.a)({pageIndex:e,pageSize:t});return Object(c.useQuery)([f,e,t,n,a,i,r],(async({signal:l})=>await m({http:o,signal:l,pageIndex:e,pageSize:t,sortField:n,sortOrder:a,listId:i,cursor:s,filter:r})),{keepPreviousData:!0,refetchOnWindowFocus:!1,retry:!1,onSuccess:e=>{null!=e&&e.cursor&&l(null==e?void 0:e.cursor)}})})({listId:e,pageIndex:E+1,pageSize:j,sortField:O,sortOrder:T,filter:d,http:y}),{data:D,isLoading:A}=(({http:e,id:t})=>Object(c.useQuery)(["GET_LIST_BY_ID",t],(async({signal:n})=>await b({http:e,signal:n,id:t})),{refetchOnWindowFocus:!1}))({http:y,id:e}),F={sort:{field:O,direction:T},enableAllColumns:!1},N={pageIndex:E,pageSize:j,totalItemCount:null!==(o=null==M?void 0:M.total)&&void 0!==o?o:0,pageSizeOptions:[5,10,25]},P=Object(i.useCallback)((e=>{g(e.queryText)}),[]),R=!A&&!!D;return r.a.createElement(a.EuiModal,{maxWidth:!1,className:Ee,onClose:t},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiModalHeader,null,R&&r.a.createElement(a.EuiFlexGroup,{justifyContent:"spaceBetween",wrap:!0},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiModalHeaderTitle,{"data-test-subj":"value-list-items-modal-title"},D.id),r.a.createElement(a.EuiSpacer,{size:"s"}),D.description&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,{size:"s"},D.description),r.a.createElement(a.EuiSpacer,{size:"xs"})),r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"value-list-items-modal-info",justifyContent:"flexStart"},r.a.createElement(he,{label:Q,value:D.type}),r.a.createElement(he,{label:Y,value:r.a.createElement(h.a,{value:D.updated_at,fieldName:"updated_at"})}),r.a.createElement(he,{label:K,value:D.updated_by}),M&&r.a.createElement(he,{label:J,value:null!==(s=null==M?void 0:M.total)&&void 0!==s?s:"-"}))),r.a.createElement(a.EuiFlexItem,{grow:!0},n&&r.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart",justifyContent:"flexEnd"},r.a.createElement(ee,{listId:e}),r.a.createElement(re,{listId:e,type:D.type}))))),r.a.createElement(a.EuiFlexGroup,{className:ve,direction:"column"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiSearchBar,{onChange:P,"data-test-subj":"value-list-items-modal-search-bar",box:{"data-test-subj":"value-list-items-modal-search-bar-input",placeholder:(L=null!==(l=null==D?void 0:D.type)&&void 0!==l?l:"",k.i18n.translate("xpack.securitySolution.listItems.searchBar",{defaultMessage:"Filter your data using KQL syntax, for example: {listType}:*",values:{listType:L}}))}})),r.a.createElement(a.EuiFlexItem,{grow:!0,className:xe},R?r.a.createElement(ge,{items:null!==(u=null==M?void 0:M.data)&&void 0!==u?u:[],pagination:N,sorting:F,loading:C,onChange:({page:e,sort:t})=>{e&&(x(e.index),S(e.size)),t&&(w(t.field),I(t.direction))},isError:_,canWriteIndex:n,list:D}):r.a.createElement(a.EuiLoadingSpinner,{size:"xxl"})))));var L},Se=({listId:e,children:t,shouldShowContentIfModalNotAvailable:n})=>{const[l,c]=Object(i.useState)(!1),{canWriteIndex:u,canReadIndex:d,loading:p}=Object(o.a)(),m=Object(s.a)("valueListItemsModalEnabled"),f=Object(i.useCallback)((()=>c(!1)),[]),g=Object(i.useCallback)((()=>{Object(X.h)(X.a.CLICK,X.c.OPEN_VALUE_LIST_MODAL),c(!0)}),[]);return p?null:d&&m?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiLink,{"data-test-subj":`show-value-list-modal-${e}`,onClick:g},t),l&&r.a.createElement(je,{canWriteIndex:null!=u&&u,onCloseModal:f,listId:e})):n?r.a.createElement(r.a.Fragment,null,t):null}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"c",(function(){return I}));var a=n(2),i=n(44),r=n(813),o=n(748);let s=function(e){return e.MALICIOUS_FILE="malicious_file",e.RANSOMWARE="ransomware",e.MEMORY_SIGNATURE="memory_signature",e.SHELLCODE_THREAD="shellcode_thread",e.BEHAVIOR="behavior",e}({}),l=function(e){return e.PROCESS="process",e.FILE="file",e.NETWORK="network",e.REGISTRY="registry",e.MALWARE="malware",e}({});var c=n(174),u=n(503),d=n(332),p=n(197),m=n(172),f=n(572),g=n(229),b=n(284);const y=`${f.j}.terms.field`,h=`${f.j}.terms.value`,v=`${f.j}.cardinality.field`,E=`${f.j}.cardinality.value`,x=`${f.j}.count`,j=[{id:"host.name"},{id:"agent.id",overrideField:g.a,label:p.b},{id:c.b.sentinel_one,overrideField:g.a,label:p.b},{id:c.b.crowdstrike,overrideField:g.a,label:p.b},{id:"user.name"},{id:"rule.name"},{id:"cloud.provider"},{id:"cloud.region"},{id:"cloud.provider"},{id:"cloud.region"},{id:"orchestrator.cluster.id"},{id:"orchestrator.cluster.name"},{id:"container.image.name"},{id:"container.image.tag"},{id:"orchestrator.namespace"},{id:"orchestrator.resource.parent.type"},{id:"orchestrator.resource.type"},{id:"process.executable"},{id:"file.path"},{id:r.o,label:p.z}];function S({primaryEventCategory:e,allEventCategories:t}){switch(e){case l.PROCESS:return[{id:"process.name"},{id:"process.parent.name"},{id:"process.args"}];case l.FILE:return[{id:"file.name"},{id:"file.hash.sha256"},{id:"file.directory"},{id:"process.name"}];case l.NETWORK:return[{id:"destination.address"},{id:"destination.port"},{id:"source.address"},{id:"source.port"},{id:"dns.question.name"},{id:"process.name"}];case l.REGISTRY:return[{id:"registry.key"},{id:"registry.value"},{id:"process.name"}];case l.MALWARE:return S({primaryEventCategory:l.FILE,allEventCategories:t});default:let e=[];return null!=t&&t.includes(l.FILE)&&(e=e.concat(S({primaryEventCategory:l.FILE}))),null!=t&&t.includes(l.PROCESS)&&(e=e.concat(S({primaryEventCategory:l.PROCESS}))),e}}function O(e,t){switch(e){case s.BEHAVIOR:return[{id:"rule.description",label:m.u},...S({...t,primaryEventCategory:void 0})];case s.SHELLCODE_THREAD:return[{id:"Target.process.executable"},{id:"Memory_protection.unique_key_v1"}];case s.RANSOMWARE:return[{id:"Ransomware.feature"},{id:"process.hash.sha256"},...S({...t,primaryEventCategory:void 0})];case s.MEMORY_SIGNATURE:return S({...t,primaryEventCategory:void 0});case s.MALICIOUS_FILE:return[{id:"file.Ext.quarantine_path",overrideField:g.j,label:p.x}];default:return[]}}function k(e){switch(e){case"threshold":return[{id:x,label:m.y},{id:y,overrideField:h,label:m.z},{id:v,label:m.x}];case"machine_learning":return[{id:`${o.t}.machine_learning_job_id`,legacyId:"signal.rule.machine_learning_job_id"},{id:`${o.t}.anomaly_threshold`,legacyId:"signal.rule.anomaly_threshold"}];case"threat_match":return[{id:`${o.t}.threat_index`,legacyId:"signal.rule.threat_index"},{id:`${o.t}.threat_query`,legacyId:"signal.rule.threat_query"}];case"new_terms":return[{id:f.e,label:m.q},{id:f.d,label:m.p}];default:return[]}}function w({eventCategories:e,eventCode:t,eventRuleType:n,highlightedFieldsOverride:a}){const r=[...(o=a,o.map((e=>({id:e})))),...j,...S(e),...O(t,e),...k(n)];var o;return Object(i.uniqBy)("id",r)}function T(e){const t=Object(i.find)({category:"event",field:"event.category"},e);let n,a;return Array.isArray(null==t?void 0:t.originalValue)?(n=null==t?void 0:t.originalValue[0],a=null==t?void 0:t.originalValue):(n=null==t?void 0:t.originalValue,n&&(a=[n])),{primaryEventCategory:n,allEventCategories:a}}const I=({data:e,browserFields:t,scopeId:n,eventId:o,isDraggable:s=!1,isReadOnly:l=!1,investigationFields:c})=>{const p=Object(d.a)(e);return Object(a.useMemo)((()=>{var a,d;const f=T(e),g=Object(i.find)({category:"event",field:"event.code"},e),x=Array.isArray(null==g?void 0:g.originalValue)?null==g||null===(a=g.originalValue)||void 0===a?void 0:a[0]:null==g?void 0:g.originalValue,S=Object(i.find)({category:"kibana",field:r.o},e),O=w({eventCategories:f,eventCode:x,eventRuleType:Array.isArray(null==S?void 0:S.originalValue)?null==S||null===(d=S.originalValue)||void 0===d?void 0:d[0]:null==S?void 0:S.originalValue,highlightedFieldsOverride:null!=c?c:[]});return null!=e?O.reduce(((a,r)=>{var c;const d=e.find((e=>e.field===r.id||r.legacyId&&e.field===r.legacyId));if(!d||Object(i.isEmpty)(d.values))return a;d.field===r.legacyId&&(r.id=r.legacyId);const f=null!=r.linkField&&e.find((e=>e.field===r.linkField)),g={...Object(b.b)({item:d,linkValueField:f||void 0,contextId:n,scopeId:n,browserFields:t,eventId:o,field:r}),isDraggable:s,isReadOnly:l};if(Object(u.b)(r.id)&&p.isSupported&&p.details.agentIdField!==r.id)return a;if(r.id===y){const t=function({values:e},t,n){const a=t.find((e=>e.field===h)),i=a&&a.values;if(Array.isArray(e)&&e.length>0&&Array.isArray(i)&&e.length===i.length)return e.map(((e,t)=>({title:e,description:{...n,values:[i[t]]}}))).filter((e=>!j.map((e=>e.id)).includes(e.title)))}(d,e,g);return t?[...a,...t]:a}if(r.id===v){const t=function({values:e},t,n){const a=t.find((e=>e.field===E)),i=a&&a.values;if(Array.isArray(e)&&1===e.length&&Array.isArray(i)&&e.length===i.length)return{title:m.x,description:{...n,values:[`count(${e[0]}) >= ${i[0]}`]}}}(d,e,g);return t?[...a,t]:a}return[...a,{title:null!==(c=r.label)&&void 0!==c?c:r.id,description:g}]}),[]):[]}),[e,c,n,t,o,s,l,p.details.agentIdField,p.isSupported])}},,,,function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(48),o=n(45),s=n(149),l=n(129);const c=Object(a.memo)((({children:e})=>{const t=Object(r.useLocation)(),n=Object(o.useDispatch)();return Object(a.useEffect)((()=>{n(l.a.showTimeline({id:s.f.active,show:!1}))}),[n,t.pathname]),Object(a.useEffect)((()=>{n({type:"userChangedUrl",payload:t})})),i.a.createElement(i.a.Fragment,null,e)}));c.displayName="RouteCapture"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),i=n(45),r=n(44),o=n(121),s=n(634),l=n(138),c=n(166),u=n(127),d=n(887),p=n(249),m=n(13),f=n(396);const g=()=>{const e=Object(i.useDispatch)();return Object(a.useCallback)((({duplicate:t,id:n,forceNotes:a=!1,from:i,notes:g,resolveTimelineConfig:b,timeline:y,to:h,ruleNote:v,ruleAuthor:E,preventSettingQuery:x})=>{let j=y;var S;if(t&&(j={...y,updated:void 0,changed:void 0,version:null}),Object(r.isEmpty)(j.indexNames)||e(c.a.setSelectedDataView({id:u.SourcererScopeName.timeline,selectedDataViewId:j.dataViewId,selectedPatterns:j.indexNames})),j.status===o.l.immutable&&j.timelineType===o.m.template?e(Object(p.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:f.a.toISOString(),to:f.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:i,to:h})),e(Object(m.addTimeline)({id:n,timeline:j,resolveTimelineConfig:b,savedTimeline:t})),x||null==j.kqlQuery||null==j.kqlQuery.filterQuery||null==j.kqlQuery.filterQuery.kuery||""===j.kqlQuery.filterQuery.kuery.expression||e(Object(m.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(S=j.kqlQuery.filterQuery.kuery.kind)&&void 0!==S?S:"kuery",expression:j.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:j.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=v&&!Object(r.isEmpty)(v)){const t=Object(s.a)({newNote:v,user:E||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(m.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=g?g.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154).isClient?window:null,r=function(e){return!!e.addEventListener},o=function(e){return!!e.on};t.default=function(e,t,n,s){void 0===n&&(n=i),a.useEffect((function(){if(t&&n)return r(n)?n.addEventListener(e,t,s):o(n)&&n.on(e,t,s),function(){r(n)?n.removeEventListener(e,t,s):o(n)&&n.off(e,t,s)}}),[e,t,n,JSON.stringify(s)])}},function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),i=n.test(t);return a&&i&&(e=+e,t=+t),e===t?0:a&&!i?-1:i&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(207);const i=(e,t)=>`/name/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,o=(e,t)=>`/${e}${Object(a.a)(t)}`},,,function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"m",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return b}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Let’s set up your detection engine"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),d=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),b=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:e},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."})},function(e,t,n){"use strict";n.d(t,"c",(function(){return Ke})),n.d(t,"a",(function(){return et})),n.d(t,"b",(function(){return nt}));var a=n(19),i=n(2),r=n.n(i),o=n(42),s=n(51),l=n(165),c=n(122),u=n(7),d=n(675),p=n.n(d),m=n(48),f=n(41),g=n.n(f);const b=r.a.memo((({onClick:e,queriesLength:t})=>{const[n,s]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{e(),s(!0)}),[e]);return n?null:r.a.createElement(y,{color:"primary",paddingSize:"xs"},r.a.createElement(h,{direction:"row",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!0,"data-test-subj":"osquery-investigation-guide-text"},r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.investigationGuideSuggestion",defaultMessage:"You have {queriesLength, plural, one {a query} other {queries}} in the investigation guide. Add {queriesLength, plural, one {it as a response action} other {them as response actions}}?",values:{queriesLength:t}}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonEmpty,{size:"m",color:"primary",onClick:l,"data-test-subj":"osqueryAddInvestigationGuideQueries"},r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.addButton",defaultMessage:"Add"}))))))}));b.displayName="OsqueryInvestigationGuidePanel";var y=g()(a.EuiPanel)`${{marginBottom:"16px"}}`,h=g()(a.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-10xybv0-0"})(["",""],{padding:"0 24px"}),v=n(526),E=n(4),x=n(174),j=n(586),S=n(140),O=n(62);const k=({path:e,disabled:t,readDefaultValueOnForm:n})=>{const a=Object(i.useMemo)((()=>({defaultValue:!0,label:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.overwriteFieldLabel",defaultMessage:"Use the alert's {pid} value to identify the process to terminate.",values:{pid:r.a.createElement("strong",null,"process.pid")}})})),[]);return r.a.createElement(s.UseField,{component:O.ToggleField,euiFieldProps:{"data-test-subj":"config-overwrite-toggle"},path:e,readDefaultValueOnForm:n,config:a,isDisabled:t})},w=r.a.memo(k),T=n(1194).map((e=>({label:e.field,value:e}))),I=Object.freeze({asPlainText:!0}),M="Custom field name",C=E.i18n.translate("xpack.securitySolution.responseActions.endpoint.validations.fieldNameIsRequiredErrorMessage",{defaultMessage:"{field} selection is required when the process.pid toggle is disabled.",values:{field:M}}),_=({path:e,disabled:t,readDefaultValueOnForm:n,isRequired:l})=>{const[c]=Object(s.useFormData)(),d=Object(u.get)(c,e),p=Object(s.useFormContext)().getFields()[e];Object(i.useEffect)((()=>{p&&!l&&(null==p||p.clearErrors()),null==p||!p.isValidated||null!=p&&p.value||!l||null==p||p.setErrors([{message:C}])}),[p,l]);const m=Object(i.useMemo)((()=>(null==d?void 0:d.includes("entity_id"))?r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.entityIdDescription",defaultMessage:"Entity_id is an Elastic Defend agent specific field, if the alert does not come from Elastic Defend agent we will not be able to send the action."}):r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.fieldDescription",defaultMessage:"Choose a different alert field to identify the process to terminate."})),[d]),f=Object(i.useMemo)((()=>({label:M,helpText:m,validations:[{validator:({value:t})=>{if(l&&""===t)return{code:"ERR_FIELD_MISSING",path:e,message:C}}}]})),[l,e,m]),g=Object(i.useMemo)((()=>T.map((({label:e})=>({label:e,value:e})))),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.UseField,{path:e,readDefaultValueOnForm:n,config:f},(e=>{const{value:n,setValue:i}=e,{isInvalid:o,errorMessage:c}=Object(s.getFieldValidityAndErrorMessage)(e),u=!!g.find((e=>e.label===n));return r.a.createElement(a.EuiFormRow,{label:e.label,helpText:e.helpText,fullWidth:!0,error:c,isInvalid:o},r.a.createElement(a.EuiComboBox,{isInvalid:o,isDisabled:t||!l,singleSelection:I,noSuggestions:!1,options:g,fullWidth:!0,selectedOptions:n&&u?[{value:n,label:n}]:void 0,onChange:e=>{0===e.length?i(""):i(e[0].label)},"data-test-subj":"config-custom-field-name"}))})),r.a.createElement(a.EuiSpacer,{size:"s"}))},D=r.a.memo(_),A=({basePath:e,disabled:t,readDefaultValueOnForm:n})=>{const i=`${e}.command`,o=`${e}.config.overwrite`,[l]=Object(s.useFormData)({watch:[i,o]}),c=Object(u.get)(l,i),d=Object(u.get)(l,o);return"kill-process"===c||"suspend-process"===c?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,null),r.a.createElement(w,{path:`${e}.config.overwrite`,disabled:t,readDefaultValueOnForm:n}),r.a.createElement(a.EuiSpacer,null),r.a.createElement(D,{path:`${e}.config.field`,disabled:t,readDefaultValueOnForm:n,isRequired:!d}),r.a.createElement(a.EuiSpacer,null)):null},F=r.a.memo(A),N={label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLabel",{defaultMessage:"Comment (optional)"}),helpText:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commentDescription",defaultMessage:"Leave a note that explains or describes the action. Your comment is included in the response actions history."})},P=({basePath:e,disabled:t,readDefaultValueOnForm:n})=>r.a.createElement(s.UseField,{path:`${e}.comment`,readDefaultValueOnForm:n,config:N,isDisabled:t,component:O.TextField}),R=r.a.memo(P);var L=n(77),z=n(118);E.i18n.translate("xpack.securitySolution.endpoint.action.permissionDenied",{defaultMessage:"Permission denied"});const q=E.i18n.translate("xpack.securitySolution.endpoint.action.chooseFromTheList",{defaultMessage:"Choose action from the list"}),B=E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLearnMore",{defaultMessage:"Learn more"});var $=n(237);const V=({name:e,isDisabled:t})=>{const{title:n,description:i,tooltip:o}=U(e),s=r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,{size:"s"},r.a.createElement("b",null,n)),r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(a.EuiText,{size:"xs"},i));return t?r.a.createElement(a.EuiToolTip,{position:"top",content:o},s):s},U=e=>{switch(e){case"isolate":return{title:$.b.isolate.title,description:$.b.isolate.about,tooltip:$.b.isolate.privileges};case"kill-process":return{title:$.b.killProcess.title,description:$.b.killProcess.about,tooltip:$.b.killProcess.privileges};case"suspend-process":return{title:$.b.suspendProcess.title,description:$.b.suspendProcess.about,tooltip:$.b.suspendProcess.privileges};default:return{title:"",description:"",tooltip:""}}},G=r.a.memo(V),H=({basePath:e,disabled:t,readDefaultValueOnForm:n})=>{const{endpointPrivileges:l}=Object(S.a)(),[d]=Object(s.useFormData)(),{docLinks:{links:{securitySolution:{responseActions:p}}}}=Object(z.j)().services,m=Object(c.a)("automatedProcessActionsEnabled"),f=Object(i.useMemo)((()=>[...x.a,...m?["kill-process","suspend-process"]:[]]),[m]),g=Object(i.useMemo)((()=>f.map((e=>{const t=!Object(j.a)({commandName:x.f[e],privileges:l}),n=Object(u.map)(d.responseActions,"params.command").includes(e)||t;return{value:e,inputDisplay:e,dropdownDisplay:r.a.createElement(G,{name:e,isDisabled:t}),disabled:n,"data-test-subj":`command-type-${e}`}}))),[d.responseActions,f,l]);return r.a.createElement(s.UseField,{path:`${e}.command`,readDefaultValueOnForm:n,config:{label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commandLabel",{defaultMessage:"Response action"}),helpText:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commandDescription",defaultMessage:"Select an endpoint response action. The response action only runs on hosts with Elastic Defend installed. {docs}",values:{docs:r.a.createElement(a.EuiLink,{href:p,target:"_blank"},B)}}),validations:[{validator:L.fieldValidators.emptyField(E.i18n.translate("xpack.securitySolution.responseActions.endpoint.validations.commandIsRequiredErrorMessage",{defaultMessage:"Action is a required field."}))}]},component:O.SuperSelectField,isDisabled:t,componentProps:{euiFieldProps:{options:g,placeholder:q,"data-test-subj":"commandTypeField"}}})},W=r.a.memo(H),Q=({basePath:e,editDisabled:t})=>{const[n]=Object(s.useFormData)(),i=Object(u.get)(n,`${e}.command`);return t?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiCallOut,{color:"warning",iconType:"warning",title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.privileges",defaultMessage:"Insufficient privileges"})},r.a.createElement(a.EuiText,{size:"xs"},$.b.isolate.privileges)),r.a.createElement(a.EuiSpacer,{size:"s"})):"isolate"===i?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiCallOut,{color:"warning",iconType:"warning",title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionTitle",defaultMessage:"Proceed with caution"})},r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionDescription",defaultMessage:"Only select this option if you’re certain that you want to automatically block communication with other hosts on your network until you release this host."}))),r.a.createElement(a.EuiSpacer,{size:"s"})):"kill-process"===i||"suspend-process"===i?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiCallOut,{color:"warning",iconType:"warning",title:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionTitle",defaultMessage:"Proceed with caution"})},r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.processesCautionDescription",defaultMessage:"Only select this option if you’re certain that you want to automatically terminate the process running on a host."}))),r.a.createElement(a.EuiSpacer,{size:"s"})):r.a.createElement(r.a.Fragment,null)},Y=r.a.memo(Q),K=r.a.memo((e=>{const t=`${e.item.path}.params`;return r.a.createElement(r.a.Fragment,null,r.a.createElement(W,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}),r.a.createElement(Y,{basePath:t,editDisabled:e.editDisabled}),r.a.createElement(F,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}),r.a.createElement(R,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}))}));K.displayName="EndpointResponseAction";var J=n(247),Z=n(1213);const X={...function(e){return e.advancedInsights="advanced_insights",e.investigationGuide="investigation_guide",e.investigationGuideInteractions="investigation_guide_interactions",e.endpointHostManagement="endpoint_host_management",e.endpointPolicyManagement="endpoint_policy_management",e.endpointPolicyProtections="endpoint_policy_protections",e.endpointArtifactManagement="endpoint_artifact_management",e.endpointResponseActions="endpoint_response_actions",e.threatIntelligence="threat-intelligence",e.osqueryAutomatedResponseActions="osquery_automated_response_actions",e.endpointProtectionUpdates="endpoint_protection_updates",e.endpointAgentTamperProtection="endpoint_agent_tamper_protection",e.endpointExceptions="endpointExceptions",e.externalRuleActions="external_rule_actions",e.cloudSecurityPosture="cloud_security_posture",e.integrationAssistant="integration_assistant",e}({}),...function(e){return e.casesConnectors="cases_connectors",e}({}),...function(e){return e.assistant="assistant",e}({})};Object.freeze(Object.values(X));var ee=n(208);const te=r.a.memo((({field:e})=>{const{clearErrors:t,value:n,setValue:a,path:o}=e,{osquery:l}=Object(z.j)().services,c=Object(s.useFormContext)(),d=Object(i.useMemo)((()=>null==l?void 0:l.OsqueryResponseActionTypeForm),[null==l?void 0:l.OsqueryResponseActionTypeForm]),p=Object(i.useCallback)((e=>{if(Object(u.isEmpty)(e))t();else{const t=Object(u.map)(e,(e=>({message:e.message})));c.setFieldErrors(o,t)}}),[t,c,o]);return r.a.createElement(d,{defaultValues:n,onError:p,onChange:a})}));te.displayName="ResponseActionFormField";var ne=n(157),ae=n(771);const ie=()=>r.a.createElement(r.a.Fragment,null),re=r.a.memo((e=>{const{osquery:t,application:n}=Object(z.j)().services,i=Object(Z.a)(),s=Object(ee.a)(X.osqueryAutomatedResponseActions);if(t){var l,c,u,d,p,m,f,g;const{disabled:b,permissionDenied:y}=t.fetchInstallationStatus(),h=!(null!=n&&null!==(l=n.capabilities)&&void 0!==l&&null!==(c=l.osquery)&&void 0!==c&&c.writeLiveQueries||null!=n&&null!==(u=n.capabilities)&&void 0!==u&&null!==(d=u.osquery)&&void 0!==d&&d.runSavedQueries&&(null!=n&&null!==(p=n.capabilities)&&void 0!==p&&null!==(m=p.osquery)&&void 0!==m&&m.readSavedQueries||null!=n&&null!==(f=n.capabilities)&&void 0!==f&&null!==(g=f.osquery)&&void 0!==g&&g.readPacks));if(s)return r.a.createElement(s,null);if(y||h)return r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.g,{path:`${e.item.path}.params`,component:ie}),r.a.createElement(a.EuiEmptyPrompt,{title:r.a.createElement("h2",null,ae.b),titleSize:"xs",iconType:"logoOsquery",body:r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.osquery.action.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:r.a.createElement(a.EuiCode,null,"osquery")}}))}));if(b)return r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.g,{path:`${e.item.path}.params`,component:ie}),r.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:r.a.createElement("h2",null,ae.c),titleSize:"xs",body:r.a.createElement("p",null,ae.a)}));if(i())return r.a.createElement(ne.g,{path:`${e.item.path}.params`,component:te,readDefaultValueOnForm:!e.item.isNew})}return null}));re.displayName="OsqueryResponseAction";const oe=e=>{switch(e){case J.b[".osquery"]:return{logo:"logoOsquery",name:"Osquery"};case J.b[".endpoint"]:return{logo:"logoSecurity",name:"Elastic Defend"};default:return{logo:"logoOsquery",name:"Osquery"}}},se=g()(a.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-16pdpi-0"})(["background:",";.euiAccordion__buttonContent{padding:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeM)),le=({item:e,onDeleteAction:t})=>{var n;const[o,s]=Object(i.useState)(!0),[l]=Object(ne.o)(),c=Object(u.get)(l,e.path),d=null!==(n=(e=>{var t;const n=Object(S.a)().endpointPrivileges;if(".endpoint"===(null==e?void 0:e.actionTypeId)&&null!=e&&null!==(t=e.params)&&void 0!==t&&t.command)return!Object(j.a)({commandName:x.f[e.params.command],privileges:n})})(c))&&void 0!==n&&n,p=Object(i.useMemo)((()=>(null==c?void 0:c.actionTypeId)===J.b[".osquery"]?r.a.createElement(re,{item:e}):(null==c?void 0:c.actionTypeId)===J.b[".endpoint"]?r.a.createElement(K,{item:e,editDisabled:d}):null),[null==c?void 0:c.actionTypeId,d,e]),m=Object(i.useCallback)((()=>{t(e.id)}),[e,t]),f=Object(i.useMemo)((()=>{const{logo:e,name:t}=oe(null==c?void 0:c.actionTypeId);return r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{type:e,size:"m"})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,null,t)))}),[null==c?void 0:c.actionTypeId]),g=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{"data-test-subj":"remove-response-action",iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":E.i18n.translate("xpack.securitySolution.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),disabled:d,onClick:m})),[d,m]);return r.a.createElement(se,{initialIsOpen:!0,key:e.id,id:e.id.toString(),onToggle:s,paddingSize:"l","data-test-subj":"alertActionAccordion",buttonContent:f,extraAction:g},p)};le.displayName="ResponseActionTypeForm";const ce=r.a.memo(le);var ue=n(476),de=n.n(ue),pe=n(1195),me=n.n(pe),fe=n(478);const ge=()=>r.a.createElement(r.a.Fragment,null),be=r.a.memo((({items:e,removeItem:t})=>{const{detailName:n}=Object(m.useParams)(),{data:o}=Object(v.f)(n),s=Object(i.useMemo)((()=>null!=o&&o.note?(e=>{const t=de()().use([[me.a,{}],fe.a]).parse(e);return Object(u.filter)(null==t?void 0:t.children,["type","osquery"])})(o.note):[]),[null==o?void 0:o.note]),l=Object(ne.n)(),[c]=Object(ne.o)(),d=Object(i.useCallback)((()=>{const e=((e,t=[])=>Object(u.reduce)(e,((e,{configuration:t})=>(e.responseActions.push({actionTypeId:J.b[".osquery"],params:{savedQueryId:void 0,packId:void 0,queries:void 0,query:t.query,ecsMapping:t.ecs_mapping}}),e)),{responseActions:t}))(s,c.responseActions);l.updateFieldValues(e)}),[l,null==c?void 0:c.responseActions,s]);return r.a.createElement("div",{"data-test-subj":"response-actions-list"},e.map(((e,n)=>r.a.createElement("div",{key:e.id,"data-test-subj":`response-actions-list-item-${n}`},r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(ce,{item:e,onDeleteAction:t}),r.a.createElement(ne.g,{path:`${e.path}.actionTypeId`,component:ge})))),r.a.createElement(a.EuiSpacer,{size:"m"}),s.length?r.a.createElement(b,{onClick:d,queriesLength:s.length}):null)}));be.displayName="ResponseActionsList";var ye=n(16);const he=E.i18n.translate("xpack.securitySolution.actionForm.platinumOnly",{defaultMessage:"This functionality is available only in Platinum and above."}),ve=({supportedResponseActionTypes:e,addActionType:t,updateActionTypeId:n})=>{const[s]=Object(ne.o)(),[l,c]=Object(i.useState)(s.responseActions&&s.responseActions.length>0),u=Object(ye.b)().isPlatinumPlus(),d=Object(i.useCallback)((e=>{c(!1),t(),n(e.id)}),[t,n]),p=Object(i.useMemo)((()=>r.a.createElement(a.EuiFlexGroup,{direction:"row"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiButton,{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>c(!1)},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.sections.actionForm.addResponseActionButtonLabel",defaultMessage:"Add response action"}))))),[]),m=Object(i.useMemo)((()=>(null==e?void 0:e.length)&&e.map((function(e,t){const n=r.a.createElement(a.EuiKeyPadMenuItem,{key:t,isDisabled:!u||e.disabled,"data-test-subj":`${e.name}-response-action-type-selection-option`,label:e.name,betaBadgeTooltipContent:"should be visible",onClick:()=>d(e)},r.a.createElement(a.EuiIcon,{size:"xl",type:e.iconClass}));return u?r.a.createElement(a.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},n):r.a.createElement(a.EuiToolTip,{position:"top",content:he},r.a.createElement(a.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},n))}))),[d,u,e]);return null!=e&&e.length?r.a.createElement(r.a.Fragment,null,l?p:r.a.createElement(a.EuiFlexGroup,{direction:"row"},m)):r.a.createElement(r.a.Fragment,null)},Ee=r.a.memo((({items:e,removeItem:t,supportedResponseActionTypes:n,addItem:a})=>{const o=Object(i.useRef)(null),s=Object(i.useCallback)((e=>{o.current=e}),[]),l=Object(ne.n)(),c=Object(i.useMemo)((()=>r.a.createElement(ve,{supportedResponseActionTypes:n,addActionType:a,updateActionTypeId:s})),[a,s,n]);return Object(i.useEffect)((()=>{if(o.current){const t=`responseActions[${e.length-1}].actionTypeId`;l.setFieldValue(t,o.current),o.current=null}}),[l,e.length]),r.a.createElement("div",{"data-test-subj":"response-actions-wrapper"},r.a.createElement(be,{items:e,removeItem:t}),c)}));Ee.displayName="ResponseActionsWrapper";var xe=n(688);const je=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,{grow:!1,"data-test-subj":"response-actions-header"},r.a.createElement(a.EuiTitle,{size:"s"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{defaultMessage:"Response Actions",id:"xpack.securitySolution.actionForm.responseActionSectionsDescription"})))),r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(o.FormattedMessage,{defaultMessage:"Response actions are run on each rule execution.",id:"xpack.securitySolution.actionForm.responseActionSectionsTitle"})),r.a.createElement(a.EuiSpacer,{size:"m"})),Se=[{id:J.b[".osquery"],name:"Osquery",iconClass:"logoOsquery"},{id:J.b[".endpoint"],name:"Elastic Defend",iconClass:"logoSecurity"}],Oe=({items:e,addItem:t,removeItem:n,form:o})=>{const s=(()=>{const[e,t]=Object(i.useState)(),n=Object(c.a)("endpointResponseActionsEnabled"),{canIsolateHost:a,canKillProcess:r,canSuspendProcess:o}=Object(S.a)().endpointPrivileges,s=Object(i.useMemo)((()=>({endpoint:n})),[n]),l=Object(i.useMemo)((()=>({endpoint:a||r||o})),[a,r,o]);return Object(i.useEffect)((()=>{const e=((e,t,n)=>e.reduce(((e,a)=>{const i=a.id===J.b[".endpoint"];return!t.endpoint&&i?e:J.a.options.includes(a.id)?[...e,{...a,disabled:i?!n.endpoint:void 0}]:e}),[]))(Se,s,l);t(e)}),[n,s,l]),e})(),[l,d]=Object(i.useState)(null),m=o.getFields(),f=o.getErrors(),g=Object(i.useMemo)((()=>null!=s&&s.length?r.a.createElement(Ee,{items:e,removeItem:n,supportedResponseActionTypes:s,addItem:t}):null),[t,e,n,s]);return Object(i.useEffect)((()=>{d((()=>{const t=Object(u.reduce)(Object(u.map)(e,"path"),((e,t)=>(Object(u.map)(m,((n,a)=>{const i=`${t}.params`;if(a.includes(i)){var r,o;if(null!==(r=m[a])&&void 0!==r&&null!==(o=r.errors)&&void 0!==o&&o.length){const n=oe(m[`${t}.actionTypeId`].value).name;e.push({type:n,errors:Object(u.map)(m[a].errors,"message")})}return e}return e})),e)),[]);return Object(u.reduce)(t,((e,t)=>(e.push(`**${t.type}:**\n`),t.errors.forEach((t=>{e.push(`- ${t}\n`)})),e)),[]).join("\n")}))}),[m,f,e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"xxl","data-test-subj":"response-actions-form"}),r.a.createElement(je,null),null!=l&&l.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement(a.EuiCallOut,{"data-test-subj":"response-actions-error",title:xe.b,color:"danger",iconType:"warning"},r.a.createElement(p.a,null,l))),r.a.createElement(a.EuiSpacer,null)):null,g)};var ke=n(787),we=n(942),Te=n(47),Ie=n(69),Me=n(123),Ce=n(159);const _e=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorsFetchError",{defaultMessage:"Failed to fetch connectors"}),De=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorTypesFetchError",{defaultMessage:"Failed to fetch connector types"}),Ae=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.actionsFetchErrorDescription",{defaultMessage:"Viewing actions is not available"}),Fe=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'}),Ne=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.docsLinkText",{defaultMessage:"Learn more"});function Pe(){const{docLinks:{links:{securitySolution:{manageDetectionRules:e}}}}=Object(z.j)().services,t=`${e}#edit-rules-settings`;return r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepRuleActions.snoozeDescription",defaultMessage:"Choose when to perform actions or snooze them. Notifications are not created for snoozed actions. {docs}.",values:{docs:r.a.createElement(a.EuiLink,{href:t,target:"_blank"},Ne)}})}const Re=r.a.createElement(Pe,null),Le=(E.i18n.translate("xpack.securitySolution.detectionEngine.actionsSectionLabel",{defaultMessage:"Actions"}),E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.notificationActions",{defaultMessage:"Notification actions"})),ze=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.responseActions",{defaultMessage:"Response actions"}),qe=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.forEachOption",{defaultMessage:"For each alert. Per rule run."}),Be=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.summaryOption",{defaultMessage:"Summary of alerts. Per rule run."}),$e=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.periodically",{defaultMessage:"Periodically"});var Ve=n(866);function Ue({ruleId:e}){return r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"s"},Re)),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(Ve.a,{ruleId:e,showTooltipInline:!0})))}var Ge=n(438);const He=({children:e})=>r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"xs",color:"subdued"},e)),We=({frequency:e})=>{if(!e)return null;if(!e.summary)return r.a.createElement(He,null,qe);if("onActiveAlert"===e.notifyWhen)return r.a.createElement(He,null,Be);if(!e.throttle)return null;const{unit:t,value:n}=Object(Ge.g)(e.throttle),a={s:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEverySecondsLabel",defaultMessage:"Once {secondsCount, plural, one {a} other {in every}} {secondsCount, plural, one {second} other {# seconds}}",values:{secondsCount:n}}),m:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryMinutesLabel",defaultMessage:"Once {minutesCount, plural, one {a} other {in every}} {minutesCount, plural, one {minute} other {# minutes}}",values:{minutesCount:n}}),h:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryHoursLabel",defaultMessage:"Once {hoursCount, plural, one {an} other {in every}} {hoursCount, plural, one {hour} other {# hours}}",values:{hoursCount:n}}),d:r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryDaysLabel",defaultMessage:"Once {daysCount, plural, one {a} other {in every}} {daysCount, plural, one {day} other {# days}}",values:{daysCount:n}})};return r.a.createElement(He,null,a[t]||$e)};function Qe({action:e,connectorTypes:t,connectors:n,actionTypeRegistry:i}){var o,s,l,c;const u=t.find((({id:t})=>t===e.actionTypeId)),d=null!==(o=null==u?void 0:u.name)&&void 0!==o?o:"",p=n.find((({id:t})=>t===e.id)),m=null!==(s=null==p?void 0:p.name)&&void 0!==s?s:"",f=null!==(l=null===(c=i.get(e.actionTypeId))||void 0===c?void 0:c.iconClass)&&void 0!==l?l:"apps";return r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{content:d,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiIcon,{size:"m",type:f}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"s"},m),r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",component:"span",responsive:!1},r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{size:"s",type:"bell",color:"subdued"})),r.a.createElement(We,{frequency:e.frequency})))))}function Ye({action:e}){const{name:t,logo:n}=oe(e.actionTypeId);return r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiIcon,{size:"m",type:n}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"s"},t))))}const Ke={enabled:!0,actions:[],responseActions:[],kibanaSiemAppUrl:""},Je=()=>r.a.createElement(r.a.Fragment,null),Ze=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiTitle,{size:"s"},r.a.createElement("h4",null,r.a.createElement(o.FormattedMessage,{defaultMessage:"Actions",id:"xpack.securitySolution.detectionEngine.rule.editRule.actionSectionsTitle"}))),r.a.createElement(a.EuiSpacer,{size:"l"})),Xe=({ruleId:e,isUpdateView:t=!1,actionMessageParams:n,summaryActionMessageParams:o,ruleType:u,form:d})=>{const{services:{application:p}}=Object(z.j)(),m=Object(c.a)("responseActionsEnabled"),f=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,null),r.a.createElement(ne.g,{path:"actions",component:we.a,componentProps:{messageVariables:n,summaryMessageVariables:o}}))),[n,o]),g=Object(i.useMemo)((()=>Object(l.g)(u)?r.a.createElement(s.UseArray,{path:"responseActions",initialNumberOfItems:0},Oe):null),[u]),b=Object(i.useMemo)((()=>p.capabilities.actions.show?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ze,null),e&&r.a.createElement(Ue,{ruleId:e}),f,m&&g,r.a.createElement(ne.g,{path:"kibanaSiemAppUrl",component:Je}),r.a.createElement(ne.g,{path:"enabled",component:Je})):r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,null,Fe))),[e,p.capabilities.actions.show,f,g,m]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a,{addPadding:!t},r.a.createElement(ne.c,{form:d,"data-test-subj":"stepRuleActions"},r.a.createElement(a.EuiForm,null,b))))},et=Object(i.memo)(Xe),tt=({addPadding:e,defaultValues:t})=>{const{services:{triggersActionsUi:n}}=Object(z.j)(),i=n.actionTypeRegistry,{data:o}=(()=>{const{addError:e}=Object(Me.a)();return Object(Te.useQuery)(["GET",Ie.BASE_ACTION_API_PATH,"connectors"],(({signal:e})=>Object(Ce.f)(e)),{onError:t=>{e(t,{title:_e,toastMessage:Ae})}})})(),{data:s}=(()=>{const{addError:e}=Object(Me.a)();return Object(Te.useQuery)(["GET",Ie.BASE_ACTION_API_PATH,"connector_types","siem"],(({signal:e})=>Object(Ce.e)(e)),{onError:t=>{e(t,{title:De,toastMessage:Ae})}})})(),l=t.actions,c=t.responseActions||[];if(!(l.length>0||c.length>0)||!o||!s)return null;const u=l.length>0&&c.length>0;return r.a.createElement(ke.a,{addPadding:e},l.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,{size:"m"},Le),r.a.createElement(a.EuiSpacer,{size:"s"})),l.map(((e,t)=>{const n=t===l.length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Qe,{action:e,connectorTypes:s,connectors:o,actionTypeRegistry:i,key:e.id}),!n&&r.a.createElement(a.EuiSpacer,{size:"s"}))})),u&&r.a.createElement(a.EuiSpacer,{size:"l"}),c.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,{size:"m"},ze),r.a.createElement(a.EuiSpacer,{size:"s"})),c.map(((e,t)=>{const n=t===c.length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ye,{action:e,key:`${e.actionTypeId}-${t}`}),!n&&r.a.createElement(a.EuiSpacer,{size:"s"}))})))},nt=Object(i.memo)(tt)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var a=n(19),i=n(2),r=n.n(i),o=n(4);const s=o.i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),l=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:n,showShortcut:i})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},r.a.createElement("p",null,e)),i&&r.a.createElement(a.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},r.a.createElement("span",null,s)," ",r.a.createElement(a.EuiBadge,{color:"hollow"},n))),c=r.a.memo(l);c.displayName="TooltipWithKeyboardShortcut";const u=({interval:e})=>{const t=Object(i.useMemo)((()=>{if(e){const n=parseInt(e.slice(0,-1),10),a=e.charAt(e.length-1);if(Number.isFinite(n))switch(a){case"s":return t=n,o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.seconds",{defaultMessage:"{value} {value, plural, one { second } other { seconds }}",values:{value:t}});case"m":return(e=>o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.minutes",{defaultMessage:"{value} {value, plural, one { minute } other { minutes }}",values:{value:e}}))(n);case"h":return(e=>o.i18n.translate("xpack.securitySolution.accessibility.intervalAbbrScreenReader.hours",{defaultMessage:"{value} {value, plural, one { hour } other { hours }}",values:{value:e}}))(n)}}var t}),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{"data-test-subj":"interval-abbr-value","aria-hidden":Boolean(t)},e),t&&r.a.createElement(a.EuiScreenReaderOnly,null,r.a.createElement("p",null,t)))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(45),l=n(41),c=n.n(l),u=n(760),d=n(124),p=n(183),m=n(761),f=n(138),g=n(118),b=n(148),y=n(200),h=n(42),v=n(80),E=n(19),x=n(249),j=n(658),S=n(625),O=n(474),k=n(127),w=n(916),T=n(282),I=n(417),M=n(447);const C=["ACTION_CUSTOMIZE_PANEL"],_=c.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),D=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraActions:n,extraOptions:a,getLensAttributes:i,height:l,id:c,inputsModelId:u=f.a.global,inspectTitle:d,lensAttributes:p,onLoad:m,scopeId:b=k.SourcererScopeName.default,enableLegendActions:y=!0,stackByField:D,timerange:F,width:N,withActions:P=S.a,disableOnClickFilter:R=!1,casesAttachmentMetadata:L})=>{var z,q,B;const $=Object(r.useMemo)((()=>({height:null!=l?l:"100%",minWidth:"100px",width:null!=N?N:"100%"})),[l,N]),{lens:V,data:{actions:{createFiltersFromValueClickAction:U}}}=Object(g.j)().services,G=Object(s.useDispatch)(),{searchSessionId:H}=Object(I.a)({visualizationId:c}),W=Object(j.a)({applyGlobalQueriesAndFilters:e,applyPageAndTabsFilters:t,extraOptions:a,getLensAttributes:i,lensAttributes:p,scopeId:b,stackByField:D,title:""}),Q=null==W||null===(z=W.state)||void 0===z||null===(q=z.visualization)||void 0===q?void 0:q.preferredSeriesType,Y="lnsLegacyMetric"!==(null==W?void 0:W.visualizationType)&&"lnsPie"!==(null==W?void 0:W.visualizationType),K=V.EmbeddableComponent,J=Object(r.useMemo)((()=>y?void 0:{settings:{legendAction:"ignore",onBrushEnd:"ignore"}}),[y]),{setInspectData:Z}=(X=m,{setInspectData:Object(r.useCallback)(((e,t)=>{var n;if(!t)return;const a=Object(T.f)(null==t||null===(n=t.requests)||void 0===n?void 0:n.getRequests());null==X||X({requests:a.requests,responses:a.responses,isLoading:e})}),[X])});var X;const{responses:ee,loading:te}=Object(I.a)({visualizationId:c}),{additionalRequests:ne,additionalResponses:ae,handleClick:ie,handleCloseModal:re,isButtonDisabled:oe,isShowingModal:se,request:le,response:ce}=Object(M.a)({inputId:u,isDisabled:te,multiple:null!=ee&&ee.length>1,queryId:c}),ue=Object(r.useMemo)((()=>({handleInspectClick:ie,isInspectButtonDisabled:oe})),[ie,oe]),de=Object(S.d)({attributes:W,extraActions:n,inspectActionProps:ue,timeRange:F,withActions:P,lensMetadata:L}),pe=Object(r.useCallback)((({range:e})=>{const[t,n]=e;G(Object(x.setAbsoluteRangeDatePicker)({id:u,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[G,u]),me=Object(r.useCallback)((e=>{if(!R)return async e=>{if(!A(e)||"area"!==Q)return void e.preventDefault();const[{query:t}]=await U({data:e.data,negate:e.negate}),n=null==t?void 0:t.range["@timestamp"];null!=n&&n.gte&&null!=n&&n.lt&&pe({range:[n.gte,n.lt]})};e.preventDefault()}),[U,pe,Q,R]),fe=Object(r.useMemo)((()=>{var e,t;return null!=(null==W||null===(e=W.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==W||null===(t=W.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==W||null===(B=W.state)||void 0===B?void 0:B.adHocDataViews]);return H?!W||null!=ee&&0===ee.length?o.a.createElement(E.EuiFlexGroup,null,o.a.createElement(E.EuiFlexItem,{grow:1},o.a.createElement(E.EuiEmptyPrompt,{body:o.a.createElement(E.EuiText,{size:"xs"},o.a.createElement(h.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),o.a.createElement(E.EuiFlexItem,{grow:!1},o.a.createElement(w.a,{extraActions:n,getLensAttributes:i,inputId:u,isInspectButtonDisabled:!0,lensAttributes:W,queryId:c,stackByField:D,timerange:F,title:d,withActions:P,casesAttachmentMetadata:L}))):o.a.createElement(o.a.Fragment,null,W&&H&&o.a.createElement(_,{$height:l,width:N,$addHoverActionsPadding:Y},o.a.createElement(K,{attributes:W,disabledActions:C,extraActions:de,id:c,onBrushEnd:pe,onFilter:me,onLoad:Z,overrides:J,searchSessionId:H,showInspector:!1,style:$,syncCursor:!1,syncTooltips:!1,timeRange:F,viewMode:v.ViewMode.VIEW,withDefaultActions:!1})),se&&null!=le&&null!=ce&&o.a.createElement(O.a,{adHocDataViews:fe,additionalRequests:ne,additionalResponses:ae,closeModal:re,"data-test-subj":"inspect-modal",inputId:u,request:le,response:ce,title:d})):null},A=e=>Array.isArray(e.data)&&"column"in e.data[0],F=o.a.memo(D);var N=n(132);const P=e=>{var t,n;const a=Object(s.useDispatch)(),{inputId:c=f.a.global,id:h,isDonut:v,label:E,donutTextWrapperClassName:x,onLoad:j,...S}=e,{session:O,refetchByRestartingSession:k,refetchByDeletingSession:w}=(({inputId:e,queryId:t})=>{const n=Object(s.useDispatch)(),{data:a}=Object(g.j)().services,i=Object(r.useRef)(a.search.session),o=Object(r.useMemo)((()=>b.d.globalQueryByIdSelector()),[]),l=Object(r.useMemo)((()=>b.d.timelineQueryByIdSelector()),[]),{selectedInspectIndex:c}=Object(d.a)((n=>e===f.a.global?o(n,t):l(n,t))),u=Object(r.useCallback)((()=>{const e=i.current.start();n(y.c.setInspectionParameter({id:t,selectedInspectIndex:c,isInspected:!1,inputId:f.a.global,searchSessionId:e}))}),[n,t,c]),p=Object(r.useCallback)((()=>{n(y.c.deleteOneQuery({inputId:f.a.global,id:t}))}),[n,t]);return{session:i,refetchByRestartingSession:u,refetchByDeletingSession:p}})({inputId:c,queryId:h}),{indicesExist:T}=Object(N.a)(S.scopeId),M=Object(r.useRef)(S.timerange),C=Object(r.useMemo)((()=>p.d.globalQueryByIdSelector()),[]),{searchSessionId:_}=Object(d.a)((e=>C(e,h))),{responses:D}=Object(I.a)({visualizationId:h}),A=null!=D&&0!==(null===(t=D[0])||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.total),P=A?Object(l.css)(["top:40%;right:12%;"]):Object(l.css)(["top:66%;right:12%;"]),R=Object(r.useCallback)((({requests:e,responses:t,isLoading:n})=>{a(p.b.setQuery({inputId:c,id:h,searchSessionId:O.current.start(),refetch:k,loading:n,inspect:{dsl:e,response:t}})),"function"==typeof j&&j({requests:e,responses:t,isLoading:n})}),[a,c,h,O,k,j]);return Object(r.useEffect)((()=>{var e,t;(!T&&(null===(e=M.current)||void 0===e?void 0:e.from)!==S.timerange.from||(null===(t=M.current)||void 0===t?void 0:t.to)!==S.timerange.to)&&(M.current=S.timerange,a(p.b.deleteOneQuery({inputId:c,id:h})))}),[a,h,T,c,S.timerange]),Object(r.useEffect)((()=>{_||setTimeout((()=>{a(p.b.setQuery({inputId:c,id:h,searchSessionId:O.current.start(),refetch:A?k:w,loading:!1,inspect:null}))}),200)}),[a,c,h,O,A,k,_,w]),Object(r.useEffect)((()=>()=>{a(p.b.deleteOneQuery({inputId:c,id:h}))}),[a,h,c]),(S.getLensAttributes||S.lensAttributes)&&S.timerange?v?o.a.createElement(m.b,{isChartEmbeddablesEnabled:!0,dataExists:A,label:E,title:D?o.a.createElement(u.a,{count:null===(L=D[0])||void 0===L||null===(z=L.hits)||void 0===z?void 0:z.total}):null,donutTextWrapperClassName:x,donutTextWrapperStyles:P},o.a.createElement(F,i()({},S,{id:h,onLoad:R}))):o.a.createElement(F,i()({},S,{id:h,onLoad:R})):null;var L,z},R=o.a.memo(P)},function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"e",(function(){return T}));var a=n(19),i=n(60),r=n.n(i),o=n(2),s=n.n(o),l=n(41),c=n.n(l);const u=c.a.span.withConfig({displayName:"ArrowBody",componentId:"sc-11kjqat-0"})(["background-color:",";height:",";width:25px;"],(e=>e.theme.eui.euiColorLightShade),(({height:e})=>`${e}px`));u.displayName="ArrowBody";const d=s.a.memo((({direction:e})=>s.a.createElement(a.EuiIcon,{color:"subdued","data-test-subj":"arrow-icon",size:"s",type:e})));d.displayName="ArrowHead";var p=n(1296);const m=Object(p.scaleLinear)().domain([0,100]).range([1,4]).clamp(!0),f=e=>Array.isArray(e)&&1===e.length;var g=n(134),b=n(665),y=n(832);const h="source.bytes",v="source.packets",E="destination.bytes",x="destination.packets",j=c.a.span.withConfig({displayName:"Percent",componentId:"sc-19xyyc3-0"})(["margin-right:5px;"]);j.displayName="Percent";const S=c()(a.EuiFlexGroup).withConfig({displayName:"SourceDestinationArrowsContainer",componentId:"sc-19xyyc3-1"})(["margin:0 2px;.euiToolTipAnchor{white-space:nowrap;}"]);S.displayName="SourceDestinationArrowsContainer";const O=c()(a.EuiText).withConfig({displayName:"Data",componentId:"sc-19xyyc3-2"})(["margin:0 5px;"]);O.displayName="Data";const k=s.a.memo((({contextId:e,eventId:t,isDraggable:n,sourceBytes:i,sourceBytesPercent:o,sourcePackets:l})=>{const c=null!=o?m(o):1;return s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==i||isNaN(Number(i))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:h,id:`source-arrow-default-draggable-${e}-${t}-${h}-${i}`,isDraggable:n,value:i},s.a.createElement(O,{size:"xs"},null!=o?s.a.createElement(j,null,`(${r()(o).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(b.a,{value:i}))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==l||isNaN(Number(l))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:v,id:`source-arrow-default-draggable-${e}-${t}-${v}-${l}`,isDraggable:n,value:l},s.a.createElement(O,{size:"xs"},s.a.createElement("span",null,`${l} ${y.a}`)))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowRight"})))}));k.displayName="SourceArrow";const w=s.a.memo((({contextId:e,destinationBytes:t,destinationBytesPercent:n,destinationPackets:i,eventId:o,isDraggable:l})=>{const c=null!=n?m(n):1;return s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowLeft"})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==t||isNaN(Number(t))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:E,id:`destination-arrow-default-draggable-${e}-${o}-${E}-${t}`,isDraggable:l,value:t},s.a.createElement(O,{size:"xs"},null!=n?s.a.createElement(j,null,`(${r()(n).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(b.a,{value:t}))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==i||isNaN(Number(i))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:x,id:`destination-arrow-default-draggable-${e}-${o}-${x}-${i}`,isDraggable:l,value:i},s.a.createElement(O,{size:"xs"},s.a.createElement("span",null,`${r()(i).format("0,0")} ${y.a}`)))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})))}));w.displayName="DestinationArrow";const T=s.a.memo((({contextId:e,destinationBytes:t,destinationPackets:n,eventId:i,isDraggable:r,sourceBytes:o,sourcePackets:l})=>{const c=null!=o&&f(o)?o[0]:void 0,u=null!=l&&f(l)?l[0]:void 0,d=null!=t&&f(t)?t[0]:void 0,p=null!=n&&f(n)?n[0]:void 0,m=null!=c&&null!=d?(({numerator:e,denominator:t})=>{if(!(Math.abs(t)<Number.EPSILON)&&Number.isFinite(e)&&Number.isFinite(t))return e/t*100})({numerator:Number(c),denominator:Number(c)+Number(d)}):void 0,g=null!=m?100-m:void 0;return s.a.createElement(S,{alignItems:"center",justifyContent:"center",direction:"column",gutterSize:"none"},null!=c?s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(k,{contextId:e,eventId:i,isDraggable:r,sourceBytes:c,sourcePackets:u,sourceBytesPercent:m})):null,null!=d?s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(w,{contextId:e,destinationBytes:d,destinationPackets:p,destinationBytesPercent:g,eventId:i,isDraggable:r})):null)}));T.displayName="SourceDestinationArrows"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19),l=n(47),c=n(118),u=n(42);const d=({handleClick:e})=>i.a.createElement(s.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),p=i.a.memo(d);var m=n(716);const f=o.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),g=({agentId:e,defaultValues:t,onClose:n,ecsData:r})=>{const{euiTheme:o}=Object(s.useEuiTheme)(),u=Object(a.useMemo)((()=>({style:`z-index: ${o.levels.flyout+3}`})),[o.levels.flyout]),{services:{osquery:d}}=Object(c.j)(),g=Object(l.useQueryClient)(),b=Object(a.useCallback)((()=>{var e;g.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,g]),y=Object(s.useGeneratedHtmlId)({prefix:"osqueryFlyoutTitle"});return null!=d&&d.OsqueryAction?i.a.createElement(s.EuiFlyout,{size:"m",onClose:n,"aria-labelledby":y,maskProps:u},i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(s.EuiTitle,null,i.a.createElement("h2",{id:y},m.a))),i.a.createElement(s.EuiFlyoutBody,null,i.a.createElement(f,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(d.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:r,onSuccess:b}))),i.a.createElement(s.EuiFlyoutFooter,null,i.a.createElement(p,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},b=i.a.memo(g)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),i=n.n(a),r=n(19),o=n(2),s=n.n(o),l=n(41);const c=n.n(l)()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-tln1ed-0"})(["align-self:center;max-width:60em;"]);c.displayName="EmptyPrompt";const u=s.a.memo((({actions:e,message:t,title:n,...a})=>{const l=Object.keys(e),u=Object(o.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:n,url:a,descriptionTitle:i,description:o,onClick:c,fill:u=!0},d)=>null!=i||null!=o?s.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},s.a.createElement(r.EuiCard,{title:null!=i&&i,description:null!=o&&o,footer:s.a.createElement(r.EuiButton,{href:a,onClick:c,iconType:e,target:n,fill:u,"data-test-subj":`empty-page-${l[d]}-action`},t)})):s.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},s.a.createElement(r.EuiButton,{href:a,onClick:c,iconType:e,target:n,"data-test-subj":`empty-page-${l[d]}-action`},t))))),[e,l]);return s.a.createElement(c,i()({iconType:"logoSecurity",title:s.a.createElement(r.EuiText,null,s.a.createElement("h2",null,n)),body:t&&s.a.createElement("p",null,t),actions:s.a.createElement(r.EuiFlexGroup,{justifyContent:"center"},u)},a))}));u.displayName="EmptyPageComponent";const d=s.a.memo(u);d.displayName="EmptyPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=a.keyof({simple:null});a.union([i,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(48),i=n(5),r=n(127);const o=[i.d,i.C,`${i.Cc}/id/:id`,i.Ib,i.bd,i.ac,i.ic],s=[i.d,`${i.Cc}/id/:id`,`${i.x}/:detailName`],l=e=>null==Object(a.matchPath)(e,{path:s,strict:!1})?r.SourcererScopeName.default:r.SourcererScopeName.detections,c=e=>null!=Object(a.matchPath)(e,{path:o,strict:!1})},function(e,t,n){"use strict";var a=n(1e3),i={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,r,o,s,l,c,u=!1;t||(t={}),n=t.debug||!1;try{if(o=a(),s=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=e,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),void 0===a.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=i[t.format]||i.default;window.clipboardData.setData(r,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(c),s.selectNodeContents(c),l.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(a){n&&console.error("unable to copy using execCommand: ",a),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(a){n&&console.error("unable to copy using clipboardData: ",a),n&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(s):l.removeAllRanges()),c&&document.body.removeChild(c),o()}return u}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(11),r=n(118);const o=()=>{const e=Object(r.j)(),{http:t}=e.services,[n,o]=Object(a.useState)(Object(i.createSavedQueryService)(t));return Object(a.useEffect)((()=>{o(Object(i.createSavedQueryService)(t))}),[t]),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n(404).NetworkType.details;let a=function(e){return e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users",e}({})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19),l=n(157),c=n(481);const u=o()(s.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:r,bottomRightContent:o,includePlugins:d},p)=>{const{isInvalid:m,errorMessage:f}=Object(l.k)(t),[g,b]=Object(a.useState)(!1);return i.a.createElement(s.EuiFormRow,{"data-test-subj":n,describedByIds:r?[r]:void 0,error:f,fullWidth:!0,helpText:t.helpText,isInvalid:m||g,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(c.a,{ref:p,ariaLabel:r,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`,setIsMarkdownInvalid:b,includePlugins:d}),o&&i.a.createElement(u,{justifyContent:"flexEnd"},i.a.createElement(s.EuiFlexItem,{grow:!1},o))))})));d.displayName="MarkdownEditorForm"},function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return f}));var a=n(68);let i=function(e){return e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout",e.urlChanged="urlChanged",e}({});const r=Object(a.createAction)(i.openFlyout),o=Object(a.createAction)(i.openRightPanel),s=Object(a.createAction)(i.openLeftPanel),l=Object(a.createAction)(i.openPreviewPanel),c=Object(a.createAction)(i.closeFlyout),u=Object(a.createAction)(i.closeRightPanel),d=Object(a.createAction)(i.closeLeftPanel),p=Object(a.createAction)(i.closePreviewPanel),m=Object(a.createAction)(i.previousPreviewPanel),f=Object(a.createAction)(i.urlChanged)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n(19),i=n(2),r=n.n(i),o=n(559);const s="exit-full-screen",l=({fullScreen:e,setFullScreen:t})=>{const n=Object(i.useCallback)((()=>{t(!1)}),[t]),l=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:l}),r.a.createElement(a.EuiButton,{className:s,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:n},o.a)):null};l.displayName="ExitFullScreenComponent";const c=r.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events",e}({})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(174);const i=({commandName:e,privileges:t})=>Boolean(t[a.j[e]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n.n(a),r=n(19),o=n(517);const s=Object(a.memo)((({"data-test-subj":e})=>i.a.createElement(o.a,null,i.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":e,size:"l"}))));s.displayName="ManagementPageLoader"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="_id"},function(e,t,n){"use strict";n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"f",(function(){return O}));var a=n(19),i=n(44),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(134),u=n(1106);const d="source.geo.continent_name",p="source.geo.country_name",m="source.geo.country_iso_code",f="source.geo.region_name",g="source.geo.city_name",b="destination.geo.continent_name",y="destination.geo.country_name",h="destination.geo.country_iso_code",v="destination.geo.region_name",E="destination.geo.city_name",x=[{prop:"GeoContinentName",fieldName:"geo.continent_name"},{prop:"GeoCountryName",fieldName:"geo.country_name"},{prop:"GeoCountryIsoCode",fieldName:"geo.country_iso_code"},{prop:"GeoRegionName",fieldName:"geo.region_name"},{prop:"GeoCityName",fieldName:"geo.city_name"}],j=l()(a.EuiFlexItem).withConfig({displayName:"GeoFlexItem",componentId:"sc-19jrcd0-0"})(["margin-right:5px;"]);j.displayName="GeoFlexItem";const S=o.a.memo((({contextId:e,eventId:t,fieldName:n,isDraggable:r,values:s})=>null!=s?o.a.createElement(o.a.Fragment,null,Object(i.uniq)(s).map((i=>o.a.createElement(j,{grow:!1,key:`${e}-${t}-${n}-${i}`},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n===m||n===h?o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(u.a,{countryCode:i})):null,o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(c.b,{"data-test-subj":n,field:n,id:`geo-field-values-default-draggable-${e}-${t}-${n}-${i}`,isDraggable:r,tooltipContent:n,value:i}))))))):null));S.displayName="GeoFieldValues";const O=o.a.memo((e=>{const{contextId:t,eventId:n,isDraggable:r,type:s}=e,l=(e=>x.map((({prop:t,fieldName:n})=>({prop:`${e}${t}`,fieldName:`${e}.${n}`}))))(s);return o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(i.uniq)(l).map((a=>o.a.createElement(S,{contextId:t,eventId:n,fieldName:a.fieldName,isDraggable:r,key:a.fieldName,values:Object(i.get)(a.prop,e)}))))}));O.displayName="GeoFields"},function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(19),i=n(44),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(134),u=n(520),d=n(151),p=n(1430);const m="event.start",f="event.end",g=l()(a.EuiIcon).withConfig({displayName:"TimeIcon",componentId:"sc-181wv62-0"})(["margin-right:3px;position:relative;top:-1px;"]);g.displayName="TimeIcon";const b=o.a.memo((({contextId:e,eventDuration:t,eventId:n,eventEnd:r,eventStart:s,isDraggable:l})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"duration-and-start-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=t?Object(i.uniq)(t).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:u.b,id:`duration-event-start-end-default-draggable-${e}-${n}-${u.b}-${t}`,isDraggable:l,name:name,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(p.a,{maybeDurationNanoseconds:t,tooltipTitle:u.b})))))):null,null!=s?Object(i.uniq)(s).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:m,id:`duration-event-start-end-default-draggable-${e}-${n}-${m}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:m,value:t})))))):null,null!=r?Object(i.uniq)(r).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:f,id:`duration-event-start-end-default-draggable-${e}-${n}-${f}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:f,value:t})))))):null)));b.displayName="DurationEventStartEnd"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(134),o=n(150);const s=({args:e,contextId:t,eventId:n,processTitle:a,isDraggable:s})=>Object(o.e)(e)&&Object(o.e)(a)?null:i.a.createElement(i.a.Fragment,null,null!=e&&e.map(((e,a)=>i.a.createElement(o.c,{key:`${t}-args-${a}-${e}`,grow:!1,component:"span"},i.a.createElement(r.c,{contextId:`${t}-args-${a}-${e}`,eventId:n,field:"process.args",isDraggable:s,value:e,fieldType:"keyword",isAggregatable:!0})))),!Object(o.e)(a)&&i.a.createElement(o.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:t,eventId:n,field:"process.title",isDraggable:s,value:a,fieldType:"keyword",isAggregatable:!0})));s.displayName="ArgsComponent";const l=i.a.memo(s);l.displayName="Args"},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"l",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"e",(function(){return y}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.timeline.body.openSessionViewLabel",{defaultMessage:"Open Session View"}),r=a.i18n.translate("xpack.securitySolution.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.notes.addNoteTooltip",{defaultMessage:"Add Note"}),s=({notesCount:e})=>a.i18n.translate("xpack.securitySolution.timeline.body.notes.addNote.multipleNotesAvailableTooltip",{values:{notesCount:e},defaultMessage:"{notesCount} {notesCount, plural, one {Note} other {Notes}  } available. Click to view {notesCount, plural, one {it} other {them}} & add more."}),l=a.i18n.translate("xpack.securitySolution.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),c=a.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),u=a.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsAriaLabel",{defaultMessage:"View details"}),d=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),p=a.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),m=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Analyze the alert or event in row {ariaRowindex}, with columns {columnValues}"}),f=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.sendAlertToTimelineForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Send the alert in row {ariaRowindex} to timeline, with columns {columnValues}"}),g=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.addNotesForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Add notes for the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),b=({ariaRowindex:e,columnValues:t,isEventPinned:n})=>a.i18n.translate("xpack.securitySolution.hoverActions.pinEventForRowAriaLabel",{defaultMessage:"{isEventPinned, select, true {Unpin} other {Pin} } the event in row {ariaRowindex} to timeline, with columns {columnValues}",values:{ariaRowindex:e,columnValues:t,isEventPinned:n}}),y=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.hoverActions.moreActionsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Select more actions for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewListDetailActionLabel",{defaultMessage:"View list detail"}),r=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewRuleDetailActionLabel",{defaultMessage:"View rule detail"}),o=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.link_column",{defaultMessage:"Link"}),s=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.name_column",{defaultMessage:"Name"}),l=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.action_column",{defaultMessage:"Action"}),c=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.tags_column",{defaultMessage:"Tags"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(1532),i=n(1533),r=n(5);const o=Object(a.a)((async({name:e,description:t,http:n,signal:a})=>await n.post(r.Mc,{version:"2023-10-31",body:JSON.stringify({name:e,description:t}),headers:{"Content-Type":"application/json"},method:"POST",signal:a}))),s=()=>Object(i.a)(o)},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.edit.label",{defaultMessage:"Edit rule exception"}),r=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.edit.label",{defaultMessage:"Edit endpoint exception"}),o=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.delete.label",{defaultMessage:"Delete rule exception"}),s=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.delete.label",{defaultMessage:"Delete endpoint exception"}),l=a.i18n.translate("xpack.securitySolution.exceptions.list.utility.title",{defaultMessage:"rule exceptions"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(1334),r=n(1314),o=n(19),s=n(144),l=n(5),c=n(599),u=n(221),d=n(884),p=n(780);const m=({exceptionsList:e,handleExport:t,handleDelete:n,handleDuplicate:m,handleManageRules:f})=>{const[g,b]=Object(a.useState)(r.a.LOADING),[y,h]=Object(a.useState)(),[v,E]=Object(a.useState)(!1),[x,j]=Object(a.useState)(!1),[S,O]=Object(a.useState)(null),{name:k,list_id:w,rules:T,type:I,created_by:M,created_at:C,description:_}=e,D=Object(a.useCallback)((()=>{b("")}),[b]),A=e=>{h(e),j(!0)},{lastUpdated:F,exceptionViewerStatus:N,exceptions:P,pagination:R,ruleReferences:L,fetchItems:z,onDeleteException:q,onPaginationChange:B}=Object(c.a)({list:e,deleteToastTitle:u.u,deleteToastBody:e=>u.t(e),errorToastBody:u.p,errorToastTitle:u.q,onEditListExceptionItem:A,onFinishFetchingExceptions:D});Object(a.useEffect)((()=>{z(null,r.a.LOADING)}),[z]);const[$,V]=Object(a.useState)(!1),U=Object(o.useGeneratedHtmlId)({prefix:"openAccordion"}),G=Object(d.a)(e),H=Object(a.useMemo)((()=>g===r.a.EMPTY?u.B:""),[g]),W=Object(a.useMemo)((()=>g===r.a.EMPTY?u.y(e.name):""),[e.name,g]),Q=Object(a.useMemo)((()=>e.type===i.a.ENDPOINT?u.A:u.z),[e.type]),Y=Object(a.useMemo)((()=>[{key:"Export",icon:"exportAction",label:u.O,onClick:n=>{I===i.a.ENDPOINT?t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:!0})():O(p.a.EXPORT)}},{key:"Duplicate",icon:"copy",label:u.k,disabled:G,onClick:e=>{O(p.a.DUPLICATE)}},{key:"Delete",icon:"trash",disabled:G,label:u.j,onClick:t=>{n({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"LinkRules",icon:"gear",disabled:G,label:u.X,onClick:e=>{f()}}]),[G,I,t,e.id,e.list_id,e.name,e.namespace_type,n,f]),K=Object(a.useCallback)((()=>{E(!0)}),[E]),J=Object(a.useCallback)((e=>{E(!1),j(!1),e&&z()}),[z,E,j]),Z=Object(a.useCallback)((()=>{O(p.a.EXPORT)}),[O]),X=Object(a.useCallback)((n=>{S===p.a.EXPORT&&t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:n})(),S===p.a.DUPLICATE&&m({listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:n})()}),[S,t,e.id,e.list_id,e.name,e.namespace_type,m]),{onClick:ee}=Object(s.o)()({deepLinkId:l.Oc.exceptions,path:`/details/${e.list_id}`});return{listId:w,listName:k,listDescription:_,createdAt:new Date(C).toDateString(),createdBy:M,listRulesCount:T.length.toString(),exceptionItemsCount:R.totalItemCount.toString(),listType:I,menuActionItems:Y,showAddExceptionFlyout:v,toggleAccordion:$,openAccordionId:U,viewerStatus:g,exceptionToEdit:y,showEditExceptionFlyout:x,lastUpdated:F,exceptions:P,ruleReferences:L,pagination:R,exceptionViewerStatus:N,onEditExceptionItem:A,onDeleteException:q,onPaginationChange:B,setToggleAccordion:V,onAddExceptionClick:K,handleConfirmExceptionFlyout:J,handleCancelExceptionItemFlyout:()=>{E(!1),j(!1)},goToExceptionDetail:ee,emptyViewerTitle:H,emptyViewerBody:W,emptyViewerButtonText:Q,showIncludeExpiredExceptionsModal:S,onExportListClick:Z,handleCancelExpiredExceptionsModal:()=>{O(null)},handleConfirmExpiredExceptionsModal:X}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(1314),r=n(118),o=n(627);const s=({list:e,deleteToastTitle:t,deleteToastBody:n,errorToastTitle:s,errorToastBody:l,onEditListExceptionItem:c,onFinishFetchingExceptions:u})=>{const{services:d}=Object(r.j)(),{http:p}=d,m=Object(r.n)(),[f,g]=Object(a.useState)([]),[b,y]=Object(a.useState)({}),[h,v]=Object(a.useState)({pageIndex:0,pageSize:0,totalItemCount:0}),[E,x]=Object(a.useState)(null),[j,S]=Object(a.useState)(""),O=Object(a.useCallback)(((e,t,n)=>{null==m||m.addError(e,{title:t||s,toastMessage:n||l}),S(i.a.ERROR)}),[l,s,m]),k=Object(a.useCallback)((async()=>{try{const t=await Object(o.c)([e]);y(t)}catch(e){O(e)}}),[O,e,y]),w=Object(a.useCallback)(((e,t,n)=>{v(e),x(Date.now()),setTimeout((()=>{if(n===i.a.EMPTY_SEARCH)return S(t?"":n);S(t?"":i.a.EMPTY)}),200)}),[]),T=Object(a.useCallback)((async(t,n)=>{try{S(i.a.LOADING);const{data:a,pagination:r}=await Object(o.b)({http:p,...Object(o.g)(null,e,t)});g(a),k(),w(r,a.length,n),"function"==typeof u&&u()}catch(e){O(e)}}),[p,e,k,w,u,O]),I=Object(a.useCallback)((async({id:e,name:a,namespaceType:r})=>{try{S(i.a.LOADING),await Object(o.a)({id:e,http:p,namespaceType:r}),null==m||m.addSuccess({title:t,text:"function"==typeof n?n(a):""}),T()}catch(e){O(e)}}),[p,m,t,n,T,O]),M=Object(a.useCallback)((async e=>{T(e)}),[T]);return{exceptions:f,lastUpdated:E,pagination:h,exceptionViewerStatus:j,ruleReferences:b,fetchItems:T,onDeleteException:I,onEditExceptionItem:e=>{"function"==typeof c&&c(e)},onPaginationChange:M}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(168),i=n(1532),r=n(1533);const o=Object(i.a)((async({file:e,http:t,signal:n,overwrite:i,overwriteExceptions:r,asNewList:o})=>{const s=new FormData;return s.append("file",e),await t.post(`${a.s}/_import`,{version:"2023-10-31",body:s,query:{overwrite:i,overwrite_exceptions:r,as_new_list:o},headers:{"Content-Type":void 0},method:"POST",signal:n})})),s=()=>Object(r.a)(o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(1334),r=n(1314),o=n(221),s=n(795);const l=(e,t)=>{const[n,l]=Object(a.useState)(!1),[c,u]=Object(a.useState)(!1),[d,p]=Object(a.useState)(),[m,f]=Object(a.useState)(r.a.LOADING),g=Object(a.useCallback)((()=>{f("")}),[f]),b=e=>{p(e),u(!0)},{exceptionViewerStatus:y,exceptions:h,lastUpdated:v,pagination:E,ruleReferences:x,fetchItems:j,onDeleteException:S,onPaginationChange:O}=Object(s.b)({list:e,deleteToastTitle:o.u,deleteToastBody:e=>o.t(e),errorToastBody:o.p,errorToastTitle:o.q,onEditListExceptionItem:b,onFinishFetchingExceptions:g});Object(a.useEffect)((()=>{j(null,r.a.LOADING)}),[j,t]);const k=Object(a.useMemo)((()=>m===r.a.EMPTY?o.B:""),[m]),w=Object(a.useMemo)((()=>m===r.a.EMPTY?o.y(e.name):""),[e.name,m]),T=Object(a.useMemo)((()=>e.type===i.a.ENDPOINT?o.A:o.z),[e.type]),I=Object(a.useCallback)((async e=>{f(r.a.SEARCHING),j(e,r.a.EMPTY_SEARCH)}),[j,f]),M=Object(a.useCallback)((()=>{l(!0),j()}),[j,l]),C=Object(a.useCallback)((e=>{l(!1),u(!1),e&&j()}),[j,l,u]);return{exceptionViewerStatus:y,listName:e.name,exceptions:h,listType:e.type,lastUpdated:v,pagination:E,viewerStatus:m,emptyViewerTitle:k,emptyViewerBody:w,emptyViewerButtonText:T,ruleReferences:x,showAddExceptionFlyout:n,showEditExceptionFlyout:c,exceptionToEdit:d,onSearch:I,onAddExceptionClick:M,onDeleteException:S,onEditExceptionItem:b,onPaginationChange:O,handleCancelExceptionItemFlyout:()=>{l(!1),u(!1)},handleConfirmExceptionFlyout:C}}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(175),i=n(379);const r=({dataFormattedForFieldBrowser:e})=>{const t=Object(a.b)(e),{loading:n,error:r,rule:o}=Object(i.a)(t.ruleId);return{loading:n,error:r,basicAlertData:t,ruleNote:null==o?void 0:o.note}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return C}));var a=n(851),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(42),c=n(1216),u=n(122),d=n(228),p=n(16),m=n(263),f=n(628),g=n(153),b=n(125),y=n(302),h=n(130),v=n(149),E=n(118),x=n(229),j=n(288),S=n(318),O=n(287),k=n(319);const w="prevalence",T="now-30d",I=()=>{const{euiTheme:e}=Object(s.useEuiTheme)();return o.a.createElement("div",{"data-test-subj":g.E,style:{height:"16px",width:"100%",background:e.colors.lightShade}})},M=[{field:"field",name:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.fieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":g.A,render:e=>o.a.createElement(s.EuiText,{size:"xs"},e),width:"20%"},{name:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.valueColumnLabel",defaultMessage:"Value"}),"data-test-subj":g.H,render:e=>o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.values.map((t=>e.isPreviewEnabled&&e.field===x.g?o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiLink,{"data-test-subj":g.B,onClick:()=>e.openHostPreview(t)},o.a.createElement(s.EuiText,{size:"xs"},t))):e.isPreviewEnabled&&e.field===x.p?o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiLink,{"data-test-subj":g.F,onClick:()=>e.openUserPreview(t)},o.a.createElement(s.EuiText,{size:"xs"},t))):o.a.createElement(s.EuiFlexItem,{key:t},o.a.createElement(s.EuiText,{size:"xs"},t))))),width:"20%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnTooltip",defaultMessage:"Total number of alerts with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnLabel",defaultMessage:"Alert"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":g.y,render:e=>{const t=e.values.map((t=>Object(y.a)(e.field,`timeline-indicator-${e.field}-${t}`,t)));return e.alertCount>0?o.a.createElement(m.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to}},o.a.createElement(d.a,{count:e.alertCount})):Object(h.d)()},width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnTooltip",defaultMessage:"Total number of event documents with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnLabel",defaultMessage:"Document"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":g.z,render:e=>{const t=e.values.map((t=>({...Object(y.a)(e.field,`timeline-indicator-${e.field}-${t}`,t),and:[Object(y.b)("event.kind","timeline-indicator-event.kind-not-signal","signal",v.e,!0)]})));return e.docCount>0?o.a.createElement(m.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to},keepDataView:!0},o.a.createElement(d.a,{count:e.docCount})):Object(h.d)()},width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnTooltip",defaultMessage:"Percentage of unique hosts with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnLabel",defaultMessage:"Host"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":g.C,render:e=>o.a.createElement(o.a.Fragment,null,e.isPlatinumPlus?o.a.createElement(s.EuiText,{size:"xs"},`${Math.round(100*e.hostPrevalence)}%`):o.a.createElement(I,null)),width:"10%"},{name:o.a.createElement(s.EuiToolTip,{content:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnTooltip",defaultMessage:"Percentage of unique users with identical field value pairs."})},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnLabel",defaultMessage:"User"})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":g.G,render:e=>o.a.createElement(o.a.Fragment,null,e.isPlatinumPlus?o.a.createElement(s.EuiText,{size:"xs"},`${Math.round(100*e.userPrevalence)}%`):o.a.createElement(I,null)),width:"10%"}],C=()=>{const{dataFormattedForFieldBrowser:e,investigationFields:t,scopeId:n}=Object(b.b)(),{openPreviewPanel:a}=Object(c.a)(),{telemetry:d}=Object(E.j)().services,m=Object(p.b)().isPlatinumPlus(),y=!Object(u.a)("entityAlertPreviewDisabled"),[h,v]=Object(r.useState)(T),[x,w]=Object(r.useState)("now"),[I,C]=Object(r.useState)((i.a.parse(T)||new Date).toISOString()),[_,D]=Object(r.useState)((i.a.parse("now")||new Date).toISOString()),{loading:A,error:F,data:N}=Object(f.a)({dataFormattedForFieldBrowser:e,investigationFields:t,interval:{from:h,to:x}}),P=Object(r.useCallback)((e=>{a({id:j.e,params:{hostName:e,scopeId:n,banner:S.a}}),d.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[a,n,d]),R=Object(r.useCallback)((e=>{a({id:O.d,params:{userName:e,scopeId:n,banner:k.a}}),d.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[a,n,d]),L=Object(r.useMemo)((()=>N.map((e=>({...e,from:I,to:_,isPlatinumPlus:m,isPreviewEnabled:y,openHostPreview:P,openUserPreview:R})))),[N,I,_,m,y,P,R]),z=o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiCallOut,{"data-test-subj":g.I},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellDescription",defaultMessage:"Host and user prevalence are only available with a {subscription}.",values:{subscription:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellLinkText",defaultMessage:"Platinum or higher subscription"}))}})),o.a.createElement(s.EuiSpacer,{size:"s"}));return o.a.createElement(o.a.Fragment,null,!F&&!m&&z,o.a.createElement(s.EuiPanel,null,o.a.createElement(s.EuiSuperDatePicker,{start:h,end:x,onTimeChange:({start:e,end:t,isInvalid:n})=>{if(n)return;v(e),w(t);const a=i.a.parse(e);a&&a.isValid()&&C(a.toISOString());const r=i.a.parse(t);r&&r.isValid()&&D(r.toISOString())},"data-test-subj":g.x,width:"full"}),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiInMemoryTable,{items:F?[]:L,columns:M,loading:A,"data-test-subj":g.D,message:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})})))};C.displayName="PrevalenceDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(44),i=n(813),r=n(332),o=n(503),s=n(549);const l=({dataFormattedForFieldBrowser:e,investigationFields:t})=>{var n,l;const c=Object(r.a)(e),u=Object(s.a)(e),d=Object(a.find)({category:"event",field:"event.code"},e),p=Array.isArray(null==d?void 0:d.originalValue)?null==d||null===(n=d.originalValue)||void 0===n?void 0:n[0]:null==d?void 0:d.originalValue,m=Object(a.find)({category:"kibana",field:i.o},e),f=Array.isArray(null==m?void 0:m.originalValue)?null==m||null===(l=m.originalValue)||void 0===l?void 0:l[0]:null==m?void 0:m.originalValue;return Object(s.b)({eventCategories:u,eventCode:p,eventRuleType:f,highlightedFieldsOverride:null!=t?t:[]}).reduce(((t,n)=>{var i,r;const s=e.find((e=>e.field===n.id||n.legacyId&&e.field===n.legacyId));if(!s)return t;const l=s.values;return!l||Object(a.isEmpty)(l)?t:(s.field===n.legacyId&&(n.id=n.legacyId),Object(o.b)(n.id)&&c.details.agentIdField!==n.id?t:{...t,[n.id]:{...n.overrideField&&{overrideField:{field:n.overrideField,values:null!==(i=null===(r=Object(a.find)({field:n.overrideField},e))||void 0===r?void 0:r.values)&&void 0!==i?i:[]}},values:l}})}),{})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=(e,t,n)=>Object.keys(e).map((a=>{var i,r;const o=null===(i=e[a].overrideField)||void 0===i?void 0:i.field,s=null===(r=e[a].overrideField)||void 0===r?void 0:r.values,l=o||a;return{field:l,description:{field:l,...o?{originalField:a}:{},values:null!=s&&s.length?s:e[a].values,scopeId:t,isPreview:n}}})),i=e=>Object.keys(e).reduce(((t,n)=>{const a=e[n].values;return{...t,[n]:{terms:{[n]:a}}}}),[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(352),r=n(131),o=n(234);const s=({entityId:e,scopeId:t})=>{const{loading:n,error:s,count:l,alertIds:c}=Object(i.a)({field:o.c,value:e,isActiveTimelines:Object(r.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0});return Object(a.useMemo)((()=>({loading:n,error:s,data:c||[],dataCount:l||0})),[c,l,s,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(234),r=n(352),o=n(131);const s=({originalEventId:e,scopeId:t})=>{const{loading:n,error:s,count:l,alertIds:c}=Object(r.a)({field:i.a,value:e,isActiveTimelines:Object(o.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0});return Object(a.useMemo)((()=>({loading:n,error:s,data:c||[],dataCount:l||0})),[c,l,s,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(47),i=n(2),r=n(118),o=n(5);const s=({eventId:e})=>{const{services:{cases:t}}=Object(r.j)(),{data:n,isLoading:s,isError:l}=Object(a.useQuery)(["useFetchRelatedCases",e],(()=>t.api.getRelatedCases(e,{owner:o.j})),{keepPreviousData:!0});return Object(i.useMemo)((()=>({loading:s,error:l,data:n||[],dataCount:(null==n?void 0:n.length)||0})),[n,l,s])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(36),i=n(242),r=n(142);const o=({getFieldsData:e})=>{const{cases:t}=Object(i.c)().services,n="signal"===Object(r.a)(e("event.kind")),o=t.helpers.canUseCases([a.APP_ID]);return n&&o.read}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(541),i=n(16),r=n(234),o=n(142);const s=({getFieldsData:e,dataAsNestedObject:t,eventId:n,isPreview:s})=>{var l;const c=Object(a.a)(t),u=null!==(l=Object(o.a)(e(r.a)))&&void 0!==l?l:"",d=s?u:n,p=Object(i.b)().isPlatinumPlus();return{show:c&&p,documentId:d}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(813);const i=({getFieldsData:e})=>{const t=e(a.t),n=t?parseInt(t[0],10):0;return{show:Boolean(t),alertSuppressionCount:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(234),i=n(142);const r=({eventId:e,getFieldsData:t})=>{var n;return{show:!0,originalEventId:null!==(n=Object(i.a)(t(a.a)))&&void 0!==n?n:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(234),i=n(142);const r=({getFieldsData:e})=>{const t=Object(i.a)(e(a.c));return{show:null!=t,...t&&{entityId:t}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(539),r=n(131);const o=({documentId:e,indices:t,scopeId:n})=>{const o=Object(r.isActiveTimeline)(n),{loading:s,error:l,alertIds:c}=Object(i.a)({isActiveTimeline:o,documentId:e,indices:t});return Object(a.useMemo)((()=>({loading:s,error:l,data:c,dataCount:(null==c?void 0:c.length)||0})),[c,l,s])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u}));var a=n(120),i=n(273),r=n(526);let o=function(e){return e.Prebuilt="prebuilt",e.Custom="custom",e}({});const s=a.object({searchTerm:a.string(),source:a.nativeEnum(o),tags:a.array(a.string()),enabled:a.boolean(),ruleExecutionStatus:i.e}).partial(),l=r.b.pick({field:!0,order:!0}).partial(),c=r.a.pick({perPage:!0}).partial(),u=r.a.pick({page:!0,perPage:!0}).partial()},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.disabledTitle",{defaultMessage:"Disabled"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Enabled"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),d=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:e},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}),p=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}),m=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:e,requiredVersion:t},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return We})),n.d(t,"b",(function(){return Qe})),n.d(t,"a",(function(){return Ye}));var a=n(47),i=n(412),r=n(118),o=n(167);const s=(e,t={})=>{const n=Object(r.i)();return Object(a.useQuery)({queryKey:["get-endpoint-host-info",e],...t,queryFn:()=>n.get(Object(i.a)(o.r,{id:e.trim()||"undefined"}),{version:"2023-10-31"})})};var l=n(2),c=n.n(l),u=n(19),d=n(10),p=n(16),m=n(505),f=n(725),g=n(41),b=n.n(g),y=n(42),h=n(1203),v=n(126),E=n(1388),x=n.n(E),j=n(1389),S=n.n(j),O=n(1390),k=n.n(O);const w=Object(l.memo)((({platform:e,size:t="xl","data-test-subj":n})=>{const a=Object(l.useMemo)((()=>(e=>{switch(e){case"macos":return k.a;case"linux":return x.a;case"windows":return S.a;default:return null}})(e)),[e]);return c.a.createElement(u.EuiIcon,{type:a||"empty",title:e,size:t,"data-test-subj":n})}));w.displayName="PlatformIcon";const T=Object(l.memo)((({platform:e,hostName:t,lastCheckin:n,agentType:a,"data-test-subj":i,children:r})=>{const{euiTheme:o}=Object(u.useEuiTheme)(),s=Object(v.a)(i);return c.a.createElement(u.EuiFlexGroup,{gutterSize:"s",responsive:!1,alignItems:"center","data-test-subj":s("agentInfo")},c.a.createElement(u.EuiFlexItem,{grow:!1},c.a.createElement(w,{"data-test-subj":s("platformIcon"),platform:e})),c.a.createElement(u.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},c.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"xs"},c.a.createElement(u.EuiFlexItem,{grow:!1},c.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},c.a.createElement(u.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},c.a.createElement(u.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},c.a.createElement(u.EuiText,{size:"s","data-test-subj":s("hostName"),className:"eui-textTruncate"},c.a.createElement("h6",{className:"eui-textTruncate"},t)))),c.a.createElement(u.EuiFlexItem,{grow:!1},r))),c.a.createElement(u.EuiFlexItem,{grow:!1},c.a.createElement(u.EuiText,{color:"subdued",size:"s","data-test-subj":s("lastSeen")},c.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.responder.header.lastSeen",defaultMessage:"Last seen {date}",values:{date:c.a.createElement(y.FormattedRelative,{value:n})}}))))),a&&c.a.createElement(I,{grow:!1,$_css:o.size.l},c.a.createElement(h.a,{agentType:a,"data-test-subj":s("integration")})))}));T.displayName="HeaderAgentInfo";var I=b()(u.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-16ud3nj-0"})((e=>({paddingLeft:e.$_css})));const M=Object(l.memo)((({agentId:e,platform:t,hostName:n,agentType:a})=>{const{data:i}=Object(f.a)(e,a),r=null==i?void 0:i[e],o=r?r.lastSeen:"";return c.a.createElement(T,{platform:t.toLowerCase(),hostName:n,lastCheckin:o,agentType:a,"data-test-subj":"responseConsole"},c.a.createElement(m.a,{agentId:e,agentType:a,"data-test-subj":`responderHeader-${a}-agentIsolationStatus`}))}));M.displayName="AgentInfo";var C=n(140),_=n(4),D=n(503),A=n(586),F=n(1262),N=n(1213),P=n(119),R=n.n(P),L=n(1221);const z=Object(l.memo)((({action:e,ResultComponent:t,title:n,...a})=>{const i=Object(l.useMemo)((()=>{var t,a,i;if(n)return n;const r=e.agents[0],o=null===(t=e.outputs)||void 0===t||null===(a=t[r])||void 0===a||null===(i=a.content)||void 0===i?void 0:i.code;return o?L.a[o]:void 0}),[n,e.agents,e.outputs]);return c.a.createElement(t,R()({},a,{title:i,agentType:e.agentType}))}));z.displayName="ActionSuccess";var q=n(885);const B=Object(l.memo)((({title:e,dataTestSubj:t,action:n,ResultComponent:a})=>c.a.createElement(a,{showAs:"failure",title:e,"data-test-subj":t},c.a.createElement(q.a,{action:n}))));B.displayName="ActionError";var $=n(790);const V=({actionCreator:e,actionRequestBody:t,setStatus:n,status:s,setStore:u,store:d,ResultComponent:p,dataTestSubj:m,pendingMessage:f,successMessage:g})=>{const b=Object(N.a)(),h=Object(v.a)(m),E="pending"===s,x=Object(l.useMemo)((()=>{var e;return null!==(e=d.actionApiState)&&void 0!==e?e:{request:{sent:!1,error:void 0,actionId:void 0},actionDetails:void 0,actionDetailsError:void 0}}),[d.actionApiState]),{actionDetails:j,actionDetailsError:S}=x,{actionId:O,sent:k,error:w}=x.request,{data:T,error:I}=((e,t={})=>{const n=Object(r.i)();return Object(a.useQuery)({queryKey:["get-action-details",e],...t,queryFn:()=>n.get(Object(i.a)(o.c,{action_id:e.trim()||"undefined"}),{version:"2023-10-31"})})})(null!=O?O:"-",{enabled:Boolean(O)&&E,refetchInterval:!!E&&3e3});return Object(l.useEffect)((()=>{if(!k&&t&&b()){const n={...x.request,sent:!0};e.mutateAsync(t).then((e=>{n.actionId=e.data.id})).catch((e=>{n.error=e})).finally((()=>{b()&&u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,request:{...n}}}}))})),u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,request:n}}}))}}),[e,t,k,x,b,u]),Object(l.useEffect)((()=>{w&&E&&n("error")}),[w,E,n]),Object(l.useEffect)((()=>{I&&E&&(n("error"),u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,actionDetails:void 0,actionDetailsError:I}}})))}),[I,x,E,n,u]),Object(l.useEffect)((()=>{null!=T&&T.data.isCompleted&&E&&(n(null!=T&&T.data.wasSuccessful?"success":"error"),u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,actionDetails:T.data}}})))}),[T,x,E,n,u]),{result:Object(l.useMemo)((()=>{if(E)return c.a.createElement(p,{showAs:"pending","data-test-subj":h("pending")},f);const e=w||S;return e?c.a.createElement(p,{showAs:"failure","data-test-subj":h("apiFailure")},c.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.actionSubmitter.apiErrorDetails",defaultMessage:"The following error was encountered:"}),c.a.createElement($.a,{error:e,"data-test-subj":h("apiErrorDetails")})):j?j.errors?c.a.createElement(B,{ResultComponent:p,action:j,dataTestSubj:h("actionFailure")}):c.a.createElement(z,{ResultComponent:p,action:j,"data-test-subj":h("success"),title:g}):c.a.createElement(c.a.Fragment,null)}),[E,w,S,j,p,h,f,g]),actionDetails:x.actionDetails}},U=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:s,ResultComponent:u})=>{var d,p;const m=(e=>{const t=Object(r.i)();return Object(a.useMutation)((({file:e,...n})=>{const a=new FormData;a.append("file",e,e.name);for(const[e,t]of Object.entries(n))void 0!==t&&a.append(e,"string"!=typeof t?JSON.stringify(t):t);return t.post(o.C,{body:a,version:"2023-10-31",headers:{"Content-Type":void 0}})}),void 0)})(),f=Object(l.useMemo)((()=>{var t,n;const a=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,{comment:i,overwrite:r,file:o}=e.args.args;if(a)return{endpoint_ids:[a],...null!=i&&i[0]?{comment:null==i?void 0:i[0]}:{},parameters:void 0!==r?{overwrite:null==r?void 0:r[0]}:{},file:o[0]}}),[e.args.args,null===(d=e.commandDefinition)||void 0===d||null===(p=d.meta)||void 0===p?void 0:p.endpointId]),{result:g,actionDetails:b}=V({ResultComponent:u,setStore:t,store:n,status:i,setStatus:s,actionCreator:m,actionRequestBody:f,dataTestSubj:"upload"});return null!=b&&b.isCompleted&&b.wasSuccessful?c.a.createElement(u,null,c.a.createElement(F.a,{action:b})):g}));U.displayName="UploadActionResult";const G=_.i18n.translate("xpack.securitySolution.consoleArgumentSelectors.fileSelector.initialDisplayLabel",{defaultMessage:"Click to select file"}),H=_.i18n.translate("xpack.securitySolution.consoleArgumentSelectors.fileSelector.filePickerButtonLabel",{defaultMessage:"Open file picker"}),W=_.i18n.translate("xpack.securitySolution.consoleArgumentSelectors.fileSelector.noFileSelected",{defaultMessage:"No file selected"}),Q=Object(l.memo)((({value:e,valueText:t,onChange:n,store:a})=>{const i=Object(l.useMemo)((()=>null!=a?a:{isPopoverOpen:!0}),[a]),r=Object(l.useCallback)((a=>{n({value:e,valueText:t,store:{...i,isPopoverOpen:a}})}),[n,i,e,t]),o=Object(l.useMemo)((()=>Object(u.htmlIdGenerator)("console")()),[]),s=Object(l.useCallback)((()=>{r(!0)}),[r]),d=Object(l.useCallback)((()=>{r(!1)}),[r]),p=Object(l.useCallback)((e=>{const t=null==e?void 0:e.item(0);n({value:null!=t?t:void 0,valueText:t?t.name:"",store:{...i,isPopoverOpen:!1}})}),[n,i]);return c.a.createElement("div",null,c.a.createElement(u.EuiPopover,{isOpen:i.isPopoverOpen,closePopover:d,anchorPosition:"upCenter",initialFocus:`#${o}`,button:c.a.createElement(u.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none"},c.a.createElement(u.EuiFlexItem,{grow:!1,className:"eui-textTruncate",onClick:s},c.a.createElement("div",{className:"eui-textTruncate",title:t||W},t||G)),c.a.createElement(u.EuiFlexItem,{grow:!1},c.a.createElement(u.EuiButtonIcon,{iconType:"folderOpen",size:"xs",onClick:s,"aria-label":H})))},i.isPopoverOpen&&c.a.createElement(u.EuiFilePicker,{id:o,onChange:p,fullWidth:!0,display:"large","data-test-subj":"console-arg-file-picker"})))}));Q.displayName="ArgumentFileSelector";var Y=n(24),K=n(174),J=n(869);const Z=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:s,ResultComponent:u})=>{var d,p,m,f;const{canWriteFileOperations:g}=Object(C.a)().endpointPrivileges,b=Object(a.useMutation)((e=>r.b.get().http.post(o.p,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const y=Object(l.useMemo)((()=>{var t,n,a,i;const r=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,{path:o,comment:s}=e.args.args,l=null===(a=e.commandDefinition)||void 0===a||null===(i=a.meta)||void 0===i?void 0:i.agentType;return r?{agent_type:l,endpoint_ids:[r],comment:null==s?void 0:s[0],parameters:{path:o[0]}}:void 0}),[e.args.args,null===(d=e.commandDefinition)||void 0===d||null===(p=d.meta)||void 0===p?void 0:p.agentType,null===(m=e.commandDefinition)||void 0===m||null===(f=m.meta)||void 0===f?void 0:f.endpointId]),{result:h,actionDetails:v}=V({ResultComponent:u,setStore:t,store:n,status:i,setStatus:s,actionCreator:b,actionRequestBody:y,dataTestSubj:"getFile",pendingMessage:_.i18n.translate("xpack.securitySolution.getFileAction.pendingMessage",{defaultMessage:"Retrieving the file from host."})});return null!=v&&v.isCompleted&&v.wasSuccessful?c.a.createElement(u,{showAs:"success","data-test-subj":"getFileSuccess",title:_.i18n.translate("xpack.securitySolution.endpointResponseActions.getFileAction.successTitle",{defaultMessage:"File retrieved from the host."})},c.a.createElement(J.a,{action:v,canAccessFileDownloadLink:g})):h}));Z.displayName="GetFileActionResult";var X=n(122),ee=n(428);const te=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:r,ResultComponent:o})=>{var s,c,u,d,p;const m=Object(X.a)("responseActionsSentinelOneV1Enabled"),f=Object(a.useMutation)((e=>Object(ee.a)(e)),undefined);const g=Object(l.useMemo)((()=>{var t,n,a,i,r,o;const s=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,l=null===(a=e.args.args)||void 0===a||null===(i=a.comment)||void 0===i?void 0:i[0],c=null===(r=e.commandDefinition)||void 0===r||null===(o=r.meta)||void 0===o?void 0:o.agentType;return s?{agent_type:m?c:void 0,endpoint_ids:[s],comment:l}:void 0}),[null===(s=e.args.args)||void 0===s?void 0:s.comment,null===(c=e.commandDefinition)||void 0===c||null===(u=c.meta)||void 0===u?void 0:u.agentType,null===(d=e.commandDefinition)||void 0===d||null===(p=d.meta)||void 0===p?void 0:p.endpointId,m]);return V({ResultComponent:o,setStore:t,store:n,status:i,setStatus:r,actionCreator:f,actionRequestBody:g,dataTestSubj:"isolate"}).result}));te.displayName="IsolateActionResult";const ne=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:r,ResultComponent:o})=>{var s,c,u,d,p;const m=Object(X.a)("responseActionsSentinelOneV1Enabled"),f=Object(a.useMutation)((e=>Object(ee.b)(e)),undefined);const g=Object(l.useMemo)((()=>{var t,n,a,i,r,o;const s=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,l=null===(a=e.args.args)||void 0===a||null===(i=a.comment)||void 0===i?void 0:i[0],c=null===(r=e.commandDefinition)||void 0===r||null===(o=r.meta)||void 0===o?void 0:o.agentType;return s?{agent_type:m?c:void 0,endpoint_ids:[s],comment:l}:void 0}),[null===(s=e.args.args)||void 0===s?void 0:s.comment,null===(c=e.commandDefinition)||void 0===c||null===(u=c.meta)||void 0===u?void 0:u.agentType,null===(d=e.commandDefinition)||void 0===d||null===(p=d.meta)||void 0===p?void 0:p.endpointId,m]);return V({ResultComponent:o,setStore:t,store:n,status:i,setStatus:r,actionCreator:f,actionRequestBody:g,dataTestSubj:"release"}).result}));ne.displayName="ReleaseActionResult";const ae=e=>{var t,n;return e.pid?{pid:Number(e.pid[0])}:{entity_id:null!==(t=null==e||null===(n=e.entityId)||void 0===n?void 0:n[0])&&void 0!==t?t:""}},ie=/^\d+(?=(h|m|s){1}$)/,re=e=>{const t=null==e?void 0:e.trim().match(ie);var n,a;if(t)return n=Number(t[0]),a=t[1],(e=>({h:()=>60*e*60,m:()=>60*e,s:()=>e}))(n)[a]()},oe=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:s,ResultComponent:c})=>{var u,d;const p=Object(a.useMutation)((e=>{return t=e,r.b.get().http.post(o.u,{body:JSON.stringify(t),version:"2023-10-31"});var t}),f),m=Object(l.useMemo)((()=>{var t,n,a,i;const r=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,o=ae(e.args.args);return r?{endpoint_ids:[r],comment:null===(a=e.args.args)||void 0===a||null===(i=a.comment)||void 0===i?void 0:i[0],parameters:o}:void 0}),[e.args.args,null===(u=e.commandDefinition)||void 0===u||null===(d=u.meta)||void 0===d?void 0:d.endpointId]);var f;return V({ResultComponent:c,setStore:t,store:n,status:i,setStatus:s,actionCreator:p,actionRequestBody:m,dataTestSubj:"killProcess"}).result}));oe.displayName="KillProcessActionResult";const se=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:s,ResultComponent:c})=>{var u,d;const p=Object(a.useMutation)((e=>{return t=e,r.b.get().http.post(o.A,{body:JSON.stringify(t),version:"2023-10-31"});var t}),f),m=Object(l.useMemo)((()=>{var t,n,a,i;const r=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,o=ae(e.args.args);return r?{endpoint_ids:[r],comment:null===(a=e.args.args)||void 0===a||null===(i=a.comment)||void 0===i?void 0:i[0],parameters:o}:void 0}),[e.args.args,null===(u=e.commandDefinition)||void 0===u||null===(d=u.meta)||void 0===d?void 0:d.endpointId]);var f;return V({ResultComponent:c,setStore:t,store:n,status:i,setStatus:s,actionCreator:p,actionRequestBody:m,dataTestSubj:"suspendProcess"}).result}));se.displayName="SuspendProcessActionResult";var le=n(50),ce=n(1219),ue=n(883),de=n(151),pe=n(900),me=n(1220);const fe=Object(l.memo)((({command:e,status:t,setStatus:n,store:i,setStore:r,ResultComponent:o})=>{var d,p;const m=null===(d=e.commandDefinition)||void 0===d||null===(p=d.meta)||void 0===p?void 0:p.endpointId,{endpointPendingActions:f,endpointDetails:g,detailsFetchError:b,apiCalled:y}=i,h="pending"===t,v=Object(l.useMemo)((()=>Object(le.v4)()),[]),{data:E,error:x,isFetching:j,isFetched:S}=s(m,{enabled:h,queryKey:[v]}),{data:O}=((e,t={})=>Object(a.useQuery)({queryKey:["fetch-endpoint-pending-actions-summary",...e],...t,queryFn:()=>Object(ue.a)(e)}))([m],{enabled:h,queryKey:[v,m]}),k=Object(l.useMemo)((()=>{if(null!=f&&f.data.length){var e,t;const n=f.data[0].pending_actions;return{pendingIsolate:null!==(e=n.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(t=n.unisolate)&&void 0!==t?t:0}}return{pendingIsolate:0,pendingUnIsolate:0}}),[null==f?void 0:f.data]);Object(l.useEffect)((()=>{y||r((e=>({...e,apiCalled:!0})))}),[y,r]),Object(l.useEffect)((()=>{S&&h&&(n(b?"error":"success"),r((e=>({...e,endpointDetails:E,detailsFetchError:null!=x?x:void 0}))))}),[b,S,n,h,r,E,x]),Object(l.useEffect)((()=>{O&&!f&&r((e=>({...e,endpointPendingActions:O})))}),[O,r,f]);const w=Object(l.useCallback)((()=>{if(!g)return;const e=[{title:c.a.createElement(pe.a,null,_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.agentStatus",{defaultMessage:"Agent status"})),description:c.a.createElement(pe.a,null,(()=>{var e;let t="";return k.pendingIsolate>0?t=_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolating",{defaultMessage:"Isolating"}):k.pendingUnIsolate>0?t=_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.releasing",{defaultMessage:"Releasing"}):null!=g&&null!==(e=g.metadata.Endpoint.state)&&void 0!==e&&e.isolation&&(t=_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolated",{defaultMessage:"Isolated"})),`${Object(ce.d)(g.host_status)}${t.length>0?` - ${t}`:""}`})())},{title:c.a.createElement(pe.a,null,_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.platform",{defaultMessage:"Platform"})),description:c.a.createElement(pe.a,null,g.metadata.host.os.full)},{title:c.a.createElement(pe.a,null,_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.version",{defaultMessage:"Version"})),description:g.metadata.agent.version},{title:c.a.createElement(pe.a,null,_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.policyStatus",{defaultMessage:"Policy status"})),description:c.a.createElement(pe.a,null,me.d[g.metadata.Endpoint.policy.applied.status])},{title:c.a.createElement(pe.a,null,_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.appliedPolicyVersion",{defaultMessage:"Policy version"})),description:c.a.createElement(pe.a,null,`v${g.metadata.Endpoint.policy.applied.endpoint_policy_version}`)},{title:c.a.createElement(pe.a,null,_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.policyName",{defaultMessage:"Policy name"})),description:c.a.createElement(pe.a,null,g.metadata.Endpoint.policy.applied.name)},{title:c.a.createElement(pe.a,null,_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"})),description:c.a.createElement(pe.a,null,c.a.createElement(de.a,{fieldName:_.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"}),value:g.last_checkin}))}];return c.a.createElement(u.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:e,"data-test-subj":"agent-status-console-output"})}),[k.pendingIsolate,k.pendingUnIsolate,g]);return b?c.a.createElement(o,{showAs:"failure"},c.a.createElement($.a,{error:b})):j||!g?c.a.createElement(o,{showAs:"pending"}):c.a.createElement(o,{showTitle:!1},w())}));fe.displayName="EndpointStatusActionResult";const ge=b()(u.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-10fx62u-0"})(["table{background-color:transparent;}.euiTableHeaderCell{border-bottom:",";.euiTableCellContent__text{font-weight:",";}}.euiTableRow{&:hover{background-color:"," !important;}.euiTableRowCell{border-top:none !important;border-bottom:none !important;}}"],(e=>e.theme.eui.euiBorderThin),(e=>e.theme.eui.euiFontWeightRegular),(({theme:{eui:e}})=>e.euiColorEmptyShade)),be=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:s,ResultComponent:u})=>{var d,p,m;const f=null===(d=e.commandDefinition)||void 0===d||null===(p=d.meta)||void 0===p?void 0:p.endpointId,g=Object(a.useMutation)((e=>r.b.get().http.post(o.q,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const b=Object(l.useMemo)((()=>{var t,n;return f?{endpoint_ids:[f],comment:null===(t=e.args.args)||void 0===t||null===(n=t.comment)||void 0===n?void 0:n[0]}:void 0}),[f,null===(m=e.args.args)||void 0===m?void 0:m.comment]),{result:y,actionDetails:h}=V({ResultComponent:u,setStore:t,store:n,status:i,setStatus:s,actionCreator:g,actionRequestBody:b,dataTestSubj:"getProcesses"}),v=Object(l.useMemo)((()=>[{field:"user","data-test-subj":"process_list_user",name:_.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.user",{defaultMessage:"USER"}),width:"10%"},{field:"pid","data-test-subj":"process_list_pid",name:_.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.pid",{defaultMessage:"PID"}),width:"5%"},{field:"entity_id","data-test-subj":"process_list_entity_id",name:_.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.enityId",{defaultMessage:"ENTITY ID"}),width:"30%"},{field:"command","data-test-subj":"process_list_command",name:_.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.command",{defaultMessage:"COMMAND"}),width:"55%"}]),[]),E=Object(l.useMemo)((()=>{var e,t,n;return f&&null!==(e=null==h||null===(t=h.outputs)||void 0===t||null===(n=t[f])||void 0===n?void 0:n.content.entries)&&void 0!==e?e:[]}),[null==h?void 0:h.outputs,f]);return h&&h.wasSuccessful?c.a.createElement(u,{"data-test-subj":"getProcessesSuccessCallout",showTitle:!1},c.a.createElement(ge,{"data-test-subj":"getProcessListTable",items:[...E],columns:v})):y}));be.displayName="GetProcessesActionResult";var ye=n(1250);const he=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:s,ResultComponent:u})=>{var d,p,m,f,g;const b=Object(a.useMutation)((e=>r.b.get().http.post(o.o,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const y=Object(l.useMemo)((()=>{var t,n,a,i,r;const o=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId;if(o)return{endpoint_ids:[o],parameters:{command:e.args.args.command[0],timeout:re(null===(a=e.args.args.timeout)||void 0===a?void 0:a[0])},comment:null===(i=e.args.args)||void 0===i||null===(r=i.comment)||void 0===r?void 0:r[0]}}),[null===(d=e.commandDefinition)||void 0===d||null===(p=d.meta)||void 0===p?void 0:p.endpointId,e.args.args.command,e.args.args.timeout,null===(m=e.args.args)||void 0===m?void 0:m.comment]),{result:h,actionDetails:v}=V({ResultComponent:u,setStore:t,store:n,status:i,setStatus:s,actionCreator:b,actionRequestBody:y,dataTestSubj:"execute"});return v&&v.wasSuccessful?c.a.createElement(u,{"data-test-subj":"executeSuccess",showAs:"success",title:_.i18n.translate("xpack.securitySolution.endpointResponseActions.executeAction.successTitle",{defaultMessage:"Command execution was successful."})},c.a.createElement(ye.a,{action:v,canAccessFileDownloadLink:!0,agentId:null===(f=e.commandDefinition)||void 0===f||null===(g=f.meta)||void 0===g?void 0:g.endpointId,textSize:"s","data-test-subj":"console"})):h}));he.displayName="ExecuteActionResult";const ve=_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.args.command.aboutConsecutiveDashes",{defaultMessage:"Multiple consecutive dashes in the value provided must be escaped. Ex:"}),Ee=_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.execute.args.command.aboutQuotes",{defaultMessage:"Quotes provided in the value can be used without escaping. Ex:"}),xe=_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.unsupportedCommandInfo",{defaultMessage:"This version of the Endpoint does not support this command. Upgrade your Agent in Fleet to use the latest response actions."}),je=c.a.memo((()=>c.a.createElement(u.EuiIconTip,{content:xe,type:"warning",color:"danger"})));je.displayName="DisabledTooltip";const Se=({aboutInfo:e,isSupported:t})=>t?e:c.a.createElement(c.a.Fragment,null,e," ",c.a.createElement(je,null));var Oe=n(237);const ke=Object(l.memo)((({command:e,setStore:t,store:n,status:i,setStatus:s,ResultComponent:c})=>{var u,d,p,m;const f=Object(a.useMutation)((e=>r.b.get().http.post(o.y,{body:JSON.stringify(e),version:"2023-10-31"})),undefined);const g=Object(l.useMemo)((()=>{var t,n,a,i;const r=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,{path:o,comment:s}=e.args.args,l=null===(a=e.commandDefinition)||void 0===a||null===(i=a.meta)||void 0===i?void 0:i.agentType;return r?{agent_type:l,endpoint_ids:[r],comment:null==s?void 0:s[0],parameters:{path:o[0]}}:void 0}),[e.args.args,null===(u=e.commandDefinition)||void 0===u||null===(d=u.meta)||void 0===d?void 0:d.agentType,null===(p=e.commandDefinition)||void 0===p||null===(m=p.meta)||void 0===m?void 0:m.endpointId]);return V({ResultComponent:c,setStore:t,store:n,status:i,setStatus:s,actionCreator:f,actionRequestBody:g,dataTestSubj:"scan",pendingMessage:_.i18n.translate("xpack.securitySolution.scanAction.pendingMessage",{defaultMessage:"File path scan is in progress."})}).result}));ke.displayName="ScanActionResult";const we=e=>{var t;return(null==e?void 0:e.length)>0&&"string"==typeof e[0]&&(null===(t=e[0])||void 0===t?void 0:t.trim().length)>0||_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.emptyArgumentMessage",{defaultMessage:"Argument cannot be empty"})},Te=e=>{const t=we(e);return!0!==t?t:!!(Number.isSafeInteger(Number(e))&&Number(e)>0)||_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.invalidPidMessage",{defaultMessage:"Argument must be a positive number representing the PID of a process"})},Ie=e=>{return!(!String(e).trim().length||(t=String(e).trim(),!ie.test(t)))||_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.invalidExecuteTimeout",{defaultMessage:"Argument must be a string with a positive integer value followed by a unit of time (h for hours, m for minutes, s for seconds). Example: 37m."});var t},Me=e=>t=>{const n=t.commandDefinition.meta.privileges,a=t.commandDefinition.meta.capabilities,i=t.commandDefinition.name,r=K.i[i];let o="";return"endpoint"===e&&(r||(o=o.concat(Object(d.m)(e,i))),r&&!a.includes(r)&&(o=o.concat(Object(d.m)(e,i)))),Object(A.a)({commandName:i,privileges:n})||(o=o.concat(d.c)),!o.length||o},Ce=Object.freeze({responseActions:{position:0,label:_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.groups.responseActions",{defaultMessage:"Response actions"})}}),_e=_.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterPidOrEntityId",{defaultMessage:"Enter a pid or an entity id to execute"}),De=_.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterOrAddOptionalComment",{defaultMessage:"Hit enter to execute or add an optional comment"}),Ae=_.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.commandArgAbout",{defaultMessage:"A comment to go along with the action"}),Fe=({endpointAgentId:e,agentType:t,endpointCapabilities:n,endpointPrivileges:a})=>{const i=Y.a.get(),r=i.responseActionUploadEnabled,o=i.responseActionScanEnabled,s=e=>{if("endpoint"!==t)return!0;const a=K.i[e];return!!a&&n.includes(a)},l=[{name:"isolate",about:Se({aboutInfo:Oe.b.isolate.about,isSupported:s("isolate")}),RenderComponent:te,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'isolate --comment "isolate this host"',exampleInstruction:De,validate:Me(t),args:{comment:{required:!1,allowMultiples:!1,about:Ae}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:0,helpDisabled:!1===s("isolate"),helpHidden:!Object(A.a)({commandName:"isolate",privileges:a})},{name:"release",about:Se({aboutInfo:Oe.b.release.about,isSupported:s("release")}),RenderComponent:ne,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'release --comment "release this host"',exampleInstruction:De,validate:Me(t),args:{comment:{required:!1,allowMultiples:!1,about:Ae}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:1,helpDisabled:!1===s("release"),helpHidden:!Object(A.a)({commandName:"release",privileges:a})},{name:"kill-process",about:Se({aboutInfo:Oe.b.killProcess.about,isSupported:s("kill-process")}),RenderComponent:oe,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'kill-process --pid 123 --comment "kill this process"',exampleInstruction:_e,validate:Me(t),mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:Ae},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:Oe.b.killProcess.args.pid.about,validate:Te},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:Oe.b.killProcess.args.entityId.about,validate:we}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:4,helpDisabled:!1===s("kill-process"),helpHidden:!Object(A.a)({commandName:"kill-process",privileges:a})},{name:"suspend-process",about:Se({aboutInfo:Oe.b.suspendProcess.about,isSupported:s("suspend-process")}),RenderComponent:se,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'suspend-process --pid 123 --comment "suspend this process"',exampleInstruction:_e,validate:Me(t),mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:Ae},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:Oe.b.suspendProcess.args.pid.about,validate:Te},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:Oe.b.suspendProcess.args.entityId.about,validate:we}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:5,helpDisabled:!1===s("suspend-process"),helpHidden:!Object(A.a)({commandName:"suspend-process",privileges:a})},{name:"status",about:Oe.b.status.about,RenderComponent:fe,meta:{endpointId:e},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:2},{name:"processes",about:Se({aboutInfo:Oe.b.processes.about,isSupported:s("processes")}),RenderComponent:be,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'processes --comment "get the processes"',exampleInstruction:De,validate:Me(t),args:{comment:{required:!1,allowMultiples:!1,about:Ae}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:3,helpDisabled:!1===s("processes"),helpHidden:!Object(A.a)({commandName:"processes",privileges:a})},{name:"get-file",about:Se({aboutInfo:Oe.b.getFile.about,isSupported:s("get-file")}),RenderComponent:Z,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'get-file --path "/full/path/to/file.txt" --comment "Possible malware"',exampleInstruction:De,validate:Me(t),mustHaveArgs:!0,args:{path:{required:!0,allowMultiples:!1,about:Oe.b.getFile.args.path.about,validate:e=>we(e)},comment:{required:!1,allowMultiples:!1,about:Ae}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:6,helpDisabled:!s("get-file"),helpHidden:!Object(A.a)({commandName:"get-file",privileges:a})},{name:"execute",about:Se({aboutInfo:Oe.b.execute.about,isSupported:s("execute")}),RenderComponent:he,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'execute --command "ls -al" --timeout 2s --comment "Get list of all files"',exampleInstruction:De,validate:Me(t),mustHaveArgs:!0,args:{command:{required:!0,allowMultiples:!1,about:c.a.createElement(c.a.Fragment,null,c.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.endpointConsoleCommands.execute.args.command.about",defaultMessage:"The command to execute."}),c.a.createElement("br",null),`${ve} execute --command "/opt/directory\\-\\-\\-directory/myBinary \\-\\-version"`,c.a.createElement("br",null),`${Ee} execute --command "cd "C:\\Program Files\\directory""`),mustHaveValue:"non-empty-string"},timeout:{required:!1,allowMultiples:!1,about:Oe.b.execute.args.timeout.about,mustHaveValue:"non-empty-string",validate:Ie},comment:{required:!1,allowMultiples:!1,about:Ae}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:6,helpDisabled:!s("execute"),helpHidden:!Object(A.a)({commandName:"execute",privileges:a})}];switch(r&&l.push({name:"upload",about:Se({aboutInfo:Oe.b.upload.about,isSupported:s("upload")}),RenderComponent:U,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'upload --file --overwrite --comment "script to fix registry"',exampleInstruction:De,validate:Me(t),mustHaveArgs:!0,args:{file:{required:!0,allowMultiples:!1,about:Oe.b.upload.args.file.about,mustHaveValue:"truthy",SelectorComponent:Q},overwrite:{required:!1,allowMultiples:!1,about:Oe.b.upload.args.overwrite.about,mustHaveValue:!1},comment:{required:!1,allowMultiples:!1,mustHaveValue:"non-empty-string",about:Ae}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:7,helpDisabled:!s("upload"),helpHidden:!Object(A.a)({commandName:"upload",privileges:a})}),o&&l.push({name:"scan",about:Se({aboutInfo:Oe.b.scan.about,isSupported:s("scan")}),RenderComponent:ke,meta:{agentType:t,endpointId:e,capabilities:n,privileges:a},exampleUsage:'scan --path "/full/path/to/folder" --comment "Scan folder for malware"',exampleInstruction:De,validate:Me(t),mustHaveArgs:!0,args:{path:{required:!0,allowMultiples:!1,mustHaveValue:"non-empty-string",about:Oe.b.scan.args.path.about},comment:{required:!1,allowMultiples:!1,about:Ae}},helpGroupLabel:Ce.responseActions.label,helpGroupPosition:Ce.responseActions.position,helpCommandPosition:8,helpDisabled:!s("scan"),helpHidden:!Object(A.a)({commandName:"scan",privileges:a})}),t){case"sentinel_one":return Pe({commandList:l});case"crowdstrike":return Re({commandList:l});default:return l}},Ne=(e,t)=>{e.helpDisabled=!0,e.helpHidden=!0,e.validate=()=>Object(d.m)(t,e.name)},Pe=({commandList:e})=>e.map((e=>("status"!==e.name&&Object(D.a)("sentinel_one",K.k[e.name],"manual")||Ne(e,"sentinel_one"),e))),Re=({commandList:e})=>e.map((e=>("status"!==e.name&&Object(D.a)("crowdstrike",K.k[e.name],"manual")||Ne(e,"crowdstrike"),e)));var Le=n(1321),ze=n(296);const qe=Object(l.memo)((e=>{const{euiTheme:t}=Object(u.useEuiTheme)(),[n,a]=Object(l.useState)(!1),i=Object(l.useCallback)((()=>{a((e=>!e))}),[]),r=Object(u.useGeneratedHtmlId)({prefix:"responderActionLogFlyoutTitle"});return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.EuiButton,{onClick:i,disabled:n,iconType:"list","data-test-subj":"responderShowActionLogButton"},c.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.responseActionsHistoryButton.label",defaultMessage:"Response actions history"})),n&&c.a.createElement(u.EuiFlyout,{onClose:i,size:"m",paddingSize:"l","aria-labelledby":r,"data-test-subj":"responderActionLogFlyout",maskProps:{style:`z-index: ${t.levels.flyout+3}`}},c.a.createElement(u.EuiFlyoutHeader,{hasBorder:!0},c.a.createElement(u.EuiTitle,{size:"m"},c.a.createElement("h1",{id:r},ze.g.flyoutTitle(e.meta.hostName)))),c.a.createElement(u.EuiFlyoutBody,null,c.a.createElement(Le.a,{agentIds:e.meta.agentId}))))}));qe.displayName="ActionLogButton";var Be=n(921);Object(l.memo)((({endpointId:e})=>{const{data:t,isLoading:n}=s(e,{refetchInterval:1e4});return n?c.a.createElement(u.EuiSkeletonText,{lines:2}):t?c.a.createElement(T,{platform:Object(Be.a)(t.metadata),hostName:t.metadata.host.name,lastCheckin:t.last_checkin,agentType:"endpoint","data-test-subj":"responseConsole"},c.a.createElement(m.a,{agentId:e,agentType:"endpoint","data-test-subj":"responderHeaderEndpointAgentIsolationStatus"})):null})).displayName="HeaderEndpointInfo";var $e=n(203);const Ve=Object(l.memo)((({agentType:e,endpointId:t,hostName:n})=>{const{data:a}=Object(f.a)(t,e);return(null==a?void 0:a[t].status)===$e.d.OFFLINE?c.a.createElement(c.a.Fragment,null,c.a.createElement(u.EuiCallOut,{iconType:"offline",color:"warning","data-test-subj":"offlineCallout",title:_.i18n.translate("xpack.securitySolution.responder.hostOffline.callout.title",{defaultMessage:"Host Offline"})},c.a.createElement("p",null,c.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.responder.hostOffline.callout.body",defaultMessage:"The host {name} is offline, so its responses may be delayed. Pending commands will execute when the host reconnects.",values:{name:c.a.createElement("strong",null,n)}}))),c.a.createElement(u.EuiSpacer,{size:"m"})):null}));Ve.displayName="OfflineCallout",n(1320);var Ue=n(899),Ge=n(877);const He=_.i18n.translate("xpack.securitySolution.responder_overlay.pageTitle",{defaultMessage:"Response console"}),We=()=>{const e=Object(Ue.b)(),t=Object(C.a)().endpointPrivileges,n=Object(p.b)().isEnterprise(),a=Object(X.a)("responseActionsSentinelOneV1Enabled"),i=Object(X.a)("responseActionsCrowdstrikeManualHostIsolationEnabled");return Object(l.useCallback)((r=>{const{agentId:o,agentType:s,capabilities:l,hostName:p,platform:m}=r,f=a&&"sentinel_one"===s||i&&"crowdstrike"===s;if("endpoint"===s&&!t.canAccessResponseConsole)return void window.console.error(new Error(`Access denied to ${s} response actions console`));if("endpoint"!==s&&!n)return void window.console.error(new Error(`Access denied to ${s} response actions console`));const g=e.getOne(o);if(g)g.show();else{const n={commands:Fe({agentType:s,endpointAgentId:o,endpointCapabilities:l,endpointPrivileges:t}),"data-test-subj":`${s}ResponseActionsConsole`,storagePrefix:"xpack.securitySolution.Responder",TitleComponent:()=>c.a.createElement(M,{agentId:o,agentType:s,hostName:p,platform:m})};e.register({id:o,meta:{agentId:o,hostName:p,capabilities:l,platform:m},consoleProps:n,PageTitleComponent:()=>f?c.a.createElement(u.EuiFlexGroup,null,c.a.createElement(u.EuiFlexItem,null,He),c.a.createElement(u.EuiFlexItem,{grow:!1},c.a.createElement(u.EuiBetaBadge,{label:d.g,tooltipContent:d.h}))):c.a.createElement(c.a.Fragment,null,He),ActionComponents:t.canReadActionsLogManagement?[qe]:void 0,PageBodyComponent:()=>c.a.createElement(c.a.Fragment,null,c.a.createElement(Ve,{endpointId:r.agentId,agentType:s,hostName:p}),c.a.createElement(Ge.a,null))}).show()}}),[a,i,t,n,e])},Qe=(e,t={})=>{const n=Object(r.i)();let i=e.userIds;return"string"==typeof e.userIds?i=`*${e.userIds}*`:Array.isArray(e.userIds)&&(i=e.userIds.map((e=>`*${e}*`))),Object(a.useQuery)({queryKey:["get-action-list",e],...t,keepPreviousData:!0,queryFn:async()=>n.get(o.g,{version:"2023-10-31",query:{agentIds:e.agentIds,agentTypes:e.agentTypes,commands:e.commands,endDate:e.endDate,page:e.page,pageSize:e.pageSize,startDate:e.startDate,statuses:e.statuses,userIds:i,withOutputs:e.withOutputs,types:e.types}})})},Ye=()=>{const e=Object(r.i)();return Object(a.useQuery)({queryKey:["get-action-state"],queryFn:()=>e.get(o.d,{version:"2023-10-31"})})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return _t}));var a=n(2),i=n.n(a),r=n(45),o=n(19),s=n(42),l=n(48),c=n(888),u=n(147),d=n(41),p=n.n(d),m=n(410);function f(e,t,n){return t+(e>1?n*(e-1):0)}var g=n(49);function b(){return Object(a.useMemo)((()=>({copyableFieldBackground:g.euiThemeVars.euiColorLightShade,descriptionText:g.euiThemeVars.euiTextColor,full:g.euiThemeVars.euiColorFullShade,graphControls:g.euiThemeVars.euiColorDarkestShade,graphControlsBackground:g.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:g.euiThemeVars.euiColorLightShade,processBackingFill:`${g.euiThemeVars.euiColorPrimary}${g.darkMode?"1F":"0F"}`,resolverBackground:g.euiThemeVars.euiColorEmptyShade,resolverEdge:g.darkMode?g.euiThemeVars.euiColorLightShade:g.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:g.euiThemeVars.euiColorLightestShade,resolverEdgeText:g.darkMode?g.euiThemeVars.euiColorFullShade:g.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${g.euiThemeVars.euiColorDanger}${g.darkMode?"1F":"0F"}`,pillStroke:g.euiThemeVars.euiColorLightShade,linkColor:g.euiThemeVars.euiLinkColor})),[])}const y=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${f(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),h=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),v=i.a.memo((({className:e,edgeLineMetadata:t,startPosition:n,endPosition:a,projectionMatrix:r})=>{const o=Object(m.c)(n,r),l=Object(m.c)(a,r),[c]=r,u=b(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(o,l),g=f(c,10,7.5),v={left:`${o[0]}px`,top:`${o[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(o,l)}rad)`};let E=50;return c<1&&(E+=1/c*(10*(1-c))),i.a.createElement(y,{className:e,style:v,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&i.a.createElement(h,{backgroundColor:u.resolverEdge,leftPct:E,scaledTypeSize:g,textColor:u.resolverEdgeText},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var E=n(4);const x={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},j=Object(a.createContext)(x);var S=n(509),O=n(122);const k=["fit-content(10em)","auto"],w=p()(o.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-160k3ht-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),T=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-160k3ht-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),I=p()(o.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-160k3ht-2"})(["text-transform:uppercase;"]),M=p()(o.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-160k3ht-3"})(["lineheight:'2.2em';"]),C=p()(o.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-160k3ht-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),_=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-160k3ht-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor));var D=n(500),A=n(127);const F=E.i18n.translate("xpack.securitySolution.resolver.graphControls.sourcererButtonTitle",{defaultMessage:"Data View Selection"}),N=Object(a.memo)((({id:e,closePopover:t,setActivePopover:n,isOpen:r})=>{const s=Object(a.useCallback)((()=>n("sourcererSelection")),[n]),l=b();return i.a.createElement(o.EuiPopover,{button:i.a.createElement(C,{"data-test-subj":"resolver:graph-controls:sourcerer-button",size:"m",title:F,"aria-label":F,onClick:s,iconType:"indexSettings",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:r,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(D.a,{scope:A.SourcererScopeName.analyzer}))}));N.displayName="SourcererButton";var P=n(346),R=n(310);const L=[],z=E.i18n.translate("xpack.securitySolution.resolver.graphControls.datePickerButtonTitle",{defaultMessage:"Date Range Selection"}),q=E.i18n.translate("xpack.securitySolution.resolver.graphControls.datePicker",{defaultMessage:"date range selection"}),B=Object(a.memo)((({id:e,closePopover:t,setActivePopover:n,isOpen:s})=>{const l=Object(r.useDispatch)(),c=Object(a.useCallback)((()=>n("datePicker")),[n]),d=b(),p=Object(r.useSelector)((t=>u.e(t.analyzer[e]))),m=Object(a.useCallback)((({start:t,end:n,isInvalid:a})=>{if(!a){const a=t.includes("now")||n.includes("now"),i=Object(P.c)(t);let r=Object(P.c)(n,{roundUp:!0});a&&(r=t===n?Object(P.c)("now"):Object(P.c)(n)),l(Object(R.userOverrodeDateRange)({id:e,timeRange:{from:i,to:r}}))}}),[l,e]);return i.a.createElement(o.EuiPopover,{button:i.a.createElement(C,{"data-test-subj":"resolver:graph-controls:date-picker-button",size:"m",title:z,"aria-label":z,onClick:c,iconType:"calendar",$backgroundColor:d.graphControlsBackground,$iconColor:d.graphControls,$borderColor:d.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},q),i.a.createElement(o.EuiSuperDatePicker,{onTimeChange:m,start:null==p?void 0:p.from,end:null==p?void 0:p.to,showUpdateButton:!1,recentlyUsedRanges:L,width:"auto"}))}));B.displayName="DateSelectionButton";const $=Object(a.memo)(p()(o.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),V=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),U=p()(o.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),G=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),H=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),W=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),Q=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],H,W),Y=p()(o.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),K=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function J({id:e}){return Object(a.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function Z(e,t,n){const i=J({id:e}),r=b(),o=Object(a.useMemo)((()=>({runningProcessCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.runningProcessCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.loadingCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},errorCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.errorCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:r.triggerBackingFill,cubeSymbol:`#${i.runningTriggerCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.terminatedProcessCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:r.triggerBackingFill,cubeSymbol:`#${i.terminatedTriggerCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger}})),[i,r]);return"terminated"===t?n?o.terminatedTriggerCube:o[X.processTerminated]:"running"===t?n?o[X.processCausedAlert]:o[X.processRan]:"error"===t?o[X.processError]:o[X.processLoading]}const X={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},ee=Object(a.memo)((function({id:e,className:t,size:n="2.15em",state:a,isOrigin:r,"data-test-subj":o}){const{cubeSymbol:s,strokeColor:l}=Z(e,a,!1),{processCubeActiveBacking:c}=J({id:e});return i.a.createElement(te,{className:t,width:n,height:n,viewBox:"0 0 34 34","data-test-subj":o,isOrigin:r,style:{verticalAlign:"middle"}},i.a.createElement("desc",null,E.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process} other {Unknown Process State}}",values:{state:a}})),r&&i.a.createElement("use",{xlinkHref:`#${c}`,fill:"transparent",x:0,y:-1,stroke:l,strokeDashoffset:0,width:"100%",height:"100%"}),i.a.createElement("use",{role:"presentation",xlinkHref:s,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),te=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),ne=i.a.memo((function({children:e}){return i.a.createElement(i.a.Fragment,null,i.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,i.a.createElement("wbr",null)]}),[])]}return e})))})),ae=({id:e,closePopover:t,setActivePopover:n,isOpen:r})=>{const s=Object(a.useCallback)((()=>n("nodeLegend")),[n]),l=b(),c=E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return i.a.createElement(o.EuiPopover,{button:i.a.createElement(C,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:c,"aria-label":c,onClick:s,iconType:"node",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:r,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),i.a.createElement("div",{style:{maxWidth:"212px"}},i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:k,align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(I,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),i.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),i.a.createElement(I,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),i.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),i.a.createElement(I,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),i.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),i.a.createElement(I,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),i.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(ne,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))},ie=({id:e,closePopover:t,setActivePopover:n,isOpen:s})=>{var l,c,d;const p=b(),m=Object(r.useSelector)((t=>u.H(t.analyzer[e]))),f=Object(a.useCallback)((()=>n("schemaInfo")),[n]),g=E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),y=E.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return i.a.createElement(o.EuiPopover,{button:i.a.createElement(C,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:f,iconType:"iInCircle",$backgroundColor:p.graphControlsBackground,$iconColor:p.graphControls,$borderColor:p.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),i.a.createElement(o.EuiIconTip,{content:E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),i.a.createElement("div",{style:{maxWidth:"268px"}},i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:k,align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(I,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),i.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(ne,null,null!==(l=null==m?void 0:m.dataSource)&&void 0!==l?l:y)),i.a.createElement(I,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),i.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(ne,null,null!==(c=null==m?void 0:m.schema.id)&&void 0!==c?c:y)),i.a.createElement(I,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),i.a.createElement(o.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(ne,null,null!==(d=null==m?void 0:m.schema.parent)&&void 0!==d?d:y))))))},re=i.a.memo((({id:e,className:t})=>{const n=Object(r.useDispatch)(),s=Object(r.useSelector)((t=>u.I(t.analyzer[e]))),{timestamp:l}=Object(a.useContext)(j),c=Object(O.a)("analyzerDatePickersAndSourcererDisabled"),[d,p]=Object(a.useState)(null),m=b(),f=Object(a.useCallback)((e=>{p(e===d?null:e)}),[p,d]),g=Object(a.useCallback)((()=>p(null)),[]),y=Object(a.useCallback)((t=>{const a=parseFloat(t.target.value);!1===isNaN(a)&&n(Object(S.userSetZoomLevel)({id:e,zoomLevel:a}))}),[n,e]),h=Object(a.useCallback)((()=>{n(Object(S.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[n,e]),v=Object(a.useCallback)((()=>{n(Object(S.userClickedZoomOut)({id:e}))}),[n,e]),x=Object(a.useCallback)((()=>{n(Object(S.userClickedZoomIn)({id:e}))}),[n,e]),[k,I,M,C]=Object(a.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{n(Object(S.userNudgedCamera)({id:e,direction:t,time:l()}))}))),[n,l,e]);return i.a.createElement(_,{className:t,$iconColor:m.graphControls,"data-test-subj":"resolver:graph-controls"},i.a.createElement(T,null,i.a.createElement(ie,{id:e,closePopover:g,isOpen:"schemaInfo"===d,setActivePopover:f}),i.a.createElement(ae,{id:e,closePopover:g,isOpen:"nodeLegend"===d,setActivePopover:f}),c?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{id:e,closePopover:g,isOpen:"sourcererSelection"===d,setActivePopover:f}),i.a.createElement(B,{id:e,closePopover:g,isOpen:"datePicker"===d,setActivePopover:f}))),i.a.createElement(T,null,i.a.createElement(o.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("div",{className:"panning-controls-top"},i.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:k},i.a.createElement(o.EuiIcon,{type:"arrowUp"}))),i.a.createElement("div",{className:"panning-controls-middle"},i.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:C},i.a.createElement(o.EuiIcon,{type:"arrowLeft"})),i.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:h},i.a.createElement(o.EuiIcon,{type:"bullseye"})),i.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:I},i.a.createElement(o.EuiIcon,{type:"arrowRight"}))),i.a.createElement("div",{className:"panning-controls-bottom"},i.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:M},i.a.createElement(o.EuiIcon,{type:"arrowDown"})))),i.a.createElement(o.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:x},i.a.createElement(o.EuiIcon,{type:"plusInCircle"})),i.a.createElement(w,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:s,onChange:y}),i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:v},i.a.createElement(o.EuiIcon,{type:"minusInCircle"})))))}));function oe(e,t){return function(e,t){const n=Object(l.useHistory)(),i=Object(a.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),n.push(e)))}),[n,t,e]);return{href:n.createHref(e),onClick:i}}({search:Object(r.useSelector)((n=>u.F(n.analyzer[e])(t)))})}re.displayName="GraphControls";var se=n(228),le=n(217);const ce=i.a.memo((({id:e,className:t,nodeID:n,nodeStats:r})=>{const o=Object(a.useMemo)((()=>void 0===r?[]:Object.entries(r.byCategory).map((([e,t])=>({prefix:i.a.createElement(se.a,{count:t||0}),category:e})))),[r]);return void 0===o?null:i.a.createElement("ul",{className:`${t} options`,"aria-describedby":n},o.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>i.a.createElement(ue,{id:e,pill:t,nodeID:n,key:t.category}))))})),ue=({id:e,pill:t,nodeID:n})=>{const o=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:n,eventCategory:t.category}}),{pillStroke:s,resolverBackground:l}=b(),c=Object(a.useMemo)((()=>({border:`1.5px solid ${s}`,backgroundColor:l})),[s,l]),u=Object(r.useDispatch)(),{timestamp:d}=Object(a.useContext)(j),p=Object(a.useCallback)((t=>{o.onClick(t),u(Object(le.userSelectedResolverNode)({id:e,nodeID:n,time:d()}))}),[d,o,u,n,e]);return i.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:c,key:t.category},i.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:p},t.prefix," ",t.category))},de=p()(ce).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),pe=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),me=p()(o.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),fe=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ge=p()(o.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var be=n(309),ye=n(212),he=n(291);const ve=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),Ee=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),xe=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),je=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),Se=i.a.memo((({id:e,className:t,position:n,node:l,nodeID:c,projectionMatrix:d,timeAtRender:p})=>{const g=`resolver:${e}`,y=J({id:e}),{timestamp:h}=Object(a.useContext)(j),[v,x]=Object(m.c)(n,d),[S]=d,O=Object(r.useSelector)((t=>u.b(t.analyzer[e]))),k=Object(r.useSelector)((t=>u.J(t.analyzer[e]))),w=Object(r.useSelector)((t=>u.A(t.analyzer[e]))),T=Object(r.useSelector)((t=>u.z(t.analyzer[e])(c))),I=Object(a.useCallback)((e=>Object(o.htmlIdGenerator)(g)(`${e}:node`)),[g]),M=Object(r.useSelector)((t=>u.d(t.analyzer[e])(c))),C=Object(r.useSelector)((t=>u.c(t.analyzer[e])(p)(c))),_=S>.8,D=S>=.55,A=(_?3.5:D?1:21)*S+5,F=360*(_?-.147413:-.147413-.08*(S-.5))*S,N=120*(_?-.53684:.2*-S*(1-S)/S-.53684)*S,P=Object(a.useMemo)((()=>({left:`${v+F}px`,top:`${x+N}px`,width:360*S+"px",height:120*S+"px"})),[v,S,F,N,x]),L=f(S,18.75,12.5),z=i.a.createRef(),q=b(),B=Object(r.useSelector)((t=>u.x(t.analyzer[e])(c))),$="loading"===B,{backingFill:V,cubeSymbol:U,descriptionText:G,isLabelFilled:H,labelButtonFill:W,strokeColor:Q}=Z(e,B,!1),Y=Object(a.useMemo)((()=>Object(o.htmlIdGenerator)("resolver")(`${c}:label`)),[c]),K=c===O,X=c===k,ee=c===w,te=Object(r.useDispatch)(),ne=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:c}}),ae=Object(a.useCallback)((()=>{te(Object(le.userFocusedOnResolverNode)({id:e,nodeID:c,time:h()}))}),[te,c,h,e]),ie=Object(a.useCallback)((t=>{var n;null!==(n=z.current)&&void 0!==n&&n.beginElement&&z.current.beginElement(),"error"===B?te(Object(R.userReloadedResolverNode)({id:e,nodeID:c})):(te(Object(le.userSelectedResolverNode)({id:e,nodeID:c,time:h()})),ne.onClick(t))}),[z,te,c,ne,B,h,e]),re=Object(r.useSelector)((t=>u.K(t.analyzer[e])(l))),se=be.c(l),ce=Object(r.useSelector)((t=>he.a(u.w(t.analyzer[e])(String(l.id))))),ue=Object(a.useMemo)((()=>void 0!==ce?ye.l(ce):se),[ce,se]),pe=Object(a.useMemo)((()=>null===C?void 0:I(C)),[C,I]),me=Object(a.useMemo)((()=>I(c)),[I,c]);return i.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":c,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===M?void 0:M,"aria-flowto":pe,"aria-labelledby":Y,"aria-haspopup":"true","aria-current":K?"true":void 0,"aria-selected":X?"true":void 0,style:P,id:me,tabIndex:-1},i.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{ae(),ie(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},i.a.createElement(je,{isNodeLoading:$},i.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:V,x:-15.35,y:-15.35,stroke:Q,width:22.5,height:22.5,className:"backing"}),ee&&i.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:Q,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),i.a.createElement("use",{role:"presentation",xlinkHref:U,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},i.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:z})))),i.a.createElement(ve,{color:q.full,fontSize:L,topPct:A},i.a.createElement(Ee,{backgroundColor:q.resolverBackground,color:q.descriptionText,isDisplaying:D,"data-test-subj":"resolver:node:description"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event · {descriptionText}} other {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:G}})),i.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:ie,onFocus:ae,tabIndex:-1,style:{backgroundColor:q.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},i.a.createElement(o.EuiButton,{iconSide:$?"right":"left",isLoading:$,color:W,fill:H,iconType:"error"===B?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*S,32)}px`,maxWidth:(_?400:210*S)+"px"},tabIndex:-1,title:ue,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":c},i.a.createElement(xe,{isShowingIcon:"loading"===B||"error"===B,className:"eui-textTruncate","data-test-subj":"euiButton__text"},E.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:B,nodeName:ue}})))),i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:q.resolverBackground,display:_?"flex":"none",margin:"2px 0 0 0",padding:0}},i.a.createElement(o.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==re&&re>0&&i.a.createElement(de,{id:e,buttonFill:q.resolverBackground,nodeStats:T,nodeID:c})))))})),Oe=p()(Se).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var ke=n(56);function we({id:e}){const t=e;return Object(a.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const Te=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),Ie=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),Me=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),Ce=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),_e=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),De=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Ae=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Fe=Object(a.memo)((({id:e,isDarkMode:t})=>{const n=we({id:e});return i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:n.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#6D6D6D"}),i.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),i.a.createElement("linearGradient",{id:n.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),i.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),i.a.createElement("linearGradient",{id:n.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:n.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),i.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),i.a.createElement("linearGradient",{id:n.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:n.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),i.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),i.a.createElement("linearGradient",{id:n.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#DD0A73"}),i.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Ne=Object(a.memo)((({id:e,isDarkMode:t})=>{const n=J({id:e}),a=we({id:e});return i.a.createElement(i.a.Fragment,null,i.a.createElement("symbol",{id:n.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},i.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),i.a.createElement("symbol",{id:n.loadingCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,Te),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),i.a.createElement("symbol",{id:n.errorCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,Ie),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.errorCube})`}),i.a.createElement("g",{opacity:"0.6"},i.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.errorCube})`}),i.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:n.runningProcessCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,Me),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningProcessCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{id:n.runningTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,Ce),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningTriggerCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{viewBox:"0 0 88 100",id:n.terminatedProcessCube},i.a.createElement("title",null,_e),i.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),i.a.createElement("g",{opacity:"0.7"},i.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.terminatedProcessCube})`}),i.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:n.terminatedTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,De),t&&i.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("g",{opacity:"0.6"},!t&&i.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${a.terminatedTriggerCube})`}),i.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{viewBox:"0 -3 88 106",id:n.processCubeActiveBacking},i.a.createElement("title",null,Ae),i.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),Pe=Object(a.memo)((({id:e})=>{const t=Object(ke.useDarkMode)();return i.a.createElement(Re,null,i.a.createElement("defs",null,i.a.createElement(Fe,{id:e,isDarkMode:t}),i.a.createElement(Ne,{id:e,isDarkMode:t})))})),Re=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Le=n(119),ze=n.n(Le);const qe=Object(a.memo)((function({breadcrumbs:e}){const t=Object(a.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:n,resolverEdgeText:r}=b();return i.a.createElement(i.a.Fragment,null,i.a.createElement(U,{background:n,text:r,breadcrumbs:t,truncate:!1}))})),Be=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function $e({id:e}){const t=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),n=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),r=oe(e,{panelView:"nodes"}),s=Object(a.useMemo)((()=>[{text:n,...r}]),[r,n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(qe,{breadcrumbs:s}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},i.a.createElement(Be,null,i.a.createElement(o.EuiLoadingSpinner,{size:"m"})),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function Ve({event:e}){var t,n,a,r,o,l,c,u,d,p,m,f,g,b,y,h,v,E,x;return Object(ye.i)(e)?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(ye.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(n=e.kibana)&&void 0!==n&&null!==(a=n.alert)&&void 0!==a&&null!==(r=a.rule)&&void 0!==r&&r.name?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(f=e.kibana)||void 0===f||null===(g=f.alert)||void 0===g||null===(b=g.rule)||void 0===b?void 0:b.name)}}):null!==(o=e.file)&&void 0!==o&&o.path?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(y=e.file)||void 0===y?void 0:y.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(h=e.registry)||void 0===h?void 0:h.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(v=e.registry)||void 0===v?void 0:v.key)}}):null!==(u=e.dns)&&void 0!==u&&null!==(d=u.question)&&void 0!==d&&d.name?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(E=e.dns)||void 0===E||null===(x=E.question)||void 0===x?void 0:x.name)}}):i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(ye.b)(e)}})}var Ue=n(73),Ge=n.n(Ue);const He=E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),We=new Intl.DateTimeFormat(E.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Qe(e){const t=Object(ke.useUiSetting)("dateFormat"),n=Object(ke.useUiSetting)("dateFormat:tz"),a="Browser"===n?Ge.a.tz.guess():n;if(!e)return;const i=new Date(e);return i&&Number.isFinite(i.getTime())?t?Ge.a.tz(i,a).format(t):We.format(i):He}var Ye=n(262);const Ke=Object(a.memo)((function({id:e,nodeID:t,eventCategory:n}){const a=Object(r.useSelector)((n=>u.i(n.analyzer[e])(t))),l=Object(r.useSelector)((t=>u.r(t.analyzer[e]))),c=Object(r.useSelector)((t=>u.j(t.analyzer[e])));return i.a.createElement(i.a.Fragment,null,l?i.a.createElement(me,{hasBorder:!0},i.a.createElement($e,{id:e})):i.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},c||!a?i.a.createElement(o.EuiCallOut,{title:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(Xe,{id:e,nodeName:a.name,eventCategory:n,nodeID:t}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(Ze,{id:e,eventCategory:n,nodeID:t}))))})),Je=Object(a.memo)((function({id:e,event:t,nodeID:n,eventCategory:a}){const r=Object(Ye.a)(t),l=ye.g(r),c=ye.e(r),u=ye.p(r),d=Qe(l)||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),p=oe(e,{panelView:"eventDetail",panelParameters:{nodeID:n,eventCategory:a,eventID:c,eventTimestamp:String(l),winlogRecordID:String(u)}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiText,null,i.a.createElement(Y,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:ye.d(r).join(", "),eventType:ye.h(r).join(", ")},defaultMessage:"{category} {eventType}"})),i.a.createElement(K,{dateTime:d},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:d},defaultMessage:"@ {date}"}))),i.a.createElement(o.EuiSpacer,{size:"xs"}),i.a.createElement(o.EuiButtonEmpty,ze()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},p),i.a.createElement(Ve,{event:r})))})),Ze=Object(a.memo)((function({id:e,eventCategory:t,nodeID:n}){const l=Object(r.useSelector)((t=>u.y(t.analyzer[e]))),c=Object(r.useDispatch)(),d=Object(a.useCallback)((()=>{c(Object(R.userRequestedAdditionalRelatedEvents)({id:e}))}),[c,e]),p=Object(r.useSelector)((t=>u.q(t.analyzer[e]))),m=Object(r.useSelector)((t=>u.t(t.analyzer[e])));return i.a.createElement(i.a.Fragment,null,l.map(((r,s)=>i.a.createElement(a.Fragment,{key:s},i.a.createElement(Je,{id:e,nodeID:n,eventCategory:t,event:r}),s===l.length-1?null:i.a.createElement(o.EuiHorizontalRule,{margin:"m"})))),m&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButton,{color:"primary",size:"s",fill:!0,onClick:d,isLoading:p,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Xe=Object(a.memo)((function({id:e,nodeName:t,eventCategory:n,nodeID:a}){const o=Object(r.useSelector)((t=>u.M(t.analyzer[e])(a))),l=Object(r.useSelector)((t=>u.D(t.analyzer[e])(a,n))),c=oe(e,{panelView:"nodes"}),d=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),p=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}});return i.a.createElement(qe,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...c},{text:t,...d},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:o},defaultMessage:"{totalCount} Events"}),...p},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:l,category:n},defaultMessage:"{count} {category}"})}]})}));function et({id:e,nodeID:t}){const n=Object(r.useSelector)((n=>he.a(u.w(n.analyzer[e])(t)))),a=Object(r.useSelector)((n=>u.z(n.analyzer[e])(t)));return void 0===n||void 0===a?i.a.createElement(me,{hasBorder:!0},i.a.createElement($e,{id:e})):i.a.createElement(me,{hasBorder:!0},i.a.createElement(nt,{id:e,nodeName:ye.l(n),nodeID:t,totalEventCount:a.total}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(tt,{id:e,nodeID:t,relatedStats:a}))}const tt=Object(a.memo)((function({id:e,nodeID:t,relatedStats:n}){const r=Object(a.useMemo)((()=>Object.entries(n.byCategory).map((([e,t])=>({eventType:e,count:t})))),[n.byCategory]),s=Object(a.useMemo)((()=>[{field:"count",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"25%",sortable:!0,render:e=>i.a.createElement(o.EuiToolTip,{position:"top",content:e},i.a.createElement(se.a,{count:e}))},{field:"eventType",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"75%",sortable:!0,render:n=>i.a.createElement(at,{id:e,nodeID:t,eventType:n},n)}]),[t,e]);return i.a.createElement(o.EuiInMemoryTable,{items:r,columns:s,sorting:!0})})),nt=Object(a.memo)((function({id:e,nodeID:t,nodeName:n,totalEventCount:a}){return i.a.createElement(qe,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...oe(e,{panelView:"nodes"})},{text:n,...oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:a},defaultMessage:"{totalCount} Events"}),...oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),at=Object(a.memo)((({id:e,nodeID:t,eventType:n,children:a})=>{const r=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:n}});return i.a.createElement(o.EuiButtonEmpty,ze()({"data-test-subj":"resolver:panel:node-events:event-type-link"},r),a)}));var it=n(173),rt=n(131),ot=n(889);const st=Object(a.memo)((function({id:e,translatedErrorMessage:t}){const n=oe(e,{panelView:"nodes"}),r=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...n},{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(qe,{breadcrumbs:r}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiButtonEmpty,n,E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),lt=p()(ee).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),ct=E.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),ut=Object(a.memo)((function({id:e,nodeID:t}){const n=Object(r.useSelector)((n=>he.a(u.w(n.analyzer[e])(t))));return"loading"===Object(r.useSelector)((n=>u.x(n.analyzer[e])(t)))?i.a.createElement(me,{hasBorder:!0},i.a.createElement($e,{id:e})):n?i.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},i.a.createElement(dt,{id:e,nodeID:t,processEvent:n})):i.a.createElement(me,{hasBorder:!0},i.a.createElement(st,{id:e,translatedErrorMessage:ct}))})),dt=Object(a.memo)((function({id:e,processEvent:t,nodeID:n}){const l=ye.l(t),c=Object(r.useSelector)((t=>u.x(t.analyzer[e])(n))),d=Object(r.useSelector)((t=>u.E(t.analyzer[e])(n))),p=ye.g(t),m=Qe(p),f=Object(a.useMemo)((()=>{const e={title:"@timestamp",description:m,value:p},n={title:"process.executable",description:Object(ot.d)(t)},a={title:"process.pid",description:Object(ot.c)(t)},i={title:"user.name",description:ye.o(t)};return[e,n,a,{title:"process.entity_id",description:ye.c(t)},i,{title:"user.domain",description:ye.n(t)},{title:"process.parent.pid",description:ye.k(t)},{title:"process.hash.md5",description:ye.j(t)},{title:"process.args",description:ye.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:String(e.description)})))}),[m,p,t]),g=oe(e,{panelView:"nodes"}),b=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...g},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:l},defaultMessage:"Details for: {processName}"})}]),[l,g]),{descriptionText:y}=Z(e,c,!1),h=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}}),v=Object(a.useMemo)((()=>Object(o.htmlIdGenerator)("resolverTable")()),[]),x=[{field:"title","data-test-subj":"resolver:node-detail:entry-title",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0,render:e=>i.a.createElement(ne,null,e)},{name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.valueTitle",defaultMessage:"Value"}),"data-test-subj":"resolver:node-detail:entry-description",render(t){var n;return i.a.createElement(it.c,{data:{field:t.title,value:null!==(n=t.value)&&void 0!==n?n:t.description},triggerId:it.d.DEFAULT,mode:it.a.HOVER_DOWN,visibleCellActions:5,sourcererScopeId:Object(rt.getSourcererScopeId)(e),metadata:{scopeId:e}},t.description)}}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(qe,{breadcrumbs:b}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiTitle,{size:"xs"},i.a.createElement(V,{"aria-describedby":v},i.a.createElement(lt,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:c}),i.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},i.a.createElement(ne,null,l)))),i.a.createElement(o.EuiText,null,i.a.createElement(o.EuiTextColor,{color:"subdued"},i.a.createElement("span",{id:v},y))),i.a.createElement(o.EuiSpacer,{size:"s"}),i.a.createElement(o.EuiLink,ze()({},h,{"data-test-subj":"resolver:node-detail:node-events-link"}),i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:d},defaultMessage:"{relatedEventTotal} Events"})),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiInMemoryTable,{"data-test-subj":"resolver:node-detail",items:f,columns:x,sorting:!0}))})),pt=i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),mt=i.a.memo((function({numberOfEntries:e}){return i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),ft=i.a.memo((function({numberDisplayed:e}){return i.a.createElement(ge,{size:"s",title:i.a.createElement(mt,{numberOfEntries:e})},i.a.createElement("p",null,pt))})),gt=Object(a.memo)((({id:e})=>{const t=Object(a.useMemo)((()=>[{field:"name",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,n)=>i.a.createElement(bt,{id:e,name:t,nodeID:n.nodeID})},{field:"timestamp",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:t=>i.a.createElement(yt,{eventDate:t,id:e})}]),[e]),n=Object(r.useSelector)(Object(a.useCallback)((t=>{const{processNodePositions:n}=u.u(t.analyzer[e]),a=[];for(const e of n.keys()){const t=be.c(e),n=be.b(e);void 0!==n&&a.push({name:t,timestamp:be.a(e),nodeID:n})}return a}),[e])),s=n.length,l=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),c=Object(r.useSelector)((t=>u.m(t.analyzer[e]))),d=Object(r.useSelector)((t=>u.l(t.analyzer[e]))),p=Object(r.useSelector)((t=>u.n(t.analyzer[e]))),m=!0===c||!0===d||!0===p,f=Object(a.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return i.a.createElement(me,{hasBorder:!0},i.a.createElement(qe,{breadcrumbs:l}),m&&i.a.createElement(ft,{numberDisplayed:s}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiInMemoryTable,{rowProps:f,"data-test-subj":"resolver:node-list",items:n,columns:t,sorting:!0}))}));gt.displayName="NodeList";const bt=Object(a.memo)((({id:e,name:t,nodeID:n})=>{const s=Object(r.useSelector)((t=>u.A(t.analyzer[e])===n)),l=Object(r.useSelector)((t=>u.x(t.analyzer[e])(n))),{descriptionText:c}=b(),d=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),p=Object(r.useDispatch)(),{timestamp:m}=Object(a.useContext)(j),f=Object(a.useCallback)((t=>{d.onClick(t),p(Object(le.userSelectedResolverNode)({id:e,nodeID:n,time:m()}))}),[m,d,p,n,e]);return i.a.createElement(o.EuiButtonEmpty,{onClick:f,href:d.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":n},void 0===t?i.a.createElement(o.EuiBadge,{color:"warning"},E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):i.a.createElement(G,null,i.a.createElement(ee,{id:e,state:l,isOrigin:s,"data-test-subj":"resolver:node-list:node-link:icon"}),i.a.createElement(Q,null,s&&i.a.createElement(H,{color:c,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},E.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),i.a.createElement(W,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}));bt.displayName="NodeDetailLink";const yt=Object(a.memo)((({eventDate:e,id:t})=>{const n=Qe(e);return n?i.a.createElement(it.c,{data:{field:"@timestamp",value:e},triggerId:it.d.DEFAULT,visibleCellActions:5,mode:it.a.HOVER_DOWN,sourcererScopeId:Object(rt.getSourcererScopeId)(t),metadata:{scopeId:t}},n):i.a.createElement("span",null,"—")}));function ht(e){const t=[{path:[],value:e}],n=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:a,value:i}=e;Array.isArray(i)?t.push(...i.map((e=>({path:[...a],value:e})))):"object"==typeof i&&null!==i?t.push(...Object.keys(i).map((e=>({path:[...a,e],value:i[e]})))):null!=i&&n.push([a,i])}return n}yt.displayName="NodeDetailTimestamp";const vt=E.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),Et=Object(a.memo)((function({id:e,nodeID:t,eventCategory:n}){const a=Object(r.useSelector)((t=>u.p(t.analyzer[e]))),o=Object(r.useSelector)((t=>u.s(t.analyzer[e]))),s=Object(r.useSelector)((n=>he.a(u.w(n.analyzer[e])(t)))),l=Object(r.useSelector)((n=>u.x(n.analyzer[e])(t))),c=a||o||"loading"===l,d=Object(r.useSelector)((t=>u.f(t.analyzer[e])));return c?i.a.createElement(me,{hasBorder:!0},i.a.createElement($e,{id:e})):d?i.a.createElement(xt,{id:e,nodeID:t,event:d,processEvent:s,eventType:n}):i.a.createElement(me,{hasBorder:!0},i.a.createElement(st,{id:e,translatedErrorMessage:vt}))})),xt=Object(a.memo)((function({id:e,nodeID:t,event:n,eventType:a,processEvent:r}){const l=Qe(ye.m(n))||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),c=r?ye.l(r):null;return i.a.createElement(me,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},i.a.createElement(St,{id:e,nodeID:t,nodeName:c,event:n,breadcrumbEventCategory:a}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiText,{size:"s"},i.a.createElement(Y,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:a,eventType:String(ye.h(n))},defaultMessage:"{category} {eventType}"})),i.a.createElement(K,{dateTime:l},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:l},defaultMessage:"@ {date}"}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(Ot,null,i.a.createElement(ne,null,i.a.createElement(Ve,{event:n}))),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(jt,{event:n,id:e}))}));function jt({event:e,id:t}){const n=Object(a.useMemo)((()=>{const t=[],n=Object(Ye.a)(e);for(const[e,a]of Object.entries(n)){if("agent"===e||"ecs"===e||"@timestamp"===e||!a)continue;const n=ht(a).map((([t,n])=>({title:[e,...t].join("."),description:String(n)})));t.push(...n)}return t}),[e]),r=[{field:"title","data-test-subj":"resolver:panel:event-detail:event-field-title",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0},{name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.valueTitle",defaultMessage:"Value"}),render:e=>i.a.createElement(it.c,{data:{field:e.title,value:e.description},visibleCellActions:5,triggerId:it.d.DEFAULT,mode:it.a.HOVER_DOWN,sourcererScopeId:Object(rt.getSourcererScopeId)(t),metadata:{scopeId:t}},e.description)}];return i.a.createElement(o.EuiInMemoryTable,{items:n,columns:r,search:{box:{incremental:!0,schema:!0}},pagination:!0,sorting:!0})}function St({id:e,nodeID:t,nodeName:n,event:o,breadcrumbEventCategory:l}){const c=Object(r.useSelector)((n=>u.D(n.analyzer[e])(t,l))),d=Object(r.useSelector)((n=>u.E(n.analyzer[e])(t))),p=oe(e,{panelView:"nodes"}),m=oe(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),f=oe(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),g=oe(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:l}}),b=Object(a.useMemo)((()=>{const e=[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...p},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:d},defaultMessage:"{totalCount} Events"}),...f},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:c,category:l},defaultMessage:"{count} {category}"}),...g},{text:i.a.createElement(Ve,{event:o})}];return n&&e.splice(1,0,{text:n,...m}),e}),[l,c,o,m,f,n,d,p,g]);return i.a.createElement(qe,{breadcrumbs:b})}const Ot=Object(a.memo)(p()(o.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),kt=Object(a.memo)((function({id:e}){const t=Object(r.useSelector)((t=>u.B(t.analyzer[e])));return"nodeDetail"===t.panelView?i.a.createElement(ut,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?i.a.createElement(et,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?i.a.createElement(Ke,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?i.a.createElement(Et,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):i.a.createElement(gt,{id:e})}));var wt=n(959);const Tt=p()(o.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),It=p()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),Mt=()=>i.a.createElement(It,{"data-test-subj":"resolver:no-process-events",direction:"column"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h4",null,E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(Tt,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var Ct=n(123);const _t=i.a.memo(i.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m},f){!function(e){const t=Object(a.useRef)();t.current=Object(l.useLocation)().search;const n=Object(r.useDispatch)(),i=Object(l.useHistory)(),o=Object(c.a)(e);Object(a.useEffect)((()=>{const e=o;return()=>{const n=new URLSearchParams(t.current);n.delete(e);const a={search:n.toString()};i.replace(a)}}),[o,i,n,e])}(n),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:n,filters:i,shouldUpdate:o}){const s=Object(r.useDispatch)(),c=Object(l.useLocation)().search;Object(a.useLayoutEffect)((()=>{s(Object(le.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:c,indices:n,shouldUpdate:o,filters:i}))}),[s,e,t,c,n,o,i])}({databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m}),function({id:e}){const{addSuccess:t}=Object(Ct.a)(),{from:n,to:i}=Object(r.useSelector)((t=>{const n=u.g(t.analyzer[e]);return{from:null!=n&&n.from?n.from:void 0,to:null!=n&&n.to?n.to:void 0}})),o=Qe(n),s=Qe(i),l=Object(a.useMemo)((()=>E.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:o,to:s}})),[o,s]);Object(a.useEffect)((()=>{(n||i)&&t(l)}),[t,l,n,i])}({id:n}),function({id:e}){const t=Object(r.useDispatch)(),n=e,i=Object(l.useLocation)().search,o=Object(a.useContext)(j),s=Object(r.useSelector)((t=>u.J(t.analyzer[e]))),c=Object(r.useSelector)((t=>u.i(t.analyzer[e]))),d=Object(wt.a)({locationSearch:i,resolverComponentInstanceID:n});let p;"nodes"!==d.panelView&&(p=d.panelParameters.nodeID),Object(a.useEffect)((()=>{p&&c(p)&&p!==s&&t(Object(le.userSelectedResolverNode)({id:e,nodeID:p,time:o.timestamp()}))}),[d.panelView,p,t,c,s,o,e])}({id:n});const{timestamp:g}=Object(a.useContext)(j),y=g(),{processNodePositions:h,connectingEdgeLineSegments:x}=Object(r.useSelector)((e=>u.Q(e.analyzer[n])(y))),{projectionMatrix:O,ref:k,onMouseDown:w}=function({id:e}){const t=Object(r.useDispatch)(),n=Object(a.useContext)(j),[i,o]=Object(a.useState)(null),s=Object(r.useSelector)(Object(a.useCallback)((t=>u.C(t.analyzer[e])),[e])),l=Object(a.useRef)(),[c,d]=Object(a.useState)(s(n.timestamp())),p=Object(r.useSelector)((t=>u.P(t.analyzer[e]))),m=Object(r.useSelector)((t=>u.o(t.analyzer[e]))),[f,g]=function(){const{getBoundingClientRect:e}=Object(a.useContext)(j),[t,n]=Object(a.useState)(null),{ResizeObserver:i,requestAnimationFrame:r}=Object(a.useContext)(j),[o,s]=Object(a.useState)(null),l=Object(a.useCallback)((e=>{s(e)}),[]);return Object(a.useEffect)((()=>{null!==o&&n(e(o))}),[o,e]),Object(a.useEffect)((()=>{let t=window.scrollX,a=window.scrollY;const i=()=>{r((()=>{const i=window.scrollX,r=window.scrollY;null===o||t===i&&a===r||n(e(o)),t=i,a=r}))};return window.addEventListener("scroll",i,{passive:!0}),()=>{window.removeEventListener("scroll",i)}}),[o,r,e]),Object(a.useEffect)((()=>{if(null!==o){const t=new i((t=>{null!==o&&o===t[0].target&&n(e(o))}));return t.observe(o),()=>{t.disconnect()}}}),[i,o,e]),[t,l]}(),b=Object(a.useCallback)((e=>null===f?null:[e.clientX-f.x,e.clientY-f.y]),[f]),y=Object(a.useCallback)((a=>{const i=b(a);null!==i&&t(Object(S.userStartedPanning)({id:e,screenCoordinates:i,time:n.timestamp()}))}),[t,b,n,e]),h=Object(a.useCallback)((a=>{const i=b(a);i&&t(Object(S.userMovedPointer)({id:e,screenCoordinates:i,time:n.timestamp()}))}),[t,b,n,e]),v=Object(a.useCallback)((()=>{p&&t(Object(S.userStoppedPanning)({id:e,time:n.timestamp()}))}),[t,n,p,e]),E=Object(a.useCallback)((a=>{null!==f&&a.ctrlKey&&0!==a.deltaY&&0===a.deltaMode&&(a.preventDefault(),t(Object(S.userZoomed)({id:e,zoomChange:a.deltaY/-f.height,time:n.timestamp()})))}),[f,t,n,e]),x=Object(a.useCallback)((e=>{o(e),g(e)}),[g]);return Object(a.useEffect)((()=>(window.addEventListener("mouseup",v,{passive:!0}),()=>{window.removeEventListener("mouseup",v)})),[v]),Object(a.useEffect)((()=>(window.addEventListener("mousemove",h,{passive:!0}),()=>{window.removeEventListener("mousemove",h)})),[h]),Object(a.useEffect)((()=>{if(null!==i)return i.addEventListener("wheel",E),()=>{i.removeEventListener("wheel",E)}}),[i,E]),Object(a.useLayoutEffect)((()=>{l.current=s}),[s]),Object(a.useLayoutEffect)((()=>{d(s(n.timestamp()))}),[s,n]),Object(a.useLayoutEffect)((()=>{const e=n.timestamp();if(m(e)){let e=null;const t=()=>{const a=n.timestamp();void 0!==l.current&&d(l.current(a)),e=m(a)?n.requestAnimationFrame(t):null};return e=n.requestAnimationFrame(t),()=>{null!==e&&n.cancelAnimationFrame(e)}}}),[m,n]),Object(a.useEffect)((()=>{null!==f&&t(Object(S.userSetRasterSize)({id:e,dimensions:[f.width,f.height]}))}),[t,f,e]),{ref:x,onMouseDown:y,projectionMatrix:c}}({id:n}),T=Object(a.useCallback)((e=>{k(e),"function"==typeof f?f(e):null!==f&&(f.current=e)}),[k,f]),I=Object(r.useSelector)((e=>u.s(e.analyzer[n]))),M=Object(r.useSelector)((e=>u.k(e.analyzer[n]))),C=Object(r.useSelector)((e=>u.b(e.analyzer[n]))),_=Object(r.useSelector)((e=>u.G(e.analyzer[n]))),D=b();return i.a.createElement(pe,{className:e,backgroundColor:D.resolverBackground},I?i.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},i.a.createElement(o.EuiLoadingSpinner,{size:"xl"})):M?i.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},i.a.createElement("div",null," ",i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):_?i.a.createElement(i.a.Fragment,null,i.a.createElement(fe,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:w,ref:T,role:"tree",tabIndex:0,"aria-activedescendant":C||void 0},x.map((({points:[e,t],metadata:n})=>i.a.createElement(v,{edgeLineMetadata:n,key:n.reactKey,startPosition:e,endPosition:t,projectionMatrix:O}))),[...h].map((([e,t])=>{const a=be.b(e);if(void 0===a)throw new Error("Tried to render a node without an ID");return i.a.createElement(Oe,{id:n,key:a,nodeID:a,position:t,projectionMatrix:O,node:e,timeAtRender:y})}))),i.a.createElement(kt,{id:n})):i.a.createElement(Mt,null),i.a.createElement(re,{id:n}),i.a.createElement(Pe,{id:n}))})))},function(e,t,n){"use strict";n.d(t,"b",(function(){return ce})),n.d(t,"a",(function(){return de}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(75),l=n(45),c=n(13),u=n(363),d=n(444),p=n(41),m=n.n(p);const f=m.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-1xzawmf-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS));f.displayName="Field";const g=o.a.memo((({fieldId:e,fieldWidth:t})=>o.a.createElement(f,{"data-test-subj":"field",width:t},e)));g.displayName="DraggableFieldBadge";var b=n(222),y=n(180),h=n(19),v=n(1306),E=n(128),x=n(1260),j=n(266),S=n(146),O=n(137),k=n(191),w=n(44),T=n(53),I=n(124),M=n(129),C=n(522);const _=o.a.memo((({columnId:e,onColumnRemoved:t})=>{const n=Object(r.useCallback)((n=>{n.preventDefault(),n.stopPropagation(),t(e)}),[e,t]);return o.a.createElement(h.EuiButtonIcon,{"aria-label":C.f,color:"text","data-test-subj":"remove-column",iconType:"cross",onClick:n})}));_.displayName="CloseButton";const D=o.a.memo((({header:e,onColumnRemoved:t,sort:n,isLoading:a})=>o.a.createElement(o.a.Fragment,null,n.some((t=>t.columnId===e.id))&&a?o.a.createElement(y.d,{className:"siemEventsHeading__extra--loading"},o.a.createElement(y.h,{"data-test-subj":"timeline-loading-spinner"})):o.a.createElement(y.d,{className:"siemEventsHeading__extra--close"},o.a.createElement(_,{columnId:e.id,onColumnRemoved:t})))));D.displayName="Actions";const A=m()(h.EuiFieldText).withConfig({displayName:"FieldText",componentId:"sc-14rl5n4-0"})(["min-width:",";"],(e=>e.minwidth));A.displayName="FieldText";const F=o.a.memo((({columnId:e,minWidth:t,filter:n="",onFilterChange:a=w.noop,placeholder:i="Filter"})=>o.a.createElement(A,{"data-test-subj":"textFilter",minwidth:`${t}px`,placeholder:i,value:n,onChange:t=>{a({columnId:e,filter:t.target.value})}})));F.displayName="TextFilter";const N=o.a.memo((({header:e,onFilterChange:t=w.noop})=>{var n;return"text-filter"===e.columnHeaderType?o.a.createElement(F,{columnId:e.id,minWidth:null!==(n=e.initialWidth)&&void 0!==n?n:j.a,onFilterChange:t,placeholder:e.placeholder}):null}));N.displayName="Filter";const P=({header:e,sort:t})=>t.reduce(((t,n)=>e.id===n.columnId?n.sortDirection:t),"none"),R=({header:e,sort:t})=>t.findIndex((t=>t.columnId===e.id));var L=n(424),z=n(432);const q=o.a.memo((({sortNumber:e})=>e>=0?o.a.createElement(h.EuiNotificationBadge,{color:"subdued","data-test-subj":"sortNumber"},e+1):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortEmptyNumber",type:"empty"})));q.displayName="SortNumber";var B=function(e){return e.SORT_UP="sortUp",e.SORT_DOWN="sortDown",e}(B||{});const $=o.a.memo((({sortDirection:e,sortNumber:t})=>{const n=(e=>{switch(e){case O.b.asc:return B.SORT_UP;case O.b.desc:return B.SORT_DOWN;case"none":return;default:throw new Error("Unhandled sort direction")}})(e);return null!=n?o.a.createElement(h.EuiToolTip,{content:n===B.SORT_UP?z.e:z.f,"data-test-subj":"sort-indicator-tooltip"},o.a.createElement(o.a.Fragment,null,o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:n}),o.a.createElement(q,{sortNumber:t}))):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:"empty"})}));$.displayName="SortIndicator";var V=n(284);const U=m()(h.EuiIcon).withConfig({displayName:"IconType",componentId:"sc-1mjgpab-0"})(["margin-right:3px;position:relative;top:-2px;"]);U.displayName="IconType";const G=m.a.span.withConfig({displayName:"P",componentId:"sc-1mjgpab-1"})(["margin-bottom:5px;"]);G.displayName="P";const H=m.a.span.withConfig({displayName:"ToolTipTableMetadata",componentId:"sc-1mjgpab-2"})(["margin-right:5px;display:block;font-weight:bold;"]);H.displayName="ToolTipTableMetadata";const W=m.a.span.withConfig({displayName:"ToolTipTableValue",componentId:"sc-1mjgpab-3"})(["word-wrap:break-word;"]);W.displayName="ToolTipTableValue";const Q=o.a.memo((({header:e})=>{var t;return o.a.createElement(o.a.Fragment,null,!Object(w.isEmpty)(e.category)&&o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"category"},C.a,":"),o.a.createElement(W,{"data-test-subj":"category-value"},e.category)),o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"field"},C.c,":"),o.a.createElement(W,{"data-test-subj":"field-value"},e.id)),o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"type"},C.i,":"),o.a.createElement(W,null,o.a.createElement(U,{"data-test-subj":"type-icon",type:Object(V.d)(e.type)}),null===(t=e.esTypes)||void 0===t?void 0:t.map((e=>o.a.createElement(h.EuiBadge,{"data-test-subj":`type-value-${e}`,key:e},e))))),!Object(w.isEmpty)(e.description)&&o.a.createElement(G,null,o.a.createElement(H,{"data-test-subj":"description"},C.b,":"),o.a.createElement(W,{"data-test-subj":"description-value"},e.description)))}));Q.displayName="HeaderToolTipContent";const Y=({children:e,header:t,isLoading:n,isResizing:a,onClick:i,showSortingCapability:r,sort:s})=>{var l,c;return o.a.createElement(y.c,{"data-test-subj":`header-${t.id}`,isLoading:n},t.aggregatable&&r?o.a.createElement(y.f,{"data-test-subj":"header-sort-button",onClick:a||n?w.noop:i},o.a.createElement(L.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Q,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(l=t.displayAsText)&&void 0!==l?l:t.id))),o.a.createElement($,{"data-test-subj":"header-sort-indicator",sortDirection:P({header:t,sort:s}),sortNumber:R({header:t,sort:s})})):o.a.createElement(y.g,null,o.a.createElement(L.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Q,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(c=t.displayAsText)&&void 0!==c?c:t.id)))),e)},K=o.a.memo(Y);var J=n(57),Z=n(169);const X=({header:e,onFilterChange:t=w.noop,sort:n,timelineId:a})=>{const i=Object(l.useDispatch)(),s=Object(r.useMemo)((()=>Object(J.createSelector)(Z.selectTimeline,(e=>(null==e?void 0:e.activeTab)===S.d.eql))),[]),c=Object(I.b)((e=>s(e,a))),u=Object(r.useCallback)((()=>{var t,r;const o=e.id,s=null!==(t=e.type)&&void 0!==t?t:"",l=null!==(r=e.esTypes)&&void 0!==r?r:[],c=(({clickedHeader:e,currentSort:t})=>t.reduce(((t,n)=>e.id===n.columnId?(e=>{switch(e.sortDirection){case O.b.desc:return O.b.asc;case O.b.asc:default:return O.b.desc}})(n):t),O.b.desc))({clickedHeader:e,currentSort:n}),u=n.findIndex((e=>e.columnId===o));let d=[];d=-1===u?[...n,{columnId:o,columnType:s,esTypes:l,sortDirection:c}]:[...n.slice(0,u),{columnId:o,columnType:s,esTypes:l,sortDirection:c},...n.slice(u+1)],i(M.a.updateSort({id:a,sort:d}))}),[i,e,n,a]),d=Object(r.useCallback)((e=>i(M.a.removeColumn({id:a,columnId:e}))),[i,a]),p=Object(r.useMemo)((()=>M.b.getTimelineByIdSelector()),[]),{isLoading:m}=Object(I.a)((e=>p(e,a)||{isLoading:!1})),f=!c&&!Object(T.isDataViewFieldSubtypeNested)(e);return o.a.createElement(o.a.Fragment,null,o.a.createElement(K,{header:e,isLoading:m,isResizing:!1,onClick:u,showSortingCapability:f,sort:n},o.a.createElement(D,{header:e,isLoading:m,onColumnRemoved:d,sort:n})),o.a.createElement(N,{header:e,onFilterChange:t}))},ee=o.a.memo(X),te=m()(h.EuiContextMenu).withConfig({displayName:"ContextMenu",componentId:"sc-wn02ez-0"})(["width:115px;& .euiContextMenuItem{font-size:12px;padding:4px 8px;width:115px;}"]),ne=m.a.div.withConfig({displayName:"PopoverContainer",componentId:"sc-wn02ez-1"})(["& .euiPopover{padding-right:8px;width:","px;}"],(({$width:e})=>e)),ae={right:!0},ie=({draggableIndex:e,header:t,timelineId:n,isDragging:a,onFilterChange:c,sort:u,tabType:d})=>{const p=Object(r.useRef)(null),[m,f]=Object(r.useState)(!1),g=Object(r.useCallback)((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()}),[]),w=Object(l.useDispatch)(),T=Object(r.useMemo)((()=>{var e;return{width:null!==(e=t.initialWidth)&&void 0!==e?e:j.a,height:"auto"}}),[t.initialWidth]),I=Object(r.useMemo)((()=>({position:a?"absolute":"relative"})),[a]),_=Object(r.useMemo)((()=>({right:o.a.createElement(y.e,null)})),[]),D=Object(r.useCallback)(((e,a,i,r)=>{w(M.a.applyDeltaToColumnWidth({columnId:t.id,delta:r.width,id:n}))}),[w,t.id,n]),A=Object(r.useMemo)((()=>Object(b.j)({contextId:`timeline-column-headers-${d}-${n}`,fieldId:t.id})),[d,n,t.id]),F=Object(r.useCallback)((e=>{var a,i;const r=t.id,o=null!==(a=t.type)&&void 0!==a?a:"",s=null!==(i=t.esTypes)&&void 0!==i?i:[],l=u.findIndex((e=>e.columnId===r)),c=-1===l?[...u,{columnId:r,columnType:o,esTypes:s,sortDirection:e}]:[...u.slice(0,l),{columnId:r,columnType:o,esTypes:s,sortDirection:e},...u.slice(l+1)];w(M.a.updateSort({id:n,sort:c}))}),[w,t,u,n]),N=Object(r.useCallback)((()=>{f(!1),g()}),[g]),P=Object(r.useMemo)((()=>[{id:0,items:[{icon:o.a.createElement(h.EuiIcon,{type:"eyeClosed",size:"s"}),name:C.e,onClick:()=>{w(M.a.removeColumn({id:n,columnId:t.id})),N()}},...d!==S.d.eql?[{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortUp",size:"s"}),name:C.g,onClick:()=>{F(O.b.asc),N()}},{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortDown",size:"s"}),name:C.h,onClick:()=>{F(O.b.desc),N()}}]:[]]}]),[w,N,t.aggregatable,t.id,F,d,n]),R=Object(r.useMemo)((()=>o.a.createElement(ee,{timelineId:n,header:t,onFilterChange:c,sort:u})),[t,c,u,n]),L=Object(r.useCallback)((e=>{var n;return o.a.createElement(y.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(y.p,null,o.a.createElement(ne,{$width:null!==(n=t.initialWidth)&&void 0!==n?n:j.a},o.a.createElement(h.EuiPopover,{anchorPosition:"downLeft",button:R,closePopover:N,isOpen:m,ownFocus:!0,panelPaddingSize:"none"},o.a.createElement(te,{initialPanelId:0,panels:P})))))}),[N,R,t.initialWidth,m,P]),z=Object(r.useCallback)((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),[]),q=Object(r.useCallback)((()=>{f(!0)}),[]),{onBlur:B,onKeyDown:$}=Object(x.a)({closePopover:N,draggableId:A,fieldName:t.id,keyboardHandlerRef:p,openPopover:q}),V=Object(r.useCallback)((e=>{m||$(e)}),[m,$]);return o.a.createElement(v.Resizable,{enable:ae,size:T,style:I,handleComponent:_,onResizeStop:D},o.a.createElement("div",{"aria-colindex":null!=e?e+k.b:void 0,className:E.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:z,onBlur:B,onKeyDown:V,ref:p,role:"columnheader",tabIndex:0},o.a.createElement(s.Draggable,{"data-test-subj":"draggable",disableInteractiveElementBlocking:!0,draggableId:A,index:e,key:t.id},L)))},re=o.a.memo(ie);var oe=n(127),se=n(1201);const le=o.a.memo((({children:e,onMount:t,onUnmount:n})=>(Object(r.useEffect)((()=>(t(),()=>n())),[t,n]),o.a.createElement(o.a.Fragment,null,e))));le.displayName="DraggableContainer";const ce=({globalFullScreen:e,isActiveTimelines:t,timelineFullScreen:n})=>t&&n||!1===t&&e,ue=({actionsColumnWidth:e,browserFields:t,columnHeaders:n,isEventViewer:a=!1,isSelectAllChecked:d,onSelectAll:p,show:m,showEventsSelect:f,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,leadingControlColumns:j,trailingControlColumns:S})=>{const O=Object(l.useDispatch)(),[k,w]=Object(r.useState)(null),T=Object(r.useRef)(null);Object(r.useEffect)((()=>()=>{T.current&&T.current.closeEditor()}),[]),Object(r.useEffect)((()=>{!m&&T.current&&T.current.closeEditor()}),[m]);const I=Object(r.useCallback)(((e,t,a)=>{const r=a.source.index,s=n[r];return o.a.createElement(y.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(le,{onMount:()=>w(r),onUnmount:()=>w(null)},o.a.createElement(u.a,null,o.a.createElement(g,{fieldId:s.id,fieldWidth:s.initialWidth}))))}),[n,w]),M=Object(r.useMemo)((()=>n.map(((e,t)=>o.a.createElement(re,{key:e.id,draggableIndex:t,timelineId:x,header:e,isDragging:k===t,sort:v,tabType:E})))),[n,x,k,v,E]),C=Object(r.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,o.a.createElement(y.r,i()({"data-test-subj":"headers-group",ref:e.innerRef,isDragging:t.isDraggingOver},e.droppableProps),M))),[M]),_=Object(r.useMemo)((()=>j?j.map((e=>e.headerCellRender)):[]),[j]),D=Object(r.useMemo)((()=>S?S.map((e=>e.headerCellRender)):[]),[S]),A=Object(se.a)({sourcererScope:oe.SourcererScopeName.timeline,editorActionsRef:T,upsertColumn:(e,t)=>O(Object(c.upsertColumn)({column:e,id:x,index:t})),removeColumn:e=>O(Object(c.removeColumn)({columnId:e,id:x}))}),F=Object(r.useMemo)((()=>_.map(((i,r)=>{const s=j[r]&&j[r].width||e;return o.a.createElement(y.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:a,key:r},i&&o.a.createElement(i,{width:s,browserFields:t,columnHeaders:n,isEventViewer:a,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:f,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:A}))}))),[_,j,e,t,n,A,a,d,p,f,h,v,E,x]),N=Object(r.useMemo)((()=>D.map(((i,r)=>{const s=S[r]&&S[r].width||e;return o.a.createElement(y.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:a,key:r},i&&o.a.createElement(i,{width:s,browserFields:t,columnHeaders:n,isEventViewer:a,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:f,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:A}))}))),[D,S,e,t,n,A,a,d,p,f,h,v,E,x]);return o.a.createElement(y.s,{"data-test-subj":"column-headers"},o.a.createElement(y.v,null,F,o.a.createElement(s.Droppable,{direction:"horizontal",droppableId:`${b.f}-${E}.${x}`,isDropDisabled:!1,type:b.a,renderClone:I},C),N))},de=o.a.memo(ue)},function(e,t,n){"use strict";n.d(t,"a",(function(){return te})),n.d(t,"b",(function(){return ne}));var a=n(2),i=n.n(a),r=n(19),o=n(42),s=n(153),l=n(1781),c=n(344),u=n(748),d=n(4),p=n(122);const m=({tooltip:e,anchorPosition:t="top",children:n})=>i.a.createElement(r.EuiToolTip,{content:e,position:t},n);var f=n(298),g=n(47),b=n(7),y=n(118),h=n(11);const v=[5,10,20],E={pageIndex:0,pageSize:v[0]},x=(e,t)=>t,j={sort:{field:"@timestamp",direction:"desc"},enableAllColumns:!0},S=(e,t)=>({...e,sort:t}),O=e=>{const{setPagination:t,pagination:n,pageSizeOptions:i}=(()=>{const[e,t]=Object(a.useReducer)(x,E);return Object(a.useMemo)((()=>({pageSizeOptions:[...v],pagination:e,setPagination:t})),[e])})(),{sorting:r,sortConfig:o,setSorting:s}=(()=>{const[e,t]=Object(a.useReducer)(S,j),n=Object(a.useMemo)((()=>[{[e.sort.field]:e.sort.direction}]),[e.sort.direction,e.sort.field]);return{sorting:e,setSorting:t,sortConfig:n}})(),{data:l,totalItemCount:c,loading:u,error:d}=(({alertIds:e,from:t,size:n,sort:i})=>{const{services:{data:r}}=Object(y.j)(),o=Object(a.useMemo)((()=>{return e=r.search,async({signal:t,alertIds:n,from:a,size:i,sort:r})=>new Promise(((o,s)=>{const l=e.search({params:{body:{query:{ids:{values:n}},from:a,size:i,sort:r,fields:["*"],_source:!1}}},{abortSignal:t}).subscribe({next:e=>{Object(h.isRunningResponse)(e)||(l.unsubscribe(),o(e.rawResponse))},error:e=>{l.unsubscribe(),s(new Error("Error while loading alerts"))}})}));var e}),[r.search]),{data:s,isLoading:l,isError:c}=Object(g.useQuery)(["useFetchAlerts",e,t,n,i],(async({signal:a})=>o({signal:a,alertIds:e,from:t,size:n,sort:i})),{keepPreviousData:!0});return Object(a.useMemo)((()=>{var e,t;const n=null==s||null===(e=s.hits)||void 0===e?void 0:e.total;return{loading:l,error:c,data:(null==s||null===(t=s.hits)||void 0===t?void 0:t.hits)||[],totalItemCount:Object(b.isNumber)(n)?n:0}}),[s,c,l])})({alertIds:e,from:n.pageIndex*n.pageSize,size:n.pageSize,sort:o});return{paginationConfig:Object(a.useMemo)((()=>({...n,pageSizeOptions:i,totalItemCount:c})),[i,n,c]),setPagination:t,setSorting:s,loading:u,data:l,sorting:r,error:d}};var k=n(202),w=n(263),T=n(172),I=n(302),M=n(1295);const C=({title:e,loading:t,alertIds:n,scopeId:s,eventId:d,noItemsMessage:g,"data-test-subj":b})=>{const{setPagination:y,setSorting:h,data:v,loading:E,paginationConfig:x,sorting:j,error:S}=O(n||[]),I=!Object(p.a)("entityAlertPreviewDisabled"),C=Object(a.useCallback)((({page:e,sort:t})=>{if(e){const{index:t,size:n}=e;y({pageIndex:t,pageSize:n})}t&&h(t)}),[y,h]),A=Object(a.useMemo)((()=>v.map((e=>{var t;return{fields:null!==(t=e.fields)&&void 0!==t?t:{},id:e._id,index:e._index}})).map((e=>{const t=Object.keys(e.fields).reduce(((t,n)=>{var a,i,r;return t[n]=(null===(a=e.fields)||void 0===a||null===(i=a[n])||void 0===i?void 0:i[0])||(null===(r=e.fields)||void 0===r?void 0:r[n]),t}),{});return t.id=e.id,t.index=e.index,t}))),[v]),F=Boolean(n&&n.length&&n.length>=5),N=Object(a.useMemo)((()=>F?null:D(s,d,n)),[n,F,s,d]),P=Object(a.useMemo)((()=>F?_(n):null),[n,F]),R=Object(a.useMemo)((()=>[...I?[{render:e=>i.a.createElement(M.a,{id:e.id,indexName:e.index,"data-test-subj":`${b}AlertPreviewButton`,scopeId:s}),width:"5%"}]:[],{field:"@timestamp",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.timestampColumnLabel",defaultMessage:"Timestamp"}),truncateText:!0,dataType:"date",render:e=>{const t=Object(r.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS");return i.a.createElement(m,{tooltip:t},i.a.createElement("span",null,t))}},{field:u.r,name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ruleColumnLabel",defaultMessage:"Rule"}),truncateText:!0,render:e=>i.a.createElement(m,{tooltip:e},i.a.createElement("span",null,e))},{field:u.m,name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.reasonColumnLabel",defaultMessage:"Reason"}),truncateText:!0,render:e=>i.a.createElement(m,{tooltip:e,anchorPosition:"left"},i.a.createElement("span",null,e))},{field:"kibana.alert.severity",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.severityColumnLabel",defaultMessage:"Severity"}),truncateText:!0,render:e=>{const t=l.a.decode(e),n=Object(c.isRight)(t)?i.a.createElement(f.a,{value:t.right}):i.a.createElement("p",null,e);return i.a.createElement(m,{tooltip:e},n)}}]),[I,s,b]);return i.a.createElement(k.a,{header:{title:e,iconType:"warning",headerContent:n&&n.length&&n.length>0?i.a.createElement("div",{"data-test-subj":`${b}InvestigateInTimeline`},i.a.createElement(w.a,{dataProviders:N,filters:P,asEmptyButton:!0,iconType:"timeline"},T.i)):null},content:{error:S},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":b},i.a.createElement(r.EuiBasicTable,{"data-test-subj":`${b}Table`,loading:t||E,items:A,columns:R,pagination:x,sorting:j,onChange:C,noItemsMessage:g}))},_=e=>e&&e.length?[{meta:{alias:d.i18n.translate("xpack.securitySolution.flyout.left.insights.correlations.tableFilterLabel",{defaultMessage:"Correlations Details Table Alert IDs."}),type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null,D=(e,t,n)=>n&&n.length?n.reduce(((n,a,i)=>{const r=`${e}-${t}-event.id-${i}-${a}`;return n.push(Object(I.a)("_id",r,a)),n}),[]):null;var A=n(609);const F=({entityId:e,scopeId:t,eventId:n})=>{const{loading:a,error:r,data:l,dataCount:c}=Object(A.a)({entityId:e,scopeId:t});return r?null:i.a.createElement(C,{title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by session",values:{count:c}}),loading:a,alertIds:l,scopeId:t,eventId:n,noItemsMessage:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsNoDataDescription",defaultMessage:"No alerts related by session."}),"data-test-subj":s.g})};F.displayName="RelatedAlertsBySession";var N=n(610);const P=({originalEventId:e,scopeId:t,eventId:n})=>{const{loading:a,data:r,dataCount:l}=Object(N.a)({originalEventId:e,scopeId:t});return i.a.createElement(C,{title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by source event",values:{count:l}}),loading:a,alertIds:r,scopeId:t,eventId:n,noItemsMessage:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsNoDataDescription",defaultMessage:"No related source events."}),"data-test-subj":s.h})};P.displayName="RelatedAlertsBySameSourceEvent";var R=n(144),L=n(611);const z=({eventId:e})=>{const{loading:t,error:n,data:l,dataCount:c}=Object(L.a)({eventId:e}),u=Object(a.useMemo)((()=>(e=>[{field:"title",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.nameColumnLabel",defaultMessage:"Name"}),render:(t,n)=>{const a=e.findIndex((e=>e.id===n.id));return i.a.createElement(m,{tooltip:n.title},i.a.createElement(R.a,{detailName:n.id,title:n.title,index:a},n.title))}},{field:"status",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.statusColumnLabel",defaultMessage:"Status"}),truncateText:!0,width:"25%"}])(l)),[l]);return n?null:i.a.createElement(k.a,{header:{title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesTitle",defaultMessage:"{count} related {count, plural, one {case} other {cases}}",values:{count:c}}),iconType:"warning"},content:{error:n},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":s.j},i.a.createElement(r.EuiInMemoryTable,{loading:t,items:l,columns:u,pagination:!0,message:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesNoDataDescription",defaultMessage:"No related cases."}),"data-test-subj":s.i}))};z.displayName="RelatedCases";var q=n(612),B=n(613),$=n(614),V=n(125),U=n(615),G=n(616),H=n(617);const W=({documentId:e,indices:t,scopeId:n})=>{const{loading:a,error:r,data:l,dataCount:c}=Object(H.a)({documentId:e,indices:t,scopeId:n});return r?null:i.a.createElement(C,{title:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by ancestry",values:{count:c}}),loading:a,alertIds:l,scopeId:n,eventId:e,noItemsMessage:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsNoDataDescription",defaultMessage:"No alerts related by ancestry."}),"data-test-subj":s.f})};W.displayName="RelatedAlertsByAncestry";var Q=n(813),Y=n(253),K=n(730),J=n(165);const Z=({dataAsNestedObject:e,alertSuppressionCount:t,isPreview:n})=>{var a;const l=null===(a=Object(b.get)(e,Q.o))||void 0===a?void 0:a[0],c=i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.suppressedAlertsTitle",defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:t}})),Object(J.l)(l)?null:i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiBetaBadge,{label:Y.w,style:{verticalAlign:"middle"},size:"s","data-test-subj":s.M}))),u=t>0&&!n&&i.a.createElement("div",{"data-test-subj":`${s.k}InvestigateInTimeline`},i.a.createElement(K.a,{ecsRowData:e,buttonType:"emptyButton"}));return i.a.createElement(k.a,{header:{title:c,iconType:"layers",headerContent:u},"data-test-subj":s.k})};Z.displayName="SuppressedAlerts";var X=n(277),ee=n(131);const te="correlations",ne=()=>{const{dataAsNestedObject:e,eventId:t,getFieldsData:n,scopeId:a,isPreview:l}=Object(V.b)(),{selectedPatterns:c}=Object(X.a)(Object(ee.isActiveTimeline)(a)),{show:u,documentId:d}=Object(B.a)({getFieldsData:n,dataAsNestedObject:e,eventId:t,isPreview:l}),{show:p,originalEventId:m}=Object(U.a)({eventId:t,getFieldsData:n}),{show:f,entityId:g}=Object(G.a)({getFieldsData:n}),b=Object(q.a)({getFieldsData:n}),{show:y,alertSuppressionCount:h}=Object($.a)({getFieldsData:n}),v=u||p||f||b||y;return i.a.createElement(r.EuiPanel,{paddingSize:"none","data-test-subj":s.l,color:"transparent"},v?i.a.createElement(r.EuiFlexGroup,{gutterSize:"l",direction:"column"},y&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(Z,{alertSuppressionCount:h,dataAsNestedObject:e,isPreview:l})),b&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(z,{eventId:t})),p&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(P,{originalEventId:m,scopeId:a,eventId:t})),f&&g&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(F,{entityId:g,scopeId:a,eventId:t})),u&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(W,{indices:c,scopeId:a,documentId:d}))):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};ne.displayName="CorrelationsDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(5);const i=`${a.Lb}/fleet/integrations/all`,r=`${a.Lb}/fleet/integrations/installed`},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return v}));var a=n(2),i=n.n(a),r=n(78),o=n(242),s=n(65),l=n(36),c=n(118),u=n(267),d=n(393),p=n(66),m=n(194);let f=function(e){return e.addToExistingCase="addToExistingCase",e.addToNewCase="addToNewCase",e.inspect="inspect",e.openInLens="openInLens",e.saveToLibrary="saveToLibrary",e}({});const g=[f.inspect,f.addToNewCase,f.addToExistingCase,f.saveToLibrary,f.openInLens],b=[f.inspect],y={id:"VISUALIZATION_CONTEXT_MENU_TRIGGER"},h={[f.inspect]:{id:f.inspect,getDisplayName:()=>u.k,getIconType:()=>"inspect",type:"actionButton",order:4},[f.addToNewCase]:{id:f.addToNewCase,getDisplayName:()=>u.d,getIconType:()=>"casesApp",type:"actionButton",order:3},[f.addToExistingCase]:{id:f.addToExistingCase,getDisplayName:()=>u.c,getIconType:()=>"casesApp",type:"actionButton",order:2},[f.saveToLibrary]:{id:f.saveToLibrary,getDisplayName:()=>u.a,getIconType:()=>"save",type:"actionButton",order:1},[f.openInLens]:{id:f.openInLens,getDisplayName:()=>u.m,getIconType:()=>"visArea",type:"actionButton",order:0}},v=({attributes:e,lensMetadata:t,extraActions:n,inspectActionProps:b,timeRange:y,withActions:v=g})=>{const{services:E}=Object(o.c)(),{lens:{navigateToPrefilledEditor:x,canUseEditor:j}}=E,S=Object(a.useCallback)((()=>{y&&e&&x({id:"",timeRange:y,attributes:e},{openInNewTab:!0})}),[e,x,y]),{disabled:O,onAddToExistingCaseClicked:k}=(({onAddToCaseClicked:e,lensAttributes:t,timeRange:n,lensMetadata:i})=>{const{cases:r}=Object(c.j)().services,o=r.helpers.canUseCases([l.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:n,metadata:i},persistableStateAttachmentTypeId:s.LENS_ATTACHMENT_TYPE,type:s.AttachmentType.persistableState}]),[t,i,n]),{open:p}=r.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:u.b}});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),p({getAttachments:()=>d})}),[d,e,p]),disabled:null==t||null==n||!o.create||!o.read}})({lensAttributes:e,timeRange:y,lensMetadata:t}),{onAddToNewCaseClicked:w,disabled:T}=(({onClick:e,timeRange:t,lensAttributes:n,lensMetadata:i})=>{const{cases:r}=Object(c.j)().services,o=r.helpers.canUseCases([l.APP_ID]),d=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:n,timeRange:t,metadata:i},persistableStateAttachmentTypeId:s.LENS_ATTACHMENT_TYPE,type:s.AttachmentType.persistableState}]),[n,i,t]),{open:p}=r.hooks.useCasesAddToNewCaseFlyout({toastContent:u.b});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),p({attachments:d})}),[d,p,e]),disabled:null==n||null==t||!o.create||!o.read}})({timeRange:y,lensAttributes:e,lensMetadata:t}),{openSaveVisualizationFlyout:I,disableVisualizations:M}=(({attributes:e})=>{const t=Object(c.j)().services,{SaveModalComponent:n,canUseEditor:r}=t.lens,o=Object(m.m)(),{redirectTo:s,getEditOrCreateDashboardPath:u}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(c.k)(),n=Object(a.useMemo)((()=>`${e({deepLinkId:l.SecurityPageName.dashboards})}`),[e]),i=Object(a.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),r=Object(a.useCallback)((t=>`${e({deepLinkId:l.SecurityPageName.dashboards,path:i(t)})}`),[i,e]);return{redirectTo:Object(a.useCallback)((e=>{"listing"===e.destination&&t({url:n}),"dashboard"===e.destination&&t({url:r(e.id)})}),[n,r,t]),getEditOrCreateDashboardPath:i,getEditOrCreateDashboardUrl:r,dashboardListingUrl:n}})({getSecuritySolutionUrl:o});return{openSaveVisualizationFlyout:Object(a.useCallback)((()=>{const a=document.createElement("div");Object(d.a)(i.a.createElement(n,{initialInput:e,onSave:()=>Object(p.unmountComponentAtNode)(a),onClose:()=>Object(p.unmountComponentAtNode)(a),originatingApp:l.APP_UI_ID,getOriginatingPath:e=>`${l.SecurityPageName.dashboards}/${u(e)}`,redirectTo:s}),t)(a)}),[n,e,u,s,t]),disableVisualizations:Object(a.useMemo)((()=>!r()||null==e),[e,r])}})({attributes:e});return Object(a.useMemo)((()=>[Object(r.createAction)({...h[f.inspect],execute:async()=>{b.handleInspectClick()},disabled:b.isInspectButtonDisabled,isCompatible:async()=>v.includes(f.inspect)}),Object(r.createAction)({...h[f.addToNewCase],execute:async()=>{w()},disabled:T,isCompatible:async()=>v.includes(f.addToNewCase)}),Object(r.createAction)({...h[f.addToExistingCase],execute:async()=>{k()},disabled:O,isCompatible:async()=>v.includes(f.addToExistingCase),order:2}),Object(r.createAction)({...h[f.saveToLibrary],execute:async()=>{I()},disabled:M,isCompatible:async()=>v.includes(f.saveToLibrary),order:1}),Object(r.createAction)({...h[f.openInLens],execute:async()=>{S()},isCompatible:async()=>j()&&v.includes(f.openInLens),order:0}),...null!=n?n:[]].map(((e,t,n)=>({...e,order:Math.max(n.length-(1+t),0)})))),[j,M,n,b,O,T,k,w,S,I,v])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return k})),n.d(t,"a",(function(){return _e}));var a=n(44),i=n(2),r=n.n(i),o=n(121),s=n(315),l=n(19),c=n(134),u=n(316),d=n(278),p=n(150),m=n(317),f=n(593),g=n(836);const b=e=>null==e||"unset"===e.toLowerCase(),y=r.a.memo((({contextId:e,eventId:t,primary:n,secondary:a,isDraggable:i})=>b(n)&&b(a)?null:!b(n)&&b(a)?r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:i,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):b(n)&&!b(a)||n===a?r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:i,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):r.a.createElement(l.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:i,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(p.c,{grow:!1,component:"span"},u.i),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:i,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))));y.displayName="PrimarySecondary";const h=r.a.memo((({contextId:e,eventId:t,userName:n,primary:a,secondary:i,isDraggable:o})=>b(n)&&b(a)&&b(i)?null:b(n)||b(a)||b(i)||n!==a||n!==i?!b(n)&&b(a)&&b(i)?r.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):r.a.createElement(y,{contextId:e,eventId:t,isDraggable:o,primary:a,secondary:i}):r.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})));h.displayName="PrimarySecondaryUserInfo";const v=r.a.memo((({eventId:e,contextId:t,hostName:n,userName:a,primary:i,secondary:o,workingDirectory:s,session:l,isDraggable:d})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(p.c,{grow:!1,component:"span"},u.Vb),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.session",value:l,iconType:"number",isDraggable:d,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(h,{contextId:t,eventId:e,userName:a,primary:i,secondary:o,isDraggable:d})),null!=n&&r.a.createElement(p.c,{grow:!1,component:"span"},"@"),r.a.createElement(g.a,{contextId:t,eventId:e,workingDirectory:s,hostName:n,isDraggable:d}))));v.displayName="SessionUserHostWorkingDir";const E=r.a.memo((({id:e,contextId:t,hostName:n,userName:a,primary:i,processName:o,processPid:s,processExecutable:d,processTitle:g,secondary:b,workingDirectory:y,args:h,result:E,session:x,text:j,isDraggable:S})=>r.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(v,{eventId:e,contextId:t,hostName:n,userName:a,primary:i,secondary:b,workingDirectory:y,session:x,isDraggable:S}),null!=d&&r.a.createElement(p.c,{grow:!1,component:"span"},j),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,processPid:s,processName:o,processExecutable:d,isDraggable:S})),r.a.createElement(f.a,{eventId:e,args:h,contextId:t,isDraggable:S,processTitle:g}),null!=E&&r.a.createElement(p.c,{grow:!1,component:"span"},u.pc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:S,queryValue:E,value:E,isAggregatable:!0,fieldType:"keyword"})))));E.displayName="AuditdGenericLine";const x=r.a.memo((({data:e,contextId:t,isDraggable:n,text:i,timelineId:o})=>{const s=e._id,c=Object(a.get)("auditd.session[0]",e),u=Object(a.get)("host.name[0]",e),m=Object(a.get)("user.name[0]",e),f=Object(a.get)("auditd.result[0]",e),g=Object(a.get)("process.pid[0]",e),b=Object(a.get)("process.name[0]",e),y=Object(a.get)("process.executable[0]",e),h=Object(a.get)("process.title[0]",e),v=Object(a.get)("process.working_directory[0]",e),x=Object(a.get)("auditd.summary.actor.primary[0]",e),j=Object(a.get)("auditd.summary.actor.secondary[0]",e),S=Object(a.get)("process.args",e);return null!=e.process?r.a.createElement(p.b,null,r.a.createElement(E,{id:s,contextId:t,text:i,hostName:u,userName:m,processName:b,processPid:g,processExecutable:y,processTitle:h,workingDirectory:v,args:S,session:c,primary:x,result:f,secondary:j,isDraggable:n}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:n,timelineId:o})):null}));x.displayName="AuditdGenericDetails";const j=r.a.memo((({id:e,contextId:t,hostName:n,userName:a,result:i,primary:o,secondary:s,filePath:d,processName:g,processPid:b,processExecutable:y,processTitle:h,workingDirectory:E,args:x,session:j,text:S,fileIcon:O,isDraggable:k})=>r.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(v,{eventId:e,contextId:t,hostName:n,userName:a,primary:o,secondary:s,workingDirectory:E,session:j,isDraggable:k}),(null!=d||null!=y)&&r.a.createElement(p.c,{grow:!1,component:"span"},S),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"file.path",isDraggable:k,value:d,iconType:O})),null!=y&&r.a.createElement(p.c,{grow:!1,component:"span"},u.kc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,isDraggable:k,processPid:b,processName:g,processExecutable:y})),r.a.createElement(f.a,{eventId:e,args:x,contextId:t,isDraggable:k,processTitle:h}),null!=i&&r.a.createElement(p.c,{grow:!1,component:"span"},u.pc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:k,queryValue:i,value:i})))));j.displayName="AuditdGenericFileLine";const S=r.a.memo((({data:e,contextId:t,text:n,fileIcon:i="document",timelineId:o,isDraggable:s})=>{const c=e._id,u=Object(a.get)("auditd.session[0]",e),m=Object(a.get)("host.name[0]",e),f=Object(a.get)("user.name[0]",e),g=Object(a.get)("auditd.result[0]",e),b=Object(a.get)("process.pid[0]",e),y=Object(a.get)("process.name[0]",e),h=Object(a.get)("process.executable[0]",e),v=Object(a.get)("process.title[0]",e),E=Object(a.get)("process.working_directory[0]",e),x=Object(a.get)("file.path[0]",e),S=Object(a.get)("auditd.summary.actor.primary[0]",e),O=Object(a.get)("auditd.summary.actor.secondary[0]",e),k=Object(a.get)("process.args",e);return null!=e.process?r.a.createElement(p.b,null,r.a.createElement(j,{id:c,contextId:t,text:n,hostName:m,userName:f,filePath:x,processName:y,processPid:b,processExecutable:h,processTitle:v,workingDirectory:E,args:k,session:u,primary:S,secondary:O,fileIcon:i,result:g,isDraggable:s}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:s,timelineId:o})):null}));S.displayName="AuditdGenericFileDetails";const O=({actionName:e,text:t})=>({id:o.e.auditd,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"auditd"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(s.a,null,r.a.createElement(x,{data:n,isDraggable:a,contextId:`${e}-${i}`,text:t,timelineId:i}))}),k=({actionName:e,text:t,fileIcon:n="document"})=>({id:o.e.auditd_file,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"auditd"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:a,isDraggable:i,scopeId:o})=>r.a.createElement(s.a,null,r.a.createElement(S,{contextId:`${e}-${o}`,data:a,fileIcon:n,isDraggable:i,text:t,timelineId:o}))}),w=O({actionName:"was-authorized",text:u.oc}),T=O({actionName:"started-session",text:u.Yb}),I=O({actionName:"logged-in",text:u.m}),M=O({actionName:"login",text:u.m}),C=O({actionName:"executed",text:u.gb}),_=O({actionName:"ended-session",text:u.eb}),D=O({actionName:"acquired-credentials",text:u.e}),A=O({actionName:"disposed-credentials",text:u.db}),F=O({actionName:"connected-to",text:u.T}),N=k({actionName:"opened-file",text:u.Db}),P=O({actionName:"changed-file-attributes-of",text:u.y}),R=k({actionName:"changed-file-permissions-of",text:u.A}),L=k({actionName:"changed-file-ownership-of",text:u.z}),z=O({actionName:"loaded-kernel-module",text:u.ob}),q=O({actionName:"unloaded-kernel-module",text:u.gc}),B=k({actionName:"created-directory",text:u.V,fileIcon:"folderOpen"}),$=k({actionName:"mounted",text:u.Bb}),V=k({actionName:"renamed",text:u.Ob}),U=k({actionName:"checked-metadata-of",text:u.S}),G=k({actionName:"checked-filesystem-metadata-of",text:u.Q}),H=k({actionName:"symlinked",text:u.dc}),W=k({actionName:"unmounted",text:u.ic}),Q=k({actionName:"deleted",text:u.Z}),Y=k({actionName:"changed-timestamp-of",text:u.N}),K=O({actionName:"listen-for-connections",text:u.mb}),J=O({actionName:"bound-socket",text:u.t}),Z=O({actionName:"received-from",text:u.Hb}),X=O({actionName:"sent-to",text:u.Ub}),ee=O({actionName:"killed-pid",text:u.lb}),te=O({actionName:"changed-identity-of",text:u.D}),ne=O({actionName:"changed-system-time",text:u.M}),ae=O({actionName:"make-device",text:u.ub}),ie=O({actionName:"changed-system-name",text:u.L}),re=O({actionName:"allocated-memory",text:u.h}),oe=O({actionName:"adjusted-scheduling-policy-of",text:u.Rb}),se=O({actionName:"added-user-account",text:u.g}),le=O({actionName:"caused-mac-policy-error",text:u.u}),ce=O({actionName:"loaded-firewall-rule-to",text:u.nb}),ue=O({actionName:"changed-promiscuous-mode-on-device",text:u.H}),de=O({actionName:"locked-account",text:u.rb}),pe=O({actionName:"unlocked-account",text:u.hc}),me=O({actionName:"added-group-account-to",text:u.f}),fe=O({actionName:"crashed-program",text:u.U}),ge=O({actionName:"attempted-execution-of-forbidden-program",text:u.hb}),be=O({actionName:"used-suspcious-link",text:u.jc}),ye=O({actionName:"used-suspicious-link",text:u.jc}),he=O({actionName:"failed-log-in-too-many-times-to",text:u.ib}),ve=O({actionName:"failed-login-too-many-times-to",text:u.ib}),Ee=O({actionName:"attempted-log-in-from-unusual-place-to",text:u.o}),xe=O({actionName:"attempted-login-from-unusual-place-to",text:u.o}),je=O({actionName:"opened-too-many-sessions-to",text:u.Eb}),Se=O({actionName:"attempted-log-in-during-unusual-hour-to",text:u.n}),Oe=O({actionName:"attempted-login-during-unusual-hour-to",text:u.n}),ke=O({actionName:"tested-file-system-integrity-of",text:u.ec}),we=O({actionName:"violated-selinux-policy",text:u.nc}),Te=O({actionName:"violated-apparmor-policy",text:u.lc}),Ie=O({actionName:"changed-group",text:u.B}),Me=O({actionName:"changed-user-id",text:u.P}),Ce=O({actionName:"changed-auditd-configuration",text:u.v}),_e=[C,I,M,w,D,_,A,T,F,N,P,R,L,z,q,B,$,V,U,G,H,W,Q,Y,K,J,Z,X,ee,te,ne,ae,ie,re,oe,se,me,ge,le,ue,fe,ce,de,be,ye,pe,he,ve,xe,je,Ee,Se,Oe,ke,we,Te,Ie,Me,O({actionName:"changed-audit-configuration",text:u.v}),O({actionName:"refreshed-credentials",text:u.Jb}),O({actionName:"negotiated-crypto-key",text:u.Cb}),O({actionName:"crypto-officer-logged-in",text:u.X}),O({actionName:"crypto-officer-login",text:u.X}),O({actionName:"crypto-officer-logged-out",text:u.Y}),O({actionName:"crypto-officer-logout",text:u.Y}),O({actionName:"started-crypto-session",text:u.ac}),O({actionName:"access-result",text:u.d}),O({actionName:"aborted-auditd-startup",text:u.a}),O({actionName:"aborted-audit-startup",text:u.a}),O({actionName:"remote-audit-connected",text:u.Lb}),O({actionName:"remote-audit-disconnected",text:u.Mb}),O({actionName:"shutdown-audit",text:u.Wb}),O({actionName:"audit-error",text:u.p}),O({actionName:"reconfigured-auditd",text:u.Ib}),O({actionName:"reconfigured-audit",text:u.Ib}),O({actionName:"resumed-audit-logging",text:u.Pb}),O({actionName:"rotated-audit-logs",text:u.Qb}),O({actionName:"started-audit",text:u.Zb}),O({actionName:"deleted-group-account-from",text:u.ab}),O({actionName:"deleted-user-account",text:u.bb}),O({actionName:"changed-audit-feature",text:u.w}),O({actionName:"relabeled-filesystem",text:u.Kb}),O({actionName:"authenticated-to-group",text:u.q}),O({actionName:"changed-group-password",text:u.C}),O({actionName:"modified-group-account",text:u.xb}),O({actionName:"initialized-audit-subsystem",text:u.jb}),O({actionName:"modified-level-of",text:u.yb}),O({actionName:"overrode-label-of",text:u.Fb}),O({actionName:"changed-login-id-to",text:u.E}),O({actionName:"mac-permission",text:u.tb}),O({actionName:"changed-selinux-boolean",text:u.J}),O({actionName:"loaded-selinux-policy",text:u.qb}),O({actionName:"changed-selinux-enforcement",text:u.K}),O({actionName:"assigned-user-role-to",text:u.j}),O({actionName:"modified-role",text:u.zb}),O({actionName:"removed-use-role-from",text:u.Nb}),O({actionName:"removed-user-role-from",text:u.Nb}),Ce,O({actionName:"violated-seccomp-policy",text:u.mc}),O({actionName:"started-service",text:u.bc}),O({actionName:"stopped-service",text:u.cc}),O({actionName:"booted-system",text:u.s}),O({actionName:"changed-to-runlevel",text:u.O}),O({actionName:"shutdown-system",text:u.Xb}),O({actionName:"sent-test",text:u.Tb}),O({actionName:"unknown",text:u.fc}),O({actionName:"sent-message",text:u.Sb}),O({actionName:"access-permission",text:u.c}),O({actionName:"authenticated",text:u.r}),O({actionName:"changed-password",text:u.G}),O({actionName:"ran-command",text:u.Gb}),O({actionName:"error",text:u.fb}),O({actionName:"logged-out",text:u.sb}),O({actionName:"logout",text:u.sb}),O({actionName:"changed-mac-configuration",text:u.F}),O({actionName:"loaded-mac-policy",text:u.pb}),O({actionName:"modified-user-account",text:u.Ab}),O({actionName:"changed-role-to",text:u.I}),O({actionName:"access-error",text:u.b}),O({actionName:"changed-configuration",text:u.x}),O({actionName:"issued-vm-control",text:u.kb}),O({actionName:"created-vm-image",text:u.W}),O({actionName:"deleted-vm-image",text:u.cb}),O({actionName:"checked-integrity-of",text:u.R}),O({actionName:"assigned-vm-id",text:u.k}),O({actionName:"migrated-vm-from",text:u.vb}),O({actionName:"migrated-vm-to",text:u.wb}),O({actionName:"assigned-vm-resource",text:u.l})]},function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return y}));var a=n(204),i=n(818),r=n(159);const o=(e,t,n)=>{const{pagination:a,search:i,filters:r}=n||{};let o=[],s=[];return Array.isArray(e)&&e.length?(o=e.map((e=>e.list_id)),s=e.map((e=>e.namespace_type))):t&&(o=[t.list_id],s=[t.namespace_type]),{listIds:o,namespaceTypes:s,pagination:a,search:i,filters:r}},s=async({namespaceTypes:e,listIds:t,http:n,pagination:r,search:o})=>{try{const s=new AbortController,{pageIndex:l,pageSize:c,totalItemCount:u}=r||{},{page:d,per_page:p,total:m,data:f}=await Object(a.n)({filter:void 0,http:n,listIds:null!=t?t:[],namespaceTypes:null!=e?e:[],search:o,pagination:{perPage:c,page:(l||0)+1,total:u},signal:s.signal});return{data:f.map((e=>Object(i.b)(e))),pagination:{pageIndex:d-1,pageSize:p,totalItemCount:m}}}catch(e){throw new Error(e)}},l=async e=>{try{const t=new AbortController,{references:n}=await Object(r.l)({lists:e.map((e=>({id:e.id,listId:e.list_id,namespaceType:e.namespace_type}))),signal:t.signal});return n.reduce(((e,t)=>({...e,...t})),{})}catch(e){throw new Error(e)}},c=async({id:e,namespaceType:t,http:n})=>{try{const i=new AbortController;await Object(a.e)({http:n,id:e,namespaceType:t,signal:i.signal})}catch(e){throw new Error(e)}};var u=n(1622),d=n(82),p=n(245);const m=async({id:e,http:t})=>{try{const n=new AbortController,i=Object(u.a)({filters:{list_id:e},namespaceTypes:["single","agnostic"],hideLists:p.a}),r=["single","agnostic"].join(),{data:o}=await Object(a.m)({filters:i,http:t,signal:n.signal,namespaceTypes:r,pagination:{}});return n.abort(),o&&o.length?o[0]:null}catch(e){throw new Error(e)}},f=async e=>{try{const t=new AbortController,{data:n}=await Object(r.j)({signal:t.signal,pagination:{page:1,perPage:1e4}});return t.abort(),n.reduce(((t,n,a)=>{var i;return(null===(i=n.exceptions_list)||void 0===i?void 0:i.find((t=>t.list_id===e)))&&t.push(n),t}),[])}catch(e){throw new Error(e)}},g=async({list:e,http:t})=>{try{const n=new AbortController;await Object(a.x)({http:t,list:e,signal:n.signal}),n.abort()}catch(e){throw new Error(e)}},b=async({rules:e,listId:t})=>{try{if(!e.length)return;const n=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var a;const i=(null!==(a=e.exceptions_list)&&void 0!==a?a:[]).filter((({list_id:e})=>e!==t));await Object(r.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:i},signal:n.signal})}))}catch(e){throw new Error(e)}},y=async({rules:e,listId:t,id:n,listType:a,listNamespaceType:i})=>{try{if(!e.length)return;const o=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var s;const l={list_id:t,id:n,type:a,namespace_type:i},c=[...null!==(s=e.exceptions_list)&&void 0!==s?s:[],l];await Object(r.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:c},signal:o.signal})}))}catch(e){throw new Error(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(2),i=n(607),r=n(608),o=n(53),s=n(47),l=n(118),c=n(277),u=n(131),d=n(127);const p="fieldNames",m="eventKind",f="hostName",g="userName",b="hosts",y="users",h=(e,t,n,a)=>{const i=Object(o.buildEsQuery)(void 0,[],[{query:{bool:{filter:[{range:{"@timestamp":{gte:t,lte:n}}}]}},meta:{}}]);return v(i,e,a)},v=(e,t,n)=>({params:{index:n,body:{query:e,aggs:{[p]:{filters:{filters:t},aggs:{[f]:{cardinality:{field:"host.name"}},[g]:{cardinality:{field:"user.name"}},[m]:{terms:{field:"event.kind",size:10}}}},[b]:{cardinality:{field:"host.name"}},[y]:{cardinality:{field:"user.name"}}},size:0}}});var E=n(192);const x=({interval:e,dataFormattedForFieldBrowser:t,investigationFields:n})=>{const o=Object(i.a)({dataFormattedForFieldBrowser:t,investigationFields:n}),v=Object(a.useMemo)((()=>Object(r.a)(o)),[o]),{data:x,loading:j,error:S}=(({highlightedFieldsFilters:e,interval:{from:t,to:n}})=>{const{services:{data:{search:a}}}=Object(l.j)(),{selectedPatterns:i}=Object(c.a)(Object(u.isActiveTimeline)(d.SourcererScopeName.default)),r=h(e,t,n,i),{data:o,isLoading:p,isError:m}=Object(s.useQuery)(["useFetchFieldValuePairWithAggregation",e,t,n],(()=>(async(e,t)=>{let n;return new Promise(((a,i)=>{e.search(t).subscribe({next:e=>{n=e.rawResponse},complete:()=>{a(n)},error:e=>{i(e)}})}))})(a,r)));return{loading:p,error:m,data:o}})({highlightedFieldsFilters:v,interval:e}),O=[];if(x&&x.aggregations){const e=x.aggregations[b].value,t=x.aggregations[y].value;Object.keys(x.aggregations[p].buckets).forEach((n=>{var a;const i=o[n].values,r=(null===(a=x.aggregations[p].buckets[n][m].buckets.find((e=>e.key===E.a.signal)))||void 0===a?void 0:a.doc_count)||0;let s=0;x.aggregations[p].buckets[n][m].buckets.reduce(((e,t)=>(t.key!==E.a.signal&&(s+=t.doc_count),e)),s);const l=x.aggregations[p].buckets[n][f].value,c=x.aggregations[p].buckets[n][g].value,u=e?l/e:0,d=t?c/t:0;O.push({field:n,values:i,alertCount:r,docCount:s,hostPrevalence:u,userPrevalence:d})}))}return{loading:j,error:S,data:O}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(134),c=n(144),u=n(4);const d=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.clientCertLabel",{defaultMessage:"client cert"}),p=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.serverCertLabel",{defaultMessage:"server cert"}),m="tls.client_certificate.fingerprint.sha1",f="tls.server_certificate.fingerprint.sha1",g=s.a.span.withConfig({displayName:"FingerprintLabel",componentId:"sc-1isap0l-0"})(["margin-right:5px;"]);g.displayName="FingerprintLabel";const b=r.a.memo((({eventId:e,certificateType:t,contextId:n,fieldName:i,isDraggable:o,value:s})=>r.a.createElement(l.c,{contextId:n,"data-test-subj":`${t}-certificate-fingerprint`,eventId:e,field:i,iconType:"snowflake",isDraggable:o,tooltipContent:r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement("span",null,i)),value:s,isAggregatable:!0,fieldType:"keyword"},r.a.createElement(g,null,"client"===t?d:p),r.a.createElement(c.b,{certificateFingerprint:s||""}))));b.displayName="CertificateFingerprint"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(134),l=n(144);const c=n(4).i18n.translate("xpack.securitySolution.ja3.fingerprint.ja3.fingerprintLabel",{defaultMessage:"ja3"}),u="tls.fingerprints.ja3.hash",d=o.a.span.withConfig({displayName:"Ja3FingerprintLabel",componentId:"sc-94sjip-0"})(["margin-right:5px;"]);d.displayName="Ja3FingerprintLabel";const p=i.a.memo((({contextId:e,eventId:t,fieldName:n,isDraggable:a,value:r})=>i.a.createElement(s.c,{contextId:e,"data-test-subj":"ja3-hash",eventId:t,field:n,iconType:"snowflake",isDraggable:a,value:r,isAggregatable:!0,fieldType:"keyword"},i.a.createElement(d,null,c),i.a.createElement(l.e,{"data-test-subj":"ja3-hash-link",ja3Fingerprint:r||""}))));p.displayName="Ja3Fingerprint"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(19),o=n(4),s=n(436),l=n(5),c=n(118);const u=`${n(211).a}Tour`,d=o.i18n.translate("xpack.securitySolution.flyout.tour.subtitle",{defaultMessage:"A redesigned alert experience"}),p=({tourStepContent:e,totalSteps:t,goToOverviewTab:n,goToLeftPanel:p})=>{const{services:{storage:m}}=Object(c.j)(),[f,g]=Object(a.useState)((()=>{const e=m.get(l.cc.FLYOUT);return null!=e?e:s.c}));Object(a.useEffect)((()=>{m.set(l.cc.FLYOUT,f),f.isTourActive&&1===f.currentTourStep&&n&&n()}),[m,f,n]);const b=Object(a.useCallback)((()=>{g((e=>(3===e.currentTourStep&&p&&p(),{...e,currentTourStep:e.currentTourStep+1})))}),[p]),y=Object(a.useCallback)((()=>{g((e=>({...e,isTourActive:!1})))}),[]),h=Object(a.useCallback)((e=>e===t?i.a.createElement(r.EuiButton,{color:"success",size:"s",onClick:y},o.i18n.translate("xpack.securitySolution.flyout.tour.finish.text",{defaultMessage:"Finish"})):[i.a.createElement(r.EuiButtonEmpty,{size:"s",color:"text",onClick:y},o.i18n.translate("xpack.securitySolution.flyout.tour.exit.text",{defaultMessage:"Exit"})),i.a.createElement(r.EuiButton,{color:"success",size:"s",onClick:b},o.i18n.translate("xpack.securitySolution.flyout.tour.Next.text",{defaultMessage:"Next"}))]),[y,b,t]);return f.isTourActive?i.a.createElement(i.a.Fragment,null,e.map((e=>{const n=e.stepNumber;if(f.currentTourStep!==n)return null;const a={"data-test-subj":`${u}-${n}`};return i.a.createElement(r.EuiTourStep,{panelProps:a,key:n,step:n,isStepOpen:f.isTourActive,maxWidth:500,stepsTotal:t,onFinish:y,title:e.title,content:e.content,anchor:`[data-test-subj=${e.anchor}]`,anchorPosition:e.anchorPosition,footerAction:h(n),subtitle:d})}))):null};p.displayName="FlyoutTour"},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19),l=n(5),c=n(4);const u=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.unknownAvatarName",{defaultMessage:"Uknown"}),d=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.addCommentPlaceholder",{defaultMessage:"Add a new comment..."});var p=n(118),m=n(343);const f="exceptionCommentAccordionButton",g=o()(s.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-ggp4j5-0"})(["",""],(({theme:e})=>Object(r.css)(["margin-right:",";"],e.eui.euiSizeS))),b=o()(s.EuiAccordion).withConfig({displayName:"CommentAccordion",componentId:"sc-ggp4j5-1"})(["",""],(({theme:e})=>Object(r.css)([".","{color:",";padding:"," 0;}"],f,e.eui.euiColorPrimary,e.eui.euiSizeM))),y=Object(a.memo)((function({exceptionItemComments:e,newCommentValue:t,accordionTitle:n,initialIsOpen:r=!1,newCommentOnChange:o,setCommentError:y}){const[h,v]=Object(a.useState)(!1),[E,x]=Object(a.useState)(!1),j=Object(p.f)(),S=null==j?void 0:j.fullName,O=null==j?void 0:j.username,k=null==j?void 0:j.email,w=Object(a.useMemo)((()=>S&&S.length>0?S:k&&k.length>0?k:O&&O.length>0?O:u),[S,k,O]);Object(a.useEffect)((()=>{y(h)}),[h,y]);const T=Object(a.useCallback)((e=>{o(e.target.value),v(e.target.value.length>l.Vb)}),[o]),I=Object(a.useCallback)((e=>{x(e)}),[]),M=Object(a.useMemo)((()=>{return e&&e.length>0?i.a.createElement(s.EuiText,{size:"s","data-test-subj":"ExceptionItemCommentsAccordionButton"},E?(e=>c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.hideCommentsLabel",{values:{comments:e},defaultMessage:"Hide ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))(e.length):(t=e.length,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.showCommentsLabel",{values:{comments:t},defaultMessage:"Show ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))):null;var t}),[e,E]),C=Object(a.useMemo)((()=>e&&e.length>0?Object(m.j)(e):[]),[e]);return i.a.createElement("div",null,i.a.createElement(b,{initialIsOpen:r&&!!t,id:"add-exception-comments-accordion",buttonClassName:f,buttonContent:null!=n?n:M,"data-test-subj":"exceptionItemCommentsAccordion",onToggle:e=>I(e)},i.a.createElement(s.EuiCommentList,{comments:C}),i.a.createElement(s.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(g,{name:w,size:"l","data-test-subj":"exceptionItemCommentAvatar"})),i.a.createElement(s.EuiFlexItem,{grow:1},i.a.createElement(s.EuiFormRow,{fullWidth:!0,error:(_=l.Vb,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.maxLengthError",{values:{length:_},defaultMessage:"The length of the comment is too long. The maximum length is {length} characters."})),isInvalid:h},i.a.createElement(s.EuiTextArea,{placeholder:d,"aria-label":"Comment Input",value:t,onChange:T,fullWidth:!0,"data-test-subj":"newExceptionItemCommentTextArea"}))))));var _}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j}));var a=n(2),i=n.n(a),r=n(19),o=n(847),s=n.n(o),l=n(728),c=n(741),u=n(175),d=n(336),p=n(5),m=n(127),f=n(441),g=n(1209),b=n(132),y=n(246),h=n(125),v=n(153),E=n(339);const x="threatIntelligence",j=()=>{const{enrichments:e,eventFields:t,isEnrichmentsLoading:n,isEventDataLoading:o,isLoading:x,range:j,setRange:S}=(()=>{const{indexName:e,eventId:t}=Object(h.b)(),[{pageName:n}]=Object(y.a)(),i=n===p.Oc.detections?m.SourcererScopeName.detections:m.SourcererScopeName.default,r=Object(b.a)(i),[o,s]=Object(g.a)({indexName:e,eventId:t,runtimeMappings:r.runtimeMappings,skip:!t}),{isAlert:l}=Object(u.b)(s),c=Object(a.useMemo)((()=>s||[]),[s]),v=Object(a.useMemo)((()=>Object(d.c)(c||[])),[c]),{result:E,loading:x,setRange:j,range:S}=Object(f.c)(v),O=Object(a.useMemo)((()=>l?Object(d.g)(c).map((e=>Object(d.h)(e))):[]),[c,l]);return{enrichments:Object(a.useMemo)((()=>x||null==E||!E.enrichments?O:Object(d.b)([...O,...E.enrichments])),[x,E,O]),eventFields:v,isEnrichmentsLoading:x,isEventDataLoading:o,isLoading:x||o,range:S,setRange:j}})();return o?i.a.createElement(E.a,{"data-test-subj":v.N}):i.a.createElement(c.a,{before:null,loading:x,enrichments:e,showInvestigationTimeEnrichments:!s()(t)},i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{setRange:S,loading:n,range:j}),i.a.createElement(r.EuiSpacer,{size:"m"})))};j.displayName="ThreatIntelligenceDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(19),i=n(54),r=n.n(i),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(50),d=n(430),p=n(196);d.f;const m=c.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);m.displayName="TitleText",s.a.memo((({noteIds:e})=>s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiTitle,{size:"s"},s.a.createElement(m,null,d.e))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(p.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e,user:t})=>({created:r.a.utc().toDate(),id:Object(u.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),g=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a,user:i})=>{const r=f({newNote:t,user:i});a(r),e(r.id),n("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importStar(n(2)),r=n(2),o=a.__importDefault(n(327)),s=a.__importDefault(n(991));t.default=function(e){return function(t){var n,l;l=i.isValidElement(t)?(n=t).props:t;var c=o.default({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1}),u=c[0],d=c[1],p=r.useRef(null),m=function(e,t){return function(n){try{t&&t(n)}finally{e&&e(n)}}},f=function(){return d({paused:!1})},g=function(){return d({paused:!0})},b=function(){var e=p.current;e&&d({muted:e.muted,volume:e.volume})},y=function(){var e=p.current;if(e){var t=e.duration,n=e.buffered;d({duration:t,buffered:s.default(n)})}},h=function(){var e=p.current;e&&d({time:e.currentTime})},v=function(){var e=p.current;e&&d({buffered:s.default(e.buffered)})};n=n?i.cloneElement(n,a.__assign(a.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,g),onVolumeChange:m(l.onVolumeChange,b),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,h),onProgress:m(l.onProgress,v)})):i.createElement(e,a.__assign(a.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,g),onVolumeChange:m(l.onVolumeChange,b),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,h),onProgress:m(l.onProgress,v)}));var E=!1,x={play:function(){var e=p.current;if(e&&!E){var t=e.play();if("object"==typeof t){E=!0;var n=function(){E=!1};t.then(n,n)}return t}},pause:function(){var e=p.current;if(e&&!E)return e.pause()},seek:function(e){var t=p.current;t&&void 0!==u.duration&&(e=Math.min(u.duration,Math.max(0,e)),t.currentTime=e)},volume:function(e){var t=p.current;t&&(e=Math.min(1,Math.max(0,e)),t.volume=e,d({volume:e}))},mute:function(){var e=p.current;e&&(e.muted=!0)},unmute:function(){var e=p.current;e&&(e.muted=!1)}};return r.useEffect((function(){var e=p.current;e&&(d({volume:e.volume,muted:e.muted,paused:e.paused}),l.autoPlay&&e.paused&&x.play())}),[l.src]),[n,u,x,p]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return"boolean"==typeof t?t:!e};t.default=function(e){return a.useReducer(i,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(638)),o=n(372);t.default=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=null),void 0===n&&(n=null);var a=o.resolveHookState(e);"number"!=typeof a&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof n?a=Math.max(a,n):null!==n&&console.error("min has to be a number, got "+typeof n),"number"==typeof t?a=Math.min(a,t):null!==t&&console.error("max has to be a number, got "+typeof t);var s=r.default(a),l=s[0],c=s[1];return[l(),i.useMemo((function(){var e=function(e){var a=l(),i=o.resolveHookState(e,a);a!==i&&("number"==typeof n&&(i=Math.max(i,n)),"number"==typeof t&&(i=Math.min(i,t)),a!==i&&c(i))};return{get:l,set:e,inc:function(t){void 0===t&&(t=1);var n=o.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e+n}))},dec:function(t){void 0===t&&(t=1);var n=o.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e-n}))},reset:function(t){void 0===t&&(t=a);var n=o.resolveHookState(t,l());"number"!=typeof n&&console.error("value has to be a number or function returning a number, got "+typeof n),a=n,e(n)}}}),[a,n,t])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(280)),o=n(372);t.default=function(e){var t=i.useRef(o.resolveHookState(e)),n=r.default();return i.useMemo((function(){return[function(){return t.current},function(e){t.current=o.resolveHookState(e,t.current),n()}]}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useState(!1),i=n[0],r=n[1];return a.useEffect((function(){var n=function(){return r(!0)},a=function(){return r(!1)};t&&e&&e.current&&(e.current.addEventListener("mouseover",n),e.current.addEventListener("mouseout",a));var i=e.current;return function(){t&&i&&(i.removeEventListener("mouseover",n),i.removeEventListener("mouseout",a))}}),[t,e]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(557)),o=function(){};t.default=function(e,t,n,a){void 0===t&&(t=o),void 0===n&&(n={}),void 0===a&&(a=[e]);var s=n.event,l=void 0===s?"keydown":s,c=n.target,u=n.options,d=i.useMemo((function(){var n,a="function"==typeof(n=e)?n:"string"==typeof n?function(e){return e.key===n}:n?function(){return!0}:function(){return!1};return function(e){if(a(e))return t(e)}}),a);r.default(l,d,c,u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(640));t.default=function(e){var t=i.useState([!1,null]),n=t[0],a=t[1];return r.default(e,(function(e){return a([!0,e])}),{event:"keydown"},[n]),r.default(e,(function(e){return a([!1,e])}),{event:"keyup"},[n]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef(e);return t.current=e,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){a.useEffect((function(){return e&&e(),function(){t&&t()}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(280)),o=n(372);t.default=function(e){void 0===e&&(e=[]);var t=i.useRef(o.resolveHookState(e)),n=r.default(),a=i.useMemo((function(){var i={set:function(e){t.current=o.resolveHookState(e,t.current),n()},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length&&a.set((function(t){return t.concat(e)}))},updateAt:function(e,t){a.set((function(n){var a=n.slice();return a[e]=t,a}))},insertAt:function(e,t){a.set((function(n){var a=n.slice();return e>a.length?a[e]=t:a.splice(e,0,t),a}))},update:function(e,t){a.set((function(n){return n.map((function(n){return e(n,t)?t:n}))}))},updateFirst:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0&&a.updateAt(i,n)},upsert:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0?a.updateAt(i,n):a.push(n)},sort:function(e){a.set((function(t){return t.slice().sort(e)}))},filter:function(e,t){a.set((function(n){return n.slice().filter(e,t)}))},removeAt:function(e){a.set((function(t){var n=t.slice();return n.splice(e,1),n}))},clear:function(){a.set([])},reset:function(){a.set(o.resolveHookState(e).slice())}};return i.remove=i.removeAt,i}),[]);return[t.current,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(){};t.default=function(e,t,n){if(!i.isClient)return[t,r,r];if(!e)throw new Error("useLocalStorage key may not be falsy");var o=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,s=a.useState((function(){try{var a=n?n.raw?String:n.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?o(i):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),l=s[0],c=s[1],u=a.useCallback((function(t){try{var a="function"==typeof t?t(l):t;if(void 0===a)return;var i;i=n?n.raw?"string"==typeof a?a:JSON.stringify(a):n.serializer?n.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,i),c(o(i))}catch(e){}}),[e,c]),d=a.useCallback((function(){try{localStorage.removeItem(e),c(void 0)}catch(e){}}),[e,c]);return[l,u,d]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(328));t.default=function(e){a.default((function(){e()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(329));t.default=function(e){var t=r.default({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(t){if(e&&e.current){var n=e.current.getBoundingClientRect(),i=n.left,r=n.top,o=n.width,s=n.height,l=i+window.pageXOffset,c=r+window.pageYOffset,u=t.pageX-l,d=t.pageY-c;a({docX:t.pageX,docY:t.pageY,posX:l,posY:c,elX:u,elY:d,elH:s,elW:o})}};return document.addEventListener("mousemove",t),function(){document.removeEventListener("mousemove",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(37));t.default=function(e,t){void 0===e&&(e=1e12),void 0===t&&(t=0);var n=i.useState(0),a=n[0],o=n[1];return r.default((function(){var n,a,i,r=function(){var t=Math.min(1,(Date.now()-i)/e);o(t),s()},s=function(){n=requestAnimationFrame(r)},l=setTimeout((function(){a=setTimeout((function(){cancelAnimationFrame(n),o(1)}),e),i=Date.now(),s()}),t);return function(){clearTimeout(a),clearTimeout(l),cancelAnimationFrame(n)}}),[e,t]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=parseInt(i.version.substr(0,i.version.indexOf(".")))>15;t.default=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var s=e.render,l=e.children,c=void 0===l?s:l,u=e.component,d=e.comp,p=void 0===d?u:d;return"function"==typeof c?c.apply(void 0,a.__spreadArrays([t],n)):p?i.createElement(p,t):c instanceof Array?r?c:i.createElement.apply(void 0,a.__spreadArrays(["div",null],c)):c&&c instanceof Object?"string"==typeof c.type?c:i.cloneElement(c,Object.assign({},c.props,t)):c||null}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return f}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),c=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),u=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),f=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return h}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),r=a.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),o=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),s=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),l=a.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),c=a.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),u=a.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),p=a.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),m=a.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),f=a.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),g=a.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),b=a.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),y=a.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),h=a.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},function(e,t,n){"use strict";e.exports=n(1085)},function(e,t,n){"use strict";e.exports=n(1086)},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1094);case"v8light":return n(1096)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(701);function i(e){return{type:Object(a.a)(e),scripted:e.scripted}}},function(e,t,n){const a=n(283);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(191);const l=o.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(r.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),s.d,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),s.d,s.d,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(r.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const c=i.a.memo(l);c.displayName="ProviderContainer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n(5),r=n(584),o=n(132),s=n(124),l=n(148),c=n(127),u=n(246),d=n(282);const p=({applyGlobalQueriesAndFilters:e=!0,applyPageAndTabsFilters:t=!0,extraOptions:n,getLensAttributes:p,lensAttributes:m,scopeId:f=c.SourcererScopeName.default,stackByField:g,title:b})=>{var y,h;const{selectedPatterns:v,dataViewId:E,indicesExist:x}=Object(o.a)(f),j=Object(a.useMemo)((()=>l.d.globalQuerySelector()),[]),S=Object(a.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),O=Object(s.a)(j),k=Object(s.a)(S),[{detailName:w,pageName:T,tabName:I}]=Object(u.a)(),M=Object(a.useMemo)((()=>I===r.a.events?T===i.Oc.network?d.h:Object(d.b)(T):[]),[T,I]),C=Object(a.useMemo)((()=>[i.Oc.hosts,i.Oc.users].indexOf(T)>=0&&null!=w?Object(d.c)(T,w):i.Oc.network===T?Object(d.e)(w):[]),[w,T]),_=Object(a.useMemo)((()=>null!=m?m:p&&g&&p(g,n)),[n,p,m,g]),D=Object.values(null!==(y=null==_||null===(h=_.state)||void 0===h?void 0:h.adHocDataViews)&&void 0!==y?y:{}).length>0,A=Object(a.useMemo)((()=>{var n;if(null==m&&(null==p||null==g||0===(null==g?void 0:g.length)))return null;const a=D?[]:Object(d.d)(v);return{..._,...null!=b?{title:b}:{},state:{..._.state,...e?{query:O}:{},filters:[..._.state.filters,...t?C:[],...t?M:[],...a,...e?k:[]]},references:null==_||null===(n=_.references)||void 0===n?void 0:n.map((e=>({...e,id:E})))}}),[e,t,_,E,k,p,D,m,C,O,v,g,M,b]);return D||!D&&x?A:null}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(47),i=n(118),r=n(123),o=n(483);const s=({uids:e})=>{const{security:t}=Object(i.j)().services,{addError:n}=Object(r.a)();return Object(a.useQuery)(["useBulkGetUserProfiles",...e],(async()=>(async({security:e,uids:t})=>0===t.size?[]:e.userProfiles.bulkGet({uids:t,dataPath:"avatar"}))({security:t,uids:e})),{retry:!1,staleTime:1/0,onError:e=>{n(e,{title:o.c})}})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return c}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),r=a.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),o=a.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),s=a.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),l=a.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),c=a.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"})},function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"q",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"k",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"u",(function(){return c})),n.d(t,"s",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"r",(function(){return f})),n.d(t,"z",(function(){return g})),n.d(t,"v",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"l",(function(){return h})),n.d(t,"y",(function(){return v})),n.d(t,"x",(function(){return E})),n.d(t,"f",(function(){return x})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return S})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return k})),n.d(t,"a",(function(){return w})),n.d(t,"e",(function(){return T})),n.d(t,"d",(function(){return I})),n.d(t,"n",(function(){return M}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryLabel",{defaultMessage:"Custom query"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlQueryLabel",{defaultMessage:"EQL query"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryFiltersLabel",{defaultMessage:"Saved query filters"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryLabel",{defaultMessage:"Saved query"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.newTermsRuleTypeDescription",{defaultMessage:"New Terms"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlRuleTypeDescription",{defaultMessage:"ES|QL"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionPerRuleExecution",{defaultMessage:"One rule execution"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionSuppressOnMissingFieldsDescription",{defaultMessage:"Suppress and group alerts for events with missing fields"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionDoNotSuppressOnMissingFieldsDescription",{defaultMessage:"Do not suppress alerts for events with missing fields"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockLabel",{defaultMessage:"Building block"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(19),i=n(42),r=n(2),o=n.n(r),s=n(118);const l=({title:e})=>{const{docLinks:t}=Object(s.j)().services,n=t.links.securitySolution.entityAnalytics;return o.a.createElement(a.EuiLink,{target:"_blank",rel:"noopener nofollow noreferrer",href:n.entityRiskScoring},e||o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.entityAnalytics.learnMore",defaultMessage:"Learn more about entity risk scoring"}))},c=o.a.memo(l);c.displayName="EntityAnalyticsLearnMoreLink"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(45),r=n(1225),o=n(131),s=n(293);const l=({alertStatus:e,closePopover:t,eventId:n,scopeId:l,refetch:c})=>{const u=Object(i.useDispatch)(),{hasIndexWrite:d}=Object(s.a)(),p=Object(a.useCallback)((()=>{t(),c&&c()}),[t,c]),m=Object(o.getScopedActions)(l),f=Object(a.useCallback)((({eventIds:e,isLoading:t})=>{m&&u(m.setEventsLoading({id:l,eventIds:e,isLoading:t}))}),[u,l,m]),g=Object(a.useCallback)((({eventIds:e,isDeleted:t})=>{m&&u(m.setEventsDeleted({id:l,eventIds:e,isDeleted:t}))}),[u,l,m]),b=Object(a.useMemo)((()=>[n]),[n]),y=Object(a.useMemo)((()=>({eventIds:b,currentStatus:e,setEventsLoading:f,setEventsDeleted:g,onUpdateSuccess:p,onUpdateFailure:p})),[e,b,f,p,g]),h=Object(r.a)(y);return Object(a.useMemo)((()=>({actionItems:d?h:[]})),[h,d])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p}));var a=n(2),i=n(1334),r=n(44),o=n(540),s=n(563),l=n(733),c=n(1200);let u=function(e){return e.alerts="alerts",e.exceptions="rule_exceptions",e.endpointExceptions="endpoint_exceptions",e.executionResults="execution_results",e.executionEvents="execution_events",e}({});const d={[u.alerts]:s.a,[u.exceptions]:l.e,[u.endpointExceptions]:l.d,[u.executionResults]:l.g,[u.executionEvents]:l.f},p=({rule:e,ruleId:t,isExistingRule:n,hasIndexRead:s})=>{const l=Object(a.useMemo)((()=>({[u.alerts]:{id:u.alerts,name:d[u.alerts],disabled:!1,href:`/rules/id/${t}/${u.alerts}`},[u.exceptions]:{id:u.exceptions,name:d[u.exceptions],disabled:null==e,href:`/rules/id/${t}/${u.exceptions}`},[u.endpointExceptions]:{id:u.endpointExceptions,name:d[u.endpointExceptions],disabled:null==e,href:`/rules/id/${t}/${u.endpointExceptions}`},[u.executionResults]:{id:u.executionResults,name:d[u.executionResults],disabled:!n,href:`/rules/id/${t}/${u.executionResults}`},[u.executionEvents]:{id:u.executionEvents,name:d[u.executionEvents],disabled:!n,href:`/rules/id/${t}/${u.executionEvents}`}})),[n,e,t]),[p,m]=Object(a.useState)(l),f=Object(c.f)(),g=Object(o.a)("showEndpointExceptions");return Object(a.useEffect)((()=>{const t=[];var n;(s||t.push(u.alerts),f.extendedLogging.isEnabled||t.push(u.executionEvents),g||t.push(u.endpointExceptions),null!=e)&&((null!==(n=e.exceptions_list)&&void 0!==n?n:[]).some((e=>e.type===i.a.ENDPOINT))||t.push(u.endpointExceptions));const a=Object(r.omit)(t,l);m(a)}),[g,s,e,l,f]),p}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(45),o=n(621),s=n(217);const l=i.a.memo((e=>{const t=Object(r.useSelector)((t=>t.analyzer[e.resolverComponentInstanceID])),n=Object(r.useDispatch)();return t||n(Object(s.createResolver)({id:e.resolverComponentInstanceID})),Object(a.useEffect)((()=>{e.shouldUpdate&&n(Object(s.createResolver)({id:e.resolverComponentInstanceID}))}),[n,e.shouldUpdate,e.resolverComponentInstanceID]),i.a.createElement(o.a,e)}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),i=n.n(a);class InvariantError extends Error{constructor(...e){super(...e),i()(this,"name","InvariantError")}}function r(e,t){if(!e)throw new InvariantError(t)}},function(e,t,n){const a=n(190);e.exports=(e,t,n)=>0===a(e,t,n)},function(e,t,n){const a=n(190);e.exports=(e,t,n)=>0!==a(e,t,n)},function(e,t,n){const a=n(671),i=n(672),r=n(385),o=n(421),s=n(491),l=n(492);e.exports=(e,t,n,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return a(e,n,c);case"!=":return i(e,n,c);case">":return r(e,n,c);case">=":return o(e,n,c);case"<":return s(e,n,c);case"<=":return l(e,n,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},,function(e,t,n){"use strict";const a=n(2),i=n(1130),r=n(476),o=n(1131),s=n(1178),l=n(1179),c=n(1180),u=n(1181),d=n(1183),p=n(1184).hastChildrenToReact;e.exports=b;const m={}.hasOwnProperty,f="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",g={renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function b(e){for(const t in g)if(m.call(g,t)&&m.call(e,t)){const e=g[t];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${t}\` (see <${f}#${e.id}> for more info)`),delete g[t]}const t=r().use(o).use(e.remarkPlugins||e.plugins||[]).use(s,{allowDangerousHtml:!0}).use(e.rehypePlugins||[]).use(u,e);let n;"string"==typeof e.children?n=i(e.children):(void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`),n=i());const l=t.runSync(t.parse(n),n);if("root"!==l.type)throw new TypeError("Expected a `root` node");let d=a.createElement(a.Fragment,{},p({options:e,schema:c,listDepth:0},l));return e.className&&(d=a.createElement("div",{className:e.className},d)),d}b.defaultProps={transformLinkUri:d},b.propTypes={children:l.string,className:l.string,allowElement:l.func,allowedElements:l.arrayOf(l.string),disallowedElements:l.arrayOf(l.string),unwrapDisallowed:l.bool,remarkPlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),rehypePlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),sourcePos:l.bool,rawSourcePos:l.bool,skipHtml:l.bool,includeElementIndex:l.bool,transformLinkUri:l.oneOfType([l.func,l.bool]),linkTarget:l.oneOfType([l.func,l.string]),transformImageUri:l.func,components:l.object},b.uriTransformer=d},function(e,t,n){"use strict";var a={}.hasOwnProperty;e.exports=a},function(e,t,n){"use strict";e.exports=function(e){for(var t=-1,n=0;++t<e.length;)n+="string"==typeof e[t]?e[t].length:1;return n}},function(e,t,n){"use strict";var a=n(335),i=n(238),r=n(286);function o(e,t){for(var n,a,r,o,s,l,c=e[t][1],u=e[t][2],d=t-1,p=[],m=c._tokenizer||u.parser[c.contentType](c.start),f=m.events,g=[],b={};c;){for(;e[++d][1]!==c;);p.push(d),c._tokenizer||(n=u.sliceStream(c),c.next||n.push(null),a&&m.defineSkip(c.start),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=!0),m.write(n),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=void 0)),a=c,c=c.next}for(c=a,r=f.length;r--;)"enter"===f[r][0]?o=!0:o&&f[r][1].type===f[r-1][1].type&&f[r][1].start.line!==f[r][1].end.line&&(y(f.slice(r+1,s)),c._tokenizer=c.next=void 0,c=c.previous,s=r+1);for(m.events=c._tokenizer=c.next=void 0,y(f.slice(0,s)),r=-1,l=0;++r<g.length;)b[l+g[r][0]]=l+g[r][1],l+=g[r][1]-g[r][0]-1;return b;function y(t){var n=p.pop();g.unshift([n,n+t.length-1]),i(e,n,2,t)}}e.exports=function(e){for(var t,n,s,l,c,u,d,p={},m=-1;++m<e.length;){for(;m in p;)m=p[m];if(t=e[m],m&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[m-1][1].type&&((s=0)<(u=t[1]._tokenizer.events).length&&"lineEndingBlank"===u[s][1].type&&(s+=2),s<u.length&&"content"===u[s][1].type))for(;++s<u.length&&"content"!==u[s][1].type;)"chunkText"===u[s][1].type&&(u[s][1].isInFirstContentOfListItem=!0,s++);if("enter"===t[0])t[1].contentType&&(a(p,o(e,m)),m=p[m],d=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(s=m,n=void 0;s--&&("lineEnding"===(l=e[s])[1].type||"lineEndingBlank"===l[1].type);)"enter"===l[0]&&(n&&(e[n][1].type="lineEndingBlank"),l[1].type="lineEnding",n=s);n&&(t[1].end=r(e[n][1].start),(c=e.slice(n,m)).unshift(t),i(e,n,m-n+1,c))}}return!d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(335),i=n(286),r=l("text"),o=l("string"),s={resolveAll:c()};function l(e){return{tokenize:function(t){var n=this,a=this.parser.constructs[e],i=t.attempt(a,r,o);return r;function r(e){return l(e)?i(e):o(e)}function o(e){if(null!==e)return t.enter("data"),t.consume(e),s;t.consume(e)}function s(e){return l(e)?(t.exit("data"),i(e)):(t.consume(e),s)}function l(e){var t=a[e],i=-1;if(null===e)return!0;if(t)for(;++i<t.length;)if(!t[i].previous||t[i].previous.call(n,n.previous))return!0}},resolveAll:c("text"===e?u:void 0)}}function c(e){return function(t,n){for(var a,i=-1;++i<=t.length;)void 0===a?t[i]&&"data"===t[i][1].type&&(a=i,i++):t[i]&&"data"===t[i][1].type||(i!==a+2&&(t[a][1].end=t[i-1][1].end,t.splice(a+2,i-a-2),i=a+2),a=void 0);return e?e(t,n):t}}function u(e,t){for(var n,r,o,s,l,c,u,d,p=-1;++p<=e.length;)if((p===e.length||"lineEnding"===e[p][1].type)&&"data"===e[p-1][1].type){for(r=e[p-1][1],s=(n=t.sliceStream(r)).length,l=-1,c=0,u=void 0;s--;)if("string"==typeof(o=n[s])){for(l=o.length;32===o.charCodeAt(l-1);)c++,l--;if(l)break;l=-1}else if(-2===o)u=!0,c++;else if(-1!==o){s++;break}c&&(d={type:p===e.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-c,offset:r.end.offset-c,_index:r.start._index+s,_bufferIndex:s?l:r.start._bufferIndex+l},end:i(r.end)},r.end=i(d.start),r.start.offset===r.end.offset?a(r,d):(e.splice(p,0,["enter",d,t],["exit",d,t]),p+=2)),p++}return e}t.resolver=s,t.string=o,t.text=r},function(e,t,n){"use strict";e.exports=function(e){return e<32||127===e}},function(e,t,n){e.exports=n(35)(3560)},function(e,t,n){"use strict";var a=n(240)(/\d/);e.exports=a},function(e,t,n){"use strict";var a=n(680),i=n(239),r=n(155);e.exports=function(e,t,n,o,s,l,c,u,d){var p=d||1/0,m=0;return function(t){return 60===t?(e.enter(o),e.enter(s),e.enter(l),e.consume(t),e.exit(l),f):a(t)||41===t?n(t):(e.enter(o),e.enter(c),e.enter(u),e.enter("chunkString",{contentType:"string"}),y(t))};function f(n){return 62===n?(e.enter(l),e.consume(n),e.exit(l),e.exit(s),e.exit(o),t):(e.enter(u),e.enter("chunkString",{contentType:"string"}),g(n))}function g(t){return 62===t?(e.exit("chunkString"),e.exit(u),f(t)):null===t||60===t||r(t)?n(t):(e.consume(t),92===t?b:g)}function b(t){return 60===t||62===t||92===t?(e.consume(t),g):g(t)}function y(r){return 40===r?++m>p?n(r):(e.consume(r),y):41===r?m--?(e.consume(r),y):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(o),t(r)):null===r||i(r)?m?n(r):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(o),t(r)):a(r)?n(r):(e.consume(r),92===r?h:y)}function h(t){return 40===t||41===t||92===t?(e.consume(t),y):y(t)}}},function(e,t,n){"use strict";var a=n(155),i=n(220);e.exports=function(e,t,n,r,o,s){var l,c=this,u=0;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),e.enter(s),d};function d(i){return null===i||91===i||93===i&&!l||94===i&&!u&&"_hiddenFootnoteSupport"in c.parser.constructs||u>999?n(i):93===i?(e.exit(s),e.enter(o),e.consume(i),e.exit(o),e.exit(r),t):a(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(i))}function p(t){return null===t||91===t||93===t||a(t)||u++>999?(e.exit("chunkString"),d(t)):(e.consume(t),l=l||!i(t),92===t?m:p)}function m(t){return 91===t||92===t||93===t?(e.consume(t),u++,p):p(t)}}},function(e,t,n){"use strict";var a=n(155),i=n(220),r=n(160);e.exports=function(e,t){var n;return function o(s){return a(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n=!0,o):i(s)?r(e,o,n?"linePrefix":"lineSuffix")(s):t(s)}}},function(e,t,n){"use strict";var a=n(155),i=n(160);e.exports=function(e,t,n,r,o,s){var l;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),l=40===t?41:t,c};function c(n){return n===l?(e.enter(o),e.consume(n),e.exit(o),e.exit(r),t):(e.enter(s),u(n))}function u(t){return t===l?(e.exit(s),c(l)):null===t?n(t):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===l||null===t||a(t)?(e.exit("chunkString"),u(t)):(e.consume(t),92===t?p:d)}function p(t){return t===l||92===t?(e.consume(t),d):d(t)}}},function(e,t,n){"use strict";var a=n(155),i=n(220),r=n(160),o={name:"thematicBreak",tokenize:function(e,t,n){var o,s=0;return function(t){return e.enter("thematicBreak"),o=t,l(t)};function l(u){return u===o?(e.enter("thematicBreakSequence"),c(u)):i(u)?r(e,l,"whitespace")(u):s<3||null!==u&&!a(u)?n(u):(e.exit("thematicBreak"),t(u))}function c(t){return t===o?(e.consume(t),s++,c):(e.exit("thematicBreakSequence"),l(t))}}};e.exports=o},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return l}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.display",{defaultMessage:"Per rule run"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.display",{defaultMessage:"Custom frequency"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.body.summary.message",{defaultMessage:"Rule {ruleName} generated {signalsCount} alerts",values:{ruleName:"{{context.rule.name}}",signalsCount:"{{state.signals_count}}"}}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.body.forEachAlert.message",{defaultMessage:"Rule {ruleName} generated alert {alertId}",values:{ruleName:"{{context.rule.name}}",alertId:"{{alert.id}}"}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19);const l=o()(s.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1oris7-0"})([".euiBadge__text{white-space:pre-wrap !important;}"]),c=({badges:e,"data-test-subj":t})=>i.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0,"data-test-subj":t},e.map((e=>i.a.createElement(s.EuiFlexItem,{grow:!1,key:`badge-${e}`,"data-test-subj":`${t}Item`},i.a.createElement(l,{color:"hollow"},e)))))},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19),l=n(85),c=n(118);const u=o()(s.EuiLink).withConfig({displayName:"StyledJobEuiLInk",componentId:"sc-4k6t5u-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),d=({jobId:e,jobName:t})=>{const{services:{http:n,ml:a}}=Object(c.j)(),r=Object(l.useMlHref)(a,n.basePath.get(),{page:l.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[e]}},[e]);return i.a.createElement(u,{"data-test-subj":"machineLearningJobLink",href:r,target:"_blank"},i.a.createElement("span",{"data-test-subj":"machineLearningJob"},null!=t?t:e))},p=Object(a.memo)(d)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Ie})),n.d(t,"b",(function(){return _e})),n.d(t,"c",(function(){return Re})),n.d(t,"e",(function(){return xe})),n.d(t,"d",(function(){return Pe})),n.d(t,"f",(function(){return Le.a}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(41),c=n.n(l),u=n(4);const d=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdated",{defaultMessage:"Last updated"}),p=u.i18n.translate("xpack.securitySolution.artifactCard.created",{defaultMessage:"Created"}),m=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdatedBy",{defaultMessage:"Updated by"}),f=u.i18n.translate("xpack.securitySolution.artifactCard.createdBy",{defaultMessage:"Created by"}),g=u.i18n.translate("xpack.securitySolution.artifactCard.globalEffectScope",{defaultMessage:"Applied globally"}),b=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope",{defaultMessage:"Applied to {count} {count, plural, one {policy} other {policies}}",values:{count:e}}),y=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope.title",{defaultMessage:"Applied to the following {count, plural, one {policy} other {policies}}",values:{count:e}}),h=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator",{defaultMessage:"IS"}),v=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),E=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),x=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),j=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.nestedOperator",{defaultMessage:"has"}),S=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator",{defaultMessage:"is one of"}),O=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),k=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.existsOperator",{defaultMessage:"exists"}),w=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.listOperator",{defaultMessage:"included in"}),T=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.os",{defaultMessage:"OS"}),I=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.and",{defaultMessage:"AND"}),M=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.windows",{defaultMessage:"Windows"}),C=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.linux",{defaultMessage:"Linux"}),_=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.macos",{defaultMessage:"Mac"}),D=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.expand",{defaultMessage:"Expand"}),A=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.collpase",{defaultMessage:"Collapse"}),F=u.i18n.translate("xpack.securitySolution.artifactMinifiedCard.descriptionLabel",{defaultMessage:"Description"});var N=n(151),P=n(52),R=n.n(P),L=n(130);const z=Object(r.memo)((({bold:e,truncate:t,size:n="s",withTooltip:a=!1,"data-test-subj":i,children:l})=>{const c=Object(r.useMemo)((()=>R()({"eui-textTruncate":t,"eui-textBreakWord":!0})),[t]),u=Object(r.useMemo)((()=>e?o.a.createElement("strong",null,l):l),[e,l]);return o.a.createElement(s.EuiText,{className:c,size:n,"data-test-subj":i},a&&"string"==typeof l&&l.length>0&&l!==Object(L.e)()?o.a.createElement(s.EuiToolTip,{anchorClassName:c,content:l,position:"top"},o.a.createElement(o.a.Fragment,null,u)):u)}));z.displayName="TextValueDisplay";var q=n(126);const B=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1dvdnzg-0"})(["padding-top:2px;"]),$=Object(r.memo)((({date:e,type:t,"data-test-subj":n})=>{const a=Object(q.a)(n);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"m","data-test-subj":n},o.a.createElement(B,{grow:!1},o.a.createElement(s.EuiIcon,{type:"calendar"})),o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiFlexGroup,{responsive:!1,direction:"column",alignItems:"flexStart",gutterSize:"xs"},o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":a("label")},o.a.createElement(z,null,"update"===t?d:p)),o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":a("value")},o.a.createElement(z,{bold:!0},o.a.createElement(N.b,{value:e,dateFormat:"M/D/YYYY"}))))))}));$.displayName="DateField";var V=n(50),U=n(542);const G=Object(r.memo)((({items:e,button:t,panelPaddingSize:n,anchorPosition:a,maxWidth:l="32ch",maxHeight:c="255px",fixedWidth:u=!1,title:d,loading:p=!1,hoverInfo:m,isNavigationDisabled:f=!1,...g})=>{const b=Object(q.a)(g["data-test-subj"]),[y,h]=Object(r.useState)(!1),v=Object(r.useCallback)((()=>h(!1)),[h]),E=Object(r.useCallback)((()=>h(!y)),[y]),x=Object(r.useMemo)((()=>({"data-test-subj":b("popoverPanel")})),[b]),j=Object(r.useMemo)((()=>e.map(((e,t)=>{var n,a;return p?o.a.createElement(s.EuiSkeletonText,{lines:1,key:Object(V.v4)(),"data-test-subj":null!==(a=e["data-test-subj"])&&void 0!==a?a:b(`item-loading-${t}`)}):o.a.createElement(U.a,i()({},e,{isNavigationDisabled:f,key:Object(V.v4)(),"data-test-subj":null!==(n=e["data-test-subj"])&&void 0!==n?n:b(`item-${t}`),textTruncate:Boolean(l)||e.textTruncate,hoverInfo:m,onClick:t=>{if(v(),e.onClick)return e.onClick(t)}}))}))),[e,p,f,b,l,m,v]),S=Object(r.useMemo)((()=>{const e={className:"eui-yScroll",style:{}};return l&&!u&&(e.style.maxWidth=l),c&&(e.style.maxHeight=c),u&&(e.style.width=null!=l?l:"32ch"),e}),[l,u,c]);return o.a.createElement(s.EuiPopover,i()({},g,{anchorPosition:a,panelPaddingSize:n,panelProps:x,button:o.a.createElement("div",{className:"eui-displayInlineBlock","data-test-subj":b("triggerButtonWrapper"),onClick:E},t),isOpen:y,closePopover:v}),d?o.a.createElement(s.EuiPopoverTitle,{paddingSize:"m"},d):null,o.a.createElement(s.EuiContextMenuPanel,i()({},S,{items:j})))}));G.displayName="ContextMenuWithRouterSupport";const H=Object(r.memo)((({items:e,"data-test-subj":t,icon:n="boxesHorizontal"})=>{const a=Object(q.a)(t),[l,c]=Object(r.useState)(!1),d=Object(r.useCallback)((()=>c(!1)),[c]),p=Object(r.useCallback)((()=>c(!l)),[l]),m=Object(r.useMemo)((()=>({"data-test-subj":a("popoverPanel")})),[a]),f=Object(r.useMemo)((()=>e.map((e=>o.a.createElement(U.a,i()({},e,{key:Object(V.v4)(),onClick:t=>{if(d(),e.onClick)return e.onClick(t)}}))))),[d,e]);return o.a.createElement(s.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:m,"data-test-subj":t,button:o.a.createElement(s.EuiButtonIcon,{"data-test-subj":a("button"),iconType:n,onClick:p,"aria-label":u.i18n.translate("xpack.securitySolution.actionsContextMenu.label",{defaultMessage:"Open"})}),isOpen:l,closePopover:d},o.a.createElement(s.EuiContextMenuPanel,{items:f,"data-test-subj":a("contextMenuPanel")}))}));H.displayName="ActionsContextMenu";const W=Object(r.memo)((({actions:e,"data-test-subj":t})=>e&&e.length>0?o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(H,{items:e,icon:"boxesHorizontal","data-test-subj":t})):null));W.displayName="CardActionsFlexItem";const Q=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemSmallBottomMargin",componentId:"sc-1orjmip-0"})(["margin-bottom:4px !important;"]),Y=Object(r.memo)((({name:e,createdDate:t,updatedDate:n,actions:a,"data-test-subj":i})=>{const r=Object(q.a)(i);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart","data-test-subj":i},o.a.createElement(Q,{grow:!0},o.a.createElement(s.EuiFlexGroup,{alignItems:"flexStart"},o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiTitle,{size:"s"},o.a.createElement("h3",{"data-test-subj":r("title")},e))),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xl"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement($,{date:n,type:"update","data-test-subj":r("updated")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement($,{date:t,type:"create","data-test-subj":r("created")})))))),o.a.createElement(W,{actions:a,"data-test-subj":r("actions")}))}));Y.displayName="CardHeader";const K=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oz5dfu-0"})(["margin:6px;"]),J=Object(r.memo)((({createdBy:e,updatedBy:t,"data-test-subj":n})=>{const a=Object(q.a)(n);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"l",responsive:!1,"data-test-subj":n},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(Z,{label:f,value:e,"data-test-subj":a("createdBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(Z,{label:m,value:t,"data-test-subj":a("updatedBy")})))}));J.displayName="TouchedByUsers";const Z=Object(r.memo)((({label:e,value:t,"data-test-subj":n})=>{const a=Object(q.a)(n);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!1,responsive:!1,"data-test-subj":n},o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiBadge,{"data-test-subj":a("label")},e)),o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center",wrap:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiAvatar,{name:t,size:"s","data-test-subj":a("avatar")})),o.a.createElement(s.EuiFlexItem,{grow:!1,className:"eui-textTruncate","data-test-subj":a("value")},o.a.createElement(z,null,t)))))}));Z.displayName="UserName";var X=n(42),ee=n(140);const te=c()("div").withConfig({displayName:"StyledWithContextMenuShiftedWrapper",componentId:"sc-d4sgp-0"})(["margin-left:-10px;"]),ne=c()(s.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-d4sgp-1"})(["height:10px !important;"]),ae=Object(r.memo)((({policies:e,loadingPoliciesList:t=!1,"data-test-subj":n})=>{const a=Object(q.a)(n),{canReadPolicyManagement:i}=Object(ee.a)().endpointPrivileges,[l,c]=Object(r.useMemo)((()=>e?["partial",b(e.length)]:["globe",g]),[e]),u=o.a.createElement(s.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"s","data-test-subj":n},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:l,size:"s"})),o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":a("value")},o.a.createElement(z,{size:"xs"},c)));return e&&e.length?o.a.createElement(te,null,o.a.createElement(ie,{policies:e,loadingPoliciesList:t,canReadPolicies:i,"data-test-subj":a("popupMenu")},u)):u}));ae.displayName="EffectScope";const ie=Object(r.memo)((({policies:e,loadingPoliciesList:t=!1,canReadPolicies:n,children:a,"data-test-subj":i})=>{const l=Object(q.a)(i),c=Object(r.useMemo)((()=>n?o.a.createElement(ne,{flush:"right",size:"s",iconSide:"right",iconType:"popout"},o.a.createElement(X.FormattedMessage,{id:"xpack.securitySolution.contextMenuItemByRouter.viewDetails",defaultMessage:"View details"})):void 0),[n]);return o.a.createElement(G,{maxHeight:"235px",fixedWidth:!0,panelPaddingSize:"none",items:e,anchorPosition:e.length>1?"rightCenter":"rightUp","data-test-subj":i,loading:t,hoverInfo:c,button:o.a.createElement(s.EuiButtonEmpty,{size:"xs","data-test-subj":l("button")},a),title:y(e.length),isNavigationDisabled:!n})}));ie.displayName="WithContextMenu";const re=Object(r.memo)((({createdBy:e,updatedBy:t,policies:n,loadingPoliciesList:a=!1,"data-test-subj":i})=>{const r=Object(q.a)(i);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",responsive:!0,"data-test-subj":i},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(J,{createdBy:e,updatedBy:t,"data-test-subj":r("touchedBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(ae,{policies:n,loadingPoliciesList:a,"data-test-subj":r("effectScope")})))}));re.displayName="CardSubHeader";var oe=n(403);const se=Object.freeze({linux:C,mac:_,macos:_,windows:M}),le=Object.freeze({[oe.b.NESTED]:j,[oe.b.MATCH_ANY]:S,[oe.b.MATCH]:h,[oe.b.WILDCARD]:E,[oe.b.EXISTS]:k,[oe.b.LIST]:w}),ce=Object.freeze({[oe.b.MATCH_ANY]:O,[oe.b.MATCH]:v,[oe.b.WILDCARD]:x}),ue=c()(s.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-1oxtqy5-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),de=c()(s.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-1oxtqy5-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),pe=c()("span").withConfig({displayName:"StyledCondition",componentId:"sc-1oxtqy5-2"})(["margin-right:6px;"]),me=Object(r.memo)((({os:e,entries:t,"data-test-subj":n})=>{const a=Object(q.a)(n),i=Object(r.useMemo)((()=>e.map((e=>{var t;return null!==(t=se[e])&&void 0!==t?t:e})).join(", ")),[e]),l=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>o.a.createElement(s.EuiBadge,{color:"hollow"},e))):t,c=(e,t)=>{var n,a;return"nested"===e?"":"included"===t?null!==(n=le[e])&&void 0!==n?n:e:null!==(a=ce[e])&&void 0!==a?a:e},u=Object(r.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((({field:e,type:t,value:n,operator:i})=>o.a.createElement(ue,{"data-test-subj":a("nestedCondition"),key:e+t+n,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiToken,{iconType:"tokenNested",size:"s"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:"",value:e,color:"subdued"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:c(t,i),value:l(t,n)})))))}),[a]);return o.a.createElement("div",{"data-test-subj":n},o.a.createElement("div",{"data-test-subj":a("os")},o.a.createElement("strong",null,o.a.createElement(s.EuiExpression,{description:"",value:T}),o.a.createElement(s.EuiExpression,{description:h,value:i}))),t.map((({field:e,type:t,value:n,operator:i,entries:r=[]})=>o.a.createElement("div",{"data-test-subj":a("condition"),key:e+t+n},o.a.createElement("div",{className:"eui-xScroll"},o.a.createElement(s.EuiExpression,{description:o.a.createElement(pe,null,I),value:e,color:"subdued"}),o.a.createElement(s.EuiExpression,{description:c(t,i),value:l(t,n)})),u(t,r)))))}));me.displayName="CriteriaConditions";const fe=e=>"effectScope"in e;var ge=n(245);const be=e=>(e=>{const t=e.filter((e=>e.startsWith(ge.b)));return t.some((e=>e===`${ge.b}all`))?{type:"global"}:{type:"policy",policies:t.map((e=>e.substr(ge.b.length)))}})(e.tags),ye=e=>Object(r.useMemo)((()=>(e=>{var t;const n=e,{name:a,created_by:i,created_at:r,updated_at:o,updated_by:s,description:l="",entries:c}=n;return{name:a,created_by:i,created_at:r,updated_at:o,updated_by:s,description:l,comments:fe(n)?[]:n.comments,entries:c,os:fe(n)?[n.os]:null!==(t=n.os_types)&&void 0!==t?t:[],effectScope:fe(n)?n.effectScope:be(n)}})(e)),[e]),he=c()(s.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-1qnczpg-0"})(["&.artifactEntryCard + &.artifactEntryCard{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),ve=Object(r.memo)((({className:e,...t})=>o.a.createElement(he,i()({},t,{hasBorder:!0,paddingSize:"none",className:`artifactEntryCard ${null!=e?e:""}`}))));ve.displayName="CardContainerPanel";const Ee=c()(s.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1aw8s5s-0"})(["padding:32px;&.top-section{padding-bottom:24px;}&.bottom-section{padding-top:24px;}&.artifact-entry-collapsible-card{padding:24px !important;}"]),xe=Object(r.memo)((e=>o.a.createElement(Ee,i()({},e,{hasBorder:!1,hasShadow:!1,paddingSize:"l"}))));xe.displayName="CardSectionPanel";var je=n(44),Se=n(353);const Oe=c()(s.EuiAvatar).withConfig({displayName:"CustomEuiAvatar",componentId:"sc-3lb0zi-0"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightShade)),ke=Object(r.memo)((({comments:e,"data-test-subj":t})=>{const n=Object(q.a)(t),[a,i]=Object(r.useState)(!1),l=Object(r.useCallback)((()=>{i(!a)}),[i,a]),c=Object(r.useMemo)((()=>(e=>e.map((e=>({username:e.created_by,timestamp:o.a.createElement(N.b,{value:e.created_at,dateFormat:"MMM D, YYYY"}),event:Se.b,timelineAvatar:o.a.createElement(Oe,{size:"s",name:e.created_by}),children:o.a.createElement(s.EuiText,{size:"s"},e.comment)}))))(e)),[e]),d=Object(r.useMemo)((()=>a?((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.hide",{defaultMessage:"Hide comments ({count})",values:{count:e}}))(e.length):((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.show",{defaultMessage:"Show comments ({count})",values:{count:e}}))(e.length)),[e.length,a]);return Object(je.isEmpty)(e)?null:o.a.createElement("div",{"data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiButtonEmpty,{onClick:l,flush:"left",size:"xs","data-test-subj":n("label")},d),o.a.createElement(s.EuiAccordion,{id:"1",arrowDisplay:"none",forceState:a?"open":"closed"},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiCommentList,{comments:c,"data-test-subj":n("list")})))}));ke.displayName="CardComments";const we=(e,t)=>Object(r.useMemo)((()=>"policy"===e.effectScope.type?null==e?void 0:e.effectScope.policies.map((e=>t&&t[e]?t[e]:{children:e})):void 0),[e.effectScope,t]),Te=Object(r.memo)((({truncate:e,children:t,"data-test-subj":n,withTooltip:a})=>o.a.createElement(z,{size:"m",truncate:e,"data-test-subj":n,withTooltip:a},t||Object(L.e)())));Te.displayName="ArtifactDescription";const Ie=Object(r.memo)((({item:e,policies:t,loadingPoliciesList:n=!1,actions:a,hideDescription:r=!1,hideComments:l=!1,Decorator:c,"data-test-subj":u,...d})=>{const p=ye(e),m=Object(q.a)(u),f=we(p,t);return o.a.createElement(ve,i()({},d,{"data-test-subj":u}),o.a.createElement(xe,{className:"top-section"},o.a.createElement(Y,{name:p.name,createdDate:p.created_at,updatedDate:p.updated_at,actions:a,"data-test-subj":m("header")}),o.a.createElement(re,{createdBy:p.created_by,updatedBy:p.updated_by,policies:f,loadingPoliciesList:n,"data-test-subj":m("subHeader")}),!r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(Te,{"data-test-subj":m("description")},p.description)),l?null:o.a.createElement(o.a.Fragment,null,r&&o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(ke,{comments:p.comments,"data-test-subj":m("comments")}))),o.a.createElement(s.EuiHorizontalRule,{margin:"none"}),o.a.createElement(xe,{className:"bottom-section"},c&&o.a.createElement(c,{item:e,"data-test-subj":m("decorator")}),o.a.createElement(me,{os:p.os,entries:p.entries,"data-test-subj":m("criteriaConditions")})))}));Ie.displayName="ArtifactEntryCard";const Me=c()(s.EuiSplitPanel.Outer).withConfig({displayName:"CardContainerPanel",componentId:"sc-lh5b0s-0"})(["&.artifactEntryCardMinified + &.artifactEntryCardMinified{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),Ce=c()(s.EuiSplitPanel.Inner).withConfig({displayName:"CustomSplitInnerPanel",componentId:"sc-lh5b0s-1"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),_e=Object(r.memo)((({item:e,isSelected:t=!1,onToggleSelectedArtifact:n,"data-test-subj":a,Decorator:l,...c})=>{var u;const d=ye(e),p=Object(q.a)(a),[m,f]=Object(r.useState)("closed"),g=Object(r.useCallback)((()=>{f((e=>"closed"===e?"open":"closed"))}),[]),b=Object(r.useCallback)((()=>"open"===m?"Hide details":"Show details"),[m]),y=Object(r.useMemo)((()=>o.a.createElement(Ce,null,o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiCheckbox,{id:d.name,"data-test-subj":`${d.name}_checkbox`,checked:t,onChange:()=>n(!t)})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":p("title")},d.name)))))),[d.name,p,t,n]);return o.a.createElement(Me,i()({},c,{"data-test-subj":a,className:`${null!==(u=c.className)&&void 0!==u?u:""}  artifactEntryCardMinified`,id:d.name,hasShadow:!1,hasBorder:!0}),y,o.a.createElement(s.EuiSplitPanel.Inner,{paddingSize:"s"},o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":p("descriptionTitle")},F)),o.a.createElement(Te,{"data-test-subj":p("description")},d.description)),o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiButtonEmpty,{"data-test-subj":p("collapse"),color:"primary",size:"s",flush:"left",iconType:"open"===m?"arrowUp":"arrowDown",iconSide:"right",iconSize:"m",onClick:g,style:{fontWeight:400}},b()),o.a.createElement(s.EuiAccordion,{id:"showDetails",arrowDisplay:"none",forceState:m},l&&o.a.createElement(l,{item:e,"data-test-subj":p("decorator")}),o.a.createElement(me,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")})))))}));_e.displayName="ArtifactEntryCardMinified";const De=Object(r.memo)((({expanded:e,onClick:t,"data-test-subj":n})=>o.a.createElement(s.EuiButtonIcon,{iconType:e?"arrowUp":"arrowDown",onClick:t,"data-test-subj":n,"aria-label":e?A:D})));De.displayName="CardExpandButton";const Ae=Object(r.memo)((({artifact:e,onExpandCollapse:t,policies:n,actions:a,expanded:i=!1,"data-test-subj":s})=>{const l=Object(q.a)(s),c=we(e,n),u=Object(r.useCallback)((()=>{t()}),[t]);return o.a.createElement(Pe,{"data-test-subj":s,expanded:i,expandToggle:o.a.createElement(De,{expanded:i,onClick:u,"data-test-subj":l("expandCollapse")}),name:o.a.createElement(z,{bold:!0,truncate:!i,withTooltip:!i},e.name),description:o.a.createElement(Te,{truncate:!i,withTooltip:!i},e.description),effectScope:o.a.createElement(ae,{policies:c,"data-test-subj":l("effectScope")}),actionMenu:o.a.createElement(W,{actions:a,"data-test-subj":l("actions")})})}));Ae.displayName="CardCompressedHeader";const Fe=c.a.div.withConfig({displayName:"ButtonIconPlaceHolder",componentId:"sc-j6qhqr-0"})(["display:inline-block;width:",";height:",";"],(({theme:e})=>e.eui.euiSizeL),(({theme:e})=>e.eui.euiSizeL)),Ne=c()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-j6qhqr-1"})(["&.flushTop,.flushTop{padding-top:0;margin-top:0;}"]),Pe=Object(r.memo)((({expanded:e,name:t,expandToggle:n,effectScope:a,actionMenu:i,description:l,"data-test-subj":c,flushTop:u})=>{const d=Object(q.a)(c),p=(e=>Object(r.useMemo)((()=>R()({"eui-textTruncate":!e})),[e]))(e),m=u?" flushTop":"";return o.a.createElement(Ne,{responsive:!1,alignItems:"center","data-test-subj":c,className:m},o.a.createElement(s.EuiFlexItem,{grow:!1,className:m,"data-test-subj":d("expandCollapseHolder")},n),o.a.createElement(s.EuiFlexItem,{className:p+m},o.a.createElement(s.EuiFlexGroup,{alignItems:"center",className:m},o.a.createElement(s.EuiFlexItem,{grow:2,className:p+m,"data-test-subj":d("titleHolder")},t),o.a.createElement(s.EuiFlexItem,{grow:3,className:p+m,"data-test-subj":d("descriptionHolder")},l),o.a.createElement(s.EuiFlexItem,{grow:1,"data-test-subj":d("effectScopeHolder"),className:m},a))),!0===i?o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":d("cardActionsPlaceholder"),className:m},o.a.createElement(Fe,null)):i)}));Pe.displayName="CardCompressedHeaderLayout";const Re=Object(r.memo)((({item:e,onExpandCollapse:t,policies:n,actions:a,expanded:r=!1,"data-test-subj":l,Decorator:c,...u})=>{const d=ye(e),p=Object(q.a)(l);return o.a.createElement(ve,i()({},u,{"data-test-subj":l}),o.a.createElement(xe,{className:"artifact-entry-collapsible-card"},o.a.createElement(Ae,{artifact:d,actions:a,policies:n,expanded:r,onExpandCollapse:t,"data-test-subj":p("header")})),r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(xe,null,c&&o.a.createElement(c,{item:e,"data-test-subj":p("decorator")}),o.a.createElement(me,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")}))))}));Re.displayName="ArtifactEntryCollapsibleCard";var Le=n(782)},function(e,t,n){"use strict";n.d(t,"b",(function(){return St})),n.d(t,"a",(function(){return Ct}));var a=n(119),i=n.n(a),r=n(19),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(7),d=n(175),p=n(379),m=n(740),f=n(122),g=n(829),b=n(305),y=n(758),h=n(170),v=n(1393),E=n(272);const x=c.a.div.withConfig({displayName:"EuiCodeEditorContainer",componentId:"sc-a6c5kq-0"})([".euiCodeEditorWrapper{position:absolute;}"]),j=s.a.memo((({rawEventData:e})=>{const t=Object(o.useMemo)((()=>JSON.stringify(e,E.j,2)),[e]);return s.a.createElement(x,null,s.a.createElement(r.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",isCopyable:!0,"data-test-subj":"jsonView"},t))}));j.displayName="JsonView";var S=n(244),O=n(42),k=n(226),w=n(137),T=n(130),I=n(666),M=n(521);const C=({risk:e,riskEntity:t,originalRisk:n})=>{var a,i,o,l,c,u,d,p;const m=t===w.t.host?null==e||null===(a=e.result)||void 0===a||null===(i=a[0])||void 0===i||null===(o=i.host)||void 0===o||null===(l=o.risk)||void 0===l?void 0:l.calculated_level:null==e||null===(c=e.result)||void 0===c||null===(u=c[0])||void 0===u||null===(d=u.user)||void 0===d||null===(p=d.risk)||void 0===p?void 0:p.calculated_level;return s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:s.a.createElement(M.a,{title:S.o(t),riskScoreEntity:t}),toolTipTitle:s.a.createElement(M.a,{title:S.o(t),riskScoreEntity:t}),toolTipContent:s.a.createElement(O.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.riskDataTooltipContent",defaultMessage:"Risk level is displayed only when available for a {riskEntity}. Ensure {riskScoreDocumentationLink} is enabled within your environment.",values:{riskEntity:t,riskScoreDocumentationLink:s.a.createElement(I.a,{title:S.p})}})}),e.loading&&s.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":"loading"}),!e.loading&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Y,{field:S.a(t),value:m?s.a.createElement(k.a,{severity:m,hideBackgroundColor:!0}):Object(T.e)()}),n&&m!==n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Y,{field:S.m(t),value:s.a.createElement(k.a,{severity:n,hideBackgroundColor:!0})})))))},_=s.a.memo(C);var D=n(44),A=n(173),F=n(336),N=n(422),P=n(131);const R=c.a.span.withConfig({displayName:"EnrichmentFieldFeedName",componentId:"sc-1cy82j8-0"})(["white-space:nowrap;font-style:italic;"]),L=c()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1cy82j8-1"})([".inlineActions{opacity:0;}.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}"]),z=({data:e,eventId:t,index:n,feedName:a,scopeId:i,value:l,isDraggable:c,isReadOnly:u})=>{const d=Object(o.useMemo)((()=>({scopeId:i})),[i]);if(!e||!l)return null;const p=`alert-details-value-formatted-field-value-${i}-${t}-${e.field}-${l}-${n}-${a}`;return s.a.createElement(L,{key:p,direction:"row",gutterSize:"xs",alignItems:"center"},s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement("div",null,s.a.createElement(N.a,{contextId:i,eventId:p,fieldFormat:e.format,fieldName:e.field,fieldType:e.type,isDraggable:c,isObjectArray:e.isObjectArray,value:l,truncate:!1}),a&&s.a.createElement(R,null," ",S.e," ",a))),s.a.createElement(r.EuiFlexItem,null,l&&!u&&s.a.createElement(A.c,{data:{field:e.field,value:l},triggerId:A.d.DETAILS_FLYOUT,mode:A.a.INLINE,sourcererScopeId:Object(P.getSourcererScopeId)(i),metadata:d,visibleCellActions:3})))},q=({browserFields:e,data:t,enrichments:n,scopeId:a,eventId:i,isDraggable:o,isReadOnly:l})=>{const c=n.map(((n,a)=>{var i,r,o,s;const{field:l,type:c,feedName:u,value:d}=Object(F.d)(n),p=t.find((e=>e.field===l)),m=null!==(i=null==p?void 0:p.category)&&void 0!==i?i:"",f=Object(D.get)([m,"fields",null!=l?l:""],e);return{fieldsData:{field:null!=l?l:"",format:null!==(r=null==f?void 0:f.format)&&void 0!==r?r:"",type:null!==(o=null==f?void 0:f.type)&&void 0!==o?o:"",isObjectArray:null!==(s=null==p?void 0:p.isObjectArray)&&void 0!==s&&s},type:c,feedName:u,index:a,field:l,browserField:f,value:d}})),[d,p]=Object(u.partition)(c,(({type:e})=>Object(F.f)(e)));return s.a.createElement(s.a.Fragment,null,p.length>0&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:S.f,toolTipContent:S.g}),p.map((({fieldsData:e,index:t,field:n,feedName:r,browserField:c,value:u})=>s.a.createElement(Y,{key:n,field:n,value:s.a.createElement(z,{eventId:i,index:t,feedName:r,scopeId:a,value:u,data:e,isDraggable:o,isReadOnly:l})}))))),d.length>0&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:S.h,toolTipContent:S.j}),d.map((({fieldsData:e,index:t,field:n,feedName:r,browserField:c,value:u})=>s.a.createElement(Y,{key:n,field:n,value:s.a.createElement(z,{eventId:i,index:t,feedName:r,scopeId:a,value:u,data:e,isDraggable:o,isReadOnly:l})}))))))},B=s.a.memo(q);var $=n(350),V=n(357);const U=c()(r.EuiTitle).withConfig({displayName:"UppercaseEuiTitle",componentId:"sc-1az7ye2-0"})(["text-transform:uppercase;"]),G=({children:e})=>s.a.createElement(U,{size:"xxxs"},s.a.createElement("h5",null,e)),H=c()(r.EuiTitle).withConfig({displayName:"StyledEnrichmentFieldTitle",componentId:"sc-1az7ye2-1"})(["width:220px;"]),W=({title:e})=>s.a.createElement(H,{size:"xxxs"},s.a.createElement("h6",null,e)),Q=c()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1az7ye2-2"})(["font-size:",";margin-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeS)),Y=({field:e,value:t})=>s.a.createElement(Q,{direction:"row",gutterSize:"none",responsive:!0,alignItems:"center","data-test-subj":"EnrichedDataRow"},s.a.createElement(r.EuiFlexItem,{style:{flexShrink:0},grow:!1},s.a.createElement(W,{title:e})),s.a.createElement(r.EuiFlexItem,{className:"eui-textBreakWord"},t)),K=({title:e,toolTipContent:t,toolTipTitle:n})=>s.a.createElement(r.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},s.a.createElement(r.EuiFlexItem,null,s.a.createElement(G,null,e)),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(V.b,{toolTipContent:t,toolTipTitle:null!=n?n:e}))),J=({browserFields:e,data:t,enrichments:n,eventId:a,scopeId:i,hostRisk:o,userRisk:l,isDraggable:c,isReadOnly:u})=>{var d,p,m,f;const g=null==t||null===(d=t.find((e=>"host.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===d||null===(p=d.values)||void 0===p?void 0:p[0],b=null==t||null===(m=t.find((e=>"user.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===m||null===(f=m.values)||void 0===f?void 0:f[0],y=Object($.a)("entity-analytics");return y||0!==n.length?s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiHorizontalRule,null),s.a.createElement(r.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,S.b)),s.a.createElement(r.EuiSpacer,{size:"m"}),s.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{flexGrow:0}},y&&s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:w.t.host,risk:o,originalRisk:g})),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:w.t.user,risk:l,originalRisk:b}))),s.a.createElement(B,{browserFields:e,data:t,enrichments:n,scopeId:i,eventId:a,isDraggable:c,isReadOnly:u}))):null},Z=s.a.memo(J);var X=n(741),ee=n(197),te=n(549);const ne=c()(r.EuiInMemoryTable).withConfig({displayName:"SummaryTable",componentId:"sc-12oammb-0"})([".inlineActions{opacity:0;}.flyoutTableHoverActions{.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}}"]);var ae=n(1348),ie=n(284),re=n(149);const oe={flexGrow:0},se=({data:e,eventId:t,fieldFromBrowserField:n,isDraggable:a,linkValue:i,scopeId:r,values:o,isReadOnly:l})=>{const c=Object(ie.e)(e.field);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ae.a,{contextId:r,data:e,eventId:t,fieldFromBrowserField:n,linkValue:i,isDraggable:a,style:oe,values:o}),r!==re.f.active&&!l&&c&&s.a.createElement(A.c,{data:{field:e.field,value:o},triggerId:A.d.DETAILS_FLYOUT,mode:A.a.INLINE,visibleCellActions:3,sourcererScopeId:Object(P.getSourcererScopeId)(r),metadata:{scopeId:r}}))};se.displayName="SummaryValueCell";var le=n(263),ce=n(302),ue=n(352);const de=({data:e,eventId:t,fieldFromBrowserField:n,linkValue:a,scopeId:i,values:o})=>{const{loading:l,count:c}=Object(ue.a)({field:e.field,isActiveTimelines:i===re.f.active,value:o,signalIndexName:null}),u=Object(ce.c)({contextId:i,eventId:t,field:e.field,fieldFormat:e.format,fieldFromBrowserField:n,fieldType:e.type,isObjectArray:e.isObjectArray,linkValue:a,values:o});return l?s.a.createElement(r.EuiLoadingSpinner,null):"number"==typeof c&&null!=u&&u.dataProviders&&null!=u&&u.dataProviders.length?s.a.createElement(le.a,{asEmptyButton:!0,dataProviders:u.dataProviders,filters:u.filters},s.a.createElement("span",{"data-test-subj":"alert-prevalence"},c)):Object(T.d)()};de.displayName="PrevalenceCell";const pe=[{field:"title",truncateText:!1,name:ee.o,textOnly:!0},{field:"description",truncateText:!1,render:se,name:ee.p}],me=[...pe,{field:"description",truncateText:!0,render:e=>s.a.createElement(de,e),name:s.a.createElement(s.a.Fragment,null,ee.m," ",s.a.createElement(r.EuiIconTip,{type:"iInCircle",color:"subdued",title:ee.m,content:s.a.createElement("span",null,ee.n)})),align:"right",width:"130px"}],fe={className:"flyoutTableHoverActions"},ge=({goToTable:e,rows:t,title:n,isReadOnly:a})=>{const i=a?pe:me;return s.a.createElement("div",null,s.a.createElement(r.EuiFlexGroup,null,s.a.createElement(r.EuiFlexItem,null,s.a.createElement(r.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,n))),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiLink,{onClick:e,"data-test-subj":"summary-view-go-to-table-link"},s.a.createElement(r.EuiText,{size:"xs"},ee.F)))),s.a.createElement(r.EuiSpacer,{size:"s"}),s.a.createElement(ne,{"data-test-subj":"summary-view",items:t,columns:i,rowProps:fe,compressed:!0}))},be=s.a.memo(ge),ye=({browserFields:e,data:t,eventId:n,isDraggable:a,scopeId:i,title:r,goToTable:o,isReadOnly:l,investigationFields:c})=>{const u=Object(te.c)({browserFields:e,data:t,eventId:n,isDraggable:a,scopeId:i,isReadOnly:l,investigationFields:c});return s.a.createElement(be,{goToTable:o,isReadOnly:l,rows:u,title:r})},he=s.a.memo(ye);var ve=n(441),Ee=n(728),xe=n(394),je=n(59),Se=n(172),Oe=n(229);const ke=je.euiStyled.div`
  margin-left: ${({theme:e})=>e.eui.euiSizeS};
`,we=Object(je.euiStyled)(r.EuiPanel)`
  &&& {
    background-color: ${({theme:e})=>e.eui.euiColorLightestShade};
    padding: ${({theme:e})=>e.eui.euiSizeS};
    height: 78px;
  }

  &:hover {
    .inlineActions {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
  }

  .inlineActions {
    opacity: 0;
    width: 0;
    transform: translate(6px);
    transition: transform 50ms ease-in-out;

    &.inlineActions-popoverOpen {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
   }
`,Te=({title:e,children:t})=>s.a.createElement(we,{borderRadius:"none",hasShadow:!1,hasBorder:!1,paddingSize:"s"},s.a.createElement(r.EuiText,{size:"s"},e),s.a.createElement(r.EuiSpacer,{size:"s"}),t);Te.displayName="OverviewCard";const Ie=je.euiStyled.div`
  /* Clamp text content to 2 lines */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
`;Ie.displayName="ClampedContent";const Me=({title:e,children:t,contextId:n,dataTestSubj:a,enrichedFieldInfo:i})=>s.a.createElement(Te,{title:e},s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(Ie,{"data-test-subj":a},t),s.a.createElement(ke,null,s.a.createElement(A.c,{data:{field:i.data.field,value:null==i?void 0:i.values},triggerId:A.d.DETAILS_FLYOUT,mode:A.a.INLINE,sourcererScopeId:Object(P.getSourcererScopeId)(n),metadata:{scopeId:n},visibleCellActions:3}))));Me.displayName="OverviewCardWithActions";var Ce=n(831),_e=n(298),De=n(984);const Ae=Object(je.euiStyled)(r.EuiFlexGroup)`
  flex-grow: 0;
`,Fe=s.a.memo((({browserFields:e,contextId:t,data:n,eventId:a,handleOnEventClosed:i,scopeId:l,isReadOnly:c})=>{const u=Object(o.useMemo)((()=>{const i=Object(D.find)({field:Oe.o,category:"kibana"},n);return i&&Object(ie.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:i})}),[e,t,n,a,l]),d=Object(o.useMemo)((()=>{const i=Object(D.find)({field:"kibana.alert.severity",category:"kibana"},n);return i&&Object(ie.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:i})}),[e,t,n,a,l]),p=Object(o.useMemo)((()=>{const i=Object(D.find)({field:"kibana.alert.risk_score",category:"kibana"},n);return i&&Object(ie.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:i})}),[e,t,n,a,l]),m=Object(o.useMemo)((()=>{const i=Object(D.find)({field:Oe.n,category:"kibana"},n),r=Object(D.find)({field:"kibana.alert.rule.uuid",category:"kibana"},n);return i&&Object(ie.b)({eventId:a,contextId:t,scopeId:l,browserFields:e,item:i,linkValueField:r})}),[e,t,n,a,l]),f=Ne(u)&&!c?s.a.createElement(r.EuiFlexItem,{key:"status"},s.a.createElement(Me,{title:Se.P,enrichedFieldInfo:u,contextId:t},s.a.createElement(Ce.a,{eventId:a,contextId:t,enrichedFieldInfo:u,scopeId:l,handleOnEventClosed:i}))):null,g=Ne(d)?s.a.createElement(r.EuiFlexItem,{key:"severity"},c?s.a.createElement(Te,{title:Se.w},s.a.createElement(_e.a,{value:d.values[0]})):s.a.createElement(Me,{title:Se.w,enrichedFieldInfo:d,contextId:t},s.a.createElement(_e.a,{value:d.values[0]}))):null,b=Ne(p)?s.a.createElement(r.EuiFlexItem,{key:"riskScore"},c?s.a.createElement(Te,{title:Se.s},p.values[0]):s.a.createElement(Me,{title:Se.s,enrichedFieldInfo:p,contextId:t,dataTestSubj:"riskScore"},p.values[0])):null,y=Ne(m)&&!c?s.a.createElement(r.EuiFlexItem,{key:"ruleName"},s.a.createElement(Me,{title:Se.t,enrichedFieldInfo:m,contextId:t},s.a.createElement(N.a,{contextId:t,eventId:a,value:m.values[0],fieldName:m.data.field,linkValue:m.linkValue,fieldType:m.data.type,fieldFormat:m.data.format,isDraggable:!1,truncate:!1}))):null,{width:h,ref:v}=Object(De.a)(),E=0===h||h&&h>=675,x=[f,g,b,y].filter(Pe),j=E?s.a.createElement(Ae,{gutterSize:"s"},x):s.a.createElement(s.a.Fragment,null,Object(D.chunk)(2,x).map(((e,t,{length:n})=>{const a=t<n-1;return s.a.createElement(o.Fragment,{key:t},s.a.createElement(Ae,{gutterSize:"s"},e),a&&s.a.createElement(r.EuiSpacer,{size:"s"}))})));return s.a.createElement("div",{ref:v},j)}));function Ne(e){return!!e&&Array.isArray(e.values)}function Pe(e){return null!==e}Fe.displayName="Overview";var Re=n(813),Le=n(36),ze=n(253);function qe(e){return Boolean(e&&e.values&&e.values.length)}var Be=n(16),$e=n(539);const Ve=Object(je.euiStyled)(r.EuiAccordion)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
`,Ue=s.a.memo((({prefix:e,state:t,text:n,renderContent:a,onToggle:i=D.noop,extraAction:o,forceState:l})=>{const c=Object(r.useGeneratedHtmlId)({prefix:e});switch(t){case"loading":return s.a.createElement(Ve,{id:c,buttonContent:n,onToggle:i,isLoading:!0});case"error":return s.a.createElement(Ve,{id:c,buttonContent:s.a.createElement("span",null,s.a.createElement(r.EuiIcon,{type:"warning",color:"danger",style:{marginRight:"6px"}}),n),onToggle:i,extraAction:o});case"success":return s.a.createElement(Ve,{"tour-step":`${e}-accordion`,"data-test-subj":`${e}-accordion`,id:c,buttonContent:n,onToggle:i,paddingSize:"l",extraAction:o,forceState:l},a());default:return null}}));Ue.displayName="InsightAccordion";var Ge=n(151),He=n(381),We=n(380);const Qe=["*"],Ye=(e,t)=>({fields:t,_source:!1,query:{ids:{values:e}}}),Ke=["@timestamp","kibana.alert.rule.name","kibana.alert.severity"],Je=[{field:"kibana.alert.rule.name",name:"Rule"},{field:"@timestamp",name:"@timestamp",render:e=>s.a.createElement(Ge.c,{value:new Date(e)})},{field:"kibana.alert.severity",name:"Severity",render:e=>s.a.createElement(_e.a,{value:e})}],Ze=s.a.memo((({alertIds:e})=>{const t=Object(o.useMemo)((()=>e.slice(0,10)),[e]),{loading:n,error:a,data:i}=(({alertIds:e,fields:t=Qe})=>{const[n]=Object(o.useState)((()=>Ye(e,t))),{loading:a,data:i,setQuery:r}=Object(He.a)({query:n,queryName:We.a.BY_ID});return Object(o.useEffect)((()=>{r(Ye(e,t))}),[r,e,t]),{loading:a,error:!a&&void 0===i,data:null==i?void 0:i.hits.hits}})({alertIds:t,fields:Ke}),l=Object(o.useMemo)((()=>{if(i)return i.map((e=>e.fields))}),[i]);if(n)return s.a.createElement(r.EuiSkeletonText,{lines:2});if(a)return s.a.createElement(s.a.Fragment,null,ze.p);if(l){const t=e.length>10;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("div",null,s.a.createElement("em",null,ze.q),s.a.createElement(r.EuiSpacer,null)),s.a.createElement(r.EuiBasicTable,{compressed:!0,items:l,columns:Je}))}return null}));Ze.displayName="SimpleAlertTable";const Xe=s.a.memo((({originalDocumentId:e,index:t,eventId:n,scopeId:a})=>{const[i,r]=Object(o.useState)(!1),[l,c]=Object(o.useState)({}),u=Object(o.useCallback)((e=>r(e)),[]),d=Object(o.useCallback)((()=>i?l.alertIds?s.a.createElement(tt,{eventId:n,scopeId:a,alertIds:l.alertIds}):s.a.createElement(et,{index:t,originalDocumentId:e,eventId:n,isActiveTimelines:Object(P.isActiveTimeline)(null!=a?a:""),onCacheLoad:c}):null),[i,l.alertIds,t,e,n,a]);return s.a.createElement(Ue,{prefix:"RelatedAlertsByProcessAncestry",state:"success",text:l.alertIds?Object(ze.h)(l.alertIds.length):ze.g,renderContent:d,onToggle:u})}));Xe.displayName="RelatedAlertsByProcessAncestry";const et=({originalDocumentId:e,index:t,isActiveTimelines:n,onCacheLoad:a,eventId:i})=>{const{values:l}=t,{values:c}=e,u=Array.isArray(c)?c[0]:"",{loading:d,error:p,alertIds:m}=Object($e.a)({isActiveTimeline:n,documentId:u,indices:null!=l?l:[]});return Object(o.useEffect)((()=>{m&&0!==m.length&&a({alertIds:m})}),[m,a]),d?s.a.createElement(r.EuiLoadingSpinner,null):p?s.a.createElement(s.a.Fragment,null,ze.j):m&&0!==m.length?null:s.a.createElement(s.a.Fragment,null,ze.i)};et.displayName="FetchAndNotifyCachedAlertsByProcessAncestry";const tt=({alertIds:e,eventId:t,scopeId:n})=>{const a=e&&e.length&&e.length>=5,i=Object(o.useMemo)((()=>e&&e.length?a?null:e.reduce(((e,a,i)=>{const r=`${n}-${t}-event.id-${i}-${a}`;return e.push(Object(ce.a)("_id",r,a)),e}),[]):null),[e,a,n,t]),l=Object(o.useMemo)((()=>a?[{meta:{alias:ze.k,type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null),[e,a]);return i||l?s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{alertIds:e}),s.a.createElement(r.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:i,filters:l,"data-test-subj":"investigate-ancestry-in-timeline"},Se.i)):null};tt.displayName="ActualRelatedAlertsByProcessAncestry";var nt=n(256),at=n(118),it=n(144),rt=n(5);const ot=s.a.memo((({eventId:e})=>{const{services:{cases:t}}=Object(at.j)(),n=Object(at.n)(),[a,i]=Object(o.useState)(void 0),[r,l]=Object(o.useState)(!1),{activeStep:c,isTourShown:u}=Object(nt.b)(),d=Object(o.useMemo)((()=>c===h.a.viewCase&&u(h.b.alertsCases)),[c,u]),p=Object(o.useCallback)((()=>function(e=[]){const t=e.length;return s.a.createElement("span",null,s.a.createElement(O.FormattedMessage,{defaultMessage:"This alert was found in {caseCount}",id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content",values:{caseCount:s.a.createElement("strong",null,s.a.createElement(O.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content_count",defaultMessage:"{caseCount} {caseCount, plural, =0 {cases.} =1 {case:} other {cases:}}",values:{caseCount:t}}))}}),e.map((({id:t,title:n},a)=>t&&n?s.a.createElement("span",{key:t}," ",s.a.createElement(it.a,{detailName:t,title:n,index:a},n),e[a+1]?",":""):s.a.createElement(s.a.Fragment,null))))}(a)),[a]),[m,f]=Object(o.useState)(!1);Object(o.useEffect)((()=>{if(!m)return;let a=!1;return(async()=>{let r=[];try{var o;e&&(r=null!==(o=await t.api.getRelatedCases(e,{owner:rt.j}))&&void 0!==o?o:[])}catch(e){a||l(!0),n.addWarning(Object(ze.c)(e))}a||(i(r),f(!1))})(),()=>{a=!0}}),[t.api,e,m,n]),Object(o.useEffect)((()=>{f(!0)}),[e]);let g="loading";return r?g="error":a&&(g="success"),s.a.createElement(Ue,{prefix:"RelatedCases",state:g,text:st(g,null==a?void 0:a.length),renderContent:p,forceState:d?"open":void 0})}));function st(e,t=0){switch(e){case"loading":return ze.d;case"error":return ze.b;case"success":return Object(ze.a)(t);default:return""}}ot.displayName="RelatedCases";const lt=s.a.memo((({browserFields:e,data:t,eventId:n,scopeId:a})=>{const{field:i,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:i,value:l,isActiveTimelines:Object(P.isActiveTimeline)(a),signalIndexName:null,includeAlertIds:!0}),{fieldFromBrowserField:p}=Object(ie.b)({browserFields:e,contextId:a,eventId:n,field:{id:t.field},scopeId:a,item:t}),m=Object(ce.c)({field:i,values:l,contextId:a,eventId:n,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),f=0===u;let g="loading";c?g="error":d&&(g="success");const b=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?f&&"loading"!==g?ze.s:s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{alertIds:d}),s.a.createElement(r.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},Se.i)):null),[d,null==m?void 0:m.dataProviders,f,g]);return s.a.createElement(Ue,{prefix:"RelatedAlertsBySourceEvent",state:g,text:ct(g,u),renderContent:b})}));function ct(e,t){switch(e){case"loading":return ze.u;case"error":return ze.t;case"success":return Object(ze.r)(t);default:return""}}lt.displayName="RelatedAlertsBySourceEvent";const ut=s.a.memo((({browserFields:e,data:t,eventId:n,scopeId:a})=>{const{field:i,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:i,value:l,isActiveTimelines:Object(P.isActiveTimeline)(a),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0}),{fieldFromBrowserField:p}=Object(ie.b)({browserFields:e,contextId:a,eventId:n,field:{id:t.field},scopeId:a,item:t}),m=Object(ce.c)({field:i,values:l,contextId:a,eventId:n,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),f=0===u;let g="loading";c?g="error":(d||f)&&(g="success");const b=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?f&&"loading"!==g?ze.m:s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{alertIds:d}),s.a.createElement(r.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},Se.i)):null),[d,null==m?void 0:m.dataProviders,f,g]);return s.a.createElement(Ue,{prefix:"RelatedAlertsBySession",state:g,text:dt(g,u),renderContent:b})}));function dt(e,t){switch(e){case"loading":return ze.o;case"error":return ze.n;case"success":return Object(ze.l)(t);default:return""}}ut.displayName="RelatedAlertsBySession";const pt=je.euiStyled.div`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 12px;
  border-radius: 6px;
`,mt=Object(je.euiStyled)(r.EuiIcon)`
  margin-right: 10px;
`,ft=s.a.memo((()=>{const{application:e}=Object(at.j)().services;return s.a.createElement(pt,null,s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(mt,{size:"m",type:"lock"})),s.a.createElement(r.EuiFlexItem,null,s.a.createElement(r.EuiText,{size:"s"},s.a.createElement(r.EuiLink,{color:"subdued",target:"_blank",href:e.getUrlForApp("management",{path:"stack/license_management/home"})},ze.f)))))}));ft.displayName="RelatedAlertsUpsell";const gt=Object(je.euiStyled)(r.EuiFlexItem)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
  display: inline-flex;
`,bt=s.a.memo((({browserFields:e,eventId:t,data:n,isReadOnly:a,scopeId:i})=>{const{cases:o}=Object(at.j)().services,l=Object(Be.b)().isPlatinumPlus(),c=Object(D.find)({category:"kibana",field:"kibana.alert.ancestors.id"},n),u=Object(D.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},n),d=Object(D.find)({category:"agent",field:"agent.type"},n),p=Object(D.find)({category:"event",field:"event.module"},n),m=qe(Object(D.find)({category:"process",field:"process.entity_id"},n))&&function(e,t){return qe(e)&&("endpoint"===e.values[0]||"winlogbeat"===e.values[0]&&qe(t)&&"sysmon"===t.values[0])}(d,p),f=Object(D.find)({category:"process",field:"process.entry_leader.entity_id"},n),g=qe(f),b=Object(D.find)({category:"kibana",field:"kibana.alert.original_event.id"},n),y=qe(b),h=Object(D.find)({category:"kibana",field:Re.t},n),v=qe(h),E=o.helpers.canUseCases([Le.APP_ID]).read,x=m&&c&&u;return a||!(E||m||y||g)?null:s.a.createElement("div",null,s.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"m"},s.a.createElement(r.EuiFlexItem,null,s.a.createElement(r.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,ze.e))),v&&s.a.createElement(gt,null,s.a.createElement("div",null,s.a.createElement(r.EuiIcon,{type:"layers",style:{marginLeft:"4px",marginRight:"8px"}}),ze.v(parseInt(h.values[0],10)),s.a.createElement(r.EuiBetaBadge,{label:ze.w,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}))),E&&s.a.createElement(r.EuiFlexItem,null,s.a.createElement(ot,{eventId:t})),b&&b.values&&s.a.createElement(r.EuiFlexItem,null,s.a.createElement(lt,{browserFields:e,data:b,eventId:t,scopeId:i})),f&&f.values&&s.a.createElement(r.EuiFlexItem,{"data-test-subj":"related-alerts-by-session"},s.a.createElement(ut,{browserFields:e,data:f,eventId:t,scopeId:i})),x&&(l?s.a.createElement(r.EuiFlexItem,{"data-test-subj":"related-alerts-by-ancestry"},s.a.createElement(Xe,{originalDocumentId:c,index:u,eventId:t,scopeId:i})):s.a.createElement(r.EuiFlexItem,null,s.a.createElement(ft,null)))))}));bt.displayName="Insights";var yt=n(313);const ht={cursorStart:0,querySize:1};var vt=n(299),Et=n(150),xt=n(304),jt=n(729);let St=function(e){return e.tableView="table-view",e.jsonView="json-view",e.summaryView="summary-view",e.threatIntelView="threat-intel-view",e.osqueryView="osquery-results-view",e.responseActionsView="response-actions-results-view",e}({});const Ot=c()(r.EuiTabbedContent).withConfig({displayName:"StyledEuiTabbedContent",componentId:"sc-xa1bmm-0"})(["display:flex;flex:1;flex-direction:column;overflow:hidden;> [role='tabpanel']{display:flex;flex:1;flex-direction:column;overflow:hidden;overflow-y:auto;::-webkit-scrollbar{-webkit-appearance:none;width:7px;}::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,0.5);-webkit-box-shadow:0 0 1px rgba(255,255,255,0.5);}}"]),kt=c.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-xa1bmm-1"})(["height:100%;position:relative;"]),wt=c.a.div.withConfig({displayName:"RendererContainer",componentId:"sc-xa1bmm-2"})(["overflow-x:auto;padding-right:",";& ."," .euiFlexGroup{justify-content:flex-start;}"],(e=>e.theme.eui.euiSizeXS),Et.a),Tt=c()(r.EuiFlexGroup).withConfig({displayName:"ThreatTacticContainer",componentId:"sc-xa1bmm-3"})(["flex-grow:0;flex-wrap:nowrap;& .euiFlexGroup{flex-wrap:nowrap;}"]),It=c.a.div.withConfig({displayName:"ThreatTacticDescription",componentId:"sc-xa1bmm-4"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeL)),Mt=({browserFields:e,data:t,detailsEcsData:n,id:a,isAlert:l,isDraggable:c,rawEventData:E,scopeId:x,timelineTabType:S,handleOnEventClosed:O,isReadOnly:k})=>{var T;const[I,M]=Object(o.useState)(St.summaryView),C=Object(o.useCallback)((e=>M(e.id)),[]),_=Object(o.useCallback)((()=>M(St.tableView)),[]),D=Object(o.useMemo)((()=>Object(F.c)(t)),[t]),A=Object(d.b)(t),{rule:N}=Object(p.a)(A.ruleId),P=Object(o.useMemo)((()=>l?Object(F.g)(t).map((e=>Object(F.h)(e))):[]),[t,l]),{result:R,loading:L,setRange:z,range:q}=Object(ve.c)(D),B=Object(o.useMemo)((()=>Object(g.a)(E)),[E]),$=Object(o.useMemo)((()=>L||null==R||!R.enrichments?P:Object(F.b)([...P,...R.enrichments])),[L,R,P]),V=$.length,{hostRisk:U,userRisk:G,isAuthorized:H}=(e=>{const{hostName:t,userName:n}=Object(d.b)(e),a=Object(o.useMemo)((()=>t?Object(w.z)([t]):void 0),[t]),{data:i,loading:r,isAuthorized:s,isModuleEnabled:l}=Object(yt.a)({filterQuery:a,pagination:ht,riskEntity:w.t.host,skip:!a}),c=Object(o.useMemo)((()=>({loading:r,isModuleEnabled:l,result:i})),[i,r,l]),u=Object(o.useMemo)((()=>n?Object(w.A)([n]):void 0),[n]),{data:p,loading:m,isAuthorized:f,isModuleEnabled:g}=Object(yt.a)({filterQuery:u,pagination:ht,riskEntity:w.t.user,skip:!u});return{userRisk:Object(o.useMemo)((()=>({loading:m,isModuleEnabled:g,result:p})),[m,g,p]),hostRisk:c,isAuthorized:s&&f}})(t),W=Object(o.useMemo)((()=>null!=n?Object(vt.a)({data:n,rowRenderers:xt.b}):null),[n]),Q=Object(o.useMemo)((()=>Object(y.c)(x)),[x]),Y=Object(o.useMemo)((()=>V>0||H&&(U||G)),[V,U,H,G]),K=Object(f.a)("endpointResponseActionsEnabled"),J=Object(o.useMemo)((()=>{var i,o;return l?{id:St.summaryView,name:ee.v,"data-test-subj":"overviewTab",content:s.a.createElement(b.a,{isTourAnchor:Q,step:h.a.reviewAlertDetailsFlyout,tourId:h.b.alertsCases},s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiSpacer,{size:"m"}),s.a.createElement(Fe,{browserFields:e,contextId:x,data:t,eventId:a,scopeId:x,handleOnEventClosed:O,isReadOnly:k}),s.a.createElement(r.EuiSpacer,{size:"l"}),B&&B[0]&&s.a.createElement(Tt,{alignItems:"flexStart",direction:"column",wrap:!1,gutterSize:"none"},s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiTitle,{size:"xxs"},s.a.createElement("h5",null,B[0].title)),s.a.createElement(It,null,B[0].description))),s.a.createElement(r.EuiSpacer,{size:"l"}),null!=W&&null!=n&&s.a.createElement("div",null,s.a.createElement(r.EuiTitle,{size:"xs"},s.a.createElement("h5",null,ee.c)),s.a.createElement(r.EuiSpacer,{size:"s"}),s.a.createElement(wt,{"data-test-subj":"renderer"},W.renderRow({contextId:"event-details",data:n,isDraggable:null!=c&&c,scopeId:x}))),s.a.createElement(r.EuiHorizontalRule,null),s.a.createElement(he,{data:t,eventId:a,browserFields:e,isDraggable:c,scopeId:x,title:ee.l,isReadOnly:k,goToTable:_,investigationFields:null!==(i=null==N||null===(o=N.investigation_fields)||void 0===o?void 0:o.field_names)&&void 0!==i?i:[]}),s.a.createElement(r.EuiSpacer,{size:"xl"}),s.a.createElement(bt,{browserFields:e,eventId:a,data:t,scopeId:x,isReadOnly:k}),Y&&s.a.createElement(Z,{isDraggable:c,hostRisk:U,userRisk:G,browserFields:e,data:t,eventId:a,scopeId:x,enrichments:$,isReadOnly:k}),L&&s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiSkeletonText,{lines:2})),A.ruleId&&(null==N?void 0:N.note)&&s.a.createElement(xe.b,{basicData:A,ruleNote:N.note})))}:void 0}),[l,Q,e,x,t,a,O,k,B,W,n,c,_,null==N||null===(T=N.investigation_fields)||void 0===T?void 0:T.field_names,null==N?void 0:N.note,Y,U,G,$,L,A]),te=Object(o.useMemo)((()=>l&&!k?{id:St.threatIntelView,"data-test-subj":"threatIntelTab",name:ee.C,append:s.a.createElement(s.a.Fragment,null,L?s.a.createElement(r.EuiLoadingSpinner,null):s.a.createElement(r.EuiNotificationBadge,{"data-test-subj":"enrichment-count-notification"},V)),content:s.a.createElement(X.a,{before:s.a.createElement(r.EuiSpacer,{size:"m"}),loading:L,enrichments:$,showInvestigationTimeEnrichments:!Object(u.isEmpty)(D)},s.a.createElement(s.a.Fragment,null,s.a.createElement(Ee.a,{setRange:z,loading:L,range:q}),s.a.createElement(r.EuiSpacer,{size:"m"})))}:void 0),[$,z,q,V,l,D,L,k]),ne=Object(o.useMemo)((()=>({id:St.tableView,"data-test-subj":"tableTab",name:ee.B,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiSpacer,{size:"l"}),s.a.createElement(v.a,{browserFields:e,data:t,eventId:a,isDraggable:c,scopeId:x,timelineTabType:S,isReadOnly:k}))})),[e,t,a,c,x,S,k]),ae=Object(o.useMemo)((()=>({id:St.jsonView,"data-test-subj":"jsonViewTab",name:ee.r,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiSpacer,{size:"m"}),s.a.createElement(kt,{"data-test-subj":"jsonViewWrapper"},s.a.createElement(j,{rawEventData:E})))})),[E]),ie=Object(m.a)({rawEventData:E,...null!==n?{ecsData:n}:{}}),re=Object(jt.a)({rawEventData:E,...null!==n?{ecsData:n}:{}}),oe=Object(o.useMemo)((()=>K?[ie]:[re]),[K,re,ie]),se=Object(o.useMemo)((()=>[J,te,ne,ae,...oe].filter((e=>!!e))),[J,te,ne,ae,oe]),le=Object(o.useMemo)((()=>{var e;return null!==(e=se.find((e=>e.id===I)))&&void 0!==e?e:se[0]}),[se,I]),ce=Object(o.useMemo)((()=>Q?{"tour-step":Object(h.c)(3,h.b.alertsCases)}:{}),[Q]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiSpacer,{size:"s"}),s.a.createElement(Ot,i()({},ce,{"data-test-subj":"eventDetails",tabs:se,selectedTab:le,onTabClick:C,key:"event-summary-tabs"})))};Mt.displayName="EventDetailsComponent";const Ct=s.a.memo(Mt)},function(e,t,n){"use strict";n.d(t,"a",(function(){return _e})),n.d(t,"c",(function(){return De})),n.d(t,"b",(function(){return Ae})),n.d(t,"d",(function(){return Fe}));var a=n(19),i=n(954),r=n(477),o=n(2),s=n.n(o),l=n(7),c=n(42),u=n(4),d=n(119),p=n.n(d);const m=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:i},fieldState:{error:l}}=Object(r.useController)({name:"label",defaultValue:""}),c=Object(o.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return s.a.createElement(a.EuiFormRow,{label:u.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==l?void 0:l.message,isInvalid:c,fullWidth:!0},s.a.createElement(a.EuiFieldText,p()({isInvalid:c,onChange:t,value:n,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},f=s.a.memo(m),g=u.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),b=()=>s.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:s.a.createElement("h2",null,g),titleSize:"xs",body:s.a.createElement("p",null,s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:s.a.createElement(a.EuiCode,null,"osquery")}}))});var y=n(118);const h=({node:e,onSave:t,onCancel:n})=>{var i,d,p;const m=null!=e,{osquery:g,application:{capabilities:{osquery:h}}}=Object(y.j)().services,v=Object(r.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(p=e.configuration)||void 0===p?void 0:p.ecs_mapping}}),E=Object(o.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(l.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t]),x=Object(o.useMemo)((()=>!(h.runSavedQueries&&h.readSavedQueries||h.writeLiveQueries)),[h.readSavedQueries,h.runSavedQueries,h.writeLiveQueries]),j=Object(o.useMemo)((()=>{if(null!=g&&g.LiveQueryField){const{LiveQueryField:e}=g;return s.a.createElement(r.FormProvider,v,s.a.createElement(f,null),s.a.createElement(a.EuiSpacer,{size:"m"}),s.a.createElement(e,{formMethods:v}))}return null}),[v,g]);return x?s.a.createElement(b,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiModalHeader,null,s.a.createElement(a.EuiModalHeaderTitle,null,s.a.createElement("h1",null,m?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),s.a.createElement(a.EuiModalBody,null,s.a.createElement(s.a.Fragment,null,j)),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButtonEmpty,{onClick:n},u.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),s.a.createElement(a.EuiButton,{onClick:v.handleSubmit(E),fill:!0},m?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},v=s.a.memo(h);var E=n(478),x=n(41),j=n.n(x),S=n(208),O=n(394),k=n(262),w=n(1087),T=n.n(w),I=n(571);const M=j()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var C=n(54),_=n.n(C),D=n(60),A=n.n(D),F=(n(43),n(53)),N=n(123),P=n(55),R=n(1484),L=n(146),z=n(250),q=n(717),B=n(132),$=n(127);const V=["*"],U={};var G=n(121),H=n(179);const W=e=>e===F.FILTERS.EXISTS?H.b:e===F.FILTERS.PHRASES?H.c:H.d,Q={$state:{store:F.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},Y={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:G.a.default,queryMatch:{field:"",value:"",operator:H.b}},K=e=>{const t={...Q,meta:{...Q.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===F.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===F.FILTERS.PHRASES){var n;let a=JSON.parse(String(e.value));return"number"===e.valueType?a=a.map(Number):"boolean"===e.valueType&&(a=a.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(n=a)||void 0===n?void 0:n.map((t=>({match_phrase:{[e.field]:t}})))}}}}var a;if(e.queryType===F.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(a=e.value)&&void 0!==a?a:""}}};if(e.queryType===F.FILTERS.RANGE){let n,a;try{const t=JSON.parse(String(e.value));n=t.gte,a=t.lt}catch{n="",a=""}const i={gte:n,lt:a};return{...t,meta:{...t.meta,params:i},query:{range:{[e.field]:i}}}}return t},J=({providers:e,alertData:t})=>{const n=Object(o.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(o.useMemo)((()=>n?[]:((e,t)=>e.map((e=>e.reduce(((e,n,a)=>{const{field:i,value:r,excluded:o,queryType:s}=n,{result:c,matchedBrackets:u}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const n=/\{{([^}]+)\}}/g,a=e.match(new RegExp(n));let i=e;a&&t&&Object(l.each)(a,(e=>{const n=e.replace(/{{|}}/g,"").trim();if(i.includes(e)){const a=t.find((({field:e})=>e===n));if(a&&a.values){const{values:[t]}=a;i=i.replace(e,t)}}}));const r=new RegExp(n).test(i);return{result:i,skipped:r,matchedBrackets:a}})(r,t),d=!t&&u;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(i+r),name:i,excluded:o,kqlQuery:"",type:d?G.a.template:G.a.default,queryMatch:{field:i,value:c,operator:W(s)}};{const t={enabled:!0,id:JSON.stringify(i+r),name:i,excluded:o,kqlQuery:"",type:d?G.a.template:G.a.default,queryMatch:{field:i,value:c,operator:W(s)}};e.and.push(t)}return e}),Y))))(e,t)),[t,e,n]),filters:Object(o.useMemo)((()=>n?((e,t)=>{const n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.length>1){const e=a.map((e=>K(e))),t={$state:{store:F.FilterStateStore.APP_STATE},meta:{type:F.FILTERS.COMBINED,relation:F.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};n.push(t)}else{const e=a[0],t=K(e);n.push(t)}}return n})(e):[]),[n,e,t])}};var Z=n(263),X=n(396),ee=n(5);const te=e=>{var t,n,a,i,r,o;const s=null!==(t=null===(n=e.meta)||void 0===n?void 0:n.key)&&void 0!==t?t:"",l={field:s,excluded:null!==(a=null===(i=e.meta)||void 0===i?void 0:i.negate)&&void 0!==a&&a,queryType:null!==(r=null===(o=e.meta)||void 0===o?void 0:o.type)&&void 0!==r?r:F.FILTERS.PHRASE};if(Object(F.isRangeFilter)(e)){var c;const{gte:t,lt:n}=e.query.range[s],a=JSON.stringify({gte:t,lt:n});return{...l,value:a,queryType:null!==(c=e.meta.type)&&void 0!==c?c:F.FILTERS.RANGE}}if(Object(F.isPhrasesFilter)(e)){var u,d,p,m;const t=typeof(null===(u=e.meta)||void 0===u?void 0:u.params[0]);return{...l,value:JSON.stringify(null!==(d=null===(p=e.meta)||void 0===p?void 0:p.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(m=e.meta.type)&&void 0!==m?m:F.FILTERS.PHRASES}}var f;if(Object(F.isExistsFilter)(e))return{...l,value:"",queryType:null!==(f=e.meta.type)&&void 0!==f?f:F.FILTERS.EXISTS};if(Object(F.isPhraseFilter)(e)){var g,b,y,h,v,E;const t=typeof(null===(g=e.meta)||void 0===g||null===(b=g.params)||void 0===b?void 0:b.query);return{...l,value:null!==(y=null===(h=e.meta)||void 0===h||null===(v=h.params)||void 0===v?void 0:v.query)&&void 0!==y?y:"",valueType:t,queryType:null!==(E=e.meta.type)&&void 0!==E?E:F.FILTERS.PHRASE}}return{...l,value:"",queryType:F.FILTERS.PHRASE}},ne=e=>e.map((e=>te(e))),ae=e=>!1===e.some(F.isCombinedFilter)?[ne(e)]:e.reduce(((e,t)=>{if(Object(F.isCombinedFilter)(t)){const n=t.meta.params;if(t.meta.relation===F.BooleanRelation.OR){const t=n.map((e=>{const t=ae([e]);return Object(l.flatten)(t)}));return[...e,...t]}{const t=ae(n);return[...e,...t]}}return[...e,[te(t)]]}),[]);var ie=n(16),re=n(63),oe=n.n(re),se=n(656),le=n.n(se),ce=n(233);function ue(e,t,n){var a;if(void 0===t||"undefined"===n)return!1;switch(e.type){case"date":const n="string"==typeof t?oe.a.parse(t):null;return Boolean("string"==typeof t&&n&&n.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new P.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(a=e.esTypes)&&void 0!==a&&a.includes(ce.a.VERSION)?Boolean(le()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const de=u.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),pe=u.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),me=u.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),fe=u.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),ge=u.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),be=u.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),ye=u.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),he=u.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),ve=u.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),Ee=u.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),xe=u.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),je=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"});var Se=n(766);const Oe="!{investigate",ke=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>{const{addError:l}=Object(N.a)();let c=[];try{void 0!==n&&(c=JSON.parse(n))}catch(e){l(e,{title:je})}const{data:u,timestamp:d}=Object(o.useContext)(O.a),{dataProviders:p,filters:m}=J({providers:c,alertData:u}),f=Object(o.useMemo)((()=>{if(i&&r){const e=d?_()(d):_()();return{kind:"absolute",from:Object(X.e)(i,X.a,!1,_.a,e.toDate()).toISOString(),to:Object(X.e)(r,X.b,!0,_.a,e.toDate()).toISOString()}}return null}),[i,r,d]),{totalCount:g,isQueryLoading:b,oldestTimestamp:h,hasError:v}=(({dataProviders:e,filters:t,relativeTimerange:n})=>{const{uiSettings:a}=Object(y.j)().services,i=Object(o.useMemo)((()=>Object(P.getEsQueryConfig)(a)),[a]),{browserFields:r,selectedPatterns:s,indexPattern:l,dataViewId:c}=Object(B.a)($.SourcererScopeName.timeline),[u,d]=Object(o.useState)(!1),p=Object(o.useMemo)((()=>{try{if(!1===u)return Object(z.d)({config:i,dataProviders:e,indexPattern:l,browserFields:r,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[r,e,i,u,l,t]),[m,{events:f,totalCount:g}]=Object(q.a)({dataViewId:c,fields:V,filterQuery:null==p?void 0:p.filterQuery,id:L.c.active,indexNames:s,language:"kuery",limit:1,runtimeMappings:U,startDate:null==n?void 0:n.from,endDate:null==n?void 0:n.to,fetchNotes:!1}),b=Object(o.useMemo)((()=>[R.a.loading,R.a.loadingMore].includes(m)),[m]),[h]=f,v=h&&h.data&&h.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:b,totalCount:g,oldestTimestamp:v&&v.value&&v.value[0],hasError:u}})({dataProviders:p,filters:m,relativeTimerange:f}),E=Object(o.useMemo)((()=>{if(f)return f;if(null!=h)return{kind:"absolute",from:h,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(X.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[h,f]);return b?s.a.createElement(a.EuiLoadingSpinner,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(Z.a,{asEmptyButton:!1,isDisabled:v,dataProviders:p,filters:m,timeRange:E,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},s.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${A()(g).format("0,0.[000]a")})`),s.a.createElement("div",null,t))},we=({node:e,onSave:t,onCancel:n})=>{const i=null!=e,{indexPattern:u}=Object(B.a)($.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:d}},uiSettings:m}=Object(y.j)().services,f=Object(Se.a)({sourcererScope:$.SourcererScopeName.default}),[g,b]=Object(o.useState)([[]]),h=Object(o.useMemo)((()=>[{value:"0",text:""},...m.get(ee.db).map((({display:e},t)=>({value:String(t),text:e})))]),[m]),v=Object(r.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),E=Object(r.useController)({name:"label",control:v.control}),x=Object(r.useController)({name:"description",control:v.control}),j=Object(r.useController)({name:"relativeTimerange",control:v.control}),S=Object(o.useCallback)((e=>{const t=h.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),n=m.get(ee.db);return{relativeFrom:n[e].from,relativeTo:n[e].to}}return{}}),[h,m]),O=Object(o.useCallback)((()=>{t(`${Oe}${JSON.stringify(Object(l.pickBy)({label:E.field.value,description:x.field.value,providers:g,...S(j.field.value)},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t,g,E.field.value,x.field.value,j.field.value,S]),k=Object(o.useCallback)((e=>{b(ae(e))}),[]),w=Object(o.useCallback)((e=>{j.field.onChange(e.target.value)}),[j.field]),T=Object(o.useMemo)((()=>{var e;const t=null!==(e=E.field.value)&&void 0!==e?e:"",n=g.flat();return""===t.trim()||0===n.length||n.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return ue(t,e.value,e.valueType);case"phrases":const n="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(n)||!n.length)&&n.every((n=>ue(t,n,e.valueType)));case"range":const a=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof a&&(!a.gte||ue(t,a.gte,e.valueType))&&(!a.lt||ue(t,a.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==f?void 0:f.getFieldByName(e.field))))}),[E.field.value,g,f]),I=Object(o.useMemo)((()=>{const e=u&&u.getName?u.getName():"*";return[{$state:{store:F.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[u]),M=Object(ie.b)().isAtLeast("platinum");return s.a.createElement(s.a.Fragment,null,s.a.createElement(Me,null,s.a.createElement(a.EuiModalHeaderTitle,null,s.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(a.EuiFlexItem,null,i?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===M&&s.a.createElement(a.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),s.a.createElement(a.EuiModalBody,null,s.a.createElement(r.FormProvider,v,s.a.createElement(a.EuiForm,{fullWidth:!0},s.a.createElement(a.EuiFormRow,{label:be,fullWidth:!0},s.a.createElement(s.a.Fragment,null)),s.a.createElement(a.EuiFormRow,{label:de,helpText:me,isInvalid:void 0!==E.field.value&&0===E.field.value.trim().length,fullWidth:!0},s.a.createElement(a.EuiFieldText,p()({},v.register("label"),{ref:null,name:"label",onChange:E.field.onChange}))),s.a.createElement(a.EuiFormRow,{label:fe,helpText:ge,fullWidth:!0},s.a.createElement(a.EuiFieldText,p()({},v.register("description"),{ref:null,name:"description",onChange:x.field.onChange}))),s.a.createElement(a.EuiFormRow,{label:ye,helpText:he,fullWidth:!0},f?s.a.createElement(d,{filters:I,onChange:k,dataView:f,maxDepth:1}):s.a.createElement(s.a.Fragment,null)),s.a.createElement(a.EuiFormRow,{label:ve,helpText:Ee,fullWidth:!0},s.a.createElement(a.EuiSelect,p()({},v.register("relativeTimerange"),{ref:null,onChange:w,options:h})))))),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButtonEmpty,{onClick:n},xe),s.a.createElement(a.EuiButton,{onClick:v.handleSubmit(O),fill:!0,disabled:T},i?s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Te=s.a.memo(we),Ie=`${Oe}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var Me=j()(a.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Ce=Object(a.getDefaultEuiMarkdownUiPlugins)(),_e=Object(a.getDefaultEuiMarkdownParsingPlugins)(),De=Object(a.getDefaultEuiMarkdownProcessingPlugins)(),Ae=[Oe],Fe=({insightsUpsellingMessage:e,interactionsUpsellingMessage:t})=>{const n=Ce.map((e=>e.name)),r=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:pe,iconType:"timelineWithArrow",isDisabled:!!e},helpText:s.a.createElement("div",null,s.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},Ie),s.a.createElement(a.EuiSpacer,{size:"s"})),editor:Te}))({insightsUpsellingMessage:e}),o=i.b({interactionsUpsellingMessage:t}),l=(({interactionsUpsellingMessage:e})=>({name:"osquery",button:{label:null!=e?e:"Osquery",iconType:"logoOsquery",isDisabled:!!e},helpText:s.a.createElement("div",null,s.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),s.a.createElement(a.EuiSpacer,{size:"s"})),editor:v}))({interactionsUpsellingMessage:t});if(!1===n.includes(r.name))Ce.push(o),Ce.push(l),Ce.push(r);else{const e=Ce.findIndex((e=>e.name===r.name));Ce[e]=r}return Ce};_e.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){if(!1===t.startsWith(Oe))return!1;const a=t[13];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i={};if("{"===a){let n="",a=0;for(let e=13;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}try{return i=JSON.parse(n),e(t)({type:"insight",...i,providers:JSON.stringify(i.providers)})}catch(t){const n=e.now();this.file.fail((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:n.line,column:n.column+13})}}return!1};a.locator=(e,t)=>e.indexOf(Oe,t),t.insight=a,n.splice(n.indexOf("text"),0,"insight")})),_e.push(i.a),_e.push(E.a),De[1][1].components.insight=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>{const o=Object(S.b)("investigation_guide");return o?s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiToolTip,{content:o},s.a.createElement(a.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`)),s.a.createElement("div",null,t)):s.a.createElement(ke,{label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})},De[1][1].components.timeline=i.c,De[1][1].components.osquery=({configuration:e})=>{var t;const[n,i]=Object(o.useState)(!1),{agentId:r,alertId:c,data:d}=Object(o.useContext)(O.a),p=Object(o.useCallback)((()=>i(!0)),[i]),m=Object(o.useCallback)((()=>i(!1)),[i]),f=Object(S.b)("investigation_guide_interactions"),g=Object(o.useMemo)((()=>{const e=Object(l.reduce)(d,((e,t)=>{var n;return{...e,[t.field]:null==t||null===(n=t.values)||void 0===n?void 0:n[0]}}),{});return Object(k.a)(e)}),[d]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiToolTip,{content:f},s.a.createElement(M,{iconType:T.a,onClick:p,disabled:!!f},null!==(t=e.label)&&void 0!==t?t:u.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"}))),n&&s.a.createElement(I.a,{defaultValues:{...c?{alertIds:[c]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:r,onClose:m,ecsData:g}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return R.a})),n.d(t,"e",(function(){return R.e})),n.d(t,"d",(function(){return R.d})),n.d(t,"c",(function(){return R.c})),n.d(t,"f",(function(){return R.h})),n.d(t,"g",(function(){return R.l})),n.d(t,"j",(function(){return R.r})),n.d(t,"n",(function(){return R.v})),n.d(t,"m",(function(){return R.u})),n.d(t,"l",(function(){return R.t})),n.d(t,"k",(function(){return R.s})),n.d(t,"h",(function(){return R.o})),n.d(t,"i",(function(){return R.p})),n.d(t,"r",(function(){return R.A})),n.d(t,"s",(function(){return R.B})),n.d(t,"v",(function(){return R.E})),n.d(t,"p",(function(){return R.y})),n.d(t,"t",(function(){return R.C})),n.d(t,"o",(function(){return R.x})),n.d(t,"u",(function(){return R.D})),n.d(t,"q",(function(){return R.z}));var a=n(2),i=n.n(a),r=n(19),o=n(45),s=n(151),l=n(41),c=n.n(l);const u=c.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-170nqoz-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));u.displayName="SearchRowContainer";const d=c()(r.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-170nqoz-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));d.displayName="SearchRowFlexGroup";const p=i.a.memo((()=>{const e=Object(o.useDispatch)(),t=Object(a.useMemo)((()=>({placeholder:"Search note contents",incremental:!1,"data-test-subj":"notes-search-bar"})),[]),n=Object(a.useCallback)((({queryText:t})=>{e(Object(R.y)(t.trim()))}),[e]);return i.a.createElement(u,null,i.a.createElement(d,{gutterSize:"s"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiSearchBar,{box:t,onChange:n,defaultQuery:""}))))}));p.displayName="SearchRow";var m=n(362),f=n(4);const g=f.i18n.translate("xpack.securitySolution.notes.management.batchActionsTitle",{defaultMessage:"Bulk actions"}),b=f.i18n.translate("xpack.securitySolution.notes.management.createdColumnTitle",{defaultMessage:"Created"}),y=f.i18n.translate("xpack.securitySolution.notes.management.createdByColumnTitle",{defaultMessage:"Created by"}),h=f.i18n.translate("xpack.securitySolution.notes.management.eventIdColumnTitle",{defaultMessage:"View Document"}),v=f.i18n.translate("xpack.securitySolution.notes.management.timelineColumnTitle",{defaultMessage:"Timeline"}),E=f.i18n.translate("xpack.securitySolution.notes.management.noteContentColumnTitle",{defaultMessage:"Note content"}),x=f.i18n.translate("xpack.securitySolution.notes.management.deleteAction",{defaultMessage:"Delete"}),j=f.i18n.translate("xpack.securitySolution.notes.management.deleteDescription",{defaultMessage:"Delete this note"}),S=f.i18n.translate("xpack.securitySolution.notes.management.tableError",{defaultMessage:"Unable to load notes"}),O=f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesModalTitle",{defaultMessage:"Delete notes?"}),k=f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesCancel",{defaultMessage:"Cancel"}),w=f.i18n.translate("xpack.securitySolution.notes.management.deleteSelected",{defaultMessage:"Delete selected notes"}),T=f.i18n.translate("xpack.securitySolution.notes.management.refresh",{defaultMessage:"Refresh"}),I=f.i18n.translate("xpack.securitySolution.notes.management.openTimeline",{defaultMessage:"Open timeline"}),M=f.i18n.translate("xpack.securitySolution.notes.management.viewEventInTimeline",{defaultMessage:"View event in timeline"}),C=i.a.memo((()=>{const e=Object(o.useDispatch)(),t=Object(o.useSelector)(R.r),n=Object(o.useSelector)(R.v),s=Object(o.useSelector)(R.u),l=Object(a.useMemo)((()=>{const{perPage:e,page:n,total:a}=t,i=e*(n-1)+1,r=Math.min(e*n,a);return 0===e?"All":`${i}-${r} of ${a}`}),[t]),c=Object(a.useCallback)((()=>{e(Object(R.z)())}),[e]),u=Object(o.useSelector)(R.t),d=Object(a.useCallback)((()=>i.a.createElement(r.EuiContextMenuItem,{"data-test-subj":"notes-management-delete-notes",onClick:c,disabled:0===s.length,icon:"trash",key:"DeleteItemKey"},w)),[c,s.length]),p=Object(a.useCallback)((()=>{e(Object(R.d)({page:t.page,perPage:t.perPage,sortField:n.field,sortOrder:n.direction,filter:"",search:u}))}),[e,t.page,t.perPage,n.field,n.direction,u]);return i.a.createElement(m.a,{border:!0},i.a.createElement(m.d,null,i.a.createElement(m.c,null,i.a.createElement(m.e,{"data-test-subj":"notes-management-pagination-count"},`Showing: ${l}`)),i.a.createElement(m.c,null,i.a.createElement(m.e,{"data-test-subj":"notes-management-selected-count"},s.length>0?`${s.length} selected`:""),i.a.createElement(m.b,{dataTestSubj:"notes-management-utility-bar-actions",iconSide:"right",iconType:"arrowDown",popoverContent:d},i.a.createElement("span",{"data-test-subj":"notes-management-utility-bar-action-button"},g)),i.a.createElement(m.b,{dataTestSubj:"notes-management-utility-bar-refresh-button",iconSide:"right",iconType:"refresh",onClick:p},T))))}));C.displayName="NotesUtilityBar";const _=i.a.memo((()=>{const e=Object(o.useDispatch)(),t=Object(o.useSelector)(R.s),n=Object(o.useSelector)(R.l)===R.a.Loading,s=Object(a.useCallback)((()=>{e(Object(R.x)())}),[e]),l=Object(a.useCallback)((()=>{e(Object(R.c)({ids:t,refetch:!0}))}),[e,t]);return i.a.createElement(r.EuiConfirmModal,{"aria-labelledby":"delete-notes-modal",title:O,onCancel:s,onConfirm:l,isLoading:n,cancelButtonText:k,confirmButtonText:x,buttonColor:"danger",defaultFocusedButton:"confirm"},(c=t.length,f.i18n.translate("xpack.securitySolution.notes.management.deleteNotesConfirm",{values:{selectedNotes:c},defaultMessage:"Are you sure you want to delete {selectedNotes} {selectedNotes, plural, one {note} other {notes}}?"})));var c}));_.displayName="DeleteConfirmModal";var D=n(377);const A=Object(a.memo)((({eventId:e})=>{const t={event:{id:[e]},_id:e},{investigateInTimelineAlertClick:n}=Object(D.a)({ecsRowData:t});return i.a.createElement(r.EuiLink,{onClick:n,"data-test-subj":"open-event-in-timeline"},M)}));A.displayName="OpenEventInTimeline";const F=e=>[{field:"created",name:b,sortable:!0,render:e=>i.a.createElement(s.b,{value:e})},{field:"createdBy",name:y},{field:"eventId",name:h,sortable:!0,render:e=>i.a.createElement(A,{eventId:e})},{field:"timelineId",name:v,render:t=>t?i.a.createElement(r.EuiLink,{onClick:()=>e({timelineId:t,duplicate:!1})},I):null},{field:"note",name:E}],N=[10,25,50,100],P=({onOpenTimeline:e})=>{const t=Object(o.useDispatch)(),n=Object(o.useSelector)(R.h),s=Object(o.useSelector)(R.r),l=Object(o.useSelector)(R.v),c=Object(o.useSelector)(R.t),u=Object(o.useSelector)(R.s).length>0,d=Object(o.useSelector)(R.p),m=d===R.a.Loading,f=d===R.a.Failed,g=Object(o.useSelector)(R.o),b=Object(a.useCallback)((()=>{t(Object(R.d)({page:s.page,perPage:s.perPage,sortField:l.field,sortOrder:l.direction,filter:"",search:c}))}),[t,s.page,s.perPage,l.field,l.direction,c]);Object(a.useEffect)((()=>{b()}),[b]);const y=Object(a.useCallback)((({page:e,sort:n})=>{e&&(t(Object(R.A)(e.index+1)),t(Object(R.B)(e.size))),n&&t(Object(R.E)({field:n.field,direction:n.direction}))}),[t]),h=Object(a.useCallback)((e=>{t(Object(R.D)(e))}),[t]),v=Object(a.useCallback)((e=>{const n=e.map((e=>e.noteId));t(Object(R.C)(n))}),[t]),E=Object(a.useCallback)((e=>e.noteId),[]),O=Object(a.useMemo)((()=>{const t=[{name:x,description:j,color:"primary",icon:"trash",type:"icon",onClick:e=>h(e.noteId)}];return[...F(e),{name:"actions",actions:t}]}),[h,e]),k=Object(a.useMemo)((()=>({pageIndex:s.page-1,pageSize:s.perPage,totalItemCount:s.total,pageSizeOptions:N})),[s]),w=Object(a.useMemo)((()=>({onSelectionChange:v,selectable:()=>!0})),[v]),T=Object(a.useMemo)((()=>({sort:l})),[l]);return f?i.a.createElement(r.EuiEmptyPrompt,{iconType:"error",color:"danger",title:i.a.createElement("h2",null,S),body:i.a.createElement("p",null,g)}):i.a.createElement(i.a.Fragment,null,i.a.createElement(p,null),i.a.createElement(C,null),i.a.createElement(r.EuiBasicTable,{items:n,pagination:k,columns:O,onChange:y,selection:w,sorting:T,itemId:E,loading:m}),u&&i.a.createElement(_,null))};P.displayName="NoteManagementPage";var R=n(289)},function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var a=n(2),i=n.n(a),r=n(19),o=n(45),s=n(41),l=n.n(s),c=n(149),u=n(622),d=n(131),p=n(664),m=n(129),f=n(206),g=n(118),b=n(355),y=n(180),h=n(949),v=n(559),E=n(44),x=n(839),j=n(4);const S=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.pinSelected",{defaultMessage:"Pin selected"}),O=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectAll",{defaultMessage:"All"}),k=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectNone",{defaultMessage:"None"}),w=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectPinned",{defaultMessage:"Pinned"}),T=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectUnpinned",{defaultMessage:"Unpinned"}),I=j.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.unpinSelected",{defaultMessage:"Unpin selected"}),M=l.a.div.withConfig({displayName:"InputDisplay",componentId:"sc-oi2e53-0"})(["width:5px;"]);M.displayName="InputDisplay";const C=l.a.div.withConfig({displayName:"PinIconContainer",componentId:"sc-oi2e53-1"})(["margin-right:5px;"]);C.displayName="PinIconContainer";const _=l.a.div.withConfig({displayName:"PinActionItem",componentId:"sc-oi2e53-2"})(["display:flex;flex-direction:row;"]);_.displayName="PinActionItem";const D=i.a.memo((({text:e})=>i.a.createElement(r.EuiText,{size:"s",color:"subdued"},e)));D.displayName="DropdownDisplay";const A=Object(s.createGlobalStyle)([".eventsSelectItem{width:100% !important;.euiContextMenu__icon{display:none !important;}}.eventsSelectDropdown{width:","px;}"],60),F=l.a.div.withConfig({displayName:"CheckboxContainer",componentId:"sc-1giocnz-0"})(["position:relative;"]);F.displayName="CheckboxContainer";const N=l.a.div.withConfig({displayName:"PositionedCheckbox",componentId:"sc-1giocnz-1"})(["left:7px;position:absolute;top:-28px;"]);N.displayName="PositionedCheckbox";const P=i.a.memo((({checkState:e,timelineId:t})=>i.a.createElement("div",{"data-test-subj":"events-select"},i.a.createElement(r.EuiSuperSelect,{className:"eventsSelectDropdown","data-test-subj":"events-select-dropdown",itemClassName:"eventsSelectItem",onChange:E.noop,options:[{inputDisplay:i.a.createElement(M,null),disabled:!0,dropdownDisplay:i.a.createElement(D,{text:O}),value:"select-all"},{inputDisplay:i.a.createElement(M,null),disabled:!0,dropdownDisplay:i.a.createElement(D,{text:k}),value:"select-none"},{inputDisplay:i.a.createElement(M,null),disabled:!0,dropdownDisplay:i.a.createElement(D,{text:w}),value:"select-pinned"},{inputDisplay:i.a.createElement(M,null),disabled:!0,dropdownDisplay:i.a.createElement(D,{text:T}),value:"select-unpinned"},{inputDisplay:i.a.createElement(M,null),disabled:!0,dropdownDisplay:i.a.createElement(_,null,i.a.createElement(C,null,i.a.createElement(x.a,{allowUnpinning:!0,isAlert:!1,pinned:!0})),i.a.createElement(D,{text:S})),value:"pin-selected"},{inputDisplay:i.a.createElement(M,null),disabled:!0,dropdownDisplay:i.a.createElement(_,null,i.a.createElement(C,null,i.a.createElement(x.a,{allowUnpinning:!0,isAlert:!1,pinned:!1})),i.a.createElement(D,{text:I})),value:"unpin-selected"}]}),i.a.createElement(F,{"data-test-subj":"timeline-events-select-checkbox-container"},i.a.createElement(N,{"data-test-subj":"timeline-events-select-positioned-checkbox"},i.a.createElement(r.EuiCheckbox,{checked:"checked"===e,"data-test-subj":"events-select-checkbox",disabled:!0,id:`timeline-${t}-events-select`,indeterminate:"indeterminate"===e,onChange:E.noop}))),i.a.createElement(A,null))));P.displayName="EventsSelect";var R=n(594),L=n(122),z=n(124),q=n(169);const B=l.a.div.withConfig({displayName:"SortingColumnsContainer",componentId:"sc-1ls1217-0"})(["button{color:",";}.euiPopover .euiButtonEmpty{padding:0;.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>e.eui.euiColorPrimary)),$=l.a.div.withConfig({displayName:"FieldBrowserContainer",componentId:"sc-1ls1217-1"})([".euiToolTipAnchor{.euiButtonContent{padding:",";}button{color:",";}.euiButtonContent__icon{width:16px;height:16px;}.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>`0 ${e.eui.euiSizeXS}`),(({theme:e})=>e.eui.euiColorPrimary)),V=l.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1ls1217-2"})(["align-items:center;display:flex;"]),U={},G=[],H=Object(a.memo)((({width:e,browserFields:t,columnHeaders:n,isEventViewer:s=!1,isSelectAllChecked:l,onSelectAll:E,showEventsSelect:x,showSelectAllCheckbox:j,showFullScreenToggle:S=!0,sort:O,tabType:k,timelineId:w,fieldBrowserOptions:T})=>{const{triggersActionsUi:I}=Object(g.j)().services,{globalFullScreen:M,setGlobalFullScreen:C}=Object(f.a)(),{timelineFullScreen:_,setTimelineFullScreen:D}=Object(f.c)(),A=Object(o.useDispatch)(),F=Object(L.a)("unifiedComponentsInTimelineDisabled"),{defaultColumns:N}=Object(z.a)((e=>Object(q.selectTimelineById)(e,w))),H=Object(a.useCallback)((()=>{w===c.f.active?D(!_):C(!M)}),[w,D,_,C,M]),W=Object(a.useMemo)((()=>Object(u.b)({globalFullScreen:M,isActiveTimelines:Object(d.isActiveTimeline)(w),timelineFullScreen:_})),[M,_,w]),Q=Object(a.useCallback)((e=>{E({isSelected:e.currentTarget.checked})}),[E]),Y=Object(a.useCallback)((e=>A(m.a.updateSort({id:w,sort:e.map((({id:e,direction:t})=>{var a,i;const r=n.find((t=>t.id===e)),o=null!==(a=null==r?void 0:r.type)&&void 0!==a?a:"",s=null!==(i=null==r?void 0:r.esTypes)&&void 0!==i?i:[];return{columnId:e,columnType:o,esTypes:s,sortDirection:t}}))}))),[n,A,w]),K=Object(a.useMemo)((()=>{var e;return{onSort:Y,columns:null!==(e=null==O?void 0:O.map((({columnId:e,sortDirection:t})=>({id:e,direction:t}))))&&void 0!==e?e:[]}}),[Y,O]),J=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.reduce(((e,t)=>{var n;return{...e,[t.id]:null!==(n=t.displayAsText)&&void 0!==n?n:t.id}}),{}))&&void 0!==e?e:{}}),[n]),Z=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.map((({aggregatable:e,displayAsText:t,id:n,type:a})=>({id:n,isSortable:e,displayAsText:t,schema:a}))))&&void 0!==e?e:[]}),[n]),X=Object(a.useCallback)((()=>{A(m.a.updateColumns({id:w,columns:N}))}),[N,A,w]),ee=Object(a.useCallback)((e=>{n.some((({id:t})=>t===e))?A(m.a.removeColumn({columnId:e,id:w})):A(m.a.upsertColumn({column:Object(p.a)(e,N),id:w,index:1}))}),[n,A,w,N]),te=Object(r.useDataGridColumnSorting)({columns:Z,sorting:K,schema:U,schemaDetectors:G,displayValues:J});return i.a.createElement(V,{"data-test-subj":"header-actions-container"},j&&i.a.createElement(y.o,{role:"checkbox"},i.a.createElement(y.p,{textAlign:"center",width:b.b},i.a.createElement(r.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:l,onChange:Q}))),T&&i.a.createElement(y.o,{role:"button"},i.a.createElement($,null,I.getFieldBrowser({browserFields:t,columnIds:n.map((({id:e})=>e)),onResetColumns:X,onToggleColumn:ee,options:T}))),F&&i.a.createElement(y.o,{role:"button"},i.a.createElement(h.a,{timelineId:w})),S&&i.a.createElement(y.o,{role:"button"},i.a.createElement(y.p,{textAlign:"center",width:b.b},i.a.createElement(r.EuiToolTip,{content:W?v.a:R.d},i.a.createElement(r.EuiButtonIcon,{"aria-label":Object(u.b)({globalFullScreen:M,isActiveTimelines:Object(d.isActiveTimeline)(w),timelineFullScreen:_})?v.a:R.d,display:W?"fill":"empty",color:"primary","data-test-subj":Object(d.isActiveTimeline)(w)?"full-screen-active":"full-screen",iconType:"fullScreen",onClick:H})))),k!==c.g.eql&&F&&i.a.createElement(y.o,{role:"button","data-test-subj":"timeline-sorting-fields"},i.a.createElement(y.p,{textAlign:"center",width:b.b},i.a.createElement(r.EuiToolTip,{content:R.l},i.a.createElement(B,null,te)))),x&&i.a.createElement(y.o,{role:"button"},i.a.createElement(y.p,{textAlign:"center",width:b.b},i.a.createElement(P,{checkState:"unchecked",timelineId:w}))))}));H.displayName="HeaderActionsComponent";const W=i.a.memo(H)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return E}));var a=n(2),i=n.n(a),r=n(4);const o=r.i18n.translate("xpack.securitySolution.expandedValue.links.viewHostSummary",{defaultMessage:"View host summary"}),s=r.i18n.translate("xpack.securitySolution.expandedValue.links.viewUserSummary",{defaultMessage:"View user summary"}),l=r.i18n.translate("xpack.securitySolution.expandedValue.links.expandIpDetails",{defaultMessage:"Expand ip details"}),c=r.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleDetails",{defaultMessage:"View rule details"}),u=r.i18n.translate("xpack.securitySolution.expandedValue.links.viewPortDetails",{defaultMessage:"View port details"}),d=r.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleReference",{defaultMessage:"View rule reference"}),p=r.i18n.translate("xpack.securitySolution.expandedValue.links.viewEventReference",{defaultMessage:"View event reference"}),m=r.i18n.translate("xpack.securitySolution.expandedValue.links.viewIndicatorReference",{defaultMessage:"View indicator reference"});var f=n(229),g=n(195),b=n(406),y=n(382);n(118);const h=[{columnId:f.g,label:o},{columnId:"source.ip",fieldType:b.b,label:l},{columnId:"destination.ip",fieldType:b.b,label:l},{columnId:"signal.rule.name",label:c,linkField:"signal.rule.id"},...y.b.map((e=>({columnId:e,label:u}))),{columnId:f.m,label:d},{columnId:f.l,label:d},{columnId:f.e,label:p},{columnId:g.j,label:m},{columnId:f.p,label:s}],v=(e,t,n)=>h.find((a=>a.columnId===e||!(!a.fieldType||t!==a.fieldType||void 0===n&&void 0===a.linkField))),E=()=>i.a.createElement(i.a.Fragment,null)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(765);function i(e,t){var n;const i=t?t(e):function(e){var t;return e.timeSeriesMetric||(null!==(t=e.type)&&void 0!==t?t:"string")}(e),r=(null===(n=e.esTypes)||void 0===n?void 0:n[0])||null;return r&&["_id","_index","_ignored"].includes(r)&&"string"===i?"keyword":"unknown"===i&&r&&Object(a.c)(r)||"string"===i&&r?r:i}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return E}));var a=n(72),i=n(19),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(118);const u="100%",d=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:u};\n  `));d.displayName="WrappedByAutoSizer";const p=o.a.memo(d),m={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},f=()=>({baseTheme:Object(c.g)()?a.LEGACY_DARK_THEME:a.LEGACY_LIGHT_THEME,theme:m}),g={rotation:0,rendering:"canvas",showLegend:!1,legendValues:[],debug:!1,legendPosition:a.Position.Bottom},b=(e,t)=>{const n=e||t;return n?`${n}px`:u},y=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},h=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),v=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),E=(l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"]))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,i=function(e,t,n){var i=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){i(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",s=t;do{var l=e.insert(t===s?"."+r:"",s,e.sheet,!0);a||void 0===l||(o+=l),s=s.next}while(void 0!==s);if(!a&&0!==o.length)return o}},t.registerStyles=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(712),i=n(714),r=n(515);function o(e){return e&&e.__esModule?e:{default:e}}var s=o(a),l=o(i),c=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},m=o(r).default((function(e){return d(e)?e:e.replace(c,"-$&").toLowerCase()})),f=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,n){return b={name:t,styles:n,next:b},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function g(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return b={name:n.name,styles:n.styles,next:b},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)b={name:a.name,styles:a.styles,next:b},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var i=0;i<n.length;i++)a+=g(e,t,n[i])+";";else for(var r in n){var o=n[r];if("object"!=typeof o)null!=t&&void 0!==t[o]?a+=r+"{"+t[o]+"}":p(o)&&(a+=m(r)+":"+f(r,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=g(e,t,o);switch(r){case"animation":case"animationName":a+=m(r)+":"+s+";";break;default:a+=r+"{"+s+"}"}}else for(var l=0;l<o.length;l++)p(o[l])&&(a+=m(r)+":"+f(r,o[l])+";")}return a}(e,t,n);case"function":if(void 0!==e){var i=b,r=n(e);return b=i,g(e,t,r)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var b,y=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,i="";b=void 0;var r=e[0];null==r||void 0===r.raw?(a=!1,i+=g(n,t,r)):i+=r[0];for(var o=1;o<e.length;o++)i+=g(n,t,e[o]),a&&(i+=r[o]);y.lastIndex=0;for(var l,c="";null!==(l=y.exec(i));)c+="-"+l[1];return{name:s.default(i)+c,styles:i,next:b}}},function(e,t,n){"use strict";e.exports=n(713)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,i=e.length;i>=4;++a,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(715)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return T}));var a=n(188),i=n.n(a),r=n(44),o=n(2),s=n(45),l=n(3),c=n(55),u=n(1484),d=n(118),p=n(376),m=n(129),f=n(978),g=n(131),b=n(137),y=n(146),h=n(246),v=n(980),E=n(763),x=n(5),j=n(764);const S="timelineEventsQuery",O=[{field:"@timestamp",direction:b.b.asc,type:"date",esTypes:["date"]}],k=e=>({...Object(r.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(r.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(r.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(r.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),w=({dataViewId:e,endDate:t,eqlOptions:n,id:a=S,indexNames:j,fields:w,filterQuery:T,runtimeMappings:I,startDate:M,language:C="kuery",limit:_,sort:D=O,skip:A=!1,timerangeKind:F})=>{const[{pageName:N}]=Object(h.a)(),P=Object(s.useDispatch)(),{data:R}=Object(d.j)().services,L=Object(o.useRef)(r.noop),z=Object(o.useRef)(new AbortController),q=Object(o.useRef)(new l.Subscription),[B,$]=Object(o.useState)(u.a.loaded),[V,U]=Object(o.useState)(a===y.c.active?v.a.getActivePage():0),[G,H]=Object(o.useState)(null),W=Object(o.useRef)(null),{startTracking:Q}=Object(E.a)(),Y=Object(o.useCallback)((()=>{null!=a&&f.a.some((e=>e===a))&&(P(m.a.clearEventsLoading({id:a})),P(m.a.clearEventsDeleted({id:a})))}),[P,a]),K=Object(o.useCallback)((e=>{Y(),a===y.c.active&&v.a.setActivePage(e),U(e)}),[Y,a]),J=Object(o.useCallback)((()=>{null!=L.current&&L.current(),K(0)}),[K]),[Z,X]=Object(o.useState)({id:a,inspect:{dsl:[],response:[]},refetch:J,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0}),ee=Object(o.useCallback)((async(t,n)=>{if(null==t||""===N||A)return;const i=async()=>{W.current=t,z.current=new AbortController,$(0===V?u.a.loading:u.a.loadingMore);const{endTracking:i}=Q({name:`${x.m} timeline events search`});q.current=R.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:z.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(c.isRunningResponse)(e)||(i("success"),$(u.a.loaded),X((i=>{const r={...i,events:(o=e.edges,o.map((e=>e.node))),inspect:Object(g.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var o;return a===y.c.active&&(v.a.setPageName(N),"eql"===t.language?(v.a.setEqlRequest(t),v.a.setEqlResponse(r)):(v.a.setRequest(t),v.a.setResponse(r))),n&&n(r),r})),q.current.unsubscribe())},error:e=>{i(z.current.signal.aborted?"aborted":"error"),$(u.a.loaded),R.search.showError(e),q.current.unsubscribe()}})};if(a===y.c.active&&""!==v.a.getPageName()&&N!==v.a.getPageName()){if(v.a.setPageName(N),z.current.abort(),$(u.a.loaded),"eql"===t.language?(W.current=v.a.getEqlRequest(),L.current=i.bind(null,v.a.getEqlRequest())):(W.current=v.a.getRequest(),L.current=i.bind(null,v.a.getRequest())),X((e=>{const n="eql"===t.language?v.a.getEqlResponse():v.a.getResponse();return null!=n?{...n,refetch:J,loadPage:K}:e})),"eql"!==t.language&&null!=v.a.getResponse())return;if("eql"===t.language&&null!=v.a.getEqlResponse())return}q.current.unsubscribe(),z.current.abort(),await i(),L.current=i}),[N,A,a,V,Q,R.search,e,J,K]);Object(o.useEffect)((()=>{0!==j.length&&H((e=>{var r,o,s,l,c,u,d;const m=e,f={defaultIndex:null!==(r=null==e?void 0:e.defaultIndex)&&void 0!==r?r:[],filterQuery:null!==(o=null==e?void 0:e.filterQuery)&&void 0!==o?o:"",querySize:null!==(s=null==e||null===(l=e.pagination)||void 0===l?void 0:l.querySize)&&void 0!==s?s:0,sort:null!==(c=null==e?void 0:e.sort)&&void 0!==c?c:O,timerange:null!==(u=null==e?void 0:e.timerange)&&void 0!==u?u:{},runtimeMappings:null!==(d=null==e?void 0:e.runtimeMappings)&&void 0!==d?d:{},...k(m)},g=M&&t?{timerange:{interval:"12h",from:M,to:t}}:{},h={defaultIndex:j,filterQuery:Object(p.a)(T),querySize:_,sort:D,runtimeMappings:I,...g,...k(n)},E=i()(f,h)?V:0;let x=w;const S=w.filter((t=>{var n;return!(null!=e&&null!==(n=e.fieldRequested)&&void 0!==n&&n.includes(t))}));var A,F;x=S.length>0?[...null!==(A=null==e?void 0:e.fieldRequested)&&void 0!==A?A:[],...S]:null!==(F=null==e?void 0:e.fieldRequested)&&void 0!==F?F:[];const N={defaultIndex:j,factoryQueryType:b.w.all,fieldRequested:x,fields:x,filterQuery:Object(p.a)(T),pagination:{activePage:E,querySize:_},language:C,runtimeMappings:I,sort:D,...g,...n||{}};return V!==E&&(U(E),a===y.c.active&&v.a.setActivePage(E)),i()(e,N)?e:N}))}),[P,j,V,t,n,T,a,C,_,M,D,w,I]);const te=Object(o.useCallback)((async e=>{a===y.c.active&&"absolute"!==F&&i()(W.current,G)||await ee(G,e)}),[a,G,ee,F]);return Object(o.useEffect)((()=>{Object(r.isEmpty)(T)&&X({id:a,inspect:{dsl:[],response:[]},refetch:J,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0})}),[T,a,J,K]),[B,Z,te]},T=({dataViewId:e,endDate:t,eqlOptions:n,id:a=S,indexNames:i,fields:r,filterQuery:s,runtimeMappings:l,startDate:c,language:u="kuery",limit:d,sort:p=O,skip:m=!1,timerangeKind:f,fetchNotes:g=!0})=>{const[b,y,h]=w({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:i,fields:r,filterQuery:s,runtimeMappings:l,startDate:c,language:u,limit:d,sort:p,skip:m,timerangeKind:f}),{onLoad:v}=Object(j.a)(),E=Object(o.useCallback)((e=>{g&&v(e.events)}),[g,v]);return Object(o.useEffect)((()=>{h&&h(E)}),[h,E]),[b,y]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f}));var a=n(44),i=n(53),r=n(121),o=n(179);const s=["host.name","host.hostname","host.domain","host.id","host.ip","client.ip","destination.ip","server.ip","source.ip","network.community_id","user.name","process.name"],l=(e,t,n=console)=>{var a,i;const r=null!==(a=null===(i=t.find((t=>t.field===e)))||void 0===i?void 0:i.values)&&void 0!==a?a:null;return null==r?[]:"string"==typeof r?[r]:Array.isArray(r)&&r.every((e=>"string"==typeof e))?r:(n.trace("Data type that is not a string or string array detected:",r,"when trying to access field:",e,"from data object of:",t),[])},c=(e,t=[])=>{let n=t;return"is"===e.function&&s.includes(e.arguments[0].value)&&(n=[...n,{field:e.arguments[0].value,valueToChange:e.arguments[1].value}]),e.arguments.reduce(((e,t)=>"is"===t.function&&s.includes(t.arguments[0].value)?[...e,{field:t.arguments[0].value,valueToChange:t.arguments[1].value}]:t.arguments?c(t,e):e),n)},u=(e,t,n=r.m.default)=>n===r.m.default?""!==e.trim()?c(Object(i.fromKueryExpression)(e)).reduce(((e,n)=>{const a=l(n.field,t);return a.length?e.replace(n.valueToChange,a[0]):e}),e):"":e.trim(),d=(e,t)=>e.map((e=>{if("phrase"===e.meta.type&&null!=e.meta.key&&s.includes(e.meta.key)){const n=l(e.meta.key,t);n.length&&(e.meta.params={query:n[0]},e.query={match_phrase:{[e.meta.key]:n[0]}})}return e})),p=(e,t,n=r.m.default)=>{if(n!==r.m.template){if(s.includes(e.queryMatch.field)){const n=l(e.queryMatch.field,t);n.length&&(e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0)}return e.type=o.a.default,e}if(n===r.m.template){var a;if(e.type===o.a.template&&":"===e.queryMatch.operator){const n=l(e.queryMatch.field,t);return n.length||(e.enabled=!1),e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0,e.type=o.a.default,e}return e.type=null!==(a=e.type)&&void 0!==a?a:o.a.default,e}return e},m=(e,t,n=r.m.default)=>e.map((e=>{const i=p(e,t,n);return null==i.and||Object(a.isEmpty)(i.and)||(i.and=i.and.map((e=>p(e,t,n)))),i})),f=(e,t)=>[{range:{"@timestamp":{gte:e,lte:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lte:t,format:"strict_date_optional_time"}},$state:{store:i.FilterStateStore.APP_STATE}}]},function(e,t,n){"use strict";var a=Array.isArray,i=Object.keys,r=Object.prototype.hasOwnProperty,o="undefined"!=typeof Element;function s(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,l,c,u=a(e),d=a(t);if(u&&d){if((l=e.length)!=t.length)return!1;for(n=l;0!=n--;)if(!s(e[n],t[n]))return!1;return!0}if(u!=d)return!1;var p=e instanceof Date,m=t instanceof Date;if(p!=m)return!1;if(p&&m)return e.getTime()==t.getTime();var f=e instanceof RegExp,g=t instanceof RegExp;if(f!=g)return!1;if(f&&g)return e.toString()==t.toString();var b=i(e);if((l=b.length)!==i(t).length)return!1;for(n=l;0!=n--;)if(!r.call(t,b[n]))return!1;if(o&&e instanceof Element&&t instanceof Element)return e===t;for(n=l;0!=n--;)if(!("_owner"===(c=b[n])&&e.$$typeof||s(e[c],t[c])))return!1;return!0}return e!=e&&t!=t}e.exports=function(e,t){try{return s(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),r=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(723);n(71),n(324),n(323);var i=a.default({key:"css"}),r=i.flush,o=i.hydrate,s=i.cx,l=i.merge,c=i.getRegisteredStyles,u=i.injectGlobal,d=i.keyframes,p=i.css,m=i.sheet,f=i.cache;t.cache=f,t.css=p,t.cx=s,t.flush=r,t.getRegisteredStyles=c,t.hydrate=o,t.injectGlobal=u,t.keyframes=d,t.merge=l,t.sheet=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(71),i=n(324),r=n(323);function o(e){return e&&e.__esModule?e:{default:e}}var s=o(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function c(e,t,n){var a=[],i=r.getRegisteredStyles(e,a,n);return a.length<2?n:i+t(a)}var u=function e(t){for(var n="",a=0;a<t.length;a++){var i=t[a];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var o in r="",i)i[o]&&o&&(r&&(r+=" "),r+=o);break;default:r=i}r&&(n&&(n+=" "),n+=r)}}return n};t.default=function(e){var t=s.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var o=i.serializeStyles(n,t.registered,void 0);return r.insertStyles(t,o,!1),t.key+"-"+o.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return c(t.registered,n,u(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered);l(t,r)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered),o="animation-"+r.name;return l(t,{name:r.name,styles:"@keyframes "+o+"{"+r.styles+"}"}),o},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:c.bind(null,t.registered,n)}}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(54),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(244),c=n(195);const u=({range:e,setRange:t,loading:n})=>{const[a,u]=Object(r.useState)(e.from===c.a?i()().subtract(30,"d"):i()(e.from)),[d,p]=Object(r.useState)(e.to===c.b?i()():i()(e.to)),m=Object(r.useCallback)((()=>{a&&d&&a.isBefore(d)&&t({from:a.toISOString(),to:d.toISOString()})}),[d,t,a]),f=Object(r.useMemo)((()=>null==a?void 0:a.isBefore(d)),[a,d]);return o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiDatePickerRange,{"data-test-subj":"enrichment-query-range-picker",startDateControl:o.a.createElement(s.EuiDatePicker,{className:"start-picker",selected:a,onChange:u,startDate:a,endDate:d,isInvalid:!f,"aria-label":l.d,showTimeSelect:!0}),endDateControl:o.a.createElement(s.EuiDatePicker,{className:"end-picker",selected:d,onChange:p,startDate:a,endDate:d,isInvalid:!f,"aria-label":l.c,showTimeSelect:!0})})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButton,{iconType:"refresh",onClick:m,isLoading:n,"data-test-subj":"enrichment-button",isDisabled:!f},l.n)))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(262),c=n(122),u=n(118),d=n(695),p=n(197),m=n(247);const f=s.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-woclj6-0"})(["height:100%;position:relative;"]),g=({rawEventData:e,ecsData:t})=>{var n,i,o,s,g,b,y,h,v;const{services:{osquery:E}}=Object(u.j)(),x=Object(c.a)("responseActionsEnabled"),j=Object(c.a)("endpointResponseActionsEnabled"),S=e?Object(l.a)(e.fields):void 0,O=null==S||null===(n=S.kibana)||void 0===n||null===(i=n.alert)||void 0===i||null===(o=i.rule)||void 0===o||null===(s=o.parameters)||void 0===s?void 0:s[0].response_actions,k=!e||!x||j||!t||!(null!=O&&O.length),w=null!==(g=null==e?void 0:e._id)&&void 0!==g?g:"",{OsqueryResults:T,fetchAllLiveQueries:I}=E,{data:M}=I({kuery:`alert_ids: ( ${w} )`,alertId:w,skip:k});if(k)return;const C=O.filter((e=>e.action_type_id===m.b[".osquery"]));if(null==C||!C.length)return;const _=(null==M?void 0:M.data.items)||[],D=null==S||null===(b=S.kibana)||void 0===b||null===(y=b.alert)||void 0===y||null===(h=y.rule)||void 0===h||null===(v=h.name)||void 0===v?void 0:v[0],A=r.a.createElement(f,{"data-test-subj":"osqueryViewWrapper"},r.a.createElement(T,{ruleName:D,actionItems:_,ecsData:t}),r.a.createElement(a.EuiSpacer,{size:"s"}));return{id:d.b.osqueryView,"data-test-subj":"osqueryViewTab",name:p.u,append:r.a.createElement(a.EuiNotificationBadge,{"data-test-subj":"osquery-actions-notification"},_.length),content:A}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(838),o=n(172),s=n(377);const l=({ariaLabel:e=o.j,ecsRowData:t,buttonType:n,onInvestigateInTimelineAlertClick:a})=>{const{investigateInTimelineAlertClick:l}=Object(s.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:a});return i.a.createElement(r.a,{ariaLabel:e,content:o.i,dataTestSubj:"send-alert-to-timeline",iconType:"timeline",onClick:l,isDisabled:!1,buttonType:n})},c=i.a.memo(l)},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return l}));var a=n(247);const i=({group:e,id:t,action_type_id:n,params:a,uuid:i,frequency:r,alerts_filter:o})=>({group:e,id:t,params:a,actionTypeId:n,...o&&{alertsFilter:o},...i&&{uuid:i},...r&&{frequency:r}}),r=({group:e,id:t,actionTypeId:n,params:a,uuid:i,frequency:r,alertsFilter:o})=>({group:e,id:t,params:a,action_type_id:n,...o&&{alerts_filter:o},...i&&{uuid:i},...r&&{frequency:r}}),o=({group:e,id:t,params:n,frequency:a,alertsFilter:i})=>({group:e,id:t,params:n,...i&&{alerts_filter:i},...a&&{frequency:a}}),s=({action_type_id:e,params:t})=>{if(e===a.b[".osquery"]){const{saved_query_id:n,ecs_mapping:a,pack_id:i,...r}=t;return{params:{...r,savedQueryId:n,ecsMapping:a,packId:i},actionTypeId:e}}return{params:t,actionTypeId:e}},l=({actionTypeId:e,params:t})=>{if(e===a.b[".osquery"]){const{savedQueryId:n,ecsMapping:a,packId:i,...r}=t;return{params:{...r,saved_query_id:n,ecs_mapping:a,pack_id:i},action_type_id:e}}return{params:t,action_type_id:e}}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return g}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),s=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addCustomHighlightedFieldDescription",{defaultMessage:"Add a custom highlighted field"}),a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"})),l=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.setupHelpText",{defaultMessage:"Add rule setup guide..."})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(4);a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"}),a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"});const i=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"}),r=(a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExceptionsTab",{defaultMessage:"Rule exceptions"})),o=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.endpointExceptionsTab",{defaultMessage:"Endpoint exceptions"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionResultsTab",{defaultMessage:"Execution results"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionEventsTab",{defaultMessage:"Execution events"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deleteRuleConfirmationBody",{defaultMessage:'This action will delete the rule. Click "Delete" to continue.'})},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(42),l=n(19),c=n(41),u=n.n(c),d=n(482);const p=u()(l.EuiButtonEmpty).withConfig({displayName:"EuiButtonEmptyStyled",componentId:"sc-1h0vyjj-0"})(["margin-bottom:",";.euiIcon{width:",";height:",";}.text{font-size:",";margin-inline-start:",";}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),m=Object(r.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:n,...a})=>{const r=Object(d.a)(...n);return o.a.createElement(p,i()({"data-test-subj":"backToOrigin"},a,{flush:"left",size:"xs",iconType:"arrowLeft",href:t,onClick:r,textProps:{className:"text"}}),e||o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));m.displayName="BackToExternalAppButton"},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"q",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"l",(function(){return E})),n.d(t,"h",(function(){return x}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"}),r=a.i18n.translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"}),o=a.i18n.translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"}),s=a.i18n.translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),l=a.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),c=a.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskLevel",{defaultMessage:"Host risk level"}),u=a.i18n.translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),d=a.i18n.translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"}),p=a.i18n.translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"}),m=a.i18n.translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"}),f=a.i18n.translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"}),g=a.i18n.translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"}),b=a.i18n.translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"}),y=a.i18n.translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"}),h=a.i18n.translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"}),v=a.i18n.translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"}),E=a.i18n.translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"}),x=a.i18n.translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"})},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"j",(function(){return f}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.user.details.overview.userIdTitle",{defaultMessage:"User ID"}),r=a.i18n.translate("xpack.securitySolution.user.details.overview.userDomainTitle",{defaultMessage:"Domain"}),o=a.i18n.translate("xpack.securitySolution.user.details.overview.familyTitle",{defaultMessage:"Family"}),s=a.i18n.translate("xpack.securitySolution.user.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),l=a.i18n.translate("xpack.securitySolution.user.details.overview.osTitle",{defaultMessage:"Operating system"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),u=a.i18n.translate("xpack.securitySolution.user.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),d=a.i18n.translate("xpack.securitySolution.user.details.overview.inspectTitle",{defaultMessage:"User overview"}),p=a.i18n.translate("xpack.securitySolution.user.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),m=a.i18n.translate("xpack.securitySolution.user.details.overview.userRiskScoreTitle",{defaultMessage:"User risk score"}),f=a.i18n.translate("xpack.securitySolution.user.details.overview.userRiskLevel",{defaultMessage:"User risk level"})},function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"b",(function(){return b}));var a=n(50),i=n(4),r=n(1342),o=n(2137);const s=(e,t,n)=>n.reduce(((n,i,r)=>{const o=((e,t,n,i,r=a.v4)=>{var o;const{fields:s}=e,{fields:l}=t,c=n.field,u=n.value,[d]=s.filter((({name:e})=>null!=c&&c===e)),[p]=l.filter((({name:e})=>null!=u&&u===e));return{id:null!==(o=n.id)&&void 0!==o?o:r(),field:d,type:"mapping",value:p,entryIndex:i}})(e,t,i,r);return[...n,o]}),[]),l=(e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}),c=(e,t)=>{const{entryIndex:n}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:n}},u=(e,t)=>{const{entryIndex:n}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:n}},d=()=>Object(r.a)({field:"",type:"mapping",value:""}),p=()=>Object(r.a)({entries:[Object(r.a)({field:"",type:"mapping",value:""})]}),m=e=>e.reduce(((e,t)=>{const n={...t,entries:t.entries};return o.c.is(n)?[...e,n]:e}),[]),f=e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))),g=e=>1===e.length&&1===e[0].entries.length&&""===e[0].entries[0].field&&""===e[0].entries[0].value,b={forbiddenField:(e,t)=>{let n;if(n="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),n)return{code:"ERR_FIELD_FORMAT",message:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j}));var a=n(2),i=n.n(a),r=n(5),o=n(204),s=n(1532),l=n(1533);const c=Object(s.a)(o.w);var u=n(123),d=n(118),p=n(4);const m=p.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),f=p.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.detectionEnginePrivileges.errorFetching",{defaultMessage:"Failed to retrieve detection engine privileges"});var g=n(370);var b=n(7),y=n(1213),h=n(16),v=n(743),E=n(1214);const x=Object(a.createContext)({listPrivileges:{loading:!1,error:void 0,result:void 0},detectionEnginePrivileges:{loading:!1,error:void 0,result:void 0},endpointPrivileges:{loading:!0,...Object(v.b)()},kibanaSecuritySolutionsPrivileges:{crud:!1,read:!1}}),j=({kibanaCapabilities:e,children:t})=>{const n=!0===e[r.Lc].crud,o=!0===e[r.Lc].show,[p,j]=Object(a.useState)({crud:n,read:o}),S=((e=!0)=>{const t=Object(d.i)(),{lists:n}=Object(d.j)().services,{start:i,...r}=Object(l.a)(c),{addError:o}=Object(u.a)(),s=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>{const{loading:a,result:o,error:l}=r;!e||!n||a||o||l||(s.current.abort(),s.current=new AbortController,i({http:t,signal:s.current.signal}))}),[t,n,i,r,e]),Object(a.useEffect)((()=>()=>{s.current.abort()}),[]),Object(a.useEffect)((()=>{const e=r.error;null!=e&&o(e,{title:m})}),[o,r.error]),{loading:r.loading,error:r.error,result:r.result}})(o),O=((e=!0)=>{const{start:t,...n}=Object(l.a)(Object(s.a)(g.h)),{addError:i}=Object(u.a)(),r=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>{const{loading:a,result:i,error:o}=n;!e||a||i||o||(r.current.abort(),r.current=new AbortController,t({signal:r.current.signal}))}),[t,n,e]),Object(a.useEffect)((()=>()=>{r.current.abort()}),[]),Object(a.useEffect)((()=>{const e=n.error;null!=e&&i(e,{title:f})}),[i,n.error]),n})(o),k=(()=>{var e,t;const n=Object(y.a)(),i=Object(d.f)(),r=Object(d.j)().services.fleet,o=null===(e=Object(E.b)())||void 0===e?void 0:e.fleet,s=null!==(t=null==r?void 0:r.authz)&&void 0!==t?t:null==o?void 0:o.authz,l=Object(h.b)(),[c,u]=Object(a.useState)(!1),[p,m]=Object(a.useState)([]),f=Object(a.useMemo)((()=>{const e=!c||!i;return Object.freeze({loading:e,...e||!s||Object(b.isEmpty)(i)?Object(v.b)():Object(v.a)(l,s,p)})}),[c,i,s,l,p]);return Object(a.useEffect)((()=>{(async()=>{i&&n()&&(m(null==i?void 0:i.roles),u(!0))})()}),[n,i]),f})();return Object(a.useEffect)((()=>{j((e=>e.read!==o||e.crud!==n?{read:o,crud:n}:e))}),[n,o]),i.a.createElement(x.Provider,{value:{listPrivileges:S,detectionEnginePrivileges:O,endpointPrivileges:k,kibanaSecuritySolutionsPrivileges:p}},t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19),l=n(42),c=n(153),u=n(140),d=n(47),p=n(3),m=n(7),f=n(167),g=n(262);let b=function(e){return e.asc="asc",e.desc="desc",e}({}),y=function(e){return e.actions="responseActions",e.results="responseActionsResults",e}({});var h=n(118);var v=n(1100),E=n(197),x=n(771);const j=({type:e})=>{const t=Object(a.useMemo)((()=>{if("endpoint"===e)return{icon:"logoSecurity",name:"Elastic Defend"}}),[e]);return i.a.createElement(s.EuiEmptyPrompt,{iconType:t.icon,title:i.a.createElement("h2",null,x.b),titleSize:"xs",body:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.responseActions.results.missingPrivileges",defaultMessage:"To access these results, ask your administrator for {integration} Kibana privileges.",values:{integration:i.a.createElement(s.EuiCode,null,t.name)}})})},S=({action:e,ruleName:t})=>{const{agent:n}=e,{action_id:r,expiration:o}=e.EndpointActions,{endpointPrivileges:{canAccessEndpointActionsLogManagement:c}}=Object(u.a)(),[m,g]=Object(a.useState)(!0),{data:E}=((e,{enabled:t,action:n,isLive:a=!1})=>{const{data:i}=Object(h.j)().services,{expiration:r,actionId:o,agent:s}=e;return Object(d.useQuery)({queryKey:["allResponsesResults",{actionId:o}],queryFn:async()=>{var e,t,n;const a=await Object(p.lastValueFrom)(i.search.search({actionId:o,expiration:r,sort:{order:b.desc,field:"@timestamp"},agents:(Array.isArray(s.id)?s.id:[s.id]).length,factoryQueryType:y.results},{strategy:f.n}));return{action_id:o,completedAt:null===(e=a.edges[0])||void 0===e||null===(t=e.fields)||void 0===t||null===(n=t["EndpointActions.completed_at"])||void 0===n?void 0:n[0],isExpired:a.isExpired,wasSuccessful:a.wasSuccessful,isCompleted:a.isCompleted,status:a.status}},select:e=>((e,t)=>{var n;const{rule:a}=e,{parameters:i,alert_id:r,comment:o,command:s,hosts:l}=e.EndpointActions.data;return{id:e.EndpointActions.action_id,agents:Array.isArray(e.agent.id)?e.agent.id:[e.agent.id],agentType:"endpoint",parameters:i,...null!=r&&r.length?{alertIds:r}:{},...a?{ruleId:a.id,ruleName:a.name}:{},createdBy:(null===(n=e.rule)||void 0===n?void 0:n.name)||"unknown",comment:o,command:s,hosts:l,startedAt:e["@timestamp"],completedAt:null==t?void 0:t.completedAt,isCompleted:!(null==t||!t.isCompleted),isExpired:!(null==t||!t.isExpired),wasSuccessful:"successful"===t.status,status:t.status,agentState:{},errors:e.error?[e.error.message]:void 0}})(n,e),keepPreviousData:!0,enabled:t,refetchInterval:!!a&&5e3})})({actionId:r,expiration:o,agent:n},{enabled:c,action:e,isLive:m});Object(a.useEffect)((()=>{g((()=>{var e;return!E||!(null!==(e=E.errors)&&void 0!==e&&e.length)&&"pending"===E.status}))}),[E]);const x=E?O(E):"",S=Object(a.useMemo)((()=>null!=E&&E.hosts?Object.values(E.hosts)[0].name:""),[null==E?void 0:E.hosts]);return i.a.createElement(s.EuiComment,{username:t,timestamp:i.a.createElement(l.FormattedRelative,{value:e["@timestamp"]}),event:x,"data-test-subj":"endpoint-results-comment"},c?E?i.a.createElement(v.a,{action:E,fromAlertWorkaround:!0,"data-test-subj":`response-results-${S}`}):i.a.createElement(s.EuiLoadingSpinner,null):i.a.createElement(j,{type:"endpoint"}))},O=e=>{var t;return null!==(t=e.errors)&&void 0!==t&&t.length?E.g.failed(e.command):"pending"===e.status?E.g.pending(e.command):"successful"===e.status?E.g.executed(e.command):E.g.tried(e.command)},k=i.a.memo((({actions:e,ruleName:t,ecsData:n})=>{const{services:{osquery:r}}=Object(h.j)(),{OsqueryResult:o}=r,l=Object(a.useCallback)((e=>{if(w(e)){const a=e.action_id,r=e["@timestamp"];return i.a.createElement(o,{key:a,actionId:a,startDate:r,ruleName:t,ecsData:n})}return T(e)?i.a.createElement(S,{action:e,ruleName:t,key:e.EndpointActions.action_id}):null}),[o,n,t]);return i.a.createElement(i.a.Fragment,null,e.map((e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"s"}),l(e),i.a.createElement(s.EuiSpacer,{size:"s"})))))}));k.displayName="ResponseActionsResults";const w=e=>!(!e||!("input_type"in e)||"osquery"!==(null==e?void 0:e.input_type)),T=e=>{var t;return!(!e||!("EndpointActions"in e)||"endpoint"!==(null==e||null===(t=e.EndpointActions)||void 0===t?void 0:t.input_type))};var I=n(695),M=n(122);const C=o.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-1y7ogme-0"})(["height:100%;position:relative;"]),_=o.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-1y7ogme-1"})(["display:inline-block;line-height:1.7em;"]),D=()=>i.a.createElement(_,{"data-test-subj":c.K},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataDescription",defaultMessage:"There are no response actions defined for this event. To add some, edit the rule's settings and set up {link}.",values:{link:i.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-create.html#rule-response-action",target:"_blank"},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataLinkText",defaultMessage:"response actions"}))}})),A=({rawEventData:e,ecsData:t})=>{var n,r,o,l,c;const u=Object(a.useMemo)((()=>({id:I.b.responseActionsView,"data-test-subj":"responseActionsViewTab",name:E.y})),[]),v=Object(M.a)("endpointResponseActionsEnabled"),x=e?Object(g.a)(e.fields):void 0,j=null==x||null===(n=x.kibana)||void 0===n||null===(r=n.alert)||void 0===r||null===(o=r.rule)||void 0===o||null===(l=o.parameters)||void 0===l?void 0:l[0].response_actions,S=!e||!v,O=null!==(c=null==e?void 0:e._id)&&void 0!==c?c:"",[w,T]=Object(a.useState)(!1),{data:_,isFetched:A}=((e,{enabled:t,isLive:n})=>{const{data:a}=Object(h.j)().services,{alertIds:i}=e;return Object(d.useQuery)({queryKey:["actions",{alertId:i[0]}],queryFn:async()=>{const e=await Object(p.lastValueFrom)(a.search.search({alertIds:i,sort:{order:b.desc,field:"@timestamp"},factoryQueryType:y.actions},{strategy:f.n})),t=Object(m.map)(Object(m.filter)(e.edges,"fields"),(e=>Object(g.a)(e.fields,!0)));return{...e,items:Object(m.compact)(t)}},enabled:t,refetchInterval:!!n&&5e3,keepPreviousData:!0})})({alertIds:[O]},{enabled:!S,isLive:w});if(Object(a.useEffect)((()=>{T((()=>{var e;return!(null==j||!j.length||null!=_&&null!==(e=_.items)&&void 0!==e&&e.length)}))}),[_,null==j?void 0:j.length]),S)return{...u,content:i.a.createElement(D,null)};{var F,N,P,R,L;const e=null==x||null===(F=x.kibana)||void 0===F||null===(N=F.alert)||void 0===N||null===(P=N.rule)||void 0===P||null===(R=P.name)||void 0===R?void 0:R[0],n=null!==(L=null==_?void 0:_.items)&&void 0!==L?L:[];return{...u,append:i.a.createElement(s.EuiNotificationBadge,{"data-test-subj":"response-actions-notification"},n.length),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(C,{"data-test-subj":"responseActionsViewWrapper"},A&&n.length?i.a.createElement(k,{actions:n,ruleName:e,ecsData:t}):i.a.createElement(D,null)))}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var a=n(19),i=n(2),r=n.n(i),o=n(7),s=n(195),l=n(244),c=n(336);const u=e=>Object(c.f)(e)?l.j:l.g,d=({type:e})=>r.a.createElement(a.EuiToolTip,{content:u(e)},r.a.createElement(a.EuiIcon,{type:"iInCircle",size:"m"}));var p=n(41),m=n.n(p);const f=m.a.div.withConfig({displayName:"OverflowParent",componentId:"sc-sjnml3-0"})(["display:inline-grid;"]),g=m.a.div.withConfig({displayName:"OverflowContainer",componentId:"sc-sjnml3-1"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold;"]),b=({field:e="",feedName:t="",value:n=""})=>{const i=`${e} ${n}${t?` ${l.e} ${t}`:""}`;return r.a.createElement(a.EuiToolTip,{content:n},r.a.createElement(f,{"data-test-subj":"enrichment-button-content"},r.a.createElement(g,null,i)))},y=m.a.h5.withConfig({displayName:"StyledH5",componentId:"sc-1i38kio-0"})(["line-height:1.7rem;"]),h=e=>r.a.createElement(a.EuiTitle,{size:"xxxs"},r.a.createElement(y,null,e));h.displayName="ThreatSummaryTitle";var v=n(181),E=n(441);const x=m()(a.EuiInMemoryTable).withConfig({displayName:"ThreatSummaryTable",componentId:"sc-1pwinz3-0"})([".euiTableHeaderCell,.euiTableRowCell{border:none;}.euiTableHeaderCell .euiTableCellContent{padding:0;}"]),j=m()(a.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-mlcc85-0"})([".euiAccordion__triggerWrapper{background:",";border-radius:",";height:",";margin-bottom:",";padding-left:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXL),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),S=[{field:"title",truncateText:!1,render:h,width:"220px",name:""},{field:"description",truncateText:!1,render:({fieldName:e,value:t})=>{const n=e.match(s.p)?r.a.createElement(a.EuiLink,{href:t,target:"_blank"},t):r.a.createElement("span",null,t);return r.a.createElement(a.EuiToolTip,{"data-test-subj":"message-tool-tip",content:r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement("span",null,e)))},n)},name:""}],O=({enrichment:e,index:t})=>{const{id:n="threat-details-item",field:i,feedName:o,type:s,value:u}=Object(c.d)(e),d=`${n}${i}`;return r.a.createElement(j,{id:d,key:d,initialIsOpen:!0,arrowDisplay:"right",buttonContent:r.a.createElement(b,{field:i,feedName:o,value:u}),extraAction:Object(c.f)(s)&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(v.b,{queryId:E.a,title:l.i}))},r.a.createElement(x,{columns:S,compressed:!0,"data-test-subj":`threat-details-view-${t}`,items:Object(c.a)(e)}))},k=({enrichments:e})=>r.a.createElement(r.a.Fragment,null,e.sort(((e,t)=>Object(c.e)(t)-Object(c.e)(e))).map(((t,n)=>r.a.createElement(r.a.Fragment,{key:`${t.id}`},r.a.createElement(O,{enrichment:t,index:n}),n<e.length-1&&r.a.createElement(a.EuiSpacer,{size:"m"})))));var w=n(42);const T=m.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-oksmx3-0"})(["display:inline-block;line-height:1.7em;"]),I=({type:e})=>e?r.a.createElement(T,{"data-test-subj":"no-enrichments-found"},e===s.c.IndicatorMatchRule?l.l:r.a.createElement(w.FormattedMessage,{id:"xpack.securitySolution.enrichment.noInvestigationEnrichment",defaultMessage:"Additional threat intelligence wasn't found within the selected time frame. Try a different time frame, or {link} to collect threat intelligence for threat detection and matching.",values:{link:r.a.createElement(a.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/es-threat-intel-integrations.html",target:"_blank"},r.a.createElement(w.FormattedMessage,{id:"xpack.securitySolution.enrichment.investigationEnrichmentDocumentationLink",defaultMessage:"enable threat intelligence integrations"}))}})):null,M=({type:e})=>e?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"baseline"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiTitle,{size:"xxxs"},r.a.createElement("h3",null,e===s.c.IndicatorMatchRule?l.f:l.h))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(d,{type:e}))),r.a.createElement(a.EuiSpacer,{size:"s"})):null,C=({enrichments:e,type:t,loading:n,dataTestSubj:i,children:o})=>r.a.createElement("div",{"data-test-subj":i},r.a.createElement(M,{type:t}),o,Array.isArray(e)?r.a.createElement(k,{enrichments:e}):r.a.createElement(r.a.Fragment,null,r.a.createElement(I,{type:t}),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiSkeletonText,{"data-test-subj":"loading-enrichments",lines:4})))),_=({enrichments:e,before:t=null,showInvestigationTimeEnrichments:n,loading:i,children:l})=>{const{[s.c.IndicatorMatchRule]:c,[s.c.InvestigationTime]:u,undefined:d}=Object(o.groupBy)(e,"matched.type");return r.a.createElement(r.a.Fragment,null,t,r.a.createElement(C,{dataTestSubj:"threat-match-detected",enrichments:c,type:s.c.IndicatorMatchRule}),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiHorizontalRule,null),r.a.createElement(C,{dataTestSubj:"enriched-with-threat-intel",enrichments:u,type:s.c.InvestigationTime,loading:i},l)),d&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiHorizontalRule,null),c&&r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(C,{enrichments:d,dataTestSubj:"matches-with-no-type"})))},D=r.a.memo(_)},function(e,t,n){"use strict";n.d(t,"b",(function(){return N})),n.d(t,"a",(function(){return B}));var a=n(44),i=n(19),r=n(42),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(45),d=n(1216),p=n(122),m=n(118),f=n(145),g=n(130),b=n(300),y=n(129),h=n(272),v=n(4);const E=v.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),x=v.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),j=v.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),S=v.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),O=v.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),k=v.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),w=v.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var T=n(146),I=n(124),M=n(127),C=n(132),_=n(47),D=n(123),A=n(260),F=n(909);const N=c.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));N.displayName="NotePreviewsContainer";const P=({eventId:e,timelineId:t})=>{const n=Object(u.useDispatch)(),{selectedPatterns:a}=Object(C.a)(M.SourcererScopeName.timeline),{telemetry:r}=Object(m.j)().services,{openFlyout:l}=Object(d.a)(),c=Object(p.a)("expandableFlyoutDisabled"),g=Object(o.useCallback)((()=>{const i=a.join(",");c?n(y.a.toggleDetailPanel({panelView:"eventDetail",tabType:T.d.notes,id:t,params:{eventId:e,indexName:i}})):(l({right:{id:f.e,params:{id:e,indexName:i,scopeId:t}}}),r.reportDetailsFlyoutOpened({location:t,panel:"right"}))}),[n,e,c,l,a,r,t]);return s.a.createElement(i.EuiButtonIcon,{"data-test-subj":"notes-toggle-event-details",title:E,"aria-label":E,color:"text",iconType:"arrowRight",onClick:g})},R=s.a.memo(P),L=s.a.memo((({closeModal:e,confirmModal:t})=>s.a.createElement(i.EuiConfirmModal,{title:w,onCancel:e,onConfirm:t,cancelButtonText:k,confirmButtonText:O,buttonColor:"danger",defaultFocusedButton:"confirm"})));L.displayName="DeleteNoteConfirm";const z=s.a.memo((({noteId:e,eventId:t,confirmingNoteId:n,timelineId:a,eventIdToNoteIds:r,savedObjectId:l})=>{const c=Object(u.useDispatch)(),[d,p]=Object(o.useState)(!1),{mutate:f,isLoading:g}=function(e,t,n,a){const{services:{http:i}}=Object(m.j)(),r=Object(u.useDispatch)(),{addError:o}=Object(D.a)();return Object(_.useMutation)({mutationFn:e=>i.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{const i=null==n?void 0:n[null!=t?t:""];a&&r(A.a.deleteNote({id:a})),e&&t&&r(y.a.deleteNoteFromEvent({id:T.c.active,noteId:e,eventId:t})),t&&i&&1===i.length&&r(y.a.unPinEvent({eventId:t,id:T.c.active}))},onError:e=>{var t;o(e,{title:(t=e,v.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:"string"==typeof t?t:null==t?void 0:t.message}}))})}})}(e,t,r,l),b=Object(o.useCallback)((()=>{p(!0),c(y.a.setConfirmingNoteId({confirmingNoteId:e,id:null!=a?a:T.c.active}))}),[e,c,a]),h=Object(o.useCallback)((()=>{p(!1),c(y.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:T.c.active}))}),[c,a]),E=Object(o.useCallback)((()=>{f(l),p(!1),c(y.a.setConfirmingNoteId({confirmingNoteId:null,id:null!=a?a:T.c.active}))}),[f,l,c,a]),x=Object(o.useMemo)((()=>g||null==l),[g,l]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiButtonIcon,{title:O,"aria-label":O,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:b,disabled:x}),n===e&&d?s.a.createElement(L,{closeModal:h,confirmModal:E}):null)}));z.displayName="DeleteNoteButton";const q=s.a.memo((({eventId:e,timelineId:t,noteId:n,confirmingNoteId:a,eventIdToNoteIds:i,savedObjectId:r,showToggleEventDetailsAction:o=!0})=>e&&t?s.a.createElement(s.a.Fragment,null,o?s.a.createElement(R,{eventId:e,timelineId:t}):null,s.a.createElement(z,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:r,timelineId:t,eventIdToNoteIds:i})):s.a.createElement(z,{noteId:n,eventId:e,confirmingNoteId:a,savedObjectId:r,timelineId:t,eventIdToNoteIds:i})));q.displayName="NoteActions";const B=s.a.memo((({notes:e,timelineId:t,showTimelineDescription:n,showToggleEventDetailsAction:l=!0})=>{const c=Object(o.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),u=Object(o.useMemo)((()=>Object(F.a)()),[]),d=Object(I.a)((e=>c(e,null!=t?t:T.c.active))),p=Object(I.a)((e=>u(e,null!=t?t:T.c.active))),m=null==p?void 0:p.eventIdToNoteIds,f=Object(o.useMemo)((()=>n&&t&&null!=d&&d.description?[{username:Object(g.a)(d.updatedBy),event:j,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:d.updated?s.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(d.updated)}):Object(g.e)(),children:s.a.createElement(i.EuiText,{size:"s"},d.description),timelineAvatar:s.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=d.updatedBy?d.updatedBy:"?",size:"l"}),actions:null}]:[]),[d,t,n]),v=Object(o.useMemo)((()=>Object(a.uniqBy)("savedObjectId",e).map((e=>{var n,a,o;const c=null!=m?Object.entries(m).reduce(((t,[n,a])=>{var i;return a.includes(null!==(i=e.noteId)&&void 0!==i?i:"")?n:t}),null):null!==(n=e.eventId)&&void 0!==n?n:null;return{"data-test-subj":`note-preview-${e.savedObjectId}`,username:Object(g.a)(e.updatedBy),event:x,timestamp:e.updated?s.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(e.updated)}):Object(g.e)(),children:s.a.createElement("div",{className:h.a,tabIndex:0},s.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},s.a.createElement("p",null,`${null!==(a=e.updatedBy)&&void 0!==a?a:S} ${x}`)),s.a.createElement(b.b,null,null!==(o=e.note)&&void 0!==o?o:"")),actions:s.a.createElement(q,{eventId:c,timelineId:t,noteId:e.noteId,savedObjectId:e.savedObjectId,confirmingNoteId:null==d?void 0:d.confirmingNoteId,eventIdToNoteIds:m,showToggleEventDetailsAction:l}),timelineAvatar:s.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=e.updatedBy?e.updatedBy:"?",size:"l"})}}))),[m,e,t,null==d?void 0:d.confirmingNoteId,l]),E=Object(o.useMemo)((()=>[...f,...v]),[f,v]);return s.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:E})}));B.displayName="NotePreviews"},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var a=n(7),i=n(174);const r=(e,t,n=[],r)=>{var o,s,l,c;const u=function(e,t){return function(n,{action:a}={}){var i,r,o,s,l;if(t){const e=null!=a?a:t.getApiActionName(n);if(!t.isActionRegistered(e))return!1}return"showEndpointExceptions"===n||"crudEndpointExceptions"===n?null!==(s=null===(l=e.endpointExceptionsPrivileges)||void 0===l?void 0:l.actions[n])&&void 0!==s&&s:null!==(i=null===(r=e.packagePrivileges)||void 0===r||null===(o=r.endpoint)||void 0===o?void 0:o.actions[n].executePackageAction)&&void 0!==i&&i}}(t,r),d=e.isPlatinumPlus(),p=e.isEnterprise(),m=n.includes("superuser"),f=u("writeSecuritySolution",{action:"ui:crud"}),g=u("readSecuritySolution",{action:"ui:show"}),b=u("writeEndpointList"),y=u("readEndpointList"),h=u("writePolicyManagement"),v=u("readPolicyManagement"),E=u("writeActionsLogManagement"),x=u("readActionsLogManagement"),j=u("writeHostIsolation"),S=u("writeHostIsolationRelease"),O=u("writeProcessOperations"),k=u("writeTrustedApplications"),w=u("readTrustedApplications"),T=u("writeHostIsolationExceptions"),I=u("readHostIsolationExceptions"),M=u("accessHostIsolationExceptions"),C=u("deleteHostIsolationExceptions"),_=u("writeBlocklist"),D=u("readBlocklist"),A=u("writeEventFilters"),F=u("readEventFilters"),N=u("writeFileOperations"),P=u("writeExecuteOperations"),R=u("writeScanOperations"),L=u("showEndpointExceptions"),z=u("crudEndpointExceptions"),q={canWriteSecuritySolution:f,canReadSecuritySolution:g,canAccessFleet:null!==(o=null==t?void 0:t.fleet.all)&&void 0!==o&&o,canReadFleetAgentPolicies:null!==(s=null==t?void 0:t.fleet.readAgentPolicies)&&void 0!==s&&s,canWriteFleetAgents:null!==(l=null==t?void 0:t.fleet.allAgents)&&void 0!==l&&l,canReadFleetAgents:null!==(c=null==t?void 0:t.fleet.readAgents)&&void 0!==c&&c,canAccessEndpointManagement:m,canCreateArtifactsByPolicy:d,canWriteEndpointList:b,canReadEndpointList:y,canWritePolicyManagement:h,canReadPolicyManagement:v,canWriteActionsLogManagement:E,canReadActionsLogManagement:x&&p,canAccessEndpointActionsLogManagement:x&&d,canIsolateHost:j&&d,canUnIsolateHost:S,canKillProcess:O&&p,canSuspendProcess:O&&p,canGetRunningProcesses:O&&p,canAccessResponseConsole:!1,canWriteExecuteOperations:P&&p,canWriteFileOperations:N&&p,canWriteScanOperations:R&&p,canWriteTrustedApplications:k,canReadTrustedApplications:w,canWriteHostIsolationExceptions:T&&d,canAccessHostIsolationExceptions:M&&d,canReadHostIsolationExceptions:I,canDeleteHostIsolationExceptions:C,canWriteBlocklist:_,canReadBlocklist:D,canWriteEventFilters:A,canReadEventFilters:F,canReadEndpointExceptions:L,canWriteEndpointExceptions:z};return q.canAccessResponseConsole=p&&Object.values(Object(a.omit)(i.j,"release")).some((e=>q[e])),q},o=()=>({canWriteSecuritySolution:!1,canReadSecuritySolution:!1,canAccessFleet:!1,canReadFleetAgentPolicies:!1,canReadFleetAgents:!1,canWriteFleetAgents:!1,canAccessEndpointActionsLogManagement:!1,canAccessEndpointManagement:!1,canCreateArtifactsByPolicy:!1,canWriteEndpointList:!1,canReadEndpointList:!1,canWritePolicyManagement:!1,canReadPolicyManagement:!1,canWriteActionsLogManagement:!1,canReadActionsLogManagement:!1,canIsolateHost:!1,canUnIsolateHost:!1,canKillProcess:!1,canSuspendProcess:!1,canGetRunningProcesses:!1,canAccessResponseConsole:!1,canWriteFileOperations:!1,canWriteExecuteOperations:!1,canWriteScanOperations:!1,canWriteTrustedApplications:!1,canReadTrustedApplications:!1,canWriteHostIsolationExceptions:!1,canAccessHostIsolationExceptions:!1,canReadHostIsolationExceptions:!1,canDeleteHostIsolationExceptions:!1,canWriteBlocklist:!1,canReadBlocklist:!1,canWriteEventFilters:!1,canReadEventFilters:!1,canReadEndpointExceptions:!1,canWriteEndpointExceptions:!1})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(504),l=n(304);var c=n(700);const u=o.a.div.withConfig({displayName:"StyledContent",componentId:"sc-18lfxbd-0"})(["padding:",";width:100%;margin:0 auto;"],(({$isDetails:e})=>e?"0 8px":void 0)),d=({data:e,ecsData:t,eventId:n,header:r,isDetails:o,isDraggable:d,isTimeline:p,linkValues:m,rowRenderers:f,scopeId:g,truncate:b,asPlainText:y,context:h})=>{const v=Object(a.useMemo)((()=>void 0!==Object(c.b)(r.id,r.type,r.linkField)&&!p),[r.id,r.linkField,r.type,p]),E=Object(s.c)({data:e,fieldName:r.id}),x=o?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return i.a.createElement(u,{className:x,$isDetails:o},((e,t,n,a)=>{const i=t.find((t=>t.isInstance(e,n,a)));return null!=i?i:(()=>{throw new Error("Unhandled Column Renderer")})()})(r.id,l.a,e,h).renderColumn({asPlainText:null!=y?y:v,columnName:r.id,ecsData:t,eventId:n,field:r,isDetails:o,isDraggable:d,linkValues:m,rowRenderers:f,scopeId:g,truncate:b,values:E,context:h}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(44),i=n(2),r=n(123),o=n(118),s=n(17),l=n(1249),c=n(4);const u=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),d=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),p=c.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),m=()=>{const{telemetry:e}=Object(o.j)().services,{addError:t}=Object(r.a)(),[n,a]=Object(i.useState)(!1);return{enableDatafeed:Object(i.useCallback)((async(n,i)=>{if(a(!0),Object(s.h)(s.a.COUNT,n.isElasticJob?s.c.SIEM_JOB_ENABLED:s.c.CUSTOM_JOB_ENABLED),!n.isInstalled)try{await Object(l.c)({configTemplate:n.moduleId,indexPatternName:n.defaultIndexPattern,jobIdErrorFilter:[n.id],groups:n.groups}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:s.b.moduleInstalled})}catch(i){return a(!1),t(i,{title:p}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:s.b.installationError,errorMessage:`${p} - ${i.message}`}),{enabled:!1}}const r=new Date,o=r.setDate(r.getDate()-14),c=`datafeed-${n.id}`,d=Math.max(i,o);try{var m;const t=await Object(l.d)({datafeedIds:[c],start:d});if(null!==(m=t[c])&&void 0!==m&&m.error)throw new Error(t[c].error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:s.b.started}),{enabled:!!t[c]&&t[c].started}}catch(a){Object(s.h)(s.a.COUNT,s.c.JOB_ENABLE_FAILURE),t(a,{title:u}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:s.b.startError,errorMessage:`${u} - ${a.message}`})}finally{a(!1)}return{enabled:!1}}),[t,e]),disableDatafeed:Object(i.useCallback)((async n=>{Object(s.h)(s.a.COUNT,n.isElasticJob?s.c.SIEM_JOB_DISABLED:s.c.CUSTOM_JOB_DISABLED),a(!0);const i=`datafeed-${n.id}`;try{const[t]=await Object(l.e)({datafeedIds:[i]});if(f(t))throw new Error(t.error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:s.b.stopped}),{enabled:!t[i]||!t[i].stopped}}catch(a){Object(s.h)(s.a.COUNT,s.c.JOB_DISABLE_FAILURE),t(a,{title:d}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:s.b.stopError,errorMessage:`${d} - ${a.message}`})}finally{a(!1)}return{enabled:!0}}),[t,e]),isLoading:n}},f=e=>!Object(a.isEmpty)(e.error)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),i=n(1371),r=n(458),o=n(403);const s=a.exact(a.type({field:i.a,list:a.exact(a.type({id:i.a,type:r.a})),operator:o.c,type:a.keyof({list:null})}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(1055),r=a.__importDefault(n(461)),o=function(e,t){return e.every((function(e,n){return i.equal(e,t[n])}))};t.default=function(e,t){r.default(e,t,o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),i=n(796),r=n(750);const o=new a.Type("NonEmptyEntriesArray",i.a.is,((e,t)=>Array.isArray(e)&&0===e.length?a.failure(e,t):Array.isArray(e)&&e.some((e=>r.a.is(e)))&&e.some((e=>!r.a.is(e)))?a.failure(e,t,"Cannot have entry of type list and other"):i.a.validate(e,t)),a.identity)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),i=n.n(a),r=n(19),o=n(42),s=n(54),l=n.n(s),c=n(2),u=n.n(c);const d=u.a.memo((({children:e,date:t,fieldName:n,className:a="",tooltipProps:s})=>u.a.createElement(r.EuiToolTip,i()({"data-test-subj":"localized-date-tool-tip",anchorClassName:a},s,{content:u.a.createElement(r.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?u.a.createElement(r.EuiFlexItem,{grow:!1},u.a.createElement("span",{"data-test-subj":"field-name"},n)):null,u.a.createElement(r.EuiFlexItem,{grow:!1},u.a.createElement(o.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:l.a.utc(t).toDate()})),u.a.createElement(r.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},l.a.utc(t).local().format("llll")),u.a.createElement(r.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},l()(t).format()))}),u.a.createElement(u.a.Fragment,null,e))));d.displayName="LocalizedDateTooltip"},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(228);const c=s.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),u=({count:e,onClick:t})=>{const n=Object(i.useCallback)((()=>t&&t()),[t]);return e?t?r.a.createElement(a.EuiLink,{onClick:n},r.a.createElement("b",null,r.a.createElement(l.a,{count:e}))):r.a.createElement("b",null,r.a.createElement(l.a,{count:e})):r.a.createElement(c,null)};u.displayName="ChartLabelComponent";const d=r.a.memo(u)},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v}));var a=n(19),i=n(2),r=n.n(i),o=n(72),s=n(7),l=n(41),c=n.n(l),u=n(4),d=n(708),p=n(882),m=n(770);const f={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},g=c()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),b=c()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),y=({children:e,dataExists:t,donutTextWrapperClassName:n,donutTextWrapperStyles:o,isChartEmbeddablesEnabled:s,label:l,title:c})=>{const{euiTheme:u}=Object(a.useEuiTheme)(),d=Object(i.useMemo)((()=>({color:u.colors.darkShade})),[u.colors.darkShade]),p=s?void 0:"eui-textTruncate";return r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(b,{grow:s},r.a.createElement(g,{$dataExists:t,$donutTextWrapperStyles:o,$isChartEmbeddablesEnabled:s,alignItems:"center",className:n,direction:"column",gutterSize:"none",justifyContent:"center"},r.a.createElement(a.EuiFlexItem,null,c),l&&r.a.createElement(a.EuiFlexItem,{className:p},r.a.createElement(a.EuiToolTip,{content:l},r.a.createElement(a.EuiText,{className:p,size:"s",style:t?void 0:d},l)))),e))},h=r.a.memo(y),v=({data:e,fillColor:t,height:n=90,label:l,legendItems:c,onPartitionClick:g,title:b,totalCount:y})=>{const{baseTheme:v,theme:E}=Object(d.h)(),x=Object(i.useCallback)((e=>{if(g){var t;const n=e.flat(2),a=n.length>0&&"groupByRollup"in n[0]&&null!=(null===(t=n[0])||void 0===t?void 0:t.groupByRollup)?`${n[0].groupByRollup}`:"";Object(s.isEmpty)(a.trim())||g(a.toLowerCase())}}),[g]);return r.a.createElement(h,{dataExists:null!=e&&e.length>0,label:l,title:b,isChartEmbeddablesEnabled:!1},r.a.createElement(r.a.Fragment,null,null==e||null==y||0===y?r.a.createElement(m.a,{size:n}):r.a.createElement(o.Chart,{size:n},r.a.createElement(o.Settings,{theme:[f,E],baseTheme:v,onElementClick:x,locale:u.i18n.getLocale()}),r.a.createElement(o.Partition,{id:"donut-chart",data:e,layout:o.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(o.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),c&&(null==c?void 0:c.length)>0&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(p.a,{legendItems:c,height:n}))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(119),i=n(2),r=n(652),o=n(43),s=n(323),l=n(324),c=n(653);function u(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var p=d(i),m=u(r).default,f=function(e){return"theme"!==e},g=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?m:f},b=function(e,t,n){var a;if(t){var i=t.shouldForwardProp;a=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof a&&n&&(a=e.__emotion_forwardProp),a},y="undefined"!=typeof document,h=function(e){var t=e.cache,n=e.serialized,a=e.isStringTag;s.registerStyles(t,n,a);var i=c.useInsertionEffectAlwaysWithSyncFallback((function(){return s.insertStyles(t,n,a)}));if(!y&&void 0!==i){for(var r,o=n.name,l=n.next;void 0!==l;)o+=" "+l.name,l=l.next;return p.createElement("style",((r={})["data-emotion"]=t.key+" "+o,r.dangerouslySetInnerHTML={__html:i},r.nonce=t.sheet.nonce,r))}return null};t.default=function e(t,n){var i,r,c=t.__emotion_real===t,u=c&&t.__emotion_base||t;void 0!==n&&(i=n.label,r=n.target);var d=b(t,n,c),m=d||g(u),f=!m("as");return function(){var y=arguments,v=c&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&v.push("label:"+i+";"),null==y[0]||void 0===y[0].raw)v.push.apply(v,y);else{v.push(y[0][0]);for(var E=y.length,x=1;x<E;x++)v.push(y[x],y[0][x])}var j=o.withEmotionCache((function(e,t,n){var a=f&&e.as||u,i="",c=[],b=e;if(null==e.theme){for(var y in b={},e)b[y]=e[y];b.theme=p.useContext(o.ThemeContext)}"string"==typeof e.className?i=s.getRegisteredStyles(t.registered,c,e.className):null!=e.className&&(i=e.className+" ");var E=l.serializeStyles(v.concat(c),t.registered,b);i+=t.key+"-"+E.name,void 0!==r&&(i+=" "+r);var x=f&&void 0===d?g(a):m,j={};for(var S in e)f&&"as"===S||x(S)&&(j[S]=e[S]);return j.className=i,j.ref=n,p.createElement(p.Fragment,null,p.createElement(h,{cache:t,serialized:E,isStringTag:"string"==typeof a}),p.createElement(a,j))}));return j.displayName=void 0!==i?i:"Styled("+("string"==typeof u?u:u.displayName||u.name||"Component")+")",j.defaultProps=t.defaultProps,j.__emotion_real=j,j.__emotion_base=u,j.__emotion_styles=v,j.__emotion_forwardProp=d,Object.defineProperty(j,"toString",{value:function(){return"."+r}}),j.withComponent=function(t,i){return e(t,a({},n,i,{shouldForwardProp:b(j,i,!0)})).apply(void 0,v)},j}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(187);const r=()=>{const{startTransaction:e}=Object(i.b)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),i=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==i||i.end()}}}),[e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(45),r=n(122),o=n(697);const s=()=>{const e=Object(i.useDispatch)(),t=Object(r.a)("securitySolutionNotesEnabled");return{onLoad:Object(a.useCallback)((n=>{if(!t||0===n.length)return;const a=n.map((e=>e._id)).filter((e=>null!=e));e(Object(o.e)({documentIds:a}))}),[e,t])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r}));let a=function(e){return e.DOCUMENT="document",e.BINARY="binary",e.BOOLEAN="boolean",e.CONFLICT="conflict",e.COUNTER="counter",e.DATE="date",e.DATE_RANGE="date_range",e.DENSE_VECTOR="dense_vector",e.GAUGE="gauge",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.HISTOGRAM="histogram",e.IP="ip",e.IP_RANGE="ip_range",e.FLATTENED="flattened",e.KEYWORD="keyword",e.MURMUR3="murmur3",e.NUMBER="number",e.NESTED="nested",e.RANK_FEATURE="rank_feature",e.RANK_FEATURES="rank_features",e.POINT="point",e.SHAPE="shape",e.SPARSE_VECTOR="sparse_vector",e.SEMANTIC_TEXT="semantic_text",e.STRING="string",e.TEXT="text",e.VERSION="version",e}({});const i=Object.values(a),r=e=>!!e&&i.includes(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(79),r=n(132),o=n(118);const s=({sourcererScope:e})=>{const{services:{fieldFormats:t}}=Object(o.j)(),{sourcererDataView:n}=Object(r.a)(e);return Object(a.useMemo)((()=>n?new i.DataView({spec:n,fieldFormats:t}):void 0),[n,t])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(446);const o=Object(r.c)(),s=Object(r.c)(),l=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},c=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(r.b,{node:e})}));c.displayName="TimelineEventsCountBadge";const u=()=>{const[e]=Object(a.useState)(s);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=u();return i.a.createElement(r.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const a=new MutationObserver((()=>{const a=!!document.getElementById(e);a&&!t&&n(!0),!a&&t&&n(!1)}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[t,e]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),r=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),o=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19);const l="#FAFBFD",c=o.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${l};\n    text-align: center;\n    line-height: ${e}px;`)),u=o.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(s.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(c,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(u,{size:e-t,"data-test-subj":"empty-donut-small"})):null,p=i.a.memo(d)},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.osquery.action.shortEmptyTitle",{defaultMessage:"Osquery is not available"}),r=a.i18n.translate("xpack.securitySolution.osquery.action.permissionDenied",{defaultMessage:"Permission denied"}),o=a.i18n.translate("xpack.securitySolution.osquery.action.unavailable",{defaultMessage:"The Osquery Manager integration is not added to the agent policy. To run queries on the host, add the Osquery Manager integration to the agent policy in Fleet."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(233),l=n(1451);function c({type:e,label:t=e,"data-test-subj":n,...a}){return o.a.createElement(l.a,i()({},function(e){switch(e){case s.a._ID:case s.a._INDEX:return{type:"keyword"};case s.a.OBJECT:return{type:e,iconType:"tokenObject"};case s.a.DATE_NANOS:return{type:"date"};case s.a.FLOAT:case s.a.HALF_FLOAT:case s.a.SCALED_FLOAT:case s.a.DOUBLE:case s.a.INTEGER:case s.a.LONG:case s.a.SHORT:case s.a.UNSIGNED_LONG:case s.a.AGGREGATE_METRIC_DOUBLE:case s.a.FLOAT_RANGE:case s.a.DOUBLE_RANGE:case s.a.INTEGER_RANGE:case s.a.LONG_RANGE:case s.a.BYTE:case s.a.TOKEN_COUNT:return{type:"number"};default:return{type:e}}}(e),{label:t,"data-test-subj":n},a))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(1294),c=n.n(l);const u=s()(a.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroupStyles",componentId:"sc-rh40g1-0"})([".euiFlexItem{margin-bottom:0px;}"]),d=s()(a.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-rh40g1-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),p=s()(a.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-rh40g1-2"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),m=({threat:e,"data-test-subj":t="threat"})=>{const[o,s]=Object(i.useState)([]),[l,m]=Object(i.useState)([]),[f,g]=Object(i.useState)([]);return Object(i.useEffect)((()=>{!async function(){const e=await n.e(24).then(n.bind(null,1481));g(e.subtechniques),s(e.techniques),m(e.tactics)}()}),[]),r.a.createElement(u,{direction:"column","data-test-subj":t},e.map(((e,t)=>{const n=l.find((t=>t.id===e.tactic.id));return r.a.createElement(a.EuiFlexItem,{key:`${e.tactic.name}-${t}`},r.a.createElement(a.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=n?n.label:`${e.tactic.name} (${e.tactic.id})`),r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var n;const i=o.find((t=>t.id===e.id));return r.a.createElement(a.EuiFlexItem,{key:null!==(n=null==i?void 0:i.id)&&void 0!==n?n:t},r.a.createElement(p,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=i?i.label:`${e.name} (${e.id})`),r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var n;const a=f.find((t=>t.id===e.id));return r.a.createElement(d,{key:null!==(n=null==a?void 0:a.id)&&void 0!==n?n:t},r.a.createElement(p,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=a?a.label:`${e.name} (${e.id})`))}))))}))))})))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(124),r=n(131),o=n(148);const s=({scopeId:e})=>{const t=Object(a.useMemo)((()=>o.d.globalQuery()),[]),n=Object(a.useMemo)((()=>o.d.timelineQueryByIdSelector()),[]),{globalQuery:s,timelineQuery:l}=Object(i.a)((a=>({globalQuery:t(a),timelineQuery:n(a,e)})));return{refetch:Object(a.useCallback)((()=>{const t=e=>{e.forEach((e=>e.refetch&&e.refetch()))};Object(r.isActiveTimeline)(e)?t([l]):t(s)}),[e,l,s])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(823);const r={isolateAction:"isolateHost",isHostIsolationPanelOpen:!1,isIsolateActionSuccessBannerVisible:!1};function o(e,t){switch(t.type){case"setIsolateAction":return{...e,isolateAction:t.isolateAction};case"setIsHostIsolationPanel":return{...e,isHostIsolationPanelOpen:t.isHostIsolationPanelOpen};case"setIsIsolateActionSuccessBannerVisible":return{...e,isIsolateActionSuccessBannerVisible:t.isIsolateActionSuccessBannerVisible};default:throw new Error}}const s=()=>{const[{isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:n},s]=Object(a.useReducer)(o,r),l=Object(a.useCallback)((()=>{s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!1}),s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!1})}),[]),c=Object(a.useCallback)((e=>{"isolateHost"!==e&&"unisolateHost"!==e||(s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!0}),s({type:"setIsolateAction",isolateAction:e}))}),[]),u=Object(i.b)(),d=Object(a.useCallback)((()=>{s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!0}),u&&u.refreshCase()}),[u]);return Object(a.useMemo)((()=>({isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:n,handleIsolationActionSuccess:d,showAlertDetails:l,showHostIsolationPanel:c})),[t,n,e,d,l,c])}},function(e,t,n){"use strict";n.d(t,"U",(function(){return i})),n.d(t,"n",(function(){return r})),n.d(t,"M",(function(){return o})),n.d(t,"p",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"bb",(function(){return u})),n.d(t,"N",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"db",(function(){return y})),n.d(t,"R",(function(){return h})),n.d(t,"cb",(function(){return v})),n.d(t,"P",(function(){return E})),n.d(t,"Q",(function(){return x})),n.d(t,"fb",(function(){return j})),n.d(t,"v",(function(){return S})),n.d(t,"S",(function(){return O})),n.d(t,"Y",(function(){return k})),n.d(t,"ab",(function(){return w})),n.d(t,"Z",(function(){return T})),n.d(t,"H",(function(){return I})),n.d(t,"I",(function(){return M})),n.d(t,"G",(function(){return C})),n.d(t,"K",(function(){return _})),n.d(t,"J",(function(){return D})),n.d(t,"F",(function(){return A})),n.d(t,"E",(function(){return F})),n.d(t,"O",(function(){return N})),n.d(t,"c",(function(){return P})),n.d(t,"L",(function(){return R})),n.d(t,"T",(function(){return L})),n.d(t,"d",(function(){return z})),n.d(t,"m",(function(){return q})),n.d(t,"o",(function(){return B})),n.d(t,"g",(function(){return $})),n.d(t,"f",(function(){return V})),n.d(t,"l",(function(){return U})),n.d(t,"j",(function(){return G})),n.d(t,"k",(function(){return H})),n.d(t,"h",(function(){return W})),n.d(t,"i",(function(){return Q})),n.d(t,"e",(function(){return Y})),n.d(t,"eb",(function(){return K})),n.d(t,"X",(function(){return J})),n.d(t,"V",(function(){return Z})),n.d(t,"W",(function(){return X})),n.d(t,"w",(function(){return ee})),n.d(t,"C",(function(){return te})),n.d(t,"A",(function(){return ne})),n.d(t,"z",(function(){return ae})),n.d(t,"B",(function(){return ie})),n.d(t,"D",(function(){return re})),n.d(t,"x",(function(){return oe})),n.d(t,"y",(function(){return se}));var a=n(4);a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"});const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.showingExceptionLists",{values:{totalLists:e},defaultMessage:"Showing {totalLists} {totalLists, plural, =1 {list} other {lists}}"}),r=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"})),o=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Shared Exception Lists"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableSubtitle",{defaultMessage:"To view rule specific exceptions navigate to that rule's details page."}),u=e=>a.i18n.translate("xpack.securitySolution.exceptions.allExceptionsRowPerPage",{defaultMessage:"Rows per page: {rowSize}",values:{rowSize:e}}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),p=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.export_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" exported successfully'}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),f=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.duplicate_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" duplicated successfully'}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.duplicateError",{defaultMessage:"Exception list duplication error"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),y=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),h=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),v=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDefaultDescription",{defaultMessage:"Are you sure you wish to DELETE exception list with the name {listName}?",values:{listName:e}}),E=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),x=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),j=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:e}}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.searchPlaceholder",{defaultMessage:"Search by name or list_id:id"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.refresh",{defaultMessage:"Refresh"}),k=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsImportButton",{defaultMessage:"Import list"}),w=a.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccessTitle",{defaultMessage:"Exception list imported"}),T=a.i18n.translate("xpack.securitySolution.lists.exceptionListUploadError",{defaultMessage:"There was an error uploading the exception list."}),I=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.importExceptionList",{defaultMessage:"Import exception list"}),M=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutHeader",{defaultMessage:"Import shared exception list"}),C=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutBody",{defaultMessage:"Select shared exception lists to import"}),_=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListWarning",{defaultMessage:"We found a pre-existing list with that id"}),D=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListOverwrite",{defaultMessage:"Overwrite the existing list"}),A=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListAsNewList",{defaultMessage:"Create new list"}),F=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionEndpointListWarning",{defaultMessage:"Multiple exception lists for Endpoint Security are not allowed."}),N=a.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"}),P=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsCloseImportFlyout",{defaultMessage:"Close"}),R=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsFilePickerPrompt",{defaultMessage:"Select or drag and drop multiple files"}),L=a.i18n.translate("xpack.securitySolution.exceptionsTable.rulesCountLabel",{defaultMessage:"Rules"}),z=a.i18n.translate("xpack.securitySolution.exceptionsTable.createdBy",{defaultMessage:"Created By"}),q=a.i18n.translate("xpack.securitySolution.exceptionsTable.createdAt",{defaultMessage:"Date created"}),B=a.i18n.translate("xpack.securitySolution.exceptionsTable.exceptionsCountLabel",{defaultMessage:"Exceptions"}),$=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createSharedListButton",{defaultMessage:"Create shared list"}),V=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createItemButton",{defaultMessage:"Create exception item"}),U=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListTitle",{defaultMessage:"Create shared exception list"}),G=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameField",{defaultMessage:"Shared exception list name"}),H=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameFieldPlaceholder",{defaultMessage:"New exception list"}),W=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescription",{defaultMessage:"Description (optional)"}),Q=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescriptionPlaceholder",{defaultMessage:"New exception list description"}),Y=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutCreateButton",{defaultMessage:"Create shared exception list"}),K=e=>a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessDescription",{defaultMessage:"List with name {listName} was created!",values:{listName:e}}),J=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessTitle",{defaultMessage:"Created list"}),Z=a.i18n.translate("xpack.securitySolution.exceptions.sortBy",{defaultMessage:"Sort by:"}),X=a.i18n.translate("xpack.securitySolution.exceptions.sortByCreateAt",{defaultMessage:"Created At"}),ee=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalCancelButton",{defaultMessage:"Cancel"}),te=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalExportTitle",{defaultMessage:"Export exception list?"}),ne=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalDuplicateTitle",{defaultMessage:"Duplicate exception list?"}),ae=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeDuplicateDescription",{defaultMessage:"You’re duplicating an exception list. Switch the toggle off to exclude expired exceptions."}),ie=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeExportDescription",{defaultMessage:"You’re exporting an exception list. Switch the toggle off to exclude expired exceptions."}),re=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeSwitchLabel",{defaultMessage:"Include expired exceptions"}),oe=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmDuplicateButton",{defaultMessage:"Duplicate"}),se=a.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmExportButton",{defaultMessage:"Export"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(19),o=n(43);const s={name:"qeawqx",styles:"max-height:300px;height:100%;overflow-x:hidden;overflow-y:auto"},l=({text:e,dataTestSubj:t,actions:n,disableActions:i,emptyButton:l,useCustomActions:c,iconType:u,iconSide:d="left",anchorPosition:p="downCenter",panelPaddingSize:m="s"})=>{const[f,g]=Object(a.useState)(!1),b=()=>g((e=>!e)),y=()=>g(!1),h=Object(a.useMemo)((()=>c||null===n?n:n.map((e=>Object(o.jsx)(r.EuiContextMenuItem,{"data-test-subj":`${t||""}ActionItem${e.key}`,key:e.key,icon:e.icon,disabled:e.disabled,layoutAlign:"center",onClick:t=>{y(),"function"==typeof e.onClick&&e.onClick(t)}},e.label)))),[n,t,c]);return Object(o.jsx)(r.EuiFlexGroup,{responsive:!0},Object(o.jsx)(r.EuiPopover,{button:l?Object(o.jsx)(r.EuiButtonEmpty,{isDisabled:i,onClick:b,iconType:u||void 0,iconSide:d,"data-test-subj":`${t||""}EmptyButton`,"aria-label":"Header menu Button Empty"},e):Object(o.jsx)(r.EuiButtonIcon,{isDisabled:i,onClick:b,iconType:u||"boxesHorizontal","data-test-subj":`${t||""}ButtonIcon`,"aria-label":"Header menu Button Icon"},e),onClick:e=>e.stopPropagation(),panelPaddingSize:m,isOpen:f,closePopover:y,anchorPosition:p,"data-test-subj":`${t||""}Items`},h?Object(o.jsx)(r.EuiContextMenuPanel,{css:s,className:"eui-scrollBar","data-test-subj":`${t||""}MenuPanel`,size:"s",items:h}):null))};l.displayName="HeaderMenuComponent";const c=i.a.memo(l);c.displayName="HeaderMenu"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(159);const r=({exceptionLists:e})=>{const[t,n]=Object(a.useState)(!0),[r,o]=Object(a.useState)([]),[s,l]=Object(a.useState)({}),c=Object(a.useCallback)((t=>{const n=e.reduce(((e,{id:t,...n})=>(e[t]={...n,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const n=t.exceptions_list;return null!=n&&n.length>0&&n.forEach((n=>{const a=e[n.id];null!=a&&(e[n.id]={...a,rules:[...a.rules,t]})})),e}),n)}),[e]);return Object(a.useEffect)((()=>{let t=!0;const a=new AbortController;return(async()=>{if(0===e.length&&t)return n(!1),o([]),void l({});try{n(!0);const{data:e}=await Object(i.j)({pagination:{page:1,perPage:1e4},signal:a.signal}),r=c(e),s=Object.keys(r).map((e=>r[e]));o(s),l(r),t&&n(!1)}catch(e){t&&n(!1)}})(),()=>{t=!1,a.abort()}}),[e.length,c]),[t,r,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(2),i=n.n(a),r=n(19),o=n(221);const s={DUPLICATE:"duplicate",EXPORT:"export"},l=Object(a.memo)((({handleCloseModal:e,onModalConfirm:t,action:n})=>{const[l,c]=Object(a.useState)(!0),u=Object(a.useCallback)((()=>{c(!l)}),[c,l]),d=Object(a.useCallback)((()=>{t(l),e()}),[l,e,t]);return i.a.createElement(r.EuiConfirmModal,{title:n===s.EXPORT?o.M:o.K,onCancel:e,onConfirm:d,cancelButtonText:o.G,confirmButtonText:n===s.EXPORT?o.I:o.H,defaultFocusedButton:"confirm","data-test-subj":"includeExpiredExceptionsConfirmationModal"},i.a.createElement(r.EuiText,null,n===s.EXPORT?o.L:o.J),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiSwitch,{label:o.N,checked:l,onChange:u,"data-test-subj":"includeExpiredExceptionsConfirmationModalSwitch"}))}));l.displayName="IncludeExpiredExceptionsModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(123),i=n(383),r=n(449);const o=(e,t)=>{const{addError:n}=Object(a.a)();return Object(i.a)(e,{onError:e=>n(e,{title:r.b}),...t})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(118),r=n(265);const o=(e=[])=>{const{getAppUrl:t}=Object(i.c)();return Object(a.useMemo)((()=>e.reduce(((e,n)=>{var a;const i=n.id,o=Object(r.j)(i);return e[i]={href:t({path:o}),children:null!==(a=n.name)&&void 0!==a?a:i,target:"_blank"},e}),{})),[t,e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(48),i=n(2),r=n(7),o=n(297);const s=()=>{const e=Object(a.useLocation)(),t=Object(a.useHistory)(),{toUrlParams:n,urlParams:s}=Object(o.a)();return Object(i.useCallback)(((a,i=!1)=>{t.push({...e,search:n(i?a:Object(r.pickBy)({...s,...a},(e=>void 0!==e)))})}),[s,t,e,n])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return A}));var a=n(19),i=n(49),r=n(44),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(161),d=n(875),p=n(209),m=n(313),f=n(137),g=n(118),b=n(130),y=n(351),h=n(367),v=n(181),E=n(340),x=n(144),j=n(314),S=n(201),O=n(862),k=n(196),w=n(736),T=n(334),I=n(226),M=n(521),C=n(357);const _=c()(a.EuiFlexGroup).withConfig({displayName:"UserRiskOverviewWrapper",componentId:"sc-1f042fn-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),D="riskInputsTabQuery",A=s.a.memo((({anomaliesData:e,contextID:t,scopeId:n,data:l,id:c,isDraggable:A=!1,isInDetailsSidePanel:F=!1,isLoadingAnomaliesData:N,loading:P,narrowDateRange:R,startDate:L,endDate:z,userName:q,indexPatterns:B,jobNameById:$})=>{const V=Object(S.a)(),U=Object(j.a)(V),G=Object(g.g)(),H=Object(o.useMemo)((()=>q?Object(f.A)([q]):void 0),[q]),{deleteQuery:W,setQuery:Q}=Object(u.a)(),{data:Y,isAuthorized:K,inspect:J,loading:Z,refetch:X}=Object(m.a)({filterQuery:H,skip:null==q,riskEntity:f.t.user,onlyLatest:!1,pagination:d.a});Object(p.b)({deleteQuery:W,inspect:J,loading:Z,queryId:D,refetch:X,setQuery:Q});const ee=Object(o.useCallback)(((e,a)=>s.a.createElement(y.a,{rowItems:Object(r.getOr)([],e,a),attrName:e,idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:A,scopeId:n})),[t,A,n]),[te,ne]=Object(o.useMemo)((()=>{const e=Y&&Y.length>0?Y[0]:void 0;return[{title:s.a.createElement(M.a,{title:w.k,riskScoreEntity:f.t.user}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.user.risk.calculated_score_norm):Object(b.d)())},{title:s.a.createElement(a.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(M.a,{title:w.j,riskScoreEntity:f.t.user})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(C.a,{anchorPosition:"upCenter"}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(I.a,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(b.d)())}]}),[Y]),ae=Object(o.useMemo)((()=>[{title:w.i,description:l&&l.user?ee("user.id",l):Object(b.d)()},{title:w.h,description:l&&l.user?ee("user.domain",l):Object(b.d)()}]),[l,ee]),ie=Object(o.useMemo)((()=>U?[...ae,{title:w.g,description:s.a.createElement(O.a,{anomalies:e,startDate:L,endDate:z,isLoading:N,narrowDateRange:R,jobNameById:$})}]:ae),[e,ae,z,N,R,L,U,$]),re=Object(o.useMemo)((()=>[ie,[{title:w.a,description:s.a.createElement(h.a,{indexPatterns:B,field:"user.name",value:q,type:h.b.FIRST_SEEN})},{title:w.f,description:s.a.createElement(h.a,{indexPatterns:B,field:"user.name",value:q,type:h.b.LAST_SEEN})}],[{title:w.d,description:ee("host.os.name",l)},{title:w.b,description:ee("host.os.family",l)},{title:w.c,description:s.a.createElement(y.a,{rowItems:Object(r.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`user-overview-${t}`:"user-overview",scopeId:n,isDraggable:A,render:e=>null!=e?s.a.createElement(x.h,{ip:e}):Object(b.d)()})}]]),[l,B,ee,t,n,A,q,ie]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(v.c,null,s.a.createElement(k.g,{direction:F?"column":"row","data-test-subj":"user-overview"},!F&&s.a.createElement(v.b,{queryId:c,title:w.e,inspectIndex:0}),re.map(((e,t)=>s.a.createElement(T.a,{descriptionList:e,key:t}))),P&&s.a.createElement(E.a,{overlay:!0,overlayBackground:G?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),K&&s.a.createElement(_,{gutterSize:F?"m":"none",direction:F?"column":"row","data-test-subj":"user-risk-overview",$width:F?"100%":"66.6%"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[te]})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[ne]}))))}));A.displayName="UserOverview"},function(e,t,n){e.exports=n(35)(1196)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n.n(a),r=n(41);const o=n.n(r).a.div.withConfig({displayName:"StyledDiv",componentId:"sc-ydtkdd-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));o.defaultProps={addPadding:!1};const s=i.a.memo(o);s.displayName="StepContentWrapper"},function(e,t,n){"use strict";n.d(t,"a",(function(){return pe}));var a=n(44),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(19),c=n(46),u=n(1371),d=n(214);const p=c.intersection([c.exact(c.type({comment:u.a})),c.exact(c.partial({id:d.a}))]),m=c.array(p),f=(c.union([m,c[void 0]]),new c.Type("DefaultUpdateComments",m.is,((e,t)=>null==e?c.success([]):m.validate(e,t)),c.identity));var g=n(574),b=n(752),y=n(506),h=n(507),v=n(399),E=n(400),x=n(345),j=n(275),S=n(456),O=n(1284);const k=c.intersection([c.exact(c.type({description:v.a,entries:b.a,name:E.a,type:g.a})),c.exact(c.partial({_version:x.a,comments:f,expire_time:O.a,id:d.a,item_id:c.union([c.string,c[void 0]]),meta:j.a,namespace_type:S.a,os_types:y.c,tags:h.a}))]);var w=n(1334),T=n(1555),I=n(1561),M=n(54),C=n.n(M),_=n(165),D=n(878),A=n(4);const F=A.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.title",{defaultMessage:"Linked to shared list"}),N=A.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.error",{defaultMessage:"Unable to fetch exception list."});var P=n(354);const R=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1rq9jba-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),L=({isLoadingReferences:e,errorFetchingReferences:t,listAndReferences:n})=>{const[a,o]=Object(i.useState)(r.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemListsTableLoading"})),[s,c]=Object(i.useState)(void 0);return Object(i.useEffect)((()=>{t?c(N):e||o(void 0)}),[t,e]),r.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemLinkedToListSection"},r.a.createElement(R,{size:"xs"},r.a.createElement("h3",null,F)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{tableCaption:"Table of exception lists",itemId:"id",message:a,loading:e,items:n,error:s,columns:Object(P.d)(),sorting:!0,"data-test-subj":"exceptionItemSharedList"}))},z=r.a.memo(L);z.displayName="ExceptionsLinkedToLists";const q=A.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToRule.title",{defaultMessage:"Linked to rule"}),B=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-6bqv6k-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),$=({rule:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(B,{size:"xs","data-test-subj":"exceptionItemLinkedToRuleSection"},r.a.createElement("h3",null,q)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{tableCaption:"Rules table",itemId:"id",items:[e],columns:Object(P.c)(),sorting:!0,"data-test-subj":"addExceptionToRulesTable"})),V=r.a.memo($);V.displayName="ExceptionsLinkedToRule";var U=n(871),G=n(879),H=n(840),W=n(872),Q=n(1230),Y=n(632);const K=A.i18n.translate("xpack.securitySolution.ruleExceptions.editException.cancel",{defaultMessage:"Cancel"}),J=A.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editExceptionTitle",{defaultMessage:"Edit rule exception"}),Z=A.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit endpoint exception"}),X=A.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception updated"}),ee=A.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastErrorTitle",{defaultMessage:"Error updating exception"});var te=n(123),ne=n(841),ae=n(353),ie=n(880),re=n(237),oe=n(487);const se=s()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-1j5dcqi-0"})(["",""],(({theme:e})=>Object(o.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),le=s()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-1j5dcqi-1"})(["",""],(()=>Object(o.css)(["&.builder-section{overflow-y:scroll;}"]))),ce=s()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-1j5dcqi-2"})(["",""],(({theme:e})=>Object(o.css)(["padding:",";"],e.eui.euiSizeS))),ue=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1j5dcqi-3"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),de=({list:e,itemToEdit:t,rule:n,showAlertCloseOptions:o,openedFromListDetailPage:s,onCancel:c,onConfirm:u})=>{var d;const p=Object(i.useMemo)((()=>t.os_types),[t]),m=Object(i.useMemo)((()=>null!=n?[n]:null),[n]),f=Object(i.useMemo)((()=>e.type),[e]),{isLoading:g,indexPatterns:b,getExtendedFields:y}=Object(H.a)(m),[h,v]=(()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(te.a)(),[a,r]=Object(ne.a)(),[o,s]=Object(i.useState)(!1),l=Object(i.useRef)(null);return Object(i.useEffect)((()=>{let n=!0;const a=new AbortController;return l.current=async({itemsToUpdate:a})=>{var i,o;if(null!=r)try{s(!0),await r(a),e({title:X,text:(i=a.map((({name:e})=>e)).join(", "),o=a.length,A.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessText",{values:{exceptionItemName:i,numItems:o},defaultMessage:"{numItems, plural, =1 {Exception} other {Exceptions}} - {exceptionItemName} - {numItems, plural, =1 {has} other {have}} been updated."}))}),n&&s(!1)}catch(e){if(n)throw s(!1),t(e,{title:ee}),new Error(e)}},()=>{n=!1,a.abort()}}),[e,t,n,r]),[o||a,l.current]})(),[E,x]=Object(W.a)(),[{exceptionItems:j,exceptionItemMeta:{name:S},newComment:O,commentErrorExists:M,bulkCloseAlerts:F,disableBulkClose:N,bulkCloseIndex:R,entryErrorExists:L,expireTime:q,expireErrorExists:B,wildcardWarningExists:$},de]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:n}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[n[0]]:n[1]}}}case"setComment":{const{comment:n}=t;return{...e,newComment:n}}case"setCommentError":{const{errorExists:n}=t;return{...e,commentErrorExists:n}}case"setBulkCloseAlerts":{const{bulkClose:n}=t;return{...e,bulkCloseAlerts:n}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:n}=t;return{...e,disableBulkClose:n}}case"setBulkCloseIndex":{const{bulkCloseIndex:n}=t;return{...e,bulkCloseIndex:n}}case"setExceptionItems":{const{items:n}=t;return{...e,exceptionItems:n}}case"setConditionValidationErrorExists":{const{errorExists:n}=t;return{...e,entryErrorExists:n}}case"setExpireTime":{const{expireTime:n}=t;return{...e,expireTime:n}}case"setExpireError":{const{errorExists:n}=t;return{...e,expireErrorExists:n}}case"setWildcardWithWrongOperator":{const{warningExists:n}=t;return{...e,wildcardWarningExists:n}}default:return e}}),{exceptionItems:[t],exceptionItemMeta:{name:t.name},newComment:"",commentErrorExists:!1,bulkCloseAlerts:!1,disableBulkClose:!0,bulkCloseIndex:void 0,entryErrorExists:!1,expireTime:void 0!==t.expire_time?C()(t.expire_time):void 0,expireErrorExists:!1,wildcardWarningExists:!1}),pe=Object(i.useMemo)((()=>null==n||!Object(_.b)(n.type)&&!Object(_.n)(n.type)&&!Object(_.f)(n.type)),[n]),[me,fe]=Object(i.useState)($),[ge,be,ye,he]=Object(Q.a)();Object(i.useEffect)((()=>{null!=he&&he([{id:e.id,listId:e.list_id,namespaceType:e.namespace_type}])}),[e,he]);const ve=Object(i.useCallback)((e=>{de({type:"setWildcardWithWrongOperator",warningExists:Object(T.g)(e)}),de({type:"setExceptionItems",items:e})}),[de]),Ee=Object(i.useCallback)((e=>{de({type:"setExceptionItemMeta",value:e})}),[de]),xe=Object(i.useCallback)((e=>{de({type:"setComment",comment:e})}),[de]),je=Object(i.useCallback)((e=>{de({type:"setCommentError",errorExists:e})}),[de]),Se=Object(i.useCallback)((e=>{de({type:"setBulkCloseAlerts",bulkClose:e})}),[de]),Oe=Object(i.useCallback)((e=>{de({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[de]),ke=Object(i.useCallback)((e=>{de({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[de]),we=Object(i.useCallback)((e=>{de({type:"setConditionValidationErrorExists",errorExists:e})}),[de]),Te=Object(i.useCallback)((e=>{de({type:"setExpireTime",expireTime:e})}),[de]),Ie=Object(i.useCallback)((e=>{de({type:"setExpireError",errorExists:e})}),[de]),Me=Object(i.useCallback)((()=>{c(!1)}),[c]),Ce=Object(i.useCallback)((e=>e.every((e=>k.is(e)))),[]),_e=Object(i.useCallback)((async()=>{if(null!=v)try{const i=Object(P.a)({itemName:S,commentToAdd:O,listType:f,selectedOs:t.os_types,expireTime:q,items:j});if(Ce(i)){await v({itemsToUpdate:i});const t=null!=n?[n.rule_id]:[],r=null!=ye?ye[e.list_id].referenced_rules.map((({rule_id:e})=>e)):[],o=f===w.a.RULE_DEFAULT?t:r;null!=x&&!Object(a.isEmpty)(o)&&F&&await x(o,i,void 0,R),u(!0)}}catch(e){c(!1)}}),[v,S,O,f,t.os_types,j,Ce,n,ye,e.list_id,x,F,u,R,c,q]),De=Object(i.useCallback)((()=>{if(!$)return _e();fe(!0)}),[$,_e]),Ae=Object(i.useMemo)((()=>f===w.a.ENDPOINT?Z:J),[f]),Fe=Object(i.useMemo)((()=>h||E||j.every((e=>0===e.entries.length))||g||L||B||M),[g,L,j,h,E,B,M]),Ne=Object(l.useGeneratedHtmlId)({prefix:"exceptionFlyoutTitle"}),Pe=Object(i.useMemo)((()=>{const{title:e,body:t,confirmButton:n,cancelButton:a}=Object(re.a)(f===w.a.ENDPOINT?ae.c:ae.j);return r.a.createElement(oe.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:_e,onCancel:()=>fe(!1),"data-test-subj":"artifactConfirmModal"})}),[f,_e]);return r.a.createElement(l.EuiFlyout,{size:"l",onClose:Me,"data-test-subj":"editExceptionFlyout","aria-labelledby":Ne},r.a.createElement(se,null,r.a.createElement(l.EuiTitle,null,r.a.createElement("h2",{id:Ne,"data-test-subj":"exceptionFlyoutTitle"},Ae)),r.a.createElement(l.EuiSpacer,{size:"m"})),r.a.createElement(le,{className:"builder-section"},g&&r.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingEditExceptionFlyout",lines:4}),r.a.createElement(D.a,{exceptionItemName:S,onChange:Ee}),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(G.a,{exceptionItemName:S,allowLargeValueLists:pe,exceptionListItems:[t],exceptionListType:f,indexPatterns:b,rules:m,selectedOs:p,showOsTypeOptions:f===w.a.ENDPOINT,isEdit:!0,onExceptionItemAdd:ve,onSetErrorExists:we,getExtendedFields:y}),$&&r.a.createElement(I.a,null),!s&&f===w.a.DETECTION&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(z,{isLoadingReferences:ge,errorFetchingReferences:be,listAndReferences:null!=ye?[ye[e.list_id]]:[]})),!s&&f===w.a.RULE_DEFAULT&&null!=n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(V,{rule:n})),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(Y.a,{accordionTitle:r.a.createElement(ue,{size:"xs"},r.a.createElement("h3",null,(Re=null!==(d=t.comments.length)&&void 0!==d?d:0,A.i18n.translate("xpack.securitySolution.ruleExceptions.editExceptionFlyout.commentsTitle",{values:{comments:Re},defaultMessage:"Add comments ({comments})"})))),exceptionItemComments:t.comments,newCommentValue:O,newCommentOnChange:xe,setCommentError:je}),f!==w.a.ENDPOINT&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(ie.a,{expireTime:q,setExpireTime:Te,setExpireError:Ie})),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(U.a,{exceptionListType:f,shouldBulkCloseAlert:F,disableBulkClose:N,exceptionListItems:j,onDisableBulkClose:Oe,onUpdateBulkCloseIndex:ke,onBulkCloseCheckboxChange:Se}))),r.a.createElement(l.EuiFlyoutFooter,null,r.a.createElement(ce,{justifyContent:"spaceBetween"},r.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionEditButton",onClick:Me},K),r.a.createElement(l.EuiButton,{"data-test-subj":"editExceptionConfirmButton",onClick:De,isDisabled:Fe,fill:!0},Ae))),me&&Pe);var Re},pe=r.a.memo(de);pe.displayName="EditExceptionFlyout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b}));var a=n(7),i=n(165),r=n(118),o=n(248),s=n(3),l=n(55);const c=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,u=e=>Object(a.has)(e,"error.type"),d=e=>e.error.root_cause.filter((e=>c(e.type))).map((e=>e.reason));var p=n(545);let m=function(e){return e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL",e}({});const f=(e,t)=>{let n,a=[];return(...i)=>(n&&clearTimeout(n),n=setTimeout((()=>{const t=e(...i);a.forEach((e=>e(t))),a=[]}),t),new Promise((e=>a.push(e))))},g=async(...e)=>{const[{value:t,formData:n}]=e,{query:f}=t,g=f.query,{dataViewId:b,index:y,ruleType:h,eqlOptions:v}=n;if(void 0===h&&!Object(a.isEmpty)(g)||Object(i.b)(h)&&!Object(a.isEmpty)(g))try{const{data:e}=r.b.get();let t=null==y?void 0:y.join(),i={};if(null!=b&&""!==b&&n.dataSourceType===o.a.DataView){const n=await e.dataViews.get(b);t=n.title,i=n.getRuntimeMappings()}const p=(new AbortController).signal,f=await(async({data:e,dataViewTitle:t,query:n,signal:i,runtimeMappings:r,options:o})=>{const{rawResponse:p}=await Object(s.firstValueFrom)(e.search.search({params:{index:t,body:{query:n,runtime_mappings:r,size:0},timestamp_field:null==o?void 0:o.timestampField,tiebreaker_field:(null==o?void 0:o.tiebreakerField)||void 0,event_category_field:null==o?void 0:o.eventCategoryField},options:{ignore:[400]}},{strategy:l.EQL_SEARCH_STRATEGY,abortSignal:i}));if((e=>u(e)&&c(Object(a.get)(e,"error.type")))(p))return{valid:!1,errors:d(p)};if(u(p))throw new Error(JSON.stringify(p));return{valid:!0,errors:[]}})({data:e,query:g,signal:p,dataViewTitle:t,runtimeMappings:i,options:v});if(!1===(null==f?void 0:f.valid))return{code:m.INVALID_EQL,message:"",messages:f.errors}}catch(e){return{code:m.FAILED_REQUEST,message:p.m,error:e}}},b=e=>{const t=e.errors.length>0,n=!e.isChangingValue&&!t;if(t){const[t]=e.errors,a=t.message;return t.code===m.INVALID_EQL?{isValid:n,message:a,messages:t.messages}:{isValid:n,message:a,error:t.error}}return{isValid:n,message:""}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n.n(a),r=n(19);const o=Object(a.memo)((({data:e})=>i.a.createElement(r.EuiText,{size:"s"},Object.entries(e).map((([e,t])=>i.a.createElement("div",{key:e,className:"eui-textBreakAll"},i.a.createElement("strong",null,e),": ",t))))));o.displayName="ObjectContent";const s=Object(a.memo)((({error:e,"data-test-subj":t})=>Object(a.useMemo)((()=>{let n=i.a.createElement(i.a.Fragment,null,e.message);var a,s;return function(e){return e instanceof Error&&"request"in e&&"name"in e}(e)&&(n=i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,`${null===(a=e.response)||void 0===a?void 0:a.status}: ${null===(s=e.response)||void 0===s?void 0:s.statusText}`),e.body&&i.a.createElement(o,{data:e.body}))),i.a.createElement(r.EuiText,{"data-test-subj":t},n)}),[t,e])));s.displayName="FormattedError"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(19),o=n(165);const s=n(4).i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.TechnicalPreviewLabel",{defaultMessage:"Technical Preview"}),l=({label:e})=>i.a.createElement(i.a.Fragment,null,e,i.a.createElement(r.EuiBetaBadge,{label:s,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}));var c=n(208);const u=({label:e,ruleType:t})=>{const n=Object(c.b)("alert_suppression_rule_details");return i.a.createElement(i.a.Fragment,null,t&&Object(o.l)(t)?e:i.a.createElement(l,{label:e}),n&&i.a.createElement(r.EuiToolTip,{position:"top",content:n},i.a.createElement(r.EuiIcon,{type:"warning",size:"l",color:"#BD271E",style:{marginLeft:"8px"},"data-test-subj":"alertSuppressionInsufficientLicensingIcon"})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return B})),n.d(t,"b",(function(){return $}));var a=n(19),i=n(49),r=n(44),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(161),d=n(209),p=n(875),m=n(313),f=n(137),g=n(118),b=n(130),y=n(937),h=n(351),v=n(367),E=n(181),x=n(340),j=n(144),S=n(314),O=n(201),k=n(862),w=n(196),T=n(735),I=n(505),M=n(334),C=n(4);const _=C.i18n.translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Endpoint integration policy"}),D=C.i18n.translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Policy Status"}),A=C.i18n.translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Endpoint version"}),F=C.i18n.translate("xpack.securitySolution.host.details.endpoint.fleetAgentStatus",{defaultMessage:"Agent status"});var N=n(1322);const P=s.a.memo((({contextID:e,data:t,scopeId:n})=>{const i=Object(o.useCallback)(((t,a,i)=>s.a.createElement(h.a,{rowItems:[Object(r.getOr)("",t,a)],attrName:i,idPrefix:e?`endpoint-overview-${e}`:"endpoint-overview",scopeId:n})),[e,n]),l=Object(o.useMemo)((()=>{var e,n,r;const o=null==t||null===(e=t.hostInfo)||void 0===e?void 0:e.metadata.Endpoint.policy.applied;return[[{title:_,description:null!==(n=null==o?void 0:o.name)&&void 0!==n?n:Object(b.d)()}],[{title:D,description:null!=o&&o.status?s.a.createElement(a.EuiHealth,{"aria-label":null==o?void 0:o.status,color:(null==o?void 0:o.status)===N.a.failure?"danger":null==o?void 0:o.status},null==o?void 0:o.status):Object(b.d)()}],[{title:A,description:null!=t&&null!==(r=t.hostInfo)&&void 0!==r&&r.metadata.agent.version?i("hostInfo.metadata.agent.version",t,"agent.version"):Object(b.d)()}],[{title:F,description:null!=t&&t.hostInfo?s.a.createElement(I.a,{agentId:t.hostInfo.metadata.agent.id,agentType:"endpoint"}):Object(b.d)()}]]}),[t,i]);return s.a.createElement(s.a.Fragment,null,l.map(((e,t)=>s.a.createElement(M.a,{dataTestSubj:"endpoint-overview",descriptionList:e,key:t}))))}));P.displayName="EndpointOverview";var R=n(226),L=n(521),z=n(357);const q=c()(a.EuiFlexGroup).withConfig({displayName:"HostRiskOverviewWrapper",componentId:"sc-p9r0sg-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),B="riskInputsTabQuery",$=s.a.memo((({anomaliesData:e,contextID:t,scopeId:n,data:l,endDate:c,id:I,isDraggable:C=!1,isInDetailsSidePanel:_=!1,isLoadingAnomaliesData:D,indexNames:A,loading:F,narrowDateRange:N,startDate:$,hostName:V,jobNameById:U})=>{const G=Object(O.a)(),H=Object(S.a)(G),W=Object(g.g)(),Q=Object(o.useMemo)((()=>V?Object(f.z)([V]):void 0),[V]),{deleteQuery:Y,setQuery:K}=Object(u.a)(),{data:J,isAuthorized:Z,inspect:X,loading:ee,refetch:te}=Object(m.a)({filterQuery:Q,riskEntity:f.t.host,skip:null==V,onlyLatest:!1,pagination:p.a});Object(d.b)({deleteQuery:Y,inspect:X,loading:ee,queryId:B,refetch:te,setQuery:K});const ne=Object(o.useCallback)(((e,a)=>s.a.createElement(h.a,{rowItems:Object(r.getOr)([],e,a),attrName:e,idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:C,scopeId:n})),[t,C,n]),[ae,ie]=Object(o.useMemo)((()=>{const e=J&&J.length>0?J[0]:void 0;return[{title:s.a.createElement(L.a,{title:T.g,riskScoreEntity:f.t.host}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.host.risk.calculated_score_norm):Object(b.d)())},{title:s.a.createElement(a.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(L.a,{title:T.f,riskScoreEntity:f.t.host})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(z.a,{anchorPosition:"upCenter"}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(R.a,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(b.d)())}]}),[J]),re=Object(o.useMemo)((()=>[{title:T.e,description:l&&l.host?Object(y.c)({host:l.host,isDraggable:C,noLink:!0}):Object(b.d)()},{title:T.d,description:s.a.createElement(v.a,{indexPatterns:A,field:"host.name",value:V,type:v.b.FIRST_SEEN})},{title:T.k,description:s.a.createElement(v.a,{indexPatterns:A,field:"host.name",value:V,type:v.b.LAST_SEEN})}]),[l,A,V,C]),oe=Object(o.useMemo)((()=>H?[...re,{title:T.n,description:s.a.createElement(k.a,{anomalies:e,startDate:$,endDate:c,isLoading:D,narrowDateRange:N,jobNameById:U})}]:re),[e,re,c,D,N,$,H,U]),se=Object(o.useMemo)((()=>[oe,[{title:T.j,description:s.a.createElement(h.a,{rowItems:Object(r.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`host-overview-${t}`:"host-overview",scopeId:n,isDraggable:C,render:e=>null!=e?s.a.createElement(j.h,{ip:e}):Object(b.d)()})},{title:T.m,description:ne("host.mac",l)},{title:T.p,description:ne("host.os.platform",l)}],[{title:T.o,description:ne("host.os.name",l)},{title:T.c,description:ne("host.os.family",l)},{title:T.r,description:ne("host.os.version",l)},{title:T.a,description:ne("host.architecture",l)}],[{title:T.b,description:ne("cloud.provider",l)},{title:T.q,description:ne("cloud.region",l)},{title:T.i,description:ne("cloud.instance.id",l)},{title:T.l,description:ne("cloud.machine.type",l)}]]),[t,n,l,oe,ne,C]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(E.c,null,s.a.createElement(w.g,{direction:_?"column":"row","data-test-subj":"host-overview"},!_&&s.a.createElement(E.b,{queryId:I,title:T.h,inspectIndex:0}),se.map(((e,t)=>s.a.createElement(M.a,{descriptionList:e,key:t}))),F&&s.a.createElement(x.a,{overlay:!0,overlayBackground:W?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),Z&&s.a.createElement(q,{gutterSize:_?"m":"none",direction:_?"column":"row","data-test-subj":"host-risk-overview",$width:_?"100%":"50%"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(w.d,{listItems:[ae]})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(w.d,{listItems:[ie]}))),l&&null!=l.endpoint?s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiHorizontalRule,null),s.a.createElement(w.g,{direction:_?"column":"row"},s.a.createElement(P,{contextID:t,data:l.endpoint,scopeId:n}),F&&s.a.createElement(x.a,{overlay:!0,overlayBackground:W?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))):null)}));$.displayName="HostOverview"},function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return j}));var a=n(2),i=n.n(a),r=n(4),o=n(19),s=n(1213),l=n(297),c=n(845),u=n(126),d=n(783),p=n(587),m=n(118),f=n(259),g=n(843),b=n(140),y=n(451),h=n(361),v=n(487);const E=Object.freeze({flyoutEditTitle:r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditTitle",{defaultMessage:"Add artifact"}),flyoutCreateTitle:r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateTitle",{defaultMessage:"Create artifact"}),flyoutCancelButtonLabel:r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),flyoutCreateSubmitButtonLabel:r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add"}),flyoutEditSubmitButtonLabel:r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitButtonLabel",{defaultMessage:"Save"}),flyoutDowngradedLicenseTitle:r.i18n.translate("xpack.securitySolution.artifactListPage.expiredLicenseTitle",{defaultMessage:"Expired License"}),flyoutDowngradedLicenseInfo:r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseInfo",{defaultMessage:"Your Kibana license has been downgraded. Future policy configurations will now be globally assigned to all policies."}),flyoutDowngradedLicenseDocsInfo:e=>r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseDocsInfo",{defaultMessage:"For more information, see our documentation."}),flyoutEditItemLoadFailure:e=>r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditItemLoadFailure",{defaultMessage:"Failed to retrieve item for edit. Reason: {errorMessage}",values:{errorMessage:e}}),flyoutCreateSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.some_page.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}})}),x=(e,t)=>({isValid:!1,item:null!=t?t:Object(f.a)(e)}),j=Object(a.memo)((({apiClient:e,item:t,policies:n,policiesIsLoading:r,FormComponent:f,onSuccess:j,onClose:S,submitHandler:O,labels:k={},"data-test-subj":w,size:T="m"})=>{var I,M;const{docLinks:{links:{securitySolution:C}}}=Object(m.j)().services,_=Object(u.a)(w),D=Object(m.n)(),A=Object(c.a)(),F=Object(d.a)(),{urlParams:N}=Object(l.a)(),P=Object(s.a)(),R=Object(a.useMemo)((()=>({...E,...k})),[k]),[L,z]=Object(a.useState)(!1),[q,B]=Object(a.useState)(void 0),[$,V]=Object(a.useState)(!1),U="edit"===N.show,G=U?"edit":"create",{isLoading:H,mutateAsync:W,error:Q}=Object(g.a)(e,G),Y=Object(a.useMemo)((()=>O?L:H),[L,H,O]),K=Object(a.useMemo)((()=>O?q:Q),[q,Q,O]),{isRefetching:J,error:Z,refetch:X}=Object(h.d)(e,null!==(I=N.itemId)&&void 0!==I?I:"",void 0,{enabled:!1}),[ee,te]=Object(a.useState)(x.bind(null,e.listId,t)),ne=((e,t)=>{const n=Object(b.a)().endpointPrivileges;return Object(a.useMemo)((()=>"edit"===t&&!n.canCreateArtifactsByPolicy&&Object(y.e)(e)),[n.canCreateArtifactsByPolicy,e,t])})({tags:null!==(M=ee.item.tags)&&void 0!==M?M:[]},G),ae=Object(a.useMemo)((()=>!!t||!!ee.item.item_id),[ee.item.item_id,t]),ie=Object(a.useMemo)((()=>U&&!ae),[ae,U]),re=Object(a.useCallback)((()=>{Y||(F({...N,itemId:void 0,show:void 0},!0),S())}),[Y,S,F,N]),oe=Object(a.useCallback)((({item:e,isValid:t,confirmModalLabels:n})=>{P()&&te({item:e,isValid:t,confirmModalLabels:n})}),[P]),se=Object(a.useCallback)((e=>{D.addSuccess(U?R.flyoutEditSubmitSuccess(e):R.flyoutCreateSubmitSuccess(e)),P()&&(F({...N,itemId:void 0,show:void 0},!0),j())}),[U,P,R,j,F,D,N]),le=Object(a.useCallback)((()=>{O?(z(!0),O(ee.item,G).then(se).catch((e=>{P()&&B(e)})).finally((()=>{P()&&z(!1)}))):ee.confirmModalLabels?V(!0):W(ee.item).then(se)}),[G,ee.item,ee.confirmModalLabels,se,P,W,O]),ce=Object(a.useCallback)((()=>W(ee.item).then(se)),[W,ee.item,se]),ue=Object(a.useMemo)((()=>{if(ee.confirmModalLabels){const{title:e,body:t,confirmButton:n,cancelButton:a}=ee.confirmModalLabels;return i.a.createElement(v.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:ce,onCancel:()=>V(!1),"data-test-subj":"artifactConfirmModal"})}}),[ee,ce]);Object(a.useEffect)((()=>{!U||ae||Z||!ie||J||X().then((({data:t})=>{t&&P()&&te(x(e.listId,t))}))}),[e.listId,Z,X,U,ie,J,ae,P]),Object(a.useEffect)((()=>{var e;U&&Z&&(D.addWarning(R.flyoutEditItemLoadFailure((null==Z||null===(e=Z.body)||void 0===e?void 0:e.message)||Z.message)),F({itemId:void 0,show:void 0}))}),[Z,U,R,F,D,N.itemId]);const de=Object(o.useGeneratedHtmlId)({prefix:"artifactFlyoutTitle"});return!A||Z?null:i.a.createElement(o.EuiFlyout,{size:T,onClose:re,"data-test-subj":w,"aria-labelledby":de},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(o.EuiTitle,{size:"m"},i.a.createElement("h2",{id:de},U?R.flyoutEditTitle:R.flyoutCreateTitle))),!ie&&ne&&i.a.createElement(o.EuiCallOut,{title:R.flyoutDowngradedLicenseTitle,color:"warning",iconType:"help","data-test-subj":_("expiredLicenseCallout")},R.flyoutDowngradedLicenseInfo," ",R.flyoutDowngradedLicenseDocsInfo(C)),i.a.createElement(o.EuiFlyoutBody,null,ie&&i.a.createElement(p.a,{"data-test-subj":_("loader")}),!ie&&i.a.createElement(f,{onChange:oe,disabled:Y,item:ee.item,error:null!=K?K:void 0,mode:G,policies:n,policiesIsLoading:r})),!ie&&i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{"data-test-subj":_("cancelButton"),onClick:re,disabled:Y},R.flyoutCancelButtonLabel)),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButton,{"data-test-subj":_("submitButton"),fill:!0,disabled:!ee.isValid||Y,onClick:le,isLoading:Y},U?R.flyoutEditSubmitButtonLabel:R.flyoutCreateSubmitButtonLabel)))),$&&ue)}));j.displayName="ArtifactFlyout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);a.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),a.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),a.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const i="siem"},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return y})),n(779),n(596),n(598),n(600);var a=n(599),i=(n(601),n(2)),r=n(1314),o=n(1491),s=n(7),l=n(245),c=n(270),u=n(5),d=n(118),p=n(627),m=n(884),f=n(221),g=n(588);const b={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},y=e=>{const t=Object(d.n)(),{services:n}=Object(d.j)(),{http:a,notifications:y}=n,{navigateToApp:h}=n.application,{exportExceptionList:v,deleteExceptionList:E,duplicateExceptionList:x}=Object(o.a)(a),[{loading:j,canUserCRUD:S,canUserREAD:O}]=Object(c.b)(),[k,w]=Object(i.useState)(),[T,I]=Object(i.useState)(!1),[M,C]=Object(i.useState)(),[_,D]=Object(i.useState)(!1),[A,F]=Object(i.useState)([]),[N,P]=Object(i.useState)([]),[R,L]=Object(i.useState)(!0),[z,q]=Object(i.useState)(""),[B,$]=Object(i.useState)(),[V,U]=Object(i.useState)(!1),[G,H]=Object(i.useState)(b),[W,Q]=Object(i.useState)(!0),[Y,K]=Object(i.useState)(!1),J=Object(g.b)(),Z=Object(i.useMemo)((()=>({pageId:u.Oc.exceptions,path:"",onNavigate:()=>{h(u.m,{deepLinkId:u.Oc.exceptions,path:""})}})),[h]),X=Object(i.useCallback)(((e,n,a,i)=>{null==t||t.addError(e,{title:null!=a?a:"",toastMessage:null!=i?i:""}),q(null!=n?n:"")}),[t]),ee=Object(i.useCallback)((async e=>{const t=await Object(p.e)(e.list_id);F(t)}),[]),te=Object(i.useCallback)((async()=>{try{if(l.a.includes(e))return D(!0);w(!0);const t=await Object(p.d)({id:e,http:a});if(!t||!Object(m.b)(t))return w(!1),D(!0);if(C(t),await ee(t),w(!1),D(!1),Object(m.a)(t))return L(!1)}catch(e){X(e,r.a.ERROR,f.q,f.p)}}),[e,a,ee,X]);Object(i.useEffect)((()=>{te()}),[te]);const[ne,ae]=Object(i.useState)(!1),ie=Object(i.useCallback)((async t=>{try{var n;M&&await Object(p.i)({http:a,list:{id:M.id,list_id:e,type:M.type,name:t.name,description:null!==(n=t.description)&&void 0!==n?n:"",namespace_type:M.namespace_type}})}catch(e){X(e)}}),[e,X,a,M]),re=Object(i.useCallback)((async e=>{try{if(!M)return;await v({id:M.id,listId:M.list_id,includeExpiredExceptions:e,namespaceType:M.namespace_type,onError:e=>X(e),onSuccess:e=>{$(e),null==t||t.addSuccess(f.C(M.name))}})}catch(e){X(e,void 0,f.r,f.s)}}),[M,v,X,t]),oe=Object(i.useCallback)((async e=>{try{if(!M)return;await x({listId:M.list_id,includeExpiredExceptions:e,namespaceType:M.namespace_type,onError:e=>X(e),onSuccess:e=>{null==t||t.addSuccess(f.v(M.name)),h(u.m,{deepLinkId:u.Oc.exceptions,path:`/details/${e.list_id}`})}})}catch(e){X(e,void 0,f.n,f.o)}}),[M,x,X,t,h]),se=Object(i.useCallback)((()=>{$(void 0)}),[]),le=Object(i.useCallback)((e=>()=>{y.toasts.addSuccess({title:f.ob(null!=e?e:G.listId)})}),[y.toasts,G.listId]),ce=Object(i.useCallback)((e=>{X(e)}),[X]),ue=Object(i.useCallback)((async()=>{try{if(!M)return;await E({id:M.id,namespaceType:M.namespace_type,onError:ce,onSuccess:le})}catch(e){X(e)}finally{H(b),U(!1),h(u.m,{deepLinkId:u.Oc.exceptions,path:""})}}),[M,E,ce,le,X,h]),de=Object(i.useCallback)((()=>{try{if(!M)return;H({contentText:A.length?f.qb(A.length):f.nb(M.name),rulesReferences:A.map((({name:e})=>e)),isLoading:!0,listId:M.list_id,listNamespaceType:M.namespace_type}),U(!0)}catch(e){X(e)}}),[X,A,M]),pe=Object(i.useCallback)((()=>{U(!1),H({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),me=Object(i.useCallback)((async()=>{try{await Object(p.h)({rules:A,listId:e}),ue()}catch(e){X(e)}}),[e,A,X,ue]),fe=Object(i.useCallback)((()=>{F(N),P(N),ae(!1),I(!1),Q(!0)}),[N]),ge=Object(i.useCallback)((()=>{ae(!0)}),[]),be=Object(i.useCallback)((()=>N.filter((e=>!A.includes(e)))),[A,N]),ye=Object(i.useCallback)((()=>A.filter((e=>!N.includes(e)))),[A,N]),he=Object(i.useCallback)((e=>{P(e),Q(!1)}),[]),ve=Object(i.useCallback)((async()=>{try{if(!M)return ae(!1);I(!0);const t=be(),n=ye();if(!t.length&&!n.length||Object(s.isEqual)(t,n))return fe();Promise.all([Object(p.h)({rules:n,listId:e}),Object(p.f)({rules:t,listId:e,id:M.id,listType:M.type,listNamespaceType:M.namespace_type})]).then((()=>{K(!0),fe()})).then((()=>K(!1))).then((()=>J())).catch((e=>{X(e,void 0,f.E,f.F),I(!1)})).finally((()=>{te()}))}catch(e){X(e)}}),[M,be,ye,fe,e,J,X,te]),Ee=Object(i.useCallback)((()=>{ae(!1)}),[]);return{isLoading:k||j,invalidListId:_,isReadOnly:!(S||!O),list:M,listName:null==M?void 0:M.name,listDescription:null==M?void 0:M.description,listId:e,canUserEditList:R,linkedRules:A,exportedList:B,handleOnDownload:se,viewerStatus:z,showManageRulesFlyout:ne,headerBackOptions:Z,referenceModalState:G,showReferenceErrorModal:V,showManageButtonLoader:T,refreshExceptions:Y,disableManageButton:W,handleDelete:de,onDuplicateList:oe,onEditListDetails:ie,onExportList:re,onDeleteList:ue,onManageRules:ge,onSaveManageRules:ve,onCancelManageRules:Ee,onRuleSelectionChange:he,handleCloseReferenceErrorModal:pe,handleReferenceDelete:me}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(46),i=n(802),r=n(750),o=n(801),s=n(876),l=n(1371),c=n(403);const u=a.exact(a.type({field:l.a,operator:c.c,type:a.keyof({wildcard:null}),value:l.a}));var d=n(1282);const p=a.union([o.a,s.a,r.a,i.a,u]),m=a.array(a.union([o.a,s.a,r.a,i.a,d.a,u]));a.union([m,a[void 0]])},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.bind=t.bindTo=t.getRefinement=t.exists=t.elem=t.option=t.MonadThrow=t.Witherable=t.Traversable=t.Filterable=t.Compactable=t.Extend=t.Alternative=t.Alt=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getMonoid=t.getLastMonoid=t.getFirstMonoid=t.getApplyMonoid=t.getApplySemigroup=t.getOrd=t.getEq=t.getShow=t.URI=t.wilt=t.wither=t.sequence=t.traverse=t.partitionMap=t.partition=t.filterMap=t.filter=t.separate=t.compact=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.throwError=t.zero=t.alt=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.mapNullable=t.getOrElse=t.getOrElseW=t.toUndefined=t.toNullable=t.fold=t.fromEither=t.getRight=t.getLeft=t.tryCatch=t.fromPredicate=t.fromNullable=t.some=t.none=t.isNone=t.isSome=void 0;var a=n(269);function i(e){return null==e?t.none:t.some(e)}function r(e){return"Right"===e._tag?t.none:t.some(e.left)}function o(e){return"Left"===e._tag?t.none:t.some(e.right)}t.isSome=function(e){return"Some"===e._tag},t.isNone=function(e){return"None"===e._tag},t.none={_tag:"None"},t.some=function(e){return{_tag:"Some",value:e}},t.fromNullable=i,t.fromPredicate=function(e){return function(n){return e(n)?t.some(n):t.none}},t.tryCatch=function(e){try{return t.some(e())}catch(e){return t.none}},t.getLeft=r,t.getRight=o,t.fromEither=function(e){return"Left"===e._tag?t.none:t.some(e.right)},t.fold=function(e,n){return function(a){return t.isNone(a)?e():n(a.value)}},t.toNullable=function(e){return t.isNone(e)?null:e.value},t.toUndefined=function(e){return t.isNone(e)?void 0:e.value},t.getOrElseW=function(e){return function(n){return t.isNone(n)?e():n.value}},t.getOrElse=t.getOrElseW,t.mapNullable=function(e){return function(n){return t.isNone(n)?t.none:i(e(n.value))}};var s=function(e,n){return a.pipe(e,t.map(n))},l=function(e,n){return a.pipe(e,t.ap(n))},c=function(e,n){return a.pipe(e,t.chain(n))},u=function(e,n,i){return a.pipe(e,t.reduce(n,i))},d=function(e){var n=t.foldMap(e);return function(e,t){return a.pipe(e,n(t))}},p=function(e,n,i){return a.pipe(e,t.reduceRight(n,i))},m=function(e){var n=t.traverse(e);return function(e,t){return a.pipe(e,n(t))}},f=function(e,n){return a.pipe(e,t.alt(n))},g=function(e,n){return a.pipe(e,t.filter(n))},b=function(e,n){return a.pipe(e,t.filterMap(n))},y=function(e,n){return a.pipe(e,t.extend(n))},h=function(e,n){return a.pipe(e,t.partition(n))},v=function(e,n){return a.pipe(e,t.partitionMap(n))},E=function(e){var n=t.wither(e);return function(e,t){return a.pipe(e,n(t))}},x=function(e){var n=t.wilt(e);return function(e,t){return a.pipe(e,n(t))}};t.map=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n.value))}},t.ap=function(e){return function(n){return t.isNone(n)||t.isNone(e)?t.none:t.some(n.value(e.value))}},t.apFirst=function(e){return a.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return a.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=t.some,t.chain=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.chainFirst=function(e){return t.chain((function(n){return a.pipe(e(n),t.map((function(){return n})))}))},t.flatten=t.chain(a.identity),t.alt=function(e){return function(n){return t.isNone(n)?e():n}},t.zero=function(){return t.none},t.throwError=function(){return t.none},t.extend=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n))}},t.duplicate=t.extend(a.identity),t.reduce=function(e,n){return function(a){return t.isNone(a)?e:n(e,a.value)}},t.foldMap=function(e){return function(n){return function(a){return t.isNone(a)?e.empty:n(a.value)}}},t.reduceRight=function(e,n){return function(a){return t.isNone(a)?e:n(a.value,e)}},t.compact=t.flatten;var j={left:t.none,right:t.none};function S(e){return{equals:function(n,a){return n===a||(t.isNone(n)?t.isNone(a):!t.isNone(a)&&e.equals(n.value,a.value))}}}function O(e){return{concat:function(n,a){return t.isSome(n)&&t.isSome(a)?t.some(e.concat(n.value,a.value)):t.none}}}t.separate=function(e){var n=a.pipe(e,t.map((function(e){return{left:r(e),right:o(e)}})));return t.isNone(n)?j:n.value},t.filter=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)?n:t.none}},t.filterMap=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.partition=function(e){return function(n){return{left:a.pipe(n,t.filter((function(t){return!e(t)}))),right:a.pipe(n,t.filter(e))}}},t.partitionMap=function(e){return function(n){return t.separate(a.pipe(n,t.map(e)))}},t.traverse=function(e){return function(n){return function(a){return t.isNone(a)?e.of(t.none):e.map(n(a.value),t.some)}}},t.sequence=function(e){return function(n){return t.isNone(n)?e.of(t.none):e.map(n.value,t.some)}},t.wither=function(e){return function(n){return function(a){return t.isNone(a)?e.of(t.none):n(a.value)}}},t.wilt=function(e){return function(n){return function(i){var s=a.pipe(i,t.map((function(t){return e.map(n(t),(function(e){return{left:r(e),right:o(e)}}))})));return t.isNone(s)?e.of({left:t.none,right:t.none}):s.value}}},t.URI="Option",t.getShow=function(e){return{show:function(n){return t.isNone(n)?"none":"some("+e.show(n.value)+")"}}},t.getEq=S,t.getOrd=function(e){return{equals:S(e).equals,compare:function(n,a){return n===a?0:t.isSome(n)?t.isSome(a)?e.compare(n.value,a.value):1:-1}}},t.getApplySemigroup=O,t.getApplyMonoid=function(e){return{concat:O(e).concat,empty:t.some(e.empty)}},t.getFirstMonoid=function(){return{concat:function(e,n){return t.isNone(e)?n:e},empty:t.none}},t.getLastMonoid=function(){return{concat:function(e,n){return t.isNone(n)?e:n},empty:t.none}},t.getMonoid=function(e){return{concat:function(n,a){return t.isNone(n)?a:t.isNone(a)?n:t.some(e.concat(n.value,a.value))},empty:t.none}},t.Functor={URI:t.URI,map:s},t.Applicative={URI:t.URI,map:s,ap:l,of:t.of},t.Monad={URI:t.URI,map:s,ap:l,of:t.of,chain:c},t.Foldable={URI:t.URI,reduce:u,foldMap:d,reduceRight:p},t.Alt={URI:t.URI,map:s,alt:f},t.Alternative={URI:t.URI,map:s,ap:l,of:t.of,alt:f,zero:t.zero},t.Extend={URI:t.URI,map:s,extend:y},t.Compactable={URI:t.URI,compact:t.compact,separate:t.separate},t.Filterable={URI:t.URI,map:s,compact:t.compact,separate:t.separate,filter:g,filterMap:b,partition:h,partitionMap:v},t.Traversable={URI:t.URI,map:s,reduce:u,foldMap:d,reduceRight:p,traverse:m,sequence:t.sequence},t.Witherable={URI:t.URI,map:s,reduce:u,foldMap:d,reduceRight:p,traverse:m,sequence:t.sequence,compact:t.compact,separate:t.separate,filter:g,filterMap:b,partition:h,partitionMap:v,wither:E,wilt:x},t.MonadThrow={URI:t.URI,map:s,ap:l,of:t.of,chain:c,throwError:t.throwError},t.option={URI:t.URI,map:s,of:t.of,ap:l,chain:c,reduce:u,foldMap:d,reduceRight:p,traverse:m,sequence:t.sequence,zero:t.zero,alt:f,extend:y,compact:t.compact,separate:t.separate,filter:g,filterMap:b,partition:h,partitionMap:v,wither:E,wilt:x,throwError:t.throwError},t.elem=function(e){return function(n,a){return!t.isNone(a)&&e.equals(n,a.value)}},t.exists=function(e){return function(n){return!t.isNone(n)&&e(n.value)}},t.getRefinement=function(e){return function(n){return t.isSome(e(n))}},t.bindTo=function(e){return t.map(a.bindTo_(e))},t.bind=function(e,n){return t.chain((function(i){return a.pipe(n(i),t.map((function(t){return a.bind_(i,e,t)})))}))},t.apS=function(e,n){return a.flow(t.map((function(t){return function(n){return a.bind_(t,e,n)}})),t.ap(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(46),i=n(2070),r=n(345),o=n(456),s=n(275),l=n(400),c=n(397),u=n(398),d=n(214),p=n(457),m=n(800),f=n(401),g=n(402),b=n(255),y=n(399),h=n(506),v=n(1334),E=n(507);const x=a.exact(a.type({_version:r.b,created_at:c.a,created_by:u.a,description:y.a,id:d.a,immutable:m.a,list_id:b.a,meta:s.b,name:l.a,namespace_type:o.a,os_types:h.b,tags:E.a,tie_breaker_id:p.a,type:v.b,updated_at:f.a,updated_by:g.a,version:i.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=a.boolean;a.union([i,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),i=n(1371),r=n(403);const o=a.exact(a.type({field:i.a,operator:r.c,type:a.keyof({match:null}),value:i.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),i=n(1371),r=n(403);const o=a.exact(a.type({field:i.a,operator:r.c,type:a.keyof({exists:null})}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(41),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(223);const c=i()(s.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-g8lc0e-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);c.displayName="StaticSwitch";const u=({job:e,isSecurityJobsLoading:t,onJobStateChange:n})=>{const[a,i]=Object(r.useState)(!1),u=Object(r.useCallback)((async t=>{i(!0),await n(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,n]);return o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceAround"},o.a.createElement(s.EuiFlexItem,{grow:!1},t||a||Object(l.b)(e.jobState,e.datafeedState)?o.a.createElement(s.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):o.a.createElement(c,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:u,showLabel:!1,label:""})))};u.displayName="JobSwitchComponent";const d=o.a.memo(u);d.displayName="JobSwitch"},function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,n){"use strict";var a="%[a-f0-9]{2}",i=new RegExp("("+a+")|([^%]+?)","gi"),r=new RegExp("("+a+")+","gi");function o(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],o(n),o(a))}function s(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(i)||[],n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(i)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var a=s(n[0]);a!==n[0]&&(t[n[0]]=a)}n=r.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),o=0;o<i.length;o++){var l=i[o];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(462));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=r.default(e,t),o=a[0],s=a[1],l=a[2];return i.useEffect(l,n),[o,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(154),r=a.__importDefault(n(461));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154);t.default=function(e,t,n){if(!i.isClient)return[t,function(){}];var r=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,n?String(t):JSON.stringify(t)),t):n?a:JSON.parse(a||"null")}catch(e){return t}})),o=r[0],s=r[1];return a.useEffect((function(){try{var t=n?String(o):JSON.stringify(o);sessionStorage.setItem(e,t)}catch(e){}})),[o,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(273),i=n(1275),r=n(26);const o=`${r.c}: true`,s=`${r.c}: false`,l=`${r.a}: true`,c=`${r.a}: false`;function u({filter:e,showCustomRules:t,showElasticRules:n,enabled:u,tags:p,excludeRuleTypes:m=[],ruleExecutionStatus:f}){const g=[];var b;return null!=e&&e.length&&g.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(i.b)(e)}`)).join(" OR ")}(e)})`),t&&n||(n?g.push(o):t&&g.push(s)),void 0!==u&&g.push(u?l:c),null!=p&&p.length&&g.push(function(e){return`${r.g}:(${e.map(i.b).join(" AND ")})`}(p)),m.length&&g.push("NOT "+(b=m,`${r.d}: (${b.map(i.b).join(" OR ")})`)),f===a.f.succeeded?g.push(`${r.b}: "succeeded"`):f===a.f["partial failure"]?g.push(`${r.b}: "warning"`):f===a.f.failed&&g.push(`${r.b}: "failed"`),g.join(" AND ")}const d=[r.e,r.f.INDEX,r.f.TACTIC_ID,r.f.TACTIC_NAME,r.f.TECHNIQUE_ID,r.f.TECHNIQUE_NAME,r.f.SUBTECHNIQUE_ID,r.f.SUBTECHNIQUE_NAME]},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return E})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return j})),n.d(t,"p",(function(){return S})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return k})),n.d(t,"s",(function(){return w})),n.d(t,"t",(function(){return A})),n.d(t,"u",(function(){return D})),n.d(t,"v",(function(){return M})),n.d(t,"w",(function(){return _})),n.d(t,"x",(function(){return I})),n.d(t,"y",(function(){return C})),n.d(t,"z",(function(){return F})),n.d(t,"A",(function(){return N})),n.d(t,"C",(function(){return P})),n.d(t,"B",(function(){return R})),n.d(t,"D",(function(){return i})),n.d(t,"E",(function(){return r})),n.d(t,"F",(function(){return o})),n.d(t,"G",(function(){return s}));var a=n(748);const i="ecs.version",r="event.action",o="event.kind",s="tags",l=`${a.k}.risk_score`,c=`${a.s}.author`,u=`${a.s}.created_at`,d=`${a.s}.created_by`,p=`${a.s}.description`,m=`${a.s}.enabled`,f=`${a.s}.from`,g=`${a.s}.interval`,b=`${a.s}.license`,y=`${a.s}.note`,h=`${a.s}.references`,v=`${a.s}.rule_id`,E=`${a.s}.rule_name_override`,x=`${a.s}.to`,j=`${a.s}.type`,S=`${a.s}.updated_at`,O=`${a.s}.updated_by`,k=`${a.s}.version`,w=`${a.k}.severity`,T=`${a.k}.suppression`,I=`${T}.terms`,M=`${I}.field`,C=`${I}.value`,_=`${T}.start`,D=`${T}.end`,A=`${T}.docs_count`,F=`${a.k}.system_status`,N=`${a.k}.workflow_reason`,P=`${a.k}.workflow_user`,R=`${a.k}.workflow_status_updated_at`},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(45),r=n(166);const o=e=>{const t=Object(i.useSelector)(r.d.kibanaDataViews),n=Object(i.useSelector)((t=>r.d.sourcererScopeSelectedDataViewId(t,e))),o=Object(a.useMemo)((()=>t.find((e=>e.id===n))),[t,n]);return Object(a.useCallback)((e=>{const t=null==o?void 0:o.fields;return t&&t[e]}),[null==o?void 0:o.fields])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(19),i=n(2),r=n.n(i),o=n(163),s=n(951);const l=r.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:i})=>r.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},r.a.createElement(s.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:o.G}))));l.displayName="OpenTimelineModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"c",(function(){return $})),n.d(t,"b",(function(){return V}));var a=n(44),i=n(54),r=n.n(i),o=n(63),s=n.n(o),l=n(53),c=n(4),u=n(813),d=n(748),p=n(3),m=n(572),f=n(165),g=n(146),b=n(121),y=n(1246),h=n(158),v=n(184),E=n(250),x=n(131),j=n(718),S=n(292),O=n(118),k=n(5),w=n(1253),T=n(396);n(479);const I=({ecs:e})=>{if(Array.isArray(e)){const t=e.reduce(((e,t)=>{const n=t.timestamp?new Date(t.timestamp):new Date;return e.includes(n.valueOf())?e:[...e,n.valueOf()]}),[]);return{from:new Date(Math.min(...t)).toISOString(),to:new Date(Math.max(...t)).toISOString()}}const t=e,n=Object(x.getField)(t,u.g),a=r.a.duration(r()().diff(s.a.parse(null!=n?n[0]:"now-1d"))),i=Object(x.getField)(t,d.K),o=Array.isArray(i)?i[0]:i,l=r()(null!=o?o:new Date).toISOString();return{to:l,from:r()(l).subtract(a).toISOString()}},M=e=>{const t=Object(x.getField)(e,u.o);return Array.isArray(t)?t[0]:t},C=e=>Object(f.f)(M(e)),_=e=>Object(f.d)(M(e)),D=e=>Object(f.b)(M(e)),A=e=>Object(f.n)(M(e)),F=e=>Object(f.e)(M(e)),N=e=>null!=Object(x.getField)(e,u.t),P=(e,t,n="Alert Ids")=>1===t.length?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:e,params:{query:t[0]}},query:{match_phrase:{_id:t[0]}},$state:{store:l.FilterStateStore.APP_STATE}}]:[{query:{bool:{filter:{ids:{values:t}}}},meta:{alias:n,negate:!1,disabled:!1,type:"phrases",key:e,value:t.join(),params:t},$state:{store:l.FilterStateStore.APP_STATE}}],R=(e,t)=>{const n=1===t.length;return[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-alert-id-${t.join(",")}`,name:t.join(","),enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:n?t[0]:t,operator:n?":":"includes"}}]},L=(e,t,n)=>({filters:"KqlFilter"===t?P("_id",e,n):[],dataProviders:"dataProvider"===t?R("_id",e):[]}),z=async(e,t,n,a,i)=>{try{var o,l,p,f,b,y,v,E,j,S,I,M,C,_,D,A,F,N,P,R,L,z;const c=await O.b.get().http.fetch(k.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(w.a)([e._id]))}),T=(null!==(o=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(w.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==o?o:[])[0],q=Object(x.getField)(T,d.t),B=Object(x.getField)(T,u.d),$=(null!==(l=null!==(p=q.filters)&&void 0!==p?p:null===(f=T.signal)||void 0===f||null===(b=f.rule)||void 0===b?void 0:b.filters)&&void 0!==l?l:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),V=null!==(y=null!==(v=q.language)&&void 0!==v?v:null===(E=T.signal)||void 0===E||null===(j=E.rule)||void 0===j?void 0:j.language)&&void 0!==y?y:"kuery",U=null!==(S=null!==(I=q.query)&&void 0!==I?I:null===(M=T.signal)||void 0===M||null===(C=M.rule)||void 0===C?void 0:C.query)&&void 0!==S?S:"",G=null!==(_=null!==(D=Object(x.getField)(T,m.h))&&void 0!==D?D:null===(A=T.signal)||void 0===A||null===(F=A.rule)||void 0===F?void 0:F.index)&&void 0!==_?_:[],{thresholdFrom:H,thresholdTo:W,dataProviders:Q}=(e=>(Array.isArray(e)?e:[e]).reduce(((e,t)=>{var n,a,i,o;const l=null!==(n=Object(x.getField)(t,`${d.t}.threshold`))&&void 0!==n?n:null===(a=t.signal)||void 0===a||null===(i=a.rule)||void 0===i?void 0:i.threshold,c=Object(x.getField)(t,m.j),p=Object(x.getField)(t,m.g),f=Array.isArray(p)?p[0]:p,b=r()(f),y=((e,t)=>{const n=Object(x.getField)(e,u.g),a=Array.isArray(n)?n[0]:n,i=s.a.parse(a),o=r()(),l=r.a.duration(o.diff(i));return t.clone().subtract(l)})(t,b),h=Array.isArray(l.field)?l.field:[l.field];return{thresholdFrom:null!==(o=c.from)&&void 0!==o?o:y.toISOString(),thresholdTo:b.toISOString(),dataProviders:[...e.dataProviders,...h.reduce(((e,t,n)=>{const a=c.terms.filter((e=>e.field===t))[0].value,i=Array.isArray(a)?a[0]:a;if(!i)return e;const r=t.replace(".","-"),o={id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-${r}-${i}`,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:i,operator:":"}};return 0===n?[...e,{...o,and:[]}]:(e[0].and.push(o),e)}),[])]}}),{dataProviders:[],thresholdFrom:"",thresholdTo:""}))(T),Y=await i(e),K=(null!==(N=a.filters)&&void 0!==N?N:$).concat(Y?[Y]:[]);return t({from:H,notes:null,timeline:{...h.b,excludedRowRendererIds:[],columns:null!==(P=a.columns)&&void 0!==P?P:h.b.columns,description:`_id: ${T._id}`,filters:K,dataProviders:null!==(R=a.dataProviders)&&void 0!==R?R:Q,id:g.c.active,indexNames:G,dateRange:{start:H,end:W},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:V,expression:null!==(L=a.query)&&void 0!==L?L:U},serializedQuery:null!==(z=a.query)&&void 0!==z?z:U}}},to:W,ruleNote:n,ruleAuthor:B})}catch(n){const{toasts:a}=O.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailureTitle",{defaultMessage:"Failed to create threshold alert timeline"})});const i=T.a.toISOString(),r=T.b.toISOString();return t({from:i,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},q=async(e,t,n,a,i)=>{try{var o,s,l,u,p,f,b,y,v,E,j,S,I,M,C,_,D,A,F,N,P,R;const c=await O.b.get().http.fetch(k.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(w.a)([e._id]))}),T=(null!==(o=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(w.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==o?o:[])[0],L=Object(x.getField)(T,d.t),z=(null!==(s=null!==(l=L.filters)&&void 0!==l?l:null===(u=T.signal)||void 0===u||null===(p=u.rule)||void 0===p?void 0:p.filters)&&void 0!==s?s:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),q=null!==(f=null!==(b=L.language)&&void 0!==b?b:null===(y=T.signal)||void 0===y||null===(v=y.rule)||void 0===v?void 0:v.language)&&void 0!==f?f:"kuery",B=null!==(E=null!==(j=L.query)&&void 0!==j?j:null===(S=T.signal)||void 0===S||null===(I=S.rule)||void 0===I?void 0:I.query)&&void 0!==E?E:"",$=null!==(M=null!==(C=Object(x.getField)(T,m.h))&&void 0!==C?C:null===(_=T.signal)||void 0===_||null===(D=_.rule)||void 0===D?void 0:D.index)&&void 0!==M?M:[],{from:V,to:U,dataProviders:G}=(e=>{var t;const n=Array.isArray(e)?e[0]:e,a=Object(x.getField)(n,m.g),i=(null!==(t=Object(x.getField)(n,`${d.t}.new_terms_fields`))&&void 0!==t?t:[]).map(((e,t)=>{const a=e.replace(".","-"),i=Object(x.getField)(n,m.d)[t];return{id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-${a}-${i}`,name:e,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:i,operator:":"},and:[]}})),o=i.length?[{...i[0],and:i.slice(1)}]:[];return{from:a,to:r()().toISOString(),dataProviders:o}})(T),H=await i(e),W=(null!==(A=a.filters)&&void 0!==A?A:z).concat(H?[H]:[]);return t({from:V,notes:null,timeline:{...h.b,columns:null!==(F=a.columns)&&void 0!==F?F:h.b.columns,excludedRowRendererIds:[],description:`_id: ${T._id}`,filters:W,dataProviders:null!==(N=a.dataProviders)&&void 0!==N?N:G,id:g.c.active,indexNames:$,dateRange:{start:V,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:q,expression:null!==(P=a.query)&&void 0!==P?P:B},serializedQuery:null!==(R=a.query)&&void 0!==R?R:B}}},to:U,ruleNote:n})}catch(n){const{toasts:a}=O.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailureTitle",{defaultMessage:"Failed to create new terms alert timeline"})});const i=T.a.toISOString(),r=T.b.toISOString();return t({from:i,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},B=async(e,t,n,a,i)=>{try{var r,o,s,l,p,f,b,y,v,E,j,S,I,M,C,_,D,A,F,N,P,R;const c=await O.b.get().http.fetch(k.nb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(w.a)([e._id]))}),T=(null!==(r=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(w.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==r?r:[])[0],L=Object(x.getField)(T,d.t),z=(null!==(o=null!==(s=L.filters)&&void 0!==s?s:null===(l=T.signal)||void 0===l||null===(p=l.rule)||void 0===p?void 0:p.filters)&&void 0!==o?o:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),q=null!==(f=null!==(b=L.language)&&void 0!==b?b:null===(y=T.signal)||void 0===y||null===(v=y.rule)||void 0===v?void 0:v.language)&&void 0!==f?f:"kuery",B=null!==(E=null!==(j=L.query)&&void 0!==j?j:null===(S=T.signal)||void 0===S||null===(I=S.rule)||void 0===I?void 0:I.query)&&void 0!==E?E:"",$=null!==(M=null!==(C=Object(x.getField)(T,m.h))&&void 0!==C?C:null===(_=T.signal)||void 0===_||null===(D=_.rule)||void 0===D?void 0:D.index)&&void 0!==M?M:[],{from:V,to:U,dataProviders:G}=(e=>{const t=Array.isArray(e)?e[0]:e,n=Object(x.getField)(t,u.w),a=Object(x.getField)(t,u.u),i=Object(x.getField)(t,u.x).map((e=>{const t=e.field.replace(".","-"),n=`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-${t}-${e.value}`;return null==e.value?{id:n,name:t,enabled:!0,excluded:!0,kqlQuery:"",queryMatch:{field:e.field,value:"",operator:":*"}}:{id:n,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e.field,value:e.value,operator:":"}}}));return{from:n,to:a,dataProviders:[{...i[0],and:i.slice(1)}]}})(T),H=await i(e),W=(null!==(A=a.filters)&&void 0!==A?A:z).concat(H?[H]:[]);return t({from:V,notes:null,timeline:{...h.b,excludedRowRendererIds:[],columns:null!==(F=a.columns)&&void 0!==F?F:h.b.columns,description:`_id: ${T._id}`,filters:W,dataProviders:null!==(N=a.dataProviders)&&void 0!==N?N:G,id:g.c.active,indexNames:$,dateRange:{start:V,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:q,expression:null!==(P=a.query)&&void 0!==P?P:B},serializedQuery:null!==(R=a.query)&&void 0!==R?R:B}}},to:U,ruleNote:n})}catch(n){const{toasts:a}=O.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailureTitle",{defaultMessage:"Failed to create suppressed alert timeline"})});const i=T.a.toISOString(),r=T.b.toISOString();return t({from:i,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},$=async(e,t,n="dataProvider",a)=>{const i=Array.isArray(t)?t.map((e=>e._id)):[],{to:r,from:o}=I({ecs:t}),{dataProviders:s,filters:l}=L(i,n,a||`${t.length} event IDs`);await e({from:o,notes:null,timeline:{...h.b,excludedRowRendererIds:[],dataProviders:s,id:g.c.active,indexNames:[],dateRange:{start:o,end:r},eventType:"all",filters:l,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:r})},V=async({createTimeline:e,ecsData:t,updateTimelineIsLoading:n,searchStrategyClient:i,getExceptionFilter:r})=>{const o=Array.isArray(t)?t[0]:t,s=Object(x.getField)(o,u.j),l=Object(x.getField)(o,u.d),c=Array.isArray(s)&&s.length>0?s[0]:"",d=Object(x.getField)(o,m.i),f=Object(a.isEmpty)(d)?"":Array.isArray(d)?d[0]:d,{to:O,from:k}=I({ecs:t});if(Object(a.isEmpty)(f)){if(A(o))return z(o,e,c,{},r);if(C(o))return q(o,e,c,{},r);if(!N(o)||D(o)||_(o)||F(o)){let{dataProviders:n,filters:i}=L([o._id],"dataProvider");if((e=>{const t=Object(x.getField)(e,u.o),n=Object(x.getField)(e,m.a);return("eql"===t||Array.isArray(t)&&"eql"===t[0])&&(null==n?void 0:n.length)>0})(o)){const e=((e,t)=>{if(!Object(a.isEmpty)(e)&&Array.isArray(t)&&t.length>1)return{dataProviders:[],filters:P(m.a,t.reduce(((e,t)=>{const n=Object(x.getField)(t,m.a),a=Array.isArray(n)?n[0]:n;return e.includes(a)?e:[...e,a]}),[]))};if(!Array.isArray(t)||1===t.length){const e=Array.isArray(t)?t[0]:t,n=Object(x.getField)(e,m.a),a=Object(x.getFieldKey)(e,m.a),i=Array.isArray(n)?n[0]:n;return{dataProviders:[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${g.c.active}-alert-id-${i}`,name:e._id,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:a,value:i,operator:":"}}],filters:[]}}return{filters:[],dataProviders:[]}})([o._id],t);n=e.dataProviders,i=e.filters}return e({from:k,notes:null,timeline:{...h.b,excludedRowRendererIds:[],dataProviders:n,id:g.c.active,indexNames:[],dateRange:{start:k,end:O},eventType:"all",filters:i,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:O,ruleNote:c,ruleAuthor:l})}return B(o,e,c,{},r)}try{var w,T;n({id:g.c.active,isLoading:!0});const[t,s]=await Promise.all([Object(S.e)(f),Object(p.lastValueFrom)(i.search({defaultIndex:[],indexName:null!==(w=o._index)&&void 0!==w?w:"",eventId:o._id,factoryQueryType:y.c.details},{strategy:"timelineSearchStrategy"}))]),u=Object(a.getOr)({},"data.getOneTimeline",t),d=null!==(T=s.data)&&void 0!==T?T:[];if(!Object(a.isEmpty)(u)){var M,R,$,V,U,G,H;const t=Object(v.f)(u),{timeline:n,notes:a}=Object(v.b)(t,!0,null!==(M=t.timelineType)&&void 0!==M?M:b.m.default),i=Object(j.d)(null!==(R=null===($=n.kqlQuery)||void 0===$||null===(V=$.filterQuery)||void 0===V||null===(U=V.kuery)||void 0===U?void 0:U.expression)&&void 0!==R?R:"",d,n.timelineType),s=Object(j.c)(null!==(G=n.filters)&&void 0!==G?G:[],d),p=Object(j.b)(null!==(H=n.dataProviders)&&void 0!==H?H:[],d,n.timelineType);return A(o)?z(o,e,c,{filters:s,query:i,dataProviders:p,columns:n.columns},r):C(o)?q(o,e,c,{filters:s,query:i,dataProviders:p,columns:n.columns},r):!N(o)||D(o)||_(o)||F(o)?e({from:k,timeline:{...n,excludedRowRendererIds:[],title:"",timelineType:b.m.default,templateTimelineId:null,status:b.l.draft,dataProviders:p,eventType:"all",filters:s,dateRange:{start:k,end:O},kqlQuery:{filterQuery:{kuery:{kind:null!==(W=null===(Q=n.kqlQuery)||void 0===Q||null===(Y=Q.filterQuery)||void 0===Y||null===(K=Y.kuery)||void 0===K?void 0:K.kind)&&void 0!==W?W:"kuery",expression:i},serializedQuery:Object(E.f)(i)}},noteIds:null!==(J=null==a?void 0:a.map((e=>e.noteId)))&&void 0!==J?J:[],show:!0},to:O,ruleNote:c,ruleAuthor:l,notes:null!=a?a:null}):B(o,e,c,{filters:s,query:i,dataProviders:p,columns:n.columns},r);var W,Q,Y,K,J}}catch{return n({id:g.c.active,isLoading:!1}),e({from:k,notes:null,timeline:{...h.b,id:g.c.active,indexNames:[],dateRange:{start:k,end:O},eventType:"all"},to:O})}}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var a=n(269),i=n(1342);const r=e=>Object(a.flow)(u,c)(e),o=e=>Object(a.flow)(c)(e),s=e=>Object(a.flow)(l)(e),l=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(i.a)({...e,entries:e.entries.map((e=>Object(i.a)(e)))}):Object(i.a)(e)));return{...e,entries:t}},c=e=>{const{entries:t}=e,n=t.map((e=>"nested"===e.type?Object(i.b)({...e,entries:e.entries.map((e=>Object(i.b)(e)))}):Object(i.b)(e)));return{...e,entries:n}},u=e=>{const{comments:t}=e;if(!t||!t.length)return e;const n=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(2),i=n(43);const r=Object(a.createContext)(void 0),o=Object(a.memo)((({urlKey:e,children:t})=>{const n=Object(a.useMemo)((()=>({urlKey:e})),[e]);return Object(i.jsx)(r.Provider,{value:n},t)}));o.displayName="ExpandableFlyoutContextProvider";const s=()=>{const e=Object(a.useContext)(r);if(void 0===e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e}},,,function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(174);const i=e=>"upload"===e.command,r=e=>"execute"===e.command,o=e=>"get-file"===e.command,s=e=>a.d.includes(e),l=e=>a.h.includes(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(2);const i=n.n(a).a.createContext(null),r=()=>{var e;return null===(e=Object(a.useContext)(i))||void 0===e?void 0:e.current}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}));var a=n(4);const i=e=>a.i18n.translate("xpack.securitySolution.assignees.totalUsersAssigned",{defaultMessage:"{total, plural, one {# filter} other {# filters}} selected",values:{total:e}}),r=a.i18n.translate("xpack.securitySolution.assignees.applyButtonTitle",{defaultMessage:"Apply"}),o=a.i18n.translate("xpack.securitySolution.assignees.selectableSearchPlaceholder",{defaultMessage:"Search users"}),s=a.i18n.translate("xpack.securitySolution.assignees.clearFilters",{defaultMessage:"Clear filters"}),l=a.i18n.translate("xpack.securitySolution.assignees.noAssigneesLabel",{defaultMessage:"No assignees"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(7),i=n(405);const r=e=>{var t,n,a,i,r,o,s;return null!==(t=null!==(n=null===(a=e.user)||void 0===a||null===(i=a.full_name)||void 0===i?void 0:i.toLowerCase())&&void 0!==n?n:null===(r=e.user)||void 0===r||null===(o=r.email)||void 0===o?void 0:o.toLowerCase())&&void 0!==t?t:null===(s=e.user)||void 0===s?void 0:s.username.toLowerCase()},o=(e,t)=>((e,t)=>{if(!t)return;if(!e)return t;if(!t.find((t=>t.uid===e.uid)))return t;const n=t.filter((t=>t.uid!==e.uid));return[e,...n]})(e,(e=>{if(e)return Object(a.sortBy)(e,r)})(t)),s=e=>e.filter((e=>e!==i.b))},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const a="securitySolutionAssignees",i=`${a}Selectable`,r=`${a}ApplyPanel`,o=`${a}ApplyButton`},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return c}));var a=n(19);const i=97,r=2;function o(e,t){if(t&&t.color)return t.color;const n=l(e).codePointAt(0)||i;return a.VISUALIZATION_COLORS[n%a.VISUALIZATION_COLORS.length]}function s(e,t){if(t&&t.initials)return t.initials;const n=l(e).split(" "),a=Math.min(r,n.length);return n.splice(a,n.length),n.map((e=>e.substring(0,1))).join("")}function l(e){return e.full_name||e.email||e.username}function c(e){const t=l(e);return e.email&&e.email!==t?`${t} (${e.email})`:t}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1222);const i=e=>{var t;const n=null!=e&&e.fields?null==e?void 0:e.fields["kibana.alert.rule.parameters"]:null,i=n?null===(t=n[0])||void 0===t?void 0:t.threat:null;return i&&i.length>0?Object(a.o)({label:i[0].framework,threat:i}):null}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(19),i=n(2),r=n.n(i),o=n(667),s=n(172),l=n(422),c=n(148),u=n(124);const d=r.a.memo((({eventId:e,contextId:t,enrichedFieldInfo:n,scopeId:d,handleOnEventClosed:p})=>{const[m,f]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>f(!m)),[m]),b=Object(i.useCallback)((()=>f(!1)),[]),y=Object(i.useCallback)((()=>{b(),p()}),[b,p]),h=Object(i.useMemo)((()=>c.d.globalQuery()),[]),v=Object(u.a)(h),E=Object(i.useCallback)((()=>{v.forEach((e=>e.refetch&&e.refetch()))}),[v]),{actionItems:x}=Object(o.a)({closePopover:y,eventId:e,scopeId:d,alertStatus:n.values[0],refetch:E}),j=Object(i.useMemo)((()=>[{id:0,items:x}]),[x]),S=Object(i.useMemo)((()=>x.length>0),[x]),O=Object(i.useMemo)((()=>r.a.createElement(l.a,{contextId:t,eventId:e,value:n.values[0],fieldName:n.data.field,linkValue:n.linkValue,fieldType:n.data.type,fieldFormat:n.data.format,isDraggable:!1,truncate:!1,isButton:S,onClick:S?g:void 0,onClickAriaLabel:s.D})),[t,e,n,g,S]);return S?r.a.createElement(a.EuiPopover,{button:O,isOpen:m,closePopover:b,panelPaddingSize:"none","data-test-subj":"alertStatus"},r.a.createElement(a.EuiPopoverTitle,{paddingSize:"m"},s.C),r.a.createElement(a.EuiContextMenu,{panels:j,initialPanelId:0,"data-test-subj":"event-details-alertStatusPopover"})):O}));d.displayName="StatusPopoverButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.source.destination.packetsLabel",{defaultMessage:"pkts"})},function(e,t,n){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function n(e){let n=e,a=e;function i(e,t,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){const r=n+i>>>1;a(e[r],t)<0?n=r+1:i=r}return n}return 1===e.length&&(n=(t,n)=>e(t)-n,a=function(e){return(n,a)=>t(e(n),a)}(e)),{left:i,center:function(e,t,a,r){null==a&&(a=0),null==r&&(r=e.length);const o=i(e,t,a,r-1);return o>a&&n(e[o-1],t)>-n(e[o],t)?o-1:o},right:function(e,t,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){const r=n+i>>>1;a(e[r],t)>0?i=r:n=r+1}return n}}}function a(e){return null===e?NaN:+e}const i=n(t),r=i.right,o=i.left,s=n(a).center;function l(e,t){let n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++n;else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(i=+i)>=i&&++n}return n}function c(e){return 0|e.length}function u(e){return!(e>0)}function d(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function p(e,t){let n,a=0,i=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-i,i+=n/++a,r+=n*(t-i));else{let o=-1;for(let s of e)null!=(s=t(s,++o,e))&&(s=+s)>=s&&(n=s-i,i+=n/++a,r+=n*(s-i))}if(a>1)return r/(a-1)}function m(e,t){const n=p(e,t);return n?Math.sqrt(n):n}function f(e,t){let n,a;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=a=t):(n>t&&(n=t),a<t&&(a=t)));else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(void 0===n?r>=r&&(n=a=r):(n>r&&(n=r),a<r&&(a=r)))}return[n,a]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let a=0;a<this._n&&a<32;a++){const i=t[a],r=e+i,o=Math.abs(e)<Math.abs(i)?e-(r-i):i-(r-e);o&&(t[n++]=o),e=r}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,a,i=this._n,r=0;if(i>0){for(r=e[--i];i>0&&(t=r,n=e[--i],r=t+n,a=n-(r-t),!a););i>0&&(a<0&&e[i-1]<0||a>0&&e[i-1]>0)&&(n=2*a,t=r+n,n==t-r&&(r=t))}return r}}class InternMap extends Map{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(g(this,e))}has(e){return super.has(g(this,e))}set(e,t){return super.set(b(this,e),t)}delete(e){return super.delete(y(this,e))}}class InternSet extends Set{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(g(this,e))}add(e){return super.add(b(this,e))}delete(e){return super.delete(y(this,e))}}function g({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function b({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function y({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(n),e.delete(a)),n}function h(e){return null!==e&&"object"==typeof e?e.valueOf():e}function v(e){return e}function E(e,...t){return S(e,v,v,t)}function x(e,t,...n){return S(e,v,t,n)}function j(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function S(e,t,n,a){return function e(i,r){if(r>=a.length)return n(i);const o=new InternMap,s=a[r++];let l=-1;for(const e of i){const t=s(e,++l,i),n=o.get(t);n?n.push(e):o.set(t,[e])}for(const[t,n]of o)o.set(t,e(n,r));return t(o)}(e,0)}function O(e,t){return Array.from(t,(t=>e[t]))}function k(e,...n){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[a=t]=n;if(1===a.length||n.length>1){const i=Uint32Array.from(e,((e,t)=>t));return n.length>1?(n=n.map((t=>e.map(t))),i.sort(((e,a)=>{for(const i of n){const n=t(i[e],i[a]);if(n)return n}}))):(a=e.map(a),i.sort(((e,n)=>t(a[e],a[n])))),O(e,i)}return e.sort(a)}var w=Array.prototype.slice;function T(e){return function(){return e}}var I=Math.sqrt(50),M=Math.sqrt(10),C=Math.sqrt(2);function _(e,t,n){var a,i,r,o,s=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((a=t<e)&&(i=e,e=t,t=i),0===(o=D(e,t,n))||!isFinite(o))return[];if(o>0){let n=Math.round(e/o),a=Math.round(t/o);for(n*o<e&&++n,a*o>t&&--a,r=new Array(i=a-n+1);++s<i;)r[s]=(n+s)*o}else{o=-o;let n=Math.round(e*o),a=Math.round(t*o);for(n/o<e&&++n,a/o>t&&--a,r=new Array(i=a-n+1);++s<i;)r[s]=(n+s)/o}return a&&r.reverse(),r}function D(e,t,n){var a=(t-e)/Math.max(0,n),i=Math.floor(Math.log(a)/Math.LN10),r=a/Math.pow(10,i);return i>=0?(r>=I?10:r>=M?5:r>=C?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(r>=I?10:r>=M?5:r>=C?2:1)}function A(e,t,n){let a;for(;;){const i=D(e,t,n);if(i===a||0===i||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),a=i}}function F(e){return Math.ceil(Math.log(l(e))/Math.LN2)+1}function N(){var e=v,t=f,n=F;function a(a){Array.isArray(a)||(a=Array.from(a));var i,o,s=a.length,l=new Array(s);for(i=0;i<s;++i)l[i]=e(a[i],i,a);var c=t(l),u=c[0],d=c[1],p=n(l,u,d);if(!Array.isArray(p)){const e=d,n=+p;if(t===f&&([u,d]=A(u,d,n)),(p=_(u,d,n))[p.length-1]>=d)if(e>=d&&t===f){const e=D(u,d,n);isFinite(e)&&(e>0?d=(Math.floor(d/e)+1)*e:e<0&&(d=(Math.ceil(d*-e)+1)/-e))}else p.pop()}for(var m=p.length;p[0]<=u;)p.shift(),--m;for(;p[m-1]>d;)p.pop(),--m;var g,b=new Array(m+1);for(i=0;i<=m;++i)(g=b[i]=[]).x0=i>0?p[i-1]:u,g.x1=i<m?p[i]:d;for(i=0;i<s;++i)u<=(o=l[i])&&o<=d&&b[r(p,o,0,m)].push(a[i]);return b}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:T(t),a):e},a.domain=function(e){return arguments.length?(t="function"==typeof e?e:T([e[0],e[1]]),a):t},a.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?T(w.call(e)):T(e),a):n},a}function P(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function R(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function L(e,n,a=0,i=e.length-1,r=t){for(;i>a;){if(i-a>600){const t=i-a+1,o=n-a+1,s=Math.log(t),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(t-l)/t)*(o-t/2<0?-1:1);L(e,n,Math.max(a,Math.floor(n-o*l/t+c)),Math.min(i,Math.floor(n+(t-o)*l/t+c)),r)}const t=e[n];let o=a,s=i;for(z(e,a,n),r(e[i],t)>0&&z(e,a,i);o<s;){for(z(e,o,s),++o,--s;r(e[o],t)<0;)++o;for(;r(e[s],t)>0;)--s}0===r(e[a],t)?z(e,a,s):(++s,z(e,s,i)),s<=n&&(a=s+1),n<=s&&(i=s-1)}return e}function z(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function q(e,t,n){if(a=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let a of e)null!=(a=t(a,++n,e))&&(a=+a)>=a&&(yield a)}}(e,n))).length){if((t=+t)<=0||a<2)return R(e);if(t>=1)return P(e);var a,i=(a-1)*t,r=Math.floor(i),o=P(L(e,r).subarray(0,r+1));return o+(R(e.subarray(r+1))-o)*(i-r)}}function B(e,t){let n,a=-1,i=-1;if(void 0===t)for(const t of e)++i,null!=t&&(n<t||void 0===n&&t>=t)&&(n=t,a=i);else for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r,a=i);return a}function $(e,t){let n,a=-1,i=-1;if(void 0===t)for(const t of e)++i,null!=t&&(n>t||void 0===n&&t>=t)&&(n=t,a=i);else for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r,a=i);return a}function V(e,t){return[e,t]}function U(e,n=t){if(1===n.length)return $(e,n);let a,i=-1,r=-1;for(const t of e)++r,(i<0?0===n(t,t):n(t,a)<0)&&(a=t,i=r);return i}var G=H(Math.random);function H(e){return function(t,n=0,a=t.length){let i=a-(n=+n);for(;i;){const a=e()*i--|0,r=t[i+n];t[i+n]=t[a+n],t[a+n]=r}return t}}function W(e){if(!(i=e.length))return[];for(var t=-1,n=R(e,Q),a=new Array(n);++t<n;)for(var i,r=-1,o=a[t]=new Array(i);++r<i;)o[r]=e[r][t];return a}function Q(e){return e.length}function Y(e){return e instanceof Set?e:new Set(e)}function K(e,t){const n=e[Symbol.iterator](),a=new Set;for(const e of t){if(a.has(e))continue;let t,i;for(;({value:t,done:i}=n.next());){if(i)return!1;if(a.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=N,e.bisect=r,e.bisectCenter=s,e.bisectLeft=o,e.bisectRight=r,e.bisector=n,e.count=l,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),n=(e=e.map(d)).map(c),a=e.length-1,i=new Array(a+1).fill(0),r=[];if(a<0||n.some(u))return r;for(;;){r.push(i.map(((t,n)=>e[n][t])));let o=a;for(;++i[o]===n[o];){if(0===o)return t?r.map(t):r;i[o--]=0}}},e.cumsum=function(e,t){var n=0,a=0;return Float64Array.from(e,void 0===t?e=>n+=+e||0:i=>n+=+t(i,a++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.difference=function(e,...t){e=new Set(e);for(const n of t)for(const t of n)e.delete(t);return e},e.disjoint=function(e,t){const n=t[Symbol.iterator](),a=new Set;for(const t of e){if(a.has(t))return!1;let e,i;for(;({value:e,done:i}=n.next())&&!i;){if(Object.is(t,e))return!1;a.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const a of e)if(!t(a,++n,e))return!1;return!0},e.extent=f,e.fcumsum=function(e,t){const n=new Adder;let a=-1;return Float64Array.from(e,void 0===t?e=>n.add(+e||0):i=>n.add(+t(i,++a,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const n=[];let a=-1;for(const i of e)t(i,++a,e)&&n.push(i);return n},e.fsum=function(e,t){const n=new Adder;if(void 0===t)for(let t of e)(t=+t)&&n.add(t);else{let a=-1;for(let i of e)(i=+t(i,++a,e))&&n.add(i)}return+n},e.greatest=function(e,n=t){let a,i=!1;if(1===n.length){let r;for(const o of e){const e=n(o);(i?t(e,r)>0:0===t(e,e))&&(a=o,r=e,i=!0)}}else for(const t of e)(i?n(t,a)>0:0===n(t,t))&&(a=t,i=!0);return a},e.greatestIndex=function(e,n=t){if(1===n.length)return B(e,n);let a,i=-1,r=-1;for(const t of e)++r,(i<0?0===n(t,t):n(t,a)>0)&&(a=t,i=r);return i},e.group=E,e.groupSort=function(e,n,a){return(1===n.length?k(x(e,n,a),(([e,n],[a,i])=>t(n,i)||t(e,a))):k(E(e,a),(([e,a],[i,r])=>n(a,r)||t(e,i)))).map((([e])=>e))},e.groups=function(e,...t){return S(e,Array.from,v,t)},e.histogram=N,e.index=function(e,...t){return S(e,v,j,t)},e.indexes=function(e,...t){return S(e,Array.from,j,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(Y);e:for(const n of e)for(const a of t)if(!a.has(n)){e.delete(n);continue e}return e},e.least=function(e,n=t){let a,i=!1;if(1===n.length){let r;for(const o of e){const e=n(o);(i?t(e,r)<0:0===t(e,e))&&(a=o,r=e,i=!0)}}else for(const t of e)(i?n(t,a)<0:0===n(t,t))&&(a=t,i=!0);return a},e.leastIndex=U,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((n,a)=>t(n,a,e)))},e.max=P,e.maxIndex=B,e.mean=function(e,t){let n=0,a=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,a+=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(r=+r)>=r&&(++n,a+=r)}if(n)return a/n},e.median=function(e,t){return q(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=R,e.minIndex=$,e.nice=A,e.pairs=function(e,t=V){const n=[];let a,i=!1;for(const r of e)i&&n.push(t(a,r)),a=r,i=!0;return n},e.permute=O,e.quantile=q,e.quantileSorted=function(e,t,n=a){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(r-o)}},e.quickselect=L,e.range=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var a=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),r=new Array(i);++a<i;)r[a]=e+a*n;return r},e.reduce=function(e,t,n){if("function"!=typeof t)throw new TypeError("reducer is not a function");const a=e[Symbol.iterator]();let i,r,o=-1;if(arguments.length<3){if(({done:i,value:n}=a.next()),i)return;++o}for(;({done:i,value:r}=a.next()),!i;)n=t(n,r,++o,e);return n},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=x,e.rollups=function(e,t,...n){return S(e,Array.from,t,n)},e.scan=function(e,t){const n=U(e,t);return n<0?void 0:n},e.shuffle=G,e.shuffler=H,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const a of e)if(t(a,++n,e))return!0;return!1},e.sort=k,e.subset=function(e,t){return K(t,e)},e.sum=function(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let a=-1;for(let i of e)(i=+t(i,++a,e))&&(n+=i)}return n},e.superset=K,e.thresholdFreedmanDiaconis=function(e,t,n){return Math.ceil((n-t)/(2*(q(e,.75)-q(e,.25))*Math.pow(l(e),-1/3)))},e.thresholdScott=function(e,t,n){return Math.ceil((n-t)/(3.5*m(e)*Math.pow(l(e),-1/3)))},e.thresholdSturges=F,e.tickIncrement=D,e.tickStep=function(e,t,n){var a=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),r=a/i;return r>=I?i*=10:r>=M?i*=5:r>=C&&(i*=2),t<e?-i:i},e.ticks=_,e.transpose=W,e.union=function(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t},e.variance=p,e.zip=function(){return W(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e,t){"use strict";var n=new Date,a=new Date;function i(e,t,r,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},s.round=function(e){var t=s(e),n=s.ceil(e);return e-t<n-e?t:n},s.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},s.range=function(n,a,i){var r,o=[];if(n=s.ceil(n),i=null==i?1:Math.floor(i),!(n<a&&i>0))return o;do{o.push(r=new Date(+n)),t(n,i),e(n)}while(r<n&&n<a);return o},s.filter=function(n){return i((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,a){if(e>=e)if(a<0)for(;++a<=0;)for(;t(e,-1),!n(e););else for(;--a>=0;)for(;t(e,1),!n(e););}))},r&&(s.count=function(t,i){return n.setTime(+t),a.setTime(+i),e(n),e(a),Math.floor(r(n,a))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var r=i((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));r.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):r:null};var o=r.range;const s=1e3,l=6e4,c=36e5,u=864e5,d=6048e5,p=2592e6,m=31536e6;var f=i((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCSeconds()})),g=f.range,b=i((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getMinutes()})),y=b.range,h=i((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s-e.getMinutes()*l)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getHours()})),v=h.range,E=i((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/u),(e=>e.getDate()-1)),x=E.range;function j(e){return i((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/d}))}var S=j(0),O=j(1),k=j(2),w=j(3),T=j(4),I=j(5),M=j(6),C=S.range,_=O.range,D=k.range,A=w.range,F=T.range,N=I.range,P=M.range,R=i((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),L=R.range,z=i((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));z.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var q=z.range,B=i((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCMinutes()})),$=B.range,V=i((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCHours()})),U=V.range,G=i((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1})),H=G.range;function W(e){return i((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/d}))}var Q=W(0),Y=W(1),K=W(2),J=W(3),Z=W(4),X=W(5),ee=W(6),te=Q.range,ne=Y.range,ae=K.range,ie=J.range,re=Z.range,oe=X.range,se=ee.range,le=i((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ce=le.range,ue=i((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));ue.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var de=ue.range;function pe(e,n,a,i,o,g){const b=[[f,1,s],[f,5,5e3],[f,15,15e3],[f,30,3e4],[g,1,l],[g,5,3e5],[g,15,9e5],[g,30,18e5],[o,1,c],[o,3,108e5],[o,6,216e5],[o,12,432e5],[i,1,u],[i,2,1728e5],[a,1,d],[n,1,p],[n,3,7776e6],[e,1,m]];function y(n,a,i){const o=Math.abs(a-n)/i,s=t.bisector((([,,e])=>e)).right(b,o);if(s===b.length)return e.every(t.tickStep(n/m,a/m,i));if(0===s)return r.every(Math.max(t.tickStep(n,a,i),1));const[l,c]=b[o/b[s-1][2]<b[s][2]/o?s-1:s];return l.every(c)}return[function(e,t,n){const a=t<e;a&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:y(e,t,n),r=i?i.range(e,+t+1):[];return a?r.reverse():r},y]}const[me,fe]=pe(ue,le,Q,G,V,B),[ge,be]=pe(z,R,S,E,h,b);e.timeDay=E,e.timeDays=x,e.timeFriday=I,e.timeFridays=N,e.timeHour=h,e.timeHours=v,e.timeInterval=i,e.timeMillisecond=r,e.timeMilliseconds=o,e.timeMinute=b,e.timeMinutes=y,e.timeMonday=O,e.timeMondays=_,e.timeMonth=R,e.timeMonths=L,e.timeSaturday=M,e.timeSaturdays=P,e.timeSecond=f,e.timeSeconds=g,e.timeSunday=S,e.timeSundays=C,e.timeThursday=T,e.timeThursdays=F,e.timeTickInterval=be,e.timeTicks=ge,e.timeTuesday=k,e.timeTuesdays=D,e.timeWednesday=w,e.timeWednesdays=A,e.timeWeek=S,e.timeWeeks=C,e.timeYear=z,e.timeYears=q,e.utcDay=G,e.utcDays=H,e.utcFriday=X,e.utcFridays=oe,e.utcHour=V,e.utcHours=U,e.utcMillisecond=r,e.utcMilliseconds=o,e.utcMinute=B,e.utcMinutes=$,e.utcMonday=Y,e.utcMondays=ne,e.utcMonth=le,e.utcMonths=ce,e.utcSaturday=ee,e.utcSaturdays=se,e.utcSecond=f,e.utcSeconds=g,e.utcSunday=Q,e.utcSundays=te,e.utcThursday=Z,e.utcThursdays=re,e.utcTickInterval=fe,e.utcTicks=me,e.utcTuesday=K,e.utcTuesdays=ae,e.utcWednesday=J,e.utcWednesdays=ie,e.utcWeek=Q,e.utcWeeks=te,e.utcYear=ue,e.utcYears=de,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(833))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var a=n(19),i=n(44),r=n(2),o=n.n(r),s=n(134);const l="process.name",c="user.name",u=o.a.memo((({contextId:e,eventId:t,isDraggable:n,processName:r,userName:u})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"user-process",direction:"column",justifyContent:"center",gutterSize:"none"},null!=u?Object(i.uniq)(u).map((i=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:i},o.a.createElement(s.c,{contextId:e,"data-test-subj":"user-name",eventId:t,field:c,isDraggable:n,value:i,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))):null,null!=r?Object(i.uniq)(r).map((i=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:i},o.a.createElement(s.c,{contextId:e,eventId:t,field:l,isDraggable:n,value:i,iconType:"console",isAggregatable:!0,fieldType:"keyword"})))):null)));u.displayName="UserProcess"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(134),o=n(434),s=n(150);const l=i.a.memo((({contextId:e,eventId:t,hostName:n,workingDirectory:a,isDraggable:l})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:e,eventId:t,field:"host.name",value:n,isDraggable:l,fieldType:"keyword",isAggregatable:!0})),null!=a&&i.a.createElement(s.c,{grow:!1,component:"span"},o.e),i.a.createElement(s.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:e,eventId:t,field:"process.working_directory",value:a,iconType:"folderOpen",isDraggable:l,fieldType:"keyword",isAggregatable:!0})))));l.displayName="HostWorkingDir"},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(44),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(121),c=n(433),u=n(629),d=n(520),p=n(590),m=n(406),f=n(630),g=n(859),b=n(592),y=n(835),h=n(382),v=n(486),E=n(591),x=n(569),j=n(315);const S=s.a.div.withConfig({displayName:"Details",componentId:"sc-1voakd9-0"})(["margin:5px 0;"]);S.displayName="Details";const O={id:l.e.netflow,isInstance:e=>"network_traffic"===`${Object(a.get)("event.category",e)}`.toLowerCase()||(e=>{const t=`${e}`.toLowerCase();return"network_flow"===t||"netflow_flow"===t})(Object(a.get)("event.action",e)),renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(j.a,null,r.a.createElement(S,null,r.a.createElement(g.a,{contextId:`netflow-row-renderer-render-row-${n}-${e._id}`,destinationBytes:Object(c.a)(Object(a.get)(x.a,e)),destinationGeoContinentName:Object(c.a)(Object(a.get)(E.b,e)),destinationGeoCountryName:Object(c.a)(Object(a.get)(E.d,e)),destinationGeoCountryIsoCode:Object(c.a)(Object(a.get)(E.c,e)),destinationGeoRegionName:Object(c.a)(Object(a.get)(E.e,e)),destinationGeoCityName:Object(c.a)(Object(a.get)(E.a,e)),destinationIp:Object(c.a)(Object(a.get)(m.a,e)),destinationPackets:Object(c.a)(Object(a.get)(x.b,e)),destinationPort:Object(c.a)(Object(a.get)(h.a,e)),eventDuration:Object(c.a)(Object(a.get)(d.b,e)),eventId:Object(a.get)(p.a,e),eventEnd:Object(c.a)(Object(a.get)(b.b,e)),eventStart:Object(c.a)(Object(a.get)(b.c,e)),isDraggable:t,networkBytes:Object(c.a)(Object(a.get)(v.a,e)),networkCommunityId:Object(c.a)(Object(a.get)(v.b,e)),networkDirection:Object(c.a)(Object(a.get)(v.c,e)),networkPackets:Object(c.a)(Object(a.get)(v.d,e)),networkProtocol:Object(c.a)(Object(a.get)(v.e,e)),processName:Object(c.a)(Object(a.get)(y.a,e)),sourceBytes:Object(c.a)(Object(a.get)(x.c,e)),sourceGeoContinentName:Object(c.a)(Object(a.get)(E.h,e)),sourceGeoCountryName:Object(c.a)(Object(a.get)(E.j,e)),sourceGeoCountryIsoCode:Object(c.a)(Object(a.get)(E.i,e)),sourceGeoRegionName:Object(c.a)(Object(a.get)(E.k,e)),sourceGeoCityName:Object(c.a)(Object(a.get)(E.g,e)),sourceIp:Object(c.a)(Object(a.get)(m.d,e)),sourcePackets:Object(c.a)(Object(a.get)(x.d,e)),sourcePort:Object(c.a)(Object(a.get)(h.c,e)),tlsClientCertificateFingerprintSha1:Object(c.a)(Object(a.get)(u.b,e)),tlsFingerprintsJa3Hash:Object(c.a)(Object(a.get)(f.a,e)),tlsServerCertificateFingerprintSha1:Object(c.a)(Object(a.get)(u.c,e)),transport:Object(c.a)(Object(a.get)(v.f,e)),userName:Object(c.a)(Object(a.get)(y.b,e))})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(19),o=n(180),s=n(355);const l=({width:e=s.b,dataTestSubj:t,content:n,ariaLabel:a,iconType:l="",isDisabled:c=!1,onClick:u,children:d,buttonType:p="icon"})=>i.a.createElement(i.a.Fragment,null,"icon"===p&&i.a.createElement("div",null,i.a.createElement(o.l,{textAlign:"center",width:e},null!=d?d:i.a.createElement(r.EuiToolTip,{"data-test-subj":`${t}-tool-tip`,content:n},i.a.createElement(r.EuiButtonIcon,{"aria-label":a,"data-test-subj":`${t}-button`,iconType:l,isDisabled:c,onClick:u,size:"s"})))),"text"===p&&i.a.createElement(r.EuiContextMenuItem,{"aria-label":a,"data-test-subj":`${t}-button-menu-item`,disabled:c,onClick:u,color:"text",size:"s"},i.a.createElement(r.EuiText,{"data-test-subj":`${t}-button`,size:"m"},n)),"emptyButton"===p&&i.a.createElement(r.EuiButtonEmpty,{onClick:u,iconType:"timeline",flush:"right",size:"xs","data-test-subj":t},n));l.displayName="ActionIconItemComponent";const c=i.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(19),i=n(44),r=n(2),o=n.n(r),s=n(121),l=n(432);const c=e=>e?"pinFilled":"pin",u=o.a.memo((({ariaLabel:e,allowUnpinning:t,isAlert:n,isDisabled:r,onClick:u=i.noop,pinned:d,timelineType:p})=>{const m=p===s.m.template,f=(({isAlert:e,isTemplate:t,isPinned:n})=>t?l.b(e):n?l.c(e):l.g(e))({isAlert:n,isTemplate:m,isPinned:d}),g=null==e||m?f:e;return o.a.createElement(a.EuiButtonIcon,{"aria-label":g,"data-test-subj":"pin",iconType:c(d),onClick:u,isDisabled:r||m||!t,size:"s"})}));u.displayName="Pin"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n(1558),r=n(123),o=n(118),s=n(252),l=n(512),c=n(1207),u=n(303);const d=e=>{const{data:t,spaces:n}=Object(o.j)().services,{addWarning:d}=Object(r.a)(),[p,m]=Object(a.useState)(!1),[f,g]=Object(a.useState)(""),b=Object(a.useMemo)((()=>null!=e&&1===e.length),[e]),y=Object(a.useMemo)((()=>null!=e&&b&&"machine_learning"===e[0].type),[b,e]);Object(a.useEffect)((()=>{(async()=>{if(n){const e=await n.getActiveSpace();g(e.id)}})()}),[n]);const h=Object(a.useMemo)((()=>null!=e&&b?"data_view_id"in e[0]&&e[0].data_view_id||null:`security-solution-${f}`),[b,e,f]),v=Object(a.useMemo)((()=>null!=e&&b&&"esql"===e[0].type?Object(i.a)(null==e?void 0:e[0].query):!h&&null!=e&&b&&"index"in e[0]&&null!=e[0].index?e[0].index:[]),[h,b,e]),E=Object(a.useMemo)((()=>{var t;return y&&b&&null!=e&&null!==(t=Object(u.g)(e[0]))&&void 0!==t?t:[]}),[y,b,e]),{mlJobLoading:x,ruleIndices:j}=Object(c.a)(E),S=Object(a.useMemo)((()=>y&&j.length>0?j:null!=h?[]:v),[y,h,v,j]),[O,{indexPatterns:k,dataView:w}]=Object(s.b)(S,!1,"indexFields"),[T,I]=Object(a.useState)(null),[M,C]=Object(a.useState)(null);Object(a.useEffect)((()=>{(async()=>{if(""!==f&&h){m(!0);const e=await t.dataViews.get(h);m(!1),I(e),C(e.toSpec())}})()}),[h,t.dataViews,I,f]);const _=Object(a.useCallback)((async e=>{let n=[];const a=null!=M?M:w;if(!a)return n;try{n=await t.dataViews.getFieldsForIndexPattern(a,{pattern:"",includeUnmapped:!0,fields:e})}catch(e){d(e,{title:l.b})}return n}),[d,t.dataViews,M,w]);return{isLoading:O||x||p,indexPatterns:Object(a.useMemo)((()=>h&&null!=T?T:k),[h,T,k]),getExtendedFields:_}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(1491),r=n(343),o=n(118);const s=()=>{const{services:{http:e}}=Object(o.j)(),[t,n]=Object(a.useState)(!1),s=Object(a.useRef)(null),{addExceptionListItem:l,updateExceptionListItem:c}=Object(i.a)(e);return Object(a.useEffect)((()=>{const e=new AbortController;return s.current=async e=>{try{n(!0);const t=await Promise.all(e.map((e=>{if("id"in e&&null!=e.id){const t=Object(r.i)(e);return c({listItem:t})}return l({listItem:e})})));return n(!1),t}catch(e){throw n(!1),e}},()=>{n(!1),e.abort()}}),[c,e,l]),[t,s.current]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"o",(function(){return E})),n.d(t,"n",(function(){return x})),n.d(t,"m",(function(){return j})),n.d(t,"u",(function(){return S})),n.d(t,"k",(function(){return O})),n.d(t,"v",(function(){return k}));var a=n(4);const i=a.i18n.translate("exceptionList-components.empty.viewer.state.empty.title",{defaultMessage:"Add exceptions to this list"}),r=a.i18n.translate("exceptionList-components.empty.viewer.state.empty.body",{defaultMessage:"There is no exception in your list. Create your first exception."}),o=a.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.search.title",{defaultMessage:"No results match your search criteria"}),s=a.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.body",{defaultMessage:"Try modifying your search"}),l=e=>a.i18n.translate("exceptionList-components.empty.viewer.state.empty.viewer_button",{values:{exceptionType:e},defaultMessage:"Create {exceptionType} exception"}),c=a.i18n.translate("exceptionList-components.empty.viewer.state.error_title",{defaultMessage:"Unable to load exception items"}),u=a.i18n.translate("exceptionList-components.empty.viewer.state.error_body",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),d=a.i18n.translate("exceptionList-components.exception_list_header_export_action",{defaultMessage:"Export exception list"}),p=a.i18n.translate("exceptionList-components.exception_list_header_delete_action",{defaultMessage:"Delete exception list"}),m=a.i18n.translate("exceptionList-components.exception_list_header_duplicate_action",{defaultMessage:"Duplicate exception list"}),f=a.i18n.translate("exceptionList-components.exception_list_header_link_rules_button",{defaultMessage:"Link rules"}),g=e=>a.i18n.translate("exceptionList-components.exception_list_header_linked_rules",{values:{noOfRules:e},defaultMessage:"Linked to {noOfRules} rules"}),b=a.i18n.translate("exceptionList-components.exception_list_header_breadcrumb",{defaultMessage:"Shared Exception Lists"}),y=a.i18n.translate("exceptionList-components.exception_list_header_list_id",{defaultMessage:"List ID"}),h=a.i18n.translate("exceptionList-components.exception_list_header_name",{defaultMessage:"Add a name"}),v=a.i18n.translate("exceptionList-components.exception_list_header_description",{defaultMessage:"Add a description"}),E=e=>a.i18n.translate("exceptionList-components.exception_list_header_edit_modal_name",{defaultMessage:"Edit {listName}",values:{listName:e}}),x=a.i18n.translate("exceptionList-components.exception_list_header_edit_modal_save_button",{defaultMessage:"Save"}),j=a.i18n.translate("exceptionList-components.exception_list_header_edit_modal_cancel_button",{defaultMessage:"Cancel"}),S=a.i18n.translate("exceptionList-components.exception_list_header_Name_textbox",{defaultMessage:"Name"}),O=a.i18n.translate("exceptionList-components.exception_list_header_description_textbox",{defaultMessage:"Description (optional)"}),k=a.i18n.translate("exceptionList-components.exception_list_header_description_textboxexceptionList-components.exception_list_header_name_required_eror",{defaultMessage:"List name cannot be empty"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(361);const i=(e,t)=>{const n=Object(a.h)(e),i=Object(a.b)(e);return"create"===t?i:n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n.n(a),r=n(19),o=n(126);const s=Object(a.memo)((({title:e,subtitle:t,actions:n,children:s,restrictWidth:l=!1,hasBottomBorder:c=!0,hideHeader:u=!1,headerBackComponent:d,...p})=>{const m=Object(a.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},i.a.createElement(r.EuiFlexItem,{grow:!1},d&&i.a.createElement(i.a.Fragment,null,d)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"l"},i.a.createElement("span",{"data-test-subj":"header-page-title"},e))))),[d,e]),f=Object(a.useMemo)((()=>t?i.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},t):void 0),[t]),g=Object(o.a)(p["data-test-subj"]);return i.a.createElement("div",p,!u&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiPageHeader,{pageTitle:m,description:f,bottomBorder:c,rightSideItems:n?[n]:void 0,restrictWidth:l,"data-test-subj":g("header")}),i.a.createElement(r.EuiSpacer,{size:"l"})),i.a.createElement(r.EuiPageSection,{paddingSize:"none",color:"transparent",restrictWidth:l},s))}));s.displayName="AdministrationListPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(297);const r=["create","edit"],o=(e=!0,t=!0)=>{var n;const o=null!==(n=Object(i.a)().urlParams.show)&&void 0!==n?n:"";return Object(a.useMemo)((()=>!!r.includes(o)&&("create"===o&&t||"edit"===o&&e)),[t,e,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(42),c=n(126),u=n(245);const d=Object(r.memo)((({indicateExtraEntry:e=!1,"data-test-subj":t,...n})=>{const a=Object(c.a)(t);return o.a.createElement(s.EuiToolTip,i()({},n,{content:o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltip",defaultMessage:"Filtering the descendants of a process means that events from the matched process are ingested, but events from its descendant processes are omitted."})),e&&o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltipExtraEntry",defaultMessage:"Note: the following additional condition is applied:"})),o.a.createElement("p",null,o.a.createElement("code",null,u.g))),o.a.createElement("p",null,o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.tooltipVersionInfo",defaultMessage:"Process descendant filtering works only with Agents v8.15 and newer."}))),"data-test-subj":a("tooltipText")}),o.a.createElement(s.EuiIcon,{type:"iInCircle","data-test-subj":a("tooltipIcon")}))}));d.displayName="ProcessDescendantsTooltip"},function(e,t,n){var a=n(1274),i=n(1272),r=n(1273),o=n(749),s=n(786),l=n(848),c=n(849),u=n(850),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(o(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||r(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!a(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},function(e,t,n){e.exports=n(35)(1192)},function(e,t,n){e.exports=n(35)(1195)},function(e,t,n){e.exports=n(35)(1610)},function(e,t,n){e.exports=n(35)(173)},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(7),i=n(4),r=n(19),o=n(2),s=n.n(o),l=n(53),c=n(737),u=n(165),d=n(5),p=n(223),m=n(157),f=n(248),g=n(789),b=n(963),y=n(524),h=n(854);const v={index:{defaultValue:[],fieldsToValidateOnChange:["index","queryBar"],type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:s.a.createElement(r.EuiText,{size:"xs"},y.q),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(p.d)(t.ruleType)&&!Object(u.d)(t.ruleType)&&t.dataSourceType===f.a.IndexPatterns)return m.j.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},dataViewId:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewSelector",{defaultMessage:"Data view"}),fieldsToValidateOnChange:["dataViewId"],validations:[{validator:(...e)=>{const[{path:t,formData:n}]=e,a=null!=n.dataViewId&&""!==n.dataViewId;if(!Object(p.d)(n.ruleType)&&!a&&n.dataSourceType===f.a.DataView)return{path:t,message:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.dataViewSelectorFieldRequired",{defaultMessage:"Please select an available Data View or Index Pattern."})}}}]},dataViewTitle:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewTitleSelector",{defaultMessage:"Data view index pattern"}),validations:[]},eqlOptions:{fieldsToValidateOnChange:["eqlOptions","queryBar"]},queryBar:{fieldsToValidateOnChange:["queryBar","groupByFields"],validations:[{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e,{query:r,filters:o,saved_id:s}=t;if(!Object(p.d)(i.ruleType)&&Object(a.isEmpty)(r.query)&&Object(a.isEmpty)(o)&&!s)return{code:"ERR_FIELD_MISSING",path:n,message:Object(h.a)(i.ruleType)}}},{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e,{query:r}=t;if(!Object(p.d)(i.ruleType)&&!Object(a.isEmpty)(r.query)&&"kuery"===r.language)try{Object(l.fromKueryExpression)(r.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:n,message:y.r}}}},{validator:Object(g.a)(g.b,300)},{validator:Object(g.a)(b.a,300)}]},ruleType:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(p.d)(t.ruleType))return m.j.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{type:m.a.JSON,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"})},requiredFields:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return m.j.maxLengthField({length:3,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:m.a.NUMBER,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return m.j.numberGreaterThanField({than:1,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return Object(a.isEmpty)(t["threshold.cardinality.field"])&&!Object(a.isEmpty)(t["threshold.cardinality.value"])?m.j.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.NUMBER,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.n)(t.ruleType))return Object(a.isEmpty)(t["threshold.cardinality.field"])?void 0:m.j.numberGreaterThanField({than:1,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:s.a.createElement(r.EuiText,{size:"xs"},y.z),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.m)(t.ruleType))return m.j.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:n}]=e;if(Object(u.m)(t.ruleType))return c.b.forbiddenField(n,"*")}}]},threatMapping:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:n}]=e;if(Object(u.m)(n.ruleType))return Object(c.j)(n.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:y.A}:Object(c.a)(n.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:y.y}:void 0}}]},threatQueryBar:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e;if(!Object(u.m)(i.ruleType))return;const{query:r,filters:o}=t;return Object(a.isEmpty)(r.query)&&Object(a.isEmpty)(o)?{code:"ERR_FIELD_MISSING",path:n,message:y.f}:void 0}},{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e;if(!Object(u.m)(i.ruleType))return;const{query:r}=t;if(!Object(a.isEmpty)(r.query)&&"kuery"===r.language)try{Object(l.fromKueryExpression)(r.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:n,message:y.r}}}}]},newTermsFields:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsLabel",{defaultMessage:"Fields"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNewTermsFieldHelpText",{defaultMessage:"Select a field to check for new terms."}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.f)(t.ruleType))return m.j.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsMin",{defaultMessage:"A minimum of one field is required."}))(...e)}},{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.f)(t.ruleType))return m.j.maxLengthField({length:d.Yb,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.newTermsFieldsMax",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},historyWindowSize:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.historyWindowSizeLabel",{defaultMessage:"History Window Size"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.historyWindowSizeHelpText",{defaultMessage:"New terms rules only alert if terms don't appear in historical data."})},groupByFields:{type:m.a.COMBO_BOX,helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByFieldHelpText",{defaultMessage:"Select field(s) to use for suppressing extra alerts"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(u.j)(t.ruleType))return m.j.maxLengthField({length:3,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.groupByFieldsMax",{defaultMessage:"Number of grouping fields must be at most 3"})})(...e)}},{validator:(...e)=>{var t,n,a;const[{formData:i,value:r}]=e,o=r.length;if(!(Object(u.b)(i.ruleType)&&o>0))return;const s=null!==(t=null===(n=i.queryBar)||void 0===n||null===(a=n.query)||void 0===a?void 0:a.query)&&void 0!==t?t:"";return Object(u.c)(s)?{message:y.j}:void 0}}]},groupByRadioSelection:{},groupByDuration:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByDurationValueLabel",{defaultMessage:"Suppress alerts for"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByDurationValueHelpText",{defaultMessage:"Suppress alerts for"}),value:{},unit:{}},suppressionMissingFields:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.suppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})},shouldLoadQueryDynamically:{type:m.a.CHECKBOX,defaultValue:!1},enableThresholdSuppression:{type:m.a.CHECKBOX,defaultValue:!1}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1479);const i=({esqlQuery:e,search:t})=>({queryKey:[(null!=e?e:"").trim()],queryFn:async()=>{if(!e)return null;try{return await Object(a.a)({esqlQuery:e,search:t})}catch(e){return{error:e}}},staleTime:6e4})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(524),i=n(165);const r=e=>{const t=new Set(["string","number","ip","boolean"]);return e.filter((e=>!0===e.aggregatable&&t.has(e.type)))},o=e=>Object(i.d)(e)?a.l:Object(i.b)(e)?a.h:a.f},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return ht})),n.d(t,"a",(function(){return jt}));var a=n(44),i=n(19),r=n(2),o=n.n(r),s=n(45),l=n(41),c=n.n(l),u=n(64),d=n(122),p=n(140),m=n(129),f=n(158),g=n(243),b=n(127),y=n(55),h=n(59),v=n(365),E=n(331),x=n(121),j=n(4);const S=j.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineBtn",{defaultMessage:"New"}),O=j.i18n.translate("xpack.securitySolution.timeline.modal.newTimeline",{defaultMessage:"New Timeline"}),k=j.i18n.translate("xpack.securitySolution.timeline.modal.newTimelineTemplate",{defaultMessage:"New Timeline template"}),w=j.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtn",{defaultMessage:"Open"}),T=j.i18n.translate("xpack.securitySolution.timeline.modal.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),I=j.i18n.translate("xpack.securitySolution.timeline.modal.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),M=j.i18n.translate("xpack.securitySolution.timeline.modal.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),C=j.i18n.translate("xpack.securitySolution.timeline.modal.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"}),_=j.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),D=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"}),A=j.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),F=j.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),N=j.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),P=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),R=j.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),L=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),z=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),q=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),B=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),$=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"}),V=j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"}),U=o.a.memo((({timelineId:e})=>{const[t,n]=Object(r.useState)(!1),a=Object(r.useCallback)((()=>n((e=>!e))),[]),s=Object(E.a)({timelineId:e,timelineType:x.m.default,onClick:a}),l=Object(E.a)({timelineId:e,timelineType:x.m.template,onClick:a}),c=Object(r.useMemo)((()=>o.a.createElement(i.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right","data-test-subj":"timeline-modal-new-timeline-dropdown-button",onClick:a},S)),[a]),u=Object(r.useCallback)((async()=>{await s()}),[s]),d=Object(r.useCallback)((async()=>{await l()}),[l]),p=Object(r.useMemo)((()=>[o.a.createElement(i.EuiContextMenuItem,{key:"new-timeline",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline",onClick:u},O),o.a.createElement(i.EuiContextMenuItem,{key:"new-timeline-template",icon:"plusInCircle","data-test-subj":"timeline-modal-new-timeline-template",onClick:d},k)]),[u,d]);return o.a.createElement(i.EuiPopover,{button:c,isOpen:t,closePopover:a,panelPaddingSize:"none"},o.a.createElement(i.EuiContextMenuPanel,{items:p}))}));U.displayName="NewTimelineButton";var G=n(815);const H=["createFrom"],W=o.a.memo((()=>{const[e,t]=Object(r.useState)(!1),n=Object(r.useCallback)((()=>t((e=>!e))),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"timeline-modal-open-timeline-button",onClick:n,"aria-label":T},w),e?o.a.createElement(G.a,{onClose:n,hideActions:H}):null)}));W.displayName="OpenTimelineButton";var Q=n(36),Y=n(169),K=n(213),J=n(118),Z=n(132),X=n(250);const ee=e=>j.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} other {template}}",values:{isTimeline:e}});var te=n(912),ne=n(913),ae=n(181),ie=n(138),re=n(510),oe=n(5),se=n(13),le=n(146),ce=n(194),ue=n(156);const de=o.a.memo((({timelineId:e})=>{const t=Object(s.useDispatch)(),{graphEventId:n,savedObjectId:a,status:l,title:c,timelineType:u}=Object(s.useSelector)((t=>Object(Y.selectTimelineById)(t,e))),{cases:d,application:{navigateToApp:p}}=Object(J.j)().services,m=d.helpers.canUseCases([oe.j]),[f,g]=Object(r.useState)(!1),[b,y]=Object(r.useState)(!1),h=Object(r.useCallback)((()=>g((e=>!e))),[]),v=Object(r.useCallback)((()=>y(!1)),[y]),E=Object(r.useCallback)((async i=>{v(),await p(oe.m,{deepLinkId:ue.a.case,path:null!=i?Object(ce.a)({id:i.id}):Object(ce.b)()}),t(Object(se.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:c}))}),[v,t,n,p,a,e,c]),j=Object(r.useCallback)((()=>{h(),p(oe.m,{deepLinkId:ue.a.case,path:Object(ce.b)()}).then((()=>{t(Object(se.setInsertTimeline)({graphEventId:n,timelineId:e,timelineSavedObjectId:a,timelineTitle:c.length>0?c:re.d})),t(Object(se.showTimeline)({id:le.c.active,show:!1}))}))}),[t,n,p,a,e,c,h]),S=Object(r.useCallback)((()=>{h(),y(!0)}),[h,y]),O=Object(r.useMemo)((()=>o.a.createElement(i.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",disabled:l===x.l.draft||u!==x.m.default,"data-test-subj":"timeline-modal-attach-to-case-dropdown-button",onClick:h},I)),[h,l,u]),k=Object(r.useMemo)((()=>[o.a.createElement(i.EuiContextMenuItem,{key:"new-case","data-test-subj":"timeline-modal-attach-timeline-to-new-case",onClick:j},M),o.a.createElement(i.EuiContextMenuItem,{key:"existing-case","data-test-subj":"timeline-modal-attach-timeline-to-existing-case",onClick:S},C)]),[S,j]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiPopover,{button:O,isOpen:f,closePopover:h,panelPaddingSize:"none"},o.a.createElement(i.EuiContextMenuPanel,{items:k})),b&&d.ui.getAllCasesSelectorModal({onRowClick:E,onClose:v,owner:[oe.j],permissions:m}))}));de.displayName="AttachToCaseButton";var pe=n(271),me=n.n(pe),fe=n(157),ge=n(187),be=n(219);const ye={title:{type:fe.a.TEXT,validations:[{validator:fe.j.emptyField("")}]},description:{type:fe.a.TEXTAREA,validations:[]}},he=Object(fe.l)({component:fe.b}),ve=`${q} (${B})`,Ee=o.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:n,showWarning:a})=>{const{startTransaction:l}=Object(ge.b)(),c=Object(s.useDispatch)(),{isSaving:u,description:d,status:p,title:f,timelineType:g}=Object(s.useSelector)((e=>Object(Y.selectTimelineById)(e,n))),[b,y]=Object(r.useState)(!1),h=Object(r.useCallback)((e=>y(e.target.checked)),[]),v=p===x.l.draft,S=me()(u),O=Object(E.a)({timelineId:le.c.active,timelineType:x.m.default}),k=Object(r.useCallback)(((e,t)=>(t&&(c(m.a.updateTitleAndDescription({id:n,...e})),c(m.a.saveTimeline({id:n,saveAsNew:b}))),Promise.resolve())),[c,n,b]),w=Object(r.useMemo)((()=>({title:f,description:d})),[f,d]),{form:T}=Object(fe.m)({id:"timelineTitleAndDescriptionForm",schema:ye,onSubmit:k,options:{stripEmptyFields:!1},defaultValue:w}),{isSubmitted:I,isSubmitting:M,submit:C}=T,_=Object(r.useCallback)((()=>{l({name:be.f.SAVE}),C()}),[C,l]),B=Object(r.useCallback)((async()=>{a&&await O(),e()}),[e,O,a]),U=Object(r.useMemo)((()=>p===x.l.draft&&a?g===x.m.template?R:P:L),[a,p,g]),G=Object(r.useMemo)((()=>p===x.l.draft?g===x.m.template?A:D:g===x.m.template?N:D),[p,g]),H=Object(r.useMemo)((()=>p===x.l.draft&&a?g===x.m.template?A:D:F),[a,p,g]),W=Object(r.useMemo)((()=>(e=>j.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===x.m.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(g)),[g]),Q=Object(r.useMemo)((()=>({"aria-label":z,autoFocus:"title"===t,"data-test-subj":"save-timeline-modal-title-input",disabled:u,spellCheck:!0,placeholder:g===x.m.template?re.c:re.d})),[t,u,g]),K=Object(r.useMemo)((()=>({"aria-label":q,"data-test-subj":"save-timeline-modal-description-input",disabled:u,placeholder:re.a})),[u]);return Object(r.useEffect)((()=>{I&&!u&&S&&e()}),[I,u,S,e]),o.a.createElement(i.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},u&&o.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),o.a.createElement(i.EuiModalHeader,{"data-test-subj":"save-timeline-modal-header"},G),o.a.createElement(i.EuiModalBody,null,a&&o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(i.EuiCallOut,{title:W,color:"danger",iconType:"warning","data-test-subj":"save-timeline-modal-callout"}),o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(fe.c,{form:T},o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(he,{path:"title",fullWidth:!0,label:$,euiFieldProps:Q}),o.a.createElement(i.EuiSpacer,null)),o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(he,{label:ve,path:"description",fullWidth:!0,euiFieldProps:K}),o.a.createElement(i.EuiSpacer,null)),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiFlexGroup,{direction:"row",alignItems:"center"},v?null:o.a.createElement(i.EuiSwitch,{label:V,checked:b,onChange:h,"data-test-subj":"save-timeline-modal-save-as-new-switch"}),o.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},o.a.createElement(i.EuiFlexItem,{grow:!1,component:"span"},o.a.createElement(i.EuiButton,{size:"s",fill:!1,onClick:B,isDisabled:u,"data-test-subj":"save-timeline-modal-close-button"},U)),o.a.createElement(i.EuiFlexItem,{grow:!1,component:"span"},o.a.createElement(i.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:u||M,fill:!0,onClick:_,"data-test-subj":"save-timeline-modal-save-button"},H))))))))}));Ee.displayName="SaveTimelineModal";const xe=o.a.memo((({timelineId:e})=>{const[t,n]=Object(r.useState)(!1),a=Object(r.useCallback)((()=>n((e=>!e))),[]),{kibanaSecuritySolutionsPrivileges:{crud:l}}=Object(p.a)(),{status:c,isSaving:u}=Object(s.useSelector)((t=>Object(Y.selectTimelineById)(t,e))),d=l&&c!==x.l.immutable,m=c===x.l.draft,f=d?null:_;return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiToolTip,{content:f,position:"bottom","data-test-subj":"timeline-modal-save-timeline-tooltip"},o.a.createElement(i.EuiButton,{id:v.a.SAVE_TIMELINE,fill:!0,size:"s",iconType:"save",isLoading:u,disabled:!d,"data-test-subj":"timeline-modal-save-timeline",onClick:a},F)),t&&d?o.a.createElement(Ee,{initialFocusOn:m?"title":"save",timelineId:e,showWarning:!1,closeSaveTimeline:a}):null)}));xe.displayName="SaveTimelineButton";const je=c.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1lpfyda-0"})(["width:0;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),Se=Object(h.euiStyled)(i.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({theme:e})=>e.eui.euiBorderRadius};
`,Oe=o.a.memo((({timelineId:e,openToggleRef:t})=>{const n=Object(s.useDispatch)(),{browserFields:a,indexPattern:l}=Object(Z.a)(b.SourcererScopeName.timeline),{cases:c,uiSettings:u}=Object(J.j)().services,d=Object(r.useMemo)((()=>Object(y.getEsQueryConfig)(u)),[u]),p=c.helpers.canUseCases([Q.APP_ID]),f=Object(s.useSelector)((t=>Object(Y.selectTitleByTimelineById)(t,e))),g=Object(s.useSelector)((t=>Object(Y.selectDataInTimeline)(t,e))),h=Object(s.useSelector)((t=>Object(Y.selectKqlQuery)(t,e))),{activeTab:E,dataProviders:x,timelineType:j,filters:S,kqlMode:O}=Object(s.useSelector)((t=>Object(Y.selectTimelineById)(t,e))),k=Object(r.useMemo)((()=>Object(X.d)({config:d,dataProviders:x,indexPattern:l,browserFields:a,filters:S||[],kqlQuery:h,kqlMode:O})),[a,x,d,S,l,O,h]),w=!g||void 0===(null==k?void 0:k.filterQuery),T=Object(r.useCallback)((()=>{null!=t.current&&t.current.focus(),Object(K.a)(),n(m.a.showTimeline({id:e,show:!1}))}),[n,e,t]);return o.a.createElement(Se,{grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-modal-header-panel"},o.a.createElement(ke,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(te.a,{timelineId:e,isPartOfGuidedTour:!0})),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(we,{grow:!1,"data-test-subj":"timeline-modal-header-title"},o.a.createElement("h3",null,f))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(ne.a,{timelineId:e})))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiFlexGroup,{id:v.a.ACTION_MENU,justifyContent:"flexEnd",alignItems:"center",gutterSize:"xs",responsive:!1,"data-test-subj":"timeline-modal-header-actions"},o.a.createElement(i.EuiFlexItem,null,o.a.createElement(U,{timelineId:e})),o.a.createElement(i.EuiFlexItem,null,o.a.createElement(W,null)),o.a.createElement(i.EuiFlexItem,null,o.a.createElement(ae.b,{queryId:`${e}-${E}`,inputId:ie.a.timeline,isDisabled:w})),p.create&&p.read?o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiFlexItem,null,o.a.createElement(je,null)),o.a.createElement(i.EuiFlexItem,null,o.a.createElement(de,{timelineId:e}))):null,o.a.createElement(i.EuiFlexItem,null,o.a.createElement(xe,{timelineId:e})),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiToolTip,{content:ee("default"===j)},o.a.createElement(i.EuiButtonIcon,{"aria-label":ee("default"===j),iconType:"cross","data-test-subj":"timeline-modal-header-close-button",onClick:T})))))))}));Oe.displayName="TimelineModalHeader";var ke=c()(i.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1lpfyda-1"})(["",""],{"overflow-x":"auto"}),we=c()(i.EuiText).withConfig({displayName:"_StyledEuiText",componentId:"sc-1lpfyda-2"})(["",""],{"white-space":"nowrap"}),Te=n(124),Ie=n(191),Me=n(443),Ce=n(119),_e=n.n(Ce),De=n(972),Ae=n(767),Fe=n(914);const Ne=j.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),Pe=j.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),Re=j.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),Le=j.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),ze=j.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),qe=(j.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),j.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"})),Be=j.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var $e=n(16);const Ve=c.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1fs16o3-0"})(["flex:1;"]),Ue=(e,t=o.a.createElement(i.EuiSkeletonText,{lines:10}))=>{var n;const a=o.a.forwardRef(((n,a)=>o.a.createElement(r.Suspense,{fallback:t},o.a.createElement(e,_e()({},n,{ref:a})))));return a.displayName=`${null!==(n=e.displayName)&&void 0!==n?n:"Tab"}WithSuspense`,a},Ge=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(36)]).then(n.bind(null,2115))))),He=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(37)]).then(n.bind(null,2123))))),We=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(49)]).then(n.bind(null,2092))))),Qe=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(66)]).then(n.bind(null,2139))))),Ye=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(38)]).then(n.bind(null,2093))))),Ke=Ue(Object(r.lazy)((()=>Promise.all([n.e(5),n.e(6),n.e(7),n.e(9),n.e(8),n.e(10),n.e(13),n.e(12),n.e(14),n.e(67)]).then(n.bind(null,2094))))),Je=Ue(Object(r.lazy)((()=>n.e(64).then(n.bind(null,2119))))),Ze=Object(r.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:i,showTimeline:s})=>{const{isTimelineEsqlEnabledByFeatureFlag:l,isEsqlAdvancedSettingEnabled:c}=Object(De.a)(),u=Object(Te.b)((e=>Object(Y.selectTimelineESQLSavedSearchId)(e,a))),d=Object(r.useMemo)((()=>!!l&&(c||null!=u)),[c,l,u]),p=Object(r.useCallback)((e=>{switch(e){case le.d.graph:return o.a.createElement(We,{timelineId:a});case le.d.notes:return o.a.createElement(Qe,{timelineId:a});case le.d.session:return o.a.createElement(Ke,{timelineId:a});default:return null}}),[a]),m=Object(r.useMemo)((()=>[le.d.graph,le.d.notes,le.d.session].includes(e)),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ve,{$isVisible:le.d.query===e,"data-test-subj":`timeline-tab-content-${le.d.query}`},o.a.createElement(Ge,{renderCellValue:t,rowRenderers:n,timelineId:a})),s&&d&&e===le.d.esql&&o.a.createElement(Ve,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${le.d.esql}`},o.a.createElement(Je,{timelineId:a})),o.a.createElement(Ve,{$isVisible:le.d.pinned===e,"data-test-subj":`timeline-tab-content-${le.d.pinned}`},o.a.createElement(Ye,{renderCellValue:t,rowRenderers:n,timelineId:a})),i===x.m.default&&o.a.createElement(Ve,{$isVisible:le.d.eql===e,"data-test-subj":`timeline-tab-content-${le.d.eql}`},o.a.createElement(He,{renderCellValue:t,rowRenderers:n,timelineId:a})),o.a.createElement(Ve,{$isVisible:m,isOverflowYScroll:e===le.d.session,"data-test-subj":`timeline-tab-content-${le.d.graph}-${le.d.notes}`},m&&p(e)))}));Ze.displayName="ActiveTimelineTab";const Xe=c()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1fs16o3-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),et=c()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1fs16o3-2"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),tt=c()(i.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1fs16o3-3"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),nt=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:l,timelineType:c,graphEventId:u,sessionViewConfig:d,timelineDescription:p})=>{const f=Object(s.useDispatch)(),g=Object(r.useMemo)((()=>Object(Fe.a)()),[]),b=Object(r.useMemo)((()=>Object(Fe.g)()),[]),y=Object(r.useMemo)((()=>Object(Fe.e)()),[]),h=Object(r.useMemo)((()=>Object(Fe.d)()),[]),v=Object(r.useMemo)((()=>Object(Fe.c)()),[]),E=Object(r.useMemo)((()=>Object(Fe.b)()),[]),{isEsqlAdvancedSettingEnabled:j,isTimelineEsqlEnabledByFeatureFlag:S}=Object(De.a)(),O=Object(Te.b)((e=>Object(Y.selectTimelineESQLSavedSearchId)(e,n))),k=Object(Te.b)((e=>g(e,n))),w=Object(Te.b)((e=>b(e,n))),T=Object(r.useMemo)((()=>!!S&&(j||null!=O)),[j,S,O]),I=Object(Te.b)((e=>y(e,n))),M=Object(Te.a)((e=>v(e,n))),C=Object(Te.a)((e=>E(e,n))),_=Object(Te.a)((e=>h(e))),D=Object($e.b)().isEnterprise(),A=Object(r.useMemo)((()=>{const e=Object.values(C).reduce(((e,t)=>[...e,...t]),[]);return[...M,...e]}),[M,C]),F=Object(r.useMemo)((()=>_.filter((e=>A.includes(e.id))).length+(Object(a.isEmpty)(p)?0:1)),[_,A,p]),N=Object(r.useCallback)((e=>{f(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[f,n]),P=Object(r.useCallback)((()=>{N(le.d.query)}),[N]),R=Object(r.useCallback)((()=>{N(le.d.eql)}),[N]),L=Object(r.useCallback)((()=>{N(le.d.graph)}),[N]),z=Object(r.useCallback)((()=>{N(le.d.notes)}),[N]),q=Object(r.useCallback)((()=>{N(le.d.pinned)}),[N]),B=Object(r.useCallback)((()=>{N(le.d.session)}),[N]),$=Object(r.useCallback)((()=>{f(Object(se.initializeTimelineSettings)({id:n})),N(le.d.esql)}),[N,f,n]);return Object(r.useEffect)((()=>{u||k!==le.d.graph||P()}),[k,u,P]),o.a.createElement(o.a.Fragment,null,!l&&o.a.createElement(tt,{className:"eui-scrollBar"},o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.query}`,onClick:P,isSelected:k===le.d.query,disabled:!1,key:le.d.query},o.a.createElement("span",null,Ne),w&&o.a.createElement(Ae.b,null)),T&&o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.esql}`,onClick:$,isSelected:k===le.d.esql,disabled:!1,key:le.d.esql},o.a.createElement("span",null,qe)),c===x.m.default&&o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.eql}`,onClick:R,isSelected:k===le.d.eql,disabled:!1,key:le.d.eql},o.a.createElement("span",null,Pe),w&&o.a.createElement(Ae.a,null)),o.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${le.d.graph}`,onClick:L,isSelected:k===le.d.graph,disabled:!u,key:le.d.graph},Re),D&&o.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${le.d.session}`,onClick:B,isSelected:k===le.d.session,disabled:null===d,key:le.d.session},Be),o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.notes}`,onClick:z,isSelected:k===le.d.notes,disabled:c===x.m.template,key:le.d.notes},o.a.createElement("span",null,Le),w&&F>0&&c===x.m.default&&o.a.createElement("div",null,o.a.createElement(Xe,null,F))),o.a.createElement(et,{"data-test-subj":`timelineTabs-${le.d.pinned}`,onClick:q,disabled:c===x.m.template,isSelected:k===le.d.pinned,key:le.d.pinned},o.a.createElement("span",null,ze),w&&I>0&&c===x.m.default&&o.a.createElement("div",null,o.a.createElement(Xe,null,I)))),o.a.createElement(Ze,{activeTimelineTab:k,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:c,timelineDescription:p,showTimeline:w}))},at=Object(r.memo)(nt);var it=n(180),rt=n(206),ot=n(583),st=n(48),lt=n(58),ct=n(198),ut=n(148),dt=n(768),pt=n(651);const mt=e=>{var t;const{activeTab:n,switchToTab:a,timelineType:s}=e,{services:{storage:l}}=Object(J.j)(),c=Object(r.useMemo)((()=>v.b.filter((e=>!e.timelineType||e.timelineType===s))),[s]),[u,d]=Object(r.useState)((()=>{const e=l.get(oe.cc.TIMELINE);return null!=e?e:v.c})),p=Object(r.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),m=Object(r.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(r.useEffect)((()=>{l.set(oe.cc.TIMELINE,u)}),[u,l]);const f=Object(r.useCallback)((e=>e===c.length?o.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:p},pt.h):[o.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:p},pt.g),o.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:m},pt.j)]),[p,m,c.length]),g=null===(t=c[u.currentTourStep-1])||void 0===t?void 0:t.anchor,b=Object(dt.a)(g),y=c[u.currentTourStep-1];return null!=y&&y.timelineTab&&y.timelineTab!==n&&a(y.timelineTab),u.isTourActive&&b?o.a.createElement(o.a.Fragment,null,c.map(((e,t)=>{const n=t+1;if(u.currentTourStep!==n)return null;const a={"data-test-subj":`timeline-tour-step-${t+1}`};return o.a.createElement(i.EuiTourStep,{panelProps:a,key:t,step:n,isStepOpen:u.isTourActive&&u.currentTourStep===t+1,minWidth:u.tourPopoverWidth,stepsTotal:c.length,onFinish:p,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:v.c.tourSubtitle,footerAction:f(n)})}))):null},ft=o.a.memo(mt);var gt=n(274);const bt=c.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),yt=c.a.div.withConfig({displayName:"TimelineBody",componentId:"sc-4r2lej-1"})(["height:100%;display:flex;flex-direction:column;"]),ht=Object(r.createContext)({timelineId:null}),vt=({timelineId:e})=>{const t=Object(r.useMemo)((()=>m.b.getTimelineByIdSelector()),[]);return Object(Te.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:f.b).isSaving}))?o.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Et=o.a.memo(vt),xt=({renderCellValue:e,rowRenderers:t,timelineId:n,openToggleRef:l})=>{const c=Object(s.useDispatch)(),y=Object(d.a)("unifiedComponentsInTimelineDisabled"),h=Object(r.useRef)(null),v=Object(r.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),E=Object(s.useSelector)((e=>ut.e.sourcererScopeSelectedPatterns(e,b.SourcererScopeName.timeline))),j=Object(s.useSelector)((e=>ut.e.sourcererScopeSelectedDataViewId(e,b.SourcererScopeName.timeline))),{dataViewId:S,indexNames:O,graphEventId:k,savedObjectId:w,timelineType:T,description:I,sessionViewConfig:M,initialized:C,show:_,isLoading:D,activeTab:A}=Object(Te.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=v(e,n))&&void 0!==t?t:f.b)})),{kibanaSecuritySolutionsPrivileges:{crud:F}}=Object(p.a)(),{timelineFullScreen:N}=Object(rt.c)();Object(r.useEffect)((()=>{w||C||c(m.a.createTimeline({id:n,columns:y?g.b:gt.a,dataViewId:j,indexNames:E,show:!1,excludedRowRendererIds:y?[]:f.b.excludedRowRendererIds}))}),[]);const P=Object(r.useCallback)((()=>{!w||null==j||null===S&&0===O.length||S===j&&O.sort().join()===E.sort().join()||c(m.a.updateDataView({dataViewId:j,id:n,indexNames:E}))}),[c,w,j,S,E,O,n]);Object(r.useEffect)((()=>{P()}),[j,E]);const R=Object(r.useCallback)((()=>{var e;const t=null===(e=h.current)||void 0===e?void 0:e.querySelector(ot.a);var n,a;null!=t?t.focus():null===(n=h.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[h]),L=Object(r.useCallback)((()=>{var e,t;null===(e=h.current)||void 0===e||null===(t=e.querySelector(`.${Ie.c}`))||void 0===t||t.focus()}),[h]),z=Object(r.useCallback)((e=>{Object(u.isTab)(e)&&Object(Ie.k)({containerElement:h.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:R,onSkipFocusAfterEventsTable:L})}),[h,R,L]),q=Object(r.useMemo)((()=>({timelineId:n})),[n]),B=(()=>{const{search:e,pathname:t}=Object(st.useLocation)(),{spaces:n}=Object(J.j)().services,a=Object(r.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:s,savedObjectId:l,show:c,graphEventId:u,activeTab:d}=Object(Te.a)((e=>{var t;return null!==(t=a(e,le.c.active))&&void 0!==t?t:f.b})),p=Object(r.useCallback)((()=>{var a,r,p;const m=new URLSearchParams(e),f=null!==(a=m.get(ct.a.timeline))&&void 0!==a?a:void 0,g={id:null!=l?l:"",isOpen:!!c,activeTab:d,graphEventId:u},b=null!==(r=Object(lt.safeDecode)(null!=f?f:""))&&void 0!==r?r:g,y=null==b?void 0:b.id;if(!n||"conflict"!==(null==s?void 0:s.outcome)||null==(null==s?void 0:s.alias_target_id)||null==y)return null;const h=null!==(p=null==s?void 0:s.alias_target_id)&&void 0!==p?p:"",v={...b,id:h},E=Object(lt.encode)(v);m.set(ct.a.timeline,E);const x=`${t}?${m.toString()}${window.location.hash}`;return o.a.createElement(o.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:ct.a.timeline,currentObjectId:y,otherObjectId:h,otherObjectPath:x}),o.a.createElement(i.EuiSpacer,null))}),[d,u,t,null==s?void 0:s.alias_target_id,null==s?void 0:s.outcome,l,e,c,n]);return Object(r.useMemo)((()=>p()),[p])})(),$=_&&!D&&F,V=Object(r.useCallback)((e=>{c(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[n,c]);return o.a.createElement(ht.Provider,{value:q},o.a.createElement(it.B,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:z,ref:h},o.a.createElement(Et,{timelineId:n}),o.a.createElement(yt,{"data-test-subj":"timeline-body"},T===x.m.template&&o.a.createElement(bt,{className:"timeline-template-badge"},Me.f),B,o.a.createElement(it.y,{$isVisible:!N,"data-test-subj":"timeline-hide-show-container"},o.a.createElement(Oe,{timelineId:n,openToggleRef:l})),o.a.createElement(at,{graphEventId:k,sessionViewConfig:M,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:T,timelineDescription:I,timelineFullScreen:N}))),$?o.a.createElement(ft,{activeTab:A,switchToTab:V,timelineType:T}):null)};xt.displayName="StatefulTimelineComponent";const jt=o.a.memo(xt)},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(2),i=n.n(a),r=n(201),o=n(983),s=n(314),l=n(527),c=n(745),u=n(804),d=n(41),p=n.n(d),m=n(19),f=n(4);const g=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlRunJobLabel",{defaultMessage:"Run job"}),b=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlStopJobLabel",{defaultMessage:"Stop job"}),y=(f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlAdminPermissionsRequiredDescription",{defaultMessage:"ML Admin Permissions required to perform this action"}));var h=n(223),v=n(690),E=function(e){return e.info="info",e.warning="warning",e.error="error",e}(E||{});const x=({message:e})=>{if(!e)return null;let t="primary",n="warning";return e.level===E.info?n="iInCircle":e.level===E.warning?t="warning":e.level===E.error&&(t="danger"),i.a.createElement(m.EuiToolTip,{content:e.text},i.a.createElement(m.EuiIcon,{"data-test-subj":"mlJobAuditIcon",type:n,color:t}))},j=Object(a.memo)(x),S=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),O=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),k=({job:e})=>{const t=Object(h.c)(e.jobState,e.datafeedState),n=t?"success":"danger",a=t?S:O;return i.a.createElement(m.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:n},a)},w=Object(a.memo)(k),T=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-mrslp7-0"})(["overflow:hidden;"]),I=({job:e,switchComponent:t,...n})=>{var a;const r=Object(h.c)(e.jobState,e.datafeedState);return i.a.createElement(T,n,i.a.createElement("div",null,i.a.createElement(v.a,{jobId:e.id,jobName:null===(a=e.customSettings)||void 0===a?void 0:a.security_app_display_name}),i.a.createElement(j,{message:e.auditMessage})),i.a.createElement(m.EuiFlexGroup,{justifyContent:"flexStart"},i.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginRight:"0"}},i.a.createElement(w,{job:e})),i.a.createElement(m.EuiFlexItem,{grow:!1},t),i.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginLeft:"0"},"data-test-subj":"mlJobActionLabel"},r?b:g)))},M=Object(a.memo)(I),C=({job:e,loading:t,refreshJob:n})=>{const{enableDatafeed:r,disableDatafeed:o,isLoading:s}=Object(c.a)(),l=Object(a.useCallback)((async(t,a,i)=>{i?await r(e,a):await o(e),n(e)}),[r,o,e,n]),d=Object(a.useMemo)((()=>i.a.createElement(u.a,{job:e,isSecurityJobsLoading:t||s,onJobStateChange:l})),[l,s,e,t]);return i.a.createElement(M,{job:e,switchComponent:d})},_=Object(a.memo)(C),D=({jobIds:e})=>{const{loading:t,jobs:n,refetch:a,isMlAdmin:r}=Object(l.a)();if(!r)return null;const o=n.filter((t=>e.includes(t.id)));return i.a.createElement(i.a.Fragment,null,o.map((e=>i.a.createElement(_,{key:e.id,job:e,loading:t,refreshJob:a}))))},A=Object(a.memo)(D);var F=n(562),N=n(1337),P=n.n(N);const R=({job:e})=>{const t=Object(a.useMemo)((()=>i.a.createElement(m.EuiToolTip,{content:y},i.a.createElement(m.EuiSwitch,{disabled:!0,"data-test-subj":"mlUserJobSwitch",showLabel:!1,label:"",checked:Object(h.c)(e.jobState,e.datafeedState),onChange:P.a}))),[e]);return i.a.createElement(M,{job:e,switchComponent:t})},L=Object(a.memo)(R),z=({jobIds:e})=>{const{isMlUser:t,jobs:n}=Object(F.b)();if(!t)return null;const a=n.filter((t=>e.includes(t.id)));return i.a.createElement(i.a.Fragment,null,a.map((e=>i.a.createElement(L,{key:e.id,job:e}))))},q=Object(a.memo)(z),B=({jobIds:e})=>{const t=Object(r.a)(),n=Object(s.a)(t);return Object(o.a)(t)?i.a.createElement(A,{jobIds:e}):n?i.a.createElement(q,{jobIds:e}):null},$=Object(a.memo)(B)},function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var a=n(19),i=n(2),r=n.n(i),o=n(44),s=n(629),l=n(630);const c=r.a.memo((({contextId:e,eventId:t,isDraggable:n,tlsClientCertificateFingerprintSha1:i,tlsFingerprintsJa3Hash:c,tlsServerCertificateFingerprintSha1:u})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"fingerprints-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=c?Object(o.uniq)(c).map((i=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:i},r.a.createElement(l.b,{eventId:t,fieldName:l.a,contextId:e,isDraggable:n,value:i})))):null,null!=i?Object(o.uniq)(i).map((i=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:i},r.a.createElement(s.a,{eventId:t,certificateType:"client",contextId:e,fieldName:s.b,isDraggable:n,value:i})))):null,null!=u?Object(o.uniq)(u).map((i=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:i},r.a.createElement(s.a,{eventId:t,certificateType:"server",contextId:e,fieldName:s.c,isDraggable:n,value:i})))):null)));c.displayName="Fingerprints";var u=n(41),d=n.n(u),p=n(137),m=n(134),f=n(486);const g="questionInCircle",b=e=>{if(null==e)return g;switch(`${e}`.toLowerCase()){case p.l.outbound:case p.l.outgoing:return"arrowUp";case p.l.inbound:case p.l.incoming:case p.l.listening:return"arrowDown";case p.l.external:return"globe";case p.l.internal:return"bullseye";case p.l.unknown:default:return g}},y=r.a.memo((({contextId:e,eventId:t,direction:n,isDraggable:a})=>r.a.createElement(m.c,{contextId:e,eventId:t,field:f.c,iconType:b(n),isDraggable:a,value:n,isAggregatable:!0,fieldType:"keyword"})));y.displayName="DirectionBadge";var h=n(832),v=n(665);const E=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-10udnrm-0"})(["margin-right:3px;"]);E.displayName="EuiFlexItemMarginRight";const x=d()(a.EuiText).withConfig({displayName:"Stats",componentId:"sc-10udnrm-1"})(["margin:0 5px;"]);x.displayName="Stats";const j=r.a.memo((({bytes:e,communityId:t,contextId:n,direction:i,eventId:s,isDraggable:l,packets:c,protocol:u,transport:d})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none"},null!=i?Object(o.uniq)(i).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(y,{contextId:n,direction:e,eventId:s,isDraggable:l})))):null,null!=u?Object(o.uniq)(u).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.c,{contextId:n,eventId:s,field:f.e,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=e?Object(o.uniq)(e).map((e=>isNaN(Number(e))?null:r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.b,{field:f.a,id:`network-default-draggable-${n}-${s}-${f.a}-${e}`,isDraggable:l,value:e},r.a.createElement(x,{size:"xs"},r.a.createElement("span",null,r.a.createElement(v.a,{value:e}))))))):null,null!=c?Object(o.uniq)(c).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.b,{field:f.d,id:`network-default-draggable-${n}-${s}-${f.d}-${e}`,isDraggable:l,value:e},r.a.createElement(x,{size:"xs"},r.a.createElement("span",null,`${e} ${h.a}`)))))):null,null!=d?Object(o.uniq)(d).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.c,{contextId:n,"data-test-subj":"network-transport",eventId:s,field:f.f,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=t?Object(o.uniq)(t).map((e=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:e},r.a.createElement(m.c,{contextId:n,eventId:s,field:f.b,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null)));j.displayName="Network";var S=n(569),O=n(188),k=n.n(O),w=n(406),T=n(1102),I=n(382),M=n(434),C=n(591);const _=d.a.span.withConfig({displayName:"IpPortSeparator",componentId:"sc-12b0nt-0"})(["margin:0 3px;"]);_.displayName="IpPortSeparator";const D=r.a.memo((({contextId:e,eventId:t,isDraggable:n,port:i,portFieldName:o})=>null!=i?r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(_,{"data-test-subj":"ip-port-separator"},":")),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(T.a,{contextId:e,"data-test-subj":"port",eventId:t,fieldName:o,isDraggable:n,value:i}))):null));D.displayName="PortWithSeparator";const A=r.a.memo((({contextId:e,eventId:t,ip:n,ipFieldName:i,isDraggable:o,port:s,portFieldName:l})=>r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(w.c,{contextId:e,"data-test-subj":"ip",eventId:t,fieldName:i,isDraggable:o,value:n})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(D,{contextId:e,eventId:t,isDraggable:o,port:s,portFieldName:l})))));A.displayName="IpWithPort";const F=d.a.div.withConfig({displayName:"Label",componentId:"sc-1ym4dlz-0"})(["font-weight:bold;margin-top:2px;"]),N=({destinationIp:e,sourceIp:t,type:n})=>"source"===n&&null!=t&&t.some((e=>!Object(o.isEmpty)(e)))||"destination"===n&&null!=e&&e.some((e=>!Object(o.isEmpty)(e))),P=({destinationPort:e,sourcePort:t,type:n})=>("source"===n&&null!=t?t:"destination"===n&&null!=e?e:[]).filter((e=>null!=e)).map((e=>`${e}`)).filter((e=>!Object(o.isEmpty)(e))),R=r.a.memo((({contextId:e,destinationIp:t,destinationPort:n,eventId:i,isDraggable:s,sourceIp:l,sourcePort:c,type:u})=>{const d="source"===u?l:t,p="source"===u?w.d:w.a,m="source"===u?c:n,f="source"===u?I.c:I.a;if(null==d)return null;const g=null!=m&&d.length===m.length?d.map(((e,t)=>({ip:e,port:null!=m[t]?`${m[t]}`:null}))):d.map((e=>({ip:e,port:null})));return r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},Object(o.uniqWith)(k.a,g).map((t=>null!=t.ip&&r.a.createElement(a.EuiFlexItem,{grow:!1,key:t.ip},r.a.createElement(A,{contextId:e,"data-test-subj":`${u}-ip-and-port`,eventId:i,ip:t.ip,ipFieldName:p,isDraggable:s,port:t.port,portFieldName:f})))))}));R.displayName="IpAdressesWithPorts";const L=r.a.memo((({contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:n,destinationGeoCountryIsoCode:i,destinationGeoRegionName:o,destinationGeoCityName:s,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:f,sourceGeoRegionName:g,sourceGeoCityName:b,sourceIp:y,sourcePort:h,type:v})=>{const E="source"===v?M.i:M.c;return N({destinationIp:l,sourceIp:y,type:v})||(({destinationPort:e,sourcePort:t,type:n})=>P({destinationPort:e,sourcePort:t,type:n}).length>0)({destinationPort:c,sourcePort:h,type:v})?r.a.createElement(a.EuiBadge,{"data-test-subj":`${v}-ip-badge`,color:"hollow",title:""},r.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":`${v}-ip-group`,direction:"column",gutterSize:"xs"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(F,null,E)),r.a.createElement(a.EuiFlexItem,{grow:!1},N({destinationIp:l,sourceIp:y,type:v})?r.a.createElement(R,{contextId:e,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceIp:y,sourcePort:h,type:v}):r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},P({destinationPort:c,sourcePort:h,type:v}).map(((t,n)=>r.a.createElement(a.EuiFlexItem,{key:`port-${t}-${n}`,grow:!1},r.a.createElement(T.a,{contextId:e,"data-test-subj":"port",eventId:u,fieldName:`${v}.port`,isDraggable:d,value:t})))))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(C.f,{contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:n,destinationGeoCountryIsoCode:i,destinationGeoRegionName:o,destinationGeoCityName:s,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:f,sourceGeoRegionName:g,sourceGeoCityName:b,type:v})))):null}));L.displayName="SourceDestinationIp";const z=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:f,sourceGeoContinentName:g,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourcePackets:E,sourceIp:x,sourcePort:j})=>r.a.createElement(a.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(L,{contextId:e,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:j,type:"source"})),r.a.createElement(S.e,{contextId:e,destinationBytes:t,destinationPackets:u,eventId:p,isDraggable:m,sourceBytes:f,sourcePackets:E}),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(L,{contextId:e,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:j,type:"destination"})))));z.displayName="SourceDestinationWithArrows";const q=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginTop",componentId:"sc-ru6rd-0"})(["margin-top:3px;"]);q.displayName="EuiFlexItemMarginTop";const B=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,networkBytes:f,networkCommunityId:g,networkDirection:b,networkPackets:y,networkProtocol:h,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:S,sourceGeoRegionName:O,sourceGeoCityName:k,sourceIp:w,sourcePackets:T,sourcePort:I,transport:M})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"column",justifyContent:"center",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(j,{bytes:f,packets:y,communityId:g,contextId:e,direction:b,eventId:p,isDraggable:m,protocol:h,transport:M})),r.a.createElement(q,{grow:!1},r.a.createElement(z,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:S,sourceGeoRegionName:O,sourceGeoCityName:k,sourceIp:w,sourcePackets:T,sourcePort:I})))));B.displayName="SourceDestination";var $=n(592),V=n(835);const U=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-ub9rva-0"})(["margin-right:10px;"]);U.displayName="EuiFlexItemMarginRight";const G=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventDuration:p,eventId:m,eventEnd:f,eventStart:g,isDraggable:b,networkBytes:y,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,processName:j,sourceBytes:S,sourceGeoContinentName:O,sourceGeoCountryName:k,sourceGeoCountryIsoCode:w,sourceGeoRegionName:T,sourceGeoCityName:I,sourceIp:M,sourcePackets:C,sourcePort:_,transport:D,userName:A})=>r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"netflow-columns",gutterSize:"none",justifyContent:"center",wrap:!0},r.a.createElement(U,{grow:!1},r.a.createElement(V.c,{contextId:e,eventId:m,isDraggable:b,processName:j,userName:A})),r.a.createElement(U,{grow:!1},r.a.createElement($.a,{contextId:e,eventDuration:p,eventId:m,eventEnd:f,eventStart:g,isDraggable:b})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(B,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:m,isDraggable:b,networkBytes:y,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,sourceBytes:S,sourceGeoContinentName:O,sourceGeoCountryName:k,sourceGeoCountryIsoCode:w,sourceGeoRegionName:T,sourceGeoCityName:I,sourceIp:M,sourcePackets:C,sourcePort:_,transport:D})))));G.displayName="NetflowColumns";const H=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:f,eventEnd:g,eventStart:b,isDraggable:y,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:j,processName:S,sourceBytes:O,sourceGeoContinentName:k,sourceGeoCountryName:w,sourceGeoCountryIsoCode:T,sourceGeoRegionName:I,sourceGeoCityName:M,sourcePackets:C,sourceIp:_,sourcePort:D,tlsClientCertificateFingerprintSha1:A,tlsFingerprintsJa3Hash:F,tlsServerCertificateFingerprintSha1:N,transport:P,userName:R})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"netflow-rows",direction:"column",justifyContent:"center",wrap:!0,gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(G,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:f,eventEnd:g,eventStart:b,isDraggable:y,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:j,processName:S,sourceBytes:O,sourceGeoContinentName:k,sourceGeoCountryName:w,sourceGeoCountryIsoCode:T,sourceGeoRegionName:I,sourceGeoCityName:M,sourceIp:_,sourcePackets:C,sourcePort:D,transport:P,userName:R})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(c,{contextId:e,eventId:f,isDraggable:y,tlsClientCertificateFingerprintSha1:A,tlsFingerprintsJa3Hash:F,tlsServerCertificateFingerprintSha1:N})))));H.displayName="Netflow"},function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return k}));var a=n(2),i=n(4),r=n(19),o=n(1093),s=n(301);const l=new WeakMap;var c=n(52),u=n.n(c),d=n(480),p=n(43);function m({useTopLevelObjectColumns:e,row:t,columnId:n,dataView:s,shouldShowFieldHandler:c,maxEntries:m,isPlainRecord:f,fieldFormats:g,dataTestSubj:b="discoverCellDescriptionList",className:y}){const h=e?function(e,t,n,a){var i;const r=Object(d.b)(e.fields,t),o=null!==(i=e.highlight)&&void 0!==i?i:{},s=[],l=[];return Object.entries(r).forEach((([t,i])=>{var r;const c=n.getFieldByName(t),u=n.fields.getByName?null===(r=n.fields.getByName(t))||void 0===r?void 0:r.displayName:void 0,d=c?n.getFormatterForField(c):{convert:(e,...t)=>String(e)},p=i.map((t=>d.convert(t,"html",{field:c,hit:e}))).join(", "),m=o[t]?s:l;u?a(u)&&m.push([u,p,t]):m.push([t,p,t])})),[...s,...l]}(t.raw,n,s,c).slice(0,m):function(e,t,n,a,r){var s;const c=l.get(e.raw);if(c&&c.maxEntries===a)return c.formattedHit;const u=null!==(s=e.raw.highlight)&&void 0!==s?s:{},d=e.flattened,p=[],m=[];Object.entries(d).forEach((([a,i])=>{const s=t.fields.getByName(a),l=null==s?void 0:s.displayName,c=u[a]?p:m,d=Object(o.a)(i,e.raw,r,t,s);l?n(a)&&c.push([l,d,a]):c.push([a,d,a])}));const f=[...p,...m],g=f.length<=a?f:[...f.slice(0,a),[i.i18n.translate("discover.formatHit.moreFields",{defaultMessage:"and {count} more {count, plural, one {field} other {fields}}",values:{count:f.length-a}}),"",null]];return l.set(e.raw,{formattedHit:g,maxEntries:a}),g}(t,s,c,m,g);return Object(p.jsx)(r.EuiDescriptionList,{type:"inline",compressed:!0,className:u()("unifiedDataTable__descriptionList","unifiedDataTable__cellValue",y),"data-test-subj":b},h.map((([e,n,i])=>{var o;return f&&i&&null===(null!==(o=t.flattened[i])&&void 0!==o?o:null)?null:Object(p.jsx)(a.Fragment,{key:e},Object(p.jsx)(r.EuiDescriptionListTitle,{className:"unifiedDataTable__descriptionListTitle"},e),Object(p.jsx)(r.EuiDescriptionListDescription,{className:"unifiedDataTable__descriptionListDescription",dangerouslySetInnerHTML:{__html:n}}))})))}n(654);var f=n(93),g=n(94);const b=i.i18n.translate("unifiedDataTable.json.codeEditorAriaLabel",{defaultMessage:"Read only JSON view of an elasticsearch document"}),y=i.i18n.translate("unifiedDataTable.json.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),h=({jsonValue:e,width:t,height:n,hasLineNumbers:a,onEditorDidMount:i,hideCopyButton:o})=>{if(""===e)return null;const s=Object(p.jsx)(g.CodeEditor,{languageId:f.XJsonLang.ID,width:t,height:n,value:e||"",editorDidMount:i,"aria-label":b,options:{automaticLayout:!0,fontSize:12,lineNumbers:a?"on":"off",minimap:{enabled:!1},overviewRulerBorder:!1,readOnly:!0,scrollbar:{alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent"}});return o?s:Object(p.jsx)(r.EuiFlexGroup,{className:"unifiedDataTableJsonEditor",direction:"column",gutterSize:"s"},Object(p.jsx)(r.EuiFlexItem,null,Object(p.jsx)(r.EuiSpacer,{size:"s"}),Object(p.jsx)("div",{className:"eui-textRight"},Object(p.jsx)(r.EuiCopy,{textToCopy:e},(e=>Object(p.jsx)(r.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},y))))),Object(p.jsx)(r.EuiFlexItem,null,s))};function v({json:e,width:t,height:n,hasLineNumbers:a}){const i=JSON.stringify(e,null,2);return Object(p.jsx)(h,{jsonValue:i,width:t,height:n,hasLineNumbers:a,onEditorDidMount:()=>{},hideCopyButton:!0})}var E=n(225);function x(e,t,n){return n?Object(d.b)(t.raw.fields,e):t.raw}var j=({closeButton:e,columnId:t,row:n,useTopLevelObjectColumns:a,dataTestSubj:i="dataTableExpandCellActionJsonPopover"})=>Object(p.jsx)(r.EuiFlexGroup,{gutterSize:"none",direction:"column",justifyContent:"flexEnd",className:"unifiedDataTable__cellPopover","data-test-subj":i},Object(p.jsx)(r.EuiFlexItem,{grow:!1},Object(p.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",responsive:!1},Object(p.jsx)(r.EuiFlexItem,{grow:!1},e))),Object(p.jsx)(r.EuiFlexItem,null,Object(p.jsx)(v,{json:x(t,n,a),width:E.f,height:200})));const S=({children:e})=>Object(p.jsx)("span",{className:"unifiedDataTable__cellPopoverValue eui-textBreakWord"},e),O="unifiedDataTable__cellValue",k=({dataView:e,rows:t,useNewFieldsApi:n,shouldShowFieldHandler:l,closePopover:c,fieldFormats:u,maxEntries:d,externalCustomRenderers:f,isPlainRecord:g})=>function({rowIndex:b,columnId:y,isDetails:h,setCellProps:v,colIndex:E,isExpandable:x,isExpanded:k}){const w=t?t[b]:void 0,T=e.fields.getByName(y),I=Object(a.useContext)(s.a);if(Object(a.useEffect)((()=>{null!=w&&w.isAnchor?v({className:"unifiedDataTable__cell--highlight"}):I.expanded&&w&&I.expanded.id===w.id?v({className:"unifiedDataTable__cell--expanded"}):v({style:void 0})}),[I,w,v]),void 0===w)return Object(p.jsx)("span",{className:O},"-");if(f&&f[y])return Object(p.jsx)("span",{className:O},f[y]({rowIndex:b,columnId:y,isDetails:h,setCellProps:v,isExpandable:x,isExpanded:k,colIndex:E,row:w,dataView:e,fieldFormats:u,closePopover:c}));const M=Boolean(n&&!T&&(null==w?void 0:w.raw.fields)&&!w.raw.fields[y]);return h?function({row:e,field:t,columnId:n,dataView:a,useTopLevelObjectColumns:s,fieldFormats:l,closePopover:c}){const u=Object(p.jsx)(r.EuiButtonIcon,{"aria-label":i.i18n.translate("unifiedDataTable.grid.closePopover",{defaultMessage:"Close popover"}),"data-test-subj":"docTableClosePopover",iconSize:"s",iconType:"cross",size:"xs",onClick:c});return s||"_source"===(null==t?void 0:t.type)?Object(p.jsx)(j,{row:e,columnId:n,useTopLevelObjectColumns:s,closeButton:u}):Object(p.jsx)(r.EuiFlexGroup,{gutterSize:"none",direction:"row",responsive:!1,"data-test-subj":"dataTableExpandCellActionPopover"},Object(p.jsx)(r.EuiFlexItem,null,Object(p.jsx)(S,null,Object(p.jsx)("span",{dangerouslySetInnerHTML:{__html:Object(o.a)(e.flattened[n],e.raw,l,a,t)}}))),Object(p.jsx)(r.EuiFlexItem,{grow:!1},u))}({row:w,field:T,columnId:y,dataView:e,useTopLevelObjectColumns:M,fieldFormats:u,closePopover:c}):"_source"===(null==T?void 0:T.type)||M?Object(p.jsx)(m,{useTopLevelObjectColumns:M,row:w,dataView:e,columnId:y,fieldFormats:u,shouldShowFieldHandler:l,maxEntries:d,isPlainRecord:g}):Object(p.jsx)("span",{className:O,dangerouslySetInnerHTML:{__html:Object(o.a)(w.flattened[y],w.raw,u,e,T)}})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(121),i=n(7),r=n(41),o=n.n(r),s=n(5),l=n(195);const c=o.a.div.withConfig({displayName:"HorizontalSpacer",componentId:"sc-1o769t7-0"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeXS));var u=n(19),d=n(2),p=n.n(d),m=n(590),f=n(315),g=n(44),b=n(42),y=n(134);const h=({contextId:e,eventId:t,isDraggable:n,sourceField:a,sourceValue:i})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-details-source-field",eventId:t,field:l.g,isDraggable:n,value:a,isAggregatable:!0,fieldType:"keyword"})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,p.a.createElement(b.FormattedMessage,{defaultMessage:"matched",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.matchedVerb"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-details-source-value",eventId:t,field:a,isDraggable:n,value:i,isAggregatable:!0,fieldType:"keyword"})));var v=n(422);const E=({contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:i,isDraggable:r})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"threat-match-indicator-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},i&&p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-type",eventId:t,field:l.h,isDraggable:r,value:i,isAggregatable:!0,fieldType:"keyword"})),n&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1,component:"span"},p.a.createElement(c,null,p.a.createElement(b.FormattedMessage,{defaultMessage:"provided by",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.providerPreposition"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-feedName",eventId:t,field:l.e,isDraggable:r,value:n,isAggregatable:!0,fieldType:"keyword"}))),a&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,":")),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(v.a,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-reference",eventId:t,fieldName:l.j,isDraggable:r,value:a,isAggregatable:!0,fieldType:"keyword"})))),x=({contextId:e,data:t,eventId:n,isDraggable:a})=>{const i={contextId:e,eventId:n,indicatorReference:Object(g.getOr)([],l.p,t)[0],feedName:Object(g.getOr)([],l.e,t)[0],indicatorType:Object(g.getOr)([],l.n,t)[0],isDraggable:a,sourceField:Object(g.get)(l.l,t)[0],sourceValue:Object(g.get)(l.k,t)[0]};return p.a.createElement(j,i)},j=({contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:i,isDraggable:r,sourceField:o,sourceValue:s})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-row",gutterSize:"s",justifyContent:"center"},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(h,{contextId:e,eventId:t,isDraggable:r,sourceField:o,sourceValue:s})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(E,{contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:i,isDraggable:r})));var S=n(434);const O=o.a.div.withConfig({displayName:"SpacedContainer",componentId:"sc-e4rhpb-0"})(["margin:"," 0;"],(({theme:e})=>e.eui.euiSizeS)),k=({data:e,isDraggable:t,scopeId:n})=>{const a=Object(i.get)(e,s.yb),r=Object(i.get)(e,m.a),o=Object(d.useCallback)(((e="max")=>{const i="max"===e?a.slice(0,2):a;return p.a.createElement(f.a,{"data-test-subj":"threat-match-row-renderer"},p.a.createElement(O,null,i.map(((e,i)=>{const o=`threat-match-row-${n}-${r}-${i}`;return p.a.createElement(d.Fragment,{key:o},p.a.createElement(x,{contextId:o,data:e,eventId:r,isDraggable:t}),i<a.length-1&&p.a.createElement(u.EuiHorizontalRule,{margin:"s"}))}))))}),[a,r,t,n]),l=Object(d.useCallback)((()=>o("all")),[o]);return p.a.createElement(u.EuiFlexGroup,{direction:"column",justifyContent:"center",alignItems:"center",gutterSize:"none"},p.a.createElement(u.EuiFlexItem,null,o()),a.length>2&&p.a.createElement(u.EuiFlexItem,null,p.a.createElement(w,{title:Object(S.h)(a.length),renderChildren:l})))},w=({title:e,renderChildren:t})=>{const[n,a]=Object(d.useState)(!1),i=()=>a(!1);let r;return n&&(r=p.a.createElement(u.EuiModal,{onClose:i},p.a.createElement(u.EuiModalHeader,{"data-test-subj":"threat-match-row-modal"},p.a.createElement(u.EuiModalHeaderTitle,null,S.b)),p.a.createElement(u.EuiModalBody,null,t()),p.a.createElement(u.EuiModalFooter,null,p.a.createElement(u.EuiButton,{onClick:i,fill:!0},S.a)))),p.a.createElement("div",null,p.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"threat-match-row-show-all",iconType:"popout",color:"primary",onClick:()=>a(!0)},e),r)},T={id:a.e.threat_match,isInstance:e=>(e=>{const t=Object(i.get)(e,s.yb);return null==t?[]:Array.isArray(t)?t:[t]})(e).some((e=>l.i.some((t=>!Object(i.isEmpty)(Object(i.get)(e,t)))))),renderRow:({data:e,isDraggable:t,scopeId:n})=>p.a.createElement(k,{data:e,isDraggable:t,scopeId:n})}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var a=n(44),i=n(2),r=n.n(i),o=n(121),s=n(315),l=n(19),c=n(41),u=n.n(c),d=n(278),p=n(363),m=n(222),f=n(144),g=n(416),b=n(150);const y=["IPv4","IPv6"];var h=n(134),v=n(179);const E="suricata.eve.alert.signature",x="suricata.eve.alert.signature_id",j=u()(l.EuiFlexItem).withConfig({displayName:"SignatureFlexItem",componentId:"sc-1paeiel-0"})(["min-width:77px;"]);j.displayName="SignatureFlexItem";const S=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1paeiel-1"})(["vertical-align:top;"]);S.displayName="Badge";const O=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1paeiel-2"})(["margin-left:6px;"]);O.displayName="LinkFlexItem";const k=r.a.memo((({tokens:e})=>r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(b.c,{key:e,grow:!1},r.a.createElement(l.EuiBadge,{iconType:"tag",color:"hollow",title:""},e)))))));k.displayName="Tokens";const w=r.a.memo((({id:e,isDraggable:t,signatureId:n})=>{const a=Object(i.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`suricata-draggable-signature-id-${e}-sig-${n}`),name:String(n),excluded:!1,kqlQuery:"",queryMatch:{field:x,value:n,operator:v.d}})),[e,n]),o=Object(i.useCallback)(((e,t,a)=>a.isDragging?r.a.createElement(p.a,null,r.a.createElement(g.a,{dataProvider:e})):r.a.createElement(l.EuiToolTip,{"data-test-subj":"signature-id-tooltip",content:x},r.a.createElement(S,{iconType:"number",color:"hollow",title:""},n))),[n]);return r.a.createElement(j,{grow:!1},r.a.createElement(p.b,{dataProvider:a,isDraggable:t,render:o,isAggregatable:!0,fieldType:"keyword"}))}));w.displayName="DraggableSignatureId";const T=r.a.memo((({contextId:e,id:t,isDraggable:n,signature:a,signatureId:i})=>{const o=(e=>e.trim().split(" ").reduce(((e,t,n)=>e.length===n&&t===t.toUpperCase()&&""!==t||y.includes(t)?[...e,t]:e),[]))(a);return r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(w,{id:`draggable-signature-id-${e}-${t}`,isDraggable:n,signatureId:i}),r.a.createElement(k,{tokens:o}),r.a.createElement(O,{grow:!1},r.a.createElement(h.b,{"data-test-subj":"draggable-signature-link",field:E,id:`suricata-signature-default-draggable-${e}-${t}-${E}`,isDraggable:n,value:a,tooltipPosition:"bottom"},r.a.createElement("div",null,r.a.createElement(f.c,{link:a},a.split(" ").splice(o.length).join(" "))))))}));T.displayName="SuricataSignature";const I=u()(l.EuiFlexItem).withConfig({displayName:"LinkEuiFlexItem",componentId:"sc-i69i1c-0"})(["display:inline;"]);I.displayName="LinkEuiFlexItem";const M=r.a.memo((({signatureId:e})=>{const[t,o]=Object(i.useState)(void 0);return Object(i.useEffect)((()=>{let t=!0;return async function(){if(null!=e)try{const i=await(async e=>{const t=(await n.e(25).then(n.t.bind(null,2097,7))).db,i=(r=t,o=e,Object.prototype.hasOwnProperty.call(r,o)?t[e]:null);var r,o;return null!=i?Object(a.uniq)(i):[]})(e);t&&null!=i&&o(i)}catch(e){o(void 0)}else t&&o(void 0)}(),()=>{t=!1}}),[e]),r.a.createElement(l.EuiFlexGroup,{"data-test-subj":"suricataRefs",gutterSize:"none",justifyContent:"center",wrap:!0},t&&t.map((e=>r.a.createElement(I,{key:e,grow:!1},r.a.createElement(l.EuiLink,{href:e,color:"subdued",target:"_blank"},e)))))}));M.displayName="SuricataRefs";const C=u.a.div.withConfig({displayName:"Details",componentId:"sc-1y9aljy-0"})(["margin:5px 0;"]);C.displayName="Details";const _=r.a.memo((({data:e,isDraggable:t,timelineId:n})=>{const i=Object(a.get)("suricata.eve.alert.signature[0]",e),o=Object(a.get)("suricata.eve.alert.signature_id[0]",e);return null!=o&&null!=i?r.a.createElement(C,null,r.a.createElement(T,{contextId:`suricata-signature-${n}-${e._id}`,id:e._id,isDraggable:t,signature:i,signatureId:o}),r.a.createElement(M,{signatureId:o}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:t,timelineId:n})):null}));_.displayName="SuricataDetails";const D={id:o.e.suricata,isInstance:e=>{const t=Object(a.get)("event.module[0]",e);return null!=t&&"suricata"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(s.a,null,r.a.createElement(_,{data:e,isDraggable:t,timelineId:n}))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var a=n(44),i=n(2),r=n.n(i),o=n(121),s=n(315),l=n(19),c=n(41),u=n.n(c),d=n(278),p=n(363),m=n(222),f=n(144),g=n(416),b=n(179),y=n(4);const h=y.i18n.translate("xpack.securitySolution.zeek.s0Description",{defaultMessage:"Connection attempt seen, no reply"}),v=y.i18n.translate("xpack.securitySolution.zeek.s1Description",{defaultMessage:"Connection established, not terminated"}),E=y.i18n.translate("xpack.securitySolution.zeek.s2Description",{defaultMessage:"Connection established and close attempt by originator seen (but no reply from responder)"}),x=y.i18n.translate("xpack.securitySolution.zeek.s3Description",{defaultMessage:"Connection established and close attempt by responder seen (but no reply from originator)"}),j=y.i18n.translate("xpack.securitySolution.zeek.sfDescription",{defaultMessage:"Normal SYN/FIN completion"}),S=y.i18n.translate("xpack.securitySolution.zeek.rejDescription",{defaultMessage:"Connection attempt rejected"}),O=y.i18n.translate("xpack.securitySolution.zeek.rstoODescription",{defaultMessage:"Connection established, originator aborted (sent a RST)"}),k=y.i18n.translate("xpack.securitySolution.zeek.rstrDescription",{defaultMessage:"Established, responder aborted"}),w=y.i18n.translate("xpack.securitySolution.zeek.rstosoDescription",{defaultMessage:"Originator sent a SYN followed by a RST, no SYN-ACK from the responder"}),T=y.i18n.translate("xpack.securitySolution.zeek.rstrhDescription",{defaultMessage:"Responder sent a SYN ACK followed by a RST, no SYN from the (purported) originator"}),I=y.i18n.translate("xpack.securitySolution.zeek.shDescription",{defaultMessage:"Originator sent a SYN followed by a FIN, no SYN ACK from the responder"}),M=y.i18n.translate("xpack.securitySolution.zeek.shrDescription",{defaultMessage:"Responder sent a SYN ACK followed by a FIN, no SYN from the originator"}),C=y.i18n.translate("xpack.securitySolution.zeek.othDescription",{defaultMessage:"No SYN seen, just midstream traffic"}),_=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1b5gq3p-0"})(["vertical-align:top;"]);_.displayName="Badge";const D=u()(l.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1b5gq3p-1"})(["margin-left:3px;"]);D.displayName="TokensFlexItem";const A=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1b5gq3p-2"})(["margin-left:6px;"]);A.displayName="LinkFlexItem";const F=e=>e,N=e=>{const t=e.split(".");return t.length>=2&&null!=t[1]?""!==t[1]?t[1]:t[0]:e},P=e=>`Dropped:${e}`,R=e=>`md5: ${e.substr(0,7)}...`,L=e=>`sha1: ${e.substr(0,7)}...`,z=r.a.memo((({id:e,field:t,isDraggable:n,value:a,stringRenderer:o=F})=>{const s=Object(i.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`draggable-zeek-element-draggable-wrapper-${e}-${t}-${a}`),name:String(a),excluded:!1,kqlQuery:"",queryMatch:{field:t,value:String(a),operator:b.d}})),[t,e,a]),c=Object(i.useCallback)(((e,n,i)=>i.isDragging?r.a.createElement(p.a,null,r.a.createElement(g.a,{dataProvider:e})):r.a.createElement(l.EuiToolTip,{"data-test-subj":"badge-tooltip",content:t},r.a.createElement(_,{iconType:"tag",color:"hollow",title:""},o(String(a))))),[t,o,a]);return null!=a?r.a.createElement(D,{grow:!1},r.a.createElement(p.b,{dataProvider:s,isDraggable:n,render:c,isAggregatable:!0,fieldType:"keyword"})):null}));z.displayName="DraggableZeekElement";const q=r.a.memo((({value:e,link:t})=>null!=e?null!=t?r.a.createElement(A,{grow:!1},r.a.createElement("div",null,r.a.createElement(f.c,{link:t},e))):r.a.createElement(A,{grow:!1},r.a.createElement("div",null,r.a.createElement(f.c,{link:e}))):null));q.displayName="Link";const B=r.a.memo((({value:e})=>null!=e?r.a.createElement(A,{grow:!1},r.a.createElement("div",null,r.a.createElement(f.j,{domain:e,overflowIndexStart:1,showDomain:!0,"data-test-subj":"reputationLinkSha"}))):null));B.displayName="TotalVirusLinkSha";const $={S0:h,S1:v,S2:E,S3:x,SF:j,REJ:S,RSTO:O,RSTR:k,RSTOS0:w,RSTRH:T,SH:I,SHR:M,OTH:C},V=r.a.memo((({data:e,isDraggable:t,timelineId:n})=>{const i=`zeek-signature-draggable-zeek-element-${n}-${e._id}`,o=Object(a.get)("zeek.session_id[0]",e),s=Object(a.get)("event.dataset[0]",e),c=Object(a.get)("zeek.ssl.version[0]",e),u=Object(a.get)("zeek.ssl.cipher[0]",e),d=Object(a.get)("zeek.connection.state[0]",e),p=Object(a.get)("zeek.connection.history[0]",e),m=Object(a.get)("zeek.notice.note[0]",e),f=Object(a.get)("zeek.notice.msg[0]",e),g=(e=>null!=e?String(e):null)(Object(a.get)("zeek.notice.dropped[0]",e)),b=Object(a.get)("zeek.dns.query[0]",e),y=Object(a.get)("zeek.dns.qclass_name[0]",e),h=Object(a.get)("http.request.method[0]",e),v=Object(a.get)("http.response.status_code[0]",e),E=Object(a.get)("url.original[0]",e),x=Object(a.get)("zeek.files.sha1[0]",e),j=Object(a.get)("zeek.files.md5[0]",e),S=(e=>{if(null!=e){const t=$[e];return null!=t?`${e} ${t}`:e}return null})(d),O=(e=>null!=e&&null!=$[e]?$[e]:null)(d);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(z,{id:i,field:"zeek.session_id",isDraggable:t,value:o}),r.a.createElement(z,{id:i,field:"event.dataset",isDraggable:t,value:s,stringRenderer:N}),r.a.createElement(z,{id:i,field:"zeek.files.sha1",isDraggable:t,value:x,stringRenderer:L}),r.a.createElement(z,{id:i,field:"zeek.files.md5",isDraggable:t,value:j,stringRenderer:R}),r.a.createElement(z,{id:i,field:"zeek.notice.dropped",isDraggable:t,value:g,stringRenderer:P}),r.a.createElement(z,{id:i,field:"zeek.ssl.version",isDraggable:t,value:c}),r.a.createElement(z,{id:i,field:"zeek.ssl.cipher",isDraggable:t,value:u}),r.a.createElement(z,{id:i,field:"zeek.connection.state",isDraggable:t,value:d}),r.a.createElement(z,{id:i,field:"http.request.method",isDraggable:t,value:h}),r.a.createElement(z,{id:i,field:"zeek.connection.history",isDraggable:t,value:p}),r.a.createElement(z,{id:i,field:"zeek.notice.note",isDraggable:t,value:m}),r.a.createElement(z,{id:i,field:"zeek.dns.query",isDraggable:t,value:b}),r.a.createElement(z,{id:i,field:"zeek.dns.qclass_name",isDraggable:t,value:y}),r.a.createElement(z,{id:i,field:"http.response.status_code",isDraggable:t,value:v})),r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(q,{link:S,value:O}),r.a.createElement(q,{value:u}),r.a.createElement(q,{value:b}),r.a.createElement(q,{value:f}),r.a.createElement(q,{value:E}),r.a.createElement(B,{value:x})))}));V.displayName="ZeekSignature";const U=u.a.div.withConfig({displayName:"Details",componentId:"sc-1ixpiaf-0"})(["margin:5px 0;"]);U.displayName="Details";const G=r.a.memo((({data:e,isDraggable:t,timelineId:n})=>null!=e.zeek?r.a.createElement(U,null,r.a.createElement(V,{data:e,isDraggable:t,timelineId:n}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:t,timelineId:n})):null));G.displayName="ZeekDetails";const H={id:o.e.zeek,isInstance:e=>{const t=Object(a.get)("event.module[0]",e);return null!=t&&"zeek"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(s.a,null,r.a.createElement(G,{data:e,isDraggable:t,timelineId:n}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(270),o=n(420),s=n(118),l=n(407),c=n(423);const u=n(4).i18n.translate("xpack.securitySolution.detectionEngine.rulesSnoozeBadge.error.unableToFetch",{defaultMessage:"Unable to fetch snooze settings"});function d({ruleId:e,showTooltipInline:t=!1}){const n=Object(s.j)().services.triggersActionsUi.getRulesListNotifyBadge,{snoozeSettings:a,error:d}=function(e){var t,n;const{state:{rulesSnoozeSettings:a}}=null!==(t=Object(c.c)())&&void 0!==t?t:{state:{}},{data:i,isFetching:r,isError:o}=Object(l.a)([e],{enabled:!(null!=a&&a.data[e]||null!=a&&a.isFetching)}),s=null!==(n=null==a?void 0:a.data[e])&&void 0!==n?n:null==i?void 0:i[e],d=(null==a?void 0:a.isFetching)||r;return{snoozeSettings:s,error:(null==a?void 0:a.isError)||o||!s&&!d?u:void 0}}(e),[{canUserCRUD:p}]=Object(r.b)(),m=Object(o.c)(p),f=Object(l.b)();return i.a.createElement(n,{ruleId:e,snoozeSettings:a,loading:!a&&!d,disabled:!m||d,showTooltipInline:t,onRuleChanged:f})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return S}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(974),l=n(19),c=n(118);const u=({integration:e})=>{const t=Object(c.d)(),n=e.integrationTitle,a=`${t}/${e.targetUrl}`;return i.a.createElement(l.EuiLink,{href:a,target:"_blank","data-test-subj":"integrationLink"},n)},d=i.a.memo(u);d.displayName="IntegrationLink";var p=n(619);const m=o()(l.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-63ceph-0"})(["margin-left:5px;"]),f=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:n,isEnabled:a}=t,r=a?"success":n?"primary":void 0,o=n?a?p.d:p.e:p.j,s=a?p.c:n?p.b:p.i;return i.a.createElement(l.EuiToolTip,{content:o},i.a.createElement(m,{color:r,"data-test-subj":"statusBadge"},s))},g=i.a.memo(f);g.displayName="IntegrationStatusBadge";const b=o.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-8orjjk-0"})(["margin-left:5px;"]),y=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?i.a.createElement(b,null,i.a.createElement(l.EuiIconTip,{type:"warning",color:"warning",content:p.f(t.installedVersion,e.requiredVersion)})):null},h=i.a.memo(y);h.displayName="IntegrationVersionMismatchIcon";const v=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-hszsn0-0"})(["overflow:hidden;"]),E=({integration:e,dataTestSubj:t="integrationDescription"})=>i.a.createElement(v,{"data-test-subj":`${t}-${e.packageName}`},i.a.createElement(d,{integration:e})," ",i.a.createElement(g,{integration:e}),i.a.createElement(h,{integration:e})),x=i.a.memo(E),j=({relatedIntegrations:e,dataTestSubj:t="relatedIntegrationsDescription"})=>{const{integrations:n}=Object(s.a)(e);return i.a.createElement(i.a.Fragment,null,n.map(((e,n)=>i.a.createElement(x,{key:`${e.packageName}-${n}`,integration:e,dataTestSubj:t}))))},S=(e,t)=>null==t||0===t.length?[]:[{title:e,description:i.a.createElement(j,{relatedIntegrations:t})}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(19),o=n(7),s=n(4);const l=s.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.addToSelectedRulesDescription",{defaultMessage:"After you create the exception, it is added to the rules you link. "});var c=n(595),u=n(354);const d=Object(a.memo)((({rule:e,linkedRules:t,onRuleLinkChange:n})=>{const o=Object(a.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(a.useCallback)((({target:{checked:a}})=>{const i=a?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof n&&n(i)}),[t,n,e]);return i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiSwitch,{onChange:s,label:"",checked:o}))}));d.displayName="LinkRuleSwitch";var p=n(781);const m=({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{isLoading:n,searchOptions:m,pagination:f,sortedRulesByLinkedRulesOnTop:g,rulesTableColumnsWithLinkSwitch:b,onTableChange:y,addToSelectedRulesDescription:h}=(({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{data:{rules:n}={rules:[],total:0},isFetched:r}=Object(p.a)({filterOptions:{filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:void 0,pagination:{page:1,perPage:1e4}}),[m,f]=Object(a.useState)({pageIndex:0,initialPageSize:25,showPerPageOptions:!1}),[g,b]=Object(a.useState)(e||[]);Object(a.useEffect)((()=>{t(g)}),[g,t]);const y=Object(a.useMemo)((()=>Object(o.sortBy)(n,[t=>null==e?void 0:e.find((e=>e.id===t.id))])),[e,n]),h=Object(a.useMemo)((()=>{const e=y.reduce(((e,t)=>{const{tags:n}=t;return n.forEach((t=>e.add(t))),e}),new Set);return Array.from(e).map((e=>({value:e,name:e,field:"tags"})))}),[y]),v=Object(a.useMemo)((()=>({box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",operator:"exact",name:s.i18n.translate("xpack.securitySolution.exceptions.addToRulesTable.tagsFilterLabel",{defaultMessage:"Tags"}),multiSelect:"or",options:h}]})),[h]),E=Object(a.useMemo)((()=>[{field:"link",name:c.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>i.a.createElement(d,{rule:t,linkedRules:g,onRuleLinkChange:b})},...Object(u.c)()]),[g]),x=Object(a.useCallback)((({page:{index:e}})=>f({...m,pageIndex:e})),[m]);return{isLoading:!r,pagination:m,searchOptions:v,sortedRulesByLinkedRulesOnTop:y,rulesTableColumnsWithLinkSwitch:E,addToSelectedRulesDescription:l,onTableChange:x}})({initiallySelectedRules:e,onRuleSelectionChange:t});return i.a.createElement(r.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"s"},h),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiInMemoryTable,{tableLayout:"auto",search:m,"data-test-subj":"addExceptionToRulesTable",tableCaption:"Rules table",items:g,loading:n,columns:b,message:n?i.a.createElement(r.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPromptsLoading"}):void 0,pagination:f,onTableChange:y})))},f=i.a.memo(m);f.displayName="ExceptionsAddToRulesTable"},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(2),i=n.n(a),r=n(19),o=n(4),s=n(41),l=n.n(s),c=n(174);const u=(e,t)=>{const{id:n,agents:a,agentType:i}=e;if(t&&!a.includes(t))throw new Error(`Action [${n}] was not sent to agent id [${t}]`);return"endpoint"!==i?null!=t?t:a[0]:`${n}.${null!=t?t:a[0]}`};var d=n(412),p=n(790),m=n(47),f=n(364),g=n(167),b=n(126);const y=Object.freeze({fontFamily:"inherit"}),h=o.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.downloadButtonLabel",{defaultMessage:"Click here to download"}),v=o.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.fileNoLongerAvailable",{defaultMessage:"File has expired and is no longer available for download."}),E=o.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.deleteNotice",{defaultMessage:"Files are periodically deleted to clear storage space. Download and save file locally if needed."}),x=o.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.fileTruncated",{defaultMessage:"Output data in the provided zip file is truncated due to file size limitations."}),j=l.a.div.withConfig({displayName:"FileDownloadLinkContainer",componentId:"sc-1ipaklk-0"})(["& > *{vertical-align:middle;}"]),S=Object(a.memo)((({textSize:e,"data-test-subj":t})=>{const n=Object(a.useMemo)((()=>"xs"===e?"s":"m"),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIcon,{size:n,type:"warning",color:"warning"})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiText,{size:e,color:"warning","data-test-subj":t},x))))}));S.displayName="TruncatedTextInfo";const O=Object(a.memo)((({action:e,agentId:t,buttonTitle:n=h,canAccessFileDownloadLink:s,isTruncatedFile:l=!1,textSize:x="s","data-test-subj":O})=>{var k;const w=e,T=Object(b.a)(O),I=Object(a.useMemo)((()=>w.isCompleted&&w.wasSuccessful),[w.isCompleted,w.wasSuccessful]),M=Object(a.useMemo)((()=>`${Object(d.a)(g.a,{action_id:w.id,file_id:u(w,t)})}?apiVersion=2023-10-31`),[w,t]),{isFetching:C,data:_,error:D}=((e,t,n={})=>{const a=Object(f.f)();return Object(m.useQuery)({queryKey:["get-action-file-info",e.id,null!=t?t:e.agents[0]],...n,queryFn:()=>{const n=Object(d.a)(g.b,{action_id:e.id,file_id:u(e,t)});return a.get(n,{version:"2023-10-31"})}})})(w,void 0,{enabled:s&&I});return s&&w.isCompleted&&w.wasSuccessful?C?i.a.createElement(r.EuiSkeletonText,{lines:1,"data-test-subj":T("loading")}):D&&404===(null==D||null===(k=D.response)||void 0===k?void 0:k.status)||"DELETED"===(null==_?void 0:_.data.status)?i.a.createElement(r.EuiText,{size:x,color:"warning","data-test-subj":T("fileNoLongerAvailable")},v):D?i.a.createElement(p.a,{error:D,"data-test-subj":T("apiError")}):i.a.createElement(j,{"data-test-subj":O},i.a.createElement(r.EuiButtonEmpty,{href:M,iconType:"download","data-test-subj":T("downloadButton"),flush:"left",style:y,iconSize:"s",download:!0},i.a.createElement(r.EuiText,{size:x},n)),i.a.createElement(r.EuiText,{size:x,"data-test-subj":T("passcodeMessage"),className:"eui-displayInline"},(A=c.c[w.agentType],o.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.passcodeInfo",{defaultMessage:"(ZIP file passcode: {passcode}).",values:{passcode:A}}))),i.a.createElement(r.EuiText,{size:x,color:"warning","data-test-subj":T("fileDeleteMessage")},E),l&&i.a.createElement(S,{textSize:x,"data-test-subj":T("fileTruncatedMessage")})):null;var A}));O.displayName="ResponseActionFileDownloadLink"},function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return h}));var a=n(2),i=n(45),r=n(68),o=n(57),s=n(719),l=n.n(s),c=n(582);const u={byId:{},needsSync:!1},d=Object(r.createReducer)(u,(e=>{e.addCase(c.f,((e,{payload:{preview:t,left:n,right:a,id:i}})=>{i in e.byId?(e.byId[i].right=a,e.byId[i].left=n,e.byId[i].preview=t?[t]:void 0):e.byId[i]={left:n,right:a,preview:t?[t]:void 0},e.needsSync=!0})),e.addCase(c.e,((e,{payload:{left:t,id:n}})=>{n in e.byId?e.byId[n].left=t:e.byId[n]={left:t,right:void 0,preview:void 0},e.needsSync=!0})),e.addCase(c.h,((e,{payload:{right:t,id:n}})=>{n in e.byId?e.byId[n].right=t:e.byId[n]={right:t,left:void 0,preview:void 0},e.needsSync=!0})),e.addCase(c.g,((e,{payload:{preview:t,id:n}})=>{if(n in e.byId)if(e.byId[n].preview){var a,i;l()(t,null===(a=e.byId[n].preview)||void 0===a?void 0:a.at(-1))||null===(i=e.byId[n].preview)||void 0===i||i.push(t)}else e.byId[n].preview=t?[t]:void 0;else e.byId[n]={right:void 0,left:void 0,preview:t?[t]:void 0};e.needsSync=!0})),e.addCase(c.i,((e,{payload:{id:t}})=>{var n;t in e.byId&&(null===(n=e.byId[t].preview)||void 0===n||n.pop()),e.needsSync=!1})),e.addCase(c.b,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0,e.byId[t].left=void 0,e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(c.a,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].left=void 0),e.needsSync=!0})),e.addCase(c.d,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].right=void 0),e.needsSync=!0})),e.addCase(c.c,((e,{payload:{id:t}})=>{t in e.byId&&(e.byId[t].preview=void 0),e.needsSync=!0})),e.addCase(c.j,((e,{payload:{preview:t,left:n,right:a,id:i}})=>{i in e.byId?(e.byId[i].right=a,e.byId[i].left=n,e.byId[i].preview=t?[t]:void 0):e.byId[i]={right:a,left:n,preview:t?[t]:void 0},e.needsSync=!1}))})),p=Object(r.configureStore)({reducer:d,devTools:!1,enhancers:[]}),m=Object(a.createContext)({store:p,storeState:u}),f=Object(i.createDispatchHook)(m),g=Object(i.createSelectorHook)(m),b=e=>e,y=e=>Object(o.createSelector)(b,(t=>t.byId[e]||{})),h=()=>Object(o.createSelector)(b,(e=>e.needsSync))},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19),l=n(532),c=n(252),u=n(403),d=n(1555),p=n(4);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.sectionTitle",{defaultMessage:"Alerts actions"}),f=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.singleAlertCloseLabel",{defaultMessage:"Close this alert"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),b=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by selected rule/s"}),y=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),h=o.a.section.withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-1ggwgok-0"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),v=o()(s.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1ggwgok-1"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),E=({isAlertDataLoading:e,exceptionListItems:t,exceptionListType:n,shouldCloseSingleAlert:r,shouldBulkCloseAlert:o,disableBulkClose:p,alertData:E,alertStatus:x,onDisableBulkClose:j,onUpdateBulkCloseIndex:S,onBulkCloseCheckboxChange:O,onSingleAlertCloseCheckboxChange:k})=>{const{loading:w,signalIndexName:T}=Object(l.a)(),I=Object(a.useMemo)((()=>null!==T?[T]:[]),[T]),[M,{indexPatterns:C}]=Object(c.b)(I),_=Object(a.useCallback)((e=>{O(e.currentTarget.checked)}),[O]),D=Object(a.useCallback)((e=>{null!=k&&k(e.currentTarget.checked)}),[k]);return Object(a.useEffect)((()=>{S(o&&null!=I?I:void 0)}),[I,S,o]),Object(a.useEffect)((()=>{!0===p&&O(!1)}),[p,O]),Object(a.useEffect)((()=>{!1===M&&!1===w&&j((e=>{for(const{entries:t}of e)for(const e of null!=t?t:[])if(Object(d.f)(e)===u.b.LIST)return!0;return!1})(t)||((e,t)=>{const n=e=>t.fields.some((({name:t})=>t===e.field));if(0===e.length)return!1;for(const{entries:t}of e)for(const e of null!=t?t:[])if("nested"===e.type){for(const t of e.entries)if(!1===n(t))return!0}else if(!1===n(e))return!0;return!1})(t,C)||t.every((e=>0===e.entries.length)))}),[j,t,M,w,C]),i.a.createElement(h,null,i.a.createElement(v,{size:"xs"},i.a.createElement("h3",null,m)),i.a.createElement(s.EuiSpacer,{size:"s"}),null!=E&&"closed"!==x&&i.a.createElement(s.EuiFormRow,{fullWidth:!0},i.a.createElement(s.EuiCheckbox,{"data-test-subj":"closeAlertOnAddExceptionCheckbox",id:"close-alert-on-add-add-exception-checkbox",label:f,checked:r,onChange:D,disabled:w||M||e})),i.a.createElement(s.EuiFormRow,{fullWidth:!0},i.a.createElement(s.EuiCheckbox,{"data-test-subj":"bulkCloseAlertOnAddExceptionCheckbox",id:"bulk-close-alert-on-add-add-exception-checkbox",label:p?g:b,checked:o,onChange:_,disabled:p||w||M||e})),"endpoint"===n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(s.EuiText,{"data-test-subj":"addExceptionEndpointText",color:"subdued",size:"s"},y)))},x=i.a.memo(E);x.displayName="ExceptionItemsFlyoutAlertsActions"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n(585),r=n(204),o=n(53),s=n(118);var l=n(343),c=n(10),u=n(4);const d=u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.error",{defaultMessage:"Failed to close alerts"});var p=n(123),m=n(479);const f=()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(p.a)(),[f,g]=Object(a.useState)(!1),b=Object(a.useRef)(null);return Object(a.useEffect)((()=>{let a=!0;const p=new AbortController;return b.current=async(f,b,y,h)=>{try{var v,E,x,j,S,O,k,w;let t,d;if(g(!0),null!=y&&(t=await Object(m.a)({signalIds:[y],status:"closed",signal:p.signal})),null!=h){const e=Object(i.c)(["open","acknowledged","in-progress"]),t=await(async(e,t,n,a,i,l=!0)=>{const c={fields:[],title:a.join()},{filter:u}=await Object(r.r)({http:s.b.get().http,exceptions:i,excludeExceptions:l,chunkSize:10}),d={query:e,language:t},p=((e,t)=>null!=t?[...e,t]:[...e])(n,u);return Object(o.buildEsQuery)(c,d,p,{allowLeadingWildcards:!0,queryStringOptions:{analyze_wildcard:!0},ignoreFilterIfFieldNotInIndex:!1,dateFormatTZ:"Zulu"})})("","kuery",[...f.flatMap((e=>Object(i.d)(e))),...e],h,Object(l.m)(b),!1);d=await Object(m.a)({query:t,status:"closed",signal:p.signal})}const I=(null!==(v=null===(E=t)||void 0===E?void 0:E.updated)&&void 0!==v?v:0)+(null!==(x=null===(j=d)||void 0===j?void 0:j.updated)&&void 0!==x?x:0),M=null!==(S=null===(O=t)||void 0===O?void 0:O.version_conflicts)&&void 0!==S?S:0+(null!==(k=null===(w=d)||void 0===w?void 0:w.version_conflicts)&&void 0!==k?k:0);a&&(g(!1),e((T=I,u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.success",{values:{numAlerts:T},defaultMessage:"Successfully updated {numAlerts} {numAlerts, plural, =1 {alert} other {alerts}}"}))),M>0&&n({title:c.k(M),text:c.l(I,M)}))}catch(e){a&&(g(!1),t(e,{title:d}))}var T},()=>{a=!1,p.abort()}}),[e,t,n]),[f,b.current]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(19),i=n(2),r=n.n(i),o=n(566),s=n(720),l=n(52),c=n.n(l),u=n(576),d=n.n(u),p=n(4);p.i18n.translate("xpack.securitySolution.clipboard.copy",{defaultMessage:"Copy"});const m=p.i18n.translate("xpack.securitySolution.clipboard.copied",{defaultMessage:"Copied"}),f=p.i18n.translate("xpack.securitySolution.clipboard.to.the.clipboard",{defaultMessage:"to the clipboard"}),g=p.i18n.translate("xpack.securitySolution.clipboard.copy.to.the.clipboard",{defaultMessage:"Copy to the clipboard"});var b=n(123);const y=({children:e,content:t,isHoverAction:n,onCopy:i,titleSummary:o,toastLifeTimeMs:s})=>{const{addSuccess:l}=Object(b.a)(),u=c()("copy-to-clipboard",{securitySolution__hoverActionButton:n});return r.a.createElement(a.EuiButtonIcon,{"aria-label":g,className:u,"data-test-subj":"clipboard",iconType:"copyClipboard",onClick:e=>{e.preventDefault(),e.stopPropagation();const n=d()(`${t}`,{debug:!0});null!=i&&i({content:t,isSuccess:n}),n&&l(`${m} ${o} ${f}`,{toastLifeTimeMs:s})}},e)},h=r.a.memo((({isHoverAction:e,keyboardShortcut:t="",text:n,titleSummary:i})=>r.a.createElement(a.EuiToolTip,{content:r.a.createElement(o.b,{additionalScreenReaderOnlyContext:n,content:s.a,shortcut:t,showShortcut:""!==t})},r.a.createElement(y,{content:n,isHoverAction:e,titleSummary:i,toastLifeTimeMs:800}))));h.displayName="WithCopyToClipboard"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(2),i=n(165),r=n(248),o=n(118),s=n(157),l=n(852),c=n(970),u=n(945),d=n(958),p=n(252);const m=({defineStepDefault:e,aboutStepDefault:t,scheduleStepDefault:n,actionsStepDefault:r})=>{const{triggersActionsUi:{actionTypeRegistry:p}}=Object(o.j)().services,{form:m}=Object(s.m)({defaultValue:e,options:{stripEmptyFields:!1},schema:l.a}),[f,g]=Object(a.useState)(e.eqlOptions),[b]=Object(s.o)({form:m}),y=Object(a.useMemo)((()=>"index"in b?{...b,eqlOptions:f}:e),[e,b,f]),h=Object(a.useMemo)((()=>Object(i.m)(y.ruleType)?c.b:c.a),[y.ruleType]),{form:v}=Object(s.m)({defaultValue:t,options:{stripEmptyFields:!1},schema:h}),[E]=Object(s.o)({form:v}),x="name"in E?E:t,{form:j}=Object(s.m)({defaultValue:n,options:{stripEmptyFields:!1},schema:u.a}),[S]=Object(s.o)({form:j}),O="interval"in S?S:n,k=Object(a.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Object(d.a)(e)}]},responseActions:{},enabled:{},kibanaSiemAppUrl:{}}))({actionTypeRegistry:p})),[p]),{form:w}=Object(s.m)({defaultValue:r,options:{stripEmptyFields:!1},schema:k}),[T]=Object(s.o)({form:w});return{defineStepForm:m,defineStepData:y,aboutStepForm:v,aboutStepData:x,scheduleStepForm:j,scheduleStepData:O,actionsStepForm:w,actionsStepData:"actions"in T?T:r,eqlOptionsSelected:f,setEqlOptionsSelected:g}},f=({dataSourceType:e,index:t,dataViewId:n})=>{const{data:i}=Object(o.j)().services,[s,{browserFields:l,indexPatterns:c}]=Object(p.b)(t),[u,d]=Object(a.useState)(c);return Object(a.useEffect)((()=>{e!==r.a.IndexPatterns||s||d(c),e===r.a.DataView&&(async()=>{if(null!=n){const e=await i.dataViews.get(n);d(e)}})()}),[e,s,i,n,c]),{indexPattern:u,isIndexPatternLoading:s,browserFields:l}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),i=n(1371);const r=new a.Type("NonEmptyOrNullableStringArray",a.array(a.string).is,((e,t)=>{const n=Array.isArray(e)&&e.some((e=>""===e)),i=Array.isArray(e)&&e.some((e=>"string"!=typeof e));return Array.isArray(e)&&(n||i||0===e.length)?a.failure(e,t):a.array(a.string).validate(e,t)}),a.identity);var o=n(403);const s=a.exact(a.type({field:i.a,operator:o.c,type:a.keyof({match_any:null}),value:r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(19),o=n(42),s=n(4),l=n(620),c=n(118);const u=Object(a.memo)((()=>{const{data:e}=Object(l.a)(),[t,n]=Object(a.useState)(!1),{docLinks:u}=Object(c.j)().services,d=Object(a.useCallback)((()=>n(!0)),[]);return e?t||!0===e.data.canEncrypt?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCallOut,{color:"warning",iconType:"iInCircle","data-test-subj":"missingEncryptionKeyCallout",title:s.i18n.translate("xpack.securitySolution.responder.missingEncryptionKey.callout.title",{defaultMessage:"Set up encryption key"})},i.a.createElement("div",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responder.missingEncryptionKey.callout.body",defaultMessage:"We recommend encryption keys be configured to protect sensitive information and make your environment more secure. Without encryption keys configured, some features may not perform as intended. {viewMore}.",values:{viewMore:i.a.createElement(r.EuiLink,{href:u.links.kibana.secureSavedObject,target:"_blank"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responder.missingEncryptionKey.docsLink",defaultMessage:"View more information"}))}})),i.a.createElement(r.EuiButtonEmpty,{onClick:d,color:"warning","data-test-subj":"dismissEncryptionKeyCallout"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responder.missingEncryptionKey.callout.dismissButton.label",defaultMessage:"Dismiss"}))),i.a.createElement(r.EuiSpacer,{size:"m"})):null}));u.displayName="MissingEncryptionKeyCallout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(19),o=n(4);const s=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.nameLabel",{defaultMessage:"Exception name"}),l=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.namePlaceholder",{defaultMessage:"Name your exception"}),c=({exceptionItemName:e,onChange:t})=>{const n=Object(a.useCallback)((e=>{t(["name",e.target.value])}),[t]);return i.a.createElement(r.EuiFormRow,{label:s,"data-test-subj":"exceptionFlyoutName"},i.a.createElement(r.EuiFieldText,{placeholder:l,value:e,onChange:n,"data-test-subj":"exceptionFlyoutNameInput"}))},u=i.a.memo(c);u.displayName="ExceptionsFlyoutMeta"},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(2),i=n.n(a),r=n(19),o=n(87),s=n(1334),l=n(41),c=n.n(l),u=n(168),d=n(165),p=n(118),m=n(4);const f=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.conditionsTitle",{defaultMessage:"Conditions"}),g=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),b=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningAdd",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception created will apply to all events in the sequence."}),y=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningEdit",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."}),h=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.operatingSystemPlaceHolder",{defaultMessage:"Select an operating system"});var v=n(353),E=n(547);const x=[{label:v.h,value:["windows"]},{label:v.g,value:["macos"]},{label:v.f,value:["linux"]},{label:v.i,value:["windows","macos"]}],j=c()(r.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-x9h592-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),S=({exceptionItemName:e,allowLargeValueLists:t,exceptionListItems:n,indexPatterns:l,rules:c,exceptionListType:m,showOsTypeOptions:S,selectedOs:O,isEdit:k,onOsChange:w,onExceptionItemAdd:T,onSetErrorExists:I,getExtendedFields:M})=>{const{http:C,unifiedSearch:_}=Object(p.j)().services,D=Object(a.useMemo)((()=>m===s.a.ENDPOINT),[m]),A=Object(a.useMemo)((()=>null!=c&&c.some((e=>"eql"===e.type&&Object(d.a)(e.query)))),[c]),F=Object(a.useMemo)((()=>{if(D)return"endpoint_list";const e=D?u.k:void 0;return k?n[0].list_id:e}),[D,k,n]),N=Object(a.useMemo)((()=>{const e=D?"agnostic":void 0;return k?n[0].namespace_type:e}),[n,k,D]),P=Object(a.useCallback)((({exceptionItems:e,errorExists:t})=>{T(e),I(t)}),[I,T]),R=Object(a.useCallback)((e=>{const t=e[0].value;null!=w&&w(t||void 0)}),[w]),L=Object(a.useMemo)((()=>({asPlainText:!0})),[]),z=Object(a.useMemo)((()=>x.filter((e=>O===e.value))),[O]),q=Object(a.useMemo)((()=>S&&void 0===O),[S,O]),B=Object(a.useMemo)((()=>k?y:b),[k]),$=Object(a.useMemo)((()=>{var e;return null!==(e=k?n[0].os_types:O)&&void 0!==e?e:[]}),[n,k,O]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(j,{size:"xs"},i.a.createElement("h3",null,f)),A&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCallOut,{"data-test-subj":"eqlSequenceCallout",title:B}),i.a.createElement(r.EuiSpacer,null)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiText,{size:"s"},g),i.a.createElement(r.EuiSpacer,{size:"s"}),S&&!k&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFormRow,{label:v.e},i.a.createElement(r.EuiComboBox,{placeholder:h,singleSelection:L,options:x,selectedOptions:z,onChange:R,isClearable:!1,"data-test-subj":"osSelectionDropdown"})),i.a.createElement(r.EuiSpacer,{size:"l"})),S&&k&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"xs","data-test-subj":"exceptionItemSelectedOs"},i.a.createElement("dl",null,i.a.createElement("dt",null,v.e),i.a.createElement("dd",null,(e=>e.reduce(((e,t)=>`${(e=>"linux"===e?v.f:"macos"===e?v.g:v.h)(t)}, ${e}`),"").slice(0,-2))($)))),i.a.createElement(r.EuiSpacer,null)),Object(o.getExceptionBuilderComponentLazy)({allowLargeValueLists:t,httpService:C,autocompleteService:_.autocomplete,exceptionListItems:n,listType:m,osTypes:$,listId:F,listNamespaceType:N,exceptionItemName:e,indexPatterns:l,isOrDisabled:q,isAndDisabled:q,isNestedDisabled:q,dataTestSubj:"alertExceptionBuilder",idAria:"alertExceptionBuilder",onChange:P,isDisabled:q,allowCustomFieldOptions:!D,getExtendedFields:M,showValueListModal:E.a}))},O=i.a.memo(S);O.displayName="ExceptionsConditions"},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(19),i=n(54),r=n.n(i),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(4);const d=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.expireTimeLabel",{defaultMessage:"Exception will expire at"}),p=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTime",{defaultMessage:"Exception Expiration"}),m=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTimeError",{defaultMessage:"Selected date and time must be in the future."}),f=c()(a.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1t4zrw1-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),g=({expireTime:e,setExpireTime:t,setExpireError:n})=>{const[i,l]=Object(o.useState)(e),[c,u]=Object(o.useState)(!1),[g,b]=Object(o.useState)([]),y=Object(o.useCallback)((e=>{l(null!=e?e:void 0),t(null!=e?e:void 0),null!=e&&e.isBefore()?(u(!0),b([m]),n(!0)):(u(!1),b([]),n(!1))}),[l,t,n]);return s.a.createElement("div",null,s.a.createElement(f,{size:"xs"},s.a.createElement("h3",null,p)),s.a.createElement(a.EuiSpacer,{size:"s"}),s.a.createElement(a.EuiFormRow,{error:g,isInvalid:c,label:d},s.a.createElement(a.EuiDatePicker,{showTimeSelect:!0,selected:i,isInvalid:c,onChange:y,onClear:()=>y(null),minDate:r()()})))},b=s.a.memo(g);b.displayName="ExceptionsExpireTime"},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(41),i=n.n(a),r=n(2),o=n.n(r),s=n(7),l=n(19),c=n(4),u=n(42),d=(n(43),n(1555)),p=n(1470),m=n(1561),f=n(1870),g=n(87),b=n(122),y=n(361),h=n(245),v=n(259),E=n(167),x=n(126),j=n(252),S=n(340),O=n(16),k=n(118),w=n(451),T=n(1232),I=n(237),M=n(603),C=n(967),_=n(632),D=n(602),A=n(547),F=n(846);const N=[f.c.MAC,f.c.WINDOWS,f.c.LINUX].map((e=>({value:e,inputDisplay:I.c[e]}))),P=Object.freeze({policySelection:v.i,processDescendantsFiltering:v.h}),R=e=>e.entries.map((e=>(delete e.id,e))),L=Object(r.memo)((({allowSelectOs:e=!0,item:t,policies:n,policiesIsLoading:a,onChange:i,mode:L})=>{const q=Object(x.a)("eventFilters-form"),{http:B}=Object(k.j)().services,$=Object(r.useCallback)((({field:e,query:t})=>new D.a(B).getSuggestions({field:e.name,query:t})),[B]),V=(U=$,Object(r.useMemo)((()=>({getQuerySuggestions:()=>{},hasQuerySuggestions:e=>!1,getValueSuggestions:U})),[U]));var U;const[G,H]=Object(r.useState)(!1),[W,Q]=Object(r.useState)(!t.name),[Y,K]=Object(r.useState)(""),[J,Z]=Object(r.useState)(!1),[X,ee]=Object(r.useState)(!1),[te,ne]=Object(r.useState)([]),ae=Object(O.b)().isPlatinumPlus(),ie=Object(r.useMemo)((()=>Object(w.f)(t)),[t]),[re,oe]=Object(r.useState)(!Object(w.f)(t)),[se,le]=Object(r.useState)(!1),[ce,ue]=Object(r.useState)(Object(d.g)([t])),de=Object(r.useMemo)((()=>[E.D]),[]),[pe,{indexPatterns:me}]=Object(j.b)(de,void 0,E.l),{getTagsUpdatedBy:fe}=Object(y.e)(t,P),ge=Object(l.useEuiTheme)(),be=Object(b.a)("filterProcessDescendantsForEventFiltersEnabled"),ye=Object(r.useMemo)((()=>Object(v.g)(t)),[t]),[he,ve]=Object(r.useState)(!!t.entries.length||!1),Ee=Object(r.useMemo)((()=>null==t?void 0:t.comments),[]),xe=Object(r.useMemo)((()=>ae||"edit"===L&&(!ie||re&&ie&&G)),[L,ie,G,ae,re]),je=Object(r.useMemo)((()=>!W&&!J&&!!t.entries.length&&t.entries.some((e=>""!==e.value||e.value.length))),[J,W,t.entries]),Se=Object(r.useCallback)((e=>{const n=e?{...t,...e}:t;R(n),i({item:n,isValid:je&&he,confirmModalLabels:ce?Object(I.a)(c.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.confirmModal.name",{defaultMessage:"event filter"})):void 0})}),[he,t,je,i,ce]);Object(r.useEffect)((()=>{!G&&t.tags&&oe(!Object(w.f)({tags:t.tags}))}),[t.tags,G]),Object(r.useEffect)((()=>{if(G)return;const e=t.tags?Object(w.d)({tags:t.tags}):[];if(!e.length)return;const a=n.filter((t=>e.includes(t.id)));ne(a)}),[G,t,n]);const Oe=Object(r.useMemo)((()=>{const e=t;return e.entries=t.entries.length?t.entries:[{field:"",operator:"included",type:"match",value:""}],R(e),ve(!!t.entries.length),e}),[t]),ke=Object(r.useCallback)((e=>{if(!t)return;const n=e.target.value.trim();Q(!n),Se({name:n}),G||H(!0)}),[t,G,Se]),we=Object(r.useMemo)((()=>{var e;return o.a.createElement(l.EuiFormRow,{label:T.e,fullWidth:!0,isInvalid:W&&X,error:T.d},o.a.createElement(l.EuiFieldText,{"aria-label":T.e,id:"eventFiltersFormInputName",defaultValue:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"","data-test-subj":q("name-input"),fullWidth:!0,maxLength:256,required:X,onChange:ke,onBlur:()=>!X&&ee(!0)}))}),[q,W,ke,X,null==t?void 0:t.name]),Te=Object(r.useCallback)((e=>{t&&(G||H(!0),Se({description:e.target.value.toString().trim()}))}),[t,G,Se]),Ie=Object(r.useMemo)((()=>{var e;return o.a.createElement(l.EuiFormRow,{label:T.b,fullWidth:!0},o.a.createElement(l.EuiTextArea,{id:"eventFiltersFormInputDescription",defaultValue:null!==(e=null==t?void 0:t.description)&&void 0!==e?e:"",onChange:Te,fullWidth:!0,"data-test-subj":q("description-input"),"aria-label":T.b,maxLength:256}))}),[null==t?void 0:t.description,q,Te]),Me=Object(r.useMemo)((()=>{var e;return null!=t&&null!==(e=t.os_types)&&void 0!==e&&e.length?t.os_types[0]:f.c.WINDOWS}),[null==t?void 0:t.os_types]),Ce=Object(r.useCallback)((e=>{t&&(Se({os_types:[e],entries:t.entries}),G||H(!0))}),[t,G,Se]),_e=Object(r.useMemo)((()=>o.a.createElement(l.EuiFormRow,{label:T.f,fullWidth:!0},o.a.createElement(l.EuiSuperSelect,{name:"os",options:N,fullWidth:!0,valueOfSelected:Me,onChange:Ce}))),[Ce,Me]),De=Object(r.useCallback)((e=>{t&&(K(e),Se({comments:[{comment:e}]}),G||H(!0))}),[t,G,Se]),Ae=Object(r.useMemo)((()=>o.a.createElement(_.a,{exceptionItemComments:Ee,newCommentValue:Y,newCommentOnChange:De,setCommentError:Z})),[Ee,De,Y]),Fe=Object(r.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionTitle",defaultMessage:"Comments"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionDescription",defaultMessage:"Add a comment to your event filter."}))),o.a.createElement(l.EuiSpacer,{size:"m"}),Ae)),[Ae]),Ne=Object(r.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.detailsSectionTitle",defaultMessage:"Details"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,T.a)),o.a.createElement(l.EuiSpacer,{size:"m"}),we,Ie)),[we,Ie]),Pe=Object(r.useCallback)((e=>{const t="descendants"===e?[h.d]:[],n=fe("processDescendantsFiltering",t);Se({tags:n}),G||H(!0)}),[fe,G,Se]),Re=Object(r.useMemo)((()=>[{id:"events",label:o.a.createElement(l.EuiText,{size:"s"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.eventsButton",defaultMessage:"Events"})),iconType:ye?"empty":"checkInCircleFilled","data-test-subj":q("filterEventsButton")},{id:"descendants",label:o.a.createElement(l.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},o.a.createElement(l.EuiText,{size:"s"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.processDescendantsButton",defaultMessage:"Process Descendants"})),o.a.createElement(F.a,{"data-test-subj":q("filterProcessDescendantsTooltip")})),iconType:ye?"checkInCircleFilled":"empty","data-test-subj":q("filterProcessDescendantsButton")}]),[q,ye]),Le=Object(r.useMemo)((()=>be?o.a.createElement(o.a.Fragment,null,o.a.createElement(z,{legend:"Events or Process descendants selector",color:"primary",onChange:Pe,options:Re,idSelected:ye?"descendants":"events",$_css:ge.euiTheme.size.l}),o.a.createElement(l.EuiSpacer,{size:"m"}),ye&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"s","data-test-subj":q("filterProcessDescendants-additionalConditionDescription")},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.filterProcessDescendants.additionalConditionDescription",defaultMessage:"Additional condition added:"})),o.a.createElement("code",null,h.g),o.a.createElement(l.EuiSpacer,{size:"m"}))):null),[be,Pe,ge.euiTheme.size.l,Re,ye,q]),ze=Object(r.useCallback)((e=>{var n,a,i,r,o,l,c,u,p;if(!G&&void 0===e.exceptionItems[0]||Object(s.isEqual)(null===(n=e.exceptionItems[0])||void 0===n?void 0:n.entries,null==t?void 0:t.entries)){var m;const t=(null===(m=e.exceptionItems[0])||void 0===m?void 0:m.entries.map((e=>e.field)))||[""];return be&&ye&&t.push(h.f.field),le((p=t.reduce(((e,t)=>(t in e?e[t]++:e[t]=1,e)),{}),Object.values(p).some((e=>e>1)))),void(G||H(!0))}le(!1),ue(Object(d.g)(e.exceptionItems));const g=void 0!==e.exceptionItems[0]?{...e.exceptionItems[0],name:null!==(a=null==t?void 0:t.name)&&void 0!==a?a:"",description:null!==(i=null==t?void 0:t.description)&&void 0!==i?i:"",comments:null!==(r=null==t?void 0:t.comments)&&void 0!==r?r:[],os_types:null!==(o=null==t?void 0:t.os_types)&&void 0!==o?o:[f.c.WINDOWS],tags:null!==(l=null==t?void 0:t.tags)&&void 0!==l?l:[],meta:t.meta}:t,b=void 0!==e.exceptionItems[0]&&!(e.errorExists&&(null===(c=e.exceptionItems[0])||void 0===c||null===(u=c.entries)||void 0===u||!u.length));ve(b),Se(g),G||H(!0)}),[t,G,be,ye,Se]),qe=Object(r.useMemo)((()=>Object(g.getExceptionBuilderComponentLazy)({allowLargeValueLists:!1,httpService:B,autocompleteService:V,exceptionListItems:[Oe],listType:M.c,listId:M.a,listNamespaceType:"agnostic",ruleName:T.g,indexPatterns:me,isOrDisabled:!0,isOrHidden:!0,isAndDisabled:!1,isNestedDisabled:!1,dataTestSubj:"alert-exception-builder",idAria:"alert-exception-builder",onChange:ze,operatorsList:p.c,osTypes:t.os_types,showValueListModal:A.a})),[V,ze,B,me,t,Oe]),Be=Object(r.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionTitle",defaultMessage:"Conditions"}))),o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{size:"s"},o.a.createElement("p",null,e?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withOs",defaultMessage:"Select an operating system and add conditions."}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withoutOs",defaultMessage:"Add conditions."}))),o.a.createElement(l.EuiSpacer,{size:"m"}),e?o.a.createElement(o.a.Fragment,null,_e,o.a.createElement(l.EuiSpacer,null)):null,Le,qe)),[e,qe,_e,Le]),$e=Object(r.useCallback)((e=>{const t=Object(w.b)(e);e.isGlobal||ne(e.selected);const n=fe("policySelection",t);Se({tags:n}),G||H(!0)}),[Se,fe,G]),Ve=Object(r.useMemo)((()=>o.a.createElement(C.a,{selected:te,options:n,isGlobal:ie,isLoading:a,isPlatinumPlus:ae,onChange:$e,"data-test-subj":q("effectedPolicies")})),[te,n,ie,a,ae,$e,q]);return Object(r.useEffect)((()=>{Se()}),[Se]),pe||!t?o.a.createElement(S.a,{size:"xl"}):o.a.createElement(l.EuiForm,{component:"div"},Ne,o.a.createElement(l.EuiHorizontalRule,null),Be,ce&&o.a.createElement(m.a,null),se&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiSpacer,{size:"xs"}),o.a.createElement(l.EuiText,{color:"subdued",size:"xs","data-test-subj":"duplicate-fields-warning-message"},o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.eventFilters.warningMessage.duplicateFields",defaultMessage:"Using multiples of the same field values can degrade Endpoint performance and/or create ineffective rules"}))),xe&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.EuiHorizontalRule,null),Ve),o.a.createElement(l.EuiHorizontalRule,null),Fe)}));L.displayName="EventFiltersForm";var z=i()(l.EuiButtonGroup).withConfig({displayName:"_StyledEuiButtonGroup",componentId:"sc-1xvgrer-0"})([".euiButtonGroupButton{padding-right:",";}"],(e=>e.$_css))},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(19),i=n(444),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(60),u=n.n(c),d=n(5),p=n(134),m=n(118),f=n(769),g=n(356);const b=l()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),y=o.a.memo((({value:e})=>Object(g.a)(e)?o.a.createElement(o.a.Fragment,null,e):o.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},f.c)));y.displayName="ValueWrapper";const h=({legendItem:e})=>{const[t]=Object(m.o)(d.W),{color:n,count:i,dataProviderId:r,field:s,scopeId:l,value:c}=e;return o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),o.a.createElement(a.EuiFlexItem,{grow:!0},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(p.b,{"data-test-subj":`legend-item-${r}`,field:s,hideTopN:!0,id:r,isDraggable:!1,scopeId:l,value:c},null==e.render?o.a.createElement(y,{value:c}):e.render({field:s,value:c}))),null!=i&&o.a.createElement(b,{"data-test-subj":"legendItemCount",grow:!1},u()(i).format(t))))))};h.displayName="DraggableLegendItemComponent";const v=o.a.memo(h),E=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),x=({className:e,height:t=0,legendItems:n,minWidth:i=165})=>0===n.length?null:o.a.createElement(E,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>o.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},o.a.createElement(v,{legendItem:e}),o.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));x.displayName="DraggableLegendComponent";const j=o.a.memo(x)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(118),i=n(167);const r=e=>a.b.get().http.get(i.e,{version:"2023-10-31",query:{agent_ids:e}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(799);const i=["endpoint_list"],r=e=>!!i.find((t=>t===e.list_id)),o=e=>a.a.is(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(19),o=n(42),s=n(4),l=n(130),c=n(1221),u=n(1263),d=n(126);const p=Object(l.e)(),m=Object.freeze({errors:s.i18n.translate("xpack.securitySolution.endpointActionFailureMessage.errors",{defaultMessage:"Errors"}),host:s.i18n.translate("xpack.securitySolution.endpointActionFailureMessage.host",{defaultMessage:"Host"})}),f=Object(a.memo)((({action:e,"data-test-subj":t})=>{const n=Object(d.a)(t);return Object(a.useMemo)((()=>{if(!e.isCompleted||e.wasSuccessful)return null;const t=(e=>{const t=[];if(e.outputs||e.errors&&e.errors.length)for(const i of e.agents){var n,a;const r=null===(n=e.outputs)||void 0===n?void 0:n[i],o=e.agentState[i],s=o&&o.errors,l={name:"",errors:[]};if(!!r&&"json"===r.type&&!!r.content&&!!r.content.code&&r&&c.a[r.content.code]&&l.errors.push(c.a[r.content.code]),s){const e=[...new Set(o.errors)];l.errors.push(...e)}l.errors.length&&null!==(a=e.hosts[i])&&void 0!==a&&a.name&&(l.name=e.hosts[i].name),l.errors.length&&t.push(l)}return t})(e),a=t.map((e=>e.errors)).flat().length,s=a&&e.agents.length>1;return i.a.createElement("div",{"data-test-subj":n("response-action-failure-info")},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.actionError.errorMessage",defaultMessage:"The following { errorCount, plural, =1 {error was} other {errors were}} encountered:",values:{errorCount:a}}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(i.a.Fragment,null,a?s?t.map((e=>i.a.createElement("div",{key:e.name},i.a.createElement(u.a,{name:m.host,value:e.name.length?e.name:p}),i.a.createElement(u.a,{name:m.errors,value:e.errors.join(" | ")}),i.a.createElement(r.EuiSpacer,{size:"s"})))):i.a.createElement(i.a.Fragment,null,t[0].errors.join(" | ")):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpointActionFailureMessage.unknownFailure",defaultMessage:"An unknown error occurred"})))}),[e,n])}));f.displayName="EndpointActionFailureMessage"},,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(44),i=n(2);const r={pageName:n(156).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},o=Object(i.createContext)([r,()=>a.noop])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(68);const i=Object(a.createSelector)([e=>e.dataViewPicker],(e=>({loading:"loading"===e.state,dataViewId:e.dataView.id||"",patternList:e.patternList,indicesExist:!0,browserFields:{},activePatterns:e.patternList,runtimeMappings:{},selectedPatterns:e.patternList,indexPattern:{fields:[],title:e.dataView.title||""},sourcererDataView:{}})))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(4).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.createContext)(null)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],r=t[1],o=i.useMemo((function(){return{set:function(e,t){r((function(n){var i;return a.__assign(a.__assign({},n),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var n=t,i=e;return n[i],a.__rest(n,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),s=a.__assign({get:i.useCallback((function(e){return n[e]}),[n])},o);return[n,s]}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(41);const o=n.n(r).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(r.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));o.displayName="Wrapper";const s=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));s.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(o,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(s,{key:t},e))):i.a.createElement(s,null,e))));l.displayName="Subtitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(45),i=n(1269);const r=e=>{const t=Object(a.useSelector)((t=>Object(i.sourcererScopeSelectedDataViewId)(t,e)));return null!=t?t:void 0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return v}));var a=n(44),i=n(2),r=n(45),o=n(4),s=n(122),l=n(250),c=n(123),u=n(132),d=n(166),p=n(184),m=n(213),f=n(191),g=n(906),b=n(127);const y="createRuleFromTimeline",h="createRuleFromEql",v=e=>{const t=Object(r.useDispatch)(),{addError:n}=Object(c.a)(),{browserFields:v,dataViewId:E,selectedPatterns:x}=Object(u.a)(b.SourcererScopeName.timeline),j=Object(s.a)("unifiedComponentsInTimelineDisabled"),S=Object(i.useRef)(!1),[O,k]=Object(i.useState)(null),[w,T]=Object(i.useState)(!1),I=Object(i.useCallback)((e=>{T(!0),k(e),e.dataViewId===E||Object(a.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[E,t]),[M]=Object(i.useState)({dataViewId:E,selectedPatterns:x}),C=Object(i.useMemo)((()=>null==O||Object(a.isEmpty)(v)||null!==O.dataViewId&&null!==E&&E!==O.dataViewId?null:v),[v,E,O]),_=Object(m.g)(y),D=Object(i.useMemo)(_,[_]),A=Object(m.g)(h),F=Object(i.useMemo)(A,[A]),N=Object(i.useCallback)((()=>{if(null!=O&&null!=C){try{const t=()=>{var e,t,n,a,i,r,o;return{dataProviders:null!=O.dataProviders&&O.dataProviders.length>0?Object(l.f)(Object(f.f)(O.dataProviders,C),{fields:[],title:x.join(",")}):"",query:{query:null!==(e=null===(t=O.kqlQuery.filterQuery)||void 0===t||null===(n=t.kuery)||void 0===n?void 0:n.expression)&&void 0!==e?e:"",language:null!==(a=null===(i=O.kqlQuery.filterQuery)||void 0===i||null===(r=i.kuery)||void 0===r?void 0:r.kind)&&void 0!==a?a:"kuery"},filters:null!==(o=O.filters)&&void 0!==o?o:[],eqlOptions:{}}},n=()=>{var e;return{dataProviders:"",query:{query:null!==(e=O.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:O.eqlOptions}}},a=S.current?n():t();T(!1),e({index:x,queryBar:{filters:""!==a.dataProviders?[...a.filters,Object(g.b)(a.dataProviders)]:a.filters,query:a.query,saved_id:null},...a.eqlOptions})}catch(e){T(!1),n(e,{toastMessage:o.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:O.id}}),title:o.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}S.current=!1,M.dataViewId!==E&&t(d.a.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:M.dataViewId,selectedPatterns:M.selectedPatterns}))}}),[n,E,t,M.dataViewId,M.selectedPatterns,C,x,O,e]);Object(i.useEffect)((()=>{null!=C&&N()}),[N,C]);const P=Object(p.g)(),R=Object(i.useCallback)((e=>{null!=O&&e===O.id||P({timelineId:e,onOpenTimeline:I,unifiedComponentsInTimelineDisabled:j})}),[I,P,O,j]),[L,z]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{if(!L){let e=null;null!=D?e=D:null!=F&&(e=F,S.current=!0),null!=e&&(z(!0),R(e),T(!0))}}),[R,D,F,L]),{loading:w,onOpenTimeline:I}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return E}));var a=n(44),i=n(2),r=n.n(i),o=n(45),s=n(53),l=n(448),c=n.n(l),u=n(138),d=n(132),p=n(127),m=n(250),f=n(579),g=n(971),b=n(191),y=n(129);const h=c.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,v=Object(i.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:s,fromStr:l,kqlMode:c,isRefreshPaused:v,savedQueryId:x,setSavedQueryId:j,refreshInterval:S,timelineId:O,to:k,toStr:w,updateReduxTime:T})=>{const I=Object(o.useDispatch)(),[M,C]=Object(i.useState)(null!=l?l:new Date(s).toISOString()),[_,D]=Object(i.useState)(null!=w?w:new Date(k).toISOString()),{browserFields:A,indexPattern:F}=Object(d.a)(p.SourcererScopeName.timeline),[N,P]=Object(i.useState)(void 0),[R,L]=Object(i.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),z=Object(i.useMemo)((()=>Object(b.i)(t)),[t]),[q,B]=Object(i.useState)(Object(m.f)(Object(b.f)(e,A),F)),$=Object(f.a)(),V=Object(i.useCallback)(((e,t)=>I(y.a.applyKqlFilterQuery({id:O,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(m.f)(e,F)}}))),[I,F,O]);Object(i.useEffect)((()=>{L({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(i.useEffect)((()=>{B(Object(m.f)(Object(b.f)(e,A),F))}),[e,A,F]),Object(i.useEffect)((()=>{null!=l&&null!=w?(C(l),D(w)):null!=s&&null!=k&&(C(new Date(s).toISOString()),D(new Date(k).toISOString()))}),[s,l,k,w]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=x&&null!=$)try{const n=await $.getSavedQuery(x);e&&null!=n&&P({...n,attributes:{...n.attributes,filters:Object(b.i)(t)}})}catch(e){P(void 0)}else e&&P(void 0)}(),()=>{e=!1}}),[x]);const U=Object(i.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&V(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");T({id:u.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:O,hasRangeChanged:!0})}}),[a,O]),G=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==x&&j(e.id),null!=$&&""!==q){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===b.e)):-1;$.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),E(q),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,E(q)]:[]})}}else j(null)}),[q,x,$]);return r.a.createElement(h,{className:"search_bar_container"},r.a.createElement(g.a,{dateRangeFrom:M,dateRangeTo:_,hideSavedQuery:"search"===c,indexPattern:F,isRefreshPaused:v,filterQuery:R,filterManager:n,filters:z,onSubmitQuery:U,refreshInterval:S,savedQuery:N,onSavedQuery:G,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),E=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:b.e,controlledBy:b.e,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:s.FilterStateStore.APP_STATE}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(19),i=n(2),r=n.n(i),o=n(41);const s=n.n(o)()((({iconSide:e,children:t,...n})=>r.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(o.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(o.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(o.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));s.displayName="Link";const l=r.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:o,disabled:l,href:c,iconSide:u="left",iconSize:d="s",iconType:p,onClick:m})=>{const f=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?f(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),g=Object(i.useMemo)((()=>e||f(t)),[e,t,f]);return r.a.createElement(s,{className:"siemLinkIcon",color:n,"data-test-subj":o,disabled:l,href:c,iconSide:u,onClick:m,"aria-label":g},r.a.createElement(a.EuiIcon,{size:d,type:p}),r.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(19),i=n(44),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(121),u=n(747),d=n(184),p=n(163),m=n(130),f=n(443),g=n(137);const b=l()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),y=l()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),h=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:s,timelineType:l,placeholder:h})=>{const[v,E]=Object(r.useState)(50),[x,j]=Object(r.useState)(0),[S,O]=Object(r.useState)(""),[k,w]=Object(r.useState)(!1),{fetchAllTimeline:T,timelines:I,loading:M,totalCount:C}=Object(u.b)(),_=Object(r.useRef)(null),D=Object(r.useRef)(null),A=Object(r.useMemo)((()=>Object(i.debounce)(500,O)),[]),F=Object(r.useCallback)((e=>{A(e)}),[A]),N=Object(r.useCallback)((()=>{w(!k)}),[k]),P=Object(r.useCallback)(((e,t,n)=>{if(e<t&&_.current&&D.current){const e=_.current.clientHeight,t=D.current.clientHeight;n>10&&t-n<1.2*e&&t>x&&(j(t),E(v+50))}}),[x,v]),R=Object(r.useCallback)(((e,t)=>{const n=Object(d.e)({...e,title:e.timelineTitle})?p.Z:e.timelineTitle,r=null!=e.description&&e.description.trim().length>0?e.description:null;return o.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),o.a.createElement(b,{grow:!0},o.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},o.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},o.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},o.a.createElement(a.EuiHighlight,{search:t},n))),o.a.createElement(a.EuiFlexItem,null,o.a.createElement(a.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate eui-alignMiddle"},o.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},o.a.createElement("small",null,null!=r?r:Object(m.d)())))))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),L=Object(r.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&s(Object(i.isEmpty)(t[0].timelineTitle)?p.Z:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,s]),z=Object(r.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]),q=Object(r.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=h?h:f.e(l),onSearch:F,incremental:!1,append:o.a.createElement(y,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:k,onClick:N},p.D)})),[N,F,k,l,h]),B=Object(r.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>P((null!=I?I:[]).filter((t=>!e||""!==t.title)).length,C,t),outerRef:_,innerRef:D}})),[P,e,C,I]);return Object(r.useEffect)((()=>{T({pageInfo:{pageIndex:1,pageSize:v},search:S,sort:{sortField:c.g.updated,sortOrder:g.b.desc},onlyUserFavorite:k,status:null,timelineType:l})}),[T,k,v,S,l]),o.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:M&&null==I,listProps:B,renderOption:R,onChange:L,searchable:!0,searchProps:q,singleSelection:!0,options:($=t({timelines:null!=I?I:[],onlyFavorites:k,searchTimelineValue:S,timelineType:l}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},z);var $},v=Object(r.memo)(h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(57),i=n(129);const r=()=>Object(a.createSelector)(i.b.selectTimeline,(e=>{var t,n;return{createdBy:e.createdBy,expandedDetail:null!==(t=e.expandedDetail)&&void 0!==t?t:{},eventIdToNoteIds:null!==(n=null==e?void 0:e.eventIdToNoteIds)&&void 0!==n?n:{},noteIds:e.noteIds,status:e.status}}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="memory"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(19),o=n(121),s=n(163),l=n(292);const c=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[c,u]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===o.m.template),[e]),p=Object(a.useMemo)((()=>d?c:null),[c,d]),m=Object(a.useMemo)((()=>null==p?null:p===o.h.elastic?o.l.immutable:o.l.active),[p]),f=Object(a.useMemo)((()=>[{id:o.h.elastic,name:s.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:o.h.custom,name:s.r,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),g=Object(a.useCallback)((e=>{u(c===e?null:e)}),[u,c]),b=Object(a.useMemo)((()=>d?f.map((e=>i.a.createElement(r.EuiFilterButton,{hasActiveFilters:e.id===p,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:g.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[p,f,d,g]),y=Object(a.useCallback)((async()=>{p!==o.h.custom&&await Object(l.g)()}),[p]);return{timelineStatus:m,templateTimelineType:p,templateTimelineFilter:b,installPrepackagedTimelines:y}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(45),o=n(19),s=n(4),l=n(169),c=n(129),u=n(121),d=n(365);const p=s.i18n.translate("xpack.securitySolution.timeline.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),m=s.i18n.translate("xpack.securitySolution.timeline.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),f=i.a.memo((({timelineId:e,isPartOfGuidedTour:t=!1})=>{const n=Object(r.useDispatch)(),{isFavorite:s,status:f}=Object(r.useSelector)((t=>Object(l.selectTimelineById)(t,e))),g=f!==u.l.active,b=s?m:p,y=Object(a.useCallback)((()=>n(c.a.updateIsFavorite({id:e,isFavorite:!s}))),[n,e,s]);return i.a.createElement(o.EuiButtonIcon,{id:t?d.a.ADD_TO_FAVORITES:void 0,iconType:s?"starFilled":"starEmpty",isSelected:s,disabled:g,"aria-label":b,title:b,"data-test-subj":`timeline-favorite-${s?"filled":"empty"}-star`,onClick:y},b)}));f.displayName="AddToFavoritesButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(19),o=n(44),s=n(4),l=n(129),c=n(158),u=n(124),d=n(121);const p=s.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedLabel",{defaultMessage:"Unsaved"}),m=s.i18n.translate("xpack.securitySolution.timeline.saveStatus.unsavedChangesLabel",{defaultMessage:"Unsaved changes"}),f=i.a.memo((({timelineId:e})=>{const t=Object(a.useMemo)((()=>l.b.getTimelineByIdSelector()),[]),{changed:n=!1,status:s,updated:f}=Object(u.a)((n=>{var a;return Object(o.pick)(["changed","status","updated"],null!==(a=t(n,e))&&void 0!==a?a:c.b)}));let g;return s!==d.l.draft&&f?n&&(g=i.a.createElement(r.EuiBadge,{color:"warning"},m)):g=i.a.createElement(r.EuiBadge,{color:"warning"},p),g?i.a.createElement(r.EuiText,{size:"xs","data-test-subj":"timeline-save-status"},g):null}));f.displayName="TimelineSaveStatus"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(57),i=n(146),r=n(1268),o=n(169);const s=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.d.query})),l=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),c=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),u=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),p=()=>Object(a.createSelector)(r.selectNotesById,(e=>Object.values(e))),m=()=>Object(a.createSelector)(o.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(19),o=n(42),s=n(56);const l={tall:490,short:250},c=Object(a.createContext)({tableId:null}),u=({height:e="tall"})=>i.a.createElement(r.EuiPanel,{color:"subdued"},i.a.createElement(r.EuiFlexGroup,{style:{height:l[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},p=()=>{const{http:e}=Object(s.useKibana)().services;return i.a.createElement(r.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPanel,{hasBorder:!0,style:d},i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTitle,null,i.a.createElement("h3",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(19),i=n(78),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(414),u=n(138),d=n(474),p=n(447),m=n(658),f=n(267),g=n(282),b=n(625),y=n(127);const h=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),v=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:n,extraOptions:s,getLensAttributes:l,inputId:v=u.a.global,inspectIndex:E=0,isInspectButtonDisabled:x,isMultipleQuery:j,lensAttributes:S,onCloseInspect:O,queryId:k,timerange:w,title:T,scopeId:I=y.SourcererScopeName.default,stackByField:M,withActions:C=b.a,casesAttachmentMetadata:_})=>{const[D,A]=Object(r.useState)(!1),[F,N]=Object(r.useState)(!1),P=Object(r.useCallback)((()=>{A(!D)}),[D]),R=()=>{A(!1)},L=Object(m.a)({applyGlobalQueriesAndFilters:e,extraOptions:s,getLensAttributes:l,lensAttributes:S,scopeId:I,stackByField:M,title:""}),z=`stat-${k}`,q=Object(r.useCallback)((()=>{R(),N(!0)}),[]),B=Object(r.useCallback)((()=>{N(!1),O&&O()}),[O]),{additionalRequests:$,additionalResponses:V,handleClick:U,handleCloseModal:G,isButtonDisabled:H,request:W,response:Q}=Object(p.a)({inputId:v,inspectIndex:E,isDisabled:x,multiple:j,onCloseInspect:B,onClick:q,queryId:k}),Y=Object(r.useMemo)((()=>({handleInspectClick:U,isInspectButtonDisabled:H})),[H,U]),K=Object(b.d)({attributes:L,extraActions:n,inspectActionProps:Y,timeRange:w,withActions:C,lensMetadata:_}),J=Object(c.useAsync)((()=>Object(i.buildContextMenuForActions)({actions:K.map((e=>({action:e,context:{},trigger:b.c})))})),[K]),Z=Object(r.useMemo)((()=>o.a.createElement(a.EuiButtonIcon,{"aria-label":f.l,className:g.a,"data-test-subj":z,iconType:"boxesHorizontal",onClick:P})),[z,P]);return o.a.createElement(h,{className:t},J.value&&J.value.length>0&&o.a.createElement(a.EuiPopover,{button:Z,isOpen:D,closePopover:R,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},o.a.createElement(a.EuiContextMenu,{"data-test-subj":"viz-actions-panel",size:"s",panels:J.value})),F&&null!==W&&null!==Q&&o.a.createElement(d.a,{additionalRequests:$,additionalResponses:V,closeModal:G,inputId:v,request:W,response:Q,title:T}))};v.displayName="VisualizationActionsComponent";const E=o.a.memo(v)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(519);const i=e=>{let t="";var n,i,r,o,s,l;return t=(e=>Array.isArray(e))(e)?Object(a.a)({category:"host",field:"host.os.platform"},e)||Object(a.a)({category:"host",field:"host.os.type"},e)||Object(a.a)({category:"host",field:"host.os.name"},e):(null===(n=e.host)||void 0===n||null===(i=n.os)||void 0===i?void 0:i.platform)||(null===(r=e.host)||void 0===r||null===(o=r.os)||void 0===o?void 0:o.type)||(null===(s=e.host)||void 0===s||null===(l=s.os)||void 0===l?void 0:l.name)||"",t.toLowerCase()}},function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return w}));var a=n(1737),i=n(44),r=n(19),o=n(2),s=n.n(o),l=n(41),c=n.n(l),u=n(748),d=n(1630),p=n(145),m=n(198),f=n(1101),g=n(533),b=n(695),y=n(1227),h=n(197),v=n(151),E=n(1210),x=n(775);const j=c()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-4qbs0b-0"})(["flex:0 1 auto;",""],(({theme:e})=>`margin-top: ${e.eui.euiSizeS};`)),S=c()(r.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-4qbs0b-1"})(["height:100%;"]),O=c()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-4qbs0b-2"})(["&.euiFlexItem{flex:1 0 0;overflow:hidden;}"]),k=s.a.memo((({eventId:e,eventIndex:t,isAlert:n,loading:l,handleOnEventClosed:c,promptContextId:b,ruleName:S,timestamp:O,scopeId:k,refetchFlyoutData:w,getFieldsData:T})=>{const{hasAssistantPrivilege:I}=Object(g.a)(),M=Object(E.a)({_id:e,_index:t,timestamp:O}),{refetch:C}=Object(x.a)({scopeId:k}),_=Object(o.useMemo)((()=>{var e;return null!==(e=T(u.F))&&void 0!==e?e:[]}),[T]),D=Object(o.useCallback)((()=>{C(),w()}),[C,w]);return s.a.createElement(j,{gutterSize:"none",justifyContent:"spaceBetween",wrap:!0},s.a.createElement(r.EuiFlexItem,{grow:!1},!l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiTitle,{size:"s"},s.a.createElement("h4",null,n&&!Object(i.isEmpty)(S)?S:y.c)),O&&s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiSpacer,{size:"s"}),s.a.createElement(v.c,{value:new Date(O)})))),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiFlexGroup,{direction:"column",alignItems:"flexEnd",gutterSize:"none"},c&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiButtonIcon,{iconType:"cross","aria-label":y.b,onClick:c})),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},I&&null!=b&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(a.a,{conversationTitle:n?h.e:h.i,promptContextId:b})),n&&M&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiCopy,{textToCopy:(A=M,`${A}&${m.a.flyout}=(preview:!(),right:(id:${p.e},params:(id:'${e}',indexName:${t},scopeId:${k})))`)},(e=>s.a.createElement(r.EuiButtonEmpty,{onClick:e,iconType:"share","data-test-subj":"copy-alert-flyout-link"},y.e)))))),n&&k!==d.b.rulePreview&&s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(f.a,{eventId:e,assignedUserIds:_,onAssigneesUpdated:D})))));var A}));k.displayName="ExpandableEventTitle";const w=s.a.memo((({browserFields:e,event:t,scopeId:n,timelineTabType:a,isAlert:i,isDraggable:o,loading:l,detailsData:c,detailsEcsData:u,rawEventData:d,handleOnEventClosed:p,isReadOnly:m})=>t.eventId?l?s.a.createElement(r.EuiSkeletonText,{lines:10}):s.a.createElement(S,{direction:"column",gutterSize:"none"},s.a.createElement(O,{grow:!0},s.a.createElement(b.a,{browserFields:e,data:null!=c?c:[],detailsEcsData:u,id:t.eventId,isAlert:i,isDraggable:o,rawEventData:d,scopeId:n,timelineTabType:a,handleOnEventClosed:p,isReadOnly:m}))):s.a.createElement(r.EuiTextColor,{color:"subdued"},y.d)));w.displayName="ExpandableEvent"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(19),o=n(824),s=n(825),l=n(826),c=n(1248);const u=Object(a.memo)((({searchInputId:e,assignedUserIds:t,onApply:n})=>{const[u,d]=Object(a.useState)(t),p=Object(a.useMemo)((()=>{const e=Object(s.b)(u);return{add:e.filter((e=>!t.includes(e))),remove:t.filter((t=>!e.includes(t)))}}),[t,u]),m=Object(a.useMemo)((()=>p.add.length||p.remove.length),[p]),f=Object(a.useCallback)((e=>{d(e)}),[]),g=Object(a.useCallback)((async()=>{n(p)}),[p,n]);return i.a.createElement("div",{"data-test-subj":l.b},i.a.createElement(c.a,{searchInputId:e,assignedUserIds:t,onSelectionChange:f}),i.a.createElement(r.EuiButton,{"data-test-subj":l.a,fullWidth:!0,size:"s",onClick:g,isDisabled:!m},o.a))}));u.displayName="AssigneesPanel"},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(1334),r=n(540),o=n(270),s=n(172);const l=({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const{exceptionActionItems:n}=(({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const[{canUserCRUD:n,hasIndexWrite:r}]=Object(o.b)(),l=Object(a.useCallback)((()=>{t()}),[t]),c=Object(a.useCallback)((()=>{t(i.a.ENDPOINT)}),[t]),u=!n||!r||!e,d=!n||!r;return{exceptionActionItems:Object(a.useMemo)((()=>d?[]:[{key:"add-endpoint-exception-menu-item","data-test-subj":"add-endpoint-exception-menu-item",disabled:u,onClick:c,name:s.d},{key:"add-exception-menu-item","data-test-subj":"add-exception-menu-item",disabled:d,onClick:l,name:s.g}]),[u,d,l,c])}})({isEndpointAlert:e,onAddExceptionTypeClick:t});return Object(r.a)("crudEndpointExceptions")?{exceptionActionItems:n}:{exceptionActionItems:n.map((e=>({...e,disabled:e.name===s.d})))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(172);const r=({onAddEventFilterClick:e,disabled:t=!1,tooltipMessage:n})=>({eventFilterActionItems:Object(a.useMemo)((()=>[{key:"add-event-filter-menu-item","data-test-subj":"add-event-filter-menu-item",onClick:e,disabled:t,toolTipContent:n,name:i.e}]),[e,t,n])})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(716);const i=({handleClick:e})=>({key:"osquery-action-item","data-test-subj":"osquery-action-item",onClick:e,size:"s",name:a.a})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(748),r=n(1245),o=n(293);const s=({closePopover:e,ecsRowData:t,refetch:n})=>{var s;const{hasIndexWrite:l}=Object(o.a)(),c=t._id,u=Object(a.useMemo)((()=>{var e,n,a,r;return[{_id:c,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:i.H,value:null!==(n=null==t||null===(a=t.kibana)||void 0===a?void 0:a.alert.workflow_tags)&&void 0!==n?n:[]}],ecs:{_id:c,_index:null!==(r=t._index)&&void 0!==r?r:""}}]}),[c,t._index,null==t||null===(s=t.kibana)||void 0===s?void 0:s.alert.workflow_tags]),{alertTagsItems:d,alertTagsPanels:p}=Object(r.a)({refetch:n}),m=Object(a.useMemo)((()=>d.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key})))),[d]);return{alertTagsItems:l?m:[],alertTagsPanels:Object(a.useMemo)((()=>p.map((t=>{const n=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:u});return{title:t.title,content:n,id:t.id}}))),[u,p,e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(7),i=n(2),r=n(748),o=n(405),s=n(1252),l=n(293);const c=({closePopover:e,ecsRowData:t,refetch:n})=>{var c;const{hasIndexWrite:u}=Object(l.a)(),d=t._id,p=Object(i.useMemo)((()=>{var e,n,a,i;return[{_id:d,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:r.F,value:null!==(n=null==t||null===(a=t.kibana)||void 0===a?void 0:a.alert.workflow_assignee_ids)&&void 0!==n?n:[]}],ecs:{_id:d,_index:null!==(i=t._index)&&void 0!==i?i:""}}]}),[d,t._index,null==t||null===(c=t.kibana)||void 0===c?void 0:c.alert.workflow_assignee_ids]),m=Object(i.useCallback)((()=>{e(),n&&n()}),[e,n]),{alertAssigneesItems:f,alertAssigneesPanels:g}=Object(s.a)({onAssigneesUpdate:m}),b=Object(i.useMemo)((()=>f.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key,onClick:()=>{var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,p,!1,a.noop,a.noop,a.noop)}})))),[p,f]);return{alertAssigneesItems:u?b:[],alertAssigneesPanels:Object(i.useMemo)((()=>g.map((t=>{const n=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:p,refresh:m});return{title:t.title,content:n,id:t.id,width:o.a}}))),[p,g,e,m])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(256);const r=({refetch:e,onRuleChange:t,isActiveTimelines:n})=>{const{setAllTourStepsHidden:r}=Object(i.b)(),[o,s]=Object(a.useState)(!1),[l,c]=Object(a.useState)(null);return{exceptionFlyoutType:l,openAddExceptionFlyout:o,onAddExceptionTypeClick:Object(a.useCallback)((e=>{c(null!=e?e:null),r(!0),s(!0)}),[r]),onAddExceptionCancel:Object(a.useCallback)((()=>{c(null),r(!1),s(!1)}),[r]),onAddExceptionConfirm:Object(a.useCallback)(((a,i,o)=>{e&&(!1===n||o)&&e(),null!=t&&a&&t(),r(!1),s(!1)}),[e,n,t,r])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var a=n(19),i=n(2),r=n.n(i),o=n(41),s=n.n(o),l=n(121),c=n(510);const u=s.a.span.withConfig({displayName:"NotificationDot",componentId:"sc-v4xtfs-0"})(["position:absolute;display:block;width:6px;height:6px;border-radius:50%;background-color:",";top:17%;left:52%;"],(({theme:e})=>e.eui.euiColorDanger)),d="notes-button",p=s()(a.EuiFlexGroup).withConfig({displayName:"NotesButtonContainer",componentId:"sc-v4xtfs-1"})(["position:relative;"]),m=r.a.memo((({ariaLabel:e=c.b,isDisabled:t,toggleShowNotes:n,timelineType:o,eventId:s,notesCount:m})=>{const f=o===l.m.template,g=Object(i.useCallback)((()=>{null!=s?null==n||n(s):null==n||n()}),[n,s]);return r.a.createElement(p,null,r.a.createElement(a.EuiFlexItem,{grow:!1},m>0?r.a.createElement(u,{className:"timeline-notes-notification-dot","data-test-subj":"timeline-notes-notification-dot"}):null,r.a.createElement(a.EuiButtonIcon,{"aria-label":e,className:d,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:g,size:"s",isDisabled:f})))}));m.displayName="SmallNotesButton";const f=r.a.memo((({ariaLabel:e,isDisabled:t,timelineType:n,toggleShowNotes:i,toolTip:o,eventId:s,notesCount:l})=>r.a.createElement(a.EuiToolTip,{content:o,"data-test-subj":"timeline-notes-tool-tip"},r.a.createElement(m,{ariaLabel:e,isDisabled:t,toggleShowNotes:i,timelineType:n,eventId:s,notesCount:null!=l?l:0}))));f.displayName="NotesButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(67),i=n(544);const r=(e,t={})=>{var n;return e.get(i.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${a.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`},version:a.API_VERSIONS.public.v1})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=()=>{const[e,t]=Object(a.useState)(!1),n=Object(a.useCallback)((()=>{t(!0)}),[]);return{closeAddEventFilterModal:Object(a.useCallback)((()=>{t(!1)}),[]),isAddEventFilterModalOpen:e,onAddEventFilterClick:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return y}));var a=n(19),i=n(44),r=n(2),o=n.n(r),s=n(134),l=n(130),c=n(144),u=n(378);const d="ip-overview",p=(e,t,n,c)=>e.length>0&&e.every((e=>Object(i.getOr)(null,e,t)))?o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},e.map(((e,l)=>{const u=Object(i.getOr)("",e,t);return o.a.createElement(r.Fragment,{key:`${d}-${e}`},l?", ":"",o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`location-renderer-default-draggable-${d}-${n?`${n}-`:""}${e}`,isDraggable:null!=c&&c,field:e,value:u,isAggregatable:!0,fieldType:"keyword"})))}))):Object(l.d)(),m=(e,t,n,i)=>e&&e.organization&&e.organization.name&&e.number?o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`autonomous-system-renderer-default-draggable-${d}-${n?`${n}-`:""}${t}.as.organization.name`,isDraggable:null!=i&&i,field:`${t}.as.organization.name`,value:e.organization.name})),o.a.createElement(a.EuiFlexItem,{grow:!1},"/"),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(s.b,{id:`autonomous-system-renderer-default-draggable-${d}-${n?`${n}-`:""}${t}.as.number`,isDraggable:!1,field:`${t}.as.number`,value:`${e.number}`,isAggregatable:!0,fieldType:"number"}))):Object(l.d)(),f=({contextID:e,host:t,isDraggable:n=!1,ipFilter:a,noLink:i})=>t.id&&t.ip&&(null==a||t.ip.includes(a))?o.a.createElement(o.a.Fragment,null,t.name&&null!=t.name[0]?o.a.createElement(s.b,{id:`host-id-renderer-default-draggable-${d}-${e?`${e}-`:""}host-id`,isDraggable:n,field:"host.id",value:t.id[0],isAggregatable:!0,fieldType:"keyword"},i?o.a.createElement(o.a.Fragment,null,t.id):o.a.createElement(c.d,{hostName:t.name[0]},t.id)):o.a.createElement(o.a.Fragment,null,t.id)):Object(l.d)(),g=(e,t,n,a)=>e&&e.name&&e.name[0]&&e.ip&&(null==t||e.ip.includes(t))?o.a.createElement(s.b,{id:`host-name-renderer-default-draggable-${d}-${n?`${n}-`:""}host-name`,isDraggable:null!=a&&a,field:"host.name",value:e.name[0],isAggregatable:!0,fieldType:"keyword"},o.a.createElement(c.d,{hostName:e.name[0]},e.name?e.name:Object(l.d)())):Object(l.d)(),b=e=>o.a.createElement(c.n,{domain:e},u.n),y=e=>o.a.createElement(c.j,{domain:e,direction:"column"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));const a={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1,enabled:void 0,ruleExecutionStatus:void 0},i={field:"enabled",order:"desc"},r=1,o=20},function(e,t,n){const a=n(311),i=n(348),r=n(164),o=n(558),s=n(283),l=n(656),c=n(1108),u=n(1109),d=n(1110),p=n(1111),m=n(1112),f=n(1113),g=n(1114),b=n(190),y=n(1115),h=n(1116),v=n(490),E=n(1117),x=n(1118),j=n(385),S=n(491),O=n(671),k=n(672),w=n(421),T=n(492),I=n(673),M=n(941),C=n(386),_=n(193),D=n(387),A=n(1120),F=n(1121),N=n(1122),P=n(1123),R=n(1124),L=n(493),z=n(1125),q=n(1126),B=n(1127),$=n(1128),V=n(1129);e.exports={parse:s,valid:l,clean:c,inc:u,diff:d,major:p,minor:m,patch:f,prerelease:g,compare:b,rcompare:y,compareLoose:h,compareBuild:v,sort:E,rsort:x,gt:j,lt:S,eq:O,neq:k,gte:w,lte:T,cmp:I,coerce:M,Comparator:C,Range:_,satisfies:D,toComparators:A,maxSatisfying:F,minSatisfying:N,minVersion:P,validRange:R,outside:L,gtr:z,ltr:q,intersects:B,simplifyRange:$,subset:V,SemVer:r,re:a.re,src:a.src,tokens:a.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},function(e,t,n){const a=n(164),i=n(283),{safeRe:r,t:o}=n(311);e.exports=(e,t)=>{if(e instanceof a)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){const a=t.includePrerelease?r[o.COERCERTLFULL]:r[o.COERCERTL];let i;for(;(i=a.exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),a.lastIndex=i.index+i[1].length+i[2].length;a.lastIndex=-1}else n=e.match(t.includePrerelease?r[o.COERCEFULL]:r[o.COERCE]);if(null===n)return null;const s=n[2],l=n[3]||"0",c=n[4]||"0",u=t.includePrerelease&&n[5]?`-${n[5]}`:"",d=t.includePrerelease&&n[6]?`+${n[6]}`:"";return i(`${s}.${l}.${c}${u}${d}`,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(44),i=n(19),r=n(2),o=n.n(r),s=n(413),l=n.n(s),c=n(675),u=n.n(c),d=n(41),p=n.n(d),m=n(69),f=n(42),g=n(1347),b=n(5),y=n(157),h=n(118),v=n(688);const E=[{isSummaryOption:!0,isForEachAlertOption:!0,value:{value:"onActiveAlert",inputDisplay:v.d,"data-test-subj":"onActiveAlert",dropdownDisplay:o.a.createElement(i.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(f.FormattedMessage,{defaultMessage:"Per rule run",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.label"})))}},{isSummaryOption:!0,isForEachAlertOption:!1,value:{value:"onThrottleInterval",inputDisplay:v.a,"data-test-subj":"onThrottleInterval",dropdownDisplay:o.a.createElement(i.EuiText,{size:"s"},o.a.createElement("p",null,o.a.createElement(f.FormattedMessage,{defaultMessage:"Custom frequency",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.label"})))}}],x=p.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-12frxs0-0"})(["p{margin-bottom:0;}"]),j=p.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-12frxs0-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__children {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),S=({field:e,messageVariables:t,summaryMessageVariables:n})=>{const[s,c]=Object(r.useState)(null),d=Object(y.n)(),{isValid:p}=d,{triggersActionsUi:{getActionForm:f}}=Object(h.j)().services,[S,O]=Object(r.useState)(!1),k=Object(r.useMemo)((()=>Object(a.isEmpty)(e.value)?[]:e.value),[e.value]),w=Object(r.useMemo)((()=>k.reduce(((e,t,n)=>".case"===t.actionTypeId?[...e,`${n}`]:e),[])),[k]),T=Object(r.useCallback)(((t,n)=>{const i=[...k];Object(a.isEmpty)(i[n].params)&&O(!0),i[n]=l()(i[n],{id:t}),e.setValue(i)}),[e,k]),I=Object(r.useCallback)((t=>e.setValue(t)),[e]),M=Object(r.useCallback)(((t,n,a)=>{const i=()=>{e.setValue((e=>{const i=[...e];return i[a]={...i[a],params:{...i[a].params,[t]:n}},i}))};S?(setTimeout(i,0),O(!1)):i()}),[e,S]),C=Object(r.useCallback)(((t,n,i)=>{e.setValue((e=>{const r=[...e],{alertsFilter:o,...s}=r[i],l={...o};return n?l[t]=n:delete l[t],r[i]={...s,...Object(a.isEmpty)(l)?{}:{alertsFilter:l}},r}))}),[e]),_=Object(r.useCallback)(((t,n,a)=>{e.setValue((e=>{var i;const r=[...e];return r[a]={...r[a],frequency:{...null!==(i=r[a].frequency)&&void 0!==i?i:b.ec,[t]:n}},r}))}),[e]),D=void 0!==p,A=Object(r.useMemo)((()=>f({actions:k,messageVariables:t,summaryMessageVariables:n,defaultActionGroupId:"default",setActionIdByIndex:T,setActions:I,setActionParamsProperty:M,setActionFrequencyProperty:_,setActionAlertsFilterProperty:C,featureId:m.SecurityConnectorFeatureId,producerId:g.a.SIEM,defaultActionMessage:v.c,defaultSummaryMessage:v.e,hideActionHeader:!0,hasAlertsMappings:!0,notifyWhenSelectOptions:E,defaultRuleFrequency:b.ec,disableErrorMessages:!D})),[k,f,t,n,_,T,M,I,C,D]);return Object(r.useEffect)((()=>{if(!1===p){const t=e.errors.map((({message:e})=>e)).join("\n");return c(t)}return c(null)}),[e.errors,p]),o.a.createElement(j,{$caseIndexes:w},s?o.a.createElement(o.a.Fragment,null,o.a.createElement(x,null,o.a.createElement(i.EuiCallOut,{title:v.b,color:"danger",iconType:"warning"},o.a.createElement(u.a,null,s))),o.a.createElement(i.EuiSpacer,null)):null,A)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return q}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(44),u=n(19),d=n(813),p=n(1560),m=n(298),f=n(130),g=n(438),b=n(773),y=n(689),h=n(408),v=n(368);const E=l()(u.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-ssmf6u-0"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),x=l()(u.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-ssmf6u-1"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),j=l()(u.EuiLink).withConfig({displayName:"StyledEuiLink",componentId:"sc-ssmf6u-2"})(["word-break:break-word;"]),S=({name:e})=>o.a.createElement(u.EuiText,{size:"s"},e),O=({description:e})=>o.a.createElement(u.EuiText,{size:"s"},e),k=({author:e})=>o.a.createElement(y.a,{badges:e,"data-test-subj":"authorPropertyValue"}),w=()=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"buildingBlockPropertyValue"},v.d),T=({severityMappingItem:e})=>o.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(E,null,o.a.createElement(u.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField-${e.value}`},o.a.createElement("span",{"data-test-subj":"severityOverrideField"},`${e.field}:`))),o.a.createElement(x,null,o.a.createElement(u.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue-${e.value}`},o.a.createElement("span",{"data-test-subj":"severityOverrideValue"},Object(f.a)(e.value)))),o.a.createElement(u.EuiFlexItem,{grow:!1},o.a.createElement(u.EuiIcon,{type:"sortRight"})),o.a.createElement(u.EuiFlexItem,null,o.a.createElement(m.a,{"data-test-subj":"severityOverrideSeverity",value:e.severity}))),I=({riskScore:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"riskScorePropertyValue"},e),M=({riskScoreMappingItem:e})=>o.a.createElement(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(E,null,o.a.createElement(u.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField-${e.value}`},o.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyFieldName"},e.field))),o.a.createElement(u.EuiFlexItem,{grow:!1},o.a.createElement(u.EuiIcon,{type:"sortRight"})),o.a.createElement(u.EuiFlexItem,{"data-test-subj":"riskScoreOverridePropertyOverride"},d.a)),C=({references:e})=>o.a.createElement(u.EuiText,{size:"s"},o.a.createElement("ul",null,e.filter((e=>!Object(c.isEmpty)(e))).map(((e,t)=>o.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},o.a.createElement(j,{href:e,external:!0,target:"_blank"},e)))))),_=({falsePositives:e})=>o.a.createElement(u.EuiText,{size:"s"},o.a.createElement("ul",null,e.map((e=>o.a.createElement("li",{"data-test-subj":"falsePositivesPropertyValueItem",key:`falsePositives-${e}`},e))))),D=({investigationFields:e})=>o.a.createElement(y.a,{badges:e,"data-test-subj":"investigationFieldsPropertyValue"}),A=({license:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"licensePropertyValue"},e),F=({ruleNameOverride:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"ruleNameOverridePropertyValue"},e),N=({threat:e})=>o.a.createElement(b.a,{threat:Object(g.a)(e),"data-test-subj":"threatPropertyValue"}),P=({threatIndicatorPath:e})=>o.a.createElement(u.EuiText,{size:"s"},e),R=({timestampOverride:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"timestampOverridePropertyValue"},e),L=({maxSignals:e})=>o.a.createElement(u.EuiText,{size:"s","data-test-subj":"maxSignalsPropertyValue"},e),z=({tags:e})=>o.a.createElement(y.a,{badges:e,"data-test-subj":"tagsPropertyValue"}),q=({rule:e,columnWidths:t=h.b,hideName:n,hideDescription:a,...r})=>{var s,l;const c=((e,t,n)=>{const a=[];return!t&&e.name&&a.push({title:v.x,description:o.a.createElement(S,{name:e.name})}),!n&&e.description&&a.push({title:v.k,description:o.a.createElement(O,{description:e.description})}),e.author&&e.author.length>0&&a.push({title:o.a.createElement("span",{"data-test-subj":"authorPropertyTitle"},v.c),description:o.a.createElement(k,{author:e.author})}),e.building_block_type&&a.push({title:o.a.createElement("span",{"data-test-subj":"buildingBlockPropertyTitle"},v.e),description:o.a.createElement(w,null)}),e.severity&&a.push({title:o.a.createElement("span",{"data-test-subj":"severityPropertyTitle"},v.J),description:o.a.createElement(m.a,{value:e.severity,"data-test-subj":"severityPropertyValue"})}),e.severity_mapping&&e.severity_mapping.length>0&&a.push(...e.severity_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?o.a.createElement("span",{"data-test-subj":"severityOverridePropertyTitle"},v.K):"",description:o.a.createElement(T,{severityMappingItem:e})})))),e.risk_score&&a.push({title:o.a.createElement("span",{"data-test-subj":"riskScorePropertyTitle"},v.D),description:o.a.createElement(I,{riskScore:e.risk_score})}),e.risk_score_mapping&&e.risk_score_mapping.length>0&&a.push(...e.risk_score_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?o.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyTitle"},v.E):"",description:o.a.createElement(M,{riskScoreMappingItem:Object(p.a)(e)})})))),e.references&&e.references.length>0&&a.push({title:o.a.createElement("span",{"data-test-subj":"referencesPropertyTitle"},v.A),description:o.a.createElement(C,{references:e.references})}),e.false_positives&&e.false_positives.length>0&&a.push({title:o.a.createElement("span",{"data-test-subj":"falsePositivesPropertyTitle"},v.m),description:o.a.createElement(_,{falsePositives:e.false_positives})}),e.investigation_fields&&e.investigation_fields.field_names.length>0&&a.push({title:o.a.createElement("span",{"data-test-subj":"investigationFieldsPropertyTitle"},v.r),description:o.a.createElement(D,{investigationFields:e.investigation_fields.field_names})}),e.license&&a.push({title:o.a.createElement("span",{"data-test-subj":"licensePropertyTitle"},v.u),description:o.a.createElement(A,{license:e.license})}),e.rule_name_override&&a.push({title:o.a.createElement("span",{"data-test-subj":"ruleNameOverridePropertyTitle"},v.F),description:o.a.createElement(F,{ruleNameOverride:e.rule_name_override})}),e.threat&&e.threat.length>0&&a.push({title:o.a.createElement("span",{"data-test-subj":"threatPropertyTitle"},v.P),description:o.a.createElement(N,{threat:e.threat})}),"threat_indicator_path"in e&&e.threat_indicator_path&&a.push({title:v.S,description:o.a.createElement(P,{threatIndicatorPath:e.threat_indicator_path})}),e.timestamp_override&&a.push({title:o.a.createElement("span",{"data-test-subj":"timestampOverridePropertyTitle"},v.W),description:o.a.createElement(R,{timestampOverride:e.timestamp_override})}),e.max_signals&&a.push({title:o.a.createElement("span",{"data-test-subj":"maxSignalsPropertyTitle"},v.w),description:o.a.createElement(L,{maxSignals:e.max_signals})}),e.tags&&e.tags.length>0&&a.push({title:o.a.createElement("span",{"data-test-subj":"tagsPropertyTitle"},v.O),description:o.a.createElement(z,{tags:e.tags})}),a})(e,n,a);return o.a.createElement("div",null,o.a.createElement(u.EuiSpacer,{size:"m"}),o.a.createElement(u.EuiDescriptionList,i()({type:null!==(s=r.type)&&void 0!==s?s:"column",rowGutterSize:null!==(l=r.rowGutterSize)&&void 0!==l?l:"m",listItems:c,columnWidths:t,"data-test-subj":"listItemColumnStepRuleDescription"},r)))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(47),r=n(579),o=n(123),s=n(178);const l=({savedQueryId:e,ruleType:t,onError:n})=>{var l;const c=Object(r.a)(),{addError:u}=Object(o.a)(),d=Object(i.useQuery)(["detectionEngine","rule","savedQuery",e],(async()=>e&&"saved_query"===t?c.getSavedQuery(e):null),{onError:null!=n?n:e=>{u(e,{title:s.kd})},retry:!1,refetchOnWindowFocus:!1}),p=Object(a.useMemo)((()=>{var e;return d.data?{saved_id:d.data.id,filters:null!==(e=d.data.attributes.filters)&&void 0!==e?e:[],query:d.data.attributes.query,title:d.data.attributes.title}:null}),[d.data]);return{isSavedQueryLoading:!!e&&d.isLoading,savedQueryBar:p,savedQuery:null!==(l=d.data)&&void 0!==l?l:void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i={interval:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(165);const r=e=>({isSuppressionEnabled:Object(a.useCallback)((()=>!!e&&Object(i.h)(e)),[e])()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(566),c=n(303),u=n(408),d=n(368);const p=({interval:e})=>o.a.createElement(s.EuiText,{size:"s","data-test-subj":"intervalPropertyValue"},o.a.createElement(l.a,{interval:e})),m=({from:e,interval:t})=>o.a.createElement(s.EuiText,{size:"s","data-test-subj":`fromPropertyValue-${e}`},o.a.createElement(l.a,{interval:Object(c.f)(e,t)})),f=({rule:e,columnWidths:t=u.b,...n})=>{var a,r;if(!e.interval||!e.from)return null;const l=[];return l.push({title:o.a.createElement("span",{"data-test-subj":"intervalPropertyTitle"},d.q),description:o.a.createElement(p,{interval:e.interval})},{title:o.a.createElement("span",{"data-test-subj":"fromPropertyTitle"},d.n),description:o.a.createElement(m,{from:e.from,interval:e.interval})}),o.a.createElement("div",{"data-test-subj":"listItemColumnStepRuleDescription"},o.a.createElement(s.EuiDescriptionList,i()({type:null!==(a=n.type)&&void 0!==a?a:"column",rowGutterSize:null!==(r=n.rowGutterSize)&&void 0!==r?r:"m",listItems:l,columnWidths:t},n)))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return jt}));var a=n(19),i=n(2),r=n.n(i),o=n(45),s=n(41),l=n.n(s),c=n(121),u=n(124),d=n(13),p=n(129),m=n(158),f=n(44);const g={process:{hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTY5MjAtMTMyNDg5OTk2OTAuNDgzMzA3NzAw"],executable:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],name:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],pid:[6920],args:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1518)"],name:["Windows"],version:["1809 (10.0.17763.1518)"],platform:["windows"],family:["windows"],kernel:["1809 (10.0.17763.1518)"]},mac:["aa:bb:cc:dd:ee:ff"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"],name:["win2019-endpoint-1"]},file:{mtime:["2020-11-04T21:40:51.494Z"],path:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],owner:["sean"],hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},name:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],extension:["exe"],size:[1604112]},event:{category:["malware","intrusion_detection","process"],outcome:["success"],severity:[73],code:["malicious_file"],action:["execution"],id:["LsuMZVr+sdhvehVM++++Gp2Y"],kind:["alert"],created:["2020-11-04T21:41:30.533Z"],module:["endpoint"],type:["info","start","denied"],dataset:["endpoint.alerts"]},agent:{type:["endpoint"]},timestamp:"2020-11-04T21:41:30.533Z",message:["Malware Prevention Alert"],_id:"0dA2lXUBn9bLIbfPkY7d"};var b=n(231),y=n(230),h=n(171);const v=()=>{const e=Object(b.c)({eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:y.S});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:g,isDraggable:!1,scopeId:h.a}))},E=r.a.memo(v),x=[{_id:"1",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"event.kind",value:["signal"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3],kind:["signal"]},source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"3",data:[{field:"@timestamp",value:["2018-11-07T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["nginx"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["evan.davis"]}],ecs:{_id:"3",timestamp:"2018-11-07T19:03:25.937Z",host:{name:["nginx"],ip:["192.168.0.1"]},event:{id:["3"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[1]},source:{ip:["192.168.0.3"],port:[443]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["3"],name:["evan.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"4",data:[{field:"@timestamp",value:["2018-11-08T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Attempted Administrator Privilege Gain"]},{field:"host.name",value:["suricata"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jenny.jones"]}],ecs:{_id:"4",timestamp:"2018-11-08T19:03:25.937Z",host:{name:["suricata"],ip:["192.168.0.1"]},event:{id:["4"],category:["Attempted Administrator Privilege Gain"],type:["Alert"],module:["suricata"],severity:[1]},source:{ip:["192.168.0.3"],port:[53]},destination:{ip:["192.168.0.3"],port:[6343]},suricata:{eve:{flow_id:[4],proto:[""],alert:{signature:["ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174)"],signature_id:[4]}}},user:{id:["4"],name:["jenny.jones"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"5",data:[{field:"@timestamp",value:["2018-11-09T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["becky.davis"]}],ecs:{_id:"5",timestamp:"2018-11-09T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["5"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.3"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["5"],name:["becky.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"6",data:[{field:"@timestamp",value:["2018-11-10T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["braden.davis"]},{field:"source.ip",value:["192.168.0.6"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"6",timestamp:"2018-11-10T19:03:25.937Z",host:{name:["braden.davis"],ip:["192.168.0.1"]},event:{id:["6"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.6"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"8",data:[{field:"@timestamp",value:["2018-11-12T19:03:25.937Z"]},{field:"event.severity",value:["2"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"8",timestamp:"2018-11-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["8"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[2]},suricata:{eve:{flow_id:[8],proto:[""],alert:{signature:["ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie"],signature_id:[8]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["8"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"7",data:[{field:"@timestamp",value:["2018-11-11T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.7"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"7",timestamp:"2018-11-11T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["7"],category:["Access"],type:["HTTP Request"],module:["apache"],severity:[3]},source:{ip:["192.168.0.7"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["7"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"9",data:[{field:"@timestamp",value:["2018-11-13T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.9"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"9",timestamp:"2018-11-13T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["9"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.9"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["9"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"10",data:[{field:"@timestamp",value:["2018-11-14T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.10"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"10",timestamp:"2018-11-14T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["10"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.10"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["10"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"11",data:[{field:"@timestamp",value:["2018-11-15T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.11"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"11",timestamp:"2018-11-15T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["11"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.11"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["11"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"12",data:[{field:"@timestamp",value:["2018-11-16T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.12"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"12",timestamp:"2018-11-16T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["12"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.12"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["12"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"2",data:[{field:"@timestamp",value:["2018-11-06T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Authentication"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.2"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["joe.bob"]}],ecs:{_id:"2",timestamp:"2018-11-06T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["2"],category:["Authentication"],type:["Authentication Success"],module:["authlog"],severity:[3]},source:{ip:["192.168.0.2"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["joe.bob"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"13",data:[{field:"@timestamp",value:["2018-13-12T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"13",timestamp:"2018-12-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["13"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[1]},suricata:{eve:{flow_id:[13],proto:[""],alert:{signature:["ET WEB_SERVER Possible Attempt in HTTP Cookie"],signature_id:[13]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"14",data:[{field:"@timestamp",value:["2019-03-07T05:06:51.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.26.101"]},{field:"destination.ip",value:["192.168.238.205"]}],ecs:{_id:"14",timestamp:"2019-03-07T05:06:51.000Z",event:{module:["zeek"],dataset:["zeek.connection"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["185.176.26.101"],port:[44059]},destination:{ip:["207.154.238.205"],port:[11568]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["tcp"]},zeek:{session_id:["C8DRTq362Fios6hw16"],connection:{local_resp:[!1],local_orig:[!1],missed_bytes:[0],state:["REJ"],history:["Sr"]}}}},{_id:"15",data:[{field:"@timestamp",value:["2019-03-07T00:51:28.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.67.3"]}],ecs:{_id:"15",timestamp:"2019-03-07T00:51:28.000Z",event:{module:["zeek"],dataset:["zeek.dns"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[57475]},destination:{ip:["67.207.67.3"],port:[53]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["udp"]},zeek:{session_id:["CyIrMA1L1JtLqdIuol"],dns:{AA:[!1],RD:[!1],trans_id:[65252],RA:[!1],TC:[!1]}}}},{_id:"16",data:[{field:"@timestamp",value:["2019-03-05T07:00:20.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.164.26"]}],ecs:{_id:"16",timestamp:"2019-03-05T07:00:20.000Z",event:{module:["zeek"],dataset:["zeek.http"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[36220]},destination:{ip:["192.241.164.26"],port:[80]},geo:{region_name:["New York"],country_iso_code:["US"]},http:{version:["1.1"],request:{body:{bytes:[0]}},response:{status_code:[302],body:{bytes:[154]}}},zeek:{session_id:["CZLkpC22NquQJOpkwe"],http:{resp_mime_types:["text/html"],trans_depth:["3"],status_msg:["Moved Temporarily"],resp_fuids:["FzeujEPP7GTHmYPsc"],tags:[]}}}},{_id:"17",data:[{field:"@timestamp",value:["2019-02-28T22:36:28.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.77.171"]}],ecs:{_id:"17",timestamp:"2019-02-28T22:36:28.000Z",event:{module:["zeek"],dataset:["zeek.notice"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["8.42.77.171"]},zeek:{notice:{suppress_for:[3600],msg:["8.42.77.171 scanned at least 15 unique ports of host 207.154.238.205 in 0m0s"],note:["Scan::Port_Scan"],sub:["remote"],dst:["207.154.238.205"],dropped:[!1],peer_descr:["bro"]}}}},{_id:"18",data:[{field:"@timestamp",value:["2019-02-22T21:12:13.000Z"]},{field:"host.name",value:["zeek-sensor-amsterdam"]},{field:"source.ip",value:["192.168.66.184"]},{field:"destination.ip",value:["192.168.95.15"]}],ecs:{_id:"18",timestamp:"2019-02-22T21:12:13.000Z",event:{module:["zeek"],dataset:["zeek.ssl"]},host:{id:["2ce8b1e7d69e4a1d9c6bcddc473da9d9"],name:["zeek-sensor-amsterdam"]},source:{ip:["188.166.66.184"],port:[34514]},destination:{ip:["91.189.95.15"],port:[443]},geo:{region_name:["England"],country_iso_code:["GB"]},zeek:{session_id:["CmTxzt2OVXZLkGDaRe"],ssl:{cipher:["TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"],established:[!1],resumed:[!1],version:["TLSv12"]}}}},{_id:"19",data:[{field:"@timestamp",value:["2019-03-03T04:26:38.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]}],ecs:{_id:"19",timestamp:"2019-03-03T04:26:38.000Z",event:{module:["zeek"],dataset:["zeek.files"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},zeek:{session_id:["Cu0n232QMyvNtzb75j"],files:{session_ids:["Cu0n232QMyvNtzb75j"],timedout:[!1],local_orig:[!1],tx_host:["5.101.111.50"],source:["HTTP"],is_orig:[!1],overflow_bytes:[0],sha1:["fa5195a5dfacc9d1c68d43600f0e0262cad14dde"],duration:[0],depth:[0],analyzers:["MD5","SHA1"],mime_type:["text/plain"],rx_host:["206.189.35.240"],total_bytes:[88722],fuid:["FePz1uVEVCZ3I0FQi"],seen_bytes:[1198],missing_bytes:[0],md5:["f7653f1951693021daa9e6be61226e32"]}}}},{_id:"20",data:[{field:"@timestamp",value:["2019-03-13T05:42:11.815Z"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-sanfran"]},{field:"process.args",value:["gpgconf","--list-dirs","agent-socket"]}],ecs:{_id:"20",timestamp:"2019-03-13T05:42:11.815Z",event:{action:["executed"],module:["auditd"],category:["audit-rule"]},host:{id:["f896741c3b3b44bdb8e351a4ab6d2d7c"],name:["zeek-sanfran"],ip:["134.209.63.134","10.46.0.5","fe80::a0d9:16ff:fecf:e70b"]},user:{name:["alice"]},process:{pid:[5402],name:["gpgconf"],ppid:[5401],args:["gpgconf","--list-dirs","agent-socket"],executable:["/usr/bin/gpgconf"],title:["gpgconf --list-dirs agent-socket"],working_directory:["/"]}}},{_id:"21",data:[{field:"@timestamp",value:["2019-03-14T22:30:25.527Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"source.ip",value:["192.168.77.171"]},{field:"user.name",value:["root"]}],ecs:{_id:"21",timestamp:"2019-03-14T22:30:25.527Z",event:{action:["logged-in"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["14"],data:{terminal:["/dev/pts/0"],op:["login"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["/dev/pts/0"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["8.42.77.171"]},user:{name:["root"]},process:{pid:[17471],executable:["/usr/sbin/sshd"]}}},{_id:"22",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"22",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["disposed-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:setcred"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"23",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"23",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["ended-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:session_close"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"24",data:[{field:"@timestamp",value:["2019-03-18T23:17:01.645Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"24",timestamp:"2019-03-18T23:17:01.645Z",event:{action:["acquired-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["unset"],data:{acct:["root"],terminal:["cron"],op:["PAM:setcred"]},summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[9592],executable:["/usr/sbin/cron"]}}},{_id:"25",data:[{field:"@timestamp",value:["2019-03-19T01:17:01.336Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["siem-kibana"]},{field:"user.name",value:["root"]}],ecs:{_id:"25",timestamp:"2019-03-19T01:17:01.336Z",event:{action:["started-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["2908"],data:{acct:["root"],terminal:["cron"],op:["PAM:session_open"]},summary:{actor:{primary:["root"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["aa7ca589f1b8220002f2fc61c64cfbf1"],name:["siem-kibana"]},user:{name:["root"]},process:{pid:[725],executable:["/usr/sbin/cron"]}}},{_id:"26",data:[{field:"@timestamp",value:["2019-03-13T03:34:08.890Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["alice"]}],ecs:{_id:"26",timestamp:"2019-03-13T03:34:08.890Z",event:{action:["was-authorized"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["338"],data:{terminal:["/dev/pts/0"]},summary:{actor:{primary:["root"],secondary:["alice"]},object:{primary:["/dev/pts/0"],type:["user-session"]},how:["/sbin/pam_tally2"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["alice"]},process:{pid:[21170],executable:["/sbin/pam_tally2"]}}},{_id:"27",data:[{field:"@timestamp",value:["2019-03-22T19:13:11.026Z"]},{field:"event.action",value:["connected-to"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"destination.ip",value:["192.168.216.34"]},{field:"user.name",value:["alice"]}],ecs:{_id:"27",timestamp:"2019-03-22T19:13:11.026Z",event:{action:["connected-to"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["246"],summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["192.168.216.34"],secondary:["80"],type:["socket"]},how:["/usr/bin/wget"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},destination:{ip:["192.168.216.34"],port:[80]},user:{name:["alice"]},process:{pid:[1490],name:["wget"],ppid:[1476],executable:["/usr/bin/wget"],title:["wget www.example.com"]}}},{_id:"28",data:[{field:"@timestamp",value:["2019-03-26T22:12:18.609Z"]},{field:"event.action",value:["opened-file"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"28",timestamp:"2019-03-26T22:12:18.609Z",event:{action:["opened-file"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["242"],summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["/proc/15990/attr/current"],type:["file"]},how:["/lib/systemd/systemd-journald"]}},file:{path:["/proc/15990/attr/current"],device:["00:00"],inode:["27672309"],uid:["0"],owner:["root"],gid:["0"],group:["root"],mode:["0666"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[27244],name:["systemd-journal"],ppid:[1],executable:["/lib/systemd/systemd-journald"],title:["/lib/systemd/systemd-journald"],working_directory:["/"]}}},{_id:"29",data:[{field:"@timestamp",value:["2019-04-08T21:18:57.000Z"]},{field:"event.action",value:["user_login"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Braden"]}],ecs:{_id:"29",event:{action:["user_login"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Braden"]},process:{pid:[6278]}}},{_id:"30",data:[{field:"@timestamp",value:["2019-04-08T22:27:14.814Z"]},{field:"event.action",value:["process_started"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Evan"]}],ecs:{_id:"30",event:{action:["process_started"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Evan"]},process:{pid:[6278]}}},{_id:"31",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"message",value:["I am a log file message"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3]},message:["I am a log file message"],source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"32",data:[],ecs:{_id:"BuBP4W0BOpWiDweSoYSg",timestamp:"2019-10-18T23:59:15.091Z",threat:{enrichments:[{indicator:{provider:["indicator_provider"],reference:["https://example.com"]},matched:{atomic:["192.168.1.1"],field:["source.ip"],type:["ip"]},feed:{name:["feed_name"]}}]}}}];var j=n(626),S=n(316);const O=()=>{const e=Object(j.b)({actionName:"connected-to",text:S.T});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:x[26].ecs,isDraggable:!1,scopeId:h.a}))},k=r.a.memo(O),w=()=>{const e=Object(j.c)({actionName:"opened-file",text:`${S.Db} ${S.kc}`});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:x[27].ecs,isDraggable:!1,scopeId:h.a}))},T=r.a.memo(w),I={file:{path:["C:\\Windows\\System32\\bcrypt.dll"],hash:{md5:["00439016776de367bad087d739a03797"],sha1:["2c4ba5c1482987d50a182bad915f52cd6611ee63"],sha256:["e70f5d8f87aab14e3160227d38387889befbe37fa4f8f5adc59eff52804b35fd"]},name:["bcrypt.dll"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["library"],kind:["event"],created:["2021-02-05T21:27:23.921Z"],module:["endpoint"],action:["load"],type:["start"],id:["LzzWB9jjGmCwGMvk++++Da5H"],dataset:["endpoint.events.library"]},process:{name:["sshd.exe"],pid:[9644],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTk2NDQtMTMyNTcwMzQwNDEuNzgyMTczODAw"],executable:["C:\\Program Files\\OpenSSH-Win64\\sshd.exe"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint DLL load event"],timestamp:"2021-02-05T21:27:23.921Z",_id:"IAUYdHcBGrBB52F2zo8Q"},M=()=>{const e=Object(b.d)({actionName:"load",text:y.q});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:I,isDraggable:!1,scopeId:h.a}))},C=r.a.memo(M);var _=n(1368),D=n(837);const A=()=>r.a.createElement(r.a.Fragment,null,D.a.renderRow({data:{destination:{bytes:[40],geo:{city_name:["New York"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["New York"]},ip:["10.1.2.3"],packets:[1],port:[80]},event:{action:["network_flow"],category:["network_traffic"],duration:[_.a],end:["2018-11-12T19:03:25.936Z"],start:["2018-11-12T19:03:25.836Z"]},_id:"abcd",network:{bytes:[100],community_id:["we.live.in.a"],direction:["outgoing"],packets:[3],protocol:["http"],transport:["tcp"]},process:{name:["rat"]},source:{bytes:[60],geo:{city_name:["Atlanta"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["Georgia"]},ip:["192.168.1.2"],packets:[2],port:[9987]},timestamp:"2018-11-12T19:03:25.936Z",tls:{client_certificate:{fingerprint:{sha1:["tls.client_certificate.fingerprint.sha1-value"]}},fingerprints:{ja3:{hash:["tls.fingerprints.ja3.hash-value"]}},server_certificate:{fingerprint:{sha1:["tls.server_certificate.fingerprint.sha1-value"]}}},user:{name:["first.last"]}},isDraggable:!1,scopeId:h.a})),F=r.a.memo(A),N={host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["registry"],kind:["event"],created:["2021-02-04T13:44:31.559Z"],module:["endpoint"],action:["modification"],type:["change"],id:["LzzWB9jjGmCwGMvk++++CbOn"],dataset:["endpoint.events.registry"]},process:{name:["GoogleUpdate.exe"],pid:[7408],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTc0MDgtMTMyNTY5MTk4NDguODY4NTI0ODAw"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},registry:{hive:["HKLM"],key:["SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState"],path:["HKLM\\SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState\\StateValue"],value:["StateValue"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint registry event"],timestamp:"2021-02-04T13:44:31.559Z",_id:"4cxLbXcBGrBB52F2uOfF"},P=()=>{const e=Object(b.e)({actionName:"modification",text:y.u});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:N,isDraggable:!1,scopeId:h.a}))},R=r.a.memo(P);var L=n(863);const z=()=>r.a.createElement(r.a.Fragment,null,L.a.renderRow({data:x[2].ecs,isDraggable:!1,scopeId:h.a})),q=r.a.memo(z),B={_id:"2MjPcG0BOpWiDweSoutC",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["termination_event"],category:["process"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["bd4401441a21bf1abce6404f4231db4d"],sha1:["797255e72d5ed5c058d4785950eba7abaa057653"],sha256:["87976f3430cc99bc939e0694247c0759961a49832b87218f4313d6fc0bc3a776"]},pid:[442384],ppid:[8],name:["RuntimeBroker.exe"],executable:["C:\\Windows\\System32\\RuntimeBroker.exe"]},endgame:{pid:[442384],process_name:["RuntimeBroker.exe"],exit_code:[0]}},$=()=>{const e=Object(b.h)({actionName:"termination_event",text:y.H});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:B,isDraggable:!1,scopeId:h.a}))},V=r.a.memo($),U={_id:"S8jPcG0BOpWiDweSou3g",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["request_event"],category:["network"],kind:["event"]},message:["DNS query is completed for the name %1, type %2, query options %3 with status %4 Results %5 "],timestamp:"1569555712000",dns:{question:{name:["update.googleapis.com"],type:["A"]},resolved_ip:["10.100.197.67"]},network:{protocol:["dns"]},process:{pid:[443192],name:["GoogleUpdate.exe"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},winlog:{event_id:[3008]},endgame:{process_name:["GoogleUpdate.exe"],pid:[443192]}},G=()=>{const e=Object(b.a)();return r.a.createElement(r.a.Fragment,null,e.renderRow({data:U,isDraggable:!1,scopeId:h.a}))},H=r.a.memo(G),W={_id:"BcjPcG0BOpWiDweSou3g",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["creation_event"],category:["process"],type:["process_start"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["62d06d7235b37895b68de56687895743"],sha1:["12563599116157778a22600d2a163d8112aed845"],sha256:["d4c97ed46046893141652e2ec0056a698f6445109949d7fcabbce331146889ee"]},pid:[441684],ppid:[8],name:["Microsoft.Photos.exe"],executable:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe"],args:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe","-ServerName:App.AppXzst44mncqdg84v7sv6p7yznqwssy6f7f.mca"]},endgame:{process_name:["Microsoft.Photos.exe"],pid:[441684],parent_process_name:["svchost.exe"]}},Q=()=>{const e=Object(b.b)({actionName:"creation_event",text:y.A});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:W,isDraggable:!1,scopeId:h.a}))},Y=r.a.memo(Q),K={_id:"98jPcG0BOpWiDweSouzg",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["file_create_event"],category:["file"],kind:["event"]},timestamp:"1569555712000",endgame:{process_name:["chrome.exe"],pid:[11620],file_path:["C:\\Users\\Arun\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\63d78c21-e593-4484-b7a9-db33cd522ddc.tmp"]}},J={_id:"OMjPcG0BOpWiDweSeuW9",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["file_delete_event"],category:["file"],kind:["event"]},timestamp:"1569555704000",endgame:{pid:[1084],file_name:["tmp000002f6"],file_path:["C:\\Windows\\TEMP\\tmp00000404\\tmp000002f6"],process_name:["AmSvc.exe"]}},Z=()=>{const e=Object(b.g)({actionName:"file_delete_event",text:y.f});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:J,isDraggable:!1,scopeId:h.a}))},X=r.a.memo(Z),ee=()=>{const e=Object(b.f)({actionName:"file_create_event",text:y.e});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:K,isDraggable:!1,scopeId:h.a}))},te=r.a.memo(ee),ne={_id:"QsjPcG0BOpWiDweSeuRE",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["user_logon"],category:["authentication"],type:["authentication_success"],kind:["event"]},message:["An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tWIN-Q3DOP1UKA81$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3e7\r\n\r\nLogon Type:\t\t\t5\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3e7\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x1b0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."],timestamp:"1569555704000",process:{pid:[432],name:["C:\\Windows\\System32\\services.exe"],executable:["C:\\Windows\\System32\\services.exe"]},winlog:{event_id:[4624]},endgame:{target_logon_id:["0x3e7"],pid:[432],process_name:["C:\\Windows\\System32\\services.exe"],logon_type:[5],subject_user_name:["WIN-Q3DOP1UKA81$"],subject_logon_id:["0x3e7"],target_user_name:["SYSTEM"],target_domain_name:["NT AUTHORITY"]}},ae=()=>{const e=Object(b.i)({actionName:"user_logon"});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:ne,isDraggable:!1,scopeId:h.a}))},ie=r.a.memo(ae),re={_id:"LsjPcG0BOpWiDweSCNfu",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.43.255.177"],name:["HD-gqf-0af7b4fe"]},event:{module:["endgame"],dataset:["esensor"],action:["ipv4_connection_accept_event"],category:["network"],kind:["event"]},timestamp:"1569555676000",network:{community_id:["1:network-community_id"],transport:["tcp"]},process:{pid:[1084],name:["AmSvc.exe"],executable:["C:\\Program Files\\Cybereason ActiveProbe\\AmSvc.exe"]},source:{ip:["127.0.0.1"],port:[49306]},destination:{port:[49305],ip:["127.0.0.1"]},endgame:{pid:[1084]}},oe=()=>{const e=Object(b.j)({actionName:"ipv4_connection_accept_event",text:y.b});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:re,isDraggable:!1,scopeId:h.a}))},se=r.a.memo(oe);var le=n(861);const ce=()=>r.a.createElement(r.a.Fragment,null,le.a.renderRow({data:x[31].ecs,isDraggable:!1,scopeId:h.a})),ue=r.a.memo(ce);var de=n(865);const pe=()=>r.a.createElement(r.a.Fragment,null,de.a.renderRow({data:x[13].ecs,isDraggable:!1,scopeId:h.a})),me=r.a.memo(pe);var fe=n(4);const ge=fe.i18n.translate("xpack.securitySolution.eventRenderers.alertName",{defaultMessage:"Alert"}),be=fe.i18n.translate("xpack.securitySolution.eventRenderers.alertsName",{defaultMessage:"Alerts"}),ye=fe.i18n.translate("xpack.securitySolution.eventRenderers.alertsDescription",{defaultMessage:"Alerts are displayed when malware or ransomware is prevented and detected"}),he=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdName",{defaultMessage:"Auditd"}),ve=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdDescriptionPart1",{defaultMessage:"audit events convey security-relevant logs from the Linux Audit Framework."}),Ee=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileName",{defaultMessage:"Auditd File"}),xe=fe.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),je=fe.i18n.translate("xpack.securitySolution.eventRenderers.authenticationName",{defaultMessage:"Authentication"}),Se=fe.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart1",{defaultMessage:"Authentication events show users (and system accounts) successfully or unsuccessfully logging into hosts."}),Oe=fe.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart2",{defaultMessage:"Some authentication events may include additional details when users authenticate on behalf of other users."}),ke=fe.i18n.translate("xpack.securitySolution.eventRenderers.dnsName",{defaultMessage:"Domain Name System (DNS)"}),we=fe.i18n.translate("xpack.securitySolution.eventRenderers.dnsDescriptionPart1",{defaultMessage:"Domain Name System (DNS) events show users (and system accounts) making requests via specific processes to translate from host names to IP addresses."}),Te=fe.i18n.translate("xpack.securitySolution.eventRenderers.fileName",{defaultMessage:"File"}),Ie=fe.i18n.translate("xpack.securitySolution.eventRenderers.fileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),Me=fe.i18n.translate("xpack.securitySolution.eventRenderers.fimName",{defaultMessage:"File Integrity Module (FIM)"}),Ce=fe.i18n.translate("xpack.securitySolution.eventRenderers.fimDescriptionPart1",{defaultMessage:"File Integrity Module (FIM) events show users (and system accounts) performing CRUD operations on files via specific processes."}),_e=fe.i18n.translate("xpack.securitySolution.eventRenderers.flowName",{defaultMessage:"Flow"}),De=fe.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart1",{defaultMessage:"The Flow renderer visualizes the flow of data between a source and destination. It's applicable to many types of events."}),Ae=fe.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart2",{defaultMessage:"The hosts, ports, protocol, direction, duration, amount transferred, process, geographic location, and other details are visualized when available."}),Fe=fe.i18n.translate("xpack.securitySolution.eventRenderers.libraryName",{defaultMessage:"Library"}),Ne=fe.i18n.translate("xpack.securitySolution.eventRenderers.libraryDescription",{defaultMessage:"Library events display a Dynamically Linked Library (DLL) being loaded by a process"}),Pe=fe.i18n.translate("xpack.securitySolution.eventRenderers.processName",{defaultMessage:"Process"}),Re=fe.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart1",{defaultMessage:"Process events show users (and system accounts) starting and stopping processes."}),Le=fe.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart2",{defaultMessage:"Details including the command line arguments, parent process, and if applicable, file hashes are displayed when available."}),ze=fe.i18n.translate("xpack.securitySolution.eventRenderers.registryName",{defaultMessage:"Registry"}),qe=fe.i18n.translate("xpack.securitySolution.eventRenderers.registryDescription",{defaultMessage:"Registry events show updates to the Windows Registry"}),Be=fe.i18n.translate("xpack.securitySolution.eventRenderers.socketName",{defaultMessage:"Socket (Network)"}),$e=fe.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart1",{defaultMessage:"Socket (Network) events show processes listening, accepting, and closing connections."}),Ve=fe.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart2",{defaultMessage:"Details including the protocol, ports, and a community ID for correlating all network events related to a single flow are displayed when available."}),Ue=fe.i18n.translate("xpack.securitySolution.eventRenderers.suricataName",{defaultMessage:"Suricata"}),Ge=fe.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart1",{defaultMessage:"Summarizes"}),He=fe.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart2",{defaultMessage:"intrusion detection (IDS), inline intrusion prevention (IPS), and network security monitoring (NSM) events"}),We=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemName",{defaultMessage:"System"}),Qe=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart1",{defaultMessage:"The Auditbeat"}),Ye=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart2",{defaultMessage:"module collects various security related information about a system."}),Ke=fe.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart3",{defaultMessage:"All datasets send both periodic state information (e.g. all currently running processes) and real-time changes (e.g. when a new process starts or stops)."}),Je=fe.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchName",{defaultMessage:"Threat Indicator Match"}),Ze=fe.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchDescription",{defaultMessage:"Summarizes events that matched threat indicators"}),Xe=fe.i18n.translate("xpack.securitySolution.eventRenderers.zeekName",{defaultMessage:"Zeek (formerly Bro)"}),et=fe.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart1",{defaultMessage:"Summarizes events from the"}),tt=fe.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart2",{defaultMessage:"Network Security Monitoring (NSM) tool"}),nt={[c.e.alert]:ge,[c.e.alerts]:be,[c.e.auditd]:he,[c.e.auditd_file]:Ee,[c.e.library]:Fe,[c.e.system_security_event]:je,[c.e.system_dns]:ke,[c.e.netflow]:_e,[c.e.system]:We,[c.e.system_endgame_process]:Pe,[c.e.registry]:ze,[c.e.system_fim]:Me,[c.e.system_file]:Te,[c.e.system_socket]:Be,[c.e.suricata]:"Suricata",[c.e.threat_match]:Je,[c.e.zeek]:Xe,[c.e.plain]:""},at=({children:e,url:t})=>r.a.createElement(a.EuiLink,{href:t,target:"_blank",rel:"noopener nofollow noreferrer","data-test-subj":"externalLink"},e),it=[{id:c.e.alerts,name:nt[c.e.alerts],description:ye,example:E,searchableDescription:ye},{id:c.e.auditd,name:nt[c.e.auditd],description:r.a.createElement("span",null,r.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},he)," ",ve),example:k,searchableDescription:`${he} ${ve}`},{id:c.e.auditd_file,name:nt[c.e.auditd_file],description:r.a.createElement("span",null,r.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},he)," ",xe),example:T,searchableDescription:`${Ee} ${xe}`},{id:c.e.library,name:nt[c.e.library],description:Ne,example:C,searchableDescription:Ne},{id:c.e.system_security_event,name:nt[c.e.system_security_event],description:r.a.createElement("div",null,r.a.createElement("p",null,Se),r.a.createElement("br",null),r.a.createElement("p",null,Oe)),example:ie,searchableDescription:`${Se} ${Oe}`},{id:c.e.system_dns,name:nt[c.e.system_dns],description:we,example:H,searchableDescription:we},{id:c.e.netflow,name:nt[c.e.netflow],description:r.a.createElement("div",null,r.a.createElement("p",null,De),r.a.createElement("br",null),r.a.createElement("p",null,Ae)),example:F,searchableDescription:`${De} ${Ae}`},{id:c.e.system,name:nt[c.e.system],description:r.a.createElement("div",null,r.a.createElement("p",null,Qe," ",r.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-system.html"},We)," ",Ye),r.a.createElement("br",null),r.a.createElement("p",null,Ke)),example:V,searchableDescription:`${Qe} ${We} ${Ye} ${Ke}`},{id:c.e.system_endgame_process,name:nt[c.e.system_endgame_process],description:r.a.createElement("div",null,r.a.createElement("p",null,Re),r.a.createElement("br",null),r.a.createElement("p",null,Le)),example:Y,searchableDescription:`${Re} ${Le}`},{id:c.e.registry,name:nt[c.e.registry],description:qe,example:R,searchableDescription:qe},{id:c.e.system_fim,name:nt[c.e.system_fim],description:Ce,example:te,searchableDescription:Ce},{id:c.e.system_file,name:nt[c.e.system_file],description:Ie,example:X,searchableDescription:Ie},{id:c.e.system_socket,name:nt[c.e.system_socket],description:r.a.createElement("div",null,r.a.createElement("p",null,$e),r.a.createElement("br",null),r.a.createElement("p",null,Ve)),example:se,searchableDescription:`${$e} ${Ve}`},{id:c.e.suricata,name:nt[c.e.suricata],description:r.a.createElement("p",null,Ge," ",r.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-suricata.html"},Ue)," ",He),example:q,searchableDescription:`${Ge} ${Ue} ${He}`},{id:c.e.threat_match,name:nt[c.e.threat_match],description:Ze,example:ue,searchableDescription:`${Je} ${Ze}`},{id:c.e.zeek,name:nt[c.e.zeek],description:r.a.createElement("p",null,et," ",r.a.createElement(at,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-zeek.html"},Xe)," ",tt),example:me,searchableDescription:`${et} ${Xe} ${tt}`}],rt=l()(a.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-ietqpj-0"})([".euiTable{tr:has(.isNotSelected){background-color:",";}tr > *:last-child{display:none;}.euiTableHeaderCellCheckbox > .euiTableCellContent{display:none;}}"],(e=>e.theme.eui.euiColorLightestShade)),ot=l()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-ietqpj-1"})(["overflow:auto;> div{padding:0;> div{margin:0;}}"]),st=e=>{if(e)return r.a.createElement(ot,{grow:1},r.a.createElement(e,null))},lt={box:{incremental:!0,schema:!0}},ct=()=>r.a.createElement(r.a.Fragment,null),ut={sort:{field:"name",direction:"asc"}},dt=l.a.button.withConfig({displayName:"StyledNameButton",componentId:"sc-ietqpj-2"})(["text-align:left;"]),pt=({excludedRowRendererIds:e=[],setExcludedRowRendererIds:t})=>{const n=Object(i.useCallback)((n=>()=>{const a=Object(f.xor)([n.id],e);t(a)}),[e,t]),o=Object(i.useCallback)(((e,t)=>r.a.createElement(dt,{className:"kbn-resetFocusState",onClick:n(t)},e)),[n]),s=Object(i.useCallback)(((t,i)=>r.a.createElement(a.EuiCheckbox,{id:i.id,onChange:n(i),className:e.includes(i.id)?"isNotSelected":"isSelected",checked:!e.includes(i.id)})),[e,n]),l=Object(i.useMemo)((()=>[{field:"id",name:"",sortable:!1,width:"32px",render:s,"data-test-subj":"renderer-checkbox"},{field:"name",name:"Name",sortable:!0,width:"10%",render:o,"data-test-subj":"renderer-name"},{field:"description",name:"Description",width:"25%",render:e=>e,"data-test-subj":"renderer-description"},{field:"example",name:"Example",width:"65%",render:st,"data-test-subj":"renderer-example"},{field:"searchableDescription",name:"Searchable Description",sortable:!1,width:"0px",render:ct,"data-test-subj":"renderer-searchable-description"}]),[s,o]);return r.a.createElement(rt,{items:it,itemId:"id",columns:l,search:lt,sorting:ut})};pt.displayName="RowRenderersBrowserComponent";const mt=r.a.memo(pt);mt.displayName="RowRenderersBrowser";const ft=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.eventRenderersTitle",{defaultMessage:"Event renderers"}),gt=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersTitle",{defaultMessage:"Customize event renderers"}),bt=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersDescription",{defaultMessage:"Event renderers automatically convey the most relevant details in an event to reveal its story"}),yt=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.enableAllRenderersButtonLabel",{defaultMessage:"Enable all"}),ht=fe.i18n.translate("xpack.securitySolution.customizeEventRenderers.disableAllRenderersButtonLabel",{defaultMessage:"Disable all"}),vt=l()(a.EuiModal).withConfig({displayName:"StyledEuiModal",componentId:"sc-m3n5c2-0"})([""," max-width:95vw;min-height:90vh;> .euiModal__flex{max-height:90vh;}"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`)),Et=l()(a.EuiModalBody).withConfig({displayName:"StyledEuiModalBody",componentId:"sc-m3n5c2-1"})([".euiModalBody__overflow{display:flex;align-items:stretch;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;> div:first-child{flex:0;}.euiBasicTable{flex:1;overflow:auto;}}}"]),xt=({timelineId:e})=>{const t=Object(o.useDispatch)(),n=Object(i.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),s=Object(u.a)((t=>{var a;return(null!==(a=n(t,e))&&void 0!==a?a:m.b).excludedRowRendererIds})),[l,f]=Object(i.useState)(!1),g=Object(i.useCallback)((n=>t(Object(d.setExcludedRowRendererIds)({id:e,excludedRowRendererIds:n}))),[t,e]),b=Object(i.useCallback)((()=>f(!l)),[l]),y=Object(i.useCallback)((()=>f(!1)),[]),h=Object(i.useCallback)((()=>{g(Object.values(c.e))}),[g]),v=Object(i.useCallback)((()=>{g([])}),[g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiToolTip,{content:gt},r.a.createElement(a.EuiButtonIcon,{"aria-label":gt,"data-test-subj":"show-row-renderers-gear",iconType:"gear",onClick:b},ft)),l&&r.a.createElement(vt,{onClose:y,"data-test-subj":"row-renderers-modal"},r.a.createElement(a.EuiModalHeader,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",direction:"row",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiModalHeaderTitle,null,gt),r.a.createElement(a.EuiText,{size:"s"},bt)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,null,r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonEmpty,{size:"s","data-test-subj":"disable-all",onClick:h},ht)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButton,{fill:!0,size:"s","data-test-subj":"enable-all",onClick:v},yt)))))),r.a.createElement(Et,null,r.a.createElement(mt,{excludedRowRendererIds:s,setExcludedRowRendererIds:g}))))},jt=r.a.memo(xt)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return st})),n.d(t,"d",(function(){return ut})),n.d(t,"f",(function(){return Be})),n.d(t,"e",(function(){return pt})),n.d(t,"g",(function(){return Xe})),n.d(t,"h",(function(){return vt})),n.d(t,"j",(function(){return at})),n.d(t,"c",(function(){return Et})),n.d(t,"i",(function(){return Ot}));var a=n(2),i=n.n(a),r=n(19),o=n(4),s=n(56),l=n(5),c=n(596),u=n(221);const d=Object(a.memo)((({handleRefresh:e,http:t,handleCloseFlyout:n,addSuccess:d,addError:p})=>{const{navigateToApp:m}=Object(s.useKibana)().services.application,{start:f,...g}=Object(c.a)(),b=Object(a.useRef)(new AbortController);let y=function(e){return e.name="name",e.description="description",e}({});const[h,v]=Object(a.useState)({name:"",description:""}),E=({target:e},t)=>{const{value:n}=e;v({...h,[t]:n})};Object(a.useEffect)((()=>{null!=g.result&&m(l.m,{deepLinkId:l.Oc.exceptions,path:`/details/${g.result.list_id}`})}),[g,m]);const x=Object(a.useCallback)((()=>{var e;g.loading||""===h.name||(b.current=new AbortController,f({http:t,signal:b.current.signal,name:h.name,description:null!==(e=h.description)&&void 0!==e?e:""}))}),[g.loading,h.name,h.description,f,t]),j=Object(a.useCallback)((t=>{d({text:Object(u.pb)(h.name),title:u.jb}),e(),n()}),[d,n,e,h]),S=Object(a.useCallback)((e=>{var t;e.message.includes("AbortError")||null!=e&&null!==(t=e.body)&&void 0!==t&&t.message.includes("AbortError")||p(e,{title:o.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListErrorTitle",{defaultMessage:"creation error"})})}),[p]);Object(a.useEffect)((()=>{g.loading||(null!=g&&g.result?j(g.result):null!=g&&g.error&&S(null==g?void 0:g.error))}),[null==g?void 0:g.error,g.loading,g.result,S,j]);const O=Object(r.useGeneratedHtmlId)({prefix:"createSharedExceptionListFlyout"});return i.a.createElement(r.EuiFlyout,{ownFocus:!0,size:"s",onClose:n,"data-test-subj":"createSharedExceptionListFlyout","aria-labelledby":O},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",{id:O,"data-test-subj":"createSharedExceptionListTitle"},u.h))),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(r.EuiText,null,u.f),i.a.createElement(r.EuiFieldText,{placeholder:u.g,value:h.name,onChange:e=>E(e,y.name),"aria-label":"Shared exception list name","data-test-subj":"createSharedExceptionListNameInput"}),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiText,null,u.d),i.a.createElement(r.EuiTextArea,{placeholder:u.e,value:h.description,onChange:e=>E(e,y.description),"aria-label":"Shared exception list description","data-test-subj":"createSharedExceptionListDescriptionInput"})),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:n,flush:"left"},u.a)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":"exception-lists-form-create-shared",onClick:x,disabled:""===h.name},u.c)))))}));d.displayName="CreateSharedListFlyout";var p=n(152),m=n(1334),f=n(778),g=n(41),b=n.n(g),y=n(49),h=n(788),v=n(546);const E=b()(r.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-19zoulh-0"})(["border-right:1px solid #d3dae6;padding:"," "," "," 0;"],y.euiThemeVars.euiSizeXS,y.euiThemeVars.euiSizeS,y.euiThemeVars.euiSizeXS),x=b()(r.EuiText).withConfig({displayName:"TextContainer",componentId:"sc-19zoulh-1"})(["width:max-content;"]),j=Object(a.memo)((({title:e,badgeString:t})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(x,{grow:!0,size:"xs"},`${e}:`)),i.a.createElement(E,null,i.a.createElement(r.EuiBadge,null,t)))));j.displayName="TitleBadge";var S=n(43),O=n(1562);const k=Object(a.memo)((({item:e,actions:t,disableActions:n=!1,dataTestSubj:a})=>Object(S.jsx)(r.EuiFlexGroup,{responsive:!0,"data-test-subj":a,justifyContent:"spaceBetween"},Object(S.jsx)(r.EuiFlexItem,{grow:9},Object(S.jsx)(r.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${a}Title`},Object(S.jsx)("h3",null,e.name))),Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(f.a,{iconType:"boxesHorizontal",disableActions:n,actions:t,"aria-label":"Exception item actions menu",dataTestSubj:a,anchorPosition:"downCenter"})))));k.displayName="ExceptionItemCardHeader";const w=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.editItemButton",{values:{listType:e},defaultMessage:"Edit {listType} exception"}),T=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.deleteItemButton",{values:{listType:e},defaultMessage:"Delete {listType} exception"}),I=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.createdLabel",{defaultMessage:"Created"}),M=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.updatedLabel",{defaultMessage:"Updated"}),C=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiresLabel",{defaultMessage:"Expires at"}),_=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiredLabel",{defaultMessage:"Expired at"}),D=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.metaDetailsBy",{defaultMessage:"by"}),A=e=>o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),F=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator",{defaultMessage:"IS"}),N=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),P=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),R=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),L=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.nestedOperator",{defaultMessage:"has"}),z=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator",{defaultMessage:"is one of"}),q=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),B=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator",{defaultMessage:"exists"}),$=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator.not",{defaultMessage:"does not exist"}),V=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator",{defaultMessage:"included in"}),U=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator.not",{defaultMessage:"is not included in"}),G=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.and",{defaultMessage:"AND"}),H=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.os",{defaultMessage:"OS"}),W=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.windows",{defaultMessage:"Windows"}),Q=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.linux",{defaultMessage:"Linux"}),Y=o.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.macos",{defaultMessage:"Mac"}),K=Object(S.css)("font-family:",y.euiThemeVars.euiFontFamily,";",""),J=Object(a.memo)((({label:e,lastUpdate:t,lastUpdateValue:n,dataTestSubj:a})=>Object(S.jsx)(r.EuiFlexGroup,{"data-test-subj":`${a||""}metaInfoDetails`,alignItems:"center",gutterSize:"s",wrap:!0,responsive:!0},Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(r.EuiText,{size:"xs",css:K},e)),Object(S.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":`${a||""}lastUpdate`},Object(S.jsx)(r.EuiBadge,{color:"default",css:K},t)),null!=n&&Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(r.EuiText,{size:"xs",css:K},D)),Object(S.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":`${a||""}lastUpdateValue`},Object(S.jsx)(r.EuiFlexGroup,{responsive:!0,gutterSize:"xs",alignItems:"center"},Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(r.EuiBadge,{color:"hollow",css:K},n))))))));J.displayName="MetaInfoDetails";var Z=n(1257);const X=Object(S.css)("border-right:1px solid #d3dae6;padding:",y.euiThemeVars.euiSizeS," ",y.euiThemeVars.euiSizeM," ",y.euiThemeVars.euiSizeS," 0;",""),ee=Object(a.memo)((({item:e,rules:t,dataTestSubj:n,securityLinkAnchorComponent:s,formattedDateComponent:l})=>{const c=l,u=Object(a.useMemo)((()=>Object(Z.a)({dataTestSubj:n,linkedRules:t,securityLinkAnchorComponent:s})),[n,t,s]),d=Object(a.useMemo)((()=>!!e.expire_time&&new Date(e.expire_time)<=new Date),[e]);return Object(S.jsx)(r.EuiFlexGroup,{alignItems:"center",responsive:!0,gutterSize:"s","data-test-subj":n},null!==c&&Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(r.EuiFlexItem,{css:X,grow:!1},Object(S.jsx)(J,{label:I,lastUpdate:Object(S.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentCreatedBy",fieldName:"created_at",value:e.created_at}),lastUpdateValue:e.created_by,dataTestSubj:`${n||""}CreatedBy`})),Object(S.jsx)(r.EuiFlexItem,{css:X,grow:!1},Object(S.jsx)(J,{label:M,lastUpdate:Object(S.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentUpdatedBy",fieldName:"updated_at",value:e.updated_at}),lastUpdateValue:e.updated_by,dataTestSubj:`${n||""}UpdatedBy`})),null!=e.expire_time&&Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(r.EuiFlexItem,{css:X,grow:!1},Object(S.jsx)(J,{label:d?_:C,lastUpdate:Object(S.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentExpireTime",fieldName:"expire_time",value:e.expire_time}),dataTestSubj:`${n||""}ExpireTime`})))),Object(S.jsx)(r.EuiFlexItem,null,Object(S.jsx)(f.a,{emptyButton:!0,useCustomActions:!0,iconType:"list",actions:u,disableActions:!1,text:(p=t.length,o.i18n.translate("exceptionList-components.exceptions.card.exceptionItem.affectedRules",{values:{numRules:p},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"})),dataTestSubj:n})));var p}));ee.displayName="ExceptionItemCardMetaInfo";const te=Object(S.css)("margin-left:",y.euiThemeVars.euiSizeXL,";margin-bottom:",y.euiThemeVars.euiSizeXS,";padding-top:",y.euiThemeVars.euiSizeXS,";",""),ne=Object(p.cx)("eui-xScroll","\n  border: 1px;\n  border-color: #d3dae6;\n  border-style: solid;\n"),ae=Object(S.css)("display:flex;align-items:center;margin-left:",y.euiThemeVars.euiSizeS,";",""),ie={name:"s5xdrg",styles:"display:flex;align-items:center"};var re=n(1471),oe=n(1231);const se=Object(p.css)("display:inline;margin-left:",y.euiThemeVars.euiSizeXS,";",""),le=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:n})=>{const{showSpaceWarningIcon:a,warningText:i}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(re.a):Object(re.a)(e)),warningText:t||oe.k.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:n});return a&&e?Object(S.jsx)("div",{className:se},Object(S.jsx)(r.EuiToolTip,{position:"top",content:i},Object(S.jsx)(r.EuiIcon,{"data-test-subj":"valueWithSpaceWarningTooltip",type:t,color:"warning"}))):null};var ce=n(403);const ue=Object.freeze({linux:Q,mac:Y,macos:Y,windows:W}),de=Object.freeze({[ce.b.NESTED]:L,[ce.b.MATCH_ANY]:z,[ce.b.MATCH]:F,[ce.b.WILDCARD]:P,[ce.b.EXISTS]:B,[ce.b.LIST]:V}),pe=Object.freeze({[ce.b.MATCH_ANY]:q,[ce.b.MATCH]:N,[ce.b.WILDCARD]:R,[ce.b.EXISTS]:$,[ce.b.LIST]:U}),me=Object(p.css)({name:"1089mxj",styles:"white-space:pre-wrap"}),fe=({children:e})=>Object(S.jsx)("span",{className:me},e),ge=(e,t,n)=>{var a;const i=n;return"match_any"===e&&Array.isArray(t)?t.map(((e,t)=>Object(S.jsx)(r.EuiBadge,{key:t,"data-test-subj":`matchAnyBadge${t}`,color:"hollow"},Object(S.jsx)(fe,null,e)))):"list"===e&&t?Object(S.jsx)(i,{shouldShowContentIfModalNotAvailable:!0,listId:t.toString()},t):null!==(a=Object(S.jsx)(fe,null,t))&&void 0!==a?a:""},be=(e,t)=>{var n,a;return"nested"===e?"":"included"===t?null!==(n=de[e])&&void 0!==n?n:e:null!==(a=pe[e])&&void 0!==a?a:e},ye=(e,t,n,a)=>Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(r.EuiExpression,{description:be(e,t),value:ge(e,n,a),"data-test-subj":"entryValueExpression"}),Object(S.jsx)(le,{value:n})),he=Object(a.memo)((({entry:e,index:t,isNestedEntry:n=!1,dataTestSubj:a,showValueListModal:o})=>{const{field:s,type:l}=e,c=(e=>"list"===e.type?e.list.id:"value"in e?e.value:"")(e),u="operator"in e?e.operator:"",d=`${s}${l}${c}${t}`;return Object(S.jsx)("div",{"data-test-subj":`${a||""}${d}EntryContent`,key:d},Object(S.jsx)("div",{css:ie},n?Object(S.jsx)(r.EuiFlexGroup,{responsive:!0,css:te,direction:"row",alignItems:"center",gutterSize:"m","data-test-subj":`${a||""}NestedEntry`},Object(S.jsx)(r.EuiToken,{"data-test-subj":"nstedEntryIcon",iconType:"tokenNested",size:"s"}),Object(S.jsx)("div",{css:ae},Object(S.jsx)(r.EuiExpression,{description:"",value:s,color:"subdued"}),ye(l,u,c,o))):Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(r.EuiExpression,{description:0===t?"":G,value:s,color:0===t?"primary":"subdued","data-test-subj":`${a||""}SingleEntry`}),ye(l,u,c,o))))}));he.displayName="EntryContent";const ve=Object(a.memo)((({os:e,dataTestSubj:t})=>{const n=Object(a.useMemo)((()=>e.map((e=>{var t;return null!==(t=ue[e])&&void 0!==t?t:e})).join(", ")),[e]);return n?Object(S.jsx)("div",{"data-test-subj":`${t||""}Os`},Object(S.jsx)("strong",null,Object(S.jsx)(r.EuiExpression,{"data-test-subj":"osLabel",description:"",value:H}),Object(S.jsx)(r.EuiExpression,{"data-test-subj":"osValue",description:F,value:n}))):null}));ve.displayName="OsCondition";const Ee=Object(a.memo)((({os:e,entries:t,dataTestSubj:n,showValueListModal:a})=>Object(S.jsx)(r.EuiPanel,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":n,className:ne},null!=e&&e.length?Object(S.jsx)(ve,{os:e,dataTestSubj:n}):null,t.map(((e,t)=>{const i="entries"in e?e.entries:[];return Object(S.jsx)("div",{key:`ExceptionItemCardConditionsContainer${t}`},Object(S.jsx)(he,{key:`entry${t}`,entry:e,index:t,dataTestSubj:n,showValueListModal:a}),null!=i&&i.length?i.map(((e,i)=>Object(S.jsx)(he,{key:`nestedEntry${t}${i}`,entry:e,index:i,isNestedEntry:!0,dataTestSubj:n,showValueListModal:a}))):null)})))));Ee.displayName="ExceptionItemCardConditions";const xe=Object(S.css)("color:",y.euiThemeVars.euiColorPrimary,";",""),je=Object(a.memo)((({comments:e,dataTestSubj:t})=>e.length?Object(S.jsx)(r.EuiFlexItem,{"data-test-subj":t},Object(S.jsx)(r.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:Object(S.jsx)(r.EuiText,{size:"s",css:xe,"data-test-subj":`${t||""}TextButton`},A(e.length)),arrowDisplay:"none","data-test-subj":"exceptionItemCardComments"},Object(S.jsx)(r.EuiPanel,{"data-test-subj":"accordionContentPanel",hasBorder:!0,hasShadow:!0,paddingSize:"m"},Object(S.jsx)(r.EuiCommentList,{"data-test-subj":"accordionCommentList",comments:e})))):null));je.displayName="ExceptionItemCardComments";const Se=({disableActions:e=!1,exceptionItem:t,listType:n,ruleReferences:i,dataTestSubj:o,editActionLabel:s,deleteActionLabel:l,securityLinkAnchorComponent:c,formattedDateComponent:u,getFormattedComments:d,onDeleteException:p,onEditException:m,showValueListModal:f})=>{const{actions:g,formattedComments:b}=(({listType:e,editActionLabel:t,deleteActionLabel:n,exceptionItem:i,getFormattedComments:r,onEditException:o,onDeleteException:s})=>{const l=Object(a.useCallback)((()=>{s({id:i.id,name:i.name,namespaceType:i.namespace_type})}),[s,i.id,i.name,i.namespace_type]),c=Object(a.useCallback)((()=>{o(i)}),[o,i]),u=Object(a.useMemo)((()=>r(i.comments)),[i.comments,r]);return{actions:Object(a.useMemo)((()=>[{key:"edit",icon:"controlsHorizontal",label:t||w(e),onClick:c},{key:"delete",icon:"trash",label:n||T(e),onClick:l}]),[t,e,n,l,c]),formattedComments:u}})({listType:n,editActionLabel:s,deleteActionLabel:l,exceptionItem:t,getFormattedComments:d,onEditException:m,onDeleteException:p});return Object(S.jsx)(r.EuiPanel,{key:`${t.id}exceptionItemPanel`,paddingSize:"l","data-test-subj":o||"",hasBorder:!0,hasShadow:!1},Object(S.jsx)(r.EuiFlexGroup,{responsive:!0,gutterSize:"m",direction:"column"},Object(S.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardHeaderContainer"},Object(S.jsx)(k,{item:t,actions:g,disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),Object(S.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardMeta"},Object(S.jsx)(ee,{item:t,rules:i,dataTestSubj:"exceptionItemCardMetaInfo",securityLinkAnchorComponent:c,formattedDateComponent:u})),Object(S.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardCondition"},Object(S.jsx)(Ee,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions",showValueListModal:f})),b.length>0&&Object(S.jsx)(je,{dataTestSubj:"exceptionsItemCommentAccordion",comments:b})))};Se.displayName="ExceptionItemCardComponent";const Oe=i.a.memo(Se);Oe.displayName="ExceptionItemCard";const ke=({dataTestSubj:e,ariaLabel:t,pagination:n,onPaginationChange:i})=>{const{pageIndex:o,pageCount:s,pageSize:l,pageSizeOptions:c,handleItemsPerPageChange:u,handlePageIndexChange:d}=(({pagination:e,onPaginationChange:t})=>{const{pageIndex:n,totalItemCount:i,pageSize:r,pageSizeOptions:o}=e,s=Object(a.useMemo)((()=>isFinite(i/r)?Math.ceil(i/r):0),[r,i]),l=Object(a.useCallback)((e=>{t({pagination:{pageIndex:n,pageSize:e,totalItemCount:i}})}),[n,i,t]),c=Object(a.useCallback)((e=>{t({pagination:{pageIndex:e,pageSize:r,totalItemCount:i}})}),[r,i,t]);return{pageCount:s,pageIndex:n,pageSize:r,pageSizeOptions:o,handleItemsPerPageChange:l,handlePageIndexChange:c}})({pagination:n,onPaginationChange:i});return Object(S.jsx)(r.EuiTablePagination,{"data-test-subj":e,"aria-label":t,pageCount:s,activePage:o,itemsPerPage:l,onChangePage:d,onChangeItemsPerPage:u,itemsPerPageOptions:c})};ke.displayName="PaginationComponent";const we=i.a.memo(ke);we.displayName="Pagination";const Te=Object(S.css)("margin:",y.euiThemeVars.euiSize," 0;&div:first-child{margin:",y.euiThemeVars.euiSizeXS," 0 ",y.euiThemeVars.euiSize,";}",""),Ie=({lastUpdated:e,viewerStatus:t,isReadOnly:n,exceptions:a,listType:o,ruleReferences:s,emptyViewerTitle:l,emptyViewerBody:c,emptyViewerButtonText:u,pagination:d,dataTestSubj:p,editActionLabel:m,deleteActionLabel:f,securityLinkAnchorComponent:g,exceptionsUtilityComponent:b,formattedDateComponent:y,getFormattedComments:h,onPaginationChange:v,onDeleteException:E,onEditExceptionItem:x,onCreateExceptionListItem:j,showValueListModal:k})=>{const w=b;if(!a.length||t)return Object(S.jsx)(O.a,{isReadOnly:n,title:l,viewerStatus:t,buttonText:u,body:c,onEmptyButtonStateClick:j});const T=k;return Object(S.jsx)(i.a.Fragment,null,Object(S.jsx)(w,{pagination:d,lastUpdated:e}),Object(S.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none",className:"eui-yScrollWithShadows"},Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(r.EuiFlexGroup,{css:Te,"data-test-subj":`${p||""}exceptionsContainer`,direction:"column",gutterSize:"s"},a.map((e=>Object(S.jsx)(r.EuiFlexItem,{"data-test-subj":`${p||""}exceptionItemContainer`,grow:!1,key:e.id},Object(S.jsx)(Oe,{key:`${e.id}exceptionItemCardKey`,dataTestSubj:`${p||""}exceptionItemCard`,disableActions:n,exceptionItem:e,listType:o,ruleReferences:Object.keys(s).length&&s[e.list_id]?s[e.list_id].referenced_rules:[],editActionLabel:m,deleteActionLabel:f,onDeleteException:E,onEditException:x,securityLinkAnchorComponent:g,formattedDateComponent:y,getFormattedComments:h,showValueListModal:T}))))))),Object(S.jsx)(we,{dataTestSubj:`${p||""}pagination`,pagination:d,onPaginationChange:v}))};Ie.displayName="ExceptionItemsComponent";const Me=i.a.memo(Ie);Me.displayName="ExceptionsItems";var Ce=n(151),_e=n(54),De=n.n(_e);const Ae=o.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),Fe=(o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"}));o.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),o.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),o.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),o.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"});var Ne=n(873);const Pe=e=>e.map((e=>({username:e.created_by,timestamp:De()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:Ae,timelineAvatar:i.a.createElement(r.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:i.a.createElement(r.EuiText,{size:"s"},e.comment),actions:i.a.createElement(Ne.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:Fe})})));var Re=n(144),Le=n(668),ze=n(258);const qe=({referenceName:e,referenceId:t,external:n,dataTestSubj:a})=>i.a.createElement(Re.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=a?a:""}`,deepLinkId:l.Oc.rules,path:Object(ze.c)(t,Le.b.alerts),target:n?"_blank":void 0},e);qe.displayName="LinkToRuleDetailsComponent";const Be=i.a.memo(qe);Be.displayName="LinkToRuleDetails";var $e=n(42),Ve=n(362);const Ue=b.a.span.withConfig({displayName:"StyledText",componentId:"sc-1q48q07-0"})(["font-weight:bold;color:",";"],(({theme:e})=>e.eui.euiColorDarkestShade)),Ge=b()(r.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-1q48q07-1"})(["height:50px;"]),He=b.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-1q48q07-2"})(["display:inline-block !important;vertical-align:middle !important;line-height:1;"]),We=({dataTestSubj:e,pagination:t,lastUpdated:n,exceptionsTitle:a})=>{const{pageSize:o,totalItemCount:s}=t;return i.a.createElement(Ge,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(Ve.a,null,i.a.createElement(Ve.d,null,i.a.createElement(Ve.c,null,i.a.createElement(Ve.e,{dataTestSubj:`${e}ShowingText`},i.a.createElement($e.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:i.a.createElement(Ue,null,`1-${Math.min(o,s)}`),partTwo:i.a.createElement(Ue,null,`${s}`)}})),a&&i.a.createElement(Ue,{"data-test-subj":`${e}exceptionsTitle`},a))))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s","data-test-subj":`${e}LastUpdated`},i.a.createElement($e.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:i.a.createElement(He,null,i.a.createElement(Ce.b,{value:n,tooltipAnchorClassName:"eui-textTruncate"}))}}))))};We.displayName="ExceptionsUtilityComponent";const Qe=i.a.memo(We);Qe.displayName="ExceptionsUtility";var Ye=n(597),Ke=n(540),Je=n(547);const Ze=({isReadOnly:e,exceptions:t,listType:n,lastUpdated:r,pagination:o,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,viewerStatus:u,ruleReferences:d,hideUtility:p=!1,onDeleteException:f,onEditExceptionItem:g,onPaginationChange:b,onCreateExceptionListItem:y})=>{const h=Object(Ke.a)("crudEndpointExceptions"),v=Object(a.useMemo)((()=>n===m.a.ENDPOINT?Ye.c:Ye.d),[n]),E=Object(a.useMemo)((()=>n===m.a.ENDPOINT?Ye.a:Ye.b),[n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Me,{viewerStatus:u,listType:n,ruleReferences:d,isReadOnly:e||!h,exceptions:t,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,pagination:o,lastUpdated:r,editActionLabel:v,deleteActionLabel:E,onPaginationChange:b,onEditExceptionItem:g,onDeleteException:f,getFormattedComments:Pe,securityLinkAnchorComponent:Be,formattedDateComponent:Ce.a,onCreateExceptionListItem:y,exceptionsUtilityComponent:()=>p?null:i.a.createElement(Qe,{exceptionsTitle:Ye.e,pagination:o,lastUpdated:r}),showValueListModal:Je.a}))};Ze.displayName="ListExceptionItemsComponent";const Xe=i.a.memo(Ze);Xe.displayName="ListExceptionItems";var et=n(795),tt=n(598),nt=n(868);const at=Object(a.memo)((({linkedRules:e,showButtonLoader:t,saveIsDisabled:n=!0,onSave:a,onCancel:o,onRuleSelectionChange:s})=>{const l=Object(r.useGeneratedHtmlId)({prefix:"complicatedFlyoutTitle"});return i.a.createElement(r.EuiFlyout,{hideCloseButton:!0,ownFocus:!0,onClose:o,"aria-labelledby":l},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",{id:l},u.W)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiText,{size:"s",color:"subdued"},u.Z)),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(nt.a,{initiallySelectedRules:e,onRuleSelectionChange:s})),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{onClick:o,flush:"left"},u.Y)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":"manageListRulesSaveButton",isLoading:t,disabled:n,onClick:a,fill:!0},u.ab)))))}));at.displayName="ManageRules";var it=n(780);const rt=b()(r.EuiPanel).withConfig({displayName:"ExceptionPanel",componentId:"sc-11ogn3z-0"})(["margin:-"," "," 0 ",";"],y.euiThemeVars.euiSizeS,y.euiThemeVars.euiSizeM,y.euiThemeVars.euiSizeM),ot=b()(r.EuiFlexGroup).withConfig({displayName:"ListHeaderContainer",componentId:"sc-11ogn3z-1"})(["padding:",";text-align:initial;"],y.euiThemeVars.euiSizeS),st=Object(a.memo)((({exceptionsList:e,handleDelete:t,handleExport:n,handleDuplicate:o,readOnly:s})=>{const{linkedRules:l,showManageRulesFlyout:c,showManageButtonLoader:d,disableManageButton:g,onManageRules:b,onSaveManageRules:y,onCancelManageRules:E,onRuleSelectionChange:x}=Object(et.a)(e.list_id),{euiTheme:S}=Object(r.useEuiTheme)(),O=Object(r.useEuiShadow)(),k=Object(a.useMemo)((()=>p.css`
        .euiAccordion__buttonContent {
          flex: 1 1 auto;
          cursor: pointer;
        }
        .euiAccordion__triggerWrapper {
          z-index: 100;
          position: relative;
          border-radius: ${S.border.radius.medium};
          padding: ${S.size.base};
          ${O}
        }
      `),[S.border.radius.medium,S.size.base,O]),{listId:w,listName:T,listType:I,createdAt:M,createdBy:C,exceptions:_,pagination:D,ruleReferences:A,toggleAccordion:F,openAccordionId:N,menuActionItems:P,listDescription:R,exceptionItemsCount:L,onEditExceptionItem:z,onDeleteException:q,onPaginationChange:B,setToggleAccordion:$,exceptionViewerStatus:V,showAddExceptionFlyout:U,showEditExceptionFlyout:G,exceptionToEdit:H,onAddExceptionClick:W,handleConfirmExceptionFlyout:Q,handleCancelExceptionItemFlyout:Y,goToExceptionDetail:K,emptyViewerTitle:J,emptyViewerBody:Z,emptyViewerButtonText:X,handleCancelExpiredExceptionsModal:ee,handleConfirmExpiredExceptionsModal:te,showIncludeExpiredExceptionsModal:ne}=Object(tt.a)({exceptionsList:e,handleExport:n,handleDelete:t,handleDuplicate:o,handleManageRules:b});return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiAccordion,{className:k,id:N,buttonElement:"div",onToggle:()=>$(!F),buttonContent:i.a.createElement(ot,{gutterSize:"m",alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiFlexGroup,{direction:"column",key:w,alignItems:"flexStart",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!0},i.a.createElement(r.EuiText,{size:"m"},i.a.createElement(r.EuiLink,{"data-test-subj":"exception-list-name",onClick:K},T))),i.a.createElement(r.EuiFlexItem,{grow:!0},i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement(r.EuiTextColor,{color:"subdued"},R))))),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",wrap:!0,responsive:!0},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(j,{title:u.i,badgeString:M})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(j,{title:u.b,badgeString:C})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(j,{title:u.l,badgeString:L})),i.a.createElement(r.EuiFlexItem,{"data-test-subj":"exceptionListCardLinkedRulesBadge",grow:!1},i.a.createElement(j,{title:u.gb,badgeString:l.length.toString()})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(f.a,{disableActions:s,dataTestSubj:"sharedListOverflowCard",actions:P}))),"data-test-subj":`exceptionsManagementListCard-${w}`},i.a.createElement(rt,{hasBorder:!0},i.a.createElement(Xe,{isReadOnly:s,exceptions:_,listType:e.type,pagination:D,hideUtility:!0,viewerStatus:V,ruleReferences:A,onDeleteException:q,onEditExceptionItem:z,onPaginationChange:B,onCreateExceptionListItem:W,lastUpdated:null,emptyViewerTitle:J,emptyViewerBody:Z,emptyViewerButtonText:X}))),U?i.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:I===m.a.ENDPOINT,sharedListToAddTo:[e],onCancel:Y,onConfirm:Q,"data-test-subj":"addExceptionItemFlyoutInSharedLists",showAlertCloseOptions:!1}):null,G&&H?i.a.createElement(h.a,{list:e,itemToEdit:H,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:Y,onConfirm:Q,"data-test-subj":"editExceptionItemFlyoutInSharedLists"}):null,c?i.a.createElement(at,{linkedRules:l,showButtonLoader:d,saveIsDisabled:g,onSave:y,onCancel:E,onRuleSelectionChange:x}):null,ne?i.a.createElement(it.b,{handleCloseModal:ee,onModalConfirm:te,action:ne}):null)}));st.displayName="ExceptionsListCard";var lt=n(168),ct=n(600);const ut=i.a.memo((({handleRefresh:e,http:t,addSuccess:n,addError:o,setDisplayImportListFlyout:s})=>{var l;const c=Object(a.useRef)(null),d=Object(r.useGeneratedHtmlId)({prefix:"filePicker"}),[p,m]=Object(a.useState)(null),[f,g]=Object(a.useState)(!1),[b,y]=Object(a.useState)(!1),[h,v]=Object(a.useState)(!1),[E,x]=Object(a.useState)(!1),j=Object(a.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),m(null),v(!1),x(!1),y(!1),g(!1)}),[]),{start:S,...O}=Object(ct.a)(),k=Object(a.useRef)(new AbortController),w=Object(a.useCallback)((()=>{!O.loading&&p&&(k.current=new AbortController,Array.from(p).forEach((e=>S({file:e,http:t,signal:k.current.signal,overwrite:f,overwriteExceptions:f,asNewList:b}))))}),[b,p,t,S,O.loading,f]),T=Object(a.useCallback)((t=>{j(),n({title:u.mb}),e()}),[j,n,e]),I=Object(a.useCallback)((e=>{e.forEach((e=>{e.error.message.includes("AbortError")||o(e.error.message,{title:u.lb})}))}),[o]);Object(a.useEffect)((()=>{var e;if(!O.loading)if(null!=O&&null!==(e=O.result)&&void 0!==e&&e.success)T(null==O?void 0:O.result);else{var t,n;const e=[];var a,i;null!=O&&null!==(t=O.error)&&void 0!==t&&t.body&&e.push({error:{...null==O||null===(a=O.error)||void 0===a?void 0:a.body}}),null!=O&&null!==(n=O.result)&&void 0!==n&&n.errors&&(null==O||null===(i=O.result)||void 0===i||i.errors.forEach((t=>{t.error.message.includes("already exists")&&(v(!0),t.error.message.includes(`Found that list_id: "${lt.k}" already exists`)&&x(!0)),e.push(t)}))),I(e)}}),[I,T,null==O?void 0:O.error,O.loading,null==O?void 0:O.result,null==O||null===(l=O.result)||void 0===l?void 0:l.errors]);const M=Object(a.useCallback)((e=>{m(null!=e?e:null)}),[]),C=Object(r.useGeneratedHtmlId)({prefix:"importExceptionListFlyoutTitle"});return i.a.createElement(r.EuiFlyout,{ownFocus:!0,size:"s",onClose:()=>s(!1),"aria-labelledby":C},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",{id:C},u.S))),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(r.EuiText,null,u.R),i.a.createElement(r.EuiFilePicker,{id:d,multiple:!0,ref:c,initialPromptText:u.V,onChange:M,display:"large","aria-label":"Use aria labels when no actual label is in use"}),h&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiTextColor,{color:"danger"},u.U),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiCheckbox,{id:"basicCheckboxId",label:u.T,checked:f,"data-test-subj":"importExceptionListOverwriteExistingCheckbox",onChange:e=>{g(!f),y(!1)}}),i.a.createElement(r.EuiToolTip,{position:"bottom",content:E?u.P:""},i.a.createElement(r.EuiCheckbox,{id:"createNewListCheckbox",label:u.Q,"data-test-subj":"importExceptionListCreateNewCheckbox",checked:b,disabled:E,onChange:e=>{y(!b),g(!1)}})))),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{"data-test-subj":"exceptionListsImportFormCloseBTN",iconType:"cross",onClick:()=>s(!1),flush:"left"},u.a)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":"exception-lists-form-import-action",onClick:w,disabled:null==p||O.loading},u.kb)))))})),dt=({linkTitle:e,listId:t,external:n,dataTestSubj:a})=>i.a.createElement(Re.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=a?a:""}`,deepLinkId:l.Oc.exceptions,path:`/details/${t}`,target:n?"_blank":void 0},e);dt.displayName="LinkToListDetailsComponent";const pt=i.a.memo(dt);pt.displayName="LinkToListDetails";var mt=n(1314);const ft={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},gt=({addExceptionButtonText:e,placeholdertext:t,canAddException:n,listType:i,isSearching:o,dataTestSubj:s,filters:l=[],isButtonFilled:c=!0,buttonIconType:u,onSearch:d,onAddExceptionClick:p})=>{const m=Object(a.useCallback)((({queryText:e})=>{d({search:e})}),[d]),f=Object(a.useCallback)((()=>{p(i)}),[p,i]);return Object(S.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(S.jsx)(r.EuiFlexItem,{grow:!0},Object(S.jsx)(r.EuiSearchBar,{box:{placeholder:t,incremental:!1,schema:ft,"data-test-subj":`${s||""}searchBar`},filters:l,onChange:m})),!n&&Object(S.jsx)(r.EuiFlexItem,{grow:!1},Object(S.jsx)(r.EuiButton,{"data-test-subj":`${s||""}Button`,onClick:f,isDisabled:o,fill:c,iconType:u},e)))};gt.displayName="SearchBarComponent";const bt=i.a.memo(gt);bt.displayName="SearchBar";var yt=n(601);const ht=({list:e,isReadOnly:t,refreshExceptions:n})=>{const{listName:a,exceptions:o,listType:s,lastUpdated:l,pagination:c,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:f,viewerStatus:g,ruleReferences:b,showAddExceptionFlyout:y,showEditExceptionFlyout:E,exceptionToEdit:x,exceptionViewerStatus:j,onSearch:S,onAddExceptionClick:k,onDeleteException:w,onEditExceptionItem:T,onPaginationChange:I,handleCancelExceptionItemFlyout:M,handleConfirmExceptionFlyout:C}=Object(yt.a)(e,n);return i.a.createElement(i.a.Fragment,null,y?i.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:s===m.a.ENDPOINT,sharedListToAddTo:[e],onCancel:M,onConfirm:C,"data-test-subj":"addExceptionItemFlyoutInList",showAlertCloseOptions:!1}):g===mt.a.EMPTY||g===mt.a.LOADING?i.a.createElement(O.a,{isReadOnly:t,viewerStatus:g,onEmptyButtonStateClick:k,title:u.B,body:u.y(a),buttonText:u.z}):i.a.createElement(r.EuiPanel,{hasBorder:!1,hasShadow:!1},i.a.createElement(i.a.Fragment,null,E&&x&&i.a.createElement(h.a,{list:e,itemToEdit:x,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:M,onConfirm:C,"data-test-subj":"editExceptionItemFlyoutInList"}),i.a.createElement(bt,{addExceptionButtonText:s===m.a.ENDPOINT?u.x:u.w,listType:s,onSearch:S,onAddExceptionClick:k,isSearching:g===mt.a.SEARCHING,isButtonFilled:!1,buttonIconType:"plusInCircle"}),i.a.createElement(Xe,{viewerStatus:j,listType:s,ruleReferences:b,isReadOnly:t,exceptions:o,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:f,pagination:c,lastUpdated:l,onPaginationChange:I,onEditExceptionItem:T,onDeleteException:w,onCreateExceptionListItem:k}))))};ht.displayName="ListWithSearchComponent";const vt=i.a.memo(ht);vt.displayName="ListWithSearch";const Et=({onRefresh:e,totalExceptionLists:t,setSort:n,sort:a,sortFields:o})=>{var s;const l=null==o?void 0:o.find((e=>e.field===(null==a?void 0:a.field)));return i.a.createElement(Ve.a,{border:!0},i.a.createElement(Ve.d,null,i.a.createElement(Ve.c,null,i.a.createElement(Ve.e,{dataTestSubj:"showingExceptionLists"},u.hb(t))),i.a.createElement(Ve.c,null,i.a.createElement(Ve.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:e},u.fb))),i.a.createElement(Ve.d,null,i.a.createElement(i.a.Fragment,null,i.a.createElement(Ve.c,null,a&&i.a.createElement(Ve.b,{dataTestSubj:"sortExceptions",iconSide:"right",iconType:"asc"===a.order?"sortUp":"sortDown",popoverPanelPaddingSize:"s",popoverContent:()=>i.a.createElement(r.EuiContextMenuPanel,{size:"s",items:null==o?void 0:o.map((e=>{const t=(null==l?void 0:l.field)===e.field;let o=e.defaultOrder;return t&&(o="asc"===a.order?"desc":"asc"),i.a.createElement(r.EuiContextMenuItem,{key:e.field,onClick:()=>null==n?void 0:n({field:e.field,order:o})},i.a.createElement(xt,null,e.label," ",(null==l?void 0:l.field)===e.field&&i.a.createElement(jt,{type:"asc"===a.order?"sortUp":"sortDown"})))}))})},i.a.createElement(xt,null,u.ib," ",null==o||null===(s=o.find((e=>e.field===a.field)))||void 0===s?void 0:s.label))))))},xt=b()("div").withConfig({displayName:"SortMenuItem",componentId:"sc-1h5b7pp-0"})(["display:flex;align-items:center;"]),jt=b()(r.EuiIcon).withConfig({displayName:"SortIcon",componentId:"sc-1h5b7pp-1"})(["margin-left:8px;"]);Et.displayName="ExceptionsTableUtilityBar";const St={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},Ot=i.a.memo((({onSearch:e})=>i.a.createElement(r.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":u.m,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:u.D,incremental:!1,schema:St}})));Ot.displayName="ListsSearchBar"},function(e,t,n){"use strict";n.d(t,"c",(function(){return he})),n.d(t,"b",(function(){return ve})),n.d(t,"a",(function(){return xe}));var a=n(2),i=n.n(a),r=n(45),o=n(58),s=n(122),l=n(905),c=n(118),u=n(5),d=n(124),p=n(146),m=n(129),f=n(13),g=n(747),b=n(243),y=n(42),h=n(41),v=n.n(h),E=n(121),x=n(957),j=n(362),S=n(292),O=n(140),k=n(19),w=n(163),T=n(48),I=n(123),M=n(816);const C=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:i}=Object(T.useParams)(),{addSuccess:r}=Object(I.a)(),o=Object(a.useCallback)((t=>{null!=e&&e(),r({title:i===E.m.template?w.T(t):w.S(t),"data-test-subj":"addObjectToContainerSuccess"})}),[r,e,i]),s=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(S.c)({ids:n});e instanceof Blob?(Object(M.a)(e,`${w.n}.ndjson`),o(n.length)):s()}})()}),[n,t]),null};C.displayName="ExportTimeline";const _=i.a.memo(C);var D=n(44);const A=i.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:r}=Object(T.useParams)(),o=r===E.m.template?w.j:w.k,s=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(D.isEmpty)(t)?w.Z:t;return i.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return i.a.createElement(k.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:w.b,confirmButtonText:w.h,defaultFocusedButton:k.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:s()},i.a.createElement("div",{"data-test-subj":"warning"},o))}));A.displayName="DeleteTimelineModal";const F=Object(h.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),N=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:r,onComplete:o,savedSearchIds:s})=>{const{addSuccess:l}=Object(I.a)(),{tabName:c}=Object(T.useParams)(),u=Object(a.useCallback)((()=>{null!=o&&o()}),[o]),d=Object(a.useCallback)((()=>{n.length>0&&null!=s&&s.length>0?(e(n,s),l({title:c===E.m.template?w.R(n.length):w.Q(n.length)})):n.length>0&&(e(n),l({title:c===E.m.template?w.R(n.length):w.Q(n.length)})),null!=o&&o()}),[e,n,o,l,c,s]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(F,{"data-test-subj":"remove-popover"}),t?i.a.createElement(k.EuiModal,{maxWidth:600,onClose:u},i.a.createElement(A,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:r,closeModal:u})):null)}));N.displayName="DeleteTimelineModalOverlay";const P=({deleteTimelines:e,ids:t,savedSearchIds:n,isEnableDownloader:a,isDeleteTimelineModalOpen:r,onComplete:o,title:s})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:o}),null!=e&&i.a.createElement(N,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:r,onComplete:o,savedObjectIds:t,savedSearchIds:n,title:s})),R=i.a.memo(P),L=()=>{const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)(!1),[r,o]=Object(a.useState)(!1),s=Object(a.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(a.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((e=>{o(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((()=>{o(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{i(!1),o(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:s,onOpenDeleteTimelineModal:l,isEnableDownloader:r,enableExportTimelineDownloader:c,disableExportTimelineDownloader:u}},z=v.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));z.displayName="SearchRowContainer";const q=v()(k.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));q.displayName="SearchRowFlexGroup";const B=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:r,children:o,timelineType:s})=>{const l=Object(a.useMemo)((()=>({placeholder:s===E.m.default?w.K:w.L,incremental:!1,"data-test-subj":"search-bar"})),[s]);return i.a.createElement(z,null,i.a.createElement(q,{gutterSize:"s"},i.a.createElement(k.EuiFlexItem,null,i.a.createElement(k.EuiSearchBar,{box:l,onChange:n})),i.a.createElement(k.EuiFlexItem,{grow:!1},i.a.createElement(k.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(k.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:r,numFilters:null!=e?e:void 0},w.D),!!o&&o)))))}));B.displayName="SearchRow",n(43);const $=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:i,onCreateRule:r,onCreateRuleFromEql:o,hasCrudAccess:s})=>[{width:s?"80px":"150px",actions:[{name:w.g,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:E.m.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:w.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===E.m.template&&e.includes("createFrom")},{name:w.f,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:E.m.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:w.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==E.m.template&&e.includes("createFrom")},{name:w.E,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:w.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==E.m.template&&e.includes("duplicate")},{name:w.F,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:w.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===E.m.template&&e.includes("duplicate")},{name:w.o,icon:"exportAction",type:"icon",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==E.l.immutable,description:w.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:w.i,icon:"trash",type:"icon",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==E.l.immutable,description:w.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:w.d,icon:"indexEdit",type:"icon",onClick:e=>{null!=r&&e.savedObjectId&&r(e.savedObjectId)},enabled:e=>null!=r&&null!=e.savedObjectId&&e.status!==E.l.immutable,description:w.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=r&&null!=t&&t.hasQuery},{name:w.e,icon:"indexEdit",type:"icon",onClick:e=>{null!=o&&e.savedObjectId&&o(e.savedObjectId)},enabled:e=>null!=o&&null!=e.savedObjectId&&e.status!==E.l.immutable,description:w.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=o&&null!=t&&t.hasEql}]}],V="45px";var U=n(184),G=n(742),H=n(130),W=n(151),Q=n(149);const Y=v.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),K=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{dataType:"auto",isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?i.a.createElement(k.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(D.omit)(a,e)):n({...e,[a]:i.a.createElement(G.a,{notes:t,timelineId:Q.f.active})}),"aria-label":e[a]?w.c:w.m,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:V},{dataType:"string",field:"title",name:a===E.m.default?w.X:w.Y,render:(e,n)=>null!=n.savedObjectId?i.a.createElement(k.EuiLink,{"data-test-subj":`timeline-title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(U.e)(n)?w.Z:i.a.createElement(Y,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(U.e)(n)?w.Z:e),sortable:!1},{dataType:"string",field:"description",name:w.l,render:e=>i.a.createElement(Y,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(H.d)()),sortable:!1},{dataType:"date",field:"updated",name:w.y,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement(W.b,{value:e}):Object(H.d)()),sortable:!0}],J=e=>e?[{dataType:"string",field:"updatedBy",name:w.B,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(H.a)(e)),sortable:!1}]:[],Z=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(k.EuiToolTip,{content:w.C},i.a.createElement(k.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(U.c)(t)),sortable:!1,width:V},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(k.EuiToolTip,{content:w.I},i.a.createElement(k.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(U.d)(t)}`),sortable:!1,width:V},favorite:{align:"center",field:"favorite",name:i.a.createElement(k.EuiToolTip,{content:w.p},i.a.createElement(k.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(k.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:V}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===E.m.template?n:a},X=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:r,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:s,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:u,onOpenTimeline:d,onSelectionChange:p,onTableChange:m,onToggleShowNotes:f,pageIndex:g,pageSize:b,searchResults:y,showExtendedColumns:h,sortField:v,sortDirection:x,tableRef:j,timelineType:S,totalSearchResultsCount:k})=>{const T=Object(a.useMemo)((()=>({showPerPageOptions:h,pageIndex:g,pageSize:b,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:k})),[n,g,b,h,k]),I=Object(a.useMemo)((()=>({sort:{field:v,direction:x}})),[v,x]),M=Object(a.useMemo)((()=>({selectable:e=>null!=e.savedObjectId&&e.status!==E.l.immutable,selectableMessage:e=>e?"":w.A,onSelectionChange:p})),[p]),{kibanaSecuritySolutionsPrivileges:C}=Object(O.a)(),_=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onCreateRule:i,onCreateRuleFromEql:r,onOpenDeleteTimelineModal:o,onOpenTimeline:s,onToggleShowNotes:l,showExtendedColumns:c,timelineType:u,hasCrudAccess:d})=>[...K({itemIdToExpandedNotesRowMap:a,onOpenTimeline:s,onToggleShowNotes:l,timelineType:u}),...J(c),...Z({timelineType:u}),...e.length?$({onCreateRule:i,onCreateRuleFromEql:r,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:o,onOpenTimeline:s,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:s,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:u,onOpenTimeline:d,onSelectionChange:p,onToggleShowNotes:f,showExtendedColumns:h,timelineType:S,hasCrudAccess:C.crud})),[e,t,o,s,l,c,u,d,p,f,h,S,C]),D=r||null==y?w.z:S===E.m.template?w.cb:w.bb;return i.a.createElement(ee,{columns:_,"data-test-subj":"timelines-table",itemId:"savedObjectId",itemIdToExpandedRowMap:o,items:null!=y?y:[],loading:r,noItemsMessage:D,onChange:m,pagination:T,selection:e.includes("selectable")?M:void 0,sorting:I,ref:j})}));X.displayName="TimelinesTable";var ee=v()(k.EuiBasicTable).withConfig({displayName:"_StyledEuiBasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]),te=n(697);const ne=v.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ae=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:r,itemIdToExpandedNotesRowMap:o,importDataModalToggle:s,onCreateRule:l,onCreateRuleFromEql:c,onDeleteSelected:u,onlyFavorites:d,onOpenTimeline:p,onQueryChange:m,onSelectionChange:f,onTableChange:g,onToggleOnlyFavorites:b,onToggleShowNotes:h,pageIndex:v,pageSize:T,query:I,refetch:M,searchResults:C,selectedItems:_,sortDirection:D,setImportDataModalToggle:A,sortField:F,tabName:N,timelineType:P=E.m.default,timelineStatus:z,timelineFilter:q,templateTimelineFilter:$,totalSearchResultsCount:V})=>{var G;const{actionItem:H,enableExportTimelineDownloader:W,isEnableDownloader:Q,isDeleteTimelineModalOpen:Y,onOpenDeleteTimelineModal:K,onCompleteEditTimelineAction:J}=L(),Z=Object(a.useRef)(null),{kibanaSecuritySolutionsPrivileges:ee}=Object(O.a)(),{getBatchItemsPopoverContent:ae}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:r=E.m.default})=>{const{enableExportTimelineDownloader:o,disableExportTimelineDownloader:s,isEnableDownloader:l,isDeleteTimelineModalOpen:c,onOpenDeleteTimelineModal:u,onCloseDeleteTimelineModal:d}=L(),p=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),s(),d()}),[s,d,n]),{timelineIds:m,searchIds:f}=Object(a.useMemo)((()=>null!=t?ve(he(t)):{timelineIds:[],searchIds:void 0}),[t]),g=Object(a.useCallback)((()=>o()),[o]),b=Object(a.useCallback)((()=>u()),[u]),y=Object(a.useCallback)((n=>{var a,o,s,u;const d=null==t||0===t.length,y=[];return t&&y.push(i.a.createElement(k.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:g},w.o)),e&&y.push(i.a.createElement(k.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:b},w.i)),i.a.createElement(i.a.Fragment,null,i.a.createElement(R,{deleteTimelines:e,ids:m,savedSearchIds:f,isEnableDownloader:l,isDeleteTimelineModalOpen:c,onComplete:p.bind(null,n),title:1!==(null==t?void 0:t.length)?r===E.m.template?w.M(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):w.N(null!==(o=null==t?void 0:t.length)&&void 0!==o?o:0):null!==(s=null===(u=t[0])||void 0===u?void 0:u.title)&&void 0!==s?s:""}),i.a.createElement(k.EuiContextMenuPanel,{items:y}))}),[t,e,m,f,l,c,p,r,g,b]);return{onCompleteBatchActions:p,getBatchItemsPopoverContent:y}})({deleteTimelines:ee.crud?e:void 0,selectedItems:_,tableRef:Z,timelineType:P}),ie=Object(a.useMemo)((()=>i.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:V,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},I.trim().length?`${w.ab} "${I.trim()}"`:"")}})),[V,I]),re=Object(a.useMemo)((()=>i.a.createElement(y.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:V,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},I.trim().length?`${w.ab} "${I.trim()}"`:"")}})),[V,I]),oe=Object(a.useMemo)((()=>null!=H&&null!=H.savedObjectId?[H.savedObjectId]:[]),[H]),se=Object(a.useMemo)((()=>null!=H&&null!=H.savedSearchId?[H.savedSearchId]:void 0),[H]),le=Object(a.useCallback)((()=>{null!=M&&M()}),[M]),ce=Object(a.useCallback)((()=>{null!=A&&A(!1)}),[A]),ue=Object(a.useCallback)((()=>{null!=A&&A(!1),null!=M&&M()}),[A,M]),de=Object(a.useMemo)((()=>{if(ee.crud){const t=["createFrom","duplicate",...null!=l?["createRule"]:[],...null!=c?["createRuleFromEql"]:[]];return z!==E.l.immutable&&(t.push("export"),t.push("selectable")),null!=u&&null!=e&&z!==E.l.immutable&&t.push("delete"),t}return z!==E.l.immutable?["export","selectable"]:[]}),[l,c,z,u,e,ee]),pe=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,$)),[$]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(R,{deleteTimelines:e,ids:oe,savedSearchIds:se,isDeleteTimelineModalOpen:Y,isEnableDownloader:Q,onComplete:J,title:null!==(G=null==H?void 0:H.title)&&void 0!==G?G:w.Z}),i.a.createElement(x.a,{checkBoxLabel:w.H,closeModal:ce,description:w.O,errorMessage:w.t,failedDetailed:w.u,importComplete:ue,importData:S.f,successMessage:w.U,showCheckBox:!1,showModal:null!=s&&s,submitBtnText:w.w,subtitle:w.x,title:w.v}),i.a.createElement("div",{"data-test-subj":"timelines-page-container",className:U.a},!!q&&q,"notes"!==N?i.a.createElement(i.a.Fragment,null,i.a.createElement(B,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:d,onQueryChange:m,onToggleOnlyFavorites:b,query:I,timelineType:P},pe),i.a.createElement(j.a,{border:!0},i.a.createElement(j.d,null,i.a.createElement(j.c,null,i.a.createElement(j.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,w.P," ",P===E.m.template?ie:re))),i.a.createElement(j.c,null,z!==E.l.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(j.e,{"data-test-subj":"selected-count"},P===E.m.template?w.M(_.length):w.N(_.length)),i.a.createElement(j.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:ae,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},w.a))),i.a.createElement(j.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:le},w.J)))),i.a.createElement(X,{actionTimelineToShow:de,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:W,onCreateRule:l,onCreateRuleFromEql:c,onOpenDeleteTimelineModal:K,onOpenTimeline:p,onSelectionChange:f,onTableChange:g,onToggleShowNotes:h,pageIndex:v,pageSize:T,searchResults:C,showExtendedColumns:!0,sortDirection:D,sortField:F,timelineType:P,totalSearchResultsCount:V,tableRef:Z})):i.a.createElement(te.a,{onOpenTimeline:p})))}));ae.displayName="OpenTimeline";var ie=n(224);const re=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>i.a.createElement(ie.a,{title:a,split:!0,height:40},i.a.createElement(k.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(k.EuiFlexItem,{grow:!1},i.a.createElement(k.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},w.q)),e&&i.a.createElement(k.EuiFlexItem,null,e)))));re.displayName="TitleRow";const oe=v.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);oe.displayName="HeaderContainer";const se=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:r=[],isLoading:o,itemIdToExpandedNotesRowMap:s,onAddTimelinesToFavorites:l,onDeleteSelected:c,onlyFavorites:u,onOpenTimeline:d,onQueryChange:p,onSelectionChange:m,onTableChange:f,onToggleOnlyFavorites:g,onToggleShowNotes:b,pageIndex:y,pageSize:h,searchResults:v,selectedItems:E,sortDirection:x,sortField:j,timelineFilter:S,timelineType:O,templateTimelineFilter:w,title:T,totalSearchResultsCount:I})=>{const M=Object(a.useRef)(null),C=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=c&&null!=e&&t.push("delete"),t.filter((e=>!r.includes(e)))}),[c,e,r]),_=Object(a.useMemo)((()=>i.a.createElement(a.Fragment,{key:"search-row-content"},!!w&&w)),[w]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(k.EuiModalHeader,null,i.a.createElement(oe,null,i.a.createElement(re,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:E.length,title:T}))),i.a.createElement(k.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!S&&i.a.createElement(i.a.Fragment,null,S,i.a.createElement(k.EuiSpacer,{size:"m"})),i.a.createElement(B,{"data-test-subj":"search-row",onlyFavorites:u,onQueryChange:p,onToggleOnlyFavorites:g,query:"",timelineType:O},_),i.a.createElement(X,{actionTimelineToShow:C,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:o,itemIdToExpandedNotesRowMap:s,onOpenTimeline:d,onSelectionChange:m,onTableChange:f,onToggleShowNotes:b,pageIndex:y,pageSize:h,searchResults:v,showExtendedColumns:!1,sortDirection:x,sortField:j,timelineType:O,totalSearchResultsCount:I,tableRef:M}))))}));se.displayName="OpenTimelineModalBody";var le=n(156),ce=n(194);let ue=function(e){return e.tab="tab",e.filter="filter",e}({});var de=n(911),pe=n(127),me=n(132),fe=n(187),ge=n(219),be=n(274),ye=n(158);const he=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),ve=e=>e.reduce(((e,{timelineId:t,searchId:n})=>{let a=e;return null!=n&&(a={...a,searchIds:[...a.searchIds,n]}),null!=t&&(a={...a,timelineIds:[...a.timelineIds,t]}),a}),{timelineIds:[],searchIds:[]}),Ee=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:y=!1,importDataModalToggle:h,onOpenTimeline:v,setImportDataModalToggle:x,tabName:j,title:O})=>{const I=Object(r.useDispatch)(),{startTransaction:M}=Object(fe.b)(),[C,_]=Object(a.useState)({}),[A,F]=Object(a.useState)(!1),[N,P]=Object(a.useState)(0),[R,L]=Object(a.useState)(t),[z,q]=Object(a.useState)(""),[B,$]=Object(a.useState)([]),[V,G]=Object(a.useState)("desc"),[H,W]=Object(a.useState)("updated"),Q=Object(a.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),Y=Object(d.b)((e=>{var t,n;return null!==(t=null===(n=Q(e,p.c.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:K,selectedPatterns:J}=Object(me.a)(pe.SourcererScopeName.timeline),Z=Object(s.a)("unifiedComponentsInTimelineDisabled"),{customTemplateTimelineCount:X,defaultTimelineCount:ee,elasticTemplateTimelineCount:te,favoriteCount:ne,fetchAllTimeline:ie,timelines:re,loading:oe,totalCount:Ee,templateTimelineCount:xe}=Object(g.b)(),{timelineType:je,timelineTabs:Se,timelineFilters:Oe}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:r}=Object(ce.l)(le.a.timelines),{navigateToUrl:o}=Object(c.j)().services.application,{tabName:l}=Object(T.useParams)(),[u,d]=Object(a.useState)(l===E.m.default||l===E.m.template?l:E.m.default),p=Object(s.a)("securitySolutionNotesEnabled"),m=Object(a.useMemo)((()=>n(Object(ce.j)(E.m.default,r))),[n,r]),f=Object(a.useMemo)((()=>n(Object(ce.j)(E.m.template,r))),[n,r]),g=Object(a.useMemo)((()=>n(Object(ce.j)("notes",r))),[n,r]),b=Object(a.useCallback)((e=>{e.preventDefault(),o(m)}),[o,m]),y=Object(a.useCallback)((e=>{e.preventDefault(),o(f)}),[o,f]),h=Object(a.useCallback)((e=>{e.preventDefault(),o(g)}),[o,g]),v=Object(a.useCallback)((e=>[{id:E.m.default,name:w.W,href:m,disabled:!1,onClick:e===ue.tab?b:D.noop},{id:E.m.template,name:w.V,href:f,disabled:!1,onClick:e===ue.tab?y:D.noop}]),[m,f,b,y]),x=Object(a.useCallback)(((e,t)=>{d((t=>(t!==e&&d(e),t)))}),[d]),j=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(k.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},v(ue.tab).map((e=>i.a.createElement(k.EuiTab,{"data-test-subj":`timeline-${ue.tab}-${e.id}`,isSelected:e.id===l,disabled:e.disabled,key:`timeline-${ue.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),x(e.id,ue.tab)}},e.name))),p&&i.a.createElement(k.EuiTab,{"data-test-subj":"timeline-notes",isSelected:"notes"===l,key:"timeline-notes",href:g,onClick:h},"Notes")),i.a.createElement(k.EuiSpacer,{size:"m"}))),[l]),S=Object(a.useMemo)((()=>i.a.createElement(k.EuiTabs,null,v(ue.filter).map((e=>i.a.createElement(k.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ue.filter}-${e.id}`,isSelected:e.id===u,key:`timeline-${ue.filter}-${e.id}`,onClick:t=>{e.onClick(t),x(e.id,ue.filter)}},e.name))))),[u,v,x]);return{timelineType:u,timelineTabs:j,timelineFilters:S}})({defaultTimelineCount:ee,templateTimelineCount:xe}),{timelineStatus:ke,templateTimelineFilter:we,installPrepackagedTimelines:Te}=Object(de.a)({timelineType:je,customTemplateTimelineCount:X,elasticTemplateTimelineCount:te}),Ie=Object(a.useCallback)((()=>{ie({pageInfo:{pageIndex:N+1,pageSize:R},search:z,sort:{sortField:H,sortOrder:V},onlyUserFavorite:A,timelineType:je,status:ke})}),[ie,N,R,z,H,V,je,ke,A]),Me=Object(a.useCallback)((e=>{q(e.queryText.trim())}),[]),Ce=Object(a.useCallback)((async(e,t)=>{M({name:e.length>1?ge.f.BULK_DELETE:ge.f.DELETE}),e.includes(Y)&&I(Object(f.createTimeline)({id:p.c.active,columns:Z?b.b:be.a,dataViewId:K,indexNames:J,show:!1,excludedRowRendererIds:Z?[]:ye.b.excludedRowRendererIds})),await Object(S.b)(e,t),Ie()}),[M,Y,Ie,I,K,J,Z]),_e=Object(a.useCallback)((async(e,t)=>{await Ce(e,t)}),[Ce]),De=Object(a.useCallback)((async()=>{const e=he(B),{timelineIds:t,searchIds:n}=ve(e);await Ce(t,n),qe()}),[B,Ce]),Ae=Object(a.useCallback)((e=>{$(e)}),[]),Fe=Object(a.useCallback)((({page:e,sort:t})=>{if(null!=e){const{index:t,size:n}=e;P(t),L(n)}if(null!=t){const{field:e,direction:n}=t;G(n),W(e)}}),[]),Ne=Object(a.useCallback)((()=>{F(!A)}),[A]),Pe=Object(a.useCallback)((e=>{_(e)}),[]),{navigateTo:Re}=Object(c.l)(),Le=Object(a.useCallback)((e=>Re({deepLinkId:u.Oc.rulesCreate,path:`?${l.b}=${Object(o.encode)(e)}`})),[Re]),ze=Object(a.useCallback)((e=>Re({deepLinkId:u.Oc.rulesCreate,path:`?${l.a}=${Object(o.encode)(e)}`})),[Re]),qe=Object(a.useCallback)((()=>{$([])}),[]),Be=Object(U.g)(),$e=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&M({name:ge.f.DUPLICATE}),y&&null!=e&&e(),Be({duplicate:t,onOpenTimeline:v,timelineId:n,timelineType:a,unifiedComponentsInTimelineDisabled:Z})}),[Be]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${U.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await Te(),Ie()})()}),[Ie,Te]),y?i.a.createElement(se,{"data-test-subj":"open-timeline-modal",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,hideActions:n,isLoading:oe,itemIdToExpandedNotesRowMap:C,onAddTimelinesToFavorites:void 0,onlyFavorites:A,onOpenTimeline:$e,onQueryChange:Me,onSelectionChange:Ae,onTableChange:Fe,onToggleOnlyFavorites:Ne,onToggleShowNotes:Pe,pageIndex:N,pageSize:R,query:z,searchResults:re,selectedItems:B,sortDirection:V,sortField:H,templateTimelineFilter:we,timelineType:je,timelineStatus:ke,timelineFilter:Oe,title:O,totalSearchResultsCount:Ee}):i.a.createElement(ae,{"data-test-subj":"open-timeline",deleteTimelines:_e,defaultPageSize:t,favoriteCount:ne,isLoading:oe,itemIdToExpandedNotesRowMap:C,importDataModalToggle:h,onAddTimelinesToFavorites:void 0,onCreateRule:Le,onCreateRuleFromEql:ze,onDeleteSelected:De,onlyFavorites:A,onOpenTimeline:$e,onQueryChange:Me,onSelectionChange:Ae,onTableChange:Fe,onToggleOnlyFavorites:Ne,onToggleShowNotes:Pe,pageIndex:N,pageSize:R,query:z,refetch:Ie,searchResults:re,setImportDataModalToggle:x,selectedItems:B,sortDirection:V,sortField:H,tabName:j,templateTimelineFilter:we,timelineType:je,timelineStatus:ke,timelineFilter:Se,title:O,totalSearchResultsCount:Ee})})),xe=i.a.memo(Ee)},function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(2),i=n.n(a),r=n(19),o=n(48),s=n(1213),l=n(844),c=n(1261),u=n(694),d=n(4),p=n(793),m=n(119),f=n.n(m);const g=Object(a.memo)((e=>{const t=Object(a.useRef)(null),n=i.a.createElement(r.EuiButton,f()({buttonRef:t},e));return Object(a.useEffect)((()=>{t.current&&t.current.focus()}),[]),n}));g.displayName="AutoFocusButton";var b=n(126),y=n(451),h=n(118),v=n(361);const E=Object.freeze({deleteActionFailure:(e,t)=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionFailure",{defaultMessage:'Unable to remove "{itemName}". Reason: {errorMessage}',values:{itemName:e,errorMessage:t}}),deleteActionSuccess:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionSuccess",{defaultMessage:'"{itemName}" has been removed',values:{itemName:e}})}),x=Object.freeze({deleteModalTitle:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalTitle",{defaultMessage:"Delete {itemName}",values:{itemName:e}}),deleteModalImpactTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactTitle",{defaultMessage:"Warning"}),deleteModalImpactInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfo",{defaultMessage:"Deleting this entry will remove it from {count} associated {count, plural, one {policy} other {policies}}.",values:{count:Object(y.f)(e)?d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfoAll",{defaultMessage:"all"}):Object(y.d)(e).length}}),deleteModalConfirmInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalConfirmInfo",{defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalSubmitButtonTitle",{defaultMessage:"Delete"}),deleteModalCancelButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalCancelButtonTitle",{defaultMessage:"Cancel"})}),j=Object(a.memo)((({apiClient:e,item:t,onCancel:n,onSuccess:o,"data-test-subj":s,labels:l})=>{const c=Object(b.a)(s),{deleteArtifactItem:u,isLoading:d}=((e,t,n)=>{const i=Object(h.n)(),r=Object(v.c)(e,{onError:e=>{var a;i.addDanger(n.deleteActionFailure(t.name,(null===(a=e.body)||void 0===a?void 0:a.message)||e.message))},onSuccess:e=>{i.addSuccess(n.deleteActionSuccess(e.name))}});return Object(a.useMemo)((()=>({...r,deleteArtifactItem:r.mutateAsync})),[r])})(e,t,l),p=Object(a.useCallback)((()=>{u(t).then((()=>o()))}),[u,t,o]),m=Object(a.useCallback)((()=>{d||n()}),[d,n]);return i.a.createElement(r.EuiModal,{onClose:m,"data-test-subj":s},i.a.createElement(r.EuiModalHeader,{"data-test-subj":c("header")},i.a.createElement(r.EuiModalHeaderTitle,null,l.deleteModalTitle(t.name))),i.a.createElement(r.EuiModalBody,{"data-test-subj":c("body")},i.a.createElement(r.EuiText,null,i.a.createElement(r.EuiCallOut,{"data-test-subj":c("impactCallout"),title:l.deleteModalImpactTitle,color:"danger",iconType:"warning"},i.a.createElement("p",{"data-test-subj":c("impactCalloutInfo")},l.deleteModalImpactInfo(t))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement("p",null,l.deleteModalConfirmInfo))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:m,isDisabled:d,"data-test-subj":c("cancelButton")},l.deleteModalCancelButtonTitle),i.a.createElement(g,{fill:!0,color:"danger",onClick:p,isLoading:d,isDisabled:d,"data-test-subj":c("submitButton")},l.deleteModalSubmitButtonTitle)))}));j.displayName="ArtifactDeleteModal";const S=Object.freeze({pageTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.pageTitle",{defaultMessage:"Artifact"}),pageAboutInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.aboutInfo",{defaultMessage:"A list of artifacts for endpoint"}),pageAddButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.addButtonTitle",{defaultMessage:"Add artifact"}),emptyStateTitleNoEntries:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitleNoEntries",{defaultMessage:"There are no entries to display."}),emptyStateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitle",{defaultMessage:"Add your first artifact"}),emptyStateInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateInfo",{defaultMessage:"Add an artifact"}),emptyStatePrimaryButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStatePrimaryButtonLabel",{defaultMessage:"Add"}),searchPlaceholderInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"}),getShowingCountLabel:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.showingTotal",{defaultMessage:"Showing {total, plural, one {# artifact} other {# artifacts}}",values:{total:e}}),cardActionEditLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionEditLabel",{defaultMessage:"Edit artifact"}),cardActionDeleteLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),...p.a,...x,...E});var O=n(587),k=n(1204),w=n(543),T=n(237),I=n(41),M=n.n(I),C=n(517);const _=M()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1flznkw-0"})(["",""],(()=>Object(I.css)(["max-width:100%;"]))),D=Object(a.memo)((({onAdd:e,isAddDisabled:t=!1,backComponent:n,"data-test-subj":a,titleLabel:o,titleNoEntriesLabel:s,aboutInfo:l,primaryButtonLabel:c,secondaryAboutInfo:u,canCreateItems:d=!0})=>{const p=Object(b.a)(a);return i.a.createElement(C.a,null,d?i.a.createElement(_,{"data-test-subj":a,iconType:"plusInCircle",title:i.a.createElement("h2",{"data-test-subj":p("title")},o),body:i.a.createElement("div",{"data-test-subj":p("aboutInfo")},l,u?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),u):void 0),actions:[i.a.createElement(r.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":p("addButton")},c),...n?[n]:[]]}):i.a.createElement(_,{"data-test-subj":a,iconType:"iInCircle",title:i.a.createElement("h2",{"data-test-subj":p("title-no-entries")},s)}))}));D.displayName="NoDataEmptyState";var A=n(845),F=n(783),N=n(47),P=n(182),R=n(297),L=n(1352),z=n(518);var q=n(245),B=n(42),$=n(482);const V=Object(a.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:n,...a})=>{const o=Object($.a)(...n);return i.a.createElement(r.EuiButtonEmpty,f()({},a,{"data-test-subj":"backToOrigin",size:"s",href:t,onClick:o,textProps:{className:"text"}}),e||i.a.createElement(B.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));V.displayName="BackToExternalAppSecondaryButton";var U=n(734);const G=Object(a.memo)((({apiClient:e,ArtifactFormComponent:t,searchableFields:n=q.c,labels:d={},secondaryPageInfo:m,onFormSubmit:f,flyoutSize:g,"data-test-subj":y,allowCardEditAction:E=!0,allowCardCreateAction:x=!0,allowCardDeleteAction:I=!0,CardDecorator:M})=>{var C,_;const{state:B}=Object(o.useLocation)(),$=Object(b.a)(y),G=Object(h.n)(),H=Object(s.a)(),W=Object(A.a)(E,x),Q=Object(F.a)(),{urlParams:{filter:Y,includedPolicies:K}}=Object(R.a)(),{isPageInitializing:J,isFetching:Z,data:X,uiPagination:ee,doesDataExist:te,error:ne,refetch:ae}=((e,t)=>{const n=Object(s.a)(),{urlParams:{filter:i,includedPolicies:r}}=Object(R.a)(),{pagination:{page:o,pageSize:l}}=Object(z.b)(),c=((e,t,n)=>Object(a.useMemo)((()=>Object(L.a)({kuery:Object(L.b)(e,t),policies:n?n.split(","):[]})),[t,e,n]))(i,t,r),{data:u,isFetching:d,refetch:p}=Object(N.useQuery)(["does-data-exists",e],(async()=>e.hasData()),{enabled:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),[m,f]=Object(a.useState)({totalItemCount:0,pageSize:l,pageSizeOptions:[...P.f],pageIndex:o-1}),[g,b]=Object(a.useState)(!0),y=Object(v.f)(e,{page:o,perPage:l,filter:i,policies:r?r.split(","):[]},t),{data:h,isFetching:E,error:x,isSuccess:j}=y;return Object(a.useEffect)((()=>{n()&&g&&!d&&b(!1)}),[d,n,g]),Object(a.useEffect)((()=>{n()&&h&&!E&&j&&f((e=>({...e,pageIndex:h.page-1,pageSize:h.per_page,totalItemCount:h.total})))}),[E,n,j,h]),Object(a.useEffect)((()=>{!n()||E||d||x||"1"!==String(o)||c||!(h&&0===h.total&&u||h&&h.total>0&&!u)||p()}),[p,u,i,r,d,E,n,c,h,x,o]),Object(a.useMemo)((()=>({isPageInitializing:g,doesDataExist:null!=u&&u,uiPagination:m,...y})),[u,g,y,m])})(e,n);Object(a.useEffect)((()=>{var e;!Z&&ne&&G.addDanger((null==ne||null===(e=ne.body)||void 0===e?void 0:e.message)||ne.message)}),[ne,G,Z]);const ie=Object(a.useMemo)((()=>{var e;return null!==(e=null==X?void 0:X.data)&&void 0!==e?e:[]}),[null==X?void 0:X.data]),[re,oe]=Object(a.useState)(void 0),[se,le]=Object(a.useState)(void 0),ce=Object(a.useMemo)((()=>({...S,...d})),[d]),ue=(({items:e,onAction:t,cardActionDeleteLabel:n,cardActionEditLabel:i,dataTestSubj:r,allowCardDeleteAction:o=!0,allowCardEditAction:s=!0})=>{const l=Object(b.a)(r),c=Object(h.n)(),{data:d}=Object(w.c)({onError:e=>{c.addDanger(Object(T.d)(e))}}),p=Object(u.f)(null==d?void 0:d.items),m=Object(a.useMemo)((()=>{const a={};for(const c of e){const e=[];s&&e.push({icon:"controlsHorizontal",onClick:()=>{t({type:"edit",item:c})},"data-test-subj":l("cardEditAction"),children:i}),o&&e.push({icon:"trash",onClick:()=>{t({type:"delete",item:c})},"data-test-subj":l("cardDeleteAction"),children:n}),a[c.id]={item:c,policies:p,"data-test-subj":r,actions:e.length>0?e:void 0,hideDescription:!c.description,hideComments:!c.comments.length}}return a}),[e,s,o,p,r,l,i,t,n]);return Object(a.useCallback)((e=>m[e.id]),[m])})({items:ie,onAction:Object(a.useCallback)((({type:e,item:t})=>{switch(e){case"edit":le(t),Q({show:"edit",itemId:t.item_id});break;case"delete":oe(t)}}),[Q]),cardActionDeleteLabel:ce.cardActionDeleteLabel,cardActionEditLabel:ce.cardActionEditLabel,dataTestSubj:$("card"),allowCardDeleteAction:I,allowCardEditAction:E}),de=Object(w.c)({perPage:1e3,onError:e=>{G.addWarning(Object(T.d)(e))}}),pe=function(e){const[t,n]=Object(a.useState)();return Object(a.useEffect)((()=>{e&&e.onBackButtonNavigateTo&&n(e)}),[e]),t}(B),me=Object(a.useMemo)((()=>{if(pe&&pe.onBackButtonNavigateTo)return i.a.createElement(V,pe)}),[pe]),fe=Object(a.useMemo)((()=>{if(pe&&pe.onBackButtonNavigateTo)return i.a.createElement(U.a,pe)}),[pe]),ge=Object(a.useCallback)((()=>{Q({show:"create"})}),[Q]),be=Object(a.useCallback)((({pageIndex:e,pageSize:t})=>{Q({page:e+1,pageSize:t}),window.scrollTo({top:0,left:0,behavior:"smooth"})}),[Q]),ye=Object(a.useCallback)(((e,t,n)=>{const a=e!==(null!=Y?Y:"")||t!==(null!=K?K:"");Q({filter:""===e.trim()?void 0:e,includedPolicies:""===t.trim()?void 0:t}),n&&!a&&ae()}),[Y,K,ae,Q]),he=Object(a.useCallback)((()=>{H()&&(oe(void 0),ae())}),[H,ae]),ve=Object(a.useCallback)((()=>{oe(void 0)}),[]),Ee=Object(a.useCallback)((()=>{le(void 0),ae()}),[ae]),xe=Object(a.useCallback)((()=>{le(void 0)}),[]),je=Object(a.useMemo)((()=>{const e=ce.pageAboutInfo?i.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},ce.pageAboutInfo):void 0,t=m?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),m):void 0;return i.a.createElement(i.a.Fragment,null,e,t)}),[ce.pageAboutInfo,m]);return J?i.a.createElement(O.a,{"data-test-subj":$("pageLoader")}):i.a.createElement(l.a,{headerBackComponent:fe,hideHeader:!te,title:ce.pageTitle,subtitle:je,actions:x&&i.a.createElement(r.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:W,onClick:ge,"data-test-subj":$("pageAddButton")},ce.pageAddButtonTitle),"data-test-subj":$("container")},W&&i.a.createElement(p.b,{apiClient:e,item:se,onSuccess:Ee,onClose:xe,FormComponent:t,labels:ce,size:g,submitHandler:f,policies:(null===(C=de.data)||void 0===C?void 0:C.items)||[],policiesIsLoading:de.isLoading,"data-test-subj":$("flyout")}),re&&i.a.createElement(j,{apiClient:e,item:re,labels:ce,"data-test-subj":$("deleteModal"),onSuccess:he,onCancel:ve}),te?i.a.createElement(i.a.Fragment,null,i.a.createElement(k.a,{defaultValue:Y,onSearch:ye,placeholder:ce.searchPlaceholderInfo,hasPolicyFilter:!0,policyList:null===(_=de.data)||void 0===_?void 0:_.items,defaultIncludedPolicies:K}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{color:"subdued",size:"xs","data-test-subj":$("showCount")},ce.getShowingCountLabel(ee.totalItemCount)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{items:ie,ItemComponent:u.a,itemComponentProps:ue,onChange:be,error:ne,loading:Z,pagination:ee,contentClassName:"card-container","data-test-subj":$("list"),CardDecorator:M})):i.a.createElement(D,{onAdd:ge,titleNoEntriesLabel:ce.emptyStateTitleNoEntries,titleLabel:ce.emptyStateTitle,aboutInfo:ce.emptyStateInfo,primaryButtonLabel:ce.emptyStatePrimaryButtonLabel,backComponent:me,"data-test-subj":$("emptyState"),secondaryAboutInfo:m,canCreateItems:x}))}));G.displayName="ArtifactListPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(119),i=n.n(a),r=n(2),o=n(90),s=n(981),l=n(8),c=n.n(l),u=n(71),d=n.n(u),p=n(19);const m="eui-global",f="eui-utilities",g={darkMode:!1};var b=n(43);const y=[p.euiStylisPrefixer],h=d()({key:"css",stylisPlugins:y,container:document.querySelector('meta[name="emotion"]')}),v=d()({key:m,stylisPlugins:y,container:document.querySelector(`meta[name="${m}"]`)}),E=d()({key:f,stylisPlugins:y,container:document.querySelector(`meta[name="${f}"]`)});h.compat=!0,v.compat=!0,E.compat=!0;const x={default:h,global:v,utility:E},j=({theme:{theme$:e},globalStyles:t,colorMode:n,modify:a,children:i})=>{const o=c()(e,g),s=Object(r.useMemo)((()=>(e=>e.darkMode?p.COLOR_MODES_STANDARD.dark:p.COLOR_MODES_STANDARD.light)(o)),[o]),l=n||s,u=!1!==t&&void 0;return Object(b.jsx)(p.EuiProvider,{cache:x,modify:a,colorMode:l,globalStyles:u,utilityClasses:u},i)},S=({children:e,i18n:t,...n})=>Object(o.useIsNestedEuiProvider)()?(Object(s.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(b.jsx)(t.Context,null,e)):Object(b.jsx)(j,n,Object(b.jsx)(t.Context,null,e));var O=n(84);const k=({children:e,...t})=>Object(b.jsx)(S,i()({globalStyles:!1},t),Object(b.jsx)(O.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(b.jsx)(O.KibanaErrorBoundary,null,e)))},function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return M}));var a=n(2),i=n.n(a),r=n(19),o=n(121),s=n(908),l=n(194);const c="timeline";var u=n(4);const d=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),p=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),m=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),f=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),g=e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),b=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var y=n(156);const h=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(l.l)(y.a.timelines),c=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),u=Object(a.useCallback)(((e,a,i)=>{const r=n(Object(l.k)(null!=a?a:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${r})`,{block:!1})}),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiModalHeader,null),i.a.createElement(r.EuiModalBody,null,i.a.createElement(s.a,{hideUntitled:!0,getSelectableOptions:c,onTimelineChange:u,onClosePopover:e,timelineType:o.m.default})))},v=Object(a.memo)(h),E=({interactionsUpsellingMessage:e})=>({name:c,button:{label:null!=e?e:d,iconType:"timeline",isDisabled:!!e},helpText:i.a.createElement(r.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return i.a.createElement(v,{onClosePopover:n,onInsert:t})}});var x=n(58),j=n(429);const S=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function i(e,n){if(t[a]!==e)throw new Error(f);a++;let i="",r=0;for(;a<t.length;a++){const o=t[a];if(o===n&&0===r)return a++,i;o===n?r--:o===e&&r++,i+=o}return""}const r=i("[","]"),o=i("(",")"),s=e.now();if(!r)return this.file.info(p,{line:s.line,column:s.column}),!1;try{var l;const t=o.split("?"),n=Object(j.parse)(t[1]),a=Object(x.safeDecode)(null!==(l=n.timeline)&&void 0!==l?l:""),{id:i="",graphEventId:u=""}=null!=a?a:{id:null,graphEventId:""};return i?e(`[${r}](${o})`)({type:c,id:i,title:r,graphEventId:u}):(this.file.info(m,{line:s.line,column:s.column+o.indexOf("id")}),!1)}catch{this.file.info((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(o),{line:s.line,column:s.column})}return!1},i=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,n.splice(n.indexOf("url"),0,c)};var O=n(208),k=n(184),w=n(122),T=n(123);const I=({id:e,title:t,graphEventId:n})=>{const{addError:o}=Object(T.a)(),s=Object(O.b)("investigation_guide_interactions"),l=(()=>{const e=Object(k.g)(),t=Object(w.a)("unifiedComponentsInTimelineDisabled");return Object(a.useCallback)(((n,a,i)=>{e({graphEventId:i,timelineId:n,onError:a,unifiedComponentsInTimelineDisabled:t})}),[e,t])})(),c=Object(a.useCallback)(((e,t)=>{o(e,{title:b,toastMessage:g(t)})}),[o]),d=Object(a.useCallback)((()=>l(null!=e?e:"",c,n)),[e,n,l,c]);return i.a.createElement(r.EuiToolTip,{content:null!=s?s:(p=null!=e?e:"",u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:p}}))},i.a.createElement(r.EuiLink,{onClick:d,disabled:!!s,"data-test-subj":`markdown-timeline-link-${e}`},t));var p},M=Object(a.memo)(I)},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(44),i=n(19),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(179),u=n(121),d=n(252),p=n(4);const m=p.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),f=p.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),g=p.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),b=p.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),y=p.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),h=p.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),v=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),E=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),x=p.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),j=p.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),S=p.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),O=p.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),k=p.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),w=p.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),T=e=>p.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),I=[{label:y},{label:v},{label:h},{label:E},{label:f},{label:m}],M=[],C=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):M).map((e=>({label:e})))};var n})):M,_=({browserFields:e,selectedField:t,selectedOperator:n,type:i})=>{const r=t.length>0?t[0].label:"",o=n.length>0?n[0].label:"",s=e&&null!=Object(d.a)(e)[r],l=-1!==Object(a.findIndex)((e=>e.label===o),I),c=i===u.a.template&&(o===h||o===E);return s&&l&&!c},D=e=>{switch(e.length>0?e[0].label:""){case y:case v:return c.d;case h:case E:return c.c;case f:case m:return c.b;default:return c.d}},A=e=>{switch(e.length>0?e[0].label:""){case v:case E:case m:return!0;default:return!1}},F=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var N=n(191);const P=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(R(e));Object(r.useEffect)((()=>{t(L(n))}),[n,t]);const s=Object(r.useCallback)(((e,t=n)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&a([...n,{label:e}])}),[n]),l=Object(r.useCallback)((e=>{a(e)}),[]);return o.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:x,onCreateOption:s,onChange:l})},R=e=>Object(N.j)(e)?e.map((e=>({label:String(e)}))):[],L=e=>e.map((e=>e.label)),z=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(q(e));Object(r.useEffect)((()=>{t(F(n))}),[n,t]);const s=Object(r.useCallback)((e=>{a(e.target.value)}),[]);return o.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:s,placeholder:O,value:F(n)})},q=e=>{var t;return Object(N.j)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},B="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const $=o.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:s,onDataProviderEdited:l,operator:u,providerId:d,timelineId:p,value:x,type:O=c.a.default})=>{const[M,F]=Object(r.useState)([{label:n}]),[N,R]=Object(r.useState)(((e,t)=>":"===t?e?[{label:v}]:[{label:y}]:"includes"===t?e?[{label:E}]:[{label:h}]:e?[{label:m}]:[{label:f}])(s,u)),[L,q]=Object(r.useState)(x),$=Object(r.useMemo)((()=>N.length>0&&(N[0].label===h||N[0].label===E)),[N]),V=Object(r.useMemo)((()=>O!==c.a.template&&N.length>0&&N[0].label!==f&&N[0].label!==m&&!$),[$,O,N]),U=Object(r.useMemo)((()=>$&&Array.isArray(L)&&!L.length),[$,L]),G=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(B);e.length>0&&e[0].focus()}},H=Object(r.useCallback)((e=>{F(e),O===c.a.template&&q(`{${e[0].label}}`),G()}),[O]),W=Object(r.useCallback)((e=>{R(e),G()}),[]),Q=Object(r.useCallback)((e=>{q(e)}),[]),Y=Object(r.useCallback)((()=>{l({andProviderId:e,excluded:A(N),field:M.length>0?M[0].label:"",id:p,operator:D(N),providerId:d,value:L,type:O})}),[l,e,N,M,p,d,L,O]);return Object(r.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),o.a.createElement(i.EuiPanel,{paddingSize:"s"},o.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(i.EuiFormRow,{label:g},o.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:H,options:C(t),placeholder:b,selectedOptions:M,singleSelection:{asPlainText:!0},fullWidth:!0}))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(i.EuiFormRow,{label:j},o.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:W,options:I,placeholder:w,selectedOptions:N,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexItem,{grow:!1},V&&o.a.createElement(i.EuiFormRow,{label:k},o.a.createElement(z,{onChangeCallback:Q,value:x})),$&&O!==c.a.template&&o.a.createElement(i.EuiFormRow,{label:k},o.a.createElement(P,{onChangeCallback:Q,value:x}))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexItem,{grow:!1},O===c.a.template&&$&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:T(N[0].label)}),o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiButton,{className:B,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!_({type:O,browserFields:t,selectedField:M,selectedOperator:N})||U,onClick:Y,size:"m"},S))))))}));$.displayName="StatefulEditDataProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(2),i=n.n(a),r=n(92);const o={capabilities:Object(r.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var s=n(123),l=n(118),c=n(1532),u=n(1533);const d=Object(c.a)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),p=n(4).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),m={...o,capabilitiesFetched:!1},f=i.a.createContext(m);f.displayName="MlCapabilitiesContext";const g=i.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(m),r=Object(l.i)(),{addError:o}=Object(s.a)(),{start:c,result:g,error:b}=Object(u.a)(d);return Object(a.useEffect)((()=>{c({http:r})}),[r,c]),Object(a.useEffect)((()=>{g&&n({...g,capabilitiesFetched:!0})}),[g]),Object(a.useEffect)((()=>{b&&o(b,{title:p})}),[o,b]),i.a.createElement(f.Provider,{value:t},e)}));g.displayName="MlCapabilitiesProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),i=n.n(a),r=n(19),o=n(123),s=n(4);const l=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),c=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),u=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),p=e=>s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),m=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),f=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),g=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),i=new Error(a.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i};var b=n(242);const y=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:n}=Object(b.c)().services;if(!t||!e.length)return null;const{actionPath:a,message:o,buttonLabel:l}=e[0];return i.a.createElement(r.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:i.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(c=t,s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:c},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},i.a.createElement(r.EuiText,{size:"xs"},o)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},i.a.createElement(r.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:n.basePath.prepend(a)},l||m)))));var c};y.displayName="ActionConnectorWarningsComponent";const h=i.a.memo(y);h.displayName="ActionConnectorWarnings";const v=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:m,failedDetailed:b,importComplete:y,importData:v,showCheckBox:E=!0,showExceptionsCheckBox:x=!1,showActionConnectorsCheckBox:j=!1,showModal:S,submitBtnText:O,subtitle:k,successMessage:w,title:T})=>{const[I,M]=Object(a.useState)(null),[C,_]=Object(a.useState)(!1),[D,A]=Object(a.useState)(!1),[F,N]=Object(a.useState)(!1),[P,R]=Object(a.useState)(!1),{addError:L,addSuccess:z}=Object(o.a)(),[q,B]=Object(a.useState)([]),$=Object(a.useMemo)((()=>Object(r.htmlIdGenerator)()()),[]),[V,U]=Object(a.useState)(0),G=Object(a.useCallback)((()=>{t(),A(!1),N(!1),R(!1),B([])}),[t,A,N]),H=Object(a.useCallback)((e=>{_(!1),M(null),y(),e&&(y(),G())}),[G,y]),W=Object(a.useCallback)((async()=>{if(null!=I){_(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...n}=await v({fileToImport:I[0],overwrite:D,overwriteExceptions:F,overwriteActionConnectors:P,signal:e.signal}),a=n.action_connectors_success_count;B(t),U(a),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:n,successMessage:a,errorMessage:i,errorMessageDetailed:r,addError:o,addSuccess:l})=>{if(e.success)return e.success_count>0&&l(a(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&l((u=e.exceptions_success_count,s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:u},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(n&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&l((c=e.action_connectors_success_count,s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:c},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var c,u;if(e.errors.length>0){if(n&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:n}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:n,error:a}=e;t=t&&t!==n?`${t},${n}`:n;const{status_code:i,message:r}=a||{};let o;return o=403===i?f:r,{...e,error:{...a,message:o}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return o(g(r,e,t),{title:p(n||t.length)})}o(g(r,e,e.errors),{title:i(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&o(g(r,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:n,exceptionsIncluded:x,actionConnectorsIncluded:j,successMessage:w,errorMessage:m,errorMessageDetailed:b,addError:L,addSuccess:z}),H(!(null!=t&&t.length))}catch(e){G(),L(e,{title:m(1)})}}}),[I,v,D,F,P,x,w,m,b,L,z,j,H,G]),Q=Object(a.useCallback)((()=>{G()}),[G]),Y=Object(a.useCallback)((()=>{A((e=>!e))}),[]),K=Object(a.useCallback)((()=>{N((e=>!e))}),[]),J=Object(a.useCallback)((()=>{R((e=>!e))}),[]),Z=Object(a.useCallback)((e=>{M(e&&e.length>0?e:null)}),[]);return i.a.createElement(i.a.Fragment,null,S&&i.a.createElement(r.EuiModal,{onClose:Q,maxWidth:"750px"},i.a.createElement(r.EuiModalHeader,null,i.a.createElement(r.EuiModalHeaderTitle,null,T)),i.a.createElement(r.EuiModalBody,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("h4",{id:$},n)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:k,onChange:Z,display:"large",fullWidth:!0,isLoading:C,"aria-labelledby":$}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(h,{actionConnectorsWarnings:q,importedActionConnectorsCount:V}),i.a.createElement(r.EuiSpacer,{size:"s"}),E&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:D,onChange:Y}),x&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:c,checked:F,onChange:K}),j&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:u,checked:P,onChange:J}))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:Q},l),i.a.createElement(r.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:W,disabled:null==I||C,fill:!0},O))))};v.displayName="ImportDataModalComponent";const E=i.a.memo(v);E.displayName="ImportDataModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(83),i=n(1192),r=n.n(i),o=n(44),s=n(4);const l=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(o.startCase)(t):""},c=async(e,t)=>{const n=await(async(e,t)=>{var n;const a=await(null===(n=t.get(e.actionTypeId))||void 0===n?void 0:n.validateParams(e.params));if(a){const e=Object.values(a.errors);if(e.length){const t=e.filter((e=>Object(o.isString)(e)||Object(o.isArray)(e))),n=Object(o.uniq)(Object(o.flattenDeep)(t));if(n.length)return n}}return[]})(e,t),i=(e=>{const t=[];return Object.entries(e).forEach((([e,n])=>{if(Object(o.isString)(n))try{r.a.render(n,{})}catch(n){t.push((e=>s.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(o.startCase)(e)}}))(e))}})),t})(e.params),l=Object(a.validateActionFilterQuery)(e);return[...n,...i,...l?[l]:[]]},u=(e,t=100)=>n=>{let a=!1;const i=new Promise((i=>{setTimeout((()=>{a?i():i((e=>async(...t)=>{const[{value:n,path:a}]=t,i=[];for(const t of n){const n=await c(t,e);if(n.length){const e=l(t.actionTypeId),a=n.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${a.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:a,message:`${i.join("\n")}`}})(e)(n))}),t)}));return i.cancel=()=>{a=!0},i}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(535),i=n(4);const r=i.i18n.translate("xpack.securitySolution.assistant.content.promptContexts.viewTitle",{defaultMessage:"view"}),o=i.i18n.translate("xpack.securitySolution.assistant.content.promptContexts.indexTitle",{defaultMessage:"index"});var s=n(178),l=n(197);const c=`${i.i18n.translate("xpack.securitySolution.assistant.content.prompts.user.thenSummarizeSuggestedKqlAndEqlQueries",{defaultMessage:"Evaluate the event from the context above and format your output neatly in markdown syntax for my Elastic Security case."})}\n${i.i18n.translate("xpack.securitySolution.assistant.content.prompts.user.finallySuggestInvestigationGuideAndFormatAsMarkdown",{defaultMessage:"Add your description, recommended actions and bulleted triage steps. Use the MITRE ATT&CK data provided to add more context and recommendations from MITRE, and hyperlink to the relevant pages on MITRE's website. Be sure to include the user and host risk score data from the context. Your response should include steps that point to Elastic Security specific features, including endpoint response actions, the Elastic Agent OSQuery manager integration (with example osquery queries), timelines and entity analytics and link to all the relevant Elastic Security documentation."})}`,u="alert",d="event",p="detection-rules",m="data-quality-dashboard",f="knowledge-base",g={[u]:{category:u,suggestedUserPrompt:c,description:l.d(r),tooltip:l.f},[d]:{category:d,suggestedUserPrompt:c,description:l.h(r),tooltip:l.j},[m]:{category:m,suggestedUserPrompt:a.l,description:a.i(o),tooltip:a.j},[p]:{category:p,suggestedUserPrompt:s.Xb,description:s.hd,tooltip:s.id}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(44),i=n(2),r=n.n(i),o=n(45),s=n(121),l=n(124),c=n(129),u=n(19),d=n(52),p=n.n(d),m=n(41),f=n.n(m),g=n(130),b=n(657),y=n(179),h=n(516);const v=f()(u.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===s.m.template?"140px":"none"));v.displayName="ProviderBadgeStyled";const E=f.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),x=f()(E).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),j=f()(E).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),S=({type:e,toggleType:t})=>e!==y.a.template?r.a.createElement(j,{onClick:t},h.d):r.a.createElement(x,null,h.w),O=r.a.memo(S),k={tabIndex:-1},w=r.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:o,operator:l,providerId:c,togglePopover:u,toggleType:d,displayValue:m,val:f,type:E,timelineType:x})=>{const j=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),S=Object(i.useMemo)((()=>p()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":o})),[n,o]),w=Object(i.useMemo)((()=>Object(a.isString)(f)&&""===f?Object(g.b)():f),[f]),T=Object(i.useMemo)((()=>o?r.a.createElement("span",null,h.q," "):null),[o]),I=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,T,l!==y.b?r.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?m:w}"`):r.a.createElement("span",{className:"field-value"},t," ",h.j))),[m,t,w,l,T]),M=Object(i.useMemo)((()=>h.v({field:t,value:`${w}`})),[t,w]);return r.a.createElement(b.a,{id:`${c}-${t}-${f}`},r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{className:S,color:"hollow",title:"",iconOnClick:j,iconOnClickAriaLabel:h.t,iconType:"cross",iconSide:"right",onClick:u,onClickAriaLabel:M,closeButtonProps:k,"data-test-subj":"providerBadge",$timelineType:x},I),x===s.m.template&&l!==y.c&&r.a.createElement(O,{toggleType:d,type:E})))}));w.displayName="ProviderBadge";var T=n(0),I=n.n(T),M=n(955);const C="edit-data-provider",_="exclude-data-provider",D="enable-data-provider",A="filter-for-field-present-data-provider",F="delete-data-provider",N=f()(u.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);N.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends r.a.PureComponent{constructor(...e){super(...e),I()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:o,type:s})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:o,type:s}),this.props.closePopover()})),I()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:i,type:r}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:y.b,providerId:a,value:i,type:r}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:i,field:o,isEnabled:l,isExcluded:c,isLoading:d,isOpen:p,operator:m,providerId:f,timelineId:g,timelineType:b,toggleEnabledProvider:v,toggleExcludedProvider:E,toggleTypeProvider:x,value:j,type:S}=this.props,O=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:i,isExcluded:o,isLoading:l,operator:c,onDataProviderEdited:u,onFilterForFieldPresent:d,providerId:p,timelineId:m,timelineType:f,toggleEnabled:g,toggleExcluded:b,toggleType:v,type:E,value:x})=>[{id:0,items:[{className:C,disabled:l,icon:"pencil",name:h.g,panel:1},{className:_,disabled:l,icon:o?"plusInCircle":"minusInCircle",name:o?h.p:h.i,onClick:b},{className:D,disabled:l,icon:i?"eyeClosed":"eye",name:i?h.x:h.u,onClick:g},{className:A,disabled:l,icon:"logstashFilter",name:h.k,onClick:d},f===s.m.template?{className:"convert-to-field-data-provider",disabled:l||c===y.c,icon:"visText",name:E===y.a.template?h.c:h.d,onClick:v}:{name:null},{className:F,disabled:l,icon:"trash",name:h.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=m&&null!=u?r.a.createElement(M.a,{andProviderId:e,browserFields:t,field:a,isExcluded:o,onDataProviderEdited:u,operator:c,providerId:p,timelineId:m,value:x,type:E}):null,id:1,title:h.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:o,isEnabled:l,isExcluded:c,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:m,providerId:f,timelineId:g,timelineType:b,toggleEnabled:v,toggleExcluded:E,toggleType:x,value:j,type:S});return r.a.createElement(N,{id:`popoverFor_${f}-${o}-${j}`,isOpen:p,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},r.a.createElement("div",{style:{userSelect:"none"}},r.a.createElement(u.EuiContextMenu,{initialPanelId:0,panels:O,"data-test-subj":"providerActions"})))}}var P=n(337),R=n(158);const L=r.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isPopoverOpen:f,onDataProviderEdited:g,operator:b,providerId:h,register:v,setIsPopoverOpen:E,timelineId:x,toggleEnabledProvider:j,toggleExcludedProvider:S,toggleTypeProvider:O,displayValue:k,val:T,type:I=y.a.default,wrapperRef:M})=>{const C=Object(i.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),_=Object(l.b)((e=>{var t,n;return x&&null!==(t=null===(n=C(e,x))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:s.m.default})),{isLoading:D}=Object(l.a)((e=>{var t;return null!==(t=C(e,null!=x?x:""))&&void 0!==t?t:R.b})),A=Object(i.useCallback)((()=>{E(!f)}),[f,E]),F=Object(i.useCallback)((()=>{var e;E(!1),null==M||null===(e=M.current)||void 0===e||e.focus()}),[M,E]),N=Object(i.useCallback)((()=>{j(),F()}),[F,j]),L=Object(i.useCallback)((()=>{S(),F()}),[S,F]),z=Object(i.useCallback)((()=>{O(),F()}),[O,F]),[q,B]=Object(i.useState)(!1),$=Object(o.useDispatch)();Object(i.useEffect)((()=>{null!=v&&($(P.a.registerProvider({provider:{...v,and:[]}})),B(!0))}),[q,$,v,B]);const V=Object(i.useCallback)((()=>{q&&null!=v&&$(P.a.unRegisterProvider({id:v.id}))}),[q,$,v]);Object(i.useEffect)((()=>()=>{V()}),[V]);const U=Object(i.useMemo)((()=>r.a.createElement(w,{deleteProvider:D?a.noop:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,providerId:h,togglePopover:A,toggleType:z,displayValue:null!=k?k:String(T),val:T,operator:b,type:I,timelineType:_})),[n,k,u,p,m,D,d,z,b,h,_,A,I,T]);return r.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:F,deleteProvider:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isLoading:D,isOpen:f,onDataProviderEdited:g,operator:b,providerId:h,timelineId:x,timelineType:_,toggleEnabledProvider:N,toggleExcludedProvider:L,toggleTypeProvider:z,value:T,type:I})}));L.displayName="ProviderItemBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(42),l=n(19),c=n(3),u=n(843),d=n(487),p=n(881),m=n(50),f=n(603);const g=e=>{var t,n,a,i,r,o,s;return null!=e&&null!==(t=e.agent)&&void 0!==t&&null!==(n=t.type)&&void 0!==n&&n.includes("endpoint")?((null==e||null===(a=e.host)||void 0===a||null===(i=a.os)||void 0===i?void 0:i.name)||["windows"]).map((e=>e.toLowerCase())):null!==(r=null==e||null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family)&&void 0!==r?r:["windows"]},b=e=>{var t,n;return{comments:[],description:"",entries:e&&e.event&&e.process?[{field:"event.category",operator:"included",type:"match",value:(null!==(t=e.event.category)&&void 0!==t?t:[])[0]},{field:"process.executable",operator:"included",type:"match",value:(null!==(n=e.process.executable)&&void 0!==n?n:[])[0]}]:[{field:"",operator:"included",type:"match",value:""}],item_id:void 0,list_id:f.a,meta:{temporaryUuid:Object(m.v4)()},name:"",namespace_type:"agnostic",tags:["policy:all"],type:"simple",os_types:g(e)}};var y=n(118),h=n(543),v=n(237),E=n(602),x=n(4);const j=Object(r.memo)((({onCancel:e,data:t,...n})=>{var a,m;const f=Object(y.n)(),g=Object(y.i)(),{isLoading:j,mutateAsync:S}=Object(u.a)(E.a.getInstance(g),"create"),[O,k]=Object(r.useState)(),[w,T]=Object(r.useState)(!1),{data:{search:I}}=Object(y.j)().services,M=Object(h.c)({perPage:1e3,onError:e=>{f.addWarning(Object(v.d)(e))}}),[C,_]=Object(r.useState)(b(t)),[D,A]=Object(r.useState)(),[F,N]=Object(r.useState)(!1),P=Object(r.useMemo)((()=>M.isLoading||M.isRefetching),[M]);Object(r.useEffect)((()=>(t&&(async()=>{var e;if(!t||!t._index)return;const n=await Object(c.lastValueFrom)(I.search({params:{index:t._index,body:{query:{match:{_id:t._id}}}}}));k({...t,host:{...t.host,os:{...(null==t||null===(e=t.host)||void 0===e?void 0:e.os)||{},name:[n.rawResponse.hits.hits[0]._source.host.os.name]}}})})(),()=>{_(b())})),[]);const R=Object(r.useCallback)((()=>{P||j||e()}),[j,P,e]),L=Object(r.useCallback)((()=>S(C,{onSuccess:t=>{var n;f.addSuccess((n=t,x.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.creationSuccessToastTitle",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:null==n?void 0:n.name}}))),e()},onError:e=>{f.addError(e,{title:'There was an error creating the new event filter: "{error}"',message:{error:e.message}})}})),[C,e,S,f]),z=Object(r.useCallback)((()=>{if(!D)return L();N(!0)}),[D,L]),q=Object(r.useMemo)((()=>o.a.createElement(l.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:!w||j||!!t&&!O||P,onClick:z,isLoading:P},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.update.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.create",defaultMessage:"Add event filter"}))),[t,O,z,w,j,P]),B=Object(r.useCallback)((e=>{e&&(T(e.isValid),_(e.item),A(e.confirmModalLabels))}),[]),$=Object(l.useGeneratedHtmlId)({prefix:"eventFiltersCreateFlyoutTitle"}),V=Object(r.useMemo)((()=>{if(D){const{title:e,body:t,confirmButton:n,cancelButton:a}=D;return o.a.createElement(d.a,{title:e,body:t,confirmButton:n,cancelButton:a,onSuccess:L,onCancel:()=>N(!1),"data-test-subj":"artifactConfirmModal"})}}),[D,L]);return o.a.createElement(l.EuiFlyout,i()({size:"l",onClose:R,"data-test-subj":"eventFiltersCreateFlyout","aria-labelledby":$},n),o.a.createElement(l.EuiFlyoutHeader,{hasBorder:!0},o.a.createElement(l.EuiTitle,{size:"m"},o.a.createElement("h2",{id:$},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.title.create.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create",defaultMessage:"Add event filter"}))),t?o.a.createElement(l.EuiTextColor,{color:"subdued"},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create.withData",defaultMessage:"Endpoint security"})):null),o.a.createElement(l.EuiFlyoutBody,null,o.a.createElement(p.a,{allowSelectOs:!t,error:void 0,disabled:!1,item:C,mode:"create",onChange:B,policies:null!==(a=null==M||null===(m=M.data)||void 0===m?void 0:m.items)&&void 0!==a?a:[],policiesIsLoading:P})),o.a.createElement(l.EuiFlyoutFooter,null,o.a.createElement(l.EuiFlexGroup,{justifyContent:"spaceBetween"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiButtonEmpty,{isDisabled:j,"data-test-subj":"cancelExceptionAddButton",onClick:R},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.cancel",defaultMessage:"Cancel"}))),o.a.createElement(l.EuiFlexItem,{grow:!1},q))),F&&V)}));j.displayName="EventFiltersFlyout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(7),i=n(118),r=n(165),o=n(4);const s=o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.unknownError",{defaultMessage:"Unknown error while validating ES|QL"}),l=o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.missingMetadataOperatorInQueryError",{defaultMessage:'Queries that don’t use the STATS...BY function (non-aggregating queries) must include the "metadata _id, _version, _index" operator after the source command. For example: FROM logs* metadata _id, _version, _index.'}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.missingIdFieldInQueryError",{defaultMessage:'Queries that don’t use the STATS...BY function (non-aggregating queries) must include the "metadata _id, _version, _index" operator after the source command. For example: FROM logs* metadata _id, _version, _index.  In addition, the metadata properties (_id, _version, and _index)  must be returned in the query response.'});var u=n(853);let d=function(e){return e.INVALID_ESQL="ERR_INVALID_ESQL",e.ERR_MISSING_ID_FIELD_FROM_RESULT="ERR_MISSING_ID_FIELD_FROM_RESULT",e}({});const p=e=>{return{code:d.INVALID_ESQL,message:null!=e&&e.message?(t=e.message,o.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.errorMessage",{values:{message:t},defaultMessage:'Error validating ES|QL: "{message}"'})):s,error:e};var t},m=async(...e)=>{const[{value:t,formData:n,customData:o}]=e,{query:s}=t,m=s.query,{ruleType:g}=n;if(Object(r.d)(g)&&!Object(a.isEmpty)(m))try{var b;const e=null===(b=o.value)||void 0===b?void 0:b.queryClient,t=i.b.get(),{isEsqlQueryAggregating:n,isMissingMetadataOperator:a}=f(m);if(a)return{code:d.ERR_MISSING_ID_FIELD_FROM_RESULT,message:l};const r=await(null==e?void 0:e.fetchQuery(Object(u.a)({esqlQuery:m,search:t.data.search.search})));if(r&&"error"in r)return p(r.error);const s=(null!=r?r:[]).find((({id:e})=>"_id"===e));if(!n&&!s)return{code:d.ERR_MISSING_ID_FIELD_FROM_RESULT,message:c}}catch(e){return p(e)}},f=e=>{const t=/\|\s+stats\s/i.test(e);return{isEsqlQueryAggregating:t,isMissingMetadataOperator:!t&&(n=e,!/(?<!\|[\s\S.]*)\s*metadata[\s\S.]*_id[\s\S.]*/i.test(null==n||null===(a=n.split("|"))||void 0===a?void 0:a[0]))};var n,a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(56),i=n(2),r=n(123),o=n(333),s=n(5),l=n(118);const c=()=>{const{http:e}=Object(a.useKibana)().services,{addSuccess:t,addError:n}=Object(r.a)(),c=Object(i.useRef)(null),u=Object(i.useCallback)(((e=0)=>t(o.w(e))),[t]),d=Object(i.useCallback)((e=>{n(e.message,{title:o.v})}),[n]);return Object(i.useEffect)((()=>{let e=!1;const t=new AbortController;return c.current=async(n,a,i,r)=>{try{r(!0);const o=await(async({assignees:e,ids:t,signal:n})=>l.b.get().http.fetch(s.ib,{method:"POST",version:"2023-10-31",body:JSON.stringify({assignees:e,ids:t}),signal:n}))({assignees:n,ids:a,signal:t.signal});e||(i(),r(!1),u(o.updated))}catch(t){e||(r(!1),d(t))}},()=>{e=!0,t.abort()}}),[e,d,u]),c.current}},function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return T})),n.d(t,"d",(function(){return I})),n.d(t,"b",(function(){return C}));var a=n(19),i=n(756),r=n(2),o=n.n(r),s=n(1380),l=n(119),c=n.n(l),u=n(45),d=n(241),p=n(148),m=n(200),f=n(183),g=n(138),b=n(127),y=n(146),h=n(172),v=n(13),E=n(513),x=n(1292),j=n(122),S=n(132),O=n(1218);const k=({asEmptyButton:e,children:t,dataProviders:n,filters:i,timeRange:s,keepDataView:l,...k})=>{var w,T;const I=Object(u.useDispatch)(),{showAssistantOverlay:M}=Object(d.b)(),[C]=Object(x.a)(),{discoverStateContainer:_,defaultDiscoverAppState:D}=Object(E.a)(),{dataViewId:A}=Object(S.a)(b.SourcererScopeName.timeline),{setDiscoverAppState:F}=Object(O.a)(),N=Object(j.a)("timelineEsqlTabDisabled"),P=Object(u.useSelector)(p.e.signalIndexName),R=Object(u.useSelector)(p.e.defaultDataView),L=Object(r.useCallback)((async()=>{if(M({showOverlay:!1}),n||i){var e,t,a,r;if("esql"===(null==n||null===(e=n[0])||void 0===e?void 0:e.queryType)||"sql"===(null==n||null===(t=n[0])||void 0===t?void 0:t.queryType))return _.current?(null===(a=_.current)||void 0===a||a.appState.set({query:{esql:n[0].kqlQuery}}),await(null===(r=_.current)||void 0===r?void 0:r.appState.replaceUrlState({query:{esql:n[0].kqlQuery}}))):F({...D,query:{esql:n[0].kqlQuery}}),I(Object(v.setActiveTabTimeline)({id:y.c.active,activeTab:y.d.esql})),void I(Object(v.showTimeline)({id:y.c.active,show:!0}));if(n)switch(I(Object(v.updateDataView)({id:y.c.active,dataViewId:"security-solution-default",indexNames:["logs-*"]})),n[0].queryType){case"eql":I(Object(v.updateEqlOptions)({id:y.c.active,field:"query",value:n[0].kqlQuery})),I(Object(v.setActiveTabTimeline)({id:y.c.active,activeTab:y.d.eql})),I(Object(v.showTimeline)({id:y.c.active,show:!0}));break;case"kql":I(Object(v.applyKqlFilterQuery)({id:y.c.active,filterQuery:{kuery:{kind:"kuery",expression:n[0].kqlQuery},serializedQuery:n[0].kqlQuery}})),I(Object(v.setActiveTabTimeline)({id:y.c.active,activeTab:y.d.query})),I(Object(v.showTimeline)({id:y.c.active,show:!0}));break;case"dsl":const e={meta:{type:"custom",disabled:!1,negate:!1,alias:n[0].name,key:"query",value:n[0].kqlQuery,index:null!=A?A:void 0},query:JSON.parse(n[0].kqlQuery)};I(Object(v.setFilters)({id:y.c.active,filters:[e]})),I(Object(v.setActiveTabTimeline)({id:y.c.active,activeTab:y.d.query})),I(Object(v.showTimeline)({id:y.c.active,show:!0}))}i&&I(Object(v.setFilters)({id:y.c.active,filters:i})),l||I(m.d.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:R.id,selectedPatterns:[P||""]})),I(f.b.removeLinkTo([g.a.timeline,g.a.global]))}}),[M,n,i,l,I,_,A,R.id,P,F,D]),z=C?h.i:h.h,q=!C;return"esql"!==(null==n||null===(w=n[0])||void 0===w?void 0:w.queryType)&&"sql"!==(null==n||null===(T=n[0])||void 0===T?void 0:T.queryType)||!N?e?o.a.createElement(a.EuiButtonEmpty,{"aria-label":z,onClick:L,isDisabled:q,color:"text",flush:"both",size:"xs"},o.a.createElement(a.EuiToolTip,{position:"right",content:z},o.a.createElement(o.a.Fragment,null,t))):o.a.createElement(a.EuiButton,c()({"aria-label":z,isDisabled:q,onClick:L},k),o.a.createElement(a.EuiToolTip,{position:"right",content:z},o.a.createElement(o.a.Fragment,null,t))):null};k.displayName="SendToTimelineButton";const w="securityAssistant",T=e=>e.map((e=>`Rule Name:${e.name}\nRule Description:${e.description}`)).join("\n\n"),I=e=>e.filter((({field:e})=>!e.startsWith("signal."))).reduce(((e,{field:t,values:n})=>({...e,[t]:null!=n?n:[]})),{}),M=["kql","dsl","eql","esql","sql"],C=(e,t)=>e.messages.map((({content:n})=>Object(i.a)(t?null!=n?n:"":Object(s.d)({messageContent:null!=n?n:"",replacements:e.replacements})))).map(((t,n)=>t.map(((t,i)=>{var r;return{...t,getControlContainer:()=>document.querySelectorAll(`.message-${n} .euiCodeBlock__controls`)[i],button:M.includes(t.type)?o.a.createElement(k,{asEmptyButton:!0,dataProviders:[{id:"assistant-data-provider",name:`Assistant Query from conversation ${e.id}`,enabled:!0,excluded:!1,queryType:t.type,kqlQuery:null!==(r=t.content)&&void 0!==r?r:"",queryMatch:{field:"host.name",operator:":",value:"test"},and:[]}],keepDataView:!0},o.a.createElement(a.EuiIcon,{type:"timeline"})):null}}))))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(19),o=n(1293),s=n(483);const l="securitySolutionUsers",c=`${l}AvatarsPanel`,u=`${l}AvatarsCountBadge`,d=Object(a.memo)((({userProfiles:e,maxVisibleAvatars:t})=>t&&e.length>t?i.a.createElement(r.EuiToolTip,{position:"top",content:e.map((e=>{var t;return i.a.createElement("div",null,e?null!==(t=e.user.email)&&void 0!==t?t:e.user.username:s.b)})),repositionOnScroll:!0},i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":u,color:"subdued"},e.length)):i.a.createElement(r.EuiFlexGroup,{"data-test-subj":c,alignItems:"center",direction:"row",gutterSize:"xs"},e.map(((e,t)=>{var n,a;return i.a.createElement(r.EuiFlexItem,{key:t,grow:!1},i.a.createElement(o.a,{"data-test-subj":(a=null!==(n=null==e?void 0:e.user.username)&&void 0!==n?n:`Unknown-${t}`,`${l}Avatar-${a}`),user:null==e?void 0:e.user,avatar:null==e?void 0:e.data.avatar,size:"s"}))})))));d.displayName="UsersAvatarsPanel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(4),c=n(42),u=n(41),d=n.n(u),p=n(140),m=n(536),f=n(265),g=n(126),b=n(364),y=n(340);const h=()=>{},v={bordered:!0,showIcons:!1},E={className:"effected-policies-search"},x=d.a.div.withConfig({displayName:"StyledEuiSelectable",componentId:"sc-rb0j09-0"})([".effected-policies-search{border-bottom-left-radius:0;border-bottom-right-radius:0;}.euiSelectableList{border-top-left-radius:0;border-top-right-radius:0;border-top-width:0;}"]),j=d()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemButtonGroup",componentId:"sc-rb0j09-1"})(["@media only screen and (max-width:","){align-items:center;}"],(e=>e.theme.eui.euiBreakpoints.m)),S=d()(s.EuiButtonGroup).withConfig({displayName:"StyledButtonGroup",componentId:"sc-rb0j09-2"})(["display:flex;justify-content:right;.euiButtonGroupButton{padding-right:",";}"],(e=>e.theme.eui.euiSizeL)),O=d.a.div.withConfig({displayName:"EffectivePolicyFormContainer",componentId:"sc-rb0j09-3"})([".policy-name .euiSelectableListItem__text{text-decoration:none !important;color:"," !important;}"],(e=>e.theme.eui.euiTextColor)),k=Object(r.memo)((({isGlobal:e,isPlatinumPlus:t,description:n,isLoading:a=!1,onChange:u,listProps:d,options:k,selected:w=[],disabled:T=!1,"data-test-subj":I,...M})=>{const{getAppUrl:C}=Object(b.a)(),{canReadPolicyManagement:_}=Object(p.a)().endpointPrivileges,D=Object(g.a)(I),A=Object(r.useMemo)((()=>[{id:"globalPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.global",{defaultMessage:"Global"}),iconType:e?"checkInCircleFilled":"empty","data-test-subj":D("global")},{id:"perPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.perPolicy",{defaultMessage:"Per Policy"}),iconType:e?"empty":"checkInCircleFilled","data-test-subj":D("perPolicy")}]),[D,e]),F=Object(r.useMemo)((()=>{const n=new Set(w.map((e=>e.id)));return k.map((a=>({label:a.name,className:"policy-name",prepend:o.a.createElement(s.EuiCheckbox,{id:Object(s.htmlIdGenerator)()(),onChange:h,checked:n.has(a.id),disabled:e||!t||T,"data-test-subj":`policy-${a.id}-checkbox`}),append:_?o.a.createElement(m.a,{href:C({path:Object(f.j)(a.id)}),appPath:Object(f.j)(a.id),target:"_blank","data-test-subj":D("policyLink")},o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.viewPolicyLinkLabel",defaultMessage:"View policy"})):null,policy:a,checked:n.has(a.id)?"on":void 0,disabled:e||!t||T,"data-test-subj":`policy-${a.id}`}))).sort((({label:e},{label:t})=>e.localeCompare(t)))}),[_,T,C,D,e,t,k,w]),N=Object(r.useCallback)((t=>{u({isGlobal:e,selected:t.filter((e=>e.checked)).map((e=>e.policy))})}),[e,u]),P=Object(r.useCallback)((e=>{u({isGlobal:"globalPolicy"===e,selected:w})}),[u,w]),R=Object(r.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]);return o.a.createElement(O,null,o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.assignmentSectionTitle",defaultMessage:"Assignment"}))),o.a.createElement(s.EuiSpacer,{size:"xs"}),o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:2},o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,n||l.i18n.translate("xpack.securitySolution.effectedPolicySelect.assignmentSectionDescription",{defaultMessage:"Assign globally across all policies, or assign it to specific policies."})))),o.a.createElement(j,{grow:1},o.a.createElement(s.EuiFormRow,{fullWidth:!0,isDisabled:T},o.a.createElement(S,{legend:"Global Policy Toggle",options:A,idSelected:e?"globalPolicy":"perPolicy",onChange:P,color:"primary","data-test-subj":D("byPolicyGlobalButtonGroup"),isDisabled:T})))),o.a.createElement(s.EuiSpacer,null),!e&&(a?o.a.createElement(y.a,{size:"l","data-test-subj":D("policiesLoader")}):o.a.createElement(s.EuiFormRow,{fullWidth:!0},o.a.createElement(x,null,o.a.createElement(s.EuiSelectable,i()({},M,{options:F,listProps:d||v,onChange:N,searchProps:E,searchable:!0,"data-test-subj":D("policiesSelectable")}),R)))))}));k.displayName="EffectedPolicySelect"},function(e,t,n){"use strict";n.d(t,"a",(function(){return X}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(44),l=n(19),c=n(11),u=n(70),d=n(290),p=n(227),m=n(663),f=n(867),g=n(791),b=n(944),y=n(662),h=n(443),v=n(874),E=n(248),x=n(303),j=n(858),S=n(690),O=n(527),k=n(242),w=n(689),T=n(408),I=n(368),M=n(946),C=n(772),_=n(152);const D={flexGroup:_.css`
    max-width: 600px;
  `},A={content:_.css`
    white-space: pre-wrap;
  `},F=({savedQueryName:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"savedQueryNamePropertyValue"},e),N=({filters:e,dataViewId:t,index:n,"data-test-subj":a})=>{const i=Object(c.mapAndFlattenFilters)(e),{indexPattern:r}=Object(v.b)({dataSourceType:t?E.a.DataView:E.a.IndexPatterns,index:null!=n?n:[],dataViewId:t}),s=D;return o.a.createElement(l.EuiFlexGroup,{"data-test-subj":a,className:s.flexGroup,wrap:!0,responsive:!1,gutterSize:"xs"},o.a.createElement(u.FilterItems,{filters:i,indexPatterns:[r],readOnly:!0}))},P=({query:e,"data-test-subj":t="query"})=>{const n=A;return o.a.createElement("div",{"data-test-subj":t,className:n.content},e)},R=({index:e})=>o.a.createElement(w.a,{badges:e,"data-test-subj":"indexPropertyValue"}),L=({dataViewId:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"dataViewIdPropertyValue"},e),z=({dataViewId:e})=>{const{data:t}=Object(k.c)().services,[n,a]=o.a.useState(""),[i,r]=o.a.useState(!1);return o.a.useEffect((()=>{t.dataViews.get(e).then((e=>{a(e.getIndexPattern())})).catch((()=>{r(!0)}))}),[t,e]),i?o.a.createElement(l.EuiText,{size:"s"},I.h):n?o.a.createElement(l.EuiText,{size:"s","data-test-subj":"dataViewIndexPatternPropertyValue"},n):o.a.createElement(l.EuiLoadingSpinner,{size:"m"})},q=({threshold:e})=>o.a.createElement("div",{"data-test-subj":"thresholdPropertyValue"},Object(s.isEmpty)(e.field[0])?`${m.y} >= ${e.value}`:`${m.x} ${Array.isArray(e.field)?e.field.join(","):e.field} >= ${e.value}`),B=({anomalyThreshold:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"anomalyThresholdPropertyValue"},e),$=({jobIds:e,isInteractive:t})=>{const{jobs:n}=Object(O.a)();if(t)return o.a.createElement(j.a,{jobIds:e});const a=n.filter((t=>e.includes(t.id)));return o.a.createElement(o.a.Fragment,null,a.map((e=>{var t;return o.a.createElement(S.a,{key:e.id,jobId:e.id,jobName:null===(t=e.customSettings)||void 0===t?void 0:t.security_app_display_name})})))},V=({type:e})=>o.a.createElement(l.EuiText,{size:"s"},(e=>{switch(e){case"machine_learning":return m.o;case"query":case"saved_query":return m.r;case"threshold":return m.z;case"eql":return m.j;case"esql":return m.l;case"threat_match":return m.v;case"new_terms":return m.p;default:return Object(p.a)(e)}})(e)),U=({requiredFields:e})=>{const t=(()=>{const{euiTheme:e}=Object(l.useEuiTheme)(),{font:t}=e;return Object(r.useMemo)((()=>{var e;return{fieldNameText:_.css`
        font-family: ${null!==(e=t.familyCode)&&void 0!==e?e:t.family};
        display: inline;
      `}}),[t.familyCode,t.family])})();return o.a.createElement(l.EuiFlexGrid,{"data-test-subj":"requiredFieldsPropertyValue",gutterSize:"s"},e.map(((n,a)=>o.a.createElement(l.EuiFlexItem,{grow:!1,key:n.name},o.a.createElement(l.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(C.a,{type:n.type,"data-test-subj":"field-type-icon"})),o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiText,{"data-test-subj":"requiredFieldsPropertyValueItem",className:t.fieldNameText,grow:!1,size:"xs"},` ${n.name}${a+1!==e.length?", ":""}`)))))))},G=({timelineTitle:e})=>o.a.createElement(l.EuiText,{size:"s","data-test-subj":"timelineTemplatePropertyValue"},e),H=({threatIndex:e})=>o.a.createElement(w.a,{badges:e,"data-test-subj":"threatIndexPropertyValue"}),W=({threatMapping:e})=>{const t=e.reduce(((e,t,n,{length:a})=>{const i=t.entries.reduce(((e,t,n,{length:a})=>1===a?`${t.field} ${y.d} ${t.value}`:0===n?`(${t.field} ${y.d} ${t.value})`:`${e} ${y.a} (${t.field} ${y.d} ${t.value})`),"");return 1===a?`${i}`:0===n?`(${i})`:`${e} ${y.e} (${i})`}),"");return o.a.createElement(l.EuiText,{size:"s","data-test-subj":"threatMappingPropertyValue"},t)},Q=({fields:e})=>o.a.createElement(w.a,{badges:e,"data-test-subj":"alertSuppressionGroupByPropertyValue"}),Y=({duration:e})=>{const t=e?`${e.value}${e.unit}`:m.b;return o.a.createElement(l.EuiText,{size:"s","data-test-subj":"alertSuppressionDurationPropertyValue"},t)},K=({missingFieldsStrategy:e})=>{const t=e===d.a.suppress?m.c:m.a;return o.a.createElement(l.EuiText,{size:"s","data-test-subj":"alertSuppressionMissingFieldsPropertyValue"},t)},J=({newTermsFields:e})=>o.a.createElement(w.a,{badges:e,"data-test-subj":"newTermsFieldsPropertyValue"}),Z=({historyWindowStart:e})=>{const t=e?Object(x.b)(e):"7d";return o.a.createElement(l.EuiText,{size:"s","data-test-subj":`newTermsWindowSizePropertyValue-${e}`},t)},X=({rule:e,isInteractive:t=!1,columnWidths:n=T.b,dataTestSubj:a,...r})=>{var s,c;const{savedQuery:u}=Object(b.a)({savedQueryId:"saved_query"===e.type?e.saved_id:"",ruleType:e.type}),{isSuppressionEnabled:d}=Object(M.a)(e.type),p=((e,t,n,a)=>{var i;const r=[];return"index"in e&&e.index&&e.index.length>0&&r.push({title:o.a.createElement("span",{"data-test-subj":"indexPropertyTitle"},I.p),description:o.a.createElement(R,{index:e.index})}),"data_view_id"in e&&e.data_view_id&&r.push({title:o.a.createElement("span",{"data-test-subj":"dataViewIdPropertyTitle"},I.g),description:o.a.createElement(L,{dataViewId:e.data_view_id})},{title:o.a.createElement("span",{"data-test-subj":"dataViewIndexPatternPropertyTitle"},I.i),description:o.a.createElement(z,{dataViewId:e.data_view_id})}),n&&(r.push({title:o.a.createElement("span",{"data-test-subj":"savedQueryNamePropertyTitle"},m.u),description:o.a.createElement(F,{savedQueryName:n.attributes.title})}),n.attributes.filters&&r.push({title:o.a.createElement("span",{"data-test-subj":"savedQueryFiltersPropertyTitle"},m.s),description:o.a.createElement(N,{filters:n.attributes.filters,"data-test-subj":"savedQueryFiltersPropertyValue"})}),"string"==typeof n.attributes.query.query&&r.push({title:o.a.createElement("span",{"data-test-subj":"savedQueryContentPropertyTitle"},m.t),description:o.a.createElement(P,{query:n.attributes.query.query,"data-test-subj":"savedQueryContentPropertyValue"})})),"filters"in e&&null!==(i=e.filters)&&void 0!==i&&i.length&&r.push({title:o.a.createElement("span",{"data-test-subj":"filtersPropertyTitle"},m.m),description:o.a.createElement(N,{filters:e.filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"filtersPropertyValue"})}),"query"in e&&e.query&&("eql"===e.type?r.push({title:o.a.createElement("span",{"data-test-subj":"eqlQueryPropertyTitle"},m.g),description:o.a.createElement(P,{query:e.query,"data-test-subj":"eqlQueryPropertyValue"})}):"esql"===e.type?r.push({title:o.a.createElement("span",{"data-test-subj":"esqlQueryPropertyTitle"},m.k),description:o.a.createElement(P,{query:e.query,"data-test-subj":"esqlQueryPropertyValue"})}):r.push({title:o.a.createElement("span",{"data-test-subj":"customQueryPropertyTitle"},m.q),description:o.a.createElement(P,{query:e.query,"data-test-subj":"customQueryPropertyValue"})})),e.type&&r.push({title:I.G,description:o.a.createElement(V,{type:e.type})}),"anomaly_threshold"in e&&e.anomaly_threshold&&r.push({title:o.a.createElement("span",{"data-test-subj":"anomalyThresholdPropertyTitle"},I.b),description:o.a.createElement(B,{anomalyThreshold:e.anomaly_threshold})}),"machine_learning_job_id"in e&&r.push({title:o.a.createElement("span",{"data-test-subj":"mlJobPropertyTitle"},I.v),description:o.a.createElement($,{jobIds:e.machine_learning_job_id,isInteractive:t})}),e.related_integrations&&e.related_integrations.length>0&&r.push({title:o.a.createElement("span",{"data-test-subj":"relatedIntegrationsPropertyTitle"},I.B),description:o.a.createElement(f.b,{relatedIntegrations:e.related_integrations,dataTestSubj:"relatedIntegrationsPropertyValue"})}),e.required_fields&&e.required_fields.length>0&&r.push({title:o.a.createElement("span",{"data-test-subj":"requiredFieldsPropertyTitle"},I.C),description:o.a.createElement(U,{requiredFields:e.required_fields})}),r.push({title:o.a.createElement("span",{"data-test-subj":"timelineTemplatePropertyTitle"},I.V),description:o.a.createElement(G,{timelineTitle:e.timeline_title||h.b})}),"threshold"in e&&e.threshold&&r.push({title:o.a.createElement("span",{"data-test-subj":"thresholdPropertyTitle"},I.U),description:o.a.createElement(q,{threshold:e.threshold})}),"threat_index"in e&&e.threat_index&&r.push({title:o.a.createElement("span",{"data-test-subj":"threatIndexPropertyTitle"},I.R),description:o.a.createElement(H,{threatIndex:e.threat_index})}),"threat_mapping"in e&&e.threat_mapping&&r.push({title:o.a.createElement("span",{"data-test-subj":"threatMappingPropertyTitle"},I.T),description:o.a.createElement(W,{threatMapping:e.threat_mapping})}),"threat_filters"in e&&e.threat_filters&&e.threat_filters.length>0&&r.push({title:o.a.createElement("span",{"data-test-subj":"threatFiltersPropertyTitle"},I.Q),description:o.a.createElement(N,{filters:e.threat_filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"threatFiltersPropertyValue"})}),"threat_query"in e&&e.threat_query&&r.push({title:o.a.createElement("span",{"data-test-subj":"threatQueryPropertyTitle"},m.w),description:o.a.createElement(P,{query:e.threat_query,"data-test-subj":"threatQueryPropertyValue"})}),"new_terms_fields"in e&&e.new_terms_fields&&e.new_terms_fields.length>0&&r.push({title:o.a.createElement("span",{"data-test-subj":"newTermsFieldsPropertyTitle"},I.y),description:o.a.createElement(J,{newTermsFields:e.new_terms_fields})}),"history_window_start"in e&&r.push({title:o.a.createElement("span",{"data-test-subj":"newTermsWindowSizePropertyTitle"},I.o),description:o.a.createElement(Z,{historyWindowStart:e.history_window_start})}),a&&"alert_suppression"in e&&e.alert_suppression&&("group_by"in e.alert_suppression&&r.push({title:o.a.createElement("span",{"data-test-subj":"alertSuppressionGroupByPropertyTitle"},o.a.createElement(g.a,{label:I.M,ruleType:e.type})),description:o.a.createElement(Q,{fields:e.alert_suppression.group_by})}),r.push({title:o.a.createElement("span",{"data-test-subj":"alertSuppressionDurationPropertyTitle"},o.a.createElement(g.a,{label:I.N,ruleType:e.type})),description:o.a.createElement(Y,{duration:e.alert_suppression.duration})}),"missing_fields_strategy"in e.alert_suppression&&r.push({title:o.a.createElement("span",{"data-test-subj":"alertSuppressionMissingFieldPropertyTitle"},o.a.createElement(g.a,{label:I.L,ruleType:e.type})),description:o.a.createElement(K,{missingFieldsStrategy:e.alert_suppression.missing_fields_strategy})})),r})(e,t,u,d);return o.a.createElement("div",{"data-test-subj":a},o.a.createElement(l.EuiDescriptionList,i()({type:null!==(s=r.type)&&void 0!==s?s:"column",rowGutterSize:null!==(c=r.rowGutterSize)&&void 0!==c?c:"m",listItems:p,columnWidths:n,"data-test-subj":"listItemColumnStepRuleDescription"},r)))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return R})),n.d(t,"a",(function(){return L}));var a=n(2),i=n.n(a),r=n(19),o=n(7),s=n(45),l=n(1334),c=n(44),u=n(1630),d=n(379),p=n(355),m=n(131),f=n(930),g=n(118),b=n(571),y=n(343),h=n(140),v=n(180),E=n(546),x=n(172),j=n(148),S=n(381),O=n(380),k=n(532),w=n(962),T=n(667),I=n(933),M=n(928),C=n(936),_=n(432),D=n(929),A=n(973),F=n(931),N=n(932);const P=({ariaLabel:e=x.K,ariaRowindex:t,columnValues:n,disabled:l,ecsRowData:d,onRuleChange:y,scopeId:E,refetch:S})=>{var O,k,P,R,z,q,B,$,V,U,G,H,W,Q,Y,K,J,Z,X;const[ee,te]=Object(a.useState)(!1),[ne,ae]=Object(a.useState)(!1),ie=Object(a.useCallback)((()=>{te(!1)}),[]),re=Object(a.useMemo)((()=>j.d.globalQuery()),[]),oe=Object(a.useMemo)((()=>j.d.timelineQueryByIdSelector()),[]),se=Object(s.useSelector)((e=>re(e))),le=Object(s.useSelector)((e=>oe(e,E))),ce=null!=d&&null!==(ue=d.kibana)&&void 0!==ue&&ue.alert?null==d?void 0:d._id:null;var ue;const de=Object(c.get)(0,null==d||null===(O=d.kibana)||void 0===O||null===(k=O.alert)||void 0===k||null===(P=k.rule)||void 0===P?void 0:P.uuid),pe=Object(c.get)(0,null==d||null===(R=d.kibana)||void 0===R||null===(z=R.alert)||void 0===z||null===(q=z.rule)||void 0===q?void 0:q.rule_id),me=Object(c.get)(0,null==d||null===(B=d.kibana)||void 0===B||null===($=B.alert)||void 0===$||null===(V=$.rule)||void 0===V?void 0:V.name),fe=[u.b.alertsOnAlertsPage,u.b.alertsOnRuleDetailsPage].includes(E),{addToCaseActionItems:ge}=Object(A.a)({ecsData:d,onMenuItemClick:ie,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:""),ariaLabel:Object(_.a)({ariaRowindex:t,columnValues:n}),isInDetections:fe,refetch:S}),{loading:be,canWriteEventFilters:ye}=Object(h.a)().endpointPrivileges,he=Object(a.useMemo)((()=>!be&&ye),[ye,be]),ve=Object(c.get)(0,null==d||null===(U=d.kibana)||void 0===U||null===(G=U.alert)||void 0===G?void 0:G.workflow_status),Ee=Object(a.useMemo)((()=>{var e;return-1!==Object(o.indexOf)(null===(e=d.event)||void 0===e?void 0:e.kind,"event")}),[d]),xe=Object(a.useMemo)((()=>{var e,t;return null===(e=d.agent)||void 0===e||null===(t=e.type)||void 0===t?void 0:t.includes("endpoint")}),[d]),je=Object(a.useMemo)((()=>Ee&&xe),[Ee,xe]),Se=Object(a.useMemo)((()=>{const e=Object(c.getOr)([],"kibana.alert.original_event.module",d),t=Object(c.getOr)([],"kibana.alert.original_event.kind",d);return e.includes("endpoint")&&t.includes("alert")}),[d]),Oe=Object(a.useMemo)((()=>E===u.b.hostsPageEvents||E===u.b.usersPageEvents),[E]),ke=Object(a.useCallback)((()=>{te(!ee)}),[ee]),we=Object(a.useCallback)((()=>{te(!1)}),[]),Te=Object(a.useMemo)((()=>i.a.createElement(r.EuiToolTip,{position:"top",content:x.K},i.a.createElement(r.EuiButtonIcon,{"aria-label":e,"data-test-subj":"timeline-context-menu-button",size:"s",iconType:"boxesHorizontal","data-popover-open":ee,onClick:ke,isDisabled:l}))),[l,ke,e,ee]),Ie=Object(a.useCallback)((()=>{const e=e=>{e.forEach((e=>e.refetch&&e.refetch()))};Object(m.isActiveTimeline)(null!=E?E:"")?e([le]):e(se),S&&S()}),[E,se,le,S]),Me=null!==(H=null===(W=d["kibana.alert.rule.parameters"])||void 0===W?void 0:W.index)&&void 0!==H?H:null==d||null===(Q=d.signal)||void 0===Q||null===(Y=Q.rule)||void 0===Y?void 0:Y.index,Ce=null!==(K=null===(J=d["kibana.alert.rule.parameters"])||void 0===J?void 0:J.data_view_id)&&void 0!==K?K:null==d||null===(Z=d.signal)||void 0===Z||null===(X=Z.rule)||void 0===X?void 0:X.data_view_id,{exceptionFlyoutType:_e,openAddExceptionFlyout:De,onAddExceptionCancel:Ae,onAddExceptionConfirm:Fe,onAddExceptionTypeClick:Ne}=Object(I.a)({refetch:Ie,onRuleChange:y,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:"")}),{closeAddEventFilterModal:Pe,isAddEventFilterModalOpen:Re,onAddEventFilterClick:Le}=Object(C.a)(),{actionItems:ze}=Object(T.a)({alertStatus:ve,eventId:null==d?void 0:d._id,scopeId:E,refetch:Ie,closePopover:we}),qe=Object(a.useCallback)((e=>{Ne(e),we()}),[we,Ne]),Be=Object(a.useCallback)((()=>{Le(),we()}),[we,Le]),{exceptionActionItems:$e}=Object(M.a)({isEndpointAlert:Se,onAddExceptionTypeClick:qe}),{eventFilterActionItems:Ve}=Object(D.a)({onAddEventFilterClick:Be,disabled:!je||!Oe,tooltipMessage:Oe?void 0:x.f}),Ue=Object(a.useMemo)((()=>{var e;return Object(c.get)(0,null==d||null===(e=d.agent)||void 0===e?void 0:e.id)}),[d]),Ge=Object(a.useCallback)((()=>{ae((e=>!e)),te(!1)}),[]),{osqueryActionItems:He}=(({handleClick:e})=>{const t=Object(a.useMemo)((()=>Object(f.a)({handleClick:e})),[e]),n=Object(g.j)().services.application.capabilities.osquery;return{osqueryActionItems:null!=n&&n.writeLiveQueries||null!=n&&n.runSavedQueries?[t]:[]}})({handleClick:Ge}),{alertTagsItems:We,alertTagsPanels:Qe}=Object(F.a)({closePopover:we,ecsRowData:d,refetch:Ie}),{alertAssigneesItems:Ye,alertAssigneesPanels:Ke}=Object(N.a)({closePopover:we,ecsRowData:d,refetch:Ie}),Je=Object(a.useMemo)((()=>!Ee&&de?[...ge,...ze,...We,...Ye,...$e,...Ue?He:[]]:[...ge,...he?Ve:[],...Ue?He:[]]),[Ee,de,ge,ze,$e,Ue,He,Ve,he,We,Ye]),Ze=Object(a.useMemo)((()=>[{id:0,items:Je},...Qe,...Ke]),[Qe,Ke,Je]),Xe=Object(a.useMemo)((()=>i.a.createElement(b.a,{agentId:Ue,defaultValues:ce?{alertIds:[ce]}:void 0,onClose:Ge,ecsData:d})),[Ue,ce,d,Ge]);return i.a.createElement(i.a.Fragment,null,Je.length>0&&i.a.createElement("div",{key:"actions-context-menu"},i.a.createElement(v.l,{textAlign:"center",width:p.b},i.a.createElement(r.EuiPopover,{id:"singlePanel",button:Te,isOpen:ee,closePopover:we,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},i.a.createElement(r.EuiContextMenu,{size:"s",initialPanelId:0,panels:Ze,"data-test-subj":"actions-context-menu"})))),De&&de&&pe&&null!=me&&null!=(null==d?void 0:d._id)&&i.a.createElement(L,{ruleId:de,ruleRuleId:pe,ruleIndices:Me,ruleDataViewId:Ce,ruleName:me,exceptionListType:_e,eventId:null==d?void 0:d._id,onCancel:Ae,onConfirm:Fe,alertStatus:ve}),Re&&null!=d&&i.a.createElement(w.a,{data:d,onCancel:Pe}),ne&&Ue&&null!=d&&Xe)},R=i.a.memo(P),L=({ruleId:e,ruleRuleId:t,ruleIndices:n,ruleDataViewId:r,ruleName:o,exceptionListType:s,eventId:c,onCancel:u,onConfirm:p,alertStatus:m})=>{var f;const{loading:g,signalIndexName:b}=Object(k.a)(),{rule:h,loading:v}=Object(d.a)(e),{loading:x,data:j}=Object(S.a)({query:Object(y.a)(c),indexName:b,queryName:O.a.ADD_EXCEPTION_FLYOUT}),w=Object(a.useMemo)((()=>{if(!1===x){const e=null==j?void 0:j.hits.hits[0];if(!e)return;const{_id:t,_index:n,_source:a}=e;return{...a,_id:t,_index:n}}}),[null==j?void 0:j.hits.hits,x]),T=Object(a.useMemo)((()=>{var e,t,a;return null!=w&&null!=(null===(e=w["kibana.alert.rule.parameters"])||void 0===e?void 0:e.index)?Array.isArray(w["kibana.alert.rule.parameters"].index)?w["kibana.alert.rule.parameters"].index:[w["kibana.alert.rule.parameters"].index]:null!=w&&null!=(null==w||null===(t=w.signal)||void 0===t||null===(a=t.rule)||void 0===a?void 0:a.index)?Array.isArray(w.signal.rule.index)?w.signal.rule.index:[w.signal.rule.index]:n}),[w,n]),I=Object(a.useMemo)((()=>{var e;return null!=w&&null!=(null===(e=w["kibana.alert.rule.parameters"])||void 0===e?void 0:e.data_view_id)?w["kibana.alert.rule.parameters"].data_view_id:r}),[w,r]),M=Object(a.useMemo)((()=>h?[h]:null),[h]),C=null==w||null===(f=w["kibana.alert.rule.parameters"])||void 0===f?void 0:f.type,_=x&&g||null==w||!("esql"===C||"machine_learning"===C)&&null==T&&null==I;return _||v?null:i.a.createElement(E.a,{rules:M,isEndpointItem:s===l.a.ENDPOINT,alertData:w,isAlertDataLoading:_||v,alertStatus:m,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:u,onConfirm:p})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g}));var a=n(4),i=n(157),r=n(19),o=n(2),s=n.n(o),l=n(178);const c=s.a.createElement(r.EuiText,{color:"subdued",size:"xs"},l.uc);var u=n(356),d=n(732);const{emptyField:p}=i.j,m={author:{type:i.a.COMBO_BOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:c,validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:i.i.ARRAY_ITEM,isBlocking:!1}]},name:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:i.a.TEXTAREA,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:i.a.CHECKBOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:c},maxSignals:{type:i.a.NUMBER,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.fieldMaxAlertsLabel",{defaultMessage:"Max alerts per run"}),labelAppend:c},isAssociatedToEndpointList:{type:i.a.CHECKBOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:c},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:c,validations:[{validator:(...e)=>{const[{value:t,path:n}]=e;let a=!1;return t.forEach((e=>{Object(u.c)(e)&&(a=!0)})),a?{code:"ERR_FIELD_FORMAT",path:n,message:d.l}:void 0}}]},falsePositives:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:c},investigationFields:{type:i.a.COMBO_BOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldCustomHighlightedFieldsLabel",{defaultMessage:"Custom highlighted fields"}),labelAppend:c},license:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:c},ruleNameOverride:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:c},threat:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK™"}),labelAppend:c},threatIndicatorPath:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:c},timestampOverride:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:c},timestampOverrideFallbackDisabled:{type:i.a.CHECKBOX,defaultValue:!1,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideFallbackDisabledLabel",{defaultMessage:"Do not use @timestamp as a fallback timestamp field"}),labelAppend:c},tags:{type:i.a.COMBO_BOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:c,validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:i.i.ARRAY_ITEM,isBlocking:!1}]},note:{type:i.a.TEXTAREA,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:c},setup:{type:i.a.TEXTAREA,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.setupLabel",{defaultMessage:"Setup guide"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.setupHelpText",{defaultMessage:"Provide instructions on rule prerequisites such as required integrations, configuration steps, and anything else needed for the rule to work correctly."}),labelAppend:c}},f={type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:i.i.FIELD}]},g={...m,threatIndicatorPath:f}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(7),i=n(2),r=n.n(i),o=n(188),s=n.n(o),l=n(11),c=n(70),u=n(12),d=n(118);const p=e=>"esql"in e?{query:e.esql,language:"esql"}:e,m=e=>null!=e&&"object"==typeof e&&Object.hasOwn(e,"getName"),f=Object(i.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:o,isLoading:f=!1,isRefreshPaused:g,filterQuery:b,filterManager:y,filters:h,onChangedQuery:v,onSubmitQuery:E,refreshInterval:x,savedQuery:j,onSavedQuery:S,dataTestSubj:O,displayStyle:k,isDisabled:w})=>{const{data:T}=Object(d.j)().services,[I,M]=Object(i.useState)(),C=Object(i.useCallback)((e=>{if(null!=e.query&&!s()(e.query,b)){const t=p(e.query);E(t)}}),[b,E]),_=Object(i.useCallback)((e=>{if(v&&null!=e.query&&!s()(e.query,b)){const t=p(e.query);v(t)}}),[b,v]),D=Object(i.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;E(t,a),y.setFilters(n||[]),S(e)}),[y,E,S]),A=Object(i.useCallback)((()=>{null!=j&&(E({query:"",language:j.attributes.query.language}),y.setFilters([]),S(void 0))}),[y,E,S,j]),F=Object(i.useCallback)((e=>{y.setFilters(e)}),[y]),N="esql"===(null==b?void 0:b.language),P=Object(i.useMemo)((()=>N&&"string"==typeof b.query?{esql:b.query}:b),[b,N]);Object(i.useEffect)((()=>{let e;return m(o)?M(o):N||(async()=>{e=await T.dataViews.create({id:o.title,title:o.title}),M(e)})(),()=>{var t,n;null!==(t=e)&&void 0!==t&&t.id&&T.dataViews.clearInstanceCache(null===(n=e)||void 0===n?void 0:n.id)}}),[T.dataViews,o,N]);const R=Object(i.useMemo)((()=>{if(m(o)||N)return h;const e=Object(a.cloneDeep)(h);return e.forEach((e=>e.meta.index=o.title)),e}),[h,o,N]),L=Object(i.useMemo)((()=>new l.TimeHistory(new u.Storage(localStorage))),[]),z=Object(i.useMemo)((()=>null!=I?[I]:[]),[I]);return r.a.createElement(c.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:R,indexPatterns:z,isLoading:f,isRefreshPaused:g,query:P,onClearSavedQuery:A,onFiltersUpdated:F,onQueryChange:_,onQuerySubmit:C,onSaved:S,onSavedQueryUpdated:D,refreshInterval:x,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:L,dataTestSubj:O,savedQuery:j,displayStyle:k,isDisabled:w})}));f.displayName="QueryBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(118),r=n(122);const o=()=>{const{uiSettings:e}=Object(i.j)().services,t=null==e?void 0:e.get("enableESQL"),n=Object(r.a)("timelineEsqlTabDisabled"),o=!Object(r.a)("esqlRulesDisabled")&&t;return Object(a.useMemo)((()=>({isEsqlAdvancedSettingEnabled:t,isEsqlRuleTypeEnabled:o,isTimelineEsqlEnabledByFeatureFlag:!n})),[t,n,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(65),o=n(36),s=n(170),l=n(305);const c=()=>document.querySelector('[tour-step="create-case-submit"]'),u=()=>{const[e,t]=Object(a.useState)(s.a.createCase),n=Object(a.useCallback)((()=>{var e;null===(e=c())||void 0===e||e.scrollIntoView()}),[]),r=Object(a.useCallback)((()=>{t(s.a.submitCase),n(),setTimeout((()=>{var e;null===(e=c())||void 0===e||e.focus()}),500)}),[n]);return i.a.createElement(i.a.Fragment,null,e===s.a.createCase&&i.a.createElement(l.a,{onClick:r,step:s.a.createCase,tourId:s.b.alertsCases}),e===s.a.submitCase&&i.a.createElement(l.a,{step:s.a.submitCase,tourId:s.b.alertsCases}))};var d=n(256),p=n(118),m=n(172);const f=({onMenuItemClick:e,ariaLabel:t,ecsData:n,nonEcsData:l,onSuccess:c,isActiveTimelines:f,isInDetections:g,refetch:b})=>{const{cases:y}=Object(p.j)().services,h=y.helpers.canUseCases([o.APP_ID]),v=Object(a.useMemo)((()=>{var e,t;return null==n||null===(e=n.event)||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.includes("signal")}),[n]),E=Object(a.useMemo)((()=>{var e,t;return null!=n&&n._id?[{alertId:null!==(e=null==n?void 0:n._id)&&void 0!==e?e:"",index:null!==(t=null==n?void 0:n._index)&&void 0!==t?t:"",type:r.AttachmentType.alert,rule:y.helpers.getRuleIdFromEvent({ecs:n,data:null!=l?l:[]})}]:[]}),[y.helpers,n,l]),{activeStep:x,incrementStep:j,setStep:S,isTourShown:O}=Object(d.b)(),k=Object(a.useCallback)((()=>{c&&c(),b&&b()}),[c,b]),w=Object(a.useCallback)((async()=>{O(s.b.alertsCases)&&S(s.b.alertsCases,s.a.viewCase)}),[S,O]),T=Object(a.useMemo)((()=>!O(s.b.alertsCases)||x!==s.a.addAlertToCase&&x!==s.a.createCase&&x!==s.a.submitCase?{}:{initialValue:s.f}),[x,O]),I=Object(a.useMemo)((()=>({onClose:e,onSuccess:k,afterCaseCreated:w,...T})),[e,k,w,T]),M=y.hooks.useCasesAddToNewCaseFlyout(I),C=Object(a.useMemo)((()=>({onClose:e,onSuccess:k})),[e,k]),_=y.hooks.useCasesAddToExistingCaseModal(C),D=Object(a.useCallback)((()=>{e(),M.open({attachments:E,...O(s.b.alertsCases)?{headerContent:i.a.createElement(u,null)}:{}}),O(s.b.alertsCases)&&x===s.a.addAlertToCase&&j(s.b.alertsCases)}),[e,M,E,O,x,j]),A=Object(a.useCallback)((()=>{e(),_.open({getAttachments:()=>E})}),[E,e,_]);return{addToCaseActionItems:Object(a.useMemo)((()=>(f||g)&&h.create&&h.read&&v?[{"aria-label":t,"data-test-subj":"add-to-existing-case-action",key:"add-to-existing-case-action",onClick:A,size:"s",name:m.k},{"aria-label":t,"data-test-subj":"add-to-new-case-action",key:"add-to-new-case-action",onClick:D,size:"s",name:m.l}]:[]),[t,A,D,h.create,h.read,g,f,v]),handleAddToNewCaseClick:D,handleAddToExistingCaseClick:A}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n(7),r=n(940),o=n.n(r);const s=(e,t)=>null==t?`${Object(i.capitalize)(e)}`:`${Object(i.capitalize)(e)} ${Object(i.capitalize)(t)}`,l=e=>{var t;return null!==(t=o.a.valid(o.a.coerce(e)))&&void 0!==t?t:""},c=(e,t,n)=>`app/integrations/detail/${n?`${e}-${n}`:e}/overview${t?`?integration=${t}`:""}`;var u=n(1323);const d=e=>{const{data:t}=Object(u.a)();return Object(a.useMemo)((()=>{const n=((e,t)=>((e,t)=>{const n=new Map((null!=t?t:[]).map((e=>{var t;return[`${e.package_name}${null!==(t=e.integration_name)&&void 0!==t?t:""}`,e]})));return e.map((e=>{var t;const a=`${e.package}${null!==(t=e.integration)&&void 0!==t?t:""}`,i=n.get(a);return i?{related:e,found:i,isLoaded:!0}:{related:e,isLoaded:!1}}))})(e,t).map((e=>(e=>{var t,n,a;const{related:i,found:r,isLoaded:u}=e,d=i.package,p=null!==(t=i.integration)&&void 0!==t?t:null,m=i.version;if(!u){const e=s(d,p),t=l(m);return{packageName:d,integrationName:p,integrationTitle:e,requiredVersion:m,targetVersion:t,targetUrl:c(d,p,t),installationStatus:{isKnown:!1}}}if(!r){const e=s(d,p),t=l(m);return{packageName:d,integrationName:p,integrationTitle:e,requiredVersion:m,targetVersion:t,targetUrl:c(d,p,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}const f=null!==(n=r.integration_title)&&void 0!==n?n:r.package_title,g=null!==(a=r.installed_package_version)&&void 0!==a?a:"",b=!g||o.a.satisfies(g,m,{includePrerelease:!0}),y=g&&b?g:l(m);return{packageName:d,integrationName:p,integrationTitle:f,requiredVersion:m,targetVersion:y,targetUrl:c(d,p,y),installationStatus:{isKnown:!0,isInstalled:r.is_installed,isEnabled:r.is_enabled,isVersionMismatch:!b,installedVersion:g}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:n,isLoaded:null!=t}}),[e,t])}},function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"i",(function(){return b})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return S}));var a=n(48),i=n(57),r=n(29),o=n(976),s=n(182),l=n(1258),c=n(1196);const u=e=>e.policyItem,d=Object(i.createSelector)(u,(e=>e.license),((e,t)=>{if(e){const n=((e,t)=>{if(Object(r.b)(t,"enterprise"))return Object(o.d)(e);if(Object(r.b)(t,"platinum")){const t=Object(o.d)(e);return Object(o.e)(t)}return Object(o.f)(e)})(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:n}}}]}}return e})),p=Object(i.createSelector)(d,(e=>{if(e)return Object(l.a)(e)})),m=e=>!e.policyItem&&!e.apiError,f=e=>Object(c.e)(e)||Object(c.f)(e)||Object(c.d)(e)||Object(c.c)(e)||Object(c.b)(e)||Object(c.g)(e),g=e=>e.license,b=Object(i.createSelector)((e=>e.location),(e=>{var t,n,i,r;return null!==(t=null===(n=Object(a.matchPath)(null!==(r=null==e?void 0:e.pathname)&&void 0!==r?r:"",{path:[s.n,s.r,s.m,s.o,s.l,s.q],exact:!0}))||void 0===n||null===(i=n.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),y=Object(o.c)(),h=Object(i.createSelector)(d,(e=>{var t,n,a,i;return null!==(t=null==e||null===(n=e.inputs[0])||void 0===n||null===(a=n.config)||void 0===a||null===(i=a.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:y})),v=Object(i.createSelector)(h,(e=>null==e?void 0:e.windows)),E=Object(i.createSelector)(h,(e=>null==e?void 0:e.mac)),x=Object(i.createSelector)(h,(e=>null==e?void 0:e.linux)),j=(Object(i.createSelector)(v,E,x,((e,t,n)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:n.advanced,events:n.events,malware:n.malware,behavior_protection:n.behavior_protection,memory_protection:n.memory_protection,popup:n.popup}}))),e=>e.apiError),S=e=>e.agentStatusSummary},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(203),i=n(7);const r=[a.f.mac,a.f.linux,a.f.windows],o=(e="",t=!1,n="",o="",s="",l=!1)=>{const c={meta:{license:e,license_uuid:n,cluster_uuid:o,cluster_name:s,cloud:t,serverless:l},global_manifest_version:"latest",windows:{events:{credential_access:!0,dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:a.g.prevent,blocklist:!0,on_write_scan:!0},ransomware:{mode:a.g.prevent,supported:!0},memory_protection:{mode:a.g.prevent,supported:!0},behavior_protection:{mode:a.g.prevent,reputation_service:t,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{mode:a.a.sync,enabled:!0},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:a.g.prevent,blocklist:!0,on_write_scan:!0},behavior_protection:{mode:a.g.prevent,reputation_service:t,supported:!0},memory_protection:{mode:a.g.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"DYLD_INSERT_LIBRARIES,DYLD_FRAMEWORK_PATH,DYLD_LIBRARY_PATH,LD_PRELOAD"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:a.g.prevent,blocklist:!0,on_write_scan:!0},behavior_protection:{mode:a.g.prevent,reputation_service:t,supported:!0},memory_protection:{mode:a.g.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"LD_PRELOAD,LD_LIBRARY_PATH"}}};return c.meta.billable=function(e){return!!e.meta.serverless&&!(e=>{let t;return{isOnlyCollectingEvents:![{keyPath:"malware.mode",osList:[...r],disableValue:a.g.off,enableValue:a.g.prevent},{keyPath:"ransomware.mode",osList:[a.f.windows],disableValue:a.g.off,enableValue:a.g.prevent},{keyPath:"memory_protection.mode",osList:[...r],disableValue:a.g.off,enableValue:a.g.prevent},{keyPath:"behavior_protection.mode",osList:[...r],disableValue:a.g.off,enableValue:a.g.prevent},{keyPath:"attack_surface_reduction.credential_hardening.enabled",osList:[a.f.windows],disableValue:!1,enableValue:!0},{keyPath:"antivirus_registration.enabled",osList:[a.f.windows],disableValue:!1,enableValue:!0}].some((({keyPath:n,osList:a,disableValue:r})=>a.some((a=>{const o=`${a}.${n}`,s=Object(i.get)(e,o),l=s!==r;return l&&(t=`property [${o}] is set to [${s}]`),l})))),message:t}})(e).isOnlyCollectingEvents}(c),c},s=(e=o())=>({...e,global_manifest_version:"latest"}),l=(e=o())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,global_manifest_version:"latest",windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:a.g.off,supported:!1},memory_protection:{mode:a.g.off,supported:!1},behavior_protection:{mode:a.g.off,reputation_service:!1,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:a.g.off,reputation_service:!1,supported:!1},memory_protection:{mode:a.g.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:a.g.off,reputation_service:!1,supported:!1},memory_protection:{mode:a.g.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},c=(e=o())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),u="Elastic Security {action} {filename}",d="Elastic Security {action} {rule}"},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var a=void 0;t.setEuiDevProviderWarning=function(e){return a=e},t.getEuiDevProviderWarning=function(){return a},t.emitEuiProviderWarning=function(e){if("function"==typeof a)return a(e);switch(a){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return a.useMemo((function(){return e.apply(void 0,t)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.createContext(void 0);return[function(){var e=a.useContext(n);if(null==e)throw new Error("useReducerContext must be used inside a ReducerProvider.");return e},function(i){var r=i.children,o=i.initialState;return function(e,t){return a.createElement(n.Provider,e,t)}({value:a.useReducer(e,void 0!==o?o:t)},r)},n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(326));t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=(n=e,function(e,t){return n.reduceRight((function(t,n){return n(e)(t)}),t)});return function(e,t,n){void 0===n&&(n=function(e){return e});var o=i.useRef(n(t)),s=i.useState(o.current)[1],l=i.useCallback((function(t){return o.current=e(o.current,t),s(o.current),t}),[e]),c=i.useRef(a({getState:function(){return o.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.current.apply(c,e)}},l));return r.default((function(){c.current=a({getState:function(){return o.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.current.apply(c,e)}},l)}),[l]),[o.current,c.current]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.createContext(void 0);return[function(){var e=a.useContext(t);if(null==e)throw new Error("useStateContext must be used inside a StateProvider.");return e},function(n){var i=n.children,r=n.initialValue;return function(e,n){return a.createElement(t.Provider,e,n)}({value:a.useState(void 0!==r?r:e)},i)},t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(445));t.default=function(e,t){void 0===t&&(t=[]);var n=i.useState(0),o=n[0],s=n[1],l=r.default(e,a.__spreadArrays(t,[o])),c=l.loading,u=i.useCallback((function(){c||s((function(e){return e+1}))}),a.__spreadArrays(t,[c]));return a.__assign(a.__assign({},l),{retry:u})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(635)).default("audio");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r="object"==typeof navigator?navigator:void 0,o=r&&"function"==typeof r.getBattery;t.default=o?function(){var e=a.useState({isSupported:!0,fetched:!1}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,a=null,o=function(){if(e&&a){var r={isSupported:!0,fetched:!0,level:a.level,charging:a.charging,dischargingTime:a.dischargingTime,chargingTime:a.chargingTime};!i.isDeepEqual(t,r)&&n(r)}};return r.getBattery().then((function(t){e&&(a=t,i.on(a,"chargingchange",o),i.on(a,"chargingtimechange",o),i.on(a,"dischargingtimechange",o),i.on(a,"levelchange",o),o())})),function(){e=!1,a&&(i.off(a,"chargingchange",o),i.off(a,"chargingtimechange",o),i.off(a,"dischargingtimechange",o),i.off(a,"levelchange",o))}}),[]),t}:function(){return{isSupported:!1}}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,i,r;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(i=a;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=a;0!=i--;){var o=r[i];if(!("_owner"===o&&t.$$typeof||e(t[o],n[o])))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===e&&(e=!0);var n=a.useCallback((function(n){if("function"!=typeof e||e())return n.preventDefault(),t&&(n.returnValue=t),t}),[e,t]);a.useEffect((function(){if(e)return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}),[e,n])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(636));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=["mousedown","touchstart"];t.default=function(e,t,n){void 0===n&&(n=r);var o=a.useRef(t);a.useEffect((function(){o.current=t}),[t]),a.useEffect((function(){for(var t=function(t){var n=e.current;n&&!n.contains(t.target)&&o.current(t)},a=0,r=n;a<r.length;a++){var s=r[a];i.on(document,s,t)}return function(){for(var e=0,a=n;e<a.length;e++){var r=a[e];i.off(document,r,t)}}}),[n,e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(998));t.default=function(e){var t=i.useState((function(){return r.default.get(e)||null})),n=t[0],a=t[1];return[n,i.useCallback((function(t,n){r.default.set(e,t,n),a(t)}),[e]),i.useCallback((function(){r.default.remove(e),a(null)}),[e])]}},function(e,t,n){var a,i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */r=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(a){function i(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var o=JSON.stringify(n);/^[\{\[]/.test(o)&&(n=o)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var l in r)r[l]&&(s+="; "+l,!0!==r[l]&&(s+="="+r[l].split(";")[0]));return document.cookie=t+"="+n+s}}function o(e,n){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],o=0;o<r.length;o++){var s=r[o].split("="),l=s.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(s[0]);if(l=(a.read||a)(l,c)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(i[c]=l,e===c)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return o(e,!1)},i.getJSON=function(e){return o(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))},void 0===(i="function"==typeof(a=r)?a.call(t,n,t,e):a)||(e.exports=i),e.exports=r()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(576)),r=n(2),o=a.__importDefault(n(251)),s=a.__importDefault(n(327));t.default=function(){var e=o.default(),t=s.default({value:void 0,error:void 0,noUserInteraction:!0}),n=t[0],a=t[1];return[n,r.useCallback((function(t){var n,r;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var o=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void a({value:t,error:o,noUserInteraction:!0})}if(""===t)return o=new Error("Cannot copy empty string to clipboard."),void a({value:t,error:o,noUserInteraction:!0});r=t.toString(),n=i.default(r),a({value:r,error:void 0,noUserInteraction:n})}catch(o){a({value:r,error:o,noUserInteraction:n})}}),[])]}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(1002),r=n(1003),o=n(1004),s=n(1006),l=n(2),c=a.__importDefault(n(37)),u=i.create();r.addon(u),o.addon(u);var d=0;t.default=function(e){var t=l.useMemo((function(){return"react-use-css-"+(d++).toString(36)}),[]),n=l.useMemo((function(){return new u.VSheet}),[]);return c.default((function(){var a={};return s.cssToTree(a,e,"."+t,""),n.diff(a),function(){n.diff({})}})),t}},function(e,t,n){"use strict";var a=/[A-Z]/g;t.create=function(e){var t=(e=e||{}).assign||Object.assign,n=t({raw:"",pfx:"_",client:"object"==typeof window,assign:t,stringify:JSON.stringify,kebab:function(e){return e.replace(a,"-$&").toLowerCase()},decl:function(e,t){return(e=n.kebab(e))+":"+t+";"},hash:function(e){return function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return"_"+(t>>>0).toString(36)}(n.stringify(e))},selector:function(e,t){return e+(":"===t[0]?"":" ")+t},putRaw:function(e){n.raw+=e}},e);return n.client&&(n.sh||document.head.appendChild(n.sh=document.createElement("style")),n.putRaw=function(e){var t=n.sh.sheet;try{t.insertRule(e,t.cssRules.length)}catch(e){}}),n.put=function(e,t,a){var i,r,o="",s=[];for(i in t)(r=t[i])instanceof Object&&!(r instanceof Array)?s.push(i):o+=n.decl(i,r,e,a);o&&(o=e+"{"+o+"}",n.putRaw(a?a+"{"+o+"}":o));for(var l=0;l<s.length;l++)"@"===(i=s[l])[0]&&"@font-face"!==i?n.putAt(e,t[i],i):n.put(n.selector(e,i),t[i],a)},n.putAt=n.put,n}},function(e,t,n){"use strict";t.addon=function(e){e.client&&(document.head.appendChild(e.msh=document.createElement("style")),e.createRule=function(t,n){var a=t+"{}";n&&(a=n+"{"+a+"}");var i=n?e.msh.sheet:e.sh.sheet,r=i.insertRule(a,i.cssRules.length),o=(i.cssRules||i.rules)[r];if(o.index=r,n){var s=(o.cssRules||o.rules)[0];o.style=s.style,o.styleMap=s.styleMap}return o})}},function(e,t,n){"use strict";var a=n(1005).removeRule;t.addon=function(e){if(e.client){var t=e.kebab;n.prototype.diff=function(e){var n,a=this.decl,i=this.rule.style;for(n in a)void 0===e[n]&&i.removeProperty(n);for(n in e)e[n]!==a[n]&&i.setProperty(t(n),e[n]);this.decl=e},n.prototype.del=function(){a(this.rule)},i.prototype.diff=function(e){var t=this.tree;for(var a in t)if(void 0===e[a]){var i=t[a];for(var r in i)i[r].del()}for(var a in e)if(void 0===t[a])for(var r in e[a])(l=new n(r,a)).diff(e[a][r]),e[a][r]=l;else{var o=t[a],s=e[a];for(var r in o)s[r]||o[r].del();for(var r in s){var l;(l=o[r])?(l.diff(s[r]),s[r]=l):((l=new n(r,a)).diff(s[r]),s[r]=l)}}this.tree=e},e.VRule=n,e.VSheet=i}function n(t,n){this.rule=e.createRule(t,n),this.decl={}}function i(){this.tree={}}}},function(e,t){t.removeRule=function(e){var t=e.index,n=e.parentStyleSheet,a=n.cssRules||n.rules;for(t=Math.max(t,a.length-1);t>=0;){if(a[t]===e){n.deleteRule(t);break}t--}}},function(e,t){t.cssToTree=function e(t,n,a,i){var r,o,s={},l=!1;for(r in n)"object"!=typeof(o=n[r])&&(l=!0,s[r]=o);for(r in l&&(t[i]||(t[i]={}),t[i][a]=s),n)if("object"==typeof(o=n[r]))if("@"===r[0])e(t,o,a,r);else{var c=r.indexOf("&")>-1,u=a.split(",");if(c)for(var d=0;d<u.length;d++)u[d]=r.replace(/&/g,u[d]);else for(d=0;d<u.length;d++)u[d]=u[d]+" "+r;e(t,o,u.join(","),i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(t),i=n[0],r=n[1];return null==i?[e,r]:[i,r]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=function(){};t.default=function(e,t){void 0===e&&(e={}),void 0===t&&(t=[]);var n=e.onFiles,o=e.onText,s=e.onUri,l=i.useState(!1),c=l[0],u=l[1],d=i.useCallback(u,[]),p=i.useMemo((function(){return function(e){return function(t,n){var a=t.getData("text/uri-list");if(a)(e.onUri||r)(a,n);else if(t.files&&t.files.length)(e.onFiles||r)(Array.from(t.files),n);else if(n.clipboardData){var i=n.clipboardData.getData("text");(e.onText||r)(i,n)}}}(e)}),[n,o,s]);return i.useEffect((function(){var e=function(e){e.preventDefault(),d(!0)},t=function(e){e.preventDefault(),d(!0)},n=function(){d(!1)},a=function(){d(!1)},i=function(e){e.preventDefault(),d(!1),p(e.dataTransfer,e)},r=function(e){p(e.clipboardData,e)};return document.addEventListener("dragover",e),document.addEventListener("dragenter",t),document.addEventListener("dragleave",n),document.addEventListener("dragexit",a),document.addEventListener("drop",i),o&&document.addEventListener("paste",r),function(){document.removeEventListener("dragover",e),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",n),document.removeEventListener("dragexit",a),document.removeEventListener("drop",i),document.removeEventListener("paste",r)}}),a.__spreadArrays([p],t)),{over:c}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251)),o=function(){};t.default=function(e){void 0===e&&(e={});var t=e.onFiles,n=e.onText,a=e.onUri,s=r.default(),l=i.useState(!1),c=l[0],u=l[1],d=i.useMemo((function(){return function(e,t){return function(n,a){var i=n.getData("text/uri-list");i?(e.onUri||o)(i,a):n.files&&n.files.length?(e.onFiles||o)(Array.from(n.files),a):n.items&&n.items.length&&n.items[0].getAsString((function(n){t&&(e.onText||o)(n,a)}))}}(e,s())}),[t,n,a]),p=i.useMemo((function(){return function(e,t){return{onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault(),t(!0)},onDragLeave:function(){t(!1)},onDrop:function(n){n.preventDefault(),n.persist(),t(!1),e(n.dataTransfer,n)},onPaste:function(t){t.persist(),e(t.clipboardData,t)}}}(d,u)}),[d,u]);return[p,{over:c}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredForwardRef=void 0;var a=n(2);function i(e){var t=a.useRef(e&&e.current);return a.useEffect((function(){e&&(e.current=t.current)}),[e]),t}t.default=i,t.ensuredForwardRef=function(e){return a.forwardRef((function(t,n){var a=i(n);return e(t,a)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(null),t=e[0],n=e[1];return a.useEffect((function(){if(t)throw t}),[t]),a.useCallback((function(e){n(e)}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect((function(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(1014)),o=a.__importDefault(n(37)),s=function(){};t.default=function(e,t,n){void 0===n&&(n={});var a=n.video,l=n.onClose,c=void 0===l?s:l,u=i.useState(t),d=u[0],p=u[1];return o.default((function(){if(t&&e.current){var n=function(){a.current.removeEventListener("webkitendfullscreen",n),c()},i=function(){if(r.default.isEnabled){var e=r.default.isFullscreen;p(e),e||c()}};if(r.default.isEnabled){try{r.default.request(e.current),p(!0)}catch(e){c(e),p(!1)}r.default.on("change",i)}else a&&a.current&&a.current.webkitEnterFullscreen?(a.current.webkitEnterFullscreen(),a.current.addEventListener("webkitendfullscreen",n),p(!0)):(c(),p(!1));return function(){if(p(!1),r.default.isEnabled)try{r.default.off("change",i),r.default.exit()}catch(e){}else a&&a.current&&a.current.webkitExitFullscreen&&(a.current.removeEventListener("webkitendfullscreen",n),a.current.webkitExitFullscreen())}}}),[t,a,e]),d}},function(e,t,n){
/*!
* screenfull
* v5.0.0 - 2019-09-09
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,a=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,i=n.length,r={};a<i;a++)if((e=n[a])&&e[1]in t){for(a=0;a<e.length;a++)r[n[0][a]]=e[a];return r}return!1}(),i={change:a.fullscreenchange,error:a.fullscreenerror},r={request:function(e){return new Promise(function(n,i){var r=function(){this.off("change",r),n()}.bind(this);this.on("change",r),e=e||t.documentElement,Promise.resolve(e[a.requestFullscreen]()).catch(i)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i),Promise.resolve(t[a.exitFullscreen]()).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var a=i[e];a&&t.addEventListener(a,n,!1)},off:function(e,n){var a=i[e];a&&t.removeEventListener(a,n,!1)},raw:a};a?(Object.defineProperties(r,{isFullscreen:{get:function(){return Boolean(t[a.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[a.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[a.fullscreenEnabled])}}}),n?e.exports=r:window.screenfull=r):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){var t,n=i.useState({loading:!0,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),r=n[0],o=n[1],s=!0,l=function(e){s&&o({loading:!1,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})},c=function(e){return s&&o((function(t){return a.__assign(a.__assign({},t),{loading:!1,error:e})}))};return i.useEffect((function(){return navigator.geolocation.getCurrentPosition(l,c,e),t=navigator.geolocation.watchPosition(l,c,e),function(){s=!1,navigator.geolocation.clearWatch(t)}}),[]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(280));t.default=function(e){void 0===e&&(e={});var t=r.default(),n=i.useRef(a.__assign({},e));return[i.useCallback((function(){return n.current}),[]),i.useCallback((function(e){e&&(Object.assign(n.current,e),t())}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(1018);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=i.setHarmonicInterval((function(){return n.current()}),t);return function(){return i.clearHarmonicInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,i={};t.clearHarmonicInterval=function(e){var t=e.bucket,n=e.id;delete t.listeners[n];var a=!1;for(var r in t.listeners){a=!0;break}a||(clearInterval(t.timer),delete i[t.ms])},t.setHarmonicInterval=function(e,t){var n,r=a++;if(i[t])i[t].listeners[r]=e;else{var o=setInterval((function(){for(var e,n=i[t].listeners,a=!1,r=0,o=Object.values(n);r<o.length;r++){var s=o[r];try{s()}catch(t){a=!0,e=t}}if(a)throw e}),t);i[t]={ms:t,timer:o,listeners:(n={},n[r]=e,n)}}return{bucket:i[t],id:r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importStar(n(2)),i=a.useState,r=function(){};t.default=function(e){var t,n,o=i(!1),s=o[0],l=o[1];return"function"==typeof e&&(e=e(s)),[a.cloneElement(e,{onMouseEnter:(n=e.props.onMouseEnter,function(e){(n||r)(e),l(!0)}),onMouseLeave:(t=e.props.onMouseLeave,function(e){(t||r)(e),l(!1)})}),s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(1021),r=n(154),o=["mousemove","mousedown","resize","keydown","touchstart","wheel"];t.default=function(e,t,n){void 0===e&&(e=6e4),void 0===t&&(t=!1),void 0===n&&(n=o);var s=a.useState(t),l=s[0],c=s[1];return a.useEffect((function(){for(var t,a=!0,o=l,s=function(e){a&&(o=e,c(e))},u=i.throttle(50,(function(){o&&s(!1),clearTimeout(t),t=setTimeout((function(){return s(!0)}),e)})),d=function(){document.hidden||u()},p=0;p<n.length;p++)r.on(window,n[p],u);return r.on(document,"visibilitychange",d),t=setTimeout((function(){return s(!0)}),e),function(){a=!1;for(var e=0;e<n.length;e++)r.off(window,n[e],u);r.off(document,"visibilitychange",d)}}),[e,n]),l}},function(e,t,n){"use strict";function a(e,t,n,a){var i,r=!1,o=0;function s(){i&&clearTimeout(i)}function l(){var l=this,c=Date.now()-o,u=arguments;function d(){o=Date.now(),n.apply(l,u)}r||(a&&!i&&d(),s(),void 0===a&&c>e?d():!0!==t&&(i=setTimeout(a?function(){i=void 0}:d,void 0===a?e-c:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){s(),r=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=a,t.debounce=function(e,t,n){return void 0===n?a(e,t,!1):a(e,n,!1!==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(null),i=n[0],r=n[1];return a.useEffect((function(){if(e.current&&"function"==typeof IntersectionObserver){var n=new IntersectionObserver((function(e){r(e[0])}),t);return n.observe(e.current),function(){r(null),n.disconnect()}}return function(){}}),[e.current,t.threshold,t.root,t.rootMargin]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return void 0===e&&(e={laptopL:1440,laptop:1024,tablet:768}),function(){var t=a.useState(0),n=t[0],i=t[1];a.useEffect((function(){var e=function(){i(window.innerWidth)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var r=a.useMemo((function(){return Object.entries(e).sort((function(e,t){return e[1]>=t[1]?1:-1}))}),[e]),o=r.reduce((function(e,t){var a=t[0],i=t[1];return n>=i?a:e}),r[0][0]);return o}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(641)),r=a.__importDefault(n(326));t.default=function(e,t,n,a){void 0===a&&(a=i.default);var o=a(e),s=o[0],l=o[1];r.default((function(){!s&&n?n(l):s&&t&&t(l)}),[s])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(e){var t=window.history,n=t[e];t[e]=function(t){var a=n.apply(this,arguments),i=new Event(e.toLowerCase());return i.state=t,window.dispatchEvent(i),a}};i.isClient&&(r("pushState"),r("replaceState"));var o=function(e){var t=window.history,n=t.state,a=t.length,i=window.location;return{trigger:e,state:n,length:a,hash:i.hash,host:i.host,hostname:i.hostname,href:i.href,origin:i.origin,pathname:i.pathname,port:i.port,protocol:i.protocol,search:i.search}},s="function"==typeof Event;t.default=i.isClient&&s?function(){var e=a.useState(o("load")),t=e[0],n=e[1];return a.useEffect((function(){var e=function(){return n(o("popstate"))},t=function(){return n(o("pushstate"))},a=function(){return n(o("replacestate"))};return i.on(window,"popstate",e),i.on(window,"pushstate",t),i.on(window,"replacestate",a),function(){i.off(window,"popstate",e),i.off(window,"pushstate",t),i.off(window,"replacestate",a)}}),[]),t}:function(){return{trigger:"load",length:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestBody=void 0;var a=n(2);function i(e){if(!e)return null;if("BODY"===e.tagName)return e;if("IFRAME"===e.tagName){var t=e.contentDocument;return t?t.body:null}return e.offsetParent?i(e.offsetParent):null}function r(e){var t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)}t.getClosestBody=i;var o="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),s=new Map,l="object"==typeof document?document:void 0,c=!1;t.default=l?function(e,t){void 0===e&&(e=!0);var n=a.useRef(l.body);t=t||n;var u=function(e){var t=s.get(e);t&&(1===t.counter?(s.delete(e),o?(e.ontouchmove=null,c&&(document.removeEventListener("touchmove",r),c=!1)):e.style.overflow=t.initialOverflow):s.set(e,{counter:t.counter-1,initialOverflow:t.initialOverflow}))};a.useEffect((function(){var n=i(t.current);n&&(e?function(e){var t=s.get(e);t?s.set(e,{counter:t.counter+1,initialOverflow:t.initialOverflow}):(s.set(e,{counter:1,initialOverflow:e.style.overflow}),o?c||(document.addEventListener("touchmove",r,{passive:!1}),c=!0):e.style.overflow="hidden")}(n):u(n))}),[e,t.current]),a.useEffect((function(){var e=i(t.current);if(e)return function(){u(e)}}),[])}:function(e,t){void 0===e&&(e=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(328)),r=a.__importDefault(n(326));t.default=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.default((function(){return console.log.apply(console,a.__spreadArrays([e+" mounted"],t)),function(){return console.log(e+" unmounted")}})),r.default((function(){console.log.apply(console,a.__spreadArrays([e+" updated"],t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};t.default=function(e,t){var n=void 0===t?{}:t,r=n.isPreventDefault,o=void 0===r||r,s=n.delay,l=void 0===s?300:s,c=a.useRef(),u=a.useRef(),d=a.useCallback((function(t){o&&t.target&&(t.target.addEventListener("touchend",i,{passive:!1}),u.current=t.target),c.current=setTimeout((function(){return e(t)}),l)}),[e,l,o]),p=a.useCallback((function(){c.current&&clearTimeout(c.current),o&&u.current&&u.current.removeEventListener("touchend",i)}),[o]);return{onMouseDown:function(e){return d(e)},onTouchStart:function(e){return d(e)},onMouseUp:p,onMouseLeave:p,onTouchEnd:p}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154);t.default=function(e,t){void 0===t&&(t=!1);var n=a.useState(i.isClient?function(){return window.matchMedia(e).matches}:t),r=n[0],o=n[1];return a.useEffect((function(){var t=!0,n=window.matchMedia(e),a=function(){t&&o(!!n.matches)};return n.addListener(a),o(n.matches),function(){t=!1,n.removeListener(a)}}),[e]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(){};t.default="object"==typeof navigator&&navigator.mediaDevices?function(){var e=a.useState({}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,t=function(){navigator.mediaDevices.enumerateDevices().then((function(t){e&&n({devices:t.map((function(e){return{deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label}}))})})).catch(r)};return i.on(navigator.mediaDevices,"devicechange",t),t(),function(){e=!1,i.off(navigator.mediaDevices,"devicechange",t)}}),[]),t}:function(){return{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMediatedState=void 0;var a=n(2);t.useMediatedState=function(e,t){var n=a.useRef(e),i=a.useState(t),r=i[0],o=i[1];return[r,a.useCallback((function(e){2===n.current.length?n.current(e,o):o(n.current(e))}),[r])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useMemo((function(){return function(t,n){var a;return(a=e(t))[n.type].apply(a,n.payload)}}),[e]),i=a.useReducer(n,t),r=i[0],o=i[1],s=a.useMemo((function(){return Object.keys(e(t)).reduce((function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o({type:t,payload:e})},e}),{})}),[e,t]);return[r,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r={acceleration:{x:null,y:null,z:null},accelerationIncludingGravity:{x:null,y:null,z:null},rotationRate:{alpha:null,beta:null,gamma:null},interval:16};t.default=function(e){void 0===e&&(e=r);var t=a.useState(e),n=t[0],o=t[1];return a.useEffect((function(){var e=function(e){var t=e.acceleration,n=e.accelerationIncludingGravity,a=e.rotationRate,i=e.interval;o({acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:n.x,y:n.y,z:n.z},rotationRate:{alpha:a.alpha,beta:a.beta,gamma:a.gamma},interval:i})};return i.on(window,"devicemotion",e),function(){i.off(window,"devicemotion",e)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(639)),r=a.__importDefault(n(647)),o={current:null};t.default=function(e,t){void 0===t&&(t={});var n=!!t.whenHovered,a=!!t.bound,s=i.default(e,n),l=r.default(n&&!s?o:e);return a&&(l.elX=Math.max(0,Math.min(l.elX,l.elW)),l.elY=Math.max(0,Math.min(l.elY,l.elH))),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(0),t=e[0],n=e[1];return a.useEffect((function(){var e=function(e){n(e.deltaY+t)};return window.addEventListener("wheel",e,!1),function(){return window.removeEventListener("wheel",e)}})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=n(154),o=function(){if("object"!=typeof navigator)return null;var e=navigator;return e.connection||e.mozConnection||e.webkitConnection},s=function(){var e=o();return e?{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,type:e.type,rtt:e.rtt}:{}};t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],l=t[1];return i.useEffect((function(){var e=n,t=function(t){e=a.__assign(a.__assign({},e),t),l(e)},i=o(),c=function(){t({online:!0,since:new Date})},u=function(){t({online:!1,since:new Date})},d=function(){t(s())};return r.on(window,"online",c),r.on(window,"offline",u),i&&(r.on(i,"change",d),t(a.__assign(a.__assign(a.__assign({},n),{online:navigator.onLine,since:void 0}),s()))),function(){r.off(window,"online",c),r.off(window,"offline",u),i&&r.off(i,"change",d)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(637));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r={angle:0,type:"landscape-primary"};t.default=function(e){void 0===e&&(e=r);var t=window.screen,n=a.useState(e),o=n[0],s=n[1];return a.useEffect((function(){var n=!0,a=function(){if(n){var a=t.orientation;if(a){var i=a.angle,r=a.type;s({angle:i,type:r})}else window.orientation?s({angle:"number"==typeof window.orientation?window.orientation:0,type:""}):s(e)}};return i.on(window,"orientationchange",a),a(),function(){n=!1,i.off(window,"orientationchange",a)}}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=[]),a.useEffect((function(){if(e){var t=function(t){var n=(t=t||window.event).relatedTarget||t.toElement;n&&"HTML"!==n.nodeName||e()};return document.addEventListener("mouseout",t),function(){document.removeEventListener("mouseout",t)}}}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(154),r=function(){};t.default=function(e){var t=!0,n=null,o=a.useState(""),s=o[0],l=o[1],c=function(){t&&n&&l(n.state)};return a.useEffect((function(){return navigator.permissions.query(e).then((function(e){n=e,c(),i.on(n,"change",c)})).catch(r),function(){t=!1,n&&i.off(n,"change",c)}}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(371),r=function(e,t){return e===t};t.default=function(e,t){void 0===t&&(t=r);var n=a.useRef(),o=a.useRef(e);return i.useFirstMountState()||t(o.current,e)||(n.current=o.current,o.current=e),n.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251));t.default=function(){var e=r.default();return i.useCallback((function(t){return new Promise((function(n,a){t.then((function(t){e()&&n(t)}),(function(t){e()&&a(t)}))}))}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){void 0===e&&(e=[]);var t=i.useState(e),n=t[0],r=t[1];return{add:function(e){r((function(t){return a.__spreadArrays(t,[e])}))},remove:function(){var e;return r((function(t){var n=t[0],a=t.slice(1);return e=n,a})),e},get first(){return n[0]},get last(){return n[n.length-1]},get size(){return n.length}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useRef(null),i=a.useRef(!1),r=a.useRef(e);r.current=e;var o=a.useCallback((function(e){i.current&&(r.current(e),n.current=requestAnimationFrame(o))}),[]),s=a.useMemo((function(){return[function(){i.current&&(i.current=!1,n.current&&cancelAnimationFrame(n.current))},function(){i.current||(i.current=!0,n.current=requestAnimationFrame(o))},function(){return i.current}]}),[]);return a.useEffect((function(){return t&&s[1](),s[0]}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return new URLSearchParams(e).get(t)};t.default="object"==typeof window?function(e){var t=window.location,n=a.useState((function(){return i(t.search,e)})),r=n[0],o=n[1];return a.useEffect((function(){var n=function(){o(i(t.search,e))};return window.addEventListener("popstate",n),window.addEventListener("pushstate",n),window.addEventListener("replacestate",n),function(){window.removeEventListener("popstate",n),window.removeEventListener("pushstate",n),window.removeEventListener("replacestate",n)}}),[]),r}:function(){return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScratchSensor=void 0;var a=n(34),i=n(2),r=n(1048),o=a.__importDefault(n(642)),s=function(){},l=function(e){void 0===e&&(e={});var t=e.disabled,n=o.default(e),r=i.useState({isScratching:!1}),l=r[0],c=r[1],u=i.useRef(l),d=i.useRef(!1),p=i.useRef(null),m=i.useState(null),f=m[0],g=m[1];return i.useEffect((function(){if(!t&&f){var e,i,r=function(e,t){cancelAnimationFrame(p.current),p.current=requestAnimationFrame((function(){var i=f.getBoundingClientRect(),r=i.left,o=i.top,l=r+window.scrollX,d=o+window.scrollY,p=e-l,m=t-d;c((function(e){var t=a.__assign(a.__assign({},e),{dx:p-(e.x||0),dy:m-(e.y||0),end:Date.now(),isScratching:!0});return u.current=t,(n.current.onScratch||s)(t),t}))}))},o=function(e){r(e.pageX,e.pageY)},l=function(e){r(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},m=function(){d.current&&(d.current=!1,u.current=a.__assign(a.__assign({},u.current),{isScratching:!1}),(n.current.onScratchEnd||s)(u.current),c({isScratching:!1}),window.removeEventListener("mousemove",o),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i))};e=m,i=m;var g=function(t,a){if(d.current){var r=f.getBoundingClientRect(),p=r.left,m=r.top,g=p+window.scrollX,b=m+window.scrollY,y=t-g,h=a-b,v=Date.now(),E={isScratching:!0,start:v,end:v,docX:t,docY:a,x:y,y:h,dx:0,dy:0,elH:f.offsetHeight,elW:f.offsetWidth,elX:g,elY:b};u.current=E,(n.current.onScratchStart||s)(E),c(E),window.addEventListener("mousemove",o),window.addEventListener("touchmove",l),window.addEventListener("mouseup",e),window.addEventListener("touchend",i)}},b=function(e){d.current=!0,g(e.pageX,e.pageY)},y=function(e){d.current=!0,g(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return f.addEventListener("mousedown",b),f.addEventListener("touchstart",y),function(){f.removeEventListener("mousedown",b),f.removeEventListener("touchstart",y),window.removeEventListener("mousemove",o),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i),p.current&&cancelAnimationFrame(p.current),p.current=null,d.current=!1,u.current={isScratching:!1},c(u.current)}}}),[f,t,n]),[g,l]};t.ScratchSensor=function(e){e.children;var t=a.__rest(e,["children"]),n=l(t),o=n[0],s=n[1],c=r.render(e,s);return i.cloneElement(c,a.__assign(a.__assign({},c.props),{ref:function(e){c.props.ref&&("object"==typeof c.props.ref&&(c.props.ref.current=e),"function"==typeof c.props.ref&&c.props.ref(e)),o(e)}}))},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hookToRenderProp=t.createEnhancer=t.render=void 0;var a=n(34),i=a.__importDefault(n(649));t.render=i.default;var r=a.__importDefault(n(1049));t.createEnhancer=r.default;var o=a.__importDefault(n(1052));t.hookToRenderProp=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divWrapper=void 0;var a=n(34),i=a.__importStar(n(2)),r=a.__importDefault(n(1050)),o=i.createElement,s=function(e,t,n,i){var r;return o(e,t?a.__assign(((r={})[t]=i,r),n):a.__assign(a.__assign({},i),n))};t.divWrapper=function(e,t,n,a){return o("div",null,s(e,t,n,a))},t.default=function(e,t,n){void 0===n&&(n=s);var a=function(i,s,l){void 0===s&&(s=t),void 0===l&&(l=null);var c="string"==typeof i;if(c)return function(e){return a(e,i||t,s)};var u=function(t){return o(e,l,(function(e){return n(i,s,t,e)}))};return c?r.default(u):u};return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(1051));t.default=function(e){return e.prototype?e:a.default(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importStar(n(2));t.default=function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(n,t),n.prototype.render=function(){return e(this.props,this.context)},n}(i.Component);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(649)),i=function(e){return[e]};t.default=function(e,t){return void 0===t&&(t=i),function(n){return a.default(n,e.apply(void 0,t(n)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(329));t.default=function(e){var t=r.default({x:0,y:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&e.current.addEventListener("scroll",t,{capture:!1,passive:!0}),function(){e.current&&e.current.removeEventListener("scroll",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useState(!1),n=t[0],i=t[1];return a.useEffect((function(){if(e.current){var t,n=function(){i(!0),clearTimeout(t),t=setTimeout((function(){i(!1)}),150)};return e.current.addEventListener("scroll",n,!1),function(){e.current&&e.current.removeEventListener("scroll",n,!1)}}return function(){}}),[e]),n}},function(e,t){var n=Object.keys;t.equal=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var a=n(e),i=a.length,r=0;r<i;r++)if(!(a[r]in t))return!1;for(r=0;r<i;r++)if(e[a[r]]!==t[a[r]])return!1;return i===n(t).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importStar(n(2)),r=n(154),o=i.useState,s=i.useEffect,l=i.useRef;t.default=function(e,t){var n=void 0===t?{}:t,c=n.width,u=void 0===c?1/0:c,d=n.height,p=void 0===d?1/0:d;if(!r.isClient)return["function"==typeof e?e({width:u,height:p}):e,{width:u,height:p}];var m=o({width:u,height:p}),f=m[0],g=m[1];"function"==typeof e&&(e=e(f));var b=e.props.style||{},y=l(null),h=null,v=function(){var e=y.current,t=e?{width:e.offsetWidth,height:e.offsetHeight}:{width:u,height:p};g(t)},E=function(e){e.addEventListener("resize",v),setTimeout(v,35)};return s((function(){var e=y.current;if(e){if(e.contentWindow)h=e.contentWindow,E(h);else{var t=function(){e.removeEventListener("load",t),h=e.contentWindow,E(h)};e.addEventListener("load",t)}return function(){h&&h.removeEventListener&&h.removeEventListener("resize",v)}}}),[]),b.position="relative",[i.cloneElement.apply(i,a.__spreadArrays([e,{style:b}],a.__spreadArrays([i.createElement("iframe",{ref:y,style:{background:"transparent",border:"none",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:-1}})],i.Children.toArray(e.props.children)))),f]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=n(154),o=a.__importDefault(n(251)),s=a.__importDefault(n(327)),l=function(){};t.default=function(e,t){void 0===t&&(t={});var n=o.default(),a=i.useRef(!1),c=i.useRef(0),u=i.useRef(0),d=s.default({isSliding:!1,value:0}),p=d[0],m=d[1];return c.current=p.value,i.useEffect((function(){if(r.isClient){var i=void 0===t.styles||t.styles,o=void 0!==t.reverse&&t.reverse;e.current&&i&&(e.current.style.userSelect="none");var s=function(){!a.current&&n()&&((t.onScrubStart||l)(),a.current=!0,m({isSliding:!0}),y())},d=function(){a.current&&n()&&((t.onScrubStop||l)(c.current),a.current=!1,m({isSliding:!1}),h())},p=function(e){s(),f(e)},f=t.vertical?function(e){return v(e.clientY)}:function(e){return v(e.clientX)},g=function(e){s(),b(e)},b=t.vertical?function(e){return v(e.changedTouches[0].clientY)}:function(e){return v(e.changedTouches[0].clientX)},y=function(){r.on(document,"mousemove",f),r.on(document,"mouseup",d),r.on(document,"touchmove",b),r.on(document,"touchend",d)},h=function(){r.off(document,"mousemove",f),r.off(document,"mouseup",d),r.off(document,"touchmove",b),r.off(document,"touchend",d)},v=function(a){cancelAnimationFrame(u.current),u.current=requestAnimationFrame((function(){if(n()&&e.current){var i=e.current.getBoundingClientRect(),r=t.vertical?i.top:i.left,s=t.vertical?i.height:i.width;if(!s)return;var c=(a-r)/s;c>1?c=1:c<0&&(c=0),o&&(c=1-c),m({value:c}),(t.onScrub||l)(c)}}))};return r.on(e.current,"mousedown",p),r.on(e.current,"touchstart",g),function(){r.off(e.current,"mousedown",p),r.off(e.current,"touchstart",g)}}}),[e,t.vertical]),p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(646)),o=a.__importDefault(n(327)),s="object"==typeof window&&"object"==typeof window.speechSynthesis?window.speechSynthesis.getVoices():[];t.default=function(e,t){void 0===t&&(t={});var n=o.default({isPlaying:!1,lang:t.lang||"default",voice:t.voice||s[0],rate:t.rate||1,pitch:t.pitch||1,volume:t.volume||1}),a=n[0],l=n[1],c=i.useRef(null);return r.default((function(){var n=new SpeechSynthesisUtterance(e);t.lang&&(n.lang=t.lang),t.voice&&(n.voice=t.voice),n.rate=t.rate||1,n.pitch=t.pitch||1,n.volume=t.volume||1,n.onstart=function(){return l({isPlaying:!0})},n.onresume=function(){return l({isPlaying:!0})},n.onend=function(){return l({isPlaying:!1})},n.onpause=function(){return l({isPlaying:!1})},c.current=n,window.speechSynthesis.speak(c.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(37));t.default=function(e){a.default((function(){var t=function(t){var n,a,i,r,o;!function(){var e=document.activeElement,t=document.body;if(!e)return!1;if(e===t)return!1;switch(e.tagName){case"INPUT":case"TEXTAREA":return!0}return e.hasAttribute("contenteditable")}()&&(a=(n=t).keyCode,i=n.metaKey,r=n.ctrlKey,o=n.altKey,!(i||r||o)&&(a>=48&&a<=57||a>=65&&a<=90))&&e(t)};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithHistory=void 0;var a=n(2),i=n(371),r=n(372);t.useStateWithHistory=function(e,t,n){if(void 0===t&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var o=i.useFirstMountState(),s=a.useState(e),l=s[0],c=s[1],u=a.useRef(null!=n?n:[]),d=a.useRef(0);return o&&(u.current.length?(u.current[u.current.length-1]!==e&&u.current.push(e),u.current.length>t&&(u.current=u.current.slice(u.current.length-t))):u.current.push(e),d.current=u.current.length&&u.current.length-1),[l,a.useCallback((function(e){c((function(n){return(e=r.resolveHookState(e))!==n&&(d.current<u.current.length-1&&(u.current=u.current.slice(0,d.current+1)),d.current=u.current.push(e)-1,u.current.length>t&&(u.current=u.current.slice(u.current.length-t))),e}))}),[l,t]),a.useMemo((function(){return{history:u.current,position:d.current,capacity:t,back:function(e){void 0===e&&(e=1),d.current&&c((function(){return d.current-=Math.min(e,d.current),u.current[d.current]}))},forward:function(e){void 0===e&&(e=1),d.current!==u.current.length-1&&c((function(){return d.current=Math.min(d.current+e,u.current.length-1),u.current[d.current]}))},go:function(e){e!==d.current&&c((function(){return d.current=e<0?Math.max(u.current.length+e,0):Math.min(u.current.length-1,e),u.current[d.current]}))}}}),[l])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(251)),o=a.__importDefault(n(280)),s=a.__importDefault(n(326));t.default=function(e){void 0===e&&(e=[]);var t=r.default(),n=o.default(),l=i.useRef(0);s.default((function(){e.length<=l.current&&(l.current=e.length-1,n())}),[e.length]);var c=i.useMemo((function(){return{next:function(){return c.setStateAt(l.current+1)},prev:function(){return c.setStateAt(l.current-1)},setStateAt:function(a){t()&&e.length&&a!==l.current&&(l.current=a>=0?a%e.length:e.length+a%e.length,n())},setState:function(a){if(t()){var i=e.length?e.indexOf(a):-1;if(-1===i)throw new Error("State '"+a+"' is not a valid state (does not exist in state list)");l.current=i,n()}}}}),[e]);return a.__assign({state:e[l.current],currentIndex:l.current},c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(373));t.default=function(e,t){void 0===t&&(t=200);var n=i.useState(e),a=n[0],o=n[1],s=i.useRef(),l=i.useRef(null),c=i.useRef(0);return i.useEffect((function(){if(s.current)l.current=e,c.current=!0;else{o(e);var n=function(){c.current?(c.current=!1,o(l.current),s.current=setTimeout(n,t)):s.current=void 0};s.current=setTimeout(n,t)}}),[e]),r.default((function(){s.current&&clearTimeout(s.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(373));t.default=function(e,t,n){void 0===t&&(t=200);var a=i.useState(null),o=a[0],s=a[1],l=i.useRef(),c=i.useRef();return i.useEffect((function(){if(l.current)c.current=n;else{s(e.apply(void 0,n));var a=function(){c.current?(s(e.apply(void 0,c.current)),c.current=void 0,l.current=setTimeout(a,t)):l.current=void 0};l.current=setTimeout(a,t)}}),n),r.default((function(){l.current&&clearTimeout(l.current)})),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(462)),r=a.__importDefault(n(280));t.default=function(e){void 0===e&&(e=0);var t=r.default();return i.default(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i={restoreOnUnmount:!1};t.default="undefined"!=typeof document?function(e,t){void 0===t&&(t=i);var n=a.useRef(document.title);document.title=e,a.useEffect((function(){return t&&t.restoreOnUnmount?function(){document.title=n.current}:void 0}),[])}:function(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(1333),r=a.__importDefault(n(648));t.default=function(e,t,n){return void 0===e&&(e="inCirc"),void 0===t&&(t=200),void 0===n&&(n=0),(0,i.easing[e])(r.default(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1);return a.useEffect((function(){return function(){e.current=!0}})),a.useMemo((function(){return function(t,n){return new Promise((function(a,i){t.then((function(t){e.current||a(t)}),(function(t){e.current?n?n(t):console.error("useUnmountPromise",t):i(t)}))}))}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=a.__importDefault(n(644));t.default=function(e,t){void 0===t&&(t=[]);var n=i.default(t),r=n[0],o=n[1];return[r,a.__assign(a.__assign({},o),{upsert:function(t){o.upsert(e,t)}})]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i="object"==typeof navigator&&"vibrate"in navigator;t.default=i?function(e,t,n){void 0===e&&(e=!0),void 0===t&&(t=[1e3,1e3]),void 0===n&&(n=!0),a.useEffect((function(){var a;if(e&&(navigator.vibrate(t),n)){var i=t instanceof Array?t.reduce((function(e,t){return e+t})):t;a=setInterval((function(){navigator.vibrate(t)}),i)}return function(){e&&(navigator.vibrate(0),n&&clearInterval(a))}}),[e])}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34).__importDefault(n(635)).default("video");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){void 0===n&&(n=[void 0]);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var o=a.useState(n),s=o[0],l=o[1],c=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){c()}),[e]),[s,c]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useScrollbarWidth=void 0;var a=n(1073),i=n(2);t.useScrollbarWidth=function(){var e=i.useState(a.scrollbarWidth()),t=e[0],n=e[1];return i.useEffect((function(){if(void 0===t){var e=requestAnimationFrame((function(){n(a.scrollbarWidth())}));return function(){return cancelAnimationFrame(e)}}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if("undefined"==typeof document)return 0;if(document.body&&(!document.readyState||"loading"!==document.readyState)){if(!0!==e&&"number"==typeof a.__cache)return a.__cache;var t=document.createElement("div"),n=t.style;n.display="block",n.position="absolute",n.width="100px",n.height="100px",n.left="-999px",n.top="-999px",n.overflow="scroll",document.body.insertBefore(t,null);var i=t.clientWidth;if(0!==i)return a.__cache=100-i,document.body.removeChild(t),a.__cache;document.body.removeChild(t)}};t.scrollbarWidth=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMultiStateValidator=void 0;var a=n(2);t.useMultiStateValidator=function(e,t,n){if(void 0===n&&(n=[void 0]),"object"!=typeof e)throw new Error("states expected to be an object or array, got "+typeof e);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var o=a.useState(n),s=o[0],l=o[1],c=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){c()}),Object.values(e)),[s,c]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=n(154),o=a.__importDefault(n(329));t.default=function(){var e=o.default({x:r.isClient?window.pageXOffset:0,y:r.isClient?window.pageYOffset:0}),t=e[0],n=e[1];return i.useEffect((function(){var e=function(){n({x:window.pageXOffset,y:window.pageYOffset})};return window.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){window.removeEventListener("scroll",e)}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(329)),o=n(154);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var n=r.default({width:o.isClient?window.innerWidth:e,height:o.isClient?window.innerHeight:t}),a=n[0],s=n[1];return i.useEffect((function(){if(o.isClient){var e=function(){s({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2),r=a.__importDefault(n(37)),o=n(154),s={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};t.default=o.isClient&&window.ResizeObserver?function(){var e=i.useState(null),t=e[0],n=e[1],a=i.useState(s),o=a[0],l=a[1],c=i.useMemo((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,a=t.y,i=t.width,r=t.height,o=t.top,s=t.left,c=t.bottom,u=t.right;l({x:n,y:a,width:i,height:r,top:o,left:s,bottom:c,right:u})}}))}),[]);return r.default((function(){if(t)return c.observe(t),function(){c.disconnect()}}),[t]),[n,o]}:function(){return[function(){},s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRendersCount=void 0;var a=n(2);t.useRendersCount=function(){return++a.useRef(0).current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(34),i=n(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),n=t[0],r=t[1],o=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(a.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(a.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),s=a.__assign({has:i.useCallback((function(e){return n.has(e)}),[n])},o);return[n,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGlobalState=void 0;var a=n(34),i=n(2),r=a.__importDefault(n(328)),o=a.__importDefault(n(37));function s(e){var t={state:e,setState:function(e){t.state=e,t.setters.forEach((function(e){return e(t.state)}))},setters:[]};return function(){var e=i.useState(t.state),n=e[0],a=e[1];return r.default((function(){return function(){t.setters=t.setters.filter((function(e){return e!==a}))}})),o.default((function(){t.setters.includes(a)||t.setters.push(a)})),[n,t.setState]}}t.createGlobalState=s,t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHash=void 0;var a=n(34),i=n(2),r=a.__importDefault(n(643));t.useHash=function(){var e=i.useState((function(){return window.location.hash})),t=e[0],n=e[1],a=i.useCallback((function(){n(window.location.hash)}),[]);r.default((function(){window.addEventListener("hashchange",a)}),(function(){window.removeEventListener("hashchange",a)}));var o=i.useCallback((function(e){e!==t&&(window.location.hash=e)}),[t]);return[t,o]}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(762);n(119),n(2),n(652),n(43),n(323),n(324),n(653);var i=a.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){i[e]=i(e)})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(515);function i(e){return e&&e.__esModule?e:{default:e}}var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,o=i(a).default((function(e){return r.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=o},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r="undefined"!=typeof document,o=!!i.useInsertionEffect&&i.useInsertionEffect,s=r&&o||function(e){return e()},l=o||i.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=s,t.useInsertionEffectWithLayoutFallback=l},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1089);case"v8light":return n(1091)}},function(e,t,n){var a=n(185),i=n(1090);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#2e2d25}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #343741}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#343741}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,n){var a=n(185),i=n(1092);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Menlo,Courier,monospace}.unifiedDataTable__cell--expanded,.unifiedDataTable__cell--selected{background-color:#fff9e8}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGridHeaderCell{align-items:start}.unifiedDataTable__inner .euiDataGridHeaderCell:not(.euiDataGridHeaderCell--controlColumn) .euiDataGridHeaderCell__button{align-items:flex-start;height:100%}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #d3dae6}.unifiedDataTable__inner .euiDataGridRowCell--controlColumn .euiDataGridRowCell__content,.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover{background-color:#e9edf3}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:#0000}.unifiedDataTable__inner .euiDataGridRowCell__content--autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__content--lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.euiDataGridHeader .euiDataGridHeaderCell__content{white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-4px}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__content--defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;line-height:inherit;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{line-height:inherit;margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.1428571429rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px)and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px)and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.unifiedDataTable__fullScreen :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(233);function i(e,t,n,i,r,o,s){const l=null!=o?o:"html",c={hit:t,field:r,...s};return i&&r?i.getFormatterForField(r).convert(e,l,c):n.getDefaultInstance(a.b.STRING).convert(e,l,c)}},function(e,t,n){var a=n(185),i=n(1095);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,n){var a=n(185),i=n(1097);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},,function(e,t,n){"use strict";var a=n(342);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.g})),n.d(t,"c",(function(){return a.h})),n(502),n(536),n(554)},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n(2),i=n.n(a),r=n(19),o=n(59),s=n(7),l=n(4),c=n(122),u=n(10),d=n(174),p=n(822),m=n(1262),f=n(140),g=n(296),b=n(126),y=n(869),h=n(885),v=n(1250),E=n(130);const x=Object(E.e)(),j=o.css`
  &.euiDescriptionList {
    > .euiDescriptionList__title {
      color: ${e=>e.theme.eui.euiColorDarkShade};
      font-size: ${e=>e.theme.eui.euiFontSizeXS};
    }

    > .euiDescriptionList__title,
    > .euiDescriptionList__description {
      font-weight: ${e=>e.theme.eui.euiFontWeightRegular};
    }
  }
`,S=o.css`
  ${e=>`${e.theme.eui.euiSize} 0`}
`,O=o.css`
  ${e=>`1px dashed ${e.theme.eui.euiColorDisabled}`};
`,k=Object(o.euiStyled)(r.EuiDescriptionList).attrs({compressed:!0})`
  ${j}
  dd {
    margin: ${S};
    padding: ${S};
    border-top: ${O};
    border-bottom: ${O};
  }
`,w=Object(o.euiStyled)(r.EuiDescriptionList).attrs({compressed:!0,type:"column"})`
  ${j}
`,T=Object(o.euiStyled)(r.EuiCodeBlock).attrs({transparentBackground:!0,paddingSize:"none"})`
  code {
    color: ${e=>e.theme.eui.euiColorDarkShade} !important;
  }
`,I=Object(o.euiStyled)(r.EuiFlexGroup).attrs({direction:"column",className:"eui-yScrollWithShadows",gutterSize:"s"})`
  max-height: 270px;
  overflow-y: auto;
`,M=Object(a.memo)((({action:e,fromAlertWorkaround:t=!1,"data-test-subj":n})=>{var a;const o=Object(b.a)(n),{canWriteFileOperations:s,canReadActionsLogManagement:c,canAccessEndpointActionsLogManagement:u}=Object(f.a)().endpointPrivileges,{command:E,isCompleted:x,isExpired:j,wasSuccessful:S}=e,O=d.f[E];var k;return t&&null!==(a=e.errors)&&void 0!==a&&a.length?i.a.createElement(i.a.Fragment,null,(null!==(k=e.errors)&&void 0!==k?k:[l.i18n.translate("xpack.securitySolution.actionLogExpandedTray.missingErrors",{defaultMessage:"Action did not specify any errors"})]).map((e=>i.a.createElement(r.EuiFlexItem,null,e)))):j?i.a.createElement(i.a.Fragment,null,g.e.hasExpired(O)):x?S?Object(p.d)(e)?i.a.createElement(i.a.Fragment,null,g.e.wasSuccessful(O),i.a.createElement(y.a,{action:e,canAccessFileDownloadLink:s,textSize:"xs","data-test-subj":o("getFileDownloadLink")})):Object(p.c)(e)?i.a.createElement(r.EuiFlexGroup,{direction:"column","data-test-subj":o("executeDetails")},e.agents.map((t=>i.a.createElement("div",{key:t},g.e.wasSuccessful(O),i.a.createElement(v.a,{action:e,agentId:t,canAccessFileDownloadLink:u||c,textSize:"xs","data-test-subj":o("actionsLogTray")}))))):Object(p.e)(e)?i.a.createElement(r.EuiFlexGroup,{direction:"column","data-test-subj":o("uploadDetails")},i.a.createElement("p",null,g.e.wasSuccessful(O)),i.a.createElement(m.a,{action:e,"data-test-subj":o("uploadOutput"),textSize:"xs"})):"crowdstrike"===e.agentType?i.a.createElement(i.a.Fragment,null,g.e.submittedSuccessfully(O)):i.a.createElement(i.a.Fragment,null,g.e.wasSuccessful(O)):i.a.createElement(i.a.Fragment,null,g.e.hasFailed(O),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(h.a,{action:e,"data-test-subj":o("failureMessage")})):i.a.createElement(i.a.Fragment,null,g.e.isPending(O))}));M.displayName="OutputContent";const C=Object(a.memo)((({action:e,fromAlertWorkaround:t=!1,"data-test-subj":n})=>{const o=Object(b.a)(n),l=Object(c.a)("responseActionsSentinelOneV1Enabled"),{hosts:p,startedAt:m,completedAt:f,command:y,comment:h,parameters:v,agentType:E}=e,j=Object(a.useMemo)((()=>v?Object.entries(v).map((([e,t])=>`${e}: ${t}`)):void 0),[v]),S=d.f[y],O=Object(a.useMemo)((()=>{const e=[{title:g.e.expandSection.placedAt,description:`${m}`},{title:g.e.expandSection.startedAt,description:`${m}`},{title:g.e.expandSection.completedAt,description:`${null!=f?f:x}`},{title:g.e.expandSection.input,description:`${S}`},{title:g.e.expandSection.parameters,description:j?j.join(", "):x},{title:g.e.expandSection.comment,description:h||x},{title:g.e.expandSection.hostname,description:Object(s.reduce)(p,((e,t)=>(t.name.trim().length?e.push(t.name):e.push(x),e)),[]).join(", ")||x}];return l&&e.push({title:g.e.expandSection.agentType,description:Object(u.n)(E)||x}),e.map((({title:e,description:t})=>({title:i.a.createElement(T,null,e),description:i.a.createElement(T,{"data-test-subj":o(`action-details-info-${e}`)},t)})))}),[E,S,h,f,o,p,l,j,m]),C=Object(a.useMemo)((()=>[{title:i.a.createElement(T,null,`${g.e.expandSection.output}:`),description:i.a.createElement(T,{"data-test-subj":o("details-tray-output")},i.a.createElement(M,{action:e,"data-test-subj":n,fromAlertWorkaround:t}))}]),[e,n,t,o]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(I,{"data-test-subj":o("details-tray")},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(w,{listItems:O})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(k,{listItems:C}))))}));C.displayName="ActionsLogExpandedTray"},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(7),i=n(2),r=n.n(i),o=n(19),s=n(4),l=n(42),c=n(964),u=n(130),d=n(405),p=n(923),m=n(208),f=n(16),g=n(293),b=n(661),y=n(966),h=n(135);const v=Object(i.memo)((({togglePopover:e,isDisabled:t,toolTipMessage:n})=>r.a.createElement(o.EuiToolTip,{position:"bottom",content:n},r.a.createElement(o.EuiButtonIcon,{"aria-label":"Update assignees","data-test-subj":h.g,iconType:"plusInCircle",onClick:e,isDisabled:t}))));v.displayName="UpdateAssigneesButton";const E=Object(i.memo)((({eventId:e,assignedUserIds:t,onAssigneesUpdated:n,isPreview:E})=>{const x=Object(f.b)().isPlatinumPlus(),j=Object(m.b)("alert_assignments"),{hasIndexWrite:S}=Object(g.a)(),O=Object(c.a)(),k=Object(i.useMemo)((()=>new Set(t)),[t]),{data:w}=Object(b.a)({uids:k}),[T,I]=Object(i.useState)(!1),M=Object(i.useCallback)((()=>{n&&n()}),[n]),C=Object(i.useCallback)((()=>{I((e=>!e))}),[]),_=Object(i.useCallback)((async t=>{I(!1),O&&await O(t,[e],M,a.noop)}),[e,M,O]),D=Object(o.useGeneratedHtmlId)({prefix:"searchInput"}),A=Object(i.useMemo)((()=>r.a.createElement(o.EuiPopover,{panelPaddingSize:"none",initialFocus:`#${D}`,button:r.a.createElement(v,{togglePopover:C,isDisabled:!S||!x,toolTipMessage:null!=j?j:s.i18n.translate("xpack.securitySolution.flyout.right.visualizations.assignees.popoverTooltip",{defaultMessage:"Assign alert"})}),isOpen:T,panelStyle:{minWidth:d.a},closePopover:C},r.a.createElement(p.a,{searchInputId:D,assignedUserIds:t,onApply:_}))),[t,_,S,x,T,D,C,j]);return r.a.createElement(o.EuiFlexGroup,{"data-test-subj":h.h,direction:"column",gutterSize:"none",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiTitle,{size:"xxs","data-test-subj":h.i},r.a.createElement("h3",null,r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.assignedTitle",defaultMessage:"Assignees"})))),E?Object(u.d)():r.a.createElement(o.EuiFlexGroup,{gutterSize:"none",responsive:!1},w&&r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(y.a,{userProfiles:w,maxVisibleAvatars:2})),r.a.createElement(o.EuiFlexItem,{grow:!1},A)))}));E.displayName="Assignees"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={BULK_QUERY_STATUS_UPDATE:"Data table bulkQueryStatusUpdate",BULK_STATUS_UPDATE:"Data table bulkStatusUpdate",STATUS_UPDATE:"Data table statusUpdate"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(2),i=n.n(a),r=n(44),o=n(19),s=n(1301),l=n.n(s),c=n(1304),u=n(41);const d=n.n(u).a.span.withConfig({displayName:"FlagWrapper",componentId:"sc-pwsog3-0"})(["position:relative;top:1px;"]),p=e=>e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCharCode(55356,56741+e.charCodeAt(0)))):null,m=Object(a.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{Object(a.useEffect)((()=>{t&&Object(r.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c)}),[]);const n=p(e);return null!==n?t?i.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},i.a.createElement(d,{"data-test-subj":"country-flag"},n)):i.a.createElement(d,{"data-test-subj":"country-flag"},n):null}));m.displayName="CountryFlag";const f=Object(a.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{const[n,s]=Object(a.useState)(!1);Object(a.useEffect)((()=>{Object(r.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c),s(!0)}),[]);const u=p(e);return null!==u&&n?t?i.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},i.a.createElement(d,{"data-test-subj":"country-flag"},u)):i.a.createElement(i.a.Fragment,null,i.a.createElement(d,{"data-test-subj":"country-flag"},u),` ${l.a.getName(e,"en")}`):null}));f.displayName="CountryFlagAndName"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(140);const r=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&n.manage},o=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&n.read},s=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&(n.create||n.create_doc||n.index||n.write)},l=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:n}=Object(i.a)();return Object(a.useEffect)((()=>{if(null!=n.result){const{is_authenticated:e,lists:{index:a},listItems:{index:i}}=n.result;t({isAuthenticated:e,canReadIndex:o(a)&&o(i),canManageIndex:r(a)&&r(i),canWriteIndex:s(a)&&s(i)})}}),[n.result]),Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[n.error]),{loading:n.loading,...e}}},function(e,t,n){const a=n(283);e.exports=(e,t)=>{const n=a(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},function(e,t,n){const a=n(164);e.exports=(e,t,n,i,r)=>{"string"==typeof n&&(r=i,i=n,n=void 0);try{return new a(e instanceof a?e.version:e,n).inc(t,i,r).version}catch(e){return null}}},function(e,t,n){const a=n(283);e.exports=(e,t)=>{const n=a(e,null,!0),i=a(t,null,!0),r=n.compare(i);if(0===r)return null;const o=r>0,s=o?n:i,l=o?i:n,c=!!s.prerelease.length;if(l.prerelease.length&&!c)return l.patch||l.minor?s.patch?"patch":s.minor?"minor":"major":"major";const u=c?"pre":"";return n.major!==i.major?u+"major":n.minor!==i.minor?u+"minor":n.patch!==i.patch?u+"patch":"prerelease"}},function(e,t,n){const a=n(164);e.exports=(e,t)=>new a(e,t).major},function(e,t,n){const a=n(164);e.exports=(e,t)=>new a(e,t).minor},function(e,t,n){const a=n(164);e.exports=(e,t)=>new a(e,t).patch},function(e,t,n){const a=n(283);e.exports=(e,t)=>{const n=a(e,t);return n&&n.prerelease.length?n.prerelease:null}},function(e,t,n){const a=n(190);e.exports=(e,t,n)=>a(t,e,n)},function(e,t,n){const a=n(190);e.exports=(e,t)=>a(e,t,!0)},function(e,t,n){const a=n(490);e.exports=(e,t)=>e.sort(((e,n)=>a(e,n,t)))},function(e,t,n){const a=n(490);e.exports=(e,t)=>e.sort(((e,n)=>a(n,e,t)))},function(e,t){e.exports=class LRUCache{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},function(e,t,n){const a=n(193);e.exports=(e,t)=>new a(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},function(e,t,n){const a=n(164),i=n(193);e.exports=(e,t,n)=>{let r=null,o=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(r&&-1!==o.compare(e)||(r=e,o=new a(r,n)))})),r}},function(e,t,n){const a=n(164),i=n(193);e.exports=(e,t,n)=>{let r=null,o=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(r&&1!==o.compare(e)||(r=e,o=new a(r,n)))})),r}},function(e,t,n){const a=n(164),i=n(193),r=n(385);e.exports=(e,t)=>{e=new i(e,t);let n=new a("0.0.0");if(e.test(n))return n;if(n=new a("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let o=null;i.forEach((e=>{const t=new a(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!r(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!o||n&&!r(n,o)||(n=o)}return n&&e.test(n)?n:null}},function(e,t,n){const a=n(193);e.exports=(e,t)=>{try{return new a(e,t).range||"*"}catch(e){return null}}},function(e,t,n){const a=n(493);e.exports=(e,t,n)=>a(e,t,">",n)},function(e,t,n){const a=n(493);e.exports=(e,t,n)=>a(e,t,"<",n)},function(e,t,n){const a=n(193);e.exports=(e,t,n)=>(e=new a(e,n),t=new a(t,n),e.intersects(t,n))},function(e,t,n){const a=n(387),i=n(190);e.exports=(e,t,n)=>{const r=[];let o=null,s=null;const l=e.sort(((e,t)=>i(e,t,n)));for(const e of l)a(e,t,n)?(s=e,o||(o=e)):(s&&r.push([o,s]),s=null,o=null);o&&r.push([o,null]);const c=[];for(const[e,t]of r)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,n){const a=n(193),i=n(386),{ANY:r}=i,o=n(387),s=n(190),l=[new i(">=0.0.0-0")],c=[new i(">=0.0.0")],u=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=n.includePrerelease?l:c}if(1===t.length&&t[0].semver===r){if(n.includePrerelease)return!0;t=c}const a=new Set;let i,u,m,f,g,b,y;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,n):"<"===t.operator||"<="===t.operator?u=p(u,t,n):a.add(t.semver);if(a.size>1)return null;if(i&&u){if(m=s(i.semver,u.semver,n),m>0)return null;if(0===m&&(">="!==i.operator||"<="!==u.operator))return null}for(const e of a){if(i&&!o(e,String(i),n))return null;if(u&&!o(e,String(u),n))return null;for(const a of t)if(!o(e,String(a),n))return!1;return!0}let h=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver,v=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;h&&1===h.prerelease.length&&"<"===u.operator&&0===h.prerelease[0]&&(h=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,b=b||"<"===e.operator||"<="===e.operator,i)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),">"===e.operator||">="===e.operator){if(f=d(i,e,n),f===e&&f!==i)return!1}else if(">="===i.operator&&!o(i.semver,String(e),n))return!1;if(u)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),"<"===e.operator||"<="===e.operator){if(g=p(u,e,n),g===e&&g!==u)return!1}else if("<="===u.operator&&!o(u.semver,String(e),n))return!1;if(!e.operator&&(u||i)&&0!==m)return!1}return!(i&&b&&!u&&0!==m||u&&y&&!i&&0!==m||v||h)},d=(e,t,n)=>{if(!e)return t;const a=s(e.semver,t.semver,n);return a>0?e:a<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,n)=>{if(!e)return t;const a=s(e.semver,t.semver,n);return a<0?e:a>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new a(e,n),t=new a(t,n);let i=!1;e:for(const a of e.set){for(const e of t.set){const t=u(a,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},function(e,t,n){e.exports=n(35)(3843)},function(e,t,n){"use strict";e.exports=function(e){var t=this;this.Parser=function(n){return a(n,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}};var a=n(1132)},function(e,t,n){"use strict";e.exports=n(1133)},function(e,t,n){"use strict";e.exports=function(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),function(e){var t=e||{},n=function(e,t){for(var n=-1;++n<t.length;)m(e,t[n]);return e}({canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:b(C),autolinkProtocol:j,autolinkEmail:j,atxHeading:b(T),blockQuote:b((function(){return{type:"blockquote",children:[]}})),characterEscape:j,characterReference:j,codeFenced:b(w),codeFencedFenceInfo:y,codeFencedFenceMeta:y,codeIndented:b(w,y),codeText:b((function(){return{type:"inlineCode",value:""}}),y),codeTextData:j,data:j,codeFlowValue:j,definition:b((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:y,definitionLabelString:y,definitionTitleString:y,emphasis:b((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:b(I),hardBreakTrailing:b(I),htmlFlow:b(M,y),htmlFlowData:j,htmlText:b(M,y),htmlTextData:j,image:b((function(){return{type:"image",title:null,url:"",alt:null}})),label:y,link:b(C),listItem:b((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){f("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),u("expectingFirstListItemValue"))},listOrdered:b(_,(function(){u("expectingFirstListItemValue",!0)})),listUnordered:b(_),paragraph:b((function(){return{type:"paragraph",children:[]}})),reference:function(){u("referenceType","collapsed")},referenceString:y,resourceDestinationString:y,resourceTitleString:y,setextHeading:b(T),strong:b((function(){return{type:"strong",children:[]}})),thematicBreak:b((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:v(),atxHeadingSequence:function(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)},autolink:v(),autolinkEmail:function(e){S.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){S.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:v(),characterEscapeValue:S,characterReferenceMarkerHexadecimal:k,characterReferenceMarkerNumeric:k,characterReferenceValue:function(e){var t,n,a=this.sliceSerialize(e),i=f("characterReferenceType");i?(t=s(a,"characterReferenceMarkerNumeric"===i?10:16),u("characterReferenceType")):t=d(a),(n=this.stack.pop()).value+=t,n.position.end=g(e.end)},codeFenced:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),u("flowCodeInside")})),codeFencedFence:function(){f("flowCodeInside")||(this.buffer(),u("flowCodeInside",!0))},codeFencedFenceInfo:function(){var e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){var e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:S,codeIndented:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeText:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:S,data:S,definition:v(),definitionDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=o(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:v(),hardBreakEscape:v(O),hardBreakTrailing:v(O),htmlFlow:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:S,htmlText:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:S,image:v((function(){var e=this.stack[this.stack.length-1];f("inReference")?(e.type+="Reference",e.referenceType=f("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),label:function(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,u("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t},labelText:function(e){this.stack[this.stack.length-2].identifier=o(this.sliceSerialize(e)).toLowerCase()},lineEnding:function(e){var t=this.stack[this.stack.length-1];if(f("atHardBreak"))return t.children[t.children.length-1].position.end=g(e.end),void u("atHardBreak");!f("setextHeadingSlurpLineEnding")&&n.canContainEols.indexOf(t.type)>-1&&(j.call(this,e),S.call(this,e))},link:v((function(){var e=this.stack[this.stack.length-1];f("inReference")?(e.type+="Reference",e.referenceType=f("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),listItem:v(),listOrdered:v(),listUnordered:v(),paragraph:v(),referenceString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=o(this.sliceSerialize(e)).toLowerCase(),u("referenceType","full")},resourceDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){u("inReference")},setextHeading:v((function(){u("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2},setextHeadingText:function(){u("setextHeadingSlurpLineEnding",!0)},strong:v(),thematicBreak:v()}},t.mdastExtensions||[]),l={};return function(e){for(var t,a=[{type:"root",children:[]}],o=[],s=[],l=-1,d={stack:a,tokenStack:o,config:n,enter:h,exit:E,buffer:y,resume:x,setData:u,getData:f};++l<e.length;)"listOrdered"!==e[l][1].type&&"listUnordered"!==e[l][1].type||("enter"===e[l][0]?s.push(l):l=c(e,s.pop(l),l));for(l=-1;++l<e.length;)t=n[e[l][0]],r.call(t,e[l][1].type)&&t[e[l][1].type].call(i({sliceSerialize:e[l][2].sliceSerialize},d),e[l][1]);if(o.length)throw new Error("Cannot close document, a token (`"+o[o.length-1].type+"`, "+p({start:o[o.length-1].start,end:o[o.length-1].end})+") is still open");return a[0].position={start:g(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:g(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},a[0]};function c(e,t,n){for(var a,i,r,o,s,l,c,u=t-1,d=-1,p=!1;++u<=n;)if("listUnordered"===(s=e[u])[1].type||"listOrdered"===s[1].type||"blockQuote"===s[1].type?("enter"===s[0]?d++:d--,c=void 0):"lineEndingBlank"===s[1].type?"enter"===s[0]&&(!a||c||d||l||(l=u),c=void 0):"linePrefix"===s[1].type||"listItemValue"===s[1].type||"listItemMarker"===s[1].type||"listItemPrefix"===s[1].type||"listItemPrefixWhitespace"===s[1].type||(c=void 0),!d&&"enter"===s[0]&&"listItemPrefix"===s[1].type||-1===d&&"exit"===s[0]&&("listUnordered"===s[1].type||"listOrdered"===s[1].type)){if(a){for(i=u,r=void 0;i--;)if("lineEnding"===(o=e[i])[1].type||"lineEndingBlank"===o[1].type){if("exit"===o[0])continue;r&&(e[r][1].type="lineEndingBlank",p=!0),o[1].type="lineEnding",r=i}else if("linePrefix"!==o[1].type&&"blockQuotePrefix"!==o[1].type&&"blockQuotePrefixWhitespace"!==o[1].type&&"blockQuoteMarker"!==o[1].type&&"listItemIndent"!==o[1].type)break;l&&(!r||l<r)&&(a._spread=!0),a.end=g(r?e[r][1].start:s[1].end),e.splice(r||u,0,["exit",a,s[2]]),u++,n++}"listItemPrefix"===s[1].type&&(a={type:"listItem",_spread:!1,start:g(s[1].start)},e.splice(u,0,["enter",a,s[2]]),u++,n++,l=void 0,c=!0)}return e[t][1]._spread=p,n}function u(e,t){l[e]=t}function f(e){return l[e]}function g(e){return{line:e.line,column:e.column,offset:e.offset}}function b(e,t){return function(n){h.call(this,e(n),n),t&&t.call(this,n)}}function y(){this.stack.push({type:"fragment",children:[]})}function h(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:g(t.start)},e}function v(e){return function(t){e&&e.call(this,t),E.call(this,t)}}function E(e){var t=this.stack.pop(),n=this.tokenStack.pop();if(!n)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): it’s not open");if(n.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+p({start:n.start,end:n.end})+") is open");return t.position.end=g(e.end),t}function x(){return a(this.stack.pop())}function j(e){var t=this.stack[this.stack.length-1].children,n=t[t.length-1];n&&"text"===n.type||((n={type:"text",value:""}).position={start:g(e.start)},this.stack[this.stack.length-1].children.push(n)),this.stack.push(n)}function S(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=g(e.end)}function O(){u("atHardBreak",!0)}function k(e){u("characterReferenceType",e.type)}function w(){return{type:"code",lang:null,meta:null,value:""}}function T(){return{type:"heading",depth:void 0,children:[]}}function I(){return{type:"break"}}function M(){return{type:"html",value:""}}function C(){return{type:"link",title:null,url:"",children:[]}}function _(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(n)(u(l(n).document().write(c()(e,t,!0))))};var a=n(1134),i=n(335),r=n(676),o=n(494),s=n(1135),l=n(1136),c=n(1175),u=n(1176),d=n(681),p=n(1177);function m(e,t){var n,a;for(n in t)a=r.call(e,n)?e[n]:e[n]={},"canContainEols"===n?e[n]=[].concat(a,t[n]):Object.assign(a,t[n])}},function(e,t,n){"use strict";function a(e){return e&&(e.value||e.alt||e.title||"children"in e&&i(e.children)||"length"in e&&i(e))||""}function i(e){for(var t=[],n=-1;++n<e.length;)t[n]=a(e[n]);return t.join("")}e.exports=a},function(e,t,n){"use strict";var a=n(388);e.exports=function(e,t){var n=parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||!(65535&~n)||65534==(65535&n)||n>1114111?"�":a(n)}},function(e,t,n){"use strict";var a=n(1137),i=n(1138),r=n(1139),o=n(679),s=n(1142),l=n(1143),c=n(495),u=n(1146);e.exports=function(e){var t={defined:[],constructs:s([u].concat(c((e||{}).extensions))),content:n(a),document:n(i),flow:n(r),string:n(o.string),text:n(o.text)};return t;function n(e){return function(n){return l(t,e,n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(155),i=n(160);t.tokenize=function(e){var t,n=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null!==t)return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,n,"linePrefix");e.consume(t)}),(function(t){return e.enter("paragraph"),r(t)}));return n;function r(n){var a=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=a),t=a,o(n)}function o(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):a(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(155),i=n(160),r=n(389),o={tokenize:function(e,t,n){return i(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},s={tokenize:function(e,t,n){return i(e,e.lazy(this.parser.constructs.flow,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};t.tokenize=function(e){var t,n,i,l=this,c=[],u=0,d={tokenize:function(e,a){var i=0;return t={},u;function u(a){return i<c.length?(l.containerState=c[i][1],e.attempt(c[i][0].continuation,d,p)(a)):n.currentConstruct&&n.currentConstruct.concrete?(t.flowContinue=!0,g(a)):(l.interrupt=n.currentConstruct&&n.currentConstruct.interruptible,l.containerState={},e.attempt(o,f,g)(a))}function d(e){return i++,l.containerState._closeFlow?f(e):u(e)}function p(t){return n.currentConstruct&&n.currentConstruct.lazy?(l.containerState={},e.attempt(o,f,e.attempt(s,f,e.check(r,f,m)))(t)):f(t)}function m(e){return i=c.length,t.lazy=!0,t.flowContinue=!0,g(e)}function f(e){return t.flowEnd=!0,g(e)}function g(e){return t.continued=i,l.interrupt=l.containerState=void 0,a(e)}},partial:!0};return p;function p(t){return u<c.length?(l.containerState=c[u][1],e.attempt(c[u][0].continuation,m,f)(t)):f(t)}function m(e){return u++,p(e)}function f(a){return t&&t.flowContinue?b(a):(l.interrupt=n&&n.currentConstruct&&n.currentConstruct.interruptible,l.containerState={},e.attempt(o,g,b)(a))}function g(e){return c.push([l.currentConstruct,l.containerState]),l.containerState=void 0,f(e)}function b(t){return null===t?(E(0,!0),void e.consume(t)):(n=n||l.parser.flow(l.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:n}),y(t))}function y(t){return null===t?(v(e.exit("chunkFlow")),b(t)):a(t)?(e.consume(t),v(e.exit("chunkFlow")),e.check(d,h)):(e.consume(t),y)}function h(e){return E(t.continued,t&&t.flowEnd),u=0,p(e)}function v(e){i&&(i.next=e),i=e,n.lazy=t&&t.lazy,n.defineSkip(e.start),n.write(l.sliceStream(e))}function E(t,a){var r=c.length;for(n&&a&&(n.write([null]),i=n=void 0);r-- >t;)l.containerState=c[r][1],c[r][0].exit.call(l,e);c.length=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1140),i=n(160),r=n(389);t.tokenize=function(e){var t=this,n=e.attempt(r,(function(a){if(null!==a)return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n;e.consume(a)}),e.attempt(this.parser.constructs.flowInitial,o,i(e,e.attempt(this.parser.constructs.flow,o,e.attempt(a,o)),"linePrefix")));return n;function o(a){if(null!==a)return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(a)}}},function(e,t,n){"use strict";var a=n(155),i=n(390),r=n(678),o=n(160),s={tokenize:function(e,t){var n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):a(t)?e.check(l,o,r)(t):(e.consume(t),i)}function r(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function o(t){return e.consume(t),e.exit("chunkContent"),n=n.next=e.enter("chunkContent",{contentType:"content",previous:n}),i}},resolve:function(e){return r(e),e},interruptible:!0,lazy:!0},l={tokenize:function(e,t,n){var r=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o(e,s,"linePrefix")};function s(o){return null===o||a(o)?n(o):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||i(r.events,"linePrefix")<4?e.interrupt(r.parser.constructs.flow,n,t)(o):t(o)}},partial:!0};e.exports=s},function(e,t,n){"use strict";var a=[].splice;e.exports=a},function(e,t,n){"use strict";var a=n(676),i=n(238),r=n(495);function o(e,t){var n,i,o,l;for(n in t)for(l in i=a.call(e,n)?e[n]:e[n]={},o=t[n])i[l]=s(r(o[l]),a.call(i,l)?i[l]:[])}function s(e,t){for(var n=-1,a=[];++n<e.length;)("after"===e[n].add?t:a).push(e[n]);return i(t,0,0,a),t}e.exports=function(e){for(var t={},n=-1;++n<e.length;)o(t,e[n]);return t}},function(e,t,n){"use strict";var a=n(335),i=n(155),r=n(496),o=n(238),s=n(495),l=n(497),c=n(1144),u=n(286),d=n(1145);e.exports=function(e,t,n){var p=n?u(n):{line:1,column:1,offset:0},m={},f=[],g=[],b=[],y={consume:function(e){i(e)?(p.line++,p.column=1,p.offset+=-3===e?2:1,w()):-1!==e&&(p.column++,p.offset++),p._bufferIndex<0?p._index++:(p._bufferIndex++,p._bufferIndex===g[p._index].length&&(p._bufferIndex=-1,p._index++)),h.previous=e},enter:function(e,t){var n=t||{};return n.type=e,n.start=x(),h.events.push(["enter",n,h]),b.push(n),n},exit:function(e){var t=b.pop();return t.end=x(),h.events.push(["exit",t,h]),t},attempt:O((function(e,t){k(e,t.from)})),check:O(S),interrupt:O(S,{interrupt:!0}),lazy:O(S,{lazy:!0})},h={previous:null,events:[],parser:e,sliceStream:E,sliceSerialize:function(e){return c(E(e))},now:x,defineSkip:function(e){m[e.line]=e.column,w()},write:function(e){return g=r(g,e),function(){for(var e,t;p._index<g.length;)if("string"==typeof(t=g[p._index]))for(e=p._index,p._bufferIndex<0&&(p._bufferIndex=0);p._index===e&&p._bufferIndex<t.length;)j(t.charCodeAt(p._bufferIndex));else j(t)}(),null!==g[g.length-1]?[]:(k(t,0),h.events=l(f,h.events,h),h.events)}},v=t.tokenize.call(h,y);return t.resolveAll&&f.push(t),p._index=0,p._bufferIndex=-1,h;function E(e){return d(g,e)}function x(){return u(p)}function j(e){v=v(e)}function S(e,t){t.restore()}function O(e,t){return function(n,i,r){var o,l,c,u;return n.tokenize||"length"in n?d(s(n)):function(e){return e in n||null in n?d(n.null?s(n[e]).concat(s(n.null)):n[e])(e):r(e)};function d(e){return o=e,m(e[l=0])}function m(e){return function(n){var i,r,o,s,l;return i=x(),r=h.previous,o=h.currentConstruct,s=h.events.length,l=Array.from(b),u={restore:function(){p=i,h.previous=r,h.currentConstruct=o,h.events.length=s,b=l,w()},from:s},c=e,e.partial||(h.currentConstruct=e),e.name&&h.parser.constructs.disable.null.indexOf(e.name)>-1?g():e.tokenize.call(t?a({},h,t):h,y,f,g)(n)}}function f(t){return e(c,u),i}function g(e){return u.restore(),++l<o.length?m(o[l]):r}}}function k(e,t){e.resolveAll&&f.indexOf(e)<0&&f.push(e),e.resolve&&o(h.events,t,h.events.length-t,e.resolve(h.events.slice(t),h)),e.resolveTo&&(h.events=e.resolveTo(h.events,h))}function w(){p.line in m&&p.column<2&&(p.column=m[p.line],p.offset+=m[p.line]-1)}}},function(e,t,n){"use strict";var a=n(388);e.exports=function(e){for(var t,n,i,r=-1,o=[];++r<e.length;){if("string"==typeof(t=e[r]))n=t;else if(-5===t)n="\r";else if(-4===t)n="\n";else if(-3===t)n="\r\n";else if(-2===t)n="\t";else if(-1===t){if(i)continue;n=" "}else n=a(t);i=-2===t,o.push(n)}return o.join("")}},function(e,t,n){"use strict";e.exports=function(e,t){var n,a=t.start._index,i=t.start._bufferIndex,r=t.end._index,o=t.end._bufferIndex;return a===r?n=[e[a].slice(i,o)]:(n=e.slice(a,r),i>-1&&(n[0]=n[0].slice(i)),o>0&&n.push(e[r].slice(0,o))),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(679),i=n(1147),r=n(1153),o=n(1155),s=n(1156),l=n(1158),c=n(1160),u=n(1161),d=n(1162),p=n(1163),m=n(1164),f=n(1165),g=n(1166),b=n(1169),y=n(499),h=n(1170),v=n(1171),E=n(1172),x=n(1173),j=n(1174),S=n(687),O={42:x,43:x,45:x,48:x,49:x,50:x,51:x,52:x,53:x,54:x,55:x,56:x,57:x,62:o},k={91:p},w={"-2":u,"-1":u,32:u},T={35:f,42:S,45:[j,S],60:g,61:j,95:S,96:c,126:c},I={38:l,92:s},M={"-5":E,"-4":E,"-3":E,33:h,38:l,42:i,60:[r,b],91:v,92:[m,s],93:y,95:i,96:d},C={null:[i,a.resolver]};t.contentInitial=k,t.disable={null:[]},t.document=O,t.flow=T,t.flowInitial=w,t.insideSpan=C,t.string=I,t.text=M},function(e,t,n){"use strict";var a=n(496),i=n(238),r=n(1148),o=n(1152),s=n(497),l=n(286),c={name:"attention",tokenize:function(e,t){var n,a=r(this.previous);return function(t){return e.enter("attentionSequence"),n=t,i(t)};function i(o){var s,l,c,u;return o===n?(e.consume(o),i):(s=e.exit("attentionSequence"),c=!(l=r(o))||2===l&&a,u=!a||2===a&&l,s._open=42===n?c:c&&(a||!u),s._close=42===n?u:u&&(l||!c),t(o))}},resolveAll:function(e,t){for(var n,r,c,u,d,p,m,f,g=-1;++g<e.length;)if("enter"===e[g][0]&&"attentionSequence"===e[g][1].type&&e[g][1]._close)for(n=g;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[g][1]).charCodeAt(0)){if((e[n][1]._close||e[g][1]._open)&&(e[g][1].end.offset-e[g][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[g][1].end.offset-e[g][1].start.offset)%3))continue;u={type:(p=e[n][1].end.offset-e[n][1].start.offset>1&&e[g][1].end.offset-e[g][1].start.offset>1?2:1)>1?"strongSequence":"emphasisSequence",start:o(l(e[n][1].end),-p),end:l(e[n][1].end)},d={type:p>1?"strongSequence":"emphasisSequence",start:l(e[g][1].start),end:o(l(e[g][1].start),p)},c={type:p>1?"strongText":"emphasisText",start:l(e[n][1].end),end:l(e[g][1].start)},r={type:p>1?"strong":"emphasis",start:l(u.start),end:l(d.end)},e[n][1].end=l(u.start),e[g][1].start=l(d.end),m=[],e[n][1].end.offset-e[n][1].start.offset&&(m=a(m,[["enter",e[n][1],t],["exit",e[n][1],t]])),m=a(m,[["enter",r,t],["enter",u,t],["exit",u,t],["enter",c,t]]),m=a(m,s(t.parser.constructs.insideSpan.null,e.slice(n+1,g),t)),m=a(m,[["exit",c,t],["enter",d,t],["exit",d,t],["exit",r,t]]),e[g][1].end.offset-e[g][1].start.offset?(f=2,m=a(m,[["enter",e[g][1],t],["exit",e[g][1],t]])):f=0,i(e,n-1,g-n+3,m),g=n+m.length-f-2;break}for(g=-1;++g<e.length;)"attentionSequence"===e[g][1].type&&(e[g][1].type="data");return e}};e.exports=c},function(e,t,n){"use strict";var a=n(239),i=n(1149),r=n(1151);e.exports=function(e){return null===e||a(e)||r(e)?1:i(e)?2:void 0}},function(e,t,n){"use strict";var a=n(1150),i=n(240)(a);e.exports=i},function(e,t,n){"use strict";e.exports=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/},function(e,t,n){"use strict";var a=n(240)(/\s/);e.exports=a},function(e,t,n){"use strict";e.exports=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e}},function(e,t,n){"use strict";var a=n(498),i=n(391),r=n(1154),o=n(680),s={name:"autolink",tokenize:function(e,t,n){var s=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l};function l(t){return a(t)?(e.consume(t),c):r(t)?p(t):n(t)}function c(e){return 43===e||45===e||46===e||i(e)?u(e):p(e)}function u(t){return 58===t?(e.consume(t),d):(43===t||45===t||46===t||i(t))&&s++<32?(e.consume(t),u):p(t)}function d(t){return 62===t?(e.exit("autolinkProtocol"),b(t)):32===t||60===t||o(t)?n(t):(e.consume(t),d)}function p(t){return 64===t?(e.consume(t),s=0,m):r(t)?(e.consume(t),p):n(t)}function m(e){return i(e)?f(e):n(e)}function f(t){return 46===t?(e.consume(t),s=0,m):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",b(t)):g(t)}function g(t){return(45===t||i(t))&&s++<63?(e.consume(t),45===t?g:f):n(t)}function b(n){return e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t}}};e.exports=s},function(e,t,n){"use strict";var a=n(240)(/[#-'*+\--9=?A-Z^-~]/);e.exports=a},function(e,t,n){"use strict";var a=n(220),i=n(160),r={name:"blockQuote",tokenize:function(e,t,n){var i=this;return function(t){return 62===t?(i.containerState.open||(e.enter("blockQuote",{_container:!0}),i.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r):n(t)};function r(n){return a(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){return i(e,e.attempt(r,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};e.exports=r},function(e,t,n){"use strict";var a=n(1157),i={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return a(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}};e.exports=i},function(e,t,n){"use strict";var a=n(240)(/[!-/:-@[-`{-~]/);e.exports=a},function(e,t,n){"use strict";var a=n(681),i=n(391),r=n(682),o=n(1159);function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=s(a),c={name:"characterReference",tokenize:function(e,t,n){var a,s,c=this,u=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),d};function d(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),a=31,s=i,m(t))}function p(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,s=o,m):(e.enter("characterReferenceValue"),a=7,s=r,m(t))}function m(r){var o;return 59===r&&u?(o=e.exit("characterReferenceValue"),s!==i||l.default(c.sliceSerialize(o))?(e.enter("characterReferenceMarker"),e.consume(r),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(r)):s(r)&&u++<a?(e.consume(r),m):n(r)}}};e.exports=c},function(e,t,n){"use strict";var a=n(240)(/[\dA-Fa-f]/);e.exports=a},function(e,t,n){"use strict";var a=n(155),i=n(239),r=n(390),o=n(160),s={name:"codeFenced",tokenize:function(e,t,n){var s,l=this,c={tokenize:function(e,t,n){var i=0;return o(e,(function(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),r(t)}),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function r(t){return t===s?(e.consume(t),i++,r):i<d?n(t):(e.exit("codeFencedFenceSequence"),o(e,l,"whitespace")(t))}function l(i){return null===i||a(i)?(e.exit("codeFencedFence"),t(i)):n(i)}},partial:!0},u=r(this.events,"linePrefix"),d=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),s=t,p(t)};function p(t){return t===s?(e.consume(t),d++,p):(e.exit("codeFencedFenceSequence"),d<3?n(t):o(e,m,"whitespace")(t))}function m(t){return null===t||a(t)?y(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(t))}function f(t){return null===t||i(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),o(e,g,"whitespace")(t)):96===t&&t===s?n(t):(e.consume(t),f)}function g(t){return null===t||a(t)?y(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),b(t))}function b(t){return null===t||a(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),y(t)):96===t&&t===s?n(t):(e.consume(t),b)}function y(n){return e.exit("codeFencedFence"),l.interrupt?t(n):h(n)}function h(t){return null===t?E(t):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(c,E,u?o(e,h,"linePrefix",u+1):h)):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||a(t)?(e.exit("codeFlowValue"),h(t)):(e.consume(t),v)}function E(n){return e.exit("codeFenced"),t(n)}},concrete:!0};e.exports=s},function(e,t,n){"use strict";var a=n(155),i=n(238),r=n(390),o=n(160),s={name:"codeIndented",tokenize:function(e,t,n){return e.attempt(l,i,n);function i(n){return null===n?t(n):a(n)?e.attempt(l,i,t)(n):(e.enter("codeFlowValue"),r(n))}function r(t){return null===t||a(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),r)}},resolve:function(e,t){var n={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return i(e,0,0,[["enter",n,t]]),i(e,e.length,0,[["exit",n,t]]),e}},l={tokenize:function(e,t,n){var i=this;return o(e,(function s(l){return a(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o(e,s,"linePrefix",5)):r(i.events,"linePrefix")<4?n(l):t(l)}),"linePrefix",5)},partial:!0};e.exports=s},function(e,t,n){"use strict";var a=n(155),i={name:"codeText",tokenize:function(e,t,n){var i,r,o=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),o++,s):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?n(t):96===t?(r=e.enter("codeTextSequence"),i=0,u(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||a(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),c)}function u(n){return 96===n?(e.consume(n),i++,u):i===o?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(r.type="codeTextData",c(n))}},resolve:function(e){var t,n,a=e.length-4,i=3;if(!("lineEnding"!==e[i][1].type&&"space"!==e[i][1].type||"lineEnding"!==e[a][1].type&&"space"!==e[a][1].type))for(t=i;++t<a;)if("codeTextData"===e[t][1].type){e[a][1].type=e[i][1].type="codeTextPadding",i+=2,a-=2;break}for(t=i-1,a++;++t<=a;)void 0===n?t!==a&&"lineEnding"!==e[t][1].type&&(n=t):t!==a&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),a-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};e.exports=i},function(e,t,n){"use strict";var a=n(155),i=n(239),r=n(494),o=n(683),s=n(684),l=n(160),c=n(685),u=n(686),d={name:"definition",tokenize:function(e,t,n){var i,u=this;return function(t){return e.enter("definition"),s.call(u,e,d,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function d(t){return i=r(u.sliceSerialize(u.events[u.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),c(e,o(e,e.attempt(p,l(e,m,"whitespace"),l(e,m,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(t)}function m(r){return null===r||a(r)?(e.exit("definition"),u.parser.defined.indexOf(i)<0&&u.parser.defined.push(i),t(r)):n(r)}}},p={tokenize:function(e,t,n){return function(t){return i(t)?c(e,r)(t):n(t)};function r(t){return 34===t||39===t||40===t?u(e,l(e,o,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):n(t)}function o(e){return null===e||a(e)?t(e):n(e)}},partial:!0};e.exports=d},function(e,t,n){"use strict";var a=n(155),i={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),i};function i(i){return a(i)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(i)):n(i)}}};e.exports=i},function(e,t,n){"use strict";var a=n(155),i=n(239),r=n(220),o=n(238),s=n(160),l={name:"headingAtx",tokenize:function(e,t,n){var o=this,l=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),c(t)};function c(a){return 35===a&&l++<6?(e.consume(a),c):null===a||i(a)?(e.exit("atxHeadingSequence"),o.interrupt?t(a):u(a)):n(a)}function u(n){return 35===n?(e.enter("atxHeadingSequence"),d(n)):null===n||a(n)?(e.exit("atxHeading"),t(n)):r(n)?s(e,u,"whitespace")(n):(e.enter("atxHeadingText"),p(n))}function d(t){return 35===t?(e.consume(t),d):(e.exit("atxHeadingSequence"),u(t))}function p(t){return null===t||35===t||i(t)?(e.exit("atxHeadingText"),u(t)):(e.consume(t),p)}},resolve:function(e,t){var n,a,i=e.length-2,r=3;return"whitespace"===e[r][1].type&&(r+=2),i-2>r&&"whitespace"===e[i][1].type&&(i-=2),"atxHeadingSequence"===e[i][1].type&&(r===i-1||i-4>r&&"whitespace"===e[i-2][1].type)&&(i-=r+1===i?2:4),i>r&&(n={type:"atxHeadingText",start:e[r][1].start,end:e[i][1].end},a={type:"chunkText",start:e[r][1].start,end:e[i][1].end,contentType:"text"},o(e,r,i-r+1,[["enter",n,t],["enter",a,t],["exit",a,t],["exit",n,t]])),e}};e.exports=l},function(e,t,n){"use strict";var a=n(498),i=n(391),r=n(155),o=n(239),s=n(220),l=n(388),c=n(1167),u=n(1168),d=n(389),p={name:"htmlFlow",tokenize:function(e,t,n){var d,p,f,g,b,y=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),h};function h(i){return 33===i?(e.consume(i),v):47===i?(e.consume(i),j):63===i?(e.consume(i),d=3,y.interrupt?t:$):a(i)?(e.consume(i),f=l(i),p=!0,S):n(i)}function v(i){return 45===i?(e.consume(i),d=2,E):91===i?(e.consume(i),d=5,f="CDATA[",g=0,x):a(i)?(e.consume(i),d=4,y.interrupt?t:$):n(i)}function E(a){return 45===a?(e.consume(a),y.interrupt?t:$):n(a)}function x(a){return a===f.charCodeAt(g++)?(e.consume(a),g===f.length?y.interrupt?t:N:x):n(a)}function j(t){return a(t)?(e.consume(t),f=l(t),S):n(t)}function S(a){return null===a||47===a||62===a||o(a)?47!==a&&p&&u.indexOf(f.toLowerCase())>-1?(d=1,y.interrupt?t(a):N(a)):c.indexOf(f.toLowerCase())>-1?(d=6,47===a?(e.consume(a),O):y.interrupt?t(a):N(a)):(d=7,y.interrupt?n(a):p?w(a):k(a)):45===a||i(a)?(e.consume(a),f+=l(a),S):n(a)}function O(a){return 62===a?(e.consume(a),y.interrupt?t:N):n(a)}function k(t){return s(t)?(e.consume(t),k):A(t)}function w(t){return 47===t?(e.consume(t),A):58===t||95===t||a(t)?(e.consume(t),T):s(t)?(e.consume(t),w):A(t)}function T(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),T):I(t)}function I(t){return 61===t?(e.consume(t),M):s(t)?(e.consume(t),I):w(t)}function M(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),b=t,C):s(t)?(e.consume(t),M):(b=void 0,_(t))}function C(t){return t===b?(e.consume(t),D):null===t||r(t)?n(t):(e.consume(t),C)}function _(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||o(t)?I(t):(e.consume(t),_)}function D(e){return 47===e||62===e||s(e)?w(e):n(e)}function A(t){return 62===t?(e.consume(t),F):n(t)}function F(t){return s(t)?(e.consume(t),F):null===t||r(t)?N(t):n(t)}function N(t){return 45===t&&2===d?(e.consume(t),L):60===t&&1===d?(e.consume(t),z):62===t&&4===d?(e.consume(t),V):63===t&&3===d?(e.consume(t),$):93===t&&5===d?(e.consume(t),B):!r(t)||6!==d&&7!==d?null===t||r(t)?P(t):(e.consume(t),N):e.check(m,V,P)(t)}function P(t){return e.exit("htmlFlowData"),R(t)}function R(t){return null===t?U(t):r(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),R):(e.enter("htmlFlowData"),N(t))}function L(t){return 45===t?(e.consume(t),$):N(t)}function z(t){return 47===t?(e.consume(t),f="",q):N(t)}function q(t){return 62===t&&u.indexOf(f.toLowerCase())>-1?(e.consume(t),V):a(t)&&f.length<8?(e.consume(t),f+=l(t),q):N(t)}function B(t){return 93===t?(e.consume(t),$):N(t)}function $(t){return 62===t?(e.consume(t),V):N(t)}function V(t){return null===t||r(t)?(e.exit("htmlFlowData"),U(t)):(e.consume(t),V)}function U(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){for(var t=e.length;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},m={tokenize:function(e,t,n){return function(a){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),e.attempt(d,t,n)}},partial:!0};e.exports=p},function(e,t,n){"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},function(e,t,n){"use strict";e.exports=["pre","script","style","textarea"]},function(e,t,n){"use strict";var a=n(498),i=n(391),r=n(155),o=n(239),s=n(220),l=n(160),c={name:"htmlText",tokenize:function(e,t,n){var c,u,d,p,m=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),f};function f(t){return 33===t?(e.consume(t),g):47===t?(e.consume(t),I):63===t?(e.consume(t),w):a(t)?(e.consume(t),_):n(t)}function g(t){return 45===t?(e.consume(t),b):91===t?(e.consume(t),u="CDATA[",d=0,x):a(t)?(e.consume(t),k):n(t)}function b(t){return 45===t?(e.consume(t),y):n(t)}function y(t){return null===t||62===t?n(t):45===t?(e.consume(t),h):v(t)}function h(e){return null===e||62===e?n(e):v(e)}function v(t){return null===t?n(t):45===t?(e.consume(t),E):r(t)?(p=v,z(t)):(e.consume(t),v)}function E(t){return 45===t?(e.consume(t),B):v(t)}function x(t){return t===u.charCodeAt(d++)?(e.consume(t),d===u.length?j:x):n(t)}function j(t){return null===t?n(t):93===t?(e.consume(t),S):r(t)?(p=j,z(t)):(e.consume(t),j)}function S(t){return 93===t?(e.consume(t),O):j(t)}function O(t){return 62===t?B(t):93===t?(e.consume(t),O):j(t)}function k(t){return null===t||62===t?B(t):r(t)?(p=k,z(t)):(e.consume(t),k)}function w(t){return null===t?n(t):63===t?(e.consume(t),T):r(t)?(p=w,z(t)):(e.consume(t),w)}function T(e){return 62===e?B(e):w(e)}function I(t){return a(t)?(e.consume(t),M):n(t)}function M(t){return 45===t||i(t)?(e.consume(t),M):C(t)}function C(t){return r(t)?(p=C,z(t)):s(t)?(e.consume(t),C):B(t)}function _(t){return 45===t||i(t)?(e.consume(t),_):47===t||62===t||o(t)?D(t):n(t)}function D(t){return 47===t?(e.consume(t),B):58===t||95===t||a(t)?(e.consume(t),A):r(t)?(p=D,z(t)):s(t)?(e.consume(t),D):B(t)}function A(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),A):F(t)}function F(t){return 61===t?(e.consume(t),N):r(t)?(p=F,z(t)):s(t)?(e.consume(t),F):D(t)}function N(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),c=t,P):r(t)?(p=N,z(t)):s(t)?(e.consume(t),N):(e.consume(t),c=void 0,L)}function P(t){return t===c?(e.consume(t),R):null===t?n(t):r(t)?(p=P,z(t)):(e.consume(t),P)}function R(e){return 62===e||47===e||o(e)?D(e):n(e)}function L(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):62===t||o(t)?D(t):(e.consume(t),L)}function z(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l(e,q,"linePrefix",m.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function q(t){return e.enter("htmlTextData"),p(t)}function B(a){return 62===a?(e.consume(a),e.exit("htmlTextData"),e.exit("htmlText"),t):n(a)}}};e.exports=c},function(e,t,n){"use strict";var a={name:"labelStartImage",tokenize:function(e,t,n){var a=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),i};function i(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),r):n(t)}function r(e){return 94===e&&"_hiddenFootnoteSupport"in a.parser.constructs?n(e):t(e)}},resolveAll:n(499).resolveAll};e.exports=a},function(e,t,n){"use strict";var a={name:"labelStartLink",tokenize:function(e,t,n){var a=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),i};function i(e){return 94===e&&"_hiddenFootnoteSupport"in a.parser.constructs?n(e):t(e)}},resolveAll:n(499).resolveAll};e.exports=a},function(e,t,n){"use strict";var a=n(160),i={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),a(e,t,"linePrefix")}}};e.exports=i},function(e,t,n){"use strict";var a=n(682),i=n(220),r=n(390),o=n(677),s=n(160),l=n(389),c=n(687),u={name:"list",tokenize:function(e,t,n){var s=this,u=r(s.events,"linePrefix"),p=0;return function(t){var i=s.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===i?!s.containerState.marker||t===s.containerState.marker:a(t)){if(s.containerState.type||(s.containerState.type=i,e.enter(i,{_container:!0})),"listUnordered"===i)return e.enter("listItemPrefix"),42===t||45===t?e.check(c,n,f)(t):f(t);if(!s.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(t)}return n(t)};function m(t){return a(t)&&++p<10?(e.consume(t),m):(!s.interrupt||p<2)&&(s.containerState.marker?t===s.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),f(t)):n(t)}function f(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),s.containerState.marker=s.containerState.marker||t,e.check(l,s.interrupt?n:g,e.attempt(d,y,b))}function g(e){return s.containerState.initialBlankLine=!0,u++,y(e)}function b(t){return i(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),y):n(t)}function y(n){return s.containerState.size=u+o(s.sliceStream(e.exit("listItemPrefix"))),t(n)}},continuation:{tokenize:function(e,t,n){var a=this;return a.containerState._closeFlow=void 0,e.check(l,(function(n){return a.containerState.furtherBlankLines=a.containerState.furtherBlankLines||a.containerState.initialBlankLine,s(e,t,"listItemIndent",a.containerState.size+1)(n)}),(function(n){return a.containerState.furtherBlankLines||!i(n)?(a.containerState.furtherBlankLines=a.containerState.initialBlankLine=void 0,r(n)):(a.containerState.furtherBlankLines=a.containerState.initialBlankLine=void 0,e.attempt(p,t,r)(n))}));function r(i){return a.containerState._closeFlow=!0,a.interrupt=void 0,s(e,e.attempt(u,t,n),"linePrefix",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(i)}}},exit:function(e){e.exit(this.containerState.type)}},d={tokenize:function(e,t,n){var a=this;return s(e,(function(e){return i(e)||!r(a.events,"listItemPrefixWhitespace")?n(e):t(e)}),"listItemPrefixWhitespace",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},p={tokenize:function(e,t,n){var a=this;return s(e,(function(e){return r(a.events,"listItemIndent")===a.containerState.size?t(e):n(e)}),"listItemIndent",a.containerState.size+1)},partial:!0};e.exports=u},function(e,t,n){"use strict";var a=n(155),i=n(286),r=n(160),o={name:"setextUnderline",tokenize:function(e,t,n){for(var i,o,s=this,l=s.events.length;l--;)if("lineEnding"!==s.events[l][1].type&&"linePrefix"!==s.events[l][1].type&&"content"!==s.events[l][1].type){o="paragraph"===s.events[l][1].type;break}return function(t){return s.lazy||!s.interrupt&&!o?n(t):(e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),i=t,c(t))};function c(t){return t===i?(e.consume(t),c):(e.exit("setextHeadingLineSequence"),r(e,u,"lineSuffix")(t))}function u(i){return null===i||a(i)?(e.exit("setextHeadingLine"),t(i)):n(i)}},resolveTo:function(e,t){for(var n,a,r,o,s=e.length;s--;)if("enter"===e[s][0]){if("content"===e[s][1].type){n=s;break}"paragraph"===e[s][1].type&&(a=s)}else"content"===e[s][1].type&&e.splice(s,1),r||"definition"!==e[s][1].type||(r=s);return o={type:"setextHeading",start:i(e[a][1].start),end:i(e[e.length-1][1].end)},e[a][1].type="setextHeadingText",r?(e.splice(a,0,["enter",o,t]),e.splice(r+1,0,["exit",e[n][1],t]),e[n][1].end=i(e[r][1].end)):e[n][1]=o,e.push(["exit",o,t]),e}};e.exports=o},function(e,t,n){"use strict";var a=/[\0\t\n\r]/g;e.exports=function(){var e,t=!0,n=1,i="";return function(r,o,s){var l,c,u,d,p,m=[];for(r=i+r.toString(o),u=0,i="",t&&(65279===r.charCodeAt(0)&&u++,t=void 0);u<r.length;){if(a.lastIndex=u,d=(l=a.exec(r))?l.index:r.length,p=r.charCodeAt(d),!l){i=r.slice(u);break}if(10===p&&u===d&&e)m.push(-3),e=void 0;else if(e&&(m.push(-5),e=void 0),u<d&&(m.push(r.slice(u,d)),n+=d-u),0===p)m.push(65533),n++;else if(9===p)for(c=4*Math.ceil(n/4),m.push(-2);n++<c;)m.push(-1);else 10===p?(m.push(-4),n=1):(e=!0,n=1);u=d+1}return s&&(e&&m.push(-5),i&&m.push(i),m.push(null)),m}}},function(e,t,n){"use strict";var a=n(678);e.exports=function(e){for(;!a(e););return e}},function(e,t,n){e.exports=n(35)(3846)},function(e,t,n){e.exports=n(35)(2138)},function(e,t,n){e.exports=n(35)(8)},function(e,t,n){e.exports=n(35)(1629)},function(e,t,n){const a=n(1182);e.exports=function(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return e=>{a(e,"element",t)};function t(t,n,a){const i=t,r=a;let o;if(e.allowedElements?o=!e.allowedElements.includes(i.tagName):e.disallowedElements&&(o=e.disallowedElements.includes(i.tagName)),!o&&e.allowElement&&"number"==typeof n&&(o=!e.allowElement(i,n,r)),o&&"number"==typeof n)return e.unwrapDisallowed&&i.children?r.children.splice(n,1,...i.children):r.children.splice(n,1),n}}},function(e,t,n){e.exports=n(35)(363)},function(e,t){const n=["http","https","mailto","tel"];e.exports=function(e){const t=(e||"").trim(),a=t.charAt(0);if("#"===a||"/"===a)return t;const i=t.indexOf(":");if(-1===i)return t;let r=-1;for(;++r<n.length;){const e=n[r];if(i===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return r=t.indexOf("?"),-1!==r&&i>r?t:(r=t.indexOf("#"),-1!==r&&i>r?t:"javascript:void(0)")}},function(e,t,n){"use strict";const a=n(2),i=n(1185),r=n(1186),o=n(1187),s=n(1188),l=n(1189),c=n(1190),u=n(1191);t.hastToReact=f,t.hastChildrenToReact=m;const d={}.hasOwnProperty,p=new Set(["table","thead","tbody","tfoot","tr"]);function m(e,t){const n=[];let a,i=-1;for(;++i<t.children.length;)a=t.children[i],"element"===a.type?n.push(f(e,a,i,t)):"text"===a.type?"element"===t.type&&p.has(t.tagName)&&"\n"===a.value||n.push(a.value):"raw"!==a.type||e.options.skipHtml||n.push(a.value);return n}function f(e,t,n,o){const s=e.options,l=e.schema,c=t.tagName,u={};let p,f=l;if("html"===l.space&&"svg"===c&&(f=r,e.schema=f),t.properties)for(p in t.properties)d.call(t.properties,p)&&b(u,p,t.properties[p],e);"ol"!==c&&"ul"!==c||e.listDepth++;const y=m(e,t);"ol"!==c&&"ul"!==c||e.listDepth--,e.schema=l;const h=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},v=s.components&&d.call(s.components,c)?s.components[c]:c,E="string"==typeof v||v===a.Fragment;if(!i.isValidElementType(v))throw new TypeError(`Component for name \`${c}\` not defined or is not renderable`);if(u.key=[c,h.start.line,h.start.column,n].join("-"),"a"===c&&s.linkTarget&&(u.target="function"==typeof s.linkTarget?s.linkTarget(u.href,t.children,u.title):s.linkTarget),"a"===c&&s.transformLinkUri&&(u.href=s.transformLinkUri(u.href,t.children,u.title)),E||"code"!==c||"element"!==o.type||"pre"===o.tagName||(u.inline=!0),E||"h1"!==c&&"h2"!==c&&"h3"!==c&&"h4"!==c&&"h5"!==c&&"h6"!==c||(u.level=parseInt(c.charAt(1),10)),"img"===c&&s.transformImageUri&&(u.src=s.transformImageUri(u.src,u.alt,u.title)),!E&&"li"===c&&"element"===o.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const n=e.children[t];if("element"===n.type&&"input"===n.tagName)return n}return null}(t);u.checked=e&&e.properties?Boolean(e.properties.checked):null,u.index=g(o,t),u.ordered="ol"===o.tagName}var x;return E||"ol"!==c&&"ul"!==c||(u.ordered="ol"===c,u.depth=e.listDepth),"td"!==c&&"th"!==c||(u.align&&(u.style||(u.style={}),u.style.textAlign=u.align,delete u.align),E||(u.isHeader="th"===c)),E||"tr"!==c||"element"!==o.type||(u.isHeader=Boolean("thead"===o.tagName)),s.sourcePos&&(u["data-sourcepos"]=[(x=h).start.line,":",x.start.column,"-",x.end.line,":",x.end.column].map((e=>String(e))).join("")),!E&&s.rawSourcePos&&(u.sourcePosition=t.position),!E&&s.includeElementIndex&&(u.index=g(o,t),u.siblingCount=g(o)),E||(u.node=t),y.length>0?a.createElement(v,u,y):a.createElement(v,u)}function g(e,t){let n=-1,a=0;for(;++n<e.children.length&&e.children[n]!==t;)"element"===e.children[n].type&&a++;return a}function b(e,t,n,a){const i=o(a.schema,t);let r=n;null!=r&&r==r&&(r&&"object"==typeof r&&"length"in r&&(r=(i.commaSeparated?c:l).stringify(r)),"style"===i.property&&"string"==typeof r&&(r=function(e){const t={};try{u(e,(function(e,n){const a="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[a.replace(/-([a-z])/g,y)]=n}))}catch(e){}return t}(r)),i.space&&i.property?e[d.call(s,i.property)?s[i.property]:i.property]=r:i.attribute&&(e[i.attribute]=r))}function y(e,t){return t.toUpperCase()}},function(e,t,n){e.exports=n(35)(484)},function(e,t,n){e.exports=n(35)(3909)},function(e,t,n){e.exports=n(35)(1640)},function(e,t,n){e.exports=n(35)(3911)},function(e,t,n){e.exports=n(35)(1641)},function(e,t,n){e.exports=n(35)(1642)},function(e,t,n){e.exports=n(35)(3912)},function(e,t,n){var a,i,r,o;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */o=function(e){var t=Object.prototype.toString,n=Array.isArray||function(e){return"[object Array]"===t.call(e)};function a(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var o=RegExp.prototype.test,s=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function f(e){this.string=e,this.tail=e,this.pos=0}function g(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function b(){this.cache={}}f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},f.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},g.prototype.push=function(e){return new g(e,this)},g.prototype.lookup=function(e){var t,n=this.cache;if(n.hasOwnProperty(e))t=n[e];else{for(var i,o,s=this,l=!1;s;){if(e.indexOf(".")>0)for(t=s.view,i=e.split("."),o=0;null!=t&&o<i.length;)o===i.length-1&&(l=r(t,i[o])),t=t[i[o++]];else t=s.view[e],l=r(s.view,e);if(l)break;s=s.parent}n[e]=t}return a(t)&&(t=t.call(this.view)),t},b.prototype.clearCache=function(){this.cache={}},b.prototype.parse=function(t,a){var r=this.cache,l=r[t];return null==l&&(l=r[t]=function(t,a){if(!t)return[];var r,l,g,b,y=[],h=[],v=[],E=!1,x=!1;function j(){if(E&&!x)for(;v.length;)delete h[v.pop()];else v=[];E=!1,x=!1}function S(e){if("string"==typeof e&&(e=e.split(u,2)),!n(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),l=new RegExp("\\s*"+i(e[1])),g=new RegExp("\\s*"+i("}"+e[1]))}S(a||e.tags);for(var O,k,w,T,I,M,C=new f(t);!C.eos();){if(O=C.pos,w=C.scanUntil(r))for(var _=0,D=w.length;_<D;++_)b=T=w.charAt(_),function(e,t){return o.call(e,t)}(s,b)?x=!0:v.push(h.length),h.push(["text",T,O,O+1]),O+=1,"\n"===T&&j();if(!C.scan(r))break;if(E=!0,k=C.scan(m)||"name",C.scan(c),"="===k?(w=C.scanUntil(d),C.scan(d),C.scanUntil(l)):"{"===k?(w=C.scanUntil(g),C.scan(p),C.scanUntil(l),k="&"):w=C.scanUntil(l),!C.scan(l))throw new Error("Unclosed tag at "+C.pos);if(I=[k,w,O,C.pos],h.push(I),"#"===k||"^"===k)y.push(I);else if("/"===k){if(!(M=y.pop()))throw new Error('Unopened section "'+w+'" at '+O);if(M[1]!==w)throw new Error('Unclosed section "'+M[1]+'" at '+O)}else"name"===k||"{"===k||"&"===k?x=!0:"="===k&&S(w)}if(M=y.pop())throw new Error('Unclosed section "'+M[1]+'" at '+C.pos);return function(e){for(var t,n=[],a=n,i=[],r=0,o=e.length;r<o;++r)switch((t=e[r])[0]){case"#":case"^":a.push(t),i.push(t),a=t[4]=[];break;case"/":i.pop()[5]=t[2],a=i.length>0?i[i.length-1][4]:n;break;default:a.push(t)}return n}(function(e){for(var t,n,a=[],i=0,r=e.length;i<r;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(a.push(t),n=t));return a}(h))}(t,a)),l},b.prototype.render=function(e,t,n){var a=this.parse(e),i=t instanceof g?t:new g(t);return this.renderTokens(a,i,n,e)},b.prototype.renderTokens=function(e,t,n,a){for(var i,r,o,s="",l=0,c=e.length;l<c;++l)o=void 0,"#"===(r=(i=e[l])[0])?o=this.renderSection(i,t,n,a):"^"===r?o=this.renderInverted(i,t,n,a):">"===r?o=this.renderPartial(i,t,n,a):"&"===r?o=this.unescapedValue(i,t):"name"===r?o=this.escapedValue(i,t):"text"===r&&(o=this.rawValue(i)),void 0!==o&&(s+=o);return s},b.prototype.renderSection=function(e,t,i,r){var o=this,s="",l=t.lookup(e[1]);if(l){if(n(l))for(var c=0,u=l.length;c<u;++c)s+=this.renderTokens(e[4],t.push(l[c]),i,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(e[4],t.push(l),i,r);else if(a(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),(function(e){return o.render(e,t,i)})))&&(s+=l)}else s+=this.renderTokens(e[4],t,i,r);return s}},b.prototype.renderInverted=function(e,t,a,i){var r=t.lookup(e[1]);if(!r||n(r)&&0===r.length)return this.renderTokens(e[4],t,a,i)},b.prototype.renderPartial=function(e,t,n){if(n){var i=a(n)?n(e[1]):n[e[1]];return null!=i?this.renderTokens(this.parse(i),t,n,i):void 0}},b.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},b.prototype.escapedValue=function(t,n){var a=n.lookup(t[1]);if(null!=a)return e.escape(a)},b.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var y=new b;return e.clearCache=function(){return y.clearCache()},e.parse=function(e,t){return y.parse(e,t)},e.render=function(e,t,a){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(e,t,a)},e.to_html=function(t,n,i,r){var o=e.render(t,n,i);if(!a(r))return o;r(o)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=f,e.Context=g,e.Writer=b,e},t&&"string"!=typeof t.nodeName?o(t):(i=[t],void 0===(r="function"==typeof(a=o)?a.apply(t,i):a)||(e.exports=r))},function(e,t,n){e.exports=n(35)(1963)},function(e){e.exports=JSON.parse('[{"field":"process.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.parent.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.parent.pid","description":"Process id."},{"field":"process.entry_leader.parent.session_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.entry_leader.parent.session_leader.pid","description":"Process id."},{"field":"process.entry_leader.parent.session_leader.vpid","description":"Virtual process id."},{"field":"process.entry_leader.parent.vpid","description":"Virtual process id."},{"field":"process.entry_leader.pid","description":"Process id."},{"field":"process.entry_leader.vpid","description":"Virtual process id."},{"field":"process.group_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.group_leader.pid","description":"Process id."},{"field":"process.group_leader.vpid","description":"Virtual process id."},{"field":"process.parent.entity_id","description":"Unique identifier for the process."},{"field":"process.parent.group_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.parent.group_leader.pid","description":"Process id."},{"field":"process.parent.group_leader.vpid","description":"Virtual process id."},{"field":"process.parent.pid","description":"Process id."},{"field":"process.parent.vpid","description":"Virtual process id."},{"field":"process.pid","description":"Process id."},{"field":"process.session_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.session_leader.parent.entity_id","description":"Unique identifier for the process."},{"field":"process.session_leader.parent.pid","description":"Process id."},{"field":"process.session_leader.parent.session_leader.entity_id","description":"Unique identifier for the process."},{"field":"process.session_leader.parent.session_leader.pid","description":"Process id."},{"field":"process.session_leader.parent.session_leader.vpid","description":"Virtual process id."},{"field":"process.session_leader.parent.vpid","description":"Virtual process id."},{"field":"process.session_leader.pid","description":"Process id."},{"field":"process.session_leader.vpid","description":"Virtual process id."},{"field":"process.vpid","description":"Virtual process id."}]')},function(e,t,n){e.exports=n(35)(2134)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return m}));var a=n(48),i=n(57),r=n(182);const o=e=>e.artifacts.location,s=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},l=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.n,exact:!0}))),c=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.r,exact:!0}))),u=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.m,exact:!0}))),d=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.o,exact:!0}))),p=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.l,exact:!0}))),m=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.q,exact:!0})))},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(2),i=n.n(a),r=n(45),o=n(294),s=n(118),l=n(148),c=n(243),u=n(266),d=n(19),p=n(41),m=n.n(p),f=n(4);const g=f.i18n.translate("xpack.securitySolution.fieldBrowser.createFieldButton",{defaultMessage:"Create field"}),b=m()(d.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-1abg8tf-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),y=f.i18n.translate("xpack.securitySolution.fieldBrowser.fieldName",{defaultMessage:"Name"}),h=f.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionLabel",{defaultMessage:"Description"}),v=f.i18n.translate("xpack.securitySolution.fieldBrowser.categoryLabel",{defaultMessage:"Category"}),E=f.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeLabel",{defaultMessage:"Runtime"}),x=f.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeTitle",{defaultMessage:"Runtime Field"}),j=f.i18n.translate("xpack.securitySolution.fieldBrowser.actionsLabel",{defaultMessage:"Actions"}),S=f.i18n.translate("xpack.securitySolution.fieldBrowser.editButton",{defaultMessage:"Edit"}),O=f.i18n.translate("xpack.securitySolution.fieldBrowser.removeButton",{defaultMessage:"Remove"}),k=f.i18n.translate("xpack.securitySolution.fieldBrowser.editButtonDescription",{defaultMessage:"Edit runtime field"}),w=f.i18n.translate("xpack.securitySolution.fieldBrowser.removeButtonDescription",{defaultMessage:"Delete runtime field"});var T=n(284),I=n(130),M=n(424);const C=m()(d.EuiIcon).withConfig({displayName:"TypeIcon",componentId:"sc-1coc1q1-0"})(["margin:0 4px;position:relative;top:-1px;"]);C.displayName="TypeIcon";const _=m.a.span.withConfig({displayName:"Description",componentId:"sc-1coc1q1-1"})(["user-select:text;width:",";"],(({width:e})=>e));_.displayName="Description";const D=i.a.memo((({fieldId:e,highlight:t=""})=>i.a.createElement(d.EuiText,{size:"xs"},i.a.createElement(d.EuiHighlight,{"data-test-subj":`field-${e}-name`,search:t},e))));D.displayName="FieldName";var A=n(187),F=n(219);const N=({sourcererScope:e,editorActionsRef:t,removeColumn:n,upsertColumn:p})=>{const[m,N]=Object(a.useState)(null),{startTransaction:P}=Object(A.b)(),{indexFieldsSearch:R}=Object(o.b)(),{dataViewFieldEditor:L,data:{dataViews:z}}=Object(s.j)().services,q=Object(r.useSelector)((t=>l.e.sourcererScopeMissingPatterns(t,e))),B=Object(r.useSelector)((t=>l.e.sourcererScopeSelectedDataViewId(t,e)));Object(a.useEffect)((()=>{let e=!1;return null==B||q.length||(async t=>{const n=await z.get(t);e||N(n)})(B),()=>{e=!0}}),[B,q,z]);const $=Object(a.useCallback)((async e=>{if(m&&B){const a=await L.openEditor({ctx:{dataView:m},fieldName:e,onSave:async a=>{P({name:F.c.FIELD_SAVED}),await R({dataViewId:B,cleanCache:!0});for(const t of a)e&&e!==t.name&&n(e),p({columnHeaderType:c.a,id:t.name,initialWidth:u.a},0);t&&(t.current=null)}});t&&(t.current={closeEditor:()=>{t.current=null,a()}})}}),[m,B,L,t,R,n,p,P]),V=Object(a.useCallback)((e=>{m&&B&&L.openDeleteModal({ctx:{dataView:m},fieldName:e,onDelete:async()=>{P({name:F.c.FIELD_DELETED}),await R({dataViewId:B}),n(e)}})}),[m,B,L,R,n,P]),U=Object(a.useMemo)((()=>null==L?void 0:L.userPermissions.editIndexPattern()),[null==L?void 0:L.userPermissions]),G=(({isAllowed:e,loading:t,openFieldEditor:n})=>{const r=Object(a.useCallback)((({onHide:e})=>i.a.createElement(b,{iconType:t?"none":"plusInCircle","aria-label":g,"data-test-subj":"create-field",onClick:()=>{n(),e()},isLoading:t},g)),[t,n]);return e?r:void 0})({isAllowed:U&&!!B,loading:!m,openFieldEditor:$}),H=(({hasFieldEditPermission:e,openFieldEditor:t,openDeleteFieldModal:n})=>Object(a.useCallback)((({highlight:a,onHide:r})=>{const o=e?[{name:S,description:k,type:"icon",icon:"pencil",isPrimary:!0,onClick:({name:e})=>{t(e),r()},available:({isRuntime:e})=>e,"data-test-subj":"actionEditRuntimeField"},{name:O,description:w,type:"icon",icon:"trash",color:"danger",isPrimary:!0,onClick:({name:e})=>{n(e),r()},available:({isRuntime:e})=>e,"data-test-subj":"actionDeleteRuntimeField"}]:[];return[{field:"name",name:y,render:(e,{type:t})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiToolTip,{content:t},i.a.createElement(C,{"data-test-subj":`field-${e}-icon`,type:Object(T.d)(null!=t?t:null)}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(D,{fieldId:e,highlight:a}))),sortable:!0,width:"225px"},{field:"description",name:h,render:(e,{name:t})=>{return i.a.createElement(d.EuiToolTip,{content:e},i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"descriptionForScreenReaderOnly"},i.a.createElement("p",null,(n=t,f.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionForScreenReaderOnly",{values:{field:n},defaultMessage:"Description for field {field}:"})))),i.a.createElement(M.a,null,i.a.createElement(_,{width:o.length>0?"335px":"400px","data-test-subj":`field-${t}-description`},`${null!=e?e:Object(I.e)()}`))));var n},sortable:!0,width:o.length>0?"335px":"400px"},{field:"isRuntime",name:E,render:e=>e?i.a.createElement(d.EuiHealth,{color:"success",title:x}):null,sortable:!0,width:"80px"},{field:"category",name:v,render:(e,{name:t})=>i.a.createElement(d.EuiBadge,{"data-test-subj":`field-${t}-category`},e),sortable:!0,width:"115px"},...o.length>0?[{name:j,actions:o,width:"80px"}]:[]]}),[e,t,n]))({hasFieldEditPermission:U,openFieldEditor:$,openDeleteFieldModal:V});return Object(a.useMemo)((()=>({createFieldButton:G,getFieldTableColumns:H})),[G,H])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),i=n.n(a),r=n(19),o=n(42),s=n(4),l=n(126),c=n(119),u=n.n(c),d=n(1213),p=n(10);const m=Object(a.memo)((({agentType:e,...t})=>{const o=Object(d.a)(),[s,l]=Object(a.useState)("empty");return Object(a.useEffect)((()=>{if(o()){const t=e=>{o()&&l(e)};switch(e){case"endpoint":l("logoSecurity");break;case"sentinel_one":n.e(99).then(n.t.bind(null,2095,7)).then((e=>e.default)).then(t);break;case"crowdstrike":n.e(98).then(n.t.bind(null,2096,7)).then((e=>e.default)).then(t)}}}),[e,o]),i.a.createElement(r.EuiIcon,u()({type:s,title:"empty"===s?"":Object(p.n)(e),size:"m"},t))}));m.displayName="AgentTypeVendorLogo";const f=s.i18n.translate("xpack.securitySolution.agentTypeIntegration.integrationSectionLabel",{defaultMessage:"Integration"}),g=Object(a.memo)((({agentType:e,textSize:t="s",layout:n="vertical","data-test-subj":a})=>{const s=Object(l.a)(a);return i.a.createElement(r.EuiFlexGroup,{direction:"horizontal"===n?"row":"column",gutterSize:"s","data-test-subj":s()},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{color:"subdued",size:t,"data-test-subj":s("label")},f," ",i.a.createElement(r.EuiIconTip,{content:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responder.header.integrationSectionLabelTooltip",defaultMessage:"The integration used to execute response actions on this host"}),position:"horizontal"===n?"bottom":"right",anchorProps:{"data-test-subj":s("tooltipAnchor")}}))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiFlexGroup,{responsive:!1,wrap:!1,gutterSize:"xs",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(m,{agentType:e,"data-test-subj":s("vendorLogo")})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:t,"data-test-subj":s("name")},Object(p.n)(e))))))}));g.displayName="AgentTypeIntegration"},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),i=n.n(a),r=n(19),o=n(4),s=n(41),l=n.n(s),c=n(42),u=n(122);const d=o.i18n.translate("xpack.securitySolution.management.policiesSelector.globalEntries",{defaultMessage:"Global entries"}),p=o.i18n.translate("xpack.securitySolution.management.policiesSelector.unassignedEntries",{defaultMessage:"Unassigned entries"}),m=Object(a.memo)((({policies:e,onChangeSelection:t,defaultExcludedPolicies:n,defaultIncludedPolicies:o})=>{const{euiTheme:s}=Object(r.useEuiTheme)(),[l,m]=Object(a.useState)(!1),[g,b]=Object(a.useState)(""),[y,h]=Object(a.useState)([]),v=Object(u.a)("excludePoliciesInFilterEnabled");Object(a.useEffect)((()=>{const t=o?o.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},a=n?n.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},i=e=>t[e]?"on":a[e]?"off":void 0;h([...e.map((e=>({name:e.name,id:e.id,checked:i(e.id)}))),{name:d,id:"global",checked:i("global")},{name:p,id:"unassigned",checked:i("unassigned")}])}),[e]);const E=Object(a.useCallback)((()=>{m((e=>!e))}),[]),x=Object(a.useCallback)((()=>{m(!1)}),[]),j=Object(a.useCallback)((e=>{const t=e.target.value||"";b(t)}),[]),S=Object(a.useCallback)((e=>{if(!y[e])return;const n=[...y];switch(n[e].checked){case"on":n[e].checked=v?"off":void 0;break;case"off":n[e].checked=void 0;break;default:n[e].checked="on"}h(n),t(n)}),[y,t,v]),O=Object(a.useMemo)((()=>y.map(((e,t)=>e.name.toLowerCase().includes(g.toLowerCase())?i.a.createElement(r.EuiFilterSelectItem,{checked:e.checked,key:t,onClick:()=>S(t),"data-test-subj":`policiesSelector-popover-items-${e.id}`},e.name):null))),[y,g,S]),k=Object(a.useMemo)((()=>i.a.createElement(r.EuiFilterButton,{iconType:"arrowDown","data-test-subj":"policiesSelectorButton",onClick:E,isSelected:l,numFilters:y.length,hasActiveFilters:!!y.find((e=>"on"===e.checked)),numActiveFilters:y.filter((e=>"on"===e.checked)).length},i.a.createElement(r.EuiText,null,i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.management.policiesSelector.label",defaultMessage:"Policies"})))),[l,y,E]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"policiesSelector",direction:"row",alignItems:"center",gutterSize:"l"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFilterGroup,null,i.a.createElement(r.EuiPopover,{button:k,isOpen:l,closePopover:x,panelPaddingSize:"none"},i.a.createElement(r.EuiPopoverTitle,{paddingSize:"s"},i.a.createElement(r.EuiFieldSearch,{"data-test-subj":"policiesSelectorSearch",compressed:!0,onChange:j,value:g})),i.a.createElement(f,{"data-test-subj":"policiesSelector-popover",className:"eui-yScroll",$_css:30*s.base},O)))))}));m.displayName="PoliciesSelector";var f=l()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-gji8ln-0"})((e=>({maxHeight:e.$_css}))),g=n(140);const b=Object(a.memo)((({defaultValue:e="",onSearch:t,placeholder:n,hasPolicyFilter:s,policyList:l,defaultIncludedPolicies:c,hideRefreshButton:u=!1})=>{const{canCreateArtifactsByPolicy:d}=Object(g.a)().endpointPrivileges,[p,f]=Object(a.useState)(e),[b,y]=Object(a.useState)(c||""),h=Object(a.useCallback)((e=>{const n=e.filter((e=>"on"===e.checked)).map((e=>e.id)).join(",");y(n),t(p,n,!1)}),[t,p]),v=Object(a.useCallback)((e=>f(e.target.value)),[f]),E=Object(a.useCallback)((()=>t(p,b,!0)),[t,p,b]),x=Object(a.useCallback)((e=>{t(e,b,!1)}),[t,b]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"searchExceptions",direction:"row",alignItems:"center",gutterSize:"m"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFieldSearch,{defaultValue:e,placeholder:n,onChange:v,onSearch:x,isClearable:!0,fullWidth:!0,"data-test-subj":"searchField"})),d&&s&&l?i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(m,{policies:l,defaultIncludedPolicies:c,onChangeSelection:h})):null,u?null:i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{iconType:"refresh",onClick:E,"data-test-subj":"searchButton"},o.i18n.translate("xpack.securitySolution.management.search.button",{defaultMessage:"Refresh"}))))}));b.displayName="SearchExceptions"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),i=n(1558),r=n(527),o=n(1532),s=n(1533),l=n(314),c=n(707),u=n(123),d=n(118),p=n(201),m=n(896);const f=Object(o.a)((async({http:e,jobIds:t,signal:n})=>e.fetch("/internal/ml/jobs/jobs",{method:"POST",version:"1",body:JSON.stringify({jobIds:t}),asSystemRequest:!0,signal:n}))),g=(e,t,n)=>{const o=Object(a.useMemo)((()=>null!=e?e:[]),[e]),{loading:g,jobs:b}=Object(r.a)(),y=Object(a.useMemo)((()=>b.filter((({id:e})=>o.includes(e)))),[b,o]),h=Object(a.useMemo)((()=>y.filter((({isInstalled:e})=>e)).map((e=>e.id))),[y]),{loading:v,jobs:E}=(e=>{const[t,n]=Object(a.useState)([]),{addError:i}=Object(u.a)(),r=Object(p.a)(),o=Object(d.i)(),{error:g,loading:b,result:y,start:h}=Object(s.a)(f),v=Object(l.a)(r),E=Object(c.a)(r);return Object(a.useEffect)((()=>{v&&E&&e.length>0&&h({http:o,jobIds:e})}),[o,v,E,h,e]),Object(a.useEffect)((()=>{y&&n(y)}),[y]),Object(a.useEffect)((()=>{g&&i(g,{title:m.a})}),[i,g]),{isLicensed:E,isMlUser:v,jobs:t,loading:b}})(h),x=Object(a.useMemo)((()=>{const e=E.map((e=>`.ml-anomalies-${e.results_index_name}`));return[...new Set(e)]}),[E]);return{mlJobLoading:g||v,ruleIndices:Object(a.useMemo)((()=>x.length>0?x:n?Object(i.a)(n):null!=t?t:[]),[t,n,x])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(2),i=n.n(a),r=n(42);const o=n(4).i18n.translate("xpack.securitySolution.detectionEngine.ruleInfo.UnknownText",{defaultMessage:"Unknown"});var s=n(151);const l=({createdBy:e,createdAt:t,"data-test-subj":n})=>i.a.createElement("div",{"data-test-subj":n},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!=e?e:o,date:i.a.createElement(s.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"createdAt"})}}));l.displayName="CreatedBy";const c=({updatedBy:e,updatedAt:t,"data-test-subj":n})=>i.a.createElement("div",{"data-test-subj":n},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!=e?e:o,date:i.a.createElement(s.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"updatedAt"})}}));c.displayName="UpdatedBy"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(5);n(99);var r=n(364);const o=({_id:e,_index:t,timestamp:n})=>{const{getAppUrl:o}=Object(r.a)(),s=(({alertId:e,index:t,timestamp:n})=>`${i.g}/${e}?index=${t}&timestamp=${n}`)({alertId:e,index:t,timestamp:n}),l=t.includes(i.X);return Object(a.useMemo)((()=>{if(l)return null;const e=o({path:s});return`${window.location.origin}${e}`}),[l,o,s])}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=()=>{const e=Object(a.useRef)(!1),t=Object(a.useCallback)((()=>e.current),[]),n=Object(a.useCallback)((()=>{e.current=!1}),[]);return Object(a.useEffect)((()=>(e.current=!0,n)),[n]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(2);const i=n.n(a).a.createContext(void 0),r=()=>Object(a.useContext)(i)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n(48),r=n(910),o=n(819),s=n(582),l=n(870);const c=()=>{const e=Object(l.e)(),t=Object(i.useHistory)(),{urlKey:n}=Object(o.b)(),c=n||r.a,u=Object(a.useCallback)((({right:t,left:n,preview:a})=>e(Object(s.f)({right:t,left:n,preview:a,id:c}))),[e,c]),d=Object(a.useCallback)((t=>e(Object(s.h)({right:t,id:c}))),[e,c]),p=Object(a.useCallback)((t=>e(Object(s.e)({left:t,id:c}))),[e,c]),m=Object(a.useCallback)((t=>e(Object(s.g)({preview:t,id:c}))),[e,c]),f=Object(a.useCallback)((()=>e(Object(s.d)({id:c}))),[e,c]),g=Object(a.useCallback)((()=>e(Object(s.a)({id:c}))),[e,c]),b=Object(a.useCallback)((()=>e(Object(s.c)({id:c}))),[e,c]),y=Object(a.useCallback)((()=>{c===r.a?e(Object(s.i)({id:c})):t.goBack()}),[e,c,t]),h=Object(a.useCallback)((()=>e(Object(s.b)({id:c}))),[e,c]);return Object(a.useMemo)((()=>({openFlyout:u,openRightPanel:d,openLeftPanel:p,openPreviewPanel:m,closeRightPanel:f,closeLeftPanel:g,closePreviewPanel:b,closeFlyout:h,previousPreviewPanel:y})),[u,d,p,m,f,g,b,h,y])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(45),r=n(1370);const o=()=>{const e=Object(i.useSelector)((e=>e.discover.app)),t=Object(i.useSelector)((e=>e.discover.internal)),n=Object(i.useSelector)((e=>e.discover.savedSearch)),o=Object(i.useDispatch)();return{discoverAppState:e,setDiscoverAppState:Object(a.useCallback)((e=>{o(Object(r.a)({newState:e}))}),[o]),discoverInternalState:t,setDiscoverInternalState:Object(a.useCallback)((e=>{o(Object(r.b)({newState:e}))}),[o]),discoverSavedSearchState:n,setDiscoverSavedSearchState:Object(a.useCallback)((e=>{o(Object(r.c)({newState:e}))}),[o])}}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=Object.freeze({"ra_get-file_error_not-found":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.notFound",{defaultMessage:"The file specified was not found"}),"ra_get-file_error_is-directory":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.isDirectory",{defaultMessage:"The path defined is not a file"}),"ra_get-file_error_invalid-input":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.invalidPath",{defaultMessage:"The path defined is not valid"}),"ra_get-file_error_not-permitted":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.notPermitted",{defaultMessage:"Endpoint unable to read file requested (not permitted)"}),"ra_get-file_error_too-big":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.tooBig",{defaultMessage:"The file requested is too large and can not be retrieved"}),"ra_get-file_error_disk-quota":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.diskQuota",{defaultMessage:"Endpoint ran out of disk quota while attempting to retrieve file"}),"ra_get-file_error_processing":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.errorProcessing",{defaultMessage:"File retrieval was interrupted"}),"ra_get-file_error_upload-api-unreachable":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.uploadApiUnreachable",{defaultMessage:"File upload api (fleet-server) is unreachable"}),"ra_get-file_error_upload-timeout":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.uploadTimeout",{defaultMessage:"File upload timed out"}),"ra_get-file_error_queue-timeout":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.queueTimeout",{defaultMessage:"Endpoint timed out while attempting to connect to upload API"}),"ra_suspend-process_error_not-found":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.suspendProcess.notFoundError",{defaultMessage:"The provided process was not found"}),"ra_suspend-process_error_not-permitted":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.suspendProcess.notPermittedSuccess",{defaultMessage:"The provided process cannot be suspended"}),"ra_kill-process_error_not-found":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.notFoundError",{defaultMessage:"The provided process was not found"}),"ra_kill-process_success_no-action":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.noActionSuccess",{defaultMessage:"Action completed. The provided process was not found or already killed"}),"ra_kill-process_error_not-permitted":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.notPermittedSuccess",{defaultMessage:"The provided process cannot be killed"}),ra_execute_error_processing:a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.processingError",{defaultMessage:"Unable to create execution output zip file."}),"ra_execute_error_processing-timeout":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.processingTimeout",{defaultMessage:"Command execution was terminated. It exceeded the provided timeout."}),"ra_execute_error_processing-interrupted":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.processingInterrupted",{defaultMessage:"Command execution was absolutely interrupted."}),"ra_execute_error_to-many-requests":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.toManyRequests",{defaultMessage:"Too many concurrent command execution actions."}),ra_execute_error_failure:a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.failure",{defaultMessage:"Unknown failure while executing command."}),"ra_execute_error_disk-quota":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.diskQuotaError",{defaultMessage:"Too many pending command execution output zip files."}),"ra_execute_error_upload-api-unreachable":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.uploadApiUnreachable",{defaultMessage:"Failed to upload command execution output zip file. Unable to reach Fleet Server upload API."}),"ra_execute_error_upload-timeout":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.outputUploadTimeout",{defaultMessage:"Failed to upload command execution output zip file. Upload timed out"}),"ra_execute_error_queue-timeout":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.execute.queueTimeout",{defaultMessage:"Failed to upload command execution output zip file. Timed out while queued waiting for Fleet Server"}),ra_upload_error_failure:a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.upload.failure",{defaultMessage:"Upload failed"}),"ra_upload_already-exists":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.upload.fileAlreadyExists",{defaultMessage:'File with this name already exists. Use "--overwrite" argument if wanting to overwrite it'}),"ra_upload_error_not-found":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.upload.fileNotFound",{defaultMessage:"Failed to retrieve file. File was not found (404)"}),"ra_upload_error_not-permitted":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.upload.fileAccessForbidden",{defaultMessage:"Failed to retrieve file. Access is forbidden (403) or unauthorized (401)"}),"ra_upload_error_too-big":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.upload.fileTooLarge",{defaultMessage:"Failed to save file. Size exceeds max allowed"}),"ra_upload_error_queue-timeout":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.upload.timeout",{defaultMessage:"Attempts to retrieve file failed due to timeout"}),"ra_upload_error_download-failed":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.upload.fileCorruption",{defaultMessage:"Failed to save file to disk or validate its integrity"}),"ra_scan_error_invalid-input":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.scan.invalidInput",{defaultMessage:"Invalid absolute file path provided"}),"ra_scan_error_not-found":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.scan.notFound",{defaultMessage:"File path or folder was not found (404)"}),"ra_scan_error_queue-quota":a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.scan.queueQuota",{defaultMessage:"Too many scans are queued"}),ra_scan_success_done:a.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.scan.success",{defaultMessage:"Scan complete"})})},function(e,t,n){"use strict";n.d(t,"t",(function(){return M})),n.d(t,"h",(function(){return C})),n.d(t,"d",(function(){return _})),n.d(t,"o",(function(){return D})),n.d(t,"r",(function(){return A})),n.d(t,"e",(function(){return F})),n.d(t,"n",(function(){return N})),n.d(t,"m",(function(){return L})),n.d(t,"j",(function(){return z})),n.d(t,"s",(function(){return B})),n.d(t,"g",(function(){return $})),n.d(t,"k",(function(){return V})),n.d(t,"q",(function(){return U})),n.d(t,"p",(function(){return G})),n.d(t,"i",(function(){return W})),n.d(t,"a",(function(){return Q})),n.d(t,"c",(function(){return Y})),n.d(t,"b",(function(){return K})),n.d(t,"l",(function(){return J})),n.d(t,"f",(function(){return Z}));var a=n(41),i=n.n(a),r=n(19),o=n(813),s=n(44),l=n(2),c=n.n(l),u=n(70),d=n(566),p=n(290),m=n(662),f=n(227),g=n(1223),b=n(1224),y=n(663),h=n(298),v=n(248),E=n(130),x=n(772),j=n(773),S=n(791);const O=i()(r.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-1fdewst-0"})(["height:105px;overflow-y:hidden;"]),k=i()(r.EuiFlexItem).withConfig({displayName:"SetupDescriptionContainer",componentId:"sc-1fdewst-1"})(["height:105px;overflow-y:hidden;"]),w=e=>!Object(s.isEmpty)(e.join("")),T=i()(r.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-1fdewst-2"})([".euiBadge__text{white-space:pre-wrap !important;}"]),I=i.a.div.withConfig({displayName:"Query",componentId:"sc-1fdewst-3"})(["white-space:pre-wrap;"]),M=e=>{switch(e){case"eql":return y.g;case"saved_query":return y.t;case"esql":return y.k;default:return y.q}},C=({field:e,filters:t,filterManager:n,query:a,savedId:i,savedQueryName:o,indexPatterns:l,queryLabel:d})=>{let p=[];const m=!Object(s.isEmpty)(i)&&!Object(s.isEmpty)(o);return m&&(p=[...p,{title:c.a.createElement(c.a.Fragment,null,y.u," "),description:c.a.createElement(c.a.Fragment,null,o," ")}]),Object(s.isEmpty)(t)||(n.setFilters(t),p=[...p,{title:c.a.createElement(c.a.Fragment,null,m?y.s:y.m," "),description:c.a.createElement(r.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},n.getFilters().map(((t,n)=>c.a.createElement(X,{grow:!1,key:`${e}-filter-${n}`},c.a.createElement(T,{color:"hollow"},null!=l?c.a.createElement(u.FilterBadgeGroup,{filters:[t],dataViews:[l]}):c.a.createElement(r.EuiLoadingSpinner,{size:"m"}))))))}]),Object(s.isEmpty)(a)||(p=[...p,{title:c.a.createElement(c.a.Fragment,null,m?y.t:null!=d?d:y.q),description:c.a.createElement(I,null,a)}]),p},_=e=>{let t=[];return Object(s.isEmpty)(e.eventCategoryField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,y.f),description:c.a.createElement(c.a.Fragment,null,e.eventCategoryField)}]),Object(s.isEmpty)(e.tiebreakerField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,y.h),description:c.a.createElement(c.a.Fragment,null,e.tiebreakerField)}]),Object(s.isEmpty)(e.timestampField)||(t=[...t,{title:c.a.createElement(c.a.Fragment,null,y.i),description:c.a.createElement(c.a.Fragment,null,e.timestampField)}]),t},D=({threat:e,label:t})=>e.length>0?[{title:t,description:c.a.createElement(j.a,{threat:e})}]:[],A=(e,t,n)=>w(n)?[{title:e,description:c.a.createElement(r.EuiText,{size:"s"},c.a.createElement("ul",null,n.map((e=>Object(s.isEmpty)(e)?null:c.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[],F=(e,t)=>{if(Object(s.isEmpty)(t))return[];const n=c.a.createElement(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(s.isEmpty)(t)?null:c.a.createElement(r.EuiFlexItem,{grow:!1,key:`${e}-${t}`},c.a.createElement(T,{"data-test-subj":"customHighlightedFieldsStringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:e,description:n}]},N=(e,t,n)=>w(n)?[{title:e,description:c.a.createElement(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},n.map((e=>Object(s.isEmpty)(e)?null:c.a.createElement(r.EuiFlexItem,{grow:!1,key:`${t}-${e}`},c.a.createElement(T,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[],P=i()(r.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-1fdewst-4"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),R=i()(r.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-1fdewst-5"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),L=e=>[{title:g.a,description:c.a.createElement(h.a,{value:e.value})},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?g.d:"",description:c.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},c.a.createElement(P,null,c.a.createElement(r.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},c.a.createElement(c.a.Fragment,null,`${e.field}:`))),c.a.createElement(R,null,c.a.createElement(r.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(E.a)(e.value))),c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(r.EuiIcon,{type:"sortRight"})),c.a.createElement(r.EuiFlexItem,null,c.a.createElement(h.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]],z=e=>[{title:b.b,description:e.value},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?b.e:"",description:c.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},c.a.createElement(P,null,c.a.createElement(r.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},c.a.createElement(c.a.Fragment,null,e.field))),c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(r.EuiIcon,{type:"sortRight"})),c.a.createElement(r.EuiFlexItem,null,o.a))}))):[]],q=i()(r.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-1fdewst-6"})(["word-break:break-word;"]),B=(e,t)=>w(t)?[{title:e,description:c.a.createElement(r.EuiText,{size:"s"},c.a.createElement("ul",null,t.filter((e=>!Object(s.isEmpty)(e))).map(((e,t)=>c.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},c.a.createElement(q,{href:e,external:!0,target:"_blank"},e))))))}]:[],$=(e,t)=>""!==t.trim()?[{title:e,description:c.a.createElement(O,null,c.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],V=(e,t)=>{switch(t){case"machine_learning":return[{title:e,description:y.o}];case"query":case"saved_query":return[{title:e,description:y.r}];case"threshold":return[{title:e,description:y.z}];case"eql":return[{title:e,description:y.j}];case"threat_match":return[{title:e,description:y.v}];case"new_terms":return[{title:e,description:y.p}];case"esql":return[{title:e,description:y.l}];default:return Object(f.a)(t)}},U=(e,t)=>[{title:e,description:c.a.createElement(c.a.Fragment,null,Object(s.isEmpty)(t.field[0])?`${y.y} >= ${t.value}`:`${y.x} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}],G=(e,t)=>[{title:e,description:t.reduce(((e,t,n,{length:a})=>{const i=t.entries.reduce(((e,t,n,{length:a})=>1===a?`${t.field} ${m.d} ${t.value}`:0===n?`(${t.field} ${m.d} ${t.value})`:`${e} ${m.a} (${t.field} ${m.d} ${t.value})`),"");return 1===a?`${i}`:0===n?`(${i})`:`${e} ${m.e} (${i})`}),"")}],H=i()(r.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-1fdewst-7"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),W=(e,t)=>Object(s.isEmpty)(t)?[]:[{title:e,description:c.a.createElement(r.EuiFlexGrid,{gutterSize:"s"},t.map(((e,n)=>c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(x.a,{"data-test-subj":"field-type-icon",type:e.type})),c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(H,{grow:!1,size:"s"},` ${e.name}${n+1!==t.length?", ":""}`)))))))}],Q=(e=y.n,t,n)=>{if(Object(s.isEmpty)(t))return[];const a=c.a.createElement(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(s.isEmpty)(t)?null:c.a.createElement(r.EuiFlexItem,{grow:!1,key:`${e}-${t}`},c.a.createElement(T,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:c.a.createElement(S.a,{label:e,ruleType:n}),description:a}]},Y=(e,t,n,a)=>{const i=n===v.b.PerTimePeriod?`${t.value}${t.unit}`:y.b;return[{title:c.a.createElement(S.a,{label:e,ruleType:a}),description:i}]},K=(e,t,n)=>{if(Object(s.isEmpty)(t))return[];const a=t===p.a.suppress?y.c:y.a;return[{title:c.a.createElement(S.a,{label:e,ruleType:n}),description:a}]},J=(e,t)=>""!==t.trim()?[{title:e,description:c.a.createElement(k,null,c.a.createElement("div",{"data-test-subj":"setupDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],Z=(e,t)=>[{title:e,description:c.a.createElement(d.a,{interval:t})}];var X=i()(r.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1fdewst-8"})({width:"100%"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),r=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),o=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),s=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),l=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),c=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),u=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),d=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),r=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),o=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),s=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),l=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),c=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),u=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),d=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(149),r=n(333),o=n(479),s=n(123),l=n(187),c=n(1105);const u=({eventIds:e,currentStatus:t,query:n,setEventsLoading:u,showAlertStatusActions:d=!0,setEventsDeleted:p,onUpdateSuccess:m,onUpdateFailure:f,customBulkActions:g})=>{const{addSuccess:b,addError:y,addWarning:h}=Object(s.a)(),{startTransaction:v}=Object(l.b)(),E=Object(a.useCallback)(((e,t,n)=>{if(t>0)h({title:r.x(t),text:r.y(e,t)});else{let t;switch(n){case"closed":t=r.p(e);break;case"open":t=r.r(e);break;case"acknowledged":t=r.b(e)}b({title:t})}m&&m(e,t,n)}),[b,h,m]),x=Object(a.useCallback)(((e,t)=>{let n;switch(e){case"closed":n=r.o;break;case"open":n=r.q;break;case"acknowledged":n=r.a}y(t.message,{title:n}),f&&f(e,t)}),[y,f]),j=Object(a.useCallback)((async t=>{n?v({name:c.a.BULK_QUERY_STATUS_UPDATE}):e.length>1?v({name:c.a.BULK_STATUS_UPDATE}):v({name:c.a.STATUS_UPDATE});try{var a,i;u({eventIds:e,isLoading:!0});const s=await Object(o.a)({status:t,query:n&&JSON.parse(n),signalIds:e});if(p({eventIds:e,isDeleted:!0}),s.version_conflicts&&1===e.length)throw new Error(r.l);E(null!==(a=s.updated)&&void 0!==a?a:0,null!==(i=s.version_conflicts)&&void 0!==i?i:0,t)}catch(e){x(t,e)}finally{u({eventIds:e,isLoading:!1})}}),[u,e,n,p,E,x,v]);return Object(a.useMemo)((()=>{const a=[];d&&(t!==i.d&&a.push({key:"open","data-test-subj":"open-alert-status",onClick:()=>j(i.d),name:r.m}),t!==i.b&&a.push({key:"acknowledge","data-test-subj":"acknowledged-alert-status",onClick:()=>j(i.b),name:r.j}),t!==i.c&&a.push({key:"close","data-test-subj":"close-alert-status",onClick:()=>j(i.c),name:r.k}));const o=g?g.reduce(((t,a)=>{const i=!(!n||!a.disableOnQuery);return t.push({key:a.key,disabled:i,"data-test-subj":a["data-test-subj"],toolTipContent:i?a.disabledLabel:null,onClick:()=>a.onClick(e),name:a.label}),t}),[]):[];return[...a,...o]}),[t,g,e,j,n,d])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(2),i=n(661);const r=["kibana.alert.workflow_assignee_ids","kibana.alert.workflow_user"],o=({alerts:e,columns:t})=>{const n=Object(a.useMemo)((()=>{const n=new Set;return e.forEach((e=>{r.forEach((a=>{if(null!=t.find((e=>e.id===a))){const t=e[a];null==t||t.forEach((e=>n.add(e)))}}))})),n}),[e,t]),o=Object(i.a)({uids:n});return Object(a.useMemo)((()=>({profiles:o.data,isLoading:o.isLoading})),[o.data,o.isLoading])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return u}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.closeEventDetailsLabel",{defaultMessage:"close"}),r=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.placeholder",{defaultMessage:"Select an event to show event details"}),o=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.eventTitleLabel",{defaultMessage:"Event details"}),s=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.alertTitleLabel",{defaultMessage:"Alert details"}),l=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),c=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.technicalPreviewDescription",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),u=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.shareAlert",{defaultMessage:"Share alert"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(41),o=n.n(r),s=n(19),l=n(732),c=n(1229);const u=o()(s.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1sj6853-0"})(["line-height:inherit;"]),d=[{value:"low",inputDisplay:i.a.createElement(u,{color:c.c},l.j)},{value:"medium",inputDisplay:i.a.createElement(u,{color:c.d},l.k)},{value:"high",inputDisplay:i.a.createElement(u,{color:c.b},l.i)},{value:"critical",inputDisplay:i.a.createElement(u,{color:c.a},l.g)}],p={low:c.g,medium:c.h,high:c.f,critical:c.e}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d}));var a=n(49);const i=a.euiLightVars.euiColorVis0,r=a.euiLightVars.euiColorVis5,o=a.euiLightVars.euiColorVis7,s=a.euiLightVars.euiColorVis9,l=21,c=47,u=73,d=99},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(159),r=n(118),o=n(353);const s=()=>{const e=Object(r.n)(),[t,n]=Object(a.useState)(!0),[s,l]=Object(a.useState)(!1),[c,u]=Object(a.useState)(null),d=Object(a.useRef)(null);return Object(a.useEffect)((()=>{let t=!0;const a=new AbortController;return d.current=async r=>{try{n(!0);const{references:e}=await Object(i.l)({lists:r,signal:a.signal}),o=e.reduce(((e,t)=>{const[[n,a]]=Object.entries(t);return e[n]=a,e}),{});t&&(n(!1),l(!1),u(o))}catch(a){t&&(l(!0),n(!1),e.addError(a,{title:o.d}))}},()=>{t=!1,a.abort()}}),[e]),[t,s,c,d.current]}},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"j",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(4);const i=a.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),r=a.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),o=a.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),s=a.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),l=a.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),c=a.i18n.translate("autocomplete.invalidBinaryType",{defaultMessage:"Binary fields are currently unsupported"}),u=a.i18n.translate("autocomplete.fieldSpaceWarning",{defaultMessage:"Warning: Spaces at the start or end of this value aren't being displayed."}),d=(a.i18n.translate("autocomplete.listsTooltipWarning",{defaultMessage:"Lists that aren't able to be processed by this rule type will be disabled."}),a.i18n.translate("autocomplete.seeDocumentation",{defaultMessage:"See Documentation"}),a.i18n.translate("autocomplete.conflictIndicesWarning.title",{defaultMessage:"Mapping Conflict"})),p=a.i18n.translate("autocomplete.conflictIndicesWarning.description",{defaultMessage:"This field is defined as different types across the following indices or is unmapped. This can cause unexpected query results."}),m=(e,t)=>a.i18n.translate("autocomplete.conflictIndicesWarning.index.description",{defaultMessage:"{name} ({count} indices)",values:{count:t,name:e}});a.i18n.translate("autocomplete.showValueListModal",{defaultMessage:"Show value list"}),t.k={LOADING:i,SELECT_FIELD_FIRST:r,FIELD_REQUIRED_ERR:o,NUMBER_ERR:s,DATE_ERR:l,FIELD_SPACE_WARNING:u,BINARY_TYPE_NOT_SUPPORTED:c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return E})),n.d(t,"c",(function(){return j}));var a=n(2),i=n.n(a),r=n(4),o=n(42),s=n(19),l=n(140),c=n(118),u=n(952),d=n(602),p=n(881),m=n(603),f=n(1233);const g=r.i18n.translate("xpack.securitySolution.eventFilters.aboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),b=r.i18n.translate("xpack.securitySolution.eventFilter.form.name.label",{defaultMessage:"Name"}),y=r.i18n.translate("xpack.securitySolution.eventFilter.form.description.placeholder",{defaultMessage:"Description"}),h=r.i18n.translate("xpack.securitySolution.eventFilter.form.name.error",{defaultMessage:"The name can't be empty"}),v=r.i18n.translate("xpack.securitySolution.eventFilter.form.os.label",{defaultMessage:"Select operating system"}),E=r.i18n.translate("xpack.securitySolution.eventFilter.form.rule.name",{defaultMessage:"Endpoint Event Filtering"}),x={pageTitle:r.i18n.translate("xpack.securitySolution.eventFilters.pageTitle",{defaultMessage:"Event Filters"}),pageAboutInfo:r.i18n.translate("xpack.securitySolution.eventFilters.pageAboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),pageAddButtonTitle:r.i18n.translate("xpack.securitySolution.eventFilters.pageAddButtonTitle",{defaultMessage:"Add event filter"}),getShowingCountLabel:e=>r.i18n.translate("xpack.securitySolution.eventFilters.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {event filter} other {event filters}}",values:{total:e}}),cardActionEditLabel:r.i18n.translate("xpack.securitySolution.eventFilters.cardActionEditLabel",{defaultMessage:"Edit event filter"}),cardActionDeleteLabel:r.i18n.translate("xpack.securitySolution.eventFilters.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),flyoutCreateTitle:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateTitle",{defaultMessage:"Add event filter"}),flyoutEditTitle:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditTitle",{defaultMessage:"Edit event filter"}),flyoutCreateSubmitButtonLabel:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add event filter"}),flyoutCreateSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),i.a.createElement(s.EuiLink,{target:"_blank",href:`${e.eventFilters}`},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsLink",defaultMessage:"Event filters documentation"}))),deleteActionSuccess:e=>r.i18n.translate("xpack.securitySolution.eventFilters.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from event filters list.',values:{itemName:e}}),emptyStateTitleNoEntries:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitleNoEntries",{defaultMessage:"There are no event filters to display."}),emptyStateTitle:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitle",{defaultMessage:"Add your first event filter"}),emptyStateInfo:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStateInfo",{defaultMessage:"Add an event filter to exclude high volume or unwanted events from being written to Elasticsearch."}),emptyStatePrimaryButtonLabel:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStatePrimaryButtonLabel",{defaultMessage:"Add event filter"}),searchPlaceholderInfo:r.i18n.translate("xpack.securitySolution.eventFilters.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"})},j=Object(a.memo)((()=>{const{canWriteEventFilters:e}=Object(l.a)().endpointPrivileges,t=Object(c.i)(),n=d.a.getInstance(t);return i.a.createElement(u.a,{apiClient:n,ArtifactFormComponent:p.a,labels:x,"data-test-subj":"EventFiltersListPage",searchableFields:m.d,flyoutSize:"l",allowCardCreateAction:e,allowCardEditAction:e,allowCardDeleteAction:e,CardDecorator:f.a})}));j.displayName="EventFiltersList"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(42),c=n(126),u=n(122),d=n(259),p=n(846);const m=Object(r.memo)((({item:e,"data-test-subj":t,...n})=>{const a=Object(c.a)(t);return Object(u.a)("filterProcessDescendantsForEventFiltersEnabled")&&Object(d.g)(e)?o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiText,i()({},n,{"data-test-subj":a("processDescendantIndication")}),o.a.createElement("code",null,o.a.createElement("strong",null,o.a.createElement(l.FormattedMessage,{defaultMessage:"Filtering descendants of process",id:"xpack.securitySolution.eventFilters.filteringProcessDescendants"})," ",o.a.createElement(p.a,{indicateExtraEntry:!0,"data-test-subj":a("processDescendantIndicationTooltip")})))),o.a.createElement(s.EuiSpacer,{size:"m"})):o.a.createElement(o.a.Fragment,null)}));m.displayName="EventFiltersProcessDescendantIndicator"},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(19),i=n(2),r=n.n(i),o=n(293),s=n(748),l=n(5),c=n(118),u=n(333),d=n(7);const p=(e,t)=>e.checked?t.checked&&e.checked<=t.checked?1:-1:t.checked?1:0,m=(e,t)=>{const n=Object(d.intersection)(...e),a=Object(d.union)(...e);return Object(d.union)(a,t).map((e=>{let t={checked:void 0,"data-test-subj":"unselected-alert-tag"};return n.includes(e)?t={checked:"on","data-test-subj":"selected-alert-tag"}:a.includes(e)&&(t={checked:"mixed","data-test-subj":"mixed-alert-tag"}),{label:e,...t}})).sort(p)},f={selectableAlertTags:[],tagsToAdd:new Set,tagsToRemove:new Set},g=({alertItems:e,refresh:t,refetchQuery:n,setIsLoading:o,clearSelection:d,closePopoverMenu:p,onSubmit:g})=>{const[b]=Object(c.o)(l.E),y=Object(i.useMemo)((()=>e.map((e=>{var t,n;return null!==(t=null===(n=e.data.find((e=>e.field===s.H)))||void 0===n?void 0:n.value)&&void 0!==t?t:[]}))),[e]),[{selectableAlertTags:h,tagsToAdd:v,tagsToRemove:E},x]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"addAlertTag":{const{value:n}=t;return e.tagsToAdd.add(n),e.tagsToRemove.delete(n),e}case"removeAlertTag":{const{value:n}=t;return e.tagsToRemove.add(n),e.tagsToAdd.delete(n),e}case"setSelectableAlertTags":{const{value:n}=t;return{...e,selectableAlertTags:n}}default:return e}}),f),j=Object(i.useCallback)((e=>{x({type:"addAlertTag",value:e})}),[x]),S=Object(i.useCallback)((e=>{x({type:"removeAlertTag",value:e})}),[x]),O=Object(i.useCallback)((e=>{x({type:"setSelectableAlertTags",value:e})}),[x]),k=Object(i.useCallback)((async()=>{if(0===v.size&&0===E.size)return void p();const a=Array.from(v),i=Array.from(E),r=e.map((e=>e._id)),s={tags_to_add:a,tags_to_remove:i};null!=g&&(p(),await g(s,r,(()=>{n&&n(),t&&t(),d&&d()}),o))}),[p,v,E,e,n,t,d,o,g]),w=Object(i.useCallback)(((e,t,n)=>{"on"===n.checked?j(n.label):n.checked||S(n.label),O(e)}),[j,S,O]);return Object(i.useEffect)((()=>{x({type:"setSelectableAlertTags",value:m(y,b)})}),[y,b]),r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSelectable,{searchable:!0,searchProps:{placeholder:u.i},"aria-label":u.i,options:h,onChange:w,emptyMessage:u.g,noMatchesMessage:u.h,"data-test-subj":"alert-tags-selectable-menu"},((e,t)=>r.a.createElement("div",null,r.a.createElement(a.EuiPopoverTitle,null,t),e))),r.a.createElement(a.EuiButton,{"data-test-subj":"alert-tags-update-button",fullWidth:!0,size:"s",onClick:k},u.d))},b=Object(i.memo)(g);var y=n(56),h=n(123);const v=({refetch:e})=>{const{hasIndexWrite:t}=Object(o.a)(),n=(()=>{const{http:e}=Object(y.useKibana)().services,{addSuccess:t,addError:n}=Object(h.a)(),a=Object(i.useRef)(null),r=Object(i.useCallback)(((e=0)=>t(u.A(e))),[t]),o=Object(i.useCallback)((e=>{n(e.message,{title:u.z})}),[n]);return Object(i.useEffect)((()=>{let e=!1;const t=new AbortController;return a.current=async(n,a,i,s)=>{try{s(!0);const o=await(async({tags:e,ids:t,signal:n})=>c.b.get().http.fetch(l.kb,{method:"POST",version:"2023-10-31",body:JSON.stringify({tags:e,ids:t}),signal:n}))({tags:n,ids:a,signal:t.signal});e||(i(),s(!1),r(o.updated))}catch(t){e||(s(!1),o(t))}},()=>{e=!0,t.abort()}}),[e,o,r]),a.current})(),s=Object(i.useCallback)((async(e,t,a,i)=>{n&&await n(e,t,a,i)}),[n]),d=Object(i.useMemo)((()=>t?[{key:"manage-alert-tags","data-test-subj":"alert-tags-context-menu-item",name:u.e,panel:1,label:u.e,disableOnQuery:!0}]:[]),[t]),p=Object(i.useMemo)((()=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},u.e),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIconTip,{content:u.f,position:"right"})))),[]),m=Object(i.useCallback)((({alertItems:t,refresh:n,setIsBulkActionsLoading:a,clearSelection:i,closePopoverMenu:o})=>r.a.createElement(b,{alertItems:t,refresh:n,refetchQuery:e,setIsLoading:a,clearSelection:i,closePopoverMenu:o,onSubmit:s})),[s,e]),f=Object(i.useMemo)((()=>t?[{id:1,title:p,"data-test-subj":"alert-tags-context-menu-panel",renderContent:m}]:[]),[p,t,m]);return Object(i.useMemo)((()=>({alertTagsItems:d,alertTagsPanels:f})),[d,f])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return Y}));var a=n(19),i=n(41),r=n.n(i),o=n(2),s=n.n(o),l=n(342),c=n(922);const u=r()(a.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-p7dcu3-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow:hidden;padding:",";}}"],(({theme:e})=>`0 ${e.eui.euiSizeM} ${e.eui.euiSizeM}`)),d=({alertId:e,browserFields:t,detailsData:n,detailsEcsData:a,event:i,handleIsolationActionSuccess:r,handleOnEventClosed:o,hostName:d,isAlert:p,isDraggable:m,isReadOnly:f,isolateAction:g,isHostIsolationPanelOpen:b,isIsolateActionSuccessBannerVisible:y,loading:h,rawEventData:v,showAlertDetails:E,scopeId:x})=>s.a.createElement(u,null,y&&s.a.createElement(l.d,{hostName:d,alertId:e,isolateAction:g}),b?s.a.createElement(l.f,{details:n,cancelCallback:E,successCallback:r,isolateAction:g}):s.a.createElement(c.a,{browserFields:t,detailsData:n,detailsEcsData:a,event:i,isAlert:p,isDraggable:m,loading:h,rawEventData:v,scopeId:x,timelineTabType:"flyout",handleOnEventClosed:o,isReadOnly:f})),p=s.a.memo(d);n(43);var m=n(1227);const f=({showAlertDetails:e,showExperimentalBadge:t,isolateAction:n})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiButtonEmpty,{iconType:"arrowLeft",iconSide:"left",flush:"left",onClick:e},s.a.createElement(a.EuiText,{size:"xs"},s.a.createElement("p",null,m.a))),s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiTitle,null,s.a.createElement("h2",null,"isolateHost"===n?l.g:l.h))),s.a.createElement(a.EuiFlexItem,{grow:!1},t&&s.a.createElement(b,{label:m.f,size:"s",tooltipContent:m.g})))),g=s.a.memo(f);var b=r()(a.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-16ihl46-0"})(["display:inline-flex;"]),y=n(174);const h=({eventId:e,eventIndex:t,isAlert:n,isHostIsolationPanelOpen:a,isolateAction:i,loading:r,promptContextId:l,ruleName:u,showAlertDetails:d,timestamp:p,scopeId:m,refetchFlyoutData:f,getFieldsData:b})=>{const h=Object(o.useMemo)((()=>{var e;return!(!n||null===(e=b(y.b.sentinel_one))||void 0===e||!e.length)}),[b,n]);return s.a.createElement(s.a.Fragment,null,a?s.a.createElement(g,{isolateAction:i,showAlertDetails:d,showExperimentalBadge:h}):s.a.createElement(c.b,{eventId:e,eventIndex:t,isAlert:n,loading:r,promptContextId:l,ruleName:u,timestamp:p,scopeId:m,refetchFlyoutData:f,getFieldsData:b}))},v=({eventId:e,eventIndex:t,isAlert:n,isHostIsolationPanelOpen:i,isolateAction:r,loading:o,promptContextId:l,ruleName:c,showAlertDetails:u,timestamp:d,scopeId:p,refetchFlyoutData:m,getFieldsData:f})=>s.a.createElement(a.EuiFlyoutHeader,{hasBorder:i},s.a.createElement(h,{eventId:e,eventIndex:t,isAlert:n,isHostIsolationPanelOpen:i,isolateAction:r,loading:o,promptContextId:l,ruleName:c,showAlertDetails:u,timestamp:d,scopeId:p,refetchFlyoutData:m,getFieldsData:f})),E=s.a.memo(v);var x=n(119),j=n.n(x),S=n(44),O=n(519),k=n(131),w=n(1630),T=n(305),I=n(170),M=n(1305),C=n(928),_=n(667),D=n(377),A=n(929),F=n(502),N=n(140),P=n(973),R=n(118),L=n(930),z=n(931),q=n(932);const B=s.a.memo((({detailsData:e,ecsData:t,handleOnEventClosed:n,isHostIsolationPanelOpen:i,loadingEventDetails:r,onAddEventFilterClick:c,onAddExceptionTypeClick:u,onAddIsolationStatusClick:d,refetch:p,refetchFlyoutData:m,onOsqueryClick:f,scopeId:g})=>{var b;const{loading:y,canWriteEventFilters:h}=Object(N.a)().endpointPrivileges,v=Object(o.useMemo)((()=>!y&&h),[h,y]),{osquery:E}=Object(R.j)().services,[x,j]=Object(o.useState)(!1),S=Object(o.useMemo)((()=>[{category:"kibana",field:"kibana.alert.rule.uuid",name:"ruleId"},{category:"kibana",field:"kibana.alert.rule.name",name:"ruleName"},{category:"kibana",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"event",field:"event.kind",name:"eventKind"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,n)=>({...t,[n.name]:Object(O.a)({category:n.category,field:n.field},e)})),{})),[e]),B="event"===S.eventKind,$=Object(o.useMemo)((()=>{var e,n;return null==t||null===(e=t.agent)||void 0===e||null===(n=e.type)||void 0===n?void 0:n.includes("endpoint")}),[t]),V=Object(o.useMemo)((()=>B&&$),[B,$]),U=Object(o.useMemo)((()=>Object(O.a)({category:"agent",field:"agent.id"},e)),[e]),G=Object(o.useCallback)((()=>{j(!x)}),[x]),H=Object(o.useCallback)((()=>{j(!1)}),[]),W=Object(o.useCallback)((()=>{n(),j(!1)}),[n]),Q=Object(o.useCallback)((e=>{d(e),j(!1)}),[d]),Y=Object(l.i)({closePopover:H,detailsData:e,onAddIsolationStatusClick:Q,isHostIsolationPanelOpen:i}),K=Object(F.e)(e,H),J=Object(o.useCallback)((e=>{u(e),j(!1)}),[u]),{exceptionActionItems:Z}=Object(C.a)({isEndpointAlert:Boolean($),onAddExceptionTypeClick:J}),X=Object(o.useCallback)((()=>{c(),j(!1)}),[c]),{eventFilterActionItems:ee}=Object(A.a)({onAddEventFilterClick:X}),te=Object(o.useCallback)((()=>{H()}),[H]),{actionItems:ne}=Object(_.a)({alertStatus:S.alertStatus,closePopover:W,eventId:S.eventId,refetch:p,scopeId:g}),{alertTagsItems:ae,alertTagsPanels:ie}=Object(z.a)({closePopover:H,ecsRowData:null!=t?t:{_id:S.eventId},refetch:p}),re=Object(o.useCallback)((()=>{p&&p(),m&&m()}),[p,m]),{alertAssigneesItems:oe,alertAssigneesPanels:se}=Object(q.a)({closePopover:H,ecsRowData:null!=t?t:{_id:S.eventId},refetch:re}),{investigateInTimelineActionItems:le}=Object(D.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:H}),ce=null==E?void 0:E.isOsqueryAvailable({agentId:U}),ue=Object(o.useCallback)((()=>{f(U),j(!1)}),[f,j,U]),de=Object(o.useMemo)((()=>Object(L.a)({handleClick:ue})),[ue]),pe=Object(o.useMemo)((()=>!B&&S.ruleId?[...ne,...ae,...oe,...Z]:V&&v?ee:[]),[ee,V,v,Z,ne,B,S.ruleId,ae,oe]),me=[w.b.alertsOnAlertsPage,w.b.alertsOnRuleDetailsPage].includes(g),{addToCaseActionItems:fe,handleAddToNewCaseClick:ge}=Object(P.a)({ecsData:t,nonEcsData:null!==(b=null==e?void 0:e.map((e=>({field:e.field,value:e.values}))))&&void 0!==b?b:[],onMenuItemClick:te,onSuccess:m,isActiveTimelines:Object(k.isActiveTimeline)(g),isInDetections:me,refetch:p}),be=Object(o.useMemo)((()=>[...fe,...pe,...Y,...K,...ce?[de]:[],...le]),[fe,pe,Y,K,ce,de,le]),ye=[{id:0,items:be},...ie,...se],he=Object(o.useMemo)((()=>s.a.createElement(T.a,{onClick:ge,step:I.a.addAlertToCase,tourId:I.b.alertsCases},s.a.createElement(a.EuiButton,{"data-test-subj":"take-action-dropdown-btn",fill:!0,iconSide:"right",iconType:"arrowDown",onClick:G},M.d))),[ge,G]);return be.length&&!r&&t?s.a.createElement(a.EuiPopover,{id:"AlertTakeActionPanel",button:he,isOpen:x,closePopover:H,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},s.a.createElement(a.EuiContextMenu,{size:"s",initialPanelId:0,panels:ye,"data-test-subj":"takeActionPanelMenu"})):null}));var $=n(933),V=n(969),U=n(962),G=n(936),H=n(571),W=n(775);const Q=({detailsData:e,detailsEcsData:t,handleOnEventClosed:n,isHostIsolationPanelOpen:i,isReadOnly:r,loadingEventDetails:l,onAddIsolationStatusClick:c,scopeId:u,refetchFlyoutData:d})=>{var p;const{euiTheme:m}=Object(a.useEuiTheme)(),f=Object(o.useMemo)((()=>({style:`z-index: ${m.levels.flyout+3}`})),[m]),g=null!=t&&null!==(p=t.kibana)&&void 0!==p&&p.alert?null==t?void 0:t._id:null,b=Object(o.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=Object(S.find)({category:"signal",field:"signal.rule.index"},e))||void 0===n?void 0:n.values)&&void 0!==t?t:null===(a=Object(S.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},e))||void 0===a?void 0:a.values}),[e]),y=Object(o.useMemo)((()=>Array.isArray(b)?b:void 0),[b]),h=Object(o.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=Object(S.find)({category:"signal",field:"signal.rule.data_view_id"},e))||void 0===n?void 0:n.values)&&void 0!==t?t:null===(a=Object(S.find)({category:"kibana",field:"kibana.alert.rule.parameters.data_view_id"},e))||void 0===a?void 0:a.values}),[e]),v=Object(o.useMemo)((()=>Array.isArray(h)?h[0]:void 0),[h]),E=Object(o.useMemo)((()=>[{category:"signal",field:"signal.rule.id",name:"ruleId"},{category:"signal",field:"signal.rule.rule_id",name:"ruleRuleId"},{category:"signal",field:"signal.rule.name",name:"ruleName"},{category:"signal",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,n)=>({...t,[n.name]:Object(O.a)({category:n.category,field:n.field},e)})),{})),[e]),{refetch:x}=Object(W.a)({scopeId:u}),{exceptionFlyoutType:w,openAddExceptionFlyout:T,onAddExceptionTypeClick:I,onAddExceptionCancel:M,onAddExceptionConfirm:C}=Object($.a)({refetch:x,isActiveTimelines:Object(k.isActiveTimeline)(u)}),{closeAddEventFilterModal:_,isAddEventFilterModalOpen:D,onAddEventFilterClick:A}=Object(G.a)(),[F,N]=Object(o.useState)(null),P=Object(o.useCallback)((()=>{N(null)}),[N]);return r?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiFlyoutFooter,{className:"side-panel-flyout-footer","data-test-subj":"side-panel-flyout-footer"},s.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(a.EuiFlexItem,{grow:!1},t&&s.a.createElement(B,{detailsData:e,ecsData:t,handleOnEventClosed:n,isHostIsolationPanelOpen:i,loadingEventDetails:l,onAddEventFilterClick:A,onAddExceptionTypeClick:I,onAddIsolationStatusClick:c,refetchFlyoutData:d,refetch:x,scopeId:u,onOsqueryClick:N})))),T&&null!=E.ruleId&&null!=E.ruleRuleId&&null!=E.eventId&&s.a.createElement(V.a,j()({},E,{ruleIndices:y,ruleDataViewId:v,exceptionListType:w,onCancel:M,onConfirm:C})),D&&null!=t&&s.a.createElement(U.a,{data:t,onCancel:_,maskProps:f}),F&&null!=t&&s.a.createElement(H.a,{agentId:F,defaultValues:g?{alertIds:[g]}:void 0,onClose:P,ecsData:t}))},Y=s.a.memo(Q)},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(44),i=n(2),r=n.n(i),o=n(19),s=n(4),l=n(42),c=n(827),u=n(1293),d=n(43);const p="null",m=({selectedOptions:e,defaultOptions:t,options:n,onChange:a,onSearchChange:m,isLoading:b=!1,singleSelection:y=!1,limit:h,height:v,loadingMessage:E,noMatchesMessage:x,emptyMessage:j,errorMessage:S,searchPlaceholder:O,searchInputId:k,selectedStatusMessage:w,limitReachedMessage:T,nullOptionLabel:I,nullOptionProps:M,defaultOptionsLabel:C,clearButtonLabel:_,...D})=>{const[A,F]=Object(i.useState)([]),[N,P]=Object(i.useState)(""),R=e?e.length:0,L=!!h&&R>=h,z=()=>{n||F((n=>{const a=[...n],i=e?e.filter((e=>!a.find((t=>g(t,e))))).map((e=>f(e,I,M))):[],r=t?t.filter((e=>!a.find((t=>g(t,e)))&&!i.find((t=>g(t,e))))).map((e=>f(e,I,M))):[];if(r.length){const e=(e=>{let t=e.findIndex((e=>e.isGroupLabel));return-1===t&&(t=e.push({label:null!=C?C:s.i18n.translate("userProfileComponents.userProfilesSelectable.defaultOptionsLabel",{defaultMessage:"Suggested"}),isGroupLabel:!0})-1),t})(a);a.splice(e,0,...i),a.push(...r)}else a.push(...i);return a}))};return Object(i.useEffect)((()=>{n?F(n.map((e=>f(e,I,M)))):(F([]),z())}),[n]),Object(i.useEffect)(z,[t,e]),Object(i.useEffect)((()=>{F((t=>t.map((t=>{if(e){var n;const a=void 0===e.find((e=>g(t,e)))?void 0:"on",i=!a&&L;return{...t,checked:a,disabled:i,prepend:t.data?Object(d.jsx)(u.a,{user:t.data.user,avatar:null===(n=t.data.data)||void 0===n?void 0:n.avatar,size:"s",isDisabled:i}):void 0}}return{...t,checked:void 0,disabled:void 0}}))))}),[n,t,e]),Object(d.jsx)(o.EuiSelectable,{"data-test-subj":D["data-test-subj"],options:A,onChange:t=>{if(!a)return;const n=t.filter((t=>!(t.isGroupLabel||"on"!==t.checked||e&&void 0!==e.find((e=>g(t,e)))))).map((e=>e.key===p?null:e.data));e&&!y&&e.forEach((e=>{const a=t.find((t=>g(t,e)));void 0!==a&&"on"!==a.checked||(a&&a.key===p?n.unshift(e):n.push(e))})),a(n)},style:{maxHeight:v},singleSelection:y,searchable:!0,searchProps:{placeholder:null!=O?O:s.i18n.translate("userProfileComponents.userProfilesSelectable.searchPlaceholder",{defaultMessage:"Search"}),value:N,onChange:e=>{P(e),null==m||m(e)},isLoading:b,isClearable:!b,id:k},isPreFiltered:!0,listProps:{onFocusBadge:!1,rowHeight:48},loadingMessage:E,noMatchesMessage:x,emptyMessage:j,errorMessage:S,renderOption:(e,t)=>{if(e.user){const n=Object(c.e)(e.user);return Object(d.jsx)(r.a.Fragment,null,Object(d.jsx)("div",{className:"eui-textTruncate"},Object(d.jsx)(o.EuiHighlight,{search:t},n)),e.user.email&&e.user.email!==n?Object(d.jsx)(o.EuiText,{size:"xs",color:e.disabled?"disabled":"subdued",className:"eui-textTruncate"},t?Object(d.jsx)(o.EuiHighlight,{search:t},e.user.email):e.user.email):void 0)}return Object(d.jsx)(o.EuiHighlight,{search:t},e.label)}},((e,t)=>Object(d.jsx)(r.a.Fragment,null,Object(d.jsx)(o.EuiPanel,{hasShadow:!1,paddingSize:"s"},t,y?void 0:Object(d.jsx)(r.a.Fragment,null,Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(o.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"s",responsive:!1},Object(d.jsx)(o.EuiFlexItem,{grow:!1},Object(d.jsx)(o.EuiText,{size:"xs",color:"subdued"},w?w(R):Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.selectedStatusMessage",defaultMessage:"{count, plural, one {# user selected} other {# users selected}}",values:{count:R}}))),Object(d.jsx)(o.EuiFlexItem,{grow:!1},R?Object(d.jsx)(o.EuiButtonEmpty,{size:"xs",flush:"right",onClick:()=>null==a?void 0:a([]),style:{height:"1rem"}},null!=_?_:Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.clearButtonLabel",defaultMessage:"Remove all users"})):void 0)))),h&&R>=h?Object(d.jsx)(r.a.Fragment,null,Object(d.jsx)(o.EuiHorizontalRule,{margin:"none"}),Object(d.jsx)(o.EuiCallOut,{title:T?T(h):Object(d.jsx)(l.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.limitReachedMessage",defaultMessage:"You've selected the maximum of {count, plural, one {# user} other {# users}}",values:{count:h}}),color:"warning",size:"s"})):void 0,Object(d.jsx)(o.EuiHorizontalRule,{margin:"none"}),e)))};function f(e,t,n){return e?{key:e.uid,label:Object(c.d)(e.user),data:e,"data-test-subj":`userProfileSelectableOption-${e.user.username}`}:{key:p,label:null!=t?t:s.i18n.translate("userProfileComponents.userProfilesSelectable.nullOptionLabel",{defaultMessage:"No users"}),"data-test-subj":"userProfileSelectableOption-null",...n}}function g(e,t){return e.key===(t?t.uid:p)}var b=n(7),y=n(47),h=n(483),v=n(118),E=n(123),x=n(824),j=n(405),S=n(5);var O=n(661),k=n(825),w=n(826);const T=Object(i.memo)((({searchInputId:e,assignedUserIds:t,showUnassignedOption:n,onSelectionChange:o})=>{const{data:s}=(()=>{const{security:e}=Object(v.j)().services,{addError:t}=Object(E.a)();return Object(y.useQuery)(["useGetCurrentUserProfile"],(async()=>(async({security:e})=>e.userProfiles.getCurrent({dataPath:"avatar"}))({security:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:h.a})}})})(),l=Object(i.useMemo)((()=>new Set(Object(k.b)(t))),[t]),{isLoading:c,data:u}=Object(O.a)({uids:l}),[d,p]=Object(i.useState)(""),{isLoading:f,data:g}=(({searchTerm:e})=>{const{addError:t}=Object(E.a)();return Object(y.useQuery)(["useSuggestUsers",e],(async()=>(async({searchTerm:e})=>(async({searchTerm:e})=>v.b.get().http.fetch(S.jb,{method:"GET",version:"1",query:{searchTerm:e}}))({searchTerm:e}))({searchTerm:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:h.c})}})})({searchTerm:d}),T=Object(i.useMemo)((()=>{var e;const t=null!==(e=Object(k.a)(s,g))&&void 0!==e?e:[];return n&&Object(b.isEmpty)(d)?[j.b,...t]:t}),[s,d,n,g]),[I,M]=Object(i.useState)([]);Object(i.useEffect)((()=>{if(c||!u)return;const e=void 0!==t.find((e=>e===j.b))?[j.b,...u]:u;M(e)}),[t,u,c]);const C=Object(i.useCallback)((e=>{Object(a.isEqual)(e,I)||(M(e),null==o||o(e.map((e=>{var t;return null!==(t=null==e?void 0:e.uid)&&void 0!==t?t:j.b}))))}),[o,I]),_=Object(i.useCallback)((e=>x.e(e)),[]),D=c||f;return r.a.createElement("div",{"data-test-subj":w.c},r.a.createElement(m,{searchInputId:e,onSearchChange:e=>{p(e)},onChange:C,selectedStatusMessage:_,options:T,selectedOptions:I,isLoading:D,height:"full",singleSelection:!1,searchPlaceholder:x.d,clearButtonLabel:x.b,nullOptionLabel:x.c}))}));T.displayName="AssigneesSelectable"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(19),i=n(2),r=n.n(i),o=n(296),s=n(869),l=n(4),c=n(59),u=n(126),d=n(130);const p=Object(d.e)(),m=Object.freeze({context:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.executionContext",{defaultMessage:"Execution context"}),output:{regular:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.outputButtonTextRegular",{defaultMessage:"Execution output"}),truncated:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.outputButtonTextTruncated",{defaultMessage:"Execution output (truncated)"})},error:{regular:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.errorButtonTextRegular",{defaultMessage:"Execution error"}),truncated:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.errorButtonTextTruncated",{defaultMessage:"Execution error (truncated)"})}}),f=Object.freeze({shell:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.shellInformation",{defaultMessage:"Shell"}),returnCode:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.shellReturnCode",{defaultMessage:"Return code"}),currentDir:l.i18n.translate("xpack.securitySolution.responseActionExecuteAccordion.currentWorkingDirectory",{defaultMessage:"Executed from"})}),g=l.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.fileTruncated",{defaultMessage:"Output data in the provided zip file is truncated due to file size limitations."}),b=Object(c.euiStyled)(a.EuiText)`
  white-space: pre-wrap;
  line-break: anywhere;
`,y=Object(i.memo)((({content:e,textSize:t,title:n})=>r.a.createElement(b,{size:t},r.a.createElement("strong",null,n,": "),e)));y.displayName="ShellInfoContent";const h=Object(i.memo)((({content:e=p,initialIsOpen:t=!1,isTruncated:n=!1,isFileTruncated:o=!1,textSize:s,type:l,"data-test-subj":c})=>{const d=Object(u.a)(c),f=Object(a.useGeneratedHtmlId)({prefix:"executeActionOutputAccordions",suffix:l}),y=Object(i.useMemo)((()=>r.a.createElement(a.EuiText,{size:s,"data-test-subj":d("title")},"context"!==l?n?m[l].truncated:m[l].regular:m[l])),[d,n,s,l]);return r.a.createElement(a.EuiAccordion,{id:f,initialIsOpen:t,buttonContent:y,paddingSize:"s","data-test-subj":c},r.a.createElement(b,{size:s},o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiTextColor,{color:"warning","data-test-subj":d("fileTruncatedMsg")},g),r.a.createElement(a.EuiSpacer,{size:"m"})),"string"==typeof e?r.a.createElement("p",null,e):e))}));h.displayName="ExecutionActionOutputAccordion";const v=Object(i.memo)((({outputContent:e,"data-test-subj":t,textSize:n="xs"})=>{const o=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"m","data-test-subj":`${t}-shell`},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(y,{title:f.shell,content:e.shell,textSize:n})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(y,{title:f.returnCode,content:e.shell_code,textSize:n}))),r.a.createElement("div",{"data-test-subj":`${t}-cwd`},r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(y,{title:f.currentDir,content:e.cwd,textSize:n})))),[t,e.cwd,e.shell,e.shell_code,n]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(h,{content:o,"data-test-subj":`${t}-context`,textSize:n,type:"context"})),r.a.createElement(a.EuiFlexItem,null,e.stderr.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(h,{content:e.stderr.length?e.stderr:void 0,"data-test-subj":`${t}-error`,isTruncated:e.stderr_truncated,isFileTruncated:e.output_file_stderr_truncated,textSize:n,initialIsOpen:!0,type:"error"})),r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(h,{content:e.stdout.length?e.stdout:void 0,"data-test-subj":`${t}-output`,isTruncated:e.stdout_truncated,isFileTruncated:e.output_file_stdout_truncated,initialIsOpen:!0,textSize:n,type:"output"})))}));v.displayName="ExecuteActionHostResponseOutput";const E=Object(i.memo)((({action:e,agentId:t=e.agents[0],canAccessFileDownloadLink:n,textSize:l="s","data-test-subj":c})=>{const u=Object(i.useMemo)((()=>e.outputs&&e.outputs[t]&&e.outputs[t].content),[e.outputs,t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(s.a,{action:e,buttonTitle:o.b,canAccessFileDownloadLink:n,"data-test-subj":`${c}-getExecuteLink`,textSize:l}),r.a.createElement(a.EuiSpacer,{size:"xxl"})),u&&r.a.createElement(v,{outputContent:u,"data-test-subj":`${c}-executeResponseOutput`,textSize:l}))}));E.displayName="ExecuteActionHostResponse"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(7),i=n(2),r=n.n(i),o=n(19),s=n(748),l=n(16),c=n(293),u=n(405),d=n(923);const p=({alertItems:e,refresh:t,setIsLoading:n,clearSelection:o,closePopoverMenu:l,onSubmit:c})=>{const u=Object(i.useMemo)((()=>e.map((e=>e._id))),[e]),p=Object(i.useMemo)((()=>Object(a.intersection)(...e.map((e=>{var t,n;return null!==(t=null===(n=e.data.find((e=>e.field===s.F)))||void 0===n?void 0:n.value)&&void 0!==t?t:[]})))),[e]),m=Object(i.useCallback)((()=>{t&&t(),o&&o()}),[o,t]),f=Object(i.useCallback)((async e=>{l(),c&&(l(),await c(e,u,m,n))}),[u,l,c,m,n]);return r.a.createElement("div",{"data-test-subj":"alert-assignees-selectable-menu"},r.a.createElement(d.a,{assignedUserIds:p,onApply:f}))},m=Object(i.memo)(p);var f=n(333),g=n(964);const b=({onAssigneesUpdate:e})=>{const t=Object(l.b)().isPlatinumPlus(),{hasIndexWrite:n}=Object(c.a)(),d=Object(g.a)(),p=Object(i.useCallback)((async(e,t,n,a)=>{d&&await d(e,t,n,a)}),[d]),b=Object(i.useCallback)((()=>{null==e||e()}),[e]),y=Object(i.useCallback)((async(e,t,n)=>{const i=e.map((e=>e._id)),r=Object(a.union)(...e.map((e=>{var t,n;return null!==(t=null===(n=e.data.find((e=>e.field===s.F)))||void 0===n?void 0:n.value)&&void 0!==t?t:[]})));if(!r.length)return;const o={add:[],remove:r};d&&await d(o,i,b,n)}),[b,d]),h=Object(i.useMemo)((()=>n&&t?[{key:"manage-alert-assignees","data-test-subj":"alert-assignees-context-menu-item",name:f.c,panel:2,label:f.c,disableOnQuery:!0},{key:"remove-all-alert-assignees","data-test-subj":"remove-alert-assignees-menu-item",name:f.s,label:f.s,disableOnQuery:!0,onClick:y}]:[]),[n,t,y]),v=Object(i.useMemo)((()=>r.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(o.EuiFlexItem,{grow:!1},f.c))),[]),E=Object(i.useCallback)((({alertItems:e,refresh:t,setIsBulkActionsLoading:n,clearSelection:a,closePopoverMenu:i})=>r.a.createElement(m,{alertItems:e,refresh:()=>{b(),null==t||t()},setIsLoading:n,clearSelection:a,closePopoverMenu:i,onSubmit:p})),[p,b]),x=Object(i.useMemo)((()=>n&&t?[{id:2,title:v,"data-test-subj":"alert-assignees-context-menu-panel",renderContent:E,width:u.a}]:[]),[v,n,t,E]);return Object(i.useMemo)((()=>({alertAssigneesItems:h,alertAssigneesPanels:x})),[h,x])}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),i=n(1371);const r=a.exact(a.type({comment:i.a})),o=a.array(r),s=(a.union([o,a[void 0]]),new a.Type("DefaultCreateComments",a.array(r).is,(e=>null==e?a.success([]):a.array(r).decode(e)),a.identity))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n(2);var a=n(19),i=n(43),r=n(49);const o=Object(i.css)("border-bottom:1px solid ",r.euiThemeVars.euiColorLightShade,";",""),s=Object(i.css)("color:",r.euiThemeVars.euiColorPrimary,";flex-basis:content;",""),l=({dataTestSubj:e,linkedRules:t,securityLinkAnchorComponent:n,leftIcon:r=""})=>{if(!t.length||null===n)return null;const l=n;return t.map((n=>Object(i.jsx)(a.EuiContextMenuItem,{css:t.length>1?o:"","data-test-subj":`${e||""}ActionItem${n.id}`,key:n.id},Object(i.jsx)(a.EuiFlexGroup,{gutterSize:"s",css:s},r?Object(i.jsx)(a.EuiFlexItem,{"data-test-subj":`${e||""}LeftIcon`,grow:!1},Object(i.jsx)(a.EuiIcon,{type:r})):null,Object(i.jsx)(a.EuiFlexItem,{css:s},Object(i.jsx)(l,{external:!0,referenceName:n.name,referenceId:n.id}))))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(7);const i=e=>{const{id:t,revision:n,created_by:i,created_at:r,updated_by:o,updated_at:s,...l}=e,c=Object(a.cloneDeep)(l),u=c.inputs[0].config.policy.value;return[u.windows.popup.malware,u.mac.popup.malware].forEach((e=>e.message.trim())),c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(19),i=n(128),r=n(2),o=n.n(r);const s=o.a.memo((({hoverContent:e,anchorPosition:t="downCenter",children:n})=>{const[s,l]=Object(r.useState)(null!=e),[c,u]=Object(r.useState)(!1),[,d]=Object(r.useState)(void 0),p=Object(r.useRef)(null),m=Object(r.useCallback)((()=>{d((e=>{clearTimeout(e)})),u(!1)}),[]),f=Object(r.useCallback)((()=>{d(Number(setTimeout((()=>{document.body.classList.contains(i.c)||u(!0)}),100)))}),[d,u]),g=Object(r.useCallback)((()=>{m()}),[m]),b=Object(r.useCallback)((e=>{s&&"Escape"===e.key&&g()}),[s,g]);return Object(r.useEffect)((()=>{l(null!=e&&c)}),[e,c]),Object(r.useEffect)((()=>{var e;s&&(null==p||null===(e=p.current)||void 0===e||e.positionPopoverFluid())}),[e,s]),o.a.createElement("div",{onMouseLeave:g},o.a.createElement(a.EuiPopover,{ref:p,anchorPosition:t,button:o.a.createElement("div",{"data-test-subj":"HoverPopoverButton",onMouseEnter:f},n),closePopover:m,hasArrow:!1,isOpen:s,ownFocus:!1,panelPaddingSize:"none",panelStyle:{minInlineSize:"fit-content"},panelClassName:"HoverPopover__popover",repositionOnScroll:!0},s?o.a.createElement("div",{onKeyDown:b},e):null))}));s.displayName="HoverPopover"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(118),r=n(128),o=n(64);const s=({closePopover:e,draggableId:t,fieldName:n,keyboardHandlerRef:s,openPopover:l})=>{const{timelines:c}=Object(i.j)().services,u=c.getUseAddToTimeline(),{beginDrag:d,cancelDrag:p,dragToLocation:m,endDrag:f,hasDraggableLock:g}=u({draggableId:t,fieldName:n}),[b,y]=Object(a.useState)(null),h=Object(a.useCallback)((()=>{y((e=>e?(p(e),null):null))}),[p]),v=Object(a.useCallback)((n=>{const a=document.querySelector(`[data-rbd-drag-handle-draggable-id="${t}"]`);var i;a&&((g()||!g()&&" "===n.key)&&(n.preventDefault(),n.stopPropagation()),(({beginDrag:e,cancelDragActions:t,closePopover:n,draggableElement:a,dragActions:i,dragToLocation:s,endDrag:l,keyboardEvent:c,openPopover:u,setDragActions:d})=>{let p=null;switch(c.key){case" ":i?(l(i),d(null)):(null!=n&&n(),d(e()));break;case"Escape":t();break;case"Tab":(e=>{const t=e.querySelectorAll("a, button");t.forEach((e=>{e.setAttribute("tabindex","-1")})),setTimeout((()=>{t.forEach((e=>{e.setAttribute("tabindex","0")}))}),0)})(a);break;case"ArrowUp":p=a.getBoundingClientRect(),s({dragActions:i,position:{x:p.x,y:p.y-r.e}});break;case"ArrowDown":p=a.getBoundingClientRect(),s({dragActions:i,position:{x:p.x,y:p.y+r.e}});break;case"ArrowLeft":p=a.getBoundingClientRect(),s({dragActions:i,position:{x:p.x-r.e,y:p.y}});break;case"ArrowRight":p=a.getBoundingClientRect(),s({dragActions:i,position:{x:p.x+r.e,y:p.y}});break;case"Enter":Object(o.stopPropagationAndPreventDefault)(c),i||null==u||u()}})({beginDrag:d,cancelDragActions:h,closePopover:e,dragActions:b,draggableElement:a,dragToLocation:m,endDrag:f,keyboardEvent:n,openPopover:l,setDragActions:y}),null===(i=s.current)||void 0===i||i.focus())}),[d,h,e,b,t,m,f,g,s,l,y]);return Object(a.useMemo)((()=>({onBlur:h,onKeyDown:v})),[h,v])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(41),c=n.n(l),u=n(42),d=n(50),p=n(126),m=n(182);const f=c.a.div.withConfig({displayName:"RootContainer",componentId:"sc-ptw6hp-0"})(["position:relative;padding-top:",";.body{min-height:",";&-content{position:relative;}}"],(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXXL)),g=Object(r.memo)((({"data-test-subj":e})=>o.a.createElement(s.EuiEmptyPrompt,{"data-test-subj":e,title:o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.endpoint.paginatedContent.noItemsFoundTitle",defaultMessage:"No items found"})})));g.displayName="DefaultNoItemsFound";const b=Object(r.memo)((({message:e,"data-test-subj":t})=>o.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiIcon,{type:"minusInCircle",color:"danger"})," ",e,o.a.createElement(s.EuiSpacer,{size:"m"}))));b.displayName="ErrorMessage";const y=Object(r.memo)((({items:e,ItemComponent:t,itemComponentProps:n,itemId:a,onChange:l,pagination:c,loading:u,noItemsMessage:y,error:h,contentClassName:v,"data-test-subj":E,"aria-label":x,className:j,CardDecorator:S,children:O})=>{const[k]=Object(r.useState)(new WeakMap),w=Object(p.a)(E),T=Object(r.useMemo)((()=>Math.ceil(((null==c?void 0:c.totalItemCount)||1)/((null==c?void 0:c.pageSize)||1))),[null==c?void 0:c.pageSize,null==c?void 0:c.totalItemCount]);Object(r.useEffect)((()=>{!u&&T>0&&T<((null==c?void 0:c.pageIndex)||0)+1&&l({pageIndex:T-1,pageSize:(null==c?void 0:c.pageSize)||0})}),[T,l,c,u]);const I=Object(r.useCallback)((e=>{if(null!=c&&c.pageIndex){var t,n;const a=Math.floor((null!==(t=null==c?void 0:c.pageIndex)&&void 0!==t?t:m.b)*(null!==(n=null==c?void 0:c.pageSize)&&void 0!==n?n:m.c)/e);l({pageSize:e,pageIndex:isNaN(a)?m.b:a})}else l({pageSize:e,pageIndex:m.b})}),[l,c]),M=Object(r.useCallback)((e=>{l({pageIndex:e,pageSize:(null==c?void 0:c.pageSize)||m.c})}),[l,null==c?void 0:c.pageSize]),C=Object(r.useMemo)((()=>{if(h)return h instanceof Error?o.a.createElement(b,{message:h.message,"data-test-subj":w("error")}):"string"==typeof h?o.a.createElement(b,{message:h,"data-test-subj":w("error")}):h;const r=t;return e.length?e.map((e=>{let t;return a?t=e[a]:k.has(e)?t=k.get(e):(t=Object(d.v4)(),k.set(e,t)),o.a.createElement(r,i()({},n(e),{key:t,Decorator:S}))})):u?void 0:y||o.a.createElement(g,{"data-test-subj":w("noResults")})}),[h,t,e,u,y,w,a,n,S,k]);return o.a.createElement(f,{"data-test-subj":E,"aria-label":x,className:j},u&&o.a.createElement(s.EuiProgress,{size:"xs",color:"primary",position:"absolute","data-test-subj":w("loader")}),o.a.createElement("div",{className:"body","data-test-subj":w("body")},o.a.createElement("div",{className:`body-content ${v}`},O||C)),c&&(O||e.length>0)&&o.a.createElement("div",{"data-test-subj":w("footer")},o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(s.EuiTablePagination,{activePage:c.pageIndex,itemsPerPage:c.pageSize,itemsPerPageOptions:c.pageSizeOptions,pageCount:T,showPerPageOptions:c.showPerPageOptions,onChangeItemsPerPage:I,onChangePage:M})))}));y.displayName="PaginatedContent"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(42),i=n(2),r=n.n(i),o=n(19),s=n(4),l=n(60),c=n.n(l),u=n(885),d=n(126),p=n(1263);const m=Object.freeze({path:s.i18n.translate("xpack.securitySolution.endpointUploadActionResult.savedTo",{defaultMessage:"File saved to"}),disk_free_space:s.i18n.translate("xpack.securitySolution.endpointUploadActionResult.freeDiskSpace",{defaultMessage:"Free disk space on drive"}),noAgentResponse:s.i18n.translate("xpack.securitySolution.endpointUploadActionResult.missingAgentResult",{defaultMessage:"Error: Agent result missing"}),host:s.i18n.translate("xpack.securitySolution.endpointUploadActionResult.host",{defaultMessage:"Host"})}),f=Object(i.memo)((({action:e,agentId:t,textSize:n="s","data-test-subj":s})=>{const l=e,f=Object(d.a)(s),b=Object(i.useMemo)((()=>{const e=[],n=t?[t]:l.agents;for(const t of n){var a;e.push({name:l.hosts[t].name,state:l.agentState[t],result:null===(a=l.outputs)||void 0===a?void 0:a[t]})}return e}),[l.agentState,l.agents,l.hosts,l.outputs,t]),y=b.length>1;return"upload"!==l.command?(window.console.warn("EndpointUploadActionResult: called with a non-upload action"),r.a.createElement(r.a.Fragment,null)):0===b.length?(window.console.warn(`EndpointUploadActionResult: Agent id [${t}] not in list of agents for action`),r.a.createElement(r.a.Fragment,null)):r.a.createElement(o.EuiText,{"data-test-subj":f(),size:n},b.map((({name:e,state:t,result:n})=>t.isCompleted?n?t.wasSuccessful?r.a.createElement(g,{name:y?e:void 0,"data-test-subj":f("success"),key:e},r.a.createElement(p.a,{name:m.path,value:n.content.path}),r.a.createElement(p.a,{name:m.disk_free_space,value:c()(n.content.disk_free_space).format("0.00b")})):r.a.createElement(g,{name:y?e:void 0,"data-test-subj":f("actionFailure"),key:e},r.a.createElement(u.a,{action:l})):r.a.createElement(g,{name:y?e:void 0,"data-test-subj":f("noResultError"),key:e},m.noAgentResponse):r.a.createElement(g,{name:y?e:void 0,"data-test-subj":f("pending"),key:e},r.a.createElement(a.FormattedMessage,{id:"xpack.securitySolution.endpointUploadActionResult.pendingMessage",defaultMessage:"Action pending."})))))}));f.displayName="EndpointUploadActionResult";const g=Object(i.memo)((({name:e,children:t,"data-test-subj":n})=>r.a.createElement("div",{"data-test-subj":n},e&&r.a.createElement(p.a,{name:m.host,value:e}),t,e&&r.a.createElement(o.EuiSpacer,null))));g.displayName="HostUploadResult"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(41),i=n.n(a),r=n(2),o=n.n(r);n(43);const s=Object(r.memo)((({name:e,value:t})=>o.a.createElement(l,{className:"eui-textBreakWord"},o.a.createElement("strong",null,e,": "),t)));s.displayName="KeyValueDisplay";var l=i()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1202vlt-0"})(["white-space:pre-wrap;"])},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterableComposition=void 0;var a=n(1278),i=n(798);t.getFilterableComposition=function(e,t){var n=a.getCompactableComposition(e,t),r={map:n.map,compact:n.compact,separate:n.separate,partitionMap:function(e,t){return{left:r.filterMap(e,(function(e){return i.getLeft(t(e))})),right:r.filterMap(e,(function(e){return i.getRight(t(e))}))}},partition:function(e,t){return{left:r.filter(e,(function(e){return!t(e)})),right:r.filter(e,t)}},filterMap:function(n,a){return e.map(n,(function(e){return t.filterMap(e,a)}))},filter:function(n,a){return e.map(n,(function(e){return t.filter(e,a)}))}};return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompactableComposition=void 0;var a=n(1279),i=n(798);t.getCompactableComposition=function(e,t){var n=a.getFunctorComposition(e,t),r={map:n.map,compact:function(n){return e.map(n,t.compact)},separate:function(e){return{left:r.compact(n.map(e,i.getLeft)),right:r.compact(n.map(e,i.getRight))}}};return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctorComposition=void 0,t.getFunctorComposition=function(e,t){return{map:function(n,a){return e.map(n,(function(e){return t.map(e,a)}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.bind=t.bindTo=t.never=t.taskSeq=t.task=t.Monad=t.ApplicativeSeq=t.ApplicativePar=t.Functor=t.getRaceMonoid=t.getMonoid=t.getSemigroup=t.URI=t.fromTask=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.chainIOK=t.fromIOK=t.delay=t.fromIO=void 0;var a=n(269);function i(e){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return t.fromIO(e.apply(void 0,n))}}t.fromIO=function(e){return function(){return Promise.resolve(e())}},t.delay=function(e){return function(t){return function(){return new Promise((function(n){setTimeout((function(){t().then(n)}),e)}))}}},t.fromIOK=i,t.chainIOK=function(e){return t.chain(i(e))};var r=function(e,n){return a.pipe(e,t.map(n))},o=function(e,n){return a.pipe(e,t.ap(n))},s=function(e,n){return a.pipe(e,t.chain((function(e){return a.pipe(n,t.map(e))})))},l=function(e,n){return a.pipe(e,t.chain(n))};function c(e){return{concat:function(t,n){return function(){return t().then((function(t){return n().then((function(n){return e.concat(t,n)}))}))}}}}t.map=function(e){return function(t){return function(){return t().then(e)}}},t.ap=function(e){return function(t){return function(){return Promise.all([t(),e()]).then((function(e){return(0,e[0])(e[1])}))}}},t.apFirst=function(e){return a.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return a.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=function(e){return function(){return Promise.resolve(e)}},t.chain=function(e){return function(t){return function(){return t().then((function(t){return e(t)()}))}}},t.chainFirst=function(e){return t.chain((function(n){return a.pipe(e(n),t.map((function(){return n})))}))},t.flatten=t.chain(a.identity),t.fromTask=a.identity,t.URI="Task",t.getSemigroup=c,t.getMonoid=function(e){return{concat:c(e).concat,empty:t.of(e.empty)}},t.getRaceMonoid=function(){return{concat:function(e,t){return function(){return Promise.race([e(),t()])}},empty:t.never}},t.Functor={URI:t.URI,map:r},t.ApplicativePar={URI:t.URI,map:r,ap:o,of:t.of},t.ApplicativeSeq={URI:t.URI,map:r,ap:s,of:t.of},t.Monad={URI:t.URI,map:r,of:t.of,ap:o,chain:l},t.task={URI:t.URI,map:r,of:t.of,ap:o,chain:l,fromIO:t.fromIO,fromTask:t.fromTask},t.taskSeq={URI:t.URI,map:r,of:t.of,ap:s,chain:l,fromIO:t.fromIO,fromTask:t.fromTask},t.never=function(){return new Promise((function(e){}))},t.bindTo=function(e){return t.map(a.bindTo_(e))},t.bind=function(e,n){return t.chain((function(i){return a.pipe(n(i),t.map((function(t){return a.bind_(i,e,t)})))}))},t.apS=function(e,n){return a.flow(t.map((function(t){return function(n){return a.bind_(t,e,n)}})),t.ap(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(46),i=n(1371),r=n(397),o=n(398),s=n(214),l=n(401),c=n(402);const u=a.intersection([a.exact(a.type({comment:i.a,created_at:r.a,created_by:o.a,id:s.a})),a.exact(a.partial({updated_at:l.a,updated_by:c.a}))]),d=a.array(u);a.union([d,a[void 0]])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),i=n(1371),r=n(1283);const o=a.exact(a.type({entries:r.b,field:i.a,type:a.keyof({nested:null})}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n(46),i=n(801),r=n(876),o=n(802);const s=a.union([i.a,r.a,o.a]),l=a.array(s),c=new a.Type("NonEmptyNestedEntriesArray",l.is,((e,t)=>Array.isArray(e)&&0===e.length?a.failure(e,t):l.validate(e,t)),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(46);const i=n(1531).a,r=a.union([i,a[void 0]])},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(48),r=n(1346);const o=()=>{const{pathname:e}=Object(i.useLocation)(),t=Object(r.a)();return[Object(a.useMemo)((()=>t(e)),[e,t])]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(119),i=n.n(a),r=n(19),o=(n(2),n(827)),s=n(43);const l=({user:e,avatar:t,...n})=>{const{euiTheme:a}=Object(r.useEuiTheme)();if(!e)return Object(s.jsx)(r.EuiAvatar,i()({name:"",color:a.colors.lightestShade,initials:"?"},n));const l=Object(o.d)(e);return null!=t&&t.imageUrl?Object(s.jsx)(r.EuiAvatar,i()({name:l,imageUrl:t.imageUrl,color:"plain"},n)):Object(s.jsx)(r.EuiAvatar,i()({name:l,initials:Object(o.c)(e,t),initialsLength:o.a,color:Object(o.b)(e,t)},n))}},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},,function(e,t,n){!function(e,t,n,a,i,r){"use strict";function o(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function s(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const l=Symbol("implicit");function c(){var e=new Map,t=[],n=[],a=l;function i(i){var r=i+"",o=e.get(r);if(!o){if(a!==l)return a;e.set(r,o=t.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of n){const n=a+"";e.has(n)||e.set(n,t.push(a))}return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(a=e,i):a},i.copy=function(){return c(t,n).unknown(a)},o.apply(i,arguments),i}function u(){var e,n,a=c().unknown(void 0),i=a.domain,r=a.range,s=0,l=1,d=!1,p=0,m=0,f=.5;function g(){var a=i().length,o=l<s,c=o?l:s,u=o?s:l;e=(u-c)/Math.max(1,a-p+2*m),d&&(e=Math.floor(e)),c+=(u-c-e*(a-p))*f,n=e*(1-p),d&&(c=Math.round(c),n=Math.round(n));var g=t.range(a).map((function(t){return c+e*t}));return r(o?g.reverse():g)}return delete a.unknown,a.domain=function(e){return arguments.length?(i(e),g()):i()},a.range=function(e){return arguments.length?([s,l]=e,s=+s,l=+l,g()):[s,l]},a.rangeRound=function(e){return[s,l]=e,s=+s,l=+l,d=!0,g()},a.bandwidth=function(){return n},a.step=function(){return e},a.round=function(e){return arguments.length?(d=!!e,g()):d},a.padding=function(e){return arguments.length?(p=Math.min(1,m=+e),g()):p},a.paddingInner=function(e){return arguments.length?(p=Math.min(1,e),g()):p},a.paddingOuter=function(e){return arguments.length?(m=+e,g()):m},a.align=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),g()):f},a.copy=function(){return u(i(),[s,l]).round(d).paddingInner(p).paddingOuter(m).align(f)},o.apply(g(),arguments)}function d(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return d(t())},e}function p(e){return+e}var m=[0,1];function f(e){return e}function g(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function b(e,t,n){var a=e[0],i=e[1],r=t[0],o=t[1];return i<a?(a=g(i,a),r=n(o,r)):(a=g(a,i),r=n(r,o)),function(e){return r(a(e))}}function y(e,n,a){var i=Math.min(e.length,n.length)-1,r=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++s<i;)r[s]=g(e[s],e[s+1]),o[s]=a(n[s],n[s+1]);return function(n){var a=t.bisect(e,n,1,i)-1;return o[a](r[a](n))}}function h(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function v(){var e,t,a,i,r,o,s=m,l=m,c=n.interpolate,u=f;function d(){var e,t,n,a=Math.min(s.length,l.length);return u!==f&&(e=s[0],t=s[a-1],e>t&&(n=e,e=t,t=n),u=function(n){return Math.max(e,Math.min(t,n))}),i=a>2?y:b,r=o=null,g}function g(t){return null==t||isNaN(t=+t)?a:(r||(r=i(s.map(e),l,c)))(e(u(t)))}return g.invert=function(a){return u(t((o||(o=i(l,s.map(e),n.interpolateNumber)))(a)))},g.domain=function(e){return arguments.length?(s=Array.from(e,p),d()):s.slice()},g.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},g.rangeRound=function(e){return l=Array.from(e),c=n.interpolateRound,d()},g.clamp=function(e){return arguments.length?(u=!!e||f,d()):u!==f},g.interpolate=function(e){return arguments.length?(c=e,d()):c},g.unknown=function(e){return arguments.length?(a=e,g):a},function(n,a){return e=n,t=a,d()}}function E(){return v()(f,f)}function x(e,n,i,r){var o,s=t.tickStep(e,n,i);switch((r=a.formatSpecifier(null==r?",f":r)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(n));return null!=r.precision||isNaN(o=a.precisionPrefix(s,l))||(r.precision=o),a.formatPrefix(r,l);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=a.precisionRound(s,Math.max(Math.abs(e),Math.abs(n))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=a.precisionFixed(s))||(r.precision=o-2*("%"===r.type))}return a.format(r)}function j(e){var n=e.domain;return e.ticks=function(e){var a=n();return t.ticks(a[0],a[a.length-1],null==e?10:e)},e.tickFormat=function(e,t){var a=n();return x(a[0],a[a.length-1],null==e?10:e,t)},e.nice=function(a){null==a&&(a=10);var i,r,o=n(),s=0,l=o.length-1,c=o[s],u=o[l],d=10;for(u<c&&(r=c,c=u,u=r,r=s,s=l,l=r);d-- >0;){if((r=t.tickIncrement(c,u,a))===i)return o[s]=c,o[l]=u,n(o);if(r>0)c=Math.floor(c/r)*r,u=Math.ceil(u/r)*r;else{if(!(r<0))break;c=Math.ceil(c*r)/r,u=Math.floor(u*r)/r}i=r}return e},e}function S(e,t){var n,a=0,i=(e=e.slice()).length-1,r=e[a],o=e[i];return o<r&&(n=a,a=i,i=n,n=r,r=o,o=n),e[a]=t.floor(r),e[i]=t.ceil(o),e}function O(e){return Math.log(e)}function k(e){return Math.exp(e)}function w(e){return-Math.log(-e)}function T(e){return-Math.exp(-e)}function I(e){return isFinite(e)?+("1e"+e):e<0?0:e}function M(e){return function(t){return-e(-t)}}function C(e){var n,i,r=e(O,k),o=r.domain,s=10;function l(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(s),i=function(e){return 10===e?I:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(s),o()[0]<0?(n=M(n),i=M(i),e(w,T)):e(O,k),r}return r.base=function(e){return arguments.length?(s=+e,l()):s},r.domain=function(e){return arguments.length?(o(e),l()):o()},r.ticks=function(e){var a,r=o(),l=r[0],c=r[r.length-1];(a=c<l)&&(m=l,l=c,c=m);var u,d,p,m=n(l),f=n(c),g=null==e?10:+e,b=[];if(!(s%1)&&f-m<g){if(m=Math.floor(m),f=Math.ceil(f),l>0){for(;m<=f;++m)for(d=1,u=i(m);d<s;++d)if(!((p=u*d)<l)){if(p>c)break;b.push(p)}}else for(;m<=f;++m)for(d=s-1,u=i(m);d>=1;--d)if(!((p=u*d)<l)){if(p>c)break;b.push(p)}2*b.length<g&&(b=t.ticks(l,c,g))}else b=t.ticks(m,f,Math.min(f-m,g)).map(i);return a?b.reverse():b},r.tickFormat=function(e,t){if(null==t&&(t=10===s?".0e":","),"function"!=typeof t&&(t=a.format(t)),e===1/0)return t;null==e&&(e=10);var o=Math.max(1,s*e/r.ticks().length);return function(e){var a=e/i(Math.round(n(e)));return a*s<s-.5&&(a*=s),a<=o?t(e):""}},r.nice=function(){return o(S(o(),{floor:function(e){return i(Math.floor(n(e)))},ceil:function(e){return i(Math.ceil(n(e)))}}))},r}function _(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function D(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function A(e){var t=1,n=e(_(t),D(t));return n.constant=function(n){return arguments.length?e(_(t=+n),D(t)):t},j(n)}function F(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function N(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function P(e){return e<0?-e*e:e*e}function R(e){var t=e(f,f),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(f,f):.5===n?e(N,P):e(F(n),F(1/n)):n},j(t)}function L(){var e=R(v());return e.copy=function(){return h(e,L()).exponent(e.exponent())},o.apply(e,arguments),e}function z(e){return Math.sign(e)*e*e}function q(e){return new Date(e)}function B(e){return e instanceof Date?+e:+new Date(+e)}function $(e,t,n,a,i,r,o,s,l,c){var u=E(),d=u.invert,p=u.domain,m=c(".%L"),f=c(":%S"),g=c("%I:%M"),b=c("%I %p"),y=c("%a %d"),v=c("%b %d"),x=c("%B"),j=c("%Y");function O(e){return(l(e)<e?m:s(e)<e?f:o(e)<e?g:r(e)<e?b:a(e)<e?i(e)<e?y:v:n(e)<e?x:j)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?p(Array.from(e,B)):p().map(q)},u.ticks=function(t){var n=p();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?O:c(t)},u.nice=function(e){var n=p();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?p(S(n,e)):u},u.copy=function(){return h(u,$(e,t,n,a,i,r,o,s,l,c))},u}function V(){var e,t,a,i,r,o=0,s=1,l=f,c=!1;function u(t){return null==t||isNaN(t=+t)?r:l(0===a?.5:(t=(i(t)-e)*a,c?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var n,a;return arguments.length?([n,a]=t,l=e(n,a),u):[l(0),l(1)]}}return u.domain=function(n){return arguments.length?([o,s]=n,e=i(o=+o),t=i(s=+s),a=e===t?0:1/(t-e),u):[o,s]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(l=e,u):l},u.range=d(n.interpolate),u.rangeRound=d(n.interpolateRound),u.unknown=function(e){return arguments.length?(r=e,u):r},function(n){return i=n,e=n(o),t=n(s),a=e===t?0:1/(t-e),u}}function U(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function G(){var e=R(V());return e.copy=function(){return U(e,G()).exponent(e.exponent())},s.apply(e,arguments)}function H(){var e,t,a,i,r,o,s,l=0,c=.5,u=1,d=1,p=f,m=!1;function g(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-t)*(d*e<d*t?i:r),p(m?Math.max(0,Math.min(1,e)):e))}function b(e){return function(t){var a,i,r;return arguments.length?([a,i,r]=t,p=n.piecewise(e,[a,i,r]),g):[p(0),p(.5),p(1)]}}return g.domain=function(n){return arguments.length?([l,c,u]=n,e=o(l=+l),t=o(c=+c),a=o(u=+u),i=e===t?0:.5/(t-e),r=t===a?0:.5/(a-t),d=t<e?-1:1,g):[l,c,u]},g.clamp=function(e){return arguments.length?(m=!!e,g):m},g.interpolator=function(e){return arguments.length?(p=e,g):p},g.range=b(n.interpolate),g.rangeRound=b(n.interpolateRound),g.unknown=function(e){return arguments.length?(s=e,g):s},function(n){return o=n,e=n(l),t=n(c),a=n(u),i=e===t?0:.5/(t-e),r=t===a?0:.5/(a-t),d=t<e?-1:1,g}}function W(){var e=R(H());return e.copy=function(){return U(e,W()).exponent(e.exponent())},s.apply(e,arguments)}e.scaleBand=u,e.scaleDiverging=function e(){var t=j(H()(f));return t.copy=function(){return U(t,e())},s.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=C(H()).domain([.1,1,10]);return t.copy=function(){return U(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleDivergingPow=W,e.scaleDivergingSqrt=function(){return W.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=A(H());return t.copy=function(){return U(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleIdentity=function e(t){var n;function a(e){return null==e||isNaN(e=+e)?n:e}return a.invert=a,a.domain=a.range=function(e){return arguments.length?(t=Array.from(e,p),a):t.slice()},a.unknown=function(e){return arguments.length?(n=e,a):n},a.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,p):[0,1],j(a)},e.scaleImplicit=l,e.scaleLinear=function e(){var t=E();return t.copy=function(){return h(t,e())},o.apply(t,arguments),j(t)},e.scaleLog=function e(){var t=C(v()).domain([1,10]);return t.copy=function(){return h(t,e()).base(t.base())},o.apply(t,arguments),t},e.scaleOrdinal=c,e.scalePoint=function(){return d(u.apply(null,arguments).paddingInner(1))},e.scalePow=L,e.scaleQuantile=function e(){var n,a=[],i=[],r=[];function s(){var e=0,n=Math.max(1,i.length);for(r=new Array(n-1);++e<n;)r[e-1]=t.quantileSorted(a,e/n);return l}function l(e){return null==e||isNaN(e=+e)?n:i[t.bisect(r,e)]}return l.invertExtent=function(e){var t=i.indexOf(e);return t<0?[NaN,NaN]:[t>0?r[t-1]:a[0],t<r.length?r[t]:a[a.length-1]]},l.domain=function(e){if(!arguments.length)return a.slice();a=[];for(let t of e)null==t||isNaN(t=+t)||a.push(t);return a.sort(t.ascending),s()},l.range=function(e){return arguments.length?(i=Array.from(e),s()):i.slice()},l.unknown=function(e){return arguments.length?(n=e,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return e().domain(a).range(i).unknown(n)},o.apply(l,arguments)},e.scaleQuantize=function e(){var n,a=0,i=1,r=1,s=[.5],l=[0,1];function c(e){return null!=e&&e<=e?l[t.bisect(s,e,0,r)]:n}function u(){var e=-1;for(s=new Array(r);++e<r;)s[e]=((e+1)*i-(e-r)*a)/(r+1);return c}return c.domain=function(e){return arguments.length?([a,i]=e,a=+a,i=+i,u()):[a,i]},c.range=function(e){return arguments.length?(r=(l=Array.from(e)).length-1,u()):l.slice()},c.invertExtent=function(e){var t=l.indexOf(e);return t<0?[NaN,NaN]:t<1?[a,s[0]]:t>=r?[s[r-1],i]:[s[t-1],s[t]]},c.unknown=function(e){return arguments.length?(n=e,c):c},c.thresholds=function(){return s.slice()},c.copy=function(){return e().domain([a,i]).range(l).unknown(n)},o.apply(j(c),arguments)},e.scaleRadial=function e(){var t,n=E(),a=[0,1],i=!1;function r(e){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(n(e));return isNaN(a)?t:i?Math.round(a):a}return r.invert=function(e){return n.invert(z(e))},r.domain=function(e){return arguments.length?(n.domain(e),r):n.domain()},r.range=function(e){return arguments.length?(n.range((a=Array.from(e,p)).map(z)),r):a.slice()},r.rangeRound=function(e){return r.range(e).round(!0)},r.round=function(e){return arguments.length?(i=!!e,r):i},r.clamp=function(e){return arguments.length?(n.clamp(e),r):n.clamp()},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return e(n.domain(),a).round(i).clamp(n.clamp()).unknown(t)},o.apply(r,arguments),j(r)},e.scaleSequential=function e(){var t=j(V()(f));return t.copy=function(){return U(t,e())},s.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=C(V()).domain([1,10]);return t.copy=function(){return U(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleSequentialPow=G,e.scaleSequentialQuantile=function e(){var n=[],a=f;function i(e){if(null!=e&&!isNaN(e=+e))return a((t.bisect(n,e,1)-1)/(n.length-1))}return i.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(t.ascending),i},i.interpolator=function(e){return arguments.length?(a=e,i):a},i.range=function(){return n.map(((e,t)=>a(t/(n.length-1))))},i.quantiles=function(e){return Array.from({length:e+1},((a,i)=>t.quantile(n,i/e)))},i.copy=function(){return e(a).domain(n)},s.apply(i,arguments)},e.scaleSequentialSqrt=function(){return G.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=A(V());return t.copy=function(){return U(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleSqrt=function(){return L.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=A(v());return t.copy=function(){return h(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleThreshold=function e(){var n,a=[.5],i=[0,1],r=1;function s(e){return null!=e&&e<=e?i[t.bisect(a,e,0,r)]:n}return s.domain=function(e){return arguments.length?(a=Array.from(e),r=Math.min(a.length,i.length-1),s):a.slice()},s.range=function(e){return arguments.length?(i=Array.from(e),r=Math.min(a.length,i.length-1),s):i.slice()},s.invertExtent=function(e){var t=i.indexOf(e);return[a[t-1],a[t]]},s.unknown=function(e){return arguments.length?(n=e,s):n},s.copy=function(){return e().domain(a).range(i).unknown(n)},o.apply(s,arguments)},e.scaleTime=function(){return o.apply($(i.timeTicks,i.timeTickInterval,i.timeYear,i.timeMonth,i.timeWeek,i.timeDay,i.timeHour,i.timeMinute,i.timeSecond,r.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return o.apply($(i.utcTicks,i.utcTickInterval,i.utcYear,i.utcMonth,i.utcWeek,i.utcDay,i.utcHour,i.utcMinute,i.utcSecond,r.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(833),n(1297),n(1299),n(834),n(1300))},function(e,t,n){!function(e,t){"use strict";function n(e,t,n,a,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*n+(1+3*e+3*r-3*o)*a+o*i)/6}function a(e){var t=e.length-1;return function(a){var i=a<=0?a=0:a>=1?(a=1,t-1):Math.floor(a*t),r=e[i],o=e[i+1],s=i>0?e[i-1]:2*r-o,l=i<t-1?e[i+2]:2*o-r;return n((a-i/t)*t,s,r,o,l)}}function i(e){var t=e.length;return function(a){var i=Math.floor(((a%=1)<0?++a:a)*t),r=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],l=e[(i+2)%t];return n((a-i/t)*t,r,o,s,l)}}var r=e=>()=>e;function o(e,t){return function(n){return e+n*t}}function s(e,t){var n=t-e;return n?o(e,n>180||n<-180?n-360*Math.round(n/360):n):r(isNaN(e)?t:e)}function l(e){return 1==(e=+e)?c:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):r(isNaN(t)?n:t)}}function c(e,t){var n=t-e;return n?o(e,n):r(isNaN(e)?t:e)}var u=function e(n){var a=l(n);function i(e,n){var i=a((e=t.rgb(e)).r,(n=t.rgb(n)).r),r=a(e.g,n.g),o=a(e.b,n.b),s=c(e.opacity,n.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function d(e){return function(n){var a,i,r=n.length,o=new Array(r),s=new Array(r),l=new Array(r);for(a=0;a<r;++a)i=t.rgb(n[a]),o[a]=i.r||0,s[a]=i.g||0,l[a]=i.b||0;return o=e(o),s=e(s),l=e(l),i.opacity=1,function(e){return i.r=o(e),i.g=s(e),i.b=l(e),i+""}}}var p=d(a),m=d(i);function f(e,t){t||(t=[]);var n,a=e?Math.min(t.length,e.length):0,i=t.slice();return function(r){for(n=0;n<a;++n)i[n]=e[n]*(1-r)+t[n]*r;return i}}function g(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b(e,t){var n,a=t?t.length:0,i=e?Math.min(a,e.length):0,r=new Array(i),o=new Array(a);for(n=0;n<i;++n)r[n]=S(e[n],t[n]);for(;n<a;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=r[n](e);return o}}function y(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function h(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function v(e,t){var n,a={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?a[n]=S(e[n],t[n]):i[n]=t[n];return function(e){for(n in a)i[n]=a[n](e);return i}}var E=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(E.source,"g");function j(e,t){var n,a,i,r=E.lastIndex=x.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=E.exec(e))&&(a=x.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:h(n,a)})),r=x.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,a=0;a<t;++a)s[(n=l[a]).i]=n.x(e);return s.join("")})}function S(e,n){var a,i=typeof n;return null==n||"boolean"===i?r(n):("number"===i?h:"string"===i?(a=t.color(n))?(n=a,u):j:n instanceof t.color?u:n instanceof Date?y:g(n)?f:Array.isArray(n)?b:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?v:h)(e,n)}var O,k=180/Math.PI,w={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function T(e,t,n,a,i,r){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*a)&&(n-=e*l,a-=t*l),(s=Math.sqrt(n*n+a*a))&&(n/=s,a/=s,l/=s),e*a<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*k,skewX:Math.atan(l)*k,scaleX:o,scaleY:s}}function I(e,t,n,a){function i(e){return e.length?e.pop()+" ":""}return function(r,o){var s=[],l=[];return r=e(r),o=e(o),function(e,a,i,r,o,s){if(e!==i||a!==r){var l=o.push("translate(",null,t,null,n);s.push({i:l-4,x:h(e,i)},{i:l-2,x:h(a,r)})}else(i||r)&&o.push("translate("+i+t+r+n)}(r.translateX,r.translateY,o.translateX,o.translateY,s,l),function(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push(i(n)+"rotate(",null,a)-2,x:h(e,t)})):t&&n.push(i(n)+"rotate("+t+a)}(r.rotate,o.rotate,s,l),function(e,t,n,r){e!==t?r.push({i:n.push(i(n)+"skewX(",null,a)-2,x:h(e,t)}):t&&n.push(i(n)+"skewX("+t+a)}(r.skewX,o.skewX,s,l),function(e,t,n,a,r,o){if(e!==n||t!==a){var s=r.push(i(r)+"scale(",null,",",null,")");o.push({i:s-4,x:h(e,n)},{i:s-2,x:h(t,a)})}else 1===n&&1===a||r.push(i(r)+"scale("+n+","+a+")")}(r.scaleX,r.scaleY,o.scaleX,o.scaleY,s,l),r=o=null,function(e){for(var t,n=-1,a=l.length;++n<a;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var M=I((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?w:T(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),C=I((function(e){return null==e?w:(O||(O=document.createElementNS("http://www.w3.org/2000/svg","g")),O.setAttribute("transform",e),(e=O.transform.baseVal.consolidate())?T((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):w)}),", ",")",")");function _(e){return((e=Math.exp(e))+1/e)/2}var D=function e(t,n,a){function i(e,i){var r,o,s=e[0],l=e[1],c=e[2],u=i[0],d=i[1],p=i[2],m=u-s,f=d-l,g=m*m+f*f;if(g<1e-12)o=Math.log(p/c)/t,r=function(e){return[s+e*m,l+e*f,c*Math.exp(t*e*o)]};else{var b=Math.sqrt(g),y=(p*p-c*c+a*g)/(2*c*n*b),h=(p*p-c*c-a*g)/(2*p*n*b),v=Math.log(Math.sqrt(y*y+1)-y),E=Math.log(Math.sqrt(h*h+1)-h);o=(E-v)/t,r=function(e){var a,i=e*o,r=_(v),u=c/(n*b)*(r*(a=t*i+v,((a=Math.exp(2*a))-1)/(a+1))-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+u*m,l+u*f,c*r/_(t*i+v)]}}return r.duration=1e3*o*t/Math.SQRT2,r}return i.rho=function(t){var n=Math.max(.001,+t),a=n*n;return e(n,a,a*a)},i}(Math.SQRT2,2,4);function A(e){return function(n,a){var i=e((n=t.hsl(n)).h,(a=t.hsl(a)).h),r=c(n.s,a.s),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=i(e),n.s=r(e),n.l=o(e),n.opacity=s(e),n+""}}}var F=A(s),N=A(c);function P(e){return function(n,a){var i=e((n=t.hcl(n)).h,(a=t.hcl(a)).h),r=c(n.c,a.c),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=i(e),n.c=r(e),n.l=o(e),n.opacity=s(e),n+""}}}var R=P(s),L=P(c);function z(e){return function n(a){function i(n,i){var r=e((n=t.cubehelix(n)).h,(i=t.cubehelix(i)).h),o=c(n.s,i.s),s=c(n.l,i.l),l=c(n.opacity,i.opacity);return function(e){return n.h=r(e),n.s=o(e),n.l=s(Math.pow(e,a)),n.opacity=l(e),n+""}}return a=+a,i.gamma=n,i}(1)}var q=z(s),B=z(c);e.interpolate=S,e.interpolateArray=function(e,t){return(g(t)?f:b)(e,t)},e.interpolateBasis=a,e.interpolateBasisClosed=i,e.interpolateCubehelix=q,e.interpolateCubehelixLong=B,e.interpolateDate=y,e.interpolateDiscrete=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},e.interpolateHcl=R,e.interpolateHclLong=L,e.interpolateHsl=F,e.interpolateHslLong=N,e.interpolateHue=function(e,t){var n=s(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,n){var a=c((e=t.lab(e)).l,(n=t.lab(n)).l),i=c(e.a,n.a),r=c(e.b,n.b),o=c(e.opacity,n.opacity);return function(t){return e.l=a(t),e.a=i(t),e.b=r(t),e.opacity=o(t),e+""}},e.interpolateNumber=h,e.interpolateNumberArray=f,e.interpolateObject=v,e.interpolateRgb=u,e.interpolateRgbBasis=p,e.interpolateRgbBasisClosed=m,e.interpolateRound=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}},e.interpolateString=j,e.interpolateTransformCss=M,e.interpolateTransformSvg=C,e.interpolateZoom=D,e.piecewise=function(e,t){void 0===t&&(t=e,e=S);for(var n=0,a=t.length-1,i=t[0],r=new Array(a<0?0:a);n<a;)r[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return r[t](e-t)}},e.quantize=function(e,t){for(var n=new Array(t),a=0;a<t;++a)n[a]=e(a/(t-1));return n},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1298))},function(e,t,n){!function(e){"use strict";function t(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function n(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function a(){}var i=.7,r=1/i,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),p=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),f=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),g=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),b={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function h(){return this.rgb().formatRgb()}function v(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?E(t):3===n?new O(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new O(t[1],t[2],t[3],1):(t=d.exec(e))?new O(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?x(t[1],t[2],t[3],t[4]):(t=m.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=f.exec(e))?I(t[1],t[2]/100,t[3]/100,1):(t=g.exec(e))?I(t[1],t[2]/100,t[3]/100,t[4]):b.hasOwnProperty(e)?E(b[e]):"transparent"===e?new O(NaN,NaN,NaN,0):null}function E(e){return new O(e>>16&255,e>>8&255,255&e,1)}function x(e,t,n,a){return a<=0&&(e=t=n=NaN),new O(e,t,n,a)}function j(e){return e instanceof a||(e=v(e)),e?new O((e=e.rgb()).r,e.g,e.b,e.opacity):new O}function S(e,t,n,a){return 1===arguments.length?j(e):new O(e,t,n,null==a?1:a)}function O(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function k(){return"#"+T(this.r)+T(this.g)+T(this.b)}function w(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function T(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function I(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _(e,t,n,a)}function M(e){if(e instanceof _)return new _(e.h,e.s,e.l,e.opacity);if(e instanceof a||(e=v(e)),!e)return new _;if(e instanceof _)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-r,c=(o+r)/2;return l?(s=t===o?(n-i)/l+6*(n<i):n===o?(i-t)/l+2:(t-n)/l+4,l/=c<.5?o+r:2-o-r,s*=60):l=c>0&&c<1?0:s,new _(s,l,c,e.opacity)}function C(e,t,n,a){return 1===arguments.length?M(e):new _(e,t,n,null==a?1:a)}function _(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function D(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t(a,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHsl:function(){return M(this).formatHsl()},formatRgb:h,toString:h}),t(O,S,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new O(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new O(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:k,formatHex:k,formatRgb:w,toString:w})),t(_,C,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new _(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new _(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,i=2*n-a;return new O(D(e>=240?e-240:e+120,i,a),D(e,i,a),D(e<120?e+240:e-120,i,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const A=Math.PI/180,F=180/Math.PI,N=.96422,P=1,R=.82521,L=4/29,z=6/29,q=3*z*z,B=z*z*z;function $(e){if(e instanceof U)return new U(e.l,e.a,e.b,e.opacity);if(e instanceof J)return Z(e);e instanceof O||(e=j(e));var t,n,a=Q(e.r),i=Q(e.g),r=Q(e.b),o=G((.2225045*a+.7168786*i+.0606169*r)/P);return a===i&&i===r?t=n=o:(t=G((.4360747*a+.3850649*i+.1430804*r)/N),n=G((.0139322*a+.0971045*i+.7141733*r)/R)),new U(116*o-16,500*(t-o),200*(o-n),e.opacity)}function V(e,t,n,a){return 1===arguments.length?$(e):new U(e,t,n,null==a?1:a)}function U(e,t,n,a){this.l=+e,this.a=+t,this.b=+n,this.opacity=+a}function G(e){return e>B?Math.pow(e,1/3):e/q+L}function H(e){return e>z?e*e*e:q*(e-L)}function W(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Q(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Y(e){if(e instanceof J)return new J(e.h,e.c,e.l,e.opacity);if(e instanceof U||(e=$(e)),0===e.a&&0===e.b)return new J(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*F;return new J(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function K(e,t,n,a){return 1===arguments.length?Y(e):new J(e,t,n,null==a?1:a)}function J(e,t,n,a){this.h=+e,this.c=+t,this.l=+n,this.opacity=+a}function Z(e){if(isNaN(e.h))return new U(e.l,0,0,e.opacity);var t=e.h*A;return new U(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(U,V,n(a,{brighter:function(e){return new U(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new U(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new O(W(3.1338561*(t=N*H(t))-1.6168667*(e=P*H(e))-.4906146*(n=R*H(n))),W(-.9787684*t+1.9161415*e+.033454*n),W(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),t(J,K,n(a,{brighter:function(e){return new J(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new J(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Z(this).rgb()}}));var X=-.14861,ee=1.78277,te=-.29227,ne=-.90649,ae=1.97294,ie=ae*ne,re=ae*ee,oe=ee*te-ne*X;function se(e,t,n,a){return 1===arguments.length?function(e){if(e instanceof le)return new le(e.h,e.s,e.l,e.opacity);e instanceof O||(e=j(e));var t=e.r/255,n=e.g/255,a=e.b/255,i=(oe*a+ie*t-re*n)/(oe+ie-re),r=a-i,o=(ae*(n-i)-te*r)/ne,s=Math.sqrt(o*o+r*r)/(ae*i*(1-i)),l=s?Math.atan2(o,r)*F-120:NaN;return new le(l<0?l+360:l,s,i,e.opacity)}(e):new le(e,t,n,null==a?1:a)}function le(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}t(le,se,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new le(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new le(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*A,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),a=Math.cos(e),i=Math.sin(e);return new O(255*(t+n*(X*a+ee*i)),255*(t+n*(te*a+ne*i)),255*(t+n*(ae*a)),this.opacity)}})),e.color=v,e.cubehelix=se,e.gray=function(e,t){return new U(e,0,0,null==t?1:t)},e.hcl=K,e.hsl=C,e.lab=V,e.lch=function(e,t,n,a){return 1===arguments.length?Y(e):new J(n,t,e,null==a?1:a)},e.rgb=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e){"use strict";function t(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function n(e){return(e=t(Math.abs(e)))?e[1]:NaN}var a,i=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(e){if(!(t=i.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function s(e,n){var a=t(e,n);if(!a)return e+"";var i=a[0],r=a[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}r.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>s(100*e,t),r:s,s:function(e,n){var i=t(e,n);if(!i)return e+"";var r=i[0],o=i[1],s=o-(a=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,n+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c(e){return e}var u,d=Array.prototype.map,p=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,i,o=void 0===e.grouping||void 0===e.thousands?c:(t=d.call(e.grouping,Number),i=e.thousands+"",function(e,n){for(var a=e.length,r=[],o=0,s=t[0],l=0;a>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),r.push(e.substring(a-=s,a+s)),!((l+=s+1)>n));)s=t[o=(o+1)%t.length];return r.reverse().join(i)}),s=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",m=void 0===e.decimal?".":e.decimal+"",f=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(d.call(e.numerals,String)),g=void 0===e.percent?"%":e.percent+"",b=void 0===e.minus?"−":e.minus+"",y=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=r(e)).fill,n=e.align,i=e.sign,c=e.symbol,d=e.zero,h=e.width,v=e.comma,E=e.precision,x=e.trim,j=e.type;"n"===j?(v=!0,j="g"):l[j]||(void 0===E&&(E=12),x=!0,j="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var S="$"===c?s:"#"===c&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",O="$"===c?u:/[%p]/.test(j)?g:"",k=l[j],w=/[defgprs%]/.test(j);function T(e){var r,s,l,c=S,u=O;if("c"===j)u=k(e)+u,e="";else{var g=(e=+e)<0||1/e<0;if(e=isNaN(e)?y:k(Math.abs(e),E),x&&(e=function(e){e:for(var t,n=e.length,a=1,i=-1;a<n;++a)switch(e[a]){case".":i=t=a;break;case"0":0===i&&(i=a),t=a;break;default:if(!+e[a])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),g&&0==+e&&"+"!==i&&(g=!1),c=(g?"("===i?i:b:"-"===i||"("===i?"":i)+c,u=("s"===j?p[8+a/3]:"")+u+(g&&"("===i?")":""),w)for(r=-1,s=e.length;++r<s;)if(48>(l=e.charCodeAt(r))||l>57){u=(46===l?m+e.slice(r+1):e.slice(r))+u,e=e.slice(0,r);break}}v&&!d&&(e=o(e,1/0));var T=c.length+e.length+u.length,I=T<h?new Array(h-T+1).join(t):"";switch(v&&d&&(e=o(I+e,I.length?h-u.length:1/0),I=""),n){case"<":e=c+e+u+I;break;case"=":e=c+I+e+u;break;case"^":e=I.slice(0,T=I.length>>1)+c+e+u+I.slice(T);break;default:e=I+c+e+u}return f(e)}return E=void 0===E?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E)),T.toString=function(){return e+""},T}return{format:h,formatPrefix:function(e,t){var a=h(((e=r(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(n(t)/3))),o=Math.pow(10,-i),s=p[8+i/3];return function(e){return a(o*e)+s}}}}function f(t){return u=m(t),e.format=u.format,e.formatPrefix=u.formatPrefix,u}f({thousands:",",grouping:[3],currency:["$",""]}),e.FormatSpecifier=o,e.formatDefaultLocale=f,e.formatLocale=m,e.formatSpecifier=r,e.precisionFixed=function(e){return Math.max(0,-n(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(n(t)/3)))-n(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,n(t)-n(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e,t){"use strict";function n(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function r(e){var r=e.dateTime,o=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,p=e.months,H=e.shortMonths,pe=m(c),Oe=f(c),ke=m(u),we=f(u),Te=m(d),Ie=f(d),Me=m(p),Ce=f(p),_e=m(H),De=f(H),Ae={a:function(e){return d[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return H[e.getMonth()]},B:function(e){return p[e.getMonth()]},c:null,d:N,e:N,f:q,g:J,G:X,H:P,I:R,j:L,L:z,m:B,M:$,p:function(e){return c[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:je,s:Se,S:V,u:U,U:G,V:W,w:Q,W:Y,x:null,X:null,y:K,Y:Z,Z:ee,"%":xe},Fe={a:function(e){return d[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return H[e.getUTCMonth()]},B:function(e){return p[e.getUTCMonth()]},c:null,d:te,e:te,f:oe,g:ye,G:ve,H:ne,I:ae,j:ie,L:re,m:se,M:le,p:function(e){return c[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:je,s:Se,S:ce,u:ue,U:de,V:me,w:fe,W:ge,x:null,X:null,y:be,Y:he,Z:Ee,"%":xe},Ne={a:function(e,t,n){var a=Te.exec(t.slice(n));return a?(e.w=Ie.get(a[0].toLowerCase()),n+a[0].length):-1},A:function(e,t,n){var a=ke.exec(t.slice(n));return a?(e.w=we.get(a[0].toLowerCase()),n+a[0].length):-1},b:function(e,t,n){var a=_e.exec(t.slice(n));return a?(e.m=De.get(a[0].toLowerCase()),n+a[0].length):-1},B:function(e,t,n){var a=Me.exec(t.slice(n));return a?(e.m=Ce.get(a[0].toLowerCase()),n+a[0].length):-1},c:function(e,t,n){return Le(e,r,t,n)},d:k,e:k,f:_,g:x,G:E,H:T,I:T,j:w,L:C,m:O,M:I,p:function(e,t,n){var a=pe.exec(t.slice(n));return a?(e.p=Oe.get(a[0].toLowerCase()),n+a[0].length):-1},q:S,Q:A,s:F,S:M,u:b,U:y,V:h,w:g,W:v,x:function(e,t,n){return Le(e,o,t,n)},X:function(e,t,n){return Le(e,l,t,n)},y:x,Y:E,Z:j,"%":D};function Pe(e,t){return function(n){var a,i,r,o=[],l=-1,c=0,u=e.length;for(n instanceof Date||(n=new Date(+n));++l<u;)37===e.charCodeAt(l)&&(o.push(e.slice(c,l)),null!=(i=s[a=e.charAt(++l)])?a=e.charAt(++l):i="e"===a?" ":"0",(r=t[a])&&(a=r(n,i)),o.push(a),c=l+1);return o.push(e.slice(c,l)),o.join("")}}function Re(e,r){return function(o){var s,l,c=i(1900,void 0,1);if(Le(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(r&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(s=a(i(c.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(c.V-1)),c.y=s.getUTCFullYear(),c.m=s.getUTCMonth(),c.d=s.getUTCDate()+(c.w+6)%7):(l=(s=n(i(c.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(c.V-1)),c.y=s.getFullYear(),c.m=s.getMonth(),c.d=s.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?a(i(c.y,0,1)).getUTCDay():n(i(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,a(c)):n(c)}}function Le(e,t,n,a){for(var i,r,o=0,l=t.length,c=n.length;o<l;){if(a>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(r=Ne[i in s?t.charAt(o++):i])||(a=r(e,n,a))<0)return-1}else if(i!=n.charCodeAt(a++))return-1}return a}return Ae.x=Pe(o,Ae),Ae.X=Pe(l,Ae),Ae.c=Pe(r,Ae),Fe.x=Pe(o,Fe),Fe.X=Pe(l,Fe),Fe.c=Pe(r,Fe),{format:function(e){var t=Pe(e+="",Ae);return t.toString=function(){return e},t},parse:function(e){var t=Re(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Pe(e+="",Fe);return t.toString=function(){return e},t},utcParse:function(e){var t=Re(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,n){var a=e<0?"-":"",i=(a?-e:e)+"",r=i.length;return a+(r<n?new Array(n-r+1).join(t)+i:i)}function p(e){return e.replace(u,"\\$&")}function m(e){return new RegExp("^(?:"+e.map(p).join("|")+")","i")}function f(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function g(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function b(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function y(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function h(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function v(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function E(e,t,n){var a=l.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function x(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function j(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function S(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.q=3*a[0]-3,n+a[0].length):-1}function O(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function k(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function w(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function T(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function I(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function M(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function C(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function _(e,t,n){var a=l.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function D(e,t,n){var a=c.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function A(e,t,n){var a=l.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function F(e,t,n){var a=l.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function N(e,t){return d(e.getDate(),t,2)}function P(e,t){return d(e.getHours(),t,2)}function R(e,t){return d(e.getHours()%12||12,t,2)}function L(e,n){return d(1+t.timeDay.count(t.timeYear(e),e),n,3)}function z(e,t){return d(e.getMilliseconds(),t,3)}function q(e,t){return z(e,t)+"000"}function B(e,t){return d(e.getMonth()+1,t,2)}function $(e,t){return d(e.getMinutes(),t,2)}function V(e,t){return d(e.getSeconds(),t,2)}function U(e){var t=e.getDay();return 0===t?7:t}function G(e,n){return d(t.timeSunday.count(t.timeYear(e)-1,e),n,2)}function H(e){var n=e.getDay();return n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e)}function W(e,n){return e=H(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),n,2)}function Q(e){return e.getDay()}function Y(e,n){return d(t.timeMonday.count(t.timeYear(e)-1,e),n,2)}function K(e,t){return d(e.getFullYear()%100,t,2)}function J(e,t){return d((e=H(e)).getFullYear()%100,t,2)}function Z(e,t){return d(e.getFullYear()%1e4,t,4)}function X(e,n){var a=e.getDay();return d((e=a>=4||0===a?t.timeThursday(e):t.timeThursday.ceil(e)).getFullYear()%1e4,n,4)}function ee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function te(e,t){return d(e.getUTCDate(),t,2)}function ne(e,t){return d(e.getUTCHours(),t,2)}function ae(e,t){return d(e.getUTCHours()%12||12,t,2)}function ie(e,n){return d(1+t.utcDay.count(t.utcYear(e),e),n,3)}function re(e,t){return d(e.getUTCMilliseconds(),t,3)}function oe(e,t){return re(e,t)+"000"}function se(e,t){return d(e.getUTCMonth()+1,t,2)}function le(e,t){return d(e.getUTCMinutes(),t,2)}function ce(e,t){return d(e.getUTCSeconds(),t,2)}function ue(e){var t=e.getUTCDay();return 0===t?7:t}function de(e,n){return d(t.utcSunday.count(t.utcYear(e)-1,e),n,2)}function pe(e){var n=e.getUTCDay();return n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e)}function me(e,n){return e=pe(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),n,2)}function fe(e){return e.getUTCDay()}function ge(e,n){return d(t.utcMonday.count(t.utcYear(e)-1,e),n,2)}function be(e,t){return d(e.getUTCFullYear()%100,t,2)}function ye(e,t){return d((e=pe(e)).getUTCFullYear()%100,t,2)}function he(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function ve(e,n){var a=e.getUTCDay();return d((e=a>=4||0===a?t.utcThursday(e):t.utcThursday.ceil(e)).getUTCFullYear()%1e4,n,4)}function Ee(){return"+0000"}function xe(){return"%"}function je(e){return+e}function Se(e){return Math.floor(+e/1e3)}function Oe(t){return o=r(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}Oe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ke="%Y-%m-%dT%H:%M:%S.%LZ";var we=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(ke);var Te=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(ke);e.isoFormat=we,e.isoParse=Te,e.timeFormatDefaultLocale=Oe,e.timeFormatLocale=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(834))},function(e,t,n){"use strict";var a=n(1302),i=n(1303).remove,r={},o={},s={},l={},c={};function u(e){return String("000"+(e||"")).slice(-3)}function d(e){return s[e]}function p(e){return o[e]}function m(e){var t=u(e);return p(l[t])}function f(e){var t=u(e);return l[t]}function g(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return f(e);if(2===e.length)return e.toUpperCase();if(3===e.length)return d(e.toUpperCase())}if("number"==typeof e)return f(e)}a.forEach((function(e){var t=e;o[t[0]]=t[1],s[t[1]]=t[0],l[t[2]]=t[0],c[t[0]]=t[2]})),t.registerLocale=function(e){if(!e.locale)throw new TypeError("Missing localeData.locale");if(!e.countries)throw new TypeError("Missing localeData.countries");r[e.locale]=e.countries},t.alpha3ToAlpha2=d,t.alpha2ToAlpha3=p,t.alpha3ToNumeric=function(e){return c[d(e)]},t.alpha2ToNumeric=function(e){return c[e]},t.numericToAlpha3=m,t.numericToAlpha2=f,t.toAlpha3=function(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return m(e);if(2===e.length)return p(e.toUpperCase());if(3===e.length)return e.toUpperCase()}if("number"==typeof e)return m(e)},t.toAlpha2=g,t.getName=function(e,t){try{return r[t.toLowerCase()][g(e)]}catch(e){return}},t.getNames=function(e){var t=r[e.toLowerCase()];return void 0===t?{}:t},t.getAlpha2Code=function(e,t){try{var n,a=r[t.toLowerCase()];for(n in a)if(a.hasOwnProperty(n)&&a[n].toLowerCase()===e.toLowerCase())return n;return}catch(e){return}},t.getSimpleAlpha2Code=function(e,t){try{var n,a=r[t.toLowerCase()];for(n in a)if(a.hasOwnProperty(n)&&i(a[n].toLowerCase())===i(e.toLowerCase()))return n;return}catch(e){return}},t.getAlpha2Codes=function(){return o},t.getAlpha3Code=function(e,t){var n=this.getAlpha2Code(e,t);return n?this.toAlpha3(n):void 0},t.getSimpleAlpha3Code=function(e,t){var n=this.getSimpleAlpha2Code(e,t);return n?this.toAlpha3(n):void 0},t.getAlpha3Codes=function(){return s},t.getNumericCodes=function(){return l},t.langs=function(){return Object.keys(r)},t.isValid=function(e){if(!e)return!1;var t=e.toString().toUpperCase();return s.hasOwnProperty(t)||o.hasOwnProperty(t)||l.hasOwnProperty(t)}},function(e){e.exports=JSON.parse('[["AF","AFG","004","ISO 3166-2:AF"],["AX","ALA","248","ISO 3166-2:AX"],["AL","ALB","008","ISO 3166-2:AL"],["DZ","DZA","012","ISO 3166-2:DZ"],["AS","ASM","016","ISO 3166-2:AS"],["AD","AND","020","ISO 3166-2:AD"],["AO","AGO","024","ISO 3166-2:AO"],["AI","AIA","660","ISO 3166-2:AI"],["AQ","ATA","010","ISO 3166-2:AQ"],["AG","ATG","028","ISO 3166-2:AG"],["AR","ARG","032","ISO 3166-2:AR"],["AM","ARM","051","ISO 3166-2:AM"],["AW","ABW","533","ISO 3166-2:AW"],["AU","AUS","036","ISO 3166-2:AU"],["AT","AUT","040","ISO 3166-2:AT"],["AZ","AZE","031","ISO 3166-2:AZ"],["BS","BHS","044","ISO 3166-2:BS"],["BH","BHR","048","ISO 3166-2:BH"],["BD","BGD","050","ISO 3166-2:BD"],["BB","BRB","052","ISO 3166-2:BB"],["BY","BLR","112","ISO 3166-2:BY"],["BE","BEL","056","ISO 3166-2:BE"],["BZ","BLZ","084","ISO 3166-2:BZ"],["BJ","BEN","204","ISO 3166-2:BJ"],["BM","BMU","060","ISO 3166-2:BM"],["BT","BTN","064","ISO 3166-2:BT"],["BO","BOL","068","ISO 3166-2:BO"],["BQ","BES","535","ISO 3166-2:BQ"],["BA","BIH","070","ISO 3166-2:BA"],["BW","BWA","072","ISO 3166-2:BW"],["BV","BVT","074","ISO 3166-2:BV"],["BR","BRA","076","ISO 3166-2:BR"],["IO","IOT","086","ISO 3166-2:IO"],["BN","BRN","096","ISO 3166-2:BN"],["BG","BGR","100","ISO 3166-2:BG"],["BF","BFA","854","ISO 3166-2:BF"],["BI","BDI","108","ISO 3166-2:BI"],["KH","KHM","116","ISO 3166-2:KH"],["CM","CMR","120","ISO 3166-2:CM"],["CA","CAN","124","ISO 3166-2:CA"],["CV","CPV","132","ISO 3166-2:CV"],["KY","CYM","136","ISO 3166-2:KY"],["CF","CAF","140","ISO 3166-2:CF"],["TD","TCD","148","ISO 3166-2:TD"],["CL","CHL","152","ISO 3166-2:CL"],["CN","CHN","156","ISO 3166-2:CN"],["CX","CXR","162","ISO 3166-2:CX"],["CC","CCK","166","ISO 3166-2:CC"],["CO","COL","170","ISO 3166-2:CO"],["KM","COM","174","ISO 3166-2:KM"],["CG","COG","178","ISO 3166-2:CG"],["CD","COD","180","ISO 3166-2:CD"],["CK","COK","184","ISO 3166-2:CK"],["CR","CRI","188","ISO 3166-2:CR"],["CI","CIV","384","ISO 3166-2:CI"],["HR","HRV","191","ISO 3166-2:HR"],["CU","CUB","192","ISO 3166-2:CU"],["CW","CUW","531","ISO 3166-2:CW"],["CY","CYP","196","ISO 3166-2:CY"],["CZ","CZE","203","ISO 3166-2:CZ"],["DK","DNK","208","ISO 3166-2:DK"],["DJ","DJI","262","ISO 3166-2:DJ"],["DM","DMA","212","ISO 3166-2:DM"],["DO","DOM","214","ISO 3166-2:DO"],["EC","ECU","218","ISO 3166-2:EC"],["EG","EGY","818","ISO 3166-2:EG"],["SV","SLV","222","ISO 3166-2:SV"],["GQ","GNQ","226","ISO 3166-2:GQ"],["ER","ERI","232","ISO 3166-2:ER"],["EE","EST","233","ISO 3166-2:EE"],["ET","ETH","231","ISO 3166-2:ET"],["FK","FLK","238","ISO 3166-2:FK"],["FO","FRO","234","ISO 3166-2:FO"],["FJ","FJI","242","ISO 3166-2:FJ"],["FI","FIN","246","ISO 3166-2:FI"],["FR","FRA","250","ISO 3166-2:FR"],["GF","GUF","254","ISO 3166-2:GF"],["PF","PYF","258","ISO 3166-2:PF"],["TF","ATF","260","ISO 3166-2:TF"],["GA","GAB","266","ISO 3166-2:GA"],["GM","GMB","270","ISO 3166-2:GM"],["GE","GEO","268","ISO 3166-2:GE"],["DE","DEU","276","ISO 3166-2:DE"],["GH","GHA","288","ISO 3166-2:GH"],["GI","GIB","292","ISO 3166-2:GI"],["GR","GRC","300","ISO 3166-2:GR"],["GL","GRL","304","ISO 3166-2:GL"],["GD","GRD","308","ISO 3166-2:GD"],["GP","GLP","312","ISO 3166-2:GP"],["GU","GUM","316","ISO 3166-2:GU"],["GT","GTM","320","ISO 3166-2:GT"],["GG","GGY","831","ISO 3166-2:GG"],["GN","GIN","324","ISO 3166-2:GN"],["GW","GNB","624","ISO 3166-2:GW"],["GY","GUY","328","ISO 3166-2:GY"],["HT","HTI","332","ISO 3166-2:HT"],["HM","HMD","334","ISO 3166-2:HM"],["VA","VAT","336","ISO 3166-2:VA"],["HN","HND","340","ISO 3166-2:HN"],["HK","HKG","344","ISO 3166-2:HK"],["HU","HUN","348","ISO 3166-2:HU"],["IS","ISL","352","ISO 3166-2:IS"],["IN","IND","356","ISO 3166-2:IN"],["ID","IDN","360","ISO 3166-2:ID"],["IR","IRN","364","ISO 3166-2:IR"],["IQ","IRQ","368","ISO 3166-2:IQ"],["IE","IRL","372","ISO 3166-2:IE"],["IM","IMN","833","ISO 3166-2:IM"],["IL","ISR","376","ISO 3166-2:IL"],["IT","ITA","380","ISO 3166-2:IT"],["JM","JAM","388","ISO 3166-2:JM"],["JP","JPN","392","ISO 3166-2:JP"],["JE","JEY","832","ISO 3166-2:JE"],["JO","JOR","400","ISO 3166-2:JO"],["KZ","KAZ","398","ISO 3166-2:KZ"],["KE","KEN","404","ISO 3166-2:KE"],["KI","KIR","296","ISO 3166-2:KI"],["KP","PRK","408","ISO 3166-2:KP"],["KR","KOR","410","ISO 3166-2:KR"],["KW","KWT","414","ISO 3166-2:KW"],["KG","KGZ","417","ISO 3166-2:KG"],["LA","LAO","418","ISO 3166-2:LA"],["LV","LVA","428","ISO 3166-2:LV"],["LB","LBN","422","ISO 3166-2:LB"],["LS","LSO","426","ISO 3166-2:LS"],["LR","LBR","430","ISO 3166-2:LR"],["LY","LBY","434","ISO 3166-2:LY"],["LI","LIE","438","ISO 3166-2:LI"],["LT","LTU","440","ISO 3166-2:LT"],["LU","LUX","442","ISO 3166-2:LU"],["MO","MAC","446","ISO 3166-2:MO"],["MK","MKD","807","ISO 3166-2:MK"],["MG","MDG","450","ISO 3166-2:MG"],["MW","MWI","454","ISO 3166-2:MW"],["MY","MYS","458","ISO 3166-2:MY"],["MV","MDV","462","ISO 3166-2:MV"],["ML","MLI","466","ISO 3166-2:ML"],["MT","MLT","470","ISO 3166-2:MT"],["MH","MHL","584","ISO 3166-2:MH"],["MQ","MTQ","474","ISO 3166-2:MQ"],["MR","MRT","478","ISO 3166-2:MR"],["MU","MUS","480","ISO 3166-2:MU"],["YT","MYT","175","ISO 3166-2:YT"],["MX","MEX","484","ISO 3166-2:MX"],["FM","FSM","583","ISO 3166-2:FM"],["MD","MDA","498","ISO 3166-2:MD"],["MC","MCO","492","ISO 3166-2:MC"],["MN","MNG","496","ISO 3166-2:MN"],["ME","MNE","499","ISO 3166-2:ME"],["MS","MSR","500","ISO 3166-2:MS"],["MA","MAR","504","ISO 3166-2:MA"],["MZ","MOZ","508","ISO 3166-2:MZ"],["MM","MMR","104","ISO 3166-2:MM"],["NA","NAM","516","ISO 3166-2:NA"],["NR","NRU","520","ISO 3166-2:NR"],["NP","NPL","524","ISO 3166-2:NP"],["NL","NLD","528","ISO 3166-2:NL"],["NC","NCL","540","ISO 3166-2:NC"],["NZ","NZL","554","ISO 3166-2:NZ"],["NI","NIC","558","ISO 3166-2:NI"],["NE","NER","562","ISO 3166-2:NE"],["NG","NGA","566","ISO 3166-2:NG"],["NU","NIU","570","ISO 3166-2:NU"],["NF","NFK","574","ISO 3166-2:NF"],["MP","MNP","580","ISO 3166-2:MP"],["NO","NOR","578","ISO 3166-2:NO"],["OM","OMN","512","ISO 3166-2:OM"],["PK","PAK","586","ISO 3166-2:PK"],["PW","PLW","585","ISO 3166-2:PW"],["PS","PSE","275","ISO 3166-2:PS"],["PA","PAN","591","ISO 3166-2:PA"],["PG","PNG","598","ISO 3166-2:PG"],["PY","PRY","600","ISO 3166-2:PY"],["PE","PER","604","ISO 3166-2:PE"],["PH","PHL","608","ISO 3166-2:PH"],["PN","PCN","612","ISO 3166-2:PN"],["PL","POL","616","ISO 3166-2:PL"],["PT","PRT","620","ISO 3166-2:PT"],["PR","PRI","630","ISO 3166-2:PR"],["QA","QAT","634","ISO 3166-2:QA"],["RE","REU","638","ISO 3166-2:RE"],["RO","ROU","642","ISO 3166-2:RO"],["RU","RUS","643","ISO 3166-2:RU"],["RW","RWA","646","ISO 3166-2:RW"],["BL","BLM","652","ISO 3166-2:BL"],["SH","SHN","654","ISO 3166-2:SH"],["KN","KNA","659","ISO 3166-2:KN"],["LC","LCA","662","ISO 3166-2:LC"],["MF","MAF","663","ISO 3166-2:MF"],["PM","SPM","666","ISO 3166-2:PM"],["VC","VCT","670","ISO 3166-2:VC"],["WS","WSM","882","ISO 3166-2:WS"],["SM","SMR","674","ISO 3166-2:SM"],["ST","STP","678","ISO 3166-2:ST"],["SA","SAU","682","ISO 3166-2:SA"],["SN","SEN","686","ISO 3166-2:SN"],["RS","SRB","688","ISO 3166-2:RS"],["SC","SYC","690","ISO 3166-2:SC"],["SL","SLE","694","ISO 3166-2:SL"],["SG","SGP","702","ISO 3166-2:SG"],["SX","SXM","534","ISO 3166-2:SX"],["SK","SVK","703","ISO 3166-2:SK"],["SI","SVN","705","ISO 3166-2:SI"],["SB","SLB","090","ISO 3166-2:SB"],["SO","SOM","706","ISO 3166-2:SO"],["ZA","ZAF","710","ISO 3166-2:ZA"],["GS","SGS","239","ISO 3166-2:GS"],["SS","SSD","728","ISO 3166-2:SS"],["ES","ESP","724","ISO 3166-2:ES"],["LK","LKA","144","ISO 3166-2:LK"],["SD","SDN","729","ISO 3166-2:SD"],["SR","SUR","740","ISO 3166-2:SR"],["SJ","SJM","744","ISO 3166-2:SJ"],["SZ","SWZ","748","ISO 3166-2:SZ"],["SE","SWE","752","ISO 3166-2:SE"],["CH","CHE","756","ISO 3166-2:CH"],["SY","SYR","760","ISO 3166-2:SY"],["TW","TWN","158","ISO 3166-2:TW"],["TJ","TJK","762","ISO 3166-2:TJ"],["TZ","TZA","834","ISO 3166-2:TZ"],["TH","THA","764","ISO 3166-2:TH"],["TL","TLS","626","ISO 3166-2:TL"],["TG","TGO","768","ISO 3166-2:TG"],["TK","TKL","772","ISO 3166-2:TK"],["TO","TON","776","ISO 3166-2:TO"],["TT","TTO","780","ISO 3166-2:TT"],["TN","TUN","788","ISO 3166-2:TN"],["TR","TUR","792","ISO 3166-2:TR"],["TM","TKM","795","ISO 3166-2:TM"],["TC","TCA","796","ISO 3166-2:TC"],["TV","TUV","798","ISO 3166-2:TV"],["UG","UGA","800","ISO 3166-2:UG"],["UA","UKR","804","ISO 3166-2:UA"],["AE","ARE","784","ISO 3166-2:AE"],["GB","GBR","826","ISO 3166-2:GB"],["US","USA","840","ISO 3166-2:US"],["UM","UMI","581","ISO 3166-2:UM"],["UY","URY","858","ISO 3166-2:UY"],["UZ","UZB","860","ISO 3166-2:UZ"],["VU","VUT","548","ISO 3166-2:VU"],["VE","VEN","862","ISO 3166-2:VE"],["VN","VNM","704","ISO 3166-2:VN"],["VG","VGB","092","ISO 3166-2:VG"],["VI","VIR","850","ISO 3166-2:VI"],["WF","WLF","876","ISO 3166-2:WF"],["EH","ESH","732","ISO 3166-2:EH"],["YE","YEM","887","ISO 3166-2:YE"],["ZM","ZMB","894","ISO 3166-2:ZM"],["ZW","ZWE","716","ISO 3166-2:ZW"],["XK","XKX","","ISO 3166-2:XK"]]')},function(e,t){t.remove=function(e){return e.replace(/[^\u0000-\u007e]/g,(function(e){return a[e]||e}))};for(var n=[{base:" ",chars:" "},{base:"0",chars:"߀"},{base:"A",chars:"ⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",chars:"Ꜳ"},{base:"AE",chars:"ÆǼǢ"},{base:"AO",chars:"Ꜵ"},{base:"AU",chars:"Ꜷ"},{base:"AV",chars:"ꜸꜺ"},{base:"AY",chars:"Ꜽ"},{base:"B",chars:"ⒷＢḂḄḆɃƁ"},{base:"C",chars:"ⒸＣꜾḈĆCĈĊČÇƇȻ"},{base:"D",chars:"ⒹＤḊĎḌḐḒḎĐƊƉᴅꝹ"},{base:"Dh",chars:"Ð"},{base:"DZ",chars:"ǱǄ"},{base:"Dz",chars:"ǲǅ"},{base:"E",chars:"ɛⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎᴇ"},{base:"F",chars:"ꝼⒻＦḞƑꝻ"},{base:"G",chars:"ⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾɢ"},{base:"H",chars:"ⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",chars:"ⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",chars:"ⒿＪĴɈȷ"},{base:"K",chars:"ⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",chars:"ⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",chars:"Ǉ"},{base:"Lj",chars:"ǈ"},{base:"M",chars:"ⓂＭḾṀṂⱮƜϻ"},{base:"N",chars:"ꞤȠⓃＮǸŃÑṄŇṆŅṊṈƝꞐᴎ"},{base:"NJ",chars:"Ǌ"},{base:"Nj",chars:"ǋ"},{base:"O",chars:"ⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OE",chars:"Œ"},{base:"OI",chars:"Ƣ"},{base:"OO",chars:"Ꝏ"},{base:"OU",chars:"Ȣ"},{base:"P",chars:"ⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",chars:"ⓆＱꝖꝘɊ"},{base:"R",chars:"ⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",chars:"ⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",chars:"ⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"Th",chars:"Þ"},{base:"TZ",chars:"Ꜩ"},{base:"U",chars:"ⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",chars:"ⓋＶṼṾƲꝞɅ"},{base:"VY",chars:"Ꝡ"},{base:"W",chars:"ⓌＷẀẂŴẆẄẈⱲ"},{base:"X",chars:"ⓍＸẊẌ"},{base:"Y",chars:"ⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",chars:"ⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",chars:"ⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑ"},{base:"aa",chars:"ꜳ"},{base:"ae",chars:"æǽǣ"},{base:"ao",chars:"ꜵ"},{base:"au",chars:"ꜷ"},{base:"av",chars:"ꜹꜻ"},{base:"ay",chars:"ꜽ"},{base:"b",chars:"ⓑｂḃḅḇƀƃɓƂ"},{base:"c",chars:"ｃⓒćĉċčçḉƈȼꜿↄ"},{base:"d",chars:"ⓓｄḋďḍḑḓḏđƌɖɗƋᏧԁꞪ"},{base:"dh",chars:"ð"},{base:"dz",chars:"ǳǆ"},{base:"e",chars:"ⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇǝ"},{base:"f",chars:"ⓕｆḟƒ"},{base:"ff",chars:"ﬀ"},{base:"fi",chars:"ﬁ"},{base:"fl",chars:"ﬂ"},{base:"ffi",chars:"ﬃ"},{base:"ffl",chars:"ﬄ"},{base:"g",chars:"ⓖｇǵĝḡğġǧģǥɠꞡꝿᵹ"},{base:"h",chars:"ⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",chars:"ƕ"},{base:"i",chars:"ⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",chars:"ⓙｊĵǰɉ"},{base:"k",chars:"ⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",chars:"ⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇɭ"},{base:"lj",chars:"ǉ"},{base:"m",chars:"ⓜｍḿṁṃɱɯ"},{base:"n",chars:"ⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥлԉ"},{base:"nj",chars:"ǌ"},{base:"o",chars:"ⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿꝋꝍɵɔᴑ"},{base:"oe",chars:"œ"},{base:"oi",chars:"ƣ"},{base:"oo",chars:"ꝏ"},{base:"ou",chars:"ȣ"},{base:"p",chars:"ⓟｐṕṗƥᵽꝑꝓꝕρ"},{base:"q",chars:"ⓠｑɋꝗꝙ"},{base:"r",chars:"ⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",chars:"ⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛʂ"},{base:"ss",chars:"ß"},{base:"t",chars:"ⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"th",chars:"þ"},{base:"tz",chars:"ꜩ"},{base:"u",chars:"ⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",chars:"ⓥｖṽṿʋꝟʌ"},{base:"vy",chars:"ꝡ"},{base:"w",chars:"ⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",chars:"ⓧｘẋẍ"},{base:"y",chars:"ⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",chars:"ⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],a={},i=0;i<n.length;i+=1)for(var r=n[i].chars,o=0;o<r.length;o+=1)a[r[o]]=n[i].base;t.replacementList=n,t.diacriticsMap=a},function(e){e.exports=JSON.parse('{"locale":"en","countries":{"AF":"Afghanistan","AL":"Albania","DZ":"Algeria","AS":"American Samoa","AD":"Andorra","AO":"Angola","AI":"Anguilla","AQ":"Antarctica","AG":"Antigua and Barbuda","AR":"Argentina","AM":"Armenia","AW":"Aruba","AU":"Australia","AT":"Austria","AZ":"Azerbaijan","BS":"Bahamas","BH":"Bahrain","BD":"Bangladesh","BB":"Barbados","BY":"Belarus","BE":"Belgium","BZ":"Belize","BJ":"Benin","BM":"Bermuda","BT":"Bhutan","BO":"Bolivia","BA":"Bosnia and Herzegovina","BW":"Botswana","BV":"Bouvet Island","BR":"Brazil","IO":"British Indian Ocean Territory","BN":"Brunei Darussalam","BG":"Bulgaria","BF":"Burkina Faso","BI":"Burundi","KH":"Cambodia","CM":"Cameroon","CA":"Canada","CV":"Cape Verde","KY":"Cayman Islands","CF":"Central African Republic","TD":"Chad","CL":"Chile","CN":"China","CX":"Christmas Island","CC":"Cocos (Keeling) Islands","CO":"Colombia","KM":"Comoros","CG":"Congo","CD":"Congo, the Democratic Republic of the","CK":"Cook Islands","CR":"Costa Rica","CI":"Cote D\'Ivoire","HR":"Croatia","CU":"Cuba","CY":"Cyprus","CZ":"Czech Republic","DK":"Denmark","DJ":"Djibouti","DM":"Dominica","DO":"Dominican Republic","EC":"Ecuador","EG":"Egypt","SV":"El Salvador","GQ":"Equatorial Guinea","ER":"Eritrea","EE":"Estonia","ET":"Ethiopia","FK":"Falkland Islands (Malvinas)","FO":"Faroe Islands","FJ":"Fiji","FI":"Finland","FR":"France","GF":"French Guiana","PF":"French Polynesia","TF":"French Southern Territories","GA":"Gabon","GM":"Gambia","GE":"Georgia","DE":"Germany","GH":"Ghana","GI":"Gibraltar","GR":"Greece","GL":"Greenland","GD":"Grenada","GP":"Guadeloupe","GU":"Guam","GT":"Guatemala","GN":"Guinea","GW":"Guinea-Bissau","GY":"Guyana","HT":"Haiti","HM":"Heard Island and Mcdonald Islands","VA":"Holy See (Vatican City State)","HN":"Honduras","HK":"Hong Kong","HU":"Hungary","IS":"Iceland","IN":"India","ID":"Indonesia","IR":"Iran, Islamic Republic of","IQ":"Iraq","IE":"Ireland","IL":"Israel","IT":"Italy","JM":"Jamaica","JP":"Japan","JO":"Jordan","KZ":"Kazakhstan","KE":"Kenya","KI":"Kiribati","KP":"North Korea","KR":"South Korea","KW":"Kuwait","KG":"Kyrgyzstan","LA":"Lao People\'s Democratic Republic","LV":"Latvia","LB":"Lebanon","LS":"Lesotho","LR":"Liberia","LY":"Libya","LI":"Liechtenstein","LT":"Lithuania","LU":"Luxembourg","MO":"Macao","MG":"Madagascar","MW":"Malawi","MY":"Malaysia","MV":"Maldives","ML":"Mali","MT":"Malta","MH":"Marshall Islands","MQ":"Martinique","MR":"Mauritania","MU":"Mauritius","YT":"Mayotte","MX":"Mexico","FM":"Micronesia, Federated States of","MD":"Moldova, Republic of","MC":"Monaco","MN":"Mongolia","MS":"Montserrat","MA":"Morocco","MZ":"Mozambique","MM":"Myanmar","NA":"Namibia","NR":"Nauru","NP":"Nepal","NL":"Netherlands","NC":"New Caledonia","NZ":"New Zealand","NI":"Nicaragua","NE":"Niger","NG":"Nigeria","NU":"Niue","NF":"Norfolk Island","MK":"North Macedonia, Republic of","MP":"Northern Mariana Islands","NO":"Norway","OM":"Oman","PK":"Pakistan","PW":"Palau","PS":"Palestinian Territory, Occupied","PA":"Panama","PG":"Papua New Guinea","PY":"Paraguay","PE":"Peru","PH":"Philippines","PN":"Pitcairn","PL":"Poland","PT":"Portugal","PR":"Puerto Rico","QA":"Qatar","RE":"Reunion","RO":"Romania","RU":"Russian Federation","RW":"Rwanda","SH":"Saint Helena","KN":"Saint Kitts and Nevis","LC":"Saint Lucia","PM":"Saint Pierre and Miquelon","VC":"Saint Vincent and the Grenadines","WS":"Samoa","SM":"San Marino","ST":"Sao Tome and Principe","SA":"Saudi Arabia","SN":"Senegal","SC":"Seychelles","SL":"Sierra Leone","SG":"Singapore","SK":"Slovakia","SI":"Slovenia","SB":"Solomon Islands","SO":"Somalia","ZA":"South Africa","GS":"South Georgia and the South Sandwich Islands","ES":"Spain","LK":"Sri Lanka","SD":"Sudan","SR":"Suriname","SJ":"Svalbard and Jan Mayen","SZ":"Swaziland","SE":"Sweden","CH":"Switzerland","SY":"Syrian Arab Republic","TW":"Taiwan","TJ":"Tajikistan","TZ":"Tanzania, United Republic of","TH":"Thailand","TL":"Timor-Leste","TG":"Togo","TK":"Tokelau","TO":"Tonga","TT":"Trinidad and Tobago","TN":"Tunisia","TR":"Turkey","TM":"Turkmenistan","TC":"Turks and Caicos Islands","TV":"Tuvalu","UG":"Uganda","UA":"Ukraine","AE":"United Arab Emirates","GB":"United Kingdom","US":"United States of America","UM":"United States Minor Outlying Islands","UY":"Uruguay","UZ":"Uzbekistan","VU":"Vanuatu","VE":"Venezuela","VN":"Viet Nam","VG":"Virgin Islands, British","VI":"Virgin Islands, U.S.","WF":"Wallis and Futuna","EH":"Western Sahara","YE":"Yemen","ZM":"Zambia","ZW":"Zimbabwe","AX":"Åland Islands","BQ":"Bonaire, Sint Eustatius and Saba","CW":"Curaçao","GG":"Guernsey","IM":"Isle of Man","JE":"Jersey","ME":"Montenegro","BL":"Saint Barthélemy","MF":"Saint Martin (French part)","RS":"Serbia","SX":"Sint Maarten (Dutch part)","SS":"South Sudan","XK":"Kosovo"}}')},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showOnlyThreatIndicatorAlerts",{defaultMessage:"Show only threat indicator alerts"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(66),r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)},l={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},c={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},u={width:"20px",height:"20px",position:"absolute"},d={top:s(s({},l),{top:"-5px"}),right:s(s({},c),{left:void 0,right:"-5px"}),bottom:s(s({},l),{top:void 0,bottom:"-5px"}),left:s(s({},c),{left:"-5px"}),topRight:s(s({},u),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:s(s({},u),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:s(s({},u),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:s(s({},u),{left:"-10px",top:"-10px",cursor:"nw-resize"})},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return o(t,e),t.prototype.render=function(){return a.createElement("div",{className:this.props.className||"",style:s(s({position:"absolute",userSelect:"none"},d[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(a.PureComponent),m={width:"auto",height:"auto"},f=function(e,t,n){return Math.max(Math.min(e,n),t)},g=function(e,t){return Math.round(e/t)*t},b=function(e,t){return new RegExp(e,"i").test(t)},y=function(e){return Boolean(e.touches&&e.touches.length)},h=function(e,t,n){void 0===n&&(n=0);var a=t.reduce((function(n,a,i){return Math.abs(a-e)<Math.abs(t[n]-e)?i:n}),0),i=Math.abs(t[a]-e);return 0===n||i<n?t[a]:e},v=function(e){return"auto"===(e=e.toString())||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},E=function(e,t,n,a){if(e&&"string"==typeof e){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%"))return t*(Number(e.replace("%",""))/100);if(e.endsWith("vw"))return n*(Number(e.replace("vw",""))/100);if(e.endsWith("vh"))return a*(Number(e.replace("vh",""))/100)}return e},x=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],j="__resizable_base__",S=function(e){function t(t){var n=e.call(this,t)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableRight=0,n.resizableTop=0,n.resizableBottom=0,n.targetLeft=0,n.targetTop=0,n.appendBase=function(){if(!n.resizable||!n.window)return null;var e=n.parentNode;if(!e)return null;var t=n.window.document.createElement("div");return t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0 0 100%",t.classList?t.classList.add(j):t.className+=j,e.appendChild(t),t},n.removeBase=function(e){var t=n.parentNode;t&&t.removeChild(e)},n.ref=function(e){e&&(n.resizable=e)},n.state={isResizing:!1,width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return o(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||m},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,a=this.resizable.offsetHeight,i=this.resizable.style.position;"relative"!==i&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:a,this.resizable.style.position=i}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&e.propsSize[t].toString().endsWith("%")){if(e.state[t].toString().endsWith("%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return v(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?v(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?v(t.height):n("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,n=this.parentNode.style.flexWrap;"wrap"!==n&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var a={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=n),this.removeBase(e),a},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){var n,a,i=this.props.boundsByDirection,r=this.state.direction,o=i&&b("left",r),s=i&&b("top",r);if("parent"===this.props.bounds){var l=this.parentNode;l&&(n=o?this.resizableRight-this.parentLeft:l.offsetWidth+(this.parentLeft-this.resizableLeft),a=s?this.resizableBottom-this.parentTop:l.offsetHeight+(this.parentTop-this.resizableTop))}else"window"===this.props.bounds?this.window&&(n=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,a=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(n=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),a=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return n&&Number.isFinite(n)&&(e=e&&e<n?e:n),a&&Number.isFinite(a)&&(t=t&&t<a?t:a),{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,a=this.props.resizeRatio||1,i=this.state,r=i.direction,o=i.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=o.width,p=o.height,m=c||0,f=u||0;return b("right",r)&&(d=o.width+(e-o.x)*a/n,l&&(p=(d-f)/this.ratio+m)),b("left",r)&&(d=o.width-(e-o.x)*a/n,l&&(p=(d-f)/this.ratio+m)),b("bottom",r)&&(p=o.height+(t-o.y)*a/n,l&&(d=(p-m)*this.ratio+f)),b("top",r)&&(p=o.height-(t-o.y)*a/n,l&&(d=(p-m)*this.ratio+f)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,a){var i=this.props,r=i.lockAspectRatio,o=i.lockAspectRatioExtraHeight,s=i.lockAspectRatioExtraWidth,l=void 0===a.width?10:a.width,c=void 0===n.width||n.width<0?e:n.width,u=void 0===a.height?10:a.height,d=void 0===n.height||n.height<0?t:n.height,p=o||0,m=s||0;if(r){var g=(u-p)*this.ratio+m,b=(d-p)*this.ratio+m,y=(l-m)/this.ratio+p,h=(c-m)/this.ratio+p,v=Math.max(l,g),E=Math.min(c,b),x=Math.max(u,y),j=Math.min(d,h);e=f(e,v,E),t=f(t,x,j)}else e=f(e,l,c),t=f(t,u,d);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var a=this.resizable.getBoundingClientRect(),i=a.left,r=a.top,o=a.right,s=a.bottom;this.resizableLeft=i,this.resizableRight=o,this.resizableTop=r,this.resizableBottom=s}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var n,a=0,i=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)?(a=e.nativeEvent.clientX,i=e.nativeEvent.clientY):e.nativeEvent&&y(e.nativeEvent)&&(a=e.nativeEvent.touches[0].clientX,i=e.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var r=this.window.getComputedStyle(this.resizable);if("auto"!==r.flexBasis){var o=this.parentNode;if(o){var l=this.window.getComputedStyle(o).flexDirection;this.flexDir=l.startsWith("row")?"row":"column",n=r.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var c={original:{x:a,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:n};this.setState(c)}},t.prototype.onMouseMove=function(e){var t=this;if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&y(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var n=this.props,a=n.maxWidth,r=n.maxHeight,o=n.minWidth,s=n.minHeight,l=y(e)?e.touches[0].clientX:e.clientX,c=y(e)?e.touches[0].clientY:e.clientY,u=this.state,d=u.direction,p=u.original,m=u.width,f=u.height,b=this.getParentSize(),v=function(e,t,n,a,i,r,o){return a=E(a,e.width,t,n),i=E(i,e.height,t,n),r=E(r,e.width,t,n),o=E(o,e.height,t,n),{maxWidth:void 0===a?void 0:Number(a),maxHeight:void 0===i?void 0:Number(i),minWidth:void 0===r?void 0:Number(r),minHeight:void 0===o?void 0:Number(o)}}(b,this.window.innerWidth,this.window.innerHeight,a,r,o,s);a=v.maxWidth,r=v.maxHeight,o=v.minWidth,s=v.minHeight;var x=this.calculateNewSizeFromDirection(l,c),j=x.newHeight,S=x.newWidth,O=this.calculateNewMaxFromBoundary(a,r);this.props.snap&&this.props.snap.x&&(S=h(S,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(j=h(j,this.props.snap.y,this.props.snapGap));var k=this.calculateNewSizeFromAspectRatio(S,j,{width:O.maxWidth,height:O.maxHeight},{width:o,height:s});if(S=k.newWidth,j=k.newHeight,this.props.grid){var w=g(S,this.props.grid[0]),T=g(j,this.props.grid[1]),I=this.props.snapGap||0;S=0===I||Math.abs(w-S)<=I?w:S,j=0===I||Math.abs(T-j)<=I?T:j}var M={width:S-p.width,height:j-p.height};m&&"string"==typeof m&&(m.endsWith("%")?S=S/b.width*100+"%":m.endsWith("vw")?S=S/this.window.innerWidth*100+"vw":m.endsWith("vh")&&(S=S/this.window.innerHeight*100+"vh")),f&&"string"==typeof f&&(f.endsWith("%")?j=j/b.height*100+"%":f.endsWith("vw")?j=j/this.window.innerWidth*100+"vw":f.endsWith("vh")&&(j=j/this.window.innerHeight*100+"vh"));var C={width:this.createSizeForCssProperty(S,"width"),height:this.createSizeForCssProperty(j,"height")};"row"===this.flexDir?C.flexBasis=C.width:"column"===this.flexDir&&(C.flexBasis=C.height),i.flushSync((function(){t.setState(C)})),this.props.onResize&&this.props.onResize(e,d,this.resizable,M)}},t.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,a=t.direction,i=t.original;if(n&&this.resizable){var r={width:this.size.width-i.width,height:this.size.height-i.height};this.props.onResizeStop&&this.props.onResizeStop(e,a,this.resizable,r),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,n=t.enable,i=t.handleStyles,r=t.handleClasses,o=t.handleWrapperStyle,s=t.handleWrapperClass,l=t.handleComponent;if(!n)return null;var c=Object.keys(n).map((function(t){return!1!==n[t]?a.createElement(p,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:i&&i[t],className:r&&r[t]},l&&l[t]?l[t]:null):null}));return a.createElement("div",{className:s,style:o},c)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,n){return-1!==x.indexOf(n)||(t[n]=e.props[n]),t}),{}),n=s(s(s({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return a.createElement(i,s({ref:this.ref,style:n,className:this.props.className},t),this.state.isResizing&&a.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(a.PureComponent);t.Resizable=S},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2);const i=e=>JSON.stringify(e),r=({pageIndex:e,pageSize:t})=>{const[n,r]=Object(a.useState)({}),o=Object(a.useCallback)((a=>{r({...n,[i({pageIndex:e+1,pageSize:t})]:a})}),[e,t]);let s;for(let a=e;a>=0&&(s=n[i({pageIndex:a,pageSize:t})],!s);a--);return[s,o]}},function(e,t,n){"use strict";e.exports=n(1309)},function(e,t,n){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1310)),r=a(n(1373)),o=a(n(1311)),s=n(2),l=a(n(719)),c=a(n(1312)),u=a(n(1372)),d=a(n(1375)),p=a(n(1313));function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function f(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function g(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t.indexOf(n=r[a])>=0||(i[n]=e[n]);return i}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var y=s.createContext(void 0);y.displayName="FormikContext";var h=y.Provider,v=y.Consumer;function E(){var e=s.useContext(y);return e||c(!1),e}var x=function(e){return Array.isArray(e)&&0===e.length},j=function(e){return"function"==typeof e},S=function(e){return null!==e&&"object"==typeof e},O=function(e){return String(Math.floor(Number(e)))===e},k=function(e){return"[object String]"===Object.prototype.toString.call(e)},w=function(e){return 0===s.Children.count(e)},T=function(e){return S(e)&&j(e.then)};function I(e,t,n,a){void 0===a&&(a=0);for(var i=d(t);e&&a<i.length;)e=e[i[a++]];return a===i.length||e?void 0===e?n:e:n}function M(e,t,n){for(var a=u(e),i=a,r=0,o=d(t);r<o.length-1;r++){var s=o[r],l=I(e,o.slice(0,r+1));if(l&&(S(l)||Array.isArray(l)))i=i[s]=u(l);else{var c=o[r+1];i=i[s]=O(c)&&Number(c)>=0?[]:{}}}return(0===r?e:i)[o[r]]===n?e:(void 0===n?delete i[o[r]]:i[o[r]]=n,0===r&&void 0===n&&delete a[o[r]],a)}function C(e,t,n,a){void 0===n&&(n=new WeakMap),void 0===a&&(a={});for(var i=0,r=Object.keys(e);i<r.length;i++){var o=r[i],s=e[o];S(s)?n.get(s)||(n.set(s,!0),a[o]=Array.isArray(s)?[]:{},C(s,t,n,a[o])):a[o]=t}return a}var _={},D={};function A(e){var t=e.validateOnChange,n=void 0===t||t,a=e.validateOnBlur,r=void 0===a||a,c=e.validateOnMount,u=void 0!==c&&c,d=e.isInitialValid,p=e.enableReinitialize,f=void 0!==p&&p,b=e.onSubmit,y=g(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),h=m({validateOnChange:n,validateOnBlur:r,validateOnMount:u,onSubmit:b},y),v=s.useRef(h.initialValues),E=s.useRef(h.initialErrors||_),x=s.useRef(h.initialTouched||D),O=s.useRef(h.initialStatus),w=s.useRef(!1),A=s.useRef({});s.useEffect((function(){return w.current=!0,function(){w.current=!1}}),[]);var F=s.useState(0)[1],R=s.useRef({values:o(h.initialValues),errors:o(h.initialErrors)||_,touched:o(h.initialTouched)||D,status:o(h.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),z=R.current,B=s.useCallback((function(e){var t=R.current;R.current=function(e,t){switch(t.type){case"SET_VALUES":return m({},e,{values:t.payload});case"SET_TOUCHED":return m({},e,{touched:t.payload});case"SET_ERRORS":return l(e.errors,t.payload)?e:m({},e,{errors:t.payload});case"SET_STATUS":return m({},e,{status:t.payload});case"SET_ISSUBMITTING":return m({},e,{isSubmitting:t.payload});case"SET_ISVALIDATING":return m({},e,{isValidating:t.payload});case"SET_FIELD_VALUE":return m({},e,{values:M(e.values,t.payload.field,t.payload.value)});case"SET_FIELD_TOUCHED":return m({},e,{touched:M(e.touched,t.payload.field,t.payload.value)});case"SET_FIELD_ERROR":return m({},e,{errors:M(e.errors,t.payload.field,t.payload.value)});case"RESET_FORM":return m({},e,t.payload);case"SET_FORMIK_STATE":return t.payload(e);case"SUBMIT_ATTEMPT":return m({},e,{touched:C(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":case"SUBMIT_SUCCESS":return m({},e,{isSubmitting:!1});default:return e}}(t,e),t!==R.current&&F((function(e){return e+1}))}),[]),$=s.useCallback((function(e,t){return new Promise((function(n,a){var i=h.validate(e,t);null==i?n(_):T(i)?i.then((function(e){n(e||_)}),(function(e){a(e)})):n(i)}))}),[h.validate]),V=s.useCallback((function(e,t){var n=h.validationSchema,a=j(n)?n(t):n,i=t&&a.validateAt?a.validateAt(t,e):P(e,a);return new Promise((function(e,t){i.then((function(){e(_)}),(function(n){"ValidationError"===n.name?e(N(n)):t(n)}))}))}),[h.validationSchema]),U=s.useCallback((function(e,t){return new Promise((function(n){return n(A.current[e].validate(t))}))}),[]),G=s.useCallback((function(e){var t=Object.keys(A.current).filter((function(e){return j(A.current[e].validate)})),n=t.length>0?t.map((function(t){return U(t,I(e,t))})):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(n).then((function(e){return e.reduce((function(e,n,a){return"DO_NOT_DELETE_YOU_WILL_BE_FIRED"===n||n&&(e=M(e,t[a],n)),e}),{})}))}),[U]),H=s.useCallback((function(e){return Promise.all([G(e),h.validationSchema?V(e):{},h.validate?$(e):{}]).then((function(e){return i.all([e[0],e[1],e[2]],{arrayMerge:L})}))}),[h.validate,h.validationSchema,G,$,V]),W=q((function(e){return void 0===e&&(e=z.values),B({type:"SET_ISVALIDATING",payload:!0}),H(e).then((function(e){return w.current&&(B({type:"SET_ISVALIDATING",payload:!1}),B({type:"SET_ERRORS",payload:e})),e}))}));s.useEffect((function(){u&&!0===w.current&&l(v.current,h.initialValues)&&W(v.current)}),[u,W]);var Q=s.useCallback((function(e){var t=e&&e.values?e.values:v.current,n=e&&e.errors?e.errors:E.current?E.current:h.initialErrors||{},a=e&&e.touched?e.touched:x.current?x.current:h.initialTouched||{},i=e&&e.status?e.status:O.current?O.current:h.initialStatus;v.current=t,E.current=n,x.current=a,O.current=i;var r=function(){B({type:"RESET_FORM",payload:{isSubmitting:!!e&&!!e.isSubmitting,errors:n,touched:a,status:i,values:t,isValidating:!!e&&!!e.isValidating,submitCount:e&&e.submitCount&&"number"==typeof e.submitCount?e.submitCount:0}})};if(h.onReset){var o=h.onReset(z.values,me);T(o)?o.then(r):r()}else r()}),[h.initialErrors,h.initialStatus,h.initialTouched,h.onReset]);s.useEffect((function(){!0!==w.current||l(v.current,h.initialValues)||f&&(v.current=h.initialValues,Q(),u&&W(v.current))}),[f,h.initialValues,Q,u,W]),s.useEffect((function(){f&&!0===w.current&&!l(E.current,h.initialErrors)&&(E.current=h.initialErrors||_,B({type:"SET_ERRORS",payload:h.initialErrors||_}))}),[f,h.initialErrors]),s.useEffect((function(){f&&!0===w.current&&!l(x.current,h.initialTouched)&&(x.current=h.initialTouched||D,B({type:"SET_TOUCHED",payload:h.initialTouched||D}))}),[f,h.initialTouched]),s.useEffect((function(){f&&!0===w.current&&!l(O.current,h.initialStatus)&&(O.current=h.initialStatus,B({type:"SET_STATUS",payload:h.initialStatus}))}),[f,h.initialStatus,h.initialTouched]);var Y=q((function(e){if(A.current[e]&&j(A.current[e].validate)){var t=I(z.values,e),n=A.current[e].validate(t);return T(n)?(B({type:"SET_ISVALIDATING",payload:!0}),n.then((function(e){return e})).then((function(t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:t}}),B({type:"SET_ISVALIDATING",payload:!1})}))):(B({type:"SET_FIELD_ERROR",payload:{field:e,value:n}}),Promise.resolve(n))}return h.validationSchema?(B({type:"SET_ISVALIDATING",payload:!0}),V(z.values,e).then((function(e){return e})).then((function(t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:I(t,e)}}),B({type:"SET_ISVALIDATING",payload:!1})}))):Promise.resolve()})),K=s.useCallback((function(e,t){A.current[e]={validate:t.validate}}),[]),J=s.useCallback((function(e){delete A.current[e]}),[]),Z=q((function(e,t){return B({type:"SET_TOUCHED",payload:e}),(void 0===t?r:t)?W(z.values):Promise.resolve()})),X=s.useCallback((function(e){B({type:"SET_ERRORS",payload:e})}),[]),ee=q((function(e,t){var a=j(e)?e(z.values):e;return B({type:"SET_VALUES",payload:a}),(void 0===t?n:t)?W(a):Promise.resolve()})),te=s.useCallback((function(e,t){B({type:"SET_FIELD_ERROR",payload:{field:e,value:t}})}),[]),ne=q((function(e,t,a){return B({type:"SET_FIELD_VALUE",payload:{field:e,value:t}}),(void 0===a?n:a)?W(M(z.values,e,t)):Promise.resolve()})),ae=s.useCallback((function(e,t){var n,a=t,i=e;if(!k(e)){e.persist&&e.persist();var r=e.target?e.target:e.currentTarget,o=r.type,s=r.value,l=r.checked,c=r.options,u=r.multiple;a=t||r.name||r.id,i=/number|range/.test(o)?(n=parseFloat(s),isNaN(n)?"":n):/checkbox/.test(o)?function(e,t,n){if("boolean"==typeof e)return Boolean(t);var a=[],i=!1,r=-1;if(Array.isArray(e))a=e,i=(r=e.indexOf(n))>=0;else if(!n||"true"==n||"false"==n)return Boolean(t);return t&&n&&!i?a.concat(n):i?a.slice(0,r).concat(a.slice(r+1)):a}(I(z.values,a),l,s):c&&u?function(e){return Array.from(e).filter((function(e){return e.selected})).map((function(e){return e.value}))}(c):s}a&&ne(a,i)}),[ne,z.values]),ie=q((function(e){if(k(e))return function(t){return ae(t,e)};ae(e)})),re=q((function(e,t,n){return void 0===t&&(t=!0),B({type:"SET_FIELD_TOUCHED",payload:{field:e,value:t}}),(void 0===n?r:n)?W(z.values):Promise.resolve()})),oe=s.useCallback((function(e,t){e.persist&&e.persist();var n=e.target;re(t||n.name||n.id,!0)}),[re]),se=q((function(e){if(k(e))return function(t){return oe(t,e)};oe(e)})),le=s.useCallback((function(e){j(e)?B({type:"SET_FORMIK_STATE",payload:e}):B({type:"SET_FORMIK_STATE",payload:function(){return e}})}),[]),ce=s.useCallback((function(e){B({type:"SET_STATUS",payload:e})}),[]),ue=s.useCallback((function(e){B({type:"SET_ISSUBMITTING",payload:e})}),[]),de=q((function(){return B({type:"SUBMIT_ATTEMPT"}),W().then((function(e){var t=e instanceof Error;if(!t&&0===Object.keys(e).length){var n;try{if(void 0===(n=fe()))return}catch(e){throw e}return Promise.resolve(n).then((function(e){return w.current&&B({type:"SUBMIT_SUCCESS"}),e})).catch((function(e){if(w.current)throw B({type:"SUBMIT_FAILURE"}),e}))}if(w.current&&(B({type:"SUBMIT_FAILURE"}),t))throw e}))})),pe=q((function(e){e&&e.preventDefault&&j(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&j(e.stopPropagation)&&e.stopPropagation(),de().catch((function(e){console.warn("Warning: An unhandled error was caught from submitForm()",e)}))})),me={resetForm:Q,validateForm:W,validateField:Y,setErrors:X,setFieldError:te,setFieldTouched:re,setFieldValue:ne,setStatus:ce,setSubmitting:ue,setTouched:Z,setValues:ee,setFormikState:le,submitForm:de},fe=q((function(){return b(z.values,me)})),ge=q((function(e){e&&e.preventDefault&&j(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&j(e.stopPropagation)&&e.stopPropagation(),Q()})),be=s.useCallback((function(e){return{value:I(z.values,e),error:I(z.errors,e),touched:!!I(z.touched,e),initialValue:I(v.current,e),initialTouched:!!I(x.current,e),initialError:I(E.current,e)}}),[z.errors,z.touched,z.values]),ye=s.useCallback((function(e){return{setValue:function(t,n){return ne(e,t,n)},setTouched:function(t,n){return re(e,t,n)},setError:function(t){return te(e,t)}}}),[ne,re,te]),he=s.useCallback((function(e){var t=S(e),n=t?e.name:e,a=I(z.values,n),i={name:n,value:a,onChange:ie,onBlur:se};if(t){var r=e.type,o=e.value,s=e.as,l=e.multiple;"checkbox"===r?void 0===o?i.checked=!!a:(i.checked=!(!Array.isArray(a)||!~a.indexOf(o)),i.value=o):"radio"===r?(i.checked=a===o,i.value=o):"select"===s&&l&&(i.value=i.value||[],i.multiple=!0)}return i}),[se,ie,z.values]),ve=s.useMemo((function(){return!l(v.current,z.values)}),[v.current,z.values]),Ee=s.useMemo((function(){return void 0!==d?ve?z.errors&&0===Object.keys(z.errors).length:!1!==d&&j(d)?d(h):d:z.errors&&0===Object.keys(z.errors).length}),[d,ve,z.errors,h]);return m({},z,{initialValues:v.current,initialErrors:E.current,initialTouched:x.current,initialStatus:O.current,handleBlur:se,handleChange:ie,handleReset:ge,handleSubmit:pe,resetForm:Q,setErrors:X,setFormikState:le,setFieldTouched:re,setFieldValue:ne,setFieldError:te,setStatus:ce,setSubmitting:ue,setTouched:Z,setValues:ee,submitForm:de,validateForm:W,validateField:Y,isValid:Ee,dirty:ve,unregisterField:J,registerField:K,getFieldProps:he,getFieldMeta:be,getFieldHelpers:ye,validateOnBlur:r,validateOnChange:n,validateOnMount:u})}function F(e){var t=A(e),n=e.component,a=e.children,i=e.render;return s.useImperativeHandle(e.innerRef,(function(){return t})),s.createElement(h,{value:t},n?s.createElement(n,t):i?i(t):a?j(a)?a(t):w(a)?null:s.Children.only(a):null)}function N(e){var t={};if(e.inner){if(0===e.inner.length)return M(t,e.path,e.message);var n=e.inner,a=Array.isArray(n),i=0;for(n=a?n:n[Symbol.iterator]();;){var r;if(a){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var o=r;I(t,o.path)||(t=M(t,o.path,o.message))}}return t}function P(e,t,n,a){void 0===n&&(n=!1);var i=R(e);return t[n?"validateSync":"validate"](i,{abortEarly:!1,context:a||i})}function R(e){var t=Array.isArray(e)?[]:{};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=String(n);t[a]=!0===Array.isArray(e[a])?e[a].map((function(e){return!0===Array.isArray(e)||r(e)?R(e):""!==e?e:void 0})):r(e[a])?R(e[a]):""!==e[a]?e[a]:void 0}return t}function L(e,t,n){var a=e.slice();return t.forEach((function(t,r){if(void 0===a[r]){var o=!1!==n.clone&&n.isMergeableObject(t);a[r]=o?i(Array.isArray(t)?[]:{},t,n):t}else n.isMergeableObject(t)?a[r]=i(e[r],t,n):-1===e.indexOf(t)&&a.push(t)})),a}var z="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?s.useLayoutEffect:s.useEffect;function q(e){var t=s.useRef(e);return z((function(){t.current=e})),s.useCallback((function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.current.apply(void 0,n)}),[])}var B=s.forwardRef((function(e,t){var n=e.action,a=g(e,["action"]),i=null!=n?n:"#",r=E();return s.createElement("form",m({onSubmit:r.handleSubmit,ref:t,onReset:r.handleReset,action:i},a))}));function $(e){var t=function(t){return s.createElement(v,null,(function(n){return n||c(!1),s.createElement(e,m({},t,{formik:n}))}))},n=e.displayName||e.name||e.constructor&&e.constructor.name||"Component";return t.WrappedComponent=e,t.displayName="FormikConnect("+n+")",p(t,e)}B.displayName="Form";var V=function(e,t,n){var a=W(e),i=a[t];return a.splice(t,1),a.splice(n,0,i),a},U=function(e,t,n){var a=W(e),i=a[t];return a[t]=a[n],a[n]=i,a},G=function(e,t,n){var a=W(e);return a.splice(t,0,n),a},H=function(e,t,n){var a=W(e);return a[t]=n,a},W=function(e){if(e){if(Array.isArray(e))return[].concat(e);var t=Object.keys(e).map((function(e){return parseInt(e)})).reduce((function(e,t){return t>e?t:e}),0);return Array.from(m({},e,{length:t+1}))}return[]},Q=function(e,t){var n="function"==typeof e?e:t;return function(e){if(Array.isArray(e)||S(e)){var t=W(e);return n(t)}return e}},Y=function(e){function t(t){var n;return(n=e.call(this,t)||this).updateArrayField=function(e,t,a){var i=n.props,r=i.name;(0,i.formik.setFormikState)((function(n){var i=Q(a,e),o=Q(t,e),s=M(n.values,r,e(I(n.values,r))),l=a?i(I(n.errors,r)):void 0,c=t?o(I(n.touched,r)):void 0;return x(l)&&(l=void 0),x(c)&&(c=void 0),m({},n,{values:s,errors:a?M(n.errors,r,l):n.errors,touched:t?M(n.touched,r,c):n.touched})}))},n.push=function(e){return n.updateArrayField((function(t){return[].concat(W(t),[o(e)])}),!1,!1)},n.handlePush=function(e){return function(){return n.push(e)}},n.swap=function(e,t){return n.updateArrayField((function(n){return U(n,e,t)}),!0,!0)},n.handleSwap=function(e,t){return function(){return n.swap(e,t)}},n.move=function(e,t){return n.updateArrayField((function(n){return V(n,e,t)}),!0,!0)},n.handleMove=function(e,t){return function(){return n.move(e,t)}},n.insert=function(e,t){return n.updateArrayField((function(n){return G(n,e,t)}),(function(t){return G(t,e,null)}),(function(t){return G(t,e,null)}))},n.handleInsert=function(e,t){return function(){return n.insert(e,t)}},n.replace=function(e,t){return n.updateArrayField((function(n){return H(n,e,t)}),!1,!1)},n.handleReplace=function(e,t){return function(){return n.replace(e,t)}},n.unshift=function(e){var t=-1;return n.updateArrayField((function(n){var a=n?[e].concat(n):[e];return t=a.length,a}),(function(e){return e?[null].concat(e):[null]}),(function(e){return e?[null].concat(e):[null]})),t},n.handleUnshift=function(e){return function(){return n.unshift(e)}},n.handleRemove=function(e){return function(){return n.remove(e)}},n.handlePop=function(){return function(){return n.pop()}},n.remove=n.remove.bind(b(n)),n.pop=n.pop.bind(b(n)),n}f(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.props.validateOnChange&&this.props.formik.validateOnChange&&!l(I(e.formik.values,e.name),I(this.props.formik.values,this.props.name))&&this.props.formik.validateForm(this.props.formik.values)},n.remove=function(e){var t;return this.updateArrayField((function(n){var a=n?W(n):[];return t||(t=a[e]),j(a.splice)&&a.splice(e,1),j(a.every)&&a.every((function(e){return void 0===e}))?[]:a}),!0,!0),t},n.pop=function(){var e;return this.updateArrayField((function(t){var n=t.slice();return e||(e=n&&n.pop&&n.pop()),n}),!0,!0),e},n.render=function(){var e=this.props,t=e.component,n=e.render,a=e.children,i=e.name,r=m({},{push:this.push,pop:this.pop,swap:this.swap,move:this.move,insert:this.insert,replace:this.replace,unshift:this.unshift,remove:this.remove,handlePush:this.handlePush,handlePop:this.handlePop,handleSwap:this.handleSwap,handleMove:this.handleMove,handleInsert:this.handleInsert,handleReplace:this.handleReplace,handleUnshift:this.handleUnshift,handleRemove:this.handleRemove},{form:g(e.formik,["validate","validationSchema"]),name:i});return t?s.createElement(t,r):n?n(r):a?"function"==typeof a?a(r):w(a)?null:s.Children.only(a):null},t}(s.Component);Y.defaultProps={validateOnChange:!0};var K=$(Y),J=$(function(e){function t(){return e.apply(this,arguments)||this}f(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return I(this.props.formik.errors,this.props.name)!==I(e.formik.errors,this.props.name)||I(this.props.formik.touched,this.props.name)!==I(e.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(e).length},n.render=function(){var e=this.props,t=e.component,n=e.formik,a=e.render,i=e.children,r=e.name,o=g(e,["component","formik","render","children","name"]),l=I(n.touched,r),c=I(n.errors,r);return l&&c?a?j(a)?a(c):null:i?j(i)?i(c):null:t?s.createElement(t,o,c):c:null},t}(s.Component)),Z=$(function(e){function t(t){var n;n=e.call(this,t)||this;var a=t.render,i=t.children,r=t.component,o=t.as;return a&&c(!1),r&&a&&c(!1),o&&i&&j(i)&&c(!1),r&&i&&j(i)&&c(!1),a&&i&&!w(i)&&c(!1),n}f(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return this.props.shouldUpdate?this.props.shouldUpdate(e,this.props):e.name!==this.props.name||I(e.formik.values,this.props.name)!==I(this.props.formik.values,this.props.name)||I(e.formik.errors,this.props.name)!==I(this.props.formik.errors,this.props.name)||I(e.formik.touched,this.props.name)!==I(this.props.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(e).length||e.formik.isSubmitting!==this.props.formik.isSubmitting},n.componentDidMount=function(){this.props.formik.registerField(this.props.name,{validate:this.props.validate})},n.componentDidUpdate=function(e){this.props.name!==e.name&&(this.props.formik.unregisterField(e.name),this.props.formik.registerField(this.props.name,{validate:this.props.validate})),this.props.validate!==e.validate&&this.props.formik.registerField(this.props.name,{validate:this.props.validate})},n.componentWillUnmount=function(){this.props.formik.unregisterField(this.props.name)},n.render=function(){var e=this.props,t=e.name,n=e.render,a=e.as,i=e.children,r=e.component,o=e.formik,l=g(e,["validate","name","render","as","children","component","shouldUpdate","formik"]),c=g(o,["validate","validationSchema"]),u=o.getFieldProps(m({name:t},l)),d={field:u,meta:{value:I(o.values,t),error:I(o.errors,t),touched:!!I(o.touched,t),initialValue:I(o.initialValues,t),initialTouched:!!I(o.initialTouched,t),initialError:I(o.initialErrors,t)},form:c};if(n)return n(d);if(j(i))return i(d);if(r){if("string"==typeof r){var p=l.innerRef,f=g(l,["innerRef"]);return s.createElement(r,m({ref:p},u,f),i)}return s.createElement(r,m({field:u,form:o},l),i)}var b=a||"input";if("string"==typeof b){var y=l.innerRef,h=g(l,["innerRef"]);return s.createElement(b,m({ref:y},u,h),i)}return s.createElement(b,m({},u,l),i)},t}(s.Component));t.ErrorMessage=J,t.FastField=Z,t.Field=function(e){var t=e.validate,n=e.name,a=e.render,i=e.children,r=e.as,o=e.component,l=e.className,c=g(e,["validate","name","render","children","as","component","className"]),u=g(E(),["validate","validationSchema"]),d=u.registerField,p=u.unregisterField;s.useEffect((function(){return d(n,{validate:t}),function(){p(n)}}),[d,p,n,t]);var f=u.getFieldProps(m({name:n},c)),b=u.getFieldMeta(n),y={field:f,form:u};if(a)return a(m({},y,{meta:b}));if(j(i))return i(m({},y,{meta:b}));if(o){if("string"==typeof o){var h=c.innerRef,v=g(c,["innerRef"]);return s.createElement(o,m({ref:h},f,v,{className:l}),i)}return s.createElement(o,m({field:f,form:u},c,{className:l}),i)}var x=r||"input";if("string"==typeof x){var S=c.innerRef,O=g(c,["innerRef"]);return s.createElement(x,m({ref:S},f,O,{className:l}),i)}return s.createElement(x,m({},f,c,{className:l}),i)},t.FieldArray=K,t.Form=B,t.Formik=F,t.FormikConsumer=v,t.FormikContext=y,t.FormikProvider=h,t.connect=$,t.getActiveElement=function(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}},t.getIn=I,t.insert=G,t.isEmptyArray=x,t.isEmptyChildren=w,t.isFunction=j,t.isInputEvent=function(e){return e&&S(e)&&S(e.target)},t.isInteger=O,t.isNaN=function(e){return e!=e},t.isObject=S,t.isPromise=T,t.isString=k,t.move=V,t.prepareDataForValidation=R,t.replace=H,t.setIn=M,t.setNestedObjectValues=C,t.swap=U,t.useField=function(e){var t=E(),n=t.getFieldProps,a=t.getFieldMeta,i=t.getFieldHelpers,r=t.registerField,o=t.unregisterField,l=S(e)?e:{name:e},u=l.name,d=l.validate;s.useEffect((function(){return u&&r(u,{validate:d}),function(){u&&o(u)}}),[r,o,u,d]),u||c(!1);var p=s.useMemo((function(){return i(u)}),[i,u]);return[n(l),a(u),p]},t.useFormik=A,t.useFormikContext=E,t.validateYupSchema=P,t.withFormik=function(e){var t=e.mapPropsToValues,n=void 0===t?function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&"function"!=typeof e[n]&&(t[n]=e[n]);return t}:t,a=g(e,["mapPropsToValues"]);return function(e){var t=e.displayName||e.name||e.constructor&&e.constructor.name||"Component",i=function(t){function i(){for(var n,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(n=t.call.apply(t,[this].concat(r))||this).validate=function(e){return a.validate(e,n.props)},n.validationSchema=function(){return j(a.validationSchema)?a.validationSchema(n.props):a.validationSchema},n.handleSubmit=function(e,t){return a.handleSubmit(e,m({},t,{props:n.props}))},n.renderFormComponent=function(t){return s.createElement(e,m({},n.props,t))},n}return f(i,t),i.prototype.render=function(){var e=g(this.props,["children"]);return s.createElement(F,m({},e,a,{validate:a.validate&&this.validate,validationSchema:a.validationSchema&&this.validationSchema,initialValues:n(this.props),initialStatus:a.mapPropsToStatus&&a.mapPropsToStatus(this.props),initialErrors:a.mapPropsToErrors&&a.mapPropsToErrors(this.props),initialTouched:a.mapPropsToTouched&&a.mapPropsToTouched(this.props),onSubmit:this.handleSubmit,children:this.renderFormComponent}))},i}(s.Component);return i.displayName="WithFormik("+t+")",p(i,e)}},t.yupToFormErrors=N},function(e,t,n){e.exports=function(){"use strict";var e=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var n=Object.prototype.toString.call(e);return"[object RegExp]"===n||"[object Date]"===n||function(e){return e.$$typeof===t}(e)}(e)};var t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?i((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function a(e,t,a){return e.concat(t).map((function(e){return n(e,a)}))}function i(t,r,o){(o=o||{}).arrayMerge=o.arrayMerge||a,o.isMergeableObject=o.isMergeableObject||e;var s=Array.isArray(r);return s===Array.isArray(t)?s?o.arrayMerge(t,r,o):function(e,t,a){var r={};return a.isMergeableObject(e)&&Object.keys(e).forEach((function(t){r[t]=n(e[t],a)})),Object.keys(t).forEach((function(o){a.isMergeableObject(t[o])&&e[o]?r[o]=i(e[o],t[o],a):r[o]=n(t[o],a)})),r}(t,r,o):n(r,o)}return i.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return i(e,n,t)}),{})},i}()},function(e,t,n){var a=n(1338);e.exports=function(e){return a(e,5)}},function(e,t,n){"use strict";e.exports=function(e,t){}},function(e,t,n){e.exports=n(35)(231)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.ERROR="error",e.EMPTY="empty",e.EMPTY_SEARCH="empty_search",e.LOADING="loading",e.SEARCHING="searching",e.DELETING="deleting",e}({})},function(e,t,n){e.exports=n.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(2),i=n(48),r=n(45),o=n(168),s=n(182),l=n(265),c=n(1409),u=n(5);function d(e){return Object(r.useSelector)((t=>e(t[s.v][s.w])))}function p(e){const t=d(c.c),n=Object(i.useHistory)(),r=d(c.k),{state:s}=Object(i.useLocation)(),u=Object(a.useCallback)((n=>e===o.n?Object(l.k)(r,{...t,...n}):e===o.f?Object(l.l)(r,{...t,...n}):e===o.c?Object(l.i)(r,{...t,...n}):Object(l.m)(r,{...t,...n})),[e,t,r]);return Object(a.useCallback)((e=>n.push(u(e),s)),[u,n,s])}const m=()=>window.location.pathname.includes(u.kc)&&window.location.pathname.includes("/settings")},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return ni})),n.d(t,"c",(function(){return ai})),n.d(t,"b",(function(){return ii})),n.d(t,"d",(function(){return ri}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(1397),c=n(1216),u=n(43),d=n(7);const p="previewSection";var m=n(4);const f=m.i18n.translate("expandableFlyout.previewSection.backButton",{defaultMessage:"Back"}),g=m.i18n.translate("expandableFlyout.previewSection.closeButton",{defaultMessage:"Close"}),b=e=>Object(d.has)(e,"title")||Object(d.has)(e,"backgroundColor")||Object(d.has)(e,"textColor"),y=({component:e,leftPosition:t,banner:n})=>{const{euiTheme:a}=Object(s.useEuiTheme)(),{closePreviewPanel:i,previousPreviewPanel:r}=Object(c.a)(),o=t+4,l=Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonIcon,{iconType:"cross",onClick:()=>i(),"data-test-subj":"previewSectionCloseButton","aria-label":g})),d=Object(u.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",iconSide:"left",onClick:()=>r(),"data-test-subj":"previewSectionBackButton","aria-label":f},f)),l);return Object(u.jsx)("div",{css:Object(u.css)("position:absolute;top:8px;bottom:8px;right:4px;left:",o,"px;z-index:1000;","")},Object(u.jsx)(s.EuiSplitPanel.Outer,{css:Object(u.css)("margin:",a.size.xs,";box-shadow:0 0 16px 0px ",Object(s.transparentize)(a.colors.mediumShade,.5),";",""),"data-test-subj":p,className:"eui-fullHeight"},b(n)&&Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,color:n.backgroundColor,paddingSize:"xs","data-test-subj":`${p}BannerPanel`},Object(u.jsx)(s.EuiText,{textAlign:"center",color:n.textColor,size:"xs","data-test-subj":`${p}BannerText`},n.title)),Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,paddingSize:"s","data-test-subj":"previewSectionHeader"},d),e))};y.displayName="PreviewSection";const h=({component:e,width:t})=>{const n=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!1,style:n,"data-test-subj":"rightSection"},e)};h.displayName="RightSection";const v=({component:e,width:t})=>{const n=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!0,"data-test-subj":"leftSection",style:n},e)};v.displayName="LeftSection";const E={height:"100%"},x=({customStyles:e,registeredPanels:t,...n})=>{var a,o;const d=(()=>{const[e,t]=Object(r.useState)(0);return Object(r.useLayoutEffect)((()=>{function e(){t(window.innerWidth)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),e})(),{left:p,right:m,preview:f}=Object(l.a)(),{closeFlyout:g}=Object(c.a)(),x=Object(r.useMemo)((()=>t.find((e=>e.key===(null==p?void 0:p.id)))),[p,t]),j=Object(r.useMemo)((()=>t.find((e=>e.key===(null==m?void 0:m.id)))),[m,t]),S=f?f[f.length-1]:void 0,O=b(null==S||null===(a=S.params)||void 0===a?void 0:a.banner)?null==S||null===(o=S.params)||void 0===o?void 0:o.banner:void 0,k=Object(r.useMemo)((()=>t.find((e=>e.key===(null==S?void 0:S.id)))),[S,t]),w=null!=j&&null!=m,T=null!=x&&null!=p,I=null!=k&&null!=f,{rightSectionWidth:M,leftSectionWidth:C,flyoutWidth:_,previewSectionLeft:D}=(({windowWidth:e,showRight:t,showLeft:n,showPreview:a})=>{let i=0;if(t)if(e<992)i=Math.min(380,e);else{const t=(e-992)/928*370;i=Math.min(380+t,750)}let r=0;n&&(r=e<=1600?e-i-48:Math.min(80*(e-i)/100,1500));let o=0;return a&&(o=r),{rightSectionWidth:i,leftSectionWidth:r,flyoutWidth:t&&n?`${i+r}px`:`${i}px`,previewSectionLeft:o}})({windowWidth:d,showRight:w,showLeft:T,showPreview:I});return p||m||null!=f&&f.length?Object(u.jsx)(s.EuiFlyout,i()({},n,{size:_,ownFocus:!1,onClose:e=>{g(),n.onClose&&n.onClose(e)},css:e}),Object(u.jsx)(s.EuiFlexGroup,{direction:x?"row":"column",wrap:!1,gutterSize:"none",style:E,responsive:!1},T?Object(u.jsx)(v,{component:x.component({...p}),width:C}):null,w?Object(u.jsx)(h,{component:j.component({...m}),width:M}):null),I?Object(u.jsx)(y,{component:k.component({...S}),leftPosition:D,banner:O}):null):null};x.displayName="ExpandableFlyout";var j=n(145),S=n(175),O=n(342),k=n(776),w=n(1104),T=n(435),I=n(339);const M=Object(r.createContext)(void 0),C=Object(r.memo)((({id:e,indexName:t,scopeId:n,isolateAction:a,children:i})=>{const{dataFormattedForFieldBrowser:s,loading:l}=Object(w.a)({eventId:e,indexName:t}),c=Object(r.useMemo)((()=>e&&t&&n&&a&&s?{eventId:e,indexName:t,scopeId:n,dataFormattedForFieldBrowser:s,isolateAction:a}:void 0),[e,t,n,s,a]);return l?o.a.createElement(I.a,null):c?o.a.createElement(M.Provider,{value:c},i):o.a.createElement(T.a,null)}));C.displayName="IsolateHostPanelProvider";const _=()=>{const e=Object(r.useContext)(M);if(!e)throw new Error("IsolateHostPanelContext can only be used within IsolateHostPanelContext provider");return e};var D=n(418);const A=()=>{const{openRightPanel:e}=Object(c.a)(),{dataFormattedForFieldBrowser:t,eventId:n,scopeId:a,indexName:i,isolateAction:s}=_(),{isIsolateActionSuccessBannerVisible:l,handleIsolationActionSuccess:u}=Object(k.a)(),{alertId:d,hostName:p}=Object(S.b)(t),m=Object(r.useCallback)((()=>e({id:j.e,params:{id:n,indexName:i,scopeId:a}})),[n,i,a,e]);return o.a.createElement(D.a,null,l&&o.a.createElement(O.d,{hostName:p,alertId:d,isolateAction:s}),o.a.createElement(O.f,{details:t,cancelCallback:m,successCallback:u,isolateAction:s}))};var F=n(1203),N=n(332),P=n(10),R=n(211);const L=`${R.a}HeaderTitle`;var z=n(537),q=n(1099);const B=()=>{const{isolateAction:e,dataFormattedForFieldBrowser:t}=_(),{isSupported:n,details:{agentType:a}}=Object(N.a)(t),i=Object(r.useMemo)((()=>n&&("sentinel_one"===a||"crowdstrike"===a)),[a,n]),l=o.a.createElement(s.EuiFlexGroup,{responsive:!0,gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":"flyoutHostIsolationHeaderTitle"},"isolateHost"===e?q.b:q.c,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(F.a,{agentType:a,layout:"horizontal","data-test-subj":"flyoutHostIsolationHeaderIntegration"})),i&&o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiBetaBadge,{"data-test-subj":"flyoutHostIsolationHeaderBadge",label:P.g,tooltipContent:P.h})));return o.a.createElement(z.a,null,o.a.createElement(s.EuiTitle,{size:"s"},o.a.createElement("h4",{"data-test-subj":L},l)))},$=()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(B,null),o.a.createElement(A,null));var V=n(125),U=n(118),G=n(484),H=n(42),W=n(488),Q=n(1432);const Y=({title:e,defaultValue:t})=>{const{storage:n}=Object(U.j)().services,a=n.get(G.a.OVERVIEW_TAB_EXPANDED_SECTIONS),i=e.toLowerCase();return a&&void 0!==a[i]?a[i]:t};var K=n(210),J=n(135);const Z=()=>{const{openLeftPanel:e}=Object(c.a)(),{eventId:t,indexName:n,scopeId:a}=Object(V.b)(),i=Object(r.useCallback)((()=>{e({id:j.c,path:{tab:K.e},params:{id:t,indexName:n,scopeId:a}})}),[t,n,e,a]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiButton,{onClick:i,iconType:"documentation","data-test-subj":J.cb,size:"s"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.responseButtonLabel",defaultMessage:"Response"})))};Z.displayName="ResponseButton";var X=n(279),ee=n(142),te=n(192);const ne="response",ae=Object(r.memo)((()=>{const{isPreview:e,getFieldsData:t,isPreviewMode:n}=Object(V.b)(),a=Y({title:ne,defaultValue:!1}),i=Object(ee.a)(t("event.kind")),l=Object(r.useMemo)((()=>e?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.previewTitle",defaultMessage:"Response actions"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.response.previewAriaLabel",{defaultMessage:"Response actions"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.previewMessage",defaultMessage:"Response is not available in alert preview."})):n?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.openFlyoutTitle",defaultMessage:"Response actions"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.response.openFlyoutAriaLabel",{defaultMessage:"Response actions"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.openFlyoutMessage",defaultMessage:"Open alert details to access response actions."})):o.a.createElement(Z,null)),[e,n]);return i!==te.a.signal?null:o.a.createElement(X.b,{expanded:a,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.sectionTitle",defaultMessage:"Response"}),localStorageKey:ne,"data-test-subj":J.db},l)}));ae.displayName="ResponseSection";var ie=n(608),re=n(379),oe=n(505),se=n(122),le=n(229),ce=n(320),ue=n(174),de=n(288),pe=n(318),me=n(287),fe=n(319);const ge=({field:e,value:t})=>{const{scopeId:n,eventId:a,indexName:i}=Object(V.b)(),{openLeftPanel:l,openPreviewPanel:u}=Object(c.a)(),d=!Object(se.a)("entityAlertPreviewDisabled"),{telemetry:p}=Object(U.j)().services,m=Object(r.useCallback)((()=>{l({id:j.c,path:{tab:K.b,subTab:ce.a},params:{id:a,indexName:i,scopeId:n}})}),[a,i,l,n]),f=Object(r.useCallback)((()=>{u({id:de.e,params:{hostName:t,scopeId:n,banner:pe.a}}),p.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[u,t,n,p]),g=Object(r.useCallback)((()=>{u({id:me.d,params:{userName:t,scopeId:n,banner:fe.a}}),p.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[u,t,n,p]),b=Object(r.useMemo)((()=>d&&e===le.g?f:d&&e===le.p?g:m),[d,e,f,g,m]);return o.a.createElement(s.EuiLink,{onClick:b,"data-test-subj":J.N},t)},be=({values:e,field:t,originalField:n})=>{const a=Object(r.useMemo)((()=>n===ue.b.sentinel_one),[n]),i=Object(r.useMemo)((()=>n===ue.b.crowdstrike),[n]),l=Object(r.useMemo)((()=>a?"sentinel_one":i?"crowdstrike":"endpoint"),[i,a]);return o.a.createElement(o.a.Fragment,null,null!=e&&e.map(((e,n)=>o.a.createElement(s.EuiFlexItem,{grow:!1,key:`${n}-${e}`,"data-test-subj":`${e}-${J.L}`},t===le.g||t===le.p?o.a.createElement(ge,{field:t,value:e}):t===le.a?o.a.createElement(oe.a,{agentId:String(null!=e?e:""),agentType:l,"data-test-subj":J.J}):o.a.createElement("span",{"data-test-subj":J.K},e)))))};var ye=n(366),he=n(607);const ve=[{field:"field",name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableFieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":"fieldCell",width:"30%"},{field:"description",name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableValueColumnLabel",defaultMessage:"Value"}),"data-test-subj":"valueCell",width:"70%",render:e=>o.a.createElement(ye.a,{field:e.field,value:e.values},o.a.createElement(be,{values:e.values,field:e.field,originalField:e.originalField}))}],Ee=()=>{var e,t;const{dataFormattedForFieldBrowser:n,scopeId:a,isPreview:i}=Object(V.b)(),{ruleId:l}=Object(S.b)(n),{loading:c,rule:u}=Object(re.a)(l),d=Object(he.a)({dataFormattedForFieldBrowser:n,investigationFields:null!==(e=null==u||null===(t=u.investigation_fields)||void 0===t?void 0:t.field_names)&&void 0!==e?e:[]}),p=Object(r.useMemo)((()=>Object(ie.b)(d,a,i)),[d,a,i]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.O},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.highlightedFieldsTitle",defaultMessage:"Highlighted fields"})))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.M},o.a.createElement(s.EuiPanel,{hasBorder:!0,hasShadow:!1},o.a.createElement(s.EuiInMemoryTable,{items:p,columns:ve,compressed:!0,loading:c,message:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.noDataDescription",defaultMessage:"There's no highlighted fields for this alert."})}))))};var xe=n(605);const je=()=>{const{openLeftPanel:e}=Object(c.a)(),{eventId:t,indexName:n,scopeId:a,dataFormattedForFieldBrowser:i,isPreview:l,isPreviewMode:u}=Object(V.b)(),{loading:d,error:p,basicAlertData:f,ruleNote:g}=Object(xe.a)({dataFormattedForFieldBrowser:i}),b=Object(r.useCallback)((()=>{e({id:j.c,path:{tab:K.c},params:{id:t,indexName:n,scopeId:a}})}),[t,n,e,a]),y=Object(r.useMemo)((()=>!p&&f&&f.ruleId&&g),[p,f,g]),h=Object(r.useMemo)((()=>l?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.previewTitle",defaultMessage:"Investigation guide"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.previewAriaLabel",{defaultMessage:"Investigation guide"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."})):d?o.a.createElement(s.EuiSkeletonText,{"data-test-subj":J.T,contentAriaLabel:m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideLoadingAriaLabel",{defaultMessage:"investigation guide"})}):y&&u?o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.openFlyoutTitle",defaultMessage:"Investigation guide available"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.openFlyoutAriaLabel",{defaultMessage:"Investigation guide available"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.openFlyoutMessage",defaultMessage:"Open alert details to access investigation guides."})):y?o.a.createElement(s.EuiButton,{onClick:b,iconType:"documentation",size:"s",fullWidth:!0,"data-test-subj":J.S,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonAriaLabel",{defaultMessage:"Show investigation guide"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonLabel",defaultMessage:"Show investigation guide"})):o.a.createElement(s.EuiCallOut,{iconType:"documentation",size:"s",title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataTitle",defaultMessage:"Investigation guide"}),"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataAriaLabel",{defaultMessage:"Investigation guide"})},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataDescription",defaultMessage:"There's no investigation guide for this rule."}))),[d,l,u,b,y]);return o.a.createElement("div",{"data-test-subj":J.U},h)};je.displayName="InvestigationGuideButton";const Se="investigation",Oe=Object(r.memo)((()=>{const{getFieldsData:e}=Object(V.b)(),t=Object(ee.a)(e("event.kind")),n=Y({title:Se,defaultValue:!0});return o.a.createElement(X.b,{expanded:n,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.sectionTitle",defaultMessage:"Investigation"}),localStorageKey:Se,gutterSize:"none","data-test-subj":J.V},t===te.a.signal&&o.a.createElement(o.a.Fragment,null,o.a.createElement(je,null),o.a.createElement(s.EuiSpacer,{size:"m"})),o.a.createElement(Ee,null))}));Oe.displayName="InvestigationSection";var ke=n(41),we=n.n(ke);const Te={title:m.i18n.translate("xpack.securitySolution.flyout.right.about.description.rulePreviewTitle",{defaultMessage:"Preview rule details"}),backgroundColor:"warning",textColor:"warning"},Ie=()=>{const{telemetry:e}=Object(U.j)().services,{dataFormattedForFieldBrowser:t,scopeId:n,eventId:a,indexName:i,isPreview:l}=Object(V.b)(),{isAlert:u,ruleDescription:p,ruleName:f,ruleId:g}=Object(S.b)(t),{openPreviewPanel:b}=Object(c.a)(),y=Object(r.useCallback)((()=>{b({id:j.f,params:{id:a,indexName:i,scopeId:n,banner:Te,ruleId:g}}),e.reportDetailsFlyoutOpened({location:n,panel:"preview"})}),[a,b,i,n,g,e]),h=Object(r.useMemo)((()=>o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:y,iconSide:"right","data-test-subj":J.gb,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonAriaLabel",{defaultMessage:"Show rule summary"}),disabled:Object(d.isEmpty)(f)||Object(d.isEmpty)(g)||l},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonLabel",defaultMessage:"Show rule summary"})))),[f,y,g,l]),v=(null==p?void 0:p.length)>0?p:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.noRuleDescription",defaultMessage:"There's no description for this rule."});return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.c},o.a.createElement(s.EuiTitle,{size:"xxs"},u?o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,null,o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleTitle",defaultMessage:"Rule description"}))),h):o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.documentTitle",defaultMessage:"Document description"})))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.b},o.a.createElement(Me,null,u?v:"-")))};Ie.displayName="AlertDescription";var Me=we()("p").withConfig({displayName:"_StyledP",componentId:"sc-ewyemy-0"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;"]),Ce=n(748);const _e={title:m.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonPreviewTitle",{defaultMessage:"Preview alert reason"}),backgroundColor:"warning",textColor:"warning"},De=()=>{const{telemetry:e}=Object(U.j)().services,{eventId:t,indexName:n,scopeId:a,dataFormattedForFieldBrowser:i,getFieldsData:l}=Object(V.b)(),{isAlert:u}=Object(S.b)(i),d=Object(ee.a)(l(Ce.m)),{openPreviewPanel:p}=Object(c.a)(),f=Object(r.useCallback)((()=>{p({id:j.a,params:{id:t,indexName:n,scopeId:a,banner:_e}}),e.reportDetailsFlyoutOpened({location:a,panel:"preview"})}),[t,p,n,a,e]),g=Object(r.useMemo)((()=>o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:f,iconSide:"right","data-test-subj":J.Z,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonButtonAriaLabel",{defaultMessage:"Show full reason"}),disabled:!d},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonButtonLabel",defaultMessage:"Show full reason"})))),[d,f]),b=d||o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.noReasonDescription",defaultMessage:"There's no source event information for this alert."});return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.bb},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,u?o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonTitle",defaultMessage:"Alert reason"}))),g):o.a.createElement("p",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.documentReasonTitle",defaultMessage:"Document reason"}))))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.ab},u?b:"-"))};De.displayName="Reason";var Ae=n(829);const Fe=()=>{const{searchHit:e}=Object(V.b)(),t=Object(r.useMemo)((()=>Object(Ae.a)(e)),[e]);return t&&t[0]?o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.X},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,t[0].title))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.W},t[0].description)):null};Fe.displayName="MitreAttack";var Ne=n(538);const Pe=(e,t)=>{var n,a;if(!t||null==t)return!1;const i=null!==(n=null===(a=Ne.EcsFlat[e])||void 0===a?void 0:a.allowed_values)&&void 0!==n?n:[];return Boolean(null==i?void 0:i.find((e=>e.name===t)))},Re=(e,t)=>{var n,a,i,r;const o=null!==(n=null===(a=Ne.EcsFlat[e])||void 0===a?void 0:a.allowed_values)&&void 0!==n?n:[];return null!==(i=null==o||null===(r=o.find((e=>e.name===t)))||void 0===r?void 0:r.description)&&void 0!==i?i:m.i18n.translate("xpack.securitySolution.flyout.right.about.noEventKindDescriptionMessage",{defaultMessage:"This field doesn't have a description because it's not part of ECS."})},Le={authentication:"user.name",configuration:"",database:"",driver:"",email:"",file:"file.name",host:"host.name",iam:"",intrusion_detection:"",malware:"",network:"",package:"",process:"process.name",registry:"",session:"",threat:"",vulnerability:"",web:""},ze=()=>{const{getFieldsData:e}=Object(V.b)(),t=Object(r.useMemo)((()=>Object(ee.b)(e("event.category"))),[e]);return o.a.createElement(o.a.Fragment,null,t.map((e=>o.a.createElement(s.EuiFlexItem,{"data-test-subj":`${J.C}-${e}`,key:`event-category-${e}`},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,Object(d.startCase)(e))),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiText,{size:"s"},Re("event.category",e))))))};ze.displayName="EventCategoryDescription";const qe=({eventKind:e})=>{const{getFieldsData:t}=Object(V.b)(),n=Object(r.useMemo)((()=>Object(ee.b)(t("event.category"))),[t]);return o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.E},o.a.createElement(s.EuiTitle,{size:"xxs","data-test-subj":J.F},o.a.createElement("h5",null,Object(d.startCase)(e))),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiText,{size:"s"},Re("event.kind",e)),n.length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,o.a.createElement(H.FormattedMessage,{defaultMessage:"Event category",id:"xpack.securitySolution.flyout.right.eventCategoryText"}))),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"s","data-test-subj":J.D},n.map(((e,t)=>o.a.createElement(s.EuiFlexItem,{grow:!1,key:`event-category-${e}`},o.a.createElement(s.EuiToolTip,{content:Re("event.category",e)},o.a.createElement(s.EuiText,{size:"s"},e,t!==n.length-1&&","))))))))};qe.displayName="EventKindDescription";var Be=n(448),$e=n.n(Be),Ve=n(49),Ue=n(299),Ge=n(304);const He=$e.a.div`
  overflow-x: auto;
  padding-block: ${Ve.euiThemeVars.euiSizeS};
`,We=$e.a.div``,Qe=()=>{const{dataAsNestedObject:e,scopeId:t}=Object(V.b)(),n=Object(r.useMemo)((()=>Object(Ue.a)({data:e,rowRenderers:Ge.b})),[e]),a=Object(r.useMemo)((()=>n?n.renderRow({contextId:"event-details",data:e,isDraggable:!1,scopeId:t}):null),[n,e,t]);return n?o.a.createElement(s.EuiFlexItem,{"data-test-subj":J.G},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,"Event renderer")),o.a.createElement(He,null,o.a.createElement(We,{className:"eui-displayInlineBlock"},a))):null};Qe.displayName="EventRenderer";const Ye="about",Ke=Object(r.memo)((()=>{const{getFieldsData:e}=Object(V.b)(),t=Object(ee.a)(e("event.kind")),n=t&&Pe("event.kind",t),a=Y({title:Ye,defaultValue:!0}),i=t===te.a.signal?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ie,null),o.a.createElement(De,null),o.a.createElement(Fe,null)):o.a.createElement(o.a.Fragment,null,n&&("event"===t?o.a.createElement(ze,null):o.a.createElement(qe,{eventKind:t})),o.a.createElement(Qe,null));return o.a.createElement(X.b,{expanded:a,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.sectionTitle",defaultMessage:"About"}),localStorageKey:Ye,gutterSize:"s","data-test-subj":J.a},i)}));Ke.displayName="AboutSection";var Je=n(813),Ze=n(202),Xe=n(616),et=n(609),tt=n(228);const nt=({loading:e=!1,error:t=!1,icon:n,value:a,text:i,color:r,"data-test-subj":l})=>{const{euiTheme:c}=Object(s.useEuiTheme)(),u=`${l}Loading`;if(e)return o.a.createElement(s.EuiSkeletonText,{lines:1,size:"m",isLoading:e,contentAriaLabel:m.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryLoadingAriaLabel",{defaultMessage:"Loading insights for {value}",values:{value:a}}),"data-test-subj":u});if(t)return null;const d=`${l}Icon`,p=`${l}Value`,f=`${l}Color`;return o.a.createElement(s.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(at,{"data-test-subj":d,"aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryButtonIconAriaLabel",{defaultMessage:"Insight summary row icon"}),color:"text",display:"empty",type:n,size:"m",$_css:c.size.s})),o.a.createElement(it,{"data-test-subj":p},a&&o.a.createElement(tt.a,{count:a})," ",i),r&&o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":f},o.a.createElement(s.EuiHealth,{color:r})))};nt.displayName="InsightsSummaryRow";var at=we()(s.EuiIcon)`
            margin: ${e=>e.$_css};
          `,it=we()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-uq3b7l-0"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;"]);const rt=({entityId:e,scopeId:t})=>{const{loading:n,error:a,dataCount:i}=Object(et.a)({entityId:e,scopeId:t}),r=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sessionAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by session",values:{count:i}});return o.a.createElement(nt,{loading:n,error:a,icon:"warning",value:i,text:r,"data-test-subj":J.l,key:`correlation-row-${r}`})};rt.displayName="RelatedAlertsBySession";var ot=n(615),st=n(610);const lt=({originalEventId:e,scopeId:t})=>{const{loading:n,dataCount:a}=Object(st.a)({originalEventId:e,scopeId:t}),i=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sourceAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by source event",values:{count:a}});return o.a.createElement(nt,{loading:n,icon:"warning",value:a,text:i,"data-test-subj":J.k,key:`correlation-row-${i}`})};lt.displayName="RelatedAlertsBySameSourceEvent";var ct=n(617);const ut=({documentId:e,indices:t,scopeId:n})=>{const{loading:a,error:i,dataCount:r}=Object(ct.a)({documentId:e,indices:t,scopeId:n}),s=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.ancestryAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by ancestry",values:{count:r}});return o.a.createElement(nt,{loading:a,error:i,icon:"warning",value:r,text:s,"data-test-subj":J.j,key:`correlation-row-${s}`})};ut.displayName="RelatedAlertsByAncestry";var dt=n(613),pt=n(165),mt=n(253);const ft=({alertSuppressionCount:e,ruleType:t})=>o.a.createElement(s.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(nt,{loading:!1,error:!1,icon:"layers",value:e,text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.suppressedAlertsLabel",defaultMessage:"suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),"data-test-subj":J.o,key:"correlation-row-suppressed-alerts"})),t&&Object(pt.l)(t)?null:o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiBetaBadge,{label:mt.w,size:"s",iconType:"beaker",tooltipContent:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.suppressedAlertTechnicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),tooltipPosition:"bottom","data-test-subj":J.n})));ft.displayName="SuppressedAlerts";var gt=n(614),bt=n(611);const yt=({eventId:e})=>{const{loading:t,error:n,dataCount:a}=Object(bt.a)({eventId:e}),i=o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.relatedCasesLabel",defaultMessage:"related {count, plural, one {case} other {cases}}",values:{count:a}});return o.a.createElement(nt,{loading:t,error:n,icon:"warning",value:a,text:i,"data-test-subj":J.m,key:`correlation-row-${i}`})};yt.displayName="RelatedCases";var ht=n(612),vt=n(623),Et=n(277),xt=n(131),jt=n(256),St=n(170);const Ot=()=>{var e;const{dataAsNestedObject:t,eventId:n,indexName:a,getFieldsData:i,scopeId:l,isPreview:u,isPreviewMode:p}=Object(V.b)(),{openLeftPanel:m}=Object(c.a)(),{isTourShown:f,activeStep:g}=Object(jt.b)(),{selectedPatterns:b}=Object(Et.a)(Object(xt.isActiveTimeline)(l)),y=Object(r.useCallback)((()=>{m({id:j.c,path:{tab:K.b,subTab:vt.a},params:{id:n,indexName:a,scopeId:l}})}),[n,m,a,l]);Object(r.useEffect)((()=>{f(St.b.alertsCases)&&g===St.a.viewCase&&y()}),[g,y,f]);const{show:h,documentId:v}=Object(dt.a)({getFieldsData:i,dataAsNestedObject:t,eventId:n,isPreview:u}),{show:E,originalEventId:x}=Object(ot.a)({eventId:n,getFieldsData:i}),{show:S,entityId:O}=Object(Xe.a)({getFieldsData:i}),k=Object(ht.a)({getFieldsData:i}),{show:w,alertSuppressionCount:T}=Object(gt.a)({getFieldsData:i}),I=h||E||S||k||w,M=null===(e=Object(d.get)(t,Je.o))||void 0===e?void 0:e[0],C=Object(r.useMemo)((()=>p?void 0:{callback:y,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTooltip",defaultMessage:"Show all correlations"})}),[p,y]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTitle",defaultMessage:"Correlations"}),link:C,iconType:p?void 0:"arrowStart"},"data-test-subj":J.p},I?o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},w&&o.a.createElement(ft,{alertSuppressionCount:T,ruleType:M}),k&&o.a.createElement(yt,{eventId:n}),E&&o.a.createElement(lt,{originalEventId:x,scopeId:l}),S&&O&&o.a.createElement(rt,{entityId:O,scopeId:l}),h&&o.a.createElement(ut,{documentId:v,indices:b,scopeId:l})):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};Ot.displayName="CorrelationsOverview";var kt=n(628),wt=n(606);const Tt=()=>{const{eventId:e,indexName:t,dataFormattedForFieldBrowser:n,scopeId:a,investigationFields:i,isPreviewMode:l}=Object(V.b)(),{openLeftPanel:u}=Object(c.a)(),d=Object(r.useCallback)((()=>{u({id:j.c,path:{tab:K.b,subTab:wt.a},params:{id:e,indexName:t,scopeId:a}})}),[e,u,t,a]),{loading:p,error:m,data:f}=Object(kt.a)({dataFormattedForFieldBrowser:n,investigationFields:i,interval:{from:"now-30d",to:"now"}}),g=Object(r.useMemo)((()=>f.filter((e=>isFinite(e.hostPrevalence)&&e.hostPrevalence>0&&e.hostPrevalence<.1))),[f]),b=Object(r.useMemo)((()=>l?void 0:{callback:d,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTooltip",defaultMessage:"Show all prevalence"})}),[d,l]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTitle",defaultMessage:"Prevalence"}),link:b,iconType:l?void 0:"arrowStart"},content:{loading:p,error:m},"data-test-subj":J.Y},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},g.length>0?g.map((e=>o.a.createElement(nt,{icon:"warning",text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.rowDescription",defaultMessage:"{field}, {value} is uncommon",values:{field:e.field,value:e.values.toString()}}),"data-test-subj":`${J.Y}${e.field}`,key:`${J.Y}${e.field}`}))):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})))};Tt.displayName="PrevalenceOverview";var It=n(336),Mt=n(441),Ct=n(195),_t=n(633);const Dt=()=>{const{eventId:e,indexName:t,scopeId:n,dataFormattedForFieldBrowser:a,isPreviewMode:i}=Object(V.b)(),{openLeftPanel:l}=Object(c.a)(),u=Object(r.useCallback)((()=>{l({id:j.c,path:{tab:K.b,subTab:_t.a},params:{id:e,indexName:t,scopeId:n}})}),[e,l,t,n]),{loading:p,threatMatchesCount:m,threatEnrichmentsCount:f}=(({dataFormattedForFieldBrowser:e})=>{const{isAlert:t}=Object(S.b)(e),n=Object(r.useMemo)((()=>Object(It.c)(e||[])),[e]),a=Object(r.useMemo)((()=>t?Object(It.g)(e||[]).map((e=>Object(It.h)(e))):[]),[e,t]),{result:i,loading:o}=Object(Mt.c)(n),s=Object(r.useMemo)((()=>o||null==i||!i.enrichments?a:Object(It.b)([...a,...i.enrichments])),[o,i,a]),{[Ct.c.IndicatorMatchRule]:l,[Ct.c.InvestigationTime]:c}=Object(d.groupBy)(s,"matched.type");return{loading:o,threatMatches:l,threatMatchesCount:(l||[]).length,threatEnrichments:c,threatEnrichmentsCount:(c||[]).length}})({dataFormattedForFieldBrowser:a}),g=Object(r.useMemo)((()=>i?void 0:{callback:u,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTooltip",defaultMessage:"Show all threat intelligence"})}),[i,u]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTitle",defaultMessage:"Threat intelligence"}),link:g,iconType:i?void 0:"arrowStart"},"data-test-subj":J.R,content:{loading:p}},o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none","data-test-subj":`${J.R}Container`},o.a.createElement(nt,{icon:"warning",value:m,text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatMatchDescription",defaultMessage:"threat {count, plural, one {match} other {matches}} detected",values:{count:m}}),"data-test-subj":J.R}),o.a.createElement(nt,{icon:"warning",value:f,text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatEnrichmentDescription",defaultMessage:"{count, plural, one {field} other {fields}} enriched with threat intelligence",values:{count:f}}),"data-test-subj":J.R})))};Dt.displayName="ThreatIntelligenceOverview";const At=()=>{const{eventId:e,getFieldsData:t,indexName:n,scopeId:a,isPreviewMode:i}=Object(V.b)(),{openLeftPanel:l}=Object(c.a)(),u=Object(ee.a)(t("host.name")),d=Object(ee.a)(t("user.name")),p=Object(r.useCallback)((()=>{l({id:j.c,path:{tab:K.b,subTab:ce.a},params:{id:e,indexName:n,scopeId:a}})}),[e,l,n,a]),m=Object(r.useMemo)((()=>i?void 0:{callback:p,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTooltip",defaultMessage:"Show all entities"})}),[p,i]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTitle",defaultMessage:"Entities"}),link:m,iconType:i?void 0:"arrowStart"},"data-test-subj":J.P},d||u?o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},d&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiFlexItem,null,o.a.createElement(fe.b,{userName:d})),o.a.createElement(s.EuiSpacer,{size:"s"})),u&&o.a.createElement(s.EuiFlexItem,null,o.a.createElement(pe.b,{hostName:u}))):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."})))};At.displayName="EntitiesOverview";const Ft="insights",Nt=Object(r.memo)((()=>{const{getFieldsData:e}=Object(V.b)(),t=Object(ee.a)(e("event.kind")),{activeStep:n,isTourShown:a}=Object(jt.b)(),i=a(St.b.alertsCases)&&n===St.a.viewCase,r=Y({title:Ft,defaultValue:!1})||i;return o.a.createElement(X.b,{expanded:r,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.sectionTitle",defaultMessage:"Insights"}),localStorageKey:Ft,"data-test-subj":J.Q},o.a.createElement(At,null),t===te.a.signal&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(Dt,null)),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(Ot,null),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(Tt,null))}));Nt.displayName="InsightsSection";var Pt=n(45),Rt=n(1403),Lt=n(187),zt=n(377),qt=n(219),Bt=n(13),$t=n(541),Vt=n(44);const Ut=(e,t,n,a,i)=>{const r=e.find((e=>e.id===t.parent));if(i===a&&r)return{id:"ancestor",label:"...",children:[n],isExpanded:!0};if(a<0||i<0||i>=a||!r)return n;const o={id:r.id,label:r.name,children:[n],isExpanded:!0};return Ut(e,r,o,a,i+1)},Gt=(e,t,n,a,i)=>{const r=e.filter((e=>e.parent===t.id));if(i===a&&r.length>0)return[{id:"descendant",label:"...",isExpanded:!1}];if(n<0||a<0||i<0||i>=a||!r||0===r.length)return;const o=[];return r.forEach(((t,r)=>{r<n&&o.push({id:t.id,label:t.name,children:Gt(e,t,n,a,i+1),isExpanded:!1}),r===n&&o.push({id:"more-child",label:"..."})})),o};var Ht=n(234),Wt=n(539);const Qt=()=>{var e,t;const[n,a]=Object(r.useState)({}),{dataFormattedForFieldBrowser:i,getFieldsData:l,scopeId:c,eventId:u,isPreview:d}=Object(V.b)(),p=null!==(e=Object(ee.a)(l(Ht.a)))&&void 0!==e?e:"",f=d?p:u,{selectedPatterns:g}=Object(Et.a)(Object(xt.isActiveTimeline)(c)),b=Object(Vt.find)({category:"kibana",field:Ht.e},i),y=null!==(t=null==b?void 0:b.values)&&void 0!==t?t:g,{statsNodes:h,loading:v,error:E}=Object(Wt.a)({isActiveTimeline:Object(xt.isActiveTimeline)(c),documentId:f,indices:y});Object(r.useEffect)((()=>{h&&0!==h.length&&a({statsNodes:h})}),[h,a]);const x=Object(r.useMemo)((()=>{var e;return((e,t=3,n=3,a=3)=>{if(0===e.length)return[];const i=e[0],r={id:i.id,label:o.a.createElement("b",{},i.name),children:Gt(e,i,t,a,0),isExpanded:!0,icon:o.a.createElement(s.EuiToken,{iconType:"tokenConstant"})};return[Ut(e,i,r,n,0)]})(null!==(e=n.statsNodes)&&void 0!==e?e:[],3,3,3)}),[n.statsNodes]),j=x&&x.length>0&&!E;return v?o.a.createElement(s.EuiSkeletonText,{"data-test-subj":J.e,contentAriaLabel:m.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.loadingAriaLabel",{defaultMessage:"analyzer preview"})}):j?o.a.createElement(s.EuiTreeView,{items:x,display:"compressed","aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.treeViewAriaLabel",{defaultMessage:"Analyzer preview"}),showExpansionArrows:!0,"data-test-subj":J.f}):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.errorDescription",defaultMessage:"An error is preventing this alert from being analyzed."})};Qt.displayName="AnalyzerPreview";const Yt="timeline-1",Kt=()=>{const{dataAsNestedObject:e,isPreview:t}=Object(V.b)(),n=Object($t.a)(e),a=Object(Pt.useDispatch)(),{startTransaction:i}=Object(Lt.b)(),{investigateInTimelineAlertClick:l}=Object(zt.a)({ecsRowData:e}),c=Object(r.useCallback)((async()=>{await l(),i({name:qt.a.OPEN_ANALYZER});const t=Object(xt.getScopedActions)(Yt);t&&e&&a(t.updateGraphEventId({id:Yt,graphEventId:e._id})),a(Object(Bt.setActiveTabTimeline)({id:Yt,activeTab:Rt.a.graph}))}),[e,a,l,i]);return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTitle",defaultMessage:"Analyzer preview"}),iconType:"timeline",...n&&!t&&{link:{callback:c,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTooltip",defaultMessage:"Investigate in timeline"})}}},"data-test-subj":J.f},n?o.a.createElement(Qt,null):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataDescription",defaultMessage:"You can only visualize events triggered by hosts configured with the Elastic Defend integration or any {sysmon} data from {winlogbeat}. Refer to {link} for more information.",values:{sysmon:o.a.createElement(s.EuiMark,null,"sysmon"),winlogbeat:o.a.createElement(s.EuiMark,null,"winlogbeat"),link:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/visual-event-analyzer.html",target:"_blank"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataLinkText",defaultMessage:"Visual event analyzer"}))}}))};Kt.displayName="AnalyzerPreviewContainer";var Jt=n(152),Zt=n(16),Xt=n(81),en=n(58),tn=n(194),nn=n(198);const an=({ruleId:e})=>{const t=Object(tn.m)();if(!e)return null;const n=Object(tn.h)(e);let a=t({deepLinkId:Xt.a.rules,path:n});const i=new URLSearchParams(a).get(nn.a.timeline);if(i){const e=Object(en.safeDecode)(i);if(e&&e.isOpen){const t=Object(en.encode)({...e,isOpen:!1});a=a.replace(i,t)}}return a};var rn=n(151);const on=e=>{const t=Object(ee.a)(e("process.entry_leader.user.name")),n=Object(ee.a)(e("process.entry_leader.user.id"));return t||(n?"0"===n?"root":`uid: ${n}`:"unknown")},sn=({text:e,children:t})=>o.a.createElement(o.a.Fragment,null,e&&o.a.createElement(o.a.Fragment,null," ",o.a.createElement("span",null,e)," "),t),ln=()=>{const{isPreview:e}=Object(V.b)(),{processName:t,userName:n,startAt:a,ruleName:i,ruleId:l,workdir:c,command:u}=(()=>{const{getFieldsData:e}=Object(V.b)();return Object(r.useMemo)((()=>({userName:on(e),processName:Object(ee.a)(e("process.entry_leader.name")),startAt:Object(ee.a)(e("process.entry_leader.start")),ruleName:Object(ee.a)(e(Ce.r)),ruleId:Object(ee.a)(e(Ce.y)),workdir:Object(ee.a)(e("process.group_leader.working_directory")),command:Object(ee.a)(e("process.command_line"))})),[e])})(),{euiTheme:d}=Object(s.useEuiTheme)(),p=Object(r.useMemo)((()=>({fontWeight:d.font.weight.bold})),[d.font.weight.bold]),m=Object(r.useMemo)((()=>t&&o.a.createElement(sn,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.processDescription",defaultMessage:"started"})},o.a.createElement("span",{style:p},t))),[p,t]),f=Object(r.useMemo)((()=>a&&o.a.createElement(sn,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.timeDescription",defaultMessage:"at"})},o.a.createElement("span",null,o.a.createElement(rn.c,{value:new Date(a)})))),[a]),g=an({ruleId:e?null:l}),b=Object(r.useMemo)((()=>i&&l&&o.a.createElement(sn,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.ruleDescription",defaultMessage:"with rule"})},g?o.a.createElement(s.EuiLink,{href:g,target:"_blank","data-test-subj":J.hb},i):o.a.createElement(sn,null,i))),[i,l,g]),y=Object(r.useMemo)((()=>u&&o.a.createElement(sn,{text:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.commandDescription",defaultMessage:"by"})},o.a.createElement(s.EuiCode,null,c," ",u))),[u,c]);return o.a.createElement(cn,{"data-test-subj":J.ib},o.a.createElement(sn,null,o.a.createElement(s.EuiIcon,{type:"user"})," ",o.a.createElement("span",{style:p},n)),m,f,b,y)};var cn=we()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-16jqh3v-0"})(["line-height:1.5;"]);const un="timeline-1",dn=()=>{const{dataAsNestedObject:e,getFieldsData:t,isPreview:n,dataFormattedForFieldBrowser:a}=Object(V.b)(),i=(({getFieldsData:e,dataFormattedForFieldBrowser:t})=>{const{indexName:n,alertId:a}=Object(S.b)(t),i=Object(ee.a)(e("kibana.alert.ancestors.index"))||n,r=Object(ee.a)(e("process.entry_leader.entity_id")),o=Object(ee.a)(e("process.entry_leader.start")),s=Object(ee.a)(e("process.entity_id")),l=Object(ee.a)(e("kibana.alert.original_time"))||Object(ee.a)(e("timestamp"));return i&&r&&o?{index:i,sessionEntityId:r,sessionStartTime:o,...s&&{jumpToEntityId:s},...l&&{jumpToCursor:l},...a&&{investigatedAlertId:a}}:null})({getFieldsData:t,dataFormattedForFieldBrowser:a}),l=Object(Zt.b)().isEnterprise(),c=i&&l,u=Object(Pt.useDispatch)(),{startTransaction:d}=Object(Lt.b)(),p=Object(xt.getScopedActions)(un),{investigateInTimelineAlertClick:m}=Object(zt.a)({ecsRowData:e}),f=Object(r.useCallback)((async()=>{await m(),d({name:qt.a.OPEN_SESSION_VIEW}),null!==i&&(u(Object(Bt.setActiveTabTimeline)({id:un,activeTab:Rt.a.session})),p&&u(p.updateSessionViewConfig({id:un,sessionViewConfig:i})))}),[u,m,p,i,d]),{euiTheme:g}=Object(s.useEuiTheme)(),b=l?i?null:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataDescription",defaultMessage:"You can only view Linux session details if you’ve enabled the {setting} setting in your Elastic Defend integration policy. Refer to {link} for more information.",values:{setting:o.a.createElement(pn,{$_css:g.font.weight.bold},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataSettingDescription",defaultMessage:"Include session data"})),link:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/session-view.html#enable-session-view",target:"_blank"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataLinkText",defaultMessage:"Enable Session View data"}))}}):o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellDescription",defaultMessage:"This feature requires an {subscription}",values:{subscription:o.a.createElement(s.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellLinkText",defaultMessage:"Enterprise subscription"}))}});return o.a.createElement(Ze.a,{header:{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTitle",defaultMessage:"Session viewer preview"}),iconType:"timeline",...c&&!n&&{link:{callback:f,tooltip:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTooltip",defaultMessage:"Investigate in timeline"})}}},"data-test-subj":J.ib},c?o.a.createElement(ln,null):b)};var pn=we()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-4u5d2b-0"})(["font-weight:",";"],(e=>e.$_css));const mn="visualizations",fn=Object(r.memo)((()=>{const e=Y({title:mn,defaultValue:!1});return o.a.createElement(X.b,{expanded:e,title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sectionTitle",defaultMessage:"Visualizations"}),localStorageKey:mn,"data-test-subj":J.lb},o.a.createElement(dn,null),o.a.createElement(s.EuiSpacer,null),o.a.createElement(Kt,null))}));fn.displayName="VisualizationsSection";const gn=Object(r.memo)((()=>o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"none","aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.overview.overviewContentAriaLabel",{defaultMessage:"Overview"})},o.a.createElement(Ke,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(Oe,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(fn,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(Nt,null),o.a.createElement(s.EuiHorizontalRule,{margin:"m"}),o.a.createElement(ae,null))));gn.displayName="OverviewTab";var bn=n(1402);const yn={id:"overview","data-test-subj":W.d,name:o.a.createElement("div",{"data-test-subj":W.c},o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.overviewTabLabel",defaultMessage:"Overview"})),content:o.a.createElement(gn,null)},hn={id:"table","data-test-subj":W.e,name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.tableTabLabel",defaultMessage:"Table"}),content:o.a.createElement(bn.a,null)},vn={id:"json","data-test-subj":W.b,name:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.jsonTabLabel",defaultMessage:"JSON"}),content:o.a.createElement(Q.a,null)},En=[yn,hn,vn],xn=[hn,vn],jn=({flyoutIsExpandable:e,path:t})=>{const{storage:n}=Object(U.j)().services,a=Object(r.useMemo)((()=>e?En:xn),[e]),i=Object(r.useMemo)((()=>{if(t){const e=a.map((e=>e.id)).find((e=>e===t.tab));if(e)return e}const e=n.get(G.a.RIGHT_PANEL_SELECTED_TABS);return e&&a.map((e=>e.id)).includes(e)?e:a[0].id}),[t,n,a]);return{tabsDisplayed:a,selectedTabId:i}};var Sn=n(1737),On=n(1210),kn=n(1866),wn=n(533),Tn=n(965),In=n(197),Mn=n(960);const Cn=()=>({promptContextId:void 0}),_n=Object(r.memo)((()=>{const{dataFormattedForFieldBrowser:e,eventId:t,indexName:n}=Object(V.b)(),{isAlert:a,timestamp:i}=Object(S.b)(e),l=Object(On.a)({_id:t,_index:n,timestamp:i}),c=a&&l,{showAssistant:u,promptContextId:d}=(({dataFormattedForFieldBrowser:e,isAlert:t})=>{const{hasAssistantPrivilege:n,isAssistantEnabled:a}=Object(wn.a)(),i=n?kn.a:Cn,o=Object(r.useCallback)((async()=>Object(Tn.d)(null!=e?e:[])),[e]),{promptContextId:s}=i(t?"alert":"event",t?In.e:In.i,t?Object(In.d)(In.A):Object(In.h)(In.A),o,null,t?Mn.b[Mn.c].suggestedUserPrompt:Mn.b[Mn.e].suggestedUserPrompt,t?In.f:In.j,a);return{showAssistant:n&&null!==s,promptContextId:s||""}})({dataFormattedForFieldBrowser:e,isAlert:a});return o.a.createElement(s.EuiFlexGroup,{direction:"row",justifyContent:"flexEnd",alignItems:"center",gutterSize:"none",responsive:!1},u&&o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(Sn.a,{conversationTitle:a?In.e:In.i,promptContextId:d,iconOnly:!0})),c&&o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiToolTip,{content:m.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonToolTip",{defaultMessage:"Share alert"})},o.a.createElement(s.EuiCopy,{textToCopy:l},(e=>o.a.createElement(s.EuiButtonIcon,{iconType:"share",color:"text","aria-label":m.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonAriaLabel",{defaultMessage:"Share alert"}),"data-test-subj":J.jb,onClick:e,onKeyDown:e}))))))}));_n.displayName="HeaderActions";var Dn=n(1350);const An=Object(r.memo)((({flyoutIsExpandable:e})=>{const{telemetry:t}=Object(U.j)().services,{openLeftPanel:n}=Object(c.a)(),{eventId:a,indexName:i,scopeId:s}=Object(V.b)(),l=Object(r.useCallback)((()=>{n({id:j.c,params:{id:a,indexName:i,scopeId:s}}),t.reportDetailsFlyoutOpened({location:s,panel:"left"})}),[a,n,i,s,t]);return o.a.createElement(Dn.a,{flyoutIsExpandable:e,expandDetails:l,actions:o.a.createElement(_n,null)})}));An.displayName="PanelNavigation";const Fn=Object(r.memo)((({children:e,...t})=>o.a.createElement(Nn,i()({size:"l",expand:!0},t),e)));Fn.displayName="FlyoutHeaderTabs";var Nn=we()(s.EuiTabs).withConfig({displayName:"_StyledEuiTabs",componentId:"sc-146ys67-0"})(["margin-bottom:-17px;"]),Pn=n(130),Rn=n(831),Ln=n(284);const zn=()=>{const{closeFlyout:e}=Object(c.a)(),{eventId:t,browserFields:n,dataFormattedForFieldBrowser:a,scopeId:i,isPreview:l}=Object(V.b)(),u=Object(r.useMemo)((()=>{const e=Object(Vt.find)({field:le.o,category:"kibana"},a);return e&&Object(Ln.b)({eventId:t,contextId:i,scopeId:i,browserFields:n,item:e})}),[n,a,t,i]);return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"xs",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiTitle,{size:"xxs","data-test-subj":J.kb},o.a.createElement("h3",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.statusTitle",defaultMessage:"Status"})))),o.a.createElement(s.EuiFlexItem,{grow:!1},u&&(d=u)&&Array.isArray(d.values)&&!l?o.a.createElement(ye.a,{field:le.o,value:u.values[0]},o.a.createElement(Rn.a,{eventId:t,contextId:i,enrichedFieldInfo:u,scopeId:i,handleOnEventClosed:e})):Object(Pn.d)()));var d};zn.displayName="DocumentStatus";var qn=n(298);const Bn=e=>"low"===e||"medium"===e||"high"===e||"critical"===e,$n=Object(r.memo)((()=>{const{getFieldsData:e}=Object(V.b)(),t=e(Je.s);if(!t)return null;let n;if("string"==typeof t&&Bn(t))n=t;else{if(!(Array.isArray(t)&&t.length>0&&Bn(t[0])))return null;n=t[0]}return o.a.createElement(ye.a,{field:Je.s,value:n},o.a.createElement(qn.a,{value:n}))}));$n.displayName="DocumentSeverity";const Vn=Object(r.memo)((()=>{const{getFieldsData:e}=Object(V.b)(),t=e(Je.a);if(!t)return null;let n;if("string"==typeof t)n=t;else{if(!(Array.isArray(t)&&t.length>0))return null;n=t[0]}return o.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"xs",responsive:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiTitle,{size:"xxs","data-test-subj":J.eb},o.a.createElement("h3",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.riskScoreTitle",defaultMessage:"Risk score"})))),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":J.fb},n)))}));Vn.displayName="RiskScore";var Un=n(775),Gn=n(1101),Hn=n(926);const Wn=Object(r.memo)((()=>{const{dataFormattedForFieldBrowser:e,eventId:t,scopeId:n,isPreview:a,refetchFlyoutData:i,getFieldsData:l}=Object(V.b)(),{isAlert:c,ruleName:u,timestamp:d,ruleId:p}=Object(S.b)(e),{euiTheme:f}=Object(s.useEuiTheme)(),g=an({ruleId:a?null:p}),b=Object(r.useMemo)((()=>g?o.a.createElement(s.EuiLink,{href:g,target:"_blank",external:!1},o.a.createElement(Hn.a,{title:u,iconType:"warning",isLink:!0,"data-test-subj":J.H})):o.a.createElement(Hn.a,{title:u,iconType:"warning","data-test-subj":J.H})),[u,g]),{refetch:y}=Object(Un.a)({scopeId:n}),h=Object(r.useMemo)((()=>{var e;return null!==(e=l(Ce.F))&&void 0!==e?e:[]}),[l]),v=Object(r.useCallback)((()=>{y(),i()}),[y,i]);return o.a.createElement(o.a.Fragment,null,o.a.createElement($n,null),o.a.createElement(s.EuiSpacer,{size:"m"}),d&&o.a.createElement(rn.c,{value:new Date(d)}),o.a.createElement(s.EuiSpacer,{size:"xs"}),c&&u?b:o.a.createElement(Hn.a,{title:m.i18n.translate("xpack.securitySolution.flyout.right.header.headerTitle",{defaultMessage:"Document details"}),iconType:"warning","data-test-subj":J.H}),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(Qn,{hasShadow:!1,hasBorder:!0,"data-test-subj":J.d,$_css:f.size.m,$_css2:f.size.s},o.a.createElement(s.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1},o.a.createElement(Yn,{$_css3:f.border.thin},o.a.createElement(zn,null)),o.a.createElement(Kn,{$_css4:f.border.thin},o.a.createElement(Vn,null)),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(Gn.a,{eventId:t,assignedUserIds:h,onAssigneesUpdated:v,isPreview:a})))))}));Wn.displayName="AlertHeaderTitle";var Qn=we()(s.EuiPanel)`
          padding: ${e=>e.$_css} ${e=>e.$_css2};
        `,Yn=we()(s.EuiFlexItem)`
              border-right: ${e=>e.$_css3};
            `,Kn=we()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem2",componentId:"sc-529dfp-0"})(["border-right:",";"],(e=>e.$_css4));const Jn=Object(r.memo)((()=>{const{dataFormattedForFieldBrowser:e,getFieldsData:t}=Object(V.b)(),{timestamp:n}=Object(S.b)(e),a=Object(ee.a)(t("event.kind")),i=Object(ee.a)(t("event.category")),l=Object(r.useMemo)((()=>{const e=m.i18n.translate("xpack.securitySolution.flyout.right.title.eventTitle",{defaultMessage:"Event details"});if("event"===a&&i){var n;const a=Le[i];return null!==(n=Object(ee.a)(t(a)))&&void 0!==n?n:e}return"alert"===a?m.i18n.translate("xpack.securitySolution.flyout.right.title.alertEventTitle",{defaultMessage:"External alert details"}):a?m.i18n.translate("xpack.securitySolution.flyout.right.title.otherEventTitle",{defaultMessage:"{eventKind} details",values:{eventKind:Object(d.startCase)(a)}}):e}),[a,t,i]);return o.a.createElement(o.a.Fragment,null,o.a.createElement($n,null),o.a.createElement(s.EuiSpacer,{size:"m"}),n&&o.a.createElement(rn.c,{value:new Date(n)}),o.a.createElement(s.EuiSpacer,{size:"xs"}),o.a.createElement(Hn.a,{title:l,iconType:"analyzeEvent","data-test-subj":J.I}))}));Jn.displayName="EventHeaderTitle";var Zn=n(305);const Xn=Object(r.memo)((({selectedTabId:e,setSelectedTabId:t,tabs:n,...a})=>{const{dataFormattedForFieldBrowser:l}=Object(V.b)(),{isAlert:c}=Object(S.b)(l),u=e=>t(e),d=Object(r.useMemo)((()=>c?{"tour-step":Object(St.c)(St.a.reviewAlertDetailsFlyout,St.b.alertsCases)}:{}),[c]),p=n.map(((t,n)=>c&&"overview"===t.id?o.a.createElement(Zn.a,{isTourAnchor:c,step:St.a.reviewAlertDetailsFlyout,tourId:St.b.alertsCases},o.a.createElement(s.EuiTab,i()({onClick:()=>u(t.id),isSelected:t.id===e,key:n,"data-test-subj":t["data-test-subj"]},d),t.name)):o.a.createElement(s.EuiTab,{onClick:()=>u(t.id),isSelected:t.id===e,key:n,"data-test-subj":t["data-test-subj"]},t.name)));return o.a.createElement(z.a,a,c?o.a.createElement(Wn,null):o.a.createElement(Jn,null),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(Fn,null,p))}));Xn.displayName="PanelHeader";const ea=({selectedTabId:e,tabs:t})=>{const n=Object(r.useMemo)((()=>{var n;return null===(n=t.find((t=>t.id===e)))||void 0===n?void 0:n.content}),[e,t]);return o.a.createElement(D.a,{"data-test-subj":W.a},n)};ea.displayName="PanelContent";var ta=n(384),na=n(285),aa=n(631),ia=n(436),ra=n(295);const oa=Object(r.memo)((()=>{const{useIsAddToCaseOpen:e}=Object(U.j)().services.cases.hooks,t=e(),{isTourShown:n}=Object(ra.b)(),{openLeftPanel:a,openRightPanel:i}=Object(c.a)(),{eventId:s,indexName:l,scopeId:u,isPreview:d,getFieldsData:p}=Object(V.b)(),m=Object(ee.a)(p("event.kind"))===te.a.signal,f=Object(ta.a)()===na.a.timeline,g=m&&!d&&!f&&!n(St.b.alertsCases)&&!t,b=Object(r.useCallback)((()=>{a({id:j.c,params:{id:s,indexName:l,scopeId:u}})}),[s,l,u,a]),y=Object(r.useCallback)((()=>{i({id:j.e,path:{tab:"overview"},params:{id:s,indexName:l,scopeId:u}})}),[s,l,u,i]),h=Object(r.useMemo)((()=>[...Object(ia.b)(),...Object(ia.a)()]),[]);return g?o.a.createElement(aa.a,{tourStepContent:h,totalSteps:5,goToOverviewTab:y,goToLeftPanel:b}):null}));oa.displayName="RightPanelTour";var sa=n(1247);const la=we()("div").withConfig({displayName:"ContainerDiv",componentId:"sc-vi2r7u-0"})([".side-panel-flyout-footer{padding:",";}"],Ve.euiThemeVars.euiPanelPaddingModifiers.paddingMedium),ca=({isPreview:e})=>{const{closeFlyout:t,openRightPanel:n}=Object(c.a)(),{eventId:a,indexName:i,dataFormattedForFieldBrowser:s,dataAsNestedObject:l,refetchFlyoutData:u,scopeId:d}=Object(V.b)(),{isHostIsolationPanelOpen:p,showHostIsolationPanel:m}=Object(k.a)(),f=Object(r.useCallback)((e=>{m(e),n({id:j.b,params:{id:a,indexName:i,scopeId:d,isolateAction:e}})}),[a,i,n,d,m]);return e?null:o.a.createElement(la,null,o.a.createElement(sa.b,{detailsData:s,detailsEcsData:l,handleOnEventClosed:t,isHostIsolationPanelOpen:p,isReadOnly:!1,loadingEventDetails:!1,onAddIsolationStatusClick:f,scopeId:d,refetchFlyoutData:u}))},ua=({getFieldsData:e,dataAsNestedObject:t})=>{const n=Object(Ue.a)({data:t,rowRenderers:Ge.b}),a=Object(ee.a)(e("event.kind")),i=a&&Pe("event.kind",a),o=Object(ee.b)(e("event.category")).some((e=>Pe("event.category",e)));return Object(r.useMemo)((()=>a===te.a.signal||(a===te.a.event?o||null!=n:i||null!=n)),[a,o,i,n])},da=Object(r.memo)((({path:e})=>{const{storage:t,telemetry:n}=Object(U.j)().services,{openRightPanel:a,closeFlyout:i}=Object(c.a)(),{eventId:s,indexName:l,scopeId:u,isPreview:d,dataAsNestedObject:p,getFieldsData:m}=Object(V.b)(),f=ua({getFieldsData:m,dataAsNestedObject:p}),{tabsDisplayed:g,selectedTabId:b}=jn({flyoutIsExpandable:f,path:e});return Object(r.useEffect)((()=>{const e=()=>{d&&i()};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[d,i]),o.a.createElement(o.a.Fragment,null,f&&o.a.createElement(oa,null),o.a.createElement(An,{flyoutIsExpandable:f}),o.a.createElement(Xn,{tabs:g,selectedTabId:b,setSelectedTabId:e=>{a({id:j.e,path:{tab:e},params:{id:s,indexName:l,scopeId:u}}),t.set(G.a.RIGHT_PANEL_SELECTED_TABS,e),n.reportDetailsFlyoutTabClicked({location:u,panel:"right",tabId:e})}}),o.a.createElement(ea,{tabs:g,selectedTabId:b}),o.a.createElement(ca,{isPreview:d}))}));da.displayName="RightPanel";var pa=n(927);const ma=`${R.a}PreviewFooter`,fa=`${ma}Link`,ga=()=>{const{eventId:e,indexName:t,scopeId:n}=Object(V.b)(),{openFlyout:a}=Object(c.a)(),{telemetry:i}=Object(U.j)().services,l=Object(r.useCallback)((()=>{a({right:{id:j.e,params:{id:e,indexName:t,scopeId:n}}}),i.reportDetailsFlyoutOpened({location:n,panel:"right"})}),[a,e,t,n,i]);return o.a.createElement(pa.a,{"data-test-subj":ma},o.a.createElement(s.EuiFlexGroup,{justifyContent:"center"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiLink,{onClick:l,target:"_blank","data-test-subj":fa},m.i18n.translate("xpack.securitySolution.flyout.preview.openFlyoutLabel",{defaultMessage:"Show full alert details"})))))};var ba=n(1395);const ya=Object(r.memo)((({path:e})=>{const{openPreviewPanel:t}=Object(c.a)(),{eventId:n,indexName:a,scopeId:i,getFieldsData:r,dataAsNestedObject:s}=Object(V.b)(),l=ua({getFieldsData:r,dataAsNestedObject:s}),{tabsDisplayed:u,selectedTabId:d}=jn({flyoutIsExpandable:l,path:e});return o.a.createElement(o.a.Fragment,null,o.a.createElement(Xn,{tabs:u,selectedTabId:d,setSelectedTabId:e=>{t({id:j.d,path:{tab:e},params:{id:n,indexName:a,scopeId:i,isPreviewMode:!0,banner:ba.a}})},style:{marginTop:"-15px"}}),o.a.createElement(ea,{tabs:u,selectedTabId:d}),o.a.createElement(ga,null))}));ya.displayName="PreviewPanel";const ha=`${R.a}AlertReasonBody`,va=Object(r.createContext)(void 0),Ea=Object(r.memo)((({id:e,indexName:t,scopeId:n,children:a})=>{const{dataAsNestedObject:i,loading:s}=Object(w.a)({eventId:e,indexName:t}),l=Object(r.useMemo)((()=>e&&t&&n&&i?{eventId:e,indexName:t,scopeId:n,dataAsNestedObject:i}:void 0),[e,t,n,i]);return s?o.a.createElement(I.a,null):l?o.a.createElement(va.Provider,{value:l},a):o.a.createElement(T.a,null)}));Ea.displayName="AlertReasonPanelProvider";const xa=$e.a.div`
  overflow-x: auto;
  padding-block: ${Ve.euiThemeVars.euiSizeS};
`,ja=$e.a.div``,Sa=()=>{const{dataAsNestedObject:e,scopeId:t}=(()=>{const e=Object(r.useContext)(va);if(!e)throw new Error("AlertReasonPanelContext can only be used within AlertReasonPanelContext provider");return e})(),n=Object(r.useMemo)((()=>Object(Ue.a)({data:e,rowRenderers:Ge.b})),[e]),a=Object(r.useMemo)((()=>n?n.renderRow({contextId:"event-details",data:e,isDraggable:!1,scopeId:t}):null),[n,e,t]);return n?o.a.createElement(s.EuiPanel,{hasShadow:!1,"data-test-subj":ha},o.a.createElement(s.EuiTitle,null,o.a.createElement("h6",null,o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.alertReason.panelTitle",defaultMessage:"Alert reason"}))),o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(xa,null,o.a.createElement(ja,{className:"eui-displayInlineBlock"},a))):o.a.createElement(s.EuiPanel,{hasShadow:!1,hasBorder:!1},o.a.createElement(T.a,null))};Sa.displayName="AlertReason";const Oa=Object(r.memo)((()=>o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceBetween",direction:"column",gutterSize:"none",style:{height:"100%"}},o.a.createElement(s.EuiFlexItem,{style:{marginTop:"-15px"}},o.a.createElement(Sa,null)))));Oa.displayName="AlertReasonPanel";const ka=Object(r.createContext)(void 0),wa=Object(r.memo)((({ruleId:e,children:t})=>{const n=Object(r.useMemo)((()=>e?{ruleId:e}:void 0),[e]);return n?o.a.createElement(ka.Provider,{value:n},t):o.a.createElement(T.a,null)}));wa.displayName="RuleOverviewPanelProvider";const Ta=()=>{const e=Object(r.useContext)(ka);if(!e)throw new Error("RuleOverviewPanelContext can only be used within RuleOverviewPanelContext provider");return e};var Ia=n(303),Ma=n(733),Ca=n(1208);const _a=`${R.a}RuleOverview`,Da=`${_a}RuleOverviewTitle`,Aa=`${Da}Suppressed`,Fa=`${_a}CreatedByText`,Na=`${_a}UpdatedByText`,Pa=`${_a}Body`,Ra=`${_a}AboutSection`,La=(X.c,X.a,`${_a}DefinitionSection`),za=(X.c,X.a,`${_a}ScheduleSection`),qa=(X.c,X.a,`${_a}ActionsSection`),Ba=(X.c,X.a,`${_a}Loading`),$a=`${_a}Footer`,Va=`${$a}LinkToRuleDetails`,Ua=({rule:e,isSuppressed:t})=>o.a.createElement("div",{"data-test-subj":Da},o.a.createElement(s.EuiTitle,null,o.a.createElement("h6",null,e.name)),t&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiBadge,{"data-test-subj":Aa,title:""},Ma.a)),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiFlexGroup,{gutterSize:"xs",direction:"column"},o.a.createElement(s.EuiFlexItem,{"data-test-subj":Fa},o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement(Ca.a,{createdBy:null==e?void 0:e.created_by,createdAt:null==e?void 0:e.created_at}))),o.a.createElement(s.EuiFlexItem,{"data-test-subj":Na},o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement(Ca.b,{updatedBy:null==e?void 0:e.updated_by,updatedAt:null==e?void 0:e.updated_at})))));Ua.displayName="RuleTitle";var Ga=n(943),Ha=n(947),Wa=n(968),Qa=n(564);const Ya=Jt.css`
  dt {
    font-size: 90% !important;
  }
  text-overflow: ellipsis;
  .euiFlexGroup {
    flex-wrap: inherit;
  }

  .euiFlexItem {
    inline-size: inherit;
    flex-basis: inherit;
  }
`,Ka=Object(r.memo)((()=>{var e,t;const{ruleId:n}=Ta(),[a,i]=Object(r.useState)(null),{rule:l,loading:c,isExistingRule:u}=Object(re.a)(null!=n?n:"");Object(r.useEffect)((()=>{null!=l&&i(l)}),[l]);const{ruleActionsData:d}=null!=a?Object(Ia.h)({rule:a,detailsView:!0}):{ruleActionsData:null},p=Boolean(null==d||null===(e=d.actions)||void 0===e?void 0:e.length),m=Boolean(null==d||null===(t=d.responseActions)||void 0===t?void 0:t.length),f=null!=d&&(p||m);return c?o.a.createElement(I.a,{"data-test-subj":Ba}):a?o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,"data-test-subj":Pa},o.a.createElement(Ua,{rule:a,isSuppressed:!u}),o.a.createElement(s.EuiHorizontalRule,{margin:"s"}),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.aboutLabel",defaultMessage:"About"}),expanded:!0,"data-test-subj":Ra},o.a.createElement(s.EuiText,{size:"s"},a.description),o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(Ga.b,{rule:a,hideName:!0,hideDescription:!0,type:"row",rowGutterSize:"s",className:Ya})),o.a.createElement(s.EuiHorizontalRule,{margin:"l"}),o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.definitionLabel",defaultMessage:"Definition"}),expanded:!1,"data-test-subj":La},o.a.createElement(Wa.a,{rule:a,type:"row",rowGutterSize:"s",className:Ya})),o.a.createElement(s.EuiHorizontalRule,{margin:"l"}),o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.scheduleLabel",defaultMessage:"Schedule"}),expanded:!1,"data-test-subj":za},o.a.createElement(Ha.a,{rule:a,type:"row",rowGutterSize:"s",className:Ya})),o.a.createElement(s.EuiHorizontalRule,{margin:"l"}),f&&o.a.createElement(X.b,{title:o.a.createElement(H.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.actionsLabel",defaultMessage:"Actions"}),expanded:!1,"data-test-subj":qa},o.a.createElement(Qa.b,{addPadding:!1,defaultValues:d}))):o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1},o.a.createElement(T.a,null))}));Ka.displayName="RuleOverview";const Ja=Object(r.memo)((()=>{const{ruleId:e}=Ta(),t=an({ruleId:e});return t?o.a.createElement(pa.a,{"data-test-subj":$a},o.a.createElement(s.EuiFlexGroup,{justifyContent:"center"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiLink,{href:t,target:"_blank","data-test-subj":Va},m.i18n.translate("xpack.securitySolution.flyout.preview.rule.viewDetailsLabel",{defaultMessage:"Show full rule details"}))))):null}));Ja.displayName="RuleFooter";const Za=Object(r.memo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(D.a,null,o.a.createElement("div",{style:{marginTop:"-15px"}},o.a.createElement(Ka,null))),o.a.createElement(Ja,null))));Za.displayName="RuleOverviewPanel";var Xa=n(1423),ei=n(1400);const ti=[{key:j.e,component:e=>o.a.createElement(V.a,e.params,o.a.createElement(da,{path:e.path}))},{key:j.c,component:e=>o.a.createElement(V.a,e.params,o.a.createElement(K.a,{path:e.path}))},{key:j.d,component:e=>o.a.createElement(V.a,e.params,o.a.createElement(ya,{path:e.path}))},{key:j.a,component:e=>o.a.createElement(Ea,e.params,o.a.createElement(Oa,null))},{key:j.f,component:e=>o.a.createElement(wa,e.params,o.a.createElement(Za,null))},{key:j.b,component:e=>o.a.createElement(C,e.params,o.a.createElement($,{path:e.path}))},{key:me.c,component:e=>o.a.createElement(me.b,e.params)},{key:Xa.b,component:e=>o.a.createElement(Xa.a,i()({},e.params,{path:e.path}))},{key:me.d,component:e=>o.a.createElement(me.b,i()({},e.params,{isPreviewMode:!0}))},{key:de.d,component:e=>o.a.createElement(de.c,e.params)},{key:ei.b,component:e=>o.a.createElement(ei.a,e.params)},{key:de.e,component:e=>o.a.createElement(de.c,i()({},e.params,{isPreviewMode:!0}))}],ni=`expandable-flyout-on-close-${na.a.securitySolution}`,ai=`expandable-flyout-on-close-${na.a.timeline}`,ii=Object(r.memo)((()=>{const e=Object(r.useCallback)((()=>window.dispatchEvent(new CustomEvent(ni,{detail:na.a.securitySolution}))),[]);return o.a.createElement(x,{registeredPanels:ti,paddingSize:"none",onClose:e})}));ii.displayName="SecuritySolutionFlyout";const ri=Object(r.memo)((()=>{const{euiTheme:e}=Object(s.useEuiTheme)(),t=Object(r.useCallback)((()=>window.dispatchEvent(new CustomEvent(ai,{detail:na.a.timeline}))),[]);return o.a.createElement(x,{registeredPanels:ti,paddingSize:"none",customStyles:{"z-index":e.levels.flyout+2},onClose:t})}));ri.displayName="TimelineFlyout"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var a=n(19),i=n(2),r=n.n(i),o=n(42),s=n(122),l=n(174),c=n(517),u=n(620),d=n(296),p=n(126),m=n(59),f=n(56),g=n(55);const b=m.euiStyled.div`
  padding-bottom: ${e=>`${e.theme.eui.euiSizeL}`};
`,y=Object(i.memo)((({dateRangePickerState:e,isDataLoading:t,onRefresh:n,onRefreshChange:o,onTimeChange:s,"data-test-subj":l})=>{const c=Object(p.a)(l),u=Object(f.useKibana)(),{uiSettings:d}=u.services,[m]=Object(i.useState)((()=>{var e,t;return null!==(e=null==d||null===(t=d.get(g.UI_SETTINGS.TIMEPICKER_QUICK_RANGES))||void 0===t?void 0:t.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n}))))&&void 0!==e?e:[]}));return r.a.createElement(b,{"data-test-subj":c("super-date-picker")},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"row",responsive:!1,gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiSuperDatePicker,{isLoading:t,dateFormat:d.get("dateFormat"),commonlyUsedRanges:m,end:e.endDate,isPaused:!e.autoRefreshOptions.enabled,onTimeChange:s,onRefreshChange:o,refreshInterval:e.autoRefreshOptions.duration,onRefresh:n,recentlyUsedRanges:e.recentlyUsedDateRanges,start:e.startDate,showUpdateButton:!1,updateButtonProps:{iconOnly:!0,fill:!1},width:"auto"}))))}));y.displayName="ActionLogDateRangePicker";var h=n(44),v=n(822);const E=Object(i.memo)((({children:e,closePopover:t,filterName:n,hasActiveFilters:o,isPopoverOpen:l,numActiveFilters:c,numFilters:u,onButtonClick:m,"data-test-subj":f})=>{const g=Object(p.a)(f),b=Object(s.a)("responseActionsSentinelOneV1Enabled"),y=Object(a.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),h=Object(i.useMemo)((()=>r.a.createElement(a.EuiFilterButton,{"data-test-subj":g(`${n}-filter-popoverButton`),iconType:"arrowDown",onClick:m,isSelected:l,numFilters:u,hasActiveFilters:o,numActiveFilters:c},"types"===n?b?d.c.types(2):d.c.types(1):d.c[n])),[n,g,o,l,b,c,u,m]);return r.a.createElement(a.EuiPopover,{button:h,closePopover:t,id:y,isOpen:l,panelPaddingSize:"none"},e)}));E.displayName="ActionsLogFilterPopover";var x=n(10),j=n(24);const S=Object(i.memo)((({color:e,status:t,"data-test-subj":n})=>r.a.createElement(a.EuiBadge,{"data-test-subj":n,color:e,title:""},t)));S.displayName="ResponseActionStatusBadge";var O=n(48),k=n(297);const w=e=>{const t={agentTypes:[],commands:[],hosts:[],statuses:[],startDate:D.startDate,endDate:D.endDate,users:[],withOutputs:[],types:[]},n=e.agentTypes?String(e.agentTypes).split(",").reduce(((e,t)=>(Object(v.b)(t)&&e.push(t),e.sort())),[]):[],a=e.commands?String(e.commands).split(",").reduce(((e,t)=>((l.e.includes(t)||"release"===t||"processes"===t)&&e.push(t),e.sort())),[]):[],i=e.hosts?String(e.hosts).split(",").sort():[],r=e.types?String(e.types).split(",").reduce(((e,t)=>(Object(v.a)(t)&&e.push(t),e.sort())),[]):[],o=e.withOutputs?String(e.withOutputs).split(",").sort():[],s=e.statuses?String(e.statuses).split(",").reduce(((e,t)=>(l.g.includes(t)&&e.push(t),e.sort())),[]):[],c=e.users?String(e.users).split(",").sort():[];return t.agentTypes=n.length?n:void 0,t.commands=a.length?a:void 0,t.hosts=i.length?i:void 0,t.statuses=s.length?s:void 0,t.startDate=e.startDate?String(e.startDate):void 0,t.endDate=e.endDate?String(e.endDate):void 0,t.users=c.length?c:void 0,t.withOutputs=o.length?o:void 0,t.types=r.length?r:void 0,t},T=()=>{const e=Object(O.useLocation)(),t=Object(O.useHistory)(),{urlParams:n,toUrlParams:a}=Object(k.a)(),r=Object(i.useMemo)((()=>w(n)),[n]),[o,s]=Object(i.useState)(r),l=Object(i.useCallback)((i=>{t.push({...e,search:a({...n,commands:i.length?i:void 0})})}),[t,e,a,n]),c=Object(i.useCallback)((i=>{t.push({...e,search:a({...n,hosts:i.length?i:void 0})})}),[t,e,a,n]),u=Object(i.useCallback)((i=>{t.push({...e,search:a({...n,withOutputs:i.length?i:void 0})})}),[t,e,a,n]),d=Object(i.useCallback)((i=>{t.push({...e,search:a({...n,statuses:i.length?i:void 0})})}),[t,e,a,n]),p=Object(i.useCallback)((({agentTypes:i,actionTypes:r})=>{t.push({...e,search:a({...n,agentTypes:i.length?i:void 0,types:r.length?r:void 0})})}),[t,e,a,n]),m=Object(i.useCallback)((i=>{t.push({...e,search:a({...n,types:i.length?i:void 0})})}),[t,e,a,n]),f=Object(i.useCallback)((i=>{t.push({...e,search:a({...n,users:i.length?i:void 0})})}),[t,e,a,n]),g=Object(i.useCallback)((({startDate:i,endDate:r})=>{t.push({...e,search:a({...n,startDate:i.length?i:void 0,endDate:r.length?r:void 0})})}),[t,e,a,n]);return Object(i.useEffect)((()=>{s((e=>({...e,...w(n)})))}),[s,n]),{...o,setUrlActionsFilters:l,setUrlDateRangeFilters:g,setUrlHostsFilters:c,setUrlWithOutputs:u,setUrlStatusesFilters:d,setUrlUsersFilters:f,setUrlTypeFilters:m,setUrlTypesFilters:p}};var I=n(47),M=n(118),C=n(167);const _=Object.freeze({default:50,all:1e4}),D=Object.freeze({autoRefreshOptions:{enabled:!1,duration:1e4},startDate:"now-24h/h",endDate:"now",recentlyUsedDateRanges:[]}),A=e=>"failed"===e?d.g.badge.failed:"successful"===e?d.g.badge.successful:"pending"===e?d.g.badge.pending:"",F=e=>"automated"===e?d.d.automated:d.d.manual,N=Object(m.euiStyled)(a.EuiButtonEmpty).attrs({iconType:"cross",color:"danger"})`
  border-top: ${e=>`${e.theme.eui.euiBorderThin}`};
  border-radius : 0;
`,P=Object(i.memo)((({"data-test-subj":e,isDisabled:t,onClick:n})=>r.a.createElement(N,{"data-test-subj":e,isDisabled:t,onClick:n},d.g.filterClearAll)));P.displayName="ClearAllButton";const R=Object(i.memo)((({filterName:e,typesFilters:t,isFlyout:n,onChangeFilterOptions:o,"data-test-subj":c})=>{const u=Object(p.a)(c),m=Object(s.a)("responseActionsSentinelOneV1Enabled"),[f,g]=Object(i.useState)(!1),b=Object(i.useCallback)((()=>{g(!f)}),[g,f]),y=Object(i.useCallback)((()=>{g(!1)}),[g]),[O,k]=Object(i.useState)(""),{areHostsSelectedOnMount:w,isLoading:D,items:N,setItems:R,hasActiveFilters:L,numActiveFilters:z,numFilters:q,setAreHostsSelectedOnMount:B,setUrlActionsFilters:$,setUrlHostsFilters:V,setUrlStatusesFilters:U,setUrlTypesFilters:G,setUrlTypeFilters:H}=(({filterName:e,isFlyout:t,searchString:n})=>{const{agentTypes:a=[],commands:o,statuses:c,hosts:u,types:p=[],setUrlActionsFilters:m,setUrlHostsFilters:f,setUrlStatusesFilters:g,setUrlTypesFilters:b,setUrlTypeFilters:y}=T(),h="statuses"===e,v="hosts"===e,E="types"===e,{data:O,isFetching:k}=(({searchString:e,selectedAgentIds:t,options:n={}})=>{const a=Object(M.i)(),i=`united.endpoint.host.hostname:${e.length?`*${e}`:""}*`;let r=[];return t&&(r=t.map((e=>`united.endpoint.agent.id:"${e}"`))),Object(I.useQuery)({queryKey:["get-endpoints-list",i],...n,queryFn:async()=>{const e=(await a.get(C.s,{version:"2023-10-31",query:{page:0,pageSize:t&&t.length>0?_.all:_.default,kuery:[...r,i].join(" or ")}})).data.reduce(((e,n)=>{const a={id:n.metadata.agent.id,name:n.metadata.host.hostname};return null!=t&&t.includes(n.metadata.agent.id)?e.selected.push({...a,selected:!0}):e.rest.push({...a,selected:!1}),e}),{selected:[],rest:[]});let n=0;return t&&(n=t.length),[...e.selected,...e.rest].slice(0,n>=_.default?n+10:_.default)}})})({searchString:n,selectedAgentIds:u}),[w,D]=Object(i.useState)(!1);Object(i.useEffect)((()=>{u&&u.length>0&&D(!0)}),[]);const N=(({isFlyout:e,agentTypes:t,types:n})=>{const a=Object(s.a)("responseActionsSentinelOneV1Enabled"),r=Object(s.a)("responseActionsCrowdstrikeManualHostIsolationEnabled"),o=Object(i.useCallback)((({key:e,label:t,checked:n})=>({key:e,label:t,isGroupLabel:!1,checked:n,"data-test-subj":"types-filter-option"})),[]),c=Object(i.useMemo)((()=>l.h.map((t=>o({key:t,label:F(t),checked:!e&&null!=n&&n.includes(t)?"on":void 0})))),[o,e,n]);return a||r?e?[{label:d.c.actionTypes,isGroupLabel:!0},...c]:[{label:d.c.agentTypes,isGroupLabel:!0},...l.d.map((n=>o({key:n,label:Object(x.n)(n),checked:!e&&null!=t&&t.includes(n)?"on":void 0}))),{label:d.c.actionTypes,isGroupLabel:!0},...c]:c})({isFlyout:t,agentTypes:a,types:p}),[P,R]=Object(i.useState)(E?N:h?l.g.map((n=>({key:n,label:r.a.createElement(S,{color:"successful"===n?"success":"failed"===n?"danger":"warning",status:A(n)}),searchableLabel:n,checked:!t&&null!=c&&c.includes(n)?"on":void 0,"data-test-subj":`${e}-filter-option`}))):v?[]:l.e.filter((e=>{const t=j.a.get();return!("upload"===e&&!t.responseActionUploadEnabled||"scan"===e&&!t.responseActionScanEnabled)})).map((n=>({key:n,label:l.f[n],checked:!t&&null!=o&&o.map((e=>l.k[e])).includes(n)?"on":void 0,"data-test-subj":`${e}-filter-option`}))));Object(i.useEffect)((()=>{v&&O&&R(null==O?void 0:O.map((n=>({key:n.id,label:n.name,checked:!t&&n.selected?"on":void 0,"data-test-subj":`${e}-filter-option`}))))}),[O,e,t,v,R]);const L=Object(i.useMemo)((()=>!!P.find((e=>"on"===e.checked))),[P]),z=Object(i.useMemo)((()=>P.filter((e=>"on"===e.checked)).length),[P]),q=Object(i.useMemo)((()=>P.filter((e=>e.key&&"on"!==e.checked)).length),[P]);return{areHostsSelectedOnMount:w,isLoading:v&&k,items:P,setItems:R,hasActiveFilters:L,numActiveFilters:z,numFilters:q,setAreHostsSelectedOnMount:D,setUrlActionsFilters:m,setUrlHostsFilters:f,setUrlStatusesFilters:g,setUrlTypeFilters:y,setUrlTypesFilters:b}})({filterName:e,isFlyout:n,searchString:O}),W=Object(i.useRef)(f);Object(i.useEffect)((()=>()=>{W.current=f}),[f,W]);const Q=Object(i.useCallback)(((t=!0)=>t&&W.current&&f&&"hosts"===e),[e,f]),Y=Object(i.useMemo)((()=>Q()||w?Object(h.orderBy)("checked","asc",N):N),[w,Q,N]),K=Object(i.useMemo)((()=>"statuses"!==e&&"types"!==e),[e]),J=Object(i.useCallback)((a=>{R(a.map((e=>e)));const i=a.reduce(((e,t)=>("on"===t.checked&&t.key&&e.push(t.key),e)),[]),r=i.reduce(((e,t)=>(Object(v.b)(t)&&e.agentTypes.push(t),Object(v.a)(t)&&e.actionTypes.push(t),e)),{actionTypes:[],agentTypes:[]});n||("actions"===e?$(i.map((e=>l.f[e])).join()):"hosts"===e?V(i.join()):"statuses"===e?U(i.join()):"types"===e&&(m?G({agentTypes:r.agentTypes.join(),actionTypes:r.actionTypes.join()}):H(i.join())),Q(!1),B(!1)),t&&void 0===o?(t.agentTypes.onChangeFilterOptions(r.agentTypes),t.actionTypes.onChangeFilterOptions(r.actionTypes)):void 0!==o&&o(i)}),[R,n,t,o,e,Q,B,$,V,U,m,G,H]),Z=Object(i.useCallback)((()=>{R(N.map((e=>(e.checked=void 0,e)))),n||("actions"===e?$(""):"hosts"===e?V(""):"statuses"===e?U(""):"types"===e&&G({agentTypes:"",actionTypes:""})),t&&void 0===o?(t.agentTypes.onChangeFilterOptions([]),t.actionTypes.onChangeFilterOptions([])):void 0!==o&&o([])}),[R,N,n,t,o,e,$,V,U,G]);return r.a.createElement(E,{closePopover:y,filterName:e,hasActiveFilters:L,isPopoverOpen:f,numActiveFilters:z,numFilters:q,onButtonClick:b,"data-test-subj":c},r.a.createElement(a.EuiSelectable,{"aria-label":`${e}`,emptyMessage:d.g.filterEmptyMessage(e),isLoading:D,onChange:J,options:Y,searchable:!!K||void 0,searchProps:{placeholder:d.g.filterSearchPlaceholder(e),compressed:!0,onChange:e=>k(e.trim())}},((t,n)=>r.a.createElement("div",{style:{width:300},"data-test-subj":u(`${e}-filter-popoverList`)},K&&r.a.createElement(a.EuiPopoverTitle,{"data-test-subj":u(`${e}-filter-search`),paddingSize:"s"},n),t,r.a.createElement(a.EuiFlexGroup,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(P,{"data-test-subj":u(`${e}-filter-clearAllButton`),isDisabled:!L,onClick:Z})))))))}));R.displayName="ActionsLogFilter";const L=Object(i.memo)((({isFlyout:e,onChangeUsersFilter:t,"data-test-subj":n})=>{const o=Object(p.a)(n),{users:s,setUrlUsersFilters:l}=T(),[c,u]=Object(i.useState)(""),m=Object(i.useCallback)((e=>{u(e.target.value)}),[u]),f=Object(i.useCallback)((()=>{const n=c.split(",").reduce(((e,t)=>(""!==t.trim()&&e.push(t.trim()),e)),[]);t(n),e||l(n.join(","))}),[e,t,c,l]),g=Object(i.useCallback)((()=>{u(""),t([]),e||l("")}),[e,t,l,u]);return Object(i.useEffect)((()=>{s&&s.length>0&&u(s.join(","))}),[]),r.a.createElement(a.EuiFormControlLayout,{clear:{onClick:g},fullWidth:!0},r.a.createElement(a.EuiFieldSearch,{"data-test-subj":o("users-filter-search"),isClearable:!0,fullWidth:!0,placeholder:d.c.users,onChange:m,onSearch:f,value:c}))}));L.displayName="ActionsLogUsersFilter";const z=Object(i.memo)((({dateRangePickerState:e,isDataLoading:t,isFlyout:n,onClick:o,onChangeAgentTypesFilter:l,onChangeHostsFilter:c,onChangeCommandsFilter:u,onChangeStatusesFilter:d,onChangeUsersFilter:m,onChangeTypeFilter:f,onRefresh:g,onRefreshChange:b,onTimeChange:h,showHostsFilter:v,"data-test-subj":E})=>{const x=Object(p.a)(E),j=Object(s.a)("endpointResponseActionsEnabled"),S=Object(s.a)("responseActionsSentinelOneV1Enabled"),O=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,v&&r.a.createElement(R,{filterName:"hosts",isFlyout:n,onChangeFilterOptions:c,"data-test-subj":E}),r.a.createElement(R,{filterName:"actions",isFlyout:n,onChangeFilterOptions:u,"data-test-subj":E}),r.a.createElement(R,{filterName:"statuses",isFlyout:n,onChangeFilterOptions:d,"data-test-subj":E}),S?j&&r.a.createElement(R,{filterName:"types",typesFilters:{agentTypes:{onChangeFilterOptions:l},actionTypes:{onChangeFilterOptions:f}},isFlyout:n,"data-test-subj":E}):j&&r.a.createElement(R,{filterName:"types",onChangeFilterOptions:f,isFlyout:n,"data-test-subj":E}))),[v,n,S,c,E,u,d,j,l,f]),k=Object(i.useCallback)((()=>o()),[o]);return r.a.createElement(a.EuiFlexGroup,{responsive:!0,gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:n?1:2},r.a.createElement(L,{isFlyout:n,onChangeUsersFilter:m,"data-test-subj":E})),r.a.createElement(a.EuiFlexItem,{grow:1},r.a.createElement(a.EuiFilterGroup,null,O)),r.a.createElement(a.EuiFlexItem,{grow:n?1:2},r.a.createElement(y,{dateRangePickerState:e,isDataLoading:t,onRefresh:g,onRefreshChange:b,onTimeChange:h,"data-test-subj":E})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiSuperUpdateButton,{iconOnly:!0,"data-test-subj":x("super-refresh-button"),fill:!1,isLoading:t,onClick:k})))}));z.displayName="ActionsLogFilters";var q=n(518),B=n(587),$=n(41),V=n.n($),U=n(4);const G=V()(a.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-9irxg1-0"})(["max-width:100%;"]),H=Object(i.memo)((({"data-test-subj":e})=>{const{docLinks:t}=Object(f.useKibana)().services;return r.a.createElement(c.a,{"data-test-subj":e},r.a.createElement(G,{iconType:"editorUnorderedList",title:r.a.createElement("h2",null,U.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.title",{defaultMessage:"Response actions history is empty"})),body:r.a.createElement("div",null,U.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.content",{defaultMessage:"No response actions performed"})),actions:[r.a.createElement(a.EuiLink,{external:!0,href:null==t?void 0:t.links.securitySolution.responseActions,target:"_blank"},U.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.link",{defaultMessage:"Read more about response actions"}))]}))}));H.displayName="ActionsLogEmptyState";var W=n(5),Q=n(194),Y=n(144),K=n(151),J=n(130),Z=n(1100),X=n(182);const ee=Object(J.e)(),te=Object(m.euiStyled)(a.EuiFacetButton).attrs({title:void 0})`
  .euiText {
    margin-top: 0.38rem;
    overflow-y: visible !important;
  }
`,ne=Object(i.memo)((({"data-test-subj":e,error:t,items:n,isFlyout:s,loading:c,onChange:u,onShowActionDetails:m,queryParams:f,showHostNames:g,totalItemCount:b})=>{const y=Object(p.a)(e),{pagination:h}=Object(q.b)(),[v,E]=Object(i.useState)({}),x=Object(i.useMemo)((()=>f.withOutputs?"string"==typeof f.withOutputs?[f.withOutputs]:f.withOutputs:[]),[f.withOutputs]),j=Object(i.useCallback)((()=>{if(x.length&&n.length){const t=x.reduce(((t,i)=>{const o=n.find((e=>e.id===i));return t[i]=o?r.a.createElement(Z.a,{action:o,"data-test-subj":e}):r.a.createElement(a.EuiSkeletonText,{size:"relative",lines:8}),t}),{});E(t)}}),[x,e,n]);Object(i.useEffect)((()=>{j()}),[j]);const O=Object(i.useCallback)((t=>{const n={...v};n[t.id]?delete n[t.id]:n[t.id]=r.a.createElement(Z.a,{action:t,"data-test-subj":e}),m(Object.keys(n)),E(n)}),[v,m,e]),k=Object(i.useCallback)((e=>()=>O(e)),[O]),w=Object(i.useMemo)((()=>({pageIndex:s?(f.page||1)-1:h.page-1,pageSize:s?f.pageSize||10:h.pageSize,totalItemCount:b,pageSizeOptions:X.f})),[s,h.page,h.pageSize,f.page,f.pageSize,b]),T=Object(i.useMemo)((()=>{var e,t;const n=null!==(e=f.page)&&void 0!==e?e:1,a=null!==(t=null==f?void 0:f.pageSize)&&void 0!==t?t:10,i=Math.ceil(b/a),r=a*n-a+1;return{fromCount:r,toCount:n===i||1===i?b:r+a-1}}),[f.page,f.pageSize,b]),I=Object(i.useMemo)((()=>r.a.createElement(a.EuiText,{color:"default",size:"xs","data-test-subj":y("endpointListTableTotal")},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.list.recordRange",defaultMessage:"Showing {range} of {total} {recordsLabel}",values:{range:r.a.createElement("strong",null,r.a.createElement(a.EuiI18nNumber,{value:T.fromCount}),"-",r.a.createElement(a.EuiI18nNumber,{value:T.toCount})),total:r.a.createElement(a.EuiI18nNumber,{value:b}),recordsLabel:r.a.createElement("strong",null,d.g.recordsLabel(b))}}))),[y,T.fromCount,T.toCount,b]),M=Object(i.useMemo)((()=>(({getTestId:e,expandedRowMap:t,showHostNames:n,onClickCallback:i})=>{const o=[{field:"startedAt",name:d.f.time,width:n?"15%":"21%",truncateText:!0,render:e=>r.a.createElement(K.a,{fieldName:d.f.time,value:e,className:"eui-textTruncate"})},{field:"command",name:d.f.command,width:n?"10%":"21%",truncateText:!0,render:t=>{const n=l.f[t];return r.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-command")},n))}},{name:d.f.user,width:n?"14%":"21%",truncateText:!0,render:({createdBy:t,ruleId:n})=>"unknown"===t&&n?r.a.createElement(a.EuiToolTip,{content:d.g.triggeredByRule,anchorClassName:"eui-textTruncate"},r.a.createElement(Y.k,{"data-test-subj":"ruleName",deepLinkId:W.Oc.rules,path:Object(Q.h)(n)},r.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-user-name")},d.g.triggeredByRule))):r.a.createElement(te,{icon:r.a.createElement(a.EuiAvatar,{"aria-hidden":!0,title:"",name:t,"data-test-subj":e("column-user-avatar"),size:"s"})},r.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-user-name")},t)))},{field:"hosts",name:d.f.hosts,width:"20%",truncateText:!0,render:t=>{const n=t&&Object.values(t),i=n.reduce(((e,t)=>(t.name.trim()&&e.push(t.name),e)),[]).join(", ");let o=i;return i||(n.length>1?o=d.g.unenrolled.hosts:1===n.length&&(o=d.g.unenrolled.host)),r.a.createElement(a.EuiToolTip,{content:o,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-hostname")},o))}},{field:"comment",name:d.f.comments,width:n?"30%":"21%",truncateText:!0,render:t=>r.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":e("column-comments")},null!=t?t:ee))},{field:"status",name:d.f.status,width:n?"10%":"15%",render:t=>{const n=A(t);return r.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate"},r.a.createElement(S,{color:"failed"===t?"danger":"successful"===t?"success":"warning","data-test-subj":e("column-status"),status:n}))}},{field:"",align:a.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:r.a.createElement(a.EuiScreenReaderOnly,null,r.a.createElement("span",null,d.g.screenReaderExpand)),render:n=>{const o=n.id;return r.a.createElement(a.EuiButtonIcon,{"data-test-subj":e("expand-button"),onClick:i(n),"aria-label":t[o]?d.a.collapse:d.a.expand,iconType:t[o]?"arrowUp":"arrowDown"})}}];return n?o:o.filter((e=>"hosts"!==e.field))})({getTestId:y,expandedRowMap:v,onClickCallback:k,showHostNames:g})),[v,y,k,g]);return r.a.createElement(r.a.Fragment,null,I,r.a.createElement(a.EuiHorizontalRule,{margin:"xs"}),r.a.createElement(a.EuiBasicTable,{"data-test-subj":e,items:n,columns:M,itemId:"id",itemIdToExpandedRowMap:v,pagination:w,onChange:u,loading:c,error:t}))}));ne.displayName="ActionsLogTable";const ae=Object(i.memo)((({agentIds:e,showHostNames:t=!1,isFlyout:n=!0,setIsDataInResponse:m,"data-test-subj":f="response-actions-list"})=>{var g,b;const{pagination:y,setPagination:h}=Object(q.b)(),{agentTypes:v,commands:E,hosts:x,statuses:j,users:S,types:O,withOutputs:k,setUrlWithOutputs:w}=T(),I=Object(p.a)(f),M=Object(s.a)("responseActionsSentinelOneV1Enabled"),C=Object(s.a)("responseActionsCrowdstrikeManualHostIsolationEnabled"),[_,A]=Object(i.useState)(!0),[F,N]=Object(i.useState)({page:n?1:y.page,pageSize:n?10:y.pageSize,agentIds:n?e:null!=x&&x.length?x:e,agentTypes:[],commands:[],statuses:[],userIds:[],withOutputs:[],types:[]});Object(i.useEffect)((()=>{n||N((e=>({...e,agentTypes:M||C?null!=v&&v.length?v:e.agentTypes:[],commands:null!=E&&E.length?E.map((e=>l.k[e])):e.commands,hosts:null!=x&&x.length?x:e.agentIds,statuses:null!=j&&j.length?j:e.statuses,userIds:null!=S&&S.length?S:e.userIds,withOutputs:null!=k&&k.length?k:e.withOutputs,types:null!=O&&O.length?O:e.types})))}),[O,v,E,x,n,C,M,j,N,S,k]);const{dateRangePickerState:P,onRefreshChange:R,onTimeChange:L}=(e=>{const{setUrlDateRangeFilters:t,startDate:n,endDate:a}=T(),[r,o]=Object(i.useState)({...D,startDate:e?D.startDate:null!=n?n:D.startDate,endDate:e?D.endDate:null!=a?a:D.endDate}),s=Object(i.useCallback)((({start:e,end:t})=>{o((n=>({...n,startDate:e,endDate:t})))}),[o]),l=Object(i.useCallback)((e=>{o((t=>({...t,recentlyUsedDateRanges:e})))}),[o]),c=Object(i.useCallback)((e=>{o((t=>({...t,autoRefreshOptions:{enabled:!e.isPaused,duration:e.refreshInterval}})))}),[o]),u=Object(i.useCallback)((({start:n,end:a})=>{s({start:n,end:a});const i=[{start:n,end:a},...r.recentlyUsedDateRanges.filter((e=>!(e.start===n&&e.end===a))).slice(0,9)];l(i),e||t({startDate:n,endDate:a})}),[r.recentlyUsedDateRanges,e,t,s,l]);return{dateRangePickerState:r,onRefreshChange:c,onTimeChange:u}})(n),{error:$,data:V,isFetching:U,isFetched:G,refetch:W}=Object(u.b)({...F,startDate:P.startDate,endDate:P.endDate},{retry:!1}),Q=Object(i.useMemo)((()=>{var e;return null!==(e=null==V?void 0:V.total)&&void 0!==e?e:0}),[V]),Y=Object(i.useMemo)((()=>{var e;return null!==(e=null==V?void 0:V.data)&&void 0!==e?e:[]}),[null==V?void 0:V.data]);Object(i.useEffect)((()=>{var e,t;U||404!==(null==$||null===(e=$.body)||void 0===e?void 0:e.statusCode)||"index_not_found_exception"!==(null==$||null===(t=$.body)||void 0===t?void 0:t.message)?!U&&V&&(A(!1),m&&m(!0)):m&&m(!1)}),[V,$,U,m]);const K=Object(i.useCallback)((()=>{P.autoRefreshOptions.enabled&&W()}),[P.autoRefreshOptions.enabled,W]),J=Object(i.useCallback)((e=>{N((t=>({...t,commands:e})))}),[N]),Z=Object(i.useCallback)((e=>{N((t=>({...t,statuses:e})))}),[N]),X=Object(i.useCallback)((e=>{N((t=>({...t,agentTypes:e})))}),[N]),ee=Object(i.useCallback)((e=>{N((t=>({...t,types:e})))}),[N]),te=Object(i.useCallback)((e=>{N((t=>({...t,agentIds:e})))}),[N]),ae=Object(i.useCallback)((e=>{N((t=>({...t,userIds:e})))}),[N]),ie=Object(i.useCallback)((({page:e})=>{const{index:t,size:a}=e,i={page:t+1,pageSize:a};N((e=>({...e,...i}))),n||h({...i}),W()}),[n,W,N,h]),re=Object(i.useCallback)((e=>{N((t=>({...t,withOutputs:e}))),n||w(e.join())}),[n,w,N]);return 404===(null==$||null===(g=$.body)||void 0===g?void 0:g.statusCode)&&"index_not_found_exception"===(null==$||null===(b=$.body)||void 0===b?void 0:b.message)?r.a.createElement(H,{"data-test-subj":I("empty-state")}):U&&_?r.a.createElement(B.a,{"data-test-subj":I("global-loader")}):r.a.createElement(r.a.Fragment,null,r.a.createElement(z,{isFlyout:n,dateRangePickerState:P,isDataLoading:U,onClick:W,onChangeHostsFilter:te,onChangeCommandsFilter:J,onChangeStatusesFilter:Z,onChangeUsersFilter:ae,onChangeAgentTypesFilter:X,onChangeTypeFilter:ee,onRefresh:K,onRefreshChange:R,onTimeChange:L,showHostsFilter:t,"data-test-subj":f}),G&&!Q?r.a.createElement(c.a,null,r.a.createElement(a.EuiFlexItem,{"data-test-subj":I("empty-prompt")},r.a.createElement(a.EuiEmptyPrompt,{iconType:"editorUnorderedList",titleSize:"s",title:r.a.createElement("h2",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.title",defaultMessage:"No results match your search criteria"})),body:r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.body",defaultMessage:"Try modifying your search or filter set"})),"data-test-subj":"responseActions-empty"}))):r.a.createElement(ne,{"data-test-subj":f,error:null!==$?d.g.fetchError:void 0,items:Y,isFlyout:n,loading:U,onChange:ie,onShowActionDetails:re,queryParams:F,showHostNames:t,totalItemCount:Q}))}));ae.displayName="ResponseActionsLog"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(168);const i=a.q,r=a.r,o=({namespaceType:e})=>e.map((e=>(({namespaceType:e})=>"agnostic"===e?r:i)({namespaceType:e})))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(46),i=n(456),r=n(275),o=n(400),s=n(397),l=n(398),c=n(214),u=n(457),d=n(401),p=n(402),m=n(255),f=n(399),g=n(506),b=n(507),y=n(345),h=n(1281),v=n(796);const E=n(1371).a;a.union([E,a[void 0]]);var x=n(574),j=n(1284);const S=a.exact(a.type({_version:y.b,comments:h.b,created_at:s.a,created_by:l.a,description:f.a,entries:v.a,expire_time:j.a,id:c.a,item_id:E,list_id:m.a,meta:r.b,name:o.a,namespace_type:i.a,os_types:g.b,tags:b.a,tie_breaker_id:u.a,type:x.a,updated_at:d.a,updated_by:p.a}))},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);const i=e=>e.groups.some((e=>a.Zb.includes(e)))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return m}));var a=n(748),i=n(813);a.s;const r=`${a.k}.building_block_type`,o=`${a.k}.evaluation.threshold`,s=`${a.k}.evaluation.value`,l=`${a.k}.context`,c=`${a.k}.evaluation.values`,u=`${a.k}.group`,d=`${u}.field`,p=`${u}.value`,m=`${a.s}.exceptions_list`;a.s,a.I,a.k,a.s,i.D,i.F,i.E,i.G,a.K,a.a,a.d,a.e,a.f,a.j,a.h,a.o,a.u,a.m,i.a,a.b,i.b,i.c,i.d,i.e,i.f,a.q,i.g,i.h,i.i,a.r,i.j,a.t,i.k,i.l,i.m,a.w,i.n,i.o,a.x,i.p,i.q,i.r,a.A,a.C,i.s,a.B,i.z,a.E,a.F,i.A,a.G,a.H,i.C,a.y,a.n,i.x,i.v,i.y,i.w,i.u,i.t,a.J,a.L},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(50);const i=e=>null!=e.id?e:{...e,id:Object(a.v4)()},r=e=>{const t=e;if(null!=t.id){const{id:e,...n}=t;return n}return e}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n(48),r=n(21),o=n(127),s=n(132),l=n(118);const c=()=>{const{indicesExist:e,dataViewId:t}=Object(s.a)(o.SourcererScopeName.timeline),n=Object(l.j)().services.application.capabilities.siem.show,c=Object(a.useMemo)((()=>n&&(e||null===t)),[e,t,n]);return Object(a.useCallback)((e=>{return!!c&&(t=e,!Object(r.c)().map((e=>e.path)).find((e=>Object(i.matchPath)(t,e))));var t}),[c])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",SLO:"slo",SIEM:"siem",UPTIME:"uptime",ML:"ml",STACK_ALERTS:"stackAlerts",EXAMPLE:"AlertingExample",MONITORING:"monitoring"};Object.values(a).map((e=>e))},,,,,,,,function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return c}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.users.pageTitle",{defaultMessage:"Users"}),r=a.i18n.translate("xpack.securitySolution.users.navigation.allUsersTitle",{defaultMessage:"All users"}),o=a.i18n.translate("xpack.securitySolution.users.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),s=a.i18n.translate("xpack.securitySolution.users.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),l=a.i18n.translate("xpack.securitySolution.users.navigation.riskTitle",{defaultMessage:"User risk"}),c=a.i18n.translate("xpack.securitySolution.users.navigation.eventsTitle",{defaultMessage:"Events"});a.i18n.translate("xpack.securitySolution.users.navigation.userScoreOverTimeTitle",{defaultMessage:"User risk score over time"})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(47),i=(n(2),n(118));const r=["POST","/api/ml/jobs/jobs_summary"],o=(e,t)=>Object(a.useQuery)([r,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>i.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o}));const a=({anonymizationFields:e,field:t})=>{var n,a;return null!==(n=null===(a=e.find((e=>e.field===t)))||void 0===a?void 0:a.allowed)&&void 0!==n&&n},i=({anonymizationFields:e,field:t})=>{var n,a;return!(null!==(n=null===(a=e.find((e=>e.field===t)))||void 0===a?void 0:a.allowed)&&void 0!==n&&n)},r=({anonymizationFields:e,field:t})=>{var n,a;return null!==(n=null===(a=e.find((e=>e.field===t)))||void 0===a?void 0:a.anonymized)&&void 0!==n&&n},o=({messageContent:e,replacements:t})=>null!=t?Object.keys(t).reduce(((e,n)=>{const a=t[n];return e.replaceAll(n,a)}),e):e},,,,,,,,function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDMwNC45OTggMzA0Ljk5OCI+PHBhdGggZD0iTTI3NC42NTkgMjQ0Ljg4OGMtOC45NDQtMy42NjMtMTIuNzctOC41MjQtMTIuNC0xNS43NzcuMzgxLTguNDY2LTQuNDIyLTE0LjY2Ny02LjcwMy0xNy4xMTcgMS4zNzgtNS4yNjQgNS40MDUtMjMuNDc0LjAwNC0zOS4yOTEtNS44MDQtMTYuOTMtMjMuNTI0LTQyLjc4Ny00MS44MDgtNjguMjA0LTcuNDg1LTEwLjQzOC03LjgzOS0yMS43ODQtOC4yNDgtMzQuOTIyLS4zOTItMTIuNTMxLS44MzQtMjYuNzM1LTcuODIyLTQyLjUyNUMxOTAuMDg0IDkuODU5IDE3NC44MzggMCAxNTUuODUxIDBjLTExLjI5NSAwLTIyLjg4OSAzLjUzLTMxLjgxMSA5LjY4NC0xOC4yNyAxMi42MDktMTUuODU1IDQwLjEtMTQuMjU3IDU4LjI5MS4yMTkgMi40OTEuNDI1IDQuODQ0LjU0NSA2Ljg1MyAxLjA2NCAxNy44MTYuMDk2IDI3LjIwNi0xLjE3IDMwLjA2LS44MTkgMS44NjUtNC44NTEgNy4xNzMtOS4xMTggMTIuNzkzLTQuNDEzIDUuODEyLTkuNDE2IDEyLjQtMTMuNTE3IDE4LjUzOS00Ljg5MyA3LjM4Ny04Ljg0MyAxOC42NzgtMTIuNjYzIDI5LjU5Ny0yLjc5NSA3Ljk5LTUuNDM1IDE1LjUzNy04LjAwNSAyMC4wNDdhMjcuMjk2IDI3LjI5NiAwIDAwLTIuNjQ3IDIwLjUwNWMtMS44NDQgMS4yODEtNC41MDggMy44MDMtNi43NTcgOC41NTctMi43MTggNS44LTguMjMzIDguOTE3LTE5LjcwMSAxMS4xMjItNS4yNyAxLjA3OC04LjkwNCAzLjI5NC0xMC44MDQgNi41ODYtMi43NjUgNC43OTEtMS4yNTkgMTAuODExLjExNSAxNC45MjUgMi4wMyA2LjA0OC43NjUgOS44NzYtMS41MzUgMTYuODI2LS41MyAxLjYwNC0xLjEzMSAzLjQyLTEuNzQgNS40MjMtLjk1OSAzLjE2MS0uNjEzIDYuMDM1IDEuMDI2IDguNTQyIDQuMzMxIDYuNjIxIDE2Ljk2OSA4Ljk1NiAyOS45NzkgMTAuNDkyIDcuNzY4LjkyMiAxNi4yNyA0LjAyOSAyNC40OTMgNy4wMzUgOC4wNTcgMi45NDQgMTYuMzg4IDUuOTg5IDIzLjk2MSA2LjkxMyAxLjE1MS4xNDUgMi4yOTEuMjE4IDMuMzkuMjE4IDExLjQzNCAwIDE2LjYtNy41ODcgMTguMjM4LTEwLjcwNCA0LjEwNy0uODM4IDE4LjI3Mi0zLjUyMiAzMi44NzEtMy44ODIgMTQuNTc2LS40MTYgMjguNjc5IDIuNDYyIDMyLjY3NCAzLjM1NyAxLjI1NiAyLjQwNCA0LjU2NyA3Ljg5NSA5Ljg0NSAxMC43MjQgMi45MDEgMS41ODYgNi45MzggMi40OTUgMTEuMDczIDIuNDk1aC4wMDFjNC40MTYgMCAxMi44MTctMS4wNDQgMTkuNDY2LTguMDM5IDYuNjMyLTcuMDI4IDIzLjIwMi0xNiAzNS4zMDItMjIuNTUxYTcxNy44NyA3MTcuODcgMCAwMDcuNDQxLTQuMDY1YzYuNzk3LTMuNzY4IDEwLjUwNi05LjE1MiAxMC4xNzUtMTQuNzcxLS4yNzYtNC42NjctMy4zNjUtOC43NjEtOC4wNjItMTAuNjg0em0tMTUwLjQ3LTEuMzUzYy0uODQ2LTUuOTYtOC41MTMtMTEuODcxLTE3LjM5Mi0xOC43MTUtNy4yNi01LjU5Ny0xNS40ODktMTEuOTQtMTcuNzU2LTE3LjMxMi00LjY4NS0xMS4wODItLjk5Mi0zMC41NjggNS40NDctNDAuNjAyIDMuMTgyLTUuMDI0IDUuNzgxLTEyLjY0MyA4LjI5NS0yMC4wMTEgMi43MTQtNy45NTYgNS41MjEtMTYuMTgyIDguNjYtMTkuNzgzIDQuOTcxLTUuNjIyIDkuNTY1LTE2LjU2MSAxMC4zNzktMjUuMTgyIDQuNjU1IDQuNDQ0IDExLjg3NiAxMC4wODMgMTguNTQ3IDEwLjA4MyAxLjAyNyAwIDIuMDI0LS4xMzQgMi45NzctLjQwMyA0LjU2NC0xLjMxOCAxMS4yNzctNS4xOTcgMTcuNzY5LTguOTQ3IDUuNTk3LTMuMjM0IDEyLjQ5OS03LjIyMiAxNS4wOTYtNy41ODUgNC40NTMgNi4zOTQgMzAuMzI4IDYzLjY1NSAzMi45NzIgODIuMDQ0IDIuMDkyIDE0LjU1LS4xMTggMjYuNTc4LTEuMjI5IDMxLjI4OWEyMy4wMTcgMjMuMDE3IDAgMDAtMy4wOC0uMjIxYy03LjIwNyAwLTkuMTE1IDMuOTM0LTkuNjEyIDYuMjgzLTEuMjc4IDYuMTAzLTEuNDEzIDI1LjYxOC0xLjQyNyAzMC4wMDMtMi42MDYgMy4zMTEtMTUuNzg1IDE4LjkwMy0zNC43MDYgMjEuNzA2LTcuNzA3IDEuMTItMTQuOTA0IDEuNjg4LTIxLjM5IDEuNjg4LTUuNTQ0IDAtOS4wODItLjQyOC0xMC41NTEtLjY1MWwtOS41MDgtMTAuODc5YzMuNzQ5LTEuODUxIDcuNDk3LTUuNzU3IDYuNTA5LTEyLjgwNXptMTIuMDY1LTE3OS4zODZjLS4yOTcuMTI4LS41ODkuMjY1LS44NzYuNDExYTE3LjcxMyAxNy43MTMgMCAwMC0uMTk5LTEuOTUyYy0xLjAzOC01Ljk3NS01LTEwLjMxMi05LjQxOS0xMC4zMTItLjMyNyAwLS42NTYuMDI1LTEuMDE3LjA4LTIuNjI5LjQzOC00LjY5MSAyLjQxMy01LjgyMSA1LjIxMy45OTEtNi4xNDQgNC40NzItMTAuNjkzIDguNjAyLTEwLjY5MyA0Ljg1IDAgOC45NDcgNi41MzYgOC45NDcgMTQuMjcyIDAgLjk3NS0uMDcxIDEuOTQ1LS4yMTcgMi45ODF6bTM3LjY4NiA0LjYwN2MuNDQ0LTEuNDE0LjY4NC0yLjk0NC42ODQtNC41MzIgMC03LjAxNC00LjQ1LTEyLjUwOS0xMC4xMzEtMTIuNTA5LTUuNTUyIDAtMTAuMDY5IDUuNjExLTEwLjA2OSAxMi41MDkgMCAuNDcuMDIzLjk0MS4wNjcgMS40MTFsLS44NjEtLjMyOWExOS4xMjUgMTkuMTI1IDAgMDEtLjk2Mi02LjAxNWMwLTguMzg3IDUuMzYtMTUuMjExIDExLjk1LTE1LjIxMSA2LjU4OSAwIDExLjk1IDYuODI0IDExLjk1IDE1LjIxMSAwIDMuNDg5LS45NjMgNi44MTktMi42MjggOS40NjV6bS00Ljg1OSAxNi4zMjRjLS4wOTUuNDI0LS4yOTcuNjEyLTIuNTMxIDEuNzc0LTEuMTI4LjU4Ny0yLjUzMiAxLjMxOC00LjI4OSAyLjM4OGwtMS4xNzQuNzExYy00LjcxOCAyLjg2LTE1Ljc2NSA5LjU1OS0xOC43NjQgOS45NTItMi4wMzcuMjc0LTMuMjk3LS41MTYtNi4xMy0yLjQ0MWE4OC40NDEgODguNDQxIDAgMDAtMi4wNDQtMS4zNjJjLTUuMTA3LTMuMzUxLTguMzkyLTcuMDQyLTguNzYzLTguNDg1IDEuNjY1LTEuMjg3IDUuNzkyLTQuNTA4IDcuOTA1LTYuNDE1IDQuMjg5LTMuOTg4IDguNjA1LTYuNjY4IDEwLjc0MS02LjY2OC4xMTMgMCAuMjE1LjAwOC4zMjEuMDI4IDIuNTEuNDQzIDguNzAxIDIuOTE0IDEzLjIyMyA0LjcxOCAyLjA5LjgzNCAzLjg5NSAxLjU1NCA1LjE2NSAyLjAxIDQuMDAxIDEuMzc0IDYuMDg3IDMuMTMyIDYuMzQgMy43OXptMzUuOTQ3IDE4Ni4zN2MyLjI1Ny0xMC4xODEgNC44NTctMjQuMDMxIDQuNDM2LTMyLjE5Ni0uMDk3LTEuODU1LS4yNjEtMy44NzQtLjQyLTUuODI2LS4yOTctMy42NS0uNzM4LTkuMDc1LS4yODMtMTAuNjg0LjA5LS4wNDIuMTktLjA3OC4zMDEtLjEwOS4wMTkgNC42NjggMS4wMzMgMTMuOTc5IDguNDc5IDE3LjIyNiAyLjIxOS45NjggNC43NTUgMS40NTggNy41MzcgMS40NTggNy40NTkgMCAxNS43MzUtMy42NTkgMTkuMTI1LTcuMDQ5IDEuOTk2LTEuOTk2IDMuNjc1LTQuNDM4IDQuODUxLTYuMzcyLjI1Ny43NTMuNDE1IDEuNzM3LjMzMiAzLjAwNS0uNDQzIDYuODg1IDIuOTAzIDE2LjAxOSA5LjI3MSAxOS4zODVsLjkyNy40ODdjMi4yNjggMS4xOSA4LjI5MiA0LjM1MyA4LjM4OSA1Ljg1My0uMDAxLjAwMS0uMDUxLjE3Ny0uMzg3LjQ4OS0xLjUwOSAxLjM3OS02LjgyIDQuMDkxLTExLjk1NiA2LjcxNC05LjExMSA0LjY1Mi0xOS40MzggOS45MjUtMjQuMDc2IDE0LjgwMy02LjUzIDYuODcyLTEzLjkxNiAxMS40ODgtMTguMzc2IDExLjQ4OGE0LjgzIDQuODMgMCAwMS0xLjQ2MS0uMjA2Yy00Ljg0NC0xLjUxLTguODMxLTguNDk5LTYuNjg5LTE4LjQ2NnpNMzkuOTE3IDI0NS40NzdjLS40OTQtMi4zMTItLjg4NC00LjEzNy0uNDY1LTUuOTA1LjMwNC0xLjMxIDYuNzcxLTIuNzE0IDkuNTMzLTMuMzEzIDMuODgzLS44NDMgNy44OTktMS43MTQgMTAuNTI1LTMuMzA4IDMuNTUxLTIuMTUxIDUuNDc0LTYuMTE4IDcuMTctOS42MTggMS4yMjgtMi41MzEgMi40OTYtNS4xNDggNC4wMDUtNi4wMDcuMDg1LS4wNS4yMTUtLjEwOC40NjMtLjEwOCAyLjgyNyAwIDguNzU5IDUuOTQzIDEyLjE3NyAxMS4yNjIuODY3IDEuMzQxIDIuNDczIDQuMDI4IDQuMzMxIDcuMTM5IDUuNTU3IDkuMjk4IDEzLjE2NiAyMi4wMzMgMTcuMTQgMjYuMzAxIDMuNTgxIDMuODM3IDkuMzc4IDExLjIxNCA3Ljk1MiAxNy41NDEtMS4wNDQgNC45MDktNi42MDIgOC45MDEtNy45MTMgOS43ODQtLjQ3Ni4xMDgtMS4wNjUuMTYzLTEuNzU4LjE2My03LjYwNiAwLTIyLjY2Mi02LjMyOC0zMC43NTEtOS43MjhsLTEuMTk3LS41MDNjLTQuNTE3LTEuODk0LTExLjg5MS0zLjA4Ny0xOS4wMjItNC4yNDEtNS42NzQtLjkxOS0xMy40NDQtMi4xNzYtMTQuNzMyLTMuMzEyLTEuMDQ0LTEuMTcxLjE2Ny00Ljk3OCAxLjIzNS04LjMzNy43NjktMi40MTQgMS41NjMtNC45MSAxLjk5OC03LjUyMy42MTctNC4xNjgtLjEwOS03LjU2MS0uNjkxLTEwLjI4N3oiLz48L3N2Zz4K"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgdmlld0JveD0iMCAwIDY0MCA2NDAiPjxwYXRoIGQ9Ik0uMiAyOTguNjY5TDAgOTAuNjE1bDI1Ni4wMDctMzQuNzZ2MjQyLjgxNEguMjAxek0yOTguNjU4IDQ5LjY1NEw2MzkuOTA1LS4wMTJ2Mjk4LjY4MUgyOTguNjU3VjQ5LjY1NHpNNjQwIDM0MS4zMzFsLS4wNzEgMjk4LjY4MUwyOTguNjY5IDU5MlYzNDEuMzMyaDM0MS4zM3pNMjU1Ljk4MyA1ODYuNTQzTC4xODkgNTUxLjQ2M3YtMjEwLjE4aDI1NS43OTR2MjQ1LjI2eiIvPjwvc3ZnPgo="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgdmlld0JveD0iMCAwIDY0MCA2NDAiPjxwYXRoIGQ9Ik00OTQuNzgyIDM0MC4wMmMtLjgwMy04MS4wMjUgNjYuMDg0LTExOS45MDcgNjkuMDcyLTEyMS44MzItMzcuNTk1LTU0Ljk5My05Ni4xNjctNjIuNTUyLTExNy4wMzctNjMuNDAyLTQ5Ljg0My01LjAzMi05Ny4yNDIgMjkuMzYyLTEyMi41NjUgMjkuMzYyLTI1LjI1MyAwLTY0LjI3Ny0yOC42MDctMTA1LjYwNC0yNy44NS01NC4zMi44MDMtMTA0LjQgMzEuNTk0LTEzMi40MDMgODAuMjQ1QzI5LjgxIDMzNC40NTcgNzEuODEgNDc5LjU4IDEyNi44MTYgNTU4Ljk3NmMyNi44NyAzOC44ODIgNTguOTE0IDgyLjU2IDEwMC45OTcgODEgNDAuNTEyLTEuNTk0IDU1Ljg0My0yNi4yNDQgMTA0Ljg0OC0yNi4yNDQgNDguOTkzIDAgNjIuNzUzIDI2LjI0NSAxMDUuNjQgMjUuNDA2IDQzLjYwNi0uODAzIDcxLjIzMi0zOS42MzggOTcuOTI1LTc4LjY1IDMwLjg4Ny00NS4xMiA0My41NDgtODguNzUgNDQuMzE2LTkwLjk5NC0uOTY5LS40MzctODUuMDI5LTMyLjYzNC04NS44NzktMTI5LjQzOWwuMTE4LS4wMzV6TTQxNC4yMyAxMDIuMTc4QzQzNi41NTMgNzUuMDk1IDQ1MS42MzYgMzcuNSA0NDcuNTE0LS4wMjRjLTMyLjE2MiAxLjMxMS03MS4xNjMgMjEuNDM3LTk0LjI1MyA0OC40ODUtMjAuNzI5IDI0LjAxMi0zOC44MzYgNjIuMjgtMzMuOTkzIDk5LjAzNiAzNS45MTggMi44IDcyLjU5MS0xOC4yNDggOTQuOTI2LTQ1LjI3MmwuMDM2LS4wNDd6Ii8+PC9zdmc+Cg=="},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.query="query",e.graph="graph",e.notes="notes",e.pinned="pinned",e.eql="eql",e.session="session",e}({})},,,,function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.hosts.pageTitle",{defaultMessage:"Hosts"}),r=a.i18n.translate("xpack.securitySolution.hosts.navigation.allHostsTitle",{defaultMessage:"All hosts"}),o=a.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),s=a.i18n.translate("xpack.securitySolution.hosts.navigation.uncommonProcessesTitle",{defaultMessage:"Uncommon processes"}),l=a.i18n.translate("xpack.securitySolution.hosts.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),c=a.i18n.translate("xpack.securitySolution.hosts.navigation.eventsTitle",{defaultMessage:"Events"}),u=a.i18n.translate("xpack.securitySolution.hosts.navigation.hostRiskTitle",{defaultMessage:"Host risk"}),d=a.i18n.translate("xpack.securitySolution.hosts.navigation.sessionsTitle",{defaultMessage:"Sessions"});a.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingEventsData",{defaultMessage:"Failed to query events data"})},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.network.pageTitle",{defaultMessage:"Network"}),r=a.i18n.translate("xpack.securitySolution.network.navigation.flowsTitle",{defaultMessage:"Flows"}),o=a.i18n.translate("xpack.securitySolution.network.navigation.dnsTitle",{defaultMessage:"DNS"}),s=a.i18n.translate("xpack.securitySolution.network.navigation.usersTitle",{defaultMessage:"Users"}),l=a.i18n.translate("xpack.securitySolution.network.navigation.tlsTitle",{defaultMessage:"TLS"}),c=a.i18n.translate("xpack.securitySolution.network.navigation.httpTitle",{defaultMessage:"HTTP"}),u=a.i18n.translate("xpack.securitySolution.network.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),d=a.i18n.translate("xpack.securitySolution.network.navigation.eventsTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";var a=n(975);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"j",(function(){return a.g})),n.d(t,"k",(function(){return a.i}));var i=n(1196);n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return i.b})),n.d(t,"e",(function(){return i.c})),n.d(t,"f",(function(){return i.d})),n.d(t,"g",(function(){return i.e})),n.d(t,"h",(function(){return i.f})),n.d(t,"i",(function(){return i.g}))},function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},function(e,t,n){e.exports=n.p+"1cbd62546f764080f7071e03889e9de3.svg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(46),i=n(1448),r=n(399),o=n(752),s=n(400),l=n(574),c=n(1256),u=n(275),d=n(891),p=n(506),m=n(507),f=n(1284);const g=a.intersection([a.exact(a.type({description:r.a,entries:o.a,name:s.a,type:l.a})),a.exact(a.partial({comments:c.a,item_id:i.a,list_id:a[void 0],meta:u.a,namespace_type:d.b,os_types:p.c,tags:m.a,expire_time:f.a}))])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(46),i=n(50),r=n(1371);const o=new a.Type("DefaultUuid",a.string.is,((e,t)=>null==e?a.success(Object(i.v4)()):r.a.validate(e,t)),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(120);function i(e){return a.preprocess((e=>"string"==typeof e?""===e?[]:e.split(","):e),a.array(e))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(43);const o=()=>Object(r.jsx)(a.Fragment,null),s=i.a.lazy((()=>n.e(56).then(n.bind(null,1413)))),l=function(e){return Object(r.jsx)(i.a.Suspense,{fallback:Object(r.jsx)(o,null)},Object(r.jsx)(s,e))}},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e&&e.trim().length!==e.length},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(4),i=n(233),r=n(3);async function o({esqlQuery:e,search:t,signal:n}){try{var o;const s=await async function({esqlQuery:e,search:t,signal:n}){try{var i;return null!==(i=(await Object(r.lastValueFrom)(t({params:{query:`${e} | limit 0`}},{abortSignal:n,strategy:"esql_async"}))).rawResponse.columns)&&void 0!==i?i:[]}catch(e){throw new Error(a.i18n.translate("esqlUtils.columnsErrorMsg",{defaultMessage:"Unable to load columns. {errorMessage}",values:{errorMessage:e.message}}))}}({esqlQuery:e,search:t,signal:n});return null!==(o=s.map((({name:e,type:t})=>({id:e,name:e,meta:{type:Object(i.d)(t),esType:t}}))))&&void 0!==o?o:[]}catch(e){throw new Error(a.i18n.translate("esqlUtils.columnsErrorMsg",{defaultMessage:"Unable to load columns. {errorMessage}",values:{errorMessage:e.message}}))}}async function s({esqlQuery:e,search:t,signal:n,filter:a,dropNullColumns:i}){const o=await Object(r.lastValueFrom)(t({params:{...a?{filter:a}:{},query:e,...i?{dropNullColumns:!0}:{}}},{abortSignal:n,strategy:"esql_async"}));return{response:o.rawResponse,params:o.requestParams}}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Oe})),n.d(t,"b",(function(){return Ie}));var a=n(2),i=n.n(a),r=n(52),o=n.n(r),s=n(42),l=n(3),c=n(8),u=n.n(c),d=(n(1088),n(19)),p=n(360),m=n(53);var f=n(480),g=n(55),b=n(1093);const y=(e,t)=>t?JSON.stringify(e):JSON.stringify(e,null,2),h=Object(g.createEscapeValue)({separator:",",quoteValues:!0,escapeFormulaValues:!0}),v=e=>h(e);var E=n(7),x=n(225),j=n(860),S=n(4),O=n(79),k=n(301),w=n(43);const T=({children:e})=>Object(w.jsx)("span",{className:"unifiedDataTable__rowControl"},e),I=S.i18n.translate("unifiedDataTable.copyEscapedValueWithFormulasToClipboardWarningText",{defaultMessage:"Values may contain formulas that are escaped."}),M=S.i18n.translate("unifiedDataTable.copyFailedErrorText",{defaultMessage:"Unable to copy to clipboard in this browser"}),C=({rowIndex:e,columnId:t,toastNotifications:n,valueToStringConverter:a})=>{const i=a(e,t),r=i.formattedString;if(!Object(d.copyToClipboard)(r))return n.addWarning({title:M}),null;const o=S.i18n.translate("unifiedDataTable.copyValueToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return i.withFormula?n.addWarning({title:o,text:I}):n.addInfo({title:o}),r},_=async({columnId:e,columnDisplayName:t,toastNotifications:n,valueToStringConverter:a,rowsCount:i})=>{const r=(e=>({formattedString:v(e),withFormula:Object(g.cellHasFormulas)(e)}))(t);let o=r.withFormula;const s=[...Array(i)].map(((t,n)=>{const i=a(n,e,{compatibleWithCSV:!0});return o=o||i.withFormula,i.formattedString})),l=`${r.formattedString}\n${s.join("\n")}`;let c;try{var u,p;await(null===(u=window.navigator)||void 0===u||null===(p=u.clipboard)||void 0===p?void 0:p.writeText(l)),c=!0}catch(e){c=Object(d.copyToClipboard)(l)}if(!c)return n.addWarning({title:M}),null;const m=S.i18n.translate("unifiedDataTable.copyColumnValuesToClipboard.toastTitle",{defaultMessage:'Values of "{column}" column copied to clipboard',values:{column:t}});return o?n.addWarning({title:m,text:I}):n.addInfo({title:m}),l},D=({columnDisplayName:e,toastNotifications:t})=>{if(!Object(d.copyToClipboard)(e))return t.addWarning({title:M}),null;const n=S.i18n.translate("unifiedDataTable.copyColumnNameToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return t.addInfo({title:n}),e};function A(e,t,n,a,i){const r=e.rows[t].flattened[n];i&&e.onFilter&&e.onFilter(i,r,a)}const F=({Component:e,rowIndex:t,columnId:n},i)=>{const r=Object(a.useContext)(k.a),o=S.i18n.translate("unifiedDataTable.grid.filterForAria",{defaultMessage:"Filter for this {value}",values:{value:n}});return Object(w.jsx)(e,{onClick:()=>{A(r,t,n,"+",i)},iconType:"plusInCircle","aria-label":o,title:o,"data-test-subj":"filterForButton"},S.i18n.translate("unifiedDataTable.grid.filterFor",{defaultMessage:"Filter for"}))},N=({Component:e,rowIndex:t,columnId:n},i)=>{const r=Object(a.useContext)(k.a),o=S.i18n.translate("unifiedDataTable.grid.filterOutAria",{defaultMessage:"Filter out this {value}",values:{value:n}});return Object(w.jsx)(e,{onClick:()=>{A(r,t,n,"-",i)},iconType:"minusInCircle","aria-label":o,title:o,"data-test-subj":"filterOutButton"},S.i18n.translate("unifiedDataTable.grid.filterOut",{defaultMessage:"Filter out"}))};var P=n(233);function R(e){switch(e){case P.b.IP:case P.b.GEO_SHAPE:case P.b.NUMBER:return"numeric";case P.b.BOOLEAN:return"boolean";case P.b.STRING:return"string";case P.b.DATE:return"datetime";default:return x.i}}function L({isPlainRecord:e,isFilterActive:t,rows:n,selectedDocs:i,setIsFilterActive:r,setSelectedDocs:o}){const[l,c]=Object(a.useState)(!1),u=Object(a.useCallback)((()=>[t?Object(w.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowAllDocuments",key:"showAllDocuments",icon:"eye",onClick:()=>{c(!1),r(!1)}},e?Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showAllResults",defaultMessage:"Show all results"}):Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showAllDocuments",defaultMessage:"Show all documents"})):Object(w.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridShowSelectedDocuments",key:"showSelectedDocuments",icon:"eye",onClick:()=>{c(!1),r(!0)}},e?Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showSelectedResultsOnly",defaultMessage:"Show selected results only"}):Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.showSelectedDocumentsOnly",defaultMessage:"Show selected documents only"})),Object(w.jsx)(d.EuiCopy,{key:"copyJsonWrapper","data-test-subj":"dscGridCopySelectedDocumentsJSON",textToCopy:n?JSON.stringify(n.filter((e=>i.includes(e.id))).map((e=>e.raw))):""},(t=>Object(w.jsx)(d.EuiContextMenuItem,{key:"copyJSON",icon:"copyClipboard",onClick:t},e?Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.copyResultsToClipboardJSON",defaultMessage:"Copy results to clipboard (JSON)"}):Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.copyToClipboardJSON",defaultMessage:"Copy documents to clipboard (JSON)"})))),Object(w.jsx)(d.EuiContextMenuItem,{"data-test-subj":"dscGridClearSelectedDocuments",key:"clearSelection",icon:"cross",onClick:()=>{c(!1),o([]),r(!1)}},Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.clearSelection",defaultMessage:"Clear selection"}))]),[t,e,n,i,r,o]),p=Object(a.useCallback)((()=>c((e=>!e))),[]);return Object(w.jsx)(d.EuiPopover,{closePopover:()=>c(!1),isOpen:l,panelPaddingSize:"none",button:Object(w.jsx)(d.EuiDataGridToolbarControl,{iconType:"documents",onClick:p,"data-selected-documents":i.length,"data-test-subj":"unifiedDataTableSelectionBtn",isSelected:t,badgeContent:i.length},e?Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.selectedResultsButtonLabel",defaultMessage:"Selected",description:"Selected results"}):Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.selectedRowsButtonLabel",defaultMessage:"Selected",description:"Selected documents"}))},l&&Object(w.jsx)(d.EuiContextMenuPanel,{items:u(),"data-test-subj":"unifiedDataTableSelectionMenu"}))}const z=({selectedDocs:e,setIsCompareActive:t})=>Object(w.jsx)(d.EuiDataGridToolbarControl,{iconType:"diff",badgeContent:e.length,"data-test-subj":"unifiedDataTableCompareSelectedDocuments",onClick:()=>{t(!0)}},Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.compareSelectedRowsButtonLabel",defaultMessage:"Compare"}));function q({label:e,onCopy:t,dataTestSubj:n}){return{size:"xs",label:e,iconType:"copyClipboard",iconProps:{size:"m"},onClick:t,"data-test-subj":n}}function B({columnDisplayName:e,toastNotifications:t}){return q({label:Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnNameToClipBoardButton",defaultMessage:"Copy name"}),onCopy:()=>D({columnDisplayName:e,toastNotifications:t}),dataTestSubj:"gridCopyColumnNameToClipBoardButton"})}function $({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:i}){return q({label:Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnValuesToClipBoardButton",defaultMessage:"Copy column"}),onCopy:()=>_({columnId:e,columnDisplayName:t,toastNotifications:n,rowsCount:a,valueToStringConverter:i}),dataTestSubj:"gridCopyColumnValuesToClipBoardButton"})}var V=n(119),U=n.n(V),G=n(701),H=n(1451),W=n(655),Q=n(44),Y=n(49),K=({headerRowHeight:e,children:t})=>{const n=Object(w.css)("overflow-wrap:anywhere;white-space:normal;word-break:break-all;line-height:",Y.euiThemeVars.euiSize,";text-align:left;.euiDataGridHeaderCell--numeric &{float:right;}","");return e?Object(w.jsx)(d.EuiTextBlockTruncate,{lines:e,css:n},t):Object(w.jsx)("div",{css:n},t)};const J=({columnDisplayName:e,showColumnTokens:t,columnName:n,columnsMeta:a,dataView:i,headerRowHeight:r})=>Object(w.jsx)(K,{headerRowHeight:r},t&&Object(w.jsx)(Z,{columnName:n,columnsMeta:a,dataView:i}),Object(w.jsx)(X,{columnDisplayName:e})),Z=e=>{const{columnName:t,columnsMeta:n,dataView:i}=e,r=Object(a.useMemo)((()=>function({dataView:e,columnName:t,columnsMeta:n}){if(!t||"_source"===t)return null;if(n){const e=(a=n[t])&&a.type?Object(G.a)({name:"",type:a.type,esTypes:a.esType?[a.esType]:[]}):null;return e&&"unknown"!==e?Object(w.jsx)(H.a,{type:e,css:ee}):null}var a;const i=e.getFieldByName(t);return i?Object(w.jsx)(H.a,U()({},Object(W.a)(i),{css:ee})):function(e,t){const n=new RegExp(Object(Q.escapeRegExp)(e)+"(\\.|$)");return!t.fields.getByName(e)&&!!t.fields.getAll().find((e=>{var t;const a=Object(m.getDataViewFieldSubtypeNested)(e);return!!a&&n.test(null!==(t=null==a?void 0:a.nested.path)&&void 0!==t?t:"")}))}(t,e)?Object(w.jsx)(H.a,{type:"nested",css:ee}):null}({columnName:t,columnsMeta:n,dataView:i})),[t,n,i]);return r?Object(w.jsx)("span",{css:Object(w.css)({paddingRight:Y.euiThemeVars.euiSizeXS},"","")},r):null},X=({columnDisplayName:e})=>Object(w.jsx)("span",{"data-test-subj":"unifiedDataTableColumnTitle"},e),ee={verticalAlign:"bottom"};var te={name:"1flj9lk",styles:"text-align:left"};const ne=({dataView:e,dataViewField:t,headerRowHeight:n=1,columnLabel:a})=>{var i;const r=a||(null!==(i=null==t?void 0:t.customLabel)&&void 0!==i?i:e.timeFieldName),o=S.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltipAriaLabel",{defaultMessage:"{timeFieldName} - this field represents the time that events occurred.",values:{timeFieldName:r}}),s=S.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltip",{defaultMessage:"This field represents the time that events occurred."});return Object(w.jsx)("div",{"aria-label":o,css:te},Object(w.jsx)(K,{headerRowHeight:n},r," ",Object(w.jsx)(d.EuiIconTip,{type:"clock",content:s})))},ae=i.a.memo(J),ie=i.a.memo(ne),re="openDetails",oe="select",se={id:re,width:26,headerCellRender:()=>Object(w.jsx)(d.EuiScreenReaderOnly,null,Object(w.jsx)("span",null,S.i18n.translate("unifiedDataTable.controlColumnHeader",{defaultMessage:"Control column"}))),rowCellRender:({rowIndex:e,setCellProps:t})=>{const n=Object(a.useRef)(null),[i,r]=Object(a.useState)(!1),{expanded:o,setExpanded:s,rows:l,isDarkMode:c,componentsTourSteps:u}=Object(a.useContext)(k.a),p=l[e],m=u?u.expandButton:void 0;Object(a.useEffect)((()=>{p.isAnchor?t({className:"unifiedDataTable__cell--highlight"}):o&&p&&o.id===p.id?t({className:"unifiedDataTable__cell--expanded"}):t({style:void 0})}),[o,p,t,c]);const f=p===o,g=S.i18n.translate("unifiedDataTable.grid.viewDoc",{defaultMessage:"Toggle dialog with details"}),b=p.isAnchor?"docTableExpandToggleColumnAnchor":"docTableExpandToggleColumn";return Object(a.useEffect)((()=>{!f&&i&&(r(!1),setTimeout((()=>{var e;null===(e=n.current)||void 0===e||e.hideToolTip()}),100))}),[f,r,i]),s?Object(w.jsx)(T,null,Object(w.jsx)(d.EuiToolTip,{content:g,delay:"long",ref:n},Object(w.jsx)(d.EuiButtonIcon,{id:0===e?m:void 0,size:"xs",iconSize:"s","aria-label":g,"data-test-subj":b,onClick:()=>{var e;const t=f?void 0:p;null===(e=n.current)||void 0===e||e.hideToolTip(),r(Boolean(t)),null==s||s(t)},color:f?"primary":"text",iconType:f?"minimize":"expand",isSelected:f}))):null}},le={id:oe,width:24,rowCellRender:({rowIndex:e,setCellProps:t})=>{const{euiTheme:n}=Object(d.useEuiTheme)(),{selectedDocs:i,expanded:r,rows:o,isDarkMode:s,setSelectedDocs:l}=Object(a.useContext)(k.a),c=Object(a.useMemo)((()=>o[e]),[o,e]),u=Object(a.useMemo)((()=>i.includes(c.id)),[i,c.id]),p=S.i18n.translate("unifiedDataTable.grid.selectDoc",{defaultMessage:"Select document ''{rowNumber}''",values:{rowNumber:e+1}});return Object(a.useEffect)((()=>{r&&c&&r.id===c.id?t({className:"unifiedDataTable__cell--selected"}):t({style:void 0})}),[r,c,t,s]),Object(w.jsx)(d.EuiFlexGroup,{responsive:!1,direction:"column",justifyContent:"center",className:"unifiedDataTable__rowControl",css:Object(w.css)("padding-block:",n.size.xs,";padding-left:",n.size.xs,";","")},Object(w.jsx)(d.EuiFlexItem,{grow:!1},Object(w.jsx)(d.EuiCheckbox,{id:c.id,"aria-label":p,checked:u,"data-test-subj":`dscGridSelectDoc-${c.id}`,onChange:()=>{if(u){const e=i.filter((e=>e!==c.id));l(e)}else l([...i,c.id])}})))},headerCellRender:()=>Object(w.jsx)(d.EuiScreenReaderOnly,null,Object(w.jsx)("span",null,S.i18n.translate("unifiedDataTable.selectColumnHeader",{defaultMessage:"Select column"})))};function ce({columns:e,columnsCellActions:t,rowsCount:n,settings:a,dataView:i,defaultColumns:r,isSortEnabled:o,isPlainRecord:l,services:c,hasEditDataViewPermission:u,valueToStringConverter:d,onFilter:p,editField:m,visibleCellActions:f,columnsMeta:g,showColumnTokens:b,headerRowHeightLines:y,customGridColumnsConfiguration:h}){const v=e=>{var t,n,i;return null!==(t=null==a||null===(n=a.columns)||void 0===n||null===(i=n[e])||void 0===i?void 0:i.width)&&void 0!==t?t:0},E=(e=>{if(e!==x.d.auto)return e===x.d.single?1:e})(y),j=e.length;return e.map(((e,y)=>{var k,T;return function({numberOfColumns:e,columnName:t,columnWidth:n=0,dataView:a,defaultColumns:i,isSortEnabled:r,isPlainRecord:o,toastNotifications:l,hasEditDataViewPermission:c,valueToStringConverter:u,rowsCount:d,onFilter:p,editField:m,columnCellActions:f,visibleCellActions:g,columnsMeta:b,showColumnTokens:y,headerRowHeight:h,customGridColumnsConfiguration:v,columnDisplay:E}){var j,k,T,I,M;const _=o?new O.DataViewField({name:t,type:null!==(j=null==b||null===(k=b[t])||void 0===k?void 0:k.type)&&void 0!==j?j:"unknown",esTypes:null!=b&&null!==(T=b[t])&&void 0!==T&&T.esType?[b[t].esType]:void 0,searchable:!0,aggregatable:!1}):a.getFieldByName(t),D=m&&_&&(({hasEditDataViewPermission:e,dataView:t,field:n,editField:a})=>{if("_source"===n.name)return null;const{canEdit:i}=((e,t)=>{var n;const a=Boolean(null===(n=e.getFieldByName(t.name))||void 0===n?void 0:n.runtimeField);return{canEdit:!("unknown"===t.type||"unknown_selected"===t.type)||a,canDelete:a}})(t,n),r=e()||!t.isPersisted();return i&&r?{size:"xs",label:Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.grid.editFieldButton",defaultMessage:"Edit data view field"}),iconType:"pencil",iconProps:{size:"m"},onClick:()=>{a(n.name)},"data-test-subj":"gridEditFieldButton"}:null})({hasEditDataViewPermission:c,dataView:a,field:_,editField:m}),A=((e,t,n)=>n||("_source"===e?S.i18n.translate("unifiedDataTable.grid.documentHeader",{defaultMessage:"Document"}):t||e))(t,null==_?void 0:_.displayName,E);let P;P=null!=f&&f.length?f:_?function(e,t,n,a){return[...a&&e.filterable?[({Component:t,rowIndex:n,columnId:a})=>F({Component:t,rowIndex:n,columnId:a},e),({Component:t,rowIndex:n,columnId:a})=>N({Component:t,rowIndex:n,columnId:a},e)]:[],({Component:e,rowIndex:a,columnId:i})=>function({Component:e,rowIndex:t,columnId:n},a,i){const r=S.i18n.translate("unifiedDataTable.grid.copyClipboardButtonTitle",{defaultMessage:"Copy value of {column}",values:{column:n}});return Object(w.jsx)(e,{onClick:()=>{C({rowIndex:t,columnId:n,valueToStringConverter:i,toastNotifications:a})},iconType:"copyClipboard","aria-label":r,title:r,"data-test-subj":"copyClipboardButton"},S.i18n.translate("unifiedDataTable.grid.copyCellValueButton",{defaultMessage:"Copy value"}))}({Component:e,rowIndex:a,columnId:i},t,n)]}(_,l,u,p):[];const L={id:t,schema:R(null!==(I=null==b||null===(M=b[t])||void 0===M?void 0:M.type)&&void 0!==I?I:null==_?void 0:_.type),isSortable:r&&(o&&"_source"!==t||!0===(null==_?void 0:_.sortable)),display:y||1!==h?Object(w.jsx)(ae,{dataView:a,columnName:t,columnDisplayName:A,columnsMeta:b,showColumnTokens:y,headerRowHeight:h}):void 0,displayAsText:A,actions:{showHide:!i&&t!==a.timeFieldName&&{label:S.i18n.translate("unifiedDataTable.removeColumnLabel",{defaultMessage:"Remove column"}),iconType:"cross"},showMoveLeft:!i,showMoveRight:!i,additional:[..."__source"===t?[]:[B({columnDisplayName:A,toastNotifications:l})],$({columnId:t,columnDisplayName:A,toastNotifications:l,rowsCount:d,valueToStringConverter:u}),...D?[D]:[]]},cellActions:P,visibleCellActions:g};return L.id===a.timeFieldName&&(L.display=Object(w.jsx)(ie,{dataView:a,dataViewField:_,headerRowHeight:h,columnLabel:E}),e>1&&(L.initialWidth=x.h)),n>0&&(L.initialWidth=Number(n)),v&&v[L.id]?v[L.id]({column:L,headerRowHeight:h}):L}({numberOfColumns:j,columnName:e,columnCellActions:null==t?void 0:t[y],columnWidth:v(e),dataView:i,defaultColumns:r,isSortEnabled:o,isPlainRecord:l,toastNotifications:c.toastNotifications,hasEditDataViewPermission:u,valueToStringConverter:d,rowsCount:n,onFilter:p,editField:m,visibleCellActions:f,columnsMeta:g,showColumnTokens:b,headerRowHeight:E,customGridColumnsConfiguration:h,columnDisplay:null==a||null===(k=a.columns)||void 0===k||null===(T=k[e])||void 0===T?void 0:T.display})}))}const ue=e=>{const{isLoadingMore:t,rowCount:n,sampleSize:i,pageIndex:r,pageCount:o,totalHits:l=0,onFetchMoreRecords:c,data:u}=e,p=u.query.timefilter.timefilter,[m,f]=Object(a.useState)(p.getRefreshInterval());Object(a.useEffect)((()=>{const e=p.getRefreshIntervalUpdate$().subscribe((()=>{f(p.getRefreshInterval())}));return()=>e.unsubscribe()}),[p,f]);const g=Boolean(m&&!1===m.pause&&m.value>0),{euiTheme:b}=Object(d.useEuiTheme)();return r===o-1&&n<l?c&&"boolean"==typeof t?n<=x.c-i?Object(w.jsx)(de,U()({hasButton:!0},e),Object(w.jsx)(d.EuiToolTip,{content:g?S.i18n.translate("unifiedDataTable.gridSampleSize.fetchMoreLinkDisabledTooltip",{defaultMessage:"To load more the refresh interval needs to be disabled first"}):void 0},Object(w.jsx)(d.EuiButtonEmpty,{disabled:g,isLoading:t,flush:"both","data-test-subj":"dscGridSampleSizeFetchMoreLink",onClick:c,css:Object(w.css)("margin-left:",b.size.xs,";","")},Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.fetchMoreLinkLabel",defaultMessage:"Load more"})))):Object(w.jsx)(de,U()({hasButton:!1},e)):n<l?Object(w.jsx)(de,U()({hasButton:!1},e)):null:null},de=({hasButton:e,rowCount:t,children:n,fieldFormats:a})=>{const{euiTheme:i}=Object(d.useEuiTheme)(),r=a.getDefaultInstance(P.b.NUMBER,[P.a.INTEGER]).convert(t);return Object(w.jsx)("p",{"data-test-subj":"unifiedDataTableFooter",css:Object(w.css)("display:flex;flex-direction:row;align-items:center;justify-content:center;flex-shrink:0;background-color:",i.colors.lightestShade,";padding:",e?`0 ${i.size.base}`:`${i.size.s} ${i.size.base}`,";margin-top:",i.size.xs,";text-align:center;","")},Object(w.jsx)("span",null,e?Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.lastPageDescription",defaultMessage:"Search results are limited to {rowCount} documents.",values:{rowCount:r}}):Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.limitDescription",defaultMessage:"Search results are limited to {sampleSize} documents. Add more search terms to narrow your search.",values:{sampleSize:r}})),n)};let pe=function(e){return e.auto="auto",e.single="single",e.custom="custom",e}({});const me=Object(d.htmlIdGenerator)()();function fe({label:e,rowHeight:t,rowHeightLines:n,compressed:a,onChangeRowHeight:r,onChangeRowHeightLines:o,maxRowHeight:s,"data-test-subj":l}){const c=[{id:`${me}${pe.single}`,label:S.i18n.translate("unifiedDataTable.rowHeight.single",{defaultMessage:"Single"}),"data-test-subj":`${l}_rowHeight_${pe.single}`},{id:`${me}${pe.auto}`,label:S.i18n.translate("unifiedDataTable.rowHeight.auto",{defaultMessage:"Auto fit"}),"data-test-subj":`${l}_rowHeight_${pe.auto}`},{id:`${me}${pe.custom}`,label:S.i18n.translate("unifiedDataTable.rowHeight.custom",{defaultMessage:"Custom"}),"data-test-subj":`${l}_rowHeight_${pe.custom}`}];return Object(w.jsx)(i.a.Fragment,null,Object(w.jsx)(d.EuiFormRow,{label:e,display:"columnCompressed","data-test-subj":l},Object(w.jsx)(i.a.Fragment,null,Object(w.jsx)(d.EuiButtonGroup,{isFullWidth:!0,legend:e,buttonSize:"compressed",options:c,idSelected:`${me}${null!=t?t:pe.single}`,onChange:e=>{const t=e.replace(me,"");r(t)},"data-test-subj":`${l}_rowHeightButtonGroup`}),t===pe.custom?Object(w.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,showInput:!0,min:1,max:null!=s?s:20,step:1,value:null!=n?n:2,onChange:e=>{const t=Number(e.currentTarget.value);o(t)},"data-test-subj":`${l}_lineCountNumber`,css:Object(w.css)({marginTop:a?Y.euiThemeVars.euiSizeXS:Y.euiThemeVars.euiSizeM},"","")}):null)))}const ge=()=>{},be=({rowHeight:e,rowHeightLines:t,onChangeRowHeight:n,onChangeRowHeightLines:r,headerRowHeight:o,headerRowHeightLines:s,onChangeHeaderRowHeight:l,onChangeHeaderRowHeightLines:c,maxAllowedSampleSize:u=1e3,sampleSize:p,onChangeSampleSize:m})=>{const[f,g]=Object(a.useState)(p),b=Math.max(Math.min(10,p),1),y=Object(a.useMemo)((()=>Object(E.debounce)(null!=m?m:ge,300,{leading:!1,trailing:!0})),[m]),h=Object(a.useCallback)((e=>{var t;if(!e.target.value)return void g("");const n=null!==(t=parseInt(e.target.value,10))&&void 0!==t?t:10;n>=1&&(g(n),n<=u&&y(n))}),[u,g,y]),v=S.i18n.translate("unifiedDataTable.sampleSizeSettings.sampleSizeLabel",{defaultMessage:"Sample size"});Object(a.useEffect)((()=>{g(p)}),[p,g]);const x=[];return l&&c&&x.push(Object(w.jsx)(fe,{rowHeight:o,rowHeightLines:s,label:S.i18n.translate("unifiedDataTable.headerRowHeightLabel",{defaultMessage:"Header row height"}),onChangeRowHeight:l,onChangeRowHeightLines:c,"data-test-subj":"unifiedDataTableHeaderRowHeightSettings",maxRowHeight:5})),n&&r&&x.push(Object(w.jsx)(fe,{rowHeight:e,rowHeightLines:t,label:S.i18n.translate("unifiedDataTable.rowHeightLabel",{defaultMessage:"Cell row height"}),onChangeRowHeight:n,onChangeRowHeightLines:r,"data-test-subj":"unifiedDataTableRowHeightSettings"})),m&&x.push(Object(w.jsx)(d.EuiFormRow,{label:v,display:"columnCompressed"},Object(w.jsx)(d.EuiRange,{compressed:!0,fullWidth:!0,min:b,max:u,step:10===b?10:1,showInput:!0,value:f,onChange:h,"data-test-subj":"unifiedDataTableSampleSizeInput"}))),Object(w.jsx)(i.a.Fragment,null,x.map(((e,t)=>Object(w.jsx)(i.a.Fragment,{key:`setting-${t}`},t>0&&Object(w.jsx)(d.EuiHorizontalRule,{margin:"s"}),e))))},ye=e=>"number"==typeof e&&!Number.isNaN(e)&&Math.floor(e)===e&&e>=-1&&e<=20,he=(e,t)=>`${e}:${t}`,ve=(e,t,n,a,i)=>{n.set(he(a,i),{previousRowHeight:e,previousConfigRowHeight:t})},Ee=({storage:e,consumer:t,key:n,configRowHeight:i,rowHeightState:r,onUpdateRowHeight:o})=>{const s=Object(a.useMemo)((()=>{const a=((e,t,n)=>{const a=e.get(he(t,n));return"object"==typeof a&&null!==a&&ye(a.previousRowHeight)&&ye(a.previousConfigRowHeight)?a:null})(e,t,n);let o;var s;return o=ye(r)?r:null!==(s=a)&&i===s.previousConfigRowHeight?a.previousRowHeight:i,o}),[i,t,n,r,e]),l=Object(a.useMemo)((()=>{switch(s){case x.d.auto:return pe.auto;case x.d.single:return pe.single;default:return pe.custom}}),[s]),c=Object(a.useCallback)((a=>{let r;switch(a){case pe.auto:r=x.d.auto;break;case pe.single:r=x.d.single;break;default:r=i}ve(r,i,e,t,n),null==o||o(r)}),[i,t,n,o,e]),u=Object(a.useCallback)((a=>{ve(a,i,e,t,n),null==o||o(a)}),[i,t,n,o,e]);return{rowHeight:l,rowHeightLines:s,onChangeRowHeight:o?c:void 0,onChangeRowHeightLines:o?u:void 0}};var xe=n(1494);const je=Object(xe.a)(Object(a.lazy)((()=>n.e(48).then(n.bind(null,2116))))),Se="unifiedDataTable__fullScreen";let Oe=function(e){return e.loading="loading",e.loadingMore="loadingMore",e.loaded="loaded",e}({});const ke={darkMode:!1},we=i.a.memo(d.EuiDataGrid),Te=["openDetails","select"],Ie=({ariaLabelledBy:e,columns:t,columnsMeta:n,showColumnTokens:r,configHeaderRowHeight:c,headerRowHeightState:h,onUpdateHeaderRowHeight:S,controlColumnIds:O=Te,dataView:T,loadingState:I,onFilter:M,onResize:C,onSetColumns:_,onSort:D,rows:A,searchDescription:F,searchTitle:N,settings:P,showTimeCol:R,showFullScreenButton:q=!0,sort:B,useNewFieldsApi:$,isSortEnabled:V=!0,isPaginationEnabled:U=!0,cellActionsTriggerId:G,className:H,rowHeightState:W,onUpdateRowHeight:Q,maxAllowedSampleSize:Y,sampleSizeState:K,onUpdateSampleSize:J,isPlainRecord:Z=!1,rowsPerPageState:X,onUpdateRowsPerPage:ee,onFieldEdited:te,services:ne,renderCustomGridBody:ae,renderCustomToolbar:ie,trailingControlColumns:de,totalHits:pe,onFetchMoreRecords:me,renderDocumentView:fe,setExpandedDoc:ge,expandedDoc:ye,configRowHeight:he,showMultiFields:ve=!0,maxDocFieldsDisplayed:xe=50,externalControlColumns:Ie,externalAdditionalControls:Me,rowsPerPageOptions:Ce,visibleCellActions:_e,externalCustomRenderers:De,additionalFieldGroups:Ae,consumer:Fe="discover",componentsTourSteps:Ne,gridStyleOverride:Pe,rowLineHeightOverride:Re,cellActionsMetadata:Le,customGridColumnsConfiguration:ze,customControlColumnsConfiguration:qe,enableComparisonMode:Be,cellContext:$e,renderCellPopover:Ve})=>{var Ue,Ge,He,We;const{fieldFormats:Qe,toastNotifications:Ye,dataViewFieldEditor:Ke,uiSettings:Je,storage:Ze,data:Xe}=ne,{darkMode:et}=u()(null!==(Ue=null===(Ge=ne.theme)||void 0===Ge?void 0:Ge.theme$)&&void 0!==Ue?Ue:Object(l.of)(ke),ke),tt=Object(a.useRef)(null),[nt,at]=Object(a.useState)([]),[it,rt]=Object(a.useState)(!1),[ot,st]=Object(a.useState)(!1),lt=Object(f.a)(t,T),ct=lt.includes("_source"),ut=Object(a.useMemo)((()=>{var e;return new Map(null!==(e=null==A?void 0:A.map((e=>[e.id,e])))&&void 0!==e?e:[])}),[A]),dt=Object(a.useCallback)((e=>ut.get(e)),[ut]),pt=Object(a.useMemo)((()=>{if(!nt.length||null==A||!A.length)return[];const e=nt.filter((e=>!!dt(e)));return 0===e.length&&it&&rt(!1),e}),[nt,null==A?void 0:A.length,it,dt]),mt=Object(a.useMemo)((()=>{if(!A)return[];if(!it||0===pt.length)return A;const e=A.filter((e=>pt.includes(e.id)));return e.length?e:A}),[A,pt,it]),ft=Object(a.useCallback)(((e,t,n)=>(({rowIndex:e,rows:t,columnId:n,dataView:a,fieldFormats:i,options:r})=>{var o,s;if(!t[e])return{formattedString:"",withFormula:!1};const l=t[e].flattened,c=null==l?void 0:l[n],u=a.fields.getByName(n),d=Array.isArray(c)?c:[c],p=null!==(o=null==r?void 0:r.compatibleWithCSV)&&void 0!==o&&o,m=null!==(s=null==r?void 0:r.compatibleWithCSV)&&void 0!==s&&s;if("_source"===(null==u?void 0:u.type))return{formattedString:y(l,p),withFormula:!1};let f=!1;return{formattedString:d.map((n=>{const r=Object(b.a)(n,t[e].raw,i,a,u,"text",{skipFormattingInStringifiedJSON:p});return"string"==typeof r?(f=f||Object(g.cellHasFormulas)(r),m?v(r):r):y(r,p)||""})).join(", "),withFormula:f}})({rowIndex:e,rows:mt,dataView:T,columnId:t,fieldFormats:Qe,options:n})),[mt,T,Qe]),gt=Object(a.useMemo)((()=>({expanded:ye,setExpanded:ge,rows:mt,onFilter:M,dataView:T,isDarkMode:et,selectedDocs:pt,setSelectedDocs:e=>{at(e),it&&0===e.length&&rt(!1)},valueToStringConverter:ft,componentsTourSteps:Ne,isPlainRecord:Z})),[Ne,et,T,Z,mt,ye,it,M,ge,pt,ft]),bt="number"==typeof X&&X>0?X:x.a,[yt,ht]=Object(a.useState)({pageIndex:0,pageSize:bt}),vt=Object(a.useMemo)((()=>mt?mt.length:0),[mt]),Et=Object(a.useMemo)((()=>Math.ceil(vt/yt.pageSize)),[vt,yt]),xt=Object(a.useMemo)((()=>{return U?{onChangeItemsPerPage:e=>{null==ee||ee(e)},onChangePage:e=>ht((t=>({...t,pageIndex:e}))),pageIndex:yt.pageIndex>Et-1?0:yt.pageIndex,pageSize:yt.pageSize,pageSizeOptions:null!=Ce?Ce:(e=yt.pageSize,Object(E.sortBy)(Object(E.uniq)("number"==typeof e&&e>0?[...x.e,e]:x.e)))}:void 0;var e}),[U,yt.pageIndex,yt.pageSize,Et,Ce,ee]);Object(a.useEffect)((()=>{ht((e=>e.pageSize===bt?e:{...e,pageSize:bt}))}),[bt,ht]);const jt=Object(a.useMemo)((()=>((e,t,n)=>{if(n)return()=>!0;const a=new Map;return e.forEach((e=>{a.set(e,((e,t)=>{var n;const a=t.fields.getByName(e);if(!a)return{show:!0};const i=Object(m.getDataViewFieldSubtypeMulti)(a.spec);return{show:!Boolean(null==i?void 0:i.multi),parentName:null==i||null===(n=i.multi)||void 0===n?void 0:n.parent}})(e,t))})),e=>{const t=a.get(e);return!t||t.show||!!t.parentName&&!a.has(t.parentName)}})(T.fields.getAll().map((e=>e.name)),T,ve)),[T,ve]),St=Object(a.useMemo)((()=>Object(j.b)({dataView:T,rows:mt,useNewFieldsApi:$,shouldShowFieldHandler:jt,closePopover:()=>{var e;return null===(e=tt.current)||void 0===e?void 0:e.closeCellPopover()},fieldFormats:Qe,maxEntries:xe,externalCustomRenderers:De,isPlainRecord:Z})),[T,mt,$,jt,xe,Qe,De,Z]),Ot=Object(a.useMemo)((()=>null!=Ve?Ve:(()=>{const e=Object(a.memo)((function(e){const{setCellPopoverProps:t,DefaultCellPopover:n}=e;return Object(a.useEffect)((()=>{t({panelClassName:"unifiedDataTable__cellPopover"})}),[t]),Object(w.jsx)(n,e)}));return t=>Object(w.jsx)(e,t)})()),[Ve]),kt=Object(a.useMemo)((()=>Object(d.htmlIdGenerator)()()),[]),wt=Object(a.useRef)();Object(a.useEffect)((()=>()=>{null!=wt&&wt.current&&(null==wt||wt.current())}),[]);const Tt=Object(a.useMemo)((()=>te?async e=>{var t;wt.current=te&&await(null==ne||null===(t=ne.dataViewFieldEditor)||void 0===t?void 0:t.openEditor({ctx:{dataView:T},fieldName:e,onSave:async()=>{await te()}}))}:void 0),[T,te,null==ne?void 0:ne.dataViewFieldEditor]),It=T.timeFieldName,Mt=Object(a.useCallback)((e=>function(e,t,n,a,i){return!(!a||!t)&&(!i||!!n&&t in n&&e.includes("_source"))}(e,It,n,R,Z)),[It,Z,R,n]),Ct=Object(a.useMemo)((()=>function(e,t,n){const a=t.timeFieldName;return n&&a&&!e.find((e=>e===a))?[a,...e]:e}(lt,T,Mt(lt))),[T,lt,Mt]),_t=Object(a.useCallback)(((e,t)=>mt[t%mt.length].flattened[e]),[mt]),Dt=Object(a.useMemo)((()=>G&&!Z?Ct.map((e=>{var t,n;return null!==(t=null===(n=T.getFieldByName(e))||void 0===n?void 0:n.toSpec())&&void 0!==t?t:{name:"",type:"",aggregatable:!1,searchable:!1}})):void 0),[G,Z,Ct,T]),At=Object(a.useMemo)((()=>({dataViewId:T.id,...null!=Le?Le:{}})),[T,Le]),Ft=Object(p.c)({fields:Dt,getCellValue:_t,triggerId:G,dataGridRef:tt,metadata:At}),{rowHeight:Nt,rowHeightLines:Pt,onChangeRowHeight:Rt,onChangeRowHeightLines:Lt}=Ee({storage:Ze,consumer:Fe,key:"dataGridHeaderRowHeight",configRowHeight:null!=c?c:1,rowHeightState:h,onUpdateRowHeight:S}),{rowHeight:zt,rowHeightLines:qt,onChangeRowHeight:Bt,onChangeRowHeightLines:$t}=Ee({storage:Ze,consumer:Fe,key:"dataGridRowHeight",configRowHeight:null!=he?he:x.d.default,rowHeightState:W,onUpdateRowHeight:Q}),Vt=Object(a.useMemo)((()=>ce({columns:Ct,columnsCellActions:Ft,rowsCount:mt.length,settings:P,dataView:T,defaultColumns:ct,isSortEnabled:V,isPlainRecord:Z,services:{uiSettings:Je,toastNotifications:Ye},hasEditDataViewPermission:()=>{var e;return Boolean(null==Ke||null===(e=Ke.userPermissions)||void 0===e?void 0:e.editIndexPattern())},valueToStringConverter:ft,onFilter:M,editField:Tt,visibleCellActions:_e,columnsMeta:n,showColumnTokens:r,headerRowHeightLines:Pt,customGridColumnsConfiguration:ze})),[n,Ft,ze,T,Ke,ct,mt.length,Tt,Pt,Z,V,M,P,r,Ye,Je,ft,_e,Ct]),Ut=Object(a.useMemo)((()=>[{type:x.i,detector:()=>0,sortTextAsc:"",sortTextDesc:"",icon:"",color:""}]),[]),Gt=Object(a.useMemo)((()=>({visibleColumns:Ct,setVisibleColumns:e=>{const t=!Mt(e);_(e,t)}})),[Ct,_,Mt]),Ht=Object(a.useMemo)((()=>B.map((([e,t])=>({id:e,direction:t}))).filter((({id:e})=>Ct.includes(e)))),[B,Ct]),Wt=Object(a.useCallback)((e=>{V&&D&&D(e.map((({id:e,direction:t})=>[e,t])))}),[D,V]),Qt=Object(a.useMemo)((()=>{if(V){if(Z&&!t.length)return;return{columns:Ht,onSort:Wt}}return{columns:Ht,onSort:()=>{}}}),[V,Ht,Z,t.length,Wt]),Yt=Boolean(ge&&!!fe),Kt=Object(a.useMemo)((()=>{const e=function(e){return e?[se,le]:[le]}(Yt).filter((({id:e})=>O.includes(e)));return Ie?[...e,...Ie]:e}),[Yt,O,Ie]),Jt=null==qe?void 0:qe({controlColumns:{[oe]:le,[re]:se}}),Zt=null!==(He=null==Jt?void 0:Jt.leadingControlColumns)&&void 0!==He?He:Kt,Xt=null!==(We=null==Jt?void 0:Jt.trailingControlColumns)&&void 0!==We?We:de,en=Object(a.useMemo)((()=>Me||pt.length?Object(w.jsx)(i.a.Fragment,null,Boolean(pt.length)&&Object(w.jsx)(d.EuiFlexGroup,{gutterSize:"s",responsive:!1},Be&&pt.length>1&&Object(w.jsx)(d.EuiFlexItem,{grow:!1},Object(w.jsx)(z,{selectedDocs:pt,setIsCompareActive:st})),Object(w.jsx)(d.EuiFlexItem,{grow:!1},Object(w.jsx)(L,{isPlainRecord:Z,isFilterActive:it,rows:A,selectedDocs:pt,setSelectedDocs:at,setIsFilterActive:rt}))),Me):null),[Me,pt,Z,it,Be,A]),tn=Object(a.useMemo)((()=>ie?e=>ie({toolbarProps:e,gridProps:{additionalControls:en}}):void 0),[ie,en]),nn=Object(a.useMemo)((()=>{const e={};return Q&&(e.allowDensity=!1),(Q||S||J)&&(e.allowRowHeight=!1,e.allowResetButton=!1,e.additionalDisplaySettings=Object(w.jsx)(be,{rowHeight:zt,rowHeightLines:qt,onChangeRowHeight:Bt,onChangeRowHeightLines:$t,headerRowHeight:Nt,headerRowHeightLines:Pt,onChangeHeaderRowHeight:Rt,onChangeHeaderRowHeightLines:Lt,maxAllowedSampleSize:Y,sampleSize:K,onChangeSampleSize:J})),Object.keys(e).length?e:void 0}),[Nt,Pt,Y,Rt,Lt,Bt,$t,S,Q,J,zt,qt,K]),an=Object(a.useMemo)((()=>Z&&t.length?{level:"sorting"}:void 0),[t.length,Z]),rn=Object(a.useMemo)((()=>ct?{...x.j,showColumnSelector:!1,showSortSelector:V,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:q}:{...x.j,showSortSelector:V,additionalControls:en,showDisplaySelector:nn,showFullScreenSelector:q}),[ct,V,en,nn,q]),on=(({rowHeightLines:e,rowLineHeight:t=x.g})=>Object(a.useMemo)((()=>{var n;return{defaultHeight:(n=e)===x.d.auto?"auto":n!==x.d.single?{lineCount:n}:void 0,lineHeight:t}}),[e,t]))({rowHeightLines:qt,rowLineHeight:Re}),{dataGridId:sn,dataGridWrapper:ln,setDataGridWrapper:cn}=(()=>{const e=Object(d.useGeneratedHtmlId)({prefix:"unifiedDataTable"}),[t,n]=Object(a.useState)(null),[i,r]=Object(a.useState)(null),o=Object(a.useCallback)(((t,n)=>{const a=document.getElementById(e);a&&(r(a),n.disconnect())}),[e]),s=Object(a.useCallback)((()=>{i&&(e=>{e.classList.contains("euiDataGrid--fullScreen")?document.body.classList.add(Se):document.body.classList.remove(Se)})(i)}),[i]);return Object(d.useMutationObserver)(t,o,{childList:!0,subtree:!0}),Object(d.useMutationObserver)(i,s,{attributes:!0,attributeFilter:["class"]}),{dataGridId:e,dataGridWrapper:t,setDataGridWrapper:n}})(),un=I!==Oe.loading;return vt||I!==Oe.loading?vt?Object(w.jsx)(k.a.Provider,{value:gt},Object(w.jsx)("span",{className:"unifiedDataTable__inner"},Object(w.jsx)("div",{ref:cn,key:ot?"comparisonTable":"docTable","data-test-subj":"discoverDocTable","data-render-complete":un,"data-shared-item":"","data-title":N,"data-description":F,"data-document-number":mt.length,className:o()(H,"unifiedDataTable__table")},ot?Object(w.jsx)(je,{id:sn,wrapper:ln,consumer:Fe,ariaDescribedBy:kt,ariaLabelledBy:e,dataView:T,isPlainRecord:Z,selectedFieldNames:Ct,additionalFieldGroups:Ae,selectedDocs:nt,schemaDetectors:Ut,forceShowAllFields:ct,showFullScreenButton:q,fieldFormats:Qe,getDocById:dt,setSelectedDocs:at,setIsCompareActive:st}):Object(w.jsx)(we,{id:sn,"aria-describedby":kt,"aria-labelledby":e,columns:Vt,columnVisibility:Gt,"data-test-subj":"docTable",leadingControlColumns:Zt,onColumnResize:C,pagination:xt,renderCellValue:St,ref:tt,rowCount:vt,schemaDetectors:Ut,sorting:Qt,toolbarVisibility:rn,rowHeightsOptions:on,inMemory:an,gridStyle:null!=Pe?Pe:x.b,renderCustomGridBody:ae,renderCustomToolbar:tn,trailingControlColumns:Xt,cellContext:$e,renderCellPopover:Ot})),I!==Oe.loading&&!pt.length&&U&&!ot&&Object(w.jsx)(ue,{isLoadingMore:I===Oe.loadingMore,rowCount:vt,sampleSize:K,pageCount:Et,pageIndex:null==xt?void 0:xt.pageIndex,totalHits:pe,onFetchMoreRecords:me,data:Xe,fieldFormats:Qe}),N&&Object(w.jsx)(d.EuiScreenReaderOnly,null,Object(w.jsx)("p",{id:String(kt)},F?Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescriptionGrid",defaultMessage:"Table generated by search {searchTitle} ({searchDescription})",values:{searchTitle:N,searchDescription:F}}):Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescription",defaultMessage:"Table generated by search {searchTitle}",values:{searchTitle:N}}))),Yt&&ye&&fe(ye,mt,lt,n))):Object(w.jsx)("div",{className:"euiDataGrid__noResults","data-render-complete":un,"data-shared-item":"","data-title":N,"data-description":F,"data-document-number":0},Object(w.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(w.jsx)(d.EuiIcon,{type:"discoverApp",size:"m",color:"subdued"}),Object(w.jsx)(d.EuiSpacer,{size:"s"}),Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.noResultsFound",defaultMessage:"No results found"}))):Object(w.jsx)("div",{className:"euiDataGrid__loading","data-test-subj":"unifiedDataTableLoading"},Object(w.jsx)(d.EuiText,{size:"xs",color:"subdued"},Object(w.jsx)(d.EuiLoadingSpinner,null),Object(w.jsx)(d.EuiSpacer,{size:"s"}),Object(w.jsx)(s.FormattedMessage,{id:"unifiedDataTable.loadingResults",defaultMessage:"Loading results"})))}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(204),r=n(818);const o=e=>Object(a.useMemo)((()=>({async addExceptionListItem({listItem:t}){const n=new AbortController,a=Object(r.c)(t);return i.a({http:e,listItem:a,signal:n.signal})},async deleteExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:r}){const o=new AbortController;try{await i.e({http:e,id:t,namespaceType:n,signal:o.signal}),a()}catch(e){r(e)}},async deleteExceptionList({id:t,namespaceType:n,onSuccess:a,onError:r}){const o=new AbortController;try{await i.d({http:e,id:t,namespaceType:n,signal:o.signal}),a()}catch(e){r(e)}},async duplicateExceptionList({includeExpiredExceptions:t,listId:n,namespaceType:a,onError:r,onSuccess:o}){const s=new AbortController;try{o(await i.h({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:s.signal}))}catch(e){r(e)}},async exportExceptionList({id:t,includeExpiredExceptions:n,listId:a,namespaceType:r,onError:o,onSuccess:s}){const l=new AbortController;try{s(await i.i({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:r,signal:l.signal}))}catch(e){o(e)}},async getExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:o}){const s=new AbortController;try{a(Object(r.b)(await i.l({http:e,id:t,namespaceType:n,signal:s.signal})))}catch(e){o(e)}},async getExceptionList({id:t,namespaceType:n,onSuccess:a,onError:r}){const o=new AbortController;try{a(await i.k({http:e,id:t,namespaceType:n,signal:o.signal}))}catch(e){r(e)}},async getExceptionListsItems({lists:t,filter:n,pagination:a,showDetectionsListsOnly:o,showEndpointListsOnly:s,onSuccess:l,onError:c}){const u=new AbortController,{ids:d,namespaces:p}=(({lists:e,showDetection:t,showEndpoint:n})=>e.filter((e=>t?"detection"===e.type:!n||"endpoint"===e.type)).reduce(((e,{listId:t,namespaceType:n})=>({ids:[...e.ids,t],namespaces:[...e.namespaces,n]})),{ids:[],namespaces:[]}))({lists:t,showDetection:o,showEndpoint:s});try{if(d.length>0&&p.length>0){const{data:t,page:o,per_page:s,total:c}=await i.n({filter:n,http:e,listIds:d,namespaceTypes:p,pagination:a,signal:u.signal});l({exceptions:t.map((e=>Object(r.b)(e))),pagination:{page:o,perPage:s,total:c}})}else l({exceptions:[],pagination:{page:0,perPage:null!=a.perPage?a.perPage:0,total:0}})}catch(e){c(e)}},async getExceptionFilterFromIds({exceptionListIds:t,chunkSize:n,alias:a,excludeExceptions:r,onSuccess:o,onError:s}){const l=new AbortController;try{const{filter:s}=await i.q({http:e,exceptionListIds:t,signal:l.signal,chunkSize:n,alias:a,excludeExceptions:r});o(s)}catch(e){s(e)}},async getExceptionFilterFromExceptions({exceptions:t,chunkSize:n,alias:a,excludeExceptions:r,onSuccess:o,onError:s}){const l=new AbortController;try{const{filter:s}=await i.r({http:e,exceptions:t,signal:l.signal,chunkSize:n,alias:a,excludeExceptions:r});o(s)}catch(e){s(e)}},async updateExceptionListItem({listItem:t}){const n=new AbortController,a=Object(r.d)(t);return i.y({http:e,listItem:a,signal:n.signal})}})),[e])},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(119),i=n.n(a),r=n(84),o=n(2),s=n.n(o),l=n(19),c=n(43),u={name:"1azakc",styles:"text-align:center"};const d=()=>{const e=u;return Object(c.jsx)("div",{css:e},Object(c.jsx)(l.EuiLoadingSpinner,null))},p=(e,t=Object(c.jsx)(d,null))=>s.a.forwardRef(((n,a)=>Object(c.jsx)(r.KibanaErrorBoundaryProvider,{analytics:n.analytics},Object(c.jsx)(r.KibanaErrorBoundary,null,Object(c.jsx)(o.Suspense,{fallback:t},Object(c.jsx)(e,i()({},n,{ref:a})))))))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(46);const i=new a.Type("IsoDateString",a.string.is,((e,t)=>{if("string"!=typeof e)return a.failure(e,t);try{return new Date(e).toISOString()===e?a.success(e):a.failure(e,t)}catch(n){return a.failure(e,t)}}),a.identity)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>t=>{const n=null!=t.signal?t.signal:(new AbortController).signal;return e({...t,signal:n})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(1213);const r=e=>{const t=Object(i.a)(),[n,r]=Object(a.useState)(!1),[o,s]=Object(a.useState)(),[l,c]=Object(a.useState)();return{error:o,loading:n,result:l,start:Object(a.useCallback)(((...n)=>{r(!0),c(void 0),s(void 0),e(...n).then((e=>t()&&c(e))).catch((e=>t()&&s(e))).finally((()=>t()&&r(!1)))}),[e,t])}}},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"g",(function(){return f}));var a=n(50),i=n(1342),r=n(1870),o=(n(1619),n(1282),n(1283),n(796),n(1328),n(1556),n(1447),n(403));n(750),n(53),n(233),n(1470);const s=e=>e.map((e=>"nested"===e.type?Object(i.a)({...e,entries:e.entries.map((e=>Object(i.a)(e)))}):Object(i.a)(e))),l=({listId:e,namespaceType:t,name:n})=>({comments:[],description:"Exception list item",entries:s([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:e,meta:{temporaryUuid:Object(a.v4)()},name:n,namespace_type:t,tags:[],type:"simple"}),c=e=>{switch(e.type){case"match":return o.b.MATCH;case"match_any":return o.b.MATCH_ANY;case"wildcard":return o.b.WILDCARD;case"list":return o.b.LIST;default:return o.b.EXISTS}},u=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time > "${t}" OR NOT ${e}.attributes.expire_time: *`)).join(",")},d=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time <= "${t}"`)).join(",")},p=e=>{let t=e.match(/.ds-(.*?)-[0-9]{4}\.[0-9]{2}\.[0-9]{2}-[0-9]{6}/);return t&&2===t.length?t[1]:(t=e.match(/.siem-(.*?)-[0-9]{6}/),t&&2===t.length?`.siem-${t[1]}`:e)},m=e=>{if(!e.conflictDescriptions)return null;const t=[];for(const[n,a]of Object.entries(e.conflictDescriptions)){const e=[],i={};a.forEach((e=>{const t=p(e);i[t]||(i[t]=0),i[t]++}));for(const[t,n]of Object.entries(i))e.push({name:t,count:n});e.sort(((e,t)=>t.count-e.count)),t.push({type:n,totalIndexCount:a.length,groupedIndices:e})}return t},f=e=>e.flatMap((e=>e.entries)).some((e=>{if("list"!==e.type&&"value"in e)return Object(r.f)({operator:e.type,value:e.value})}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(46),i=n(1448),r=n(1256),o=n(506),s=n(399),l=n(255),c=n(400),u=n(574),d=n(275),p=n(456),m=n(507),f=n(752),g=n(1284);const b=a.intersection([a.exact(a.type({description:s.a,entries:f.a,list_id:l.a,name:c.a,type:u.a})),a.exact(a.partial({comments:r.a,expire_time:g.a,item_id:i.a,meta:d.a,namespace_type:p.a,os_types:o.c,tags:m.a}))])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(204),i=n(1532),r=n(1533);const o=Object(i.a)(a.t),s=()=>Object(r.a)(o)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(1559);const i=e=>{try{const t=Object(a.a)(e);return r(t)}catch(e){return[]}},r=e=>e?e.split(",").map((e=>e.trim())):[]},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(89);function i(e){var t;const{ast:n}=Object(a.getAstAndSyntaxErrors)(e),i=n.find((({name:e})=>["from","metrics"].includes(e))),r=(null!==(t=null==i?void 0:i.args)&&void 0!==t?t:[]).filter((e=>"index"===e.sourceType));return null==r?void 0:r.map((e=>e.text)).join(",")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n(2);var a=n(42),i=n(4),r=n(19),o=n(43);const s=()=>Object(o.jsx)(r.EuiCallOut,{title:i.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.title",{defaultMessage:"Please review your entries"}),iconType:"warning",color:"warning",size:"s","data-test-subj":"wildcardWithWrongOperatorCallout"},Object(o.jsx)("p",null,Object(o.jsx)(a.FormattedMessage,{id:"exceptionList-components.wildcardWithWrongOperatorCallout.body",defaultMessage:'Using a "*" or a "?" in the value with the "is" operator can make the entry ineffective. {operator} to "{matches}" to ensure wildcards run properly.',values:{operator:Object(o.jsx)("strong",null,i.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.changeTheOperator",{defaultMessage:"Change the operator"})),matches:Object(o.jsx)("strong",null,i.i18n.translate("exceptionList-components.wildcardWithWrongOperatorCallout.matches",{defaultMessage:"matches"}))}})))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),i=n.n(a),r=n(43),o=n(19),s=n(49),l=n(1314),c=n(842),u=n(1315),d=n.n(u);const p=Object(r.css)("margin:",s.euiThemeVars.euiSizeL," 0;padding:",s.euiThemeVars.euiSizeL," 0;",""),m=({title:e,body:t,buttonText:n,listType:i,isReadOnly:s,viewerStatus:u,onEmptyButtonStateClick:m})=>{const{euiTheme:f}=Object(o.useEuiTheme)(),g=Object(a.useMemo)((()=>{switch(u){case l.a.ERROR:return{color:"danger",iconType:"error",title:Object(r.jsx)("h2",{"data-test-subj":"errorTitle"},e||c.g),body:Object(r.jsx)("p",{"data-test-subj":"errorBody"},t||c.f),"data-test-subj":"errorViewerState"};case l.a.EMPTY:return{color:"subdued",iconType:"plusInCircle",iconColor:f.colors.darkestShade,title:Object(r.jsx)("h2",{"data-test-subj":"emptyTitle"},e||c.d),body:Object(r.jsx)("p",{"data-test-subj":"emptyBody"},t||c.a),"data-test-subj":"emptyViewerState",actions:[Object(r.jsx)(o.EuiButton,{"data-test-subj":"emptyStateButton",onClick:m,iconType:"plusInCircle",color:"primary",isDisabled:s,fill:!0},n||c.e(i||"rule"))]};case l.a.EMPTY_SEARCH:return{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:Object(r.jsx)(o.EuiImage,{size:"fullWidth",alt:"",src:d.a}),title:Object(r.jsx)("h3",{"data-test-subj":"emptySearchTitle"},e||c.c),body:Object(r.jsx)("p",{"data-test-subj":"emptySearchBody"},t||c.b),"data-test-subj":"emptySearchViewerState"}}}),[u,f.colors.darkestShade,e,t,m,s,n,i]);return Object(r.jsx)(o.EuiSkeletonText,{lines:4,"data-test-subj":"loadingViewerState",isLoading:u===l.a.LOADING||u===l.a.SEARCHING},Object(r.jsx)(o.EuiPanel,{css:p,color:"empty_search"===u?"subdued":"transparent"},Object(r.jsx)(o.EuiEmptyPrompt,g)))},f=i.a.memo(m);f.displayName="EmptyViewerState"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(446);const r=Object(i.c)(),o=()=>{const[e]=Object(a.useState)(r);return{globalKQLHeaderPortalNode:e}}},,,,,,function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1570);case"v8light":return n(1572)}},function(e,t,n){var a=n(185),i=n(1571);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){var a=n(186),i=n(1410),r=n(1411);t=a(!1);var o=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px rgba(0,0,0,.175),0 1.9px 4px rgba(0,0,0,.125),0 4.5px 10px rgba(0,0,0,.125)}.kbnSolutionAvatar--xxl{background:#1d1e24 url("+o+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,n){var a=n(185),i=n(1573);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){var a=n(186),i=n(1410),r=n(1411);t=a(!1);var o=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px #00000012,0 1.9px 4px #0000000d,0 4.5px 10px #0000000d}.kbnSolutionAvatar--xxl{background:#fff url("+o+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,n){e.exports=n.p+"baad30acfe492601d08a0e839c9bb3f5.svg"},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1576);case"v8light":return n(1578)}},function(e,t,n){var a=n(185),i=n(1577);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#141519}.kbnSolutionNav__flyout .kbnSolutionNav{flex:auto}.kbnSolutionNav{display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px)and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px)and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,n){var a=n(185),i=n(1579);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#fafbfd}.kbnSolutionNav__flyout .kbnSolutionNav{flex:auto}.kbnSolutionNav{display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px)and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px)and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1581);case"v8light":return n(1583)}},function(e,t,n){var a=n(185),i=n(1582);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#1d1e24!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},function(e,t,n){var a=n(185),i=n(1584);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(186)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#fff!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(4);const i=a.i18n.translate("xpack.securitySolution.dashboards.pageTitle",{defaultMessage:"Dashboards"}),r=a.i18n.translate("xpack.securitySolution.dashboards.dashboard.createDashboardTitle",{defaultMessage:"Editing New Dashboard"})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(344),i=n(426),r=(n(455),n(46)),o=n(44);const s=(e,t)=>{if(null===t&&null===e)return[];if(null!=t){if("object"!=typeof e||null==e)return[];{const n=Object.keys(t);return Object.keys(e).flatMap((a=>{const i=n.some((e=>e===a))?[]:[a],r=Object(o.get)(a,e),l=Object(o.get)(a,t);return Object(o.isObject)(r)?[...i,...s(r,l)]:Array.isArray(r)?[...i,...r.flatMap(((e,t)=>s(e,Object(o.get)(t,l))))]:i}))}}try{return[JSON.stringify(e)]}catch(e){return["circular reference"]}},l=e=>{const t=e.map((e=>{if(null!=e.message)return e.message;{const t=e.context.filter((e=>null!=e.key&&!Number.isInteger(+e.key)&&""!==e.key.trim())).map((e=>e.key)).join(","),n=e.context.find((e=>null!=e.type&&null!=e.type.name&&e.type.name.length>0)),a=""!==t?t:null!=n?n.type.name:"";return`Invalid value "${Object(o.isObject)(e.value)?JSON.stringify(e.value):e.value}" supplied to "${a}"`}}));return[...new Set(t)]},c=(e,t)=>{const n=(r=e,o=t.decode(e),Object(i.pipe)(o,Object(a.fold)((e=>Object(a.left)(e)),(e=>{const t=s(r,e);if(0!==t.length){const e=[{value:t,context:[],message:`invalid keys "${t.join(",")}"`}];return Object(a.left)(e)}return Object(a.right)(e)}))));var r,o;return Object(a.isLeft)(n)?[null,l(n.left).join(",")]:[n.right,null]},u=(e,t)=>Object(i.pipe)(t,(t=>e.validate(t,r.getDefaultContext(e.asDecoder()))),Object(a.mapLeft)((e=>new Error(l(e).join(",")))))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(7),i=n(44),r=n(1325);const o=({filters:e,namespaceTypes:t,hideLists:n})=>{const o=Object(r.a)({namespaceType:t}),s=((e,t)=>Object.keys(e).map((n=>{const r=Object(i.get)(n,e);return Object(a.isArray)(r)||null!=r&&""!==r.trim()?`(${t.map((e=>{const t="name"===n?"name.text":"types"===n?"type":n;return Object(a.isArray)(r)?r.map((n=>`${e}.attributes.${t}:${n}`)).join(" OR "):`${e}.attributes.${t}:${r}`})).join(" OR ")})`:null})).filter((e=>null!=e)).join(" AND "))(e,o);return[s,...n.map((e=>`(${o.map((t=>`not ${t}.attributes.list_id: ${e}*`)).join(" AND ")})`))].filter((e=>""!==e.trim())).join(" AND ")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let a=function(e){return e.top="top",e.bottom="bottom",e}({})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(19),i=n(2),r=n.n(i),o=n(241);const s=n(4).i18n.translate("xpack.elasticAssistant.assistant.newChatByTitle.newChatByTitleButton",{defaultMessage:"Chat"});var l=n(43);const c=({children:e=s,conversationTitle:t,iconType:n,promptContextId:r,iconOnly:c=!1})=>{const{showAssistantOverlay:u}=Object(o.b)(),d=Object(i.useCallback)((()=>{u({conversationTitle:t,promptContextId:r,showOverlay:!0})}),[t,r,u]),p=Object(i.useMemo)((()=>{if(null!==n)return null!=n?n:"discuss"}),[n]);return Object(i.useMemo)((()=>c?Object(l.jsx)(a.EuiToolTip,{content:s},Object(l.jsx)(a.EuiButtonIcon,{"data-test-subj":"newChatByTitle",iconType:null!=p?p:"discuss",onClick:d,color:"text","aria-label":s})):Object(l.jsx)(a.EuiButtonEmpty,{"data-test-subj":"newChatByTitle",iconType:p,onClick:d,"aria-label":s},e)),[e,p,d,c])};c.displayName="NewChatByTitleComponent";const u=r.a.memo(c)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"469b2aa1ba8b4540f10576015bf55357.gif"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(19),l=n(52),c=n.n(l),u=(n(1575),n(42)),d=n(4),p=(n(1569),n(43));const m=e=>{const{className:t,size:n,...a}=e,r={};return(e=>void 0===e.iconType)(e)&&(r.iconType=`logo${e.name.replace(/\s+/g,"")}`),Object(p.jsx)(s.EuiAvatar,i()({className:c()("kbnSolutionAvatar",{[`kbnSolutionAvatar--${n}`]:n},t),size:"xxl"===n?"xl":n,iconSize:n,color:"plain"},a,r))};n(1580);const f=d.i18n.translate("sharedUXPackages.solutionNav.collapsibleLabel",{defaultMessage:"Collapse side navigation"}),g=d.i18n.translate("sharedUXPackages.solutionNav.openLabel",{defaultMessage:"Open side navigation"}),b=({className:e,isCollapsed:t,...n})=>{const a=c()("kbnSolutionNavCollapseButton",{"kbnSolutionNavCollapseButton-isCollapsed":t},e);return Object(p.jsx)(s.EuiButtonIcon,i()({className:a,size:"s",color:"text",iconType:t?"menuRight":"menuLeft","aria-label":t?g:f,title:t?g:f},n))},y="248px",h=(e,t)=>e.map((e=>(e.tabIndex=t?-1:void 0,e.items=e.items&&h(e.items,t),e))),v=Object(s.htmlIdGenerator)("SolutionNav"),E=({children:e,headingProps:t,icon:n,isOpenOnDesktop:a=!1,items:l,mobileBreakpoints:f=["xs","s"],closeFlyoutButtonPosition:g="outside",name:E,onCollapse:x,canBeCollapsed:j=!0,...S})=>{const O=Object(s.useIsWithinBreakpoints)(f),k=Object(s.useIsWithinBreakpoints)(["m"]),w=Object(s.useIsWithinMinBreakpoint)("l"),[T,I]=Object(r.useState)(!1),M=w&&!a&&j,C=!!e,_=c()("kbnSolutionNav",{"kbnSolutionNav--hidden":M}),D=(null==t?void 0:t.id)||v("heading"),A=(null==t?void 0:t.element)||"h2",F=Object(p.jsx)(s.EuiTitle,{size:"xs",id:D,"data-test-subj":null==t?void 0:t["data-test-subj"],className:"kbnSolutionNav__title"},Object(p.jsx)(A,null,n&&Object(p.jsx)(m,{className:"kbnSolutionNav__titleAvatar",iconType:n,name:E}),Object(p.jsx)("strong",null,Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.solutionNav.mobileTitleText",defaultMessage:"{solutionName} {menuText}",values:{solutionName:E||"Navigation",menuText:O?d.i18n.translate("sharedUXPackages.solutionNav.menuText",{defaultMessage:"menu"}):""}})))),N=Object(r.useMemo)((()=>C?e:l?Object(p.jsx)(s.EuiSideNav,i()({"aria-labelledby":D,"aria-hidden":M,items:h(l,M),mobileBreakpoints:[]},S)):null),[e,D,C,M,l,S]),{euiTheme:P}=Object(s.useEuiTheme)(),R=Object(r.useMemo)((()=>w?a?y:P.size.xxl:k?T||!j?y:P.size.xxl:"0"),[P,a,T,j,k,w]),{setGlobalCSSVariables:L}=Object(s.useEuiThemeCSSVariables)();return Object(r.useEffect)((()=>{L({"--kbnSolutionNavOffset":R})}),[R,L]),Object(p.jsx)(o.a.Fragment,null,O&&Object(p.jsx)(s.EuiCollapsibleNavGroup,{className:_,paddingSize:"none",background:"none",title:F,titleElement:"span",isCollapsible:j,initialIsOpen:!1},Object(p.jsx)(s.EuiPanel,{color:"transparent",paddingSize:"s"},N)),k&&Object(p.jsx)(o.a.Fragment,null,(T||!j)&&Object(p.jsx)(s.EuiFlyout,{ownFocus:!1,outsideClickCloses:!0,onClose:()=>I(!1),side:"left",size:248,closeButtonPosition:g,className:"kbnSolutionNav__flyout",hideCloseButton:!j},Object(p.jsx)(s.EuiPageSidebar,{className:_,hasEmbellish:!0},F,Object(p.jsx)(s.EuiSpacer,{size:"l"}),N)),j&&Object(p.jsx)(b,{isCollapsed:!0,onClick:()=>{I(!T)}})),w&&Object(p.jsx)(o.a.Fragment,null,Object(p.jsx)("div",{className:_},F,Object(p.jsx)(s.EuiSpacer,{size:"l"}),N),j&&Object(p.jsx)(b,{isCollapsed:!a,onClick:x})))};var x=n(152);const j="solutionNavIsCollapsed",S=e=>{const t=t=>{var n;const a=Object(s.useIsWithinBreakpoints)(["m"]),o=Object(s.useIsWithinMinBreakpoint)("l"),[l,u]=Object(r.useState)(!JSON.parse(String(localStorage.getItem(j)))),{solutionNav:d,children:m,...f}=t,{euiTheme:g}=Object(s.useEuiTheme)(),{canBeCollapsed:b=!0}=d,y=a||b&&o&&!l,h=(e=>Object(x.css)("flex:0 1 0;overflow:hidden;",s.euiCanAnimate,"{transition:min-width ",e.animation.fast," ",e.animation.resistance,";}",""))(g),v=c()("kbnSolutionNav__sidebar",{"kbnSolutionNav__sidebar--shrink":y},null===(n=t.pageSideBarProps)||void 0===n?void 0:n.className,h),S=Object(p.jsx)(E,i()({isOpenOnDesktop:l,onCollapse:()=>{u(!l),localStorage.setItem(j,JSON.stringify(l))}},d)),O={paddingSize:"none",...t.pageSideBarProps,minWidth:y?g.size.xxl:void 0,className:v,hasEmbellish:!y};return Object(p.jsx)(e,i()({},f,{pageSideBar:S,pageSideBarProps:O}),m)};var n;return t.displayName=`WithSolutionNavBar(${n=e,n.displayName||n.name||"UnnamedComponent"})`,t};n(8);const O=o.a.createContext(null),k={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},w=({children:e,navigateToUrl:t,currentAppId:n,...a})=>{const o=Object(r.useRef)(null),s=Object(r.useCallback)((e=>(({event:e,container:t,navigateToUrl:n,currentAppId:a})=>{if(!t||!a)return;const i=((e,t)=>{let n=e;do{var a,i;if("a"===(null===(a=n)||void 0===a?void 0:a.tagName.toLowerCase()))return n;const e=null===(i=n)||void 0===i?void 0:i.parentElement;if(!e||e===document.body||e===t)break;n=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!i)return;const r=i.href,o=""===i.target||"_self"===i.target,s=0===e.button;r&&o&&s&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),n(i.href))})({event:e,currentAppId:n,navigateToUrl:t,container:o.current})),[n,t]);return Object(p.jsx)("div",i()({onClick:s,ref:o,css:k,"data-test-subj":"kbnRedirectAppLink"},a),e)},T=({children:e,...t})=>Object(p.jsx)(w,i()({},function(){const e=Object(r.useContext)(O);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e);var I=n(1574),M=n.n(I);const C=d.i18n.translate("sharedUXPackages.card.noData.noPermission.title",{defaultMessage:"Contact your administrator"}),_=d.i18n.translate("sharedUXPackages.card.noData.noPermission.description",{defaultMessage:"This integration is not yet enabled. Your administrator has the required permissions to turn it on."}),D=d.i18n.translate("sharedUXPackages.card.noData.title",{defaultMessage:"Add Elastic Agent"}),A=d.i18n.translate("sharedUXPackages.card.noData.description",{defaultMessage:"Use Elastic Agent for a simple, unified way to collect data from your machines."}),F=()=>Object(p.jsx)(s.EuiImage,{size:"fullWidth",style:{width:"max(100%, 360px)",height:240,objectFit:"cover",background:"aliceblue"},url:M.a,alt:""}),N=({title:e,description:t,canAccessFleet:n,button:a,href:r,...o})=>Object(p.jsx)(s.EuiCard,i()({css:{maxWidth:400,marginInline:"auto"},paddingSize:"l",title:n?Object(p.jsx)(s.EuiScreenReaderOnly,null,Object(p.jsx)("span",null,e||D)):Object(p.jsx)(s.EuiTextColor,{color:"default"},C),description:n?t||A:Object(p.jsx)(s.EuiTextColor,{color:"default"},_),footer:(()=>{if(n)return a&&"string"!=typeof a?a:Object(p.jsx)(s.EuiButton,{fill:!0,href:r,"data-test-subj":"noDataDefaultFooterAction"},a||e||D)})(),isDisabled:!n,href:r,image:Object(p.jsx)(F,null)},o)),P=o.a.createContext(null),R=({href:e,category:t,description:n,...a})=>{var o;const{canAccessFleet:s,addBasePath:l}=function(){const e=Object(r.useContext)(P);if(!e)throw new Error("NoDataCard Context is missing.  Ensure your component or React root is wrapped with NoDataCardContext.");return e}(),c=Object(r.useMemo)((()=>{if(e)return e;const n="/app/integrations/browse";return l(t?`${n}/${t}`:n)}),[l,e,t]);return Object(p.jsx)(T,null,Object(p.jsx)(N,i()({},a,{href:c,canAccessFleet:null!==(o=a.canAccessFleet)&&void 0!==o?o:s,description:n})))},L=({action:e})=>{const t=Object.keys(e);if(1!==t.length)return null;const n=t[0],a="elasticAgent"===n?"empty-page-agent-action":`empty-page-${n}-action`;return Object(p.jsx)(R,i()({key:a},e[n]))},z=({solution:e,logo:t,action:n,docsLink:a,pageTitle:i,pageDescription:r,className:o})=>{const l=i||d.i18n.translate("sharedUXPackages.noDataPage.welcomeTitle",{defaultMessage:"Welcome to Elastic {solution}!",values:{solution:e}}),f=a?Object(p.jsx)(s.EuiLink,{href:a,target:"_blank"},Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro.link",defaultMessage:"learn more"})):null,g=null!=r?r:f?Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro",defaultMessage:"Add your data to get started, or {link} about {solution}.",values:{solution:e,link:f}}):Object(p.jsx)(u.FormattedMessage,{id:"sharedUXPackages.noDataPage.introNoDocLink",defaultMessage:"Add your data to get started."});return Object(p.jsx)(s.EuiPageTemplate.Section,{alignment:"center",grow:!0,className:c()("kbnNoDataPageContents",o),"data-test-subj":"kbnNoDataPage"},Object(p.jsx)(s.EuiText,{textAlign:"center"},Object(p.jsx)(m,{name:e,iconType:t||`logo${e}`,size:"xxl"}),Object(p.jsx)(s.EuiSpacer,{size:"l"}),Object(p.jsx)("h1",null,l),Object(p.jsx)(s.EuiTextColor,{color:"subdued"},Object(p.jsx)("p",null,g))),Object(p.jsx)(s.EuiSpacer,{size:"xxl"}),Object(p.jsx)(L,{action:n}))},q=e=>{const{className:t,noDataConfig:n,pageSideBar:a,pageSideBarProps:r,...o}=e;if(!n)return null;let l;a&&(l=Object(p.jsx)(s.EuiPageTemplate.Sidebar,r,a));const u=((e,t)=>c()("kbnPageTemplate","",t||""))(0,t);return Object(p.jsx)(s.EuiPageTemplate,i()({className:u,restrictWidth:950,panelled:!1,offset:0,minHeight:0},o),l,Object(p.jsx)(z,n))},B=S(q),$=({className:e,pageHeader:t,children:n,isEmptyState:a,pageSideBar:r,pageSideBarProps:o,emptyPageBody:l,...u})=>{let d,m;if(a&&t&&!n){const{iconType:e,pageTitle:a,description:i,rightSideItems:r}=t,o=a?Object(p.jsx)("h1",null,a):void 0,l=i?Object(p.jsx)("p",null,i):void 0;n=Object(p.jsx)(s.EuiPageTemplate.EmptyPrompt,{iconType:e,iconColor:"",title:o,body:l,actions:r})}else t&&(d=Object(p.jsx)(s.EuiPageTemplate.Header,t));if(a&&l&&(n=l),r){const e={...o};e.sticky=!0,m=Object(p.jsx)(s.EuiPageTemplate.Sidebar,e,r)}const f=((e,t)=>c()("kbnPageTemplate","",t||""))(0,e);return Object(p.jsx)(s.EuiPageTemplate,i()({className:f,offset:0,minHeight:d?"calc(100vh - var(--kbnAppHeadersOffset, var(--euiFixedHeadersOffset, 0)))":0,grow:!d&&void 0},u),m,d,n)},V=S($),U=Object.assign((({className:e,children:t,solutionNav:n,noDataConfig:a,...r})=>a&&n?Object(p.jsx)(B,{"data-test-subj":r["data-test-subj"],className:e,noDataConfig:a,solutionNav:n}):a?Object(p.jsx)(q,{"data-test-subj":r["data-test-subj"],className:e,noDataConfig:a}):n?Object(p.jsx)(V,i()({className:e,solutionNav:n,children:t},r)):Object(p.jsx)($,i()({className:e,children:t},r))),{Sidebar:s.EuiPageTemplate.Sidebar,Header:s.EuiPageTemplate.Header,Section:s.EuiPageTemplate.Section,BottomBar:s.EuiPageTemplate.BottomBar,EmptyPrompt:s.EuiPageTemplate.EmptyPrompt})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"SecuritySolutionTemplateWrapper",(function(){return Nt}));var a=n(119),i=n.n(a),r=n(2),o=n.n(r),s=n(41),l=n.n(s),c=n(19),u=n(128),d=n(2052),p=n(12),m=n(45),f=n(48),g=n(819),b=n(1397),y=n(870),h=n(582),v=n(43);const E=()=>{const{urlKey:e}=Object(g.b)(),t=Object(b.a)(),n=Object(y.f)(Object(y.b)()),a=Object(y.e)(),i=Object(f.useHistory)(),o=Object(r.useMemo)((()=>Object(p.createKbnUrlStateStorage)({history:i,useHash:!1,useHashQuery:!1})),[i]);return Object(r.useEffect)((()=>{if(!e)return;const t=o.get(e);var n;t&&a(Object(h.j)({...t,preview:null==t||null===(n=t.preview)||void 0===n?void 0:n.at(-1),id:e}));const i=o.change$(e).subscribe((t=>{var n;a(Object(h.j)({...t,preview:null==t||null===(n=t.preview)||void 0===n?void 0:n.at(-1),id:e}))}));return()=>i.unsubscribe()}),[a,e,o]),Object(r.useEffect)((()=>{if(!n||!t||!e)return;const{left:a,right:i,preview:r}=t;o.set(e,{left:a,right:i,preview:[null==r?void 0:r.at(-1)]})}),[n,t,e,o]),null},x=({children:e,urlKey:t})=>Object(v.jsx)(g.a,{urlKey:t},Object(v.jsx)(m.Provider,{context:y.a,store:y.d},t?Object(v.jsx)(E,null):null,e));var j=n(118),S=n(1676),O=n(1438),k=n(1506);const w=Object(r.memo)((({children:e})=>{const{services:t}=Object(j.j)(),n=Object(m.useDispatch)();return Object(r.useEffect)((()=>(Object(S.d)(Object(S.b)({})),Object(S.d)(Object(S.a)({dataViewsService:t.dataViews})),n(Object(O.a)(k.a)),()=>S.c.clearListeners())),[t,n]),o.a.createElement(o.a.Fragment,null,e)}));w.displayName="DataviewPickerProvider";var T=n(246),I=n(4);const M=I.i18n.translate("xpack.securitySolution.attackDiscovery.tour.navStep.title",{defaultMessage:"Introducing attack discovery"}),C=I.i18n.translate("xpack.securitySolution.attackDiscovery.tour.navStep.desc",{defaultMessage:"Leverage Generative AI to find relationships among your alerts and describe attack chains."}),_=I.i18n.translate("xpack.securitySolution.attackDiscovery.tour.videoStep.title",{defaultMessage:"Start discovering attacks"}),D=I.i18n.translate("xpack.securitySolution.attackDiscovery.tour.videoStep.desc",{defaultMessage:"Dive into data-driven attack discoveries and streamline your workflow with our intuitive AI technology, designed to elevate your productivity instantly."}),A=I.i18n.translate("xpack.securitySolution.attackDiscovery.tour.exit",{defaultMessage:"Close"}),F=I.i18n.translate("xpack.securitySolution.attackDiscovery.tour.tryIt",{defaultMessage:"Try it"}),N=I.i18n.translate("xpack.securitySolution.attackDiscovery.tour.video",{defaultMessage:"Watch overview video"});var P=n(1963),R=n.n(P);const L=({onClose:e})=>{const t=Object(r.useCallback)((()=>{window.open("https://videos.elastic.co/watch/BrDaDBAAvdygvemFKNAkBW","_blank")}),[]);return o.a.createElement(c.EuiPortal,null,o.a.createElement(q,{"data-test-subj":"attackDiscovery-tour-step-2"},o.a.createElement(B,{onClose:e,$_css:250},o.a.createElement($,{onClick:t,src:R.a,"data-test-subj":"video-gif",alt:N}),o.a.createElement(V,{size:"s",grow:!1},o.a.createElement("h4",null,o.a.createElement(c.EuiIcon,{type:"cheer",color:"success"})," ",_),o.a.createElement("p",null,D)),o.a.createElement(c.EuiSpacer,{size:"m"}),o.a.createElement(c.EuiButton,{color:"success",onClick:t,fullWidth:!0},N))))},z=o.a.memo(L);var q=l()("div")({position:"fixed",bottom:16,right:16,zIndex:9999}),B=l()(c.EuiToast)((e=>({maxWidth:e.$_css}))),$=l()(c.EuiImage)({marginTop:20,"&:hover":{cursor:"pointer"}}),V=l()(c.EuiText).withConfig({displayName:"_StyledEuiText",componentId:"sc-k1ck5c-0"})({marginTop:20}),U=n(768),G=n(5);const H={title:M,content:C,anchor:"solutionSideNavItemLink-attack_discovery"},W={currentTourStep:1,isTourActive:!0},Q=()=>{var e;const{services:{storage:t}}=Object(j.j)(),{navigateTo:n}=Object(j.l)(),[{pageName:a}]=Object(T.a)(),[i,s]=Object(r.useState)(null!==(e=t.get(G.cc.ATTACK_DISCOVERY))&&void 0!==e?e:W),l=Object(r.useCallback)((()=>{s((e=>(t.set(G.cc.ATTACK_DISCOVERY,{...e,currentTourStep:2}),{...e,currentTourStep:2})))}),[t]);Object(r.useEffect)((()=>{i.isTourActive&&a===G.Oc.attackDiscovery&&l()}),[l,a,i.isTourActive]);const u=Object(r.useCallback)((()=>{s((e=>(t.set(G.cc.ATTACK_DISCOVERY,{...e,isTourActive:!1}),{...e,isTourActive:!1})))}),[t]),d=Object(r.useCallback)((()=>{n({deepLinkId:G.Oc.attackDiscovery})}),[n]),p=Object(r.useCallback)((()=>{1===i.currentTourStep&&(d(),l())}),[i.currentTourStep,d,l]),m=Object(r.useMemo)((()=>[o.a.createElement(c.EuiButtonEmpty,{size:"s",color:"text",onClick:l},A),o.a.createElement(c.EuiButton,{color:"success",size:"s",onClick:p},F)]),[l,p]),f=Object(U.a)(null==H?void 0:H.anchor);return null!=window.Cypress||!0===navigator.webdriver||!i.isTourActive||1===i.currentTourStep&&!f?null:1===i.currentTourStep?o.a.createElement(c.EuiTourStep,{anchor:`#${H.anchor}`,content:H.content,footerAction:m,isStepOpen:!0,maxWidth:450,onFinish:l,panelProps:{"data-test-subj":"attackDiscovery-tour-step-1"},repositionOnScroll:!0,step:1,stepsTotal:1,title:H.title}):a===G.Oc.attackDiscovery?o.a.createElement(z,{onClose:u}):null},Y=o.a.memo(Q);var K=n(198),J=n(1319),Z=n(414),X=n(156),ee=n(129),te=n(146),ne=n(194),ae=n(32),ie=n(21),re=n(36),oe=n(44),se=n(349),le=n(276),ce=n(1407);const ue={[se.HostsTableType.hosts]:ce.a,[se.HostsTableType.authentications]:ce.c,[se.HostsTableType.uncommonProcesses]:ce.g,[se.HostsTableType.anomalies]:ce.b,[se.HostsTableType.events]:ce.d,[se.HostsTableType.risk]:ce.e,[se.HostsTableType.sessions]:ce.f};var de=n(433),pe=n(375),me=n(1408),fe=n(580),ge=n(584);const be={[fe.a.events]:me.c,[fe.a.anomalies]:me.a,[fe.a.flows]:me.d,[fe.a.users]:me.g,[fe.a.http]:me.e,[fe.a.tls]:me.f,[ge.a.dns]:me.b};var ye=n(668),he=n(258),ve=n(178),Ee=n(733);const xe=e=>e.includes(G.Cc)&&e.includes("/edit");var je=n(321),Se=n(560),Oe=n(1355);const ke={[je.UsersTableType.allUsers]:Oe.a,[je.UsersTableType.authentications]:Oe.c,[je.UsersTableType.anomalies]:Oe.b,[je.UsersTableType.risk]:Oe.e,[je.UsersTableType.events]:Oe.d,[je.UsersTableType.risk]:Oe.e};var we=n(1587);const Te=(e,t)=>{switch(e.pageName){case re.SecurityPageName.hosts:return((e,t)=>{let n=[];if(null!=e.detailName&&(n=[...n,{text:e.detailName,href:t({path:Object(le.a)(e.detailName,""),deepLinkId:X.a.hosts})}]),null!=e.tabName){const t=Object(oe.get)("tabName",e);if(!t)return n;n=[...n,{text:ue[t],href:""}]}return n})(e,t);case re.SecurityPageName.network:return((e,t)=>{let n=[];null!=e.detailName&&(n=[{text:Object(de.b)(e.detailName),href:t({deepLinkId:X.a.network,path:Object(pe.a)(e.detailName,e.flowTarget,"")})}]);const a=Object(oe.get)("tabName",e);return a?(n=[...n,{text:be[a],href:""}],n):n})(e,t);case re.SecurityPageName.users:return((e,t)=>{let n=[];if(null!=e.detailName&&(n=[{text:e.detailName,href:t({path:Object(Se.c)(e.detailName,""),deepLinkId:X.a.users})}]),null!=e.tabName){const t=Object(oe.get)("tabName",e);if(!t)return n;n=[...n,{text:ke[t],href:""}]}return n})(e,t);case re.SecurityPageName.rules:case re.SecurityPageName.rulesAdd:case re.SecurityPageName.rulesCreate:return((e,t)=>{var n,a,i;let r=[];var o,s,l;return e.detailName&&null!==(n=e.state)&&void 0!==n&&n.ruleName&&(r=[...r,{text:e.state.ruleName,href:t({deepLinkId:X.a.rules,path:Object(he.d)(e.detailName,"")})}]),e.detailName&&null!==(a=e.state)&&void 0!==a&&a.ruleName&&e.tabName&&(r=[...r,{text:(o=e.tabName,null!==(s=ye.a[o])&&void 0!==s?s:ye.a[ye.b.alerts]),href:t({deepLinkId:X.a.rules,path:Object(he.c)(e.detailName,e.tabName,"")})}]),(l=e.pathName).includes(G.Cc)&&l.includes("/create")&&(r=[...r,{text:ve.e,href:""}]),xe(e.pathName)&&e.detailName&&null!==(i=e.state)&&void 0!==i&&i.ruleName&&(r=[...r,{text:ve.Tb,href:""}]),xe(e.pathName)||!e.state||e.state.isExistingRule||(r=[...r,{text:Ee.a,href:""}]),r})(e,t);case re.SecurityPageName.exceptions:return((e,t)=>{var n;let a=[];var i;return(i=e.pathName).includes(G.Db)&&i.includes("/details")&&null!==(n=e.state)&&void 0!==n&&n.listName&&(a=[...a,{text:e.state.listName}]),a})(e);case re.SecurityPageName.kubernetes:return((e,t)=>{let n=[];return null!=e.detailName&&(n=[{text:e.detailName,href:t({path:Object(ne.e)(e.detailName,""),deepLinkId:X.a.kubernetes})}]),n})(e,t);case re.SecurityPageName.cloudSecurityPostureBenchmarks:return((e,t)=>{var n;const a=[];return null!==(n=e.state)&&void 0!==n&&n.ruleName&&a.push({text:e.state.ruleName}),a})(e);case re.SecurityPageName.dashboards:return((e,t)=>{var n;if(Object(f.matchPath)(e.pathName,{path:"/create"}))return[{text:we.a}];const a=null==e||null===(n=e.state)||void 0===n?void 0:n.dashboardName;return a?[{text:a}]:[]})(e)}return[]},Ie=(e,t,n,a)=>e.map((e=>({...e,...e.href&&!e.onClick&&{onClick:Me(e.href,t,n,a,e.text)}}))),Me=(e,t,n,a,i)=>r=>{r.preventDefault(),"string"==typeof i&&a.reportBreadcrumbClicked({title:i}),t(ee.a.showTimeline({id:te.c.active,show:!1})),n({url:e})};var Ce=n(1706);const _e=Object(r.lazy)((()=>Promise.all([n.e(20),n.e(47)]).then(n.bind(null,2136)))),De=e=>Object(v.jsx)(r.Suspense,{fallback:Object(v.jsx)(c.EuiLoadingSpinner,{size:"xl"})},Object(v.jsx)(_e,e));var Ae=n(8),Fe=n.n(Ae),Ne=n(144),Pe=n(18),Re=n(1292),Le=n(1316),ze=n(17),qe=n(977);const Be=[{type:qe.b.separator,linkIds:[re.SecurityPageName.dashboards]},{type:qe.b.separator,linkIds:[re.SecurityPageName.rulesLanding,re.SecurityPageName.alerts,re.SecurityPageName.attackDiscovery,re.SecurityPageName.cloudSecurityPostureFindings,re.SecurityPageName.case]},{type:qe.b.separator,linkIds:[re.SecurityPageName.timelines,re.SecurityPageName.threatIntelligence,re.SecurityPageName.exploreLanding]}],$e=({onMount:e})=>{const t=(()=>{const e=Object(Pe.e)(),t=Object(Ne.o)();return Object(r.useMemo)((()=>{if(null!=e&&e.length)return e.reduce(((e,n)=>(n.disabled||(n.id===X.a.landing?e.push(((e,t)=>({id:e.id,label:e.title,iconType:e.sideNavIcon,position:Ce.a.bottom,appendSeparator:!0,...t({deepLinkId:e.id})}))(n,t)):e.push(((e,t)=>{var n,a,i;return{id:e.id,label:e.title,position:(i=e.id,i===X.a.landing||i===X.a.administration?Ce.a.bottom:Ce.a.top),...t({deepLinkId:e.id}),...e.sideNavIcon&&{iconType:e.sideNavIcon},...(null===(n=e.categories)||void 0===n?void 0:n.length)&&{categories:e.categories},...(null===(a=e.links)||void 0===a?void 0:a.length)&&{items:e.links.reduce(((e,n)=>(n.disabled||e.push({id:n.id,label:n.title,iconType:n.sideNavIcon,isBeta:n.isBeta,betaOptions:n.betaOptions,...t({deepLinkId:n.id})}),e)),[])}}})(n,t))),e)),[])}),[e,t])})(),n=(()=>{const[{pageName:e}]=Object(T.a)();return Object(r.useMemo)((()=>{var t;const[n]=Object(ie.a)(e);return null!==(t=null==n?void 0:n.id)&&void 0!==t?t:""}),[e])})(),a=(()=>{const{chrome:{hasHeaderBanner$:e}}=Object(j.j)().services,t=Fe()(e()),{euiTheme:n}=Object(c.useEuiTheme)();return t?`calc(93px + ${n.size.xl})`:void 0})(),i=(()=>{const e=Object(Le.a)(),[t]=Object(Re.a)();return t||e?"50px":void 0})();return t?o.a.createElement(De,{items:t,categories:Be,onMount:e,selectedId:n,panelTopOffset:a,panelBottomOffset:i,tracker:ze.h}):o.a.createElement(c.EuiLoadingSpinner,{size:"m","data-test-subj":"sideNavLoader"})},Ve=I.i18n.translate("xpack.securitySolution.navigation.mainLabel",{defaultMessage:"Security"}),Ue=e=>{const{chrome:t}=Object(j.j)().services,n=Object(r.useMemo)((()=>t.getChromeStyle$()),[t]),a=Object(Z.useObservable)(n,"classic");if((()=>{const e=Object(m.useDispatch)(),{telemetry:t}=Object(j.j)().services,[n]=Object(T.a)(),{navigateTo:a}=Object(j.k)(),i=Object(ne.m)();Object(r.useEffect)((()=>{if(!n.pageName||n.pageName===X.a.case)return;const r=(({pageName:e},t)=>[{text:G.k,href:t({deepLinkId:X.a.landing})},...Object(ie.a)(e).map((({title:e,id:n})=>({text:e,href:t({deepLinkId:n})})))])(n,i),o=Te(n,i);Object(ae.b)({leading:Ie(r,e,a,t),trailing:Ie(o,e,a,t)})}),[n,i,e,a,t])})(),"project"!==a)return{canBeCollapsed:!0,name:Ve,icon:"logoSecurity",children:o.a.createElement($e,{onMount:e}),closeFlyoutButtonPosition:"inside"}};var Ge=n(169),He=n(124),We=n(446),Qe=n(1563);const Ye=l.a.div.withConfig({displayName:"StyledStickyWrapper",componentId:"sc-1cu1slq-0"})(["position:sticky;z-index:",";top:var(--kbnAppHeadersOffset,var(--euiFixedHeadersOffset,0));"],(e=>e.theme.eui.euiZHeaderBelowDataGrid)),Ke=o.a.memo((()=>{const{globalKQLHeaderPortalNode:e}=Object(Qe.a)();return o.a.createElement(Ye,{id:"securitySolutionStickyKQL"},o.a.createElement(We.b,{node:e}))}));Ke.displayName="GlobalKQLHeader";var Je=n(242),Ze=n(52),Xe=n.n(Ze),et=n(857),tt=n(304),nt=n(744),at=n(0),it=n.n(at),rt=n(188),ot=n.n(rt),st=n(66);class custom_portal_CustomEuiPortal extends r.Component{constructor(e){if(super(e),it()(this,"portalNode",null),"undefined"==typeof window)return;const{sibling:t}=this.props;this.portalNode=document.createElement("div"),this.portalNode.dataset.euiportal="true",null==t?document.body.appendChild(this.portalNode):t.insertAdjacentElement("afterend",this.portalNode)}componentWillUnmount(){var e;null!==(e=this.portalNode)&&void 0!==e&&e.parentNode&&this.portalNode.parentNode.removeChild(this.portalNode)}componentDidUpdate(e){var t;if(!ot()(e.sibling,this.props.sibling)&&null!==(t=this.portalNode)&&void 0!==t&&t.parentNode&&this.portalNode.parentNode.removeChild(this.portalNode),this.portalNode)if(null==this.props||null==this.props.sibling)document.body.appendChild(this.portalNode);else{const{sibling:e}=this.props;e.insertAdjacentElement("afterend",this.portalNode)}}render(){return this.portalNode?Object(st.createPortal)(this.props.children,this.portalNode):null}}var lt=n(1509),ct=n(152);const ut=()=>o.a.createElement(v.Global,{styles:"body { overflow: hidden }"}),dt=I.i18n.translate("xpack.securitySolution.timeline.modal.timelinePropertiesAriaLabel",{defaultMessage:"Timeline Properties"}),pt=o.a.memo((({timelineId:e,openToggleRef:t,visible:n=!0})=>{var a;const i=Object(r.useRef)(null),s=null!==(a=Object(He.b)(lt.c.timelineFullScreenSelector))&&void 0!==a&&a,l=(()=>{const e=Object(c.useEuiTheme)(),{euiTheme:t}=e;return ct.css`
    // euiOverlayMask styles
    position: fixed;
    top: var(--euiFixedHeadersOffset, 0);
    left: 0;
    right: 0;
    bottom: 0;
    background: ${Object(c.transparentize)(t.colors.ink,.5)};
    z-index: ${t.levels.flyout+1}; // this z-index needs to be between the eventFlyout (set at 1000) and the timelineFlyout (set at 1002)

    ${c.euiCanAnimate} {
      animation: ${c.euiAnimFadeIn} ${t.animation.fast} ease-in;
    }

    &.timeline-portal-overlay-mask--hidden {
      display: none;
    }

    .timeline-container {
      min-width: 150px;
      position: fixed;
      top: var(--euiFixedHeadersOffset, 0);
      right: 0;
      bottom: 0;
      left: 0;
      background: ${Object(c.euiBackgroundColor)(e,"plain")};
      ${c.euiCanAnimate} {
        animation: ${Object(c.euiAnimSlideInUp)(t.size.xxl)} ${t.animation.normal}
          cubic-bezier(0.39, 0.575, 0.565, 1);
      }
    }

    &:not(.timeline-portal-overlay-mask--full-screen) .timeline-container {
      margin: ${t.size.m};
      border-radius: ${t.border.radius.medium};

      .timeline-template-badge {
        border-radius: ${t.border.radius.medium} ${t.border.radius.medium} 0 0; // top corners only
      }
    }
  `})(),u=Xe()("timeline-portal-overlay-mask",l,{"timeline-portal-overlay-mask--full-screen":s,"timeline-portal-overlay-mask--hidden":!n}),d=Object(r.useMemo)((()=>n?null:null==i?void 0:i.current),[n]);return o.a.createElement("div",{"data-test-subj":"timeline-portal-ref",ref:i},o.a.createElement(custom_portal_CustomEuiPortal,{sibling:d},o.a.createElement("div",{"data-test-subj":"timeline-portal-overlay-mask",className:u},o.a.createElement("div",{"aria-label":dt,"data-test-subj":"timeline-container",className:"timeline-container"},o.a.createElement(et.a,{renderCellValue:nt.a,rowRenderers:tt.b,timelineId:e,openToggleRef:t})))),n&&o.a.createElement(ut,null))}));pt.displayName="TimelineModal";const mt=I.i18n.translate("xpack.securitySolution.timeline.bottomBar.addButtonLabel",{defaultMessage:"Add new timeline or template"}),ft=I.i18n.translate("xpack.securitySolution.timeline.bottomBar.newTimelineButtonLabel",{defaultMessage:"Create new Timeline"}),gt=I.i18n.translate("xpack.securitySolution.timeline.bottomBar.newTemplateTimelineButtonLabel",{defaultMessage:"Create new Timeline template"}),bt=I.i18n.translate("xpack.securitySolution.timeline.bottomBar.openTimelineButtonLabel",{defaultMessage:"Open Timeline…"}),yt=e=>I.i18n.translate("xpack.securitySolution.timeline.bottomBar.toggleButtonAriaLabel",{values:{title:e},defaultMessage:"Open timeline {title}"});var ht=n(331),vt=n(121),Et=n(815);const xt=["createFrom"],jt=o.a.memo((({timelineId:e})=>{const[t,n]=Object(r.useState)(!1),[a,i]=Object(r.useState)(!1),s=Object(r.useCallback)((()=>n(!t)),[t]),l=Object(r.useCallback)((()=>i(!1)),[]),u=Object(r.useCallback)((()=>{s(),i(!0)}),[s]),d=Object(ht.a)({timelineId:e,timelineType:vt.m.default,onClick:s}),p=Object(ht.a)({timelineId:e,timelineType:vt.m.template,onClick:s}),m=Object(r.useCallback)((async()=>{await d()}),[d]),f=Object(r.useCallback)((async()=>{await p()}),[p]),g=Object(r.useMemo)((()=>o.a.createElement(c.EuiButtonIcon,{iconType:"plusInCircle",iconSize:"m",color:"primary","data-test-subj":"timeline-bottom-bar-open-button","aria-label":mt,onClick:s})),[s]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiPopover,{button:g,isOpen:t,closePopover:()=>n,repositionOnScroll:!0},o.a.createElement(c.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiButtonEmpty,{iconType:"plusInCircle",color:"text","data-test-subj":"timeline-bottom-bar-create-new-timeline",onClick:m},ft)),o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiButtonEmpty,{iconType:"plusInCircle",color:"text","data-test-subj":"timeline-bottom-bar-create-new-timeline-template",onClick:f},gt)),o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiButtonEmpty,{iconType:"folderOpen",color:"text","data-test-subj":"timeline-bottom-bar-open-timeline",onClick:u},bt))))),a?o.a.createElement(Et.a,{onClose:l,hideActions:xt}):null)}));jt.displayName="AddTimelineButton";var St=n(913),Ot=n(912),kt=n(767);const wt=o.a.memo((({show:e,timelineId:t,openToggleRef:n})=>{const a=Object(m.useDispatch)(),i=Object(r.useCallback)((()=>a(ee.a.showTimeline({id:t,show:!0}))),[a,t]),s=Object(m.useSelector)((e=>Object(Ge.selectTitleByTimelineById)(e,t)));return o.a.createElement(c.EuiPanel,{borderRadius:"none","data-test-subj":"timeline-bottom-bar"},o.a.createElement(c.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(jt,{timelineId:t})),o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(Ot.a,{timelineId:t})),o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiLink,{"aria-label":yt(s),onClick:i,"data-test-subj":"timeline-bottom-bar-title-button",ref:n},s)),!e&&o.a.createElement(c.EuiFlexItem,{grow:!1,"data-test-subj":"timeline-event-count-badge"},o.a.createElement(kt.b,null)),o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(St.a,{timelineId:t}))))}));wt.displayName="TimelineBottomBar";var Tt=n(1346),It=n(149),Mt=n(10);const Ct=o.a.memo((({timelineId:e,onAppLeave:t})=>{const n=Object(r.useMemo)((()=>Object(Ge.getTimelineShowStatusByIdSelector)()),[]),{show:a}=Object(He.a)((t=>n(t,e))),i=Object(m.useDispatch)(),s=Object(r.useRef)(null),l=Object(r.useCallback)((()=>{i(ee.a.showTimeline({id:e,show:!1}))}),[i,e]),u=Object(r.useCallback)((e=>{e.key===c.keys.ESCAPE&&l()}),[l]);return((e,t)=>{const n=Object(m.useDispatch)(),{overlays:a,application:i,http:o}=Object(j.j)().services,s=Object(Tt.a)(),l=Object(f.useHistory)(),c=Object(r.useMemo)((()=>Object(Ge.getTimelineShowStatusByIdSelector)()),[]),{status:u,updated:d,changed:p}=Object(He.a)((t=>c(t,e))),g=Object(r.useCallback)((()=>{n(ee.a.showTimeline({id:e,show:!0})),n(ee.a.setActiveTabTimeline({id:e,activeTab:It.g.query})),n(ee.a.toggleModalSaveTimeline({id:e,showModalSaveTimeline:!0}))}),[n,e]);Object(r.useEffect)((()=>{const e=l.block((t=>{const n=t.pathname.replace(G.l,"");if(!s(n)&&(p||u===vt.l.draft&&null!=d))return async function(){await(null==a?void 0:a.openConfirm(Mt.i,{title:Mt.j,"data-test-subj":"appLeaveConfirmModal"}))?(e(),i.navigateToUrl(o.basePath.get()+t.pathname+t.hash+t.search,{state:t.state})):g()}(),!1}));return()=>{e()}}),[l,o.basePath,i,a,g,s,u,d,p]),Object(r.useEffect)((()=>(t(((e,t)=>!(null!=t?t:"").includes(G.j)&&(p||u===vt.l.draft&&null!=d)?e.confirm(Mt.i,Mt.j,g):e.default())),()=>{t((e=>e.default()))})))})(e,t),o.a.createElement(o.a.Fragment,null,o.a.createElement(c.EuiFocusTrap,{disabled:!a},o.a.createElement(pt,{timelineId:e,visible:a,openToggleRef:s})),o.a.createElement(wt,{show:a,timelineId:e,openToggleRef:s}),o.a.createElement(c.EuiWindowEvent,{event:"keydown",handler:u}))}));Ct.displayName="TimelineWrapper";var _t=n(58),Dt=n(158);const At=o.a.memo((()=>{(()=>{const{search:e,pathname:t}=Object(f.useLocation)(),[n,a]=Object(r.useState)(!1),{spaces:i}=Object(j.j)().services,o=Object(r.useMemo)((()=>ee.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:s,savedObjectId:l,show:c,activeTab:u,graphEventId:d}=Object(He.a)((e=>{var t;return null!==(t=o(e,te.c.active))&&void 0!==t?t:Dt.b})),p=Object(r.useCallback)((()=>{var r,o,p;const m=new URLSearchParams(e),f=null!==(r=m.get(K.a.timeline))&&void 0!==r?r:void 0,g={id:null!=l?l:"",isOpen:!!c,activeTab:u,graphEventId:d},b=null!==(o=Object(_t.safeDecode)(null!=f?f:""))&&void 0!==o?o:g;if(n||!i||"aliasMatch"!==(null==s?void 0:s.outcome)||null==(null==s?void 0:s.alias_target_id))return null;const y={...b,id:null!==(p=s.alias_target_id)&&void 0!==p?p:""},h=Object(_t.encode)(y);m.set(K.a.timeline,h);const v=`${t}?${m.toString()}`;i.ui.redirectLegacyUrl({path:v,aliasPurpose:s.alias_purpose,objectNoun:K.a.timeline}),a(!0)}),[u,d,n,t,s,l,e,c,i]);Object(r.useEffect)((()=>{p()}),[p])})();const{onAppLeave:e}=Object(Je.c)().services;return o.a.createElement(Ct,{timelineId:te.c.active,onAppLeave:e||oe.noop})}));At.displayName="Timeline";const Ft=l()(d.a).withConfig({displayName:"StyledKibanaPageTemplate",componentId:"sc-hfq6ac-0"})([".kbnSolutionNav__sidebar:not(.kbnSolutionNav__sidebar--shrink){background-color:",";}."," &{transform:none;}}"],(({theme:e})=>e.colors.emptyShade),u.c),Nt=o.a.memo((({children:e,...t})=>{var n;const[a,s]=Object(r.useState)(!1),l=Object(r.useCallback)((()=>{s(!0)}),[]),u=Ue(l),[p]=Object(Re.a)(),m=Object(r.useMemo)((()=>Object(Ge.getTimelineShowStatusByIdSelector)()),[]),{show:f}=Object(He.a)((e=>m(e,te.c.active))),[g]=Object(T.a)(),b=(null==g?void 0:g.pageName)===X.a.rulesCreate,{euiTheme:y,colorMode:h}=Object(c.useEuiTheme)(),v=!t.isEmptyState;return o.a.createElement(Ft,i()({theme:y,$isShowingTimelineOverlay:f,paddingSize:"none",solutionNav:u,restrictWidth:!1},t),v&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ke,null),o.a.createElement(d.a.Section,{className:"securityPageWrapper","data-test-subj":"pageContainer",paddingSize:null!==(n=t.paddingSize)&&void 0!==n?n:"l",alignment:"top",component:"div",grow:!0},o.a.createElement(w,null,o.a.createElement(x,{urlKey:b?void 0:K.a.flyout},e,o.a.createElement(J.b,null))),a&&o.a.createElement(Y,null)),p&&o.a.createElement(d.a.BottomBar,{"data-test-subj":"timeline-bottom-bar-container"},o.a.createElement(c.EuiThemeProvider,{colorMode:h},o.a.createElement(x,{urlKey:K.a.timelineFlyout},o.a.createElement(At,null),o.a.createElement(J.d,null))))))}));Nt.displayName="SecuritySolutionTemplateWrapper"}])]);