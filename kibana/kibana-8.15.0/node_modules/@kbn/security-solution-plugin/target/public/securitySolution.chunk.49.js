/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[49],{1364:function(e,t,a){"use strict";a.d(t,"b",(function(){return z})),a.d(t,"a",(function(){return V}));var n=a(2),r=a.n(n),o=a(19),i=a(41),s=a.n(i),l=a(45),c=a(1799),d=a(1490),u=a(131),m=a(118),p=a(4);const b=p.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),g=p.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"});var f=a(146),v=a(1216),E=a(122),y=a(129),h=a(132),S=a(158),j=a(124),x=a(738),O=a(145),C=a(127),k=a(622),w=a(5),M=a(522),T=a(559),D=a(206),I=a(978),P=a(140);const F=s()(o.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-1bu2jj8-0"})(["margin:4px 0 4px 0;"]),L=({fullScreen:e,globalFullScreen:t,onCloseOverlay:a,isActiveTimelines:n,timelineFullScreen:i,toggleFullScreen:s,graphEventId:l,activeTab:c})=>r.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{iconType:"cross",onClick:a,size:"xs","data-test-subj":"close-overlay"},n?c===f.d.graph?b:g:l?b:g)),!1===n&&r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiToolTip,{content:e?T.a:M.d},r.a.createElement(F,{"aria-label":Object(k.b)({globalFullScreen:t,isActiveTimelines:n,timelineFullScreen:i})?T.a:M.d,display:e?"fill":"empty",color:"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:s}))));L.displayName="NavigationComponent";const N=r.a.memo(L),z=({scopeId:e})=>{const t=Object(l.useDispatch)(),a=Object(n.useMemo)((()=>Object(u.isTimelineScope)(e)?y.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?c.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:o,setGlobalFullScreen:i}=Object(D.a)(),{timelineFullScreen:s,setTimelineFullScreen:m}=Object(D.c)(),p=Object(u.isTimelineScope)(e)?S.b:d.d,{graphEventId:b,sessionViewConfig:g,activeTab:v,prevActiveTab:E}=Object(j.a)((t=>{var n;return{activeTab:S.b.activeTab,prevActiveTab:S.b.prevActiveTab,...null!==(n=a&&a(t,e))&&void 0!==n?n:p}})),h=Object(u.getScopedActions)(e),x=Object(n.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?Object(u.isActiveTimeline)(e)?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(w.Gc,"euiDataGrid__restrictBody"):Object(u.isActiveTimeline)(e)?m(!1):i(!1),!1===Object(u.isActiveTimeline)(e)?h&&(t(h.updateGraphEventId({id:e,graphEventId:""})),t(h.updateSessionViewConfig({id:e,sessionViewConfig:null}))):v===f.d.graph?(h&&t(h.updateGraphEventId({id:e,graphEventId:""})),E!==f.d.session||g||t(y.a.setActiveTabTimeline({id:e,activeTab:f.d.query}))):v===f.d.session&&(Object(u.isTimelineScope)(e)&&(E!==f.d.graph||b?t(y.a.setActiveTabTimeline({id:e,activeTab:E})):t(y.a.setActiveTabTimeline({id:e,activeTab:f.d.query}))),h&&t(h.updateSessionViewConfig({id:e,sessionViewConfig:null})))}),[m,i,h,t,e,v,E,g,b]),O=Object(n.useMemo)((()=>Object(k.b)({globalFullScreen:o,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:s})),[o,e,s]),C=Object(n.useCallback)((()=>{Object(u.isActiveTimeline)(e)?m(!s):i(!o)}),[e,m,s,i,o]),M=Object(n.useMemo)((()=>r.a.createElement(N,{fullScreen:O,globalFullScreen:o,activeTab:v,onCloseOverlay:x,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:s,toggleFullScreen:C,graphEventId:b})),[O,o,v,x,e,s,C,b]);return{onCloseOverlay:x,Navigation:M}},V=({scopeId:e,entityType:t,height:a})=>{const{sessionView:o}=Object(m.j)().services,i=Object(n.useMemo)((()=>Object(u.isTimelineScope)(e)?y.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?c.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:s}=Object(D.a)(),{timelineFullScreen:p}=Object(D.c)(),{canReadPolicyManagement:b}=Object(P.a)().endpointPrivileges,g=Object(u.isTimelineScope)(e)?S.b:d.d,{sessionViewConfig:w,activeTab:M}=Object(j.a)((t=>{var a;return{activeTab:S.b.activeTab,prevActiveTab:S.b.prevActiveTab,...null!==(a=i&&i(t,e))&&void 0!==a?a:g}})),T=Object(n.useMemo)((()=>Object(k.b)({globalFullScreen:s,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:p})),[s,e,p]),F=Object(n.useMemo)((()=>Object(u.isActiveTimeline)(e)?C.SourcererScopeName.timeline:I.a.includes(e)?C.SourcererScopeName.detections:C.SourcererScopeName.default),[e]),{openEventDetailsPanel:L,shouldShowDetailsPanel:N,DetailsPanel:z}=(({entityType:e,isFlyoutView:t,sourcererScope:a,scopeId:o,tabType:i=f.d.query})=>{const{telemetry:s}=Object(m.j)().services,{browserFields:d,selectedPatterns:p,runtimeMappings:b}=Object(h.a)(a),g=Object(l.useDispatch)(),{openFlyout:C}=Object(v.a)(),k=Object(E.a)("expandableFlyoutDisabled"),w=Object(n.useMemo)((()=>Object(u.isTimelineScope)(o)?y.b.getTimelineByIdSelector():Object(u.isInTableScope)(o)?c.b.getTableByIdSelector():void 0),[o]),M=Object(n.useMemo)((()=>p.join(",")),[p]),T=Object(j.a)((e=>{var t,a;return null===(t=null!==(a=w&&w(e,o))&&void 0!==a?a:S.b)||void 0===t?void 0:t.expandedDetail})),D=Object(n.useRef)((()=>{})),I=()=>{},P=Object(n.useMemo)((()=>{var e;return!!(i&&T&&T[i]&&null!==(e=T[i])&&void 0!==e&&e.panelView)}),[T,i]),F=Object(u.getScopedActions)(o),L=Object(n.useCallback)((e=>{e&&F&&g(F.toggleDetailPanel({...e,tabType:i,id:o}))}),[F,o,g,i]),N=Object(n.useCallback)(((e,t)=>{k?e&&(L({panelView:"eventDetail",params:{eventId:e,indexName:M}}),D.current=null!=t?t:I):(C({right:{id:O.e,params:{id:e,indexName:M,scopeId:o}}}),s.reportDetailsFlyoutOpened({location:o,panel:"right"}))}),[k,C,M,o,s,L]),z=Object(n.useCallback)((()=>{k&&(D.current&&D.current(),F&&g(F.toggleDetailPanel({tabType:i,id:o})))}),[k,F,g,i,o]),V=Object(n.useMemo)((()=>P?r.a.createElement(x.a,{browserFields:d,entityType:e,handleOnPanelClosed:z,isFlyoutView:t,runtimeMappings:b,tabType:i,scopeId:o}):null),[d,e,z,t,b,P,i,o]);return{openEventDetailsPanel:N,shouldShowDetailsPanel:P,DetailsPanel:V}})({isFlyoutView:!Object(u.isActiveTimeline)(e),entityType:t,sourcererScope:F,scopeId:e,tabType:Object(u.isActiveTimeline)(e)?M:f.d.query}),V=Object(n.useMemo)((()=>{const e=a?a-118:void 0;return null!==w?o.getSessionView({...w,loadAlertDetails:L,isFullScreen:T,height:e,canReadPolicyManagement:b}):null}),[a,w,o,L,T,b]);return{openEventDetailsPanel:L,shouldShowDetailsPanel:N,SessionView:V,DetailsPanel:z}}},1475:function(e,t,a){"use strict";a.d(t,"a",(function(){return D}));var n=a(2),r=a.n(n),o=a(19),i=a(49),s=a(45),l=a(41),c=a.n(l),d=a(1799),u=a(1490),m=a(131),p=a(124),b=a(138),g=a(206),f=a(622),v=a(200),E=a(669),y=a(277),h=a(129),S=a(158);const j="sessionViewFullScreen",x=Object(l.css)(["display:flex;flex-direction:column;flex:1;width:100%;"]),O=c.a.div.withConfig({displayName:"OverlayContainer",componentId:"sc-jhq5kd-0"})(["",""],x),C=Object(l.css)(["background-color:"," position:fixed;top:0;bottom:2em;left:0;right:0;z-index:",";"],(({theme:e})=>`${e.eui.euiColorEmptyShade};`),i.euiThemeVars.euiZLevel3),k=c.a.div.withConfig({displayName:"FullScreenOverlayContainer",componentId:"sc-jhq5kd-1"})(["",""],C),w=c()(E.a).withConfig({displayName:"StyledResolver",componentId:"sc-jhq5kd-2"})(["height:100%;"]),M=c()(o.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-jhq5kd-3"})([""," overflow:hidden;width:100%;&.","{","}"],(({theme:e})=>`background-color: ${e.eui.euiColorEmptyShade};`),j,(({theme:e})=>`padding: 0 ${e.eui.euiSizeM}`)),T=({SessionView:e,Navigation:t,scopeId:a})=>{const i=Object(s.useDispatch)(),{globalFullScreen:l}=Object(g.a)(),{timelineFullScreen:c}=Object(g.c)(),E=Object(n.useMemo)((()=>Object(m.isInTableScope)(a)?d.b.getTableByIdSelector():Object(m.isTimelineScope)(a)?h.b.getTimelineByIdSelector():void 0),[a]),T=Object(m.isInTableScope)(a)?u.d:S.b,{graphEventId:D,sessionViewConfig:I}=Object(p.a)((e=>{var t;return null!==(t=E&&E(e,a))&&void 0!==t?t:T})),P=Object(n.useMemo)((()=>Object(f.b)({globalFullScreen:l,isActiveTimelines:Object(m.isActiveTimeline)(a),timelineFullScreen:c})),[l,a,c]);Object(n.useEffect)((()=>()=>{const e=Object(m.getScopedActions)(a);e&&i(e.updateGraphEventId({id:a,graphEventId:""})),Object(m.isActiveTimeline)(a)?i(v.c.setFullScreen({id:b.a.timeline,fullScreen:!1})):i(v.c.setFullScreen({id:b.a.global,fullScreen:!1}))}),[i,a]);const{from:F,to:L,shouldUpdate:N,selectedPatterns:z}=Object(y.a)(Object(m.isActiveTimeline)(a)),V=Object(n.useMemo)((()=>({from:F,to:L})),[F,L]),B=Object(n.useRef)(null);Object(n.useLayoutEffect)((()=>{P&&B.current?B.current.setAttribute("style",C.join("")):B.current&&B.current.setAttribute("style",x.join(""))}),[P]);const A=Object(n.useMemo)((()=>void 0!==D?r.a.createElement(w,{databaseDocumentID:D,resolverComponentInstanceID:a,indices:z,shouldUpdate:N,filters:V}):r.a.createElement(o.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},r.a.createElement(o.EuiLoadingSpinner,{size:"xl"}))),[D,a,z,N,V]);return Object(m.isActiveTimeline)(a)||null===I?P&&!Object(m.isActiveTimeline)(a)?r.a.createElement(k,{"data-test-subj":"overlayContainer"},r.a.createElement(o.EuiHorizontalRule,{margin:"none"}),r.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},r.a.createElement(o.EuiFlexItem,{grow:!1},t)),r.a.createElement(o.EuiHorizontalRule,{margin:"none"}),A):r.a.createElement(O,{"data-test-subj":"overlayContainer"},r.a.createElement(o.EuiHorizontalRule,{margin:"none"}),r.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},r.a.createElement(o.EuiFlexItem,{grow:!1},t)),r.a.createElement(o.EuiHorizontalRule,{margin:"none"}),A):r.a.createElement(O,{"data-test-subj":"overlayContainer",ref:B},r.a.createElement(o.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",direction:"column"},r.a.createElement(o.EuiHorizontalRule,{margin:"none"}),r.a.createElement(o.EuiFlexItem,{grow:!1},t),r.a.createElement(o.EuiHorizontalRule,{margin:"none"}),r.a.createElement(o.EuiSpacer,{size:"m"}),r.a.createElement(M,{grow:2,className:P?j:""},e)))},D=r.a.memo(T)},2092:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return u}));var n=a(2),r=a.n(n),o=a(129),i=a(124),s=a(1475),l=a(1364),c=a(1242);const d=({timelineId:e})=>{const t=Object(n.useMemo)((()=>o.b.getTimelineByIdSelector()),[]),a=Object(i.b)((a=>{var n;return null===(n=t(a,e))||void 0===n?void 0:n.graphEventId})),{Navigation:d}=Object(l.b)({scopeId:e}),{shouldShowDetailsPanel:u,DetailsPanel:m,SessionView:p}=Object(l.a)({scopeId:e});return a?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{scopeId:e,Navigation:d,SessionView:p}),u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(c.h,null),r.a.createElement(c.c,{grow:1},m))):null};d.displayName="GraphTabContentComponent";const u=r.a.memo(d)},459:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(2),r=a(4),o=a(45),i=a(166),s=a(132),l=a(127),c=a(294),d=a(123),u=a(118),m=a(864);const p=()=>{const{indicesExist:e,dataViewId:t}=Object(s.a)(l.SourcererScopeName.detections),{indexFieldsSearch:a}=Object(c.b)(),p=Object(o.useDispatch)(),{addError:b}=Object(d.a)(),g=Object(n.useRef)(new AbortController),{data:{dataViews:f}}=Object(u.j)().services,v=Object(o.useSelector)(i.d.signalIndexName),E=Object(o.useSelector)(i.d.defaultDataView),y=Object(n.useMemo)((()=>!E.title.includes(`${v}`)),[E.title,v]),h=Object(n.useMemo)((()=>!e&&!y),[e,y]),S=Object(n.useCallback)((()=>{null!==v&&(g.current.abort(),(async()=>{g.current=new AbortController;try{const e=await Object(m.a)({body:{patternList:E.title.split(",")},signal:g.current.signal,dataViewId:t,dataViewService:f});null!==v&&null!=e&&e.defaultDataView.patternList.includes(v)&&(a({dataViewId:e.defaultDataView.id}),p(i.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||b(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[b,t,f,E.title,p,a,v]);return{...h?{pollForSignalIndex:S}:{},signalIndexNeedsInit:y}}},500:function(e,t,a){"use strict";a.d(t,"a",(function(){return Ve}));var n=a(19),r=a(2),o=a.n(r),i=a(45),s=a(4);const l=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),d=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),u=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),m=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),p=s.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),b=s.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),g=s.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),f=s.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),v=s.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),E=s.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),y=s.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),h=s.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),S=s.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),j=s.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),x=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),O=s.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),C=s.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),k=s.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),w=s.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),M=s.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),T=s.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),D=s.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),I=s.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),P=s.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),F=s.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),L=s.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),N=s.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),z=s.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),V=s.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),B=s.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),A=s.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),R=s.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),$=s.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var U=a(166),Z=a(127),G=a(531),q=a(41),_=a.n(q),H=a(49);const W=_()(n.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1bcjjxf-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),Y=_()(n.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1bcjjxf-1"})(["max-width:none;"]),K=_()(n.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1bcjjxf-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),X=_()(n.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1bcjjxf-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),Q=_.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1bcjjxf-4"})(["width:600px;"]),J=_()(n.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1bcjjxf-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],H.euiThemeVars.euiSizeXS),ee=_.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1bcjjxf-6"})(["",""],(({theme:e})=>Object(q.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),te=(e,t)=>e.filter((e=>e!==t));var ae=a(308),ne=a(118),re=a(511);const oe=(e,t)=>Object(ae.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var ie=a(42);const se=_()(n.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-yfgyo3-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),le=o.a.memo((({isShowing:e,onDismissModal:t,onContinue:a,onUpdate:r,missingPatterns:i})=>e?o.a.createElement(se,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},o.a.createElement(n.EuiModalHeader,null,o.a.createElement(n.EuiModalHeaderTitle,null,v)),o.a.createElement(n.EuiModalBody,null,o.a.createElement(n.EuiText,{size:"s"},o.a.createElement(n.EuiTextColor,{color:"subdued"},o.a.createElement("p",null,o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:o.a.createElement(ee,null,i.join(", "))}}),f))),o.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(X,{"aria-label":E,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:a,title:E},E)),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:r,size:"s"},y))))):null));le.displayName="UpdateDefaultDataViewModal";var ce=a(149),de=a(121),ue=a(129),me=a(124),pe=a(158);const be=({activePatterns:e,deadPatterns:t,selectedPatterns:a,timelineType:i})=>{const s=Object(r.useMemo)((()=>t.length>0?o.a.createElement(n.EuiToolTip,{content:o.a.createElement(ge,{activePatterns:e,selectedPatterns:a,timelineType:i})},o.a.createElement(n.EuiIcon,{type:"questionInCircle",title:N})):null),[e,t.length,a,i]);return i===de.m.template?o.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:s,callout:o.a.createElement(ee,null,e.join(", "))}})):o.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:s,callout:o.a.createElement(ee,null,e.join(", "))}}))},ge=({activePatterns:e,selectedPatterns:t,timelineType:a})=>{const n=Object(r.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return a===de.m.template?o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}}):o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:n}})},fe=({timelineType:e,selectedPatterns:t})=>{const a=Object(r.useMemo)((()=>o.a.createElement(ee,null,t.join(", "))),[t]);return e===de.m.template?o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:a}}):o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:a}})},ve=({onReset:e,timelineType:t})=>t===de.m.template?o.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},b)}})):o.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},b)}})),Ee=({onReset:e,timelineType:t})=>t===de.m.template?o.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},b)}})):o.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e},b)}})),ye={deprecated:{title:{[de.m.default]:c,[de.m.template]:d},update:P},missingPatterns:{title:{[de.m.default]:u,[de.m.template]:m},update:y}},he=o.a.memo((({activePatterns:e,indicesExist:t,isModified:a,onDismiss:i,onReset:s,onUpdate:l,selectedPatterns:c,missingPatterns:d})=>{const u=Object(r.useMemo)((()=>o.a.createElement(n.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:l,size:"s",disabled:!t},ye[a].update)),[t,a,l]),m=Object(r.useMemo)((()=>t?u:o.a.createElement(n.EuiToolTip,{position:"top",content:z,"data-test-subj":"sourcerer-tooltip"},u)),[t,u]),p=e&&e.length>0?c.filter((t=>!e.includes(t))):[],b=Object(r.useMemo)((()=>ue.b.getTimelineByIdSelector()),[]),g=Object(me.a)((e=>{var t;return(null!==(t=b(e,ce.f.active))&&void 0!==t?t:pe.b).timelineType}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:ye[a].title[g]}),o.a.createElement(n.EuiSpacer,{size:"s"}),o.a.createElement(n.EuiText,{size:"s"},o.a.createElement(n.EuiTextColor,{color:"subdued"},o.a.createElement("p",null,e&&e.length>0?o.a.createElement(be,{timelineType:g,activePatterns:e,deadPatterns:p,selectedPatterns:c}):o.a.createElement(fe,{timelineType:g,selectedPatterns:c}),"deprecated"===a&&o.a.createElement(ve,{timelineType:g,onReset:s}),"missingPatterns"===a&&o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:o.a.createElement(ee,null,d.join(", "))}})),o.a.createElement(Ee,{timelineType:g,onReset:s}))))),o.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(X,{"aria-label":L,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:i,title:L},L)),o.a.createElement(n.EuiFlexItem,{grow:!1},m)))}));he.displayName="TemporarySourcererComp";const Se=o.a.memo((({activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onContinueWithoutUpdate:r,onDismiss:i,onReset:s,onUpdateStepOne:l,onUpdateStepTwo:c,selectedPatterns:d,isShowingUpdateModal:u,onDismissModal:m})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(he,{activePatterns:e,indicesExist:t,isModified:a,missingPatterns:n,onDismiss:i,onReset:s,onUpdate:l,selectedPatterns:d}),o.a.createElement(le,{isShowing:u,missingPatterns:n,onDismissModal:m,onContinue:r,onUpdate:c}))));Se.displayName="TemporarySourcerer";var je=a(132),xe=a(393),Oe=a(5);const Ce=_()(n.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-12c6aaf-0"})(["float:right;"]),ke=o.a.memo((()=>{const e=Object(r.useCallback)((()=>{document.location.reload()}),[]);return o.a.createElement(Ce,{onClick:e,"data-test-subj":"page-refresh"},R)}));ke.displayName="RefreshButton";var we=a(123);const Me=({activePatterns:e,disabled:t,isModified:a,isOnlyDetectionAlerts:i,isPopoverOpen:s,isTimelineSourcerer:l,loading:c,onClick:d,selectedPatterns:u,signalIndexName:m})=>{const p=Object(r.useMemo)((()=>{switch(a){case"modified":return o.a.createElement(J,{"data-test-subj":"sourcerer-modified-badge"},h);case"alerts":return o.a.createElement(J,{"data-test-subj":"sourcerer-alerts-badge"},S);case"deprecated":return o.a.createElement(J,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},j);case"missingPatterns":return o.a.createElement(J,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},j);default:return null}}),[a]),b=Object(r.useMemo)((()=>l?n.EuiButton:K),[l]),f=Object(r.useMemo)((()=>o.a.createElement(b,{"aria-label":g,"data-test-subj":l?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:d,title:g},g,!t&&p)),[t,p,l,c,d,b]),v=Object(r.useMemo)((()=>t?I:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:a,signalIndexName:n})=>t||e&&!n?null:(e?[n]:a).join(", "))({isOnlyDetectionAlerts:i,isPopoverOpen:s,selectedPatterns:null!=e?e:u,signalIndexName:m})),[e,t,i,s,u,m]);return v?o.a.createElement(n.EuiToolTip,{position:"top",content:v,"data-test-subj":"sourcerer-tooltip"},f):f},Te=Object(r.memo)(Me),De=o.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?o.a.createElement(n.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));De.displayName="SourcererCallout";const Ie=o.a.memo((({onChange:e,checked:t,isShow:a})=>a?o.a.createElement(Y,null,o.a.createElement(n.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:B,onChange:e})):null));Ie.displayName="AlertsCheckbox";const Pe=o.a.memo((({disableSave:e,isShow:t,onReset:a,onSave:r})=>t?o.a.createElement(Y,null,o.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(X,{"aria-label":F,"data-test-subj":"sourcerer-reset",flush:"left",onClick:a,title:F},F)),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiButton,{onClick:r,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},k)))):null));Pe.displayName="SaveButtons";var Fe=a(459),Le=a(189),Ne=a(198);const ze=o.a.memo((({showSourcerer:e,activePatterns:t,isTriggerDisabled:a,isModified:r,isOnlyDetectionAlerts:i,isPopoverOpen:s,loading:l,setPopoverIsOpenCb:c,selectedPatterns:d,signalIndexName:u,handleClosePopOver:m,isTimelineSourcerer:p,selectedDataViewId:b,sourcererMissingPatterns:g,onUpdateDetectionAlertsChecked:f,setMissingPatterns:v,setDataViewId:E,scopeId:y,children:h})=>e?y===Z.SourcererScopeName.analyzer?o.a.createElement(o.a.Fragment,null,h):o.a.createElement(n.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:o.a.createElement(Te,{activePatterns:t,disabled:a,isModified:r,isOnlyDetectionAlerts:i,isPopoverOpen:s,isTimelineSourcerer:p,loading:l,onClick:c,selectedPatterns:d,signalIndexName:u}),closePopover:m,"data-test-subj":p?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:s,ownFocus:!0,repositionOnScroll:!0},o.a.createElement(o.a.Fragment,null,h)):null));ze.displayName="SourcererPopover";const Ve=o.a.memo((({scope:e})=>{const t=Object(i.useDispatch)(),a=e===Z.SourcererScopeName.detections,s=e===Z.SourcererScopeName.timeline,c=e===Z.SourcererScopeName.default,d=Object(Le.d)(Ne.a.sourcerer),u=Object(i.useSelector)(U.d.signalIndexName),m=Object(i.useSelector)(U.d.defaultDataView),g=Object(i.useSelector)(U.d.kibanaDataViews),f=Object(i.useSelector)((t=>U.d.sourcererScopeSelectedDataViewId(t,e))),v=Object(i.useSelector)((t=>U.d.sourcererScopeSelectedPatterns(t,e))),E=Object(i.useSelector)((t=>U.d.sourcererScopeMissingPatterns(t,e))),{pollForSignalIndex:y}=Object(Fe.a)();Object(r.useEffect)((()=>{null!=y&&(s||a)&&y()}),[a,s,y]);const{activePatterns:j,indicesExist:k,loading:I}=Object(je.a)(e),[P,F]=Object(r.useState)(j&&j.length>0?E.filter((e=>j.includes(e))):[]);Object(r.useEffect)((()=>{j&&j.length>0&&F(E.filter((e=>j.includes(e))))}),[j,E]);const[L,N]=Object(r.useState)(s&&v.join()===u),z=Object(r.useCallback)((()=>{N(s&&v.join()===u)}),[s,v,u]);Object(r.useEffect)((()=>{z()}),[v]);const B=a||s&&L,[R,q]=Object(r.useState)(!1),[_,H]=Object(r.useState)(f),{allOptions:X,dataViewSelectOptions:ee,loadingIndexPatterns:se,isModified:le,handleOutsideClick:ce,onChangeCombo:de,renderOption:ue,selectedOptions:me,setIndexPatternsByDataView:pe}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:a,kibanaDataViews:s,missingPatterns:l,scopeId:c,selectedDataViewId:d,selectedPatterns:u,signalIndexName:m})=>{const p=Object(i.useDispatch)(),{data:{dataViews:b}}=Object(ne.j)().services,g=Object(r.useRef)(!0),[f,v]=Object(r.useState)(!1),E=Object(r.useMemo)((()=>m?oe([m]):[]),[m]),y=Object(r.useMemo)((()=>oe(u)),[u]),[j,C]=Object(r.useState)(a?E:y),[k,w]=Object(r.useState)(null==e?"deprecated":l.length>0?"missingPatterns":""),{allPatterns:M,selectablePatterns:T}=Object(r.useMemo)((()=>{if(a&&m)return{allPatterns:[m],selectablePatterns:[m]};const t=s.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const n=[...new Set(t.title.split(","))];return c===U.b.SourcererScopeName.default?{allPatterns:te(n,m),selectablePatterns:te(t.patternList,m)}:{allPatterns:n,selectablePatterns:t.patternList}}),[e,a,s,c,m]),D=Object(r.useMemo)((()=>oe(M,T)),[M,T]),I=Object(r.useCallback)(((e,a=!1)=>c===Z.SourcererScopeName.detections||a?E:oe(Object(G.b)(s.find((t=>t.id===e)),c,m,e===t))),[E,s,c,m,t]),P=Object(r.useMemo)((()=>null!=e?I(e):[]),[e,I]),F=Object(r.useCallback)(((e,t)=>{if(null==t)return w("deprecated");if(l.length>0)return w("missingPatterns");if(a)return w("alerts");const n=P.length!==e.length||!P.every((t=>e.find((e=>t.value===e))));return w(n?"modified":"")}),[P,a,l.length]);Object(r.useEffect)((()=>{C(c===Z.SourcererScopeName.detections?E:y)}),[u,c,y,E]),Object(r.useEffect)((()=>{F(u.map((e=>e)),d)}),[a,d,l,c,u]);const L=Object(r.useCallback)((e=>{C(e)}),[]),N=Object(r.useCallback)((({value:e})=>o.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),z=Object(r.useCallback)((async(e,t)=>{if(s.some((t=>t.id===e&&0===t.indexFields.length))){try{v(!0),C([]);const t=await Object(re.a)(e,b);g.current&&(p(U.a.setDataView(t)),C(a?E:oe(t.patternList)))}catch(e){}v(!1)}else C(I(e,t))}),[E,p,I,a,s,b]),V=Object(r.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:a,isOnlyDetectionAlerts:r,kibanaDataViews:i})=>r?[{inputDisplay:o.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},o.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",O,o.a.createElement(J,{"data-test-subj":"security-alerts-option-badge"},S)),value:t}]:i.map((({title:r,id:i})=>({inputDisplay:i===t?o.a.createElement("span",{"data-test-subj":"security-option-super"},o.a.createElement(n.EuiIcon,{type:"logoSecurity",size:"s"})," ",x,a&&i===e&&o.a.createElement(J,{"data-test-subj":"security-modified-option-badge"},h)):o.a.createElement("span",{"data-test-subj":"dataView-option-super"},o.a.createElement(n.EuiIcon,{type:"logoKibana",size:"s"})," ",r,a&&i===e&&o.a.createElement(J,{"data-test-subj":"security-modified-option-badge"},h)),value:i}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===k,isOnlyDetectionAlerts:a,kibanaDataViews:s}):[]),[e,t,k,a,s]);return Object(r.useEffect)((()=>(g.current=!0,()=>{g.current=!1})),[]),{allOptions:D,dataViewSelectOptions:V,loadingIndexPatterns:f,handleOutsideClick:Object(r.useCallback)((()=>{C(y)}),[y]),isModified:k,onChangeCombo:L,renderOption:N,selectedOptions:j,setIndexPatternsByDataView:z}})({dataViewId:_,defaultDataViewId:m.id,isOnlyDetectionAlerts:B,kibanaDataViews:g,missingPatterns:P,scopeId:e,selectedDataViewId:f,selectedPatterns:v,signalIndexName:u}),be=Object(r.useCallback)((e=>{N(e.target.checked),H(m.id),pe(m.id,e.target.checked)}),[m.id,pe]),[ge,fe]=Object(r.useState)(!1),[ve,Ee]=Object(r.useState)(!1),ye=Object(r.useCallback)((()=>{q((e=>!e)),fe(!1)}),[]),he=Object(r.useCallback)(((a,n,r)=>{t(U.a.setSelectedDataView({id:e,selectedDataViewId:a,selectedPatterns:n,shouldValidateSelectedPatterns:r})),c&&d({[Z.SourcererScopeName.default]:{id:a,selectedPatterns:n}})}),[t,e,c,d]),Ce=Object(r.useCallback)((e=>{H(e),pe(e)}),[pe]),Me=Object(r.useCallback)((()=>{H(m.id),pe(m.id),N(!1),F([])}),[m.id,pe]),Te=Object(r.useCallback)((()=>{const e=me.map((e=>e.label));null!=_&&he(_,e),q(!1)}),[he,_,me]),Ve=Object(r.useCallback)((()=>{ce(),H(f),F(E),z(),q(!1),fe(!1)}),[ce,z,f,E]),Be=Object(r.useCallback)((()=>{Ee(!1);const e=v.filter((e=>m.patternList.includes(e)));he(m.id,e),q(!1)}),[m.id,m.patternList,he,v]),Ae=Object(r.useCallback)((()=>{0===P.length?Be():Ee(!0)}),[P,Be]),[Re,$e]=Object(r.useState)(!1),Ue=(e=>{const{uiSettings:t,...a}=Object(ne.j)().services,{addSuccess:i,addError:s}=Object(we.a)();return Object(r.useCallback)((async r=>{const[l,c]=await(async()=>{try{const e=[...t.get(Oe.O),...r];return[await t.set(Oe.O,Object(ae.a)(e)),null]}catch(e){return[!1,e]}})();return l?(i({color:"success",title:Object(xe.a)(A,a),text:Object(xe.a)(o.a.createElement(ke,null),a),iconType:void 0,toastLifeTimeMs:6e5}),!0):(s(null!==c?c:new Error($),{title:$,toastMessage:o.a.createElement(o.a.Fragment,null,o.a.createElement(ie.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:o.a.createElement(n.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},b)}}))}),!1)}),[s,i,e,t,a])})(Object(r.useCallback)((()=>{q(!0),Me()}),[Me])),Ze=Object(r.useCallback)((async()=>{const e=await Ue(P);Ee(!1),q(!1),e&&(he(m.id,null!=j?j:v,!1),$e(!0))}),[j,m.id,P,he,v,Ue]);Object(r.useEffect)((()=>{H(f)}),[f]);const Ge=Object(r.useCallback)((()=>{fe((e=>!e))}),[]),qe=Object(r.useMemo)((()=>k||[Z.SourcererScopeName.analyzer,Z.SourcererScopeName.timeline].includes(e)),[k,e]);return o.a.createElement(ze,{showSourcerer:qe,activePatterns:j,isTriggerDisabled:Re,isModified:le,isOnlyDetectionAlerts:B,isPopoverOpen:R,isTimelineSourcerer:s,loading:I,handleOutsideClick:ce,setPopoverIsOpenCb:ye,selectedPatterns:v,signalIndexName:u,handleClosePopOver:Ve,selectedDataViewId:f,sourcererMissingPatterns:E,onUpdateDetectionAlertsChecked:z,setMissingPatterns:F,setDataViewId:H,scopeId:e},o.a.createElement(Q,null,o.a.createElement(n.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},o.a.createElement(o.a.Fragment,null,C)),o.a.createElement(De,{isOnlyDetectionAlerts:B,title:s?p:l}),o.a.createElement(n.EuiSpacer,{size:"s"}),null===_&&"deprecated"===le||"missingPatterns"===le?o.a.createElement(Se,{activePatterns:j,indicesExist:k,isModified:le,isShowingUpdateModal:ve,missingPatterns:P,onContinueWithoutUpdate:Be,onDismiss:ye,onDismissModal:()=>Ee(!1),onReset:Me,onUpdateStepOne:"deprecated"===le?Ae:Ze,onUpdateStepTwo:Ze,selectedPatterns:v}):o.a.createElement(n.EuiForm,{component:"form"},o.a.createElement(o.a.Fragment,null,o.a.createElement(Ie,{isShow:s,checked:L,onChange:be}),_&&o.a.createElement(Y,{label:w},o.a.createElement(n.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:se,disabled:B,fullWidth:!0,onChange:Ce,options:ee,placeholder:w,valueOfSelected:_})),o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(K,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:ge?"arrowDown":"arrowRight",onClick:Ge},M),ge&&o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(W,{isDisabled:se,$expandAdvancedOptions:ge,helpText:B?void 0:D,label:T},o.a.createElement(n.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:B||se,onChange:de,options:X,placeholder:V,renderOption:ue,selectedOptions:me})),o.a.createElement(Pe,{disableSave:0===me.length,isShow:!a,onReset:Me,onSave:Te})),o.a.createElement(n.EuiSpacer,{size:"s"}))))}));Ve.displayName="Sourcerer"},621:function(e,t,a){"use strict";a.d(t,"a",(function(){return It}));var n=a(2),r=a.n(n),o=a(45),i=a(19),s=a(42),l=a(48),c=a(888),d=a(147),u=a(41),m=a.n(u),p=a(410);function b(e,t,a){return t+(e>1?a*(e-1):0)}var g=a(49);function f(){return Object(n.useMemo)((()=>({copyableFieldBackground:g.euiThemeVars.euiColorLightShade,descriptionText:g.euiThemeVars.euiTextColor,full:g.euiThemeVars.euiColorFullShade,graphControls:g.euiThemeVars.euiColorDarkestShade,graphControlsBackground:g.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:g.euiThemeVars.euiColorLightShade,processBackingFill:`${g.euiThemeVars.euiColorPrimary}${g.darkMode?"1F":"0F"}`,resolverBackground:g.euiThemeVars.euiColorEmptyShade,resolverEdge:g.darkMode?g.euiThemeVars.euiColorLightShade:g.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:g.euiThemeVars.euiColorLightestShade,resolverEdgeText:g.darkMode?g.euiThemeVars.euiColorFullShade:g.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${g.euiThemeVars.euiColorDanger}${g.darkMode?"1F":"0F"}`,pillStroke:g.euiThemeVars.euiColorLightShade,linkColor:g.euiThemeVars.euiLinkColor})),[])}const v=m.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${b(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),E=m.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),y=r.a.memo((({className:e,edgeLineMetadata:t,startPosition:a,endPosition:n,projectionMatrix:o})=>{const i=Object(p.c)(a,o),l=Object(p.c)(n,o),[c]=o,d=f(),u=null==t?void 0:t.elapsedTime,m=Object(p.d)(i,l),g=b(c,10,7.5),y={left:`${i[0]}px`,top:`${i[1]}px`,width:`${m}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(p.b)(i,l)}rad)`};let h=50;return c<1&&(h+=1/c*(10*(1-c))),r.a.createElement(v,{className:e,style:y,resolverEdgeColor:d.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},u&&r.a.createElement(E,{backgroundColor:d.resolverEdge,leftPct:h,scaledTypeSize:g,textColor:d.resolverEdgeText},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:u.duration,durationType:u.durationType}})))}));var h=a(4);const S={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},j=Object(n.createContext)(S);var x=a(509),O=a(122);const C=["fit-content(10em)","auto"],k=m()(i.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-160k3ht-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),w=m.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-160k3ht-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),M=m()(i.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-160k3ht-2"})(["text-transform:uppercase;"]),T=m()(i.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-160k3ht-3"})(["lineheight:'2.2em';"]),D=m()(i.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-160k3ht-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),I=m.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-160k3ht-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor));var P=a(500),F=a(127);const L=h.i18n.translate("xpack.securitySolution.resolver.graphControls.sourcererButtonTitle",{defaultMessage:"Data View Selection"}),N=Object(n.memo)((({id:e,closePopover:t,setActivePopover:a,isOpen:o})=>{const s=Object(n.useCallback)((()=>a("sourcererSelection")),[a]),l=f();return r.a.createElement(i.EuiPopover,{button:r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:sourcerer-button",size:"m",title:L,"aria-label":L,onClick:s,iconType:"indexSettings",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:o,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(P.a,{scope:F.SourcererScopeName.analyzer}))}));N.displayName="SourcererButton";var z=a(346),V=a(310);const B=[],A=h.i18n.translate("xpack.securitySolution.resolver.graphControls.datePickerButtonTitle",{defaultMessage:"Date Range Selection"}),R=h.i18n.translate("xpack.securitySolution.resolver.graphControls.datePicker",{defaultMessage:"date range selection"}),$=Object(n.memo)((({id:e,closePopover:t,setActivePopover:a,isOpen:s})=>{const l=Object(o.useDispatch)(),c=Object(n.useCallback)((()=>a("datePicker")),[a]),u=f(),m=Object(o.useSelector)((t=>d.e(t.analyzer[e]))),p=Object(n.useCallback)((({start:t,end:a,isInvalid:n})=>{if(!n){const n=t.includes("now")||a.includes("now"),r=Object(z.c)(t);let o=Object(z.c)(a,{roundUp:!0});n&&(o=t===a?Object(z.c)("now"):Object(z.c)(a)),l(Object(V.userOverrodeDateRange)({id:e,timeRange:{from:r,to:o}}))}}),[l,e]);return r.a.createElement(i.EuiPopover,{button:r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:date-picker-button",size:"m",title:A,"aria-label":A,onClick:c,iconType:"calendar",$backgroundColor:u.graphControlsBackground,$iconColor:u.graphControls,$borderColor:u.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(i.EuiPopoverTitle,{style:{textTransform:"uppercase"}},R),r.a.createElement(i.EuiSuperDatePicker,{onTimeChange:p,start:null==m?void 0:m.from,end:null==m?void 0:m.to,showUpdateButton:!1,recentlyUsedRanges:B,width:"auto"}))}));$.displayName="DateSelectionButton";const U=Object(n.memo)(m()(i.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),Z=m()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),G=m()(i.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),q=m.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),_=m.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),H=m.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),W=m.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],_,H),Y=m()(i.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),K=m()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function X({id:e}){return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function Q(e,t,a){const r=X({id:e}),o=f(),i=Object(n.useMemo)((()=>({runningProcessCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.runningProcessCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.loadingCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},errorCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.errorCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:o.triggerBackingFill,cubeSymbol:`#${r.runningTriggerCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.terminatedProcessCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:o.triggerBackingFill,cubeSymbol:`#${r.terminatedTriggerCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger}})),[r,o]);return"terminated"===t?a?i.terminatedTriggerCube:i[J.processTerminated]:"running"===t?a?i[J.processCausedAlert]:i[J.processRan]:"error"===t?i[J.processError]:i[J.processLoading]}const J={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},ee=Object(n.memo)((function({id:e,className:t,size:a="2.15em",state:n,isOrigin:o,"data-test-subj":i}){const{cubeSymbol:s,strokeColor:l}=Q(e,n,!1),{processCubeActiveBacking:c}=X({id:e});return r.a.createElement(te,{className:t,width:a,height:a,viewBox:"0 0 34 34","data-test-subj":i,isOrigin:o,style:{verticalAlign:"middle"}},r.a.createElement("desc",null,h.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process} other {Unknown Process State}}",values:{state:n}})),o&&r.a.createElement("use",{xlinkHref:`#${c}`,fill:"transparent",x:0,y:-1,stroke:l,strokeDashoffset:0,width:"100%",height:"100%"}),r.a.createElement("use",{role:"presentation",xlinkHref:s,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),te=m.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),ae=r.a.memo((function({children:e}){return r.a.createElement(r.a.Fragment,null,r.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,r.a.createElement("wbr",null)]}),[])]}return e})))})),ne=({id:e,closePopover:t,setActivePopover:a,isOpen:o})=>{const s=Object(n.useCallback)((()=>a("nodeLegend")),[a]),l=f(),c=h.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return r.a.createElement(i.EuiPopover,{button:r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:c,"aria-label":c,onClick:s,iconType:"node",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:o,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(i.EuiPopoverTitle,{style:{textTransform:"uppercase"}},h.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),r.a.createElement("div",{style:{maxWidth:"212px"}},r.a.createElement(U,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:C,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(ee,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),r.a.createElement(T,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(ae,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))},re=({id:e,closePopover:t,setActivePopover:a,isOpen:s})=>{var l,c,u;const m=f(),p=Object(o.useSelector)((t=>d.H(t.analyzer[e]))),b=Object(n.useCallback)((()=>a("schemaInfo")),[a]),g=h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),v=h.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return r.a.createElement(i.EuiPopover,{button:r.a.createElement(D,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:b,iconType:"iInCircle",$backgroundColor:m.graphControlsBackground,$iconColor:m.graphControls,$borderColor:m.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(i.EuiPopoverTitle,{style:{textTransform:"uppercase"}},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),r.a.createElement(i.EuiIconTip,{content:h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),r.a.createElement("div",{style:{maxWidth:"268px"}},r.a.createElement(U,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:C,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),r.a.createElement(i.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(l=null==p?void 0:p.dataSource)&&void 0!==l?l:v)),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),r.a.createElement(i.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(c=null==p?void 0:p.schema.id)&&void 0!==c?c:v)),r.a.createElement(M,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),r.a.createElement(i.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(ae,null,null!==(u=null==p?void 0:p.schema.parent)&&void 0!==u?u:v))))))},oe=r.a.memo((({id:e,className:t})=>{const a=Object(o.useDispatch)(),s=Object(o.useSelector)((t=>d.I(t.analyzer[e]))),{timestamp:l}=Object(n.useContext)(j),c=Object(O.a)("analyzerDatePickersAndSourcererDisabled"),[u,m]=Object(n.useState)(null),p=f(),b=Object(n.useCallback)((e=>{m(e===u?null:e)}),[m,u]),g=Object(n.useCallback)((()=>m(null)),[]),v=Object(n.useCallback)((t=>{const n=parseFloat(t.target.value);!1===isNaN(n)&&a(Object(x.userSetZoomLevel)({id:e,zoomLevel:n}))}),[a,e]),E=Object(n.useCallback)((()=>{a(Object(x.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[a,e]),y=Object(n.useCallback)((()=>{a(Object(x.userClickedZoomOut)({id:e}))}),[a,e]),S=Object(n.useCallback)((()=>{a(Object(x.userClickedZoomIn)({id:e}))}),[a,e]),[C,M,T,D]=Object(n.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{a(Object(x.userNudgedCamera)({id:e,direction:t,time:l()}))}))),[a,l,e]);return r.a.createElement(I,{className:t,$iconColor:p.graphControls,"data-test-subj":"resolver:graph-controls"},r.a.createElement(w,null,r.a.createElement(re,{id:e,closePopover:g,isOpen:"schemaInfo"===u,setActivePopover:b}),r.a.createElement(ne,{id:e,closePopover:g,isOpen:"nodeLegend"===u,setActivePopover:b}),c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{id:e,closePopover:g,isOpen:"sourcererSelection"===u,setActivePopover:b}),r.a.createElement($,{id:e,closePopover:g,isOpen:"datePicker"===u,setActivePopover:b}))),r.a.createElement(w,null,r.a.createElement(i.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("div",{className:"panning-controls-top"},r.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:C},r.a.createElement(i.EuiIcon,{type:"arrowUp"}))),r.a.createElement("div",{className:"panning-controls-middle"},r.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:D},r.a.createElement(i.EuiIcon,{type:"arrowLeft"})),r.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:E},r.a.createElement(i.EuiIcon,{type:"bullseye"})),r.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:M},r.a.createElement(i.EuiIcon,{type:"arrowRight"}))),r.a.createElement("div",{className:"panning-controls-bottom"},r.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:T},r.a.createElement(i.EuiIcon,{type:"arrowDown"})))),r.a.createElement(i.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("button",{title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:S},r.a.createElement(i.EuiIcon,{type:"plusInCircle"})),r.a.createElement(k,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:s,onChange:v}),r.a.createElement("button",{title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:y},r.a.createElement(i.EuiIcon,{type:"minusInCircle"})))))}));function ie(e,t){return function(e,t){const a=Object(l.useHistory)(),r=Object(n.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.push(e)))}),[a,t,e]);return{href:a.createHref(e),onClick:r}}({search:Object(o.useSelector)((a=>d.F(a.analyzer[e])(t)))})}oe.displayName="GraphControls";var se=a(228),le=a(217);const ce=r.a.memo((({id:e,className:t,nodeID:a,nodeStats:o})=>{const i=Object(n.useMemo)((()=>void 0===o?[]:Object.entries(o.byCategory).map((([e,t])=>({prefix:r.a.createElement(se.a,{count:t||0}),category:e})))),[o]);return void 0===i?null:r.a.createElement("ul",{className:`${t} options`,"aria-describedby":a},i.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>r.a.createElement(de,{id:e,pill:t,nodeID:a,key:t.category}))))})),de=({id:e,pill:t,nodeID:a})=>{const i=ie(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:a,eventCategory:t.category}}),{pillStroke:s,resolverBackground:l}=f(),c=Object(n.useMemo)((()=>({border:`1.5px solid ${s}`,backgroundColor:l})),[s,l]),d=Object(o.useDispatch)(),{timestamp:u}=Object(n.useContext)(j),m=Object(n.useCallback)((t=>{i.onClick(t),d(Object(le.userSelectedResolverNode)({id:e,nodeID:a,time:u()}))}),[u,i,d,a,e]);return r.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:c,key:t.category},r.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:m},t.prefix," ",t.category))},ue=m()(ce).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),me=m.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),pe=m()(i.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),be=m.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ge=m()(i.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var fe=a(309),ve=a(212),Ee=a(291);const ye=m.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),he=m.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),Se=m.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),je=m.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),xe=r.a.memo((({id:e,className:t,position:a,node:l,nodeID:c,projectionMatrix:u,timeAtRender:m})=>{const g=`resolver:${e}`,v=X({id:e}),{timestamp:E}=Object(n.useContext)(j),[y,S]=Object(p.c)(a,u),[x]=u,O=Object(o.useSelector)((t=>d.b(t.analyzer[e]))),C=Object(o.useSelector)((t=>d.J(t.analyzer[e]))),k=Object(o.useSelector)((t=>d.A(t.analyzer[e]))),w=Object(o.useSelector)((t=>d.z(t.analyzer[e])(c))),M=Object(n.useCallback)((e=>Object(i.htmlIdGenerator)(g)(`${e}:node`)),[g]),T=Object(o.useSelector)((t=>d.d(t.analyzer[e])(c))),D=Object(o.useSelector)((t=>d.c(t.analyzer[e])(m)(c))),I=x>.8,P=x>=.55,F=(I?3.5:P?1:21)*x+5,L=360*(I?-.147413:-.147413-.08*(x-.5))*x,N=120*(I?-.53684:.2*-x*(1-x)/x-.53684)*x,z=Object(n.useMemo)((()=>({left:`${y+L}px`,top:`${S+N}px`,width:360*x+"px",height:120*x+"px"})),[y,x,L,N,S]),B=b(x,18.75,12.5),A=r.a.createRef(),R=f(),$=Object(o.useSelector)((t=>d.x(t.analyzer[e])(c))),U="loading"===$,{backingFill:Z,cubeSymbol:G,descriptionText:q,isLabelFilled:_,labelButtonFill:H,strokeColor:W}=Q(e,$,!1),Y=Object(n.useMemo)((()=>Object(i.htmlIdGenerator)("resolver")(`${c}:label`)),[c]),K=c===O,J=c===C,ee=c===k,te=Object(o.useDispatch)(),ae=ie(e,{panelView:"nodeDetail",panelParameters:{nodeID:c}}),ne=Object(n.useCallback)((()=>{te(Object(le.userFocusedOnResolverNode)({id:e,nodeID:c,time:E()}))}),[te,c,E,e]),re=Object(n.useCallback)((t=>{var a;null!==(a=A.current)&&void 0!==a&&a.beginElement&&A.current.beginElement(),"error"===$?te(Object(V.userReloadedResolverNode)({id:e,nodeID:c})):(te(Object(le.userSelectedResolverNode)({id:e,nodeID:c,time:E()})),ae.onClick(t))}),[A,te,c,ae,$,E,e]),oe=Object(o.useSelector)((t=>d.K(t.analyzer[e])(l))),se=fe.c(l),ce=Object(o.useSelector)((t=>Ee.a(d.w(t.analyzer[e])(String(l.id))))),de=Object(n.useMemo)((()=>void 0!==ce?ve.l(ce):se),[ce,se]),me=Object(n.useMemo)((()=>null===D?void 0:M(D)),[D,M]),pe=Object(n.useMemo)((()=>M(c)),[M,c]);return r.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":c,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===T?void 0:T,"aria-flowto":me,"aria-labelledby":Y,"aria-haspopup":"true","aria-current":K?"true":void 0,"aria-selected":J?"true":void 0,style:z,id:pe,tabIndex:-1},r.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{ne(),re(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},r.a.createElement(je,{isNodeLoading:U},r.a.createElement("use",{xlinkHref:`#${v.processCubeActiveBacking}`,fill:Z,x:-15.35,y:-15.35,stroke:W,width:22.5,height:22.5,className:"backing"}),ee&&r.a.createElement("use",{xlinkHref:`#${v.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:W,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),r.a.createElement("use",{role:"presentation",xlinkHref:G,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},r.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:A})))),r.a.createElement(ye,{color:R.full,fontSize:B,topPct:F},r.a.createElement(he,{backgroundColor:R.resolverBackground,color:R.descriptionText,isDisplaying:P,"data-test-subj":"resolver:node:description"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event  {descriptionText}} other {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:q}})),r.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:re,onFocus:ne,tabIndex:-1,style:{backgroundColor:R.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},r.a.createElement(i.EuiButton,{iconSide:U?"right":"left",isLoading:U,color:H,fill:_,iconType:"error"===$?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*x,32)}px`,maxWidth:(I?400:210*x)+"px"},tabIndex:-1,title:de,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":c},r.a.createElement(Se,{isShowingIcon:"loading"===$||"error"===$,className:"eui-textTruncate","data-test-subj":"euiButton__text"},h.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:$,nodeName:de}})))),r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:R.resolverBackground,display:I?"flex":"none",margin:"2px 0 0 0",padding:0}},r.a.createElement(i.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==oe&&oe>0&&r.a.createElement(ue,{id:e,buttonFill:R.resolverBackground,nodeStats:w,nodeID:c})))))})),Oe=m()(xe).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var Ce=a(56);function ke({id:e}){const t=e;return Object(n.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const we=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),Me=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),Te=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),De=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),Ie=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),Pe=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Fe=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Le=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=ke({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#6D6D6D"}),r.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),r.a.createElement("linearGradient",{id:a.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),r.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),r.a.createElement("linearGradient",{id:a.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),r.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),r.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#DD0A73"}),r.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Ne=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=X({id:e}),n=ke({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("symbol",{id:a.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},r.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),r.a.createElement("symbol",{id:a.loadingCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,we),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),r.a.createElement("symbol",{id:a.errorCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Me),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.errorCube})`}),r.a.createElement("g",{opacity:"0.6"},r.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.errorCube})`}),r.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.runningProcessCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Te),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningProcessCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{id:a.runningTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,De),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningTriggerCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{viewBox:"0 0 88 100",id:a.terminatedProcessCube},r.a.createElement("title",null,Ie),r.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),r.a.createElement("g",{opacity:"0.7"},r.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.terminatedProcessCube})`}),r.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.terminatedTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Pe),t&&r.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("g",{opacity:"0.6"},!t&&r.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${n.terminatedTriggerCube})`}),r.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{viewBox:"0 -3 88 106",id:a.processCubeActiveBacking},r.a.createElement("title",null,Fe),r.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),ze=Object(n.memo)((({id:e})=>{const t=Object(Ce.useDarkMode)();return r.a.createElement(Ve,null,r.a.createElement("defs",null,r.a.createElement(Le,{id:e,isDarkMode:t}),r.a.createElement(Ne,{id:e,isDarkMode:t})))})),Ve=m()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Be=a(119),Ae=a.n(Be);const Re=Object(n.memo)((function({breadcrumbs:e}){const t=Object(n.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:a,resolverEdgeText:o}=f();return r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{background:a,text:o,breadcrumbs:t,truncate:!1}))})),$e=m.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function Ue({id:e}){const t=h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),a=h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),o=ie(e,{panelView:"nodes"}),s=Object(n.useMemo)((()=>[{text:a,...o}]),[o,a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re,{breadcrumbs:s}),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(i.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},r.a.createElement($e,null,r.a.createElement(i.EuiLoadingSpinner,{size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function Ze({event:e}){var t,a,n,o,i,l,c,d,u,m,p,b,g,f,v,E,y,h,S;return Object(ve.i)(e)?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(ve.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(m=e.network)||void 0===m?void 0:m.forwarded_ip),networkDirection:String(null===(p=e.network)||void 0===p?void 0:p.direction)}}):null!==(a=e.kibana)&&void 0!==a&&null!==(n=a.alert)&&void 0!==n&&null!==(o=n.rule)&&void 0!==o&&o.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(b=e.kibana)||void 0===b||null===(g=b.alert)||void 0===g||null===(f=g.rule)||void 0===f?void 0:f.name)}}):null!==(i=e.file)&&void 0!==i&&i.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(v=e.file)||void 0===v?void 0:v.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(E=e.registry)||void 0===E?void 0:E.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(y=e.registry)||void 0===y?void 0:y.key)}}):null!==(d=e.dns)&&void 0!==d&&null!==(u=d.question)&&void 0!==u&&u.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(h=e.dns)||void 0===h||null===(S=h.question)||void 0===S?void 0:S.name)}}):r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(ve.b)(e)}})}var Ge=a(73),qe=a.n(Ge);const _e=h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),He=new Intl.DateTimeFormat(h.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function We(e){const t=Object(Ce.useUiSetting)("dateFormat"),a=Object(Ce.useUiSetting)("dateFormat:tz"),n="Browser"===a?qe.a.tz.guess():a;if(!e)return;const r=new Date(e);return r&&Number.isFinite(r.getTime())?t?qe.a.tz(r,n).format(t):He.format(r):_e}var Ye=a(262);const Ke=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(o.useSelector)((a=>d.i(a.analyzer[e])(t))),l=Object(o.useSelector)((t=>d.r(t.analyzer[e]))),c=Object(o.useSelector)((t=>d.j(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(Ue,{id:e})):r.a.createElement(pe,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},c||!n?r.a.createElement(i.EuiCallOut,{title:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Je,{id:e,nodeName:n.name,eventCategory:a,nodeID:t}),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(Qe,{id:e,eventCategory:a,nodeID:t}))))})),Xe=Object(n.memo)((function({id:e,event:t,nodeID:a,eventCategory:n}){const o=Object(Ye.a)(t),l=ve.g(o),c=ve.e(o),d=ve.p(o),u=We(l)||h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),m=ie(e,{panelView:"eventDetail",panelParameters:{nodeID:a,eventCategory:n,eventID:c,eventTimestamp:String(l),winlogRecordID:String(d)}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,null,r.a.createElement(Y,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:ve.d(o).join(", "),eventType:ve.h(o).join(", ")},defaultMessage:"{category} {eventType}"})),r.a.createElement(K,{dateTime:u},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:u},defaultMessage:"@ {date}"}))),r.a.createElement(i.EuiSpacer,{size:"xs"}),r.a.createElement(i.EuiButtonEmpty,Ae()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},m),r.a.createElement(Ze,{event:o})))})),Qe=Object(n.memo)((function({id:e,eventCategory:t,nodeID:a}){const l=Object(o.useSelector)((t=>d.y(t.analyzer[e]))),c=Object(o.useDispatch)(),u=Object(n.useCallback)((()=>{c(Object(V.userRequestedAdditionalRelatedEvents)({id:e}))}),[c,e]),m=Object(o.useSelector)((t=>d.q(t.analyzer[e]))),p=Object(o.useSelector)((t=>d.t(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,l.map(((o,s)=>r.a.createElement(n.Fragment,{key:s},r.a.createElement(Xe,{id:e,nodeID:a,eventCategory:t,event:o}),s===l.length-1?null:r.a.createElement(i.EuiHorizontalRule,{margin:"m"})))),p&&r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{color:"primary",size:"s",fill:!0,onClick:u,isLoading:m,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Je=Object(n.memo)((function({id:e,nodeName:t,eventCategory:a,nodeID:n}){const i=Object(o.useSelector)((t=>d.M(t.analyzer[e])(n))),l=Object(o.useSelector)((t=>d.D(t.analyzer[e])(n,a))),c=ie(e,{panelView:"nodes"}),u=ie(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),m=ie(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}});return r.a.createElement(Re,{breadcrumbs:[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...c},{text:t,...u},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:i},defaultMessage:"{totalCount} Events"}),...m},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:l,category:a},defaultMessage:"{count} {category}"})}]})}));function et({id:e,nodeID:t}){const a=Object(o.useSelector)((a=>Ee.a(d.w(a.analyzer[e])(t)))),n=Object(o.useSelector)((a=>d.z(a.analyzer[e])(t)));return void 0===a||void 0===n?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(Ue,{id:e})):r.a.createElement(pe,{hasBorder:!0},r.a.createElement(at,{id:e,nodeName:ve.l(a),nodeID:t,totalEventCount:n.total}),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(tt,{id:e,nodeID:t,relatedStats:n}))}const tt=Object(n.memo)((function({id:e,nodeID:t,relatedStats:a}){const o=Object(n.useMemo)((()=>Object.entries(a.byCategory).map((([e,t])=>({eventType:e,count:t})))),[a.byCategory]),s=Object(n.useMemo)((()=>[{field:"count",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"25%",sortable:!0,render:e=>r.a.createElement(i.EuiToolTip,{position:"top",content:e},r.a.createElement(se.a,{count:e}))},{field:"eventType",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"75%",sortable:!0,render:a=>r.a.createElement(nt,{id:e,nodeID:t,eventType:a},a)}]),[t,e]);return r.a.createElement(i.EuiInMemoryTable,{items:o,columns:s,sorting:!0})})),at=Object(n.memo)((function({id:e,nodeID:t,nodeName:a,totalEventCount:n}){return r.a.createElement(Re,{breadcrumbs:[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...ie(e,{panelView:"nodes"})},{text:a,...ie(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...ie(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),nt=Object(n.memo)((({id:e,nodeID:t,eventType:a,children:n})=>{const o=ie(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:a}});return r.a.createElement(i.EuiButtonEmpty,Ae()({"data-test-subj":"resolver:panel:node-events:event-type-link"},o),n)}));var rt=a(173),ot=a(131),it=a(889);const st=Object(n.memo)((function({id:e,translatedErrorMessage:t}){const a=ie(e,{panelView:"nodes"}),o=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...a},{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re,{breadcrumbs:o}),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(i.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(i.EuiButtonEmpty,a,h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),lt=m()(ee).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),ct=h.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),dt=Object(n.memo)((function({id:e,nodeID:t}){const a=Object(o.useSelector)((a=>Ee.a(d.w(a.analyzer[e])(t))));return"loading"===Object(o.useSelector)((a=>d.x(a.analyzer[e])(t)))?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(Ue,{id:e})):a?r.a.createElement(pe,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},r.a.createElement(ut,{id:e,nodeID:t,processEvent:a})):r.a.createElement(pe,{hasBorder:!0},r.a.createElement(st,{id:e,translatedErrorMessage:ct}))})),ut=Object(n.memo)((function({id:e,processEvent:t,nodeID:a}){const l=ve.l(t),c=Object(o.useSelector)((t=>d.x(t.analyzer[e])(a))),u=Object(o.useSelector)((t=>d.E(t.analyzer[e])(a))),m=ve.g(t),p=We(m),b=Object(n.useMemo)((()=>{const e={title:"@timestamp",description:p,value:m},a={title:"process.executable",description:Object(it.d)(t)},n={title:"process.pid",description:Object(it.c)(t)},r={title:"user.name",description:ve.o(t)};return[e,a,n,{title:"process.entity_id",description:ve.c(t)},r,{title:"user.domain",description:ve.n(t)},{title:"process.parent.pid",description:ve.k(t)},{title:"process.hash.md5",description:ve.j(t)},{title:"process.args",description:ve.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:String(e.description)})))}),[p,m,t]),g=ie(e,{panelView:"nodes"}),f=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...g},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:l},defaultMessage:"Details for: {processName}"})}]),[l,g]),{descriptionText:v}=Q(e,c,!1),E=ie(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}}),y=Object(n.useMemo)((()=>Object(i.htmlIdGenerator)("resolverTable")()),[]),S=[{field:"title","data-test-subj":"resolver:node-detail:entry-title",name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0,render:e=>r.a.createElement(ae,null,e)},{name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeDetail.valueTitle",defaultMessage:"Value"}),"data-test-subj":"resolver:node-detail:entry-description",render(t){var a;return r.a.createElement(rt.c,{data:{field:t.title,value:null!==(a=t.value)&&void 0!==a?a:t.description},triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,visibleCellActions:5,sourcererScopeId:Object(ot.getSourcererScopeId)(e),metadata:{scopeId:e}},t.description)}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re,{breadcrumbs:f}),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(i.EuiTitle,{size:"xs"},r.a.createElement(Z,{"aria-describedby":y},r.a.createElement(lt,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:c}),r.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},r.a.createElement(ae,null,l)))),r.a.createElement(i.EuiText,null,r.a.createElement(i.EuiTextColor,{color:"subdued"},r.a.createElement("span",{id:y},v))),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiLink,Ae()({},E,{"data-test-subj":"resolver:node-detail:node-events-link"}),r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:u},defaultMessage:"{relatedEventTotal} Events"})),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(i.EuiInMemoryTable,{"data-test-subj":"resolver:node-detail",items:b,columns:S,sorting:!0}))})),mt=r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),pt=r.a.memo((function({numberOfEntries:e}){return r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),bt=r.a.memo((function({numberDisplayed:e}){return r.a.createElement(ge,{size:"s",title:r.a.createElement(pt,{numberOfEntries:e})},r.a.createElement("p",null,mt))})),gt=Object(n.memo)((({id:e})=>{const t=Object(n.useMemo)((()=>[{field:"name",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,a)=>r.a.createElement(ft,{id:e,name:t,nodeID:a.nodeID})},{field:"timestamp",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:t=>r.a.createElement(vt,{eventDate:t,id:e})}]),[e]),a=Object(o.useSelector)(Object(n.useCallback)((t=>{const{processNodePositions:a}=d.u(t.analyzer[e]),n=[];for(const e of a.keys()){const t=fe.c(e),a=fe.b(e);void 0!==a&&n.push({name:t,timestamp:fe.a(e),nodeID:a})}return n}),[e])),s=a.length,l=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),c=Object(o.useSelector)((t=>d.m(t.analyzer[e]))),u=Object(o.useSelector)((t=>d.l(t.analyzer[e]))),m=Object(o.useSelector)((t=>d.n(t.analyzer[e]))),p=!0===c||!0===u||!0===m,b=Object(n.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return r.a.createElement(pe,{hasBorder:!0},r.a.createElement(Re,{breadcrumbs:l}),p&&r.a.createElement(bt,{numberDisplayed:s}),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(i.EuiInMemoryTable,{rowProps:b,"data-test-subj":"resolver:node-list",items:a,columns:t,sorting:!0}))}));gt.displayName="NodeList";const ft=Object(n.memo)((({id:e,name:t,nodeID:a})=>{const s=Object(o.useSelector)((t=>d.A(t.analyzer[e])===a)),l=Object(o.useSelector)((t=>d.x(t.analyzer[e])(a))),{descriptionText:c}=f(),u=ie(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),m=Object(o.useDispatch)(),{timestamp:p}=Object(n.useContext)(j),b=Object(n.useCallback)((t=>{u.onClick(t),m(Object(le.userSelectedResolverNode)({id:e,nodeID:a,time:p()}))}),[p,u,m,a,e]);return r.a.createElement(i.EuiButtonEmpty,{onClick:b,href:u.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":a},void 0===t?r.a.createElement(i.EuiBadge,{color:"warning"},h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):r.a.createElement(q,null,r.a.createElement(ee,{id:e,state:l,isOrigin:s,"data-test-subj":"resolver:node-list:node-link:icon"}),r.a.createElement(W,null,s&&r.a.createElement(_,{color:c,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},h.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),r.a.createElement(H,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}));ft.displayName="NodeDetailLink";const vt=Object(n.memo)((({eventDate:e,id:t})=>{const a=We(e);return a?r.a.createElement(rt.c,{data:{field:"@timestamp",value:e},triggerId:rt.d.DEFAULT,visibleCellActions:5,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(ot.getSourcererScopeId)(t),metadata:{scopeId:t}},a):r.a.createElement("span",null,"")}));function Et(e){const t=[{path:[],value:e}],a=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:n,value:r}=e;Array.isArray(r)?t.push(...r.map((e=>({path:[...n],value:e})))):"object"==typeof r&&null!==r?t.push(...Object.keys(r).map((e=>({path:[...n,e],value:r[e]})))):null!=r&&a.push([n,r])}return a}vt.displayName="NodeDetailTimestamp";const yt=h.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),ht=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(o.useSelector)((t=>d.p(t.analyzer[e]))),i=Object(o.useSelector)((t=>d.s(t.analyzer[e]))),s=Object(o.useSelector)((a=>Ee.a(d.w(a.analyzer[e])(t)))),l=Object(o.useSelector)((a=>d.x(a.analyzer[e])(t))),c=n||i||"loading"===l,u=Object(o.useSelector)((t=>d.f(t.analyzer[e])));return c?r.a.createElement(pe,{hasBorder:!0},r.a.createElement(Ue,{id:e})):u?r.a.createElement(St,{id:e,nodeID:t,event:u,processEvent:s,eventType:a}):r.a.createElement(pe,{hasBorder:!0},r.a.createElement(st,{id:e,translatedErrorMessage:yt}))})),St=Object(n.memo)((function({id:e,nodeID:t,event:a,eventType:n,processEvent:o}){const l=We(ve.m(a))||h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),c=o?ve.l(o):null;return r.a.createElement(pe,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},r.a.createElement(xt,{id:e,nodeID:t,nodeName:c,event:a,breadcrumbEventCategory:n}),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(i.EuiText,{size:"s"},r.a.createElement(Y,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:n,eventType:String(ve.h(a))},defaultMessage:"{category} {eventType}"})),r.a.createElement(K,{dateTime:l},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:l},defaultMessage:"@ {date}"}))),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(Ot,null,r.a.createElement(ae,null,r.a.createElement(Ze,{event:a}))),r.a.createElement(i.EuiSpacer,{size:"l"}),r.a.createElement(jt,{event:a,id:e}))}));function jt({event:e,id:t}){const a=Object(n.useMemo)((()=>{const t=[],a=Object(Ye.a)(e);for(const[e,n]of Object.entries(a)){if("agent"===e||"ecs"===e||"@timestamp"===e||!n)continue;const a=Et(n).map((([t,a])=>({title:[e,...t].join("."),description:String(a)})));t.push(...a)}return t}),[e]),o=[{field:"title","data-test-subj":"resolver:panel:event-detail:event-field-title",name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.fieldTitle",defaultMessage:"Field"}),width:"fit-content(8em)",sortable:!0},{name:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.eventDetail.valueTitle",defaultMessage:"Value"}),render:e=>r.a.createElement(rt.c,{data:{field:e.title,value:e.description},visibleCellActions:5,triggerId:rt.d.DEFAULT,mode:rt.a.HOVER_DOWN,sourcererScopeId:Object(ot.getSourcererScopeId)(t),metadata:{scopeId:t}},e.description)}];return r.a.createElement(i.EuiInMemoryTable,{items:a,columns:o,search:{box:{incremental:!0,schema:!0}},pagination:!0,sorting:!0})}function xt({id:e,nodeID:t,nodeName:a,event:i,breadcrumbEventCategory:l}){const c=Object(o.useSelector)((a=>d.D(a.analyzer[e])(t,l))),u=Object(o.useSelector)((a=>d.E(a.analyzer[e])(t))),m=ie(e,{panelView:"nodes"}),p=ie(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),b=ie(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),g=ie(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:l}}),f=Object(n.useMemo)((()=>{const e=[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...m},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:u},defaultMessage:"{totalCount} Events"}),...b},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:c,category:l},defaultMessage:"{count} {category}"}),...g},{text:r.a.createElement(Ze,{event:i})}];return a&&e.splice(1,0,{text:a,...p}),e}),[l,c,i,p,b,a,u,m,g]);return r.a.createElement(Re,{breadcrumbs:f})}const Ot=Object(n.memo)(m()(i.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),Ct=Object(n.memo)((function({id:e}){const t=Object(o.useSelector)((t=>d.B(t.analyzer[e])));return"nodeDetail"===t.panelView?r.a.createElement(dt,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?r.a.createElement(et,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?r.a.createElement(Ke,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?r.a.createElement(ht,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):r.a.createElement(gt,{id:e})}));var kt=a(959);const wt=m()(i.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),Mt=m()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),Tt=()=>r.a.createElement(Mt,{"data-test-subj":"resolver:no-process-events",direction:"column"},r.a.createElement(i.EuiTitle,null,r.a.createElement("h4",null,h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(wt,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var Dt=a(123);const It=r.a.memo(r.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:a,indices:u,shouldUpdate:m,filters:p},b){!function(e){const t=Object(n.useRef)();t.current=Object(l.useLocation)().search;const a=Object(o.useDispatch)(),r=Object(l.useHistory)(),i=Object(c.a)(e);Object(n.useEffect)((()=>{const e=i;return()=>{const a=new URLSearchParams(t.current);a.delete(e);const n={search:a.toString()};r.replace(n)}}),[i,r,a,e])}(a),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:a,filters:r,shouldUpdate:i}){const s=Object(o.useDispatch)(),c=Object(l.useLocation)().search;Object(n.useLayoutEffect)((()=>{s(Object(le.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:c,indices:a,shouldUpdate:i,filters:r}))}),[s,e,t,c,a,i,r])}({databaseDocumentID:t,resolverComponentInstanceID:a,indices:u,shouldUpdate:m,filters:p}),function({id:e}){const{addSuccess:t}=Object(Dt.a)(),{from:a,to:r}=Object(o.useSelector)((t=>{const a=d.g(t.analyzer[e]);return{from:null!=a&&a.from?a.from:void 0,to:null!=a&&a.to?a.to:void 0}})),i=We(a),s=We(r),l=Object(n.useMemo)((()=>h.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:i,to:s}})),[i,s]);Object(n.useEffect)((()=>{(a||r)&&t(l)}),[t,l,a,r])}({id:a}),function({id:e}){const t=Object(o.useDispatch)(),a=e,r=Object(l.useLocation)().search,i=Object(n.useContext)(j),s=Object(o.useSelector)((t=>d.J(t.analyzer[e]))),c=Object(o.useSelector)((t=>d.i(t.analyzer[e]))),u=Object(kt.a)({locationSearch:r,resolverComponentInstanceID:a});let m;"nodes"!==u.panelView&&(m=u.panelParameters.nodeID),Object(n.useEffect)((()=>{m&&c(m)&&m!==s&&t(Object(le.userSelectedResolverNode)({id:e,nodeID:m,time:i.timestamp()}))}),[u.panelView,m,t,c,s,i,e])}({id:a});const{timestamp:g}=Object(n.useContext)(j),v=g(),{processNodePositions:E,connectingEdgeLineSegments:S}=Object(o.useSelector)((e=>d.Q(e.analyzer[a])(v))),{projectionMatrix:O,ref:C,onMouseDown:k}=function({id:e}){const t=Object(o.useDispatch)(),a=Object(n.useContext)(j),[r,i]=Object(n.useState)(null),s=Object(o.useSelector)(Object(n.useCallback)((t=>d.C(t.analyzer[e])),[e])),l=Object(n.useRef)(),[c,u]=Object(n.useState)(s(a.timestamp())),m=Object(o.useSelector)((t=>d.P(t.analyzer[e]))),p=Object(o.useSelector)((t=>d.o(t.analyzer[e]))),[b,g]=function(){const{getBoundingClientRect:e}=Object(n.useContext)(j),[t,a]=Object(n.useState)(null),{ResizeObserver:r,requestAnimationFrame:o}=Object(n.useContext)(j),[i,s]=Object(n.useState)(null),l=Object(n.useCallback)((e=>{s(e)}),[]);return Object(n.useEffect)((()=>{null!==i&&a(e(i))}),[i,e]),Object(n.useEffect)((()=>{let t=window.scrollX,n=window.scrollY;const r=()=>{o((()=>{const r=window.scrollX,o=window.scrollY;null===i||t===r&&n===o||a(e(i)),t=r,n=o}))};return window.addEventListener("scroll",r,{passive:!0}),()=>{window.removeEventListener("scroll",r)}}),[i,o,e]),Object(n.useEffect)((()=>{if(null!==i){const t=new r((t=>{null!==i&&i===t[0].target&&a(e(i))}));return t.observe(i),()=>{t.disconnect()}}}),[r,i,e]),[t,l]}(),f=Object(n.useCallback)((e=>null===b?null:[e.clientX-b.x,e.clientY-b.y]),[b]),v=Object(n.useCallback)((n=>{const r=f(n);null!==r&&t(Object(x.userStartedPanning)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),E=Object(n.useCallback)((n=>{const r=f(n);r&&t(Object(x.userMovedPointer)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),y=Object(n.useCallback)((()=>{m&&t(Object(x.userStoppedPanning)({id:e,time:a.timestamp()}))}),[t,a,m,e]),h=Object(n.useCallback)((n=>{null!==b&&n.ctrlKey&&0!==n.deltaY&&0===n.deltaMode&&(n.preventDefault(),t(Object(x.userZoomed)({id:e,zoomChange:n.deltaY/-b.height,time:a.timestamp()})))}),[b,t,a,e]),S=Object(n.useCallback)((e=>{i(e),g(e)}),[g]);return Object(n.useEffect)((()=>(window.addEventListener("mouseup",y,{passive:!0}),()=>{window.removeEventListener("mouseup",y)})),[y]),Object(n.useEffect)((()=>(window.addEventListener("mousemove",E,{passive:!0}),()=>{window.removeEventListener("mousemove",E)})),[E]),Object(n.useEffect)((()=>{if(null!==r)return r.addEventListener("wheel",h),()=>{r.removeEventListener("wheel",h)}}),[r,h]),Object(n.useLayoutEffect)((()=>{l.current=s}),[s]),Object(n.useLayoutEffect)((()=>{u(s(a.timestamp()))}),[s,a]),Object(n.useLayoutEffect)((()=>{const e=a.timestamp();if(p(e)){let e=null;const t=()=>{const n=a.timestamp();void 0!==l.current&&u(l.current(n)),e=p(n)?a.requestAnimationFrame(t):null};return e=a.requestAnimationFrame(t),()=>{null!==e&&a.cancelAnimationFrame(e)}}}),[p,a]),Object(n.useEffect)((()=>{null!==b&&t(Object(x.userSetRasterSize)({id:e,dimensions:[b.width,b.height]}))}),[t,b,e]),{ref:S,onMouseDown:v,projectionMatrix:c}}({id:a}),w=Object(n.useCallback)((e=>{C(e),"function"==typeof b?b(e):null!==b&&(b.current=e)}),[C,b]),M=Object(o.useSelector)((e=>d.s(e.analyzer[a]))),T=Object(o.useSelector)((e=>d.k(e.analyzer[a]))),D=Object(o.useSelector)((e=>d.b(e.analyzer[a]))),I=Object(o.useSelector)((e=>d.G(e.analyzer[a]))),P=f();return r.a.createElement(me,{className:e,backgroundColor:P.resolverBackground},M?r.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},r.a.createElement(i.EuiLoadingSpinner,{size:"xl"})):T?r.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},r.a.createElement("div",null," ",r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):I?r.a.createElement(r.a.Fragment,null,r.a.createElement(be,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:k,ref:w,role:"tree",tabIndex:0,"aria-activedescendant":D||void 0},S.map((({points:[e,t],metadata:a})=>r.a.createElement(y,{edgeLineMetadata:a,key:a.reactKey,startPosition:e,endPosition:t,projectionMatrix:O}))),[...E].map((([e,t])=>{const n=fe.b(e);if(void 0===n)throw new Error("Tried to render a node without an ID");return r.a.createElement(Oe,{id:a,key:n,nodeID:n,position:t,projectionMatrix:O,node:e,timeAtRender:v})}))),r.a.createElement(Ct,{id:a})):r.a.createElement(Tt,null),r.a.createElement(oe,{id:a}),r.a.createElement(ze,{id:a}))})))},669:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),o=a(45),i=a(621),s=a(217);const l=r.a.memo((e=>{const t=Object(o.useSelector)((t=>t.analyzer[e.resolverComponentInstanceID])),a=Object(o.useDispatch)();return t||a(Object(s.createResolver)({id:e.resolverComponentInstanceID})),Object(n.useEffect)((()=>{e.shouldUpdate&&a(Object(s.createResolver)({id:e.resolverComponentInstanceID}))}),[a,e.shouldUpdate,e.resolverComponentInstanceID]),r.a.createElement(i.a,e)}))}}]);