/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[23],{1287:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var a=s(47),n=s(2081),i=s(2080),o=s(241);const l={page:1,per_page:1e3},r=[n.b,l.page,l.per_page,i.a.public.v1],c=e=>{const{assistantAvailability:{isAssistantEnabled:t},http:s}=Object(o.b)();return Object(a.useQuery)(r,(async()=>s.fetch(n.b,{method:"GET",version:i.a.public.v1,query:l,signal:null==e?void 0:e.signal})),{initialData:{data:[],page:1,perPage:5,total:0},placeholderData:{data:[],page:1,perPage:5,total:0},keepPreviousData:!0,enabled:t})}},1288:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var a=s(47),n=s(86),i=s(69),o=s(577);const l=["elastic-assistant, load-action-types"],r=({http:e,toasts:t})=>Object(a.useQuery)(l,(async()=>(await Object(n.loadActionTypes)({http:e,featureId:i.GenerativeAIForSecurityConnectorFeatureId})).sort(((e,t)=>e.name.localeCompare(t.name)))),{retry:!1,keepPreviousData:!0,staleTime:6e4,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:o.i}))}})},1289:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return u})),s.d(t,"c",(function(){return d})),s.d(t,"d",(function(){return p}));var a=s(2),n=s(659),i=s(241),o=s(1544),l=s(1456),r=s(1543);const c={page:0,perPage:0,total:0,data:[]},u={},d={page:0,perPage:0,total:0,data:[]},p=(e,t,s,u,d=c)=>{var p,m,b,g;const{assistantTelemetry:j,knowledgeBase:v,assistantStreamingEnabled:f,setAssistantStreamingEnabled:x,setKnowledgeBase:y,http:O,toasts:S}=Object(i.b)(),[k,C]=Object(a.useState)(e),[h,A]=Object(a.useState)({}),[E,w]=Object(a.useState)(t.data.filter((e=>e.promptType===n.a.quick))),[T,M]=Object(a.useState)(t.data.filter((e=>e.promptType===n.a.system))),[P,z]=Object(a.useState)({}),[D,F]=Object(a.useState)({}),[B,I]=Object(a.useState)(d),[L,R]=Object(a.useState)(f),[N,_]=Object(a.useState)(v),q=Object(a.useCallback)((()=>{C(e),A({}),w(t.data.filter((e=>e.promptType===n.a.quick))),_(v),R(f),M(t.data.filter((e=>e.promptType===n.a.system))),F({}),I(d)}),[t,d,f,e,v]),U=h.create||h.update||h.delete,Q=P.create||P.update||P.delete,V=D.create||D.update||D.delete,G=Object(a.useCallback)((async()=>{var e,t,s;const a=V?await Object(r.a)(O,D,S):void 0;a&&a.attributes.results.created.forEach((e=>{h.create&&Object.values(h.create).forEach((t=>{var s;(null===(s=t.apiConfig)||void 0===s?void 0:s.defaultSystemPromptId)===e.name&&(t.apiConfig.defaultSystemPromptId=e.id)})),h.update&&Object.values(h.update).forEach((t=>{var s;(null===(s=t.apiConfig)||void 0===s?void 0:s.defaultSystemPromptId)===e.name&&(t.apiConfig.defaultSystemPromptId=e.id)}))}));const n=U?await Object(o.a)(O,h,S):void 0,i=f!==L,c=v.latestAlerts!==N.latestAlerts;(i||c)&&(null==j||j.reportAssistantSettingToggled({...c?{alertsCountUpdated:c}:{},...i?{assistantStreamingEnabled:L}:{}})),x(L),y(N);const u=Q?await Object(l.a)(O,P,S):void 0;return F({}),A({}),(null===(e=null==n?void 0:n.success)||void 0===e||e)&&(null===(t=null==u?void 0:u.success)||void 0===t||t)&&(null===(s=null==a?void 0:a.success)||void 0===s||s)}),[V,O,D,S,U,h,f,L,v.latestAlerts,N,x,y,Q,P,j]);return Object(a.useEffect)((()=>{var e,t,s,a;null!==(e=P.create)&&void 0!==e&&e.length||null!==(t=P.update)&&void 0!==t&&t.length||null!==(s=P.delete)&&void 0!==s&&null!==(a=s.ids)&&void 0!==a&&a.length||I(d)}),[d,null===(p=P.create)||void 0===p?void 0:p.length,null===(m=P.delete)||void 0===m||null===(b=m.ids)||void 0===b?void 0:b.length,null===(g=P.update)||void 0===g?void 0:g.length]),Object(a.useEffect)((()=>{s&&C(e)}),[e,s]),Object(a.useEffect)((()=>{u&&(w(t.data.filter((e=>e.promptType===n.a.quick))),M(t.data.filter((e=>e.promptType===n.a.system))))}),[t.data,u]),{conversationSettings:k,conversationsSettingsBulkActions:h,knowledgeBase:N,assistantStreamingEnabled:L,quickPromptSettings:E,resetSettings:q,systemPromptSettings:T,saveSettings:G,updatedAnonymizationData:B,setUpdatedAnonymizationData:I,anonymizationFieldsBulkActions:P,setAnonymizationFieldsBulkActions:z,setUpdatedKnowledgeBaseSettings:_,setUpdatedAssistantStreamingEnabled:R,setUpdatedQuickPromptSettings:w,setUpdatedSystemPromptSettings:M,setConversationSettings:C,setConversationsSettingsBulkActions:A,promptsBulkActions:D,setPromptsBulkActions:F}}},1290:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a="xs"},1291:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"k",(function(){return i})),s.d(t,"q",(function(){return o})),s.d(t,"l",(function(){return l})),s.d(t,"b",(function(){return r})),s.d(t,"n",(function(){return c})),s.d(t,"m",(function(){return u})),s.d(t,"h",(function(){return d})),s.d(t,"j",(function(){return p})),s.d(t,"o",(function(){return m})),s.d(t,"p",(function(){return b})),s.d(t,"f",(function(){return g})),s.d(t,"g",(function(){return j})),s.d(t,"i",(function(){return v})),s.d(t,"e",(function(){return f})),s.d(t,"c",(function(){return x})),s.d(t,"d",(function(){return y}));var a=s(4);const n=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsLabel",{defaultMessage:"Alerts"}),i=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.askQuestionsAboutLabel",{defaultMessage:"Ask questions about the"}),e=>a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.latestAndRiskiestOpenAlertsLabel",{defaultMessage:"Send AI Assistant information about your {alertsCount} newest and riskiest open or acknowledged alerts.",values:{alertsCount:e}})),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.yourAnonymizationSettingsLabel",{defaultMessage:"Your anonymization settings will apply to these alerts."}),l=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.selectFewerAlertsLabel",{defaultMessage:"Send fewer alerts if the model's context window is too small."}),r=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsRangeSliderLabel",{defaultMessage:"Alerts range"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsTitle",{defaultMessage:"Knowledge Base"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsBadgeTitle",{defaultMessage:"Experimental"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsDescription",{defaultMessage:"documentation"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseLabel",{defaultMessage:"Knowledge Base"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.setupKnowledgeBaseButton",{defaultMessage:"Setup"}),b=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.setupKnowledgeBaseButtonToolTip",{defaultMessage:"Knowledge Base unavailable, please see documentation for more details."}),g=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseTooltip",{defaultMessage:"ELSER must be configured to enable the Knowledge Base"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseDescription",{defaultMessage:"Index where Knowledge Base docs are stored"})),j=e=>a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseInstalledDescription",{defaultMessage:"Initialized to `{kbIndexPattern}`",values:{kbIndexPattern:e}}),v=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.initializeKnowledgeBaseButton",{defaultMessage:"Initialize"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.deleteKnowledgeBaseButton",{defaultMessage:"Delete"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserLabel",{defaultMessage:"ELSER Configured"})),f=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserMachineLearningDescription",{defaultMessage:"Machine Learning"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserSeeDocsDescription",{defaultMessage:"See docs"}),a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlLabel",{defaultMessage:"ES|QL Knowledge Base Documents"})),x=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlDescription",{defaultMessage:"Knowledge Base docs for generating ES|QL queries"}),y=a.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlInstalledDescription",{defaultMessage:"ES|QL Knowledge Base docs loaded"})},1326:function(e,t,s){"use strict";s.d(t,"a",(function(){return p}));var a=s(2),n=s.n(a),i=s(86),o=s(19),l=s(152),r=s(577),c=s(43);const u=Object(l.css)({name:"1vn7jfl",styles:"inline-size:240px;.euiKeyPadMenuItem__label{white-space:nowrap;overflow:hidden;}"}),d=n.a.memo((({actionTypes:e,actionTypeRegistry:t,onClose:s,onSelect:i,actionTypeSelectorInline:l})=>{const d=Object(a.useMemo)((()=>Object(c.jsx)(o.EuiFlexGroup,null,null==e?void 0:e.map((e=>{const s=t.get(e.id);return Object(c.jsx)(o.EuiFlexItem,{"data-test-subj":"action-option",key:e.id,grow:!1},Object(c.jsx)(o.EuiKeyPadMenuItem,{className:u,key:e.id,isDisabled:!e.enabled,label:e.name,"data-test-subj":`action-option-${e.name}`,onClick:()=>i(e)},Object(c.jsx)(o.EuiIcon,{size:"xl",type:s.iconClass})))})))),[t,e,i]);return null!=e&&e.length?l?Object(c.jsx)(n.a.Fragment,null,d):Object(c.jsx)(o.EuiModal,{onClose:s,"data-test-subj":"action-type-selector-modal"},Object(c.jsx)(o.EuiModalHeader,null,Object(c.jsx)(o.EuiModalHeaderTitle,null,r.h)),Object(c.jsx)(o.EuiModalBody,null,d)):null}));d.displayName="ActionTypeSelectorModal";const p=n.a.memo((({actionTypeRegistry:e,actionTypes:t,onClose:s,onSaveConnector:a,onSelectActionType:o,selectedActionType:l,actionTypeSelectorInline:r=!1})=>Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(d,{actionTypes:t,actionTypeRegistry:e,onClose:s,onSelect:o,actionTypeSelectorInline:r}),l&&Object(c.jsx)(i.ConnectorAddModal,{actionType:l,actionTypeRegistry:e,onClose:s,postSaveEventHandler:a}))));p.displayName="AddConnectorModal"},1344:function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return c}));var a=s(47),n=s(4),i=s(2),o=s(1383);const l=["elastic-assistant","knowledge-base-status"],r=({http:e,resource:t,toasts:s})=>Object(a.useQuery)(l,(async({signal:s})=>Object(o.a)({http:e,resource:t,signal:s})),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==s||s.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:n.i18n.translate("xpack.elasticAssistant.knowledgeBase.statusError",{defaultMessage:"Error fetching Knowledge Base Status"})}))}}),c=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},1345:function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return c}));var a=s(2),n=s(810),i=s.n(n),o=s(1215),l=s(821);const r={page:{size:l.d,index:0},sort:{field:"",direction:"asc"}},c=({defaultTableOptions:e,nameSpace:t=o.d,storageKey:s})=>{const[n=e,r]=i()(`${t}.${s}`,e),c=Object(a.useMemo)((()=>({initialPageSize:n.page.size,pageSizeOptions:[5,10,l.d,50],pageIndex:n.page.index})),[n]),u=Object(a.useMemo)((()=>({sort:n.sort})),[n.sort]);return{onTableChange:Object(a.useCallback)((({page:e,sort:t})=>{r({page:e,sort:t})}),[r]),pagination:c,sorting:u}}},1362:function(e,t,s){"use strict";s.d(t,"a",(function(){return y}));var a=s(19),n=s(2),i=s.n(n),o=s(7),l=s(4);const r=e=>l.i18n.translate("xpack.elasticAssistant.attackDiscovery.statusSuccess",{values:{totalAttacks:e},defaultMessage:"The connector has updated with {totalAttacks} potential {totalAttacks, plural, =1 {attack} other {attacks}}"}),c=l.i18n.translate("xpack.elasticAssistant.attackDiscovery.statusInProgress",{defaultMessage:"Attack discovery generation in progress."}),u=l.i18n.translate("xpack.elasticAssistant.attackDiscovery.statusFail",{defaultMessage:"The connector encountered an error while generating attack discoveries."});var d=s(43);const p=({hasViewed:e,status:t,count:s})=>"running"===t?Object(d.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"status-running"},Object(d.jsx)(a.EuiToolTip,{"aria-label":c,content:c,position:"bottom"},Object(d.jsx)(a.EuiLoadingSpinner,{size:"s"}))):e?null:"succeeded"===t&&null!=s?Object(d.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"status-succeeded"},Object(d.jsx)(a.EuiToolTip,{"aria-label":r(s),content:r(s),position:"bottom"},Object(d.jsx)(a.EuiNotificationBadge,null,s))):"failed"===t?Object(d.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"status-failed"},Object(d.jsx)(a.EuiIconTip,{"aria-label":u,color:"warning",content:u,position:"bottom",size:"m",type:"warning"})):null;var m=s(755),b=s(577),g=s(1288),j=s(241),v=s(578),f=s(1326);const x="ADD_NEW_CONNECTOR",y=i.a.memo((({isDisabled:e=!1,isOpen:t=!1,displayFancy:s,selectedConnectorId:l,onConnectorSelectionChange:r,setIsOpen:c,stats:u=null})=>{const{actionTypeRegistry:y,http:O,assistantAvailability:S}=Object(j.b)(),[k,C]=Object(n.useState)(!1),{data:h}=Object(g.a)({http:O}),[A,E]=Object(n.useState)(null),{data:w,refetch:T}=Object(m.a)({http:O}),M=e||!S.hasConnectorsReadPrivilege,P=Object(n.useMemo)((()=>({value:x,inputDisplay:b.f,dropdownDisplay:Object(d.jsx)(a.EuiFlexGroup,{gutterSize:"none",key:x},Object(d.jsx)(a.EuiFlexItem,{grow:!0},Object(d.jsx)(a.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",href:"#",iconType:"plus",size:"xs"},b.f)),Object(d.jsx)(a.EuiFlexItem,{grow:!1},Object(d.jsx)("div",{style:{width:"24px"}})))})),[]),z=Object(n.useMemo)((()=>(null!=w?w:[]).map((e=>{var t,n,o,l;const r=null!==(t=null===(n=Object(v.c)(e))||void 0===n?void 0:n.apiProvider)&&void 0!==t?t:Object(v.a)(y.get(e.actionTypeId)),c=e.isPreconfigured?b.m:r,m=null!==u&&null!==(o=u.statsPerConnector.find((t=>t.connectorId===e.id)))&&void 0!==o?o:null;return{value:e.id,"data-test-subj":e.id,inputDisplay:null!==(l=null==s?void 0:s(e.name))&&void 0!==l?l:e.name,dropdownDisplay:Object(d.jsx)(i.a.Fragment,{key:e.id},Object(d.jsx)(a.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none",alignItems:"center"},Object(d.jsx)(a.EuiFlexItem,{grow:!1},Object(d.jsx)("strong",null,e.name),c&&Object(d.jsx)(a.EuiText,{size:"xs",color:"subdued"},Object(d.jsx)("p",null,c))),m&&Object(d.jsx)(p,m)))}}))),[y,w,s,u]),D=Object(n.useMemo)((()=>Object(o.some)(w,["id",l])),[w,l]),F=Object(n.useMemo)((()=>S.hasConnectorsAllPrivilege?[...z,P]:[...z]),[P,S.hasConnectorsAllPrivilege,z]),B=Object(n.useCallback)((()=>{null==c||c(!1),C(!1),E(null)}),[c]),[I,L]=Object(n.useState)(t),R=Object(n.useCallback)((e=>{if(e===x)return L(!1),void C(!0);const t=(null!=w?w:[]).find((t=>t.id===e));t&&r(t)}),[w,r]),N=Object(n.useCallback)((e=>{r({...e}),null==T||T(),B()}),[B,r,T]);return Object(d.jsx)(i.a.Fragment,null,D||z.length?Object(d.jsx)(a.EuiSuperSelect,{"aria-label":b.g,compressed:!0,"data-test-subj":"connector-selector",disabled:M,hasDividers:!0,isOpen:I,onChange:R,options:F,valueOfSelected:l,popoverProps:{panelMinWidth:400,anchorPosition:"downRight"}}):Object(d.jsx)(a.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",iconType:"plusInCircle",size:"xs",onClick:()=>C(!0)},b.a),k&&Object(d.jsx)(n.Suspense,{fallback:!0},Object(d.jsx)(f.a,{actionTypeRegistry:y,actionTypes:h,onClose:()=>C(!1),onSaveConnector:N,onSelectActionType:e=>E(e),selectedActionType:A})))}));y.displayName="ConnectorSelector"},1380:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"c",(function(){return n})),s.d(t,"b",(function(){return i})),s.d(t,"d",(function(){return o}));const a=({anonymizationFields:e,field:t})=>{var s,a;return null!==(s=null===(a=e.find((e=>e.field===t)))||void 0===a?void 0:a.allowed)&&void 0!==s&&s},n=({anonymizationFields:e,field:t})=>{var s,a;return!(null!==(s=null===(a=e.find((e=>e.field===t)))||void 0===a?void 0:a.allowed)&&void 0!==s&&s)},i=({anonymizationFields:e,field:t})=>{var s,a;return null!==(s=null===(a=e.find((e=>e.field===t)))||void 0===a?void 0:a.anonymized)&&void 0!==s&&s},o=({messageContent:e,replacements:t})=>null!=t?Object.keys(t).reduce(((e,s)=>{const a=t[s];return e.replaceAll(s,a)}),e):e},1382:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"b",(function(){return o}));var a=s(4);const n=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.ariaLabel",{defaultMessage:"Select Prompt Context categories this Quick Prompt will be available for."}),i=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.prefixLabel",{defaultMessage:"Select Prompt"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.placeholderLabel",{defaultMessage:"(Quick Prompt will always be visible)."})},1383:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return o}));var a=s(2081),n=s(2080);const i=async({http:e,resource:t,signal:s})=>{try{const i=a.g.replace("{resource?}",t||"");return await e.fetch(i,{method:"GET",signal:s,version:n.a.internal.v1})}catch(e){return e}},o=async({http:e,resource:t,signal:s})=>{const i=a.g.replace("{resource?}",t||"");return await e.fetch(i,{method:"POST",signal:s,version:n.a.internal.v1})}},1384:function(e,t,s){"use strict";s.d(t,"g",(function(){return n})),s.d(t,"d",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return l})),s.d(t,"a",(function(){return r})),s.d(t,"f",(function(){return c})),s.d(t,"e",(function(){return u})),s.d(t,"i",(function(){return d})),s.d(t,"h",(function(){return p}));var a=s(4);const n=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsTitle",{defaultMessage:"Conversations"}),i=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsDescription",{defaultMessage:"Create and manage conversations with the Elastic AI Assistant."}),o=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsAllTitle",{defaultMessage:"All conversations"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsAllDescription",{defaultMessage:"These settings apply to all conversations."}),r=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.connectorTitle",{defaultMessage:"Connector"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptTitle",{defaultMessage:"System Prompt"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptHelpTextTitle",{defaultMessage:"Context provided as part of every conversation."}),d=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.streamingTitle",{defaultMessage:"STREAMING"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.streamingHelpTextTitle",{defaultMessage:"Controls whether streaming responses are used in conversations"})},1455:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var a=s(47),n=s(4),i=s(1383),o=s(1344);const l=["elastic-assistant","post-knowledge-base"],r=({http:e,toasts:t})=>{const s=Object(o.a)();return Object(a.useMutation)(l,(t=>Object(i.b)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:n.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}))},onSettled:()=>{s()}})}},1456:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s(4),n=s(2081),i=s(2080);const o=async(e,t,s)=>{try{const s=await e.fetch(n.a,{method:"POST",version:i.a.public.v1,body:JSON.stringify(t)});if(!s.success){var o;const e=null===(o=s.attributes.errors)||void 0===o?void 0:o.map((e=>`${e.status_code?`Error code: ${e.status_code}. `:""}Error message: ${e.message} for anonymization field ${e.anonymization_fields.map((e=>e.name)).join(",")}`)).join(",\n");throw new Error(e)}return s}catch(e){null==s||s.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:a.i18n.translate("xpack.elasticAssistant.anonymizationFields.bulkActionsAnonymizationFieldsError",{defaultMessage:"Error updating anonymization fields {error}",values:{error:e}})})}}},1457:function(e,t,s){"use strict";s.d(t,"h",(function(){return n})),s.d(t,"g",(function(){return i})),s.d(t,"d",(function(){return o})),s.d(t,"e",(function(){return l})),s.d(t,"f",(function(){return r})),s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return u})),s.d(t,"c",(function(){return d}));var a=s(4);const n=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsTitle",{defaultMessage:"Quick Prompts"}),i=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsDescription",{defaultMessage:"Create and manage Quick Prompts. Quick Prompts are shortcuts to common actions."}),o=(a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.modalTitle",{defaultMessage:"Quick Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.nameLabel",{defaultMessage:"Name"})),l=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptLabel",{defaultMessage:"Prompt"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptPlaceholder",{defaultMessage:"Enter a Quick Prompt"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.badgeColorLabel",{defaultMessage:"Badge color"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsLabel",{defaultMessage:"Contexts"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsHelpText",{defaultMessage:"Select where this Quick Prompt will appear. Selecting none will make this prompt appear everywhere."});a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"})},1458:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s(659),n=s(2),i=s(241);const o=({onSelectedQuickPromptChange:e,setUpdatedQuickPromptSettings:t,promptsBulkActions:s,setPromptsBulkActions:o})=>{const{currentAppId:l}=Object(i.b)();return{onQuickPromptDeleted:Object(n.useCallback)((e=>{var a,n;t((t=>t.filter((t=>t.id!==e)))),o({...s,delete:{ids:[...null!==(a=null===(n=s.delete)||void 0===n?void 0:n.ids)&&void 0!==a?a:[],e]}})}),[s,o,t]),onQuickPromptSelectionChange:Object(n.useCallback)((n=>{const i="string"==typeof n,r=i?{name:n,id:n,content:"",color:"#D36086",categories:[],promptType:a.a.quick,consumer:l}:n;var c;null!=r&&(t((e=>e.some((e=>e.name===r.name))?e:[...e,r])),i&&o({...s,create:[...null!==(c=s.create)&&void 0!==c?c:[],{...r}]})),e(r)}),[l,e,s,o,t])}}},1459:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a=(e,t)=>Object.values(e).filter((e=>{var s;return(null==e||null===(s=e.apiConfig)||void 0===s?void 0:s.defaultSystemPromptId)===t}))},1460:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var a=s(2),n=s(241);const i=({setUpdatedSystemPromptSettings:e,onSelectedSystemPromptChange:t,promptsBulkActions:s,setPromptsBulkActions:i})=>{const{currentAppId:o}=Object(n.b)();return{onSystemPromptSelectionChange:Object(a.useCallback)((a=>{const n="string"==typeof a,l=n?{id:null!=a?a:"",content:"",name:null!=a?a:"",promptType:"system",consumer:o}:a;null!=l&&(e((e=>e.some((e=>e.id===l.id))?e:[...e,l])),n&&i((e=>{var t;return{...e,create:[...null!==(t=s.create)&&void 0!==t?t:[],{...l}]}}))),t(l)}),[o,t,s,i,e]),onSystemPromptDeleted:Object(a.useCallback)((t=>{var a,n;e((e=>e.filter((e=>e.id!==t)))),i({...s,delete:{ids:[...null!==(a=null===(n=s.delete)||void 0===n?void 0:n.ids)&&void 0!==a?a:[],t]}})}),[s,i,e])}}},1461:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"a",(function(){return i}));var a=s(4);a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph1",{defaultMessage:"The fields below are allowed by default"}),a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph2",{defaultMessage:"Optionally enable anonymization for these fields"}),a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutTitle",{defaultMessage:"Anonymization defaults"});const n=a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsTitle",{defaultMessage:"Anonymization"}),i=a.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsDescription",{defaultMessage:"Define privacy settings for event data sent to third-party LLM providers. You can choose which fields to include, and which to anonymize by replacing their values with random strings. Helpful defaults are provided below."})},1462:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(1380);const n=({anonymizationFields:e=[],rawData:t,replacements:s})=>{const n={allowed:0,anonymized:0,denied:0,total:0};return t?"string"==typeof t?null==s?n:{...n,anonymized:Object.keys(s).length}:Object.keys(t).reduce(((t,s)=>({allowed:t.allowed+(Object(a.a)({anonymizationFields:e,field:s})?1:0),anonymized:t.anonymized+(Object(a.a)({anonymizationFields:e,field:s})&&Object(a.b)({anonymizationFields:e,field:s})?1:0),denied:t.denied+(Object(a.c)({anonymizationFields:e,field:s})?1:0),total:t.total+1})),n):{allowed:e.reduce(((e,t)=>t.allowed?e+1:e),0),anonymized:e.reduce(((e,t)=>t.anonymized?e+1:e),0),denied:e.reduce(((e,t)=>!1===t.allowed?e+1:e),0),total:e.length}}},1485:function(e,t,s){"use strict";s.d(t,"a",(function(){return q}));var a=s(721),n=s.n(a),i=s(19),o=s(2),l=s.n(o),r=s(41),c=s.n(r),u=s(4);const d=u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allActionsTooltip",{defaultMessage:"All actions"}),p=u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowAction",{defaultMessage:"Allow"}),m=(u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowByDefaultAction",{defaultMessage:"Allow by default"}),u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowedColumnTitle",{defaultMessage:"Allowed"})),b=(u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.alwaysSubmenu",{defaultMessage:"Always"}),u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeAction",{defaultMessage:"Anonymize"})),g=(u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeByDefaultAction",{defaultMessage:"Anonymize by default"}),u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizedColumnTitle",{defaultMessage:"Anonymized"})),j=u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.bulkActions",{defaultMessage:"Bulk actions"}),v=(u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.defaultsSubmenu",{defaultMessage:"Defaults"}),u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyAction",{defaultMessage:"Deny"})),f=(u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyByDefaultAction",{defaultMessage:"Deny by default"}),u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.fieldColumnTitle",{defaultMessage:"Field"})),x=u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.noButtonLabel",{defaultMessage:"No"}),y=(u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.resetButton",{defaultMessage:"Reset"}),u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeAction",{defaultMessage:"Unanonymize"})),O=(u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeByDefaultAction",{defaultMessage:"Unanonymize by default"}),u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.valuesColumnTitle",{defaultMessage:"Values"})),S=u.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.yesButtonLabel",{defaultMessage:"Yes"}),k="primary-panel-id";var C=s(43);const h=({appliesTo:e,disabled:t,disableAllow:s=!1,disableAnonymize:a=!1,disableDeny:n=!1,disableUnanonymize:l=!1,onListUpdated:r,selected:c})=>{const[u,m]=Object(o.useState)(!1),g=Object(i.useGeneratedHtmlId)({prefix:"contextEditorBulkActions"}),f=Object(o.useCallback)((()=>m(!1)),[]),x=Object(o.useCallback)((()=>m((e=>!e))),[]),O=Object(o.useMemo)((()=>Object(C.jsx)(i.EuiToolTip,{content:"multipleRows"===e?void 0:d},Object(C.jsx)(i.EuiButtonEmpty,{"data-test-subj":"bulkActionsButton",disabled:t,iconType:"multipleRows"===e?"arrowDown":"boxesVertical",iconSide:"multipleRows"===e?"right":void 0,onClick:x,size:"xs"},"multipleRows"===e?j:null))),[e,t,x]),S=Object(o.useMemo)((()=>(({disableAllow:e,disableAnonymize:t,disableDeny:s,disableUnanonymize:a,closePopover:n,onListUpdated:i,selected:o})=>[{id:k,items:[{disabled:e,icon:"check",name:p,onClick:()=>{n();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"})));i(e)}},{disabled:s,icon:"cross",name:v,onClick:()=>{n();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"})));i(e)}},{disabled:t,icon:"eyeClosed",name:b,onClick:()=>{n();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"})));i(e)}},{disabled:a,icon:"eye",name:y,onClick:()=>{n();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"})));i(e)}},{isSeparator:!0,key:"sep"}]}])({disableAllow:s,disableAnonymize:a,disableDeny:n,disableUnanonymize:l,closePopover:f,onListUpdated:r,selected:c})),[f,s,a,n,l,r,c]);return Object(C.jsx)(i.EuiPopover,{anchorPosition:"downLeft",button:O,closePopover:f,"data-test-subj":"bulkActions",id:g,isOpen:u,panelPaddingSize:"none"},Object(C.jsx)(i.EuiContextMenu,{initialPanelId:k,panels:S,size:"s"}))},A=l.a.memo(h),E="allowed",w="anonymized",T="field",M=c()(i.EuiButtonEmpty)`
  max-height: 24px;
`;var P=s(1380);const z=({onListUpdated:e,onSelectAll:t,selected:s,totalFields:a})=>Object(C.jsx)(i.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbar",gutterSize:"none"},Object(C.jsx)(i.EuiFlexItem,{grow:!1},Object(C.jsx)(i.EuiText,{color:"subdued","data-test-subj":"selectedFields",size:"xs"},(e=>u.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectedFields",{values:{selected:e},defaultMessage:"Selected {selected} fields"}))(s.length))),Object(C.jsx)(i.EuiFlexItem,{grow:!1},Object(C.jsx)(i.EuiButtonEmpty,{"data-test-subj":"selectAllFields",iconType:"pagesSelect",onClick:t,size:"xs"},(e=>u.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectAllFields",{values:{totalFields:e},defaultMessage:"Select all {totalFields} fields"}))(a))),Object(C.jsx)(i.EuiFlexItem,{grow:!1},Object(C.jsx)(A,{appliesTo:"multipleRows",disabled:0===s.length,onListUpdated:e,selected:s})));z.displayName="ToolbarComponent";const D=l.a.memo(z);var F=s(241),B=s(1345),I=s(1215);const L=n()("div",{target:"e9jzbiz0"})({name:"r5zj6l",styles:">div>.euiSpacer{block-size:16px;}"}),R={page:{size:10,index:0},sort:{direction:"asc",field:T}},N={box:{incremental:!0},filters:[{field:E,type:"is",name:m},{field:w,type:"is",name:g}]},_=({anonymizationFields:e,compressed:t=!0,onListUpdated:s,rawData:a,pageSize:n=10})=>{const l=Object(o.useRef)(!1),{assistantAvailability:{hasUpdateAIAssistantAnonymization:r},nameSpace:c}=Object(F.b)(),[u,d]=Object(o.useState)([]),p=Object(o.useMemo)((()=>({selectable:()=>!0,onSelectionChange:e=>{!0===l.current?l.current=!1:d(e)},selected:u})),[u]),b=Object(o.useMemo)((()=>(({compressed:e=!0,hasUpdateAIAssistantAnonymization:t,onListUpdated:s,rawData:a})=>{const n={field:"actions",name:"",render:(e,t)=>Object(C.jsx)(A,{appliesTo:"singleRow",disabled:!1,disableAllow:t.allowed,disableDeny:!t.allowed,disableAnonymize:!t.allowed||t.allowed&&t.anonymized,disableUnanonymize:!t.allowed||t.allowed&&!t.anonymized,onListUpdated:s,selected:[t]}),sortable:!1,width:"36px"},o={field:"rawValues",name:O,render:e=>Object(C.jsx)(i.EuiCode,{"data-test-subj":"rawValues"},e.join(",")),sortable:!1},l=[{field:E,name:m,render:(n,{allowed:o,field:l})=>Object(C.jsx)(i.EuiSwitch,{"data-test-subj":"allowed",checked:o,disabled:!t,label:"",showLabel:!1,compressed:e,onChange:()=>{s([{field:l,operation:o?"remove":"add",update:null==a?"defaultAllow":"allow"}])}}),sortable:!0,width:"75px"},{field:w,name:g,render:(e,{allowed:n,anonymized:o,field:l})=>Object(C.jsx)(M,{"data-test-subj":"anonymized",disabled:!n||!t,color:o?"primary":"text",flush:"both",iconType:o?"eyeClosed":"eye",isSelected:!!o,onClick:()=>s([{field:l,operation:o?"remove":"add",update:null==a?"defaultAllowReplacement":"allowReplacement"}])},Object(C.jsx)(i.EuiText,{size:"xs"},o?S:x)),sortable:!0,width:"102px"},{field:T,name:f,sortable:!0,width:"260px"}];return null==a?[...l,...t?[n]:[]]:[...l,o,...t?[n]:[]]})({onListUpdated:s,rawData:a,hasUpdateAIAssistantAnonymization:r,compressed:t})),[r,s,a,t]),j=Object(o.useMemo)((()=>(({anonymizationFields:e,rawData:t})=>{return null!==t&&"object"==typeof t?Object.keys(t).sort().reduce(((s,a)=>{var n,i,o;return[...s,{field:a,allowed:Object(P.a)({anonymizationFields:null!==(n=null==e?void 0:e.data)&&void 0!==n?n:[],field:a}),anonymized:Object(P.b)({anonymizationFields:null!==(i=null==e?void 0:e.data)&&void 0!==i?i:[],field:a}),denied:Object(P.c)({anonymizationFields:null!==(o=null==e?void 0:e.data)&&void 0!==o?o:[],field:a}),rawValues:t[a]}]}),[]):(null!==(s=null==e?void 0:e.data)&&void 0!==s?s:[]).map((e=>{var t,s,a;return{field:e.field,allowed:null!==(t=e.allowed)&&void 0!==t&&t,anonymized:null!==(s=e.anonymized)&&void 0!==s&&s,denied:!(null!==(a=e.allowed)&&void 0!==a&&a),rawValues:[]}}));var s})({anonymizationFields:e,rawData:a})),[e,a]),v=Object(o.useCallback)((()=>{l.current=!0,d(j)}),[j]),{onTableChange:y,pagination:k,sorting:h}=Object(B.b)({defaultTableOptions:R,nameSpace:c,storageKey:I.a}),z=Object(o.useMemo)((()=>Object(C.jsx)(D,{onListUpdated:s,onSelectAll:v,selected:u,totalFields:null==a?e.total:Object.keys(a).length})),[e.total,s,v,a,u]);return Object(C.jsx)(L,null,Object(C.jsx)(i.EuiInMemoryTable,{allowNeutralSort:!1,childrenBetween:r?z:void 0,columns:b,compressed:t,"data-test-subj":"contextEditor",itemId:T,items:j,pagination:k,search:N,selection:p,sorting:h,onTableChange:y}))};_.displayName="ContextEditorComponent";const q=l.a.memo(_)},1486:function(e,t,s){"use strict";s.d(t,"a",(function(){return y}));var a=s(19),n=s(2),i=s.n(n),o=s(41),l=s.n(o),r=s(1492),c=s(1488),u=s(1462),d=s(43),p=s(49),m=s(1290),b=s(4);const g=b.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableDescription",{defaultMessage:"Available"}),j=({total:e,inline:t,titleSize:s=m.a,gap:i=p.euiThemeVars.euiSizeXS})=>{const o=Object(n.useMemo)((()=>(e=>b.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableTooltip",{values:{total:e},defaultMessage:"{total} fields in this context are available to be included in the conversation"}))(e)),[e]);return Object(d.jsx)(a.EuiToolTip,{content:o},Object(d.jsx)(a.EuiStat,{css:t?Object(d.css)("display:flex;align-items:center;gap:",i,";",""):null,"data-test-subj":"availableStat",description:g,reverse:!0,title:e,titleSize:s}))};j.displayName="AvailableStatComponent";const v=i.a.memo(j),f=l()(a.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,x=({isDataAnonymizable:e,anonymizationFields:t,rawData:s,inline:i,replacements:o,titleSize:l,gap:p})=>{const{allowed:m,anonymized:b,total:g}=Object(n.useMemo)((()=>Object(u.a)({anonymizationFields:t,rawData:s,replacements:o})),[t,s,o]);return Object(d.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"stats",gutterSize:"none"},e&&Object(d.jsx)(f,{grow:!1},Object(d.jsx)(r.a,{allowed:m,gap:p,total:g,inline:i,titleSize:l})),Object(d.jsx)(f,{grow:!1},Object(d.jsx)(c.a,{anonymized:b,isDataAnonymizable:e||b>0,inline:i,titleSize:l,gap:p})),e&&Object(d.jsx)(f,{grow:!1},Object(d.jsx)(v,{total:g,inline:i,titleSize:l,gap:p})))};x.displayName="StatsComponent";const y=i.a.memo(x)},1487:function(e,t,s){"use strict";s.d(t,"a",(function(){return M}));var a=s(43),n=s(19),i=s(2),o=s.n(i),l=s(49),r=s(659),c=s(721),u=s.n(c),d=s(44),p=s(4);p.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addSystemPromptTooltip",{defaultMessage:"Add system prompt"});const m=p.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.clearSystemPrompt",{defaultMessage:"Clear system prompt"}),b=p.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.selectASystemPromptPlaceholder",{defaultMessage:"Select a system prompt"}),g=p.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addNewSystemPrompt",{defaultMessage:"Add new system prompt..."}),j=p.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.emptyPrompt",{defaultMessage:"(empty prompt)"}),v=u()("strong",{target:"eqnkmgl0"})("margin-right:",l.euiThemeVars.euiSizeS,";");var f=s(241),x=s(812),y=s(918),O=s(1382),S=s(821);const k="ADD_NEW_SYSTEM_PROMPT";var C={name:"pozf4a",styles:"position:absolute;right:36px"},h={name:"1jqbq32",styles:"padding-right:56px!important"},A={name:"1bxycju",styles:"min-width:100%"},E={name:"qhxz92",styles:"max-width:100%"},w={name:"bjn8wh",styles:"position:relative"};const T=({allPrompts:e,compressed:t=!1,conversation:s,selectedPrompt:c,clearSelectedSystemPrompt:u,isClearable:p=!1,isCleared:T=!1,isDisabled:M=!1,isOpen:P=!1,refetchConversations:z,isSettingsModalVisible:D,onSystemPromptSelectionChange:F,setIsSettingsModalVisible:B,onSelectedConversationChange:I,setConversationSettings:L,setConversationsSettingsBulkActions:R})=>{const{setSelectedSettingsTab:N}=Object(f.b)(),{setApiConfig:_}=Object(x.a)(),q=Object(i.useMemo)((()=>e.filter((e=>e.promptType===r.a.system))),[e]),[U,Q]=Object(i.useState)(P),V=Object(i.useCallback)((()=>Q(!1)),[]),G=Object(i.useMemo)((()=>null==c?void 0:c.id),[null==c?void 0:c.id]),K=Object(i.useCallback)((async e=>{if(s&&s.apiConfig){const t=await _({conversation:s,apiConfig:{...s.apiConfig,defaultSystemPromptId:e}});return await(null==z?void 0:z()),t}}),[s,z,_]),$=Object(i.useMemo)((()=>({value:k,inputDisplay:g,dropdownDisplay:Object(a.jsx)(n.EuiFlexGroup,{gutterSize:"none",key:k},Object(a.jsx)(n.EuiFlexItem,{grow:!0},Object(a.jsx)(n.EuiButtonEmpty,{href:"#",iconType:"plus",size:"xs","data-test-subj":"addSystemPrompt"},g)),Object(a.jsx)(n.EuiFlexItem,{grow:!1},Object(a.jsx)("div",{style:{width:"24px"}})))})),[]),W=Object(i.useMemo)((()=>(({prompts:e,isCleared:t})=>{var s;return null!==(s=null==e?void 0:e.map((e=>(({content:e,id:t,isCleared:s,name:i})=>({value:t,inputDisplay:Object(a.jsx)("span",{"data-test-subj":"systemPromptText",css:Object(a.css)("color:",s?l.euiThemeVars.euiColorLightShade:l.euiThemeVars.euiColorDarkestShade,";","")},i),dropdownDisplay:Object(a.jsx)(o.a.Fragment,null,Object(a.jsx)(v,{"data-test-subj":"name"},i),Object(a.jsx)(n.EuiToolTip,{content:void 0},Object(a.jsx)(n.EuiText,{color:"subdued","data-test-subj":"content",size:"s"},Object(d.isEmpty)(e)?Object(a.jsx)("p",null,j):Object(a.jsx)("p",null,e))))}))({...e,isCleared:t}))))&&void 0!==s?s:[]})({prompts:q,isCleared:T})),[q,T]),H=Object(i.useCallback)((async e=>{if(e===k)return B(!0),void N(S.h);null!=F&&F(e);const t=await K(e);t&&(null==L||L((e=>Object.entries(e).reduce(((e,[s,a])=>(t.title===a.title?e[t.id]=t:e[s]=a,e)),{}))),null==I||I(t),null==R||R({}))}),[I,F,L,R,B,N,K]),Y=Object(i.useCallback)((()=>{null==u||u()}),[u]);return Object(a.jsx)(n.EuiFlexGroup,{"data-test-subj":"selectSystemPrompt",gutterSize:"none",alignItems:"center",css:w},Object(a.jsx)(n.EuiFlexItem,{css:E},Object(a.jsx)(n.EuiFormRow,{css:A},Object(a.jsx)(n.EuiSuperSelect,{popoverProps:{zIndex:l.euiThemeVars.euiZLevel8},compressed:t,"data-test-subj":y.a.PROMPT_SUPERSELECT,fullWidth:!0,hasDividers:!0,itemLayoutAlign:"top",disabled:M,isOpen:U&&!D,onChange:H,onBlur:V,options:[...W,$],placeholder:b,valueOfSelected:G,prepend:D?void 0:O.c,css:h}))),Object(a.jsx)(n.EuiFlexItem,{grow:!1,css:C},p&&c&&Object(a.jsx)(n.EuiToolTip,{content:m},Object(a.jsx)(n.EuiButtonIcon,{"aria-label":m,"data-test-subj":"clearSystemPrompt",iconType:"cross",onClick:Y,css:Object(a.css)("inline-size:16px;block-size:16px;border-radius:16px;background:",T?l.euiThemeVars.euiColorLightShade:l.euiThemeVars.euiColorMediumShade,";:hover:not(:disabled){background:",T?l.euiThemeVars.euiColorLightShade:l.euiThemeVars.euiColorMediumShade,";transform:none;}>svg{width:8px;height:8px;stroke-width:2px;fill:#fff;stroke:#fff;}","")}))))};T.displayName="SelectSystemPromptComponent";const M=o.a.memo(T)},1488:function(e,t,s){"use strict";s.d(t,"a",(function(){return p}));var a=s(19),n=s(2),i=s.n(n),o=s(43),l=s(49),r=s(4);const c=r.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.anonymizeFieldsdDescription",{defaultMessage:"Anonymized"});var u=s(1290);const d=({anonymized:e,isDataAnonymizable:t,inline:s,titleSize:i=u.a,gap:d=l.euiThemeVars.euiSizeXS})=>{const p=Object(n.useMemo)((()=>(e=>e?"default":"subdued")(t)),[t]),m=Object(n.useMemo)((()=>(({anonymized:e,isDataAnonymizable:t})=>t&&0!==e?(e=>r.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.fieldsWillBeAnonymizedTooltip",{values:{anonymized:e},defaultMessage:"{anonymized} {anonymized, plural, =1 {field} other {fields}} in this context will be replaced with random values. Responses are automatically translated back to the original values."}))(e):(e=>r.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.noneOfTheDataWillBeAnonymizedTooltip",{values:{isDataAnonymizable:e},defaultMessage:"{isDataAnonymizable, select, true {Select fields to be replaced with random values. Responses are automatically translated back to the original values.} other {This context cannot be anonymized}}"}))(t))({anonymized:e,isDataAnonymizable:t})),[e,t]),b=Object(n.useMemo)((()=>Object(o.jsx)(a.EuiText,{color:p,"data-test-subj":"description",size:"s"},c)),[p]);return Object(o.jsx)(a.EuiToolTip,{content:m},Object(o.jsx)(a.EuiStat,{css:s?Object(o.css)("display:flex;align-items:center;gap:",d,";",""):null,"data-test-subj":"anonymizedFieldsStat",description:b,reverse:!0,titleColor:p,title:e,titleSize:i}))};d.displayName="AnonymizedStatComponent";const p=i.a.memo(d)},1492:function(e,t,s){"use strict";s.d(t,"a",(function(){return p}));var a=s(19),n=s(2),i=s.n(n),o=s(49),l=s(43),r=s(1290),c=s(4);const u=c.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedDescription",{defaultMessage:"Allowed"}),d=({allowed:e,total:t,inline:s,titleSize:i=r.a,gap:d=o.euiThemeVars.euiSizeXS})=>{const p=Object(n.useMemo)((()=>(({allowed:e,total:t})=>c.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedTooltip",{values:{allowed:e,total:t},defaultMessage:"{allowed} of {total} fields in this context are allowed to be included in the conversation"}))({allowed:e,total:t})),[e,t]);return Object(l.jsx)(a.EuiToolTip,{content:p},Object(l.jsx)(a.EuiStat,{css:s?Object(l.css)("display:flex;align-items:center;gap:",d,";",""):null,"data-test-subj":"allowedStat",description:u,reverse:!0,title:e,titleSize:i}))};d.displayName="AllowedStatComponent";const p=i.a.memo(d)},1543:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s(4),n=s(2081),i=s(2080);const o=async(e,t,s)=>{try{const s=await e.fetch(n.h,{method:"POST",version:i.a.public.v1,body:JSON.stringify(t)});if(!s.success){var o;const e=null===(o=s.attributes.errors)||void 0===o?void 0:o.map((e=>`${e.status_code?`Error code: ${e.status_code}. `:""}Error message: ${e.message} for prompt ${e.prompts.map((e=>e.name)).join(",")}`)).join(",\n");throw new Error(e)}return s}catch(e){null==s||s.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:a.i18n.translate("xpack.elasticAssistant.prompts.bulkActionspromptsError",{defaultMessage:"Error updating prompts {error}",values:{error:e.message?Array.isArray(e.message)?e.message.join(","):e.message:e}})})}}},1544:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s(4),n=s(2081),i=s(2080);const o=async(e,t,s)=>{var o,l;const r=t.create?(c=t.create,u=null===(o=t.delete)||void 0===o?void 0:o.ids,Object.keys(c).reduce(((e,t)=>(!c||null!=u&&u.includes(t)||e.push(c[t]),e)),[])):void 0;var c,u;const d=t.update?((e,t)=>Object.keys(e).reduce(((s,a)=>(!e||null!=t&&t.includes(a)||s.push({id:a,...e[a]}),s)),[]))(t.update,null===(l=t.delete)||void 0===l?void 0:l.ids):void 0;try{const s=await e.fetch(n.d,{method:"POST",version:i.a.internal.v1,body:JSON.stringify({update:d,create:r,delete:t.delete})});if(!s.success){var p;const e=null===(p=s.attributes.errors)||void 0===p?void 0:p.map((e=>`${e.status_code?`Error code: ${e.status_code}. `:""}Error message: ${e.message} for conversation ${e.conversations.map((e=>e.name)).join(",")}`)).join(",\n");throw new Error(e)}return s}catch(e){null==s||s.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:a.i18n.translate("xpack.elasticAssistant.conversations.bulkActionsConversationsError",{defaultMessage:"Error updating conversations {error}",values:{error:e.message?Array.isArray(e.message)?e.message.join(","):e.message:e}})})}}},1545:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var a=s(2),n=s(756);const i=({allSystemPrompts:e,conversationSettings:t,conversationsSettingsBulkActions:s,defaultConnector:i,setConversationSettings:o,setConversationsSettingsBulkActions:l,onSelectedConversationChange:r})=>{const c=Object(a.useMemo)((()=>Object(n.d)({allSystemPrompts:e,conversation:void 0})),[e]);return Object(a.useCallback)(((e="")=>{const a="string"==typeof e,n=a?{id:"",title:null!=e?e:"",category:"assistant",messages:[],replacements:{},...i?{apiConfig:{connectorId:i.id,actionTypeId:i.actionTypeId,provider:i.apiProvider,defaultSystemPromptId:null==c?void 0:c.id}}:{}}:e;var u;n&&(a||""===n.id)?(o({...t,[a?e:n.title]:n}),l({...s,create:{...null!==(u=s.create)&&void 0!==u?u:{},[n.title]:n}})):null!=n&&o((e=>({...e,[n.id]:n}))),r({...n,id:n.id||n.title})}),[t,s,i,null==c?void 0:c.id,r,o,l])}},1546:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(2);const n=({conversationSettings:e,conversationsSettingsBulkActions:t,setConversationSettings:s,setConversationsSettingsBulkActions:n})=>Object(a.useCallback)((a=>{var i,o,l;const r=null===(i=Object.values(e).find((e=>e.title===a)))||void 0===i?void 0:i.id;if(!r)return;const c={...e};delete c[r],s(c),n({...t,delete:{ids:[...null!==(o=null===(l=t.delete)||void 0===l?void 0:l.ids)&&void 0!==o?o:[],r]}})}),[e,t,s,n])},1547:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(2);const n=({anonymizationFields:e,anonymizationFieldsBulkActions:t,setAnonymizationFieldsBulkActions:s,setUpdatedAnonymizationData:n})=>Object(a.useCallback)((async a=>{var i;const o=a.map((e=>e.field)),l=a.map((t=>{var s;return{...null!==(s=e.data.find((e=>e.field===t.field)))&&void 0!==s?s:{id:"",field:""},..."allow"===t.update||"defaultAllow"===t.update?{allowed:"add"===t.operation}:{},..."allowReplacement"===t.update||"defaultAllowReplacement"===t.update?{anonymized:"add"===t.operation}:{}}}));s({...t,update:[...null!==(i=null==t?void 0:t.update)&&void 0!==i?i:[],...l]}),n({...e,data:[...e.data.filter((e=>!o.includes(e.field))),...l]})}),[e,t,s,n])},1548:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var a=s(19),n=s(43),i=s(2),o=s.n(i),l=s(1291);const r=({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{const s=Object(a.useGeneratedHtmlId)({prefix:"inputRangeSlider"});return Object(n.jsx)(o.a.Fragment,null,Object(n.jsx)(a.EuiFormRow,{display:"columnCompressedSwitch",label:l.a,css:Object(n.css)(".euiFormRow__labelWrapper{min-width:",95,"px!important;}","")},Object(n.jsx)(o.a.Fragment,null)),Object(n.jsx)(a.EuiSpacer,{size:"xs"}),Object(n.jsx)(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(n.jsx)(a.EuiFlexItem,{css:Object(n.css)("width:",300,"px;",""),grow:!1},Object(n.jsx)(a.EuiSpacer,{size:"xs"}),Object(n.jsx)(a.EuiRange,{"aria-label":l.b,compressed:!0,"data-test-subj":"alertsRange",id:s,max:100,min:10,onChange:s=>t({...e,latestAlerts:Number(s.currentTarget.value)}),showTicks:!0,step:10,value:e.latestAlerts}),Object(n.jsx)(a.EuiSpacer,{size:"s"})),Object(n.jsx)(a.EuiFlexItem,{grow:!1},Object(n.jsx)(a.EuiText,{color:"subdued",size:"xs"},Object(n.jsx)("span",null,l.k(e.latestAlerts)))),Object(n.jsx)(a.EuiFlexItem,{grow:!1},Object(n.jsx)(a.EuiText,{color:"subdued",size:"xs"},Object(n.jsx)("span",null,l.q))),Object(n.jsx)(a.EuiFlexItem,{grow:!1},Object(n.jsx)(a.EuiText,{color:"subdued",size:"xs"},Object(n.jsx)("span",null,l.l)))))},c=o.a.memo(r)},1611:function(e,t,s){"use strict";s.d(t,"a",(function(){return S}));var a=s(2),n=s.n(a),i=s(19),o=s(43),l=s(1457),r=s(4);const c=r.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),u=r.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.deletePromptTitle",{defaultMessage:"Delete Quick Prompt"}),d=r.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.customOptionText",{defaultMessage:"Create new Quick Prompt named"});var p={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},m={name:"d3v9zr",styles:"overflow:hidden"},b={name:"1e5733u",styles:"width:calc(100% - 60px)"};const g=n.a.memo((({isDisabled:e=!1,quickPrompts:t,onQuickPromptDeleted:s,onQuickPromptSelectionChange:n,resetSettings:l,selectedQuickPrompt:r})=>{const[g,j]=Object(a.useState)(t.map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.name,"data-test-subj":e.name,id:e.id,color:e.color}}))),v=Object(a.useMemo)((()=>r?[{value:{isDefault:!0},label:r.name,id:r.id,color:r.color}]:[]),[r]),f=Object(a.useCallback)((e=>{var s,a;null==l||l();const i=0===e.length?void 0:null!==(s=t.find((t=>{var s;return t.name===(null===(s=e[0])||void 0===s?void 0:s.label)})))&&void 0!==s?s:null===(a=e[0])||void 0===a?void 0:a.label;n(i)}),[n,l,t]),x=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const s=e.trim().toLowerCase(),a={value:e,label:e,id:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===s))||j([...g,a]),f([a])}),[f,g]),y=Object(a.useCallback)((e=>{0===e.length?f([]):-1!==g.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&f(e)}),[f,g]),O=Object(a.useCallback)((e=>{var t,a;const n=null===(t=g.find((t=>t.label===e)))||void 0===t?void 0:t.id;j(g.filter((t=>t.label!==e))),(null==v||null===(a=v[0])||void 0===a?void 0:a.label)===e&&f([]),s(null!=n?n:e)}),[f,s,g,v]);return Object(o.jsx)(i.EuiComboBox,{"data-test-subj":"quickPromptSelector","aria-label":c,compressed:!0,isDisabled:e,placeholder:c,customOptionText:`${d} {searchValue}`,singleSelection:!0,options:g,selectedOptions:v,onChange:y,onCreateOption:x,renderOption:(e,t)=>{const{color:s,label:a,value:n}=e;return Object(o.jsx)(i.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(o.jsx)(i.EuiFlexItem,{component:"span",grow:!1,css:b},Object(o.jsx)(i.EuiHealth,{color:s,css:m},Object(o.jsx)(i.EuiHighlight,{search:t},a))),!(null!=n&&n.isDefault)&&Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiToolTip,{position:"right",content:u},Object(o.jsx)(i.EuiButtonIcon,{iconType:"cross","aria-label":u,"data-test-subj":"delete-quick-prompt",color:"danger",onClick:e=>{e.stopPropagation(),O(a)},css:p}))))},fullWidth:!0})}));g.displayName="QuickPromptSelector";var j=s(1382);const v=n.a.memo((({isDisabled:e,onPromptContextSelectionChange:t,promptContexts:s,selectedPromptContexts:n=[]})=>{const l=Object(a.useMemo)((()=>s.map((e=>({value:{category:e.category},label:e.description,"data-test-subj":e.description})))),[s]),r=Object(a.useMemo)((()=>null!=n?n.map((e=>({value:{category:e.category},label:e.description}))):[]),[n]),c=Object(a.useCallback)((e=>{const a=s.filter((t=>e.some((e=>t.description===e.label))));t(a)}),[t,s]),u=Object(a.useCallback)((e=>{0===e.length?c([]):-1!==l.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&c(e)}),[c,l]);return Object(o.jsx)(i.EuiComboBox,{"aria-label":j.a,compressed:!0,fullWidth:!0,isDisabled:e,placeholder:j.b,options:l,selectedOptions:r,onChange:u,renderOption:(e,t,s)=>{const{label:a,value:n}=e;return Object(o.jsx)("span",{className:s},Object(o.jsx)(i.EuiHighlight,{search:t},a),Object(o.jsx)("span",null,` / (${null==n?void 0:n.category})`))}})}));v.displayName="PromptContextSelector";var f=s(241),x=s(1458),y={name:"xpz1vu",styles:"min-height:150px"};const O=({onSelectedQuickPromptChange:e,quickPromptSettings:t,resetSettings:s,selectedQuickPrompt:r,setUpdatedQuickPromptSettings:c,promptsBulkActions:u,setPromptsBulkActions:d})=>{const{basePromptContexts:p}=Object(f.b)(),m=Object(a.useMemo)((()=>{var e,s;return null!==(e=null===(s=t.find((e=>e.id===(null==r?void 0:r.id))))||void 0===s?void 0:s.content)&&void 0!==e?e:""}),[null==r?void 0:r.id,t]),b=Object(a.useCallback)((e=>{var s,a;null!=r&&(c((t=>t.some((e=>e.id===r.id))?t.map((t=>t.id===r.id?{...t,content:e.target.value}:t)):t)),t.find((e=>e.id===r.id))&&d({...u,...r.name!==r.id?{update:[...(null!==(s=u.update)&&void 0!==s?s:[]).filter((e=>e.id!==r.id)),{...r,content:e.target.value}]}:{create:[...(null!==(a=u.create)&&void 0!==a?a:[]).filter((e=>e.name!==r.name)),{...r,content:e.target.value}]}}))}),[u,t,r,d,c]),j=Object(a.useMemo)((()=>{var e;return null!==(e=null==r?void 0:r.color)&&void 0!==e?e:"#D36086"}),[null==r?void 0:r.color]),O=Object(a.useCallback)(((e,{hex:s,isValid:a})=>{var n,i;null!=r&&(c((t=>t.some((e=>e.name===r.name))?t.map((t=>t.name===r.name?{...t,color:e}:t)):t)),t.find((e=>e.id===r.id))&&d({...u,...r.name!==r.id?{update:[...(null!==(n=u.update)&&void 0!==n?n:[]).filter((e=>e.id!==r.id)),{...r,color:e}]}:{create:[...(null!==(i=u.create)&&void 0!==i?i:[]).filter((e=>e.name!==r.name)),{...r,color:e}]}}))}),[u,t,r,d,c]),S=Object(a.useMemo)((()=>{var e;return null!==(e=p.filter((e=>{var t;return null==r||null===(t=r.categories)||void 0===t?void 0:t.some((t=>(null==e?void 0:e.category)===t))})))&&void 0!==e?e:[]}),[p,null==r?void 0:r.categories]),k=Object(a.useCallback)((e=>{var s,a;null!=r&&(c((t=>t.some((e=>e.name===r.name))?t.map((t=>t.name===r.name?{...t,categories:e.map((e=>e.category))}:t)):t)),t.find((e=>e.id===r.id))&&d({...u,...r.name!==r.id?{update:[...(null!==(s=u.update)&&void 0!==s?s:[]).filter((e=>e.id!==r.id)),{...r,categories:e.map((e=>e.category))}]}:{create:[...(null!==(a=u.create)&&void 0!==a?a:[]).filter((e=>e.name!==r.name)),{...r,categories:e.map((e=>e.category))}]}}))}),[u,t,r,d,c]),{onQuickPromptDeleted:C,onQuickPromptSelectionChange:h}=Object(x.a)({onSelectedQuickPromptChange:e,setUpdatedQuickPromptSettings:c,promptsBulkActions:u,setPromptsBulkActions:d});return Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiFormRow,{label:l.d,display:"rowCompressed",fullWidth:!0},Object(o.jsx)(g,{onQuickPromptDeleted:C,onQuickPromptSelectionChange:h,quickPrompts:t,resetSettings:s,selectedQuickPrompt:r})),Object(o.jsx)(i.EuiFormRow,{label:l.e,display:"rowCompressed",fullWidth:!0},Object(o.jsx)(i.EuiTextArea,{compressed:!0,disabled:null==r,fullWidth:!0,"data-test-subj":"quick-prompt-prompt",onChange:b,placeholder:l.f,value:m,css:y})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:l.b,helpText:l.c},Object(o.jsx)(v,{isDisabled:null==r,onPromptContextSelectionChange:k,promptContexts:p,selectedPromptContexts:S})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:l.a},Object(o.jsx)(i.EuiColorPicker,{color:j,compressed:!0,disabled:null==r,onChange:O})))},S=Object(a.memo)(O);S.displayName="QuickPromptSettingsEditor"},1612:function(e,t,s){"use strict";s.d(t,"a",(function(){return h}));var a=s(2),n=s.n(a),i=s(19),o=s(44),l=s(43),r=s(920),c=s(918);const u=n.a.memo((({conversations:e,isDisabled:t=!1,onConversationSelectionChange:s,selectedConversations:n=[]})=>{const o=Object(a.useMemo)((()=>e.map((e=>{var t;return{label:null!==(t=e.title)&&void 0!==t?t:"","data-test-subj":c.a.CONVERSATIONS_MULTISELECTOR_OPTION(e.title)}}))),[e]),u=Object(a.useMemo)((()=>null!=n?n.map((e=>({label:e.title}))):[]),[n]),d=Object(a.useCallback)((t=>{const a=e.filter((e=>t.some((t=>e.title===t.label))));s(a)}),[s,e]),p=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,o]);return Object(l.jsx)(i.EuiComboBox,{"aria-label":r.c,compressed:!0,"data-test-subj":c.a.CONVERSATIONS_MULTISELECTOR,isDisabled:t,fullWidth:!0,options:o,selectedOptions:u,onChange:p})}));u.displayName="ConversationMultiSelector";var d=s(4);const p=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),m=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.deletePromptTitle",{defaultMessage:"Delete System Prompt"}),b=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.customOptionText",{defaultMessage:"Create new System Prompt named"});var g={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},j={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},v={name:"qhxz92",styles:"max-width:100%"},f={name:"1e5733u",styles:"width:calc(100% - 60px)"};const x=n.a.memo((({autoFocus:e=!1,onSystemPromptDeleted:t,onSystemPromptSelectionChange:s,resetSettings:n,selectedSystemPrompt:o,systemPrompts:u})=>{const[d,x]=Object(a.useState)(u.map((e=>{var t,s;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t,isNewConversationDefault:null!==(s=e.isNewConversationDefault)&&void 0!==s&&s},label:e.name,id:e.id,"data-test-subj":`${c.a.SYSTEM_PROMPT_SELECTOR}-${e.id}`}}))),y=Object(a.useMemo)((()=>{var e,t;return o?[{value:{isDefault:null!==(e=o.isDefault)&&void 0!==e&&e,isNewConversationDefault:null!==(t=o.isNewConversationDefault)&&void 0!==t&&t},id:o.id,label:o.name}]:[]}),[o]),O=Object(a.useCallback)((e=>{var t,a;null==n||n();const i=0===e.length?void 0:null!==(t=u.find((t=>{var s;return t.name===(null===(s=e[0])||void 0===s?void 0:s.label)})))&&void 0!==t?t:null===(a=e[0])||void 0===a?void 0:a.label;s(i)}),[s,n,u]),S=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const s=e.trim().toLowerCase(),a={value:e,id:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===s))||x([...d,a]),O([a])}),[O,d]),k=Object(a.useCallback)((e=>{0===e.length?O([]):-1!==d.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&O(e)}),[O,d]),C=Object(a.useCallback)((e=>{var s,a;const n=null===(s=d.find((t=>t.label===e)))||void 0===s?void 0:s.id;x(d.filter((t=>t.label!==e))),(null==y||null===(a=y[0])||void 0===a?void 0:a.label)===e&&O([]),t(null!=n?n:e)}),[O,t,d,y]);return Object(l.jsx)(i.EuiComboBox,{"aria-label":p,className:"systemPromptSelector",compressed:!0,"data-test-subj":c.a.SYSTEM_PROMPT_SELECTOR,fullWidth:!0,placeholder:p,customOptionText:`${b} {searchValue}`,singleSelection:{asPlainText:!0},options:d,selectedOptions:y,onChange:k,onCreateOption:S,renderOption:(e,t)=>{const{label:s,value:a}=e;return Object(l.jsx)(i.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":"systemPromptOptionSelector"},Object(l.jsx)(i.EuiFlexItem,{grow:!1,component:"span",css:f},Object(l.jsx)(i.EuiFlexGroup,{alignItems:"center",component:"span",gutterSize:"s"},Object(l.jsx)(i.EuiFlexItem,{component:"span",grow:!1,css:v},Object(l.jsx)(i.EuiHighlight,{search:t,css:j},s)),(null==a?void 0:a.isNewConversationDefault)&&Object(l.jsx)(i.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(i.EuiToolTip,{position:"right",content:r.e},Object(l.jsx)(i.EuiIcon,{type:"starFilled"}))))),!(null!=a&&a.isDefault)&&Object(l.jsx)(i.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(i.EuiToolTip,{position:"right",content:m},Object(l.jsx)(i.EuiButtonIcon,{iconType:"cross","aria-label":m,color:"danger","data-test-subj":"delete-prompt",onClick:e=>{e.stopPropagation(),C(s)},css:g}))))},autoFocus:e})}));x.displayName="SystemPromptSelector";var y=s(1459),O=s(1460),S=s(756),k={name:"xpz1vu",styles:"min-height:150px"};const C=({connectors:e,conversationSettings:t,onSelectedSystemPromptChange:s,selectedSystemPrompt:d,setUpdatedSystemPromptSettings:p,setConversationSettings:m,systemPromptSettings:b,conversationsSettingsBulkActions:g,setConversationsSettingsBulkActions:j,defaultConnector:v,resetSettings:f,promptsBulkActions:C,setPromptsBulkActions:h})=>{const A=Object(a.useMemo)((()=>{var e,t;return null!==(e=null===(t=b.find((e=>e.id===(null==d?void 0:d.id))))||void 0===t?void 0:t.content)&&void 0!==e?e:""}),[null==d?void 0:d.id,b]),E=Object(a.useCallback)((e=>{if(null!=d&&(p((t=>t.some((e=>e.id===d.id))?t.map((t=>t.id===d.id?{...t,content:e.target.value}:t)):t)),b.find((e=>e.id===d.id)))){var t,s;const a={...C,...d.name!==d.id?{update:[...(null!==(t=C.update)&&void 0!==t?t:[]).filter((e=>e.id!==d.id)),{...d,content:e.target.value}]}:{create:[...(null!==(s=C.create)&&void 0!==s?s:[]).filter((e=>e.name!==d.name)),{...d,content:e.target.value}]}};h(a)}}),[C,d,h,p,b]),w=Object.entries(t).reduce(((t,[s,a])=>(t[s]={...a,...Object(S.b)({allSystemPrompts:b,connectors:e,conversation:a,defaultConnector:v})},t)),{}),T=Object(a.useMemo)((()=>Object.values(w)),[w]),M=Object(a.useMemo)((()=>null!=d?Object(y.a)(w,d.id):[]),[w,d]),P=Object(a.useCallback)((t=>{const s=t.map((e=>e.title)),a=e=>{var t;return s.includes(e.title)?null==d?void 0:d.id:e.apiConfig&&e.apiConfig.defaultSystemPromptId===(null==d?void 0:d.id)||null===(t=e.apiConfig)||void 0===t?void 0:t.defaultSystemPromptId};if(null!=d){m((e=>Object(o.keyBy)("title",Object.values(e).map((e=>{var t,s;return{...e,...e.apiConfig?{apiConfig:{...e.apiConfig,defaultSystemPromptId:a(e)}}:{apiConfig:{defaultSystemPromptId:a(e),connectorId:null!==(t=null==v?void 0:v.id)&&void 0!==t?t:"",actionTypeId:null!==(s=null==v?void 0:v.actionTypeId)&&void 0!==s?s:""}}}})))));let t={...g};Object.values(w).forEach((s=>{var n,i,o;const l=()=>{var t,n;return s.apiConfig?{apiConfig:{...Object(S.b)({allSystemPrompts:b,connectors:e,conversation:s,defaultConnector:v}).apiConfig,defaultSystemPromptId:null!==(t=a(s))&&void 0!==t?t:null===(n=Object(S.e)({allSystemPrompts:b}))||void 0===n?void 0:n.id}}:{}},r=""===s.id?{create:{...null!==(n=t.create)&&void 0!==n?n:{},[s.title]:{...s,...s.apiConfig?l():{}}}}:{},c=""!==s.id?{update:{...null!==(i=t.update)&&void 0!==i?i:{},[s.id]:{...t.update&&null!==(o=t.update[s.id])&&void 0!==o?o:{},...l()}}}:{};t={...t,...r,...c}})),j(t)}}),[e,g,w,v,d,m,j,b]),z=Object(a.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d.isNewConversationDefault)&&void 0!==e&&e}),[null==d?void 0:d.isNewConversationDefault]),D=Object(a.useCallback)((e=>{const t=e.target.checked,s=b.filter((e=>e.isNewConversationDefault)),a=(null==d?void 0:d.name)===(null==d?void 0:d.id),n=(null==d?void 0:d.name)!==(null==d?void 0:d.id);null!=d&&(p((e=>e.map((e=>({...e,isNewConversationDefault:d.id===e.id&&t}))))),h((()=>({update:[...s.filter((e=>{return e.id!==d.id&&(null==(t=e)?void 0:t.name)!==(null==t?void 0:t.id);var t})).map((e=>({...e,isNewConversationDefault:!1}))),...n?[{...d,isNewConversationDefault:t}]:[]],create:[...s.filter((e=>{return e.name!==d.name&&(null==(t=e)?void 0:t.name)===(null==t?void 0:t.id);var t})).map((e=>({...e,isNewConversationDefault:!1}))),...a?[{...d,isNewConversationDefault:t}]:[]]}))))}),[d,h,p,b]),{onSystemPromptSelectionChange:F,onSystemPromptDeleted:B}=Object(O.a)({setUpdatedSystemPromptSettings:p,onSelectedSystemPromptChange:s,promptsBulkActions:C,setPromptsBulkActions:h});return Object(l.jsx)(n.a.Fragment,null,Object(l.jsx)(i.EuiFormRow,{display:"rowCompressed",label:r.f,fullWidth:!0},Object(l.jsx)(x,{onSystemPromptDeleted:B,onSystemPromptSelectionChange:F,selectedSystemPrompt:d,resetSettings:f,systemPrompts:b})),Object(l.jsx)(i.EuiFormRow,{display:"rowCompressed",label:r.g,fullWidth:!0},Object(l.jsx)(i.EuiTextArea,{"data-test-subj":c.a.SYSTEM_PROMPT_MODAL.PROMPT_TEXT,disabled:null==d,onChange:E,placeholder:r.h,value:A,compressed:!0,fullWidth:!0,css:k})),Object(l.jsx)(i.EuiFormRow,{display:"rowCompressed",fullWidth:!0,helpText:r.d,label:r.c},Object(l.jsx)(u,{conversations:T,isDisabled:null==d,onConversationSelectionChange:P,selectedConversations:M})),Object(l.jsx)(i.EuiFormRow,{display:"rowCompressed"},Object(l.jsx)(i.EuiCheckbox,{"data-test-subj":c.a.SYSTEM_PROMPT_MODAL.TOGGLE_ALL_DEFAULT_CONVERSATIONS,disabled:null==d,id:"defaultNewConversation",label:Object(l.jsx)(i.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(l.jsx)(i.EuiFlexItem,null,r.e),Object(l.jsx)(i.EuiFlexItem,{grow:!1},Object(l.jsx)(i.EuiIcon,{type:z?"starFilled":"starEmpty"}))),checked:z,onChange:D})))},h=n.a.memo(C);h.displayName="SystemPromptEditor"},1616:function(e,t,s){"use strict";s.d(t,"a",(function(){return k}));var a=s(19),n=s(2),i=s.n(n),o=s(42),l=s(97),r=s(44),c=s(1384),u=s(4);const d=u.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.placeholderText",{defaultMessage:"Select or type to create new..."}),p=u.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.modelTitle",{defaultMessage:"Model"}),m=u.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.helpLabel",{defaultMessage:"Model to use for this connector"}),b=u.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.customOptionText",{defaultMessage:"Create new Model named"});var g=s(1362),j=s(1487),v=s(43);const f=["gpt-4o","gpt-4-turbo","gpt-4o-mini"],x=i.a.memo((({models:e=f,onModelSelectionChange:t,selectedModel:s=f[0]})=>{const[i,o]=Object(n.useState)(e.map((e=>({"data-test-subj":e,label:e})))),l=Object(n.useMemo)((()=>s?[{label:s}]:[]),[s]),r=Object(n.useCallback)((s=>{var a,n;const i=0===s.length?void 0:null!==(a=e.find((e=>{var t;return e===(null===(t=s[0])||void 0===t?void 0:t.label)})))&&void 0!==a?a:null===(n=s[0])||void 0===n?void 0:n.label;null==t||t(i)}),[t,e]),c=Object(n.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const s=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===s))||o([...i,a]),r([a])}),[r,i]),u=Object(n.useCallback)((e=>{0===e.length?r([]):-1!==i.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&r(e)}),[r,i]);return Object(v.jsx)(a.EuiComboBox,{"aria-label":m,compressed:!0,"data-test-subj":"model-selector",isClearable:!1,placeholder:d,customOptionText:`${b} {searchValue}`,singleSelection:{asPlainText:!0},options:i,selectedOptions:l,onChange:u,onCreateOption:c,fullWidth:!0})}));x.displayName="ModelSelector";var y=s(755),O=s(578),S=s(756);const k=i.a.memo((({allSystemPrompts:e,selectedConversation:t,conversationSettings:s,http:u,isDisabled:d=!1,setConversationSettings:b,conversationsSettingsBulkActions:f,setConversationsSettingsBulkActions:k,onSelectedConversationChange:C,refetchConversations:h})=>{var A,E,w;const{data:T,isSuccess:M}=Object(y.a)({http:u}),P=Object(n.useMemo)((()=>Object(S.d)({allSystemPrompts:e,conversation:t})),[e,t]),z=Object(n.useCallback)((e=>{if(null!=t&&t.apiConfig){const r={...t,apiConfig:{...t.apiConfig,defaultSystemPromptId:e}};if(b({...s,[r.id||r.title]:r}),""!==t.id){var a,n,i,o;k({...f,update:{...null!==(a=f.update)&&void 0!==a?a:{},[r.id]:{...r,...f.update&&null!==(n=f.update[r.id])&&void 0!==n?n:{},apiConfig:{...r.apiConfig,...null!==(i=(f.update&&null!==(o=f.update[r.id])&&void 0!==o?o:{}).apiConfig)&&void 0!==i?i:{},defaultSystemPromptId:e}}}})}else{var l;const e={...f,create:{...null!==(l=f.create)&&void 0!==l?l:{},[r.title]:r}};k(e)}}}),[s,f,t,b,k]),D=Object(n.useMemo)((()=>{var e;const s=null==t||null===(e=t.apiConfig)||void 0===e?void 0:e.connectorId;if(M)return null==T?void 0:T.find((e=>e.id===s))}),[M,T,null==t||null===(A=t.apiConfig)||void 0===A?void 0:A.connectorId]),F=Object(n.useMemo)((()=>{var e;return null==t||null===(e=t.apiConfig)||void 0===e?void 0:e.provider}),[null==t||null===(E=t.apiConfig)||void 0===E?void 0:E.provider]),B=Object(n.useMemo)((()=>""===(null==t?void 0:t.id)?t.title:null==t?void 0:t.id),[t]),I=Object(n.useCallback)((e=>{if(null!=t){const r=Object(O.c)(e),c={...t,apiConfig:{...t.apiConfig,connectorId:e.id,actionTypeId:e.actionTypeId,provider:null==r?void 0:r.apiProvider,model:null==r?void 0:r.defaultModel}};if(b({...s,[B]:c}),""!==t.id){var a,n,i,o;k({...f,update:{...null!==(a=f.update)&&void 0!==a?a:{},[c.id||c.title]:{...c,...f.update&&null!==(n=f.update[c.id])&&void 0!==n?n:{},apiConfig:{...c.apiConfig,...null!==(i=(f.update&&null!==(o=f.update[c.id])&&void 0!==o?o:{}).apiConfig)&&void 0!==i?i:{},connectorId:null==e?void 0:e.id,actionTypeId:null==e?void 0:e.actionTypeId,provider:null==r?void 0:r.apiProvider,model:null==r?void 0:r.defaultModel}}}})}else{var l;const e={...f,create:{...null!==(l=f.create)&&void 0!==l?l:{},[c.title||c.id]:c}};k(e)}}}),[s,f,t,B,b,k]),L=Object(n.useMemo)((()=>{var e,s,a;const n=null===(e=Object(O.c)(D))||void 0===e?void 0:e.defaultModel;return null!==(s=null==t||null===(a=t.apiConfig)||void 0===a?void 0:a.model)&&void 0!==s?s:n}),[D,null==t||null===(w=t.apiConfig)||void 0===w?void 0:w.model]),R=Object(n.useCallback)((e=>{if(null!=t&&t.apiConfig){const r={...t,apiConfig:{...t.apiConfig,model:e}};if(b({...s,[r.id||r.title]:r}),""!==t.id){var a,n,i,o;k({...f,update:{...null!==(a=f.update)&&void 0!==a?a:{},[r.id]:{...r,...f.update&&null!==(n=f.update[r.id])&&void 0!==n?n:{},apiConfig:{...r.apiConfig,...null!==(i=(f.update&&null!==(o=f.update[r.id])&&void 0!==o?o:{}).apiConfig)&&void 0!==i?i:{},model:e}}}})}else{var l;const e={...f,create:{...null!==(l=f.create)&&void 0!==l?l:{},[r.id||r.title]:r}};k(e)}}}),[s,f,t,b,k]);return Object(v.jsx)(i.a.Fragment,null,Object(v.jsx)(a.EuiFormRow,{"data-test-subj":"prompt-field",display:"rowCompressed",fullWidth:!0,label:c.f,helpText:c.e},Object(v.jsx)(j.a,{allPrompts:e,compressed:!0,conversation:t,isDisabled:d,onSystemPromptSelectionChange:z,refetchConversations:h,selectedPrompt:P,isSettingsModalVisible:!0,setIsSettingsModalVisible:r.noop,onSelectedConversationChange:C,setConversationSettings:b,setConversationsSettingsBulkActions:k})),Object(v.jsx)(a.EuiFormRow,{"data-test-subj":"connector-field",display:"rowCompressed",label:c.a,helpText:Object(v.jsx)(a.EuiLink,{href:`${u.basePath.get()}/app/management/insightsAndAlerting/triggersActionsConnectors/connectors`,target:"_blank",external:!0},Object(v.jsx)(o.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.connectorHelpTextTitle",defaultMessage:"The default LLM connector for this conversation type."}))},Object(v.jsx)(g.a,{isDisabled:d,onConnectorSelectionChange:I,selectedConnectorId:null==D?void 0:D.id})),!1===(null==D?void 0:D.isPreconfigured)&&F===l.OpenAiProviderType.OpenAi&&Object(v.jsx)(a.EuiFormRow,{"data-test-subj":"model-field",display:"rowCompressed",label:p,helpText:m},Object(v.jsx)(x,{onModelSelectionChange:R,selectedModel:L})))}));k.displayName="ConversationSettingsEditor"},2053:function(e,t,s){"use strict";s.d(t,"a",(function(){return de}));var a=s(2),n=s.n(a),i=s(19),o=s(43),l=s(42),r=s(4);r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsTitle",{defaultMessage:"Evaluation"});const c=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsDescription",{defaultMessage:"Run predictions and evaluations against test data sets using different models (connectors), agents, and evaluation schemes."}),u=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsTitle",{defaultMessage:"Run Details"}),d=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsDescription",{defaultMessage:"Configure test run details like project, run name, dataset, and output index."}),p=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsTitle",{defaultMessage:"Predictions"}),m=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsDescription",{defaultMessage:"Choose models (connectors) and corresponding agents the dataset should run against."}),b=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsTitle",{defaultMessage:"Evaluation (Optional)"}),g=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsDescription",{defaultMessage:"Evaluate prediction results using a specific model (connector) and evaluation criterion."}),j=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectLabel",{defaultMessage:"Project"}),v=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectDescription",{defaultMessage:"LangSmith project to write results to."}),f=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectPlaceholder",{defaultMessage:"8.12 Testing"}),x=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameLabel",{defaultMessage:"Run name"}),y=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameDescription",{defaultMessage:"Name for this specific test run."}),O=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNamePlaceholder",{defaultMessage:"8.12 ESQL Query Generation"}),S=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsLabel",{defaultMessage:"Connectors / Models"}),k=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsDescription",{defaultMessage:"Select models to evaluate the dataset against."}),C=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsLabel",{defaultMessage:"Agents"}),h=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsDescription",{defaultMessage:"Select the agents (RAG algorithms) to evaluate the dataset against."}),A=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelLabel",{defaultMessage:"Evaluator Model"}),E=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelDescription",{defaultMessage:"Model that performs the final evaluation."}),w=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeLabel",{defaultMessage:"Evaluation type"}),T=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeDescription",{defaultMessage:'Type of evaluation to perform, e.g. "correctness" "esql-validator", or "custom".'}),M=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptLabel",{defaultMessage:"Evaluation prompt"}),P=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptDescription",{defaultMessage:"Prompt template given `input`, `reference` and `prediction` template variables."}),z=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexLabel",{defaultMessage:"Output index"}),D=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexDescription",{defaultMessage:'Index to write results to. Must be prefixed with ".kibana-elastic-ai-assistant-".'}),F=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.showTraceOptionsLabel",{defaultMessage:"Show Trace Options (for internal use only)"}),B=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.apmUrlLabel",{defaultMessage:"APM URL"}),I=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.apmUrlDescription",{defaultMessage:'URL for the Kibana APM app. Used to link to APM traces for evaluation results. Defaults to "{defaultUrlPath}".',values:{defaultUrlPath:"${basePath}/app/apm"}}),L=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithProjectLabel",{defaultMessage:"LangSmith Project"}),R=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithProjectDescription",{defaultMessage:"LangSmith Project to write traces to."}),N=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithApiKeyLabel",{defaultMessage:"LangSmith API Key"}),_=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langSmithApiKeyDescription",{defaultMessage:"API Key for writing traces to LangSmith. Stored in Session Storage. Close tab to clear session."}),q=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorDatasetLabel",{defaultMessage:"Dataset"}),U=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetLabel",{defaultMessage:"LangSmith"}),Q=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetDescription",{defaultMessage:"Name of dataset hosted on LangSmith to evaluate."}),V=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetPlaceholder",{defaultMessage:"ESQL Query Generation"}),G=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetLabel",{defaultMessage:"Custom"}),K=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetDescription",{defaultMessage:'Custom dataset to evaluate. Array of objects with "input" and "references" properties.'}),$=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.performEvaluationTitle",{defaultMessage:"Perform evaluation..."}),W=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactDiscoverLinkText",{defaultMessage:"Discover"}),H=r.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactApmLinkText",{defaultMessage:"APM"});var Y=s(241),J=s(755),X=s(578),Z=s(577),ee=s(47),te=s(2080);const se=["elastic-assistant","perform-evaluation"],ae=["elastic-assistant","evaluation-data"],ne=[{label:"correctness"},{label:"esql-validator",disabled:!0},{label:"custom",disabled:!0}];var ie={name:"1sl5m7u",styles:"min-height:330px"},oe={name:"yz1nei",styles:"margin-top:16px"},le={name:"yz1nei",styles:"margin-top:16px"},re={name:"vc763q",styles:"min-height:300px"},ce={name:"1bs7qd7",styles:"&:hover{text-decoration:none;}"},ue={name:"yz1nei",styles:"margin-top:16px"};const de=n.a.memo((()=>{var e,t;const{actionTypeRegistry:s,basePath:de,http:pe,setTraceOptions:me,traceOptions:be}=Object(Y.b)(),{data:ge}=Object(J.a)({http:pe}),{data:je,mutate:ve,isLoading:fe}=(({http:e,toasts:t})=>Object(ee.useMutation)(se,(t=>(async({http:e,evalParams:t,signal:s})=>{try{var a,n,i,o,l,r;const c="/internal/elastic_assistant/evaluate",u={agents:null==t||null===(a=t.agents.sort())||void 0===a?void 0:a.join(","),datasetName:null==t?void 0:t.datasetName,evaluationType:null==t||null===(n=t.evaluationType.sort())||void 0===n?void 0:n.join(","),evalModel:null==t||null===(i=t.evalModel.sort())||void 0===i?void 0:i.join(","),outputIndex:null==t?void 0:t.outputIndex,models:null==t||null===(o=t.models.sort())||void 0===o?void 0:o.join(","),projectName:null==t?void 0:t.projectName,runName:null==t?void 0:t.runName};return await e.post(c,{body:JSON.stringify({dataset:JSON.parse(null!==(l=null==t?void 0:t.dataset)&&void 0!==l?l:"[]"),evalPrompt:null!==(r=null==t?void 0:t.evalPrompt)&&void 0!==r?r:""}),headers:{"Content-Type":"application/json"},query:u,signal:s,version:te.a.internal.v1})}catch(e){return e}})({http:e,evalParams:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:r.i18n.translate("xpack.elasticAssistant.evaluation.evaluationError",{defaultMessage:"Error performing evaluation..."})}))}}))({http:pe}),{data:xe}=(({http:e,toasts:t})=>Object(ee.useQuery)({queryKey:ae,queryFn:({signal:t})=>(async({http:e,signal:t})=>{try{const s="/internal/elastic_assistant/evaluate";return await e.get(s,{signal:t,version:te.a.internal.v1})}catch(e){return e}})({http:e,signal:t}),retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:r.i18n.translate("xpack.elasticAssistant.evaluation.fetchEvaluationDataError",{defaultMessage:"Error fetching evaluation data..."})}))}}))({http:pe}),ye=Object(a.useMemo)((()=>{var e;return null!==(e=null==xe?void 0:xe.agentExecutors)&&void 0!==e?e:[]}),[xe]),[Oe,Se]=Object(a.useState)(),ke=Object(a.useCallback)((e=>{Se(e.target.value)}),[Se]),[Ce,he]=Object(a.useState)(),Ae=Object(a.useCallback)((e=>{he(e.target.value)}),[he]),[Ee,we]=Object(a.useState)(".kibana-elastic-ai-assistant-evaluation-results"),Te=Object(a.useCallback)((e=>{we(e.target.value)}),[we]),[Me,Pe]=Object(a.useState)(!1),ze=Object(a.useCallback)((e=>{me({...be,apmUrl:e.target.value})}),[me,be]),De=Object(a.useCallback)((e=>{me({...be,langSmithProject:e.target.value})}),[me,be]),Fe=Object(a.useCallback)((e=>{me({...be,langSmithApiKey:e.target.value})}),[me,be]),[Be,Ie]=Object(a.useState)(!0),Le=Object(a.useMemo)((()=>Object(o.jsx)(i.EuiText,{size:"xs",css:ue},q," (",Object(o.jsx)(i.EuiLink,{color:Be?"primary":"text",onClick:()=>Ie(!0)},U)," / ",Object(o.jsx)(i.EuiLink,{color:Be?"text":"primary",onClick:()=>Ie(!1)},G),")")),[Be]),[Re,Ne]=Object(a.useState)(),_e=Object(a.useCallback)((e=>{Ne(e.target.value)}),[Ne]),[qe,Ue]=Object(a.useState)(JSON.stringify([{input:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, and really make sure you check your knowledge really well on all the functions I am asking for. check it multiple times if you need to. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema. Ensure the answers are formatted in a way which is easily copyable.\n\nWrite an ESQL query for detecting cryptomining activity on an AWS EC2 instance.",reference:'FROM metrics-apm*\n| WHERE metricset.name == ""transaction"" AND metricset.interval == ""1m""\n| EVAL bucket = AUTO_BUCKET(transaction.duration.histogram, 50, <start-date>, <end-date>)\n| STATS avg_duration = AVG(transaction.duration.histogram) BY bucket'}],null,2)),Qe=Object(a.useCallback)((e=>{Ue(e.target.value)}),[Ue]),[Ve,Ge]=Object(a.useState)([]),Ke=Object(a.useCallback)((e=>{Ge(e)}),[Ge]),$e=Object(i.euiPaletteComplementary)(null!==(e=null==ge?void 0:ge.length)&&void 0!==e?e:0),We=Object(a.useMemo)((()=>{var e;return null!==(e=null==ge?void 0:ge.map(((e,t)=>{var a;const n=null===(a=Object(X.c)(e))||void 0===a?void 0:a.apiProvider,i=null!=n?n:Object(X.a)(s.get(e.actionTypeId)),o=e.isPreconfigured?Z.m:i;return{key:e.id,label:`${e.name} (${o})`,color:$e[t]}})))&&void 0!==e?e:[]}),[s,ge,$e]),[He,Ye]=Object(a.useState)([]),Je=Object(a.useCallback)((e=>{Ye(e)}),[Ye]),Xe=Object(a.useCallback)((e=>{const t=e.trim();t&&Ye([...He,{label:t}])}),[He]),Ze=Object(a.useMemo)((()=>ye.map((e=>({label:e})))),[ye]),[et,tt]=Object(a.useState)([]),st=Object(a.useCallback)((e=>{tt(e)}),[tt]),at=Object(a.useCallback)((e=>{const t=e.trim();t&&tt([{label:t}])}),[tt]),nt=Object(a.useMemo)((()=>ne),[]),[it,ot]=Object(a.useState)([]),lt=Object(a.useCallback)((e=>{ot(e)}),[ot]),[rt,ct]=Object(a.useState)("For the below input: \n\n{{input}} \n\na prediction: \n\n{{prediction}} \n\nwas made. How's it stack up against this reference: \n\n{{reference}} \n\nReturn output in a succinct sentence ranking on a simple grading rubric focused on correctness."),ut=Object(a.useCallback)((e=>{ct(e.target.value)}),[ct]),dt=0===Ve.length||0===He.length||0===Ee.length,pt=Object(a.useCallback)((async()=>{const e={models:Ve.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),agents:He.map((e=>e.label)),dataset:Be?void 0:qe,datasetName:Be?Re:void 0,evalModel:it.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),evalPrompt:rt,evaluationType:et.map((e=>e.label)),outputIndex:Ee,projectName:Oe,runName:Ce};ve(e)}),[Re,qe,rt,Ee,ve,Oe,Ce,He,et,it,Ve,Be]),mt=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-1y%2Fd,to:now))&_a=(columns:!(evaluationId,runName,totalAgents,totalInput,totalRequests,input,reference,prediction,evaluation.value,evaluation.reasoning,connectorName,connectorName.keyword,evaluation.__run.runId,evaluation.__run.runId.keyword,evaluation.score,evaluationEnd,evaluationId.keyword,evaluationStart,input.keyword,inputExampleId,inputExampleId.keyword,evaluationDuration,prediction.keyword,predictionResponse.reason.sendToLLM,predictionResponse.status,ConnectorId,predictionResponse.value.data,predictionResponse.value.data.keyword,predictionResponse.value.status,predictionResponse.value.trace_data.trace_id,predictionResponse.value.trace_data.trace_id.keyword,predictionResponse.value.trace_data.transaction_id,predictionResponse.value.trace_data.transaction_id.keyword,reference.keyword,runName.keyword),filters:!(),grid:(columns:('@timestamp':(width:212),ConnectorId:(width:133),connectorName:(width:181),connectorName.keyword:(width:229),evaluation.__run.runId:(width:282),evaluation.__run.runId.keyword:(width:245),evaluation.reasoning:(width:336),evaluation.reasoning.keyword:(width:232),evaluation.score:(width:209),evaluation.value:(width:156),evaluationDuration:(width:174),evaluationEnd:(width:151),evaluationId:(width:130),evaluationId.keyword:(width:186),evaluationStart:(width:202),input:(width:347),input.keyword:(width:458),prediction:(width:264),prediction.keyword:(width:313),predictionResponse.value.connector_id:(width:294),predictionResponse.value.trace_data.trace_id:(width:278),predictionResponse.value.trace_data.transaction_id.keyword:(width:177),reference:(width:305),reference.keyword:(width:219),runName:(width:405),totalAgents:(width:125),totalInput:(width:111),totalRequests:(width:138))),hideChart:!t,index:ce1b41cb-6298-4612-a33c-ba85b3c18ec7,interval:auto,query:(esql:'from%20.kibana-elastic-ai-assistant-evaluation-results%20%0A%7C%20keep%20@timestamp,%20evaluationId,%20runName,%20totalAgents,%20totalInput,%20totalRequests,%20input,%20reference,%20prediction,%20evaluation.value,%20evaluation.reasoning,%20connectorName,%20*%0A%7C%20drop%20evaluation.reasoning.keyword%0A%7C%20rename%20predictionResponse.value.connector_id%20as%20ConnectorId%0A%7C%20where%20evaluationId%20%3D%3D%20%22${t}%22%0A%7C%20sort%20@timestamp%20desc%0A%7C%20limit%20100%0A%0A%0A'),rowHeight:15,sort:!(!('@timestamp',desc)))`)(de,null!==(e=null==je?void 0:je.evaluationId)&&void 0!==e?e:"")}),[de,je]),bt=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/apm/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=%22labels.evaluationId%22:%20%22${t}%22&rangeFrom=now-1y&rangeTo=now&showCriticalPath=false&traceId=451662121b1f5e6c44084ad7415b9409&transactionId=5f1392fa04766025&type=kql&waterfallItemId=`)(de,null!==(e=null==je?void 0:je.evaluationId)&&void 0!==e?e:"")}),[de,je]),gt=(e,t)=>Object(o.jsx)("div",null,Object(o.jsx)(i.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(o.jsx)(i.EuiFlexItem,null,Object(o.jsx)(i.EuiTitle,{size:"xs"},Object(o.jsx)("h3",null,e)))),Object(o.jsx)(i.EuiText,{size:"s"},Object(o.jsx)("p",null,Object(o.jsx)(i.EuiTextColor,{color:"subdued"},t)))),jt=Object(a.useMemo)((()=>gt(u,d)),[]),vt=Object(a.useMemo)((()=>gt(p,m)),[]),ft=Object(a.useMemo)((()=>gt(b,g)),[]),xt=ce;return Object(o.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(o.jsx)(i.EuiText,{size:"m"},c),Object(o.jsx)(i.EuiHorizontalRule,{margin:"s"}),Object(o.jsx)(i.EuiAccordion,{id:u,arrowDisplay:"right",buttonContent:jt,buttonProps:{paddingSize:"s",css:xt},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(o.jsx)(i.EuiFlexGroup,null,Object(o.jsx)(i.EuiFlexItem,null,Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:j,helpText:v},Object(o.jsx)(i.EuiFieldText,{"aria-label":"project-textfield",compressed:!0,onChange:ke,placeholder:f,value:Oe}))),Object(o.jsx)(i.EuiFlexItem,null,Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:x,helpText:y},Object(o.jsx)(i.EuiFieldText,{"aria-label":"run-name-textfield",compressed:!0,onChange:Ae,placeholder:O,value:Ce})))),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:Le,fullWidth:!0,helpText:Be?Q:K},Be?Object(o.jsx)(i.EuiFieldText,{"aria-label":"dataset-name-textfield",compressed:!0,onChange:_e,placeholder:V,value:Re}):Object(o.jsx)(i.EuiTextArea,{"aria-label":"evaluation-dataset-textarea",compressed:!0,css:re,fullWidth:!0,onChange:Qe,value:qe})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:z,fullWidth:!0,helpText:D},Object(o.jsx)(i.EuiFieldText,{value:Ee,onChange:Te,"aria-label":"evaluation-output-index-textfield"})),Object(o.jsx)(i.EuiText,{size:"xs",css:le},Object(o.jsx)(i.EuiLink,{color:"primary",onClick:()=>Pe(!Me)},F)),Me&&Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:B,fullWidth:!0,helpText:I,css:oe},Object(o.jsx)(i.EuiFieldText,{value:be.apmUrl,onChange:ze,"aria-label":"apm-url-textfield"})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:L,fullWidth:!0,helpText:R},Object(o.jsx)(i.EuiFieldText,{value:be.langSmithProject,onChange:De,"aria-label":"langsmith-project-textfield"})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:N,fullWidth:!0,helpText:_},Object(o.jsx)(i.EuiFieldText,{value:be.langSmithApiKey,onChange:Fe,"aria-label":"langsmith-api-key-textfield"})))),Object(o.jsx)(i.EuiHorizontalRule,{margin:"s"}),Object(o.jsx)(i.EuiAccordion,{id:p,arrowDisplay:"right",buttonContent:vt,buttonProps:{paddingSize:"s",css:xt},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:S,helpText:k},Object(o.jsx)(i.EuiComboBox,{"aria-label":"model-selector",compressed:!0,options:We,selectedOptions:Ve,onChange:Ke})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:C,helpText:h},Object(o.jsx)(i.EuiComboBox,{"aria-label":"agent-selector",compressed:!0,onCreateOption:Xe,options:Ze,selectedOptions:He,onChange:Je}))),Object(o.jsx)(i.EuiHorizontalRule,{margin:"s"}),Object(o.jsx)(i.EuiAccordion,{id:b,arrowDisplay:"right",element:"fieldset",buttonProps:{paddingSize:"s",css:xt},buttonContent:ft,paddingSize:"s"},Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:A,helpText:E},Object(o.jsx)(i.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,options:We,selectedOptions:it,singleSelection:{asPlainText:!0},onChange:lt})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:w,helpText:T},Object(o.jsx)(i.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,onChange:st,onCreateOption:at,options:nt,selectedOptions:et,singleSelection:{asPlainText:!0}})),Object(o.jsx)(i.EuiFormRow,{display:"rowCompressed",label:M,fullWidth:!0,helpText:P},Object(o.jsx)(i.EuiTextArea,{"aria-label":"evaluation-prompt-textarea",compressed:!0,css:ie,disabled:"custom"!==(null===(t=et[0])||void 0===t?void 0:t.label),fullWidth:!0,onChange:ut,value:rt}))),Object(o.jsx)(i.EuiHorizontalRule,null),Object(o.jsx)(i.EuiFlexGroup,{alignItems:"center"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButton,{size:"s",type:"submit",isDisabled:dt,isLoading:fe,onClick:pt,fill:!0},$)),Object(o.jsx)(i.EuiFlexItem,null,Object(o.jsx)(i.EuiText,{color:"subdued",size:"xs"},Object(o.jsx)(l.FormattedMessage,{defaultMessage:"Closing this dialog will cancel the evaluation. You can watch the Kibana server logs for progress, and view results in {discover} {apm}. Can take many minutes for large datasets.",id:"xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactText",values:{discover:Object(o.jsx)(i.EuiLink,{external:!0,href:mt,target:"_blank"},W),apm:Object(o.jsx)(i.EuiLink,{external:!0,href:bt,target:"_blank"},H)}})))),Object(o.jsx)(i.EuiSpacer,{size:"s"}))}));de.displayName="EvaluationSettings"},2114:function(e,t,s){"use strict";s.r(t),s.d(t,"ManagementSettings",(function(){return Ze}));var a=s(2),n=s.n(a),i=s(19),o=s(43),l=s(919),r=s(241),c=s(755),u=s(1340),d=s(4);const p=d.i18n.translate("xpack.elasticAssistant.connectors.connectorSettingsManagement.title",{defaultMessage:"Settings"}),m=d.i18n.translate("xpack.elasticAssistant.connectors.connectorSettingsManagement.description",{defaultMessage:"To use Elastic AI Assistant, you must set up a connector to an external large language model."}),b=d.i18n.translate("xpack.elasticAssistant.connectors.connectorSettingsManagement.buttonTitle",{defaultMessage:"Manage Connectors"});var g={name:"qbt5ty",styles:"align-self:center"};const j=()=>{const{navigateToApp:e}=Object(r.b)(),t=Object(a.useCallback)((()=>e("management",{path:"insightsAndAlerting/triggersActionsConnectors/connectors"})),[e]);return Object(o.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(o.jsx)(i.EuiTitle,{size:"xs"},Object(o.jsx)("h2",null,p)),Object(o.jsx)(i.EuiSpacer,{size:"m"}),Object(o.jsx)(i.EuiFlexGroup,null,Object(o.jsx)(i.EuiFlexItem,{css:g},Object(o.jsx)(i.EuiText,{size:"m"},m)),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButton,{onClick:t},b))))},v=n.a.memo(j);j.displayName="ConnectorsSettingsManagementComponent";var f=s(42),x=s(578),y=s(756);const O=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.title",{defaultMessage:"Settings"}),S=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.list.title",{defaultMessage:"Conversation list"}),k=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.list.description",{defaultMessage:"Create and manage conversations with the Elastic AI Assistant."}),C=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.column.Title",{defaultMessage:"Title"}),h=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.column.systemPrompt",{defaultMessage:"System prompt"}),A=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.column.connector",{defaultMessage:"Connector"}),E=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.column.updatedAt",{defaultMessage:"Date updated"}),w=(d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.column.actions",{defaultMessage:"Actions"}),d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.flyout.defaultTitle",{defaultMessage:"Conversation"})),T=d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.deleteConfirmation.defaultTitle",{defaultMessage:"Delete conversation?"}),M=d.i18n.translate("xpack.elasticAssistant.assistant.settings.editButtonTitle",{defaultMessage:"Edit"}),P=d.i18n.translate("xpack.elasticAssistant.assistant.settings.deleteButtonTitle",{defaultMessage:"Delete"}),z=d.i18n.translate("xpack.elasticAssistant.assistant.settings.actionsButtonTitle",{defaultMessage:"Actions"}),D=()=>Object(a.useCallback)((({disabled:e=!1,onDelete:t,onEdit:s})=>({name:z,actions:[{name:M,description:M,icon:"pencil",type:"icon",onClick:e=>{(e=>{null==s||s(e)})(e)},enabled:()=>!e,available:()=>null!=s},{name:P,description:P,icon:"trash",type:"icon",onClick:e=>{(e=>{null==t||t(e)})(e)},enabled:({isDefault:t})=>!t&&!e,available:()=>null!=t,color:"danger"}]})),[]),F={};var B=s(1384);const I=({assistantStreamingEnabled:e,compressed:t,setAssistantStreamingEnabled:s})=>{const{euiTheme:a}=Object(i.useEuiTheme)();return Object(o.jsx)(i.EuiFormRow,{fullWidth:!0,display:"rowCompressed",label:Object(o.jsx)(i.EuiText,{size:"xs",css:t?void 0:Object(o.css)("padding:",a.size.m," 0;font-weight:",a.font.weight.bold,";line-height:",a.size.m,";","")},B.i)},Object(o.jsx)(i.EuiSwitch,{label:Object(o.jsx)(i.EuiText,{size:t?"xs":"s"},B.h),checked:e,onChange:e=>s(e.target.checked),compressed:t}))},L=n.a.memo(I);L.displayName="ConversationStreamingSwitch";var R=s(1539),N=s(1867),_=s(1546);const q=()=>{const[e,t]=Object(a.useState)(!1),s=()=>{t(!0)},n=()=>{t(!1)};return Object(a.useMemo)((()=>({isFlyoutOpen:e,openFlyout:s,closeFlyout:n})),[e])},U=d.i18n.translate("xpack.elasticAssistant.assistant.settings.flyout.saveButtonTitle",{defaultMessage:"Save"}),Q=d.i18n.translate("xpack.elasticAssistant.assistant.settings.flyout.cancelButtonTitle",{defaultMessage:"Cancel"});var V={name:"zhah29",styles:"max-width:656px"};const G=({title:e,flyoutVisible:t,children:s,onClose:a,onSaveCancelled:n,onSaveConfirmed:l,saveButtonDisabled:r=!1})=>t?Object(o.jsx)(i.EuiFlyout,{ownFocus:!0,onClose:a,css:V},Object(o.jsx)(i.EuiFlyoutHeader,null,Object(o.jsx)(i.EuiTitle,{size:"s"},Object(o.jsx)("h2",null,e))),Object(o.jsx)(i.EuiFlyoutBody,null,s),Object(o.jsx)(i.EuiFlyoutFooter,null,Object(o.jsx)(i.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"s"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButtonEmpty,{size:"m",color:"text",iconType:"cross","data-test-subj":"cancel-button",onClick:n},Q)),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButton,{size:"m",type:"submit","data-test-subj":"save-button",onClick:l,iconType:"check",disabled:r,fill:!0},U))))):null,K=n.a.memo(G);var $=s(1616),W=s(1545),H=s(1215),Y=s(1345),J=s(821),X=s(1289);const Z=n.a.memo((({hasPendingChanges:e,onCancelClick:t,onSaveButtonClicked:s})=>e?Object(o.jsx)(i.EuiPageTemplate.BottomBar,{paddingSize:"s",position:"fixed","data-test-subj":"bottom-bar"},Object(o.jsx)(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButtonEmpty,{size:"s",color:"text",iconType:"cross","data-test-subj":"cancel-button",onClick:t},l.b)),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButton,{size:"s",type:"submit","data-test-subj":"save-button",onClick:s,iconType:"check",fill:!0},l.i)))):null));Z.displayName="AssistantSettingsBottomBar";const ee={page:{size:J.d,index:0},sort:{field:"createdAt",direction:"desc"}},te=({connectors:e,defaultConnector:t,defaultSelectedConversation:s,isDisabled:c})=>{var p,m;const{actionTypeRegistry:b,assistantAvailability:{isAssistantEnabled:g},baseConversations:j,http:v,nameSpace:M,toasts:P}=Object(r.b)(),z=Object(a.useCallback)((e=>Object(u.e)(j,e)),[j]),{data:B,isFetched:I,refetch:U}=Object(R.b)(),{data:Q,isFetched:V,refetch:G}=Object(N.b)({http:v,onFetch:z,isAssistantEnabled:g}),J=Object(a.useCallback)((()=>{U(),G()}),[U,G]),{systemPromptSettings:te,assistantStreamingEnabled:se,conversationSettings:ae,conversationsSettingsBulkActions:ne,resetSettings:ie,saveSettings:oe,setConversationSettings:le,setConversationsSettingsBulkActions:re,setUpdatedAssistantStreamingEnabled:ce}=Object(X.d)(Q,B,V,I),[ue,de]=Object(a.useState)(!1),pe=Object(a.useCallback)((async e=>{var t;await oe()?(null==P||P.addSuccess({iconType:"check",title:l.m}),de(!1),null==e||null===(t=e.callback)||void 0===t||t.call(e)):ie()}),[ie,oe,P]),me=Object(a.useCallback)((e=>{de(!0),ce(e)}),[ce]),be=Object(a.useCallback)((()=>{pe({callback:J})}),[pe,J]),ge=Object(a.useCallback)((()=>{ie(),de(!1)}),[ie]),[je,ve]=Object(a.useState)((()=>ae[s.title])),fe=Object(a.useCallback)((e=>{ve(e)}),[]);Object(a.useEffect)((()=>{if(null!=je){const e=ae[je.id]||ae[je.title];ve(e)}}),[ae,je]);const{isFlyoutOpen:xe,openFlyout:ye,closeFlyout:Oe}=q(),[Se,ke]=Object(a.useState)(),{isFlyoutOpen:Ce,openFlyout:he,closeFlyout:Ae}=q(),Ee=Object(W.a)({allSystemPrompts:te,conversationSettings:ae,conversationsSettingsBulkActions:ne,defaultConnector:t,setConversationSettings:le,setConversationsSettingsBulkActions:re,onSelectedConversationChange:fe}),we=Object(a.useCallback)((e=>{ye(),Ee(e)}),[Ee,ye]),Te=Object(_.a)({conversationSettings:ae,conversationsSettingsBulkActions:ne,setConversationSettings:le,setConversationsSettingsBulkActions:re}),Me=Object(a.useCallback)((e=>{ke(e),Te(e.title),Oe(),he()}),[Oe,Te,he]),Pe=Object(a.useCallback)((()=>{0!==Object.keys(ne).length&&(Ae(),pe({callback:J}),re({}))}),[Ae,ne,pe,J,re]),ze=Object(a.useCallback)((()=>{ke(null),Ae(),ge()}),[Ae,ge]),{getConversationsList:De,getColumns:Fe}=(()=>{const e=D();return{getColumns:Object(a.useCallback)((({onDeleteActionClicked:t,onEditActionClicked:s})=>[{name:C,render:e=>Object(o.jsx)(i.EuiLink,{onClick:()=>s(e)},e.title),sortable:({title:e})=>e},{field:"systemPromptTitle",name:h,align:"left",render:e=>e?Object(o.jsx)(i.EuiBadge,{color:"hollow"},e):null,sortable:!0},{field:"connectorTypeTitle",name:A,align:"left",render:e=>e?Object(o.jsx)(i.EuiBadge,{color:"hollow"},e):null,sortable:!0},{field:"updatedAt",name:E,align:"center",render:e=>e?Object(o.jsx)(i.EuiBadge,{color:"hollow"},Object(o.jsx)(f.FormattedDate,{value:new Date(e),year:"numeric",month:"2-digit",day:"numeric"})):null,sortable:!0},{width:"120px",align:"center",...e({onDelete:t,onEdit:s})}]),[e]),getConversationsList:Object(a.useCallback)((({allSystemPrompts:e,actionTypeRegistry:t,connectors:s,conversations:a=F,defaultConnector:n})=>Object.values(a).map((a=>{const i=Object(y.b)({allSystemPrompts:e,connectors:s,conversation:a,defaultConnector:n}),o=null==s?void 0:s.find((e=>{var t;return e.id===(null===(t=i.apiConfig)||void 0===t?void 0:t.connectorId)})),l=Object(x.b)(o,t),r=e.find((({id:e})=>{var t;return e===(null===(t=a.apiConfig)||void 0===t?void 0:t.defaultSystemPromptId)})),c=(null==r?void 0:r.name)||(null==r?void 0:r.id);return{...a,connectorTypeTitle:l,systemPromptTitle:c,...i}}))),[])}})(),{onTableChange:Be,pagination:Ie,sorting:Le}=Object(Y.b)({nameSpace:M,storageKey:H.c,defaultTableOptions:ee}),Re=De({allSystemPrompts:te,actionTypeRegistry:b,connectors:e,conversations:ae,defaultConnector:t}),Ne=Object(a.useCallback)((()=>{Oe(),ge()}),[Oe,ge]),_e=Object(a.useCallback)((()=>{Oe(),pe({callback:J}),re({})}),[Oe,pe,J,re]),qe=Object(a.useMemo)((()=>Fe({conversations:ae,onDeleteActionClicked:Me,onEditActionClicked:we})),[ae,Fe,Me,we]),Ue=Object(a.useMemo)((()=>{return null!=Se&&Se.title?(e=null==Se?void 0:Se.title,d.i18n.translate("xpack.elasticAssistant.assistant.conversationSettings.deleteConfirmation.Title",{values:{conversationTitle:e},defaultMessage:'Delete "{conversationTitle}"?'})):T;var e}),[null==Se?void 0:Se.title]);return V?Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(o.jsx)(i.EuiTitle,{size:"xs"},Object(o.jsx)("h2",null,O)),Object(o.jsx)(L,{assistantStreamingEnabled:se,setAssistantStreamingEnabled:me,compressed:!1}),Object(o.jsx)(i.EuiSpacer,{size:"l"}),Object(o.jsx)(i.EuiTitle,{size:"xs"},Object(o.jsx)("h2",null,S)),Object(o.jsx)(i.EuiSpacer,{size:"xs"}),Object(o.jsx)(i.EuiText,{size:"m"},k),Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(i.EuiInMemoryTable,{items:Re,columns:qe,pagination:Ie,sorting:Le,onTableChange:Be})),xe&&Object(o.jsx)(K,{flyoutVisible:xe,onClose:Ne,onSaveConfirmed:_e,onSaveCancelled:Ne,title:null!==(p=null==je?void 0:je.title)&&void 0!==p?p:w,saveButtonDisabled:null==(null==je?void 0:je.title)||""===(null==je?void 0:je.title)},Object(o.jsx)($.a,{allSystemPrompts:te,conversationSettings:ae,conversationsSettingsBulkActions:ne,http:v,isDisabled:c,refetchConversations:G,selectedConversation:je,setConversationSettings:le,setConversationsSettingsBulkActions:re,onSelectedConversationChange:fe})),Ce&&(null==Se?void 0:Se.title)&&Object(o.jsx)(i.EuiConfirmModal,{"aria-labelledby":Ue,title:Ue,titleProps:{id:null!==(m=null==Se?void 0:Se.id)&&void 0!==m?m:void 0},onCancel:ze,onConfirm:Pe,cancelButtonText:l.b,confirmButtonText:l.e,buttonColor:"danger",defaultFocusedButton:"confirm"},Object(o.jsx)("p",null)),Object(o.jsx)(Z,{hasPendingChanges:ue,onCancelClick:ge,onSaveButtonClicked:be})):null},se=n.a.memo(te);se.displayName="ConversationSettingsManagement";var ae=s(1611);const ne=d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.quickPromptsTableColumnName",{defaultMessage:"Name"}),ie=d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.quickPromptsTableColumnDateUpdated",{defaultMessage:"Date updated"}),oe=(d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.quickPromptsTableColumnActions",{defaultMessage:"Actions"}),d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.description",{defaultMessage:"Create and manage Quick Prompts. Quick Prompts are shortcuts to common actions."})),le=d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.createButtonTitle",{defaultMessage:"Quick Prompt"}),re=d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptEditFlyout.title",{defaultMessage:"Quick Prompt"}),ce=d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.quickPromptsTableColumnContexts",{defaultMessage:"Contexts"}),ue=d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.modal.deleteQuickPromptConfirmationDefaultTitle",{defaultMessage:"Delete quick prompt?"}),de=d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.modal.deleteQuickPromptConfirmationMessage",{defaultMessage:"You cannot recover the prompt once deleted"});var pe=s(1458);const me=n.a.memo((({items:e,prefix:t})=>e&&e.length>0?Object(o.jsx)("div",null,e.map(((e,s)=>Object(o.jsx)(i.EuiBadge,{key:`${t}-${s}`,color:"hollow"},e)))):null));me.displayName="BadgesColumn";const be=()=>{const{nameSpace:e,basePromptContexts:t,toasts:s}=Object(r.b)(),{data:c,isFetched:u,refetch:p}=Object(R.b)(),{promptsBulkActions:m,quickPromptSettings:b,resetSettings:g,saveSettings:j,setPromptsBulkActions:v,setUpdatedQuickPromptSettings:x}=Object(X.d)(X.b,c,!1,u),[y,O]=Object(a.useState)(),S=Object(a.useCallback)((e=>{O(e)}),[]);Object(a.useEffect)((()=>{null!=y&&O(b.find((e=>e.name===y.name)))}),[b,y]);const k=Object(a.useCallback)((async e=>{var t;await j(),null==s||s.addSuccess({iconType:"check",title:l.m}),null==e||null===(t=e.callback)||void 0===t||t.call(e)}),[j,s]),C=Object(a.useCallback)((()=>{g()}),[g]),{isFlyoutOpen:h,openFlyout:A,closeFlyout:E}=q(),[w,T]=Object(a.useState)(),{isFlyoutOpen:M,openFlyout:P,closeFlyout:z}=q(),{onQuickPromptDeleted:F,onQuickPromptSelectionChange:B}=Object(pe.a)({onSelectedQuickPromptChange:S,setUpdatedQuickPromptSettings:x,promptsBulkActions:m,setPromptsBulkActions:v}),I=Object(a.useCallback)((e=>{B(e),A()}),[B,A]),L=Object(a.useCallback)((e=>{T(e),F(e.id),P()}),[F,P]),N=Object(a.useCallback)((()=>{T(null),z(),C()}),[z,C]),_=Object(a.useCallback)((()=>{k({callback:p}),z()}),[z,k,p]),U=Object(a.useCallback)((()=>{S(),A()}),[S,A]),Q=Object(a.useCallback)((()=>{S(),E(),C()}),[E,S,C]),V=Object(a.useCallback)((()=>{k({callback:p}),S(),E()}),[E,k,S,p]),{getColumns:G}=(()=>{const e=D();return{getColumns:Object(a.useCallback)((({isActionsDisabled:t,basePromptContexts:s,onEditActionClicked:a,onDeleteActionClicked:n})=>[{align:"left",name:ne,render:e=>null!=e&&e.name?Object(o.jsx)(i.EuiLink,{onClick:()=>a(e),disabled:t},null==e?void 0:e.name):null,sortable:({name:e})=>e},{align:"left",name:ce,render:e=>{var t;const a=(null!==(t=s.filter((t=>{var s;return null==e||null===(s=e.categories)||void 0===s?void 0:s.some((e=>(null==t?void 0:t.category)===e))})))&&void 0!==t?t:[]).map((e=>null==e?void 0:e.description));return a?Object(o.jsx)(me,{items:a,prefix:e.name}):null}},{align:"left",field:"updatedAt",name:ie,render:e=>e?Object(o.jsx)(i.EuiBadge,{color:"hollow"},Object(o.jsx)(f.FormattedDate,{value:new Date(e),year:"numeric",month:"2-digit",day:"numeric"})):null,sortable:!0},{align:"center",width:"120px",...e({onDelete:n,onEdit:a})}]),[e])}})(),$=G({isActionsDisabled:!u,basePromptContexts:t,onEditActionClicked:I,onDeleteActionClicked:L}),{onTableChange:W,pagination:J,sorting:Z}=Object(Y.b)({defaultTableOptions:Y.a,nameSpace:e,storageKey:H.h}),ee=Object(a.useMemo)((()=>{return null!=w&&w.name?(e=w.name,d.i18n.translate("xpack.elasticAssistant.assistant.quickPromptsTable.modal.deleteQuickPromptConfirmationTitle",{values:{prompt:e},defaultMessage:'Delete "{prompt}"?'})):ue;var e}),[null==w?void 0:w.name]);return Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(o.jsx)(i.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiText,{size:"m"},oe)),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButton,{iconType:"plusInCircle",onClick:U,disabled:!u},le))),Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(i.EuiInMemoryTable,{columns:$,items:b,onTableChange:W,pagination:J,sorting:Z})),Object(o.jsx)(K,{flyoutVisible:h,title:re,onClose:Q,onSaveCancelled:Q,onSaveConfirmed:V,saveButtonDisabled:null==(null==y?void 0:y.name)||""===(null==y?void 0:y.name)},Object(o.jsx)(ae.a,{onSelectedQuickPromptChange:S,quickPromptSettings:b,resetSettings:g,selectedQuickPrompt:y,setUpdatedQuickPromptSettings:x,promptsBulkActions:m,setPromptsBulkActions:v})),M&&w&&Object(o.jsx)(i.EuiConfirmModal,{"aria-labelledby":ee,title:ee,onCancel:N,onConfirm:_,cancelButtonText:l.b,confirmButtonText:l.e,buttonColor:"danger",defaultFocusedButton:"confirm"},Object(o.jsx)("p",null,de)))};var ge=s(1612),je=s(920),ve=s(1460);const fe=d.i18n.translate("xpack.elasticAssistant.assistant.promptsTable.systemPromptsTableColumnName",{defaultMessage:"Name"}),xe=d.i18n.translate("xpack.elasticAssistant.assistant.promptsTable.systemPromptsTableColumnDefaultConversations",{defaultMessage:"Default conversations"}),ye=d.i18n.translate("xpack.elasticAssistant.assistant.promptsTable.systemPromptsTableColumnDateUpdated",{defaultMessage:"Date updated"}),Oe=(d.i18n.translate("xpack.elasticAssistant.assistant.promptsTable.systemPromptsTableColumnActions",{defaultMessage:"Actions"}),d.i18n.translate("xpack.elasticAssistant.assistant.promptsTable.settingsDescription",{defaultMessage:"Create and manage System Prompts. System Prompts are configurable chunks of context that are always sent as part of the conversation."})),Se=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.modal.deleteSystemPromptConfirmationDefaultTitle",{defaultMessage:"Delete system prompt?"}),ke=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.modal.deleteSystemPromptConfirmationMessage",{defaultMessage:"You cannot recover the prompt once deleted"}),Ce=d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.createSystemPromptLabel",{defaultMessage:"System Prompt"});var he=s(1459);const Ae=({connectors:e,defaultConnector:t})=>{var s;const{nameSpace:c,http:p,assistantAvailability:{isAssistantEnabled:m},baseConversations:b,toasts:g}=Object(r.b)(),j=Object(a.useCallback)((e=>Object(u.e)(b,e)),[b]),{data:v,refetch:x,isFetched:O}=Object(R.b)(),{data:S,isFetched:k,refetch:C}=Object(N.b)({http:p,onFetch:j,isAssistantEnabled:m}),h=Object(a.useCallback)((()=>{x(),C()}),[x,C]),A=!k||!O,{isFlyoutOpen:E,openFlyout:w,closeFlyout:T}=q(),{isFlyoutOpen:M,openFlyout:P,closeFlyout:z}=q(),[F,B]=Object(a.useState)(),{conversationSettings:I,setConversationSettings:L,systemPromptSettings:_,setUpdatedSystemPromptSettings:U,conversationsSettingsBulkActions:Q,setConversationsSettingsBulkActions:V,resetSettings:G,saveSettings:$,promptsBulkActions:W,setPromptsBulkActions:J}=Object(X.d)(S,v,k,O),[Z,ee]=Object(a.useState)(),te=Object(a.useCallback)((e=>{ee(e)}),[]);Object(a.useEffect)((()=>{null!=Z&&ee(_.find((e=>e.id===Z.id)))}),[Z,_]);const se=Object(a.useCallback)((async e=>{var t;await $(),null==g||g.addSuccess({iconType:"check",title:l.m}),null==e||null===(t=e.callback)||void 0===t||t.call(e)}),[$,g]),ae=Object(a.useCallback)((()=>{G()}),[G]),ne=Object(a.useCallback)((()=>{te({id:"",content:"",name:"",promptType:"system"}),w()}),[te,w]),{onSystemPromptSelectionChange:ie,onSystemPromptDeleted:oe}=Object(ve.a)({setUpdatedSystemPromptSettings:U,onSelectedSystemPromptChange:te,promptsBulkActions:W,setPromptsBulkActions:J}),le=Object(a.useCallback)((e=>{ie(e),w()}),[ie,w]),re=Object(a.useCallback)((e=>{B(e),oe(e.id),P()}),[oe,P]),ce=Object(a.useCallback)((()=>{B(null),z(),ae()}),[z,ae]),ue=Object(a.useCallback)((()=>{z(),se({callback:h}),V({})}),[z,se,h,V]),de=Object(a.useCallback)((()=>{T(),ae()}),[T,ae]),pe=Object(a.useCallback)((()=>{T(),se({callback:h}),V({})}),[T,se,h,V]),be=Object(a.useMemo)((()=>{return null!=F&&F.name?(e=null==F?void 0:F.name,d.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.modal.deleteSystemPromptConfirmationTitle",{values:{prompt:e},defaultMessage:'Delete "{prompt}"?'})):Se;var e}),[null==F?void 0:F.name]),{getColumns:Ae,getSystemPromptsList:Ee}=(()=>{const e=D();return{getColumns:Object(a.useCallback)((({isActionsDisabled:t,onEditActionClicked:s,onDeleteActionClicked:a})=>[{align:"left",name:fe,truncateText:{lines:3},render:e=>null!=e&&e.name?Object(o.jsx)(i.EuiLink,{onClick:()=>s(e),disabled:t},null==e?void 0:e.name,e.isNewConversationDefault&&Object(o.jsx)(i.EuiIcon,{type:"starFilled","aria-label":je.e,className:"eui-alignTop"})):null,sortable:({name:e})=>e},{align:"left",name:xe,render:({defaultConversations:e,id:t})=>Object(o.jsx)(me,{items:e,prefix:t})},{align:"left",field:"updatedAt",name:ye,render:e=>e?Object(o.jsx)(i.EuiBadge,{color:"hollow"},Object(o.jsx)(f.FormattedDate,{value:new Date(e),year:"numeric",month:"2-digit",day:"numeric"})):null,sortable:!0},{align:"center",width:"120px",...e({onDelete:a,onEdit:s})}]),[e]),getSystemPromptsList:({connectors:e,conversationSettings:t,defaultConnector:s,systemPromptSettings:a})=>{const n=Object.entries(t).reduce(((t,[n,i])=>(t[n]={...i,...Object(y.b)({allSystemPrompts:a,connectors:e,conversation:i,defaultConnector:s})},t)),{});return a.map((e=>{const t=Object(he.a)(n,null==e?void 0:e.id).map((({title:e})=>e));return{...e,defaultConversations:t}}))}}})(),{onTableChange:we,pagination:Te,sorting:Me}=Object(Y.b)({defaultTableOptions:Y.a,nameSpace:c,storageKey:H.j}),Pe=Object(a.useMemo)((()=>Ae({isActionsDisabled:A,onEditActionClicked:le,onDeleteActionClicked:re})),[Ae,A,le,re]),ze=Object(a.useMemo)((()=>Ee({connectors:e,conversationSettings:I,defaultConnector:t,systemPromptSettings:_})),[Ee,e,I,t,_]);return Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(o.jsx)(i.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiText,{size:"m"},Oe)),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButton,{iconType:"plusInCircle",onClick:ne,disabled:A},Ce))),Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(i.EuiInMemoryTable,{columns:Pe,items:ze,onTableChange:we,pagination:Te,sorting:Me})),Object(o.jsx)(K,{flyoutVisible:E,title:je.b,onClose:de,onSaveCancelled:de,onSaveConfirmed:pe,saveButtonDisabled:null==(null==Z?void 0:Z.name)||""===(null==Z?void 0:Z.name)},Object(o.jsx)(ge.a,{connectors:e,conversationSettings:I,onSelectedSystemPromptChange:te,selectedSystemPrompt:Z,setUpdatedSystemPromptSettings:U,setConversationSettings:L,systemPromptSettings:_,conversationsSettingsBulkActions:Q,setConversationsSettingsBulkActions:V,defaultConnector:t,resetSettings:G,promptsBulkActions:W,setPromptsBulkActions:J})),M&&(null==F?void 0:F.name)&&Object(o.jsx)(i.EuiConfirmModal,{"aria-labelledby":be,title:be,titleProps:{id:null!==(s=null==F?void 0:F.id)&&void 0!==s?s:void 0},onCancel:ce,onConfirm:ue,cancelButtonText:l.b,confirmButtonText:l.e,buttonColor:"danger",defaultFocusedButton:"confirm"},Object(o.jsx)("p",null,ke)))},Ee=n.a.memo(Ae);var we=s(49),Te=s(1486),Me=s(1485),Pe=s(1461),ze=s(1547),De=s(1287);const Fe=({defaultPageSize:e=5})=>{const{toasts:t}=Object(r.b)(),{data:s}=Object(De.a)(),[c,u]=Object(a.useState)(!1),{anonymizationFieldsBulkActions:d,setAnonymizationFieldsBulkActions:p,setUpdatedAnonymizationData:m,resetSettings:b,saveSettings:g,updatedAnonymizationData:j}=Object(X.d)(X.b,X.c,!1,!1,null!=s?s:X.a),v=Object(a.useCallback)((()=>{b(),u(!1)}),[b]),f=Object(a.useCallback)((async e=>{var s;await g(),null==t||t.addSuccess({iconType:"check",title:l.m}),u(!1),null==e||null===(s=e.callback)||void 0===s||s.call(e)}),[g,t]),x=Object(a.useCallback)((()=>{f()}),[f]),y=Object(a.useCallback)((e=>{u(!0),p(e)}),[p]),O=Object(a.useCallback)((e=>{u(!0),m(e)}),[m]),S=Object(ze.a)({anonymizationFields:j,anonymizationFieldsBulkActions:d,setAnonymizationFieldsBulkActions:y,setUpdatedAnonymizationData:O});return Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(o.jsx)(i.EuiText,{size:"m"},Pe.a),Object(o.jsx)(i.EuiSpacer,{size:"m"}),Object(o.jsx)(i.EuiFlexGroup,{alignItems:"center","data-test-subj":"summary",gutterSize:"none"},Object(o.jsx)(Te.a,{isDataAnonymizable:!0,anonymizationFields:j.data,titleSize:"m",gap:we.euiThemeVars.euiSizeS})),Object(o.jsx)(i.EuiSpacer,{size:"m"}),Object(o.jsx)(Me.a,{anonymizationFields:j,compressed:!1,onListUpdated:S,rawData:null,pageSize:e})),Object(o.jsx)(Z,{hasPendingChanges:c,onCancelClick:v,onSaveButtonClicked:x}))};Fe.displayName="AnonymizationSettingsManagementComponent";const Be=n.a.memo(Fe);var Ie=s(1548),Le=s(1291),Re=s(1344),Ne=s(1455);const _e="esql";var qe={name:"1tyyxc3",styles:"padding-left:20px"},Ue={name:"1tyyxc3",styles:"padding-left:20px"},Qe={name:"1tyyxc3",styles:"padding-left:20px"},Ve={name:"nvudtm",styles:"padding-left:5px"},Ge={name:"1xr0ypo",styles:".euiFormRow__labelWrapper{min-width:95px!important;}"};const Ke=n.a.memo((()=>{var e,t,s,c,u;const{http:d,toasts:p}=Object(r.b)(),[m,b]=Object(a.useState)(!1),{knowledgeBase:g,setUpdatedKnowledgeBaseSettings:j,resetSettings:v,saveSettings:x}=Object(X.d)(X.b,X.c,!1,!1),y=Object(a.useCallback)((async e=>{var t;await x(),null==p||p.addSuccess({iconType:"check",title:l.m}),b(!1),null==e||null===(t=e.callback)||void 0===t||t.call(e)}),[x,p]),O=Object(a.useCallback)((e=>{b(!0),j(e)}),[j]),S=Object(a.useCallback)((()=>{v(),b(!1)}),[v]),k=Object(a.useCallback)((()=>{y()}),[y]),{data:C,isLoading:h,isFetching:A}=Object(Re.b)({http:d,resource:_e}),{mutate:E,isLoading:w}=Object(Ne.a)({http:d,toasts:p}),T=null!==(e=null==C?void 0:C.elser_exists)&&void 0!==e&&e,M=null!==(t=null==C?void 0:C.esql_exists)&&void 0!==t&&t,P=null!==(s=T&&M&&(null==C?void 0:C.index_exists)&&(null==C?void 0:C.pipeline_exists))&&void 0!==s&&s,z=null!==(c=null==C?void 0:C.is_setup_in_progress)&&void 0!==c&&c,D=null!==(u=null==C?void 0:C.is_setup_available)&&void 0!==u&&u,F=h||A||w||z,B=T?"success":"subdued",I=P?"success":"subdued",L=M?"success":"subdued",R=Object(a.useCallback)((()=>{E(_e)}),[E]),N=D?void 0:Le.p,_=Object(a.useMemo)((()=>P?Object(o.jsx)(n.a.Fragment,null):Object(o.jsx)(i.EuiToolTip,{position:"bottom",content:N},Object(o.jsx)(i.EuiButtonEmpty,{color:"primary","data-test-subj":"setupKnowledgeBaseButton",disabled:!D,onClick:R,size:"xs",isLoading:F},Le.o))),[P,F,D,R,N]),q=Object(a.useMemo)((()=>P?Object(o.jsx)("span",{"data-test-subj":"kb-installed"},Le.g(".kibana-elastic-ai-assistant-knowledge-base-(SPACE)")):Object(o.jsx)("span",{"data-test-subj":"install-kb"},Le.f)),[P]),U=Object(a.useMemo)((()=>M?Object(o.jsx)("span",{"data-test-subj":"esql-installed"},Le.d):Object(o.jsx)("span",{"data-test-subj":"install-esql"},Le.c)),[M]);return Object(o.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!0,paddingSize:"l"},Object(o.jsx)(i.EuiText,{size:"m"},Object(o.jsx)(f.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSettingManagements.knowledgeBaseDescription",defaultMessage:"Powered by ELSER, the knowledge base enables the AI Assistant to recall documents and other relevant context within your conversation. For more information about user access refer to our {documentation}.",values:{documentation:Object(o.jsx)(i.EuiLink,{external:!0,href:"https://www.elastic.co/guide/en/security/current/security-assistant.html",target:"_blank"},Le.h)}})),Object(o.jsx)(i.EuiHorizontalRule,{margin:"s"}),Object(o.jsx)(i.EuiFormRow,{display:"columnCompressedSwitch",label:Le.j,css:Ge},_),Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"s",css:Ve},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)("div",null,Object(o.jsx)(i.EuiHealth,{color:B},Le.i),Object(o.jsx)(i.EuiText,{size:"xs",color:"subdued",css:Qe},Object(o.jsx)(f.FormattedMessage,{defaultMessage:"Elastic Learned Sparse EncodeR - or ELSER - is a retrieval model trained by Elastic for performing semantic search.",id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSettingsManagement.knowledgeBaseDescription"})))),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)("div",null,Object(o.jsx)(i.EuiHealth,{color:I},Le.j),Object(o.jsx)(i.EuiText,{size:"xs",color:"subdued",css:Ue},q))),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)("span",null,Object(o.jsx)(i.EuiHealth,{color:L},Le.e),Object(o.jsx)(i.EuiText,{size:"xs",color:"subdued",css:qe},U)))),Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(Ie.a,{knowledgeBase:g,setUpdatedKnowledgeBaseSettings:O}),Object(o.jsx)(Z,{hasPendingChanges:m,onCancelClick:S,onSaveButtonClicked:k}))}));Ke.displayName="KnowledgeBaseSettingsManagement";var $e=s(2053);const We=n.a.memo((({selectedConversation:e})=>{const{assistantFeatures:{assistantModelEvaluation:t},http:s,selectedSettingsTab:d,setSelectedSettingsTab:p}=Object(r.b)(),{data:m}=Object(c.a)({http:s}),b=Object(a.useMemo)((()=>Object(u.b)(m)),[m]),{euiTheme:g}=Object(i.useEuiTheme)(),j=Object(i.useEuiShadow)("s");Object(a.useEffect)((()=>{null==d&&p(J.b)}),[d,p]);const f=Object(a.useMemo)((()=>[{id:J.b,label:l.c},{id:J.c,label:l.d},{id:J.h,label:l.n},{id:J.g,label:l.h},{id:J.a,label:l.a},{id:J.f,label:l.g},...t?[{id:J.e,label:l.f}]:[]]),[t]),x=Object(a.useMemo)((()=>f.map((e=>({...e,"data-test-subj":`settingsPageTab-${e.id}`,onClick:()=>p(e.id),isSelected:e.id===d})))),[p,d,f]);return Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiPageTemplate.Header,{pageTitle:Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiAvatar,{iconType:"logoSecurity",iconSize:"m",color:"plain",name:l.j,css:Object(o.css)(j,";margin-right:",.75*g.base,"px;","")}),Object(o.jsx)(i.EuiTitle,{size:"m",className:"eui-displayInlineBlock"},Object(o.jsx)("span",null,l.j))),tabs:x,paddingSize:"none"}),Object(o.jsx)(i.EuiPageTemplate.Section,{paddingSize:"none",css:Object(o.css)("padding-left:0;padding-right:0;padding-top:",.75*g.base,"px;padding-bottom:",.75*g.base,"px;","")},d===J.b&&Object(o.jsx)(v,null),d===J.c&&Object(o.jsx)(se,{connectors:m,defaultConnector:b,defaultSelectedConversation:e}),d===J.h&&Object(o.jsx)(Ee,{connectors:m,defaultConnector:b}),d===J.g&&Object(o.jsx)(be,null),d===J.a&&Object(o.jsx)(Be,null),d===J.f&&Object(o.jsx)(Ke,null),d===J.e&&Object(o.jsx)($e.a,null)))}));We.displayName="AssistantSettingsManagement";var He=s(1376),Ye=s(812),Je=s(118);const Xe=He.b,Ze=n.a.memo((()=>{const{baseConversations:e,http:t,assistantAvailability:{isAssistantEnabled:s}}=Object(r.b)(),{application:{navigateToApp:i,capabilities:{securitySolutionAssistant:{"ai-assistant":o}}}}=Object(Je.j)().services,l=Object(a.useCallback)((t=>Object(u.e)(e,t)),[e]),{data:c}=Object(N.b)({http:t,onFetch:l,isAssistantEnabled:s}),{getDefaultConversation:d}=Object(Ye.a)(),p=Object(a.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c[Xe])&&void 0!==e?e:d({cTitle:He.b})}),[c,d]);return o||i("home"),c?n.a.createElement(We,{selectedConversation:p}):n.a.createElement(n.a.Fragment,null)}));Ze.displayName="ManagementSettings"},271:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(2);t.default=function(e){var t=a.useRef();return a.useEffect((function(){t.current=e})),t.current}},659:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var a=s(120),n=s(820);const i=a.z.literal("PROMPT_FIELD_NOT_MODIFIED"),o=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:i}),l=a.z.object({id:a.z.string(),name:a.z.string().optional()}),r=a.z.enum(["system","quick"]),c=r.enum,u=a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:a.z.string().optional(),prompts:a.z.array(l)}),d=a.z.object({id:n.a,timestamp:n.a.optional(),name:a.z.string(),promptType:r,content:a.z.string(),categories:a.z.array(a.z.string()).optional(),color:a.z.string().optional(),isNewConversationDefault:a.z.boolean().optional(),isDefault:a.z.boolean().optional(),consumer:a.z.string().optional(),updatedAt:a.z.string().optional(),updatedBy:a.z.string().optional(),createdAt:a.z.string().optional(),createdBy:a.z.string().optional(),users:a.z.array(n.b).optional(),namespace:a.z.string().optional()}),p=a.z.object({updated:a.z.array(d),created:a.z.array(d),deleted:a.z.array(a.z.string()),skipped:a.z.array(o)}),m=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),b=(a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),prompts_count:a.z.number().int().optional(),attributes:a.z.object({results:p,summary:m,errors:a.z.array(u).optional()})}),a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()})),g=a.z.object({name:a.z.string(),promptType:r,content:a.z.string(),color:a.z.string().optional(),categories:a.z.array(a.z.string()).optional(),isNewConversationDefault:a.z.boolean().optional(),isDefault:a.z.boolean().optional(),consumer:a.z.string().optional()}),j=a.z.object({id:a.z.string(),content:a.z.string().optional(),color:a.z.string().optional(),categories:a.z.array(a.z.string()).optional(),isNewConversationDefault:a.z.boolean().optional(),isDefault:a.z.boolean().optional(),consumer:a.z.string().optional()});a.z.object({delete:b.optional(),create:a.z.array(g).optional(),update:a.z.array(j).optional()})},721:function(e,t,s){"use strict";e.exports=s(762)},820:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return i}));var a=s(120);const n=a.z.string().min(1).regex(/^(?! *$).+$/),i=(a.z.string().uuid(),a.z.object({id:a.z.string().optional(),name:a.z.string().optional()}));a.z.enum(["asc","desc"]).enum},821:function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"c",(function(){return n})),s.d(t,"g",(function(){return i})),s.d(t,"h",(function(){return o})),s.d(t,"a",(function(){return l})),s.d(t,"f",(function(){return r})),s.d(t,"e",(function(){return c})),s.d(t,"d",(function(){return u}));const a="CONNECTORS_TAB",n="CONVERSATIONS_TAB",i="QUICK_PROMPTS_TAB",o="SYSTEM_PROMPTS_TAB",l="ANONYMIZATION_TAB",r="KNOWLEDGE_BASE_TAB",c="EVALUATION_TAB",u=25},918:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a={SYSTEM_PROMPT_SELECTOR:"systemPromptSelector",CONVERSATIONS_MULTISELECTOR:"conversationMultiSelector",ADD_SYSTEM_PROMPT:"addSystemPrompt",PROMPT_SUPERSELECT:"promptSuperSelect",CONVERSATIONS_MULTISELECTOR_OPTION:e=>`conversationMultiSelectorOption-${e}`,SETTINGS_MODAL:"settingsModal",SYSTEM_PROMPT_MODAL:{ID:"systemPromptModal",PROMPT_TEXT:"systemPromptModalPromptText",TOGGLE_ALL_DEFAULT_CONVERSATIONS:"systemPromptModalToggleDefaultConversations",SAVE:"systemPromptModalSave",CANCEL:"systemPromptModalCancel"}}},919:function(e,t,s){"use strict";s.d(t,"k",(function(){return n})),s.d(t,"l",(function(){return i})),s.d(t,"j",(function(){return o})),s.d(t,"m",(function(){return l})),s.d(t,"c",(function(){return r})),s.d(t,"d",(function(){return c})),s.d(t,"h",(function(){return u})),s.d(t,"n",(function(){return d})),s.d(t,"a",(function(){return p})),s.d(t,"g",(function(){return m})),s.d(t,"f",(function(){return b})),s.d(t,"b",(function(){return g})),s.d(t,"i",(function(){return j})),s.d(t,"e",(function(){return v}));var a=s(4);const n=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAriaLabel",{defaultMessage:"Settings"}),i=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsTooltip",{defaultMessage:"Settings"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.securityAiSettingsTitle",{defaultMessage:"Security AI settings"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsUpdatedToastTitle",{defaultMessage:"Settings updated"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConnectorsMenuItemTitle",{defaultMessage:"Connectors"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConversationsMenuItemTitle",{defaultMessage:"Conversations"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsQuickPromptsMenuItemTitle",{defaultMessage:"Quick Prompts"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsSystemPromptsMenuItemTitle",{defaultMessage:"System Prompts"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAnonymizationMenuItemTitle",{defaultMessage:"Anonymization"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsKnowledgeBaseMenuItemTitle",{defaultMessage:"Knowledge Base"}),b=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsEvaluationMenuItemTitle",{defaultMessage:"Evaluation"}),g=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.modalTitle",{defaultMessage:"System Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"})),j=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"}),v=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slDeleteButtonTitle",{defaultMessage:"Delete"})},920:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"a",(function(){return i})),s.d(t,"f",(function(){return o})),s.d(t,"g",(function(){return l})),s.d(t,"h",(function(){return r})),s.d(t,"c",(function(){return c})),s.d(t,"e",(function(){return u})),s.d(t,"d",(function(){return d}));var a=s(4);const n=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsTitle",{defaultMessage:"System Prompts"}),i=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsDescription",{defaultMessage:"Create and manage System Prompts. System Prompts are configurable chunks of context that are always sent for a given conversation."}),o=(a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.modalTitle",{defaultMessage:"System Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.nameLabel",{defaultMessage:"Name"})),l=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptLabel",{defaultMessage:"Prompt"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptPlaceholder",{defaultMessage:"Enter a System Prompt"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsLabel",{defaultMessage:"Default conversations"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultNewConversationTitle",{defaultMessage:"Use as default for all new conversations"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsHelpText",{defaultMessage:"Conversations that should use this System Prompt by default."});a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"})}}]);