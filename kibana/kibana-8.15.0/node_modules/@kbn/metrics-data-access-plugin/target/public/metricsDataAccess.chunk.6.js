/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.metricsDataAccess_bundle_jsonpfunction=window.metricsDataAccess_bundle_jsonpfunction||[]).push([[6],{84:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),s=a(32),i=a(10),c=a(1),l=a(26),u=a(3);const o=e=>{const{data:t,isLoading:a,setCurrentPageIndex:s,setSortState:o,sortState:g,timerange:m}=e,b=Object(n.useMemo)((()=>function(e){return[{name:c.i18n.translate("xpack.metricsData.metricsTable.container.idColumnHeader",{defaultMessage:"Id"}),field:"id",truncateText:!0,textOnly:!0,render:t=>Object(u.jsx)(l.a,{id:t,label:t,nodeType:"container",timerange:e})},{name:c.i18n.translate("xpack.metricsData.metricsTable.container.averageCpuUsagePercentColumnHeader",{defaultMessage:"CPU usage (avg.)"}),field:"averageCpuUsagePercent",align:"right",render:e=>Object(u.jsx)(l.f,{value:e,unit:"%"})},{name:c.i18n.translate("xpack.metricsData.metricsTable.container.averageMemoryUsageMegabytesColumnHeader",{defaultMessage:"Memory usage(avg.)"}),field:"averageMemoryUsageMegabytes",align:"right",render:e=>Object(u.jsx)(l.f,{value:e,unit:" MB"})}]}(m)),[m]),d={enableAllColumns:!0,sort:g},j=Object(n.useCallback)((({sort:e})=>{e&&(o(e),s(0))}),[o,s]);return"error"===t.state?Object(u.jsx)(r.a.Fragment,null,t.errors.map((e=>Object(u.jsx)(l.c,{error:e})))):a&&"data"!==t.state?Object(u.jsx)(l.d,null):"no-indices"===t.state?Object(u.jsx)(l.e,null):"empty-indices"===t.state?Object(u.jsx)(l.b,null):"data"===t.state?Object(u.jsx)(r.a.Fragment,null,Object(u.jsx)(i.EuiBasicTable,{tableCaption:c.i18n.translate("xpack.metricsData.metricsTable.container.tableCaption",{defaultMessage:"Infrastructure metrics for containers"}),items:t.rows,columns:b,sorting:d,onChange:j,loading:a,noItemsMessage:Object(u.jsx)(l.d,null),"data-test-subj":"containerMetricsTable"}),Object(u.jsx)(i.EuiSpacer,{size:"s"}),Object(u.jsx)(i.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",responsive:!1,wrap:!0},Object(u.jsx)(i.EuiFlexItem,{grow:!1},Object(u.jsx)(l.g,{ariaLabel:c.i18n.translate("xpack.metricsData.metricsTable.container.paginationAriaLabel",{defaultMessage:"Container metrics pagination"}),pageCount:t.pageCount,currentPageIndex:t.currentPageIndex,setCurrentPageIndex:s,"data-test-subj":"containerMetricsTablePagination"})))):null},g={sourceFilter:{term:{"event.dataset":"kubernetes.container"}},groupByField:"container.id",metricsMap:{"kubernetes.container.cpu.usage.limit.pct":{aggregation:"avg",field:"kubernetes.container.cpu.usage.limit.pct"},"kubernetes.container.memory.usage.bytes":{aggregation:"avg",field:"kubernetes.container.memory.usage.bytes"}}},m=Object(l.i)(g.metricsMap),b=Object(l.j)(m);function d(e){return 0===e.rows.length?{id:e.id,averageCpuUsagePercent:null,averageMemoryUsageMegabytes:null}:{id:e.id,...j(e.rows)}}function j(e){const{averageCpuUsagePercentValues:t,averageMemoryUsageMegabytesValues:a}=function(e){const t=[],a=[];return e.forEach((e=>{const{averageCpuUsagePercent:n,averageMemoryUsageMegabytes:r}=function(e){return{averageCpuUsagePercent:b(e,"kubernetes.container.cpu.usage.limit.pct"),averageMemoryUsageMegabytes:b(e,"kubernetes.container.memory.usage.bytes")}}(e);null!==n&&t.push(n),null!==r&&a.push(r)})),{averageCpuUsagePercentValues:t,averageMemoryUsageMegabytesValues:a}}(e);let n=null;0!==t.length&&(n=Object(l.l)(Object(l.h)(t)));let r=null;if(0!==a.length){const e=Object(l.h)(a),t=1e6;r=Math.floor(e/t)}return{averageCpuUsagePercent:n,averageMemoryUsageMegabytes:r}}function p({timerange:e,filterClauseDsl:t,metricsClient:a}){const r=function({timerange:e,filterClauseDsl:t,metricsClient:a}){const[r,s]=Object(n.useState)(0),[i,c]=Object(n.useState)({field:"averageCpuUsagePercent",direction:"desc"}),{options:u}=Object(n.useMemo)((()=>Object(l.k)(g,t)),[t]),{data:o,isLoading:m}=Object(l.m)({metricsExplorerOptions:u,timerange:e,transform:d,sortState:i,currentPageIndex:r,metricsClient:a});return{data:o,isLoading:m,setCurrentPageIndex:s,setSortState:c,sortState:i,timerange:e}}({timerange:e,filterClauseDsl:t,metricsClient:a});return Object(u.jsx)(o,r)}t.default=function({timerange:e,filterClauseDsl:t,sourceId:a,metricsClient:n,...r}){return Object(u.jsx)(s.a,r,Object(u.jsx)(p,{timerange:e,filterClauseDsl:t,metricsClient:n}))}}}]);