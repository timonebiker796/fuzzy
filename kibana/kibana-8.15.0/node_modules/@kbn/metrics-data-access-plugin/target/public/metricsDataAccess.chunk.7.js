/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.metricsDataAccess_bundle_jsonpfunction=window.metricsDataAccess_bundle_jsonpfunction||[]).push([[7],{85:function(e,t,a){"use strict";a.r(t);var s=a(2),r=a.n(s),n=a(32),l=a(10),c=a(1),o=a(26),u=a(3);const i=e=>{const{data:t,isLoading:a,setCurrentPageIndex:n,setSortState:i,sortState:m,timerange:g}=e,d=Object(s.useMemo)((()=>function(e){return[{name:c.i18n.translate("xpack.metricsData.metricsTable.host.nameColumnHeader",{defaultMessage:"Name"}),field:"name",truncateText:!0,textOnly:!0,render:t=>Object(u.jsx)(o.a,{id:t,label:t,nodeType:"host",timerange:e})},{name:c.i18n.translate("xpack.metricsData.metricsTable.host.CpuCountColumnHeader",{defaultMessage:"# of CPUs"}),field:"cpuCount",align:"right",render:e=>Object(u.jsx)(o.f,{value:e})},{name:c.i18n.translate("xpack.metricsData.metricsTable.host.averageCpuUsagePercentColumnHeader",{defaultMessage:"CPU usage (avg.)"}),field:"averageCpuUsagePercent",align:"right",render:e=>Object(u.jsx)(o.f,{value:e,unit:"%"})},{name:c.i18n.translate("xpack.metricsData.metricsTable.host.totalMemoryMegabytesColumnHeader",{defaultMessage:"Memory total"}),field:"totalMemoryMegabytes",align:"right",render:e=>Object(u.jsx)(o.f,{value:e,unit:" MB"})},{name:c.i18n.translate("xpack.metricsData.metricsTable.host.averageMemoryUsagePercentColumnHeader",{defaultMessage:"Memory usage (avg.)"}),field:"averageMemoryUsagePercent",align:"right",render:e=>Object(u.jsx)(o.f,{value:e,unit:"%"})}]}(g)),[g]),b={enableAllColumns:!0,sort:m},p=Object(s.useCallback)((({sort:e})=>{e&&(i(e),n(0))}),[i,n]);return"error"===t.state?Object(u.jsx)(r.a.Fragment,null,t.errors.map((e=>Object(u.jsx)(o.c,{error:e})))):a&&"data"!==t.state?Object(u.jsx)(o.d,null):"no-indices"===t.state?Object(u.jsx)(o.e,null):"empty-indices"===t.state?Object(u.jsx)(o.b,null):"data"===t.state?Object(u.jsx)(r.a.Fragment,null,Object(u.jsx)(l.EuiBasicTable,{tableCaption:c.i18n.translate("xpack.metricsData.metricsTable.host.tableCaption",{defaultMessage:"Infrastructure metrics for hosts"}),items:t.rows,columns:d,sorting:b,onChange:p,loading:a,noItemsMessage:Object(u.jsx)(o.d,null),"data-test-subj":"hostMetricsTable"}),Object(u.jsx)(l.EuiSpacer,{size:"s"}),Object(u.jsx)(l.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",responsive:!1,wrap:!0},Object(u.jsx)(l.EuiFlexItem,{grow:!1},Object(u.jsx)(o.g,{ariaLabel:c.i18n.translate("xpack.metricsData.metricsTable.host.paginationAriaLabel",{defaultMessage:"Host metrics pagination"}),pageCount:t.pageCount,currentPageIndex:t.currentPageIndex,setCurrentPageIndex:n,"data-test-subj":"hostMetricsTablePagination"})))):null},m={sourceFilter:{term:{"event.module":"system"}},groupByField:"host.name",metricsMap:{"system.cpu.cores":{aggregation:"max",field:"system.cpu.cores"},"system.cpu.total.norm.pct":{aggregation:"avg",field:"system.cpu.total.norm.pct"},"system.memory.total":{aggregation:"max",field:"system.memory.total"},"system.memory.used.pct":{aggregation:"avg",field:"system.memory.used.pct"}}},g=Object(o.i)(m.metricsMap),d=Object(o.j)(g);function b(e){return 0===e.rows.length?{name:e.id,cpuCount:null,averageCpuUsagePercent:null,totalMemoryMegabytes:null,averageMemoryUsagePercent:null}:{name:e.id,...p(e.rows)}}function p(e){const{cpuCountValues:t,averageCpuUsagePercentValues:a,totalMemoryMegabytesValues:s,averageMemoryUsagePercentValues:r}=function(e){const t=[],a=[],s=[],r=[];return e.forEach((e=>{const{cpuCount:n,averageCpuUsagePercent:l,totalMemoryMegabytes:c,averageMemoryUsagePercent:o}=function(e){return{cpuCount:d(e,"system.cpu.cores"),averageCpuUsagePercent:d(e,"system.cpu.total.norm.pct"),totalMemoryMegabytes:d(e,"system.memory.total"),averageMemoryUsagePercent:d(e,"system.memory.used.pct")}}(e);null!==n&&t.push(n),null!==l&&a.push(l),null!==c&&s.push(c),null!==o&&r.push(o)})),{cpuCountValues:t,averageCpuUsagePercentValues:a,totalMemoryMegabytesValues:s,averageMemoryUsagePercentValues:r}}(e);let n=null;0!==t.length&&(n=t.at(-1));let l=null;0!==a.length&&(l=Object(o.l)(Object(o.h)(a)));let c=null;if(0!==s.length){const e=s.at(-1),t=1e6;c=Math.floor(e/t)}let u=null;return 0!==r.length&&(u=Object(o.l)(Object(o.h)(r))),{cpuCount:n,averageCpuUsagePercent:l,totalMemoryMegabytes:c,averageMemoryUsagePercent:u}}function j({timerange:e,filterClauseDsl:t,metricsClient:a}){const r=function({timerange:e,filterClauseDsl:t,metricsClient:a}){const[r,n]=Object(s.useState)(0),[l,c]=Object(s.useState)({field:"averageCpuUsagePercent",direction:"desc"}),{options:u}=Object(s.useMemo)((()=>Object(o.k)(m,t)),[t]),{data:i,isLoading:g}=Object(o.m)({metricsExplorerOptions:u,timerange:e,transform:b,sortState:l,currentPageIndex:r,metricsClient:a});return{data:i,isLoading:g,setCurrentPageIndex:n,setSortState:c,sortState:l,timerange:e}}({timerange:e,filterClauseDsl:t,metricsClient:a});return Object(u.jsx)(i,r)}t.default=function({timerange:e,filterClauseDsl:t,sourceId:a,metricsClient:s,...r}){return Object(u.jsx)(n.a,r,Object(u.jsx)(j,{timerange:e,filterClauseDsl:t,metricsClient:s}))}}}]);