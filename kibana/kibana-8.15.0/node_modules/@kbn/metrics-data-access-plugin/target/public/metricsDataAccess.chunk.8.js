/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.metricsDataAccess_bundle_jsonpfunction=window.metricsDataAccess_bundle_jsonpfunction||[]).push([[8],{86:function(e,t,a){"use strict";a.r(t);var s=a(2),r=a.n(s),n=a(32),i=a(10),u=a(1),c=a(26),l=a(3);const o=e=>{const{data:t,isLoading:a,setCurrentPageIndex:n,setSortState:o,sortState:g,timerange:d}=e,m=Object(s.useMemo)((()=>function(e){return[{name:u.i18n.translate("xpack.metricsData.metricsTable.pod.nameColumnHeader",{defaultMessage:"Name"}),field:"name",truncateText:!0,textOnly:!0,render:(t,{id:a,name:s})=>Object(l.jsx)(c.a,{id:a,label:s,nodeType:"pod",timerange:e})},{name:u.i18n.translate("xpack.metricsData.metricsTable.pod.averageCpuUsagePercentColumnHeader",{defaultMessage:"CPU usage (avg.)"}),field:"averageCpuUsagePercent",align:"right",render:e=>Object(l.jsx)(c.f,{value:e,unit:"%"})},{name:u.i18n.translate("xpack.metricsData.metricsTable.pod.averageMemoryUsageMegabytesColumnHeader",{defaultMessage:"Memory usage (avg.)"}),field:"averageMemoryUsageMegabytes",align:"right",render:e=>Object(l.jsx)(c.f,{value:e,unit:" MB"})}]}(d)),[d]),b={enableAllColumns:!0,sort:g};return"error"===t.state?Object(l.jsx)(r.a.Fragment,null,t.errors.map((e=>Object(l.jsx)(c.c,{error:e})))):a&&"data"!==t.state?Object(l.jsx)(c.d,null):"no-indices"===t.state?Object(l.jsx)(c.e,null):"empty-indices"===t.state?Object(l.jsx)(c.b,null):"data"===t.state?Object(l.jsx)(r.a.Fragment,null,Object(l.jsx)(i.EuiBasicTable,{tableCaption:u.i18n.translate("xpack.metricsData.metricsTable.pod.tableCaption",{defaultMessage:"Infrastructure metrics for pods"}),items:t.rows,columns:m,sorting:b,onChange:({sort:e={direction:"desc",field:"averageCpuUsagePercent"}})=>{o(e),n(0)},loading:a,noItemsMessage:Object(l.jsx)(c.d,null),"data-test-subj":"podMetricsTable"}),Object(l.jsx)(i.EuiSpacer,{size:"s"}),Object(l.jsx)(i.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",responsive:!1,wrap:!0},Object(l.jsx)(i.EuiFlexItem,{grow:!1},Object(l.jsx)(c.g,{ariaLabel:u.i18n.translate("xpack.metricsData.metricsTable.pod.paginationAriaLabel",{defaultMessage:"Pod metrics pagination"}),pageCount:t.pageCount,currentPageIndex:t.currentPageIndex,setCurrentPageIndex:n,"data-test-subj":"podMetricsTablePagination"})))):null},g={sourceFilter:{term:{"event.dataset":"kubernetes.pod"}},groupByField:["kubernetes.pod.uid","kubernetes.pod.name"],metricsMap:{"kubernetes.pod.cpu.usage.limit.pct":{aggregation:"avg",field:"kubernetes.pod.cpu.usage.limit.pct"},"kubernetes.pod.memory.usage.bytes":{aggregation:"avg",field:"kubernetes.pod.memory.usage.bytes"}}},d=Object(c.i)(g.metricsMap),m=Object(c.j)(d);function b(e){var t;const[a,s]=null!==(t=e.keys)&&void 0!==t?t:[];return 0===e.rows.length?function(e,t){return{id:e,name:t,averageCpuUsagePercent:null,averageMemoryUsageMegabytes:null}}(a,s):{id:a,name:s,...p(e.rows)}}function p(e){const{averageCpuUsagePercentValues:t,averageMemoryUsageMegabytesValues:a}=function(e){const t=[],a=[];return e.forEach((e=>{const{averageCpuUsagePercent:s,averageMemoryUsageMegabytes:r}=function(e){return{averageCpuUsagePercent:m(e,"kubernetes.pod.cpu.usage.limit.pct"),averageMemoryUsageMegabytes:m(e,"kubernetes.pod.memory.usage.bytes")}}(e);null!==s&&t.push(s),null!==r&&a.push(r)})),{averageCpuUsagePercentValues:t,averageMemoryUsageMegabytesValues:a}}(e);let s=null;0!==t.length&&(s=Object(c.l)(Object(c.h)(t)));let r=null;if(0!==a.length){const e=Object(c.h)(a),t=1e6;r=Math.floor(e/t)}return{averageCpuUsagePercent:s,averageMemoryUsageMegabytes:r}}function j({timerange:e,filterClauseDsl:t,metricsClient:a}){const r=function({timerange:e,filterClauseDsl:t,metricsClient:a}){const[r,n]=Object(s.useState)(0),[i,u]=Object(s.useState)({field:"averageCpuUsagePercent",direction:"desc"}),{options:l}=Object(s.useMemo)((()=>Object(c.k)(g,t)),[t]),{data:o,isLoading:d}=Object(c.m)({metricsExplorerOptions:l,timerange:e,transform:b,sortState:i,currentPageIndex:r,metricsClient:a});return{currentPageIndex:r,data:o,isLoading:d,setCurrentPageIndex:n,setSortState:u,sortState:i,timerange:e}}({timerange:e,filterClauseDsl:t,metricsClient:a});return Object(l.jsx)(o,r)}t.default=function({timerange:e,filterClauseDsl:t,sourceId:a,metricsClient:s,...r}){return Object(l.jsx)(n.a,r,Object(l.jsx)(j,{timerange:e,filterClauseDsl:t,metricsClient:s}))}}}]);