/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[47],{213:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n="/internal/rac/alerts"},381:function(e,t,r){"use strict";r.r(t),r.d(t,"AlertSummaryWidget",(function(){return l})),r.d(t,"default",(function(){return l}));var n=r(1),i=r(213),a=r(29);var o=r(74),c=r(0);const l=({chartProps:e,featureIds:t,filter:r,fullSize:l,onClick:s=(()=>{}),timeRange:u,hideChart:d,hideStats:v,onLoaded:f,dependencies:{charts:A}})=>{const{alertSummary:{activeAlertCount:C,activeAlerts:m,recoveredAlertCount:g},isLoading:h,error:b}=function({featureIds:e,timeRange:t,filter:r}){const{http:o}=Object(a.b)().services,[c,l]=Object(n.useState)({isLoading:!0,alertSummary:{activeAlertCount:0,activeAlerts:[],recoveredAlertCount:0}}),s=Object(n.useRef)(!1),u=Object(n.useRef)(new AbortController),d=Object(n.useCallback)((async()=>{if(e){s.current=!1,u.current.abort(),u.current=new AbortController;try{const{activeAlertCount:n,activeAlerts:a,recoveredAlertCount:c}=await async function({featureIds:e,filter:t,http:r,signal:n,timeRange:{utcFrom:a,utcTo:o,fixedInterval:c}}){var l,s,u;const d=await r.post(`${i.a}/_alert_summary`,{signal:n,body:JSON.stringify({fixed_interval:c,gte:a,lte:o,featureIds:e,filter:[t]})});return{activeAlertCount:null!==(l=null==d?void 0:d.activeAlertCount)&&void 0!==l?l:0,activeAlerts:null!==(s=null==d?void 0:d.activeAlerts)&&void 0!==s?s:[],recoveredAlertCount:null!==(u=null==d?void 0:d.recoveredAlertCount)&&void 0!==u?u:0}}({featureIds:e,filter:r,http:o,signal:u.current.signal,timeRange:t});s.current||l((()=>({alertSummary:{activeAlertCount:n,activeAlerts:a,recoveredAlertCount:c},isLoading:!1})))}catch(e){s.current||"AbortError"!==e.name&&l((t=>({...t,isLoading:!1,error:e.message})))}}}),[e,r,o,t]);return Object(n.useEffect)((()=>{d()}),[d]),c}({featureIds:t,filter:r,timeRange:u});Object(n.useEffect)((()=>{!h&&f&&f({activeAlertCount:C,recoveredAlertCount:g})}),[C,h,f,g]);const j={baseTheme:A.theme.useChartsBaseTheme(),sparklineTheme:A.theme.useSparklineOverrides()};return h?Object(c.jsx)(o.d,{fullSize:l,isLoadingWithoutChart:d}):b?Object(c.jsx)(o.b,null):l?C||g?Object(c.jsx)(o.c,{activeAlertCount:C,activeAlerts:m,chartProps:e,dateFormat:u.dateFormat,recoveredAlertCount:g,hideChart:d,hideStats:v,dependencyProps:j}):null:Object(c.jsx)(o.a,{activeAlertCount:C,activeAlerts:m,chartProps:e,onClick:s,recoveredAlertCount:g,timeRangeTitle:u.title,dependencyProps:j})}}}]);