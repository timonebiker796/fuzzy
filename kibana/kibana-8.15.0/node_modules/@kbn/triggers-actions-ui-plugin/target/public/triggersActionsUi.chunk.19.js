/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[19],{131:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return c}));const s=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.show},i=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.save},r=(e,t)=>{var n,s;return".sentinelone"===t?null==e||null===(n=e.actions)||void 0===n?void 0:n.save:null==e||null===(s=e.actions)||void 0===s?void 0:s.execute},l=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.delete};function o(e,t){var n,s;return null!==(n=null==t||null===(s=t.authorizedConsumers[e])||void 0===s?void 0:s.all)&&void 0!==n&&n}const c=e=>{var t,n;return null==e||null===(t=e.management)||void 0===t||null===(n=t.security)||void 0===n?void 0:n.api_keys}},206:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var s=n(1),i=n.n(s),r=n(10),l=n(18),o=n(3),c=n(24),a=n(59),u=n(131),d=n(29),b=n(68),j=n(45),p=n(2),g=n(0);const{emptyField:m}=b.fieldValidators,f={label:"Connector name",validations:[{validator:m(p.i18n.translate("xpack.triggersActionsUI.sections.actionConnectorForm.error.requiredNameText",{defaultMessage:"Name is required."}))}]},v=({canSave:e})=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(l.UseField,{path:"id",component:j.HiddenField}),Object(g.jsx)(l.UseField,{path:"actionTypeId",component:j.HiddenField}),Object(g.jsx)(l.UseField,{path:"isDeprecated",component:j.HiddenField}),Object(g.jsx)(l.UseField,{path:"name",config:f,component:j.Field,componentProps:{euiFieldProps:{readOnly:!e,"data-test-subj":"nameInput",fullWidth:!0}}})),O=Object(s.memo)(v),h=({actionTypeModel:e,isEdit:t,registerPreSubmitValidator:n})=>{var r;const{application:{capabilities:l}}=Object(d.b)().services,b=Object(u.e)(l),j=null!==(r=null==e?void 0:e.actionConnectorFields)&&void 0!==r?r:null;return Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(O,{canSave:b}),Object(g.jsx)(o.EuiSpacer,{size:"m"}),null!==j?Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(o.EuiTitle,{size:"xxs","data-test-subj":"connector-settings-label"},Object(g.jsx)("h4",null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionConnectorForm.connectorSettingsLabel",defaultMessage:"Connector settings"}))),Object(g.jsx)(o.EuiSpacer,{size:"s"}),Object(g.jsx)(o.EuiErrorBoundary,null,Object(g.jsx)(s.Suspense,{fallback:Object(g.jsx)(a.a,null,Object(g.jsx)(c.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionConnectorForm.loadingConnectorSettingsDescription",defaultMessage:"Loading connector settingsâ€¦"}))},Object(g.jsx)(j,{readOnly:!b,isEdit:t,registerPreSubmitValidator:n})))):null)},F=Object(s.memo)(h),x=({title:e,dataTestSubj:t})=>Object(g.jsx)(i.a.Fragment,null,Object(g.jsx)(o.EuiSpacer,{size:"s"}),Object(g.jsx)(o.EuiCallOut,{size:"s",iconType:"iInCircle","data-test-subj":t,title:e}),Object(g.jsx)(o.EuiSpacer,{size:"m"})),y=e=>null!=e||!y(e),S=({isEdit:e,isMissingSecrets:t})=>{const[n]=Object(l.useFormData)(),{getFields:s}=Object(l.useFormContext)(),i=s(),r=(o=i,Object.keys(o).filter((e=>e.includes("secrets"))).reduce(((e,t)=>({...e,[t]:o[t]})),{}));var o;const c=Object.keys(r).length,a=(e=>{if(0===e.length)return"";if(1===e.length)return`${e[0]}`;if(2===e.length)return e.join(" and ");const t=e[e.length-1];return`${e.slice(0,-1).join(", ")}, and ${t}`})((e=>Object.keys(e).map((t=>e[t].label)).filter(y))(r));return 0===Object.keys(r).length?null:t?Object(g.jsx)(x,{title:p.i18n.translate("xpack.triggersActionsUI.components.builtinActionTypes.missingSecretsValuesLabel",{values:{secretFieldsLabel:a,encryptedFieldsLength:c},defaultMessage:"Sensitive information is not imported. Please enter value{encryptedFieldsLength, plural, one {} other {s}} for the following field{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel}."}),dataTestSubj:"missing-secrets-callout"}):e?e?Object(g.jsx)(x,{title:p.i18n.translate("xpack.triggersActionsUI.components.simpleConnectorForm.secrets.reenterValuesMessage",{values:{secretFieldsLabel:a,encryptedFieldsLength:c},defaultMessage:"Value{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel} {encryptedFieldsLength, plural, one {is} other {are}} encrypted. Please reenter value{encryptedFieldsLength, plural, one {} other {s}} for {encryptedFieldsLength, plural, one {this} other {these}} field{encryptedFieldsLength, plural, one {} other {s}}."}),dataTestSubj:"edit-connector-secrets-callout"}):null:Object(g.jsx)(x,{title:p.i18n.translate("xpack.triggersActionsUI.components.simpleConnectorForm.secrets.reenterValuesLabel",{values:{secretFieldsLabel:a,encryptedFieldsLength:c},defaultMessage:"Remember your {secretFieldsLabel} {encryptedFieldsLength, plural, one {value} other {values}}. You must reenter {encryptedFieldsLength, plural, one {it} other {them}} each time you edit the connector."}),dataTestSubj:"create-connector-secrets-callout"})},L=Object(s.memo)(S),E=e=>{var t,n;if(".webhook"!==e.actionTypeId&&".cases-webhook"!==e.actionTypeId)return e;const s=e,i=Object.entries(null!==(t=null==s||null===(n=s.config)||void 0===n?void 0:n.headers)&&void 0!==t?t:{}).map((([e,t])=>({key:e,value:t})));return{...e,config:{...e.config,headers:Object(r.isEmpty)(i)?void 0:i}}},k=e=>{var t,n;if(".webhook"!==e.actionTypeId&&".cases-webhook"!==e.actionTypeId)return e;const s=(null!==(t=null==e||null===(n=e.config)||void 0===n?void 0:n.headers)&&void 0!==t?t:[]).reduce(((e,t)=>({...e,[t.key]:t.value})),{});return{...e,config:{...e.config,headers:Object(r.isEmpty)(s)?null:s}}},M=({actionTypeModel:e,connector:t,isEdit:n,onChange:i,onFormModifiedChange:r,setResetForm:c})=>{const{form:a}=Object(l.useForm)({defaultValue:t,serializer:k,deserializer:E}),{submit:u,isValid:d,isSubmitted:b,isSubmitting:j,reset:p}=a,[m,f]=Object(s.useState)(null),v=Object(s.useCallback)((e=>{f((()=>e))}),[]),O=Object(l.useFormIsModified)({form:a,discard:["__internal__"]});return Object(s.useEffect)((()=>{i&&i({isValid:d,isSubmitted:b,isSubmitting:j,submit:u,preSubmitValidator:m})}),[i,d,b,j,u,m]),Object(s.useEffect)((()=>{r&&r(O)}),[O,r]),Object(s.useEffect)((()=>{c&&c(p)}),[p]),Object(g.jsx)(l.Form,{form:a},Object(g.jsx)(F,{actionTypeModel:e,isEdit:n,registerPreSubmitValidator:v}),Object(g.jsx)(o.EuiSpacer,{size:"m"}),Object(g.jsx)(L,{isEdit:n,isMissingSecrets:t.isMissingSecrets}))},C=i.a.memo(M)}}]);