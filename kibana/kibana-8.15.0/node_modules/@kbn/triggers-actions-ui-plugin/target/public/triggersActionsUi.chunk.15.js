/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[15,41],{106:function(e,t,n){"use strict";n.r(t),n.d(t,"AddConnectorInline",(function(){return m})),n.d(t,"default",(function(){return m}));var i=n(1),o=n.n(i),a=n(2),s=n(24),r=n(3),c=n(50),l=n(131),u=n(29),d=n(197),p=n(212),g=n(0);const m=({actionTypesIndex:e,actionItem:t,index:n,connectors:m,onAddConnector:b,onDeleteConnector:f,onSelectConnector:j,actionTypeRegistry:y,emptyActionsIds:h})=>{var x;const{application:{capabilities:O}}=Object(u.b)().services,v=Object(l.e)(O),[A,I]=Object(i.useState)(!1),[T,E]=Object(i.useState)(!1),F=e?e[t.actionTypeId].name:t.actionTypeId,C=y.get(t.actionTypeId),S=(null!==(x=null==C?void 0:C.subtype)&&void 0!==x?x:[]).map((e=>e.id)),w=Object(i.useMemo)((()=>[`Unable to load ${C.actionTypeTitle} connector`]),[C.actionTypeTitle]),k=Object(g.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.connectorAddInline.emptyConnectorsLabel",defaultMessage:"No {actionTypeName} connectors",values:{actionTypeName:F}}),M=Object(g.jsx)(r.EuiText,{color:"danger"},Object(g.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.connectorAddInline.unableToLoadConnectorTitle",defaultMessage:"Unable to load connector"}));Object(i.useEffect)((()=>{Object(d.a)(m,t,e,S).length>0&&I(!0),E(!!h.find((e=>t.id===e)))}),[]);const U=Object(g.jsx)(r.EuiFormRow,{fullWidth:!0,label:Object(g.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.connectorAddInline.connectorAddInline.actionIdLabel",defaultMessage:"Use another {connectorInstance} connector",values:{connectorInstance:F}}),labelAppend:Object(g.jsx)(r.EuiButtonEmpty,{size:"xs","data-test-subj":`addNewActionConnectorButton-${t.actionTypeId}`,onClick:b},Object(g.jsx)(s.FormattedMessage,{defaultMessage:"Add connector",id:"xpack.triggersActionsUI.sections.connectorAddInline.connectorAddInline.addNewConnectorEmptyButton"})),error:w,isInvalid:!0},Object(g.jsx)(p.a,{actionItem:t,accordionIndex:n,actionTypesIndex:e,actionTypeRegistered:C,connectors:m,onConnectorSelected:j,allowGroupConnector:S}));return Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(r.EuiAccordion,{key:n,initialIsOpen:!0,id:n.toString(),className:"actAccordionActionForm",buttonContentClassName:"actAccordionActionForm__button","data-test-subj":`alertActionAccordion-${n}`,buttonContent:Object(g.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiIcon,{type:C.iconClass,size:"m"})),Object(g.jsx)(r.EuiFlexItem,null,Object(g.jsx)(r.EuiText,null,Object(g.jsx)("div",null,Object(g.jsx)(s.FormattedMessage,{defaultMessage:"{actionConnectorName}",id:"xpack.triggersActionsUI.sections.connectorAddInline.newRuleActionTypeEditTitle",values:{actionConnectorName:C.actionTypeTitle}})))),!T&&Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiIconTip,{type:"warning",size:"m",color:"danger","data-test-subj":"alertActionAccordionErrorTooltip",content:Object(g.jsx)(s.FormattedMessage,{defaultMessage:"Unable to load connector",id:"xpack.triggersActionsUI.sections.connectorAddInline.unableToLoadConnectorTitle'"})})),C&&C.isExperimental&&Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiBetaBadge,{label:c.q,tooltipContent:c.p}))),extraAction:Object(g.jsx)(r.EuiButtonIcon,{iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.connectorAddInline.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:f}),paddingSize:"l"},v?A?U:Object(g.jsx)(r.EuiEmptyPrompt,{title:T?k:M,actions:Object(g.jsx)(r.EuiButton,{color:"primary",fill:!0,size:"s","data-test-subj":`createActionConnectorButton-${n}`,onClick:b},Object(g.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.connectorAddInline.addConnectorButtonLabel",defaultMessage:"Create a connector"}))}):Object(g.jsx)(r.EuiCallOut,{title:k},Object(g.jsx)("p",null,Object(g.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.connectorAddInline.unauthorizedToCreateForEmptyConnectors",defaultMessage:"Only authorized users can configure a connector. Contact your administrator."})))),Object(g.jsx)(r.EuiSpacer,{size:"xs"}))}},131:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return c}));const i=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.show},o=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.save},a=(e,t)=>{var n,i;return".sentinelone"===t?null==e||null===(n=e.actions)||void 0===n?void 0:n.save:null==e||null===(i=e.actions)||void 0===i?void 0:i.execute},s=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.delete};function r(e,t){var n,i;return null!==(n=null==t||null===(i=t.authorizedConsumers[e])||void 0===i?void 0:i.all)&&void 0!==n&&n}const c=e=>{var t,n;return null==e||null===(t=e.management)||void 0===t||null===(n=t.security)||void 0===n?void 0:n.api_keys}},137:function(e,t,n){"use strict";e.exports=n(149)},147:function(e,t,n){"use strict";e.exports=n(150)},148:function(e,t,n){"use strict";e.exports=n(151)},149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="undefined"!=typeof document,o=function(e,t,n){var o=e.key+"-"+t.name;(!1===n||!1===i&&void 0!==e.compat)&&void 0===e.registered[o]&&(e.registered[o]=t.styles)};t.getRegisteredStyles=function(e,t,n){var i="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):i+=n+" "})),i},t.insertStyles=function(e,t,n){o(e,t,n);var a=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s="",r=t;do{var c=e.insert(t===r?"."+a:"",r,e.sheet,!0);i||void 0===c||(s+=c),r=r.next}while(void 0!==r);if(!i&&0!==s.length)return s}},t.registerStyles=o},151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(152),o=n(154),a=n(137);function s(e){return e&&e.__esModule?e:{default:e}}var r=s(i),c=s(o),l=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},g=s(a).default((function(e){return d(e)?e:e.replace(l,"-$&").toLowerCase()})),m=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,n){return f={name:t,styles:n,next:f},t}))}return 1===c.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function b(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return f={name:n.name,styles:n.styles,next:f},n.name;if(void 0!==n.styles){var i=n.next;if(void 0!==i)for(;void 0!==i;)f={name:i.name,styles:i.styles,next:f},i=i.next;return n.styles+";"}return function(e,t,n){var i="";if(Array.isArray(n))for(var o=0;o<n.length;o++)i+=b(e,t,n[o])+";";else for(var a in n){var s=n[a];if("object"!=typeof s)null!=t&&void 0!==t[s]?i+=a+"{"+t[s]+"}":p(s)&&(i+=g(a)+":"+m(a,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var r=b(e,t,s);switch(a){case"animation":case"animationName":i+=g(a)+":"+r+";";break;default:i+=a+"{"+r+"}"}}else for(var c=0;c<s.length;c++)p(s[c])&&(i+=g(a)+":"+m(a,s[c])+";")}return i}(e,t,n);case"function":if(void 0!==e){var o=f,a=n(e);return f=o,b(e,t,a)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var f,j=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var i=!0,o="";f=void 0;var a=e[0];null==a||void 0===a.raw?(i=!1,o+=b(n,t,a)):o+=a[0];for(var s=1;s<e.length;s++)o+=b(n,t,e[s]),i&&(o+=a[s]);j.lastIndex=0;for(var c,l="";null!==(c=j.exec(o));)l+="-"+c[1];return{name:r.default(o)+l,styles:o,next:f}}},152:function(e,t,n){"use strict";e.exports=n(153)},153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,i=0,o=e.length;o>=4;++i,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(i+2))<<16;case 2:n^=(255&e.charCodeAt(i+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(i)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},154:function(e,t,n){"use strict";e.exports=n(155)},155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},168:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i=n(128);const o=[],a="searchBarParams",s=Object.values(i.a).filter((e=>e!==i.a.SIEM))},194:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n(1);var i=n(10),o=n(2),a=n(24),s=n(3),r=n(14),c=(n(227),n(0));const l=e=>({isEnabled:!1,message:o.i18n.translate("xpack.triggersActionsUI.checkActionTypeEnabled.actionTypeDisabledByLicenseMessage",{defaultMessage:"This connector requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(i.upperFirst)(e.minimumLicenseRequired)}}),messageCard:Object(c.jsx)(s.EuiCard,{titleSize:"xs",title:o.i18n.translate("xpack.triggersActionsUI.licenseCheck.actionTypeDisabledByLicenseMessageTitle",{defaultMessage:"This feature requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(i.upperFirst)(e.minimumLicenseRequired)}}),description:o.i18n.translate("xpack.triggersActionsUI.licenseCheck.actionTypeDisabledByLicenseMessageDescription",{defaultMessage:"To re-enable this action, please upgrade your license."}),className:"actCheckActionTypeEnabled__disabledActionWarningCard",children:Object(c.jsx)(s.EuiLink,{href:r.VIEW_LICENSE_OPTIONS_LINK,target:"_blank"},Object(c.jsx)(a.FormattedMessage,{defaultMessage:"View license options",id:"xpack.triggersActionsUI.licenseCheck.actionTypeDisabledByLicenseLinkTitle"}))})}),u={isEnabled:!1,message:o.i18n.translate("xpack.triggersActionsUI.checkActionTypeEnabled.actionTypeDisabledByConfigMessage",{defaultMessage:"This connector is disabled by the Kibana configuration."}),messageCard:Object(c.jsx)(s.EuiCard,{title:o.i18n.translate("xpack.triggersActionsUI.licenseCheck.actionTypeDisabledByConfigMessageTitle",{defaultMessage:"This feature is disabled by the Kibana configuration."}),description:"",className:"actCheckActionTypeEnabled__disabledActionWarningCard"})};function d(e){return!1===(null==e?void 0:e.enabledInLicense)?l(e):!1===(null==e?void 0:e.enabledInConfig)?u:{isEnabled:!0}}function p(e,t){return!1===(null==e?void 0:e.enabledInLicense)?l(e):!1!==(null==e?void 0:e.enabledInConfig)||t.find((t=>t.actionTypeId===e.id))?{isEnabled:!0}:u}},197:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i=(e,t,n,i=[])=>{const o=n[t.actionTypeId];return e.filter((e=>(i.includes(e.actionTypeId)||e.actionTypeId===t.actionTypeId)&&((null==o?void 0:o.enabledInConfig)||e.isPreconfigured)))}},205:function(e,t,n){"use strict";n.r(t),n.d(t,"AlertsSearchBar",(function(){return h})),n.d(t,"default",(function(){return h}));var i=n(12),o=n.n(i),a=n(1),s=n(31),r=n(95),c=n(128);const l=e=>"items"in e;var u=n(168),d=n(2);const p=d.i18n.translate("xpack.triggersActionsUI.alertsSearchBar.placeholder",{defaultMessage:"Search alerts (e.g. kibana.alert.evaluation.threshold > 75)"});var g=n(4),m=n(157);const b=[];var f=n(57),j=n(0);const y={type:"alerts",fields:{}};function h({appName:e,disableQueryLanguageSwitcher:t=!1,featureIds:n,ruleTypeId:i,query:h,filters:x,quickFilters:O=[],onQueryChange:v,onQuerySubmit:A,onFiltersUpdated:I,rangeFrom:T,rangeTo:E,showFilterBar:F=!1,showDatePicker:C=!0,showSubmitButton:S=!0,placeholder:w=p,submitOnBlur:k=!1,filtersForSuggestions:M,...U}){var _;const{unifiedSearch:{ui:{SearchBar:N}}}=Object(s.useKibana)().services,[W,P]=Object(a.useState)("kuery"),{dataViews:D,loading:B}=function(e){const{http:t,data:n,notifications:{toasts:i}}=Object(s.useKibana)().services,[o,r]=Object(a.useState)(void 0),l=e.sort().join(","),u=1===e.length&&e.includes(c.a.SIEM),p=e.length>1&&e.includes(c.a.SIEM),b=e.length>0&&!u&&!p,f=()=>{i.addDanger(d.i18n.translate("xpack.triggersActionsUI.useAlertDataView.useAlertDataMessage",{defaultMessage:"Unable to load alert data view"}))},{data:j,isSuccess:y,isInitialLoading:h,isLoading:x}=Object(g.useQuery)({queryKey:["loadAlertIndexNames",l],queryFn:()=>async function({http:e,features:t}){const{index_name:n=[]}=await e.get(`${m.a}/index`,{query:{features:t}});return n}({http:t,features:l}),onError:f,refetchOnWindowFocus:!1,enabled:e.length>0&&!p}),{data:O,isSuccess:v,isInitialLoading:A,isLoading:I}=Object(g.useQuery)({queryKey:["loadAlertFields",l],queryFn:()=>async function({http:e,featureIds:t}){const{fields:n=[]}=await e.get(`${m.a}/browser_fields`,{query:{featureIds:t}});return n}({http:t,featureIds:e}),onError:f,refetchOnWindowFocus:!1,enabled:b});return Object(a.useEffect)((()=>()=>{null==o||o.map((e=>{n.dataViews.clearInstanceCache(e.id)}))}),[o]),Object(a.useEffect)((()=>{u&&y&&async function(){const e=await n.dataViews.create({title:(null!=j?j:[]).join(","),allowNoIndex:!0});r([e])}()}),[n.dataViews,j,y,u]),Object(a.useEffect)((()=>{var e;j&&O&&!u&&v&&y&&r([{title:(null!=j?j:[]).join(","),fieldFormatMap:{},fields:null===(e=null!=O?O:[])||void 0===e?void 0:e.map((e=>({...e,...e.esTypes&&e.esTypes.includes("flattened")?{type:"string"}:{}})))}])}),[O,n.dataViews,j,y,u,v]),Object(a.useMemo)((()=>({dataViews:o,loading:0!==e.length&&!p&&(u?h||x:h||x||A||I)})),[o,e.length,p,u,h,x,A,I])}(null!=n?n:[]),{aadFields:R,loading:z}=function(e){const{http:t,notifications:{toasts:n}}=Object(s.useKibana)().services,{data:i=b,isInitialLoading:o,isLoading:r}=Object(g.useQuery)({queryKey:["loadAlertAadFieldsPerRuleType",e],queryFn:()=>async function({http:e,ruleTypeId:t}){return t?await e.get(`${m.a}/aad_fields`,{query:{ruleTypeId:t}}):b}({http:t,ruleTypeId:e}),onError:()=>{n.addDanger(d.i18n.translate("xpack.triggersActionsUI.useRuleAADFields.errorMessage",{defaultMessage:"Unable to load alert fields per rule type"}))},refetchOnWindowFocus:!1,enabled:void 0!==e});return Object(a.useMemo)((()=>({aadFields:i,loading:void 0!==e&&(o||r)})),[i,o,r,e])}(i),G=i&&null!=R&&R.length?[{title:i,fields:R}]:D,q=Object(f.a)({filteredRuleTypes:void 0!==i?[i]:[],enabled:void 0!==i}),L=n&&1===n.length&&n.includes(c.a.SIEM)||q&&i&&(null===(_=q.ruleTypesState.data.get(i))||void 0===_?void 0:_.producer)===c.a.SIEM,$=Object(a.useCallback)((({dateRange:e,query:t},n)=>{var i;A({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0},n),P(null!==(i=null==t?void 0:t.language)&&void 0!==i?i:"kuery")}),[A,P]),V=Object(a.useCallback)((({dateRange:e,query:t})=>{var n;null==v||v({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0}),P(null!==(n=null==t?void 0:t.language)&&void 0!==n?n:"kuery")}),[v,P]),Q=Object(a.useMemo)((()=>{if(F&&O.length>0){const e=[],t=n=>{if(l(n)){var i;const o=`quick-filters-panel-${e.length}`;return e.push({id:o,title:n.title,items:n.items.map(t),"data-test-subj":o}),{name:n.title,icon:null!==(i=n.icon)&&void 0!==i?i:"filterInCircle",panel:o,"data-test-subj":`quick-filters-item-${n.title}`}}{var o;const{filter:e,...t}=n;return{...t,icon:null!==(o=n.icon)&&void 0!==o?o:"filterInCircle",onClick:()=>{null!=x&&x.some((t=>Object(r.compareFilters)(t,e)))||null==I||I([...null!=x?x:[],e])},"data-test-subj":`quick-filters-item-${n.name}`}}};return{items:O.map(t),panels:e}}return{items:[],panels:[]}}),[x,I,O,F]);return Object(j.jsx)(N,o()({appName:e,disableQueryLanguageSwitcher:t,indexPatterns:B||z?u.c:G,placeholder:w,query:{query:null!=h?h:"",language:W},filters:x,additionalQueryBarMenuItems:Q,dateRangeFrom:T,dateRangeTo:E,displayStyle:"inPage",showFilterBar:F,onQuerySubmit:$,onFiltersUpdated:I,onRefresh:({dateRange:e})=>{A({dateRange:e})},showDatePicker:C,showQueryInput:!0,saveQueryMenuVisibility:"allowed_by_app_privilege",showSubmitButton:S,submitOnBlur:k,onQueryChange:V,suggestionsAbstraction:L?void 0:y,filtersForSuggestions:M},U))}},212:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(3),o=n(1),a=n.n(o),s=n(2),r=n(197),c=n(0);const l=a.a.memo(u);function u({allowGroupConnector:e,actionItem:t,accordionIndex:n,actionTypesIndex:a,actionTypeRegistered:s,connectors:l,onConnectorSelected:u}){var g;const m=Object(o.useMemo)((()=>Object(r.a)(l,t,a,e)),[t,a,e,l]),f=Object(o.useMemo)((()=>d(t.id,m,s,e)),[t.id,m,s,e]),j=Object(o.useMemo)((()=>p(m,s)),[m,s]),[y,h]=Object(o.useState)(f.length>0?f[0]:void 0),x=Object(o.useCallback)((e=>{var t,n;h(e[0]),u(null!==(t=null===(n=e[0].value)||void 0===n?void 0:n.id)&&void 0!==t?t:"")}),[u]);return Object(c.jsx)(i.EuiComboBox,{"aria-label":b,"data-test-subj":`selectActionConnector-${t.actionTypeId}-${n}`,fullWidth:!0,singleSelection:{asPlainText:!0},id:`selectActionConnector-${t.id}`,isClearable:!1,onChange:x,options:j,selectedOptions:f,prepend:null==y||null===(g=y.value)||void 0===g?void 0:g.prependComponent})}const d=(e,t,n,i=[])=>{const o=t.find((t=>t.id===e));return o?[g(o,n)]:[]},p=(e,t)=>e.map((e=>g(e,t))),g=(e,t)=>{const n=m(e,t);let i;if(null!=t.customConnectorSelectItem){const n=t.customConnectorSelectItem.getComponent(e);n&&(i=Object(c.jsx)(n,{actionConnector:e}))}return{label:n,value:{title:n,id:e.id,prependComponent:i},key:e.id,"data-test-subj":`dropdown-connector-${e.id}`}},m=(e,t)=>null!=t.customConnectorSelectItem?t.customConnectorSelectItem.getText(e):e.name,b=s.i18n.translate("xpack.triggersActionsUI.sections.actionForm.incidentManagementSystemLabel",{defaultMessage:"Incident management system"})},226:function(e,t,n){"use strict";function i(e,t,n){const i=o(e,n),a=o(t,n);return!0===i&&!1===a?-1:!1===i&&!0===a?1:e.name.localeCompare(t.name)}n.d(t,"a",(function(){return i}));const o=(e,t)=>{let n=e.enabled;return!e.enabledInConfig&&t&&t.length>0&&(n=void 0!==t.find((t=>t.actionTypeId===e.id))),n}},227:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(228);case"v8light":return n(230)}},228:function(e,t,n){var i=n(54),o=n(229);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);i(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},229:function(e,t,n){(t=n(55)(!1)).push([e.i,".actAccordionActionForm,.actCheckActionTypeEnabled__disabledActionWarningCard{background-color:#25262e}.actAccordionActionForm .euiCard{box-shadow:none}.actAccordionActionForm__button{padding:12px 12px 12px 24px}.actAccordionActionForm .euiAccordion__arrow{transform:translateX(12px) rotate(0deg)!important}.actAccordionActionForm .euiAccordion__arrow[aria-expanded=true]{transform:translateX(12px) rotate(90deg)!important}",""]),e.exports=t},230:function(e,t,n){var i=n(54),o=n(231);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);i(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},231:function(e,t,n){(t=n(55)(!1)).push([e.i,".actAccordionActionForm,.actCheckActionTypeEnabled__disabledActionWarningCard{background-color:#f5f7fa}.actAccordionActionForm .euiCard{box-shadow:none}.actAccordionActionForm__button{padding:12px 12px 12px 24px}.actAccordionActionForm .euiAccordion__arrow{transform:translateX(12px) rotate(0deg)!important}.actAccordionActionForm .euiAccordion__arrow[aria-expanded=true]{transform:translateX(12px) rotate(90deg)!important}",""]),e.exports=t},263:function(e,t,n){"use strict";e.exports=n(264)},264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(265);n(97),n(148),n(147);var o=i.default({key:"css"}),a=o.flush,s=o.hydrate,r=o.cx,c=o.merge,l=o.getRegisteredStyles,u=o.injectGlobal,d=o.keyframes,p=o.css,g=o.sheet,m=o.cache;t.cache=m,t.css=p,t.cx=r,t.flush=a,t.getRegisteredStyles=l,t.hydrate=s,t.injectGlobal=u,t.keyframes=d,t.merge=c,t.sheet=g},265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(97),o=n(148),a=n(147);function s(e){return e&&e.__esModule?e:{default:e}}var r=s(i);function c(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function l(e,t,n){var i=[],o=a.getRegisteredStyles(e,i,n);return i.length<2?n:o+t(i)}var u=function e(t){for(var n="",i=0;i<t.length;i++){var o=t[i];if(null!=o){var a=void 0;switch(typeof o){case"boolean":break;case"object":if(Array.isArray(o))a=e(o);else for(var s in a="",o)o[s]&&s&&(a&&(a+=" "),a+=s);break;default:a=o}a&&(n&&(n+=" "),n+=a)}}return n};t.default=function(e){var t=r.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s=o.serializeStyles(n,t.registered,void 0);return a.insertStyles(t,s,!1),t.key+"-"+s.name};return{css:n,cx:function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return l(t.registered,n,u(i))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=o.serializeStyles(n,t.registered);c(t,a)},keyframes:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=o.serializeStyles(n,t.registered),s="animation-"+a.name;return c(t,{name:a.name,styles:"@keyframes "+s+"{"+a.styles+"}"}),s},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:a.getRegisteredStyles.bind(null,t.registered),merge:l.bind(null,t.registered,n)}}},266:function(e,t,n){var i,o,a,s;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */s=function(e){var t=Object.prototype.toString,n=Array.isArray||function(e){return"[object Array]"===t.call(e)};function i(e){return"function"==typeof e}function o(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function a(e,t){return null!=e&&"object"==typeof e&&t in e}var s=RegExp.prototype.test,r=/\S/;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},l=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,g=/#|\^|\/|>|\{|&|=|!/;function m(e){this.string=e,this.tail=e,this.pos=0}function b(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function f(){this.cache={}}m.prototype.eos=function(){return""===this.tail},m.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},m.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},b.prototype.push=function(e){return new b(e,this)},b.prototype.lookup=function(e){var t,n=this.cache;if(n.hasOwnProperty(e))t=n[e];else{for(var o,s,r=this,c=!1;r;){if(e.indexOf(".")>0)for(t=r.view,o=e.split("."),s=0;null!=t&&s<o.length;)s===o.length-1&&(c=a(t,o[s])),t=t[o[s++]];else t=r.view[e],c=a(r.view,e);if(c)break;r=r.parent}n[e]=t}return i(t)&&(t=t.call(this.view)),t},f.prototype.clearCache=function(){this.cache={}},f.prototype.parse=function(t,i){var a=this.cache,c=a[t];return null==c&&(c=a[t]=function(t,i){if(!t)return[];var a,c,b,f,j=[],y=[],h=[],x=!1,O=!1;function v(){if(x&&!O)for(;h.length;)delete y[h.pop()];else h=[];x=!1,O=!1}function A(e){if("string"==typeof e&&(e=e.split(u,2)),!n(e)||2!==e.length)throw new Error("Invalid tags: "+e);a=new RegExp(o(e[0])+"\\s*"),c=new RegExp("\\s*"+o(e[1])),b=new RegExp("\\s*"+o("}"+e[1]))}A(i||e.tags);for(var I,T,E,F,C,S,w=new m(t);!w.eos();){if(I=w.pos,E=w.scanUntil(a))for(var k=0,M=E.length;k<M;++k)f=F=E.charAt(k),function(e,t){return s.call(e,t)}(r,f)?O=!0:h.push(y.length),y.push(["text",F,I,I+1]),I+=1,"\n"===F&&v();if(!w.scan(a))break;if(x=!0,T=w.scan(g)||"name",w.scan(l),"="===T?(E=w.scanUntil(d),w.scan(d),w.scanUntil(c)):"{"===T?(E=w.scanUntil(b),w.scan(p),w.scanUntil(c),T="&"):E=w.scanUntil(c),!w.scan(c))throw new Error("Unclosed tag at "+w.pos);if(C=[T,E,I,w.pos],y.push(C),"#"===T||"^"===T)j.push(C);else if("/"===T){if(!(S=j.pop()))throw new Error('Unopened section "'+E+'" at '+I);if(S[1]!==E)throw new Error('Unclosed section "'+S[1]+'" at '+I)}else"name"===T||"{"===T||"&"===T?O=!0:"="===T&&A(E)}if(S=j.pop())throw new Error('Unclosed section "'+S[1]+'" at '+w.pos);return function(e){for(var t,n=[],i=n,o=[],a=0,s=e.length;a<s;++a)switch((t=e[a])[0]){case"#":case"^":i.push(t),o.push(t),i=t[4]=[];break;case"/":o.pop()[5]=t[2],i=o.length>0?o[o.length-1][4]:n;break;default:i.push(t)}return n}(function(e){for(var t,n,i=[],o=0,a=e.length;o<a;++o)(t=e[o])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(i.push(t),n=t));return i}(y))}(t,i)),c},f.prototype.render=function(e,t,n){var i=this.parse(e),o=t instanceof b?t:new b(t);return this.renderTokens(i,o,n,e)},f.prototype.renderTokens=function(e,t,n,i){for(var o,a,s,r="",c=0,l=e.length;c<l;++c)s=void 0,"#"===(a=(o=e[c])[0])?s=this.renderSection(o,t,n,i):"^"===a?s=this.renderInverted(o,t,n,i):">"===a?s=this.renderPartial(o,t,n,i):"&"===a?s=this.unescapedValue(o,t):"name"===a?s=this.escapedValue(o,t):"text"===a&&(s=this.rawValue(o)),void 0!==s&&(r+=s);return r},f.prototype.renderSection=function(e,t,o,a){var s=this,r="",c=t.lookup(e[1]);if(c){if(n(c))for(var l=0,u=c.length;l<u;++l)r+=this.renderTokens(e[4],t.push(c[l]),o,a);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)r+=this.renderTokens(e[4],t.push(c),o,a);else if(i(c)){if("string"!=typeof a)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(t.view,a.slice(e[3],e[5]),(function(e){return s.render(e,t,o)})))&&(r+=c)}else r+=this.renderTokens(e[4],t,o,a);return r}},f.prototype.renderInverted=function(e,t,i,o){var a=t.lookup(e[1]);if(!a||n(a)&&0===a.length)return this.renderTokens(e[4],t,i,o)},f.prototype.renderPartial=function(e,t,n){if(n){var o=i(n)?n(e[1]):n[e[1]];return null!=o?this.renderTokens(this.parse(o),t,n,o):void 0}},f.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},f.prototype.escapedValue=function(t,n){var i=n.lookup(t[1]);if(null!=i)return e.escape(i)},f.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var j=new f;return e.clearCache=function(){return j.clearCache()},e.parse=function(e,t){return j.parse(e,t)},e.render=function(e,t,i){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(o=e)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return j.render(e,t,i)},e.to_html=function(t,n,o,a){var s=e.render(t,n,o);if(!i(a))return s;a(s)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return c[e]}))},e.Scanner=m,e.Context=b,e.Writer=f,e},t&&"string"!=typeof t.nodeName?s(t):(o=[t],void 0===(a="function"==typeof(i=s)?i.apply(t,o):i)||(e.exports=a))},85:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionForm",(function(){return re})),n.d(t,"default",(function(){return re}));var i=n(1),o=n.n(i),a=n(2),s=n(24),r=n(3),c=n(112),l=n(50),u=n(21),d=n(59),p=n(128),g=n(10),m=n(104),b=n(34),f=n(19),j=n(194),y=n(131),h=n(67),x=n(29),O=n(212),v=n(11),A=n(263),I=n(159),T=n(146),E=n(51),F=n(14),C=n(0);const S=[{isSummaryOption:!1,isForEachAlertOption:!0,value:{value:"onActionGroupChange",inputDisplay:a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActionGroupChange.display",{defaultMessage:"On status changes"}),"data-test-subj":"onActionGroupChange",dropdownDisplay:Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)("strong",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"On status changes",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActionGroupChange.label"})),Object(C.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(C.jsx)("p",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"Actions run if the alert status changes.",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActionGroupChange.description"}))))}},{isSummaryOption:!0,isForEachAlertOption:!0,value:{value:"onActiveAlert",inputDisplay:a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActiveAlert.display",{defaultMessage:"On check intervals"}),"data-test-subj":"onActiveAlert",dropdownDisplay:Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)("strong",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"On check intervals",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActiveAlert.label"})),Object(C.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(C.jsx)("p",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"Actions run if rule conditions are met.",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onActiveAlert.description"}))))}},{isSummaryOption:!0,isForEachAlertOption:!0,value:{value:"onThrottleInterval",inputDisplay:a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onThrottleInterval.display",{defaultMessage:"On custom action intervals"}),"data-test-subj":"onThrottleInterval",dropdownDisplay:Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)("strong",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"On custom action intervals",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onThrottleInterval.label"})),Object(C.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(C.jsx)("p",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"Actions run if rule conditions are met.",id:"xpack.triggersActionsUI.sections.ruleForm.ruleNotifyWhen.onThrottleInterval.description"}))))}}],w=({hasAlertsMappings:e,frequency:t=F.DEFAULT_FREQUENCY,throttle:n,throttleUnit:s,onNotifyWhenChange:c,onThrottleChange:l,onSummaryChange:u,showMinimumThrottleWarning:d,showMinimumThrottleUnitWarning:p,notifyWhenSelectOptions:g=S,defaultNotifyWhenValue:m=F.DEFAULT_FREQUENCY.notifyWhen})=>{const[b,f]=Object(i.useState)(!1),[j,y]=Object(i.useState)(m),[h,x]=Object(i.useState)(!1);Object(i.useEffect)((()=>{t.notifyWhen?y(t.notifyWhen):y(t.throttle?v.RuleNotifyWhen.THROTTLE:v.RuleNotifyWhen.ACTIVE)}),[t]),Object(i.useEffect)((()=>{f(j===v.RuleNotifyWhen.THROTTLE)}),[j]);const O=Object(i.useCallback)((e=>{c(e),y(e),setTimeout((()=>l(e===v.RuleNotifyWhen.THROTTLE?null!=n?n:1:null,s)),100)}),[c,l,n,s]),w=Object(i.useMemo)((()=>g.filter((e=>e.isSummaryOption)).map((e=>e.value))),[g]),U=Object(i.useMemo)((()=>g.filter((e=>e.isForEachAlertOption)).map((e=>e.value))),[g]),_=Object(i.useMemo)((()=>t.summary?w:U),[U,t.summary,w]),N=Object(i.useCallback)((e=>e&&!w.filter((e=>e.value===t.notifyWhen)).length||!e&&!U.filter((e=>e.value===t.notifyWhen)).length),[U,t.notifyWhen,w]),W=Object(i.useCallback)((e=>e?w.length?w[0].value:v.RuleNotifyWhen.ACTIVE:U.length?U[0].value:v.RuleNotifyWhen.ACTIVE),[U,w]),P=Object(i.useCallback)((e=>{u(e),x(!1),N(e)&&c(W(e))}),[u,N,c,W]),{euiTheme:D}=Object(r.useEuiTheme)(),B=Object(i.useMemo)((()=>Object(A.css)("min-width:300px;padding:",D.size.s,";","")),[D]),R=Object(i.useMemo)((()=>[Object(C.jsx)(r.EuiContextMenuItem,{key:"summary",onClick:()=>P(!0),icon:t.summary?"check":"empty",id:"actionNotifyWhen-option-summary","data-test-subj":"actionNotifyWhen-option-summary",className:B},M),Object(C.jsx)(r.EuiContextMenuItem,{key:"for_each",onClick:()=>P(!1),icon:t.summary?"empty":"check",id:"actionNotifyWhen-option-for_each","data-test-subj":"actionNotifyWhen-option-for_each",className:B},k)]),[t.summary,P,B]),z=Object(C.jsx)(r.EuiPopover,{"data-test-subj":"summaryOrPerRuleSelect",initialFocus:"#actionNotifyWhen-option-"+(t.summary?"summary":"for_each"),isOpen:h,closePopover:Object(i.useCallback)((()=>x(!1)),[x]),panelPaddingSize:"none",anchorPosition:"downLeft","aria-label":t.summary?M:k,"aria-roledescription":a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.actionNotifyWhen.summaryOrRulePerSelectRoleDescription",{defaultMessage:"Action frequency type select"}),button:Object(C.jsx)(r.EuiButtonEmpty,{size:"xs",iconType:"arrowDown",iconSide:"right",onClick:Object(i.useCallback)((()=>x(!h)),[h])},t.summary?M:k)},Object(C.jsx)(r.EuiContextMenuPanel,{items:R}));return Object(C.jsx)(r.EuiFormRow,{fullWidth:!0,label:a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.actionNotifyWhen.actionFrequencyLabel",{defaultMessage:"Action frequency"})},Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(C.jsx)(r.EuiFlexItem,null,Object(C.jsx)(r.EuiSuperSelect,{fullWidth:!0,prepend:e?z:Object(C.jsx)(o.a.Fragment,null),"data-test-subj":"notifyWhenSelect",options:_,valueOfSelected:j,onChange:O}),b&&Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)(r.EuiFormRow,{fullWidth:!0},Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(C.jsx)(r.EuiFlexItem,{style:{flexGrow:.1}}),Object(C.jsx)(r.EuiFlexItem,{grow:2},Object(C.jsx)(r.EuiFieldNumber,{isInvalid:d,min:1,value:null!=n?n:1,name:"throttle","data-test-subj":"throttleInput",prepend:a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.frequencyNotifyWhen.label",{defaultMessage:"Run every"}),onChange:e=>{Object(T.pipe)(Object(I.some)(e.target.value.trim()),Object(I.filter)((e=>""!==e)),Object(I.map)((e=>parseInt(e,10))),Object(I.filter)((e=>!isNaN(e))),Object(I.map)((e=>{l(e,s)})))}})),Object(C.jsx)(r.EuiFlexItem,{grow:3},Object(C.jsx)(r.EuiSelect,{isInvalid:p,"data-test-subj":"throttleUnitInput",value:s,options:Object(E.b)(null!=n?n:1),onChange:e=>{l(n,e.target.value)}})))),(d||p)&&Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSpacer,{size:"xs"}),Object(C.jsx)(r.EuiText,{size:"xs",color:"danger"},a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.notifyWhenThrottleWarning",{defaultMessage:"Custom action intervals cannot be shorter than the rule's check interval"})))))))},k=a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.actionNotifyWhen.forEachOption",{defaultMessage:"For each alert"}),M=a.i18n.translate("xpack.triggersActionsUI.sections.ruleForm.actionNotifyWhen.summaryOption",{defaultMessage:"Summary of alerts"});var U=n(266),_=n.n(U);const N=a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.warning.publicBaseUrl",{defaultMessage:"server.publicBaseUrl is not set. Generated URLs will be either relative or empty."});function W(e,t,n){if(!t&&e&&"string"==typeof e){const t=(n||[]).reduce(((e,t)=>(t.usesPublicBaseUrl&&(e.push(t.name.replace(/^(params\.|context\.|state\.)/,"")),e.push(t.name)),e)),new Array);try{const n=new Set(_.a.parse(e).filter((([e])=>"name"===e)).map((([,e])=>e)));if(Object(g.some)(t,(e=>n.has(e))))return N}catch(e){return N}}return null}var P,D,B=n(33),R=n.n(B),z=n(31),G=n(63),q=n.n(G);const L=null!==(P=null===(D=R.a.tz)||void 0===D?void 0:D.names().map((e=>({label:e}))))&&void 0!==P?P:[{label:"UTC"}],$=({state:e,onChange:t})=>{const n=(()=>{var e,t;const n=null!==(e=Object(z.useUiSetting)("dateFormat:scaled"))&&void 0!==e?e:[["PT1M","HH:mm"]],[,i]=null!==(t=n.find((([e])=>"PT1M"===e)))&&void 0!==t?t:["","HH:mm"];return i})(),[s,c]=(e=>{const t={days:[],timezone:(()=>{var e,t;const n=Object(z.useUiSetting)("dateFormat:tz");return n&&"Browser"!==n?n:null!==(e=null===(t=R.a.tz)||void 0===t?void 0:t.guess())&&void 0!==e?e:"UTC"})(),hours:{start:"00:00",end:"00:00"}};return Object(i.useState)(e||t)})(e),[l,u]=Object(i.useState)([{label:s.timezone}]),d=Object(i.useMemo)((()=>Boolean(e)),[e]),p=(()=>{const e=Object(z.useUiSetting)("dateFormat:dow"),t=null!=e?e:"Sunday",n=F.I18N_WEEKDAY_OPTIONS_DDD.findIndex((e=>e.label.startsWith(t)));return[...F.I18N_WEEKDAY_OPTIONS_DDD.slice(n),...F.I18N_WEEKDAY_OPTIONS_DDD.slice(0,n)]})();Object(i.useEffect)((()=>{const n=d?s:void 0;q()(e,n)||t(n)}),[d,s,e,t]);const g=Object(i.useCallback)((()=>t(e?void 0:s)),[e,s,t]),m=Object(i.useCallback)((e=>{c({...s,...e})}),[s,c]),b=Object(i.useCallback)((e=>t=>{m({hours:{...s.hours,[e]:t.format("HH:mm")}})}),[m,s]),f=Object(i.useCallback)((e=>{if(!s)return;const t=Number(e),n=s.days.includes(t)?s.days.filter((e=>e!==t)):[...s.days,t];0!==n.length&&m({days:n})}),[s,m]),j=Object(i.useMemo)((()=>v.ISO_WEEKDAYS.reduce(((e,t)=>({...e,[t]:s.days.includes(t)})),{})),[s]),y=Object(i.useCallback)((e=>{u(e),e[0].label&&m({timezone:e[0].label})}),[m,u]),[h,x]=Object(i.useMemo)((()=>s.hours.start.split(":").map(Number)),[s]),[O,A]=Object(i.useMemo)((()=>s.hours.end.split(":").map(Number)),[s]);return Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSwitch,{label:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.ActionAlertsFilterTimeframeToggleLabel",{defaultMessage:"If alert is generated during timeframe"}),checked:d,onChange:g,"data-test-subj":"alertsFilterTimeframeToggle"}),d&&Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)(r.EuiFlexItem,null,Object(C.jsx)(r.EuiButtonGroup,{isFullWidth:!0,legend:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.ActionAlertsFilterTimeframeWeekdays",{defaultMessage:"Days of week"}),options:p,idToSelectedMap:j,type:"multi",onChange:f,"data-test-subj":"alertsFilterTimeframeWeekdayButtons"})),Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(C.jsx)(r.EuiFlexItem,{grow:2},Object(C.jsx)(r.EuiDatePickerRange,{fullWidth:!0,startDateControl:Object(C.jsx)(r.EuiDatePicker,{showTimeSelect:!0,showTimeSelectOnly:!0,dateFormat:n,timeFormat:n,selected:R()().set("hour",h).set("minute",x),onChange:b("start"),"data-test-subj":"alertsFilterTimeframeStart"}),endDateControl:Object(C.jsx)(r.EuiDatePicker,{showTimeSelect:!0,showTimeSelectOnly:!0,dateFormat:n,timeFormat:n,selected:R()().set("hour",O).set("minute",A),onChange:b("end"),"data-test-subj":"alertsFilterTimeframeEnd"})})),Object(C.jsx)(r.EuiFlexItem,{grow:1},Object(C.jsx)(r.EuiComboBox,{prepend:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.ActionAlertsFilterTimeframeTimezoneLabel",{defaultMessage:"Timezone"}),singleSelection:{asPlainText:!0},options:L,selectedOptions:l,onChange:y,isClearable:!1,"data-test-subj":"alertsFilterTimeframeTimezone"})))))};var V=n(205);const Q=({state:e,onChange:t,appName:n,featureIds:s,ruleTypeId:c})=>{var l;const[u,d]=Object(i.useState)(null!=e?e:{kql:"",filters:[]}),p=Object(i.useMemo)((()=>Boolean(e)),[e]);Object(i.useEffect)((()=>{const n=p?u:void 0;q()(e,n)||t(n)}),[p,u,e,t]);const g=Object(i.useCallback)((()=>t(e?void 0:u)),[e,u,t]),m=Object(i.useCallback)((e=>{d({...u,...e})}),[u,d]),b=Object(i.useCallback)((({query:e})=>m({kql:e})),[m]),f=Object(i.useCallback)((e=>m({filters:e})),[m]);return Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSwitch,{label:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.ActionAlertsFilterQueryToggleLabel",{defaultMessage:"If alert matches a query"}),checked:p,onChange:g,"data-test-subj":"alertsFilterQueryToggle"}),p&&Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)(V.AlertsSearchBar,{appName:n,featureIds:s,ruleTypeId:c,disableQueryLanguageSwitcher:!0,query:u.kql,filters:null!==(l=u.filters)&&void 0!==l?l:[],onQueryChange:b,onQuerySubmit:b,onFiltersUpdated:f,showFilterBar:!0,submitOnBlur:!0,showDatePicker:!1,showSubmitButton:!1,placeholder:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.ActionAlertsFilterQueryPlaceholder",{defaultMessage:"Filter alerts using KQL syntax"})})))};var K=n(60),H=n(157),Y=n(251);const X=(e,t)=>{var n,i,o,a;let s=t[e];return Object(g.isEmpty)(null!==(n=null===(i=s)||void 0===i?void 0:i.description)&&void 0!==n?n:"")&&e.includes("kibana.alert.")&&(s=t[e.replace("kibana.alert.","")]),null!==(o=null===(a=s)||void 0===a?void 0:a.description)&&void 0!==o?o:""};function Z(e,t,n){const[o,a]=Object(i.useState)(!1),[s,r]=Object(i.useState)([]);return Object(i.useEffect)((()=>{n&&0===s.length&&t&&(a(!0),async function({http:e,ruleTypeId:t}){return t&&e?await e.get(`${H.a}/aad_fields`,{query:{ruleTypeId:t}}):[]}({http:e,ruleTypeId:t}).then((e=>{r(e),a(!1)})))}),[s,n,e,t]),Object(i.useMemo)((()=>({isLoading:o,fields:s.map((e=>({name:e.name,description:X(e.name,Y.EcsFlat)})))})),[s,o])}const J=a.i18n.translate("xpack.triggersActionsUI.sections.actionForm.preconfiguredTitleMessage",{defaultMessage:"(preconfigured)"}),ee=({actionItem:e,actionConnector:t,index:n,onAddConnector:c,onConnectorSelected:u,onDeleteAction:d,setActionUseAlertDataForTemplate:v,setActionParamsProperty:A,setActionFrequencyProperty:I,setActionAlertsFilterProperty:T,actionTypesIndex:E,connectors:F,defaultActionGroupId:S,defaultActionMessage:k,messageVariables:M,summaryMessageVariables:U,actionGroups:_,setActionGroupIdByIndex:N,actionTypeRegistry:P,isActionGroupDisabledForActionType:D,recoveryActionGroup:B,hideNotifyWhen:R=!1,defaultSummaryMessage:z,hasAlertsMappings:G,minimumThrottleInterval:q,notifyWhenSelectOptions:L,defaultNotifyWhenValue:V,producerId:H,featureId:Y,ruleTypeId:X,hasFieldsForAAD:ee,disableErrorMessages:te})=>{var ne,ie,oe,ae,se,re,ce,le,ue,de,pe,ge,me,be;const{application:{capabilities:fe},http:je}=Object(x.b)().services,{euiTheme:ye}=Object(r.useEuiTheme)(),[he,xe]=Object(i.useState)(!0),[Oe,ve]=Object(i.useState)([]),Ae=null==_?void 0:_.find((({id:e})=>e===S)),Ie=null!==(ne=null==_?void 0:_.find((({id:t})=>t===e.group)))&&void 0!==ne?ne:Ae,[Te,Ee]=Object(i.useState)(),[Fe,Ce]=Object(i.useState)({errors:{}}),[Se,we]=Object(i.useState)(null!==(ie=e.frequency)&&void 0!==ie&&ie.throttle?Object(m.getDurationNumberInItsUnit)(e.frequency.throttle):null),[ke,Me]=Object(i.useState)(null!==(oe=e.frequency)&&void 0!==oe&&oe.throttle?Object(m.getDurationUnitValue)(null===(ae=e.frequency)||void 0===ae?void 0:ae.throttle):"h"),[Ue=-1,_e]=null!=q?q:[-1,"s"],[Ne,We]=Object(i.useState)(null),[Pe,De]=Object(i.useState)(!1),Be=null===(se=e.frequency)||void 0===se?void 0:se.summary,[Re,ze]=Object(i.useState)(null!==(re=null==e?void 0:e.useAlertDataForTemplate)&&void 0!==re&&re),[Ge,qe]=Object(i.useState)({}),{fields:Le}=Z(je,X,Re),$e=Object(i.useMemo)((()=>Re?Le:Oe),[Le,Oe,Re]);let Ve;try{Ve=Object(b.a)("showMustacheAutocompleteSwitch")&&X}catch(e){Ve=!1}const Qe=Object(i.useCallback)((()=>{ze((e=>(v&&v(!e,n),!e)));const t={...e.params};for(const e of Object.keys(t)){var i;A(e,null!==(i=Ge[e])&&void 0!==i?i:"",n)}qe(t)}),[v,Ge,qe,A,e.params,n]),Ke=async()=>{const t=await P.get(e.actionTypeId);let n;return e.group===B&&(n=t.defaultRecoveredActionParams),n||(n=t.defaultActionParams),n},[He,Ye]=Object(i.useMemo)((()=>{try{if(!Se)return[!1,!1];const e=Object(m.parseDuration)(`1${ke}`),t=Object(m.parseDuration)(`1${_e}`),n=e>t?Se:Math.max(Se,Ue),i=Object(m.parseDuration)(`${Se}${ke}`)>=t?ke:_e;return[n!==Se,i!==ke]}catch(e){return[!1,!1]}}),[Ue,_e,Se,ke]);Object(i.useEffect)((()=>{(async()=>{ve(M?function(e,t,n,i){const o=Object(h.b)(e,t,null==n?void 0:n.omitMessageVariables,i);return Object(g.partition)(o,(e=>!0!==e.deprecated)).reduce(((e,t)=>[...e,...t.sort(((e,t)=>e.name.toUpperCase().localeCompare(t.name.toUpperCase())))]),[])}(M,U,Ie,Be):[]);const t=await Ke();if(t)for(const[i,o]of Object.entries(t)){const t={};void 0!==e.params[i]&&null!==e.params[i]||(A(i,o,n),"string"==typeof o&&o.match(/{{.*?}}/g)||(t[i]=o)),qe(t)}})()}),[e.group,null===(ce=e.frequency)||void 0===ce?void 0:ce.summary]),Object(i.useEffect)((()=>{(async()=>{const e=await Ke();if(e&&Te){const t={};for(const[i,o]of Object.entries(e))A(i,o,n),o.match(/{{.*?}}/g)||(t[i]=o);qe(t)}})()}),[Te]),Object(i.useEffect)((()=>{(async t=>{if(te)return void Ce({errors:{}});const n=await(null===(t=P.get(e.actionTypeId))||void 0===t?void 0:t.validateParams(e.params));Ce(n)})()}),[e,te]);const[Xe,Ze]=Object(i.useState)(null);Object(i.useEffect)((()=>{(async()=>{Ze(te?null:Object(K.d)(e))})()}),[e,te]),Object(i.useEffect)((()=>{Object(g.isEmpty)(Ge)&&e.params.subAction&&qe(e.params)}),[e.params,Ge]);const Je=Object(y.e)(fe),et=(e,t)=>!!D&&D(e,t),tt=Object(C.jsx)(w,{frequency:e.frequency,throttle:Se,throttleUnit:ke,hasAlertsMappings:G,onNotifyWhenChange:Object(i.useCallback)((e=>{I("notifyWhen",e,n)}),[I,n]),onThrottleChange:Object(i.useCallback)(((e,t)=>{e&&(we(e),Me(t)),I("throttle",e?`${e}${t}`:null,n)}),[I,n]),onSummaryChange:Object(i.useCallback)((e=>{De(!0),I("summary",e,n)}),[I,n]),showMinimumThrottleWarning:He,showMinimumThrottleUnitWarning:Ye,notifyWhenSelectOptions:L,defaultNotifyWhenValue:V}),nt=P.get(t.actionTypeId);if(!nt)return null;const it=(null!==(le=null==nt?void 0:nt.subtype)&&void 0!==le?le:[]).map((e=>e.id)),ot=nt.actionParamsFields,at=Object(j.a)(E[t.actionTypeId],F.filter((e=>e.isPreconfigured))),st=_&&Ie&&N&&!(null!==(ue=e.frequency)&&void 0!==ue&&ue.summary),rt=ee||H===p.a.SIEM,ct=at.isEnabled?Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSplitPanel.Inner,{color:"subdued",style:{borderBottom:`1px solid ${ye.colors.lightShade}`}},Object(C.jsx)(r.EuiFormRow,{fullWidth:!0,label:Object(C.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionTypeForm.actionIdLabel",defaultMessage:"{connectorInstance} connector",values:{connectorInstance:E?E[t.actionTypeId].name:t.actionTypeId}}),labelAppend:Je&&E&&E[t.actionTypeId].enabledInConfig?Object(C.jsx)(r.EuiButtonEmpty,{size:"xs","data-test-subj":`addNewActionConnectorButton-${e.actionTypeId}`,onClick:c},Object(C.jsx)(s.FormattedMessage,{defaultMessage:"Add connector",id:"xpack.triggersActionsUI.sections.actionTypeForm.addNewConnectorEmptyButton"})):null},Object(C.jsx)(O.a,{allowGroupConnector:it,actionItem:e,accordionIndex:n,actionTypesIndex:E,actionTypeRegistered:nt,connectors:F,onConnectorSelected:u})),Object(C.jsx)(r.EuiSpacer,{size:"xl"}),!R&&tt,st&&Object(C.jsx)(o.a.Fragment,null,!R&&Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)(r.EuiSuperSelect,{prepend:Object(C.jsx)(r.EuiFormLabel,{htmlFor:`addNewActionConnectorActionGroup-${e.actionTypeId}`},Object(C.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionTypeForm.actionRunWhenInActionGroup",defaultMessage:"Run when"})),fullWidth:!0,id:`addNewActionConnectorActionGroup-${e.actionTypeId}`,"data-test-subj":`addNewActionConnectorActionGroup-${n}`,options:_.map((({id:t,name:i})=>{return{value:t,inputDisplay:(o=t,s=i,r=e.actionTypeId,D&&D(o,r)?a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.addNewActionConnectorActionGroup.display",{defaultMessage:"{actionGroupName} (Not Currently Supported)",values:{actionGroupName:s}}):s),disabled:et(t,e.actionTypeId),"data-test-subj":`addNewActionConnectorActionGroup-${n}-option-${t}`};var o,s,r})),valueOfSelected:Ie.id,onChange:e=>{N(e,n),Ee(e)}})),rt&&Object(C.jsx)(o.a.Fragment,null,!R&&Object(C.jsx)(r.EuiSpacer,{size:"xl"}),Object(C.jsx)(r.EuiFormRow,{error:Xe,isInvalid:!!Xe,fullWidth:!0},Object(C.jsx)(Q,{state:null===(de=e.alertsFilter)||void 0===de?void 0:de.query,onChange:e=>T("query",e,n),featureIds:[H],appName:Y,ruleTypeId:X})),Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)($,{state:null===(pe=e.alertsFilter)||void 0===pe?void 0:pe.timeframe,onChange:e=>T("timeframe",e,n)}))),Object(C.jsx)(r.EuiSplitPanel.Inner,{color:"plain"},ot?Object(C.jsx)(r.EuiErrorBoundary,null,Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"m",direction:"column"},Ve&&Object(C.jsx)(r.EuiFlexItem,null,Object(C.jsx)(r.EuiSwitch,{label:"Use template fields from alerts index",checked:Re,onChange:Qe,"data-test-subj":"mustacheAutocompleteSwitch"})),Object(C.jsx)(r.EuiFlexItem,null,Object(C.jsx)(i.Suspense,{fallback:null},Object(C.jsx)(ot,{actionParams:e.params,errors:Fe.errors,index:n,selectedActionGroupId:null==Ie?void 0:Ie.id,editAction:(e,t,n)=>{We(W(t,je.basePath.publicBaseUrl,Oe)),A(e,t,n)},messageVariables:$e,defaultMessage:Be?z:null!==(ge=null==Ie?void 0:Ie.defaultActionMessage)&&void 0!==ge?ge:k,useDefaultMessage:Pe,actionConnector:t,executionMode:f.b.ActionForm,ruleTypeId:X,producerId:H}),Ne?Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)(r.EuiCallOut,{size:"s",color:"warning",title:Ne})):null)))):null)):at.messageCard;return Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSplitPanel.Outer,{hasShadow:he},Object(C.jsx)(r.EuiAccordion,{initialIsOpen:!0,key:n,id:n.toString(),onToggle:xe,paddingSize:"none",className:"actAccordionActionForm",buttonContentClassName:"actAccordionActionForm__button","data-test-subj":`alertActionAccordion-${n}`,buttonContent:Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},!he&&Object(g.some)(Fe.errors,(e=>!Object(g.isEmpty)(e)))?Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiToolTip,{content:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.actionErrorToolTip",{defaultMessage:"Action contains errors."})},Object(C.jsx)(r.EuiIcon,{"data-test-subj":"action-group-error-icon",type:"warning",color:"danger",size:"m"}))):Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiIcon,{type:nt.iconClass,size:"m"})),Object(C.jsx)(r.EuiFlexItem,null,Object(C.jsx)(r.EuiText,null,Object(C.jsx)("div",null,Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(s.FormattedMessage,{defaultMessage:"{actionConnectorName}",id:"xpack.triggersActionsUI.sections.actionTypeForm.existingAlertActionTypeEditTitle",values:{actionConnectorName:`${t.name} ${t.isPreconfigured?J:""}`}})),(Ie||(null===(me=e.frequency)||void 0===me?void 0:me.summary))&&!he&&Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiBadge,{iconType:"clock"},null!==(be=e.frequency)&&void 0!==be&&be.summary?a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.summaryGroupTitle",{defaultMessage:"Summary of alerts"}):a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.runWhenGroupTitle",{defaultMessage:"Run when {groupName}",values:{groupName:Ie.name.toLocaleLowerCase()}}))),Ne&&!he&&Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiBadge,{"data-test-subj":"warning-badge",iconType:"warning",color:"warning"},a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.actionWarningsTitle",{defaultMessage:"1 warning"}))),Object(C.jsx)(r.EuiFlexItem,{grow:!1},!1===at.isEnabled&&Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiIconTip,{type:"warning",color:"danger",content:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.actionDisabledTitle",{defaultMessage:"This action is disabled"}),position:"right"}))))))),nt&&nt.isExperimental&&Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiBetaBadge,{"data-test-subj":"action-type-form-beta-badge",label:l.q,tooltipContent:l.p}))),extraAction:Object(C.jsx)(r.EuiButtonIcon,{iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:d})},ct)),Object(C.jsx)(r.EuiSpacer,{size:"l"}))};var te=n(106),ne=n(226),ie=n(20),oe=n(5);const ae=({actionItem:e,actionConnector:t,index:n,onDeleteAction:s,setActionParamsProperty:c,actionTypesIndex:l,connectors:u,defaultActionMessage:d,messageVariables:p,summaryMessageVariables:m,actionTypeRegistry:b,defaultSummaryMessage:j,producerId:y,featureId:O,ruleTypeId:v,disableErrorMessages:A})=>{var I;const{http:T}=Object(x.b)().services,[E,F]=Object(i.useState)(!0),[S,w]=Object(i.useState)({errors:{}}),[k,M]=Object(i.useState)(null),{fields:U}=Z(T,v,!0),_=Object(i.useCallback)((()=>b.get(e.actionTypeId).defaultActionParams),[e.actionTypeId,b]),N=Object(i.useMemo)((()=>p?function(e,t,n,i){const o=Object(h.b)(e,t,void 0,!0);return Object(g.partition)(o,(e=>!0!==e.deprecated)).reduce(((e,t)=>[...e,...t.sort(((e,t)=>e.name.toUpperCase().localeCompare(t.name.toUpperCase())))]),[])}(p,m):[]),[p,m]);Object(i.useEffect)((()=>{const t=_();if(t)for(const[i,o]of Object.entries(t)){const t={};void 0!==e.params[i]&&null!==e.params[i]||(c(i,o,n),"string"==typeof o&&o.match(/{{.*?}}/g)||(t[i]=o))}}),[e.params,_,n,p,c,m]),Object(i.useEffect)((()=>{const e=_();if(e){const t={};for(const[i,o]of Object.entries(e))c(i,o,n),o.match(/{{.*?}}/g)||(t[i]=o)}}),[_,n,c]),Object(i.useEffect)((()=>{(async t=>{if(A)return void w({errors:{}});const n=await(null===(t=b.get(e.actionTypeId))||void 0===t?void 0:t.validateParams(e.params));w(n)})()}),[e,A]);const P=b.get(t.actionTypeId);if(!P)return null;const D=P.actionParamsFields,B=Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSplitPanel.Inner,{color:"plain"},D?Object(C.jsx)(r.EuiErrorBoundary,null,Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"m",direction:"column"},Object(C.jsx)(r.EuiFlexItem,null,Object(C.jsx)(i.Suspense,{fallback:null},Object(C.jsx)(D,{actionParams:e.params,errors:S.errors,index:n,editAction:(e,t,n)=>{M(W(t,T.basePath.publicBaseUrl,N)),c(e,t,n)},messageVariables:U,defaultMessage:j,useDefaultMessage:!0,actionConnector:t,executionMode:f.b.ActionForm,ruleTypeId:v,producerId:y}),k?Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSpacer,{size:"s"}),Object(C.jsx)(r.EuiCallOut,{size:"s",color:"warning",title:k})):null)))):null));return Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiSplitPanel.Outer,{hasShadow:E},Object(C.jsx)(r.EuiAccordion,{initialIsOpen:!0,key:n,id:n.toString(),onToggle:F,paddingSize:"none",className:"actAccordionActionForm",buttonContentClassName:"actAccordionActionForm__button","data-test-subj":`alertActionAccordion-${n}`,buttonContent:Object(C.jsx)(se,{showActionGroupErrorIcon:!E&&Object(g.some)(S.errors,(e=>!Object(g.isEmpty)(e))),showWarning:Boolean(k&&!E),connectorName:t.name,isExperimental:Boolean(P&&P.isExperimental),iconClass:null!==(I=P.iconClass)&&void 0!==I?I:"empty"}),extraAction:Object(C.jsx)(r.EuiButtonIcon,{iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:s,"data-test-subj":"system-action-delete-button"})},B)),Object(C.jsx)(r.EuiSpacer,{size:"l"}))},se=({showActionGroupErrorIcon:e,iconClass:t,showWarning:n,isExperimental:i,connectorName:o})=>Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},e?Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiToolTip,{content:a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.actionErrorToolTip",{defaultMessage:"Action contains errors."})},Object(C.jsx)(r.EuiIcon,{"data-test-subj":"action-group-error-icon",type:"warning",color:"danger",size:"m"}))):Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiIcon,{type:t,size:"m"})),Object(C.jsx)(r.EuiFlexItem,null,Object(C.jsx)(r.EuiText,null,Object(C.jsx)("div",null,Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(s.FormattedMessage,{defaultMessage:"{actionConnectorName}",id:"xpack.triggersActionsUI.sections.actionTypeForm.existingAlertActionTypeEditTitle",values:{actionConnectorName:`${o}`}})),n&&Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiBadge,{"data-test-subj":"warning-badge",iconType:"warning",color:"warning"},a.i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.actionWarningsTitle",{defaultMessage:"1 warning"}))))))),i&&Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiBetaBadge,{"data-test-subj":"action-type-form-beta-badge",label:l.q,tooltipContent:l.p}))),re=({actions:e,defaultActionGroupId:t,setActionIdByIndex:n,setActionGroupIdByIndex:p,setActionUseAlertDataForTemplate:g,setActions:m,setActionParamsProperty:b,setActionFrequencyProperty:f,setActionAlertsFilterProperty:y,featureId:h,messageVariables:O,summaryMessageVariables:v,actionGroups:A,defaultActionMessage:I,setHasActionsDisabled:T,setHasActionsWithBrokenConnector:E,actionTypeRegistry:S,recoveryActionGroup:w,isActionGroupDisabledForActionType:k,hideActionHeader:M,hideNotifyWhen:U,defaultSummaryMessage:_,hasAlertsMappings:N,minimumThrottleInterval:W,notifyWhenSelectOptions:P,defaultRuleFrequency:D=F.DEFAULT_FREQUENCY,ruleTypeId:B,producerId:R,hasFieldsForAAD:z,disableErrorMessages:G})=>{const{http:q,notifications:{toasts:L}}=Object(x.b)().services,[$,V]=Object(i.useState)(!1),[Q,K]=Object(i.useState)(void 0),[H,Y]=Object(i.useState)(!0),[X,Z]=Object(i.useState)([]),[J,se]=Object(i.useState)(!1),[re,ce]=Object(i.useState)(!1),[le,ue]=Object(i.useState)(void 0),[de,pe]=Object(i.useState)([]),ge=Object(i.useCallback)((()=>V(!1)),[V]);Object(i.useEffect)((()=>{(async()=>{try{ce(!0);const e=(await Object(u.d)({http:q,featureId:h,includeSystemActions:!0})).sort(((e,t)=>e.name.localeCompare(t.name))),t={};for(const n of e)t[n.id]=n;ue(t)}catch(e){L.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.actionForm.unableToLoadConnectorTypesMessage",{defaultMessage:"Unable to load connector types"})})}finally{ce(!1)}})()}),[]),Object(i.useEffect)((()=>{(async()=>{try{se(!0);const e=await Object(u.e)({http:q,includeSystemActions:!0});Z(e.filter((e=>!e.isMissingSecrets||e.isSystemAction)))}catch(e){L.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.actionForm.unableToLoadActionsMessage",{defaultMessage:"Unable to load connectors"})})}finally{se(!1)}})()}),[]),Object(i.useEffect)((()=>{X.length>0&&le&&(()=>{const t=X.filter((e=>e.isPreconfigured)),n=e.some((e=>le&&!le[e.actionTypeId].enabled&&!Object(j.a)(le[e.actionTypeId],t).isEnabled));T&&T(n)})()}),[X,le]),Object(i.useEffect)((()=>{const t=e.some((e=>!X.find((t=>t.id===e.id))));E&&E(t)}),[e,X]);let me=null,be=!1;if(le){const i=X.filter((e=>e.isPreconfigured));me=S.list().filter((e=>le[e.id]&&!e.hideInUi)).filter((e=>!!e.actionParamsFields)).sort(((e,t)=>Object(ne.a)(le[e.id],le[t.id],i))).map((function(o,s){const u=le[o.id],d=Object(j.a)(le[o.id],i);if(!u.enabledInConfig&&!d.isEnabled)return null;u.enabledInLicense||(be=!0);const p=Boolean(le[o.id].isSystemActionType&&e.find((e=>e.actionTypeId===o.id))),g=!d.isEnabled||p,m=Object(C.jsx)(r.EuiKeyPadMenuItem,{key:s,isDisabled:g,"data-test-subj":`${o.id}-${h}-ActionTypeSelectOption`,label:le[o.id].name,betaBadgeLabel:o.isExperimental?l.q:void 0,betaBadgeTooltipContent:o.isExperimental?l.p:void 0,onClick:()=>function(i){var o,s;if(!t)return void L.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.actionForm.unableToAddAction",{defaultMessage:"Unable to add action, because default action group is not defined"})});Y(!1);const r=(null!==(o=null==i?void 0:i.subtype)&&void 0!==o?o:[]).map((e=>e.id)),l=Boolean(le&&(null===(s=le[i.id])||void 0===s?void 0:s.isSystemActionType));let u=X.filter((e=>e.actionTypeId===i.id));const d=l?{id:"",actionTypeId:i.id,params:{},uuid:Object(c.v4)()}:{id:"",actionTypeId:i.id,group:t,params:{},frequency:D,uuid:Object(c.v4)()};0===u.length?(u=X.filter((e=>r.includes(e.actionTypeId))),u.length>0?(e.push({...d,actionTypeId:u[0].actionTypeId}),n(u[0].id,e.length-1)):(e.push(d),n(e.length.toString(),e.length-1),pe([...de,e.length.toString()]))):(e.push(d),n(u[0].id,e.length-1))}(o)},Object(C.jsx)(r.EuiIcon,{size:"xl",type:"string"==typeof o.iconClass?o.iconClass:Object(oe.a)(o.iconClass)}));return Object(C.jsx)(r.EuiFlexItem,{grow:!1,key:`keypad-${o.id}`},d.isEnabled&&m,!1===d.isEnabled&&Object(C.jsx)(r.EuiToolTip,{position:"top",content:d.message},m))}))}return J?Object(C.jsx)(d.a,null,Object(C.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionForm.loadingConnectorsDescription",defaultMessage:"Loading connectors"})):Object(C.jsx)(o.a.Fragment,null,!M&&Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiTitle,{size:"s"},Object(C.jsx)("h4",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"Actions",id:"xpack.triggersActionsUI.sections.actionForm.actionSectionsTitle"}))),Object(C.jsx)(r.EuiSpacer,{size:"m"})),le&&e.map(((i,o)=>{var a;const c=Boolean(null===(a=le[i.actionTypeId])||void 0===a?void 0:a.isSystemActionType),l=X.find((e=>e.id===i.id)),u=()=>{const t=e.filter(((e,t)=>t!==o));m(t),Y(0===t.filter((e=>e.id!==i.id)).length),K(void 0)};return c&&!l?Object(C.jsx)(r.EuiEmptyPrompt,{title:Object(C.jsx)(r.EuiText,{color:"danger"},Object(C.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionForm.unableToLoadSystemActionConnectorTitle",defaultMessage:"Unable to load connector"}))}):l?c?Object(C.jsx)(ae,{actionItem:i,actionConnector:l,index:o,key:`system-action-form-action-at-${i.uuid}`,setActionParamsProperty:b,actionTypesIndex:le,connectors:X,messageVariables:O,summaryMessageVariables:v,defaultActionMessage:I,actionTypeRegistry:S,onDeleteAction:u,defaultSummaryMessage:_,featureId:h,producerId:R,ruleTypeId:B,disableErrorMessages:G}):Object(C.jsx)(ee,{actionItem:i,actionConnector:l,index:o,key:`action-form-action-at-${i.uuid}`,setActionUseAlertDataForTemplate:g,setActionParamsProperty:b,setActionFrequencyProperty:f,setActionAlertsFilterProperty:y,actionTypesIndex:le,connectors:X,defaultActionGroupId:t,messageVariables:O,summaryMessageVariables:v,actionGroups:A,defaultActionMessage:I,recoveryActionGroup:w,isActionGroupDisabledForActionType:k,setActionGroupIdByIndex:p,onAddConnector:()=>{K({actionTypeId:i.actionTypeId,indices:[o]}),V(!0)},onConnectorSelected:t=>{n(t,o);const i=X.find((e=>e.id===t));if(i&&l&&i.actionTypeId!==l.actionTypeId){const n=S.get(i.actionTypeId);if(n.convertParamsBetweenGroups){const a=e.map(((e,a)=>a===o?{...e,actionTypeId:i.actionTypeId,id:t,params:null!=n.convertParamsBetweenGroups?n.convertParamsBetweenGroups(e.params):{}}:e));m(a)}}},actionTypeRegistry:S,onDeleteAction:()=>{const t=e.filter(((e,t)=>t!==o));m(t),Y(0===t.length),K(void 0)},hideNotifyWhen:U,defaultSummaryMessage:_,hasAlertsMappings:N,minimumThrottleInterval:W,notifyWhenSelectOptions:P,defaultNotifyWhenValue:D.notifyWhen,featureId:h,producerId:R,ruleTypeId:B,hasFieldsForAAD:z,disableErrorMessages:G}):Object(C.jsx)(te.AddConnectorInline,{actionTypesIndex:le,actionItem:i,index:o,key:`action-form-action-at-${o}`,actionTypeRegistry:S,emptyActionsIds:de,connectors:X,onDeleteConnector:u,onAddConnector:()=>{K({actionTypeId:i.actionTypeId,indices:e.map(((e,t)=>e.id===i.id?t:-1)).filter((e=>e>=0))}),V(!0)},onSelectConnector:t=>{n(t,o);const i=X.find((e=>e.id===t));if(i&&i.actionTypeId){const n=S.get(i.actionTypeId);if(n.convertParamsBetweenGroups){const a=e.map(((e,a)=>a===o?{...e,actionTypeId:i.actionTypeId,id:t,params:null!=n.convertParamsBetweenGroups?n.convertParamsBetweenGroups(e.params):{}}:e));m(a)}}}})})),H?Object(C.jsx)(o.a.Fragment,null,Object(C.jsx)(r.EuiFlexGroup,{id:"alertActionTypeTitle",justifyContent:"spaceBetween"},Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiTitle,{size:"xs"},Object(C.jsx)("h5",null,Object(C.jsx)(s.FormattedMessage,{defaultMessage:"Select a connector type",id:"xpack.triggersActionsUI.sections.actionForm.selectConnectorTypeTitle"})))),be&&Object(C.jsx)(r.EuiFlexItem,{grow:!1},Object(C.jsx)(r.EuiTitle,{size:"xs"},Object(C.jsx)("h5",null,Object(C.jsx)(r.EuiLink,{href:F.VIEW_LICENSE_OPTIONS_LINK,target:"_blank",external:!0,className:"actActionForm__getMoreActionsLink"},Object(C.jsx)(s.FormattedMessage,{defaultMessage:"Get more connectors",id:"xpack.triggersActionsUI.sections.actionForm.getMoreConnectorsTitle"})))))),Object(C.jsx)(r.EuiSpacer,null),Object(C.jsx)(r.EuiFlexGroup,{gutterSize:"m",wrap:!0},re?Object(C.jsx)(d.a,null,Object(C.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionForm.loadingConnectorTypesDescription",defaultMessage:"Loading connector types"})):me)):Object(C.jsx)(r.EuiFlexGroup,null,Object(C.jsx)(r.EuiFlexItem,{grow:!0},Object(C.jsx)(r.EuiButton,{size:"m",fullWidth:!0,iconType:"plusInCircle","data-test-subj":"addAlertActionButton",onClick:()=>Y(!0)},Object(C.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionForm.addActionButtonLabel",defaultMessage:"Add action"})))),le&&Q&&$?Object(C.jsx)(ie.b,{actionType:le[Q.actionTypeId],onClose:ge,postSaveEventHandler:t=>{Q.indices.forEach((n=>{e[n].actionTypeId=t.actionTypeId})),X.push(t),(Q.indices||[]).forEach((e=>n(t.id,e)))},actionTypeRegistry:S}):null)}}}]);