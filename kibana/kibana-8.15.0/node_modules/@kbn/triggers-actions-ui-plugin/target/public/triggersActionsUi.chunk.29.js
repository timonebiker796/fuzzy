/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[29,45,55],{110:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleStatusPanel",(function(){return b})),s.d(t,"default",(function(){return f}));var n=s(2),a=s(1),o=s(33),i=s.n(o),u=s(24),r=s(3),l=s(8),c=s(136),d=s(98),p=s(189),g=s(0);const b=({rule:e,bulkEnableRules:t,bulkDisableRules:s,snoozeRule:o,unsnoozeRule:c,requestRefresh:b,isEditable:f,healthColor:h,statusMessage:m,refreshToken:j})=>{const[y,O]=Object(a.useState)(null),_=Object(a.useRef)(!1),x=Object(a.useCallback)((t=>o(e,t)),[e,o]),S=Object(a.useCallback)((t=>c(e,t)),[e,c]),v=Object(a.useMemo)((()=>{var t;return m||Object(g.jsx)(r.EuiStat,{titleSize:"xs",title:"--",description:"",isLoading:!(null!==(t=e.lastRun)&&void 0!==t&&t.outcome||e.nextRun)})}),[e,m]),{data:E,loadEventLogs:I}=Object(p.a)({id:e.id,dateStart:"now-24h",dateEnd:"now",page:0,perPage:10});Object(a.useEffect)((()=>{E&&O(E.total)}),[E]);const z=Object(a.useCallback)((()=>{I(),b()}),[b,I]),w=Object(a.useCallback)((t=>s({ids:[e.id],untrack:t})),[s,e.id]);return Object(a.useEffect)((()=>{_.current&&I(),_.current=!0}),[j]),Object(g.jsx)(r.EuiPanel,{"data-test-subj":"ruleStatusPanel",hasBorder:!0,paddingSize:"none"},Object(g.jsx)(r.EuiPanel,{hasShadow:!1},Object(g.jsx)(r.EuiFlexGroup,{justifyContent:"flexStart"},Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiTitle,{size:"xxs"},Object(g.jsx)("h5",null,Object(g.jsx)(u.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleDetails.rule.statusPanel.ruleIsEnabledDisabledTitle",defaultMessage:"Rule is"})))),Object(g.jsx)(r.EuiFlexItem,null,Object(g.jsx)(l.h,{disableRule:w,enableRule:()=>t({ids:[e.id]}),snoozeRule:async()=>{},unsnoozeRule:async()=>{},rule:e,onRuleChanged:z,direction:"row",isEditable:f,hideSnoozeOption:!0}))),Object(g.jsx)(r.EuiSpacer,{size:"s"}),Object(g.jsx)(r.EuiText,{size:"s",color:"subdued","data-test-subj":"ruleStatus-numberOfExecutions"},null!==y&&Object(g.jsx)(u.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleDetails.rule.statusPanel.totalExecutions",defaultMessage:"{executions, plural, one {# execution} other {# executions}} in the last 24 hr",values:{executions:y}}))),Object(g.jsx)(r.EuiHorizontalRule,{margin:"none"}),Object(g.jsx)(r.EuiPanel,{hasShadow:!1},Object(g.jsx)(r.EuiFlexGroup,{gutterSize:"none",direction:"row",responsive:!1},Object(g.jsx)(r.EuiFlexItem,null,Object(g.jsx)(r.EuiStat,{"data-test-subj":`ruleStatus-${e.executionStatus.status}`,titleSize:"m",descriptionElement:"strong",titleElement:"h5",title:Object(g.jsx)(r.EuiHealth,{"data-test-subj":`ruleStatus-${e.executionStatus.status}`,textSize:"m",color:h,style:{fontWeight:400}},v),description:n.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.rulesList.ruleLastExecutionDescription",{defaultMessage:"Last response"})})),Object(g.jsx)(r.EuiFlexItem,{grow:!1},Object(g.jsx)(r.EuiSpacer,{size:"xs"}),Object(g.jsx)(r.EuiText,{color:"subdued",size:"xs"},i()(e.executionStatus.lastExecutionDate).fromNow())))),Object(g.jsx)(r.EuiHorizontalRule,{margin:"none"}),Object(g.jsx)(r.EuiPanel,{hasShadow:!1},Object(g.jsx)(d.RulesListNotifyBadge,{snoozeSettings:e,loading:!e,disabled:!f,onRuleChanged:z,snoozeRule:x,unsnoozeRule:S,showTooltipInline:!0})))},f=Object(c.a)(b)},132:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=({message:e,outcomeFilter:t,runId:s,ruleTypeIds:n})=>{const a=[];if(e){const t=e.replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&");a.push(`(message: "${t}" OR error.message: "${t}")`)}if(t&&t.length){const e=function(e){const t={failure:"event.outcome: failure",warning:"kibana.alerting.outcome: warning",success:"kibana.alerting.outcome:success OR (event.outcome: success AND NOT kibana.alerting.outcome:*)",unknown:"event.outcome: unknown"};return`${e.map((e=>t[e])).join(" OR ")}`}(t);e&&a.push(`(${e})`)}return s&&a.push(`kibana.alert.rule.execution.uuid: ${s}`),null!=n&&n.length&&a.push(`kibana.alert.rule.rule_type_id:(${n.join(" or ")})`),a}},136:function(e,t,s){"use strict";s.d(t,"a",(function(){return R}));var n=s(12),a=s.n(n),o=(s(1),s(138)),i=s(179),u=s(173),r=s(65),l=s(64),c=s(166),d=s(37),p=s(156),g=s(6);async function b({id:e,http:t}){await t.post(`${g.d}/rule/${encodeURIComponent(e)}/_mute_all`)}async function f({id:e,http:t}){await t.post(`${g.d}/rule/${encodeURIComponent(e)}/_unmute_all`)}const h=({rule_type_state:e,alerts:t,previous_started_at:s,...n})=>({...n,alertTypeState:e,alertInstances:t,previousStartedAt:s});var m=s(132);const j=({id:e,http:t,outcomeFilter:s,message:n,dateStart:a,dateEnd:o,ruleTypeIds:i})=>{const u=Object(m.a)({outcomeFilter:s,message:n,ruleTypeIds:i});return t.get(`${g.m}/rule/${e}/_execution_kpi`,{query:{filter:u.length?u.join(" and "):void 0,date_start:a,date_end:o}})},y=({id:e,http:t,outcomeFilter:s,message:n,dateStart:a,dateEnd:o,namespaces:i,ruleTypeIds:u})=>{const r=Object(m.a)({outcomeFilter:s,message:n,ruleTypeIds:u});return t.get(`${g.m}/_global_execution_kpi`,{query:{filter:r.length?r.join(" and "):void 0,date_start:a,date_end:o,namespaces:i?JSON.stringify(i):i}})},O={timestamp:"@timestamp"},_=({id:e,http:t,dateStart:s,dateEnd:n,runId:a,message:o,perPage:i=10,page:u=0,sort:r,namespace:l,withAuth:c=!1})=>{const d=(e=>e?e.map((e=>{const t=Object.keys(e)[0],s=e[Object.keys(e)[0]];return{[O[t]||t]:{...s}}})):[])(r),p=Object(m.a)({runId:a,message:o});return t.get(`${g.m}/rule/${e}/_action_error_log`,{query:{date_start:s,date_end:n,filter:p.length?p.join(" and "):void 0,per_page:i,page:u+1,sort:d.length?JSON.stringify(d):void 0,namespace:l,with_auth:c}})};var x=s(167),S=s(139),v=s(140),E=s(62),I=s(174),z=s(175),w=s(29),k=s(0);function R(e){return t=>{const{http:s}=Object(w.b)().services;return Object(k.jsx)(e,a()({},t,{muteRules:async e=>async function({ids:e,http:t}){await Promise.all(e.map((e=>b({http:t,id:e}))))}({http:s,ids:e.filter((e=>!L(e))).map((e=>e.id))}),unmuteRules:async e=>async function({ids:e,http:t}){await Promise.all(e.map((e=>f({id:e,http:t}))))}({http:s,ids:e.filter(L).map((e=>e.id))}),muteRule:async e=>{if(!L(e))return await b({http:s,id:e.id})},unmuteRule:async e=>{if(L(e))return await f({http:s,id:e.id})},muteAlertInstance:async(e,t)=>{if(!N(e,t))return Object(c.a)({http:s,id:e.id,instanceId:t})},unmuteAlertInstance:async(e,t)=>{if(N(e,t))return Object(x.a)({http:s,id:e.id,instanceId:t})},loadRule:async e=>Object(r.a)({http:s,ruleId:e}),loadRuleState:async e=>async function({http:e,ruleId:t}){return await e.get(`${g.m}/rule/${t}/state`).then((e=>e?h(e):{}))}({http:s,ruleId:e}),loadRuleSummary:async(e,t)=>Object(l.a)({http:s,ruleId:e,numberOfExecutions:t}),loadRuleTypes:async()=>Object(d.a)({http:s}),loadExecutionLogAggregations:async e=>Object(p.a)({...e,http:s}),loadGlobalExecutionLogAggregations:async e=>Object(p.b)({...e,http:s}),loadActionErrorLog:async e=>_({...e,http:s}),loadExecutionKPIAggregations:async e=>j({...e,http:s}),loadGlobalExecutionKPIAggregations:async e=>y({...e,http:s}),resolveRule:async e=>Object(i.a)({http:s,id:e}),getHealth:async()=>Object(o.a)({http:s}),snoozeRule:async(e,t)=>await Object(S.b)({http:s,id:e.id,snoozeSchedule:t}),bulkSnoozeRules:async e=>await Object(S.a)({http:s,...e}),unsnoozeRule:async(e,t)=>await Object(v.b)({http:s,id:e.id,scheduleIds:t}),bulkUnsnoozeRules:async e=>await Object(v.a)({http:s,...e}),cloneRule:async e=>await Object(u.a)({http:s,ruleId:e}),bulkDeleteRules:async e=>await Object(E.a)({http:s,...e}),bulkEnableRules:async e=>await Object(I.a)({http:s,...e}),bulkDisableRules:async e=>await Object(z.a)({http:s,...e})}))}}function L(e){return!0===e.muteAll}function N(e,t){return e.mutedInstanceIds.findIndex((e=>e===t))>=0}},138:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return i}));var n=s(25);async function a({http:e}){const t=await e.get(`${n.b}/_health`),s=o(t.alerting_framework_health);return{...i(t),alertingFrameworkHealth:s}}const o=({decryption_health:e,execution_health:t,read_health:s,...n})=>({decryptionHealth:e,executionHealth:t,readHealth:s,...n}),i=({is_sufficiently_secure:e,has_permanent_encryption_key:t,alerting_framework_health:s,...n})=>({isSufficientlySecure:e,hasPermanentEncryptionKey:t,alertingFrameworkHealth:s,...n})},139:function(e,t,s){"use strict";s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return i}));var n=s(6);function a({id:e,duration:t,rRule:s}){return{...e?{id:e}:{},duration:t,rRule:{...s,...s.until?{until:s.until.toISOString()}:{}}}}async function o({id:e,snoozeSchedule:t,http:s}){await s.post(`${n.m}/rule/${encodeURIComponent(e)}/_snooze`,{body:JSON.stringify({snooze_schedule:a(t)})})}function i({ids:e,filter:t,snoozeSchedule:s,http:o}){let i;try{i=JSON.stringify({ids:null!=e&&e.length?e:void 0,...t?{filter:JSON.stringify(t)}:{},operations:[{operation:"set",field:"snoozeSchedule",value:a(s)}]})}catch(e){throw new Error(`Unable to parse bulk snooze params: ${e}`)}return o.post(`${n.m}/rules/_bulk_edit`,{body:i})}},140:function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"a",(function(){return o}));var n=s(6);async function a({id:e,http:t,scheduleIds:s}){await t.post(`${n.m}/rule/${encodeURIComponent(e)}/_unsnooze`,{body:JSON.stringify({schedule_ids:s})})}function o({ids:e,filter:t,scheduleIds:s,http:a}){let o;try{o=JSON.stringify({ids:null!=e&&e.length?e:void 0,...t?{filter:JSON.stringify(t)}:{},operations:[{operation:"delete",field:"snoozeSchedule",value:s}]})}catch(e){throw new Error(`Unable to parse bulk unsnooze params: ${e}`)}return a.post(`${n.m}/rules/_bulk_edit`,{body:o})}},141:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"b",(function(){return u}));const n=e=>{const{uuid:t,id:s,connector_type_id:n,params:a}=e;return{..."group"in e&&e.group?{group:e.group}:{},id:s,params:a,actionTypeId:n,..."use_alert_data_for_template"in e&&void 0!==e.use_alert_data_for_template?{useAlertDataForTemplate:e.use_alert_data_for_template}:{},..."frequency"in e&&e.frequency?{frequency:{summary:e.frequency.summary,notifyWhen:e.frequency.notify_when,throttle:e.frequency.throttle}}:{},..."alerts_filter"in e&&e.alerts_filter?{alertsFilter:e.alerts_filter}:{},...t&&{uuid:t}}},a=({last_execution_date:e,last_duration:t,...s})=>({lastExecutionDate:e,lastDuration:t,...s}),o=({outcome_msg:e,outcome_order:t,alerts_count:s,...n})=>({outcomeMsg:e,outcomeOrder:t,alertsCount:s,...n}),i=({rule_type_id:e,created_by:t,updated_by:s,created_at:i,updated_at:u,api_key_owner:r,api_key_created_by_user:l,notify_when:c,mute_all:d,muted_alert_ids:p,scheduled_task_id:g,execution_status:b,actions:f,snooze_schedule:h,is_snoozed_until:m,active_snoozes:j,last_run:y,next_run:O,alert_delay:_,...x})=>({ruleTypeId:e,createdBy:t,updatedBy:s,createdAt:i,updatedAt:u,apiKeyOwner:r,notifyWhen:c,muteAll:d,mutedInstanceIds:p,snoozeSchedule:h,executionStatus:b?a(b):void 0,actions:f?f.map((e=>n(e))):[],scheduledTaskId:g,isSnoozedUntil:m,activeSnoozes:j,...y?{lastRun:o(y)}:{},...O?{nextRun:O}:{},...void 0!==l?{apiKeyCreatedByUser:l}:{},..._?{alertDelay:_}:{},...x}),u=({alias_target_id:e,alias_purpose:t,outcome:s,...n})=>({...i(n),alias_target_id:e,alias_purpose:t,outcome:s})},156:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return u}));var n=s(6),a=s(132);const o=({data:e,...t})=>({data:e.map((e=>(e=>{const{duration_ms:t,total_search_duration_ms:s,es_search_duration_ms:n,schedule_delay_ms:a,...o}=e;return{execution_duration:e.duration_ms,total_search_duration:e.total_search_duration_ms,es_search_duration:e.es_search_duration_ms,schedule_delay:e.schedule_delay_ms,...o}})(e))),...t}),i=async({id:e,http:t,dateStart:s,dateEnd:i,outcomeFilter:u,ruleTypeIds:r,message:l,perPage:c=10,page:d=0,sort:p=[]})=>{const g=p,b=Object(a.a)({outcomeFilter:u,message:l,ruleTypeIds:r}),f=await t.get(`${n.m}/rule/${e}/_execution_log`,{query:{date_start:s,date_end:i,filter:b.length?b.join(" and "):void 0,per_page:c,page:d+1,sort:g.length?JSON.stringify(g):void 0}});return o(f)},u=async({http:e,dateStart:t,dateEnd:s,outcomeFilter:i,ruleTypeIds:u,message:r,perPage:l=10,page:c=0,sort:d=[],namespaces:p})=>{const g=d,b=Object(a.a)({outcomeFilter:i,message:r,ruleTypeIds:u}),f=await e.get(`${n.m}/_global_execution_logs`,{query:{date_start:t,date_end:s,filter:b.length?b.join(" and "):void 0,per_page:l,page:c+1,sort:g.length?JSON.stringify(g):void 0,namespaces:p?JSON.stringify(p):void 0}});return o(f)}},166:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s(6);async function a({id:e,instanceId:t,http:s}){await s.post(`${n.d}/rule/${encodeURIComponent(e)}/alert/${encodeURIComponent(t)}/_mute`)}},167:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s(6);async function a({id:e,instanceId:t,http:s}){await s.post(`${n.d}/rule/${encodeURIComponent(e)}/alert/${encodeURIComponent(t)}/_unmute`)}},173:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s(6),a=s(38);async function o({http:e,ruleId:t}){const s=await e.post(`${n.m}/rule/${encodeURIComponent(t)}/_clone`);return Object(a.a)(s)}},174:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s(6);const a=async({filter:e,ids:t,http:s})=>{try{const a=JSON.stringify({ids:null!=t&&t.length?t:void 0,...e?{filter:JSON.stringify(e)}:{}});return s.patch(`${n.m}/rules/_bulk_enable`,{body:a})}catch(e){throw new Error(`Unable to parse bulk enable params: ${e}`)}}},175:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s(6);const a=async({filter:e,ids:t,http:s,untrack:a})=>{try{const o=JSON.stringify({ids:null!=t&&t.length?t:void 0,untrack:a,...e?{filter:JSON.stringify(e)}:{}});return s.patch(`${n.m}/rules/_bulk_disable`,{body:o})}catch(e){throw new Error(`Unable to parse bulk disable params: ${e}`)}}},179:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s(25),a=s(141);async function o({http:e,id:t}){const s=await e.get(`${n.e}/rule/${encodeURIComponent(t)}/_resolve`);return Object(a.b)(s)}},189:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var n=s(1),a=s(4),o=s(58),i=s.n(o),u=s(29),r=s(156);const l=e=>{var t;return e.includes("now")&&(null===(t=i.a.parse(e))||void 0===t?void 0:t.format())||e},c=e=>"*"===e.id;function d(e){const{http:t}=Object(u.b)().services,s=Object(n.useCallback)((()=>c(e)?Object(r.b)({http:t,...e,dateStart:l(e.dateStart),...e.dateEnd?{dateEnd:l(e.dateEnd)}:{}}):Object(r.a)({http:t,...e,dateStart:l(e.dateStart),...e.dateEnd?{dateEnd:l(e.dateEnd)}:{}})),[e,t]),{data:o,error:i,isLoading:d,isFetching:p,refetch:g}=Object(a.useQuery)({queryKey:["loadRuleEventLog",e],queryFn:s,onError:e.onError,retry:0,refetchOnWindowFocus:!1}),b=Object(n.useMemo)((()=>i&&413===i.body.statusCode),[i]);return Object(n.useMemo)((()=>({data:o,hasExceedLogs:b,isLoading:d||p,loadEventLogs:g})),[o,b,p,d,g])}},98:function(e,t,s){"use strict";s.r(t),s.d(t,"RulesListNotifyBadge",(function(){return v})),s.d(t,"SNOOZE_SUCCESS_MESSAGE",(function(){return g})),s.d(t,"UNSNOOZE_SUCCESS_MESSAGE",(function(){return b})),s.d(t,"SNOOZE_FAILED_MESSAGE",(function(){return f})),s.d(t,"default",(function(){return E}));var n=s(1),a=s(29),o=s(140),i=s(139),u=s(33),r=s.n(u),l=s(3),c=s(2),d=s(187),p=s(169);const g=c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListSnoozePanel.snoozeSuccess",{defaultMessage:"Rules notification successfully snoozed"}),b=c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListSnoozePanel.unsnoozeSuccess",{defaultMessage:"Rules notification successfully unsnoozed"}),f=c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListSnoozePanel.snoozeFailed",{defaultMessage:"Unable to change rule snooze settings"}),h=c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.openSnoozePanel",{defaultMessage:"Open snooze panel"}),m=e=>c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.seconds",{defaultMessage:"{value, plural, one {# second} other {# seconds}}",values:{value:e}}),j=e=>c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.minutes",{defaultMessage:"{value, plural, one {# minute} other {# minutes}}",values:{value:e}}),y=e=>c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.hours",{defaultMessage:"{value, plural, one {# hour} other {# hours}}",values:{value:e}}),O=e=>c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.days",{defaultMessage:"{value, plural, one {# day} other {# days}}",values:{value:e}}),_=e=>c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.weeks",{defaultMessage:"{value, plural, one {# week} other {# weeks}}",values:{value:e}}),x=e=>c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.months",{defaultMessage:"{value, plural, one {# month} other {# months}}",values:{value:e}});var S=s(0);const v=({snoozeSettings:e,loading:t=!1,disabled:s=!1,onRuleChanged:o,snoozeRule:i,unsnoozeRule:u,showOnHover:v=!1,showTooltipInline:E=!1})=>{var I,z,w;const[k,R]=Object(n.useState)(!1),L=t||k,N=Boolean(s)||!e,[$,A]=Object(n.useState)(!1),T=Object(n.useCallback)((()=>A(!0)),[A]),U=Object(n.useCallback)((()=>A(!1)),[A]),M=null==e?void 0:e.isSnoozedUntil,C=null!==(I=null==e?void 0:e.muteAll)&&void 0!==I&&I,B=Object(n.useMemo)((()=>{return!!e&&(t=e,Boolean(t.isSnoozedUntil&&new Date(t.isSnoozedUntil).getTime()>Date.now()||t.muteAll));var t}),[e]),F=Object(n.useMemo)((()=>e?(e=>{if(!e.snoozeSchedule)return null;const t=e.snoozeSchedule.filter((e=>Boolean(e.id)));return 0===t.length?null:t.reduce(((e,t)=>r()(t.rRule.dtstart).isBefore(r()(e.rRule.dtstart))?t:e))})(e):null),[e]),P=Object(n.useMemo)((()=>M?function(e){const t=r.a.duration(r()(e).diff(r()())),s={years:(o=t.years(),c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.years",{defaultMessage:"{value, plural, one {# year} other {# years}}",values:{value:o}})),months:x(t.months()),weeks:_(t.weeks()),days:O(t.days()),hours:y(t.hours()),minutes:j(t.minutes()),seconds:m(t.seconds())},n=Object.entries(s).filter((([e,t])=>""!==t&&t!==`0 ${e}`)).map((([e,t])=>`${t}`)).join(", "),a=n.lastIndexOf(", ");var o;return-1===a?n:n.slice(0,a)+" and"+n.slice(a+1)}(M):void 0),[M]),D=Object(n.useRef)(null),{notifications:{toasts:q}}=Object(a.b)().services,J=Object(n.useMemo)((()=>!B&&Boolean(F)),[F,B]),H=Object(n.useMemo)((()=>M?Object(d.a)(r()(M)):F?Object(d.a)(r()(F.rRule.dtstart)):""),[M,F]),G=Object(n.useMemo)((()=>C?c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.snoozedIndefinitelyTooltip",{defaultMessage:"Notifications snoozed indefinitely"}):J?c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.snoozeScheduledTooltip",{defaultMessage:"Notifications scheduled to snooze starting {schedStart}",values:{schedStart:Object(d.b)(r()(F.rRule.dtstart))}}):B&&P?Object(S.jsx)(l.EuiToolTip,{title:c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.timeRemaining",{defaultMessage:"Time remaining"}),content:Object(S.jsx)(l.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(S.jsx)(l.EuiFlexItem,{grow:!1},Object(S.jsx)("span",null,P)),Object(S.jsx)(l.EuiSpacer,null),Object(S.jsx)(l.EuiFlexItem,{grow:!1},Object(S.jsx)("span",null,null==M?void 0:M.toString())))},Object(S.jsx)(l.EuiTextAlign,null,c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.snoozedTooltip",{defaultMessage:"Notifications snoozing for {snoozeTime}",values:{snoozeTime:r()(M).fromNow(!0)}}))):E?c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.noSnoozeAppliedTooltip",{defaultMessage:"Notify when alerts generated"}):""),[C,J,B,E,F,P,M]),K=Object(n.useMemo)((()=>Object(S.jsx)(l.EuiButton,{size:"s",isLoading:L,disabled:L||N,"data-test-subj":"rulesListNotifyBadge-snoozed","aria-label":h,minWidth:85,iconType:"bellSlash",color:"accent",onClick:T,buttonRef:D},Object(S.jsx)(l.EuiText,{size:"xs"},H))),[H,L,N,T]),W=Object(n.useMemo)((()=>Object(S.jsx)(l.EuiButton,{size:"s",isLoading:L,disabled:L||N,"data-test-subj":"rulesListNotifyBadge-scheduled",minWidth:85,iconType:"calendar",color:"text","aria-label":h,onClick:T,buttonRef:D},Object(S.jsx)(l.EuiText,{size:"xs"},H))),[H,L,N,T]),Z=Object(n.useMemo)((()=>{const e=v?"ruleSidebarItem__action":"";return Object(S.jsx)(l.EuiButtonIcon,{size:"s",isLoading:L,disabled:L||N,display:L?"base":"empty","data-test-subj":"rulesListNotifyBadge-unsnoozed","aria-label":h,className:$||L?"":e,iconType:"bell",onClick:T,buttonRef:D})}),[$,L,N,v,T]),Q=Object(n.useMemo)((()=>Object(S.jsx)(l.EuiButtonIcon,{size:"s",isLoading:L,disabled:L||N,display:"base","data-test-subj":"rulesListNotifyBadge-snoozedIndefinitely","aria-label":h,iconType:"bellSlash",color:"accent",onClick:T,buttonRef:D})),[L,N,T]),Y=Object(n.useMemo)((()=>J?W:C?Q:B?K:Z),[B,J,C,W,K,Q,Z]),V=Object(n.useMemo)((()=>{const e="string"==typeof s?s:$||E?void 0:P;return Object(S.jsx)(l.EuiToolTip,{title:e?c.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListNotifyBadge.timeRemaining",{defaultMessage:"Time remaining"}):void 0,content:e},Y)}),[s,$,Y,E,P]),X=Object(n.useCallback)((async e=>{try{R(!0),U(),await i(e),await o(),q.addSuccess(g)}catch(e){q.addDanger(f)}finally{R(!1),requestAnimationFrame((()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.focus()}))}}),[U,i,o,q]),ee=Object(n.useCallback)((async e=>{try{R(!0),U(),await u(e),await o(),q.addSuccess(b)}catch(e){q.addDanger(f)}finally{R(!1),requestAnimationFrame((()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.focus()}))}}),[U,u,o,q]),te=Object(S.jsx)(l.EuiPopover,{"data-test-subj":"rulesListNotifyBadge",isOpen:$&&!N,closePopover:U,button:V,anchorPosition:"rightCenter",panelStyle:{maxHeight:"100vh",overflowY:"auto"}},Object(S.jsx)(p.a,{snoozeRule:X,unsnoozeRule:ee,interval:Object(p.b)(M),showCancel:B,scheduledSnoozes:null!==(z=null==e?void 0:e.snoozeSchedule)&&void 0!==z?z:[],activeSnoozes:null!==(w=null==e?void 0:e.activeSnoozes)&&void 0!==w?w:[],inPopover:!0}));return E?Object(S.jsx)(l.EuiFlexGroup,{alignItems:"center"},Object(S.jsx)(l.EuiFlexItem,{grow:!1},te),Object(S.jsx)(l.EuiFlexItem,null,Object(S.jsx)(l.EuiText,{color:"subdued",size:"xs"},G))):te},E=({ruleId:e,snoozeSettings:t,loading:s,disabled:u,showTooltipInline:r,showOnHover:l,onRuleChanged:c})=>{const{http:d}=Object(a.b)().services,p=Object(n.useCallback)((t=>e?Object(i.b)({http:d,id:e,snoozeSchedule:t}):Promise.resolve()),[d,e]),g=Object(n.useCallback)((t=>e?Object(o.b)({http:d,id:e,scheduleIds:t}):Promise.resolve()),[d,e]);return Object(S.jsx)(v,{snoozeSettings:t,loading:s,disabled:u,onRuleChanged:c,snoozeRule:p,unsnoozeRule:g,showTooltipInline:r,showOnHover:l})}}}]);