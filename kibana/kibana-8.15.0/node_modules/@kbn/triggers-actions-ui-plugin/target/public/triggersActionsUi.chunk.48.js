/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[48],{117:function(e,t,n){"use strict";n.r(t),n.d(t,"RuleEventLogList",(function(){return T})),n.d(t,"default",(function(){return T}));var s=n(1),a=n.n(s),r=n(3),i=n(2),u=n(29),o=n(56),c=n(24),l=n(35),j=n(7),x=n(10),b=n(33),g=n.n(b),m=n(183),O=n(0);const d=[120,60,30,15].map((e=>({value:e,text:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.numberOfExecutionsOption",{defaultMessage:"{value} runs",values:{value:e}})}))),f=({executionDuration:e,numberOfExecutions:t,onChangeDuration:n,isLoading:u})=>{const o=function(e,t){const n=Object.entries(e);return n.length===t?n:n.length<t?Object(x.assign)(Object(x.fill)(new Array(t),[null,null]),n):n.slice(-t)}(e.valuesWithTimestamp,t),b=Object(s.useCallback)((({target:e})=>n(Number(e.value))),[n]);return Object(O.jsx)(r.EuiPanel,{"data-test-subj":"executionDurationChartPanel",hasBorder:!0},Object(O.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(O.jsx)(r.EuiFlexItem,{grow:!1},Object(O.jsx)(r.EuiTitle,{size:"xxs"},Object(O.jsx)("h4",null,Object(O.jsx)(c.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.recentDurationsTitle",defaultMessage:"Recent run durations"})))),Object(O.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd"},Object(O.jsx)(r.EuiFlexItem,{grow:!1},Object(O.jsx)(r.EuiSelect,{id:"select-number-execution-durations","data-test-subj":"executionDurationChartPanelSelect",options:d,value:t,"aria-label":i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.selectNumberOfExecutionDurationsLabel",{defaultMessage:"Select number of runs"}),onChange:b})))),u&&Object(O.jsx)(r.EuiFlexGroup,{justifyContent:"center"},Object(O.jsx)(r.EuiFlexItem,{grow:!1,style:{height:"80px",justifyContent:"center"}},Object(O.jsx)(r.EuiLoadingChart,{size:"xl"}))),!u&&(e.valuesWithTimestamp&&Object.entries(e.valuesWithTimestamp).length>0?Object(O.jsx)(a.a.Fragment,null,Object(O.jsx)(j.Chart,{"data-test-subj":"executionDurationChart",size:{height:80}},Object(O.jsx)(j.Settings,{theme:{lineSeriesStyle:{point:{visible:!1},line:{stroke:l.euiLightVars.euiColorAccent}}},baseTheme:j.LEGACY_LIGHT_THEME,locale:i.i18n.getLocale()}),Object(O.jsx)(j.BarSeries,{id:"executionDuration",name:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.durationLabel",{defaultMessage:"Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:o.map((([e,t],n)=>[e?g()(e).format("D MMM YYYY @ HH:mm:ss"):n,t])),minBarHeight:2}),Object(O.jsx)(j.LineSeries,{id:"rule_duration_avg",name:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.avgDurationLabel",{defaultMessage:"Avg Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:o.map((([t,n],s)=>[t?g()(t).format("D MMM YYYY @ HH:mm:ss"):s,n?e.average:null])),curve:j.CurveType.CURVE_NATURAL}),Object(O.jsx)(j.Axis,{id:"left-axis",position:"left",tickFormat:e=>Object(m.a)(e)}))):Object(O.jsx)(a.a.Fragment,null,Object(O.jsx)(r.EuiEmptyPrompt,{"data-test-subj":"executionDurationChartEmpty",body:Object(O.jsx)(a.a.Fragment,null,Object(O.jsx)("p",null,Object(O.jsx)(c.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.executionDurationNoData",defaultMessage:"There is no available run duration information for this rule."})))}))))};var h=n(136);const p=60,E=i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.alertsList.ruleTypeExcessDurationMessage",{defaultMessage:"Duration exceeds the rule's expected run time."}),D=Object(h.a)((e=>{const{ruleId:t,ruleType:n,ruleSummary:a,refreshToken:c,fetchRuleSummary:l=!1,numberOfExecutions:j=p,onChangeDuration:x,loadRuleSummary:b,isLoadingRuleSummary:g=!1}=e,{notifications:{toasts:d}}=Object(u.b)().services,{euiTheme:h}=Object(r.useEuiTheme)(),D=Object(s.useRef)(!1),[y,S]=Object(s.useState)(null),[v,T]=Object(s.useState)(p),[C,A]=Object(s.useState)(!1),I=Object(s.useMemo)((()=>l?y:a),[l,a,y]),L=Object(s.useMemo)((()=>l?v:j),[l,j,v]),M=Object(s.useMemo)((()=>l?C:g),[l,g,C]),k=Object(s.useCallback)((e=>{T(e)}),[T]),F=Object(s.useMemo)((()=>l?k:x||k),[l,x,k]),w=async()=>{if(l){A(!0);try{const e=await b(t,L);S(e)}catch(e){d.addDanger({title:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.ruleExecutionSummaryAndChart.loadSummaryError",{defaultMessage:"Unable to load rule summary: {message}",values:{message:e.message}})})}A(!1)}};Object(s.useEffect)((()=>{w()}),[t,L]),Object(s.useEffect)((()=>{D.current&&w(),D.current=!0}),[c]);const U=Object(s.useMemo)((()=>!!I&&Object(m.b)(n,I.executionDuration.average)),[n,I]);return I?Object(O.jsx)(r.EuiFlexGroup,null,Object(O.jsx)(r.EuiFlexItem,{grow:1},Object(O.jsx)(r.EuiPanel,{"data-test-subj":"avgExecutionDurationPanel",color:U?"warning":"subdued",hasBorder:!1},Object(O.jsx)(r.EuiText,{size:"s",color:"text"},i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.alertsList.avgDurationDescription",{defaultMessage:"Average duration"})),Object(O.jsx)(r.EuiFlexGroup,{gutterSize:"xs",style:{alignItems:"center"}},U&&Object(O.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"ruleDurationWarning"},Object(O.jsx)(r.EuiIconTip,{anchorClassName:"ruleDurationWarningIcon",type:"warning",color:"warning",content:E,"aria-label":E,position:"top",size:"m"})),Object(O.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"ruleEventLogListAvgDuration"},Object(O.jsx)(r.EuiText,{size:"m",color:h.colors.text},Object(O.jsx)("strong",null,Object(m.a)(I.executionDuration.average))))))),Object(O.jsx)(r.EuiFlexItem,{grow:2},Object(O.jsx)(f,{executionDuration:I.executionDuration,numberOfExecutions:L,onChangeDuration:F,isLoading:M}))):Object(O.jsx)(o.a,null)}));var y=n(244);const S="xpack.triggersActionsUI.ruleEventLogList.initialColumns",v={minHeight:400},T=e=>{const{ruleId:t,ruleType:n,localStorageKey:s=S,refreshToken:a,requestRefresh:i,fetchRuleSummary:u=!0}=e,{ruleSummary:o,numberOfExecutions:c,onChangeDuration:l,isLoadingRuleSummary:j=!1}=e;return Object(O.jsx)("div",{style:v,"data-test-subj":"ruleEventLogListContainer"},Object(O.jsx)(r.EuiSpacer,null),Object(O.jsx)(D,{ruleId:t,ruleType:n,ruleSummary:o,numberOfExecutions:c,isLoadingRuleSummary:j,refreshToken:a,onChangeDuration:l,requestRefresh:i,fetchRuleSummary:u}),Object(O.jsx)(r.EuiSpacer,null),Object(O.jsx)(y.a,{localStorageKey:s,ruleId:t,refreshToken:a}))}},183:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return o}));var s=n(33),a=n.n(s),r=n(10),i=n(11);function u(e){if(!e)return"00:00:00.000";const t=a.a.duration(e);return`${[t.hours(),t.minutes(),t.seconds()].map((e=>Object(r.padStart)(`${e}`,2,"0"))).join(":")}.${Object(r.padStart)(`${t.milliseconds()}`,3,"0")}`}function o(e,t){if(!e||!e.ruleTaskTimeout)return!1;const n=e.ruleTaskTimeout;return t>Object(i.parseDuration)(n)}}}]);