/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[28,20,48,55],{117:function(e,t,n){"use strict";n.r(t),n.d(t,"RuleEventLogList",(function(){return T})),n.d(t,"default",(function(){return T}));var s=n(1),r=n.n(s),a=n(3),i=n(2),u=n(29),l=n(56),o=n(24),c=n(35),d=n(7),g=n(10),p=n(33),m=n.n(p),f=n(183),b=n(0);const h=[120,60,30,15].map((e=>({value:e,text:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.numberOfExecutionsOption",{defaultMessage:"{value} runs",values:{value:e}})}))),x=({executionDuration:e,numberOfExecutions:t,onChangeDuration:n,isLoading:u})=>{const l=function(e,t){const n=Object.entries(e);return n.length===t?n:n.length<t?Object(g.assign)(Object(g.fill)(new Array(t),[null,null]),n):n.slice(-t)}(e.valuesWithTimestamp,t),p=Object(s.useCallback)((({target:e})=>n(Number(e.value))),[n]);return Object(b.jsx)(a.EuiPanel,{"data-test-subj":"executionDurationChartPanel",hasBorder:!0},Object(b.jsx)(a.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(b.jsx)(a.EuiFlexItem,{grow:!1},Object(b.jsx)(a.EuiTitle,{size:"xxs"},Object(b.jsx)("h4",null,Object(b.jsx)(o.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.recentDurationsTitle",defaultMessage:"Recent run durations"})))),Object(b.jsx)(a.EuiFlexGroup,{justifyContent:"flexEnd"},Object(b.jsx)(a.EuiFlexItem,{grow:!1},Object(b.jsx)(a.EuiSelect,{id:"select-number-execution-durations","data-test-subj":"executionDurationChartPanelSelect",options:h,value:t,"aria-label":i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.selectNumberOfExecutionDurationsLabel",{defaultMessage:"Select number of runs"}),onChange:p})))),u&&Object(b.jsx)(a.EuiFlexGroup,{justifyContent:"center"},Object(b.jsx)(a.EuiFlexItem,{grow:!1,style:{height:"80px",justifyContent:"center"}},Object(b.jsx)(a.EuiLoadingChart,{size:"xl"}))),!u&&(e.valuesWithTimestamp&&Object.entries(e.valuesWithTimestamp).length>0?Object(b.jsx)(r.a.Fragment,null,Object(b.jsx)(d.Chart,{"data-test-subj":"executionDurationChart",size:{height:80}},Object(b.jsx)(d.Settings,{theme:{lineSeriesStyle:{point:{visible:!1},line:{stroke:c.euiLightVars.euiColorAccent}}},baseTheme:d.LEGACY_LIGHT_THEME,locale:i.i18n.getLocale()}),Object(b.jsx)(d.BarSeries,{id:"executionDuration",name:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.durationLabel",{defaultMessage:"Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:l.map((([e,t],n)=>[e?m()(e).format("D MMM YYYY @ HH:mm:ss"):n,t])),minBarHeight:2}),Object(b.jsx)(d.LineSeries,{id:"rule_duration_avg",name:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.avgDurationLabel",{defaultMessage:"Avg Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:l.map((([t,n],s)=>[t?m()(t).format("D MMM YYYY @ HH:mm:ss"):s,n?e.average:null])),curve:d.CurveType.CURVE_NATURAL}),Object(b.jsx)(d.Axis,{id:"left-axis",position:"left",tickFormat:e=>Object(f.a)(e)}))):Object(b.jsx)(r.a.Fragment,null,Object(b.jsx)(a.EuiEmptyPrompt,{"data-test-subj":"executionDurationChartEmpty",body:Object(b.jsx)(r.a.Fragment,null,Object(b.jsx)("p",null,Object(b.jsx)(o.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.executionDurationNoData",defaultMessage:"There is no available run duration information for this rule."})))}))))};var y=n(136);const j=60,O=i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.alertsList.ruleTypeExcessDurationMessage",{defaultMessage:"Duration exceeds the rule's expected run time."}),_=Object(y.a)((e=>{const{ruleId:t,ruleType:n,ruleSummary:r,refreshToken:o,fetchRuleSummary:c=!1,numberOfExecutions:d=j,onChangeDuration:g,loadRuleSummary:p,isLoadingRuleSummary:m=!1}=e,{notifications:{toasts:h}}=Object(u.b)().services,{euiTheme:y}=Object(a.useEuiTheme)(),_=Object(s.useRef)(!1),[S,I]=Object(s.useState)(null),[k,T]=Object(s.useState)(j),[A,E]=Object(s.useState)(!1),v=Object(s.useMemo)((()=>c?S:r),[c,r,S]),U=Object(s.useMemo)((()=>c?k:d),[c,d,k]),w=Object(s.useMemo)((()=>c?A:m),[c,m,A]),L=Object(s.useCallback)((e=>{T(e)}),[T]),M=Object(s.useMemo)((()=>c?L:g||L),[c,g,L]),R=async()=>{if(c){E(!0);try{const e=await p(t,U);I(e)}catch(e){h.addDanger({title:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.ruleExecutionSummaryAndChart.loadSummaryError",{defaultMessage:"Unable to load rule summary: {message}",values:{message:e.message}})})}E(!1)}};Object(s.useEffect)((()=>{R()}),[t,U]),Object(s.useEffect)((()=>{_.current&&R(),_.current=!0}),[o]);const D=Object(s.useMemo)((()=>!!v&&Object(f.b)(n,v.executionDuration.average)),[n,v]);return v?Object(b.jsx)(a.EuiFlexGroup,null,Object(b.jsx)(a.EuiFlexItem,{grow:1},Object(b.jsx)(a.EuiPanel,{"data-test-subj":"avgExecutionDurationPanel",color:D?"warning":"subdued",hasBorder:!1},Object(b.jsx)(a.EuiText,{size:"s",color:"text"},i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.alertsList.avgDurationDescription",{defaultMessage:"Average duration"})),Object(b.jsx)(a.EuiFlexGroup,{gutterSize:"xs",style:{alignItems:"center"}},D&&Object(b.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"ruleDurationWarning"},Object(b.jsx)(a.EuiIconTip,{anchorClassName:"ruleDurationWarningIcon",type:"warning",color:"warning",content:O,"aria-label":O,position:"top",size:"m"})),Object(b.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"ruleEventLogListAvgDuration"},Object(b.jsx)(a.EuiText,{size:"m",color:y.colors.text},Object(b.jsx)("strong",null,Object(f.a)(v.executionDuration.average))))))),Object(b.jsx)(a.EuiFlexItem,{grow:2},Object(b.jsx)(x,{executionDuration:v.executionDuration,numberOfExecutions:U,onChangeDuration:M,isLoading:w}))):Object(b.jsx)(l.a,null)}));var S=n(244);const I="xpack.triggersActionsUI.ruleEventLogList.initialColumns",k={minHeight:400},T=e=>{const{ruleId:t,ruleType:n,localStorageKey:s=I,refreshToken:r,requestRefresh:i,fetchRuleSummary:u=!0}=e,{ruleSummary:l,numberOfExecutions:o,onChangeDuration:c,isLoadingRuleSummary:d=!1}=e;return Object(b.jsx)("div",{style:k,"data-test-subj":"ruleEventLogListContainer"},Object(b.jsx)(a.EuiSpacer,null),Object(b.jsx)(_,{ruleId:t,ruleType:n,ruleSummary:l,numberOfExecutions:o,isLoadingRuleSummary:d,refreshToken:r,onChangeDuration:c,requestRefresh:i,fetchRuleSummary:u}),Object(b.jsx)(a.EuiSpacer,null),Object(b.jsx)(S.a,{localStorageKey:s,ruleId:t,refreshToken:r}))}},132:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const s=({message:e,outcomeFilter:t,runId:n,ruleTypeIds:s})=>{const r=[];if(e){const t=e.replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&");r.push(`(message: "${t}" OR error.message: "${t}")`)}if(t&&t.length){const e=function(e){const t={failure:"event.outcome: failure",warning:"kibana.alerting.outcome: warning",success:"kibana.alerting.outcome:success OR (event.outcome: success AND NOT kibana.alerting.outcome:*)",unknown:"event.outcome: unknown"};return`${e.map((e=>t[e])).join(" OR ")}`}(t);e&&r.push(`(${e})`)}return n&&r.push(`kibana.alert.rule.execution.uuid: ${n}`),null!=s&&s.length&&r.push(`kibana.alert.rule.rule_type_id:(${s.join(" or ")})`),r}},133:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"i",(function(){return d})),n.d(t,"k",(function(){return g})),n.d(t,"g",(function(){return p})),n.d(t,"L",(function(){return m})),n.d(t,"K",(function(){return f})),n.d(t,"J",(function(){return E})),n.d(t,"M",(function(){return v})),n.d(t,"t",(function(){return U})),n.d(t,"v",(function(){return w})),n.d(t,"x",(function(){return L})),n.d(t,"s",(function(){return M})),n.d(t,"u",(function(){return R})),n.d(t,"e",(function(){return D})),n.d(t,"m",(function(){return C})),n.d(t,"n",(function(){return $})),n.d(t,"r",(function(){return F})),n.d(t,"o",(function(){return N})),n.d(t,"p",(function(){return z})),n.d(t,"q",(function(){return P})),n.d(t,"j",(function(){return W})),n.d(t,"l",(function(){return q})),n.d(t,"h",(function(){return J})),n.d(t,"w",(function(){return H})),n.d(t,"f",(function(){return B})),n.d(t,"c",(function(){return G})),n.d(t,"d",(function(){return Y})),n.d(t,"z",(function(){return K})),n.d(t,"y",(function(){return Q})),n.d(t,"G",(function(){return V})),n.d(t,"I",(function(){return X})),n.d(t,"H",(function(){return Z})),n.d(t,"A",(function(){return ee})),n.d(t,"C",(function(){return te})),n.d(t,"B",(function(){return ne})),n.d(t,"D",(function(){return se})),n.d(t,"F",(function(){return re})),n.d(t,"E",(function(){return ae}));var s=n(2);const r=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusOk",{defaultMessage:"Ok"}),a=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusActive",{defaultMessage:"Active"}),i=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusError",{defaultMessage:"Error"}),u=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusLicenseError",{defaultMessage:"License Error"}),l=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusPending",{defaultMessage:"Pending"}),o=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusUnknown",{defaultMessage:"Unknown"}),c=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusWarning",{defaultMessage:"Warning"}),d=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeSucceeded",{defaultMessage:"Succeeded"}),g=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeWarning",{defaultMessage:"Warning"}),p=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeFailed",{defaultMessage:"Failed"}),m={ok:r,active:a,error:i,pending:l,unknown:o,warning:c},f={succeeded:d,warning:g,failed:p},b=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonUnknown",{defaultMessage:"An error occurred for unknown reasons."}),h=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonReading",{defaultMessage:"An error occurred when reading the rule."}),x=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonDecrypting",{defaultMessage:"An error occurred when decrypting the rule."}),y=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonRunning",{defaultMessage:"An error occurred when running the rule."}),j=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonLicense",{defaultMessage:"Cannot run rule"}),O=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonTimeout",{defaultMessage:"Rule execution cancelled due to timeout."}),_=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonDisabled",{defaultMessage:"Rule failed to execute because rule ran after it was disabled."}),S=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonValidate",{defaultMessage:"An error occurred when validating the rule parameters."}),I=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonMaxExecutableActions",{defaultMessage:"Action limit exceeded"}),k=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonMaxQueuedActions",{defaultMessage:"Queued action limit exceeded."}),T=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonMaxAlerts",{defaultMessage:"Alert limit exceeded"}),A=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonUnknown",{defaultMessage:"Unknown reason"}),E={read:h,decrypt:x,execute:y,unknown:b,license:j,timeout:O,disabled:_,validate:S},v={maxExecutableActions:I,maxAlerts:T,maxQueuedActions:k,unknown:A},U=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selectAllAriaLabel",{defaultMessage:"Toggle select all rules"}),w=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selectShowBulkActionsAriaLabel",{defaultMessage:"Show bulk actions"}),L=(e,t)=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalRulesLabel",{values:{formattedTotalRules:e,totalRules:t},defaultMessage:"{formattedTotalRules} {totalRules, plural, =1 {rule} other {rules}}"}),M=(e,t)=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.selectedRulesButton",{values:{formattedSelectedRules:e,selectedRules:t},defaultMessage:"Selected {formattedSelectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),R=(e,t)=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.selectAllRulesButton",{values:{formattedTotalRules:e,totalRules:t},defaultMessage:"Select all {formattedTotalRules} {totalRules, plural, =1 {rule} other {rules}}"}),D=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.clearAllSelectionButton",{defaultMessage:"Clear selection"}),C=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesActiveDescription",{defaultMessage:"Active: {totalStatusesActive}",values:{totalStatusesActive:e}}),$=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesErrorDescription",{defaultMessage:"Error: {totalStatusesError}",values:{totalStatusesError:e}}),F=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesWarningDescription",{defaultMessage:"Warning: {totalStatusesWarning}",values:{totalStatusesWarning:e}}),N=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesOkDescription",{defaultMessage:"Ok: {totalStatusesOk}",values:{totalStatusesOk:e}}),z=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesPendingDescription",{defaultMessage:"Pending: {totalStatusesPending}",values:{totalStatusesPending:e}}),P=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesUnknownDescription",{defaultMessage:"Unknown: {totalStatusesUnknown}",values:{totalStatusesUnknown:e}}),W=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.lastRunOutcomeSucceededDescription",{defaultMessage:"Succeeded: {total}",values:{total:e}}),q=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.lastRunOutcomeWarningDescription",{defaultMessage:"Warning: {total}",values:{total:e}}),J=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.lastRunOutcomeFailedDescription",{defaultMessage:"Failed: {total}",values:{total:e}}),H=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.singleTitle",{defaultMessage:"rule"}),B=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.multipleTitle",{defaultMessage:"rules"}),G=s.i18n.translate("xpack.triggersActionsUI.deleteSelectedIdsConfirmModal.cancelButtonLabel",{defaultMessage:"Cancel"}),Y=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.clearFilterLink",{values:{numberOfFilters:e},defaultMessage:"Clear {numberOfFilters, plural, =1 {filter} other {filters}}"}),K=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.deleteSelectedIdsConfirmModal.descriptionText",{defaultMessage:"You won't be able to recover {numIdsToDelete, plural, one {a deleted {singleTitle}} other {deleted {multipleTitle}}}.",values:{numIdsToDelete:e,singleTitle:t,multipleTitle:n}}),Q=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.deleteSelectedIdsConfirmModal.deleteButtonLabel",{defaultMessage:"Delete {numIdsToDelete, plural, one {{singleTitle}} other {# {multipleTitle}}} ",values:{numIdsToDelete:e,singleTitle:t,multipleTitle:n}}),V=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.deleteSelectedIdsSuccessNotification.descriptionText",{defaultMessage:"Deleted {numSuccesses, number} {numSuccesses, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numSuccesses:e,singleTitle:t,multipleTitle:n}}),X=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.enableSelectedIdsSuccessNotification.descriptionText",{defaultMessage:"Enabled {numSuccesses, number} {numSuccesses, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numSuccesses:e,singleTitle:t,multipleTitle:n}}),Z=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.disableSelectedIdsSuccessNotification.descriptionText",{defaultMessage:"Disabled {numSuccesses, number} {numSuccesses, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numSuccesses:e,singleTitle:t,multipleTitle:n}}),ee=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.deleteSelectedIdsErrorNotification.descriptionText",{defaultMessage:"Failed to delete {numErrors, number} {numErrors, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numErrors:e,singleTitle:t,multipleTitle:n}}),te=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.enableSelectedIdsErrorNotification.descriptionText",{defaultMessage:"Failed to enable {numErrors, number} {numErrors, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numErrors:e,singleTitle:t,multipleTitle:n}}),ne=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.disableSelectedIdsErrorNotification.descriptionText",{defaultMessage:"Failed to disable {numErrors, number} {numErrors, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numErrors:e,singleTitle:t,multipleTitle:n}}),se=(e,t,n,r)=>s.i18n.translate("xpack.triggersActionsUI.components.deleteSelectedIdsPartialSuccessNotification.descriptionText",{defaultMessage:"Deleted {numberOfSuccess, number} {numberOfSuccess, plural, one {{singleTitle}} other {{multipleTitle}}}, {numberOfErrors, number} {numberOfErrors, plural, one {{singleTitle}} other {{multipleTitle}}} encountered errors",values:{numberOfSuccess:e,numberOfErrors:t,singleTitle:n,multipleTitle:r}}),re=(e,t,n,r)=>s.i18n.translate("xpack.triggersActionsUI.components.enableSelectedIdsPartialSuccessNotification.descriptionText",{defaultMessage:"Enabled {numberOfSuccess, number} {numberOfSuccess, plural, one {{singleTitle}} other {{multipleTitle}}}, {numberOfErrors, number} {numberOfErrors, plural, one {{singleTitle}} other {{multipleTitle}}} encountered errors",values:{numberOfSuccess:e,numberOfErrors:t,singleTitle:n,multipleTitle:r}}),ae=(e,t,n,r)=>s.i18n.translate("xpack.triggersActionsUI.components.disableSelectedIdsPartialSuccessNotification.descriptionText",{defaultMessage:"Disabled {numberOfSuccess, number} {numberOfSuccess, plural, one {{singleTitle}} other {{multipleTitle}}}, {numberOfErrors, number} {numberOfErrors, plural, one {{singleTitle}} other {{multipleTitle}}} encountered errors",values:{numberOfSuccess:e,numberOfErrors:t,singleTitle:n,multipleTitle:r}})},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var s=n(12),r=n.n(s),a=(n(1),n(138)),i=n(179),u=n(173),l=n(65),o=n(64),c=n(166),d=n(37),g=n(156),p=n(6);async function m({id:e,http:t}){await t.post(`${p.d}/rule/${encodeURIComponent(e)}/_mute_all`)}async function f({id:e,http:t}){await t.post(`${p.d}/rule/${encodeURIComponent(e)}/_unmute_all`)}const b=({rule_type_state:e,alerts:t,previous_started_at:n,...s})=>({...s,alertTypeState:e,alertInstances:t,previousStartedAt:n});var h=n(132);const x=({id:e,http:t,outcomeFilter:n,message:s,dateStart:r,dateEnd:a,ruleTypeIds:i})=>{const u=Object(h.a)({outcomeFilter:n,message:s,ruleTypeIds:i});return t.get(`${p.m}/rule/${e}/_execution_kpi`,{query:{filter:u.length?u.join(" and "):void 0,date_start:r,date_end:a}})},y=({id:e,http:t,outcomeFilter:n,message:s,dateStart:r,dateEnd:a,namespaces:i,ruleTypeIds:u})=>{const l=Object(h.a)({outcomeFilter:n,message:s,ruleTypeIds:u});return t.get(`${p.m}/_global_execution_kpi`,{query:{filter:l.length?l.join(" and "):void 0,date_start:r,date_end:a,namespaces:i?JSON.stringify(i):i}})},j={timestamp:"@timestamp"},O=({id:e,http:t,dateStart:n,dateEnd:s,runId:r,message:a,perPage:i=10,page:u=0,sort:l,namespace:o,withAuth:c=!1})=>{const d=(e=>e?e.map((e=>{const t=Object.keys(e)[0],n=e[Object.keys(e)[0]];return{[j[t]||t]:{...n}}})):[])(l),g=Object(h.a)({runId:r,message:a});return t.get(`${p.m}/rule/${e}/_action_error_log`,{query:{date_start:n,date_end:s,filter:g.length?g.join(" and "):void 0,per_page:i,page:u+1,sort:d.length?JSON.stringify(d):void 0,namespace:o,with_auth:c}})};var _=n(167),S=n(139),I=n(140),k=n(62),T=n(174),A=n(175),E=n(29),v=n(0);function U(e){return t=>{const{http:n}=Object(E.b)().services;return Object(v.jsx)(e,r()({},t,{muteRules:async e=>async function({ids:e,http:t}){await Promise.all(e.map((e=>m({http:t,id:e}))))}({http:n,ids:e.filter((e=>!w(e))).map((e=>e.id))}),unmuteRules:async e=>async function({ids:e,http:t}){await Promise.all(e.map((e=>f({id:e,http:t}))))}({http:n,ids:e.filter(w).map((e=>e.id))}),muteRule:async e=>{if(!w(e))return await m({http:n,id:e.id})},unmuteRule:async e=>{if(w(e))return await f({http:n,id:e.id})},muteAlertInstance:async(e,t)=>{if(!L(e,t))return Object(c.a)({http:n,id:e.id,instanceId:t})},unmuteAlertInstance:async(e,t)=>{if(L(e,t))return Object(_.a)({http:n,id:e.id,instanceId:t})},loadRule:async e=>Object(l.a)({http:n,ruleId:e}),loadRuleState:async e=>async function({http:e,ruleId:t}){return await e.get(`${p.m}/rule/${t}/state`).then((e=>e?b(e):{}))}({http:n,ruleId:e}),loadRuleSummary:async(e,t)=>Object(o.a)({http:n,ruleId:e,numberOfExecutions:t}),loadRuleTypes:async()=>Object(d.a)({http:n}),loadExecutionLogAggregations:async e=>Object(g.a)({...e,http:n}),loadGlobalExecutionLogAggregations:async e=>Object(g.b)({...e,http:n}),loadActionErrorLog:async e=>O({...e,http:n}),loadExecutionKPIAggregations:async e=>x({...e,http:n}),loadGlobalExecutionKPIAggregations:async e=>y({...e,http:n}),resolveRule:async e=>Object(i.a)({http:n,id:e}),getHealth:async()=>Object(a.a)({http:n}),snoozeRule:async(e,t)=>await Object(S.b)({http:n,id:e.id,snoozeSchedule:t}),bulkSnoozeRules:async e=>await Object(S.a)({http:n,...e}),unsnoozeRule:async(e,t)=>await Object(I.b)({http:n,id:e.id,scheduleIds:t}),bulkUnsnoozeRules:async e=>await Object(I.a)({http:n,...e}),cloneRule:async e=>await Object(u.a)({http:n,ruleId:e}),bulkDeleteRules:async e=>await Object(k.a)({http:n,...e}),bulkEnableRules:async e=>await Object(T.a)({http:n,...e}),bulkDisableRules:async e=>await Object(A.a)({http:n,...e})}))}}function w(e){return!0===e.muteAll}function L(e,t){return e.mutedInstanceIds.findIndex((e=>e===t))>=0}},138:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var s=n(25);async function r({http:e}){const t=await e.get(`${s.b}/_health`),n=a(t.alerting_framework_health);return{...i(t),alertingFrameworkHealth:n}}const a=({decryption_health:e,execution_health:t,read_health:n,...s})=>({decryptionHealth:e,executionHealth:t,readHealth:n,...s}),i=({is_sufficiently_secure:e,has_permanent_encryption_key:t,alerting_framework_health:n,...s})=>({isSufficientlySecure:e,hasPermanentEncryptionKey:t,alertingFrameworkHealth:n,...s})},139:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var s=n(6);function r({id:e,duration:t,rRule:n}){return{...e?{id:e}:{},duration:t,rRule:{...n,...n.until?{until:n.until.toISOString()}:{}}}}async function a({id:e,snoozeSchedule:t,http:n}){await n.post(`${s.m}/rule/${encodeURIComponent(e)}/_snooze`,{body:JSON.stringify({snooze_schedule:r(t)})})}function i({ids:e,filter:t,snoozeSchedule:n,http:a}){let i;try{i=JSON.stringify({ids:null!=e&&e.length?e:void 0,...t?{filter:JSON.stringify(t)}:{},operations:[{operation:"set",field:"snoozeSchedule",value:r(n)}]})}catch(e){throw new Error(`Unable to parse bulk snooze params: ${e}`)}return a.post(`${s.m}/rules/_bulk_edit`,{body:i})}},140:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var s=n(6);async function r({id:e,http:t,scheduleIds:n}){await t.post(`${s.m}/rule/${encodeURIComponent(e)}/_unsnooze`,{body:JSON.stringify({schedule_ids:n})})}function a({ids:e,filter:t,scheduleIds:n,http:r}){let a;try{a=JSON.stringify({ids:null!=e&&e.length?e:void 0,...t?{filter:JSON.stringify(t)}:{},operations:[{operation:"delete",field:"snoozeSchedule",value:n}]})}catch(e){throw new Error(`Unable to parse bulk unsnooze params: ${e}`)}return r.post(`${s.m}/rules/_bulk_edit`,{body:a})}},141:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return u}));const s=e=>{const{uuid:t,id:n,connector_type_id:s,params:r}=e;return{..."group"in e&&e.group?{group:e.group}:{},id:n,params:r,actionTypeId:s,..."use_alert_data_for_template"in e&&void 0!==e.use_alert_data_for_template?{useAlertDataForTemplate:e.use_alert_data_for_template}:{},..."frequency"in e&&e.frequency?{frequency:{summary:e.frequency.summary,notifyWhen:e.frequency.notify_when,throttle:e.frequency.throttle}}:{},..."alerts_filter"in e&&e.alerts_filter?{alertsFilter:e.alerts_filter}:{},...t&&{uuid:t}}},r=({last_execution_date:e,last_duration:t,...n})=>({lastExecutionDate:e,lastDuration:t,...n}),a=({outcome_msg:e,outcome_order:t,alerts_count:n,...s})=>({outcomeMsg:e,outcomeOrder:t,alertsCount:n,...s}),i=({rule_type_id:e,created_by:t,updated_by:n,created_at:i,updated_at:u,api_key_owner:l,api_key_created_by_user:o,notify_when:c,mute_all:d,muted_alert_ids:g,scheduled_task_id:p,execution_status:m,actions:f,snooze_schedule:b,is_snoozed_until:h,active_snoozes:x,last_run:y,next_run:j,alert_delay:O,..._})=>({ruleTypeId:e,createdBy:t,updatedBy:n,createdAt:i,updatedAt:u,apiKeyOwner:l,notifyWhen:c,muteAll:d,mutedInstanceIds:g,snoozeSchedule:b,executionStatus:m?r(m):void 0,actions:f?f.map((e=>s(e))):[],scheduledTaskId:p,isSnoozedUntil:h,activeSnoozes:x,...y?{lastRun:a(y)}:{},...j?{nextRun:j}:{},...void 0!==o?{apiKeyCreatedByUser:o}:{},...O?{alertDelay:O}:{},..._}),u=({alias_target_id:e,alias_purpose:t,outcome:n,...s})=>({...i(s),alias_target_id:e,alias_purpose:t,outcome:n})},156:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}));var s=n(6),r=n(132);const a=({data:e,...t})=>({data:e.map((e=>(e=>{const{duration_ms:t,total_search_duration_ms:n,es_search_duration_ms:s,schedule_delay_ms:r,...a}=e;return{execution_duration:e.duration_ms,total_search_duration:e.total_search_duration_ms,es_search_duration:e.es_search_duration_ms,schedule_delay:e.schedule_delay_ms,...a}})(e))),...t}),i=async({id:e,http:t,dateStart:n,dateEnd:i,outcomeFilter:u,ruleTypeIds:l,message:o,perPage:c=10,page:d=0,sort:g=[]})=>{const p=g,m=Object(r.a)({outcomeFilter:u,message:o,ruleTypeIds:l}),f=await t.get(`${s.m}/rule/${e}/_execution_log`,{query:{date_start:n,date_end:i,filter:m.length?m.join(" and "):void 0,per_page:c,page:d+1,sort:p.length?JSON.stringify(p):void 0}});return a(f)},u=async({http:e,dateStart:t,dateEnd:n,outcomeFilter:i,ruleTypeIds:u,message:l,perPage:o=10,page:c=0,sort:d=[],namespaces:g})=>{const p=d,m=Object(r.a)({outcomeFilter:i,message:l,ruleTypeIds:u}),f=await e.get(`${s.m}/_global_execution_logs`,{query:{date_start:t,date_end:n,filter:m.length?m.join(" and "):void 0,per_page:o,page:c+1,sort:p.length?JSON.stringify(p):void 0,namespaces:g?JSON.stringify(g):void 0}});return a(f)}},166:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);async function r({id:e,instanceId:t,http:n}){await n.post(`${s.d}/rule/${encodeURIComponent(e)}/alert/${encodeURIComponent(t)}/_mute`)}},167:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);async function r({id:e,instanceId:t,http:n}){await n.post(`${s.d}/rule/${encodeURIComponent(e)}/alert/${encodeURIComponent(t)}/_unmute`)}},173:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n(6),r=n(38);async function a({http:e,ruleId:t}){const n=await e.post(`${s.m}/rule/${encodeURIComponent(t)}/_clone`);return Object(r.a)(n)}},174:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);const r=async({filter:e,ids:t,http:n})=>{try{const r=JSON.stringify({ids:null!=t&&t.length?t:void 0,...e?{filter:JSON.stringify(e)}:{}});return n.patch(`${s.m}/rules/_bulk_enable`,{body:r})}catch(e){throw new Error(`Unable to parse bulk enable params: ${e}`)}}},175:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);const r=async({filter:e,ids:t,http:n,untrack:r})=>{try{const a=JSON.stringify({ids:null!=t&&t.length?t:void 0,untrack:r,...e?{filter:JSON.stringify(e)}:{}});return n.patch(`${s.m}/rules/_bulk_disable`,{body:a})}catch(e){throw new Error(`Unable to parse bulk disable params: ${e}`)}}},179:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n(25),r=n(141);async function a({http:e,id:t}){const n=await e.get(`${s.e}/rule/${encodeURIComponent(t)}/_resolve`);return Object(r.b)(n)}},183:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var s=n(33),r=n.n(s),a=n(10),i=n(11);function u(e){if(!e)return"00:00:00.000";const t=r.a.duration(e);return`${[t.hours(),t.minutes(),t.seconds()].map((e=>Object(a.padStart)(`${e}`,2,"0"))).join(":")}.${Object(a.padStart)(`${t.milliseconds()}`,3,"0")}`}function l(e,t){if(!e||!e.ruleTaskTimeout)return!1;const n=e.ruleTaskTimeout;return t>Object(i.parseDuration)(n)}},189:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var s=n(1),r=n(4),a=n(58),i=n.n(a),u=n(29),l=n(156);const o=e=>{var t;return e.includes("now")&&(null===(t=i.a.parse(e))||void 0===t?void 0:t.format())||e},c=e=>"*"===e.id;function d(e){const{http:t}=Object(u.b)().services,n=Object(s.useCallback)((()=>c(e)?Object(l.b)({http:t,...e,dateStart:o(e.dateStart),...e.dateEnd?{dateEnd:o(e.dateEnd)}:{}}):Object(l.a)({http:t,...e,dateStart:o(e.dateStart),...e.dateEnd?{dateEnd:o(e.dateEnd)}:{}})),[e,t]),{data:a,error:i,isLoading:d,isFetching:g,refetch:p}=Object(r.useQuery)({queryKey:["loadRuleEventLog",e],queryFn:n,onError:e.onError,retry:0,refetchOnWindowFocus:!1}),m=Object(s.useMemo)((()=>i&&413===i.body.statusCode),[i]);return Object(s.useMemo)((()=>({data:a,hasExceedLogs:m,isLoading:d||g,loadEventLogs:p})),[a,m,g,d,p])}}}]);