/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[17,55,62],{131:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return o}));const r=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.show},i=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.save},a=(e,t)=>{var n,r;return".sentinelone"===t?null==e||null===(n=e.actions)||void 0===n?void 0:n.save:null==e||null===(r=e.actions)||void 0===r?void 0:r.execute},s=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.delete};function u(e,t){var n,r;return null!==(n=null==t||null===(r=t.authorizedConsumers[e])||void 0===r?void 0:r.all)&&void 0!==n&&n}const o=e=>{var t,n;return null==e||null===(t=e.management)||void 0===t||null===(n=t.security)||void 0===n?void 0:n.api_keys}},134:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(94),i=n(1),a=r.__importDefault(n(135));t.default=function(e,t){var n=i.useState(t),r=n[0],s=n[1];return a.default((function(){var t=e.subscribe(s);return function(){return t.unsubscribe()}}),[e]),r}},135:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;t.default=i},138:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(25);async function i({http:e}){const t=await e.get(`${r.b}/_health`),n=a(t.alerting_framework_health);return{...s(t),alertingFrameworkHealth:n}}const a=({decryption_health:e,execution_health:t,read_health:n,...r})=>({decryptionHealth:e,executionHealth:t,readHealth:n,...r}),s=({is_sufficiently_secure:e,has_permanent_encryption_key:t,alerting_framework_health:n,...r})=>({isSufficientlySecure:e,hasPermanentEncryptionKey:t,alertingFrameworkHealth:n,...r})},141:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));const r=e=>{const{uuid:t,id:n,connector_type_id:r,params:i}=e;return{..."group"in e&&e.group?{group:e.group}:{},id:n,params:i,actionTypeId:r,..."use_alert_data_for_template"in e&&void 0!==e.use_alert_data_for_template?{useAlertDataForTemplate:e.use_alert_data_for_template}:{},..."frequency"in e&&e.frequency?{frequency:{summary:e.frequency.summary,notifyWhen:e.frequency.notify_when,throttle:e.frequency.throttle}}:{},..."alerts_filter"in e&&e.alerts_filter?{alertsFilter:e.alerts_filter}:{},...t&&{uuid:t}}},i=({last_execution_date:e,last_duration:t,...n})=>({lastExecutionDate:e,lastDuration:t,...n}),a=({outcome_msg:e,outcome_order:t,alerts_count:n,...r})=>({outcomeMsg:e,outcomeOrder:t,alertsCount:n,...r}),s=({rule_type_id:e,created_by:t,updated_by:n,created_at:s,updated_at:u,api_key_owner:o,api_key_created_by_user:c,notify_when:l,mute_all:d,muted_alert_ids:f,scheduled_task_id:y,execution_status:b,actions:j,snooze_schedule:p,is_snoozed_until:g,active_snoozes:m,last_run:h,next_run:O,alert_delay:_,...v})=>({ruleTypeId:e,createdBy:t,updatedBy:n,createdAt:s,updatedAt:u,apiKeyOwner:o,notifyWhen:l,muteAll:d,mutedInstanceIds:f,snoozeSchedule:p,executionStatus:b?i(b):void 0,actions:j?j.map((e=>r(e))):[],scheduledTaskId:y,isSnoozedUntil:g,activeSnoozes:m,...h?{lastRun:a(h)}:{},...O?{nextRun:O}:{},...void 0!==c?{apiKeyCreatedByUser:c}:{},..._?{alertDelay:_}:{},...v}),u=({alias_target_id:e,alias_purpose:t,outcome:n,...r})=>({...s(r),alias_target_id:e,alias_purpose:t,outcome:n})},142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var r=void 0;t.setEuiDevProviderWarning=function(e){return r=e},t.getEuiDevProviderWarning=function(){return r},t.emitEuiProviderWarning=function(e){if("function"==typeof r)return r(e);switch(r){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},144:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(12),i=n.n(r),a=n(1),s=n(99),u=n(142),o=n(134),c=n.n(o),l=n(97),d=n.n(l),f=n(3);const y="eui-global",b="eui-utilities",j={darkMode:!1};var p=n(0);const g=[f.euiStylisPrefixer],m=d()({key:"css",stylisPlugins:g,container:document.querySelector('meta[name="emotion"]')}),h=d()({key:y,stylisPlugins:g,container:document.querySelector(`meta[name="${y}"]`)}),O=d()({key:b,stylisPlugins:g,container:document.querySelector(`meta[name="${b}"]`)});m.compat=!0,h.compat=!0,O.compat=!0;const _={default:m,global:h,utility:O},v=({theme:{theme$:e},globalStyles:t,colorMode:n,modify:r,children:i})=>{const s=c()(e,j),u=Object(a.useMemo)((()=>(e=>e.darkMode?f.COLOR_MODES_STANDARD.dark:f.COLOR_MODES_STANDARD.light)(s)),[s]),o=n||u,l=!1!==t&&void 0;return Object(p.jsx)(f.EuiProvider,{cache:_,modify:r,colorMode:o,globalStyles:l,utilityClasses:l},i)},x=({children:e,i18n:t,...n})=>Object(s.useIsNestedEuiProvider)()?(Object(u.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(p.jsx)(t.Context,null,e)):Object(p.jsx)(v,n,Object(p.jsx)(t.Context,null,e));var E=n(100);const S=({children:e,...t})=>Object(p.jsx)(x,i()({globalStyles:!1},t),Object(p.jsx)(E.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(p.jsx)(E.KibanaErrorBoundary,null,e)))},145:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),i=n(96),a=n.n(i),s=n(144),u=n(0);const o=(e,t)=>n=>(a.a.render(Object(u.jsx)(s.a,t,e),n),()=>a.a.unmountComponentAtNode(n));n(16),n(2),r.Component},160:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),i=n(1),a=n.n(i),s=n(3),u=n(0);const o=r.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.seeFullError",{defaultMessage:"See full error"}),c=r.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.hideFullError",{defaultMessage:"Hide full error"}),l=({children:e})=>{const[t,n]=Object(i.useState)(!1),r=Object(i.useCallback)((()=>{n((e=>!e))}),[]);return Object(u.jsx)(a.a.Fragment,null,t&&Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)(s.EuiText,{size:"s"},e),Object(u.jsx)(s.EuiSpacer,null)),Object(u.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButton,{size:"s",color:"danger",onClick:r},t?c:o))))}},170:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);const i=async({http:e})=>e.get(`${r.d}/_config`)},178:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25);const i=async({http:e})=>{const t=await e.get(`${r.d}/_health`);return t?{isRulesAvailable:t.isAlertsAvailable}:t}},190:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(25),i=n(141);async function a({http:e,rule:t}){const n=await e.post(`${r.b}/rule`,{body:JSON.stringify(s(t))});return Object(i.c)(n)}const s=({ruleTypeId:e,actions:t,alertDelay:n,...r})=>({...r,rule_type_id:e,actions:t.map((e=>{const{id:t,params:n}=e;return{..."group"in e&&e.group?{group:e.group}:{},id:t,params:n,..."frequency"in e&&e.frequency?{frequency:{notify_when:e.frequency.notifyWhen,throttle:e.frequency.throttle,summary:e.frequency.summary}}:{},..."alertsFilter"in e&&e.alertsFilter?{alerts_filter:e.alertsFilter}:{},..."useAlertDataForTemplate"in e&&void 0!==e.useAlertDataForTemplate?{use_alert_data_for_template:e.useAlertDataForTemplate}:{}}})),...n?{alert_delay:n}:{}})},191:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return o}));const r=({actions:e,alertDelay:t,...n})=>({...n,actions:e.map((e=>{const{id:t,params:n,uuid:r}=e;return{..."group"in e?{group:e.group}:{},id:t,params:n,..."frequency"in e?{frequency:e.frequency?{notify_when:e.frequency.notifyWhen,throttle:e.frequency.throttle,summary:e.frequency.summary}:void 0}:{},..."alertsFilter"in e?{alerts_filter:e.alertsFilter}:{},..."useAlertDataForTemplate"in e&&void 0!==e.useAlertDataForTemplate?{use_alert_data_for_template:e.useAlertDataForTemplate}:{},...r&&{uuid:r}}})),...t?{alert_delay:t}:{}});var i=n(10),a=n(25),s=n(141);const u=["name","tags","schedule","params","alertDelay","actions"];async function o({http:e,rule:t,id:n}){const o=await e.put(`${a.b}/rule/${encodeURIComponent(n)}`,{body:JSON.stringify(r(Object(i.pick)(t,u)))});return Object(s.c)(o)}},214:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(10),i=n(2);const a=e=>({isEnabled:!1,message:i.i18n.translate("xpack.triggersActionsUI.checkRuleTypeEnabled.ruleTypeDisabledByLicenseMessage",{defaultMessage:"This rule type requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(r.upperFirst)(e.minimumLicenseRequired)}})});function s(e){return!1===(null==e?void 0:e.enabledInLicense)?a(e):{isEnabled:!0}}},81:function(e,t,n){"use strict";n.r(t),n.d(t,"RuleEdit",(function(){return F})),n.d(t,"default",(function(){return F}));var r=n(1),i=n.n(r),a=n(24),s=n(11),u=n(3),o=n(10),c=n(2),l=n(145),d=n(191),f=n(170),y=n(19),b=n(222),j=n(215),p=n(185),g=n(37),m=n(172),h=n(143),O=n(29),_=n(216),v=n(217),x=n(60),E=n(160),S=n(218),k=n(0);const w=c.i18n.translate("xpack.triggersActionsUI.sections.ruleEdit.saveErrorNotificationText",{defaultMessage:"Cannot update rule."}),T=e=>{const t=Object(o.cloneDeep)(Object(o.omit)(e,"notifyWhen","throttle")),n=Boolean(e.notifyWhen),r=Boolean(e.throttle);if(n||r){const r=n?{summary:!1,notifyWhen:e.notifyWhen,throttle:e.notifyWhen===s.RuleNotifyWhen.THROTTLE?e.throttle:null}:{summary:!1,notifyWhen:s.RuleNotifyWhen.THROTTLE,throttle:e.throttle};t.actions=t.actions.map((e=>(e=>"group"in e&&Boolean(e.group))(e)?{...e,frequency:r}:e))}return t},F=({initialRule:e,onClose:t,reloadRules:n,onSave:o,hideInterval:F,ruleTypeRegistry:C,actionTypeRegistry:A,metadata:I,...R})=>{const D=null!=o?o:n,M=Object(r.useMemo)((()=>Object(p.a)(A)),[A]),[{rule:q},B]=Object(r.useReducer)(M,{rule:T(e)}),[P,W]=Object(r.useState)(!1),[U,L]=Object(r.useState)(!1),[z,N]=Object(r.useState)(!1),[H,$]=Object(r.useState)(!1),[K,G]=Object(r.useState)(!1),[J,V]=Object(r.useState)(!1),[Q,X]=Object(r.useState)([]),[Y,Z]=Object(r.useState)(!1),[ee,te]=Object(r.useState)(R.ruleType),[ne,re]=Object(r.useState)({isUsingSecurity:!1}),[ie,ae]=Object(r.useState)(I),se=Object(r.useCallback)((e=>ae(e)),[]),{http:ue,notifications:{toasts:oe},i18n:ce,theme:le,isServerless:de}=Object(O.b)().services,fe=C.get(q.ruleTypeId);Object(r.useEffect)((()=>{(async()=>{re(await Object(f.a)({http:ue}))})()}),[ue]),Object(r.useEffect)((()=>{(async()=>{Z(!0);const e=await Object(j.a)(q.actions,A);X([...e]),Z(!1)})()}),[q.actions,A]),Object(r.useEffect)((()=>{R.ruleType||ee||(async()=>{const e=await Object(g.a)({http:ue});for(const t of e)fe.id===t.id&&te(t)})()}),[R.ruleType,fe.id,ee,ue]);const{ruleBaseErrors:ye,ruleErrors:be,ruleParamsErrors:je}=Object(j.b)(q,fe,ne,A,de),pe=()=>{Object(v.a)(q,e,!0)?$(!0):t(y.l.CANCELED,ie)};return Object(r.useEffect)((()=>{V(Object(j.c)(q,be,Q))}),[q,be,Q]),Object(k.jsx)(u.EuiPortal,null,Object(k.jsx)(u.EuiFlyout,{onClose:pe,"aria-labelledby":"flyoutRuleEditTitle",size:"m",maxWidth:620,ownFocus:!0},Object(k.jsx)(u.EuiFlyoutHeader,{hasBorder:!0},Object(k.jsx)(u.EuiTitle,{size:"s","data-test-subj":"editRuleFlyoutTitle"},Object(k.jsx)("h3",{id:"flyoutTitle"},Object(k.jsx)(a.FormattedMessage,{defaultMessage:"Edit rule",id:"xpack.triggersActionsUI.sections.ruleEdit.flyoutTitle"})))),Object(k.jsx)(h.a,null,Object(k.jsx)(m.a,{inFlyout:!0,waitForCheck:!0},Object(k.jsx)(u.EuiFlyoutBody,null,U&&Object(k.jsx)(i.a.Fragment,null,Object(k.jsx)(u.EuiCallOut,{size:"s",color:"danger",iconType:"error","data-test-subj":"hasActionsDisabled",title:c.i18n.translate("xpack.triggersActionsUI.sections.ruleEdit.disabledActionsWarningTitle",{defaultMessage:"This rule has actions that are disabled"})}),Object(k.jsx)(u.EuiSpacer,null)),Object(k.jsx)(b.a,{rule:q,config:ne,dispatch:B,errors:be,actionTypeRegistry:A,hideInterval:F,ruleTypeRegistry:C,canChangeTrigger:!1,setHasActionsDisabled:L,setHasActionsWithBrokenConnector:N,operation:c.i18n.translate("xpack.triggersActionsUI.sections.ruleEdit.operationName",{defaultMessage:"edit"}),metadata:ie,onChangeMetaData:se})),Object(k.jsx)(u.EuiFlyoutFooter,null,Object(k.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(k.jsx)(u.EuiFlexItem,{grow:!1},Object(k.jsx)(u.EuiButtonEmpty,{"data-test-subj":"cancelSaveEditedRuleButton",onClick:()=>pe()},c.i18n.translate("xpack.triggersActionsUI.sections.ruleEdit.cancelButtonLabel",{defaultMessage:"Cancel"}))),Y?Object(k.jsx)(u.EuiFlexItem,{grow:!1},Object(k.jsx)(u.EuiSpacer,{size:"s"}),Object(k.jsx)(u.EuiLoadingSpinner,{size:"l"})):Object(k.jsx)(i.a.Fragment,null),Object(k.jsx)(u.EuiFlexItem,{grow:!1},Object(k.jsx)(u.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},Object(k.jsx)(u.EuiFlexItem,{grow:!1},Object(k.jsx)(u.EuiButton,{fill:!0,color:"primary","data-test-subj":"showEditedRequestButton",isDisabled:!J,onClick:()=>{G(!0)}},Object(k.jsx)(a.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleEdit.showRequestButtonLabel",defaultMessage:"Show API request"}))),Object(k.jsx)(u.EuiFlexItem,{grow:!1},Object(k.jsx)(u.EuiButton,{fill:!0,color:"success","data-test-subj":"saveEditedRuleButton",type:"submit",iconType:"check",isLoading:P,onClick:async()=>await async function(){W(!0);try{if(Y||!Object(j.c)(q,be,Q)||z)n=Object(x.a)(q,je,ye,Q),B({command:{type:"setRule"},payload:{key:"rule",value:n}});else{const e=await Object(d.c)({http:ue,rule:q,id:q.id});oe.addSuccess(c.i18n.translate("xpack.triggersActionsUI.sections.ruleEdit.saveSuccessNotificationText",{defaultMessage:"Updated ''{ruleName}''",values:{ruleName:e.name}})),t(y.l.SAVED,ie),D&&D(ie)}}catch(t){var e;const n=Object(s.parseRuleCircuitBreakerErrorMessage)((null===(e=t.body)||void 0===e?void 0:e.message)||w);oe.addDanger({title:n.summary,...n.details&&{text:Object(l.a)(Object(k.jsx)(E.a,null,n.details),{i18n:ce,theme:le})}})}var n;W(!1)}()},Object(k.jsx)(a.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleEdit.saveButtonLabel",defaultMessage:"Save"}))),ne.isUsingSecurity&&Object(k.jsx)(u.EuiFlexItem,{grow:!1},Object(k.jsx)(u.EuiIconTip,{type:"warning",position:"top","data-test-subj":"changeInPrivilegesTip",content:c.i18n.translate("xpack.triggersActionsUI.sections.ruleEdit.changeInPrivilegesLabel",{defaultMessage:"Saving this rule will change its privileges and might change its behavior."})})))))))),H&&Object(k.jsx)(_.a,{onConfirm:()=>{$(!1),t(y.l.CANCELED,ie)},onCancel:()=>{$(!1)}}),K&&Object(k.jsx)(S.a,{onClose:()=>{G(!1)},rule:q,ruleId:q.id,edit:!0})))}}}]);