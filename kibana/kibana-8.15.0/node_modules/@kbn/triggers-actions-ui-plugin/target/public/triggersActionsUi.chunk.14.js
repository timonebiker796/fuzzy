/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[14,64,65,66],{102:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleTagBadge",(function(){return c})),s.d(t,"default",(function(){return c}));var a=s(1),l=s(2),i=s(3),n=s(0);const r=l.i18n.translate("xpack.triggersActionsUI.sections.rules_list.rules_tag_badge.tagTitle",{defaultMessage:"Tag"}),o={width:"300px"},u=e=>`ruleTagBadgeItem-${e}`,c=e=>{const{tagsOutPopover:t=!1,tags:s=[],badgeDataTestSubj:l="ruleTagBadge",titleDataTestSubj:c="ruleTagPopoverTitle",tagItemDataTestSubj:d=u}=e,{isOpen:b,onClose:j,onClick:p}=e,g=Object(a.useMemo)((()=>Object(n.jsx)(i.EuiBadge,{"data-test-subj":l,color:"hollow",iconType:"tag",iconSide:"left",tabIndex:-1,onClick:p,onClickAriaLabel:"Tags",iconOnClick:p,iconOnClickAriaLabel:"Tags"},s.length)),[l,p,s.length]),m=Object(a.useMemo)((()=>s.map(((e,t)=>Object(n.jsx)(i.EuiBadge,{"data-test-subj":d(e),key:t,color:"hollow",iconType:"tag",iconSide:"left"},e)))),[s,d]);return t?Object(n.jsx)(i.EuiFlexGroup,{"data-test-subj":"tagsOutPopover",style:{marginLeft:0},wrap:!0},m):Object(n.jsx)(i.EuiPopover,{button:g,anchorPosition:"upCenter",isOpen:b,closePopover:j},Object(n.jsx)(i.EuiPopoverTitle,{"data-test-subj":c},r),Object(n.jsx)("div",{style:o},m))}},108:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleStatusDropdown",(function(){return f})),s.d(t,"futureTimeToInterval",(function(){return y})),s.d(t,"default",(function(){return f}));var a=s(1),l=s.n(a),i=s(33),n=s.n(i),r=s(2),o=s(145),u=s(11),c=s(3),d=s(29),b=s(169),j=s(17),p=s(160),g=s(188),m=s(0);const O="LL @ LT",f=({rule:e,onRuleChanged:t,disableRule:s,enableRule:i,snoozeRule:r,unsnoozeRule:b,isEditable:f,hideSnoozeOption:y=!1,direction:T="column"})=>{const{notifications:{toasts:I},i18n:C,theme:F}=Object(d.b)().services,[R,L]=Object(a.useState)(!1),[A,M]=Object(a.useState)(!1),[w,z]=Object(a.useState)(!1),P=!y&&Object(j.d)(e),U=Object(a.useCallback)((()=>M((e=>!e))),[M]),_=Object(a.useCallback)((()=>M(!1)),[M]),D=Object(a.useCallback)((async()=>{const{errors:e}=await i();if(!e.length)return;const t=Object(u.parseRuleCircuitBreakerErrorMessage)(e[0].message);throw I.addDanger({title:t.summary,...t.details&&{text:Object(o.a)(Object(m.jsx)(p.a,null,t.details),{i18n:C,theme:F})}}),new Error}),[C,F,i,I]),B=Object(a.useCallback)((async()=>{L(!0);try{await D(),t()}finally{L(!1)}}),[t,D]),N=Object(a.useCallback)((async e=>{L(!0);try{await s(e),t()}finally{L(!1)}}),[t,s]),$=Object(a.useCallback)((()=>{z(!0)}),[]),q=Object(a.useCallback)((()=>{z(!1)}),[]),G=Object(a.useCallback)((e=>{q(),N(e)}),[q,N]),H=Object(a.useCallback)((async t=>{e.enabled!==t&&(t?await B():$())}),[e.enabled,B,$]),K=Object(a.useCallback)((async e=>{try{await r(e),t()}finally{_()}}),[r,t,_]),W=Object(a.useCallback)((async e=>{try{await b(e),t()}finally{_()}}),[b,t,_]),Q=e.enabled?P?"warning":"primary":"default",J=e.enabled?P?E:h:S,V=e.enabled&&P?Object(m.jsx)(c.EuiToolTip,{content:e.muteAll?k:n()(new Date(e.isSnoozedUntil)).format(O)},Object(m.jsx)(c.EuiText,{color:"subdued",size:"xs"},e.muteAll?k:n()(new Date(e.isSnoozedUntil)).fromNow(!0))):null,Y=Object(m.jsx)(c.EuiBadge,{color:Q,"data-test-subj":"statusDropdownReadonly"},J),Z=Object(m.jsx)(c.EuiBadge,{"data-test-subj":"ruleStatusDropdownBadge",color:Q,iconSide:"right",iconType:!R&&f?"arrowDown":void 0,onClick:U,iconOnClick:U,onClickAriaLabel:v,iconOnClickAriaLabel:v,isDisabled:R},J,R&&Object(m.jsx)(c.EuiLoadingSpinner,{style:{marginLeft:"4px",marginRight:"4px"},size:"s"}));return Object(m.jsx)(l.a.Fragment,null,Object(m.jsx)(c.EuiFlexGroup,{direction:T,alignItems:"row"===T?"center":"flexStart",justifyContent:"flexStart",gutterSize:"row"===T?"s":"xs",responsive:!1},Object(m.jsx)(c.EuiFlexItem,{grow:!1},f?Object(m.jsx)(c.EuiPopover,{button:Z,isOpen:A&&f,closePopover:_,panelPaddingSize:"s","data-test-subj":"statusDropdown",title:J},Object(m.jsx)(x,{onClosePopover:_,onChangeEnabledStatus:H,isEnabled:e.enabled,isSnoozed:P,snoozeEndTime:e.isSnoozedUntil,hideSnoozeOption:y,snoozeRule:K,unsnoozeRule:W,scheduledSnoozes:e.snoozeSchedule,activeSnoozes:e.activeSnoozes})):Y),Object(m.jsx)(c.EuiFlexItem,{"data-test-subj":"remainingSnoozeTime",grow:!1},V)),w&&Object(m.jsx)(g.a,{onConfirm:G,onCancel:q}))},x=({onChangeEnabledStatus:e,onClosePopover:t,isEnabled:s,isSnoozed:i,snoozeEndTime:r,hideSnoozeOption:o=!1,snoozeRule:u,unsnoozeRule:d,scheduledSnoozes:j=[],activeSnoozes:p=[]})=>{const g=Object(a.useCallback)((()=>{i?d():e(!0),t()}),[e,t,d,i]),f=Object(a.useCallback)((()=>{e(!1),t()}),[e,t]);let x=Object(m.jsx)(c.EuiText,{size:"s"},T);i&&r&&(x=Object(m.jsx)(l.a.Fragment,null,Object(m.jsx)(c.EuiText,{size:"s"},T)," ",Object(m.jsx)(c.EuiText,{size:"xs",color:"subdued"},n()(r).format(O))));const E=[{id:0,width:360,items:[{name:h,icon:s&&!i?"check":"empty",onClick:g,"data-test-subj":"statusDropdownEnabledItem"},{name:S,icon:s?"empty":"check",onClick:f,"data-test-subj":"statusDropdownDisabledItem"},...o?[]:[{name:x,icon:s&&i?"check":"empty",panel:1,disabled:!s,"data-test-subj":"statusDropdownSnoozeItem"}]]},...o?[]:[{id:1,width:400,title:T,content:Object(m.jsx)(c.EuiPanel,{paddingSize:"none",hasShadow:!1},Object(m.jsx)(b.a,{interval:y(r),showCancel:i,snoozeRule:u,unsnoozeRule:d,scheduledSnoozes:j,activeSnoozes:p,hasTitle:!1}))}]];return Object(m.jsx)(c.EuiContextMenu,{"data-test-subj":"ruleStatusMenu",initialPanelId:0,panels:E})},y=e=>{if(!e)return;const t=n()(e).locale("en").fromNow(!0),[s,a]=t.split(" ");let l,i="a"===s||"an"===s?1:parseInt(s,10);switch(a){case"year":case"years":l="M",i*=12;break;case"month":case"months":l="M";break;case"day":case"days":l="d";break;case"hour":case"hours":l="h";break;case"minute":case"minutes":l="m"}return l?`${i}${l}`:void 0},h=r.i18n.translate("xpack.triggersActionsUI.sections.rulesList.enabledRuleStatus",{defaultMessage:"Enabled"}),S=r.i18n.translate("xpack.triggersActionsUI.sections.rulesList.disabledRuleStatus",{defaultMessage:"Disabled"}),E=r.i18n.translate("xpack.triggersActionsUI.sections.rulesList.snoozedRuleStatus",{defaultMessage:"Snoozed"}),T=r.i18n.translate("xpack.triggersActionsUI.sections.rulesList.snoozeMenuTitle",{defaultMessage:"Snooze"}),v=r.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusDropdownMenuLabel",{defaultMessage:"Change rule status or snooze"}),k=r.i18n.translate("xpack.triggersActionsUI.sections.rulesList.remainingSnoozeIndefinite",{defaultMessage:"Indefinitely"})},109:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleStatusFilter",(function(){return c})),s.d(t,"default",(function(){return c}));var a=s(1),l=s(2),i=s(24),n=s(3),r=s(0);const o=[{key:"enabled",label:l.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilter.enabledOptionText",{defaultMessage:"Rule is enabled"})},{key:"disabled",label:l.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilter.disabledOptionText",{defaultMessage:"Rule is disabled"})},{key:"snoozed",label:l.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilter.snoozedOptionText",{defaultMessage:"Rule has snoozed"})}],u=e=>`ruleStatusFilterOption-${e}`,c=e=>{const{selectedStatuses:t=[],dataTestSubj:s="ruleStatusFilter",selectDataTestSubj:l="ruleStatusFilterSelect",buttonDataTestSubj:c="ruleStatusFilterButton",optionDataTestSubj:d=u,onChange:b=(()=>{})}=e,[j,p]=Object(a.useState)(!1),g=Object(a.useCallback)((e=>{const t=e.filter((({checked:e})=>"on"===e)).map((({key:e})=>e));b(t)}),[b]),m=Object(a.useCallback)((()=>{p((e=>!e))}),[p]),O=Object(a.useMemo)((()=>o.map((({key:e,label:s})=>({key:e,label:s,"data-test-subj":d(e),checked:t.includes(e)?"on":void 0})))),[d,t]);return Object(r.jsx)(n.EuiFilterGroup,{"data-test-subj":s},Object(r.jsx)(n.EuiPopover,{isOpen:j,closePopover:()=>p(!1),button:Object(r.jsx)(n.EuiFilterButton,{"data-test-subj":c,iconType:"arrowDown",hasActiveFilters:t.length>0,numActiveFilters:t.length,numFilters:t.length,onClick:m},Object(r.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilterButton",defaultMessage:"Rule state"}))},Object(r.jsx)("div",{"data-test-subj":l},Object(r.jsx)(n.EuiSelectable,{options:O,onChange:g,listProps:{bordered:!1,style:{minWidth:300}}},(e=>e)))))}},111:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleTagFilter",(function(){return x})),s.d(t,"default",(function(){return x}));var a=s(1),l=s.n(a),i=s(2),n=s(24),r=s(3),o=s(4),u=s(69),c=s(29);const d=[];var b=s(0);const j=e=>`ruleTagFilterOption-${e}`,p=i.i18n.translate("xpack.triggersActionsUI.sections.ruleTagFilter.loading",{defaultMessage:"Loading tags"}),g=[],m=Object(a.memo)((({label:e,setObserver:t,canSetObserver:s})=>{const l=Object(a.useCallback)((e=>{s&&e&&t(e)}),[s,t]);return Object(b.jsx)("div",{ref:l},e)})),O=Object(a.memo)((({selectedTags:e,onClosePopover:t,buttonDataTestSubj:s})=>Object(b.jsx)(r.EuiFilterButton,{"data-test-subj":s,iconType:"arrowDown",hasActiveFilters:e.length>0,numActiveFilters:e.length,numFilters:e.length,onClick:t},Object(b.jsx)(n.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleTagFilterButton",defaultMessage:"Tags"})))),f=Object(a.memo)((({options:e,renderOption:t,onChange:s,onSearchTextChange:a,isLoading:i,loadingMessage:n,noMatchesMessage:o,emptyMessage:u,errorMessage:c,selectableDataTestSubj:d})=>Object(b.jsx)(r.EuiSelectable,{searchable:!0,searchProps:{onChange:a},listProps:{activeOptionIndex:void 0},"data-test-subj":d,options:e,noMatchesMessage:i?n:o,emptyMessage:i?n:u,errorMessage:c,renderOption:t,onChange:s},((e,t)=>Object(b.jsx)(l.a.Fragment,null,t,Object(b.jsx)(r.EuiSpacer,{size:"xs"}),e))))),x=Object(a.memo)((e=>{const{selectedTags:t=g,isGrouped:s=!1,canLoadRules:n=!0,refresh:x,loadingMessage:y=p,noMatchesMessage:h,emptyMessage:S,errorMessage:E,dataTestSubj:T="ruleTagFilter",selectableDataTestSubj:v="ruleTagFilterSelectable",optionDataTestSubj:k=j,buttonDataTestSubj:I="ruleTagFilterButton",onChange:C=(()=>{})}=e,F=Object(a.useRef)(),[R,L]=Object(a.useState)(""),[A,M]=Object(a.useState)(!1),{tags:w=g,isLoading:z,hasNextPage:P,fetchNextPage:U}=function(e){const{enabled:t,refresh:s,search:l,perPage:n,page:r=1}=e,{http:b,notifications:{toasts:j}}=Object(c.b)().services,{refetch:p,data:g,fetchNextPage:m,isLoading:O,isFetching:f,hasNextPage:x,isFetchingNextPage:y}=Object(o.useInfiniteQuery)({queryKey:["loadRuleTags",l,n,r,{refresh:null==s?void 0:s.toISOString()}],queryFn:({pageParam:e})=>e?Object(u.b)({http:b,perPage:e.perPage,page:e.page,search:l}):Object(u.b)({http:b,perPage:n,page:r,search:l}),onError:()=>{j.addDanger(i.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadRuleTags",{defaultMessage:"Unable to load rule tags"}))},enabled:t,getNextPageParam:e=>{if(Math.max(1,Math.ceil(e.total/e.perPage))!==e.page)return{...e,page:e.page+1}},refetchOnWindowFocus:!1});return{tags:Object(a.useMemo)((()=>(null==g?void 0:g.pages.reduce(((e,t)=>e.concat(t.data)),[]))||d),[g]),hasNextPage:x,refetch:p,isLoading:O||f||y,fetchNextPage:m}}({enabled:n,refresh:x,search:R}),_=Object(a.useCallback)((async()=>{var e;P&&!z&&(await U(),null===(e=F.current)||void 0===e||e.disconnect())}),[U,P,z]);Object(a.useEffect)((()=>()=>{var e;return null===(e=F.current)||void 0===e?void 0:e.disconnect()}),[]);const D=Object(a.useMemo)((()=>[...new Set(t.sort().concat(w))]),[t,w]),B=Object(a.useCallback)((e=>{var t,s;null===(t=F.current)||void 0===t||t.disconnect(),F.current=new IntersectionObserver(_,{root:null,threshold:1}),null===(s=F.current)||void 0===s||s.observe(e)}),[_]),N=Object(a.useMemo)((()=>D.map((e=>({label:e,checked:t.includes(e)?"on":void 0,"data-test-subj":k(e)})))),[D,t,k]),$=Object(a.useCallback)((e=>Object(b.jsx)(m,{label:e.label,setObserver:B,canSetObserver:e.label===D[D.length-1]})),[B,D]),q=Object(a.useCallback)((e=>{const t=e.reduce(((e,t)=>("on"===t.checked&&(e=[...e,t.label]),e)),[]);C(t)}),[C]),G=Object(a.useCallback)((e=>{L(e)}),[L]),H=Object(a.useCallback)((()=>{M((e=>!e))}),[M]),K=Object(a.useMemo)((()=>s?l.a.Fragment:r.EuiFilterGroup),[s]);return Object(b.jsx)(K,s?{}:{"data-test-subj":"ruleTagFilterUngrouped"},Object(b.jsx)(r.EuiPopover,{"data-test-subj":T,isOpen:A,closePopover:H,button:Object(b.jsx)(O,{selectedTags:t,onClosePopover:H,buttonDataTestSubj:I})},Object(b.jsx)(f,{isLoading:z,options:N,renderOption:$,onChange:q,onSearchTextChange:G,loadingMessage:y,noMatchesMessage:h,emptyMessage:S,errorMessage:E,selectableDataTestSubj:v})))}))},116:function(e,t,s){"use strict";s.r(t),s.d(t,"percentileFields",(function(){return Rt})),s.d(t,"RulesList",(function(){return Mt})),s.d(t,"default",(function(){return Mt}));var a=s(2),l=s(10),i=s(24),n=s(145),r=s(11),o=s(12),u=s.n(o),c=s(1),d=s.n(c),b=s(73),j=s(4),p=s(170);s(178),s(138),s(190),s(191),s(179);var g=s(3);const m={apm:a.i18n.translate("alertsUIShared.producerDisplayNames.apm",{defaultMessage:"APM and User Experience"}),uptime:a.i18n.translate("alertsUIShared.producerDisplayNames.uptime",{defaultMessage:"Synthetics and Uptime"}),stackAlerts:a.i18n.translate("alertsUIShared.producerDisplayNames.stackAlerts",{defaultMessage:"Stack Alerts"}),metrics:a.i18n.translate("alertsUIShared.producerDisplayNames.metrics",{defaultMessage:"Metrics"}),logs:a.i18n.translate("alertsUIShared.producerDisplayNames.logs",{defaultMessage:"Logs"}),siem:a.i18n.translate("alertsUIShared.producerDisplayNames.siem",{defaultMessage:"Security"}),observability:a.i18n.translate("alertsUIShared.producerDisplayNames.observability",{defaultMessage:"Observability"}),ml:a.i18n.translate("alertsUIShared.producerDisplayNames.ml",{defaultMessage:"Machine Learning"}),slo:a.i18n.translate("alertsUIShared.producerDisplayNames.slo",{defaultMessage:"SLOs"}),infrastructure:a.i18n.translate("alertsUIShared.producerDisplayNames.infrastructure",{defaultMessage:"Infrastructure"}),monitoring:a.i18n.translate("alertsUIShared.producerDisplayNames.monitoring",{defaultMessage:"Stack Monitoring"})};var O=s(0);const f=e=>{var t;return null!==(t=Reflect.get(m,e))&&void 0!==t?t:e},x=(e,t)=>e.enabledInLicense===t.enabledInLicense?e.name.localeCompare(t.name):e.enabledInLicense?-1:1,y=({ruleTypes:e,onSelectRuleType:t,onFilterByProducer:s,selectedProducer:i,ruleTypeCountsByProducer:n,onClearFilters:r,showCategories:o=!0})=>{const u=[...e].sort(x),{euiTheme:b}=Object(g.useEuiTheme)(),j=Object(c.useMemo)((()=>Object.entries(Object(l.omit)(n,"total")).sort((([,e],[,t])=>t-e)).map((([e,t])=>Object(O.jsx)(g.EuiFacetButton,{key:e,fullWidth:!0,quantity:t,onClick:()=>s(e),isSelected:i===e},f(e))))),[n,s,i]),p=Object(c.useCallback)((()=>s(null)),[s]);return Object(O.jsx)(g.EuiFlexGroup,{style:{height:"100%"}},o&&Object(O.jsx)(g.EuiFlexItem,{grow:1,style:{paddingTop:b.size.base}},Object(O.jsx)(g.EuiFacetGroup,null,Object(O.jsx)(g.EuiFacetButton,{fullWidth:!0,quantity:n.total,onClick:p,isSelected:!i},a.i18n.translate("alertsUIShared.components.ruleTypeModal.allRuleTypes",{defaultMessage:"All"})),j)),Object(O.jsx)(g.EuiFlexItem,{grow:3,style:{overflowY:"auto",padding:`${b.size.base} ${b.size.base} ${b.size.xl}`}},0===u.length&&Object(O.jsx)(g.EuiEmptyPrompt,{color:"subdued",iconType:"search",title:Object(O.jsx)("h2",null,a.i18n.translate("alertsUIShared.components.ruleTypeModal.noRuleTypesErrorTitle",{defaultMessage:"No rule types found"})),body:Object(O.jsx)("p",null,a.i18n.translate("alertsUIShared.components.ruleTypeModal.noRuleTypesErrorBody",{defaultMessage:"Try a different search or change your filter settings"}),"."),actions:Object(O.jsx)(g.EuiButton,{size:"s",color:"primary",fill:!0,onClick:r},"Clear filters")}),u.map((e=>Object(O.jsx)(d.a.Fragment,{key:e.id},Object(O.jsx)(g.EuiCard,{titleSize:"xs",textAlign:"left",hasBorder:!0,title:e.name,onClick:()=>t(e.id),description:Object(O.jsx)(d.a.Fragment,null,e.description,e.description&&Object(O.jsx)(g.EuiSpacer,{size:"s"}),Object(O.jsx)(g.EuiText,{color:"subdued",size:"xs",style:{textTransform:"uppercase",fontWeight:b.font.weight.bold}},f(e.producer))),style:{marginRight:"8px",flexGrow:0},"data-test-subj":`${e.id}-SelectOption`,isDisabled:!1===e.enabledInLicense}),Object(O.jsx)(g.EuiSpacer,{size:"s"}))))))},h=Object(O.jsx)(g.EuiEmptyPrompt,{title:Object(O.jsx)("h2",null,a.i18n.translate("alertsUIShared.components.ruleTypeModal.loadingRuleTypes",{defaultMessage:"Loading rule types"})),icon:Object(O.jsx)(g.EuiLoadingSpinner,{size:"xl"})}),S=({onClose:e,onSelectRuleType:t,onFilterByProducer:s,onChangeSearch:l,ruleTypes:i,ruleTypesLoading:n,ruleTypeCountsByProducer:r,searchString:o,selectedProducer:u,showCategories:d})=>{var b;const{euiTheme:j}=Object(g.useEuiTheme)(),p=null!==(b=Object(g.useCurrentEuiBreakpoint)())&&void 0!==b?b:"m",m=["s","xs"].includes(p),f=Object(c.useCallback)((()=>{s(null),l("")}),[s,l]);return Object(O.jsx)(g.EuiModal,{onClose:e,maxWidth:j.breakpoint[p],style:{width:j.breakpoint[p],maxHeight:m?"initial":"960px",height:m?"initial":"80vh",overflow:m?"auto":"hidden"},"data-test-subj":"ruleTypeModal"},Object(O.jsx)(g.EuiPanel,{paddingSize:"m",style:m?{}:{maxHeight:"100%"}},Object(O.jsx)(g.EuiFlexGroup,{direction:"column",style:{height:"100%"}},Object(O.jsx)(g.EuiFlexItem,{grow:0},Object(O.jsx)(g.EuiPageHeader,{bottomBorder:"extended",paddingSize:"m"},Object(O.jsx)(g.EuiPageHeaderSection,{style:{width:"100%"}},Object(O.jsx)(g.EuiTitle,{size:"s"},Object(O.jsx)("h1",null,a.i18n.translate("alertsUIShared.components.ruleTypeModal.title",{defaultMessage:"Select rule type"}))),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(g.EuiPageHeaderSection,{style:{width:m?"100%":"50%"}},Object(O.jsx)(g.EuiFieldSearch,{placeholder:a.i18n.translate("alertsUIShared.components.ruleTypeModal.searchPlaceholder",{defaultMessage:"Search"}),value:o,onChange:({target:{value:e}})=>l(e),fullWidth:!0}))))),Object(O.jsx)(g.EuiFlexItem,{style:{overflow:"hidden",marginTop:-j.size.base}},n?h:Object(O.jsx)(y,{ruleTypes:i,ruleTypeCountsByProducer:r,onSelectRuleType:t,onFilterByProducer:s,selectedProducer:u,onClearFilters:f,showCategories:d})))))},E=[],T=({http:e,toasts:t,filteredRuleTypes:s=E,registeredRuleTypes:a,...i})=>{const[n,r]=Object(c.useState)(null),[o,d]=Object(c.useState)(""),{ruleTypesState:{data:j,isLoading:p}}=Object(b.a)({http:e,toasts:t,filteredRuleTypes:s,registeredRuleTypes:a}),g=Object(c.useMemo)((()=>{const e=Object(l.countBy)([...j.values()],"producer");return 1===Object.keys(e).length}),[j]),[m,f]=Object(c.useMemo)((()=>((e,t,s)=>{const a=[...e.values()];if(!a.length)return[[],{total:0}];const i=a.filter((e=>{if(s){const t=s.toLowerCase();return e.name.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)}return!0}));return[i.filter((e=>!t||e.producer===t)),{...Object(l.countBy)(i,"producer"),total:i.length}]})(j,n,o)),[j,o,n]);return Object(O.jsx)(S,u()({},i,{ruleTypes:m,ruleTypeCountsByProducer:f,ruleTypesLoading:p,onChangeSearch:d,onFilterByProducer:r,selectedProducer:n,searchString:o,showCategories:!g}))};var v=s(93),k=s(127),I=s(130),C=s(22),F=s(19),R=s(39),L=s.n(R),A=s(31),M=s(133),w=s(6);const z=e=>{const{children:t,numberOfSelectedRules:s=0,canModifySelectedRules:a}=e,[l]=Object(A.useUiSetting$)(w.g),[i,n]=Object(c.useState)(!1),r=Object(c.useMemo)((()=>L()(s).format(l)),[s,l]);return Object(O.jsx)(g.EuiPopover,{isOpen:i,closePopover:()=>n(!1),"data-test-subj":"bulkAction",panelPaddingSize:"s",button:Object(O.jsx)(g.EuiButtonEmpty,{size:"xs",iconSide:"right",iconType:a?"arrowDown":void 0,disabled:!a,"aria-label":M.v,"data-test-subj":"showBulkActionButton",onClick:()=>n(!i)},Object(M.s)(r,s))},t&&d.a.Children.map(t,(e=>d.a.isValidElement(e)?Object(O.jsx)(d.a.Fragment,null,d.a.cloneElement(e,{})):e)))};var P=s(136),U=(s(308),s(29)),_=s(188);const D=Object(P.a)((({selectedItems:e,isAllSelected:t=!1,getFilter:s,onPerformingAction:l=B,onActionPerformed:n=B,bulkEditAction:r,isEnablingRules:o=!1,isDisablingRules:u=!1,isBulkEditing:b=!1,updateRulesToBulkEdit:j,onEnable:p,onDisable:m})=>{const{notifications:{toasts:f}}=Object(U.b)().services,[x,y]=Object(c.useState)(!1),h=o||u||b,S=Object(c.useMemo)((()=>!t&&!!e.find((e=>!e.enabledInLicense))),[e,t]),E=Object(c.useCallback)((()=>{y(!0)}),[]),T=Object(c.useCallback)((()=>{y(!1)}),[]),v=Object(c.useCallback)((e=>{T(),m(e)}),[T,m]);return Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiFlexGroup,{alignItems:"baseline",direction:"column",gutterSize:"none","data-test-subj":"ruleQuickEditButton"},!t&&Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:async function(){l();try{j(t?{action:"snooze",filter:s()}:{action:"snooze",rules:e})}catch(e){f.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:b&&"snooze"===r,isDisabled:h||S,"data-test-subj":"bulkSnooze"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.snoozeAllTitle",defaultMessage:"Snooze now"}))),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:async function(){l();try{j(t?{action:"unsnooze",filter:s()}:{action:"unsnooze",rules:e})}catch(e){f.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:b&&"unsnooze"===r,isDisabled:h||S,"data-test-subj":"bulkUnsnooze"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.unsnoozeAllTitle",defaultMessage:"Unsnooze now"}))),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:async function(){l();try{j(t?{action:"schedule",filter:s()}:{action:"schedule",rules:e})}catch(e){f.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:b&&"schedule"===r,isDisabled:h||S,"data-test-subj":"bulkSnoozeSchedule"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.snoozeScheduleAllTitle",defaultMessage:"Schedule snooze"}))),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:async function(){l();try{j(t?{action:"unschedule",filter:s()}:{action:"unschedule",rules:e})}catch(e){f.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:b&&"unschedule"===r,isDisabled:h||S,"data-test-subj":"bulkRemoveSnoozeSchedule"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.removeSnoozeScheduleAllTitle",defaultMessage:"Unschedule snooze"})))),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:p,isLoading:o,isDisabled:h||S,"data-test-subj":"bulkEnable"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.enableAllTitle",defaultMessage:"Enable"}))),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:E,isLoading:u,isDisabled:h||S,"data-test-subj":"bulkDisable"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.disableAllTitle",defaultMessage:"Disable"}))),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:async function(){l();try{j(t?{action:"updateApiKey",filter:s()}:{action:"updateApiKey",rules:e})}catch(e){f.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToUpdateRuleAPIKeysMessage",{defaultMessage:"Failed to update API keys for rules"})})}finally{n()}},isLoading:b&&"updateApiKey"===r,isDisabled:h,"data-test-subj":"updateAPIKeys"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.updateRuleAPIKeysTitle",defaultMessage:"Update API keys"}))),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:async function(){l();try{j(t?{action:"delete",filter:s()}:{action:"delete",rules:e})}catch(e){f.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToDeleteRulesMessage",{defaultMessage:"Failed to delete rules"})})}finally{n()}},isLoading:b&&"delete"===r,iconType:"trash",color:"danger",isDisabled:h||S,"data-test-subj":"bulkDelete",className:"actBulkActionPopover__deleteAll"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.deleteAllTitle",defaultMessage:"Delete"})))),x&&Object(O.jsx)(_.a,{onConfirm:v,onCancel:T}))}));function B(){}var N=s(128),$=s(103),q=s(33),G=s.n(q),H=s(17),K=(s(313),s(169)),W=s(98);const Q=Object(P.a)((({item:e,onLoading:t,onRuleChanged:s,bulkDisableRules:l,bulkEnableRules:i,onDeleteRule:n,onEditRule:r,onUpdateAPIKey:o,snoozeRule:u,unsnoozeRule:b,onRunRule:j,onCloneRule:p})=>{var m,f;const{ruleTypeRegistry:x,notifications:{toasts:y}}=Object(U.b)().services,[h,S]=Object(c.useState)(!1),[E,T]=Object(c.useState)(!e.enabled),[v,k]=Object(c.useState)(!1);Object(c.useEffect)((()=>{T(!e.enabled)}),[e.enabled]);const I=Object(c.useCallback)((()=>{S(!1)}),[S]),C=Object(c.useCallback)((async a=>{try{t(!0),await u(e,a),await s(),y.addSuccess(W.SNOOZE_SUCCESS_MESSAGE)}catch(e){y.addDanger(W.SNOOZE_FAILED_MESSAGE)}finally{t(!1),I()}await u(e,a)}),[t,u,e,s,y,I]),F=Object(c.useCallback)((async a=>{try{t(!0),await b(e,a),await s(),y.addSuccess(W.UNSNOOZE_SUCCESS_MESSAGE)}catch(e){y.addDanger(W.SNOOZE_FAILED_MESSAGE)}finally{t(!1),I()}}),[t,b,e,s,y,I]),R=!!x.has(e.ruleTypeId)&&!x.get(e.ruleTypeId).requiresAppContext,L=Object(O.jsx)(g.EuiButtonIcon,{disabled:!e.isEditable,"data-test-subj":"selectActionButton","data-testid":"selectActionButton",iconType:"boxesHorizontal",onClick:()=>S(!h),"aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.popoverButtonTitle",{defaultMessage:"Actions"})}),A=Object(c.useMemo)((()=>Object(H.d)(e)),[e]),M=Object(c.useMemo)((()=>e.muteAll?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.snoozedIndefinitely",{defaultMessage:"Snoozed indefinitely"}):A?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.snoozedUntil",{defaultMessage:"Snoozed until {snoozeTime}",values:{snoozeTime:G()(e.isSnoozedUntil).format("MMM D")}}):a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.snooze",{defaultMessage:"Snooze"})),[A,e]),w=Object(c.useMemo)((()=>E||e.consumer===N.a.SIEM?[]:[{disabled:!e.isEditable||!e.enabledInLicense,"data-test-subj":"snoozeButton",icon:"bellSlash",name:M,panel:1}]),[E,e,M]),z=Object(c.useCallback)((()=>{k(!0)}),[]),P=Object(c.useCallback)((()=>{k(!1)}),[]),D=Object(c.useCallback)((async()=>{$.asyncScheduler.schedule((async()=>{await i({ids:[e.id]}),s()}),10),T(!1),S(!1)}),[i,s,e.id]),B=Object(c.useCallback)((async t=>{P(),await l({ids:[e.id],untrack:t}),s(),T(!0),S(!1)}),[P,l,s,e.id]),q=Object(c.useCallback)((()=>{E?D():z()}),[E,D,z]),Q=[{id:0,hasFocus:!1,items:[...w,{isSeparator:!0},{disabled:!e.isEditable||!e.enabledInLicense,"data-test-subj":"disableButton",onClick:q,name:E?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.enableTitle",{defaultMessage:"Enable"}):a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.disableTitle",{defaultMessage:"Disable"})},{disabled:!e.isEditable||e.consumer===N.a.SIEM,"data-test-subj":"cloneRule",onClick:async()=>{S(!h),p(e.id)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.cloneRuleTitle",{defaultMessage:"Clone rule"})},{disabled:!e.isEditable||!R,"data-test-subj":"editRule",onClick:()=>{S(!h),r(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.editTitle",{defaultMessage:"Edit rule"})},{disabled:!e.isEditable,"data-test-subj":"updateApiKey",onClick:()=>{S(!h),o(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.updateApiKey",{defaultMessage:"Update API key"})},{disabled:!e.isEditable,"data-test-subj":"runRule",onClick:()=>{S(!h),j(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.runRule",{defaultMessage:"Run rule"})},{disabled:!e.isEditable,className:"collapsedItemActions__deleteButton","data-test-subj":"deleteRule",onClick:()=>{S(!h),n(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.deleteRuleTitle",{defaultMessage:"Delete rule"})}]},{id:1,title:Object(O.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiIcon,{type:"bellSlash"})),Object(O.jsx)(g.EuiFlexItem,{grow:!1},a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.snoozeActions",{defaultMessage:"Snooze notifications"}))),width:500,content:Object(O.jsx)(g.EuiPanel,null,Object(O.jsx)(K.a,{interval:Object(K.b)(e.isSnoozedUntil),hasTitle:!1,scheduledSnoozes:null!==(m=e.snoozeSchedule)&&void 0!==m?m:[],activeSnoozes:null!==(f=e.activeSnoozes)&&void 0!==f?f:[],showCancel:Object(H.d)(e),snoozeRule:C,unsnoozeRule:F}))}];return Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiPopover,{button:L,isOpen:h,closePopover:()=>S(!1),ownFocus:!0,panelPaddingSize:"none","data-test-subj":"collapsedItemActions"},Object(O.jsx)(g.EuiContextMenu,{initialPanelId:0,panels:Q,className:"actCollapsedItemActions","data-test-subj":"collapsedActionPanel","data-testid":"collapsedActionPanel"})),v&&Object(O.jsx)(_.a,{onCancel:P,onConfirm:B}))}));var J=s(34);const V=e=>{const{rulesStatuses:t,rulesLastRunOutcomes:s}=e;return Object(J.a)("ruleUseExecutionStatus")?Object(O.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"success","data-test-subj":"totalActiveRulesCount"},Object(M.m)(t.active))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"danger","data-test-subj":"totalErrorRulesCount"},Object(M.n)(t.error))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"warning","data-test-subj":"totalWarningRulesCount"},Object(M.r)(t.warning))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"primary","data-test-subj":"totalOkRulesCount"},Object(M.o)(t.ok))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"accent","data-test-subj":"totalPendingRulesCount"},Object(M.p)(t.pending))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"subdued","data-test-subj":"totalUnknownRulesCount"},Object(M.q)(t.unknown)))):Object(O.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"success","data-test-subj":"totalSucceededRulesCount"},Object(M.j)(s.succeeded))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"danger","data-test-subj":"totalFailedRulesCount"},Object(M.h)(s.failed))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiHealth,{color:"warning","data-test-subj":"totalWarningRulesCount"},Object(M.l)(s.warning))))},Y={marginLeft:"auto"},Z=e=>G()(e).isValid()?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListAutoRefresh.lastUpdateText",{defaultMessage:"Updated {lastUpdateText}",values:{lastUpdateText:G()(e).locale(a.i18n.getLocale()).fromNow()}}):"",X=3e5,ee=e=>{const{lastUpdate:t,initialUpdateInterval:s=X,onRefresh:a}=e,[l,i]=Object(c.useState)(!1),[n,r]=Object(c.useState)(Math.max(s,1e3)),[o,u]=Object(c.useState)(""),d=Object(c.useRef)((()=>{})),b=Object(c.useRef)(),j=Object(c.useRef)();Object(c.useEffect)((()=>{d.current=a}),[a]),Object(c.useEffect)((()=>{u(Z(t));const e=()=>{b.current=window.setTimeout((()=>{u(Z(t)),e()}),6e4)};return e(),()=>{b.current&&clearTimeout(b.current)}}),[t,u]),Object(c.useEffect)((()=>{if(l)return;const e=()=>{j.current=window.setTimeout((()=>{d.current(),e()}),n)};return e(),()=>{j.current&&clearTimeout(j.current)}}),[l,n]);const p=Object(c.useCallback)((({isPaused:e,refreshInterval:t})=>{i(e),r(t)}),[i,r]);return Object(O.jsx)(g.EuiFlexGroup,{"data-test-subj":"rulesListAutoRefresh",alignItems:"center"},Object(O.jsx)(g.EuiFlexItem,{grow:!1,style:Y},Object(O.jsx)(g.EuiText,{"data-test-subj":"rulesListAutoRefresh-lastUpdateText",size:"s",color:"subdued"},o)),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiAutoRefreshButton,{isPaused:l,shortHand:!0,refreshInterval:n,onRefreshChange:p})))};var te=s(40);const se=[...r.RuleExecutionStatusValues].sort(),ae=({selectedStatuses:e,onChange:t})=>{const{euiTheme:s}=Object(g.useEuiTheme)(),[a,l]=Object(c.useState)(e),[n,r]=Object(c.useState)(!1),o=Object(c.useCallback)((()=>{r((e=>!e))}),[r]),u=Object(c.useCallback)((()=>{r(!1)}),[r]);return Object(c.useEffect)((()=>{t&&t(a)}),[a]),Object(c.useEffect)((()=>{l(e)}),[e]),Object(O.jsx)(g.EuiPopover,{isOpen:n,closePopover:u,button:Object(O.jsx)(g.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:a.length>0,numActiveFilters:a.length,numFilters:a.length,onClick:o,"data-test-subj":"ruleExecutionStatusFilterButton"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleExecutionStatusFilterLabel",defaultMessage:"Last response"}))},Object(O.jsx)("div",{className:"eui-yScroll",css:Object(O.css)({maxHeight:30*s.base},"","")},se.map((e=>{const t=Object(te.a)(e);return Object(O.jsx)(g.EuiFilterSelectItem,{key:e,style:{textTransform:"capitalize"},onClick:()=>{const t=a.includes(e);l(t?a.filter((t=>t!==e)):a.concat(e))},checked:a.includes(e)?"on":void 0,"data-test-subj":`ruleExecutionStatus${e}FilterOption`},Object(O.jsx)(g.EuiHealth,{color:t},M.L[e]))}))))},le=[...r.RuleLastRunOutcomeValues].sort(),ie=({selectedOutcomes:e,onChange:t})=>{const{euiTheme:s}=Object(g.useEuiTheme)(),[a,l]=Object(c.useState)(!1),n=Object(c.useCallback)((()=>{l((e=>!e))}),[l]),r=Object(c.useCallback)((()=>{l(!1)}),[l]),o=Object(c.useCallback)((s=>()=>{e.includes(s)?null==t||t(e.filter((e=>e!==s))):null==t||t(e.concat(s))}),[t,e]);return Object(O.jsx)(g.EuiPopover,{isOpen:a,closePopover:r,button:Object(O.jsx)(g.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:e.length>0,numActiveFilters:e.length,numFilters:e.length,onClick:n,"data-test-subj":"ruleLastRunOutcomeFilterButton"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeFilterLabel",defaultMessage:"Last response"}))},Object(O.jsx)("div",{className:"eui-yScroll",css:Object(O.css)({maxHeight:30*s.base},"","")},le.map((t=>{const s=Object(te.b)(t);return Object(O.jsx)(g.EuiFilterSelectItem,{key:t,style:{textTransform:"capitalize"},onClick:o(t),checked:e.includes(t)?"on":void 0,"data-test-subj":`ruleLastRunOutcome${t}FilterOption`},Object(O.jsx)(g.EuiHealth,{color:s},M.K[t]))}))))},ne=e=>{const{rulesLastRunOutcomes:t,setRuleExecutionStatusesFilter:s,setRuleLastRunOutcomesFilter:a}=e;return 0===t.failed?null:Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiCallOut,{color:"danger",size:"s","data-test-subj":"rulesErrorBanner"},Object(O.jsx)("p",null,Object(O.jsx)(g.EuiIcon,{color:"danger",type:"warning"})," ",Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.attentionBannerTitle",defaultMessage:"Error found in {totalStatusesError, plural, one {# rule} other {# rules}}.",values:{totalStatusesError:t.failed}})," ",Object(O.jsx)(g.EuiLink,{color:"primary",onClick:()=>{Object(J.a)("ruleUseExecutionStatus")?s(["error"]):a(["failed"])}},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.viewBannerButtonLabel",defaultMessage:"Show {totalStatusesError, plural, one {rule} other {rules}} with error",values:{totalStatusesError:t.failed}})))),Object(O.jsx)(g.EuiSpacer,{size:"s"}))},re=({options:e,onChange:t,filters:s})=>{const{euiTheme:a}=Object(g.useEuiTheme)(),[l,n]=Object(c.useState)(!1);return Object(O.jsx)(g.EuiPopover,{isOpen:l,closePopover:()=>n(!1),button:Object(O.jsx)(g.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:s.length>0,numActiveFilters:s.length,numFilters:s.length,onClick:()=>n(!l),"data-test-subj":"ruleTypeFilterButton"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.typeFilterLabel",defaultMessage:"Type"}))},Object(O.jsx)("div",{className:"eui-yScroll",css:Object(O.css)({maxHeight:30*a.base},"","")},e.map(((e,a)=>Object(O.jsx)(c.Fragment,{key:`group${a}`},Object(O.jsx)(g.EuiTitle,{"data-test-subj":`ruleType${a}Group`,size:"xxs"},Object(O.jsx)("h3",null,e.groupName)),e.subOptions.map(((e,a)=>Object(O.jsx)(g.EuiFilterSelectItem,{key:a,onClick:()=>{const a=s.includes(e.value);t(a?s.filter((t=>t!==e.value)):s.concat(e.value))},checked:s.includes(e.value)?"on":void 0,"data-test-subj":`ruleType${e.value}FilterOption`},e.name))))))))},oe=({actionTypes:e,onChange:t,filters:s})=>{const{euiTheme:a}=Object(g.useEuiTheme)(),[l,n]=Object(c.useState)(!1),r=Object(c.useCallback)((e=>()=>{const a=s.includes(e.id);t(a?s.filter((t=>t!==e.id)):s.concat(e.id))}),[s,t]);return Object(O.jsx)(g.EuiPopover,{isOpen:l,closePopover:()=>n(!1),button:Object(O.jsx)(g.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:s.length>0,numActiveFilters:s.length,numFilters:s.length,onClick:()=>n(!l),"data-test-subj":"actionTypeFilterButton"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.actionTypeFilterLabel",defaultMessage:"Action type"}))},Object(O.jsx)("div",{className:"eui-yScroll",css:Object(O.css)({maxHeight:30*a.base},"","")},e.map((e=>Object(O.jsx)(g.EuiFilterSelectItem,{key:e.id,onClick:r(e),checked:s.includes(e.id)?"on":void 0,"data-test-subj":`actionType${e.id}FilterOption`},e.name)))))};var ue=s(111),ce=s(109),de=s(95),be=s(318),je=s.n(be),pe=s(168);const ge=["is","range","nested"],me=({astFilter:e,suggestionsAbstraction:t,hasNestedKey:s=!1,nestedKeys:a,storeValue:i,path:n="arguments",action:o=(()=>{})})=>{let u,c=i;void 0===c&&(c="function"===e.type&&ge.includes(e.function)),"function"===e.type&&"nested"===e.function&&(s=!0),e.arguments.forEach(((e,i)=>{if(0===i)if(s&&"literal"===e.type&&null!=e.value)u=e.value;else if("literal"===e.type&&e.value&&"string"==typeof e.value){const s="properties."+(t.fields[e.value]?t.fields[e.value].field:e.value).split(".").join(".properties."),a=Object(l.get)(r.alertMappings,s);null!=a&&"nested"===a.type&&(u=e.value)}if(e.arguments){const s=`${n}.${i}`;me({astFilter:e,suggestionsAbstraction:t,storeValue:"function"===e.type&&ge.includes(e.function),path:`${s}.arguments`,hasNestedKey:"function"===e.type&&"nested"===e.function,nestedKeys:u||a,action:o})}if(c){const t=null!=a?`${a}.${e.value}`:e.value;o({ast:e,index:i,fieldName:t})}}))},Oe={type:"rules",fields:{"alert.tags":{field:"alert.tags",fieldToQuery:"alert.attributes.tags",displayField:"tags"},"alert.name.keyword":{field:"alert.name.keyword",fieldToQuery:"alert.attributes.name.keyword",displayField:"name"},"alert.actions.actionTypeId":{field:"alert.actions.actionTypeId",nestedPath:"alert.actions",nestedField:"actionTypeId",nestedDisplayField:"id",fieldToQuery:"alert.attributes.actions",displayField:"actions"},"alert.alertTypeId":{field:"alert.alertTypeId",fieldToQuery:"alert.attributes.alertTypeId",displayField:"type"},"alert.lastRun.outcome":{field:"alert.lastRun.outcome",fieldToQuery:"alert.attributes.lastRun.outcome",displayField:"lastResponse"},"alert.enabled":{field:"alert.enabled",fieldToQuery:"alert.attributes.enabled",displayField:"enabled"},"alert.muteAll":{field:"alert.muteAll",fieldToQuery:"alert.attributes.muteAll",displayField:"muted"},"alert.params.threat.tactic.name":{field:"alert.params.threat.tactic.name",fieldToQuery:"alert.attributes.params.threat.tactic.name",displayField:"threat.tactic.name"},"alert.params.threat.technique.name":{field:"alert.params.threat.technique.name",fieldToQuery:"alert.attributes.params.threat.technique.name",displayField:"threat.technique.name"}}},fe=d.a.memo((({onQuerySubmit:e})=>{const{http:t,notifications:{toasts:s},unifiedSearch:{ui:{SearchBar:a}}}=Object(U.b)().services,{value:i,loading:n,error:r}=je()((async()=>t.post("/internal/rules/saved_objects/fields",{body:JSON.stringify({fields:Object.keys(Oe.fields).filter((e=>e.includes("alert.")))})})),[]),o=[{title:"",fieldFormatMap:{},fields:null==i?void 0:i.map((e=>({...e,...Oe.fields[e.name]?{customLabel:Oe.fields[e.name].displayField}:{},...e.esTypes.includes("flattened")?{type:"string"}:{}})))}],u=Object(c.useMemo)((()=>{return{type:(e=Oe).type,fields:Object.entries(e.fields).reduce(((e,[t,s])=>{const{displayField:a,nestedDisplayField:l,...i}=s;return l&&a?(Object.assign(e,{[`${a}.${l}`]:{...i,fieldToQuery:i.nestedField}}),Object.assign(e,{[`${a}`]:i})):a&&Object.assign(e,{[a]:i}),e}),e.fields)};var e}),[]);return Object(O.jsx)(a,{appName:"StackRules",disableQueryLanguageSwitcher:!0,query:{query:"",language:"kuery"},indexPatterns:n||r?pe.c:o,showAutoRefreshOnly:!1,showDatePicker:!1,saveQueryMenuVisibility:"hidden",showQueryInput:!0,showQueryMenu:!1,showFilterBar:!0,showSubmitButton:!1,suggestionsAbstraction:u,onQuerySubmit:({query:t})=>{let a={};if(!Object(l.isEmpty)(null==t?void 0:t.query)){var i;a=Object(de.fromKueryExpression)(null!==(i=null==t?void 0:t.query)&&void 0!==i?i:"");try{(({astFilter:e,suggestionsAbstraction:t})=>{const s=Object.values(t.fields).reduce(((e,t)=>(t.displayField&&!e.includes(t.displayField)&&e.push(t.displayField),t.displayField&&t.nestedDisplayField&&!e.includes(`${t.displayField}.${t.nestedDisplayField}`)&&e.push(`${t.displayField}.${t.nestedDisplayField}`),e)),[]);me({astFilter:e,suggestionsAbstraction:t,action:({ast:e,index:a,fieldName:l})=>{if(0===a&&!s.includes(l))throw new Error(`Filter is not supported on this field "${l}"`);t.fields[l]&&(e.value=t.fields[l].fieldToQuery)}})})({astFilter:a,suggestionsAbstraction:u})}catch(e){return void s.addDanger(e.toString())}}e(a)}})})),xe=d.a.memo((e=>{const{actionTypes:t,filterOptions:s,filters:l,inputText:n,lastUpdate:r,onClearSelection:o,onRefreshRules:u,onToggleRuleErrors:c,rulesLastRunOutcomesTotal:b,rulesStatusesTotal:j,setInputText:p,showActionFilter:m=!0,showErrors:f,canLoadRules:x,refresh:y,updateFilters:h}=e,S=Object(J.a)("ruleTagFilter"),E=Object(J.a)("ruleStatusFilter"),T=Object(J.a)("ruleUseExecutionStatus"),v=[Object(O.jsx)(re,{key:"type-filter",options:s,filters:l.types||[],onChange:e=>h({filter:"types",value:e})}),m&&Object(O.jsx)(oe,{key:"action-type-filter",actionTypes:t,filters:l.actionTypes||[],onChange:e=>h({filter:"actionTypes",value:e})}),...T?[Object(O.jsx)(ae,{key:"rule-status-filter",selectedStatuses:l.ruleExecutionStatuses||[],onChange:e=>h({filter:"ruleExecutionStatuses",value:e})})]:[Object(O.jsx)(ie,{key:"rule-last-run-outcome-filter",selectedOutcomes:l.ruleLastRunOutcomes||[],onChange:e=>h({filter:"ruleLastRunOutcomes",value:e})})],...S?[Object(O.jsx)(ue.RuleTagFilter,{isGrouped:!0,refresh:y,canLoadRules:x,selectedTags:l.tags||[],onChange:e=>h({filter:"tags",value:e})})]:[]],k=Object(J.a)("ruleKqlBar");return Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(ne,{rulesLastRunOutcomes:b,setRuleExecutionStatusesFilter:e=>h({filter:"ruleExecutionStatuses",value:e}),setRuleLastRunOutcomesFilter:e=>h({filter:"ruleLastRunOutcomes",value:e})}),k&&Object(O.jsx)(fe,{onQuerySubmit:e=>h({filter:"kueryNode",value:e})}),Object(O.jsx)(g.EuiFlexGroup,{gutterSize:"s"},Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiFieldSearch,{"data-test-subj":"ruleSearchField",fullWidth:!0,isClearable:!0,placeholder:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.searchPlaceholderTitle",{defaultMessage:"Search"}),value:n,onChange:e=>{p(e.target.value),""===e.target.value&&h({filter:"searchText",value:e.target.value})},onKeyUp:e=>{13===e.keyCode&&h({filter:"searchText",value:n})}})),Object(O.jsx)(g.EuiFlexItem,{grow:!1},E?Object(O.jsx)(ce.RuleStatusFilter,{selectedStatuses:l.ruleStatuses||[],onChange:e=>h({filter:"ruleStatuses",value:e})}):null),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiFilterGroup,null,v.map(((e,t)=>Object(O.jsx)(d.a.Fragment,{key:t},e))))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiButton,{"data-test-subj":"refreshRulesButton",iconType:"refresh",onClick:()=>{o(),u()},name:"refresh",color:"primary"},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.refreshRulesButtonLabel",defaultMessage:"Refresh"})))),Object(O.jsx)(g.EuiSpacer,{size:"m"}),Object(O.jsx)(g.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(O.jsx)(V,{rulesStatuses:j,rulesLastRunOutcomes:b}),Object(O.jsx)(ee,{lastUpdate:r,onRefresh:u}))),j.error>0&&Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiLink,{"data-test-subj":"expandRulesError",color:"primary",onClick:c},!f&&Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.showAllErrors",defaultMessage:"Show {totalStatusesError, plural, one {error} other {errors}}",values:{totalStatusesError:j.error}}),f&&Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.hideAllErrors",defaultMessage:"Hide {totalStatusesError, plural, one {error} other {errors}}",values:{totalStatusesError:j.error}})))))}));var ye=s(139),he=s(140),Se=s(256),Ee=s(175),Te=s(174),ve=s(62),ke=s(173),Ie=s(131),Ce=s(257);const Fe=({onCreateRulesClick:e,showCreateRule:t=!0})=>Object(O.jsx)(g.EuiPageTemplate.EmptyPrompt,{iconType:"watchesApp","data-test-subj":"createFirstRuleEmptyPrompt",title:Object(O.jsx)("h2",null,Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.components.emptyPrompt.emptyTitle",defaultMessage:"Create your first rule"})),body:Object(O.jsx)("p",null,Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.components.emptyPrompt.emptyDesc",defaultMessage:"Receive an alert through email, Slack, or another connector when a condition is met."})),actions:t?[Object(O.jsx)(g.EuiButton,{iconType:"plusInCircle","data-test-subj":"createFirstRuleButton",key:"create-action",fill:!0,onClick:e},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.components.emptyPrompt.emptyButton",defaultMessage:"Create rule"}))]:null});var Re=s(56),Le=s(196);const Ae=e=>{const{showNoAuthPrompt:t,showSpinner:s,showCreateRuleButtonInPrompt:a,showCreateFirstRulePrompt:l,onCreateRulesClick:i}=e;return t?Object(O.jsx)(Le.a,null):l?Object(O.jsx)(Fe,{showCreateRule:a,onCreateRulesClick:i}):s?Object(O.jsx)(g.EuiPageTemplate.Section,{grow:!1,paddingSize:"none"},Object(O.jsx)(Re.a,null)):null};s(321);const Me=e=>{const{openFlyout:t}=e;return Object(O.jsx)(g.EuiButton,{iconType:"plusInCircle",key:"create-rule","data-test-subj":"createRuleButton",fill:!0,onClick:t},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.addRuleButtonLabel",defaultMessage:"Create rule"}))},we=({licenseType:e,ruleTypeId:t,onConfirm:s,onCancel:n})=>{const r=Object(l.capitalize)(e);return Object(O.jsx)(g.EuiConfirmModal,{title:a.i18n.translate("xpack.triggersActionsUI.sections.manageLicense.manageLicenseTitle",{defaultMessage:"{licenseRequired} license required",values:{licenseRequired:r}}),onCancel:n,onConfirm:s,confirmButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.manageLicense.manageLicenseConfirmButtonText",{defaultMessage:"Manage license"}),cancelButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.manageLicense.manageLicenseCancelButtonText",{defaultMessage:"Cancel"}),defaultFocusedButton:"confirm","data-test-subj":"manageLicenseModal"},Object(O.jsx)("p",null,Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.manageLicense.manageLicenseMessage",defaultMessage:"Rule type {ruleTypeId} is disabled because it requires a {licenseRequired} license. Continue to License Management to view upgrade options.",values:{ruleTypeId:t,licenseRequired:r}})))},ze=({onClickClearFilter:e})=>Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiCallOut,{color:"primary",size:"s","data-test-subj":"rulesListClearRuleFilterBanner"},Object(O.jsx)("p",null,Object(O.jsx)(g.EuiIcon,{color:"primary",type:"iInCircle"})," ",Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleParamBannerTitle",defaultMessage:"Rule list filtered by url parameters."})," ",Object(O.jsx)(g.EuiLink,{color:"primary",onClick:e},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleParamBannerButton",defaultMessage:"Show all"})))),Object(O.jsx)(g.EuiSpacer,{size:"s"}));var Pe=s(183);const Ue=a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.ruleExecutionPercentileSelectButton",{defaultMessage:"select percentile"}),_e={width:200},De=Object(c.memo)((e=>{const{options:t,onOptionsChange:s}=e,[a,l]=Object(c.useState)(!1),i=Object(c.useCallback)((e=>{e.stopPropagation(),l((e=>!e))}),[]),n=Object(c.useCallback)((()=>{l(!1)}),[]),r=Object(c.useCallback)((e=>{n(),s(e)}),[s,n]),o=Object(c.useCallback)((e=>{e.stopPropagation()}),[]);return Object(O.jsx)(g.EuiPopover,{button:Object(O.jsx)(g.EuiButtonIcon,{iconType:"gear",size:"s","data-test-subj":"percentileSelectablePopover-iconButton",title:Ue,"aria-label":Ue,onClick:i}),panelPaddingSize:"s",isOpen:a,closePopover:n,anchorPosition:"downRight"},Object(O.jsx)("div",{style:_e,onClick:o},Object(O.jsx)(g.EuiSelectable,{"data-test-subj":"percentileSelectablePopover-selectable",singleSelection:"always",options:t,onChange:r},(e=>e))))}));var Be=s(240),Ne=s(214),$e=s(220),qe=s(102),Ge=s(108),He=s(32);const Ke=e=>{const{rule:t,onManageLicenseClick:s}=e,{lastRun:a}=t,l=Object(He.b)(t),n=Object(He.d)(t),r=Object(He.e)({rule:t,licenseErrorText:M.a,lastOutcomeTranslations:M.K,executionStatusTranslations:M.L}),o="failed"===(null==a?void 0:a.outcome)?`Error: ${null==a?void 0:a.outcomeMsg}`:null;if(!r)return Object(O.jsx)(g.EuiStat,{titleSize:"xs",title:"--",description:"",isLoading:!(null!=a&&a.outcome||t.nextRun)});const u=Object(O.jsx)(g.EuiHealth,{"data-test-subj":`ruleStatus-${(null==a?void 0:a.outcome)||"pending"}`,color:n||"default"},r),c=o?Object(O.jsx)(g.EuiToolTip,{"data-test-subj":"ruleStatus-error-tooltip",position:"top",content:o},u):u;return Object(O.jsx)(g.EuiFlexGroup,{gutterSize:"none"},Object(O.jsx)(g.EuiFlexItem,null,c),l&&Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiButtonEmpty,{size:"xs","data-test-subj":"ruleStatus-error-license-fix",onClick:()=>s(t)},Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.fixLicenseLink",defaultMessage:"Fix"}))))},We=["ruleName","ruleTags","ruleExecutionStatusLastDate","ruleSnoozeNotify","ruleScheduleInterval","ruleExecutionStatusLastDuration","ruleExecutionPercentile","ruleExecutionSuccessRatio","ruleExecutionStatus","ruleExecutionState"],Qe={[F.i.P50]:"50th",[F.i.P95]:"95th",[F.i.P99]:"99th"},Je={[F.i.P50]:"monitoring.run.calculated_metrics.p50",[F.i.P95]:"monitoring.run.calculated_metrics.p95",[F.i.P99]:"monitoring.run.calculated_metrics.p99"},Ve={},Ye=()=>{},Ze=()=>null;function Xe(e){const{rules:t,ruleTypeIndex:s,canExecuteActions:a,config:l}=e,i=l.minimumScheduleInterval?Object(r.parseDuration)(l.minimumScheduleInterval.value):0;return t.map(((e,t)=>{var l,n,o;return{...e,index:t,actionsCount:e.actions.length,ruleType:null!==(l=null===(n=s.get(e.ruleTypeId))||void 0===n?void 0:n.name)&&void 0!==l?l:e.ruleTypeId,isEditable:Object(Ie.a)(e.consumer,s.get(e.ruleTypeId))&&(a||!a&&!e.actions.length),enabledInLicense:!(null===(o=s.get(e.ruleTypeId))||void 0===o||!o.enabledInLicense),showIntervalWarning:Object(r.parseDuration)(e.schedule.interval)<i}}))}const et=e=>{const{rulesListKey:t,rulesState:s,items:l=[],ruleTypesState:i,ruleTypeRegistry:n,isLoading:o=!1,sort:u,isPageSelected:b=!1,isAllSelected:j=!1,numberOfSelectedRules:p=0,page:m,percentileOptions:f,itemIdToExpandedRowMap:x=Ve,config:y=Ve,onSort:h=Ye,onPage:S=Ye,onRuleClick:E=Ye,onRuleEditClick:T=Ye,onRuleDeleteClick:v=Ye,onManageLicenseClick:k=Ye,onPercentileOptionsChange:I=Ye,onRuleChanged:C,onEnableRule:R,onDisableRule:z,onSnoozeRule:P=Ye,onUnsnoozeRule:_=Ye,onSelectAll:D=Ye,onSelectPage:B=Ye,onSelectRow:N=Ye,isRowSelected:$=(()=>!1),renderCollapsedItemActions:q=Ze,renderSelectAllDropdown:H,renderRuleError:K=Ze,visibleColumns:Q,resetFilters:V,numberOfFilters:Y}=e,[Z,X]=Object(c.useState)(-1),[ee,te]=Object(c.useState)({}),se=Object(J.a)("ruleUseExecutionStatus"),[ae]=Object(A.useUiSetting$)(w.g),{euiTheme:le}=Object(g.useEuiTheme)(),ie=Object(c.useMemo)((()=>{const e=f.find((e=>"on"===e.checked));if(e)return F.i[e.key]}),[f]),ne=Object(c.useCallback)((()=>Object(O.jsx)("span",{"data-test-subj":`rulesTable-${ie}ColumnName`},ie," ",Object(O.jsx)(g.EuiIconTip,{content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.ruleExecutionPercentileTooltip",{defaultMessage:"{percentileOrdinal} percentile of this rule's past {sampleLimit} run durations (mm:ss).",values:{percentileOrdinal:Qe[ie],sampleLimit:r.MONITORING_HISTORY_LIMIT}}),size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}),Object(O.jsx)(De,{options:f,onOptionsChange:I}))),[I,f,ie]),re=Object(c.useCallback)((e=>Object(O.jsx)("span",{"data-test-subj":`${ie}Percentile`},Object(O.jsx)(Be.a,{allowZero:!1,duration:e}))),[ie]),oe=Object(c.useCallback)((e=>!!n.has(e)&&!n.get(e).requiresAppContext),[n]),ue=Object(c.useCallback)((e=>t=>z(e,t)),[z]),ce=Object(c.useCallback)((e=>Object(O.jsx)(Ge.RuleStatusDropdown,{hideSnoozeOption:!0,disableRule:ue(e),enableRule:async()=>await R(e),snoozeRule:async()=>{},unsnoozeRule:async()=>{},rule:e,onRuleChanged:C,isEditable:e.isEditable&&oe(e.ruleTypeId)})),[oe,ue,R,C]),de=Object(c.useMemo)((()=>({id:"ruleSelection",field:"selection",sortable:!1,width:"32px",mobileOptions:{header:!1},name:Object(O.jsx)(g.EuiCheckbox,{id:"rulesListTable_selectAll",checked:b,onChange:B,"data-test-subj":"checkboxSelectAll"}),render:(e,t)=>Object(O.jsx)(g.EuiCheckbox,{id:`ruleListTable_select_${t.id}}`,onChange:()=>N(t),disabled:!t.isEditable,checked:$(t),"data-test-subj":`checkboxSelectRow-${t.id}`})})),[b,B,N,$]),be=Object(c.useMemo)((()=>se?"executionStatus.status":"lastRun.outcome"),[se]),je=Object(c.useCallback)((()=>[{id:"ruleName",field:"name",name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.nameTitle",{defaultMessage:"Name"}),sortable:!0,truncateText:!1,width:"22%","data-test-subj":"rulesTableCell-name",render:(e,t)=>{const s=i.data.get(t.ruleTypeId),a=Object(Ne.a)(s),l=Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiFlexGroup,{gutterSize:"xs"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiLink,{title:e,onClick:()=>E(t)},e)),Object(O.jsx)(g.EuiFlexItem,{grow:!1},!a.isEnabled&&Object(O.jsx)(g.EuiIconTip,{anchorClassName:"ruleDisabledQuestionIcon","data-test-subj":"ruleDisabledByLicenseTooltip",type:"questionInCircle",content:a.message,position:"right"})))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiText,{color:"subdued",size:"xs"},t.ruleType))));return Object(O.jsx)(d.a.Fragment,null,l)}},{id:"ruleTags",field:"tags",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.tagsTitle",{defaultMessage:"Tags"}),name:"",sortable:!1,width:"50px","data-test-subj":"rulesTableCell-tagsPopover",render:(e,t)=>e.length>0?Object(O.jsx)(qe.RuleTagBadge,{isOpen:Z===t.index,tags:e,onClick:()=>X(t.index),onClose:()=>X(-1)}):null},{id:"ruleExecutionStatusLastDate",field:"executionStatus.lastExecutionDate",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.lastRunTitle",{defaultMessage:"Last run"}),name:Object(O.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.lastRunTitle",{defaultMessage:"Last run"})," ",Object(O.jsx)(g.EuiIconTip,{"data-test-subj":"rulesTableCell-lastExecutionDateTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.lastRunTitleTooltip",{defaultMessage:"Start time of the last run."}),size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"})),sortable:!0,width:"20%","data-test-subj":"rulesTableCell-lastExecutionDate",render:e=>{if(e)return Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},G()(e).format("MMM D, YYYY HH:mm:ssa")),Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiText,{color:"subdued",size:"xs"},G()(e).fromNow()))))}},{id:"ruleSnoozeNotify",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.notifyTitle",{defaultMessage:"Notify"}),name:Object(O.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.notifyTitle",{defaultMessage:"Notify"})," ",Object(O.jsx)(g.EuiIconTip,{"data-test-subj":"rulesTableCell-notifyTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.notifyTooltip",{defaultMessage:"Snooze notifications for a rule."}),size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"})),width:"14%","data-test-subj":"rulesTableCell-rulesListNotify",render:e=>e.enabled?Object(O.jsx)(W.RulesListNotifyBadge,{showOnHover:!0,snoozeSettings:e,loading:!!ee[e.id],disabled:!e.isEditable,onRuleChanged:C,snoozeRule:async t=>{await P(e,t)},unsnoozeRule:async t=>await _(e,t)}):null},{id:"ruleScheduleInterval",field:"schedule.interval",width:"6%",name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.scheduleTitle",{defaultMessage:"Interval"}),sortable:!1,truncateText:!1,"data-test-subj":"rulesTableCell-interval",render:(e,t)=>{const s=Object(r.formatDuration)(e);return Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(g.EuiFlexGroup,{direction:"row",gutterSize:"xs"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},s),Object(O.jsx)(g.EuiFlexItem,{grow:!1},t.showIntervalWarning&&Object(O.jsx)(g.EuiToolTip,{"data-test-subj":`ruleInterval-config-tooltip-${t.index}`,title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.intervalTooltipTitle",{defaultMessage:"Below configured minimum interval"}),content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.intervalTooltipText",{defaultMessage:"Rule interval of {interval} is below the minimum configured interval of {minimumInterval}. This may impact alerting performance.",values:{minimumInterval:Object(r.formatDuration)(y.minimumScheduleInterval.value,!0),interval:Object(r.formatDuration)(e,!0)}}),position:"top"},Object(O.jsx)(g.EuiButtonIcon,{color:"text","data-test-subj":`ruleInterval-config-icon-${t.index}`,onClick:()=>T(t),iconType:"flag","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.intervalIconAriaLabel",{defaultMessage:"Below configured minimum interval"})})))))}},{id:"ruleExecutionStatusLastDuration",field:"executionStatus.lastDuration",width:"12%",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.durationTitle",{defaultMessage:"Duration"}),name:Object(O.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.durationTitle",{defaultMessage:"Duration"})," ",Object(O.jsx)(g.EuiIconTip,{"data-test-subj":"rulesTableCell-durationTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.durationTitleTooltip",{defaultMessage:"The length of time it took for the rule to run (mm:ss)."}),size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"})),sortable:!0,truncateText:!1,"data-test-subj":"rulesTableCell-duration",render:(e,t)=>{const s=Object(Pe.b)(i.data.get(t.ruleTypeId),e);return Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(Be.a,{duration:e}),s&&Object(O.jsx)(g.EuiIconTip,{"data-test-subj":"ruleDurationWarning",anchorClassName:"ruleDurationWarningIcon",type:"warning",color:"warning",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleTypeExcessDurationMessage",{defaultMessage:"Duration exceeds the rule's expected run time."}),position:"right"}))}},{id:"ruleExecutionPercentile",mobileOptions:{header:!1},selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.percentileTitle",{defaultMessage:"Percentile"}),field:Je[ie],width:"16%",name:ne(),"data-test-subj":"rulesTableCell-ruleExecutionPercentile",sortable:!0,truncateText:!1,render:re},{id:"ruleExecutionSuccessRatio",field:"monitoring.run.calculated_metrics.success_ratio",width:"12%",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.successRatioTitle",{defaultMessage:"Success ratio"}),name:Object(O.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.successRatioTitle",{defaultMessage:"Success ratio"})," ",Object(O.jsx)(g.EuiIconTip,{"data-test-subj":"rulesTableCell-successRatioTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.successRatioTitleTooltip",{defaultMessage:"How often this rule runs successfully."}),size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"})),sortable:!0,truncateText:!1,"data-test-subj":"rulesTableCell-successRatio",render:e=>Object(O.jsx)("span",{"data-test-subj":"successRatio"},void 0!==e?Object($e.c)(e):"N/A")},{id:"ruleExecutionStatus",field:be,name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.lastResponseTitle",{defaultMessage:"Last response"}),sortable:!0,truncateText:!1,width:"120px","data-test-subj":"rulesTableCell-lastResponse",render:(e,t)=>Object(O.jsx)(Ke,{rule:t,onManageLicenseClick:k})},{id:"ruleExecutionState",field:"enabled",name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.stateTitle",{defaultMessage:"State"}),sortable:!0,truncateText:!1,width:"10%","data-test-subj":"rulesTableCell-status",render:(e,t)=>ce(t)},{name:"",width:"90px",render:e=>Object(O.jsx)(g.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},Object(O.jsx)(g.EuiFlexItem,{grow:!1,className:"ruleSidebarItem"},Object(O.jsx)(g.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"xs"},e.isEditable&&oe(e.ruleTypeId)?Object(O.jsx)(g.EuiFlexItem,{grow:!1,"data-test-subj":"ruleSidebarEditAction"},Object(O.jsx)(g.EuiButtonIcon,{color:"primary",title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.editButtonTooltip",{defaultMessage:"Edit"}),className:"ruleSidebarItem__action","data-test-subj":"editActionHoverButton",onClick:()=>T(e),iconType:"pencil","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.editAriaLabel",{defaultMessage:"Edit"})})):null,e.isEditable?Object(O.jsx)(g.EuiFlexItem,{grow:!1,"data-test-subj":"ruleSidebarDeleteAction"},Object(O.jsx)(g.EuiButtonIcon,{color:"danger",title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.deleteButtonTooltip",{defaultMessage:"Delete"}),className:"ruleSidebarItem__action","data-test-subj":"deleteActionHoverButton",onClick:()=>v(e),iconType:"trash","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.deleteAriaLabel",{defaultMessage:"Delete"})})):null)),Object(O.jsx)(g.EuiFlexItem,{grow:!1},q(e,(t=>((e,t)=>{te((s=>({...s,[e]:t})))})(e.id,t)))))},{align:g.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:Object(O.jsx)(g.EuiScreenReaderOnly,null,Object(O.jsx)("span",null,"Expand rows")),render:K}]),[y.minimumScheduleInterval,ee,oe,C,E,v,T,P,_,k,q,re,ne,K,ce,i.data,ie,Z,be]),pe=Object(c.useMemo)((()=>je()),[je]),[ge,me]=(({allRuleColumns:e,rulesListKey:t="triggersActionsUi_rulesListColumns",visibleColumns:s=We})=>{const{storage:a}=Object(U.b)().services,l=null==a?void 0:a.get(t),[i,n]=Object(c.useState)(null!=l?l:s),r=Object(c.useMemo)((()=>e.filter((e=>null!=e.id))),[e]),o=Object(c.useMemo)((()=>e.filter((e=>void 0===e.id))),[e]),u=Object(c.useMemo)((()=>{const e=i.map((e=>{var t;const{id:s="",selectorName:a="",...l}=null!==(t=r.find((t=>t.id===e)))&&void 0!==t?t:{};return l}));return e.push(...o),e}),[r,i,o]),d=Object(c.useMemo)((()=>r.map((e=>({id:e.id})))),[r]),b=Object(c.useCallback)((e=>{t&&(null==a||a.set(t,e))}),[t,a]),j=Object(c.useMemo)((()=>({visibleColumns:i,setVisibleColumns:e=>{b(e),n(e)}})),[i,b]),p=Object(c.useMemo)((()=>e.filter((e=>null!=e.id)).reduce(((e,{id:t,name:s,selectorName:a})=>t?{...e,[t]:null!=a?a:s}:e),{})),[e]),[m]=Object(g.useDataGridColumnSelector)(d,j,!0,p);return Object(c.useMemo)((()=>[u,m]),[m,u])})({allRuleColumns:pe,rulesListKey:t,visibleColumns:Q}),Oe=Object(c.useMemo)((()=>L()(s.totalItemCount).format(ae)),[s.totalItemCount,ae]),fe=Object(c.useMemo)((()=>j?M.e:Object(M.u)(Oe,s.totalItemCount)),[j,Oe,s.totalItemCount]),xe=Object(c.useCallback)((e=>{var t;const s=$(e)?"euiTableRow-isSelected":"";return{"data-test-subj":"rule-row",className:null!==(t=i.data.get(e.ruleTypeId))&&void 0!==t&&t.enabledInLicense?s:`actRulesList__tableRowDisabled ${s}`}}),[i,$]),ye=Object(c.useMemo)((()=>{let e=!0;return i.data.forEach((t=>{e&&(Object.values(t.authorizedConsumers).every((e=>e.all))||(e=!1))})),e}),[i]);return Object(O.jsx)(g.EuiFlexGroup,{gutterSize:"none",direction:"column"},Object(O.jsx)(g.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none",alignItems:"center"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},Object(O.jsx)(g.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"s",alignItems:"center"},Object(O.jsx)(g.EuiFlexItem,{grow:!1},p>0?null==H?void 0:H():Object(O.jsx)(g.EuiText,{size:"xs",style:{fontWeight:le.font.weight.semiBold},"data-test-subj":"totalRulesCount"},Object(M.x)(Oe,s.totalItemCount))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},p>0&&ye&&Object(O.jsx)(g.EuiButtonEmpty,{size:"xs","aria-label":M.t,"data-test-subj":"selectAllRulesButton",iconType:j?"cross":"pagesSelect",onClick:D},fe)),Y>0&&Object(O.jsx)(g.EuiFlexItem,{css:Object(O.css)({borderLeft:le.border.thin,paddingLeft:le.size.m},"","")},Object(O.jsx)(g.EuiButtonEmpty,{onClick:V,size:"xs",iconSide:"left",flush:"left","data-test-subj":"rules-list-clear-filter"},Object(M.d)(Y))))),Object(O.jsx)(g.EuiFlexItem,{grow:!1},me)),Object(O.jsx)(g.EuiFlexItem,null,Object(O.jsx)(g.EuiBasicTable,{loading:o,items:l,itemId:"id",columns:[de,...ge],sorting:{sort:u},rowHeader:"name",rowProps:xe,cellProps:e=>{var t;return{"data-test-subj":"cell",className:null!==(t=i.data.get(e.ruleTypeId))&&void 0!==t&&t.enabledInLicense?"":"actRulesList__tableCellDisabled"}},"data-test-subj":"rulesList",pagination:{pageIndex:m.index,pageSize:m.size,totalItemCount:i.initialLoad?0:s.totalItemCount},onChange:({page:e,sort:t})=>{e&&S(e),t&&h(t)},itemIdToExpandedRowMap:x})))};var tt=s(242),st=s(258),at=s(243);const lt=a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkSnoozeFailMessage",{defaultMessage:"Failed to bulk snooze rules"}),it=Object(P.a)((e=>{const{bulkEditAction:t,rules:s,filter:l,numberOfSelectedRules:n=0,onClose:r,onSave:o,setIsBulkEditing:u,onSearchPopulate:d,bulkSnoozeRules:b,bulkUnsnoozeRules:j}=e,{notifications:{toasts:p}}=Object(U.b)().services,{showToast:m}=Object(at.a)({onSearchPopulate:d}),f=Object(c.useMemo)((()=>{if(l)return;const e=s.find((e=>e.isSnoozedUntil));return e?Object(K.b)(e.isSnoozedUntil):void 0}),[s,l]),x=async()=>{r(),u(!0);try{const e=await j({ids:s.map((e=>e.id)),filter:l});m(e,"snooze")}catch(e){p.addError(e,{title:lt})}u(!1),o()},y=Object(c.useMemo)((()=>{return!l&&1===n&&s[0]?(e=s[0].name,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeConfirmationSingle",{defaultMessage:"Unsnooze {ruleName}?",values:{ruleName:e}})):(t=n,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeConfirmationPlural",{defaultMessage:"Unsnooze {total, plural, one {# rule} other {# rules}}? ",values:{total:t}}));var e,t}),[s,l,n]);return"unsnooze"===t&&(s.length||l)?Object(O.jsx)(g.EuiConfirmModal,{title:y,onCancel:r,onConfirm:x,confirmButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeConfirmButton",{defaultMessage:"Unsnooze"}),cancelButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeCancelButton",{defaultMessage:"Cancel"}),buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"bulkUnsnoozeConfirmationModal"}):"snooze"===t&&(s.length||l)?Object(O.jsx)(g.EuiModal,{onClose:r},Object(O.jsx)(g.EuiModalHeader,null,Object(O.jsx)(g.EuiModalHeaderTitle,null,Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkSnoozeModal.modalTitle",defaultMessage:"Add snooze now"})),Object(O.jsx)(g.EuiSpacer,{size:"s"})),Object(O.jsx)(g.EuiModalBody,null,Object(O.jsx)(K.a,{hasTitle:!1,showCancel:!1,showAddSchedule:!1,interval:f,snoozeRule:async e=>{r(),u(!0);try{const t=await b({ids:s.map((e=>e.id)),filter:l,snoozeSchedule:e});m(t,"snooze")}catch(e){p.addError(e,{title:lt})}u(!1),o()},unsnoozeRule:x,scheduledSnoozes:[],activeSnoozes:[]})),Object(O.jsx)(g.EuiModalFooter,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:r},"Close"))):null}));var nt=s(261);const rt=a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkSnoozeScheduleFailMessage",{defaultMessage:"Failed to bulk snooze rules"}),ot=Object(P.a)((e=>{const{rules:t,filter:s,bulkEditAction:l,numberOfSelectedRules:n=0,onClose:r,onSave:o,bulkSnoozeRules:u,bulkUnsnoozeRules:d,setIsBulkEditing:b,onSearchPopulate:j}=e,{notifications:{toasts:p}}=Object(U.b)().services,{showToast:m}=Object(at.a)({onSearchPopulate:j}),f=async()=>{r(),b(!0);try{const e=await d({ids:t.map((e=>e.id)),filter:s,scheduleIds:[]});m(e,"snoozeSchedule")}catch(e){p.addError(e,{title:rt})}b(!1),o()},x=Object(c.useMemo)((()=>{return!s&&1===n&&t[0]?(e=t[0].name,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteConfirmationSingle",{defaultMessage:"Delete all snooze schedules for {ruleName}?",values:{ruleName:e}})):(l=n,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteConfirmationPlural",{defaultMessage:"Delete all snooze schedules for {total, plural, one {# rule} other {# rules}}? ",values:{total:l}}));var e,l}),[t,s,n]);return"unschedule"===l&&(t.length||s)?Object(O.jsx)(g.EuiConfirmModal,{title:x,onCancel:r,onConfirm:f,confirmButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteConfirmButton",{defaultMessage:"Delete"}),cancelButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteCancelButton",{defaultMessage:"Cancel"}),buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"bulkRemoveScheduleConfirmationModal"}):"schedule"===l&&(t.length||s)?Object(O.jsx)(g.EuiModal,{onClose:r},Object(O.jsx)(g.EuiModalHeader,null,Object(O.jsx)(g.EuiModalHeaderTitle,null,Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkSnoozeScheduleModal.modalTitle",defaultMessage:"Add snooze schedule"})),Object(O.jsx)(g.EuiSpacer,{size:"s"})),Object(O.jsx)(g.EuiModalBody,null,Object(O.jsx)(nt.a,{bulkSnoozeSchedule:!0,hasTitle:!1,isLoading:!1,initialSchedule:null,onSaveSchedule:async e=>{r(),b(!0);try{const a=await u({ids:t.map((e=>e.id)),filter:s,snoozeSchedule:e});m(a,"snoozeSchedule")}catch(e){p.addError(e,{title:rt})}b(!1),o()},onCancelSchedules:f,onClose:()=>{}})),Object(O.jsx)(g.EuiModalFooter,null,Object(O.jsx)(g.EuiButtonEmpty,{onClick:r},"Close"))):null}));var ut=s(195),ct=function(e){return e.TOGGLE_SELECT_ALL="TOGGLE_SELECT_ALL",e.TOGGLE_ROW="TOGGLE_ROW",e.SET_SELECTION="SET_SELECTION",e.CLEAR_SELECTION="CLEAR_SELECTION",e}(ct||{});const dt={selectedIds:new Set,isAllSelected:!1},bt=(e,t)=>{const{type:s,payload:a}=t;switch(s){case ct.TOGGLE_SELECT_ALL:return{...e,isAllSelected:!e.isAllSelected,selectedIds:new Set};case ct.TOGGLE_ROW:{const t=a;return e.selectedIds.has(t)?e.selectedIds.delete(t):e.selectedIds.add(t),{...e,selectedIds:new Set(e.selectedIds)}}case ct.SET_SELECTION:{const t=a;return{...e,selectedIds:new Set(t)}}case ct.CLEAR_SELECTION:return{...dt,selectedIds:new Set};default:return e}};var jt=s(262),pt=s(15),gt=s(21),mt=s(53);const Ot=e=>e.reduce(((e,t)=>({...e,[t]:0})),{});var ft=s(57),xt=s(245),yt=s(160),ht=s(259),St=s(260);var Et=s(41),Tt=s(326),vt=s.n(Tt);const kt="triggersActionsUi_rulesList",It=e=>({actionTypes:e.actionTypes,lastResponse:e.ruleLastRunOutcomes,params:e.ruleParams,search:e.searchText,status:e.ruleStatuses,tags:e.tags,type:e.types}),Ct=Object(c.lazy)((()=>Promise.all([s.e(0),s.e(4),s.e(59)]).then(s.bind(null,84)))),Ft=Object(c.lazy)((()=>Promise.all([s.e(0),s.e(4),s.e(62)]).then(s.bind(null,81)))),Rt={[F.i.P50]:"monitoring.run.calculated_metrics.p50",[F.i.P95]:"monitoring.run.calculated_metrics.p95",[F.i.P99]:"monitoring.run.calculated_metrics.p99"},Lt=Object.values(F.i).map((e=>({checked:e===F.i.P50?"on":void 0,label:e,key:e}))),At=[],Mt=({filterConsumers:e,filteredRuleTypes:t=At,lastResponseFilter:s,lastRunOutcomeFilter:o,refresh:u,ruleDetailsRoute:b,ruleParamFilter:m,rulesListKey:f,searchFilter:x="",showActionFilter:y=!0,showCreateRuleButtonInPrompt:h=!1,showSearchBar:S=!0,statusFilter:E,typeFilter:F,visibleColumns:R,onLastResponseFilterChange:L,onLastRunOutcomeFilterChange:A,onRuleParamFilterChange:P,onSearchFilterChange:_,onStatusFilterChange:B,onTypeFilterChange:N,onRefresh:$,setHeaderActions:q,initialSelectedConsumer:G=k.c})=>{const H=Object(v.useHistory)(),K=Object(U.b)().services,{actionTypeRegistry:W,application:{capabilities:V},http:Y,kibanaFeatures:Z,notifications:{toasts:X},ruleTypeRegistry:ee,i18n:te,theme:se}=K,ae=Object(Ie.c)(V),[le,ie]=Object(c.useState)(!1),[ne,re]=Object(c.useState)({index:0,size:w.i}),[oe,ue]=Object(c.useState)(x),[ce,be]=Object(c.useState)(!1),[je,pe]=Object(c.useState)(void 0),[ge,me]=Object(c.useState)(!1),[Oe,fe]=Object(c.useState)(!1),[Fe,Re]=Object(c.useState)(null),[Le,Pe]=Object(c.useState)({}),[Ue,_e]=Object(c.useState)(!1),De=Object(c.useRef)(null),Be=Object(J.a)("ruleStatusFilter"),[Ne,$e]=Object(c.useState)(Lt),[qe,Ge]=Object(c.useState)({field:"name",direction:"asc"}),[He,Ke]=Object(c.useState)(null),[We,Qe]=Object(c.useState)(!1),[Je,Ve]=Object(c.useState)(!1),[Ye,Ze]=Object(c.useState)([]),[at,lt]=Object(c.useState)(),[nt,rt]=Object(c.useState)(),[Tt,Rt]=Object(c.useState)(!1),[Mt,zt]=Object(c.useState)(!1),[Pt,Ut]=Object(c.useState)(!1),[_t,Dt]=Object(c.useState)(new Date),{config:Bt}=(()=>{const{http:e}=Object(U.b)().services,{data:t}=Object(j.useQuery)({queryKey:["loadConfig"],queryFn:()=>Object(p.a)({http:e}),initialData:{isUsingSecurity:!1},refetchOnWindowFocus:!1});return{config:t}})(),{ruleTypesState:Nt,hasAnyAuthorizedRuleType:$t,authorizedRuleTypes:qt,authorizedToReadAnyRules:Gt,authorizedToCreateAnyRules:Ht,isSuccess:Kt}=Object(ft.a)({filteredRuleTypes:t}),{actionTypes:Wt}=(()=>{const{http:e,actionTypeRegistry:t,notifications:{toasts:s}}=Object(U.b)().services,{data:l=[]}=Object(j.useQuery)({queryKey:["loadActionTypes"],queryFn:()=>Object(gt.d)({http:e,featureId:pt.AlertingConnectorFeatureId}),onError:()=>{s.addDanger(a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadConnectorTypesMessage",{defaultMessage:"Unable to load connector types"}))},refetchOnWindowFocus:!1});return{actionTypes:l.filter((({id:e})=>t.has(e))).sort(((e,t)=>e.name.localeCompare(t.name)))}})(),{filters:Qt,setFiltersStore:Jt,numberOfFiltersStore:Vt,resetFiltersStore:Yt}=(({lastResponseFilter:e,lastRunOutcomeFilter:t,rulesListKey:s=kt,ruleParamFilter:a,statusFilter:i,searchFilter:n,typeFilter:r})=>{var o,u,d,b,j,p,g,m,O,f,x,y;const h=Object(v.useHistory)(),S=Object(Et.createKbnUrlStateStorage)({history:h,useHash:!1,useHashQuery:!1}),[E,T]=vt()(`${kt}_filters`,{}),k=Object(c.useMemo)((()=>!!E&&!Object.values(E).every((e=>Object(l.isEmpty)(e)))),[E]),I=Object(c.useMemo)((()=>{var e;return null!==(e=S.get("_a"))&&void 0!==e?e:{}}),[S]),C=Object(c.useMemo)((()=>!!I&&!Object.values(I).every((e=>Object(l.isEmpty)(e)))),[I]),F=Object(c.useMemo)((()=>C?I:k?E:{}),[k,C,E,I]),[R,L]=Object(c.useState)({actionTypes:null!==(o=null==F?void 0:F.actionTypes)&&void 0!==o?o:[],ruleExecutionStatuses:null!=e?e:[],ruleLastRunOutcomes:null!==(u=null!==(d=null==F?void 0:F.lastResponse)&&void 0!==d?d:t)&&void 0!==u?u:[],ruleParams:null!==(b=null!==(j=null==F?void 0:F.params)&&void 0!==j?j:a)&&void 0!==b?b:{},ruleStatuses:null!==(p=null!==(g=null==F?void 0:F.status)&&void 0!==g?g:i)&&void 0!==p?p:[],searchText:null!==(m=null!==(O=null==F?void 0:F.search)&&void 0!==O?O:n)&&void 0!==m?m:"",tags:null!==(f=null==F?void 0:F.tags)&&void 0!==f?f:[],types:null!==(x=null!==(y=null==F?void 0:F.type)&&void 0!==y?y:r)&&void 0!==x?x:[],kueryNode:void 0}),A=Object(c.useCallback)((e=>{S.set("_a",It(e))}),[S]),M=Object(c.useCallback)((e=>{T(It(e))}),[T]),w=Object(c.useCallback)((e=>{const{filter:t,value:s}=e;L((e=>{const a={...e,[t]:s};return A(a),M(a),a}))}),[M,A]),z=Object(c.useCallback)((()=>{const e={actionTypes:[],ruleExecutionStatuses:[],ruleLastRunOutcomes:[],ruleParams:{},ruleStatuses:[],searchText:"",tags:[],types:[],kueryNode:void 0};L(e),A(e),M(e)}),[M,A]);return Object(c.useEffect)((()=>{var s,l,o,u,c,d,b,j,p,g,m,O;(C||k)&&L({actionTypes:null!==(s=null==F?void 0:F.actionTypes)&&void 0!==s?s:[],ruleExecutionStatuses:null!=e?e:[],ruleLastRunOutcomes:null!==(l=null!==(o=null==F?void 0:F.lastResponse)&&void 0!==o?o:t)&&void 0!==l?l:[],ruleParams:null!==(u=null!==(c=null==F?void 0:F.params)&&void 0!==c?c:a)&&void 0!==u?u:{},ruleStatuses:null!==(d=null!==(b=null==F?void 0:F.status)&&void 0!==b?b:i)&&void 0!==d?d:[],searchText:null!==(j=null!==(p=null==F?void 0:F.search)&&void 0!==p?p:n)&&void 0!==j?j:"",tags:null!==(g=null==F?void 0:F.tags)&&void 0!==g?g:[],types:null!==(m=null!==(O=null==F?void 0:F.type)&&void 0!==O?O:r)&&void 0!==m?m:[],kueryNode:void 0})}),[]),Object(c.useMemo)((()=>({filters:R,setFiltersStore:w,numberOfFiltersStore:Object.values(R).filter((e=>!Object(l.isEmpty)(e))).length,resetFiltersStore:z})),[R,z,w])})({lastResponseFilter:s,lastRunOutcomeFilter:o,rulesListKey:f,ruleParamFilter:m,statusFilter:E,searchFilter:x,typeFilter:F}),Zt=Object(l.isEmpty)(Qt.types)?qt.map((e=>e.id)):Qt.types,Xt=Object(l.isEmpty)(Qt.types),es=Object(c.useMemo)((()=>({...Qt,types:Zt})),[Qt,Zt]),ts=Kt&&$t,{rulesState:ss,loadRules:as,hasData:ls,lastUpdate:is}=Object(xt.a)({filterConsumers:e,filters:es,hasDefaultRuleTypesFiltersOn:Xt,page:ne,sort:qe,onPage:re,enabled:ts,refresh:u}),{loadRuleAggregations:ns,rulesStatusesTotal:rs,rulesLastRunOutcomesTotal:os}=(e=>{var t,s;const{filters:l,enabled:i,refresh:n,filterConsumers:o}=e,{http:u,notifications:{toasts:c}}=Object(U.b)().services,{data:d,refetch:b,isLoading:p,isFetching:g}=Object(j.useQuery)({queryKey:["loadRuleAggregationsWithKueryFilter",l.searchText,l.types,l.actionTypes,l.ruleExecutionStatuses,l.ruleLastRunOutcomes,l.ruleStatuses,l.tags,{refresh:null==n?void 0:n.toISOString()}],queryFn:()=>async function({http:e,searchText:t,typesFilter:s,actionTypesFilter:a,ruleExecutionStatusesFilter:l,ruleStatusesFilter:i,tagsFilter:n,filterConsumers:r}){const o=Object(ut.a)({typesFilter:s,actionTypesFilter:a,tagsFilter:n,ruleExecutionStatusesFilter:l,ruleStatusesFilter:i,searchText:t}),u=await e.post(`${w.m}/rules/_aggregate`,{body:JSON.stringify({...o?{filter:JSON.stringify(o)}:{},filter_consumers:r,default_search_operator:"AND"})});return Object(mt.a)(u)}({http:u,searchText:l.searchText,typesFilter:l.types,actionTypesFilter:l.actionTypes,ruleExecutionStatusesFilter:l.ruleExecutionStatuses,ruleLastRunOutcomesFilter:l.ruleLastRunOutcomes,ruleStatusesFilter:l.ruleStatuses,tagsFilter:l.tags,filterConsumers:o}),onError:()=>{c.addDanger(a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadRuleStatusInfoMessage",{defaultMessage:"Unable to load rule status info"}))},enabled:i,keepPreviousData:!0,cacheTime:0,refetchOnWindowFocus:!1}),m=d||{ruleExecutionStatus:Ot(r.RuleExecutionStatusValues),ruleLastRunOutcome:Ot(r.RuleLastRunOutcomeValues)};return{loadRuleAggregations:b,rulesStatusesTotal:null!==(t=m.ruleExecutionStatus)&&void 0!==t?t:{},rulesLastRunOutcomesTotal:null!==(s=m.ruleLastRunOutcome)&&void 0!==s?s:{},isLoading:p&&g}})({filterConsumers:e,filters:es,enabled:ts,refresh:u}),{showSpinner:us,showRulesList:cs,showNoAuthPrompt:ds,showCreateFirstRulePrompt:bs}=(({authorizedToReadAnyRules:e,authorizedToCreateAnyRules:t,filters:s,hasDefaultRuleTypesFiltersOn:a,isLoadingRuleTypes:i,isLoadingRules:n,isInitialLoadingRuleTypes:r,isInitialLoadingRules:o,hasData:u})=>{const c=(({hasEmptyTypesFilter:e,filters:t})=>!(e&&Object(l.isEmpty)(t.searchText)&&Object(l.isEmpty)(t.actionTypes)&&Object(l.isEmpty)(t.ruleExecutionStatuses)&&Object(l.isEmpty)(t.ruleLastRunOutcomes)&&Object(l.isEmpty)(t.ruleStatuses)&&Object(l.isEmpty)(t.tags)))({hasEmptyTypesFilter:!!a||Object(l.isEmpty)(s.types),filters:s}),d=!r&&!e,b=!(i||n)&&!u&&!c&&t,j=(r||o)&&(i||!d&&n);return{showSpinner:j,showRulesList:!j&&!b&&!d,showNoAuthPrompt:d,showCreateFirstRulePrompt:b}})({authorizedToReadAnyRules:Gt,authorizedToCreateAnyRules:Ht,filters:Qt,hasDefaultRuleTypesFiltersOn:Xt,isLoadingRuleTypes:Nt.isLoading,isLoadingRules:ss.isLoading,hasData:ls,isInitialLoadingRuleTypes:Nt.initialLoad,isInitialLoadingRules:ss.initialLoad}),js=e=>{fe(!0),Re(e)},ps=Object(c.useCallback)((async()=>{if(!Nt||!$t)return;const e=new Date;Dt(e),null==$||$(e),await as(),await ns()}),[as,ns,Dt,$,Be,$t,Nt]),gs=Object(c.useMemo)((()=>Nt.initialLoad?[]:Xe({rules:ss.data,ruleTypeIndex:Nt.data,canExecuteActions:ae,config:Bt})),[Nt,ss.data,ae,Bt]),{isAllSelected:ms,selectedIds:Os,isPageSelected:fs,numberOfSelectedItems:xs,isRowSelected:ys,getFilter:hs,onSelectRow:Ss,onSelectAll:Es,onSelectPage:Ts,onClearSelection:vs}=function(e){const{totalItemCount:t=0,items:s=[],filters:a}=e,[l,i]=Object(c.useReducer)(bt,{...dt,selectedIds:new Set}),n=Object(c.useMemo)((()=>s.map((e=>e.id))),[s]),r=Object(c.useMemo)((()=>{const{selectedIds:e,isAllSelected:s}=l;return t?s?t-e.size:n.filter((t=>e.has(t))).length:0}),[l,n,t]),o=Object(c.useMemo)((()=>{const{selectedIds:e,isAllSelected:t}=l;return!!s.length&&s.every((s=>!s.isEditable||(t?!e.has(s.id):e.has(s.id))))}),[l,s]),u=Object(c.useCallback)((e=>{const{selectedIds:t,isAllSelected:s}=l;return!!e.isEditable&&(s?!t.has(e.id):t.has(e.id))}),[l]),d=Object(c.useCallback)((e=>{i({type:ct.TOGGLE_ROW,payload:e.id})}),[]),b=Object(c.useCallback)((()=>{i({type:ct.TOGGLE_SELECT_ALL,payload:!l.isAllSelected})}),[l]),j=Object(c.useCallback)((()=>{const{selectedIds:e,isAllSelected:t}=l;if(!o&&!t){const t=s.filter((e=>e.isEditable)).map((e=>e.id));i({type:ct.SET_SELECTION,payload:[...e,...t]})}o&&!t&&(s.forEach((t=>e.delete(t.id))),i({type:ct.SET_SELECTION,payload:[...e]})),!o&&t&&(s.forEach((t=>{t.isEditable&&e.delete(t.id)})),i({type:ct.SET_SELECTION,payload:[...e]})),o&&t&&i({type:ct.SET_SELECTION,payload:[...e,...n]})}),[l,o,s,n]),p=Object(c.useCallback)((()=>{i({type:ct.CLEAR_SELECTION})}),[]),g=Object(c.useCallback)((e=>{const t=Object(ut.a)(a?{typesFilter:a.types,actionTypesFilter:a.actionTypes,tagsFilter:a.tags,ruleExecutionStatusesFilter:a.ruleExecutionStatuses,ruleLastRunOutcomesFilter:a.ruleLastRunOutcomes,ruleParamsFilter:a.ruleParams,ruleStatusesFilter:a.ruleStatuses,searchText:a.searchText}:{});if(e&&e.length){const s=Object(de.fromKueryExpression)(`NOT (${e.map((e=>`alert.id: "alert:${e}"`)).join(" or ")})`);return t?de.nodeBuilder.and([t,s]):s}return t}),[a]),m=Object(c.useCallback)((()=>{const{selectedIds:e,isAllSelected:t}=l,s=[...e];return t?0===s.length?g():g(s):g()}),[l,g]);return Object(c.useMemo)((()=>({selectedIds:[...l.selectedIds],isAllSelected:l.isAllSelected,isPageSelected:o,numberOfSelectedItems:r,isRowSelected:u,getFilter:m,onSelectRow:d,onSelectAll:b,onSelectPage:j,onClearSelection:p})),[l,o,r,u,m,d,b,j,p])}({totalItemCount:ss.totalItemCount,items:gs,filters:{...Qt,types:Zt}}),ks=Object(c.useCallback)((e=>{const{filter:t,value:s}=e;switch(vs(),t){case"ruleStatuses":null==B||B(s);break;case"ruleExecutionStatuses":null==L||L(s);break;case"ruleLastRunOutcomes":null==A||A(s);break;case"ruleParams":null==P||P(s);break;case"searchText":null==_||_(s);break;case"types":null==N||N(s)}}),[B,L,A,_,N,vs]),Is=Object(c.useCallback)((e=>{Jt(e),ks(e)}),[Jt,ks]);Object(c.useEffect)((()=>{E&&Is({filter:"ruleStatuses",value:E})}),[E]),Object(c.useEffect)((()=>{s&&Is({filter:"ruleExecutionStatuses",value:s})}),[s]),Object(c.useEffect)((()=>{o&&Is({filter:"ruleLastRunOutcomes",value:o})}),[o]),Object(c.useEffect)((()=>{m&&!Object(l.isEqual)(m,Qt.ruleParams)&&Is({filter:"ruleParams",value:m})}),[m]),Object(c.useEffect)((()=>{"string"==typeof x&&Is({filter:"searchText",value:x})}),[x]),Object(c.useEffect)((()=>{F&&Is({filter:"types",value:F})}),[F]),Object(c.useEffect)((()=>{if(De.current){const e=gs.find((e=>e.id===De.current));De.current=null,zt(!1),e&&js(e)}}),[gs]);const Cs=e=>{var t,s;const a="error"===e.status,l=null==e||null===(t=e.error)||void 0===t?void 0:t.message,n=(null===(s=e.error)||void 0===s?void 0:s.reason)===r.RuleExecutionStatusErrorReasons.License?M.a:null;return[{title:Object(O.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.expandRow.title",defaultMessage:"Error from last run"}),description:Object(O.jsx)(d.a.Fragment,null,l,a&&n&&Object(O.jsx)(g.EuiSpacer,{size:"xs"}),n)}]},Fs=Object(c.useCallback)((()=>{_e((e=>{if(e)Pe({});else{const e=ss.data.reduce(((e,t)=>{var s;return(null===(s=t.lastRun)||void 0===s?void 0:s.outcome)===r.RuleLastRunOutcomeValues[2]||"error"===t.executionStatus.status?{...e,[t.id]:Object(O.jsx)(g.EuiDescriptionList,{listItems:Cs(t.executionStatus)})}:e}),{});Pe(e)}return!e}))}),[Ue,ss]),Rs=Object(c.useCallback)(((e,t)=>Object(Ee.a)({http:Y,ids:[e.id],untrack:t})),[Ee.a]),Ls=Object(c.useCallback)((e=>Object(Te.a)({http:Y,ids:[e.id]})),[Te.a]),As=e=>{ue(e),Is({filter:"searchText",value:e})},Ms=Object(l.sortBy)(Object.entries(qt.reduce(((e,t)=>{const s=t.producer;return(e[s]=e[s]||[]).push({value:t.id,name:t.name}),e}),{}))).map((([e,t])=>{var s,a,i;return{groupName:null!==(a=e,s=null==Z||null===(i=Z.find((e=>e.id===a)))||void 0===i?void 0:i.name)&&void 0!==s?s:Object(l.capitalize)(e),subOptions:t.sort(((e,t)=>e.name.localeCompare(t.name)))}})),ws=Object(c.useMemo)((()=>!!ms||!!Os.length&&wt(ss.data,Os).every((e=>Object(Ie.a)(e.consumer,Nt.data.get(e.ruleTypeId))))),[Os,ss.data,Nt.data,ms]),zs=Object(c.useCallback)((({action:e,rules:t,filter:s})=>{rt(e),t&&Ze(t),s&&lt(s),"delete"===e&&Ns(t&&t.length>0||Boolean(s))}),[]),Ps=Object(c.useCallback)((()=>{"delete"===nt&&Ns(!1),Ze([]),lt(void 0),rt(void 0)}),[]),Us=Pt||ss.isLoading||Nt.isLoading||Tt||le||We||Je||Mt,_s=async e=>{zt(!0);try{const t=await Object(ke.a)({http:Y,ruleId:e});De.current=t.id,await as()}catch{De.current=null,zt(!1),X.addDanger(a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.cloneFailed",{defaultMessage:"Unable to clone rule"}))}},Ds=Object(c.useCallback)((()=>{be(!0)}),[]);Object(c.useEffect)((()=>{null==q||q([...Ht?[Object(O.jsx)(Me,{openFlyout:Ds})]:[],Object(O.jsx)(St.RulesSettingsLink,null),Object(O.jsx)(tt.a,null)])}),[Ht]),Object(c.useEffect)((()=>()=>null==q?void 0:q()),[]);const[Bs,Ns]=Object(c.useState)(!1),{showToast:$s}=Object(ht.a)({onSearchPopulate:As}),qs=async()=>{Qe(!0);const{errors:e,total:t}=ms?await Object(Te.a)({http:Y,filter:hs()}):await Object(Te.a)({http:Y,ids:Os});Qe(!1);const s=e.find((e=>!!Object(r.parseRuleCircuitBreakerErrorMessage)(e.message).details));if(s){const e=Object(r.parseRuleCircuitBreakerErrorMessage)(s.message);X.addDanger({title:e.summary,text:Object(n.a)(Object(O.jsx)(yt.a,null,e.details),{theme:se,i18n:te})})}else $s({action:"ENABLE",errors:e,total:t});await ps(),vs()},Gs=async e=>{Ve(!0);const{errors:t,total:s}=ms?await Object(Ee.a)({http:Y,filter:hs(),untrack:e}):await Object(Ee.a)({http:Y,ids:Os,untrack:e});Ve(!1),$s({action:"DISABLE",errors:t,total:s}),await ps(),vs()},Hs=Ye.length||xs;return Object(O.jsx)(d.a.Fragment,null,S&&!Object(l.isEmpty)(Qt.ruleParams)?Object(O.jsx)(ze,{onClickClearFilter:()=>Is({filter:"ruleParams",value:{}})}):null,Object(O.jsx)(C.d,{kibanaServices:K,categories:e}),Object(O.jsx)(Ae,{showNoAuthPrompt:ds,showCreateFirstRulePrompt:bs,showCreateRuleButtonInPrompt:h,showSpinner:us,onCreateRulesClick:Ds}),Object(O.jsx)(g.EuiPageTemplate.Section,{"data-test-subj":"rulesList",grow:!1,paddingSize:"none"},Bs&&Object(O.jsx)(Ce.a,{onConfirm:async()=>{if("delete"!==nt)return;Ns(!1),Rt(!0);const e=ms&&at?{filter:at,http:Y}:{ids:Ye.map((e=>e.id)),http:Y},{errors:t,total:s}=await Object(ve.a)(e);Rt(!1),$s({action:"DELETE",errors:t,total:s}),Ps(),vs(),ps()},onCancel:()=>{Ns(!1),Ps()},confirmButtonText:Object(M.y)(Hs,M.w,M.f),confirmModalText:Object(M.z)(Hs,M.w,M.f)}),Object(O.jsx)(it,{rules:Ye,filter:at,bulkEditAction:nt,numberOfSelectedRules:xs,setIsBulkEditing:Rt,onClose:()=>{Ze([]),lt(void 0)},onSave:async()=>{Ps(),vs(),await ps()},onSearchPopulate:As}),Object(O.jsx)(ot,{rules:Ye,filter:at,bulkEditAction:nt,numberOfSelectedRules:xs,setIsBulkEditing:Rt,onClose:()=>{Ze([]),lt(void 0)},onSave:async()=>{Ps(),vs(),await ps()},onSearchPopulate:As}),"updateApiKey"===nt&&Object(O.jsx)(st.a,{onCancel:()=>{Ps()},rulesToUpdate:Ye,idsToUpdateFilter:at,numberOfSelectedRules:xs,apiUpdateApiKeyCall:Se.a,setIsLoadingState:e=>{Rt(e),Ut(e)},onUpdated:async()=>{Ps(),vs(),await ps()},onSearchPopulate:As}),Object(O.jsx)(g.EuiSpacer,{size:"xs"}),cs&&Object(O.jsx)(d.a.Fragment,null,S?Object(O.jsx)(d.a.Fragment,null,Object(O.jsx)(xe,{actionTypes:Wt,filterOptions:Ms,filters:Qt,inputText:oe,lastUpdate:is,rulesLastRunOutcomesTotal:os,rulesStatusesTotal:rs,setInputText:ue,showActionFilter:y,showErrors:Ue,canLoadRules:ts,refresh:u||_t,updateFilters:Is,onClearSelection:vs,onRefreshRules:ps,onToggleRuleErrors:Fs}),Object(O.jsx)(g.EuiSpacer,{size:"s"})):null,Object(O.jsx)(et,{items:gs,isLoading:Us,rulesState:ss,ruleTypesState:Nt,ruleTypeRegistry:ee,isPageSelected:fs,isAllSelected:ms,numberOfSelectedRules:xs,sort:qe,page:ne,percentileOptions:Ne,itemIdToExpandedRowMap:Le,onSort:Ge,onPage:re,onRuleChanged:ps,onRuleClick:e=>{const t=b||I.b;H.push(t.replace(":ruleId",e.id))},onRuleEditClick:e=>{var t;e.isEditable&&(t=e.ruleTypeId,ee.has(t)&&!ee.get(t).requiresAppContext)&&js(e)},onRuleDeleteClick:e=>zs({action:"delete",rules:[e]}),onManageLicenseClick:e=>{var t;return Ke({licenseType:null===(t=Nt.data.get(e.ruleTypeId))||void 0===t?void 0:t.minimumLicenseRequired,ruleTypeId:e.ruleTypeId})},onPercentileOptionsChange:$e,onDisableRule:Rs,onEnableRule:Ls,onSnoozeRule:(e,t)=>Object(ye.b)({http:Y,id:e.id,snoozeSchedule:t}),onUnsnoozeRule:(e,t)=>Object(he.b)({http:Y,id:e.id,scheduleIds:t}),onSelectAll:Es,onSelectPage:Ts,onSelectRow:Ss,isRowSelected:ys,renderCollapsedItemActions:(e,t)=>Object(O.jsx)(Q,{key:e.id,item:e,onLoading:t,onRuleChanged:ps,onDeleteRule:()=>zs({action:"delete",rules:[e]}),onEditRule:()=>js(e),onUpdateAPIKey:()=>zs({action:"updateApiKey",rules:[e]}),onRunRule:()=>(async e=>{await Object(jt.a)(Y,X,e)})(e.id),onCloneRule:_s}),renderRuleError:e=>{var t;const s=e.executionStatus,a="error"===s.status;return(null===(t=s.error)||void 0===t?void 0:t.reason)===r.RuleExecutionStatusErrorReasons.License||a?Object(O.jsx)(g.EuiButtonIcon,{onClick:()=>((e,t)=>{Pe((s=>{const a={...s};return a[t.id]?delete a[t.id]:a[t.id]=Object(O.jsx)(g.EuiDescriptionList,{listItems:Cs(e)}),a}))})(s,e),"aria-label":Le[e.id]?"Collapse":"Expand",iconType:Le[e.id]?"arrowUp":"arrowDown"}):null},renderSelectAllDropdown:()=>Object(O.jsx)(z,{numberOfSelectedRules:xs,canModifySelectedRules:ws},Object(O.jsx)(D,{selectedItems:Xe({rules:wt(ss.data,Os),ruleTypeIndex:Nt.data,canExecuteActions:ae,config:Bt}),isBulkEditing:Tt,bulkEditAction:nt,updateRulesToBulkEdit:zs,isAllSelected:ms,getFilter:hs,onPerformingAction:()=>ie(!0),onActionPerformed:()=>{ps(),ie(!1)},isEnablingRules:We,isDisablingRules:Je,onEnable:qs,onDisable:Gs})),rulesListKey:f,config:Bt,visibleColumns:R,numberOfFilters:Vt,resetFilters:Yt}),He&&Object(O.jsx)(we,{licenseType:He.licenseType,ruleTypeId:He.ruleTypeId,onConfirm:()=>{window.open(`${Y.basePath.get()}/app/management/stack/license_management`,"_blank"),Ke(null)},onCancel:()=>Ke(null)})),ce&&Object(O.jsx)(T,{onClose:()=>be(!1),onSelectRuleType:e=>{pe(e),be(!1),me(!0)},http:Y,toasts:X,registeredRuleTypes:ee.list(),filteredRuleTypes:t}),ge&&Object(O.jsx)(c.Suspense,{fallback:Object(O.jsx)("div",null)},Object(O.jsx)(Ct,{consumer:r.ALERTING_FEATURE_ID,onClose:()=>{me(!1)},actionTypeRegistry:W,ruleTypeRegistry:ee,ruleTypeIndex:Nt.data,onSave:ps,initialSelectedConsumer:G,ruleTypeId:je,canChangeTrigger:!1})),Oe&&Fe&&Object(O.jsx)(c.Suspense,{fallback:Object(O.jsx)("div",null)},Object(O.jsx)(Ft,{initialRule:Fe,onClose:()=>{fe(!1)},actionTypeRegistry:W,ruleTypeRegistry:ee,ruleType:Nt.data.get(Fe.ruleTypeId),onSave:ps}))))};function wt(e,t){return e.filter((e=>t.includes(e.id)))}},160:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var a=s(2),l=s(1),i=s.n(l),n=s(3),r=s(0);const o=a.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.seeFullError",{defaultMessage:"See full error"}),u=a.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.hideFullError",{defaultMessage:"Hide full error"}),c=({children:e})=>{const[t,s]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>{s((e=>!e))}),[]);return Object(r.jsx)(i.a.Fragment,null,t&&Object(r.jsx)(i.a.Fragment,null,Object(r.jsx)(n.EuiText,{size:"s"},e),Object(r.jsx)(n.EuiSpacer,null)),Object(r.jsx)(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(r.jsx)(n.EuiFlexItem,{grow:!1},Object(r.jsx)(n.EuiButton,{size:"s",color:"danger",onClick:a},t?u:o))))}},168:function(e,t,s){"use strict";s.d(t,"c",(function(){return l})),s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));var a=s(128);const l=[],i="searchBarParams",n=Object.values(a.a).filter((e=>e!==a.a.SIEM))},183:function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return o}));var a=s(33),l=s.n(a),i=s(10),n=s(11);function r(e){if(!e)return"00:00:00.000";const t=l.a.duration(e);return`${[t.hours(),t.minutes(),t.seconds()].map((e=>Object(i.padStart)(`${e}`,2,"0"))).join(":")}.${Object(i.padStart)(`${t.milliseconds()}`,3,"0")}`}function o(e,t){if(!e||!e.ruleTaskTimeout)return!1;const s=e.ruleTaskTimeout;return t>Object(n.parseDuration)(s)}},190:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));var a=s(25),l=s(141);async function i({http:e,rule:t}){const s=await e.post(`${a.b}/rule`,{body:JSON.stringify(n(t))});return Object(l.c)(s)}const n=({ruleTypeId:e,actions:t,alertDelay:s,...a})=>({...a,rule_type_id:e,actions:t.map((e=>{const{id:t,params:s}=e;return{..."group"in e&&e.group?{group:e.group}:{},id:t,params:s,..."frequency"in e&&e.frequency?{frequency:{notify_when:e.frequency.notifyWhen,throttle:e.frequency.throttle,summary:e.frequency.summary}}:{},..."alertsFilter"in e&&e.alertsFilter?{alerts_filter:e.alertsFilter}:{},..."useAlertDataForTemplate"in e&&void 0!==e.useAlertDataForTemplate?{use_alert_data_for_template:e.useAlertDataForTemplate}:{}}})),...s?{alert_delay:s}:{}})},191:function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"a",(function(){return r})),s.d(t,"c",(function(){return o}));const a=({actions:e,alertDelay:t,...s})=>({...s,actions:e.map((e=>{const{id:t,params:s,uuid:a}=e;return{..."group"in e?{group:e.group}:{},id:t,params:s,..."frequency"in e?{frequency:e.frequency?{notify_when:e.frequency.notifyWhen,throttle:e.frequency.throttle,summary:e.frequency.summary}:void 0}:{},..."alertsFilter"in e?{alerts_filter:e.alertsFilter}:{},..."useAlertDataForTemplate"in e&&void 0!==e.useAlertDataForTemplate?{use_alert_data_for_template:e.useAlertDataForTemplate}:{},...a&&{uuid:a}}})),...t?{alert_delay:t}:{}});var l=s(10),i=s(25),n=s(141);const r=["name","tags","schedule","params","alertDelay","actions"];async function o({http:e,rule:t,id:s}){const o=await e.put(`${i.b}/rule/${encodeURIComponent(s)}`,{body:JSON.stringify(a(Object(l.pick)(t,r)))});return Object(n.c)(o)}},195:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var a=s(95),l=s(10);const i=({typesFilter:e,actionTypesFilter:t,ruleExecutionStatusesFilter:s,ruleLastRunOutcomesFilter:i,ruleParamsFilter:n,ruleStatusesFilter:r,tagsFilter:o,searchText:u,kueryNode:c})=>{const d=[];if(c&&!Object(l.isEmpty)(c)&&d.push(c),e&&e.length&&d.push(a.nodeBuilder.or(e.map((e=>a.nodeBuilder.is("alert.attributes.alertTypeId",e))))),t&&t.length&&d.push(a.nodeBuilder.or(t.map((e=>Object(a.fromKueryExpression)(`alert.attributes.actions:{ actionTypeId: ${e} }`))))),s&&s.length&&d.push(a.nodeBuilder.or(s.map((e=>a.nodeBuilder.is("alert.attributes.executionStatus.status",e))))),i&&i.length&&d.push(a.nodeBuilder.or(i.map((e=>a.nodeBuilder.is("alert.attributes.lastRun.outcome",e))))),n&&Object.keys(n).length&&d.push(a.nodeBuilder.and(Object.keys(n).map((e=>a.nodeBuilder.is(`alert.attributes.params.${e}`,String(n[e])))))),r&&r.length){const e=a.nodeBuilder.or([Object(a.fromKueryExpression)("alert.attributes.muteAll: true"),Object(a.fromKueryExpression)("alert.attributes.snoozeSchedule:{ duration > 0 }")]),t=Object(a.fromKueryExpression)("alert.attributes.enabled: true"),s=Object(a.fromKueryExpression)("alert.attributes.enabled: false"),l=[];r.includes("enabled")&&l.push(t),r.includes("disabled")&&l.push(s),r.includes("snoozed")&&l.push(e),d.push(a.nodeBuilder.or(l))}if(o&&o.length&&d.push(a.nodeBuilder.or(o.map((e=>a.nodeBuilder.is("alert.attributes.tags",e))))),u&&""!==u){const e=u.match(/(['"`])(.*?)\1/g)?a.nodeTypes.literal.buildNode(u,!0):a.nodeTypes.wildcard.buildNode(u);d.push(a.nodeBuilder.or([a.nodeBuilder.is("alert.attributes.name",e),a.nodeBuilder.is("alert.attributes.tags",e)]))}return d.length?a.nodeBuilder.and(d):null}},196:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s(1);var a=s(3),l=s(24),i=s(0);const n=()=>Object(i.jsx)(a.EuiPageTemplate.EmptyPrompt,{"data-test-subj":"noPermissionPrompt",iconType:"securityApp",title:Object(i.jsx)("h1",null,Object(i.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.noPermissionToReadTitle",defaultMessage:"No permissions to read rules and alerts"})),body:Object(i.jsx)("p",{"data-test-subj":"permissionDeniedMessage"},Object(i.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.noPermissionToCreateDescription",defaultMessage:"Contact your system administrator."}))})},214:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(10),l=s(2);const i=e=>({isEnabled:!1,message:l.i18n.translate("xpack.triggersActionsUI.checkRuleTypeEnabled.ruleTypeDisabledByLicenseMessage",{defaultMessage:"This rule type requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(a.upperFirst)(e.minimumLicenseRequired)}})});function n(e){return!1===(null==e?void 0:e.enabledInLicense)?i(e):{isEnabled:!0}}},220:function(e,t,s){"use strict";s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return u}));var a=s(33),l=s.n(a),i=s(39),n=s.n(i);function r(e){return`${n()(100*e).format("0,0")}%`}function o(e){if(!e)return"00:00";const t=l.a.duration(e);let s=Math.floor(t.asMinutes()),a=t.seconds();return t.milliseconds()>=500&&(a+=1,60===a&&(a=0,s+=1)),`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function u(e){return`${n()(e).format("0,0")} ms`}},240:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var a=s(1),l=s(3),i=s(220),n=s(0);const r=Object(a.memo)((e=>{const{duration:t,allowZero:s=!0}=e,r=Object(a.useMemo)((()=>s||"number"==typeof t?Object(i.a)(t):"N/A"),[t,s]),o=Object(a.useMemo)((()=>s||"number"==typeof t?Object(i.b)(t):"N/A"),[t,s]);return Object(n.jsx)(l.EuiToolTip,{"data-test-subj":"rule-duration-format-tooltip",content:o},Object(n.jsx)("span",{"data-test-subj":"rule-duration-format-value"},r))}))},242:function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s(1);var a=s(24),l=s(3),i=s(29),n=s(0);const r=()=>{const{docLinks:e}=Object(i.b)().services;return Object(n.jsx)(l.EuiButtonEmpty,{href:e.links.alerting.guide,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(n.jsx)(a.FormattedMessage,{id:"xpack.triggersActionsUI.home.docsLinkText",defaultMessage:"Documentation"}))}},245:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var a=s(33),l=s.n(a),i=s(2),n=s(4),r=s(6),o=s(195),u=s(38),c=s(29);const d=e=>{var t,s;const{filterConsumers:a,filters:d,page:b,sort:j,onPage:p,enabled:g,refresh:m,hasReference:O}=e,{http:f,notifications:{toasts:x}}=Object(c.b)().services,{refetch:y,isLoading:h,data:S,dataUpdatedAt:E,isInitialLoading:T,isFetching:v}=Object(n.useQuery)({queryKey:["loadRules",d.tags,d.searchText,d.types,d.actionTypes,d.ruleStatuses,d.ruleLastRunOutcomes,d.ruleParams,d.kueryNode,b,j,{refresh:null==m?void 0:m.toISOString()},a,O],queryFn:()=>async function({http:e,page:t,searchText:s,typesFilter:a,actionTypesFilter:l,ruleExecutionStatusesFilter:i,ruleLastRunOutcomesFilter:n,ruleParamsFilter:c,ruleStatusesFilter:d,tagsFilter:b,sort:j={field:"name",direction:"asc"},kueryNode:p,filterConsumers:g,hasReference:m}){const O=Object(o.a)({typesFilter:a,actionTypesFilter:l,tagsFilter:b,ruleExecutionStatusesFilter:i,ruleLastRunOutcomesFilter:n,ruleParamsFilter:c,ruleStatusesFilter:d,searchText:s,kueryNode:p}),f=await e.post(`${r.m}/rules/_find`,{body:JSON.stringify({page:t.index+1,per_page:t.size,...O?{filter:JSON.stringify(O)}:{},sort_field:j.field,sort_order:j.direction,filter_consumers:g,...m?{has_reference:m}:{}})});return{page:f.page,perPage:f.per_page,total:f.total,data:(x=f.data,x.map((e=>Object(u.a)(e))))};var x}({http:f,page:b,searchText:d.searchText,typesFilter:d.types,actionTypesFilter:d.actionTypes,ruleExecutionStatusesFilter:d.ruleExecutionStatuses,ruleLastRunOutcomesFilter:d.ruleLastRunOutcomes,ruleParamsFilter:d.ruleParams,ruleStatusesFilter:d.ruleStatuses,tagsFilter:d.tags,kueryNode:d.kueryNode,sort:j,filterConsumers:a,hasReference:O}),onSuccess:e=>{var t;(null==e||null===(t=e.data)||void 0===t||!t.length)&&b.index>0&&p({...b,index:0})},onError:()=>{x.addDanger(i.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadRulesMessage",{defaultMessage:"Unable to load rules"}))},enabled:g,keepPreviousData:!0,cacheTime:0,refetchOnWindowFocus:!1}),k=Boolean(S&&S.data.length>0);return{rulesState:{isLoading:g&&(h||v),data:null!==(t=null==S?void 0:S.data)&&void 0!==t?t:[],totalItemCount:null!==(s=null==S?void 0:S.total)&&void 0!==s?s:0,initialLoad:h||T},lastUpdate:l()(E).format(),hasData:k,loadRules:y}}},308:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(309);case"v8light":return s(311)}},309:function(e,t,s){var a=s(54),l=s(310);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},310:function(e,t,s){(t=s(55)(!1)).push([e.i,".actBulkActionPopover__deleteAll .euiButtonEmpty__text{padding-top:4px}",""]),e.exports=t},311:function(e,t,s){var a=s(54),l=s(312);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},312:function(e,t,s){(t=s(55)(!1)).push([e.i,".actBulkActionPopover__deleteAll .euiButtonEmpty__text{padding-top:4px}",""]),e.exports=t},313:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(314);case"v8light":return s(316)}},314:function(e,t,s){var a=s(54),l=s(315);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},315:function(e,t,s){(t=s(55)(!1)).push([e.i,".collapsedItemActions__deleteButton{color:#f86b63}",""]),e.exports=t},316:function(e,t,s){var a=s(54),l=s(317);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},317:function(e,t,s){(t=s(55)(!1)).push([e.i,".collapsedItemActions__deleteButton{color:#bd271e}",""]),e.exports=t},318:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(94),l=s(1),i=a.__importDefault(s(319));t.default=function(e,t){void 0===t&&(t=[]);var s=i.default(e,t,{loading:!0}),a=s[0],n=s[1];return l.useEffect((function(){n()}),[n]),a}},319:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(94),l=s(1),i=a.__importDefault(s(320));t.default=function(e,t,s){void 0===t&&(t=[]),void 0===s&&(s={loading:!1});var n=l.useRef(0),r=i.default(),o=l.useState(s),u=o[0],c=o[1],d=l.useCallback((function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var l=++n.current;return c((function(e){return a.__assign(a.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return r()&&l===n.current&&c({value:e,loading:!1}),e}),(function(e){return r()&&l===n.current&&c({error:e,loading:!1}),e}))}),t);return[u,d]}},320:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(1);t.default=function(){var e=a.useRef(!1),t=a.useCallback((function(){return e.current}),[]);return a.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},321:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(322);case"v8light":return s(324)}},322:function(e,t,s){var a=s(54),l=s(323);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},323:function(e,t,s){(t=s(55)(!1)).push([e.i,".actRulesList__tableRowDisabled{background-color:#25262e}.actRulesList__tableRowDisabled .actRulesList__tableCellDisabled{color:#98a2b3}.euiTableRow:focus-within .ruleSidebarItem__action,.euiTableRow:hover .ruleSidebarItem__action,.euiTableRow[class*=-isActive] .ruleSidebarItem__action{opacity:1}.ruleSidebarItem__action{opacity:0}.ruleSidebarItem__action.ruleSidebarItem__mobile,.ruleSidebarItem__action:focus{opacity:1}.ruleDurationWarningIcon{margin-bottom:4px;margin-left:8px}.ruleDisabledQuestionIcon{bottom:4px;margin-left:4px;position:relative}",""]),e.exports=t},324:function(e,t,s){var a=s(54),l=s(325);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},325:function(e,t,s){(t=s(55)(!1)).push([e.i,".actRulesList__tableRowDisabled{background-color:#f5f7fa}.actRulesList__tableRowDisabled .actRulesList__tableCellDisabled{color:#69707d}.euiTableRow:focus-within .ruleSidebarItem__action,.euiTableRow:hover .ruleSidebarItem__action,.euiTableRow[class*=-isActive] .ruleSidebarItem__action{opacity:1}.ruleSidebarItem__action{opacity:0}.ruleSidebarItem__action.ruleSidebarItem__mobile,.ruleSidebarItem__action:focus{opacity:1}.ruleDurationWarningIcon{margin-bottom:4px;margin-left:8px}.ruleDisabledQuestionIcon{bottom:4px;margin-left:4px;position:relative}",""]),e.exports=t},326:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(1),l=s(181),i=function(){};t.default=function(e,t,s){if(!l.isClient)return[t,i,i];if(!e)throw new Error("useLocalStorage key may not be falsy");var n=s?s.raw?function(e){return e}:s.deserializer:JSON.parse,r=a.useState((function(){try{var a=s?s.raw?String:s.serializer:JSON.stringify,l=localStorage.getItem(e);return null!==l?n(l):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),o=r[0],u=r[1],c=a.useCallback((function(t){try{var a="function"==typeof t?t(o):t;if(void 0===a)return;var l;l=s?s.raw?"string"==typeof a?a:JSON.stringify(a):s.serializer?s.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,l),u(n(l))}catch(e){}}),[e,u]),d=a.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[o,c,d]}}}]);