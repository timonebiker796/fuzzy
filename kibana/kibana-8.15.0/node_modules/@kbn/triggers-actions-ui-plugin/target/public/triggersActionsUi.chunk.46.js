/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[46],{168:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return i}));var r=n(128);const a=[],u="searchBarParams",i=Object.values(r.a).filter((e=>e!==r.a.SIEM))},180:function(e,t,n){"use strict";function r(e){return e}function a(e){throw new Error("Called `absurd` function which should be uncallable")}Object.defineProperty(t,"__esModule",{value:!0}),t.bindTo_=t.bind_=t.hole=t.pipe=t.untupled=t.tupled=t.absurd=t.decrement=t.increment=t.tuple=t.flow=t.flip=t.constVoid=t.constUndefined=t.constNull=t.constFalse=t.constTrue=t.constant=t.not=t.unsafeCoerce=t.identity=void 0,t.identity=r,t.unsafeCoerce=r,t.not=function(e){return function(t){return!e(t)}},t.constant=function(e){return function(){return e}},t.constTrue=function(){return!0},t.constFalse=function(){return!1},t.constNull=function(){return null},t.constUndefined=function(){},t.constVoid=function(){},t.flip=function(e){return function(t,n){return e(n,t)}},t.flow=function(e,t,n,r,a,u,i,s,l){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return a(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return u(a(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return i(u(a(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return s(i(u(a(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return l(s(i(u(a(r(n(t(e.apply(this,arguments)))))))))}}},t.tuple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},t.increment=function(e){return e+1},t.decrement=function(e){return e-1},t.absurd=a,t.tupled=function(e){return function(t){return e.apply(void 0,t)}},t.untupled=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(t)}},t.pipe=function(e,t,n,r,a,u,i,s,l,o,c,d,f,p,g,y,h,b,v,w){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return a(r(n(t(e))));case 6:return u(a(r(n(t(e)))));case 7:return i(u(a(r(n(t(e))))));case 8:return s(i(u(a(r(n(t(e)))))));case 9:return l(s(i(u(a(r(n(t(e))))))));case 10:return o(l(s(i(u(a(r(n(t(e)))))))));case 11:return c(o(l(s(i(u(a(r(n(t(e))))))))));case 12:return d(c(o(l(s(i(u(a(r(n(t(e)))))))))));case 13:return f(d(c(o(l(s(i(u(a(r(n(t(e))))))))))));case 14:return p(f(d(c(o(l(s(i(u(a(r(n(t(e)))))))))))));case 15:return g(p(f(d(c(o(l(s(i(u(a(r(n(t(e))))))))))))));case 16:return y(g(p(f(d(c(o(l(s(i(u(a(r(n(t(e)))))))))))))));case 17:return h(y(g(p(f(d(c(o(l(s(i(u(a(r(n(t(e))))))))))))))));case 18:return b(h(y(g(p(f(d(c(o(l(s(i(u(a(r(n(t(e)))))))))))))))));case 19:return v(b(h(y(g(p(f(d(c(o(l(s(i(u(a(r(n(t(e))))))))))))))))));case 20:return w(v(b(h(y(g(p(f(d(c(o(l(s(i(u(a(r(n(t(e)))))))))))))))))))}},t.hole=a,t.bind_=function(e,t,n){var r;return Object.assign({},e,((r={})[t]=n,r))},t.bindTo_=function(e){return function(t){var n;return(n={})[e]=t,n}}},205:function(e,t,n){"use strict";n.r(t),n.d(t,"AlertsSearchBar",(function(){return w})),n.d(t,"default",(function(){return w}));var r=n(12),a=n.n(r),u=n(1),i=n(31),s=n(95),l=n(128);const o=e=>"items"in e;var c=n(168),d=n(2);const f=d.i18n.translate("xpack.triggersActionsUI.alertsSearchBar.placeholder",{defaultMessage:"Search alerts (e.g. kibana.alert.evaluation.threshold > 75)"});var p=n(4),g=n(157);const y=[];var h=n(57),b=n(0);const v={type:"alerts",fields:{}};function w({appName:e,disableQueryLanguageSwitcher:t=!1,featureIds:n,ruleTypeId:r,query:w,filters:m,quickFilters:j=[],onQueryChange:O,onQuerySubmit:I,onFiltersUpdated:q,rangeFrom:F,rangeTo:S,showFilterBar:M=!1,showDatePicker:k=!0,showSubmitButton:_=!0,placeholder:A=f,submitOnBlur:T=!1,filtersForSuggestions:E,...Q}){var R;const{unifiedSearch:{ui:{SearchBar:B}}}=Object(i.useKibana)().services,[C,U]=Object(u.useState)("kuery"),{dataViews:V,loading:x}=function(e){const{http:t,data:n,notifications:{toasts:r}}=Object(i.useKibana)().services,[a,s]=Object(u.useState)(void 0),o=e.sort().join(","),c=1===e.length&&e.includes(l.a.SIEM),f=e.length>1&&e.includes(l.a.SIEM),y=e.length>0&&!c&&!f,h=()=>{r.addDanger(d.i18n.translate("xpack.triggersActionsUI.useAlertDataView.useAlertDataMessage",{defaultMessage:"Unable to load alert data view"}))},{data:b,isSuccess:v,isInitialLoading:w,isLoading:m}=Object(p.useQuery)({queryKey:["loadAlertIndexNames",o],queryFn:()=>async function({http:e,features:t}){const{index_name:n=[]}=await e.get(`${g.a}/index`,{query:{features:t}});return n}({http:t,features:o}),onError:h,refetchOnWindowFocus:!1,enabled:e.length>0&&!f}),{data:j,isSuccess:O,isInitialLoading:I,isLoading:q}=Object(p.useQuery)({queryKey:["loadAlertFields",o],queryFn:()=>async function({http:e,featureIds:t}){const{fields:n=[]}=await e.get(`${g.a}/browser_fields`,{query:{featureIds:t}});return n}({http:t,featureIds:e}),onError:h,refetchOnWindowFocus:!1,enabled:y});return Object(u.useEffect)((()=>()=>{null==a||a.map((e=>{n.dataViews.clearInstanceCache(e.id)}))}),[a]),Object(u.useEffect)((()=>{c&&v&&async function(){const e=await n.dataViews.create({title:(null!=b?b:[]).join(","),allowNoIndex:!0});s([e])}()}),[n.dataViews,b,v,c]),Object(u.useEffect)((()=>{var e;b&&j&&!c&&O&&v&&s([{title:(null!=b?b:[]).join(","),fieldFormatMap:{},fields:null===(e=null!=j?j:[])||void 0===e?void 0:e.map((e=>({...e,...e.esTypes&&e.esTypes.includes("flattened")?{type:"string"}:{}})))}])}),[j,n.dataViews,b,v,c,O]),Object(u.useMemo)((()=>({dataViews:a,loading:0!==e.length&&!f&&(c?w||m:w||m||I||q)})),[a,e.length,f,c,w,m,I,q])}(null!=n?n:[]),{aadFields:L,loading:D}=function(e){const{http:t,notifications:{toasts:n}}=Object(i.useKibana)().services,{data:r=y,isInitialLoading:a,isLoading:s}=Object(p.useQuery)({queryKey:["loadAlertAadFieldsPerRuleType",e],queryFn:()=>async function({http:e,ruleTypeId:t}){return t?await e.get(`${g.a}/aad_fields`,{query:{ruleTypeId:t}}):y}({http:t,ruleTypeId:e}),onError:()=>{n.addDanger(d.i18n.translate("xpack.triggersActionsUI.useRuleAADFields.errorMessage",{defaultMessage:"Unable to load alert fields per rule type"}))},refetchOnWindowFocus:!1,enabled:void 0!==e});return Object(u.useMemo)((()=>({aadFields:r,loading:void 0!==e&&(a||s)})),[r,a,s,e])}(r),P=r&&null!=L&&L.length?[{title:r,fields:L}]:V,K=Object(h.a)({filteredRuleTypes:void 0!==r?[r]:[],enabled:void 0!==r}),N=n&&1===n.length&&n.includes(l.a.SIEM)||K&&r&&(null===(R=K.ruleTypesState.data.get(r))||void 0===R?void 0:R.producer)===l.a.SIEM,$=Object(u.useCallback)((({dateRange:e,query:t},n)=>{var r;I({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0},n),U(null!==(r=null==t?void 0:t.language)&&void 0!==r?r:"kuery")}),[I,U]),W=Object(u.useCallback)((({dateRange:e,query:t})=>{var n;null==O||O({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0}),U(null!==(n=null==t?void 0:t.language)&&void 0!==n?n:"kuery")}),[O,U]),z=Object(u.useMemo)((()=>{if(M&&j.length>0){const e=[],t=n=>{if(o(n)){var r;const a=`quick-filters-panel-${e.length}`;return e.push({id:a,title:n.title,items:n.items.map(t),"data-test-subj":a}),{name:n.title,icon:null!==(r=n.icon)&&void 0!==r?r:"filterInCircle",panel:a,"data-test-subj":`quick-filters-item-${n.title}`}}{var a;const{filter:e,...t}=n;return{...t,icon:null!==(a=n.icon)&&void 0!==a?a:"filterInCircle",onClick:()=>{null!=m&&m.some((t=>Object(s.compareFilters)(t,e)))||null==q||q([...null!=m?m:[],e])},"data-test-subj":`quick-filters-item-${n.name}`}}};return{items:j.map(t),panels:e}}return{items:[],panels:[]}}),[m,q,j,M]);return Object(b.jsx)(B,a()({appName:e,disableQueryLanguageSwitcher:t,indexPatterns:x||D?c.c:P,placeholder:A,query:{query:null!=w?w:"",language:C},filters:m,additionalQueryBarMenuItems:z,dateRangeFrom:F,dateRangeTo:S,displayStyle:"inPage",showFilterBar:M,onQuerySubmit:$,onFiltersUpdated:q,onRefresh:({dateRange:e})=>{I({dateRange:e})},showDatePicker:k,showQueryInput:!0,saveQueryMenuVisibility:"allowed_by_app_privilege",showSubmitButton:_,submitOnBlur:T,onQueryChange:W,suggestionsAbstraction:N?void 0:v,filtersForSuggestions:E},Q))}}}]);