/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[10],{205:function(e,t,a){"use strict";a.r(t),a.d(t,"OsqueryActionResults",(function(){return x})),a.d(t,"default",(function(){return q}));var s=a(2),n=a(0),u=a.n(n),r=a(11),l=a(28),i=a(4),c=a(23),o=a(24),d=a(15),g=a(74),f=a(67),j=a(77),p=a(22),v=a(1);const b=u.a.memo((({actionId:e,ruleName:t,startDate:a,ecsData:u})=>{const[r,l]=Object(n.useState)(!1),{data:i}=Object(g.a)({actionId:e,isLive:r});return Object(n.useLayoutEffect)((()=>{l((()=>!("completed"===(null==i?void 0:i.status))))}),[null==i?void 0:i.status]),Object(v.jsx)(p.a.Provider,{value:u},Object(v.jsx)(s.EuiSpacer,{size:"s"}),Object(v.jsx)(s.EuiComment,{username:t,timestamp:Object(v.jsx)(d.FormattedRelative,{value:a}),event:f.e,"data-test-subj":"osquery-results-comment"},Object(v.jsx)(j.a,{actionId:e,data:null==i?void 0:i.queries,startDate:null==i?void 0:i["@timestamp"],expirationDate:null==i?void 0:i.expiration,agentIds:null==i?void 0:i.agents})),Object(v.jsx)(s.EuiSpacer,{size:"s"}))})),m=({ruleName:e,actionItems:t,ecsData:a})=>{const{read:n}=Object(i.e)().services.application.capabilities.osquery;return n?Object(v.jsx)("div",{"data-test-subj":"osquery-results"},null==t?void 0:t.map((t=>{var s,n,u,r,l;const i=null===(s=t.fields)||void 0===s||null===(n=s.action_id)||void 0===n?void 0:n[0],c=null===(u=t.fields)||void 0===u||null===(r=u["queries.action_id"])||void 0===r?void 0:r[0],o=null===(l=t.fields)||void 0===l?void 0:l["@timestamp"][0];return Object(v.jsx)(b,{key:i,actionId:i,queryId:c,startDate:o,ruleName:e,ecsData:a})})),Object(v.jsx)(s.EuiSpacer,{size:"s"})):Object(v.jsx)(l.a,null)},x=u.a.memo(m),y=({services:e,...t})=>Object(v.jsx)(o.d,e,Object(v.jsx)(i.b,{services:e},Object(v.jsx)(r.QueryClientProvider,{client:c.a},Object(v.jsx)(x,t)))),q=u.a.memo(y)},67:function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"d",(function(){return u})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return i})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return o})),a.d(t,"e",(function(){return d}));var s=a(7);const n=e=>0===e?"":1===e?s.i18n.translate("xpack.osquery.agents.oneSelectedAgentText",{defaultMessage:"{numAgents} agent selected.",values:{numAgents:e}}):s.i18n.translate("xpack.osquery.agents.mulitpleSelectedAgentsText",{defaultMessage:"{numAgents} agents selected.",values:{numAgents:e}}),u=s.i18n.translate("xpack.osquery.agents.allAgentsLabel",{defaultMessage:"All agents"}),r=s.i18n.translate("xpack.osquery.agents.platformLabel",{defaultMessage:"Platform"}),l=s.i18n.translate("xpack.osquery.agents.policyLabel",{defaultMessage:"Policy"}),i=(s.i18n.translate("xpack.osquery.agents.agent",{defaultMessage:"Agent"}),s.i18n.translate("xpack.osquery.agents.selectionLabel",{defaultMessage:"Agents"})),c=s.i18n.translate("xpack.osquery.agents.noAgentAvailableTitle",{defaultMessage:"No agents available"}),o=(s.i18n.translate("xpack.osquery.agents.query",{defaultMessage:"Query"}),s.i18n.translate("xpack.osquery.agents.selectAgentLabel",{defaultMessage:"Select agents or groups to query"})),d=(s.i18n.translate("xpack.osquery.agents.errorSearchDescription",{defaultMessage:"An error has occurred on all agents search"}),s.i18n.translate("xpack.osquery.agents.failSearchDescription",{defaultMessage:"Failed to fetch agents"}),s.i18n.translate("xpack.osquery.agent.attachedQuery",{defaultMessage:"attached query"}))}}]);