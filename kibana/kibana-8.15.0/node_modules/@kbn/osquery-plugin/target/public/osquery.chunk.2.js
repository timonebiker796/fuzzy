/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[2],{105:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(84),i=r.n(n),o=r(2),a=r(0),s=r(7),l=r(17),u=r(1);const c=i()(o.EuiCard,{target:"e1estmxd0"})("padding:0;display:flex;flex-direction:row;border:",(({theme:e,selectable:t})=>{if(null!=t&&t.isSelected)return`${e.euiTheme.border.width.thin} solid ${e.euiTheme.colors.success}`}),";.euiCard__content{padding:16px 92px 16px 16px!important;}.euiTitle{font-size:1rem;}.euiText{margin-top:0;color:",(({theme:e})=>e.euiTheme.colors.subduedText),";}>button[role='switch']{min-inline-size:80px;height:100%!important;width:80px;border-radius:0 5px 5px 0;>span{>svg{width:18px;height:18px;display:inline-block!important;}>:not(svg){display:none;}}}"),d=({canRunSingleQuery:e,canRunPacks:t})=>{const{field:{value:r,onChange:n}}=Object(l.useController)({name:"queryType",defaultValue:"query",rules:{deps:["packId","query"]}}),i=Object(a.useCallback)((e=>{n(e)}),[n]),d=Object(a.useMemo)((()=>({onClick:()=>i("query"),isSelected:"query"===r,iconType:"check",textProps:{}})),[r,i]),p=Object(a.useMemo)((()=>({onClick:()=>i("pack"),isSelected:"pack"===r,iconType:"check",textProps:{}})),[r,i]);return Object(u.jsx)(o.EuiFlexItem,null,Object(u.jsx)(o.EuiFormRow,{label:"Query type",fullWidth:!0},Object(u.jsx)(o.EuiFlexGroup,{gutterSize:"m"},Object(u.jsx)(o.EuiFlexItem,null,Object(u.jsx)(c,{layout:"horizontal",title:s.i18n.translate("xpack.osquery.liveQuery.queryForm.singleQueryTypeLabel",{defaultMessage:"Single query"}),titleSize:"xs",hasBorder:!0,description:s.i18n.translate("xpack.osquery.liveQuery.queryForm.singleQueryTypeDescription",{defaultMessage:"Run a saved query or new one."}),selectable:d,isDisabled:!e})),Object(u.jsx)(o.EuiFlexItem,null,Object(u.jsx)(c,{layout:"horizontal",title:s.i18n.translate("xpack.osquery.liveQuery.queryForm.packQueryTypeLabel",{defaultMessage:"Pack"}),titleSize:"xs",hasBorder:!0,description:s.i18n.translate("xpack.osquery.liveQuery.queryForm.packQueryTypeDescription",{defaultMessage:"Run a set of queries in a pack."}),selectable:p,isDisabled:!t})))))}},106:function(e,t,r){"use strict";e.exports=r(141)},130:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(2),i=r(0),o=r.n(i),a=r(16),s=r(17),l=r(77),u=r(72),c=r(8),d=r.n(c),p=r(7),f=r(1);const m=({queryType:e,fieldProps:t={},idAria:r,...o})=>{var l;const{field:{value:u,onChange:c},fieldState:m}=Object(s.useController)({name:"packId",rules:{required:{message:p.i18n.translate("xpack.osquery.pack.queryFlyoutForm.osqueryPackMissingErrorMessage",{defaultMessage:"Pack is a required field"}),value:"pack"===e}},defaultValue:[]}),y=null===(l=m.error)||void 0===l?void 0:l.message,[g,v]=Object(i.useState)([]),h=Object(i.useCallback)((e=>{var t;if(!e.length)return v(e),void c([]);v(e),c([null===(t=e[0].value)||void 0===t?void 0:t.id])}),[c]),b=Object(i.useMemo)((()=>{var e,r;return null!==(e=null==t||null===(r=t.packsData)||void 0===r?void 0:r.map((e=>{var t;return{label:null!==(t=e.name)&&void 0!==t?t:"",value:{id:e.saved_object_id,name:e.name,description:e.description}}})))&&void 0!==e?e:[]}),[null==t?void 0:t.packsData]),x=Object(i.useCallback)((({value:e})=>Object(f.jsx)(n.EuiFlexGroup,{gutterSize:"none",direction:"column",alignItems:"flexStart",justifyContent:"flexStart"},Object(f.jsx)(n.EuiFlexItem,null,Object(f.jsx)("strong",null,null==e?void 0:e.name)),Object(f.jsx)(n.EuiFlexItem,null,Object(f.jsx)("div",{className:"eui-textTruncate"},Object(f.jsx)(n.EuiTextColor,{color:"subdued"},null==e?void 0:e.description))))),[]);return Object(i.useEffect)((()=>{if(null!=u&&u.length){const e=Object(a.find)(b,["value.id",u[0]]);e&&v([e])}}),[u,b]),Object(f.jsx)(n.EuiFormRow,d()({label:p.i18n.translate("xpack.osquery.liveQuery.queryForm.packQueryTypeLabel",{defaultMessage:"Pack"}),error:y,isInvalid:!!y,fullWidth:!0,describedByIds:r?[r]:void 0},o),Object(f.jsx)(n.EuiComboBox,d()({placeholder:p.i18n.translate("xpack.osquery.packs.dropdown.searchFieldPlaceholder",{defaultMessage:"Search for a pack to run"}),selectedOptions:g,onChange:h,"data-test-subj":"select-live-pack",fullWidth:!0,singleSelection:{asPlainText:!0},renderOption:x,options:b,rowHeight:60},t)))},y=({liveQueryDetails:e,submitButtonContent:t,showResultsHeader:r})=>{var c,d,p;const{data:y}=Object(u.a)({}),{packId:g}=Object(s.useWatch)(),v=Object(i.useMemo)((()=>null!=g&&g.length?Object(a.find)(null==y?void 0:y.data,{saved_object_id:g[0]}):null),[g,y]),h=Object(i.useMemo)((()=>null==e?void 0:e.action_id),[null==e?void 0:e.action_id]),b=Object(i.useMemo)((()=>null==e?void 0:e.agents),[null==e?void 0:e.agents]);return Object(f.jsx)(o.a.Fragment,null,Object(f.jsx)(n.EuiFlexItem,null,Object(f.jsx)(m,{fieldProps:{packsData:null==y?void 0:y.data},queryType:"pack"})),t,Object(f.jsx)(n.EuiSpacer,null),null!=e&&null!==(c=e.queries)&&void 0!==c&&c.length||null!=v&&null!==(d=v.queries)&&void 0!==d&&d.length?Object(f.jsx)(n.EuiFlexItem,null,Object(f.jsx)(l.a,{actionId:h,agentIds:b,data:null!==(p=null==e?void 0:e.queries)&&void 0!==p?p:null==v?void 0:v.queries,showResultsHeader:r})):null)}},138:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),i=r(0),o=r(139),a=r(1),s=r(85),l=r(86),u=r(148);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var p=d(i),f=c(o).default,m=function(e){return"theme"!==e},y=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?f:m},g=function(e,t,r){var n;if(t){var i=t.shouldForwardProp;n=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof n&&r&&(n=e.__emotion_forwardProp),n},v="undefined"!=typeof document,h=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;s.registerStyles(t,r,n);var i=u.useInsertionEffectAlwaysWithSyncFallback((function(){return s.insertStyles(t,r,n)}));if(!v&&void 0!==i){for(var o,a=r.name,l=r.next;void 0!==l;)a+=" "+l.name,l=l.next;return p.createElement("style",((o={})["data-emotion"]=t.key+" "+a,o.dangerouslySetInnerHTML={__html:i},o.nonce=t.sheet.nonce,o))}return null};t.default=function e(t,r){var i,o,u=t.__emotion_real===t,c=u&&t.__emotion_base||t;void 0!==r&&(i=r.label,o=r.target);var d=g(t,r,u),f=d||y(c),m=!f("as");return function(){var v=arguments,b=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&b.push("label:"+i+";"),null==v[0]||void 0===v[0].raw)b.push.apply(b,v);else{b.push(v[0][0]);for(var x=v.length,k=1;k<x;k++)b.push(v[k],v[0][k])}var j=a.withEmotionCache((function(e,t,r){var n=m&&e.as||c,i="",u=[],g=e;if(null==e.theme){for(var v in g={},e)g[v]=e[v];g.theme=p.useContext(a.ThemeContext)}"string"==typeof e.className?i=s.getRegisteredStyles(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var x=l.serializeStyles(b.concat(u),t.registered,g);i+=t.key+"-"+x.name,void 0!==o&&(i+=" "+o);var k=m&&void 0===d?y(n):f,j={};for(var O in e)m&&"as"===O||k(O)&&(j[O]=e[O]);return j.className=i,j.ref=r,p.createElement(p.Fragment,null,p.createElement(h,{cache:t,serialized:x,isStringTag:"string"==typeof n}),p.createElement(n,j))}));return j.displayName=void 0!==i?i:"Styled("+("string"==typeof c?c:c.displayName||c.name||"Component")+")",j.defaultProps=t.defaultProps,j.__emotion_real=j,j.__emotion_base=c,j.__emotion_styles=b,j.__emotion_forwardProp=d,Object.defineProperty(j,"toString",{value:function(){return"."+o}}),j.withComponent=function(t,i){return e(t,n({},r,i,{shouldForwardProp:g(j,i,!0)})).apply(void 0,b)},j}}},139:function(e,t,r){"use strict";e.exports=r(140)},140:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(106);function i(e){return e&&e.__esModule?e:{default:e}}var o=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,a=i(n).default((function(e){return o.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=a},141:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}},142:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof document,i=function(e,t,r){var i=e.key+"-"+t.name;(!1===r||!1===n&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,r){var n="";return r.split(" ").forEach((function(r){void 0!==e[r]?t.push(e[r]+";"):n+=r+" "})),n},t.insertStyles=function(e,t,r){i(e,t,r);var o=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a="",s=t;do{var l=e.insert(t===s?"."+o:"",s,e.sheet,!0);n||void 0===l||(a+=l),s=s.next}while(void 0!==s);if(!n&&0!==a.length)return a}},t.registerStyles=i},143:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(144),i=r(146),o=r(106);function a(e){return e&&e.__esModule?e:{default:e}}var s=a(n),l=a(i),u=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},f=a(o).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),m=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,r){return g={name:t,styles:r,next:g},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function y(e,t,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return g={name:r.name,styles:r.styles,next:g},r.name;if(void 0!==r.styles){var n=r.next;if(void 0!==n)for(;void 0!==n;)g={name:n.name,styles:n.styles,next:g},n=n.next;return r.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=y(e,t,r[i])+";";else for(var o in r){var a=r[o];if("object"!=typeof a)null!=t&&void 0!==t[a]?n+=o+"{"+t[a]+"}":p(a)&&(n+=f(o)+":"+m(o,a)+";");else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=t&&void 0!==t[a[0]]){var s=y(e,t,a);switch(o){case"animation":case"animationName":n+=f(o)+":"+s+";";break;default:n+=o+"{"+s+"}"}}else for(var l=0;l<a.length;l++)p(a[l])&&(n+=f(o)+":"+m(o,a[l])+";")}return n}(e,t,r);case"function":if(void 0!==e){var i=g,o=r(e);return g=i,y(e,t,o)}}if(null==t)return r;var a=t[r];return void 0!==a?a:r}var g,v=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,i="";g=void 0;var o=e[0];null==o||void 0===o.raw?(n=!1,i+=y(r,t,o)):i+=o[0];for(var a=1;a<e.length;a++)i+=y(r,t,e[a]),n&&(i+=o[a]);v.lastIndex=0;for(var l,u="";null!==(l=v.exec(i));)u+="-"+l[1];return{name:s.default(i)+u,styles:i,next:g}}},144:function(e,t,r){"use strict";e.exports=r(145)},145:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,r=0,n=0,i=e.length;i>=4;++n,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(i){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}},146:function(e,t,r){"use strict";e.exports=r(147)},147:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},148:function(e,t,r){"use strict";e.exports=r(149)},149:function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(0)),o="undefined"!=typeof document,a=!!i.useInsertionEffect&&i.useInsertionEffect,s=o&&a||function(e){return e()},l=a||i.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=s,t.useInsertionEffectWithLayoutFallback=l},64:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n="packList"},72:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(11),i=r(5),o=r(4),a=r(64);const s=({isLive:e=!1,pageIndex:t=0,pageSize:r=100,sortField:s="updated_at",sortOrder:l="desc"})=>{const{http:u}=Object(o.e)().services;return Object(n.useQuery)([a.a,{pageIndex:t,pageSize:r,sortField:s,sortOrder:l}],(()=>u.get("/api/osquery/packs",{version:i.a.public.v1,query:{pageIndex:t,pageSize:r,sortField:s,sortOrder:l}})),{keepPreviousData:!0,refetchInterval:!!e&&1e4})}},84:function(e,t,r){"use strict";e.exports=r(138)},85:function(e,t,r){"use strict";e.exports=r(142)},86:function(e,t,r){"use strict";e.exports=r(143)}}]);