/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[11],{199:function(e,u,c){"use strict";c.r(u),c.d(u,"default",(function(){return v}));var r=c(0),s=c.n(r),t=c(2),a=c(17),n=c(16),i=c(82),o=c(105),p=c(4),d=c(120),l=c(130),j=c(1);const b=({defaultValues:e,onError:u,onChange:c})=>{const b=Object(a.useForm)({mode:"all",defaultValues:e?{...Object(n.omit)(e,["ecsMapping","packId"]),ecs_mapping:e.ecsMapping,packId:e.packId?[e.packId]:[],queryType:e.packId?"pack":"query"}:{ecs_mapping:{},queryType:"query"}}),{watch:v,register:y,formState:k,control:O}=b,[f,q,m]=v(["packId","queryType","queries"]),{data:I}=Object(i.a)({packId:null==f?void 0:f[0],skip:!(null!=f&&f[0])}),{replace:g}=Object(a.useFieldArray)({name:"queries",control:O});Object(r.useEffect)((()=>{if(null!=I&&I.queries){const e=Object(n.map)(null==I?void 0:I.queries,((e,u)=>({...e,id:u})));g(e)}}),[I,g]),Object(r.useEffect)((()=>{u(k.errors)}),[u,k]),Object(r.useEffect)((()=>{y("savedQueryId")}),[y]),Object(r.useEffect)((()=>{const e=v((e=>{var u;c("pack"===e.queryType?{packId:null!=e&&null!==(u=e.packId)&&void 0!==u&&u.length?null==e?void 0:e.packId[0]:void 0,queries:e.queries}:{savedQueryId:e.savedQueryId,query:e.query,timeout:e.timeout,ecsMapping:e.ecs_mapping})}));return()=>e.unsubscribe()}),[c,I,v]);const Q=Object(p.e)().services.application.capabilities.osquery,w=Object(r.useMemo)((()=>!(!Q.runSavedQueries&&!Q.writeLiveQueries||!Q.readPacks)),[Q]),_=Object(r.useMemo)((()=>!!(Q.writeLiveQueries||Q.runSavedQueries&&Q.readSavedQueries)),[Q]),x=Object(r.useMemo)((()=>({queries:m,agents:[]})),[m]);return Object(j.jsx)(s.a.Fragment,null,Object(j.jsx)(a.FormProvider,b,Object(j.jsx)(o.a,{canRunPacks:w,canRunSingleQuery:_}),Object(j.jsx)(t.EuiSpacer,{size:"m"}),"query"===q&&Object(j.jsx)(d.default,null),"pack"===q&&Object(j.jsx)(l.a,{liveQueryDetails:m&&!I?x:void 0})))},v=s.a.memo(b)},82:function(e,u,c){"use strict";c.d(u,"a",(function(){return a}));var r=c(11),s=c(5),t=c(4);const a=({packId:e,skip:u=!1})=>{const{http:c}=Object(t.e)().services;return Object(r.useQuery)(["pack",{packId:e}],(()=>c.get(`/api/osquery/packs/${e}`,{version:s.a.public.v1})),{select:e=>null==e?void 0:e.data,keepPreviousData:!0,enabled:!(u||!e)})}}}]);