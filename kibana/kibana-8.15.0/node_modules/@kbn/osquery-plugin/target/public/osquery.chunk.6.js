/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[6],{122:function(e,t,a){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},123:function(e,t,a){e.exports=a.p+"1cbd62546f764080f7071e03889e9de3.svg"},134:function(e,t,a){"use strict";const s=a(135),i=a(136),l=a(137);function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function o(e,t){return t.encode?t.strict?s(e):encodeURIComponent(e):e}function r(e,t){return t.decode?i(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function c(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=c(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function b(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function j(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const a=function(e){let t;switch(e.arrayFormat){case"index":return(e,a,s)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===s[e]&&(s[e]={}),s[e][t[1]]=a):s[e]=a};case"bracket":return(e,a,s)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==s[e]?s[e]=[].concat(s[e],a):s[e]=[a]:s[e]=a};case"comma":case"separator":return(t,a,s)=>{const i="string"==typeof a&&a.split("").indexOf(e.arrayFormatSeparator)>-1?a.split(e.arrayFormatSeparator).map((t=>r(t,e))):null===a?a:r(a,e);s[t]=i};default:return(e,t,a)=>{void 0!==a[e]?a[e]=[].concat(a[e],t):a[e]=t}}}(t),s=Object.create(null);if("string"!=typeof e)return s;if(!(e=e.trim().replace(/^[?#&]/,"")))return s;for(const i of e.split("&")){let[e,n]=l(t.decode?i.replace(/\+/g," "):i,"=");n=void 0===n?null:["comma","separator"].includes(t.arrayFormat)?n:r(n,t),a(r(e,t),n,s)}for(const e of Object.keys(s)){const a=s[e];if("object"==typeof a&&null!==a)for(const e of Object.keys(a))a[e]=b(a[e],t);else s[e]=b(a,t)}return!1===t.sort?s:(!0===t.sort?Object.keys(s).sort():Object.keys(s).sort(t.sort)).reduce(((e,t)=>{const a=s[t];return Boolean(a)&&"object"==typeof a&&!Array.isArray(a)?e[t]=u(a):e[t]=a,e}),Object.create(null))}t.extract=d,t.parse=j,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const a=a=>t.skipNull&&null==e[a]||t.skipEmptyString&&""===e[a],s=function(e){switch(e.arrayFormat){case"index":return t=>(a,s)=>{const i=a.length;return void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?a:null===s?[...a,[o(t,e),"[",i,"]"].join("")]:[...a,[o(t,e),"[",o(i,e),"]=",o(s,e)].join("")]};case"bracket":return t=>(a,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?a:null===s?[...a,[o(t,e),"[]"].join("")]:[...a,[o(t,e),"[]=",o(s,e)].join("")];case"comma":case"separator":return t=>(a,s)=>null==s||0===s.length?a:0===a.length?[[o(t,e),"=",o(s,e)].join("")]:[[a,o(s,e)].join(e.arrayFormatSeparator)];default:return t=>(a,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?a:null===s?[...a,o(t,e)]:[...a,[o(t,e),"=",o(s,e)].join("")]}}(t),i={};for(const t of Object.keys(e))a(t)||(i[t]=e[t]);const l=Object.keys(i);return!1!==t.sort&&l.sort(t.sort),l.map((a=>{const i=e[a];return void 0===i?"":null===i?o(a,t):Array.isArray(i)?i.reduce(s(a),[]).join("&"):o(a,t)+"="+o(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[a,s]=l(e,"#");return Object.assign({url:a.split("?")[0]||"",query:j(d(e),t)},t&&t.parseFragmentIdentifier&&s?{fragmentIdentifier:r(s,t)}:{})},t.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0},a);const s=c(e.url).split("?")[0]||"",i=t.extract(e.url),l=t.parse(i,{sort:!1}),n=Object.assign(l,e.query);let r=t.stringify(n,a);r&&(r=`?${r}`);let u=function(e){let t="";const a=e.indexOf("#");return-1!==a&&(t=e.slice(a)),t}(e.url);return e.fragmentIdentifier&&(u=`#${o(e.fragmentIdentifier,a)}`),`${s}${r}${u}`}},135:function(e,t,a){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},136:function(e,t,a){"use strict";var s="%[a-f0-9]{2}",i=new RegExp("("+s+")|([^%]+?)","gi"),l=new RegExp("("+s+")+","gi");function n(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var a=e.slice(0,t),s=e.slice(t);return Array.prototype.concat.call([],n(a),n(s))}function o(e){try{return decodeURIComponent(e)}catch(s){for(var t=e.match(i)||[],a=1;a<t.length;a++)t=(e=n(t,a).join("")).match(i)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},a=l.exec(e);a;){try{t[a[0]]=decodeURIComponent(a[0])}catch(e){var s=o(a[0]);s!==a[0]&&(t[a[0]]=s)}a=l.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),n=0;n<i.length;n++){var r=i[n];e=e.replace(new RegExp(r,"g"),t[r])}return e}(e)}}},137:function(e,t,a){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const a=e.indexOf(t);return-1===a?[e]:[e.slice(0,a),e.slice(a+t.length)]}},156:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(38),i=a(157),l=s.__importDefault(a(159));t.default=function(e,t){l.default(e,t,i.isDeepEqual)}},157:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var s=a(38).__importDefault(a(158));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=s.default},158:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var s,i,l;if(Array.isArray(t)){if((s=t.length)!=a.length)return!1;for(i=s;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((s=(l=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=s;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,l[i]))return!1;for(i=s;0!=i--;){var n=l[i];if(!("_owner"===n&&t.$$typeof||e(t[n],a[n])))return!1}return!0}return t!=t&&a!=a}},159:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(0);t.default=function(e,t,a){var i=s.useRef(void 0);i.current&&a(t,i.current)||(i.current=t),s.useEffect(e,i.current)}},160:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(161);case"v8light":return a(163)}},161:function(e,t,a){var s=a(68),i=a(162);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},162:function(e,t,a){var s=a(69),i=a(122),l=a(123);t=s(!1);var n=i(l);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px rgba(0,0,0,.175),0 1.9px 4px rgba(0,0,0,.125),0 4.5px 10px rgba(0,0,0,.125)}.kbnSolutionAvatar--xxl{background:#1d1e24 url("+n+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},163:function(e,t,a){var s=a(68),i=a(164);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},164:function(e,t,a){var s=a(69),i=a(122),l=a(123);t=s(!1);var n=i(l);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px #00000012,0 1.9px 4px #0000000d,0 4.5px 10px #0000000d}.kbnSolutionAvatar--xxl{background:#fff url("+n+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},165:function(e,t,a){e.exports=a.p+"baad30acfe492601d08a0e839c9bb3f5.svg"},166:function(e,t,a){"use strict";e.exports=a(167)},167:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(168);a(12),a(86),a(85);var i=s.default({key:"css"}),l=i.flush,n=i.hydrate,o=i.cx,r=i.merge,u=i.getRegisteredStyles,c=i.injectGlobal,d=i.keyframes,b=i.css,j=i.sheet,p=i.cache;t.cache=p,t.css=b,t.cx=o,t.flush=l,t.getRegisteredStyles=u,t.hydrate=n,t.injectGlobal=c,t.keyframes=d,t.merge=r,t.sheet=j},168:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(12),i=a(86),l=a(85);function n(e){return e&&e.__esModule?e:{default:e}}var o=n(s);function r(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,a){var s=[],i=l.getRegisteredStyles(e,s,a);return s.length<2?a:i+t(s)}var c=function e(t){for(var a="",s=0;s<t.length;s++){var i=t[s];if(null!=i){var l=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))l=e(i);else for(var n in l="",i)i[n]&&n&&(l&&(l+=" "),l+=n);break;default:l=i}l&&(a&&(a+=" "),a+=l)}}return a};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var a=function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var n=i.serializeStyles(a,t.registered,void 0);return l.insertStyles(t,n,!1),t.key+"-"+n.name};return{css:a,cx:function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return u(t.registered,a,c(s))},injectGlobal:function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var l=i.serializeStyles(a,t.registered);r(t,l)},keyframes:function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var l=i.serializeStyles(a,t.registered),n="animation-"+l.name;return r(t,{name:l.name,styles:"@keyframes "+n+"{"+l.styles+"}"}),n},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:l.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,a)}}},169:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(170);case"v8light":return a(172)}},170:function(e,t,a){var s=a(68),i=a(171);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},171:function(e,t,a){(t=a(69)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#141519}.kbnSolutionNav__flyout .kbnSolutionNav{flex:auto}.kbnSolutionNav{display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px)and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px)and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},172:function(e,t,a){var s=a(68),i=a(173);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},173:function(e,t,a){(t=a(69)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#fafbfd}.kbnSolutionNav__flyout .kbnSolutionNav{flex:auto}.kbnSolutionNav{display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px)and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px)and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},174:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(175);case"v8light":return a(177)}},175:function(e,t,a){var s=a(68),i=a(176);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},176:function(e,t,a){(t=a(69)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#1d1e24!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},177:function(e,t,a){var s=a(68),i=a(178);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},178:function(e,t,a){(t=a(69)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#fff!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},203:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return _s}));var s=a(0),i=a.n(s),l=a(54),n=a.n(l),o=a(19),r=a(53),u=a(1);const c=({children:e,...t})=>Object(u.jsx)(o.Router,t,Object(u.jsx)(r.CompatRouter,null,e));var d=a(11),b=a(55),j=a(2),p=a(6),m=a(27),x=a.n(m),O=a(47);const g=({euiTheme:e})=>({minHeight:`calc(100vh - ${2*parseFloat(e.size.xxxl)}px)`,background:e.colors.emptyShade,display:"flex",flexDirection:"column"}),f={display:"flex",flexDirection:"column",flex:1},v=({euiTheme:e})=>({background:e.colors.emptyShade,borderBottom:e.border.thin,padding:`${e.size.base} ${e.size.l} ${e.size.base} ${e.size.l}`,".euiTabs":{paddingLeft:"3px",marginLeft:"-3px"}});var y=a(16),k=a(8),h=a.n(k);const E={services:{}},S=Object(s.createContext)(E);var C=a(156),M=a.n(C);const q=({children:e,component:t,render:a,...l})=>{const n=Object(s.useMemo)((()=>{if(t)return e=>Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(T,null),Object(u.jsx)(t,e))}),[t]);if(n)return Object(u.jsx)(o.Route,h()({},l,{component:n}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(u.jsx)(o.Route,h()({},l,{render:e=>Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(T,null),t(e))}))}return Object(u.jsx)(o.Route,l,Object(u.jsx)(T,null),e)},T=()=>{const{executionContext:e}=Object(s.useContext)(S).services,t=Object(o.useRouteMatch)();return function(e,t){M()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null},F=({legacySwitch:e=!0,children:t})=>{const a=Object(o.useRouteMatch)();return e?Object(u.jsx)(o.Switch,null,t):Object(u.jsx)(r.Routes,null,s.Children.map(t,(e=>{if(i.a.isValidElement(e)&&e.type===q){var s;const l=Object(y.replace)(null==e?void 0:e.props.path,a.url+"/",""),n="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(u.jsx)(r.Route,{path:l,element:Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(T,null),(null==e||null===(s=e.props)||void 0===s?void 0:s.component)&&Object(u.jsx)(e.props.component,null)||n&&n()||t)})}return e})))};var w=a(7),_=a(5),I=a(62),N=a(4);const P={href:I.a.overview(),text:w.i18n.translate("xpack.osquery.breadcrumbs.appTitle",{defaultMessage:"Osquery"})},L={base:()=>[P],overview:()=>[P,{text:w.i18n.translate("xpack.osquery.breadcrumbs.overviewPageTitle",{defaultMessage:"Overview"})}],live_queries:()=>[P,{text:w.i18n.translate("xpack.osquery.breadcrumbs.liveQueriesPageTitle",{defaultMessage:"Live queries"})}],live_query_new:()=>[P,{href:I.a.live_queries(),text:w.i18n.translate("xpack.osquery.breadcrumbs.liveQueriesPageTitle",{defaultMessage:"Live queries"})},{text:w.i18n.translate("xpack.osquery.breadcrumbs.newLiveQueryPageTitle",{defaultMessage:"New"})}],live_query_details:({liveQueryId:e})=>[P,{href:I.a.live_queries(),text:w.i18n.translate("xpack.osquery.breadcrumbs.liveQueriesPageTitle",{defaultMessage:"Live queries"})},{text:e}],saved_queries:()=>[P,{text:w.i18n.translate("xpack.osquery.breadcrumbs.savedQueriesPageTitle",{defaultMessage:"Saved queries"})}],saved_query_new:()=>[P,{href:I.a.saved_queries(),text:w.i18n.translate("xpack.osquery.breadcrumbs.savedQueriesPageTitle",{defaultMessage:"Saved queries"})},{text:w.i18n.translate("xpack.osquery.breadcrumbs.newSavedQueryPageTitle",{defaultMessage:"New"})}],saved_query_edit:({savedQueryName:e})=>[P,{href:I.a.saved_queries(),text:w.i18n.translate("xpack.osquery.breadcrumbs.savedQueriesPageTitle",{defaultMessage:"Saved queries"})},{text:e}],packs:()=>[P,{text:w.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})}],pack_add:()=>[P,{href:I.a.packs(),text:w.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})},{text:w.i18n.translate("xpack.osquery.breadcrumbs.addpacksPageTitle",{defaultMessage:"Add"})}],pack_details:({packName:e})=>[P,{href:I.a.packs(),text:w.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})},{text:e}],pack_edit:({packName:e,packId:t})=>[P,{href:I.a.packs(),text:w.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})},{href:I.a.pack_details({packId:t}),text:e},{text:w.i18n.translate("xpack.osquery.breadcrumbs.editpacksPageTitle",{defaultMessage:"Edit"})}]};function B(e,t={}){var a;const{chrome:s,http:i,application:l}=Object(N.e)().services,n=(null===(a=L[e])||void 0===a?void 0:a.call(L,t).map((e=>{const t=e.href?i.basePath.prepend(`${_.b}${e.href}`):void 0;return{...e,href:t,onClick:t?e=>{e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||(e.preventDefault(),l.navigateToUrl(t))}:void 0}})))||[],o=[...n].reverse().map((e=>e.text));s.docTitle.change(o),s.setBreadcrumbs(n)}var A=a(15),Q=a(71),z=a(32),D=a(72);const R=[],G=({actionId:e})=>{const t=Object(N.f)(`live_queries/${e}`),a=w.i18n.translate("xpack.osquery.liveQueryActions.table.viewDetailsActionButton",{defaultMessage:"Details"});return Object(u.jsx)(j.EuiToolTip,{position:"top",content:a},Object(u.jsx)(j.EuiButtonIcon,h()({iconType:"visTable"},t,{"aria-label":a})))};G.displayName="ActionTableResultsButton";const $=()=>{var e,t;const a=Object(N.e)().services.application.capabilities.osquery,{push:l}=Object(o.useHistory)(),[n,r]=Object(s.useState)(0),[c,d]=Object(s.useState)(20),{data:b}=Object(D.a)({}),{data:p}=Object(z.a)({activePage:n,limit:c,kuery:"user_id: *"}),m=Object(s.useCallback)((({page:e={}})=>{const{index:t,size:a}=e;r(t),d(a)}),[]),x=Object(s.useCallback)(((e,t)=>{if(t._source.pack_name)return Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"center"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiIcon,{type:"package"})),Object(u.jsx)(j.EuiFlexItem,null,t._source.pack_name));const a=t._source.queries[0].query,s=Object(Q.a)(a),i=s.length>90?`${null==s?void 0:s.substring(0,90)}...`:s;return Object(u.jsx)(j.EuiCodeBlock,{language:"sql",fontSize:"s",paddingSize:"none",transparentBackground:!0},i)}),[]),O=Object(s.useCallback)(((e,t)=>{var a,s;return Object(u.jsx)(i.a.Fragment,null,null!==(a=null===(s=t.fields.agents)||void 0===s?void 0:s.length)&&void 0!==a?a:0)}),[]),g=Object(s.useCallback)((e=>Object(y.isArray)(e)?e[0]:"-"),[]),f=Object(s.useCallback)(((e,t)=>Object(u.jsx)(i.a.Fragment,null,Object(j.formatDate)(t.fields["@timestamp"][0]))),[]),v=Object(s.useCallback)((e=>Object(u.jsx)(G,{actionId:e.fields.action_id[0]})),[]),k=Object(s.useCallback)((e=>()=>{var t;if(e._source.pack_id)return l("/live_queries/new",{form:Object(y.pickBy)({packId:e._source.pack_id,agentSelection:{agents:e._source.agent_ids,allAgentsSelected:e._source.agent_all,platformsSelected:e._source.agent_platforms,policiesSelected:e._source.agent_policy_ids}},(e=>!Object(y.isEmpty)(e)))});l("/live_queries/new",{form:Object(y.pickBy)({query:e._source.queries[0].query,ecs_mapping:e._source.queries[0].ecs_mapping,savedQueryId:e._source.queries[0].saved_query_id,timeout:null!==(t=e._source.queries[0].timeout)&&void 0!==t?t:_.f.DEFAULT,agentSelection:{agents:e._source.agent_ids,allAgentsSelected:e._source.agent_all,platformsSelected:e._source.agent_platforms,policiesSelected:e._source.agent_policy_ids}},(e=>!Object(y.isEmpty)(e)||Object(y.isNumber)(e)))})}),[l]),h=Object(s.useCallback)(((e,t)=>{const a=w.i18n.translate("xpack.osquery.liveQueryActions.table.runActionAriaLabel",{defaultMessage:"Run query"});return Object(u.jsx)(j.EuiToolTip,{position:"top",content:a},Object(u.jsx)(j.EuiButtonIcon,{iconType:"play",onClick:k(e),isDisabled:!t,"aria-label":a}))}),[k]),E=Object(s.useMemo)((()=>{var e;return Object(y.map)(null!==(e=null==b?void 0:b.data)&&void 0!==e?e:[],"id")}),[b]),S=Object(s.useCallback)((e=>{var t;return null!==(t=e.fields.pack_id)&&void 0!==t&&t.length?E.includes(e.fields.pack_id[0])&&a.runSavedQueries&&a.readPacks:!(!a.runSavedQueries&&!a.writeLiveQueries)}),[a,E]),C=Object(s.useMemo)((()=>[{field:"query",name:w.i18n.translate("xpack.osquery.liveQueryActions.table.queryColumnTitle",{defaultMessage:"Query"}),truncateText:!0,width:"60%",render:x},{field:"agents",name:w.i18n.translate("xpack.osquery.liveQueryActions.table.agentsColumnTitle",{defaultMessage:"Agents"}),width:"100px",render:O},{field:"created_at",name:w.i18n.translate("xpack.osquery.liveQueryActions.table.createdAtColumnTitle",{defaultMessage:"Created at"}),width:"200px",render:f},{field:"fields.user_id",name:w.i18n.translate("xpack.osquery.liveQueryActions.table.createdByColumnTitle",{defaultMessage:"Run by"}),width:"200px",render:g},{name:w.i18n.translate("xpack.osquery.liveQueryActions.table.viewDetailsColumnTitle",{defaultMessage:"View details"}),actions:[{available:S,render:h},{render:v}]}]),[S,v,O,g,h,x,f]),M=Object(s.useMemo)((()=>{var e,t;return{pageIndex:n,pageSize:c,totalItemCount:null!==(e=null==p||null===(t=p.data)||void 0===t?void 0:t.total)&&void 0!==e?e:0,pageSizeOptions:[20,50,100]}}),[p,n,c]),q=Object(s.useCallback)((e=>({"data-test-subj":`row-${e._source.action_id}`})),[]);return Object(u.jsx)(j.EuiBasicTable,{items:null!==(e=null==p||null===(t=p.data)||void 0===t?void 0:t.items)&&void 0!==e?e:R,columns:C,pagination:M,onChange:m,rowProps:q,"data-test-subj":"liveQueryActionsTable"})},U=i.a.memo($),V=({euiTheme:e})=>({borderBottom:e.border.thin,backgroundColor:e.colors.body}),W={top:"1px","&:before":{height:"0px"}},H=Object(s.memo)((({leftColumn:e,rightColumn:t,rightColumnGrow:a})=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"center"},e?Object(u.jsx)(j.EuiFlexItem,null,e):null,t?Object(u.jsx)(j.EuiFlexItem,{grow:a},t):null)));H.displayName="HeaderColumns";const X=({children:e,leftColumn:t,rightColumn:a,rightColumnGrow:i,tabs:l,maxWidth:n,tabsClassName:o,"data-test-subj":r})=>{const c=Object(s.useCallback)((({euiTheme:e})=>Object(u.css)("max-width:",n||1200,"px;margin-left:auto;margin-right:auto;padding-top:",e.size.xl,";padding-left:",e.size.m,";padding-right:",e.size.m,";","")),[n]);return Object(u.jsx)("div",{css:V,"data-test-subj":r},Object(u.jsx)("div",{css:c},Object(u.jsx)(H,{leftColumn:t,rightColumn:a,rightColumnGrow:i}),e,Object(u.jsx)(j.EuiFlexGroup,null,l?Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiSpacer,{size:"s"}),Object(u.jsx)(j.EuiTabs,{className:o,css:W},l.map((e=>Object(u.jsx)(j.EuiTab,h()({},e,{key:e.id}),e.name))))):Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiSpacer,{size:"l"})))))},K=i.a.memo(X),Y=({euiTheme:e})=>({background:e.colors.emptyShade,width:"100%",alignSelf:"center",marginLeft:0,marginRight:0,flex:1}),J={height:"100%"},Z=({restrictWidth:e,restrictHeaderWidth:t,children:a,headerChildren:i,"data-test-subj":l,...n})=>Object(u.jsx)(s.Fragment,null,Object(u.jsx)(K,h()({maxWidth:t,"data-test-subj":l?`${l}_header`:void 0},n),i),Object(u.jsx)(j.EuiPage,{css:Y,restrictWidth:e||1200,"data-test-subj":l?`${l}_page`:void 0},Object(u.jsx)(j.EuiPageBody,null,Object(u.jsx)("div",{css:J},Object(u.jsx)(j.EuiSpacer,{size:"l"}),a)))),ee=()=>{B("live_queries");const e=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.liveQueriesHistory.pageTitle",defaultMessage:"Live queries history"})))))),[]);return Object(u.jsx)(Z,{leftColumn:e,rightColumn:Object(u.jsx)(ae,null),rightColumnGrow:!1},Object(u.jsx)(U,null))},te=i.a.memo(ee),ae=i.a.memo((()=>{const e=Object(N.e)().services.application.capabilities.osquery,t=Object(N.f)("live_queries/new");return Object(u.jsx)(j.EuiButton,h()({fill:!0},t,{iconType:"plusInCircle",isDisabled:!(e.writeLiveQueries||e.runSavedQueries&&(e.readSavedQueries||e.readPacks))}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.liveQueriesHistory.newLiveQueryButtonLabel",defaultMessage:"New live query"}))}));ae.displayName="NewLiveQueryButton";var se=a(134),ie=a.n(se),le=a(102);const ne=()=>{var e;B("live_query_new");const{replace:t}=Object(o.useHistory)(),a=Object(o.useLocation)(),i=Object(N.f)("live_queries"),[l,n]=Object(s.useState)({}),r=Object(s.useMemo)((()=>{const e=ie.a.parse(a.search);return null!=e&&e.agentPolicyId?[null==e?void 0:e.agentPolicyId]:void 0}),[a.search]);Object(s.useEffect)((()=>{var e,s;null!==(e=a.state)&&void 0!==e&&e.form&&(n(null===(s=a.state)||void 0===s?void 0:s.form),t({state:null}))}),[null===(e=a.state)||void 0===e?void 0:e.form,t]);const c=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,h()({iconType:"arrowLeft"},i,{flush:"left",size:"xs"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.newLiveQuery.viewLiveQueriesHistoryTitle",defaultMessage:"View live queries history"}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.newLiveQuery.pageTitle",defaultMessage:"New live query"})))))),[i]);return Object(u.jsx)(Z,{leftColumn:c},Object(u.jsx)(le.a,h()({agentPolicyIds:r},l)))},oe=i.a.memo(ne);var re=a(74),ue=a(77);const ce={paddingLeft:"10px"},de=()=>{const{actionId:e}=Object(o.useParams)();B("live_query_details",{liveQueryId:e});const t=Object(N.f)("live_queries"),[a,i]=Object(s.useState)(!1),{data:l}=Object(re.a)({actionId:e,isLive:a}),n=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,h()({iconType:"arrowLeft"},t,{flush:"left",size:"xs"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.liveQueryDetails.viewLiveQueriesHistoryTitle",defaultMessage:"View live queries history"}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.liveQueryDetails.pageTitle",defaultMessage:"Live query details"})))))),[t]);return Object(s.useLayoutEffect)((()=>{i((()=>!("completed"===(null==l?void 0:l.status))))}),[null==l?void 0:l.status]),Object(u.jsx)(Z,{leftColumn:n,rightColumnGrow:!1},Object(u.jsx)(j.EuiFlexItem,{css:ce},Object(u.jsx)(ue.a,{actionId:e,data:null==l?void 0:l.queries,startDate:null==l?void 0:l["@timestamp"],expirationDate:null==l?void 0:l.expiration,agentIds:null==l?void 0:l.agents,showResultsHeader:!0})))},be=i.a.memo(de);var je=a(81);const pe=()=>{const e=Object(N.e)().services.application.capabilities.osquery;B("live_queries");const t=Object(o.useRouteMatch)();return e.readLiveQueries?Object(u.jsx)(F,null,Object(u.jsx)(q,{path:`${t.url}/new`},e.runSavedQueries&&(e.readSavedQueries||e.readPacks)||e.writeLiveQueries?Object(u.jsx)(oe,null):Object(u.jsx)(je.a,null)),Object(u.jsx)(q,{path:`${t.url}/:actionId`},Object(u.jsx)(be,null)),Object(u.jsx)(q,{path:`${t.url}`},Object(u.jsx)(te,null))):Object(u.jsx)(je.a,null)},me=i.a.memo(pe);var xe=a(45),Oe=a.n(xe),ge=a(61),fe=a.n(ge),ve=a(21),ye=a(75);const ke=({disabled:e=!1,savedQuery:t})=>{const{push:a}=Object(o.useHistory)(),i=Object(s.useCallback)((()=>{var e;return a("/live_queries/new",{form:{savedQueryId:t.id,query:t.query,ecs_mapping:t.ecs_mapping,timeout:null!==(e=t.timeout)&&void 0!==e?e:_.f.DEFAULT}})}),[a,t]),l=Object(s.useMemo)((()=>w.i18n.translate("xpack.osquery.savedQueryList.queriesTable.runActionAriaLabel",{defaultMessage:"Run {savedQueryName}",values:{savedQueryName:t.id}})),[t]);return Object(u.jsx)(j.EuiToolTip,{position:"top",content:l},Object(u.jsx)(j.EuiButtonIcon,{color:"primary",iconType:"play",isDisabled:e,onClick:i,"aria-label":l}))},he=i.a.memo(ke,fe.a),Ee=({disabled:e=!1,savedQueryId:t,savedQueryName:a})=>{const i=Object(N.f)(`saved_queries/${t}`),l=Object(s.useMemo)((()=>w.i18n.translate("xpack.osquery.savedQueryList.queriesTable.editActionAriaLabel",{defaultMessage:"Edit {savedQueryName}",values:{savedQueryName:a}})),[a]);return Object(u.jsx)(j.EuiToolTip,{position:"top",content:l},Object(u.jsx)(j.EuiButtonIcon,h()({color:"primary"},i,{iconType:"pencil",isDisabled:e,"aria-label":l})))},Se=i.a.memo(Ee),Ce=()=>{const e=Object(N.e)().services.application.capabilities.osquery;B("saved_queries");const t=Object(N.f)("saved_queries/new"),[a,l]=Object(s.useState)(0),[n,o]=Object(s.useState)(20),[r,c]=Object(s.useState)("updated_at"),[d,b]=Object(s.useState)(ve.a.desc),{data:p}=Object(ye.a)({isLive:!0}),m=Object(s.useCallback)((e=>Object(u.jsx)(Se,{savedQueryId:e.saved_object_id,savedQueryName:e.id})),[]),x=Object(s.useCallback)((t=>e.runSavedQueries||e.writeLiveQueries?Object(u.jsx)(he,{savedQuery:t,disabled:!1}):Object(u.jsx)(i.a.Fragment,null)),[e.runSavedQueries,e.writeLiveQueries]),O=Object(s.useCallback)(((e,t)=>{if(!e)return"-";const a=t.updated_by!==t.created_by?` @ ${t.updated_by}`:"";return e?`${Oe()(e).fromNow()}${a}`:"-"}),[]),g=Object(s.useCallback)((e=>{const t=e&&e.length>80?`${null==e?void 0:e.substring(0,80)}...`:e;return Object(u.jsx)(j.EuiToolTip,{content:Object(u.jsx)(j.EuiFlexItem,null,e)},Object(u.jsx)(j.EuiFlexItem,{grow:!1},t))}),[]),f=Object(s.useMemo)((()=>[{field:"id",name:w.i18n.translate("xpack.osquery.savedQueries.table.queryIdColumnTitle",{defaultMessage:"Query ID"}),sortable:e=>e.id.toLowerCase(),truncateText:!0,width:"15%"},{field:"description",name:w.i18n.translate("xpack.osquery.savedQueries.table.descriptionColumnTitle",{defaultMessage:"Description"}),render:g,width:"50%"},{field:"created_by",name:w.i18n.translate("xpack.osquery.savedQueries.table.createdByColumnTitle",{defaultMessage:"Created by"}),width:"15%",sortable:!0,truncateText:!0},{field:"updated_at",name:w.i18n.translate("xpack.osquery.savedQueries.table.updatedAtColumnTitle",{defaultMessage:"Last updated at"}),width:"10%",sortable:e=>e.updated_at?Date.parse(e.updated_at):0,truncateText:!0,render:O},{name:w.i18n.translate("xpack.osquery.savedQueries.table.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:x},{render:m}]}]),[g,m,x,O]),v=Object(s.useCallback)((({page:e={},sort:t={}})=>{l(e.index),o(e.size),c(t.field),b(t.direction)}),[]),y=Object(s.useMemo)((()=>{var e;return{pageIndex:a,pageSize:n,totalItemCount:null!==(e=null==p?void 0:p.total)&&void 0!==e?e:0,pageSizeOptions:[10,20,50,100]}}),[a,n,null==p?void 0:p.total]),k=Object(s.useMemo)((()=>({sort:{field:r,direction:d}})),[d,r]),E=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.savedQueryList.pageTitle",defaultMessage:"Saved queries"})))))),[]),S=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiButton,h()({fill:!0},t,{iconType:"plusInCircle",isDisabled:!e.writeSavedQueries}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.savedQueryList.addSavedQueryButtonLabel",defaultMessage:"Add saved query"}))),[e.writeSavedQueries,t]);return Object(u.jsx)(Z,{leftColumn:E,rightColumn:S,rightColumnGrow:!1},(null==p?void 0:p.data)&&Object(u.jsx)(j.EuiInMemoryTable,{items:null==p?void 0:p.data,itemId:"id",columns:f,pagination:y,sorting:k,onChange:v,rowHeader:"id"}))},Me=i.a.memo(Ce);var qe=a(17),Te=a(104),Fe=a(79);const we=({defaultValue:e,handleSubmit:t})=>{const a=Object(N.f)("saved_queries"),s=Object(Fe.b)({defaultValue:e}),{serializer:i,idSet:l,handleSubmit:n,formState:{isSubmitting:o,errors:r}}=s;return Object(u.jsx)(qe.FormProvider,s,Object(u.jsx)(Te.a,{hasPlayground:!0,isValid:Object(y.isEmpty)(r),idSet:l}),Object(u.jsx)(j.EuiBottomBar,null,Object(u.jsx)(j.EuiFlexGroup,{justifyContent:"flexEnd"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButtonEmpty,h()({color:"text"},a),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.addSavedQuery.form.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButton,{isLoading:o,color:"primary",fill:!0,size:"m",iconType:"save",onClick:n((async e=>{const a=i(e);await t(a)}))},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.addSavedQuery.form.saveQueryButtonLabel",defaultMessage:"Save query"}))))))),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}))},_e=i.a.memo(we);var Ie=a(119);const Ne=()=>{B("saved_query_new");const e=Object(N.f)("saved_queries"),{mutateAsync:t}=Object(Ie.a)({withRedirect:!0}),a=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,h()({iconType:"arrowLeft"},e,{flush:"left",size:"xs"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.addSavedQuery.viewSavedQueriesListTitle",defaultMessage:"View all saved queries"}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.addSavedQuery.pageTitle",defaultMessage:"Add saved query"})))))),[e]),i=Object(s.useCallback)((async e=>{await t(e)}),[t]);return Object(u.jsx)(Z,{leftColumn:a},Object(u.jsx)(_e,{handleSubmit:i}))},Pe=i.a.memo(Ne);var Le=a(43);const Be=({defaultValue:e,handleSubmit:t,viewMode:a})=>{const s=Object(N.f)("saved_queries"),l=Object(Fe.b)({defaultValue:e}),{serializer:n,idSet:o,handleSubmit:r,formState:{isSubmitting:c}}=l;return Object(u.jsx)(qe.FormProvider,l,Object(u.jsx)(Te.a,{viewMode:a,hasPlayground:!0,idSet:o}),!a&&Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(j.EuiBottomBar,null,Object(u.jsx)(j.EuiFlexGroup,{justifyContent:"flexEnd"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButtonEmpty,h()({color:"text"},s),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editSavedQuery.form.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButton,{"data-test-subj":"update-query-button",isLoading:c,color:"primary",fill:!0,size:"m",iconType:"save",onClick:r((async e=>{const a=n(e);try{await t(a)}catch(e){}}))},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editSavedQuery.form.updateQueryButtonLabel",defaultMessage:"Update query"}))))))),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(j.EuiSpacer,{size:"xxl"})))},Ae=i.a.memo(Be);var Qe=a(127);const ze={margin:"10px"},De=()=>{var e;const t=Object(N.e)().services.application.capabilities.osquery,[a,l]=Object(s.useState)(!1),{savedQueryId:n}=Object(o.useParams)(),r=Object(N.f)("saved_queries"),{isLoading:c,data:d}=Object(Qe.c)({savedQueryId:n}),b=Object(Qe.d)({savedQueryId:n}),p=Object(Qe.b)({savedQueryId:n});B("saved_query_edit",{savedQueryName:null!==(e=null==d?void 0:d.saved_object_id)&&void 0!==e?e:""});const m=Object(s.useMemo)((()=>!(null==d||!d.prebuilt)),[d]),x=Object(s.useMemo)((()=>!t.writeSavedQueries||m),[t.writeSavedQueries,m]),O=Object(s.useCallback)((()=>{l(!1)}),[]),g=Object(s.useCallback)((()=>{l(!0)}),[]),f=Object(s.useCallback)((()=>{p.mutateAsync().then((()=>{O()}))}),[p,O]),v=Object(s.useMemo)((()=>{var e,t;return Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,h()({iconType:"arrowLeft"},r,{flush:"left",size:"xs"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editSavedQuery.viewSavedQueriesListTitle",defaultMessage:"View all saved queries"}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,x?Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.viewSavedQuery.pageTitle",defaultMessage:'"{savedQueryId}" details',values:{savedQueryId:null!==(e=null==d?void 0:d.id)&&void 0!==e?e:""}}),m&&Object(u.jsx)(j.EuiCallOut,{css:ze,size:"s"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.viewSavedQuery.prebuiltInfo",defaultMessage:"This is a prebuilt Elastic query, and it cannot be edited."}))):Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editSavedQuery.pageTitle",defaultMessage:'Edit "{savedQueryId}"',values:{savedQueryId:null!==(t=null==d?void 0:d.id)&&void 0!==t?t:""}})))))}),[m,null==d?void 0:d.id,r,x]),y=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiButton,{color:"danger",onClick:g,iconType:"trash"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editSavedQuery.deleteSavedQueryButtonLabel",defaultMessage:"Delete query"}))),[g]),k=Object(s.useCallback)((async e=>{await b.mutateAsync(e)}),[b]);return c?null:Object(u.jsx)(Z,{leftColumn:v,rightColumn:x?void 0:y,rightColumnGrow:!1},!c&&!Object(Le.isEmpty)(d)&&Object(u.jsx)(Ae,{defaultValue:d,handleSubmit:k,viewMode:x}),a?Object(u.jsx)(j.EuiConfirmModal,{title:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.title",defaultMessage:"Are you sure you want to delete this query?"}),onCancel:O,onConfirm:f,cancelButtonText:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.confirmButtonLabel",defaultMessage:"Confirm"}),buttonColor:"danger",defaultFocusedButton:"confirm"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.body",defaultMessage:"You're about to delete this query. Are you sure you want to do this?"})):null)},Re=i.a.memo(De),Ge=()=>{const e=Object(N.e)().services.application.capabilities.osquery;B("saved_queries");const t=Object(o.useRouteMatch)();return e.readSavedQueries?Object(u.jsx)(F,null,Object(u.jsx)(q,{path:`${t.url}/new`},e.writeSavedQueries?Object(u.jsx)(Pe,null):Object(u.jsx)(je.a,null)),Object(u.jsx)(q,{path:`${t.url}/:savedQueryId`},Object(u.jsx)(Re,null)),Object(u.jsx)(q,{path:`${t.url}`},Object(u.jsx)(Me,null))):Object(u.jsx)(je.a,null)},$e=i.a.memo(Ge);var Ue=a(93);const Ve=({onConfirm:e,onCancel:t,agentCount:a,agentPolicyCount:s})=>Object(u.jsx)(j.EuiConfirmModal,{title:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalTitle",defaultMessage:"Save and deploy changes"}),onCancel:t,onConfirm:e,cancelButtonText:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalCancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalConfirmButtonLabel",defaultMessage:"Save and deploy changes"}),buttonColor:"primary"},Object(u.jsx)(j.EuiCallOut,{iconType:"iInCircle",title:w.i18n.translate("xpack.osquery.agentPolicy.confirmModalCalloutTitle",{defaultMessage:"This action will update {agentCount, plural, one {# agent} other {# agents}}",values:{agentCount:a}})},Object(u.jsx)("div",{className:"eui-textBreakWord"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalCalloutDescription",defaultMessage:"Fleet has detected that the selected {agentPolicyCount, plural, one {agent policy} other {agent policies}}, is already in use by some of your agents. As a result of this action, Fleet will deploy updates to all agents that use this {agentPolicyCount, plural, one {agent policy} other {agent policies}}.",values:{agentPolicyCount:s}}))),Object(u.jsx)(j.EuiSpacer,{size:"l"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalDescription",defaultMessage:"Are you sure you wish to continue?"})),We=i.a.memo(Ve);var He=a(18),Xe=a(9),Ke=a(64);const Ye=({withRedirect:e,options:t})=>{const a=Object(d.useQueryClient)(),{application:{navigateToApp:s},http:i,notifications:{toasts:l}}=Object(N.e)().services,n=Object(He.a)();return Object(d.useMutation)((({id:e,...t})=>i.put(`/api/osquery/packs/${e}`,{version:_.a.public.v1,body:JSON.stringify(t)})),{onError:e=>{var t,a;n(e,{title:null==e||null===(t=e.body)||void 0===t?void 0:t.error,toastMessage:null==e||null===(a=e.body)||void 0===a?void 0:a.message})},onSuccess:t=>{var i,n;a.invalidateQueries([Ke.a]),e&&s(Xe.PLUGIN_ID,{path:I.a.packs()}),l.addSuccess(w.i18n.translate("xpack.osquery.updatePack.successToastMessageText",{defaultMessage:'Successfully updated "{packName}" pack',values:{packName:null!==(i=null==t||null===(n=t.data)||void 0===n?void 0:n.name)&&void 0!==i?i:""}}))},...t})},Je=({euiTheme:e})=>({marginRight:e.size.s}),Ze=({item:e})=>{const t=Object(d.useQueryClient)(),{application:{capabilities:{osquery:a}},notifications:{toasts:l}}=Object(N.e)().services,n=Object(He.a)(),[o,r]=Object(s.useState)(!1),c=Object(s.useCallback)((()=>r(!1)),[]),{data:b}=Object(Ue.a)(),p=Object(s.useMemo)((()=>e.policy_ids.reduce(((e,t)=>{var a;return e+((null==b||null===(a=b.agentPoliciesById[t])||void 0===a?void 0:a.agents)||0)}),0)),[null==b?void 0:b.agentPoliciesById,e.policy_ids]),{isLoading:m,mutateAsync:x}=Ye({options:{onSuccess:e=>{var a,s,i;t.invalidateQueries([Ke.a]),n(),l.addSuccess(null!=e&&null!==(a=e.data)&&void 0!==a&&a.enabled?w.i18n.translate("xpack.osquery.pack.table.activatedSuccessToastMessageText",{defaultMessage:'Successfully activated "{packName}" pack',values:{packName:null==e||null===(s=e.data)||void 0===s?void 0:s.name}}):w.i18n.translate("xpack.osquery.pack.table.deactivatedSuccessToastMessageText",{defaultMessage:'Successfully deactivated "{packName}" pack',values:{packName:null==e||null===(i=e.data)||void 0===i?void 0:i.name}}))}}}),O=Object(s.useCallback)((()=>{x({id:e.saved_object_id,enabled:!e.enabled}),c()}),[c,e,x]),g=Object(s.useCallback)((()=>{if(p)return r(!0);O()}),[p,O]);return Object(u.jsx)(i.a.Fragment,null,m&&Object(u.jsx)(j.EuiLoadingSpinner,{css:Je}),Object(u.jsx)(j.EuiSwitch,{checked:!!e.enabled,disabled:!a.writePacks||m,showLabel:!1,"aria-label":e.name,label:"",onChange:g}),o&&p&&Object(u.jsx)(We,{onConfirm:O,onCancel:c,agentCount:p,agentPolicyCount:e.policy_ids.length}))},et=i.a.memo(Ze);var tt=a(46),at=a(44),st=a(94);const it={whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},lt=({policyId:e})=>{var t;const{application:{getUrlForApp:a,navigateToApp:i}}=Object(N.e)().services,{data:l}=Object(st.a)({policyId:e}),n=Object(s.useMemo)((()=>a(tt.PLUGIN_ID,{path:at.pagePathGetters.policy_details({policyId:e})[1]})),[a,e]),o=Object(s.useCallback)((t=>{if(!Object(N.d)(t)&&Object(N.c)(t))return t.preventDefault(),i(tt.PLUGIN_ID,{path:at.pagePathGetters.policy_details({policyId:e})[1]})}),[i,e]);return Object(u.jsx)(j.EuiLink,{href:n,onClick:o,css:it},null!==(t=null==l?void 0:l.name)&&void 0!==t?t:e)},nt=i.a.memo(lt),ot={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},rt=[],ut=({id:e,name:t})=>Object(u.jsx)(j.EuiLink,Object(N.f)(`packs/${e}`),t),ct=i.a.memo(ut),dt=(e,t)=>Object(u.jsx)(ct,{id:t.saved_object_id,name:t.name}),bt=({agentPolicyIds:e=[]})=>{const[t,a]=Object(s.useState)(!1),l=Object(s.useCallback)((()=>a((e=>!e))),[]),n=Object(s.useCallback)((()=>a(!1)),[]),o=Object(s.useMemo)((()=>{var t;return Object(u.jsx)(j.EuiButtonEmpty,{size:"s",flush:"both",onClick:l},Object(u.jsx)(i.a.Fragment,null,null!==(t=null==e?void 0:e.length)&&void 0!==t?t:0))}),[null==e?void 0:e.length,l]);var r;return null!=e&&e.length?Object(u.jsx)(j.EuiPopover,{button:o,isOpen:t,closePopover:n},Object(u.jsx)(j.EuiText,{size:"s"},null==e?void 0:e.map((e=>Object(u.jsx)("div",{key:e},Object(u.jsx)(nt,{policyId:e})))))):Object(u.jsx)(i.a.Fragment,null,null!==(r=null==e?void 0:e.length)&&void 0!==r?r:0)},jt=()=>{var e;const t=Object(N.e)().services.application.capabilities.osquery,{push:a}=Object(o.useHistory)(),{data:l,isLoading:n}=Object(D.a)({}),r=Object(s.useCallback)((e=>Object(u.jsx)(bt,{agentPolicyIds:e})),[]),c=Object(s.useCallback)((e=>{var t;return Object(u.jsx)(i.a.Fragment,null,null!==(t=e&&Object.keys(e).length)&&void 0!==t?t:0)}),[]),d=Object(s.useCallback)(((e,t)=>Object(u.jsx)(et,{item:t})),[]),b=Object(s.useCallback)(((e,t)=>{if(!e)return"-";const a=t.updated_by!==t.created_by?` @ ${t.updated_by}`:"";return e?Object(u.jsx)(j.EuiToolTip,{content:`${Oe()(e).fromNow()}${a}`},Object(u.jsx)("span",{css:ot},`${Oe()(e).fromNow()}${a}`)):"-"}),[]),p=Object(s.useCallback)((e=>()=>a("/live_queries/new",{form:{packId:e.saved_object_id}})),[a]),m=Object(s.useCallback)(((e,t)=>{const a=w.i18n.translate("xpack.osquery.packs.table.runActionAriaLabel",{defaultMessage:"Run {packName}",values:{packName:e.name}});return Object(u.jsx)(j.EuiToolTip,{position:"top",content:a},Object(u.jsx)(j.EuiButtonIcon,{iconType:"play",onClick:p(e),isDisabled:!t,"data-test-subj":`play-${e.name}-button`}))}),[p]),x=Object(s.useMemo)((()=>[{field:"name",name:w.i18n.translate("xpack.osquery.packs.table.nameColumnTitle",{defaultMessage:"Name"}),sortable:e=>e.name.toLowerCase(),render:dt},{field:"policy_ids",name:w.i18n.translate("xpack.osquery.packs.table.policyColumnTitle",{defaultMessage:"Scheduled policies"}),truncateText:!0,render:r},{field:"queries",name:w.i18n.translate("xpack.osquery.packs.table.numberOfQueriesColumnTitle",{defaultMessage:"Number of queries"}),render:c,width:"150px"},{field:"created_by",name:w.i18n.translate("xpack.osquery.packs.table.createdByColumnTitle",{defaultMessage:"Created by"}),sortable:!0,truncateText:!0},{field:"updated_at",name:"Last updated",sortable:e=>e.updated_at?Date.parse(e.updated_at):0,truncateText:!0,render:b},{field:"enabled",name:w.i18n.translate("xpack.osquery.packs.table.activeColumnTitle",{defaultMessage:"Active"}),sortable:!0,align:"right",width:"80px",render:d},{name:w.i18n.translate("xpack.osquery.pack.queriesTable.actionsColumnTitle",{defaultMessage:"Actions"}),width:"80px",actions:[{render:m,enabled:()=>t.writeLiveQueries||t.runSavedQueries}]}]),[t.runSavedQueries,t.writeLiveQueries,d,r,m,c,b]),O=Object(s.useMemo)((()=>({sort:{field:"name",direction:"asc"}})),[]);return n?Object(u.jsx)(j.EuiSkeletonText,{lines:10}):Object(u.jsx)(j.EuiInMemoryTable,{items:null!==(e=null==l?void 0:l.data)&&void 0!==e?e:rt,columns:x,pagination:!0,sorting:O})},pt=i.a.memo(jt),mt=({fill:e=!0})=>{const t=Object(N.e)().services.application.capabilities.osquery,a=Object(N.f)("packs/add");return Object(u.jsx)(j.EuiButton,h()({fill:!!e},a,{iconType:"plusInCircle",isDisabled:!t.writePacks,"data-test-subj":"add-pack-button"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packList.addPackButtonLabel",defaultMessage:"Add pack"}))},xt=i.a.memo(mt),Ot="integrationAssetsStatus",gt=()=>{const{http:e}=Object(N.e)().services;return Object(d.useQuery)([Ot],(()=>e.get("/internal/osquery/assets",{version:_.a.internal.v1})),{keepPreviousData:!0,retry:!1})},ft=w.i18n.translate("xpack.osquery.packList.prePackagedPacks.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt packs"}),vt=w.i18n.translate("xpack.osquery.packList.prePackagedPacks.loadButtonLabel",{defaultMessage:"Load Elastic prebuilt packs"}),yt=w.i18n.translate("xpack.osquery.packList.prePackagedPacks.updateButtonLabel",{defaultMessage:"Update Elastic prebuilt packs"}),kt=w.i18n.translate("xpack.osquery.packList.integrationAssets.loadSuccessToastMessageText",{defaultMessage:"Successfully loaded prebuilt packs"}),ht=w.i18n.translate("xpack.osquery.packList.integrationAssets.updateSuccessToastMessageText",{defaultMessage:"Successfully updated prebuilt packs"}),Et=w.i18n.translate("xpack.osquery.packList.prePackagedPacks.emptyPromptTitle.emptyPromptMessage",{defaultMessage:"A pack is a set of queries that you can schedule. Load prebuilt packs or create your own."}),St=({fill:e})=>{var t;const{data:a}=gt(),{isLoading:i,mutateAsync:l}=(({successToastText:e})=>{const t=Object(d.useQueryClient)(),{http:a,notifications:{toasts:s}}=Object(N.e)().services,i=Object(He.a)();return Object(d.useMutation)((()=>a.post("/internal/osquery/assets/update",{version:_.a.internal.v1})),{onSuccess:()=>{i(),t.invalidateQueries([Ke.a]),t.invalidateQueries([Ot]),s.addSuccess(e)},onError:e=>{i(e)}})})({successToastText:null!=a&&null!==(t=a.upToDate)&&void 0!==t&&t.length?ht:kt}),n=Object(s.useCallback)((()=>l()),[l]);var o;return null!=a&&a.install.length||null!=a&&a.update.length?Object(u.jsx)(j.EuiButton,{fill:!!e,isLoading:i,onClick:n,iconType:"plusInCircle"},null!=a&&null!==(o=a.upToDate)&&void 0!==o&&o.length?yt:vt):null},Ct=i.a.memo(St);var Mt=a(63);const qt=()=>{const e=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(Ct,{fill:!0})),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(xt,{fill:!1})))),[]);return Object(u.jsx)(j.EuiEmptyPrompt,{icon:Object(u.jsx)(Mt.a,null),color:"transparent",title:Object(u.jsx)("h2",null,ft),body:Object(u.jsx)("p",null,Et),actions:e})},Tt=i.a.memo(qt),Ft=()=>{var e;const{data:t,isLoading:a}=gt(),{data:i,isLoading:l}=Object(D.a)({}),n=Object(s.useMemo)((()=>{var e;return!(null!=i&&i.total)&&(null==t||null===(e=t.install)||void 0===e?void 0:e.length)}),[null==t||null===(e=t.install)||void 0===e?void 0:e.length,null==i?void 0:i.total]),o=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packList.pageTitle",defaultMessage:"Packs"})))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,{color:"subdued"},Object(u.jsx)("p",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packList.pageSubtitle",defaultMessage:"Create packs to organize sets of queries and to schedule queries for agent policies."})))))),[]),r=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{direction:"row",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(Ct,{fill:!!n})),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(xt,{fill:!n})))),[n]),c=Object(s.useMemo)((()=>a||l?Object(u.jsx)(j.EuiSkeletonText,{lines:10}):n?Object(u.jsx)(Tt,null):Object(u.jsx)(pt,null)),[a,l,n]);return Object(u.jsx)(Z,{leftColumn:o,rightColumn:r,rightColumnGrow:!1},c)},wt=i.a.memo(Ft);var _t=a(95),It=a(76);const Nt=({index:e,control:t,hideLabel:a,options:i})=>{const{data:{agentPoliciesById:l}={}}=Object(It.a)(),n=Object(s.useCallback)((e=>e?void 0:w.i18n.translate("xpack.osquery.pack.form.shardsPolicyFieldMissingErrorMessage",{defaultMessage:"Policy is a required field"})),[]),{field:{onChange:o,value:r},fieldState:{error:c}}=Object(qe.useController)({control:t,name:`shardsArray.${e}.policy`,rules:{validate:n}}),d=Object(s.useMemo)((()=>!(null==c||!c.message)),[null==c?void 0:c.message]),[b,p]=Object(s.useState)([]),m=Object(s.useCallback)((e=>{p(e),o(e[0])}),[o]);Object(s.useEffect)((()=>{const e=null==l?void 0:l[r.key];r&&e&&p([{label:r.label||e.name,value:r.key}])}),[l,r]);const x=Object(s.useMemo)((()=>({asPlainText:!0})),[]);return Object(u.jsx)(j.EuiFormRow,{label:a?"":w.i18n.translate("xpack.osquery.pack.form.policyFieldLabel",{defaultMessage:"Policy"}),error:null==c?void 0:c.message,isInvalid:d,fullWidth:!0},Object(u.jsx)(j.EuiComboBox,{fullWidth:!0,singleSelection:x,isInvalid:d,options:i,selectedOptions:b,onChange:m,"data-test-subj":"shards-field-policy",rowHeight:32,isClearable:!0}))},Pt=i.a.memo(Nt),Lt=({index:e,control:t,euiFieldProps:a,hideLabel:i})=>{const{field:{onChange:l,value:n},fieldState:{error:o}}=Object(qe.useController)({control:t,name:`shardsArray.${e}.percentage`,defaultValue:100}),r=Object(s.useCallback)((e=>{const t=e.target.valueAsNumber?e.target.valueAsNumber:0;l(t)}),[l]),c=Object(s.useMemo)((()=>!(null==o||!o.message)),[null==o?void 0:o.message]);return Object(u.jsx)(j.EuiFormRow,{label:i?"":w.i18n.translate("xpack.osquery.pack.form.percentageFieldLabel",{defaultMessage:"Shard"}),error:null==o?void 0:o.message,isInvalid:c,fullWidth:!0},Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"s"},Object(u.jsx)(j.EuiFlexItem,{grow:10},Object(u.jsx)(j.EuiRange,h()({"data-test-subj":"shards-field-percentage",id:"shardsPercentage"+e,min:0,max:100,step:1,value:n,fullWidth:!0,showInput:!0,showLabels:!1,append:"%",onChange:r},a)))))},Bt=i.a.memo(Lt);var At=a(66);const Qt=({onDelete:e,index:t,isLastItem:a,control:l,options:n})=>{const o=Object(s.useCallback)((()=>{e&&e(t)}),[t,e]),r=Object(s.useCallback)((({euiTheme:e})=>0===t?{marginTop:e.size.base}:{}),[t]);return Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(j.EuiFlexGroup,{"data-test-subj":`packShardsForm-${t}`,alignItems:"flexStart",gutterSize:"s"},Object(u.jsx)(j.EuiFlexItem,{css:At.a},Object(u.jsx)(Pt,{index:t,control:l,hideLabel:0!==t,options:n})),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(u.jsx)(j.EuiFlexItem,{grow:!0},Object(u.jsx)(Bt,{index:t,control:l,hideLabel:0!==t})),Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)("div",{css:r},Object(u.jsx)(j.EuiButtonIcon,{"aria-label":w.i18n.translate("xpack.osquery.pack.form.deleteShardsRowButtonAriaLabel",{defaultMessage:"Delete shards row"}),iconType:"trash",color:"text",disabled:a,onClick:o})))))),Object(u.jsx)(j.EuiSpacer,{size:"s"}))},zt=i.a.memo(Qt),Dt={policy:{label:"",key:""},percentage:100},Rt=({options:e})=>{const{watch:t,register:a,setValue:l,formState:{errors:n}}=Object(qe.useFormContext)(),{data:{agentPoliciesById:o}={}}=Object(It.a)(),r=t("shards"),c=Object(s.useMemo)((()=>{const e=Object(_t.c)(r,o);return Object(y.isEmpty)(e)?[Dt]:e[e.length-1].policy.key?[...e,Dt]:e}),[o,r]),{control:d,watch:b,getFieldState:p,formState:m,resetField:x,setValue:O}=Object(qe.useForm)({mode:"all",shouldUnregister:!0,defaultValues:{shardsArray:c}}),{fields:g,remove:f,append:v}=Object(qe.useFieldArray)({control:d,name:"shardsArray"}),k=b(),h=p("shardsArray",m);return Object(s.useEffect)((()=>{a("shards",{validate:()=>!Object(y.reject)(h.error,y.isEmpty).length})}),[h.error,n,a]),Object(s.useEffect)((()=>{const e=b(((e,t)=>{if(null!=e&&e.shardsArray){var a,s;const l=(null==e||null===(a=e.shardsArray)||void 0===a?void 0:a.length)-1;if(null!==(s=t.name)&&void 0!==s&&s.startsWith(`shardsArray.${l}.`)){var i;const t=Object(y.last)(e.shardsArray);null!=t&&null!==(i=t.policy)&&void 0!==i&&i.key&&v(Dt)}}}));return()=>e.unsubscribe()}),[k,v,b]),Object(s.useEffect)((()=>{const e=Object(_t.d)(k.shardsArray);h.isDirty&&!fe()(e,r)&&l("shards",e,{shouldTouch:!0})}),[l,k,h.isDirty,r,x,O]),Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(j.EuiSpacer,{size:"s"}),g.map(((t,a,s)=>Object(u.jsx)(j.EuiFlexItem,{key:t.id},Object(u.jsx)(zt,{index:a,onDelete:f,isLastItem:a===s.length-1,control:d,options:e}),Object(u.jsx)(j.EuiSpacer,{size:"xs"})))))},Gt=i.a.memo(Rt);var $t=a(84),Ut=a.n($t);const Vt=Ut()(j.EuiFlexItem,{target:"e1ami9i00"})("max-width:",(({grow:e})=>e/9*100),";overflow:hidden;"),Wt=({euiFieldProps:e,options:t})=>{const{data:{agentPoliciesById:a}={}}=Object(It.a)(),{field:{onChange:i,value:l},fieldState:{error:n}}=Object(qe.useController)({name:"policy_ids",defaultValue:[],rules:{}}),o=Object(s.useMemo)((()=>a?Object(y.castArray)(l).map((e=>{var t,s;return{key:e,label:null!==(t=null===(s=a[e])||void 0===s?void 0:s.name)&&void 0!==t?t:e}})):[]),[a,l]),r=Object(s.useCallback)((e=>{i(e.map((e=>e.key||e.label)))}),[i]),c=Object(s.useCallback)((e=>{var t,s,i,l,n;return Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(Vt,{grow:2},Object(u.jsx)("span",{className:"eui-textTruncate"},null!==(t=e.key&&(null==a||null===(s=a[e.key])||void 0===s?void 0:s.name))&&void 0!==t?t:e.label)),Object(u.jsx)(Vt,{grow:5},Object(u.jsx)(j.EuiTextColor,{className:"eui-textTruncate",color:"subdued"},null!==(i=e.key&&(null==a?void 0:a[e.key].description))&&void 0!==i?i:"")),Object(u.jsx)(j.EuiFlexItem,{grow:2,className:"eui-textRight"},Object(u.jsx)(j.EuiTextColor,{color:"subdued"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.createScheduledQuery.agentPolicyAgentsCountText",defaultMessage:"{count, plural, one {# agent} other {# agents}} enrolled",values:{count:null!==(l=e.key&&(null==a||null===(n=a[e.key])||void 0===n?void 0:n.agents))&&void 0!==l?l:0}}))))}),[a]),d=Object(s.useMemo)((()=>{if(null==l||!l.length||!l[0].length||!a)return Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.pack.form.agentPoliciesFieldHelpText",defaultMessage:"Queries in this pack are scheduled for agents in the selected policies."});const e=Object(y.reduce)(l,((e,t)=>{var s;const i=a&&a[t];return e+(null!==(s=null==i?void 0:i.agents)&&void 0!==s?s:0)}),0);return Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.createScheduledQuery.agentPolicyAgentsCountText",defaultMessage:"{count, plural, one {# agent} other {# agents}} enrolled",values:{count:e}})}),[a,l]),b=Object(s.useMemo)((()=>!(null==n||!n.message)),[null==n?void 0:n.message]);return Object(u.jsx)(j.EuiFormRow,{label:w.i18n.translate("xpack.osquery.pack.form.agentPoliciesFieldLabel",{defaultMessage:"Scheduled agent policies (optional)"}),helpText:d,error:null==n?void 0:n.message,isInvalid:b,fullWidth:!0},Object(u.jsx)(j.EuiComboBox,h()({isInvalid:b,selectedOptions:o,fullWidth:!0,"data-test-subj":"policyIdsComboBox",isClearable:!0,options:t,renderOption:c,onChange:r},e)))},Ht=i.a.memo(Wt,fe.a);var Xt=a(49),Kt=a(113),Yt=a(111);const Jt=({platform:e})=>{const[t,a]=Object(s.useState)(Kt.a);Object(s.useEffect)((()=>{a((t=>{if(e){let a;try{a=null==e?void 0:e.split(",").map((e=>e.trim()))}catch(e){return t}return a}return Kt.a}))}),[e]);const i=Object(s.useMemo)((()=>t.map((e=>Object(u.jsx)(j.EuiFlexItem,{key:e,grow:!1},Object(u.jsx)(Yt.a,{platform:e}))))),[t]);return Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"s"},i)},Zt=i.a.memo(Jt),ea=({data:e,isReadOnly:t,onDeleteClick:a,onEditClick:i,selectedItems:l,setSelectedItems:n})=>{const o=Object(s.useCallback)((e=>Object(u.jsx)(j.EuiButtonIcon,{color:"danger",onClick:()=>a&&a(e),iconType:"trash","aria-label":w.i18n.translate("xpack.osquery.pack.queriesTable.deleteActionAriaLabel",{defaultMessage:"Delete {queryName}",values:{queryName:e.id}})})),[a]),r=Object(s.useCallback)((e=>Object(u.jsx)(j.EuiButtonIcon,{color:"primary",onClick:()=>i&&i(e),iconType:"pencil","aria-label":w.i18n.translate("xpack.osquery.pack.queriesTable.editActionAriaLabel",{defaultMessage:"Edit {queryName}",values:{queryName:e.id}})})),[i]),c=Object(s.useCallback)((e=>Object(u.jsx)(j.EuiCodeBlock,{language:"sql",fontSize:"s",paddingSize:"none",transparentBackground:!0},e)),[]),d=Object(s.useCallback)((e=>Object(u.jsx)(Zt,{platform:e})),[]),b=Object(s.useCallback)((e=>e?`${e}`:w.i18n.translate("xpack.osquery.pack.queriesTable.osqueryVersionAllLabel",{defaultMessage:"ALL"})),[]),p=Object(s.useMemo)((()=>[{field:"id",name:w.i18n.translate("xpack.osquery.pack.queriesTable.idColumnTitle",{defaultMessage:"ID"}),width:"20%"},{field:"interval",name:w.i18n.translate("xpack.osquery.pack.queriesTable.intervalColumnTitle",{defaultMessage:"Interval (s)"}),width:"100px"},{field:"query",name:w.i18n.translate("xpack.osquery.pack.queriesTable.queryColumnTitle",{defaultMessage:"Query"}),render:c},{field:"platform",name:w.i18n.translate("xpack.osquery.pack.queriesTable.platformColumnTitle",{defaultMessage:"Platform"}),render:d},{field:"version",name:w.i18n.translate("xpack.osquery.pack.queriesTable.versionColumnTitle",{defaultMessage:"Min Osquery version"}),render:b},...t?[]:[{name:w.i18n.translate("xpack.osquery.pack.queriesTable.actionsColumnTitle",{defaultMessage:"Actions"}),width:"120px",actions:[{render:r},{render:o}]}]]),[t,o,r,d,c,b]),m=Object(s.useMemo)((()=>({sort:{field:"id",direction:"asc"}})),[]),x=Object(s.useCallback)((e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""}),[]),O=Object(s.useMemo)((()=>({onSelectionChange:n,initialSelected:l})),[l,n]);return Object(u.jsx)(j.EuiBasicTable,{items:e,itemId:x,columns:p,sorting:m,selection:t?void 0:O})},ta=i.a.memo(ea);var aa=a(126),sa=a(116),ia=a(110),la=a(115);const na=e=>Object(Xt.produce)(e,(e=>(Object(y.isArray)(e.platform)&&(e.platform.length?e.platform.join(","):delete e.platform),Object(y.isArray)(e.version)&&(e.version.length?e.version=e.version[0]:delete e.version),e.interval&&(e.interval=e.interval+""),Object(y.isEmpty)(e.ecs_mapping)&&delete e.ecs_mapping,e)));var oa=a(121),ra=a(91);const ua=({uniqueQueryIds:e,defaultValue:t,onSave:a,onClose:l})=>{const n=Object(N.e)().services.application.capabilities.osquery,[o]=Object(s.useState)(!!t),{serializer:r,idSet:c,...d}=(({uniqueQueryIds:e,defaultValue:t})=>{const a=Object(s.useMemo)((()=>new Set(Object(y.xor)(e,null!=t&&t.id?[t.id]:[]))),[e,t]);return{serializer:na,idSet:a,...Object(qe.useForm)({defaultValues:t?(i=t,{id:i.id,query:i.query,interval:i.interval?parseInt(i.interval,10):3600,timeout:i.timeout||_.f.DEFAULT,snapshot:i.snapshot,removed:i.removed,platform:i.platform,version:i.version?[i.version]:[],ecs_mapping:null!==(l=i.ecs_mapping)&&void 0!==l?l:{}}):{id:"",query:"",interval:3600,snapshot:!0,removed:!1}})};var i,l})({uniqueQueryIds:e,defaultValue:t}),{handleSubmit:b,formState:{isSubmitting:p},resetField:m}=d,x=Object(s.useCallback)((e=>{var t,a;e&&(m("id",{defaultValue:e.id}),m("query",{defaultValue:e.query}),m("platform",{defaultValue:e.platform?e.platform:_.d}),m("version",{defaultValue:e.version?[e.version]:[]}),m("interval",{defaultValue:e.interval?e.interval:3600}),m("timeout",{defaultValue:e.timeout?e.timeout:_.f.DEFAULT}),m("snapshot",{defaultValue:null===(t=e.snapshot)||void 0===t||t}),m("removed",{defaultValue:e.removed}),m("ecs_mapping",{defaultValue:null!==(a=e.ecs_mapping)&&void 0!==a?a:{}}))}),[m]);return Object(u.jsx)(j.EuiFlyout,{size:"m",onClose:l,"aria-labelledby":"flyoutTitle",ownFocus:!0,outsideClickCloses:!1},Object(u.jsx)(j.EuiFlyoutHeader,{hasBorder:!0},Object(u.jsx)(j.EuiTitle,{size:"s"},Object(u.jsx)("h2",{id:"flyoutTitle"},o?Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.editFormTitle",defaultMessage:"Edit query"}):Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.addFormTitle",defaultMessage:"Attach next query"})))),Object(u.jsx)(j.EuiFlyoutBody,null,Object(u.jsx)(qe.FormProvider,d,!o&&n.readSavedQueries?Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(oa.a,{onChange:x}),Object(u.jsx)(j.EuiSpacer,null)):null,Object(u.jsx)(aa.c,{idSet:c}),Object(u.jsx)(j.EuiSpacer,null),Object(u.jsx)(sa.a,null),Object(u.jsx)(j.EuiSpacer,null),Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(aa.a,{euiFieldProps:{append:"s"}}),Object(u.jsx)(j.EuiSpacer,null),Object(u.jsx)(aa.f,{euiFieldProps:{noSuggestions:!1,singleSelection:{asPlainText:!0},placeholder:w.i18n.translate("xpack.osquery.queriesTable.osqueryVersionAllLabel",{defaultMessage:"ALL"}),options:la.a,onCreateOption:void 0}}),Object(u.jsx)(j.EuiSpacer,null),Object(u.jsx)(aa.d,null)),Object(u.jsx)(j.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(ia.a,null)),Object(u.jsx)(j.EuiFlexItem,{grow:0},Object(u.jsx)(aa.e,null)))),Object(u.jsx)(j.EuiSpacer,null),Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(j.EuiFlexItem,{css:At.a},Object(u.jsx)(ra.a,null))))),Object(u.jsx)(j.EuiFlyoutFooter,null,Object(u.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButtonEmpty,{"data-test-subj":"query-flyout-cancel-button",iconType:"cross",onClick:l,flush:"left"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButton,{"data-test-subj":"query-flyout-save-button",isLoading:p,onClick:b((async e=>{const t=r(e);await a(t),l()})),fill:!0},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.saveButtonLabel",defaultMessage:"Save"}))))))},ca=i.a.memo(ua),da=["application/json","text/plain"],ba=i.a.memo((()=>Object(u.jsx)(j.EuiLink,{href:"https://github.com/osquery/osquery/tree/master/packs",target:"_blank"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packUploader.examplePacksLinkLabel",defaultMessage:"Example packs"}))));ba.displayName="ExamplePackLink";const ja=({onChange:e})=>{const t=Object(s.useRef)(""),a=Object(s.useRef)(null),[l,n]=Object(s.useState)(null);let o;const r=()=>{var s,i;const l=o.result;let r;try{r=JSON.parse(l.replaceAll("\\\n",""),((e,t)=>"query"===e?t.replaceAll(/\s(?=\s)/gm,""):"interval"===e?`${t}`:t)),n(null)}catch(e){var u;n(e),null===(u=a.current)||void 0===u||u.removeFiles()}null!==(s=r)&&void 0!==s&&s.queries&&(e(r,t.current),null===(i=a.current)||void 0===i||i.removeFiles())},c=e=>{o=new FileReader,o.onloadend=r,o.readAsText(e)},d=Object(s.useCallback)((e=>{var s;if(e.length){var i;if(e.length&&(null!==(s=!!e[0].type.length&&!da.includes(e[0].type))&&void 0!==s?s:!e[0].name.endsWith(".conf")))return t.current="",n(w.i18n.translate("xpack.osquery.packUploader.unsupportedFileTypeText",{defaultMessage:"File type {fileType} is not supported, please upload {supportedFileTypes} config file",values:{fileType:e[0].type,supportedFileTypes:da.join(" or ")}})),void(null===(i=a.current)||void 0===i||i.removeFiles());t.current=Object(y.kebabCase)(e[0].name.split(".")[0]),c(e[0])}else t.current=""}),[c]);return Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(j.EuiSpacer,{size:"xl"}),Object(u.jsx)(j.EuiFormRow,{fullWidth:!0,labelAppend:Object(u.jsx)(ba,null),isInvalid:!!l,error:Object(u.jsx)(i.a.Fragment,null,`${l}`)},Object(u.jsx)(j.EuiFilePicker,{ref:a,id:"osquery_pack_picker",initialPromptText:w.i18n.translate("xpack.osquery.packUploader.initialPromptTextLabel",{defaultMessage:"Select or drag and drop osquery pack config file"}),onChange:d,display:"large",fullWidth:!0,isInvalid:!!l,accept:da.join(",")})))},pa=i.a.memo(ja);var ma=a(112);const xa=({euiFieldProps:e})=>{const{field:{value:t}}=Object(qe.useController)({name:"queries",defaultValue:[],rules:{}}),{append:a,remove:l,update:n,replace:o}=Object(qe.useFieldArray)({name:"queries"}),{setValue:r}=Object(qe.useFormContext)(),{name:c}=Object(qe.useWatch)(),d=Object(s.useCallback)((e=>Object(y.isEmpty)(c)&&r("name",e)),[c,r]),b=!(null==e||!e.isDisabled),[p,m]=Object(s.useState)(!1),[x,O]=Object(s.useState)(-1),[g,f]=Object(s.useState)([]),v=Object(s.useCallback)((()=>m(!0)),[]),k=Object(s.useCallback)((()=>m(!1)),[]),h=Object(s.useCallback)((()=>O(-1)),[]),E=Object(s.useCallback)((e=>{const a=Object(y.findIndex)(t,["id",e.id]);a>-1&&l(a)}),[t,l]),S=Object(s.useCallback)((e=>{const a=Object(y.findIndex)(t,["id",e.id]);O(a)}),[t]),C=Object(s.useCallback)((e=>new Promise((t=>{x>=0&&n(x,Object(Xt.produce)({},(t=>{var a,s;return t.id=e.id,t.interval=e.interval,t.query=e.query,t.timeout=e.timeout,null!==(a=e.platform)&&void 0!==a&&a.length&&(t.platform=e.platform),null!==(s=e.version)&&void 0!==s&&s.length&&(t.version=e.version),e.ecs_mapping&&(t.ecs_mapping=e.ecs_mapping),t.snapshot=e.snapshot,t.removed=e.removed,t}))),h(),t()}))),[h,n,x]),M=Object(s.useCallback)((e=>new Promise((t=>{a(e),k(),t()}))),[k,a]),q=Object(s.useCallback)((()=>{const e=Object(y.map)(g,(e=>Object(y.indexOf)(t,e)));l(e),f([])}),[t,l,g]),T=Object(s.useCallback)(((e,t)=>{o(Object(y.map)(e.queries,((t,a)=>{var s,i,l,n,o,r,u,c;return Object(y.pickBy)({id:a,interval:null!==(s=null!==(i=t.interval)&&void 0!==i?i:e.interval)&&void 0!==s?s:"3600",timeout:null!==(l=null!==(n=t.timeout)&&void 0!==n?n:e.timeout)&&void 0!==l?l:_.f.DEFAULT,query:t.query,version:null!==(o=t.version)&&void 0!==o?o:e.version,snapshot:null!==(r=t.snapshot)&&void 0!==r?r:e.snapshot,removed:null!==(u=t.removed)&&void 0!==u?u:e.removed,platform:Object(ma.b)(null!==(c=t.platform)&&void 0!==c?c:e.platform)},(e=>!Object(y.isEmpty)(e)||!1===e))}))),d(t)}),[d,o]),F=Object(s.useMemo)((()=>null!=t&&t.length?t:[]),[t]),w=Object(s.useMemo)((()=>Object(y.uniq)(Object(y.map)(t,"id"))),[t]);return Object(u.jsx)(i.a.Fragment,null,!b&&Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(j.EuiFlexGroup,{justifyContent:"flexEnd"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},g.length?Object(u.jsx)(j.EuiButton,{color:"danger",onClick:q,iconType:"trash"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.pack.table.deleteQueriesButtonLabel",defaultMessage:"Delete {queriesCount, plural, one {# query} other {# queries}}",values:{queriesCount:g.length}})):Object(u.jsx)(j.EuiButton,{"data-test-subj":"add-query-button",fill:!0,onClick:v,iconType:"plusInCircle"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.pack.queriesForm.addQueryButtonLabel",defaultMessage:"Add query"})))),Object(u.jsx)(j.EuiSpacer,null)),null!=t&&t.length?Object(u.jsx)(ta,{data:F,isReadOnly:b,onEditClick:S,onDeleteClick:E,selectedItems:g,setSelectedItems:f}):null,Object(u.jsx)(j.EuiSpacer,null),!b&&Object(u.jsx)(pa,{onChange:T}),p&&Object(u.jsx)(ca,{uniqueQueryIds:w,onSave:M,onClose:k}),null!=x&&x>=0&&Object(u.jsx)(ca,{uniqueQueryIds:w,defaultValue:t[x],onSave:C,onClose:h}))},Oa=i.a.memo(xa,fe.a),ga=e=>Object(y.reduce)(e,((e,{id:t,...a})=>(e[t]=a,e)),{}),fa=({euiFieldProps:e})=>{const{field:{onChange:t,value:a,name:i},fieldState:{error:l}}=Object(qe.useController)({name:"name",defaultValue:"",rules:{pattern:{value:/^[a-zA-Z0-9-_]+$/,message:w.i18n.translate("xpack.osquery.pack.queryFlyoutForm.invalidIdError",{defaultMessage:"Characters must be alphanumeric, _, or -"})},required:w.i18n.translate("xpack.osquery.pack.form.nameFieldRequiredErrorMessage",{defaultMessage:"Name is a required field"})}}),n=Object(s.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return Object(u.jsx)(j.EuiFormRow,{label:w.i18n.translate("xpack.osquery.pack.form.nameFieldLabel",{defaultMessage:"Name"}),error:null==l?void 0:l.message,isInvalid:n,fullWidth:!0},Object(u.jsx)(j.EuiFieldText,h()({isInvalid:n,onChange:t,value:a,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},va=i.a.memo(fa),ya=({euiFieldProps:e})=>{const{field:{onChange:t,value:a,name:i},fieldState:{error:l}}=Object(qe.useController)({name:"description",defaultValue:""}),n=Object(s.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return Object(u.jsx)(j.EuiFormRow,{label:w.i18n.translate("xpack.osquery.pack.form.descriptionFieldLabel",{defaultMessage:"Description (optional)"}),error:null==l?void 0:l.message,isInvalid:n,fullWidth:!0},Object(u.jsx)(j.EuiFieldText,h()({isInvalid:n,onChange:t,value:a,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},ka=i.a.memo(ya),ha=Ut()(j.EuiCard,{target:"e2j9yjr0"})("padding:16px 92px 16px 16px!important;border:",(({theme:e,selectable:t})=>{if(null!=t&&t.isSelected)return`${e.euiTheme.border.width.thin} solid ${e.euiTheme.colors.success}`}),";.euiTitle{font-size:1rem;}.euiSpacer{display:none;}.euiText{margin-top:0;margin-left:25px;color:",(({theme:e})=>e.euiTheme.colors.subduedText),";}>button[role='switch']{display:none;}"),Ea=({packType:e,setPackType:t,resetFormFields:a})=>{const i=Object(s.useCallback)((e=>{t(e),a&&a()}),[a,t]),l=Object(s.useMemo)((()=>({onClick:()=>i("policy"),isSelected:"policy"===e})),[e,i]),n=Object(s.useMemo)((()=>({onClick:()=>i("global"),isSelected:"global"===e})),[e,i]);return Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiFormRow,{label:"Type",fullWidth:!0},Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(ha,h()({layout:"horizontal",title:Object(u.jsx)(j.EuiRadio,{id:"osquery_pack_type_policy",label:w.i18n.translate("xpack.osquery.pack.form.policyLabel",{defaultMessage:"Policy"}),onChange:y.noop,checked:"policy"===e}),titleSize:"xs",hasBorder:!0,description:w.i18n.translate("xpack.osquery.pack.form.policyDescription",{defaultMessage:"Schedule pack for specific policy."}),"data-test-subj":"osqueryPackTypePolicy",selectable:l},"policy"===e&&{color:"primary"}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(ha,h()({layout:"horizontal",title:Object(u.jsx)(j.EuiRadio,{id:"osquery_pack_type_global",label:w.i18n.translate("xpack.osquery.pack.form.globalLabel",{defaultMessage:"Global"}),onChange:y.noop,checked:"global"===e}),titleSize:"xs",description:w.i18n.translate("xpack.osquery.pack.form.globalDescription",{defaultMessage:"Use pack across all policies"}),selectable:n,"data-test-subj":"osqueryPackTypeGlobal"},"global"===e&&{color:"primary"}))))))},Sa=i.a.memo(Ea),Ca=({euiTheme:e})=>({".euiAccordion__button":{color:e.colors.primary}}),Ma=({defaultValue:e,editMode:t=!1,isReadOnly:a=!1})=>{const[l,n]=Object(s.useState)("closed"),o=Object(s.useCallback)((e=>{n(e?"open":"closed")}),[]),[r,c]=Object(s.useState)("policy"),[b,p]=Object(s.useState)(!1),m=Object(s.useCallback)((()=>p(!1)),[]),{data:{agentPoliciesById:x}={}}=Object(It.a)(),O=Object(N.f)(`packs/${t?null==e?void 0:e.id:""}`),{mutateAsync:g}=(({withRedirect:e})=>{const t=Object(d.useQueryClient)(),{application:{navigateToApp:a},http:s,notifications:{toasts:i}}=Object(N.e)().services,l=Object(He.a)();return Object(d.useMutation)((e=>s.post("/api/osquery/packs",{version:_.a.public.v1,body:JSON.stringify(e)})),{onError:e=>{l(e,{title:e.body.error,toastMessage:e.body.message})},onSuccess:s=>{var l,n;t.invalidateQueries([Ke.a]),e&&a(Xe.PLUGIN_ID,{path:I.a.packs()}),i.addSuccess(w.i18n.translate("xpack.osquery.newPack.successToastMessageText",{defaultMessage:'Successfully created "{packName}" pack',values:{packName:null!==(l=null===(n=s.data)||void 0===n?void 0:n.name)&&void 0!==l?l:""}}))}})})({withRedirect:!0}),{mutateAsync:f}=Ye({withRedirect:!0}),v=Object(qe.useForm)({defaultValues:e?(e=>{var t;const a=Object(y.filter)(e.policy_ids,(t=>{var a;return null==(null===(a=e.shards)||void 0===a?void 0:a[t])}));return{...e,policy_ids:null!=a?a:[],queries:(s=e.queries,Object(y.reduce)(s,((e,t,a)=>(e.push({id:a,...Object(y.pick)(t,["query","interval","timeout","snapshot","removed","platform","version","ecs_mapping"])}),e)),[])),shards:null!==(t=Object(y.omit)(e.shards,"*"))&&void 0!==t?t:{}};var s})(e):{name:"",description:"",policy_ids:[],enabled:!0,queries:[]}});Object(s.useEffect)((()=>{var t;Object(y.isEmpty)(null==e?void 0:e.shards)||(null!=e&&null!==(t=e.shards)&&void 0!==t&&t["*"]?c("global"):n("open"))}),[e,null==e?void 0:e.shards]);const{handleSubmit:k,watch:E,formState:{isSubmitting:S}}=v,{policy_ids:C,shards:M}=E(),q=Object(s.useCallback)((()=>"global"===r?{"*":100}:Object(y.reduce)(M,((e,t,a)=>Object(y.isEmpty)(a)?e:{...e,[a]:t}),{})),[r,M]),T=Object(s.useCallback)((async a=>{const s=({shards:e,policy_ids:t,queries:a,...s})=>{var i;const l=[...t,...Object(y.isEmpty)(M)?[]:Object(y.filter)(Object(y.map)(M,((e,t)=>{if(!Object(y.isEmpty)(t))return t})))];return{...s,policy_ids:null!=l?l:[],queries:ga(a),shards:null!==(i=q())&&void 0!==i?i:{}}};try{t&&null!=e&&e.saved_object_id?await f({id:null==e?void 0:e.saved_object_id,...s(a)}):await g(s(a))}catch(e){}}),[g,null==e?void 0:e.saved_object_id,t,q,M,f]),F=Object(s.useMemo)((()=>k(T)),[k,T]),P=Object(s.useMemo)((()=>Object(y.reduce)(C,((e,t)=>{var a;const s=x&&x[t];return e+(null!==(a=null==s?void 0:s.agents)&&void 0!==a?a:0)}),0)),[C,x]),L=Object(s.useCallback)((()=>{P?p(!0):F()}),[P,F]),B=Object(s.useCallback)((()=>{F(),p(!1)}),[F]),Q=Object(s.useMemo)((()=>({isDisabled:a})),[a]),z=Object(s.useCallback)((e=>{c(e)}),[c]),D=Object(s.useMemo)((()=>Object.entries(null!=x?x:{}).map((([e,t])=>({key:e,label:t.name})))),[x]),R=Object(s.useMemo)((()=>{const e=[...Object(y.map)(M,((e,t)=>t)),...Object(y.map)(C,(e=>e))];return D.filter((({key:t})=>!e.includes(t)))}),[M,C,D]);return Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(qe.FormProvider,v,Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(va,{euiFieldProps:Q}))),Object(u.jsx)(j.EuiSpacer,{size:"m"}),Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(ka,{euiFieldProps:Q}))),Object(u.jsx)(j.EuiSpacer,{size:"m"}),Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(Sa,{packType:r,setPackType:z})),Object(u.jsx)(j.EuiSpacer,{size:"m"}),"policy"===r&&Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(j.EuiFlexItem,{css:At.a},Object(u.jsx)(Ht,{options:R}))),Object(u.jsx)(j.EuiSpacer,{size:"m"}),Object(u.jsx)(j.EuiFlexGroup,null,Object(u.jsx)(j.EuiFlexItem,{css:At.a},Object(u.jsx)(j.EuiAccordion,{css:Ca,id:"shardsToggle",forceState:l,onToggle:o,buttonContent:"Partial deployment (shards)"},Object(u.jsx)(j.EuiSpacer,{size:"xs"}),Object(u.jsx)(Gt,{options:R})))),Object(u.jsx)(j.EuiSpacer,{size:"m"})),Object(u.jsx)(j.EuiSpacer,{size:"xl"}),Object(u.jsx)(j.EuiHorizontalRule,null),Object(u.jsx)(Oa,{euiFieldProps:Q})),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(j.EuiBottomBar,null,Object(u.jsx)(j.EuiFlexGroup,{justifyContent:"flexEnd"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButtonEmpty,h()({color:"text"},O),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.pack.form.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiButton,{isLoading:S,color:"primary",fill:!0,size:"m",iconType:"save",onClick:L,"data-test-subj":(t?"update":"save")+"-pack-button"},t?Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.pack.form.updatePackButtonLabel",defaultMessage:"Update pack"}):Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.pack.form.savePackButtonLabel",defaultMessage:"Save pack"}))))))),b&&Object(u.jsx)(We,{onCancel:m,onConfirm:B,agentCount:P,agentPolicyCount:C.length}))},qa=i.a.memo(Ma,fe.a),Ta=()=>{B("pack_add");const e=Object(N.f)("packs"),t=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,h()({iconType:"arrowLeft"},e,{flush:"left",size:"xs"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.addPack.viewPacksListTitle",defaultMessage:"View all packs"}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.addPack.pageTitle",defaultMessage:"Add pack"})))))),[e]);return Object(u.jsx)(Z,{leftColumn:t},Object(u.jsx)(qa,null))},Fa=i.a.memo(Ta);var wa=a(82);const _a=()=>{var e,t;const{packId:a}=Object(o.useParams)(),l=Object(N.f)(`packs/${a}`),[n,r]=Object(s.useState)(!1),{isLoading:c,data:b}=Object(wa.a)({packId:a}),p=(({packId:e,withRedirect:t})=>{const a=Object(d.useQueryClient)(),{application:{navigateToApp:s},http:i,notifications:{toasts:l}}=Object(N.e)().services,n=Object(He.a)();return Object(d.useMutation)((()=>i.delete(`/api/osquery/packs/${e}`,{version:_.a.public.v1})),{onError:e=>{n(e,{title:e.body.error,toastMessage:e.body.message})},onSuccess:()=>{a.invalidateQueries([Ke.a]),t&&s(Xe.PLUGIN_ID,{path:I.a.packs()}),l.addSuccess(w.i18n.translate("xpack.osquery.deletePack.successToastMessageText",{defaultMessage:"Successfully deleted pack"}))}})})({packId:a,withRedirect:!0}),m=Object(s.useMemo)((()=>!(null==b||!b.read_only)),[b]);B("pack_edit",{packId:null!==(e=null==b?void 0:b.id)&&void 0!==e?e:"",packName:null!==(t=null==b?void 0:b.name)&&void 0!==t?t:""});const x=Object(s.useCallback)((()=>{r(!1)}),[]),O=Object(s.useCallback)((()=>{r(!0)}),[]),g=Object(s.useCallback)((()=>{p.mutateAsync().then((()=>{x()}))}),[p,x]),f=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,h()({iconType:"arrowLeft"},l,{flush:"left",size:"xs"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editPack.viewPackListTitle",defaultMessage:"View {queryName} details",values:{queryName:null==b?void 0:b.name}}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editPack.pageTitle",defaultMessage:"Edit {queryName}",values:{queryName:null==b?void 0:b.name}})))))),[null==b?void 0:b.name,l]),v=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiButton,{color:"danger",onClick:O,iconType:"trash"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editPack.deletePackButtonLabel",defaultMessage:"Delete pack"}))),[O]),y=Object(s.useMemo)((()=>m?Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(j.EuiSpacer,null),Object(u.jsx)(j.EuiCallOut,null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.editPack.prebuiltPackModeDescription",defaultMessage:"This is a prebuilt Elastic pack. You can modify the scheduled agent policies, but you cannot edit queries in the pack."}))):null),[m]);return c?null:Object(u.jsx)(Z,{leftColumn:f,rightColumn:v,rightColumnGrow:!1,headerChildren:y},b?Object(u.jsx)(qa,{editMode:!0,defaultValue:b,isReadOnly:m}):Object(u.jsx)(j.EuiSkeletonText,{lines:10}),n?Object(u.jsx)(j.EuiConfirmModal,{title:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.title",defaultMessage:"Are you sure you want to delete this pack?"}),onCancel:x,onConfirm:g,confirmButtonDisabled:p.isLoading,cancelButtonText:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.confirmButtonLabel",defaultMessage:"Confirm"}),buttonColor:"danger",defaultFocusedButton:"confirm"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.body",defaultMessage:"You're about to delete this pack. Are you sure you want to do this?"})):null)},Ia=i.a.memo(_a);var Na=a(129);const Pa=({euiTheme:e})=>({width:0,height:"100%",borderLeft:e.border.thin}),La=()=>{var e,t;const a=Object(N.e)().services.application.capabilities.osquery,{packId:i}=Object(o.useParams)(),l=Object(N.f)("packs"),n=Object(N.f)(`packs/${i}/edit`),{data:r}=Object(wa.a)({packId:i}),{data:c}=(({agentPolicyId:e,silent:t,skip:a})=>{const{http:s}=Object(N.e)().services,i=Object(He.a)();return Object(d.useQuery)(["agentPolicyAgentIds",e],(()=>{const t=`${tt.AGENTS_PREFIX}.policy_id:${e}`;return s.get("/internal/osquery/fleet_wrapper/agents",{version:_.a.internal.v1,query:{kuery:t,perPage:1e4}})}),{select:e=>Object(y.map)(null==e?void 0:e.agents,"id")||[],enabled:!a||!e,onSuccess:()=>i(),onError:e=>!t&&i(e,{title:w.i18n.translate("xpack.osquery.agents.fetchError",{defaultMessage:"Error while fetching agents"})}),refetchOnReconnect:!1,refetchOnWindowFocus:!1})})({agentPolicyId:null==r||null===(e=r.policy_ids)||void 0===e?void 0:e[0],skip:!r});B("pack_details",{packName:null!==(t=null==r?void 0:r.name)&&void 0!==t?t:""});const b=Object(s.useMemo)((()=>{var e;return null!==(e=(null==r?void 0:r.queries)&&Object.entries(r.queries).map((([e,t])=>({...t,id:e}))))&&void 0!==e?e:[]}),[r]),p=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,h()({iconType:"arrowLeft"},l,{flush:"left",size:"xs"}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packDetails.viewAllPackListTitle",defaultMessage:"View all packs"}))),Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiText,null,Object(u.jsx)("h1",null,Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packDetails.pageTitle",defaultMessage:"{queryName} details",values:{queryName:null==r?void 0:r.name}})))),(null==r?void 0:r.description)&&Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiSpacer,{size:"s"}),Object(u.jsx)(j.EuiText,{color:"subdued",size:"s"},r.description)))),[null==r?void 0:r.description,null==r?void 0:r.name,l]),m=Object(s.useMemo)((()=>Object(u.jsx)(j.EuiFlexGroup,{justifyContent:"flexEnd",direction:"row"},Object(u.jsx)(j.EuiFlexItem,{grow:!1,key:"agents_failed_count"},Object(u.jsx)(j.EuiDescriptionList,{compressed:!0,textStyle:"reverse",style:{textAlign:"right"}},Object(u.jsx)(j.EuiDescriptionListTitle,{className:"eui-textNoWrap"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packDetailsPage.kpis.policiesLabelText",defaultMessage:"Policies"})),Object(u.jsx)(j.EuiDescriptionListDescription,{className:"eui-textNoWrap"},Object(u.jsx)(bt,{agentPolicyIds:null==r?void 0:r.policy_ids})))),Object(u.jsx)(j.EuiFlexItem,{grow:!1,key:"agents_failed_count_divider"},Object(u.jsx)("div",{css:Pa})),Object(u.jsx)(j.EuiFlexItem,{grow:!1,key:"edit_button"},Object(u.jsx)(j.EuiButton,h()({"data-test-subj":"edit-pack-button",fill:!0},n,{iconType:"pencil",isDisabled:!a.writePacks}),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.packDetailsPage.editQueryButtonLabel",defaultMessage:"Edit"}))))),[null==r?void 0:r.policy_ids,n,a]);return Object(u.jsx)(Z,{leftColumn:p,rightColumn:m,rightColumnGrow:!1},r&&Object(u.jsx)(Na.a,{agentIds:c,packName:r.name,data:b}))},Ba=i.a.memo(La),Aa=()=>{const e=Object(N.e)().services.application.capabilities.osquery;B("packs");const t=Object(o.useRouteMatch)();return e.readPacks?Object(u.jsx)(F,null,Object(u.jsx)(q,{path:`${t.url}/add`},e.writePacks?Object(u.jsx)(Fa,null):Object(u.jsx)(je.a,null)),Object(u.jsx)(q,{path:`${t.url}/:packId/edit`},e.writePacks?Object(u.jsx)(Ia,null):Object(u.jsx)(je.a,null)),Object(u.jsx)(q,{path:`${t.url}/:packId`},Object(u.jsx)(Ba,null)),Object(u.jsx)(q,{path:`${t.url}`},Object(u.jsx)(wt,null))):Object(u.jsx)(je.a,null)},Qa=i.a.memo(Aa),za=()=>(B("base"),Object(u.jsx)(F,null,Object(u.jsx)(q,{path:"/packs"},Object(u.jsx)(Qa,null)),Object(u.jsx)(q,{path:"/saved_queries"},Object(u.jsx)($e,null)),Object(u.jsx)(q,{path:"/live_queries"},Object(u.jsx)(me,null)),Object(u.jsx)(o.Redirect,{to:"/live_queries"}))),Da=i.a.memo(za);a(48);var Ra=a(20),Ga=a.n(Ra);a(169),a(160);const $a=e=>{const{className:t,size:a,...s}=e,i={};return(e=>void 0===e.iconType)(e)&&(i.iconType=`logo${e.name.replace(/\s+/g,"")}`),Object(u.jsx)(j.EuiAvatar,h()({className:Ga()("kbnSolutionAvatar",{[`kbnSolutionAvatar--${a}`]:a},t),size:"xxl"===a?"xl":a,iconSize:a,color:"plain"},s,i))};a(174);const Ua=w.i18n.translate("sharedUXPackages.solutionNav.collapsibleLabel",{defaultMessage:"Collapse side navigation"}),Va=w.i18n.translate("sharedUXPackages.solutionNav.openLabel",{defaultMessage:"Open side navigation"}),Wa=({className:e,isCollapsed:t,...a})=>{const s=Ga()("kbnSolutionNavCollapseButton",{"kbnSolutionNavCollapseButton-isCollapsed":t},e);return Object(u.jsx)(j.EuiButtonIcon,h()({className:s,size:"s",color:"text",iconType:t?"menuRight":"menuLeft","aria-label":t?Va:Ua,title:t?Va:Ua},a))},Ha="248px",Xa=(e,t)=>e.map((e=>(e.tabIndex=t?-1:void 0,e.items=e.items&&Xa(e.items,t),e))),Ka=Object(j.htmlIdGenerator)("SolutionNav"),Ya=({children:e,headingProps:t,icon:a,isOpenOnDesktop:l=!1,items:n,mobileBreakpoints:o=["xs","s"],closeFlyoutButtonPosition:r="outside",name:c,onCollapse:d,canBeCollapsed:b=!0,...p})=>{const m=Object(j.useIsWithinBreakpoints)(o),x=Object(j.useIsWithinBreakpoints)(["m"]),O=Object(j.useIsWithinMinBreakpoint)("l"),[g,f]=Object(s.useState)(!1),v=O&&!l&&b,y=!!e,k=Ga()("kbnSolutionNav",{"kbnSolutionNav--hidden":v}),E=(null==t?void 0:t.id)||Ka("heading"),S=(null==t?void 0:t.element)||"h2",C=Object(u.jsx)(j.EuiTitle,{size:"xs",id:E,"data-test-subj":null==t?void 0:t["data-test-subj"],className:"kbnSolutionNav__title"},Object(u.jsx)(S,null,a&&Object(u.jsx)($a,{className:"kbnSolutionNav__titleAvatar",iconType:a,name:c}),Object(u.jsx)("strong",null,Object(u.jsx)(A.FormattedMessage,{id:"sharedUXPackages.solutionNav.mobileTitleText",defaultMessage:"{solutionName} {menuText}",values:{solutionName:c||"Navigation",menuText:m?w.i18n.translate("sharedUXPackages.solutionNav.menuText",{defaultMessage:"menu"}):""}})))),M=Object(s.useMemo)((()=>y?e:n?Object(u.jsx)(j.EuiSideNav,h()({"aria-labelledby":E,"aria-hidden":v,items:Xa(n,v),mobileBreakpoints:[]},p)):null),[e,E,y,v,n,p]),{euiTheme:q}=Object(j.useEuiTheme)(),T=Object(s.useMemo)((()=>O?l?Ha:q.size.xxl:x?g||!b?Ha:q.size.xxl:"0"),[q,l,g,b,x,O]),{setGlobalCSSVariables:F}=Object(j.useEuiThemeCSSVariables)();return Object(s.useEffect)((()=>{F({"--kbnSolutionNavOffset":T})}),[T,F]),Object(u.jsx)(i.a.Fragment,null,m&&Object(u.jsx)(j.EuiCollapsibleNavGroup,{className:k,paddingSize:"none",background:"none",title:C,titleElement:"span",isCollapsible:b,initialIsOpen:!1},Object(u.jsx)(j.EuiPanel,{color:"transparent",paddingSize:"s"},M)),x&&Object(u.jsx)(i.a.Fragment,null,(g||!b)&&Object(u.jsx)(j.EuiFlyout,{ownFocus:!1,outsideClickCloses:!0,onClose:()=>f(!1),side:"left",size:248,closeButtonPosition:r,className:"kbnSolutionNav__flyout",hideCloseButton:!b},Object(u.jsx)(j.EuiPageSidebar,{className:k,hasEmbellish:!0},C,Object(u.jsx)(j.EuiSpacer,{size:"l"}),M)),b&&Object(u.jsx)(Wa,{isCollapsed:!0,onClick:()=>{f(!g)}})),O&&Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)("div",{className:k},C,Object(u.jsx)(j.EuiSpacer,{size:"l"}),M),b&&Object(u.jsx)(Wa,{isCollapsed:!l,onClick:d})))};var Ja=a(166);const Za="solutionNavIsCollapsed",es=e=>{const t=t=>{var a;const i=Object(j.useIsWithinBreakpoints)(["m"]),l=Object(j.useIsWithinMinBreakpoint)("l"),[n,o]=Object(s.useState)(!JSON.parse(String(localStorage.getItem(Za)))),{solutionNav:r,children:c,...d}=t,{euiTheme:b}=Object(j.useEuiTheme)(),{canBeCollapsed:p=!0}=r,m=i||p&&l&&!n,x=(e=>Object(Ja.css)("flex:0 1 0;overflow:hidden;",j.euiCanAnimate,"{transition:min-width ",e.animation.fast," ",e.animation.resistance,";}",""))(b),O=Ga()("kbnSolutionNav__sidebar",{"kbnSolutionNav__sidebar--shrink":m},null===(a=t.pageSideBarProps)||void 0===a?void 0:a.className,x),g=Object(u.jsx)(Ya,h()({isOpenOnDesktop:n,onCollapse:()=>{o(!n),localStorage.setItem(Za,JSON.stringify(n))}},r)),f={paddingSize:"none",...t.pageSideBarProps,minWidth:m?b.size.xxl:void 0,className:O,hasEmbellish:!m};return Object(u.jsx)(e,h()({},d,{pageSideBar:g,pageSideBarProps:f}),c)};var a;return t.displayName=`WithSolutionNavBar(${a=e,a.displayName||a.name||"UnnamedComponent"})`,t},ts=i.a.createContext(null),as={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},ss=({children:e,navigateToUrl:t,currentAppId:a,...i})=>{const l=Object(s.useRef)(null),n=Object(s.useCallback)((e=>(({event:e,container:t,navigateToUrl:a,currentAppId:s})=>{if(!t||!s)return;const i=((e,t)=>{let a=e;do{var s,i;if("a"===(null===(s=a)||void 0===s?void 0:s.tagName.toLowerCase()))return a;const e=null===(i=a)||void 0===i?void 0:i.parentElement;if(!e||e===document.body||e===t)break;a=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!i)return;const l=i.href,n=""===i.target||"_self"===i.target,o=0===e.button;l&&n&&o&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),a(i.href))})({event:e,currentAppId:a,navigateToUrl:t,container:l.current})),[a,t]);return Object(u.jsx)("div",h()({onClick:n,ref:l,css:as,"data-test-subj":"kbnRedirectAppLink"},i),e)},is=({children:e,...t})=>Object(u.jsx)(ss,h()({},function(){const e=Object(s.useContext)(ts);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e);var ls=a(165),ns=a.n(ls);const os=w.i18n.translate("sharedUXPackages.card.noData.noPermission.title",{defaultMessage:"Contact your administrator"}),rs=w.i18n.translate("sharedUXPackages.card.noData.noPermission.description",{defaultMessage:"This integration is not yet enabled. Your administrator has the required permissions to turn it on."}),us=w.i18n.translate("sharedUXPackages.card.noData.title",{defaultMessage:"Add Elastic Agent"}),cs=w.i18n.translate("sharedUXPackages.card.noData.description",{defaultMessage:"Use Elastic Agent for a simple, unified way to collect data from your machines."}),ds=()=>Object(u.jsx)(j.EuiImage,{size:"fullWidth",style:{width:"max(100%, 360px)",height:240,objectFit:"cover",background:"aliceblue"},url:ns.a,alt:""}),bs=({title:e,description:t,canAccessFleet:a,button:s,href:i,...l})=>Object(u.jsx)(j.EuiCard,h()({css:{maxWidth:400,marginInline:"auto"},paddingSize:"l",title:a?Object(u.jsx)(j.EuiScreenReaderOnly,null,Object(u.jsx)("span",null,e||us)):Object(u.jsx)(j.EuiTextColor,{color:"default"},os),description:a?t||cs:Object(u.jsx)(j.EuiTextColor,{color:"default"},rs),footer:(()=>{if(a)return s&&"string"!=typeof s?s:Object(u.jsx)(j.EuiButton,{fill:!0,href:i,"data-test-subj":"noDataDefaultFooterAction"},s||e||us)})(),isDisabled:!a,href:i,image:Object(u.jsx)(ds,null)},l)),js=i.a.createContext(null),ps=({href:e,category:t,description:a,...i})=>{var l;const{canAccessFleet:n,addBasePath:o}=function(){const e=Object(s.useContext)(js);if(!e)throw new Error("NoDataCard Context is missing.  Ensure your component or React root is wrapped with NoDataCardContext.");return e}(),r=Object(s.useMemo)((()=>{if(e)return e;const a="/app/integrations/browse";return o(t?`${a}/${t}`:a)}),[o,e,t]);return Object(u.jsx)(is,null,Object(u.jsx)(bs,h()({},i,{href:r,canAccessFleet:null!==(l=i.canAccessFleet)&&void 0!==l?l:n,description:a})))},ms=({action:e})=>{const t=Object.keys(e);if(1!==t.length)return null;const a=t[0],s="elasticAgent"===a?"empty-page-agent-action":`empty-page-${a}-action`;return Object(u.jsx)(ps,h()({key:s},e[a]))},xs=({solution:e,logo:t,action:a,docsLink:s,pageTitle:i,pageDescription:l,className:n})=>{const o=i||w.i18n.translate("sharedUXPackages.noDataPage.welcomeTitle",{defaultMessage:"Welcome to Elastic {solution}!",values:{solution:e}}),r=s?Object(u.jsx)(j.EuiLink,{href:s,target:"_blank"},Object(u.jsx)(A.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro.link",defaultMessage:"learn more"})):null,c=null!=l?l:r?Object(u.jsx)(A.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro",defaultMessage:"Add your data to get started, or {link} about {solution}.",values:{solution:e,link:r}}):Object(u.jsx)(A.FormattedMessage,{id:"sharedUXPackages.noDataPage.introNoDocLink",defaultMessage:"Add your data to get started."});return Object(u.jsx)(j.EuiPageTemplate.Section,{alignment:"center",grow:!0,className:Ga()("kbnNoDataPageContents",n),"data-test-subj":"kbnNoDataPage"},Object(u.jsx)(j.EuiText,{textAlign:"center"},Object(u.jsx)($a,{name:e,iconType:t||`logo${e}`,size:"xxl"}),Object(u.jsx)(j.EuiSpacer,{size:"l"}),Object(u.jsx)("h1",null,o),Object(u.jsx)(j.EuiTextColor,{color:"subdued"},Object(u.jsx)("p",null,c))),Object(u.jsx)(j.EuiSpacer,{size:"xxl"}),Object(u.jsx)(ms,{action:a}))},Os=e=>{const{className:t,noDataConfig:a,pageSideBar:s,pageSideBarProps:i,...l}=e;if(!a)return null;let n;s&&(n=Object(u.jsx)(j.EuiPageTemplate.Sidebar,i,s));const o=((e,t)=>Ga()("kbnPageTemplate","",t||""))(0,t);return Object(u.jsx)(j.EuiPageTemplate,h()({className:o,restrictWidth:950,panelled:!1,offset:0,minHeight:0},l),n,Object(u.jsx)(xs,a))},gs=es(Os),fs=({className:e,pageHeader:t,children:a,isEmptyState:s,pageSideBar:i,pageSideBarProps:l,emptyPageBody:n,...o})=>{let r,c;if(s&&t&&!a){const{iconType:e,pageTitle:s,description:i,rightSideItems:l}=t,n=s?Object(u.jsx)("h1",null,s):void 0,o=i?Object(u.jsx)("p",null,i):void 0;a=Object(u.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:e,iconColor:"",title:n,body:o,actions:l})}else t&&(r=Object(u.jsx)(j.EuiPageTemplate.Header,t));if(s&&n&&(a=n),i){const e={...l};e.sticky=!0,c=Object(u.jsx)(j.EuiPageTemplate.Sidebar,e,i)}const d=((e,t)=>Ga()("kbnPageTemplate","",t||""))(0,e);return Object(u.jsx)(j.EuiPageTemplate,h()({className:d,offset:0,minHeight:r?"calc(100vh - var(--kbnAppHeadersOffset, var(--euiFixedHeadersOffset, 0)))":0,grow:!r&&void 0},o),c,r,a)},vs=es(fs),ys=Object.assign((({className:e,children:t,solutionNav:a,noDataConfig:s,...i})=>s&&a?Object(u.jsx)(gs,{"data-test-subj":i["data-test-subj"],className:e,noDataConfig:s,solutionNav:a}):s?Object(u.jsx)(Os,{"data-test-subj":i["data-test-subj"],className:e,noDataConfig:s}):a?Object(u.jsx)(vs,h()({className:e,solutionNav:a,children:t},i)):Object(u.jsx)(fs,h()({className:e,children:t},i))),{Sidebar:j.EuiPageTemplate.Sidebar,Header:j.EuiPageTemplate.Header,Section:j.EuiPageTemplate.Section,BottomBar:j.EuiPageTemplate.BottomBar,EmptyPrompt:j.EuiPageTemplate.EmptyPrompt}),ks=()=>{B("base");const{application:{getUrlForApp:e,navigateToApp:t}}=Object(N.e)().services,a=Object(s.useMemo)((()=>e(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_overview({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})),[e]),i=Object(s.useCallback)((e=>{if(!Object(N.d)(e)&&Object(N.c)(e))return e.preventDefault(),t(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_overview({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})}),[t]),l=Object(s.useMemo)((()=>({iconType:Mt.a,pageTitle:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.emptyState.pageTitle",defaultMessage:"Add Osquery Manager"}),description:Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.emptyState.pageDescription",defaultMessage:"Add this integration to run and schedule queries for Elastic Agent."}),rightSideItems:[Object(u.jsx)(j.EuiButton,{key:"button",fill:!0,href:a,onClick:i,iconType:"plusInCircleFilled","data-test-subj":"osquery-add-integration-button"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.emptyState.addOsqueryManagerButton",defaultMessage:"Add Osquery Manager"}))]})),[i,a]);return Object(u.jsx)(ys,{isEmptyState:!0,pageHeader:l})},hs=i.a.memo(ks),Es=()=>{const{application:{getUrlForApp:e,navigateToApp:t}}=Object(N.e)().services,a=Object(s.useMemo)((()=>e(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_policies({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})),[e]),i=Object(s.useCallback)((e=>{if(!Object(N.d)(e)&&Object(N.c)(e))return e.preventDefault(),t(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_policies({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})}),[t]);return a?Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,{iconType:"gear",href:a,onClick:i},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.appNavigation.manageIntegrationButton",defaultMessage:"Manage integration"}))):null},Ss=i.a.memo(Es);var Cs=function(e){return e.LiveQueries="live_queries",e.Packs="packs",e.SavedQueries="saved_queries",e}(Cs||{});const Ms=()=>{const e=Object(o.useLocation)(),t=Object(s.useMemo)((()=>{var t;return null!==(t=e.pathname.split("/")[1])&&void 0!==t?t:"overview"}),[e.pathname]);return Object(u.jsx)("div",{css:v},Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"l",alignItems:"center"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiTabs,{bottomBorder:!1},Object(u.jsx)(j.EuiTab,h()({isSelected:t===Cs.LiveQueries},Object(N.f)(Cs.LiveQueries)),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.appNavigation.liveQueriesLinkText",defaultMessage:"Live queries"})),Object(u.jsx)(j.EuiTab,h()({isSelected:t===Cs.Packs},Object(N.f)(Cs.Packs)),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.appNavigation.packsLinkText",defaultMessage:"Packs"})),Object(u.jsx)(j.EuiTab,h()({isSelected:t===Cs.SavedQueries},Object(N.f)(Cs.SavedQueries)),Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.appNavigation.savedQueriesLinkText",defaultMessage:"Saved queries"})))),Object(u.jsx)(j.EuiFlexItem,{grow:!1},Object(u.jsx)(j.EuiFlexGroup,{gutterSize:"s",direction:"row"},Object(u.jsx)(j.EuiFlexItem,null,Object(u.jsx)(j.EuiButtonEmpty,{iconType:"popout",href:"https://ela.st/osquery-feedback",target:"_blank"},Object(u.jsx)(A.FormattedMessage,{id:"xpack.osquery.appNavigation.sendFeedbackButton",defaultMessage:"Send feedback"}))),Object(u.jsx)(Ss,null)))))},qs=()=>{const{customBranding:e}=Object(p.useKibana)().services,{data:t,isFetched:a}=(()=>{const{http:e}=Object(N.e)().services,t=Object(He.a)();return Object(d.useQuery)(["integration"],(()=>e.get("/internal/osquery/status",{version:_.a.internal.v1})),{onError:e=>t(e,{title:w.i18n.translate("xpack.osquery.osquery_integration.fetchError",{defaultMessage:"Error while fetching osquery integration"})}),refetchOnReconnect:!1,refetchOnWindowFocus:!1})})(),s=x()((null==e?void 0:e.hasCustomBranding$)||Object(O.of)(!1),!1);return a?a&&"installed"!==(null==t?void 0:t.install_status)?Object(u.jsx)(hs,null):Object(u.jsx)("div",{css:g,id:"osquery-app"},Object(u.jsx)("div",{css:f},Object(u.jsx)(Ms,null),Object(u.jsx)(Da,null))):Object(u.jsx)(j.EuiPage,{paddingSize:"none"},Object(u.jsx)(j.EuiPageBody,null,Object(u.jsx)(j.EuiPageSection,{paddingSize:"none",color:"subdued"},s?Object(u.jsx)(j.EuiLoadingSpinner,{size:"xxl"}):Object(u.jsx)(j.EuiLoadingElastic,{size:"xxl"}))))},Ts=i.a.memo(qs);var Fs=a(23),ws=a(24);const _s=(e,t,{element:a,history:s},i,l)=>(n.a.render(Object(u.jsx)(ws.d,e,Object(u.jsx)(N.b,{services:{appName:Xe.PLUGIN_NAME,kibanaVersion:l,...e,...t,storage:i}},Object(u.jsx)(c,{history:s},Object(u.jsx)(d.QueryClientProvider,{client:Fs.a},Object(u.jsx)(Ts,null),Object(u.jsx)(b.ReactQueryDevtools,{initialIsOpen:!1}))))),a),()=>n.a.unmountComponentAtNode(a))},68:function(e,t,a){"use strict";var s,i=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),l=[];function n(e){for(var t=-1,a=0;a<l.length;a++)if(l[a].identifier===e){t=a;break}return t}function o(e,t){for(var a={},s=[],i=0;i<e.length;i++){var o=e[i],r=t.base?o[0]+t.base:o[0],u=a[r]||0,c="".concat(r," ").concat(u);a[r]=u+1;var d=n(c),b={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(l[d].references++,l[d].updater(b)):l.push({identifier:c,updater:m(b,t),references:1}),s.push(c)}return s}function r(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var l=a.nc;l&&(s.nonce=l)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var n=i(e.insert||"head");if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,a,s){var i=a?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var l=document.createTextNode(i),n=e.childNodes;n[t]&&e.removeChild(n[t]),n.length?e.insertBefore(l,n[t]):e.appendChild(l)}}function b(e,t,a){var s=a.css,i=a.media,l=a.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),l&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var j=null,p=0;function m(e,t){var a,s,i;if(t.singleton){var l=p++;a=j||(j=r(t)),s=d.bind(null,a,l,!1),i=d.bind(null,a,l,!0)}else a=r(t),s=b.bind(null,a,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var a=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<a.length;s++){var i=n(a[s]);l[i].references--}for(var r=o(e,t),u=0;u<a.length;u++){var c=n(a[u]);0===l[c].references&&(l[c].updater(),l.splice(c,1))}a=r}}}},69:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,s,i,l=e[1]||"",n=e[3];if(!n)return l;if(t&&"function"==typeof btoa){var o=(a=n,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(i," */")),r=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[l].concat(r).concat([o]).join("\n")}return[l].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,s){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(s)for(var l=0;l<this.length;l++){var n=this[l][0];null!=n&&(i[n]=!0)}for(var o=0;o<e.length;o++){var r=[].concat(e[o]);s&&i[r[0]]||(a&&(r[2]?r[2]="".concat(a," and ").concat(r[2]):r[2]=a),t.push(r))}},t}},81:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a(0),i=a.n(s),l=a(2),n=a(15),o=a(1);const r={maxWidth:"500px",marginRight:"auto",marginLeft:"auto"},u=()=>Object(o.jsx)("div",null,Object(o.jsx)(l.EuiSpacer,null),Object(o.jsx)(l.EuiPanel,{css:r},Object(o.jsx)(l.EuiEmptyPrompt,{iconType:"securityApp",title:Object(o.jsx)("h2",null,Object(o.jsx)(n.FormattedMessage,{id:"xpack.osquery.permissionDeniedErrorTitle",defaultMessage:"Permission denied"})),body:Object(o.jsx)("p",null,Object(o.jsx)(n.FormattedMessage,{id:"xpack.osquery.permissionDeniedErrorMessage",defaultMessage:"You are not authorized to access this page."}))})),Object(o.jsx)(l.EuiSpacer,null)),c=i.a.memo(u)},82:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(11),i=a(5),l=a(4);const n=({packId:e,skip:t=!1})=>{const{http:a}=Object(l.e)().services;return Object(s.useQuery)(["pack",{packId:e}],(()=>a.get(`/api/osquery/packs/${e}`,{version:i.a.public.v1})),{select:e=>null==e?void 0:e.data,keepPreviousData:!0,enabled:!(t||!e)})}},95:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return o}));var s=a(16);const i=e=>Object(s.reduce)(e,((e,t)=>{var a,i;return Object(s.isEmpty)(null==t?void 0:t.key)||Object(s.isEmpty)(null===(a=t.result)||void 0===a?void 0:a.type)||Object(s.isEmpty)(null===(i=t.result)||void 0===i?void 0:i.value)||(e[t.key]={[t.result.type]:t.result.value}),e}),{}),l=e=>Object(s.reduce)(e,((e,t,a)=>(t&&e.push({key:a,result:{type:Object.keys(t)[0],value:Object.values(t)[0]}}),e)),[]),n=e=>Object(s.reduce)(e,((e,t)=>(Object(s.isEmpty)(null==t?void 0:t.policy)||(e[t.policy.key]=t.percentage),e)),{}),o=(e,t)=>Object(s.reduce)(e,((e,a,s)=>{var i,l;return null!=a&&e.push({policy:{key:s,label:null!==(i=null==t||null===(l=t[s])||void 0===l?void 0:l.name)&&void 0!==i?i:""},percentage:a}),e}),[])}}]);