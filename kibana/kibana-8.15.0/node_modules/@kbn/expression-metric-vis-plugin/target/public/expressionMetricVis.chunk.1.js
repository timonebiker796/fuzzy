(window.expressionMetricVis_bundle_jsonpfunction=window.expressionMetricVis_bundle_jsonpfunction||[]).push([[1],{30:function(e,t,i){"use strict";i.r(t),i.d(t,"defaultColor",(function(){return g})),i.d(t,"MetricVis",(function(){return x}));var r=i(16),n=i.n(r),o=i(5),c=i(0),s=i(10),l=i(1),a=i(2),u=i(28),d=i(6),m=i(11),v=i(3),h=i(12),b=i(15);const g=u.euiThemeVars.euiColorEmptyShade,j=(e,t,i)=>{var r,n;let o,c;i.dimensions.secondaryMetric&&(o=Object(l.getColumnByAccessor)(i.dimensions.secondaryMetric,e),c=p(i.dimensions.secondaryMetric,e));const s=null!==(r=i.metric.secondaryPrefix)&&void 0!==r?r:null===(n=o)||void 0===n?void 0:n.name;return Object(a.jsx)("span",null,s,o?`${s?" ":""}${c(t[o.id])}`:void 0)},p=(e,t)=>{const i=function(e){var t;const i=(null==e?void 0:e.id)||"number";return"duration"!==i||null!=e&&null!==(t=e.params)&&void 0!==t&&t.formatOverride?null!=e?e:{id:i}:{...e,params:{outputFormat:"humanizePrecise",outputPrecision:1,useShortSuffix:!0,...e.params}}}(Object(l.getFormatByAccessor)(e,t));return Object(h.a)().deserialize(i).getConverterFor("text")},f=(e,t,i,r,n)=>{var o,c;const{min:s,max:l}=Object(b.a)(i,r,n);return null===(o=Object(h.b)().get("custom"))||void 0===o||null===(c=o.getColorForValue)||void 0===c?void 0:c.call(o,e,t,{min:s,max:l})},O=e=>({width:t,height:i,color:r})=>Object(a.jsx)(d.EuiIcon,{type:e,width:t,height:i,fill:r,style:{width:t,height:i}}),x=({data:e,config:t,renderComplete:i,fireEvent:r,filterable:b,overrides:x})=>{var y;const C=Object(o.useRef)([[]]),w=Object(o.useCallback)((e=>{e&&i()}),[i]),B=Object(o.useCallback)((()=>{var e;const t=C.current.length*C.current[0].length>1?200:300,i={name:"chartSize",data:{maxDimensions:{y:{value:C.current.length*t,unit:"pixels"},x:{value:(null===(e=C.current[0])||void 0===e?void 0:e.length)*t,unit:"pixels"}}}};r(i)}),[r,C]),[A,M]=Object(o.useState)("100%"),S=Object(o.useRef)(null),T=Object(d.useResizeObserver)(S.current),k=Object(h.c)().useChartsBaseTheme(),E=Object(l.getColumnByAccessor)(t.dimensions.metric,e.columns),V=p(t.dimensions.metric,e.columns);let F,D;t.dimensions.breakdownBy&&(F=Object(l.getColumnByAccessor)(t.dimensions.breakdownBy,e.columns),D=Object(h.a)().deserialize(Object(l.getFormatByAccessor)(t.dimensions.breakdownBy,e.columns)).getConverterFor("text"));const z=t.dimensions.max?null===(y=Object(l.getColumnByAccessor)(t.dimensions.max,e.columns))||void 0===y?void 0:y.id:void 0,R=(F?e.rows:e.rows.slice(0,1)).map(((i,r)=>{var n,o,s,l,a;const u=null!==i[E.id]?i[E.id]:NaN,d=F?D(i[F.id]):E.name,m=F?E.name:t.metric.subtitle;if("number"!=typeof u){var h,b,p;const r={title:String(d),subtitle:m,icon:null!==(h=t.metric)&&void 0!==h&&h.icon?O(null===(b=t.metric)||void 0===b?void 0:b.icon):void 0,extra:j(e.columns,i,t),color:null!==(p=t.metric.color)&&void 0!==p?p:g};return Array.isArray(u)?{...r,value:u.map((e=>V(e)))}:{...r,value:V(u)}}const x={value:u,valueFormatter:V,title:String(d),subtitle:m,icon:null!==(n=t.metric)&&void 0!==n&&n.icon?O(null===(o=t.metric)||void 0===o?void 0:o.icon):void 0,extra:j(e.columns,i,t),color:t.metric.palette&&null!=u?null!==(s=f(u,t.metric.palette,{metric:E.id,max:z,breakdownBy:null===(l=F)||void 0===l?void 0:l.id},e,r))&&void 0!==s?s:g:null!==(a=t.metric.color)&&void 0!==a?a:g},y=F?i[F.id]:v.a;return t.metric.trends&&t.metric.trends[y]?{...x,trend:t.metric.trends[y],trendShape:"area",trendA11yTitle:c.i18n.translate("expressionMetricVis.trendA11yTitle",{defaultMessage:"{dataTitle} over time.",values:{dataTitle:E.name}}),trendA11yDescription:c.i18n.translate("expressionMetricVis.trendA11yDescription",{defaultMessage:"A line chart showing the trend of the primary metric over time."})}:z&&t.metric.progressDirection?{...x,domainMax:i[z],progressBarDirection:t.metric.progressDirection}:x}));if(t.metric.minTiles)for(;R.length<t.metric.minTiles;)R.push(void 0);const{metric:{maxCols:I}}=t,_=R.length/I,P=k.metric.minHeight;Object(o.useEffect)((()=>{var e;const t=P*_;M((null!==(e=T.height)&&void 0!==e?e:-1/0)>t?"100%":`${t}px`)}),[_,P,T.height]);const{theme:$={},...L}=Object(m.c)(x,"settings"),N=[];for(let e=0;e<R.length;e+=I)N.push(R.slice(e,e+I));return C.current=N,Object(a.jsx)("div",{ref:S,css:Object(a.css)("height:100%;width:100%;overflow-y:auto;",Object(d.useEuiScrollBar)(),";","")},Object(a.jsx)("div",{css:Object(a.css)("height:",A,";","")},Object(a.jsx)(s.Chart,Object(m.c)(x,"chart"),Object(a.jsx)(s.Settings,n()({onWillRender:B,locale:c.i18n.getLocale(),theme:[{background:{color:g},metric:{barBackground:u.euiThemeVars.euiColorLightShade,emptyBackground:u.euiThemeVars.euiColorEmptyShade,blendingBackground:u.euiThemeVars.euiColorEmptyShade}},...Array.isArray($)?$:[$]],baseTheme:k,onRenderChange:w,onElementClick:b?t=>{var i;const n=null!==(i=F)&&void 0!==i?i:E,o=C.current[0].length;t.forEach((t=>{if(Object(s.isMetricElementEvent)(t)){const i=e.columns.findIndex((e=>e===n));r(((e,t,i)=>{const r=i.columns[t];return{name:"filter",data:{data:[{table:i,column:t,row:e,value:i.rows[e][r.id]}]}}})(t.rowIndex*o+t.columnIndex,i,e))}}))}:void 0},L)),Object(a.jsx)(s.Metric,{id:"metric",data:C.current}))))}}}]);