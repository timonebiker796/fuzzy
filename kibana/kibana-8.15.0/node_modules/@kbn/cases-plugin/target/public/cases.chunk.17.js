/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[17],{245:function(e,n,r){"use strict";r.d(n,"a",(function(){return c})),r.d(n,"b",(function(){return s})),r.d(n,"c",(function(){return d})),r.d(n,"d",(function(){return y})),r.d(n,"e",(function(){return f})),r.d(n,"f",(function(){return l})),r.d(n,"g",(function(){return p})),r.d(n,"h",(function(){return v})),r.d(n,"i",(function(){return g})),r.d(n,"j",(function(){return h})),r.d(n,"k",(function(){return w})),r.d(n,"l",(function(){return m})),r.d(n,"m",(function(){return b})),r.d(n,"n",(function(){return k})),r.d(n,"o",(function(){return T})),r.d(n,"p",(function(){return j})),r.d(n,"q",(function(){return _})),r.d(n,"r",(function(){return O})),r.d(n,"s",(function(){return q})),r.d(n,"t",(function(){return S})),r.d(n,"u",(function(){return I})),r.d(n,"v",(function(){return E})),r.d(n,"w",(function(){return $})),r.d(n,"x",(function(){return C})),r.d(n,"y",(function(){return F})),r.d(n,"z",(function(){return U})),r.d(n,"B",(function(){return N})),r.d(n,"A",(function(){return R})),r.d(n,"C",(function(){return i})),r.d(n,"D",(function(){return u})),r.d(n,"E",(function(){return a})),r.d(n,"F",(function(){return o}));var t=r(73);const i="ecs.version",u="event.action",a="event.kind",o="tags",c=`${t.k}.risk_score`,s=`${t.s}.author`,d=`${t.s}.created_at`,y=`${t.s}.created_by`,f=`${t.s}.description`,l=`${t.s}.enabled`,p=`${t.s}.from`,v=`${t.s}.interval`,g=`${t.s}.license`,h=`${t.s}.note`,w=`${t.s}.references`,m=`${t.s}.rule_id`,b=`${t.s}.rule_name_override`,k=`${t.s}.to`,T=`${t.s}.type`,j=`${t.s}.updated_at`,_=`${t.s}.updated_by`,O=`${t.s}.version`,q=`${t.k}.severity`,x=`${t.k}.suppression`,A=`${x}.terms`,E=`${A}.field`,C=`${A}.value`,$=`${x}.start`,I=`${x}.end`,S=`${x}.docs_count`,F=`${t.k}.system_status`,U=`${t.k}.workflow_reason`,N=`${t.k}.workflow_user`,R=`${t.k}.workflow_status_updated_at`},271:function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=r(272),i=r(15);function u(e){return void 0!==e.message?e.message:"Invalid value "+("function"==typeof(n=e.value)?t.getFunctionName(n):"number"!=typeof n||isFinite(n)?JSON.stringify(n):isNaN(n)?"NaN":n>0?"Infinity":"-Infinity")+" supplied to "+e.context.map((function(e){return e.key+": "+e.type.name})).join("/");var n}function a(e){return e.map(u)}function o(){return["No errors!"]}n.failure=a,n.success=o,n.PathReporter={report:i.fold(a,o)}},272:function(e,n,r){"use strict";var t,i=this&&this.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])},t(e,n)},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),u=this&&this.__assign||function(){return u=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var i in n=arguments[r])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},u.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var a=r(15),o=a.either.map,c=a.either.chain,s=function(){function e(e,n,r,t){this.name=e,this.is=n,this.validate=r,this.encode=t,this.decode=this.decode.bind(this)}return e.prototype.pipe=function(r,t){var i=this;return void 0===t&&(t="pipe("+this.name+", "+r.name+")"),new e(t,r.is,(function(e,n){return c(i.validate(e,n),(function(e){return r.validate(e,n)}))}),this.encode===n.identity&&r.encode===n.identity?n.identity:function(e){return i.encode(r.encode(e))})},e.prototype.asDecoder=function(){return this},e.prototype.asEncoder=function(){return this},e.prototype.decode=function(e){return this.validate(e,[{key:"",type:this,actual:e}])},e}();n.Type=s,n.identity=function(e){return e},n.getFunctionName=function(e){return e.displayName||e.name||"<function"+e.length+">"},n.getContextEntry=function(e,n){return{key:e,type:n}},n.appendContext=function(e,n,r,t){for(var i=e.length,u=Array(i+1),a=0;a<i;a++)u[a]=e[a];return u[i]={key:n,type:r,actual:t},u},n.failures=a.left,n.failure=function(e,r,t){return n.failures([{value:e,context:r,message:t}])},n.success=a.right;var d=function(e,n){for(var r=n.length,t=0;t<r;t++)e.push(n[t])},y=function(e){return function(n){return n._tag===e}},f=y("AnyType"),l=y("InterfaceType"),p=y("PartialType"),v=function(e){function r(){var r=e.call(this,"null",(function(e){return null===e}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="NullType",r}return i(r,e),r}(s);n.NullType=v,n.nullType=new v,n.null=n.nullType;var g=function(e){function r(){var r=e.call(this,"undefined",(function(e){return void 0===e}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="UndefinedType",r}return i(r,e),r}(s);n.UndefinedType=g;var h=new g;n.undefined=h;var w=function(e){function r(){var r=e.call(this,"void",h.is,h.validate,n.identity)||this;return r._tag="VoidType",r}return i(r,e),r}(s);n.VoidType=w,n.voidType=new w,n.void=n.voidType;var m=function(e){function r(){var r=e.call(this,"unknown",(function(e){return!0}),n.success,n.identity)||this;return r._tag="UnknownType",r}return i(r,e),r}(s);n.UnknownType=m,n.unknown=new m;var b=function(e){function r(){var r=e.call(this,"string",(function(e){return"string"==typeof e}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="StringType",r}return i(r,e),r}(s);n.StringType=b,n.string=new b;var k=function(e){function r(){var r=e.call(this,"number",(function(e){return"number"==typeof e}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="NumberType",r}return i(r,e),r}(s);n.NumberType=k,n.number=new k;var T=function(e){function r(){var r=e.call(this,"boolean",(function(e){return"boolean"==typeof e}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="BooleanType",r}return i(r,e),r}(s);n.BooleanType=T,n.boolean=new T;var j=function(e){function r(){var r=e.call(this,"UnknownArray",Array.isArray,(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="AnyArrayType",r}return i(r,e),r}(s);n.AnyArrayType=j,n.UnknownArray=new j,n.Array=n.UnknownArray;var _=function(e){function r(){var r=e.call(this,"UnknownRecord",(function(e){return"[object Object]"===Object.prototype.toString.call(e)}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="AnyDictionaryType",r}return i(r,e),r}(s);n.AnyDictionaryType=_,n.UnknownRecord=new _;var O=function(e){function r(){var r=e.call(this,"Function",(function(e){return"function"==typeof e}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="FunctionType",r}return i(r,e),r}(s);n.FunctionType=O,n.Function=new O;var q=function(e){function n(n,r,t,i,u,a){var o=e.call(this,n,r,t,i)||this;return o.type=u,o.predicate=a,o._tag="RefinementType",o}return i(n,e),n}(s);n.RefinementType=q,n.brand=function(e,n,r){return Z(e,n,r)},n.Int=n.brand(n.number,(function(e){return Number.isInteger(e)}),"Int");var x=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.value=u,a._tag="LiteralType",a}return i(n,e),n}(s);n.LiteralType=x,n.literal=function(e,r){void 0===r&&(r=JSON.stringify(e));var t=function(n){return n===e};return new x(r,t,(function(r,i){return t(r)?n.success(e):n.failure(r,i)}),n.identity,e)};var A=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.keys=u,a._tag="KeyofType",a}return i(n,e),n}(s);n.KeyofType=A;var E=Object.prototype.hasOwnProperty;n.keyof=function(e,r){void 0===r&&(r=Object.keys(e).map((function(e){return JSON.stringify(e)})).join(" | "));var t=function(r){return n.string.is(r)&&E.call(e,r)};return new A(r,t,(function(e,r){return t(e)?n.success(e):n.failure(e,r)}),n.identity,e)};var C=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.runDefinition=u,a._tag="RecursiveType",a}return i(n,e),n}(s);n.RecursiveType=C,Object.defineProperty(C.prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0}),n.recursion=function(e,n){var r,t=function(){return r||((r=n(i)).name=e),r},i=new C(e,(function(e){return t().is(e)}),(function(e,n){return t().validate(e,n)}),(function(e){return t().encode(e)}),t);return i};var $=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.type=u,a._tag="ArrayType",a}return i(n,e),n}(s);n.ArrayType=$,n.array=function(e,r){return void 0===r&&(r="Array<"+e.name+">"),new $(r,(function(r){return n.UnknownArray.is(r)&&r.every(e.is)}),(function(r,t){return c(n.UnknownArray.validate(r,t),(function(r){for(var i=r.length,u=r,o=[],c=0;c<i;c++){var s=r[c],y=e.validate(s,n.appendContext(t,String(c),e,s));if(a.isLeft(y))d(o,y.left);else{var f=y.right;f!==s&&(u===r&&(u=r.slice()),u[c]=f)}}return o.length>0?n.failures(o):n.success(u)}))}),e.encode===n.identity?n.identity:function(n){return n.map(e.encode)},e)};var I=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.props=u,a._tag="InterfaceType",a}return i(n,e),n}(s);n.InterfaceType=I;var S=function(e){return Object.keys(e).map((function(n){return n+": "+e[n].name})).join(", ")},F=function(e){for(var r=0;r<e.length;r++)if(e[r].encode!==n.identity)return!1;return!0},U=function(e){return"{ "+S(e)+" }"};n.type=function(e,r){void 0===r&&(r=U(e));var t=Object.keys(e),i=t.map((function(n){return e[n]})),o=t.length;return new I(r,(function(e){if(n.UnknownRecord.is(e)){for(var r=0;r<o;r++){var u=t[r];if(!E.call(e,u)||!i[r].is(e[u]))return!1}return!0}return!1}),(function(e,r){return c(n.UnknownRecord.validate(e,r),(function(e){for(var c=e,s=[],y=0;y<o;y++){var f=t[y];E.call(c,f)||(c===e&&(c=u({},e)),c[f]=c[f]);var l=c[f],p=i[y],v=p.validate(l,n.appendContext(r,f,p,l));if(a.isLeft(v))d(s,v.left);else{var g=v.right;g!==l&&(c===e&&(c=u({},e)),c[f]=g)}}return s.length>0?n.failures(s):n.success(c)}))}),F(i)?n.identity:function(e){for(var r=u({},e),a=0;a<o;a++){var c=t[a],s=i[a].encode;s!==n.identity&&(r[c]=s(e[c]))}return r},e)},n.interface=n.type;var N=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.props=u,a._tag="PartialType",a}return i(n,e),n}(s);n.PartialType=N;var R=function(e){return"Partial<"+e+">"};n.partial=function(e,r){void 0===r&&(r=R(U(e)));var t=Object.keys(e),i=t.map((function(n){return e[n]})),o=t.length;return new N(r,(function(r){if(n.UnknownRecord.is(r)){for(var i=0;i<o;i++){var u=t[i],a=r[u];if(void 0!==a&&!e[u].is(a))return!1}return!0}return!1}),(function(r,i){return c(n.UnknownRecord.validate(r,i),(function(r){for(var c=r,s=[],y=0;y<o;y++){var f=t[y],l=c[f],p=e[f],v=p.validate(l,n.appendContext(i,f,p,l));if(a.isLeft(v))void 0!==l&&d(s,v.left);else{var g=v.right;g!==l&&(c===r&&(c=u({},r)),c[f]=g)}}return s.length>0?n.failures(s):n.success(c)}))}),F(i)?n.identity:function(e){for(var n=u({},e),r=0;r<o;r++){var a=t[r],c=e[a];void 0!==c&&(n[a]=i[r].encode(c))}return n},e)};var P=function(e){function n(n,r,t,i,u,a){var o=e.call(this,n,r,t,i)||this;return o.domain=u,o.codomain=a,o._tag="DictionaryType",o}return i(n,e),n}(s);n.DictionaryType=P,n.record=function(e,r,t){return void 0===t&&(t="{ [K in "+e.name+"]: "+r.name+" }"),new P(t,(function(t){return n.UnknownRecord.is(t)?Object.keys(t).every((function(n){return e.is(n)&&r.is(t[n])})):f(r)&&Array.isArray(t)}),(function(t,i){if(n.UnknownRecord.is(t)){for(var u={},o=[],c=Object.keys(t),s=c.length,y=!1,l=0;l<s;l++){var p=c[l],v=t[p],g=e.validate(p,n.appendContext(i,p,e,p));if(a.isLeft(g))d(o,g.left);else{var h=g.right;y=y||h!==p,p=h;var w=r.validate(v,n.appendContext(i,p,r,v));if(a.isLeft(w))d(o,w.left);else{var m=w.right;y=y||m!==v,u[p]=m}}}return o.length>0?n.failures(o):n.success(y?u:t)}return f(r)&&Array.isArray(t)?n.success(t):n.failure(t,i)}),e.encode===n.identity&&r.encode===n.identity?n.identity:function(n){for(var t={},i=Object.keys(n),u=i.length,a=0;a<u;a++){var o=i[a];t[String(e.encode(o))]=r.encode(n[o])}return t},e,r)};var D=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.types=u,a._tag="UnionType",a}return i(n,e),n}(s);n.UnionType=D;var W=function(e){return"("+e.map((function(e){return e.name})).join(" | ")+")"};n.union=function(e,r){void 0===r&&(r=W(e));var t=ae(e);if(void 0!==t&&e.length>0){var i=t[0],u=t[1],o=u.length,s=function(e){for(var n=0;n<o;n++)if(-1!==u[n].indexOf(e))return n};return new K(r,(function(r){if(n.UnknownRecord.is(r)){var t=s(r[i]);return void 0!==t&&e[t].is(r)}return!1}),(function(r,t){return c(n.UnknownRecord.validate(r,t),(function(u){var a=s(u[i]);if(void 0===a)return n.failure(r,t);var o=e[a];return o.validate(u,n.appendContext(t,String(a),o,u))}))}),F(e)?n.identity:function(n){var t=s(n[i]);if(void 0===t)throw new Error("no codec found to encode value in union codec "+r);return e[t].encode(n)},e,i)}return new D(r,(function(n){return e.some((function(e){return e.is(n)}))}),(function(r,t){for(var i=[],u=0;u<e.length;u++){var o=e[u],c=o.validate(r,n.appendContext(t,String(u),o,r));if(!a.isLeft(c))return n.success(c.right);d(i,c.left)}return n.failures(i)}),F(e)?n.identity:function(n){for(var t=0,i=e;t<i.length;t++){var u=i[t];if(u.is(n))return u.encode(n)}throw new Error("no codec found to encode value in union type "+r)},e)};var L=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.types=u,a._tag="IntersectionType",a}return i(n,e),n}(s);n.IntersectionType=L;var B=function(e,r){for(var t=!0,i=!0,u=0,a=r;u<a.length;u++)(d=a[u])!==e&&(t=!1),n.UnknownRecord.is(d)&&(i=!1);if(t)return e;if(i)return r[r.length-1];for(var o={},c=0,s=r;c<s.length;c++){var d=s[c];for(var y in d)d[y]===e[y]&&o.hasOwnProperty(y)||(o[y]=d[y])}return o};n.intersection=function(e,r){void 0===r&&(r="("+e.map((function(e){return e.name})).join(" & ")+")");var t=e.length;return new L(r,(function(n){return e.every((function(e){return e.is(n)}))}),0===e.length?n.success:function(r,i){for(var u=[],o=[],c=0;c<t;c++){var s=e[c],y=s.validate(r,n.appendContext(i,String(c),s,r));a.isLeft(y)?d(o,y.left):u.push(y.right)}return o.length>0?n.failures(o):n.success(B(r,u))},0===e.length?n.identity:function(n){return B(n,e.map((function(e){return e.encode(n)})))},e)};var V=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.types=u,a._tag="TupleType",a}return i(n,e),n}(s);n.TupleType=V,n.tuple=function(e,r){void 0===r&&(r="["+e.map((function(e){return e.name})).join(", ")+"]");var t=e.length;return new V(r,(function(r){return n.UnknownArray.is(r)&&r.length===t&&e.every((function(e,n){return e.is(r[n])}))}),(function(r,i){return c(n.UnknownArray.validate(r,i),(function(r){for(var u=r.length>t?r.slice(0,t):r,o=[],c=0;c<t;c++){var s=r[c],y=e[c],f=y.validate(s,n.appendContext(i,String(c),y,s));if(a.isLeft(f))d(o,f.left);else{var l=f.right;l!==s&&(u===r&&(u=r.slice()),u[c]=l)}}return o.length>0?n.failures(o):n.success(u)}))}),F(e)?n.identity:function(n){return e.map((function(e,r){return e.encode(n[r])}))},e)};var z=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.type=u,a._tag="ReadonlyType",a}return i(n,e),n}(s);n.ReadonlyType=z,n.readonly=function(e,r){return void 0===r&&(r="Readonly<"+e.name+">"),new z(r,e.is,(function(n,r){return o(e.validate(n,r),(function(e){return e}))}),e.encode===n.identity?n.identity:e.encode,e)};var M=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.type=u,a._tag="ReadonlyArrayType",a}return i(n,e),n}(s);n.ReadonlyArrayType=M,n.readonlyArray=function(e,r){void 0===r&&(r="ReadonlyArray<"+e.name+">");var t=n.array(e);return new M(r,t.is,(function(e,n){return o(t.validate(e,n),(function(e){return e}))}),t.encode,e)},n.strict=function(e,r){return n.exact(n.type(e),r)};var K=function(e){function n(n,r,t,i,u,a){var o=e.call(this,n,r,t,i,u)||this;return o.tag=a,o}return i(n,e),n}(D);n.TaggedUnionType=K,n.taggedUnion=function(e,r,t){void 0===t&&(t=W(r));var i=n.union(r,t);return i instanceof K?i:(console.warn("[io-ts] Cannot build a tagged union for "+t+", returning a de-optimized union"),new K(t,i.is,i.validate,i.encode,r,e))};var G=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.type=u,a._tag="ExactType",a}return i(n,e),n}(s);n.ExactType=G;var J=function(e){switch(e._tag){case"RefinementType":case"ReadonlyType":return J(e.type);case"InterfaceType":case"StrictType":case"PartialType":return e.props;case"IntersectionType":return e.types.reduce((function(e,n){return Object.assign(e,J(n))}),{})}},Y=function(e,n){for(var r=Object.getOwnPropertyNames(e),t=!1,i={},u=0;u<r.length;u++){var a=r[u];E.call(n,a)?i[a]=e[a]:t=!0}return t?i:e};n.exact=function(e,r){void 0===r&&(r=function(e){return l(e)?"{| "+S(e.props)+" |}":p(e)?R("{| "+S(e.props)+" |}"):"Exact<"+e.name+">"}(e));var t=J(e);return new G(r,e.is,(function(r,i){return c(n.UnknownRecord.validate(r,i),(function(){return o(e.validate(r,i),(function(e){return Y(e,t)}))}))}),(function(n){return e.encode(Y(n,t))}),e)},n.getValidationError=function(e,n){return{value:e,context:n}},n.getDefaultContext=function(e){return[{key:"",type:e}]};var Q=function(e){function r(){var r=e.call(this,"never",(function(e){return!1}),(function(e,r){return n.failure(e,r)}),(function(){throw new Error("cannot encode never")}))||this;return r._tag="NeverType",r}return i(r,e),r}(s);n.NeverType=Q,n.never=new Q;var H=function(e){function r(){var r=e.call(this,"any",(function(e){return!0}),n.success,n.identity)||this;return r._tag="AnyType",r}return i(r,e),r}(s);n.AnyType=H,n.any=new H,n.Dictionary=n.UnknownRecord;var X=function(e){function r(){var r=e.call(this,"object",(function(e){return null!==e&&"object"==typeof e}),(function(e,t){return r.is(e)?n.success(e):n.failure(e,t)}),n.identity)||this;return r._tag="ObjectType",r}return i(r,e),r}(s);function Z(e,r,t){return void 0===t&&(t="("+e.name+" | "+n.getFunctionName(r)+")"),new q(t,(function(n){return e.is(n)&&r(n)}),(function(t,i){return c(e.validate(t,i),(function(e){return r(e)?n.success(e):n.failure(e,i)}))}),e.encode,e,r)}n.ObjectType=X,n.object=new X,n.refinement=Z,n.Integer=Z(n.number,Number.isInteger,"Integer"),n.dictionary=n.record;var ee=function(e){function n(n,r,t,i,u){var a=e.call(this,n,r,t,i)||this;return a.props=u,a._tag="StrictType",a}return i(n,e),n}(s);n.StrictType=ee,n.clean=function(e){return e},n.alias=function(e){return function(){return e}};var ne=function(e){return e.length>0};function re(e,n){for(var r=[],t=0,i=e;t<i.length;t++){var u=i[t];-1!==n.indexOf(u)&&r.push(u)}return r}function te(e){return"LiteralType"===e._tag}n.emptyTags={};var ie=[];function ue(e){if(-1!==ie.indexOf(e))return n.emptyTags;if(function(e){return"InterfaceType"===e._tag}(e)||function(e){return"StrictType"===e._tag}(e)){var r=n.emptyTags;for(var t in e.props){var i=e.props[t];te(i)&&(r===n.emptyTags&&(r={}),r[t]=[i.value])}return r}if(function(e){return"ExactType"===e._tag}(e)||function(e){return"RefinementType"===e._tag}(e))return ue(e.type);if(function(e){return"IntersectionType"===e._tag}(e))return e.types.reduce((function(e,r){return function(e,r){if(e===n.emptyTags)return r;if(r===n.emptyTags)return e;var t=Object.assign({},e);for(var i in r)if(e.hasOwnProperty(i)){var u=re(e[i],r[i]);if(!ne(u)){t=n.emptyTags;break}t[i]=u}else t[i]=r[i];return t}(e,ue(r))}),n.emptyTags);if(function(e){return"UnionType"===e._tag}(e))return e.types.slice(1).reduce((function(e,r){return function(e,r){if(e===n.emptyTags||r===n.emptyTags)return n.emptyTags;var t=n.emptyTags;for(var i in e)r.hasOwnProperty(i)&&0===re(e[i],r[i]).length&&(t===n.emptyTags&&(t={}),t[i]=e[i].concat(r[i]));return t}(e,ue(r))}),ue(e.types[0]));if(function(e){return"RecursiveType"===e._tag}(e)){ie.push(e);var u=ue(e.type);return ie.pop(),u}return n.emptyTags}function ae(e){for(var n=ue(e[0]),r=Object.keys(n),t=e.length,i=function(r){for(var i=n[r].slice(),u=[n[r]],a=1;a<t;a++){var o=ue(e[a])[r];if(void 0===o)return"continue-keys";if(o.some((function(e){return-1!==i.indexOf(e)})))return"continue-keys";i.push.apply(i,o),u.push(o)}return{value:[r,u]}},u=0,a=r;u<a.length;u++){var o=i(a[u]);if("object"==typeof o)return o.value}}n.getTags=ue,n.getIndex=ae},350:function(e,n,r){"use strict";r.r(n),r.d(n,"CasesParamsFieldsComponent",(function(){return E})),r.d(n,"CasesParamsFields",(function(){return C})),r.d(n,"default",(function(){return C}));var t=r(4),i=r.n(t),u=r(5),a=r(2),o=r(74);const c="7d";let s=function(e){return e.DAYS="d",e.WEEKS="w",e}({});const d=(e=s.DAYS,n="0")=>{switch(e){case s.DAYS:return o.b(n);case s.WEEKS:return o.g(n)}};var y=r(1),f=r(53),l=r(120),p=r(44),v=r(15),g=(r(271),r(12)),h=r(73),w=r(245);const m={[h.a]:{type:"keyword",array:!1,required:!1},[h.b]:{type:"keyword",array:!0,required:!1},[h.d]:{type:"long",array:!1,required:!1},[h.e]:{type:"date",array:!1,required:!1},[h.f]:{type:"boolean",array:!1,required:!1},[h.g]:{type:"boolean",array:!0,required:!1},[h.j]:{type:"keyword",array:!0,required:!1},[h.c]:{type:"long",array:!1,required:!1},[h.h]:{type:"keyword",array:!1,required:!0},[h.i]:{type:"date",required:!1,array:!1},[h.l]:{type:"keyword",array:!1,required:!1},[h.m]:{type:"keyword",array:!1,required:!1,multi_fields:[{flat_name:`${h.m}.text`,name:"text",type:"match_only_text"}]},[h.n]:{type:"keyword",array:!1,required:!0},[h.o]:{type:"keyword",array:!1,required:!0},[h.p]:{type:"date",array:!1,required:!1},[h.q]:{type:"keyword",array:!1,required:!1},[h.r]:{type:"keyword",array:!1,required:!0},[h.t]:{array:!1,type:"flattened",ignore_above:4096,required:!1},[h.u]:{type:"keyword",array:!1,required:!0},[h.v]:{type:"long",array:!1,required:!0},[h.w]:{type:"keyword",array:!0,required:!1},[h.x]:{type:"keyword",array:!1,required:!0},[h.y]:{type:"keyword",array:!1,required:!0},[h.z]:{type:"boolean",array:!1,required:!1},[h.A]:{type:"date",array:!1,required:!1},[h.B]:{type:"keyword",array:!1,required:!0},[h.C]:{type:"date_range",format:"epoch_millis||strict_date_optional_time",array:!1,required:!1},[h.D]:{type:"keyword",array:!1,index:!1,required:!1,ignore_above:2048},[h.E]:{type:"keyword",array:!1,required:!0},[h.G]:{type:"keyword",array:!1,required:!1},[h.H]:{type:"keyword",array:!0,required:!1},[h.F]:{type:"keyword",array:!0,required:!1},[w.D]:{type:"keyword",array:!1,required:!1},[w.E]:{type:"keyword",array:!1,required:!1},[h.I]:{type:"keyword",array:!0,required:!0},[w.F]:{type:"keyword",array:!0,required:!1},[h.J]:{type:"date",required:!0,array:!1},[h.K]:{type:"version",array:!1,required:!1}},b={[w.a]:{type:"float",array:!1,required:!1},[w.b]:{type:"keyword",array:!1,required:!1},[w.c]:{type:"date",array:!1,required:!1},[w.d]:{type:"keyword",array:!1,required:!1},[w.e]:{type:"keyword",array:!1,required:!1},[w.f]:{type:"keyword",array:!1,required:!1},[w.g]:{type:"keyword",array:!1,required:!1},[w.h]:{type:"keyword",array:!1,required:!1},[w.i]:{type:"keyword",array:!1,required:!1},[w.j]:{type:"keyword",array:!1,required:!1},[w.k]:{type:"keyword",array:!0,required:!1},[w.l]:{type:"keyword",array:!1,required:!1},[w.m]:{type:"keyword",array:!1,required:!1},[w.n]:{type:"keyword",array:!1,required:!1},[w.o]:{type:"keyword",array:!1,required:!1},[w.p]:{type:"date",array:!1,required:!1},[w.q]:{type:"keyword",array:!1,required:!1},[w.r]:{type:"keyword",array:!1,required:!1},[w.s]:{type:"keyword",array:!1,required:!1},[w.t]:{type:"long",array:!1,required:!1},[w.u]:{type:"date",array:!1,required:!1},[w.v]:{type:"keyword",array:!0,required:!1},[w.w]:{type:"date",array:!1,required:!1},[w.x]:{type:"keyword",array:!0,required:!1},[w.y]:{type:"keyword",array:!1,required:!1},[w.z]:{type:"keyword",array:!1,required:!1},[w.B]:{type:"keyword",array:!1,required:!1},[w.A]:{type:"date",array:!1,required:!1},[w.C]:{type:"keyword",array:!1,required:!1}};function k(e,...n){const r=Object.keys(e).filter((e=>n.some((n=>{if(n===e)return!0;const r=e.split("."),t=n.split(".");return t.indexOf("*")===t.length-1&&r.every(((e,n)=>{const r=t.length-1<n?"*":t[n];return e===r||"*"===r}))}))));return Object(g.pick)(e,r)}const T={...k(m,"*"),...k(b,"*")};var j=r(0);const _=new j.Type("NumberFromString",(e=>"number"==typeof e),((e,n)=>v.either.chain(j.string.validate(e,n),(r=>{const t=Number(r);return isNaN(t)?j.failure(e,n):j.success(t)}))),(e=>e)),O=new j.Type("BooleanFromString",(e=>"string"==typeof e),((e,n)=>v.either.chain(j.string.validate(e,n),(r=>{switch(r.toLowerCase().trim()){case"1":case"true":case"yes":return j.success(!0);case"0":case"false":case"no":return j.success(!1);default:return j.failure(e,n)}}))),(e=>e)),q={keyword:j.string,version:j.string,text:j.string,date:j.string,boolean:j.union([j.boolean,O]),byte:j.union([j.number,_]),long:j.union([j.number,_]),integer:j.union([j.number,_]),short:j.union([j.number,_]),double:j.union([j.number,_]),float:j.union([j.number,_]),scaled_float:j.union([j.number,_]),unsigned_long:j.union([j.number,_]),flattened:j.UnknownRecord};!function(e){function n(e){return Object(g.mapValues)(e,(e=>{const n=e.type in q?q[e.type]:j.unknown;return e.array?(e=>{const n=j.union([e,j.array(j.union([e,j.nullType]))]);return new j.Type("castArray",n.is,n.validate,(e=>Array.isArray(e)?e:[e]))})(n):(e=>{const n=j.union([e,j.array(e)]);return new j.Type("castSingle",n.is,n.validate,(e=>Array.isArray(e)?e[0]:e))})(n)}))}const r=Object(g.pickBy)(e,(e=>e.required));j.intersection([j.exact(j.partial(n(e))),j.type(n(r))])}(T);var x=r(94);var A=r(3);const E=({actionParams:e,editAction:n,errors:r,index:v,producerId:g})=>{const{dataViews:h,loading:w}=function(e){const{http:n,data:r,notifications:{toasts:i}}=Object(f.useKibana)().services,[u,a]=Object(t.useState)(void 0),o=e.sort().join(","),c=1===e.length&&e.includes(l.a.SIEM),s=e.length>1&&e.includes(l.a.SIEM),d=e.length>0&&!c&&!s,v=()=>{i.addDanger(y.i18n.translate("xpack.cases.systemActions.useAlertDataView.useAlertDataMessage",{defaultMessage:"Unable to load alert data view"}))},{data:g,isSuccess:h,isInitialLoading:w,isLoading:m}=Object(p.useQuery)({queryKey:["loadAlertIndexNames",o],queryFn:()=>async function({http:e,features:n}){const{index_name:r=[]}=await e.get(`${x.a}/index`,{query:{features:n}});return r}({http:n,features:o}),onError:v,refetchOnWindowFocus:!1,enabled:e.length>0&&!s}),{data:b,isSuccess:k,isInitialLoading:T,isLoading:j}=Object(p.useQuery)({queryKey:["loadAlertFields",o],queryFn:()=>async function({http:e,featureIds:n}){const{fields:r=[]}=await e.get(`${x.a}/browser_fields`,{query:{featureIds:n}});return r}({http:n,featureIds:e}),onError:v,refetchOnWindowFocus:!1,enabled:d});return Object(t.useEffect)((()=>()=>{null==u||u.map((e=>r.dataViews.clearInstanceCache(e.id)))}),[u]),Object(t.useEffect)((()=>{c&&h&&async function(){const e=await(null==r?void 0:r.dataViews.create({title:(null!=g?g:[]).join(","),allowNoIndex:!0}));a([e])}()}),[null==r?void 0:r.dataViews,g,h,c]),Object(t.useEffect)((()=>{var e;g&&b&&!c&&k&&h&&a([{title:(null!=g?g:[]).join(","),fieldFormatMap:{},fields:null===(e=null!=b?b:[])||void 0===e?void 0:e.map((e=>({...e,...e.esTypes&&e.esTypes.includes("flattened")?{type:"string"}:{}})))}])}),[b,null==r?void 0:r.dataViews,g,h,c,k]),Object(t.useMemo)((()=>({dataViews:u,loading:0!==e.length&&!s&&(c?w||m:w||m||T||j)})),[u,e.length,s,c,w,m,T,j])}(g?[g]:[]),{timeWindow:m,reopenClosedCases:b,groupingBy:k}=Object(t.useMemo)((()=>{var n;return null!==(n=e.subActionParams)&&void 0!==n?n:{timeWindow:`${c}`,reopenClosedCases:!1,groupingBy:[]}}),[e.subActionParams]),T=m.slice(0,m.length-1),j=m.slice(-1),_=isNaN(parseInt(T,10))?c[0]:T.toString(),O=Object.values(s).includes(j)?j:c[1];Object(t.useEffect)((()=>{e.subAction||n("subAction",a.j.RUN,v),e.subActionParams||n("subActionParams",{timeWindow:`${c}`,reopenClosedCases:!1,groupingBy:[]},v)}),[e]);const q=Object(t.useCallback)(((r,t)=>n("subActionParams",{...e.subActionParams,[r]:t},v)),[n,v,e.subActionParams]),E=Object(t.useCallback)(((e,n)=>{n&&q("timeWindow","timeWindowSize"===e?`${n}${O}`:`${_}${n}`)}),[q,O,_]),C=Object(t.useCallback)((e=>{q("groupingBy",null!=e&&e.length?[e[0].value]:[])}),[q]),$=Object(t.useMemo)((()=>null!=h&&h.length?h.map((e=>e.fields.filter((e=>Boolean(e.aggregatable))).map((e=>({value:e.name,label:e.name}))))).flat():[]),[h]),I=k.map((e=>({value:e,label:e})));return Object(A.jsx)(i.a.Fragment,null,Object(A.jsx)(u.EuiFlexGroup,null,Object(A.jsx)(u.EuiFlexItem,{grow:!0},Object(A.jsx)(u.EuiFormRow,{fullWidth:!0},Object(A.jsx)(u.EuiComboBox,{fullWidth:!0,isClearable:!0,singleSelection:!0,"data-test-subj":"group-by-alert-field-combobox",prepend:o.c,isLoading:w,isDisabled:w,options:$,onChange:C,selectedOptions:I})))),Object(A.jsx)(u.EuiSpacer,{size:"m"}),Object(A.jsx)(u.EuiFormRow,{fullWidth:!0,id:"timeWindow",error:r.timeWindow,isInvalid:void 0!==r.timeWindow&&r.timeWindow.length>0&&void 0!==m},Object(A.jsx)(u.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"s"},Object(A.jsx)(u.EuiFlexItem,{grow:4},Object(A.jsx)(u.EuiFieldNumber,{prepend:o.e,"data-test-subj":"time-window-size-input",value:_,min:1,step:1,onChange:e=>{E("timeWindowSize",e.target.value)}})),Object(A.jsx)(u.EuiFlexItem,{grow:3},Object(A.jsx)(u.EuiSelect,{fullWidth:!0,"data-test-subj":"time-window-unit-select",value:O,onChange:e=>{E("timeWindowUnit",e.target.value)},options:(S=_,Object.entries(s).map((([e,n])=>({text:d(n,""===S?"0":S),value:n}))))})))),Object(A.jsx)(u.EuiSpacer,{size:"m"}),Object(A.jsx)(u.EuiFlexGroup,null,Object(A.jsx)(u.EuiFlexItem,null,Object(A.jsx)(u.EuiCheckbox,{id:`reopen-case-${v}`,"data-test-subj":"reopen-case",checked:b,label:o.d,onChange:e=>{q("reopenClosedCases",e.target.checked)}}))));var S};E.displayName="CasesParamsFields";const C=Object(t.memo)(E)}}]);