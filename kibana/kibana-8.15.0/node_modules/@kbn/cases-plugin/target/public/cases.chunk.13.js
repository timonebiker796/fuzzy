/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[13],{133:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n={jira:["jira"],resilient:["resilient"],servicenow:["servicenow"],jiraGetFieldsByIssueType:(e,t)=>[...n.jira,e,"getFields",t],jiraGetIssueTypes:e=>[...n.jira,e,"getIssueType"],jiraGetIssues:(e,t)=>[...n.jira,e,"getIssues",t],jiraGetIssue:(e,t)=>[...n.jira,e,"getIssue",t],resilientGetIncidentTypes:e=>[...n.resilient,e,"getIncidentTypes"],resilientGetSeverity:e=>[...n.resilient,e,"getSeverity"],servicenowGetChoices:(e,t)=>[...n.servicenow,e,"getChoices",t]}},135:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=({connector_id:e,service_message:t,...s})=>({...s,actionId:e,...t&&{serviceMessage:t}})},141:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var n=s(4),i=s.n(n),c=s(5),o=s(1),l=s(3);const a=o.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningTitle",{defaultMessage:"This connector type is deprecated"}),r=o.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningDesc",{defaultMessage:"Update this connector, or create a new one."}),u=({type:e="warning"})=>Object(l.jsx)(c.EuiCallOut,{title:a,color:e,iconType:"warning","data-test-subj":"deprecated-connector-warning-callout"},r);u.displayName="DeprecatedCallout";const d=i.a.memo(u)},152:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=e=>e.map((e=>({value:e.value,text:e.label})))},153:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s(44),i=s(45),c=s(133),o=s(81),l=s(135),a=s(140);const r=({http:e,connector:t,fields:s})=>{var r;const{showErrorToast:u}=Object(i.a)();return Object(n.useQuery)(c.a.servicenowGetChoices(null!==(r=null==t?void 0:t.id)&&void 0!==r?r:"",s),(({signal:n})=>{var i;return async function({http:e,connectorId:t,fields:s,signal:n}){const i=await e.post(Object(o.b)(t),{body:JSON.stringify({params:{subAction:"getChoices",subActionParams:{fields:s}}}),signal:n});return Object(l.a)(i)}({http:e,signal:n,connectorId:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"",fields:s})}),{enabled:Boolean(t),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&u(new Error(a.d),{title:a.d,toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{u(e,{title:a.d})}})}},345:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return m}));var n=s(4),i=s.n(n),c=s(5),o=s(21),l=s(24),a=s(140),r=s(8),u=s(153),d=s(152),j=s(141),p=s(3);const b=["urgency","severity","impact","category","subcategory"],g={urgency:[],severity:[],impact:[],category:[],subcategory:[]},m=({connector:e})=>{var t;const s=Object(o.useFormContext)(),[{fields:m}]=Object(o.useFormData)(),{category:f=null}=null!=m?m:{},{http:y}=Object(r.g)().services,O=e.isDeprecated,{isLoading:v,isFetching:x,data:F}=Object(u.a)({http:y,connector:e,fields:b}),h=v||x,I=(null!==(t=null==F?void 0:F.data)&&void 0!==t?t:[]).reduce(((e,t)=>({...e,[t.element]:[...null!=e[t.element]?e[t.element]:[],t]})),g),S=Object(n.useMemo)((()=>Object(d.a)(I.category)),[I.category]),w=Object(n.useMemo)((()=>Object(d.a)(I.urgency)),[I.urgency]),E=Object(n.useMemo)((()=>Object(d.a)(I.severity)),[I.severity]),G=Object(n.useMemo)((()=>Object(d.a)(I.impact)),[I.impact]),M=Object(n.useMemo)((()=>Object(d.a)(I.subcategory.filter((e=>e.dependent_value===f)))),[I.subcategory,f]);return Object(p.jsx)(i.a.Fragment,null,O&&Object(p.jsx)(c.EuiFlexGroup,null,Object(p.jsx)(c.EuiFlexItem,null,Object(p.jsx)(j.a,null))),Object(p.jsx)(c.EuiFlexGroup,{"data-test-subj":"connector-fields-sn-itsm",direction:"column",gutterSize:"s"},Object(p.jsx)(c.EuiFlexGroup,null,Object(p.jsx)(c.EuiFlexItem,null,Object(p.jsx)(o.UseField,{path:"fields.urgency",component:l.SelectField,config:{label:a.m},componentProps:{euiFieldProps:{"data-test-subj":"urgencySelect",options:w,hasNoInitialSelection:!0,fullWidth:!0,disabled:h,isLoading:h}}}))),Object(p.jsx)(c.EuiFlexGroup,null,Object(p.jsx)(c.EuiFlexItem,null,Object(p.jsx)(o.UseField,{path:"fields.severity",component:l.SelectField,config:{label:a.j},componentProps:{euiFieldProps:{"data-test-subj":"severitySelect",options:E,hasNoInitialSelection:!0,fullWidth:!0,disabled:h,isLoading:h}}})),Object(p.jsx)(c.EuiFlexItem,null,Object(p.jsx)(o.UseField,{path:"fields.impact",component:l.SelectField,config:{label:a.f},componentProps:{euiFieldProps:{"data-test-subj":"impactSelect",options:G,hasNoInitialSelection:!0,fullWidth:!0,disabled:h,isLoading:h}}}))),Object(p.jsx)(c.EuiFlexGroup,null,Object(p.jsx)(c.EuiFlexItem,null,Object(p.jsx)(o.UseField,{path:"fields.category",component:l.SelectField,config:{label:a.c},onChange:()=>{s.setFieldValue("fields.subcategory",null)},componentProps:{euiFieldProps:{"data-test-subj":"categorySelect",options:S,hasNoInitialSelection:!0,fullWidth:!0,disabled:h,isLoading:h}}})),Object(p.jsx)(c.EuiFlexItem,null,Object(p.jsx)(o.UseField,{path:"fields.subcategory",component:l.SelectField,config:{label:a.l},componentProps:{euiFieldProps:{"data-test-subj":"subcategorySelect",options:M,hasNoInitialSelection:!0,fullWidth:!0,disabled:h,isLoading:h}}})))))};m.displayName="ServiceNowITSMFields"}}]);