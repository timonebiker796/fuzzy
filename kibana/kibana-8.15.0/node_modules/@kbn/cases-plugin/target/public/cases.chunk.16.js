/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[16],{133:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n={jira:["jira"],resilient:["resilient"],servicenow:["servicenow"],jiraGetFieldsByIssueType:(e,t)=>[...n.jira,e,"getFields",t],jiraGetIssueTypes:e=>[...n.jira,e,"getIssueType"],jiraGetIssues:(e,t)=>[...n.jira,e,"getIssues",t],jiraGetIssue:(e,t)=>[...n.jira,e,"getIssue",t],resilientGetIncidentTypes:e=>[...n.resilient,e,"getIncidentTypes"],resilientGetSeverity:e=>[...n.resilient,e,"getSeverity"],servicenowGetChoices:(e,t)=>[...n.servicenow,e,"getChoices",t]}},135:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=({connector_id:e,service_message:t,...s})=>({...s,actionId:e,...t&&{serviceMessage:t}})},161:function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return a})),s.d(t,"d",(function(){return r})),s.d(t,"b",(function(){return l}));var n=s(81),i=(s(87),s(135));async function o({http:e,connectorId:t,signal:s}){const o=await e.post(Object(n.b)(t),{body:JSON.stringify({params:{subAction:"issueTypes",subActionParams:{}}}),signal:s});return Object(i.a)(o)}async function a({http:e,connectorId:t,id:s,signal:o}){const a=await e.post(Object(n.b)(t),{body:JSON.stringify({params:{subAction:"fieldsByIssueType",subActionParams:{id:s}}}),signal:o});return Object(i.a)(a)}async function r({http:e,connectorId:t,title:s,signal:o}){const a=await e.post(Object(n.b)(t),{body:JSON.stringify({params:{subAction:"issues",subActionParams:{title:s}}}),signal:o});return Object(i.a)(a)}async function l({http:e,connectorId:t,id:s,signal:o}){const a=await e.post(Object(n.b)(t),{body:JSON.stringify({params:{subAction:"issue",subActionParams:{id:s}}}),signal:o});return Object(i.a)(a)}},209:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s(44),i=s(45),o=s(133),a=s(161),r=s(139);const l=({http:e,connector:t})=>{var s;const{showErrorToast:l}=Object(i.a)();return Object(n.useQuery)(o.a.jiraGetIssueTypes(null!==(s=null==t?void 0:t.id)&&void 0!==s?s:""),(({signal:s})=>{var n;return Object(a.c)({http:e,signal:s,connectorId:null!==(n=null==t?void 0:t.id)&&void 0!==n?n:""})}),{enabled:Boolean(t),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&l(new Error(r.e),{title:r.e,toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{l(e,{title:r.e})}})}},353:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return F}));var n=s(4),i=s(39),o=s(5),a=s(24),r=s(21),l=s(83),c=s(12),u=s(139),d=s(8),b=s(209),p=s(44),j=s(45),v=s(161),g=s(133),y=s(165),O=s(166),h=s.n(O),m=s(2),f=s(3);const I=({field:e,options:t,isLoading:s,onSearchComboChange:n})=>{const{value:i}=e,{isInvalid:a,errorMessage:l}=Object(r.getFieldValidityAndErrorMessage)(e),c=[i].map((e=>t.find((t=>t.value===e))||null)).filter((e=>null!=e));return Object(f.jsx)(o.EuiFormRow,{id:"indexConnectorSelectSearchBox",fullWidth:!0,label:u.g,isInvalid:a,error:l},Object(f.jsx)(o.EuiComboBox,{fullWidth:!0,singleSelection:!0,async:!0,placeholder:u.j,"aria-label":u.i,isLoading:s,isInvalid:a,noSuggestions:!t.length,options:t,"data-test-subj":"search-parent-issues","data-testid":"search-parent-issues",selectedOptions:c,onChange:t=>{var s;e.setValue(t.length&&null!==(s=t[0].value)&&void 0!==s?s:"")},onSearchChange:n}))};I.displayName="SearchIssuesField";const S=({actionConnector:e})=>{var t,s;const{http:i}=Object(d.g)().services,[{fields:o}]=Object(r.useFormData)({watch:["fields.parent"]}),[a,l]=Object(n.useState)(null),{isUserTyping:b,onContentChange:O,onDebounce:S}=Object(y.a)(),{isFetching:E,data:x}=(({http:e,actionConnector:t,query:s,onDebounce:i=c.noop})=>{var o;const[a,r]=Object(n.useState)(s);h()((()=>{r(s),i()}),m.Xb,[s]);const{showErrorToast:l}=Object(j.a)();return Object(p.useQuery)(g.a.jiraGetIssues(null!==(o=null==t?void 0:t.id)&&void 0!==o?o:"",null!=a?a:""),(({signal:n})=>{var i;return Object(v.d)({http:e,signal:n,connectorId:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"",title:null!=s?s:""})}),{enabled:Boolean(t)&&!Object(c.isEmpty)(s),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&l(new Error(u.c),{title:u.c,toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{l(e,{title:u.c})}})})({http:i,actionConnector:e,query:a,onDebounce:S}),{isFetching:F,data:T}=(({http:e,actionConnector:t,id:s})=>{var n;const{showErrorToast:i}=Object(j.a)();return Object(p.useQuery)(g.a.jiraGetIssue(null!==(n=null==t?void 0:t.id)&&void 0!==n?n:"",s),(({signal:n})=>{var i;return Object(v.b)({http:e,signal:n,connectorId:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"",id:s})}),{enabled:Boolean(t&&!Object(c.isEmpty)(s)),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&i(new Error(u.b(s)),{title:u.b(s),toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{i(e,{title:u.b(s)})}})})({http:i,actionConnector:e,id:null!==(t=null==o?void 0:o.parent)&&void 0!==t?t:""}),w=b||E||F,C=[...null!==(s=null==x?void 0:x.data)&&void 0!==s?s:[],...null!=T&&T.data?[T.data]:[]].map((e=>({label:e.title,value:e.key})));return Object(f.jsx)(r.UseField,{path:"fields.parent",component:I,componentProps:{isLoading:w,onSearchComboChange:e=>{Object(c.isEmpty)(e)||l(e),O(e)},options:C}})};S.displayName="SearchIssues";const E=Object(n.memo)(S),{emptyField:x}=l.fieldValidators,F=({connector:e})=>{var t;const[{fields:s}]=Object(r.useFormData)(),{http:l}=Object(d.g)().services,{issueType:y}=null!=s?s:{},{isLoading:O,isFetching:h,data:m}=Object(b.a)({connector:e,http:l}),I=(null!==(t=null==m?void 0:m.data)&&void 0!==t?t:[]).map((e=>{var t,s;return{text:null!==(t=e.name)&&void 0!==t?t:"",value:null!==(s=e.id)&&void 0!==s?s:""}})),{isLoading:S,isFetching:F,data:T}=(({http:e,connector:t,issueType:s})=>{var n;const{showErrorToast:i}=Object(j.a)();return Object(p.useQuery)(g.a.jiraGetFieldsByIssueType(null!==(n=null==t?void 0:t.id)&&void 0!==n?n:"",null!=s?s:""),(({signal:n})=>{var i;return Object(v.a)({http:e,signal:n,connectorId:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"",id:null!=s?s:""})}),{enabled:Boolean(t)&&!Object(c.isEmpty)(s),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&i(new Error(u.a),{title:u.a,toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{i(e,{title:u.a})}})})({connector:e,http:l,issueType:y}),w=null==T?void 0:T.data,C=null!=(null==w?void 0:w.priority),G=null!=(null==w?void 0:w.parent),M=O||h,A=S||F,B=Object(n.useMemo)((()=>{var e,t;const s=null!==(e=null==w||null===(t=w.priority)||void 0===t?void 0:t.allowedValues)&&void 0!==e?e:[];return Object(i.map)((e=>({text:e.name,value:e.name})),s)}),[w]);return Object(f.jsx)("div",{"data-test-subj":"connector-fields-jira"},Object(f.jsx)(r.UseField,{path:"fields.issueType",component:a.SelectField,config:{label:u.d,validations:[{validator:x(u.f)}]},componentProps:{euiFieldProps:{"data-test-subj":"issueTypeSelect",options:I,fullWidth:!0,disabled:M,isLoading:M,hasNoInitialSelection:!0}}}),Object(f.jsx)(o.EuiSpacer,{size:"m"}),Object(f.jsx)(o.EuiSkeletonText,{lines:5,size:"m",isLoading:A&&!M&&!Object(c.isEmpty)(y),"data-test-subj":"fields-by-issue-type-loading"},Object(f.jsx)("div",{style:{display:G?"block":"none"}},Object(f.jsx)(o.EuiFlexGroup,null,Object(f.jsx)(o.EuiFlexItem,null,Object(f.jsx)(E,{actionConnector:e}))),Object(f.jsx)(o.EuiSpacer,{size:"m"})),Object(f.jsx)("div",{style:{display:C?"block":"none"}},Object(f.jsx)(o.EuiFlexGroup,null,Object(f.jsx)(o.EuiFlexItem,null,Object(f.jsx)(r.UseField,{path:"fields.priority",component:a.SelectField,config:{label:u.h},componentProps:{euiFieldProps:{"data-test-subj":"prioritySelect",options:B,fullWidth:!0,disabled:M||A,isLoading:A}}}))))))};F.displayName="JiraFields"}}]);