/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.logstash_bundle_jsonpfunction=window.logstash_bundle_jsonpfunction||[]).push([[1],{24:function(e,t,i){e.exports=i(8)(4)},25:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(17),n=i(12),a=s.__importDefault(i(26));t.default=function(e,t){var i=n.useState(t),s=i[0],l=i[1];return a.default((function(){var t=e.subscribe(l);return function(){return t.unsubscribe()}}),[e]),s}},26:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(12),n="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;t.default=n},27:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var s=void 0;t.setEuiDevProviderWarning=function(e){return s=e},t.getEuiDevProviderWarning=function(){return s},t.emitEuiProviderWarning=function(e){if("function"==typeof s)return s(e);switch(s){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},28:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(17),n=i(12),a=s.__importDefault(i(29));t.default=function(){var e=a.default();return n.useCallback((function(t){return new Promise((function(i,s){t.then((function(t){e()&&i(t)}),(function(t){e()&&s(t)}))}))}),[])}},29:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(12);t.default=function(){var e=s.useRef(!1),t=s.useCallback((function(){return e.current}),[]);return s.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},30:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(17),n=i(31),a=s.__importDefault(i(33));t.default=function(e,t){a.default(e,t,n.isDeepEqual)}},31:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var s=i(17).__importDefault(i(32));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.removeEventListener.apply(e,t)},t.isDeepEqual=s.default},32:function(e,t,i){"use strict";e.exports=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var s,n,a;if(Array.isArray(t)){if((s=t.length)!=i.length)return!1;for(n=s;0!=n--;)if(!e(t[n],i[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((s=(a=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(n=s;0!=n--;)if(!Object.prototype.hasOwnProperty.call(i,a[n]))return!1;for(n=s;0!=n--;){var l=a[n];if(!("_owner"===l&&t.$$typeof||e(t[l],i[l])))return!1}return!0}return t!=t&&i!=i}},33:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(12);t.default=function(e,t,i){var n=s.useRef(void 0);n.current&&i(t,n.current)||(n.current=t),s.useEffect(e,n.current)}},35:function(e,t,i){"use strict";i.r(t),i.d(t,"renderApp",(function(){return de}));var s=i(12),n=i.n(s),a=i(19),l=i.n(a),o=i(16),r=i(18),c=i(13);const p=({children:e,...t})=>Object(c.jsx)(o.Router,t,Object(c.jsx)(r.CompatRouter,null,e));var u=i(0),d=i(24),g=i.n(d);const h={services:{}},b=Object(s.createContext)(h);var j=i(30),f=i.n(j);const m=({children:e,component:t,render:i,...a})=>{const l=Object(s.useMemo)((()=>{if(t)return e=>Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(x,null),Object(c.jsx)(t,e))}),[t]);if(l)return Object(c.jsx)(o.Route,g()({},a,{component:l}));if(i||"function"==typeof e){const t="function"==typeof e?e:i;return Object(c.jsx)(o.Route,g()({},a,{render:e=>Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(x,null),t(e))}))}return Object(c.jsx)(o.Route,a,Object(c.jsx)(x,null),e)},x=()=>{const{executionContext:e}=Object(s.useContext)(b).services,t=Object(o.useRouteMatch)();return function(e,t){f()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null},M=({legacySwitch:e=!0,children:t})=>{const i=Object(o.useRouteMatch)();return e?Object(c.jsx)(o.Switch,null,t):Object(c.jsx)(r.Routes,null,s.Children.map(t,(e=>{if(n.a.isValidElement(e)&&e.type===m){var s;const a=Object(u.replace)(null==e?void 0:e.props.path,i.url+"/",""),l="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(c.jsx)(r.Route,{path:a,element:Object(c.jsx)(n.a.Fragment,null,Object(c.jsx)(x,null),(null==e||null===(s=e.props)||void 0===s?void 0:s.component)&&Object(c.jsx)(e.props.component,null)||l&&l()||t)})}return e})))};var O=i(3),E=i(20),P=i(27),y=i(25),v=i.n(y),S=i(21),C=i.n(S),T=i(14);const k="eui-global",w="eui-utilities",D={darkMode:!1},L=[T.euiStylisPrefixer],_=C()({key:"css",stylisPlugins:L,container:document.querySelector('meta[name="emotion"]')}),I=C()({key:k,stylisPlugins:L,container:document.querySelector(`meta[name="${k}"]`)}),R=C()({key:w,stylisPlugins:L,container:document.querySelector(`meta[name="${w}"]`)});_.compat=!0,I.compat=!0,R.compat=!0;const F={default:_,global:I,utility:R},N=({theme:{theme$:e},globalStyles:t,colorMode:i,modify:n,children:a})=>{const l=v()(e,D),o=Object(s.useMemo)((()=>(e=>e.darkMode?T.COLOR_MODES_STANDARD.dark:T.COLOR_MODES_STANDARD.light)(l)),[l]),r=i||o,p=!1!==t&&void 0;return Object(c.jsx)(T.EuiProvider,{cache:F,modify:n,colorMode:r,globalStyles:p,utilityClasses:p},a)},A=({children:e,i18n:t,...i})=>Object(E.useIsNestedEuiProvider)()?(Object(P.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(c.jsx)(t.Context,null,e)):Object(c.jsx)(N,i,Object(c.jsx)(t.Context,null,e));var B=i(22);const U=({children:e,...t})=>Object(c.jsx)(A,g()({globalStyles:!1},t),Object(c.jsx)(B.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(c.jsx)(B.KibanaErrorBoundary,null,e)));var q=i(6),z=i(2),W=i.n(z),Q=i(15);function G(){return Object(c.jsx)("p",null,Object(c.jsx)("strong",null,Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.addRoleAlert.grantAdditionalPrivilegesTitle",defaultMessage:"Grant additional privileges."})),Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.addRoleAlert.grantAdditionalPrivilegesDescription",defaultMessage:"In Kibana Management, assign the {role} role to your Kibana user.",values:{role:Object(c.jsx)(T.EuiCode,null,"monitoring_user")}}))}var $=i(1);const Y={INITIAL_PAGE_SIZE:20,PAGE_SIZE_OPTIONS:[5,8,20,50],PIPELINE_NOT_CENTRALLY_MANAGED_TOOLTIP_TEXT:$.i18n.translate("xpack.logstash.pipelineNotCentrallyManagedTooltip",{defaultMessage:"This pipeline wasn't created using Centralized Configuration Management. It can't be managed or edited here."}),INFO_ALERTS:{CALL_OUT_TITLE:$.i18n.translate("xpack.logstash.kibanaManagementPipelinesTitle",{defaultMessage:"Only pipelines created in Kibana Management appear here"})}};function K(e){return Object(c.jsx)(T.EuiCallOut,{title:Y.INFO_ALERTS.CALL_OUT_TITLE,color:"warning",iconType:"help"},Object(c.jsx)("p",null,Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.alertCallOut.howToSeeAdditionalPipelinesDescription",defaultMessage:"How can I see additional pipelines?"})),e.children)}function H(){return Object(c.jsx)("p",null,Object(c.jsx)("strong",null,Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.enableMonitoringAlert.enableMonitoringTitle",defaultMessage:"Enable monitoring."})),Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.enableMonitoringAlert.enableMonitoringDescription",defaultMessage:"In the {configFileName} file, set {monitoringConfigParam} and {monitoringUiConfigParam} to {trueValue}.",values:{configFileName:Object(c.jsx)(T.EuiCode,null,"kibana.yml"),monitoringConfigParam:Object(c.jsx)(T.EuiCode,null,"xpack.monitoring.enabled"),monitoringUiConfigParam:Object(c.jsx)(T.EuiCode,null,"xpack.monitoring.ui.enabled"),trueValue:Object(c.jsx)(T.EuiCode,null,"true")}}))}function V({showAddRoleAlert:e,showEnableMonitoringAlert:t}){return e||t?Object(c.jsx)(K,null,e&&Object(c.jsx)(G,null),t&&Object(c.jsx)(H,null)):null}const Z=Object(Q.injectI18n)((function({clonePipeline:e,createPipeline:t,isReadOnly:i,isSelectable:s,message:n,onDeleteSelectedPipelines:a,onSelectionChange:l,openPipeline:o,pipelines:r,selection:p,pageIndex:u,intl:d}){const g={pageIndex:u,initialPageSize:Y.INITIAL_PAGE_SIZE,totalItemCount:r.length,pageSizeOptions:Y.PAGE_SIZE_OPTIONS},h=s?{selectable:({isCentrallyManaged:e})=>e,selectableMessage:(e,{id:t})=>e?d.formatMessage({id:"xpack.logstash.pipelinesTable.selectablePipelineMessage",defaultMessage:'Select pipeline "{id}"'},{id:t}):Y.PIPELINE_NOT_CENTRALLY_MANAGED_TOOLTIP_TEXT,onSelectionChange:l}:null,b=p.length&&!i?Object(c.jsx)(T.EuiButton,{key:"btnDeletePipelines",color:"danger",onClick:a,"data-test-subj":"btnDeletePipeline"},Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelinesTable.deleteButtonLabel",defaultMessage:"Delete"})):null,j={box:{incremental:!0,"data-test-subj":"filter"},filters:[{type:"field_value_selection",field:"id",name:$.i18n.translate("xpack.logstash.pipelinesTable.filterByIdLabel",{defaultMessage:"Filter by ID"}),multiSelect:!1,options:r.map((({id:e})=>({value:e,name:e,view:e})))}],toolsLeft:b,toolsRight:Object(c.jsx)(T.EuiButton,{isDisabled:i,key:"btnAdd",fill:!0,onClick:t,"data-test-subj":"btnAdd"},Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelinesTable.createPipelineButtonLabel",defaultMessage:"Create pipeline"}))},f=function(e,t){return[{field:"id",name:$.i18n.translate("xpack.logstash.pipelinesTable.idColumnLabel",{defaultMessage:"Id"}),sortable:!0,render:(t,{isCentrallyManaged:i})=>i?Object(c.jsx)(T.EuiLink,{onClick:()=>e(t),"data-test-subj":"cellId"},t):Object(c.jsx)("span",null,t,"  ",Object(c.jsx)(T.EuiIconTip,{content:Y.PIPELINE_NOT_CENTRALLY_MANAGED_TOOLTIP_TEXT,type:"questionInCircle"}))},{field:"description",name:$.i18n.translate("xpack.logstash.pipelinesTable.descriptionColumnLabel",{defaultMessage:"Description"}),render:e=>Object(c.jsx)("span",{"data-test-subj":"cellDescription"},e),sortable:!0,truncateText:!0},{field:"lastModifiedHumanized",name:$.i18n.translate("xpack.logstash.pipelinesTable.lastModifiedColumnLabel",{defaultMessage:"Last modified"}),render:e=>Object(c.jsx)("span",{"data-test-subj":"cellLastModified"},e),sortable:({lastModified:e})=>e.valueOf()},{field:"username",name:$.i18n.translate("xpack.logstash.pipelinesTable.modifiedByColumnLabel",{defaultMessage:"Modified by"}),render:e=>Object(c.jsx)("span",{"data-test-subj":"cellUsername"},e),sortable:!0},{field:"id",name:"",render:(e,{isCentrallyManaged:i})=>i?Object(c.jsx)(T.EuiButtonEmpty,{"data-test-subj":`lnkPipelineClone-${e}`,iconType:"copy",onClick:()=>{t(e)},size:"xs"},Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelinesTable.cloneButtonLabel",defaultMessage:"Clone"})):null,sortable:!1,width:"100px"}]}(o,e);return Object(c.jsx)(T.EuiInMemoryTable,{columns:f,"data-test-subj":"pipelineTable",itemId:"id",items:r,message:n,pagination:g,search:j,selection:h,sorting:!0,rowProps:{"data-test-subj":"row"}})}));function X({cancelDeletePipelines:e,deleteSelectedPipelines:t,selection:i,showConfirmDeleteModal:s}){if(!s)return null;const n=i.length,a=1===n?{message:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelineWarningMessage",defaultMessage:"You cannot recover a deleted pipeline"}),button:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelineConfirmButtonLabel",defaultMessage:"Delete pipeline"}),title:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelineTitle",defaultMessage:'Delete pipeline "{id}"',values:{id:i[0].id}})}:{message:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelinesWarningMessage",defaultMessage:"You cannot recover deleted pipelines."}),button:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelinesConfirmButtonLabel",defaultMessage:"Delete {numPipelinesSelected} pipelines",values:{numPipelinesSelected:n}}),title:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.deletedPipelinesTitle",defaultMessage:"Delete {numPipelinesSelected} pipelines",values:{numPipelinesSelected:n}})};return Object(c.jsx)(T.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeleteModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:a.button,defaultFocusedButton:T.EUI_MODAL_CANCEL_BUTTON,onCancel:e,onConfirm:t,title:a.title},Object(c.jsx)("p",null,a.message))}class pipeline_list_PipelineListUi extends n.a.Component{constructor(e){super(e),W()(this,"componentDidMount",(()=>{const{isReadOnly:e,licenseService:t,toastNotifications:i}=this.props;this.loadPipelines().then((()=>{e&&i.addWarning(t.message)})),this.checkMonitoringAccess()})),W()(this,"getEmptyPrompt",(()=>Object(c.jsx)(T.EuiEmptyPrompt,{title:Object(c.jsx)("h2",null,Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.noPipelinesTitle",defaultMessage:"No pipelines"})),titleSize:"xs",body:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.noPipelinesDescription",defaultMessage:"There are no pipelines defined."})}))),W()(this,"getErrorPrompt",(()=>Object(c.jsx)(T.EuiEmptyPrompt,{title:Object(c.jsx)("h2",null,Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.pipelinesLoadingErrorTitle",defaultMessage:"Error"})),titleSize:"xs",body:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.pipelinesLoadingErrorDescription",defaultMessage:"Error encountered while loading pipelines."})}))),W()(this,"loadPipelines",(()=>{const{isReadOnly:e,licenseService:t,pipelinesService:i,toastNotifications:s,intl:n}=this.props;return this.setState({message:Object(c.jsx)("div",{"data-test-subj":"loadingPipelines"},Object(c.jsx)(T.EuiLoadingSpinner,{size:"m"})," "," ",Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.pipelinesLoadingMessage",defaultMessage:"Loading pipelines…"}))}),i.getPipelineList().then((e=>{this.setState({isLoading:!1,isForbidden:!1,isSelectable:!0,pipelines:e}),e.length||this.setState({columns:[],message:this.getEmptyPrompt(),isSelectable:!1})})).catch((i=>(this.setState({isLoading:!1,message:this.getErrorPrompt()}),t.checkValidity().then((()=>{403===i.status?(this.setState({isLoading:!1}),e?this.setState({isForbidden:!1}):this.setState({isForbidden:!0})):(this.setState({isForbidden:!1}),s.addDanger(n.formatMessage({id:"xpack.logstash.pipelineList.pipelineLoadingErrorNotification",defaultMessage:'Couldn\'t load pipeline. Error: "{errStatusText}".'},{errStatusText:i.statusText})))})))))})),W()(this,"checkMonitoringAccess",(()=>{const{clusterService:e,monitoringService:t}=this.props;e.isClusterInfoAvailable().then((e=>{this.setState({showAddRoleAlert:!e,showEnableMonitoringAlert:!t.isMonitoringEnabled()})}))})),W()(this,"renderNoPermissionCallOut",(()=>{const{isForbidden:e,isLoading:t}=this.state;return e&&!t?Object(c.jsx)(T.EuiCallOut,{color:"danger",iconType:"cross",title:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.noPermissionToManageTitle",defaultMessage:"You do not have permission to manage Logstash pipelines."})},Object(c.jsx)("p",null,Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.noPermissionToManageDescription",defaultMessage:"Please contact your administrator."}))):null})),W()(this,"hideDeletePipelinesModal",(()=>{this.setState({showConfirmDeleteModal:!1})})),W()(this,"showDeletePipelinesModal",(()=>{this.setState({showConfirmDeleteModal:!0})})),W()(this,"cancelDeletePipelines",(()=>{this.hideDeletePipelinesModal()})),W()(this,"deleteSelectedPipelines",(()=>{this.hideDeletePipelinesModal();const{licenseService:e,pipelinesService:t,toastNotifications:i,intl:s}=this.props,{selection:n}=this.state,a=n.length,l=n.map((({id:e})=>e));return t.deletePipelines(l).then((e=>{const{numSuccesses:t,numErrors:l}=e;if(1===t&&0===l)i.addSuccess(s.formatMessage({id:"xpack.logstash.pipelineList.pipelinesSuccessfullyDeletedNotification",defaultMessage:'Deleted "{id}"'},{id:n[0].id}));else if(t){let e;l&&(e=s.formatMessage({id:"xpack.logstash.pipelineList.pipelinesCouldNotBeDeletedDescription",defaultMessage:"But {numErrors, plural, one {# Pipeline} other {# Pipelines}} couldn't be deleted."},{numErrors:l})),i.addSuccess({title:s.formatMessage({id:"xpack.logstash.pipelineList.successfullyDeletedPipelinesNotification",defaultMessage:"Deleted {numSuccesses} out of {numPipelinesSelected, plural, one {# Pipeline} other {# Pipelines}}"},{numSuccesses:t,numPipelinesSelected:a,numPipelinesSelected:a}),text:e})}else l&&i.addError(s.formatMessage({id:"xpack.logstash.pipelineList.couldNotDeletePipelinesNotification",defaultMessage:"Failed to delete {numErrors, plural, one {# Pipeline} other {# Pipelines}}"},{numErrors:l}));this.loadPipelines()})).catch((t=>e.checkValidity().then((()=>i.addDanger(t)))))})),W()(this,"onDeleteSelectedPipelines",(()=>{this.showDeletePipelinesModal()})),W()(this,"onSelectionChange",(e=>this.setState({selection:e}))),this.state={columns:[],isForbidden:!1,isLoading:!0,isSelectable:!1,pipelines:[],showAddRoleAlert:!1,showConfirmDeleteModal:!1,showEnableMonitoringAlert:!1,selection:[]}}render(){const{clonePipeline:e,createPipeline:t,isReadOnly:i,openPipeline:s}=this.props,{isSelectable:n,message:a,pipelines:l,selection:o,showConfirmDeleteModal:r}=this.state;return Object(c.jsx)(T.EuiPageSection,{"data-test-subj":"pipelineList"},Object(c.jsx)(T.EuiPageHeader,{pageTitle:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.head",defaultMessage:"Pipelines"}),description:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineList.subhead",defaultMessage:"Manage logstash event processing and see the result visually"}),bottomBorder:!0}),Object(c.jsx)(T.EuiSpacer,{size:"l"}),this.renderNoPermissionCallOut(),Object(c.jsx)(Z,{clonePipeline:e,createPipeline:t,isReadOnly:i,isSelectable:n,message:a,pipelines:l,selection:o,onDeleteSelectedPipelines:this.onDeleteSelectedPipelines,onSelectionChange:this.onSelectionChange,openPipeline:s}),Object(c.jsx)(X,{cancelDeletePipelines:this.cancelDeletePipelines,deleteSelectedPipelines:this.deleteSelectedPipelines,selection:o,showConfirmDeleteModal:r}),Object(c.jsx)(V,{showAddRoleAlert:this.state.showAddRoleAlert,showEnableMonitoringAlert:this.state.showEnableMonitoringAlert}))}}const J=Object(Q.injectI18n)(pipeline_list_PipelineListUi);var ee=i(28),te=i.n(ee),ie=i(5),se=i(23);const ne={DELETE_PIPELINE_MODAL_MESSAGE:$.i18n.translate("xpack.logstash.deletePipelineModalMessage",{defaultMessage:"You cannot recover a deleted pipeline."}),ID_REQUIRED_ERR_MSG:$.i18n.translate("xpack.logstash.pipelineIdRequiredMessage",{defaultMessage:"Pipeline ID is required"}),ID_FORMAT_ERR_MSG:$.i18n.translate("xpack.logstash.idFormatErrorMessage",{defaultMessage:"Pipeline ID must begin with a letter or underscore and contain only letters, underscores, dashes, and numbers"}),QUEUE_TYPES:[{"data-test-subj":"selectQueueType-memory",text:$.i18n.translate("xpack.logstash.queueTypes.memoryLabel",{defaultMessage:"memory"}),value:"memory"},{"data-test-subj":"selectQueueType-persisted",text:$.i18n.translate("xpack.logstash.queueTypes.persistedLabel",{defaultMessage:"persisted"}),value:"persisted"}],UNITS:[{"data-test-subj":"selectQueueMaxBytesUnits-b",text:$.i18n.translate("xpack.logstash.units.bytesLabel",{defaultMessage:"bytes"}),value:"b"},{"data-test-subj":"selectQueueMaxBytesUnits-kb",text:$.i18n.translate("xpack.logstash.units.kilobytesLabel",{defaultMessage:"kilobytes"}),value:"kb"},{"data-test-subj":"selectQueueMaxBytesUnits-mb",text:$.i18n.translate("xpack.logstash.units.megabytesLabel",{defaultMessage:"megabytes"}),value:"mb"},{"data-test-subj":"selectQueueMaxBytesUnits-gb",text:$.i18n.translate("xpack.logstash.units.gigabytesLabel",{defaultMessage:"gigabytes"}),value:"gb"},{"data-test-subj":"selectQueueMaxBytesUnits-tb",text:$.i18n.translate("xpack.logstash.units.terabytesLabel",{defaultMessage:"terabytes"}),value:"tb"},{"data-test-subj":"selectQueueMaxBytesUnits-pb",text:$.i18n.translate("xpack.logstash.units.petabytesLabel",{defaultMessage:"petabytes"}),value:"pb"}]};function ae({id:e,cancelDeleteModal:t,confirmDeletePipeline:i}){return Object(c.jsx)(T.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeletePipelineModal.cancelButtonText",defaultMessage:"Cancel"}),confirmButtonText:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeletePipelineModal.confirmButtonText",defaultMessage:"Delete pipeline"}),defaultFocusedButton:T.EUI_MODAL_CANCEL_BUTTON,onCancel:t,onConfirm:i,title:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.confirmDeletePipelineModal.deletePipelineTitle",defaultMessage:"Delete pipeline {id}",values:{id:e}})},Object(c.jsx)("p",null,ne.DELETE_PIPELINE_MODAL_MESSAGE))}function le({formRowLabelText:e,formRowTooltipText:t}){return Object(c.jsx)("div",null,Object(c.jsx)("span",null,e)," ",Object(c.jsx)(T.EuiIconTip,{content:t,size:"s",type:"questionInCircle"}))}function oe(e){const{formRowLabelText:t,formRowTooltipText:i}=e,s=t&&i?Object(c.jsx)(le,{formRowLabelText:t,formRowTooltipText:i}):null;return Object(c.jsx)(T.EuiFlexItem,{grow:!1},Object(c.jsx)(T.EuiFormRow,{label:s,hasEmptyLabelSpace:!s},e.children))}class pipeline_editor_PipelineEditorUi extends n.a.Component{constructor(e){super(e),W()(this,"componentDidMount",(()=>{const{licenseService:{isReadOnly:e,message:t},toastNotifications:i}=this.props;e&&i.addWarning(t)})),W()(this,"hideConfirmDeleteModal",(()=>{this.setState({showConfirmDeleteModal:!1})})),W()(this,"showConfirmDeleteModal",(()=>{this.setState({showConfirmDeleteModal:!0})})),W()(this,"onPipelineIdChange",(({target:{value:e}})=>{const t=[];e||t.push(ne.ID_REQUIRED_ERR_MSG),this.state.pipelineIdPattern.test(e)||t.push(ne.ID_FORMAT_ERR_MSG),this.setState({pipelineIdErrors:t,showPipelineIdError:!!t.length,pipeline:{...this.state.pipeline,id:e}})})),W()(this,"isSaveDisabled",(()=>this.state.showPipelineIdError||Object(u.isEmpty)(this.state.pipeline.id))),W()(this,"onClose",(async()=>{await this.props.close()})),W()(this,"open",(async()=>{const{id:e}=this.state.pipeline;e&&await this.props.open(e)})),W()(this,"onPipelineSave",(()=>{const{pipelineService:e,toastNotifications:t,intl:i}=this.props,{id:s,...n}=this.state.pipeline;return e.savePipeline({id:s,upstreamJSON:n}).then((()=>{t.addSuccess(i.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineSuccessfullySavedMessage",defaultMessage:'Saved "{id}"'},{id:s})),this.onClose()})).catch(this.notifyOnError)})),W()(this,"onPipelineDescriptionChange",(({target:{value:e}})=>{this.setState({pipeline:{...this.state.pipeline,description:e}})})),W()(this,"onPipelineChange",(e=>{this.setState({pipeline:{...this.state.pipeline,pipeline:e}})})),W()(this,"handleNumberChange",((e,t)=>{const i=parseInt(t,10);this.handleSettingChange(e,isNaN(i)?t:i)})),W()(this,"handleMaxByteNumberChange",(e=>{this.setState({maxBytesNumber:parseInt(e,10)}),this.handleSettingChange("queue.max_bytes",e+this.state.maxBytesUnit)})),W()(this,"handleMaxByteUnitChange",(e=>{this.setState({maxBytesUnit:e}),this.handleSettingChange("queue.max_bytes",this.state.maxBytesNumber+e)})),W()(this,"handleSettingChange",((e,t)=>{const i={...this.state.pipeline.settings};i[e]=t,this.setState({pipeline:{...this.state.pipeline,settings:i}})})),W()(this,"notifyOnError",(e=>{const{licenseService:t,toastNotifications:i}=this.props;return t.checkValidity().then((()=>{i.addError(e,{title:$.i18n.translate("xpack.logstash.pipelineEditor.errorHandlerToastTitle",{defaultMessage:"Pipeline error"})})}))})),W()(this,"deletePipeline",(()=>{const{pipeline:{id:e},pipelineService:t,toastNotifications:i,intl:s}=this.props;return this.hideConfirmDeleteModal(),t.deletePipeline(e).then((()=>{i.addSuccess(s.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineSuccessfullyDeletedMessage",defaultMessage:'Deleted "{id}"'},{id:e})),this.onClose()})).catch(this.notifyOnError)})),W()(this,"getPipelineHeadingText",(()=>{const{clone:e,id:t,isNewPipeline:i,intl:s}=this.props;return e&&t?s.formatMessage({id:"xpack.logstash.pipelineEditor.clonePipelineTitle",defaultMessage:'Clone Pipeline "{id}"'},{id:t}):i?s.formatMessage({id:"xpack.logstash.pipelineEditor.createPipelineTitle",defaultMessage:"Create Pipeline"}):s.formatMessage({id:"xpack.logstash.pipelineEditor.editPipelineTitle",defaultMessage:'Edit Pipeline "{id}"'},{id:this.state.pipeline.id})}));const{pipeline:{id:t,description:i,pipeline:s,settings:n}}=this.props,a="number"==typeof n["pipeline.workers"]?n["pipeline.workers"]:1;this.state={maxBytesNumber:n["queue.max_bytes.number"],maxBytesUnit:n["queue.max_bytes.units"],pipeline:{id:t,description:i,pipeline:s,settings:{"pipeline.batch.delay":n["pipeline.batch.delay"],"pipeline.batch.size":n["pipeline.batch.size"],"pipeline.workers":a,"queue.checkpoint.writes":n["queue.checkpoint.writes"],"queue.max_bytes":n["queue.max_bytes.number"]+n["queue.max_bytes.units"],"queue.type":n["queue.type"]}},pipelineIdErrors:[],pipelineIdPattern:/^[A-Za-z\_][A-Za-z0-9\-\_]*$/,showConfirmDeleteModal:!1,showPipelineIdError:!1}}render(){const{intl:e}=this.props;return Object(c.jsx)(T.EuiPageSection,{style:{width:"100%"},restrictWidth:!0,"data-test-subj":`pipelineEdit pipelineEdit-${this.state.pipeline.id}`},Object(c.jsx)(T.EuiPageHeader,{pageTitle:this.getPipelineHeadingText(),bottomBorder:!0}),Object(c.jsx)(T.EuiSpacer,{size:"l"}),Object(c.jsx)(T.EuiForm,{isInvalid:this.state.showPipelineIdError,error:this.state.pipelineIdErrors},this.props.isNewPipeline&&Object(c.jsx)(T.EuiFormRow,{fullWidth:!0,label:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineEditor.pipelineIdFormRowLabel",defaultMessage:"Pipeline ID"})},Object(c.jsx)(T.EuiFieldText,{fullWidth:!0,"data-test-subj":"inputId",isInvalid:this.state.showPipelineIdError,name:"pipelineId",onBlur:this.onPipelineIdChange,onChange:this.onPipelineIdChange,value:this.state.pipeline.id||""})),Object(c.jsx)(T.EuiFormRow,{fullWidth:!0,label:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineEditor.descriptionFormRowLabel",defaultMessage:"Description"})},Object(c.jsx)(T.EuiFieldText,{"data-test-subj":"inputDescription",fullWidth:!0,name:"pipelineDescription",onChange:this.onPipelineDescriptionChange,value:this.state.pipeline.description||""})),Object(c.jsx)(T.EuiFormRow,{fullWidth:!0,label:Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineEditor.pipelineFormRowLabel",defaultMessage:"Pipeline"})},Object(c.jsx)("div",{"data-test-subj":"pipelineField"},Object(c.jsx)(se.CodeEditor,{languageId:"text",value:this.state.pipeline.pipeline,height:500,options:{lineNumbers:"on",tabSize:2,automaticLayout:!0},"aria-label":$.i18n.translate("xpack.logstash.pipelineEditor.pipelineEditorField",{defaultMessage:"Pipeline editor"}),onChange:this.onPipelineChange}))),Object(c.jsx)(T.EuiFormRow,{label:Object(c.jsx)(le,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineWorkersFormRowLabel",defaultMessage:"Pipeline workers"}),formRowTooltipText:ie.a.settings["pipeline.workers"]})},Object(c.jsx)(T.EuiFieldNumber,{"data-test-subj":"inputWorkers",onChange:e=>this.handleNumberChange("pipeline.workers",e.target.value),value:this.state.pipeline.settings["pipeline.workers"]})),Object(c.jsx)(T.EuiSpacer,null),Object(c.jsx)(T.EuiFlexGroup,null,Object(c.jsx)(oe,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineBatchSizeFormRowLabel",defaultMessage:"Pipeline batch size"}),formRowTooltipText:ie.a.settings["pipeline.batch.size"]},Object(c.jsx)(T.EuiFieldNumber,{"data-test-subj":"inputBatchSize",onChange:e=>this.handleNumberChange("pipeline.batch.size",e.target.value),value:this.state.pipeline.settings["pipeline.batch.size"]})),Object(c.jsx)(oe,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.pipelineBatchDelayFormRowLabel",defaultMessage:"Pipeline batch delay"}),formRowTooltipText:ie.a.settings["pipeline.batch.delay"]},Object(c.jsx)(T.EuiFieldNumber,{"data-test-subj":"inputBatchDelay",onChange:e=>this.handleNumberChange("pipeline.batch.delay",e.target.value),value:this.state.pipeline.settings["pipeline.batch.delay"]}))),Object(c.jsx)(T.EuiFlexGroup,null,Object(c.jsx)(oe,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.queueTypeFormRowLabel",defaultMessage:"Queue type"}),formRowTooltipText:ie.a.settings["queue.type"]},Object(c.jsx)(T.EuiSelect,{"data-test-subj":"selectQueueType",onChange:e=>this.handleSettingChange("queue.type",e.target.value),options:ne.QUEUE_TYPES,value:this.state.pipeline.settings["queue.type"]})),Object(c.jsx)(oe,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.queueMaxBytesFormRowLabel",defaultMessage:"Queue max bytes"}),formRowTooltipText:ie.a.settings["queue.max_bytes"]},Object(c.jsx)(T.EuiFieldNumber,{"data-test-subj":"inputQueueMaxBytesNumber",onChange:e=>this.handleMaxByteNumberChange(e.target.value),value:this.state.maxBytesNumber})),Object(c.jsx)(oe,null,Object(c.jsx)(T.EuiSelect,{"data-test-subj":"selectQueueMaxBytesUnits",onChange:e=>this.handleMaxByteUnitChange(e.target.value),options:ne.UNITS,value:this.state.maxBytesUnit})),Object(c.jsx)(oe,{formRowLabelText:e.formatMessage({id:"xpack.logstash.pipelineEditor.queueCheckpointWritesFormRowLabel",defaultMessage:"Queue checkpoint writes"}),formRowTooltipText:ie.a.settings["queue.checkpoint.writes"]},Object(c.jsx)(T.EuiFieldNumber,{"data-test-subj":"inputQueueCheckpointWrites",onChange:e=>this.handleNumberChange("queue.checkpoint.writes",e.target.value),value:this.state.pipeline.settings["queue.checkpoint.writes"]})))),Object(c.jsx)(T.EuiSpacer,{size:"l"}),Object(c.jsx)(T.EuiFlexGroup,{justifyContent:"flexStart"},Object(c.jsx)(T.EuiFlexItem,{grow:!1},Object(c.jsx)(T.EuiButton,{"data-test-subj":"btnSavePipeline",fill:!0,isDisabled:this.isSaveDisabled(),onClick:this.onPipelineSave},Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineEditor.createAndDeployButtonLabel",defaultMessage:"Create and deploy"}))),Object(c.jsx)(T.EuiFlexItem,{grow:!1},Object(c.jsx)(T.EuiButton,{"data-test-subj":"btnCancel",onClick:this.onClose},Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineEditor.cancelButtonLabel",defaultMessage:"Cancel"}))),!this.props.isNewPipeline&&Object(c.jsx)(T.EuiFlexItem,{grow:!1},Object(c.jsx)(T.EuiButtonEmpty,{color:"danger","data-test-subj":"btnDeletePipeline",onClick:this.showConfirmDeleteModal},Object(c.jsx)(Q.FormattedMessage,{id:"xpack.logstash.pipelineEditor.deletePipelineButtonLabel",defaultMessage:"Delete pipeline"})))),this.state.showConfirmDeleteModal&&Object(c.jsx)(ae,{id:this.props.pipeline.id,cancelDeleteModal:this.hideConfirmDeleteModal,confirmDeletePipeline:this.deletePipeline}))}}const re=Object(Q.injectI18n)(pipeline_editor_PipelineEditorUi);var ce=i(7);function pe(){return[{text:$.i18n.translate("xpack.logstash.pipelines.listBreadcrumb",{defaultMessage:"Pipelines"}),href:"#/management/ingest/pipelines"}]}const ue=({pipelineService:e,logstashLicenseService:t,toasts:i,history:n,setBreadcrumbs:a,id:l})=>{const o=""===new URLSearchParams(n.location.search).get("clone"),r=((e,t,i,n,a)=>{const l=te()(),[o,r]=Object(s.useState)(null);return Object(s.useLayoutEffect)((()=>{(async()=>{if(!a)return r(new ce.a);try{const t=await l(e.loadPipeline(a));r(n?t.clone:t)}catch(e){await t.checkValidity(),403!==e.status&&i.addDanger($.i18n.translate("xpack.logstash.couldNotLoadPipelineErrorNotification",{defaultMessage:"Couldn't load pipeline. Error: ''{errStatusText}''.",values:{errStatusText:e.statusText}}))}})()}),[e,a,l,n,t,i]),o})(e,t,i,o,l),p=Object(s.useCallback)((()=>{n.push("/")}),[n]),u=Object(s.useCallback)((e=>{n.push(`/pipeline/${e}/edit`)}),[n]);if(!r)return null;const d=!r.id;var g;return a(d?[...pe(),{text:$.i18n.translate("xpack.logstash.pipelines.createBreadcrumb",{defaultMessage:"Create"})}]:(g=r.id,[...pe(),{text:g}])),Object(c.jsx)(re,{id:l,clone:o,close:p,open:u,isNewPipeline:d,pipeline:r,pipelineService:e,toastNotifications:i,licenseService:t})},de=async(e,{history:t,element:i,setBreadcrumbs:s},n,a)=>{const r=await a.pipe(Object(O.first)()).toPromise(),u=new q.a(e.http),d=new q.c(e.http,n,u),g=new q.e(e.http,d),h=new q.d(e.http,g);return l.a.render(Object(c.jsx)(U,e,Object(c.jsx)(p,{history:t},Object(c.jsx)(M,null,Object(c.jsx)(m,{path:["/",""],exact:!0,render:()=>(s(pe()),Object(c.jsx)(J,{clusterService:u,isReadOnly:r.isReadOnly,isForbidden:!0,isLoading:!1,licenseService:r,monitoringService:d,openPipeline:e=>t.push(`/pipeline/${e}/edit`),clonePipeline:e=>t.push(`/pipeline/${e}/edit?clone`),createPipeline:()=>t.push("pipeline/new-pipeline"),pipelinesService:g,toastNotifications:e.notifications.toasts}))}),Object(c.jsx)(m,{path:"/pipeline/new-pipeline",exact:!0,render:()=>Object(c.jsx)(ue,{history:t,setBreadcrumbs:s,logstashLicenseService:r,pipelineService:h,toasts:e.notifications.toasts})}),Object(c.jsx)(m,{path:"/pipeline/:id",exact:!0,render:({match:e})=>Object(c.jsx)(o.Redirect,{to:`/pipeline/${e.params.id}/edit`})}),Object(c.jsx)(m,{path:"/pipeline/:id/edit",exact:!0,render:({match:i})=>Object(c.jsx)(ue,{history:t,setBreadcrumbs:s,logstashLicenseService:r,pipelineService:h,toasts:e.notifications.toasts,id:i.params.id})})))),i),()=>{l.a.unmountComponentAtNode(i)}}}}]);