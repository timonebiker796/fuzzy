/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.spaces_bundle_jsonpfunction=window.spaces_bundle_jsonpfunction||[]).push([[3],{143:function(e,a,s){switch(window.__kbnThemeTag__){case"v8dark":return s(144);case"v8light":return s(146)}},144:function(e,a,s){var t=s(49),n=s(145);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);t(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},145:function(e,a,s){(a=s(50)(!1)).push([e.i,".spcShareToSpace__flyoutBodyWrapper{padding:24px}",""]),e.exports=a},146:function(e,a,s){var t=s(49),n=s(147);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);t(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},147:function(e,a,s){(a=s(50)(!1)).push([e.i,".spcShareToSpace__flyoutBodyWrapper{padding:24px}",""]),e.exports=a},148:function(e,a,s){switch(window.__kbnThemeTag__){case"v8dark":return s(149);case"v8light":return s(151)}},149:function(e,a,s){var t=s(49),n=s(150);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);t(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},150:function(e,a,s){(a=s(50)(!1)).push([e.i,".spcShareToSpaceIncludeRelated .euiIcon{margin-right:28px}.spcShareToSpaceIncludeRelated__label{font-size:14px}",""]),e.exports=a},151:function(e,a,s){var t=s(49),n=s(152);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);t(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},152:function(e,a,s){(a=s(50)(!1)).push([e.i,".spcShareToSpaceIncludeRelated .euiIcon{margin-right:28px}.spcShareToSpaceIncludeRelated__label{font-size:14px}",""]),e.exports=a},153:function(e,a,s){switch(window.__kbnThemeTag__){case"v8dark":return s(154);case"v8light":return s(156)}},154:function(e,a,s){var t=s(49),n=s(155);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);t(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},155:function(e,a,s){(a=s(50)(!1)).push([e.i,".spcShareToSpace__spacesList{margin-top:4px}",""]),e.exports=a},156:function(e,a,s){var t=s(49),n=s(157);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);t(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},157:function(e,a,s){(a=s(50)(!1)).push([e.i,".spcShareToSpace__spacesList{margin-top:4px}",""]),e.exports=a},170:function(e,a,s){"use strict";s.r(a),s.d(a,"ShareToSpaceFlyoutInternal",(function(){return U})),s(143);var t=s(6),n=s(1),c=s.n(n),i=s(2),o=s(42),r=s(9),l=s(0);const p=Object(n.lazy)((()=>Object(r.a)().then((e=>({default:e}))))),u=({spaces:e,aliasesToDisable:a})=>{const[s,i]=Object(n.useState)(0),[r,u]=Object(n.useState)(5),d=Object(n.useMemo)((()=>e.reduce(((e,a)=>e.set(a.id,a)),new Map)),[e]),b=Object(n.useMemo)((()=>a.filter((({spaceExists:e})=>e))),[a]),j=b.length,h={pageIndex:s,pageSize:r,totalItemCount:j,pageSizeOptions:[5,10,15,20]};return Object(l.jsx)(c.a.Fragment,null,Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiCallOut,{size:"s",title:Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.aliasTableCalloutTitle",defaultMessage:"Legacy URL conflict"}),color:"warning"},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.aliasTableCalloutBody",defaultMessage:"{aliasesToDisableCount, plural, one {# legacy URL} other {# legacy URLs}} will be disabled.",values:{aliasesToDisableCount:j}})),Object(l.jsx)(t.EuiSpacer,{size:"m"})),Object(l.jsx)(t.EuiFlexItem,null,Object(l.jsx)(n.Suspense,{fallback:Object(l.jsx)(t.EuiLoadingSpinner,null)},Object(l.jsx)(t.EuiInMemoryTable,{items:b,columns:[{name:"Type",field:"targetType",sortable:!0},{name:"ID",field:"sourceId",sortable:!0,truncateText:!0},{name:"Space",render:({targetSpace:e})=>{const a=d.get(e);return Object(l.jsx)(p,{space:a,size:"s"})},sortable:({targetSpace:e})=>e}],sorting:!0,pagination:h,onTableChange:({page:{index:e,size:a}})=>{i(e),u(a)},tableLayout:"auto"}))))},d=e=>{const{savedObjectTarget:a,referenceGraph:s,isDisabled:i}=e,r=Object(n.useMemo)((()=>{const{type:e,id:t}=a;return s.filter((a=>(a.type!==e||a.id!==t)&&a.spaces.length>0&&!a.isMissing)).length}),[a,s]);return r>0?Object(l.jsx)(c.a.Fragment,null,Object(l.jsx)(t.EuiText,{size:"s",color:i?"subdued":void 0},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.relativesControl.description",defaultMessage:"{relativesCount} related {relativesCount, plural, one {object} other {objects}} will also change.",values:{relativesCount:r}})),Object(l.jsx)(t.EuiHorizontalRule,{margin:"s"})):null};s(148),s(153);const b=e=>{const{capabilities:a,getUrlForApp:s}=e.application;return a.spaces.manage?Object(l.jsx)(c.a.Fragment,null,Object(l.jsx)(t.EuiSpacer,{size:"xs"}),Object(l.jsx)(t.EuiText,{size:"s",color:"subdued"},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.noAvailableSpaces.canCreateNewSpace.text",defaultMessage:"You can {createANewSpaceLink} for sharing your objects.",values:{createANewSpaceLink:Object(l.jsx)(t.EuiLink,{"data-test-subj":"sts-new-space-link",href:s("management",{path:"kibana/spaces/create"})},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.noAvailableSpaces.canCreateNewSpace.linkText",defaultMessage:"create a new space"}))}}))):null};var j=s(20),h=s(7),g=s(15);const f=Object(n.lazy)((()=>Object(r.a)().then((e=>({default:e}))))),x=Object(l.jsx)(t.EuiBadge,{color:"hollow"},i.i18n.translate("xpack.spaces.shareToSpace.currentSpaceBadge",{defaultMessage:"This space"})),S=Object(l.jsx)(t.EuiIconTip,{content:i.i18n.translate("xpack.spaces.shareToSpace.partiallyAuthorizedSpaceTooltip.unchecked",{defaultMessage:"You need additional privileges to select this space."}),position:"left",type:"iInCircle"}),T=Object(l.jsx)(t.EuiIconTip,{content:i.i18n.translate("xpack.spaces.shareToSpace.partiallyAuthorizedSpaceTooltip.checked",{defaultMessage:"You need additional privileges to deselect this space."}),position:"left",type:"iInCircle"}),v=Object(l.jsx)(t.EuiIconTip,{title:i.i18n.translate("xpack.spaces.shareToSpace.prohibitedSpaceTooltipTitle",{defaultMessage:"Cannot share to this space"}),content:i.i18n.translate("xpack.spaces.shareToSpace.prohibitedSpaceTooltip",{defaultMessage:"A copy of this saved object or a related object exists in this space."}),position:"left",type:"iInCircle"}),m=Object(l.jsx)(t.EuiIconTip,{content:i.i18n.translate("xpack.spaces.shareToSpace.featureIsDisabledTooltip",{defaultMessage:"This feature is disabled in this space."}),position:"left",type:"warning",color:"warning"}),O=e=>{const{spaces:a,shareOptions:s,onChange:r,enableCreateNewSpaceLink:p,enableSpaceAgnosticBehavior:u,prohibitedSpaces:d}=e,{services:O}=Object(g.b)(),{application:y,docLinks:k}=O,{selectedSpaceIds:C,initiallySelectedSpaceIds:E}=s,M=!u&&a.find((e=>e.isActiveSpace)).id,w=C.includes(h.a),F=a.filter((({id:e,isFeatureDisabled:a})=>!a||E.includes(e)||w)),I=F.sort(function(e){return(a,s)=>a.id===e?-1:s.id===e?1:a.isFeatureDisabled!==s.isFeatureDisabled?a.isFeatureDisabled?1:-1:0}(M)).map((e=>{const a=C.includes(e.id),{isAvatarDisabled:s,...t}=function(e,a,s,t,n){return e.id===a?{append:x,disabled:!0,checked:"on"}:t||e.isAuthorizedForPurpose("shareSavedObjectsIntoSpace")?n.has(e.id)||n.has(h.a)?{append:Object(l.jsx)(c.a.Fragment,null,v,e.isFeatureDisabled?m:null),...e.isFeatureDisabled&&{isAvatarDisabled:!0},disabled:!0}:e.isFeatureDisabled?{append:m,isAvatarDisabled:!0}:{}:{append:Object(l.jsx)(c.a.Fragment,null,s?T:S,e.isFeatureDisabled?m:null),...e.isFeatureDisabled&&{isAvatarDisabled:!0},disabled:!0}}(e,M,a,w,d);return{label:e.name,prepend:Object(l.jsx)(f,{space:e,isDisabled:s,size:"s"}),checked:a||w?"on":void 0,"data-space-id":e.id,"data-test-subj":`sts-space-selector-row-${e.id}`,...w&&{disabled:!0},...t}})),A=u?0:1,L=w?F.length:C.filter((e=>e!==h.a&&e!==h.f)).length+A,_=i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.selectSpacesLabel",{defaultMessage:"Select spaces"}),z=i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.selectedCountLabel",{defaultMessage:"{selectedCount}/{totalCount} selected",values:{selectedCount:L,totalCount:F.length}});return Object(l.jsx)(c.a.Fragment,null,Object(l.jsx)(t.EuiFormRow,{label:_,labelAppend:Object(l.jsx)(t.EuiText,{size:"xs"},z),fullWidth:!0},Object(l.jsx)(c.a.Fragment,null)),Object(l.jsx)(t.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1,style:{minHeight:200}},Object(l.jsx)(t.EuiFlexItem,null,Object(l.jsx)(n.Suspense,{fallback:Object(l.jsx)(t.EuiLoadingSpinner,null)},Object(l.jsx)(t.EuiSelectable,{options:I,onChange:e=>function(e){const a=[...e.filter((e=>e.checked&&e["data-space-id"]!==M)).map((e=>e["data-space-id"])),...C.filter((e=>e===h.f))];r(a)}(e),listProps:{bordered:!0,rowHeight:40,className:"spcShareToSpace__spacesList","data-test-subj":"sts-form-space-selector"},height:"full",searchable:I.length>j.SPACE_SEARCH_COUNT_THRESHOLD},((e,a)=>Object(l.jsx)(c.a.Fragment,null,a,e))))),(()=>{if(!C.filter((e=>e===h.f)).length)return null;const e=C.filter((e=>e===h.f)).length,a=null==k?void 0:k.links.security.kibanaPrivileges;return Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiText,{size:"s",color:"subdued"},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.unknownSpacesLabel.text",defaultMessage:"To view {hiddenCount} hidden spaces, you need {additionalPrivilegesLink}.",values:{hiddenCount:e,additionalPrivilegesLink:Object(l.jsx)(t.EuiLink,{href:a,target:"_blank"},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.unknownSpacesLabel.additionalPrivilegesLink",defaultMessage:"additional privileges"}))}})))})(),p&&a.length<2?Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(b,{application:y})):null))},y=i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.buttonGroupLegend",{defaultMessage:"Choose how this is shared"}),k="shareToAllSpacesId",C=i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.shareToAllSpaces.buttonLabel",{defaultMessage:"All spaces"}),E="shareToExplicitSpacesId",M=i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.shareToExplicitSpaces.buttonLabel",{defaultMessage:"Select spaces"}),w=Object(l.jsx)(t.EuiIconTip,{content:i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.shareToAllSpaces.cannotChangeTooltip",{defaultMessage:"You need additional privileges to change this option."}),position:"left",type:"iInCircle"}),F=Object(l.jsx)(t.EuiIconTip,{title:i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.shareToAllSpaces.allSpacesProhibitedTooltipTitle",{defaultMessage:"Cannot share to all spaces"}),content:i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.shareToAllSpaces.allSpacesProhibitedTooltipContent",{defaultMessage:"A copy of this saved object or a related object exists in at least one other space."}),position:"left",type:"iInCircle"}),I=e=>{const{spaces:a,objectNoun:s,canShareToAllSpaces:n,shareOptions:r,onChange:p,enableCreateNewSpaceLink:u,enableSpaceAgnosticBehavior:d,prohibitedSpaces:b}=e,{services:j}=Object(g.b)(),{docLinks:f}=j;if(0===a.length)return Object(l.jsx)(t.EuiLoadingSpinner,null);const{selectedSpaceIds:x}=r,S=x.includes(h.a),T=b.size>0&&!S;let v=null;return n?T&&(v=F):v=w,Object(l.jsx)(c.a.Fragment,null,(()=>{if(n||!S)return null;const e=null==f?void 0:f.links.security.kibanaPrivileges;return Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiCallOut,{size:"s",iconType:"help",title:Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.privilegeWarningTitle",defaultMessage:"Additional privileges required"}),color:"warning"},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.privilegeWarningBody",defaultMessage:"To edit the spaces for this {objectNoun}, you need {readAndWritePrivilegesLink} in all spaces.",values:{objectNoun:s,readAndWritePrivilegesLink:Object(l.jsx)(t.EuiLink,{href:e,target:"_blank"},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.privilegeWarningLink",defaultMessage:"read and write privileges"}))}})),Object(l.jsx)(t.EuiSpacer,{size:"m"}))})(),Object(l.jsx)(t.EuiButtonGroup,{type:"single",idSelected:S?k:E,options:[{id:E,label:M},{id:k,label:C}],onChange:e=>{const a=e===k?[h.a,...x]:x.filter((e=>e!==h.a));p(a)},legend:y,color:"success",isFullWidth:!0,isDisabled:!n||T}),Object(l.jsx)(t.EuiSpacer,{size:"s"}),Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiFlexGroup,{responsive:!1},Object(l.jsx)(t.EuiFlexItem,null,Object(l.jsx)(t.EuiText,{color:"subdued",textAlign:"center",size:"s","data-test-subj":"share-mode-control-description"},S?i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.shareToAllSpaces.text",{defaultMessage:"Make {objectNoun} available in all current and future spaces.",values:{objectNoun:s}}):i.i18n.translate("xpack.spaces.shareToSpace.shareModeControl.shareToExplicitSpaces.text",{defaultMessage:"Make {objectNoun} available in selected spaces only.",values:{objectNoun:s}}))),v&&Object(l.jsx)(t.EuiFlexItem,{grow:!1},v))),Object(l.jsx)(t.EuiSpacer,{size:"m"}),Object(l.jsx)(t.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},Object(l.jsx)(O,{spaces:a,shareOptions:r,onChange:p,enableCreateNewSpaceLink:u,enableSpaceAgnosticBehavior:d,prohibitedSpaces:b})))},A=e=>{const{spaces:a,objectNoun:s,onUpdate:n,shareOptions:i,showCreateCopyCallout:r,canShareToAllSpaces:p,makeCopy:u,enableCreateNewSpaceLink:d,enableSpaceAgnosticBehavior:b,prohibitedSpaces:j}=e,h=r?Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiCallOut,{size:"s",title:Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.shareWarningTitle",defaultMessage:"Changes are synchronized across spaces"}),color:"warning"},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.shareWarningBody",defaultMessage:"Your changes appear in each space you select. {makeACopyLink} if you don't want to synchronize your changes.",values:{makeACopyLink:Object(l.jsx)(t.EuiLink,{"data-test-subj":"sts-copy-button",onClick:()=>u()},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.shareWarningLink",defaultMessage:"Make a copy"}))}})),Object(l.jsx)(t.EuiSpacer,{size:"m"})):null;return Object(l.jsx)(c.a.Fragment,null,h,Object(l.jsx)(I,{spaces:a,objectNoun:s,canShareToAllSpaces:p,shareOptions:i,onChange:e=>{return a=e,n({...i,selectedSpaceIds:a});var a},enableCreateNewSpaceLink:d,enableSpaceAgnosticBehavior:b,prohibitedSpaces:j}))};var L=s(14),_=s(29);const z=Object(n.lazy)((()=>Object(_.a)().then((e=>({default:e}))))),N=i.i18n.translate("xpack.spaces.shareToSpace.allSpacesTarget",{defaultMessage:"all spaces"});function D(e){return e.includes(h.a)?N:i.i18n.translate("xpack.spaces.shareToSpace.spacesTarget",{defaultMessage:"{spacesCount, plural, one {# space} other {# spaces}}",values:{spacesCount:e.length}})}const B=(e,a)=>e.every((e=>a.includes(e)))&&a.every((a=>e.includes(a)));function R(e,a,s){return async(t,n,c)=>{const{title:o}=e,r=t.map((({type:e,id:a})=>({type:e,id:a}))),l=t.length-1,p=i.i18n.translate("xpack.spaces.shareToSpace.shareSuccessTitle",{values:{objectNoun:e.noun},defaultMessage:"Updated {objectNoun}",description:'Object noun can be plural or singular, examples: "Updated objects", "Updated job"'});if(c.length>0&&r.length>1){const s=r.findIndex((a=>a.id===e.id));s>=0&&r.splice(s,1);const t=a.updateSavedObjectsSpaces([{type:e.type,id:e.id}],n,c),i=n.length>0?a.updateSavedObjectsSpaces(r,n,[]):void 0;await Promise.all([t,i])}else await a.updateSavedObjectsSpaces(r,n,c);const u=n.includes(h.a);let d;d=n.length>0&&c.length>0&&!u?i.i18n.translate("xpack.spaces.shareToSpace.shareSuccessAddRemoveText",{defaultMessage:"''{object}'' {relativesCount, plural, =0 {was} =1 {and {relativesCount} related object were} other {and {relativesCount} related objects were}} added to {spacesTargetAdd}. ''{object}'' was removed from {spacesTargetRemove}.",values:{object:o,relativesCount:l,spacesTargetAdd:D(n),spacesTargetRemove:D(c)},description:"Uses output of xpack.spaces.shareToSpace.spacesTarget or xpack.spaces.shareToSpace.allSpacesTarget as 'spacesTarget...' inputs. Example strings: \"'Finance dashboard' was added to 1 space. 'Finance dashboard' was removed from 2 spaces.\", \"'Finance dashboard' and 2 related objects were added to 3 spaces. 'Finance dashboard' was removed from all spaces.\""}):n.length>0?i.i18n.translate("xpack.spaces.shareToSpace.shareSuccessAddText",{defaultMessage:"''{object}'' {relativesCount, plural, =0 {was} =1 {and {relativesCount} related object were} other {and {relativesCount} related objects were}} added to {spacesTarget}.",values:{object:o,relativesCount:l,spacesTarget:D(n)},description:"Uses output of xpack.spaces.shareToSpace.spacesTarget or xpack.spaces.shareToSpace.allSpacesTarget as 'spacesTarget' input. Example strings: \"'Finance dashboard' was added to 1 space.\", \"'Finance dashboard' and 2 related objects were added to all spaces.\""}):i.i18n.translate("xpack.spaces.shareToSpace.shareSuccessRemoveText",{defaultMessage:"''{object}'' was removed from {spacesTarget}.",values:{object:o,spacesTarget:D(c)},description:"Uses output of xpack.spaces.shareToSpace.spacesTarget or xpack.spaces.shareToSpace.allSpacesTarget as 'spacesTarget' input. Example string: \"'Finance dashboard' was removed from 1 space.\", \"'Finance dashboard' was removed from all spaces.\""}),s.addSuccess({title:p,text:d})}}const U=e=>{const{spacesManager:a,spacesDataPromise:s,services:r}=Object(g.b)(),{notifications:p}=r,b=p.toasts,{savedObjectTarget:j}=e,f=Object(n.useMemo)((()=>({type:j.type,id:j.id,namespaces:j.namespaces,icon:j.icon,title:j.title||`${j.type} [id=${j.id}]`,noun:j.noun||L.a})),[j]),{flyoutIcon:x,flyoutTitle:S=i.i18n.translate("xpack.spaces.shareToSpace.flyoutTitle",{defaultMessage:"Share {objectNoun} to spaces",values:{objectNoun:f.noun}}),enableCreateCopyCallout:T=!1,enableCreateNewSpaceLink:v=!1,behaviorContext:m,changeSpacesHandler:O=R(f,a,b),onUpdate:y=(()=>null),onClose:k=(()=>null)}=e,C="outside-space"===m,[E,M]=Object(n.useState)({selectedSpaceIds:[],initiallySelectedSpaceIds:[]}),[w,F]=Object(n.useState)(!1),[I,_]=Object(n.useState)(!1),[{isLoading:N,spaces:D,referenceGraph:U,aliasTargets:P,prohibitedSpaces:W},G]=Object(n.useState)({isLoading:!0,spaces:[],referenceGraph:[],aliasTargets:[],prohibitedSpaces:new Set});Object(n.useEffect)((()=>{const{type:e,id:t}=f,n=a.getShareableReferences([{type:e,id:t}]),c=a.getShareSavedObjectPermissions(e);Promise.all([s,n,c]).then((([e,a,s])=>{const t=!C&&e.activeSpaceId,n=f.namespaces.filter((e=>e!==t));M({selectedSpaceIds:n,initiallySelectedSpaceIds:n}),F(s.shareToAllSpaces),G({isLoading:!1,spaces:[...e.spacesMap].map((([,e])=>e)),referenceGraph:a.objects,aliasTargets:a.objects.reduce(((a,s)=>{for(const n of null!==(t=s.spacesWithMatchingAliases)&&void 0!==t?t:[]){var t;if(n!==h.f){const t=e.spacesMap.has(n);a.push({targetSpace:n,targetType:s.type,sourceId:s.id,spaceExists:t})}}return a}),[]),prohibitedSpaces:a.objects.reduce(((e,a)=>{for(const c of null!==(s=a.spacesWithMatchingOrigins)&&void 0!==s?s:[]){var s;c===h.f||n.includes(c)||c===t||e.add(c)}return e}),new Set)})})).catch((e=>{b.addError(e,{title:i.i18n.translate("xpack.spaces.shareToSpace.spacesLoadErrorTitle",{defaultMessage:"Error loading available spaces"})})}))}),[f,a,s,b,C]);const{isSelectionChanged:H,spacesToAdd:Y,spacesToRemove:$,aliasesToDisable:q}=(()=>{if(!D.length)return{isSelectionChanged:!1,spacesToAdd:[],spacesToRemove:[],aliasesToDisable:[]};const e=!C&&D.find((e=>e.isActiveSpace)).id,a=f.namespaces.filter((a=>a!==e&&a!==h.f)),{selectedSpaceIds:s}=E,t=s.filter((e=>e!==h.f)),n=a.includes(h.a),c=t.includes(h.a),i=!n&&c,o=n&&!c,r=!c&&!B(a,t),l=i||o||!i&&!o&&r,p=t.filter((e=>!a.includes(e))),u=a.filter((e=>!t.includes(e))),d=e?[e]:[],b=i?[h.a]:o?[...d,...p]:p,j=new Set(b);return{isSelectionChanged:l,spacesToAdd:b,spacesToRemove:o||!i?u:[...d,...a],aliasesToDisable:i?P:P.filter((({targetSpace:e})=>j.has(e)))}})(),[J,K]=Object(n.useState)(!1),[Q,V]=Object(n.useState)(!1);if(I)return Object(l.jsx)(n.Suspense,{fallback:Object(l.jsx)(t.EuiLoadingSpinner,null)},Object(l.jsx)(z,{onClose:k,savedObjectTarget:f}));const X=!H||Q||C&&!E.selectedSpaceIds.length;return Object(l.jsx)(t.EuiFlyout,{onClose:k,maxWidth:500,"data-test-subj":"share-to-space-flyout"},Object(l.jsx)(t.EuiFlyoutHeader,{hasBorder:!0},Object(l.jsx)(t.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},x&&Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiIcon,{size:"l",type:x})),Object(l.jsx)(t.EuiFlexItem,null,Object(l.jsx)(t.EuiTitle,{size:"m"},Object(l.jsx)("h2",null,S))))),Object(l.jsx)(t.EuiFlexGroup,{direction:"column",gutterSize:"none",className:"spcShareToSpace__flyoutBodyWrapper eui-yScroll",responsive:!1},Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},f.icon&&Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiIcon,{type:f.icon})),Object(l.jsx)(t.EuiFlexItem,null,Object(l.jsx)(t.EuiText,null,Object(l.jsx)("p",null,f.title))))),Object(l.jsx)(t.EuiSpacer,{size:"m"}),(()=>{if(N)return Object(l.jsx)(t.EuiLoadingSpinner,null);if(!J){const e=T&&D.length>1&&1===f.namespaces.length&&!B(f.namespaces,[h.a]);return Object(l.jsx)(A,{spaces:D,objectNoun:f.noun,shareOptions:E,onUpdate:M,showCreateCopyCallout:e,canShareToAllSpaces:w,makeCopy:()=>_(!0),enableCreateNewSpaceLink:v,enableSpaceAgnosticBehavior:C,prohibitedSpaces:W})}return Object(l.jsx)(u,{spaces:D,aliasesToDisable:q})})()),Object(l.jsx)(t.EuiFlyoutFooter,null,(()=>{const e=q.filter((({spaceExists:e})=>e)).length&&!J;return Object(l.jsx)(c.a.Fragment,null,Object(l.jsx)(d,{savedObjectTarget:f,referenceGraph:U,isDisabled:X}),Object(l.jsx)(t.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},Object(l.jsx)(t.EuiFlexItem,{grow:!1},Object(l.jsx)(t.EuiButtonEmpty,{onClick:()=>k(),"data-test-subj":"sts-cancel-button",disabled:Q},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.cancelButton",defaultMessage:"Cancel"}))),Object(l.jsx)(t.EuiFlexItem,{grow:!1},e?Object(l.jsx)(t.EuiButton,{fill:!0,onClick:()=>K(!0),"data-test-subj":"sts-continue-button",disabled:X},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.continueButton",defaultMessage:"Continue"})):Object(l.jsx)(t.EuiButton,{fill:!0,onClick:()=>async function(){V(!0);try{if(q.length){const e=q.map((({spaceExists:e,...a})=>a));await a.disableLegacyUrlAliases(e)}await O(U,Y,$);const e=U.map((({type:e,id:a})=>({type:e,id:a})));y(e),k()}catch(e){V(!1),b.addError(e,{title:i.i18n.translate("xpack.spaces.shareToSpace.shareErrorTitle",{values:{objectNoun:f.noun},defaultMessage:"Error updating {objectNoun}",description:'Object noun can be plural or singular, examples: "Failed to update objects", "Failed to update job"'}),toastMessage:i.i18n.translate("xpack.spaces.shareToSpace.shareErrorText",{defaultMessage:"Unable to update ''{object}'' {relativesCount, plural, =0 {} =1 {or {relativesCount} related object} other {or one or more of {relativesCount} related objects}}.",values:{object:f.title,relativesCount:Y.length>0?U.length-1:0},description:"Uses output of xpack.spaces.shareToSpace.spacesTarget or xpack.spaces.shareToSpace.allSpacesTarget as 'spacesTarget...' inputs. Example strings: \"'Finance dashboard' was added to 1 space. 'Finance dashboard' was removed from 2 spaces.\", \"'Finance dashboard' and 2 related objects were added to 3 spaces. 'Finance dashboard' was removed from all spaces.\""})})}}(),"data-test-subj":"sts-save-button",disabled:X},Object(l.jsx)(o.FormattedMessage,{id:"xpack.spaces.shareToSpace.saveButton",defaultMessage:"Save & close"})))))})()))}},49:function(e,a,s){"use strict";var t,n=function(){var e={};return function(a){if(void 0===e[a]){var s=document.querySelector(a);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[a]=s}return e[a]}}(),c=[];function i(e){for(var a=-1,s=0;s<c.length;s++)if(c[s].identifier===e){a=s;break}return a}function o(e,a){for(var s={},t=[],n=0;n<e.length;n++){var o=e[n],r=a.base?o[0]+a.base:o[0],l=s[r]||0,p="".concat(r," ").concat(l);s[r]=l+1;var u=i(p),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==u?(c[u].references++,c[u].updater(d)):c.push({identifier:p,updater:h(d,a),references:1}),t.push(p)}return t}function r(e){var a=document.createElement("style"),t=e.attributes||{};if(void 0===t.nonce){var c=s.nc;c&&(t.nonce=c)}if(Object.keys(t).forEach((function(e){a.setAttribute(e,t[e])})),"function"==typeof e.insert)e.insert(a);else{var i=n(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(a)}return a}var l,p=(l=[],function(e,a){return l[e]=a,l.filter(Boolean).join("\n")});function u(e,a,s,t){var n=s?"":t.media?"@media ".concat(t.media," {").concat(t.css,"}"):t.css;if(e.styleSheet)e.styleSheet.cssText=p(a,n);else{var c=document.createTextNode(n),i=e.childNodes;i[a]&&e.removeChild(i[a]),i.length?e.insertBefore(c,i[a]):e.appendChild(c)}}function d(e,a,s){var t=s.css,n=s.media,c=s.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),c&&"undefined"!=typeof btoa&&(t+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(c))))," */")),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}var b=null,j=0;function h(e,a){var s,t,n;if(a.singleton){var c=j++;s=b||(b=r(a)),t=u.bind(null,s,c,!1),n=u.bind(null,s,c,!0)}else s=r(a),t=d.bind(null,s,a),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}e.exports=function(e,a){(a=a||{}).singleton||"boolean"==typeof a.singleton||(a.singleton=(void 0===t&&(t=Boolean(window&&document&&document.all&&!window.atob)),t));var s=o(e=e||[],a);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var t=0;t<s.length;t++){var n=i(s[t]);c[n].references--}for(var r=o(e,a),l=0;l<s.length;l++){var p=i(s[l]);0===c[p].references&&(c[p].updater(),c.splice(p,1))}s=r}}}},50:function(e,a,s){"use strict";e.exports=function(e){var a=[];return a.toString=function(){return this.map((function(a){var s=function(e,a){var s,t,n,c=e[1]||"",i=e[3];if(!i)return c;if(a&&"function"==typeof btoa){var o=(s=i,t=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(t),"/*# ".concat(n," */")),r=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[c].concat(r).concat([o]).join("\n")}return[c].join("\n")}(a,e);return a[2]?"@media ".concat(a[2]," {").concat(s,"}"):s})).join("")},a.i=function(e,s,t){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(t)for(var c=0;c<this.length;c++){var i=this[c][0];null!=i&&(n[i]=!0)}for(var o=0;o<e.length;o++){var r=[].concat(e[o]);t&&n[r[0]]||(s&&(r[2]?r[2]="".concat(s," and ").concat(r[2]):r[2]=s),a.push(r))}},a}}}]);