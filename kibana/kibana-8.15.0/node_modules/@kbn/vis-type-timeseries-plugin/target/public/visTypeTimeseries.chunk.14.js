(window.visTypeTimeseries_bundle_jsonpfunction=window.visTypeTimeseries_bundle_jsonpfunction||[]).push([[14],{180:function(e,t,i){e.exports=i(20)(8)},219:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return vis_TimeseriesVisualization}));var s=i(17),o=i.n(s),a=i(3),n=i(10),r=i(6),l=i(36),c=i(70),d=i(66),u=i(71),m=i(5),p=i(77),g=i(37),h=i.n(g),b=i(2),y=i(48),f=i(50),T=i(0),x=i(56);const v="#000";var k=i(180),A=i.n(k);A.a.string.isRequired,A.a.string.isRequired,A.a.string.isRequired,A.a.arrayOf(A.a.arrayOf(A.a.number)).isRequired,A.a.bool.isRequired,A.a.string.isRequired,A.a.oneOf(["percentage","wiggle","silhouette"]),A.a.arrayOf(A.a.number),A.a.string,A.a.string,A.a.string.isRequired,A.a.bool.isRequired,A.a.number;A.a.shape({fill:A.a.number,lineWidth:A.a.number,show:A.a.boolean}).isRequired,A.a.shape({fill:A.a.number,lineWidth:A.a.number,show:A.a.bool,steps:A.a.oneOfType([A.a.number,A.a.bool])}).isRequired,A.a.shape({lineWidth:A.a.number,radius:A.a.number,show:A.a.bool}).isRequired;var j=i(1);function _({seriesId:e,seriesGroupId:t,name:i,data:s,hideInLegend:o,lines:a,color:n,stackAccessors:r,stackMode:c,points:d,xScaleType:u,yScaleType:m,timeZone:p,enableHistogramMode:g,sortIndex:h,y1AccessorFormat:b,y0AccessorFormat:y,tickFormat:f}){const T=e,k=t,A=(({points:e,lines:t,color:i})=>({areaSeriesStyle:{line:{stroke:i,strokeWidth:Number(t.lineWidth)||0,visible:Boolean(t.show&&t.lineWidth)},area:{fill:i,opacity:t.fill<=0?0:t.fill,visible:Boolean(t.show)},point:{radius:e.radius||.5,stroke:i||v,strokeWidth:e.lineWidth||5,visible:e.lineWidth>0&&Boolean(e.show)}},curve:t.steps?l.CurveType.CURVE_STEP_AFTER:l.CurveType.LINEAR}))({points:d,lines:a,color:n}),_={id:T,name:i,groupId:k,data:s,color:n,hideInLegend:o,xAccessor:x.e,yAccessors:x.g,y0Accessors:"band"===a.mode?x.f:void 0,y1AccessorFormat:b,y0AccessorFormat:y,stackAccessors:r,stackMode:c,xScaleType:u,yScaleType:m,timeZone:p,enableHistogramMode:g,sortIndex:h,tickFormat:f,...A};return g&&(_.histogramModeAlignment="center"),Object(j.jsx)(l.AreaSeries,_)}function S({seriesId:e,seriesGroupId:t,name:i,data:s,hideInLegend:o,bars:a,color:n,stackAccessors:r,stackMode:c,xScaleType:d,yScaleType:u,timeZone:m,enableHistogramMode:p,sortIndex:g,y1AccessorFormat:h,y0AccessorFormat:b,tickFormat:y}){const f=e,T=t,k=(({show:e=!0,lineWidth:t=0,fill:i=1},s)=>({barSeriesStyle:{rectBorder:{stroke:s||v,strokeWidth:t,visible:e},rect:{fill:s||v,opacity:i}}}))(a,n),A={id:f,name:i,groupId:T,data:s,color:n,hideInLegend:o,xAccessor:x.e,yAccessors:x.g,y0Accessors:"band"===a.mode?x.f:void 0,y1AccessorFormat:h,y0AccessorFormat:b,stackAccessors:r,stackMode:c,xScaleType:d,yScaleType:u,timeZone:m,enableHistogramMode:p,sortIndex:g,tickFormat:y,...k};return p&&(A.histogramModeAlignment="center"),Object(j.jsx)(l.BarSeries,A)}_.defaultProps={yScaleType:l.ScaleType.Linear,xScaleType:l.ScaleType.Time},S.defaultProps={yScaleType:l.ScaleType.Linear,xScaleType:l.ScaleType.Time};var O=i(54),E=i.n(O);function w(e){return E()(e).luminosity()}function F(e,t){return E()(e).contrast(E()(t))}function L(e,t,i=7){const s=function(e,t,i=7){const s=w(e);return s>w(t)?(s+.05-.05*i)/i:Math.min(i*(s+.05)-.05,1)}(e,t,i),o=function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}(s);return function(e){const t=Math.round(255*e);return`rgb(${t},${t},${t})`}(o)}var I=i(59),C=i(81),N=i(76);function R(e){if(!e)return"";const t=Object(N.a)(e);return t?b.i18n.translate("visTypeTimeseries.axisLabelOptions.axisLabel",{defaultMessage:"per {unitValue} {unitString}",values:{unitValue:t.unitValue,unitString:t.unitString}}):void 0}const D=({backgroundColor:e,showGrid:t,legend:i,legendPosition:s,truncateLegend:o,maxLegendLines:n,tooltipMode:c,series:d,yAxis:u,onBrush:p,onFilterClick:g,xAxisFormatter:v,annotations:k,syncColors:A,syncTooltips:O,syncCursor:N,palettesService:D,interval:B,isLastBucketDropped:M,useLegacyTimeAxis:V,ignoreDaylightTime:P,initialRender:H})=>{var G,W;const{theme:z,activeCursor:$}=Object(T.a)(),Y=Object(a.useRef)(),q=function(e,t){if(!function(e){if("string"!=typeof e)return!1;if(0===e.length)return!1;try{return E()(e),!0}catch{return!1}}(t))return e;const i=w(t)<=.179?l.LEGACY_DARK_THEME:l.LEGACY_LIGHT_THEME,s=function(e,t,i,s=4.5){const o=F(e,t),a=F(e,i);return o>=a?o>=s?t:L(e,t,s):a>=s?i:L(e,i,s)}(t,l.LEGACY_LIGHT_THEME.axes.axisTitle.fill,l.LEGACY_DARK_THEME.axes.axisTitle.fill);return{...i,axes:{...i.axes,axisTitle:{...i.axes.axisTitle,fill:s},tickLabel:{...i.axes.tickLabel,fill:s},axisLine:{...i.axes.axisLine,stroke:s},tickLine:{...i.axes.tickLine,stroke:s}}}}(z.useChartsBaseTheme(),e),U=Object(y.useActiveCursor)($,Y,{isDateHistogram:!0}),Z=Object(a.useMemo)((()=>(null!=k?k:[]).some((e=>{var t;return Boolean(null===(t=e.data)||void 0===t?void 0:t.length)}))),[k]),K=Object(a.useCallback)((e=>{e&&(null==H||H())}),[H]);let X=(J=v,({value:e})=>J(e));var J;if(!M){const e=(e=>{var t;const i=(null===(t=e[0])||void 0===t?void 0:t.data)||[];return null!=i&&i.length?{domainStart:i[0][0],domainEnd:i[Math.max(i.length-1,0)][0]}:void 0})(d);X=Object(y.renderEndzoneTooltip)(B,null==e?void 0:e.domainStart,null==e?void 0:e.domainEnd,v)}const Q=Object(T.f)(),ee=Object(f.a)(Q),te=d.some((({bars:e})=>null==e?void 0:e.show)),ie=h()(function(e){if("string"==typeof e)return w(e)<=.179?"tvbVisTimeSeriesDark":"tvbVisTimeSeriesLight"}(e)),se=Object(a.useCallback)(((e,t,i)=>{const s=d.filter((e=>e.seriesId===t)),o={seriesById:s,seriesName:e,seriesId:i,baseColor:s[0].baseColor,seriesPalette:s[0].palette,palettesRegistry:D,syncColors:A};return Object(C.a)(o)||null}),[D,d,A]),oe={...x.a,visible:t},ae=d.every((({stack:e,bars:t,lines:i})=>(null==t?void 0:t.show)&&e!==x.c.NONE||(null==i?void 0:i.show)))&&!V&&!P;return Object(j.jsx)(l.Chart,{ref:Y,renderer:"canvas",className:ie},Object(j.jsx)(l.Tooltip,{snap:!0,type:c===m.h.SHOW_FOCUSED?l.TooltipType.Follow:l.TooltipType.VerticalCursor,boundary:null!==(G=document.getElementById("app-fixed-viewport"))&&void 0!==G?G:void 0,headerFormatter:X}),Object(j.jsx)(l.Settings,{debugState:null!==(W=window._echDebugStateFlag)&&void 0!==W&&W,showLegend:i,legendValues:[l.LegendValue.CurrentAndLastValue],onRenderChange:K,allowBrushingLastHistogramBin:!0,legendPosition:s,onBrushEnd:({x:e})=>{if(!e)return;const[t,i]=e;p(t,i,d)},onElementClick:e=>{g(d,e)},animateData:!1,onPointerUpdate:N?U:void 0,pointerUpdateDebounce:0,theme:[{axes:{tickLabel:{padding:{inner:Z?19:q.axes.tickLabel.padding.inner}}}},te?{}:{crosshair:{band:{fill:"#F00"}}},{background:{color:e},legend:{labelOptions:{maxLines:o?null!=n?n:1:0}}}],baseTheme:q,externalPointerEvents:{tooltip:{visible:O,placement:l.Placement.Right}},locale:b.i18n.getLocale()}),k.map((({id:e,data:t,icon:i,color:s})=>{const o=((e,t)=>e.map((({key:e,docs:i})=>({dataValue:e,details:i[0],header:t({value:e})}))))(t,X),a={line:{stroke:s}};return Object(j.jsx)(l.LineAnnotation,{key:e,id:e,domainType:l.AnnotationDomainType.XDomain,dataValues:o,marker:Object(j.jsx)(r.EuiIcon,{type:x.b[i]||"asterisk"}),hideLinesTooltips:!0,style:a})})),d.map((({id:e,seriesId:t,label:i,bars:s,lines:o,data:a,hideInLegend:n,truncateLegend:r,xScaleType:c,yScaleType:d,groupId:u,color:m,isSplitByTerms:p,stack:g,points:h,y1AccessorFormat:b,y0AccessorFormat:y,tickFormat:f})=>{const T=(e=>{switch(e){case x.c.STACKED:case x.c.STACKED_WITHIN_SERIES:case x.c.PERCENT:return x.d;default:return}})(g),v=g===x.c.PERCENT,k=g!==x.c.NONE,A=`${e}-${i}`,O=i.toString(),E=se(O,t,e),w=p&&E?E:m;return null!=s&&s.show?Object(j.jsx)(S,{key:A,seriesId:e,seriesGroupId:u,name:Object(I.b)(O),data:a,hideInLegend:n,truncateLegend:r,bars:s,color:w,stackAccessors:T,stackMode:v?l.StackMode.Percentage:void 0,xScaleType:c,yScaleType:d,timeZone:ee,enableHistogramMode:k,y1AccessorFormat:b,y0AccessorFormat:y,tickFormat:f}):null!=o&&o.show?Object(j.jsx)(_,{key:A,seriesId:e,seriesGroupId:u,name:Object(I.b)(O),data:a,hideInLegend:n,truncateLegend:r,lines:o,color:w,stackAccessors:T,stackMode:v?l.StackMode.Percentage:void 0,points:h,xScaleType:c,yScaleType:d,timeZone:ee,enableHistogramMode:k,y1AccessorFormat:b,y0AccessorFormat:y,tickFormat:f}):null})),u.map((({id:e,groupId:t,position:i,tickFormatter:s,domain:o,hide:a})=>Object(j.jsx)(l.Axis,{key:t,groupId:t,id:e,position:i,domain:o,hide:a,gridLine:oe,ticks:5,tickFormat:s}))),Object(j.jsx)(l.Axis,{id:"bottom",position:l.Position.Bottom,title:R(B),tickFormat:v,gridLine:oe,style:ae?y.MULTILAYER_TIME_AXIS_STYLE:void 0,timeAxisLayerCount:ae?2:0}))};D.defaultProps={showGrid:!0,legend:!0,legendPosition:"right"};var B=i(18),M=i.n(B);const V=({ariaLabelContent:e,markdownContent:t,children:i,className:s,onRender:o,openLinksInNewTab:n=!0,defaultValue:l="",placeholder:c="",height:d="full",readOnly:u=!1,enableTooltipSupport:m=!1,validateLinks:p=!1,enableSoftLineBreaks:g=!1,...h})=>{const[b,y]=Object(a.useState)(l);Object(a.useEffect)((()=>{null==o||o()}),[o]);const f=Array();m||f.push("tooltip"),p||f.push("linkValidator"),g&&f.push("lineBreaks");const{parsingPlugins:T,processingPlugins:x,uiPlugins:v}=Object(r.getDefaultEuiMarkdownPlugins)({exclude:f});var k;return x[1][1].components.a=e=>Object(j.jsx)(r.EuiLink,M()({},e,{target:"_blank"})),u?Object(j.jsx)(r.EuiMarkdownFormat,{textSize:"relative",color:"inherit",className:s,"aria-label":null!=e?e:"markdown component",parsingPluginList:T,processingPluginList:n?x:void 0,"data-test-subj":h["data-test-subj"],style:h.style},null!==(k=null!=i?i:t)&&void 0!==k?k:""):Object(j.jsx)(r.EuiMarkdownEditor,{className:s,"aria-label":null!=e?e:"markdown component",placeholder:c,value:b,onChange:y,height:d,uiPlugins:v,parsingPluginList:T,processingPluginList:n?x:void 0,"data-test-subj":h["data-test-subj"]})};var P=i(49),H=i(72),G=i(106);class vis_TimeseriesVisualization extends a.Component{constructor(...e){super(...e),o()(this,"scaledDataFormat",this.props.getConfig("dateFormat:scaled")),o()(this,"dateFormat",this.props.getConfig("dateFormat")),o()(this,"yAxisIdGenerator",Object(r.htmlIdGenerator)("yaxis")),o()(this,"xAxisFormatter",(e=>{const t=Object(G.a)(e,this.scaledDataFormat,this.dateFormat,this.props.model.ignore_daylight_time);return e=>t(e)})),o()(this,"yAxisStackedByPercentFormatter",(e=>{const t=100*Number(e);return`${(Number.isNaN(t)?0:t).toFixed(0)}%`})),o()(this,"applyDocTo",(e=>t=>{const{fieldFormatMap:i}=this.props;Object.keys(t).forEach((e=>{if(null!=i&&i[e]){const s=Object(u.a)(e,i);t[e]=s(t[e])}}));const s=Object(H.a)(e,null,t,{noEscape:!0});return s instanceof Error?(this.showToastNotification=s.error.caused_by,e):s})),o()(this,"prepareAnnotations",(()=>{const{model:e,visData:t}=this.props;return Object(n.map)(e.annotations,(({id:i,color:s,icon:o,template:a})=>{const r=Object(n.get)(t,`${e.id}.annotations.${i}`,[]),l=this.applyDocTo(a);return{id:i,color:s,icon:o,data:r.map((({docs:e,...t})=>({...t,docs:e.map(l)})))}}))}))}componentDidUpdate(){const e=Object(T.b)().notifications.toasts;this.showToastNotification&&this.notificationReason!==this.showToastNotification.reason&&(this.notification&&e.remove(this.notification),this.notificationReason=this.showToastNotification.reason,this.notification=e.addDanger({title:this.showToastNotification.title,text:Object(j.jsx)(V,{readOnly:!0},this.showToastNotification.reason)})),!this.showToastNotification&&this.notification&&(e.remove(this.notification),this.notificationReason=null,this.notification=null)}render(){const{model:e,visData:t,onBrush:i,onFilterClick:s,syncColors:o,syncTooltips:a,syncCursor:r,palettesService:l,fieldFormatMap:g,getConfig:h,initialRender:b}=this.props,y=Object(n.get)(t,`${e.id}.series`,[]),f=Object(N.b)(t,e),T=this.yAxisIdGenerator("main_group"),v=e.series.filter((e=>!e.hidden)).map((e=>Object(n.cloneDeep)(e))),k=vis_TimeseriesVisualization.getAxisScaleType(e),A=vis_TimeseriesVisualization.getYAxisDomain(e),_=[];let S=!1;return this.showToastNotification=null,v.forEach((t=>{var i;const s=t.stacked===x.c.STACKED_WITHIN_SERIES,o=Boolean(t.separate_axis),a=o||s?t.id:T,r=o?vis_TimeseriesVisualization.getYAxisDomain(t):void 0,l=a!==T,b=t.formatter===m.b.DEFAULT?Object(u.a)(Object(c.a)(t.metrics),g):vis_TimeseriesVisualization.getTickFormatter(t,h),f={...t.palette,name:"kibana"===t.split_color_mode?"kibana_palette":t.split_color_mode||(null===(i=t.palette)||void 0===i?void 0:i.name)},j=o?vis_TimeseriesVisualization.getAxisScaleType(t):k;if(t.stacked===x.c.PERCENT&&(t.separate_axis=!0,t.axisFormatter="percent",t.axis_min=t.axis_min||0,t.axis_max=t.axis_max||1,t.axis_position=e.axis_position),y.filter((e=>Object(n.startsWith)(e.id,t.id))).forEach((e=>{e.tickFormat=b,e.groupId=a,e.yScaleType=j,e.hideInLegend=Boolean(t.hide_in_legend),e.palette=f,e.baseColor=t.color,e.isSplitByTerms="terms"===t.split_mode})),l)vis_TimeseriesVisualization.addYAxis(_,{domain:r,groupId:a,id:this.yAxisIdGenerator(t.id),position:t.axis_position,hide:s,tickFormatter:t.stacked===x.c.PERCENT?this.yAxisStackedByPercentFormatter:b});else if(!S){const t=((e,t)=>{const i=new Set;return e.forEach((e=>{if(!e.separate_axis){if(e.formatter===m.b.DEFAULT){const s=e.metrics[e.metrics.length-1],o=p.a.find((e=>e.id===s.type));if(s.field&&null!=o&&o.meta.isFieldRequired&&null!=t&&t[s.field])return i.add(JSON.stringify(t[s.field]))}i.add(JSON.stringify({formatter:e.formatter}))}})),1===i.size})(v,g)?b:Object(d.a)(void 0,void 0,h);vis_TimeseriesVisualization.addYAxis(_,{tickFormatter:t,id:this.yAxisIdGenerator("main"),groupId:T,position:e.axis_position,domain:A}),S=!0}})),Object(j.jsx)("div",{className:"tvbVis"},Object(j.jsx)("div",{className:"tvbVisTimeSeries"},Object(j.jsx)(D,{series:y,yAxis:_,onBrush:i,onFilterClick:s,backgroundColor:e.background_color,showGrid:Boolean(e.show_grid),legend:Boolean(e.show_legend),legendPosition:e.legend_position,truncateLegend:Boolean(e.truncate_legend),ignoreDaylightTime:Boolean(e.ignore_daylight_time),maxLegendLines:e.max_lines_legend,tooltipMode:e.tooltip_mode,xAxisFormatter:this.xAxisFormatter(f),annotations:this.prepareAnnotations(),syncColors:o,syncTooltips:a,syncCursor:r,palettesService:l,interval:f,initialRender:b,useLegacyTimeAxis:h(P.LEGACY_TIME_AXIS,!1),isLastBucketDropped:Boolean(e.drop_last_bucket||e.series.some((e=>e.series_drop_last_bucket)))})))}}o()(vis_TimeseriesVisualization,"getYAxisDomain",(e=>{const t=Object(n.get)(e,"axis_min","").toString(),i=Object(n.get)(e,"axis_max","").toString(),s=e.series?e.series.filter((({hidden:e})=>!e)).every((({fill:e})=>0===Number(e))):0===Number(e.fill);return{min:t.length?Number(t):void 0,max:i.length?Number(i):void 0,fit:s}})),o()(vis_TimeseriesVisualization,"addYAxis",((e,{id:t,groupId:i,position:s,tickFormatter:o,domain:a,hide:n})=>{e.push({id:t,groupId:i,position:s,tickFormatter:o,domain:a,hide:n})})),o()(vis_TimeseriesVisualization,"getAxisScaleType",(e=>"log"===Object(n.get)(e,"axis_scale")?l.ScaleType.Log:l.ScaleType.Linear)),o()(vis_TimeseriesVisualization,"getTickFormatter",((e,t)=>Object(d.a)(Object(n.get)(e,"formatter"),Object(n.get)(e,"value_template"),t)))},67:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));const s=["#68BC00","#009CE0","#B0BC00","#16A5A5","#D33115","#E27300","#FCC400","#7B64FF","#FA28FF","#333333","#808080","#194D33","#0062B1","#808900","#0C797D","#9F0500","#C45100","#FB9E00","#653294","#AB149E","#0F1419","#666666"]},68:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i(54),o=i.n(s);const a=e=>{let t=new o.a(e);const i=t.hsl().object();return i.l-=100*t.luminosity(),t=o.a.hsl(i),t.rgb().toString()}},72:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var s=i(38),o=i(82),a=i(2),n=i(59);const r=o.b.create();var l,c;function d(e,t={},i={},s={}){try{return r[o.a](e.split(n.a).join(`[${n.a}]`),{strict:!0,knownHelpersOnly:!0,knownHelpers:{rison:!0,encodeURIComponent:!0},...s})({...i,args:t})}catch(t){if(-1!==t.toString().indexOf("Parse error"))return e;if(-1!==t.message.indexOf("not defined in")){const e=t.message.split(/"/)[1];t.error={caused_by:{reason:a.i18n.translate("visTypeTimeseries.replaceVars.errors.unknownVarDescription",{defaultMessage:"{badVar} is an unknown variable",values:{badVar:"{{"+e+"}}"}}),title:a.i18n.translate("visTypeTimeseries.replaceVars.errors.unknownVarTitle",{defaultMessage:"Error processing your markdown"})}}}else t.error={caused_by:{reason:a.i18n.translate("visTypeTimeseries.replaceVars.errors.markdownErrorDescription",{defaultMessage:"Please verify you are only using markdown, known variables, and built-in Handlebars expressions"}),title:a.i18n.translate("visTypeTimeseries.replaceVars.errors.markdownErrorTitle",{defaultMessage:"Error processing your markdown"})}};return t}}r.registerHelper("rison",(l="rison",c=e=>Object(s.encode)(e),(...e)=>{const{hash:t}=e.slice(-1)[0],i=Object.keys(t).length>0,s=e.length>1;if(i&&s)throw new Error(`[${l}]: both value list and hash are not supported`);if(i){if(Object.values(t).some((e=>void 0===e)))throw new Error(`[${l}]: unknown variable`);return c(t)}{const t=e.slice(0,-1);if(t.some((e=>void 0===e)))throw new Error(`[${l}]: unknown variable`);if(0===t.length)throw new Error(`[${l}]: unknown variable`);return 1===t.length?c(t[0]):c(t)}})),r.registerHelper("encodeURIComponent",(e=>{const t=String(e);return encodeURIComponent(t)}))},81:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i(5),o=i(68),a=i(67),n=i(59);const r=({seriesById:e,seriesName:t,seriesId:i,baseColor:r,seriesPalette:l,palettesRegistry:c,syncColors:d})=>{if(!l)return null;const u=l.name===s.d.RAINBOW||l.name===s.d.GRADIENT?"custom":l.name,m=l.name===s.d.GRADIENT?{...l.params,colors:[r,Object(o.a)(r)],gradient:!0}:l.name===s.d.RAINBOW?{...l.params,colors:a.a}:l.params;return null==c?void 0:c.get(u||"default").getCategoricalColor([{name:Object(n.b)(t),rankAtDepth:e.findIndex((({id:e})=>e===i)),totalSeriesAtDepth:e.length}],{maxDepth:1,totalSeries:e.length,behindText:!1,syncColors:d},m)}}}]);