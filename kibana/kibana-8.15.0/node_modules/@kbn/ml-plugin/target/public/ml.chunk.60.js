/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[60],{188:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(2),r=n.n(a),i=n(25),s=n(15),o=n(28),l=n(122),c=n(6);const u=({jobCount:e})=>{const{showNodeInfo:t}=Object(l.d)();return!1===t||!1===Object(o.b)()||0===e?null:Object(c.jsx)(r.a.Fragment,null,Object(c.jsx)(i.EuiCallOut,{title:Object(c.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(c.jsx)("div",null,Object(c.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"{jobCount, plural, one {# job} other {# jobs}} will start after autoscaling has increased ML capacity. This may take several minutes.",values:{jobCount:e}}))),Object(c.jsx)(i.EuiSpacer,{size:"m"}))},d=()=>{const{showNodeInfo:e}=Object(l.d)();return!1===Object(o.b)()?null:e?Object(c.jsx)(r.a.Fragment,null,Object(c.jsx)(i.EuiCallOut,{title:Object(c.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(c.jsx)("div",null,Object(c.jsx)(s.FormattedMessage,{id:"xpack.ml.newJobAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There are currently no nodes that can run the job, therefore it will remain in OPENING state until autoscaling increases ML capacity. This may take several minutes."}))),Object(c.jsx)(i.EuiSpacer,{size:"m"})):Object(c.jsx)(r.a.Fragment,null,Object(c.jsx)(i.EuiCallOut,{title:Object(c.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.serverless.title",defaultMessage:"Machine learning is starting..."}),color:"primary",iconType:"iInCircle"}),Object(c.jsx)(i.EuiSpacer,{size:"m"}))};n(44)},275:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return m}));var a=n(120),r=n.n(a),i=(n(2),n(293)),s=n(10),o=n(312),l=n(6);const c=e=>{const{services:{data:{query:{timefilter:{timefilter:t}}}}}=Object(s.d)(),n=Object(i.a)();return Object(l.jsx)(o.a,r()({},e,{currentTimeFilter:t.getTime(),dashboardService:n}))};var u=n(37),d=n(184);function m(e){return void 0===e||0===e.length||!e.some(((t,n)=>{const a=t.url_name,r=[...e];r.splice(n,1);let i=Object(d.b)(a,r);if(!0===i&&(s=t,Object(u.a)(s,["url_name","url_value","time_range"])&&"string"==typeof s.time_range)){const e=t.time_range;i=Object(d.c)(e)}var s;return!i}))}},308:function(e,t,n){e.exports=n(57)(1783)},410:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return u}));var a=n(2),r=n.n(a),i=n(25),s=n(15),o=n(42),l=n(6);const c=e=>{switch(e){case o.c.INFO:return"primary";case o.c.ERROR:return"danger";default:return e}},u=e=>{switch(e){case o.c.INFO:return"iInCircle";case o.c.ERROR:return"cross";case o.c.SUCCESS:return"check";case o.c.WARNING:return"warning";default:return e}},d=({url:e})=>Object(l.jsx)(i.EuiLink,{href:e,target:"_BLANK"},Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.validateJob.learnMoreLinkText",defaultMessage:"Learn more"})),m=({text:e,url:t})=>Object(l.jsx)(r.a.Fragment,null,e," ",t&&Object(l.jsx)(d,{url:t})),p=({heading:e,status:t,text:n,url:a})=>Object(l.jsx)(r.a.Fragment,null,Object(l.jsx)(i.EuiCallOut,{"data-test-subj":`mlValidationCallout ${t}`,color:c(t),size:"s",title:e||Object(l.jsx)(m,{text:n,url:a}),iconType:t?u(t):"questionInCircle"},e&&Object(l.jsx)(m,{text:n,url:a})),Object(l.jsx)(i.EuiSpacer,{size:"m"}))},411:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n(25),i=n(114),s=n(5),o=n(6);const l=20;function c(e){return null!==e?s.i18n.translate("xpack.ml.jobSelector.filterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:e.message}}):""}function u({checkboxDisabledCheck:e,columns:t,currentPage:n=0,filterDefaultFields:u,filters:d,items:m,itemsPerPage:p=l,onTableChange:f,radioDisabledCheck:h,selectedIds:g,setCurrentPaginationData:b,singleSelection:j,sortableProperties:x,tableItemId:w="id"}){const[y,v]=Object(a.useState)(D()),[O,E]=Object(a.useState)(m),[I,k]=Object(a.useState)(g),[T,S]=Object(a.useState)(""),[_,M]=Object(a.useState)(),[C,R]=Object(a.useState)({itemsPerPage:p,firstItemIndex:0,lastItemIndex:1}),[F,A]=Object(a.useState)(r.EuiSearchBar.Query.MATCH_ALL),[L,N]=Object(a.useState)(null);function D(){const e={all:!1};return g.forEach((t=>{e[t]=!0})),e}function P({isSelected:e,itemId:t}){const n=Object.getOwnPropertyNames(y),a=O.map((e=>e[w]));let r=n.filter((e=>!0===y[e]&&e!==t));"all"!==t?!0===e&&r.push(t):!1===e?r=r.filter((e=>!1===a.includes(e))):(r=[...r,...a],r=[...new Set(r)]),b&&b({pageIndex:_.getCurrentPageIndex(),itemsPerPage:C.itemsPerPage}),f(r)}function z({query:e,error:t}){if(t)N(t);else{const t=r.EuiSearchBar.Query.execute(e,m,{defaultFields:u});N(null),E(t),A(e)}}function q(e){return!0===y[e]}function V(){return-1===O.findIndex((e=>!q(e[w])))}Object(a.useEffect)((()=>{E(m),z({query:F})}),[m]),Object(a.useEffect)((()=>{v(D())}),[g]),Object(a.useEffect)((()=>{const e=new i.Pager(O.length,p,n);R({itemsPerPage:p,firstItemIndex:e.getFirstItemIndex(),lastItemIndex:e.getLastItemIndex()}),M(e)}),[O]);const W=Object(a.useMemo)((()=>Object(r.htmlIdGenerator)()()),[]);function B(e){const t=s.i18n.translate("xpack.ml.jobSelector.customTable.selectAllCheckboxLabel",{defaultMessage:"Select all"});return Object(o.jsx)(r.EuiCheckbox,{id:`${e?"mobile-":""}${W}`,label:e?t:null,checked:V(),onChange:J})}function $(e){if(j){const t=I[0];v({...y,[t]:!1,[e]:!0}),function(e){f([e])}(e),k([e])}else{const t=!q(e);v({...y,[e]:t}),P({isSelected:t,itemId:e})}}function J(){const e=V()||!0===y.all,t={};O.forEach((n=>t[n[w]]=!e)),v(t),P({isSelected:!e,itemId:"all"})}return Object(o.jsx)(a.Fragment,null,Object(o.jsx)(r.EuiSpacer,{size:"s"}),Object(o.jsx)(r.EuiFlexGroup,{direction:"column"},Object(o.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"mlCustomSelectionTableSearchBar"},Object(o.jsx)(r.EuiSearchBar,{defaultQuery:F,box:{incremental:!0,placeholder:s.i18n.translate("xpack.ml.jobSelector.customTable.searchBarPlaceholder",{defaultMessage:"Search..."})},filters:d,onChange:z}),Object(o.jsx)(r.EuiFormRow,{fullWidth:!0,isInvalid:null!==L,error:c(L),style:{maxHeight:"0px"}},Object(o.jsx)(a.Fragment,null)))),Object(o.jsx)(r.EuiSpacer,{size:"m"}),Object(o.jsx)(r.EuiTableHeaderMobile,null,Object(o.jsx)(r.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween",alignItems:"baseline"},Object(o.jsx)(r.EuiFlexItem,{grow:!1},B(!0)))),Object(o.jsx)(r.EuiTable,{"data-test-subj":"mlCustomSelectionTable"},Object(o.jsx)(r.EuiTableHeader,null,function(){const e=[];return t.forEach(((n,a)=>{n.isCheckbox&&!j?e.push(Object(o.jsx)(r.EuiTableHeaderCellCheckbox,{key:n.id,width:n.width},B())):e.push(Object(o.jsx)(r.EuiTableHeaderCell,{key:n.id,align:t[a].alignment,width:n.width,onSort:n.isSortable?()=>function(e){x.sortOn(e);const t=x.sortItems(O);E(t),S(e)}(n.id):void 0,isSorted:T===n.id,isSortAscending:!x||x.isAscendingByName(n.id),mobileOptions:n.mobileOptions},n.label))})),e.length?e:null}()),Object(o.jsx)(r.EuiTableBody,null,function(){const n=n=>{const a=t.map((t=>{const a=n[t.id];let i;return t.isCheckbox?Object(o.jsx)(r.EuiTableRowCellCheckbox,{key:t.id},!j&&Object(o.jsx)(r.EuiCheckbox,{disabled:void 0!==e?e(n):void 0,id:`${n[w]}-checkbox`,"data-test-subj":`${n[w]}-checkbox`,checked:q(n[w]),onChange:()=>$(n[w])}),j&&Object(o.jsx)(r.EuiRadio,{id:n[w],"data-test-subj":`${n[w]}-radio-button`,checked:q(n[w]),onChange:()=>$(n[w]),disabled:void 0!==h?h(n):void 0})):(i=t.render?t.render(n):a,Object(o.jsx)(r.EuiTableRowCell,{key:t.id,align:t.alignment,truncateText:a&&a.truncateText,textOnly:!a||a.textOnly,mobileOptions:{header:t.label,...t.mobileOptions}},i))}));return Object(o.jsx)(r.EuiTableRow,{key:n[w],isSelected:q(n[w]),hasSelection:!0,hasActions:!0,"data-test-subj":`mlCustomSelectionTableRow row-${n[w]}`},a)},a=[];for(let e=C.firstItemIndex;e<=C.lastItemIndex;e++){const t=O[e];if(void 0===t)break;a.push(n(t))}return a}())),Object(o.jsx)(r.EuiSpacer,{size:"m"}),void 0!==_&&Object(o.jsx)(r.EuiTablePagination,{activePage:_.getCurrentPageIndex(),itemsPerPage:C.itemsPerPage,itemsPerPageOptions:[5,10,20,50],pageCount:_.getTotalPages(),onChangeItemsPerPage:function(e){_.setItemsPerPage(e),R({...C,itemsPerPage:e,firstItemIndex:_.getFirstItemIndex(),lastItemIndex:_.getLastItemIndex()})},onChangePage:e=>function(e){_.goToPageIndex(e),R({...C,firstItemIndex:_.getFirstItemIndex(),lastItemIndex:_.getLastItemIndex()})}(e)}))}},765:function(e,t,n){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,t,n){"use strict";var a=e("../lib/oop"),r=e("./text_highlight_rules").TextHighlightRules,i=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};a.inherits(i,r),t.JsonHighlightRules=i})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(e,t,n){"use strict";var a=e("../range").Range,r=function(){};(function(){this.checkOutdent=function(e,t){return!!/^\s+$/.test(e)&&/^\s*\}/.test(t)},this.autoOutdent=function(e,t){var n=e.getLine(t).match(/^(\s*\})/);if(!n)return 0;var r=n[1].length,i=e.findMatchingBracket({row:t,column:r});if(!i||i.row==t)return 0;var s=this.$getIndent(e.getLine(i.row));e.replace(new a(t,0,t,r-1),s)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(r.prototype),t.MatchingBraceOutdent=r})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(e,t,n){"use strict";var a=e("../../lib/oop"),r=e("../../range").Range,i=e("./fold_mode").FoldMode,s=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};a.inherits(s,i),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(e,t,n){var a=e.getLine(n);if(this.singleLineBlockCommentRe.test(a)&&!this.startRegionRe.test(a)&&!this.tripleStarBlockCommentRe.test(a))return"";var r=this._getFoldWidgetBase(e,t,n);return!r&&this.startRegionRe.test(a)?"start":r},this.getFoldWidgetRange=function(e,t,n,a){var r,i=e.getLine(n);if(this.startRegionRe.test(i))return this.getCommentRegionBlock(e,i,n);if(r=i.match(this.foldingStartMarker)){var s=r.index;if(r[1])return this.openingBracketBlock(e,r[1],n,s);var o=e.getCommentFoldRange(n,s+r[0].length,1);return o&&!o.isMultiLine()&&(a?o=this.getSectionRange(e,n):"all"!=t&&(o=null)),o}return"markbegin"!==t&&(r=i.match(this.foldingStopMarker))?(s=r.index+r[0].length,r[1]?this.closingBracketBlock(e,r[1],n,s):e.getCommentFoldRange(n,s,-1)):void 0},this.getSectionRange=function(e,t){for(var n=e.getLine(t),a=n.search(/\S/),i=t,s=n.length,o=t+=1,l=e.getLength();++t<l;){var c=(n=e.getLine(t)).search(/\S/);if(-1!==c){if(a>c)break;var u=this.getFoldWidgetRange(e,"all",t);if(u){if(u.start.row<=i)break;if(u.isMultiLine())t=u.end.row;else if(a==c)break}o=t}}return new r(i,s,o,e.getLine(o).length)},this.getCommentRegionBlock=function(e,t,n){for(var a=t.search(/\s*$/),i=e.getLength(),s=n,o=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,l=1;++n<i;){t=e.getLine(n);var c=o.exec(t);if(c&&(c[1]?l--:l++,!l))break}if(n>s)return new r(s,a,n,t.length)}}.call(s.prototype)})),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(e,t,a){"use strict";var r=e("../lib/oop"),i=e("./text").Mode,s=e("./json_highlight_rules").JsonHighlightRules,o=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("./behaviour/cstyle").CstyleBehaviour,c=e("./folding/cstyle").FoldMode,u=e("../worker/worker_client").WorkerClient,d=function(){this.HighlightRules=s,this.$outdent=new o,this.$behaviour=new l,this.foldingRules=new c};r.inherits(d,i),function(){this.getNextLineIndent=function(e,t,n){var a=this.$getIndent(t);return"start"==e&&t.match(/^.*[\{\(\[]\s*$/)&&(a+=n),a},this.checkOutdent=function(e,t,n){return this.$outdent.checkOutdent(t,n)},this.autoOutdent=function(e,t,n){this.$outdent.autoOutdent(t,n)},this.createWorker=function(e){var t=new u(["ace"],n(766),"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t},this.$id="ace/mode/json"}.call(d.prototype),t.Mode=d}))},766:function(e,t){e.exports.id="ace/mode/json_worker",e.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},859:function(e,t,n){"use strict";n.r(t),n.d(t,"Page",(function(){return Ht}));var a=n(120),r=n.n(a),i=n(2),s=n.n(i),o=n(25),l=n(5),c=n(15),u=n(158),d=n(11),m=n(506),p=n(8),f=n(322),h=n(116),g=n(10),b=n(6);const j=({canCreateDataView:e,createDataView:t,setCreateDataView:n})=>Object(b.jsx)(o.EuiSwitch,{name:"mlCreateDataView",disabled:!1===e,label:l.i18n.translate("xpack.ml.dataViewUtils.createDataViewSwitchLabel",{defaultMessage:"Create data view"}),checked:!0===t,onChange:()=>n(!t),"data-test-subj":"mlCreateDataViewSwitch"}),x=({dataViewAvailableTimeFields:e,dataViewTimeField:t,onTimeFieldChanged:n})=>{const a={text:l.i18n.translate("xpack.ml.dataViewUtils.noTimeFieldOptionLabel",{defaultMessage:"I don't want to use the time field option"}),value:void 0};return Object(b.jsx)(o.EuiFormRow,{label:Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataViewUtils.dataViewTimeFieldLabel",defaultMessage:"Time field for data view"}),helpText:Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataViewUtils.dataViewTimeFieldHelpText",defaultMessage:"Select a primary time field for use with the global time filter."})},Object(b.jsx)(o.EuiSelect,{options:[...e.map((e=>({text:e}))),{disabled:!0,text:"───",value:""},a],value:t,onChange:n,"data-test-subj":"mlDataViewTimeFieldSelect"}))},w=({canCreateDataView:e,createDataView:t,dataViewTitleExists:n,setCreateDataView:a,dataViewAvailableTimeFields:r,dataViewTimeField:i,onTimeFieldChanged:c})=>Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFormRow,{isInvalid:t&&n||!1===e,error:[...!1===e?[Object(b.jsx)(o.EuiText,{size:"xs",color:"warning"},l.i18n.translate("xpack.ml.dataViewUtils.dataViewPermissionWarning",{defaultMessage:"You need permission to create data views."}))]:[],...t&&n?[l.i18n.translate("xpack.ml.dataViewUtils.dataViewTitleError",{defaultMessage:"A data view with this title already exists."})]:[]]},Object(b.jsx)(j,{canCreateDataView:e,createDataView:t,setCreateDataView:a})),t&&!n&&r.length>0&&Object(b.jsx)(x,{dataViewAvailableTimeFields:r,dataViewTimeField:i,onTimeFieldChanged:c})),y=({messages:e})=>Object(b.jsx)(s.a.Fragment,null,e.map(((e,t)=>Object(b.jsx)(i.Fragment,{key:t},Object(b.jsx)(o.EuiCallOut,{"data-test-subj":`analyticsWizardCreationCallout_${t}`,title:e.message,color:void 0!==e.error?"danger":"primary",iconType:void 0!==e.error?"error":"checkInCircleFilled",size:"s"},void 0!==e.error&&Object(b.jsx)(o.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},e.error)),Object(b.jsx)(o.EuiSpacer,{size:"s"})))));var v=n(183);const O=async e=>{const t=Object(v.f)(e);let n="",a="",r=!0,i="",s=[],o=!1;try{var l;delete t.dest,delete t.model_memory_limit,delete t.analyzed_fields;const e=await d.ml.dataFrameAnalytics.explainDataFrameAnalytics(t);i=null===(l=e.memory_estimation)||void 0===l?void 0:l.expected_memory_without_disk,s=e.field_selection||[]}catch(e){const t=Object(f.b)(e);r=!1,n=t.message,t.causedBy&&(a=t.causedBy)}return n.includes("status_exception")&&n.includes("Unable to estimate memory usage as no documents")&&(o=!0),{success:r,expectedMemory:i,fieldSelection:s,errorMessage:n,errorReason:a,noDocsContainMappedFields:o}},E=()=>{const{services:{application:{capabilities:e}}}=Object(g.d)();return Object(i.useMemo)((()=>!0===e.savedObjectsManagement.edit||!0===e.indexPatterns.save),[e])};var I=n(122);const k=({actions:e,state:t})=>{const{setFormState:n}=e,{selectedDataView:a}=Object(I.c)(),[r,s]=Object(i.useState)([]),o=Object(i.useCallback)((e=>{const t=e.target.value;if(""===t)return;const a=r.find((e=>e===t));n({timeFieldName:a})}),[r,n]);return Object(i.useEffect)((()=>{void 0!==a&&n({timeFieldName:a.timeFieldName})}),[]),Object(i.useEffect)((()=>{if(void 0!==a){const e=a.fields.filter((e=>"date"===e.type)).map((e=>e.name));s(e)}}),[a,n]),{dataViewAvailableTimeFields:r,onTimeFieldChanged:o}};var T=n(218),S=n(164),_=n(259),M=n(1);const C=()=>{const e=Object(g.f)({page:M.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});return Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:Object(b.jsx)(o.EuiIcon,{size:"xxl",type:"list"}),title:l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardTitle",{defaultMessage:"Data Frame Analytics"}),description:l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardDescription",{defaultMessage:"Return to the analytics management page."}),href:e,"data-test-subj":"analyticsWizardCardManagement"}))},R=({jobId:e,analysisType:t})=>{const n=Object(g.f)({page:M.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:e,analysisType:t}});return Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:Object(b.jsx)(o.EuiIcon,{size:"xxl",type:"visTable"}),title:l.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardTitle",{defaultMessage:"View Results"}),description:l.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardDescription",{defaultMessage:"View results for the analytics job."}),href:n,"data-test-subj":"analyticsWizardViewResultsCard"}))},F=({currentProgress:e,failedJobMessage:t})=>void 0===e?null:Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiSpacer,null),void 0!==t&&Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiCallOut,{"data-test-subj":"analyticsWizardProgressCallout",title:l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutTitle",{defaultMessage:"Job failed"}),color:"danger",iconType:"error",size:"s"},Object(b.jsx)("p",null,t)),Object(b.jsx)(o.EuiSpacer,{size:"s"})),Object(b.jsx)(o.EuiText,{size:"m"},Object(b.jsx)("strong",null,l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressTitle",{defaultMessage:"Progress"}))),Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(o.EuiFlexGroup,{alignItems:"center"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiText,{size:"s"},Object(b.jsx)("strong",null,l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressPhaseTitle",{defaultMessage:"Phase"})," ",e.currentPhase,"/",e.totalPhases))),Object(b.jsx)(o.EuiFlexItem,{style:{width:"400px"},grow:!1},Object(b.jsx)(o.EuiProgress,{value:e.progress,max:100,color:"primary",size:"l","data-test-subj":"mlAnalyticsCreationWizardProgress"})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiText,{size:"s"},`${e.progress}%`))));var A=n(188);const L=({jobId:e,jobType:t,showProgress:n})=>{const[a,r]=Object(i.useState)(!1),[c,u]=Object(i.useState)(void 0),[m,p]=Object(i.useState)(!1),[f,h]=Object(i.useState)(void 0),[j,x]=Object(i.useState)(!1),{services:{notifications:w}}=Object(g.d)();return Object(i.useEffect)((()=>{r(!0)}),[]),Object(i.useEffect)((()=>{if(!1===n)return;const t=setInterval((async()=>{try{const n=await d.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(e),a=Object(_.b)(n)?n.data_frame_analytics[0]:void 0;if(x((null==a?void 0:a.state)===T.c.STARTING&&void 0===(null==a?void 0:a.node)),void 0!==a){const n=Object(S.c)(a);a.state===T.c.FAILED&&(clearInterval(t),u(a.failure_reason||l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutMessage",{defaultMessage:"Analytics job {jobId} has failed.",values:{jobId:e}}))),h(n),(n.currentPhase===n.totalPhases&&100===n.progress||a.state===T.c.STOPPED&&(1!==n.currentPhase||0!==n.progress))&&(clearInterval(t),p(n.currentPhase===n.totalPhases&&100===n.progress))}else clearInterval(t)}catch(n){w.toasts.addDanger(l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressErrorMessage",{defaultMessage:"An error occurred getting progress stats for analytics job {jobId}",values:{jobId:e}})),clearInterval(t)}}),1e3);return()=>clearInterval(t)}),[a]),Object(b.jsx)(s.a.Fragment,null,j&&Object(b.jsx)(A.b,{jobType:"data-frame-analytics"}),Object(b.jsx)(o.EuiFlexGroup,{direction:"column"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},n&&Object(b.jsx)(F,{currentProgress:f,failedJobMessage:c})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiHorizontalRule,null),Object(b.jsx)(o.EuiFlexGroup,null,Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(C,null)),!0===m?Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(R,{jobId:e,analysisType:t})):null))))},N=({actions:e,state:t,step:n,showCreateDataView:a=!1})=>{const r=E(),{dataViewAvailableTimeFields:c,onTimeFieldChanged:u}=k({actions:e,state:t}),{createAnalyticsJob:d,setFormState:m,startAnalyticsJob:p}=e,{isAdvancedEditorValidJson:f,isJobCreated:h,isJobStarted:g,isValid:j,requestMessages:x}=t,{createDataView:v,destinationDataViewTitleExists:O,jobId:I,jobType:T,timeFieldName:S}=t.form,[_,M]=Object(i.useState)(!0),[C,R]=Object(i.useState)(!1),[F,A]=Object(i.useState)(!1);return n!==Ut.CREATE?null:Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsCreateJobWizardCreateStep active"},!h&&!g&&Object(b.jsx)(s.a.Fragment,null,a&&Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(w,{canCreateDataView:r,createDataView:v,dataViewTitleExists:O,setCreateDataView:()=>m({createDataView:!v}),dataViewAvailableTimeFields:c,dataViewTimeField:S,onTimeFieldChanged:u}),Object(b.jsx)(o.EuiSpacer,null)),Object(b.jsx)(o.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiFormRow,{helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.startCheckboxHelpText",{defaultMessage:"If unselected, job can be started later by returning to the jobs list."})},Object(b.jsx)(o.EuiSwitch,{"data-test-subj":"mlAnalyticsCreateJobWizardStartJobSwitch",name:"mlAnalyticsCreateJobWizardStartJobSwitch",label:l.i18n.translate("xpack.ml.dataframe.analytics.create.wizardStartCheckbox",{defaultMessage:"Start immediately"}),checked:_,onChange:e=>{M(e.target.checked)}}))),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiButton,{className:"mlAnalyticsCreateWizard__footerButton",disabled:!j||!f,onClick:async()=>{R(!0);const e=await d();!1===e&&R(!1),_&&!0===e&&(A(!0),p())},fill:!0,isLoading:C,"data-test-subj":"mlAnalyticsCreateJobWizardCreateButton"},l.i18n.translate("xpack.ml.dataframe.analytics.create.wizardCreateButton",{defaultMessage:"Create"}))))),Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(y,{messages:x}),!0===h?Object(b.jsx)(L,{jobId:I,jobType:T,showProgress:F}):null)},D=Object(h.a)((async()=>({default:(await n.e(83).then(n.bind(null,855))).EditorComponent}))),P=e=>{const{actions:t,state:n}=e,{setAdvancedEditorRawString:a,setFormState:s}=t,{advancedEditorMessages:c,advancedEditorRawString:u,isJobCreated:m}=n,{jobId:h,jobIdEmpty:j,jobIdExists:x,jobIdValid:w}=n.form,y=Object(i.useRef)(null),{toasts:v}=Object(g.i)(),O=Object(i.useMemo)((()=>Object(p.debounce)((async()=>{try{const e=await d.ml.dataFrameAnalytics.jobsExist([h],!0);s({jobIdExists:e[h].exists})}catch(e){v.addDanger(l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(f.a)(e)}}))}}),400)),[h]);return Object(i.useEffect)((()=>{if(null===y.current)return;const e=document.createEvent("MouseEvents");e.initEvent("mouseup",!0,!0),y.current.dispatchEvent(e)}),[]),Object(i.useEffect)((()=>(!0===w?O():"string"==typeof h&&""===h.trim()&&!0===x&&s({jobIdExists:!1}),()=>{O.cancel()})),[h]),Object(b.jsx)(o.EuiForm,{className:"mlDataFrameAnalyticsCreateForm"},Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdLabel",{defaultMessage:"Analytics job ID"}),isInvalid:!j&&!w||x,error:[...j||w?[]:[l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...x?[l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[]]},Object(b.jsx)(o.EuiFieldText,{inputRef:e=>{e&&(y.current=e)},disabled:m,placeholder:"analytics job ID",value:h,onChange:e=>s({jobId:e.target.value}),"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!j&&!w||x})),Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.configRequestBody",{defaultMessage:"Configuration request body"}),style:{maxWidth:"100%"}},Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsCreateJobWizardAdvancedEditorCodeEditor"},Object(b.jsx)(D,{value:u,onChange:e=>{a(e)},readOnly:m}))),Object(b.jsx)(o.EuiSpacer,null),c.map(((e,t)=>Object(b.jsx)(i.Fragment,{key:t},Object(b.jsx)(o.EuiCallOut,{title:""!==e.message?e.message:e.error,color:void 0!==e.error?"danger":"primary",iconType:void 0!==e.error?"error":"checkInCircleFilled",size:"s"},""!==e.message&&void 0!==e.error?Object(b.jsx)("p",null,e.error):null),Object(b.jsx)(o.EuiSpacer,null)))),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(N,r()({},e,{step:Ut.CREATE,showCreateDataView:!0})))},z=({setCurrentStep:e,state:t})=>{const{selectedDataView:n}=Object(u.b)(),{form:a,isJobCreated:r}=t,{dependentVariable:s,includes:c,jobConfigQueryString:d,jobType:m,trainingPercent:p}=a,f=m===T.b.REGRESSION||m===T.b.CLASSIFICATION,h=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.sourceIndex",{defaultMessage:"Source index"}),description:n.title||v.c},{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.Query",{defaultMessage:"Query"}),description:d||v.c}],g=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobType",{defaultMessage:"Job type"}),description:m}],j=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFields",{defaultMessage:"Included fields"}),description:c.length>5?l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFieldsAndMoreDescription",{defaultMessage:"{includedFields} ... (and {extraCount} more)",values:{extraCount:c.length-5,includedFields:c.slice(0,5).join(", ")}}):c.join(", ")}];return f&&(g.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.trainingPercent",{defaultMessage:"Training percent"}),description:`${p}`}),j.unshift({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.dependentVariable",{defaultMessage:"Dependent variable"}),description:s})),Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:h})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:g})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:j}))),Object(b.jsx)(o.EuiSpacer,null),!r&&Object(b.jsx)(o.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(Ut.CONFIGURATION)}},l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.editButtonText",{defaultMessage:"Edit"})))};var q=n(334),V=n(423),W=n(837),B=n(839),$=n(247),J=n(246),U=n(215),H=n(351),G=n(131),Q=n(519),Y=n(414);const X=new Set(["ip","keyword"]),Z=(e,t,n)=>{if(e===Q.a)return!1;const a=Y.a.has(t),r=a||X.has(t)||t===G.a.BOOLEAN;return n===T.b.REGRESSION?a||Y.c.has(t):n===T.b.CLASSIFICATION?r:void 0},K=(e,t,n)=>{let a,r,i,s;return n===T.b.CLASSIFICATION&&(e.includes("must have at most")||e.includes("must have at least"))?a=e:e.includes("status_exception")&&e.includes("unsupported type")?r=e:e.includes("status_exception")&&e.includes("Unable to estimate memory usage as no documents")?i=l.i18n.translate("xpack.ml.dataframe.analytics.create.allDocsMissingFieldsErrorMessage",{defaultMessage:"Unable to estimate memory usage. There are mapped fields for source index [{index}] that do not exist in any indexed documents. You will have to switch to the JSON editor for explicit field selection and include only fields that exist in indexed documents.",values:{index:t}}):s={title:l.i18n.translate("xpack.ml.dataframe.analytics.create.unableToFetchExplainDataMessage",{defaultMessage:"An error occurred fetching analysis fields data."}),text:e},{maxDistinctValuesErrorMessage:a,unsupportedFieldsErrorMessage:r,toastNotificationDanger:s,toastNotificationWarning:i}};var ee=n(17);const te=l.i18n.translate("xpack.ml.dataframe.analytics.creation.continueButtonText",{defaultMessage:"Continue"}),ne=({isDisabled:e,onClick:t})=>Object(b.jsx)(o.EuiFlexGroup,null,Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiButton,{"data-test-subj":"mlAnalyticsCreateJobWizardContinueButton",isDisabled:e,size:"s",onClick:t},te))),ae={[T.b.OUTLIER_DETECTION]:{helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionHelpText",{defaultMessage:"Identify unusual data points in the data set."}),icon:"outlierDetectionJob",title:l.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionTitle",{defaultMessage:"Outlier detection"})},[T.b.REGRESSION]:{helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.regressionHelpText",{defaultMessage:"Predict numerical values in the data set."}),icon:"regressionJob",title:l.i18n.translate("xpack.ml.dataframe.analytics.create.regressionTitle",{defaultMessage:"Regression"})},[T.b.CLASSIFICATION]:{helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.classificationHelpText",{defaultMessage:"Predict classes of data points in the data set."}),icon:"classificationJob",title:l.i18n.translate("xpack.ml.dataframe.analytics.create.classificationTitle",{defaultMessage:"Classification"})}},re=({type:e,setFormState:t})=>{const[n,a]=Object(i.useState)({});return Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{gutterSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardJobTypeSelect"},Object.keys(ae).map((r=>Object(b.jsx)(o.EuiFlexItem,{key:r,grow:1},Object(b.jsx)(o.EuiCard,{icon:Object(b.jsx)(o.EuiIcon,{size:"xl",type:ae[r].icon}),title:ae[r].title,description:ae[r].helpText,"data-test-subj":`mlAnalyticsCreation-${r}-option${e===r?" selectedJobType":""}`,selectable:{onClick:()=>{!0!==n[r]&&(t({previousJobType:e,jobType:r,requiredFieldsError:void 0}),a({[r]:!n[r]}))},isSelected:!0===n[r]||e===r}}))))),Object(b.jsx)(o.EuiSpacer,{size:"m"}))};var ie=n(520);const se={[T.b.CLASSIFICATION]:({name:e,type:t})=>!ie.c.includes(e)&&e!==Q.a&&(Y.a.has(t)||X.has(t)||t===G.a.BOOLEAN),[T.b.REGRESSION]:({name:e,type:t})=>!ie.c.includes(e)&&e!==Q.a&&(Y.a.has(t)||Y.c.has(t)),[T.b.OUTLIER_DETECTION]:({name:e,type:t})=>!ie.c.includes(e)&&e!==Q.a&&(Y.a.has(t)||Y.c.has(t))},oe={[T.b.CLASSIFICATION]:Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectClassificationHelpText",defaultMessage:"This data view does not contain any supported fields. Classification jobs require categorical, numeric, or boolean fields."}),[T.b.REGRESSION]:Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectRegressionHelpText",defaultMessage:"This data view does not contain any supported fields. Regression jobs require numeric fields."}),[T.b.OUTLIER_DETECTION]:Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectHelpText",defaultMessage:"This data view does not contain any numeric type fields. The analytics job may not be able to come up with any outliers."})},le=({jobType:e})=>{const[t,n]=Object(i.useState)(!0),[a,r]=Object(i.useState)(!1),{fields:s}=U.a;return Object(i.useEffect)((()=>{void 0!==e&&(()=>{if(s&&void 0!==e)try{const t=s.some(se[e]);n(t),r(!1)}catch(e){r(!0)}})()}),[e]),!0===t?null:!0===a?Object(b.jsx)(i.Fragment,null,Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceIndexFieldsCheckError",defaultMessage:"There was a problem checking for supported fields for job type. Please refresh the page and try again."}),Object(b.jsx)(o.EuiSpacer,{size:"s"})):Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiText,{size:"xs",color:"danger"},void 0!==e&&oe[e]),Object(b.jsx)(o.EuiSpacer,{size:"s"}))};var ce=n(157),ue=n(226),de=n(411);const me=l.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.minimumFieldsMessage",{defaultMessage:"At least one field must be selected."}),pe=e=>!0===e.is_required||e.reason&&e.reason.includes("unsupported type"),fe=s.a.memo((({dependentVariable:e,includes:t,isJobTypeWithDepVar:n,setFormState:a,minimumFieldsRequiredMessage:r,setMinimumFieldsRequiredMessage:u,tableItems:d,unsupportedFieldsError:m,setUnsupportedFieldsError:p})=>{const[f,h]=Object(i.useState)(),[g,j]=Object(i.useState)({pageIndex:0,itemsPerPage:5}),{handleFieldStatsButtonClick:x}=Object(ce.a)(),w=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.fieldNameColumn",{defaultMessage:"Field name"}),id:"name",render:({name:e,mapping_types:t})=>{const n={id:e,type:Array.isArray(t)&&t.length>0?t[0]:"number"};return Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(ue.a,{field:n,label:e,onButtonClick:x}))},isSortable:!0,alignment:o.LEFT_ALIGNMENT},{id:"mapping_types",label:l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.mappingColumn",{defaultMessage:"Mapping"}),isSortable:!1,alignment:o.LEFT_ALIGNMENT},{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isIncludedColumn",{defaultMessage:"Is included"}),id:"is_included",alignment:o.LEFT_ALIGNMENT,isSortable:!0,render:({is_included:e})=>e?"Yes":"No"},{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isRequiredColumn",{defaultMessage:"Is required"}),id:"is_required",alignment:o.LEFT_ALIGNMENT,isSortable:!0,render:({is_required:e})=>e?"Yes":"No"},{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.reasonColumn",{defaultMessage:"Reason"}),id:"reason",alignment:o.LEFT_ALIGNMENT,isSortable:!1}];Object(i.useEffect)((()=>{if(0===t.length&&d.length>0){const e=[];d.forEach((t=>{!0===t.is_included&&e.push(t.name)})),a({includes:e})}else t.length>0&&a({includes:e&&t.includes(e)||!n?t:[...t,e]});u(void 0)}),[d]),Object(i.useEffect)((()=>{let e=[];e=[{name:"name",getValue:e=>e.name.toLowerCase(),isAscending:!0},{name:"is_included",getValue:e=>e.is_included,isAscending:!0},{name:"is_required",getValue:e=>e.is_required,isAscending:!0}];const t=new o.SortableProperties(e,"name");h(t)}),[]);const y=[{type:"field_value_toggle_group",field:"is_included",items:[{value:!0,name:l.i18n.translate("xpack.ml.dataframe.analytics.create.isIncludedOption",{defaultMessage:"Is included"})},{value:!1,name:l.i18n.translate("xpack.ml.dataframe.analytics.create.isNotIncludedOption",{defaultMessage:"Is not included"})}]}];return Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardIncludesTable",label:l.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsLabel",{defaultMessage:"Included fields"}),fullWidth:!0,isInvalid:void 0!==r||void 0!==m,error:[...void 0!==r?[r]:[],...void 0!==m?[l.i18n.translate("xpack.ml.dataframe.analytics.create.unsupportedFieldsError",{defaultMessage:"Invalid. {message}",values:{message:m}})]:[]]},Object(b.jsx)(i.Fragment,null)),d.length>0&&void 0===r&&Object(b.jsx)(o.EuiText,{size:"xs"},l.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsCount",{defaultMessage:"{numFields, plural, one {# field} other {# fields}} included in the analysis",values:{numFields:t.length}})),0===d.length&&Object(b.jsx)(o.EuiCallOut,{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.calloutTitle",{defaultMessage:"Analysis fields not available"})},Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.calloutMessage",defaultMessage:"Additional data required to load analysis fields."})),d.length>0&&Object(b.jsx)(o.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardIncludesSelect"},Object(b.jsx)(de.a,{currentPage:g.pageIndex,"data-test-subj":"mlAnalyticsCreationAnalysisFieldsTable",checkboxDisabledCheck:pe,columns:w,filters:y,items:d,itemsPerPage:g.itemsPerPage,onTableChange:t=>{n&&void 0!==e&&""!==e&&0===t.length&&(t=[e]),0===t.length?(u(me),p(void 0)):(u(void 0),a({includes:t}))},selectedIds:t,setCurrentPaginationData:j,singleSelection:!1,sortableProperties:f,tableItemId:"name"})),Object(b.jsx)(o.EuiSpacer,null))}),((e,t)=>e.dependentVariable===t.dependentVariable&&Object(p.isEqual)(e.includes,t.includes)&&Object(p.isEqual)(e.tableItems,t.tableItems)&&e.unsupportedFieldsError===t.unsupportedFieldsError));var he=n(840),ge=n(37),be=n(229),je=n(885),xe=n(757),we=n(407);function ye(e){return Object.keys(e).map((t=>{let n=e[t];Array.isArray(n)&&(n=n[0]);const a=Object(be.g)(n.type);return{id:t,schema:a,isExpandable:"boolean"!==a,isRuntimeFieldColumn:!0}}))}function ve(e,t){const{fields:n}=e;return n.filter((e=>t.includes(e.name))).map((e=>{const t=Object(be.g)(e.type)||Object(be.h)(e);return{id:e.name,schema:t,isExpandable:"boolean"!==t,isRuntimeFieldColumn:!1}}))}var Oe=n(405),Ee=n(75);var Ie=n(316),ke=n(308),Te=n.n(ke);const{TextHighlightRules:Se}=Te.a.acequire("ace/mode/text_highlight_rules"),_e=Te.a.acequire("ace/lib/oop"),Me=function(){const e=this.createKeywordMapper({keyword:["describe|between|in|like|not|and|or|desc|select|from|where|having|group|by|orderasc|desc|pivot|for|in|as|show|columns|include|frozen|tables|escape|limit|rlike|all|distinct|is","avg|count|first|first_value|last|last_value|max|min|sum|kurtosis|mad|percentile|percentile_rank|skewness|stddev_pop|sum_of_squares|var_pop|histogram|case|coalesce|greatest|ifnull|iif|isnull|least|nullif|nvl|curdate|current_date|current_time|current_timestamp|curtime|dateadd|datediff|datepart|datetrunc|date_add|date_diff|date_part|date_trunc|day|dayname|dayofmonth|dayofweek|dayofyear|day_name|day_of_month|day_of_week|day_of_year|dom|dow|doy|hour|hour_of_day|idow|isodayofweek|isodow|isoweek|isoweekofyear|iso_day_of_week|iso_week_of_year|iw|iwoy|minute|minute_of_day|minute_of_hour|month|monthname|month_name|month_of_year|now|quarter|second|second_of_minute|timestampadd|timestampdiff|timestamp_add|timestamp_diff|today|week|week_of_year|year|abs|acos|asin|atan|atan2|cbrt|ceil|ceiling|cos|cosh|cot|degrees|e|exp|expm1|floor|log|log10|mod|pi|power|radians|rand|random|round|sign|signum|sin|sinh|sqrt|tan|truncate|ascii|bit_length|char|character_length|char_length|concat|insert|lcase|left|length|locate|ltrim|octet_length|position|repeat|replace|right|rtrim|space|substring|ucase|cast|convert|database|user|st_astext|st_aswkt|st_distance|st_geometrytype|st_geomfromtext|st_wkttosql|st_x|st_y|st_z|score","true|false","null|boolean|byte|short|integer|long|double|float|half_float|scaled_float|keyword|text|binary|date|ip|object|nested|time|interval_year|interval_month|interval_day|interval_hour|interval_minute|interval_second|interval_year_to_monthinteval_day_to_hour|interval_day_to_minute|interval_day_to_second|interval_hour_to_minute|interval_hour_to_secondinterval_minute_to_second|geo_point|geo_shape|shape"].join("|")},"identifier",!0);this.$rules={start:[{token:"comment",regex:"--.*$"},{token:"comment",start:"/\\*",end:"\\*/"},{token:"string",regex:'".*?"'},{token:"constant",regex:"'.*?'"},{token:"string",regex:"`.*?`"},{token:"entity.name.function",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:e,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"⇐|<⇒|\\*|\\.|\\:\\:|\\+|\\-|\\/|\\/\\/|%|&|\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\(]"},{token:"paren.rparen",regex:"[\\)]"},{token:"text",regex:"\\s+"}]},this.normalizeRules()};_e.inherits(Me,Se);const Ce=Te.a.acequire("ace/lib/oop"),{TextHighlightRules:Re}=Te.a.acequire("ace/mode/text_highlight_rules"),Fe="def|int|long|byte|String|float|double|char|null|if|else|while|do|for|continue|break|new|try|catch|throw|this|instanceof|return|ctx";function Ae(){this.name="ScriptHighlightRules",this.$rules={start:[{token:"script.comment",regex:"\\/\\/.*$"},{token:"script.string.regexp",regex:"[/](?:(?:\\[(?:\\\\]|[^\\]])+\\])|(?:\\\\/|[^\\]/]))*[/]\\w*\\s*(?=[).,;]|$)"},{token:"script.string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"script.constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"script.constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"script.constant.language.boolean",regex:"(?:true|false)\\b"},{token:"script.keyword",regex:Fe},{token:"script.text",regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"script.keyword.operator",regex:"\\?\\.|\\*\\.|=~|==~|!|%|&|\\*|\\-\\-|\\-|\\+\\+|\\+|~|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|->|!|&&|\\|\\||\\?\\:|\\*=|%=|\\+=|\\-=|&=|\\^=|\\b(?:in|instanceof|new|typeof|void)"},{token:"script.lparen",regex:"[[({]"},{token:"script.rparen",regex:"[\\])}]"},{token:"script.text",regex:"\\s+"}]}}Ce.inherits(Ae,Re),n(765);const{JsonHighlightRules:Le}=Te.a.acequire("ace/mode/json_highlight_rules"),Ne=Te.a.acequire("ace/lib/oop"),De=function(e){const t={},n=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("(?:[^"]*_)?script"|"inline"|"source")(\\s*?)(:)(\\s*?)(""")',next:"script-start",merge:!1,push:!0},{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"punctuation.start_triple_quote",regex:'"""',next:"string_literal",merge:!1,push:!0},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"invalid.illegal",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"invalid.illegal",regex:"\\/\\/.*$"},{token:"paren.lparen",merge:!1,regex:"{",next:e=e||"json",push:!0},{token:"paren.lparen",merge:!1,regex:"[[(]"},{token:"paren.rparen",merge:!1,regex:"[\\])]"},{token:"paren.rparen",regex:"}",merge:!1,next:"pop"},{token:"punctuation.comma",regex:","},{token:"punctuation.colon",regex:":"},{token:"whitespace",regex:"\\s+"},{token:"text",regex:".+?"}];return t[e]=n,t[e+"-sql"]=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("query")(\\s*?)(:)(\\s*?)(""")',next:"sql-start",merge:!1,push:!0}].concat(n),t.string_literal=[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"},{token:"multi_string",regex:"."}],t};function Pe(){this.$rules={...De("start")},this.embedRules(Ae,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]),this.embedRules(Me,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])}Ne.inherits(Pe,Le);const ze={id:"ace/mode/json_worker",src:'/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\n\n/* @notice\n *\n * This product includes code that is based on Ace editor, which was available\n * under a "BSD" license.\n *\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable prettier/prettier,no-var,eqeqeq,no-use-before-define,block-scoped-var,no-undef,\n    guard-for-in,one-var,strict,no-redeclare,no-sequences,no-proto,new-cap,no-nested-ternary,no-unused-vars,\n    prefer-const,no-empty,no-extend-native,camelcase */\n/*\n  This file is loaded up as a blob by Brace to hand to Ace to load as Jsonp\n  (hence the redefining of everything).  It is based on the json\n  mode from the brace distro.\n\n  It is very likely that this file will be removed in future but for now it enables\n  extended JSON parsing, like e.g. """{}""" (triple quotes)\n*/\n// @internal\n// @ts-nocheck\n"no use strict";\n! function(window) {\n  function resolveModuleId(id, paths) {\n    for (var testPath = id, tail = ""; testPath;) {\n      var alias = paths[testPath];\n      if ("string" == typeof alias) return alias + tail;\n      if (alias) return alias.location.replace(/\\/*$/, "/") + (tail || alias.main || alias.name);\n      if (alias === !1) return "";\n      var i = testPath.lastIndexOf("/");\n      if (-1 === i) break;\n      tail = testPath.substr(i) + tail, testPath = testPath.slice(0, i)\n    }\n    return id\n  }\n  if (!(void 0 !== window.window && window.document || window.acequire && window.define)) {\n    window.console || (window.console = function() {\n      var msgs = Array.prototype.slice.call(arguments, 0);\n      postMessage({\n        type: "log",\n        data: msgs\n      })\n    }, window.console.error = window.console.warn = window.console.log = window.console.trace = window.console), window.window = window, window.ace = window, window.onerror = function(message, file, line, col, err) {\n      postMessage({\n        type: "error",\n        data: {\n          message: message,\n          data: err.data,\n          file: file,\n          line: line,\n          col: col,\n          stack: err.stack\n        }\n      })\n    }, window.normalizeModule = function(parentId, moduleName) {\n      if (-1 !== moduleName.indexOf("!")) {\n        var chunks = moduleName.split("!");\n        return window.normalizeModule(parentId, chunks[0]) + "!" + window.normalizeModule(parentId, chunks[1])\n      }\n      if ("." == moduleName.charAt(0)) {\n        var base = parentId.split("/").slice(0, -1).join("/");\n        for (moduleName = (base ? base + "/" : "") + moduleName; - 1 !== moduleName.indexOf(".") && previous != moduleName;) {\n          var previous = moduleName;\n          moduleName = moduleName.replace(/^\\.\\//, "").replace(/\\/\\.\\//, "/").replace(/[^\\/]+\\/\\.\\.\\//, "")\n        }\n      }\n      return moduleName\n    }, window.acequire = function acequire(parentId, id) {\n      if (id || (id = parentId, parentId = null), !id.charAt) throw Error("worker.js acequire() accepts only (parentId, id) as arguments");\n      id = window.normalizeModule(parentId, id);\n      var module = window.acequire.modules[id];\n      if (module) return module.initialized || (module.initialized = !0, module.exports = module.factory().exports), module.exports;\n      if (!window.acequire.tlns) return console.log("unable to load " + id);\n      var path = resolveModuleId(id, window.acequire.tlns);\n      return ".js" != path.slice(-3) && (path += ".js"), window.acequire.id = id, window.acequire.modules[id] = {}, importScripts(path), window.acequire(parentId, id)\n    }, window.acequire.modules = {}, window.acequire.tlns = {}, window.define = function(id, deps, factory) {\n      if (2 == arguments.length ? (factory = deps, "string" != typeof id && (deps = id, id = window.acequire.id)) : 1 == arguments.length && (factory = id, deps = [], id = window.acequire.id), "function" != typeof factory) return window.acequire.modules[id] = {\n        exports: factory,\n        initialized: !0\n      }, void 0;\n      deps.length || (deps = ["require", "exports", "module"]);\n      var req = function(childId) {\n        return window.acequire(id, childId)\n      };\n      window.acequire.modules[id] = {\n        exports: {},\n        factory: function() {\n          var module = this,\n            returnExports = factory.apply(this, deps.map(function(dep) {\n              switch (dep) {\n                case "require":\n                  return req;\n                case "exports":\n                  return module.exports;\n                case "module":\n                  return module;\n                default:\n                  return req(dep)\n              }\n            }));\n          return returnExports && (module.exports = returnExports), module\n        }\n      }\n    }, window.define.amd = {}, acequire.tlns = {}, window.initBaseUrls = function(topLevelNamespaces) {\n      for (var i in topLevelNamespaces) acequire.tlns[i] = topLevelNamespaces[i]\n    }, window.initSender = function() {\n      var EventEmitter = window.acequire("ace/lib/event_emitter").EventEmitter,\n        oop = window.acequire("ace/lib/oop"),\n        Sender = function() {};\n      return function() {\n        oop.implement(this, EventEmitter), this.callback = function(data, callbackId) {\n          postMessage({\n            type: "call",\n            id: callbackId,\n            data: data\n          })\n        }, this.emit = function(name, data) {\n          postMessage({\n            type: "event",\n            name: name,\n            data: data\n          })\n        }\n      }.call(Sender.prototype), new Sender\n    };\n    var main = window.main = null,\n      sender = window.sender = null;\n    window.onmessage = function(e) {\n      var msg = e.data;\n      if (msg.event && sender) sender._signal(msg.event, msg.data);\n      else if (msg.command)\n        if (main[msg.command]) main[msg.command].apply(main, msg.args);\n        else {\n          if (!window[msg.command]) throw Error("Unknown command:" + msg.command);\n          window[msg.command].apply(window, msg.args)\n        }\n      else if (msg.init) {\n        window.initBaseUrls(msg.tlns), acequire("ace/lib/es5-shim"), sender = window.sender = window.initSender();\n        var clazz = acequire(msg.module)[msg.classname];\n        main = window.main = new clazz(sender)\n      }\n    }\n  }\n}(this), ace.define("ace/lib/oop", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.inherits = function(ctor, superCtor) {\n    ctor.super_ = superCtor, ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    })\n  }, exports.mixin = function(obj, mixin) {\n    for (var key in mixin) obj[key] = mixin[key];\n    return obj\n  }, exports.implement = function(proto, mixin) {\n    exports.mixin(proto, mixin)\n  }\n}), ace.define("ace/range", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var comparePoints = function(p1, p2) {\n      return p1.row - p2.row || p1.column - p2.column\n    },\n    Range = function(startRow, startColumn, endRow, endColumn) {\n      this.start = {\n        row: startRow,\n        column: startColumn\n      }, this.end = {\n        row: endRow,\n        column: endColumn\n      }\n    };\n  (function() {\n    this.isEqual = function(range) {\n      return this.start.row === range.start.row && this.end.row === range.end.row && this.start.column === range.start.column && this.end.column === range.end.column\n    }, this.toString = function() {\n      return "Range: [" + this.start.row + "/" + this.start.column + "] -> [" + this.end.row + "/" + this.end.column + "]"\n    }, this.contains = function(row, column) {\n      return 0 == this.compare(row, column)\n    }, this.compareRange = function(range) {\n      var cmp, end = range.end,\n        start = range.start;\n      return cmp = this.compare(end.row, end.column), 1 == cmp ? (cmp = this.compare(start.row, start.column), 1 == cmp ? 2 : 0 == cmp ? 1 : 0) : -1 == cmp ? -2 : (cmp = this.compare(start.row, start.column), -1 == cmp ? -1 : 1 == cmp ? 42 : 0)\n    }, this.comparePoint = function(p) {\n      return this.compare(p.row, p.column)\n    }, this.containsRange = function(range) {\n      return 0 == this.comparePoint(range.start) && 0 == this.comparePoint(range.end)\n    }, this.intersects = function(range) {\n      var cmp = this.compareRange(range);\n      return -1 == cmp || 0 == cmp || 1 == cmp\n    }, this.isEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column\n    }, this.isStart = function(row, column) {\n      return this.start.row == row && this.start.column == column\n    }, this.setStart = function(row, column) {\n      "object" == typeof row ? (this.start.column = row.column, this.start.row = row.row) : (this.start.row = row, this.start.column = column)\n    }, this.setEnd = function(row, column) {\n      "object" == typeof row ? (this.end.column = row.column, this.end.row = row.row) : (this.end.row = row, this.end.column = column)\n    }, this.inside = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) || this.isStart(row, column) ? !1 : !0 : !1\n    }, this.insideStart = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) ? !1 : !0 : !1\n    }, this.insideEnd = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isStart(row, column) ? !1 : !0 : !1\n    }, this.compare = function(row, column) {\n      return this.isMultiLine() || row !== this.start.row ? this.start.row > row ? -1 : row > this.end.row ? 1 : this.start.row === row ? column >= this.start.column ? 0 : -1 : this.end.row === row ? this.end.column >= column ? 0 : 1 : 0 : this.start.column > column ? -1 : column > this.end.column ? 1 : 0\n    }, this.compareStart = function(row, column) {\n      return this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.compareEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.compare(row, column)\n    }, this.compareInside = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.clipRows = function(firstRow, lastRow) {\n      if (this.end.row > lastRow) var end = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.end.row) var end = {\n        row: firstRow,\n        column: 0\n      };\n      if (this.start.row > lastRow) var start = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.start.row) var start = {\n        row: firstRow,\n        column: 0\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.extend = function(row, column) {\n      var cmp = this.compare(row, column);\n      if (0 == cmp) return this;\n      if (-1 == cmp) var start = {\n        row: row,\n        column: column\n      };\n      else var end = {\n        row: row,\n        column: column\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.isEmpty = function() {\n      return this.start.row === this.end.row && this.start.column === this.end.column\n    }, this.isMultiLine = function() {\n      return this.start.row !== this.end.row\n    }, this.clone = function() {\n      return Range.fromPoints(this.start, this.end)\n    }, this.collapseRows = function() {\n      return 0 == this.end.column ? new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0) : new Range(this.start.row, 0, this.end.row, 0)\n    }, this.toScreenRange = function(session) {\n      var screenPosStart = session.documentToScreenPosition(this.start),\n        screenPosEnd = session.documentToScreenPosition(this.end);\n      return new Range(screenPosStart.row, screenPosStart.column, screenPosEnd.row, screenPosEnd.column)\n    }, this.moveBy = function(row, column) {\n      this.start.row += row, this.start.column += column, this.end.row += row, this.end.column += column\n    }\n  }).call(Range.prototype), Range.fromPoints = function(start, end) {\n    return new Range(start.row, start.column, end.row, end.column)\n  }, Range.comparePoints = comparePoints, Range.comparePoints = function(p1, p2) {\n    return p1.row - p2.row || p1.column - p2.column\n  }, exports.Range = Range\n}), ace.define("ace/apply_delta", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.applyDelta = function(docLines, delta) {\n    var row = delta.start.row,\n      startColumn = delta.start.column,\n      line = docLines[row] || "";\n    switch (delta.action) {\n      case "insert":\n        var lines = delta.lines;\n        if (1 === lines.length) docLines[row] = line.substring(0, startColumn) + delta.lines[0] + line.substring(startColumn);\n        else {\n          var args = [row, 1].concat(delta.lines);\n          docLines.splice.apply(docLines, args), docLines[row] = line.substring(0, startColumn) + docLines[row], docLines[row + delta.lines.length - 1] += line.substring(startColumn)\n        }\n        break;\n      case "remove":\n        var endColumn = delta.end.column,\n          endRow = delta.end.row;\n        row === endRow ? docLines[row] = line.substring(0, startColumn) + line.substring(endColumn) : docLines.splice(row, endRow - row + 1, line.substring(0, startColumn) + docLines[endRow].substring(endColumn))\n    }\n  }\n}), ace.define("ace/lib/event_emitter", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var EventEmitter = {},\n    stopPropagation = function() {\n      this.propagationStopped = !0\n    },\n    preventDefault = function() {\n      this.defaultPrevented = !0\n    };\n  EventEmitter._emit = EventEmitter._dispatchEvent = function(eventName, e) {\n    this._eventRegistry || (this._eventRegistry = {}), this._defaultHandlers || (this._defaultHandlers = {});\n    var listeners = this._eventRegistry[eventName] || [],\n      defaultHandler = this._defaultHandlers[eventName];\n    if (listeners.length || defaultHandler) {\n      "object" == typeof e && e || (e = {}), e.type || (e.type = eventName), e.stopPropagation || (e.stopPropagation = stopPropagation), e.preventDefault || (e.preventDefault = preventDefault), listeners = listeners.slice();\n      for (var i = 0; listeners.length > i && (listeners[i](e, this), !e.propagationStopped); i++);\n      return defaultHandler && !e.defaultPrevented ? defaultHandler(e, this) : void 0\n    }\n  }, EventEmitter._signal = function(eventName, e) {\n    var listeners = (this._eventRegistry || {})[eventName];\n    if (listeners) {\n      listeners = listeners.slice();\n      for (var i = 0; listeners.length > i; i++) listeners[i](e, this)\n    }\n  }, EventEmitter.once = function(eventName, callback) {\n    var _self = this;\n    callback && this.addEventListener(eventName, function newCallback() {\n      _self.removeEventListener(eventName, newCallback), callback.apply(null, arguments)\n    })\n  }, EventEmitter.setDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers || (handlers = this._defaultHandlers = {\n        _disabled_: {}\n      }), handlers[eventName]) {\n      var old = handlers[eventName],\n        disabled = handlers._disabled_[eventName];\n      disabled || (handlers._disabled_[eventName] = disabled = []), disabled.push(old);\n      var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n    }\n    handlers[eventName] = callback\n  }, EventEmitter.removeDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers) {\n      var disabled = handlers._disabled_[eventName];\n      if (handlers[eventName] == callback) handlers[eventName], disabled && this.setDefaultHandler(eventName, disabled.pop());\n      else if (disabled) {\n        var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n      }\n    }\n  }, EventEmitter.on = EventEmitter.addEventListener = function(eventName, callback, capturing) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    return listeners || (listeners = this._eventRegistry[eventName] = []), -1 == listeners.indexOf(callback) && listeners[capturing ? "unshift" : "push"](callback), callback\n  }, EventEmitter.off = EventEmitter.removeListener = EventEmitter.removeEventListener = function(eventName, callback) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    if (listeners) {\n      var index = listeners.indexOf(callback); - 1 !== index && listeners.splice(index, 1)\n    }\n  }, EventEmitter.removeAllListeners = function(eventName) {\n    this._eventRegistry && (this._eventRegistry[eventName] = [])\n  }, exports.EventEmitter = EventEmitter\n}), ace.define("ace/anchor", ["require", "exports", "module", "ace/lib/oop", "ace/lib/event_emitter"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Anchor = exports.Anchor = function(doc, row, column) {\n      this.$onChange = this.onChange.bind(this), this.attach(doc), column === void 0 ? this.setPosition(row.row, row.column) : this.setPosition(row, column)\n    };\n  (function() {\n    function $pointsInOrder(point1, point2, equalPointsInOrder) {\n      var bColIsAfter = equalPointsInOrder ? point1.column <= point2.column : point1.column < point2.column;\n      return point1.row < point2.row || point1.row == point2.row && bColIsAfter\n    }\n\n    function $getTransformedPoint(delta, point, moveIfEqual) {\n      var deltaIsInsert = "insert" == delta.action,\n        deltaRowShift = (deltaIsInsert ? 1 : -1) * (delta.end.row - delta.start.row),\n        deltaColShift = (deltaIsInsert ? 1 : -1) * (delta.end.column - delta.start.column),\n        deltaStart = delta.start,\n        deltaEnd = deltaIsInsert ? deltaStart : delta.end;\n      return $pointsInOrder(point, deltaStart, moveIfEqual) ? {\n        row: point.row,\n        column: point.column\n      } : $pointsInOrder(deltaEnd, point, !moveIfEqual) ? {\n        row: point.row + deltaRowShift,\n        column: point.column + (point.row == deltaEnd.row ? deltaColShift : 0)\n      } : {\n        row: deltaStart.row,\n        column: deltaStart.column\n      }\n    }\n    oop.implement(this, EventEmitter), this.getPosition = function() {\n      return this.$clipPositionToDocument(this.row, this.column)\n    }, this.getDocument = function() {\n      return this.document\n    }, this.$insertRight = !1, this.onChange = function(delta) {\n      if (!(delta.start.row == delta.end.row && delta.start.row != this.row || delta.start.row > this.row)) {\n        var point = $getTransformedPoint(delta, {\n          row: this.row,\n          column: this.column\n        }, this.$insertRight);\n        this.setPosition(point.row, point.column, !0)\n      }\n    }, this.setPosition = function(row, column, noClip) {\n      var pos;\n      if (pos = noClip ? {\n          row: row,\n          column: column\n        } : this.$clipPositionToDocument(row, column), this.row != pos.row || this.column != pos.column) {\n        var old = {\n          row: this.row,\n          column: this.column\n        };\n        this.row = pos.row, this.column = pos.column, this._signal("change", {\n          old: old,\n          value: pos\n        })\n      }\n    }, this.detach = function() {\n      this.document.removeEventListener("change", this.$onChange)\n    }, this.attach = function(doc) {\n      this.document = doc || this.document, this.document.on("change", this.$onChange)\n    }, this.$clipPositionToDocument = function(row, column) {\n      var pos = {};\n      return row >= this.document.getLength() ? (pos.row = Math.max(0, this.document.getLength() - 1), pos.column = this.document.getLine(pos.row).length) : 0 > row ? (pos.row = 0, pos.column = 0) : (pos.row = row, pos.column = Math.min(this.document.getLine(pos.row).length, Math.max(0, column))), 0 > column && (pos.column = 0), pos\n    }\n  }).call(Anchor.prototype)\n}), ace.define("ace/document", ["require", "exports", "module", "ace/lib/oop", "ace/apply_delta", "ace/lib/event_emitter", "ace/range", "ace/anchor"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    applyDelta = acequire("./apply_delta").applyDelta,\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Range = acequire("./range").Range,\n    Anchor = acequire("./anchor").Anchor,\n    Document = function(textOrLines) {\n      this.$lines = [""], 0 === textOrLines.length ? this.$lines = [""] : Array.isArray(textOrLines) ? this.insertMergedLines({\n        row: 0,\n        column: 0\n      }, textOrLines) : this.insert({\n        row: 0,\n        column: 0\n      }, textOrLines)\n    };\n  (function() {\n    oop.implement(this, EventEmitter), this.setValue = function(text) {\n      var len = this.getLength() - 1;\n      this.remove(new Range(0, 0, len, this.getLine(len).length)), this.insert({\n        row: 0,\n        column: 0\n      }, text)\n    }, this.getValue = function() {\n      return this.getAllLines().join(this.getNewLineCharacter())\n    }, this.createAnchor = function(row, column) {\n      return new Anchor(this, row, column)\n    }, this.$split = 0 === "aaa".split(/a/).length ? function(text) {\n      return text.replace(/\\r\\n|\\r/g, "\\n").split("\\n")\n    } : function(text) {\n      return text.split(/\\r\\n|\\r|\\n/)\n    }, this.$detectNewLine = function(text) {\n      var match = text.match(/^.*?(\\r\\n|\\r|\\n)/m);\n      this.$autoNewLine = match ? match[1] : "\\n", this._signal("changeNewLineMode")\n    }, this.getNewLineCharacter = function() {\n      switch (this.$newLineMode) {\n        case "windows":\n          return "\\r\\n";\n        case "unix":\n          return "\\n";\n        default:\n          return this.$autoNewLine || "\\n"\n      }\n    }, this.$autoNewLine = "", this.$newLineMode = "auto", this.setNewLineMode = function(newLineMode) {\n      this.$newLineMode !== newLineMode && (this.$newLineMode = newLineMode, this._signal("changeNewLineMode"))\n    }, this.getNewLineMode = function() {\n      return this.$newLineMode\n    }, this.isNewLine = function(text) {\n      return "\\r\\n" == text || "\\r" == text || "\\n" == text\n    }, this.getLine = function(row) {\n      return this.$lines[row] || ""\n    }, this.getLines = function(firstRow, lastRow) {\n      return this.$lines.slice(firstRow, lastRow + 1)\n    }, this.getAllLines = function() {\n      return this.getLines(0, this.getLength())\n    }, this.getLength = function() {\n      return this.$lines.length\n    }, this.getTextRange = function(range) {\n      return this.getLinesForRange(range).join(this.getNewLineCharacter())\n    }, this.getLinesForRange = function(range) {\n      var lines;\n      if (range.start.row === range.end.row) lines = [this.getLine(range.start.row).substring(range.start.column, range.end.column)];\n      else {\n        lines = this.getLines(range.start.row, range.end.row), lines[0] = (lines[0] || "").substring(range.start.column);\n        var l = lines.length - 1;\n        range.end.row - range.start.row == l && (lines[l] = lines[l].substring(0, range.end.column))\n      }\n      return lines\n    }, this.insertLines = function(row, lines) {\n      return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."), this.insertFullLines(row, lines)\n    }, this.removeLines = function(firstRow, lastRow) {\n      return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."), this.removeFullLines(firstRow, lastRow)\n    }, this.insertNewLine = function(position) {\n      return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."), this.insertMergedLines(position, ["", ""])\n    }, this.insert = function(position, text) {\n      return 1 >= this.getLength() && this.$detectNewLine(text), this.insertMergedLines(position, this.$split(text))\n    }, this.insertInLine = function(position, text) {\n      var start = this.clippedPos(position.row, position.column),\n        end = this.pos(position.row, position.column + text.length);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: [text]\n      }, !0), this.clonePos(end)\n    }, this.clippedPos = function(row, column) {\n      var length = this.getLength();\n      void 0 === row ? row = length : 0 > row ? row = 0 : row >= length && (row = length - 1, column = void 0);\n      var line = this.getLine(row);\n      return void 0 == column && (column = line.length), column = Math.min(Math.max(column, 0), line.length), {\n        row: row,\n        column: column\n      }\n    }, this.clonePos = function(pos) {\n      return {\n        row: pos.row,\n        column: pos.column\n      }\n    }, this.pos = function(row, column) {\n      return {\n        row: row,\n        column: column\n      }\n    }, this.$clipPosition = function(position) {\n      var length = this.getLength();\n      return position.row >= length ? (position.row = Math.max(0, length - 1), position.column = this.getLine(length - 1).length) : (position.row = Math.max(0, position.row), position.column = Math.min(Math.max(position.column, 0), this.getLine(position.row).length)), position\n    }, this.insertFullLines = function(row, lines) {\n      row = Math.min(Math.max(row, 0), this.getLength());\n      var column = 0;\n      this.getLength() > row ? (lines = lines.concat([""]), column = 0) : (lines = [""].concat(lines), row--, column = this.$lines[row].length), this.insertMergedLines({\n        row: row,\n        column: column\n      }, lines)\n    }, this.insertMergedLines = function(position, lines) {\n      var start = this.clippedPos(position.row, position.column),\n        end = {\n          row: start.row + lines.length - 1,\n          column: (1 == lines.length ? start.column : 0) + lines[lines.length - 1].length\n        };\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: lines\n      }), this.clonePos(end)\n    }, this.remove = function(range) {\n      var start = this.clippedPos(range.start.row, range.start.column),\n        end = this.clippedPos(range.end.row, range.end.column);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }), this.clonePos(start)\n    }, this.removeInLine = function(row, startColumn, endColumn) {\n      var start = this.clippedPos(row, startColumn),\n        end = this.clippedPos(row, endColumn);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }, !0), this.clonePos(start)\n    }, this.removeFullLines = function(firstRow, lastRow) {\n      firstRow = Math.min(Math.max(0, firstRow), this.getLength() - 1), lastRow = Math.min(Math.max(0, lastRow), this.getLength() - 1);\n      var deleteFirstNewLine = lastRow == this.getLength() - 1 && firstRow > 0,\n        deleteLastNewLine = this.getLength() - 1 > lastRow,\n        startRow = deleteFirstNewLine ? firstRow - 1 : firstRow,\n        startCol = deleteFirstNewLine ? this.getLine(startRow).length : 0,\n        endRow = deleteLastNewLine ? lastRow + 1 : lastRow,\n        endCol = deleteLastNewLine ? 0 : this.getLine(endRow).length,\n        range = new Range(startRow, startCol, endRow, endCol),\n        deletedLines = this.$lines.slice(firstRow, lastRow + 1);\n      return this.applyDelta({\n        start: range.start,\n        end: range.end,\n        action: "remove",\n        lines: this.getLinesForRange(range)\n      }), deletedLines\n    }, this.removeNewLine = function(row) {\n      this.getLength() - 1 > row && row >= 0 && this.applyDelta({\n        start: this.pos(row, this.getLine(row).length),\n        end: this.pos(row + 1, 0),\n        action: "remove",\n        lines: ["", ""]\n      })\n    }, this.replace = function(range, text) {\n      if (range instanceof Range || (range = Range.fromPoints(range.start, range.end)), 0 === text.length && range.isEmpty()) return range.start;\n      if (text == this.getTextRange(range)) return range.end;\n      this.remove(range);\n      var end;\n      return end = text ? this.insert(range.start, text) : range.start\n    }, this.applyDeltas = function(deltas) {\n      for (var i = 0; deltas.length > i; i++) this.applyDelta(deltas[i])\n    }, this.revertDeltas = function(deltas) {\n      for (var i = deltas.length - 1; i >= 0; i--) this.revertDelta(deltas[i])\n    }, this.applyDelta = function(delta, doNotValidate) {\n      var isInsert = "insert" == delta.action;\n      (isInsert ? 1 >= delta.lines.length && !delta.lines[0] : !Range.comparePoints(delta.start, delta.end)) || (isInsert && delta.lines.length > 2e4 && this.$splitAndapplyLargeDelta(delta, 2e4), applyDelta(this.$lines, delta, doNotValidate), this._signal("change", delta))\n    }, this.$splitAndapplyLargeDelta = function(delta, MAX) {\n      for (var lines = delta.lines, l = lines.length, row = delta.start.row, column = delta.start.column, from = 0, to = 0;;) {\n        from = to, to += MAX - 1;\n        var chunk = lines.slice(from, to);\n        if (to > l) {\n          delta.lines = chunk, delta.start.row = row + from, delta.start.column = column;\n          break\n        }\n        chunk.push(""), this.applyDelta({\n          start: this.pos(row + from, column),\n          end: this.pos(row + to, column = 0),\n          action: delta.action,\n          lines: chunk\n        }, !0)\n      }\n    }, this.revertDelta = function(delta) {\n      this.applyDelta({\n        start: this.clonePos(delta.start),\n        end: this.clonePos(delta.end),\n        action: "insert" == delta.action ? "remove" : "insert",\n        lines: delta.lines.slice()\n      })\n    }, this.indexToPosition = function(index, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, i = startRow || 0, l = lines.length; l > i; i++)\n        if (index -= lines[i].length + newlineLength, 0 > index) return {\n          row: i,\n          column: index + lines[i].length + newlineLength\n        };\n      return {\n        row: l - 1,\n        column: lines[l - 1].length\n      }\n    }, this.positionToIndex = function(pos, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, index = 0, row = Math.min(pos.row, lines.length), i = startRow || 0; row > i; ++i) index += lines[i].length + newlineLength;\n      return index + pos.column\n    }\n  }).call(Document.prototype), exports.Document = Document\n}), ace.define("ace/lib/lang", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.last = function(a) {\n    return a[a.length - 1]\n  }, exports.stringReverse = function(string) {\n    return string.split("").reverse().join("")\n  }, exports.stringRepeat = function(string, count) {\n    for (var result = ""; count > 0;) 1 & count && (result += string), (count >>= 1) && (string += string);\n    return result\n  };\n  var trimBeginRegexp = /^\\s\\s*/,\n    trimEndRegexp = /\\s\\s*$/;\n  exports.stringTrimLeft = function(string) {\n    return string.replace(trimBeginRegexp, "")\n  }, exports.stringTrimRight = function(string) {\n    return string.replace(trimEndRegexp, "")\n  }, exports.copyObject = function(obj) {\n    var copy = {};\n    for (var key in obj) copy[key] = obj[key];\n    return copy\n  }, exports.copyArray = function(array) {\n    for (var copy = [], i = 0, l = array.length; l > i; i++) copy[i] = array[i] && "object" == typeof array[i] ? this.copyObject(array[i]) : array[i];\n    return copy\n  }, exports.deepCopy = function deepCopy(obj) {\n    if ("object" != typeof obj || !obj) return obj;\n    var copy;\n    if (Array.isArray(obj)) {\n      copy = [];\n      for (var key = 0; obj.length > key; key++) copy[key] = deepCopy(obj[key]);\n      return copy\n    }\n    if ("[object Object]" !== Object.prototype.toString.call(obj)) return obj;\n    copy = {};\n    for (var key in obj) copy[key] = deepCopy(obj[key]);\n    return copy\n  }, exports.arrayToMap = function(arr) {\n    for (var map = {}, i = 0; arr.length > i; i++) map[arr[i]] = 1;\n    return map\n  }, exports.createMap = function(props) {\n    var map = Object.create(null);\n    for (var i in props) map[i] = props[i];\n    return map\n  }, exports.arrayRemove = function(array, value) {\n    for (var i = 0; array.length >= i; i++) value === array[i] && array.splice(i, 1)\n  }, exports.escapeRegExp = function(str) {\n    return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g, "\\\\$1")\n  }, exports.escapeHTML = function(str) {\n    return str.replace(/&/g, "&#38;").replace(/"/g, "&#34;").replace(/\'/g, "&#39;").replace(/</g, "&#60;")\n  }, exports.getMatchOffsets = function(string, regExp) {\n    var matches = [];\n    return string.replace(regExp, function(str) {\n      matches.push({\n        offset: arguments[arguments.length - 2],\n        length: str.length\n      })\n    }), matches\n  }, exports.deferredCall = function(fcn) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      deferred = function(timeout) {\n        return deferred.cancel(), timer = setTimeout(callback, timeout || 0), deferred\n      };\n    return deferred.schedule = deferred, deferred.call = function() {\n      return this.cancel(), fcn(), deferred\n    }, deferred.cancel = function() {\n      return clearTimeout(timer), timer = null, deferred\n    }, deferred.isPending = function() {\n      return timer\n    }, deferred\n  }, exports.delayedCall = function(fcn, defaultTimeout) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      _self = function(timeout) {\n        null == timer && (timer = setTimeout(callback, timeout || defaultTimeout))\n      };\n    return _self.delay = function(timeout) {\n      timer && clearTimeout(timer), timer = setTimeout(callback, timeout || defaultTimeout)\n    }, _self.schedule = _self, _self.call = function() {\n      this.cancel(), fcn()\n    }, _self.cancel = function() {\n      timer && clearTimeout(timer), timer = null\n    }, _self.isPending = function() {\n      return timer\n    }, _self\n  }\n}), ace.define("ace/worker/mirror", ["require", "exports", "module", "ace/range", "ace/document", "ace/lib/lang"], function(acequire, exports) {\n  "use strict";\n  acequire("../range").Range;\n  var Document = acequire("../document").Document,\n    lang = acequire("../lib/lang"),\n    Mirror = exports.Mirror = function(sender) {\n      this.sender = sender;\n      var doc = this.doc = new Document(""),\n        deferredUpdate = this.deferredUpdate = lang.delayedCall(this.onUpdate.bind(this)),\n        _self = this;\n      sender.on("change", function(e) {\n        var data = e.data;\n        if (data[0].start) doc.applyDeltas(data);\n        else\n          for (var i = 0; data.length > i; i += 2) {\n            if (Array.isArray(data[i + 1])) var d = {\n              action: "insert",\n              start: data[i],\n              lines: data[i + 1]\n            };\n            else var d = {\n              action: "remove",\n              start: data[i],\n              end: data[i + 1]\n            };\n            doc.applyDelta(d, !0)\n          }\n        return _self.$timeout ? deferredUpdate.schedule(_self.$timeout) : (_self.onUpdate(), void 0)\n      })\n    };\n  (function() {\n    this.$timeout = 500, this.setTimeout = function(timeout) {\n      this.$timeout = timeout\n    }, this.setValue = function(value) {\n      this.doc.setValue(value), this.deferredUpdate.schedule(this.$timeout)\n    }, this.getValue = function(callbackId) {\n      this.sender.callback(this.doc.getValue(), callbackId)\n    }, this.onUpdate = function() {}, this.isPending = function() {\n      return this.deferredUpdate.isPending()\n    }\n  }).call(Mirror.prototype)\n}), ace.define("ace/mode/json/json_parse", ["require", "exports", "module"], function() {\n  "use strict";\n  var at, ch, text, value, escapee = {\n      \'"\': \'"\',\n      "\\\\": "\\\\",\n      "/": "/",\n      b: "\\b",\n      f: "\\f",\n      n: "\\n",\n      r: "\\r",\n      t: "\t"\n    },\n    error = function(m) {\n      throw {\n        name: "SyntaxError",\n        message: m,\n        at: at,\n        text: text\n      }\n    },\n    reset = function (newAt) {\n      ch = text.charAt(newAt);\n      at = newAt + 1;\n    },\n    next = function(c) {\n      return c && c !== ch && error("Expected \'" + c + "\' instead of \'" + ch + "\'"), ch = text.charAt(at), at += 1, ch\n    },\n    nextUpTo = function (upTo, errorMessage) {\n      let currentAt = at,\n        i = text.indexOf(upTo, currentAt);\n      if (i < 0) {\n        error(errorMessage || \'Expected \\\'\' + upTo + \'\\\'\');\n      }\n      reset(i + upTo.length);\n      return text.substring(currentAt, i);\n    },\n    peek = function (c) {\n      return text.substr(at, c.length) === c; // nocommit - double check\n    },\n    number = function() {\n      var number, string = "";\n      for ("-" === ch && (string = "-", next("-")); ch >= "0" && "9" >= ch;) string += ch, next();\n      if ("." === ch)\n        for (string += "."; next() && ch >= "0" && "9" >= ch;) string += ch;\n      if ("e" === ch || "E" === ch)\n        for (string += ch, next(), ("-" === ch || "+" === ch) && (string += ch, next()); ch >= "0" && "9" >= ch;) string += ch, next();\n      return number = +string, isNaN(number) ? (error("Bad number"), void 0) : number\n    },\n    string = function() {\n      var hex, i, uffff, string = "";\n      if (\'"\' === ch) {\n        if (peek(\'""\')) {\n          // literal\n          next(\'"\');\n          next(\'"\');\n          return nextUpTo(\'"""\', \'failed to find closing \\\'"""\\\'\');\n        } else {\n          for (; next();) {\n            if (\'"\' === ch) return next(), string;\n            if ("\\\\" === ch)\n              if (next(), "u" === ch) {\n                for (uffff = 0, i = 0; 4 > i && (hex = parseInt(next(), 16), isFinite(hex)); i += 1) uffff = 16 * uffff + hex;\n                string += String.fromCharCode(uffff)\n              } else {\n                if ("string" != typeof escapee[ch]) break;\n                string += escapee[ch]\n              }\n            else string += ch\n          }\n        }\n      }\n      error("Bad string")\n    },\n    white = function() {\n      for (; ch && " " >= ch;) next()\n    },\n    word = function() {\n      switch (ch) {\n        case "t":\n          return next("t"), next("r"), next("u"), next("e"), !0;\n        case "f":\n          return next("f"), next("a"), next("l"), next("s"), next("e"), !1;\n        case "n":\n          return next("n"), next("u"), next("l"), next("l"), null\n      }\n      error("Unexpected \'" + ch + "\'")\n    },\n    array = function() {\n      var array = [];\n      if ("[" === ch) {\n        if (next("["), white(), "]" === ch) return next("]"), array;\n        for (; ch;) {\n          if (array.push(value()), white(), "]" === ch) return next("]"), array;\n          next(","), white()\n        }\n      }\n      error("Bad array")\n    },\n    object = function() {\n      var key, object = {};\n      if ("{" === ch) {\n        if (next("{"), white(), "}" === ch) return next("}"), object;\n        for (; ch;) {\n          if (key = string(), white(), next(":"), Object.hasOwnProperty.call(object, key) && error(\'Duplicate key "\' + key + \'"\'), object[key] = value(), white(), "}" === ch) return next("}"), object;\n          next(","), white()\n        }\n      }\n      error("Bad object")\n    };\n  return value = function() {\n      switch (white(), ch) {\n        case "{":\n          return object();\n        case "[":\n          return array();\n        case \'"\':\n          return string();\n        case "-":\n          return number();\n        default:\n          return ch >= "0" && "9" >= ch ? number() : word()\n      }\n    },\n    function(source, reviver) {\n      var result;\n      return text = source, at = 0, ch = " ", result = value(), white(), ch && error("Syntax error"), "function" == typeof reviver ? function walk(holder, key) {\n        var k, v, value = holder[key];\n        if (value && "object" == typeof value)\n          for (k in value) Object.hasOwnProperty.call(value, k) && (v = walk(value, k), void 0 !== v ? value[k] = v : delete value[k]);\n        return reviver.call(holder, key, value)\n      }({\n        "": result\n      }, "") : result\n    }\n}), ace.define("ace/mode/json_worker", ["require", "exports", "module", "ace/lib/oop", "ace/worker/mirror", "ace/mode/json/json_parse"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("../lib/oop"),\n    Mirror = acequire("../worker/mirror").Mirror,\n    parse = acequire("./json/json_parse"),\n    JsonWorker = exports.JsonWorker = function(sender) {\n      Mirror.call(this, sender), this.setTimeout(200)\n    };\n  oop.inherits(JsonWorker, Mirror),\n    function() {\n      this.onUpdate = function() {\n        var value = this.doc.getValue(),\n          errors = [];\n        try {\n          value && parse(value)\n        } catch (e) {\n          var pos = this.doc.indexToPosition(e.at - 1);\n          errors.push({\n            row: pos.row,\n            column: pos.column,\n            text: e.message,\n            type: "error"\n          })\n        }\n        this.sender.emit("annotate", errors)\n      }\n    }.call(JsonWorker.prototype)\n}), ace.define("ace/lib/es5-shim", ["require", "exports", "module"], function() {\n  function Empty() {}\n\n  function doesDefinePropertyWork(object) {\n    try {\n      return Object.defineProperty(object, "sentinel", {}), "sentinel" in object\n    } catch (exception) {}\n  }\n\n  function toInteger(n) {\n    return n = +n, n !== n ? n = 0 : 0 !== n && n !== 1 / 0 && n !== -(1 / 0) && (n = (n > 0 || -1) * Math.floor(Math.abs(n))), n\n  }\n  Function.prototype.bind || (Function.prototype.bind = function(that) {\n    var target = this;\n    if ("function" != typeof target) throw new TypeError("Function.prototype.bind called on incompatible " + target);\n    var args = slice.call(arguments, 1),\n      bound = function() {\n        if (this instanceof bound) {\n          var result = target.apply(this, args.concat(slice.call(arguments)));\n          return Object(result) === result ? result : this\n        }\n        return target.apply(that, args.concat(slice.call(arguments)))\n      };\n    return target.prototype && (Empty.prototype = target.prototype, bound.prototype = new Empty, Empty.prototype = null), bound\n  });\n  var defineGetter, defineSetter, lookupGetter, lookupSetter, supportsAccessors, call = Function.prototype.call,\n    prototypeOfArray = Array.prototype,\n    prototypeOfObject = Object.prototype,\n    slice = prototypeOfArray.slice,\n    _toString = call.bind(prototypeOfObject.toString),\n    owns = call.bind(prototypeOfObject.hasOwnProperty);\n  if ((supportsAccessors = owns(prototypeOfObject, "__defineGetter__")) && (defineGetter = call.bind(prototypeOfObject.__defineGetter__), defineSetter = call.bind(prototypeOfObject.__defineSetter__), lookupGetter = call.bind(prototypeOfObject.__lookupGetter__), lookupSetter = call.bind(prototypeOfObject.__lookupSetter__)), 2 != [1, 2].splice(0).length)\n    if (function() {\n        function makeArray(l) {\n          var a = Array(l + 2);\n          return a[0] = a[1] = 0, a\n        }\n        var lengthBefore, array = [];\n        return array.splice.apply(array, makeArray(20)), array.splice.apply(array, makeArray(26)), lengthBefore = array.length, array.splice(5, 0, "XXX"), lengthBefore + 1 == array.length, lengthBefore + 1 == array.length ? !0 : void 0\n      }()) {\n      var array_splice = Array.prototype.splice;\n      Array.prototype.splice = function(start, deleteCount) {\n        return arguments.length ? array_splice.apply(this, [void 0 === start ? 0 : start, void 0 === deleteCount ? this.length - start : deleteCount].concat(slice.call(arguments, 2))) : []\n      }\n    } else Array.prototype.splice = function(pos, removeCount) {\n      var length = this.length;\n      pos > 0 ? pos > length && (pos = length) : void 0 == pos ? pos = 0 : 0 > pos && (pos = Math.max(length + pos, 0)), length > pos + removeCount || (removeCount = length - pos);\n      var removed = this.slice(pos, pos + removeCount),\n        insert = slice.call(arguments, 2),\n        add = insert.length;\n      if (pos === length) add && this.push.apply(this, insert);\n      else {\n        var remove = Math.min(removeCount, length - pos),\n          tailOldPos = pos + remove,\n          tailNewPos = tailOldPos + add - remove,\n          tailCount = length - tailOldPos,\n          lengthAfterRemove = length - remove;\n        if (tailOldPos > tailNewPos)\n          for (var i = 0; tailCount > i; ++i) this[tailNewPos + i] = this[tailOldPos + i];\n        else if (tailNewPos > tailOldPos)\n          for (i = tailCount; i--;) this[tailNewPos + i] = this[tailOldPos + i];\n        if (add && pos === lengthAfterRemove) this.length = lengthAfterRemove, this.push.apply(this, insert);\n        else\n          for (this.length = lengthAfterRemove + add, i = 0; add > i; ++i) this[pos + i] = insert[i]\n      }\n      return removed\n    };\n  Array.isArray || (Array.isArray = function(obj) {\n    return "[object Array]" == _toString(obj)\n  });\n  var boxedString = Object("a"),\n    splitString = "a" != boxedString[0] || !(0 in boxedString);\n  if (Array.prototype.forEach || (Array.prototype.forEach = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        thisp = arguments[1],\n        i = -1,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError;\n      for (; length > ++i;) i in self && fun.call(thisp, self[i], i, object)\n    }), Array.prototype.map || (Array.prototype.map = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = Array(length),\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (result[i] = fun.call(thisp, self[i], i, object));\n      return result\n    }), Array.prototype.filter || (Array.prototype.filter = function(fun) {\n      var value, object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = [],\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (value = self[i], fun.call(thisp, value, i, object) && result.push(value));\n      return result\n    }), Array.prototype.every || (Array.prototype.every = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && !fun.call(thisp, self[i], i, object)) return !1;\n      return !0\n    }), Array.prototype.some || (Array.prototype.some = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && fun.call(thisp, self[i], i, object)) return !0;\n      return !1\n    }), Array.prototype.reduce || (Array.prototype.reduce = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduce of empty array with no initial value");\n      var result, i = 0;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i++];\n            break\n          }\n          if (++i >= length) throw new TypeError("reduce of empty array with no initial value")\n        }\n      for (; length > i; i++) i in self && (result = fun.call(void 0, result, self[i], i, object));\n      return result\n    }), Array.prototype.reduceRight || (Array.prototype.reduceRight = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduceRight of empty array with no initial value");\n      var result, i = length - 1;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i--];\n            break\n          }\n          if (0 > --i) throw new TypeError("reduceRight of empty array with no initial value")\n        }\n      do i in this && (result = fun.call(void 0, result, self[i], i, object)); while (i--);\n      return result\n    }), Array.prototype.indexOf && -1 == [0, 1].indexOf(1, 2) || (Array.prototype.indexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = 0;\n      for (arguments.length > 1 && (i = toInteger(arguments[1])), i = i >= 0 ? i : Math.max(0, length + i); length > i; i++)\n        if (i in self && self[i] === sought) return i;\n      return -1\n    }), Array.prototype.lastIndexOf && -1 == [0, 1].lastIndexOf(0, -3) || (Array.prototype.lastIndexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = length - 1;\n      for (arguments.length > 1 && (i = Math.min(i, toInteger(arguments[1]))), i = i >= 0 ? i : length - Math.abs(i); i >= 0; i--)\n        if (i in self && sought === self[i]) return i;\n      return -1\n    }), Object.getPrototypeOf || (Object.getPrototypeOf = function(object) {\n      return object.__proto__ || (object.constructor ? object.constructor.prototype : prototypeOfObject)\n    }), !Object.getOwnPropertyDescriptor) {\n    var ERR_NON_OBJECT = "Object.getOwnPropertyDescriptor called on a non-object: ";\n    Object.getOwnPropertyDescriptor = function(object, property) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT + object);\n      if (owns(object, property)) {\n        var descriptor, getter, setter;\n        if (descriptor = {\n            enumerable: !0,\n            configurable: !0\n          }, supportsAccessors) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject;\n          var getter = lookupGetter(object, property),\n            setter = lookupSetter(object, property);\n          if (object.__proto__ = prototype, getter || setter) return getter && (descriptor.get = getter), setter && (descriptor.set = setter), descriptor\n        }\n        return descriptor.value = object[property], descriptor\n      }\n    }\n  }\n  if (Object.getOwnPropertyNames || (Object.getOwnPropertyNames = function(object) {\n      return Object.keys(object)\n    }), !Object.create) {\n    var createEmpty;\n    createEmpty = null === Object.prototype.__proto__ ? function() {\n      return {\n        __proto__: null\n      }\n    } : function() {\n      var empty = {};\n      for (var i in empty) empty[i] = null;\n      return empty.constructor = empty.hasOwnProperty = empty.propertyIsEnumerable = empty.isPrototypeOf = empty.toLocaleString = empty.toString = empty.valueOf = empty.__proto__ = null, empty\n    }, Object.create = function(prototype, properties) {\n      var object;\n      if (null === prototype) object = createEmpty();\n      else {\n        if ("object" != typeof prototype) throw new TypeError("typeof prototype[" + typeof prototype + "] != \'object\'");\n        var Type = function() {};\n        Type.prototype = prototype, object = new Type, object.__proto__ = prototype\n      }\n      return void 0 !== properties && Object.defineProperties(object, properties), object\n    }\n  }\n  if (Object.defineProperty) {\n    var definePropertyWorksOnObject = doesDefinePropertyWork({}),\n      definePropertyWorksOnDom = "undefined" == typeof document || doesDefinePropertyWork(document.createElement("div"));\n    if (!definePropertyWorksOnObject || !definePropertyWorksOnDom) var definePropertyFallback = Object.defineProperty\n  }\n  if (!Object.defineProperty || definePropertyFallback) {\n    var ERR_NON_OBJECT_DESCRIPTOR = "Property description must be an object: ",\n      ERR_NON_OBJECT_TARGET = "Object.defineProperty called on non-object: ",\n      ERR_ACCESSORS_NOT_SUPPORTED = "getters & setters can not be defined on this javascript engine";\n    Object.defineProperty = function(object, property, descriptor) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT_TARGET + object);\n      if ("object" != typeof descriptor && "function" != typeof descriptor || null === descriptor) throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);\n      if (definePropertyFallback) try {\n        return definePropertyFallback.call(Object, object, property, descriptor)\n      } catch (exception) {}\n      if (owns(descriptor, "value"))\n        if (supportsAccessors && (lookupGetter(object, property) || lookupSetter(object, property))) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject, delete object[property], object[property] = descriptor.value, object.__proto__ = prototype\n        } else object[property] = descriptor.value;\n      else {\n        if (!supportsAccessors) throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\n        owns(descriptor, "get") && defineGetter(object, property, descriptor.get), owns(descriptor, "set") && defineSetter(object, property, descriptor.set)\n      }\n      return object\n    }\n  }\n  Object.defineProperties || (Object.defineProperties = function(object, properties) {\n    for (var property in properties) owns(properties, property) && Object.defineProperty(object, property, properties[property]);\n    return object\n  }), Object.seal || (Object.seal = function(object) {\n    return object\n  }), Object.freeze || (Object.freeze = function(object) {\n    return object\n  });\n  try {\n    Object.freeze(function() {})\n  } catch (exception) {\n    Object.freeze = function(freezeObject) {\n      return function(object) {\n        return "function" == typeof object ? object : freezeObject(object)\n      }\n    }(Object.freeze)\n  }\n  if (Object.preventExtensions || (Object.preventExtensions = function(object) {\n      return object\n    }), Object.isSealed || (Object.isSealed = function() {\n      return !1\n    }), Object.isFrozen || (Object.isFrozen = function() {\n      return !1\n    }), Object.isExtensible || (Object.isExtensible = function(object) {\n      if (Object(object) === object) throw new TypeError;\n      for (var name = ""; owns(object, name);) name += "?";\n      object[name] = !0;\n      var returnValue = owns(object, name);\n      return delete object[name], returnValue\n    }), !Object.keys) {\n    var hasDontEnumBug = !0,\n      dontEnums = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"],\n      dontEnumsLength = dontEnums.length;\n    for (var key in {\n        toString: null\n      }) hasDontEnumBug = !1;\n    Object.keys = function(object) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError("Object.keys called on a non-object");\n      var keys = [];\n      for (var name in object) owns(object, name) && keys.push(name);\n      if (hasDontEnumBug)\n        for (var i = 0, ii = dontEnumsLength; ii > i; i++) {\n          var dontEnum = dontEnums[i];\n          owns(object, dontEnum) && keys.push(dontEnum)\n        }\n      return keys\n    }\n  }\n  Date.now || (Date.now = function() {\n    return (new Date).getTime()\n  });\n  var ws = "\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";\n  if (!String.prototype.trim || ws.trim()) {\n    ws = "[" + ws + "]";\n    var trimBeginRegexp = RegExp("^" + ws + ws + "*"),\n      trimEndRegexp = RegExp(ws + ws + "*$");\n    String.prototype.trim = function() {\n      return (this + "").replace(trimBeginRegexp, "").replace(trimEndRegexp, "")\n    }\n  }\n  var toObject = function(o) {\n    if (null == o) throw new TypeError("can\'t convert " + o + " to object");\n    return Object(o)\n  }\n});\n'},{WorkerClient:qe}=Te.a.acequire("ace/worker/worker_client"),Ve=Te.a.acequire("ace/lib/oop"),{Mode:We}=Te.a.acequire("ace/mode/json"),{Tokenizer:Be}=Te.a.acequire("ace/tokenizer"),{MatchingBraceOutdent:$e}=Te.a.acequire("ace/mode/matching_brace_outdent"),{CstyleBehaviour:Je}=Te.a.acequire("ace/mode/behaviour/cstyle"),{FoldMode:Ue}=Te.a.acequire("ace/mode/folding/cstyle"),He=function(){const e=new Pe;e.normalizeRules(),this.$tokenizer=new Be(e.getRules()),this.$outdent=new $e,this.$behaviour=new Je,this.foldingRules=new Ue};Ve.inherits(He,We),He.prototype.createWorker=function(e){const t=new qe(["ace"],ze,"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t};var Ge=n(92),Qe=n(90);const Ye=Object(i.memo)((({convertToJson:e,xJsonMode:t,setAdvancedRuntimeMappingsConfig:n,setIsRuntimeMappingsEditorApplyButtonEnabled:a,advancedEditorRuntimeMappingsLastApplied:r,advancedRuntimeMappingsConfig:i})=>Object(b.jsx)("div",{"data-test-subj":"mlDataFrameAnalyticsAdvancedRuntimeMappingsEditor"},Object(b.jsx)(Qe.CodeEditor,{height:250,languageId:"json",onChange:t=>{if(n(t),r!==t)if(""!==t)try{const n=JSON.parse(e(t));a(Object(V.a)(n))}catch(e){a(!1)}else a(!0);else a(!1)},options:{ariaLabel:l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeMappings.advancedEditorAriaLabel",{defaultMessage:"Advanced runtime editor"}),automaticLayout:!0,fontSize:12,scrollBeyondLastLine:!1,quickSuggestions:!0,minimap:{enabled:!1},wordWrap:"on",wrappingIndent:"indent"},value:i}))),((e,t)=>Object(p.isEqual)(Xe(e),Xe(t))));function Xe(e){return[e.advancedEditorRuntimeMappingsLastApplied,e.advancedRuntimeMappingsConfig]}const Ze=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalTitle",{defaultMessage:"Edits will be lost"}),Ke=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalCancelButtonText",{defaultMessage:"Cancel"}),et=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalConfirmButtonText",{defaultMessage:"Close editor"}),tt=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalBodyText",{defaultMessage:"The changes in the editor haven't been applied yet. By closing the editor you will lose your edits."}),nt=({onCancel:e,onConfirm:t})=>Object(b.jsx)(o.EuiConfirmModal,{title:Ze,onCancel:e,onConfirm:t,cancelButtonText:Ke,confirmButtonText:et,buttonColor:"danger",defaultFocusedButton:"confirm"},Object(b.jsx)("p",null,tt)),at="220px",rt=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.indexPreview.copyRuntimeMappingsClipboardTooltip",{defaultMessage:"Copy Dev Console statement of the runtime fields to the clipboard."}),it=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedSourceEditorApplyButtonText",{defaultMessage:"Apply changes"}),st=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedRuntimeFieldsEditorHelpText",{defaultMessage:"The advanced editor allows you to edit the runtime fields of the source."}),ot=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedEditorRuntimeFieldsSwitchLabel",{defaultMessage:"Edit runtime fields"}),lt=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeFieldsLabel",{defaultMessage:"Runtime fields"}),{useXJsonMode:ct}=Ge.XJson,ut=new He,dt=({actions:e,state:t})=>{const[n,a]=Object(i.useState)(!1),[r,l]=Object(i.useState)(!1),[u,d]=Object(i.useState)(!1),[m,p]=Object(i.useState)(),{setFormState:f}=e,{jobType:h,previousRuntimeMapping:g,runtimeMappings:j}=t.form,{convertToJson:x,setXJson:w,xJson:y}=ct(j||""),{selectedDataView:v}=Object(I.c)(),O=(e=!1)=>{!0===e&&(f({runtimeMappingsUpdated:!1}),w(null!=m?m:"")),a(!n),d(Object(V.a)(j))};return Object(i.useEffect)((function(){const e=Object(W.a)(v,j),t=JSON.stringify(e,null,2);e&&(w(t),p(t),f({runtimeMappings:e}))}),[]),Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(o.EuiFormRow,{fullWidth:!0,label:lt},Object(b.jsx)(o.EuiFlexGroup,{alignItems:"baseline",justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!0},Object(ge.a)(j)?Object(b.jsx)(o.EuiText,{size:"s",grow:!1},Object.keys(j).join(",")):Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.createWizard.noRuntimeFieldLabel",defaultMessage:"No runtime field"}),n&&Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(Ye,{advancedEditorRuntimeMappingsLastApplied:m,advancedRuntimeMappingsConfig:y,setIsRuntimeMappingsEditorApplyButtonEnabled:d,setAdvancedRuntimeMappingsConfig:w,convertToJson:x,xJsonMode:ut}))),Object(b.jsx)(o.EuiFlexItem,{grow:!1,style:{width:at}},Object(b.jsx)(o.EuiFlexGroup,{gutterSize:"xs",direction:"column",justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiSwitch,{disabled:void 0===h,label:ot,checked:n,onChange:()=>{n&&y!==m?l(!0):O()},"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsEditorSwitch"}),r&&Object(b.jsx)(nt,{onCancel:()=>l(!1),onConfirm:()=>{l(!1),O(!0)}})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiCopy,{beforeMessage:rt,textToCopy:null!=y?y:""},(e=>Object(b.jsx)(o.EuiButtonIcon,{onClick:e,iconType:"copyClipboard","aria-label":rt})))))),n&&Object(b.jsx)(o.EuiFlexItem,{style:{width:at}},Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(o.EuiText,{size:"xs"},st),Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(o.EuiButton,{style:{width:"fit-content"},size:"s",fill:!0,onClick:()=>{const e=""===y,t=e?void 0:JSON.parse(y),n=e?"":JSON.stringify(t,null,2);f({runtimeMappings:t,runtimeMappingsUpdated:!0,previousRuntimeMapping:void 0===g&&void 0===j?t:j}),w(n),p(n),d(!1)},disabled:!u,"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsApplyButton"},it)))))),Object(b.jsx)(o.EuiSpacer,{size:"s"}))},mt=({indexName:e,docsType:t})=>{const{services:{docLinks:{links:{ml:{dFAStartJob:n,dFACreateJob:a}}}}}=Object(g.d)(),r="start"===t?n:a,u=((e,t=!1)=>{const[n,a]=Object(i.useState)(!0),{services:{mlServices:{mlApiServices:{hasPrivileges:r}}}}=Object(g.d)();if(Object(i.useEffect)((function(){!async function(){var n;const i=await r({index:[{names:[e],privileges:["read",...t?["create_index","manage","index"]:["view_index_metadata"]]}]});a(!0===(null===(n=i.hasPrivileges)||void 0===n?void 0:n.has_all_requested))}()}),[r,e,t]),""!==e)return n})(e,"start"===t);return void 0===u||!0===u?null:Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiCallOut,{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.permissionsCalloutTitle",{defaultMessage:"Indices permissions required"}),iconType:"warning",color:"warning"},Object(b.jsx)("p",null,Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.indicesPermissionsMessage",defaultMessage:"You don't have the required permissions on the {indexName} index. Refer to the {docLink} for more information on requirements.",values:{indexName:e,docLink:Object(b.jsx)(o.EuiLink,{href:r,target:"_blank"},Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.indicesPermissionsMessage.docsLink",defaultMessage:"documentation"}))}}))),Object(b.jsx)(o.EuiSpacer,null))},pt="runtime_mapping",ft=l.i18n.translate("xpack.ml.dataframe.analytics.createWizard.requiredFieldsErrorMessage",{defaultMessage:"At least one field must be included in the analysis in addition to the dependent variable."});function ht(e,t){const n=[];return Object.keys(t).forEach((a=>{const r=t[a];Object(q.a)(r)&&Z(a,r.type,e)&&n.push({label:a,field:{id:a,type:r.type}})})),n}const gt=({actions:e,isClone:t,state:n,setCurrentStep:a,sourceDataViewTitle:r})=>{const{selectedDataView:c,selectedSavedSearch:u}=Object(I.c)(),{savedSearchQuery:m,savedSearchQueryStr:h}=function(){const[e,t]=Object(i.useState)(void 0),[n,a]=Object(i.useState)(void 0),{services:{uiSettings:r}}=Object(g.d)(),{selectedDataView:s,selectedSavedSearch:o}=Object(I.c)();return Object(i.useEffect)((()=>{(()=>{let e,n={};if(o){var i;const l=o.searchSource.getField("query"),c=null!==(i=o.searchSource.getField("filter"))&&void 0!==i?i:[],u=l.language;if(e=l.query,u===$.a.KUERY){const t=Object(Ee.fromKueryExpression)(e);n=Object(Ee.toElasticsearchQuery)(t,s);const a=Object(Ee.buildQueryFromFilters)(c,s);void 0===n.bool&&(n.bool={},void 0!==n.match_all&&(n.bool.should={match_all:n.match_all},delete n.match_all)),!1===Array.isArray(n.bool.filter)&&(n.bool.filter=void 0===n.bool.filter?[]:[n.bool.filter]),!1===Array.isArray(n.bool.must_not)&&(n.bool.must_not=void 0===n.bool.must_not?[]:[n.bool.must_not]),n.bool.filter=[...n.bool.filter,...a.filter],n.bool.must_not=[...n.bool.must_not,...a.must_not]}else n=Object(Ee.buildEsQuery)(s,[l],c),Object(Ee.decorateQuery)(n,r.get("query:queryString:options"));t(n),a(e)}else t(null),a(null)})()}),[]),{savedSearchQuery:e,savedSearchQueryStr:n}}(),[j,x]=Object(i.useState)(!1),[w,E]=Object(i.useState)(!1),[k,S]=Object(i.useState)(!1),[_,M]=Object(i.useState)([]),[C,R]=Object(i.useState)([]),[F,A]=Object(i.useState)(!1),[L,N]=Object(i.useState)(),[D,P]=Object(i.useState)(),[z,q]=Object(i.useState)(!1),[G,Q]=Object(i.useState)(),{setEstimatedModelMemoryLimit:Y,setFormState:X}=e,{cloneJob:te,estimatedModelMemoryLimit:ae,form:ie,isJobCreated:se,requestMessages:oe}=n,ce=Object(i.useRef)(!0),{dependentVariable:ue,includes:de,jobConfigQuery:me,jobConfigQueryLanguage:pe,jobConfigQueryString:ke,jobType:Te,modelMemoryLimit:Se,previousJobType:_e,requiredFieldsError:Me,runtimeMappings:Ce,previousRuntimeMapping:Re,runtimeMappingsUpdated:Fe,sourceIndex:Ae,trainingPercent:Le,useEstimatedMml:Ne}=ie,De=Te===T.b.REGRESSION||Te===T.b.CLASSIFICATION,Pe=De&&""===ue,ze=void 0!==Te,qe=De&&""!==ue||Te===T.b.OUTLIER_DETECTION,[Ve,We]=Object(i.useState)({query:null!=ke?ke:"",language:null!=pe?pe:$.a.KUERY}),Be=Object(ee.f)(),$e=((e,t,n,a)=>{const[r,s]=Object(i.useState)(),[o,l]=Object(i.useState)();Object(i.useEffect)((()=>{!async function(){b(""),x(be.b.LOADING);const t={index:e.title,body:{fields:["*"],_source:!1,query:{function_score:{query:{match_all:{}},random_score:{}}},size:500}};try{const n=(await d.ml.esSearch(t)).hits.hits.map((e=>{var t;return Object(be.l)(null!==(t=e.fields)&&void 0!==t?t:{})})),a=Object(be.k)(e),r=[...new Set(n.map(Object.keys).flat(1))].filter((e=>a.includes(e))).sort();x(be.b.LOADED),s(r)}catch(e){b(Object(f.a)(e)),x(be.b.ERROR)}}()}),[]);const c=Object(i.useMemo)((()=>Object(W.a)(e,a)),[e,a]),[u,m]=Object(i.useState)([]);Object(i.useEffect)((()=>{Array.isArray(r)&&m([...ve(e,r),...c?ye(c):[]])}),[e,r,c]);const p=Object(je.a)(u),{pagination:h,resetPagination:g,setErrorMessage:b,setRowCountInfo:j,setStatus:x,setTableItems:w,sortingColumns:y,tableItems:v}=p;Object(i.useEffect)((()=>{g()}),[JSON.stringify(t)]),Object(i.useEffect)((()=>{void 0!==r&&void 0!==t&&async function(){var n;b(""),x(be.b.LOADING);const a=null===(n=e.getTimeField())||void 0===n?void 0:n.name,i=y.reduce(((e,t)=>(e[t.id]={order:t.direction},e)),{}),s={index:e.title,body:{query:t,from:h.pageIndex*h.pageSize,size:h.pageSize,fields:[...null!=r?r:[],...Object(V.a)(c)?Object.keys(c):[]],_source:!1,...Object.keys(i).length>0?{sort:i}:{},...Object(V.a)(c)?{runtime_mappings:c}:{},...a?{aggs:{earliest:{min:{field:a}},latest:{max:{field:a}}}}:{}}};try{const e=await d.ml.esSearch(s);e.aggregations&&Object(ge.a)(e.aggregations.earliest,["value"])&&Object(ge.a)(e.aggregations.latest,["value"])&&l({from:e.aggregations.earliest.value,to:e.aggregations.latest.value});const t=e.hits.hits.map((e=>{var t;return Object(be.l)(null!==(t=e.fields)&&void 0!==t?t:{})}));j({rowCount:"number"==typeof e.hits.total?e.hits.total:e.hits.total.value,rowCountRelation:"number"==typeof e.hits.total?"eq":e.hits.total.relation}),w(t),x(be.b.LOADED)}catch(e){b(Object(f.a)(e)),x(be.b.ERROR)}}()}),[e.title,r,JSON.stringify([t,h,y,c])]);const O=Object(i.useMemo)((()=>new we.a(e,n)),[e]);Object(i.useEffect)((()=>{p.chartsVisible&&void 0!==t&&async function(e){try{const t=await O.loadFieldHistograms(u.filter((e=>p.visibleColumns.includes(e.id))).map((e=>({fieldName:e.id,type:Object(xe.a)(e.schema)}))),e,he.a,c);p.setColumnCharts(t)}catch(e){Object(be.n)(e,n)}}(t)}),[p.chartsVisible,e.title,JSON.stringify([t,p.visibleColumns,a])]);const E=Object(be.o)(e,h,v);return{...p,dataViewFields:r,renderCellValue:E,timeRangeMs:o}})(c,function(e,t){if(void 0!==e)return null!==e?e:t}(m,me),Be,Ce),Je={...$e,dataTestSubj:"mlAnalyticsCreationDataGrid",toastNotifications:Be},Ue=Pe||void 0===Te||void 0!==L||void 0!==G||void 0!==Me||void 0!==D||F,He=Object(p.debounce)((async()=>{A(!0);const e=_e!==Te,t=!(ce.current&&Se||!0!==Ne),n=!ce.current||!Se||""===ae;ce.current&&(ce.current=!1);const a=De&&de.length>0&&!1===de.includes(ue),r=a&&Ce&&Object.keys(Ce).includes(ue);let i=ie;(r||a)&&(i=Object(p.cloneDeep)(ie),i.includes=[...de,ue]);const{success:s,expectedMemory:o,fieldSelection:l,errorMessage:c,noDocsContainMappedFields:u}=await O(i);if(s){n&&Y(o);const s=l.some((e=>!0===e.is_included&&!1===e.is_required)),c={...t?{modelMemoryLimit:o}:{},...r||a?{includes:i.includes}:{},requiredFieldsError:s?void 0:ft};e&&(x(!1),N(void 0),P(void 0),q(!1),R(l||[])),X(c),A(!1)}else{const{maxDistinctValuesErrorMessage:e,unsupportedFieldsErrorMessage:n,toastNotificationDanger:a,toastNotificationWarning:r}=K(c,Ae,Te);a&&Be.addDanger(a),r&&Be.addWarning(r);const i=void 0!==Te?v.a[Te]:v.a.outlier_detection;Y(i),x(!0),N(e),P(n),q(u),A(!1),X({...t?{modelMemoryLimit:i}:{}})}}),300);Object(i.useEffect)((()=>{X({sourceIndex:c.title})}),[]);const Ge=Object(i.useMemo)((()=>void 0!==(null==$e?void 0:$e.dataViewFields)?$e.dataViewFields.map((e=>({name:e,is_included:!1,is_required:!1}))):[]),[`${null==$e?void 0:$e.dataViewFields}`]);Object(i.useEffect)((()=>{"string"==typeof h&&X({jobConfigQuery:m,jobConfigQueryString:h})}),[JSON.stringify(m),h]),Object(i.useEffect)((()=>{if(De){const e=Object(W.a)(c);let t;e&&(t=ht(Te,e)),(async(e,t=[])=>{E(!0),N(void 0);try{if(void 0!==c){const n=[];let a=e.dependentVariable;const{fields:r}=U.a;let i=!0;for(const t of r)Z(t.id,t.type,Te)&&(n.push({label:t.id,field:t}),e.dependentVariable===t.id&&(i=!1));Object(V.a)(e.runtimeMappings)&&Object.keys(e.runtimeMappings).includes(ie.dependentVariable)&&(i=!1,n.push({label:ie.dependentVariable,key:`runtime_mapping_${ie.dependentVariable}`})),i&&(a=""),M([...t,...n]),E(!1),S(!1),X({dependentVariable:a})}}catch(e){E(!1),S(!0)}})(ie,t)}}),[Te]);const Qe=Object(i.useCallback)((async()=>{if(Fe){let e=!1;if(De){const t=_.filter((t=>{var n,a;return t.label===ue&&null!==(n=t.key)&&void 0!==n&&n.includes(pt)&&(e=!0),!(null!==(a=t.key)&&void 0!==a&&a.includes(pt))}));if(void 0===Ce&&!0===Fe)M(t);else if(Ce){const e=ht(Te,Ce);M([...t,...e])}}const t=de.filter((e=>!(Re&&Re[e])));if(e&&(X({dependentVariable:"",includes:t}),R(C.filter((({name:e})=>!(Re&&Re[e]))))),!e&&ze&&qe){const e=Object(p.cloneDeep)(ie),n=De&&Ce&&Object.keys(Ce).includes(ue)&&e.includes.length>0&&!1===e.includes.includes(ue);e.includes=n?[...t,ue]:t;const{success:a,fieldSelection:r,errorMessage:i,noDocsContainMappedFields:s}=await O(e);if(a){const e=r.some((e=>!0===e.is_included&&!1===e.is_required));let n;Object(V.a)(Ce)&&(n=r.map((e=>{var n;return void 0!==Ce[e.name]&&!1===e.is_included&&null!==(n=e.reason)&&void 0!==n&&n.includes("field not in includes list")&&(t.push(e.name),e.is_included=!0),e}))),R(n||r),N(void 0),P(void 0),q(s),X({includes:t,requiredFieldsError:e?void 0:ft})}else{const{maxDistinctValuesErrorMessage:e,unsupportedFieldsErrorMessage:t,toastNotificationDanger:n,toastNotificationWarning:a}=K(i,Ae,Te);n&&Be.addDanger(n),a&&Be.addWarning(a),N(e),P(t),q(s)}}}}),[JSON.stringify(Ce)]);Object(i.useEffect)((()=>{Qe()}),[JSON.stringify(Ce)]),Object(i.useEffect)((()=>(ze&&qe&&He(),()=>{He.cancel()})),[Te,ue,Le,JSON.stringify(de),ke]);const Ye=Object(i.useMemo)((()=>({color:De?ue:void 0,fields:C.filter((e=>"numerical"===e.feature_type&&e.is_included)).map((e=>e.name)),index:c.title,legendType:Object(H.a)(Te),searchQuery:me,runtimeMappings:Ce,dataView:c})),[c.title,ue,C,De,me,Te]),Xe=Object(i.useMemo)((()=>(Te===T.b.OUTLIER_DETECTION||De&&!Pe)&&Ye.fields.length>1),[Pe,Te,Ye.fields.length]),{services:Ze}=Object(g.d)(),Ke=Object(i.useMemo)((()=>{const{uiSettings:e,data:t,fieldFormats:n,charts:a}=Ze;return{uiSettings:e,dataViews:t.dataViews,data:t,fieldFormats:n,charts:a}}),[Ze]);if(void 0===m)return null;const et=C.length>0&&!z?C:Ge;return Object(b.jsx)(J.b,{dataView:c,fieldStatsServices:Ke,timeRangeMs:$e.timeRangeMs,dslQuery:me},Object(b.jsx)(i.Fragment,null,Object(b.jsx)(y,{messages:oe}),Object(b.jsx)(le,{jobType:Te}),Object(b.jsx)(mt,{indexName:r,docsType:"create"}),Object(b.jsx)(re,{type:Te,setFormState:X}),null===m&&Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.sourceQueryLabel",{defaultMessage:"Query"}),fullWidth:!0},Object(b.jsx)(Oe.a,{dataView:c,setSearchQuery:e=>{e.query&&X({jobConfigQuery:e.query,jobConfigQueryLanguage:e.language,jobConfigQueryString:e.queryString}),We({query:e.queryString,language:e.language})},query:Ve})),(t&&te||!t)&&Object(b.jsx)(dt,{actions:e,state:n}),Object(b.jsx)(o.EuiFormRow,{label:Object(b.jsx)(i.Fragment,null,null!==m&&Object(b.jsx)(o.EuiText,null,l.i18n.translate("xpack.ml.dataframe.analytics.create.savedSearchLabel",{defaultMessage:"Saved search"})),Object(b.jsx)(o.EuiBadge,{color:"hollow"},null!==u?u.title:c.getName())),fullWidth:!0},Object(b.jsx)(B.a,Je)),De&&Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFormRow,{fullWidth:!0,label:l.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableLabel",{defaultMessage:"Dependent variable"}),helpText:0===_.length&&!1===k&&c&&l.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsNoNumericalFields",{defaultMessage:"No numeric type fields were found for this data view."}),isInvalid:void 0!==L,error:[...!0===k?[Object(b.jsx)(i.Fragment,null,l.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsFetchError",{defaultMessage:"There was a problem fetching fields. Please refresh the page and try again."}))]:[],...!0===j&&void 0!==L?[Object(b.jsx)(i.Fragment,null,l.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableMaxDistictValuesError",{defaultMessage:"Invalid. {message}",values:{message:L}}))]:[]]},Object(b.jsx)(J.a,{fullWidth:!0,"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableInputAriaLabel",{defaultMessage:"Enter field to be used as dependent variable."}),placeholder:Te===T.b.REGRESSION?l.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableRegressionPlaceholder",{defaultMessage:"Select the numeric field that you want to predict."}):l.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableClassificationPlaceholder",{defaultMessage:"Select the numeric, categorical, or boolean field that you want to predict."}),isDisabled:se,isLoading:w,singleSelection:!0,options:_,selectedOptions:ue?[{label:ue}]:[],onChange:e=>{X({dependentVariable:e[0].label||""})},isClearable:!1,isInvalid:""===ue,"data-test-subj":"mlAnalyticsCreateJobWizardDependentVariableSelect"+(w?" loading":" loaded")}))),Object(b.jsx)(fe,{dependentVariable:ue,includes:de,isJobTypeWithDepVar:De,minimumFieldsRequiredMessage:G,setMinimumFieldsRequiredMessage:Q,tableItems:ce.current?C:et,unsupportedFieldsError:D,setUnsupportedFieldsError:P,setFormState:X}),Object(b.jsx)(o.EuiFormRow,{fullWidth:!0,isInvalid:void 0!==Me,error:l.i18n.translate("xpack.ml.dataframe.analytics.create.requiredFieldsError",{defaultMessage:"Invalid. {message}",values:{message:Me}})},Object(b.jsx)(i.Fragment,null)),Object(b.jsx)(o.EuiSpacer,null),Xe&&Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixFormRow",label:l.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabel",{defaultMessage:"Scatterplot matrix"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabelHelpText",{defaultMessage:"Visualizes the relationships between pairs of selected included fields."}),fullWidth:!0},Object(b.jsx)(i.Fragment,null)),Object(b.jsx)(o.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixPanel"},Object(b.jsx)(Ie.a,Ye)),Object(b.jsx)(o.EuiSpacer,null)),De&&Object(b.jsx)(o.EuiFormRow,{fullWidth:!0,label:l.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentLabel",{defaultMessage:"Training percent"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentHelpText",{defaultMessage:"Defines the percentage of eligible documents that will be used for training."})},Object(b.jsx)(o.EuiRange,{fullWidth:!0,min:T.m,max:T.l,step:1,showLabels:!0,showRange:!0,showValue:!0,value:Le,onChange:e=>X({trainingPercent:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardTrainingPercentSlider"})),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(ne,{isDisabled:Ue,onClick:()=>{a(Ut.ADVANCED)}})))},bt=({actions:e,state:t,setCurrentStep:n,step:a,stepActivated:r,isClone:i,sourceDataViewTitle:s})=>{const l=a===Ut.CONFIGURATION,c=a!==Ut.CONFIGURATION&&!0===r,u=`mlAnalyticsCreateJobWizardConfigurationStep${l?" active":""}${c?" summary":""}`;return Object(b.jsx)(o.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":u},l&&Object(b.jsx)(gt,{actions:e,isClone:i,state:t,setCurrentStep:n,sourceDataViewTitle:s}),c&&Object(b.jsx)(z,{setCurrentStep:n,state:t}))},jt=({actions:e,state:t,advancedParamErrors:n})=>{const{setFormState:a}=e,{alpha:r,downsampleFactor:s,eta:c,etaGrowthRatePerTree:u,featureBagFraction:d,gamma:m,lambda:p,maxOptimizationRoundsPerHyperparameter:f,maxTrees:h,softTreeDepthLimit:g,softTreeDepthTolerance:j}=t.form;return Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaLabel",{defaultMessage:"Lambda"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaHelpText",{defaultMessage:"A multiplier of the leaf weights in loss calculations. Must be a nonnegative value."}),isInvalid:void 0!==n[T.a.LAMBDA],error:n[T.a.LAMBDA]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaInputAriaLabel",{defaultMessage:"A multiplier of leaf weights in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutLambdaInput",onChange:e=>a({lambda:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:Et(p)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesLabel",{defaultMessage:"Max trees"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesText",{defaultMessage:"The maximum number of decision trees in the forest."}),isInvalid:void 0!==n[T.a.MAX_TREES],error:n[T.a.MAX_TREES]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesInputAriaLabel",{defaultMessage:"The maximum number of decision trees in the forest."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutMaxTreesInput",onChange:e=>a({maxTrees:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==h&&!Number.isInteger(h),step:1,min:1,max:2e3,value:Et(h)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.gammaLabel",{defaultMessage:"Gamma"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.gammaText",{defaultMessage:"A multiplier of the tree size in loss calcuations. Must be nonnegative value."}),isInvalid:void 0!==n[T.a.GAMMA],error:n[T.a.GAMMA]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.gammaInputAriaLabel",{defaultMessage:"A multiplier of the tree size in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardGammaInput",onChange:e=>a({gamma:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:Et(m)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.etaLabel",{defaultMessage:"Eta"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.etaText",{defaultMessage:"The shrinkage applied to the weights. Must be between 0.001 and 1."}),isInvalid:void 0!==n[T.a.ETA],error:n[T.a.ETA]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.etaInputAriaLabel",{defaultMessage:"The shrinkage applied to the weights."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaInput",onChange:e=>a({eta:""===e.target.value?void 0:+e.target.value}),step:.001,min:.001,max:1,value:Et(c)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionLabel",{defaultMessage:"Feature bag fraction"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionText",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split."}),isInvalid:void 0!==n[T.a.FEATURE_BAG_FRACTION],error:n[T.a.FEATURE_BAG_FRACTION]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionInputAriaLabel",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split"}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureBagFractionInput",onChange:e=>a({featureBagFraction:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==d&&(d>1||d<=0),step:.001,max:1,value:Et(d)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.alphaLabel",{defaultMessage:"Alpha"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.alphaText",{defaultMessage:"A multiplier of the tree depth in loss calculations. Must be greater than or equal to 0."}),isInvalid:void 0!==n[T.a.ALPHA],error:n[T.a.ALPHA]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.alphaInputAriaLabel",{defaultMessage:"A multiplier of the tree depth in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardAlphaInput",onChange:e=>a({alpha:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:Et(r)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorLabel",{defaultMessage:"Downsample factor"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorText",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training. Must be between 0 and 1."}),isInvalid:void 0!==n[T.a.DOWNSAMPLE_FACTOR],error:n[T.a.DOWNSAMPLE_FACTOR]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorInputAriaLabel",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training."}),"data-test-subj":"mlAnalyticsCreateJobWizardDownsampleFactorInput",onChange:e=>a({downsampleFactor:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:Et(s)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeLabel",{defaultMessage:"Eta growth rate per tree"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeText",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest. Must be between 0.5 and 2."}),isInvalid:void 0!==n[T.a.ETA_GROWTH_RATE_PER_TREE],error:n[T.a.ETA_GROWTH_RATE_PER_TREE]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeInputAriaLabel",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaGrowthRatePerTreeInput",onChange:e=>a({etaGrowthRatePerTree:""===e.target.value?void 0:+e.target.value}),step:.001,min:.5,max:2,value:Et(u)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterLabel",{defaultMessage:"Max optimization rounds per hyperparameter"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterText",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter."}),isInvalid:void 0!==n[T.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER],error:n[T.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterInputAriaLabel",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter. Must be an integer between 0 and 20."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxOptimizationRoundsPerHyperparameterInput",onChange:e=>a({maxOptimizationRoundsPerHyperparameter:""===e.target.value?void 0:+e.target.value}),min:0,max:20,step:1,value:Et(f)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitLabel",{defaultMessage:"Soft tree depth limit"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitText",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations. Must be greater than or equal to 0. "}),isInvalid:void 0!==n[T.a.SOFT_TREE_DEPTH_LIMIT],error:n[T.a.SOFT_TREE_DEPTH_LIMIT]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthLimitInput",onChange:e=>a({softTreeDepthLimit:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:Et(g)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceLabel",{defaultMessage:"Soft tree depth tolerance"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceText",{defaultMessage:"Control how quickly the loss increases when tree depths exceed soft limits. The smaller the value, the faster the loss increases. Must be greater than or equal to 0.01. "}),isInvalid:void 0!==n[T.a.SOFT_TREE_DEPTH_TOLERANCE],error:n[T.a.SOFT_TREE_DEPTH_TOLERANCE]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthToleranceInput",onChange:e=>a({softTreeDepthTolerance:""===e.target.value?void 0:+e.target.value}),step:.001,min:.01,value:Et(j)}))))};var xt=n(431);const wt=({actions:e,state:t,advancedParamErrors:n})=>{const{setFormState:a}=e,{method:r,nNeighbors:s,outlierFraction:c,standardizationEnabled:u}=t.form;return Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.methodLabel",{defaultMessage:"Method"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.methodHelpText",{defaultMessage:"Set the method that outlier detection uses. If not set, uses an ensemble of different methods, normalizes and combines their individual outlier scores to obtain the overall outlier score. It is recommended to use the ensemble method."}),isInvalid:void 0!==n[T.a.METHOD],error:n[T.a.METHOD]},Object(b.jsx)(o.EuiSelect,{options:Object.values(T.i).map((e=>({value:e,text:e}))),value:r,hasNoInitialSelection:!0,onChange:e=>{a({method:e.target.value})},"data-test-subj":"mlAnalyticsCreateJobWizardMethodInput"}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsLabel",{defaultMessage:"N neighbors"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsHelpText",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score. When not set, different values are used for different ensemble members. Must be a positive integer."}),isInvalid:void 0!==n[T.a.N_NEIGHBORS],error:n[T.a.N_NEIGHBORS]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsInputAriaLabel",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score."}),"data-test-subj":"mlAnalyticsCreateJobWizardnNeighborsInput",onChange:e=>a({nNeighbors:""===e.target.value?void 0:+e.target.value}),step:1,min:1,value:Et(s)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionLabel",{defaultMessage:"Outlier fraction"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionHelpText",{defaultMessage:"Set the proportion of the data set that is assumed to be outlying prior to outlier detection."}),isInvalid:void 0!==n[T.a.OUTLIER_FRACTION],error:n[T.a.OUTLIER_FRACTION]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionInputAriaLabel",{defaultMessage:"Sets the proportion of the data set that is assumed to be outlying prior to outlier detection."}),"data-test-subj":"mlAnalyticsCreateJobWizardoutlierFractionInput",onChange:e=>a({outlierFraction:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:Et(c)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledLabel",{defaultMessage:"Standardization enabled"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledHelpText",{defaultMessage:"If true, the following operation is performed on the columns before computing outlier scores: (x_i - mean(x_i)) / sd(x_i)."})},Object(b.jsx)(o.EuiSelect,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledInputAriaLabel",{defaultMessage:"Sets standardization enabled setting."}),"data-test-subj":"mlAnalyticsCreateJobWizardStandardizationEnabledInput",options:[{value:"true",text:l.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledTrueValue",{defaultMessage:"True"})},{value:"false",text:l.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledFalseValue",{defaultMessage:"False"})}],value:u?"true":"false",hasNoInitialSelection:!0,onChange:e=>{a({standardizationEnabled:"true"===e.target.value})}}))))},yt={label:l.i18n.translate("xpack.ml.dataframe.analytics.create.allClassesLabel",{defaultMessage:"All classes"}),value:-1},vt=Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassTypeWarning",defaultMessage:"Value must be an integer of -1 or greater, where -1 indicates all classes."});function Ot(e){return-1===e?Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})," ",Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.allClassesMessage",defaultMessage:"If you have a large number of classes there could be a significant effect on the size of your destination index."})):Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})}function Et(e){return void 0===e?"":+e}const It=({actions:e,state:t,setCurrentStep:n})=>{var a;const[r,u]=Object(i.useState)({}),[d,m]=Object(i.useState)(!1),{services:{docLinks:p}}=Object(g.d)(),f=p.links.ml.classificationAucRoc,{setEstimatedModelMemoryLimit:h,setFormState:j}=e,{form:x,isJobCreated:w,estimatedModelMemoryLimit:y}=t,{alpha:E,computeFeatureInfluence:I,downsampleFactor:k,eta:S,etaGrowthRatePerTree:_,featureBagFraction:M,featureInfluenceThreshold:C,gamma:R,jobType:F,lambda:A,maxNumThreads:L,maxOptimizationRoundsPerHyperparameter:N,maxTrees:D,method:P,modelMemoryLimit:z,modelMemoryLimitValidationResult:q,nNeighbors:V,numTopClasses:W,numTopFeatureImportanceValues:B,numTopFeatureImportanceValuesValid:$,outlierFraction:J,predictionFieldName:U,randomizeSeed:H,softTreeDepthLimit:G,softTreeDepthTolerance:Q,useEstimatedMml:Y}=x,[X,Z]=Object(i.useState)([yt]),[K,ee]=Object(i.useState)(function(e){const t=[];return-1===e?t.push(yt):void 0!==e&&t.push({label:`${e}`}),t}(W)),te=K[0]&&(null!==(a=K[0].value)&&void 0!==a?a:Number(K[0].label)),ae=void 0!==(re=te)&&(isNaN(re)||re<-1||re-Math.floor(re)!=0);var re;const ie=Object(i.useMemo)((()=>Object(xt.a)(q)),[q]),se=F===T.b.REGRESSION||F===T.b.CLASSIFICATION,oe=null!==q&&(void 0!==q.invalidUnits||!0===q.required),le=ae||oe||Object.keys(r).length>0||!0===d||0===L;Object(i.useEffect)((()=>{m(!0),async function(){const{success:e,errorMessage:t,errorReason:n,expectedMemory:a}=await O(x),r={};e?z!==a&&(h(a),!0===Y&&j({modelMemoryLimit:a})):Object.values(T.a).forEach((e=>{t.includes(`[${e}]`)?r[e]=t:null!=n&&n.includes(`[${e}]`)&&(r[e]=n)})),m(!1),u(r)}()}),[E,k,S,_,M,C,R,A,L,N,D,P,V,W,B,J,H,G,Q,Y]);const ce=Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabel",{defaultMessage:"Compute feature influence"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabelHelpText",{defaultMessage:"Specify whether the feature influence calculation is enabled. Defaults to true."})},Object(b.jsx)(o.EuiSelect,{"data-test-subj":"mlAnalyticsCreateJobWizardComputeFeatureInfluenceLabelInput",options:[{value:"true",text:l.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceTrueValue",{defaultMessage:"True"})},{value:"false",text:l.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceFalseValue",{defaultMessage:"False"})}],value:I?"true":"false",hasNoInitialSelection:!1,onChange:e=>{j({computeFeatureInfluence:"true"===e.target.value})}}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdLabel",{defaultMessage:"Feature influence threshold"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdHelpText",{defaultMessage:"The minimum outlier score that a document needs to have in order to calculate its feature influence score. Value range: 0-1. Defaults to 0.1."}),isInvalid:void 0!==r[T.a.FEATURE_INFLUENCE_THRESHOLD],error:r[T.a.FEATURE_INFLUENCE_THRESHOLD]},Object(b.jsx)(o.EuiFieldNumber,{onChange:e=>j({featureInfluenceThreshold:""===e.target.value?void 0:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureInfluenceThresholdInput",min:0,max:1,step:.001,value:Et(C)})))),ue=Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesLabel",{defaultMessage:"Feature importance values"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesHelpText",{defaultMessage:"Specify the maximum number of feature importance values per document to return."}),isInvalid:!1===$,error:[...!1===$?[Object(b.jsx)(i.Fragment,null,l.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesErrorText",{defaultMessage:"Invalid maximum number of feature importance values."}))]:[]]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesInputAriaLabel",{defaultMessage:"Maximum number of feature importance values per document."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutnumTopFeatureImportanceValuesInput",isInvalid:!1===$,min:T.h,onChange:e=>j({numTopFeatureImportanceValues:""===e.target.value?void 0:+e.target.value}),step:1,value:Et(B)}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameLabel",{defaultMessage:"Prediction field name"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameHelpText",{defaultMessage:"Define the name of the prediction field in the results. The default is <dependent_variable>_prediction.",ignoreTag:!0})},Object(b.jsx)(o.EuiFieldText,{disabled:w,value:U,onChange:e=>j({predictionFieldName:e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardPredictionFieldNameInput"}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedLabel",{defaultMessage:"Randomize seed"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedText",{defaultMessage:"The seed for the random generator used to pick training data."}),isInvalid:void 0!==r[T.a.RANDOMIZE_SEED],error:r[T.a.RANDOMIZE_SEED]},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedInputAriaLabel",{defaultMessage:"The seed for the random generator used to pick training data."}),"data-test-subj":"mlAnalyticsCreateJobWizardRandomizeSeedInput",onChange:e=>j({randomizeSeed:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==H&&"number"!=typeof H,value:Et(H),step:1}))));return Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiTitle,{size:"xs"},Object(b.jsx)("h3",null,l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigSectionTitle",{defaultMessage:"Advanced configuration"}))),Object(b.jsx)(o.EuiFlexGrid,{columns:3},F===T.b.OUTLIER_DETECTION&&ce,se&&ue,F===T.b.CLASSIFICATION&&Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesLabel",{defaultMessage:"Top classes"}),helpText:Ot(te),isInvalid:0===te||ae,error:[...0===te?[(de=f,Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.zeroClassesMessage",defaultMessage:"To evaluate the {wikiLink}, select all classes or a value greater than the total number of categories.",values:{wikiLink:Object(b.jsx)(o.EuiLink,{href:de,target:"_blank",external:!0},l.i18n.translate("xpack.ml.dataframe.analytics.create.aucRocLabel",{defaultMessage:"AUC ROC"}))}}))]:[],...ae?[vt]:[]]},Object(b.jsx)(o.EuiComboBox,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesInputAriaLabel",{defaultMessage:"The number of categories for which the predicted probabilities are reported"}),singleSelection:!0,options:X,selectedOptions:K,onCreateOption:(e,t=[])=>{const n=e.trim().toLowerCase();if(""===n)return;const a={label:e};-1===t.findIndex((e=>e.label.trim().toLowerCase()===n))&&Z([...X,a]),ee([a])},onChange:e=>{ee(e)},isClearable:!0,isInvalid:void 0!==te&&te<-1,"data-test-subj":"mlAnalyticsCreateJobWizardnumTopClassesInput"}))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitLabel",{defaultMessage:"Model memory limit"}),isInvalid:null!==q,error:ie,helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitHelpText",{defaultMessage:"The approximate maximum amount of memory resources that are permitted for analytical processing."})},Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFieldText,{placeholder:void 0!==F?v.a[F]:v.a.outlier_detection,disabled:w||Y,value:Y?y:z||"",onChange:e=>j({modelMemoryLimit:e.target.value}),isInvalid:null!==q,"data-test-subj":"mlAnalyticsCreateJobWizardModelMemoryInput"}),Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(o.EuiSwitch,{disabled:w,name:"mlDataFrameAnalyticsUseEstimatedMml",label:l.i18n.translate("xpack.ml.dataframe.analytics.create.useEstimatedMmlLabel",{defaultMessage:"Use estimated model memory limit"}),checked:!0===Y,onChange:()=>j({useEstimatedMml:!Y}),"data-test-subj":"mlAnalyticsCreateJobWizardUseEstimatedMml"})))),Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFormRow,{label:l.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsLabel",{defaultMessage:"Maximum number of threads"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsHelpText",{defaultMessage:"The maximum number of threads to be used by the analysis. The default value is 1."}),isInvalid:0===L,error:0===L&&l.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsError",{defaultMessage:"The minimum value is 1."})},Object(b.jsx)(o.EuiFieldNumber,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsInputAriaLabel",{defaultMessage:"The maximum number of threads to be used by the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxNumThreadsInput",min:1,onChange:e=>j({maxNumThreads:""===e.target.value?void 0:+e.target.value}),step:1,value:Et(L)})))),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(o.EuiAccordion,{id:"hyper-parameters",buttonContent:Object(b.jsx)(o.EuiTitle,{size:"xs"},Object(b.jsx)("h3",null,l.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersSectionTitle",{defaultMessage:"Hyperparameters"}))),initialIsOpen:!1,"data-test-subj":"mlAnalyticsCreateJobWizardHyperParametersSection"},Object(b.jsx)(o.EuiFlexGrid,{columns:3},F===T.b.OUTLIER_DETECTION&&Object(b.jsx)(wt,{actions:e,state:t,advancedParamErrors:r}),se&&Object(b.jsx)(jt,{actions:e,state:t,advancedParamErrors:r}))),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(ne,{isDisabled:le,onClick:()=>{j({numTopClasses:!1===ae?te:void 0}),n(Ut.DETAILS)}}));var de};function kt(e){return"number"==typeof e?`${e}`:v.c}const Tt=({setCurrentStep:e,state:t})=>{const{form:n,isJobCreated:a}=t,{computeFeatureInfluence:r,dependentVariable:s,eta:c,featureBagFraction:u,featureInfluenceThreshold:d,gamma:m,jobType:p,lambda:f,method:h,maxNumThreads:g,maxTrees:j,modelMemoryLimit:x,nNeighbors:w,numTopClasses:y,numTopFeatureImportanceValues:O,outlierFraction:E,predictionFieldName:I,randomizeSeed:k,standardizationEnabled:S}=n,_=p===T.b.REGRESSION||p===T.b.CLASSIFICATION,M=[],C=[],R=[],F=[],A=[],L=[];return p===T.b.OUTLIER_DETECTION&&(M.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.computeFeatureInfluence",{defaultMessage:"Compute feature influence"}),description:r.toString()}),C.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureInfluenceThreshold",{defaultMessage:"Feature influence threshold"}),description:kt(d)}),R.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:`${x}`}),F.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.nNeighbors",{defaultMessage:"N neighbors"}),description:kt(w)},{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.outlierFraction",{defaultMessage:"Outlier fraction"}),description:kt(E)}),A.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.method",{defaultMessage:"Method"}),description:void 0!==h?h:v.c}),L.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.standardizationEnabled",{defaultMessage:"Standardization enabled"}),description:`${S}`})),_&&(M.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopFeatureImportanceValues",{defaultMessage:"Top feature importance values"}),description:`${O}`}),F.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.lambdaFields",{defaultMessage:"Lambda"}),description:kt(f)},{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.eta",{defaultMessage:"Eta"}),description:kt(c)}),C.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.predictionFieldName",{defaultMessage:"Prediction field name"}),description:I||`${s}_prediction`},{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.randomizedSeed",{defaultMessage:"Randomized seed"}),description:kt(k)}),A.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxTreesFields",{defaultMessage:"Max trees"}),description:kt(j)},{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureBagFraction",{defaultMessage:"Feature bag fraction"}),description:kt(u)}),R.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:`${x}`}),L.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.gamma",{defaultMessage:"Gamma"}),description:kt(m)})),p===T.b.CLASSIFICATION&&R.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopClasses",{defaultMessage:"Top classes"}),description:-1===y?l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.allClasses",{defaultMessage:"All classes"}):kt(y)}),void 0!==g&&M.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxNumThreads",{defaultMessage:"Maximum number of threads"}),description:`${g}`}),Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiTitle,{size:"xs"},Object(b.jsx)("h3",null,l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigDetailsTitle",{defaultMessage:"Advanced configuration"}))),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(o.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:M})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:C})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:R}))),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(o.EuiTitle,{size:"xs"},Object(b.jsx)("h3",null,l.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersDetailsTitle",{defaultMessage:"Hyperparameters"}))),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(o.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:F})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:A})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:L}))),Object(b.jsx)(o.EuiSpacer,null),!a&&Object(b.jsx)(o.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(Ut.ADVANCED)}},l.i18n.translate("xpack.ml.dataframe.analytics.create.advancedDetails.editButtonText",{defaultMessage:"Edit"})))},St=({actions:e,state:t,step:n,setCurrentStep:a,stepActivated:r})=>{const i=n===Ut.ADVANCED,s=n!==Ut.ADVANCED&&!0===r,l=`mlAnalyticsCreateJobWizardAdvancedStep${i?" active":""}${s?" summary":""}`;return Object(b.jsx)(o.EuiForm,{"data-test-subj":l},i&&Object(b.jsx)(It,{actions:e,state:t,setCurrentStep:a}),s&&Object(b.jsx)(Tt,{setCurrentStep:a,state:t}))},_t=({setCurrentStep:e,state:t})=>{const{form:n,isJobCreated:a}=t,{description:r,jobId:s,destinationIndex:c,resultsField:u}=n,d=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobId",{defaultMessage:"Job ID"}),description:s}];void 0!==u&&"string"==typeof u&&""!==u.trim()&&d.push({title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.resultsField",{defaultMessage:"Results field"}),description:u});const m=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobDescription",{defaultMessage:"Job description"}),description:r}],p=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.destIndex",{defaultMessage:"Destination index"}),description:c||""}];return Object(b.jsx)(i.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:d})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:m})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:p}))),Object(b.jsx)(o.EuiSpacer,null),!a&&Object(b.jsx)(o.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(Ut.DETAILS)}},l.i18n.translate("xpack.ml.dataframe.analytics.create.detailsDetails.editButtonText",{defaultMessage:"Edit"})))},Mt=({destIndexSameAsId:e,isJobCreated:t,setDestIndexSameAsId:n,label:a})=>Object(b.jsx)(o.EuiSwitch,{disabled:t,name:"mlCreationWizardUtilsJobIdAsDestIndexName",label:a,checked:!0===e,onChange:()=>n(!e),"data-test-subj":"mlCreationWizardUtilsJobIdAsDestIndexNameSwitch"}),Ct=({createIndexLink:e,destinationIndex:t,destinationIndexNameEmpty:n,destinationIndexNameExists:a,destinationIndexNameValid:r,destIndexSameAsId:i,fullWidth:c=!0,indexNameExistsMessage:u,isJobCreated:d,onDestinationIndexChange:m,setDestIndexSameAsId:p,switchLabel:f})=>Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFormRow,{fullWidth:c,helpText:!0===i&&a&&u},Object(b.jsx)(Mt,{destIndexSameAsId:i,isJobCreated:d,setDestIndexSameAsId:p,label:f})),!1===i&&Object(b.jsx)(o.EuiFormRow,{fullWidth:c,label:l.i18n.translate("xpack.ml.creationWizardUtils.destinationIndexLabel",{defaultMessage:"Destination index"}),isInvalid:n||!n&&!r,helpText:a&&u,error:!n&&!r&&[Object(b.jsx)(s.a.Fragment,null,l.i18n.translate("xpack.ml.creationWizardUtils.destinationIndexInvalidError",{defaultMessage:"Invalid destination index name."}),Object(b.jsx)("br",null),Object(b.jsx)(o.EuiLink,{href:e,target:"_blank"},l.i18n.translate("xpack.ml.creationWizardUtils.destinationIndexInvalidErrorLink",{defaultMessage:"Learn more about index name limitations."})))]},Object(b.jsx)(o.EuiFieldText,{fullWidth:c,disabled:d,placeholder:"destination index",value:t,onChange:e=>m(e.target.value),"aria-label":l.i18n.translate("xpack.ml.creationWizardUtils.destinationIndexInputAriaLabel",{defaultMessage:"Choose a unique destination index name."}),isInvalid:!n&&!r,"data-test-subj":"mlCreationWizardUtilsDestinationIndexInput"})));var Rt=n(42),Ft={name:"nmbbfz",styles:"> .euiFlexGroup{> .euiFlexItem{&:last-child{flex-basis:50%;}}}"};const At=Object(i.memo)((({children:e})=>{const{services:{docLinks:t}}=Object(g.d)(),n=t.links.ml.customUrls,a=l.i18n.translate("xpack.ml.dataframe.analytics.create.detailsStep.additionalSection.customUrls.title",{defaultMessage:"Custom URLs"}),r=Ft;return Object(b.jsx)(o.EuiDescribedFormGroup,{fullWidth:!0,css:r,title:Object(b.jsx)("h3",null,a),description:Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.detailsStep.additionalSection.customUrlsSelection.description",defaultMessage:"Provide links from analytics job results to Kibana dashboards, Discover, or other web pages. {learnMoreLink}",values:{learnMoreLink:Object(b.jsx)(o.EuiLink,{href:n,target:"_blank"},Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.detailsStep.additionalSection.customUrlsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},Object(b.jsx)(o.EuiFormRow,{fullWidth:!0},Object(b.jsx)(s.a.Fragment,null,e)))}));var Lt=n(275);const Nt=l.i18n.translate("xpack.ml.dataframe.analytics.create.detailsStep.additionalSectionButton",{defaultMessage:"Additional settings"}),Dt=({formState:e,setFormState:t})=>{var n;const[a,r]=Object(i.useState)(!1),{_meta:l}=e,c=Object(i.useMemo)((()=>Object(v.f)(e)),[e]);return Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(o.EuiAccordion,{id:"additional-section",buttonContent:Nt,onToggle:r,initialIsOpen:a,"data-test-subj":"mlJobWizardToggleAdditionalSettingsSection"},Object(b.jsx)("section",{"data-test-subj":"mlDataFrameAnalyticsDetailsStepAdditionalSection"},Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(At,null,Object(b.jsx)(Lt.a,{job:c,jobCustomUrls:null!==(n=null==l?void 0:l.custom_urls)&&void 0!==n?n:[],setCustomUrls:e=>{t({_meta:{...l,custom_urls:e}})},editMode:"modal",isPartialDFAJob:!0})))))},Pt=l.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexHelpText",{defaultMessage:"An index with this name already exists. Be aware that running this analytics job will modify this destination index."}),zt=({actions:e,state:t,setCurrentStep:n})=>{const{services:{docLinks:a,notifications:r}}=Object(g.d)(),s=E(),{dataViewAvailableTimeFields:c,onTimeFieldChanged:u}=k({actions:e,state:t}),m=a.links.apis.createIndex,{setFormState:h}=e,{form:j,cloneJob:x,hasSwitchedToEditor:y,isJobCreated:v}=t,{createDataView:O,description:I,destinationDataViewTitleExists:T,destinationIndex:S,destinationIndexNameEmpty:_,destinationIndexNameExists:M,destinationIndexNameValid:C,jobId:R,jobIdEmpty:F,jobIdExists:A,jobIdInvalidMaxLength:L,jobIdValid:N,resultsField:D,timeFieldName:P}=j,[z,q]=Object(i.useState)(!1===y&&void 0!==S&&S===R),[V,W]=Object(i.useState)(void 0===x&&!1===y&&void 0===D||void 0!==x&&"ml"===D),B=Object(i.useRef)(null),$=!0===F||!0===A||!1===N||!0===_||!1===C||O&&!0===T,J=Object(p.debounce)((async()=>{try{const e=await d.ml.checkIndicesExists({indices:[S]});h({destinationIndexNameExists:e[S].exists})}catch(e){r.toasts.addDanger(l.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingIndexExists",{defaultMessage:"The following error occurred getting the existing index names: {error}",values:{error:Object(f.a)(e)}}))}}),400),U=Object(i.useMemo)((()=>Object(p.debounce)((async()=>{try{const e=await d.ml.dataFrameAnalytics.jobsExist([R],!0);h({jobIdExists:e[R].exists})}catch(e){r.toasts.addDanger(l.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(f.a)(e)}}))}}),400)),[R]);return Object(i.useEffect)((()=>(!0===N?U():"string"==typeof R&&""===R.trim()&&!0===A&&h({jobIdExists:!1}),()=>{U.cancel()})),[R]),Object(i.useEffect)((()=>(!0===C?J():"string"==typeof S&&""===S.trim()&&!0===M&&h({destinationIndexNameExists:!1}),()=>{J.cancel()})),[S]),Object(i.useEffect)((()=>{!0===z&&!F&&N&&h({destinationIndex:R})}),[z,R]),Object(b.jsx)(i.Fragment,null,Object(b.jsx)(mt,{indexName:S,docsType:"start"}),Object(b.jsx)(o.EuiFormRow,{fullWidth:!0,label:l.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdLabel",{defaultMessage:"Job ID"}),isInvalid:!F&&!N||A||L,error:[...F||N?[]:[l.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...A?[l.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[],...L?[l.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:Rt.b}})]:[]]},Object(b.jsx)(o.EuiFieldText,{fullWidth:!0,inputRef:e=>{e&&(B.current=e)},disabled:v,placeholder:l.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdPlaceholder",{defaultMessage:"Job ID"}),value:R,onChange:e=>h({jobId:e.target.value}),"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!F&&!N||A||F,"data-test-subj":"mlAnalyticsCreateJobFlyoutJobIdInput"})),Object(b.jsx)(o.EuiFormRow,{fullWidth:!0,label:l.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.label",{defaultMessage:"Job description"})},Object(b.jsx)(o.EuiTextArea,{fullWidth:!0,value:I,placeholder:l.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.helpText",{defaultMessage:"Optional descriptive text"}),rows:2,onChange:e=>{const t=e.target.value;h({description:t})},"data-test-subj":"mlDFAnalyticsJobCreationJobDescription"})),Object(b.jsx)(Ct,{createIndexLink:m,destinationIndex:S,destinationIndexNameEmpty:_,destinationIndexNameExists:M,destinationIndexNameValid:C,destIndexSameAsId:z,indexNameExistsMessage:Pt,isJobCreated:v,onDestinationIndexChange:e=>h({destinationIndex:e}),setDestIndexSameAsId:q,switchLabel:l.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexFormSwitchLabel",{defaultMessage:"Use job ID as destination index name"})}),Object(b.jsx)(o.EuiFormRow,{fullWidth:!0},Object(b.jsx)(o.EuiSwitch,{disabled:v,name:"mlDataFrameAnalyticsUseResultsFieldDefault",label:l.i18n.translate("xpack.ml.dataframe.analytics.create.UseResultsFieldDefaultLabel",{defaultMessage:'Use results field default value: "{defaultValue}"',values:{defaultValue:"ml"}}),checked:!0===V,onChange:()=>{1==!V&&h({resultsField:void 0}),W(!V)},"data-test-subj":"mlAnalyticsCreateJobWizardUseResultsFieldDefault"})),!1===V&&Object(b.jsx)(o.EuiFormRow,{fullWidth:!0,label:l.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldLabel",{defaultMessage:"Results field"}),helpText:l.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldHelpText",{defaultMessage:"Define the name of the field in which to store the results of the analysis. Defaults to ml."})},Object(b.jsx)(o.EuiFieldText,{disabled:v,placeholder:"Results field",value:D,onChange:e=>h({resultsField:e.target.value}),"aria-label":l.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldInputAriaLabel",{defaultMessage:"The name of the field in which to store the results of the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardResultsFieldInput"})),Object(b.jsx)(w,{canCreateDataView:s,createDataView:O,dataViewTitleExists:T,setCreateDataView:()=>h({createDataView:!O}),dataViewAvailableTimeFields:c,dataViewTimeField:P,onTimeFieldChanged:u}),Object(b.jsx)(o.EuiSpacer,{size:"s"}),Object(b.jsx)(Dt,{formState:t.form,setFormState:h}),Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(ne,{isDisabled:$,onClick:()=>{n(Ut.VALIDATION)}}))},qt=({actions:e,state:t,setCurrentStep:n,step:a,stepActivated:r})=>{const i=a===Ut.DETAILS,s=a!==Ut.DETAILS&&!0===r,l=`mlAnalyticsCreateJobWizardDetailsStep${i?" active":""}${s?" summary":""}`;return Object(b.jsx)(o.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":l},i&&Object(b.jsx)(zt,{actions:e,state:t,setCurrentStep:n}),s&&Object(b.jsx)(_t,{setCurrentStep:n,state:t}))};var Vt=n(410);const Wt=({checksInProgress:e,validationMessages:t,setCurrentStep:n})=>{const a=t.map(((e,t)=>Object(b.jsx)(Vt.a,r()({key:`${e.id}_${t}`},e))));return Object(b.jsx)(s.a.Fragment,null,e&&Object(b.jsx)(o.EuiLoadingSpinner,{size:"xl"}),!e&&Object(b.jsx)(s.a.Fragment,null,a,Object(b.jsx)(o.EuiSpacer,null),Object(b.jsx)(ne,{isDisabled:!1,onClick:()=>{n(Ut.CREATE)}})))},Bt=({setCurrentStep:e,state:t,validationSummary:n})=>{const{isJobCreated:a}=t,r=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.successfulChecks",{defaultMessage:"Successful checks"}),description:Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiText,{size:"s"},n.success)),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiIcon,{type:"check"}))))}],i=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.warnings",{defaultMessage:"Warnings"}),description:Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{gutterSize:"xs"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiText,{size:"s"},n.warning)),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiIcon,{type:"warning"}))))}];return Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(o.EuiFlexGroup,{style:{width:"70%"}},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{compressed:!0,listItems:r})),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:i}))),Object(b.jsx)(o.EuiSpacer,null),!a&&Object(b.jsx)(o.EuiButtonEmpty,{size:"s",onClick:()=>{e(Ut.VALIDATION)}},l.i18n.translate("xpack.ml.dataframe.analytics.create.validationDetails.viewButtonText",{defaultMessage:"View"})))},$t=({state:e,setCurrentStep:t,step:n,stepActivated:a})=>{const[r,s]=Object(i.useState)(!1),[c,u]=Object(i.useState)([]),[d,m]=Object(i.useState)(),{form:h,jobConfig:j,isAdvancedEditorEnabled:x}=e,{dependentVariable:w,jobType:y,trainingPercent:O,numTopFeatureImportanceValues:E,numTopClasses:I,includes:k}=h,T=n===Ut.VALIDATION,S=n!==Ut.VALIDATION&&!0===a,{dataFrameAnalytics:{validateDataFrameAnalytics:_}}=Object(g.c)(),M=`mlAnalyticsCreateJobWizardValidationStepWrapper${T?" active":""}${S?" summary":""}`,C=Object(p.debounce)((async()=>{s(!0);try{const e=x?j:Object(v.f)(h),t=await _(e);u(t),m(void 0),s(!1)}catch(e){m({heading:l.i18n.translate("xpack.ml.dataframe.analytics.validation.validationFetchErrorMessage",{defaultMessage:"Error validating job"}),id:"error",status:Rt.c.ERROR,text:Object(f.a)(e)}),s(!1)}}),500);Object(i.useEffect)((function(){void 0===y||!T&&!0!==a||C()}),[T,w,O,E,I,k]),void 0!==d&&c.push(d);const R=Object(i.useMemo)((()=>c.reduce(((e,t)=>((null==t?void 0:t.status)===Rt.c.WARNING?e.warning+=1:(null==t?void 0:t.status)===Rt.c.SUCCESS&&(e.success+=1),e)),{warning:0,success:0})),[c]);return Object(b.jsx)(o.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":M},T&&Object(b.jsx)(Wt,{checksInProgress:r,validationMessages:c,setCurrentStep:t}),S&&Object(b.jsx)(Bt,{setCurrentStep:t,state:e,validationSummary:R}))};var Jt=n(134);let Ut=function(e){return e[e.CONFIGURATION=0]="CONFIGURATION",e[e.ADVANCED=1]="ADVANCED",e[e.DETAILS=2]="DETAILS",e[e.VALIDATION=3]="VALIDATION",e[e.CREATE=4]="CREATE",e}({});const Ht=({jobId:e})=>{const[t,n]=Object(i.useState)(Ut.CONFIGURATION),[a,s]=Object(i.useState)([!0,!1,!1,!1,!1]),{selectedDataView:p}=Object(u.b)(),f=Object(m.b)(),{state:h}=f,{isAdvancedEditorEnabled:g,disableSwitchToForm:j,isJobCreated:x}=h,{jobType:w}=h.form,{initiateWizard:y,setJobClone:v,switchToAdvancedEditor:O,switchToForm:E}=f.actions;Object(i.useEffect)((()=>{y(),p&&async function(){if(void 0!==e){const t=await d.ml.dataFrameAnalytics.getDataFrameAnalytics(e,!0);if(Array.isArray(t.data_frame_analytics)&&t.data_frame_analytics.length>0){const e=t.data_frame_analytics[0];await v(e)}}}()}),[]),Object(i.useEffect)((()=>{!1===a[t]&&(a.splice(t,1,!0),s(a))}),[t]);const I=[{title:l.i18n.translate("xpack.ml.dataframe.analytics.creation.configurationStepTitle",{defaultMessage:"Configuration"}),children:Object(b.jsx)(bt,r()({},f,{isClone:void 0!==e,setCurrentStep:n,step:t,stepActivated:a[Ut.CONFIGURATION],sourceDataViewTitle:p.getIndexPattern()})),status:t>=Ut.CONFIGURATION?void 0:"incomplete"},{title:l.i18n.translate("xpack.ml.dataframe.analytics.creation.advancedStepTitle",{defaultMessage:"Additional options"}),children:Object(b.jsx)(St,r()({},f,{setCurrentStep:n,step:t,stepActivated:a[Ut.ADVANCED]})),status:t>=Ut.ADVANCED?void 0:"incomplete"},{title:l.i18n.translate("xpack.ml.dataframe.analytics.creation.detailsStepTitle",{defaultMessage:"Job details"}),children:Object(b.jsx)(qt,r()({},f,{setCurrentStep:n,step:t,stepActivated:a[Ut.DETAILS]})),status:t>=Ut.DETAILS?void 0:"incomplete"},{title:l.i18n.translate("xpack.ml.dataframe.analytics.creation.validationStepTitle",{defaultMessage:"Validation"}),children:Object(b.jsx)($t,r()({},f,{setCurrentStep:n,step:t,stepActivated:a[Ut.VALIDATION]})),status:t>=Ut.VALIDATION?void 0:"incomplete"},{title:l.i18n.translate("xpack.ml.dataframe.analytics.creation.createStepTitle",{defaultMessage:"Create"}),children:Object(b.jsx)(N,r()({},f,{step:t})),status:t>=Ut.CREATE?void 0:"incomplete"}];return Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsCreationContainer"},Object(b.jsx)(Jt.a,null,Object(b.jsx)("span",{"data-test-subj":"mlDataFrameAnalyticsWizardHeaderTitle"},void 0===e&&Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageTitle",defaultMessage:"Create job"}),void 0!==e&&Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.clone.creationPageTitle",defaultMessage:"Clone job from {jobId}",values:{jobId:e}}))),Object(b.jsx)(o.EuiPageBody,{restrictWidth:1200},Object(b.jsx)(o.EuiFlexGroup,null,Object(b.jsx)(o.EuiFlexItem,null,Object(b.jsx)(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)("h2",null,Object(b.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageSourceIndexTitle",defaultMessage:"Source data view: {dataViewTitle}",values:{dataViewTitle:p.getIndexPattern()}}))))),Object(b.jsx)(o.EuiFlexItem,{grow:!1},Object(b.jsx)(o.EuiFormRow,{helpText:j&&l.i18n.translate("xpack.ml.dataframe.analytics.create.jsonEditorDisabledSwitchText",{defaultMessage:"Configuration contains advanced fields not supported by the form. You cannot switch back to the form."})},Object(b.jsx)(o.EuiSwitch,{disabled:void 0===w||j||x,label:l.i18n.translate("xpack.ml.dataframe.analytics.create.switchToJsonEditorSwitch",{defaultMessage:"Switch to json editor"}),checked:g,onChange:e=>{!0===e.target.checked?O():E()},"data-test-subj":"mlAnalyticsCreateJobWizardAdvancedEditorSwitch"})))),Object(b.jsx)(o.EuiSpacer,null),!0===g&&Object(b.jsx)(P,f),!1===g&&Object(b.jsx)(o.EuiSteps,{"data-test-subj":"mlAnalyticsCreateJobWizardSteps",steps:I})))}}}]);