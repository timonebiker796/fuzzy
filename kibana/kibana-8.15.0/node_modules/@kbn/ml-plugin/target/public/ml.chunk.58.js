/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[58,23,61,77],{138:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n(2);t.default=function(){var e=l.useRef(!1),t=l.useCallback((function(){return e.current}),[]);return l.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},143:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var l=n(120),a=n.n(l),o=n(2),i=n(88),r=n(149),s=n(26),c=n.n(s),u=n(84),d=n.n(u),b=n(25);const j="eui-global",f="eui-utilities",p={darkMode:!1};var m=n(6);const v=[b.euiStylisPrefixer],O=d()({key:"css",stylisPlugins:v,container:document.querySelector('meta[name="emotion"]')}),y=d()({key:j,stylisPlugins:v,container:document.querySelector(`meta[name="${j}"]`)}),g=d()({key:f,stylisPlugins:v,container:document.querySelector(`meta[name="${f}"]`)});O.compat=!0,y.compat=!0,g.compat=!0;const x={default:O,global:y,utility:g},h=({theme:{theme$:e},globalStyles:t,colorMode:n,modify:l,children:a})=>{const i=c()(e,p),r=Object(o.useMemo)((()=>(e=>e.darkMode?b.COLOR_MODES_STANDARD.dark:b.COLOR_MODES_STANDARD.light)(i)),[i]),s=n||r,u=!1!==t&&void 0;return Object(m.jsx)(b.EuiProvider,{cache:x,modify:l,colorMode:s,globalStyles:u,utilityClasses:u},a)},E=({children:e,i18n:t,...n})=>Object(i.useIsNestedEuiProvider)()?(Object(r.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(m.jsx)(t.Context,null,e)):Object(m.jsx)(h,n,Object(m.jsx)(t.Context,null,e));var w=n(89);const S=({children:e,...t})=>Object(m.jsx)(E,a()({globalStyles:!1},t),Object(m.jsx)(w.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(m.jsx)(w.KibanaErrorBoundary,null,e)))},149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var l=void 0;t.setEuiDevProviderWarning=function(e){return l=e},t.getEuiDevProviderWarning=function(){return l},t.emitEuiProviderWarning=function(e){if("function"==typeof l)return l(e);switch(l){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},155:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var l=n(2),a=n(79),o=n.n(a),i=n(143),r=n(6);const s=(e,t)=>n=>(o.a.render(Object(r.jsx)(i.a,t,e),n),()=>o.a.unmountComponentAtNode(n));n(4),n(5),l.Component},168:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var l=n(2),a=n(5),o=n(15),i=n(25),r=n(138),s=n.n(r),c=n(10),u=n(13),d=n(6);const b=({jobsAndGroupIds:e,onChange:t,adJobsApiService:n,errors:r,multiSelect:b=!1,label:j,allowSelectAll:f=!1,createJobUrl:p,options:m})=>{const{services:{notifications:{toasts:v},application:{navigateToUrl:O}}}=Object(c.d)(),y=s()(),[g,x]=Object(l.useState)([]),h=Object(l.useMemo)((()=>new Set),[]),E=Object(l.useMemo)((()=>new Set),[]),w=Object(l.useMemo)((()=>(null!=e?e:[]).map((e=>({label:e})))),[e]),S=Object(l.useCallback)((async()=>{try{const{jobIds:e,groupIds:t}=await n.getAllJobAndGroupIds();if(e.forEach((e=>{h.add(e)})),t.forEach((e=>{E.add(e)})),!y())return;x([...f?[{label:a.i18n.translate("xpack.ml.jobSelector.selectAllGroupLabel",{defaultMessage:"Select all"}),options:[{label:a.i18n.translate("xpack.ml.jobSelector.selectAllOptionLabel",{defaultMessage:"*"}),value:u.e}]}]:[],{label:a.i18n.translate("xpack.ml.jobSelector.jobOptionsLabel",{defaultMessage:"Jobs"}),options:[...p?[{label:a.i18n.translate("xpack.ml.jobSelector.createNewLabel",{defaultMessage:"--- Create new ---"}),value:"createNew"}]:[],...e.map((e=>({label:e})))]},...b?[{label:a.i18n.translate("xpack.ml.jobSelector.groupOptionsLabel",{defaultMessage:"Groups"}),options:t.map((e=>({label:e})))}]:[]])}catch(e){v.addError(e,{title:a.i18n.translate("xpack.ml.jobSelector.fetchJobErrorTitle",{defaultMessage:"Failed to load anomaly detection jobs"})})}}),[n,f,p,E,y,h,b,v]),C=Object(l.useCallback)((async e=>{if(e.some((e=>e.value===u.e)))return void t({jobIds:[u.e]});if(p&&e.some((e=>"createNew"===e.value)))return void await O(p);const n=[],l=[];e.forEach((({label:e})=>{h.has(e)?n.push(e):E.has(e)?l.push(e):null!=m&&m.some((t=>{var n;return null===(n=t.options)||void 0===n?void 0:n.some((t=>t.label===e))}))&&n.push(e)})),t({...n.length>0?{jobIds:n}:{},...l.length>0?{groupIds:l}:{}})}),[h,E,m,p]);return Object(l.useEffect)((()=>{m||S()}),[p]),Object(d.jsx)(i.EuiFormRow,{"data-test-subj":"mlAnomalyJobSelectionControls",fullWidth:!0,label:null!=j?j:Object(d.jsx)(o.FormattedMessage,{id:"xpack.ml.jobSelector.formControlLabel",defaultMessage:"Select job"}),isInvalid:!(null==r||!r.length),error:r},Object(d.jsx)(i.EuiComboBox,{singleSelection:!b,selectedOptions:w,options:null!=m?m:g,onChange:C,fullWidth:!0,"data-test-subj":"mlAnomalyAlertJobSelection",isInvalid:!(null==r||!r.length)}))}},222:function(e,t,n){"use strict";n.r(t),n.d(t,"apiCanAddNewPanel",(function(){return l})),n.d(t,"apiHasRuntimeChildState",(function(){return o})),n.d(t,"apiHasSerializedChildState",(function(){return a})),n.d(t,"apiHasSaveNotification",(function(){return i})),n.d(t,"apiCanDuplicatePanels",(function(){return r})),n.d(t,"apiCanExpandPanels",(function(){return s})),n.d(t,"apiIsPresentationContainer",(function(){return d})),n.d(t,"getContainerParentFromAPI",(function(){return b})),n.d(t,"listenForCompatibleApi",(function(){return j})),n.d(t,"combineCompatibleChildrenApis",(function(){return f})),n.d(t,"apiHasSerializableState",(function(){return p})),n.d(t,"tracksOverlays",(function(){return m})),n.d(t,"canTrackContentfulRender",(function(){return v}));const l=e=>"function"==typeof(null==e?void 0:e.addNewPanel),a=e=>Boolean(e&&e.getSerializedStateForChild),o=e=>Boolean(e&&e.getRuntimeStateForChild),i=e=>Boolean(e&&e.saveNotification$),r=e=>Boolean(void 0!==(null==e?void 0:e.duplicatePanel)),s=e=>Boolean(void 0!==(null==e?void 0:e.expandPanel));var c=n(136),u=n(7);const d=e=>Boolean(l(e)&&"function"==typeof(null==e?void 0:e.removePanel)&&"function"==typeof(null==e?void 0:e.replacePanel)&&"function"==typeof(null==e?void 0:e.addNewPanel)&&(null==e?void 0:e.children$)),b=e=>{const t=Object(c.b)(e)?e.parentApi:null;if(t)return d(t)?t:void 0},j=(e,t,n)=>{if(!e||!d(e))return()=>{};let l,a;const o=e.children$.subscribe((o=>{var i,r;null===(i=l)||void 0===i||i();const s=(()=>{for(const e of Object.keys(o)){const n=o[e];if(t(n))return n}if(t(e))return e})(),u=Object(c.d)(s)?s.uuid:null;u!==a&&(a=u,l=null!==(r=n(s))&&void 0!==r?r:void 0)}));return()=>{var e;o.unsubscribe(),null===(e=l)||void 0===e||e()}},f=(e,t,n,l,a)=>e&&d(e)?e.children$.pipe(Object(u.switchMap)((e=>{const o=[];for(const l of Object.values(e))n(l)&&Object(u.isObservable)(l[t])&&o.push(l[t]);return 0===o.length?Object(u.of)(l):Object(u.combineLatest)(o).pipe(Object(u.map)(a||(e=>e.flat().filter((e=>Boolean(e))))))}))):Object(u.of)(),p=e=>Boolean(null==e?void 0:e.serializeState),m=e=>Boolean(e&&e.openOverlay&&e.clearOverlays),v=e=>null!==e&&"object"==typeof e&&"trackContentfulRender"in e},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var l=n(5);const a=e=>{if(0===e.length)return[l.i18n.translate("xpack.ml.swimlaneEmbeddable.setupModal.jobSelectionRequiredError",{defaultMessage:"Job selection is required"})]}},269:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var l=n(5);const a=e=>l.i18n.translate("xpack.ml.swimlaneEmbeddable.title",{defaultMessage:"ML anomaly swim lane for {jobIds}",values:{jobIds:e.join(", ")}})},816:function(e,t,n){"use strict";n.r(t),n.d(t,"resolveAnomalySwimlaneUserInput",(function(){return w}));var l=n(21),a=n(222),o=n(155),i=n(2),r=n.n(i),s=n(12),c=n(52),u=n(25),d=n(15),b=n(5),j=n(138),f=n.n(j),p=n(10),m=n(1),v=n(123),O=n(168),y=n(132),g=n(269),x=n(225),h=n(6);const E=({onCreate:e,onCancel:t,initialInput:n,adJobsApiService:l})=>{var a,o,s;const c=f()(),j=Object(i.useRef)(!(null==n||!n.title)),[E,w]=Object(i.useState)(null!==(a=null==n?void 0:n.jobIds)&&void 0!==a?a:[]),[S,C]=Object(i.useState)([y.j]);Object(i.useEffect)((function(){E.length>0&&async function(){const e=await l.jobs(E);c()&&C([...Object(v.h)(e),y.j])}()}),[l,c,E]);const[M,k]=Object(i.useState)(null!==(o=null==n?void 0:n.title)&&void 0!==o?o:""),[P,A]=Object(i.useState)(null!==(s=null==n?void 0:n.swimlaneType)&&void 0!==s?s:y.h.OVERALL),[I,F]=Object(i.useState)(null==n?void 0:n.viewBy);Object(i.useEffect)((function(){j.current||k(Object(g.a)(E))}),[null==n?void 0:n.title,E]);const B=[{id:y.h.OVERALL,label:b.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"})},{id:y.h.VIEW_BY,label:b.i18n.translate("xpack.ml.explorer.viewByLabel",{defaultMessage:"View by"})}],L=["",...S].map((e=>({value:e,text:e}))),R=M.length>0,T=Object(x.a)(E),W=R&&!T&&(P===y.h.OVERALL||P===y.h.VIEW_BY&&!!I),_={jobIds:E,panelTitle:M,swimlaneType:P,...I?{viewBy:I}:{}},N=Object(p.f)({page:m.b.ANOMALY_DETECTION_CREATE_JOB});return Object(h.jsx)(r.a.Fragment,null,Object(h.jsx)(u.EuiFlyoutHeader,null,Object(h.jsx)(u.EuiTitle,null,Object(h.jsx)("h2",null,Object(h.jsx)(d.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.title",defaultMessage:"Anomaly swim lane configuration"})))),Object(h.jsx)(u.EuiFlyoutBody,null,Object(h.jsx)(u.EuiForm,null,Object(h.jsx)(O.a,{createJobUrl:N,multiSelect:!0,jobsAndGroupIds:E,adJobsApiService:l,onChange:e=>{var t,n;w([...null!==(t=null==e?void 0:e.jobIds)&&void 0!==t?t:[],...null!==(n=null==e?void 0:e.groupIds)&&void 0!==n?n:[]])},errors:T}),Object(h.jsx)(u.EuiFormRow,{label:Object(h.jsx)(d.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.panelTitleLabel",defaultMessage:"Panel title"}),isInvalid:!R,fullWidth:!0},Object(h.jsx)(u.EuiFieldText,{id:"panelTitle",name:"panelTitle",value:M,onChange:e=>{j.current=!0,k(e.target.value)},isInvalid:!R,fullWidth:!0})),Object(h.jsx)(u.EuiFormRow,{label:Object(h.jsx)(d.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.swimlaneTypeLabel",defaultMessage:"Swim lane type"}),fullWidth:!0},Object(h.jsx)(u.EuiButtonGroup,{id:"selectSwimlaneType",name:"selectSwimlaneType",color:"primary",isFullWidth:!0,legend:b.i18n.translate("xpack.ml.swimlaneEmbeddable.setupModal.swimlaneTypeLabel",{defaultMessage:"Swim lane type"}),options:B,idSelected:P,onChange:e=>A(e)})),P===y.h.VIEW_BY&&Object(h.jsx)(r.a.Fragment,null,Object(h.jsx)(u.EuiFormRow,{label:Object(h.jsx)(d.FormattedMessage,{id:"xpack.ml.explorer.viewByLabel",defaultMessage:"View by"}),fullWidth:!0},Object(h.jsx)(u.EuiSelect,{fullWidth:!0,id:"selectViewBy",name:"selectViewBy",options:L,value:I,onChange:e=>F(e.target.value)}))))),Object(h.jsx)(u.EuiFlyoutFooter,null,Object(h.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(h.jsx)(u.EuiFlexItem,{grow:!1},Object(h.jsx)(u.EuiButtonEmpty,{onClick:t},Object(h.jsx)(d.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(h.jsx)(u.EuiFlexItem,{grow:!1},Object(h.jsx)(u.EuiButton,{isDisabled:!W,onClick:e.bind(null,_),fill:!0},Object(h.jsx)(d.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.confirmButtonLabel",defaultMessage:"Confirm"}))))))};async function w(e,t,n,i){const{http:r,overlays:u,...d}=e,b=Object(a.tracksOverlays)(t)?t:void 0;return new Promise((async(j,f)=>{try{const p=Object(c.jobsApiProvider)(new s.a(r)),m=u.openFlyout(Object(o.a)(Object(h.jsx)(l.KibanaContextProvider,{services:{...e}},Object(h.jsx)(E,{adJobsApiService:p,initialInput:i,onCreate:e=>{j(e),m.close(),null==b||b.clearOverlays()},onCancel:()=>{f(),m.close(),null==b||b.clearOverlays()}})),d),{type:"push",ownFocus:!0,size:"s",onClose:()=>{f(),m.close(),null==b||b.clearOverlays()}});Object(a.tracksOverlays)(t)&&t.openOverlay(m,{focusedPanelId:n})}catch(e){f(e)}}))}}}]);