/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[72],{160:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a(26),n=a.n(s),i=a(7),c=a(2),l=a(517),r=a(417),o=a(153);const u=()=>{const e=Object(l.c)(),t=()=>{const{from:t,to:a}=e.getTime();return{start:t,end:a}},a=Object(c.useMemo)((()=>Object(i.merge)(r.a,e.getTimeUpdate$().pipe(Object(i.map)((()=>({lastRefresh:Date.now(),timeRange:t()})))),o.b.pipe(Object(i.map)((e=>({lastRefresh:e})))))),[]);return n()(a)}},188:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return j}));var s=a(2),n=a.n(s),i=a(25),c=a(15),l=a(28),r=a(122),o=a(6);const u=({jobCount:e})=>{const{showNodeInfo:t}=Object(r.d)();return!1===t||!1===Object(l.b)()||0===e?null:Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiCallOut,{title:Object(o.jsx)(c.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(o.jsx)("div",null,Object(o.jsx)(c.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"{jobCount, plural, one {# job} other {# jobs}} will start after autoscaling has increased ML capacity. This may take several minutes.",values:{jobCount:e}}))),Object(o.jsx)(i.EuiSpacer,{size:"m"}))},j=()=>{const{showNodeInfo:e}=Object(r.d)();return!1===Object(l.b)()?null:e?Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiCallOut,{title:Object(o.jsx)(c.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(o.jsx)("div",null,Object(o.jsx)(c.FormattedMessage,{id:"xpack.ml.newJobAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There are currently no nodes that can run the job, therefore it will remain in OPENING state until autoscaling increases ML capacity. This may take several minutes."}))),Object(o.jsx)(i.EuiSpacer,{size:"m"})):Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiCallOut,{title:Object(o.jsx)(c.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.serverless.title",defaultMessage:"Machine learning is starting..."}),color:"primary",iconType:"iInCircle"}),Object(o.jsx)(i.EuiSpacer,{size:"m"}))};a(44)},209:function(e,t,a){"use strict";var s=a(163);a.d(t,"a",(function(){return s.a}))},227:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a(6),n=(a(2),a(25));const i=({stat:e})=>{const{euiTheme:t}=Object(n.useEuiTheme)();return Object(s.jsx)("span",{css:Object(s.css)({marginRight:t.size.s},"","")},Object(s.jsx)("span",null,e.label),":"," ",Object(s.jsx)("strong",null,Object(s.jsx)("span",{"data-test-subj":`mlStatsBarStat ${e.label.toLowerCase()} value`},e.value)))},c=({stats:e,dataTestSub:t})=>{const{euiTheme:a}=Object(n.useEuiTheme)(),c=Object.keys(e).map((t=>e[t]));return Object(s.jsx)("div",{css:Object(s.css)({padding:a.size.m,backgroundColor:a.colors.lightestShade},"",""),"data-test-subj":t},c.filter((e=>e.show)).map((e=>Object(s.jsx)(i,{key:e.label,stat:e}))))}},873:function(e,t,a){"use strict";a.r(t),a.d(t,"Page",(function(){return N}));var s=a(2),n=a.n(s),i=a(22),c=a(15),l=a(68),r=a(5),o=a(25),u=a(218),j=a(148),b=a(70),d=a(10),m=a(1),O=a(164),g=a(274),f=a(387),p=a(498),v=a(227),x=a(6);const h=({isDisabled:e,navigateToSourceSelection:t})=>{const a=Object(x.jsx)(o.EuiButton,{disabled:e,fill:!0,onClick:()=>{t()},iconType:"plusInCircle",size:"s","data-test-subj":"mlAnalyticsButtonCreate"},r.i18n.translate("xpack.ml.dataframe.analyticsList.createDataFrameAnalyticsButton",{defaultMessage:"Create job"}));return e?Object(x.jsx)(o.EuiToolTip,{position:"top",content:Object(b.createPermissionFailureMessage)("canCreateDataFrameAnalytics")},a):a};var y=a(135),S=a(244),A=a(251),T=a(188),w=a(160);const C=[{type:"field_value_selection",field:"job_type",name:r.i18n.translate("xpack.ml.dataframe.analyticsList.typeFilter",{defaultMessage:"Type"}),multiSelect:"or",options:Object.values(u.b).map((e=>({value:e,name:e,view:Object(f.b)(e)})))},{type:"field_value_selection",field:"state",name:r.i18n.translate("xpack.ml.dataframe.analyticsList.statusFilter",{defaultMessage:"Status"}),multiSelect:"or",options:Object.values(u.c).map((e=>({value:e,name:e,view:Object(f.c)(e)})))}],E=({isMlEnabledInSpace:e=!0,blockRefresh:t=!1,pageState:a,updatePageState:n})=>{var i;const c=Object(d.h)(),l=null!==(i=a.queryText)&&void 0!==i?i:"",u=Object(s.useCallback)((e=>{n({queryText:e})}),[n]),[E,M]=Object(s.useState)(!1),[I,F]=Object(s.useState)(!1),[k,_]=Object(s.useState)([]),[L,R]=Object(s.useState)(),[N,D]=Object(s.useState)([]),[z,B]=Object(s.useState)(void 0),[P,J]=Object(s.useState)([]),[q,W]=Object(s.useState)(void 0),[G,$]=Object(s.useState)(0),U=Object(w.a)(),[Y,Q]=Object(b.usePermissionCheck)(["canCreateDataFrameAnalytics","canStartStopDataFrameAnalytics"]),H=!Y||!Q,K=Object(g.d)(D,B,W,M,$,t),V=Object(s.useCallback)((e=>{if(e.length){const t=function(e,t){if(0===t.length)return e;const a=e.reduce(((e,t)=>(e[t.id]={job:t,count:0},e)),{});return t.forEach((t=>{const s="must"===t.match;let n=[];n="term"===t.type?!0===s?e.filter((e=>{var a,n;return Object(y.h)(e.id,t.value)===s||Object(y.h)(e.config.description,t.value)===s||Object(y.h)(null===(a=e.stats)||void 0===a||null===(n=a.memory_usage)||void 0===n?void 0:n.status,t.value)===s})):e.filter((e=>{var a,n;return Object(y.h)(e.id,t.value)===s&&Object(y.h)(e.config.description,t.value)===s&&Object(y.h)(null===(a=e.stats)||void 0===a||null===(n=a.memory_usage)||void 0===n?void 0:n.status,t.value)===s})):Array.isArray(t.value)?e.filter((e=>t.value.includes(e[t.field]))):e.filter((e=>e[t.field]===t.value)),n.forEach((e=>a[e.id].count++))})),Object.values(a).filter((e=>(e&&e.count)>=t.length)).map((e=>e.job))}(N,e);_(t)}else _(N)}),[N]);Object(s.useEffect)((()=>{(()=>{if(""!==l){const e=o.EuiSearchBar.Query.parse(l);let t=[];e&&void 0!==e.ast&&void 0!==e.ast.clauses&&(t=e.ast.clauses),V(t)}else V([])})()}),[l]);const X=Object(s.useCallback)((()=>K(!0)),[]),{refresh:Z}=Object(j.m)({isLoading:F,onRefresh:X});Object(s.useEffect)((function(){X()}),[U]);const{columns:ee,modals:te}=Object(f.e)(P,J,e,Z),{onTableChange:ae,pagination:se,sorting:ne}=Object(A.a)(k.length,a,n),ie=Object(s.useCallback)((async()=>{await c(m.b.DATA_FRAME_ANALYTICS_SOURCE_SELECTION)}),[]);if(!E)return null;if(void 0!==q)return Object(x.jsx)(o.EuiCallOut,{title:r.i18n.translate("xpack.ml.dataFrame.analyticsList.errorPromptTitle",{defaultMessage:"An error occurred getting the data frame analytics list."}),color:"danger",iconType:"warning"},Object(x.jsx)("pre",null,JSON.stringify(q)));if(0===N.length)return Object(x.jsx)("div",{"data-test-subj":"mlAnalyticsJobList"},Object(x.jsx)(o.EuiSpacer,{size:"m"}),Object(x.jsx)(S.a,null));const ce=(le=N,P.reduce(((e,t)=>{const a=le.find((e=>e.config.id===t));return void 0!==a&&(e[t]=Object(x.jsx)(p.a,{item:a})),e}),{}));var le;const re=z&&Object(x.jsx)(o.EuiFlexItem,{grow:!1},Object(x.jsx)(v.a,{stats:z,dataTestSub:"mlAnalyticsStatsBar"})),oe={query:l,onChange:e=>{null===e.error?(R(void 0),u(e.queryText)):R(e.error.message)},box:{incremental:!0},filters:C};return Object(x.jsx)("div",{"data-test-subj":"mlAnalyticsJobList"},te,Object(x.jsx)(T.a,{jobCount:G}),Object(x.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},re,Object(x.jsx)(o.EuiFlexItem,{grow:!1},Object(x.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(x.jsx)(o.EuiFlexItem,{grow:!1},Object(x.jsx)(h,{isDisabled:H,navigateToSourceSelection:ie}))))),Object(x.jsx)(o.EuiSpacer,{size:"m"}),Object(x.jsx)("div",{"data-test-subj":"mlAnalyticsTableContainer"},Object(x.jsx)(o.EuiInMemoryTable,{allowNeutralSort:!1,columns:ee,itemIdToExpandedRowMap:ce,items:N,itemId:O.b.id,loading:I,onTableChange:ae,pagination:se,sorting:ne,search:oe,"data-test-subj":I?"mlAnalyticsTable loading":"mlAnalyticsTable loaded",rowProps:e=>({"data-test-subj":`mlAnalyticsTableRow row-${e.id}`}),error:L})))};var M=a(250);var I=a(51),F=a(169),k=a(209),_=a(491),L=a(142),R=a(134);const N=()=>{var e,t;const[a,r]=Object(s.useState)(!1),[o]=Object(l.d)("_g"),[u,b]=Object(l.c)(m.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,{pageIndex:0,pageSize:10,sortField:O.b.id,sortDirection:"asc"});(e=>{const{services:t}=Object(d.d)(),[a]=Object(l.d)("_g"),{timefilter:n}=t.data.query.timefilter,{refresh:i}=Object(j.m)();Object(s.useEffect)((()=>{let t=null;const s=n.getRefreshIntervalUpdate$().subscribe(c);function c(){const{value:a,pause:s}=n.getRefreshInterval();s?l():function(a){if(l(),a>=M.e){e(!1);const s=window.setInterval((()=>{i()}),a);t=s}}(a),i()}function l(){e(!0),null!==t&&window.clearInterval(t)}return n.disableTimeRangeSelector(),n.enableAutoRefreshSelector(),function(){var e;const t=null!==(e=null==a?void 0:a.refreshInterval)&&void 0!==e?e:n.getRefreshInterval(),{pause:s,value:i}=t;!0!==s&&0!==i||n.setRefreshInterval({pause:!1,value:M.d}),c()}(),()=>{s.unsubscribe(),l()}}),[])})(r);const[g,f]=Object(s.useState)(!1),{refresh:p}=Object(j.m)({isLoading:f}),v=Object(i.useLocation)(),h=Object(s.useMemo)((()=>v.pathname.split("/").pop()),[v]),y=null==o||null===(e=o.ml)||void 0===e?void 0:e.jobId,S=null==o||null===(t=o.ml)||void 0===t?void 0:t.modelId,{services:{docLinks:A}}=Object(d.d)(),T=A.links.ml.dataFrameAnalytics;return Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(R.a,null,Object(x.jsx)(c.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.title",defaultMessage:"Data Frame Analytics Jobs"})),Object(x.jsx)(I.b,null),Object(x.jsx)(F.a,{onCloseFlyout:p,forceRefresh:g}),Object(x.jsx)(k.a,null),"map"===h&&(y||S)&&Object(x.jsx)(_.JobMap,{analyticsId:y,modelId:S}),"data_frame_analytics"===h&&Object(x.jsx)(E,{blockRefresh:a,pageState:u,updatePageState:b}),Object(x.jsx)(L.a,{docLink:T}))}}}]);