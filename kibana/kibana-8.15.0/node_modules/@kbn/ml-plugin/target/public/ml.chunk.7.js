/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[7],{183:function(e,a,t){"use strict";t.d(a,"a",(function(){return l})),t.d(a,"b",(function(){return c})),t.d(a,"c",(function(){return m})),t.d(a,"e",(function(){return u})),t.d(a,"f",(function(){return p})),t.d(a,"d",(function(){return _}));var n=t(423),i=t(218),o=t(204),r=t(70),s=t(28),d=t(146);let l=function(e){return e.regression="100mb",e.outlier_detection="50mb",e.classification="100mb",e}({});const c=0,m="--",u=()=>({advancedEditorMessages:[],advancedEditorRawString:"",disableSwitchToForm:!1,form:{alpha:void 0,computeFeatureInfluence:!0,createDataView:!0,classAssignmentObjective:void 0,dependentVariable:"",description:"",destinationIndex:"",destinationIndexNameExists:!1,destinationIndexNameEmpty:!0,destinationIndexNameValid:!1,destinationDataViewTitleExists:!1,earlyStoppingEnabled:void 0,downsampleFactor:void 0,eta:void 0,etaGrowthRatePerTree:void 0,featureBagFraction:void 0,featureInfluenceThreshold:void 0,featureProcessors:void 0,gamma:void 0,includes:[],jobId:"",jobIdExists:!1,jobIdEmpty:!0,jobIdInvalidMaxLength:!1,jobIdValid:!1,jobType:void 0,jobConfigQuery:d.e,jobConfigQueryString:void 0,jobConfigQueryLanguage:void 0,lambda:void 0,lossFunction:void 0,lossFunctionParameter:void 0,loadingFieldOptions:!1,maxNumThreads:1,maxOptimizationRoundsPerHyperparameter:void 0,maxTrees:void 0,_meta:void 0,method:void 0,modelMemoryLimit:void 0,modelMemoryLimitUnitValid:!0,modelMemoryLimitValidationResult:null,nNeighbors:void 0,numTopFeatureImportanceValues:c,numTopFeatureImportanceValuesValid:!0,numTopClasses:-1,outlierFraction:void 0,predictionFieldName:void 0,previousJobType:null,requiredFieldsError:void 0,randomizeSeed:void 0,resultsField:void 0,runtimeMappings:void 0,runtimeMappingsUpdated:!1,previousRuntimeMapping:void 0,softTreeDepthLimit:void 0,softTreeDepthTolerance:void 0,sourceIndex:"",sourceIndexNameEmpty:!0,sourceIndexNameValid:!1,sourceIndexContainsNumericalFields:!0,sourceIndexFieldsCheckFailed:!1,standardizationEnabled:!0,timeFieldName:void 0,trainingPercent:80,useEstimatedMml:!0},jobConfig:{},disabled:!Object(s.c)()||!Object(r.checkPermission)("canCreateDataFrameAnalytics")||!Object(r.checkPermission)("canStartStopDataFrameAnalytics"),dataViewsMap:{},isAdvancedEditorEnabled:!1,isAdvancedEditorValidJson:!0,hasSwitchedToEditor:!1,isJobCreated:!1,isJobStarted:!1,isValid:!1,jobIds:[],requestMessages:[],estimatedModelMemoryLimit:""}),p=e=>{const a={description:e.description,_meta:e._meta,source:{index:e.sourceIndex.includes(",")?e.sourceIndex.split(",").map((e=>e.trim())):e.sourceIndex,query:e.jobConfigQuery,...Object(n.a)(e.runtimeMappings)?{runtime_mappings:e.runtimeMappings}:{}},dest:{index:e.destinationIndex},analyzed_fields:{includes:e.includes},analysis:{outlier_detection:{}},model_memory_limit:e.modelMemoryLimit};void 0!==e.maxNumThreads&&(a.max_num_threads=e.maxNumThreads);const t="string"==typeof(null==e?void 0:e.resultsField)&&""===(null==e?void 0:e.resultsField.trim());if(a.dest&&!t&&(a.dest.results_field=e.resultsField),e.jobType===i.b.REGRESSION||e.jobType===i.b.CLASSIFICATION){let t={dependent_variable:e.dependentVariable,num_top_feature_importance_values:e.numTopFeatureImportanceValues,training_percent:e.trainingPercent};t=Object.assign(t,e.alpha&&{alpha:e.alpha},e.eta&&{eta:e.eta},e.etaGrowthRatePerTree&&{eta_growth_rate_per_tree:e.etaGrowthRatePerTree},e.downsampleFactor&&{downsample_factor:e.downsampleFactor},e.featureBagFraction&&{feature_bag_fraction:e.featureBagFraction},e.featureProcessors&&{feature_processors:e.featureProcessors},e.gamma&&{gamma:e.gamma},e.lambda&&{lambda:e.lambda},e.lossFunction&&{loss_function:e.lossFunction},e.lossFunctionParameter&&{loss_function_parameter:e.lossFunctionParameter},e.maxOptimizationRoundsPerHyperparameter&&{max_optimization_rounds_per_hyperparameter:e.maxOptimizationRoundsPerHyperparameter},e.maxTrees&&{max_trees:e.maxTrees},e.randomizeSeed&&{randomize_seed:e.randomizeSeed},void 0!==e.earlyStoppingEnabled&&{early_stopping_enabled:e.earlyStoppingEnabled},e.predictionFieldName&&{prediction_field_name:e.predictionFieldName},e.randomizeSeed&&{randomize_seed:e.randomizeSeed},e.softTreeDepthLimit&&{soft_tree_depth_limit:e.softTreeDepthLimit},e.softTreeDepthTolerance&&{soft_tree_depth_tolerance:e.softTreeDepthTolerance}),a.analysis={[e.jobType]:t}}if(void 0!==(null==a?void 0:a.analysis)&&Object(o.g)(null==a?void 0:a.analysis)&&(void 0!==e.numTopClasses&&(a.analysis.classification.num_top_classes=e.numTopClasses),void 0!==e.classAssignmentObjective&&(a.analysis.classification.class_assignment_objective=e.classAssignmentObjective)),e.jobType===i.b.OUTLIER_DETECTION){const t=Object.assign({},void 0!==e.computeFeatureInfluence&&{compute_feature_influence:e.computeFeatureInfluence},e.method&&{method:e.method},e.nNeighbors&&{n_neighbors:e.nNeighbors},e.outlierFraction&&{outlier_fraction:e.outlierFraction},e.featureInfluenceThreshold&&{feature_influence_threshold:e.featureInfluenceThreshold},void 0!==e.standardizationEnabled&&{standardization_enabled:e.standardizationEnabled});a.analysis.outlier_detection=t}return a};function _(e,a=!0){var t,n,i,r;const s=Object(o.a)(e.analysis),l={jobType:s,description:null!==(t=e.description)&&void 0!==t?t:"",_meta:null!==(n=e._meta)&&void 0!==n?n:{},resultsField:e.dest.results_field,sourceIndex:Array.isArray(e.source.index)?e.source.index.join(","):e.source.index,runtimeMappings:e.source.runtime_mappings,modelMemoryLimit:e.model_memory_limit,maxNumThreads:e.max_num_threads,includes:Array.isArray(null===(i=e.analyzed_fields)||void 0===i?void 0:i.includes)?null===(r=e.analyzed_fields)||void 0===r?void 0:r.includes:[],jobConfigQuery:e.source.query||d.e};var c;!1===a&&(l.destinationIndex=null!==(c=null==e?void 0:e.dest.index)&&void 0!==c?c:"");const m=e.analysis[s];for(const e in m)m.hasOwnProperty(e)&&(l[e.replace(/_([a-z])/g,(function(e){return e[1].toUpperCase()}))]=m[e]);return l}},233:function(e,a,t){"use strict";t.d(a,"d",(function(){return y})),t.d(a,"c",(function(){return b})),t.d(a,"b",(function(){return g})),t.d(a,"e",(function(){return T})),t.d(a,"a",(function(){return v}));var n=t(25),i=t(2),o=t.n(i),r=t(8),s=t(5),d=t(15),l=t(322),c=t(204),m=t(218),u=t(155),p=t(10),_=t(506),f=t(6);const E=e=>({allow_lazy_start:{optional:!0,defaultValue:!1},description:{optional:!0,formKey:"description"},_meta:{optional:!0,defaultValue:e._meta},analysis:{...Object(c.g)(e.analysis)?{classification:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},num_top_classes:{optional:!0,defaultValue:2,formKey:"numTopClasses"},prediction_field_name:{optional:!0,defaultValue:`${e.analysis.classification.dependent_variable}_prediction`,formKey:"predictionFieldName"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},num_top_feature_importance_values:{optional:!0,defaultValue:_.a,formKey:"numTopFeatureImportanceValues"},class_assignment_objective:{optional:!0,defaultValue:"maximize_minimum_recall"},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},feature_processors:{optional:!0},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{},...Object(c.h)(e.analysis)?{outlier_detection:{standardization_enabled:{defaultValue:!0,optional:!0,formKey:"standardizationEnabled"},compute_feature_influence:{defaultValue:!0,optional:!0,formKey:"computeFeatureInfluence"},outlier_fraction:{defaultValue:.05,optional:!0,formKey:"outlierFraction"},feature_influence_threshold:{optional:!0,formKey:"featureInfluenceThreshold"},method:{optional:!0,formKey:"method"},n_neighbors:{optional:!0,formKey:"nNeighbors"}}}:{},...Object(c.i)(e.analysis)?{regression:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},prediction_field_name:{optional:!0,defaultValue:`${e.analysis.regression.dependent_variable}_prediction`,formKey:"predictionFieldName"},num_top_feature_importance_values:{optional:!0,defaultValue:_.a,formKey:"numTopFeatureImportanceValues"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},loss_function:{optional:!0,defaultValue:"mse"},loss_function_parameter:{optional:!0},feature_processors:{optional:!0},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{}},analyzed_fields:{excludes:{optional:!0,defaultValue:[]},includes:{optional:!0,formKey:"includes",defaultValue:[]}},source:{index:{formKey:"sourceIndex",optional:!1},query:{optional:!0,defaultValue:{match_all:{}}},runtime_mappings:{optional:!0,formKey:"runtimeMappings",defaultValue:void 0},_source:{optional:!0}},dest:{index:{optional:!1,formKey:"destinationIndex"},results_field:{optional:!0,formKey:"resultsField",defaultValue:m.d}},model_memory_limit:{optional:!0,formKey:"modelMemoryLimit"},max_num_threads:{optional:!0,formKey:"maxNumThreads"}});function y(e,a=E(e)){for(const t in e)if(e.hasOwnProperty(t)){const n=e[t],i=a[t];if(!i)return console.info(`Property "${t}" is unknown.`),!0;if(i.hasOwnProperty("optional")){if(void 0===i.formKey&&!0!==i.ignore&&!Object(r.isEqual)(i.defaultValue,n))return console.info(`Property "${t}" is not supported by the form or has a different value to the default.`),!0}else if(y(n,i))return!0}return!1}function b({id:e,...a}){return Object(r.cloneDeep)({...a,dest:{...a.dest,index:""}})}const g=s.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionNameText",{defaultMessage:"Clone"}),T=()=>{const{services:{notifications:{toasts:e},data:{dataViews:a},http:{basePath:t},application:{capabilities:i},...r}}=Object(p.d)(),c=Object(p.h)(),m=!0===i.savedObjectsManagement.edit||!0===i.indexPatterns.save;return async i=>{const p=Array.isArray(i.config.source.index)?i.config.source.index.join(","):i.config.source.index;let _;try{const i=(await a.find(p)).find((({title:e})=>e===p));void 0!==i?_=i.id:e.addDanger({title:Object(u.a)(Object(f.jsx)(o.a.Fragment,null,Object(f.jsx)(d.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.noSourceDataViewForClone",defaultMessage:"Unable to clone the analytics job. No data view exists for index {sourceIndex}.",values:{sourceIndex:p}}),m?Object(f.jsx)(n.EuiText,{size:"xs",color:"text"},Object(f.jsx)(d.FormattedMessage,{id:"xpack.ml.dataframe.analytics.cloneAction.dataViewPromptLink",defaultMessage:"{linkToDataViewManagement}",values:{linkToDataViewManagement:Object(f.jsx)(n.EuiLink,{href:`${t.get()}/app/management/kibana/dataViews/create`,target:"_blank"},Object(f.jsx)(d.FormattedMessage,{id:"xpack.ml.dataframe.analytics.cloneAction.dataViewPromptLinkText",defaultMessage:"Create a data view for {sourceIndex}",values:{sourceIndex:p}}))}})):null),r)})}catch(a){const t=Object(l.a)(a);e.addDanger(s.i18n.translate("xpack.ml.dataframe.analyticsList.fetchSourceDataViewForCloneErrorMessage",{defaultMessage:"An error occurred checking if data view {dataView} exists: {error}",values:{dataView:p,error:t}}))}_&&await c(`/data_frame_analytics/new_job?index=${encodeURIComponent(_)}&jobId=${i.config.id}`)}},v=({isDisabled:e})=>e?Object(f.jsx)(n.EuiToolTip,{position:"top",content:s.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionPermissionTooltip",{defaultMessage:"You do not have permission to clone analytics jobs."})},Object(f.jsx)(o.a.Fragment,null,g)):Object(f.jsx)(o.a.Fragment,null,g)},292:function(e,a,t){"use strict";t.d(a,"a",(function(){return i}));const n=window;function i(e){return"string"==typeof e&&e===e.toLowerCase()&&/^[^\*\\/\?"<>|\s,#:]+$/.test(e)&&/^[^-_\+]+$/.test(e.charAt(0))&&"."!==e&&".."!==e&&function(e){return!(n.TextEncoder&&new n.TextEncoder("utf-8").encode(e).length>255)&&e.length<=255}(e)}},430:function(e,a,t){"use strict";t.d(a,"a",(function(){return n}));let n=function(e){return e[e.ADD_REQUEST_MESSAGE=0]="ADD_REQUEST_MESSAGE",e[e.RESET_REQUEST_MESSAGES=1]="RESET_REQUEST_MESSAGES",e[e.CLOSE_MODAL=2]="CLOSE_MODAL",e[e.OPEN_MODAL=3]="OPEN_MODAL",e[e.RESET_ADVANCED_EDITOR_MESSAGES=4]="RESET_ADVANCED_EDITOR_MESSAGES",e[e.RESET_FORM=5]="RESET_FORM",e[e.SET_ADVANCED_EDITOR_RAW_STRING=6]="SET_ADVANCED_EDITOR_RAW_STRING",e[e.SET_FORM_STATE=7]="SET_FORM_STATE",e[e.SET_DATA_VIEW_TITLES=8]="SET_DATA_VIEW_TITLES",e[e.SET_IS_JOB_CREATED=9]="SET_IS_JOB_CREATED",e[e.SET_IS_JOB_STARTED=10]="SET_IS_JOB_STARTED",e[e.SET_IS_MODAL_BUTTON_DISABLED=11]="SET_IS_MODAL_BUTTON_DISABLED",e[e.SET_IS_MODAL_VISIBLE=12]="SET_IS_MODAL_VISIBLE",e[e.SET_JOB_CONFIG=13]="SET_JOB_CONFIG",e[e.SET_JOB_IDS=14]="SET_JOB_IDS",e[e.SWITCH_TO_ADVANCED_EDITOR=15]="SWITCH_TO_ADVANCED_EDITOR",e[e.SWITCH_TO_FORM=16]="SWITCH_TO_FORM",e[e.SET_ESTIMATED_MODEL_MEMORY_LIMIT=17]="SET_ESTIMATED_MODEL_MEMORY_LIMIT",e[e.SET_JOB_CLONE=18]="SET_JOB_CLONE",e}({})},431:function(e,a,t){"use strict";t.d(a,"a",(function(){return I})),t.d(a,"b",(function(){return D}));var n=t(5),i=t(8),o=t(101),r=t.n(o),s=t(82),d=t(92),l=t(218),c=t(204),m=t(518),u=t(292),p=t(430),_=t(183),f=t(123),E=t(32),y=t(42),b=t(233);const{collapseLiteralStrings:g}=d.XJson,T=`${y.a.slice(0,y.a.length-1).join(", ")} or ${[...y.a].pop()}`,v=n.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:T}});function I(e){return null===e?null:Object.keys(e).reduce(((a,t)=>("min"===t&&a.push(n.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsMinError",{defaultMessage:"Model memory limit is lower than estimated value {mml}",values:{mml:e.min.minValue}})),"invalidUnits"===t&&a.push(n.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:T}})),a)),[])}const S=e=>{var a;const{jobConfig:t}=e,n=null==t||null===(a=t.source)||void 0===a?void 0:a.index;return"string"==typeof n?n:Array.isArray(n)?n.join(","):""},O=(e,a)=>{let t=0===Object.keys(s.indexPatterns.validate(e)).length;return t&&("string"==typeof a&&(t=!a.includes(",")),Array.isArray(a)&&(t=!a.some((e=>null==e?void 0:e.includes(","))))),t},M=e=>"number"==typeof e&&e>=l.h&&Number.isInteger(e),x=e=>{var a,t,i,o,r,s;const{jobIdEmpty:d,jobIdValid:p,jobIdExists:_,jobType:E,createDataView:y}=e.form,{jobConfig:b}=e;e.advancedEditorMessages=[];const g=S(e),T=""===g,I=null==b||null===(a=b.source)||void 0===a?void 0:a.index,x=O(g,I),h=null!==(t=null==b||null===(i=b.dest)||void 0===i?void 0:i.index)&&void 0!==t?t:"",j=""===h,A=Object(u.a)(h),D=void 0!==e.dataViewsMap[h],V=(null==b||null===(o=b.analyzed_fields)||void 0===o?void 0:o.includes)||[],F="string"==typeof(null==b||null===(r=b.dest)||void 0===r?void 0:r.results_field)&&""===(null==b||null===(s=b.dest)||void 0===s?void 0:s.results_field.trim()),R=b.model_memory_limit,w=""===R||void 0===R;if(!w&&void 0!==R){const{valid:a}=Object(f.z)(R);e.form.modelMemoryLimitUnitValid=a}let C=!1,N=!0,L=!0,J=!0;if(void 0!==b.analysis||E!==l.b.CLASSIFICATION&&E!==l.b.REGRESSION||(C=!0),void 0!==b.analysis&&(Object(c.i)(b.analysis)||Object(c.g)(b.analysis))){const a=Object(c.c)(b.analysis)||"";C=""===a,!C&&Array.isArray(V)&&V.length>0&&!V.includes(a)&&(N=!1,e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.includesInvalid",{defaultMessage:"The dependent variable must be included."}),message:""}));const t=Object(c.f)(b.analysis);void 0!==t&&(isNaN(t)||"number"!=typeof t||t<l.m||t>l.l)&&(L=!1,e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.trainingPercentInvalid",{defaultMessage:"The training percent must be a number between {min} and {max}.",values:{min:l.m,max:l.l}}),message:""}));const i=Object(m.a)(b.analysis);void 0!==i&&(J=M(i),!1===J&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.numTopFeatureImportanceValuesInvalid",{defaultMessage:"The value for num_top_feature_importance_values must be an integer of {min} or higher.",values:{min:0}}),message:""}))}return T?e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameEmpty",{defaultMessage:"The source index name must not be empty."}),message:""}):x||e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameValid",{defaultMessage:"Invalid source index name."}),message:""}),j?e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameEmpty",{defaultMessage:"The destination index name must not be empty."}),message:""}):D&&!y?e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameExistsWarn",{defaultMessage:"An index with this destination index name already exists. Be aware that running this analytics job will modify this destination index."}),message:""}):A||e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameValid",{defaultMessage:"Invalid destination index name."}),message:""}),F&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.resultsFieldEmptyString",{defaultMessage:"The results field must not be an empty string."}),message:""}),C&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.dependentVariableEmpty",{defaultMessage:"The dependent variable field must not be empty."}),message:""}),w&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.modelMemoryLimitEmpty",{defaultMessage:"The model memory limit field must not be empty."}),message:""}),e.form.modelMemoryLimitUnitValid||e.advancedEditorMessages.push({error:v,message:""}),e.form.destinationDataViewTitleExists=D,e.isValid=N&&L&&e.form.modelMemoryLimitUnitValid&&!d&&p&&!_&&!T&&x&&!j&&A&&!F&&!C&&!w&&(J||E===l.b.OUTLIER_DETECTION)&&(!D||!y),e},h=Object(i.memoize)((e=>Object(E.a)(Object(E.f)(),function(e){return a=>{if(!a||!e)return null;const t=r()(a.toUpperCase()).value();return r()(e.toUpperCase()).value()>t?{min:{minValue:e,actualValue:a}}:null}}(e),Object(E.d)()))),j=Object(i.memoize)(((e,a)=>h(e)(a)),((...e)=>e.join("_"))),A=e=>{const{jobIdEmpty:a,jobIdValid:t,jobIdExists:n,jobType:i,sourceIndexNameEmpty:o,sourceIndexNameValid:r,destinationIndexNameEmpty:s,destinationIndexNameValid:d,destinationDataViewTitleExists:c,createDataView:m,dependentVariable:u,modelMemoryLimit:p,numTopFeatureImportanceValuesValid:_}=e.form,{estimatedModelMemoryLimit:f}=e,E=void 0===i,y=(i===l.b.REGRESSION||i===l.b.CLASSIFICATION)&&""===u,b=j(f,p),g=null!==b&&(void 0!==b.invalidUnits||!0===b.required);return e.form.modelMemoryLimitValidationResult=b,e.isValid=!E&&!g&&!a&&t&&!n&&!o&&r&&!s&&d&&!y&&(_||i===l.b.OUTLIER_DETECTION)&&(!c||!m),e};function D(e,a){var t;switch(a.type){case p.a.ADD_REQUEST_MESSAGE:const n=e.requestMessages;return n.push(a.requestMessage),{...e,requestMessages:n};case p.a.RESET_REQUEST_MESSAGES:return{...e,requestMessages:[]};case p.a.RESET_ADVANCED_EDITOR_MESSAGES:return{...e,advancedEditorMessages:[]};case p.a.RESET_FORM:return Object(_.e)();case p.a.SET_ADVANCED_EDITOR_RAW_STRING:let o,r=!1;try{o=JSON.parse(g(a.advancedEditorRawString));const t=e.form.runtimeMappings&&o.source.runtime_mappings&&!Object(i.isEqual)(e.form.runtimeMappings,o.source.runtime_mappings);r=Object(b.d)(o)||t}catch(t){return{...e,advancedEditorRawString:a.advancedEditorRawString,isAdvancedEditorValidJson:!1,disableSwitchToForm:!0,advancedEditorMessages:[]}}return{...x({...e,jobConfig:o}),advancedEditorRawString:a.advancedEditorRawString,isAdvancedEditorValidJson:!0,disableSwitchToForm:r};case p.a.SET_FORM_STATE:const d={...e.form,...a.payload};if(void 0!==a.payload.destinationIndex&&(d.destinationIndexNameEmpty=""===d.destinationIndex,d.destinationIndexNameValid=Object(u.a)(d.destinationIndex),d.destinationDataViewTitleExists=void 0!==e.dataViewsMap[d.destinationIndex]),void 0!==a.payload.jobId&&(d.jobIdEmpty=""===d.jobId,d.jobIdValid=Object(f.l)(d.jobId),d.jobIdInvalidMaxLength=!!Object(E.c)(y.b)(d.jobId)),void 0!==a.payload.sourceIndex){d.sourceIndexNameEmpty=""===d.sourceIndex;const e=s.indexPatterns.validate(d.sourceIndex);d.sourceIndexNameValid=0===Object.keys(e).length}return void 0!==a.payload.numTopFeatureImportanceValues&&(d.numTopFeatureImportanceValuesValid=M(null==d?void 0:d.numTopFeatureImportanceValues)),e.isAdvancedEditorEnabled?x({...e,form:d}):A({...e,form:d});case p.a.SET_DATA_VIEW_TITLES:{const t={...e,...a.payload};return t.form.destinationDataViewTitleExists=void 0!==t.dataViewsMap[t.form.destinationIndex],t}case p.a.SET_IS_JOB_CREATED:return{...e,isJobCreated:a.isJobCreated};case p.a.SET_IS_JOB_STARTED:return{...e,isJobStarted:a.isJobStarted};case p.a.SET_JOB_CONFIG:return x({...e,jobConfig:a.payload});case p.a.SWITCH_TO_ADVANCED_EDITOR:const l=Object(_.f)(e.form),c=Object(b.d)(l);return x({...e,advancedEditorRawString:JSON.stringify(l,null,2),isAdvancedEditorEnabled:!0,disableSwitchToForm:c,hasSwitchedToEditor:!0,jobConfig:l});case p.a.SWITCH_TO_FORM:const{jobConfig:m}=e,{jobId:T}=e.form,v={...Object(_.d)(m,!1),...e.form};"string"==typeof T&&""!==T.trim()&&(v.jobId=T),v.jobIdEmpty=""===T,v.jobIdValid=Object(f.l)(T),v.jobIdInvalidMaxLength=!!Object(E.c)(y.b)(T),v.destinationIndexNameEmpty=""===v.destinationIndex,v.destinationIndexNameValid=Object(u.a)(v.destinationIndex||""),v.destinationDataViewTitleExists=void 0!==e.dataViewsMap[v.destinationIndex||""],void 0!==v.numTopFeatureImportanceValues&&(v.numTopFeatureImportanceValuesValid=M(v.numTopFeatureImportanceValues));const I=S(e),h=null==m||null===(t=m.source)||void 0===t?void 0:t.index,j=O(I,h);return v.sourceIndexNameValid=j,A({...e,form:v,isAdvancedEditorEnabled:!1,advancedEditorRawString:JSON.stringify(m,null,2),jobConfig:m});case p.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT:return{...e,estimatedModelMemoryLimit:a.value};case p.a.SET_JOB_CLONE:return{...e,cloneJob:a.cloneJob}}return e}},505:function(e,a,t){"use strict";t.d(a,"a",(function(){return n.c})),t.d(a,"b",(function(){return n.d})),t.d(a,"c",(function(){return r}));var n=t(233),i=t(2),o=t(6);const r=e=>{const a=Object(n.e)(),t=Object(i.useCallback)((e=>{a(e)}),[]);return{action:Object(i.useMemo)((()=>({name:()=>Object(o.jsx)(n.a,{isDisabled:!e}),enabled:()=>e,description:n.b,icon:"copy",type:"icon",onClick:t,"data-test-subj":"mlAnalyticsJobCloneButton"})),[])}}},506:function(e,a,t){"use strict";t.d(a,"a",(function(){return n.b})),t.d(a,"b",(function(){return p}));var n=t(183),i=t(2),o=t(5),r=t(322),s=t(10),d=t(11),l=t(148),c=t(505),m=t(430),u=t(431);const p=()=>{const{services:{data:{dataViews:e}}}=Object(s.d)(),[a,t]=Object(i.useReducer)(u.b,Object(n.e)()),{refresh:p}=Object(l.m)(),{form:_,jobConfig:f,isAdvancedEditorEnabled:E}=a,{createDataView:y,jobId:b}=_,g=e=>t({type:m.a.ADD_REQUEST_MESSAGE,requestMessage:e}),T=e=>{t({type:m.a.SET_FORM_STATE,payload:e})},v=()=>{t({type:m.a.SWITCH_TO_ADVANCED_EDITOR})},I=e=>{t({type:m.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT,value:null!=e?e:""})};return{state:a,actions:{closeModal:()=>t({type:m.a.CLOSE_MODAL}),createAnalyticsJob:async()=>{t({type:m.a.RESET_REQUEST_MESSAGES});const e=E?f:Object(n.f)(_),a=o.i18n.translate("xpack.ml.dataframe.analytics.create.errorCreatingDataFrameAnalyticsJob",{defaultMessage:"An error occurred creating the data frame analytics job:"});try{const n=await d.ml.dataFrameAnalytics.createDataFrameAnalytics(b,e,y,_.timeFieldName);if(g({message:o.i18n.translate("xpack.ml.dataframe.stepCreateForm.createDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to create data frame analytics {jobId} acknowledged.",values:{jobId:b}})}),n.dataFrameAnalyticsJobsCreated.length&&0===n.dataFrameAnalyticsJobsErrors.length)return t({type:m.a.SET_IS_JOB_CREATED,isJobCreated:true}),p(),!0;if(n.dataFrameAnalyticsJobsErrors.length)return g({error:Object(r.b)(n.dataFrameAnalyticsJobsErrors[0].error).message,message:a}),!1}catch(e){return g({error:Object(r.a)(e),message:a}),!1}return!1},initiateWizard:async()=>{await e.clearCache(),await(async()=>{try{const n={};(await e.getCache()||[]).forEach((e=>{var a;const t=null==e||null===(a=e.attributes)||void 0===a?void 0:a.title;if(void 0!==t){const a=(null==e?void 0:e.id)||"";n[t]={label:t,value:a}}})),a={dataViewsMap:n},t({type:m.a.SET_DATA_VIEW_TITLES,payload:a})}catch(e){g({error:Object(r.a)(e),message:o.i18n.translate("xpack.ml.dataframe.analytics.create.errorGettingDataViewNames",{defaultMessage:"An error occurred getting the existing data view names:"})})}var a})()},resetAdvancedEditorMessages:()=>t({type:m.a.RESET_ADVANCED_EDITOR_MESSAGES}),setAdvancedEditorRawString:e=>t({type:m.a.SET_ADVANCED_EDITOR_RAW_STRING,advancedEditorRawString:e}),setFormState:T,setJobConfig:e=>{t({type:m.a.SET_JOB_CONFIG,payload:e})},startAnalyticsJob:async()=>{try{const e=await d.ml.dataFrameAnalytics.startDataFrameAnalytics(b);if(!0!==e.acknowledged)throw new Error(e);g({message:o.i18n.translate("xpack.ml.dataframe.analytics.create.startDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {jobId} acknowledged.",values:{jobId:b}})}),t({type:m.a.SET_IS_JOB_STARTED,isJobStarted:true}),p()}catch(e){g({error:Object(r.a)(e),message:o.i18n.translate("xpack.ml.dataframe.analytics.create.errorStartingDataFrameAnalyticsJob",{defaultMessage:"An error occurred starting the data frame analytics job:"})})}},switchToAdvancedEditor:v,switchToForm:()=>{t({type:m.a.SWITCH_TO_FORM})},setEstimatedModelMemoryLimit:I,setJobClone:async e=>{t({type:m.a.RESET_FORM});const a=Object(c.a)(e);Object(c.b)(a)?(T(Object(n.d)(a)),v()):(T(Object(n.d)(a)),I(a.model_memory_limit)),t({type:m.a.SET_JOB_CLONE,cloneJob:e})}}}}}}]);