/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[42,38,77,80],{139:function(e,t,i){"use strict";i.d(t,"a",(function(){return v})),i.d(t,"d",(function(){return y})),i.d(t,"n",(function(){return S})),i.d(t,"g",(function(){return k})),i.d(t,"f",(function(){return j})),i.d(t,"k",(function(){return w})),i.d(t,"i",(function(){return O})),i.d(t,"j",(function(){return A})),i.d(t,"o",(function(){return E})),i.d(t,"l",(function(){return M})),i.d(t,"m",(function(){return C})),i.d(t,"p",(function(){return F})),i.d(t,"c",(function(){return D})),i.d(t,"b",(function(){return T})),i.d(t,"h",(function(){return _})),i.d(t,"q",(function(){return P})),i.d(t,"e",(function(){return B}));var s=i(8),a=i(83),r=i.n(a),o=i(7),n=i(131),l=i(37),c=i(322),d=i(252),u=i(830),m=i(162),h=i(123),p=i(40),f=i(11),b=i(73),x=i(17),g=i(132);function v(e){return e.map((e=>{var t;const i=Object(p.a)(e.analysis_config.bucket_span);return{id:e.job_id,selected:!1,bucketSpanSeconds:i.asSeconds(),isSingleMetricViewerJob:Object(h.r)(e),sourceIndices:e.datafeed_config.indices,modelPlotEnabled:!0===(null===(t=e.model_plot_config)||void 0===t?void 0:t.enabled)}}))}function y(){return{selectedCells:void 0}}async function S(e,t,i,a,r,o,n,l){const c={};o.forEach((e=>{const t=e.fieldName;void 0===c[e.fieldName]&&(c[e.fieldName]=[]),c[t].push(e.fieldValue)})),r.forEach((e=>{(e.influencers||[]).forEach((e=>{const t=e.influencer_field_name,i=e.influencer_field_values;void 0===c[t]&&(c[t]=[]),c[t].push(...i)}))}));const d={};Object.keys(c).forEach((e=>{const t=c[e];d[e]=Object(s.uniq)(t)}));const u=[];return Object.keys(d).forEach((e=>{void 0!==o.find((t=>t.fieldName===e))?u.push(...o):d[e].forEach((t=>{u.push({fieldName:e,fieldValue:t})}))})),await F(e,t,i,a,u,n,l)}function k(e){const t=[];return e.forEach((e=>{const i=b.mlJobService.getJob(e.id);void 0!==i&&i.analysis_config&&i.analysis_config.influencers&&t.push(...i.analysis_config.influencers)})),t}function j(){const e=Object(x.g)().get("dateFormat:tz");return"Browser"!==e?e:r.a.tz.guess()}function w(e,t){const i=t;let s=i.min.valueOf(),a=i.max.valueOf();return void 0!==(null==e?void 0:e.times)&&(s=void 0!==e.times[0]?1e3*e.times[0]:i.min.valueOf(),a=i.max.valueOf(),void 0!==e.times[1]&&(a=1e3*e.times[1]-1)),{earliestMs:s,latestMs:a}}function O(e,t){return e&&e.type!==g.h.OVERALL&&void 0!==e.viewByFieldName&&e.viewByFieldName!==g.j?e.lanes.map((e=>({fieldName:t,fieldValue:e}))):[]}function A(e,t){return e&&e.type!==g.h.OVERALL&&void 0!==e.viewByFieldName&&e.viewByFieldName===g.j?e.lanes:t.map((e=>e.id))}function E(e,t){const i=e.map((e=>e.id)),s=w(void 0,t);return new Promise((e=>{Object(o.lastValueFrom)(f.ml.annotations.getAnnotations$({jobIds:i,earliestMs:s.earliestMs,latestMs:s.latestMs,maxAnnotations:m.a})).then((t=>{if(void 0!==t.error||void 0===t.annotations){const i=Object(c.a)(t.error);return e({annotationsData:[],error:""!==i?i:void 0})}const s=[];return i.forEach((e=>{const i=t.annotations[e];void 0!==i&&s.push(...i)})),e({annotationsData:s.sort(((e,t)=>e.timestamp-t.timestamp)).map(((e,t)=>(e.key=(t+1).toString(),e)))})})).catch((t=>{const i=Object(c.a)(t);return e({annotationsData:[],error:""!==i?i:void 0})}))}))}function M(e,t,i){const s=A(e,t),a=w(e,i);return new Promise((e=>{Object(o.lastValueFrom)(f.ml.annotations.getAnnotations$({jobIds:s,earliestMs:a.earliestMs,latestMs:a.latestMs,maxAnnotations:m.a})).then((t=>{if(void 0!==t.error||void 0===t.annotations){const i=Object(c.a)(t.error);return e({annotationsData:[],totalCount:0,error:""!==i?i:void 0})}const i=[];return s.forEach((e=>{const s=t.annotations[e];void 0!==s&&i.push(...s)})),e({annotationsData:i.sort(((e,t)=>e.timestamp-t.timestamp)).map(((e,t)=>(e.key=(t+1).toString(),e))),totalCount:t.totalCount})})).catch((t=>{const i=Object(c.a)(t);return e({annotationsData:[],totalCount:0,error:""!==i?i:void 0})}))}))}async function C(e,t,i,a,r,o,n,l){const c=A(e,t),p=O(e,r),x=w(e,a);return new Promise(((e,t)=>{f.ml.results.getAnomaliesTableData(c,[],p,o,n,x.earliestMs,x.latestMs,i,m.b,g.e,l).toPromise().then((t=>{const i=t.anomalies,a=b.mlJobService.detectorsByJob;i.forEach((e=>{const t=e.jobId,i=Object(s.get)(a,[t,e.detectorIndex]);e.detector=Object(s.get)(i,["detector_description"],e.source.function_description),void 0!==i&&void 0!==i.custom_rules&&(e.rulesLength=i.custom_rules.length);const r=b.mlJobService.getJob(t);let o=Object(h.p)(r,e.detectorIndex);if(!1===o&&Object(h.n)(r,e.detectorIndex)){const t=Object(d.d)(e.source);o=Object(h.o)(r,e.detectorIndex,t)}e.isTimeSeriesViewRecord=o,e.isGeoRecord=void 0!==i&&i.function===u.b.LAT_LONG,void 0!==b.mlJobService.customUrlsByJob[t]&&(e.customUrls=b.mlJobService.customUrlsByJob[t])})),e({anomalies:i,interval:t.interval,examplesByJobId:t.examplesByJobId,showViewSeriesLink:!0,jobIds:c})})).catch((e=>{console.log("Explorer - error loading data for anomalies table:",e),t()}))}))}async function F(e,t,i,s,a,r,o){return new Promise((n=>{!0!==r?e.getTopInfluencers(t,i,s,g.f,10,1,a,o).then((e=>{n(e.influencers)})):n({})}))}function I(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function D(e){return e.replace(/[()]/g,"\\$&")}function T(e){return e.replace(/[\\"]/g,"\\$&")}function _(e,t){const i=I(e),s=I(t);return new RegExp(`(${i})\\s?:\\s?(")?(${s})(")?`,"i")}function P(e,t,i){let s="";const a=_(t,i);return s=e.replace(a,""),s=s.replace(/\s+(and|or)\s+(and|or)\s+/gi," $1 "),s=s.replace(/\s(and|or)\s*$/gi,""),s=s.replace(/^\s*(and|or)\s/gi,""),s}async function B(e,t,i){const s={},a=new Map;if(Array.isArray(e))for(const c of e){let e,d;if(o=c,Object(l.a)(o)&&"string"==typeof o.id&&void 0!==o.selected&&void 0!==o.bucketSpanSeconds?(e=c.sourceIndices,d=c.id):(e=c.datafeed_config.indices,d=c.job_id),Array.isArray(e))for(const o of e){var r;const e=a.get(o),l=null!==(r=null==e?void 0:e.id)&&void 0!==r?r:await i.getDataViewIdFromName(o);if(l){const i=null!=e?e:await t.get(l);if(!i)continue;a.set(o,i);const r=[...i.fields.getByType(n.a.GEO_POINT),...i.fields.getByType(n.a.GEO_SHAPE)];r.length>0&&(void 0===s[d]&&(s[d]={[o]:{geoFields:[],dataViewId:l}}),s[d][o].geoFields.push(...r.map((e=>e.name))))}}}var o;return{sourceIndicesWithGeoFieldsMap:s,dataViews:[...a.values()]}}},143:function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var s=i(120),a=i.n(s),r=i(2),o=i(88),n=i(149),l=i(26),c=i.n(l),d=i(84),u=i.n(d),m=i(25);const h="eui-global",p="eui-utilities",f={darkMode:!1};var b=i(6);const x=[m.euiStylisPrefixer],g=u()({key:"css",stylisPlugins:x,container:document.querySelector('meta[name="emotion"]')}),v=u()({key:h,stylisPlugins:x,container:document.querySelector(`meta[name="${h}"]`)}),y=u()({key:p,stylisPlugins:x,container:document.querySelector(`meta[name="${p}"]`)});g.compat=!0,v.compat=!0,y.compat=!0;const S={default:g,global:v,utility:y},k=({theme:{theme$:e},globalStyles:t,colorMode:i,modify:s,children:a})=>{const o=c()(e,f),n=Object(r.useMemo)((()=>(e=>e.darkMode?m.COLOR_MODES_STANDARD.dark:m.COLOR_MODES_STANDARD.light)(o)),[o]),l=i||n,d=!1!==t&&void 0;return Object(b.jsx)(m.EuiProvider,{cache:S,modify:s,colorMode:l,globalStyles:d,utilityClasses:d},a)},j=({children:e,i18n:t,...i})=>Object(o.useIsNestedEuiProvider)()?(Object(n.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(b.jsx)(t.Context,null,e)):Object(b.jsx)(k,i,Object(b.jsx)(t.Context,null,e));var w=i(89);const O=({children:e,...t})=>Object(b.jsx)(j,a()({globalStyles:!1},t),Object(b.jsx)(w.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(b.jsx)(w.KibanaErrorBoundary,null,e)))},149:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var s=void 0;t.setEuiDevProviderWarning=function(e){return s=e},t.getEuiDevProviderWarning=function(){return s},t.emitEuiProviderWarning=function(e){if("function"==typeof s)return s(e);switch(s){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},150:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i(33),a=i(203);const r=[s.euiDarkVars.euiColorVis0,s.euiDarkVars.euiColorVis1,s.euiDarkVars.euiColorVis2,s.euiDarkVars.euiColorVis3,s.euiDarkVars.euiColorVis4,s.euiDarkVars.euiColorVis5,s.euiDarkVars.euiColorVis6,s.euiDarkVars.euiColorVis7,s.euiDarkVars.euiColorVis8,s.euiDarkVars.euiColorVis9,s.euiDarkVars.euiColorDarkShade,s.euiDarkVars.euiColorPrimary],o={};function n(e){if(void 0===o[e]){const t=Object(a.a)(e),i=r[t%r.length];return o[e]=i,i}return o[e]}},153:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return AnnotationUpdatesService}));var s=i(4),a=i.n(s),r=i(7);new r.BehaviorSubject(null);const o=new r.BehaviorSubject(Date.now()),n=()=>o.next(Date.now());class AnnotationUpdatesService{constructor(){a()(this,"_annotation$",new r.BehaviorSubject(null))}update$(){return this._annotation$.asObservable()}isAnnotationInitialized$(){return this._annotation$.asObservable().pipe(Object(r.distinctUntilChanged)(((e,t)=>null!==e&&null!==t)))}setValue(e){this._annotation$.next(e)}}},156:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a}));let s=null;function a(e){return s=e,s}function r(){return null!==s&&s.hasLicenseExpired()}function o(){return null!==s&&s.isFullLicense()}},162:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));const s=500,a=500},166:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return r})),i.d(t,"a",(function(){return o}));const s=e=>async t=>{var i,s;const a={savedSearch:null,dataView:null};if(void 0===t)return a;const r=await e.savedSearchService.get(t);if(null===r)return a;const o=null===(i=r.references)||void 0===i||null===(s=i.find((e=>"index-pattern"===e.type)))||void 0===s?void 0:s.id;return a.dataView=await e.dataViewsService.get(o),a.savedSearch=r,a};function a(e){return{query:e.searchSource.getField("query"),filter:e.searchSource.getField("filter")}}function r(e){return e.includes(":")}function o(e){const t={message:null,errorMessage:null};for(const a of e.fields){var i,s;"message"===a.name&&null!==(i=a.toSpec().esTypes)&&void 0!==i&&i.includes("text")?t.message=a:"error.message"===a.name&&null!==(s=a.toSpec().esTypes)&&void 0!==s&&s.includes("text")&&(t.errorMessage=a)}return null!==t.message?{dataView:e,field:t.message}:null!==t.errorMessage?{dataView:e,field:t.errorMessage}:null}},170:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i(2),a=i(153);const r=Object(s.createContext)(new a.a)},187:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i(73);function a(e,t,i,a){const r=null!=a?a:s.mlJobService.getJob(i),o=[];if(void 0===r)return o;const n=e,l=r.analysis_config.detectors[n],c=t,d=null==l?void 0:l.partition_field_name,u=null==l?void 0:l.over_field_name,m=null==l?void 0:l.by_field_name;if(void 0!==d){var h;const e=null!==(h=null==c?void 0:c[d])&&void 0!==h?h:null;o.push({fieldType:"partition_field",fieldName:d,fieldValue:e})}if(void 0!==u){var p;const e=null!==(p=null==c?void 0:c[u])&&void 0!==p?p:null;o.push({fieldType:"over_field",fieldName:u,fieldValue:e})}if(void 0!==m&&void 0===u){var f;const e=null!==(f=null==c?void 0:c[m])&&void 0!==f?f:null;o.push({fieldType:"by_field",fieldName:m,fieldValue:e})}return o}},203:function(e,t,i){"use strict";function s(e){let t=0,i=0;if(0===e.length)return t;for(let s=0;s<e.length;s++)i=e.charCodeAt(s),t=(t<<5)-t+i,t|=0;return t<0?-2*t:t}i.d(t,"a",(function(){return s}))},213:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var s=i(123);function a(e){const t=e.analysis_config.detectors,i=[];return t.forEach(((t,a)=>{Object(s.q)(e,a)&&i.push({index:a,detector_description:t.detector_description,function:t.function})})),i}},214:function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"d",(function(){return m})),i.d(t,"a",(function(){return h})),i.d(t,"c",(function(){return p})),i.d(t,"e",(function(){return f})),i.d(t,"f",(function(){return b})),i.d(t,"g",(function(){return x})),i.d(t,"h",(function(){return y})),i.d(t,"i",(function(){return S})),i.d(t,"o",(function(){return k})),i.d(t,"p",(function(){return j})),i.d(t,"j",(function(){return w})),i.d(t,"m",(function(){return O})),i.d(t,"k",(function(){return E})),i.d(t,"l",(function(){return C})),i.d(t,"n",(function(){return F}));var s=i(145),a=i.n(s),r=i(252),o=i(135),n=i(39),l=i.n(n),c=i(132),d=i(1);const u=7,m=5,h=10,p=100;function f(e=[],t){let i=1/0,s=-1/0;e.forEach((e=>{let t=e.value;const a=Array.isArray(e.actual)?e.actual[0]:e.actual,r=Array.isArray(e.typical)?e.typical[0]:e.typical;null===t&&void 0!==e.anomalyScore&&void 0!==e.actual&&(t=a),void 0!==e.anomalyScore&&void 0!==a?(i=Math.min(i,t,a,r),s=Math.max(s,t,a,r)):(i=Math.min(i,t),s=Math.max(s,t))}));const a={max:s,min:i};if(a.max===a.min){const e=.05*a.max;a.max+=e,a.min-=e}return"count"===t&&a.min<0&&(a.min=0),a}function b(e,t,i,s=1.5){const a=e.reduce(((t,i,s)=>{const a=e[s-1],r=e[s+1];return(void 0===a||a&&null===a.value)&&null!==i.value&&(void 0===r||r&&null===r.value)&&t.push(i),t}),[]),r=(t.select(".values-dots").empty()?t.append("g").classed("values-dots",!0):t.select(".values-dots")).selectAll("circle").data(a);r.enter().append("circle").attr("r",s),r.attr("cx",i.x()).attr("cy",i.y()),r.exit().remove()}function x(e,t){if(void 0===e||void 0===e.selectAll)throw new Error("Missing selection parameter");e.selectAll(".tick text").text((function(){const e=a.a.select(this.parentNode),i=e.node().getBBox().width,s=a.a.transform(e.attr("transform")).translate[0];if(s-i/2>=0&&s+i/2<=t)return this.textContent;e.remove()}))}const g=!0,v=!0;function y(e){let t=c.b.SINGLE_METRIC;if("lat_long"===e.functionDescription||void 0!==e.mapData)return c.b.GEO_MAP;if(g&&"rare"===e.functionDescription&&!1===e.entityFields.some((e=>"over"===e.fieldType))?t=c.b.EVENT_DISTRIBUTION:v&&"rare"!==e.functionDescription&&e.entityFields.some((e=>"over"===e.fieldType))&&null!==e.metricFunction&&(t=c.b.POPULATION_DISTRIBUTION),(t===c.b.EVENT_DISTRIBUTION||t===c.b.POPULATION_DISTRIBUTION)&&void 0!==e.datafeedConfig&&void 0!==e.datafeedConfig.script_fields){const i=Object.keys(e.datafeedConfig.script_fields),s=e.entityFields.map((e=>e.fieldName));e.metricFieldName&&s.push(e.metricFieldName),!0==(void 0!==s.find((e=>i.includes(e))))&&(t=c.b.SINGLE_METRIC)}return t}async function S(e,t,i){const s=l()(t.plotEarliest).toISOString(),a=l()(t.plotLatest).toISOString();let r;return t.entityFields.length>0&&(r={},t.entityFields.forEach((e=>{r[e.fieldName]=e.fieldValue}))),await e.getUrl({page:d.b.SINGLE_METRIC_VIEWER,pageState:{jobIds:[t.jobId],refreshInterval:{display:"Off",pause:!0,value:0},timeRange:i,zoom:{from:s,to:a},detectorIndex:t.detectorIndex,entities:r,query:{query_string:{analyze_wildcard:!0,query:"*"}}}},{absolute:!0})}function k(e){return!0===e.isMultiBucketAnomaly}function j(e){return!0===e.isMultiBucketAnomaly}function w(e){const t=void 0!==e.multiBucketImpact?Object(r.c)(e.multiBucketImpact):0;return new Array(5).fill("■ ",0,t).fill("□ ",t).join("")}function O(e,t){return e/(1.75*Object(o.a)(l()().format(t),!1))}const A={NEXT:"next",PREVIOUS:"previous"};function E(e,t,i,s){if(t<=0)throw Error("tickInterval must be larger than 0.");const a=[e];function r(e,o){let n,l;switch(o){case A.PREVIOUS:n=e-t,l=n>=i;break;case A.NEXT:n=e+t,l=n<=s}l&&(a.push(n),r(n,o))}return r(e,A.PREVIOUS),r(e,A.NEXT),a.sort(),a}const M=60;function C({detectorLabel:e,entityFields:t}){return e.length+t.map((e=>`${e.fieldName} ${e.fieldValue}`)).join(" ").length>M}function F(e,t,i,s){function r(e){return function(t){switch(e){case A.PREVIOUS:return t-i;case A.NEXT:return t+i}}}function o(t,i){const n=function(t){const i=r(t),s=function(t){const r=e.selectAll(".tick").filter((e=>e===t));if(0===r.length||0===r[0].length)return!1;const o=a.a.selectAll(r[0]),n=o.select("text").node();if(null===n)return s(i(t));const l=n.getBBox().width,c=function(e){const t=/translate\(\s*([^\s,)]+)([ ,]([^\s,)]+))?\)/.exec(e);return Array.isArray(t)&&t.length>=2?Number(t[1]):NaN}(o.attr("transform"));return{tick:o,ts:t,xMinOffset:c-(l/2+15),xMaxOffset:c+(l/2+15)}};return s}(i),l=n(t);if(!1===l)return;const c=n(r(i)(t));!1!==c&&(c.xMinOffset<0||c.xMaxOffset>s||c.xMaxOffset>l.xMinOffset&&i===A.PREVIOUS||c.xMinOffset<l.xMaxOffset&&i===A.NEXT?(c.tick.select("text").remove(),c.tick.select("line").classed("ml-tick-emphasis",!1),o(l.ts,i)):o(c.ts,i))}e.selectAll("g.tick").select("line").classed("ml-tick-emphasis",!0),o(t,A.PREVIOUS),o(t,A.NEXT)}},219:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i(220),a=i(139);function r(e){return{title:s.a,fields:Object(a.g)(e).map((e=>({name:e,type:"string",aggregatable:!0,searchable:!0})))}}},220:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));const s=".ml-anomalies-*"},240:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i(2),a=i.n(s),r=i(25),o=i(6);const n=({height:e,label:t})=>(e=e?+e:100,Object(o.jsx)(r.EuiFlexGroup,{justifyContent:"spaceEvenly"},Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)("div",{style:{height:`${e}px`},"data-test-subj":"mlLoadingIndicator"},Object(o.jsx)(r.EuiLoadingChart,{size:"xl",mono:!0}),t&&Object(o.jsx)(a.a.Fragment,null,Object(o.jsx)(r.EuiSpacer,{size:"s"}),Object(o.jsx)("div",null,t))))))},242:function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return c}));var s=i(5),a=i(7),r=i(830),o=i(187),n=i(213);function l(e,t){const i=Object(n.a)(e);if(Array.isArray(i)&&i.length>=t){const i=e.analysis_config.detectors[t];if((null==i?void 0:i.function)===r.b.METRIC)return!0}return!1}const c=async({selectedDetectorIndex:e,selectedEntities:t,selectedJobId:i,selectedJob:n},c,d)=>{if(!l(n,e))return;const u=[{fieldName:"detector_index",fieldValue:e},...Object(o.a)(e,t,i).filter((e=>null!==e.fieldValue))];try{const e=await Object(a.lastValueFrom)(d.getRecordsForCriteria([n.job_id],u,0,null,null,1));if(Array.isArray(null==e?void 0:e.records)&&1===e.records.length){const t=e.records[0];return null==t?void 0:t.function_description}return r.a.AVG}catch(e){c.displayErrorToast(e,s.i18n.translate("xpack.ml.timeSeriesExplorer.highestAnomalyScoreErrorToastTitle",{defaultMessage:"An error occurred getting record with the highest anomaly score"}))}}},247:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));const s={KUERY:"kuery",LUCENE:"lucene"}},281:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return n}));var s=i(2),a=i(6);const r=Object(s.createContext)(void 0),o=()=>{const e=Object(s.useContext)(r);if(void 0===e)throw new Error("datePickerContext was used outside of its Provider");return e},n=e=>{const{children:t,...i}=e;return Object(a.jsx)(r.Provider,{value:i},t)}},319:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return l}));var s=i(8),a=i(5),r=i(123),o=i(73);function n(e,t,i,n,l){const c=o.mlJobService.jobs.filter(r.r),d=c.map((e=>e.job_id)),u=Object(s.difference)(t,d),m=Object(s.without)(t,...u);if(1===u.length){const t=u[0],i=e.find((e=>e.id===t));if(void 0!==i&&void 0!==i.isNotSingleMetricViewerJobMessage){const e=a.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningWithReasonMessage",{defaultMessage:"You can't view {selectedJobId} in this dashboard because {reason}.",values:{selectedJobId:t,reason:i.isNotSingleMetricViewerJobMessage}});n.addWarning({title:e,"data-test-subj":"mlTimeSeriesExplorerDisabledJobReasonWarningToast"})}}if(u.length>1){let e=a.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningMessage",{defaultMessage:"You can't view requested {invalidIdsCount, plural, one {job} other {jobs}} {invalidIds} in this dashboard",values:{invalidIdsCount:u.length,invalidIds:u.join(", ")}});0===m.length&&d.length>0&&(e+=a.i18n.translate("xpack.ml.timeSeriesExplorer.autoSelectingFirstJobText",{defaultMessage:", auto selecting first job"})),n.addWarning(e)}return m.length>1?(n.addWarning(a.i18n.translate("xpack.ml.timeSeriesExplorer.youCanViewOneJobAtTimeWarningMessage",{defaultMessage:"You can only view one job at a time in this dashboard"})),i("ml",{jobIds:[m[0]]}),!0):u.length>0&&m.length>0?(i("ml",{jobIds:[m[0]]}),!0):1===m.length?m[0]:0===m.length&&c.length>0&&(l({singleSelection:!0,timeseriesOnly:!0}).then((({jobIds:e,time:t})=>{i({ml:{jobIds:e},...void 0!==t?{time:t}:{}})})).catch((e=>{})),!0)}function l(){return{chartDetails:void 0,contextAggregationInterval:void 0,contextChartData:void 0,contextForecastData:void 0,dataNotChartable:!1,entitiesLoading:!1,entityValues:{},focusAnnotationData:[],focusAggregationInterval:{},focusChartData:void 0,focusForecastData:void 0,fullRefresh:!0,hasResults:!1,loadCounter:0,loading:!1,modelPlotEnabled:!1,showAnnotations:!0,showAnnotationsCheckbox:!0,showForecast:!0,showForecastCheckbox:!1,showModelBounds:!0,showModelBoundsCheckbox:!1,svgWidth:0,tableData:void 0,zoomFrom:void 0,zoomTo:void 0,zoomFromFocusLoaded:void 0,zoomToFocusLoaded:void 0,chartDataError:void 0,sourceIndicesWithGeoFields:{}}}},324:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i(2);var s=i(25),a=i(5),r=i(6);const o=({dataNotChartable:e,entities:t})=>Object(r.jsx)(s.EuiEmptyPrompt,{iconType:"iInCircle",title:Object(r.jsx)("h2",null,a.i18n.translate("xpack.ml.timeSeriesExplorer.noResultsFoundLabel",{defaultMessage:"No results found"})),body:e?Object(r.jsx)("p",null,a.i18n.translate("xpack.ml.timeSeriesExplorer.dataNotChartableDescription",{defaultMessage:"Model plot is not collected for the selected {entityCount, plural, one {entity} other {entities}}\nand the source data cannot be plotted for this detector.",values:{entityCount:t.length}})):Object(r.jsx)("p",null,a.i18n.translate("xpack.ml.timeSeriesExplorer.tryWideningTheTimeSelectionDescription",{defaultMessage:"Try widening the time selection or moving further back in time."}))})},374:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i(2);var s=i(5),a=i(15),r=i(212),o=i(6);const n=({embeddableMode:e})=>Object(o.jsx)(r.a,{anchorPosition:"upCenter",title:s.i18n.translate("xpack.ml.timeSeriesExplorer.popoverTitle",{defaultMessage:"Single time series analysis"})},Object(o.jsx)("p",null,Object(o.jsx)(a.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverBasicExplanation",defaultMessage:"This chart illustrates the actual data values over time for a specific detector. You can examine an event by sliding the time selector and changing its length. For the most accurate view, set the zoom size to auto."})),Object(o.jsx)("p",null,Object(o.jsx)(a.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverAnomalyExplanation",defaultMessage:"An anomaly score is calculated for each bucket time interval, with a value from 0 to 100. Anomalous events are highlighted in colors that indicate their severity. If an anomaly is depicted with a cross symbol instead of a dot, it has a moderate, significant, or high multi-bucket impact. This extra analysis can catch anomalies even when they fall within the bounds of expected behavior."})),Object(o.jsx)("p",null,Object(o.jsx)(a.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverForecastExplanation",defaultMessage:"If you create a forecast, predicted data values are added to the chart. A shaded area around these values represents the confidence level; as you forecast further into the future, the confidence level generally decreases."})),!e&&Object(o.jsx)("p",null,Object(o.jsx)(a.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverAnnotationsExplanation",defaultMessage:"You can also optionally annotate your job results by drag-selecting a period of time in the chart and adding a description. Some annotations are generated automatically to indicate noteworthy occurrences."})),Object(o.jsx)("p",null,Object(o.jsx)(a.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverModelPlotExplanation",defaultMessage:"If model plot is enabled, you can optionally show model bounds, which are represented by a shaded area in the chart. As the job analyzes more data, it learns to more closely predict the expected patterns of behavior."})))},377:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(2);t.default=function(e){var t=s.useRef();return s.useEffect((function(){t.current=e})),t.current}},394:function(e,t,i){"use strict";i.d(t,"a",(function(){return ie}));var s=i(120),a=i.n(s),r=i(2),o=i.n(r),n=i(5),l=i(322),c=i(309),d=i(4),u=i.n(d),m=i(26),h=i.n(m),p=i(8),f=i(145),b=i.n(f),x=i(39),g=i.n(x),v=i(25),y=i(252),S=i(529),k=i(415),j=i(21),w=i(194),O=i(214),A=i(234),E=i(262);function M(e,t,i,s){this.contextGroup=e,this.data=t,this.drawBounds=i,this.swimlaneHeight=s,this.mask=this.contextGroup.append("g").attr("class","mask"),this.leftGroup=this.mask.append("g").attr("class","left-mask"),this.rightGroup=this.mask.append("g").attr("class","right-mask"),this.leftPolygon=this.leftGroup.append("polygon"),this.rightPolygon=this.rightGroup.append("polygon"),!0===this.drawBounds&&(this.leftGroup.append("path").attr("class","left area bounds"),this.rightGroup.append("path").attr("class","right area bounds")),this.leftGroup.append("path").attr("class","left values-line"),this.rightGroup.append("path").attr("class","right values-line"),this._x=null,this._y=null}M.prototype.style=function(e,t){return this.leftGroup.style(e,t),this.rightGroup.style(e,t),this},M.prototype.x=function(e){return null==e?this._x:(this._x=e,this)},M.prototype.y=function(e){return null==e?this._y:(this._y=e,this)},M.prototype.redraw=function(){const e=this._y.domain(),t=e[0],i=e[1],s=this._x.domain(),a=s[0],r=s[1],o=this,n=this.data.filter((function(e){return e.date<o.from})),l=this.data.filter((function(e){return e.date>o.to}));if(!0===this.drawBounds){const e=b.a.svg.area().x((function(e){return o._x(e.date)||1})).y0((function(e){return o._y(Math.min(i,Math.max(e.lower,t)))})).y1((function(e){return o._y(Math.max(t,Math.min(e.upper,i)))})).defined((e=>null!==e.lower&&null!==e.upper));this.leftGroup.select(".left.area.bounds").attr("d",e(n)),this.rightGroup.select(".right.area.bounds").attr("d",e(l))}const c=b.a.svg.line().x((function(e){return o._x(e.date)})).y((function(e){return o._y(e.value)})).defined((e=>null!==e.value));this.leftGroup.select(".left.values-line").attr("d",c(n)),Object(O.f)(n,this.leftGroup,c,1),this.rightGroup.select(".right.values-line").attr("d",c(l)),Object(O.f)(l,this.rightGroup,c,1);const d=this._x(a),u=this._y(t)+this.swimlaneHeight,m=this._x(this.from),h=this._x(this.to),p=this._y(t)+this.swimlaneHeight,f=this._x(r);return this.leftPolygon.attr("points",d+","+u+"  "+m+","+u+"  "+m+",0  "+d+",0"),this.rightPolygon.attr("points",h+","+p+"  "+f+","+p+"  "+f+",0  "+h+",0"),this},M.prototype.reveal=function(e){return this.from=e[0],this.to=e[1],this.redraw(),this};var C=i(94),F=i(135),I=i(197);const D="mlAnnotationMask";function T(){const{annotationUpdatesService:e}=this.props,t=this.focusXScale,i=b.a.svg.brush().x(t).on("brushend",function(){const{selectedJob:t}=this.props,s=i.extent(),a=s[0].getTime(),r=s[1].getTime();if(a===r)return void e.setValue(null);const o={timestamp:a,end_timestamp:r,annotation:"",job_id:t.job_id,type:I.d.ANNOTATION};e.setValue(o)}.bind(this));return i}function _(e){const t={};return e.forEach(((i,s)=>{if(void 0!==i.key){const a=e.filter(((e,t)=>t<s));t[i.key]=a.reduce(((e,s)=>void 0===i.end_timestamp||void 0===s.end_timestamp||void 0===s.key||s.timestamp<i.timestamp&&s.end_timestamp<i.timestamp||s.timestamp>i.end_timestamp&&s.end_timestamp>i.end_timestamp?e:t[s.key]+1),0)}})),t}function P(e){b.a.selectAll(".mlAnnotation").each((function(t){const i=b.a.select(this);t._id===e._id?i.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!0):(i.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!0),i.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!0),i.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isBlur",!0))}))}function B(){b.a.selectAll(".mlAnnotation").each((function(){const e=b.a.select(this);e.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!1),e.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!1).classed("mlAnnotationRect-isBlur",!1),e.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!1)}))}var R=i(170),N=i(399),V=i(388),z=i(6);const L=350,$=25,J=310,U=335,H=25,W=O.a+4,Y={top:10,right:10,bottom:15,left:40},G=[{duration:g.a.duration(1,"h"),label:"1h"},{duration:g.a.duration(12,"h"),label:"12h"},{duration:g.a.duration(1,"d"),label:"1d"},{duration:g.a.duration(1,"w"),label:"1w"},{duration:g.a.duration(2,"w"),label:"2w"},{duration:g.a.duration(1,"M"),label:"1M"}],X=b.a.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]),q=b.a.scale.threshold().domain([3,25,50,75,100]).range(["#dce7ed","#b0c5d6","#b1a34e","#b17f4e","#c88686"]);function Z(e){const t=e<L?L:e,i=Math.round(.634*t);return{focusChartHeight:i,focusHeight:$+i}}class timeseries_chart_TimeseriesChartIntl extends r.Component{constructor(e){super(e),u()(this,"getTimeBuckets",void 0),u()(this,"mlTimeSeriesExplorer",void 0),u()(this,"rowMouseenterSubscriber",null),u()(this,"rowMouseleaveSubscriber",null),u()(this,"contextChartInitialized",!1),u()(this,"drawContextBrush",(e=>{const{contextChartSelected:t}=this.props,i=this.brush,s=this.contextXScale,a=this.mask;i.x(s).on("brush",d).on("brushend",(function(){const a=i.empty()?s.domain():i.extent(),r=a[0].getTime(),o=a[1].getTime();void 0!==c.selectedBounds&&c.selectedBounds.min.valueOf()===r&&c.selectedBounds.max.valueOf()===o||(e.selectAll(".swimlane-cell").style("fill",(e=>{const t=e.date.getTime();return t<r||t>o?q(e.score):X(e.score)})),c.selectedBounds={min:g()(r),max:g()(o)},t({from:a[0],to:a[1]}))})),e.append("g").attr("class","x brush").call(i).selectAll("rect").attr("y",-1).attr("height",91).attr("width",this.vizWidth);const r=i.extent();e.selectAll(".w rect").attr("x",-10).attr("width",10),e.selectAll(".e rect").attr("transform",null).attr("width",10);const o=e.append("rect").attr("class","top-border").attr("y",-2).attr("height",3),n=e.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",s(r[0])-10).html('\n        <div class="brush-handle-inner brush-handle-inner-left" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="5,0 5,8 0,4" />\n          </svg>\n        </div>'),l=e.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",s(r[1])+0).html('\n        <div class="brush-handle-inner brush-handle-inner-right" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="0,0 0,8 5,4" />\n          </svg>\n        </div>'),c=this;function d(){const e=i.extent();a.reveal(e),n.attr("x",s(e[0])-10),l.attr("x",s(e[1])+0),o.attr("x",s(e[0])+1);const t=Math.max(0,s(e[1])-s(e[0])-2);o.attr("width",t);const r=i.empty();b.a.select(c.rootNode).selectAll(".brush-handle").style("visibility",r?"hidden":"visible")}d()})),u()(this,"drawSwimlane",((e,t,i)=>{const{contextAggregationInterval:s,swimlaneData:a}=this.props,r=a;if(void 0===r)return;const o=this.calculateContextXAxisDomain(),n=b.a.time.scale().range([0,t]).domain(o),l=b.a.scale.linear().range([i,0]).domain([0,i]),c=b.a.svg.axis().scale(n).orient("bottom").innerTickSize(-i).outerTickSize(0),d=b.a.svg.axis().scale(l).orient("left").tickValues(l.domain()).innerTickSize(-t).outerTickSize(0),u=e.append("g");u.append("g").attr("class","x axis").attr("transform","translate(0,"+i+")").call(c),u.append("g").attr("class","y axis").call(d);const m=o[0].getTime();let h=t/((o[1].getTime()-m)/s.asMilliseconds());h<1&&(h=1),e.append("g").attr("class","swimlane-cells").selectAll("rect").data(r).enter().append("rect").attr("x",(e=>n(e.date))).attr("y",0).attr("rx",0).attr("ry",0).attr("class",(e=>e.score>0?"swimlane-cell":"swimlane-cell-hidden")).attr("width",h).attr("height",i).style("fill",(e=>X(e.score)))})),u()(this,"calculateContextXAxisDomain",(()=>{const{bounds:e,contextAggregationInterval:t,swimlaneData:i}=this.props;let s=e.min.valueOf();void 0!==i&&i.length>0&&(s=Math.min(i[0].date.getTime(),e.min.valueOf()));const a=t.asMilliseconds(),r=Math.floor(s/a)*a,o=Math.ceil(e.max.valueOf()/a)*a;return[new Date(r),new Date(o)]})),u()(this,"setContextBrushExtent",((e,t)=>{const i=b.a.select(this.rootNode),s=this.brush,a=s.extent(),r=[e,t];s.extent(r),s(i.select(".brush")),r[0].getTime()===a[0].getTime()&&r[1].getTime()===a[1].getTime()||s.event(i.select(".brush"))})),u()(this,"setShowRuleEditorFlyoutFunction",(e=>{this.setState({showRuleEditorFlyout:e})})),u()(this,"unsetShowRuleEditorFlyoutFunction",(()=>{this.setState({showRuleEditorFlyout:()=>{}})})),this.state={popoverData:null,popoverCoords:[0,0],showRuleEditorFlyout:()=>{}}}componentWillUnmount(){b.a.select(this.rootNode).html(""),null!==this.rowMouseenterSubscriber&&this.rowMouseenterSubscriber.unsubscribe(),null!==this.rowMouseleaveSubscriber&&this.rowMouseleaveSubscriber.unsubscribe()}componentDidMount(){this.mlTimeSeriesExplorer=Object(C.timeSeriesExplorerServiceFactory)(this.context.services.uiSettings,this.context.services.mlServices.mlApiServices,this.context.services.mlServices.mlResultsService),this.getTimeBuckets=Object(A.a)(this.context.services.uiSettings).getTimeBuckets;const{svgWidth:e,svgHeight:t}=this.props,{focusHeight:i,focusChartHeight:s}=t?Z(t):{};this.vizWidth=e-Y.left-Y.right;const a=this.vizWidth;this.focusXScale=b.a.time.scale().range([0,a]),this.focusYScale=b.a.scale.linear().range([null!=i?i:U,$]);const r=this.focusXScale,o=this.focusYScale;this.focusXAxis=b.a.svg.axis().scale(r).orient("bottom").innerTickSize(-(null!=s?s:J)).outerTickSize(0).tickPadding(10),this.focusYAxis=b.a.svg.axis().scale(o).orient("left").innerTickSize(-a).outerTickSize(0).tickPadding(10),this.focusValuesLine=b.a.svg.line().x((function(e){return r(e.date)})).y((function(e){return o(e.value)})).defined((e=>null!==e.value)),this.focusBoundedArea=b.a.svg.area().x((function(e){return r(e.date)||1})).y0((function(e){return o(e.upper)})).y1((function(e){return o(e.lower)})).defined((e=>null!==e.lower&&null!==e.upper)),this.contextXScale=b.a.time.scale().range([0,a]),this.contextYScale=b.a.scale.linear().range([60,3]),this.fieldFormat=void 0,this.annotateBrush=T.call(this),this.brush=b.a.svg.brush(),this.mask=void 0;const n=this.highlightFocusChartAnomaly.bind(this),l=P.bind(this),c=this.unhighlightFocusChartAnomaly.bind(this),d=B.bind(this);this.rowMouseenterSubscriber=E.a.rowMouseenter$.subscribe(function({record:e,type:t="anomaly"}){null===this.state.popoverData&&("anomaly"===t?n(e):"annotation"===t&&l(e))}.bind(this)),this.rowMouseleaveSubscriber=E.a.rowMouseleave$.subscribe((function({record:e,type:t="anomaly"}){"anomaly"===t?c():d(e)})),this.renderChart(),this.drawContextChartSelection(),this.renderFocusChart()}componentDidUpdate(e){!1!==this.props.renderFocusChartOnly&&e.svgWidth===this.props.svgWidth&&e.showAnnotations===this.props.showAnnotations&&e.annotationData===this.props.annotationData||(this.renderChart(),this.drawContextChartSelection()),this.renderFocusChart(),null===this.props.annotation&&b.a.select(this.rootNode).select("g.mlAnnotationBrush").call(this.annotateBrush.extent([0,0]))}renderChart(){const{contextChartData:e,contextForecastData:t,detectorIndex:i,modelPlotEnabled:s,selectedJob:a,svgWidth:r,svgHeight:o,showAnnotations:n}=this.props,l=this.createFocusChart.bind(this),c=this.drawContextElements.bind(this),d=this.focusXScale,u=this.focusYAxis,m=this.focusYScale,h=function(e,t){const i=e?W:0,s=t&&t<L?L:t,{focusHeight:a}=t?Z(s):{};return(null!=a?a:U)+60+30+i+H+Y.top+Y.bottom}(n,o),{focusHeight:p}=o?Z(o):{},f=b.a.select(this.rootNode);if(f.selectAll("*").remove(),void 0===a)return;if(this.fieldFormat=this.context.services.mlServices.mlFieldFormatService.getFieldFormat(a.job_id,i),void 0===e)return;const x=this.fieldFormat,g=f.append("svg").attr("width",r).attr("height",h);let v,y;if(!0===s||void 0!==t&&t.length>0){const i=void 0===t?e:e.concat(t);v=b.a.min(i,(e=>Math.min(e.value,e.lower))),y=b.a.max(i,(e=>Math.max(e.value,e.upper)))}else v=b.a.min(e,(e=>e.value)),y=b.a.max(e,(e=>e.value));const S=y>0?Math.pow(10,Math.ceil(Math.log10(Math.abs(y)))):y,k=v>=0?v:-1*Math.pow(10,Math.ceil(Math.log10(Math.abs(v))));m.domain([k,S]);let j=0;g.append("g").attr("class","temp-axis-label tick").selectAll("text.temp.axis").data(m.ticks()).enter().append("text").text((e=>void 0!==x?x.convert(e,"text"):m.tickFormat()(e))).each((function(){j=Math.max(this.getBBox().width+u.tickPadding(),j)})).remove(),f.select(".temp-axis-label").remove(),Y.left=Math.max(j,40),this.vizWidth=Math.max(r-Y.left-Y.right,0),d.range([0,this.vizWidth]),u.innerTickSize(-this.vizWidth),void 0!==p&&m.range([p,$]);const w=g.append("g").attr("class","focus-chart").attr("transform","translate("+Y.left+","+Y.top+")"),O=g.append("g").attr("class","context-chart").attr("transform","translate("+Y.left+","+((null!=p?p:U)+Y.top+H)+")");g.append("defs").append("mask").attr("id",D).append("rect").attr("x",0).attr("y",0).attr("width",this.vizWidth).attr("height",null!=p?p:U).style("fill","white"),l(w,this.vizWidth,null!=p?p:U),c(O,this.vizWidth,60,30,W)}drawContextChartSelection(){const{contextChartData:e,contextForecastData:t,zoomFrom:i,zoomTo:s}=this.props;if(void 0===e)return;let a,r;const o=this.contextXScale.domain()[0].getTime(),n=this.contextXScale.domain()[1].getTime();let l=e;if(void 0!==t&&(l=l.concat(t)),a=i?i.getTime():Object(p.reduce)(l,((e,t)=>Math.min(e,t.date.getTime())),new Date(2099,12,31).getTime()),a=Math.max(a,o),r=s?s.getTime():Object(p.reduce)(l,((e,t)=>Math.max(e,t.date.getTime())),0),r=Math.min(r,n),a!==o||r!==n){this.setContextBrushExtent(new Date(a),new Date(r));const e={min:g()(new Date(a)),max:g()(a)};this.selectedBounds=e}else{const e=this.contextXScale.domain(),t={min:g()(new Date(e[0])),max:g()(e[1])};Object(p.isEqual)(t,this.selectedBounds)||(this.selectedBounds=t,this.setContextBrushExtent(new Date(e[0]),new Date(e[1])))}}createFocusChart(e,t,i){const{contextForecastData:s}=this.props,{focusChartHeight:a}=this.props.svgHeight?Z(this.props.svgHeight):{},r=e.append("g").attr("class","focus-zoom");r.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",$).attr("class","chart-border"),this.createZoomInfoElements(r,t);const o=this.annotateBrush.bind(this);let n=0,l=0;null!==this.props.annotation&&(n=this.focusXScale(this.props.annotation.timestamp),l=function(e,t){const i=t(e.timestamp)+1,s=void 0!==e.end_timestamp?t(e.end_timestamp)-1:i+8;return Math.max(8,s-i)}(this.props.annotation,this.focusXScale)),e.append("g").attr("class","mlAnnotationBrush").call(o).selectAll("rect").attr("x",n).attr("y",$).attr("width",l).attr("height",null!=a?a:J),e.append("g").classed("mlAnnotations",!0),e.append("rect").attr("x",0).attr("y",$).attr("width",t).attr("height",null!=a?a:J).attr("class","chart-border");const c=e.append("g").attr("class","x-axis-background");c.append("rect").attr("x",0).attr("y",i).attr("width",t).attr("height",H),c.append("line").attr("x1",0).attr("y1",i).attr("x2",0).attr("y2",i+H),c.append("line").attr("x1",t).attr("y1",i).attr("x2",t).attr("y2",i+H),c.append("line").attr("x1",0).attr("y1",i+H).attr("x2",t).attr("y2",i+H);const d=e.append("g");d.append("g").attr("class","x axis").attr("transform","translate(0,"+i+")"),d.append("g").attr("class","y axis"),e.append("path").attr("class","area bounds"),e.append("path").attr("class","values-line"),e.append("g").attr("class","focus-chart-markers"),s&&(e.append("path").attr("class","area forecast").attr("data-test-subj","mlForecastArea"),e.append("path").attr("class","values-line forecast").attr("data-test-subj","mlForecastValuesline"),e.append("g").attr("class","focus-chart-markers forecast").attr("data-test-subj","mlForecastMarkers")),e.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",i+24).attr("class","chart-border chart-border-highlight")}renderFocusChart(){const{embeddableMode:e,focusAggregationInterval:t,focusAnnotationData:i,focusChartData:s,focusForecastData:a,modelPlotEnabled:r,selectedJob:o,showAnnotations:l,showForecast:c,showModelBounds:d,zoomFromFocusLoaded:u,zoomToFocusLoaded:m}=this.props,h=Array.isArray(i)?i:[];if(void 0===s)return;const p=s,f=this.contextYScale,x=this.showAnomalyPopover.bind(this),v=this.showFocusChartTooltip.bind(this),S=this.props.tooltipService.hide.bind(this.props.tooltipService),k=b.a.select(this.rootNode),j=k.select(".focus-chart"),w=t.expression,A=o.analysis_config.bucket_span;if(k.select(".zoom-aggregation-interval").text(n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomAggregationIntervalLabel",{defaultMessage:"(aggregation interval: {focusAggInt}, bucket span: {bucketSpan})",values:{focusAggInt:w,bucketSpan:A}})),void 0===u||void 0===m)return;const E={min:g()(u.getTime()),max:g()(m.getTime())},M=t.asMilliseconds(),C=g()(Math.floor(E.min.valueOf()/M)*M),F=g()(Math.ceil(E.max.valueOf()/M)*M);if(this.focusXScale.domain([C.toDate(),F.toDate()]),s.length>0||void 0!==a&&a.length>0){void 0!==this.fieldFormat?this.focusYAxis.tickFormat((e=>this.fieldFormat.convert(e,"text"))):this.focusYAxis.tickFormat(null);let e=0,t=0,i=p;if(c&&void 0!==a&&a.length>0&&(i=p.concat(a)),e=b.a.min(i,(e=>{let t=e.value;return null===t&&void 0!==e.anomalyScore&&void 0!==e.actual&&(t=Array.isArray(e.actual)?e.actual[0]:e.actual),void 0!==e.lower?null!=t?Math.min(t,e.lower):e.lower:t||0})),t=b.a.max(i,(e=>{let t=e.value;return null===t&&void 0!==e.anomalyScore&&void 0!==e.actual&&(t=Array.isArray(e.actual)?e.actual[0]:e.actual),void 0!==e.upper?Math.max(t,e.upper):t||0})),t===e&&(this.contextYScale.domain()[0]!==f.domain()[1]&&e>=f.domain()[0]&&t<=f.domain()[1]?(e=f.domain()[0],t=f.domain()[1]):(e-=.05*e,t+=.05*t)),l&&h&&h.length>0){const i=_(h),s=b.a.max(Object.keys(i).map((e=>i[e])));t+=Math.abs(t-e)*((s+1)/5)}this.focusYScale.domain([e,t])}else this.focusYScale.domain([0,10]),this.focusYAxis.tickFormat("");const I=this.getTimeBuckets();I.setInterval("auto"),I.setBounds(E);const T=I.getScaledDateFormat();j.select(".x.axis").call(this.focusXAxis.ticks(Object(O.m)(this.vizWidth),T).tickFormat((e=>g()(e).format(T)))),j.select(".y.axis").call(this.focusYAxis),Object(O.g)(j.select(".x.axis"),this.vizWidth),!0===r&&j.select(".area.bounds").attr("d",this.focusBoundedArea(p)).classed("hidden",!d);const{focusChartHeight:P,focusHeight:B}=this.props.svgHeight?Z(this.props.svgHeight):{};!function(e,t,i,s,a,r,o,n,l){const c={};t.forEach((e=>{if(void 0!==e.key){const t=(e.end_timestamp||0)-e.timestamp;c[e.key]=t}})),t.sort(((e,t)=>void 0===e.key||void 0===t.key?0:c[t.key]-c[e.key]));const d=_(t),u=function(e){o(e,this)},m=e=>{l.setValue(null),l.setValue(e)},h=e.select(".mlAnnotations").selectAll("g.mlAnnotation").data(t||[],(e=>e._id||""));h.enter().append("g").classed("mlAnnotation",!0);const p=h.selectAll(".mlAnnotationRect").data((e=>[e]));p.enter().append("rect").classed("mlAnnotationRect",!0).attr("mask",`url(#${D})`).on("mouseover",u).on("mouseout",n).on("click",m),p.attr("x",(e=>{const t=g()(e.timestamp);return Math.max(a(t),0)})).attr("y",(e=>26+28*(void 0!==e.key?d[e.key]:1))).attr("height",(e=>{const t=void 0!==e.key?d[e.key]:1;return s-2-0-28*t})).attr("width",(e=>{const t=a(g()(e.timestamp))+1,i=void 0!==e.end_timestamp?a(g()(e.end_timestamp))-1:t+8;return Math.max(8,i-t)})),p.exit().remove();const f=h.selectAll(".mlAnnotationTextRect").data((e=>[e])),b=h.selectAll(".mlAnnotationText").data((e=>[e]));function x(e){const t=a.domain()[0],i=a.domain()[1],s=g()(e),r=Math.max(a(t),a(s));return Math.min(a(i)-32,r)}f.enter().append("rect").classed("mlAnnotationTextRect",!0).attr("width",24).attr("height",20).on("mouseover",u).on("mouseout",n).on("click",m),b.enter().append("text").classed("mlAnnotationText",!0).on("mouseover",u).on("mouseout",n).on("click",m),b.attr("x",(e=>x(e.timestamp)+17)).attr("y",(e=>44+28*(void 0!==e.key?d[e.key]:1))).text((e=>e.key)),f.attr("x",(e=>x(e.timestamp)+5)).attr("y",(e=>30+28*(void 0!==e.key?d[e.key]:1))),f.exit().remove(),b.exit().remove(),h.classed("mlAnnotationHidden",!r),h.exit().remove()}(j,h,0,null!=P?P:J,this.focusXScale,l,v,S,this.props.annotationUpdatesService),j.select(".mlAnnotationBrush").style("display",!l||e?"none":null),j.select(".values-line").attr("d",this.focusValuesLine(p)),Object(O.f)(p,j,this.focusValuesLine);const R=k.select(".focus-chart-markers").selectAll(".metric-value").data(p.filter((e=>(null!==e.value||"number"==typeof e.anomalyScore)&&!Object(O.o)(e)))),N=this;R.exit().remove(),R.enter().append("circle").attr("r",O.b).on("click",(function(e){b.a.event.preventDefault(),void 0!==e.anomalyScore&&x(e,this)})).on("mouseover",(function(e){null===N.state.popoverData&&v(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),R.attr("cx",(e=>this.focusXScale(e.date))).attr("cy",(e=>this.focusYScale(e.value))).attr("data-test-subj",(e=>void 0!==e.anomalyScore?"mlAnomalyMarker":void 0)).attr("class",(e=>{let t="metric-value";return void 0!==e.anomalyScore&&(t+=` anomaly-marker ${Object(y.e)(e.anomalyScore).id}`),t}));const V=k.select(".focus-chart-markers").selectAll(".multi-bucket").data(p.filter((e=>null!==e.anomalyScore&&!0===Object(O.o)(e))));V.exit().remove(),V.enter().append("path").attr("d",b.a.svg.symbol().size(O.c).type("cross")).on("click",(function(e){b.a.event.preventDefault(),void 0!==e.anomalyScore&&x(e,this)})).on("mouseover",(function(e){v(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),V.attr("transform",(e=>`translate(${this.focusXScale(e.date)}, ${this.focusYScale(e.value)})`)).attr("data-test-subj","mlAnomalyMarker").attr("class",(e=>`anomaly-marker multi-bucket ${Object(y.e)(e.anomalyScore).id}`));const z=k.select(".focus-chart-markers").selectAll(".scheduled-event-marker").data(p.filter((e=>void 0!==e.scheduledEvents)));if(z.exit().remove(),z.enter().append("rect").on("mouseover",(function(e){v(e,this)})).on("mouseout",(()=>S())).attr("width",2*O.b).attr("height",O.d).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1),z.attr("x",(e=>this.focusXScale(e.date)-O.b)).attr("y",(e=>{const t=this.focusYScale(e.value);return isNaN(t)?-(null!=B?B:U)-3:t-3})),void 0!==a){j.select(".area.forecast").attr("d",this.focusBoundedArea(a)).classed("hidden",!c),j.select(".values-line.forecast").attr("d",this.focusValuesLine(a)).classed("hidden",!c);const e=k.select(".focus-chart-markers.forecast").selectAll(".metric-value").data(a);e.exit().remove(),e.enter().append("circle").attr("r",O.b).on("mouseover",(function(e){v(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),e.attr("cx",(e=>this.focusXScale(e.date))).attr("cy",(e=>this.focusYScale(e.value))).attr("class","metric-value").classed("hidden",!c)}}createZoomInfoElements(e,t){const{autoZoomDuration:i,bounds:s,modelPlotEnabled:a}=this.props,r=this.setZoomInterval.bind(this),o=s.max.unix()-s.min.unix(),l=10/this.vizWidth*o;let c=10;const d=e.append("text").attr("x",c).attr("y",17).attr("class","zoom-info-text").text(n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomLabel",{defaultMessage:"Zoom:"})),u=[{durationMs:i,label:"auto"}];if(Object(p.each)(G,(e=>{e.duration.asSeconds()>l&&e.duration.asSeconds()<o&&u.push({durationMs:e.duration.asMilliseconds(),label:e.label})})),c+=d.node().getBBox().width+4,Object(p.each)(u,(t=>{const i=e.append("a").attr("data-ms",t.durationMs).attr("href","").append("text").attr("x",c).attr("y",17).attr("class","zoom-info-text").text(t.label);c+=i.node().getBBox().width+4})),e.append("text").attr("x",c+6).attr("y",17).attr("class","zoom-info-text zoom-aggregation-interval").text(n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomGroupAggregationIntervalLabel",{defaultMessage:"(aggregation interval: , bucket span: )"})),!1===a){const i=e.append("text").attr("x",300).attr("y",17).attr("class","zoom-info-text").text(n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelBoundsNotAvailableLabel",{defaultMessage:"Model bounds are not available"}));i.attr("x",t-(i.node().getBBox().width+10))}b.a.select(this.rootNode).selectAll(".focus-zoom a").on("click",(function(){b.a.event.preventDefault(),r(this.getAttribute("data-ms"))}))}drawContextElements(e,t,i,s){const{bounds:a,contextChartData:r,contextForecastData:o,modelPlotEnabled:n,annotationData:l}=this.props,c=r,d=Array.isArray(l)?[...l].sort(((e,t)=>e.timestamp-t.timestamp)):[];let u=[];if(d.length>0){u=[{start:d[0].timestamp,end:d[0].end_timestamp,annotations:[d[0]]}];let e=d[0].end_timestamp;for(let t=1;t<d.length;t++){if(d[t].timestamp<e){const i=u.pop(),s={...i,end:e,annotations:[...i.annotations,d[t]]};u.push(s)}else u.push({start:d[t].timestamp,end:d[t].end_timestamp,annotations:[d[t]]});e=d[t].end_timestamp}}const m=this.showFocusChartTooltip.bind(this),h=this.props.tooltipService.hide.bind(this.props.tooltipService);this.contextXScale=b.a.time.scale().range([0,t]).domain(this.calculateContextXAxisDomain());const f=void 0===o?c:c.concat(o),x={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(p.each)(f,(e=>{var t,i;const s=null!==(t=e.lower)&&void 0!==t?t:Number.MAX_VALUE,a=null!==(i=e.upper)&&void 0!==i?i:Number.MIN_VALUE;x.min=Math.min(e.value,s,x.min),x.max=Math.max(e.value,a,x.max)}));let v=x.min,y=x.max;const S={min:v,max:y};if(!0===n||void 0!==o&&o.length>0){const e={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(p.each)(f,(t=>{e.min=Math.min(t.lower,e.min),e.max=Math.max(t.upper,e.max)})),v=Math.min(v,e.min),y=Math.max(y,e.max),x.max-x.min<.5*(y-v)&&(x.min>v&&(S.min=x.min-.5*(x.max-x.min)),x.max<y&&(S.max=x.max+.5*(x.max-x.min)))}this.contextYScale=b.a.scale.linear().range([i,3]).domain([S.min,S.max]);const k=e.append("g").attr("class","axis"),j=i+s+W;k.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",j),k.append("line").attr("x1",t).attr("y1",0).attr("x2",t).attr("y2",j),k.append("line").attr("x1",0).attr("y1",j).attr("x2",t).attr("y2",j);const w=this.getTimeBuckets();w.setInterval("auto"),w.setBounds(a);const A=w.getScaledDateFormat(),E=b.a.svg.axis().scale(this.contextXScale).orient("top").innerTickSize(-i).outerTickSize(0).tickPadding(0).ticks(Object(O.m)(t,A)).tickFormat((e=>g()(e).format(A)));e.datum(c);const C=b.a.svg.area().x((e=>this.contextXScale(e.date))).y0((e=>this.contextYScale(Math.min(S.max,Math.max(e.lower,S.min))))).y1((e=>this.contextYScale(Math.max(S.min,Math.min(e.upper,S.max))))).defined((e=>null!==e.lower&&null!==e.upper));!0===n&&e.append("path").datum(c).attr("class","area bounds").attr("d",C);const F=b.a.svg.line().x((e=>this.contextXScale(e.date))).y((e=>this.contextYScale(e.value))).defined((e=>null!==e.value));e.append("path").datum(c).attr("class","values-line").attr("d",F),Object(O.f)(c,e,F,1),e.append("g").classed("mlContextAnnotations",!0);const[I,D]=this.contextXScale.range(),T=e.select(".mlContextAnnotations").selectAll("g.mlContextAnnotation").data(u,(e=>`${e.start}-${e.end}`||""));T.enter().append("g").classed("mlContextAnnotation",!0);const _=T.selectAll(".mlContextAnnotationRect").data((e=>[e]));_.enter().append("rect").on("mouseover",(function(e){m(1===e.annotations.length?e.annotations[0]:e,this)})).on("mouseout",(()=>h())).classed("mlContextAnnotationRect",!0),_.attr("x",(e=>{const t=g()(e.start);let i=this.contextXScale(t);return i-O.a<=I&&(i=0),i+O.a>=D&&(i=D-O.a),i})).attr("y",i+s+2).attr("height",O.a).attr("width",(e=>{const t=Math.max(this.contextXScale(g()(e.start))+1,I),i=Math.min(D,void 0!==e.end?this.contextXScale(g()(e.end))-1:t+8);return Math.max(8,i-t)})),_.exit().remove(),void 0!==o&&(e.append("path").datum(o).attr("class","area forecast").attr("d",C),e.append("path").datum(o).attr("class","values-line forecast").attr("d",F));const P=e.append("g").attr("class","swimlane").attr("transform","translate(0,"+i+")");this.drawSwimlane(P,t,s),this.mask=new M(e,r,n,s).x(this.contextXScale).y(this.contextYScale),e.append("g").attr("class","x axis context-chart-axis").call(E),e.selectAll(".x.context-chart-axis text").attr("dy",i-5),Object(O.g)(e.selectAll(".x.context-chart-axis"),t),this.drawContextBrush(e)}setZoomInterval(e){const{bounds:t,zoomTo:i}=this.props,s=t.min.valueOf(),a=t.max.valueOf(),r=+e;let o=i.getTime(),n=o-r;n<s&&(n=s,o=Math.min(s+r,a)),this.setContextBrushExtent(new Date(n),new Date(o))}showAnomalyPopover(e,t){const i=e.date.getTime(),s=this.props.tableData.anomalies.reduce(((e,t)=>{const s=Math.abs(i-e.source.timestamp);return Math.abs(i-t.source.timestamp)<s?t:e}),this.props.tableData.anomalies[0]);if(s){s.source.timestamp=i;const e=t.getBoundingClientRect(),a=this.rootNode.getBoundingClientRect(),r=Math.round(e.x+e.width/2-a.x),o=Math.round(e.y+e.height/2-a.y)-28;this.props.tooltipService.hide(),this.setState({popoverData:s,popoverCoords:[r,o]})}}showFocusChartTooltip(e,t){var i;const{modelPlotEnabled:s}=this.props,a=this.fieldFormat,r="single_metric_viewer",o=[{label:Object(k.c)(e.date)}];if(void 0!==e.anomalyScore){const t=parseInt(e.anomalyScore);if(o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:Object(S.a)(t),color:X(t),seriesIdentifier:{key:r},valueAccessor:"anomaly_score"}),!0===Object(O.p)(e)&&o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.multiBucketAnomalyLabel",{defaultMessage:"multi-bucket impact"}),value:Object(O.j)(e),seriesIdentifier:{key:r},valueAccessor:"multi_bucket_impact"}),e.metricFunction&&o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.metricActualPlotFunctionLabel",{defaultMessage:"function"}),value:e.metricFunction,seriesIdentifier:{key:r},valueAccessor:"metric_function"}),!1===s){if(void 0!==e.actual&&"rare"!==e.function)o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.actualLabel",{defaultMessage:"actual"}),value:Object(w.b)(e.actual,e.function,a),seriesIdentifier:{key:r},valueAccessor:"actual"}),o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.typicalLabel",{defaultMessage:"typical"}),value:Object(w.b)(e.typical,e.function,a),seriesIdentifier:{key:r},valueAccessor:"typical"});else if(void 0!==e.value&&o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.valueLabel",{defaultMessage:"value"}),value:Object(w.b)(e.value,e.function,a),seriesIdentifier:{key:r},valueAccessor:"value"}),void 0!==e.byFieldName&&void 0!==e.numberOfCauses){const t=e.numberOfCauses,i=Object(F.f)(e.byFieldName);o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.moreThanOneUnusualByFieldValuesLabel",{defaultMessage:"{numberOfCauses}{plusSign} unusual {byFieldName} values",values:{numberOfCauses:t,byFieldName:i,plusSign:t<10?"":"+"}}),seriesIdentifier:{key:r},valueAccessor:"numberOfCauses"})}}else e.annotations||(o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.actualLabel",{defaultMessage:"actual"}),value:Object(w.b)(e.actual,e.function,a),seriesIdentifier:{key:r},valueAccessor:"actual"}),o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(w.b)(e.upper,e.function,a),seriesIdentifier:{key:r},valueAccessor:"upper_bounds"}),o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(w.b)(e.lower,e.function,a),seriesIdentifier:{key:r},valueAccessor:"lower_bounds"}))}else!0===Object(p.get)(e,"isForecast",!1)?o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.predictionLabel",{defaultMessage:"prediction"}),value:Object(w.b)(e.value,e.function,a),seriesIdentifier:{key:r},valueAccessor:"prediction"}):void 0!==e.value&&null!==e.value&&o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.valueLabel",{defaultMessage:"value"}),value:Object(w.b)(e.value,e.function,a),seriesIdentifier:{key:r},valueAccessor:"value"}),e.annotations||!0!==s||(o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(w.b)(e.upper,e.function,a),seriesIdentifier:{key:r},valueAccessor:"upper_bounds"}),o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(w.b)(e.lower,e.function,a),seriesIdentifier:{key:r},valueAccessor:"lower_bounds"}));if(void 0!==e.scheduledEvents&&e.scheduledEvents.forEach(((t,i)=>{o.push({label:n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",{defaultMessage:"scheduled event{counter}",values:{counter:e.scheduledEvents.length>1?` #${i+1}`:""}}),value:t,seriesIdentifier:{key:r},valueAccessor:`scheduled_events_${i+1}`})})),void 0!==e.annotation){o.length=0,o.push({label:e.annotation});let t=g()(e.timestamp).format("MMMM Do YYYY, HH:mm");void 0!==e.end_timestamp&&(t+=` - ${g()(e.end_timestamp).format("MMMM Do YYYY, HH:mm")}`),o.push({label:t,seriesIdentifier:{key:r},valueAccessor:"timespan"})}(null===(i=e.annotations)||void 0===i?void 0:i.length)>1&&e.annotations.forEach((e=>{var t;let i=g()(e.timestamp).format("MMMM Do YYYY, HH:mm");void 0!==e.end_timestamp&&(i+=` - ${g()(e.end_timestamp).format("HH:mm")}`),o.push({label:i,value:`${e.annotation}`,seriesIdentifier:{key:"anomaly_timeline",specId:null!==(t=e._id)&&void 0!==t?t:`${e.annotation}-${e.timestamp}-label`},valueAccessor:"annotation"})}));let l=2*O.b;if("rect"===t.tagName.toLowerCase()){const e=Number(t.getAttribute("x"));e<0&&(l=Math.abs(e))}this.props.tooltipService.show(o,t,{x:l,y:0})}highlightFocusChartAnomaly(e){const{focusChartData:t,focusAggregationInterval:i}=this.props,s=this.focusXScale,a=this.focusYScale,r=this.showFocusChartTooltip.bind(this),o=e.source.timestamp,n=this.mlTimeSeriesExplorer.findChartPointForAnomalyTime(t,o,i),l=b.a.select(this.rootNode);if(void 0!==n){const e=l.select(".focus-chart-markers").selectAll(".focus-chart-highlighted-marker").data([n]);!0===Object(O.o)(n)?e.enter().append("path").attr("d",b.a.svg.symbol().size(O.c).type("cross")).attr("transform",(e=>`translate(${s(e.date)}, ${a(e.value)})`)).attr("data-test-subj","mlAnomalyMarker").attr("class",(e=>`anomaly-marker multi-bucket ${Object(y.e)(e.anomalyScore).id} highlighted`)):e.enter().append("circle").attr("r",O.b).attr("cx",(e=>s(e.date))).attr("cy",(e=>a(e.value))).attr("data-test-subj","mlAnomalyMarker").attr("class",(e=>`anomaly-marker metric-value ${Object(y.e)(e.anomalyScore).id} highlighted`));const t=l.selectAll(".focus-chart-markers .anomaly-marker.highlighted");t.length&&r(n,t[0][0])}}unhighlightFocusChartAnomaly(){b.a.select(this.rootNode).select(".focus-chart-markers").selectAll(".anomaly-marker.highlighted").remove(),this.props.tooltipService.hide()}shouldComponentUpdate(){return!0}setRef(e){this.rootNode=e}closePopover(){this.setState({popoverData:null,popoverCoords:[0,0]})}render(){return Object(z.jsx)(o.a.Fragment,null,Object(z.jsx)(V.a,{setShowFunction:this.setShowRuleEditorFlyoutFunction,unsetShowFunction:this.unsetShowRuleEditorFlyoutFunction}),null!==this.state.popoverData&&Object(z.jsx)("div",{style:{position:"absolute",marginLeft:this.state.popoverCoords[0],marginTop:this.state.popoverCoords[1]}},Object(z.jsx)(v.EuiPopover,{isOpen:!0,closePopover:()=>this.closePopover(),panelPaddingSize:"none",anchorPosition:"upLeft"},Object(z.jsx)(N.b,{anomaly:this.state.popoverData,bounds:this.props.bounds,showMapsLink:!1,showViewSeriesLink:!1,isAggregatedData:"second"!==this.props.tableData.interval,interval:this.props.tableData.interval,showRuleEditorFlyout:this.state.showRuleEditorFlyout,onItemClick:()=>this.closePopover(),sourceIndicesWithGeoFields:this.props.sourceIndicesWithGeoFields}))),Object(z.jsx)("div",{className:"ml-timeseries-chart-react",ref:this.setRef.bind(this)}))}}u()(timeseries_chart_TimeseriesChartIntl,"contextType",j.context);const K=e=>{const t=Object(r.useContext)(R.a),i=h()(t.isAnnotationInitialized$());return void 0===i?null:Object(z.jsx)(timeseries_chart_TimeseriesChartIntl,a()({annotation:i},e,{annotationUpdatesService:t}))};var Q=i(162),ee=i(10),te=i(187);const ie=({bounds:e,detectorIndex:t,embeddableMode:i,renderFocusChartOnly:s,selectedJob:o,selectedEntities:d,showAnnotations:u,showForecast:m,showModelBounds:h,chartProps:p,lastRefresh:f,contextAggregationInterval:b,tableData:x={anomalies:[],interval:"second"},sourceIndicesWithGeoFields:g})=>{const{toasts:v}=Object(ee.i)(),{services:{mlServices:{mlApiServices:y}}}=Object(ee.d)(),S=Object(r.useContext)(R.a),[k,j]=Object(r.useState)([]),w=Object(r.useCallback)((e=>{v.addDanger({title:n.i18n.translate("xpack.ml.timeSeriesExplorer.mlSingleMetricViewerChart.annotationsErrorTitle",{defaultMessage:"An error occurred fetching annotations"}),...e?{text:Object(l.a)(e)}:{}})}),[]),O=Object(A.b)();return Object(r.useEffect)((()=>{let i=!1;const s=Object(te.a)(t,d,o.job_id),a=Array.isArray(s)?s.filter((e=>null!==e.fieldValue)):void 0,r=O.getBoundsRoundedToInterval(e,b,!1);return(async e=>{try{const s=await y.annotations.getAnnotations({jobIds:[e],earliestMs:r.min.valueOf(),latestMs:r.max.valueOf(),maxAnnotations:Q.a,detectorIndex:t,entities:a});i||Array.isArray(s.annotations[e])&&j(s.annotations[e])}catch(e){w(e)}})(o.job_id),()=>{i=!0}}),[o.job_id,t,f,d,e,b]),p.svgHeight&&(p.svgHeight-=32),Object(z.jsx)("div",{className:"ml-timeseries-chart","data-test-subj":"mlSingleMetricViewerChart"},Object(z.jsx)(c.a,null,(r=>Object(z.jsx)(K,a()({},p,{annotationUpdatesService:S,annotationData:k,bounds:e,detectorIndex:t,embeddableMode:i,renderFocusChartOnly:s,selectedJob:o,showAnnotations:u,showForecast:m,showModelBounds:h,tooltipService:r,tableData:x,sourceIndicesWithGeoFields:g})))))}},402:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i(25),a=(i(2),i(6));const r=({errorMsg:e})=>Object(a.jsx)(s.EuiEmptyPrompt,{iconType:"warning",title:Object(a.jsx)("h2",null,e)})},494:function(e,t,i){"use strict";i.r(t);var s=i(2),a=i.n(s),r=i(138),o=i.n(r),n=i(5),l=i(25),c=i(21),d=i(143),u=i(86),m=i(281),h=i(377),p=i.n(h),f=i(39),b=i(8),x=i(4),g=i.n(x),v=i(83),y=i.n(v),S=i(7),k=i(15),j=i(374),w=i(162),O=i(123),A=i(240),E=i(324),M=i(195),C=i(187),F=i(394),I=i(252),D=i(242),T=i(402),_=i(6);const P=({id:e,label:t,checked:i,onChange:a})=>{const r=Object(s.useMemo)((()=>`id-${Object(l.htmlIdGenerator)()()}`),[]);return Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiCheckbox,{id:r,label:t,checked:i,onChange:a}))};var B=i(234),R=i(94),N=i(319);const V=n.i18n.translate("xpack.ml.timeSeriesExplorer.allPartitionValuesLabel",{defaultMessage:"all"});class timeseriesexplorer_embeddable_chart_TimeSeriesExplorerEmbeddableChart extends a.a.Component{constructor(...e){super(...e),g()(this,"state",Object(N.a)()),g()(this,"subscriptions",new S.Subscription),g()(this,"unmounted",!1),g()(this,"contextChart$",new S.Subject),g()(this,"getBoundsRoundedToInterval",void 0),g()(this,"mlTimeSeriesExplorer",void 0),g()(this,"getFieldNamesWithEmptyValues",(()=>this.getControlsForDetector().filter((({fieldValue:e})=>null===e)).map((({fieldName:e})=>e)))),g()(this,"arePartitioningFieldsProvided",(()=>0===this.getFieldNamesWithEmptyValues().length)),g()(this,"toggleShowAnnotationsHandler",(()=>{this.setState((e=>({showAnnotations:!e.showAnnotations})))})),g()(this,"toggleShowForecastHandler",(()=>{this.setState((e=>({showForecast:!e.showForecast})))})),g()(this,"toggleShowModelBoundsHandler",(()=>{this.setState({showModelBounds:!this.state.showModelBounds})})),g()(this,"setFunctionDescription",(e=>{this.props.appStateHandler(M.a.SET_FUNCTION_DESCRIPTION,e)})),g()(this,"previousChartProps",{}),g()(this,"previousShowAnnotations",void 0),g()(this,"previousShowForecast",void 0),g()(this,"previousShowModelBounds",void 0),g()(this,"tableFilter",((e,t,i)=>{const s=this.getControlsForDetector(),a=s.find((({fieldName:t})=>t===e));if(void 0===a)return;const{appStateHandler:r}=this.props;let o="";if("+"===i&&a.fieldValue!==t)o=t;else{if("-"!==i||a.fieldValue!==t)return;o=null}const n={...s.reduce(((e,t)=>(e[t.fieldName]=t.fieldValue,e)),{}),[a.fieldName]:o};r(M.a.SET_ENTITIES,n)})),g()(this,"contextChartSelectedInitCallDone",!1),g()(this,"contextChartSelected",(e=>{const t={from:e.from.toISOString(),to:e.to.toISOString()};Object(b.isEqual)(this.props.zoom,t)&&void 0!==this.state.focusChartData&&this.props.previousRefresh===this.props.lastRefresh||(this.contextChart$.next(e),this.props.appStateHandler(M.a.SET_ZOOM,t))})),g()(this,"loadAnomaliesTableData",((e,t)=>{const{dateFormatTz:i,selectedDetectorIndex:s,selectedJob:a,tableInterval:r,tableSeverity:o,functionDescription:n}=this.props,l=this.getControlsForDetector();return this.context.services.mlServices.mlApiServices.results.getAnomaliesTableData([a.job_id],this.getCriteriaFields(s,l),[],r,o,e,t,i,w.b,void 0,void 0,n).pipe(Object(S.map)((e=>{const{mlJobService:t}=this.context.services.mlServices,i=e.anomalies,s=t.detectorsByJob;return i.forEach((e=>{const i=e.jobId,a=Object(b.get)(s,[i,e.detectorIndex]);e.detector=Object(b.get)(a,["detector_description"],e.source.function_description);const r=a.custom_rules;void 0!==r&&(e.rulesLength=r.length),Object(b.has)(t.customUrlsByJob,i)&&(e.customUrls=t.customUrlsByJob[i])})),{tableData:{anomalies:i,interval:e.interval,examplesByJobId:e.examplesByJobId,showViewSeriesLink:!1}}})))})),g()(this,"setForecastId",(e=>{this.props.appStateHandler(M.a.SET_FORECAST_ID,e)})),g()(this,"displayErrorToastMessages",((e,t)=>{this.props.toastNotificationService&&this.props.toastNotificationService.displayErrorToast(e,t,2e3),this.setState({loading:!1,chartDataError:t})})),g()(this,"loadSingleMetricData",((e=!0)=>{const{autoZoomDuration:t,bounds:i,selectedDetectorIndex:s,zoom:a,functionDescription:r,selectedJob:o}=this.props,{loadCounter:l}=this.state;if(void 0===o)return;if(Object(D.b)(o,s)&&void 0===r)return;const c=I.b.toES(r);this.contextChartSelectedInitCallDone=!1;const d=this.getControlsForDetector();this.setState({fullRefresh:e,loadCounter:l+1,loading:!0,chartDataError:void 0,...e?{chartDetails:void 0,contextChartData:void 0,contextForecastData:void 0,focusChartData:void 0,focusForecastData:void 0,modelPlotEnabled:Object(O.n)(o,s)&&Object(O.o)(o,s,d),hasResults:!1,dataNotChartable:!1}:{}},(()=>{const{loadCounter:e,modelPlotEnabled:r}=this.state,{selectedJob:o}=this.props,l=s;let u=3;const m={},h=s=>{if(u--,0===u&&s===e){if(m.hasResults=Array.isArray(m.contextChartData)&&m.contextChartData.length>0||Array.isArray(m.contextForecastData)&&m.contextForecastData.length>0,m.loading=!1,m.contextChartData.length&&!0===this.arePartitioningFieldsProvided()){let e=this.mlTimeSeriesExplorer.calculateInitialFocusRange(a,m.contextAggregationInterval,i);void 0!==e&&this.previousSelectedForecastId===this.props.selectedForecastId||(e=this.mlTimeSeriesExplorer.calculateDefaultFocusRange(t,m.contextAggregationInterval,m.contextChartData,m.contextForecastData),this.previousSelectedForecastId=this.props.selectedForecastId),this.contextChartSelected({from:e[0],to:e[1]})}this.setState(m),void 0!==this.props.onRenderComplete&&this.props.onRenderComplete()}},p=d.filter((e=>null!==e.fieldValue));if(!1===r&&!1===Object(O.p)(o,l)&&p.length>0)return m.hasResults=!1,m.loading=!1,m.dataNotChartable=!0,void this.setState(m);m.contextAggregationInterval=this.mlTimeSeriesExplorer.calculateAggregationInterval(i,M.b,o);const f=this.getBoundsRoundedToInterval(i,m.contextAggregationInterval,!1),b=e;this.context.services.mlServices.mlTimeSeriesSearchService.getMetricData(o,l,p,f.min.valueOf(),f.max.valueOf(),m.contextAggregationInterval.asMilliseconds(),c).toPromise().then((e=>{const t=this.mlTimeSeriesExplorer.processMetricPlotResults(e.results,r);m.contextChartData=t,h(b)})).catch((e=>{const t=n.i18n.translate("xpack.ml.timeSeriesExplorer.metricDataErrorMessage",{defaultMessage:"Error getting metric data"});this.displayErrorToastMessages(e,t)})),this.context.services.mlServices.mlResultsService.getRecordMaxScoreByTime(o.job_id,this.getCriteriaFields(l,d),f.min.valueOf(),f.max.valueOf(),m.contextAggregationInterval.asMilliseconds(),c).then((e=>{const t=this.mlTimeSeriesExplorer.processRecordScoreResults(e.results);m.swimlaneData=t,h(b)})).catch((e=>{const t=n.i18n.translate("xpack.ml.timeSeriesExplorer.bucketAnomalyScoresErrorMessage",{defaultMessage:"Error getting bucket anomaly scores"});this.displayErrorToastMessages(e,t)})),this.context.services.mlServices.mlTimeSeriesSearchService.getChartDetails(o,l,d,f.min.valueOf(),f.max.valueOf()).then((e=>{m.chartDetails=e.results,h(b)})).catch((e=>{this.displayErrorToastMessages(e,n.i18n.translate("xpack.ml.timeSeriesExplorer.entityCountsErrorMessage",{defaultMessage:"Error getting entity counts"}))}))}))})),g()(this,"getControlsForDetector",(()=>{const{selectedDetectorIndex:e,selectedEntities:t,selectedJobId:i,selectedJob:s}=this.props;return Object(C.a)(e,t,i,s)}))}getFocusAggregationInterval(e){const{selectedJob:t}=this.props,i={min:y()(e.from),max:y()(e.to)};return this.mlTimeSeriesExplorer.calculateAggregationInterval(i,M.b,t)}getFocusData(e){const{selectedForecastId:t,selectedDetectorIndex:i,functionDescription:s,selectedJob:a}=this.props,{modelPlotEnabled:r}=this.state;if(Object(D.b)(a,i)&&void 0===s)return;const o=this.getControlsForDetector(),n={min:y()(e.from),max:y()(e.to)},l=this.getFocusAggregationInterval(e),c=this.getBoundsRoundedToInterval(n,l,!1);return this.mlTimeSeriesExplorer.getFocusData(this.getCriteriaFields(i,o),i,l,t,r,o.filter((e=>null!==e.fieldValue)),c,a,s,M.d)}getCriteriaFields(e,t){return[{fieldName:"detector_index",fieldValue:e},...t.filter((e=>null!==e.fieldValue))]}async componentDidMount(){this.getBoundsRoundedToInterval=Object(B.a)(this.context.services.uiSettings).getBoundsRoundedToInterval,this.mlTimeSeriesExplorer=Object(R.timeSeriesExplorerServiceFactory)(this.context.services.uiSettings,this.context.services.mlServices.mlApiServices,this.context.services.mlServices.mlResultsService),this.subscriptions.add(this.contextChart$.pipe(Object(S.tap)((e=>{this.setState({zoomFrom:e.from,zoomTo:e.to})})),Object(S.debounceTime)(500),Object(S.tap)((e=>{const{contextChartData:t,contextForecastData:i,focusChartData:s,zoomFromFocusLoaded:a,zoomToFocusLoaded:r}=this.state;(void 0!==t&&0!==t.length||void 0!==i&&0!==i.length)&&(!1===this.contextChartSelectedInitCallDone&&void 0===s||a.getTime()!==e.from.getTime()||r.getTime()!==e.to.getTime())&&(this.contextChartSelectedInitCallDone=!0,this.setState({loading:!0,fullRefresh:!1}))})),Object(S.switchMap)((e=>{const t={min:y()(e.from),max:y()(e.to)},i=this.getBoundsRoundedToInterval(t,this.getFocusAggregationInterval({from:e.from,to:e.to}),!1);return Object(S.forkJoin)([this.getFocusData(e),this.loadAnomaliesTableData(i.min.valueOf(),i.max.valueOf())])})),Object(S.withLatestFrom)(this.contextChart$)).subscribe((([[e,t],i])=>{const{modelPlotEnabled:s}=this.state;this.setState({focusAggregationInterval:this.getFocusAggregationInterval({from:i.from,to:i.to}),loading:!1,showModelBoundsCheckbox:s&&e.focusChartData.length>0,zoomFromFocusLoaded:i.from,zoomToFocusLoaded:i.to,...e,...t})}))),this.context&&void 0!==this.props.selectedJob&&this.context.services.mlServices.mlFieldFormatService.populateFormats([this.props.selectedJob.job_id]),this.componentDidUpdate()}componentDidUpdate(e){var t,i;if(void 0!==e&&e.selectedForecastId===this.props.selectedForecastId||void 0!==this.props.selectedForecastId&&(this.setState({showForecast:!0}),void 0!==e&&(this.previousSelectedForecastId=e.selectedForecastId)),void 0===e||!Object(b.isEqual)(e.bounds,this.props.bounds)||!Object(b.isEqual)(e.lastRefresh,this.props.lastRefresh)&&0!==e.lastRefresh||!Object(b.isEqual)(e.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(b.isEqual)(e.selectedEntities,this.props.selectedEntities)||e.selectedForecastId!==this.props.selectedForecastId||(null===(t=e.selectedJob)||void 0===t?void 0:t.job_id)!==(null===(i=this.props.selectedJob)||void 0===i?void 0:i.job_id)||e.selectedJobId!==this.props.selectedJobId||e.functionDescription!==this.props.functionDescription){var s,a;const t=void 0===e||!Object(b.isEqual)(e.bounds,this.props.bounds)||!Object(b.isEqual)(e.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(b.isEqual)(e.selectedEntities,this.props.selectedEntities)||e.selectedForecastId!==this.props.selectedForecastId||e.selectedJobId!==this.props.selectedJobId||(null===(s=e.selectedJob)||void 0===s?void 0:s.job_id)!==(null===(a=this.props.selectedJob)||void 0===a?void 0:a.job_id)||e.functionDescription!==this.props.functionDescription;this.loadSingleMetricData(t)}}componentWillUnmount(){this.subscriptions.unsubscribe(),this.unmounted=!0}render(){const{autoZoomDuration:e,bounds:t,chartWidth:i,chartHeight:r,lastRefresh:o,selectedDetectorIndex:c,selectedJob:d}=this.props,{chartDetails:u,contextAggregationInterval:m,contextChartData:h,contextForecastData:p,dataNotChartable:f,focusAggregationInterval:x,focusAnnotationData:g,focusChartData:v,focusForecastData:y,fullRefresh:S,hasResults:w,loading:O,modelPlotEnabled:M,showAnnotations:C,showAnnotationsCheckbox:I,showForecast:D,showForecastCheckbox:B,showModelBounds:R,showModelBoundsCheckbox:N,swimlaneData:z,tableData:L,zoomFrom:$,zoomTo:J,zoomFromFocusLoaded:U,zoomToFocusLoaded:H,chartDataError:W,sourceIndicesWithGeoFields:Y}=this.state,G={modelPlotEnabled:M,contextChartData:h,contextChartSelected:this.contextChartSelected,contextForecastData:p,contextAggregationInterval:m,swimlaneData:z,focusAnnotationData:g,focusChartData:v,focusForecastData:y,focusAggregationInterval:x,svgWidth:i,svgHeight:r,zoomFrom:$,zoomTo:J,zoomFromFocusLoaded:U,zoomToFocusLoaded:H,autoZoomDuration:e},X=this.getControlsForDetector(),q=this.getFieldNamesWithEmptyValues(),Z=this.arePartitioningFieldsProvided();let K=!0;return Object(b.isEqual)(this.previousChartProps.focusForecastData,G.focusForecastData)&&Object(b.isEqual)(this.previousChartProps.focusChartData,G.focusChartData)&&Object(b.isEqual)(this.previousChartProps.focusAnnotationData,G.focusAnnotationData)&&this.previousShowForecast===D&&this.previousShowModelBounds===R&&this.props.previousRefresh===o&&(K=!1),this.previousChartProps=G,this.previousShowForecast=D,this.previousShowModelBounds=R,Object(_.jsx)(a.a.Fragment,null,q.length>0&&Object(_.jsx)(a.a.Fragment,null,Object(_.jsx)(l.EuiCallOut,{title:Object(_.jsx)(k.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.singleMetricRequiredMessage",defaultMessage:"To view a single metric, select {missingValuesCount, plural, one {a value for {fieldName1}} other {values for {fieldName1} and {fieldName2}}}.",values:{missingValuesCount:q.length,fieldName1:q[0],fieldName2:q[1]}}),iconType:"help",size:"s"}),Object(_.jsx)(l.EuiSpacer,{size:"m"})),S&&!0===O&&Object(_.jsx)(A.a,{label:n.i18n.translate("xpack.ml.timeSeriesExplorer.loadingLabel",{defaultMessage:"Loading"})}),!1===O&&void 0!==W&&Object(_.jsx)(T.a,{errorMsg:W}),Z&&d&&(!1===S||!1===O)&&!1===w&&void 0===W&&Object(_.jsx)(E.a,{dataNotChartable:f,entities:X}),Z&&d&&(!1===S||!1===O)&&!0===w&&Object(_.jsx)("div",null,Object(_.jsx)(l.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiTitle,{size:"xs"},Object(_.jsx)("h2",null,Object(_.jsx)("span",null,n.i18n.translate("xpack.ml.timeSeriesExplorer.singleTimeSeriesAnalysisTitle",{defaultMessage:"Single time series analysis of {functionLabel}",values:{functionLabel:u.functionLabel}}))," ",1===u.entityData.count&&Object(_.jsx)(l.EuiTextColor,{color:"success",size:"s",component:"span"},u.entityData.entities.length>0&&"(",u.entityData.entities.map((e=>`${e.fieldName}: ${e.fieldValue}`)).join(", "),u.entityData.entities.length>0&&")"),1!==u.entityData.count&&Object(_.jsx)(l.EuiTextColor,{color:"success",size:"s",component:"span"},u.entityData.entities.map(((e,t)=>Object(_.jsx)(s.Fragment,{key:e.fieldName},n.i18n.translate("xpack.ml.timeSeriesExplorer.countDataInChartDetailsDescription",{defaultMessage:"{openBrace}{cardinalityValue} distinct {fieldName} {cardinality, plural, one {} other { values}}{closeBrace}",values:{openBrace:0===t?"(":"",closeBrace:t===u.entityData.entities.length-1?")":"",cardinalityValue:0===e.cardinality?V:e.cardinality,cardinality:e.cardinality,fieldName:e.fieldName}}),t!==u.entityData.entities.length-1?", ":""))))))),Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(j.a,{embeddableMode:!0}))),Object(_.jsx)(l.EuiFlexGroup,{style:{float:"right"}},N&&Object(_.jsx)(P,{id:"toggleModelBoundsCheckbox",label:n.i18n.translate("xpack.ml.timeSeriesExplorer.showModelBoundsLabel",{defaultMessage:"show model bounds"}),checked:R,onChange:this.toggleShowModelBoundsHandler}),I&&Object(_.jsx)(P,{id:"toggleAnnotationsCheckbox",label:n.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsLabel",{defaultMessage:"annotations"}),checked:C,onChange:this.toggleShowAnnotationsHandler}),B&&Object(_.jsx)(l.EuiFlexItem,{grow:!1},Object(_.jsx)(l.EuiCheckbox,{id:"toggleShowForecastCheckbox",label:Object(_.jsx)("span",{"data-test-subj":"mlForecastCheckbox"},n.i18n.translate("xpack.ml.timeSeriesExplorer.showForecastLabel",{defaultMessage:"show forecast"})),checked:D,onChange:this.toggleShowForecastHandler}))),Object(_.jsx)(F.a,{chartProps:G,contextAggregationInterval:m,bounds:t,detectorIndex:c,embeddableMode:!0,renderFocusChartOnly:K,selectedJob:d,selectedEntities:this.props.selectedEntities,showAnnotations:C,showForecast:D,showModelBounds:R,lastRefresh:o,tableData:L,sourceIndicesWithGeoFields:Y})))}}g()(timeseriesexplorer_embeddable_chart_TimeSeriesExplorerEmbeddableChart,"contextType",c.context),i(778);const z=n.i18n.translate('xpack.ml.singleMetricViewerEmbeddable.errorMessage"',{defaultMessage:"Unable to load the ML single metric viewer data"});t.default=({coreStart:e,pluginStart:t,mlServices:i,bounds:a,functionDescription:r,lastRefresh:n,onError:h,onRenderComplete:x,selectedDetectorIndex:g,selectedEntities:v,selectedJobId:y,uuid:S})=>{const[k,j]=Object(s.useState)({width:0,height:0}),[w,O]=Object(s.useState)(),[A,E]=Object(s.useState)(),[C,F]=Object(s.useState)(),[I,D]=Object(s.useState)(!1),T=o()(),{mlApiServices:P,mlJobService:B,mlTimeSeriesExplorerService:R,toastNotificationService:N}=i,V=Object(b.pick)(e,"analytics","i18n","theme"),L={...Object(b.pick)(e,["http","notifications","theme","uiSettings","i18n"]),data:t.data,uiSettingsKeys:u.UI_SETTINGS,showFrozenDataTierChoice:!1},$=p()(null!=n?n:0);Object(s.useEffect)((function(){!1!==T()&&async function(){try{await B.loadJobsWrapper(),D(!0)}catch(e){h&&h(new Error(z))}}()}),[T]),Object(s.useEffect)((function(){!1!==T()&&async function(){if(P&&void 0!==y)try{const{jobs:e}=await P.getJobs({jobId:y}),t=e[0];F(t)}catch(e){h&&h(new Error(z))}}()}),[y,P,T,h]);const J=Object(s.useCallback)(Object(b.throttle)((e=>{(Math.abs(k.width-e.width)>20||Math.abs(k.height-e.height)>20)&&j(e)}),500),[k.width,k.height]),U=Object(s.useMemo)((()=>{if(C)return null==R?void 0:R.getAutoZoomDuration(C)}),[R,C]),H=Object(s.useCallback)(((e,t)=>{switch(e){case M.a.SET_FORECAST_ID:E(t),O(void 0);break;case M.a.SET_ZOOM:O(t);break;case M.a.UNSET_ZOOM:O(void 0)}}),[O,E]);return Object(_.jsx)(l.EuiResizeObserver,{onResize:J},(s=>Object(_.jsx)("div",{id:`mlSingleMetricViewerEmbeddableWrapper-${S}`,style:{width:"100%",overflowY:"auto",overflowX:"hidden",padding:"8px"},"data-test-subj":`mlSingleMetricViewer_${S}`,ref:s,className:"ml-time-series-explorer","data-shared-item":"","data-rendering-count":1},Object(_.jsx)(d.a,V,Object(_.jsx)(c.KibanaContextProvider,{services:{mlServices:{...i},...e,...t}},Object(_.jsx)(m.a,L,void 0!==y&&void 0!==U&&I&&y===(null==C?void 0:C.job_id)&&Object(_.jsx)(timeseriesexplorer_embeddable_chart_TimeSeriesExplorerEmbeddableChart,{chartWidth:k.width-10,chartHeight:k.height-10,dataViewsService:t.data.dataViews,toastNotificationService:N,appStateHandler:H,autoZoomDuration:U,bounds:a,dateFormatTz:f.tz.guess(),lastRefresh:null!=n?n:0,previousRefresh:$,selectedJobId:y,selectedDetectorIndex:g,selectedEntities:v,selectedForecastId:A,tableInterval:"auto",tableSeverity:0,zoom:w,functionDescription:r,selectedJob:C,onRenderComplete:x})))))))}},70:function(e,t,i){"use strict";i.r(t),i.d(t,"MlCapabilitiesService",(function(){return check_capabilities_MlCapabilitiesService})),i.d(t,"usePermissionCheck",(function(){return x})),i.d(t,"useUpgradeCheck",(function(){return g})),i.d(t,"checkGetManagementMlJobsResolver",(function(){return v})),i.d(t,"checkCreateJobsCapabilitiesResolver",(function(){return y})),i.d(t,"checkPermission",(function(){return S})),i.d(t,"createPermissionFailureMessage",(function(){return k}));var s=i(4),a=i.n(s),r=i(5),o=i(7),n=i(8),l=i(26),c=i.n(l),d=i(2),u=i(10),m=i(156),h=i(50),p=i(11);let f=Object(h.a)();const b=3e5;class check_capabilities_MlCapabilitiesService{constructor(e){a()(this,"_isLoading$",new o.BehaviorSubject(!0)),a()(this,"_updateRequested$",new o.BehaviorSubject(Date.now())),a()(this,"_capabilities$",new o.BehaviorSubject(null)),a()(this,"_capabilitiesObs$",this._capabilities$.asObservable()),a()(this,"_isPlatinumOrTrialLicense$",new o.BehaviorSubject(null)),a()(this,"_mlFeatureEnabledInSpace$",new o.BehaviorSubject(null)),a()(this,"_isUpgradeInProgress$",new o.BehaviorSubject(null)),a()(this,"capabilities$",this._capabilities$.pipe(Object(o.distinctUntilChanged)(n.isEqual))),a()(this,"_subscription",void 0),this.mlApiServices=e,this.init()}init(){this._subscription=Object(o.combineLatest)([this._updateRequested$,Object(o.timer)(0,b)]).pipe(Object(o.tap)((()=>{this._isLoading$.next(!0)})),Object(o.switchMap)((()=>Object(o.from)(this.mlApiServices.checkMlCapabilities()))),Object(o.retry)({delay:b})).subscribe((e=>{this._capabilities$.next(e.capabilities),this._isPlatinumOrTrialLicense$.next(e.isPlatinumOrTrialLicense),this._mlFeatureEnabledInSpace$.next(e.mlFeatureEnabledInSpace),this._isUpgradeInProgress$.next(e.upgradeInProgress),this._isLoading$.next(!1),f=e.capabilities}))}getCapabilities(){return this._capabilities$.getValue()}isPlatinumOrTrialLicense(){return this._isPlatinumOrTrialLicense$.getValue()}mlFeatureEnabledInSpace(){return this._mlFeatureEnabledInSpace$.getValue()}isUpgradeInProgress$(){return this._isUpgradeInProgress$}isUpgradeInProgress(){return this._isUpgradeInProgress$.getValue()}getCapabilities$(){return this._capabilitiesObs$}refreshCapabilities(){this._updateRequested$.next(Date.now())}destroy(){this._subscription&&this._subscription.unsubscribe()}}function x(e){const{services:{mlServices:{mlCapabilities:t}}}=Object(u.d)(),i=Object(d.useRef)(e),s=c()(t.capabilities$,t.getCapabilities());return Object(d.useMemo)((()=>Array.isArray(i.current)?i.current.map((e=>s[e])):s[i.current]),[s])}function g(){const{services:{mlServices:{mlCapabilities:e}}}=Object(u.d)(),t=c()(e.isUpgradeInProgress$(),e.isUpgradeInProgress());return null!=t&&t}function v({mlCapabilities:e}){return new Promise((async(t,i)=>{try{const s=await Object(o.firstValueFrom)(e.getCapabilities$().pipe(Object(o.filter)((e=>!!e))));return null===s?i():(f=s,!0===(s.isADEnabled&&s.canCreateJob||s.isDFAEnabled&&s.canCreateDataFrameAnalytics||s.isNLPEnabled&&s.canCreateTrainedModels)?t():i({capabilities:s,isPlatinumOrTrialLicense:e.isPlatinumOrTrialLicense(),mlFeatureEnabledInSpace:e.mlFeatureEnabledInSpace(),isUpgradeInProgress:e.isUpgradeInProgress()}))}catch(e){i(e)}}))}function y(e){return new Promise(((t,i)=>{p.ml.checkMlCapabilities().then((async({capabilities:s,isPlatinumOrTrialLicense:a})=>(f=s,f.canCreateJob||!1===a?t(f):(await e(),i())))).catch((async t=>(await e(),i())))}))}function S(e){const t=Object(m.a)();return!0===f[e]&&!0!==t}function k(e){let t="";return Object(m.a)()?t=r.i18n.translate("xpack.ml.privilege.licenseHasExpiredTooltip",{defaultMessage:"Your license has expired."}):"canCreateJob"===e?t=r.i18n.translate("xpack.ml.privilege.noPermission.createMLJobsTooltip",{defaultMessage:"You do not have permission to create Machine Learning jobs."}):"canStartStopDatafeed"===e?t=r.i18n.translate("xpack.ml.privilege.noPermission.startOrStopDatafeedsTooltip",{defaultMessage:"You do not have permission to start or stop datafeeds."}):"canUpdateJob"===e?t=r.i18n.translate("xpack.ml.privilege.noPermission.editJobsTooltip",{defaultMessage:"You do not have permission to edit jobs."}):"canDeleteJob"===e?t=r.i18n.translate("xpack.ml.privilege.noPermission.deleteJobsTooltip",{defaultMessage:"You do not have permission to delete jobs."}):"canCreateCalendar"===e?t=r.i18n.translate("xpack.ml.privilege.noPermission.createCalendarsTooltip",{defaultMessage:"You do not have permission to create calendars."}):"canDeleteCalendar"===e?t=r.i18n.translate("xpack.ml.privilege.noPermission.deleteCalendarsTooltip",{defaultMessage:"You do not have permission to delete calendars."}):"canForecastJob"===e&&(t=r.i18n.translate("xpack.ml.privilege.noPermission.runForecastsTooltip",{defaultMessage:"You do not have permission to run forecasts."})),r.i18n.translate("xpack.ml.privilege.pleaseContactAdministratorTooltip",{defaultMessage:"{message} Please contact your administrator.",values:{message:t}})}},77:function(e,t,i){"use strict";i.r(t),i.d(t,"indexServiceFactory",(function(){return a})),i.d(t,"useMlIndexUtils",(function(){return r}));var s=i(10);function a(e){return{getDataViewIdFromName:async function(t,i){var s;const a=(await e.find(t)).find((e=>e.getIndexPattern()===t));var r;return a?null!==(s=a.id)&&void 0!==s?s:a.getIndexPattern():void 0!==i&&null!==(r=(await e.create({id:void 0,name:t,title:t,timeFieldName:i.data_description.time_field})).id)&&void 0!==r?r:null},getDataViewById:function(t){return t?e.get(t):e.create({})},loadDataViewListItems:async function(){return(await e.getIdsWithTitle()).sort(((e,t)=>e.title.localeCompare(t.title)))}}}const r=()=>a(Object(s.d)().services.data.dataViews)},778:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(779);case"v8light":return i(781)}},779:function(e,t,i){var s=i(126),a=i(780);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},780:function(e,t,i){(t=i(127)(!1)).push([e.i,".ml-time-series-explorer{color:#98a2b3}.ml-time-series-explorer .forecast-controls{float:right}.ml-time-series-explorer .ml-timeseries-chart svg{font-family:Inter,BlinkMacSystemFont,Helvetica,Arial,sans-serif;font-size:12px}.ml-time-series-explorer .ml-timeseries-chart .axis line,.ml-time-series-explorer .ml-timeseries-chart .axis path{fill:none;stroke:#343741;shape-rendering:crispEdges;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#dfe5ef}.ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#343741}.ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#343741;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#98a2b3;stroke-width:2}.ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:#36a2ef33;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#36a2ef;stroke-width:2;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#d6bf57;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:#d6bf574d;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .values-dots circle{fill:#36a2ef;stroke-width:0}.ml-time-series-explorer .ml-timeseries-chart .metric-value{fill:#0000;stroke:#36a2ef;stroke-width:0;opacity:1}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#fe5050}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#fba740}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#fdec25}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8bc8fb}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#d2e9f7}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted,.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-time-series-explorer .ml-timeseries-chart .metric-value:hover{stroke-width:6px;stroke-opacity:.65;stroke:#36a2ef}.ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98a2b3;fill:#343741}.ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#d6bf57}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#25262e}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#25262e}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#98a2b3}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#36a2ef;cursor:pointer}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus,.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover{text-decoration:underline}.ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{fill:#dfe5ef;font-size:10px}.ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#343741}.ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#535966}.ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text,.ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#98a2b3;stroke-width:2;cursor:move}.ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#1d1e24}.ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{padding-top:1px;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{fill:#98a2b3;background-color:#343741;border:1px solid #98a2b3;cursor:ew-resize;font-size:14px;height:70px;margin-top:9px;text-align:center;width:10px}.ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#98a2b3;fill:#343741;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.mlTimeSeriesExplorerProgress{background-color:#1d1e24}.mlTimeSeriesExplorerProgress::-moz-progress-bar,.mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#1d1e24}.mlAnnotationBrush .extent{stroke:#343741;stroke-width:2px;stroke-dasharray:2 2;fill:#25262e;shape-rendering:geometricPrecision}.mlAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;fill:#fff;fill-opacity:.05;shape-rendering:geometricPrecision}.mlAnnotationRect,.mlAnnotationRect-isHighlight{transition:stroke-opacity .15s;transition:fill-opacity .15s}.mlAnnotationRect-isHighlight{stroke-opacity:.4;fill-opacity:.1}.mlAnnotationRect-isBlur{stroke-opacity:.1;fill-opacity:.025;transition:stroke-opacity .15s;transition:fill-opacity .15s}.mlAnnotationText{text-anchor:middle;fill:#fff;font-family:Inter,BlinkMacSystemFont,Helvetica,Arial,sans-serif;font-size:12px;font-weight:500;transition:fill .15s;-webkit-user-select:none;user-select:none}.mlAnnotationText-isBlur{fill:#535966;transition:fill .15s}.mlAnnotationTextRect{fill:#343741;transition:fill .15s}.mlAnnotationTextRect-isBlur{fill:#25262e;transition:fill .15s}.mlAnnotationHidden{display:none}.mlContextAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;fill:#fff;fill-opacity:.05;shape-rendering:geometricPrecision}.mlContextAnnotationRect,.mlContextAnnotationRect-isBlur{transition:stroke-opacity .15s;transition:fill-opacity .15s}.mlContextAnnotationRect-isBlur{stroke-opacity:.1;fill-opacity:.025}",""]),e.exports=t},781:function(e,t,i){var s=i(126),a=i(782);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},782:function(e,t,i){(t=i(127)(!1)).push([e.i,".ml-time-series-explorer{color:#69707d}.ml-time-series-explorer .forecast-controls{float:right}.ml-time-series-explorer .ml-timeseries-chart svg{font-family:Inter,BlinkMacSystemFont,Helvetica,Arial,sans-serif;font-size:12px}.ml-time-series-explorer .ml-timeseries-chart .axis line,.ml-time-series-explorer .ml-timeseries-chart .axis path{fill:none;stroke:#d3dae6;shape-rendering:crispEdges;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#343741}.ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#d3dae6}.ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#d3dae6;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#69707d;stroke-width:2}.ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:#07c3;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#07c;stroke-width:2;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#d6bf57;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:#d6bf574d;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart .values-dots circle{fill:#07c;stroke-width:0}.ml-time-series-explorer .ml-timeseries-chart .metric-value{fill:#0000;stroke:#07c;stroke-width:0;opacity:1}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#98a2b3}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#fe5050}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#fba740}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#fdec25}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8bc8fb}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#d2e9f7}.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted,.ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-time-series-explorer .ml-timeseries-chart .metric-value:hover{stroke-width:6px;stroke-opacity:.65;stroke:#07c}.ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707d;fill:#d3dae6}.ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#d6bf57}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#f5f7fa}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#f5f7fa}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#69707d}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#07c;cursor:pointer}.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus,.ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover{text-decoration:underline}.ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{fill:#343741;font-size:10px}.ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#d3dae6}.ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#98a2b3}.ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text,.ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#69707d;stroke-width:2;cursor:move}.ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#fff}.ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{padding-top:1px;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{fill:#69707d;background-color:#d3dae6;border:1px solid #69707d;cursor:ew-resize;font-size:14px;height:70px;margin-top:9px;text-align:center;width:10px}.ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#69707d;fill:#d3dae6;pointer-events:none}.ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.mlTimeSeriesExplorerProgress{background-color:#fff}.mlTimeSeriesExplorerProgress::-moz-progress-bar,.mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#fff}.mlAnnotationBrush .extent{stroke:#d3dae6;stroke-width:2px;stroke-dasharray:2 2;fill:#f5f7fa;shape-rendering:geometricPrecision}.mlAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;fill:#000;fill-opacity:.05;shape-rendering:geometricPrecision}.mlAnnotationRect,.mlAnnotationRect-isHighlight{transition:stroke-opacity .15s;transition:fill-opacity .15s}.mlAnnotationRect-isHighlight{stroke-opacity:.4;fill-opacity:.1}.mlAnnotationRect-isBlur{stroke-opacity:.1;fill-opacity:.025;transition:stroke-opacity .15s;transition:fill-opacity .15s}.mlAnnotationText{text-anchor:middle;fill:#000;font-family:Inter,BlinkMacSystemFont,Helvetica,Arial,sans-serif;font-size:12px;font-weight:500;transition:fill .15s;-webkit-user-select:none;user-select:none}.mlAnnotationText-isBlur{fill:#98a2b3;transition:fill .15s}.mlAnnotationTextRect{fill:#d3dae6;transition:fill .15s}.mlAnnotationTextRect-isBlur{fill:#f5f7fa;transition:fill .15s}.mlAnnotationHidden{display:none}.mlContextAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;fill:#000;fill-opacity:.05;shape-rendering:geometricPrecision}.mlContextAnnotationRect,.mlContextAnnotationRect-isBlur{transition:stroke-opacity .15s;transition:fill-opacity .15s}.mlContextAnnotationRect-isBlur{stroke-opacity:.1;fill-opacity:.025}",""]),e.exports=t}}]);