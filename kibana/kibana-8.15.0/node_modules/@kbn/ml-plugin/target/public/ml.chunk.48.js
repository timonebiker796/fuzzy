/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[48],{161:function(e,t,n){"use strict";n.d(t,"c",(function(){return r.c})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"d",(function(){return a}));var r=n(43);function a(e,t){e.registerReactEmbeddableFactory(r.c,(async()=>{const{getAnomalySwimLaneEmbeddableFactory:e}=await Promise.all([n.e(2),n.e(10),n.e(8),n.e(11),n.e(34),n.e(45)]).then(n.bind(null,881));return e(t.getStartServices)})),e.registerReactEmbeddableFactory(r.a,(async()=>{const{getAnomalyChartsReactEmbeddableFactory:e}=await Promise.all([n.e(10),n.e(57)]).then(n.bind(null,845));return e(t.getStartServices)})),e.registerReactEmbeddableFactory(r.b,(async()=>{const{getSingleMetricViewerEmbeddableFactory:e}=await Promise.all([n.e(10),n.e(73)]).then(n.bind(null,882));return e(t.getStartServices)}))}},168:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),a=n(5),i=n(15),o=n(25),l=n(138),s=n.n(l),u=n(10),c=n(13),f=n(6);const d=({jobsAndGroupIds:e,onChange:t,adJobsApiService:n,errors:l,multiSelect:d=!1,label:m,allowSelectAll:h=!1,createJobUrl:g,options:b})=>{const{services:{notifications:{toasts:p},application:{navigateToUrl:j}}}=Object(u.d)(),y=s()(),[v,x]=Object(r.useState)([]),M=Object(r.useMemo)((()=>new Set),[]),O=Object(r.useMemo)((()=>new Set),[]),w=Object(r.useMemo)((()=>(null!=e?e:[]).map((e=>({label:e})))),[e]),S=Object(r.useCallback)((async()=>{try{const{jobIds:e,groupIds:t}=await n.getAllJobAndGroupIds();if(e.forEach((e=>{M.add(e)})),t.forEach((e=>{O.add(e)})),!y())return;x([...h?[{label:a.i18n.translate("xpack.ml.jobSelector.selectAllGroupLabel",{defaultMessage:"Select all"}),options:[{label:a.i18n.translate("xpack.ml.jobSelector.selectAllOptionLabel",{defaultMessage:"*"}),value:c.e}]}]:[],{label:a.i18n.translate("xpack.ml.jobSelector.jobOptionsLabel",{defaultMessage:"Jobs"}),options:[...g?[{label:a.i18n.translate("xpack.ml.jobSelector.createNewLabel",{defaultMessage:"--- Create new ---"}),value:"createNew"}]:[],...e.map((e=>({label:e})))]},...d?[{label:a.i18n.translate("xpack.ml.jobSelector.groupOptionsLabel",{defaultMessage:"Groups"}),options:t.map((e=>({label:e})))}]:[]])}catch(e){p.addError(e,{title:a.i18n.translate("xpack.ml.jobSelector.fetchJobErrorTitle",{defaultMessage:"Failed to load anomaly detection jobs"})})}}),[n,h,g,O,y,M,d,p]),T=Object(r.useCallback)((async e=>{if(e.some((e=>e.value===c.e)))return void t({jobIds:[c.e]});if(g&&e.some((e=>"createNew"===e.value)))return void await j(g);const n=[],r=[];e.forEach((({label:e})=>{M.has(e)?n.push(e):O.has(e)?r.push(e):null!=b&&b.some((t=>{var n;return null===(n=t.options)||void 0===n?void 0:n.some((t=>t.label===e))}))&&n.push(e)})),t({...n.length>0?{jobIds:n}:{},...r.length>0?{groupIds:r}:{}})}),[M,O,b,g]);return Object(r.useEffect)((()=>{b||S()}),[g]),Object(f.jsx)(o.EuiFormRow,{"data-test-subj":"mlAnomalyJobSelectionControls",fullWidth:!0,label:null!=m?m:Object(f.jsx)(i.FormattedMessage,{id:"xpack.ml.jobSelector.formControlLabel",defaultMessage:"Select job"}),isInvalid:!(null==l||!l.length),error:l},Object(f.jsx)(o.EuiComboBox,{singleSelection:!d,selectedOptions:w,options:null!=b?b:v,onChange:T,fullWidth:!0,"data-test-subj":"mlAnomalyAlertJobSelection",isInvalid:!(null==l||!l.length)}))}},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5);const a=e=>{if(0===e.length)return[r.i18n.translate("xpack.ml.swimlaneEmbeddable.setupModal.jobSelectionRequiredError",{defaultMessage:"Job selection is required"})]}},260:function(e,t,n){e.exports=n.p+"7a4082435b3e1246960afd2e97c6c091.png"},269:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5);const a=e=>r.i18n.translate("xpack.ml.swimlaneEmbeddable.title",{defaultMessage:"ML anomaly swim lane for {jobIds}",values:{jobIds:e.join(", ")}})},276:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),a=n.n(r),i=n(15),o=n(25),l=n(260),s=n.n(l),u=n(1),c=n(10),f=n(70),d=n(28),m=n(6);const h=()=>{const e=!Object(f.usePermissionCheck)("canCreateJob")||!Object(d.c)(),{services:{docLinks:t}}=Object(c.d)(),n=Object(c.g)(),r=Object(c.h)();return Object(m.jsx)(o.EuiEmptyPrompt,{layout:"horizontal",hasBorder:!1,hasShadow:!1,icon:Object(m.jsx)(o.EuiImage,{size:"fullWidth",src:s.a,alt:"anomaly_detection"}),title:Object(m.jsx)("h2",null,Object(m.jsx)(i.FormattedMessage,{id:"xpack.ml.overview.anomalyDetection.createFirstJobMessage",defaultMessage:"Start detecting anomalies"})),body:Object(m.jsx)(a.a.Fragment,null,Object(m.jsx)("p",null,Object(m.jsx)(i.FormattedMessage,{id:"xpack.ml.overview.anomalyDetection.emptyPromptText",defaultMessage:"Anomaly detection enables you to find unusual behavior in time series data. Start automatically spotting the anomalies hiding in your data and resolve issues faster."}))),actions:[Object(m.jsx)(o.EuiButton,{color:"primary",onClick:async()=>{if(!n)return;const e=await n.getUrl({page:u.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});await r(e,!0)},isDisabled:e,"data-test-subj":"mlCreateNewJobButton"},Object(m.jsx)(i.FormattedMessage,{id:"xpack.ml.overview.anomalyDetection.createJobButtonText",defaultMessage:"Create anomaly detection job"})),Object(m.jsx)(o.EuiLink,{href:t.links.ml.anomalyDetection,target:"_blank",external:!0},Object(m.jsx)(i.FormattedMessage,{id:"xpack.ml.common.readDocumentationLink",defaultMessage:"Read documentation"}))],"data-test-subj":"mlAnomalyDetectionEmptyState"})}},310:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5);const a=e=>r.i18n.translate("xpack.ml.anomalyChartsEmbeddable.title",{defaultMessage:"ML anomaly charts for {jobIds}",values:{jobIds:e.join(", ")}})},353:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),a=n(86),i=n(318);const o=e=>Object(r.useMemo)((()=>new i.a({[a.UI_SETTINGS.HISTOGRAM_MAX_BARS]:e.get(a.UI_SETTINGS.HISTOGRAM_MAX_BARS),[a.UI_SETTINGS.HISTOGRAM_BAR_TARGET]:e.get(a.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:e.get("dateFormat"),"dateFormat:scaled":e.get("dateFormat:scaled")})),[e])},378:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return g}));var r=n(2),a=n.n(r),i=n(25),o=n(15),l=n(48),s=n(168),u=n(1),c=n(310),f=n(10),d=n(225),m=n(6);const h=50,g=({initialInput:e,onCreate:t,onCancel:n,adJobsApiService:g})=>{var b,p,j;const y=Object(r.useRef)(!(null==e||!e.title)),[v,x]=Object(r.useState)(null!==(b=null==e?void 0:e.title)&&void 0!==b?b:""),[M,O]=Object(r.useState)(null!==(p=null==e?void 0:e.maxSeriesToPlot)&&void 0!==p?p:l.b),w=(null==v?void 0:v.length)>0,S=M>=1&&M<=h,T=Object(f.f)({page:u.b.ANOMALY_DETECTION_CREATE_JOB}),[E,C]=Object(r.useState)(null!==(j=null==e?void 0:e.jobIds)&&void 0!==j?j:[]),k=Object(d.a)(E),A=w&&S&&void 0===k;return Object(r.useEffect)((function(){y.current||x(Object(c.a)(E))}),[null==e?void 0:e.title,E]),Object(m.jsx)(a.a.Fragment,null,Object(m.jsx)(i.EuiFlyoutHeader,null,Object(m.jsx)(i.EuiTitle,null,Object(m.jsx)("h2",null,Object(m.jsx)(o.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.title",defaultMessage:"Anomaly explorer charts configuration"})))),Object(m.jsx)(i.EuiFlyoutBody,null,Object(m.jsx)(s.a,{createJobUrl:T,multiSelect:!0,jobsAndGroupIds:E,adJobsApiService:g,onChange:e=>{var t,n;C([...null!==(t=null==e?void 0:e.jobIds)&&void 0!==t?t:[],...null!==(n=null==e?void 0:e.groupIds)&&void 0!==n?n:[]])},errors:k}),Object(m.jsx)(i.EuiSpacer,{size:"s"}),Object(m.jsx)(i.EuiForm,null,Object(m.jsx)(i.EuiFormRow,{label:Object(m.jsx)(o.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.panelTitleLabel",defaultMessage:"Panel title"}),isInvalid:!w},Object(m.jsx)(i.EuiFieldText,{"data-test-subj":"panelTitleInput",id:"panelTitle",name:"panelTitle",value:v,onChange:e=>{y.current=!0,x(e.target.value)},isInvalid:!w})),Object(m.jsx)(i.EuiFormRow,{isInvalid:!S,error:S?void 0:Object(m.jsx)(o.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.maxSeriesToPlotError",defaultMessage:"Maximum number of series to plot must be between 1 and 50."}),label:Object(m.jsx)(o.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},Object(m.jsx)(i.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:M,onChange:e=>O(parseInt(e.target.value,10)),min:1,max:h})))),Object(m.jsx)(i.EuiFlyoutFooter,null,Object(m.jsx)(i.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(m.jsx)(i.EuiButtonEmpty,{onClick:n,"data-test-subj":"mlAnomalyChartsInitializerCancelButton"},Object(m.jsx)(o.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(m.jsx)(i.EuiButton,{"data-test-subj":"mlAnomalyChartsInitializerConfirmButton",isDisabled:!A,onClick:t.bind(null,{title:v,maxSeriesToPlot:M,jobIds:E}),fill:!0},Object(m.jsx)(o.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupFlyout.confirmButtonLabel",defaultMessage:"Confirm"})))))}},401:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),a=n.n(r),i=n(5),o=n(25),l=n(140),s=n(6);const u=a.a.memo((({value:e,onChange:t})=>{const n=[{min:l.a.LOW,max:l.a.MINOR,color:"#8BC8FB"},{min:l.a.MINOR,max:l.a.MAJOR,color:"#FDEC25"},{min:l.a.MAJOR,max:l.a.CRITICAL,color:"#FBA740"},{min:l.a.CRITICAL,max:100,color:"#FE5050"}],r=i.i18n.translate("xpack.ml.severitySelector.formControlLabel",{defaultMessage:"Severity"}),a=null!=e?e:l.a.LOW,u=new Array(5).fill(null).map(((e,t)=>{const n=25*t;return{value:n,label:n}}));return Object(s.jsx)(o.EuiFormRow,{fullWidth:!0},Object(s.jsx)(o.EuiFlexGroup,{gutterSize:"s"},Object(s.jsx)(o.EuiFlexItem,{grow:!1},Object(s.jsx)(o.EuiFieldNumber,{id:"severityControl",style:{width:"70px"},compressed:!0,prepend:r,value:a,onChange:e=>t(Number(e.target.value)),min:l.a.LOW,max:100})),Object(s.jsx)(o.EuiFlexItem,{grow:!0},Object(s.jsx)(o.EuiRange,{className:"mlSeverityControl",fullWidth:!0,min:l.a.LOW,max:100,value:a,onChange:e=>t(Number(e.currentTarget.value)),"aria-label":i.i18n.translate("xpack.ml.severitySelector.formControlAriaLabel",{defaultMessage:"Select severity threshold"}),showTicks:!0,ticks:u,showRange:!1,levels:n,"data-test-subj":"mlAnomalyAlertScoreSelection"}))))}))},487:function(e,t,n){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function n(e){let n=e,r=e;function a(e,t,n,a){for(null==n&&(n=0),null==a&&(a=e.length);n<a;){const i=n+a>>>1;r(e[i],t)<0?n=i+1:a=i}return n}return 1===e.length&&(n=(t,n)=>e(t)-n,r=function(e){return(n,r)=>t(e(n),r)}(e)),{left:a,center:function(e,t,r,i){null==r&&(r=0),null==i&&(i=e.length);const o=a(e,t,r,i-1);return o>r&&n(e[o-1],t)>-n(e[o],t)?o-1:o},right:function(e,t,n,a){for(null==n&&(n=0),null==a&&(a=e.length);n<a;){const i=n+a>>>1;r(e[i],t)>0?a=i:n=i+1}return n}}}function r(e){return null===e?NaN:+e}const a=n(t),i=a.right,o=a.left,l=n(r).center;function s(e,t){let n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++n;else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(a=+a)>=a&&++n}return n}function u(e){return 0|e.length}function c(e){return!(e>0)}function f(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function d(e,t){let n,r=0,a=0,i=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-a,a+=n/++r,i+=n*(t-a));else{let o=-1;for(let l of e)null!=(l=t(l,++o,e))&&(l=+l)>=l&&(n=l-a,a+=n/++r,i+=n*(l-a))}if(r>1)return i/(r-1)}function m(e,t){const n=d(e,t);return n?Math.sqrt(n):n}function h(e,t){let n,r;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=r=t):(n>t&&(n=t),r<t&&(r=t)));else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,a=this._n,i=0;if(a>0){for(i=e[--a];a>0&&(t=i,n=e[--a],i=t+n,r=n-(i-t),!r););a>0&&(r<0&&e[a-1]<0||r>0&&e[a-1]>0)&&(n=2*r,t=i+n,n==t-i&&(i=t))}return i}}class InternMap extends Map{constructor(e,t=j){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(g(this,e))}has(e){return super.has(g(this,e))}set(e,t){return super.set(b(this,e),t)}delete(e){return super.delete(p(this,e))}}class InternSet extends Set{constructor(e,t=j){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(g(this,e))}add(e){return super.add(b(this,e))}delete(e){return super.delete(p(this,e))}}function g({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function b({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function p({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function j(e){return null!==e&&"object"==typeof e?e.valueOf():e}function y(e){return e}function v(e,...t){return O(e,y,y,t)}function x(e,t,...n){return O(e,y,t,n)}function M(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function O(e,t,n,r){return function e(a,i){if(i>=r.length)return n(a);const o=new InternMap,l=r[i++];let s=-1;for(const e of a){const t=l(e,++s,a),n=o.get(t);n?n.push(e):o.set(t,[e])}for(const[t,n]of o)o.set(t,e(n,i));return t(o)}(e,0)}function w(e,t){return Array.from(t,(t=>e[t]))}function S(e,...n){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[r=t]=n;if(1===r.length||n.length>1){const a=Uint32Array.from(e,((e,t)=>t));return n.length>1?(n=n.map((t=>e.map(t))),a.sort(((e,r)=>{for(const a of n){const n=t(a[e],a[r]);if(n)return n}}))):(r=e.map(r),a.sort(((e,n)=>t(r[e],r[n])))),w(e,a)}return e.sort(r)}var T=Array.prototype.slice;function E(e){return function(){return e}}var C=Math.sqrt(50),k=Math.sqrt(10),A=Math.sqrt(2);function F(e,t,n){var r,a,i,o,l=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),0===(o=I(e,t,n))||!isFinite(o))return[];if(o>0){let n=Math.round(e/o),r=Math.round(t/o);for(n*o<e&&++n,r*o>t&&--r,i=new Array(a=r-n+1);++l<a;)i[l]=(n+l)*o}else{o=-o;let n=Math.round(e*o),r=Math.round(t*o);for(n/o<e&&++n,r/o>t&&--r,i=new Array(a=r-n+1);++l<a;)i[l]=(n+l)/o}return r&&i.reverse(),i}function I(e,t,n){var r=(t-e)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,a);return a>=0?(i>=C?10:i>=k?5:i>=A?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=C?10:i>=k?5:i>=A?2:1)}function D(e,t,n){let r;for(;;){const a=I(e,t,n);if(a===r||0===a||!isFinite(a))return[e,t];a>0?(e=Math.floor(e/a)*a,t=Math.ceil(t/a)*a):a<0&&(e=Math.ceil(e*a)/a,t=Math.floor(t*a)/a),r=a}}function N(e){return Math.ceil(Math.log(s(e))/Math.LN2)+1}function L(){var e=y,t=h,n=N;function r(r){Array.isArray(r)||(r=Array.from(r));var a,o,l=r.length,s=new Array(l);for(a=0;a<l;++a)s[a]=e(r[a],a,r);var u=t(s),c=u[0],f=u[1],d=n(s,c,f);if(!Array.isArray(d)){const e=f,n=+d;if(t===h&&([c,f]=D(c,f,n)),(d=F(c,f,n))[d.length-1]>=f)if(e>=f&&t===h){const e=I(c,f,n);isFinite(e)&&(e>0?f=(Math.floor(f/e)+1)*e:e<0&&(f=(Math.ceil(f*-e)+1)/-e))}else d.pop()}for(var m=d.length;d[0]<=c;)d.shift(),--m;for(;d[m-1]>f;)d.pop(),--m;var g,b=new Array(m+1);for(a=0;a<=m;++a)(g=b[a]=[]).x0=a>0?d[a-1]:c,g.x1=a<m?d[a]:f;for(a=0;a<l;++a)c<=(o=s[a])&&o<=f&&b[i(d,o,0,m)].push(r[a]);return b}return r.value=function(t){return arguments.length?(e="function"==typeof t?t:E(t),r):e},r.domain=function(e){return arguments.length?(t="function"==typeof e?e:E([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?E(T.call(e)):E(e),r):n},r}function P(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function B(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function Y(e,n,r=0,a=e.length-1,i=t){for(;a>r;){if(a-r>600){const t=a-r+1,o=n-r+1,l=Math.log(t),s=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*s*(t-s)/t)*(o-t/2<0?-1:1);Y(e,n,Math.max(r,Math.floor(n-o*s/t+u)),Math.min(a,Math.floor(n+(t-o)*s/t+u)),i)}const t=e[n];let o=r,l=a;for(R(e,r,n),i(e[a],t)>0&&R(e,r,a);o<l;){for(R(e,o,l),++o,--l;i(e[o],t)<0;)++o;for(;i(e[l],t)>0;)--l}0===i(e[r],t)?R(e,r,l):(++l,R(e,l,a)),l<=n&&(r=l+1),n<=l&&(a=l-1)}return e}function R(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n){if(r=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n))).length){if((t=+t)<=0||r<2)return B(e);if(t>=1)return P(e);var r,a=(r-1)*t,i=Math.floor(a),o=P(Y(e,i).subarray(0,i+1));return o+(B(e.subarray(i+1))-o)*(a-i)}}function z(e,t){let n,r=-1,a=-1;if(void 0===t)for(const t of e)++a,null!=t&&(n<t||void 0===n&&t>=t)&&(n=t,r=a);else for(let i of e)null!=(i=t(i,++a,e))&&(n<i||void 0===n&&i>=i)&&(n=i,r=a);return r}function U(e,t){let n,r=-1,a=-1;if(void 0===t)for(const t of e)++a,null!=t&&(n>t||void 0===n&&t>=t)&&(n=t,r=a);else for(let i of e)null!=(i=t(i,++a,e))&&(n>i||void 0===n&&i>=i)&&(n=i,r=a);return r}function q(e,t){return[e,t]}function H(e,n=t){if(1===n.length)return U(e,n);let r,a=-1,i=-1;for(const t of e)++i,(a<0?0===n(t,t):n(t,r)<0)&&(r=t,a=i);return a}var $=W(Math.random);function W(e){return function(t,n=0,r=t.length){let a=r-(n=+n);for(;a;){const r=e()*a--|0,i=t[a+n];t[a+n]=t[r+n],t[r+n]=i}return t}}function V(e){if(!(a=e.length))return[];for(var t=-1,n=B(e,J),r=new Array(n);++t<n;)for(var a,i=-1,o=r[t]=new Array(a);++i<a;)o[i]=e[i][t];return r}function J(e){return e.length}function G(e){return e instanceof Set?e:new Set(e)}function X(e,t){const n=e[Symbol.iterator](),r=new Set;for(const e of t){if(r.has(e))continue;let t,a;for(;({value:t,done:a}=n.next());){if(a)return!1;if(r.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=L,e.bisect=i,e.bisectCenter=l,e.bisectLeft=o,e.bisectRight=i,e.bisector=n,e.count=s,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),n=(e=e.map(f)).map(u),r=e.length-1,a=new Array(r+1).fill(0),i=[];if(r<0||n.some(c))return i;for(;;){i.push(a.map(((t,n)=>e[n][t])));let o=r;for(;++a[o]===n[o];){if(0===o)return t?i.map(t):i;a[o--]=0}}},e.cumsum=function(e,t){var n=0,r=0;return Float64Array.from(e,void 0===t?e=>n+=+e||0:a=>n+=+t(a,r++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.difference=function(e,...t){e=new Set(e);for(const n of t)for(const t of n)e.delete(t);return e},e.disjoint=function(e,t){const n=t[Symbol.iterator](),r=new Set;for(const t of e){if(r.has(t))return!1;let e,a;for(;({value:e,done:a}=n.next())&&!a;){if(Object.is(t,e))return!1;r.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const r of e)if(!t(r,++n,e))return!1;return!0},e.extent=h,e.fcumsum=function(e,t){const n=new Adder;let r=-1;return Float64Array.from(e,void 0===t?e=>n.add(+e||0):a=>n.add(+t(a,++r,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const n=[];let r=-1;for(const a of e)t(a,++r,e)&&n.push(a);return n},e.fsum=function(e,t){const n=new Adder;if(void 0===t)for(let t of e)(t=+t)&&n.add(t);else{let r=-1;for(let a of e)(a=+t(a,++r,e))&&n.add(a)}return+n},e.greatest=function(e,n=t){let r,a=!1;if(1===n.length){let i;for(const o of e){const e=n(o);(a?t(e,i)>0:0===t(e,e))&&(r=o,i=e,a=!0)}}else for(const t of e)(a?n(t,r)>0:0===n(t,t))&&(r=t,a=!0);return r},e.greatestIndex=function(e,n=t){if(1===n.length)return z(e,n);let r,a=-1,i=-1;for(const t of e)++i,(a<0?0===n(t,t):n(t,r)>0)&&(r=t,a=i);return a},e.group=v,e.groupSort=function(e,n,r){return(1===n.length?S(x(e,n,r),(([e,n],[r,a])=>t(n,a)||t(e,r))):S(v(e,r),(([e,r],[a,i])=>n(r,i)||t(e,a)))).map((([e])=>e))},e.groups=function(e,...t){return O(e,Array.from,y,t)},e.histogram=L,e.index=function(e,...t){return O(e,y,M,t)},e.indexes=function(e,...t){return O(e,Array.from,M,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(G);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e},e.least=function(e,n=t){let r,a=!1;if(1===n.length){let i;for(const o of e){const e=n(o);(a?t(e,i)<0:0===t(e,e))&&(r=o,i=e,a=!0)}}else for(const t of e)(a?n(t,r)<0:0===n(t,t))&&(r=t,a=!0);return r},e.leastIndex=H,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((n,r)=>t(n,r,e)))},e.max=P,e.maxIndex=z,e.mean=function(e,t){let n=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,r+=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(i=+i)>=i&&(++n,r+=i)}if(n)return r/n},e.median=function(e,t){return _(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=B,e.minIndex=U,e.nice=D,e.pairs=function(e,t=q){const n=[];let r,a=!1;for(const i of e)a&&n.push(t(r,i)),r=i,a=!0;return n},e.permute=w,e.quantile=_,e.quantileSorted=function(e,t,n=r){if(a=e.length){if((t=+t)<=0||a<2)return+n(e[0],0,e);if(t>=1)return+n(e[a-1],a-1,e);var a,i=(a-1)*t,o=Math.floor(i),l=+n(e[o],o,e);return l+(+n(e[o+1],o+1,e)-l)*(i-o)}},e.quickselect=Y,e.range=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i},e.reduce=function(e,t,n){if("function"!=typeof t)throw new TypeError("reducer is not a function");const r=e[Symbol.iterator]();let a,i,o=-1;if(arguments.length<3){if(({done:a,value:n}=r.next()),a)return;++o}for(;({done:a,value:i}=r.next()),!a;)n=t(n,i,++o,e);return n},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=x,e.rollups=function(e,t,...n){return O(e,Array.from,t,n)},e.scan=function(e,t){const n=H(e,t);return n<0?void 0:n},e.shuffle=$,e.shuffler=W,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const r of e)if(t(r,++n,e))return!0;return!1},e.sort=S,e.subset=function(e,t){return X(t,e)},e.sum=function(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let a of e)(a=+t(a,++r,e))&&(n+=a)}return n},e.superset=X,e.thresholdFreedmanDiaconis=function(e,t,n){return Math.ceil((n-t)/(2*(_(e,.75)-_(e,.25))*Math.pow(s(e),-1/3)))},e.thresholdScott=function(e,t,n){return Math.ceil((n-t)/(3.5*m(e)*Math.pow(s(e),-1/3)))},e.thresholdSturges=N,e.tickIncrement=I,e.tickStep=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=C?a*=10:i>=k?a*=5:i>=A&&(a*=2),t<e?-a:a},e.ticks=F,e.transpose=V,e.union=function(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t},e.variance=d,e.zip=function(){return V(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},488:function(e,t,n){!function(e,t){"use strict";var n=new Date,r=new Date;function a(e,t,i,o){function l(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return l.floor=function(t){return e(t=new Date(+t)),t},l.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},l.round=function(e){var t=l(e),n=l.ceil(e);return e-t<n-e?t:n},l.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},l.range=function(n,r,a){var i,o=[];if(n=l.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return o;do{o.push(i=new Date(+n)),t(n,a),e(n)}while(i<n&&n<r);return o},l.filter=function(n){return a((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},i&&(l.count=function(t,a){return n.setTime(+t),r.setTime(+a),e(n),e(r),Math.floor(i(n,r))},l.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?l.filter(o?function(t){return o(t)%e==0}:function(t){return l.count(0,t)%e==0}):l:null}),l}var i=a((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):i:null};var o=i.range;const l=1e3,s=6e4,u=36e5,c=864e5,f=6048e5,d=2592e6,m=31536e6;var h=a((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCSeconds()})),g=h.range,b=a((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*l)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getMinutes()})),p=b.range,j=a((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*l-e.getMinutes()*s)}),(function(e,t){e.setTime(+e+t*u)}),(function(e,t){return(t-e)/u}),(function(e){return e.getHours()})),y=j.range,v=a((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/c),(e=>e.getDate()-1)),x=v.range;function M(e){return a((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/f}))}var O=M(0),w=M(1),S=M(2),T=M(3),E=M(4),C=M(5),k=M(6),A=O.range,F=w.range,I=S.range,D=T.range,N=E.range,L=C.range,P=k.range,B=a((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),Y=B.range,R=a((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));R.every=function(e){return isFinite(e=Math.floor(e))&&e>0?a((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var _=R.range,z=a((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCMinutes()})),U=z.range,q=a((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*u)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCHours()})),H=q.range,$=a((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCDate()-1})),W=$.range;function V(e){return a((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/f}))}var J=V(0),G=V(1),X=V(2),Q=V(3),Z=V(4),K=V(5),ee=V(6),te=J.range,ne=G.range,re=X.range,ae=Q.range,ie=Z.range,oe=K.range,le=ee.range,se=a((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ue=se.range,ce=a((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));ce.every=function(e){return isFinite(e=Math.floor(e))&&e>0?a((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var fe=ce.range;function de(e,n,r,a,o,g){const b=[[h,1,l],[h,5,5e3],[h,15,15e3],[h,30,3e4],[g,1,s],[g,5,3e5],[g,15,9e5],[g,30,18e5],[o,1,u],[o,3,108e5],[o,6,216e5],[o,12,432e5],[a,1,c],[a,2,1728e5],[r,1,f],[n,1,d],[n,3,7776e6],[e,1,m]];function p(n,r,a){const o=Math.abs(r-n)/a,l=t.bisector((([,,e])=>e)).right(b,o);if(l===b.length)return e.every(t.tickStep(n/m,r/m,a));if(0===l)return i.every(Math.max(t.tickStep(n,r,a),1));const[s,u]=b[o/b[l-1][2]<b[l][2]/o?l-1:l];return s.every(u)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const a=n&&"function"==typeof n.range?n:p(e,t,n),i=a?a.range(e,+t+1):[];return r?i.reverse():i},p]}const[me,he]=de(ce,se,J,$,q,z),[ge,be]=de(R,B,O,v,j,b);e.timeDay=v,e.timeDays=x,e.timeFriday=C,e.timeFridays=L,e.timeHour=j,e.timeHours=y,e.timeInterval=a,e.timeMillisecond=i,e.timeMilliseconds=o,e.timeMinute=b,e.timeMinutes=p,e.timeMonday=w,e.timeMondays=F,e.timeMonth=B,e.timeMonths=Y,e.timeSaturday=k,e.timeSaturdays=P,e.timeSecond=h,e.timeSeconds=g,e.timeSunday=O,e.timeSundays=A,e.timeThursday=E,e.timeThursdays=N,e.timeTickInterval=be,e.timeTicks=ge,e.timeTuesday=S,e.timeTuesdays=I,e.timeWednesday=T,e.timeWednesdays=D,e.timeWeek=O,e.timeWeeks=A,e.timeYear=R,e.timeYears=_,e.utcDay=$,e.utcDays=W,e.utcFriday=K,e.utcFridays=oe,e.utcHour=q,e.utcHours=H,e.utcMillisecond=i,e.utcMilliseconds=o,e.utcMinute=z,e.utcMinutes=U,e.utcMonday=G,e.utcMondays=ne,e.utcMonth=se,e.utcMonths=ue,e.utcSaturday=ee,e.utcSaturdays=le,e.utcSecond=h,e.utcSeconds=g,e.utcSunday=J,e.utcSundays=te,e.utcThursday=Z,e.utcThursdays=ie,e.utcTickInterval=he,e.utcTicks=me,e.utcTuesday=X,e.utcTuesdays=re,e.utcWednesday=Q,e.utcWednesdays=ae,e.utcWeek=J,e.utcWeeks=te,e.utcYear=ce,e.utcYears=fe,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(487))},772:function(e,t,n){!function(e,t,n,r,a,i){"use strict";function o(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function l(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const s=Symbol("implicit");function u(){var e=new Map,t=[],n=[],r=s;function a(a){var i=a+"",o=e.get(i);if(!o){if(r!==s)return r;e.set(i,o=t.push(a))}return n[(o-1)%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const r of n){const n=r+"";e.has(n)||e.set(n,t.push(r))}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return u(t,n).unknown(r)},o.apply(a,arguments),a}function c(){var e,n,r=u().unknown(void 0),a=r.domain,i=r.range,l=0,s=1,f=!1,d=0,m=0,h=.5;function g(){var r=a().length,o=s<l,u=o?s:l,c=o?l:s;e=(c-u)/Math.max(1,r-d+2*m),f&&(e=Math.floor(e)),u+=(c-u-e*(r-d))*h,n=e*(1-d),f&&(u=Math.round(u),n=Math.round(n));var g=t.range(r).map((function(t){return u+e*t}));return i(o?g.reverse():g)}return delete r.unknown,r.domain=function(e){return arguments.length?(a(e),g()):a()},r.range=function(e){return arguments.length?([l,s]=e,l=+l,s=+s,g()):[l,s]},r.rangeRound=function(e){return[l,s]=e,l=+l,s=+s,f=!0,g()},r.bandwidth=function(){return n},r.step=function(){return e},r.round=function(e){return arguments.length?(f=!!e,g()):f},r.padding=function(e){return arguments.length?(d=Math.min(1,m=+e),g()):d},r.paddingInner=function(e){return arguments.length?(d=Math.min(1,e),g()):d},r.paddingOuter=function(e){return arguments.length?(m=+e,g()):m},r.align=function(e){return arguments.length?(h=Math.max(0,Math.min(1,e)),g()):h},r.copy=function(){return c(a(),[l,s]).round(f).paddingInner(d).paddingOuter(m).align(h)},o.apply(g(),arguments)}function f(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return f(t())},e}function d(e){return+e}var m=[0,1];function h(e){return e}function g(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function b(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=g(a,r),i=n(o,i)):(r=g(r,a),i=n(i,o)),function(e){return i(r(e))}}function p(e,n,r){var a=Math.min(e.length,n.length)-1,i=new Array(a),o=new Array(a),l=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++l<a;)i[l]=g(e[l],e[l+1]),o[l]=r(n[l],n[l+1]);return function(n){var r=t.bisect(e,n,1,a)-1;return o[r](i[r](n))}}function j(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function y(){var e,t,r,a,i,o,l=m,s=m,u=n.interpolate,c=h;function f(){var e,t,n,r=Math.min(l.length,s.length);return c!==h&&(e=l[0],t=l[r-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),a=r>2?p:b,i=o=null,g}function g(t){return null==t||isNaN(t=+t)?r:(i||(i=a(l.map(e),s,u)))(e(c(t)))}return g.invert=function(r){return c(t((o||(o=a(s,l.map(e),n.interpolateNumber)))(r)))},g.domain=function(e){return arguments.length?(l=Array.from(e,d),f()):l.slice()},g.range=function(e){return arguments.length?(s=Array.from(e),f()):s.slice()},g.rangeRound=function(e){return s=Array.from(e),u=n.interpolateRound,f()},g.clamp=function(e){return arguments.length?(c=!!e||h,f()):c!==h},g.interpolate=function(e){return arguments.length?(u=e,f()):u},g.unknown=function(e){return arguments.length?(r=e,g):r},function(n,r){return e=n,t=r,f()}}function v(){return y()(h,h)}function x(e,n,a,i){var o,l=t.tickStep(e,n,a);switch((i=r.formatSpecifier(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(n));return null!=i.precision||isNaN(o=r.precisionPrefix(l,s))||(i.precision=o),r.formatPrefix(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=r.precisionRound(l,Math.max(Math.abs(e),Math.abs(n))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=r.precisionFixed(l))||(i.precision=o-2*("%"===i.type))}return r.format(i)}function M(e){var n=e.domain;return e.ticks=function(e){var r=n();return t.ticks(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,t){var r=n();return x(r[0],r[r.length-1],null==e?10:e,t)},e.nice=function(r){null==r&&(r=10);var a,i,o=n(),l=0,s=o.length-1,u=o[l],c=o[s],f=10;for(c<u&&(i=u,u=c,c=i,i=l,l=s,s=i);f-- >0;){if((i=t.tickIncrement(u,c,r))===a)return o[l]=u,o[s]=c,n(o);if(i>0)u=Math.floor(u/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,c=Math.floor(c*i)/i}a=i}return e},e}function O(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function w(e){return Math.log(e)}function S(e){return Math.exp(e)}function T(e){return-Math.log(-e)}function E(e){return-Math.exp(-e)}function C(e){return isFinite(e)?+("1e"+e):e<0?0:e}function k(e){return function(t){return-e(-t)}}function A(e){var n,a,i=e(w,S),o=i.domain,l=10;function s(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(l),a=function(e){return 10===e?C:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(l),o()[0]<0?(n=k(n),a=k(a),e(T,E)):e(w,S),i}return i.base=function(e){return arguments.length?(l=+e,s()):l},i.domain=function(e){return arguments.length?(o(e),s()):o()},i.ticks=function(e){var r,i=o(),s=i[0],u=i[i.length-1];(r=u<s)&&(m=s,s=u,u=m);var c,f,d,m=n(s),h=n(u),g=null==e?10:+e,b=[];if(!(l%1)&&h-m<g){if(m=Math.floor(m),h=Math.ceil(h),s>0){for(;m<=h;++m)for(f=1,c=a(m);f<l;++f)if(!((d=c*f)<s)){if(d>u)break;b.push(d)}}else for(;m<=h;++m)for(f=l-1,c=a(m);f>=1;--f)if(!((d=c*f)<s)){if(d>u)break;b.push(d)}2*b.length<g&&(b=t.ticks(s,u,g))}else b=t.ticks(m,h,Math.min(h-m,g)).map(a);return r?b.reverse():b},i.tickFormat=function(e,t){if(null==t&&(t=10===l?".0e":","),"function"!=typeof t&&(t=r.format(t)),e===1/0)return t;null==e&&(e=10);var o=Math.max(1,l*e/i.ticks().length);return function(e){var r=e/a(Math.round(n(e)));return r*l<l-.5&&(r*=l),r<=o?t(e):""}},i.nice=function(){return o(O(o(),{floor:function(e){return a(Math.floor(n(e)))},ceil:function(e){return a(Math.ceil(n(e)))}}))},i}function F(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function I(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function D(e){var t=1,n=e(F(t),I(t));return n.constant=function(n){return arguments.length?e(F(t=+n),I(t)):t},M(n)}function N(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function L(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function P(e){return e<0?-e*e:e*e}function B(e){var t=e(h,h),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(h,h):.5===n?e(L,P):e(N(n),N(1/n)):n},M(t)}function Y(){var e=B(y());return e.copy=function(){return j(e,Y()).exponent(e.exponent())},o.apply(e,arguments),e}function R(e){return Math.sign(e)*e*e}function _(e){return new Date(e)}function z(e){return e instanceof Date?+e:+new Date(+e)}function U(e,t,n,r,a,i,o,l,s,u){var c=v(),f=c.invert,d=c.domain,m=u(".%L"),h=u(":%S"),g=u("%I:%M"),b=u("%I %p"),p=u("%a %d"),y=u("%b %d"),x=u("%B"),M=u("%Y");function w(e){return(s(e)<e?m:l(e)<e?h:o(e)<e?g:i(e)<e?b:r(e)<e?a(e)<e?p:y:n(e)<e?x:M)(e)}return c.invert=function(e){return new Date(f(e))},c.domain=function(e){return arguments.length?d(Array.from(e,z)):d().map(_)},c.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?w:u(t)},c.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(O(n,e)):c},c.copy=function(){return j(c,U(e,t,n,r,a,i,o,l,s,u))},c}function q(){var e,t,r,a,i,o=0,l=1,s=h,u=!1;function c(t){return null==t||isNaN(t=+t)?i:s(0===r?.5:(t=(a(t)-e)*r,u?Math.max(0,Math.min(1,t)):t))}function f(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),c):[s(0),s(1)]}}return c.domain=function(n){return arguments.length?([o,l]=n,e=a(o=+o),t=a(l=+l),r=e===t?0:1/(t-e),c):[o,l]},c.clamp=function(e){return arguments.length?(u=!!e,c):u},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=f(n.interpolate),c.rangeRound=f(n.interpolateRound),c.unknown=function(e){return arguments.length?(i=e,c):i},function(n){return a=n,e=n(o),t=n(l),r=e===t?0:1/(t-e),c}}function H(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function $(){var e=B(q());return e.copy=function(){return H(e,$()).exponent(e.exponent())},l.apply(e,arguments)}function W(){var e,t,r,a,i,o,l,s=0,u=.5,c=1,f=1,d=h,m=!1;function g(e){return isNaN(e=+e)?l:(e=.5+((e=+o(e))-t)*(f*e<f*t?a:i),d(m?Math.max(0,Math.min(1,e)):e))}function b(e){return function(t){var r,a,i;return arguments.length?([r,a,i]=t,d=n.piecewise(e,[r,a,i]),g):[d(0),d(.5),d(1)]}}return g.domain=function(n){return arguments.length?([s,u,c]=n,e=o(s=+s),t=o(u=+u),r=o(c=+c),a=e===t?0:.5/(t-e),i=t===r?0:.5/(r-t),f=t<e?-1:1,g):[s,u,c]},g.clamp=function(e){return arguments.length?(m=!!e,g):m},g.interpolator=function(e){return arguments.length?(d=e,g):d},g.range=b(n.interpolate),g.rangeRound=b(n.interpolateRound),g.unknown=function(e){return arguments.length?(l=e,g):l},function(n){return o=n,e=n(s),t=n(u),r=n(c),a=e===t?0:.5/(t-e),i=t===r?0:.5/(r-t),f=t<e?-1:1,g}}function V(){var e=B(W());return e.copy=function(){return H(e,V()).exponent(e.exponent())},l.apply(e,arguments)}e.scaleBand=c,e.scaleDiverging=function e(){var t=M(W()(h));return t.copy=function(){return H(t,e())},l.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=A(W()).domain([.1,1,10]);return t.copy=function(){return H(t,e()).base(t.base())},l.apply(t,arguments)},e.scaleDivergingPow=V,e.scaleDivergingSqrt=function(){return V.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=D(W());return t.copy=function(){return H(t,e()).constant(t.constant())},l.apply(t,arguments)},e.scaleIdentity=function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,d),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,d):[0,1],M(r)},e.scaleImplicit=s,e.scaleLinear=function e(){var t=v();return t.copy=function(){return j(t,e())},o.apply(t,arguments),M(t)},e.scaleLog=function e(){var t=A(y()).domain([1,10]);return t.copy=function(){return j(t,e()).base(t.base())},o.apply(t,arguments),t},e.scaleOrdinal=u,e.scalePoint=function(){return f(c.apply(null,arguments).paddingInner(1))},e.scalePow=Y,e.scaleQuantile=function e(){var n,r=[],a=[],i=[];function l(){var e=0,n=Math.max(1,a.length);for(i=new Array(n-1);++e<n;)i[e-1]=t.quantileSorted(r,e/n);return s}function s(e){return null==e||isNaN(e=+e)?n:a[t.bisect(i,e)]}return s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:r[0],t<i.length?i[t]:r[r.length-1]]},s.domain=function(e){if(!arguments.length)return r.slice();r=[];for(let t of e)null==t||isNaN(t=+t)||r.push(t);return r.sort(t.ascending),l()},s.range=function(e){return arguments.length?(a=Array.from(e),l()):a.slice()},s.unknown=function(e){return arguments.length?(n=e,s):n},s.quantiles=function(){return i.slice()},s.copy=function(){return e().domain(r).range(a).unknown(n)},o.apply(s,arguments)},e.scaleQuantize=function e(){var n,r=0,a=1,i=1,l=[.5],s=[0,1];function u(e){return null!=e&&e<=e?s[t.bisect(l,e,0,i)]:n}function c(){var e=-1;for(l=new Array(i);++e<i;)l[e]=((e+1)*a-(e-i)*r)/(i+1);return u}return u.domain=function(e){return arguments.length?([r,a]=e,r=+r,a=+a,c()):[r,a]},u.range=function(e){return arguments.length?(i=(s=Array.from(e)).length-1,c()):s.slice()},u.invertExtent=function(e){var t=s.indexOf(e);return t<0?[NaN,NaN]:t<1?[r,l[0]]:t>=i?[l[i-1],a]:[l[t-1],l[t]]},u.unknown=function(e){return arguments.length?(n=e,u):u},u.thresholds=function(){return l.slice()},u.copy=function(){return e().domain([r,a]).range(s).unknown(n)},o.apply(M(u),arguments)},e.scaleRadial=function e(){var t,n=v(),r=[0,1],a=!1;function i(e){var r=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(n(e));return isNaN(r)?t:a?Math.round(r):r}return i.invert=function(e){return n.invert(R(e))},i.domain=function(e){return arguments.length?(n.domain(e),i):n.domain()},i.range=function(e){return arguments.length?(n.range((r=Array.from(e,d)).map(R)),i):r.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(a=!!e,i):a},i.clamp=function(e){return arguments.length?(n.clamp(e),i):n.clamp()},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e(n.domain(),r).round(a).clamp(n.clamp()).unknown(t)},o.apply(i,arguments),M(i)},e.scaleSequential=function e(){var t=M(q()(h));return t.copy=function(){return H(t,e())},l.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=A(q()).domain([1,10]);return t.copy=function(){return H(t,e()).base(t.base())},l.apply(t,arguments)},e.scaleSequentialPow=$,e.scaleSequentialQuantile=function e(){var n=[],r=h;function a(e){if(null!=e&&!isNaN(e=+e))return r((t.bisect(n,e,1)-1)/(n.length-1))}return a.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(t.ascending),a},a.interpolator=function(e){return arguments.length?(r=e,a):r},a.range=function(){return n.map(((e,t)=>r(t/(n.length-1))))},a.quantiles=function(e){return Array.from({length:e+1},((r,a)=>t.quantile(n,a/e)))},a.copy=function(){return e(r).domain(n)},l.apply(a,arguments)},e.scaleSequentialSqrt=function(){return $.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=D(q());return t.copy=function(){return H(t,e()).constant(t.constant())},l.apply(t,arguments)},e.scaleSqrt=function(){return Y.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=D(y());return t.copy=function(){return j(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleThreshold=function e(){var n,r=[.5],a=[0,1],i=1;function l(e){return null!=e&&e<=e?a[t.bisect(r,e,0,i)]:n}return l.domain=function(e){return arguments.length?(r=Array.from(e),i=Math.min(r.length,a.length-1),l):r.slice()},l.range=function(e){return arguments.length?(a=Array.from(e),i=Math.min(r.length,a.length-1),l):a.slice()},l.invertExtent=function(e){var t=a.indexOf(e);return[r[t-1],r[t]]},l.unknown=function(e){return arguments.length?(n=e,l):n},l.copy=function(){return e().domain(r).range(a).unknown(n)},o.apply(l,arguments)},e.scaleTime=function(){return o.apply(U(a.timeTicks,a.timeTickInterval,a.timeYear,a.timeMonth,a.timeWeek,a.timeDay,a.timeHour,a.timeMinute,a.timeSecond,i.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return o.apply(U(a.utcTicks,a.utcTickInterval,a.utcYear,a.utcMonth,a.utcWeek,a.utcDay,a.utcHour,a.utcMinute,a.utcSecond,i.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(487),n(773),n(775),n(488),n(776))},773:function(e,t,n){!function(e,t){"use strict";function n(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function r(e){var t=e.length-1;return function(r){var a=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[a],o=e[a+1],l=a>0?e[a-1]:2*i-o,s=a<t-1?e[a+2]:2*o-i;return n((r-a/t)*t,l,i,o,s)}}function a(e){var t=e.length;return function(r){var a=Math.floor(((r%=1)<0?++r:r)*t),i=e[(a+t-1)%t],o=e[a%t],l=e[(a+1)%t],s=e[(a+2)%t];return n((r-a/t)*t,i,o,l,s)}}var i=e=>()=>e;function o(e,t){return function(n){return e+n*t}}function l(e,t){var n=t-e;return n?o(e,n>180||n<-180?n-360*Math.round(n/360):n):i(isNaN(e)?t:e)}function s(e){return 1==(e=+e)?u:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):i(isNaN(t)?n:t)}}function u(e,t){var n=t-e;return n?o(e,n):i(isNaN(e)?t:e)}var c=function e(n){var r=s(n);function a(e,n){var a=r((e=t.rgb(e)).r,(n=t.rgb(n)).r),i=r(e.g,n.g),o=r(e.b,n.b),l=u(e.opacity,n.opacity);return function(t){return e.r=a(t),e.g=i(t),e.b=o(t),e.opacity=l(t),e+""}}return a.gamma=e,a}(1);function f(e){return function(n){var r,a,i=n.length,o=new Array(i),l=new Array(i),s=new Array(i);for(r=0;r<i;++r)a=t.rgb(n[r]),o[r]=a.r||0,l[r]=a.g||0,s[r]=a.b||0;return o=e(o),l=e(l),s=e(s),a.opacity=1,function(e){return a.r=o(e),a.g=l(e),a.b=s(e),a+""}}}var d=f(r),m=f(a);function h(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function g(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=O(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function p(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function j(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function y(e,t){var n,r={},a={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=O(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var v=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(v.source,"g");function M(e,t){var n,r,a,i=v.lastIndex=x.lastIndex=0,o=-1,l=[],s=[];for(e+="",t+="";(n=v.exec(e))&&(r=x.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,s.push({i:o,x:j(n,r)})),i=x.lastIndex;return i<t.length&&(a=t.slice(i),l[o]?l[o]+=a:l[++o]=a),l.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)l[(n=s[r]).i]=n.x(e);return l.join("")})}function O(e,n){var r,a=typeof n;return null==n||"boolean"===a?i(n):("number"===a?j:"string"===a?(r=t.color(n))?(n=r,c):M:n instanceof t.color?c:n instanceof Date?p:g(n)?h:Array.isArray(n)?b:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?y:j)(e,n)}var w,S=180/Math.PI,T={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function E(e,t,n,r,a,i){var o,l,s;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(s=e*n+t*r)&&(n-=e*s,r-=t*s),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,s/=l),e*r<t*n&&(e=-e,t=-t,s=-s,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*S,skewX:Math.atan(s)*S,scaleX:o,scaleY:l}}function C(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var l=[],s=[];return i=e(i),o=e(o),function(e,r,a,i,o,l){if(e!==a||r!==i){var s=o.push("translate(",null,t,null,n);l.push({i:s-4,x:j(e,a)},{i:s-2,x:j(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,l,s),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:j(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,l,s),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:j(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,l,s),function(e,t,n,r,i,o){if(e!==n||t!==r){var l=i.push(a(i)+"scale(",null,",",null,")");o.push({i:l-4,x:j(e,n)},{i:l-2,x:j(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,l,s),i=o=null,function(e){for(var t,n=-1,r=s.length;++n<r;)l[(t=s[n]).i]=t.x(e);return l.join("")}}}var k=C((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?T:E(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),A=C((function(e){return null==e?T:(w||(w=document.createElementNS("http://www.w3.org/2000/svg","g")),w.setAttribute("transform",e),(e=w.transform.baseVal.consolidate())?E((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):T)}),", ",")",")");function F(e){return((e=Math.exp(e))+1/e)/2}var I=function e(t,n,r){function a(e,a){var i,o,l=e[0],s=e[1],u=e[2],c=a[0],f=a[1],d=a[2],m=c-l,h=f-s,g=m*m+h*h;if(g<1e-12)o=Math.log(d/u)/t,i=function(e){return[l+e*m,s+e*h,u*Math.exp(t*e*o)]};else{var b=Math.sqrt(g),p=(d*d-u*u+r*g)/(2*u*n*b),j=(d*d-u*u-r*g)/(2*d*n*b),y=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(j*j+1)-j);o=(v-y)/t,i=function(e){var r,a=e*o,i=F(y),c=u/(n*b)*(i*(r=t*a+y,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(y));return[l+c*m,s+c*h,u*i/F(t*a+y)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function D(e){return function(n,r){var a=e((n=t.hsl(n)).h,(r=t.hsl(r)).h),i=u(n.s,r.s),o=u(n.l,r.l),l=u(n.opacity,r.opacity);return function(e){return n.h=a(e),n.s=i(e),n.l=o(e),n.opacity=l(e),n+""}}}var N=D(l),L=D(u);function P(e){return function(n,r){var a=e((n=t.hcl(n)).h,(r=t.hcl(r)).h),i=u(n.c,r.c),o=u(n.l,r.l),l=u(n.opacity,r.opacity);return function(e){return n.h=a(e),n.c=i(e),n.l=o(e),n.opacity=l(e),n+""}}}var B=P(l),Y=P(u);function R(e){return function n(r){function a(n,a){var i=e((n=t.cubehelix(n)).h,(a=t.cubehelix(a)).h),o=u(n.s,a.s),l=u(n.l,a.l),s=u(n.opacity,a.opacity);return function(e){return n.h=i(e),n.s=o(e),n.l=l(Math.pow(e,r)),n.opacity=s(e),n+""}}return r=+r,a.gamma=n,a}(1)}var _=R(l),z=R(u);e.interpolate=O,e.interpolateArray=function(e,t){return(g(t)?h:b)(e,t)},e.interpolateBasis=r,e.interpolateBasisClosed=a,e.interpolateCubehelix=_,e.interpolateCubehelixLong=z,e.interpolateDate=p,e.interpolateDiscrete=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},e.interpolateHcl=B,e.interpolateHclLong=Y,e.interpolateHsl=N,e.interpolateHslLong=L,e.interpolateHue=function(e,t){var n=l(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,n){var r=u((e=t.lab(e)).l,(n=t.lab(n)).l),a=u(e.a,n.a),i=u(e.b,n.b),o=u(e.opacity,n.opacity);return function(t){return e.l=r(t),e.a=a(t),e.b=i(t),e.opacity=o(t),e+""}},e.interpolateNumber=j,e.interpolateNumberArray=h,e.interpolateObject=y,e.interpolateRgb=c,e.interpolateRgbBasis=d,e.interpolateRgbBasisClosed=m,e.interpolateRound=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}},e.interpolateString=M,e.interpolateTransformCss=k,e.interpolateTransformSvg=A,e.interpolateZoom=I,e.piecewise=function(e,t){void 0===t&&(t=e,e=O);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}},e.quantize=function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(774))},774:function(e,t,n){!function(e){"use strict";function t(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function n(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function r(){}var a=.7,i=1/a,o="\\s*([+-]?\\d+)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",s="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",u=/^#([0-9a-f]{3,8})$/,c=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),f=new RegExp("^rgb\\("+[s,s,s]+"\\)$"),d=new RegExp("^rgba\\("+[o,o,o,l]+"\\)$"),m=new RegExp("^rgba\\("+[s,s,s,l]+"\\)$"),h=new RegExp("^hsl\\("+[l,s,s]+"\\)$"),g=new RegExp("^hsla\\("+[l,s,s,l]+"\\)$"),b={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function p(){return this.rgb().formatHex()}function j(){return this.rgb().formatRgb()}function y(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=u.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?v(t):3===n?new w(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=c.exec(e))?new w(t[1],t[2],t[3],1):(t=f.exec(e))?new w(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=d.exec(e))?x(t[1],t[2],t[3],t[4]):(t=m.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=h.exec(e))?C(t[1],t[2]/100,t[3]/100,1):(t=g.exec(e))?C(t[1],t[2]/100,t[3]/100,t[4]):b.hasOwnProperty(e)?v(b[e]):"transparent"===e?new w(NaN,NaN,NaN,0):null}function v(e){return new w(e>>16&255,e>>8&255,255&e,1)}function x(e,t,n,r){return r<=0&&(e=t=n=NaN),new w(e,t,n,r)}function M(e){return e instanceof r||(e=y(e)),e?new w((e=e.rgb()).r,e.g,e.b,e.opacity):new w}function O(e,t,n,r){return 1===arguments.length?M(e):new w(e,t,n,null==r?1:r)}function w(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function S(){return"#"+E(this.r)+E(this.g)+E(this.b)}function T(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function E(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function C(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new F(e,t,n,r)}function k(e){if(e instanceof F)return new F(e.h,e.s,e.l,e.opacity);if(e instanceof r||(e=y(e)),!e)return new F;if(e instanceof F)return e;var t=(e=e.rgb()).r/255,n=e.g/255,a=e.b/255,i=Math.min(t,n,a),o=Math.max(t,n,a),l=NaN,s=o-i,u=(o+i)/2;return s?(l=t===o?(n-a)/s+6*(n<a):n===o?(a-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,l*=60):s=u>0&&u<1?0:l,new F(l,s,u,e.opacity)}function A(e,t,n,r){return 1===arguments.length?k(e):new F(e,t,n,null==r?1:r)}function F(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function I(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t(r,y,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:p,formatHex:p,formatHsl:function(){return k(this).formatHsl()},formatRgb:j,toString:j}),t(w,O,n(r,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?a:Math.pow(a,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S,formatHex:S,formatRgb:T,toString:T})),t(F,A,n(r,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new F(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?a:Math.pow(a,e),new F(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new w(I(e>=240?e-240:e+120,a,r),I(e,a,r),I(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const D=Math.PI/180,N=180/Math.PI,L=.96422,P=1,B=.82521,Y=4/29,R=6/29,_=3*R*R,z=R*R*R;function U(e){if(e instanceof H)return new H(e.l,e.a,e.b,e.opacity);if(e instanceof Q)return Z(e);e instanceof w||(e=M(e));var t,n,r=J(e.r),a=J(e.g),i=J(e.b),o=$((.2225045*r+.7168786*a+.0606169*i)/P);return r===a&&a===i?t=n=o:(t=$((.4360747*r+.3850649*a+.1430804*i)/L),n=$((.0139322*r+.0971045*a+.7141733*i)/B)),new H(116*o-16,500*(t-o),200*(o-n),e.opacity)}function q(e,t,n,r){return 1===arguments.length?U(e):new H(e,t,n,null==r?1:r)}function H(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function $(e){return e>z?Math.pow(e,1/3):e/_+Y}function W(e){return e>R?e*e*e:_*(e-Y)}function V(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function J(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function G(e){if(e instanceof Q)return new Q(e.h,e.c,e.l,e.opacity);if(e instanceof H||(e=U(e)),0===e.a&&0===e.b)return new Q(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*N;return new Q(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function X(e,t,n,r){return 1===arguments.length?G(e):new Q(e,t,n,null==r?1:r)}function Q(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Z(e){if(isNaN(e.h))return new H(e.l,0,0,e.opacity);var t=e.h*D;return new H(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(H,q,n(r,{brighter:function(e){return new H(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new H(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new w(V(3.1338561*(t=L*W(t))-1.6168667*(e=P*W(e))-.4906146*(n=B*W(n))),V(-.9787684*t+1.9161415*e+.033454*n),V(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),t(Q,X,n(r,{brighter:function(e){return new Q(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Q(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Z(this).rgb()}}));var K=-.14861,ee=1.78277,te=-.29227,ne=-.90649,re=1.97294,ae=re*ne,ie=re*ee,oe=ee*te-ne*K;function le(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof se)return new se(e.h,e.s,e.l,e.opacity);e instanceof w||(e=M(e));var t=e.r/255,n=e.g/255,r=e.b/255,a=(oe*r+ae*t-ie*n)/(oe+ae-ie),i=r-a,o=(re*(n-a)-te*i)/ne,l=Math.sqrt(o*o+i*i)/(re*a*(1-a)),s=l?Math.atan2(o,i)*N-120:NaN;return new se(s<0?s+360:s,l,a,e.opacity)}(e):new se(e,t,n,null==r?1:r)}function se(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}t(se,le,n(r,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new se(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?a:Math.pow(a,e),new se(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*D,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new w(255*(t+n*(K*r+ee*a)),255*(t+n*(te*r+ne*a)),255*(t+n*(re*r)),this.opacity)}})),e.color=y,e.cubehelix=le,e.gray=function(e,t){return new H(e,0,0,null==t?1:t)},e.hcl=X,e.hsl=A,e.lab=q,e.lch=function(e,t,n,r){return 1===arguments.length?G(e):new Q(n,t,e,null==r?1:r)},e.rgb=O,Object.defineProperty(e,"__esModule",{value:!0})}(t)},775:function(e,t,n){!function(e){"use strict";function t(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function n(e){return(e=t(Math.abs(e)))?e[1]:NaN}var r,a=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i(e){if(!(t=a.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function l(e,n){var r=t(e,n);if(!r)return e+"";var a=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}i.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var s={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>l(100*e,t),r:l,s:function(e,n){var a=t(e,n);if(!a)return e+"";var i=a[0],o=a[1],l=o-(r=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=i.length;return l===s?i:l>s?i+new Array(l-s+1).join("0"):l>0?i.slice(0,l)+"."+i.slice(l):"0."+new Array(1-l).join("0")+t(e,Math.max(0,n+l-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function u(e){return e}var c,f=Array.prototype.map,d=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,a,o=void 0===e.grouping||void 0===e.thousands?u:(t=f.call(e.grouping,Number),a=e.thousands+"",function(e,n){for(var r=e.length,i=[],o=0,l=t[0],s=0;r>0&&l>0&&(s+l+1>n&&(l=Math.max(1,n-s)),i.push(e.substring(r-=l,r+l)),!((s+=l+1)>n));)l=t[o=(o+1)%t.length];return i.reverse().join(a)}),l=void 0===e.currency?"":e.currency[0]+"",c=void 0===e.currency?"":e.currency[1]+"",m=void 0===e.decimal?".":e.decimal+"",h=void 0===e.numerals?u:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(f.call(e.numerals,String)),g=void 0===e.percent?"%":e.percent+"",b=void 0===e.minus?"":e.minus+"",p=void 0===e.nan?"NaN":e.nan+"";function j(e){var t=(e=i(e)).fill,n=e.align,a=e.sign,u=e.symbol,f=e.zero,j=e.width,y=e.comma,v=e.precision,x=e.trim,M=e.type;"n"===M?(y=!0,M="g"):s[M]||(void 0===v&&(v=12),x=!0,M="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var O="$"===u?l:"#"===u&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",w="$"===u?c:/[%p]/.test(M)?g:"",S=s[M],T=/[defgprs%]/.test(M);function E(e){var i,l,s,u=O,c=w;if("c"===M)c=S(e)+c,e="";else{var g=(e=+e)<0||1/e<0;if(e=isNaN(e)?p:S(Math.abs(e),v),x&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),g&&0==+e&&"+"!==a&&(g=!1),u=(g?"("===a?a:b:"-"===a||"("===a?"":a)+u,c=("s"===M?d[8+r/3]:"")+c+(g&&"("===a?")":""),T)for(i=-1,l=e.length;++i<l;)if(48>(s=e.charCodeAt(i))||s>57){c=(46===s?m+e.slice(i+1):e.slice(i))+c,e=e.slice(0,i);break}}y&&!f&&(e=o(e,1/0));var E=u.length+e.length+c.length,C=E<j?new Array(j-E+1).join(t):"";switch(y&&f&&(e=o(C+e,C.length?j-c.length:1/0),C=""),n){case"<":e=u+e+c+C;break;case"=":e=u+C+e+c;break;case"^":e=C.slice(0,E=C.length>>1)+u+e+c+C.slice(E);break;default:e=C+u+e+c}return h(e)}return v=void 0===v?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),E.toString=function(){return e+""},E}return{format:j,formatPrefix:function(e,t){var r=j(((e=i(e)).type="f",e)),a=3*Math.max(-8,Math.min(8,Math.floor(n(t)/3))),o=Math.pow(10,-a),l=d[8+a/3];return function(e){return r(o*e)+l}}}}function h(t){return c=m(t),e.format=c.format,e.formatPrefix=c.formatPrefix,c}h({thousands:",",grouping:[3],currency:["$",""]}),e.FormatSpecifier=o,e.formatDefaultLocale=h,e.formatLocale=m,e.formatSpecifier=i,e.precisionFixed=function(e){return Math.max(0,-n(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(n(t)/3)))-n(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,n(t)-n(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},776:function(e,t,n){!function(e,t){"use strict";function n(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function r(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function a(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function i(e){var i=e.dateTime,o=e.date,s=e.time,u=e.periods,c=e.days,f=e.shortDays,d=e.months,W=e.shortMonths,de=m(u),we=h(u),Se=m(c),Te=h(c),Ee=m(f),Ce=h(f),ke=m(d),Ae=h(d),Fe=m(W),Ie=h(W),De={a:function(e){return f[e.getDay()]},A:function(e){return c[e.getDay()]},b:function(e){return W[e.getMonth()]},B:function(e){return d[e.getMonth()]},c:null,d:L,e:L,f:_,g:Q,G:K,H:P,I:B,j:Y,L:R,m:z,M:U,p:function(e){return u[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Me,s:Oe,S:q,u:H,U:$,V:V,w:J,W:G,x:null,X:null,y:X,Y:Z,Z:ee,"%":xe},Ne={a:function(e){return f[e.getUTCDay()]},A:function(e){return c[e.getUTCDay()]},b:function(e){return W[e.getUTCMonth()]},B:function(e){return d[e.getUTCMonth()]},c:null,d:te,e:te,f:oe,g:pe,G:ye,H:ne,I:re,j:ae,L:ie,m:le,M:se,p:function(e){return u[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Me,s:Oe,S:ue,u:ce,U:fe,V:me,w:he,W:ge,x:null,X:null,y:be,Y:je,Z:ve,"%":xe},Le={a:function(e,t,n){var r=Ee.exec(t.slice(n));return r?(e.w=Ce.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=Se.exec(t.slice(n));return r?(e.w=Te.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=Fe.exec(t.slice(n));return r?(e.m=Ie.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=ke.exec(t.slice(n));return r?(e.m=Ae.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,t,n){return Ye(e,i,t,n)},d:S,e:S,f:F,g:x,G:v,H:E,I:E,j:T,L:A,m:w,M:C,p:function(e,t,n){var r=de.exec(t.slice(n));return r?(e.p=we.get(r[0].toLowerCase()),n+r[0].length):-1},q:O,Q:D,s:N,S:k,u:b,U:p,V:j,w:g,W:y,x:function(e,t,n){return Ye(e,o,t,n)},X:function(e,t,n){return Ye(e,s,t,n)},y:x,Y:v,Z:M,"%":I};function Pe(e,t){return function(n){var r,a,i,o=[],s=-1,u=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(o.push(e.slice(u,s)),null!=(a=l[r=e.charAt(++s)])?r=e.charAt(++s):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),u=s+1);return o.push(e.slice(u,s)),o.join("")}}function Be(e,i){return function(o){var l,s,u=a(1900,void 0,1);if(Ye(u,e,o+="",0)!=o.length)return null;if("Q"in u)return new Date(u.Q);if("s"in u)return new Date(1e3*u.s+("L"in u?u.L:0));if(i&&!("Z"in u)&&(u.Z=0),"p"in u&&(u.H=u.H%12+12*u.p),void 0===u.m&&(u.m="q"in u?u.q:0),"V"in u){if(u.V<1||u.V>53)return null;"w"in u||(u.w=1),"Z"in u?(s=(l=r(a(u.y,0,1))).getUTCDay(),l=s>4||0===s?t.utcMonday.ceil(l):t.utcMonday(l),l=t.utcDay.offset(l,7*(u.V-1)),u.y=l.getUTCFullYear(),u.m=l.getUTCMonth(),u.d=l.getUTCDate()+(u.w+6)%7):(s=(l=n(a(u.y,0,1))).getDay(),l=s>4||0===s?t.timeMonday.ceil(l):t.timeMonday(l),l=t.timeDay.offset(l,7*(u.V-1)),u.y=l.getFullYear(),u.m=l.getMonth(),u.d=l.getDate()+(u.w+6)%7)}else("W"in u||"U"in u)&&("w"in u||(u.w="u"in u?u.u%7:"W"in u?1:0),s="Z"in u?r(a(u.y,0,1)).getUTCDay():n(a(u.y,0,1)).getDay(),u.m=0,u.d="W"in u?(u.w+6)%7+7*u.W-(s+5)%7:u.w+7*u.U-(s+6)%7);return"Z"in u?(u.H+=u.Z/100|0,u.M+=u.Z%100,r(u)):n(u)}}function Ye(e,t,n,r){for(var a,i,o=0,s=t.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=Le[a in l?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return De.x=Pe(o,De),De.X=Pe(s,De),De.c=Pe(i,De),Ne.x=Pe(o,Ne),Ne.X=Pe(s,Ne),Ne.c=Pe(i,Ne),{format:function(e){var t=Pe(e+="",De);return t.toString=function(){return e},t},parse:function(e){var t=Be(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Pe(e+="",Ne);return t.toString=function(){return e},t},utcParse:function(e){var t=Be(e+="",!0);return t.toString=function(){return e},t}}}var o,l={"-":"",_:" ",0:"0"},s=/^\s*\d+/,u=/^%/,c=/[\\^$*+?|[\]().{}]/g;function f(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function d(e){return e.replace(c,"\\$&")}function m(e){return new RegExp("^(?:"+e.map(d).join("|")+")","i")}function h(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function g(e,t,n){var r=s.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function b(e,t,n){var r=s.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function p(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function j(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function y(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function v(e,t,n){var r=s.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function x(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function M(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function O(e,t,n){var r=s.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function w(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function S(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function T(e,t,n){var r=s.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function E(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function C(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function k(e,t,n){var r=s.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function A(e,t,n){var r=s.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function F(e,t,n){var r=s.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function I(e,t,n){var r=u.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function D(e,t,n){var r=s.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function N(e,t,n){var r=s.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function L(e,t){return f(e.getDate(),t,2)}function P(e,t){return f(e.getHours(),t,2)}function B(e,t){return f(e.getHours()%12||12,t,2)}function Y(e,n){return f(1+t.timeDay.count(t.timeYear(e),e),n,3)}function R(e,t){return f(e.getMilliseconds(),t,3)}function _(e,t){return R(e,t)+"000"}function z(e,t){return f(e.getMonth()+1,t,2)}function U(e,t){return f(e.getMinutes(),t,2)}function q(e,t){return f(e.getSeconds(),t,2)}function H(e){var t=e.getDay();return 0===t?7:t}function $(e,n){return f(t.timeSunday.count(t.timeYear(e)-1,e),n,2)}function W(e){var n=e.getDay();return n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e)}function V(e,n){return e=W(e),f(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),n,2)}function J(e){return e.getDay()}function G(e,n){return f(t.timeMonday.count(t.timeYear(e)-1,e),n,2)}function X(e,t){return f(e.getFullYear()%100,t,2)}function Q(e,t){return f((e=W(e)).getFullYear()%100,t,2)}function Z(e,t){return f(e.getFullYear()%1e4,t,4)}function K(e,n){var r=e.getDay();return f((e=r>=4||0===r?t.timeThursday(e):t.timeThursday.ceil(e)).getFullYear()%1e4,n,4)}function ee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+f(t/60|0,"0",2)+f(t%60,"0",2)}function te(e,t){return f(e.getUTCDate(),t,2)}function ne(e,t){return f(e.getUTCHours(),t,2)}function re(e,t){return f(e.getUTCHours()%12||12,t,2)}function ae(e,n){return f(1+t.utcDay.count(t.utcYear(e),e),n,3)}function ie(e,t){return f(e.getUTCMilliseconds(),t,3)}function oe(e,t){return ie(e,t)+"000"}function le(e,t){return f(e.getUTCMonth()+1,t,2)}function se(e,t){return f(e.getUTCMinutes(),t,2)}function ue(e,t){return f(e.getUTCSeconds(),t,2)}function ce(e){var t=e.getUTCDay();return 0===t?7:t}function fe(e,n){return f(t.utcSunday.count(t.utcYear(e)-1,e),n,2)}function de(e){var n=e.getUTCDay();return n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e)}function me(e,n){return e=de(e),f(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),n,2)}function he(e){return e.getUTCDay()}function ge(e,n){return f(t.utcMonday.count(t.utcYear(e)-1,e),n,2)}function be(e,t){return f(e.getUTCFullYear()%100,t,2)}function pe(e,t){return f((e=de(e)).getUTCFullYear()%100,t,2)}function je(e,t){return f(e.getUTCFullYear()%1e4,t,4)}function ye(e,n){var r=e.getUTCDay();return f((e=r>=4||0===r?t.utcThursday(e):t.utcThursday.ceil(e)).getUTCFullYear()%1e4,n,4)}function ve(){return"+0000"}function xe(){return"%"}function Me(e){return+e}function Oe(e){return Math.floor(+e/1e3)}function we(t){return o=i(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}we({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Se="%Y-%m-%dT%H:%M:%S.%LZ";var Te=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(Se);var Ee=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(Se);e.isoFormat=Te,e.isoParse=Ee,e.timeFormatDefaultLocale=we,e.timeFormatLocale=i,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(488))},866:function(e,t,n){"use strict";n.r(t),n.d(t,"ExplorerUrlStateManager",(function(){return Je}));var r=n(2),a=n.n(r),i=n(26),o=n.n(i),l=n(5),s=n(25),u=n(68),c=n(517),f=n(349),d=n(353),m=n(10),h=n(160),g=n(120),b=n.n(g),p=n(15),j=n(6),y=n(189),v=n(67),x=n(116),M=n(212),O=n(404),w=n(493),S=n(529),T=n(843),E=n(101),C=n.n(E),k=n(408);const A=({influencerFieldName:e,influencerFilter:t,valueData:n})=>{const r=Math.floor(n.maxAnomalyScore),i=Object(S.a)(n.maxAnomalyScore),o=Object(T.a)(r),l=Math.floor(n.sumAnomalyScore),u=Object(S.a)(n.sumAnomalyScore),c={width:`${0!==r?r:1}%`},f=function(e,t){return Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)("p",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.influencersList.maxAnomalyScoreTooltipDescription",defaultMessage:"Maximum anomaly score: {maxScoreLabel}",values:{maxScoreLabel:e}})),Object(j.jsx)("p",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.influencersList.totalAnomalyScoreTooltipDescription",defaultMessage:"Total anomaly score: {totalScoreLabel}",values:{totalScoreLabel:t}})))}(i,u);return Object(j.jsx)("div",{"data-test-subj":`mlInfluencerEntry field-${e}`},Object(j.jsx)("div",{className:"field-label","data-test-subj":"mlInfluencerEntryFieldLabel"},Object(j.jsx)(k.a,{entityName:e,entityValue:n.influencerFieldValue,filter:t})),Object(j.jsx)("div",{className:`progress ${o.id}`},Object(j.jsx)("div",{className:"progress-bar-holder"},Object(j.jsx)("div",{className:"progress-bar",style:c})),Object(j.jsx)("div",{className:"score-label"},Object(j.jsx)(s.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${e}: ${n.influencerFieldValue}`,content:f},Object(j.jsx)("span",null,i)))),Object(j.jsx)("div",{className:"total-score-label"},Object(j.jsx)(s.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${e}: ${n.influencerFieldValue}`,content:f},Object(j.jsx)("span",null,l>0?function(e,t=3){return Math.abs(e)<Math.pow(10,t)?e:C()(e).format("0a")}(l,4):u))))},F=({influencerFieldName:e,influencerFilter:t,fieldValues:n})=>{const r=n.map((n=>Object(j.jsx)(A,{key:n.influencerFieldValue,influencerFieldName:e,influencerFilter:t,valueData:n})));return Object(j.jsx)(a.a.Fragment,{key:e},Object(j.jsx)(s.EuiTitle,{size:"xxs","data-test-subj":`mlInfluencerFieldName ${e}`},Object(j.jsx)("h3",null,e)),Object(j.jsx)(s.EuiSpacer,{size:"xs"}),r,Object(j.jsx)(s.EuiSpacer,{size:"m"}))},I=({influencers:e,influencerFilter:t})=>{if(void 0===e||0===Object.keys(e).length)return Object(j.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround",className:"ml-influencers-list"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(s.EuiSpacer,{size:"xxl"}),Object(j.jsx)(s.EuiTitle,{size:"xxs",className:"influencer-title"},Object(j.jsx)("h3",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.influencersList.noInfluencersFoundTitle",defaultMessage:"No influencers found"})))));const n=Object.keys(e).map((n=>Object(j.jsx)(F,{key:n,influencerFieldName:n,influencerFilter:t,fieldValues:e[n]})));return Object(j.jsx)("div",{className:"ml-influencers-list"},n)};var D=n(178);const N=()=>{const{chartsStateService:e}=Object(D.b)(),t=o()(e.getShowCharts$(),e.getShowCharts()),n=Object(r.useCallback)((t=>{e.setShowCharts(t.target.checked)}),[]),a=Object(r.useMemo)((()=>Object(s.htmlIdGenerator)()()),[]);return Object(j.jsx)(s.EuiCheckbox,{id:a,label:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.controls.checkboxShowCharts.showChartsCheckboxLabel",defaultMessage:"Show charts"}),checked:t,onChange:n})};var L=n(485),P=n(268),B=n(207),Y=n(75),R=n(247),_=n(0);const z=R.a.KUERY;function U({inputString:e,queryLanguage:t,indexPattern:n}){var r;let a={};const i=[],o=Object(Y.fromKueryExpression)(e),l=o&&"and"===o.function;return o&&Array.isArray(o.arguments)&&o.arguments.forEach((e=>{void 0!==e.arguments?e.arguments.forEach((e=>{"string"==typeof e.value&&i.push(e.value)})):"string"==typeof e.value&&i.push(e.value)})),t===R.a.KUERY?a=Object(Y.toElasticsearchQuery)(Object(Y.fromKueryExpression)(e),n):t===R.a.LUCENE&&(a=Object(Y.luceneStringToDsl)(e)),{clearSettings:Boolean((null===(r=a)||void 0===r?void 0:r.match_all)&&0===Object.keys(a.match_all).length),settings:{filterQuery:a,queryString:e,tableQueryString:e,isAndOperator:l,filteredFields:i}}}function q({queryString:e,searchInput:t}){var n;return{language:null!==(n=null==t?void 0:t.language)&&void 0!==n?n:z,query:null!=e?e:""}}var H={name:"qhxz92",styles:"max-width:100%"};const $=({filterActive:e,filterPlaceHolder:t,indexPattern:n,queryString:a,updateLanguage:i,dataViews:o=[]})=>{const{anomalyExplorerCommonStateService:u}=Object(D.b)(),{services:c}=Object(m.d)(),{unifiedSearch:{ui:{QueryStringInput:f}}}=c,[d,h]=Object(r.useState)(q({queryString:a})),[g,b]=Object(r.useState)(void 0);return Object(r.useEffect)((function(){h(q({queryString:a,searchInput:d}))}),[a,d.language]),Object(j.jsx)(s.EuiInputPopover,{css:H,closePopover:b.bind(null,void 0),input:Object(j.jsx)(f,{bubbleSubmitEvent:!1,query:d,indexPatterns:null!=o?o:[],onChange:e=>{d.language!==e.language&&i(e.language),h(e)},onSubmit:e=>{try{const{clearSettings:t,settings:r}=U({inputString:e.query,queryLanguage:e.language,indexPattern:n});!0===t?u.clearFilterSettings():u.setFilterSettings(r)}catch(t){console.log("Invalid query syntax in search bar",t),b({query:e.query,message:t.message})}},placeholder:t,disableAutoFocus:!0,dataTestSubj:"explorerQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown",appName:_.g}),isOpen:(null==g?void 0:g.query)===d.query&&""!==(null==g?void 0:g.message)},Object(j.jsx)(s.EuiCode,null,l.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageQueryBar",{defaultMessage:"Invalid query"}),": ",null==g?void 0:g.message.split("\n")[0]))};var W=n(139),V=n(8),J=n(172),G=n.n(J),X=n(415),Q=n(112),Z=n(269),K=n(375),ee=n(60),te=n(132),ne=n(406),re=n(241);const ae=()=>Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.anomalySwimLane.noOverallDataMessage",defaultMessage:"No anomalies found in the overall bucket results for this time range"});var ie=n(401);const oe=()=>Object(j.jsx)(M.a,{anchorPosition:"upCenter",title:l.i18n.translate("xpack.ml.explorer.anomalyTimelinePopoverTitle",{defaultMessage:"Anomaly timelines"})},Object(j.jsx)("p",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverBasicExplanation",defaultMessage:"Swim lanes provide an overview of the buckets of data that have been analyzed within the selected time period. You can view an overall swim lane or view them by job or influencer."})),Object(j.jsx)("p",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverScoreExplanation",defaultMessage:"Each block in a swim lane is colored according to its anomaly score, which is a value from 0 to 100. The blocks with high scores are shown in red and low scores are indicated in blue."})),Object(j.jsx)("p",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverAdvancedExplanation",defaultMessage:"The anomaly scores that you see in each section of the Anomaly Explorer might differ slightly. This disparity occurs because for each job there are bucket results, overall bucket results, influencer results, and record results. Anomaly scores are generated for each type of result. The overall swim lane shows the maximum overall bucket score for each block. When you view a swim lane by job, it shows the maximum bucket score in each block. When you view by influencer, it shows the maximum influencer score in each block."})),Object(j.jsx)("p",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverSelectionExplanation",defaultMessage:"When you select one or more blocks in the swim lanes, the list of anomalies and top influencers is likewise filtered to provide information relative to that selection."})));var le=n(309),se=n(145),ue=n.n(se),ce=n(772),fe=n(39),de=n.n(fe),me=n(49);const he=({chartWidth:e,domain:t,annotationsData:n,tooltipService:i})=>{const o=a.a.useRef(null),{euiTheme:s}=Object(m.a)();return Object(r.useEffect)((()=>{if(null!==o.current&&Array.isArray(n)){const a=ue.a.select(o.current);a.selectAll("*").remove();const u=o.current.getBoundingClientRect(),c=me.c,f=u.width,d=a.append("svg").attr("width","100%").attr("height",12),m=Object(ce.scaleTime)().domain([t.min,t.max]).range([c,f]);d.append("text").attr("text-anchor","end").attr("class","swimlaneAnnotationLabel").text(l.i18n.translate("xpack.ml.explorer.swimlaneAnnotationLabel",{defaultMessage:"Annotations"})).attr("x",me.c-me.b).attr("y",6).attr("dominant-baseline","middle").style("fill",s.euiTextSubduedColor).style("font-size",s.euiFontSizeXS),d.append("rect").attr("x",c).attr("y",0).attr("height",12).attr("width",f-c).style("stroke",s.euiBorderColor).style("fill","none").style("stroke-width",1);let h=[];const g=[...n].sort(((e,t)=>e.timestamp-t.timestamp));if(g.length>0){var e;let t=null!==(e=g[0].end_timestamp)&&void 0!==e?e:g[0].timestamp;h=[{start:g[0].timestamp,end:t,annotations:[g[0]]}];for(let e=1;e<g.length;e++)if(g[e].timestamp<t){const n=h.pop();if(n){const r={...n,end:t,annotations:[...n.annotations,g[e]]};h.push(r)}}else{var r;t=null!==(r=g[e].end_timestamp)&&void 0!==r?r:g[e].timestamp,h.push({start:g[e].timestamp,end:t,annotations:[g[e]]})}}h.forEach((e=>{const n=Math.max(e.end?m(Math.min(e.end,t.max))-Math.max(m(e.start),c):0,8),r=e.start>=t.min?m(e.start):c;d.append("rect").classed("mlAnnotationRect",!0).attr("x",r+n>=f?f-n:r).attr("y",0).attr("height",12).attr("width",n).on("mouseover",(function(){const t=[];if(Array.isArray(e.annotations)){const n=e.annotations.length>1;n&&t.push({skipHeader:!0}),e.annotations.forEach((e=>{let r=de()(e.timestamp).format("MMMM Do YYYY, HH:mm");var a,i,o;void 0!==e.end_timestamp&&(r+=` - ${de()(e.end_timestamp).format(n?"HH:mm":"MMMM Do YYYY, HH:mm")}`),n?t.push({label:r,value:`${e.annotation}`,seriesIdentifier:{key:"anomaly_timeline",specId:null!==(a=e._id)&&void 0!==a?a:`${e.annotation}-${e.timestamp}-label`},valueAccessor:"annotation"}):t.push({label:`${e.annotation}`,seriesIdentifier:{key:"anomaly_timeline",specId:null!==(i=e._id)&&void 0!==i?i:`${e.annotation}-${e.timestamp}-label`},valueAccessor:"label"},{label:`${r}`,seriesIdentifier:{key:"anomaly_timeline",specId:null!==(o=e._id)&&void 0!==o?o:`${e.annotation}-${e.timestamp}-ts`},valueAccessor:"time"}),void 0!==e.partition_field_name&&void 0!==e.partition_field_value&&t.push({label:`${e.partition_field_name}: ${e.partition_field_value}`,seriesIdentifier:{key:"anomaly_timeline",specId:e._id?`${e._id}-partition`:`${e.partition_field_name}-${e.partition_field_value}-label`},valueAccessor:"partition"})}))}i.show(t,this)})).on("mouseout",(()=>i.hide()))}))}}),[e,t,n,i]),Object(j.jsx)("div",{ref:o})};var ge=n(284),be=n(390);const pe=Object(Q.withSuspense)(Q.LazySavedObjectSaveModalDashboard);var je={name:"1np9cuq",styles:"margin-left:auto !important;align-self:baseline"},ye={name:"vavmm1",styles:"max-width:500px"};const ve=a.a.memo((({explorerState:e})=>{var t,n,i;const{services:{application:{capabilities:u},charts:f,cases:h,embeddable:g,uiSettings:b}}=Object(m.d)(),y=Object(c.b)(!0),x=null==h?void 0:h.hooks.useCasesAddToExistingCaseModal(),{anomalyExplorerCommonStateService:M,anomalyTimelineStateService:O}=Object(D.b)(),w=O.setSelectedCells.bind(O),[S,T]=Object(r.useState)(!1),E=null!==(t=null===(n=u.dashboard)||void 0===n?void 0:n.createNew)&&void 0!==t&&t,C=Object(d.a)(b),{overallAnnotations:k}=e,{filterActive:A,queryString:F}=o()(M.getFilterSettings$(),M.getFilterSettings()),I=o()(O.getSwimLaneCardinality$()),N=o()(M.getSelectedJobs$(),M.getSelectedJobs()),L=o()(O.isOverallSwimLaneLoading$(),!0),P=o()(O.getContainerWidth$(),O.getContainerWidth()),B=o()(O.isViewBySwimLaneLoading$(),!0),Y=o()(O.getOverallSwimLaneData$()),_=o()(O.getViewBySwimLaneData$()),z=o()(O.getSelectedCells$(),O.getSelectedCells()),U=o()(O.getSwimLaneSeverity$()),q=o()(O.getViewBySwimlaneFieldName$()),H=o()(O.getViewBySwimLaneOptions$(),O.getViewBySwimLaneOptions()),{viewByPerPage:$,viewByFromPage:W}=o()(O.getSwimLanePagination$(),O.getSwimLanePagination()),[V,J]=Object(r.useState)(O.getSwimLaneSeverity()),[Q,se]=Object(r.useState)(),ue=function(e){if(void 0!==(null==e?void 0:e.times))return{earliestMs:1e3*e.times[0],latestMs:1e3*e.times[1]-1}}(z),ce=ue?`${Object(X.b)(ue.earliestMs)} - ${Object(X.b)(ue.latestMs)}`:null;G()((()=>{V!==U&&O.setSeverity(V)}),500,[V,U]);const fe=Object(K.a)(ee.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE),de=Object(r.useCallback)((e=>{fe({swimlaneType:e,...e===te.h.VIEW_BY?{viewBy:q}:{},jobIds:null==N?void 0:N.map((e=>e.id)),timeRange:y,...Object(v.a)(F)&&""!==F?{query:{query:F,language:R.a.KUERY}}:{}})}),[fe,N,y,q,F]),ve=Object(r.useMemo)((()=>k.annotationsData),[k]),xe=Object(r.useCallback)((e=>()=>{T(!1),e()}),[T]),Me=Object(r.useMemo)((()=>{const e=[],t=[{id:0,items:e}];E&&(e.push({name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.addToDashboardLabel",defaultMessage:"Add to dashboard"}),panel:"addToDashboardPanel","data-test-subj":"mlAnomalyTimelinePanelAddToDashboardButton"}),t.push({id:"addToDashboardPanel",size:"s",title:l.i18n.translate("xpack.ml.explorer.addToDashboardLabel",{defaultMessage:"Add to dashboard"}),items:[{name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.overallLabel",defaultMessage:"Overall"}),onClick:xe(se.bind(null,te.h.OVERALL)),"data-test-subj":"mlAnomalyTimelinePanelAddOverallToDashboardButton"},{name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.viewByFieldLabel",defaultMessage:"View by {viewByField}",values:{viewByField:q}}),onClick:xe(se.bind(null,te.h.VIEW_BY)),"data-test-subj":"mlAnomalyTimelinePanelAddViewByToDashboardButton"}]}));const n=null==h?void 0:h.helpers.canUseCases();return(null!=n&&n.create||null!=n&&n.update)&&x&&(e.push({panel:1,name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.attachToCaseLabel",defaultMessage:"Add to case"}),"data-test-subj":"mlAnomalyTimelinePanelAttachToCaseButton"}),t.push({id:1,initialFocusedItemIndex:0,title:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.attachToCaseLabel",defaultMessage:"Add to case"}),items:[{name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.attachOverallSwimLane",defaultMessage:"Overall"}),onClick:xe(de.bind(null,te.h.OVERALL)),"data-test-subj":"mlAnomalyTimelinePanelAttachOverallButton"},{name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.attachViewBySwimLane",defaultMessage:"View by {viewByField}",values:{viewByField:q}}),onClick:xe(de.bind(null,te.h.VIEW_BY)),"data-test-subj":"mlAnomalyTimelinePanelAttachViewByButton"}]})),t}),[E,de,q]),Oe=Object(r.useMemo)((()=>{if(z)return z.type===te.h.OVERALL?z:{type:te.h.OVERALL,lanes:[te.g],times:z.times}}),[z]),we=Object(r.useMemo)((()=>ge.AnomalyTimelineService.isOverallSwimlaneData(Y)?{min:1e3*Y.earliest,max:1e3*Y.latest,minInterval:1e3*Y.interval}:void 0),[Y]),Se=Object(r.useCallback)((e=>{O.setContainerWidth(e)}),[]),Te=Object(r.useCallback)((({dashboardId:e,newTitle:t,newDescription:n})=>{if(!N)return;const r=g.getStateTransfer(),a=N.map((e=>e.id)),i=function(e,t){return{title:Object(Z.a)(e).concat(t?`- ${t}`:""),id:Object(s.htmlIdGenerator)()()}}(a,F),o={input:{id:i.id,title:t,description:n,jobIds:a,swimlaneType:Q,...Q===te.h.VIEW_BY?{viewBy:q}:{},...void 0!==F?{query:{query:F,language:R.a.KUERY}}:{}},type:ee.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE},l="new"===e?"#/create":`#/view/${e}`;r.navigateToWithEmbeddablePackage("dashboards",{state:o,path:l})}),[g,F,N,Q,q]);return Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(s.EuiPanel,{paddingSize:"m",hasShadow:!1,hasBorder:!0},Object(j.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"xs",responsive:!1,alignItems:"baseline"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(s.EuiTitle,{size:"xs"},Object(j.jsx)("h2",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelineTitle",defaultMessage:"Anomaly timeline"})))),Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(oe,null)),Me[0].items.length>0?Object(j.jsx)(s.EuiFlexItem,{grow:!1,css:je},Object(j.jsx)(s.EuiPopover,{button:Object(j.jsx)(s.EuiButtonIcon,{size:"s","aria-label":l.i18n.translate("xpack.ml.explorer.swimlaneActions",{defaultMessage:"Actions"}),color:"text",iconType:"boxesHorizontal",onClick:T.bind(null,!S),"data-test-subj":"mlAnomalyTimelinePanelMenu"}),isOpen:S,closePopover:T.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(j.jsx)(s.EuiContextMenu,{initialPanelId:0,panels:Me}))):null),Object(j.jsx)(s.EuiSpacer,{size:"s"}),Object(j.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"baseline"},H.length>0&&Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(s.EuiSelect,{prepend:l.i18n.translate("xpack.ml.explorer.viewByLabel",{defaultMessage:"View by"}),compressed:!0,id:"selectViewBy",options:(Ee=H,Ee.map((e=>({value:e,text:e})))),value:q,onChange:e=>{O.setViewBySwimLaneFieldName(e.target.value)}}))),Object(j.jsx)(s.EuiFlexItem,{grow:!0,css:ye},Object(j.jsx)(ie.a,{value:null!=V?V:0,onChange:Object(r.useCallback)((e=>{J(e)}),[])}))),Object(j.jsx)(s.EuiSpacer,{size:"m"}),Object(j.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(s.EuiText,{size:"xs",color:"subdued"},ce&&Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreForTimeFormattedLabel",defaultMessage:"(Sorted by max anomaly score for {viewByLoadedForTimeFormatted})",values:{viewByLoadedForTimeFormatted:ce}}),Object(v.a)(ce)?null:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreLabel",defaultMessage:"(Sorted by max anomaly score)"}),!0===A&&q===te.j&&Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.jobScoreAcrossAllInfluencersLabel",defaultMessage:"(Job score across all influencers)"}))),Object(j.jsx)(s.EuiFlexItem,{grow:!1,css:Object(j.css)({visibility:z?"visible":"hidden"},"","")},Object(j.jsx)(s.EuiButtonEmpty,{size:"xs",onClick:w.bind(O,void 0),"data-test-subj":"mlAnomalyTimelineClearSelection"},Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.clearSelectionLabel",defaultMessage:"Clear selection"})))),Object(j.jsx)(s.EuiSpacer,{size:"m"}),we&&Array.isArray(ve)&&ve.length>0?Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(le.a,null,(e=>Object(j.jsx)(he,{chartWidth:P,domain:we,annotationsData:ve,tooltipService:e}))),Object(j.jsx)(s.EuiSpacer,{size:"m"})):null,Object(j.jsx)(be.c,{selection:Oe,swimlaneContainerWidth:P,swimLaneData:Y},Object(j.jsx)(re.b,{id:"overall","data-test-subj":"mlAnomalyExplorerSwimlaneOverall",filterActive:A,timeBuckets:C,swimlaneData:Y,swimlaneType:te.h.OVERALL,selection:Oe,onCellsSelection:w,onResize:Se,isLoading:L,noDataWarning:Object(j.jsx)(s.EuiText,{textAlign:"center"},Object(j.jsx)("h5",null,Object(j.jsx)(ae,null))),showTimeline:!1,showLegend:!1,yAxisWidth:me.c,chartsService:f})),Object(j.jsx)(s.EuiSpacer,{size:"m"}),H.length>0&&Object(j.jsx)(re.b,{id:"view_by","data-test-subj":"mlAnomalyExplorerSwimlaneViewBy",filterActive:A,timeBuckets:C,showLegend:!1,swimlaneData:_,swimlaneType:te.h.VIEW_BY,selection:z,onCellsSelection:w,onResize:Se,fromPage:W,perPage:$,swimlaneLimit:I,chartsService:f,onPaginationChange:({perPage:e,fromPage:t})=>{e&&O.setSwimLanePagination({viewByPerPage:e}),t&&O.setSwimLanePagination({viewByFromPage:t})},isLoading:L||B,yAxisWidth:me.c,noDataWarning:Object(j.jsx)(s.EuiText,{textAlign:"center"},Object(j.jsx)("h5",null,"string"==typeof q?q===te.j?Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.noResultForSelectedJobsMessage",defaultMessage:"No results found for selected {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:null!==(i=null==N?void 0:N.length)&&void 0!==i?i:1}}):Object(j.jsx)(ne.a,{viewBySwimlaneFieldName:q,showFilterMessage:!0===A}):null))})),Q&&N?Object(j.jsx)(pe,{canSaveByReference:!1,objectType:l.i18n.translate("xpack.ml.cases.anomalySwimLane.displayName",{defaultMessage:"Anomaly swim lane"}),documentInfo:{title:Object(Z.a)(N.map((({id:e})=>e)))},onClose:()=>{se(void 0)},onSave:Te}):null);var Ee}),((e,t)=>Object(V.isEqual)(e.explorerState,t.explorerState)));var xe=n(490),Me=n(332),Oe=n(285),we=n(378),Se=n(135),Te=n(48),Ee=n(161),Ce=n(310);const ke=Object(Q.withSuspense)(Q.LazySavedObjectSaveModalDashboard);var Ae={name:"1ktfjpo",styles:"margin-left:auto;align-self:baseline"};const Fe=({selectedJobs:e,selectedCells:t,bounds:n,interval:i,chartsCount:u})=>{var f,d,h,g;const{services:{application:{capabilities:b},cases:y,embeddable:x}}=Object(m.d)(),M=Object(c.b)(!0),[O,w]=Object(r.useState)(!1),[S,T]=Object(r.useState)(!1),[E]=Object(Oe.a)(),[C,k]=Object(r.useState)(Te.b),A=Object(r.useCallback)((e=>{w(!1),e()}),[w]),F=Object(K.a)(Ee.a),I=null!==(f=null===(d=b.dashboard)||void 0===d?void 0:d.createNew)&&void 0!==f&&f,N=null==y?void 0:y.helpers.canUseCases(),{anomalyExplorerCommonStateService:L,chartsStateService:P}=Object(D.b)(),{queryString:B}=o()(L.getFilterSettings$(),L.getFilterSettings()),Y=o()(P.getChartsData$(),P.getChartsData()),_=Object(r.useMemo)((()=>{if(Y.seriesToPlot.length>0)return{from:Object(s.formatDate)(Y.seriesToPlot[0].plotEarliest,"MMM D, YYYY @ HH:mm:ss.SSS"),to:Object(s.formatDate)(Y.seriesToPlot[0].plotLatest,"MMM D, YYYY @ HH:mm:ss.SSS")};if(t&&void 0!==i&&void 0!==n){const{earliestMs:e,latestMs:r}=Object(W.k)(t,n);return{from:Object(s.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS"),to:Object(s.formatDate)(r,"MMM D, YYYY @ HH:mm:ss.SSS"),mode:"absolute"}}return M}),[Y.seriesToPlot,M,t,n,i]),z="number"==typeof C&&C>=1&&C<=we.b,U=e.map((({id:e})=>e)),q=Object(r.useCallback)((e=>{const n=Object(W.i)(t,null==t?void 0:t.viewByFieldName),r=null!=n?n:[],a=function(e,t){return{id:Object(s.htmlIdGenerator)()(),title:Object(Ce.a)(e).concat(t?`- ${t}`:"")}}(U,B),i=r.map((e=>Object(Se.d)(e.fieldName,e.fieldValue))).join(" or ");return{...a,...e?{timeRange:e}:{},jobIds:U,maxSeriesToPlot:null!=C?C:Te.b,severityThreshold:E.val,...Object(v.a)(B)&&""!==B||void 0!==i&&""!==i?{query:{query:""===B?i:B,language:R.a.KUERY}}:{}}}),[U,C,E,B,t]),H=Object(r.useCallback)((({dashboardId:e,newTitle:t,newDescription:n})=>{const r=x.getStateTransfer(),a={input:{...q(),title:t,description:n},type:Ee.a},i="new"===e?"#/create":`#/view/${e}`;r.navigateToWithEmbeddablePackage("dashboards",{state:a,path:i})}),[x,q]),$=Object(r.useMemo)((()=>{const e=[],t=[{id:"panelActions",items:e}],n=e=>Object(j.jsx)(s.EuiPanel,{paddingSize:"s"},Object(j.jsx)(s.EuiSpacer,{size:"s"}),Object(j.jsx)(s.EuiForm,null,Object(j.jsx)(s.EuiFormRow,{isInvalid:!z,error:z?void 0:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.maxSeriesToPlotError",defaultMessage:"Maximum number of series to plot must be between 1 and 50."}),label:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.anomalyCharts.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},Object(j.jsx)(s.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:C,onChange:e=>k(parseInt(e.target.value,10)),min:1,max:we.b})),Object(j.jsx)(s.EuiButton,{fill:!0,type:"submit",fullWidth:!0,onClick:e,disabled:!z,"data-test-subj":"mlAnomalyChartsSubmitAttachment"},Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.anomalies.submitAttachLabel",defaultMessage:"Attach"}))));return I&&(e.push({name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.addToDashboardLabel",defaultMessage:"Add to dashboard"}),panel:"addToDashboardPanel","data-test-subj":"mlAnomalyAddChartsToDashboardButton"}),t.push({id:"addToDashboardPanel",size:"s",title:l.i18n.translate("xpack.ml.explorer.anomalies.addToDashboardLabel",{defaultMessage:"Add to dashboard"}),content:n(A.bind(null,T.bind(null,!0)))})),(null!=N&&N.create||null!=N&&N.update)&&(e.push({name:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.attachToCaseLabel",defaultMessage:"Add to case"}),panel:"addToCasePanel","data-test-subj":"mlAnomalyAttachChartsToCasesButton"}),t.push({id:"addToCasePanel",size:"s",title:l.i18n.translate("xpack.ml.explorer.attachToCaseLabel",{defaultMessage:"Add to case"}),content:n(A.bind(null,F.bind(null,q(_))))})),t}),[q,I,N,C,z,A,F,_]);return Object(j.jsx)(a.a.Fragment,null,null!==(h=$[0])&&void 0!==h&&null!==(g=h.items)&&void 0!==g&&g.length&&u>0?Object(j.jsx)(s.EuiFlexItem,{grow:!1,css:Ae},Object(j.jsx)(s.EuiPopover,{button:Object(j.jsx)(s.EuiButtonIcon,{size:"s","aria-label":l.i18n.translate("xpack.ml.explorer.anomalies.actionsAriaLabel",{defaultMessage:"Actions"}),color:"text",iconType:"boxesHorizontal",onClick:w.bind(null,!O),"data-test-subj":"mlExplorerAnomalyPanelMenu",disabled:u<1}),isOpen:O,closePopover:w.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(j.jsx)(s.EuiContextMenu,{panels:$,initialPanelId:"panelActions"}))):null,S&&e?Object(j.jsx)(ke,{canSaveByReference:!1,objectType:l.i18n.translate("xpack.ml.cases.anomalyCharts.displayName",{defaultMessage:"Anomaly charts"}),documentInfo:{title:Object(Ce.a)(e.map((({id:e})=>e)))},onClose:T.bind(null,!1),onSave:H}):null)};var Ie=n(71),De=n(179),Ne=n(77);const Le=Object(x.a)((async()=>({default:(await n.e(93).then(n.bind(null,315))).AnnotationFlyout}))),Pe=Object(x.a)((async()=>({default:(await n.e(101).then(n.bind(null,856))).AnomaliesMap}))),Be=Object(x.a)((async()=>({default:(await n.e(26).then(n.bind(null,811))).ExplorerChartsContainer}))),Ye=({children:e,jobSelectorProps:t,noInfluencersConfigured:n,influencers:r,filterActive:i,filterPlaceHolder:o,indexPattern:l,dataViews:u,queryString:c,updateLanguage:f})=>Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(s.EuiPageHeader,null,Object(j.jsx)(s.EuiPageHeaderSection,{style:{width:"100%"}},Object(j.jsx)(L.a,t),l&&f?Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)($,{filterActive:!!i,filterPlaceHolder:o,indexPattern:l,dataViews:u,queryString:c,updateLanguage:f}),Object(j.jsx)(s.EuiSpacer,{size:"m"}),Object(j.jsx)(s.EuiHorizontalRule,{margin:"none"})):null)),e),Re=({invalidTimeRangeError:e,showCharts:t,severity:n,stoppedPartitions:i,selectedJobsRunning:u,timefilter:c,timeBuckets:f,selectedCells:d,swimLaneSeverity:h,explorerState:g,overallSwimlaneData:x})=>{var S,T;const E=Object(s.useIsWithinBreakpoints)(["xs","s"]),[C,k]=Object(y.b)(De.a,{topInfluencers:{isCollapsed:!1,size:20},mainPage:{size:80}}),A=Object(r.useRef)(null),F=Object(r.useRef)(),L=Object(r.useRef)(!1);Object(r.useEffect)((function(){!L.current&&F.current&&A.current&&(L.current=!0,C.topInfluencers.isCollapsed&&setTimeout((()=>{F.current&&F.current()}),0))}),[F.current,L,A.current,C]);const Y=Object(r.useCallback)((e=>{k({mainPage:{size:e.mainPage},topInfluencers:{...C.topInfluencers,size:e.topInfluencers}})}),[C]),R=Object(r.useCallback)((()=>{L.current=!0;const e=C.topInfluencers.isCollapsed;k(e?{mainPage:{size:80},topInfluencers:{size:20,isCollapsed:!e}}:{mainPage:C.mainPage,topInfluencers:{...C.topInfluencers,isCollapsed:!e}})}),[C]),{displayWarningToast:_,displayDangerToast:q}=Object(Ie.useToastNotificationService)(),{anomalyTimelineStateService:H,anomalyExplorerCommonStateService:$,chartsStateService:V,anomalyDetectionAlertsStateService:J}=Object(D.b)(),G=Object(r.useMemo)((()=>Object(s.htmlIdGenerator)()),[]),[X,Q]=Object(r.useState)(z),[Z,K]=Object(r.useState)({}),[ee,ne]=Object(r.useState)(),re=o()($.getFilterSettings$(),$.getFilterSettings()),ae=o()($.getSelectedJobs$(),$.getSelectedJobs()),ie=o()(J.anomalyDetectionAlerts$,[]),oe=Object(r.useCallback)(((e,t,n)=>{const{filterActive:r,queryString:a}=re,i=g.indexPattern;let o="";const s=Object(W.c)(e),u=Object(W.b)(t);if(n===te.d.ADD){const n=Object(W.h)(e,t);if(null!==a.match(n))return;o=`${a?`${a} and `:""}${s}:"${u}"`}else if(n===te.d.REMOVE){if(!1===r)return;o=Object(W.q)(a,s,u)}try{const{clearSettings:e,settings:t}=U({inputString:`${o}`,queryLanguage:X,indexPattern:i});!0===e?$.clearFilterSettings():$.setFilterSettings(t)}catch(e){console.log("Invalid query syntax from table",e),q(l.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageFromTable",{defaultMessage:"Invalid syntax in query bar. The input must be valid Kibana Query Language (KQL)"}))}}),[g,X,re]);Object(r.useEffect)((()=>{e&&_(l.i18n.translate("xpack.ml.explorer.invalidTimeRangeInUrlCallout",{defaultMessage:"The time filter was changed to the full range due to an invalid default time filter. Check the advanced settings for {field}.",values:{field:Me.a}}))}),[]);const{services:{charts:le,data:{dataViews:se}}}=Object(m.d)(),{euiTheme:ue}=Object(s.useEuiTheme)(),ce=Object(Ne.useMlIndexUtils)(),fe=Object(m.g)(),{annotations:de,filterPlaceHolder:me,indexPattern:he,influencers:ge,loading:pe,noInfluencersConfigured:je,tableData:ye}=g,Oe=o()(V.getChartsData$(),V.getChartsData()),{filterActive:we,queryString:Se}=re,Te=o()(H.isOverallSwimLaneLoading$(),!0),Ee=o()(H.isViewBySwimLaneLoading$(),!0),Ce=pe||Te||Ee,ke=o()(H.getSwimLaneBucketInterval$(),H.getSwimLaneBucketInterval()),{annotationsData:Ae,totalCount:Re,error:_e}=de,ze=Array.isArray(Ae)?Ae.length:0,Ue=(null!=Re?Re:0)>ze?Object(j.jsx)(s.EuiBadge,{color:"hollow"},Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.annotationsOutOfTotalCountTitle",defaultMessage:"First {visibleCount} out of a total of {totalCount}",values:{visibleCount:ze,totalCount:Re}})):Object(j.jsx)(s.EuiBadge,{color:"hollow"},Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitleTotalCount",defaultMessage:"Total: {count}",values:{count:ze}})),qe={dateFormatTz:Object(W.f)()},He=!ae||0===ae.length,$e=!(null==x||!x.points)&&x.points.length>0,We=$e&&x.points.some((e=>e.value>0))||(null===(S=ye.anomalies)||void 0===S?void 0:S.length)>0,Ve=Object(v.a)(h),Je=Array.isArray(ae)?ae.map((e=>e.id)):[];if(Object(r.useEffect)((()=>{He||Object(W.e)(ae,se,ce).then((({sourceIndicesWithGeoFieldsMap:e,dataViews:t})=>{K(e),ne(t)})).catch(console.error)}),[JSON.stringify(Je)]),He&&!pe)return Object(j.jsx)(Ye,{dataViews:ee,jobSelectorProps:qe},Object(j.jsx)(w.a,null));if(!We&&!Ce&&!Ve)return Object(j.jsx)(Ye,{dataViews:ee,jobSelectorProps:qe},Object(j.jsx)(w.b,{hasResults:$e,selectedJobsRunning:u}));const Ge=c.getActiveBounds(),Xe=Object(j.jsx)("div",null,i&&Object(j.jsx)(s.EuiCallOut,{size:"s",title:Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.stoppedPartitionsExistCallout",defaultMessage:"There may be fewer results than there could have been because stop_on_warn is turned on. Both categorization and subsequent anomaly detection have stopped for some partitions in {jobsWithStoppedPartitions, plural, one {job} other {jobs}} [{stoppedPartitions}] where the categorization status has changed to warn.",values:{jobsWithStoppedPartitions:i.length,stoppedPartitions:i.join(", ")}})}),Object(j.jsx)(ve,{explorerState:g}),Object(j.jsx)(s.EuiSpacer,{size:"m"}),ie.length>0?Object(j.jsx)(be.a,null):null,void 0!==_e&&Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(s.EuiTitle,{"data-test-subj":"mlAnomalyExplorerAnnotationsPanel error",size:"xs"},Object(j.jsx)("h2",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.annotationsErrorTitle",defaultMessage:"Annotations"}))),Object(j.jsx)(s.EuiPanel,null,Object(j.jsx)(s.EuiCallOut,{title:l.i18n.translate("xpack.ml.explorer.annotationsErrorCallOutTitle",{defaultMessage:"An error occurred loading annotations:"}),color:"danger",iconType:"warning"},Object(j.jsx)("p",null,_e))),Object(j.jsx)(s.EuiSpacer,{size:"m"})),!1===pe&&null!==(T=ye.anomalies)&&void 0!==T&&T.length?Object(j.jsx)(Pe,{anomalies:ye.anomalies,jobIds:Je}):null,ze>0&&Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(s.EuiPanel,{"data-test-subj":"mlAnomalyExplorerAnnotationsPanel loaded",hasBorder:!0,hasShadow:!1},Object(j.jsx)(s.EuiAccordion,{id:G(),buttonContent:Object(j.jsx)(s.EuiTitle,{"data-test-subj":"mlAnomalyExplorerAnnotationsPanelButton",size:"xs"},Object(j.jsx)("h2",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitle",defaultMessage:"Annotations {badge}",values:{badge:Ue}})))},Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(s.EuiSpacer,{size:"m"}),Object(j.jsx)(O.a,{annotations:Ae,drillDown:!0,numberBadge:!1})))),Object(j.jsx)(Le,null),Object(j.jsx)(s.EuiSpacer,{size:"m"})),!1===pe&&Object(j.jsx)(s.EuiPanel,{hasBorder:!0,hasShadow:!1},Object(j.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(s.EuiTitle,{size:"xs"},Object(j.jsx)("h2",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.anomaliesTitle",defaultMessage:"Anomalies"})))),Object(j.jsx)(s.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},Object(j.jsx)(Fe,{selectedJobs:ae,selectedCells:d,bounds:Ge,interval:ke?ke.asSeconds():void 0,chartsCount:Oe.seriesToPlot.length}))),Object(j.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:!0,alignItems:"center"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(B.a,null)),Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(P.a,null)),Oe.seriesToPlot.length>0&&void 0!==d&&Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(N,null))),Object(j.jsx)(s.EuiSpacer,{size:"m"}),t?Object(j.jsx)(Be,b()({},Oe,{severity:n,timefilter:c,mlLocator:fe,timeBuckets:f,onSelectEntity:oe,chartsService:le})):null,Object(j.jsx)(s.EuiSpacer,{size:"m"}),Object(j.jsx)(xe.a,{bounds:Ge,tableData:ye,influencerFilter:oe,sourceIndicesWithGeoFields:Z,selectedJobs:ae})));return Object(j.jsx)(Ye,{dataViews:ee,jobSelectorProps:qe,noInfluencersConfigured:je,influencers:ge,filterActive:we,filterPlaceHolder:me,indexPattern:he,queryString:Se,updateLanguage:Q},Object(j.jsx)(s.EuiSpacer,{size:"m"}),je?Object(j.jsx)(s.EuiFlexGroup,{gutterSize:"s"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(s.EuiIconTip,{content:l.i18n.translate("xpack.ml.explorer.noConfiguredInfluencersTooltip",{defaultMessage:"The Top Influencers list is hidden because no influencers have been configured for the selected jobs."}),position:"right",type:"iInCircle"})),Object(j.jsx)(s.EuiFlexItem,null,Xe)):Object(j.jsx)("div",null,Object(j.jsx)(s.EuiResizableContainer,{direction:E?"vertical":"horizontal",onPanelWidthChange:Y},((e,t,n)=>(F.current=()=>n.togglePanel("topInfluencers",{direction:"left"}),Object(j.jsx)(a.a.Fragment,null,Object(j.jsx)(e,{panelRef:A,id:"topInfluencers",mode:["collapsible",{"data-test-subj":"mlTopInfluencersToggle",position:"top"}],minSize:"200px",initialSize:20,paddingSize:"none",onToggleCollapsed:R},Object(j.jsx)("div",{"data-test-subj":"mlAnomalyExplorerInfluencerList",css:Object(j.css)("padding:calc(",ue.size.base," + ",ue.border.width.thin,") ",ue.size.l," ",ue.size.l," 0;","")},Object(j.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"xs",responsive:!1,alignItems:"baseline"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(s.EuiTitle,{size:"xs"},Object(j.jsx)("h2",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.topInfuencersTitle",defaultMessage:"Top influencers"})))),Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(M.a,{anchorPosition:"upCenter",title:l.i18n.translate("xpack.ml.explorer.topInfluencersPopoverTitle",{defaultMessage:"Top influencers"})},Object(j.jsx)("p",null,Object(j.jsx)(p.FormattedMessage,{id:"xpack.ml.explorer.topInfluencersTooltip",defaultMessage:"View the relative impact of the top influencers in the selected time period and add them as filters on the results. Each influencer has a maximum anomaly score between 0-100 and a total anomaly score for that period."}))))),Object(j.jsx)(s.EuiSpacer,{size:"m"}),Object(j.jsx)(s.EuiSkeletonText,{lines:10,isLoading:pe},Object(j.jsx)(I,{influencers:ge,influencerFilter:oe})))),Object(j.jsx)(t,null),Object(j.jsx)(e,{id:"mainPage",mode:"main",minSize:"70%",initialSize:80,paddingSize:"none"},Xe)))))))};var _e=n(11),ze=n(500),Ue=n(504),qe=n(486),He=n(134),$e=n(323),We=n(503),Ve=n(276);const Je=({jobsWithTimeRange:e})=>{var t,n,i,g,b,p;const{services:{cases:y,presentationUtil:v,uiSettings:x}}=Object(m.d)(),[M]=Object(u.d)("_g"),[O,w]=Object(r.useState)(),[S,T]=Object(r.useState)(!1),E=Object(d.a)(x),C=Object(c.c)({timeRangeSelector:!0,autoRefreshSelector:!0}),{jobIds:k}=(e=>{var t,n;const[a,i]=Object(u.d)("_g"),{toasts:o}=Object(m.i)(),s=Object(Ue.a)(),c=Object(r.useMemo)((()=>{var e;const t=(null==a||null===(e=a.ml)||void 0===e?void 0:e.jobIds)||[];return("string"==typeof t?[t]:t).map((e=>String(e)))}),[null==a||null===(t=a.ml)||void 0===t?void 0:t.jobIds]),f=Object(r.useMemo)((()=>function(e,t){return t.filter((t=>!1===e.some((e=>e.job_id===t))&&"*"!==t))}(e,c)),[c]),d=Object(r.useMemo)((()=>{const e=Object(V.difference)(c,f);return e.sort(),e}),[c,f]),h=Object(r.useMemo)((()=>{var e,t;const n=null!==(e=null==a||null===(t=a.ml)||void 0===t?void 0:t.groups)&&void 0!==e?e:[];return{jobIds:d,selectedGroups:n}}),[d,null==a||null===(n=a.ml)||void 0===n?void 0:n.groups]);return Object(r.useEffect)((()=>{f.length>0&&o.addWarning(l.i18n.translate("xpack.ml.jobSelect.requestedJobsDoesNotExistWarningMessage",{defaultMessage:"Requested\n{invalidIdsLength, plural, one {job {invalidIds} does not exist} other {jobs {invalidIds} do not exist}}",values:{invalidIdsLength:f.length,invalidIds:f.join()}}))}),[f]),Object(r.useEffect)((()=>{0===d.length&&e.length>0&&s({singleSelection:!1}).then((({jobIds:e,time:t})=>{const n=(null==a?void 0:a.ml)||{};n.jobIds=e,i({ml:n,...void 0!==t?{time:t}:{}})})).catch((()=>{}))}),[e,d,i,null==a?void 0:a.ml]),h})(e),A=e.some((e=>k.includes(e.id)&&!0===e.isRunning)),F=Object(D.b)(),{explorerService:I}=F,N=o()(F.explorerService.state$),L=Object(h.a)(),P=null!==(t=null==L?void 0:L.lastRefresh)&&void 0!==t?t:0;Object(r.useEffect)((()=>{void 0!==(null==M?void 0:M.time)&&"invalid"===M.time.mode&&T(!0)}),[null==M||null===(n=M.time)||void 0===n?void 0:n.from,null==M||null===(i=M.time)||void 0===i?void 0:i.to,null==M||null===(g=M.time)||void 0===g?void 0:g.ts]);const B=Object(r.useCallback)((async e=>{try{const t=await _e.ml.results.getCategoryStoppedPartitions(e,f.b);t&&Array.isArray(t.jobs)&&t.jobs.length>0?w(t.jobs):w(void 0)}catch(e){console.error(e)}}),[]);Object(r.useEffect)((function(){k.length>0?(I.updateJobSelection(k),B(k)):I.clearJobs()}),[JSON.stringify(k)]),Object(r.useEffect)((()=>()=>{I.clearExplorerData()}),[]);const[Y,R]=Object(ze.b)();Object(r.useEffect)((()=>{void 0!==Y&&Object.keys(Y).length>0&&I.setExplorerData(Y)}),[Y]);const[_]=Object(qe.a)(),[z]=Object(Oe.a)(),U=o()(F.chartsStateService.getShowCharts$(),F.chartsStateService.getShowCharts()),q=o()(F.anomalyTimelineStateService.getSelectedCells$(),F.anomalyTimelineStateService.getSelectedCells()),H=o()(F.anomalyTimelineStateService.getViewBySwimlaneFieldName$()),$=o()(F.anomalyTimelineStateService.getSwimLaneSeverity$(),F.anomalyTimelineStateService.getSwimLaneSeverity()),W=o()(F.anomalyExplorerCommonStateService.getInfluencerFilterQuery$()),J=void 0!==N?{lastRefresh:P,influencersFilterQuery:W,noInfluencersConfigured:N.noInfluencersConfigured,selectedCells:q,selectedJobs:N.selectedJobs,tableInterval:_.val,tableSeverity:z.val,viewBySwimlaneFieldName:H}:void 0;Object(r.useEffect)((function(){F.anomalyExplorerCommonStateService.setSelectedJobs(null==J?void 0:J.selectedJobs)}),[J]),Object(r.useEffect)((()=>{J&&void 0!==(null==J?void 0:J.selectedCells)&&R(J)}),[JSON.stringify(J)]);const G=o()(F.anomalyTimelineStateService.getOverallSwimLaneData$(),null);if(void 0===N||void 0===L)return null;const X=null!==(b=null==y?void 0:y.ui.getCasesContext())&&void 0!==b?b:a.a.Fragment,Q=null!==(p=null==v?void 0:v.ContextProvider)&&void 0!==p?p:a.a.Fragment,Z=null==y?void 0:y.helpers.canUseCases();return Object(j.jsx)("div",{className:"ml-explorer"},Object(j.jsx)(He.a,null,Object(j.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)(We.a,{viewId:"explorer",selectedJobs:N.selectedJobs})),Object(j.jsx)(s.EuiFlexItem,{grow:!1},Object(j.jsx)($e.a,{title:l.i18n.translate("xpack.ml.explorer.pageTitle",{defaultMessage:"Anomaly Explorer"})})))),Object(j.jsx)(X,{owner:[],permissions:Z},Object(j.jsx)(Q,null,0===e.length?Object(j.jsx)(Ve.a,null):Object(j.jsx)(Re,{explorerState:N,overallSwimlaneData:G,showCharts:U,severity:z.val,stoppedPartitions:O,invalidTimeRangeError:S,selectedJobsRunning:A,timeBuckets:E,timefilter:C,selectedCells:q,swimLaneSeverity:$}))))}}}]);