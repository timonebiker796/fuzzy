/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[35],{210:function(e,t,s){e.exports=s(57)(8)},862:function(e,t,s){"use strict";s.r(t),s.d(t,"EditFilterList",(function(){return P})),s.d(t,"FilterLists",(function(){return D}));var i=s(4),l=s.n(i),r=s(2),a=s.n(r),n=s(25),o=s(5),c=s(15),d=s(21),u=s(6);class edit_description_popover_EditDescriptionPopover extends r.Component{constructor(e){super(e),l()(this,"onChange",(e=>{this.setState({value:e.target.value})})),l()(this,"onButtonClick",(()=>{!1===this.state.isPopoverOpen?this.setState({isPopoverOpen:!this.state.isPopoverOpen,value:this.props.description}):this.closePopover()})),l()(this,"closePopover",(()=>{!0===this.state.isPopoverOpen&&(this.setState({isPopoverOpen:!1}),this.props.updateDescription(this.state.value))})),this.state={isPopoverOpen:!1,value:e.description}}render(){const{isPopoverOpen:e,value:t}=this.state,s=Object(u.jsx)(n.EuiButtonIcon,{size:"s",color:"primary",onClick:this.onButtonClick,iconType:"pencil","aria-label":o.i18n.translate("xpack.ml.settings.filterLists.editDescriptionPopover.editDescriptionAriaLabel",{defaultMessage:"Edit description"}),isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListEditDescriptionButton"});return Object(u.jsx)("div",null,Object(u.jsx)(n.EuiPopover,{id:"filter_list_description_popover",ownFocus:!0,button:s,isOpen:e,closePopover:this.closePopover,initialFocus:"#filter_list_edit_description_row"},Object(u.jsx)("div",{style:{width:"300px"}},Object(u.jsx)(n.EuiForm,null,Object(u.jsx)(n.EuiFormRow,{id:"filter_list_edit_description_row",label:Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editDescriptionPopover.filterListDescriptionAriaLabel",defaultMessage:"Filter list description"})},Object(u.jsx)(n.EuiFieldText,{name:"filter_list_description",value:t,onChange:this.onChange,"data-test-subj":"mlFilterListDescriptionInput"}))))))}}l()(edit_description_popover_EditDescriptionPopover,"displayName","EditDescriptionPopover");class filter_list_usage_popover_FilterListUsagePopover extends r.Component{constructor(e){super(e),l()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),l()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),this.state={isPopoverOpen:!1}}render(){const{entityType:e,entityValues:t}=this.props,s=`${t.length} ${e}${1!==t.length?"s":""}`,i=t.map((e=>Object(u.jsx)("li",{key:e},e))),l=Object(u.jsx)(n.EuiButtonEmpty,{size:"s",color:"primary",onClick:this.onButtonClick},s);return Object(u.jsx)("div",null,Object(u.jsx)(n.EuiPopover,{id:`${e}_filter_list_usage`,panelClassName:"ml-filter-list-usage-popover",ownFocus:!0,button:l,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},Object(u.jsx)("ul",null,i)))}}var m=s(134);const p=({canCreateFilter:e,filterId:t,totalItemCount:s,description:i,updateDescription:l,newFilterId:r,isNewFilterIdInvalid:d,updateNewFilterId:p,usedBy:j})=>{const g=void 0!==t?Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListTitle",defaultMessage:"Filter list {filterId}",values:{filterId:t}}):Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.createFilterListTitle",defaultMessage:"Create new filter list"});let b,x,f;if(void 0===t){const e=o.i18n.translate("xpack.ml.settings.filterLists.editFilterHeader.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),t=!1===d?e:void 0,s=!0===d?[e]:void 0;b=Object(u.jsx)(n.EuiFormRow,{label:Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListIdAriaLabel",defaultMessage:"Filter list ID"}),helpText:t,error:s,isInvalid:d},Object(u.jsx)(n.EuiFieldText,{name:"new_filter_id",value:r,isInvalid:d,onChange:e=>p(e.target.value),"data-test-subj":"mlNewFilterListIdInput"}))}return x=void 0!==i&&i.length>0?Object(u.jsx)(n.EuiText,{"data-test-subj":"mlNewFilterListDescriptionText"},Object(u.jsx)("p",null,i)):Object(u.jsx)(n.EuiText,null,Object(u.jsx)(n.EuiTextColor,{color:"subdued"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.addDescriptionText",defaultMessage:"Add a description"}))),void 0!==t&&(f=void 0!==j&&j.jobs.length>0?Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)("div",{className:"ml-filter-list-usage"},Object(u.jsx)(n.EuiText,null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsUsedInJobsDescription",defaultMessage:"This filter list is used in"})),Object(u.jsx)(filter_list_usage_popover_FilterListUsagePopover,{entityType:"detector",entityValues:j.detectors}),Object(u.jsx)(n.EuiText,null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.acrossText",defaultMessage:"across"})),Object(u.jsx)(filter_list_usage_popover_FilterListUsagePopover,{entityType:"job",entityValues:j.jobs})),Object(u.jsx)(n.EuiSpacer,{size:"s"})):Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)(n.EuiText,null,Object(u.jsx)("p",null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsNotUsedInJobsDescription",defaultMessage:"This filter list is not used by any jobs."}))),Object(u.jsx)(n.EuiSpacer,{size:"s"}))),Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)(m.a,null,g),Object(u.jsx)(n.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiTextColor,{color:"subdued"},Object(u.jsx)("p",null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.totalItemsDescription",defaultMessage:"{totalItemCount, plural, one {# item} other {# items}} in total",values:{totalItemCount:s}}))))))),Object(u.jsx)(n.EuiSpacer,{size:"m"}),b,Object(u.jsx)(n.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:!1},Object(u.jsx)(n.EuiFlexItem,{grow:!1},x),Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(edit_description_popover_EditDescriptionPopover,{canCreateFilter:e,description:i,updateDescription:l}))),Object(u.jsx)(n.EuiSpacer,{size:"s"}),f)};p.displayName="EditFilterListHeader";class add_item_popover_AddItemPopover extends r.Component{constructor(e){super(e),l()(this,"onItemsTextChange",(e=>{this.setState({itemsText:e.target.value})})),l()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),l()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),l()(this,"onAddButtonClick",(()=>{const e=this.state.itemsText.split("\n"),t=[];e.forEach((e=>{-1===t.indexOf(e)&&e.length>0&&t.push(e)})),this.props.addItems(t),this.setState({isPopoverOpen:!1,itemsText:""})})),this.state={isPopoverOpen:!1,itemsText:""}}render(){const e=Object(u.jsx)(n.EuiButton,{size:"s",color:"primary",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick,isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListOpenNewItemsPopoverButton"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addItemButtonLabel",defaultMessage:"Add item"}));return Object(u.jsx)("div",null,Object(u.jsx)(n.EuiPopover,{id:"add_item_popover",panelClassName:"ml-add-filter-item-popover",ownFocus:!0,button:e,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,initialFocus:"#filter_list_add_item_input_row"},Object(u.jsx)(n.EuiForm,null,Object(u.jsx)(n.EuiFormRow,{id:"filter_list_add_item_input_row",label:Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.itemsLabel",defaultMessage:"Items"})},Object(u.jsx)(n.EuiTextArea,{value:this.state.itemsText,onChange:this.onItemsTextChange,"data-test-subj":"mlFilterListAddItemTextArea"}))),Object(u.jsx)(n.EuiText,{size:"xs"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.enterItemPerLineDescription",defaultMessage:"Enter one item per line"})),Object(u.jsx)(n.EuiSpacer,{size:"s"}),Object(u.jsx)(n.EuiFlexGroup,{justifyContent:"flexEnd"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiButton,{onClick:this.onAddButtonClick,disabled:0===this.state.itemsText.length,"data-test-subj":"mlFilterListAddItemsButton"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addButtonLabel",defaultMessage:"Add"}))))))}}function j({canCreateFilter:e,canDeleteFilter:t,onSearchChange:s,addItems:i,deleteSelectedItems:l,selectedItemCount:r}){const o=function(e,t,s,i,l){return[Object(u.jsx)(add_item_popover_AddItemPopover,{addItems:s,canCreateFilter:e,key:"add_item_btn"}),Object(u.jsx)(n.EuiButton,{color:"danger",size:"s",disabled:0===l||!1===t,onClick:i,key:"delete_item_btn","data-test-subj":"mlFilterListDeleteItemButton"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.toolbar.deleteItemButtonLabel",defaultMessage:"Delete item"}))]}(e,t,i,l,r);return Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"xl"},Object(u.jsx)(n.EuiFlexItem,null,Object(u.jsx)(n.EuiSearchBar,{toolsRight:o,onChange:s,filters:[]}))))}function g(e,t){return e===t?"check":"empty"}l()(add_item_popover_AddItemPopover,"displayName","AddItemPopover");class items_grid_pagination_ItemsGridPagination extends r.Component{constructor(e){super(e),l()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),l()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),l()(this,"onPageClick",(e=>{this.props.setActivePage(e)})),l()(this,"onChangeItemsPerPage",(e=>{this.closePopover(),this.props.setItemsPerPage(e)})),this.state={isPopoverOpen:!1}}render(){const{itemCount:e,itemsPerPage:t,itemsPerPageOptions:s,activePage:i}=this.props,l=Object(u.jsx)(n.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsPerPageButtonLabel",defaultMessage:"Items per page: {itemsPerPage}",values:{itemsPerPage:t}})),r=Math.ceil(e/t),a=s.map((e=>Object(u.jsx)(n.EuiContextMenuItem,{key:`${e} items`,icon:g(e,t),onClick:()=>{this.onChangeItemsPerPage(e)}},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsCountLabel",defaultMessage:"{pageSize} items",values:{pageSize:e}}))));return Object(u.jsx)(n.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiPopover,{id:"customizablePagination",button:l,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none"},Object(u.jsx)(n.EuiContextMenuPanel,{items:a,className:"ml-items-grid-page-size-menu"}))),Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiPagination,{pageCount:r,activePage:i,onPageClick:this.onPageClick})))}}function b({numberColumns:e,totalItemCount:t,items:s,selectedItems:i,itemsPerPage:l,itemsPerPageOptions:r,setItemsPerPage:a,setItemSelected:o,activePage:d,setActivePage:m}){if(void 0===s||0===s.length)return Object(u.jsx)(n.EuiFlexGroup,{justifyContent:"spaceAround"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiText,null,Object(u.jsx)("h4",null,0===t?Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.itemsGrid.noItemsAddedTitle",defaultMessage:"No items have been added"}):Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.itemsGrid.noMatchingItemsTitle",defaultMessage:"No matching items"})))));const p=d*l,j=s.slice(p,p+l).map(((e,t)=>Object(u.jsx)(n.EuiFlexItem,{key:`ml_grid_item_${t}`,"data-test-subj":`mlGridItem ${e}`},Object(u.jsx)(n.EuiCheckbox,{id:`ml_grid_item_${t}`,label:e,checked:i.indexOf(e)>=0,onChange:t=>{o(e,t.target.checked)},"data-test-subj":"mlGridItemCheckbox"}))));return Object(u.jsx)("div",null,Object(u.jsx)(n.EuiFlexGrid,{columns:e,className:"eui-textBreakWord",gutterSize:"m"},j),Object(u.jsx)(items_grid_pagination_ItemsGridPagination,{itemCount:s.length,itemsPerPage:l,itemsPerPageOptions:r,setItemsPerPage:a,activePage:d,setActivePage:m}))}b.defaultProps={numberColumns:4,itemsPerPage:50,itemsPerPageOptions:[50,100,500,1e3]};var x=s(17),f=s(123),h=s(11);var F=s(71),O=s(1),L=s(142);function v(e,t){if(void 0===t)return[];if(void 0===e)return[...t];const s=t.map((e=>({value:e})));return n.EuiSearchBar.Query.execute(e,s,{defaultFields:["value"]}).map((e=>e.value))}function I(e,t,s){let i=e;return t*e>s&&(i=Math.max(Math.ceil(s/t)-1,0)),i}class edit_filter_list_EditFilterListUI extends r.Component{constructor(e){super(e),l()(this,"returnToFiltersList",(async()=>{const{services:{http:{basePath:e},application:{navigateToUrl:t}}}=this.props.kibana;await t(`${e.get()}/app/ml/${O.b.FILTER_LISTS_MANAGE}`,!0)})),l()(this,"loadFilterList",(e=>{h.ml.filters.filters({filterId:e}).then((e=>{this.setLoadedFilterState(e)})).catch((t=>{this.toastNotificationService.displayErrorToast(t,o.i18n.translate("xpack.ml.settings.filterLists.editFilterList.loadingDetailsOfFilterErrorMessage",{defaultMessage:"An error occurred loading details of filter {filterId}",values:{filterId:e}}))}))})),l()(this,"setLoadedFilterState",(e=>{this.setState((t=>{const{itemsPerPage:s,searchQuery:i}=t,l=v(i,e.items),r=I(t.activePage,s,l.length);return{description:e.description,items:void 0!==e.items?[...e.items]:[],matchingItems:l,selectedItems:[],loadedFilter:e,isNewFilterIdInvalid:!1,activePage:r,searchQuery:i,saveInProgress:!1}}))})),l()(this,"updateNewFilterId",(e=>{var t;this.setState({newFilterId:e,isNewFilterIdInvalid:(t=e,!(void 0!==t&&t.length>0&&Object(f.l)(t)))})})),l()(this,"updateDescription",(e=>{this.setState({description:e})})),l()(this,"addItems",(e=>{this.setState((t=>{const{itemsPerPage:s,searchQuery:i}=t,l=[...t.items],r=[];if(e.forEach((e=>{-1===l.indexOf(e)?l.push(e):r.push(e)})),l.sort(((e,t)=>e.localeCompare(t))),r.length>0){const{toasts:e}=this.props.kibana.services.notifications;e.addWarning(o.i18n.translate("xpack.ml.settings.filterLists.editFilterList.duplicatedItemsInFilterListWarningMessage",{defaultMessage:"The following items were already in the filter list: {alreadyInFilter}",values:{alreadyInFilter:r}}))}const a=v(i,l),n=I(t.activePage,s,a.length);return{items:l,matchingItems:a,activePage:n,searchQuery:i}}))})),l()(this,"deleteSelectedItems",(()=>{this.setState((e=>{const{selectedItems:t,itemsPerPage:s,searchQuery:i}=e,l=[...e.items];t.forEach((e=>{const t=l.indexOf(e);-1!==t&&l.splice(t,1)}));const r=v(i,l),a=I(e.activePage,s,r.length);return{items:l,matchingItems:r,selectedItems:[],activePage:a,searchQuery:i}}))})),l()(this,"onSearchChange",(({query:e})=>{this.setState((t=>{const{items:s,itemsPerPage:i}=t,l=v(e,s);return{matchingItems:l,activePage:I(t.activePage,i,l.length),searchQuery:e}}))})),l()(this,"setItemSelected",((e,t)=>{this.setState((s=>{const i=[...s.selectedItems],l=i.indexOf(e);return!0===t&&-1===l?i.push(e):!1===t&&-1!==l&&i.splice(l,1),{selectedItems:i}}))})),l()(this,"setActivePage",(e=>{this.setState({activePage:e})})),l()(this,"setItemsPerPage",(e=>{this.setState({itemsPerPage:e,activePage:0})})),l()(this,"save",(()=>{this.setState({saveInProgress:!0});const{loadedFilter:e,newFilterId:t,description:s,items:i}=this.state,l=void 0!==this.props.filterId?this.props.filterId:t;(function(e,t,s,i){return new Promise(((l,r)=>{void 0===i||void 0===i.filter_id?function(e,t,s){const i=o.i18n.translate("xpack.ml.settings.filterLists.filterWithIdExistsErrorMessage",{defaultMessage:"A filter with id {filterId} already exists",values:{filterId:e}});return new Promise(((l,r)=>{h.ml.filters.filtersStats().then((a=>{-1===a.map((e=>e.filter_id)).indexOf(e)?h.ml.filters.addFilter(e,t,s).then((e=>{l(e)})).catch((e=>{r(e)})):(Object(x.f)().addDanger(i),r(new Error(i)))})).catch((e=>{r(e)}))}))}(e,t,s).then((e=>{l(e)})).catch((e=>{r(e)})):function(e,t,s){return new Promise(((i,l)=>{const r=e.items,a=s.filter((e=>!1===r.includes(e))),n=r.filter((e=>!1===s.includes(e)));h.ml.filters.updateFilter(e.filter_id,t,a,n).then((e=>{i(e)})).catch((e=>{l(e)}))}))}(i,t,s).then((e=>{l(e)})).catch((e=>{r(e)}))}))})(l,s,i,e).then((e=>{this.setLoadedFilterState(e),this.returnToFiltersList()})).catch((e=>{this.toastNotificationService.displayErrorToast(e,o.i18n.translate("xpack.ml.settings.filterLists.editFilterList.savingFilterErrorMessage",{defaultMessage:"An error occurred saving filter {filterId}",values:{filterId:l}})),this.setState({saveInProgress:!1})}))})),this.state={description:"",items:[],matchingItems:[],selectedItems:[],loadedFilter:{},newFilterId:"",isNewFilterIdInvalid:!0,activePage:0,itemsPerPage:50,saveInProgress:!1}}componentDidMount(){this.toastNotificationService=Object(F.toastNotificationServiceProvider)(this.props.kibana.services.notifications.toasts);const e=this.props.filterId;void 0!==e?this.loadFilterList(e):this.setState({newFilterId:""})}render(){const{loadedFilter:e,newFilterId:t,isNewFilterIdInvalid:s,description:i,items:l,matchingItems:r,selectedItems:o,itemsPerPage:d,activePage:m,saveInProgress:g}=this.state,{canCreateFilter:f,canDeleteFilter:h}=this.props,F=void 0!==l?l.length:0,O=Object(x.c)().links.ml.customRules;return Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)("div",{"data-test-subj":"mlPageFilterListEdit"},Object(u.jsx)(p,{canCreateFilter:f,filterId:this.props.filterId,newFilterId:t,isNewFilterIdInvalid:s,updateNewFilterId:this.updateNewFilterId,description:i,updateDescription:this.updateDescription,totalItemCount:F,usedBy:e.used_by}),Object(u.jsx)(j,{canCreateFilter:f,canDeleteFilter:h,onSearchChange:this.onSearchChange,addItems:this.addItems,deleteSelectedItems:this.deleteSelectedItems,selectedItemCount:o.length}),Object(u.jsx)(n.EuiSpacer,{size:"xl"}),Object(u.jsx)(b,{totalItemCount:F,items:r,selectedItems:o,itemsPerPage:d,setItemsPerPage:this.setItemsPerPage,setItemSelected:this.setItemSelected,activePage:m,setActivePage:this.setActivePage}),Object(u.jsx)(n.EuiFlexGroup,{justifyContent:"flexEnd"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiButtonEmpty,{"data-test-subj":"mlFilterListCancelButton",onClick:()=>this.returnToFiltersList()},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiButton,{onClick:this.save,disabled:!0===g||!0===s||!1===f,fill:!0,"data-test-subj":"mlFilterListSaveButton"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.saveButtonLabel",defaultMessage:"Save"}))))),Object(u.jsx)(L.a,{docLink:O}))}}l()(edit_filter_list_EditFilterListUI,"displayName","EditFilterList");const P=Object(d.withKibana)(edit_filter_list_EditFilterListUI),_=Object(d.withKibana)((function({totalCount:e,refreshFilterLists:t,kibana:s}){const i=s.services.docLinks.links.ml.customRules;return Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)(m.a,null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsTitle",defaultMessage:"Filter Lists"})),Object(u.jsx)(n.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiTextColor,{color:"subdued"},Object(u.jsx)("p",null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsDescription",defaultMessage:"{totalCount} in total",values:{totalCount:e}})))))),Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:()=>t(),"data-test-subj":"mlFilterListRefreshButton"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),Object(u.jsx)(n.EuiSpacer,{size:"m"}),Object(u.jsx)(n.EuiText,null,Object(u.jsx)("p",null,Object(u.jsx)(n.EuiTextColor,{color:"subdued"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis.\nYou can use the same filter list in multiple jobs.{br}{learnMoreLink}",values:{br:Object(u.jsx)("br",null),learnMoreLink:Object(u.jsx)(n.EuiLink,{href:i,target:"_blank"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),Object(u.jsx)(n.EuiSpacer,{size:"m"}))}));var E=s(210),C=s.n(E),M=s(22);class delete_filter_list_modal_DeleteFilterListModal extends r.Component{constructor(e){super(e),l()(this,"closeModal",(()=>{this.setState({isModalVisible:!1})})),l()(this,"showModal",(()=>{this.setState({isModalVisible:!0})})),l()(this,"onConfirmDelete",(()=>{this.doDelete()})),this.state={isModalVisible:!1}}async doDelete(){const{selectedFilterLists:e,refreshFilterLists:t}=this.props;await async function(e){if(void 0===e||0===e.length)return;const t=Object(x.f)();t.add(o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingNotificationMessage",{defaultMessage:"Deleting {filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}}",values:{filterListsToDeleteLength:e.length,filterListToDeleteId:!!e.length&&e[0].filter_id}}));for(const s of e){const e=s.filter_id;try{await h.ml.filters.deleteFilter(e)}catch(e){console.log("Error deleting filter list:",e),t.addDanger(o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingErrorMessage",{defaultMessage:"An error occurred deleting filter list {filterListId}{respMessage}",values:{filterListId:s.filter_id,respMessage:e.message?` : ${e.message}`:""}}))}}t.addSuccess(o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.filtersSuccessfullyDeletedNotificationMessage",{defaultMessage:"{filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}} deleted",values:{filterListsToDeleteLength:e.length,filterListToDeleteId:!!e.length&&e[0].filter_id}}))}(e),t(),this.closeModal()}render(){const{selectedFilterLists:e,canDeleteFilter:t}=this.props;let s;return this.state.isModalVisible&&(s=Object(u.jsx)(n.EuiConfirmModal,{title:o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterListModal.modalTitle",{defaultMessage:"Delete {selectedFilterListsLength, plural, one {{selectedFilterId}} other {# filter lists}}?",values:{selectedFilterListsLength:e.length,selectedFilterId:!!e.length&&e[0].filter_id}}),className:"eui-textBreakWord",onCancel:this.closeModal,onConfirm:this.onConfirmDelete,cancelButtonText:o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterListModal.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterListModal.confirmButtonLabel",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:n.EUI_MODAL_CONFIRM_BUTTON,"data-test-subj":"mlFilterListDeleteConfirmation"})),Object(u.jsx)("div",null,Object(u.jsx)(n.EuiButton,{key:"delete_filter_list",iconType:"trash",color:"danger",onClick:this.showModal,isDisabled:void 0===e||0===e.length||!1===t,"data-test-subj":"mlFilterListsDeleteButton"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteButtonLabel",defaultMessage:"Delete"})),s)}}l()(delete_filter_list_modal_DeleteFilterListModal,"displayName","DeleteFilterListModal");var k=s(34);function y({usedBy:e}){let t;return t=void 0!==e&&e.jobs.length>0?Object(u.jsx)(n.EuiIcon,{type:"check","aria-label":o.i18n.translate("xpack.ml.settings.filterLists.table.inUseAriaLabel",{defaultMessage:"In use"}),"data-test-subj":"mlFilterListUsedByIcon inUse"}):Object(u.jsx)(n.EuiIcon,{type:"cross","aria-label":o.i18n.translate("xpack.ml.settings.filterLists.table.notInUseAriaLabel",{defaultMessage:"Not in use"}),"data-test-subj":"mlFilterListUsedByIcon notInUse"}),t}function w({canCreateFilter:e}){const t=Object(k.a)(O.b.FILTER_LISTS_NEW);return Object(u.jsx)(n.EuiButton,{key:"new_filter_list",onClick:t,isDisabled:!1===e,"data-test-subj":"mlFilterListsButtonCreate"},Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.newButtonLabel",defaultMessage:"New"}))}function S(e,t,s,i){return[Object(u.jsx)(w,{key:"new_filter_list",canCreateFilter:e}),Object(u.jsx)(delete_filter_list_modal_DeleteFilterListModal,{key:"delete_filter_list",canDeleteFilter:t,selectedFilterLists:s,refreshFilterLists:i})]}function T({canCreateFilter:e,canDeleteFilter:t,filterLists:s,selectedFilterLists:i,setSelectedFilterLists:l,refreshFilterLists:r}){const d={toolsRight:S(e,t,i,r),box:{incremental:!0},filters:[]},m={selectable:e=>void 0===e.used_by||0===e.used_by.jobs.length,selectableMessage:()=>{},onSelectionChange:e=>l(e)};return Object(u.jsx)(a.a.Fragment,null,void 0===s||0===s.length?Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)(n.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(w,null))),Object(u.jsx)(n.EuiSpacer,{size:"l"}),Object(u.jsx)(n.EuiFlexGroup,{justifyContent:"spaceAround"},Object(u.jsx)(n.EuiFlexItem,{grow:!1},Object(u.jsx)(n.EuiText,null,Object(u.jsx)("h4",null,Object(u.jsx)(c.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.noFiltersCreatedTitle",defaultMessage:"No filters have been created"})))))):Object(u.jsx)("div",{"data-test-subj":"mlFilterListTableContainer"},Object(u.jsx)(n.EuiInMemoryTable,{className:"ml-filter-lists-table",items:s,itemId:"filter_id",columns:[{field:"filter_id",name:o.i18n.translate("xpack.ml.settings.filterLists.table.idColumnName",{defaultMessage:"ID"}),render:e=>Object(u.jsx)(M.Link,{to:`/${O.b.FILTER_LISTS_EDIT}/${e}`,"data-test-subj":"mlEditFilterListLink"},e),sortable:!0,scope:"row","data-test-subj":"mlFilterListColumnId"},{field:"description",name:o.i18n.translate("xpack.ml.settings.filterLists.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:!0,"data-test-subj":"mlFilterListColumnDescription"},{field:"item_count",name:o.i18n.translate("xpack.ml.settings.filterLists.table.itemCountColumnName",{defaultMessage:"Item count"}),sortable:!0,"data-test-subj":"mlFilterListColumnItemCount"},{field:"used_by",name:o.i18n.translate("xpack.ml.settings.filterLists.table.inUseColumnName",{defaultMessage:"In use"}),render:e=>Object(u.jsx)(y,{usedBy:e}),sortable:!0,"data-test-subj":"mlFilterListColumnInUse"}],search:d,pagination:!0,sorting:{sort:{field:"filter_id",direction:"asc"}},selection:m,"data-test-subj":"mlFilterListsTable",rowProps:e=>({"data-test-subj":`mlFilterListRow row-${e.filter_id}`})})))}y.propTypes={usedBy:C.a.object},y.displayName="UsedByIcon";class filter_lists_FilterListsUI extends r.Component{constructor(e){super(e),l()(this,"setFilterLists",(e=>{this.setState((t=>{const s=e.map((e=>e.filter_id)),i=t.selectedFilterLists.filter((e=>-1!==s.indexOf(e.filter_id)));return{filterLists:e,selectedFilterLists:i}}))})),l()(this,"setSelectedFilterLists",(e=>{this.setState({selectedFilterLists:e})})),l()(this,"refreshFilterLists",(()=>{h.ml.filters.filtersStats().then((e=>{this.setFilterLists(e)})).catch((e=>{console.log("Error loading list of filters:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.settings.filterLists.filterLists.loadingFilterListsErrorMessage",{defaultMessage:"An error occurred loading the filter lists"})),Object(F.toastNotificationServiceProvider)(t).displayErrorToast(e,o.i18n.translate("xpack.ml.settings.filterLists.filterLists.loadingFilterListsErrorMessage",{defaultMessage:"An error occurred loading the filter lists"}))}))})),this.state={filterLists:[],selectedFilterLists:[]}}componentDidMount(){this.refreshFilterLists()}render(){const{filterLists:e,selectedFilterLists:t}=this.state,{canCreateFilter:s,canDeleteFilter:i}=this.props,l=Object(x.c)().links.ml.customRules;return Object(u.jsx)(a.a.Fragment,null,Object(u.jsx)("div",{"data-test-subj":"mlPageFilterListManagement"},Object(u.jsx)(_,{totalCount:e.length,refreshFilterLists:this.refreshFilterLists}),Object(u.jsx)(T,{canCreateFilter:s,canDeleteFilter:i,filterLists:e,selectedFilterLists:t,setSelectedFilterLists:this.setSelectedFilterLists,refreshFilterLists:this.refreshFilterLists})),Object(u.jsx)(L.a,{docLink:l}))}}l()(filter_lists_FilterListsUI,"displayName","FilterLists");const D=Object(d.withKibana)(filter_lists_FilterListsUI)}}]);