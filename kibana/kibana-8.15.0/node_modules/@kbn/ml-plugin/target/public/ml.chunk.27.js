/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[27],{203:function(e,t,a){"use strict";function i(e){let t=0,a=0;if(0===e.length)return t;for(let i=0;i<e.length;i++)a=e.charCodeAt(i),t=(t<<5)-t+a,t|=0;return t<0?-2*t:t}a.d(t,"a",(function(){return i}))},316:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return P}));var i=a(2),s=a.n(i),n=a(414);const l=(e,t,a,s="")=>Object(i.useMemo)((()=>{const i=[];return void 0===e||void 0===t?i:(t.length>1?i.push(...t.filter((t=>e.fields.some((e=>e.name===t&&"number"===e.type))))):i.push(...e.fields.filter((t=>"number"===t.type&&!e.metaFields.includes(t.name)&&!t.name.startsWith(`${s}.`)&&t.name!==n.e)).map((e=>e.name))),Array.isArray(a)&&a.length>0?i.filter((e=>!a.includes(e))):i)}),[e,t,a]);var o=a(25),r=a(31),c=a.n(r),u=a(5),d=a(203),m=a(322),p=a(837),b=a(423),g=a(229),j=a(10),f=a(507),h=a(367),x=a(352);const y="outlier_score",O="user_selection",v="single_point_click",C="#bbb",S=(Object(o.euiPaletteRed)(2)[1],Object(o.euiPaletteColorBlind)()[2],[Object(o.euiPaletteColorBlind)()[1],Object(o.euiPaletteColorBlind)()[2]]),E=Object(o.euiPaletteColorBlind)({rotations:2}),T=Object(o.euiPaletteGreen)(5),k="fields",_=(e,t,a,i,s,n,l,o,r)=>{const c=n?{selection:{[O]:{type:"interval"},[v]:{type:"single"},mlOutlierScoreThreshold:{type:"single",fields:["cutoff"],bind:{input:"range",max:1,min:0,name:u.i18n.translate("xpack.ml.splomSpec.outlierScoreThresholdName",{defaultMessage:"Outlier score threshold: "}),step:.01},init:{cutoff:.99}}}}:{selection:{[O]:{type:"interval"},[v]:{type:"single",empty:"none"}}};return{...e?{}:{data:{values:[...a]}},mark:{...n&&l?{type:"circle",strokeWidth:1.2,strokeOpacity:.75,fillOpacity:.1}:{type:"circle",opacity:.75,size:8}},...n?{transform:[{calculate:`datum${e?`.${k}`:""}['${s}'] >= mlOutlierScoreThreshold.cutoff`,as:"is_outlier"}]}:{},encoding:{color:t?{value:C}:i,opacity:{condition:{selection:O,value:.8},value:.5},...l?{stroke:i,opacity:{condition:{value:1,test:`(datum${e?`.${k}`:""}['${s}'] >= mlOutlierScoreThreshold.cutoff)`},value:.5}}:{},...n?{order:{field:`${e?`${k}.`:""}${s}`},size:{...l?{type:x.a.QUANTITATIVE,field:`${e?`${k}.`:""}${s}`,scale:{type:"linear",range:[8,200],domain:[0,1]}}:{condition:{value:40,test:`(datum${e?`.${k}`:""}['${s}'] >= mlOutlierScoreThreshold.cutoff)`},value:8}}}:{},x:{type:x.a.QUANTITATIVE,field:{repeat:"column"},scale:{zero:!1}},y:{type:x.a.QUANTITATIVE,field:{repeat:"row"},scale:{zero:!1}},tooltip:[...void 0!==r?[{type:i.condition.type,field:`${e?`${k}.`:""}${M(r)}`}]:[],...o.map((e=>({type:x.a.QUANTITATIVE,field:e}))),...n?[{type:x.a.QUANTITATIVE,field:`${e?`${k}.`:""}${s}`,format:".3f"}]:[]]},...t?{}:c,...e?{}:{width:125},...e?{}:{height:125}}};function M(e,t=""){return`${t}${e.replace(/([\.|\[|\]])/g,"\\$1")}`}const w=(e,t,a,i,s,n,l,o,r)=>{const c=t,u=i.map((t=>M(t,e?"fields.":""))),d=void 0!==n,m=`${n}\\.${y}`,p=((e,t,a,i,s)=>"string"==typeof a?{condition:{selection:O,field:M(null!=="is_outlier"?"is_outlier":"00FF00"),type:x.a.NOMINAL,scale:{range:S}},value:C}:void 0!==i&&void 0!==s?{condition:{selection:O,field:`${e?`${k}.`:""}${M(null!=i?i:"00FF00")}${e?"[0]":""}`,type:s,scale:{range:s===x.a.NOMINAL?E:T}},value:C}:{condition:[{selection:O},{selection:v}],value:C})(e,0,n&&m,l,o),b={$schema:"https://vega.github.io/schema/vega-lite/v4.17.0.json",background:"transparent",view:{fill:"transparent",stroke:s.euiColorLightestShade},padding:10,config:{axis:{domainColor:s.euiColorLightShade,gridColor:s.euiColorLightestShade,tickColor:s.euiColorLightestShade,labelColor:s.euiTextSubduedColor,titleColor:s.euiTextSubduedColor},legend:{orient:"right",labelColor:s.euiTextSubduedColor,titleColor:s.euiTextSubduedColor}},repeat:{column:u,row:u.slice().reverse()},spec:{layer:[_(e,!1,c,p,m,d,!!r,u,l)]}};return a.length&&b.spec.layer.unshift(_(e,!0,a,p,m,d,!!r,u,l)),b};a(748);var I=a(6);const $=u.i18n.translate("xpack.ml.splom.toggleOn",{defaultMessage:"On"}),z=u.i18n.translate("xpack.ml.splom.toggleOff",{defaultMessage:"Off"}),q=[100,1e3,1e4].map((e=>({value:e,text:""+e}))),F=({label:e,tooltip:t})=>Object(I.jsx)(s.a.Fragment,null,e,Object(I.jsx)(o.EuiIconTip,{content:t,iconProps:{className:"eui-alignTop"},size:"s"}));function D(e,t){var a;return null!==(a=e.map((e=>{var a;return Object(g.l)(null!==(a=e.fields)&&void 0!==a?a:{},(e=>e.startsWith(`${t}.feature_importance`)))})).filter((e=>!Object.keys(e).some((t=>Array.isArray(e[t]))))))&&void 0!==a?a:[]}const P=({fields:e,index:t,resultsField:a,color:n,legendType:l,searchQuery:r,runtimeMappings:g,dataView:x,query:O})=>{const{esSearch:v}=Object(j.c)(),C=Object(j.d)(),{services:{application:S,data:E}}=C,[T,k]=Object(i.useState)(!1),[_,M]=Object(i.useState)([]);Object(i.useEffect)((()=>{const t=e.length>4?e.slice(0,4):e;M(t)}),[e]);const[P,A]=Object(i.useState)(1e3),[G,N]=Object(i.useState)(!1),[L,B]=Object(i.useState)(!1),[R,W]=Object(i.useState)(),{euiTheme:V}=Object(j.a)(),Q=Object(i.useMemo)((()=>e.map((e=>({label:e})))),[e]),H=Object(i.useCallback)((()=>{const{columns:e}=R,i=void 0!==a?`${a}.${y}`:void 0,s=w(!0,[],[],e,V,a,n,l,T);s.$schema="https://vega.github.io/schema/vega-lite/v5.json",s.title=`Scatterplot matrix for ${t}`;const o=[...e,...i?[i]:[],...n?[n]:[]];return s.data={url:{"%context%":!0,...null!=x&&x.timeFieldName?{"%timefield%":`${null==x?void 0:x.timeFieldName}`}:{},index:t,body:{fields:o,size:P,_source:!1}},format:{property:"hits.hits"}},{path:`/create?type=vega&_g=${encodeURIComponent(c.a.encode({filters:E.query.filterManager.getFilters(),refreshInterval:E.query.timefilter.timefilter.getRefreshInterval(),time:E.query.timefilter.timefilter.getTime()}))}&_a=${encodeURIComponent(c.a.encode({filters:[],linked:!1,query:O,uiState:{},vis:{aggs:[],params:{spec:JSON.stringify(s,null,2)}}}))}`}}),[R]);Object(i.useEffect)((()=>{if(0===_.length)return W({columns:[],items:[],backgroundItems:[],messages:[]}),void B(!1);const e={didCancel:!1};return async function(e){B(!0);const i=[];try{const l=`${a}.${y}`,o=void 0!==a,c=[..._,...void 0!==n?[n]:[],...o?[l]:[]],d=G?{function_score:{query:r,random_score:{seed:10,field:"_seq_no"}}}:r;let m;r&&(r.match_all&&Object.keys(r.match_all).length>0||r.bool&&Object.keys(r.bool).length>0)&&(m=G?{function_score:{query:{bool:{must_not:[r]}},random_score:{seed:10,field:"_seq_no"}}}:{bool:{must_not:[r]}});const j=x&&Object(p.a)(x,g),f={fields:c,_source:!1,query:d,from:0,size:P,...Object(b.a)(j)?{runtime_mappings:j}:{}},h=[v({index:t,body:f})];m&&h.push(v({index:t,body:{...f,query:m}}));const[O,C]=await Promise.all(h);if(!e.didCancel){var s;const e=D(O.hits.hits,a),t=D(null!==(s=null==C?void 0:C.hits.hits)&&void 0!==s?s:[],a),n=O.hits.hits.length,l=n-e.length;n===l?i.push(u.i18n.translate("xpack.ml.splom.allDocsFilteredWarningMessage",{defaultMessage:"All fetched documents included fields with arrays of values and cannot be visualized."})):O.hits.hits.length!==e.length&&i.push(u.i18n.translate("xpack.ml.splom.arrayFieldsWarningMessage",{defaultMessage:"{filteredDocsCount} out of {originalDocsCount} fetched documents include fields with arrays of values and cannot be visualized.",values:{originalDocsCount:n,filteredDocsCount:l}})),W({columns:_,items:e,backgroundItems:t,messages:i}),B(!1)}}catch(e){B(!1),W({columns:[],items:[],backgroundItems:[],messages:[Object(m.a)(e)]})}}(e),()=>{e.didCancel=!0}}),[P,JSON.stringify({fields:_,searchQuery:r}),t,G,a]);const U=Object(i.useMemo)((()=>{if(void 0===R)return;const{items:e,backgroundItems:t,columns:i}=R;return w(!1,e,t,i,V,a,n,l,T)}),[a,R,n,l,T]);return Object(I.jsx)(s.a.Fragment,null,void 0===R||void 0===U?Object(I.jsx)(h.a,null):Object(I.jsx)("div",{"data-test-subj":"mlScatterplotMatrix "+(L?"loading":"loaded"),className:"mlScatterplotMatrix"},Object(I.jsx)(o.EuiFlexGroup,null,Object(I.jsx)(o.EuiFlexItem,null,Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(F,{label:u.i18n.translate("xpack.ml.splom.fieldSelectionLabel",{defaultMessage:"Fields"}),tooltip:u.i18n.translate("xpack.ml.splom.fieldSelectionInfoTooltip",{defaultMessage:"Pick fields to explore their relationships."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(o.EuiComboBox,{compressed:!0,fullWidth:!0,placeholder:u.i18n.translate("xpack.ml.splom.fieldSelectionPlaceholder",{defaultMessage:"Select fields"}),options:Q,selectedOptions:_.map((e=>({label:e}))),onChange:e=>{M(e.map((e=>e.label)))},isClearable:!0,"data-test-subj":"mlScatterplotMatrixFieldsComboBox"}))),Object(I.jsx)(o.EuiFlexItem,{style:{width:"200px"},grow:!1},Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(F,{label:u.i18n.translate("xpack.ml.splom.sampleSizeLabel",{defaultMessage:"Sample size"}),tooltip:u.i18n.translate("xpack.ml.splom.sampleSizeInfoTooltip",{defaultMessage:"Amount of documents to display in the scatterplot matrix."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(o.EuiSelect,{"data-test-subj":"mlScatterplotMatrixSampleSizeSelect",compressed:!0,options:q,value:P,onChange:e=>{A(Math.min(Math.max(parseInt(e.target.value,10),1),1e4))}}))),Object(I.jsx)(o.EuiFlexItem,{style:{width:"120px"},grow:!1},Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(F,{label:u.i18n.translate("xpack.ml.splom.randomScoringLabel",{defaultMessage:"Random scoring"}),tooltip:u.i18n.translate("xpack.ml.splom.randomScoringInfoTooltip",{defaultMessage:"Uses a function score query to get randomly selected documents as the sample."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(o.EuiSwitch,{"data-test-subj":"mlScatterplotMatrixRandomizeQuerySwitch",name:"mlScatterplotMatrixRandomizeQuery",label:G?$:z,checked:G,onChange:()=>{N(!G)},disabled:L}))),void 0!==a&&void 0===l&&Object(I.jsx)(o.EuiFlexItem,{style:{width:"120px"},grow:!1},Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(F,{label:u.i18n.translate("xpack.ml.splom.dynamicSizeLabel",{defaultMessage:"Dynamic size"}),tooltip:u.i18n.translate("xpack.ml.splom.dynamicSizeInfoTooltip",{defaultMessage:"Scales the size of each point by its outlier score."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(o.EuiSwitch,{name:"mlScatterplotMatrixDynamicSize",label:T?$:z,checked:T,onChange:()=>{k(!T)},disabled:L}))),R?Object(I.jsx)(o.EuiFlexItem,{grow:!1},Object(I.jsx)(o.EuiLink,{onClick:async()=>{const e=H();await S.navigateToApp("visualize#",{path:e.path,openInNewTab:!1})},"data-test-subj":"mlSplomExploreInCustomVisualizationLink"},Object(I.jsx)(o.EuiIconTip,{content:u.i18n.translate("xpack.ml.splom.exploreInCustomVisualizationLabel",{defaultMessage:"Explore scatterplot charts in Vega based custom visualization"}),type:"visVega",size:"l"}))):null),R.messages.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(o.EuiSpacer,{size:"m"}),Object(I.jsx)(o.EuiCallOut,{color:"warning"},R.messages.map((e=>Object(I.jsx)("span",{key:Object(d.a)(e)},e,Object(I.jsx)("br",null)))))),R.items.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(f.a,{vegaSpec:U}),R.backgroundItems.length?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(o.EuiSpacer,{size:"s"}),Object(I.jsx)(o.EuiFormRow,{fullWidth:!0,helpText:u.i18n.translate("xpack.ml.splom.backgroundLayerHelpText",{defaultMessage:"If the data points match your filter, they're shown in color; otherwise, they're blurred gray."})},Object(I.jsx)(s.a.Fragment,null))):null)))}},367:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a(2);var i=a(25),s=a(6);const n=()=>Object(s.jsx)(i.EuiText,{textAlign:"center"},Object(s.jsx)(i.EuiSpacer,{size:"l"}),Object(s.jsx)(i.EuiLoadingSpinner,{size:"l"}),Object(s.jsx)(i.EuiSpacer,{size:"l"}))},405:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(2),s=a(8),n=a(25),l=a(5),o=a(75),r=a(247),c=a(0),u=a(139),d=a(10),m=a(6);const p=({dataView:e,setSearchQuery:t,filters:a,query:p})=>{const[b,g]=Object(i.useState)(p),[j,f]=Object(i.useState)({}),[h,x]=Object(i.useState)(void 0),{services:y}=Object(d.d)(),{unifiedSearch:{ui:{QueryStringInput:O}}}=y,v=Object(i.useMemo)((()=>new RegExp(`${null==a?void 0:a.columnId}\\s*:\\s*(true|false)`,"g")),[null==a?void 0:a.columnId]);Object(i.useEffect)((function(){if(void 0!==a){const e=p.query.match(v);let t;null!==e&&e[0].includes("true")?t=Object.keys(a.key).find((e=>!0===a.key[e])):null!==e&&e[0].includes("false")&&(t=Object.keys(a.key).find((e=>!1===a.key[e]))),t&&f({[t]:!0})}}),[]),Object(i.useEffect)((()=>{try{let a={};switch(p.language){case r.a.KUERY:a=Object(o.toElasticsearchQuery)(Object(o.fromKueryExpression)(p.query),e);break;case r.a.LUCENE:a=Object(o.luceneStringToDsl)(p.query);break;default:return void x({query:p.query,message:l.i18n.translate("xpack.ml.queryBar.queryLanguageNotSupported",{defaultMessage:"Query language is not supported"})})}t({queryString:p.query,query:a,language:p.language})}catch(e){x({query:p.query,message:e.message})}}),[p.query]);const C=(e,a)=>{void 0===a&&f({}),t({queryString:e.query,language:e.language})},S=Object(s.debounce)(((e,t)=>{let i="";const s=null==a?void 0:a.key[e],n=`${null==a?void 0:a.columnId}:${s}`;!1===t[e]?i=""!==b.query?Object(u.q)(b.query,null==a?void 0:a.columnId,String(s)):"":!0===t[e]&&(i=""===b.query?n:null!==b.query.match(v)?b.query.replace(v,n):`${b.query} and ${n}`);const l={...b,query:i};g(l),C(l,!0)}),200);return Object(m.jsx)(n.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>x(void 0),input:Object(m.jsx)(n.EuiFlexGroup,{alignItems:"center"},Object(m.jsx)(n.EuiFlexItem,null,Object(m.jsx)(O,{bubbleSubmitEvent:!1,query:b,indexPatterns:[e],onChange:e=>g(e),onSubmit:C,placeholder:b.language===r.a.KUERY?l.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderKql",{defaultMessage:"Search for e.g. {example}",values:{example:'method : "GET" or status : "404"'}}):l.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderLucene",{defaultMessage:"Search for e.g. {example}",values:{example:"method:GET OR status:404"}}),disableAutoFocus:!0,dataTestSubj:"mlDFAnalyticsQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown",appName:c.g})),a&&a.options&&Object(m.jsx)(n.EuiFlexItem,{grow:!1,"data-test-subj":"mlDFAnalyticsExplorationQueryBarFilterButtons"},Object(m.jsx)(n.EuiButtonGroup,{legend:l.i18n.translate("xpack.ml.dataframe.analytics.explorationQueryBar.buttonGroupLegend",{defaultMessage:"Analytics query bar filter buttons"}),options:a.options,type:"multi",idToSelectedMap:j,onChange:e=>{const t={[e]:!j[e]};f(t),S(e,t)}}))),isOpen:(null==h?void 0:h.query)===b.query&&""!==(null==h?void 0:h.message)},Object(m.jsx)(n.EuiCode,null,l.i18n.translate("xpack.ml.stepDefineForm.invalidQuery",{defaultMessage:"Invalid Query"}),": ",null==h?void 0:h.message.split("\n")[0]))}},407:function(e,t,a){"use strict";a.d(t,"a",(function(){return data_loader_DataLoader}));var i=a(4),s=a.n(i),n=a(840),l=a(520),o=a(11);class data_loader_DataLoader{constructor(e,t){s()(this,"_indexPattern",void 0),s()(this,"_runtimeMappings",void 0),s()(this,"_indexPatternTitle",""),s()(this,"_maxExamples",10),this._indexPattern=e,this._runtimeMappings=this._indexPattern.getComputedFields().runtimeFields,this._indexPatternTitle=e.title}async loadFieldHistograms(e,t,a=n.a,i){return await o.ml.getVisualizerFieldHistograms({indexPattern:this._indexPatternTitle,query:t,fields:e,samplerShardSize:a,runtimeMappings:i||this._runtimeMappings})}set maxExamples(e){this._maxExamples=e}get maxExamples(){return this._maxExamples}isDisplayField(e){return!l.c.includes(e)}}},484:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return l}));var i=a(37);const s=e=>Object(i.a)(e,["data","id","interval","stats","type"])&&"numeric"===e.type,n=e=>Object(i.a)(e,["data","cardinality","id","type"])&&("ordinal"===e.type||"boolean"===e.type),l=e=>Object(i.a)(e,["type"])&&"unsupported"===e.type},507:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(2),s=a.n(i),n=a(25),l=a(367),o=a(6);const r=s.a.lazy((()=>a.e(65).then(a.bind(null,854)))),c=e=>Object(o.jsx)(n.EuiErrorBoundary,null,Object(o.jsx)(i.Suspense,{fallback:Object(o.jsx)(l.a,null)},Object(o.jsx)(r,e)))},748:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(749);case"v8light":return a(751)}},749:function(e,t,a){var i=a(126),s=a(750);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},750:function(e,t,a){(t=a(127)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}",""]),e.exports=t},751:function(e,t,a){var i=a(126),s=a(752);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},752:function(e,t,a){(t=a(127)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}",""]),e.exports=t},757:function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return v}));var i=a(39),s=a.n(i),n=a(7),l=(a(2),a(6)),o=a(26),r=a.n(o),c=a(25),u=a(33),d=a(5),m=a(131),p=a(484),b=a(229);const g=Object(l.css)({width:"100%",minWidth:`calc(${u.euiThemeVars.euiSize} * 7)`},"",""),j={name:"1azakc",styles:"text-align:center"},f=new n.BehaviorSubject(null),h=Object(c.euiPaletteColorBlind)()[0],x=Object(c.euiPaletteColorBlind)({rotations:2})[10],y=e=>{if(e===b.d)return;let t;switch(e){case"datetime":t=m.b.DATE;break;case"numeric":t=m.b.NUMBER;break;case"boolean":t=m.b.BOOLEAN;break;case"json":t=m.b.OBJECT;break;default:t=m.b.STRING}return t},O=(e,t=20)=>{if("unsupported"===e.type)return d.i18n.translate("xpack.ml.dataGridChart.histogramNotAvailable",{defaultMessage:"Chart not supported."});if(0===e.data.length)return d.i18n.translate("xpack.ml.dataGridChart.notEnoughData",{defaultMessage:"0 documents contain field."});if("boolean"===e.type)return Object(l.jsx)("table",{css:g},Object(l.jsx)("tbody",null,Object(l.jsx)("tr",null,void 0!==e.data[0]&&Object(l.jsx)("td",{css:j},e.data[0].key_as_string),void 0!==e.data[1]&&Object(l.jsx)("td",{css:j},e.data[1].key_as_string))));if(Object(p.b)(e)&&e.cardinality<=t)return d.i18n.translate("xpack.ml.dataGridChart.singleCategoryLegend",{defaultMessage:"{cardinality, plural, one {# category} other {# categories}}",values:{cardinality:e.cardinality}});if(Object(p.b)(e)&&e.cardinality>t)return d.i18n.translate("xpack.ml.dataGridChart.topCategoriesLegend",{defaultMessage:"top {maxChartColumns} of {cardinality} categories",values:{cardinality:e.cardinality,maxChartColumns:t}});if(Object(p.a)(e)){const t=Math.round(100*e.stats[0])/100,a=Math.round(100*e.stats[1])/100;return t!==a?`${t} - ${a}`:""+t}return""},v=(e,t,a)=>{const i=y(t.schema),n=r()(f),l=(e=>{switch(e){case m.b.BOOLEAN:case m.b.IP:case m.b.STRING:return"ordinal";case m.b.DATE:return"time";case m.b.NUMBER:return"linear"}})(i),o=a=>null==n||Object(p.b)(e)&&"ordinal"===l&&n._source[t.id]===a.key||Object(p.a)(e)&&"linear"===l&&n._source[t.id]>=+a.key&&n._source[t.id]<+a.key+e.interval||Object(p.a)(e)&&"time"===l&&1e3*s()(n._source[t.id]).unix()>=+a.key&&1e3*s()(n._source[t.id]).unix()<+a.key+e.interval?h:x;let c=[];return Object(p.b)(e)?c=e.data.map((e=>{var t;return{...e,key_as_string:null!==(t=e.key_as_string)&&void 0!==t?t:e.key,color:o(e)}})):Object(p.a)(e)&&(c=e.data.map((e=>({...e,key_as_string:e.key_as_string||e.key,color:o(e)})))),{data:c,legendText:O(e,a),xScaleType:l}}},837:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(423);function s(e,t){let a={};if(e){const t=null==e?void 0:e.getComputedFields();if(void 0!==(null==t?void 0:t.runtimeFields)){const e=t.runtimeFields;Object(i.a)(e)&&(a={...a,...e})}}if(Object(i.a)(t)&&(a={...a,...t}),Object(i.a)(a))return a}},838:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));const i={EQ:"eq",GTE:"gte"}},839:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var i=a(8),s=a(2),n=a(25),l=a(5),o=a(15),r=a(840),c=a(37),u=a(229),d=a(6);const m={className:"cellHeaderWithHistogramChart"},p=({euiTheme:e})=>({".euiDataGridRowCell--boolean":{textTransform:"none"},".cellHeaderWithHistogramChart":{".euiDataGridHeaderCell__content":{width:"100%",textAlign:"left"},".euiDataGridHeaderCell__sortingArrow":{position:"absolute",bottom:0,right:e.size.base,"+ .euiPopover .euiDataGridHeaderCell__icon":{width:"auto",opacity:"1"}},".euiDataGridHeaderCell__button > .euiPopover":{position:"absolute",bottom:0,right:0},".histogramLabel":{transition:`margin ${e.animation.fast} ease-in`},"&:hover, &:focus-within, &:has(.euiPopover-isOpen)":{".histogramLabel":{marginRight:e.size.base}},"&:has(.euiDataGridHeaderCell__sortingArrow)":{".histogramLabel":{marginRight:Object(n.mathWithUnits)([e.size.xl,e.size.xxs],((e,t)=>e+t))}}}}),b=({title:e})=>Object(d.jsx)(n.EuiTitle,{size:"xs"},Object(d.jsx)("span",null,e));function g(e){return Object(c.a)(e,["title"])&&"string"==typeof e.title&&""!==e.title}const j=Object(s.memo)((e=>{const{chartsVisible:t,chartsButtonVisible:a,ccsWarning:i,columnsWithCharts:j,dataTestSubj:f,errorMessage:h,invalidSortingColumnns:x,noDataMessage:y,onChangeItemsPerPage:O,onChangePage:v,onSort:C,pagination:S,setVisibleColumns:E,renderCellPopover:T,renderCellValue:k,rowCount:_,sortingColumns:M,status:w,tableItems:I,toastNotifications:$,toggleChartVisibility:z,visibleColumns:q,trailingControlColumns:F}=e;Object(s.useEffect)((()=>{x.length>0&&x.forEach((e=>{$.addDanger(l.i18n.translate("xpack.ml.dataGrid.invalidSortingColumnError",{defaultMessage:"The column ''{columnId}'' cannot be used for sorting.",values:{columnId:e}}))}))}),[x,$]);const D=Object(s.useRef)(null);if(w===u.b.LOADED&&0===I.length)return Object(d.jsx)("div",{"data-test-subj":`${f} empty`},g(e)&&Object(d.jsx)(b,{title:e.title}),Object(d.jsx)(n.EuiCallOut,{title:l.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},Object(d.jsx)("p",null,l.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure you have sufficient permissions, the index contains documents and your query is not too restrictive."}))));if(""!==y)return Object(d.jsx)("div",{"data-test-subj":`${f} empty`},g(e)&&Object(d.jsx)(b,{title:e.title}),Object(d.jsx)(n.EuiCallOut,{title:l.i18n.translate("xpack.ml.dataGrid.dataGridNoDataCalloutTitle",{defaultMessage:"Index preview not available"}),color:"primary"},Object(d.jsx)("p",null,y)));let P;return w===u.b.ERROR&&(P=h&&!h.includes("failed to create query")?Object(d.jsx)(n.EuiCallOut,{title:l.i18n.translate("xpack.ml.dataframe.analytics.exploration.querySyntaxError",{defaultMessage:"An error occurred loading the index data. Please ensure your query syntax is valid."}),color:"danger",iconType:"cross"},Object(d.jsx)("p",null,h)):Object(d.jsx)(n.EuiCallOut,{title:l.i18n.translate("xpack.ml.dataGrid.indexDataError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},Object(d.jsx)(n.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},h))),Object(d.jsx)("div",{"data-test-subj":`${f} ${w===u.b.ERROR?"error":"loaded"}`,ref:D},g(e)&&Object(d.jsx)(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(d.jsx)(n.EuiFlexItem,null,Object(d.jsx)(b,{title:e.title})),e.copyToClipboard&&e.copyToClipboardDescription&&Object(d.jsx)(n.EuiFlexItem,{grow:!1},Object(d.jsx)(n.EuiCopy,{beforeMessage:e.copyToClipboardDescription,textToCopy:e.copyToClipboard},(t=>Object(d.jsx)(n.EuiButtonIcon,{onClick:t,iconType:"copyClipboard","aria-label":e.copyToClipboardDescription}))))),void 0!==P&&Object(d.jsx)("div",{"data-test-subj":`${f} error`},P,Object(d.jsx)(n.EuiSpacer,{size:"m"})),i&&Object(d.jsx)("div",{"data-test-subj":`${f} ccsWarning`},Object(d.jsx)(n.EuiCallOut,{title:l.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutTitle",{defaultMessage:"Cross-cluster search returned no fields data."}),color:"warning"},Object(d.jsx)("p",null,l.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutBody",{defaultMessage:"There was an issue retrieving data for the data view. Source preview in combination with cross-cluster search is only supported for versions 7.10 and above. You may still configure and create the transform."}))),Object(d.jsx)(n.EuiSpacer,{size:"m"})),_>0&&Object(d.jsx)(n.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!==D.current){const e=D.current.querySelectorAll(".euiDataGrid__virtualized");for(const t of Array.from(e))Object(c.a)(t)&&Object(c.a)(t.style)&&"auto"!==t.style.height&&(t.style.height="auto")}}},(i=>Object(d.jsx)("div",{css:p,ref:i},Object(d.jsx)(n.EuiDataGrid,{"aria-label":g(e)?e.title:"",columns:j.map((e=>(e.initialWidth=165,t&&(e.displayHeaderCellProps=m),e))),columnVisibility:{visibleColumns:q,setVisibleColumns:E},trailingControlColumns:F,gridStyle:u.e,rowCount:_,renderCellValue:k,renderCellPopover:T,sorting:{columns:M,onSort:C},toolbarVisibility:{...u.f,...a?{additionalControls:Object(d.jsx)(n.EuiToolTip,{content:l.i18n.translate("xpack.ml.dataGrid.histogramButtonToolTipContent",{defaultMessage:"Queries run to fetch histogram chart data will use a sample size per shard of {samplerShardSize} documents.",values:{samplerShardSize:r.a}})},Object(d.jsx)(n.EuiButtonEmpty,{"aria-pressed":!0===t,className:"euiDataGrid__controlBtn"+(!0===t?" euiDataGrid__controlBtn--active":""),"data-test-subj":`${f}HistogramButton`,size:"xs",iconType:"visBarVertical",color:"text",onClick:z,disabled:void 0===t},Object(d.jsx)(o.FormattedMessage,{id:"xpack.ml.dataGrid.histogramButtonText",defaultMessage:"Histogram charts"})))}:{}},pagination:{...S,pageSizeOptions:[5,10,25],onChangeItemsPerPage:O,onChangePage:v}})))))}),((e,t)=>Object(i.isEqual)(f(e),f(t))));function f(e){return[e.columnsWithCharts,e.dataTestSubj,e.errorMessage,e.invalidSortingColumnns,e.noDataMessage,e.pagination,e.rowCount,e.sortingColumns,e.status,e.tableItems,e.visibleColumns,...g(e)?[e.copyToClipboard,e.copyToClipboardDescription,e.title]:[]]}},840:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));const i=5e3},885:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a(2),s=a(838),n=a(229),l=a(76),o=a(25),r=a(5),c=a(484),u=a(757),d=a(6);const m=({euiTheme:e})=>({width:"100%",height:Object(o.mathWithUnits)([e.size.xl,e.size.xxl],((e,t)=>e+t))}),p=({euiTheme:e})=>({color:e.colors.mediumShade,marginTop:e.size.xs,fontStyle:"italic",fontWeight:"normal"}),b={background:{color:"transparent"},chartMargins:{left:0,right:0,top:0,bottom:1},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.1}},g=({chartData:e,columnType:t,dataTestSubj:a,hideLabel:i,maxChartColumns:s})=>{const{data:n,legendText:o}=Object(u.b)(e,t,s);return Object(d.jsx)("div",{"data-test-subj":a},!Object(c.c)(e)&&n.length>0&&Object(d.jsx)("div",{css:m,"data-test-subj":`${a}-histogram`},Object(d.jsx)(l.Chart,null,Object(d.jsx)(l.Settings,{theme:b,baseTheme:l.LEGACY_LIGHT_THEME,locale:r.i18n.getLocale()}),Object(d.jsx)(l.BarSeries,{id:"histogram",name:"count",xScaleType:l.ScaleType.Ordinal,yScaleType:l.ScaleType.Linear,xAccessor:"key_as_string",yAccessors:["doc_count"],styleAccessor:e=>e.datum.color,data:n}))),Object(d.jsx)("div",{className:"eui-textTruncate",css:p,"data-test-subj":`${a}-legend`},o),!i&&Object(d.jsx)("div",{"data-test-subj":`${a}-id`,className:"eui-textTruncate histogramLabel"},t.id))},j={rowCount:0,rowCountRelation:void 0},f=(e,t=5,a=n.c,l)=>{const o={pageIndex:0,pageSize:t},[r,c]=Object(i.useState)(!1),[u,m]=Object(i.useState)(""),[p,b]=Object(i.useState)(""),[f,h]=Object(i.useState)(n.b.UNUSED),[x,y]=Object(i.useState)(j),[O,v]=Object(i.useState)([]),[C,S]=Object(i.useState)([]),[E,T]=Object(i.useState)(o),[k,_]=Object(i.useState)([]),[M,w]=Object(i.useState)(void 0),{rowCount:I,rowCountRelation:$}=x,z=Object(i.useCallback)((e=>{T((t=>({pageIndex:Math.floor(t.pageSize*t.pageIndex/e),pageSize:e})))}),[]),q=Object(i.useCallback)((e=>T((t=>({...t,pageIndex:e})))),[]),[F,D]=Object(i.useState)([]),P=e.map((e=>e.id)),A=(void 0!==l?P.filter(l):P).splice(0,a);Object(i.useEffect)((()=>{D(A)}),[A.join()]);const[G,N]=Object(i.useState)([]),L=Object(i.useCallback)((t=>{const a=t.reduce(((t,a)=>{const i=e.find((e=>e.id===a.id));return"json"===(null==i?void 0:i.schema)&&t.push(a.id),t}),[]);N(a),0===a.length&&_(t)}),[e]),B=Object(i.useMemo)((()=>e.map(((e,t)=>{const a=O.find((t=>t.id===e.id));return{...e,display:void 0!==a&&!0===M?Object(d.jsx)(g,{chartData:a,columnType:e,dataTestSubj:`mlDataGridChart-${e.id}`}):void 0}})).sort(((e,t)=>-1===F.indexOf(e.id)&&F.indexOf(t.id)>-1?1:-1===F.indexOf(t.id)&&F.indexOf(e.id)>-1?-1:-1===F.indexOf(e.id)&&-1===F.indexOf(t.id)?e.id.localeCompare(t.id):F.indexOf(e.id)-F.indexOf(t.id)))),[e,O,M,JSON.stringify(F)]);return Object(i.useEffect)((()=>{void 0===M&&I>0&&void 0!==$&&w(I<=n.a&&$!==s.a.GTE)}),[M,I,$]),{ccsWarning:r,chartsVisible:M,chartsButtonVisible:!0,columnsWithCharts:B,errorMessage:p,invalidSortingColumnns:G,noDataMessage:u,onChangeItemsPerPage:z,onChangePage:q,onSort:L,pagination:E,resetPagination:()=>T(o),rowCount:I,rowCountRelation:$,setColumnCharts:v,setCcsWarning:c,setErrorMessage:b,setNoDataMessage:m,setPagination:T,setRowCountInfo:y,setSortingColumns:_,setStatus:h,setTableItems:S,setVisibleColumns:D,sortingColumns:k,status:f,tableItems:C,toggleChartVisibility:()=>{void 0!==M&&w(!M)},visibleColumns:F}}}}]);