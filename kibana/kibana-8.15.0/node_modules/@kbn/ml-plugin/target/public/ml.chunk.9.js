/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[9],{182:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a(25),l=a(15),n=a(2),c=a.n(n),i=a(6);const o=({jobsCount:e,action:t,message:a})=>Object(i.jsx)(c.a.Fragment,null,Object(i.jsx)(s.EuiSpacer,{size:"s"}),Object(i.jsx)(s.EuiCallOut,{color:"warning"},null!=a?a:Object(i.jsx)(l.FormattedMessage,{id:"xpack.ml.managedJobsWarningCallout",defaultMessage:"{jobsCount, plural, one {This job} other {At least one of these jobs}} is preconfigured by Elastic; {action} {jobsCount, plural, one {it} other {them}} might impact other parts of the product.",values:{jobsCount:e,action:t}})))},245:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var s=a(2),l=a.n(s),n=a(15),c=a(5),i=a(25),o=a(172),d=a.n(o),r=a(10),u=a(71),m=a(182),j=a(6);const b=c.i18n.translate("xpack.ml.deleteSpaceAwareItemCheckModal.shouldUnTagLabel.job",{defaultMessage:"Remove job from current space"}),x=c.i18n.translate("xpack.ml.deleteSpaceAwareItemCheckModal.shouldUnTagLabel.model",{defaultMessage:"Remove model from current space"}),g=({canDeleteCallback:e,onCloseCallback:t,refreshJobsCallback:a,mlSavedObjectType:o,ids:g,setDidUntag:p,hasManagedJob:f})=>{const[y,M]=Object(s.useState)(),[h,O]=Object(s.useState)(),[k,v]=Object(s.useState)(!1),[T,A]=Object(s.useState)(!1),[C,D]=Object(s.useState)(!1),[S,I]=Object(s.useState)(),[w,E]=Object(s.useState)(!1),{savedObjects:{canDeleteMLSpaceAwareItems:F,removeItemFromCurrentSpace:L}}=Object(r.c)(),{displayErrorToast:R,displaySuccessToast:V}=Object(u.useToastNotificationService)();d()((()=>E(!0)),1e3),Object(s.useEffect)((()=>{D(!0),F(o,g).then((t=>{const a=function(e){const t=Object.keys(e),{canDelete:a,canRemoveFromSpace:s}=e[t[0]];let l=!0;return t.length>1&&(l=t.every((t=>e[t].canDelete===a&&e[t].canRemoveFromSpace===s))),{canDelete:a,canRemoveFromSpace:s,canTakeAnyAction:l}}(t),{canDelete:s,canRemoveFromSpace:d,canTakeAnyAction:r}=a;if(r&&s&&!d)return void e();I(a);const{buttonText:u,modalText:b}=function(e,t,a,s){const{canDelete:o,canRemoveFromSpace:d,canTakeAnyAction:r}=a;if(!1===r)return{buttonText:Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.buttonTextNoAction",defaultMessage:"Close"}),modalText:Object(j.jsx)(i.EuiText,null,Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextNoAction",defaultMessage:"{ids} have different space permissions. ",values:{ids:e.join(", ")}}),"trained-model"===t?Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextNoAction.model",defaultMessage:"When you delete multiple models, they must have the same permissions. Deselect the models and try deleting each model individually."}):Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextNoAction.job",defaultMessage:"When you delete multiple jobs, they must have the same permissions. Deselect the jobs and try deleting each job individually."}))};const u={buttonText:Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.buttonTextClose",defaultMessage:"Close"}),modalText:Object(j.jsx)(i.EuiText,null,Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextClose",defaultMessage:"{ids} cannot be deleted and cannot be removed from the current space. ",values:{ids:e.join(", ")}}),"trained-model"===t?Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextClose.model",defaultMessage:"This model is assigned to the * space and you do not have access to all spaces."}):Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextClose.job",defaultMessage:"This job is assigned to the * space and you do not have access to all spaces."}))};return o?{buttonText:"trained-model"===t?Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.buttonTextCanDelete.model",defaultMessage:"Continue to delete {length, plural, one {# model} other {# models}}",values:{length:e.length}}):Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.buttonTextCanDelete.job",defaultMessage:"Continue to delete {length, plural, one {# job} other {# jobs}}",values:{length:e.length}}),modalText:Object(j.jsx)(l.a.Fragment,null,s?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(m.a,{jobsCount:e.length,action:c.i18n.translate("xpack.ml.jobsList.deleteJobCheckModal.removeOrDeleteAction",{defaultMessage:"removing or deleting"})}),Object(j.jsx)(i.EuiSpacer,{size:"s"})):null,Object(j.jsx)(i.EuiText,null,Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextCanDelete",defaultMessage:"{ids} can be deleted.",values:{ids:e.join(", ")}})))}:d?{buttonText:Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.buttonTextCanUnTagConfirm",defaultMessage:"Remove from current space"}),modalText:Object(j.jsx)(l.a.Fragment,null,s?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(m.a,{jobsCount:e.length,action:c.i18n.translate("xpack.ml.jobsList.deleteJobCheckModal.removeAction",{defaultMessage:"removing"})}),Object(j.jsx)(i.EuiSpacer,{size:"s"})):null,Object(j.jsx)(i.EuiText,null,Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTextCanUnTag",defaultMessage:"{ids} cannot be deleted but can be removed from the current space.",values:{ids:e.join(", ")}})))}:u}(g,o,a,f);M(u),O(b),D(!1)})),"function"==typeof p&&p(!1)}),[f]);const J=async()=>{A(!0);const e=await L(o,g);A(!1),"function"==typeof p&&p(!0),Object.entries(e).forEach((([e,{success:t,error:a}])=>{if(!1===t){const t=c.i18n.translate("xpack.ml.deleteSpaceAwareItemCheckModal.unTagErrorTitle",{defaultMessage:"Error updating {id}",values:{id:e}});R(a,t)}else{v(!0);const t=c.i18n.translate("xpack.ml.deleteSpaceAwareItemCheckModal.unTagSuccessTitle",{defaultMessage:"Successfully updated {id}",values:{id:e}});V(t)}})),t(),"function"==typeof a&&a()};return!1===w?null:Object(j.jsx)(i.EuiModal,{onClose:t,"data-test-subj":"mlDeleteSpaceAwareItemCheckModalOverlay"},Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(i.EuiModalHeader,null,Object(j.jsx)(i.EuiModalHeaderTitle,null,Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalTitle",defaultMessage:"Checking space permissions"}))),!1===C?Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(i.EuiModalBody,null,h),Object(j.jsx)(i.EuiModalFooter,null,Object(j.jsx)(i.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(j.jsx)(i.EuiFlexItem,{grow:!1},!k&&(null==S?void 0:S.canTakeAnyAction)&&(null==S?void 0:S.canRemoveFromSpace)&&(null==S?void 0:S.canDelete)&&Object(j.jsx)(i.EuiButtonEmpty,{isLoading:T,color:"primary",size:"s",onClick:J},"trained-model"===o?x:b)),Object(j.jsx)(i.EuiFlexItem,{grow:!1},Object(j.jsx)(i.EuiButton,{"data-test-subj":"mlDeleteSpaceAwareItemCheckModalOverlayCloseButton",size:"s",onClick:null==S||!S.canTakeAnyAction||null==S||!S.canRemoveFromSpace||null!=S&&S.canDelete?async()=>{null!=S&&S.canTakeAnyAction&&null!=S&&S.canDelete?e():t()}:J,fill:!0},y))))):Object(j.jsx)(i.EuiModalBody,null,Object(j.jsx)(i.EuiText,null,Object(j.jsx)(n.FormattedMessage,{id:"xpack.ml.deleteSpaceAwareItemCheckModal.modalDesc",defaultMessage:"Checking to see whether the {jobCount, plural, one {job} other {jobs}} can be deleted.",values:{jobCount:g.length}})),Object(j.jsx)(i.EuiSpacer,{size:"s"}))))}},274:function(e,t,a){"use strict";a.d(t,"d",(function(){return s.a})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return r})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return b}));var s=a(259),l=a(5),n=a(322),c=a(11),i=a(148);const o=async(e,t)=>{try{await c.ml.dataFrameAnalytics.deleteDataFrameAnalytics(e.id),t.displaySuccessToast(l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:e.id}}))}catch(a){t.displayErrorToast(a,l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}}))}i.k.next(i.a.REFRESH)},d=async(e,t,a,s)=>{const o=e.dest.index;try{var d,r,u,m,j,b;const i=await c.ml.dataFrameAnalytics.deleteDataFrameAnalyticsAndDestIndex(e.id,t,a);if(null!==(d=i.analyticsJobDeleted)&&void 0!==d&&d.success&&s.displaySuccessToast(l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:e.id}})),null!==(r=i.analyticsJobDeleted)&&void 0!==r&&r.error&&s.displayErrorToast(i.analyticsJobDeleted.error,l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}})),null!==(u=i.destIndexDeleted)&&void 0!==u&&u.success&&s.displaySuccessToast(l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexSuccessMessage",{defaultMessage:"Request to delete destination index {destinationIndex} acknowledged.",values:{destinationIndex:o}})),null!==(m=i.destIndexDeleted)&&void 0!==m&&m.error&&s.displayErrorToast(i.destIndexDeleted.error,l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexErrorMessage",{defaultMessage:"An error occurred deleting destination index {destinationIndex}",values:{destinationIndex:o}})),null!==(j=i.destDataViewDeleted)&&void 0!==j&&j.success&&s.displaySuccessToast(l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithDataViewSuccessMessage",{defaultMessage:"Request to delete data view {destinationIndex} acknowledged.",values:{destinationIndex:o}})),null!==(b=i.destDataViewDeleted)&&void 0!==b&&b.error){const e=Object(n.a)(i.destDataViewDeleted.error);s.displayDangerToast(l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithDataViewErrorMessage",{defaultMessage:"An error occurred deleting data view {destinationIndex}: {error}",values:{destinationIndex:o,error:e}}))}}catch(t){s.displayErrorToast(t,l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}}))}i.k.next(i.a.REFRESH)},r=async(e,t)=>{try{const t=await c.ml.hasPrivileges({index:[{names:[e],privileges:["delete_index"]}]});return!!t&&(void 0===t.hasPrivileges||!0===t.hasPrivileges.has_all_requested)}catch(a){const s=Object(n.a)(a);t.displayDangerToast(l.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsPrivilegeErrorMessage",{defaultMessage:"User does not have permission to delete index {indexName}: {error}",values:{indexName:e,error:s}}))}},u=async(e,t)=>{try{await c.ml.dataFrameAnalytics.startDataFrameAnalytics(e.config.id),t.displaySuccessToast(l.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {analyticsId} acknowledged.",values:{analyticsId:e.config.id}}))}catch(e){t.displayErrorToast(e,l.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsErrorTitle",{defaultMessage:"Error starting job"}))}i.k.next(i.a.REFRESH)};var m=a(17),j=a(164);const b=async e=>{const t=Object(m.f)();try{await c.ml.dataFrameAnalytics.stopDataFrameAnalytics(e.config.id,Object(j.e)(e.stats.state)),t.addSuccess(l.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsSuccessMessage",{defaultMessage:"Request to stop data frame analytics {analyticsId} acknowledged.",values:{analyticsId:e.config.id}}))}catch(a){t.addDanger(l.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsErrorMessage",{defaultMessage:"An error occurred stopping the data frame analytics {analyticsId}: {error}",values:{analyticsId:e.config.id,error:JSON.stringify(a)}}))}i.k.next(i.a.REFRESH)}},496:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return f}));var s=a(2),l=a.n(s),n=a(5),c=a(25),i=a(70),o=a(164),d=a(6);const r=n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionNameText",{defaultMessage:"Delete"}),u=({isDisabled:e,item:t})=>e?Object(d.jsx)(c.EuiToolTip,{position:"top",content:Object(o.f)(t.stats.state)?n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionDisabledToolTipContent",{defaultMessage:"Stop the data frame analytics job in order to delete it."}):Object(i.createPermissionFailureMessage)("canStartStopDataFrameAnalytics")},Object(d.jsx)(l.a.Fragment,null,r)):Object(d.jsx)(l.a.Fragment,null,r),m=({closeModal:e,deleteAndCloseModal:t,deleteTargetIndex:a,deleteDataView:s,dataViewExists:l,isLoading:i,item:o,toggleDeleteIndex:r,toggleDeleteDataView:u,userCanDeleteIndex:m,userCanDeleteDataView:j})=>{if(void 0===o)return null;const b=o.config.dest.index;return Object(d.jsx)(c.EuiConfirmModal,{"data-test-subj":"mlAnalyticsJobDeleteModal",title:n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalTitle",{defaultMessage:"Delete {analyticsId}?",values:{analyticsId:o.config.id}}),onCancel:e,onConfirm:t,cancelButtonText:n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalDeleteButton",{defaultMessage:"Delete"}),defaultFocusedButton:c.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger",confirmButtonDisabled:i},Object(d.jsx)(c.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(d.jsx)(c.EuiFlexItem,null,m&&Object(d.jsx)(c.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteIndexSwitch",style:{paddingBottom:10},label:n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteDestinationIndexTitle",{defaultMessage:"Delete destination index {indexName}",values:{indexName:b}}),checked:a,onChange:r})),Object(d.jsx)(c.EuiFlexItem,null,m&&l&&Object(d.jsx)(c.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteDataViewSwitch",label:n.i18n.translate("xpack.ml.dataframe.analyticsList.deleteTargetDataViewTitle",{defaultMessage:"Delete data view {dataView}",values:{dataView:b}}),checked:s,onChange:u,disabled:!1===j}))))};var j=a(322),b=a(10),x=a(71),g=a(274),p=a(291);const f=e=>{const[t,a]=Object(s.useState)(),[l,c]=Object(s.useState)(!1),[i,m]=Object(s.useState)(!1),[f,y]=Object(s.useState)(!1),[M,h]=Object(s.useState)(!0),[O,k]=Object(s.useState)(!0),[v,T]=Object(s.useState)(!1),[A,C]=Object(s.useState)(!1),[D,S]=Object(s.useState)(!1),[I,w]=Object(s.useState)(!1),{data:{dataViews:E},application:{capabilities:F}}=Object(b.d)().services,L=Object(p.a)(null==t?void 0:t.config),R=Object(x.useToastNotificationService)();Object(s.useEffect)((()=>{w(!0),(async()=>{try{const e=(await E.getIdsWithTitle(!0)).find((({title:e})=>e===L));S(void 0!==e),w(!1)}catch(e){const t=Object(j.a)(e);w(!1),R.displayDangerToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfDataViewExistsNotificationErrorMessage",{defaultMessage:"An error occurred checking if data view {dataView} exists: {error}",values:{dataView:L,error:t}}))}})(),(async()=>{try{await Object(g.a)(L,R)&&T(!0);const e=!0===F.savedObjectsManagement.delete||!0===F.indexPatterns.save;C(e),!1===e&&k(!1)}catch(e){const t=Object(j.a)(e);w(!1),R.displayDangerToast(n.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfUserCanDeleteIndexNotificationErrorMessage",{defaultMessage:"An error occurred checking if user can delete {destinationIndex}: {error}",values:{destinationIndex:L,error:t}}))}})()}),[l]);const V=e=>{a(e),m(!0)};return{action:Object(s.useMemo)((()=>({name:t=>Object(d.jsx)(u,{isDisabled:Object(o.f)(t.stats.state)||!e,item:t}),enabled:t=>!Object(o.f)(t.stats.state)&&e,description:r,icon:"trash",type:"icon",onClick:e=>V(e),"data-test-subj":"mlAnalyticsJobDeleteButton"})),[]),closeDeleteJobCheckModal:()=>m(!1),closeModal:()=>c(!1),deleteAndCloseModal:()=>{y(!0),c(!1),void 0!==t&&(v&&M||v&&O?Object(g.c)(t.config,M,D&&O,R):Object(g.b)(t.config,R))},deleteTargetIndex:M,deleteDataView:O,deleteItem:f,dataViewExists:D,isDeleteJobCheckModalVisible:i,isModalVisible:l,isLoading:I,item:t,jobType:"data-frame-analytics",openModal:e=>{a(e),c(!0)},openDeleteJobCheckModal:V,toggleDeleteIndex:()=>h(!M),toggleDeleteDataView:()=>k(!O),userCanDeleteIndex:v,userCanDeleteDataView:A}}}}]);