/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[73],{192:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2);t.default=function(e){n.useEffect(e,[])}},224:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(58),r=i(2),o=n.__importDefault(i(192));t.default=function(e){var t=r.useRef(e);t.current=e,o.default((function(){return function(){return t.current()}}))}},270:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i(26),i(7);var n=i(2),r=i(21);const o=(e,t,i,o)=>{const c=Object(n.useMemo)((()=>{const e={type:"visualization",name:i,id:o};return{...t,child:e}}),[i,o,t]);Object(r.useExecutionContext)(e,c)}},346:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(120),r=i.n(n),o=(i(2),i(116)),c=i(6);const s=Object(o.a)((async()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(8),i.e(11),i.e(14),i.e(17),i.e(21),i.e(42)]).then(i.bind(null,494)))),l=(e,t,i)=>n=>Object(c.jsx)(s,r()({coreStart:e,pluginStart:t,mlServices:i},n))},882:function(e,t,i){"use strict";i.r(t),i.d(t,"getSingleMetricViewerEmbeddableFactory",(function(){return f}));var n=i(5),r=(i(2),i(224)),o=i.n(r),c=i(136),s=i(7),l=i(161),a=i(206),u=i.n(a),d=i(56),b=i(270),p=i(346),v=i(6);const f=e=>({type:l.b,deserializeState:e=>e.rawState,buildEmbeddable:async(t,r,a,f)=>{const j=await Object(d.b)(e),m=new s.Subscription,{titlesApi:w,titleComparators:D,serializeTitles:x}=Object(c.j)(t),{api:g,comparators:S,serialize:I}=Object(c.i)(t),{singleMetricViewerControlsApi:E,serializeSingleMetricViewerState:h,singleMetricViewerComparators:M,onSingleMetricViewerDestroy:y}=((e,t)=>{var i;const n=new s.BehaviorSubject(e.functionDescription),r=new s.BehaviorSubject(e.jobIds),o=new s.BehaviorSubject(null!==(i=e.selectedDetectorIndex)&&void 0!==i?i:0),c=new s.BehaviorSubject(e.selectedEntities),l={jobIds:[r,e=>r.next(e),u.a],selectedDetectorIndex:[o,e=>o.next(e)],selectedEntities:[c,e=>c.next(e),u.a],functionDescription:[n,e=>n.next(e)]};return{singleMetricViewerControlsApi:{jobIds:r,selectedDetectorIndex:o,selectedEntities:c,functionDescription:n,updateUserInput:e=>{r.next(e.jobIds),n.next(e.functionDescription),o.next(e.selectedDetectorIndex),c.next(e.selectedEntities),t.setPanelTitle(e.panelTitle)}},serializeSingleMetricViewerState:()=>({jobIds:r.value,selectedDetectorIndex:o.value,selectedEntities:c.value,functionDescription:null==n?void 0:n.value}),singleMetricViewerComparators:l,onSingleMetricViewerDestroy:()=>{r.complete(),o.complete(),c.complete(),n.complete()}}})(t,w),O=new s.BehaviorSubject(!0),V=new s.BehaviorSubject(void 0),C=r({isEditingEnabled:()=>!0,getTypeDisplayName:()=>n.i18n.translate("xpack.ml.singleMetricViewerEmbeddable.typeDisplayName",{defaultMessage:"single metric viewer"}),onEdit:async()=>{try{const{resolveEmbeddableSingleMetricViewerUserInput:e}=await Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(19),i.e(31),i.e(66)]).then(i.bind(null,886)),[t,{data:n,share:r},{mlApiServices:o}]=j,c=await e(t,f,a,{data:n,share:r},o,{...x(),...h()});E.updateUserInput(c)}catch(e){return Promise.reject()}},...w,...g,...E,dataLoading:O,blockingError:V,serializeState:()=>({rawState:{timeRange:void 0,...x(),...I(),...h()},references:[]})},{...S,...D,...M}),{singleMetricViewerData$:R,onDestroy:_}=((e,t,i,n)=>{const r=new s.BehaviorSubject({singleMetricViewerData:void 0,bounds:void 0,lastRefresh:void 0}),o=Object(s.combineLatest)({jobIds:e.jobIds,selectedDetectorIndex:e.selectedDetectorIndex,selectedEntities:e.selectedEntities,functionDescription:e.functionDescription}),l=Object(s.combineLatest)([o,Object(c.g)(e)]).subscribe((([t,i])=>{let o,c;var s,l;void 0!==n&&(o=n.calculateBounds(null!=i&&i.timeRange?null==i?void 0:i.timeRange:null!==(s=null===(l=e.timeRange$)||void 0===l?void 0:l.value)&&void 0!==s?s:n.getTime()),c=Date.now()),r.next({singleMetricViewerData:t,bounds:o,lastRefresh:c})}));return{singleMetricViewerData$:r,onDestroy:()=>{l.unsubscribe()}}})(C,0,0,j[1].data.query.timefilter.timefilter),B=Object(p.a)(...j);return{api:C,Component:()=>{var e;if(!Object(c.a)(f))throw new Error("Parent API does not have execution context");const{singleMetricViewerData:t,bounds:i,lastRefresh:n}=Object(c.l)(R);Object(b.a)(j[0].executionContext,f.executionContext,l.b,a),o()((()=>{y(),_(),m.unsubscribe()}));const r=""===(null!==(e=null==t?void 0:t.functionDescription)&&void 0!==e?e:"")||null==t?void 0:t.functionDescription;return Object(v.jsx)(B,{bounds:i,functionDescription:r,lastRefresh:n,onError:e=>V.next(e),selectedDetectorIndex:null==t?void 0:t.selectedDetectorIndex,selectedEntities:null==t?void 0:t.selectedEntities,selectedJobId:null==t?void 0:t.jobIds[0],uuid:C.uuid,onRenderComplete:()=>{O.next(!1)}})}}}})}}]);