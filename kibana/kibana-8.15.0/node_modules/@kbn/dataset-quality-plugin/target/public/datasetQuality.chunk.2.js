/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.datasetQuality_bundle_jsonpfunction=window.datasetQuality_bundle_jsonpfunction||[]).push([[2],{121:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4),i={};t.default=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];var s=[],o=[],l=function(e){var t=n.createContext(i);s.push(t),o.push(function(e){return function(){var t=n.useContext(e);return t}}(t))};a.length?a.forEach((function(e){return l(e.name)})):l(e.name);var d=function(t){for(var i=t.children,r=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(t,["children"]),o=e(r),l=i,d=0;d<s.length;d+=1){var c=s[d],u=a[d]||function(e){return e};l=n.createElement(c.Provider,{value:u(o)},l)}return l};return[d].concat(o)}},51:function(e,t,a){"use strict";a.d(t,"d",(function(){return q})),a.d(t,"c",(function(){return Q})),a.d(t,"e",(function(){return oe})),a.d(t,"f",(function(){return te})),a.d(t,"g",(function(){return de.useSummaryPanelContext})),a.d(t,"b",(function(){return ce})),a.d(t,"a",(function(){return ee.a}));var n=a(52),i=a(15),r=a(4),s=a.n(r),o=a(5),l=a(9),d=a(12),c=a(63),u=a.n(c),g=a(6),m=a(88),b=a(1),p=a(34),f=a(3),y=a(16),O=a(79),_=a(67),v=a(91);const T=({isLoading:e,dataStreamStat:t})=>{const{degradedDocs:{percentage:a,count:n}}=t,i=te({dataStreamStat:t,query:{language:"kuery",query:`${v.a}: *`},telemetry:{page:"main",navigationSource:y.a.Table}});return Object(f.jsx)(g.EuiSkeletonRectangle,{width:"50px",height:"20px",borderRadius:"m",isLoading:e},Object(f.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},a?Object(f.jsx)(g.EuiLink,u()({"data-test-subj":"datasetQualityDegradedDocsPercentageLink"},i.linkProps),Object(f.jsx)(O.c,{percentage:a,degradedDocsCount:n})):Object(f.jsx)(O.c,{percentage:a})))},j=b.i18n.translate("xpack.datasetQuality.expandLabel",{defaultMessage:"Expand"}),E=b.i18n.translate("xpack.datasetQuality.collapseLabel",{defaultMessage:"Collapse"}),S=b.i18n.translate("xpack.datasetQuality.nameColumnName",{defaultMessage:"Data Set Name"}),h=b.i18n.translate("xpack.datasetQuality.namespaceColumnName",{defaultMessage:"Namespace"}),x=b.i18n.translate("xpack.datasetQuality.sizeColumnName",{defaultMessage:"Size"}),D=b.i18n.translate("xpack.datasetQuality.degradedDocsColumnName",{defaultMessage:"Degraded Docs (%)"}),k=b.i18n.translate("xpack.datasetQuality.datasetQualityColumnName",{defaultMessage:"Data Set Quality"}),N=b.i18n.translate("xpack.datasetQuality.lastActivityColumnName",{defaultMessage:"Last Activity"}),A=b.i18n.translate("xpack.datasetQuality.actionsColumnName",{defaultMessage:"Actions"}),C=b.i18n.translate("xpack.datasetQuality.openActionName",{defaultMessage:"Open"}),w=b.i18n.translate("xpack.datasetQuality.inactiveDatasetActivityColumnDescription",{defaultMessage:"No activity in the selected timeframe"}),L=b.i18n.translate("xpack.datasetQuality.inactiveDatasetActivityColumnTooltip",{defaultMessage:"Try expanding the time range above for more results"}),F=(e,t,a="")=>b.i18n.translate("xpack.datasetQuality.degradedDocsQualityDescription",{defaultMessage:"{quality} -{comparator} {minimimPercentage}%",values:{quality:e,minimimPercentage:t,comparator:a}}),R=Object(f.jsx)(p.FormattedMessage,{id:"xpack.datasetQuality.degradedDocsColumnTooltip",defaultMessage:"The percentage of documents with the {ignoredProperty} property in your data set.",values:{ignoredProperty:Object(f.jsx)(g.EuiCode,{language:"json",transparentBackground:!0},"_ignored")}}),I=Object(f.jsx)(p.FormattedMessage,{id:"xpack.datasetQuality.datasetQualityColumnTooltip",defaultMessage:"Quality is based on the percentage of degraded docs in a data set. {visualQueue}",values:{visualQueue:Object(f.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(f.jsx)(g.EuiFlexItem,null,Object(f.jsx)(O.b,{quality:"poor",description:` ${F("Poor",o.o," greater than")}`})),Object(f.jsx)(g.EuiFlexItem,null,Object(f.jsx)(O.b,{quality:"degraded",description:` ${F("Degraded",o.k," greater than")}`})),Object(f.jsx)(g.EuiFlexItem,null,Object(f.jsx)(O.b,{quality:"good",description:` ${F("Good",o.k)}`})))}});var M={name:"tfjd6k",styles:"&.euiTableCellContent{padding:0;}"};const P=({dataStreamStat:e,title:t})=>{const a=te({dataStreamStat:e,telemetry:{page:"main",navigationSource:y.a.Table}});return Object(f.jsx)(g.EuiLink,u()({"data-test-subj":"datasetQualityLogsExplorerLinkLink"},a.linkProps),t)};var G=a(13),U=a(14),B=a(19);const z={title:"name",size:l.a.calculateFilteredSize},q=()=>{var e;const{services:{fieldFormats:t}}=Object(U.c)(),{service:a}=Object(G.b)(),{page:c,rowsPerPage:u,sort:b}=Object(n.useSelector)(a,(e=>e.context.table)),p=Object(n.useSelector)(a,(e=>e.context.isSizeStatsAvailable)),y=Object(n.useSelector)(a,(e=>e.context.datasetUserPrivileges.canMonitor)),v=Object(n.useSelector)(a,(e=>!e.context.dataStreamStats||!e.context.dataStreamStats.length||e.context.dataStreamStats.some((e=>e.userPrivileges.canMonitor)))),{inactive:F,fullNames:q,timeRange:Q,integrations:K,namespaces:H,qualities:V,query:$}=Object(n.useSelector)(a,(e=>e.context.filters)),Y=F||!y,W=Object(n.useSelector)(a,(e=>e.context.flyout)),X=Object(n.useSelector)(a,(e=>e.matches("datasets.fetching")||e.matches("integrations.fetching")||e.matches("degradedDocs.fetching"))),J=Object(n.useSelector)(a,(e=>e.matches("datasets.fetching"))),Z=Object(n.useSelector)(a,(e=>e.matches("degradedDocs.fetching"))),ee=Object(n.useSelector)(a,(e=>e.context.datasets)),te=Object(r.useCallback)((()=>a.send({type:"TOGGLE_INACTIVE_DATASETS"})),[a]),ae=Object(r.useCallback)((()=>a.send({type:"TOGGLE_FULL_DATASET_NAMES"})),[a]),ne=Object(r.useCallback)((()=>a.send({type:"CLOSE_FLYOUT"})),[a]),ie=Object(r.useCallback)((e=>{var t;(null==W||null===(t=W.dataset)||void 0===t?void 0:t.rawName)!==e.rawName?null!=W&&W.insightsTimeRange?a.send({type:"SELECT_NEW_DATASET",dataset:e}):a.send({type:"OPEN_FLYOUT",dataset:e}):a.send({type:"CLOSE_FLYOUT"})}),[null==W||null===(e=W.dataset)||void 0===e?void 0:e.rawName,null==W?void 0:W.insightsTimeRange,a]),re=Object(r.useCallback)((e=>Object(B.b)({lastActivity:e,timeRange:Q})),[Q]),se=Object(r.useMemo)((()=>(({fieldFormats:e,canUserMonitorDataset:t,canUserMonitorAnyDataStream:a,selectedDataset:n,openFlyout:i,loadingDataStreamStats:r,loadingDegradedStats:s,showFullDatasetNames:d,isSizeStatsAvailable:c,isActiveDataset:u})=>[{name:"",render:e=>{const t=e.rawName===(null==n?void 0:n.rawName);return Object(f.jsx)(g.EuiButtonIcon,{"data-test-subj":"datasetQualityExpandButton",size:"xs",color:"text",onClick:()=>i(e),iconType:t?"minimize":"expand",title:t?E:j,"aria-label":t?E:j})},width:"40px",css:M},{name:S,field:"title",sortable:!0,render:(e,t)=>{const{integration:a,name:n}=t;return Object(f.jsx)(g.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(f.jsx)(g.EuiFlexItem,{grow:!1},Object(f.jsx)(_.a,{integration:a})),Object(f.jsx)(g.EuiText,{size:"s"},e),d&&Object(f.jsx)(g.EuiText,{size:"xs",color:"subdued"},Object(f.jsx)("em",null,n)))}},{name:h,field:"namespace",sortable:!0,render:(e,t)=>Object(f.jsx)(g.EuiBadge,{color:"hollow"},t.namespace),width:"160px"},...c&&t&&a?[{name:x,field:"sizeBytes",sortable:!0,render:(e,t)=>{var a,n;return Object(f.jsx)(_.b,{title:`sizeBytes-${t.title}`,hasPrivileges:null===(a=null===(n=t.userPrivileges)||void 0===n?void 0:n.canMonitor)||void 0===a||a},Object(f.jsx)(g.EuiSkeletonRectangle,{width:"60px",height:"20px",borderRadius:"m",isLoading:r||s},Object(g.formatNumber)(l.a.calculateFilteredSize(t),o.a)))},width:"100px"}]:[],{name:Object(f.jsx)(g.EuiToolTip,{content:I},Object(f.jsx)("span",null,`${k} `,Object(f.jsx)(g.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),field:"degradedDocs.percentage",sortable:!0,render:(e,t)=>Object(f.jsx)(O.a,{isLoading:s,dataStreamStat:t}),width:"140px"},{name:Object(f.jsx)(g.EuiToolTip,{content:R},Object(f.jsx)("span",null,`${D} `,Object(f.jsx)(g.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),field:"degradedDocs.percentage",sortable:!0,render:(e,t)=>Object(f.jsx)(T,{isLoading:s,dataStreamStat:t}),width:"140px"},...t&&a?[{name:N,field:"lastActivity",render:(t,{userPrivileges:a,title:n})=>{var i;return Object(f.jsx)(_.b,{title:`lastActivity-${n}`,hasPrivileges:null===(i=null==a?void 0:a.canMonitor)||void 0===i||i},Object(f.jsx)(g.EuiSkeletonRectangle,{width:"200px",height:"20px",borderRadius:"m",isLoading:r},u(t)?e.getDefaultInstance(m.b.DATE,[m.a.DATE]).convert(t):Object(f.jsx)(g.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(f.jsx)(g.EuiText,{size:"s"},w),Object(f.jsx)(g.EuiToolTip,{position:"top",content:L},Object(f.jsx)(g.EuiIcon,{tabIndex:0,type:"iInCircle",size:"s"})))))},width:"300px",sortable:!0}]:[],{name:A,render:e=>Object(f.jsx)(P,{dataStreamStat:e,title:C}),width:"100px"}])({fieldFormats:t,canUserMonitorDataset:y,canUserMonitorAnyDataStream:v,selectedDataset:null==W?void 0:W.dataset,openFlyout:ie,loadingDataStreamStats:J,loadingDegradedStats:Z,showFullDatasetNames:q,isSizeStatsAvailable:p,isActiveDataset:re})),[t,y,v,null==W?void 0:W.dataset,ie,J,Z,q,p,re]),oe=Object(r.useMemo)((()=>(Y?ee:Object(B.a)({datasets:ee,timeRange:Q})).filter((e=>{const t=0===K.length||!e.integration&&K.includes(o.m)||e.integration&&K.includes(e.integration.name),a=0===H.length||H.includes(e.namespace),n=0===V.length||V.includes(e.degradedDocs.quality),i=!$||e.rawName.includes($);return t&&a&&n&&i}))),[Y,ee,Q,K,H,V,$]),le={pageIndex:c,pageSize:u,totalItemCount:oe.length,hidePerPageOptions:!0},de=Object(r.useCallback)((e=>{var t,n;a.send({type:"UPDATE_TABLE_CRITERIA",dataset_criteria:{page:e.page.index,rowsPerPage:e.page.size,sort:{field:(null===(t=e.sort)||void 0===t?void 0:t.field)||o.i,direction:(null===(n=e.sort)||void 0===n?void 0:n.direction)||o.h}}})}),[a]),ce=Object(r.useMemo)((()=>{const e=z[b.field]||b.field;return Object(i.orderBy)(oe,e,b.direction).slice(c*u,(c+1)*u)}),[b.field,b.direction,oe,c,u]),ue=Object(r.useMemo)((()=>{const e=u*c+(ce.length?1:0),t=u*c+ce.length;return 0===u?Object(f.jsx)("strong",null,d.N):Object(f.jsx)(s.a.Fragment,null,Object(f.jsx)("strong",null,e,"-",t)," ",d.O," ",ee.length)}),[u,c,ce.length,ee.length]);return{sort:{sort:b},onTableChange:de,pagination:le,filteredItems:oe,renderedItems:ce,columns:se,loading:X,resultsCount:ue,closeFlyout:ne,selectedDataset:null==W?void 0:W.dataset,showInactiveDatasets:Y,showFullDatasetNames:q,canUserMonitorDataset:y,canUserMonitorAnyDataStream:v,toggleInactiveDatasets:te,toggleFullDatasetNames:ae,isSizeStatsAvailable:p}},Q=()=>{var e;const{services:{fieldFormats:t}}=Object(U.c)(),{service:a}=Object(G.b)(),{dataset:i,datasetSettings:r,datasetDetails:s,insightsTimeRange:o,breakdownField:l,isNonAggregatable:d}=null!==(e=Object(n.useSelector)(a,(e=>e.context.flyout)))&&void 0!==e?e:{},{timeRange:c}=Object(n.useSelector)(a,(e=>e.context.filters));return{dataStreamStat:i,dataStreamSettings:r,dataStreamDetails:s,isNonAggregatable:d,fieldFormats:t,timeRange:null!=o?o:c,breakdownField:l,loadingState:Object(n.useSelector)(a,(e=>({dataStreamDetailsLoading:e.matches("flyout.initializing.dataStreamDetails.fetching"),dataStreamSettingsLoading:e.matches("flyout.initializing.dataStreamSettings.fetching"),datasetIntegrationsLoading:e.matches("flyout.initializing.integrationDashboards.fetching")}))),flyoutLoading:!i,canUserAccessDashboards:Object(n.useSelector)(a,(e=>!e.matches("flyout.initializing.integrationDashboards.unauthorized"))),canUserViewIntegrations:Object(n.useSelector)(a,(e=>e.context.datasetUserPrivileges.canViewIntegrations))}};var K=a(35),H=a(7),V=a(21),$=function(e){return e.Date="date_column",e.DegradedDocs="degraded_docs_column",e.CountIgnored="count_ignored",e.CountTotal="count_total",e.Math="math_column",e.Breakdown="breakdown_column",e}($||{});function Y(e,t,a){return{internalReferences:[{id:e,name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:e,name:"indexpattern-datasource-layer-layer1",type:"index-pattern"}],adHocDataViews:{[e]:{id:e,title:t,timeFieldName:"@timestamp",sourceFilters:[],fieldFormats:{},runtimeFieldMap:{},fieldAttrs:{},allowNoIndex:!1,name:a}}}}const W=(e,t)=>b.i18n.translate("xpack.datasetQuality.flyoutDegradedDocsTopNValues",{defaultMessage:"Top {count} values of {fieldName}",values:{count:e,fieldName:t},description:"Tooltip label for the top N values of a field in the degraded documents trend chart."});var X=a(39),J=a(40),Z=a(96),ee=a(73);const te=({dataStreamStat:e,query:t,timeRangeConfig:a,breakdownField:i,telemetry:s})=>{const{services:{share:o}}=Object(U.c)(),{service:l}=Object(G.b)(),{timeRange:d}=Object(n.useSelector)(l,(e=>e.context.filters)),{from:c,to:u}=a||d,g=o.url.locators.get("SINGLE_DATASET_LOCATOR"),{sendTelemetry:m}=Object(ee.b)({rawName:e.rawName,isLogsExplorer:!!g,telemetry:s,query:t});return Object(r.useMemo)((()=>{const a=g?ae({locator:g,dataStreamStat:e,query:t,from:c,to:u,breakdownField:i}):ne({locatorClient:o.url.locators,dataStreamStat:e,query:t,from:c,to:u,breakdownField:i});return{linkProps:{...a.routerLinkProps,onClick:e=>{m(),a.routerLinkProps.onClick&&a.routerLinkProps.onClick(e)}},navigate:()=>{m(),a.navigate()},isLogsExplorerAvailable:!!g}}),[i,e,c,u,g,t,m,o.url.locators])},ae=({locator:e,dataStreamStat:t,query:a,from:n,to:i,breakdownField:r})=>{var s;const o={dataset:t.name,timeRange:{from:n,to:i},integration:null===(s=t.integration)||void 0===s?void 0:s.name,query:a,filterControls:{namespace:{mode:"include",values:[t.namespace]}},breakdownField:r},l=e.getRedirectUrl(o),d=()=>{e.navigate(o)};return{routerLinkProps:Object(Z.a)({href:l,onClick:d}),navigate:d}},ne=({locatorClient:e,dataStreamStat:t,query:a,from:n,to:i,breakdownField:r})=>{const s=`${t.type}-${t.name}-*`,o=t.integration?`[${t.integration.title}] ${t.name}`:`${s}`,l={timeRange:{from:n,to:i},refreshInterval:{pause:!0,value:6e4},dataViewId:s,dataViewSpec:{id:s,title:o},query:a,breakdownField:r,columns:["@timestamp","message"],filters:[Object(J.buildPhraseFilter)({name:"data_stream.namespace",type:"string"},t.namespace,{id:s,title:o})],interval:"auto",sort:[["@timestamp","desc"]]},d=e.get(X.DISCOVER_APP_LOCATOR),c=null==d?void 0:d.getRedirectUrl(l),u=()=>{null==d||d.navigate(l)};return{routerLinkProps:Object(Z.a)({href:c,onClick:u}),navigate:u}},ie=b.i18n.translate("xpack.datasetQuality.flyoutChartExploreDataInLogsExplorerText",{defaultMessage:"Explore data in Logs Explorer"}),re=b.i18n.translate("xpack.datasetQuality.flyoutChartExploreDataInDiscoverText",{defaultMessage:"Explore data in Discover"}),se=b.i18n.translate("xpack.datasetQuality.flyoutChartOpenInLensText",{defaultMessage:"Open in Lens"}),oe=({dataStream:e})=>{const{euiTheme:t}=Object(g.useEuiTheme)(),{services:{lens:a}}=Object(U.c)(),{service:n}=Object(G.b)(),{trackDetailsNavigated:i,navigationTargets:s,navigationSources:l}=Object(ee.a)(),{dataStreamStat:c,timeRange:u,breakdownField:m}=Q(),[b,p]=Object(r.useState)(void 0),[f,y]=Object(r.useState)(void 0),{dataView:O}=function({indexPatternString:e}){const{services:{dataViews:t}}=Object(U.c)(),[a,n]=Object(r.useState)(),[i,s]=Object(r.useState)(!1);return Object(r.useEffect)((()=>{e&&(s(!0),(async a=>{const n=(await t.getIdsWithTitle()).find((e=>e.title===a));return n?t.get(n.id):t.create({id:`${e}-id`,title:e,allowNoIndex:!0,timeFieldName:"@timestamp"})})(e).then((e=>{n(e)})).finally((()=>{s(!1)})))}),[e,t]),{dataView:a,loading:i}}({indexPatternString:le(e)}),_=Object(r.useMemo)((()=>function(e,t){return t&&e?e.fields.find((e=>e.name===t)):void 0}(O,m)),[m,O]),v=Object(r.useCallback)((e=>{var t;n.send({type:"BREAKDOWN_FIELD_CHANGE",breakdownField:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:null})}),[n]);Object(r.useEffect)((()=>{var a;const n=null!=e?e:o.g,i=function({color:e,dataStream:t,datasetTitle:a,breakdownFieldName:n}){const i=Object(V.v4)(),r=[$.Date,$.CountIgnored,$.CountTotal,$.Math,$.DegradedDocs];n&&r.unshift($.Breakdown);const s=(o=n,{[$.Date]:{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},[$.CountIgnored]:{label:"",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:"_ignored: *",language:"kuery"},params:{emptyAsNull:!1},customLabel:!0},[$.CountTotal]:{label:"",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",params:{emptyAsNull:!1},customLabel:!0},[$.Math]:{label:"",dataType:"number",operationType:"math",isBucketed:!1,scale:"ratio",params:{tinymathAst:{type:"function",name:"divide",args:["count_ignored","count_total"],location:{min:0,max:34},text:"count(kql='_ignored: *') / count()"}},references:["count_ignored","count_total"],customLabel:!0},[$.DegradedDocs]:{label:d.f,customLabel:!0,operationType:"formula",dataType:"number",references:[$.Math],isBucketed:!1,params:{formula:"count(kql='_ignored: *') / count()",format:{id:"percent",params:{decimals:3}},isFormulaBroken:!1}},...o?{[$.Breakdown]:{dataType:"number",isBucketed:!0,label:W(5,o),operationType:"terms",scale:"ordinal",sourceField:o,params:{size:5,orderBy:{type:"alphabetical",fallback:!0},orderDirection:"desc",otherBucket:!0,missingBucket:!0,parentFormat:{id:"terms"}}}}:{}});var o;return{visualizationType:"lnsXY",title:d.h,references:[],state:{...Y(i,t,a),datasourceStates:{formBased:{layers:{layer1:{columnOrder:r,columns:s,indexPatternId:i}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},layers:[{accessors:[$.DegradedDocs],layerId:"layer1",layerType:"data",seriesType:"line",xAccessor:$.Date,...n?{splitAccessor:$.Breakdown}:{yConfig:[{forAccessor:$.DegradedDocs,color:e}]}}],legend:{isVisible:!0,position:"right",legendSize:"large",shouldTruncate:!0},preferredSeriesType:"line",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"custom",lowerBound:0,upperBound:void 0}}}}}({color:t.colors.danger,dataStream:n,datasetTitle:null!==(a=null==c?void 0:c.title)&&void 0!==a?a:n,breakdownFieldName:null==_?void 0:_.name});y(i)}),[null==_?void 0:_.name,t.colors.danger,y,e,null==c?void 0:c.title]);const T=Object(r.useCallback)((()=>{f&&(i(s.Lens,l.Chart),a.navigateToPrefilledEditor({id:"",timeRange:u,attributes:f}))}),[f,i,s,l,a,u]),j=Object(r.useMemo)((()=>({id:"ACTION_OPEN_IN_LENS",type:"link",order:17,getDisplayName:()=>se,getIconType:()=>"visArea",isCompatible:async()=>!0,execute:async()=>T()})),[T]),E=te({dataStreamStat:c,query:{language:"kuery",query:"_ignored:*"},timeRangeConfig:u,breakdownField:null==_?void 0:_.name,telemetry:{page:"details",navigationSource:l.Chart}}),S=[j,Object(r.useMemo)((()=>({id:"ACTION_EXPLORE_IN_LOGS_EXPLORER",type:"link",getDisplayName:()=>null!=E&&E.isLogsExplorerAvailable?ie:re,getHref:async()=>E.linkProps.href,getIconType:()=>"visTable",isCompatible:async()=>!0,execute:async()=>E.navigate(),order:18})),[E])];return{attributes:f,dataView:O,breakdown:{dataViewField:_,fieldSupportsBreakdown:!_||Object(K.fieldSupportsBreakdown)(_),onChange:v},extraActions:S,isChartLoading:b,onChartLoading:e=>{p(e)},setAttributes:y,setIsChartLoading:p}};function le(e){return e?`${Object(H.b)(e).type}-*-*`:o.g}var de=a(89);function ce(){var e,t;const{service:a}=Object(G.b)(),{services:{fieldFormats:s}}=Object(U.c)(),l=null!==(e=Object(n.useSelector)(a,(e=>e.context.flyout.degradedFields)))&&void 0!==e?e:{},{data:d,table:c}=l,{page:u,rowsPerPage:g,sort:m}=c,b={pageIndex:u,pageSize:g,totalItemCount:null!==(t=null==d?void 0:d.length)&&void 0!==t?t:0,hidePerPageOptions:!0},p=Object(r.useCallback)((e=>{var t,n;a.send({type:"UPDATE_DEGRADED_FIELDS_TABLE_CRITERIA",degraded_field_criteria:{page:e.page.index,rowsPerPage:e.page.size,sort:{field:(null===(t=e.sort)||void 0===t?void 0:t.field)||o.f,direction:(null===(n=e.sort)||void 0===n?void 0:n.direction)||o.e}}})}),[a]),f=Object(r.useMemo)((()=>Object(i.orderBy)(d,m.field,m.direction).slice(u*g,(u+1)*g)),[d,m.field,m.direction,u,g]);return{isLoading:Object(n.useSelector)(a,(e=>e.matches("flyout.initializing.dataStreamDegradedFields.fetching"))),pagination:b,onTableChange:p,renderedItems:f,sort:{sort:m},fieldFormats:s}}},63:function(e,t,a){e.exports=a(27)(4)},73:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return g}));var n=a(4),i=a(52),r=a(10),s=a(7),o=a(16),l=a(13),d=a(97);const c=({rawName:e,isLogsExplorer:t,telemetry:a,query:i})=>{const{trackDatasetNavigated:r}=u(),{trackDetailsNavigated:s,navigationTargets:o}=g(),l=Object(n.useCallback)((()=>{if(a){const n=!!i&&JSON.stringify(i).includes("_ignored");"main"===a.page?r(e,n):s(t?o.LogsExplorer:o.Discover,a.navigationSource,n)}}),[t,s,o,i,e,a,r]);return{wrapLinkPropsForTelemetry:Object(n.useCallback)((e=>({...e,onClick:t=>{l(),e.onClick&&e.onClick(t)}})),[l]),sendTelemetry:l}},u=()=>{var e;const{service:t,telemetryClient:a}=Object(l.b)(),s=null!==(e=Object(i.useSelector)(t,(e=>e.context.datasets)))&&void 0!==e?e:{},o=Object(i.useSelector)(t,(e=>e.context.nonAggregatableDatasets)),c=Object(i.useSelector)(t,(e=>e.context.datasetUserPrivileges.canViewIntegrations)),u=Object(i.useSelector)(t,(e=>e.context.table.sort)),g=Object(d.a)(),m=Object(n.useCallback)(((e,t)=>{const n=s.find((t=>t.rawName===e));if(!n)throw new Error(`Cannot report dataset navigation telemetry for unknown dataset ${e}`);{const e=function(e,t,a,n,i,s){var o,l,d,c,u;const{startDate:g,endDate:m}=Object(r.a)(a.timeRange);return{...{index_name:e.rawName,data_stream:{dataset:e.name,namespace:e.namespace,type:e.type},data_stream_health:e.degradedDocs.quality,data_stream_aggregatable:n.some((t=>t===e.rawName)),from:g,to:m,degraded_percentage:e.degradedDocs.percentage,integration:null===(o=e.integration)||void 0===o?void 0:o.name,privileges:{can_monitor_data_stream:null===(l=null===(d=e.userPrivileges)||void 0===d?void 0:d.canMonitor)||void 0===l||l,can_view_integrations:s}},sort:t,filters:{is_degraded:i,query_length:null!==(c=null===(u=a.selectedQuery)||void 0===u?void 0:u.length)&&void 0!==c?c:0,integrations:{total:a.integrations.filter((e=>"none"!==e.name)).length,included:a.integrations.filter((e=>"on"===(null==e?void 0:e.checked))).length,excluded:a.integrations.filter((e=>"off"===(null==e?void 0:e.checked))).length},namespaces:{total:a.namespaces.length,included:a.namespaces.filter((e=>"on"===(null==e?void 0:e.checked))).length,excluded:a.namespaces.filter((e=>"off"===(null==e?void 0:e.checked))).length},qualities:{total:a.qualities.length,included:a.qualities.filter((e=>"on"===(null==e?void 0:e.checked))).length,excluded:a.qualities.filter((e=>"off"===(null==e?void 0:e.checked))).length}}}}(n,u,g,o,t,c);a.trackDatasetNavigated(e)}}),[u,g,c,s,o,a]);return{trackDatasetNavigated:m}},g=()=>{var e;const{service:t,telemetryClient:a}=Object(l.b)(),{dataset:d,datasetDetails:c,insightsTimeRange:u,breakdownField:g,isNonAggregatable:m}=null!==(e=Object(i.useSelector)(t,(e=>e.context.flyout)))&&void 0!==e?e:{},b=Object(i.useSelector)(t,(e=>({dataStreamDetailsLoading:e.matches("flyout.initializing.dataStreamDetails.fetching")}))),p=Object(i.useSelector)(t,(e=>!e.matches("flyout.initializing.integrationDashboards.unauthorized"))),f=Object(i.useSelector)(t,(e=>e.context.datasetUserPrivileges.canViewIntegrations)),y=Object(n.useMemo)((()=>{if(c&&u&&d&&!b.dataStreamDetailsLoading)return function(e,t,a,n,i,o,l){var d,c,u;const g=t.rawName,m={dataset:t.name,namespace:t.namespace,type:t.type},b=null!==(d=null==a?void 0:a.degradedDocsCount)&&void 0!==d?d:0,p=null!==(c=null==a?void 0:a.docsCount)&&void 0!==c?c:0,f=p>0?Number((b/p*100).toFixed(2)):0,y=Object(s.c)(f),{startDate:O,endDate:_}=Object(r.a)(e);return{index_name:g,data_stream:m,privileges:{can_monitor_data_stream:!0,can_view_integrations:i,can_view_dashboards:o},data_stream_aggregatable:!n,data_stream_health:y,from:O,to:_,degraded_percentage:f,integration:null===(u=t.integration)||void 0===u?void 0:u.name,breakdown_field:l}}(u,d,c,null!=m&&m,f,p,g)}),[u,d,c,b.dataStreamDetailsLoading,m,f,p,g]),O=Object(n.useCallback)((()=>{a.startDatasetDetailsTracking()}),[a]);Object(n.useEffect)((()=>{"started"===a.getDatasetDetailsTrackingState()&&y&&a.trackDatasetDetailsOpened(y)}),[y,a]);const _=Object(n.useCallback)(((e,t,n=!1)=>{const i=a.getDatasetDetailsTrackingState();if("opened"!==i&&"navigated"!==i||!y)throw new Error("Cannot report dataset details navigation telemetry without required data and state");a.trackDatasetDetailsNavigated({...y,filters:{is_degraded:n},target:e,source:t})}),[y,a]),v=Object(n.useCallback)(((e,t,a,n=!1)=>({...e,onClick:i=>{_(t,a,n),e.onClick&&e.onClick(i)}})),[_]);return{startTracking:O,trackDetailsNavigated:_,wrapLinkPropsForTelemetry:v,navigationTargets:o.b,navigationSources:o.a}}},81:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=({href:e,onClick:t})=>({href:e,onClick:e=>{e.defaultPrevented||!(e=>!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey))(e)&&(e=>0===e.button)(e)&&(e.preventDefault(),t())}})},88:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r}));var n=a(2),i=a.n(n);let r=function(e){return e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram",e}({}),s=function(e){return e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing",e}({});class kbn_field_type_KbnFieldType{constructor(e={}){i()(this,"name",void 0),i()(this,"sortable",void 0),i()(this,"filterable",void 0),i()(this,"esTypes",void 0),this.name=e.name||s.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}new kbn_field_type_KbnFieldType({name:s.UNKNOWN});new kbn_field_type_KbnFieldType({name:s.STRING,sortable:!0,filterable:!0,esTypes:[r.STRING,r.TEXT,r.MATCH_ONLY_TEXT,r.KEYWORD,r.VERSION,r._TYPE,r._ID]}),new kbn_field_type_KbnFieldType({name:s.NUMBER,sortable:!0,filterable:!0,esTypes:[r.FLOAT,r.HALF_FLOAT,r.SCALED_FLOAT,r.DOUBLE,r.INTEGER,r.LONG,r.UNSIGNED_LONG,r.SHORT,r.BYTE,r.TOKEN_COUNT,r.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:s.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[r.FLOAT_RANGE,r.DOUBLE_RANGE,r.INTEGER_RANGE,r.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:s.DATE,sortable:!0,filterable:!0,esTypes:[r.DATE,r.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:s.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[r.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:s.IP,sortable:!0,filterable:!0,esTypes:[r.IP]}),new kbn_field_type_KbnFieldType({name:s.IP_RANGE,sortable:!0,filterable:!0,esTypes:[r.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:s.BOOLEAN,sortable:!0,filterable:!0,esTypes:[r.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:s.OBJECT,esTypes:[r.OBJECT]}),new kbn_field_type_KbnFieldType({name:s.NESTED,esTypes:[r.NESTED]}),new kbn_field_type_KbnFieldType({name:s.GEO_POINT,esTypes:[r.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:s.GEO_SHAPE,esTypes:[r.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:s.ATTACHMENT,esTypes:[r.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:s.MURMUR3,esTypes:[r.MURMUR3]}),new kbn_field_type_KbnFieldType({name:s._SOURCE,esTypes:[r._SOURCE]}),new kbn_field_type_KbnFieldType({name:s.HISTOGRAM,filterable:!0,esTypes:[r.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:s.CONFLICT})},89:function(e,t,a){"use strict";a.r(t),a.d(t,"useSummaryPanelContext",(function(){return u}));var n=a(121),i=a.n(n),r=a(52),s=a(9),o=a(51),l=a(13),d=a(14);const[c,u]=i()((()=>{const{service:e}=Object(l.b)(),{filteredItems:t,isSizeStatsAvailable:a,canUserMonitorDataset:n,canUserMonitorAnyDataStream:i}=Object(o.d)(),{timeRange:c}=Object(r.useSelector)(e,(e=>e.context.filters)),u={percentages:t.map((e=>e.degradedDocs.percentage))},g=Object(r.useSelector)(e,(e=>e.matches("degradedDocs.fetching"))),m=t.every((e=>{var t,a;return null===(t=null===(a=e.userPrivileges)||void 0===a?void 0:a.canMonitor)||void 0===t||t})),b=n&&i&&m,p={total:t.length,active:Object(d.a)({datasets:t,timeRange:c}).length},f=Object(r.useSelector)(e,(e=>e.matches("datasets.fetching"))),y=t.reduce(((e,t)=>e+s.a.calculateFilteredSize(t)),0);return{datasetsQuality:u,isDatasetsQualityLoading:g,isUserAuthorizedForDataset:b,isEstimatedDataLoading:Object(r.useSelector)(e,(e=>e.matches("datasets.fetching")||e.matches("degradedDocs.fetching"))),estimatedData:y,isEstimatedDataDisabled:!a,isDatasetsActivityLoading:f,datasetsActivity:p}}));t.default=c},91:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="_ignored"},96:function(e,t,a){"use strict";var n=a(81);a.d(t,"a",(function(){return n.a}))}}]);