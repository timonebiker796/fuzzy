(window.dataViewFieldEditor_bundle_jsonpfunction=window.dataViewFieldEditor_bundle_jsonpfunction||[]).push([[1],{106:function(e,t,i){"use strict";i.r(t),i.d(t,"FieldEditorFlyoutContentContainer",(function(){return mt}));var n=i(1),r=i.n(n),o=i(52),a=i(53);const s=({links:e})=>({runtimePainless:e.indexPatterns.runtimeFields,painlessSyntax:e.scriptedFields.painlessLangSpec});var l=i(3);const d=e=>{var t,i,n,r;let o=null===(t=e.caused_by)||void 0===t?void 0:t.reason;const a=((e="")=>e.includes("Cannot cast from")?"CAST_ERROR":"UNKNOWN")(o);return"CAST_ERROR"===a&&(o=`${o} ${l.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditor.castErrorMessage",{defaultMessage:"Verify that you have correctly set the runtime field type."})}`),{message:l.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditor.compileErrorMessage",{defaultMessage:"Error compiling the painless script"}),position:null!==(i=e.position)&&void 0!==i?i:null,scriptStack:null!==(n=e.script_stack)&&void 0!==n?n:[],reason:null!==(r=o)&&void 0!==r?r:null,code:a}};i(26);var u=i(2),c=i(14),f=i(10),m=(i(24),i(0));const p={title:l.i18n.translate("indexPatternFieldEditor.cancelField.confirmationModal.title",{defaultMessage:"Discard changes"}),description:l.i18n.translate("indexPatternFieldEditor.cancelField.confirmationModal.description",{defaultMessage:"Changes that you've made to your field will be discarded, are you sure you want to continue?"}),cancelButton:l.i18n.translate("indexPatternFieldEditor.cancelField.confirmationModal.cancelButtonLabel",{defaultMessage:"Cancel"})},h=({onCancel:e,onConfirm:t})=>Object(m.jsx)(u.EuiConfirmModal,{title:p.title,buttonColor:"danger","data-test-subj":"runtimeFieldModifiedFieldConfirmModal",cancelButtonText:p.cancelButton,confirmButtonText:p.title,onCancel:e,onConfirm:t,maxWidth:600},Object(m.jsx)("p",null,p.description)),v=({fieldName:e,onCancel:t,onConfirm:i})=>{const r=(e=>({cancelButtonText:l.i18n.translate("indexPatternFieldEditor.saveRuntimeField.confirmationModal.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:l.i18n.translate("indexPatternFieldEditor.deleteRuntimeField.confirmationModal.saveButtonLabel",{defaultMessage:"Save changes"}),warningChangingFields:l.i18n.translate("indexPatternFieldEditor.deleteRuntimeField.confirmModal.warningChangingFields",{defaultMessage:"Changing name or type can break searches and visualizations that rely on this field."}),typeConfirm:l.i18n.translate("indexPatternFieldEditor.saveRuntimeField.confirmModal.typeConfirm",{defaultMessage:"Enter CHANGE to continue"}),titleConfirmChanges:l.i18n.translate("indexPatternFieldEditor.saveRuntimeField.confirmModal.title",{defaultMessage:"Save changes to ''{name}''",values:{name:e}})}))(e),[o,a]=Object(n.useState)("");return Object(m.jsx)(u.EuiConfirmModal,{title:r.titleConfirmChanges,"data-test-subj":"runtimeFieldSaveConfirmModal",cancelButtonText:r.cancelButtonText,confirmButtonText:r.confirmButtonText,confirmButtonDisabled:"CHANGE"!==(null==o?void 0:o.toUpperCase()),onCancel:t,onConfirm:i},Object(m.jsx)(u.EuiCallOut,{color:"warning",title:r.warningChangingFields,iconType:"warning",size:"s"}),Object(m.jsx)(u.EuiSpacer,null),Object(m.jsx)(u.EuiFormRow,{label:r.typeConfirm},Object(m.jsx)(u.EuiFieldText,{value:o,onChange:e=>a(e.target.value),"data-test-subj":"saveModalConfirmText"})))};var g=i(20),b=i(6);const x=Object(n.createContext)(void 0),j=({services:e,dataView:t,links:i,uiSettings:r,fieldTypeToProcess:o,fieldFormats:a,fieldFormatEditors:s,namesNotAllowed:l,existingConcreteFields:d,children:u,fieldName$:c,subfields$:f})=>{const p=Object(n.useMemo)((()=>({dataView:t,fieldTypeToProcess:o,links:i,uiSettings:r,services:e,fieldFormats:a,fieldFormatEditors:s,namesNotAllowed:l,existingConcreteFields:d,fieldName$:c,subfields$:f})),[t,o,e,i,r,a,s,l,d,c,f]);return Object(m.jsx)(x.Provider,{value:p},u)},_=()=>{const e=Object(n.useContext)(x);if(void 0===e)throw new Error("useFieldEditorContext must be used within a <FieldEditorContext />");return e};var w=i(54),E=i(68),F=i.n(E),P=i(23),O=i.n(P);function y(e,t,i){const r=Object(n.useMemo)((()=>e.pipe(Object(o.map)(t),Object(o.distinctUntilChanged)(i))),[e,t,i]),a=Object(n.useMemo)((()=>t(e.value)),[t,e]);return O()(r,a)}const S=Object(n.createContext)(void 0),C={name:null,index:null,script:null,document:null,type:null,format:null,parentName:null},I=e=>{var t;const i="object"==typeof e?JSON.stringify(e):null!==(t=String(e))&&void 0!==t?t:"-";return Object(w.renderToString)(Object(m.jsx)(r.a.Fragment,null,i))},M=e=>{const t=typeof e;return"string"===t?"keyword":"number"===t?"double":"boolean"===t?"boolean":"keyword"},T=e=>{const t=e.documents[e.currentIdx];return{currentDocument:t,totalDocs:e.documents.length,currentDocIndex:null==t?void 0:t._index,currentDocId:null==t?void 0:t._id}},R=({controller:e,children:t})=>{const{dataView:i,services:{notifications:r,api:{getFieldPreview:a}},fieldName$:s}=_(),u=Object(n.useRef)(new o.BehaviorSubject(void 0)),[c,f]=Object(n.useState)(C),[p,h]=Object(n.useState)({isValidating:!1,isValid:!0,message:null}),{currentDocument:v,currentDocIndex:b,currentDocId:x}=y(e.state$,T),{name:j,document:w,script:E,format:P,type:O,parentName:M}=c,R=Object(n.useCallback)((e=>{f((t=>({...t,...e})))}),[]),L=Object(n.useCallback)((async()=>{var t;if(!M&&p.isValidating)return;if(!(M||e.allParamsDefined(O,null==E?void 0:E.source,b)&&e.hasSomeParamsChanged(O,null==E?void 0:E.source,x)&&!1!==p.isValid))return void e.setIsLoadingPreview(!1);if(!b)return void e.setIsLoadingPreview(!1);e.setLastExecutePainlessRequestParams({type:O,script:null==E?void 0:E.source,documentId:x});const n=e.incrementPreviewCount(),o=M&&(null===(t=i.getRuntimeField(M))||void 0===t?void 0:t.script)||E,c=await a({index:b,document:null==w?void 0:w._source,context:M?"composite_field":`${O}_field`,script:o});if(n!==e.getPreviewCount())return;const{error:f}=c;if(f){const t=l.i18n.translate("indexPatternFieldEditor.fieldPreview.errorTitle",{defaultMessage:"Failed to load field preview"});return r.toasts.addError(f,{title:t}),void e.setIsLoadingPreview(!1)}if(c.data){const{values:t,error:i}=c.data;i?e.setPreviewResponse({fields:[{key:null!=j?j:"",value:"",formattedValue:I("")}],error:{code:"PAINLESS_SCRIPT_ERROR",error:d(i)}}):Array.isArray(t)?e.updateSingleFieldPreview(j,t,O,P):e.updateCompositeFieldPreview(t,M,j,s.getValue(),O,P,(e=>u.current.next(e)))}e.setInitialPreviewComplete(!0),e.setIsLoadingPreview(!1)}),[j,O,E,M,i,w,x,a,r.toasts,p,b,e,P,s]),D=Object(n.useMemo)((()=>({controller:e,fieldPreview$:u.current,params:{value:c,update:R},validation:{setScriptEditorValidation:h}})),[e,u,c,R]);return Object(n.useEffect)((()=>{R({document:v,index:null==v?void 0:v._index})}),[v,R]),Object(n.useEffect)((()=>{const{previewResponse:t}=e.state$.getValue(),{fields:i}=t;let n=i.map((e=>{let t=null!=j?j:"";if("composite"===O){const{1:i}=e.key.split(".");t=`${null!=j?j:""}.${i}`}return{...e,key:t}}));0===n.length&&null!==j&&(n=[{key:j,value:void 0,formattedValue:void 0,type:void 0}]),e.setPreviewResponse({...t,fields:n})}),[j,O,M,e]),Object(n.useEffect)((()=>{const{previewResponse:t}=e.state$.getValue(),{fields:i}=t;e.setPreviewResponse({...t,fields:i.map((t=>{const i="concrete"===e.getInternalFieldType()?Object(g.get)(null==w?void 0:w.fields,null!=j?j:""):null===E&&Boolean(w)?Object(g.get)(null==w?void 0:w._source,null!=j?j:""):null==t?void 0:t.value,n=e.valueFormatter({value:i,type:O,format:P});return{...t,value:i,formattedValue:n}}))})}),[j,E,w,e,O,P]),Object(n.useEffect)((()=>{void 0===(null==E?void 0:E.source)&&(e.setLastExecutePainlessRequestParams({script:void 0}),e.setPreviewError(null))}),[null==E?void 0:E.source,e]),Object(n.useEffect)((()=>{if(!p.isValidating)if(!1===p.isValid){var t;e.setIsLoadingPreview(!1);const i=void 0===(null==E?void 0:E.source)?null:{code:"PAINLESS_SYNTAX_ERROR",error:{reason:null!==(t=p.message)&&void 0!==t?t:l.i18n.translate("indexPatternFieldEditor.fieldPreview.error.painlessSyntax",{defaultMessage:"Invalid Painless syntax"})}};e.setPreviewError(i),e.setLastExecutePainlessRequestParams({script:null==E?void 0:E.source})}else e.clearPreviewError("PAINLESS_SYNTAX_ERROR")}),[p,null==E?void 0:E.source,e]),F()(L,500,[L]),Object(m.jsx)(S.Provider,{value:D},t)},L=()=>{const e=Object(n.useContext)(S);if(void 0===e)throw new Error("useFieldPreviewContext must be used within a <FieldPreviewProvider />");return e},D=()=>Object(m.jsx)("div",{"data-test-subj":"isUpdatingIndicator"},Object(m.jsx)(u.EuiFlexGroup,{gutterSize:"xs"},Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiLoadingSpinner,{size:"m"})),Object(m.jsx)(u.EuiFlexItem,{grow:!1},l.i18n.translate("indexPatternFieldEditor.fieldPreview.updatingPreviewLabel",{defaultMessage:"Updating..."})))),V={title:l.i18n.translate("indexPatternFieldEditor.fieldPreview.title",{defaultMessage:"Preview"}),customData:l.i18n.translate("indexPatternFieldEditor.fieldPreview.subTitle.customData",{defaultMessage:"Custom data"})},k=e=>e.isLoadingDocuments,N=e=>e.documentSource,z=()=>{const{dataView:e}=_(),{controller:t}=L(),i=y(t.state$,k),n=y(t.state$,N);return Object(m.jsx)("div",null,Object(m.jsx)(u.EuiFlexGroup,{alignItems:"center"},Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiTitle,{size:"s"},Object(m.jsx)("h2",{"data-test-subj":"title"},V.title))),i&&Object(m.jsx)(u.EuiFlexItem,{"data-test-subj":"isFetchingDocumentIndicator"},Object(m.jsx)(D,null))),Object(m.jsx)(u.EuiText,null,Object(m.jsx)(u.EuiTextColor,{color:"subdued","data-test-subj":"subTitle"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.subTitle",{defaultMessage:"From: {documentSource}",values:{documentSource:"cluster"===n?e.getIndexPattern():V.customData}}))))},B=()=>Object(m.jsx)(u.EuiFlexGroup,{style:{height:"100%"},"data-test-subj":"emptyPrompt"},Object(m.jsx)(u.EuiFlexItem,null,Object(m.jsx)(u.EuiEmptyPrompt,{iconType:"inspect",title:Object(m.jsx)("h2",null,l.i18n.translate("indexPatternFieldEditor.fieldPreview.emptyPromptTitle",{defaultMessage:"Preview"})),titleSize:"s",body:Object(m.jsx)(u.EuiText,{size:"s"},Object(m.jsx)(u.EuiTextColor,{color:"subdued"},Object(m.jsx)("p",null,l.i18n.translate("indexPatternFieldEditor.fieldPreview.emptyPromptDescription",{defaultMessage:"Enter the name of an existing field or define a script to view a preview of the calculated output."}))))}))),A=e=>{const t=e.documents[e.currentIdx];return{documentId:t?t._id:void 0,customId:e.customId}},W=e=>e.fetchDocError,$=()=>{const{controller:e}=L(),{goToPreviousDocument:t,goToNextDocument:i}=e,{documentId:r,customId:o}=y(e.state$,A),a=y(e.state$,W),s="DOC_NOT_FOUND"===(null==a?void 0:a.code),d=!o,c=Object(n.useCallback)((t=>{const i=t.target.value;e.setCustomDocIdToLoad(i)}),[e]);return Object(m.jsx)("div",null,Object(m.jsx)(u.EuiFlexGroup,{gutterSize:"s"},Object(m.jsx)(u.EuiFlexItem,null,Object(m.jsx)(u.EuiFormRow,{label:l.i18n.translate("indexPatternFieldEditor.fieldPreview.documentIdField.label",{defaultMessage:"Document ID"}),isInvalid:s,fullWidth:!0},Object(m.jsx)(u.EuiFieldText,{isInvalid:s,value:o||r||"",onChange:c,fullWidth:!0,"data-test-subj":"documentIdField"})),o&&Object(m.jsx)("span",null,Object(m.jsx)(u.EuiButtonEmpty,{color:"primary",size:"xs",flush:"left",onClick:()=>e.fetchSampleDocuments(),"data-test-subj":"loadDocsFromClusterButton"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.documentIdField.loadDocumentsFromCluster",{defaultMessage:"Load documents from cluster"})))),d&&Object(m.jsx)(u.EuiFlexItem,{grow:!1,"data-test-subj":"documentsNav"},Object(m.jsx)(u.EuiFlexGroup,{gutterSize:"s",alignItems:"flexEnd"},Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiButtonIcon,{display:"base",size:"m",onClick:t,iconType:"arrowLeft","data-test-subj":"goToPrevDocButton","aria-label":l.i18n.translate("indexPatternFieldEditor.fieldPreview.documentNav.previousArialabel",{defaultMessage:"Previous document"})})),Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiButtonIcon,{display:"base",size:"m",onClick:i,iconType:"arrowRight","data-test-subj":"goToNextDocButton","aria-label":l.i18n.translate("indexPatternFieldEditor.fieldPreview.documentNav.nextArialabel",{defaultMessage:"Next document"})}))))))},U=e=>e.fetchDocError,H=()=>{var e;const{controller:t}=L(),i=y(t.state$,U);return null===i?null:Object(m.jsx)(u.EuiCallOut,{title:l.i18n.translate("indexPatternFieldEditor.fieldPreview.errorCallout.title",{defaultMessage:"Error fetching document"}),color:"danger",iconType:"error",role:"alert","data-test-subj":"fetchDocError"},Object(m.jsx)("p",{"data-test-subj":"title"},null!==(e=i.error.message)&&void 0!==e?e:i.error.reason))};var q=i(55),G=i.n(q);const J=e=>{const t=new RegExp("max-width:[^;]+;","gm");return t.test(e)?e.replace(t,"max-width: 100%;"):e},Y=({imgHTML:e,closeModal:t})=>Object(m.jsx)(u.EuiModal,{onClose:t},Object(m.jsx)(u.EuiModalBody,null,Object(m.jsx)("div",{className:"indexPatternFieldEditor__previewImageModal__wrapper",dangerouslySetInnerHTML:{__html:J(e)}}))),X=e=>e.isLoadingPreview,K=({field:{key:e,value:t,formattedValue:i,isPinned:o=!1},toggleIsPinned:a,hasScriptError:s,isFromScript:d=!1})=>{const{controller:c}=L(),f=y(c.state$,X),[p,h]=Object(n.useState)(!1),v=G()("indexPatternFieldEditor__previewFieldList__item",{"indexPatternFieldEditor__previewFieldList__item--highlighted":d,"indexPatternFieldEditor__previewFieldList__item--pinned":o}),g=null==i?void 0:i.includes("<img");return Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFlexGroup,{className:v,gutterSize:"none","data-test-subj":"listItem"},Object(m.jsx)(u.EuiFlexItem,{className:"indexPatternFieldEditor__previewFieldList__item__key"},Object(m.jsx)("div",{className:"indexPatternFieldEditor__previewFieldList__item__key__wrapper","data-test-subj":"key"},d&&!Boolean(e)?Object(m.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList--ligthWeight"},Object(m.jsx)(u.EuiTextColor,{color:"subdued"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.fieldNameNotSetLabel",{defaultMessage:"Field name not set"}))):e)),Object(m.jsx)(u.EuiFlexItem,{className:"indexPatternFieldEditor__previewFieldList__item__value","data-test-subj":"value"},d&&f?Object(m.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList--ligthWeight"},Object(m.jsx)(D,null)):s?Object(m.jsx)("div",null,Object(m.jsx)(u.EuiBadge,{iconType:"warning",color:"danger","data-test-subj":"scriptErrorBadge"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.scriptErrorBadgeLabel",{defaultMessage:"Script error"}))):d&&void 0===t?Object(m.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList--ligthWeight"},Object(m.jsx)(u.EuiTextColor,{color:"subdued"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.valueNotSetLabel",{defaultMessage:"Value not set"}))):g?Object(m.jsx)(u.EuiButtonEmpty,{color:"text",onClick:()=>h(!0),iconType:"image"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.viewImageButtonLabel",{defaultMessage:"View image"})):(b=void 0!==i?Object(m.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList__item__value__wrapper",dangerouslySetInnerHTML:{__html:i}}):Object(m.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList__item__value__wrapper"},JSON.stringify(t)),Object(m.jsx)(u.EuiToolTip,{position:"top",content:"string"!=typeof t?JSON.stringify(t):t},b))),Object(m.jsx)(u.EuiFlexItem,{className:"indexPatternFieldEditor__previewFieldList__item__actions",grow:!1},a&&Object(m.jsx)(u.EuiButtonIcon,{onClick:()=>{a(e)},color:"text",iconType:"pinFilled","data-test-subj":"pinFieldButton","aria-label":l.i18n.translate("indexPatternFieldEditor.fieldPreview.pinFieldButtonLabel",{defaultMessage:"Pin field"}),className:"indexPatternFieldEditor__previewFieldList__item__actionsBtn"}))),p&&Object(m.jsx)(Y,{imgHTML:i,closeModal:()=>h(!1)}));var b};var Q=i(75);function Z(e){return e.replace(/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}i(70);const ee=e=>e.pinnedFields,te=e=>e.documents[e.currentIdx],ie=r.a.memo((({data:e,index:t,style:i})=>{const{filteredFields:n,toggleIsPinned:r}=e,o=n[t];return Object(m.jsx)("div",{key:o.key,style:i,"data-test-subj":"indexPatternFieldList"},Object(m.jsx)(K,{key:o.key,field:o,toggleIsPinned:r}))}),Q.areEqual),ne=({height:e,clearSearch:t,searchValue:i=""})=>{const{dataView:o}=_(),{controller:a}=L(),s=y(a.state$,ee,g.isEqual),d=y(a.state$,te),[c,f]=Object(n.useState)(!1),p=Object(n.useMemo)((()=>o.fields.getAll().map((e=>{const{name:t,displayName:i}=e,n=o.getFormatterForField(e),r=Object(g.get)(null==d?void 0:d.fields,t);return{key:i,value:r,formattedValue:n.convert(r,"html"),isPinned:!1}})).filter((({value:e})=>void 0!==e))),[o,null==d?void 0:d.fields]),h=Object(n.useMemo)((()=>{const e=[],t=[];return p.forEach((i=>{s[i.key]?e.push({...i,isPinned:!0}):t.push({...i,isPinned:!1})})),[...e,...t]}),[p,s]),{filteredFields:v,totalFields:b}=Object(n.useMemo)((()=>{const e=""===i.trim()?h:h.filter((({key:e})=>function(e,t){const i=`.*${e.split("").map(Z).join(".*")}.*`;return new RegExp(i,"i").test(t)}(i,e))),t=e.length;return c?{filteredFields:e,totalFields:t}:{filteredFields:e.filter(((e,t)=>t<7)),totalFields:t}}),[h,c,i]),x=""!==i.trim()&&0===b,j=Math.min(40*v.length,e-40),w=Object(n.useCallback)((()=>{f((e=>!e))}),[]),E=Object(n.useMemo)((()=>({filteredFields:v,toggleIsPinned:a.togglePinnedField})),[v,a.togglePinnedField]);return void 0===d||-1===e?null:Object(m.jsx)("div",{className:"indexPatternFieldEditor__previewFieldList"},x?Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiSpacer,null),Object(m.jsx)(u.EuiEmptyPrompt,{iconType:"search",title:Object(m.jsx)(u.EuiTextColor,{color:"subdued"},Object(m.jsx)("h3",{className:"indexPatternFieldEditor__previewEmptySearchResult__title"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.searchResult.emptyPromptTitle",{defaultMessage:"No matching fields in this data view"}))),titleSize:"xs",actions:Object(m.jsx)(u.EuiButton,{onClick:t,"data-test-subj":"clearSearchButton"},l.i18n.translate("indexPatternFieldEditor.fieldPreview.searchResult.emptyPrompt.clearSearchButtonLabel",{defaultMessage:"Clear search"})),"data-test-subj":"emptySearchResult"})):Object(m.jsx)(Q.FixedSizeList,{className:"eui-scrollBar",style:{overflowX:"hidden"},width:"100%",height:j,itemData:E,itemCount:v.length,itemSize:40},ie),b<=7?null:Object(m.jsx)("div",{className:"indexPatternFieldEditor__previewFieldList__showMore"},Object(m.jsx)(u.EuiButtonEmpty,{onClick:w,flush:"left"},c?l.i18n.translate("indexPatternFieldEditor.fieldPreview.showLessFieldsButtonLabel",{defaultMessage:"Show less"}):l.i18n.translate("indexPatternFieldEditor.fieldPreview.showMoreFieldsButtonLabel",{defaultMessage:"Show more"}))))};i(80);const re=e=>e.previewResponse,oe=e=>e.fetchDocError,ae=e=>e.isLoadingPreview,se=e=>e.isPreviewAvailable,le=()=>{const[e,t]=Object(n.useState)(-1),[i,o]=Object(n.useState)(""),{params:{value:{name:a,script:s,format:d}},controller:c}=L(),{fields:f,error:p}=y(c.state$,re),h=y(c.state$,oe),v=y(c.state$,ae),g=y(c.state$,se);let b=!1;const x=null===a&&null===s&&null===d,j=null!==p||f.length>0;x?b=!0:j||v||null!==a||null!==d||(b=!0);const _=null===h,w=!1===g&&null===h,E=Object(n.useCallback)((({height:e})=>{t(e)}),[]);return Object(m.jsx)("div",{className:"indexPatternFieldEditor__previewPannel",tabIndex:0},b?Object(m.jsx)(B,null):Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(z,null),Object(m.jsx)(u.EuiSpacer,null),w?Object(m.jsx)(u.EuiCallOut,{title:l.i18n.translate("indexPatternFieldEditor.fieldPreview.notAvailableWarningCallout.title",{defaultMessage:"Preview not available"}),color:"warning",iconType:"warning",role:"alert","data-test-subj":"previewNotAvailableCallout"},Object(m.jsx)("p",null,l.i18n.translate("indexPatternFieldEditor.fieldPreview.notAvailableWarningCallout.description",{defaultMessage:"Runtime field preview is disabled because no documents could be fetched from the cluster."}))):Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)($,null),Object(m.jsx)(u.EuiSpacer,{size:"s"}),_&&Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFieldSearch,{value:i,onChange:e=>o(e.target.value),placeholder:l.i18n.translate("indexPatternFieldEditor.fieldPreview.filterFieldsPlaceholder",{defaultMessage:"Filter fields"}),fullWidth:!0,"data-test-subj":"filterFieldsInput"}),Object(m.jsx)(u.EuiSpacer,{size:"s"})),Object(m.jsx)(H,null),Object(m.jsx)(u.EuiSpacer,{size:"s"}),_&&Object(m.jsx)(r.a.Fragment,null,0===f.length?null:Object(m.jsx)("ul",null,f.map(((e,t)=>Object(m.jsx)("li",{key:t,"data-test-subj":"fieldPreviewItem"},Object(m.jsx)(K,{field:e,isFromScript:!0,hasScriptError:Boolean(p)}))))),Object(m.jsx)(u.EuiResizeObserver,{onResize:E},(t=>Object(m.jsx)("div",{ref:t,style:{flex:1}},Object(m.jsx)(ne,{height:e,clearSearch:()=>o(""),searchValue:i,key:e}))))))))},de=[{label:"Keyword",value:"keyword"},{label:"Long",value:"long"},{label:"Double",value:"double"},{label:"Date",value:"date"},{label:"IP",value:"ip"},{label:"Boolean",value:"boolean"},{label:"Geo point",value:"geo_point"}],ue=[...de,{label:"Composite",value:"composite"}];var ce=i(56);const{containsCharsField:fe,emptyField:me,numberGreaterThanField:pe,maxLengthField:he}=b.j,ve={invalidScriptErrorMessage:l.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditorPainlessValidationMessage",{defaultMessage:"Invalid Painless script."})},ge={name:{label:l.i18n.translate("indexPatternFieldEditor.editor.form.nameLabel",{defaultMessage:"Name"}),validations:[{validator:me(l.i18n.translate("indexPatternFieldEditor.editor.form.validations.nameIsRequiredErrorMessage",{defaultMessage:"A name is required."}))},{validator:fe({message:l.i18n.translate("indexPatternFieldEditor.editor.form.validations.starCharacterNotAllowedValidationErrorMessage",{defaultMessage:"The field cannot have * in the name."}),chars:"*"})}]},type:{label:l.i18n.translate("indexPatternFieldEditor.editor.form.runtimeTypeLabel",{defaultMessage:"Type"}),defaultValue:[ue[0]],fieldsToValidateOnChange:["script.source"]},script:{source:{label:l.i18n.translate("indexPatternFieldEditor.editor.form.defineFieldLabel",{defaultMessage:"Define script"}),validations:[{validator:me(l.i18n.translate("indexPatternFieldEditor.editor.form.validations.scriptIsRequiredErrorMessage",{defaultMessage:"A script is required to set the field value."}))},{validator:async({customData:{provider:e}})=>{const t=await e();if(t&&"PAINLESS_SCRIPT_ERROR"===t.code)return{message:ve.invalidScriptErrorMessage}},isAsync:!0}]}},customLabel:{label:l.i18n.translate("indexPatternFieldEditor.editor.form.customLabelLabel",{defaultMessage:"Custom label"}),validations:[{validator:me(l.i18n.translate("indexPatternFieldEditor.editor.form.validations.customLabelIsRequiredErrorMessage",{defaultMessage:"Give a label to the field."}))}]},customDescription:{label:l.i18n.translate("indexPatternFieldEditor.editor.form.customDescriptionLabel",{defaultMessage:"Custom description"}),validations:[{validator:me(l.i18n.translate("indexPatternFieldEditor.editor.form.validations.customDescriptionIsRequiredErrorMessage",{defaultMessage:"Give a description to the field."}))},{validator:he({length:ce.MAX_DATA_VIEW_FIELD_DESCRIPTION_LENGTH,message:l.i18n.translate("indexPatternFieldEditor.editor.form.validations.customDescriptionMaxLengthErrorMessage",{values:{length:ce.MAX_DATA_VIEW_FIELD_DESCRIPTION_LENGTH},defaultMessage:"The length of the description is too long. The maximum length is {length} characters."})})}]},popularity:{label:l.i18n.translate("indexPatternFieldEditor.editor.form.popularityLabel",{defaultMessage:"Popularity"}),validations:[{validator:me(l.i18n.translate("indexPatternFieldEditor.editor.form.validations.popularityIsRequiredErrorMessage",{defaultMessage:"Give a popularity to the field."}))},{validator:pe({than:0,allowEquality:!0,message:l.i18n.translate("indexPatternFieldEditor.editor.form.validations.popularityGreaterThan0ErrorMessage",{defaultMessage:"The popularity must be zero or greater."})})}]},fields:{defaultValue:{}},__meta__:{isCustomLabelVisible:{defaultValue:!1},isCustomDescriptionVisible:{defaultValue:!1},isValueVisible:{defaultValue:!1},isFormatVisible:{defaultValue:!1},isPopularityVisible:{defaultValue:!1}}};let be=function(e){return e.UPSERT="upsert",e.DELETE="delete",e}({});const xe=e=>({value:t})=>e.fields.includes(t)?{message:l.i18n.translate("indexPatternFieldEditor.editor.runtimeFieldsEditor.existRuntimeFieldNamesValidationErrorMessage",{defaultMessage:"A field with this name already exists."})}:e.runtimeComposites.includes(t)?{message:l.i18n.translate("indexPatternFieldEditor.editor.runtimeFieldsEditor.existCompositeNamesValidationErrorMessage",{defaultMessage:"A runtime composite with this name already exists."})}:void 0,je=({isDisabled:e=!1,includeComposite:t,path:i,defaultValue:n=[de[0]]})=>Object(m.jsx)(b.h,{path:i},(({label:i,value:o,setValue:a})=>void 0===o?null:Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFormRow,{label:i,fullWidth:!0},Object(m.jsx)(u.EuiComboBox,{placeholder:l.i18n.translate("indexPatternFieldEditor.editor.form.runtimeType.placeholderLabel",{defaultMessage:"Select a type"}),singleSelection:{asPlainText:!0},options:t?ue:de,selectedOptions:o||n,onChange:e=>{0!==e.length&&a(e)},isClearable:!1,isDisabled:e,"data-test-subj":"typeField","aria-label":l.i18n.translate("indexPatternFieldEditor.editor.form.typeSelectAriaLabel",{defaultMessage:"Type select"}),fullWidth:!0}))))),_e=()=>Object(m.jsx)(b.h,{path:"customLabel",component:b.f}),we=()=>Object(m.jsx)(b.h,{path:"customDescription",component:b.e}),Ee=()=>Object(m.jsx)(b.h,{path:"popularity",component:b.d,componentProps:{euiFieldProps:{"data-test-subj":"editorFieldCount"}}}),Fe=e=>{switch(e){case"keyword":default:return"string_script_field_script_field";case"long":return"long_script_field_script_field";case"double":return"double_script_field_script_field";case"date":return"date_script_field";case"ip":return"ip_script_field_script_field";case"boolean":return"boolean_script_field_script_field"}},Pe=e=>e.documents[e.currentIdx],Oe=e=>e.isLoadingDocuments,ye=e=>{var t;return null===(t=e.previewResponse)||void 0===t?void 0:t.error},Se=e=>e.isLoadingPreview,Ce=e=>e.isPreviewAvailable,Ie=({existingConcreteFields:e,links:t,placeholder:i})=>{const{validation:{setScriptEditorValidation:s}}=L(),d=Object(n.useRef)(null),f=Object(n.useRef)(),p=Object(n.useRef)(""),{controller:h}=L(),v=y(h.state$,ye),g=y(h.state$,Pe),x=y(h.state$,Oe),j=y(h.state$,Se),_=y(h.state$,Ce),[w,E]=Object(b.m)(void 0),[F,P]=Object(n.useState)(Fe(ge.type.defaultValue[0].value)),O=null==g?void 0:g._id,S=Object(n.useMemo)((()=>a.PainlessLang.getSuggestionProvider(F,e)),[F,e]),{validateFields:C}=Object(b.o)(),I=Object(n.useCallback)((({type:e})=>{void 0!==e&&P(Fe(e[0].value)),_&&E(void 0)}),[E,_]);Object(b.p)({watch:["type","script.source"],onChange:I});const M=Object(n.useCallback)((async()=>(await Object(o.firstValueFrom)(w.pipe(Object(o.first)((e=>void 0!==e&&!e.isFetchingDoc&&!e.isLoadingPreview))))).error),[w]),T=Object(n.useCallback)((e=>{d.current=e,f.current&&f.current.unsubscribe(),f.current=a.PainlessLang.validation$().subscribe((({isValid:e,isValidating:t,errors:i})=>{var n,r;s({isValid:e,isValidating:t,message:null!==(n=null===(r=i[0])||void 0===r?void 0:r.message)&&void 0!==n?n:null})}))}),[s]),R=Object(n.useCallback)((e=>{var t;const i=null===(t=d.current)||void 0===t?void 0:t.getModel();i&&a.monaco.editor.setModelMarkers(i,a.PainlessLang.ID,e)}),[]),D=Object(n.useCallback)((e=>{var t;const i=null===(t=d.current)||void 0===t?void 0:t.getModel();if(null!==e.position&&Boolean(i)){const{offset:t}=e.position,n=(({reason:e},t)=>({startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:t.lineNumber,endColumn:t.column+1,message:e,severity:a.monaco.MarkerSeverity.Error}))(e,i.getPositionAt(t));R(n?[n]:[])}}),[R]);return Object(n.useEffect)((()=>{""!==p.current.trim()&&void 0!==O&&C(["script.source"])}),[O,C]),Object(n.useEffect)((()=>{E({isFetchingDoc:x,isLoadingPreview:j,error:v})}),[E,x,j,v]),Object(n.useEffect)((()=>{"PAINLESS_SCRIPT_ERROR"===(null==v?void 0:v.code)?D(v.error):null===v&&R([])}),[v,D,R]),Object(n.useEffect)((()=>()=>{f.current&&f.current.unsubscribe()}),[]),Object(m.jsx)(b.h,{path:"script.source",validationDataProvider:M},(({value:e,setValue:n,label:o,isValid:s,getErrorsMessages:d})=>{let f=d();return v&&(f=v.error.reason),p.current=e,Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFormRow,{label:o,hasChildLabel:!1,id:"runtimeFieldScript",error:f,isInvalid:!s,"data-test-subj":"scriptFieldRow",helpText:Object(m.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.form.source.scriptFieldHelpText",defaultMessage:"Runtime fields without a script retrieve values from {source}. If the field doesn't exist in _source, a search request returns no value. {learnMoreLink}",values:{learnMoreLink:Object(m.jsx)(u.EuiLink,{href:t.runtimePainless,target:"_blank",external:!0,"data-test-subj":"painlessSyntaxLearnMoreLink"},l.i18n.translate("indexPatternFieldEditor.editor.form.script.learnMoreLinkText",{defaultMessage:"Learn about script syntax."})),source:Object(m.jsx)(u.EuiCode,null,"_source")}}),fullWidth:!0},Object(m.jsx)(b.a,{languageId:a.PainlessLang.ID,suggestionProvider:S,width:"99%",height:"210px",value:e,onChange:n,editorDidMount:T,options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0,suggest:{snippetsPreventQuickSuggestions:!1}},"data-test-subj":"scriptField","aria-label":l.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditorAriaLabel",{defaultMessage:"Script editor"}),placeholder:i})))}))},Me=r.a.memo(Ie);var Te=i(25);const Re=()=>{const{dataView:e,uiSettings:t,fieldFormats:i,fieldFormatEditors:o}=_(),a=Object(n.useRef)(!1),[{type:s}]=Object(b.p)({watch:["name","type"]}),{getFields:l,isSubmitted:d}=Object(b.o)(),[c,f]=Object(n.useState)(),p=s.reduce(((e,t)=>(void 0!==t.value&&e.push(t.value),e)),[]);return Object(n.useEffect)((()=>{void 0===c?l().format.setErrors([]):l().format.setErrors([{message:c}])}),[c,l]),Object(n.useEffect)((()=>{a.current&&l().format.reset(),a.current=!0}),[s,l]),Object(m.jsx)(b.h,{path:"format"},(({setValue:n,errors:a,value:s})=>Object(m.jsx)(r.a.Fragment,null,d&&a.length>0&&Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiCallOut,{title:a.map((e=>e.message)),color:"danger",iconType:"cross","data-test-subj":"formFormatError"}),Object(m.jsx)(u.EuiSpacer,{size:"m"})),Object(m.jsx)(Te.a,{esTypes:p||["keyword"],indexPattern:e,fieldFormatEditors:o,fieldFormats:i,uiSettings:t,onChange:n,onError:f,value:s,key:p.join(", ")}))))},Le=({children:e})=>{const[t,i]=Object(n.useState)(!1);return Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiButtonEmpty,{onClick:()=>{i(!t)},flush:"left","data-test-subj":"toggleAdvancedSetting"},t?l.i18n.translate("indexPatternFieldEditor.editor.form.advancedSettings.hideButtonLabel",{defaultMessage:"Hide advanced settings"}):l.i18n.translate("indexPatternFieldEditor.editor.form.advancedSettings.showButtonLabel",{defaultMessage:"Show advanced settings"})),Object(m.jsx)("div",{style:{display:t?"block":"none"},"data-test-subj":"advancedSettings"},Object(m.jsx)(u.EuiSpacer,{size:"m"}),Object(m.jsx)("div",null,e)))},De=({title:e,description:t,children:i,formFieldPath:n,withDividerRule:o=!1,"data-test-subj":a})=>{const[s]=Object(b.p)({watch:n}),l=Boolean(Object(g.get)(s,n));return Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFlexGroup,{"data-test-subj":null!=a?a:"formRow"},Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(b.h,{path:n,component:b.g,componentProps:{euiFieldProps:{label:e,showLabel:!1,"data-test-subj":"toggle"}}})),Object(m.jsx)(u.EuiFlexItem,null,Object(m.jsx)("div",null,Object(m.jsx)(u.EuiTitle,{size:"xs"},Object(m.jsx)("h3",null,e)),Object(m.jsx)(u.EuiSpacer,{size:"xs"}),Object(m.jsx)(u.EuiText,{size:"s",color:"subdued"},t),l&&Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiSpacer,{size:"l"}),i)))),o&&Object(m.jsx)(u.EuiHorizontalRule,null))},Ve=({})=>{const{links:e,existingConcreteFields:t,fieldTypeToProcess:i}=_(),n={customLabel:{title:l.i18n.translate("indexPatternFieldEditor.editor.form.customLabelTitle",{defaultMessage:"Set custom label"}),description:l.i18n.translate("indexPatternFieldEditor.editor.form.customLabelDescription",{defaultMessage:"Create a label to display in place of the field name in Discover, Maps, Lens, Visualize, and TSVB. Useful for shortening a long field name. Queries and filters use the original field name."})},customDescription:{title:l.i18n.translate("indexPatternFieldEditor.editor.form.customDescriptionTitle",{defaultMessage:"Set custom description"}),description:l.i18n.translate("indexPatternFieldEditor.editor.form.customDescriptionDescription",{defaultMessage:"Add a description to the field. It's displayed next to the field on the Discover, Lens, and Data View Management pages."})},value:{title:l.i18n.translate("indexPatternFieldEditor.editor.form.valueTitle",{defaultMessage:"Set value"}),description:Object(m.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.form.valueDescription",defaultMessage:"Set a value for the field instead of retrieving it from the field with the same name in {source}.",values:{source:Object(m.jsx)(u.EuiCode,null,"_source")}})},format:{title:l.i18n.translate("indexPatternFieldEditor.editor.form.formatTitle",{defaultMessage:"Set format"}),description:l.i18n.translate("indexPatternFieldEditor.editor.form.formatDescription",{defaultMessage:"Set your preferred format for displaying the value. Changing the format can affect the value and prevent highlighting in Discover."})},popularity:{title:l.i18n.translate("indexPatternFieldEditor.editor.form.popularityTitle",{defaultMessage:"Set popularity"}),description:l.i18n.translate("indexPatternFieldEditor.editor.form.popularityDescription",{defaultMessage:"Adjust the popularity to make the field appear higher or lower in the fields list.  By default, Discover orders fields from most selected to least selected."})}};return Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(De,{title:n.customLabel.title,description:n.customLabel.description,formFieldPath:"__meta__.isCustomLabelVisible","data-test-subj":"customLabelRow",withDividerRule:!0},Object(m.jsx)(_e,null)),Object(m.jsx)(De,{title:n.customDescription.title,description:n.customDescription.description,formFieldPath:"__meta__.isCustomDescriptionVisible","data-test-subj":"customDescriptionRow",withDividerRule:!0},Object(m.jsx)(we,null)),"runtime"===i&&Object(m.jsx)(De,{title:n.value.title,description:n.value.description,formFieldPath:"__meta__.isValueVisible","data-test-subj":"valueRow",withDividerRule:!0},Object(m.jsx)(Me,{existingConcreteFields:t,links:e})),Object(m.jsx)(De,{title:n.format.title,description:n.format.description,formFieldPath:"__meta__.isFormatVisible","data-test-subj":"formatRow",withDividerRule:!0},Object(m.jsx)(Re,null)),Object(m.jsx)(Le,null,Object(m.jsx)(De,{title:n.popularity.title,description:n.popularity.description,formFieldPath:"__meta__.isPopularityVisible","data-test-subj":"popularityRow",withDividerRule:!0},Object(m.jsx)(Ee,null))))},ke=({onReset:e})=>{const{links:t,existingConcreteFields:i,subfields$:n}=_(),o=O()(n)||{};return Object(m.jsx)("div",{"data-test-subj":"compositeEditor"},Object(m.jsx)(Me,{existingConcreteFields:i,links:t,placeholder:"emit('field_name', 'hello world');"}),Object(m.jsx)(u.EuiSpacer,{size:"xl"}),Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"spaceBetween"},Object(m.jsx)(u.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiText,{size:"s"},Object(m.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.compositeFieldsCount",defaultMessage:"Generated fields"}))),Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiNotificationBadge,{color:"subdued"},Object.entries(o).length))),Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiButtonEmpty,{flush:"right",iconType:"refresh",onClick:e},Object(m.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.compositeRefreshTypes",defaultMessage:"Reset"})))),Object.entries(o).map((([e,t],i)=>{return Object(m.jsx)("div",{key:e},Object(m.jsx)(u.EuiFlexGroup,{gutterSize:"s"},Object(m.jsx)(u.EuiFlexItem,null,Object(m.jsx)(u.EuiFieldText,{value:e,disabled:!0})),Object(m.jsx)(u.EuiFlexItem,null,Object(m.jsx)(u.EuiFormRow,{fullWidth:!0},Object(m.jsx)(u.EuiComboBox,{placeholder:l.i18n.translate("indexPatternFieldEditor.editor.form.runtimeType.placeholderLabel",{defaultMessage:"Select a type"}),singleSelection:{asPlainText:!0},options:de,selectedOptions:[(r=t.type,de.find((({value:e})=>e===r)))],onChange:t=>{0!==t.length&&(o[e]={type:t[0].value},n.next({...o}))},isClearable:!1,"data-test-subj":`typeField_${i}`,"aria-label":l.i18n.translate("indexPatternFieldEditor.editor.form.typeSelectAriaLabel",{defaultMessage:"Type select"}),fullWidth:!0})))));var r}))))},Ne=l.i18n.translate("indexPatternFieldEditor.editor.form.changeWarning",{defaultMessage:"Changing name or type can break searches and visualizations that rely on this field."}),ze=e=>{const t=(e=>{if(e){var t;const i=null===(t=ue.find((({value:t})=>t===e)))||void 0===t?void 0:t.label;return[{label:null!=i?i:e,value:e}]}return[ue[0]]})(e.type),i=null===e.format?void 0:e.format;return{...e,type:t,format:i,__meta__:{isCustomLabelVisible:void 0!==e.customLabel,isCustomDescriptionVisible:void 0!==e.customDescription,isValueVisible:void 0!==e.script,isFormatVisible:void 0!==e.format,isPopularityVisible:void 0!==e.popularity}}},Be=e=>{const{__meta__:t,type:i,format:n,...r}=e;return{type:i&&i[0].value,format:void 0===n?null:n,...r}},Ae=({field:e,onChange:t,onFormModifiedChange:i})=>{var a,s;const{namesNotAllowed:d,fieldTypeToProcess:c,fieldName$:f,subfields$:p}=_(),{params:{update:h},fieldPreview$:v}=L(),{form:x}=Object(b.n)({defaultValue:e,schema:ge,deserializer:ze,serializer:Be}),{submit:j,isValid:w,isSubmitted:E,getFields:F,isSubmitting:P}=x,O=((e,t)=>{var i;const n=ge.name;if(!e)return n;const r=e=>e!==(null==t?void 0:t.name);return{...n,validations:[...null!==(i=n.validations)&&void 0!==i?i:[],{validator:xe({fields:e.fields.filter(r),runtimeComposites:e.runtimeComposites.filter(r)})}]}})(d,e),[y]=Object(b.p)({form:x}),S=Object(b.q)({form:x,discard:["__meta__.isCustomLabelVisible","__meta__.isCustomDescriptionVisible","__meta__.isValueVisible","__meta__.isFormatVisible","__meta__.isPopularityVisible"]});Object(n.useEffect)((()=>{const e=x.subscribe((({data:e})=>{e.internal.name!==f.getValue()&&f.next(e.internal.name)}));return()=>{e.unsubscribe()}}),[x,f]);const{name:C,type:I,script:M,format:T}=y,{name:R,type:D}=F(),V=null!==(a=Boolean(null==e?void 0:e.name)&&(null==R?void 0:R.isModified))&&void 0!==a&&a,k=null!==(s=Boolean(null==e?void 0:e.type)&&(null==D?void 0:D.isModified))&&void 0!==s&&s,N=Object(g.get)(y,"__meta__.isValueVisible"),z=Object(n.useCallback)((()=>{const e=v.getValue();v.next([]),v.next(e)}),[v]);return Object(n.useEffect)((()=>{const e=!!Object.keys(p.getValue()||{}).length;var t;const i=(t=C,v.pipe(Object(o.filter)((e=>void 0!==e)),Object(o.map)((e=>e.map((e=>({name:e.key.substring(`${t}.`.length),type:e.type}))))),Object(o.bufferCount)(2,1),Object(o.map)((([e,t])=>{const i=Object(g.differenceWith)(t,e,g.isEqual).reduce(((e,t)=>(e[t.name]={changeType:be.UPSERT,type:t.type},e)),{});return e.forEach((e=>{t.find((t=>t.name===e.name))||(i[e.name]={changeType:be.DELETE})})),i})),Object(o.filter)((e=>Object.keys(e).length>0)))).subscribe((e=>{const t={...p.getValue()};Object.entries(e).forEach((([e,i])=>{i.changeType===be.DELETE&&delete t[e],i.changeType===be.UPSERT&&(t[e]={type:i.type})})),p.next(t),x.updateFieldValues({...x.getFormData()})}));return e?v.getValue()&&v.next(v.getValue()):v.next([]),()=>{i.unsubscribe()}}),[x,v,p,C]),Object(n.useEffect)((()=>{t&&t({isValid:w,isSubmitted:E,isSubmitting:P,submit:j})}),[t,w,E,P,j]),Object(n.useEffect)((()=>{h({name:Boolean(null==C?void 0:C.trim())?C:null,type:null==I?void 0:I[0].value,script:!1===N||!1===Boolean(null==M?void 0:M.source.trim())?null:{source:M.source},format:void 0!==(null==T?void 0:T.id)?T:null,parentName:null==e?void 0:e.parentName})}),[C,I,M,N,T,h,e]),Object(n.useEffect)((()=>{i&&i(S)}),[S,i,x]),Object(m.jsx)(b.c,{form:x,className:"indexPatternFieldEditor__form","data-test-subj":"indexPatternFieldEditorForm",isInvalid:E&&!1===w,error:x.getErrors()},Object(m.jsx)(u.EuiFlexGroup,null,Object(m.jsx)(u.EuiFlexItem,null,Object(m.jsx)(b.h,{path:"name",config:O,component:b.f,"data-test-subj":"nameField",componentProps:{euiFieldProps:{disabled:"concrete"===c,"aria-label":l.i18n.translate("indexPatternFieldEditor.editor.form.nameAriaLabel",{defaultMessage:"Name field"})}}})),Object(m.jsx)(u.EuiFlexItem,null,Object(m.jsx)(je,{isDisabled:"concrete"===c,includeComposite:!0,path:"type"}))),(V||k)&&Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiSpacer,{size:"xs"}),Object(m.jsx)(u.EuiCallOut,{color:"warning",title:Ne,iconType:"warning",size:"s","data-test-subj":"changeWarning"})),Object(m.jsx)(u.EuiSpacer,{size:"xl"}),(null==e?void 0:e.parentName)&&Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiCallOut,{iconType:"iInCircle",title:l.i18n.translate("indexPatternFieldEditor.editor.form.subFieldParentInfo",{defaultMessage:"Field value is defined by ''{parentName}''",values:{parentName:null==e?void 0:e.parentName}})}),Object(m.jsx)(u.EuiSpacer,{size:"xl"})),I&&"composite"!==I[0].value?Object(m.jsx)(Ve,null):Object(m.jsx)(ke,{onReset:z}))};var We=i(18),$e=i.n(We);i(85);let Ue=0;const He=Object(n.createContext)({addPanel:()=>({removePanel:()=>{},isFixedWidth:!1})}),qe=(e,{innerWidth:t})=>Math.min(e,.8*t),Ge=Object(n.createContext)({registerFooter:()=>{},registerContent:()=>{}}),Je=()=>{const e=Object(n.useContext)(Ge);if(void 0===e)throw new Error("useFlyoutPanel() must be used within a <flyoutPanelContext.Provider />");return e},Ye=({maxWidth:e,flyoutClassName:t,fixedPanelWidths:i=!1,...r})=>{const o=Object(n.useMemo)((()=>{const e=document.getElementsByClassName(t);return 0===e.length?null:e.item(0)}),[t]),[a,s]=Object(n.useState)({}),l=Object(n.useCallback)((e=>{s((t=>{const{[e]:i,...n}=t;return n}))}),[]),d=Object(n.useCallback)((e=>{const t=Ue++;return s((i=>({...i,[t]:e}))),{removePanel:l.bind(null,t),isFixedWidth:i}}),[l,i]),c=Object(n.useMemo)((()=>({addPanel:d})),[d]);return Object(n.useLayoutEffect)((()=>{if(!o)return;let t;if("number"==typeof e)if(i){const i=Object.values(a).reduce(((e,{width:t=0})=>e+t),0);t=Math.min(e,i),o.style.minWidth=`${qe(t,window)}px`,o.style.maxWidth=`${qe(t,window)}px`}else{const i=Math.min(100,Object.values(a).reduce(((e,{width:t=0})=>e+t),0));t=e*i/100,o.style.maxWidth=`${qe(t,window)}px`}else o.style.minWidth="",o.style.maxWidth=""}),[a,e,i,t,o]),Object(m.jsx)(He.Provider,{value:c},Object(m.jsx)(u.EuiFlexGroup,$e()({className:"fieldEditor__flyoutPanels",gutterSize:"none"},r)))},Xe=({children:e,width:t,className:i="",backgroundColor:r,border:o,"data-test-subj":a,...s})=>{const[l,d]=Object(n.useState)({hasContent:!1,hasFooter:!1}),[c,f]=Object(n.useState)({}),p=G()("fieldEditor__flyoutPanel",i,{"fieldEditor__flyoutPanel--pageBackground":"euiPageBackground"===r,"fieldEditor__flyoutPanel--emptyShade":"euiEmptyShade"===r,"fieldEditor__flyoutPanel--leftBorder":"left"===o,"fieldEditor__flyoutPanel--rightBorder":"right"===o,"fieldEditor__flyoutPanel--withContent":l.hasContent}),{addPanel:h}=(()=>{const e=Object(n.useContext)(He);if(void 0===e)throw new Error("<Panel /> must be used within a <Panels /> wrapper");return e})(),v=Object(n.useCallback)((()=>{d((e=>({...e,hasContent:!0})))}),[]),g=Object(n.useCallback)((()=>{d((e=>{if(!e.hasContent)throw new Error("You need to add a <FlyoutPanels.Content /> when you add a <FlyoutPanels.Footer />");return{...e,hasFooter:!0}}))}),[]),b=Object(n.useMemo)((()=>({registerContent:v,registerFooter:g})),[g,v]);return Object(n.useLayoutEffect)((()=>{const{removePanel:e,isFixedWidth:i}=h({width:t});return t&&f((e=>i?{...e,width:`${t}px`}:{...e,minWidth:`${t}%`})),e}),[t,h]),Object(m.jsx)(u.EuiFlexItem,{className:"fieldEditor__flyoutPanels__column",style:c,grow:!1,"data-test-subj":a},Object(m.jsx)(Ge.Provider,{value:b},Object(m.jsx)("div",$e()({className:p},s),e)))},Ke=e=>{const{registerContent:t}=Je();return Object(n.useEffect)((()=>{t()}),[t]),Object(m.jsx)("div",$e()({className:"fieldEditor__flyoutPanel__content eui-scrollBar",tabIndex:0},e))},Qe=e=>Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFlyoutHeader,$e()({className:"fieldEditor__flyoutPanel__header"},e)),Object(m.jsx)(u.EuiSpacer,null)),Ze=e=>{const{registerFooter:t}=Je();return Object(n.useEffect)((()=>{t()}),[t]),Object(m.jsx)(u.EuiFlyoutFooter,$e()({className:"fieldEditor__flyoutPanel__footer"},e))},et={cancelButtonLabel:l.i18n.translate("indexPatternFieldEditor.editor.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),saveButtonLabel:l.i18n.translate("indexPatternFieldEditor.editor.flyoutSaveButtonLabel",{defaultMessage:"Save"})},tt={confirmChangeNameOrType:!1,confirmUnsavedChanges:!1},it=e=>e.isPanelVisible,nt=e=>e.isSaving,rt=({fieldToEdit:e,fieldToCreate:t,onSave:i,onCancel:o,onMounted:a})=>{const s=Object(n.useRef)(!1),l=!!e,{dataView:d,subfields$:p}=_(),g=Object(u.useIsWithinMaxBreakpoint)("s"),{controller:b}=L(),x=y(b.state$,it),j=y(b.state$,nt),[w,E]=Object(n.useState)({isSubmitted:!1,isSubmitting:!1,isValid:!!e||void 0,submit:e?async()=>({isValid:!0,data:e}):async()=>({isValid:!1,data:{}})}),[F,P]=Object(n.useState)(tt),[O,S]=Object(n.useState)(!1),{submit:C,isValid:I,isSubmitting:M}=w,T=!1===I,R=Object(n.useCallback)((()=>(O&&P({...tt,confirmUnsavedChanges:!0}),!O)),[O]),D=Object(n.useCallback)((async()=>{const{isValid:t,data:n}=await C();if(s.current&&t){const t=(null==e?void 0:e.name)!==n.name,r=(null==e?void 0:e.type)!==n.type;l&&(t||r)?P({...tt,confirmChangeNameOrType:!0}):"composite"===n.type?i({...n,fields:p.getValue()}):i(n)}}),[i,C,e,l,p]),V=Object(n.useCallback)((()=>{R()&&o()}),[o,R]);return Object(n.useEffect)((()=>{if(a)return a({canCloseValidator:R}),()=>{a({canCloseValidator:()=>!0})}}),[a,R]),Object(n.useEffect)((()=>(s.current=!0,()=>{s.current=!1})),[]),Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(Ye,{flyoutClassName:f.a,maxWidth:!g&&1180,"data-test-subj":"fieldEditor",fixedPanelWidths:!0},Object(m.jsx)(Xe,{width:600},Object(m.jsx)(Ke,null,Object(m.jsx)(Qe,null,Object(m.jsx)(u.EuiTitle,{"data-test-subj":"flyoutTitle"},Object(m.jsx)("h2",null,e?Object(m.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.flyoutEditFieldTitle",defaultMessage:"Edit field ''{fieldName}''",values:{fieldName:e.name}}):Object(m.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.flyoutDefaultTitle",defaultMessage:"Create field"}))),Object(m.jsx)(u.EuiText,{color:"subdued"},Object(m.jsx)("p",null,Object(m.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.flyoutEditFieldSubtitle",defaultMessage:"Data view: {patternName}",values:{patternName:Object(m.jsx)("i",null,d.getName())}})))),Object(m.jsx)(Ae,{field:null!=e?e:t,onChange:E,onFormModifiedChange:S})),Object(m.jsx)(Ze,null,Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:V,"data-test-subj":"closeFlyoutButton"},et.cancelButtonLabel)),Object(m.jsx)(u.EuiFlexItem,{grow:!1},Object(m.jsx)(u.EuiButton,{color:"primary",onClick:D,"data-test-subj":"fieldSaveButton",fill:!0,disabled:T,isLoading:j||M},et.saveButtonLabel)))))),x&&Object(m.jsx)(Xe,{width:440,backgroundColor:"euiPageBackground",border:"left","data-test-subj":"previewPanel"},Object(m.jsx)(le,null))),F.confirmChangeNameOrType?Object(m.jsx)(v,{fieldName:null==e?void 0:e.name,onConfirm:async()=>{const{data:e}=await C();"composite"===e.type?i({...e,fields:p.getValue()}):i(e)},onCancel:()=>{P(tt)}}):F.confirmUnsavedChanges?Object(m.jsx)(h,{onConfirm:()=>{P(tt),o()},onCancel:()=>{P(tt)}}):null)},ot=r.a.memo(rt);var at=i(4),st=i.n(at),lt=i(43),dt=i(44),ut=i(90),ct=i.n(ut);const ft={pinnedFields:{},isLoadingDocuments:!0,customId:void 0,documents:[],currentIdx:0,documentSource:"cluster",scriptEditorValidation:{isValidating:!1,isValid:!0,message:null},previewResponse:{fields:[],error:null},isFetchingDocument:!1,fetchDocError:null,customDocIdToLoad:null,isLoadingPreview:!1,initialPreviewComplete:!1,isPreviewAvailable:!0,isPanelVisible:!0,isSaving:!1};class preview_controller_PreviewController{constructor({deps:e,dataView:t,onSave:i,fieldToEdit:n,fieldTypeToProcess:a}){st()(this,"dataView",void 0),st()(this,"deps",void 0),st()(this,"onSave",void 0),st()(this,"fieldToEdit",void 0),st()(this,"fieldTypeToProcess",void 0),st()(this,"internalState$",void 0),st()(this,"state$",void 0),st()(this,"previewCount",0),st()(this,"namesNotAllowed",void 0),st()(this,"updateState",(e=>{this.internalState$.next({...this.state$.getValue(),...e})})),st()(this,"lastExecutePainlessRequestParams",{type:null,script:void 0,documentId:void 0}),st()(this,"getNamesNotAllowed",(()=>{if(!this.namesNotAllowed){const e=this.dataView.fields.map((e=>e.name)),t=Object.entries(this.dataView.getAllRuntimeFields()).filter((([,e])=>"composite"===e.type)).map((([e])=>e));this.namesNotAllowed={fields:e,runtimeComposites:t}}return this.namesNotAllowed})),st()(this,"getExistingConcreteFields",(()=>{const e=[];return this.dataView.fields.filter((e=>{var t;return!((null===(t=this.fieldToEdit)||void 0===t?void 0:t.name)===e.name)&&e.isMapped})).forEach((t=>{e.push({name:t.name,type:t.esTypes&&t.esTypes[0]||""})})),e})),st()(this,"updateConcreteField",(e=>{const t=this.dataView.getFieldByName(e.name);if(!t)throw new Error(`Unable to find field named '${e.name}' on index pattern '${this.dataView.getIndexPattern()}'`);return this.dataView.setFieldCustomLabel(e.name,e.customLabel),this.dataView.setFieldCustomDescription(e.name,e.customDescription),t.count=e.popularity||0,e.format?this.dataView.setFieldFormat(e.name,e.format):this.dataView.deleteFieldFormat(e.name),[t]})),st()(this,"updateRuntimeField",(e=>{const t=Boolean(this.fieldToEdit)&&this.fieldToEdit.name!==e.name,i=Boolean(this.fieldToEdit)&&this.fieldToEdit.type!==e.type&&("composite"===this.fieldToEdit.type||"composite"===e.type),{script:n}=e;if("runtime"===this.fieldTypeToProcess){try{this.deps.usageCollection.reportUiCounter(f.b,lt.METRIC_TYPE.COUNT,"save_runtime")}catch{}(t||i)&&this.dataView.removeRuntimeField(this.fieldToEdit.name),this.dataView.addRuntimeField(e.name,{type:e.type,script:n,fields:e.fields})}else try{this.deps.usageCollection.reportUiCounter(f.b,lt.METRIC_TYPE.COUNT,"save_concrete")}catch{}return this.dataView.addRuntimeField(e.name,e)})),st()(this,"saveField",(async e=>{try{this.deps.usageCollection.reportUiCounter(f.b,lt.METRIC_TYPE.COUNT,"runtime"===this.fieldTypeToProcess?"save_runtime":"save_concrete")}catch{}this.setIsSaving(!0);try{const t="runtime"===this.fieldTypeToProcess?this.updateRuntimeField(e):this.updateConcreteField(e),i=()=>{const i=l.i18n.translate("indexPatternFieldEditor.deleteField.savedHeader",{defaultMessage:"Saved ''{fieldName}''",values:{fieldName:e.name}});this.deps.notifications.toasts.addSuccess(i),this.setIsSaving(!1),this.onSave(t)};this.dataView.isPersisted()&&await this.deps.dataViews.updateSavedObject(this.dataView),i(),this.setIsSaving(!1)}catch(e){const t=l.i18n.translate("indexPatternFieldEditor.save.errorTitle",{defaultMessage:"Failed to save field changes"});this.deps.notifications.toasts.addError(e,{title:t}),this.setIsSaving(!1)}})),st()(this,"getInternalFieldType",(()=>this.fieldTypeToProcess)),st()(this,"togglePinnedField",(e=>{const t=this.state$.getValue(),i={...t.pinnedFields,[e]:!t.pinnedFields[e]};this.updateState({pinnedFields:i})})),st()(this,"setDocuments",(e=>{this.updateState({documents:e,currentIdx:0,isLoadingDocuments:!1,isPreviewAvailable:this.getIsPreviewAvailable({documents:e})})})),st()(this,"goToNextDocument",(()=>{const e=this.state$.getValue();e.currentIdx>=e.documents.length-1?this.updateState({currentIdx:0}):this.updateState({currentIdx:e.currentIdx+1})})),st()(this,"goToPreviousDocument",(()=>{const e=this.state$.getValue();0===e.currentIdx?this.updateState({currentIdx:e.documents.length-1}):this.updateState({currentIdx:e.currentIdx-1})})),st()(this,"setPreviewError",(e=>{this.updateState({previewResponse:{...this.internalState$.getValue().previewResponse,error:e}})})),st()(this,"setPreviewResponse",(e=>{this.updateState({previewResponse:e})})),st()(this,"setCustomDocIdToLoad",(e=>{this.updateState({customDocIdToLoad:e,customId:e||void 0,isPreviewAvailable:this.getIsPreviewAvailable({customDocIdToLoad:e})}),this.setIsFetchingDocument(!!e),e&&this.debouncedLoadDocument(e)})),st()(this,"getIsPreviewAvailable",(e=>{var t;const{isFetchingDocument:i,customDocIdToLoad:n,documents:r}=this.internalState$.getValue(),o={existingIsFetchingDocument:i,existingCustomDocIdToLoad:n,existingDocuments:r,...e};return!(!o.isFetchingDocument&&!o.customDocIdToLoad&&0===(null===(t=o.documents)||void 0===t?void 0:t.length))})),st()(this,"clearPreviewError",(e=>{var t;const{previewResponse:i}=this.internalState$.getValue(),n=null===i.error||(null===(t=i.error)||void 0===t?void 0:t.code)===e?null:i.error;this.updateState({previewResponse:{...i,error:n}})})),st()(this,"setIsSaving",(e=>{this.updateState({isSaving:e})})),st()(this,"setIsFetchingDocument",(e=>{this.updateState({isFetchingDocument:e,isPreviewAvailable:this.getIsPreviewAvailable({isFetchingDocument:e})})})),st()(this,"setFetchDocError",(e=>{this.updateState({fetchDocError:e})})),st()(this,"setIsLoadingPreview",(e=>{this.updateState({isLoadingPreview:e})})),st()(this,"setInitialPreviewComplete",(e=>{this.updateState({initialPreviewComplete:e})})),st()(this,"getIsFirstDoc",(()=>0===this.internalState$.getValue().currentIdx)),st()(this,"getIsLastDoc",(()=>{const{currentIdx:e,documents:t}=this.internalState$.getValue();return e>=t.length-1})),st()(this,"setLastExecutePainlessRequestParams",(e=>{const t=this.internalState$.getValue(),i=t.documents[t.currentIdx],n={...this.lastExecutePainlessRequestParams,...e};this.allParamsDefined(n.type,n.script,null==i?void 0:i._index)&&this.hasSomeParamsChanged(e.type,e.script,e.documentId)&&this.setIsLoadingPreview(!0),this.lastExecutePainlessRequestParams=n})),st()(this,"valueFormatter",(({value:e,format:t,type:i})=>{if(null!=t&&t.id){const i=this.deps.fieldFormats.getInstance(t.id,t.params);var n;if(i)return null!==(n=i.getConverterFor("html")(e))&&void 0!==n?n:JSON.stringify(e)}if(i){const t=Object(dt.a)(i),n=this.deps.fieldFormats.getDefaultInstance(t);var o;if(n)return null!==(o=n.getConverterFor("html")(e))&&void 0!==o?o:JSON.stringify(e)}return(e=>{var t;const i="object"==typeof e?JSON.stringify(e):null!==(t=String(e))&&void 0!==t?t:"-";return Object(w.renderToString)(Object(m.jsx)(r.a.Fragment,null,i))})(e)})),st()(this,"fetchSampleDocuments",(async(e=50)=>{if("number"!=typeof e)throw new Error('The "limit" option must be a number');this.setLastExecutePainlessRequestParams({documentId:void 0}),this.setIsFetchingDocument(!0),this.setPreviewResponse({fields:[],error:null});const[t,i]=await this.deps.search.search({params:{index:this.dataView.getIndexPattern(),body:{fields:["*"],size:e}}}).toPromise().then((e=>[e,null])).catch((e=>[null,e]));this.setIsFetchingDocument(!1),this.setCustomDocIdToLoad(null);const n=Boolean(i)?{code:"ERR_FETCHING_DOC",error:{message:i.toString(),reason:l.i18n.translate("indexPatternFieldEditor.fieldPreview.error.errorLoadingSampleDocumentsDescription",{defaultMessage:"Error loading sample documents."})}}:null;this.setFetchDocError(n),null===n&&this.setDocuments(t?t.rawResponse.hits.hits:[])})),st()(this,"loadDocument",(async e=>{if(!Boolean(e.trim()))return;this.setLastExecutePainlessRequestParams({documentId:void 0}),this.setIsFetchingDocument(!0);const[t,i]=await this.deps.search.search({params:{index:this.dataView.getIndexPattern(),body:{size:1,fields:["*"],query:{ids:{values:[e]}}}}}).toPromise().then((e=>[e,null])).catch((e=>[null,e]));this.setIsFetchingDocument(!1);const n=(null==t?void 0:t.rawResponse.hits.total)>0,r=n?t.rawResponse.hits.hits:[],o=Boolean(i)?{code:"ERR_FETCHING_DOC",error:{message:i.toString(),reason:l.i18n.translate("indexPatternFieldEditor.fieldPreview.error.errorLoadingDocumentDescription",{defaultMessage:"Error loading document."})}}:!1===n?{code:"DOC_NOT_FOUND",error:{message:l.i18n.translate("indexPatternFieldEditor.fieldPreview.error.documentNotFoundDescription",{defaultMessage:"Document ID not found"})}}:null;this.setFetchDocError(o),null===o?this.setDocuments(r):this.setIsLoadingPreview(!1)})),st()(this,"debouncedLoadDocument",ct()(this.loadDocument,500,{leading:!0})),st()(this,"reset",(()=>{this.previewCount=0,this.updateState({documents:[],previewResponse:{fields:[],error:null},isLoadingPreview:!1,isFetchingDocument:!1})})),st()(this,"hasSomeParamsChanged",((e,t,i)=>this.lastExecutePainlessRequestParams.type!==e||this.lastExecutePainlessRequestParams.script!==t||this.lastExecutePainlessRequestParams.documentId!==i)),st()(this,"getPreviewCount",(()=>this.previewCount)),st()(this,"incrementPreviewCount",(()=>++this.previewCount)),st()(this,"allParamsDefined",((e,t,i)=>!!(i&&t&&e))),st()(this,"updateSingleFieldPreview",((e,t,i,n)=>{const[r]=t,o=this.valueFormatter({value:r,type:i,format:n});this.setPreviewResponse({fields:[{key:e,value:r,formattedValue:o}],error:null})})),st()(this,"updateCompositeFieldPreview",((e,t,i,n,r,o,a)=>{const s=[],l=t?e=>e.key===i:()=>!0,d=Object.entries(e).map((([e,i])=>{const{1:a}=e.split("composite_field.");s.push(a);const[l]=i,d=this.valueFormatter({value:l,type:r,format:o});return{key:t?`${null!=t?t:""}.${a}`:`${null!=n?n:""}.${a}`,value:l,formattedValue:d,type:M(l)}})).filter(l).sort(((e,t)=>e.key.localeCompare(t.key)));a(d),this.setPreviewResponse({fields:d,error:null})})),this.deps=e,this.dataView=t,this.onSave=i,this.fieldToEdit=n,this.fieldTypeToProcess=a,this.internalState$=new o.BehaviorSubject({...ft}),this.state$=this.internalState$,this.fetchSampleDocuments()}}const mt=({fieldToEdit:e,fieldToCreate:t,onSave:i,onCancel:r,onMounted:a,docLinks:l,fieldTypeToProcess:d,dataView:u,dataViews:c,search:f,notifications:p,usageCollection:h,apiService:v,fieldFormatEditors:g,fieldFormats:b,uiSettings:x})=>{const[_]=Object(n.useState)((()=>new preview_controller_PreviewController({deps:{dataViews:c,search:f,fieldFormats:b,usageCollection:h,notifications:p},dataView:u,onSave:i,fieldToEdit:e,fieldTypeToProcess:d}))),w=Object(n.useMemo)((()=>({api:v,search:f,notifications:p})),[v,f,p]);return Object(m.jsx)(j,{dataView:u,uiSettings:x,links:s(l),fieldTypeToProcess:d,services:w,fieldFormatEditors:g,fieldFormats:b,namesNotAllowed:_.getNamesNotAllowed(),existingConcreteFields:_.getExistingConcreteFields(),fieldName$:new o.BehaviorSubject((null==e?void 0:e.name)||""),subfields$:new o.BehaviorSubject(null==e?void 0:e.fields)},Object(m.jsx)(R,{controller:_},Object(m.jsx)(ot,{onSave:_.saveField,onCancel:r,onMounted:a,fieldToCreate:t,fieldToEdit:e})))}},59:function(e,t,i){"use strict";var n,r=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),o=[];function a(e){for(var t=-1,i=0;i<o.length;i++)if(o[i].identifier===e){t=i;break}return t}function s(e,t){for(var i={},n=[],r=0;r<e.length;r++){var s=e[r],l=t.base?s[0]+t.base:s[0],d=i[l]||0,u="".concat(l," ").concat(d);i[l]=d+1;var c=a(u),f={css:s[1],media:s[2],sourceMap:s[3]};-1!==c?(o[c].references++,o[c].updater(f)):o.push({identifier:u,updater:h(f,t),references:1}),n.push(u)}return n}function l(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var o=i.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var a=r(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var d,u=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function c(e,t,i,n){var r=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function f(e,t,i){var n=i.css,r=i.media,o=i.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var m=null,p=0;function h(e,t){var i,n,r;if(t.singleton){var o=p++;i=m||(m=l(t)),n=c.bind(null,i,o,!1),r=c.bind(null,i,o,!0)}else i=l(t),n=f.bind(null,i,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var i=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<i.length;n++){var r=a(i[n]);o[r].references--}for(var l=s(e,t),d=0;d<i.length;d++){var u=a(i[d]);0===o[u].references&&(o[u].updater(),o.splice(u,1))}i=l}}}},60:function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i,n,r,o=e[1]||"",a=e[3];if(!a)return o;if(t&&"function"==typeof btoa){var s=(i=a,n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(r," */")),l=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[o].concat(l).concat([s]).join("\n")}return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,n){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(n)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(r[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);n&&r[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),t.push(l))}},t}},68:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(47),r=i(1),o=n.__importDefault(i(69));t.default=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=[]);var n=o.default(e,t),a=n[0],s=n[1],l=n[2];return r.useEffect(l,i),[a,s]}},69:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);t.default=function(e,t){void 0===t&&(t=0);var i=n.useRef(!1),r=n.useRef(),o=n.useRef(e),a=n.useCallback((function(){return i.current}),[]),s=n.useCallback((function(){i.current=!1,r.current&&clearTimeout(r.current),r.current=setTimeout((function(){i.current=!0,o.current()}),t)}),[t]),l=n.useCallback((function(){i.current=null,r.current&&clearTimeout(r.current)}),[]);return n.useEffect((function(){o.current=e}),[e]),n.useEffect((function(){return s(),l}),[t]),[a,l,s]}},70:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(71);case"v8light":return i(73)}},71:function(e,t,i){var n=i(59),r=i(72);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},72:function(e,t,i){(t=i(60)(!1)).push([e.i,".indexPatternFieldEditor__previewFieldList{position:relative}.indexPatternFieldEditor__previewFieldList--ligthWeight{font-weight:400}.indexPatternFieldEditor__previewFieldList__item{align-items:center;border-bottom:1px solid #343741;height:40px;overflow:hidden}.indexPatternFieldEditor__previewFieldList__item--highlighted{background:#103148;font-weight:600}.indexPatternFieldEditor__previewFieldList__item__key,.indexPatternFieldEditor__previewFieldList__item__value{overflow:hidden}.indexPatternFieldEditor__previewFieldList__item__actions{flex-basis:24px!important}.indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:none}.indexPatternFieldEditor__previewFieldList__item--pinned .indexPatternFieldEditor__previewFieldList__item__actionsBtn,.indexPatternFieldEditor__previewFieldList__item:hover .indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:block}.indexPatternFieldEditor__previewFieldList__item__value .euiToolTipAnchor{width:100%}.indexPatternFieldEditor__previewFieldList__item__key__wrapper,.indexPatternFieldEditor__previewFieldList__item__value__wrapper{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.indexPatternFieldEditor__previewFieldList__showMore{align-items:flex-end;bottom:-40px;display:flex;height:40px;position:absolute;width:100%}",""]),e.exports=t},73:function(e,t,i){var n=i(59),r=i(74);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},74:function(e,t,i){(t=i(60)(!1)).push([e.i,".indexPatternFieldEditor__previewFieldList{position:relative}.indexPatternFieldEditor__previewFieldList--ligthWeight{font-weight:400}.indexPatternFieldEditor__previewFieldList__item{align-items:center;border-bottom:1px solid #d3dae6;height:40px;overflow:hidden}.indexPatternFieldEditor__previewFieldList__item--highlighted{background:#e6f1fa;font-weight:600}.indexPatternFieldEditor__previewFieldList__item__key,.indexPatternFieldEditor__previewFieldList__item__value{overflow:hidden}.indexPatternFieldEditor__previewFieldList__item__actions{flex-basis:24px!important}.indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:none}.indexPatternFieldEditor__previewFieldList__item--pinned .indexPatternFieldEditor__previewFieldList__item__actionsBtn,.indexPatternFieldEditor__previewFieldList__item:hover .indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:block}.indexPatternFieldEditor__previewFieldList__item__value .euiToolTipAnchor{width:100%}.indexPatternFieldEditor__previewFieldList__item__key__wrapper,.indexPatternFieldEditor__previewFieldList__item__value__wrapper{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.indexPatternFieldEditor__previewFieldList__showMore{align-items:flex-end;bottom:-40px;display:flex;height:40px;position:absolute;width:100%}",""]),e.exports=t},75:function(e,t,i){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var r=n(i(18)),o=n(i(76)),a=n(i(77)),s=n(i(78)),l=i(1),d=n(i(79)),u="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function c(e){cancelAnimationFrame(e.id)}function f(e,t){var i=u(),n={id:requestAnimationFrame((function r(){u()-i>=t?e.call(null):n.id=requestAnimationFrame(r)}))};return n}var m=-1;function p(e){if(void 0===e&&(e=!1),-1===m||e){var t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",document.body.appendChild(t),m=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return m}var h=null;function v(e){if(void 0===e&&(e=!1),null===h||e){var t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";var n=document.createElement("div"),r=n.style;return r.width="100px",r.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?h="positive-descending":(t.scrollLeft=1,h=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),h}return h}var g=function(e){var t=e.columnIndex;return e.data,e.rowIndex+":"+t};function b(e){var t,i=e.getColumnOffset,n=e.getColumnStartIndexForOffset,d=e.getColumnStopIndexForStartIndex,u=e.getColumnWidth,m=e.getEstimatedTotalHeight,h=e.getEstimatedTotalWidth,b=e.getOffsetForColumnAndAlignment,j=e.getOffsetForRowAndAlignment,_=e.getRowHeight,w=e.getRowOffset,E=e.getRowStartIndexForOffset,F=e.getRowStopIndexForStartIndex,P=e.initInstanceProps,O=e.shouldResetStyleCacheOnItemSizeChange,y=e.validateProps;return(t=function(e){function t(t){var n;return(n=e.call(this,t)||this)._instanceProps=P(n.props,o(n)),n._resetIsScrollingTimeoutId=null,n._outerRef=void 0,n.state={instance:o(n),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:"number"==typeof n.props.initialScrollLeft?n.props.initialScrollLeft:0,scrollTop:"number"==typeof n.props.initialScrollTop?n.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},n._callOnItemsRendered=void 0,n._callOnItemsRendered=s((function(e,t,i,r,o,a,s,l){return n.props.onItemsRendered({overscanColumnStartIndex:e,overscanColumnStopIndex:t,overscanRowStartIndex:i,overscanRowStopIndex:r,visibleColumnStartIndex:o,visibleColumnStopIndex:a,visibleRowStartIndex:s,visibleRowStopIndex:l})})),n._callOnScroll=void 0,n._callOnScroll=s((function(e,t,i,r,o){return n.props.onScroll({horizontalScrollDirection:i,scrollLeft:e,scrollTop:t,verticalScrollDirection:r,scrollUpdateWasRequested:o})})),n._getItemStyle=void 0,n._getItemStyle=function(e,t){var r,o=n.props,a=o.columnWidth,s=o.direction,l=o.rowHeight,d=n._getItemStyleCache(O&&a,O&&s,O&&l),c=e+":"+t;if(d.hasOwnProperty(c))r=d[c];else{var f=i(n.props,t,n._instanceProps),m="rtl"===s;d[c]=r={position:"absolute",left:m?void 0:f,right:m?f:void 0,top:w(n.props,e,n._instanceProps),height:_(n.props,e,n._instanceProps),width:u(n.props,t,n._instanceProps)}}return r},n._getItemStyleCache=void 0,n._getItemStyleCache=s((function(e,t,i){return{}})),n._onScroll=function(e){var t=e.currentTarget,i=t.clientHeight,r=t.clientWidth,o=t.scrollLeft,a=t.scrollTop,s=t.scrollHeight,l=t.scrollWidth;n.setState((function(e){if(e.scrollLeft===o&&e.scrollTop===a)return null;var t=n.props.direction,d=o;if("rtl"===t)switch(v()){case"negative":d=-o;break;case"positive-descending":d=l-r-o}d=Math.max(0,Math.min(d,l-r));var u=Math.max(0,Math.min(a,s-i));return{isScrolling:!0,horizontalScrollDirection:e.scrollLeft<o?"forward":"backward",scrollLeft:d,scrollTop:u,verticalScrollDirection:e.scrollTop<a?"forward":"backward",scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._outerRefSetter=function(e){var t=n.props.outerRef;n._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},n._resetIsScrollingDebounced=function(){null!==n._resetIsScrollingTimeoutId&&c(n._resetIsScrollingTimeoutId),n._resetIsScrollingTimeoutId=f(n._resetIsScrolling,150)},n._resetIsScrolling=function(){n._resetIsScrollingTimeoutId=null,n.setState({isScrolling:!1},(function(){n._getItemStyleCache(-1)}))},n}a(t,e),t.getDerivedStateFromProps=function(e,t){return x(e,t),y(e),null};var S=t.prototype;return S.scrollTo=function(e){var t=e.scrollLeft,i=e.scrollTop;void 0!==t&&(t=Math.max(0,t)),void 0!==i&&(i=Math.max(0,i)),this.setState((function(e){return void 0===t&&(t=e.scrollLeft),void 0===i&&(i=e.scrollTop),e.scrollLeft===t&&e.scrollTop===i?null:{horizontalScrollDirection:e.scrollLeft<t?"forward":"backward",scrollLeft:t,scrollTop:i,scrollUpdateWasRequested:!0,verticalScrollDirection:e.scrollTop<i?"forward":"backward"}}),this._resetIsScrollingDebounced)},S.scrollToItem=function(e){var t=e.align,i=void 0===t?"auto":t,n=e.columnIndex,r=e.rowIndex,o=this.props,a=o.columnCount,s=o.height,l=o.rowCount,d=o.width,u=this.state,c=u.scrollLeft,f=u.scrollTop,v=p();void 0!==n&&(n=Math.max(0,Math.min(n,a-1))),void 0!==r&&(r=Math.max(0,Math.min(r,l-1)));var g=m(this.props,this._instanceProps),x=h(this.props,this._instanceProps)>d?v:0,_=g>s?v:0;this.scrollTo({scrollLeft:void 0!==n?b(this.props,n,i,c,this._instanceProps,_):c,scrollTop:void 0!==r?j(this.props,r,i,f,this._instanceProps,x):f})},S.componentDidMount=function(){var e=this.props,t=e.initialScrollLeft,i=e.initialScrollTop;if(null!=this._outerRef){var n=this._outerRef;"number"==typeof t&&(n.scrollLeft=t),"number"==typeof i&&(n.scrollTop=i)}this._callPropsCallbacks()},S.componentDidUpdate=function(){var e=this.props.direction,t=this.state,i=t.scrollLeft,n=t.scrollTop;if(t.scrollUpdateWasRequested&&null!=this._outerRef){var r=this._outerRef;if("rtl"===e)switch(v()){case"negative":r.scrollLeft=-i;break;case"positive-ascending":r.scrollLeft=i;break;default:var o=r.clientWidth,a=r.scrollWidth;r.scrollLeft=a-o-i}else r.scrollLeft=Math.max(0,i);r.scrollTop=Math.max(0,n)}this._callPropsCallbacks()},S.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&c(this._resetIsScrollingTimeoutId)},S.render=function(){var e=this.props,t=e.children,i=e.className,n=e.columnCount,o=e.direction,a=e.height,s=e.innerRef,d=e.innerElementType,u=e.innerTagName,c=e.itemData,f=e.itemKey,p=void 0===f?g:f,v=e.outerElementType,b=e.outerTagName,x=e.rowCount,j=e.style,_=e.useIsScrolling,w=e.width,E=this.state.isScrolling,F=this._getHorizontalRangeToRender(),P=F[0],O=F[1],y=this._getVerticalRangeToRender(),S=y[0],C=y[1],I=[];if(n>0&&x)for(var M=S;M<=C;M++)for(var T=P;T<=O;T++)I.push(l.createElement(t,{columnIndex:T,data:c,isScrolling:_?E:void 0,key:p({columnIndex:T,data:c,rowIndex:M}),rowIndex:M,style:this._getItemStyle(M,T)}));var R=m(this.props,this._instanceProps),L=h(this.props,this._instanceProps);return l.createElement(v||b||"div",{className:i,onScroll:this._onScroll,ref:this._outerRefSetter,style:r({position:"relative",height:a,width:w,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:o},j)},l.createElement(d||u||"div",{children:I,ref:s,style:{height:R,pointerEvents:E?"none":void 0,width:L}}))},S._callPropsCallbacks=function(){var e=this.props,t=e.columnCount,i=e.onItemsRendered,n=e.onScroll,r=e.rowCount;if("function"==typeof i&&t>0&&r>0){var o=this._getHorizontalRangeToRender(),a=o[0],s=o[1],l=o[2],d=o[3],u=this._getVerticalRangeToRender(),c=u[0],f=u[1],m=u[2],p=u[3];this._callOnItemsRendered(a,s,c,f,l,d,m,p)}if("function"==typeof n){var h=this.state,v=h.horizontalScrollDirection,g=h.scrollLeft,b=h.scrollTop,x=h.scrollUpdateWasRequested,j=h.verticalScrollDirection;this._callOnScroll(g,b,v,j,x)}},S._getHorizontalRangeToRender=function(){var e=this.props,t=e.columnCount,i=e.overscanColumnCount,r=e.overscanColumnsCount,o=e.overscanCount,a=e.rowCount,s=this.state,l=s.horizontalScrollDirection,u=s.isScrolling,c=s.scrollLeft,f=i||r||o||1;if(0===t||0===a)return[0,0,0,0];var m=n(this.props,c,this._instanceProps),p=d(this.props,m,c,this._instanceProps),h=u&&"backward"!==l?1:Math.max(1,f),v=u&&"forward"!==l?1:Math.max(1,f);return[Math.max(0,m-h),Math.max(0,Math.min(t-1,p+v)),m,p]},S._getVerticalRangeToRender=function(){var e=this.props,t=e.columnCount,i=e.overscanCount,n=e.overscanRowCount,r=e.overscanRowsCount,o=e.rowCount,a=this.state,s=a.isScrolling,l=a.verticalScrollDirection,d=a.scrollTop,u=n||r||i||1;if(0===t||0===o)return[0,0,0,0];var c=E(this.props,d,this._instanceProps),f=F(this.props,c,d,this._instanceProps),m=s&&"backward"!==l?1:Math.max(1,u),p=s&&"forward"!==l?1:Math.max(1,u);return[Math.max(0,c-m),Math.max(0,Math.min(o-1,f+p)),c,f]},t}(l.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},t}var x=function(e,t){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,t.instance},j=function(e,t){var i=e.rowCount,n=t.rowMetadataMap,r=t.estimatedRowHeight,o=t.lastMeasuredRowIndex,a=0;if(o>=i&&(o=i-1),o>=0){var s=n[o];a=s.offset+s.size}return a+(i-o-1)*r},_=function(e,t){var i=e.columnCount,n=t.columnMetadataMap,r=t.estimatedColumnWidth,o=t.lastMeasuredColumnIndex,a=0;if(o>=i&&(o=i-1),o>=0){var s=n[o];a=s.offset+s.size}return a+(i-o-1)*r},w=function(e,t,i,n){var r,o,a;if("column"===e?(r=n.columnMetadataMap,o=t.columnWidth,a=n.lastMeasuredColumnIndex):(r=n.rowMetadataMap,o=t.rowHeight,a=n.lastMeasuredRowIndex),i>a){var s=0;if(a>=0){var l=r[a];s=l.offset+l.size}for(var d=a+1;d<=i;d++){var u=o(d);r[d]={offset:s,size:u},s+=u}"column"===e?n.lastMeasuredColumnIndex=i:n.lastMeasuredRowIndex=i}return r[i]},E=function(e,t,i,n){var r,o;return"column"===e?(r=i.columnMetadataMap,o=i.lastMeasuredColumnIndex):(r=i.rowMetadataMap,o=i.lastMeasuredRowIndex),(o>0?r[o].offset:0)>=n?F(e,t,i,o,0,n):P(e,t,i,Math.max(0,o),n)},F=function(e,t,i,n,r,o){for(;r<=n;){var a=r+Math.floor((n-r)/2),s=w(e,t,a,i).offset;if(s===o)return a;s<o?r=a+1:s>o&&(n=a-1)}return r>0?r-1:0},P=function(e,t,i,n,r){for(var o="column"===e?t.columnCount:t.rowCount,a=1;n<o&&w(e,t,n,i).offset<r;)n+=a,a*=2;return F(e,t,i,Math.min(n,o-1),Math.floor(n/2),r)},O=function(e,t,i,n,r,o,a){var s="column"===e?t.width:t.height,l=w(e,t,i,o),d="column"===e?_(t,o):j(t,o),u=Math.max(0,Math.min(d-s,l.offset)),c=Math.max(0,l.offset-s+a+l.size);switch("smart"===n&&(n=r>=c-s&&r<=u+s?"auto":"center"),n){case"start":return u;case"end":return c;case"center":return Math.round(c+(u-c)/2);default:return r>=c&&r<=u?r:c>u||r<c?c:u}},y=b({getColumnOffset:function(e,t,i){return w("column",e,t,i).offset},getColumnStartIndexForOffset:function(e,t,i){return E("column",e,i,t)},getColumnStopIndexForStartIndex:function(e,t,i,n){for(var r=e.columnCount,o=e.width,a=w("column",e,t,n),s=i+o,l=a.offset+a.size,d=t;d<r-1&&l<s;)d++,l+=w("column",e,d,n).size;return d},getColumnWidth:function(e,t,i){return i.columnMetadataMap[t].size},getEstimatedTotalHeight:j,getEstimatedTotalWidth:_,getOffsetForColumnAndAlignment:function(e,t,i,n,r,o){return O("column",e,t,i,n,r,o)},getOffsetForRowAndAlignment:function(e,t,i,n,r,o){return O("row",e,t,i,n,r,o)},getRowOffset:function(e,t,i){return w("row",e,t,i).offset},getRowHeight:function(e,t,i){return i.rowMetadataMap[t].size},getRowStartIndexForOffset:function(e,t,i){return E("row",e,i,t)},getRowStopIndexForStartIndex:function(e,t,i,n){for(var r=e.rowCount,o=e.height,a=w("row",e,t,n),s=i+o,l=a.offset+a.size,d=t;d<r-1&&l<s;)d++,l+=w("row",e,d,n).size;return d},initInstanceProps:function(e,t){var i=e,n={columnMetadataMap:{},estimatedColumnWidth:i.estimatedColumnWidth||50,estimatedRowHeight:i.estimatedRowHeight||50,lastMeasuredColumnIndex:-1,lastMeasuredRowIndex:-1,rowMetadataMap:{}};return t.resetAfterColumnIndex=function(e,i){void 0===i&&(i=!0),t.resetAfterIndices({columnIndex:e,shouldForceUpdate:i})},t.resetAfterRowIndex=function(e,i){void 0===i&&(i=!0),t.resetAfterIndices({rowIndex:e,shouldForceUpdate:i})},t.resetAfterIndices=function(e){var i=e.columnIndex,r=e.rowIndex,o=e.shouldForceUpdate,a=void 0===o||o;"number"==typeof i&&(n.lastMeasuredColumnIndex=Math.min(n.lastMeasuredColumnIndex,i-1)),"number"==typeof r&&(n.lastMeasuredRowIndex=Math.min(n.lastMeasuredRowIndex,r-1)),t._getItemStyleCache(-1),a&&t.forceUpdate()},n},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.columnWidth,e.rowHeight}}),S=function(e,t){return e};function C(e){var t,i=e.getItemOffset,n=e.getEstimatedTotalSize,d=e.getItemSize,u=e.getOffsetForIndexAndAlignment,m=e.getStartIndexForOffset,h=e.getStopIndexForStartIndex,g=e.initInstanceProps,b=e.shouldResetStyleCacheOnItemSizeChange,x=e.validateProps;return t=function(e){function t(t){var n;return(n=e.call(this,t)||this)._instanceProps=g(n.props,o(n)),n._outerRef=void 0,n._resetIsScrollingTimeoutId=null,n.state={instance:o(n),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof n.props.initialScrollOffset?n.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},n._callOnItemsRendered=void 0,n._callOnItemsRendered=s((function(e,t,i,r){return n.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:i,visibleStopIndex:r})})),n._callOnScroll=void 0,n._callOnScroll=s((function(e,t,i){return n.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:i})})),n._getItemStyle=void 0,n._getItemStyle=function(e){var t,r=n.props,o=r.direction,a=r.itemSize,s=r.layout,l=n._getItemStyleCache(b&&a,b&&s,b&&o);if(l.hasOwnProperty(e))t=l[e];else{var u=i(n.props,e,n._instanceProps),c=d(n.props,e,n._instanceProps),f="horizontal"===o||"horizontal"===s,m="rtl"===o,p=f?u:0;l[e]=t={position:"absolute",left:m?void 0:p,right:m?p:void 0,top:f?0:u,height:f?"100%":c,width:f?c:"100%"}}return t},n._getItemStyleCache=void 0,n._getItemStyleCache=s((function(e,t,i){return{}})),n._onScrollHorizontal=function(e){var t=e.currentTarget,i=t.clientWidth,r=t.scrollLeft,o=t.scrollWidth;n.setState((function(e){if(e.scrollOffset===r)return null;var t=n.props.direction,a=r;if("rtl"===t)switch(v()){case"negative":a=-r;break;case"positive-descending":a=o-i-r}return a=Math.max(0,Math.min(a,o-i)),{isScrolling:!0,scrollDirection:e.scrollOffset<a?"forward":"backward",scrollOffset:a,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._onScrollVertical=function(e){var t=e.currentTarget,i=t.clientHeight,r=t.scrollHeight,o=t.scrollTop;n.setState((function(e){if(e.scrollOffset===o)return null;var t=Math.max(0,Math.min(o,r-i));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),n._resetIsScrollingDebounced)},n._outerRefSetter=function(e){var t=n.props.outerRef;n._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},n._resetIsScrollingDebounced=function(){null!==n._resetIsScrollingTimeoutId&&c(n._resetIsScrollingTimeoutId),n._resetIsScrollingTimeoutId=f(n._resetIsScrolling,150)},n._resetIsScrolling=function(){n._resetIsScrollingTimeoutId=null,n.setState({isScrolling:!1},(function(){n._getItemStyleCache(-1,null)}))},n}a(t,e),t.getDerivedStateFromProps=function(e,t){return I(e,t),x(e),null};var j=t.prototype;return j.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},j.scrollToItem=function(e,t){void 0===t&&(t="auto");var i=this.props,n=i.itemCount,r=i.layout,o=this.state.scrollOffset;e=Math.max(0,Math.min(e,n-1));var a=0;if(this._outerRef){var s=this._outerRef;a="vertical"===r?s.scrollWidth>s.clientWidth?p():0:s.scrollHeight>s.clientHeight?p():0}this.scrollTo(u(this.props,e,t,o,this._instanceProps,a))},j.componentDidMount=function(){var e=this.props,t=e.direction,i=e.initialScrollOffset,n=e.layout;if("number"==typeof i&&null!=this._outerRef){var r=this._outerRef;"horizontal"===t||"horizontal"===n?r.scrollLeft=i:r.scrollTop=i}this._callPropsCallbacks()},j.componentDidUpdate=function(){var e=this.props,t=e.direction,i=e.layout,n=this.state,r=n.scrollOffset;if(n.scrollUpdateWasRequested&&null!=this._outerRef){var o=this._outerRef;if("horizontal"===t||"horizontal"===i)if("rtl"===t)switch(v()){case"negative":o.scrollLeft=-r;break;case"positive-ascending":o.scrollLeft=r;break;default:var a=o.clientWidth,s=o.scrollWidth;o.scrollLeft=s-a-r}else o.scrollLeft=r;else o.scrollTop=r}this._callPropsCallbacks()},j.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&c(this._resetIsScrollingTimeoutId)},j.render=function(){var e=this.props,t=e.children,i=e.className,o=e.direction,a=e.height,s=e.innerRef,d=e.innerElementType,u=e.innerTagName,c=e.itemCount,f=e.itemData,m=e.itemKey,p=void 0===m?S:m,h=e.layout,v=e.outerElementType,g=e.outerTagName,b=e.style,x=e.useIsScrolling,j=e.width,_=this.state.isScrolling,w="horizontal"===o||"horizontal"===h,E=w?this._onScrollHorizontal:this._onScrollVertical,F=this._getRangeToRender(),P=F[0],O=F[1],y=[];if(c>0)for(var C=P;C<=O;C++)y.push(l.createElement(t,{data:f,key:p(C,f),index:C,isScrolling:x?_:void 0,style:this._getItemStyle(C)}));var I=n(this.props,this._instanceProps);return l.createElement(v||g||"div",{className:i,onScroll:E,ref:this._outerRefSetter,style:r({position:"relative",height:a,width:j,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:o},b)},l.createElement(d||u||"div",{children:y,ref:s,style:{height:w?"100%":I,pointerEvents:_?"none":void 0,width:w?I:"100%"}}))},j._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],i=e[1],n=e[2],r=e[3];this._callOnItemsRendered(t,i,n,r)}if("function"==typeof this.props.onScroll){var o=this.state,a=o.scrollDirection,s=o.scrollOffset,l=o.scrollUpdateWasRequested;this._callOnScroll(a,s,l)}},j._getRangeToRender=function(){var e=this.props,t=e.itemCount,i=e.overscanCount,n=this.state,r=n.isScrolling,o=n.scrollDirection,a=n.scrollOffset;if(0===t)return[0,0,0,0];var s=m(this.props,a,this._instanceProps),l=h(this.props,s,a,this._instanceProps),d=r&&"backward"!==o?1:Math.max(1,i),u=r&&"forward"!==o?1:Math.max(1,i);return[Math.max(0,s-d),Math.max(0,Math.min(t-1,l+u)),s,l]},t}(l.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var I=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},M=function(e,t,i){var n=e.itemSize,r=i.itemMetadataMap,o=i.lastMeasuredIndex;if(t>o){var a=0;if(o>=0){var s=r[o];a=s.offset+s.size}for(var l=o+1;l<=t;l++){var d=n(l);r[l]={offset:a,size:d},a+=d}i.lastMeasuredIndex=t}return r[t]},T=function(e,t,i,n,r){for(;n<=i;){var o=n+Math.floor((i-n)/2),a=M(e,o,t).offset;if(a===r)return o;a<r?n=o+1:a>r&&(i=o-1)}return n>0?n-1:0},R=function(e,t){var i=e.itemCount,n=t.itemMetadataMap,r=t.estimatedItemSize,o=t.lastMeasuredIndex,a=0;if(o>=i&&(o=i-1),o>=0){var s=n[o];a=s.offset+s.size}return a+(i-o-1)*r},L=C({getItemOffset:function(e,t,i){return M(e,t,i).offset},getItemSize:function(e,t,i){return i.itemMetadataMap[t].size},getEstimatedTotalSize:R,getOffsetForIndexAndAlignment:function(e,t,i,n,r,o){var a=e.direction,s=e.height,l=e.layout,d=e.width,u="horizontal"===a||"horizontal"===l?d:s,c=M(e,t,r),f=R(e,r),m=Math.max(0,Math.min(f-u,c.offset)),p=Math.max(0,c.offset-u+c.size+o);switch("smart"===i&&(i=n>=p-u&&n<=m+u?"auto":"center"),i){case"start":return m;case"end":return p;case"center":return Math.round(p+(m-p)/2);default:return n>=p&&n<=m?n:n<p?p:m}},getStartIndexForOffset:function(e,t,i){return function(e,t,i){var n=t.itemMetadataMap,r=t.lastMeasuredIndex;return(r>0?n[r].offset:0)>=i?T(e,t,r,0,i):function(e,t,i,n){for(var r=e.itemCount,o=1;i<r&&M(e,i,t).offset<n;)i+=o,o*=2;return T(e,t,Math.min(i,r-1),Math.floor(i/2),n)}(e,t,Math.max(0,r),i)}(e,i,t)},getStopIndexForStartIndex:function(e,t,i,n){for(var r=e.direction,o=e.height,a=e.itemCount,s=e.layout,l=e.width,d="horizontal"===r||"horizontal"===s?l:o,u=M(e,t,n),c=i+d,f=u.offset+u.size,m=t;m<a-1&&f<c;)m++,f+=M(e,m,n).size;return m},initInstanceProps:function(e,t){var i={itemMetadataMap:{},estimatedItemSize:e.estimatedItemSize||50,lastMeasuredIndex:-1};return t.resetAfterIndex=function(e,n){void 0===n&&(n=!0),i.lastMeasuredIndex=Math.min(i.lastMeasuredIndex,e-1),t._getItemStyleCache(-1),n&&t.forceUpdate()},i},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}}),D=b({getColumnOffset:function(e,t){return t*e.columnWidth},getColumnWidth:function(e,t){return e.columnWidth},getRowOffset:function(e,t){return t*e.rowHeight},getRowHeight:function(e,t){return e.rowHeight},getEstimatedTotalHeight:function(e){var t=e.rowCount;return e.rowHeight*t},getEstimatedTotalWidth:function(e){var t=e.columnCount;return e.columnWidth*t},getOffsetForColumnAndAlignment:function(e,t,i,n,r,o){var a=e.columnCount,s=e.columnWidth,l=e.width,d=Math.max(0,a*s-l),u=Math.min(d,t*s),c=Math.max(0,t*s-l+o+s);switch("smart"===i&&(i=n>=c-l&&n<=u+l?"auto":"center"),i){case"start":return u;case"end":return c;case"center":var f=Math.round(c+(u-c)/2);return f<Math.ceil(l/2)?0:f>d+Math.floor(l/2)?d:f;default:return n>=c&&n<=u?n:c>u||n<c?c:u}},getOffsetForRowAndAlignment:function(e,t,i,n,r,o){var a=e.rowHeight,s=e.height,l=e.rowCount,d=Math.max(0,l*a-s),u=Math.min(d,t*a),c=Math.max(0,t*a-s+o+a);switch("smart"===i&&(i=n>=c-s&&n<=u+s?"auto":"center"),i){case"start":return u;case"end":return c;case"center":var f=Math.round(c+(u-c)/2);return f<Math.ceil(s/2)?0:f>d+Math.floor(s/2)?d:f;default:return n>=c&&n<=u?n:c>u||n<c?c:u}},getColumnStartIndexForOffset:function(e,t){var i=e.columnWidth,n=e.columnCount;return Math.max(0,Math.min(n-1,Math.floor(t/i)))},getColumnStopIndexForStartIndex:function(e,t,i){var n=e.columnWidth,r=e.columnCount,o=e.width,a=t*n,s=Math.ceil((o+i-a)/n);return Math.max(0,Math.min(r-1,t+s-1))},getRowStartIndexForOffset:function(e,t){var i=e.rowHeight,n=e.rowCount;return Math.max(0,Math.min(n-1,Math.floor(t/i)))},getRowStopIndexForStartIndex:function(e,t,i){var n=e.rowHeight,r=e.rowCount,o=e.height,a=t*n,s=Math.ceil((o+i-a)/n);return Math.max(0,Math.min(r-1,t+s-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.columnWidth,e.rowHeight}}),V=C({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,i,n,r,o){var a=e.direction,s=e.height,l=e.itemCount,d=e.itemSize,u=e.layout,c=e.width,f="horizontal"===a||"horizontal"===u?c:s,m=Math.max(0,l*d-f),p=Math.min(m,t*d),h=Math.max(0,t*d-f+d+o);switch("smart"===i&&(i=n>=h-f&&n<=p+f?"auto":"center"),i){case"start":return p;case"end":return h;case"center":var v=Math.round(h+(p-h)/2);return v<Math.ceil(f/2)?0:v>m+Math.floor(f/2)?m:v;default:return n>=h&&n<=p?n:n<h?h:p}},getStartIndexForOffset:function(e,t){var i=e.itemCount,n=e.itemSize;return Math.max(0,Math.min(i-1,Math.floor(t/n)))},getStopIndexForStartIndex:function(e,t,i){var n=e.direction,r=e.height,o=e.itemCount,a=e.itemSize,s=e.layout,l=e.width,d=t*a,u="horizontal"===n||"horizontal"===s?l:r,c=Math.ceil((u+i-d)/a);return Math.max(0,Math.min(o-1,t+c-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function k(e,t){for(var i in e)if(!(i in t))return!0;for(var n in t)if(e[n]!==t[n])return!0;return!1}var N=["style"],z=["style"];function B(e,t){var i=e.style,n=d(e,N),r=t.style,o=d(t,z);return!k(i,r)&&!k(n,o)}t.FixedSizeGrid=D,t.FixedSizeList=V,t.VariableSizeGrid=y,t.VariableSizeList=L,t.areEqual=B,t.shouldComponentUpdate=function(e,t){return!B(this.props,e)||k(this.state,t)}},76:function(e,t,i){e.exports=i(17)(1453)},77:function(e,t,i){e.exports=i(17)(3099)},78:function(e,t,i){"use strict";function n(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}e.exports=function(e,t){var i;void 0===t&&(t=n);var r,o=[],a=!1;return function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];return a&&i===this&&t(n,o)||(r=e.apply(this,n),a=!0,i=this,o=n),r}}},79:function(e,t,i){e.exports=i(17)(3433)},80:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(81);case"v8light":return i(83)}},81:function(e,t,i){var n=i(59),r=i(82);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},82:function(e,t,i){(t=i(60)(!1)).push([e.i,".indexPatternFieldEditor__previewPannel{display:flex;flex-direction:column;height:100%}.indexPatternFieldEditor__previewImageModal__wrapper{padding:16px}.indexPatternFieldEditor__previewImageModal__wrapper img{max-width:100%}.indexPatternFieldEditor__previewEmptySearchResult__title{font-weight:400}",""]),e.exports=t},83:function(e,t,i){var n=i(59),r=i(84);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},84:function(e,t,i){(t=i(60)(!1)).push([e.i,".indexPatternFieldEditor__previewPannel{display:flex;flex-direction:column;height:100%}.indexPatternFieldEditor__previewImageModal__wrapper{padding:16px}.indexPatternFieldEditor__previewImageModal__wrapper img{max-width:100%}.indexPatternFieldEditor__previewEmptySearchResult__title{font-weight:400}",""]),e.exports=t},85:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(86);case"v8light":return i(88)}},86:function(e,t,i){var n=i(59),r=i(87);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},87:function(e,t,i){(t=i(60)(!1)).push([e.i,".fieldEditor__flyoutPanels{height:100%}.fieldEditor__flyoutPanels__column{height:100%;overflow:hidden}.fieldEditor__flyoutPanel{height:100%;overflow-y:auto;padding:24px}.fieldEditor__flyoutPanel--pageBackground{background-color:#141519}.fieldEditor__flyoutPanel--emptyShade{background-color:#1d1e24}.fieldEditor__flyoutPanel--leftBorder{border-left:1px solid #343741}.fieldEditor__flyoutPanel--rightBorder{border-right:1px solid #343741}.fieldEditor__flyoutPanel--withContent{display:flex;flex-direction:column;overflow-y:hidden;padding:0}.fieldEditor__flyoutPanel__header{overflow-wrap:break-word!important;padding:0!important;word-break:break-word}.fieldEditor__flyoutPanel__content{flex:1;overflow-x:hidden;overflow-y:auto;padding:24px}.fieldEditor__flyoutPanel__footer{flex:0}",""]),e.exports=t},88:function(e,t,i){var n=i(59),r=i(89);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);n(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},89:function(e,t,i){(t=i(60)(!1)).push([e.i,".fieldEditor__flyoutPanels{height:100%}.fieldEditor__flyoutPanels__column{height:100%;overflow:hidden}.fieldEditor__flyoutPanel{height:100%;overflow-y:auto;padding:24px}.fieldEditor__flyoutPanel--pageBackground{background-color:#fafbfd}.fieldEditor__flyoutPanel--emptyShade{background-color:#fff}.fieldEditor__flyoutPanel--leftBorder{border-left:1px solid #d3dae6}.fieldEditor__flyoutPanel--rightBorder{border-right:1px solid #d3dae6}.fieldEditor__flyoutPanel--withContent{display:flex;flex-direction:column;overflow-y:hidden;padding:0}.fieldEditor__flyoutPanel__header{overflow-wrap:break-word!important;padding:0!important;word-break:break-word}.fieldEditor__flyoutPanel__content{flex:1;overflow-x:hidden;overflow-y:auto;padding:24px}.fieldEditor__flyoutPanel__footer{flex:0}",""]),e.exports=t},90:function(e,t,i){var n=i(91),r=i(92),o=i(94),a=Math.max,s=Math.min;e.exports=function(e,t,i){var l,d,u,c,f,m,p=0,h=!1,v=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var i=l,n=d;return l=d=void 0,p=t,c=e.apply(n,i)}function x(e){var i=e-m;return void 0===m||i>=t||i<0||v&&e-p>=u}function j(){var e=r();if(x(e))return _(e);f=setTimeout(j,function(e){var i=t-(e-m);return v?s(i,u-(e-p)):i}(e))}function _(e){return f=void 0,g&&l?b(e):(l=d=void 0,c)}function w(){var e=r(),i=x(e);if(l=arguments,d=this,m=e,i){if(void 0===f)return function(e){return p=e,f=setTimeout(j,t),h?b(e):c}(m);if(v)return clearTimeout(f),f=setTimeout(j,t),b(m)}return void 0===f&&(f=setTimeout(j,t)),c}return t=o(t)||0,n(i)&&(h=!!i.leading,u=(v="maxWait"in i)?a(o(i.maxWait)||0,t):u,g="trailing"in i?!!i.trailing:g),w.cancel=function(){void 0!==f&&clearTimeout(f),p=0,l=m=d=f=void 0},w.flush=function(){return void 0===f?c:_(r())},w}},91:function(e,t,i){e.exports=i(17)(361)},92:function(e,t,i){var n=i(93);e.exports=function(){return n.Date.now()}},93:function(e,t,i){e.exports=i(17)(317)},94:function(e,t,i){e.exports=i(17)(3823)}}]);