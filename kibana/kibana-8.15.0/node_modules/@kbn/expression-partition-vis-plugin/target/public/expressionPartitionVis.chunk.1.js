(window.expressionPartitionVis_bundle_jsonpfunction=window.expressionPartitionVis_bundle_jsonpfunction||[]).push([[1],{33:function(e,t,n){e.exports=n(23)(71)},34:function(e,t,n){"use strict";e.exports=n(39)},35:function(e,t,n){"use strict";e.exports=n(46)},36:function(e,t,n){"use strict";e.exports=n(37)},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38);n(11),n(34),n(35);var i=a.default({key:"css"}),r=i.flush,o=i.hydrate,l=i.cx,s=i.merge,c=i.getRegisteredStyles,u=i.injectGlobal,d=i.keyframes,m=i.css,v=i.sheet,h=i.cache;t.cache=h,t.css=m,t.cx=l,t.flush=r,t.getRegisteredStyles=c,t.hydrate=o,t.injectGlobal=u,t.keyframes=d,t.merge=s,t.sheet=v},38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),i=n(34),r=n(35);function o(e){return e&&e.__esModule?e:{default:e}}var l=o(a);function s(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function c(e,t,n){var a=[],i=r.getRegisteredStyles(e,a,n);return a.length<2?n:i+t(a)}var u=function e(t){for(var n="",a=0;a<t.length;a++){var i=t[a];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var o in r="",i)i[o]&&o&&(r&&(r+=" "),r+=o);break;default:r=i}r&&(n&&(n+=" "),n+=r)}}return n};t.default=function(e){var t=l.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var o=i.serializeStyles(n,t.registered,void 0);return r.insertStyles(t,o,!1),t.key+"-"+o.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return c(t.registered,n,u(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered);s(t,r)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered),o="animation-"+r.name;return s(t,{name:r.name,styles:"@keyframes "+o+"{"+r.styles+"}"}),o},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:c.bind(null,t.registered,n)}}},39:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(40),i=n(42),r=n(44);function o(e){return e&&e.__esModule?e:{default:e}}var l=o(a),s=o(i),c=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},m=function(e){return null!=e&&"boolean"!=typeof e},v=o(r).default((function(e){return d(e)?e:e.replace(c,"-$&").toLowerCase()})),h=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,n){return f={name:t,styles:n,next:f},t}))}return 1===s.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function g(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return f={name:n.name,styles:n.styles,next:f},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)f={name:a.name,styles:a.styles,next:f},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var i=0;i<n.length;i++)a+=g(e,t,n[i])+";";else for(var r in n){var o=n[r];if("object"!=typeof o)null!=t&&void 0!==t[o]?a+=r+"{"+t[o]+"}":m(o)&&(a+=v(r)+":"+h(r,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var l=g(e,t,o);switch(r){case"animation":case"animationName":a+=v(r)+":"+l+";";break;default:a+=r+"{"+l+"}"}}else for(var s=0;s<o.length;s++)m(o[s])&&(a+=v(r)+":"+h(r,o[s])+";")}return a}(e,t,n);case"function":if(void 0!==e){var i=f,r=n(e);return f=i,g(e,t,r)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var f,p=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,i="";f=void 0;var r=e[0];null==r||void 0===r.raw?(a=!1,i+=g(n,t,r)):i+=r[0];for(var o=1;o<e.length;o++)i+=g(n,t,e[o]),a&&(i+=r[o]);p.lastIndex=0;for(var s,c="";null!==(s=p.exec(i));)c+="-"+s[1];return{name:l.default(i)+c,styles:i,next:f}}},40:function(e,t,n){"use strict";e.exports=n(41)},41:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,i=e.length;i>=4;++a,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},42:function(e,t,n){"use strict";e.exports=n(43)},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},44:function(e,t,n){"use strict";e.exports=n(45)},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},46:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,i=function(e,t,n){var i=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){i(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",l=t;do{var s=e.insert(t===l?"."+r:"",l,e.sheet,!0);a||void 0===s||(o+=s),l=l.next}while(void 0!==l);if(!a&&0!==o.length)return o}},t.registerStyles=i},49:function(e,t,n){"use strict";n.r(t);var a=n(15),i=n.n(a),r=n(8),o=n.n(r),l=n(5),s=n(16),c=n(0),u=n(10),d=n(29),m=n(3),v=n(4),h=n(12);function g(e){return null!=e}var f=n(1),p=n(2),b=n(33),y=n.n(b),j=n(30);function x(e){try{return y()(e)}catch{return y()("red")}}function O(e,t){const[n,a,i]=x(e).rgb();return`rgba(${n},${a},${i},${t})`}function C(e,t){const[n,a,i,r]=x(e).rgba(),[o,l,s,c]=x(t).rgba();if(1===r)return y.a.rgb(n,a,i).hex();const u=r+c*(1-r);return 0===u?"#00000000":`rgba(${Math.round((n*r+o*c*(1-r))/u)}, ${Math.round((a*r+l*c*(1-r))/u)}, ${Math.round((i*r+s*c*(1-r))/u)}, ${u})`}const w=["#f2f4fb","#d4d9e5","#98a2b3","#696f7d","#353642"],S=w.slice(),M=w.slice().reverse(),A={id:"neutral",name:"Neutral",colorCount:S.length,type:"categorical",getColor:(e,t)=>t?M[e]:S[e]};function I(e,t){switch(e.type){case"matchExactly":return Array.isArray(t)?e.values.some((e=>Array.isArray(e)&&e.length===t.length&&e.every(((e,n)=>e===t[n])))):e.values.includes(`${t}`);case"matchExactlyCI":return e.values.some((e=>e.toLowerCase()===`${t}`.toLowerCase()));case"range":return"number"==typeof t&&function(e,t){return e.min===e.max&&e.min===t||(e.minInclusive?t>=e.min:t>e.min)&&(e.maxInclusive?t<=e.max:t<e.max)}(e,t);default:return!1}}new Map([["__other__",c.i18n.translate("coloring.colorMapping.terms.otherBucketLabel",{defaultMessage:"Other"})],["",c.i18n.translate("coloring.colorMapping.terms.emptyLabel",{defaultMessage:"(empty)"})]]);const P=["#20377d","#7de2d1","#ff957d","#f04e98","#0077cc","#fec514"],E={id:"elastic_brand_2023",name:"Elastic Brand",colorCount:P.length,type:"categorical",getColor:(e,t,n)=>P[n?e%P.length:e]},k=["#54b399","#6092c0","#d36086","#9170b8","#ca8eae","#d6bf57","#b9a888","#da8b45","#aa6556","#e7664c"],z={id:"eui_amsterdam_color_blind",name:"Default",colorCount:k.length,type:"categorical",getColor:(e,t,n)=>k[n?e%k.length:e]},L=["#00a69b","#57c17b","#6f87d8","#663db8","#bc52bc","#9e3533","#daa05d"],_={id:"kibana_v7_legacy",name:"Kibana Legacy",colorCount:L.length,type:"categorical",getColor:(e,t,n)=>L[n?e%L.length:e]},T=new Map([[z.id,z],[E.id,E],[_.id,_],[A.id,A]]);function F(e,t,n,a,i,r){switch(t.type){case"colorCode":case"categorical":case"loop":return V(t,n,a);case"gradient":{if("categorical"===e.type)return"red";const t=function(e,t,n){const a=1===e.steps.length?[V(e.steps[0],t,n),C(O(V(e.steps[0],t,n),.3),n?"black":"white")]:e.steps.map((e=>V(e,t,n)));a.sort((()=>"asc"===e.sort?-1:1));const i=y.a.scale(a).mode("lab");return e=>i(e).hex()}(e,n,a);return 0===r?"red":t(1===r?0:i/(r-1))}}}function V(e,t,n){return"colorCode"===e.type?e.colorCode:x(t(e.paletteId).getColor(e.colorIndex,n,!0)).hex()}var R=n(6);const N=e=>e.respectSourceOrder?([,e],[,t])=>{var n,a;const[i]=null!==(n=e.inputIndex)&&void 0!==n?n:[],[r]=null!==(a=t.inputIndex)&&void 0!==a?a:[];return void 0!==i&&void 0!==r?i-r:t.value-e.value}:void 0,D=(e,t,n)=>{var a;if(null!=e&&null!==(a=e.meta)&&void 0!==a&&a.params){const n=null!=e&&e.id?t[null==e?void 0:e.id]:void 0;if(n)return n}if(null!=e&&e.format)return n(e.format)},B=(e,t,n)=>{var a;return null!==(a=D(e,t,n))&&void 0!==a?a:n()},$=(e,t,n,a)=>{const i=D(t,n,a);var r;return i?null!==(r=i.convert(e))&&void 0!==r?r:"":String(e)},H=e=>[R.a.MOSAIC,R.a.TREEMAP].includes(e);function G(e){return Object(s.isMultiFieldKey)(e)?e.keys.map(String):`${e}`}const U=(e,t,n,a)=>e===R.a.MOSAIC?((e,t,n)=>(a,i,r)=>{if(2===t&&0===e)return"rgba(0,0,0,0)";const o=r[l.PATH_KEY],s=G(2===t?o[3].value:o[2].value);return n(s)})(t,n,a):((e,t,n)=>(a,i,r)=>{const o=G(r[l.PATH_KEY][2].value),s=n(o);return Object(d.lightenColor)(s,e+1,t)})(t,n,a),W=c.i18n.translate("expressionPartitionVis.emptySlice",{defaultMessage:"(empty)"}),K=(e,t,n,a,i={},r,o,l,s,c,u)=>{var m;const v={valueFont:{fontWeight:700}};n.labels.values||(v.valueFormatter=()=>"");const g=Boolean(n.dimensions.splitColumn||n.dimensions.splitRow);let f;!c&&null!==(m=t[1])&&void 0!==m&&m.id&&o&&n.palette&&(f=((e,t,n,{params:a},i,r)=>{const o=new Map(e.map((e=>{var n;return[$(e[null!==(n=t.id)&&void 0!==n?n:""],t,i,r.deserialize),void 0]})));let l=0;return{getColor:e=>{const t=String(e);if(!o.has(t))return;let i=o.get(t);return i||(i=n.getCategoricalColor([{name:t,totalSeriesAtDepth:o.size,rankAtDepth:l++}],{behindText:!1},a)||void 0,o.set(t,i),i)}}})(r,t[1],null==o?void 0:o.get(n.palette.name),n.palette,l,s));const p=((e,t,n,a)=>({[R.a.PIE]:()=>N(t),[R.a.DONUT]:()=>N(t),[R.a.WAFFLE]:()=>([,e],[,t])=>t.value-e.value,[R.a.TREEMAP]:()=>{},[R.a.MOSAIC]:()=>((e,t)=>{var n;const a=null!==(n=t[0])&&void 0!==n&&n.id?(i=e,r=t[0].id,[...new Set(i.rows.map((e=>e[r])))].reduce(((e,t,n)=>(e[t]=n,e)),{})):{};var i,r;return([e,n],[i,r])=>1===t.length||n.children.length&&e in a&&r.children.length&&i in a?a[e]-a[i]:r.value-n.value})(n,a)}[e]()))(e,n,a,t),b=oe(r,t),y=function(e,t,n,a,i){var r,o,l;const{colorMapping:s,dimensions:c}=i;if(!s)return;if(!(e!==R.a.DONUT&&e!==R.a.PIE&&e!==R.a.TREEMAP||c.buckets&&0!==(null===(r=c.buckets)||void 0===r?void 0:r.length)))return;const u=e===R.a.MOSAIC&&2===t.length?Object(h.c)(n,null===(o=t[1])||void 0===o?void 0:o.id):Object(h.c)(n,null===(l=t[0])||void 0===l?void 0:l.id);return function({assignments:e,specialAssignments:t,colorMode:n,paletteId:a},i,r,o){const l="categories"===o.type?e.filter((e=>"auto"===e.rule.type||"matchExactly"===e.rule.type&&0===e.rule.values.length)):[],s="categories"===o.type?o.categories.filter((t=>!e.some((({rule:e})=>I(e,t))))):[],c=Object(j.findLast)(e,(e=>"categorical"===e.color.type)),u="categorical"===(null==c?void 0:c.color.type)?c.color.colorIndex+1:0;return o=>{if("string"==typeof o||Array.isArray(o)){const c=s.indexOf(o);if(c>-1){if(c<l.length){const t=e.findIndex((e=>e===l[c]));return F(n,l[c].color,i,r,t,e.length)}const o=e.length||s.length,d=(c-l.length)%o;return F(n,"loop"===t[0].color.type?"gradient"===n.type?{type:"gradient"}:{type:"loop",colorIndex:c-l.length+u,paletteId:a}:t[0].color,i,r,d,o)}}const c=e.findIndex((({rule:e})=>I(e,o)));if(c>-1){const t=e[c];return F(n,t.color,i,r,c,e.length)}return V({type:"categorical",paletteId:A.id,colorIndex:1},i,r)}}(JSON.parse(s),function(e,t){return n=>{var a;return null!==(a=e.get(n))&&void 0!==a?a:t}}(T,A),a,{type:"categories",categories:u})}(e,t,r,u,n);return t.map(((a,m)=>{var h,x;return{groupByRollup:e=>{var t;return a.id?null!==(t=e[a.id])&&void 0!==t?t:W:a.name},showAccessor:e=>!0,nodeLabel:e=>$(e,a,l,s.deserialize),fillLabel:0===m&&e===R.a.MOSAIC?{...v,minFontSize:14,maxFontSize:14,clipText:!0}:v,sortPredicate:null!==(h=a.meta)&&void 0!==h&&null!==(x=h.sourceParams)&&void 0!==x&&x.consolidatedMetricsColumn?([,e],[,t])=>{var n,a;const[i]=null!==(n=e.inputIndex)&&void 0!==n?n:[],[r]=null!==(a=t.inputIndex)&&void 0!==a?a:[];return void 0!==i&&void 0!==r?i-r:t.value-e.value}:p,shape:{fillColor:y?U(e,m,t.length,y):(v,h,p)=>((e,t,n,a,i,r={},o,{columnsLength:l,rowsLength:s},c,u,m,v,h,g,f,p)=>{var b,y,x;const O=h?"rgba(0,0,0,0)":"rgba(255,255,255,0)",C=f.format&&null!==(b=g.deserialize(f.format).convert(t))&&void 0!==b?b:"";if(c.distinctColors)return((e,t,n={},a,i,r,{parentSeries:o,allSeries:l},s)=>{var c,u;if(n.hasOwnProperty(e))return n[e];if(n.hasOwnProperty(s))return n[s];const d=l.findIndex((t=>Object(j.isEqual)(t,e))),m=t&&o.includes(e);return null==i?void 0:i.get(a.palette.name).getCategoricalColor([{name:e,rankAtDepth:m?o.findIndex((t=>t===e)):d>-1?d:0,totalSeriesAtDepth:m?o.length:l.length||1}],{maxDepth:1,totalSeries:l.length||1,behindText:a.labels.show,syncColors:r},null!==(c=null===(u=a.palette)||void 0===u?void 0:u.params)&&void 0!==c?c:{colors:[]})})(t,i,r,c,u,v,o,C)||O;const w=((e,t,n,a,i,r)=>{const o=[];let l=e;for(;l.parent&&l.depth>0;){const e=l.parent.children[l.sortIndex][0],s=String(e),c=n&&t.includes(s),u=$(e,r,a,i.deserialize);o.unshift({name:null!=u?u:s,rankAtDepth:c?t.findIndex((e=>e===s)):l.sortIndex,totalSeriesAtDepth:c?t.length:l.parent.children.length}),l=l.parent}return o})(n,o.parentSeries,i,p,g,f),S=((e,t,n)=>{let a;return t.hasOwnProperty(n)&&(a=t[n]),e.forEach((e=>{Object.keys(t).includes(e.name)&&(a=t[e.name])})),a})(w,r,C);if(S)return Object(d.lightenColor)(S,w.length,l);if(e===R.a.MOSAIC&&m&&w[1])return m.getColor(w[1].name)||O;if(H(e)){if(a<l-1)return O;w.length>1&&(e===R.a.MOSAIC?w.shift():w.pop())}return(null==u?void 0:u.get(c.palette.name).getCategoricalColor(w,{behindText:c.labels.show||H(e),maxDepth:l,totalSeries:s,syncColors:v},null!==(y=null===(x=c.palette)||void 0===x?void 0:x.params)&&void 0!==y?y:{colors:[]}))||O})(e,v,p,m,g,i,b,{columnsLength:t.length,rowsLength:r.length},n,o,f,c,u,s,a,l)}}}))};var Y=n(7);function Z(e){switch(e){case l.Position.Bottom:return"upCenter";case l.Position.Top:return"downCenter";case l.Position.Left:return"rightCenter";default:return"leftCenter"}}function q(e,t,n){const a=t.find((t=>Object.keys(t).find((n=>t[n]===e)))),i=a&&Object.keys(a).find((t=>a[t]===e));return n.findIndex((e=>e.id===i))+1}const J=Object(r.createContext)(void 0),Q=({anchor:e,color:t,onClose:n,onChange:a,seriesIdentifiers:[i]})=>{var o;const l=i.key,s=Object(r.useContext)(J),c=Object(r.useCallback)((()=>{null==n||n()}),[n]);if(!s)return null;const{legendPosition:m,setColor:v,bucketColumns:h,palette:g,data:f,uiState:p,distinctColors:b}=s,j=null!==(o=null==p?void 0:p.get("vis.colors",{}))&&void 0!==o?o:{},x=Object.keys(j).includes(l.toString());let O=!1;if(!b){const e=function(e,t,n){return t.find((t=>e.id&&t[e.id]===n))}(h[0],f,l)||!h[0].id;if(!e)return null}const C=y()(t).hex();return Object(Y.jsx)(u.EuiOutsideClickDetector,{onOutsideClick:c},Object(Y.jsx)(u.EuiWrappingPopover,{isOpen:!0,ownFocus:!0,display:"block",button:e,anchorPosition:Z(m),closePopover:n,panelPaddingSize:"s"},Object(Y.jsx)(d.ColorPicker,{color:"kibana_palette"===g?C:C.toLowerCase(),onChange:e=>{e&&a(e),v(e,l),e&&O||n()},label:l,maxDepth:h.length,layerIndex:q(l,f,h),useLegacyColors:"kibana_palette"===g,colorIsOverwritten:x,onKeyDown:e=>{13===e.keyCode&&(null==n||n()),O=!0}})))},X=async(e,t)=>{if(!e)return!1;const n=await t.createFiltersFromValueClickAction(e.data);return Boolean(n.length)};function ee(e){return null!=e}const te=1e3,ne=(e,t,n=1)=>{const a=Boolean(e.dimensions.splitColumn||e.dimensions.splitRow),i=(e.labels.position===R.b.INSIDE||a)&&e.labels.show,r=t&&!a?{outerSizeRatio:n*Math.min(te/Math.min(null==t?void 0:t.width,null==t?void 0:t.height),1)}:{outerSizeRatio:void 0},o={};var l;return o.partition={...null!=r?r:{}},e.labels.show&&e.labels.position===R.b.DEFAULT&&e.labels.last_level&&(o.partition.linkLabel={maxCount:Number.POSITIVE_INFINITY,maximumSection:Number.POSITIVE_INFINITY,maxTextLength:null!==(l=e.labels.truncate)&&void 0!==l?l:void 0}),!i&&e.labels.show||(o.partition.linkLabel={maxCount:0,...e.labels.show?{}:{maximumSection:Number.POSITIVE_INFINITY}}),i||!t||a||(o.partition.outerSizeRatio=n),o},ae=e=>e.labels.show?{}:{partition:{fillLabel:{textColor:"rgba(0,0,0,0)"}}},ie=(e,t)=>Object(v.getColumnByAccessor)(e,t.columns),re=(e,t,n,a)=>{const i=Object(v.getColumnByAccessor)(t,e),r=i.id,o=B(i,n,a);return e=>{const t=e[r];if(void 0!==t)return o.convert(t)}},oe=(e,t)=>{const n=t[0].id,a=new Set,i=new Set;return t.forEach((({id:t})=>{t&&e.forEach((e=>{i.add(e[t]),t===n&&a.add(e[n])}))})),{allSeries:[...i],parentSeries:[...a]}},le=e=>Boolean(e),se=e=>e.length>1,ce=(e,t,n=[])=>t===R.c.SHOW||t===R.c.DEFAULT&&((e,t)=>({[R.a.PIE]:()=>se(t),[R.a.DONUT]:()=>se(t),[R.a.TREEMAP]:()=>!1,[R.a.MOSAIC]:()=>!1,[R.a.WAFFLE]:()=>!0}[e]()))(e,n);var ue=n(36),de=n(31);const me={subdued:Object(ue.css)("fill:",de.euiThemeVars.euiTextSubduedColor,";",""),accent:Object(ue.css)("fill:",de.euiThemeVars.euiColorVis0,";","")},ve=({title:e,titleId:t,...n})=>Object(Y.jsx)("svg",i()({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t},n),e?Object(Y.jsx)("title",{id:t},e):null,Object(Y.jsx)("path",{d:"M17.827 21.189a10.001 10.001 0 005.952-7.148c.124-.578-.343-1.091-.935-1.091H14a1 1 0 01-1-1V3.106c0-.592-.513-1.059-1.092-.935a10 10 0 105.919 19.018z",className:me.subdued}),Object(Y.jsx)("path",{d:"M22.462 3.538A12.29 12.29 0 0016.094.16C15.512.048 15 .514 15 1.106V10a1 1 0 001 1h8.895c.591 0 1.057-.512.945-1.094a12.288 12.288 0 00-3.378-6.368z",className:me.accent})),he=({title:e,titleId:t,...n})=>Object(Y.jsx)("svg",i()({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t},n),e?Object(Y.jsx)("title",{id:t},e):null,Object(Y.jsx)("path",{d:"M19.21 21.119a11 11 0 006.595-8.1c.11-.577-.355-1.082-.942-1.082H20.75c-.477 0-.878.342-1.046.788a5.028 5.028 0 11-6.474-6.474c.447-.168.788-.569.788-1.046V1.094c0-.588-.505-1.053-1.082-.943a11 11 0 106.272 20.968h.002z",className:me.subdued}),Object(Y.jsx)("path",{d:"M22.778 3.176A11 11 0 0017.084.154C16.507.042 16 .507 16 1.095v4.116c0 .475.34.875.784 1.044l.14.055A5.026 5.026 0 0119.7 9.17c.168.445.568.784 1.044.784h4.115c.588 0 1.053-.506.942-1.084a11 11 0 00-3.023-5.694z",className:me.accent})),ge=({title:e,titleId:t,...n})=>Object(Y.jsx)("svg",i()({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t},n),e?Object(Y.jsx)("title",{id:t},e):null,Object(Y.jsx)("path",{d:"M0 1a1 1 0 011-1h13a1 1 0 011 1v20a1 1 0 01-1 1H1a1 1 0 01-1-1V1z",className:me.subdued}),Object(Y.jsx)("path",{d:"M17 1a1 1 0 011-1h11a1 1 0 011 1v12a1 1 0 01-1 1H18a1 1 0 01-1-1V1z",className:me.accent}),Object(Y.jsx)("path",{d:"M29 16H18a1 1 0 00-1 1v4a1 1 0 001 1h11a1 1 0 001-1v-4a1 1 0 00-1-1z",className:me.subdued})),fe=({title:e,titleId:t,...n})=>Object(Y.jsx)("svg",i()({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t},n),e?Object(Y.jsx)("title",{id:t}):null,Object(Y.jsx)("path",{className:me.subdued,d:"M2 0a1 1 0 00-1 1v2a1 1 0 001 1h6a1 1 0 001-1V1a1 1 0 00-1-1H2zM2 14a1 1 0 00-1 1v6a1 1 0 001 1h6a1 1 0 001-1v-6a1 1 0 00-1-1H2zM11 13a1 1 0 011-1h6a1 1 0 011 1v8a1 1 0 01-1 1h-6a1 1 0 01-1-1v-8zM12 0a1 1 0 100 2h6a1 1 0 100-2h-6zM21 15a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1h-6a1 1 0 01-1-1v-6zM22 0a1 1 0 00-1 1v4a1 1 0 001 1h6a1 1 0 001-1V1a1 1 0 00-1-1h-6z"}),Object(Y.jsx)("path",{className:me.accent,d:"M11 5a1 1 0 011-1h6a1 1 0 011 1v4a1 1 0 01-1 1h-6a1 1 0 01-1-1V5zM1 7a1 1 0 011-1h6a1 1 0 011 1v4a1 1 0 01-1 1H2a1 1 0 01-1-1V7zM22 8a1 1 0 00-1 1v2a1 1 0 001 1h6a1 1 0 001-1V9a1 1 0 00-1-1h-6z"})),pe=({title:e,titleId:t,...n})=>Object(Y.jsx)("svg",i()({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t},n),e?Object(Y.jsx)("title",{id:t}):null,Object(Y.jsx)("path",{className:me.accent,d:"M16 1a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1V1zM4 13a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1v-2zM17 6a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1V7a1 1 0 00-1-1h-2zM23 0a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1V1a1 1 0 00-1-1h-2zM5 0a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1V1a1 1 0 00-1-1H5zM4 7a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V7zM11 0a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1V1a1 1 0 00-1-1h-2zM10 7a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1V7zM11 12a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 00-1-1h-2zM22 7a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1V7z"}),Object(Y.jsx)("path",{className:me.subdued,d:"M22 13a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1v-2zM4 19a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1v-2zM16 19a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1v-2zM11 18a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 00-1-1h-2zM23 18a1 1 0 00-1 1v2a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 00-1-1h-2zM16 13a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1v-2z"})),be="__pie_chart_split__",ye="__pie_chart_sm__",je=({splitColumnAccessor:e,splitRowAccessor:t})=>e||t?Object(Y.jsx)(o.a.Fragment,null,Object(Y.jsx)(l.GroupBy,{id:be,by:(n,a)=>{const i=e||t;return i?"function"==typeof i?i(a):a[i]:n.id},sort:l.Predicate.DataIndex}),Object(Y.jsx)(l.SmallMultiples,{id:ye,splitVertically:t?be:void 0,splitHorizontally:e?be:void 0,style:{verticalPanelPadding:{outer:.1,inner:.1},horizontalPanelPadding:{outer:.1,inner:.1}}})):null;var xe=n(32);const Oe=({hasNegativeValues:e=!1,chartType:t,renderComplete:n})=>{if(e){const e=Object(Y.jsx)(xe.FormattedMessage,{id:"expressionPartitionVis.negativeValuesFound",defaultMessage:"{chartType} chart can't render with negative values.",values:{chartType:`${t[0].toUpperCase()}${t.slice(1)}`}});return Object(Y.jsx)(d.EmptyPlaceholder,{dataTestSubj:"partitionVisNegativeValues",icon:"warning",iconColor:"warning",message:e,renderComplete:n})}return Object(Y.jsx)(d.EmptyPlaceholder,{dataTestSubj:"partitionVisEmptyValues",icon:(a=t,{[R.a.PIE]:ve,[R.a.DONUT]:he,[R.a.TREEMAP]:ge,[R.a.MOSAIC]:fe,[R.a.WAFFLE]:pe}[a]),renderComplete:n});var a},Ce={name:"199pkds",styles:"display:flex;flex:1 1 auto;min-height:0;min-width:0;width:100%;height:100%"},we={name:"abj0un",styles:"min-height:0;min-width:0;margin-left:auto;margin-right:auto;width:100%;height:100%"},Se=e=>{var t,n,a,o,b,y,j;const{columnCellValueActions:x,visData:O,visParams:C,visType:w,services:S,syncColors:M,interactive:A,overrides:I,hasOpenedOnAggBasedEditor:P}=e,E=Object(r.useMemo)((()=>((e,t)=>{if([R.a.PIE,R.a.DONUT].includes(e))return t;const{last_level:n,truncate:a,...i}=t.labels;return{...t,labels:i}})(w,C)),[C,w]),k=e.chartsThemeService.useChartsBaseTheme(),{table:z,metricAccessor:L,bucketAccessors:_}=Object(r.useMemo)((()=>((e,t=[],n,a)=>{if(n.length<2)return{table:e,metricAccessor:n[0],bucketAccessors:t};const i=null==t?void 0:t.map((t=>Object(v.getColumnByAccessor)(t,e.columns))).filter(g),r=null==n?void 0:n.map((t=>Object(v.getColumnByAccessor)(t,e.columns))).filter(g),o=[],l="metric-name",s="value";e.rows.forEach((e=>{r.forEach((t=>{const n={};i.forEach((({id:t})=>{n[t]=e[t]})),n[l]=a[t.id],n[s]=e[t.id],o.push(n)}))}));const c=[...i,{id:l,name:l,meta:{type:"string",sourceParams:{consolidatedMetricsColumn:!0}}},{id:s,name:s,meta:{type:"number"}}];return{metricAccessor:s,bucketAccessors:[...i.map((({id:e})=>e)),l],table:{type:"datatable",columns:c,rows:o}}})(O,E.dimensions.buckets,E.dimensions.metrics,E.metricsToLabels)),[O,E.dimensions.buckets,E.dimensions.metrics,E.metricsToLabels]),{bucketColumns:T,metricColumn:F}=Object(r.useMemo)((()=>((e,t)=>{const{metric:n,buckets:a}=e;if(a.length>0){const e=a.map((e=>({...Object(v.getColumnByAccessor)(e,t.columns),format:Object(v.getFormatByAccessor)(e,t.columns)}))),i=e[e.length-1].id,r=t.columns.findIndex((e=>e.id===i));return{bucketColumns:e,metricColumn:ie(null!=n?n:{accessor:r+1,type:"vis_dimension",format:{}},t)}}const i=ie(null!=n?n:{accessor:0,type:"vis_dimension",format:{}},t);return{metricColumn:i,bucketColumns:[{name:i.name}]}})({metric:L,buckets:_},z)),[_,L,z]),V=Object(r.useMemo)((()=>((e,t)=>e.columns.reduce(((e,n)=>{var a;return{...e,[n.id]:null!=n&&null!==(a=n.meta)&&void 0!==a&&a.params?t(n.meta.params):void 0}}),{}))(z,S.fieldFormats.deserialize)),[S.fieldFormats.deserialize,z]),N=Object(r.useCallback)((()=>{var t,n;const a=ce(w,E.legendDisplay,T);return null!==(t=null===(n=e.uiState)||void 0===n?void 0:n.get("vis.legendOpen",a))&&void 0!==t?t:a}),[T,e.uiState,E.legendDisplay,w]),[D,$]=Object(r.useState)((()=>N())),H=void 0!==e.uiState,[G,U]=Object(r.useState)(!1),[W,Z]=Object(r.useState)(),q=Object(r.useRef)(null);Object(r.useEffect)((()=>{if(q&&q.current&&G){const e=q.current.getBoundingClientRect().height,t=q.current.getBoundingClientRect().width;Z({width:t,height:e})}}),[G,q]),Object(r.useEffect)((()=>{const e=N();$(e)}),[N]);const oe=Object(r.useCallback)(((t=!0)=>{t&&(e.renderComplete(),U(!0))}),[e]),se=Object(r.useCallback)(((t,n,a,i,r)=>{const o=((e,t,n,a,i,r,o,l)=>{const s=[],c=a.rows.findIndex((n=>e.every(((e,a)=>{const i=t[a].id;if(!i&&!o)return;const r=!i||n[i]===e.groupByRollup;if(!o)return r;const s=(null==l?void 0:l.convert(n[o.id]))||n[o.id];return r&&s===e.smAccessorValue})))),u=Math.floor(c/r);var d;(s.push(...e.map(((e,n)=>{var o,l;const s=a.columns.findIndex((e=>e.id===t[n].id));if(-1!==s)return{column:null!==(o=a.columns[s].meta)&&void 0!==o&&null!==(l=o.sourceParams)&&void 0!==l&&l.consolidatedMetricsColumn?s+c%r:s,row:u,value:e.groupByRollup,table:i}})).filter(Boolean)),o)&&(t[0].id||s.push({column:a.columns.findIndex((e=>e.id===n)),row:c,table:a,value:null===(d=a.columns.find((e=>e.id===n)))||void 0===d?void 0:d.name}),s.push({column:a.columns.findIndex((e=>e.id===o.id)),row:c,table:a,value:e[0].smAccessorValue}));return s})(t,n,F.id,a,O,E.dimensions.metrics.length,i,r);e.fireEvent({name:"filter",data:{data:o}})}),[F.id,O,e,E.dimensions.metrics.length]),ue=Object(r.useCallback)((e=>t=>{const n=((e,t)=>e.columns.reduce(((n,{id:a},i)=>{const r=t.key,o=e.rows.findIndex((e=>e[a]===r));return o>-1&&n.push({table:e,column:i,row:o,value:r}),n}),[]))(e,t);return{name:"filter",data:{negate:!1,data:n}}}),[]),de=Object(r.useCallback)(((t,n=!1)=>{e.fireEvent({...t,data:{...t.data,negate:n}})}),[e]),me=Object(r.useCallback)((()=>{$((t=>{var n;const a=!t;return null===(n=e.uiState)||void 0===n||n.set("vis.legendOpen",a),a}))}),[e.uiState]),ve=Object(r.useCallback)(((t,n)=>{var a,i,r,o;const l=(null===(a=e.uiState)||void 0===a?void 0:a.get("vis.colors"))||{};l[n]!==t&&t?l[n]=t:delete l[n],null===(i=e.uiState)||void 0===i||i.setSilent("vis.colors",null),null===(r=e.uiState)||void 0===r||r.set("vis.colors",l),null===(o=e.uiState)||void 0===o||o.emit("reload")}),[e.uiState]),he=Object(r.useCallback)(((e,t)=>{const n=e[t.id];return Number.isFinite(n)&&n>=0?n:0}),[]),ge=S.fieldFormats.deserialize,fe=B(F,V,ge),{splitColumn:pe,splitRow:be}=E.dimensions,xe=pe?B("string"==typeof pe[0]?Object(v.getColumnByAccessor)(pe[0],z.columns):pe[0],V,ge):be?B("string"==typeof be[0]?Object(v.getColumnByAccessor)(be[0],z.columns):be[0],V,ge):void 0,Se=S.fieldFormats.deserialize({id:"percent",params:{pattern:`0,0.[${"0".repeat(null!==(t=E.labels.percentDecimals)&&void 0!==t?t:f.a)}]%`}}),Me=e.chartsThemeService.useDarkMode(),Ae=Object(r.useMemo)((()=>{var t;return K(w,T,E,z,{...null===(t=e.uiState)||void 0===t?void 0:t.get("vis.colors",{}),...e.visParams.labels.colorOverrides},z.rows,e.palettesRegistry,V,S.fieldFormats,M,Me)}),[w,T,E,z,e.uiState,e.visParams.labels.colorOverrides,e.palettesRegistry,V,S.fieldFormats,M,Me]),Ie=Object(r.useMemo)((()=>A?((e,t,n,a,i,o,s,d)=>({series:[m]})=>{var h;const[g,f]=Object(r.useState)(!1),[p,b]=Object(r.useState)(!0),y=Object(r.useMemo)((()=>t(m)),[m]),j=Object(r.useMemo)((()=>((e,t)=>t.columns.findIndex((({id:n})=>!!t.rows.find((t=>t[n]===e)))))(m.key,o)),[m]),[x,O]=Object(l.useLegendAction)();if(Object(r.useEffect)((()=>{(async()=>{b(await e(y,s))})()}),[y]),-1===j)return null;const C=((e,t,n,a,i)=>{let r="";if(e.dimensions.buckets){const s=(o=e.dimensions.buckets,l=n,(null==o?void 0:o.find((e=>"string"!=typeof e&&e.accessor===l)))||(null==o?void 0:o[l]));r=s?a(Object(v.getFormatByAccessor)(s,t.columns)).convert(i):""}var o,l;return r||i})(i,o,j,d.deserialize,m.key),w=null!==(h=a[j])&&void 0!==h?h:[],S=[];!(e=>e.some((({type:e})=>"cellAction-filter"===e)))(w)&&p&&y&&S.push({name:c.i18n.translate("expressionPartitionVis.legend.filterForValueButtonAriaLabel",{defaultMessage:"Filter for"}),"data-test-subj":`legend-${C}-filterIn`,icon:Object(Y.jsx)(u.EuiIcon,{type:"plusInCircle",size:"m"}),onClick:()=>{f(!1),n(y)}},{name:c.i18n.translate("expressionPartitionVis.legend.filterOutValueButtonAriaLabel",{defaultMessage:"Filter out"}),"data-test-subj":`legend-${C}-filterOut`,icon:Object(Y.jsx)(u.EuiIcon,{type:"minusInCircle",size:"m"}),onClick:()=>{f(!1),n(y,!0)}});const M=o.columns[j].meta;if(w.forEach((e=>{S.push({name:e.displayName,"data-test-subj":`legend-${C}-${e.id}`,icon:Object(Y.jsx)(u.EuiIcon,{type:e.iconType,size:"m"}),onClick:()=>{e.execute([{columnMeta:M,value:m.key}]),f(!1)}})})),0===S.length)return null;const A=[{id:"main",title:C,items:S}],I=Object(Y.jsx)("div",{tabIndex:0,ref:x,role:"button","aria-pressed":"false",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",marginLeft:4,marginRight:4},"data-test-subj":`legend-${C}`,onKeyPress:()=>f(!g),onClick:()=>f(!g),"aria-label":c.i18n.translate("expressionPartitionVis.legend.legendActionsAria",{defaultMessage:"Legend actions"})},Object(Y.jsx)(u.EuiIcon,{size:"s",type:"boxesVertical"}));return Object(Y.jsx)(u.EuiPopover,{button:I,isOpen:g,closePopover:()=>{f(!1),O()},panelPaddingSize:"none",anchorPosition:"upLeft",title:c.i18n.translate("expressionPartitionVis.legend.filterOptionsLegend",{defaultMessage:"{legendDataLabel}, filter options",values:{legendDataLabel:C}})},Object(Y.jsx)(u.EuiContextMenu,{initialPanelId:"main",panels:A}))})(X,ue(z),de,x,E,z,S.data.actions,S.fieldFormats):void 0),[x,ue,de,A,S.data.actions,S.fieldFormats,z,E]),Pe=Object(r.useMemo)((()=>{var e;const t=z.rows.reduce(((e,t)=>e+t[F.id]),0),n=null!==(e=z.rows.map((e=>e[F.id]/t)).filter((e=>e<.02)))&&void 0!==e?e:[];return n.length?1/(1+Math.min(.05*n.length,.2)):1}),[z.rows,F]),{theme:Ee={},...ke}=Object(h.d)(I,"settings"),ze=Object(r.useMemo)((()=>((e,t,n,a,i=1,r)=>{var o,l,s,c,u,d,m;const v=Boolean(t.dimensions.splitColumn||t.dimensions.splitRow),h=a&&!v&&r?{chartPaddings:{top:(1-Math.min(1,te/(null==a?void 0:a.height)))/2*(null==a?void 0:a.height),bottom:(1-Math.min(1,te/(null==a?void 0:a.height)))/2*(null==a?void 0:a.height),left:(1-Math.min(1,te/(null==a?void 0:a.width)))/2*(null==a?void 0:a.height),right:(1-Math.min(1,te/(null==a?void 0:a.width)))/2*(null==a?void 0:a.height)}}:null,g={fontFamily:null===(o=n.barSeriesStyle)||void 0===o||null===(l=o.displayValue)||void 0===l?void 0:l.fontFamily,outerSizeRatio:1,minFontSize:10,maxFontSize:16,emptySizeRatio:0,sectorLineStroke:null===(s=n.lineSeriesStyle)||void 0===s||null===(c=s.point)||void 0===c?void 0:c.fill,sectorLineWidth:1.5,circlePadding:4,linkLabel:{maxCount:5,fontSize:11,textColor:null===(u=n.axes)||void 0===u||null===(d=u.axisTitle)||void 0===d?void 0:d.fill,maxTextLength:null!==(m=t.labels.truncate)&&void 0!==m?m:void 0}},{partition:f={},...p}=((e,t,n,a)=>({[R.a.PIE]:()=>ne(t,n,a),[R.a.DONUT]:()=>((e,...t)=>{const{partition:n,...a}=ne(e,...t);return{...a,partition:{...n,emptySizeRatio:e.emptySizeRatio}}})(t,n,a),[R.a.TREEMAP]:()=>ae(t),[R.a.MOSAIC]:()=>ae(t),[R.a.WAFFLE]:()=>ne(t,n,a)}[e]()))(e,t,a,i);return{partition:{...g,...f},chartMargins:{top:0,bottom:0,left:0,right:0},...null!=h?h:{},...p}})(w,E,k,W,Pe,P)),[w,E,k,W,Pe,P]),Le=document.getElementById("app-fixed-viewport"),_e=null!==(n=E.legendPosition)&&void 0!==n?n:l.Position.Right,Te=pe?re(z.columns,pe[0],V,ge):void 0,Fe=be?re(z.columns,be[0],V,ge):void 0,Ve=pe?Object(v.getColumnByAccessor)(pe[0],z.columns):be?Object(v.getColumnByAccessor)(be[0],z.columns):void 0,Re=(null==O||null===(a=O.meta)||void 0===a?void 0:a.type)===s.ESQL_TABLE_TYPE,Ne=A&&!Re&&_.filter((e=>"metric-name"!==e)).length>0,De={...Le?{boundary:Le}:{},type:E.addTooltip?l.TooltipType.Follow:l.TooltipType.None,actions:Ne?[{disabled:e=>e.length<1,label:e=>0===e.length?c.i18n.translate("expressionPartitionVis.tooltipActions.emptyFilterSelection",{defaultMessage:"Select at least one series to filter"}):c.i18n.translate("expressionPartitionVis.tooltipActions.filterValues",{defaultMessage:"Filter {seriesNumber} series",values:{seriesNumber:e.length}}),onSelect:t=>{const n=((e,t,n)=>{const a=n.rows.findIndex((n=>e.every((({valueAccessor:e,seriesIdentifier:a})=>{if("number"!=typeof e||e<1)return;const i=t[e-1].id;return i?n[i]===a.key:void 0}))));return e.map((({valueAccessor:e})=>{if("number"!=typeof e||e<1)return;const i=t[e-1].id;if(!i)return;const r=n.columns.findIndex((e=>e.id===i));return-1!==r?{column:r,row:a}:void 0})).filter(ee)})(t,T,z);e.fireEvent({name:"multiFilter",data:{data:[{table:z,cells:n}]}})}}]:void 0},Be=Object(r.useMemo)((()=>z.rows.every((e=>0===e[F.id]))),[z.rows,F]),$e=0===z.rows.length,He=z.rows.every((e=>!e[F.id])),Ge=Object(r.useMemo)((()=>z.rows.some((e=>{const t=e[F.id];return"number"==typeof t&&t<0}))),[z.rows,F]),Ue=!E.nestedLegend||((e,t)=>({[R.a.PIE]:()=>le(t),[R.a.DONUT]:()=>le(t),[R.a.TREEMAP]:()=>le(t),[R.a.MOSAIC]:()=>le(t),[R.a.WAFFLE]:()=>!0}[e]()))(w,Ve),We=!($e||He||Be||Ge),{euiTheme:Ke}=Object(u.useEuiTheme)(),Ye=H?(Ze=Ke,Object(Y.css)(we," inset:0;position:absolute;padding:",Ze.size.s,";","")):we;var Ze;const qe=(Je=w,{[R.a.PIE]:l.PartitionLayout.sunburst,[R.a.DONUT]:l.PartitionLayout.sunburst,[R.a.TREEMAP]:l.PartitionLayout.treemap,[R.a.MOSAIC]:l.PartitionLayout.mosaic,[R.a.WAFFLE]:l.PartitionLayout.waffle}[Je]);var Je;const Qe=Object(r.useMemo)((()=>{if(!D||!Ue)return;const[e]=T;if(!e.id)return;const t={};return z.rows.forEach(((n,a)=>{const i=n[e.id];i in t||(t[i]=a)})),(e,n)=>null==e.key?1:null==n.key?-1:t[e.key]-t[n.key]}),[T,Ue,D,z.rows]);return Object(Y.jsx)("div",{css:Ye,"data-test-subj":"partitionVisChart"},We?Object(Y.jsx)("div",{css:Ce,ref:q},Object(Y.jsx)(J.Provider,{value:{legendPosition:_e,setColor:ve,bucketColumns:T,palette:E.palette.name,data:z.rows,uiState:e.uiState,distinctColors:null!==(o=E.distinctColors)&&void 0!==o&&o}},H&&Object(Y.jsx)(d.LegendToggle,{onClick:me,showLegend:D,legendPosition:_e}),Object(Y.jsx)(l.Chart,i()({size:"100%"},Object(h.d)(I,"chart")),Object(Y.jsx)(je,{splitColumnAccessor:Te,splitRowAccessor:Fe}),Object(Y.jsx)(l.Tooltip,De),Object(Y.jsx)(l.Settings,i()({noResults:Object(Y.jsx)(Oe,{chartType:w,renderComplete:oe}),debugState:null!==(b=window._echDebugStateFlag)&&void 0!==b&&b,showLegend:null!=D?D:ce(w,E.legendDisplay,T),legendPosition:_e,legendSize:m.LegendSizeToPixels[null!==(y=E.legendSize)&&void 0!==y?y:m.DEFAULT_LEGEND_SIZE],legendMaxDepth:E.nestedLegend?void 0:1,legendColorPicker:e.uiState?Q:void 0,flatLegend:Ue,legendSort:Qe,legendValues:E.legendStats,onElementClick:([e])=>{const[t]=e;se(t,T,z,Ve,xe)},legendAction:Ie,theme:[{background:{color:"transparent"}},ze,{legend:{labelOptions:{maxLines:E.truncateLegend?null!==(j=E.maxLegendLines)&&void 0!==j?j:1:0}}},...Array.isArray(Ee)?Ee:[Ee]],baseTheme:k,onRenderChange:oe,ariaLabel:e.visParams.ariaLabel,ariaUseDefaultSummary:!e.visParams.ariaLabel,locale:c.i18n.getLocale()},ke)),Object(Y.jsx)(l.Partition,i()({id:w,smallMultiples:ye,data:z.rows,layout:qe,specialFirstInnermostSector:E.startFromSecondLargestSlice,valueAccessor:e=>he(e,F),percentFormatter:e=>Se.convert(e/100),valueGetter:E.labels.show&&E.labels.valuesFormat!==p.d.VALUE&&E.labels.values?p.d.PERCENT:void 0,valueFormatter:e=>E.labels.show&&E.labels.values?fe.convert(e):"",layers:Ae,topGroove:E.labels.show?void 0:0},Object(h.d)(I,"partition")))))):Object(Y.jsx)(Oe,{hasNegativeValues:Ge,chartType:w,renderComplete:oe}))};t.default=Object(r.memo)(Se)}}]);