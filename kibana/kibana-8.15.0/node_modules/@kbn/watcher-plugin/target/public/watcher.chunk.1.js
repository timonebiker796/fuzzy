/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.watcher_bundle_jsonpfunction=window.watcher_bundle_jsonpfunction||[]).push([[1],{38:function(e,t,a){e.exports=a(6)(4)},39:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(25),i=a(15),n=s.__importDefault(a(40));t.default=function(e,t){var a=i.useState(t),s=a[0],o=a[1];return n.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),s}},40:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(15),i="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;t.default=i},41:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var s=void 0;t.setEuiDevProviderWarning=function(e){return s=e},t.getEuiDevProviderWarning=function(){return s},t.emitEuiProviderWarning=function(e){if("function"==typeof s)return s(e);switch(s){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},42:function(e,t,a){var s,i,n,o,r;
/*! Moment Duration Format v2.2.2
 *  https://github.com/jsmreese/moment-duration-format
 *  Date: 2018-02-16
 *
 *  Duration format plugin function for the Moment.js library
 *  http://momentjs.com/
 *
 *  Copyright 2018 John Madhavan-Reese
 *  Released under the MIT license
 */o=this,r=function(e){var t=!1,a=!1,s=!1,i=!1,n="escape years months weeks days hours minutes seconds milliseconds general".split(" "),o=[{type:"seconds",targets:[{type:"minutes",value:60},{type:"hours",value:3600},{type:"days",value:86400},{type:"weeks",value:604800},{type:"months",value:2678400},{type:"years",value:31536e3}]},{type:"minutes",targets:[{type:"hours",value:60},{type:"days",value:1440},{type:"weeks",value:10080},{type:"months",value:44640},{type:"years",value:525600}]},{type:"hours",targets:[{type:"days",value:24},{type:"weeks",value:168},{type:"months",value:744},{type:"years",value:8760}]},{type:"days",targets:[{type:"weeks",value:7},{type:"months",value:31},{type:"years",value:365}]},{type:"months",targets:[{type:"years",value:12}]}];function r(e,t){return!(t.length>e.length)&&-1!==e.indexOf(t)}function c(e){for(var t="";e;)t+="0",e-=1;return t}function l(e,t){var a=e+"+"+b(v(t).sort(),(function(e){return e+":"+t[e]})).join(",");return l.cache[a]||(l.cache[a]=Intl.NumberFormat(e,t)),l.cache[a]}function u(e,t,n){var o,r,d,h=t.useToLocaleString,g=t.useGrouping,m=g&&t.grouping.slice(),p=t.maximumSignificantDigits,j=t.minimumIntegerDigits||1,b=t.fractionDigits||0,x=t.groupingSeparator,w=t.decimalSeparator;if(h&&n){var f,y={minimumIntegerDigits:j,useGrouping:g};return b&&(y.maximumFractionDigits=b,y.minimumFractionDigits=b),p&&e>0&&(y.maximumSignificantDigits=p),s?(i||((f=E({},t)).useGrouping=!1,f.decimalSeparator=".",e=parseFloat(u(e,f),10)),l(n,y).format(e)):(a||((f=E({},t)).useGrouping=!1,f.decimalSeparator=".",e=parseFloat(u(e,f),10)),e.toLocaleString(n,y))}var O=(p?e.toPrecision(p+1):e.toFixed(b+1)).split("e");d=O[1]||"",r=(O=O[0].split("."))[1]||"";var v=(o=O[0]||"").length,k=r.length,M=v+k,T=o+r;(p&&M===p+1||!p&&k===b+1)&&((T=function(e){for(var t=e.split("").reverse(),a=0,s=!0;s&&a<t.length;)a?"9"===t[a]?t[a]="0":(t[a]=(parseInt(t[a],10)+1).toString(),s=!1):(parseInt(t[a],10)<5&&(s=!1),t[a]="0"),a+=1;return s&&t.push("1"),t.reverse().join("")}(T)).length===M+1&&(v+=1),k&&(T=T.slice(0,-1)),o=T.slice(0,v),r=T.slice(v)),p&&(r=r.replace(/0*$/,""));var S=parseInt(d,10);S>0?r.length<=S?(o+=r+=c(S-r.length),r=""):(o+=r.slice(0,S),r=r.slice(S)):S<0&&(r=c(Math.abs(S)-o.length)+o+r,o="0"),p||((r=r.slice(0,b)).length<b&&(r+=c(b-r.length)),o.length<j&&(o=c(j-o.length)+o));var _,A="";if(g)for(O=o;O.length;)m.length&&(_=m.shift()),A&&(A=x+A),A=O.slice(-_)+A,O=O.slice(0,-_);else A=o;return r&&(A=A+w+r),A}function d(e,t){return e.label.length>t.label.length?-1:e.label.length<t.label.length?1:0}l.cache={};var h={durationLabelsStandard:{S:"millisecond",SS:"milliseconds",s:"second",ss:"seconds",m:"minute",mm:"minutes",h:"hour",hh:"hours",d:"day",dd:"days",w:"week",ww:"weeks",M:"month",MM:"months",y:"year",yy:"years"},durationLabelsShort:{S:"msec",SS:"msecs",s:"sec",ss:"secs",m:"min",mm:"mins",h:"hr",hh:"hrs",d:"dy",dd:"dys",w:"wk",ww:"wks",M:"mo",MM:"mos",y:"yr",yy:"yrs"},durationTimeTemplates:{HMS:"h:mm:ss",HM:"h:mm",MS:"m:ss"},durationLabelTypes:[{type:"standard",string:"__"},{type:"short",string:"_"}],durationPluralKey:function(e,t,a){return 1===t&&null===a?e:e+e}};function g(e){return"[object Array]"===Object.prototype.toString.call(e)}function m(e){return"[object Object]"===Object.prototype.toString.call(e)}function p(e,t){var a,s=0,i=e&&e.length||0;for("function"!=typeof t&&(a=t,t=function(e){return e===a});s<i;){if(t(e[s]))return e[s];s+=1}}function j(e,t){var a=0,s=e.length;if(e&&s)for(;a<s;){if(!1===t(e[a],a))return;a+=1}}function b(e,t){var a=0,s=e.length,i=[];if(!e||!s)return i;for(;a<s;)i[a]=t(e[a],a),a+=1;return i}function x(e,t){return b(e,(function(e){return e[t]}))}function w(e){var t=[];return j(e,(function(e){e&&t.push(e)})),t}function f(e){var t=[];return j(e,(function(e){p(t,e)||t.push(e)})),t}function y(e,t){var a=[];return j(e,(function(e){j(t,(function(t){e===t&&a.push(e)}))})),f(a)}function O(e,t){var a=[];return j(e,(function(s,i){if(!t(s))return a=e.slice(i),!1})),a}function E(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}function v(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(a);return t}function k(e,t){var a=0,s=e.length;if(!e||!s)return!1;for(;a<s;){if(!0===t(e[a],a))return!0;a+=1}return!1}function M(e){return"3.6"===e(3.55,"en",{useGrouping:!1,minimumIntegerDigits:1,minimumFractionDigits:1,maximumFractionDigits:1})}function T(e){var t=!0;return!!((t=(t=(t=t&&"1"===e(1,"en",{minimumIntegerDigits:1}))&&"01"===e(1,"en",{minimumIntegerDigits:2}))&&"001"===e(1,"en",{minimumIntegerDigits:3}))&&(t=(t=(t=(t=t&&"100"===e(99.99,"en",{maximumFractionDigits:0,minimumFractionDigits:0}))&&"100.0"===e(99.99,"en",{maximumFractionDigits:1,minimumFractionDigits:1}))&&"99.99"===e(99.99,"en",{maximumFractionDigits:2,minimumFractionDigits:2}))&&"99.990"===e(99.99,"en",{maximumFractionDigits:3,minimumFractionDigits:3}))&&(t=(t=(t=(t=(t=t&&"100"===e(99.99,"en",{maximumSignificantDigits:1}))&&"100"===e(99.99,"en",{maximumSignificantDigits:2}))&&"100"===e(99.99,"en",{maximumSignificantDigits:3}))&&"99.99"===e(99.99,"en",{maximumSignificantDigits:4}))&&"99.99"===e(99.99,"en",{maximumSignificantDigits:5}))&&(t=(t=t&&"1,000"===e(1e3,"en",{useGrouping:!0}))&&"1000"===e(1e3,"en",{useGrouping:!1})))}function S(){var e,t=[].slice.call(arguments),a={};if(j(t,(function(t,s){if(!s){if(!g(t))throw"Expected array as the first argument to durationsFormat.";e=t}"string"!=typeof t&&"function"!=typeof t?"number"!=typeof t?m(t)&&E(a,t):a.precision=t:a.template=t})),!e||!e.length)return[];a.returnMomentTypes=!0;var s,i=b(e,(function(e){return e.format(a)})),o=y(n,f(x((s=[],j(i,(function(e){s=s.concat(e)})),s),"type"))),r=a.largest;return r&&(o=o.slice(0,r)),a.returnMomentTypes=!1,a.outputTypes=o,b(e,(function(e){return e.format(a)}))}function _(){var a=[].slice.call(arguments),i=E({},this.format.defaults),c=this.asMilliseconds(),l=this.asMonths();"function"==typeof this.isValid&&!1===this.isValid()&&(c=0,l=0);var M=c<0,T=e.duration(Math.abs(c),"milliseconds"),S=e.duration(Math.abs(l),"months");j(a,(function(e){"string"!=typeof e&&"function"!=typeof e?"number"!=typeof e?m(e)&&E(i,e):i.precision=e:i.template=e}));var _={years:"y",months:"M",weeks:"w",days:"d",hours:"h",minutes:"m",seconds:"s",milliseconds:"S"},A={escape:/\[(.+?)\]/,years:/\*?[Yy]+/,months:/\*?M+/,weeks:/\*?[Ww]+/,days:/\*?[Dd]+/,hours:/\*?[Hh]+/,minutes:/\*?m+/,seconds:/\*?s+/,milliseconds:/\*?S+/,general:/.+?/};i.types=n;var F=function(e){return p(n,(function(t){return A[t].test(e)}))},I=new RegExp(b(n,(function(e){return A[e].source})).join("|"),"g");i.duration=this;var J="function"==typeof i.template?i.template.apply(i):i.template,L=i.outputTypes,C=i.returnMomentTypes,W=i.largest,D=[];L||(g(i.stopTrim)&&(i.stopTrim=i.stopTrim.join("")),i.stopTrim&&j(i.stopTrim.match(I),(function(e){var t=F(e);"escape"!==t&&"general"!==t&&D.push(t)})));var N=e.localeData();N||(N={}),j(v(h),(function(e){"function"!=typeof h[e]?N["_"+e]||(N["_"+e]=h[e]):N[e]||(N[e]=h[e])})),j(v(N._durationTimeTemplates),(function(e){J=J.replace("_"+e+"_",N._durationTimeTemplates[e])}));var P=i.userLocale||e.locale(),R=i.useLeftUnits,B=i.usePlural,z=i.precision,H=i.forceLength,U=i.useGrouping,q=i.trunc,V=i.useSignificantDigits&&z>0,G=V?i.precision:0,$=G,K=i.minValue,Y=!1,X=i.maxValue,Z=!1,Q=i.useToLocaleString,ee=i.groupingSeparator,te=i.decimalSeparator,ae=i.grouping;Q=Q&&(t||s);var se=i.trim;g(se)&&(se=se.join(" ")),null===se&&(W||X||V)&&(se="all"),null!==se&&!0!==se&&"left"!==se&&"right"!==se||(se="large"),!1===se&&(se="");var ie=function(e){return e.test(se)},ne=/both/,oe=/^all|[^sm]all/,re=W>0||k([/large/,ne,oe],ie),ce=k([/small/,ne,oe],ie),le=k([/mid/,oe],ie),ue=k([/final/,oe],ie),de=b(J.match(I),(function(e,t){var a=F(e);return"*"===e.slice(0,1)&&(e=e.slice(1),"escape"!==a&&"general"!==a&&D.push(a)),{index:t,length:e.length,text:"",token:"escape"===a?e.replace(A.escape,"$1"):e,type:"escape"===a||"general"===a?null:a}})),he={index:0,length:0,token:"",text:"",type:null},ge=[];R&&de.reverse(),j(de,(function(e){if(e.type)return(he.type||he.text)&&ge.push(he),void(he=e);R?he.text=e.token+he.text:he.text+=e.token})),(he.type||he.text)&&ge.push(he),R&&ge.reverse();var me=y(n,f(w(x(ge,"type"))));if(!me.length)return x(ge,"text").join("");me=b(me,(function(e,t){var a,s=t+1===me.length,n=!t;a="years"===e||"months"===e?S.as(e):T.as(e);var o=Math.floor(a),r=a-o,c=p(ge,(function(t){return e===t.type}));return n&&X&&a>X&&(Z=!0),s&&K&&Math.abs(i.duration.as(e))<K&&(Y=!0),n&&null===H&&c.length>1&&(H=!0),T.subtract(o,e),S.subtract(o,e),{rawValue:a,wholeValue:o,decimalValue:s?r:0,isSmallest:s,isLargest:n,type:e,tokenLength:c.length}}));var pe,je=q?Math.floor:Math.round,be=function(e,t){var a=Math.pow(10,t);return je(e*a)/a},xe=!1,we=!1,fe=function(e,t){var a={useGrouping:U,groupingSeparator:ee,decimalSeparator:te,grouping:ae,useToLocaleString:Q};return V&&(G<=0?(e.rawValue=0,e.wholeValue=0,e.decimalValue=0):(a.maximumSignificantDigits=G,e.significantDigits=G)),Z&&!we&&(e.isLargest?(e.wholeValue=X,e.decimalValue=0):(e.wholeValue=0,e.decimalValue=0)),Y&&!we&&(e.isSmallest?(e.wholeValue=K,e.decimalValue=0):(e.wholeValue=0,e.decimalValue=0)),e.isSmallest||e.significantDigits&&e.significantDigits-e.wholeValue.toString().length<=0?z<0?e.value=be(e.wholeValue,z):0===z?e.value=je(e.wholeValue+e.decimalValue):V?(e.value=q?be(e.rawValue,G-e.wholeValue.toString().length):e.rawValue,e.wholeValue&&(G-=e.wholeValue.toString().length)):(a.fractionDigits=z,e.value=q?e.wholeValue+be(e.decimalValue,z):e.wholeValue+e.decimalValue):V&&e.wholeValue?(e.value=Math.round(be(e.wholeValue,e.significantDigits-e.wholeValue.toString().length)),G-=e.wholeValue.toString().length):e.value=e.wholeValue,e.tokenLength>1&&(H||xe)&&(a.minimumIntegerDigits=e.tokenLength,we&&a.maximumSignificantDigits<e.tokenLength&&delete a.maximumSignificantDigits),!xe&&(e.value>0||""===se||p(D,e.type)||p(L,e.type))&&(xe=!0),e.formattedValue=u(e.value,a,P),a.useGrouping=!1,a.decimalSeparator=".",e.formattedValueEn=u(e.value,a,"en"),2===e.tokenLength&&"milliseconds"===e.type&&(e.formattedValueMS=u(e.value,{minimumIntegerDigits:3,useGrouping:!1},"en").slice(0,2)),e};if((me=w(me=b(me,fe))).length>1){var ye=function(e){return p(me,(function(t){return t.type===e}))};j(o,(function(e){var t=ye(e.type);t&&j(e.targets,(function(e){var a=ye(e.type);a&&parseInt(t.formattedValueEn,10)===e.value&&(t.rawValue=0,t.wholeValue=0,t.decimalValue=0,a.rawValue+=1,a.wholeValue+=1,a.decimalValue=0,a.formattedValueEn=a.wholeValue.toString(),we=!0)}))}))}return we&&(xe=!1,G=$,me=w(me=b(me,fe))),!L||Z&&!i.trim?(re&&(me=O(me,(function(e){return!e.isSmallest&&!e.wholeValue&&!p(D,e.type)}))),W&&me.length&&(me=me.slice(0,W)),ce&&me.length>1&&(pe=function(e){return!e.wholeValue&&!p(D,e.type)&&!e.isLargest},me=O(me.slice().reverse(),pe).reverse()),le&&(me=w(me=b(me,(function(e,t){return t>0&&t<me.length-1&&!e.wholeValue?null:e})))),!ue||1!==me.length||me[0].wholeValue||!q&&me[0].isSmallest&&me[0].rawValue<K||(me=[])):me=w(me=b(me,(function(e){return p(L,(function(t){return e.type===t}))?e:null}))),C?me:(j(ge,(function(e){var t=_[e.type],a=p(me,(function(t){return t.type===e.type}));if(t&&a){var s=a.formattedValueEn.split(".");s[0]=parseInt(s[0],10),s[1]?s[1]=parseFloat("0."+s[1],10):s[1]=null;var i=N.durationPluralKey(t,s[0],s[1]),n=function(e,t){var a=[];return j(v(t),(function(s){if("_durationLabels"===s.slice(0,15)){var i=s.slice(15).toLowerCase();j(v(t[s]),(function(n){n.slice(0,1)===e&&a.push({type:i,key:n,label:t[s][n]})}))}})),a}(t,N),o=!1,c={};j(N._durationLabelTypes,(function(t){var a=p(n,(function(e){return e.type===t.type&&e.key===i}));a&&(c[a.type]=a.label,r(e.text,t.string)&&(e.text=e.text.replace(t.string,a.label),o=!0))})),B&&!o&&(n.sort(d),j(n,(function(t){return c[t.type]===t.label?!r(e.text,t.label)&&void 0:r(e.text,t.label)?(e.text=e.text.replace(t.label,c[t.type]),!1):void 0})))}})),(ge=b(ge,(function(e){if(!e.type)return e.text;var t=p(me,(function(t){return t.type===e.type}));if(!t)return"";var a="";return R&&(a+=e.text),(M&&Z||!M&&Y)&&(a+="< ",Z=!1,Y=!1),(M&&Y||!M&&Z)&&(a+="> ",Z=!1,Y=!1),M&&(t.value>0||""===se||p(D,t.type)||p(L,t.type))&&(a+="-",M=!1),"milliseconds"===e.type&&t.formattedValueMS?a+=t.formattedValueMS:a+=t.formattedValue,R||(a+=e.text),a}))).join("").replace(/(,| |:|\.)*$/,"").replace(/^(,| |:|\.)*/,""))}function A(){var e=this.duration,t=function(t){return e._data[t]},a=p(this.types,t),s=function(e,t){for(var a=e.length;a-=1;)if(t(e[a]))return e[a]}(this.types,t);switch(a){case"milliseconds":return"S __";case"seconds":case"minutes":return"*_MS_";case"hours":return"_HMS_";case"days":if(a===s)return"d __";case"weeks":return a===s?"w __":(null===this.trim&&(this.trim="both"),"w __, d __, h __");case"months":if(a===s)return"M __";case"years":return a===s?"y __":(null===this.trim&&(this.trim="both"),"y __, M __, d __");default:return null===this.trim&&(this.trim="both"),"y __, d __, h __, m __, s __"}}function F(e){if(!e)throw"Moment Duration Format init cannot find moment instance.";e.duration.format=S,e.duration.fn.format=_,e.duration.fn.format.defaults={trim:null,stopTrim:null,largest:null,maxValue:null,minValue:null,precision:0,trunc:!1,forceLength:null,userLocale:null,usePlural:!0,useLeftUnits:!1,useGrouping:!0,useSignificantDigits:!1,template:A,useToLocaleString:!0,groupingSeparator:",",decimalSeparator:".",grouping:[3]},e.updateLocale("en",h)}var I=function(e,t,a){return e.toLocaleString(t,a)};t=function(){try{(0).toLocaleString("i")}catch(e){return"RangeError"===e.name}return!1}()&&T(I),a=t&&M(I);var J=function(e,t,a){if("undefined"!=typeof window&&window&&window.Intl&&window.Intl.NumberFormat)return window.Intl.NumberFormat(t,a).format(e)};return s=T(J),i=s&&M(J),F(e),F},i=[a(24)],void 0===(n="function"==typeof(s=r)?s.apply(t,i):s)||(e.exports=n),o&&(o.momentDurationFormatSetup=o.moment?r(o.moment):r)},43:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(25),i=a(44),n=s.__importDefault(a(46));t.default=function(e,t){n.default(e,t,i.isDeepEqual)}},44:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var s=a(25).__importDefault(a(45));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=s.default},45:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var s,i,n;if(Array.isArray(t)){if((s=t.length)!=a.length)return!1;for(i=s;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((s=(n=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=s;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,n[i]))return!1;for(i=s;0!=i--;){var o=n[i];if(!("_owner"===o&&t.$$typeof||e(t[o],a[o])))return!1}return!0}return t!=t&&a!=a}},46:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(15);t.default=function(e,t,a){var i=s.useRef(void 0);i.current&&a(t,i.current)||(i.current=t),s.useEffect(e,i.current)}},48:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return Oa}));var s=a(15),i=a.n(s),n=a(30),o=a(20),r=a(21),c=a(38),l=a.n(c),u=a(31),d=a(41),h=a(39),g=a.n(h),m=a(32),p=a.n(m),j=a(17);const b="eui-global",x="eui-utilities",w={darkMode:!1};var f=a(16);const y=[j.euiStylisPrefixer],O=p()({key:"css",stylisPlugins:y,container:document.querySelector('meta[name="emotion"]')}),E=p()({key:b,stylisPlugins:y,container:document.querySelector(`meta[name="${b}"]`)}),v=p()({key:x,stylisPlugins:y,container:document.querySelector(`meta[name="${x}"]`)});O.compat=!0,E.compat=!0,v.compat=!0;const k={default:O,global:E,utility:v},M=({theme:{theme$:e},globalStyles:t,colorMode:a,modify:i,children:n})=>{const o=g()(e,w),r=Object(s.useMemo)((()=>(e=>e.darkMode?j.COLOR_MODES_STANDARD.dark:j.COLOR_MODES_STANDARD.light)(o)),[o]),c=a||r,l=!1!==t&&void 0;return Object(f.jsx)(j.EuiProvider,{cache:k,modify:i,colorMode:c,globalStyles:l,utilityClasses:l},n)},T=({children:e,i18n:t,...a})=>Object(u.useIsNestedEuiProvider)()?(Object(d.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(f.jsx)(t.Context,null,e)):Object(f.jsx)(M,a,Object(f.jsx)(t.Context,null,e));var S=a(33);const _=({children:e,...t})=>Object(f.jsx)(T,l()({globalStyles:!1},t),Object(f.jsx)(S.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(f.jsx)(S.KibanaErrorBoundary,null,e)));var A=a(22),F=a(29);const I=({children:e,...t})=>Object(f.jsx)(A.Router,t,Object(f.jsx)(F.CompatRouter,null,e));var J=a(18),L=a.n(J);const C={services:{}},W=Object(s.createContext)(C);var D=a(43),N=a.n(D);const P=({children:e,component:t,render:a,...n})=>{const o=Object(s.useMemo)((()=>{if(t)return e=>Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(R,null),Object(f.jsx)(t,e))}),[t]);if(o)return Object(f.jsx)(A.Route,l()({},n,{component:o}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(f.jsx)(A.Route,l()({},n,{render:e=>Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(R,null),t(e))}))}return Object(f.jsx)(A.Route,n,Object(f.jsx)(R,null),e)},R=()=>{const{executionContext:e}=Object(s.useContext)(W).services,t=Object(A.useRouteMatch)();return function(e,t){N()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null},B=({legacySwitch:e=!0,children:t})=>{const a=Object(A.useRouteMatch)();return e?Object(f.jsx)(A.Switch,null,t):Object(f.jsx)(F.Routes,null,s.Children.map(t,(e=>{if(i.a.isValidElement(e)&&e.type===P){var s;const n=Object(J.replace)(null==e?void 0:e.props.path,a.url+"/",""),o="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(f.jsx)(F.Route,{path:n,element:Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(R,null),(null==e||null===(s=e.props)||void 0===s?void 0:s.component)&&Object(f.jsx)(e.props.component,null)||o&&o()||t)})}return e})))};var z=a(0),H=a(19);const U={text:z.i18n.translate("xpack.watcher.breadcrumb.listLabel",{defaultMessage:"Watcher"}),href:"/watches"},q={text:z.i18n.translate("xpack.watcher.breadcrumb.createLabel",{defaultMessage:"Create"})},V={text:z.i18n.translate("xpack.watcher.breadcrumb.editLabel",{defaultMessage:"Edit"})},G={text:z.i18n.translate("xpack.watcher.breadcrumb.statusLabel",{defaultMessage:"Status"})};class Settings{constructor(e){this.actionTypes=e.actionTypes}static fromUpstreamJson(e){const t=e.action_types;return new Settings({actionTypes:t})}}var $=a(3),K=a.n($),Y=a(23),X=a(2),Z=a(28);class base_action_BaseAction{constructor(e={}){this.id=Object(J.get)(e,"id"),this.type=Object(J.get)(e,"type"),this.isNew=Object(J.get)(e,"isNew",!1)}get upstreamJson(){return{id:this.id,type:this.type}}get typeName(){return this.constructor.typeName}get iconClass(){return this.constructor.iconClass}get selectMessage(){return this.constructor.selectMessage}get simulateMessage(){return z.i18n.translate("xpack.watcher.models.baseAction.simulateMessage",{defaultMessage:"Action {id} simulated successfully",values:{id:this.id}})}get simulatePrompt(){return this.constructor.simulatePrompt}}K()(base_action_BaseAction,"typeName",z.i18n.translate("xpack.watcher.models.baseAction.typeName",{defaultMessage:"Action"})),K()(base_action_BaseAction,"iconClass","apps"),K()(base_action_BaseAction,"selectMessage",z.i18n.translate("xpack.watcher.models.baseAction.selectMessageText",{defaultMessage:"Perform an action."})),K()(base_action_BaseAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.baseAction.simulateButtonLabel",{defaultMessage:"Simulate this action now"}));class email_action_EmailAction extends base_action_BaseAction{constructor(e={}){super(e);const t=Object(J.get)(e,"to");this.to=Object(J.isArray)(t)?t:t&&[t];const a=z.i18n.translate("xpack.watcher.models.emailAction.defaultSubjectText",{defaultMessage:"Watch [{context}] has exceeded the threshold",values:{context:"{{ctx.metadata.name}}"}});this.subject=Object(J.get)(e,"subject",e.ignoreDefaults?null:a),this.body=Object(J.get)(e,"body")}validate(){const e={to:[]};return this.to&&this.to.length||e.to.push(z.i18n.translate("xpack.watcher.watchActions.email.emailRecipientIsRequiredValidationMessage",{defaultMessage:'"To" email address is required.'})),e}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{to:this.to,subject:this.subject,body:this.body,email:{to:this.to&&this.to.length>0?this.to:void 0,subject:this.subject,body:{text:this.body}}}),e}get simulateMessage(){const e=this.to.join(", ");return z.i18n.translate("xpack.watcher.models.emailAction.simulateMessage",{defaultMessage:"Sample email sent to {toList}",values:{toList:e}})}get simulateFailMessage(){const e=this.to.join(", ");return z.i18n.translate("xpack.watcher.models.emailAction.simulateFailMessage",{defaultMessage:"Failed to send email to {toList}.",values:{toList:e}})}static fromUpstreamJson(e){return new email_action_EmailAction(e)}}K()(email_action_EmailAction,"typeName",z.i18n.translate("xpack.watcher.models.emailAction.typeName",{defaultMessage:"Email"})),K()(email_action_EmailAction,"iconClass","email"),K()(email_action_EmailAction,"selectMessage",z.i18n.translate("xpack.watcher.models.emailAction.selectMessageText",{defaultMessage:"Send an email from your server."})),K()(email_action_EmailAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.emailAction.simulateButtonLabel",{defaultMessage:"Send test email"}));class logging_action_LoggingAction extends base_action_BaseAction{constructor(e={}){super(e);const t=z.i18n.translate("xpack.watcher.models.loggingAction.defaultText",{defaultMessage:"Watch [{context}] has exceeded the threshold",values:{context:"{{ctx.metadata.name}}"}});this.text=Object(J.get)(e,"text",e.ignoreDefaults?null:t)}validate(){const e={text:[]};return this.text||e.text.push(z.i18n.translate("xpack.watcher.watchActions.logging.logTextIsRequiredValidationMessage",{defaultMessage:"Log text is required."})),e}get upstreamJson(){const e=super.upstreamJson;let t;return"string"==typeof this.text?this.text.trim()&&(t=this.text):t=this.text,Object.assign(e,{text:t,logging:{text:t}}),e}get simulateMessage(){return z.i18n.translate("xpack.watcher.models.loggingAction.simulateMessage",{defaultMessage:"Sample message logged"})}get simulateFailMessage(){return z.i18n.translate("xpack.watcher.models.loggingAction.simulateFailMessage",{defaultMessage:"Failed to log sample message."})}static fromUpstreamJson(e){return new logging_action_LoggingAction(e)}}K()(logging_action_LoggingAction,"typeName",z.i18n.translate("xpack.watcher.models.loggingAction.typeName",{defaultMessage:"Logging"})),K()(logging_action_LoggingAction,"iconClass","logsApp"),K()(logging_action_LoggingAction,"selectMessage",z.i18n.translate("xpack.watcher.models.loggingAction.selectMessageText",{defaultMessage:"Add an item to the logs."})),K()(logging_action_LoggingAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.loggingAction.simulateButtonLabel",{defaultMessage:"Log a sample message"}));class slack_action_SlackAction extends base_action_BaseAction{constructor(e={}){super(e);const t=Object(J.get)(e,"to");this.to=Object(J.isArray)(t)?t:t&&[t];const a=z.i18n.translate("xpack.watcher.models.slackAction.defaultText",{defaultMessage:"Watch [{context}] has exceeded the threshold",values:{context:"{{ctx.metadata.name}}"}});this.text=Object(J.get)(e,"text",e.ignoreDefaults?null:a)}validate(){return{to:[],text:[]}}get upstreamJson(){const e=super.upstreamJson,t=this.to&&this.to.length>0?this.to:void 0,a=this.text||t?{text:this.text,to:t}:{};return Object.assign(e,{to:t,text:this.text,slack:{message:a}}),e}get simulateMessage(){const e=this.to&&this.to.join(", ");return z.i18n.translate("xpack.watcher.models.slackAction.simulateMessage",{defaultMessage:"Sample Slack message sent {toList}.",values:{toList:e?`to ${e}`:""}})}get simulateFailMessage(){const e=this.to&&this.to.join(", ");return z.i18n.translate("xpack.watcher.models.slackAction.simulateFailMessage",{defaultMessage:"Failed to send sample Slack message {toList}.",values:{toList:e?`to ${e}`:""}})}static fromUpstreamJson(e){return new slack_action_SlackAction(e)}}K()(slack_action_SlackAction,"typeName",z.i18n.translate("xpack.watcher.models.slackAction.TypeName",{defaultMessage:"Slack"})),K()(slack_action_SlackAction,"iconClass","logoSlack"),K()(slack_action_SlackAction,"selectMessage",z.i18n.translate("xpack.watcher.models.slackAction.selectMessageText",{defaultMessage:"Send a message to a Slack user or channel."})),K()(slack_action_SlackAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.slackAction.simulateButtonLabel",{defaultMessage:"Send a sample message"}));class webhook_action_WebhookAction extends base_action_BaseAction{constructor(e={}){super(e);const t=JSON.stringify({message:"Watch [{{ctx.metadata.name}}] has exceeded the threshold"},null,2);this.body=Object(J.get)(e,"body",e.ignoreDefaults?null:t),this.method=Object(J.get)(e,"method"),this.host=Object(J.get)(e,"host"),this.port=Object(J.get)(e,"port"),this.scheme=Object(J.get)(e,"scheme","http"),this.path=Object(J.get)(e,"path"),this.username=Object(J.get)(e,"username"),this.password=Object(J.get)(e,"password"),this.contentType=Object(J.get)(e,"contentType"),this.fullPath=`${this.host}:${this.port}${this.path?"/"+this.path:""}`}validate(){const e={host:[],port:[],body:[],username:[],password:[]};if(this.host||e.host.push(z.i18n.translate("xpack.watcher.watchActions.webhook.hostIsRequiredValidationMessage",{defaultMessage:"Webhook host is required."})),this.port||e.port.push(z.i18n.translate("xpack.watcher.watchActions.webhook.portIsRequiredValidationMessage",{defaultMessage:"Webhook port is required."})),"application/json"===this.contentType&&"string"==typeof this.body&&""!==this.body){const t=z.i18n.translate("xpack.watcher.watchActions.webhook.invalidJsonValidationMessage",{defaultMessage:"Invalid JSON"});try{const a=JSON.parse(this.body);a&&"object"!=typeof a&&e.body.push(t)}catch(a){e.body.push(t)}}return this.username&&!this.password&&e.password.push(z.i18n.translate("xpack.watcher.watchActions.webhook.passwordIsRequiredIfUsernameValidationMessage",{defaultMessage:"Password is required."})),this.password&&!this.username&&e.username.push(z.i18n.translate("xpack.watcher.watchActions.webhook.usernameIsRequiredIfPasswordValidationMessage",{defaultMessage:"Username is required."})),e}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{method:this.method,host:this.host,port:this.port,scheme:this.scheme,path:this.path,body:this.body,username:this.username,password:this.password,webhook:{host:this.host,port:this.port}}),e}get simulateMessage(){return z.i18n.translate("xpack.watcher.models.webhookAction.simulateMessage",{defaultMessage:"Sample request sent to {fullPath}",values:{fullPath:this.fullPath}})}get simulateFailMessage(){return z.i18n.translate("xpack.watcher.models.webhookAction.simulateFailMessage",{defaultMessage:"Failed to send request to {fullPath}.",values:{fullPath:this.fullPath}})}static fromUpstreamJson(e){return new webhook_action_WebhookAction(e)}}K()(webhook_action_WebhookAction,"typeName",z.i18n.translate("xpack.watcher.models.webhookAction.typeName",{defaultMessage:"Webhook"})),K()(webhook_action_WebhookAction,"iconClass","logoWebhook"),K()(webhook_action_WebhookAction,"selectMessage",z.i18n.translate("xpack.watcher.models.webhookAction.selectMessageText",{defaultMessage:"Send a request to a web service."})),K()(webhook_action_WebhookAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.webhookAction.simulateButtonLabel",{defaultMessage:"Send request"}));class index_action_IndexAction extends base_action_BaseAction{constructor(e={}){super(e),this.index=Object(J.get)(e,"index")}validate(){return{index:[]}}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{index:{index:this.index}}),e}get simulateMessage(){const e=this.index||"";return z.i18n.translate("xpack.watcher.models.indexAction.simulateMessage",{defaultMessage:"Index {index} has been indexed.",values:{index:e}})}get simulateFailMessage(){const e=this.index||"";return z.i18n.translate("xpack.watcher.models.indexAction.simulateFailMessage",{defaultMessage:"Failed to index {index}.",values:{index:e}})}static fromUpstreamJson(e){return new index_action_IndexAction(e)}}K()(index_action_IndexAction,"typeName",z.i18n.translate("xpack.watcher.models.indexAction.typeName",{defaultMessage:"Index"})),K()(index_action_IndexAction,"iconClass","indexOpen"),K()(index_action_IndexAction,"selectMessage",z.i18n.translate("xpack.watcher.models.indexAction.selectMessageText",{defaultMessage:"Index data into Elasticsearch."})),K()(index_action_IndexAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.indexAction.simulateButtonLabel",{defaultMessage:"Index data"}));class pagerduty_action_PagerDutyAction extends base_action_BaseAction{constructor(e={}){super(e);const t=z.i18n.translate("xpack.watcher.models.pagerdutyAction.defaultDescriptionText",{defaultMessage:"Watch [{context}] has exceeded the threshold",values:{context:"{{ctx.metadata.name}}"}});this.description=Object(J.get)(e,"description",e.ignoreDefaults?null:t)}validate(){const e={description:[]};return this.description||e.description.push(z.i18n.translate("xpack.watcher.watchActions.pagerduty.descriptionIsRequiredValidationMessage",{defaultMessage:"PagerDuty description is required."})),e}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{description:this.description,pagerduty:{description:this.description}}),e}get simulateMessage(){return z.i18n.translate("xpack.watcher.models.pagerDutyAction.simulateMessage",{defaultMessage:"PagerDuty event has been sent."})}get simulateFailMessage(){return z.i18n.translate("xpack.watcher.models.pagerDutyAction.simulateFailMessage",{defaultMessage:"Failed to send PagerDuty event."})}static fromUpstreamJson(e){return new pagerduty_action_PagerDutyAction(e)}}K()(pagerduty_action_PagerDutyAction,"typeName",z.i18n.translate("xpack.watcher.models.pagerDutyAction.typeName",{defaultMessage:"PagerDuty"})),K()(pagerduty_action_PagerDutyAction,"iconClass","apps"),K()(pagerduty_action_PagerDutyAction,"selectMessage",z.i18n.translate("xpack.watcher.models.pagerDutyAction.selectMessageText",{defaultMessage:"Create an event in PagerDuty."})),K()(pagerduty_action_PagerDutyAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.pagerDutyAction.simulateButtonLabel",{defaultMessage:"Send a PagerDuty event"}));class jira_action_JiraAction extends base_action_BaseAction{constructor(e={}){super(e);const t=z.i18n.translate("xpack.watcher.models.jiraAction.defaultSummaryText",{defaultMessage:"Watch [{context}] has exceeded the threshold",values:{context:"{{ctx.metadata.name}}"}});this.summary=Object(J.get)(e,"summary",e.ignoreDefaults?null:t),this.projectKey=Object(J.get)(e,"projectKey"),this.issueType=Object(J.get)(e,"issueType")}validate(){const e={projectKey:[],issueType:[],summary:[]};return this.projectKey||e.projectKey.push(z.i18n.translate("xpack.watcher.watchActions.jira.projectKeyIsRequiredValidationMessage",{defaultMessage:"Jira project key is required."})),this.issueType||e.issueType.push(z.i18n.translate("xpack.watcher.watchActions.jira.issueTypeNameIsRequiredValidationMessage",{defaultMessage:"Jira issue type is required."})),this.summary||e.summary.push(z.i18n.translate("xpack.watcher.watchActions.jira.summaryIsRequiredValidationMessage",{defaultMessage:"Jira summary is required."})),e}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{projectKey:this.projectKey,issueType:this.issueType,summary:this.summary,jira:{fields:{project:{key:this.projectKey},issuetype:{name:this.issueType},summary:this.summary}}}),e}get simulateMessage(){return z.i18n.translate("xpack.watcher.models.jiraAction.simulateMessage",{defaultMessage:"Jira issue has been created."})}get simulateFailMessage(){return z.i18n.translate("xpack.watcher.models.jiraAction.simulateFailMessage",{defaultMessage:"Failed to create Jira issue."})}static fromUpstreamJson(e){return new jira_action_JiraAction(e)}}K()(jira_action_JiraAction,"typeName",z.i18n.translate("xpack.watcher.models.jiraAction.typeName",{defaultMessage:"Jira"})),K()(jira_action_JiraAction,"iconClass","apps"),K()(jira_action_JiraAction,"selectMessage",z.i18n.translate("xpack.watcher.models.jiraAction.selectMessageText",{defaultMessage:"Create an issue in Atlassian’s Jira Software."})),K()(jira_action_JiraAction,"simulatePrompt",z.i18n.translate("xpack.watcher.models.jiraAction.simulateButtonLabel",{defaultMessage:"Create a sample Jira issue"}));class unknown_action_UnknownAction extends base_action_BaseAction{constructor(e={}){super(e),this.actionJson=Object(J.get)(e,"actionJson")}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{actionJson:this.actionJson}),e}static fromUpstreamJson(e){return new unknown_action_UnknownAction(e)}}const Q={};Object(Y.set)(Q,X.c.EMAIL,email_action_EmailAction),Object(Y.set)(Q,X.c.LOGGING,logging_action_LoggingAction),Object(Y.set)(Q,X.c.SLACK,slack_action_SlackAction),Object(Y.set)(Q,X.c.WEBHOOK,webhook_action_WebhookAction),Object(Y.set)(Q,X.c.INDEX,index_action_IndexAction),Object(Y.set)(Q,X.c.PAGERDUTY,pagerduty_action_PagerDutyAction),Object(Y.set)(Q,X.c.JIRA,jira_action_JiraAction);class action_Action{static fromUpstreamJson(e){const t=Object(J.get)(e,"type");return(Q[t]||unknown_action_UnknownAction).fromUpstreamJson(e)}}K()(action_Action,"getActionTypes",(()=>Q));var ee=a(24),te=a.n(ee);function ae(e){return e?te()(e):null}class action_status_ActionStatus{constructor(e={}){this.id=Object(J.get)(e,"id"),this.state=Object(J.get)(e,"state"),this.isAckable=Object(J.get)(e,"isAckable"),this.lastAcknowledged=ae(Object(J.get)(e,"lastAcknowledged")),this.lastThrottled=ae(Object(J.get)(e,"lastThrottled")),this.lastExecution=ae(Object(J.get)(e,"lastExecution")),this.isLastExecutionSuccessful=Object(J.get)(e,"isLastExecutionSuccessful"),this.lastExecutionReason=Object(J.get)(e,"lastExecutionReason"),this.lastSuccessfulExecution=ae(Object(J.get)(e,"lastSuccessfulExecution")),this.lastAcknowledged&&(this.lastAcknowledgedHumanized=this.lastAcknowledged.fromNow()),this.lastExecution&&(this.lastExecutionHumanized=this.lastExecution.fromNow()),this.lastThrottled&&(this.lastThrottledHumanized=this.lastThrottled.fromNow())}static fromUpstreamJson(e){return new action_status_ActionStatus(e)}}class watch_status_WatchStatus{constructor(e={}){this.id=Object(J.get)(e,"id"),this.state=Object(J.get)(e,"state"),this.comment=Object(J.get)(e,"comment"),this.isActive=Object(J.get)(e,"isActive"),this.lastExecution=ae(Object(J.get)(e,"lastExecution")),this.lastChecked=ae(Object(J.get)(e,"lastChecked")),this.lastMetCondition=ae(Object(J.get)(e,"lastMetCondition"));const t=Object(J.get)(e,"actionStatuses",[]);this.actionStatuses=t.map((e=>action_status_ActionStatus.fromUpstreamJson(e)))}static fromUpstreamJson(e){return new watch_status_WatchStatus(e)}}class watch_errors_WatchErrors{constructor(e={}){this.actionErrors=Object(J.get)(e,"actions")}static fromUpstreamJson(e){return new watch_errors_WatchErrors(e)}}function se(e,t){const a=e.map((e=>e.id));let s,i=1;for(;void 0===s;){const e=`${t}_${i}`;a.includes(e)?i++:s=e}return s}class base_watch_BaseWatch{constructor(e={}){var t;K()(this,"updateWatchStatus",(e=>{this.watchStatus=e})),K()(this,"createAction",((e,t)=>{const a=action_Action.getActionTypes()[e];if(!Boolean(a))throw new Error(z.i18n.translate("xpack.watcher.models.baseWatch.createUnknownActionTypeErrorMessage",{defaultMessage:"Attempted to create unknown action type {type}.",values:{type:e}}));const s=new a({id:se(this.actions,e),type:e,...t});this.addAction(s)})),K()(this,"addAction",(e=>{(function(e,t){const a=Object(J.find)(e,{id:t.id});return Boolean(a)})(this.actions,e)&&(e.id=se(this.actions,e.type)),this.actions.push(e)})),K()(this,"deleteAction",(e=>{Object(J.remove)(this.actions,e)})),K()(this,"resetActions",(()=>{this.actions=[]})),K()(this,"isEqualTo",(e=>{const t={...this},a={...e};return Object(J.isEqual)(t,a)})),this.id=Object(J.get)(e,"id"),this.type=Object(J.get)(e,"type"),this.isNew=Object(J.get)(e,"isNew",!0),this.name=Object(J.get)(e,"name"),this.isSystemWatch=Boolean(Object(J.get)(e,"isSystemWatch")),this.watchStatus=watch_status_WatchStatus.fromUpstreamJson(Object(J.get)(e,"watchStatus")),this.watchErrors=watch_errors_WatchErrors.fromUpstreamJson(Object(J.get)(e,"watchErrors")),this.isActive=null===(t=this.watchStatus.isActive)||void 0===t||t;const a=Object(J.get)(e,"actions",[]);this.actions=a.map(action_Action.fromUpstreamJson)}get displayName(){return this.name?this.name:this.id}get searchValue(){return e=["id","name"],Object(J.values)(Object(J.pick)(this,e)).join("\n");var e}get typeName(){return this.constructor.typeName}get iconClass(){return this.constructor.iconClass}get selectMessage(){return this.constructor.selectMessage}get selectSortOrder(){return this.constructor.selectSortOrder}get upstreamJson(){return{id:this.id,name:this.name,type:this.type,isNew:this.isNew,isActive:this.isActive,actions:Object(J.map)(this.actions,(e=>e.upstreamJson))}}}K()(base_watch_BaseWatch,"typeName",z.i18n.translate("xpack.watcher.models.baseWatch.typeName",{defaultMessage:"Watch"})),K()(base_watch_BaseWatch,"iconClass",""),K()(base_watch_BaseWatch,"selectMessage",z.i18n.translate("xpack.watcher.models.baseWatch.selectMessageText",{defaultMessage:"Set up a new watch."})),K()(base_watch_BaseWatch,"isCreatable",!0),K()(base_watch_BaseWatch,"selectSortOrder",0);const ie={trigger:{schedule:{interval:"30m"}},input:{search:{request:{body:{size:0,query:{match_all:{}}},indices:["*"]}}},condition:{compare:{"ctx.payload.hits.total":{gte:10}}},actions:{"my-logging-action":{logging:{text:"There are {{ctx.payload.hits.total}} documents in your index. Threshold is 10."}}}};class json_watch_JsonWatch extends base_watch_BaseWatch{constructor(e={}){e.type=X.n.JSON,e.id=void 0===e.id?Object(Z.v4)():e.id,super(e);const t=Object(J.get)(e,"watch");this.watch=t||ie,this.watchString=Object(J.get)(e,"watchString",JSON.stringify(t||ie,null,2)),this.id=e.id}validate(){const e={},t={id:[],json:[]};if(e.errors=t,this.id?/^[A-Za-z0-9\-\_.]+$/.test(this.id)||t.id.push(z.i18n.translate("xpack.watcher.sections.watchEdit.json.error.invalidIdText",{defaultMessage:"ID can only contain letters, underscores, dashes, periods and numbers."})):t.id.push(z.i18n.translate("xpack.watcher.sections.watchEdit.json.error.requiredIdText",{defaultMessage:"ID is required"})),this.watchString&&""!==this.watchString)try{const e=JSON.parse(this.watchString);if(e&&"object"==typeof e){const{actions:a}=e;if(a){const e=Object.keys(a).find((e=>{const t=Object.keys(a[e]);let s;return Object.keys(X.c).forEach((e=>{t.includes(X.c[e])&&!t.includes(X.c.UNKNOWN)&&(s=X.c[e])})),!s}));e&&t.json.push(z.i18n.translate("xpack.watcher.sections.watchEdit.json.error.invalidActionType",{defaultMessage:'Unknown action type provided for action "{action}".',values:{action:e}}))}}}catch(e){t.json.push(z.i18n.translate("xpack.watcher.sections.watchEdit.json.error.invalidJsonText",{defaultMessage:"Invalid JSON"}))}else t.json.push(z.i18n.translate("xpack.watcher.sections.watchEdit.json.error.requiredJsonText",{defaultMessage:"JSON is required"}));return e}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{watch:this.watch}),e}static fromUpstreamJson(e){return new json_watch_JsonWatch(e)}}function ne(e=X.l.SECOND,t="0"){switch(e){case X.l.SECOND:return z.i18n.translate("xpack.watcher.timeUnits.secondLabel",{defaultMessage:"{timeValue, plural, one {second} other {seconds}}",values:{timeValue:t}});case X.l.MINUTE:return z.i18n.translate("xpack.watcher.timeUnits.minuteLabel",{defaultMessage:"{timeValue, plural, one {minute} other {minutes}}",values:{timeValue:t}});case X.l.HOUR:return z.i18n.translate("xpack.watcher.timeUnits.hourLabel",{defaultMessage:"{timeValue, plural, one {hour} other {hours}}",values:{timeValue:t}});case X.l.DAY:return z.i18n.translate("xpack.watcher.timeUnits.dayLabel",{defaultMessage:"{timeValue, plural, one {day} other {days}}",values:{timeValue:t}})}}K()(json_watch_JsonWatch,"typeName",z.i18n.translate("xpack.watcher.models.jsonWatch.typeName",{defaultMessage:"Advanced Watch"})),K()(json_watch_JsonWatch,"iconClass",""),K()(json_watch_JsonWatch,"selectMessage",z.i18n.translate("xpack.watcher.models.jsonWatch.selectMessageText",{defaultMessage:"Set up a custom watch in raw JSON."})),K()(json_watch_JsonWatch,"isCreatable",!0),K()(json_watch_JsonWatch,"selectSortOrder",100);const oe={count:{text:"count()",fieldRequired:!1,value:X.d.COUNT,validNormalizedTypes:[]},avg:{text:"average()",fieldRequired:!0,validNormalizedTypes:["number"],value:X.d.AVERAGE},sum:{text:"sum()",fieldRequired:!0,validNormalizedTypes:["number"],value:X.d.SUM},min:{text:"min()",fieldRequired:!0,validNormalizedTypes:["number","date"],value:X.d.MIN},max:{text:"max()",fieldRequired:!0,validNormalizedTypes:["number","date"],value:X.d.MAX}},re={all:{text:z.i18n.translate("xpack.watcher.thresholdWatchExpression.groupByLabel.allDocumentsLabel",{defaultMessage:"all documents"}),sizeRequired:!1,value:"all",validNormalizedTypes:[]},top:{text:z.i18n.translate("xpack.watcher.thresholdWatchExpression.groupByLabel.topLabel",{defaultMessage:"top"}),sizeRequired:!0,value:"top",validNormalizedTypes:["number","date","keyword"]}},ce={[X.e.GREATER_THAN]:{text:z.i18n.translate("xpack.watcher.thresholdWatchExpression.comparators.isAboveLabel",{defaultMessage:"Is above"}),value:X.e.GREATER_THAN,requiredValues:1},[X.e.GREATER_THAN_OR_EQUALS]:{text:z.i18n.translate("xpack.watcher.thresholdWatchExpression.comparators.isAboveOrEqualsLabel",{defaultMessage:"Is above or equals"}),value:X.e.GREATER_THAN_OR_EQUALS,requiredValues:1},[X.e.LESS_THAN]:{text:z.i18n.translate("xpack.watcher.thresholdWatchExpression.comparators.isBelowLabel",{defaultMessage:"Is below"}),value:X.e.LESS_THAN,requiredValues:1},[X.e.LESS_THAN_OR_EQUALS]:{text:z.i18n.translate("xpack.watcher.thresholdWatchExpression.comparators.isBelowOrEqualsLabel",{defaultMessage:"Is below or equals"}),value:X.e.LESS_THAN_OR_EQUALS,requiredValues:1},[X.e.BETWEEN]:{text:z.i18n.translate("xpack.watcher.thresholdWatchExpression.comparators.isBetweenLabel",{defaultMessage:"Is between"}),value:X.e.BETWEEN,requiredValues:2}},{BETWEEN:le}=X.e,ue={AGG_TYPE:"count",TERM_SIZE:5,THRESHOLD_COMPARATOR:X.e.GREATER_THAN,TIME_WINDOW_SIZE:5,TIME_WINDOW_UNIT:"m",TRIGGER_INTERVAL_SIZE:1,TRIGGER_INTERVAL_UNIT:"m",THRESHOLD:[1e3,5e3],GROUP_BY:"all"};class threshold_watch_ThresholdWatch extends base_watch_BaseWatch{constructor(e={}){e.id=e.id||Object(Z.v4)(),e.type=X.n.THRESHOLD,super(e),this.index=e.index,this.timeField=e.timeField,this.timeFields=e.timeFields||void 0,this.triggerIntervalSize=null==e.triggerIntervalSize?ue.TRIGGER_INTERVAL_SIZE:e.triggerIntervalSize,this.triggerIntervalUnit=e.triggerIntervalUnit||ue.TRIGGER_INTERVAL_UNIT,this.aggType=e.aggType||ue.AGG_TYPE,this.aggField=e.aggField,this.termSize=null==e.termSize?ue.TERM_SIZE:e.termSize,this.termField=e.termField,this.thresholdComparator=e.thresholdComparator||ue.THRESHOLD_COMPARATOR,this.timeWindowSize=null==e.timeWindowSize?ue.TIME_WINDOW_SIZE:e.timeWindowSize,this.timeWindowUnit=e.timeWindowUnit||ue.TIME_WINDOW_UNIT,this.groupBy=e.groupBy||ue.GROUP_BY,null!=this.termField&&(this.groupBy="top"),this.threshold=null==e.threshold?ue.THRESHOLD:e.threshold}get hasTermsAgg(){return Boolean(this.termField)}get termOrder(){return this.thresholdComparator===X.e.GREATER_THAN?X.k.DESCENDING:X.k.ASCENDING}get titleDescription(){const e=z.i18n.translate("xpack.watcher.models.thresholdWatch.sendAlertOnSpecificConditionTitleDescription",{defaultMessage:"Send an alert when your specified condition is met."});if(isNaN(this.triggerIntervalSize))return e;const t=ne(this.triggerIntervalUnit,this.triggerIntervalSize);return`${e} ${z.i18n.translate("xpack.watcher.models.thresholdWatch.thresholdWatchIntervalTitleDescription",{defaultMessage:"Your watch will run every {triggerIntervalSize} {timeUnitLabel}.",values:{triggerIntervalSize:this.triggerIntervalSize,timeUnitLabel:t}})}`}validate(){const e={},t={name:[],index:[],timeField:[],triggerIntervalSize:[],aggField:[],termSize:[],termField:[],timeWindowSize:[]};return e.errors=t,this.name||t.name.push(z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.error.requiredNameText",{defaultMessage:"Name is required."})),void 0!==this.index&&this.index.length<1&&t.index.push(z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.enterOneOrMoreIndicesValidationMessage",{defaultMessage:"Enter one or more indices."})),void 0!==this.index&&this.index.length>0&&void 0!==this.timeFields&&1===this.timeFields.length&&t.index.push(z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.invalidIndexValidationMessage",{defaultMessage:"Index does not have a time field."})),this.timeField||t.timeField.push(z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.timeFieldIsRequiredValidationText",{defaultMessage:"A time field is required."})),this.triggerIntervalSize||t.triggerIntervalSize.push(z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.intervalSizeIsRequiredValidationMessage",{defaultMessage:"Interval size is required."})),void 0!==this.triggerIntervalSize&&this.triggerIntervalSize<0&&t.triggerIntervalSize.push(z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.intervalSizeNegativeNumberValidationMessage",{defaultMessage:"Interval size cannot be a negative number."})),oe[this.aggType].fieldRequired&&!this.aggField&&t.aggField.push(z.i18n.translate("xpack.watcher.watchEdit.thresholdWatchExpression.aggType.fieldIsRequiredValidationMessage",{defaultMessage:"This field is required."})),re[this.groupBy].sizeRequired&&(this.termSize||t.termSize.push(z.i18n.translate("xpack.watcher.thresholdWatchExpression.aggType.xpack.watcher.thresholdWatchExpression.groupBy.requiredValueValidationMessage",{defaultMessage:"A value is required."})),this.termField||t.termField.push(z.i18n.translate("xpack.watcher.thresholdWatchExpression.groupBy.requiredFieldValidationMessage",{defaultMessage:"This field is required."}))),Array.from(Array(ce[this.thresholdComparator].requiredValues)).forEach(((e,a)=>{const s=`threshold${a}`;t[s]=[],null!=this.threshold[a]&&""!==this.threshold[a]||t[s].push(z.i18n.translate("xpack.watcher.thresholdWatchExpression.thresholdLevel.valueIsRequiredValidationMessage",{defaultMessage:"A value is required."}))})),this.thresholdComparator!==le||!this.threshold[0]||!this.threshold[1]||this.threshold[1]>this.threshold[0]||t.threshold1.push(z.i18n.translate("xpack.watcher.thresholdWatchExpression.thresholdLevel.secondValueMustBeGreaterMessage",{defaultMessage:"Value must be greater than {lowerBound}.",values:{lowerBound:this.threshold[0]}})),this.timeWindowSize||t.timeWindowSize.push(z.i18n.translate("xpack.watcher.thresholdWatchExpression.timeWindow.durationSizeIsRequiredValidationMessage",{defaultMessage:"Window duration size is required."})),e}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{index:this.index,timeField:this.timeField,triggerIntervalSize:this.triggerIntervalSize,triggerIntervalUnit:this.triggerIntervalUnit,aggType:this.aggType,aggField:this.aggField,termSize:this.termSize,termField:this.termField,termOrder:this.termOrder,thresholdComparator:this.thresholdComparator,timeWindowSize:this.timeWindowSize,timeWindowUnit:this.timeWindowUnit,hasTermsAgg:this.hasTermsAgg,threshold:ce[this.thresholdComparator].requiredValues>1?this.threshold:this.threshold[0]}),e}static fromUpstreamJson(e){return new threshold_watch_ThresholdWatch(e)}get DEFAULT_VALUES(){return ue}}K()(threshold_watch_ThresholdWatch,"typeName",z.i18n.translate("xpack.watcher.models.thresholdWatch.typeName",{defaultMessage:"Threshold Alert"})),K()(threshold_watch_ThresholdWatch,"iconClass",""),K()(threshold_watch_ThresholdWatch,"selectMessage",z.i18n.translate("xpack.watcher.models.thresholdWatch.selectMessageText",{defaultMessage:"Send an alert on a specific condition"})),K()(threshold_watch_ThresholdWatch,"isCreatable",!0),K()(threshold_watch_ThresholdWatch,"selectSortOrder",1);class monitoring_watch_MonitoringWatch extends base_watch_BaseWatch{constructor(e={}){e.type=X.n.MONITORING,super(e)}get upstreamJson(){const e=super.upstreamJson;return Object.assign(e,{watch:this.watch}),e}static fromUpstreamJson(e){return new monitoring_watch_MonitoringWatch(e)}}K()(monitoring_watch_MonitoringWatch,"isCreatable",!1);const de={};Object(Y.set)(de,X.n.JSON,json_watch_JsonWatch),Object(Y.set)(de,X.n.THRESHOLD,threshold_watch_ThresholdWatch),Object(Y.set)(de,X.n.MONITORING,monitoring_watch_MonitoringWatch);class watch_Watch{static fromUpstreamJson(e={}){const t=Object(J.get)(e,"type"),a=de[t];return Object.assign(e,{isNew:!1}),a.fromUpstreamJson(e)}}K()(watch_Watch,"getWatchTypes",(()=>de)),a(42);class watch_history_item_WatchHistoryItem{constructor(e={}){this.id=e.id,this.watchId=e.watchId,this.details=e.details,this.startTime=ae(e.startTime),this.watchStatus=watch_status_WatchStatus.fromUpstreamJson(Object(J.get)(e,"watchStatus"))}static fromUpstreamJson(e){return new watch_history_item_WatchHistoryItem(e)}}const he=e=>Object(r.sendRequest)(pe(),e),ge=e=>Object(r.useRequest)(pe(),e);let me;const pe=()=>me,je=X.j.API_ROOT,be=({watches:e=[]})=>e.map((e=>watch_Watch.fromUpstreamJson(e))),xe=({watch:e={}})=>watch_Watch.fromUpstreamJson(e),we=({watchHistoryItems:e=[]})=>e.map((e=>watch_history_item_WatchHistoryItem.fromUpstreamJson(e))),fe=({watchHistoryItem:e})=>watch_history_item_WatchHistoryItem.fromUpstreamJson(e),ye=async e=>he({path:`${je}/watch/${e}/deactivate`,method:"put"}),Oe=async e=>he({path:`${je}/watch/${e}/activate`,method:"put"}),Ee=async e=>await pe().put(`${je}/watch/${e.id}`,{body:JSON.stringify(e.upstreamJson)}),ve=async(e,t)=>he({path:`${je}/watch/execute`,method:"put",body:JSON.stringify({executeDetails:e.upstreamJson,watch:t.upstreamJson})}),ke=e=>null==e?void 0:e.visualizeData,Me=e=>Settings.fromUpstreamJson(e);let Te;const Se=()=>{Te.history.push({pathname:"/watches"})},_e=()=>{Te.history.push({pathname:"/watches/new-watch/threshold"})},Ae=()=>{Te.history.push({pathname:"/watches/new-watch/json"})},Fe=Object(s.createContext)(null),Ie=({links:e})=>({putWatchApiUrl:`${e.apis.putWatch}`,executeWatchApiUrl:`${e.apis.executeWatchActionModes}`,watcherGettingStartedUrl:`${e.watcher.ui}`,watchActionsConfigurationMap:{[X.c.SLACK]:`${e.watcher.slackAction}`,[X.c.PAGERDUTY]:`${e.watcher.pagerDutyAction}`,[X.c.JIRA]:`${e.watcher.jiraAction}`}}),Je=({children:e,value:t})=>{const{docLinks:a,...s}=t;return Object(f.jsx)(Fe.Provider,{value:Object.freeze({...s,links:Ie(a)})},e)},Le=()=>{const e=Object(s.useContext)(Fe);if(!e)throw new Error('"useAppContext" can only be called inside of AppContext.Provider!');return e};function Ce({id:e}){return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:"warning",color:"danger",title:Object(f.jsx)("h1",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.pageErrorNotExist.title",defaultMessage:"Couldn't find watch"})),body:Object(f.jsx)("p",null,e?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.pageErrorNotExist.description",defaultMessage:"A watch with ID ''{id}'' could not be found.",values:{id:e}}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.pageErrorNotExist.noWatchIdDescription",defaultMessage:"A watch could not be found."}))})}function We(){return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:"warning",color:"danger",title:Object(f.jsx)("h1",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.pageErrorForbidden.title",defaultMessage:"You don't have privileges to use Watcher"}))})}function De(e){const t=(Array.isArray(e)?e:[e]).find((e=>!!e&&[403,404].includes(e.statusCode)));if(t)return t.statusCode}function Ne({errorCode:e,id:t}){return 404===e?Object(f.jsx)(Ce,{id:t}):Object(f.jsx)(We,null)}const Pe=({watchesToDelete:e,callback:t})=>{const{toasts:a}=Le(),s=e.length;if(!s)return null;const i=z.i18n.translate("xpack.watcher.deleteSelectedWatchesConfirmModal.descriptionText",{defaultMessage:"You can't recover {numWatchesToDelete, plural, one {a deleted watch} other {deleted watches}}.",values:{numWatchesToDelete:s}}),n=z.i18n.translate("xpack.watcher.deleteSelectedWatchesConfirmModal.deleteButtonLabel",{defaultMessage:"Delete {numWatchesToDelete, plural, one {watch} other {# watches}} ",values:{numWatchesToDelete:s}}),o=z.i18n.translate("xpack.watcher.deleteSelectedWatchesConfirmModal.cancelButtonLabel",{defaultMessage:"Cancel"});return Object(f.jsx)(j.EuiConfirmModal,{buttonColor:"danger","data-test-subj":"deleteWatchesConfirmation",title:n,onCancel:()=>t(),onConfirm:async()=>{const{successes:s,errors:i}=await(async e=>{const t=JSON.stringify({watchIds:e}),{results:a}=await pe().post(`${je}/watches/delete`,{body:t});return a})(e),n=s.length,o=i.length;t(s),n>0&&a.addSuccess(z.i18n.translate("xpack.watcher.sections.watchList.deleteSelectedWatchesSuccessNotification.descriptionText",{defaultMessage:"Deleted {numSuccesses, number} {numSuccesses, plural, one {watch} other {watches}}",values:{numSuccesses:n}})),o>0&&a.addDanger(z.i18n.translate("xpack.watcher.sections.watchList.deleteSelectedWatchesErrorNotification.descriptionText",{defaultMessage:"Failed to delete {numErrors, number} {numErrors, plural, one {watch} other {watches}}",values:{numErrors:o}}))},cancelButtonText:o,confirmButtonText:n},i)},Re=({errorKey:e,isShowingErrors:t,errors:a,children:i,...n})=>Object(f.jsx)(j.EuiFormRow,l()({isInvalid:t&&a[e].length>0,error:a[e]},n),Object(f.jsx)(s.Fragment,null,s.Children.map(i,(e=>Object(s.cloneElement)(e))))),Be={[X.m.ACTIVE]:"success",[X.m.INACTIVE]:"subdued",[X.m.CONFIG_ERROR]:"subdued",[X.m.ERROR]:"subdued"},ze=({state:e,size:t="s"})=>Object(f.jsx)(j.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiIcon,{type:"dot",color:Be[e]})),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiText,{size:t},e))),He={[X.b.OK]:"success",[X.b.ACKNOWLEDGED]:"success",[X.b.THROTTLED]:"warning",[X.b.UNKNOWN]:"subdued",[X.b.CONFIG_ERROR]:"danger",[X.b.ERROR]:"danger"},Ue=({state:e,size:t="s"})=>Object(f.jsx)(j.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiIcon,{type:"dot",color:He[e]})),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiText,{size:t},e))),qe=({children:e})=>Object(f.jsx)(j.EuiEmptyPrompt,{title:Object(f.jsx)(j.EuiLoadingSpinner,{size:"xl"}),body:Object(f.jsx)(j.EuiText,{color:"subdued"},e),"data-test-subj":"sectionLoading"}),Ve=({title:e,error:t,...a})=>{const i=t.data||t,{error:n,cause:o,message:r}=i;return Object(f.jsx)(j.EuiCallOut,l()({title:e,color:"danger",iconType:"warning"},a),Object(f.jsx)("div",{"data-test-subj":"sectionErrorMessage"},r||n),o&&Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiSpacer,{size:"m"}),Object(f.jsx)("ul",null,o.map(((e,t)=>Object(f.jsx)("li",{key:t},e))))))},Ge=i.a.createContext({}),$e=()=>{const{toasts:e}=Le(),{watchDetail:t}=Object(s.useContext)(Ge),[a,i]=Object(s.useState)([]),[n,o]=Object(s.useState)(!1),[r,c]=Object(s.useState)(null),{id:l,watchErrors:u,watchStatus:d,isSystemWatch:h}=t,g=u&&u.actionErrors,m=d&&d.actionStatuses,p=g&&Object.keys(g).length>0;Object(s.useEffect)((()=>{const e=m&&m.map((e=>{const t=g&&g[e.id];return{...e,errors:t||[]}}));i(e)}),[t,g,m]);const b=[{field:"id",name:z.i18n.translate("xpack.watcher.sections.watchDetail.watchTable.actionHeader",{defaultMessage:"Name"}),sortable:!0,truncateText:!1},{field:"state",name:Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchDetail.watchTable.stateHeader.tooltipText",{defaultMessage:"OK, acknowledged, throttled, or error."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchDetail.watchTable.stateHeader",{defaultMessage:"State"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!0,render:e=>Object(f.jsx)(Ue,{state:e})},{field:"lastExecution",name:Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchHistory.watchActionStatusTable.lastExecuted.tooltipText",{defaultMessage:"The last time this action was executed."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchHistory.watchActionStatusTable.lastExecuted",{defaultMessage:"Last executed"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!1,render:e=>{var t;return null!==(t=null==e?void 0:e.format())&&void 0!==t?t:""}}],x={field:"errors",name:z.i18n.translate("xpack.watcher.sections.watchDetail.watchTable.errorsHeader",{defaultMessage:"Errors"}),render:(e,t)=>{const{id:a}=t;return e&&e.length>0?Object(f.jsx)(j.EuiButtonEmpty,{onClick:()=>c(a),"data-test-subj":"actionErrorsButton"},z.i18n.translate("xpack.watcher.sections.watchDetail.watchTable.errorsCellText",{defaultMessage:"{total, number} {total, plural, one {error} other {errors}}",values:{total:e.length}})):Object(f.jsx)(s.Fragment,null)}},w={actions:[{available:e=>e.isAckable&&!h,render:t=>{const{id:a}=t;return Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchDetail.watchTable.ackActionCellTooltipTitle",{defaultMessage:"Acknowledge watch action."})},Object(f.jsx)(j.EuiButtonEmpty,{iconType:"check",isLoading:n,"data-test-subj":"acknowledgeWatchButton",onClick:async()=>{o(!0);try{const e=await(async(e,t)=>{const{watchStatus:a}=await pe().put(`${je}/watch/${e}/action/${t}/acknowledge`);return watch_status_WatchStatus.fromUpstreamJson(a)})(l,a),t=e.actionStatuses.map((e=>{const t=g&&g[e.id];return{...e,errors:t||[]}}));return o(!1),i(t)}catch(a){o(!1),e.addDanger(z.i18n.translate("xpack.watcher.sections.watchDetail.watchTable.ackActionErrorMessage",{defaultMessage:"Error acknowledging action {actionId}",values:{actionId:t.id}}))}}},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchDetail.watchTable.ackActionCellTitle",defaultMessage:"Acknowledge"})))}}]},y=p?[...b,x,w]:[...b,w];return Object(f.jsx)("div",{"data-test-subj":"watchDetailSection"},r&&Object(f.jsx)(j.EuiFlyout,{size:"s","aria-labelledby":"flyoutActionErrorTitle","data-test-subj":"actionErrorsFlyout",onClose:()=>c(null)},Object(f.jsx)(j.EuiFlyoutHeader,{hasBorder:!0},Object(f.jsx)(j.EuiTitle,{size:"s"},Object(f.jsx)("h2",{id:"flyoutActionErrorTitle","data-test-subj":"title"},r))),Object(f.jsx)(j.EuiFlyoutBody,null,Object(f.jsx)(j.EuiCallOut,{title:z.i18n.translate("xpack.watcher.sections.watchDetail.actionErrorsCalloutTitle",{defaultMessage:"This action contains errors"}),color:"danger",iconType:"cross","data-test-subj":"errorMessage"},g[r].length>1?Object(f.jsx)("ul",null,g[r].map(((e,t)=>Object(f.jsx)("li",{key:`action-error-${t}`},e.message)))):Object(f.jsx)("p",null,g[r][0].message)))),Object(f.jsx)(j.EuiInMemoryTable,{items:a,itemId:"id",columns:y,pagination:X.g,sorting:!0,"data-test-subj":"watchActionStatusTable",message:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchDetail.watchTable.noWatchesMessage",defaultMessage:"No actions to show"})}))},Ke=[{value:"now-1h",text:z.i18n.translate("xpack.watcher.sections.watchHistory.timeSpan.1h",{defaultMessage:"Last one hour"})},{value:"now-24h",text:z.i18n.translate("xpack.watcher.sections.watchHistory.timeSpan.24h",{defaultMessage:"Last 24 hours"})},{value:"now-7d",text:z.i18n.translate("xpack.watcher.sections.watchHistory.timeSpan.7d",{defaultMessage:"Last 7 days"})},{value:"now-30d",text:z.i18n.translate("xpack.watcher.sections.watchHistory.timeSpan.30d",{defaultMessage:"Last 30 days"})},{value:"now-6M",text:z.i18n.translate("xpack.watcher.sections.watchHistory.timeSpan.6M",{defaultMessage:"Last 6 months"})},{value:"now-1y",text:z.i18n.translate("xpack.watcher.sections.watchHistory.timeSpan.1y",{defaultMessage:"Last 1 year"})}],Ye=()=>{const{watchDetail:e}=Object(s.useContext)(Ge),[t,a]=Object(s.useState)(void 0),[i,n]=Object(s.useState)(void 0),[o,r]=Object(s.useState)(Ke[0].value);void 0===t&&a(e.watchStatus&&e.watchStatus.isActive||!1);const{error:c,data:l,isLoading:u}=(d=e.id,ge({query:(h=o)?{startTime:h}:void 0,path:`${je}/watch/${d}/history`,method:"get",deserializer:we}));var d,h;const{error:g,data:m}=(e=>ge({path:e?`${je}/history/${e}`:"",method:"get",deserializer:fe}))(i),p=m?JSON.stringify(m.details,null,2):"";if(c)return Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiSpacer,{size:"s"}),Object(f.jsx)(Ve,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchExecutionErrorTitle",defaultMessage:"Error loading execution history"}),error:c}));const b=[{field:"startTime",name:z.i18n.translate("xpack.watcher.sections.watchHistory.watchTable.startTimeHeader",{defaultMessage:"Trigger time"}),sortable:!0,truncateText:!1,render:(e,t)=>{const a=e.format();return Object(f.jsx)(j.EuiLink,{"data-test-subj":`watchStartTimeColumn-${a}`,onClick:()=>n(t.id)},a)}},{field:"watchStatus.state",name:Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchHistory.watchTable.stateHeader.tooltipText",{defaultMessage:"Active or error state."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchHistory.watchTable.stateHeader",{defaultMessage:"State"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!0,render:e=>Object(f.jsx)(ze,{state:e})},{field:"startTime",name:Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchHistory.watchTable.metConditionHeader.tooltipText",{defaultMessage:"Whether the condition was met and action taken."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchHistory.watchTable.metConditionHeader",{defaultMessage:"Condition met"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!0,render:(e,t)=>{const{watchStatus:{lastExecution:a}}=t;if(e.isSame(a))return Object(f.jsx)(j.EuiIcon,{color:"green",type:"check"})}},{field:"watchStatus.comment",name:Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchHistory.watchTable.commentHeader.tooltipText",{defaultMessage:"Whether the action was throttled, acknowledged, or failed to execute."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchHistory.watchTable.commentHeader",{defaultMessage:"Comment"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!0}];let x;if(void 0!==i&&(g&&(x=Object(f.jsx)(j.EuiFlyout,{"data-test-subj":"watchHistoryErrorDetailFlyout",onClose:()=>n(void 0),"aria-labelledby":"watchHistoryErrorDetailsFlyoutTitle",maxWidth:600},Object(f.jsx)(j.EuiFlyoutHeader,null,Object(f.jsx)(j.EuiTitle,{size:"s"},Object(f.jsx)("h3",{"data-test-subj":"title"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchHistoryDetail.errorTitle",defaultMessage:"Execution details"})))),Object(f.jsx)(j.EuiFlyoutBody,null,Object(f.jsx)(Ve,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchHistoryDetailsErrorTitle",defaultMessage:"Error loading execution details"}),error:g,"data-test-subj":"errorMessage"})))),void 0!==m)){const e=[{field:"id",name:z.i18n.translate("xpack.watcher.sections.watchHistory.watchActionStatusTable.id",{defaultMessage:"Name"}),sortable:!0,truncateText:!1},{field:"state",name:Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchHistory.watchActionStatusTable.state.tooltipText",{defaultMessage:"OK, acknowledged, throttled, or error."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchHistory.watchActionStatusTable.state",{defaultMessage:"State"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!0,render:e=>Object(f.jsx)(Ue,{state:e})}];x=Object(f.jsx)(j.EuiFlyout,{"data-test-subj":"watchHistoryDetailFlyout",onClose:()=>n(void 0),"aria-labelledby":"watchHistoryDetailsFlyoutTitle",maxWidth:600},Object(f.jsx)(j.EuiFlyoutHeader,null,Object(f.jsx)(j.EuiTitle,{size:"s"},Object(f.jsx)("h3",{"data-test-subj":"title"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchHistoryDetail.title",defaultMessage:"Executed on {date}",values:{date:m.startTime}})))),Object(f.jsx)(j.EuiFlyoutBody,null,Object(f.jsx)(j.EuiTitle,{size:"xs"},Object(f.jsx)("h4",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchHistoryDetail.actionsTitle",defaultMessage:"Actions"}))),Object(f.jsx)(j.EuiInMemoryTable,{items:m.watchStatus.actionStatuses,itemId:"id",columns:e,message:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchTable.noWatchesMessage",defaultMessage:"No current status to show"}),"data-test-subj":"watchActionsTable"}),Object(f.jsx)(j.EuiSpacer,null),Object(f.jsx)(j.EuiTitle,{size:"xs"},Object(f.jsx)("h4",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchHistoryDetail.jsonTitle",defaultMessage:"JSON"}))),Object(f.jsx)(j.EuiSpacer,{size:"s"}),Object(f.jsx)(j.EuiCodeBlock,{language:"json"},p)))}return Object(f.jsx)("div",{"data-test-subj":"watchHistorySection"},Object(f.jsx)(j.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiSelect,{options:Ke,value:o,onChange:e=>{const t=e.target.value;r(t)},"aria-label":z.i18n.translate("xpack.watcher.sections.watchHistory.changeTimespanSelectAriaLabel",{defaultMessage:"Change timespan of watch history"})}))),Object(f.jsx)(j.EuiSpacer,{size:"s"}),Object(f.jsx)(j.EuiInMemoryTable,{items:l||[],columns:b,pagination:X.g,sorting:!0,loading:u,"data-test-subj":"watchHistoryTable",message:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchTable.noCurrentStatus",defaultMessage:"No execution history to show"})}),x)},Xe=[{id:"executionHistoryTab",name:z.i18n.translate("xpack.watcher.sections.watchStatus.executionHistoryTabLabel",{defaultMessage:"Execution history"})},{id:"actionStatusesTab",name:z.i18n.translate("xpack.watcher.sections.watchStatus.actionsTabLabel",{defaultMessage:"Action statuses"})}],Ze=({match:{params:{id:e}}})=>{const{setBreadcrumbs:t,toasts:a}=Le(),{error:n,data:o,isLoading:r}=(e=>ge({path:`${je}/watch/${e}`,method:"get",deserializer:xe}))(e),[c,l]=Object(s.useState)("executionHistoryTab"),[u,d]=Object(s.useState)(void 0),[h,g]=Object(s.useState)([]),[m,p]=Object(s.useState)(!1);Object(s.useEffect)((()=>{t([U,G])}),[e,t]);const b=De(n);if(r)return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,null,Object(f.jsx)(qe,null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchStatus.loadingWatchDetailsDescription",defaultMessage:"Loading watch details…"})));if(b)return Object(f.jsx)(Ne,{errorCode:b,id:e});if(o){const{isSystemWatch:e,id:t,watchStatus:s,name:b}=o;void 0===u&&d(void 0!==s.isActive&&s.isActive);const x=u?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchTable.deactivateWatchLabel",defaultMessage:"Deactivate"}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.watchTable.activateWatchLabel",defaultMessage:"Activate"}),w=async()=>{const e=u?ye:Oe;p(!0);const{error:s}=await e(t);if(p(!1),s){const e=u?z.i18n.translate("xpack.watcher.sections.watchList.toggleActivatationErrorNotification.deactivateDescriptionText",{defaultMessage:"Couldn't deactivate watch"}):z.i18n.translate("xpack.watcher.sections.watchList.toggleActivatationErrorNotification.activateDescriptionText",{defaultMessage:"Couldn't activate watch"});return a.addDanger(e)}d(!u)},y="executionHistoryTab"===c?Object(f.jsx)(Ye,null):"actionStatusesTab"===c?Object(f.jsx)($e,null):void 0;return Object(f.jsx)(Ge.Provider,{value:{watchDetailError:n,watchDetail:o,isWatchDetailLoading:r}},Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(j.EuiPageHeader,{pageTitle:Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)("span",{"data-test-subj":"pageTitle"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchDetail.header",defaultMessage:"Current status for ''{watch}''",values:{watch:b||t}})),e&&Object(f.jsx)(i.a.Fragment,null," ",Object(f.jsx)(j.EuiToolTip,{content:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchDetail.headerBadgeToolipText",defaultMessage:"You cannot deactivate or delete a system watch."})},Object(f.jsx)(j.EuiBadge,{color:"hollow"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchDetail.headerBadgeText",defaultMessage:"System watch"}))))),bottomBorder:!0,rightSideItems:e?[]:[Object(f.jsx)(j.EuiButtonEmpty,{"data-test-subj":"toggleWatchActivationButton",onClick:()=>w(),isLoading:m},x),Object(f.jsx)(j.EuiButtonEmpty,{"data-test-subj":"deleteWatchButton",onClick:()=>{g([t])},color:"danger",disabled:!1},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchHistory.deleteWatchButtonLabel",defaultMessage:"Delete"}))],tabs:Xe.map(((e,t)=>({onClick:()=>{l(e.id)},isSelected:e.id===c,key:t,"data-test-subj":"tab",label:e.name})))}),Object(f.jsx)(j.EuiSpacer,{size:"l"}),y,Object(f.jsx)(Pe,{callback:e=>{e&&Se(),g([])},watchesToDelete:h})))}return null},Qe=i.a.createContext({}),et=(e,t)=>0===t?"now":`now+${t}${e}`;class execute_details_ExecuteDetails{constructor(e={}){this.triggeredTimeValue=e.triggeredTimeValue,this.triggeredTimeUnit=e.triggeredTimeUnit,this.scheduledTimeValue=e.scheduledTimeValue,this.scheduledTimeUnit=e.scheduledTimeUnit,this.ignoreCondition=e.ignoreCondition,this.alternativeInput=e.alternativeInput||"",this.actionModes=e.actionModes,this.recordExecution=e.recordExecution}validate(){const e={json:[]},t=z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.invalidJsonFieldError",{defaultMessage:"Invalid JSON"});if(""!==this.alternativeInput)try{const a=JSON.parse(this.alternativeInput);a&&"object"!=typeof a&&e.json.push(t)}catch(a){e.json.push(t)}return e}get upstreamJson(){return{triggerData:{triggeredTime:this.triggeredTimeValue&&""!==this.triggeredTimeValue?et(this.triggeredTimeUnit,this.triggeredTimeValue):void 0,scheduledTime:this.scheduledTimeValue&&""!==this.scheduledTimeValue?et(this.scheduledTimeUnit,this.scheduledTimeValue):void 0},ignoreCondition:this.ignoreCondition,alternativeInput:""!==this.alternativeInput?JSON.parse(this.alternativeInput):void 0,actionModes:this.actionModes,recordExecution:this.recordExecution}}}function tt(e){return Object(J.intersection)(Object(J.keys)(e),Object(J.values)(X.c))[0]||X.c.UNKNOWN}var at=a(26);function st(e,t){const{metadata:a={}}=t,s={...t,metadata:{...a,xpack:{...a.xpack,type:X.n.JSON}}};return e&&(s.metadata.name=e),s}class action_base_action_BaseAction{constructor(e,t){this.id=e.id,this.type=e.type,this.errors=t}get downstreamJson(){return{id:this.id,type:this.type}}get upstreamJson(){return{}}static getPropsFromDownstreamJson(e){return{id:e.id}}static getPropsFromUpstreamJson(e){return{id:e.id}}}class action_logging_action_LoggingAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.LOGGING,super(e,t),this.text=e.text}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{text:this.text}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{text:e.text}),{action:new action_logging_action_LoggingAction(t,a),errors:a}}get upstreamJson(){const e=super.upstreamJson;return e[this.id]={logging:{text:this.text}},e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),{errors:a}=this.validateJson(e.actionJson);return Object.assign(t,{text:e.actionJson.logging.text}),{action:new action_logging_action_LoggingAction(t,a),errors:a}}static validateJson(e){const t=[];return e.logging||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.loggingAction.actionJsonLoggingPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonLogging} property",values:{actionJsonLogging:"actionJson.logging"}})}),e.logging&&!e.logging.text&&t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.loggingAction.actionJsonLoggingTextPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonLoggingText} property",values:{actionJsonLoggingText:"actionJson.logging.text"}})}),{errors:t.length?t:null}}}class action_email_action_EmailAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.EMAIL,super(e,t),this.to=e.to,this.subject=e.subject,this.body=e.body}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{to:this.to,subject:this.subject,body:this.body}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{to:e.to,subject:e.subject,body:e.body}),{action:new action_email_action_EmailAction(t,a),errors:a}}get upstreamJson(){const e=super.upstreamJson,t={};return this.subject&&(t.subject=this.subject),this.body&&(t.body={text:this.body}),e[this.id]={email:{profile:"standard",to:this.to,...t}},e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),{errors:a}=this.validateJson(e.actionJson),s={};return e.actionJson.email.subject&&(s.subject=e.actionJson.email.subject),e.actionJson.email.body&&(s.body=e.actionJson.email.body.text),Object.assign(t,{to:e.actionJson.email.to,subject:e.actionJson.email.subject,...s}),{action:new action_email_action_EmailAction(t,a),errors:a}}static validateJson(e){const t=[];if(!e.email){const e=z.i18n.translate("xpack.watcher.models.emailAction.actionJsonEmailPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonEmail} property",values:{actionJsonEmail:"actionJson.email"}});t.push({code:X.f.ERR_PROP_MISSING,message:e})}if(e.email&&!e.email.to){const e=z.i18n.translate("xpack.watcher.models.emailAction.actionJsonEmailToPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonEmailTo} property",values:{actionJsonEmailTo:"actionJson.email.to"}});t.push({code:X.f.ERR_PROP_MISSING,message:e})}return{errors:t.length?t:null}}}class action_slack_action_SlackAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.SLACK,super(e,t),this.to=e.to,this.text=e.text}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{to:this.to,text:this.text}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{to:e.to,text:e.text}),{action:new action_slack_action_SlackAction(t,a),errors:a}}get upstreamJson(){const e=super.upstreamJson;return e[this.id]={slack:{message:{to:this.to,text:this.text}}},e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),{errors:a}=this.validateJson(e.actionJson);return Object.assign(t,{to:e.actionJson.slack.message.to,text:e.actionJson.slack.message.text}),{action:new action_slack_action_SlackAction(t,a),errors:a}}static validateJson(e){const t=[];return e.slack||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.slackAction.actionJsonSlackPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonSlack} property",values:{actionJsonSlack:"actionJson.slack"}})}),e.slack&&!e.slack.message&&t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.slackAction.actionJsonSlackMessagePropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonSlackMessage} property",values:{actionJsonSlackMessage:"actionJson.slack.message"}})}),{errors:t.length?t:null}}}class action_index_action_IndexAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.INDEX,super(e,t),this.index=e.index}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{index:this.index}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{index:e.index}),{action:new action_index_action_IndexAction(t,a),errors:a}}get upstreamJson(){const e=super.upstreamJson;return e[this.id]={index:this.index},e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),{errors:a}=this.validateJson(e.actionJson);return Object.assign(t,{index:e.actionJson.index.index}),{action:new action_index_action_IndexAction(t,a),errors:a}}static validateJson(e){const t=[];return e.index||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.indexAction.actionJsonIndexPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonIndex} property",values:{actionJsonIndex:"actionJson.index"}})}),{errors:t.length?t:null}}}class action_webhook_action_WebhookAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.WEBHOOK,super(e,t),this.method=e.method,this.host=e.host,this.port=e.port,this.scheme=e.scheme,this.path=e.path,this.body=e.body,this.contentType=e.contentType,this.username=e.username,this.password=e.password}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{method:this.method,host:this.host,port:this.port,scheme:this.scheme,path:this.path,body:this.body,contentType:this.contentType,username:this.username}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{method:e.method,host:e.host,port:e.port,scheme:e.scheme,path:e.path,body:e.body,contentType:e.contentType,username:e.username,password:e.password}),{action:new action_webhook_action_WebhookAction(t,a),errors:a}}get upstreamJson(){const e=super.upstreamJson,t={};return this.path&&(t.path=this.path),this.method&&(t.method=this.method),this.scheme&&(t.scheme=this.scheme),this.body&&(t.body=this.body),this.contentType&&(t.headers={"Content-Type":this.contentType}),this.username&&this.password&&(t.auth={basic:{username:this.username,password:this.password}}),e[this.id]={webhook:{host:this.host,port:this.port,...t}},e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),a=e&&e.actionJson&&e.actionJson.webhook,{errors:s}=this.validateJson(e.actionJson),{path:i,method:n,scheme:o,body:r,auth:c,headers:l}=a,u={};return i&&(u.path=i),n&&(u.method=n),o&&(u.scheme=o),r&&(u.body=r),l["Content-Type"]&&(u.contentType=l["Content-Type"]),c&&c.basic&&(u.username=c.basic.username),Object.assign(t,{host:e.actionJson.webhook.host,port:e.actionJson.webhook.port,...u}),{action:new action_webhook_action_WebhookAction(t,s),errors:s}}static validateJson(e){const t=[];return e.webhook&&!e.webhook.host&&t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.loggingAction.actionJsonWebhookHostPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonWebhookHost} property",values:{actionJsonWebhookHost:"actionJson.webhook.host"}})}),e.webhook&&!e.webhook.port&&t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.loggingAction.actionJsonWebhookPortPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonWebhookPort} property",values:{actionJsonWebhookPort:"actionJson.webhook.port"}})}),{errors:t.length?t:null}}}class action_pagerduty_action_PagerDutyAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.PAGERDUTY,super(e,t),this.description=e.description}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{description:this.description}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{description:e.description}),{action:new action_pagerduty_action_PagerDutyAction(t,a),errors:a}}get upstreamJson(){const e=super.upstreamJson;return e[this.id]={pagerduty:{description:this.description}},e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),{errors:a}=this.validateJson(e.actionJson);return Object.assign(t,{description:e.actionJson.pagerduty.description}),{action:new action_pagerduty_action_PagerDutyAction(t,a),errors:a}}static validateJson(e){const t=[];return e.pagerduty||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.pagerDutyAction.actionJsonPagerDutyPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonPagerDuty} property",values:{actionJsonPagerDuty:"actionJson.pagerduty"}})}),e.pagerduty&&!e.pagerduty.description&&t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.pagerDutyAction.actionJsonPagerDutyDescriptionPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonPagerDutyText} property",values:{actionJsonPagerDutyText:"actionJson.pagerduty.description"}})}),{errors:t.length?t:null}}}class action_jira_action_JiraAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.JIRA,super(e,t),this.projectKey=e.projectKey,this.issueType=e.issueType,this.summary=e.summary}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{projectKey:this.projectKey,issueType:this.issueType,summary:this.summary}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{projectKey:e.projectKey,issueType:e.issueType,summary:e.summary}),{action:new action_jira_action_JiraAction(t,a),errors:a}}get upstreamJson(){const e=super.upstreamJson;return e[this.id]={jira:{fields:{project:{key:this.projectKey},issuetype:{name:this.issueType},summary:this.summary}}},e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),{errors:a}=this.validateJson(e.actionJson);return Object.assign(t,{projectKey:Object(J.get)(e,"actionJson.jira.fields.project.key"),issueType:Object(J.get)(e,"actionJson.jira.fields.issuetype.name"),summary:Object(J.get)(e,"actionJson.jira.fields.summary")}),{action:new action_jira_action_JiraAction(t,a),errors:a}}static validateJson(e){const t=[];return e.jira||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.jiraAction.actionJsonJiraPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonJira} property",values:{actionJsonJira:"actionJson.jira"}})}),Object(J.get)(e,"jira.fields.project.key")||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.jiraAction.actionJsonJiraProjectKeyPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonJiraProjectKey} property",values:{actionJsonJiraProjectKey:"actionJson.jira.fields.project.key"}})}),Object(J.get)(e,"jira.fields.issuetype.name")||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.jiraAction.actionJsonJiraIssueTypePropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonJiraIssueType} property",values:{actionJsonJiraIssueType:"actionJson.jira.fields.issuetype.name"}})}),Object(J.get)(e,"jira.fields.summary")||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.jiraAction.actionJsonJiraSummaryPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJsonJiraSummary} property",values:{actionJsonJiraSummary:"actionJson.jira.fields.summary"}})}),{errors:t.length?t:null}}}class action_unknown_action_UnknownAction extends action_base_action_BaseAction{constructor(e,t){e.type=X.c.UNKNOWN,super(e,t),this.actionJson=e.actionJson}get downstreamJson(){const e=super.downstreamJson;return Object.assign(e,{actionJson:this.actionJson}),e}static fromDownstreamJson(e){const t=super.getPropsFromDownstreamJson(e);return Object.assign(t,{actionJson:e.actionJson}),new action_unknown_action_UnknownAction(t)}get upstreamJson(){const e=super.upstreamJson;return e[this.id]=this.actionJson,e}static fromUpstreamJson(e){const t=super.getPropsFromUpstreamJson(e),{errors:a}=this.validateJson(e);return Object.assign(t,{actionJson:e.actionJson}),{action:new action_unknown_action_UnknownAction(t,a),errors:a}}static validateJson(e){const t=[];return e.actionJson||t.push({code:X.f.ERR_PROP_MISSING,message:z.i18n.translate("xpack.watcher.models.unknownAction.actionJsonPropertyMissingBadRequestMessage",{defaultMessage:"JSON argument must contain an {actionJson} property",values:{actionJson:"actionJson"}})}),{errors:t.length?t:null}}}const it={};Object(Y.set)(it,X.c.LOGGING,action_logging_action_LoggingAction),Object(Y.set)(it,X.c.EMAIL,action_email_action_EmailAction),Object(Y.set)(it,X.c.SLACK,action_slack_action_SlackAction),Object(Y.set)(it,X.c.INDEX,action_index_action_IndexAction),Object(Y.set)(it,X.c.WEBHOOK,action_webhook_action_WebhookAction),Object(Y.set)(it,X.c.PAGERDUTY,action_pagerduty_action_PagerDutyAction),Object(Y.set)(it,X.c.JIRA,action_jira_action_JiraAction),Object(Y.set)(it,X.c.UNKNOWN,action_unknown_action_UnknownAction);class action_action_Action{static fromUpstreamJson(e){const t=tt(e.actionJson),a=it[t]||action_unknown_action_UnknownAction,{action:s}=a.fromUpstreamJson(e);return s}static fromDownstreamJson(e){const t=it[e.type]||action_unknown_action_UnknownAction,{action:a}=t.fromDownstreamJson(e);return a}}function nt(e){const t={};return Object(J.forEach)(e,(e=>{const a=action_action_Action.fromDownstreamJson(e);Object.assign(t,a.upstreamJson)})),t}function ot(e){return e.replace(/\s+/g," ").trim()}K()(action_action_Action,"getActionTypes",(()=>it));const{BETWEEN:rt}=X.e;function ct(e,t,a){let s="";return"count"!==e||a||(s=t===rt?"\n      if (ctx.payload.hits.total >= params.threshold[0] && ctx.payload.hits.total <= params.threshold[1]) {\n        return true;\n      }\n\n      return false;\n    ":`\n      if (ctx.payload.hits.total ${t} params.threshold) {\n        return true;\n      }\n\n      return false;\n    `),"count"===e&&a&&(s=t===rt?"\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      for (int i = 0; i < arr.length; i++) {\n        if (arr[i].doc_count >= params.threshold[0] && arr[i].doc_count <= params.threshold[1]) {\n          return true;\n        }\n      }\n\n      return false;\n    ":`\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      for (int i = 0; i < arr.length; i++) {\n        if (arr[i].doc_count ${t} params.threshold) {\n          return true;\n        }\n      }\n\n      return false;\n    `),"count"===e||a||(s=t===rt?"\n      if (ctx.payload.aggregations.metricAgg.value >= params.threshold[0]\n        && ctx.payload.aggregations.metricAgg.value <= params.threshold[1]) {\n        return true;\n      }\n\n      return false;\n    ":`\n      if (ctx.payload.aggregations.metricAgg.value ${t} params.threshold) {\n        return true;\n      }\n\n      return false;\n    `),"count"!==e&&a&&(s=t===rt?"\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      for (int i = 0; i < arr.length; i++) {\n        if (arr[i]['metricAgg'].value >= params.threshold[0] && arr[i]['metricAgg'].value <= params.threshold[1]) {\n          return true;\n        }\n      }\n\n      return false;\n    ":`\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      for (int i = 0; i < arr.length; i++) {\n        if (arr[i]['metricAgg'].value ${t} params.threshold) {\n          return true;\n        }\n      }\n\n      return false;\n    `),ot(s)}function lt(e){return{threshold:e}}function ut({aggType:e,thresholdComparator:t,hasTermsAgg:a,threshold:s}){return{script:{source:ct(e,t,a),params:lt(s)}}}function dt(e){return Array.isArray(e)?e:[e]}function ht(e,t,a){return{[a]:{gte:`{{ctx.trigger.scheduled_time}}||-${e}${t}`,lte:"{{ctx.trigger.scheduled_time}}",format:"strict_date_optional_time||epoch_millis"}}}function gt(e,t,a){return{bool:{filter:{range:ht(e,t,a)}}}}function mt(e,t,a,s,i,n,o,r){const c={size:0,query:gt(e,t,a)},l=function(e,t,a,s,i){if("count"===e&&!a)return null;if("count"===e&&a)return{bucketAgg:{terms:{field:a,size:s,order:{_count:i}}}};if("count"!==e&&!a){const a={metricAgg:{}};return Object(Y.set)(a,`metricAgg.${e}`,{field:t}),a}if("count"!==e&&a){const n={bucketAgg:{terms:{field:a,size:s,order:{metricAgg:i}},aggs:{metricAgg:{}}}};return Object(Y.set)(n,`bucketAgg.aggs.metricAgg.${e}`,{field:t}),n}}(s,i,n,o,r);return Boolean(l)&&(c.aggs=l),c}function pt({index:e,timeWindowSize:t,timeWindowUnit:a,timeField:s,aggType:i,aggField:n,termField:o,termSize:r,termOrder:c}){return{search:{request:{body:mt(t,a,s,i,n,o,r,c),indices:dt(e)}}}}function jt({index:e,timeField:t,triggerIntervalSize:a,triggerIntervalUnit:s,aggType:i,aggField:n,termSize:o,termField:r,thresholdComparator:c,timeWindowSize:l,timeWindowUnit:u,threshold:d}){return{watcherui:{index:e,time_field:t,trigger_interval_size:a,trigger_interval_unit:s,agg_type:i,agg_field:n,term_size:o,term_field:r,threshold_comparator:c,time_window_size:l,time_window_unit:u,threshold:d}}}const{BETWEEN:bt}=X.e;function xt(e,t,a){let s="";return"count"!==e||a||(s="\n      HashMap result = new HashMap();\n      result.result = ctx.payload.hits.total;\n\n      return result;\n    "),"count"===e&&a&&(s=t===bt?"\n      HashMap result = new HashMap();\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      ArrayList filteredHits = new ArrayList();\n\n      for (int i = 0; i < arr.length; i++) {\n        HashMap filteredHit = new HashMap();\n        filteredHit.key = arr[i].key;\n        filteredHit.value = arr[i].doc_count;\n        if (filteredHit.value >= params.threshold[0] && filteredHit.value <= params.threshold[1]) {\n          filteredHits.add(filteredHit);\n        }\n      }\n      result.results = filteredHits;\n\n      return result;\n    ":`\n      HashMap result = new HashMap();\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      ArrayList filteredHits = new ArrayList();\n\n      for (int i = 0; i < arr.length; i++) {\n        HashMap filteredHit = new HashMap();\n        filteredHit.key = arr[i].key;\n        filteredHit.value = arr[i].doc_count;\n        if (filteredHit.value ${t} params.threshold) {\n          filteredHits.add(filteredHit);\n        }\n      }\n      result.results = filteredHits;\n\n      return result;\n    `),"count"===e||a||(s="\n      HashMap result = new HashMap();\n      result.result = ctx.payload.aggregations.metricAgg.value;\n\n      return result;\n    "),"count"!==e&&a&&(s=t===bt?"\n      HashMap result = new HashMap();\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      ArrayList filteredHits = new ArrayList();\n\n      for (int i = 0; i < arr.length; i++) {\n        HashMap filteredHit = new HashMap();\n        filteredHit.key = arr[i].key;\n        filteredHit.value = arr[i]['metricAgg'].value;\n        if (filteredHit.value >= params.threshold[0] && filteredHit.value <= params.threshold[1]) {\n          filteredHits.add(filteredHit);\n        }\n      }\n      result.results = filteredHits;\n\n      return result;\n    ":`\n      HashMap result = new HashMap();\n      ArrayList arr = ctx.payload.aggregations.bucketAgg.buckets;\n      ArrayList filteredHits = new ArrayList();\n\n      for (int i = 0; i < arr.length; i++) {\n        HashMap filteredHit = new HashMap();\n        filteredHit.key = arr[i].key;\n        filteredHit.value = arr[i]['metricAgg'].value;\n        if (filteredHit.value ${t} params.threshold) {\n          filteredHits.add(filteredHit);\n        }\n      }\n      result.results = filteredHits;\n\n      return result;\n    `),ot(s)}function wt(e){return{threshold:e}}function ft({aggType:e,thresholdComparator:t,hasTermsAgg:a,threshold:s}){return{script:{source:xt(e,t,a),params:wt(s)}}}function yt(e,t){return{schedule:{interval:`${e}${t}`}}}function Ot({name:e,triggerIntervalSize:t,triggerIntervalUnit:a,index:s,timeWindowSize:i,timeWindowUnit:n,timeField:o,aggType:r,aggField:c,termField:l,termSize:u,termOrder:d,thresholdComparator:h,hasTermsAgg:g,threshold:m,actions:p,includeMetadata:j=!0}){const b={trigger:yt(t,a),input:pt({index:s,timeWindowSize:i,timeWindowUnit:n,timeField:o,aggType:r,aggField:c,termField:l,termSize:u,termOrder:d}),condition:ut({aggType:r,thresholdComparator:h,hasTermsAgg:g,threshold:m}),transform:ft({aggType:r,thresholdComparator:h,hasTermsAgg:g,threshold:m}),actions:nt(p)};return j&&(b.metadata={xpack:{type:X.n.THRESHOLD},...jt({index:s,timeField:o,triggerIntervalSize:t,triggerIntervalUnit:a,aggType:r,aggField:c,termSize:u,termField:l,thresholdComparator:h,timeWindowSize:i,timeWindowUnit:n,threshold:m})},e&&(b.metadata.name=e)),b}function Et(e){const t=Object.keys(e);let a;return Object.keys(X.c).forEach((e=>{t.includes(X.c[e])&&(a=X.c[e])})),a||X.c.UNKNOWN}function vt(e,t){if(e===X.c.SLACK)return t[e].message;if(e===X.c.JIRA){const a={};return a.projectKey=Object(J.get)(t[e],"fields.project.key"),a.issueType=Object(J.get)(t[e],"fields.issuetype.name"),a.summary=Object(J.get)(t[e],"fields.summary"),a}return t[e]}async function kt(e,t){try{await Ee(e),t.addSuccess(e.isNew?z.i18n.translate("xpack.watcher.sections.watchEdit.json.createSuccessNotificationText",{defaultMessage:"Created ''{watchDisplayName}''",values:{watchDisplayName:e.displayName}}):z.i18n.translate("xpack.watcher.sections.watchEdit.json.saveSuccessNotificationText",{defaultMessage:"Saved ''{watchDisplayName}''",values:{watchDisplayName:e.displayName}})),Se()}catch(e){var a;return{error:null!==(a=null==e?void 0:e.response.data)&&void 0!==a?a:e.body||e}}}async function Mt(e,t){const a=e.watch&&e.watch.actions?((s=e).resetActions(),Object.keys(s.watch.actions).forEach((e=>{const t=s.watch.actions[e],a=Et(t),i={...vt(a,t),ignoreDefaults:!0};s.createAction(a,i)})),s):e;var s;if(a.type===X.n.JSON){const e=a.actions.reduce(((e,t)=>{if(t.validate){const a=t.validate(),s=Object.keys(a);if(!s.find((e=>a[e].length>=1)))return e;const i=s.map((e=>a[e])),n=i&&i.length?[].concat(...i):[];return[...e,...n]}return e}),[]);return e.length>0?{error:{data:{message:e,error:"validation"}}}:kt(a,t)}return kt(a,t)}class request_flyout_RequestFlyout extends s.PureComponent{getEsJson(e){return JSON.stringify(e,null,2)}render(){const{id:e,payload:t,close:a}=this.props,s=`PUT _watcher/watch/${e||"<watchId>"}\n${this.getEsJson(t)}`;return Object(f.jsx)(j.EuiFlyout,{maxWidth:480,onClose:a},Object(f.jsx)(j.EuiFlyoutHeader,null,Object(f.jsx)(j.EuiTitle,null,Object(f.jsx)("h2",null,e?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.requestFlyout.namedTitle",defaultMessage:"Request for ''{id}''",values:{id:e}}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.requestFlyout.unnamedTitle",defaultMessage:"Request"})))),Object(f.jsx)(j.EuiFlyoutBody,null,Object(f.jsx)(j.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.requestFlyout.descriptionText",defaultMessage:"This Elasticsearch request will create or update this watch."}))),Object(f.jsx)(j.EuiSpacer,null),Object(f.jsx)(j.EuiCodeBlock,{language:"json",isCopyable:!0},s)),Object(f.jsx)(j.EuiFlyoutFooter,null,Object(f.jsx)(j.EuiButtonEmpty,{iconType:"cross",onClick:a,flush:"left"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.requestFlyout.closeButtonLabel",defaultMessage:"Close"}))))}}const{useXJsonMode:Tt}=r.XJson,St=()=>{const{links:{putWatchApiUrl:e},toasts:t}=Le(),{watch:a,setWatchProperty:i}=Object(s.useContext)(Qe),{convertToJson:n,setXJson:o,xJson:r}=Tt(a.watchString),{errors:c}=a.validate(),l=!!Object.keys(c).find((e=>c[e].length>=1)),[u,d]=Object(s.useState)(null),[h,g]=Object(s.useState)(!1),[m,p]=Object(s.useState)(null),[b,x]=Object(s.useState)(!1),w=!!u,y=z.i18n.translate("xpack.watcher.sections.watchEdit.json.form.actionValidationErrorMessage",{defaultMessage:"Invalid watch actions"}),O={...c,json:w?[...c.json,y]:[...c.json]};return Object(s.useEffect)((()=>{0===c.json.length&&i("watch",JSON.parse(a.watchString))}),[i,c,a]),Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiForm,{isInvalid:w,error:u||[],"data-test-subj":"jsonWatchForm"},m&&Object(f.jsx)(s.Fragment,null,Object(f.jsx)(Ve,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.saveWatchErrorTitle",defaultMessage:"Error saving watch"}),error:m,"data-test-subj":"sectionError"}),Object(f.jsx)(j.EuiSpacer,null)),Object(f.jsx)(j.EuiFormRow,{id:"watchName",label:z.i18n.translate("xpack.watcher.sections.watchEdit.json.form.watchNameLabel",{defaultMessage:"Name (optional)"})},Object(f.jsx)(j.EuiFieldText,{id:"watchName",name:"name",value:a.name||"","data-test-subj":"nameInput",onChange:e=>{const t=e.target.value;i("name",t)},onBlur:()=>{a.name||i("name","")}})),Object(f.jsx)(Re,{id:"watchId",label:z.i18n.translate("xpack.watcher.sections.watchEdit.json.form.watchIDLabel",{defaultMessage:"ID"}),errorKey:"id",isShowingErrors:l&&void 0!==a.id,errors:c},Object(f.jsx)(j.EuiFieldText,{id:"id",name:"id","data-test-subj":"idInput",value:a.id||"",readOnly:!a.isNew,onChange:e=>{i("id",e.target.value)},onBlur:()=>{a.id||i("id","")}})),Object(f.jsx)(j.EuiSpacer,{size:"m"}),Object(f.jsx)(Re,{id:"watchJson",label:Object(f.jsx)(s.Fragment,null,z.i18n.translate("xpack.watcher.sections.watchEdit.json.form.watchJsonLabel",{defaultMessage:"Watch JSON"})," ","(",Object(f.jsx)(j.EuiLink,{href:e,target:"_blank"},z.i18n.translate("xpack.watcher.sections.watchEdit.json.form.watchJsonDocLink",{defaultMessage:"API syntax"})),")"),errorKey:"json",isShowingErrors:l||w,fullWidth:!0,errors:O},Object(f.jsx)(at.CodeEditor,{languageId:"json",value:r,"data-test-subj":"jsonEditor",height:500,options:{lineNumbers:"off",tabSize:2,automaticLayout:!0},"aria-label":z.i18n.translate("xpack.watcher.sections.watchEdit.json.form.watchJsonAriaLabel",{defaultMessage:"Code editor"}),onChange:e=>{u&&d(null),o(e),i("watchString",n(e))}})),Object(f.jsx)(j.EuiSpacer,null),Object(f.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(j.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiButton,{"data-test-subj":"saveWatchButton",fill:!0,color:"success",type:"submit",iconType:"check",isLoading:b,isDisabled:l,onClick:async()=>{x(!0);const e=await Mt(a,t);if(e&&e.error){const{data:t}=e.error;return x(!1),t&&"validation"===t.error?d(t.message):p(e.error)}}},a.isNew?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.createButtonLabel",defaultMessage:"Create watch"}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.saveButtonLabel",defaultMessage:"Save watch"}))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiButtonEmpty,{"data-test-subj":"btnCancelWatch",onClick:()=>Se()},z.i18n.translate("xpack.watcher.sections.watchEdit.json.cancelButtonLabel",{defaultMessage:"Cancel"})))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiButtonEmpty,{onClick:()=>g(!h)},h?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.hideRequestButtonLabel",defaultMessage:"Hide request"}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.showRequestButtonLabel",defaultMessage:"Show request"}))))),h?Object(f.jsx)(request_flyout_RequestFlyout,{id:a.id,payload:st(a.name,a.watch),close:()=>g(!1)}):null)},_t=({executeResults:e,executeDetails:t,onCloseFlyout:a,error:n})=>{var o,r,c,l;const{watch:u}=Object(s.useContext)(Qe),{actionModes:d}=t,h=e=>{switch(e){case"simulate":case"force_simulate":return z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.statusColumnValue.notSimulated",{defaultMessage:"not simulated"});case"execute":case"force_execute":return z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.statusColumnValue.notExecuted",{defaultMessage:"not executed"});case"skip":return z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.statusColumnValue.throttled",{defaultMessage:"throttled"});default:return""}},g=(()=>{const t=u.watch&&u.watch.actions;if(e&&t){const a=e.watchStatus&&e.watchStatus.actionStatuses;return Object.keys(t).map((s=>{var i,n,o,r,c,l;const u=a.find((e=>e.id===s)),g=null===(i=e.details)||void 0===i||null===(n=i.result)||void 0===n||null===(o=n.condition)||void 0===o?void 0:o.met;return{actionId:s,actionType:Et(t[s]),actionMode:d[s],actionState:u&&u.state,actionReason:u&&u.lastExecutionReason,actionStatus:g&&(null===(r=e.details)||void 0===r||null===(c=r.result)||void 0===c||null===(l=c.actions.find((e=>e.id===s)))||void 0===l?void 0:l.status)||h(d[s])}}))}return[]})(),m=[{field:"actionId",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.actionColumnLabel",{defaultMessage:"ID"}),sortable:!0,truncateText:!0},{field:"actionType",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.typeColumnLabel",{defaultMessage:"Type"}),truncateText:!0},{field:"actionMode",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.modeColumnLabel",{defaultMessage:"Mode"})},{field:"actionState",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.stateColumnLabel",{defaultMessage:"State"}),dataType:"string",render:(e,t)=>Object(f.jsx)(Ue,{state:e})},{field:"actionReason",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.reasonColumnLabel",{defaultMessage:"Reason"})},{field:"actionStatus",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.table.statusColumnLabel",{defaultMessage:"Status"})}],p=Object(f.jsx)(j.EuiTitle,{size:"s"},Object(f.jsx)("h2",{id:"simulateResultsFlyOutTitle","data-test-subj":"simulateResultsFlyoutTitle"},z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.title",{defaultMessage:"Simulation results"})));if(n)return Object(f.jsx)(j.EuiFlyout,{onClose:()=>{a()},"aria-labelledby":"simulateResultsFlyOutTitle"},Object(f.jsx)(j.EuiFlyoutHeader,{hasBorder:!0},p),Object(f.jsx)(j.EuiFlyoutBody,null,Object(f.jsx)(Ve,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.simulateResults.errorTitle",defaultMessage:"Cannot simulate watch"}),error:n})));if(!e)return null;const{details:b}=e,x=(null==b||null===(o=b.result)||void 0===o||null===(r=o.condition)||void 0===r?void 0:r.met)&&Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(j.EuiIcon,{color:"green",type:"check","data-test-subj":"conditionMetStatus"})," ",Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.simulateResults.conditionMetStatus",defaultMessage:"Condition met"}))||Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(j.EuiIcon,{color:"subdued",type:"cross","data-test-subj":"conditionNotMetStatus"})," ",Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.simulateResults.conditionNotMetStatus",defaultMessage:"Condition not met"}));return Object(f.jsx)(j.EuiFlyout,{onClose:()=>{a()},"data-test-subj":"simulateResultsFlyout","aria-labelledby":"simulateResultsFlyOutTitle"},Object(f.jsx)(j.EuiFlyoutHeader,{hasBorder:!0},p,null!=(null==b||null===(c=b.result)||void 0===c||null===(l=c.condition)||void 0===l?void 0:l.met)&&Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(j.EuiSpacer,{size:"s"}),x)),Object(f.jsx)(j.EuiFlyoutBody,null,g&&g.length>0&&Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiText,null,Object(f.jsx)("h5",null,z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.actionsSectionTitle",{defaultMessage:"Actions"}))),Object(f.jsx)(j.EuiSpacer,{size:"m"}),Object(f.jsx)(j.EuiBasicTable,{columns:m,items:g,"data-test-subj":"simulateResultsTable"}),Object(f.jsx)(j.EuiSpacer,{size:"l"})),Object(f.jsx)(j.EuiText,null,Object(f.jsx)("h5",null,z.i18n.translate("xpack.watcher.sections.watchEdit.simulateResults.simulationOutputSectionTitle",{defaultMessage:"Simulation output"}))),Object(f.jsx)(j.EuiSpacer,{size:"l"}),Object(f.jsx)(j.EuiCodeBlock,{language:"json"},JSON.stringify(b,null,2))))},{useXJsonMode:At}=r.XJson,Ft=Object.keys(X.a).map((e=>({text:X.a[e],value:X.a[e]}))),It=(e="0")=>Object.entries(X.l).filter((([e])=>e!==X.l.DAY)).map((([t,a])=>({text:ne(a,e),value:a}))),Jt=({executeWatchErrors:e,hasExecuteWatchErrors:t,executeDetails:a,setExecuteDetails:i,watchActions:n})=>{const{links:{executeWatchApiUrl:o}}=Le(),{watch:r}=Object(s.useContext)(Qe),[c,l]=Object(s.useState)(null),[u,d]=Object(s.useState)(!1),[h,g]=Object(s.useState)(null),{errors:m}=r.validate(),p=m.json.length>=1,{actionModes:b,scheduledTimeValue:x,scheduledTimeUnit:w,triggeredTimeValue:y,alternativeInput:O,ignoreCondition:E}=a,{setXJson:v,convertToJson:k,xJson:M}=At(O),T=[{field:"actionId",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.table.idColumnLabel",{defaultMessage:"ID"}),sortable:!0,truncateText:!0},{field:"type",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.table.typeColumnLabel",{defaultMessage:"Type"}),truncateText:!0},{field:"actionMode",name:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.table.modeColumnLabel",{defaultMessage:"Mode"}),render:({},e)=>Object(f.jsx)(j.EuiSelect,{options:Ft,value:b[e.actionId],"data-test-subj":"actionModesSelect",onChange:t=>{i(new execute_details_ExecuteDetails({...a,actionModes:{...b,[e.actionId]:t.target.value}}))},"aria-label":z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.table.modeSelectLabel",{defaultMessage:"Action modes"})})}];return Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiText,null,Object(f.jsx)("p",null,z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.pageDescription",{defaultMessage:"Use the simulator to override the watch schedule, condition, actions, and input results."}))),Object(f.jsx)(j.EuiSpacer,{size:"l"}),Object(f.jsx)(j.EuiForm,{"data-test-subj":"jsonWatchSimulateForm"},Object(f.jsx)(j.EuiDescribedFormGroup,{fullWidth:!0,title:Object(f.jsx)("h2",null,z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.triggerOverridesTitle",{defaultMessage:"Trigger"})),description:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.triggerOverridesDescription",{defaultMessage:"Set the time and date for starting the watch."})},Object(f.jsx)(j.EuiFormRow,{label:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.scheduledTimeFieldLabel",{defaultMessage:"Schedule every"})},Object(f.jsx)(j.EuiFlexGroup,null,Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiFieldNumber,{value:null==x||""===x?x:parseInt(x,10),min:0,"data-test-subj":"scheduledTimeInput",onChange:e=>{const t=e.target.value;i(new execute_details_ExecuteDetails({...a,scheduledTimeValue:""===t?t:parseInt(t,10)}))}})),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiSelect,{value:w,options:It(x),onChange:e=>{i(new execute_details_ExecuteDetails({...a,scheduledTimeUnit:e.target.value}))}})))),Object(f.jsx)(j.EuiFormRow,{label:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.triggeredTimeFieldLabel",{defaultMessage:"Trigger after"})},Object(f.jsx)(j.EuiFieldNumber,{value:null==y||""===y?y:parseInt(y,10),min:0,"data-test-subj":"triggeredTimeInput",append:Object(f.jsx)(j.EuiText,{size:"s"},ne(X.l.SECOND,y)),onChange:e=>{const t=e.target.value;i(new execute_details_ExecuteDetails({...a,triggeredTimeValue:""===t?t:parseInt(t,10),triggeredTimeUnit:X.l.SECOND}))}}))),Object(f.jsx)(j.EuiDescribedFormGroup,{fullWidth:!0,title:Object(f.jsx)("h2",null,z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.conditionOverridesTitle",{defaultMessage:"Condition"})),description:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.conditionOverridesDescription",{defaultMessage:"Execute the watch when the condition is met. Otherwise, ignore the condition and run the watch on a fixed schedule."})},Object(f.jsx)(j.EuiSwitch,{label:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.ignoreConditionFieldLabel",{defaultMessage:"Ignore condition"}),checked:E,"data-test-subj":"ignoreConditionSwitch",onChange:e=>{i(new execute_details_ExecuteDetails({...a,ignoreCondition:e.target.checked}))}})),Object(f.jsx)(j.EuiDescribedFormGroup,{fullWidth:!0,title:Object(f.jsx)("h2",null,z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.actionOverridesTitle",{defaultMessage:"Actions"})),description:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.simulate.form.actionOverridesDescription",defaultMessage:"Allow the watch to execute or skip actions. {actionsLink}",values:{actionsLink:Object(f.jsx)(j.EuiLink,{href:o,target:"_blank"},z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.actionOverridesDescription.linkLabel",{defaultMessage:"Learn about actions."}))}})},Object(f.jsx)(j.EuiFormRow,{label:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.actionModesFieldLabel",{defaultMessage:"Action modes"}),fullWidth:!0},Object(f.jsx)(j.EuiBasicTable,{items:n,itemId:"simulateExecutionActionModesTable",columns:T}))),Object(f.jsx)(j.EuiDescribedFormGroup,{fullWidth:!0,title:Object(f.jsx)("h2",null,z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.inputOverridesTitle",{defaultMessage:"Input"})),description:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.inputOverridesDescription",{defaultMessage:"Enter JSON data to override the watch payload that comes from running the input."})},Object(f.jsx)(Re,{id:"executeWatchJson",label:z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.alternativeInputFieldLabel",{defaultMessage:"Alternative input"}),errorKey:"json",isShowingErrors:t,fullWidth:!0,errors:e},Object(f.jsx)(at.CodeEditor,{languageId:"json",value:M,"data-test-subj":"jsonEditor",height:200,options:{fontSize:12,tabSize:2,scrollBeyondLastLine:!1},"aria-label":z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.alternativeInputAriaLabel",{defaultMessage:"Code editor"}),onChange:e=>{v(e),i(new execute_details_ExecuteDetails({...a,alternativeInput:k(e)}))}}))),Object(f.jsx)(j.EuiButton,{iconType:"play","data-test-subj":"simulateWatchButton",fill:!0,type:"submit",isLoading:u,isDisabled:t||p,onClick:async()=>{d(!0);const{data:e,error:t}=await ve(a,r);if(d(!1),t)return g(t);const s=watch_history_item_WatchHistoryItem.fromUpstreamJson(e.watchHistoryItem);l(s)}},z.i18n.translate("xpack.watcher.sections.watchEdit.simulate.form.saveButtonLabel",{defaultMessage:"Simulate watch"}))),Object(f.jsx)(_t,{executeResults:c,executeDetails:a,error:h,onCloseFlyout:()=>{l(null),g(null)}}))},Lt="watchEditTab",Ct="watchSimulateTab",Wt=[{id:Lt,name:z.i18n.translate("xpack.watcher.sections.watchEdit.json.editTabLabel",{defaultMessage:"Edit"})},{id:Ct,name:z.i18n.translate("xpack.watcher.sections.watchEdit.json.simulateTabLabel",{defaultMessage:"Simulate"})}],Dt={triggeredTimeValue:0,triggeredTimeUnit:X.l.SECOND,scheduledTimeValue:0,scheduledTimeUnit:X.l.SECOND,ignoreCondition:!1};function Nt(e){return e.reduce(((e,t)=>(t.actionId&&(e[t&&t.actionId]=t.actionMode),e)),{})}const Pt=({pageTitle:e})=>{const{watch:t}=Object(s.useContext)(Qe),a=function(e){const t=e.watch&&e.watch.actions||{};return Object.keys(t).map((e=>({actionId:e,type:tt(t[e]),actionMode:X.a.SIMULATE})))}(t),[i,n]=Object(s.useState)(Lt),[o,r]=Object(s.useState)(new execute_details_ExecuteDetails({...Dt,actionModes:Nt(a)})),c=o.validate(),l=!!Object.keys(c).find((e=>c[e].length>=1));return Object(f.jsx)(j.EuiPageSection,{restrictWidth:!0,style:{width:"100%"}},Object(f.jsx)(j.EuiPageHeader,{pageTitle:Object(f.jsx)("span",{"data-test-subj":"pageTitle"},e),bottomBorder:!0,tabs:Wt.map(((e,t)=>({onClick:()=>{n(e.id),r(new execute_details_ExecuteDetails({...o,actionModes:Nt(a)}))},isSelected:e.id===i,key:t,"data-test-subj":"tab",label:e.name})))}),Object(f.jsx)(j.EuiSpacer,{size:"l"}),i===Ct&&Object(f.jsx)(Jt,{executeDetails:o,setExecuteDetails:e=>r(e),executeWatchErrors:c,hasExecuteWatchErrors:l,watchActions:a}),i===Lt&&Object(f.jsx)(St,null))},Rt=({pageTitle:e})=>{const{watch:t}=Object(s.useContext)(Qe),{history:a}=Le(),i=Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.monitoring.edit.calloutDescriptionText",defaultMessage:"Watch ''{watchName}'' is a system watch and cannot be edited.",values:{watchName:t.name}});return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:"",title:Object(f.jsx)("h1",null,e),body:Object(f.jsx)("p",null,i),actions:[Object(f.jsx)(j.EuiLink,Object(o.reactRouterNavigate)(a,`/watches/watch/${t.id}/status`),Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.monitoring.header.watchLinkTitle",defaultMessage:"View watch status"}))]})};var Bt=a(34),zt=a(27),Ht=a.n(zt),Ut=a(35),qt=a.n(Ut);class VisualizeOptions{constructor(e={}){this.rangeFrom=e.rangeFrom,this.rangeTo=e.rangeTo,this.interval=e.interval,this.timezone=e.timezone}get upstreamJson(){return{rangeFrom:this.rangeFrom,rangeTo:this.rangeTo,interval:this.interval,timezone:this.timezone}}}const Vt=e=>{const t="dateFormat:tz";if(!e.isDefault(t))return e.get(t);return qt.a.tz.guess()||qt()().format("Z")},Gt=e=>{const t=`now-${5*e.timeWindowSize}${e.timeWindowUnit}`,a=Ht.a.parse(t),s=Ht.a.parse("now");return{min:a?a.valueOf():0,max:s?s.valueOf():0}},$t=()=>{const{createTimeBuckets:e,chartsTheme:t,uiSettings:a}=Le(),{watch:i}=Object(s.useContext)(Qe),n=t.useChartsBaseTheme(),{index:o,timeField:r,triggerIntervalSize:c,triggerIntervalUnit:l,aggType:u,aggField:d,termSize:h,termField:g,thresholdComparator:m,timeWindowSize:p,timeWindowUnit:b,groupBy:x,threshold:w}=i,y=Object(s.useMemo)((()=>Gt(i)),[i]),O=e();O.setBounds(y);const E=O.getInterval().expression,v=new VisualizeOptions({rangeFrom:y.min,rangeTo:y.max,interval:E,timezone:Vt(a)}),k=new threshold_watch_ThresholdWatch({...i,actions:[]}),{isInitialRequest:M,isLoading:T,data:S,error:_,resendRequest:A}=((e,t)=>ge({path:`${je}/watch/visualize`,method:"post",body:JSON.stringify({watch:e.upstreamJson,options:t.upstreamJson}),deserializer:ke}))(k,v);if(Object(s.useEffect)((()=>{M||A()}),[o,r,c,l,u,d,h,g,m,p,b,x,w]),M&&T)return Object(f.jsx)(j.EuiEmptyPrompt,{title:Object(f.jsx)(j.EuiLoadingChart,{size:"xl"}),body:Object(f.jsx)(j.EuiText,{color:"subdued"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.loadingWatchVisualizationDescription",defaultMessage:"Loading watch visualization…"}))});if(_)return Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiSpacer,{size:"l"}),Object(f.jsx)(Ve,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.errorLoadingWatchVisualizationTitle",defaultMessage:"Cannot load watch visualization"}),error:_}),Object(f.jsx)(j.EuiSpacer,{size:"l"}));if(S){const t=Object.keys(S),s=Vt(a),o=(e=>e.threshold.slice(0,ce[e.thresholdComparator].requiredValues))(i);let r=o[o.length-1];Object.values(S).forEach((e=>{e.forEach((([,e])=>{e>r&&(r=e)}))}));const c=t=>qt()(t).tz(s).format(((e,t)=>{const a=Gt(e);return t.setBounds(a),t})(i,e()).getScaledDateFormat()),l=oe[i.aggType].text;return Object(f.jsx)("div",{"data-test-subj":"watchVisualizationChart"},Object(f.jsx)(j.EuiSpacer,{size:"l"}),t.length?Object(f.jsx)(Bt.Chart,{size:["100%",300],renderer:"canvas"},Object(f.jsx)(Bt.Settings,{theme:[{lineSeriesStyle:{line:{strokeWidth:3},point:{visible:!1}}}],baseTheme:n,xDomain:y,showLegend:!!i.termField,legendValues:[Bt.LegendValue.CurrentAndLastValue],legendPosition:Bt.Position.Bottom,locale:z.i18n.getLocale()}),Object(f.jsx)(Bt.Axis,{id:"bottom",position:Bt.Position.Bottom,showOverlappingTicks:!0,tickFormat:c}),Object(f.jsx)(Bt.Axis,{domain:{max:r,min:NaN},id:"left",title:l,position:Bt.Position.Left}),t.map((e=>Object(f.jsx)(Bt.LineSeries,{key:e,id:e,xScaleType:Bt.ScaleType.Time,yScaleType:Bt.ScaleType.Linear,data:S[e],xAccessor:0,yAccessors:[1],timeZone:s}))),o.map(((e,t)=>{const a=0===t?"threshold":`threshold${t}`;return Object(f.jsx)(Bt.LineAnnotation,{key:a,id:a,domainType:Bt.AnnotationDomainType.YDomain,dataValues:[{dataValue:i.threshold[t],details:a}]})}))):Object(f.jsx)(j.EuiCallOut,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.thresholdPreviewChart.noDataTitle",defaultMessage:"No data"}),color:"warning"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.thresholdPreviewChart.dataDoesNotExistTextMessage",defaultMessage:"Your index and condition did not return any data."})),Object(f.jsx)(j.EuiSpacer,{size:"l"}))}return null},Kt=z.i18n.translate("xpack.watcher.sections.watchEdit.actions.disabledOptionLabel",{defaultMessage:"Disabled. Configure your elasticsearch.yml."}),Yt=({settings:e,isLoading:t})=>{const{addAction:a}=Object(s.useContext)(Qe),[i,n]=Object(s.useState)(!1),o=action_Action.getActionTypes(),r=Object.entries(o).map((([t,{typeName:a,iconClass:s,selectMessage:i}])=>({type:t,typeName:a,iconClass:s,selectMessage:i,isEnabled:!(e&&e.actionTypes&&e.actionTypes[t]&&void 0!==e.actionTypes[t].enabled)||e.actionTypes[t].enabled}))),c=Object(f.jsx)(j.EuiButton,{"data-test-subj":"addWatchActionButton",iconType:"arrowDown",iconSide:"right",onClick:()=>n(!i)},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.actions.addActionButtonLabel",defaultMessage:"Add action"}));return Object(f.jsx)(j.EuiPopover,{id:"watchActionPanel",button:c,isOpen:i,closePopover:()=>n(!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(f.jsx)(j.EuiContextMenuPanel,{items:r.map(((e,t)=>{const s=e.type===X.c.EMAIL&&!e.isEnabled,i=s?Kt:e.selectMessage;return Object(f.jsx)(j.EuiContextMenuItem,{key:`${e.type}-${t}`,disabled:s,"data-test-subj":`${e.type}ActionButton`,onClick:()=>{a({type:e.type,defaults:{isNew:!0}}),n(!1)}},Object(f.jsx)(j.EuiFlexGroup,{responsive:!1},Object(f.jsx)(j.EuiFlexItem,{grow:!1,className:"watcherThresholdWatchActionContextMenuItem"},Object(f.jsx)(j.EuiIcon,{type:e.iconClass})),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)("strong",null,e.typeName),Object(f.jsx)(j.EuiSpacer,{size:"xs"}),Object(f.jsx)(j.EuiText,{size:"s"},Object(f.jsx)("p",null,i)))))}))}))},Xt=["head","get","post","put","delete"],Zt=["http","https"],Qt={[X.c.LOGGING]:({action:e,editAction:t,errors:a,hasErrors:s})=>{const{text:i}=e;return Object(f.jsx)(Re,{id:"loggingText",errorKey:"text",fullWidth:!0,errors:a,isShowingErrors:s&&void 0!==i,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.loggingAction.logTextFieldLabel",{defaultMessage:"Log text"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,name:"text",value:i||"","data-test-subj":"loggingTextInput",onChange:e=>{t({key:"text",value:e.target.value})},onBlur:()=>{i||t({key:"text",value:""})}}))},[X.c.SLACK]:({action:e,editAction:t,children:a})=>{const{text:i,to:n}=e,o=n?n.map((e=>({label:e}))):[];return Object(f.jsx)(s.Fragment,null,a,Object(f.jsx)(j.EuiFormRow,{fullWidth:!0,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.slackAction.recipientTextFieldLabel",{defaultMessage:"Recipient (optional)"})},Object(f.jsx)(j.EuiComboBox,{noSuggestions:!0,fullWidth:!0,selectedOptions:o,"data-test-subj":"slackRecipientComboBox",onCreateOption:e=>{const a=[...o,{label:e}];t({key:"to",value:a.map((e=>e.label))})},onChange:e=>{t({key:"to",value:e.map((e=>e.label))})}})),Object(f.jsx)(j.EuiFormRow,{fullWidth:!0,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.slackAction.messageTextAreaFieldLabel",{defaultMessage:"Message (optional)"})},Object(f.jsx)(j.EuiTextArea,{fullWidth:!0,name:"text",value:i,"data-test-subj":"slackMessageTextarea",onChange:e=>{t({key:"text",value:e.target.value})}})))},[X.c.EMAIL]:({action:e,editAction:t,errors:a,hasErrors:i})=>{const{to:n,subject:o,body:r}=e,c=n?n.map((e=>({label:e}))):[];return Object(f.jsx)(s.Fragment,null,Object(f.jsx)(Re,{id:"emailRecipient",errorKey:"to",fullWidth:!0,errors:a,isShowingErrors:i&&void 0!==n,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.emailAction.recipientTextFieldLabel",{defaultMessage:"To email address"})},Object(f.jsx)(j.EuiComboBox,{noSuggestions:!0,fullWidth:!0,"data-test-subj":"toEmailAddressInput",selectedOptions:c,onCreateOption:e=>{const a=[...c,{label:e}];t({key:"to",value:a.map((e=>e.label))})},onChange:e=>{t({key:"to",value:e.map((e=>e.label))})},onBlur:()=>{n||t({key:"to",value:[]})}})),Object(f.jsx)(j.EuiFormRow,{fullWidth:!0,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.emailAction.subjectTextFieldLabel",{defaultMessage:"Subject (optional)"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,name:"subject","data-test-subj":"emailSubjectInput",value:o||"",onChange:e=>{t({key:"subject",value:e.target.value})}})),Object(f.jsx)(j.EuiFormRow,{fullWidth:!0,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.emailAction.bodyTextAreaFieldLabel",{defaultMessage:"Body"})},Object(f.jsx)(j.EuiTextArea,{fullWidth:!0,value:r||"",name:"body","data-test-subj":"emailBodyInput",onChange:e=>{t({key:"body",value:e.target.value})}})))},[X.c.INDEX]:({action:e,editAction:t,errors:a,hasErrors:s})=>{const{index:i}=e;return Object(f.jsx)(Re,{id:"indexName",errorKey:"index",fullWidth:!0,errors:a,isShowingErrors:s&&void 0!==i,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.indexAction.indexFieldLabel",{defaultMessage:"Index"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,name:"index","data-test-subj":"indexInput",value:i||"",onChange:e=>{t({key:"index",value:e.target.value})},onBlur:()=>{i||t({key:"index",value:""})}}))},[X.c.WEBHOOK]:({action:e,editAction:t,errors:a,hasErrors:i})=>{const{method:n,host:o,port:r,scheme:c,path:l,body:u,username:d,password:h}=e;return Object(s.useEffect)((()=>{t({key:"contentType",value:"application/json"})}),[t]),Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiFormRow,{label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.methodFieldLabel",{defaultMessage:"Method"})},Object(f.jsx)(j.EuiSelect,{name:"method",value:n||"get","data-test-subj":"webhookMethodSelect",options:Xt.map((e=>({text:e.toUpperCase(),value:e}))),onChange:e=>{t({key:"method",value:e.target.value})}}))),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiFormRow,{label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.schemeFieldLabel",{defaultMessage:"Scheme"})},Object(f.jsx)(j.EuiSelect,{name:"scheme",value:c,"data-test-subj":"webhookSchemeSelect",options:Zt.map((e=>({text:e,value:e}))),onChange:e=>{t({key:"scheme",value:e.target.value})}}))),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(Re,{id:"webhookHost",errorKey:"host",fullWidth:!0,errors:a,isShowingErrors:i&&void 0!==o,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.hostFieldLabel",{defaultMessage:"Host"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,name:"host",value:o||"","data-test-subj":"webhookHostInput",onChange:e=>{t({key:"host",value:e.target.value})},onBlur:()=>{o||t({key:"host",value:""})}}))),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(Re,{id:"webhookPort",errorKey:"port",fullWidth:!0,errors:a,isShowingErrors:i&&void 0!==r,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.methodPortLabel",{defaultMessage:"Port"})},Object(f.jsx)(j.EuiFieldNumber,{prepend:":",fullWidth:!0,name:"port",value:r||"","data-test-subj":"webhookPortInput",onChange:e=>{t({key:"port",value:parseInt(e.target.value,10)})},onBlur:()=>{r||t({key:"port",value:""})}}))),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiFormRow,{fullWidth:!0,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.pathFieldLabel",{defaultMessage:"Path (optional)"})},Object(f.jsx)(j.EuiFieldText,{prepend:"/",fullWidth:!0,name:"path",value:l||"","data-test-subj":"webhookPathInput",onChange:e=>{t({key:"path",value:e.target.value})}})))),Object(f.jsx)(j.EuiFlexGroup,null,Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(Re,{id:"webhookBasicAuthUsername",errorKey:"username",isShowingErrors:i,errors:a,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.basicAuthUsername",{defaultMessage:"Username (optional)"})},Object(f.jsx)(j.EuiFieldText,{name:"username",value:d||"","data-test-subj":"webhookUsernameInput",onChange:e=>{t({key:"username",value:e.target.value})}}))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(Re,{id:"webhookBasicAuthPassword",errorKey:"password",isShowingErrors:i,errors:a,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.basicAuthPassword",{defaultMessage:"Password (optional)"})},Object(f.jsx)(j.EuiFieldPassword,{name:"password",value:h||"","data-test-subj":"webhookPasswordInput",onChange:e=>{t({key:"password",value:e.target.value})}})))),Object(f.jsx)(j.EuiSpacer,{size:"s"}),Object(f.jsx)(Re,{id:"webhookBody",label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.bodyFieldLabel",{defaultMessage:"Body"}),errorKey:"body",isShowingErrors:i,fullWidth:!0,errors:a},Object(f.jsx)(at.CodeEditor,{languageId:"json",value:u||"","data-test-subj":"webhookBodyEditor",height:200,options:{lineNumbers:"off",tabSize:2,scrollBeyondLastLine:!1},"aria-label":z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.webhookAction.bodyCodeEditorAriaLabel",{defaultMessage:"Code editor"}),onChange:e=>{t({key:"body",value:e})}})))},[X.c.PAGERDUTY]:({errors:e,hasErrors:t,action:a,editAction:i,children:n})=>{const{description:o}=a;return Object(f.jsx)(s.Fragment,null,n,Object(f.jsx)(Re,{id:"pagerDutyDescription",errorKey:"description",fullWidth:!0,errors:e,isShowingErrors:t&&void 0!==o,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.pagerDutyAction.descriptionFieldLabel",{defaultMessage:"Description"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,name:"description",value:o||"","data-test-subj":"pagerdutyDescriptionInput",onChange:e=>{i({key:"description",value:e.target.value})},onBlur:()=>{o||i({key:"description",value:""})}})))},[X.c.JIRA]:({action:e,editAction:t,errors:a,hasErrors:i,children:n})=>{const{projectKey:o,issueType:r,summary:c}=e;return Object(f.jsx)(s.Fragment,null,n,Object(f.jsx)(Re,{id:"jiraProjectKey",errorKey:"projectKey",fullWidth:!0,errors:a,isShowingErrors:i&&void 0!==o,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.jiraAction.projectKeyFieldLabel",{defaultMessage:"Project key"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,name:"projectKey",value:o||"","data-test-subj":"jiraProjectKeyInput",onChange:e=>{t({key:"projectKey",value:e.target.value})},onBlur:()=>{o||t({key:"projectKey",value:""})}})),Object(f.jsx)(Re,{id:"jiraIssueType",errorKey:"issueType",fullWidth:!0,errors:a,isShowingErrors:i&&void 0!==r,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.jiraAction.issueTypeFieldLabel",{defaultMessage:"Issue type"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,value:r||"",name:"issueType","data-test-subj":"jiraIssueTypeInput",onChange:e=>{t({key:"issueType",value:e.target.value})},onBlur:()=>{r||t({key:"issueType",value:""})}})),Object(f.jsx)(Re,{id:"jiraSummary",errorKey:"summary",fullWidth:!0,errors:a,isShowingErrors:i&&void 0!==c,label:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.jiraAction.summaryFieldLabel",{defaultMessage:"Summary"})},Object(f.jsx)(j.EuiFieldText,{fullWidth:!0,value:c||"",name:"summary","data-test-subj":"jiraSummaryInput",onChange:e=>{t({key:"summary",value:e.target.value})},onBlur:()=>{c||t({key:"summary",value:""})}})))}};var ea={name:"1bs7qd7",styles:"&:hover{text-decoration:none;}"};const ta=({settings:e,actionErrors:t})=>{const{euiTheme:a}=Object(j.useEuiTheme)(),{links:{watchActionsConfigurationMap:i},toasts:n}=Le(),{watch:o,setWatchProperty:r}=Object(s.useContext)(Qe),{actions:c}=o,[l,u]=Object(s.useState)({}),[d,h]=Object(s.useState)(null);return c&&c.length>=1?c.map((g=>{const m=Qt[g.type],p=t[g.id],b=!!Object.keys(p).find((e=>p[e].length>=1));return Object(f.jsx)(j.EuiAccordion,{initialIsOpen:g.isNew||b,key:g.id,id:g.id,borders:"horizontal",buttonProps:{paddingSize:"m",css:ea},"data-test-subj":"watchActionAccordion",buttonContent:Object(f.jsx)(j.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiIcon,{type:g.iconClass,size:"m"})),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiTitle,{size:"s"},Object(f.jsx)("h6",null,g.typeName)))),extraAction:Object(f.jsx)(j.EuiButtonIcon,{iconType:"cross",color:"danger",css:Object(f.css)("opacity:0;&:focus,.euiAccordion:hover &{opacity:1;}",j.euiCanAnimate,"{transition:opacity ",a.animation.normal," ",a.animation.resistance,";}",""),"aria-label":z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:()=>{const e=c.filter((e=>e.id!==g.id));r("actions",e)}}),paddingSize:"l"},d&&d[g.id]&&Object(f.jsx)(s.Fragment,null,Object(f.jsx)(Ve,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.threshold.accordion.simulateResultsErrorTitle",defaultMessage:"Error testing action"}),error:d[g.id]}),Object(f.jsx)(j.EuiSpacer,{size:"s"})),Object(f.jsx)(j.EuiForm,null,Object(f.jsx)(m,{action:g,errors:p,hasErrors:b,editAction:e=>{const t=c.map((t=>{if(t.id===g.id){const t=action_Action.getActionTypes()[g.type],{key:a,value:s}=e;return new t({...g,[a]:s})}return t}));r("actions",t)}},e&&!1===e.actionTypes[g.type].enabled?Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiCallOut,{title:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.actions.actionConfigurationWarningTitleText",{defaultMessage:"Account may not be configured"}),color:"warning",iconType:"help"},Object(f.jsx)(j.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.threshold.actions.actionConfigurationWarningDescriptionText",defaultMessage:"To create this action, you must configure at least one {accountType} account. {docLink}",values:{accountType:g.typeName,docLink:Object(f.jsx)(j.EuiLink,{href:i[g.type],target:"_blank"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.threshold.actions.actionConfigurationWarningHelpLinkText",defaultMessage:"Learn more."}))}})))),Object(f.jsx)(j.EuiSpacer,null)):null),Object(f.jsx)(j.EuiButton,{type:"submit",isDisabled:b,isLoading:l[g.id],"data-test-subj":"simulateActionButton",onClick:async()=>{const e=o.actions.filter((e=>e.id===g.id)),t=new execute_details_ExecuteDetails({ignoreCondition:!0,recordExecution:!1,actionModes:{[g.id]:X.a.FORCE_EXECUTE}}),a=new threshold_watch_ThresholdWatch({...o,actions:e});u({[g.id]:!0}),h(null);const{data:s,error:i}=await ve(t,a);if(u({[g.id]:!1}),i)return h({[g.id]:i});const r=watch_history_item_WatchHistoryItem.fromUpstreamJson(s.watchHistoryItem).watchStatus.actionStatuses.find((e=>e.id===g.id));if(r&&!1===r.isLastExecutionSuccessful){const e=r.lastExecutionReason||g.simulateFailMessage;return n.addDanger(e)}return n.addSuccess(g.simulateMessage)}},g.simulatePrompt)))})):null},aa=({actionErrors:e})=>{const{watch:t}=Object(s.useContext)(Qe),{data:a,isLoading:i}=ge({path:`${je}/settings`,method:"get",deserializer:Me});return Object(f.jsx)("div",{"data-test-subj":"watchActionsPanel"},Object(f.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiTitle,{size:"s"},Object(f.jsx)("h2",null,z.i18n.translate("xpack.watcher.sections.watchEdit.actions.title",{defaultMessage:"Perform {watchActionsCount, plural, one{# action} other {# actions}} when condition is met",values:{watchActionsCount:t.actions.length}})))),Object(f.jsx)(j.EuiFlexItem,{className:"watcherThresholdWatchActionDropdownContainer"},Object(f.jsx)(Yt,{settings:a,isLoading:i}))),Object(f.jsx)(j.EuiSpacer,{size:"l"}),Object(f.jsx)(ta,{settings:a,actionErrors:e}))},sa=["aggField","termSize","termField","threshold0","threshold1","timeWindowSize"],ia=["aggType","aggField","termSize","termField","thresholdComparator","timeWindowSize","timeWindowUnit","triggerIntervalSize","triggerIntervalUnit","threshold","groupBy"],na=z.i18n.translate("xpack.watcher.thresholdWatchExpression.fixErrorInExpressionBelowValidationMessage",{defaultMessage:"Expression contains errors."}),oa={text:z.i18n.translate("xpack.watcher.sections.watchEdit.titlePanel.timeFieldOptionLabel",{defaultMessage:"Select a field"}),value:""},ra=e=>Object.entries(X.l).map((([t,a])=>({text:ne(a,e),value:a}))),ca=async e=>await(async e=>{const{fields:t}=await pe().post(`${je}/fields`,{body:JSON.stringify({indexes:e})});return t})(e),la=e=>{const t=[oa];return e.forEach((e=>{"date"===e.type&&t.push({text:e.name,value:e.name})})),t},ua=({pageTitle:e})=>{const{toasts:t}=Le(),[a,i]=Object(s.useState)([]),[n,o]=Object(s.useState)([]),[r,c]=Object(s.useState)([]),[l,u]=Object(s.useState)([oa]),[d,h]=Object(s.useState)(!1),[g,m]=Object(s.useState)(!1),[p,b]=Object(s.useState)(!1),[x,w]=Object(s.useState)(!1),[y,O]=Object(s.useState)(!1),[E,v]=Object(s.useState)(null),[k,M]=Object(s.useState)(!1),[T,S]=Object(s.useState)(!1),[_,A]=Object(s.useState)(!1),{watch:F,setWatchProperty:I}=Object(s.useContext)(Qe);Object(s.useEffect)((()=>{(async()=>{if(F.index&&F.index.length>0){const e=await ca(F.index),t=la(e);o(e),u(t),I("timeFields",t)}(async()=>{const{data:e}=await(async()=>he({path:`${je}/indices/index_patterns`,method:"get"}))();i(e)})()})()}),[]);const{errors:J}=F.validate(),C=!!Object.keys(J).find((e=>J[e].length>=1)),W=F.actions.reduce(((e,t)=>{const a=t.validate();return e[t.id]=a,e}),{}),D=!!Object.keys(W).find((e=>!!Object.keys(W[e]).find((t=>W[e][t].length>=1)))),N=!!Object.keys(J).find((e=>sa.includes(e)&&J[e].length>=1)),P=F.index&&F.index.length>0&&F.timeField,R=z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.andLabel",{defaultMessage:"AND"}),B={...F.upstreamJson,includeMetadata:!1};return Object(f.jsx)(j.EuiPageSection,{restrictWidth:!0,style:{width:"100%"}},Object(f.jsx)(j.EuiPageHeader,{pageTitle:Object(f.jsx)("span",{"data-test-subj":"pageTitle"},e),description:F.titleDescription,bottomBorder:!0}),Object(f.jsx)(j.EuiSpacer,{size:"l"}),Object(f.jsx)(j.EuiForm,{"data-test-subj":"thresholdWatchForm"},E&&Object(f.jsx)(s.Fragment,null,Object(f.jsx)(Ve,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.saveWatchErrorTitle",defaultMessage:"Error saving watch"}),error:E}),Object(f.jsx)(j.EuiSpacer,null)),Object(f.jsx)(Re,{id:"watchName",label:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.titlePanel.watchNameLabel",defaultMessage:"Name"}),errorKey:"name",isShowingErrors:C&&void 0!==F.name,errors:J},Object(f.jsx)(j.EuiFieldText,{name:"name","data-test-subj":"nameInput",value:F.name||"",onChange:e=>{I("name",e.target.value)},onBlur:()=>{F.name||I("name","")}})),Object(f.jsx)(j.EuiSpacer,null),Object(f.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(Re,{id:"indexSelectSearchBox",fullWidth:!0,label:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.titlePanel.indicesToQueryLabel",defaultMessage:"Indices to query"}),errorKey:"index",isShowingErrors:C&&void 0!==F.index,errors:J,helpText:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.titlePanel.howToBroadenSearchQueryDescription",defaultMessage:"Use * to broaden your query."})},Object(f.jsx)(j.EuiComboBox,{fullWidth:!0,async:!0,isLoading:T,noSuggestions:!r.length,options:r,"data-test-subj":"indicesComboBox",selectedOptions:(F.index||[]).map((e=>({label:e,value:e}))),onChange:async e=>{I("index",e.map((e=>e.value)));const t=e.map((e=>e.value));if(0===t.length)return u(la([])),I("timeFields",[]),void ia.forEach((e=>{I(e,null)}));const a=await ca(t),s=la(a);o(a),I("timeFields",s),u(s)},onSearchChange:async e=>{S(!0),c(await(async(e,t)=>{const a=[];if(!e)return a;const s=await(async e=>{e.startsWith("*")||(e=`*${e}`),e.endsWith("*")||(e=`${e}*`);const t=JSON.stringify({pattern:e}),{indices:a}=await pe().post(`${je}/indices`,{body:t});return a})(e),i=t.filter((t=>t.includes(e)));if(s.length||i.length){const e=L.a.uniq([...s,...i]);a.push({label:z.i18n.translate("xpack.watcher.sections.watchEdit.titlePanel.indicesAndIndexPatternsLabel",{defaultMessage:"Based on your indices and index patterns"}),options:e.map((e=>({label:e,value:e}))).sort(((e,t)=>String(e.label).localeCompare(t.label)))})}return a.push({label:z.i18n.translate("xpack.watcher.sections.watchEdit.titlePanel.chooseLabel",{defaultMessage:"Choose…"}),options:[{key:"UNIQUE_CHOOSE_KEY",value:e,label:e}]}),a})(e,a)),S(!1)},onBlur:()=>{F.index||I("index",[])}}))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(Re,{id:"timeField",fullWidth:!0,label:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.titlePanel.timeFieldLabel",defaultMessage:"Time field"}),errorKey:"timeField",isShowingErrors:C&&void 0!==F.timeField,errors:J},Object(f.jsx)(j.EuiSelect,{options:l,fullWidth:!0,name:"watchTimeField","data-test-subj":"watchTimeFieldSelect",value:F.timeField,onChange:e=>{I("timeField",e.target.value)},onBlur:()=>{void 0===F.timeField&&I("timeField","")}}))),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(Re,{id:"watchInterval",fullWidth:!0,label:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.titlePanel.watchIntervalLabel",defaultMessage:"Run watch every"}),errorKey:"triggerIntervalSize",isShowingErrors:C&&void 0!==F.triggerIntervalSize,errors:J},Object(f.jsx)(j.EuiFlexGroup,null,Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiFieldNumber,{fullWidth:!0,min:1,value:F.triggerIntervalSize,"data-test-subj":"triggerIntervalSizeInput",onChange:e=>{const{value:t}=e.target,a=""!==t?parseInt(t,10):t;I("triggerIntervalSize",a)},onBlur:e=>{void 0===F.triggerIntervalSize&&I("triggerIntervalSize","")}})),Object(f.jsx)(j.EuiFlexItem,null,Object(f.jsx)(j.EuiSelect,{fullWidth:!0,value:F.triggerIntervalUnit,"aria-label":z.i18n.translate("xpack.watcher.sections.watchEdit.titlePanel.durationAriaLabel",{defaultMessage:"Duration time unit"}),onChange:e=>{I("triggerIntervalUnit",e.target.value)},options:ra(F.triggerIntervalSize)})))))),Object(f.jsx)(j.EuiSpacer,null),P?Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiTitle,{size:"s"},Object(f.jsx)("h2",{"data-test-subj":"watchConditionTitle"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.watchConditionSectionTitle",defaultMessage:"Match the following condition"}))),Object(f.jsx)(j.EuiSpacer,{size:"m"}),Object(f.jsx)(j.EuiFlexGroup,{gutterSize:"s"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiPopover,{id:"aggTypePopover",button:Object(f.jsx)(j.EuiExpression,{description:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.whenLabel",{defaultMessage:"when"}),value:oe[F.aggType].text,isActive:y,onClick:()=>{O(!0)}}),isOpen:y,closePopover:()=>{O(!1)},ownFocus:!0,anchorPosition:"downLeft"},Object(f.jsx)("div",null,Object(f.jsx)(j.EuiPopoverTitle,null,z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.whenButtonLabel",{defaultMessage:"when"})),Object(f.jsx)(j.EuiSelect,{value:F.aggType,onChange:e=>{I("aggType",e.target.value),O(!1)},options:Object.values(oe).map((({text:e,value:t})=>({text:e,value:t})))})))),F.aggType&&oe[F.aggType].fieldRequired?Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiPopover,{id:"aggFieldPopover",button:Object(f.jsx)(j.EuiExpression,{description:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.ofLabel",{defaultMessage:"of"}),value:F.aggField||oa.text,isActive:d||!F.aggField,onClick:()=>{h(!0)},color:F.aggField?"success":"danger"}),isOpen:d,closePopover:()=>{h(!1)},anchorPosition:"downLeft"},Object(f.jsx)("div",null,Object(f.jsx)(j.EuiPopoverTitle,null,z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.ofButtonLabel",{defaultMessage:"of"})),Object(f.jsx)(j.EuiFlexGroup,null,Object(f.jsx)(j.EuiFlexItem,{grow:!1,className:"watcherThresholdAlertAggFieldContainer"},Object(f.jsx)(Re,{errorKey:"aggField",isShowingErrors:C&&void 0!==F.aggField,errors:J},Object(f.jsx)(j.EuiComboBox,{singleSelection:{asPlainText:!0},placeholder:oa.text,options:n.reduce(((e,t)=>(oe[F.aggType].validNormalizedTypes.includes(t.normalizedType)&&e.push({label:t.name}),e)),[]),selectedOptions:F.aggField?[{label:F.aggField}]:[],onChange:e=>{I("aggField",1===e.length?e[0].label:void 0),h(!1)}}))))))):null,Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiPopover,{id:"groupByPopover",button:Object(f.jsx)(j.EuiExpression,{description:`${re[F.groupBy].sizeRequired?z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.groupedOverLabel",{defaultMessage:"grouped over"}):z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.overLabel",{defaultMessage:"over"})}`,value:`${re[F.groupBy].text} ${re[F.groupBy].sizeRequired?`${F.termSize||""} ${F.termField?`'${F.termField}'`:""}`:""}`,isActive:g||"top"===F.groupBy&&!(F.termSize&&F.termField),onClick:()=>{m(!0)},color:"all"===F.groupBy||F.termSize&&F.termField?"success":"danger"}),isOpen:g,closePopover:()=>{m(!1)},ownFocus:!0,anchorPosition:"downLeft"},Object(f.jsx)("div",null,Object(f.jsx)(j.EuiPopoverTitle,null,z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.overButtonLabel",{defaultMessage:"over"})),Object(f.jsx)(j.EuiFlexGroup,null,Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiSelect,{value:F.groupBy,onChange:e=>{I("termSize",null),I("termField",null),I("groupBy",e.target.value)},options:Object.values(re).map((({text:e,value:t})=>({text:e,value:t})))})),re[F.groupBy].sizeRequired?Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(Re,{errorKey:"termSize",isShowingErrors:C,errors:J},Object(f.jsx)(j.EuiFieldNumber,{value:F.termSize,onChange:e=>{I("termSize",e.target.value)},min:1}))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(Re,{errorKey:"termField",isShowingErrors:C&&void 0!==F.termField,errors:J},Object(f.jsx)(j.EuiSelect,{value:F.termField||"",onChange:e=>{I("termField",e.target.value)},options:n.reduce(((e,t)=>(re[F.groupBy].validNormalizedTypes.includes(t.normalizedType)&&e.push({text:t.name,value:t.name}),e)),[oa])})))):null)))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiPopover,{id:"watchThresholdPopover",button:Object(f.jsx)(j.EuiExpression,{"data-test-subj":"watchThresholdButton",description:ce[F.thresholdComparator].text,value:F.threshold.slice(0,ce[F.thresholdComparator].requiredValues).join(` ${R} `),isActive:Boolean(p||J.threshold0.length||J.threshold1&&J.threshold1.length),onClick:()=>{b(!0)},color:J.threshold0.length||J.threshold1&&J.threshold1.length?"danger":"success"}),isOpen:p,closePopover:()=>{b(!1)},ownFocus:!0,anchorPosition:"downLeft"},Object(f.jsx)("div",null,Object(f.jsx)(j.EuiPopoverTitle,null,ce[F.thresholdComparator].text),Object(f.jsx)(j.EuiFlexGroup,null,Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiSelect,{value:F.thresholdComparator,onChange:e=>{I("thresholdComparator",e.target.value)},options:Object.values(ce).map((({text:e,value:t})=>({text:e,value:t})))})),Array.from(Array(ce[F.thresholdComparator].requiredValues)).map(((e,t)=>Object(f.jsx)(s.Fragment,{key:`threshold${t}`},t>0?Object(f.jsx)(j.EuiFlexItem,{grow:!1,className:"watcherThresholdWatchInBetweenComparatorText"},Object(f.jsx)(j.EuiText,null,R),C&&Object(f.jsx)(j.EuiSpacer,null)):null,Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(Re,{errorKey:`threshold${t}`,isShowingErrors:C,errors:J},Object(f.jsx)(j.EuiFieldNumber,{"data-test-subj":"watchThresholdInput",value:null==F.threshold[t]?"":F.threshold[t],min:0,step:.1,onChange:e=>{const{value:a}=e.target,s=""!==a?parseFloat(a):a,i=[...F.threshold];i[t]=s,I("threshold",i)}})))))))))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiPopover,{id:"watchDurationPopover",button:Object(f.jsx)(j.EuiExpression,{description:z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.forTheLastLabel",{defaultMessage:"for the last"}),value:`${F.timeWindowSize} ${ne(F.timeWindowUnit,parseInt(F.timeWindowSize,10).toString())}`,isActive:x||!F.timeWindowSize,onClick:()=>{w(!0)},color:F.timeWindowSize?"success":"danger"}),isOpen:x,closePopover:()=>{w(!1)},ownFocus:!0,anchorPosition:"downLeft"},Object(f.jsx)("div",null,Object(f.jsx)(j.EuiPopoverTitle,null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.threshold.forTheLastButtonLabel",defaultMessage:"For the last"})),Object(f.jsx)(j.EuiFlexGroup,null,Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(Re,{errorKey:"timeWindowSize",isShowingErrors:C,errors:J},Object(f.jsx)(j.EuiFieldNumber,{min:1,value:F.timeWindowSize||"",onChange:e=>{const{value:t}=e.target,a=""!==t?parseInt(t,10):t;I("timeWindowSize",a)}}))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiSelect,{value:F.timeWindowUnit,onChange:e=>{I("timeWindowUnit",e.target.value)},options:ra(F.timeWindowSize)}))))))),N?Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiSpacer,{size:"m"}),Object(f.jsx)(j.EuiText,{color:"danger",size:"s"},na),Object(f.jsx)(j.EuiSpacer,{size:"m"})):null,C?null:Object(f.jsx)(s.Fragment,null,Object(f.jsx)($t,null),Object(f.jsx)(aa,{actionErrors:W})),Object(f.jsx)(j.EuiSpacer,null)):null,Object(f.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiButton,{fill:!0,color:"success","data-test-subj":"saveWatchButton",type:"submit",iconType:"check",disabled:C||D,isLoading:k,onClick:async()=>{M(!0);const e=await Mt(F,t);if(e&&e.error)return M(!1),v(e.error)}},F.isNew?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.threshold.createButtonLabel",defaultMessage:"Create alert"}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.threshold.saveButtonLabel",defaultMessage:"Save alert"}))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiButtonEmpty,{onClick:()=>Se()},z.i18n.translate("xpack.watcher.sections.watchEdit.threshold.cancelButtonLabel",{defaultMessage:"Cancel"}))))),Object(f.jsx)(j.EuiFlexItem,{grow:!1},Object(f.jsx)(j.EuiButtonEmpty,{onClick:()=>A(!_)},_?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.hideRequestButtonLabel",defaultMessage:"Hide request"}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.json.showRequestButtonLabel",defaultMessage:"Show request"}))))),_?Object(f.jsx)(request_flyout_RequestFlyout,{id:F.id,payload:Ot(B),close:()=>A(!1)}):null)},da=(e,t)=>{const{command:a,payload:s}=t,{watch:i}=e;switch(a){case"setWatch":return{...e,watch:s};case"setProperty":const{property:t,value:a}=s;return Object(J.isEqual)(i[t],a)?e:{...e,watch:new(watch_Watch.getWatchTypes()[i.type])({...i,[t]:a})};case"addAction":const{type:n,defaults:o}=s,r=new(watch_Watch.getWatchTypes()[i.type])(i);return r.createAction(n,o),{...e,watch:r};case"setError":return{...e,loadError:s}}},ha=({match:{params:{id:e,type:t}}})=>{const{setBreadcrumbs:a}=Le(),[{watch:i,loadError:n},o]=Object(s.useReducer)(da,{watch:null});Object(s.useEffect)((()=>{(async()=>{if(e)try{const t=await(async e=>{const{watch:t}=await pe().get(`${je}/watch/${e}`);return watch_Watch.fromUpstreamJson(t)})(e);o({command:"setWatch",payload:t})}catch(e){o({command:"setError",payload:e.body})}else if(t){const e=watch_Watch.getWatchTypes()[t];e&&o({command:"setWatch",payload:new e})}})()}),[e,t]),Object(s.useEffect)((()=>{a([U,e?V:q])}),[e,a]);const c=De(n);if(c)return Object(f.jsx)(Ne,{errorCode:c,id:e});if(n)return Object(f.jsx)(r.PageError,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.errorTitle",defaultMessage:"Error loading watch"}),error:n});if(!i)return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,null,Object(f.jsx)(qe,null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchEdit.loadingWatchDescription",defaultMessage:"Loading watch…"})));const l=(e=>{if(e.isNew){const t=e.typeName.toLowerCase();return z.i18n.translate("xpack.watcher.sections.watchEdit.json.titlePanel.createNewTypeOfWatchTitle",{defaultMessage:"Create {typeName}",values:{typeName:t}})}return z.i18n.translate("xpack.watcher.sections.watchEdit.json.titlePanel.editWatchTitle",{defaultMessage:"Edit {watchName}",values:{watchName:e.name?e.name:e.id}})})(i);let u=null;switch(i.type){case X.n.THRESHOLD:u=ua;break;case X.n.MONITORING:u=Rt;break;case X.n.JSON:default:u=Pt}return Object(f.jsx)(Qe.Provider,{value:{watch:i,setWatchProperty:(e,t)=>{o({command:"setProperty",payload:{property:e,value:t}})},addAction:e=>{o({command:"addAction",payload:e})}}},Object(f.jsx)(u,{pageTitle:l}))},ga=Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchList.watchTable.stateHeader.tooltipText",{defaultMessage:"Active, inactive, or error."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchList.watchTable.stateHeader",{defaultMessage:"State"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),ma=Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchList.watchTable.lastFiredHeader.tooltipText",{defaultMessage:"The last time the condition was met and action taken."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchList.watchTable.lastFiredHeader",{defaultMessage:"Condition last met"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),pa=Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchList.watchTable.lastTriggeredHeader.tooltipText",{defaultMessage:"The last time the condition was checked."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchList.watchTable.lastTriggeredHeader",{defaultMessage:"Last checked"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),ja=Object(f.jsx)(j.EuiToolTip,{content:z.i18n.translate("xpack.watcher.sections.watchList.watchTable.commentHeader.tooltipText",{defaultMessage:"Whether any actions have been acknowledged, throttled, or failed to execute."})},Object(f.jsx)("span",null,z.i18n.translate("xpack.watcher.sections.watchList.watchTable.commentHeader",{defaultMessage:"Comment"})," ",Object(f.jsx)(j.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),ba=()=>{const{setBreadcrumbs:e,history:t,links:{watcherGettingStartedUrl:a}}=Le(),[n,c]=Object(s.useState)(""),[u,d]=Object(s.useState)(null),[h,g]=Object(s.useState)([]),[m,p]=Object(s.useState)([]),[b,x]=Object(s.useState)([]),[w,y]=Object(s.useState)({pageIndex:0,pageSize:X.g.initialPageSize});Object(s.useEffect)((()=>{e([U])}),[e]);const{isLoading:O,data:E,error:v}=(k=X.i.WATCH_LIST,ge({path:`${je}/watches`,method:"get",pollIntervalMs:k,deserializer:be}));var k;const[M,T]=Object(s.useState)(!1),S=Object(s.useMemo)((()=>E?E.filter((e=>!b.includes(e.id))):void 0),[E,b]),_=Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.subhead",defaultMessage:"Watch for changes or anomalies in your data and take action if needed."}),A=Object(f.jsx)(j.EuiPopover,{id:"createWatchPanel",button:Object(f.jsx)(j.EuiButton,{fill:!0,"data-test-subj":"createWatchButton",iconType:"arrowDown",iconSide:"right",onClick:()=>T(!M)},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.createWatchButtonLabel",defaultMessage:"Create"})),isOpen:M,closePopover:()=>T(!1),panelPaddingSize:"none",anchorPosition:"downCenter"},Object(f.jsx)(j.EuiContextMenuPanel,{items:[X.n.THRESHOLD,X.n.JSON].map((e=>Object(f.jsx)(j.EuiContextMenuItem,{key:e,"data-test-subj":`${e}WatchCreateLink`,onClick:()=>{T(!1),(e===X.n.THRESHOLD?_e:Ae)()}},e===X.n.THRESHOLD?Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiText,{size:"m"},Object(f.jsx)("span",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.createThresholdAlertButtonLabel",defaultMessage:"Create threshold alert"}))),Object(f.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(f.jsx)("span",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.createThresholdAlertButtonTooltip",defaultMessage:"Send an alert on a specified condition."})))):Object(f.jsx)(s.Fragment,null,Object(f.jsx)(j.EuiText,{size:"m"},Object(f.jsx)("span",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.createAdvancedWatchButtonLabel",defaultMessage:"Create advanced watch"}))),Object(f.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(f.jsx)("span",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.createAdvancedWatchTooltip",defaultMessage:"Set up a custom watch in JSON."})))))))}));if(O)return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,null,Object(f.jsx)(qe,null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.loadingWatchesDescription",defaultMessage:"Loading watches…"})));const F=De(v);if(F)return Object(f.jsx)(Ne,{errorCode:F});if(v)return Object(f.jsx)(r.PageError,{title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.errorTitle",defaultMessage:"Error loading watches"}),error:v});if(S&&0===S.length){const e=Object(f.jsx)(j.EuiText,{color:"subdued"},Object(f.jsx)("p",null,_," ",Object(f.jsx)(j.EuiLink,{href:a,target:"_blank"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.watcherLearnMoreLinkText",defaultMessage:"Learn more."}))));return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:"managementApp",title:Object(f.jsx)("h1",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.emptyPromptTitle",defaultMessage:"You don’t have any watches yet"})),body:e,actions:A,"data-test-subj":"emptyPrompt"})}let I;if(S){const e=[{field:"id",name:z.i18n.translate("xpack.watcher.sections.watchList.watchTable.idHeader",{defaultMessage:"ID"}),sortable:!0,truncateText:!1,render:e=>Object(f.jsx)(j.EuiLink,l()({"data-test-subj":`watchIdColumn-${e}`},Object(o.reactRouterNavigate)(t,`/watches/watch/${e}/status`)),e)},{field:"name",name:z.i18n.translate("xpack.watcher.sections.watchList.watchTable.nameHeader",{defaultMessage:"Name"}),render:(e,t)=>Object(f.jsx)("span",{"data-test-subj":`watchNameColumn-${t.id}`},e),sortable:!0,truncateText:!1},{field:"watchStatus.state",name:ga,sortable:!0,width:"130px",render:e=>Object(f.jsx)(ze,{state:e})},{field:"watchStatus.lastMetCondition",name:ma,sortable:!0,truncateText:!0,width:"160px",render:e=>e?e.fromNow():e},{field:"watchStatus.lastChecked",name:pa,sortable:!0,truncateText:!0,width:"160px",render:e=>e?e.fromNow():e},{field:"watchStatus.comment",name:ja,sortable:!0,truncateText:!0},{name:z.i18n.translate("xpack.watcher.sections.watchList.watchTable.actionHeader",{defaultMessage:"Actions"}),width:"75px",actions:[{render:e=>{const a=z.i18n.translate("xpack.watcher.sections.watchList.watchTable.actionEditTooltipLabel",{defaultMessage:"Edit"});return Object(f.jsx)(j.EuiToolTip,{content:a,delay:"long"},Object(f.jsx)(j.EuiButtonIcon,l()({isDisabled:e.isSystemWatch,"aria-label":z.i18n.translate("xpack.watcher.sections.watchList.watchTable.actionEditAriaLabel",{defaultMessage:"Edit watch ''{name}''",values:{name:e.name}}),iconType:"pencil",color:"primary"},Object(o.reactRouterNavigate)(t,`/watches/watch/${e.id}/edit`),{"data-test-subj":"editWatchButton"})))}},{render:e=>{const t=z.i18n.translate("xpack.watcher.sections.watchList.watchTable.actionDeleteTooltipLabel",{defaultMessage:"Delete"});return Object(f.jsx)(j.EuiToolTip,{content:t,delay:"long"},Object(f.jsx)(j.EuiButtonIcon,{isDisabled:e.isSystemWatch,"aria-label":z.i18n.translate("xpack.watcher.sections.watchList.watchTable.actionDeleteAriaLabel",{defaultMessage:"Delete watch ''{name}''",values:{name:e.name}}),iconType:"trash",color:"danger",onClick:()=>{p([e.id])},"data-test-subj":"deleteWatchButton"}))}}]}],a={onSelectionChange:g,selectable:e=>!e.isSystemWatch,selectableMessage:e=>e?"":z.i18n.translate("xpack.watcher.sections.watchList.watchTable.disabledWatchTooltipText",{defaultMessage:"This watch is read-only"})},s={onChange:({queryText:e,error:t})=>{t?d(t.message):(c(e),d(null))},query:n,box:{incremental:!0},toolsLeft:h.length>0?Object(f.jsx)(j.EuiButton,{"data-test-subj":"btnDeleteWatches",onClick:()=>{p(h.map((e=>e.id)))},color:"danger"},h.length>1?Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.deleteMultipleWatchesButtonLabel",defaultMessage:"Delete watches"}):Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.deleteSingleWatchButtonLabel",defaultMessage:"Delete watch"})):void 0,toolsRight:A};I=Object(f.jsx)("div",{"data-test-subj":"watchesTableContainer"},Object(f.jsx)(j.EuiInMemoryTable,{onTableChange:({page:{index:e,size:t}})=>y({pageIndex:e,pageSize:t}),items:S,itemId:"id",columns:e,search:s,pagination:{...X.g,pageIndex:w.pageIndex,pageSize:w.pageSize},sorting:{sort:{field:"name",direction:"asc"}},selection:a,childrenBetween:u&&Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(j.EuiCallOut,{"data-test-subj":"watcherListSearchError",iconType:"warning",color:"danger",title:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.watchTable.errorOnSearch",defaultMessage:"Invalid search: {queryError}",values:{queryError:u}})}),Object(f.jsx)(j.EuiSpacer,null)),message:Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.watchTable.noWatchesMessage",defaultMessage:"No watches to show"}),rowProps:()=>({"data-test-subj":"row"}),cellProps:()=>({"data-test-subj":"cell"}),"data-test-subj":"watchesTable"}))}return Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(j.EuiPageHeader,{pageTitle:Object(f.jsx)("span",{"data-test-subj":"appTitle"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.header",defaultMessage:"Watcher"})),bottomBorder:!0,rightSideItems:[Object(f.jsx)(j.EuiButtonEmpty,{href:a,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.sections.watchList.watcherGettingStartedDocsLinkText",defaultMessage:"Watcher docs"}))],description:_}),Object(f.jsx)(Pe,{callback:e=>{e&&x([...b,...m]),p([])},watchesToDelete:m}),Object(f.jsx)(j.EuiSpacer,{size:"l"}),I)},xa=({message:e,licenseManagementLocator:t})=>{const a=null==t?void 0:t.useUrl({page:"dashboard"}),s=a?Object(f.jsx)(j.EuiLink,{href:a},Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.app.licenseErrorLinkText",defaultMessage:"Manage your license"})):void 0,n=a?Object(f.jsx)("p",null,e):Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)("p",null,e),Object(f.jsx)("p",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.app.licenseErrorBody",defaultMessage:"Contact your administrator to change your license."})));return Object(f.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:"warning",color:"danger",title:Object(f.jsx)("h1",null,Object(f.jsx)(H.FormattedMessage,{id:"xpack.watcher.app.licenseErrorTitle",defaultMessage:"License error"})),body:n,actions:[s]})},wa=Object(A.withRouter)((({children:e,history:t})=>(Te={history:t},e))),fa=e=>{const[{valid:t,message:a},i]=Object(s.useState)({valid:!0});return Object(s.useEffect)((()=>{const t=e.licenseStatus$.subscribe(i);return()=>t.unsubscribe()}),[e.licenseStatus$]),t?Object(f.jsx)(I,{history:e.history},Object(f.jsx)(wa,null,Object(f.jsx)(Je,{value:e},Object(f.jsx)(ya,null)))):Object(f.jsx)(xa,{licenseManagementLocator:e.licenseManagementLocator,message:a})},ya=()=>Object(f.jsx)(B,null,Object(f.jsx)(P,{exact:!0,path:"/watches",component:ba}),Object(f.jsx)(P,{exact:!0,path:"/watches/watch/:id/status",component:Ze}),Object(f.jsx)(P,{exact:!0,path:"/watches/watch/:id/edit",component:ha}),Object(f.jsx)(P,{exact:!0,path:"/watches/new-watch/:type(json|threshold)",component:ha}),Object(f.jsx)(A.Redirect,{exact:!0,from:"/",to:"/watches"}),Object(f.jsx)(A.Redirect,{exact:!0,from:"",to:"/watches"})),Oa=e=>{const{element:t,...a}=e;var s;return s=a.http,me=s,Object(n.render)(Object(f.jsx)(_,a,Object(f.jsx)(o.KibanaContextProvider,{services:{uiSettings:e.uiSettings,settings:e.settings,theme:e.theme}},Object(f.jsx)(fa,a))),t),()=>{Object(n.unmountComponentAtNode)(t)}}}}]);