/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.watcher_bundle_jsonpfunction=window.watcher_bundle_jsonpfunction||[]).push([[2],{49:function(t,r,n){"use strict";n.r(r),n.d(r,"TimeBuckets",(function(){return E}));var e=n(18),a=n.n(e),i=n(24),o=n.n(i),u=n(36),s=n(37);const l=[{bound:1/0,interval:Number(o.a.duration(1,"year"))},{bound:Number(o.a.duration(1,"year")),interval:Number(o.a.duration(1,"month"))},{bound:Number(o.a.duration(3,"week")),interval:Number(o.a.duration(1,"week"))},{bound:Number(o.a.duration(1,"week")),interval:Number(o.a.duration(1,"d"))},{bound:Number(o.a.duration(24,"hour")),interval:Number(o.a.duration(12,"hour"))},{bound:Number(o.a.duration(6,"hour")),interval:Number(o.a.duration(3,"hour"))},{bound:Number(o.a.duration(2,"hour")),interval:Number(o.a.duration(1,"hour"))},{bound:Number(o.a.duration(45,"minute")),interval:Number(o.a.duration(30,"minute"))},{bound:Number(o.a.duration(20,"minute")),interval:Number(o.a.duration(10,"minute"))},{bound:Number(o.a.duration(9,"minute")),interval:Number(o.a.duration(5,"minute"))},{bound:Number(o.a.duration(3,"minute")),interval:Number(o.a.duration(1,"minute"))},{bound:Number(o.a.duration(45,"second")),interval:Number(o.a.duration(30,"second"))},{bound:Number(o.a.duration(15,"second")),interval:Number(o.a.duration(10,"second"))},{bound:Number(o.a.duration(7.5,"second")),interval:Number(o.a.duration(5,"second"))},{bound:Number(o.a.duration(5,"second")),interval:Number(o.a.duration(1,"second"))},{bound:Number(o.a.duration(500,"ms")),interval:Number(o.a.duration(100,"ms"))}];function d(t,r){const n=r/t;return isFinite(n)?n:NaN}function c(t){const r=isNaN(t)?0:Math.max(Math.floor(t),1);return o.a.duration(r)}var v=n(27),_=n.n(v),m=n(0);class invalid_es_calendar_interval_error_InvalidEsCalendarIntervalError extends Error{constructor(t,r,n,e){super(m.i18n.translate("xpack.watcher.data.parseEsInterval.invalidEsCalendarIntervalErrorMessage",{defaultMessage:"Invalid calendar interval: {interval}, value must be 1",values:{interval:t}})),this.interval=t,this.value=r,this.unit=n,this.type=e,this.name="InvalidEsCalendarIntervalError",this.value=r,this.unit=n,this.type=e,Error.captureStackTrace&&Error.captureStackTrace(this,invalid_es_calendar_interval_error_InvalidEsCalendarIntervalError),Object.setPrototypeOf(this,invalid_es_calendar_interval_error_InvalidEsCalendarIntervalError.prototype)}}class invalid_es_interval_format_error_InvalidEsIntervalFormatError extends Error{constructor(t){super(m.i18n.translate("xpack.watcher.data.parseEsInterval.invalidEsIntervalFormatErrorMessage",{defaultMessage:"Invalid interval format: {interval}",values:{interval:t}})),this.interval=t,this.name="InvalidEsIntervalFormatError",Error.captureStackTrace&&Error.captureStackTrace(this,invalid_es_interval_format_error_InvalidEsIntervalFormatError),Object.setPrototypeOf(this,invalid_es_interval_format_error_InvalidEsIntervalFormatError.prototype)}}const h=new RegExp("^([1-9][0-9]*)\\s*("+_.a.units.join("|")+")$");const b=_.a.unitsDesc,f=b.indexOf("M"),{parseInterval:p}=u.search.aggs;function I(t){return t&&"isValid"in t&&t.isValid()}function E(t,r){return this.data=r,this.getConfig=(...r)=>t.get(...r),E.__cached__(this)}E.prototype.setBounds=function(t){if(!t)return this.clearBounds();let r;r=a.a.isPlainObject(t)?[t.min,t.max]:Array.isArray(t)?t:[];const n=a()(r).map(a.a.ary(o.a,1)).sortBy(Number);if(2!==n.size()||!n.every(I))throw this.clearBounds(),new Error("invalid bounds set: "+t);if(this._lb=n.shift(),this._ub=n.pop(),this.getDuration().asSeconds()<0)throw new TypeError("Intervals must be positive")},E.prototype.clearBounds=function(){this._lb=this._ub=null},E.prototype.hasBounds=function(){return I(this._ub)&&I(this._lb)},E.prototype.getBounds=function(){if(this.hasBounds())return{min:this._lb,max:this._ub}},E.prototype.getDuration=function(){if(this.hasBounds())return o.a.duration(this._ub-this._lb,"ms")},E.prototype.setInterval=function(t){this.originalInterval=t;let r=t;if(a.a.isObject(t)&&(r=t.val),r&&"auto"!==r){if(a.a.isString(r)&&(t=r,r=p(r),0==+r&&(r=null)),!o.a.isDuration(r))throw new TypeError('"'+t+'" is not a valid interval.');this._i=r}else this._i="auto"},E.prototype.getInterval=function(t=!0){const r=this,n=r.getDuration(),e=function(){const t=r._i;return o.a.isDuration(t)?t:function(t,r){const n=d(t,r),e=l.findIndex((({bound:t})=>Number(t)<=n));if(-1!==e){const t=l[e-1].interval;return o.a.duration(t)}return c(n)}(r.getConfig(u.UI_SETTINGS.HISTOGRAM_BAR_TARGET),Number(n))}();return i(t?function(t){if(!r.hasBounds())return t;const e=r.getConfig(u.UI_SETTINGS.HISTOGRAM_MAX_BARS);let s;return n/t>e?(s=function(t,r){const n=d(t,r);for(const{interval:t}of l)if(t<=n)return o.a.duration(t);return c(n)}(e,Number(n)),+s==+t?t:(i(t),a.a.assign(s,{preScaled:t,scale:t/s,scaled:!0}))):t}(e):e);function i(e){const a=t?function(t){for(let r=0;r<b.length;r++){const n=b[r],e=t.as(n);if(e>=1&&Math.floor(e)===e){if(r<=f&&1!==e)continue;return{value:e,unit:n,expression:e+n}}}const r=t.as("ms");return{value:r,unit:"ms",expression:r+"ms"}}(e):function(t){const{value:r,unit:n}=function(t){const r=String(t).trim().match(h);if(!r)throw new invalid_es_interval_format_error_InvalidEsIntervalFormatError(t);const n=parseFloat(r[1]),e=r[2],a=_.a.unitsMap[e].type;if("calendar"===a&&1!==n)throw new invalid_es_calendar_interval_error_InvalidEsCalendarIntervalError(t,n,e,a);return{value:n,unit:e,type:"mixed"===a&&1===n||"calendar"===a?"calendar":"fixed"}}(t);return{value:r,unit:n,expression:t}}(r.originalInterval);e.esValue=a.value,e.esUnit=a.unit,e.expression=a.expression,e.overflow=n>e&&o.a.duration(e-n);const i=o.a.normalizeUnits(a.unit);return 1===a.value?e.description=i:e.description=a.value+" "+i+"s",e}},E.prototype.getScaledDateFormat=function(){const t=this.getInterval(),r=this.getConfig("dateFormat:scaled");for(let n=r.length-1;n>=0;n--){const e=r[n];if(!e[0]||t>=o.a.duration(e[0]))return e[1]}return this.getConfig("dateFormat")},E.prototype.getScaledDateFormatter=function(){return new(this.data.fieldFormats.getType(s.FIELD_FORMAT_IDS.DATE))({pattern:this.getScaledDateFormat()},this.getConfig.bind(this))},E.__cached__=function(t){let r={};const n=l(o.a.isMoment),e=l(o.a.isDuration),i={__cached__:{value:t}},u={setBounds:"bounds",clearBounds:"bounds",setInterval:"interval"},s={bounds:{setup:function(){return[t._lb,t._ub]},changes:function(r){return!n(r[0],t._lb)||!n(r[1],t._ub)}},interval:{setup:function(){return t._i},changes:function(t){return!e(t,this._i)}}};function l(t){return function(r,n){return r===n||t(r)===t(n)&&+r==+n}}return a.a.forOwn(E.prototype,(function(n,e){"_"!==e[0]&&(u.hasOwnProperty(e)?i[e]=function(n){const e=s[u[n]],a=e.setup,i=e.changes,o=t[n];return{value:function(){const n=a.call(t),e=o.apply(t,arguments);return i.call(t,n)&&(r={}),e}}}(e):i[e]=function(n){return{value:function(...e){return r.hasOwnProperty(n)?r[n]:r[n]=t[n](...e)}}}(e))})),Object.create(t,i)}}}]);