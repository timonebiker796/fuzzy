(window.filesManagement_bundle_jsonpfunction=window.filesManagement_bundle_jsonpfunction||[]).push([[2],{87:function(e,t,a){"use strict";a.r(t),a.d(t,"ContentEditorFlyoutContentContainer",(function(){return h}));var n=a(4),s=a.n(n),i=a(0),l=a(7),r=a(6),o=a(5);const c=({warningMessages:e})=>{const t=Object(n.useMemo)((()=>({title:i.i18n.translate("contentManagement.contentEditor.flyoutWarningsTitle",{defaultMessage:"Proceed with caution!"})})),[]);return null!=e&&e.length?Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiCallOut,{title:t.title,color:"warning"},Object(o.jsx)("ul",null,e.map((e=>Object(o.jsx)("li",null,e))))),Object(o.jsx)(r.EuiSpacer,null)):null},u=e=>{var t;return!Boolean(null===(t=e.errors)||void 0===t?void 0:t.length)},d=({form:e,tagsReferences:t,TagList:a,TagSelector:n,isReadonly:l,readonlyReason:d,children:j})=>{const{title:g,setTitle:b,description:m,setDescription:O,tags:x,setTags:y,isSubmitted:p,isValid:v,getErrors:E,getWarnings:f}=e;return Object(o.jsx)(r.EuiForm,{isInvalid:p&&!v,error:E(),"data-test-subj":"metadataForm"},Object(o.jsx)(c,{warningMessages:f()}),Object(o.jsx)(r.EuiFormRow,{label:i.i18n.translate("contentManagement.contentEditor.metadataForm.nameInputLabel",{defaultMessage:"Name"}),error:g.errors,isInvalid:!u(g),fullWidth:!0},Object(o.jsx)(r.EuiToolTip,{position:"top",content:l?d:void 0,display:"block"},Object(o.jsx)(r.EuiFieldText,{isInvalid:!u(g),value:g.value,onChange:e=>{b(e.target.value)},fullWidth:!0,"data-test-subj":"nameInput",readOnly:l}))),Object(o.jsx)(r.EuiSpacer,null),Object(o.jsx)(r.EuiFormRow,{label:i.i18n.translate("contentManagement.contentEditor.metadataForm.descriptionInputLabel",{defaultMessage:"Description"}),error:m.errors,isInvalid:!u(m),fullWidth:!0},Object(o.jsx)(r.EuiToolTip,{position:"top",content:l?d:void 0,display:"block"},Object(o.jsx)(r.EuiTextArea,{isInvalid:!u(m),value:m.value,onChange:e=>{O(e.target.value)},fullWidth:!0,"data-test-subj":"descriptionInput",readOnly:l}))),a&&l&&t.length>0&&Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiSpacer,null),Object(o.jsx)(r.EuiFormRow,{label:i.i18n.translate("contentManagement.contentEditor.metadataForm.tagsLabel",{defaultMessage:"Tags"}),fullWidth:!0},Object(o.jsx)(a,{references:t}))),n&&!l&&Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiSpacer,null),Object(o.jsx)(n,{initialSelection:x.value,onTagsSelected:y,fullWidth:!0})),j&&Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiSpacer,null),j))},j={title:[{type:"error",fn:e=>{if(!e||!e.trim())return i.i18n.translate("contentManagement.contentEditor.metadataForm.nameIsEmptyError",{defaultMessage:"A name is required."})}}]};function g(e,t){var a;return t&&["title","description"].includes(e)&&null!==(a=t[e])&&void 0!==a?a:[]}var b=a(25),m=a(28),O={name:"1vk0k50",styles:"flex-basis:50%;min-width:0"},x={name:"1vk0k50",styles:"flex-basis:50%;min-width:0"};const y=({item:e})=>{const t=Boolean(e.updatedAt&&e.updatedAt!==e.createdAt),a=Object(o.jsx)(l.FormattedMessage,{id:"contentManagement.contentEditor.activity.unkownUserLabel",defaultMessage:"Unknown"}),n=Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(b.a,null)," ",Object(o.jsx)(l.FormattedMessage,{id:"contentManagement.contentEditor.activity.managedUserLabel",defaultMessage:"System"}));return Object(o.jsx)(r.EuiFormRow,{label:Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(l.FormattedMessage,{id:"contentManagement.contentEditor.metadataForm.activityLabel",defaultMessage:"Activity"})," ",Object(o.jsx)(r.EuiIconTip,{type:"iInCircle",iconProps:{style:{verticalAlign:"bottom"}},content:Object(o.jsx)(l.FormattedMessage,{id:"contentManagement.contentEditor.activity.activityLabelHelpText",defaultMessage:"Activity data is auto-generated and cannot be updated."})})),fullWidth:!0,"data-test-subj":"activityView"},Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(o.jsx)(r.EuiFlexItem,{grow:1,css:O},Object(o.jsx)(v,{what:i.i18n.translate("contentManagement.contentEditor.activity.createdByLabelText",{defaultMessage:"Created by"}),who:e.createdBy?Object(o.jsx)(E,{uid:e.createdBy}):e.managed?Object(o.jsx)(s.a.Fragment,null,n):Object(o.jsx)(s.a.Fragment,null,a,Object(o.jsx)(b.b,null)),when:e.createdAt,"data-test-subj":"createdByCard"})),Object(o.jsx)(r.EuiFlexItem,{grow:1,css:x},t&&Object(o.jsx)(v,{what:i.i18n.translate("contentManagement.contentEditor.activity.lastUpdatedByLabelText",{defaultMessage:"Last updated by"}),who:e.updatedBy?Object(o.jsx)(E,{uid:e.updatedBy}):e.managed?Object(o.jsx)(s.a.Fragment,null,n):Object(o.jsx)(s.a.Fragment,null,a,Object(o.jsx)(b.c,null)),when:e.updatedAt,"data-test-subj":"updatedByCard"})))))},p=new Intl.DateTimeFormat(i.i18n.getLocale(),{dateStyle:"long",timeStyle:"short"}),v=({what:e,when:t,who:a,"data-test-subj":n})=>Object(o.jsx)(r.EuiPanel,{hasBorder:!0,paddingSize:"s","data-test-subj":n},Object(o.jsx)(r.EuiText,{size:"s"},Object(o.jsx)("b",null,e)),Object(o.jsx)(r.EuiSpacer,{size:"xs"}),Object(o.jsx)(r.EuiText,{size:"s",className:"eui-textTruncate"},a),t&&Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiSpacer,{size:"xs"}),Object(o.jsx)(r.EuiText,{title:t,color:"subdued",size:"s"},Object(o.jsx)(l.FormattedMessage,{id:"contentManagement.contentEditor.activity.lastUpdatedByDateTime",defaultMessage:"on {dateTime}",values:{dateTime:p.format(new Date(t))}})))),E=({uid:e})=>{const t=Object(b.g)(e);return t.data?Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(b.d,{uid:e})," ",Object(m.e)(t.data.user)):null},f=({item:e,entityName:t,isReadonly:a=!0,readonlyReason:c,services:{TagSelector:u,TagList:b,notifyError:m},onSave:O,onCancel:x,customValidators:p,showActivityView:v})=>{const{euiTheme:E}=Object(r.useEuiTheme)(),[f,h]=Object(n.useState)(!1),[M,w]=Object(n.useState)(!1),F=Object(n.useMemo)((()=>(({entityName:e})=>({saveButtonLabel:i.i18n.translate("contentManagement.contentEditor.saveButtonLabel",{defaultMessage:"Update {entityName}",values:{entityName:e}}),cancelButtonLabel:i.i18n.translate("contentManagement.contentEditor.cancelButtonLabel",{defaultMessage:"Cancel"})}))({entityName:t})),[t]),T=(({item:e,customValidators:t})=>{var a;const s=Object(n.useRef)({}),[i,l]=Object(n.useState)({title:{value:e.title,isChangingValue:!1},description:{value:null!==(a=e.description)&&void 0!==a?a:"",isChangingValue:!1},tags:{value:e.tags?e.tags.map((({id:e})=>e)):[],isChangingValue:!1}}),r=Object(n.useCallback)((a=>n=>{const i=s.current[a];i&&clearTimeout(i),s.current[a]=null,l((e=>{const t=e[a];return{...e,[a]:{...t,value:n,errors:void 0,warnings:void 0,isChangingValue:!0}}})),s.current[a]=setTimeout((async()=>{const{errors:s,warnings:i}=await(async(e,t,a,n)=>{const s={warnings:[],errors:[]};for(const l of[...null!==(i=j[e])&&void 0!==i?i:[],...g(e,n)]){var i;const e=await l.fn(a,t);if(e){const t="error"===l.type?"errors":"warnings";Array.isArray(s[t])?s[t].push(e):s[t]=[e]}}return s})(a,e.id,n,t);l((e=>({...e,[a]:{...e[a],errors:s,warnings:i,isChangingValue:!1}})))}),500)}),[t,e.id]),o=Object(n.useMemo)((()=>r("title")),[r]),c=Object(n.useMemo)((()=>r("description")),[r]),u=Object(n.useMemo)((()=>r("tags")),[r]),{errors:d,warnings:b,isChangingValue:m}=Object(n.useMemo)((()=>Object.values(i).reduce(((e,t)=>{var a,n,s,i;return{errors:[...null!==(a=e.errors)&&void 0!==a?a:[],...null!==(n=t.errors)&&void 0!==n?n:[]],warnings:[...null!==(s=e.warnings)&&void 0!==s?s:[],...null!==(i=t.warnings)&&void 0!==i?i:[]],isChangingValue:e.isChangingValue||t.isChangingValue}}),{errors:[],warnings:[],isChangingValue:!1})),[i]);return{title:i.title,setTitle:o,description:i.description,setDescription:c,tags:i.tags,setTags:u,isValid:0===(null==d?void 0:d.length),getErrors:()=>d,getWarnings:()=>b,getIsChangingValue:()=>m}})({item:e,customValidators:p}),C=Object(n.useCallback)((async()=>{if(T.isValid&&O&&!T.getIsChangingValue()){const a=e.id,n=T.title.value;h(!0);try{await O({id:a,title:n,description:T.description.value,tags:T.tags.value})}catch(e){m(Object(o.jsx)(l.FormattedMessage,{id:"contentManagement.inspector.metadataForm.unableToSaveDangerMessage",defaultMessage:"Unable to save {entityName}",values:{entityName:t}}),e.message)}finally{h(!1)}}w(!0)}),[O,e.id,T,m,t]),B=Object(n.useCallback)((()=>{x()}),[x]),S=Object(o.css)("margin-right:",E.size.m,";",""),I=`${(L=i.i18n.translate("contentManagement.contentEditor.flyoutTitle",{defaultMessage:"{entityName} details",values:{entityName:t}})).charAt(0).toLocaleUpperCase()}${L.substring(1)}`;var L;return Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiFlyoutHeader,null,Object(o.jsx)(r.EuiTitle,{"data-test-subj":"flyoutTitle"},Object(o.jsx)("h2",null,Object(o.jsx)(r.EuiIcon,{type:"iInCircle",css:S,size:"l"}),Object(o.jsx)("span",null,I)))),Object(o.jsx)(r.EuiFlyoutBody,null,Object(o.jsx)(d,{form:{...T,isSubmitted:M},isReadonly:a,readonlyReason:c||i.i18n.translate("contentManagement.contentEditor.metadataForm.readOnlyToolTip",{defaultMessage:"To edit these details, contact your administrator for access."}),tagsReferences:e.tags,TagList:b,TagSelector:u},v&&Object(o.jsx)(y,{item:e}))),Object(o.jsx)(r.EuiFlyoutFooter,null,Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:B,"data-test-subj":"closeFlyoutButton"},F.cancelButtonLabel)),!1===a&&Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiButton,{color:"primary",onClick:C,"data-test-subj":"saveButton",fill:!0,disabled:M&&!T.isValid,isLoading:f},F.saveButtonLabel))))))},h=e=>Object(o.jsx)(f,e)}}]);