/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(n){var t={};function e(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)e.d(r,i,function(t){return n[t]}.bind(null,i));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=5)}([function(n,t){n.exports=__kbnSharedDeps__.KbnI18n},function(n,t){n.exports=__kbnSharedDeps__.Lodash},function(n,t,e){"use strict";e.r(t),e.d(t,"AlertingConnectorFeatureId",(function(){return i})),e.d(t,"CasesConnectorFeatureId",(function(){return u})),e.d(t,"UptimeConnectorFeatureId",(function(){return a})),e.d(t,"SecurityConnectorFeatureId",(function(){return o})),e.d(t,"GenerativeAIForSecurityConnectorFeatureId",(function(){return l})),e.d(t,"InvalidEmailReason",(function(){return O})),e.d(t,"isActionTypeExecutorResult",(function(){return T})),e.d(t,"ALERT_HISTORY_PREFIX",(function(){return k})),e.d(t,"AlertHistoryDefaultIndexName",(function(){return w})),e.d(t,"AlertHistoryEsIndexConnectorId",(function(){return j})),e.d(t,"buildAlertHistoryDocument",(function(){return R})),e.d(t,"AlertHistoryDocumentTemplate",(function(){return M})),e.d(t,"MustacheInEmailRegExp",(function(){return D})),e.d(t,"hasMustacheTemplate",(function(){return G})),e.d(t,"withoutMustacheTemplate",(function(){return N})),e.d(t,"validateEmailAddressesAsAlwaysValid",(function(){return U})),e.d(t,"validateEmailAddresses",(function(){return H})),e.d(t,"invalidEmailsAsMessage",(function(){return q})),e.d(t,"GenerativeAIForObservabilityConnectorFeatureId",(function(){return c})),e.d(t,"GenerativeAIForSearchPlaygroundConnectorFeatureId",(function(){return s})),e.d(t,"AlertingConnectorFeature",(function(){return g})),e.d(t,"CasesConnectorFeature",(function(){return b})),e.d(t,"UptimeConnectorFeature",(function(){return h})),e.d(t,"SecuritySolutionFeature",(function(){return y})),e.d(t,"GenerativeAIForSecurityFeature",(function(){return A})),e.d(t,"GenerativeAIForObservabilityFeature",(function(){return _})),e.d(t,"GenerativeAIForSearchPlaygroundFeature",(function(){return I})),e.d(t,"areValidFeatures",(function(){return F})),e.d(t,"getConnectorFeatureName",(function(){return S})),e.d(t,"getConnectorCompatibility",(function(){return C})),e.d(t,"EMPTY_EXECUTION_KPI_RESULT",(function(){return B})),e.d(t,"executionLogSortableColumns",(function(){return V})),e.d(t,"BASE_ACTION_API_PATH",(function(){return X})),e.d(t,"INTERNAL_BASE_ACTION_API_PATH",(function(){return z})),e.d(t,"ACTIONS_FEATURE_ID",(function(){return K})),e.d(t,"DEFAULT_MICROSOFT_EXCHANGE_URL",(function(){return W})),e.d(t,"DEFAULT_MICROSOFT_GRAPH_API_URL",(function(){return Y})),e.d(t,"DEFAULT_MICROSOFT_GRAPH_API_SCOPE",(function(){return Z}));var r=e(0);const i="alerting",u="cases",a="uptime",o="siem",l="generativeAIForSecurity",c="generativeAIForObservability",s="generativeAIForSearchPlayground",d=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForSecurity",{defaultMessage:"Generative AI for Security"}),f=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForObservability",{defaultMessage:"Generative AI for Observability"}),p=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForSearchPlayground",{defaultMessage:"Generative AI for Search Playground"}),m=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.alertingRules",{defaultMessage:"Alerting Rules"}),v=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.cases",{defaultMessage:"Cases"}),g={id:i,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.alerting",{defaultMessage:"Alerting"}),compatibility:m},b={id:u,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.cases",{defaultMessage:"Cases"}),compatibility:v},h={id:a,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.uptime",{defaultMessage:"Uptime"}),compatibility:m},y={id:o,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.securitySolution",{defaultMessage:"Security Solution"}),compatibility:m},A={id:l,name:d,compatibility:d},_={id:c,name:f,compatibility:f},I={id:s,name:p,compatibility:p},x={[g.id]:g,[b.id]:b,[h.id]:h,[y.id]:y,[A.id]:A,[_.id]:_,[I.id]:I};function F(n){return n.every((n=>!!x[n]))}function S(n){const t=x[n];return t?t.name:n}function C(n){const t=new Set;if(n&&n.length>0)for(const e of n)x[e]&&t.add(x[e].compatibility);return Array.from(t)}let O=function(n){return n.invalid="invalid",n.notAllowed="notAllowed",n}({});const E=["ok","error"];function T(n){const t=n;return t&&"string"==typeof(null==t?void 0:t.actionId)&&E.includes(null==t?void 0:t.status)}var P=e(1);const k="kibana-alert-history-",w=`${k}default`,j="preconfigured-alert-history-es-index",R=n=>{const{date:t,alert:e,context:r,params:i,tags:u,rule:a}=n;if(!e||!a)return null;const{actionGroup:o,actionGroupName:l,id:c}=e,{id:s,name:d,spaceId:f,type:p}=a;if(!p)return null;const m=p.replace(/\./g,"__"),v={...s?{id:s}:{},...d?{name:d}:{},...Object(P.isEmpty)(i)?{}:{params:{[m]:i}},...f?{space:f}:{},...p?{type:p}:{}},g={...c?{id:c}:{},...Object(P.isEmpty)(r)?{}:{context:{[m]:r}},...o?{actionGroup:o}:{},...l?{actionGroupName:l}:{}},b={"@timestamp":t||(new Date).toISOString(),...u&&u.length>0?{tags:u}:{},...null!=r&&r.message?{message:r.message}:{},...Object(P.isEmpty)(v)?{}:{rule:v},...Object(P.isEmpty)(g)?{}:{kibana:{alert:g}}};return Object(P.isEmpty)(b)?null:{...b,event:{kind:"alert"}}},M=Object.freeze(R({rule:{id:"{{rule.id}}",name:"{{rule.name}}",type:"{{rule.type}}",spaceId:"{{rule.spaceId}}"},context:"{{context}}",params:"{{rule.params}}",tags:"{{rule.tags}}",alert:{id:"{{alert.id}}",actionGroup:"{{alert.actionGroup}}",actionGroupName:"{{alert.actionGroupName}}"}})),D=/\{\{((.|\n)*)\}\}/;function G(n){return!!n.match(D)}function N(n){return n.filter((n=>!G(n)))}var L=e(4);function U(n){return n.map((n=>({address:n,valid:!0})))}function H(n,t,e={}){return t.map((t=>function(n,t,e){if(e.treatMustacheTemplatesAsValid&&G(t))return{address:t,valid:!0};try{return function(n,t){const e=Object(L.parseAddressList)(t);if(null==e)return{address:t,valid:!1,reason:O.invalid};if(null!==n){const r=new Set(n);for(const n of e){let e=[];if("group"===n.type)e=n.addresses.map((n=>n.domain));else{if("mailbox"!==n.type)return{address:t,valid:!1,reason:O.invalid};e=[n.domain]}for(const n of e)if(!r.has(n))return{address:t,valid:!1,reason:O.notAllowed}}}return{address:t,valid:!0}}(n,t)}catch(n){return{address:t,valid:!1,reason:O.invalid}}}(n,t,e)))}function q(n){const t=n.filter((n=>!n.valid&&n.reason===O.invalid)),e=n.filter((n=>!n.valid&&n.reason===O.notAllowed)),r=[];if(0!==t.length&&r.push(`not valid emails: ${$(t).join(", ")}`),0!==e.length&&r.push(`not allowed emails: ${$(e).join(", ")}`),0!==r.length)return r.join("; ")}function $(n){return n.map((n=>n.address))}const B={success:0,unknown:0,failure:0,warning:0},V=["timestamp","execution_duration","schedule_delay"],X="/api/actions",z="/internal/actions",K="actions",W="https://login.microsoftonline.com",Y="https://graph.microsoft.com/v1.0",Z="https://graph.microsoft.com/.default"},function(n,t,e){n.exports=e(7)(2)},function(n,t,e){!function(t){"use strict";function e(n){function t(){return Sn<Cn}function e(){return Sn}function i(n){Sn=n}function u(){Sn=0,Cn=Fn.length}function a(n,t){return{name:n,tokens:t||"",semantic:t||"",children:[]}}function o(n,t){var e;return null===t?null:((e=a(n)).tokens=t.tokens,e.semantic=t.semantic,e.children.push(t),e)}function l(n,t){return null!==t&&(n.tokens+=t.tokens,n.semantic+=t.semantic),n.children.push(t),n}function c(n){var e;return t()&&n(e=Fn[Sn])?(Sn+=1,a("token",e)):null}function s(){return null}function d(n){return function(){return o("literal",c((function(t){return t===n})))}}function f(){var n=arguments;return function(){var t,r,u,o;for(o=e(),r=a("and"),t=0;t<n.length;t+=1){if(null===(u=n[t]()))return i(o),null;l(r,u)}return r}}function p(){var n=arguments;return function(){var t,r,u;for(u=e(),t=0;t<n.length;t+=1){if(null!==(r=n[t]()))return r;i(u)}return null}}function m(n){return function(){var t,r;return r=e(),null!==(t=n())?t:(i(r),a("opt"))}}function v(n){return function(){var t=n();return null!==t&&(t.semantic=""),t}}function g(n){return function(){var t=n();return null!==t&&t.semantic.length>0&&(t.semantic=" "),t}}function b(n,t){return function(){var r,u,o,c,s;for(c=e(),r=a("star"),o=0,s=void 0===t?0:t;null!==(u=n());)o+=1,l(r,u);return o>=s?r:(i(c),null)}}function h(n){return n.charCodeAt(0)>=128}function y(){return o("cr",d("\r")())}function A(){return o("crlf",f(y,x)())}function _(){return o("dquote",d('"')())}function I(){return o("htab",d("\t")())}function x(){return o("lf",d("\n")())}function F(){return o("sp",d(" ")())}function S(){return o("vchar",c((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r})))}function C(){return o("wsp",p(F,I)())}function O(){var n=o("quoted-pair",p(f(d("\\"),p(S,C)),un)());return null===n?null:(n.semantic=n.semantic[1],n)}function E(){return o("fws",p(on,f(m(f(b(C),v(A))),b(C,1)))())}function T(){return o("ctext",p((function(){return c((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=39||42<=e&&e<=91||93<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),en)())}function P(){return o("ccontent",p(T,O,k)())}function k(){return o("comment",f(d("("),b(f(m(E),P)),m(E),d(")"))())}function w(){return o("cfws",p(f(b(f(m(E),k),1),m(E)),E)())}function j(){return o("atext",c((function(t){var e="a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(t)>=0;return n.rfc6532&&(e=e||h(t)),e})))}function R(){return o("atom",f(g(m(w)),b(j,1),g(m(w)))())}function M(){var n,t;return null===(n=o("dot-atom-text",b(j,1)()))||null!==(t=b(f(d("."),b(j,1)))())&&l(n,t),n}function D(){return o("dot-atom",f(v(m(w)),M,v(m(w)))())}function G(){return o("qtext",p((function(){return c((function(t){var e=t.charCodeAt(0),r=33===e||35<=e&&e<=91||93<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),rn)())}function N(){return o("qcontent",p(G,O)())}function L(){return o("quoted-string",f(v(m(w)),v(_),b(f(m(g(E)),N)),m(v(E)),v(_),v(m(w)))())}function U(){return o("word",p(R,L)())}function H(){return o("address",p(q,V)())}function q(){return o("mailbox",p($,nn)())}function $(){return o("name-addr",f(m(X),B)())}function B(){return o("angle-addr",p(f(v(m(w)),d("<"),nn,d(">"),v(m(w))),ln)())}function V(){return o("group",f(X,d(":"),m(W),d(";"),v(m(w)))())}function X(){return o("display-name",(null!==(n=o("phrase",p(an,b(U,1))()))&&(n.semantic=n.semantic.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")),n));var n}function z(){return o("mailbox-list",p(f(q,b(f(d(","),q))),dn)())}function K(){return o("address-list",p(f(H,b(f(d(n.addressListSeparator),H))),fn)())}function W(){return o("group-list",p(z,v(w),pn)())}function Y(){return o("local-part",p(mn,D,L)())}function Z(){return o("dtext",p((function(){return c((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=90||94<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),gn)())}function J(){return o("domain-literal",f(v(m(w)),d("["),b(f(m(E),Z)),m(E),d("]"),v(m(w)))())}function Q(){return o("domain",(t=p(vn,D,J)(),n.rejectTLD&&t&&t.semantic&&t.semantic.indexOf(".")<0?null:(t&&(t.semantic=t.semantic.replace(/\s+/g,"")),t)));var t}function nn(){return o("addr-spec",f(Y,d("@"),Q)())}function tn(){return n.strict?null:o("obs-NO-WS-CTL",c((function(n){var t=n.charCodeAt(0);return 1<=t&&t<=8||11===t||12===t||14<=t&&t<=31||127===t})))}function en(){return n.strict?null:o("obs-ctext",tn())}function rn(){return n.strict?null:o("obs-qtext",tn())}function un(){return n.strict?null:o("obs-qp",f(d("\\"),p(d("\0"),tn,x,y))())}function an(){return n.strict?null:o("obs-phrase",f(U,b(p(U,d("."),n.atInDisplayName?d("@"):s,n.commaInDisplayName?d(","):s,g(w))))())}function on(){return n.strict?null:o("obs-FWS",b(f(v(m(A)),C),1)())}function ln(){return n.strict?null:o("obs-angle-addr",f(v(m(w)),d("<"),cn,nn,d(">"),v(m(w)))())}function cn(){return n.strict?null:o("obs-route",f(sn,d(":"))())}function sn(){return n.strict?null:o("obs-domain-list",f(b(p(v(w),d(","))),d("@"),Q,b(f(d(","),v(m(w)),m(f(d("@"),Q)))))())}function dn(){return n.strict?null:o("obs-mbox-list",f(b(f(v(m(w)),d(","))),q,b(f(d(","),m(f(q,v(w))))))())}function fn(){return n.strict?null:o("obs-addr-list",f(b(f(v(m(w)),d(","))),H,b(f(d(","),m(f(H,v(w))))))())}function pn(){return n.strict?null:o("obs-group-list",f(b(f(v(m(w)),d(",")),1),v(m(w)))())}function mn(){return n.strict?null:o("obs-local-part",f(U,b(f(d("."),U)))())}function vn(){return n.strict?null:o("obs-domain",f(R,b(f(d("."),R)))())}function gn(){return n.strict?null:o("obs-dtext",p(tn,O)())}function bn(n,t){var e,r,i;if(null==t)return null;for(r=[t];r.length>0;){if((i=r.pop()).name===n)return i;for(e=i.children.length-1;e>=0;e-=1)r.push(i.children[e])}return null}function hn(n,t){var e,r,i,u,a;if(null==t)return null;for(r=[t],u=[],a={},e=0;e<n.length;e+=1)a[n[e]]=!0;for(;r.length>0;)if((i=r.pop()).name in a)u.push(i);else for(e=i.children.length-1;e>=0;e-=1)r.push(i.children[e]);return u}function yn(t){var e,r,i,u,a;if(null===t)return null;for(e=[],r=hn(["group","mailbox"],t),i=0;i<r.length;i+=1)"group"===(u=r[i]).name?e.push(An(u)):"mailbox"===u.name&&e.push(_n(u));return a={ast:t,addresses:e},n.simple&&(a=function(n){var t;if(n&&n.addresses)for(t=0;t<n.addresses.length;t+=1)delete n.addresses[t].node;return n}(a)),n.oneResult?function(t){return t?!n.partial&&t.addresses.length>1?null:t.addresses&&t.addresses[0]:null}(a):n.simple?a&&a.addresses:a}function An(n){var t,e=bn("display-name",n),r=[],i=hn(["mailbox"],n);for(t=0;t<i.length;t+=1)r.push(_n(i[t]));return{node:n,parts:{name:e},type:n.name,name:In(e),addresses:r}}function _n(n){var t=bn("display-name",n),e=bn("addr-spec",n),r=function(n,t){var e,r,i,u;if(null==t)return null;for(r=[t],u=[];r.length>0;)for("cfws"===(i=r.pop()).name&&u.push(i),e=i.children.length-1;e>=0;e-=1)r.push(i.children[e]);return u}(0,n),i=hn(["comment"],n),u=bn("local-part",e),a=bn("domain",e);return{node:n,parts:{name:t,address:e,local:u,domain:a,comments:r},type:n.name,name:In(t),address:In(e),local:In(u),domain:In(a),comments:xn(i),groupName:In(n.groupName)}}function In(n){return null!=n?n.semantic:null}function xn(n){var t="";if(n)for(var e=0;e<n.length;e+=1)t+=In(n[e]);return t}var Fn,Sn,Cn,On,En;if(null===(n=r(n,{})))return null;if(Fn=n.input,En={address:H,"address-list":K,"angle-addr":B,from:function(){return o("from",p(z,K)())},group:V,mailbox:q,"mailbox-list":z,"reply-to":function(){return o("reply-to",K())},sender:function(){return o("sender",p(q,H)())}}[n.startAt]||K,!n.strict){if(u(),n.strict=!0,On=En(Fn),n.partial||!t())return yn(On);n.strict=!1}return u(),On=En(Fn),!n.partial&&t()?null:yn(On)}function r(n,t){function e(n){return"[object String]"===Object.prototype.toString.call(n)}function r(n){return null==n}var i,u;if(e(n))n={input:n};else if(!function(n){return n===Object(n)}(n))return null;if(!e(n.input))return null;if(!t)return null;for(u in i={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1,commaInDisplayName:!1,addressListSeparator:","})r(n[u])&&(n[u]=r(t[u])?i[u]:t[u]);return n}e.parseOneAddress=function(n){return e(r(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseAddressList=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseFrom=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"from"}))},e.parseSender=function(n){return e(r(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},e.parseReplyTo=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},void 0!==n.exports?n.exports=e:t.emailAddresses=e}(this)},function(n,t,e){e(6),__kbnBundles__.define("plugin/actions/public",e,8),__kbnBundles__.define("plugin/actions/common",e,2)},function(n,t,e){e.p=window.__kbnPublicPath__.actions},function(n,t){n.exports=__kbnSharedDeps_npm__},function(n,t,e){"use strict";e.r(t),e.d(t,"Plugin",(function(){return plugin_Plugin})),e.d(t,"plugin",(function(){return a}));var r=e(3),i=e.n(r),u=e(2);class plugin_Plugin{constructor(n){var t;i()(this,"allowedEmailDomains",null);const e=n.config.get();this.allowedEmailDomains=(null===(t=e.email)||void 0===t?void 0:t.domain_allowlist)||null}setup(){return{validateEmailAddresses:(n,t)=>Object(u.validateEmailAddresses)(this.allowedEmailDomains,n,t)}}start(){}}function a(n){return new plugin_Plugin(n)}}]);