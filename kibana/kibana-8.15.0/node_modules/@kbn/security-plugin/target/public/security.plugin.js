/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var i,s,r=t[0],o=t[1],a=0,u=[];a<r.length;a++)s=r[a],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&u.push(n[s][0]),n[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);for(c&&c(t);u.length;)u.shift()()}var i={},n={4:0};function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise((function(t,s){i=n[e]=[t,s]}));t.push(i[2]=r);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+"security.chunk."+e+".js"}(e);var c=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(u);var i=n[e];if(0!==i){if(i){var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",c.name="ChunkLoadError",c.type=s,c.request=r,i[1](c)}n[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var r=window.security_bundle_jsonpfunction=window.security_bundle_jsonpfunction||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var a=0;a<r.length;a++)t(r[a]);var c=o;s(s.s=44)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,i){e.exports=i(32)(2)},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return l}));var n=i(2),s=i(11),r=i(0);const o=Object(n.createContext)(void 0),a=({children:e,...t})=>{const i=Object(n.useContext)(o),s=Object(r.jsx)(u,{breadcrumb:t},e);return i?s:Object(r.jsx)(c,null,s)},c=({children:e,onChange:t})=>{const{services:i}=Object(s.useKibana)(),a=Object(n.useRef)([]),c=e=>{const n=e.map(((t,i)=>i===e.length-1?{...t,href:void 0}:t));t?t(n):i.chrome&&l(i.chrome)(n)};return Object(r.jsx)(o.Provider,{value:{parents:[],onMount:e=>{e.length>a.current.length&&(a.current=e,c(e))},onUnmount:e=>{e.length<a.current.length&&(a.current=e,c(e))}}},e)},u=({breadcrumb:e,children:t})=>{const{parents:i,onMount:s,onUnmount:a}=Object(n.useContext)(o),c=[...i,e];return Object(n.useEffect)((()=>(s(c),()=>a(i))),[e.text,e.href]),Object(r.jsx)(o.Provider,{value:{parents:c,onMount:s,onUnmount:a}},t)};function l(e,t=e.setBreadcrumbs){return i=>{t(i),0===i.length?e.docTitle.reset():e.docTitle.change(function(e,t=2){return e.slice(0,t).reverse().map((({text:e})=>e))}(i))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return a})),i.d(t,"i",(function(){return c})),i.d(t,"k",(function(){return u})),i.d(t,"h",(function(){return l})),i.d(t,"g",(function(){return d})),i.d(t,"n",(function(){return h})),i.d(t,"l",(function(){return p})),i.d(t,"j",(function(){return b})),i.d(t,"m",(function(){return f})),i.d(t,"o",(function(){return g})),i.d(t,"d",(function(){return v}));const n="*",s="auth_provider_hint",r="auth_url_hash",o="provider",a="msg",c="next",u="kbn-session-error-reason",l=/^(?! )[a-zA-Z0-9 !"#$%&'()*+,\-./\\:;<=>?@\[\]^_`{|}~]*[a-zA-Z0-9!"#$%&'()*+,\-./\\:;<=>?@\[\]^_`{|}~]$/,d=1024,h=5e3,p=3e5,b=1e3,f=6e4,g="/internal/security/session",v=["image/svg+xml","image/jpeg","image/png","image/gif"]},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t,i){e.exports=i(32)(4)},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i(10),s=i.n(n),r=i(2),o=i(40),a=i(41),c=i(15),u=i.n(c),l=i(30),d=i.n(l),h=i(4);const p="eui-global",b="eui-utilities",f={darkMode:!1};var g=i(0);const v=[h.euiStylisPrefixer],m=d()({key:"css",stylisPlugins:v,container:document.querySelector('meta[name="emotion"]')}),y=d()({key:p,stylisPlugins:v,container:document.querySelector(`meta[name="${p}"]`)}),j=d()({key:b,stylisPlugins:v,container:document.querySelector(`meta[name="${b}"]`)});m.compat=!0,y.compat=!0,j.compat=!0;const _={default:m,global:y,utility:j},x=({theme:{theme$:e},globalStyles:t,colorMode:i,modify:n,children:s})=>{const o=u()(e,f),a=Object(r.useMemo)((()=>(e=>e.darkMode?h.COLOR_MODES_STANDARD.dark:h.COLOR_MODES_STANDARD.light)(o)),[o]),c=i||a,l=!1!==t&&void 0;return Object(g.jsx)(h.EuiProvider,{cache:_,modify:n,colorMode:c,globalStyles:l,utilityClasses:l},s)},O=({children:e,i18n:t,...i})=>Object(o.useIsNestedEuiProvider)()?(Object(a.emitEuiProviderWarning)("KibanaRootContextProvider has likely been nested in this React tree, either by direct reference or by KibanaRenderContextProvider.  The result of this nesting is a nesting of EuiProvider, which has negative effects.  Check your React tree for nested Kibana context providers."),Object(g.jsx)(t.Context,null,e)):Object(g.jsx)(x,i,Object(g.jsx)(t.Context,null,e));var S=i(35);const P=({children:e,...t})=>Object(g.jsx)(O,s()({globalStyles:!1},t),Object(g.jsx)(S.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(g.jsx)(S.KibanaErrorBoundary,null,e)))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"d",(function(){return o})),i.d(t,"a",(function(){return a.a})),i.d(t,"e",(function(){return a.d})),i.d(t,"c",(function(){return a.c}));var n=i(31),s=i.n(n);const[r,o]=s()((({userProfiles:e,users:t})=>({userProfiles:e,users:t})));var a=i(17)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(22),s=i(2),r=n.__importDefault(i(46));t.default=function(e,t){var i=s.useState(t),n=i[0],o=i[1];return r.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),n}},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return h})),i.d(t,"d",(function(){return p}));var n=i(31),s=i.n(n),r=i(34),o=i.n(r),a=i(15),c=i.n(a),u=i(14);const[l,d]=s()((({authc:e})=>e));function h(){const e=d();return o()(e.getCurrentUser,[e])}function p(e){const{userProfiles:t}=Object(u.d)(),i=c()(t.dataUpdates$);return o()((()=>t.getCurrent(e?{dataPath:e}:void 0)),[t,i])}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3),s=i(2),r=i(11),o=i(38);const a=({featureId:e,tooltip:t})=>{const{save:i}=Object(o.a)(e);return function(e,t=[null==e?void 0:e.iconType,null==e?void 0:e.text,null==e?void 0:e.tooltip]){const{services:i}=Object(r.useKibana)();Object(s.useEffect)((()=>{if(e)return i.chrome.setBadge(e),()=>i.chrome.setBadge()}),t)}(i?void 0:{iconType:"glasses",text:n.i18n.translate("xpack.security.management.readonlyBadge.text",{defaultMessage:"Read only"}),tooltip:t},[i]),null}},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDomV5Compat},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=e=>{try{return decodeURIComponent(e)}catch{return e}}},function(e,t,i){"use strict";i.d(t,"f",(function(){return a})),i.d(t,"g",(function(){return c})),i.d(t,"h",(function(){return s})),i.d(t,"b",(function(){return h})),i.d(t,"a",(function(){return p})),i.d(t,"p",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return S})),i.d(t,"j",(function(){return m})),i.d(t,"l",(function(){return O})),i.d(t,"m",(function(){return v})),i.d(t,"n",(function(){return y})),i.d(t,"i",(function(){return j})),i.d(t,"k",(function(){return g})),i.d(t,"q",(function(){return P})),i.d(t,"e",(function(){return _})),i.d(t,"o",(function(){return x}));var n=i(4);function s(e){return e.full_name||e.email||e.username}const r=97,o=2;function a(e,t){if(t&&t.color)return t.color;const i=s(e).codePointAt(0)||r;return n.VISUALIZATION_COLORS[i%n.VISUALIZATION_COLORS.length]}function c(e,t){if(t&&t.initials)return t.initials;const i=s(e).split(" "),n=Math.min(o,i.length);return i.splice(n,i.length),i.map((e=>e.substring(0,1))).join("")}const u=["reserved","native"];function l(e){return"anonymous"===e.authentication_provider.type}function d(e){return!l(e)&&"http"!==e.authentication_provider.type}function h(e){return u.includes(e.authentication_realm.type)&&!l(e)}function p(e,t){return"native"===e.authentication_realm.type&&t.management.security.users}var b=i(16),f=i(3);function g(e){var t,i;return null===(t=null===(i=e.transient_metadata)||void 0===i?void 0:i.enabled)||void 0===t||t}function v(e){var t,i;return null!==(t=null===(i=e.metadata)||void 0===i?void 0:i._reserved)&&void 0!==t&&t}function m(e){var t,i;return null!==(t=null===(i=e.metadata)||void 0===i?void 0:i._deprecated)&&void 0!==t&&t}function y(e){var t,i;return null!==(t=v(e)&&(null===(i=e.name)||void 0===i?void 0:i.endsWith("_system")))&&void 0!==t&&t}function j(e){var t,i;return null!==(t=v(e)&&((null===(i=e.name)||void 0===i?void 0:i.endsWith("_admin"))||"superuser"===e.name)||x(e))&&void 0!==t&&t}function _(e){return f.i18n.translate("xpack.security.common.extendedRoleDeprecationNotice",{defaultMessage:"The {roleName} role is deprecated. {reason}",values:{roleName:e.name,reason:w(e)}})}function x(e){var t,i;return null!==(t=null===(i=e.kibana)||void 0===i?void 0:i.some((e=>e.base.includes("*"))))&&void 0!==t&&t}function O(e){var t,i;return v(e)||x(e)||(null!==(t=null===(i=e._transform_error)||void 0===i?void 0:i.length)&&void 0!==t?t:0)>0}function S(e){return Object(b.cloneDeep)(e)}function P(e){const t=S(e);return t.name="",t}function w(e){var t,i;return null!==(t=null===(i=e.metadata)||void 0===i?void 0:i._deprecated_reason)&&void 0!==t?t:""}},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t,i){"use strict";i.r(t),i.d(t,"UserAPIClient",(function(){return n.UserAPIClient})),i.d(t,"usersManagementApp",(function(){return _}));var n=i(27),s=i(2),r=i.n(s),o=i(6),a=i(9),c=i(3),u=i(11),l=i(12),d=i(16),h=i(19),p=i(37),b=i(0);const f=({legacySwitch:e=!0,children:t})=>{const i=Object(a.useRouteMatch)();return e?Object(b.jsx)(a.Switch,null,t):Object(b.jsx)(h.Routes,null,s.Children.map(t,(e=>{if(r.a.isValidElement(e)&&e.type===p.b){var n;const s=Object(d.replace)(null==e?void 0:e.props.path,i.url+"/",""),o="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(b.jsx)(h.Route,{path:s,element:Object(b.jsx)(r.a.Fragment,null,Object(b.jsx)(p.a,null),(null==e||null===(n=e.props)||void 0===n?void 0:n.component)&&Object(b.jsx)(e.props.component,null)||o&&o()||t)})}return e})))};var g=i(71),v=i(7),m=i(17),y=i(18),j=i(20);const _=Object.freeze({id:"users",create({authc:e,getStartServices:t}){const n=c.i18n.translate("xpack.security.management.usersTitle",{defaultMessage:"Users"});return{id:this.id,order:10,title:n,async mount({element:n,setBreadcrumbs:s,history:r}){const[[u],{UsersGridPage:l},{CreateUserPage:d,EditUserPage:h},{UserAPIClient:g},{RolesAPIClient:m}]=await Promise.all([t(),i.e(11).then(i.bind(null,317)),i.e(10).then(i.bind(null,314)),Promise.resolve().then(i.bind(null,27)),Promise.resolve().then(i.bind(null,24))]);return Object(o.render)(Object(b.jsx)(x,{services:u,history:r,authc:e,onChange:Object(v.c)(u.chrome,s)},Object(b.jsx)(y.a,{featureId:"users",tooltip:c.i18n.translate("xpack.security.management.users.readonlyTooltip",{defaultMessage:"Unable to create or edit users"})}),Object(b.jsx)(v.a,{text:c.i18n.translate("xpack.security.users.breadcrumb",{defaultMessage:"Users"}),href:"/"},Object(b.jsx)(f,null,Object(b.jsx)(p.b,{path:["/",""],exact:!0},Object(b.jsx)(l,{notifications:u.notifications,userAPIClient:new g(u.http),rolesAPIClient:new m(u.http),history:r,navigateToApp:u.application.navigateToApp,readOnly:!u.application.capabilities.users.save})),Object(b.jsx)(p.b,{path:"/create"},Object(b.jsx)(v.a,{text:c.i18n.translate("xpack.security.users.editUserPage.createBreadcrumb",{defaultMessage:"Create"}),href:"/create"},Object(b.jsx)(d,null))),Object(b.jsx)(p.b,{path:"/edit/:username",render:e=>{const t=Object(j.a)(e.match.params.username);return Object(b.jsx)(v.a,{text:t,href:`/edit/${encodeURIComponent(t)}`},Object(b.jsx)(h,{username:t}))}}),Object(b.jsx)(p.b,{path:"/edit"},Object(b.jsx)(a.Redirect,{to:"/create"}))))),n),()=>{Object(o.unmountComponentAtNode)(n)}}}}}),x=({services:e,history:t,authc:i,onChange:n,children:s})=>Object(b.jsx)(l.a,e,Object(b.jsx)(u.KibanaContextProvider,{services:e},Object(b.jsx)(m.a,{authc:i},Object(b.jsx)(g.a,{history:t},Object(b.jsx)(v.b,{onChange:n},s)))))},function(e,t,i){"use strict";i.r(t),i.d(t,"rolesManagementApp",(function(){return g})),i.d(t,"RolesAPIClient",(function(){return v.RolesAPIClient}));var n=i(10),s=i.n(n),r=(i(2),i(6)),o=i(9),a=i(3),c=i(11),u=i(12),l=i(71),d=i(37),h=i(7),p=i(18),b=i(20),f=i(0);const g=Object.freeze({id:"roles",create({license:e,getStartServices:t,buildFlavor:n}){const g="serverless"===n?a.i18n.translate("xpack.security.management.rolesTitleServerless",{defaultMessage:"Custom Roles"}):a.i18n.translate("xpack.security.management.rolesTitle",{defaultMessage:"Roles"});return{id:this.id,order:20,title:g,async mount({element:v,setBreadcrumbs:m,history:y}){const[[j,{dataViews:_,features:x,spaces:O,cloud:S}],{RolesGridPage:P},{EditRolePage:w},{RolesAPIClient:C},{IndicesAPIClient:A},{PrivilegesAPIClient:E},{UserAPIClient:k}]=await Promise.all([t(),Promise.all([i.e(0),i.e(14)]).then(i.bind(null,315)),i.e(5).then(i.bind(null,308)),Promise.resolve().then(i.bind(null,39)),i.e(19).then(i.bind(null,304)),i.e(20).then(i.bind(null,305)),Promise.resolve().then(i.bind(null,23))]),{application:M,http:I,chrome:R}=j;R.docTitle.change(g);const T=new C(I),U=({action:t})=>{const{roleName:i}=Object(o.useParams)(),r=i?Object(b.a)(i):void 0,c="edit"===t&&i&&r?{text:r,href:`/edit/${encodeURIComponent(i)}`}:{text:a.i18n.translate("xpack.security.roles.createBreadcrumb",{defaultMessage:"Create"})},u=null==O?void 0:O.ui;return Object(f.jsx)(h.a,{text:c.text,href:c.href},Object(f.jsx)(w,s()({action:t,roleName:r,rolesAPIClient:T,userAPIClient:new k(I),indicesAPIClient:new A(I),privilegesAPIClient:new E(I),getFeatures:x.getFeatures,license:e,uiCapabilities:M.capabilities,dataViews:_,history:y,spacesApiUi:u,buildFlavor:n,cloudOrgUrl:null==S?void 0:S.organizationUrl},j)))};return Object(r.render)(Object(f.jsx)(u.a,j,Object(f.jsx)(c.KibanaContextProvider,{services:j},Object(f.jsx)(l.a,{history:y},Object(f.jsx)(p.a,{featureId:"roles",tooltip:a.i18n.translate("xpack.security.management.roles.readonlyTooltip",{defaultMessage:"Unable to create or edit roles"})}),Object(f.jsx)(h.b,{onChange:Object(h.c)(R,m)},Object(f.jsx)(h.a,{text:g,href:"/"},Object(f.jsx)(d.b,{path:["/",""],exact:!0},Object(f.jsx)(P,s()({rolesAPIClient:T,history:y,readOnly:!j.application.capabilities.roles.save,buildFlavor:n,cloudOrgUrl:null==S?void 0:S.organizationUrl},j))),Object(f.jsx)(d.b,{path:"/edit/:roleName?"},Object(f.jsx)(U,{action:"edit"})),Object(f.jsx)(d.b,{path:"/clone/:roleName"},Object(f.jsx)(U,{action:"clone"}))))))),v),()=>{Object(r.unmountComponentAtNode)(v)}}}}});var v=i(39)},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return c})),i.d(t,"d",(function(){return u}));var n=i(4);const s=97,r=2;function o(e,t){if(t&&t.color)return t.color;const i=c(e).codePointAt(0)||s;return n.VISUALIZATION_COLORS[i%n.VISUALIZATION_COLORS.length]}function a(e,t){if(t&&t.initials)return t.initials;const i=c(e).split(" "),n=Math.min(r,i.length);return i.splice(n,i.length),i.map((e=>e.substring(0,1))).join("")}function c(e){return e.full_name||e.email||e.username}function u(e){const t=c(e);return e.email&&e.email!==t?`${t} (${e.email})`:t}},function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return l})),i.d(t,"c",(function(){return d}));var n=i(2),s=i.n(n),r=i(15),o=i.n(r),a=i(0);const c=s.a.createContext(null),u=({children:e,...t})=>{const{navigateToUrl:i,currentAppId:n}=t;return Object(a.jsx)(c.Provider,{value:{navigateToUrl:i,currentAppId:n}},e)},l=({children:e,coreStart:t})=>{const{navigateToUrl:i,currentAppId$:n}=t.application,s=o()(n,void 0);return Object(a.jsx)(c.Provider,{value:{navigateToUrl:i,currentAppId:s}},e)};function d(){const e=Object(n.useContext)(c);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}},function(e,t,i){"use strict";i.r(t),i.d(t,"UserAPIClient",(function(){return UserAPIClient}));const n="/internal/security/users";class UserAPIClient{constructor(e){this.http=e}async getUsers(){return await this.http.get(n)}async getUser(e){return await this.http.get(`${n}/${encodeURIComponent(e)}`)}async deleteUser(e){await this.http.delete(`${n}/${encodeURIComponent(e)}`)}async saveUser(e){await this.http.post(`${n}/${encodeURIComponent(e.username)}`,{body:JSON.stringify(e)})}async changePassword(e,t,i){const s={newPassword:t};i&&(s.password=i),await this.http.post(`${n}/${encodeURIComponent(e)}/password`,{body:JSON.stringify(s)})}async disableUser(e){await this.http.post(`${n}/${encodeURIComponent(e)}/_disable`)}async enableUser(e){await this.http.post(`${n}/${encodeURIComponent(e)}/_enable`)}}},,function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(2),s=i(6),r=i.n(s),o=i(12),a=i(0);const c=(e,t)=>i=>(r.a.render(Object(a.jsx)(o.a,t,e),i),()=>r.a.unmountComponentAtNode(i));i(1),i(3),n.Component},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),s={};t.default=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];var o=[],a=[],c=function(e){var t=n.createContext(s);o.push(t),a.push(function(e){return function(){var t=n.useContext(e);return t}}(t))};i.length?i.forEach((function(e){return c(e.name)})):c(e.name);var u=function(t){for(var s=t.children,r=function(e,t){if(null==e)return{};var i,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||(s[i]=e[i]);return s}(t,["children"]),a=e(r),c=s,u=0;u<o.length;u+=1){var l=o[u],d=i[u]||function(e){return e};c=n.createElement(l.Provider,{value:d(a)},c)}return c};return[u].concat(a)}},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(22),s=i(2),r=n.__importDefault(i(47));t.default=function(e,t,i){void 0===t&&(t=[]),void 0===i&&(i={loading:!1});var o=s.useRef(0),a=r.default(),c=s.useState(i),u=c[0],l=c[1],d=s.useCallback((function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var s=++o.current;return l((function(e){return n.__assign(n.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return a()&&s===o.current&&l({value:e,loading:!1}),e}),(function(e){return a()&&s===o.current&&l({error:e,loading:!1}),e}))}),t);return[u,d]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(22),s=i(2),r=n.__importDefault(i(33));t.default=function(e,t){void 0===t&&(t=[]);var i=r.default(e,t,{loading:!0}),n=i[0],o=i[1];return s.useEffect((function(){o()}),[o]),n}},function(e,t){e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(10),s=i.n(n),r=i(2),o=i(26);var a=i(0);const c={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},u=({children:e,navigateToUrl:t,currentAppId:i,...n})=>{const o=Object(r.useRef)(null),u=Object(r.useCallback)((e=>(({event:e,container:t,navigateToUrl:i,currentAppId:n})=>{if(!t||!n)return;const s=((e,t)=>{let i=e;do{var n,s;if("a"===(null===(n=i)||void 0===n?void 0:n.tagName.toLowerCase()))return i;const e=null===(s=i)||void 0===s?void 0:s.parentElement;if(!e||e===document.body||e===t)break;i=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!s)return;const r=s.href,o=""===s.target||"_self"===s.target,a=0===e.button;r&&o&&a&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),i(s.href))})({event:e,currentAppId:i,navigateToUrl:t,container:o.current})),[i,t]);return Object(a.jsx)("div",s()({onClick:u,ref:o,css:c,"data-test-subj":"kbnRedirectAppLink"},n),e)},l=({children:e,...t})=>Object(a.jsx)(u,s()({},Object(o.c)(),t),e)},function(e,t,i){"use strict";i.d(t,"b",(function(){return p})),i.d(t,"a",(function(){return b}));var n=i(10),s=i.n(n),r=i(2),o=i.n(r),a=i(9);const c={services:{}},u=Object(r.createContext)(c);var l=i(42),d=i.n(l),h=i(0);const p=({children:e,component:t,render:i,...n})=>{const c=Object(r.useMemo)((()=>{if(t)return e=>Object(h.jsx)(o.a.Fragment,null,Object(h.jsx)(b,null),Object(h.jsx)(t,e))}),[t]);if(c)return Object(h.jsx)(a.Route,s()({},n,{component:c}));if(i||"function"==typeof e){const t="function"==typeof e?e:i;return Object(h.jsx)(a.Route,s()({},n,{render:e=>Object(h.jsx)(o.a.Fragment,null,Object(h.jsx)(b,null),t(e))}))}return Object(h.jsx)(a.Route,n,Object(h.jsx)(b,null),e)},b=()=>{const{executionContext:e}=Object(r.useContext)(u).services,t=Object(a.useRouteMatch)();return function(e,t){d()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(11);function s(e){const{services:t}=Object(n.useKibana)();return e?t.application.capabilities[e]:t.application.capabilities}},function(e,t,i){"use strict";i.r(t),i.d(t,"RolesAPIClient",(function(){return RolesAPIClient}));var n=i(1),s=i.n(n),r=i(21);class RolesAPIClient{constructor(e){s()(this,"getRoles",(async()=>await this.http.get("/api/security/role"))),s()(this,"getRole",(async e=>await this.http.get(`/api/security/role/${encodeURIComponent(e)}`))),s()(this,"deleteRole",(async e=>{await this.http.delete(`/api/security/role/${encodeURIComponent(e)}`)})),s()(this,"saveRole",(async({role:e,createOnly:t=!1})=>{await this.http.put(`/api/security/role/${encodeURIComponent(e.name)}`,{body:JSON.stringify(this.transformRoleForSave(Object(r.d)(e))),query:{createOnly:t}})})),s()(this,"transformRoleForSave",(e=>{var t,i;const n=e=>!("clusters"in e&&e.clusters&&e.clusters.length>0)&&0===e.names.length&&0===e.privileges.length;return e.elasticsearch.indices=e.elasticsearch.indices.filter((e=>!n(e))),e.elasticsearch.remote_indices=null===(t=e.elasticsearch.remote_indices)||void 0===t?void 0:t.filter((e=>!n(e))),e.elasticsearch.indices.forEach((e=>e.query||delete e.query)),null===(i=e.elasticsearch.remote_indices)||void 0===i||i.forEach((e=>e.query||delete e.query)),e.kibana.forEach((e=>{e.base.length>0&&(e.feature={})})),delete e.name,delete e.transient_metadata,delete e._unrecognized_applications,delete e._transform_error,e})),this.http=e}}},function(e,t){e.exports=__kbnSharedDeps__.ElasticEuiLibComponentsUseIsNestedEuiProvider},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var n=void 0;t.setEuiDevProviderWarning=function(e){return n=e},t.getEuiDevProviderWarning=function(){return n},t.emitEuiProviderWarning=function(e){if("function"==typeof n)return n(e);switch(n){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(22),s=i(49),r=n.__importDefault(i(51));t.default=function(e,t){r.default(e,t,s.isDeepEqual)}},,function(e,t,i){i(45),__kbnBundles__.define("plugin/security/public",i,52)},function(e,t,i){i.p=window.__kbnPublicPath__.security},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),s="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,i){e.exports=i(32)(3085)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=i(22).__importDefault(i(50));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},function(e,t,i){"use strict";e.exports=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var n,s,r;if(Array.isArray(t)){if((n=t.length)!=i.length)return!1;for(s=n;0!=s--;)if(!e(t[s],i[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((n=(r=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(i,r[s]))return!1;for(s=n;0!=s--;){var o=r[s];if(!("_owner"===o&&t.$$typeof||e(t[o],i[o])))return!1}return!0}return t!=t&&i!=i}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2);t.default=function(e,t,i){var s=n.useRef(void 0);s.current&&i(t,s.current)||(s.current=t),n.useEffect(e,s.current)}},function(e,t,i){"use strict";i.r(t),i.d(t,"ALL_SPACES_ID",(function(){return P.a})),i.d(t,"plugin",(function(){return be}));var n=i(1),s=i.n(n),r=i(3),o=i(2),a=i.n(o),c=i(6),u=i.n(c),l=i(11),d=i(12),h=i(29),p=i(71),b=i(62),f=i(14),g=i(7),v=i(0);const m=Object.freeze({id:"security_account",create({application:e,authc:t,getStartServices:n,securityApiClients:s}){e.register({id:this.id,title:r.i18n.translate("xpack.security.account.breadcrumb",{defaultMessage:"User settings"}),visibleIn:[],appRoute:"/security/account",async mount({element:e,history:r}){const[[o],{AccountManagementPage:a}]=await Promise.all([n(),Promise.all([i.e(0),i.e(3),i.e(8)]).then(i.bind(null,316))]);return Object(c.render)(Object(v.jsx)(y,{services:o,history:r,authc:t,securityApiClients:s},Object(v.jsx)(a,null)),e),()=>Object(c.unmountComponentAtNode)(e)}})}}),y=({services:e,history:t,authc:i,securityApiClients:n,onChange:s,children:r})=>Object(v.jsx)(d.a,e,Object(v.jsx)(l.KibanaContextProvider,{services:e},Object(v.jsx)(f.a,{authc:i},Object(v.jsx)(f.b,n,Object(v.jsx)(p.a,{history:t},Object(v.jsx)(g.b,{onChange:s},Object(v.jsx)(b.a,{core:e,security:{userProfiles:n.userProfiles},toMountPoint:h.a},r)))))));var j=i(16),_=i(5);class user_profile_api_client_UserProfileAPIClient{constructor(e){s()(this,"internalDataUpdates$",new _.Subject),s()(this,"dataUpdates$",this.internalDataUpdates$.asObservable()),s()(this,"_userProfile$",new _.BehaviorSubject(null)),s()(this,"_enabled$",new _.BehaviorSubject(!1)),s()(this,"_userProfileLoaded$",new _.BehaviorSubject(!1)),s()(this,"userProfile$",this._userProfile$.asObservable()),s()(this,"userProfileLoaded$",this._userProfileLoaded$.asObservable().pipe(Object(_.distinctUntilChanged)())),s()(this,"enabled$",void 0),this.http=e,this.enabled$=this.userProfileLoaded$.pipe(Object(_.skipWhile)((e=>!e)),Object(_.switchMap)((()=>this._enabled$.asObservable())),Object(_.distinctUntilChanged)())}start(){this.getCurrent({dataPath:"avatar,userSettings"}).catch((()=>{}))}getCurrent(e){return this.http.get("/internal/security/user_profile",{query:{dataPath:null==e?void 0:e.dataPath}}).then((e=>{var t;const i=null!==(t=null==e?void 0:e.data)&&void 0!==t?t:{},n=Object(j.merge)(this._userProfile$.getValue(),i);return this._userProfile$.next(n),this._enabled$.next(!0),this._userProfileLoaded$.next(!0),e})).catch((e=>{var t;const i=404===(null==e||null===(t=e.response)||void 0===t?void 0:t.status);return this._enabled$.next(!i),this._userProfileLoaded$.next(!0),Promise.reject(e)}))}bulkGet(e){return this.http.post("/internal/security/user_profile/_bulk_get",{body:JSON.stringify({...e,uids:[...e.uids]})})}suggest(e,t){return this.http.post(e,{body:JSON.stringify(t)})}update(e){const t=this._userProfile$.getValue();return this._userProfile$.next(e),this.http.post("/internal/security/user_profile/_data",{body:JSON.stringify(e)}).then((()=>{this.internalDataUpdates$.next(e)})).catch((e=>(this._userProfile$.next(t),Promise.reject(e))))}partialUpdate(e){const t=Object(j.merge)(this._userProfile$.getValue(),e);return this.update(t)}}var x=i(72);class analytics_service_AnalyticsService{constructor(){s()(this,"securityLicense",void 0),s()(this,"securityFeaturesSubscription",void 0)}setup({analytics:e,authc:t,cloudId:i,http:n,securityLicense:s}){this.securityLicense=s,!1===n.anonymousPaths.isAnonymous(window.location.pathname)&&function(e,t,i){e.registerContextProvider({name:"user_id",context$:Object(_.from)(t.getCurrentUser()).pipe(Object(_.map)((e=>e.elastic_cloud_user?{userId:e.username,isElasticCloudUser:!0}:{userId:i?`${i}:${e.username}`:e.username,isElasticCloudUser:!1})),Object(_.map)((({userId:e,isElasticCloudUser:t})=>{return{userId:(i=e,(new x.a).update(i,"utf8").digest("hex")),isElasticCloudUser:t};var i})),Object(_.catchError)((()=>Object(_.of)({userId:void 0,isElasticCloudUser:!1})))),schema:{userId:{type:"keyword",_meta:{description:"The user id scoped as seen by Cloud (hashed)",optional:!0}},isElasticCloudUser:{type:"boolean",_meta:{description:"`true` if the user is managed by ESS."}}}})}(e,t,i)}start({http:e}){this.securityFeaturesSubscription=this.securityLicense.features$.pipe(Object(_.filter)((({allowLogin:e})=>e)),Object(_.throttleTime)(5e3),Object(_.switchMap)((async()=>{try{await analytics_service_AnalyticsService.recordAuthTypeAnalytics(e)}catch{}}))).subscribe()}stop(){this.securityFeaturesSubscription&&(this.securityFeaturesSubscription.unsubscribe(),this.securityFeaturesSubscription=void 0)}static async recordAuthTypeAnalytics(e){localStorage.setItem(analytics_service_AnalyticsService.AuthTypeInfoStorageKey,JSON.stringify(await e.post("/internal/security/analytics/_record_auth_type",{body:localStorage.getItem(analytics_service_AnalyticsService.AuthTypeInfoStorageKey)})))}}s()(analytics_service_AnalyticsService,"AuthTypeInfoStorageKey","kibana.security.userAuthType");const O=Object.freeze({isEnabled:!1,accessURLParameters:null});class anonymous_access_service_AnonymousAccessService{constructor(){s()(this,"internalService",void 0)}setup({share:e}){e.setAnonymousAccessServiceProvider((()=>this.internalService))}start({http:e}){this.internalService={getCapabilities:()=>e.get("/internal/security/anonymous_access/capabilities"),getState:()=>e.anonymousPaths.isAnonymous(window.location.pathname)?Promise.resolve(O):e.get("/internal/security/anonymous_access/state").catch((()=>O))}}}const S=Object.freeze({id:"security_access_agreement",create({application:e,getStartServices:t}){e.register({id:this.id,title:r.i18n.translate("xpack.security.accessAgreementAppTitle",{defaultMessage:"Access Agreement"}),chromeless:!0,appRoute:"/security/access_agreement",async mount({element:e}){const[[n],{renderAccessAgreementPage:s}]=await Promise.all([t(),Promise.all([i.e(1),i.e(2),i.e(9)]).then(i.bind(null,300))]);return s(n,{element:e},{http:n.http,notifications:n.notifications,fatalErrors:n.fatalErrors})}})}});var P=i(8);const w=Object.freeze({id:"security_capture_url",create({application:e,fatalErrors:t,http:n}){n.anonymousPaths.register("/internal/security/capture-url"),e.register({id:this.id,title:"Capture URL",chromeless:!0,appRoute:"/internal/security/capture-url",async mount(){try{const{parseNextURL:e}=await Promise.resolve().then(i.t.bind(null,55,7)),t=new URL(e(window.location.href,n.basePath.serverBasePath),window.location.origin);t.searchParams.append(P.c,window.location.hash),window.location.replace(t.toString())}catch(e){t.add(new Error(`Cannot parse current URL: ${e&&e.message}.`))}return()=>{}}})}}),C=Object.freeze({id:"security_logged_out",create({application:e,http:t,getStartServices:n}){t.anonymousPaths.register("/security/logged_out"),e.register({id:this.id,title:r.i18n.translate("xpack.security.loggedOutAppTitle",{defaultMessage:"Logged out"}),chromeless:!0,appRoute:"/security/logged_out",async mount({element:e}){const[[t],{renderLoggedOutPage:s}]=await Promise.all([n(),Promise.all([i.e(1),i.e(16)]).then(i.bind(null,301))]);return s(t,{element:e},{basePath:t.http.basePath,customBranding:t.customBranding})}})}}),A=Object.freeze({id:"security_login",create({application:e,http:t,getStartServices:n,config:s}){t.anonymousPaths.register("/login"),e.register({id:this.id,title:r.i18n.translate("xpack.security.loginAppTitle",{defaultMessage:"Login"}),chromeless:!0,appRoute:"/login",async mount({element:e}){const[[t],{renderLoginPage:r}]=await Promise.all([n(),Promise.all([i.e(2),i.e(6)]).then(i.bind(null,312))]);return r(t,{element:e},{customBranding:t.customBranding,http:t.http,notifications:t.notifications,fatalErrors:t.fatalErrors,loginAssistanceMessage:s.loginAssistanceMessage,sameSiteCookies:s.sameSiteCookies})}})}}),E=Object.freeze({id:"security_logout",create({application:e,http:t}){t.anonymousPaths.register("/logout"),e.register({id:this.id,title:r.i18n.translate("xpack.security.logoutAppTitle",{defaultMessage:"Logout"}),chromeless:!0,appRoute:"/logout",mount:async()=>(window.sessionStorage.clear(),window.localStorage.removeItem(analytics_service_AnalyticsService.AuthTypeInfoStorageKey),window.location.href=t.basePath.prepend(`/api/security/logout${window.location.search}`),()=>{})})}}),k=Object.freeze({id:"security_overwritten_session",create({application:e,authc:t,getStartServices:n}){e.register({id:this.id,title:r.i18n.translate("xpack.security.overwrittenSessionAppTitle",{defaultMessage:"Overwritten Session"}),chromeless:!0,appRoute:"/security/overwritten_session",async mount({element:e}){const[[s],{renderOverwrittenSessionPage:r}]=await Promise.all([n(),Promise.all([i.e(1),i.e(17)]).then(i.bind(null,302))]);return r(s,{element:e},{authc:t,basePath:s.http.basePath})}})}});class authentication_service_AuthenticationService{setup({application:e,fatalErrors:t,config:i,getStartServices:n,http:s}){const r=async()=>await s.get("/internal/security/me",{asSystemRequest:!0});return S.create({application:e,getStartServices:n}),w.create({application:e,fatalErrors:t,http:s}),A.create({application:e,config:i,getStartServices:n,http:s}),E.create({application:e,http:s}),C.create({application:e,getStartServices:n,http:s}),k.create({application:e,authc:{getCurrentUser:r},getStartServices:n}),{getCurrentUser:r,areAPIKeysEnabled:async()=>(await s.get("/internal/security/api_key/_enabled")).apiKeysEnabled}}}var M=i(17),I=i(18);const R=Object.freeze({id:"api_keys",create({authc:e,getStartServices:t}){return{id:this.id,order:30,title:r.i18n.translate("xpack.security.management.apiKeysTitle",{defaultMessage:"API keys"}),async mount({element:n,setBreadcrumbs:s,history:o}){const[[a],{APIKeysGridPage:u}]=await Promise.all([t(),Promise.all([i.e(0),i.e(3),i.e(13)]).then(i.bind(null,310))]);return Object(c.render)(Object(v.jsx)(T,{services:a,history:o,authc:e,onChange:Object(g.c)(a.chrome,s)},Object(v.jsx)(g.a,{text:r.i18n.translate("xpack.security.management.apiKeysTitle",{defaultMessage:"API keys"}),href:"/"},Object(v.jsx)(u,null))),n),()=>{Object(c.unmountComponentAtNode)(n)}}}}}),T=({services:e,history:t,authc:i,onChange:n,children:s})=>Object(v.jsx)(d.a,e,Object(v.jsx)(l.KibanaContextProvider,{services:e},Object(v.jsx)(M.a,{authc:i},Object(v.jsx)(p.a,{history:t},Object(v.jsx)(I.a,{featureId:"api_keys",tooltip:r.i18n.translate("xpack.security.management.api_keys.readonlyTooltip",{defaultMessage:"Unable to create or edit API keys"})}),Object(v.jsx)(g.b,{onChange:n},s)))));var U=i(9),L=i(37),$=i(20);const F=Object.freeze({id:"role_mappings",create({getStartServices:e}){const t=r.i18n.translate("xpack.security.management.roleMappingsTitle",{defaultMessage:"Role Mappings"});return{id:this.id,order:40,title:t,async mount({element:n,setBreadcrumbs:s,history:o}){const[[a],{RoleMappingsGridPage:u},{EditRoleMappingPage:h},{RoleMappingsAPIClient:b},{RolesAPIClient:f},{SecurityFeaturesAPIClient:m}]=await Promise.all([e(),Promise.all([i.e(0),i.e(12)]).then(i.bind(null,313)),i.e(7).then(i.bind(null,309)),i.e(18).then(i.bind(null,303)),Promise.resolve().then(i.bind(null,24)),i.e(21).then(i.bind(null,318))]);a.chrome.docTitle.change(t);const y=new b(a.http),j=new m(a.http),_=({action:e})=>{const{name:t}=Object(U.useParams)(),i=t?Object($.a)(t):void 0,n="edit"===e&&t&&i?{text:i,href:`/edit/${encodeURIComponent(t)}`}:{text:r.i18n.translate("xpack.security.roleMappings.createBreadcrumb",{defaultMessage:"Create"})};return Object(v.jsx)(g.a,{text:n.text,href:n.href},Object(v.jsx)(h,{action:e,name:i,roleMappingsAPI:y,securityFeaturesAPI:j,rolesAPIClient:new f(a.http),notifications:a.notifications,docLinks:a.docLinks,history:o,readOnly:!a.application.capabilities.role_mappings.save}))};return Object(c.render)(Object(v.jsx)(d.a,a,Object(v.jsx)(l.KibanaContextProvider,{services:a},Object(v.jsx)(p.a,{history:o},Object(v.jsx)(I.a,{"data-test-subj":"readOnlyBadge",featureId:"role_mappings",tooltip:r.i18n.translate("xpack.security.management.roleMappings.readonlyTooltip",{defaultMessage:"Unable to create or edit role mappings"})}),Object(v.jsx)(g.b,{onChange:Object(g.c)(a.chrome,s)},Object(v.jsx)(g.a,{text:t,href:"/"},Object(v.jsx)(L.b,{path:["/",""],exact:!0},Object(v.jsx)(u,{notifications:a.notifications,rolesAPIClient:new f(a.http),roleMappingsAPI:y,securityFeaturesAPI:j,docLinks:a.docLinks,history:o,navigateToApp:a.application.navigateToApp,readOnly:!a.application.capabilities.role_mappings.save})),Object(v.jsx)(L.b,{path:"/edit/:name?"},Object(v.jsx)(_,{action:"edit"})),Object(v.jsx)(L.b,{path:"/clone/:name"},Object(v.jsx)(_,{action:"clone"}))))))),n),()=>{Object(c.unmountComponentAtNode)(n)}}}}});var D=i(24),z=i(23);class management_service_ManagementService{constructor(e){var t,i;s()(this,"license",void 0),s()(this,"licenseFeaturesSubscription",void 0),s()(this,"securitySection",void 0),s()(this,"userManagementEnabled",void 0),s()(this,"roleManagementEnabled",void 0),s()(this,"roleMappingManagementEnabled",void 0),this.userManagementEnabled=!1!==(null===(t=e.ui)||void 0===t?void 0:t.userManagementEnabled),this.roleManagementEnabled=!1!==e.roleManagementEnabled,this.roleMappingManagementEnabled=!1!==(null===(i=e.ui)||void 0===i?void 0:i.roleMappingManagementEnabled)}setup({getStartServices:e,management:t,authc:i,license:n,fatalErrors:s,buildFlavor:r}){this.license=n,this.securitySection=t.sections.section.security,this.userManagementEnabled&&this.securitySection.registerApp(z.usersManagementApp.create({authc:i,getStartServices:e})),this.roleManagementEnabled&&this.securitySection.registerApp(D.rolesManagementApp.create({fatalErrors:s,license:n,getStartServices:e,buildFlavor:r})),this.securitySection.registerApp(R.create({authc:i,getStartServices:e})),this.roleMappingManagementEnabled&&this.securitySection.registerApp(F.create({getStartServices:e}))}start({capabilities:e}){this.licenseFeaturesSubscription=this.license.features$.subscribe((t=>{const i=this.securitySection,n=[[i.getApp(R.id),t.showLinks]];this.userManagementEnabled&&n.push([i.getApp(z.usersManagementApp.id),t.showLinks]),this.roleManagementEnabled&&n.push([i.getApp(D.rolesManagementApp.id),t.showLinks]),this.roleMappingManagementEnabled&&n.push([i.getApp(F.id),t.showLinks&&t.showRoleMappingsManagement]);for(const[t,i]of n)!0===e.management.security[t.id]?t.enabled!==i&&(i?t.enable():t.disable()):t.disable()}))}stop(){this.licenseFeaturesSubscription&&(this.licenseFeaturesSubscription.unsubscribe(),this.licenseFeaturesSubscription=void 0)}}var B=i(27);class authorization_service_AuthorizationService{setup({config:e,http:t}){const i=new D.RolesAPIClient(t);return{isRoleManagementEnabled:()=>e.roleManagementEnabled,roles:{getRoles:i.getRoles,getRole:i.getRole,deleteRole:i.deleteRole,saveRole:i.saveRole}}}}var N=i(36),K=i(26);const V=({children:e,...t})=>{if(void 0!==t.coreStart){const{coreStart:i,...n}=t,s=Object(v.jsx)(N.a,n,e);return Object(v.jsx)(K.a,{coreStart:i},s)}const{navigateToUrl:i,currentAppId:n,...s}=t,r=Object(v.jsx)(N.a,s,e);return Object(v.jsx)(K.b,{currentAppId:n,navigateToUrl:i},r)};var W=i(4),q=i(15),H=i.n(q),G=i(13),J=i(63),Z=i(21);const Y=({items:e})=>Object(v.jsx)(a.a.Fragment,null,Object(v.jsx)(W.EuiContextMenuPanel,null,e.map(((e,t)=>e.content?Object(v.jsx)(o.Fragment,{key:t},e.content):Object(v.jsx)(W.EuiContextMenuItem,{key:t,icon:e.icon,size:"s",href:e.href,"data-test-subj":e["data-test-subj"]},e.name))))),X=({editProfileUrl:e,logoutUrl:t,userMenuLinks$:i,buildFlavour:n})=>{const s=H()(i,[]),[a,c]=Object(o.useState)(!1),u=Object(f.e)("avatar,userSettings"),l=Object(f.c)(),d=l.value?Object(Z.h)(l.value):"",h=Object(v.jsx)(W.EuiHeaderSectionItemButton,{"aria-controls":"headerUserMenu","aria-expanded":a,"aria-haspopup":"true","aria-label":r.i18n.translate("xpack.security.navControlComponent.accountMenuAriaLabel",{defaultMessage:"Account menu"}),onClick:()=>c((e=>!!l.value&&!e)),"data-test-subj":"userMenuButton",style:{lineHeight:"normal"}},u.value?Object(v.jsx)(J.a,{user:u.value.user,avatar:u.value.data.avatar,size:"s","data-test-subj":"userMenuAvatar"}):l.value&&u.error?Object(v.jsx)(J.a,{user:l.value,size:"s","data-test-subj":"userMenuAvatar"}):Object(v.jsx)(W.EuiLoadingSpinner,{size:"m"})),p=[];if(s.length){const e=s.sort((({order:e=1/0},{order:t=1/0})=>e-t)).map((({label:e,iconType:t,href:i,content:n})=>({name:e,icon:Object(v.jsx)(W.EuiIcon,{type:t,size:"m"}),href:i,"data-test-subj":`userMenuLink__${e}`,content:n})));p.push(...e)}const b=!!l.value&&Object(Z.p)(l.value),g=s.some((({setAsProfile:e})=>!0===e));if(!b&&!g){const t={name:Object(v.jsx)(G.FormattedMessage,{id:"xpack.security.navControlComponent.editProfileLinkText",defaultMessage:"Edit profile"}),icon:Object(v.jsx)(W.EuiIcon,{type:"user",size:"m"}),href:e,onClick:()=>{c(!1)},"data-test-subj":"profileLink"};p.unshift(t)}return p.push({name:b?Object(v.jsx)(G.FormattedMessage,{id:"xpack.security.navControlComponent.loginLinkText",defaultMessage:"Log in"}):"serverless"===n?Object(v.jsx)(G.FormattedMessage,{id:"xpack.security.navControlComponent.closeProjectLinkText",defaultMessage:"Close project"}):Object(v.jsx)(G.FormattedMessage,{id:"xpack.security.navControlComponent.logoutLinkText",defaultMessage:"Log out"}),icon:Object(v.jsx)(W.EuiIcon,{type:"exit",size:"m"}),href:t,"data-test-subj":"logoutLink"}),Object(v.jsx)(W.EuiPopover,{id:"headerUserMenu",ownFocus:!0,button:h,isOpen:a,anchorPosition:"downRight",repositionOnScroll:!0,closePopover:()=>c(!1),panelPaddingSize:"none",buffer:0},Object(v.jsx)(W.EuiContextMenu,{className:"chrNavControl__userMenu",initialPanelId:0,panels:[{id:0,title:d,content:Object(v.jsx)(Y,{items:p})}],"data-test-subj":"userMenu"}))};class nav_control_service_SecurityNavControlService{constructor(e){s()(this,"securityLicense",void 0),s()(this,"logoutUrl",void 0),s()(this,"securityApiClients",void 0),s()(this,"navControlRegistered",void 0),s()(this,"securityFeaturesSubscription",void 0),s()(this,"stop$",new _.ReplaySubject(1)),s()(this,"userMenuLinks$",new _.BehaviorSubject([])),this.buildFlavor=e}setup({securityLicense:e,logoutUrl:t,securityApiClients:i}){this.securityLicense=e,this.logoutUrl=t,this.securityApiClients=i}start({core:e,authc:t}){return this.securityFeaturesSubscription=this.securityLicense.features$.subscribe((({showLinks:i})=>{!e.http.anonymousPaths.isAnonymous(window.location.pathname)&&i&&!this.navControlRegistered&&this.registerSecurityNavControl(e,t)})),{getUserMenuLinks$:()=>this.userMenuLinks$.pipe(Object(_.map)(this.sortUserMenuLinks),Object(_.takeUntil)(this.stop$)),addUserMenuLinks:e=>{const t=this.userMenuLinks$.value,i=t.find((({setAsProfile:e})=>!0===e)),n=e.filter((({setAsProfile:e})=>!0===e)).length;if(i&&n>0)throw new Error(`Only one custom profile link can be set. A custom profile link named ${i.label} (${i.href}) already exists`);if(n>1)throw new Error(`Only one custom profile link can be passed at a time (found ${n})`);const s=[...t,...e];this.userMenuLinks$.next(s)}}}stop(){this.securityFeaturesSubscription&&(this.securityFeaturesSubscription.unsubscribe(),this.securityFeaturesSubscription=void 0),this.navControlRegistered=!1,this.stop$.next()}registerSecurityNavControl(e,t){e.chrome.navControls.registerRight({order:4e3,mount:i=>(u.a.render(Object(v.jsx)(Q,{services:e,authc:t,securityApiClients:this.securityApiClients},Object(v.jsx)(X,{editProfileUrl:e.http.basePath.prepend("/security/account"),logoutUrl:this.logoutUrl,userMenuLinks$:this.userMenuLinks$,buildFlavour:this.buildFlavor})),i),()=>u.a.unmountComponentAtNode(i))}),this.navControlRegistered=!0}sortUserMenuLinks(e){return Object(j.sortBy)(e,"order")}}const Q=({authc:e,services:t,securityApiClients:i,children:n})=>Object(v.jsx)(d.a,t,Object(v.jsx)(l.KibanaContextProvider,{services:t},Object(v.jsx)(f.a,{authc:e},Object(v.jsx)(f.b,i,Object(v.jsx)(V,{coreStart:t},n))))),ee=r.i18n.translate("xpack.security.checkup.insecureClusterTitle",{defaultMessage:"Your data is not secure"}),te=Object.freeze({displayAlert:!1});class security_checkup_service_SecurityCheckupService{constructor(e,t){s()(this,"enabled",void 0),s()(this,"alertVisibility$",void 0),s()(this,"storage",void 0),s()(this,"alertToast",void 0),s()(this,"storageKey",void 0),this.storage=t,this.enabled=e.showInsecureClusterWarning,this.alertVisibility$=new _.BehaviorSubject(this.enabled)}setup({http:e}){const t=e.basePath.serverBasePath;this.storageKey=`insecureClusterWarningVisibility${t}`,this.enabled=this.enabled&&this.getPersistedVisibilityPreference(),this.alertVisibility$.next(this.enabled)}start(e){this.enabled&&this.initializeAlert(e)}initializeAlert({http:e,notifications:t,...i}){const n=Object(_.from)(this.getSecurityCheckupState(e));Object(_.combineLatest)([n,this.alertVisibility$]).pipe(Object(_.map)((([{displayAlert:e},t])=>e&&t)),Object(_.distinctUntilChanged)()).subscribe((e=>{var n,s;e&&!this.alertToast?this.alertToast=t.toasts.addWarning({title:ee,text:(n=i,s=e=>this.setAlertVisibility(!1,e),e=>{const{docLinks:t,...i}=n;return Object(c.render)(Object(v.jsx)((()=>{const[e,n]=Object(o.useState)(!1),a=`${t.links.security.elasticsearchEnableSecurity}?blade=kibanasecuritymessage`;return Object(v.jsx)(d.a,i,Object(v.jsx)("div",{"data-test-subj":"insecureClusterAlertText"},Object(v.jsx)(W.EuiText,{size:"s"},Object(v.jsx)(G.FormattedMessage,{id:"xpack.security.checkup.insecureClusterMessage",defaultMessage:"Don’t lose one bit. Enable our free security features."})),Object(v.jsx)(W.EuiSpacer,null),Object(v.jsx)(W.EuiCheckbox,{id:"persistDismissedAlertPreference",checked:e,onChange:e=>n(e.target.checked),label:r.i18n.translate("xpack.security.checkup.dontShowAgain",{defaultMessage:"Don't show again"})}),Object(v.jsx)(W.EuiSpacer,null),Object(v.jsx)(W.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(v.jsx)(W.EuiFlexItem,{grow:!1},Object(v.jsx)(W.EuiButton,{size:"s",color:"primary",fill:!0,href:a,target:"_blank","data-test-subj":"learnMoreButton"},r.i18n.translate("xpack.security.checkup.enableButtonText",{defaultMessage:"Enable security"}))),Object(v.jsx)(W.EuiFlexItem,{grow:!1},Object(v.jsx)(W.EuiButton,{size:"s",onClick:()=>s(e),"data-test-subj":"dismissAlertButton"},r.i18n.translate("xpack.security.checkup.dismissButtonText",{defaultMessage:"Dismiss"}))))))}),null),e),()=>Object(c.unmountComponentAtNode)(e)}),iconType:"warning"},{toastLifeTimeMs:864e6}):!e&&this.alertToast&&(t.toasts.remove(this.alertToast),this.alertToast=void 0)}))}getSecurityCheckupState(e){return e.anonymousPaths.isAnonymous(window.location.pathname)?Promise.resolve(te):e.get("/internal/security/security_checkup/state").catch((()=>te))}setAlertVisibility(e,t){this.enabled&&(this.alertVisibility$.next(e),t&&this.setPersistedVisibilityPreference(e))}getPersistedVisibilityPreference(){var e;const t=null!==(e=this.storage.getItem(this.storageKey))&&void 0!==e?e:"{}";try{const{show:e=!0}=JSON.parse(t);return e}catch(e){return!0}}setPersistedVisibilityPreference(e){this.storage.setItem(this.storageKey,JSON.stringify({show:e}))}}class session_expired_SessionExpired{constructor(e,t,i){this.application=e,this.logoutUrl=t,this.tenant=i}logout(e){const t=(()=>{const{location:e}=window,t=encodeURIComponent(`${e.pathname}${e.search}${e.hash}`);return`&${P.i}=${t}`})(),i=(e=>{const t=`${this.tenant}/session_provider`,i=sessionStorage.getItem(t);return i?`&${P.e}=${encodeURIComponent(i)}`:""})();this.application.navigateToUrl(`${this.logoutUrl}?${P.f}=${e}${t}${i}`,{forceRedirect:!0,skipAppLeave:!0})}}var ie=i(33),ne=i.n(ie);const se=({sessionState$:e,onExtend:t})=>{const i=H()(e),[{loading:n},s]=ne()(t);if(!i||!i.expiresInMs)return null;const r=Math.max(i.expiresInMs-P.n,0)/1e3,o=Object(v.jsx)(G.FormattedMessage,{id:"xpack.security.sessionExpirationToast.body",defaultMessage:"You will be logged out {timeout}.",values:{timeout:Object(v.jsx)(G.FormattedRelativeTime,{value:r})}});return i.canBeExtended?Object(v.jsx)(a.a.Fragment,null,o,Object(v.jsx)(W.EuiSpacer,{size:"m"}),Object(v.jsx)(W.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(v.jsx)(W.EuiFlexItem,{grow:!1},Object(v.jsx)(W.EuiButton,{size:"s",color:"warning",isLoading:n,onClick:s},Object(v.jsx)(G.FormattedMessage,{id:"xpack.security.sessionExpirationToast.extendButton",defaultMessage:"Stay logged in"}))))):o};let re=function(e){return e.SESSION_EXPIRED="SESSION_EXPIRED",e.CONCURRENCY_LIMIT="CONCURRENCY_LIMIT",e.AUTHENTICATION_ERROR="AUTHENTICATION_ERROR",e.LOGGED_OUT="LOGGED_OUT",e.UNAUTHENTICATED="UNAUTHENTICATED",e}({});class session_timeout_SessionTimeout{constructor(e,t,i,n,o){s()(this,"channel",void 0),s()(this,"isVisible","hidden"!==document.visibilityState),s()(this,"isFetchingSessionInfo",!1),s()(this,"consecutiveErrorCount",0),s()(this,"snoozedWarningState",void 0),s()(this,"sessionState$",new _.BehaviorSubject({lastExtensionTime:0,expiresInMs:null,canBeExtended:!1})),s()(this,"subscription",void 0),s()(this,"warningToast",void 0),s()(this,"stopActivityMonitor",void 0),s()(this,"stopVisibilityMonitor",void 0),s()(this,"removeHttpInterceptor",void 0),s()(this,"stopRefreshTimer",void 0),s()(this,"stopWarningTimer",void 0),s()(this,"stopLogoutTimer",void 0),s()(this,"handleChannelMessage",(e=>{this.isSessionState(e.data)&&this.sessionState$.next(e.data)})),s()(this,"isSessionState",(e=>"object"==typeof e&&Object.hasOwn(null!=e?e:{},"canBeExtended"))),s()(this,"handleHttpRequest",(e=>{if(-1===e.path.indexOf("://")&&!e.path.startsWith("//"))return e.asSystemRequest?void 0:{...e,asSystemRequest:!this.isVisible}})),s()(this,"handleUserActivity",(()=>{this.shouldExtend()&&this.fetchSessionInfo(!0)})),s()(this,"handleVisibilityChange",(e=>{this.isVisible=e,e&&this.handleUserActivity()})),s()(this,"resetTimers",(({lastExtensionTime:e,expiresInMs:t})=>{var i,n,s;if(this.stopRefreshTimer=null===(i=this.stopRefreshTimer)||void 0===i?void 0:i.call(this),this.stopWarningTimer=null===(n=this.stopWarningTimer)||void 0===n?void 0:n.call(this),this.stopLogoutTimer=null===(s=this.stopLogoutTimer)||void 0===s?void 0:s.call(this),null!==t){const i=Math.max(t-P.n,0),n=Math.max(i-P.l,this.snoozedWarningState?this.snoozedWarningState.lastExtensionTime+this.snoozedWarningState.expiresInMs-P.n-e:0,0),s=n-P.j;this.stopLogoutTimer=oe((()=>this.sessionExpired.logout(re.SESSION_EXPIRED)),i),n>0&&this.hideWarning(),n<i&&(this.stopWarningTimer=oe(this.showWarning,n)),s>0&&s<i&&(this.stopRefreshTimer=oe(this.fetchSessionInfo,s))}})),s()(this,"toggleEventHandlers",(({expiresInMs:e,canBeExtended:t})=>{var i,n,s;null!==e?(t&&!this.stopActivityMonitor&&(this.stopActivityMonitor=function(e){const t=["mousemove","mousedown","wheel","touchstart","keydown"];for(const i of t)window.addEventListener(i,e);return()=>{for(const i of t)window.removeEventListener(i,e)}}(this.handleUserActivity)),this.removeHttpInterceptor||(this.removeHttpInterceptor=this.http.intercept({request:this.handleHttpRequest})),this.stopVisibilityMonitor||(this.stopVisibilityMonitor=function(e){const t=()=>e("hidden"!==document.visibilityState);return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}}(this.handleVisibilityChange))):(this.removeHttpInterceptor=null===(i=this.removeHttpInterceptor)||void 0===i?void 0:i.call(this),this.stopActivityMonitor=null===(n=this.stopActivityMonitor)||void 0===n?void 0:n.call(this),this.stopVisibilityMonitor=null===(s=this.stopVisibilityMonitor)||void 0===s?void 0:s.call(this))})),s()(this,"fetchSessionInfo",(async(e=!1)=>{this.isFetchingSessionInfo=!0;try{const t=await this.http.fetch(P.o,{method:e?"POST":"GET",asSystemRequest:!e});if(this.consecutiveErrorCount=0,t){const{expiresInMs:e,canBeExtended:i}=t,n={lastExtensionTime:Date.now(),expiresInMs:e,canBeExtended:i};return this.sessionState$.next(n),this.channel&&this.channel.postMessage(n),n}}catch(e){this.consecutiveErrorCount++}finally{this.isFetchingSessionInfo=!1}})),s()(this,"showWarning",(()=>{if(!this.warningToast){const e=async()=>{const{canBeExtended:e}=this.sessionState$.getValue();e&&await this.fetchSessionInfo(!0)},t=()=>(this.hideWarning(!0),e()),i=((e,t,i,n)=>({color:"warning",iconType:"clock",title:r.i18n.translate("xpack.security.sessionExpirationToast.title",{defaultMessage:"Session timeout"}),text:Object(h.a)(Object(v.jsx)(se,{sessionState$:t,onExtend:i}),e),onClose:n,toastLifeTimeMs:2147483647}))(this.startServices,this.sessionState$,e,t);this.warningToast=this.notifications.toasts.add(i)}})),s()(this,"hideWarning",((e=!1)=>{this.warningToast&&(this.notifications.toasts.remove(this.warningToast),this.warningToast=void 0,e&&(this.snoozedWarningState=this.sessionState$.getValue()))})),this.startServices=e,this.notifications=t,this.sessionExpired=i,this.http=n,this.tenant=o}async start(){if(!this.http.anonymousPaths.isAnonymous(window.location.pathname)){this.subscription=this.sessionState$.pipe(Object(_.skip)(1),Object(_.throttleTime)(1e3),Object(_.tap)(this.toggleEventHandlers)).subscribe(this.resetTimers);try{this.channel=new BroadcastChannel(`${this.tenant}/session_timeout`),this.channel.onmessage=e=>this.handleChannelMessage(e)}catch(e){console.warn("Failed to load broadcast channel. Session management will not be kept in sync when multiple tabs are loaded.",e)}return this.fetchSessionInfo()}}stop(){var e,t;const i={lastExtensionTime:0,expiresInMs:null,canBeExtended:!1};this.toggleEventHandlers(i),this.resetTimers(i),null===(e=this.subscription)||void 0===e||e.unsubscribe(),null===(t=this.channel)||void 0===t||t.close()}shouldExtend(){const{lastExtensionTime:e}=this.sessionState$.getValue();return!this.isFetchingSessionInfo&&!this.warningToast&&Date.now()>e+P.m*Math.exp(this.consecutiveErrorCount)}}function oe(e,t,i){var n;const s=2147483647;let r;return(i=null!==(n=i)&&void 0!==n?n:e=>r=e)(t>s?window.setTimeout((()=>oe(e,t-s,i)),s):window.setTimeout(e,t)),()=>clearTimeout(r)}class unauthorized_response_http_interceptor_UnauthorizedResponseHttpInterceptor{constructor(e,t){this.sessionExpired=e,this.anonymousPaths=t}responseError(e,t){if(this.anonymousPaths.isAnonymous(window.location.pathname))return;if("omit"===e.request.credentials)return;const{response:i}=e;if(i&&401===i.status){const e=i.headers.get(P.k);this.sessionExpired.logout(e===re.SESSION_EXPIRED||e===re.CONCURRENCY_LIMIT?e:re.AUTHENTICATION_ERROR),t.halt()}}}var ae=i(10),ce=i.n(ae);class suspense_error_boundary_SuspenseErrorBoundary extends o.Component{constructor(...e){super(...e),s()(this,"state",{error:null})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e){const{notifications:t}=this.props;if(t){const i=r.i18n.translate("xpack.security.uiApi.errorBoundaryToastTitle",{defaultMessage:"Failed to load Kibana asset"}),n=r.i18n.translate("xpack.security.uiApi.errorBoundaryToastMessage",{defaultMessage:"Reload page to continue."});t.toasts.addError(e,{title:i,toastMessage:n})}}render(){const{children:e,notifications:t}=this.props,{error:i}=this.state;return!t||i?null:Object(v.jsx)(o.Suspense,{fallback:Object(v.jsx)(W.EuiLoadingSpinner,null)},e)}}const ue=({fn:e,core:t,props:i})=>{const{notifications:n}=t,s=Object(o.useMemo)((()=>Object(o.lazy)((()=>e().then((e=>({default:e})))))),[e]);return n?Object(v.jsx)(suspense_error_boundary_SuspenseErrorBoundary,{notifications:n},Object(v.jsx)(s,i)):null},le=async()=>{const{PersonalInfo:e}=await i.e(22).then(i.bind(null,307));return t=>Object(v.jsx)(e,t)},de=({core:e})=>{function t(t){return i=>Object(v.jsx)(ue,{fn:t,core:e,props:i})}return{getPersonalInfo:t(le),getChangePassword:t((()=>(async e=>{const{ChangePassword:t}=await i.e(15).then(i.bind(null,306));return i=>Object(v.jsx)(t,ce()({notifications:e.notifications,userAPIClient:new z.UserAPIClient(e.http)},i))})(e)))}},he=({core:e})=>({components:de({core:e})});class license_service_SecurityLicenseService{constructor(){s()(this,"licenseSubscription",void 0)}setup({license$:e}){let t;return this.licenseSubscription=e.subscribe((e=>{t=e})),{license:Object.freeze({isLicenseAvailable:()=>{var e,i;return null!==(e=null===(i=t)||void 0===i?void 0:i.isAvailable)&&void 0!==e&&e},getLicenseType:()=>{var e,i;return null!==(e=null===(i=t)||void 0===i?void 0:i.type)&&void 0!==e?e:void 0},getUnavailableReason:()=>{var e;return null===(e=t)||void 0===e?void 0:e.getUnavailableReason()},isEnabled:()=>this.isSecurityEnabledFromRawLicense(t),hasAtLeast:e=>{var i;return null===(i=t)||void 0===i?void 0:i.hasAtLeast(e)},getFeatures:()=>this.calculateFeaturesFromRawLicense(t),features$:e.pipe(Object(_.map)((e=>this.calculateFeaturesFromRawLicense(e))))})}}stop(){this.licenseSubscription&&(this.licenseSubscription.unsubscribe(),this.licenseSubscription=void 0)}isSecurityEnabledFromRawLicense(e){if(!e)return!1;const t=e.getFeature("security");return void 0!==t&&t.isAvailable&&t.isEnabled}calculateFeaturesFromRawLicense(e){if(null==e||!e.isAvailable)return{showLogin:!0,allowLogin:!1,showLinks:!1,showRoleMappingsManagement:!1,allowAccessAgreement:!1,allowAuditLogging:!1,allowRoleDocumentLevelSecurity:!1,allowRoleFieldLevelSecurity:!1,allowRoleRemoteIndexPrivileges:!1,allowRemoteClusterPrivileges:!1,allowRbac:!1,allowSubFeaturePrivileges:!1,allowUserProfileCollaboration:!1,allowFips:!1,layout:void 0===e||null!=e&&e.isAvailable?"error-es-unavailable":"error-xpack-unavailable"};if(!this.isSecurityEnabledFromRawLicense(e))return{showLogin:!1,allowLogin:!1,showLinks:!1,showRoleMappingsManagement:!1,allowAccessAgreement:!1,allowAuditLogging:!1,allowRoleDocumentLevelSecurity:!1,allowRoleFieldLevelSecurity:!1,allowRoleRemoteIndexPrivileges:!1,allowRemoteClusterPrivileges:!1,allowRbac:!1,allowSubFeaturePrivileges:!1,allowUserProfileCollaboration:!1,allowFips:!1};const t=e.hasAtLeast("standard"),i=e.hasAtLeast("gold"),n=e.hasAtLeast("platinum");return{showLogin:!0,allowLogin:!0,showLinks:!0,showRoleMappingsManagement:i,allowAccessAgreement:i,allowAuditLogging:i,allowSubFeaturePrivileges:i,allowRoleDocumentLevelSecurity:n,allowRoleFieldLevelSecurity:n,allowRoleRemoteIndexPrivileges:n,allowRemoteClusterPrivileges:n,allowRbac:!0,allowUserProfileCollaboration:t,allowFips:n}}}class plugin_SecurityPlugin{constructor(e){s()(this,"config",void 0),s()(this,"sessionTimeout",void 0),s()(this,"authenticationService",new authentication_service_AuthenticationService),s()(this,"authorizationService",new authorization_service_AuthorizationService),s()(this,"navControlService",void 0),s()(this,"securityLicenseService",new license_service_SecurityLicenseService),s()(this,"managementService",void 0),s()(this,"securityCheckupService",void 0),s()(this,"anonymousAccessService",new anonymous_access_service_AnonymousAccessService),s()(this,"analyticsService",new analytics_service_AnalyticsService),s()(this,"authc",void 0),s()(this,"authz",void 0),s()(this,"securityApiClients",void 0),s()(this,"buildFlavor",void 0),this.initializerContext=e,this.buildFlavor=e.env.packageInfo.buildFlavor,this.config=this.initializerContext.config.get(),this.securityCheckupService=new security_checkup_service_SecurityCheckupService(this.config,localStorage),this.navControlService=new nav_control_service_SecurityNavControlService(this.buildFlavor),this.managementService=new management_service_ManagementService(this.config)}setup(e,{cloud:t,home:i,licensing:n,management:s,share:o}){const{license:a}=this.securityLicenseService.setup({license$:n.license$});return this.securityCheckupService.setup({http:e.http}),this.authc=this.authenticationService.setup({application:e.application,fatalErrors:e.fatalErrors,config:this.config,getStartServices:e.getStartServices,http:e.http}),this.authz=this.authorizationService.setup({config:this.config,http:e.http}),this.securityApiClients={userProfiles:new user_profile_api_client_UserProfileAPIClient(e.http),users:new B.UserAPIClient(e.http)},this.navControlService.setup({securityLicense:a,logoutUrl:pe(e.http),securityApiClients:this.securityApiClients}),this.analyticsService.setup({analytics:e.analytics,authc:this.authc,cloudId:null==t?void 0:t.cloudId,http:e.http,securityLicense:a}),m.create({authc:this.authc,application:e.application,getStartServices:e.getStartServices,securityApiClients:this.securityApiClients}),e.security.registerSecurityDelegate((({authc:e})=>({authc:{getCurrentUser:()=>e.getCurrentUser()}}))({authc:this.authc})),e.userProfile.registerUserProfileDelegate((({userProfile:e})=>e)({userProfile:this.securityApiClients.userProfiles})),s&&this.managementService.setup({license:a,management:s,authc:this.authc,fatalErrors:e.fatalErrors,getStartServices:e.getStartServices,buildFlavor:this.buildFlavor}),s&&i&&i.featureCatalogue.register({id:"security",title:r.i18n.translate("xpack.security.registerFeature.securitySettingsTitle",{defaultMessage:"Manage permissions"}),description:r.i18n.translate("xpack.security.registerFeature.securitySettingsDescription",{defaultMessage:"Control who has access and what tasks they can perform."}),icon:"securityApp",path:"/app/management/security/roles",showOnHomePage:!0,category:"admin",order:600}),o&&this.anonymousAccessService.setup({share:o}),{authc:this.authc,authz:this.authz,license:a}}start(e,{management:t,share:i}){const{application:n,http:s,notifications:r}=e,{anonymousPaths:o}=s,a=pe(s),c=s.basePath.serverBasePath,u=new session_expired_SessionExpired(n,a,c);return s.intercept(new unauthorized_response_http_interceptor_UnauthorizedResponseHttpInterceptor(u,o)),this.sessionTimeout=new session_timeout_SessionTimeout(e,r,u,s,c),this.sessionTimeout.start(),this.securityCheckupService.start(e),this.securityApiClients.userProfiles.start(),t&&this.managementService.start({capabilities:n.capabilities}),i&&this.anonymousAccessService.start({http:s}),this.analyticsService.start({http:e.http}),{uiApi:he({core:e}),navControlService:this.navControlService.start({core:e,authc:this.authc}),authc:this.authc,authz:this.authz,userProfiles:{getCurrent:this.securityApiClients.userProfiles.getCurrent.bind(this.securityApiClients.userProfiles),bulkGet:this.securityApiClients.userProfiles.bulkGet.bind(this.securityApiClients.userProfiles),suggest:this.securityApiClients.userProfiles.suggest.bind(this.securityApiClients.userProfiles),update:this.securityApiClients.userProfiles.update.bind(this.securityApiClients.userProfiles),partialUpdate:this.securityApiClients.userProfiles.partialUpdate.bind(this.securityApiClients.userProfiles),userProfile$:this.securityApiClients.userProfiles.userProfile$,userProfileLoaded$:this.securityApiClients.userProfiles.userProfileLoaded$,enabled$:this.securityApiClients.userProfiles.enabled$}}}stop(){var e;null===(e=this.sessionTimeout)||void 0===e||e.stop(),this.navControlService.stop(),this.securityLicenseService.stop(),this.managementService.stop(),this.analyticsService.stop()}}function pe(e){return`${e.basePath.serverBasePath}/logout`}const be=e=>new plugin_SecurityPlugin(e)},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t){e.exports=__kbnSharedDeps__.KbnUiTheme},function(e,t){e.exports=__kbnSharedDeps__.KbnStd},function(e,t){e.exports=__kbnSharedDeps__.KbnCodeEditor},,function(e,t){e.exports=__kbnSharedDeps__.SaferLodashSet},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/spaces/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/features/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return u}));var n=i(2),s=i.n(n),r=i(0);const o=s.a.createContext(null),a=({children:e,...t})=>Object(r.jsx)(o.Provider,{value:t},e),c=({children:e,...t})=>{const{core:{notifications:i,i18n:n,theme:s},security:{userProfiles:o},toMountPoint:c}=t;return Object(r.jsx)(a,{userProfileApiClient:o,notifySuccess:({title:e,text:t},r)=>{const o={};null!=r&&r.durationMs&&(o.toastLifeTimeMs=r.durationMs),i.toasts.addSuccess({title:e,text:t?c(t,{i18n:n,theme:s}):void 0},o)}},e)};function u(){const e=Object(n.useContext)(o);if(!e)throw new Error("UserProfilesContext is missing. Ensure your component or React root is wrapped with <UserProfilesProvider /> or <UserProfilesKibanaProvider />.");return e}},function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(10),s=i.n(n),r=i(4),o=(i(2),i(25)),a=i(0);const c=({user:e,avatar:t,...i})=>{const{euiTheme:n}=Object(r.useEuiTheme)();if(!e)return Object(a.jsx)(r.EuiAvatar,s()({name:"",color:n.colors.lightestShade,initials:"?"},i));const c=Object(o.d)(e);return null!=t&&t.imageUrl?Object(a.jsx)(r.EuiAvatar,s()({name:c,imageUrl:t.imageUrl,color:"plain"},i)):Object(a.jsx)(r.EuiAvatar,s()({name:c,initials:Object(o.c)(e,t),initialsLength:o.a,color:Object(o.b)(e,t)},i))}},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t){e.exports=__kbnSharedDeps__.KbnMonaco},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/remoteClusters/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/spaces/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},,,function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i(2);var n=i(9),s=i(19),r=i(0);const o=({children:e,...t})=>Object(r.jsx)(n.Router,t,Object(r.jsx)(s.CompatRouter,null,e))},function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return Sha256}));var n=i(1),s=i.n(n);const r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);class Sha256{constructor(){s()(this,"_a",void 0),s()(this,"_b",void 0),s()(this,"_c",void 0),s()(this,"_d",void 0),s()(this,"_e",void 0),s()(this,"_f",void 0),s()(this,"_g",void 0),s()(this,"_h",void 0),s()(this,"_block",void 0),s()(this,"_finalSize",void 0),s()(this,"_blockSize",void 0),s()(this,"_len",void 0),s()(this,"_s",void 0),s()(this,"_w",void 0),this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this._w=o,this._block=e.alloc(64),this._finalSize=56,this._blockSize=64,this._len=0,this._s=0}update(t,i){"string"==typeof t&&(i=i||"utf8",t=e.from(t,i));const n=this._len+=t.length;let s=this._s||0,r=0;const o=this._block;for(;s<n;){const e=Math.min(t.length,r+this._blockSize-s%this._blockSize)-r;for(let i=0;i<e;i++)o[s%this._blockSize+i]=t[i+r];s+=e,r+=e,s%this._blockSize==0&&this._update(o)}return this._s=s,this}digest(e){const t=8*this._len;return this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),t%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(t,this._blockSize-4),this._update(this._block),this._hash().toString(e)}_update(e){const t=this._w;let i,n=0|this._a,s=0|this._b,o=0|this._c,h=0|this._d,p=0|this._e,b=0|this._f,f=0|this._g,g=0|this._h;for(i=0;i<16;++i)t[i]=e.readInt32BE(4*i);for(;i<64;++i)t[i]=0|(((v=t[i-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+t[i-7]+d(t[i-15])+t[i-16];var v;for(let e=0;e<64;++e){const i=g+l(p)+a(p,b,f)+r[e]+t[e]|0,d=u(n)+c(n,s,o)|0;g=f,f=b,b=p,p=h+i|0,h=o,o=s,s=n,n=i+d|0}this._a=n+this._a|0,this._b=s+this._b|0,this._c=o+this._c|0,this._d=h+this._d|0,this._e=p+this._e|0,this._f=b+this._f|0,this._g=f+this._g|0,this._h=g+this._h|0}_hash(){const t=e.alloc(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t}}function a(e,t,i){return i^e&(t^i)}function c(e,t,i){return e&t|i&(e|t)}function u(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function l(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function d(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}}).call(this,i(48).Buffer)}]);