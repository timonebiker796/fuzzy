/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.security_bundle_jsonpfunction=window.security_bundle_jsonpfunction||[]).push([[5],{267:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(268);case"v8light":return i(270)}},268:function(e,t,i){var s=i(73),a=i(269);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},269:function(e,t,i){(t=i(74)(!1)).push([e.i,".collapsiblePanel__logo{margin-right:8px;vertical-align:text-bottom}",""]),e.exports=t},270:function(e,t,i){var s=i(73),a=i(271);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},271:function(e,t,i){(t=i(74)(!1)).push([e.i,".collapsiblePanel__logo{margin-right:8px;vertical-align:text-bottom}",""]),e.exports=t},272:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(273);case"v8light":return i(275)}},273:function(e,t,i){var s=i(73),a=i(274);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},274:function(e,t,i){(t=i(74)(!1)).push([e.i,".euiAccordionWithDescription:focus,.euiAccordionWithDescription:hover{text-decoration:none}.noSubFeaturePrivileges,.subFeaturePanel{margin-left:28px}",""]),e.exports=t},275:function(e,t,i){var s=i(73),a=i(276);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},276:function(e,t,i){(t=i(74)(!1)).push([e.i,".euiAccordionWithDescription:focus,.euiAccordionWithDescription:hover{text-decoration:none}.noSubFeaturePrivileges,.subFeaturePanel{margin-left:28px}",""]),e.exports=t},277:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(278);case"v8light":return i(280)}},278:function(e,t,i){var s=i(73),a=i(279);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},279:function(e,t,i){(t=i(74)(!1)).push([e.i,".secPrivilegeFeatureChangeAllLink{margin-left:8px}",""]),e.exports=t},280:function(e,t,i){var s=i(73),a=i(281);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},281:function(e,t,i){(t=i(74)(!1)).push([e.i,".secPrivilegeFeatureChangeAllLink{margin-left:8px}",""]),e.exports=t},282:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(283);case"v8light":return i(285)}},283:function(e,t,i){var s=i(73),a=i(284);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},284:function(e,t,i){(t=i(74)(!1)).push([e.i,".featurePrivilegeName:focus,.featurePrivilegeName:hover{text-decoration:underline}",""]),e.exports=t},285:function(e,t,i){var s=i(73),a=i(286);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},286:function(e,t,i){(t=i(74)(!1)).push([e.i,".featurePrivilegeName:focus,.featurePrivilegeName:hover{text-decoration:underline}",""]),e.exports=t},287:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(288);case"v8light":return i(290)}},288:function(e,t,i){var s=i(73),a=i(289);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},289:function(e,t,i){(t=i(74)(!1)).push([e.i,".secPrivilegeTable__row--isGlobalSpace{background-color:#25262e}",""]),e.exports=t},290:function(e,t,i){var s=i(73),a=i(291);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},291:function(e,t,i){(t=i(74)(!1)).push([e.i,".secPrivilegeTable__row--isGlobalSpace{background-color:#f5f7fa}",""]),e.exports=t},292:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(293);case"v8light":return i(295)}},293:function(e,t,i){var s=i(73),a=i(294);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},294:function(e,t,i){(t=i(74)(!1)).push([e.i,".secSpacesPopoverList__buttonText{font-size:12px}",""]),e.exports=t},295:function(e,t,i){var s=i(73),a=i(296);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);s(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},296:function(e,t,i){(t=i(74)(!1)).push([e.i,".secSpacesPopoverList__buttonText{font-size:12px}",""]),e.exports=t},308:function(e,t,i){"use strict";i.r(t),i.d(t,"EditRolePage",(function(){return ee}));var s=i(10),a=i.n(s),r=i(4),l=i(2),n=i.n(l),o=i(34),c=i.n(o),u=i(3),d=i(13),g=i(11),p=i(29),m=i(67),v=i(1),h=i.n(v),b=i(0);class delete_role_button_DeleteRoleButton extends l.Component{constructor(...e){super(...e),h()(this,"state",{showModal:!1}),h()(this,"maybeShowModal",(()=>{const{buildFlavor:e,roleName:t}=this.props;return this.state.showModal?Object(b.jsx)(r.EuiConfirmModal,{title:"serverless"!==e?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.deleteRoleButton.deleteRoleTitle",defaultMessage:"Delete Role"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editCustomRole.deleteRoleButton.deleteRoleTitle",defaultMessage:"Delete Role {roleName}?",values:{roleName:t}}),onCancel:this.closeModal,onConfirm:this.onConfirmDelete,cancelButtonText:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.deleteRoleButton.cancelButtonLabel",defaultMessage:"No, don't delete"}),confirmButtonText:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.deleteRoleButton.confirmButtonLabel",defaultMessage:"Yes, delete role"}),buttonColor:"danger"},Object(b.jsx)("p",null,"serverless"!==e?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.deleteRoleButton.deletingRoleConfirmationText",defaultMessage:"Are you sure you want to delete this role?"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.roles.confirmDelete.serverless.removingSingleRoleDescription",defaultMessage:"Users with the {roleName} role assigned may lose access to the project if they are not assigned any other roles.",values:{roleName:t}})),Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.deleteRoleButton.deletingRoleWarningText",defaultMessage:"This action cannot be undone!"}))):null})),h()(this,"closeModal",(()=>{this.setState({showModal:!1})})),h()(this,"showModal",(()=>{this.setState({showModal:!0})})),h()(this,"onConfirmDelete",(()=>{this.closeModal(),this.props.onDelete()}))}render(){return this.props.canDelete?Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiButtonEmpty,{color:"danger",onClick:this.showModal},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.deleteRoleButton.deleteRoleButtonLabel",defaultMessage:"Delete role"})),this.maybeShowModal()):null}}var x=i(16),j=i.n(x),P=i(21);class cluster_privileges_ClusterPrivileges extends l.Component{constructor(...e){super(...e),h()(this,"buildComboBox",(e=>{const{role:t,editable:i}=this.props,s=e.map((e=>({label:e}))),a=(t.elasticsearch.cluster||[]).map((e=>({label:e})));return Object(b.jsx)(r.EuiFlexItem,{key:"clusterPrivs"},Object(b.jsx)(r.EuiComboBox,{"aria-label":u.i18n.translate("xpack.security.management.editRole.clusterPrivilegeForm.clusterPrivilegesAriaLabel",{defaultMessage:"Cluster privileges"}),"data-test-subj":"cluster-privileges-combobox",options:s,selectedOptions:a,onChange:this.onClusterPrivilegesChange,onCreateOption:this.onCreateCustomPrivilege,isDisabled:Object(P.l)(t)||!i,placeholder:u.i18n.translate("xpack.security.management.editRole.clusterPrivileges.placeholder",{defaultMessage:"Add an actionâ€¦"})}))})),h()(this,"onClusterPrivilegesChange",(e=>{this.props.onChange(e.map((e=>e.label)))})),h()(this,"onCreateCustomPrivilege",(e=>{this.props.onChange([...this.props.role.elasticsearch.cluster,e])})),h()(this,"getAvailableClusterPrivileges",(()=>{const e=[...this.props.builtinClusterPrivileges,...this.props.role.elasticsearch.cluster];return j.a.uniq(e)}))}render(){const e=this.getAvailableClusterPrivileges();return Object(b.jsx)(r.EuiFlexGroup,null,this.buildComboBox(e))}}h()(cluster_privileges_ClusterPrivileges,"defaultProps",{editable:!0});var f=i(56),F=i(54);const O=({remoteClusters:e,type:t,...i})=>{const s=Object(l.useMemo)((()=>{const{incompatible:i,remote:s}=e.reduce(((e,i)=>{const s="api_key"!==i.securityModel;return s?(e.incompatible.push({label:i.name,disabled:s,append:s?Object(b.jsx)(r.EuiIconTip,{type:"warning",color:"inherit",content:"remote_cluster"===t?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.remoteClusterPrivilegeForm.remoteClusterSecurityModelWarning",defaultMessage:"This cluster is configured with the certificate based security model and does not support remote cluster privileges. Connect this cluster with the API key based security model instead to use remote cluster privileges."}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.indexPrivilegeForm.remoteIndicesSecurityModelWarning",defaultMessage:"This cluster is configured with the certificate based security model and does not support remote index privileges. Connect this cluster with the API key based security model instead to use remote index privileges."})}):void 0}),e):(e.remote.push({label:i.name}),e)}),{incompatible:[],remote:[]});return i.length&&s.push({label:"Incompatible clusters",isGroupLabelOption:!0},...i),s}),[e,t]);return Object(b.jsx)(r.EuiComboBox,a()({},i,{options:s}))},y=e=>e.label,C=e=>({label:e});class index_privilege_form_IndexPrivilegeForm extends l.Component{constructor(e){super(e),h()(this,"isFieldListLoading",!1),h()(this,"getPrivilegeForm",(()=>{var e;return Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiFlexGrid,{css:Object(b.css)("grid-template-columns:repeat(\n              ","remote_indices"===this.props.indexType?3:2,",\n              minmax(0, 1fr)\n            );@media (max-width: ",F.euiThemeVars.euiBreakpoints.s,"px){grid-template-columns:repeat(1, minmax(0, 1fr));}","")},"remote_indices"===this.props.indexType?Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,a()({label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.indexPrivilegeForm.clustersFormRowLabel",defaultMessage:"Remote clusters"}),fullWidth:!0},this.props.validator.validateRemoteIndexPrivilegeClustersField(this.props.indexPrivilege)),Object(b.jsx)(O,{"data-test-subj":`clustersInput${this.props.formIndex}`,selectedOptions:("clusters"in this.props.indexPrivilege&&this.props.indexPrivilege.clusters?this.props.indexPrivilege.clusters:[]).map(C),onCreateOption:this.onCreateClusterOption,onChange:this.onClustersChange,isDisabled:this.props.isRoleReadOnly,placeholder:u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.clustersPlaceholder",{defaultMessage:"Add a remote clusterâ€¦"}),remoteClusters:null!==(e=this.props.remoteClusters)&&void 0!==e?e:[],type:"remote_indexes",fullWidth:!0}))):null,Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,a()({label:"remote_indices"===this.props.indexType?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.indexPrivilegeForm.remoteIndicesFormRowLabel",defaultMessage:"Remote indices"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.indexPrivilegeForm.indicesFormRowLabel",defaultMessage:"Indices"}),fullWidth:!0},this.props.validator.validateIndexPrivilegeNamesField(this.props.indexPrivilege)),Object(b.jsx)(r.EuiComboBox,{"data-test-subj":`indicesInput${this.props.formIndex}`,options:this.props.indexPatterns.map(C),selectedOptions:this.props.indexPrivilege.names.map(C),onCreateOption:this.onCreateIndexPatternOption,onChange:this.onIndexPatternsChange,isDisabled:this.props.isRoleReadOnly,placeholder:u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.indicesPlaceholder",{defaultMessage:"Add an index patternâ€¦"}),fullWidth:!0}))),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,a()({label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.indexPrivilegeForm.privilegesFormRowLabel",defaultMessage:"Privileges"}),fullWidth:!0},this.props.validator.validateIndexPrivilegePrivilegesField(this.props.indexPrivilege)),Object(b.jsx)(r.EuiComboBox,{"data-test-subj":`privilegesInput${this.props.formIndex}`,options:this.props.availableIndexPrivileges.map(C),selectedOptions:this.props.indexPrivilege.privileges.map(C),onChange:this.onPrivilegeChange,onCreateOption:this.onCreateCustomPrivilege,isDisabled:this.props.isRoleReadOnly,placeholder:u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.privilegesPlaceholder",{defaultMessage:"Add an actionâ€¦"}),fullWidth:!0})))),this.getFieldLevelControls(),this.getGrantedDocumentsControl())})),h()(this,"loadFLSOptions",((e,t=!1)=>{"remote_indices"!==this.props.indexType&&(t||!this.isFieldListLoading&&0!==e.length)&&(this.isFieldListLoading=!0,this.setState({isFieldListLoading:!0}),this.props.indicesAPIClient.getFields(e.join(",")).then((e=>{this.isFieldListLoading=!1,this.setState({flsOptions:e,isFieldListLoading:!1})})).catch((()=>{this.isFieldListLoading=!1,this.setState({flsOptions:[],isFieldListLoading:!1})})))})),h()(this,"getFieldLevelControls",(()=>{const{allowFieldLevelSecurity:e,indexPrivilege:t,isRoleReadOnly:i}=this.props,{grant:s,except:a}=this.getFieldSecurity(t);return e?i&&!this.state.fieldSecurityExpanded?null:Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiFlexGroup,{direction:"column"},!i&&Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiSwitch,{"data-test-subj":`restrictFieldsQuery${this.props.formIndex}`,label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRoles.indexPrivilegeForm.grantFieldPrivilegesLabel",defaultMessage:"Grant access to specific fields"}),compressed:!0,checked:this.state.fieldSecurityExpanded,onChange:this.toggleFieldSecurity})),this.state.fieldSecurityExpanded&&Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFlexGroup,null,Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,{label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRoles.indexPrivilegeForm.grantedFieldsFormRowLabel",defaultMessage:"Granted fields"}),fullWidth:!0,className:"indexPrivilegeForm__grantedFieldsRow",helpText:i||0!==s.length?void 0:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRoles.indexPrivilegeForm.grantedFieldsFormRowHelpText",defaultMessage:"If no fields are granted, then users assigned to this role will not be able to see any data for this index."})},Object(b.jsx)(r.EuiComboBox,{"data-test-subj":`fieldInput${this.props.formIndex}`,options:this.state.flsOptions.map(C),selectedOptions:s.map(C),onCreateOption:this.onCreateGrantedField,onChange:this.onGrantedFieldsChange,isDisabled:this.props.isRoleReadOnly,async:!0,isLoading:this.state.isFieldListLoading,placeholder:u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.fieldPlaceholder",{defaultMessage:"Add a field patternâ€¦"}),fullWidth:!0}))),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,{label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRoles.indexPrivilegeForm.deniedFieldsFormRowLabel",defaultMessage:"Denied fields"}),fullWidth:!0,className:"indexPrivilegeForm__deniedFieldsRow"},Object(b.jsx)(r.EuiComboBox,{"data-test-subj":`deniedFieldInput${this.props.formIndex}`,options:this.state.flsOptions.map(C),selectedOptions:a.map(C),onCreateOption:this.onCreateDeniedField,onChange:this.onDeniedFieldsChange,isDisabled:i,async:!0,isLoading:this.state.isFieldListLoading,placeholder:u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.deniedFieldPlaceholder",{defaultMessage:"Add a field patternâ€¦"}),fullWidth:!0}))))))):null})),h()(this,"getGrantedDocumentsControl",(()=>{var e;const{allowDocumentLevelSecurity:t,indexPrivilege:i,isRoleReadOnly:s}=this.props;return t?this.props.isRoleReadOnly&&!this.state.queryExpanded?null:Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiFlexGroup,{direction:"column"},!this.props.isRoleReadOnly&&Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiSwitch,{"data-test-subj":`restrictDocumentsQuery${this.props.formIndex}`,label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.indexPrivilegeForm.grantReadPrivilegesLabel",defaultMessage:"Grant read privileges to specific documents"}),compressed:!0,checked:this.state.queryExpanded,onChange:this.toggleDocumentQuery,disabled:s})),this.state.queryExpanded&&Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,{label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.indexPrivilegeForm.grantedDocumentsQueryFormRowLabel",defaultMessage:"Granted documents query"}),fullWidth:!0,"data-test-subj":`queryInput${this.props.formIndex}`},Object(b.jsx)(f.CodeEditorField,{languageId:"xjson",width:"100%",fullWidth:!0,height:this.state.documentQueryEditorHeight,"aria-label":u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.grantedDocumentsQueryEditorAriaLabel",{defaultMessage:"Granted documents query editor"}),value:null!==(e=i.query)&&void 0!==e?e:"",onChange:this.onQueryChange,useDarkTheme:this.props.isDarkMode,options:{readOnly:this.props.isRoleReadOnly,minimap:{enabled:!1},renderValidationDecorations:i.query?"editable":"off"},editorDidMount:this.editorDidMount}))))):null})),h()(this,"editorDidMount",(e=>{const t=()=>{const t=Math.min(1e3,Math.max(100,e.getContentHeight()));this.setState({documentQueryEditorHeight:`${t}px`})};e.onDidContentSizeChange(t),t()})),h()(this,"toggleDocumentQuery",(()=>{const e=this.state.queryExpanded,t=!e;this.setState({queryExpanded:!this.state.queryExpanded,documentQuery:e?this.props.indexPrivilege.query:this.state.documentQuery}),e&&this.props.onChange({...this.props.indexPrivilege,query:""}),t&&!this.props.indexPrivilege.query&&this.state.documentQuery&&this.props.onChange({...this.props.indexPrivilege,query:this.state.documentQuery})})),h()(this,"toggleFieldSecurity",(()=>{const e=this.state.fieldSecurityExpanded,t=!e,{grant:i,except:s}=this.getFieldSecurity(this.props.indexPrivilege);this.setState({fieldSecurityExpanded:!this.state.fieldSecurityExpanded,grantedFields:e?i:this.state.grantedFields,exceptedFields:e?s:this.state.exceptedFields}),e&&this.props.onChange({...this.props.indexPrivilege,field_security:{grant:["*"],except:[]}});const a=this.isFieldSecurityConfigured(this.props.indexPrivilege),r=this.state.exceptedFields.length>0||this.state.grantedFields.length>0;t&&this.loadFLSOptions(this.props.indexPrivilege.names),t&&!a&&r&&this.props.onChange({...this.props.indexPrivilege,field_security:{grant:this.state.grantedFields,except:this.state.exceptedFields}})})),h()(this,"onCreateClusterOption",(e=>{const t=("clusters"in this.props.indexPrivilege&&this.props.indexPrivilege.clusters?this.props.indexPrivilege.clusters:[]).concat([e]);this.props.onChange({...this.props.indexPrivilege,clusters:t})})),h()(this,"onClustersChange",(e=>{const t=e.map(y);this.props.onChange({...this.props.indexPrivilege,clusters:t})})),h()(this,"onCreateIndexPatternOption",(e=>{const t=this.props.indexPrivilege.names.concat([e]);this.props.onChange({...this.props.indexPrivilege,names:t}),this.state.fieldSecurityExpanded&&this.loadFLSOptions(t,!0)})),h()(this,"onIndexPatternsChange",(e=>{const t=e.map(y);this.props.onChange({...this.props.indexPrivilege,names:t}),this.state.fieldSecurityExpanded&&this.loadFLSOptions(t,!0)})),h()(this,"onPrivilegeChange",(e=>{this.props.onChange({...this.props.indexPrivilege,privileges:e.map(y)})})),h()(this,"onCreateCustomPrivilege",(e=>{this.props.onChange({...this.props.indexPrivilege,privileges:[...this.props.indexPrivilege.privileges,e]})})),h()(this,"onQueryChange",(e=>{this.props.onChange({...this.props.indexPrivilege,query:e})})),h()(this,"onCreateGrantedField",(e=>{if(!this.props.indexPrivilege.field_security||!this.props.indexPrivilege.field_security.grant)return;const t=this.props.indexPrivilege.field_security.grant.concat([e]);this.props.onChange({...this.props.indexPrivilege,field_security:{...this.props.indexPrivilege.field_security,grant:t}})})),h()(this,"onGrantedFieldsChange",(e=>{this.props.onChange({...this.props.indexPrivilege,field_security:{...this.props.indexPrivilege.field_security,grant:e.map(y)}})})),h()(this,"onCreateDeniedField",(e=>{if(!this.props.indexPrivilege.field_security||!this.props.indexPrivilege.field_security.except)return;const t=this.props.indexPrivilege.field_security.except.concat([e]);this.props.onChange({...this.props.indexPrivilege,field_security:{...this.props.indexPrivilege.field_security,except:t}})})),h()(this,"onDeniedFieldsChange",(e=>{this.props.onChange({...this.props.indexPrivilege,field_security:{...this.props.indexPrivilege.field_security,except:e.map(y)}})})),h()(this,"getFieldSecurity",(e=>{const{grant:t=[],except:i=[]}=e.field_security||{};return{grant:t,except:i}})),h()(this,"isFieldSecurityConfigured",(e=>{const{grant:t,except:i}=this.getFieldSecurity(e);return i.length>0||t.length>0&&!j.a.isEqual(t,["*"])}));const{grant:t,except:i}=this.getFieldSecurity(e.indexPrivilege);this.state={queryExpanded:!!e.indexPrivilege.query,fieldSecurityExpanded:this.isFieldSecurityConfigured(e.indexPrivilege),grantedFields:t,exceptedFields:i,documentQuery:e.indexPrivilege.query,documentQueryEditorHeight:"100px",isFieldListLoading:!1,flsOptions:[]}}componentDidMount(){this.state.fieldSecurityExpanded&&this.props.allowFieldLevelSecurity&&this.loadFLSOptions(this.props.indexPrivilege.names)}render(){return Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"m"}),Object(b.jsx)(r.EuiFlexGroup,{alignItems:"center",responsive:!1,className:"index-privilege-form"},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiPanel,{color:"subdued"},this.getPrivilegeForm())),!this.props.isRoleReadOnly&&Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButtonIcon,{"aria-label":"remote_indices"===this.props.indexType?u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.deleteRemoteIndexPrivilegeAriaLabel",{defaultMessage:"Delete remote index privilege"}):u.i18n.translate("xpack.security.management.editRole.indexPrivilegeForm.deleteIndexPrivilegeAriaLabel",{defaultMessage:"Delete index privilege"}),color:"danger",onClick:this.props.onDelete,iconType:"trash"}))))}}class index_privileges_IndexPrivileges extends l.Component{constructor(e){super(e),h()(this,"addIndexPrivilege",(()=>{var e;const{role:t,indexType:i}=this.props,s=[...null!==(e=t.elasticsearch[i])&&void 0!==e?e:[],{names:[],privileges:[],field_security:{grant:["*"]}}];this.props.onChange({...this.props.role,elasticsearch:{...this.props.role.elasticsearch,[i]:s}})})),h()(this,"onIndexPrivilegeChange",(e=>t=>{var i;const{role:s,indexType:a}=this.props,r=[...null!==(i=s.elasticsearch[a])&&void 0!==i?i:[]];r[e]=t,this.props.onChange({...this.props.role,elasticsearch:{...this.props.role.elasticsearch,[a]:r}})})),h()(this,"onIndexPrivilegeDelete",(e=>()=>{var t;const{role:i,indexType:s}=this.props,a=[...null!==(t=i.elasticsearch[s])&&void 0!==t?t:[]];a.splice(e,1),this.props.onChange({...this.props.role,elasticsearch:{...this.props.role.elasticsearch,[s]:a}})})),h()(this,"isPlaceholderPrivilege",(e=>0===e.names.length)),this.state={availableFields:{}}}render(){var e;const t=null!==(e=this.props.role.elasticsearch[this.props.indexType])&&void 0!==e?e:[],{indexPatterns:i=[],remoteClusters:s,license:o,availableIndexPrivileges:c,indicesAPIClient:u}=this.props,{allowRoleDocumentLevelSecurity:g,allowRoleFieldLevelSecurity:p,allowRoleRemoteIndexPrivileges:m}=o.getFeatures(),v="remote_indices"===this.props.indexType&&!m,h={indexType:this.props.indexType,indexPatterns:i,indicesAPIClient:u,allowDocumentLevelSecurity:g||!Object(P.k)(this.props.role),allowFieldLevelSecurity:p||!Object(P.k)(this.props.role),isRoleReadOnly:!this.props.editable||Object(P.l)(this.props.role)||v};return Object(b.jsx)(l.Fragment,null,t.map(((e,t)=>Object(b.jsx)(index_privilege_form_IndexPrivilegeForm,a()({key:t},h,{formIndex:t,validator:this.props.validator,availableIndexPrivileges:c,indexPrivilege:e,remoteClusters:s,onChange:this.onIndexPrivilegeChange(t),onDelete:this.onIndexPrivilegeDelete(t),isDarkMode:this.props.isDarkMode})))),this.props.editable&&Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"m"}),Object(b.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButton,{iconType:"plusInCircle",onClick:this.addIndexPrivilege,disabled:v},"remote_indices"===this.props.indexType?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.addRemoteIndexPrivilegesButtonLabel",defaultMessage:"Add remote index privilege"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.addIndexPrivilegesButtonLabel",defaultMessage:"Add index privilege"}))),v&&Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiIconTip,{content:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.remoteIndexPrivilegesLicenseMissing",defaultMessage:"Your license does not allow configuring remote index privileges"}),position:"right"})))))}}h()(index_privileges_IndexPrivileges,"defaultProps",{editable:!0});const S=e=>e.label,E=e=>({label:e}),k=({isRoleReadOnly:e,remoteClusters:t=[],formIndex:i,validator:s,remoteClusterPrivilege:n,availableRemoteClusterPrivileges:o,onChange:c,onDelete:g})=>{var p;const m=Object(l.useCallback)((e=>{var t;const i=(null!==(t=n.clusters)&&void 0!==t?t:[]).concat([e]);c({...n,clusters:i})}),[n,c]),v=Object(l.useCallback)((e=>{const t=e.map(S);c({...n,clusters:t})}),[c,n]),h=Object(l.useCallback)((e=>{c({...n,privileges:e.map(S)})}),[n,c]);return Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"m"}),Object(b.jsx)(r.EuiFlexGroup,{alignItems:"center",responsive:!1,className:"remote-cluster-privilege-form"},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiPanel,{color:"subdued"},Object(b.jsx)(r.EuiFlexGrid,{css:Object(b.css)("grid-template-columns:repeat(2, minmax(0, 1fr));@media (max-width: ",F.euiThemeVars.euiBreakpoints.s,"px){grid-template-columns:repeat(1, minmax(0, 1fr));}","")},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,a()({label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.remoteClusterPrivilegeForm.clustersFormRowLabel",defaultMessage:"Remote clusters"}),fullWidth:!0},s.validateRemoteClusterPrivilegeClusterField(n)),Object(b.jsx)(O,{"data-test-subj":`remoteClusterClustersInput${i}`,selectedOptions:(null!==(p=n.clusters)&&void 0!==p?p:[]).map(E),onCreateOption:m,onChange:v,isDisabled:e,placeholder:u.i18n.translate("xpack.security.management.editRole.remoteClusterPrivilegeForm.clustersPlaceholder",{defaultMessage:"Add a remote clusterâ€¦"}),remoteClusters:t,type:"remote_cluster",fullWidth:!0}))),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,a()({label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.remoteClusterPrivilegeForm.privilegesFormRowLabel",defaultMessage:"Privileges"}),fullWidth:!0},s.validateRemoteClusterPrivilegePrivilegesField(n)),Object(b.jsx)(r.EuiComboBox,{"data-test-subj":`remoteClusterPrivilegesInput${i}`,options:o.map(E),selectedOptions:n.privileges.map(E),onChange:h,isDisabled:e,placeholder:u.i18n.translate("xpack.security.management.editRole.remoteClusterPrivilegeForm.privilegesPlaceholder",{defaultMessage:"Add an actionâ€¦"}),fullWidth:!0})))))),!e&&Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButtonIcon,{"aria-label":u.i18n.translate("xpack.security.management.editRole.remoteClusterPrivilegeForm.deleteRemoteClusterPrivilegeAriaLabel",{defaultMessage:"Delete remote cluster privilege"}),color:"danger",onClick:g,iconType:"trash","data-test-subj":`deleteRemoteClusterPrivilegesButton${i}`}))))},M=({remoteClusters:e,license:t,availableRemoteClusterPrivileges:i,role:s,editable:a,onChange:o,validator:c})=>{const u=Object(l.useMemo)((()=>{var e;return null!==(e=s.elasticsearch.remote_cluster)&&void 0!==e?e:[]}),[s]),g=Object(l.useMemo)((()=>{const{allowRemoteClusterPrivileges:e}=t.getFeatures();return!e}),[t]),p=Object(l.useMemo)((()=>!a||Object(P.l)(s)||g),[s,a,g]),m=Object(l.useCallback)((e=>{const t={...s,elasticsearch:{...s.elasticsearch,remote_cluster:e}};o(t)}),[o,s]),v=Object(l.useCallback)((()=>{const e=[...u,{clusters:[],privileges:[]}];m(e)}),[m,u]),h=Object(l.useCallback)((e=>t=>{const i=[...u];i[e]=t,m(i)}),[m,u]),x=Object(l.useCallback)((e=>()=>{const t=[...u];t.splice(e,1),m(t)}),[m,u]);return Object(b.jsx)(n.a.Fragment,null,u.map(((t,s)=>Object(b.jsx)(k,{key:s,isRoleReadOnly:p,formIndex:s,validator:c,availableRemoteClusterPrivileges:i,remoteClusterPrivilege:t,remoteClusters:e,onChange:h(s),onDelete:x(s)}))),a&&Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"m"}),Object(b.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButton,{iconType:"plusInCircle",onClick:v,disabled:g,"data-test-subj":"addRemoteClusterPrivilegesButton"},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.addRemoteClusterPrivilegesButtonLabel",defaultMessage:"Add remote cluster privilege"}))),g&&Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiIconTip,{content:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.remoteClusterPrivilegesLicenseMissing",defaultMessage:"Your license does not allow configuring remote cluster privileges"}),position:"right"})))))};i(267);class collapsible_panel_CollapsiblePanel extends l.Component{constructor(e){super(e),h()(this,"state",{collapsed:!1}),h()(this,"getTitle",(()=>Object(b.jsx)(r.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:!1},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiTitle,null,Object(b.jsx)("h2",null,this.props.iconType&&Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiIcon,{type:this.props.iconType,size:"xl",className:"collapsiblePanel__logo"})," "),this.props.title))),Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiLink,{"data-test-subj":"showHidePrivilege",onClick:this.toggleCollapsed},this.state.collapsed?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.collapsiblePanel.showLinkText",defaultMessage:"show"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.collapsiblePanel.hideLinkText",defaultMessage:"hide"})))))),h()(this,"getForm",(()=>this.state.collapsed?null:Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiSpacer,null),this.props.children))),h()(this,"toggleCollapsed",(()=>{this.setState({collapsed:!this.state.collapsed})})),this.state={collapsed:e.initiallyCollapsed||!1}}render(){return Object(b.jsx)(r.EuiPanel,{hasShadow:!1,hasBorder:!0},this.getTitle(),this.getForm())}}class elasticsearch_privileges_ElasticsearchPrivileges extends l.Component{constructor(...e){super(...e),h()(this,"getForm",(()=>{var e;const{role:t,indicesAPIClient:i,docLinks:s,validator:a,onChange:o,editable:c,indexPatterns:g,remoteClusters:p,license:m,builtinESPrivileges:v,canUseRemoteIndices:h,canUseRemoteClusters:x,buildFlavor:j}=this.props;return Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiDescribedFormGroup,{title:Object(b.jsx)("h3",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.clusterPrivilegesTitle",defaultMessage:"Cluster privileges"})),description:Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.manageRoleActionsDescription",defaultMessage:"Manage the actions this role can perform against your cluster. "}),this.learnMore(s.links.security.clusterPrivileges))},Object(b.jsx)(r.EuiFormRow,{fullWidth:!0,hasEmptyLabelSpace:!0},Object(b.jsx)(cluster_privileges_ClusterPrivileges,{role:this.props.role,onChange:this.onClusterPrivilegesChange,builtinClusterPrivileges:v.cluster,editable:c}))),Object(b.jsx)(r.EuiSpacer,null),"traditional"===j&&x&&Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiTitle,{size:"xs"},Object(b.jsx)("h3",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.remoteClusterPrivilegesTitle",defaultMessage:"Remote cluster privileges"}))),Object(b.jsx)(r.EuiSpacer,{size:"s"}),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.controlAccessToRemoteClusterActionsDescription",defaultMessage:"Manage the actions this role can perform against your remote cluster. "}),this.learnMore(s.links.security.clusterPrivileges))),Object(b.jsx)(M,{remoteClusters:p,role:t,validator:a,license:m,onChange:o,availableRemoteClusterPrivileges:null!==(e=v.remote_cluster)&&void 0!==e?e:[],editable:c}),Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiSpacer,null)),"traditional"===j&&Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiDescribedFormGroup,{title:Object(b.jsx)("h3",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.runAsPrivilegesTitle",defaultMessage:"Run As privileges"})),description:Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.howToBeSubmittedOnBehalfOfOtherUsersDescription",defaultMessage:"Allow requests to be submitted on the behalf of other users. "}),this.learnMore(s.links.security.runAsPrivilege))},Object(b.jsx)(r.EuiComboBox,{"aria-label":u.i18n.translate("xpack.security.management.editRole.elasticSearchPrivileges.runAsPrivilegesAriaLabel",{defaultMessage:"Run as privileges"}),placeholder:this.props.editable?u.i18n.translate("xpack.security.management.editRole.elasticSearchPrivileges.addUserTitle",{defaultMessage:"Add a userâ€¦"}):void 0,options:this.props.runAsUsers.map((e=>({label:e,isGroupLabelOption:!1}))),selectedOptions:this.props.role.elasticsearch.run_as.map((e=>({label:e}))),onCreateOption:this.onCreateRunAsOption,onChange:this.onRunAsUserChange,isDisabled:!c})),Object(b.jsx)(r.EuiSpacer,null)),Object(b.jsx)(r.EuiTitle,{size:"xs"},Object(b.jsx)("h3",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.indexPrivilegesTitle",defaultMessage:"Index privileges"}))),Object(b.jsx)(r.EuiSpacer,{size:"s"}),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.controlAccessToClusterDataDescription",defaultMessage:"Control access to the data in your cluster. "}),this.learnMore(s.links.security.indicesPrivileges))),Object(b.jsx)(index_privileges_IndexPrivileges,{indexType:"indices",indexPatterns:g,role:t,indicesAPIClient:i,validator:a,license:m,onChange:o,availableIndexPrivileges:v.index,editable:c,isDarkMode:this.props.isDarkMode}),"traditional"===j&&h&&Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiTitle,{size:"xs"},Object(b.jsx)("h3",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.remoteIndexPrivilegesTitle",defaultMessage:"Remote index privileges"}))),Object(b.jsx)(r.EuiSpacer,{size:"s"}),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.controlAccessToRemoteClusterDataDescription",defaultMessage:"Control access to the data in remote clusters. "}),this.learnMore(s.links.security.indicesPrivileges))),Object(b.jsx)(index_privileges_IndexPrivileges,{indexType:"remote_indices",remoteClusters:p,role:t,indicesAPIClient:i,validator:a,license:m,onChange:o,availableIndexPrivileges:v.index,editable:c,isDarkMode:this.props.isDarkMode})))})),h()(this,"learnMore",(e=>Object(b.jsx)(r.EuiLink,{className:"editRole__learnMore",href:e,target:"_blank"},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.elasticSearchPrivileges.learnMoreLinkText",defaultMessage:"Learn more"})))),h()(this,"addIndexPrivilege",(()=>{const{role:e}=this.props,t=[...e.elasticsearch.indices,{names:[],privileges:[],field_security:{grant:["*"]}}];this.props.onChange({...this.props.role,elasticsearch:{...this.props.role.elasticsearch,indices:t}})})),h()(this,"onClusterPrivilegesChange",(e=>{const t={...this.props.role,elasticsearch:{...this.props.role.elasticsearch,cluster:e}};this.props.onChange(t)})),h()(this,"onRunAsUserChange",(e=>{const t={...this.props.role,elasticsearch:{...this.props.role.elasticsearch,run_as:e.map((e=>e.label))}};this.props.onChange(t)})),h()(this,"onCreateRunAsOption",(e=>{const t=this.props.role.elasticsearch.run_as.concat(e),i={...this.props.role,elasticsearch:{...this.props.role.elasticsearch,run_as:t}};this.props.onChange(i)}))}render(){return Object(b.jsx)(collapsible_panel_CollapsiblePanel,{iconType:"logoElasticsearch",title:"Elasticsearch"},this.getForm())}}class unsupported_space_privileges_warning_UnsupportedSpacePrivilegesWarning extends l.Component{constructor(...e){super(...e),h()(this,"getMessage",(()=>Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.unsupportedSpacePrivilegesWarning",defaultMessage:"This role contains privilege definitions for spaces, but spaces are not enabled in Kibana. Saving this role will remove these privileges."})))}render(){return Object(b.jsx)(r.EuiCallOut,{iconType:"warning",color:"warning",title:this.getMessage()})}}function R(e){return!e.spaces||0===e.spaces.length||e.spaces.includes("*")}const I="none",_="custom";i(272);var w=i(53),T=i.n(w);i(277);class change_all_privileges_ChangeAllPrivilegesControl extends l.Component{constructor(...e){super(...e),h()(this,"state",{isPopoverOpen:!1}),h()(this,"onSelectPrivilege",(e=>{this.props.onChange(e),this.setState({isPopoverOpen:!1})})),h()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),h()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})}))}render(){const e=Object(b.jsx)(r.EuiLink,{onClick:this.onButtonClick,className:"secPrivilegeFeatureChangeAllLink","data-test-subj":"changeAllPrivilegesButton"},Object(b.jsx)(r.EuiText,{size:"xs"},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.changeAllPrivilegesLink",defaultMessage:"Bulk actions"})," ",Object(b.jsx)(r.EuiIcon,{size:"s",type:"arrowDown"}))),t=this.props.privileges.map((e=>Object(b.jsx)(r.EuiContextMenuItem,{key:e.id,"data-test-subj":`changeAllPrivileges-${e.id}`,onClick:()=>{this.onSelectPrivilege(e.id)},disabled:this.props.disabled},j.a.upperFirst(e.id))));return t.push(Object(b.jsx)(r.EuiContextMenuItem,{key:I,"data-test-subj":`changeAllPrivileges-${I}`,onClick:()=>{this.onSelectPrivilege(I)},disabled:this.props.disabled},j.a.upperFirst(I))),Object(b.jsx)(r.EuiPopover,{id:"changeAllFeaturePrivilegesPopover",button:e,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},Object(b.jsx)(r.EuiContextMenuPanel,{items:t}))}}const A=e=>{const t=e.subFeature.getPrivilegeGroups();return 0===t.length?null:Object(b.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(b.jsx)(r.EuiFlexItem,{grow:3},Object(b.jsx)(r.EuiFlexGroup,{gutterSize:"none",direction:"column"},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{size:"s"},e.subFeature.name," ",(()=>{if(!e.subFeature.privilegesTooltip)return null;const t=Object(b.jsx)(r.EuiText,null,Object(b.jsx)("p",null,e.subFeature.privilegesTooltip));return Object(b.jsx)(r.EuiIconTip,{iconProps:{className:"eui-alignTop"},type:"iInCircle",color:"subdued",content:t})})())),e.subFeature.description&&Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{color:"subdued",size:"xs","data-test-subj":"subFeatureDescription","aria-describedby":`${e.subFeature.name} description text`},e.subFeature.description)))),Object(b.jsx)(r.EuiFlexItem,{grow:2},t.map((function(t,i){switch(t.groupType){case"independent":return function(t,i){return Object(b.jsx)("div",{key:i},t.privileges.map((t=>{const i=e.privilegeCalculator.isIndependentSubFeaturePrivilegeGranted(e.featureId,t.id,e.privilegeIndex);return Object(b.jsx)(r.EuiCheckbox,{key:t.id,id:`${e.featureId}_${t.id}`,label:t.name,"data-test-subj":"independentSubFeaturePrivilegeControl",onChange:i=>{const{checked:s}=i.target;s?e.onChange([...e.selectedFeaturePrivileges,t.id]):e.onChange(e.selectedFeaturePrivileges.filter((e=>e!==t.id)))},checked:i,disabled:e.disabled})})))}(t,i);case"mutually_exclusive":return function(t,i){var s;const a=e.privilegeCalculator.getSelectedMutuallyExclusiveSubFeaturePrivilege(e.featureId,t,e.privilegeIndex),l=[...t.privileges.map(((t,i)=>({id:t.id,label:t.name,isDisabled:e.disabled})))];return l.push({id:I,label:"None",isDisabled:e.disabled}),Object(b.jsx)(r.EuiButtonGroup,{key:i,buttonSize:"compressed","data-test-subj":"mutexSubFeaturePrivilegeControl",isFullWidth:!0,options:l,idSelected:null!==(s=null==a?void 0:a.id)&&void 0!==s?s:I,isDisabled:e.disabled,onChange:i=>{const s=e.selectedFeaturePrivileges.filter((e=>!t.privileges.some((t=>t.id===e))));i===I?e.onChange(s):e.onChange([...s,i])},legend:u.i18n.translate("xpack.security.management.editRole.subFeatureForm.controlLegendText",{defaultMessage:"{subFeatureName} sub-feature privilege",values:{subFeatureName:e.subFeature.name}})})}(t,i);default:throw new Error(`Unsupported privilege group type: ${t.groupType}`)}}))))},D=({feature:e,onChange:t,privilegeIndex:i,privilegeCalculator:s,selectedFeaturePrivileges:a,allSpacesSelected:n,disabled:o,licenseAllowsSubFeatPrivCustomization:c})=>{const[g,p]=Object(l.useState)((()=>c&&e.getMinimalFeaturePrivileges().some((e=>a.includes(e.id)))));return Object(l.useEffect)((()=>{const t=e.getMinimalFeaturePrivileges().some((e=>a.includes(e.id)));c&&t||!g||p(!1)}),[e,g,a,c]),Object(b.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)("div",null,Object(b.jsx)(r.EuiSwitch,{label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.featureTable.customizeSubFeaturePrivilegesSwitchLabel",defaultMessage:"Customize sub-feature privileges"}),checked:g,onChange:a=>{t(e.id,s.updateSelectedFeaturePrivilegesForCustomization(e.id,i,a.target.checked,n)),p(a.target.checked)},"data-test-subj":"customizeSubFeaturePrivileges",disabled:o||!c||!s.canCustomizeSubFeaturePrivileges(e.id,i)}),c?void 0:Object(b.jsx)(r.EuiIconTip,{"data-test-subj":"subFeaturesTip",position:"right","aria-label":"sub-feature-information-tip",size:"m",type:"iInCircle",color:"subdued",iconProps:{className:"eui-alignTop"},content:u.i18n.translate("xpack.security.management.editRole.featureTable.cannotCustomizeSubFeaturesTooltip",{defaultMessage:"Customization of sub-feature privileges is a subscription feature."})}))),e.getSubFeatures().map((l=>{const c=l.requireAllSpaces&&!n;return Object(b.jsx)(r.EuiFlexItem,{key:l.name},Object(b.jsx)(A,{privilegeCalculator:s,privilegeIndex:i,featureId:e.id,subFeature:l,onChange:i=>t(e.id,i),selectedFeaturePrivileges:a,disabled:o||!g||c}))})))};i(282);const z=({feature:e,className:t})=>{let i=null;if(e.getPrivilegesTooltip()){const t=Object(b.jsx)(r.EuiText,null,Object(b.jsx)("p",null,e.getPrivilegesTooltip()));i=Object(b.jsx)(r.EuiIconTip,{iconProps:{className:"eui-alignTop"},type:"iInCircle",color:"subdued",content:t})}return Object(b.jsx)(r.EuiFlexGroup,{className:t,direction:"column",gutterSize:"none",component:"span"},Object(b.jsx)(r.EuiFlexItem,{"data-test-subj":"featureTableCell",component:"span"},Object(b.jsx)(r.EuiFlexGroup,{gutterSize:"xs"},Object(b.jsx)(r.EuiFlexItem,{className:"featurePrivilegeName",grow:!1},e.name),Object(b.jsx)(r.EuiFlexItem,{grow:!1},i))),e.description&&Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{color:"subdued",size:"xs","data-test-subj":"featurePrivilegeDescriptionText","aria-describedby":`${e.name} description text`},e.description)))};class feature_table_FeatureTable extends l.Component{constructor(e){super(e),h()(this,"featureCategories",new Map),h()(this,"renderPrivilegeControlsForFeature",(e=>{var t;const i=(t,i,s)=>{var a;const l=e.getSubFeaturePrivileges().length>0;return Object(b.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(b.jsx)(r.EuiFlexItem,{grow:!1},s),Object(b.jsx)(r.EuiFlexItem,{className:"eui-fullWidth"},Object(b.jsx)(r.EuiAccordion,{id:`featurePrivilegeControls_${e.id}`,"data-test-subj":"featurePrivilegeControls",buttonContent:t,buttonClassName:"euiAccordionWithDescription",extraAction:i,forceState:l?void 0:"closed",arrowDisplay:l?"left":"none",onToggle:t=>{t?this.state.expandedPrivilegeControls.add(e.id):this.state.expandedPrivilegeControls.delete(e.id),this.setState({expandedPrivilegeControls:new Set([...this.state.expandedPrivilegeControls])})}},Object(b.jsx)(r.EuiSpacer,{size:"s"}),Object(b.jsx)(r.EuiPanel,{color:"subdued",paddingSize:"s",className:"subFeaturePanel"},Object(b.jsx)(D,{feature:e,privilegeIndex:this.props.privilegeIndex,onChange:this.props.onChange,privilegeCalculator:this.props.privilegeCalculator,selectedFeaturePrivileges:null!==(a=this.props.role.kibana[this.props.privilegeIndex].feature[e.id])&&void 0!==a?a:[],allSpacesSelected:this.props.allSpacesSelected,disabled:this.props.disabled,licenseAllowsSubFeatPrivCustomization:this.props.canCustomizeSubFeaturePrivileges})))))},s=e.getPrimaryFeaturePrivileges();if(e.reserved&&0===s.length)return i(Object(b.jsx)(z,{className:"noSubFeaturePrivileges",feature:e}),Object(b.jsx)(r.EuiText,{style:{maxWidth:200},size:"xs","data-test-subj":"reservedFeatureDescription"},e.reserved.description),Object(b.jsx)(r.EuiIcon,{type:"empty"}));if(0===s.length)return null;const a=this.props.privilegeCalculator.getDisplayedPrimaryFeaturePrivilegeId(e.id,this.props.privilegeIndex,this.props.allSpacesSelected),l=s.filter((e=>!e.disabled)).map((t=>{const i=t.requireAllSpaces&&!this.props.allSpacesSelected;return{id:`${e.id}_${t.id}`,label:t.name,isDisabled:this.props.disabled||i}}));l.push({id:`${e.id}_${I}`,label:"None",isDisabled:null!==(t=this.props.disabled)&&void 0!==t&&t});let n=Object(b.jsx)(r.EuiIconTip,{type:"empty",content:null});!this.state.expandedPrivilegeControls.has(e.id)&&this.props.privilegeCalculator.hasCustomizedSubFeaturePrivileges(e.id,this.props.privilegeIndex,this.props.allSpacesSelected)&&(n=Object(b.jsx)(r.EuiIconTip,{type:"iInCircle",content:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.featureTable.privilegeCustomizationTooltip",defaultMessage:"Feature has customized sub-feature privileges. Expand this row for more information."})}));const o=e.getSubFeaturePrivileges().length>0;return i(Object(b.jsx)(z,{className:T()({noSubFeaturePrivileges:!o}),feature:e}),Object(b.jsx)(r.EuiButtonGroup,{name:`featurePrivilege_${e.id}`,"data-test-subj":"primaryFeaturePrivilegeControl",isFullWidth:!0,options:l,idSelected:`${e.id}_${null!=a?a:I}`,onChange:this.onChange(e.id),legend:u.i18n.translate("xpack.security.management.editRole.featureTable.actionLegendText",{defaultMessage:"{featureName} feature privilege",values:{featureName:e.name}}),style:{minWidth:200}}),n)})),h()(this,"onChange",(e=>t=>{const i=t.substr(`${e}_`.length);i===I?this.props.onChange(e,[]):this.props.onChange(e,[i])})),h()(this,"onChangeAllFeaturePrivileges",(e=>{e===I?this.props.onChangeAll([]):this.props.onChangeAll([e])})),h()(this,"getCategoryHelpText",(e=>{if("management"===e.id)return u.i18n.translate("xpack.security.management.editRole.featureTable.managementCategoryHelpText",{defaultMessage:"Access to Stack Management is determined by both Elasticsearch and Kibana privileges, and cannot be explicitly disabled."})})),e.kibanaPrivileges.getSecuredFeatures().filter((e=>null!=e.privileges||null!=e.reserved)).forEach((e=>{this.featureCategories.has(e.category.id)||this.featureCategories.set(e.category.id,[]),this.featureCategories.get(e.category.id).push(e)})),this.state={expandedPrivilegeControls:new Set}}render(){const e=this.props.kibanaPrivileges.getBasePrivileges(this.props.role.kibana[this.props.privilegeIndex]),t=[];return this.featureCategories.forEach((e=>{var i;const{category:s}=e[0],a=e.length,l=e.filter((e=>null!=this.props.privilegeCalculator.getEffectivePrimaryFeaturePrivilege(e.id,this.props.privilegeIndex,this.props.allSpacesSelected))).length,o=Object(b.jsx)(r.EuiFlexGroup,{"data-test-subj":`featureCategoryButton_${s.id}`,alignItems:"center",responsive:!1,gutterSize:"m"},s.euiIconType?Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiIcon,{size:"m",type:s.euiIconType})):null,Object(b.jsx)(r.EuiFlexItem,{grow:1},Object(b.jsx)(r.EuiTitle,{size:"xs"},Object(b.jsx)("h4",{className:"eui-displayInlineBlock"},s.label)))),c=u.i18n.translate("xpack.security.management.editRole.featureTable.featureAccordionSwitchLabel",{defaultMessage:"{grantedCount} / {featureCount} {featureCount, plural, one {feature} other {features}} granted",values:{grantedCount:l,featureCount:a}}),d=Object(b.jsx)(r.EuiText,{size:"s","aria-hidden":"true",color:"subdued","data-test-subj":"categoryLabel"},c),g=this.getCategoryHelpText(s),p=Object(b.jsx)(r.EuiAccordion,{id:`featureCategory_${s.id}`,"data-test-subj":`featureCategory_${s.id}`,key:s.id,arrowDisplay:"left",forceState:void 0,buttonContent:o,extraAction:d},Object(b.jsx)("div",null,Object(b.jsx)(r.EuiSpacer,{size:"s"}),g&&Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiCallOut,{iconType:"iInCircle",size:"s"},g),Object(b.jsx)(r.EuiSpacer,{size:"s"})),Object(b.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s"},e.map((e=>Object(b.jsx)(r.EuiFlexItem,{key:e.id},this.renderPrivilegeControlsForFeature(e)))))));t.push({order:null!==(i=s.order)&&void 0!==i?i:Number.MAX_SAFE_INTEGER,element:p})})),t.sort(((e,t)=>e.order-t.order)),Object(b.jsx)("div",null,Object(b.jsx)(r.EuiFlexGroup,{alignItems:"flexEnd"},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{size:"xs"},Object(b.jsx)("b",null,u.i18n.translate("xpack.security.management.editRole.featureTable.featureVisibilityTitle",{defaultMessage:"Customize feature privileges"})))),!this.props.disabled&&Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(change_all_privileges_ChangeAllPrivilegesControl,{privileges:e,onChange:this.onChangeAllFeaturePrivileges}))),Object(b.jsx)(r.EuiHorizontalRule,{margin:"m"}),t.flatMap(((e,t)=>[e.element,Object(b.jsx)(r.EuiHorizontalRule,{key:`accordion-hr-${t}`,margin:"m"})])))}}h()(feature_table_FeatureTable,"defaultProps",{privilegeIndex:-1,showLocks:!0});class privilege_form_calculator_PrivilegeFormCalculator{constructor(e,t){this.kibanaPrivileges=e,this.role=t}getBasePrivilege(e){const t=this.role.kibana[e];return this.kibanaPrivileges.getBasePrivileges(t).find((e=>t.base.includes(e.id)))}isWildcardBasePrivilege(e){return this.role.kibana[e].base.includes("*")}getDisplayedPrimaryFeaturePrivilegeId(e,t,i){var s;return null===(s=this.getDisplayedPrimaryFeaturePrivilege(e,t,i))||void 0===s?void 0:s.id}hasCustomizedSubFeaturePrivileges(e,t,i){const s=this.kibanaPrivileges.getSecuredFeature(e),a=this.getDisplayedPrimaryFeaturePrivilege(e,t,i),r=this.kibanaPrivileges.createCollectionFromRoleKibanaPrivileges([this.role.kibana[t]]);return s.getSubFeaturePrivileges().some((e=>{var t;const i=r.grantsPrivilege(e);return i!==(null!==(t=null==a?void 0:a.grantsPrivilege(e))&&void 0!==t?t:i)}))}getEffectivePrimaryFeaturePrivilege(e,t,i){const s=this.kibanaPrivileges.getSecuredFeature(e),a=this.getBasePrivilege(t),r=this.getSelectedFeaturePrivileges(e,t),l=s.getPrimaryFeaturePrivileges({includeMinimalFeaturePrivileges:!0}).find((e=>r.includes(e.id)||(null==a?void 0:a.grantsPrivilege(e))));if((null==l||!l.requireAllSpaces||i)&&(null==l||!l.disabled))return l}isIndependentSubFeaturePrivilegeGranted(e,t,i){const s=this.role.kibana[i],a=this.kibanaPrivileges.getSecuredFeature(e).getSubFeaturePrivileges().find((e=>e.id===t));return this.kibanaPrivileges.createCollectionFromRoleKibanaPrivileges([s]).grantsPrivilege(a)}getSelectedMutuallyExclusiveSubFeaturePrivilege(e,t,i){const s=this.role.kibana[i],a=this.kibanaPrivileges.createCollectionFromRoleKibanaPrivileges([s]);return t.privileges.find((e=>a.grantsPrivilege(e)))}canCustomizeSubFeaturePrivileges(e,t){const i=this.getSelectedFeaturePrivileges(e,t);return this.kibanaPrivileges.getSecuredFeature(e).getPrimaryFeaturePrivileges({includeMinimalFeaturePrivileges:!0}).some((e=>i.includes(e.id)))}updateSelectedFeaturePrivilegesForCustomization(e,t,i,s){const a=this.getDisplayedPrimaryFeaturePrivilege(e,t,s),r=this.getSelectedFeaturePrivileges(e,t);if(!a)return r;const l=[];if(i){const t=this.kibanaPrivileges.getSecuredFeature(e).getSubFeaturePrivileges().filter((e=>a.grantsPrivilege(e))).map((e=>e.id));l.push(a.getMinimalPrivilegeId(),...t)}else l.push(a.id);return l}hasSupersededInheritedPrivileges(e){const t=this.locateGlobalPrivilege(this.role),i=this.role.kibana[e];if(R(i)||!t)return!1;const s=this.kibanaPrivileges.createCollectionFromRoleKibanaPrivileges([t]),a=this.kibanaPrivileges.createCollectionFromRoleKibanaPrivileges([i]),r=this.kibanaPrivileges.getBasePrivileges(i).some((e=>i.base.includes(e.id))),l=this.kibanaPrivileges.getSecuredFeatures().filter((e=>e.getAllPrivileges().some((t=>{var s;return null===(s=i.feature[e.id])||void 0===s?void 0:s.includes(t.id)})))),n=r&&this.kibanaPrivileges.getBasePrivileges(i).some((e=>s.grantsPrivilege(e)&&!a.grantsPrivilege(e))),o=l.some((e=>e.getAllPrivileges().some((e=>s.grantsPrivilege(e)&&!a.grantsPrivilege(e)))));return n||o}getDisplayedPrimaryFeaturePrivilege(e,t,i){const s=this.kibanaPrivileges.getSecuredFeature(e),a=this.getBasePrivilege(t),r=this.getSelectedFeaturePrivileges(e,t),l=s.getPrimaryFeaturePrivileges().find((e=>{const t=e.getMinimalPrivilegeId(),i=s.getMinimalFeaturePrivileges().find((e=>e.id===t)),l=e.grantsPrivilege(i);return r.includes(e.id)||l&&r.includes(t)||(null==a?void 0:a.grantsPrivilege(e))}));if((null==l||!l.requireAllSpaces||i)&&(null==l||!l.disabled))return l}getSelectedFeaturePrivileges(e,t){var i;return null!==(i=this.role.kibana[t].feature[e])&&void 0!==i?i:[]}locateGlobalPrivilege(e){return e.kibana.find((e=>R(e)))}}class simple_privilege_section_SimplePrivilegeSection extends l.Component{constructor(e){super(e),h()(this,"getDisplayedBasePrivilege",(()=>{if(this.state.isCustomizingGlobalPrivilege)return _;const{role:e}=this.props,t=this.locateGlobalPrivilege(e);return t&&t.base.length>0?t.base[0]:I})),h()(this,"onKibanaPrivilegeChange",(e=>{const t=Object(P.d)(this.props.role),i=this.locateGlobalPrivilege(t)||this.createGlobalPrivilegeEntry(t);e===I?t.kibana=t.kibana.filter((e=>!R(e))):e===_?i.base=[]:(i.base=[e],i.feature={}),this.props.onChange(t),this.setState({isCustomizingGlobalPrivilege:e===_,globalPrivsIndex:t.kibana.indexOf(i)})})),h()(this,"onFeaturePrivilegeChange",((e,t)=>{const i=Object(P.d)(this.props.role),s=this.locateGlobalPrivilege(i)||this.createGlobalPrivilegeEntry(i);t.length>0?s.feature[e]=[...t]:delete s.feature[e],this.props.onChange(i)})),h()(this,"onChangeAllFeaturePrivileges",(e=>{const t=Object(P.d)(this.props.role),i=this.locateGlobalPrivilege(t)||this.createGlobalPrivilegeEntry(t);e.length>0?this.props.kibanaPrivileges.getSecuredFeatures().forEach((t=>{i.feature[t.id]=[...e]})):i.feature={},this.props.onChange(t)})),h()(this,"maybeRenderSpacePrivilegeWarning",(()=>this.props.role.kibana.some((e=>!R(e)))?Object(b.jsx)(r.EuiFormRow,{fullWidth:!0},Object(b.jsx)(unsupported_space_privileges_warning_UnsupportedSpacePrivilegesWarning,null)):null)),h()(this,"locateGlobalPrivilegeIndex",(e=>e.kibana.findIndex((e=>R(e))))),h()(this,"locateGlobalPrivilege",(e=>e.kibana.find((e=>R(e)))));const t=this.locateGlobalPrivilege(e.role),i=this.locateGlobalPrivilegeIndex(e.role);this.state={isCustomizingGlobalPrivilege:Boolean(t&&Object.keys(t.feature).length>0),globalPrivsIndex:i}}render(){var e,t;const i=this.getDisplayedBasePrivilege(),s=null!==(e=null===(t=this.props.role.kibana[this.state.globalPrivsIndex])||void 0===t?void 0:t._reserved)&&void 0!==e?e:[],a=Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.kibanaPrivilegesTitle",defaultMessage:"Kibana privileges"}),o=Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.specifyPrivilegeForRoleDescription",defaultMessage:"Specifies the Kibana privilege for this role."}));return Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiFlexGroup,{direction:"column"},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},o)),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,{label:a},s.length>0?Object(b.jsx)(r.EuiComboBox,{fullWidth:!0,selectedOptions:s.map((e=>({label:e}))),isDisabled:!0}):Object(b.jsx)(r.EuiSuperSelect,{disabled:!this.props.editable,onChange:this.onKibanaPrivilegeChange,options:[{value:I,inputDisplay:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.noPrivilegeInput",defaultMessage:"None"}),dropdownDisplay:Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)("strong",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.noPrivilegeDropdown",defaultMessage:"None"})),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.noPrivilegeDropdownDescription",defaultMessage:"No access to Kibana"}))))},{value:"read",inputDisplay:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.readPrivilegeInput",defaultMessage:"Read"}),dropdownDisplay:Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)("strong",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.readPrivilegeDropdown",defaultMessage:"Read"})),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.readPrivilegeDropdownDescription",defaultMessage:"Grants read-only access to all of Kibana"}))))},{value:"all",inputDisplay:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.allPrivilegeInput",defaultMessage:"All"}),dropdownDisplay:Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)("strong",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.allPrivilegeDropdown",defaultMessage:"All"})),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.allPrivilegeDropdownDescription",defaultMessage:"Grants full access to all of Kibana"}))))},{value:_,inputDisplay:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.customPrivilegeInput",defaultMessage:"Custom"}),dropdownDisplay:Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)("strong",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.customPrivilegeDropdown",defaultMessage:"Custom"})),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.simplePrivilegeForm.customPrivilegeDropdownDescription",defaultMessage:"Customize access to Kibana"}))))}],hasDividers:!0,valueOfSelected:i})),this.state.isCustomizingGlobalPrivilege&&Object(b.jsx)(r.EuiFormRow,{fullWidth:!0},Object(b.jsx)(feature_table_FeatureTable,{role:this.props.role,kibanaPrivileges:this.props.kibanaPrivileges,privilegeCalculator:new privilege_form_calculator_PrivilegeFormCalculator(this.props.kibanaPrivileges,this.props.role),onChange:this.onFeaturePrivilegeChange,onChangeAll:this.onChangeAllFeaturePrivileges,privilegeIndex:this.props.role.kibana.findIndex((e=>R(e))),canCustomizeSubFeaturePrivileges:this.props.canCustomizeSubFeaturePrivileges,allSpacesSelected:!0,disabled:!this.props.editable})),this.maybeRenderSpacePrivilegeWarning())))}createGlobalPrivilegeEntry(e){const t={spaces:["*"],base:[],feature:{}};return e.kibana.push(t),t}}var B=i(60);const L=(e,t)=>{if(e)return{id:`spaceOption_${e.id}`,label:e.name,color:Object(B.getSpaceColor)(e),disabled:"global"===t&&"*"!==e.id||"spaces"===t&&"*"===e.id}};class space_selector_SpaceSelector extends l.Component{constructor(...e){super(...e),h()(this,"onChange",(e=>{this.props.onChange(e.map((e=>e.id.split("spaceOption_")[1])))})),h()(this,"getOptions",(()=>this.props.spaces.map((e=>L(e,this.props.selectedSpaceIds.includes("*")?"global":this.props.selectedSpaceIds.length>0?"spaces":void 0))).filter(Boolean))),h()(this,"getSelectedOptions",(()=>{var e;return this.props.selectedSpaceIds.map((e=this.props.spaces,t=>L(e.find((e=>e.id===t))))).filter(Boolean)}))}render(){return Object(b.jsx)(r.EuiComboBox,{"data-test-subj":"spaceSelectorComboBox","aria-label":u.i18n.translate("xpack.security.management.editRole.spaceSelectorLabel",{defaultMessage:"Spaces"}),fullWidth:!0,options:this.getOptions(),renderOption:(e,t,i)=>{const{color:s,label:a}=e;return Object(b.jsx)(r.EuiHealth,{color:s},Object(b.jsx)("span",{className:i},Object(b.jsx)(r.EuiHighlight,{search:t},a)))},selectedOptions:this.getSelectedOptions(),isDisabled:this.props.disabled,onChange:this.onChange})}}var G=i(8);class privilege_space_form_PrivilegeSpaceForm extends l.Component{constructor(e){super(e),h()(this,"getForm",(()=>{const{spaces:e}=this.props,t=this.state.selectedSpaceIds.length>0;return Object(b.jsx)(r.EuiForm,null,Object(b.jsx)(r.EuiFormRow,{fullWidth:!0,label:u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.spaceSelectorFormLabel",{defaultMessage:"Spaces"}),helpText:u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.spaceSelectorFormHelpText",{defaultMessage:"Select one or more Kibana spaces to which you wish to assign privileges."})},Object(b.jsx)(space_selector_SpaceSelector,{selectedSpaceIds:this.state.selectedSpaceIds,onChange:this.onSelectedSpacesChange,spaces:e})),this.getPrivilegeCallout(),Object(b.jsx)(r.EuiFormRow,{fullWidth:!0,label:u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.privilegeSelectorFormLabel",{defaultMessage:"Privileges for all features"}),helpText:u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.privilegeSelectorFormHelpText",{defaultMessage:"Assign the privilege level you wish to grant to all present and future features across this space."})},Object(b.jsx)(r.EuiButtonGroup,{name:"basePrivilegeButtonGroup","data-test-subj":"basePrivilegeButtonGroup",isFullWidth:!0,color:"primary",options:[{id:"basePrivilege_all",label:"All","data-test-subj":"basePrivilege_all"},{id:"basePrivilege_read",label:"Read","data-test-subj":"basePrivilege_read"},{id:"basePrivilege_custom",label:"Customize","data-test-subj":"basePrivilege_custom"}],idSelected:this.getDisplayedBasePrivilege(),isDisabled:!t,onChange:this.onSpaceBasePrivilegeChange,legend:u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.basePrivilegeControlLegend",{defaultMessage:"Privileges for all features"})})),Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiTitle,{size:"xxs"},Object(b.jsx)("h3",null,this.getFeatureListLabel(this.state.selectedBasePrivilege.length>0))),Object(b.jsx)(r.EuiSpacer,{size:"xs"}),Object(b.jsx)(r.EuiText,{size:"s"},Object(b.jsx)("p",null,this.getFeatureListDescription(this.state.selectedBasePrivilege.length>0))),Object(b.jsx)(r.EuiSpacer,{size:"l"}),Object(b.jsx)(feature_table_FeatureTable,{role:this.state.role,privilegeCalculator:this.state.privilegeCalculator,onChange:this.onFeaturePrivilegesChange,onChangeAll:this.onChangeAllFeaturePrivileges,kibanaPrivileges:this.props.kibanaPrivileges,privilegeIndex:this.state.privilegeIndex,canCustomizeSubFeaturePrivileges:this.props.canCustomizeSubFeaturePrivileges,disabled:this.state.selectedBasePrivilege.length>0||!t,allSpacesSelected:this.state.selectedSpaceIds.includes(G.a)}),this.requiresGlobalPrivilegeWarning()&&Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"l"}),Object(b.jsx)(r.EuiCallOut,{color:"warning",iconType:"warning","data-test-subj":"globalPrivilegeWarning",title:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeForm.globalPrivilegeWarning",defaultMessage:"Creating a global privilege might impact your other space privileges."})})))})),h()(this,"getSaveButton",(()=>{const{mode:e}=this.state,t=this.isDefiningGlobalPrivilege();let i;switch(e){case"create":i=t?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRolespacePrivilegeForm.createGlobalPrivilegeButton",defaultMessage:"Create global privilege"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRolespacePrivilegeForm.createPrivilegeButton",defaultMessage:"Add Kibana privilege"});break;case"update":i=t?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRolespacePrivilegeForm.updateGlobalPrivilegeButton",defaultMessage:"Update global privilege"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRolespacePrivilegeForm.updatePrivilegeButton",defaultMessage:"Update space privilege"});break;default:throw new Error(`Unsupported mode: ${e}`)}let s="primary";return this.requiresGlobalPrivilegeWarning()&&(s="warning"),Object(b.jsx)(r.EuiButton,{onClick:this.onSaveClick,fill:!0,disabled:!this.canSave(),color:s,"data-test-subj":"createSpacePrivilegeButton"},i)})),h()(this,"getFeatureListLabel",(e=>e?u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.summaryOfFeaturePrivileges",{defaultMessage:"Summary of feature privileges"}):u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.customizeFeaturePrivileges",{defaultMessage:"Customize by feature"}))),h()(this,"getFeatureListDescription",(e=>e?u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.featurePrivilegeSummaryDescription",{defaultMessage:"Some features might be hidden by the space or affected by a global space privilege."}):u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.customizeFeaturePrivilegeDescription",{defaultMessage:"Increase privilege levels on a per feature basis. Some features might be hidden by the space or affected by a global space privilege."}))),h()(this,"getPrivilegeCallout",(()=>this.isDefiningGlobalPrivilege()?Object(b.jsx)(r.EuiFormRow,{fullWidth:!0},Object(b.jsx)(r.EuiCallOut,{color:"primary",iconType:"iInCircle",title:u.i18n.translate("xpack.security.management.editRole.spacePrivilegeForm.globalPrivilegeNotice",{defaultMessage:"These privileges will apply to all current and future spaces."})})):null)),h()(this,"closeFlyout",(()=>{this.props.onCancel()})),h()(this,"onSaveClick",(()=>{const e=Object(P.d)(this.state.role),t=e.kibana[this.state.privilegeIndex];this.isDefiningGlobalPrivilege()||(t.spaces=t.spaces.filter((e=>this.props.spaces.find((t=>t.id===e))))),this.props.onChange(e)})),h()(this,"onSelectedSpacesChange",(e=>{const t=Object(P.d)(this.state.role),i=t.kibana[this.state.privilegeIndex];i.spaces=[...e],i.feature=this.resetRoleFeature(i.feature,e),this.setState({selectedSpaceIds:e,role:t,privilegeCalculator:new privilege_form_calculator_PrivilegeFormCalculator(this.props.kibanaPrivileges,t)})})),h()(this,"onSpaceBasePrivilegeChange",(e=>{const t=Object(P.d)(this.state.role),i=t.kibana[this.state.privilegeIndex],s=e.split("basePrivilege_")[1];let a=!1;s===_?(i.base=[],a=!0):(i.base=[s],i.feature={}),this.setState({selectedBasePrivilege:s===_?[]:[s],role:t,isCustomizingFeaturePrivileges:a,privilegeCalculator:new privilege_form_calculator_PrivilegeFormCalculator(this.props.kibanaPrivileges,t)})})),h()(this,"resetRoleFeature",((e,t)=>{const i=this.props.kibanaPrivileges.getSecuredFeatures();return Object.entries(e).reduce(((e,[s,a])=>{var r;if(!Array.isArray(a))return e;const l=i.find((e=>e.id===s)),n=null!==(r=null==l?void 0:l.getPrimaryFeaturePrivileges({includeMinimalFeaturePrivileges:!0}).find((e=>a.includes(e.id))))&&void 0!==r?r:{disabled:!1,requireAllSpaces:!1},o=t.includes(G.a);l&&l.getSubFeatures().forEach((e=>{e.privileges.forEach((t=>{a.includes(t.id)&&e.requireAllSpaces&&!o&&Object(x.remove)(a,(e=>e===t.id))}))}));const c=null!=n&&n.disabled||null!=n&&n.requireAllSpaces&&!o?[]:a;return{...e,...c.length&&{[s]:c}}}),{})})),h()(this,"getDisplayedBasePrivilege",(()=>{const e=this.state.privilegeCalculator.getBasePrivilege(this.state.privilegeIndex);return e?`basePrivilege_${e.id}`:`basePrivilege_${_}`})),h()(this,"onFeaturePrivilegesChange",((e,t)=>{this.setRole(t,e)})),h()(this,"onChangeAllFeaturePrivileges",(e=>{this.setRole(e)})),h()(this,"canSave",(()=>{if(0===this.state.selectedSpaceIds.length)return!1;const e=this.state.role.kibana[this.state.privilegeIndex];return!(0===e.base.length&&0===Object.keys(e.feature).length)})),h()(this,"isDefiningGlobalPrivilege",(()=>this.state.selectedSpaceIds.includes("*"))),h()(this,"requiresGlobalPrivilegeWarning",(()=>{const e=this.props.role.kibana.length>0;return"create"===this.state.mode&&this.isDefiningGlobalPrivilege()&&e}));const t=Object(P.d)(e.role);let i=e.privilegeIndex;i<0&&(i=t.kibana.push({spaces:[],base:[],feature:{}})-1),this.state={role:t,privilegeIndex:i,selectedSpaceIds:[...t.kibana[i].spaces],selectedBasePrivilege:[...t.kibana[i].base||[]],mode:e.privilegeIndex<0?"create":"update",isCustomizingFeaturePrivileges:!1,privilegeCalculator:new privilege_form_calculator_PrivilegeFormCalculator(e.kibanaPrivileges,t)}}render(){return Object(b.jsx)(r.EuiFlyout,{onClose:this.closeFlyout,size:"m",maxWidth:!0,maskProps:{headerZindexLocation:"below"}},Object(b.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(b.jsx)(r.EuiTitle,{size:"m"},Object(b.jsx)("h2",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeForm.modalTitle",defaultMessage:"Kibana privileges"})))),Object(b.jsx)(r.EuiFlyoutBody,null,Object(b.jsx)(r.EuiErrorBoundary,null,this.getForm())),Object(b.jsx)(r.EuiFlyoutFooter,null,this.state.privilegeCalculator.hasSupersededInheritedPrivileges(this.state.privilegeIndex)&&Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiCallOut,{color:"warning",iconType:"warning","data-test-subj":"spaceFormGlobalPermissionsSupersedeWarning",title:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeForm.supersededWarningTitle",defaultMessage:"Superseded by global privileges"})},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeForm.supersededWarning",defaultMessage:"Declared privileges are less permissive than configured global privileges. View the privilege summary to see effective privileges."})),Object(b.jsx)(r.EuiSpacer,{size:"s"})),Object(b.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left","data-test-subj":"cancelSpacePrivilegeButton"},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeForm.cancelButton",defaultMessage:"Cancel"}))),Object(b.jsx)(r.EuiFlexItem,{grow:!1},this.getSaveButton()))))}setRole(e,t){const i=Object(P.d)(this.state.role),s=i.kibana[this.state.privilegeIndex];if(0===e.length)t?delete s.feature[t]:s.feature={};else{let i=this.props.kibanaPrivileges.getSecuredFeatures();t&&(i=[i.find((e=>e.id===t))]),i.forEach((t=>{const i=t.getPrimaryFeaturePrivileges({includeMinimalFeaturePrivileges:!0}).find((t=>!(null!=t&&t.disabled||null!=t&&t.requireAllSpaces&&!this.state.selectedSpaceIds.includes(G.a))&&Array.isArray(e)&&e.includes(t.id)));let a=[];i&&(a=[i.id],t.getSubFeaturePrivileges().forEach((t=>{Array.isArray(e)&&e.includes(t.id)&&(!t.requireAllSpaces||t.requireAllSpaces&&this.state.selectedSpaceIds.includes(G.a))&&a.push(t.id)}))),0===a.length?delete s.feature[t.id]:s.feature[t.id]=a}))}this.setState({role:i,privilegeCalculator:new privilege_form_calculator_PrivilegeFormCalculator(this.props.kibanaPrivileges,i)})}}h()(privilege_space_form_PrivilegeSpaceForm,"defaultProps",{privilegeIndex:-1}),i(287);const N=e=>Object(b.jsx)(W,e),W=e=>{const{privilege:t,...i}=e,s=Object(b.jsx)(r.EuiText,i,function(e){const t=function(e){return void 0===e?[]:Array.isArray(e)?e:[e]}(e);let i;return i=0===t.length||1===t.length&&t.includes(I)?Object(b.jsx)(r.EuiIcon,{color:"subdued",type:"minusInCircle"}):t.map((e=>j.a.upperFirst(e))).join(", "),i}(t));return s};N.defaultProps={privilege:[]};class privilege_space_table_PrivilegeSpaceTable extends l.Component{constructor(...e){super(...e),h()(this,"state",{expandedSpacesGroups:[]}),h()(this,"renderKibanaPrivileges",(()=>{const{privilegeCalculator:e,displaySpaces:t}=this.props,i=this.getSortedPrivileges().map(((e,i)=>({spaces:e.spaces.map((e=>t.find((t=>t.id===e))||{id:e,name:e,disabledFeatures:[],deleted:!0})),privilegeIndex:i,isGlobal:R(e),privileges:{spaces:e.spaces,base:e.base||[],feature:e.feature||{},reserved:e._reserved||[]}}))),s=[{field:"spaces",name:"Spaces",width:"60%",render:(e,t)=>{const i=this.state.expandedSpacesGroups.includes(t.privilegeIndex),s=i?e:e.slice(0,4);let l=null;return e.length>s.length?l=Object(b.jsx)(r.EuiButtonEmpty,{size:"xs",onClick:()=>this.toggleExpandSpacesGroup(t.privilegeIndex)},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeTable.showNMoreSpacesLink",defaultMessage:"+{count} more",values:{count:e.length-s.length}})):i&&(l=Object(b.jsx)(r.EuiButtonEmpty,{size:"xs",onClick:()=>this.toggleExpandSpacesGroup(t.privilegeIndex)},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeTable.showLessSpacesLink",defaultMessage:"show less"}))),Object(b.jsx)("div",null,Object(b.jsx)("span",{"data-test-subj":"spacesColumn"},s.map((e=>Object(b.jsx)(r.EuiBadge,a()({key:e.id},(e=>e.deleted?{iconType:"trash"}:{})(e),{color:Object(B.getSpaceColor)(e)}),e.name)))),l)}},{field:"privileges",name:"Privileges",render:(t,i)=>{var s,a;if(t.reserved.length>0)return Object(b.jsx)(N,{privilege:t.reserved,"data-test-subj":"privilegeColumn"});const l=null!==(s=null===(a=e.getBasePrivilege(i.privilegeIndex))||void 0===a?void 0:a.id)&&void 0!==s?s:_,n=e.isWildcardBasePrivilege(i.privilegeIndex)?"*":l;let o=Object(b.jsx)(r.EuiIcon,{type:"empty",size:"s"});return e.hasSupersededInheritedPrivileges(i.privilegeIndex)&&(o=Object(b.jsx)("span",{"data-test-subj":"spaceTablePrivilegeSupersededWarning"},Object(b.jsx)(r.EuiIconTip,{type:"warning",size:"s",content:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeTable.supersededPrivilegeWarning",defaultMessage:"Privileges are superseded by configured global privilege. View the privilege summary to see effective privileges."})}))),Object(b.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(b.jsx)(r.EuiFlexItem,{grow:!1},o),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(N,{privilege:n,"data-test-subj":"privilegeColumn"})))}}];return this.props.disabled||s.push({name:"Actions",actions:[{render:e=>Object(b.jsx)(r.EuiButtonIcon,{"aria-label":u.i18n.translate("xpack.security.management.editRole.spacePrivilegeTable.editPrivilegesLabel",{defaultMessage:"Edit privileges for the following spaces: {spaceNames}.",values:{spaceNames:e.spaces.map((e=>e.name)).join(", ")}}),color:"primary",iconType:"pencil",onClick:()=>this.props.onEdit(e.privilegeIndex),"data-test-subj":`privilegeEditAction-${e.privilegeIndex}`})},{render:e=>Object(b.jsx)(r.EuiButtonIcon,{"aria-label":u.i18n.translate("xpack.security.management.editRole.spacePrivilegeTable.deletePrivilegesLabel",{defaultMessage:"Delete privileges for the following spaces: {spaceNames}.",values:{spaceNames:e.spaces.map((e=>e.name)).join(", ")}}),color:"danger",iconType:"trash",onClick:()=>this.onDeleteSpacePrivilege(e),"data-test-subj":`privilegeDeleteAction-${e.privilegeIndex}`})}]}),Object(b.jsx)(r.EuiInMemoryTable,{columns:s,items:i,rowProps:e=>({className:R(e.privileges)?"secPrivilegeTable__row--isGlobalSpace":""})})})),h()(this,"getSortedPrivileges",(()=>this.props.role.kibana.sort(((e,t)=>R(e)?-1:R(t)?1:0)))),h()(this,"toggleExpandSpacesGroup",(e=>{this.state.expandedSpacesGroups.includes(e)?this.setState({expandedSpacesGroups:this.state.expandedSpacesGroups.filter((t=>t!==e))}):this.setState({expandedSpacesGroups:[...this.state.expandedSpacesGroups,e]})})),h()(this,"onDeleteSpacePrivilege",(e=>{const t=Object(P.d)(this.props.role);t.kibana.splice(e.privilegeIndex,1),this.props.onChange(t),this.setState({expandedSpacesGroups:this.state.expandedSpacesGroups.filter((t=>t!==e.privilegeIndex))})}))}render(){return this.renderKibanaPrivileges()}}class privilege_summary_calculator_PrivilegeSummaryCalculator{constructor(e,t){this.kibanaPrivileges=e,this.role=t}getEffectiveFeaturePrivileges(e){const t=this.collectAssignedPrivileges(e);return this.kibanaPrivileges.getSecuredFeatures().reduce(((i,s)=>{const a=this.getDisplayedPrimaryFeaturePrivilege(t,s),r=s.getSubFeaturePrivileges().filter((e=>t.grantsPrivilege(e))),l=this.hasCustomizedSubFeaturePrivileges(s,a,e);return{...i,[s.id]:{primary:a,hasCustomizedSubFeaturePrivileges:l,subFeature:r.map((e=>e.id))}}}),{})}hasCustomizedSubFeaturePrivileges(e,t,i){const s=this.collectAssignedPrivileges(i);return e.getSubFeaturePrivileges().some((e=>{var i;const a=s.grantsPrivilege(e);return a!==(null!==(i=null==t?void 0:t.grantsPrivilege(e))&&void 0!==i?i:a)}))}getDisplayedPrimaryFeaturePrivilege(e,t){const i=t.getPrimaryFeaturePrivileges(),s=t.getMinimalFeaturePrivileges(),a=t.subFeatures.length>0;return i.find((t=>{const i=e.grantsPrivilege(t);if(!i&&a){const i=s.find((e=>e.id===t.getMinimalPrivilegeId()));return e.grantsPrivilege(i)}return i}))}collectAssignedPrivileges(e){if(R(e))return this.kibanaPrivileges.createCollectionFromRoleKibanaPrivileges([e]);const t=this.locateGlobalPrivilege(this.role);return this.kibanaPrivileges.createCollectionFromRoleKibanaPrivileges(t?[t,e]:[e])}locateGlobalPrivilege(e){return e.kibana.find((e=>R(e)))}}const q=e=>Object(b.jsx)(r.EuiFlexGroup,{direction:"column"},e.feature.getSubFeatures().map((t=>Object(b.jsx)(r.EuiFlexItem,{key:t.name,"data-test-subj":"subFeatureEntry"},Object(b.jsx)(r.EuiFlexGroup,null,Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{size:"s","data-test-subj":"subFeatureName"},t.name)),e.effectiveFeaturePrivileges.map(((e,i)=>{return Object(b.jsx)(r.EuiFlexItem,{key:i,"data-test-subj":`entry-${i}`},t.getPrivilegeGroups().map((s=e.subFeature,(e,t)=>{switch(e.groupType){case"independent":return function(e,t,i){return Object(b.jsx)("div",{key:i},t.privileges.map((t=>{const i=e.includes(t.id);return Object(b.jsx)(r.EuiFlexGroup,{gutterSize:"s","data-test-subj":"independentPrivilege",key:t.id},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiIconTip,{type:i?"check":"cross",color:i?"primary":"danger",content:i?u.i18n.translate("xpack.security.management.editRole.privilegeSummary.privilegeGrantedIconTip",{defaultMessage:"Privilege is granted"}):u.i18n.translate("xpack.security.management.editRole.privilegeSummary.privilegeNotGrantedIconTip",{defaultMessage:"Privilege is not granted"})})),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{size:"s","data-test-subj":"privilegeName"},t.name)))})))}(s,e,t);case"mutually_exclusive":return function(e,t,i){var s;const a=null===(s=t.privileges.find((t=>e.includes(t.id))))||void 0===s?void 0:s.name;return Object(b.jsx)(r.EuiFlexGroup,{gutterSize:"s",key:i,"data-test-subj":"mutexPrivilege"},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiIconTip,{type:a?"check":"cross",color:a?"primary":"danger",content:a?"Privilege is granted":"Privilege is not granted"})),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiText,{size:"s","data-test-subj":"privilegeName"},null!=a?a:"None")))}(s,e,t);default:throw new Error(`Unsupported privilege group type: ${e.groupType}`)}})));var s})))))));i(292);var $=i(68);class spaces_popover_list_SpacesPopoverList extends l.Component{constructor(...e){super(...e),h()(this,"state",{allowSpacesListFocus:!1,isPopoverOpen:!1}),h()(this,"getMenuPanel",(()=>{const e=this.getSpaceOptions(),t=Object(b.jsx)(r.EuiText,{color:"subdued",className:"eui-textCenter"},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacesPopoverList.noSpacesFoundTitle",defaultMessage:" no spaces found "}));return Object(b.jsx)(r.EuiSelectable,{className:"spcMenu",title:u.i18n.translate("xpack.security.management.editRole.spacesPopoverList.popoverTitle",{defaultMessage:"Spaces"}),searchable:this.props.spaces.length>=$.SPACE_SEARCH_COUNT_THRESHOLD,searchProps:this.props.spaces.length>=$.SPACE_SEARCH_COUNT_THRESHOLD?{placeholder:u.i18n.translate("xpack.security.management.editRole.spacesPopoverList.findSpacePlaceholder",{defaultMessage:"Find a space"}),compressed:!0,isClearable:!0,id:"spacesPopoverListSearch"}:void 0,noMatchesMessage:t,options:e,singleSelection:!0,style:{width:300},listProps:{rowHeight:40,showIcons:!1,onFocusBadge:!1}},((e,t)=>Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(r.EuiPopoverTitle,{paddingSize:"s"},u.i18n.translate("xpack.security.management.editRole.spacesPopoverList.selectSpacesTitle",{defaultMessage:"Spaces"})),t,e)))})),h()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),h()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),h()(this,"getSpaceOptions",(()=>{const e=Object(l.memo)(this.props.spacesApiUi.components.getSpaceAvatar);return this.props.spaces.map((t=>{const i=Object(b.jsx)(l.Suspense,{fallback:Object(b.jsx)(r.EuiLoadingSpinner,{size:"m"})},Object(b.jsx)(e,{space:t,size:"s",announceSpaceName:!1}));return{"aria-label":t.name,"aria-roledescription":"space",label:t.name,key:t.id,prepend:i,checked:void 0,"data-test-subj":`${t.id}-selectableSpaceItem`,className:"selectableSpaceItem"}}))}))}render(){const e=Object(b.jsx)(r.EuiButtonEmpty,{size:"xs",onClick:this.onButtonClick},Object(b.jsx)("span",{className:"secSpacesPopoverList__buttonText"},this.props.buttonText));return Object(b.jsx)(r.EuiPopover,{id:"spacesPopoverList",button:e,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft",ownFocus:!1},Object(b.jsx)(r.EuiFocusTrap,null,this.getMenuPanel()))}}const U=e=>{const{spacesApiUi:t}=e,i=R(e.entry),s=e.entry.spaces.map((t=>{var i;return null!==(i=e.spaces.find((e=>e.id===t)))&&void 0!==i?i:{id:t,name:t,disabledFeatures:[]}})),a=Object(l.useMemo)((()=>t.components.getSpaceAvatar),[t]);return Object(b.jsx)("div",null,s.slice(0,4).map((e=>Object(b.jsx)("span",{key:e.id},Object(b.jsx)(a,{size:"s",space:e})," ",i&&Object(b.jsx)("span",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeMatrix.globalSpaceName",defaultMessage:"All Spaces"}))))),s.length>4&&Object(b.jsx)(l.Fragment,null,Object(b.jsx)("br",null),Object(b.jsx)(spaces_popover_list_SpacesPopoverList,{spaces:s,buttonText:u.i18n.translate("xpack.security.management.editRole.spacePrivilegeMatrix.showNMoreSpacesLink",{defaultMessage:"+{count} more",values:{count:s.length-4}}),spacesApiUi:t})))};function K(e){return`privilege_entry_${e.spaces.join("|")}`}const V=e=>{const[t,i]=Object(l.useState)([]),s=Object(l.useMemo)((()=>{const t=new Map;return e.kibanaPrivileges.getSecuredFeatures().filter((e=>null!=e.privileges||null!=e.reserved)).forEach((e=>{t.has(e.category.id)||t.set(e.category.id,[]),t.get(e.category.id).push(e)})),t}),[e.kibanaPrivileges]),a=new privilege_summary_calculator_PrivilegeSummaryCalculator(e.kibanaPrivileges,e.role),o={name:"Feature",field:"feature",render:e=>Object(b.jsx)(z,{feature:e})},c={align:"right",width:"40px",isExpander:!0,field:"featureId",name:"",render:(e,s)=>s.feature.getSubFeaturePrivileges().length>0?Object(b.jsx)(r.EuiButtonIcon,{onClick:()=>(e=>{t.includes(e)?i(t.filter((t=>t!==e))):i([...t,e])})(e),"data-test-subj":"expandPrivilegeSummaryRow","aria-label":t.includes(e)?"Collapse":"Expand",iconType:t.includes(e)?"arrowUp":"arrowDown"}):null},u=[...e.role.kibana].sort(((e,t)=>R(e)?-1:R(t)?1:0)),g=u.map((t=>{const i=K(t);return{name:Object(b.jsx)(U,{entry:t,spaces:e.spaces,spacesApiUi:e.spacesApiUi}),field:i,render:(t,i)=>{const{primary:s,hasCustomizedSubFeaturePrivileges:a}=t[i.featureId];let l=null;return l=a?Object(b.jsx)(r.EuiIconTip,{size:"s",type:"iInCircle",content:Object(b.jsx)("span",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.privilegeSummary.additionalPrivilegesGrantedIconTip",defaultMessage:"Additional privileges granted. Expand this row for more information."}))}):Object(b.jsx)(r.EuiIcon,{size:"s",type:"empty"}),Object(b.jsx)("span",{"data-test-subj":"privilegeColumn "+(a?"additionalPrivilegesGranted":"")},(n=e.spaces.some((e=>e.id===G.a)),null==(null==(o=s)?void 0:o.name)||null!=o&&o.disabled||o.requireAllSpaces&&!n?"None":null==o?void 0:o.name)," ",l);var n,o}}})),p=[];e.canCustomizeSubFeaturePrivileges&&p.push(c),p.push(o,...g);const m=u.reduce(((e,t)=>({...e,[K(t)]:a.getEffectiveFeaturePrivileges(t)})),{}),v=[];return s.forEach((i=>{const{category:s}=i[0],a=Object(b.jsx)(r.EuiFlexGroup,{"data-test-subj":`featureCategoryButton_${s.id}`,alignItems:"center",responsive:!1,gutterSize:"m"},s.euiIconType?Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiIcon,{size:"m",type:s.euiIconType})):null,Object(b.jsx)(r.EuiFlexItem,{grow:1},Object(b.jsx)(r.EuiTitle,{size:"xs"},Object(b.jsx)("h4",{className:"eui-displayInlineBlock"},s.label)))),l=i.map((e=>({feature:e,featureId:e.id,...m})));v.push(Object(b.jsx)(r.EuiAccordion,{id:`privilegeSummaryFeatureCategory_${s.id}`,"data-test-subj":`privilegeSummaryFeatureCategory_${s.id}`,key:s.id,buttonContent:a,initialIsOpen:!0},Object(b.jsx)(r.EuiInMemoryTable,{columns:p,items:l,itemId:"featureId",rowProps:e=>({"data-test-subj":`summaryTableRow-${e.featureId}`}),itemIdToExpandedRowMap:t.reduce(((t,i)=>({...t,[i]:Object(b.jsx)(q,{feature:e.kibanaPrivileges.getSecuredFeature(i),effectiveFeaturePrivileges:Object.values(m).map((e=>e[i]))})})),{})})))})),Object(b.jsx)(n.a.Fragment,null,v.map(((e,t)=>Object(b.jsx)(l.Fragment,{key:t},e,Object(b.jsx)(r.EuiSpacer,null)))))},H=e=>{const[t,i]=Object(l.useState)(!1),s=e.role.kibana.length>5?"l":"m";return Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiButtonEmpty,{onClick:()=>i(!0),"data-test-subj":"viewPrivilegeSummaryButton"},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.privilegeSummary.viewSummaryButtonText",defaultMessage:"View privilege summary"})),t&&Object(b.jsx)(r.EuiFlyout,{onClose:()=>i(!1),size:s,maskProps:{headerZindexLocation:"below"}},Object(b.jsx)(r.EuiFlyoutHeader,null,Object(b.jsx)(r.EuiTitle,{size:"m"},Object(b.jsx)("h2",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.privilegeSummary.modalHeaderTitle",defaultMessage:"Privilege summary"})))),Object(b.jsx)(r.EuiFlyoutBody,null,Object(b.jsx)(V,{role:e.role,spaces:e.spaces,kibanaPrivileges:e.kibanaPrivileges,canCustomizeSubFeaturePrivileges:e.canCustomizeSubFeaturePrivileges,spacesApiUi:e.spacesApiUi})),Object(b.jsx)(r.EuiFlyoutFooter,null,Object(b.jsx)(r.EuiButton,{onClick:()=>i(!1)},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.privilegeSummary.closeSummaryButtonText",defaultMessage:"Close"})))))};class space_aware_privilege_section_SpaceAwarePrivilegeSection extends l.Component{constructor(e){super(e),h()(this,"globalSpaceEntry",{id:"*",name:u.i18n.translate("xpack.security.management.editRole.spaceAwarePrivilegeForm.globalSpacesName",{defaultMessage:"* All Spaces"}),color:"#D3DAE6",initials:"*",disabledFeatures:[]}),h()(this,"renderKibanaPrivileges",(()=>{const{role:e}=this.props;if(e.kibana.length>0){const e=Object(b.jsx)(privilege_space_table_PrivilegeSpaceTable,{role:this.props.role,displaySpaces:this.getDisplaySpaces(),privilegeCalculator:new privilege_form_calculator_PrivilegeFormCalculator(this.props.kibanaPrivileges,this.props.role),onChange:this.props.onChange,onEdit:this.onEditSpacesPrivileges,disabled:!this.props.editable});return Object(b.jsx)("div",null,e,Object(b.jsx)(r.EuiSpacer,null),this.getAvailablePrivilegeButtons(!0))}return Object(b.jsx)(r.EuiEmptyPrompt,{iconType:"lock",title:Object(b.jsx)("h2",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeSection.noAccessToKibanaTitle",defaultMessage:"This role does not grant access to Kibana"})),titleSize:"xs",actions:this.getAvailablePrivilegeButtons(!1)})})),h()(this,"getAvailablePrivilegeButtons",(e=>{const t=this.getAvailableSpaces().length>0;if(!t&&!e||Object(P.o)(this.props.role))return null;const i=t&&this.props.editable?Object(b.jsx)(r.EuiButton,{color:"primary",onClick:this.addSpacePrivilege,iconType:"plusInCircle","data-test-subj":"addSpacePrivilegeButton",isDisabled:!t||!this.props.editable},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spacePrivilegeSection.addSpacePrivilegeButton",defaultMessage:"Add Kibana privilege"})):null;if(!e)return i;const s=Object(b.jsx)(H,{role:this.props.role,spaces:this.getDisplaySpaces(),kibanaPrivileges:this.props.kibanaPrivileges,canCustomizeSubFeaturePrivileges:this.props.canCustomizeSubFeaturePrivileges,spacesApiUi:this.props.spacesApiUi,"data-test-subj":"privilegeSummaryButton"});return Object(b.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(r.EuiFlexItem,{grow:!1},i),e&&!Object(P.m)(this.props.role)&&Object(b.jsx)(r.EuiFlexItem,{grow:!1},s))})),h()(this,"getDisplaySpaces",(()=>[this.globalSpaceEntry,...this.props.spaces])),h()(this,"getAvailableSpaces",((e=-1)=>{const t=j.a.uniq(j.a.flatten(this.props.role.kibana.map(((t,i)=>e===i?[]:t.spaces))));return this.getDisplaySpaces().filter((e=>!t.includes(e.id)))})),h()(this,"addSpacePrivilege",(()=>{this.setState({showSpacePrivilegeEditor:!0,privilegeIndex:-1})})),h()(this,"onSpacesPrivilegeChange",(e=>{this.setState({showSpacePrivilegeEditor:!1,privilegeIndex:-1}),this.props.onChange(e)})),h()(this,"onEditSpacesPrivileges",(e=>{this.setState({privilegeIndex:e,showSpacePrivilegeEditor:!0})})),h()(this,"onCancelEditPrivileges",(()=>{this.setState({showSpacePrivilegeEditor:!1})})),this.state={showSpacePrivilegeEditor:!1,showPrivilegeMatrix:!1,role:null,privilegeIndex:-1}}render(){var e;const{uiCapabilities:t}=this.props;return null!==(e=t.spaces)&&void 0!==e&&e.manage?Object(b.jsx)(r.EuiErrorBoundary,null,Object(b.jsx)(l.Fragment,null,this.renderKibanaPrivileges(),this.state.showSpacePrivilegeEditor&&Object(b.jsx)(privilege_space_form_PrivilegeSpaceForm,{role:this.props.role,kibanaPrivileges:this.props.kibanaPrivileges,onChange:this.onSpacesPrivilegeChange,onCancel:this.onCancelEditPrivileges,spaces:this.getAvailableSpaces(this.state.privilegeIndex),privilegeIndex:this.state.privilegeIndex,canCustomizeSubFeaturePrivileges:this.props.canCustomizeSubFeaturePrivileges}))):Object(b.jsx)(r.EuiCallOut,{title:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spaceAwarePrivilegeForm.insufficientPrivilegesDescription",defaultMessage:"Insufficient Privileges"}),iconType:"warning",color:"danger","data-test-subj":"userCannotManageSpacesCallout"},Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spaceAwarePrivilegeForm.howToViewAllAvailableSpacesDescription",defaultMessage:"You are not authorized to view all available spaces."})),Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spaceAwarePrivilegeForm.ensureAccountHasAllPrivilegesGrantedDescription",defaultMessage:"Please ensure your account has all privileges granted by the {kibanaAdmin} role, and try again.",values:{kibanaAdmin:Object(b.jsx)("strong",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.spaceAwarePrivilegeForm.kibanaAdminTitle",defaultMessage:"kibana_admin"}))}})))}}class transform_error_section_TransformErrorSection extends l.PureComponent{render(){return Object(b.jsx)(r.EuiEmptyPrompt,{color:"danger",iconType:"warning",title:Object(b.jsx)("h2",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.transformErrorSectionTitle",defaultMessage:"Malformed role"})),body:Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.transformErrorSectionDescription",defaultMessage:"This role definition is invalid, and cannot be edited through this screen."}))})}}class kibana_privileges_region_KibanaPrivilegesRegion extends l.Component{constructor(...e){super(...e),h()(this,"getForm",(()=>{const{kibanaPrivileges:e,role:t,spacesEnabled:i,canCustomizeSubFeaturePrivileges:s,spaces:a=[],uiCapabilities:r,onChange:l,editable:n,validator:o,spacesApiUi:c}=this.props;return t._transform_error&&t._transform_error.includes("kibana")?Object(b.jsx)(transform_error_section_TransformErrorSection,null):c&&i?Object(b.jsx)(space_aware_privilege_section_SpaceAwarePrivilegeSection,{kibanaPrivileges:e,role:t,spaces:a,uiCapabilities:r,onChange:l,editable:n,canCustomizeSubFeaturePrivileges:s,validator:o,spacesApiUi:c}):Object(b.jsx)(simple_privilege_section_SimplePrivilegeSection,{kibanaPrivileges:e,role:t,onChange:l,editable:n,canCustomizeSubFeaturePrivileges:s})}))}render(){return Object(b.jsx)(collapsible_panel_CollapsiblePanel,{iconType:"logoKibana",title:"Kibana"},this.getForm())}}const Q=e=>{const{role:t}=e;return Object(P.m)(t)?Object(b.jsx)(r.EuiToolTip,{"data-test-subj":"reservedRoleBadgeTooltip",content:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.reversedRoleBadge.reservedRolesCanNotBeModifiedTooltip",defaultMessage:"Reserved roles are built-in and cannot be removed or modified."})},Object(b.jsx)(r.EuiIcon,{style:{verticalAlign:"super"},type:"lock"})):null};class validate_role_RoleValidator{constructor(e={}){h()(this,"shouldValidate",void 0),this.shouldValidate=e.shouldValidate}enableValidation(){this.shouldValidate=!0}disableValidation(){this.shouldValidate=!1}validateRoleName(e){return this.shouldValidate?e.name?e.name.length>G.g?Y(u.i18n.translate("xpack.security.management.editRole.validateRole.nameLengthWarningMessage",{defaultMessage:"Name must not exceed {maxLength} characters.",values:{maxLength:G.g}})):e.name.trim()!==e.name?Y(u.i18n.translate("xpack.security.management.editRole.validateRole.nameWhitespaceWarningMessage",{defaultMessage:"Name must not contain leading or trailing spaces."})):e.name.match(G.h)?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.nameAllowedCharactersWarningMessage",{defaultMessage:"Name must contain only letters, numbers, spaces, punctuation and printable symbols."})):Y(u.i18n.translate("xpack.security.management.editRole.validateRole.provideRoleNameWarningMessage",{defaultMessage:"Please provide a role name."})):{isInvalid:!1}}validateRemoteClusterPrivileges(e){var t;return this.shouldValidate&&(null===(t=e.elasticsearch.remote_cluster)||void 0===t?void 0:t.some((e=>this.validateRemoteClusterPrivilegeClusterField(e).isInvalid||this.validateRemoteClusterPrivilegePrivilegesField(e).isInvalid)))?Y():{isInvalid:!1}}validateIndexPrivileges(e){if(!this.shouldValidate)return{isInvalid:!1};if(!Array.isArray(e.elasticsearch.indices))throw new TypeError(u.i18n.translate("xpack.security.management.editRole.validateRole.indicesTypeErrorMessage",{defaultMessage:"Expected {elasticIndices} to be an array",values:{elasticIndices:'"role.elasticsearch.indices"'}}));return e.elasticsearch.indices.reduce(((e,t)=>!(!this.validateIndexPrivilegeNamesField(t).isInvalid&&!this.validateIndexPrivilegePrivilegesField(t).isInvalid)||e),!1)?Y():{isInvalid:!1}}validateRemoteIndexPrivileges(e){if(!this.shouldValidate)return{isInvalid:!1};if(!e.elasticsearch.remote_indices)return{isInvalid:!1};if(!Array.isArray(e.elasticsearch.remote_indices))throw new TypeError(u.i18n.translate("xpack.security.management.editRole.validateRole.indicesTypeErrorMessage",{defaultMessage:"Expected {elasticIndices} to be an array",values:{elasticIndices:'"role.elasticsearch.remote_indices"'}}));return e.elasticsearch.remote_indices.reduce(((e,t)=>!!(this.validateRemoteIndexPrivilegeClustersField(t).isInvalid||this.validateIndexPrivilegeNamesField(t).isInvalid||this.validateIndexPrivilegePrivilegesField(t).isInvalid)||e),!1)?Y():{isInvalid:!1}}validateRemoteIndexPrivilegeClustersField(e){return this.shouldValidate&&(e.names.length||e.privileges.length)?e.clusters&&e.clusters.length?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.oneRemoteClusterRequiredWarningMessage",{defaultMessage:"Enter or select at least one remote cluster"})):{isInvalid:!1}}validateIndexPrivilegeNamesField(e){return this.shouldValidate&&("clusters"in e&&e.clusters.length||e.privileges.length)?e.names.length?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.oneIndexRequiredWarningMessage",{defaultMessage:"Enter or select at least one index pattern"})):{isInvalid:!1}}validateIndexPrivilegePrivilegesField(e){return this.shouldValidate&&("clusters"in e&&e.clusters.length||e.names.length)?e.privileges.length?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.onePrivilegeRequiredWarningMessage",{defaultMessage:"Enter or select at least one action"})):{isInvalid:!1}}validateRemoteClusterPrivilegeClusterField(e){return this.shouldValidate&&e.privileges.length?e.clusters.length?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.oneClusterRequiredWarningMessage",{defaultMessage:"Enter or select at least one cluster"})):{isInvalid:!1}}validateRemoteClusterPrivilegePrivilegesField(e){return this.shouldValidate&&e.clusters.length?e.privileges.length?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.oneRemoteClusterPrivilegeRequiredWarningMessage",{defaultMessage:"Enter or select at least one privilege"})):{isInvalid:!1}}validateSelectedSpaces(e,t){return this.shouldValidate&&t?Array.isArray(e)&&e.length>0?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.oneSpaceRequiredWarningMessage",{defaultMessage:"At least one space is required"})):{isInvalid:!1}}validateSelectedPrivilege(e,t){return this.shouldValidate&&e&&0!==e.length?t?{isInvalid:!1}:Y(u.i18n.translate("xpack.security.management.editRole.validateRole.privilegeRequiredWarningMessage",{defaultMessage:"Privilege is required"})):{isInvalid:!1}}validateSpacePrivileges(e){return this.shouldValidate?(e.kibana||[]).every((e=>e.base.length>0||Object.keys(e.feature).length>0))?{isInvalid:!1}:Y():{isInvalid:!1}}validateForSave(e){const{isInvalid:t}=this.validateRoleName(e),{isInvalid:i}=this.validateIndexPrivileges(e),{isInvalid:s}=this.validateRemoteIndexPrivileges(e),{isInvalid:a}=this.validateSpacePrivileges(e),{isInvalid:r}=this.validateRemoteClusterPrivileges(e);return t||i||s||a||r?Y():{isInvalid:!1}}}function Y(e){return{isInvalid:!0,error:e}}var J=i(38),Z=i(61);class kibana_privilege_KibanaPrivilege{constructor(e,t=[]){this.id=e,this.actions=t}get name(){return j.a.upperFirst(this.id)}grantsPrivilege(e){return this.checkActions(this.actions,e.actions).hasAllRequested}checkActions(e,t){const i=t.filter((t=>!e.includes(t)));return{missing:i,hasAllRequested:e.length>0&&t.length>0&&0===i.length}}}class primary_feature_privilege_PrimaryFeaturePrivilege extends kibana_privilege_KibanaPrivilege{constructor(e,t,i=[]){super(e,i),this.config=t,this.actions=i}isMinimalFeaturePrivilege(){return this.id.startsWith("minimal_")}getMinimalPrivilegeId(){return this.isMinimalFeaturePrivilege()?this.id:`minimal_${this.id}`}get requireAllSpaces(){var e;return null!==(e=this.config.requireAllSpaces)&&void 0!==e&&e}get disabled(){var e;return null!==(e=this.config.disabled)&&void 0!==e&&e}}class sub_feature_privilege_SubFeaturePrivilege extends kibana_privilege_KibanaPrivilege{constructor(e,t=[]){super(e.id,t),this.subPrivilegeConfig=e,this.actions=t}get name(){return this.subPrivilegeConfig.name}get disabled(){return this.subPrivilegeConfig.disabled}get requireAllSpaces(){var e;return null!==(e=this.subPrivilegeConfig.requireAllSpaces)&&void 0!==e&&e}}class sub_feature_privilege_group_SubFeaturePrivilegeGroup{constructor(e,t={}){this.config=e,this.actionMapping=t}get groupType(){return this.config.groupType}get privileges(){return this.config.privileges.map((e=>new sub_feature_privilege_SubFeaturePrivilege(e,this.actionMapping[e.id]||[])))}}class secured_sub_feature_SecuredSubFeature extends Z.SubFeature{constructor(e,t={}){super(e),h()(this,"privileges",void 0),h()(this,"privilegesTooltip",void 0),h()(this,"nonEmptyPrivilegeGroups",void 0),this.actionMapping=t,this.privilegesTooltip=e.privilegesTooltip||"",this.nonEmptyPrivilegeGroups=this.privilegeGroups.flatMap((e=>{const t=e.privileges.filter((e=>!e.disabled));return 0===t.length?[]:[e.privileges.length===t.length?e:{...e,privileges:t}]})),this.privileges=Array.from(this.privilegeIterator())}getPrivilegeGroups(){return this.nonEmptyPrivilegeGroups.map((e=>new sub_feature_privilege_group_SubFeaturePrivilegeGroup(e,this.actionMapping)))}*privilegeIterator({predicate:e=(()=>!0)}={}){for(const t of this.nonEmptyPrivilegeGroups)for(const i of t.privileges){const t=new sub_feature_privilege_SubFeaturePrivilege(i,this.actionMapping[i.id]);e(t,this)&&(yield t)}}getDescription(){return this.description}}class secured_feature_SecuredFeature extends Z.KibanaFeature{constructor(e,t={}){var i,s;super(e),h()(this,"primaryFeaturePrivileges",void 0),h()(this,"minimalPrimaryFeaturePrivileges",void 0),h()(this,"subFeaturePrivileges",void 0),h()(this,"securedSubFeatures",void 0),this.primaryFeaturePrivileges=Object.entries(this.config.privileges||{}).map((([e,i])=>new primary_feature_privilege_PrimaryFeaturePrivilege(e,i,t[e]))),this.minimalPrimaryFeaturePrivileges=Object.entries(this.config.privileges||{}).map((([e,i])=>new primary_feature_privilege_PrimaryFeaturePrivilege(`minimal_${e}`,i,t[`minimal_${e}`]))),this.securedSubFeatures=null!==(i=null===(s=this.config.subFeatures)||void 0===s?void 0:s.map((e=>new secured_sub_feature_SecuredSubFeature(e,t))))&&void 0!==i?i:[],this.subFeaturePrivileges=this.securedSubFeatures.reduce(((e,t)=>[...e,...t.privilegeIterator()]),[])}getPrivilegesTooltip(){return this.config.privilegesTooltip}getAllPrivileges(){return[...this.primaryFeaturePrivileges,...this.minimalPrimaryFeaturePrivileges,...this.subFeaturePrivileges]}getPrimaryFeaturePrivileges({includeMinimalFeaturePrivileges:e}={includeMinimalFeaturePrivileges:!1}){return e?[this.primaryFeaturePrivileges,this.minimalPrimaryFeaturePrivileges].flat():[...this.primaryFeaturePrivileges]}getMinimalFeaturePrivileges(){return[...this.minimalPrimaryFeaturePrivileges]}getSubFeaturePrivileges(){return[...this.subFeaturePrivileges]}getSubFeatures(){return[...this.securedSubFeatures]}}class privilege_collection_PrivilegeCollection{constructor(e){h()(this,"actions",void 0),this.actions=new Set(e.reduce(((e,t)=>[...e,...t.actions]),[]))}grantsPrivilege(e){return this.checkActions(this.actions,e.actions).hasAllRequested}checkActions(e,t){const i=t.filter((t=>!e.has(t)));return{missing:i,hasAllRequested:e.size>0&&t.length>0&&0===i.length}}}function X(e){return new Map(Object.entries(e).map((e=>function(e){const[t,i]=e;return[t,new kibana_privilege_KibanaPrivilege(t,i)]}(e))))}class kibana_privileges_KibanaPrivileges{constructor(e,t){h()(this,"global",void 0),h()(this,"spaces",void 0),h()(this,"feature",void 0),this.global=X(e.global),this.spaces=X(e.space),this.feature=new Map(t.map((t=>{const i=e.features[t.id];return[t.id,new secured_feature_SecuredFeature(t.toRaw(),i)]})))}getBasePrivileges(e){return R(e)?Array.from(this.global.values()):Array.from(this.spaces.values())}getSecuredFeature(e){return this.feature.get(e)}getSecuredFeatures(){return Array.from(this.feature.values())}createCollectionFromRoleKibanaPrivileges(e){const t=e=>t=>Array.isArray(e)&&e.includes(t.id),i=e.map((e=>[this.getBasePrivileges(e).filter(t(e.base)),Object.entries(e.feature).map((([e,i])=>this.getFeaturePrivileges(e).filter(t(i))))].flat(2))).flat();return new privilege_collection_PrivilegeCollection(i)}getFeaturePrivileges(e){var t,i;return null!==(t=null===(i=this.getSecuredFeature(e))||void 0===i?void 0:i.getAllPrivileges())&&void 0!==t?t:[]}}const ee=({userAPIClient:e,dataViews:t,rolesAPIClient:i,indicesAPIClient:s,privilegesAPIClient:o,getFeatures:v,http:h,roleName:x,action:j,fatalErrors:f,license:F,docLinks:O,uiCapabilities:y,notifications:C,history:S,spacesApiUi:E,buildFlavor:k,cloudOrgUrl:M,...R})=>{const I=Object(g.useDarkMode)();if(!t)throw new Error("The dataViews plugin is required for this page, but it is not available");const _=Object(l.useCallback)((()=>S.push("/")),[S]),w=!Object(J.a)("roles").save,{current:T}=Object(l.useRef)(new validate_role_RoleValidator({shouldValidate:!1})),[A,D]=Object(l.useState)(null),[z,B]=Object(l.useState)(!1),[L,G]=Object(l.useState)(""),N=function(e,t,i){const[s,a]=Object(l.useState)(null);return Object(l.useEffect)((()=>{"serverless"!==i?e.getUsers().then((e=>a(e.map((e=>e.username)))),(e=>t.add(e))):a([])}),[t,e,i]),s}(e,f,k),W=function(e,t,i){const[s,a]=Object(l.useState)(null);return Object(l.useEffect)((()=>{e.getTitles().catch((e=>{var s;if(403===(null===(s=e.response)||void 0===s?void 0:s.status))return i.toasts.addDanger({title:u.i18n.translate("xpack.security.management.roles.noIndexPatternsPermission",{defaultMessage:"You need permission to access the list of available index patterns."})}),[];t.add(e)})).then((e=>a(e.filter(Boolean))))}),[t,e,i]),s}(t,f,C),q=function(e,t){const[i,s]=Object(l.useState)(null);return Object(l.useEffect)((()=>{Promise.all([e.getAll({includeActions:!0,respectLicenseLevel:!1}),e.getBuiltIn()]).then((([e,t])=>s([e,t])),(e=>t.add(e)))}),[e,t]),i}(o,f),$=function(e,t){const[i,s]=Object(l.useState)(null);return Object(l.useEffect)((()=>{e.get("/api/spaces/space").then((e=>s({enabled:!0,list:e})),(e=>{var i;404===(null===(i=e.response)||void 0===i?void 0:i.status)?s({enabled:!1,list:[]}):t.add(e)}))}),[e,t]),i}(h,f),U=function(e,t){const[i,s]=Object(l.useState)(null);return Object(l.useEffect)((()=>{e().catch((e=>{var i;if(403===(null===(i=e.response)||void 0===i?void 0:i.status))return[];t.add(e)})).then((e=>{var t;s(null!==(t=null==e?void 0:e.filter((e=>!e.hidden)))&&void 0!==t?t:null)}))}),[t,e]),i}(v,f),K=function(e,t){return c()((async()=>"serverless"!==t?e.get("/internal/security/_check_security_features"):{value:!0}),[e,t])}(h,k),V=function(e){return c()((()=>e.get(m.REMOTE_CLUSTERS_PATH)))}(h),[H,Y]=function(e,t,i,s,a,r,n){const[o,c]=Object(l.useState)(null);return Object(l.useEffect)((()=>{(n?e.getRole(n):Promise.resolve({name:"",description:"",elasticsearch:{cluster:[],indices:[],run_as:[]},kibana:[],_unrecognized_applications:[]})).then((e=>{if("clone"===a&&Object(P.m)(e))r();else{if((!n||"edit"!==a)&&0===e.elasticsearch.indices.length){const t={names:[],privileges:[]},{allowRoleDocumentLevelSecurity:i,allowRoleFieldLevelSecurity:a}=s.getFeatures();a&&(t.field_security={grant:["*"],except:[]}),i&&(t.query=""),e.elasticsearch.indices.push(t)}c("clone"===a?Object(P.q)(e):Object(P.d)(e))}})).catch((e=>{var s;404===(null===(s=e.response)||void 0===s?void 0:s.status)?(i.toasts.addDanger({title:u.i18n.translate("xpack.security.management.roles.roleNotFound",{defaultMessage:'No "{roleName}" role found.',values:{roleName:n}})}),r()):t.add(e)}))}),[n,a,t,e,i,s,r]),[o,c]}(i,f,C,F,j,_,x),Z=!!x&&"edit"===j;if(Object(l.useEffect)((()=>{w&&!Z&&_()}),[w,Z]),!(H&&N&&W&&q&&$&&U&&K.value))return null;const X=w||Object(P.l)(H),ee=Object(P.m)(H),te=Object(P.j)(H),[ie,se]=q,ae=e=>Y(e),re=async()=>{T.enableValidation();const e=T.validateForSave(H);if(e.isInvalid)D(e);else{D(null);try{await i.saveRole({role:H,createOnly:!Z})}catch(e){var t,s,a;return Z||409!==(null==e||null===(t=e.body)||void 0===t?void 0:t.statusCode)?void C.toasts.addDanger(null!==(s=null==e||null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==s?s:u.i18n.translate("xpack.security.management.editRole.errorSavingRoleError",{defaultMessage:"Error saving role"})):(B(!0),void window.scroll({top:0,behavior:"smooth"}))}"serverless"===k?C.toasts.addSuccess({title:u.i18n.translate("xpack.security.management.editRole.customRoleSuccessfullySavedNotificationTitle",{defaultMessage:"Custom role saved"}),text:Object(p.a)(Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)("p",null,Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.customRoleSuccessfullySavedNotificationText",defaultMessage:"You can now assign this role to users of this project from your Organization page."})),Object(b.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButton,{size:"s",href:M},"Assign role")))),R)}):C.toasts.addSuccess(u.i18n.translate("xpack.security.management.editRole.roleSuccessfullySavedNotificationMessage",{defaultMessage:"Saved role"})),_()}},le=async()=>{try{return await i.getRole(H.name),!0}catch(e){return!1}};return Object(b.jsx)("div",{className:"editRolePage"},Object(b.jsx)(r.EuiForm,A,(()=>{let e;const t={tabIndex:0};return ee||X?(e=Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.viewingRoleTitle",defaultMessage:"Viewing role"}),t["aria-describedby"]="reservedRoleDescription"):e=Z?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.editRoleTitle",defaultMessage:"Edit role"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.createRoleTitle",defaultMessage:"Create role"}),Object(b.jsx)(r.EuiTitle,{size:"l"},Object(b.jsx)("h1",t,e," ",Object(b.jsx)(Q,{role:H})))})(),Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiText,{size:"s"},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.setPrivilegesToKibanaSpacesDescription",defaultMessage:"Set privileges on your Elasticsearch data and control access to your Project spaces."})),ee&&Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"s"}),Object(b.jsx)(r.EuiText,{size:"s",color:"subdued"},Object(b.jsx)("p",{id:"reservedRoleDescription",tabIndex:0},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.modifyingReversedRolesDescription",defaultMessage:"Reserved roles are built-in and cannot be removed or modified."})))),te&&Object(b.jsx)(l.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"s"}),Object(b.jsx)(r.EuiCallOut,{title:Object(P.e)(H),color:"warning",iconType:"warning"})),Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(r.EuiPanel,{hasShadow:!1,hasBorder:!0},Object(b.jsx)(r.EuiFlexGroup,null,Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,a()({"data-test-subj":"roleNameFormRow",label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.roleNameFormRowTitle",defaultMessage:"Role name"}),helpText:Z?ee?void 0:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.roleNameFormRowHelpText",defaultMessage:"A role's name cannot be changed once it has been created."}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.createRole.roleNameFormRowHelpText",defaultMessage:"Once the role is created you can no longer edit its name."})},T.validateRoleName(H),z?{error:"A role with this name already exists.",isInvalid:!0}:{}),Object(b.jsx)(r.EuiFieldText,{name:"name",value:H.name||"",onChange:e=>Y({...H,name:e.target.value}),onBlur:e=>{Z||L===H.name||(G(H.name),le().then((e=>{B(e)})))},"data-test-subj":"roleFormNameInput",disabled:ee||Z||X,isInvalid:z}))),Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiFormRow,{"data-test-subj":"roleDescriptionFormRow",label:Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.roleDescriptionFormRowTitle",defaultMessage:"Role description"})},ee||X?Object(b.jsx)(r.EuiToolTip,{content:H.description,display:"block","data-test-subj":"roleFormDescriptionTooltip"},Object(b.jsx)(r.EuiFieldText,{name:"description",value:null!==(ce=H.description)&&void 0!==ce?ce:"","data-test-subj":"roleFormDescriptionInput",disabled:!0})):Object(b.jsx)(r.EuiFieldText,{name:"description",value:null!==(ue=H.description)&&void 0!==ue?ue:"",onChange:e=>Y({...H,description:e.target.value.trim().length?e.target.value:void 0}),"data-test-subj":"roleFormDescriptionInput"}))))),Object(b.jsx)("div",null,Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(elasticsearch_privileges_ElasticsearchPrivileges,{role:H,editable:!X,indicesAPIClient:s,onChange:ae,runAsUsers:N,validator:T,indexPatterns:W,remoteClusters:V.value,builtinESPrivileges:se,license:F,docLinks:O,canUseRemoteIndices:"traditional"===k&&(null===(ne=K.value)||void 0===ne?void 0:ne.canUseRemoteIndices),canUseRemoteClusters:"traditional"===k&&(null===(oe=K.value)||void 0===oe?void 0:oe.canUseRemoteClusters),isDarkMode:I,buildFlavor:k})),Object(b.jsx)("div",null,Object(b.jsx)(r.EuiSpacer,null),Object(b.jsx)(kibana_privileges_region_KibanaPrivilegesRegion,{kibanaPrivileges:new kibana_privileges_KibanaPrivileges(ie,U),spaces:$.list,spacesEnabled:$.enabled,uiCapabilities:y,canCustomizeSubFeaturePrivileges:F.getFeatures().allowSubFeaturePrivileges,editable:!X,role:H,onChange:ae,validator:T,spacesApiUi:E})),Object(b.jsx)(r.EuiSpacer,null),X?Object(b.jsx)(r.EuiButton,a()({},Object(g.reactRouterNavigate)(S,""),{iconType:"arrowLeft","data-test-subj":"roleFormReturnButton"}),Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.returnToRoleListButtonLabel",defaultMessage:"Back to roles"})):Object(b.jsx)(r.EuiFlexGroup,{responsive:!1},Object(b.jsx)(r.EuiFlexItem,{grow:!1},(()=>{const e=Z?Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.updateRoleText",defaultMessage:"Update role"}):Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.createRoleText",defaultMessage:"Create role"});return Object(b.jsx)(r.EuiButton,{"data-test-subj":"roleFormSaveButton",fill:!0,onClick:re,disabled:ee||z},e)})()),Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButtonEmpty,{"data-test-subj":"roleFormCancelButton",onClick:_},Object(b.jsx)(d.FormattedMessage,{id:"xpack.security.management.editRole.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(b.jsx)(r.EuiFlexItem,{grow:!0}),Z&&!X?Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(delete_role_button_DeleteRoleButton,{roleName:H.name,canDelete:!0,onDelete:async()=>{try{await i.deleteRole(H.name)}catch(i){var e,t;return void C.toasts.addDanger(null!==(e=null==i||null===(t=i.data)||void 0===t?void 0:t.message)&&void 0!==e?e:u.i18n.translate("xpack.security.management.editRole.errorDeletingRoleError",{defaultMessage:"Error deleting role"}))}"serverless"===k?C.toasts.addDanger({title:u.i18n.translate("xpack.security.management.roles.deleteRolesSuccessTitle",{defaultMessage:"{numberOfCustomRoles, plural, one {# custom role} other {# custom roles}} deleted",values:{numberOfCustomRoles:1}}),text:Object(p.a)(Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)("p",null,u.i18n.translate("xpack.security.management.roles.deleteRolesSuccessMessage",{defaultMessage:"The deleted role will still appear listed on the user profile in Organization\n                  Management and on the User Profile for those that don't have admin access."})),Object(b.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiButton,{size:"s",href:M},"Manage Members")))),R)}):C.toasts.addSuccess(u.i18n.translate("xpack.security.management.editRole.roleSuccessfullyDeletedNotificationMessage",{defaultMessage:"Deleted role"})),_()},buildFlavor:k})):null)));var ne,oe,ce,ue}},73:function(e,t,i){"use strict";var s,a=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),r=[];function l(e){for(var t=-1,i=0;i<r.length;i++)if(r[i].identifier===e){t=i;break}return t}function n(e,t){for(var i={},s=[],a=0;a<e.length;a++){var n=e[a],o=t.base?n[0]+t.base:n[0],c=i[o]||0,u="".concat(o," ").concat(c);i[o]=c+1;var d=l(u),g={css:n[1],media:n[2],sourceMap:n[3]};-1!==d?(r[d].references++,r[d].updater(g)):r.push({identifier:u,updater:v(g,t),references:1}),s.push(u)}return s}function o(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var r=i.nc;r&&(s.nonce=r)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var l=a(e.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,i,s){var a=i?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=u(t,a);else{var r=document.createTextNode(a),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(r,l[t]):e.appendChild(r)}}function g(e,t,i){var s=i.css,a=i.media,r=i.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var p=null,m=0;function v(e,t){var i,s,a;if(t.singleton){var r=m++;i=p||(p=o(t)),s=d.bind(null,i,r,!1),a=d.bind(null,i,r,!0)}else i=o(t),s=g.bind(null,i,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var i=n(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<i.length;s++){var a=l(i[s]);r[a].references--}for(var o=n(e,t),c=0;c<i.length;c++){var u=l(i[c]);0===r[u].references&&(r[u].updater(),r.splice(u,1))}i=o}}}},74:function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i,s,a,r=e[1]||"",l=e[3];if(!l)return r;if(t&&"function"==typeof btoa){var n=(i=l,s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(a," */")),o=l.sources.map((function(e){return"/*# sourceURL=".concat(l.sourceRoot||"").concat(e," */")}));return[r].concat(o).concat([n]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,s){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(s)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(a[l]=!0)}for(var n=0;n<e.length;n++){var o=[].concat(e[n]);s&&a[o[0]]||(i&&(o[2]?o[2]="".concat(i," and ").concat(o[2]):o[2]=i),t.push(o))}},t}}}]);