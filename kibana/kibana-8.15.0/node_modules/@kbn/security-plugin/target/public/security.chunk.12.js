/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.security_bundle_jsonpfunction=window.security_bundle_jsonpfunction||[]).push([[12],{105:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return g})),a.d(t,"d",(function(){return d}));var n=a(4),s=a(2),i=a(3),o=a(0);const r=({roleMappingsAPI:e,children:t,notifications:a})=>{const[r,l]=Object(s.useState)([]),[p,c]=Object(s.useState)(!1),[g,d]=Object(s.useState)(!1),u=Object(s.useRef)(null),m=Object(s.useRef)(null),j=()=>{c(!1),l([])},M=()=>{j(),m.current&&m.current()},b=async()=>{let t;d(!0);try{t=await e.deleteRoleMappings(r.map((e=>e.name)))}catch(e){return a.toasts.addError(e,{title:i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.unknownError",{defaultMessage:"Error deleting role mappings"})}),void d(!1)}d(!1),j();const n=t.filter((e=>e.success)),s=t.filter((e=>!e.success));if(n.length>0){const e=n.length>1?i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.successMultipleNotificationTitle",{defaultMessage:"Deleted {count} role mappings",values:{count:n.length}}):i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.successSingleNotificationTitle",{defaultMessage:"Deleted role mapping ''{name}''",values:{name:n[0].name}});a.toasts.addSuccess({title:e,"data-test-subj":"deletedRoleMappingSuccessToast"}),u.current&&u.current(n.map((({name:e})=>e)))}if(s.length>0){const e=s.length>1?i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.errorMultipleNotificationTitle",{defaultMessage:"Error deleting {count} role mappings",values:{count:s.length}}):i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.errorSingleNotificationTitle",{defaultMessage:"Error deleting role mapping ''{name}''",values:{name:s[0].name}});a.toasts.addDanger(e)}};return Object(o.jsx)(s.Fragment,null,t(((e,t=(()=>{}),a=(()=>{}))=>{if(!e||!e.length)throw new Error("No Role Mappings specified for delete");c(!0),l(e),u.current=t,m.current=a})),(()=>{if(!p)return null;const e=1===r.length;return Object(o.jsx)(n.EuiConfirmModal,{title:e?i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.deleteSingleTitle",{defaultMessage:"Delete role mapping ''{name}''?",values:{name:r[0].name}}):i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.deleteMultipleTitle",{defaultMessage:"Delete {count} role mappings?",values:{count:r.length}}),onCancel:M,onConfirm:b,cancelButtonText:i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.confirmButtonLabel",{defaultMessage:"Delete {count, plural, one {role mapping} other {role mappings}}",values:{count:r.length}}),confirmButtonDisabled:g,buttonColor:"danger","data-test-subj":"deleteRoleMappingConfirmationModal"},e?null:Object(o.jsx)(s.Fragment,null,Object(o.jsx)("p",null,i.i18n.translate("xpack.security.management.roleMappings.deleteRoleMapping.confirmModal.deleteMultipleListDescription",{defaultMessage:"You are about to delete these role mappings:"})),Object(o.jsx)("ul",null,r.map((({name:e})=>Object(o.jsx)("li",{key:e},e))))))})())};var l=a(13),p=a(11);const c=()=>{const e=Object(p.useKibana)().services.docLinks;return Object(o.jsx)(n.EuiCallOut,{title:Object(o.jsx)(l.FormattedMessage,{id:"xpack.security.management.roleMappings.noCompatibleRealmsErrorTitle",defaultMessage:"No compatible realms appear to be enabled in Elasticsearch"}),color:"warning",iconType:"warning"},Object(o.jsx)(l.FormattedMessage,{id:"xpack.security.management.roleMappings.noCompatibleRealmsErrorDescription",defaultMessage:"Role mappings may not be applied to users. Contact your system administrator and refer to the {link} for more information.",values:{link:Object(o.jsx)(n.EuiLink,{href:e.links.security.mappingRoles,external:!0,target:"_blank"},Object(o.jsx)(l.FormattedMessage,{id:"xpack.security.management.roleMappings.noCompatibleRealmsErrorLinkText",defaultMessage:"docs"}))}}))},g=()=>Object(o.jsx)(n.EuiPageSection,{alignment:"center",color:"subdued"},Object(o.jsx)(n.EuiEmptyPrompt,{iconType:"securityApp",title:Object(o.jsx)("h2",null,Object(o.jsx)(l.FormattedMessage,{id:"xpack.security.management.roleMappings.deniedPermissionTitle",defaultMessage:"You need permission to manage role mappings"})),body:Object(o.jsx)("p",{"data-test-subj":"permissionDeniedMessage"},Object(o.jsx)(l.FormattedMessage,{id:"xpack.security.management.roleMappings.deniedPermissionDescription",defaultMessage:"Contact your system administrator."}))})),d=e=>Object(o.jsx)(n.EuiEmptyPrompt,{title:Object(o.jsx)(n.EuiLoadingSpinner,{size:"xl"}),body:Object(o.jsx)(n.EuiText,{color:"subdued"},e.children||Object(o.jsx)(l.FormattedMessage,{id:"xpack.security.management.editRoleMapping.loadingRoleMappingDescription",defaultMessage:"Loading…"})),"data-test-subj":"sectionLoading"})},108:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),s=(a(2),a(21)),i=a(0);const o=({role:e,navigateToApp:t})=>{let a,o;return"string"==typeof e?(a=Object(i.jsx)("div",null,e),o=`security/roles/edit/${encodeURIComponent(e)}`):Object(s.j)(e)?(a=Object(i.jsx)(n.EuiToolTip,{content:Object(s.e)(e),"data-test-subj":"roleDeprecationTooltip"},Object(i.jsx)("div",null,e.name," ",Object(i.jsx)(n.EuiIcon,{type:"warning",color:"warning",size:"s",className:"eui-alignTop"}))),o=`security/roles/edit/${encodeURIComponent(e.name)}`):(a=Object(i.jsx)("div",null,e.name),o=`security/roles/edit/${encodeURIComponent(e.name)}`),Object(i.jsx)(n.EuiLink,{onClick:()=>t("management",{path:o})},a)}},313:function(e,t,a){"use strict";a.r(t),a.d(t,"RoleMappingsGridPage",(function(){return role_mappings_grid_page_RoleMappingsGridPage}));var n=a(10),s=a.n(n),i=a(1),o=a.n(i),r=a(4),l=a(2),p=a.n(l),c=a(3),g=a(13),d=a(11),u=a(311);const m="/edit",j=e=>`${m}/${encodeURIComponent(e)}`,M=e=>`/clone/${encodeURIComponent(e)}`;var b=a(0);const x=({history:e})=>Object(b.jsx)(r.EuiButton,s()({iconType:"plusInCircleFilled","data-test-subj":"createRoleMappingButton"},Object(d.reactRouterNavigate)(e,m),{fill:!0}),Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.createRoleMappingButton",defaultMessage:"Create role mapping"})),h=({history:e,readOnly:t=!1})=>Object(b.jsx)(u.a.EmptyPrompt,{iconType:"managementApp",title:Object(b.jsx)("h1",null,t?Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.readOnlyEmptyPromptTitle",defaultMessage:"There are no role mappings to view"}):Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.emptyPromptTitle",defaultMessage:"Create your first role mapping"})),body:Object(b.jsx)("p",null,Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.emptyPromptDescription",defaultMessage:"Role mappings control which roles are assigned to your users."})),actions:t?null:Object(b.jsx)(x,{history:e}),"data-test-subj":"roleMappingsEmptyPrompt"});var f=a(86),y=a(108),O=a(105);class role_mappings_grid_page_RoleMappingsGridPage extends l.Component{constructor(e){super(e),o()(this,"renderTable",(()=>{const{roleMappings:e,selectedItems:t,loadState:a}=this.state,n="loadingTable"===a?Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.roleMappingTableLoadingMessage",defaultMessage:"Loading role mappings…"}):void 0,s={sort:{field:"name",direction:"asc"}},i={initialPageSize:20,pageSizeOptions:[10,20,50]},o={onSelectionChange:e=>{this.setState({selectedItems:e})},selected:t},l={toolsLeft:t.length?Object(b.jsx)(O.a,{roleMappingsAPI:this.props.roleMappingsAPI,notifications:this.props.notifications},(e=>Object(b.jsx)(r.EuiButton,{onClick:()=>e(t,this.onRoleMappingsDeleted),color:"danger","data-test-subj":"bulkDeleteActionButton"},Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.deleteRoleMappingButton",defaultMessage:"Delete {count, plural, one {role mapping} other {role mappings}}",values:{count:t.length}})))):void 0,toolsRight:Object(b.jsx)(r.EuiButton,{color:"success",iconType:"refresh",onClick:()=>this.reloadRoleMappings(),"data-test-subj":"reloadButton"},Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.reloadRoleMappingsButton",defaultMessage:"Reload"})),box:{incremental:!0},filters:void 0};return Object(b.jsx)(O.a,{roleMappingsAPI:this.props.roleMappingsAPI,notifications:this.props.notifications},(t=>Object(b.jsx)(r.EuiInMemoryTable,{items:e,itemId:"name",columns:this.getColumnConfig(t),search:l,sorting:s,selection:this.props.readOnly?void 0:o,pagination:i,loading:"loadingTable"===a,message:n,rowProps:()=>({"data-test-subj":"roleMappingRow"})})))})),o()(this,"getColumnConfig",(e=>{const t=[{field:"name",name:c.i18n.translate("xpack.security.management.roleMappings.nameColumnName",{defaultMessage:"Name"}),sortable:!0,render:e=>Object(b.jsx)(r.EuiLink,s()({},Object(d.reactRouterNavigate)(this.props.history,j(e)),{"data-test-subj":"roleMappingName"}),e)},{field:"roles",name:c.i18n.translate("xpack.security.management.roleMappings.rolesColumnName",{defaultMessage:"Roles"}),sortable:!0,render:(e,t)=>{const{roles:a=[],role_templates:n=[]}=t;if(n.length>0)return Object(b.jsx)("span",{"data-test-subj":"roleMappingRoles"},c.i18n.translate("xpack.security.management.roleMappings.roleTemplates",{defaultMessage:"{templateCount, plural, one{# role template} other {# role templates}} defined",values:{templateCount:n.length}}));const s=a.map(((e,t)=>{var a,n;const s=null!==(a=null===(n=this.state.roles)||void 0===n?void 0:n.find((t=>t.name===e)))&&void 0!==a?a:e;return Object(b.jsx)(r.EuiFlexItem,{grow:!1,key:e},Object(b.jsx)(y.a,{role:s,navigateToApp:this.props.navigateToApp}))}));return Object(b.jsx)(r.EuiFlexGroup,{gutterSize:"s","data-test-subj":"roleMappingRoles",wrap:!0},s)}},{field:"enabled",name:c.i18n.translate("xpack.security.management.roleMappings.enabledColumnName",{defaultMessage:"Enabled"}),sortable:!0,render:e=>e?Object(b.jsx)(f.c,{"data-test-subj":"roleMappingEnabled"}):Object(b.jsx)(f.b,{"data-test-subj":"roleMappingEnabled"})}];return this.props.readOnly||t.push({name:c.i18n.translate("xpack.security.management.roleMappings.actionsColumnName",{defaultMessage:"Actions"}),width:"108px",actions:[{isPrimary:!0,type:"icon",icon:"copy",name:c.i18n.translate("xpack.security.management.roleMappings.actionCloneTooltip",{defaultMessage:"Clone"}),description:e=>c.i18n.translate("xpack.security.management.roleMappings.actionCloneAriaLabel",{defaultMessage:"Clone ''{name}''",values:{name:e.name}}),href:e=>Object(d.reactRouterNavigate)(this.props.history,M(e.name)).href,onClick:(e,t)=>Object(d.reactRouterNavigate)(this.props.history,M(e.name)).onClick(t),"data-test-subj":e=>`cloneRoleMappingButton-${e.name}`},{type:"icon",icon:"trash",color:"danger",name:c.i18n.translate("xpack.security.management.roleMappings.actionDeleteTooltip",{defaultMessage:"Delete"}),description:e=>c.i18n.translate("xpack.security.management.roleMappings.actionDeleteAriaLabel",{defaultMessage:"Delete ''{name}''",values:{name:e.name}}),"data-test-subj":e=>`deleteRoleMappingButton-${e.name}`,onClick:t=>e([t],this.onRoleMappingsDeleted)},{isPrimary:!0,type:"icon",icon:"pencil",name:c.i18n.translate("xpack.security.management.roleMappings.actionEditTooltip",{defaultMessage:"Edit"}),description:e=>c.i18n.translate("xpack.security.management.roleMappings.actionEditAriaLabel",{defaultMessage:"Edit ''{name}''",values:{name:e.name}}),"data-test-subj":e=>`editRoleMappingButton-${e.name}`,href:e=>Object(d.reactRouterNavigate)(this.props.history,j(e.name)).href,onClick:(e,t)=>Object(d.reactRouterNavigate)(this.props.history,j(e.name)).onClick(t)}]}),t})),o()(this,"onRoleMappingsDeleted",(e=>{e.length&&this.reloadRoleMappings()})),o()(this,"performInitialLoad",(async()=>{try{const[e,t]=await Promise.all([this.props.roleMappingsAPI.getRoleMappings(),this.props.rolesAPIClient.getRoles()]);this.setState({roleMappings:e,roles:t})}catch(e){this.setState({error:e})}this.setState({loadState:"finished"})})),o()(this,"reloadRoleMappings",(()=>{this.setState({roleMappings:[],loadState:"loadingTable"}),this.loadRoleMappings()})),o()(this,"loadRoleMappings",(async()=>{try{const e=await this.props.roleMappingsAPI.getRoleMappings();this.setState({roleMappings:e})}catch(e){this.setState({error:e})}this.setState({loadState:"finished"})})),this.state={loadState:"loadingApp",roleMappings:null,roles:null,hasCompatibleRealms:!0,selectedItems:[],error:void 0}}componentDidMount(){this.checkPrivileges()}render(){const{loadState:e,error:t,roleMappings:a}=this.state;if("permissionDenied"===e)return Object(b.jsx)(O.c,null);if("loadingApp"===e)return Object(b.jsx)(r.EuiPageSection,{alignment:"center",grow:!0,color:"subdued"},Object(b.jsx)(O.d,null,Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.loadingRoleMappingsDescription",defaultMessage:"Loading role mappings…"})));if(t){const{body:{error:e,message:a,statusCode:n}}=t;return Object(b.jsx)(r.EuiPageSection,{alignment:"center",color:"danger"},Object(b.jsx)(r.EuiCallOut,{title:Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.loadingRoleMappingsErrorTitle",defaultMessage:"Error loading Role mappings"}),color:"danger",iconType:"warning"},n,": ",e," - ",a))}return"finished"===e&&a&&0===a.length?Object(b.jsx)(h,{history:this.props.history,readOnly:this.props.readOnly}):Object(b.jsx)(p.a.Fragment,null,Object(b.jsx)(r.EuiPageHeader,{bottomBorder:!0,pageTitle:Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.roleMappingTitle",defaultMessage:"Role Mappings"}),description:Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.roleMappingDescription",defaultMessage:"Role mappings define which roles are assigned to users from an external identity provider. {learnMoreLink}",values:{learnMoreLink:Object(b.jsx)(r.EuiLink,{href:this.props.docLinks.links.security.mappingRoles,external:!0},Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.learnMoreLinkText",defaultMessage:"Learn more."}))}}),rightSideItems:this.props.readOnly?void 0:[Object(b.jsx)(r.EuiButton,s()({fill:!0,iconType:"plusInCircleFilled","data-test-subj":"createRoleMappingButton"},Object(d.reactRouterNavigate)(this.props.history,m)),Object(b.jsx)(g.FormattedMessage,{id:"xpack.security.management.roleMappings.createRoleMappingButtonLabel",defaultMessage:"Create role mapping"}))]}),Object(b.jsx)(r.EuiSpacer,{size:"l"}),!this.state.hasCompatibleRealms&&Object(b.jsx)(p.a.Fragment,null,Object(b.jsx)(O.b,null),Object(b.jsx)(r.EuiSpacer,null)),this.renderTable())}async checkPrivileges(){try{const{canReadSecurity:e,hasCompatibleRealms:t}=await this.props.securityFeaturesAPI.checkFeatures();this.setState({loadState:e?this.state.loadState:"permissionDenied",hasCompatibleRealms:t}),e&&this.performInitialLoad()}catch(e){this.setState({error:e,loadState:"finished"})}}}o()(role_mappings_grid_page_RoleMappingsGridPage,"defaultProps",{readOnly:!1})},86:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return c}));var n=a(4),s=(a(2),a(13)),i=a(0);const o=e=>e.tooltipContent?Object(i.jsx)(n.EuiToolTip,{content:e.tooltipContent},e.children):e.children,r=e=>Object(i.jsx)(o,{tooltipContent:e.tooltipContent},Object(i.jsx)(n.EuiBadge,{"data-test-subj":e["data-test-subj"],color:"warning"},Object(i.jsx)(s.FormattedMessage,{id:"xpack.security.management.deprecatedBadge",defaultMessage:"Deprecated"}))),l=e=>Object(i.jsx)(o,{tooltipContent:e.tooltipContent},Object(i.jsx)(n.EuiBadge,{"data-test-subj":e["data-test-subj"],color:"hollow"},Object(i.jsx)(s.FormattedMessage,{id:"xpack.security.management.disabledBadge",defaultMessage:"Disabled"}))),p=e=>Object(i.jsx)(o,{tooltipContent:e.tooltipContent},Object(i.jsx)(n.EuiBadge,{"data-test-subj":e["data-test-subj"],color:"success"},Object(i.jsx)(s.FormattedMessage,{id:"xpack.security.management.enabledBadge",defaultMessage:"Enabled"}))),c=e=>Object(i.jsx)(o,{tooltipContent:e.tooltipContent},Object(i.jsx)(n.EuiBadge,{"data-test-subj":e["data-test-subj"],color:"primary"},Object(i.jsx)(s.FormattedMessage,{id:"xpack.security.management.reservedBadge",defaultMessage:"Reserved"})))}}]);